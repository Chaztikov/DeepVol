WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 19:06:35.816034: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 19:06:35.845537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:06:35.846211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:06:35.848272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:06:35.850137: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:06:35.850747: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:06:35.853054: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:06:35.854830: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:06:35.859815: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:06:35.862019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:06:35.862553: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 19:06:35.869353: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400070000 Hz
2019-12-18 19:06:35.869539: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e67af7aef0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:06:35.869557: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 19:06:35.870718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:06:35.870742: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:06:35.870755: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:06:35.870766: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:06:35.870777: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:06:35.870788: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:06:35.870798: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:06:35.870809: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:06:35.872791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:06:35.872821: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:06:35.968858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 19:06:35.968893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 19:06:35.968904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 19:06:35.971902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 19:06:35.974047: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e67b5b4150 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:06:35.974064: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 19:07:07.438898: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 8.0196e+01,   Y0: 2.3258e+00,  elapsed time  31
INFO   step:     1,    loss: 1.6001e+01,   Y0: 2.3208e+00,  elapsed time  46
INFO   step:     2,    loss: 1.0437e+01,   Y0: 2.3158e+00,  elapsed time  46
INFO   step:     3,    loss: 9.6578e+00,   Y0: 2.3109e+00,  elapsed time  46
INFO   step:     4,    loss: 9.4570e+00,   Y0: 2.3060e+00,  elapsed time  46
INFO   step:     5,    loss: 9.3800e+00,   Y0: 2.3010e+00,  elapsed time  46
INFO   step:     6,    loss: 9.3336e+00,   Y0: 2.2963e+00,  elapsed time  46
INFO   step:     7,    loss: 9.3051e+00,   Y0: 2.2917e+00,  elapsed time  47
INFO   step:     8,    loss: 9.2876e+00,   Y0: 2.2871e+00,  elapsed time  47
INFO   step:     9,    loss: 9.2816e+00,   Y0: 2.2824e+00,  elapsed time  47
INFO   step:    10,    loss: 9.2805e+00,   Y0: 2.2778e+00,  elapsed time  47
INFO   step:    11,    loss: 9.2843e+00,   Y0: 2.2732e+00,  elapsed time  47
INFO   step:    12,    loss: 9.2891e+00,   Y0: 2.2688e+00,  elapsed time  47
INFO   step:    13,    loss: 9.2918e+00,   Y0: 2.2643e+00,  elapsed time  47
INFO   step:    14,    loss: 9.2924e+00,   Y0: 2.2601e+00,  elapsed time  48
INFO   step:    15,    loss: 9.2901e+00,   Y0: 2.2559e+00,  elapsed time  48
INFO   step:    16,    loss: 9.2859e+00,   Y0: 2.2516e+00,  elapsed time  48
INFO   step:    17,    loss: 9.2799e+00,   Y0: 2.2476e+00,  elapsed time  48
INFO   step:    18,    loss: 9.2714e+00,   Y0: 2.2436e+00,  elapsed time  48
INFO   step:    19,    loss: 9.2627e+00,   Y0: 2.2394e+00,  elapsed time  48
INFO   step:    20,    loss: 9.2537e+00,   Y0: 2.2355e+00,  elapsed time  48
INFO   step:    21,    loss: 9.2458e+00,   Y0: 2.2316e+00,  elapsed time  48
INFO   step:    22,    loss: 9.2389e+00,   Y0: 2.2277e+00,  elapsed time  49
INFO   step:    23,    loss: 9.2328e+00,   Y0: 2.2242e+00,  elapsed time  49
INFO   step:    24,    loss: 9.2276e+00,   Y0: 2.2207e+00,  elapsed time  49
INFO   step:    25,    loss: 9.2228e+00,   Y0: 2.2173e+00,  elapsed time  49
INFO   step:    26,    loss: 9.2186e+00,   Y0: 2.2141e+00,  elapsed time  49
INFO   step:    27,    loss: 9.2149e+00,   Y0: 2.2110e+00,  elapsed time  49
INFO   step:    28,    loss: 9.2116e+00,   Y0: 2.2076e+00,  elapsed time  49
INFO   step:    29,    loss: 9.2087e+00,   Y0: 2.2045e+00,  elapsed time  49
INFO   step:    30,    loss: 9.2061e+00,   Y0: 2.2014e+00,  elapsed time  50
INFO   step:    31,    loss: 9.2039e+00,   Y0: 2.1982e+00,  elapsed time  50
INFO   step:    32,    loss: 9.2019e+00,   Y0: 2.1952e+00,  elapsed time  50
INFO   step:    33,    loss: 9.2001e+00,   Y0: 2.1921e+00,  elapsed time  50
INFO   step:    34,    loss: 9.1985e+00,   Y0: 2.1893e+00,  elapsed time  50
INFO   step:    35,    loss: 9.1969e+00,   Y0: 2.1867e+00,  elapsed time  50
INFO   step:    36,    loss: 9.1956e+00,   Y0: 2.1842e+00,  elapsed time  50
INFO   step:    37,    loss: 9.1944e+00,   Y0: 2.1821e+00,  elapsed time  50
INFO   step:    38,    loss: 9.1933e+00,   Y0: 2.1796e+00,  elapsed time  51
INFO   step:    39,    loss: 9.1923e+00,   Y0: 2.1776e+00,  elapsed time  51
INFO   step:    40,    loss: 9.1913e+00,   Y0: 2.1757e+00,  elapsed time  51
INFO   step:    41,    loss: 9.1905e+00,   Y0: 2.1739e+00,  elapsed time  51
INFO   step:    42,    loss: 9.1897e+00,   Y0: 2.1721e+00,  elapsed time  51
INFO   step:    43,    loss: 9.1891e+00,   Y0: 2.1705e+00,  elapsed time  51
INFO   step:    44,    loss: 9.1884e+00,   Y0: 2.1687e+00,  elapsed time  51
INFO   step:    45,    loss: 9.1878e+00,   Y0: 2.1668e+00,  elapsed time  51
INFO   step:    46,    loss: 9.1873e+00,   Y0: 2.1650e+00,  elapsed time  52
INFO   step:    47,    loss: 9.1867e+00,   Y0: 2.1629e+00,  elapsed time  52
INFO   step:    48,    loss: 9.1863e+00,   Y0: 2.1609e+00,  elapsed time  52
INFO   step:    49,    loss: 9.1858e+00,   Y0: 2.1589e+00,  elapsed time  52
INFO   step:    50,    loss: 9.1853e+00,   Y0: 2.1569e+00,  elapsed time  52
INFO   step:    51,    loss: 9.1850e+00,   Y0: 2.1551e+00,  elapsed time  52
INFO   step:    52,    loss: 9.1846e+00,   Y0: 2.1536e+00,  elapsed time  52
INFO   step:    53,    loss: 9.1842e+00,   Y0: 2.1525e+00,  elapsed time  53
INFO   step:    54,    loss: 9.1839e+00,   Y0: 2.1515e+00,  elapsed time  53
INFO   step:    55,    loss: 9.1836e+00,   Y0: 2.1505e+00,  elapsed time  53
INFO   step:    56,    loss: 9.1833e+00,   Y0: 2.1499e+00,  elapsed time  53
INFO   step:    57,    loss: 9.1831e+00,   Y0: 2.1495e+00,  elapsed time  53
INFO   step:    58,    loss: 9.1828e+00,   Y0: 2.1489e+00,  elapsed time  53
INFO   step:    59,    loss: 9.1826e+00,   Y0: 2.1483e+00,  elapsed time  53
INFO   step:    60,    loss: 9.1824e+00,   Y0: 2.1478e+00,  elapsed time  53
INFO   step:    61,    loss: 9.1822e+00,   Y0: 2.1471e+00,  elapsed time  54
INFO   step:    62,    loss: 9.1820e+00,   Y0: 2.1467e+00,  elapsed time  54
INFO   step:    63,    loss: 9.1818e+00,   Y0: 2.1458e+00,  elapsed time  54
INFO   step:    64,    loss: 9.1816e+00,   Y0: 2.1446e+00,  elapsed time  54
INFO   step:    65,    loss: 9.1814e+00,   Y0: 2.1438e+00,  elapsed time  54
INFO   step:    66,    loss: 9.1812e+00,   Y0: 2.1433e+00,  elapsed time  54
INFO   step:    67,    loss: 9.1811e+00,   Y0: 2.1435e+00,  elapsed time  54
INFO   step:    68,    loss: 9.1809e+00,   Y0: 2.1435e+00,  elapsed time  55
INFO   step:    69,    loss: 9.1807e+00,   Y0: 2.1435e+00,  elapsed time  55
INFO   step:    70,    loss: 9.1806e+00,   Y0: 2.1436e+00,  elapsed time  55
INFO   step:    71,    loss: 9.1805e+00,   Y0: 2.1435e+00,  elapsed time  55
INFO   step:    72,    loss: 9.1803e+00,   Y0: 2.1435e+00,  elapsed time  55
INFO   step:    73,    loss: 9.1802e+00,   Y0: 2.1432e+00,  elapsed time  55
INFO   step:    74,    loss: 9.1801e+00,   Y0: 2.1429e+00,  elapsed time  55
INFO   step:    75,    loss: 9.1799e+00,   Y0: 2.1427e+00,  elapsed time  55
INFO   step:    76,    loss: 9.1798e+00,   Y0: 2.1422e+00,  elapsed time  56
INFO   step:    77,    loss: 9.1797e+00,   Y0: 2.1422e+00,  elapsed time  56
INFO   step:    78,    loss: 9.1795e+00,   Y0: 2.1424e+00,  elapsed time  56
INFO   step:    79,    loss: 9.1794e+00,   Y0: 2.1428e+00,  elapsed time  56
INFO   step:    80,    loss: 9.1793e+00,   Y0: 2.1432e+00,  elapsed time  56
INFO   step:    81,    loss: 9.1792e+00,   Y0: 2.1432e+00,  elapsed time  56
INFO   step:    82,    loss: 9.1791e+00,   Y0: 2.1430e+00,  elapsed time  56
INFO   step:    83,    loss: 9.1790e+00,   Y0: 2.1425e+00,  elapsed time  57
INFO   step:    84,    loss: 9.1789e+00,   Y0: 2.1420e+00,  elapsed time  57
INFO   step:    85,    loss: 9.1787e+00,   Y0: 2.1418e+00,  elapsed time  57
INFO   step:    86,    loss: 9.1786e+00,   Y0: 2.1415e+00,  elapsed time  57
INFO   step:    87,    loss: 9.1785e+00,   Y0: 2.1413e+00,  elapsed time  57
INFO   step:    88,    loss: 9.1784e+00,   Y0: 2.1411e+00,  elapsed time  57
INFO   step:    89,    loss: 9.1783e+00,   Y0: 2.1406e+00,  elapsed time  57
INFO   step:    90,    loss: 9.1782e+00,   Y0: 2.1401e+00,  elapsed time  57
INFO   step:    91,    loss: 9.1781e+00,   Y0: 2.1396e+00,  elapsed time  58
INFO   step:    92,    loss: 9.1780e+00,   Y0: 2.1395e+00,  elapsed time  58
INFO   step:    93,    loss: 9.1779e+00,   Y0: 2.1394e+00,  elapsed time  58
INFO   step:    94,    loss: 9.1778e+00,   Y0: 2.1390e+00,  elapsed time  58
INFO   step:    95,    loss: 9.1777e+00,   Y0: 2.1389e+00,  elapsed time  58
INFO   step:    96,    loss: 9.1776e+00,   Y0: 2.1386e+00,  elapsed time  58
INFO   step:    97,    loss: 9.1775e+00,   Y0: 2.1387e+00,  elapsed time  58
INFO   step:    98,    loss: 9.1774e+00,   Y0: 2.1382e+00,  elapsed time  58
INFO   step:    99,    loss: 9.1773e+00,   Y0: 2.1374e+00,  elapsed time  59
INFO   step:   100,    loss: 9.1772e+00,   Y0: 2.1366e+00,  elapsed time  59
INFO   step:   101,    loss: 9.1771e+00,   Y0: 2.1360e+00,  elapsed time  59
INFO   step:   102,    loss: 9.1770e+00,   Y0: 2.1356e+00,  elapsed time  59
INFO   step:   103,    loss: 9.1769e+00,   Y0: 2.1355e+00,  elapsed time  59
INFO   step:   104,    loss: 9.1768e+00,   Y0: 2.1355e+00,  elapsed time  59
INFO   step:   105,    loss: 9.1767e+00,   Y0: 2.1355e+00,  elapsed time  59
INFO   step:   106,    loss: 9.1766e+00,   Y0: 2.1358e+00,  elapsed time  59
INFO   step:   107,    loss: 9.1765e+00,   Y0: 2.1362e+00,  elapsed time  60
INFO   step:   108,    loss: 9.1764e+00,   Y0: 2.1367e+00,  elapsed time  60
INFO   step:   109,    loss: 9.1764e+00,   Y0: 2.1371e+00,  elapsed time  60
INFO   step:   110,    loss: 9.1763e+00,   Y0: 2.1375e+00,  elapsed time  60
INFO   step:   111,    loss: 9.1762e+00,   Y0: 2.1376e+00,  elapsed time  60
INFO   step:   112,    loss: 9.1761e+00,   Y0: 2.1378e+00,  elapsed time  60
INFO   step:   113,    loss: 9.1760e+00,   Y0: 2.1384e+00,  elapsed time  60
INFO   step:   114,    loss: 9.1759e+00,   Y0: 2.1384e+00,  elapsed time  60
INFO   step:   115,    loss: 9.1758e+00,   Y0: 2.1382e+00,  elapsed time  61
INFO   step:   116,    loss: 9.1757e+00,   Y0: 2.1381e+00,  elapsed time  61
INFO   step:   117,    loss: 9.1757e+00,   Y0: 2.1380e+00,  elapsed time  61
INFO   step:   118,    loss: 9.1756e+00,   Y0: 2.1381e+00,  elapsed time  61
INFO   step:   119,    loss: 9.1755e+00,   Y0: 2.1385e+00,  elapsed time  61
INFO   step:   120,    loss: 9.1754e+00,   Y0: 2.1384e+00,  elapsed time  61
INFO   step:   121,    loss: 9.1753e+00,   Y0: 2.1388e+00,  elapsed time  61
INFO   step:   122,    loss: 9.1752e+00,   Y0: 2.1394e+00,  elapsed time  62
INFO   step:   123,    loss: 9.1751e+00,   Y0: 2.1399e+00,  elapsed time  62
INFO   step:   124,    loss: 9.1751e+00,   Y0: 2.1407e+00,  elapsed time  62
INFO   step:   125,    loss: 9.1750e+00,   Y0: 2.1417e+00,  elapsed time  62
INFO   step:   126,    loss: 9.1749e+00,   Y0: 2.1428e+00,  elapsed time  62
INFO   step:   127,    loss: 9.1749e+00,   Y0: 2.1438e+00,  elapsed time  62
INFO   step:   128,    loss: 9.1748e+00,   Y0: 2.1450e+00,  elapsed time  62
INFO   step:   129,    loss: 9.1747e+00,   Y0: 2.1464e+00,  elapsed time  62
INFO   step:   130,    loss: 9.1747e+00,   Y0: 2.1483e+00,  elapsed time  63
INFO   step:   131,    loss: 9.1747e+00,   Y0: 2.1508e+00,  elapsed time  63
INFO   step:   132,    loss: 9.1747e+00,   Y0: 2.1530e+00,  elapsed time  63
INFO   step:   133,    loss: 9.1746e+00,   Y0: 2.1549e+00,  elapsed time  63
INFO   step:   134,    loss: 9.1747e+00,   Y0: 2.1572e+00,  elapsed time  63
INFO   step:   135,    loss: 9.1746e+00,   Y0: 2.1587e+00,  elapsed time  63
INFO   step:   136,    loss: 9.1746e+00,   Y0: 2.1596e+00,  elapsed time  63
INFO   step:   137,    loss: 9.1746e+00,   Y0: 2.1604e+00,  elapsed time  63
INFO   step:   138,    loss: 9.1745e+00,   Y0: 2.1612e+00,  elapsed time  64
INFO   step:   139,    loss: 9.1745e+00,   Y0: 2.1616e+00,  elapsed time  64
INFO   step:   140,    loss: 9.1744e+00,   Y0: 2.1624e+00,  elapsed time  64
INFO   step:   141,    loss: 9.1744e+00,   Y0: 2.1629e+00,  elapsed time  64
INFO   step:   142,    loss: 9.1743e+00,   Y0: 2.1628e+00,  elapsed time  64
INFO   step:   143,    loss: 9.1742e+00,   Y0: 2.1632e+00,  elapsed time  64
INFO   step:   144,    loss: 9.1742e+00,   Y0: 2.1635e+00,  elapsed time  64
INFO   step:   145,    loss: 9.1741e+00,   Y0: 2.1635e+00,  elapsed time  65
INFO   step:   146,    loss: 9.1740e+00,   Y0: 2.1631e+00,  elapsed time  65
INFO   step:   147,    loss: 9.1739e+00,   Y0: 2.1626e+00,  elapsed time  65
INFO   step:   148,    loss: 9.1738e+00,   Y0: 2.1620e+00,  elapsed time  65
INFO   step:   149,    loss: 9.1737e+00,   Y0: 2.1614e+00,  elapsed time  65
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  1
Loss out:  7.10453147231363
Output_Z_Vals:  [[[ 3.29337001e+00]
  [ 3.29337001e+00]
  [ 3.29337001e+00]
  ...
  [ 3.29337001e+00]
  [ 3.29337001e+00]
  [ 3.29337001e+00]]

 [[-4.20571330e-02]
  [ 1.77176485e-02]
  [-9.81304482e-03]
  ...
  [ 9.56721055e-03]
  [-2.26623207e-02]
  [-3.78154715e-02]]

 [[ 3.73899195e-02]
  [-3.27781324e-02]
  [ 3.82438407e-02]
  ...
  [ 2.90506809e-02]
  [ 3.88270313e-02]
  [ 4.33962792e-02]]

 ...

 [[-1.02321229e-02]
  [ 2.91201731e-03]
  [ 3.14029264e-03]
  ...
  [ 2.38804882e-03]
  [ 4.98811991e-02]
  [ 4.14482839e-03]]

 [[-5.39922755e-03]
  [ 1.44780809e-02]
  [ 9.49844610e-03]
  ...
  [ 8.23096898e-03]
  [ 5.65143074e-03]
  [ 1.39486275e-02]]

 [[ 2.30757445e-02]
  [ 6.80590218e-03]
  [ 7.70185723e-03]
  ...
  [ 4.48921655e-03]
  [ 7.86302131e-03]
  [ 7.97725429e-03]]]
Z_Vals dimensionality:  (40, 200, 1)
X_test:  [[[100.         100.9065301  100.68290367 ...  94.3677654   95.05240523
    94.18848809]]

 [[100.          99.8938651  101.91948852 ... 101.59429152 100.34330535
   100.81959617]]

 [[100.          99.40190317  99.83105744 ... 100.3610681  100.88208086
    99.76278871]]

 ...

 [[100.          98.97587281  99.24825138 ...  99.32916246  98.42623984
    97.81435406]]

 [[100.         100.58240456 100.66382412 ... 111.93624308 110.92502024
   110.03662151]]

 [[100.         100.77346972 100.55166476 ... 101.46585369 101.32385941
   102.07454379]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.20571330e-02]
 [ 3.73899195e-02]
 [ 2.53761848e-04]
 [-4.12457045e-03]
 [-7.72665722e-03]
 [ 3.29438445e-02]
 [ 3.74906011e-03]
 [-9.36873554e-04]
 [-2.73249590e-02]
 [ 2.34220325e-02]
 [ 1.97788415e-02]
 [-1.48811986e-02]
 [ 1.85555859e-02]
 [ 6.45948043e-03]
 [-1.11757479e-02]
 [-1.80816083e-05]
 [-6.02930442e-03]
 [-1.66990126e-03]
 [ 8.28110233e-04]
 [-2.94894209e-02]
 [-3.36329563e-03]
 [-1.88295349e-02]
 [ 5.88306614e-03]
 [-9.80934437e-03]
 [ 1.28939376e-02]
 [ 2.37660140e-03]
 [ 3.38616042e-02]
 [-5.59948532e-03]
 [-5.22626447e-02]
 [-8.46125621e-03]
 [ 5.23861509e-02]
 [-2.86684770e-03]
 [-2.01682215e-02]
 [-2.72510789e-02]
 [-2.34422910e-02]
 [ 3.05208938e-02]
 [-1.02321229e-02]
 [-5.39922755e-03]
 [ 2.30757445e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.79012859]
curr_Stock_Price:  100.90653009893649
curr_Factors:  [100.9065301]
mat_Sqrt:  [[0.15]]
grads:  [-0.28038089]
Stock Position:  -0.2803808869292556
Bond Position:  [50.08239099]


portfolio before change:  [21.85908985]
curr_Stock_Price:  100.68290367366512
curr_Factors:  [100.68290367]
mat_Sqrt:  [[0.15]]
grads:  [0.24926613]
Stock Position:  0.2492661299445837
Bond Position:  [-3.2377479]


portfolio before change:  [22.04672194]
curr_Stock_Price:  101.43726543269959
curr_Factors:  [101.43726543]
mat_Sqrt:  [[0.15]]
grads:  [0.00169175]
Stock Position:  0.001691745653156646
Bond Position:  [21.87511589]


portfolio before change:  [22.04753512]
curr_Stock_Price:  100.30152408561125
curr_Factors:  [100.30152409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02749714]
Stock Position:  -0.027497136313314026
Bond Position:  [24.8055398]


portfolio before change:  [22.05199472]
curr_Stock_Price:  100.25211100369143
curr_Factors:  [100.252111]
mat_Sqrt:  [[0.15]]
grads:  [-0.05151105]
Stock Position:  -0.05151104814741395
Bond Position:  [27.21608604]


portfolio before change:  [22.02797102]
curr_Stock_Price:  100.78453911167514
curr_Factors:  [100.78453911]
mat_Sqrt:  [[0.15]]
grads:  [0.21962563]
Stock Position:  0.21962563027292142
Bond Position:  [-0.10689691]


portfolio before change:  [22.04544668]
curr_Stock_Price:  100.8641702002987
curr_Factors:  [100.8641702]
mat_Sqrt:  [[0.15]]
grads:  [0.02499373]
Stock Position:  0.024993734061322884
Bond Position:  [19.52447444]


portfolio before change:  [22.01804009]
curr_Stock_Price:  99.66997879743748
curr_Factors:  [99.6699788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624582]
Stock Position:  -0.006245823691904586
Bond Position:  [22.64056121]


portfolio before change:  [22.01945699]
curr_Stock_Price:  99.89626524420818
curr_Factors:  [99.89626524]
mat_Sqrt:  [[0.15]]
grads:  [-0.18216639]
Stock Position:  -0.1821663935241123
Bond Position:  [40.21719936]


portfolio before change:  [22.15446579]
curr_Stock_Price:  99.18273444019172
curr_Factors:  [99.18273444]
mat_Sqrt:  [[0.15]]
grads:  [0.15614688]
Stock Position:  0.15614688337141794
Bond Position:  [6.66739092]


portfolio before change:  [22.18348297]
curr_Stock_Price:  99.3632292368143
curr_Factors:  [99.36322924]
mat_Sqrt:  [[0.15]]
grads:  [0.13185894]
Stock Position:  0.13185894343394813
Bond Position:  [9.08155254]


portfolio before change:  [22.24584042]
curr_Stock_Price:  99.82752987817358
curr_Factors:  [99.82752988]
mat_Sqrt:  [[0.15]]
grads:  [-0.09920799]
Stock Position:  -0.09920799043243683
Bond Position:  [32.14952905]


portfolio before change:  [22.2521936]
curr_Stock_Price:  99.80400116523896
curr_Factors:  [99.80400117]
mat_Sqrt:  [[0.15]]
grads:  [0.12370391]
Stock Position:  0.12370390604660354
Bond Position:  [9.90604882]


portfolio before change:  [22.21003936]
curr_Stock_Price:  99.45322343668396
curr_Factors:  [99.45322344]
mat_Sqrt:  [[0.15]]
grads:  [0.0430632]
Stock Position:  0.04306320286661764
Bond Position:  [17.92726502]


portfolio before change:  [22.1872539]
curr_Stock_Price:  98.87206586991542
curr_Factors:  [98.87206587]
mat_Sqrt:  [[0.15]]
grads:  [-0.07450499]
Stock Position:  -0.07450498599372374
Bond Position:  [29.55371579]


portfolio before change:  [22.2034308]
curr_Stock_Price:  98.70452741367913
curr_Factors:  [98.70452741]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012054]
Stock Position:  -0.00012054405562385238
Bond Position:  [22.21532904]


portfolio before change:  [22.20625656]
curr_Stock_Price:  98.30077208211573
curr_Factors:  [98.30077208]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019536]
Stock Position:  -0.04019536282473759
Bond Position:  [26.15749176]


portfolio before change:  [22.28579419]
curr_Stock_Price:  96.40334572101554
curr_Factors:  [96.40334572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01113268]
Stock Position:  -0.011132675076051916
Bond Position:  [23.35902131]


portfolio before change:  [22.28183172]
curr_Stock_Price:  97.02157400995675
curr_Factors:  [97.02157401]
mat_Sqrt:  [[0.15]]
grads:  [0.00552073]
Stock Position:  0.00552073488775803
Bond Position:  [21.74620133]


portfolio before change:  [22.28972823]
curr_Stock_Price:  97.95950507534268
curr_Factors:  [97.95950508]
mat_Sqrt:  [[0.15]]
grads:  [-0.19659614]
Stock Position:  -0.1965961391490286
Bond Position:  [41.54818872]


portfolio before change:  [22.22906949]
curr_Stock_Price:  98.29446888215017
curr_Factors:  [98.29446888]
mat_Sqrt:  [[0.15]]
grads:  [-0.02242197]
Stock Position:  -0.02242197087771408
Bond Position:  [24.43302521]


portfolio before change:  [22.26025835]
curr_Stock_Price:  97.03969331006911
curr_Factors:  [97.03969331]
mat_Sqrt:  [[0.15]]
grads:  [-0.12553023]
Stock Position:  -0.12553023288885615
Bond Position:  [34.44167365]


portfolio before change:  [22.28998031]
curr_Stock_Price:  96.83722033407149
curr_Factors:  [96.83722033]
mat_Sqrt:  [[0.15]]
grads:  [0.03922044]
Stock Position:  0.039220440901082905
Bond Position:  [18.49198183]


portfolio before change:  [22.28740595]
curr_Stock_Price:  96.7126426143328
curr_Factors:  [96.71264261]
mat_Sqrt:  [[0.15]]
grads:  [-0.06539563]
Stock Position:  -0.06539562912997696
Bond Position:  [28.61199006]


portfolio before change:  [22.25607736]
curr_Stock_Price:  97.24639866297287
curr_Factors:  [97.24639866]
mat_Sqrt:  [[0.15]]
grads:  [0.08595958]
Stock Position:  0.08595958380963828
Bond Position:  [13.89681741]


portfolio before change:  [22.19740285]
curr_Stock_Price:  96.54360647013398
curr_Factors:  [96.54360647]
mat_Sqrt:  [[0.15]]
grads:  [0.01584401]
Stock Position:  0.015844009327627282
Bond Position:  [20.66776505]


portfolio before change:  [22.15467736]
curr_Stock_Price:  93.6839057637218
curr_Factors:  [93.68390576]
mat_Sqrt:  [[0.15]]
grads:  [0.22574403]
Stock Position:  0.22574402787378556
Bond Position:  [1.00609512]


portfolio before change:  [21.99749957]
curr_Stock_Price:  92.98708307018288
curr_Factors:  [92.98708307]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373299]
Stock Position:  -0.037329902107411356
Bond Position:  [25.46869827]


portfolio before change:  [21.98827402]
curr_Stock_Price:  93.31950657722948
curr_Factors:  [93.31950658]
mat_Sqrt:  [[0.15]]
grads:  [-0.34841763]
Stock Position:  -0.34841763151420835
Bond Position:  [54.50243547]


portfolio before change:  [21.79594053]
curr_Stock_Price:  93.89108132094326
curr_Factors:  [93.89108132]
mat_Sqrt:  [[0.15]]
grads:  [-0.05640837]
Stock Position:  -0.05640837472617923
Bond Position:  [27.09218383]


portfolio before change:  [21.81495172]
curr_Stock_Price:  93.61409305133668
curr_Factors:  [93.61409305]
mat_Sqrt:  [[0.15]]
grads:  [0.34924101]
Stock Position:  0.349241005684545
Bond Position:  [-10.87892828]


portfolio before change:  [21.97400555]
curr_Stock_Price:  94.07341419919807
curr_Factors:  [94.0734142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01911232]
Stock Position:  -0.01911231799729406
Bond Position:  [23.77196656]


portfolio before change:  [21.96062353]
curr_Stock_Price:  94.9290771044002
curr_Factors:  [94.9290771]
mat_Sqrt:  [[0.15]]
grads:  [-0.13445481]
Stock Position:  -0.134454809702148
Bond Position:  [34.72429453]


portfolio before change:  [21.97693495]
curr_Stock_Price:  94.84004635271074
curr_Factors:  [94.84004635]
mat_Sqrt:  [[0.15]]
grads:  [-0.18167386]
Stock Position:  -0.18167385928268104
Bond Position:  [39.20689218]


portfolio before change:  [21.93829765]
curr_Stock_Price:  95.07969812581001
curr_Factors:  [95.07969813]
mat_Sqrt:  [[0.15]]
grads:  [-0.15628194]
Stock Position:  -0.15628194012670776
Bond Position:  [36.79753734]


portfolio before change:  [22.23495199]
curr_Stock_Price:  93.21093225296754
curr_Factors:  [93.21093225]
mat_Sqrt:  [[0.15]]
grads:  [0.20347263]
Stock Position:  0.20347262507587516
Bond Position:  [3.26907892]


portfolio before change:  [22.22449745]
curr_Stock_Price:  93.15754323043083
curr_Factors:  [93.15754323]
mat_Sqrt:  [[0.15]]
grads:  [-0.06821415]
Stock Position:  -0.06821415246861177
Bond Position:  [28.5791603]


portfolio before change:  [22.14551578]
curr_Stock_Price:  94.36776540213027
curr_Factors:  [94.3677654]
mat_Sqrt:  [[0.15]]
grads:  [-0.03599485]
Stock Position:  -0.035994850315025494
Bond Position:  [25.54226938]


portfolio before change:  [22.12406526]
curr_Stock_Price:  95.05240523054854
curr_Factors:  [95.05240523]
mat_Sqrt:  [[0.15]]
grads:  [0.1538383]
Stock Position:  0.153838296674058
Bond Position:  [7.50136514]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.99209945]
Stock Price:  94.1884880936458
PL:  [21.99209945]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.77176485e-02]
 [-3.27781324e-02]
 [ 1.16582848e-03]
 [-9.89765443e-04]
 [-2.77172889e-03]
 [ 2.78794615e-02]
 [ 3.67546766e-03]
 [ 1.52441566e-02]
 [ 5.82447586e-03]
 [ 2.28258691e-02]
 [ 1.68625895e-02]
 [-1.50514898e-03]
 [ 3.77895211e-03]
 [ 2.33317038e-02]
 [-8.50759670e-03]
 [-4.39772999e-03]
 [-4.26426688e-03]
 [ 7.69580485e-03]
 [ 2.59681962e-02]
 [-2.16740602e-03]
 [ 8.12936113e-05]
 [-1.87317801e-02]
 [ 6.78921334e-03]
 [-1.02964819e-02]
 [-7.68198236e-03]
 [ 4.52611648e-03]
 [ 6.85208214e-03]
 [ 2.73954586e-03]
 [ 5.41210156e-03]
 [ 5.11789966e-03]
 [-1.38557852e-02]
 [ 5.32005944e-03]
 [-6.70410351e-04]
 [-1.95149498e-02]
 [-2.03500772e-02]
 [ 1.98283664e-02]
 [ 2.91201731e-03]
 [ 1.44780809e-02]
 [ 6.80590218e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.44374178]
curr_Stock_Price:  99.89386509542301
curr_Factors:  [99.8938651]
mat_Sqrt:  [[0.15]]
grads:  [0.11811766]
Stock Position:  0.11811765654231295
Bond Position:  [-12.24297103]


portfolio before change:  [-0.20601035]
curr_Stock_Price:  101.91948852055026
curr_Factors:  [101.91948852]
mat_Sqrt:  [[0.15]]
grads:  [-0.21852088]
Stock Position:  -0.21852088274653098
Bond Position:  [22.06552625]


portfolio before change:  [-0.11417537]
curr_Stock_Price:  101.51185415727275
curr_Factors:  [101.51185416]
mat_Sqrt:  [[0.15]]
grads:  [0.00777219]
Stock Position:  0.007772189889595667
Bond Position:  [-0.90314478]


portfolio before change:  [-0.11306792]
curr_Stock_Price:  101.6688686966184
curr_Factors:  [101.6688687]
mat_Sqrt:  [[0.15]]
grads:  [-0.00659844]
Stock Position:  -0.006598436288050109
Bond Position:  [0.55778763]


portfolio before change:  [-0.11083202]
curr_Stock_Price:  101.34058250179353
curr_Factors:  [101.3405825]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847819]
Stock Position:  -0.01847819260699301
Bond Position:  [1.76175878]


portfolio before change:  [-0.11432818]
curr_Stock_Price:  101.54170593231404
curr_Factors:  [101.54170593]
mat_Sqrt:  [[0.15]]
grads:  [0.18586308]
Stock Position:  0.18586307655106324
Bond Position:  [-18.98718205]


portfolio before change:  [-0.16358467]
curr_Stock_Price:  101.28946142426749
curr_Factors:  [101.28946142]
mat_Sqrt:  [[0.15]]
grads:  [0.02450312]
Stock Position:  0.02450311776410467
Bond Position:  [-2.64549227]


portfolio before change:  [-0.14688026]
curr_Stock_Price:  101.98468389691762
curr_Factors:  [101.9846839]
mat_Sqrt:  [[0.15]]
grads:  [0.10162771]
Stock Position:  0.10162771085712527
Bond Position:  [-10.51135022]


portfolio before change:  [-0.09834334]
curr_Stock_Price:  102.47520880425526
curr_Factors:  [102.4752088]
mat_Sqrt:  [[0.15]]
grads:  [0.03882984]
Stock Position:  0.038829839066661306
Bond Position:  [-4.0774392]


portfolio before change:  [-0.09593686]
curr_Stock_Price:  102.55031063367255
curr_Factors:  [102.55031063]
mat_Sqrt:  [[0.15]]
grads:  [0.15217246]
Stock Position:  0.15217246098123746
Bond Position:  [-15.70127]


portfolio before change:  [0.00376437]
curr_Stock_Price:  103.21839473735584
curr_Factors:  [103.21839474]
mat_Sqrt:  [[0.15]]
grads:  [0.11241726]
Stock Position:  0.11241726307273182
Bond Position:  [-11.59976507]


portfolio before change:  [0.00371048]
curr_Stock_Price:  103.23081432696733
curr_Factors:  [103.23081433]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003433]
Stock Position:  -0.010034326540543724
Bond Position:  [1.03956218]


portfolio before change:  [0.00451709]
curr_Stock_Price:  103.16337992740203
curr_Factors:  [103.16337993]
mat_Sqrt:  [[0.15]]
grads:  [0.02519301]
Stock Position:  0.025193014047362405
Bond Position:  [-2.59447939]


portfolio before change:  [0.02994699]
curr_Stock_Price:  104.18565654796761
curr_Factors:  [104.18565655]
mat_Sqrt:  [[0.15]]
grads:  [0.15554469]
Stock Position:  0.15554469207937957
Bond Position:  [-16.17557887]


portfolio before change:  [0.16931953]
curr_Stock_Price:  105.09468537539419
curr_Factors:  [105.09468538]
mat_Sqrt:  [[0.15]]
grads:  [-0.05671731]
Stock Position:  -0.05671731135921674
Bond Position:  [6.13000752]


portfolio before change:  [0.18328412]
curr_Stock_Price:  104.8619822563068
curr_Factors:  [104.86198226]
mat_Sqrt:  [[0.15]]
grads:  [-0.0293182]
Stock Position:  -0.029318199934204037
Bond Position:  [3.25764868]


portfolio before change:  [0.17484906]
curr_Stock_Price:  105.16357975663608
curr_Factors:  [105.16357976]
mat_Sqrt:  [[0.15]]
grads:  [-0.02842845]
Stock Position:  -0.028428445849080164
Bond Position:  [3.16448619]


portfolio before change:  [0.17671335]
curr_Stock_Price:  105.11191655072759
curr_Factors:  [105.11191655]
mat_Sqrt:  [[0.15]]
grads:  [0.05130537]
Stock Position:  0.05130536569079216
Bond Position:  [-5.21609197]


portfolio before change:  [0.17867317]
curr_Stock_Price:  105.16282490664152
curr_Factors:  [105.16282491]
mat_Sqrt:  [[0.15]]
grads:  [0.17312131]
Stock Position:  0.17312130819749755
Bond Position:  [-18.02725265]


portfolio before change:  [0.14354666]
curr_Stock_Price:  104.9729409476967
curr_Factors:  [104.97294095]
mat_Sqrt:  [[0.15]]
grads:  [-0.01444937]
Stock Position:  -0.0144493734391438
Bond Position:  [1.66033988]


portfolio before change:  [0.14473818]
curr_Stock_Price:  104.90484336884157
curr_Factors:  [104.90484337]
mat_Sqrt:  [[0.15]]
grads:  [0.00054196]
Stock Position:  0.0005419574089186342
Bond Position:  [0.08788423]


portfolio before change:  [0.1452085]
curr_Stock_Price:  105.75237530874246
curr_Factors:  [105.75237531]
mat_Sqrt:  [[0.15]]
grads:  [-0.12487853]
Stock Position:  -0.12487853396087131
Bond Position:  [13.35141009]


portfolio before change:  [0.20360557]
curr_Stock_Price:  105.29810953025483
curr_Factors:  [105.29810953]
mat_Sqrt:  [[0.15]]
grads:  [0.04526142]
Stock Position:  0.045261422245259586
Bond Position:  [-4.56233663]


portfolio before change:  [0.15076697]
curr_Stock_Price:  104.14330119271524
curr_Factors:  [104.14330119]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864321]
Stock Position:  -0.06864321275131263
Bond Position:  [7.29949776]


portfolio before change:  [0.05877172]
curr_Stock_Price:  105.49678894523117
curr_Factors:  [105.49678895]
mat_Sqrt:  [[0.15]]
grads:  [-0.05121322]
Stock Position:  -0.051213215714035254
Bond Position:  [5.46160153]


portfolio before change:  [0.10415594]
curr_Stock_Price:  104.62393858037889
curr_Factors:  [104.62393858]
mat_Sqrt:  [[0.15]]
grads:  [0.03017411]
Stock Position:  0.030174109892756516
Bond Position:  [-3.05277828]


portfolio before change:  [0.10597061]
curr_Stock_Price:  104.69672583145305
curr_Factors:  [104.69672583]
mat_Sqrt:  [[0.15]]
grads:  [0.04568055]
Stock Position:  0.04568054763087646
Bond Position:  [-4.67663316]


portfolio before change:  [0.15246404]
curr_Stock_Price:  105.72731863426304
curr_Factors:  [105.72731863]
mat_Sqrt:  [[0.15]]
grads:  [0.01826364]
Stock Position:  0.0182636390385172
Bond Position:  [-1.77850155]


portfolio before change:  [0.14732806]
curr_Stock_Price:  105.45827882488905
curr_Factors:  [105.45827882]
mat_Sqrt:  [[0.15]]
grads:  [0.03608068]
Stock Position:  0.03608067705626955
Bond Position:  [-3.65767804]


portfolio before change:  [0.18695631]
curr_Stock_Price:  106.56927466481167
curr_Factors:  [106.56927466]
mat_Sqrt:  [[0.15]]
grads:  [0.03411933]
Stock Position:  0.03411933105044005
Bond Position:  [-3.44911606]


portfolio before change:  [0.15507384]
curr_Stock_Price:  105.64747166039528
curr_Factors:  [105.64747166]
mat_Sqrt:  [[0.15]]
grads:  [-0.0923719]
Stock Position:  -0.09237190163739999
Bond Position:  [9.9139317]


portfolio before change:  [0.22153971]
curr_Stock_Price:  104.94134186953491
curr_Factors:  [104.94134187]
mat_Sqrt:  [[0.15]]
grads:  [0.03546706]
Stock Position:  0.035467062952407216
Bond Position:  [-3.50042147]


portfolio before change:  [0.16330833]
curr_Stock_Price:  103.31183580672295
curr_Factors:  [103.31183581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0044694]
Stock Position:  -0.004469402338907772
Bond Position:  [0.6250505]


portfolio before change:  [0.16986484]
curr_Stock_Price:  101.86234141070729
curr_Factors:  [101.86234141]
mat_Sqrt:  [[0.15]]
grads:  [-0.13009967]
Stock Position:  -0.13009966521629762
Bond Position:  [13.42212136]


portfolio before change:  [0.04239842]
curr_Stock_Price:  102.85499799924693
curr_Factors:  [102.854998]
mat_Sqrt:  [[0.15]]
grads:  [-0.13566718]
Stock Position:  -0.13566718158521424
Bond Position:  [13.99644612]


portfolio before change:  [0.0498244]
curr_Stock_Price:  102.81315805500479
curr_Factors:  [102.81315806]
mat_Sqrt:  [[0.15]]
grads:  [0.13218911]
Stock Position:  0.13218910964109334
Bond Position:  [-13.54095543]


portfolio before change:  [0.09023751]
curr_Stock_Price:  103.1316853704645
curr_Factors:  [103.13168537]
mat_Sqrt:  [[0.15]]
grads:  [0.01941345]
Stock Position:  0.019413448727542016
Bond Position:  [-1.91190417]


portfolio before change:  [0.06015239]
curr_Stock_Price:  101.59429152468691
curr_Factors:  [101.59429152]
mat_Sqrt:  [[0.15]]
grads:  [0.09652054]
Stock Position:  0.09652053944080043
Bond Position:  [-9.74578343]


portfolio before change:  [-0.06181176]
curr_Stock_Price:  100.34330535267155
curr_Factors:  [100.34330535]
mat_Sqrt:  [[0.15]]
grads:  [0.04537268]
Stock Position:  0.045372681199912265
Bond Position:  [-4.61465657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.04077804]
Stock Price:  100.81959617470606
PL:  [-0.86037422]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.81304482e-03]
 [ 3.82438407e-02]
 [-6.34691644e-03]
 [-7.47869005e-03]
 [-5.86223332e-03]
 [ 4.67079979e-02]
 [ 3.56110981e-03]
 [-2.52831836e-03]
 [-4.43648993e-03]
 [ 2.34462067e-02]
 [ 2.16267942e-02]
 [-8.32032440e-03]
 [-1.57497636e-02]
 [ 1.74613436e-02]
 [-1.18604543e-02]
 [-1.53704477e-04]
 [-6.11248047e-03]
 [ 1.89716356e-03]
 [ 5.06020604e-03]
 [-2.07253179e-02]
 [-2.74502287e-03]
 [-1.08730040e-02]
 [ 7.02554540e-03]
 [-6.39342634e-03]
 [ 1.32200086e-02]
 [ 8.23093429e-03]
 [-6.75906066e-03]
 [-2.05400034e-03]
 [-7.91036116e-03]
 [-1.00618821e-02]
 [-2.94629582e-02]
 [ 1.88690751e-02]
 [-3.80718395e-03]
 [-1.89362054e-02]
 [-2.11419068e-02]
 [ 2.84563147e-02]
 [ 3.14029264e-03]
 [ 9.49844610e-03]
 [ 7.70185723e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.2451594]
curr_Stock_Price:  99.40190317264054
curr_Factors:  [99.40190317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0654203]
Stock Position:  -0.06542029881194784
Bond Position:  [-4.74225719]


portfolio before change:  [-11.27382762]
curr_Stock_Price:  99.83105744306039
curr_Factors:  [99.83105744]
mat_Sqrt:  [[0.15]]
grads:  [0.25495894]
Stock Position:  0.2549589383204645
Bond Position:  [-36.72664804]


portfolio before change:  [-11.36653844]
curr_Stock_Price:  99.48543433790516
curr_Factors:  [99.48543434]
mat_Sqrt:  [[0.15]]
grads:  [-0.04231278]
Stock Position:  -0.04231277625485161
Bond Position:  [-7.15703351]


portfolio before change:  [-11.32612019]
curr_Stock_Price:  98.50906415091885
curr_Factors:  [98.50906415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985793]
Stock Position:  -0.04985793363722904
Bond Position:  [-6.41466181]


portfolio before change:  [-11.31886722]
curr_Stock_Price:  98.3475080743808
curr_Factors:  [98.34750807]
mat_Sqrt:  [[0.15]]
grads:  [-0.03908156]
Stock Position:  -0.03908155548286713
Bond Position:  [-7.47529363]


portfolio before change:  [-11.29217908]
curr_Stock_Price:  97.64071392764738
curr_Factors:  [97.64071393]
mat_Sqrt:  [[0.15]]
grads:  [0.31138665]
Stock Position:  0.31138665255632836
Bond Position:  [-41.69619414]


portfolio before change:  [-11.00982595]
curr_Stock_Price:  98.56421361799151
curr_Factors:  [98.56421362]
mat_Sqrt:  [[0.15]]
grads:  [0.02374073]
Stock Position:  0.02374073208092981
Bond Position:  [-13.34981254]


portfolio before change:  [-11.01609664]
curr_Stock_Price:  98.3703753353632
curr_Factors:  [98.37037534]
mat_Sqrt:  [[0.15]]
grads:  [-0.01685546]
Stock Position:  -0.016855455759005197
Bond Position:  [-9.35801913]


portfolio before change:  [-11.00784426]
curr_Stock_Price:  97.8113748598785
curr_Factors:  [97.81137486]
mat_Sqrt:  [[0.15]]
grads:  [-0.0295766]
Stock Position:  -0.029576599534058223
Bond Position:  [-8.1149164]


portfolio before change:  [-10.98090227]
curr_Stock_Price:  96.86615411855885
curr_Factors:  [96.86615412]
mat_Sqrt:  [[0.15]]
grads:  [0.15630804]
Stock Position:  0.15630804444660143
Bond Position:  [-26.1218614]


portfolio before change:  [-11.02173308]
curr_Stock_Price:  96.62582502537761
curr_Factors:  [96.62582503]
mat_Sqrt:  [[0.15]]
grads:  [0.14417863]
Stock Position:  0.1441786282426115
Bond Position:  [-24.95311199]


portfolio before change:  [-10.91750677]
curr_Stock_Price:  97.3703573376443
curr_Factors:  [97.37035734]
mat_Sqrt:  [[0.15]]
grads:  [-0.05546883]
Stock Position:  -0.055468829312441084
Bond Position:  [-5.51648704]


portfolio before change:  [-10.89043125]
curr_Stock_Price:  96.86980368053567
curr_Factors:  [96.86980368]
mat_Sqrt:  [[0.15]]
grads:  [-0.10499842]
Stock Position:  -0.10499842420993495
Bond Position:  [-0.71925451]


portfolio before change:  [-10.74082294]
curr_Stock_Price:  95.44408495551963
curr_Factors:  [95.44408496]
mat_Sqrt:  [[0.15]]
grads:  [0.11640896]
Stock Position:  0.11640895712900094
Bond Position:  [-21.85136933]


portfolio before change:  [-10.67854008]
curr_Stock_Price:  96.00258532906736
curr_Factors:  [96.00258533]
mat_Sqrt:  [[0.15]]
grads:  [-0.0790697]
Stock Position:  -0.07906969513225141
Bond Position:  [-3.08764493]


portfolio before change:  [-10.71691741]
curr_Stock_Price:  96.48306456387719
curr_Factors:  [96.48306456]
mat_Sqrt:  [[0.15]]
grads:  [-0.0010247]
Stock Position:  -0.001024696514952371
Bond Position:  [-10.61805155]


portfolio before change:  [-10.71880057]
curr_Stock_Price:  97.02548863222847
curr_Factors:  [97.02548863]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074987]
Stock Position:  -0.04074986980485382
Bond Position:  [-6.76502454]


portfolio before change:  [-10.74766096]
curr_Stock_Price:  97.71296824518056
curr_Factors:  [97.71296825]
mat_Sqrt:  [[0.15]]
grads:  [0.01264776]
Stock Position:  0.012647757060676956
Bond Position:  [-11.98351084]


portfolio before change:  [-10.73702073]
curr_Stock_Price:  98.67268420851295
curr_Factors:  [98.67268421]
mat_Sqrt:  [[0.15]]
grads:  [0.03373471]
Stock Position:  0.03373470692195009
Bond Position:  [-14.06571482]


portfolio before change:  [-10.71945757]
curr_Stock_Price:  99.24543216342221
curr_Factors:  [99.24543216]
mat_Sqrt:  [[0.15]]
grads:  [-0.13816879]
Stock Position:  -0.1381687860034173
Bond Position:  [2.9931633]


portfolio before change:  [-10.67567912]
curr_Stock_Price:  98.93129255519241
curr_Factors:  [98.93129256]
mat_Sqrt:  [[0.15]]
grads:  [-0.01830015]
Stock Position:  -0.018300152479030555
Bond Position:  [-8.86522138]


portfolio before change:  [-10.67266541]
curr_Stock_Price:  98.7060523011539
curr_Factors:  [98.7060523]
mat_Sqrt:  [[0.15]]
grads:  [-0.07248669]
Stock Position:  -0.07248669318977438
Bond Position:  [-3.51779008]


portfolio before change:  [-10.75684225]
curr_Stock_Price:  99.86125869843129
curr_Factors:  [99.8612587]
mat_Sqrt:  [[0.15]]
grads:  [0.04683697]
Stock Position:  0.04683696930537987
Bond Position:  [-15.43404096]


portfolio before change:  [-10.80173036]
curr_Stock_Price:  98.9440615089807
curr_Factors:  [98.94406151]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262284]
Stock Position:  -0.042622842297828964
Bond Position:  [-6.58445323]


portfolio before change:  [-10.84553748]
curr_Stock_Price:  99.95253511583884
curr_Factors:  [99.95253512]
mat_Sqrt:  [[0.15]]
grads:  [0.08813339]
Stock Position:  0.08813339094092233
Bond Position:  [-19.65469334]


portfolio before change:  [-10.8583192]
curr_Stock_Price:  99.83538628297309
curr_Factors:  [99.83538628]
mat_Sqrt:  [[0.15]]
grads:  [0.0548729]
Stock Position:  0.05487289526162738
Bond Position:  [-16.33657589]


portfolio before change:  [-10.86484128]
curr_Stock_Price:  99.75374521147155
curr_Factors:  [99.75374521]
mat_Sqrt:  [[0.15]]
grads:  [-0.0450604]
Stock Position:  -0.04506040437543365
Bond Position:  [-6.36989718]


portfolio before change:  [-10.86639307]
curr_Stock_Price:  99.77051179388852
curr_Factors:  [99.77051179]
mat_Sqrt:  [[0.15]]
grads:  [-0.01369334]
Stock Position:  -0.013693335581342218
Bond Position:  [-9.50020197]


portfolio before change:  [-10.85007606]
curr_Stock_Price:  98.49218086846227
curr_Factors:  [98.49218087]
mat_Sqrt:  [[0.15]]
grads:  [-0.05273574]
Stock Position:  -0.05273574109794872
Bond Position:  [-5.65601791]


portfolio before change:  [-10.92283475]
curr_Stock_Price:  99.85845808038887
curr_Factors:  [99.85845808]
mat_Sqrt:  [[0.15]]
grads:  [-0.06707921]
Stock Position:  -0.06707921416116625
Bond Position:  [-4.22440785]


portfolio before change:  [-10.98391096]
curr_Stock_Price:  100.76109431343633
curr_Factors:  [100.76109431]
mat_Sqrt:  [[0.15]]
grads:  [-0.19641972]
Stock Position:  -0.19641972165486074
Bond Position:  [8.80755514]


portfolio before change:  [-11.03071611]
curr_Stock_Price:  101.00499120692874
curr_Factors:  [101.00499121]
mat_Sqrt:  [[0.15]]
grads:  [0.12579383]
Stock Position:  0.12579383411319703
Bond Position:  [-23.73652122]


portfolio before change:  [-11.02658094]
curr_Stock_Price:  101.06145199791017
curr_Factors:  [101.061452]
mat_Sqrt:  [[0.15]]
grads:  [-0.02538123]
Stock Position:  -0.02538122635802428
Bond Position:  [-8.46151735]


portfolio before change:  [-11.01802699]
curr_Stock_Price:  100.68275848450291
curr_Factors:  [100.68275848]
mat_Sqrt:  [[0.15]]
grads:  [-0.12624137]
Stock Position:  -0.12624136910083875
Bond Position:  [1.69230229]


portfolio before change:  [-11.00803574]
curr_Stock_Price:  100.6052902682236
curr_Factors:  [100.60529027]
mat_Sqrt:  [[0.15]]
grads:  [-0.14094605]
Stock Position:  -0.1409460453022265
Bond Position:  [3.17188206]


portfolio before change:  [-10.93167275]
curr_Stock_Price:  100.06631461288656
curr_Factors:  [100.06631461]
mat_Sqrt:  [[0.15]]
grads:  [0.18970876]
Stock Position:  0.1897087644519389
Bond Position:  [-29.91512965]


portfolio before change:  [-11.04813042]
curr_Stock_Price:  99.4721509797548
curr_Factors:  [99.47215098]
mat_Sqrt:  [[0.15]]
grads:  [0.02093528]
Stock Position:  0.020935284267635176
Bond Position:  [-13.13060818]


portfolio before change:  [-11.03116212]
curr_Stock_Price:  100.3610681013226
curr_Factors:  [100.3610681]
mat_Sqrt:  [[0.15]]
grads:  [0.06332297]
Stock Position:  0.0633229740203811
Bond Position:  [-17.38632342]


portfolio before change:  [-11.00034346]
curr_Stock_Price:  100.88208085872905
curr_Factors:  [100.88208086]
mat_Sqrt:  [[0.15]]
grads:  [0.05134571]
Stock Position:  0.05134571483955127
Bond Position:  [-16.18020602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.05983697]
Stock Price:  99.76278870973371
PL:  [-11.05983697]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.97845515e-02]
 [ 2.98841048e-02]
 [-1.66612276e-03]
 [-6.73306576e-03]
 [-5.90274805e-03]
 [ 4.49681679e-02]
 [ 3.56636879e-03]
 [-1.92255966e-03]
 [-7.04987493e-03]
 [ 2.34409190e-02]
 [ 1.91136659e-02]
 [-1.43400822e-02]
 [ 1.72882024e-02]
 [ 6.43115202e-03]
 [-8.48022821e-03]
 [-1.51942930e-03]
 [-6.08278767e-03]
 [ 6.09054401e-03]
 [ 6.31446020e-03]
 [-8.36644113e-04]
 [-4.73414763e-03]
 [-4.62801920e-03]
 [ 7.04455752e-03]
 [-7.62760748e-03]
 [ 1.31096074e-02]
 [ 8.21362161e-03]
 [-2.59762964e-03]
 [-2.71621935e-03]
 [-1.55080881e-02]
 [-1.30984708e-02]
 [ 3.58220886e-02]
 [ 4.34431330e-03]
 [-1.54249191e-02]
 [-3.71859713e-02]
 [-2.37853434e-02]
 [ 3.48262752e-02]
 [-5.08956205e-03]
 [-2.66208235e-03]
 [ 2.68412001e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.25995174]
curr_Stock_Price:  99.92591555635535
curr_Factors:  [99.92591556]
mat_Sqrt:  [[0.15]]
grads:  [0.13189701]
Stock Position:  0.13189701004413423
Bond Position:  [-12.91997775]


portfolio before change:  [0.17317939]
curr_Stock_Price:  99.28028111950731
curr_Factors:  [99.28028112]
mat_Sqrt:  [[0.15]]
grads:  [0.19922737]
Stock Position:  0.19922736549146444
Bond Position:  [-19.60616947]


portfolio before change:  [0.28940097]
curr_Stock_Price:  99.87594483591732
curr_Factors:  [99.87594484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01110749]
Stock Position:  -0.011107485090867873
Bond Position:  [1.39877154]


portfolio before change:  [0.29615672]
curr_Stock_Price:  99.283471538471
curr_Factors:  [99.28347154]
mat_Sqrt:  [[0.15]]
grads:  [-0.04488711]
Stock Position:  -0.0448871050845437
Bond Position:  [4.75270434]


portfolio before change:  [0.33731117]
curr_Stock_Price:  98.37986400107506
curr_Factors:  [98.379864]
mat_Sqrt:  [[0.15]]
grads:  [-0.03935165]
Stock Position:  -0.03935165367384556
Bond Position:  [4.20872151]


portfolio before change:  [0.36036013]
curr_Stock_Price:  97.8075162240672
curr_Factors:  [97.80751622]
mat_Sqrt:  [[0.15]]
grads:  [0.29978779]
Stock Position:  0.2997877861245673
Bond Position:  [-28.96113863]


portfolio before change:  [0.24566161]
curr_Stock_Price:  97.4369936397644
curr_Factors:  [97.43699364]
mat_Sqrt:  [[0.15]]
grads:  [0.02377579]
Stock Position:  0.023775791924752276
Bond Position:  [-2.07098007]


portfolio before change:  [0.26252035]
curr_Stock_Price:  98.15695393775859
curr_Factors:  [98.15695394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01281706]
Stock Position:  -0.012817064404849591
Bond Position:  [1.52060435]


portfolio before change:  [0.26616781]
curr_Stock_Price:  97.8872060927206
curr_Factors:  [97.88720609]
mat_Sqrt:  [[0.15]]
grads:  [-0.04699917]
Stock Position:  -0.04699916622887748
Bond Position:  [4.86678488]


portfolio before change:  [0.23582152]
curr_Stock_Price:  98.54582786017548
curr_Factors:  [98.54582786]
mat_Sqrt:  [[0.15]]
grads:  [0.15627279]
Stock Position:  0.1562727933746431
Bond Position:  [-15.16421027]


portfolio before change:  [0.45462648]
curr_Stock_Price:  99.95810569733611
curr_Factors:  [99.9581057]
mat_Sqrt:  [[0.15]]
grads:  [0.12742444]
Stock Position:  0.12742443934757233
Bond Position:  [-12.28247909]


portfolio before change:  [0.48575882]
curr_Stock_Price:  100.2144752387926
curr_Factors:  [100.21447524]
mat_Sqrt:  [[0.15]]
grads:  [-0.09560055]
Stock Position:  -0.09560054813792772
Bond Position:  [10.06631759]


portfolio before change:  [0.54192019]
curr_Stock_Price:  99.6401793926554
curr_Factors:  [99.64017939]
mat_Sqrt:  [[0.15]]
grads:  [0.11525468]
Stock Position:  0.11525468299200717
Bond Position:  [-10.9420771]


portfolio before change:  [0.50257957]
curr_Stock_Price:  99.31071104956891
curr_Factors:  [99.31071105]
mat_Sqrt:  [[0.15]]
grads:  [0.04287435]
Stock Position:  0.042874346802772904
Bond Position:  [-3.75530229]


portfolio before change:  [0.50889427]
curr_Stock_Price:  99.46894412094763
curr_Factors:  [99.46894412]
mat_Sqrt:  [[0.15]]
grads:  [-0.05653485]
Stock Position:  -0.05653485471248038
Bond Position:  [6.13235657]


portfolio before change:  [0.51934165]
curr_Stock_Price:  99.29770830924004
curr_Factors:  [99.29770831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01012953]
Stock Position:  -0.010129528661503654
Bond Position:  [1.52518064]


portfolio before change:  [0.50760861]
curr_Stock_Price:  100.47483160782743
curr_Factors:  [100.47483161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055192]
Stock Position:  -0.04055191776755593
Bond Position:  [4.58205572]


portfolio before change:  [0.49431879]
curr_Stock_Price:  100.81668007299568
curr_Factors:  [100.81668007]
mat_Sqrt:  [[0.15]]
grads:  [0.04060363]
Stock Position:  0.040603626738436
Bond Position:  [-3.59920405]


portfolio before change:  [0.46552373]
curr_Stock_Price:  100.11858634178702
curr_Factors:  [100.11858634]
mat_Sqrt:  [[0.15]]
grads:  [0.0420964]
Stock Position:  0.04209640131943259
Bond Position:  [-3.74910846]


portfolio before change:  [0.473566]
curr_Stock_Price:  100.32076381667407
curr_Factors:  [100.32076382]
mat_Sqrt:  [[0.15]]
grads:  [-0.00557763]
Stock Position:  -0.005577627421931841
Bond Position:  [1.03311785]


portfolio before change:  [0.47434477]
curr_Stock_Price:  100.20429458242906
curr_Factors:  [100.20429458]
mat_Sqrt:  [[0.15]]
grads:  [-0.03156098]
Stock Position:  -0.031560984185845534
Bond Position:  [3.63689093]


portfolio before change:  [0.47021501]
curr_Stock_Price:  100.34955004034539
curr_Factors:  [100.34955004]
mat_Sqrt:  [[0.15]]
grads:  [-0.03085346]
Stock Position:  -0.030853461335404155
Bond Position:  [3.56634597]


portfolio before change:  [0.50405909]
curr_Stock_Price:  99.26706982435283
curr_Factors:  [99.26706982]
mat_Sqrt:  [[0.15]]
grads:  [0.04696372]
Stock Position:  0.046963716812765254
Bond Position:  [-4.15789147]


portfolio before change:  [0.52963857]
curr_Stock_Price:  99.8228020741658
curr_Factors:  [99.82280207]
mat_Sqrt:  [[0.15]]
grads:  [-0.05085072]
Stock Position:  -0.05085071652652801
Bond Position:  [5.60569958]


portfolio before change:  [0.52296527]
curr_Stock_Price:  99.96781593134548
curr_Factors:  [99.96781593]
mat_Sqrt:  [[0.15]]
grads:  [0.08739738]
Stock Position:  0.08739738298483164
Bond Position:  [-8.21396023]


portfolio before change:  [0.49583913]
curr_Stock_Price:  99.66918767505292
curr_Factors:  [99.66918768]
mat_Sqrt:  [[0.15]]
grads:  [0.05475748]
Stock Position:  0.05475747738776482
Bond Position:  [-4.96179416]


portfolio before change:  [0.43747405]
curr_Stock_Price:  98.6146318066207
curr_Factors:  [98.61463181]
mat_Sqrt:  [[0.15]]
grads:  [-0.01731753]
Stock Position:  -0.017317530925856514
Bond Position:  [2.14523599]


portfolio before change:  [0.43237716]
curr_Stock_Price:  98.92443723124865
curr_Factors:  [98.92443723]
mat_Sqrt:  [[0.15]]
grads:  [-0.01810813]
Stock Position:  -0.018108129013245846
Bond Position:  [2.22371363]


portfolio before change:  [0.46031392]
curr_Stock_Price:  97.39701391648148
curr_Factors:  [97.39701392]
mat_Sqrt:  [[0.15]]
grads:  [-0.10338725]
Stock Position:  -0.10338725405340492
Bond Position:  [10.52992374]


portfolio before change:  [0.48632734]
curr_Stock_Price:  97.1581343420206
curr_Factors:  [97.15813434]
mat_Sqrt:  [[0.15]]
grads:  [-0.08732314]
Stock Position:  -0.08732313870597815
Bond Position:  [8.97048058]


portfolio before change:  [0.50107683]
curr_Stock_Price:  97.00206909319206
curr_Factors:  [97.00206909]
mat_Sqrt:  [[0.15]]
grads:  [0.23881392]
Stock Position:  0.23881392372618976
Bond Position:  [-22.6643679]


portfolio before change:  [0.34449792]
curr_Stock_Price:  96.35828047842116
curr_Factors:  [96.35828048]
mat_Sqrt:  [[0.15]]
grads:  [0.02896209]
Stock Position:  0.028962088688097833
Bond Position:  [-2.44623914]


portfolio before change:  [0.3499089]
curr_Stock_Price:  96.55566877973996
curr_Factors:  [96.55566878]
mat_Sqrt:  [[0.15]]
grads:  [-0.10283279]
Stock Position:  -0.10283279386648304
Bond Position:  [10.27899808]


portfolio before change:  [0.43127012]
curr_Stock_Price:  95.77696518233284
curr_Factors:  [95.77696518]
mat_Sqrt:  [[0.15]]
grads:  [-0.24790648]
Stock Position:  -0.24790647550295494
Bond Position:  [24.17499999]


portfolio before change:  [0.85536609]
curr_Stock_Price:  94.0784459887117
curr_Factors:  [94.07844599]
mat_Sqrt:  [[0.15]]
grads:  [-0.15856896]
Stock Position:  -0.15856895569654939
Bond Position:  [15.77328703]


portfolio before change:  [0.7713585]
curr_Stock_Price:  94.6206667173961
curr_Factors:  [94.62066672]
mat_Sqrt:  [[0.15]]
grads:  [0.23217517]
Stock Position:  0.23217516826181886
Bond Position:  [-21.19721071]


portfolio before change:  [0.89022002]
curr_Stock_Price:  95.1440273237
curr_Factors:  [95.14402732]
mat_Sqrt:  [[0.15]]
grads:  [-0.03393041]
Stock Position:  -0.033930413635462515
Bond Position:  [4.11849622]


portfolio before change:  [0.89033625]
curr_Stock_Price:  95.15577548387056
curr_Factors:  [95.15577548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774722]
Stock Position:  -0.017747215663798638
Bond Position:  [2.57908632]


portfolio before change:  [0.90149556]
curr_Stock_Price:  94.54514950345143
curr_Factors:  [94.5451495]
mat_Sqrt:  [[0.15]]
grads:  [0.17894133]
Stock Position:  0.1789413337256916
Bond Position:  [-16.01653959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.13700194]
Stock Price:  95.87244803583545
PL:  [1.13700194]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.63579863e-02]
 [-2.28630110e-02]
 [ 7.19340879e-03]
 [ 1.23890619e-02]
 [ 4.73591832e-03]
 [-5.40925626e-03]
 [ 3.44664899e-03]
 [ 3.41440172e-02]
 [ 2.93018063e-02]
 [ 2.26431009e-02]
 [ 1.53830937e-02]
 [ 1.14702672e-03]
 [ 4.38684726e-03]
 [ 2.33729258e-02]
 [-1.16773195e-02]
 [-3.26245706e-03]
 [-5.36990689e-03]
 [ 6.86085942e-03]
 [ 1.50846766e-02]
 [ 1.45465018e-03]
 [ 6.30344013e-04]
 [-4.11378720e-03]
 [ 3.96595755e-03]
 [-1.11440052e-02]
 [-3.56423224e-03]
 [ 4.59400268e-03]
 [ 6.84710533e-03]
 [ 2.54444947e-03]
 [ 5.46626222e-03]
 [-4.03317325e-04]
 [-1.41456296e-02]
 [ 4.55634986e-03]
 [ 1.00390612e-02]
 [ 7.98583622e-02]
 [-1.99229229e-02]
 [-2.56038347e-02]
 [ 2.25617914e-02]
 [ 1.22628713e-02]
 [ 8.19590535e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.81563973]
curr_Stock_Price:  100.22450125905351
curr_Factors:  [100.22450126]
mat_Sqrt:  [[0.15]]
grads:  [0.10905324]
Stock Position:  0.10905324190934922
Bond Position:  [-4.11416705]


portfolio before change:  [6.97719876]
curr_Stock_Price:  101.71068666117642
curr_Factors:  [101.71068666]
mat_Sqrt:  [[0.15]]
grads:  [-0.15242007]
Stock Position:  -0.15242007309361336
Bond Position:  [22.47994906]


portfolio before change:  [6.93518181]
curr_Stock_Price:  102.00478911353058
curr_Factors:  [102.00478911]
mat_Sqrt:  [[0.15]]
grads:  [0.04795606]
Stock Position:  0.04795605857578015
Bond Position:  [2.04343417]


portfolio before change:  [7.03868977]
curr_Stock_Price:  104.1578541656932
curr_Factors:  [104.15785417]
mat_Sqrt:  [[0.15]]
grads:  [0.08259375]
Stock Position:  0.08259374588035426
Bond Position:  [-1.56409756]


portfolio before change:  [7.0367306]
curr_Stock_Price:  104.13650087519527
curr_Factors:  [104.13650088]
mat_Sqrt:  [[0.15]]
grads:  [0.03157279]
Stock Position:  0.03157278883089979
Bond Position:  [3.74885085]


portfolio before change:  [6.99857181]
curr_Stock_Price:  102.91306056249744
curr_Factors:  [102.91306056]
mat_Sqrt:  [[0.15]]
grads:  [-0.03606171]
Stock Position:  -0.03606170841616773
Bond Position:  [10.7097926]


portfolio before change:  [6.99207666]
curr_Stock_Price:  103.13029813298672
curr_Factors:  [103.13029813]
mat_Sqrt:  [[0.15]]
grads:  [0.02297766]
Stock Position:  0.02297765991155804
Bond Position:  [4.62238375]


portfolio before change:  [7.01003844]
curr_Stock_Price:  103.8868567273327
curr_Factors:  [103.88685673]
mat_Sqrt:  [[0.15]]
grads:  [0.22762678]
Stock Position:  0.22762678150844357
Bond Position:  [-16.63739239]


portfolio before change:  [6.83779334]
curr_Stock_Price:  103.13929397138125
curr_Factors:  [103.13929397]
mat_Sqrt:  [[0.15]]
grads:  [0.19534538]
Stock Position:  0.19534537543564467
Bond Position:  [-13.30999077]


portfolio before change:  [6.92781216]
curr_Stock_Price:  103.6086303000201
curr_Factors:  [103.6086303]
mat_Sqrt:  [[0.15]]
grads:  [0.15095401]
Stock Position:  0.15095400574949125
Bond Position:  [-8.71232561]


portfolio before change:  [7.02162364]
curr_Stock_Price:  104.23730249533229
curr_Factors:  [104.2373025]
mat_Sqrt:  [[0.15]]
grads:  [0.10255396]
Stock Position:  0.10255395819878804
Bond Position:  [-3.66832432]


portfolio before change:  [6.96433946]
curr_Stock_Price:  103.68319795480511
curr_Factors:  [103.68319795]
mat_Sqrt:  [[0.15]]
grads:  [0.00764684]
Stock Position:  0.007646844833256913
Bond Position:  [6.17149013]


portfolio before change:  [6.96079089]
curr_Stock_Price:  103.11825269285573
curr_Factors:  [103.11825269]
mat_Sqrt:  [[0.15]]
grads:  [0.02924565]
Stock Position:  0.02924564839055073
Bond Position:  [3.94503073]


portfolio before change:  [6.94789042]
curr_Stock_Price:  102.66028258041034
curr_Factors:  [102.66028258]
mat_Sqrt:  [[0.15]]
grads:  [0.15581951]
Stock Position:  0.15581950502415004
Bond Position:  [-9.048584]


portfolio before change:  [6.91384736]
curr_Stock_Price:  102.44906437239166
curr_Factors:  [102.44906437]
mat_Sqrt:  [[0.15]]
grads:  [-0.0778488]
Stock Position:  -0.07784879659373026
Bond Position:  [14.88938373]


portfolio before change:  [6.85445731]
curr_Stock_Price:  103.23586318347597
curr_Factors:  [103.23586318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02174971]
Stock Position:  -0.021749713704270254
Bond Position:  [9.09980778]


portfolio before change:  [6.86936737]
curr_Stock_Price:  102.60263584529092
curr_Factors:  [102.60263585]
mat_Sqrt:  [[0.15]]
grads:  [-0.03579938]
Stock Position:  -0.0357993792606116
Bond Position:  [10.54247804]


portfolio before change:  [6.90566787]
curr_Stock_Price:  101.62545099780752
curr_Factors:  [101.625451]
mat_Sqrt:  [[0.15]]
grads:  [0.04573906]
Stock Position:  0.045739062828954485
Bond Position:  [2.25741499]


portfolio before change:  [6.94725946]
curr_Stock_Price:  102.52860452963161
curr_Factors:  [102.52860453]
mat_Sqrt:  [[0.15]]
grads:  [0.10056451]
Stock Position:  0.10056451033441004
Bond Position:  [-3.36347945]


portfolio before change:  [7.1512352]
curr_Stock_Price:  104.56109287702007
curr_Factors:  [104.56109288]
mat_Sqrt:  [[0.15]]
grads:  [0.00969767]
Stock Position:  0.009697667850685638
Bond Position:  [6.13723645]


portfolio before change:  [7.14216136]
curr_Stock_Price:  103.5463089386415
curr_Factors:  [103.54630894]
mat_Sqrt:  [[0.15]]
grads:  [0.00420229]
Stock Position:  0.004202293420738246
Bond Position:  [6.70702939]


portfolio before change:  [7.13903721]
curr_Stock_Price:  102.60335203049897
curr_Factors:  [102.60335203]
mat_Sqrt:  [[0.15]]
grads:  [-0.02742525]
Stock Position:  -0.027425247998374692
Bond Position:  [9.95295959]


portfolio before change:  [7.13789671]
curr_Stock_Price:  102.69030490817595
curr_Factors:  [102.69030491]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [4.42279411]


portfolio before change:  [7.16041123]
curr_Stock_Price:  103.52093553905051
curr_Factors:  [103.52093554]
mat_Sqrt:  [[0.15]]
grads:  [-0.07429337]
Stock Position:  -0.0742933680570195
Bond Position:  [14.85133019]


portfolio before change:  [7.10601404]
curr_Stock_Price:  104.2781190960797
curr_Factors:  [104.2781191]
mat_Sqrt:  [[0.15]]
grads:  [-0.02376155]
Stock Position:  -0.0237615482414355
Bond Position:  [9.5838236]


portfolio before change:  [7.0900807]
curr_Stock_Price:  104.99909034996803
curr_Factors:  [104.99909035]
mat_Sqrt:  [[0.15]]
grads:  [0.03062668]
Stock Position:  0.030626684500562412
Bond Position:  [3.87430669]


portfolio before change:  [7.08354409]
curr_Stock_Price:  104.76984810009105
curr_Factors:  [104.7698481]
mat_Sqrt:  [[0.15]]
grads:  [0.04564737]
Stock Position:  0.04564736889004083
Bond Position:  [2.30107619]


portfolio before change:  [7.11367225]
curr_Stock_Price:  105.42356616852746
curr_Factors:  [105.42356617]
mat_Sqrt:  [[0.15]]
grads:  [0.016963]
Stock Position:  0.01696299643590136
Bond Position:  [5.32537268]


portfolio before change:  [7.13290892]
curr_Stock_Price:  106.51835784414264
curr_Factors:  [106.51835784]
mat_Sqrt:  [[0.15]]
grads:  [0.03644175]
Stock Position:  0.03644174814302122
Bond Position:  [3.25119375]


portfolio before change:  [7.09663861]
curr_Stock_Price:  105.51190971703467
curr_Factors:  [105.51190972]
mat_Sqrt:  [[0.15]]
grads:  [-0.00268878]
Stock Position:  -0.0026887821689026
Bond Position:  [7.38033715]


portfolio before change:  [7.09757179]
curr_Stock_Price:  105.50797470096867
curr_Factors:  [105.5079747]
mat_Sqrt:  [[0.15]]
grads:  [-0.0943042]
Stock Position:  -0.09430419752438929
Bond Position:  [17.04741668]


portfolio before change:  [7.08033365]
curr_Stock_Price:  105.71336538666455
curr_Factors:  [105.71336539]
mat_Sqrt:  [[0.15]]
grads:  [0.03037567]
Stock Position:  0.030375665760437407
Bond Position:  [3.86921979]


portfolio before change:  [7.12446117]
curr_Stock_Price:  107.15016811821695
curr_Factors:  [107.15016812]
mat_Sqrt:  [[0.15]]
grads:  [0.06692707]
Stock Position:  0.06692707471930834
Bond Position:  [-0.04678614]


portfolio before change:  [7.20159868]
curr_Stock_Price:  108.3028160505074
curr_Factors:  [108.30281605]
mat_Sqrt:  [[0.15]]
grads:  [0.53238908]
Stock Position:  0.5323890812656878
Bond Position:  [-50.45763806]


portfolio before change:  [7.43265428]
curr_Stock_Price:  108.74866142195846
curr_Factors:  [108.74866142]
mat_Sqrt:  [[0.15]]
grads:  [-0.13281949]
Stock Position:  -0.13281948600162677
Bond Position:  [21.8765956]


portfolio before change:  [7.5002036]
curr_Stock_Price:  108.26067148875518
curr_Factors:  [108.26067149]
mat_Sqrt:  [[0.15]]
grads:  [-0.17069223]
Stock Position:  -0.17069223134678344
Bond Position:  [25.97945918]


portfolio before change:  [7.64937886]
curr_Stock_Price:  107.40575486228293
curr_Factors:  [107.40575486]
mat_Sqrt:  [[0.15]]
grads:  [0.15041194]
Stock Position:  0.15041194263000332
Bond Position:  [-8.50572938]


portfolio before change:  [7.7526192]
curr_Stock_Price:  108.09920791378468
curr_Factors:  [108.09920791]
mat_Sqrt:  [[0.15]]
grads:  [0.08175248]
Stock Position:  0.08175247544909044
Bond Position:  [-1.08475864]


portfolio before change:  [7.67833595]
curr_Stock_Price:  107.19223053642646
curr_Factors:  [107.19223054]
mat_Sqrt:  [[0.15]]
grads:  [0.05463937]
Stock Position:  0.054639369030218314
Bond Position:  [1.82142011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.73723374]
Stock Price:  108.26600020651404
PL:  [-0.52876647]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 6.62530112e-03]
 [ 4.39295918e-02]
 [-1.15722691e-03]
 [-2.13321740e-03]
 [-1.61112591e-03]
 [ 2.78581602e-02]
 [ 3.69986368e-03]
 [ 1.05897377e-02]
 [ 3.93027124e-02]
 [ 2.24735870e-02]
 [ 1.52060509e-02]
 [ 5.13038321e-03]
 [-1.52078709e-03]
 [ 2.33065120e-02]
 [-1.02814859e-02]
 [-3.32503534e-03]
 [-5.02571937e-03]
 [ 6.52498293e-03]
 [ 8.51188870e-03]
 [ 8.90332284e-03]
 [-4.71915879e-03]
 [-9.09560588e-03]
 [ 6.56450585e-03]
 [-7.44604497e-03]
 [ 1.34218539e-02]
 [ 3.29450602e-03]
 [ 2.18118924e-02]
 [-4.06925532e-03]
 [-1.69508656e-02]
 [-1.42144002e-02]
 [ 1.21052814e-02]
 [ 7.12432383e-03]
 [-1.14304625e-02]
 [-4.98569465e-02]
 [-2.28366003e-02]
 [ 3.95053812e-02]
 [-6.60004674e-04]
 [ 1.09291014e-03]
 [ 1.71067262e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23494776]
curr_Stock_Price:  99.76673668404892
curr_Factors:  [99.76673668]
mat_Sqrt:  [[0.15]]
grads:  [0.04416867]
Stock Position:  0.0441686741635475
Bond Position:  [-7.64151225]


portfolio before change:  [-3.20593387]
curr_Stock_Price:  100.44525252758926
curr_Factors:  [100.44525253]
mat_Sqrt:  [[0.15]]
grads:  [0.29286395]
Stock Position:  0.2928639455866101
Bond Position:  [-32.62272684]


portfolio before change:  [-3.35959767]
curr_Stock_Price:  99.9344839162819
curr_Factors:  [99.93448392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00771485]
Stock Position:  -0.007714846042673161
Bond Position:  [-2.58861851]


portfolio before change:  [-3.36727396]
curr_Stock_Price:  100.88754069836395
curr_Factors:  [100.8875407]
mat_Sqrt:  [[0.15]]
grads:  [-0.01422145]
Stock Position:  -0.014221449366419489
Bond Position:  [-1.9325069]


portfolio before change:  [-3.38273603]
curr_Stock_Price:  101.95778989119493
curr_Factors:  [101.95778989]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074084]
Stock Position:  -0.010740839432759192
Bond Position:  [-2.28762378]


portfolio before change:  [-3.37856189]
curr_Stock_Price:  101.54254175314335
curr_Factors:  [101.54254175]
mat_Sqrt:  [[0.15]]
grads:  [0.18572107]
Stock Position:  0.1857210677259742
Bond Position:  [-22.23715116]


portfolio before change:  [-3.59497936]
curr_Stock_Price:  100.39222715249758
curr_Factors:  [100.39222715]
mat_Sqrt:  [[0.15]]
grads:  [0.02466576]
Stock Position:  0.0246657578704631
Bond Position:  [-6.07122973]


portfolio before change:  [-3.56792987]
curr_Stock_Price:  101.51963809366868
curr_Factors:  [101.51963809]
mat_Sqrt:  [[0.15]]
grads:  [0.07059825]
Stock Position:  0.07059825150809633
Bond Position:  [-10.73503881]


portfolio before change:  [-3.43495556]
curr_Stock_Price:  103.42218190025078
curr_Factors:  [103.4221819]
mat_Sqrt:  [[0.15]]
grads:  [0.26201808]
Stock Position:  0.2620180826592439
Bond Position:  [-30.53343737]


portfolio before change:  [-3.07988706]
curr_Stock_Price:  104.79187905011614
curr_Factors:  [104.79187905]
mat_Sqrt:  [[0.15]]
grads:  [0.14982391]
Stock Position:  0.14982391346485885
Bond Position:  [-18.78021648]


portfolio before change:  [-3.10244155]
curr_Stock_Price:  104.65700859725207
curr_Factors:  [104.6570086]
mat_Sqrt:  [[0.15]]
grads:  [0.10137367]
Stock Position:  0.10137367242921662
Bond Position:  [-13.71190686]


portfolio before change:  [-3.13399666]
curr_Stock_Price:  104.36264210070593
curr_Factors:  [104.3626421]
mat_Sqrt:  [[0.15]]
grads:  [0.03420255]
Stock Position:  0.03420255472934085
Bond Position:  [-6.70346564]


portfolio before change:  [-3.1298173]
curr_Stock_Price:  104.50933728962146
curr_Factors:  [104.50933729]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013858]
Stock Position:  -0.010138580599906959
Bond Position:  [-2.07024096]


portfolio before change:  [-3.13345355]
curr_Stock_Price:  104.84246634665897
curr_Factors:  [104.84246635]
mat_Sqrt:  [[0.15]]
grads:  [0.15537675]
Stock Position:  0.15537674694685416
Bond Position:  [-19.42353491]


portfolio before change:  [-3.32674089]
curr_Stock_Price:  103.61410208373462
curr_Factors:  [103.61410208]
mat_Sqrt:  [[0.15]]
grads:  [-0.06854324]
Stock Position:  -0.06854323953663265
Bond Position:  [3.77530533]


portfolio before change:  [-3.31329171]
curr_Stock_Price:  103.42477300122654
curr_Factors:  [103.424773]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221669]
Stock Position:  -0.022166902251873948
Bond Position:  [-1.02068488]


portfolio before change:  [-3.31451761]
curr_Stock_Price:  103.47431997087475
curr_Factors:  [103.47431997]
mat_Sqrt:  [[0.15]]
grads:  [-0.0335048]
Stock Position:  -0.03350479577476304
Bond Position:  [0.15236835]


portfolio before change:  [-3.23844117]
curr_Stock_Price:  101.20427501777759
curr_Factors:  [101.20427502]
mat_Sqrt:  [[0.15]]
grads:  [0.04349989]
Stock Position:  0.04349988622043745
Bond Position:  [-7.64081562]


portfolio before change:  [-3.23995005]
curr_Stock_Price:  101.19154576097544
curr_Factors:  [101.19154576]
mat_Sqrt:  [[0.15]]
grads:  [0.05674592]
Stock Position:  0.05674592469158707
Bond Position:  [-8.98215789]


portfolio before change:  [-3.25562919]
curr_Stock_Price:  100.93502877499752
curr_Factors:  [100.93502877]
mat_Sqrt:  [[0.15]]
grads:  [0.05935549]
Stock Position:  0.05935548557081376
Bond Position:  [-9.24667683]


portfolio before change:  [-3.3011108]
curr_Stock_Price:  100.18824509740514
curr_Factors:  [100.1882451]
mat_Sqrt:  [[0.15]]
grads:  [-0.03146106]
Stock Position:  -0.03146105863035892
Bond Position:  [-0.14908255]


portfolio before change:  [-3.26609456]
curr_Stock_Price:  99.07465005564792
curr_Factors:  [99.07465006]
mat_Sqrt:  [[0.15]]
grads:  [-0.06063737]
Stock Position:  -0.06063737254930212
Bond Position:  [2.74153191]


portfolio before change:  [-3.21776799]
curr_Stock_Price:  98.2833251804237
curr_Factors:  [98.28332518]
mat_Sqrt:  [[0.15]]
grads:  [0.04376337]
Stock Position:  0.04376337235694855
Bond Position:  [-7.51897774]


portfolio before change:  [-3.23015154]
curr_Stock_Price:  98.02183665557361
curr_Factors:  [98.02183666]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496403]
Stock Position:  -0.04964029977618587
Bond Position:  [1.63568182]


portfolio before change:  [-3.21446552]
curr_Stock_Price:  97.70996219665547
curr_Factors:  [97.7099622]
mat_Sqrt:  [[0.15]]
grads:  [0.08947903]
Stock Position:  0.0894790259750974
Bond Position:  [-11.95745777]


portfolio before change:  [-3.2857262]
curr_Stock_Price:  96.93027216002474
curr_Factors:  [96.93027216]
mat_Sqrt:  [[0.15]]
grads:  [0.02196337]
Stock Position:  0.021963373462646145
Bond Position:  [-5.41464197]


portfolio before change:  [-3.30958522]
curr_Stock_Price:  95.87478117406799
curr_Factors:  [95.87478117]
mat_Sqrt:  [[0.15]]
grads:  [0.14541262]
Stock Position:  0.14541261590516227
Bond Position:  [-17.25098795]


portfolio before change:  [-3.21625071]
curr_Stock_Price:  96.53147124045911
curr_Factors:  [96.53147124]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712837]
Stock Position:  -0.027128368776600777
Bond Position:  [-0.59750936]


portfolio before change:  [-3.23431989]
curr_Stock_Price:  97.19478040914139
curr_Factors:  [97.19478041]
mat_Sqrt:  [[0.15]]
grads:  [-0.11300577]
Stock Position:  -0.11300577068870485
Bond Position:  [7.74925117]


portfolio before change:  [-3.29512873]
curr_Stock_Price:  97.74145647306591
curr_Factors:  [97.74145647]
mat_Sqrt:  [[0.15]]
grads:  [-0.09476267]
Stock Position:  -0.09476266811880811
Bond Position:  [5.96711247]


portfolio before change:  [-3.35223485]
curr_Stock_Price:  98.35195063776952
curr_Factors:  [98.35195064]
mat_Sqrt:  [[0.15]]
grads:  [0.08070188]
Stock Position:  0.08070187629377965
Bond Position:  [-11.2894218]


portfolio before change:  [-3.4414833]
curr_Stock_Price:  97.26353497887688
curr_Factors:  [97.26353498]
mat_Sqrt:  [[0.15]]
grads:  [0.04749549]
Stock Position:  0.04749549216783891
Bond Position:  [-8.06106276]


portfolio before change:  [-3.40588256]
curr_Stock_Price:  98.03431198480797
curr_Factors:  [98.03431198]
mat_Sqrt:  [[0.15]]
grads:  [-0.07620308]
Stock Position:  -0.0762030834247762
Bond Position:  [4.06463429]


portfolio before change:  [-3.33703666]
curr_Stock_Price:  97.1375268990548
curr_Factors:  [97.1375269]
mat_Sqrt:  [[0.15]]
grads:  [-0.33237964]
Stock Position:  -0.3323796433893415
Bond Position:  [28.94949989]


portfolio before change:  [-3.23701921]
curr_Stock_Price:  96.8475015044066
curr_Factors:  [96.8475015]
mat_Sqrt:  [[0.15]]
grads:  [-0.152244]
Stock Position:  -0.1522440023271583
Bond Position:  [11.50743203]


portfolio before change:  [-3.28044988]
curr_Stock_Price:  97.14222043138491
curr_Factors:  [97.14222043]
mat_Sqrt:  [[0.15]]
grads:  [0.26336921]
Stock Position:  0.26336920792855334
Bond Position:  [-28.86471953]


portfolio before change:  [-3.33393392]
curr_Stock_Price:  96.95284476537387
curr_Factors:  [96.95284477]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440003]
Stock Position:  -0.004400031157677517
Bond Position:  [-2.90733838]


portfolio before change:  [-3.33083386]
curr_Stock_Price:  96.16569291977812
curr_Factors:  [96.16569292]
mat_Sqrt:  [[0.15]]
grads:  [0.00728607]
Stock Position:  0.007286067607940785
Bond Position:  [-4.0315036]


portfolio before change:  [-3.33256869]
curr_Stock_Price:  95.99676026103563
curr_Factors:  [95.99676026]
mat_Sqrt:  [[0.15]]
grads:  [0.11404484]
Stock Position:  0.11404484138813203
Bond Position:  [-14.28050399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.29195502]
Stock Price:  96.36853372427215
PL:  [-3.29195502]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.70654238e-02]
 [ 4.23699343e-02]
 [-2.66440424e-03]
 [-6.27489191e-03]
 [-6.51845686e-03]
 [ 2.78550081e-02]
 [ 3.71029720e-03]
 [ 7.69092751e-03]
 [-1.87297797e-02]
 [ 2.32664920e-02]
 [ 2.01257396e-02]
 [-1.13960312e-02]
 [ 2.09316205e-02]
 [ 1.41126664e-02]
 [ 5.19140902e-03]
 [-2.77245595e-03]
 [-6.14676503e-03]
 [ 5.01824859e-03]
 [ 5.22736812e-03]
 [-2.32738732e-02]
 [-2.74798793e-03]
 [-1.45682375e-02]
 [ 6.48288626e-03]
 [-9.10268263e-03]
 [ 1.52059648e-02]
 [ 6.71529663e-03]
 [-1.90136803e-03]
 [-2.46394840e-03]
 [-8.49131095e-03]
 [-1.45516915e-02]
 [ 3.25755547e-02]
 [ 8.60139658e-03]
 [-1.24299312e-02]
 [-4.90033979e-02]
 [-2.29481238e-02]
 [ 3.87168688e-02]
 [-6.11758053e-04]
 [ 6.67572857e-04]
 [ 1.79132033e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.31647977]
curr_Stock_Price:  101.4770559342125
curr_Factors:  [101.47705593]
mat_Sqrt:  [[0.15]]
grads:  [-0.38043616]
Stock Position:  -0.3804361589991789
Bond Position:  [72.92202115]


portfolio before change:  [34.85829653]
curr_Stock_Price:  100.07681852951207
curr_Factors:  [100.07681853]
mat_Sqrt:  [[0.15]]
grads:  [0.28246623]
Stock Position:  0.28246622891349543
Bond Position:  [6.589975]


portfolio before change:  [34.89669218]
curr_Stock_Price:  100.20983215860092
curr_Factors:  [100.20983216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01776269]
Stock Position:  -0.017762694931721265
Bond Position:  [36.67668886]


portfolio before change:  [34.90535191]
curr_Stock_Price:  99.98042710329788
curr_Factors:  [99.9804271]
mat_Sqrt:  [[0.15]]
grads:  [-0.04183261]
Stock Position:  -0.04183261276066098
Bond Position:  [39.0877944]


portfolio before change:  [34.9489768]
curr_Stock_Price:  99.05438859638907
curr_Factors:  [99.0543886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04345638]
Stock Position:  -0.04345637905947047
Bond Position:  [39.25352186]


portfolio before change:  [34.93197245]
curr_Stock_Price:  99.55860322397186
curr_Factors:  [99.55860322]
mat_Sqrt:  [[0.15]]
grads:  [0.18570005]
Stock Position:  0.18570005423753314
Bond Position:  [16.44393444]


portfolio before change:  [35.10741864]
curr_Stock_Price:  100.49231626869522
curr_Factors:  [100.49231627]
mat_Sqrt:  [[0.15]]
grads:  [0.02473531]
Stock Position:  0.024735314668110554
Bond Position:  [32.62170957]


portfolio before change:  [35.12922762]
curr_Stock_Price:  101.20914631383913
curr_Factors:  [101.20914631]
mat_Sqrt:  [[0.15]]
grads:  [0.05127285]
Stock Position:  0.05127285008681817
Bond Position:  [29.93994624]


portfolio before change:  [35.12266539]
curr_Stock_Price:  101.00816358484748
curr_Factors:  [101.00816358]
mat_Sqrt:  [[0.15]]
grads:  [-0.1248652]
Stock Position:  -0.12486519790632175
Bond Position:  [47.73506973]


portfolio before change:  [35.15622269]
curr_Stock_Price:  100.78720498879677
curr_Factors:  [100.78720499]
mat_Sqrt:  [[0.15]]
grads:  [0.15510995]
Stock Position:  0.155109946454791
Bond Position:  [19.52312472]


portfolio before change:  [35.29082515]
curr_Stock_Price:  101.63925816605028
curr_Factors:  [101.63925817]
mat_Sqrt:  [[0.15]]
grads:  [0.1341716]
Stock Position:  0.13417159725412803
Bond Position:  [21.65372354]


portfolio before change:  [35.27959129]
curr_Stock_Price:  101.53535578087907
curr_Factors:  [101.53535578]
mat_Sqrt:  [[0.15]]
grads:  [-0.07597354]
Stock Position:  -0.07597354141450302
Bond Position:  [42.99359185]


portfolio before change:  [35.28352986]
curr_Stock_Price:  101.55425657790458
curr_Factors:  [101.55425658]
mat_Sqrt:  [[0.15]]
grads:  [0.13954414]
Stock Position:  0.13954413676018823
Bond Position:  [21.11222879]


portfolio before change:  [35.22088661]
curr_Stock_Price:  101.08643003747927
curr_Factors:  [101.08643004]
mat_Sqrt:  [[0.15]]
grads:  [0.09408444]
Stock Position:  0.0940844426090036
Bond Position:  [25.71022618]


portfolio before change:  [35.16167944]
curr_Stock_Price:  100.42297128307585
curr_Factors:  [100.42297128]
mat_Sqrt:  [[0.15]]
grads:  [0.03460939]
Stock Position:  0.03460939345446844
Bond Position:  [31.68610131]


portfolio before change:  [35.14681134]
curr_Stock_Price:  99.87892508922232
curr_Factors:  [99.87892509]
mat_Sqrt:  [[0.15]]
grads:  [-0.01848304]
Stock Position:  -0.01848303965414405
Bond Position:  [36.99287747]


portfolio before change:  [35.15404171]
curr_Stock_Price:  99.7379322499742
curr_Factors:  [99.73793225]
mat_Sqrt:  [[0.15]]
grads:  [-0.04097843]
Stock Position:  -0.04097843355163149
Bond Position:  [39.24114594]


portfolio before change:  [35.15904456]
curr_Stock_Price:  99.73555554153114
curr_Factors:  [99.73555554]
mat_Sqrt:  [[0.15]]
grads:  [0.03345499]
Stock Position:  0.03345499060479089
Bond Position:  [31.82239248]


portfolio before change:  [35.13832249]
curr_Stock_Price:  98.9972467842996
curr_Factors:  [98.99724678]
mat_Sqrt:  [[0.15]]
grads:  [0.03484912]
Stock Position:  0.03484912082412927
Bond Position:  [31.68835548]


portfolio before change:  [35.14518686]
curr_Stock_Price:  99.0805510131552
curr_Factors:  [99.08055101]
mat_Sqrt:  [[0.15]]
grads:  [-0.15515915]
Stock Position:  -0.15515915492333296
Bond Position:  [50.51844143]


portfolio before change:  [35.17783759]
curr_Stock_Price:  98.91081867882751
curr_Factors:  [98.91081868]
mat_Sqrt:  [[0.15]]
grads:  [-0.01831992]
Stock Position:  -0.01831991952275019
Bond Position:  [36.98987583]


portfolio before change:  [35.20025183]
curr_Stock_Price:  97.9397328319979
curr_Factors:  [97.93973283]
mat_Sqrt:  [[0.15]]
grads:  [-0.09712158]
Stock Position:  -0.09712158309986235
Bond Position:  [44.71231373]


portfolio before change:  [35.23355517]
curr_Stock_Price:  97.65437961317022
curr_Factors:  [97.65437961]
mat_Sqrt:  [[0.15]]
grads:  [0.04321924]
Stock Position:  0.043219241737027236
Bond Position:  [31.01300693]


portfolio before change:  [35.21837143]
curr_Stock_Price:  97.21335830063732
curr_Factors:  [97.2133583]
mat_Sqrt:  [[0.15]]
grads:  [-0.06068455]
Stock Position:  -0.0606845508384192
Bond Position:  [41.11772042]


portfolio before change:  [35.12007894]
curr_Stock_Price:  98.91778772633796
curr_Factors:  [98.91778773]
mat_Sqrt:  [[0.15]]
grads:  [0.1013731]
Stock Position:  0.10137309861129672
Bond Position:  [25.09247629]


portfolio before change:  [35.06775036]
curr_Stock_Price:  98.37064718563707
curr_Factors:  [98.37064719]
mat_Sqrt:  [[0.15]]
grads:  [0.04476864]
Stock Position:  0.044768644174826414
Bond Position:  [30.66382986]


portfolio before change:  [35.07964775]
curr_Stock_Price:  98.55077719275923
curr_Factors:  [98.55077719]
mat_Sqrt:  [[0.15]]
grads:  [-0.01267579]
Stock Position:  -0.012675786871418708
Bond Position:  [36.3288564]


portfolio before change:  [35.07674959]
curr_Stock_Price:  99.13768770710635
curr_Factors:  [99.13768771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01642632]
Stock Position:  -0.016426322673970924
Bond Position:  [36.70521724]


portfolio before change:  [35.09305134]
curr_Stock_Price:  98.42460624970835
curr_Factors:  [98.42460625]
mat_Sqrt:  [[0.15]]
grads:  [-0.05660874]
Stock Position:  -0.05660873968832712
Bond Position:  [40.66474425]


portfolio before change:  [35.12682631]
curr_Stock_Price:  97.91776643577967
curr_Factors:  [97.91776644]
mat_Sqrt:  [[0.15]]
grads:  [-0.09701128]
Stock Position:  -0.09701127670671379
Bond Position:  [44.62595385]


portfolio before change:  [35.18841731]
curr_Stock_Price:  97.34038605315261
curr_Factors:  [97.34038605]
mat_Sqrt:  [[0.15]]
grads:  [0.21717036]
Stock Position:  0.2171703646794342
Bond Position:  [14.04897018]


portfolio before change:  [35.27793816]
curr_Stock_Price:  97.7445140069877
curr_Factors:  [97.74451401]
mat_Sqrt:  [[0.15]]
grads:  [0.05734264]
Stock Position:  0.05734264386803378
Bond Position:  [29.6730093]


portfolio before change:  [35.27550835]
curr_Stock_Price:  97.63745292967207
curr_Factors:  [97.63745293]
mat_Sqrt:  [[0.15]]
grads:  [-0.08286621]
Stock Position:  -0.08286620802762837
Bond Position:  [43.36635384]


portfolio before change:  [35.28223455]
curr_Stock_Price:  97.62170388711027
curr_Factors:  [97.62170389]
mat_Sqrt:  [[0.15]]
grads:  [-0.32668932]
Stock Position:  -0.3266893190113986
Bond Position:  [67.17420251]


portfolio before change:  [35.64989244]
curr_Stock_Price:  96.5220028345631
curr_Factors:  [96.52200283]
mat_Sqrt:  [[0.15]]
grads:  [-0.15298749]
Stock Position:  -0.152987491902174
Bond Position:  [50.41655156]


portfolio before change:  [35.67409688]
curr_Stock_Price:  96.4049868447562
curr_Factors:  [96.40498684]
mat_Sqrt:  [[0.15]]
grads:  [0.25811246]
Stock Position:  0.25811245851537834
Bond Position:  [10.79076871]


portfolio before change:  [35.82170079]
curr_Stock_Price:  96.9716196104947
curr_Factors:  [96.97161961]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407839]
Stock Position:  -0.004078387020202424
Bond Position:  [36.21718858]


portfolio before change:  [35.82997649]
curr_Stock_Price:  96.05256359877998
curr_Factors:  [96.0525636]
mat_Sqrt:  [[0.15]]
grads:  [0.00445049]
Stock Position:  0.004450485713884597
Bond Position:  [35.40249592]


portfolio before change:  [35.83358382]
curr_Stock_Price:  95.8687056715476
curr_Factors:  [95.86870567]
mat_Sqrt:  [[0.15]]
grads:  [0.11942136]
Stock Position:  0.11942135545696671
Bond Position:  [24.38481304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.85490708]
Stock Price:  96.02173496374581
PL:  [35.85490708]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.70654569e-02]
 [ 3.40598188e-02]
 [-3.55646053e-03]
 [-6.60008732e-03]
 [-7.67861634e-03]
 [ 2.77666189e-02]
 [ 3.54214875e-03]
 [ 4.56058196e-03]
 [-2.73607295e-02]
 [ 2.34057231e-02]
 [ 2.05834462e-02]
 [-1.06609793e-02]
 [-3.53091891e-03]
 [ 7.85352397e-03]
 [-1.06507571e-02]
 [-1.07407019e-03]
 [-6.15251568e-03]
 [ 5.17740254e-03]
 [ 7.46043114e-03]
 [ 7.84777738e-03]
 [-4.76337053e-03]
 [-4.68905992e-03]
 [ 4.94717465e-03]
 [-1.16945833e-02]
 [-5.05583163e-04]
 [ 4.34268333e-03]
 [ 3.38204897e-03]
 [ 9.72588751e-04]
 [ 4.75259204e-03]
 [-4.70759576e-03]
 [-1.69181540e-02]
 [ 7.19462316e-03]
 [-9.47653062e-04]
 [-1.44593054e-02]
 [-2.03292639e-02]
 [ 6.89099257e-03]
 [ 5.75005410e-03]
 [ 2.36001011e-02]
 [ 9.66076777e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.31650735]
curr_Stock_Price:  101.47705719069239
curr_Factors:  [101.47705719]
mat_Sqrt:  [[0.15]]
grads:  [-0.38043638]
Stock Position:  -0.3804363793528043
Bond Position:  [72.92207158]


portfolio before change:  [34.61092841]
curr_Stock_Price:  100.72711515312862
curr_Factors:  [100.72711515]
mat_Sqrt:  [[0.15]]
grads:  [0.22706546]
Stock Position:  0.2270654587411337
Bond Position:  [11.7392798]


portfolio before change:  [34.59062924]
curr_Stock_Price:  100.63125437250098
curr_Factors:  [100.63125437]
mat_Sqrt:  [[0.15]]
grads:  [-0.02370974]
Stock Position:  -0.023709736850273645
Bond Position:  [36.9765698]


portfolio before change:  [34.61407832]
curr_Stock_Price:  99.83720435927714
curr_Factors:  [99.83720436]
mat_Sqrt:  [[0.15]]
grads:  [-0.04400058]
Stock Position:  -0.04400058212325808
Bond Position:  [39.00697343]


portfolio before change:  [34.61009706]
curr_Stock_Price:  100.03850705963465
curr_Factors:  [100.03850706]
mat_Sqrt:  [[0.15]]
grads:  [-0.05119078]
Stock Position:  -0.05119077559465616
Bond Position:  [39.73114583]


portfolio before change:  [34.63279926]
curr_Stock_Price:  99.69204831380084
curr_Factors:  [99.69204831]
mat_Sqrt:  [[0.15]]
grads:  [0.18511079]
Stock Position:  0.18511079297502048
Bond Position:  [16.17872514]


portfolio before change:  [34.57004727]
curr_Stock_Price:  99.34212570359382
curr_Factors:  [99.3421257]
mat_Sqrt:  [[0.15]]
grads:  [0.02361432]
Stock Position:  0.023614324980182098
Bond Position:  [32.22415003]


portfolio before change:  [34.59556374]
curr_Stock_Price:  100.25209020264366
curr_Factors:  [100.2520902]
mat_Sqrt:  [[0.15]]
grads:  [0.03040388]
Stock Position:  0.030403879711750893
Bond Position:  [31.54751125]


portfolio before change:  [34.58825641]
curr_Stock_Price:  99.88203816400629
curr_Factors:  [99.88203816]
mat_Sqrt:  [[0.15]]
grads:  [-0.18240486]
Stock Position:  -0.1824048633582423
Bond Position:  [52.80722593]


portfolio before change:  [34.67488058]
curr_Stock_Price:  99.44332806685317
curr_Factors:  [99.44332807]
mat_Sqrt:  [[0.15]]
grads:  [0.15603815]
Stock Position:  0.1560381537028915
Bond Position:  [19.15792727]


portfolio before change:  [34.56295255]
curr_Stock_Price:  98.71066803535312
curr_Factors:  [98.71066804]
mat_Sqrt:  [[0.15]]
grads:  [0.13722297]
Stock Position:  0.13722297473670372
Bond Position:  [21.01758104]


portfolio before change:  [34.46899769]
curr_Stock_Price:  98.00683383547863
curr_Factors:  [98.00683384]
mat_Sqrt:  [[0.15]]
grads:  [-0.0710732]
Stock Position:  -0.07107319551371735
Bond Position:  [41.43465655]


portfolio before change:  [34.47771684]
curr_Stock_Price:  97.95703320860521
curr_Factors:  [97.95703321]
mat_Sqrt:  [[0.15]]
grads:  [-0.02353946]
Stock Position:  -0.02353945939231188
Bond Position:  [36.78357244]


portfolio before change:  [34.48057797]
curr_Stock_Price:  98.03082826203881
curr_Factors:  [98.03082826]
mat_Sqrt:  [[0.15]]
grads:  [0.05235683]
Stock Position:  0.05235682647091606
Bond Position:  [29.34799491]


portfolio before change:  [34.53271331]
curr_Stock_Price:  98.95652617700992
curr_Factors:  [98.95652618]
mat_Sqrt:  [[0.15]]
grads:  [-0.07100505]
Stock Position:  -0.0710050472792073
Bond Position:  [41.55912613]


portfolio before change:  [34.52620943]
curr_Stock_Price:  99.12129037476835
curr_Factors:  [99.12129037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00716047]
Stock Position:  -0.00716046794490797
Bond Position:  [35.23596426]


portfolio before change:  [34.52507371]
curr_Stock_Price:  99.89505245445085
curr_Factors:  [99.89505245]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101677]
Stock Position:  -0.0410167712197215
Bond Position:  [38.62244622]


portfolio before change:  [34.52696537]
curr_Stock_Price:  99.9666436733826
curr_Factors:  [99.96664367]
mat_Sqrt:  [[0.15]]
grads:  [0.03451602]
Stock Position:  0.034516016931501324
Bond Position:  [31.07651501]


portfolio before change:  [34.56411966]
curr_Stock_Price:  100.93052894758276
curr_Factors:  [100.93052895]
mat_Sqrt:  [[0.15]]
grads:  [0.04973621]
Stock Position:  0.04973620758712879
Bond Position:  [29.54421792]


portfolio before change:  [34.56350436]
curr_Stock_Price:  100.84390069706049
curr_Factors:  [100.8439007]
mat_Sqrt:  [[0.15]]
grads:  [0.05231852]
Stock Position:  0.052318515876084784
Bond Position:  [29.28750114]


portfolio before change:  [34.56954747]
curr_Stock_Price:  100.88942838676758
curr_Factors:  [100.88942839]
mat_Sqrt:  [[0.15]]
grads:  [-0.0317558]
Stock Position:  -0.0317558035382294
Bond Position:  [37.77337233]


portfolio before change:  [34.57168702]
curr_Stock_Price:  100.97074919459162
curr_Factors:  [100.97074919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0312604]
Stock Position:  -0.0312603994884545
Bond Position:  [37.72807298]


portfolio before change:  [34.5627588]
curr_Stock_Price:  101.40722868166135
curr_Factors:  [101.40722868]
mat_Sqrt:  [[0.15]]
grads:  [0.03298116]
Stock Position:  0.03298116434663889
Bond Position:  [31.21823033]


portfolio before change:  [34.5732733]
curr_Stock_Price:  101.60770586154017
curr_Factors:  [101.60770586]
mat_Sqrt:  [[0.15]]
grads:  [-0.07796389]
Stock Position:  -0.07796388842067299
Bond Position:  [42.49500514]


portfolio before change:  [34.45698141]
curr_Stock_Price:  103.16745484169549
curr_Factors:  [103.16745484]
mat_Sqrt:  [[0.15]]
grads:  [-0.00337055]
Stock Position:  -0.0033705544186221396
Bond Position:  [34.80471293]


portfolio before change:  [34.45977393]
curr_Stock_Price:  103.62979424981182
curr_Factors:  [103.62979425]
mat_Sqrt:  [[0.15]]
grads:  [0.02895122]
Stock Position:  0.02895122222059232
Bond Position:  [31.45956473]


portfolio before change:  [34.46544853]
curr_Stock_Price:  103.68996118508615
curr_Factors:  [103.68996119]
mat_Sqrt:  [[0.15]]
grads:  [0.02254699]
Stock Position:  0.02254699310730105
Bond Position:  [32.12755169]


portfolio before change:  [34.44878169]
curr_Stock_Price:  102.7726309774436
curr_Factors:  [102.77263098]
mat_Sqrt:  [[0.15]]
grads:  [0.00648393]
Stock Position:  0.00648392500366105
Bond Position:  [33.78241165]


portfolio before change:  [34.45797253]
curr_Stock_Price:  103.53879918281537
curr_Factors:  [103.53879918]
mat_Sqrt:  [[0.15]]
grads:  [0.03168395]
Stock Position:  0.031683946903458236
Bond Position:  [31.17745471]


portfolio before change:  [34.48597982]
curr_Stock_Price:  104.29974812550581
curr_Factors:  [104.29974813]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138397]
Stock Position:  -0.03138397170694444
Bond Position:  [37.75932016]


portfolio before change:  [34.49697697]
curr_Stock_Price:  104.09974363362981
curr_Factors:  [104.09974363]
mat_Sqrt:  [[0.15]]
grads:  [-0.11278769]
Stock Position:  -0.11278769317818751
Bond Position:  [46.23814691]


portfolio before change:  [34.55809361]
curr_Stock_Price:  103.60911813719753
curr_Factors:  [103.60911814]
mat_Sqrt:  [[0.15]]
grads:  [0.04796415]
Stock Position:  0.04796415442995327
Bond Position:  [29.58856987]


portfolio before change:  [34.54276755]
curr_Stock_Price:  103.21247052511484
curr_Factors:  [103.21247053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00631769]
Stock Position:  -0.00631768708159999
Bond Position:  [35.19483164]


portfolio before change:  [34.5461952]
curr_Stock_Price:  103.36632126150619
curr_Factors:  [103.36632126]
mat_Sqrt:  [[0.15]]
grads:  [-0.09639537]
Stock Position:  -0.09639536949134264
Bond Position:  [44.51022993]


portfolio before change:  [34.58097392]
curr_Stock_Price:  103.06325068231004
curr_Factors:  [103.06325068]
mat_Sqrt:  [[0.15]]
grads:  [-0.13552843]
Stock Position:  -0.1355284257178747
Bond Position:  [48.54897404]


portfolio before change:  [34.44154286]
curr_Stock_Price:  104.13682669300294
curr_Factors:  [104.13682669]
mat_Sqrt:  [[0.15]]
grads:  [0.04593995]
Stock Position:  0.045939950443568474
Bond Position:  [29.6575022]


portfolio before change:  [34.44412929]
curr_Stock_Price:  104.1124255923785
curr_Factors:  [104.11242559]
mat_Sqrt:  [[0.15]]
grads:  [0.03833369]
Stock Position:  0.038333693970251034
Bond Position:  [30.45311543]


portfolio before change:  [34.46021559]
curr_Stock_Price:  104.4327551756372
curr_Factors:  [104.43275518]
mat_Sqrt:  [[0.15]]
grads:  [0.15733401]
Stock Position:  0.15733400740961034
Bond Position:  [18.02939171]


portfolio before change:  [34.51180527]
curr_Stock_Price:  104.74632929406474
curr_Factors:  [104.74632929]
mat_Sqrt:  [[0.15]]
grads:  [0.06440512]
Stock Position:  0.06440511846297577
Bond Position:  [27.76560553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.59034199]
Stock Price:  105.91185460378918
PL:  [28.67848738]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.21614167e-02]
 [ 1.36477471e-02]
 [-3.65267469e-03]
 [-2.19847825e-03]
 [-6.32841167e-03]
 [ 2.59915924e-02]
 [ 3.52534594e-03]
 [ 8.00866950e-03]
 [-1.90249101e-02]
 [ 2.33882428e-02]
 [ 1.93101411e-02]
 [-1.36591603e-02]
 [ 3.19101534e-02]
 [ 5.17281185e-03]
 [-9.60295828e-03]
 [-1.78213023e-03]
 [-6.09213740e-03]
 [ 2.98839806e-03]
 [ 5.07980835e-03]
 [-2.95063294e-02]
 [-4.77466186e-03]
 [-8.82102490e-03]
 [ 6.56792650e-03]
 [-8.14678724e-03]
 [ 1.30815018e-02]
 [ 2.78390342e-03]
 [ 2.31473652e-02]
 [-4.17046677e-03]
 [-1.45754934e-02]
 [-1.31937698e-02]
 [ 2.61802438e-02]
 [ 9.35303496e-03]
 [-1.26453533e-02]
 [-3.90522978e-02]
 [-2.23731450e-02]
 [ 3.82446663e-02]
 [ 7.95107418e-04]
 [ 6.85769739e-03]
 [ 1.36419125e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.09751887]
curr_Stock_Price:  99.96406343230288
curr_Factors:  [99.96406343]
mat_Sqrt:  [[0.15]]
grads:  [0.14774278]
Stock Position:  0.1477427777843979
Bond Position:  [-13.67144954]


portfolio before change:  [1.24858309]
curr_Stock_Price:  100.9981123323495
curr_Factors:  [100.99811233]
mat_Sqrt:  [[0.15]]
grads:  [0.09098498]
Stock Position:  0.09098498041391927
Bond Position:  [-7.94072818]


portfolio before change:  [1.2450766]
curr_Stock_Price:  100.9704832179743
curr_Factors:  [100.97048322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02435116]
Stock Position:  -0.02435116462048233
Bond Position:  [3.70382546]


portfolio before change:  [1.24652469]
curr_Stock_Price:  100.93003019937298
curr_Factors:  [100.9300302]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465652]
Stock Position:  -0.01465652167120412
Bond Position:  [2.72580786]


portfolio before change:  [1.25267181]
curr_Stock_Price:  100.533866962529
curr_Factors:  [100.53386696]
mat_Sqrt:  [[0.15]]
grads:  [-0.04218941]
Stock Position:  -0.04218941111180017
Bond Position:  [5.49413646]


portfolio before change:  [1.20771326]
curr_Stock_Price:  101.61578209206685
curr_Factors:  [101.61578209]
mat_Sqrt:  [[0.15]]
grads:  [0.17327728]
Stock Position:  0.17327728298768338
Bond Position:  [-16.39999337]


portfolio before change:  [1.27883394]
curr_Stock_Price:  102.03805790925833
curr_Factors:  [102.03805791]
mat_Sqrt:  [[0.15]]
grads:  [0.02350231]
Stock Position:  0.02350230625008994
Bond Position:  [-1.11929575]


portfolio before change:  [1.26051532]
curr_Stock_Price:  101.26457240739364
curr_Factors:  [101.26457241]
mat_Sqrt:  [[0.15]]
grads:  [0.05339113]
Stock Position:  0.05339112999400211
Bond Position:  [-4.14611462]


portfolio before change:  [1.24447875]
curr_Stock_Price:  100.97391962035545
curr_Factors:  [100.97391962]
mat_Sqrt:  [[0.15]]
grads:  [-0.12683273]
Stock Position:  -0.12683273395398575
Bond Position:  [14.05127703]


portfolio before change:  [1.3417534]
curr_Stock_Price:  100.22081644489606
curr_Factors:  [100.22081644]
mat_Sqrt:  [[0.15]]
grads:  [0.15592162]
Stock Position:  0.1559216186636496
Bond Position:  [-14.28483852]


portfolio before change:  [1.38046992]
curr_Stock_Price:  100.4805766807547
curr_Factors:  [100.48057668]
mat_Sqrt:  [[0.15]]
grads:  [0.12873427]
Stock Position:  0.12873427400992157
Bond Position:  [-11.55482417]


portfolio before change:  [1.44012782]
curr_Stock_Price:  100.95521593582642
curr_Factors:  [100.95521594]
mat_Sqrt:  [[0.15]]
grads:  [-0.09106107]
Stock Position:  -0.09106106884222927
Bond Position:  [10.63321769]


portfolio before change:  [1.45959788]
curr_Stock_Price:  100.75599988194949
curr_Factors:  [100.75599988]
mat_Sqrt:  [[0.15]]
grads:  [0.21273436]
Stock Position:  0.21273435593697151
Bond Position:  [-19.97466486]


portfolio before change:  [1.35500408]
curr_Stock_Price:  100.27607359196416
curr_Factors:  [100.27607359]
mat_Sqrt:  [[0.15]]
grads:  [0.03448541]
Stock Position:  0.03448541233807179
Bond Position:  [-2.10305766]


portfolio before change:  [1.33032567]
curr_Stock_Price:  99.56807815925303
curr_Factors:  [99.56807816]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401972]
Stock Position:  -0.06401972185555184
Bond Position:  [7.70464634]


portfolio before change:  [1.34038876]
curr_Stock_Price:  99.42593515726443
curr_Factors:  [99.42593516]
mat_Sqrt:  [[0.15]]
grads:  [-0.01188087]
Stock Position:  -0.011880868177330667
Bond Position:  [2.52165519]


portfolio before change:  [1.34319196]
curr_Stock_Price:  99.21652547563191
curr_Factors:  [99.21652548]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061425]
Stock Position:  -0.04061424935996791
Bond Position:  [5.37279667]


portfolio before change:  [1.38528755]
curr_Stock_Price:  98.19658923970596
curr_Factors:  [98.19658924]
mat_Sqrt:  [[0.15]]
grads:  [0.01992265]
Stock Position:  0.019922653711554873
Bond Position:  [-0.5710491]


portfolio before change:  [1.39377712]
curr_Stock_Price:  98.62629913232952
curr_Factors:  [98.62629913]
mat_Sqrt:  [[0.15]]
grads:  [0.03386539]
Stock Position:  0.03386538897525664
Bond Position:  [-1.94624086]


portfolio before change:  [1.38427526]
curr_Stock_Price:  98.35290598997322
curr_Factors:  [98.35290599]
mat_Sqrt:  [[0.15]]
grads:  [-0.19670886]
Stock Position:  -0.19670886250072125
Bond Position:  [20.73116352]


portfolio before change:  [1.48849685]
curr_Stock_Price:  97.83625394724073
curr_Factors:  [97.83625395]
mat_Sqrt:  [[0.15]]
grads:  [-0.03183108]
Stock Position:  -0.03183107908888139
Bond Position:  [4.60273039]


portfolio before change:  [1.4478402]
curr_Stock_Price:  99.13159280402301
curr_Factors:  [99.1315928]
mat_Sqrt:  [[0.15]]
grads:  [-0.05880683]
Stock Position:  -0.05880683268458584
Bond Position:  [7.27745519]


portfolio before change:  [1.49941457]
curr_Stock_Price:  98.27004953600344
curr_Factors:  [98.27004954]
mat_Sqrt:  [[0.15]]
grads:  [0.04378618]
Stock Position:  0.04378617664586739
Bond Position:  [-2.80345518]


portfolio before change:  [1.47754989]
curr_Stock_Price:  97.77870224036407
curr_Factors:  [97.77870224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05431191]
Stock Position:  -0.054311914906117885
Bond Position:  [6.78809845]


portfolio before change:  [1.49411157]
curr_Stock_Price:  97.48938991263033
curr_Factors:  [97.48938991]
mat_Sqrt:  [[0.15]]
grads:  [0.08721001]
Stock Position:  0.08721001224910184
Bond Position:  [-7.00793932]


portfolio before change:  [1.42571681]
curr_Stock_Price:  96.71518172244448
curr_Factors:  [96.71518172]
mat_Sqrt:  [[0.15]]
grads:  [0.01855936]
Stock Position:  0.01855935613210421
Bond Position:  [-0.36925469]


portfolio before change:  [1.40556686]
curr_Stock_Price:  95.63196585618088
curr_Factors:  [95.63196586]
mat_Sqrt:  [[0.15]]
grads:  [0.15431577]
Stock Position:  0.15431576815260095
Bond Position:  [-13.35195341]


portfolio before change:  [1.5065293]
curr_Stock_Price:  96.29704068988663
curr_Factors:  [96.29704069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02780311]
Stock Position:  -0.02780311176764265
Bond Position:  [4.18388668]


portfolio before change:  [1.47283518]
curr_Stock_Price:  97.5277353257056
curr_Factors:  [97.52773533]
mat_Sqrt:  [[0.15]]
grads:  [-0.09716996]
Stock Position:  -0.09716995571471944
Bond Position:  [10.9496009]


portfolio before change:  [1.50527755]
curr_Stock_Price:  97.20794933710981
curr_Factors:  [97.20794934]
mat_Sqrt:  [[0.15]]
grads:  [-0.08795847]
Stock Position:  -0.08795846540017022
Bond Position:  [10.0555396]


portfolio before change:  [1.46362863]
curr_Stock_Price:  97.69574715337481
curr_Factors:  [97.69574715]
mat_Sqrt:  [[0.15]]
grads:  [0.17453496]
Stock Position:  0.17453495896684107
Bond Position:  [-15.58769459]


portfolio before change:  [1.51291003]
curr_Stock_Price:  97.98926992300281
curr_Factors:  [97.98926992]
mat_Sqrt:  [[0.15]]
grads:  [0.06235357]
Stock Position:  0.06235356636914045
Bond Position:  [-4.59707042]


portfolio before change:  [1.48554658]
curr_Stock_Price:  97.55964285100002
curr_Factors:  [97.55964285]
mat_Sqrt:  [[0.15]]
grads:  [-0.08430236]
Stock Position:  -0.08430235553915452
Bond Position:  [9.71005428]


portfolio before change:  [1.37850685]
curr_Stock_Price:  98.84375358002092
curr_Factors:  [98.84375358]
mat_Sqrt:  [[0.15]]
grads:  [-0.26034865]
Stock Position:  -0.2603486518049203
Bond Position:  [27.11234484]


portfolio before change:  [1.58104625]
curr_Stock_Price:  98.07881724789527
curr_Factors:  [98.07881725]
mat_Sqrt:  [[0.15]]
grads:  [-0.1491543]
Stock Position:  -0.14915430025341192
Bond Position:  [16.20992361]


portfolio before change:  [1.61053347]
curr_Stock_Price:  97.89470689431275
curr_Factors:  [97.89470689]
mat_Sqrt:  [[0.15]]
grads:  [0.25496444]
Stock Position:  0.25496444232828247
Bond Position:  [-23.34913588]


portfolio before change:  [1.51184614]
curr_Stock_Price:  97.5190917648483
curr_Factors:  [97.51909176]
mat_Sqrt:  [[0.15]]
grads:  [0.00530072]
Stock Position:  0.005300716122611497
Bond Position:  [0.99492512]


portfolio before change:  [1.51287757]
curr_Stock_Price:  97.69021100363689
curr_Factors:  [97.690211]
mat_Sqrt:  [[0.15]]
grads:  [0.04571798]
Stock Position:  0.04571798258901842
Bond Position:  [-2.9533218]


portfolio before change:  [1.46023909]
curr_Stock_Price:  96.54691263127815
curr_Factors:  [96.54691263]
mat_Sqrt:  [[0.15]]
grads:  [0.09094608]
Stock Position:  0.09094608350341037
Bond Position:  [-7.32032449]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.43831857]
Stock Price:  96.31594706930845
PL:  [1.43831857]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.24212897e-03]
 [ 3.17166560e-02]
 [-1.67548907e-02]
 [-7.57914800e-03]
 [-7.06662584e-03]
 [ 2.82122941e-02]
 [ 3.54752300e-03]
 [-1.21921245e-03]
 [-2.24863621e-02]
 [ 2.34450524e-02]
 [ 2.10110053e-02]
 [-5.02674526e-03]
 [-2.94171408e-02]
 [ 1.77392363e-02]
 [-1.20366743e-02]
 [-2.67549595e-04]
 [-6.10729773e-03]
 [-1.14988743e-03]
 [ 1.11579179e-03]
 [-2.01828278e-02]
 [-1.06215982e-02]
 [-2.11106004e-02]
 [ 4.32447688e-03]
 [-1.13152874e-02]
 [ 9.92630247e-03]
 [-2.58491675e-03]
 [ 3.21238425e-02]
 [-5.17538209e-03]
 [-5.73542046e-02]
 [-7.02145138e-03]
 [ 5.62782234e-02]
 [-2.67387864e-03]
 [-2.02300488e-02]
 [-3.28765001e-02]
 [-2.33890768e-02]
 [ 3.65035102e-02]
 [-4.00636730e-03]
 [ 5.97732583e-05]
 [ 1.74762230e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.73999302]
curr_Stock_Price:  99.37936545515522
curr_Factors:  [99.37936546]
mat_Sqrt:  [[0.15]]
grads:  [-0.06161419]
Stock Position:  -0.06161419314696794
Bond Position:  [-5.6168136]


portfolio before change:  [-11.74392197]
curr_Stock_Price:  99.43173662706035
curr_Factors:  [99.43173663]
mat_Sqrt:  [[0.15]]
grads:  [0.21144437]
Stock Position:  0.21144437301725874
Bond Position:  [-32.76820318]


portfolio before change:  [-11.92555318]
curr_Stock_Price:  98.59210715282975
curr_Factors:  [98.59210715]
mat_Sqrt:  [[0.15]]
grads:  [-0.11169927]
Stock Position:  -0.11169927128625859
Bond Position:  [-0.91288666]


portfolio before change:  [-11.90146584]
curr_Stock_Price:  98.37544096552489
curr_Factors:  [98.37544097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05052765]
Stock Position:  -0.05052765331225714
Bond Position:  [-6.93078567]


portfolio before change:  [-11.9464394]
curr_Stock_Price:  99.24837201866723
curr_Factors:  [99.24837202]
mat_Sqrt:  [[0.15]]
grads:  [-0.04711084]
Stock Position:  -0.04711083891056649
Bond Position:  [-7.27076534]


portfolio before change:  [-11.9747519]
curr_Stock_Price:  99.83005550102777
curr_Factors:  [99.8300555]
mat_Sqrt:  [[0.15]]
grads:  [0.18808196]
Stock Position:  0.18808196078958547
Bond Position:  [-30.75098449]


portfolio before change:  [-12.13071717]
curr_Stock_Price:  99.02125303720294
curr_Factors:  [99.02125304]
mat_Sqrt:  [[0.15]]
grads:  [0.02365015]
Stock Position:  0.023650153330644696
Bond Position:  [-14.47258499]


portfolio before change:  [-12.13469259]
curr_Stock_Price:  98.92965829045058
curr_Factors:  [98.92965829]
mat_Sqrt:  [[0.15]]
grads:  [-0.00812808]
Stock Position:  -0.00812808302497627
Bond Position:  [-11.33058411]


portfolio before change:  [-12.13423839]
curr_Stock_Price:  98.69951724321243
curr_Factors:  [98.69951724]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990908]
Stock Position:  -0.14990908049703675
Bond Position:  [2.66171548]


portfolio before change:  [-11.91403435]
curr_Stock_Price:  97.23281951032538
curr_Factors:  [97.23281951]
mat_Sqrt:  [[0.15]]
grads:  [0.15630035]
Stock Position:  0.15630034929260245
Bond Position:  [-27.111558]


portfolio before change:  [-11.76707968]
curr_Stock_Price:  98.19471005816908
curr_Factors:  [98.19471006]
mat_Sqrt:  [[0.15]]
grads:  [0.14007337]
Stock Position:  0.14007336881394478
Bond Position:  [-25.52154351]


portfolio before change:  [-12.04712739]
curr_Stock_Price:  96.2181935639541
curr_Factors:  [96.21819356]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351164]
Stock Position:  -0.03351163508956894
Bond Position:  [-8.8226984]


portfolio before change:  [-12.0056373]
curr_Stock_Price:  94.94720223877081
curr_Factors:  [94.94720224]
mat_Sqrt:  [[0.15]]
grads:  [-0.19611427]
Stock Position:  -0.1961142718294481
Bond Position:  [6.61486413]


portfolio before change:  [-12.14701534]
curr_Stock_Price:  95.67231494413252
curr_Factors:  [95.67231494]
mat_Sqrt:  [[0.15]]
grads:  [0.11826158]
Stock Position:  0.11826157509287866
Bond Position:  [-23.461374]


portfolio before change:  [-12.1088215]
curr_Stock_Price:  96.02007538035639
curr_Factors:  [96.02007538]
mat_Sqrt:  [[0.15]]
grads:  [-0.0802445]
Stock Position:  -0.08024449542060953
Bond Position:  [-4.403739]


portfolio before change:  [-12.12804254]
curr_Stock_Price:  96.25274601210673
curr_Factors:  [96.25274601]
mat_Sqrt:  [[0.15]]
grads:  [-0.00178366]
Stock Position:  -0.0017836639677361293
Bond Position:  [-11.95635998]


portfolio before change:  [-12.13012534]
curr_Stock_Price:  96.58249761816792
curr_Factors:  [96.58249762]
mat_Sqrt:  [[0.15]]
grads:  [-0.04071532]
Stock Position:  -0.04071531821602723
Bond Position:  [-8.19773822]


portfolio before change:  [-12.12927113]
curr_Stock_Price:  96.536348050066
curr_Factors:  [96.53634805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00766592]
Stock Position:  -0.0076659162188812136
Bond Position:  [-11.38923157]


portfolio before change:  [-12.13533297]
curr_Stock_Price:  97.14137608613149
curr_Factors:  [97.14137609]
mat_Sqrt:  [[0.15]]
grads:  [0.00743861]
Stock Position:  0.007438611916141027
Bond Position:  [-12.85792997]


portfolio before change:  [-12.13691338]
curr_Stock_Price:  97.14499659534407
curr_Factors:  [97.1449966]
mat_Sqrt:  [[0.15]]
grads:  [-0.13455219]
Stock Position:  -0.13455218515684858
Bond Position:  [0.93415819]


portfolio before change:  [-12.03787161]
curr_Stock_Price:  96.40978007309984
curr_Factors:  [96.40978007]
mat_Sqrt:  [[0.15]]
grads:  [-0.07081065]
Stock Position:  -0.07081065489509426
Bond Position:  [-5.21103195]


portfolio before change:  [-12.0054448]
curr_Stock_Price:  95.9426437130371
curr_Factors:  [95.94264371]
mat_Sqrt:  [[0.15]]
grads:  [-0.14073734]
Stock Position:  -0.14073733582796313
Bond Position:  [1.49726727]


portfolio before change:  [-11.82915436]
curr_Stock_Price:  94.69135335665204
curr_Factors:  [94.69135336]
mat_Sqrt:  [[0.15]]
grads:  [0.02882985]
Stock Position:  0.028829845888362297
Bond Position:  [-14.55909148]


portfolio before change:  [-11.81726097]
curr_Stock_Price:  95.16701976466913
curr_Factors:  [95.16701976]
mat_Sqrt:  [[0.15]]
grads:  [-0.07543525]
Stock Position:  -0.0754352490429675
Bond Position:  [-4.63831313]


portfolio before change:  [-11.7357456]
curr_Stock_Price:  94.0787328244302
curr_Factors:  [94.07873282]
mat_Sqrt:  [[0.15]]
grads:  [0.06617535]
Stock Position:  0.06617534980056221
Bond Position:  [-17.96143865]


portfolio before change:  [-11.76928228]
curr_Stock_Price:  93.60587759879462
curr_Factors:  [93.6058776]
mat_Sqrt:  [[0.15]]
grads:  [-0.01723278]
Stock Position:  -0.017232778352133504
Bond Position:  [-10.15619294]


portfolio before change:  [-11.77734138]
curr_Stock_Price:  93.99986513707286
curr_Factors:  [93.99986514]
mat_Sqrt:  [[0.15]]
grads:  [0.21415895]
Stock Position:  0.21415894984235162
Bond Position:  [-31.90825379]


portfolio before change:  [-11.78785236]
curr_Stock_Price:  93.96941019819208
curr_Factors:  [93.9694102]
mat_Sqrt:  [[0.15]]
grads:  [-0.03450255]
Stock Position:  -0.034502547298424925
Bond Position:  [-8.54566834]


portfolio before change:  [-11.74815292]
curr_Stock_Price:  92.7878245077612
curr_Factors:  [92.78782451]
mat_Sqrt:  [[0.15]]
grads:  [-0.38236136]
Stock Position:  -0.38236136400873444
Bond Position:  [23.73032622]


portfolio before change:  [-11.66003614]
curr_Stock_Price:  92.56512861734167
curr_Factors:  [92.56512862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04680968]
Stock Position:  -0.04680967584164713
Bond Position:  [-7.32709247]


portfolio before change:  [-11.67451971]
curr_Stock_Price:  92.85497516979262
curr_Factors:  [92.85497517]
mat_Sqrt:  [[0.15]]
grads:  [0.37518816]
Stock Position:  0.37518815599185373
Bond Position:  [-46.51260662]


portfolio before change:  [-11.18991745]
curr_Stock_Price:  94.16209717524444
curr_Factors:  [94.16209718]
mat_Sqrt:  [[0.15]]
grads:  [-0.01782586]
Stock Position:  -0.01782585761549705
Bond Position:  [-9.51139731]


portfolio before change:  [-11.20440039]
curr_Stock_Price:  94.90786434776922
curr_Factors:  [94.90786435]
mat_Sqrt:  [[0.15]]
grads:  [-0.13486699]
Stock Position:  -0.13486699214811892
Bond Position:  [1.59553781]


portfolio before change:  [-11.26566742]
curr_Stock_Price:  95.36362070533602
curr_Factors:  [95.36362071]
mat_Sqrt:  [[0.15]]
grads:  [-0.21917667]
Stock Position:  -0.21917666714611753
Bond Position:  [9.63581313]


portfolio before change:  [-11.2362749]
curr_Stock_Price:  95.2350122506407
curr_Factors:  [95.23501225]
mat_Sqrt:  [[0.15]]
grads:  [-0.15592718]
Stock Position:  -0.1559271785151785
Bond Position:  [3.61345186]


portfolio before change:  [-11.2599724]
curr_Stock_Price:  95.3898871642145
curr_Factors:  [95.38988716]
mat_Sqrt:  [[0.15]]
grads:  [0.24335673]
Stock Position:  0.2433567346703199
Bond Position:  [-34.47374386]


portfolio before change:  [-11.22228826]
curr_Stock_Price:  95.5624470950795
curr_Factors:  [95.5624471]
mat_Sqrt:  [[0.15]]
grads:  [-0.02670912]
Stock Position:  -0.026709115356152852
Bond Position:  [-8.66989984]


portfolio before change:  [-11.23214486]
curr_Stock_Price:  95.89090376204027
curr_Factors:  [95.89090376]
mat_Sqrt:  [[0.15]]
grads:  [0.00039849]
Stock Position:  0.0003984883889579169
Bond Position:  [-11.27035627]


portfolio before change:  [-11.23353494]
curr_Stock_Price:  95.9380905729227
curr_Factors:  [95.93809057]
mat_Sqrt:  [[0.15]]
grads:  [0.11650815]
Stock Position:  0.11650815336167765
Bond Position:  [-22.4111047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.06260404]
Stock Price:  97.42925192180833
PL:  [-11.06260404]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.33174885e-02]
 [ 3.51100177e-02]
 [-1.62099380e-02]
 [-7.02935898e-03]
 [-7.42624169e-03]
 [ 2.79683035e-02]
 [ 3.56263172e-03]
 [ 3.71256028e-03]
 [-2.77114881e-02]
 [ 2.34305826e-02]
 [ 2.07439700e-02]
 [-1.44718034e-02]
 [ 1.66907889e-02]
 [ 7.28565792e-03]
 [-6.26174695e-04]
 [-3.51688317e-03]
 [-5.85092261e-03]
 [ 6.98206716e-03]
 [ 1.30504460e-02]
 [ 8.32695106e-03]
 [-5.12290252e-03]
 [-4.64046765e-03]
 [ 7.06481373e-03]
 [-1.01920658e-02]
 [ 1.08483191e-02]
 [ 7.65319156e-03]
 [-3.50087898e-03]
 [-1.27134672e-03]
 [ 2.63322769e-03]
 [-6.48085328e-03]
 [-1.78984152e-02]
 [ 7.32861611e-03]
 [ 2.12409709e-03]
 [ 3.55690507e-02]
 [-2.01521001e-02]
 [-6.41423275e-03]
 [ 1.52779572e-02]
 [ 1.89147860e-02]
 [ 8.19075683e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.38919249]
curr_Stock_Price:  100.02289406517968
curr_Factors:  [100.02289407]
mat_Sqrt:  [[0.15]]
grads:  [0.15544992]
Stock Position:  0.15544992366145727
Bond Position:  [-13.15935876]


portfolio before change:  [2.3371564]
curr_Stock_Price:  99.69873139504921
curr_Factors:  [99.6987314]
mat_Sqrt:  [[0.15]]
grads:  [0.23406678]
Stock Position:  0.23406678446313237
Bond Position:  [-20.99900507]


portfolio before change:  [2.0486119]
curr_Stock_Price:  98.47720196447514
curr_Factors:  [98.47720196]
mat_Sqrt:  [[0.15]]
grads:  [-0.10806625]
Stock Position:  -0.10806625329645102
Bond Position:  [12.69067415]


portfolio before change:  [1.98914302]
curr_Stock_Price:  99.04218232233328
curr_Factors:  [99.04218232]
mat_Sqrt:  [[0.15]]
grads:  [-0.04686239]
Stock Position:  -0.046862393206625184
Bond Position:  [6.63049671]


portfolio before change:  [1.95416539]
curr_Stock_Price:  99.80625977166726
curr_Factors:  [99.80625977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950828]
Stock Position:  -0.04950827791455881
Bond Position:  [6.89540143]


portfolio before change:  [1.97340851]
curr_Stock_Price:  99.43498551120575
curr_Factors:  [99.43498551]
mat_Sqrt:  [[0.15]]
grads:  [0.18645536]
Stock Position:  0.1864553566934335
Bond Position:  [-16.56677718]


portfolio before change:  [1.97856152]
curr_Stock_Price:  99.4737292792559
curr_Factors:  [99.47372928]
mat_Sqrt:  [[0.15]]
grads:  [0.02375088]
Stock Position:  0.02375087810940085
Bond Position:  [-0.3840269]


portfolio before change:  [1.99271457]
curr_Stock_Price:  100.07164624058399
curr_Factors:  [100.07164624]
mat_Sqrt:  [[0.15]]
grads:  [0.0247504]
Stock Position:  0.02475040189973636
Bond Position:  [-0.4840989]


portfolio before change:  [1.97515226]
curr_Stock_Price:  99.36451455295435
curr_Factors:  [99.36451455]
mat_Sqrt:  [[0.15]]
grads:  [-0.18474325]
Stock Position:  -0.18474325373105385
Bond Position:  [20.33207598]


portfolio before change:  [2.0251514]
curr_Stock_Price:  99.10763116769729
curr_Factors:  [99.10763117]
mat_Sqrt:  [[0.15]]
grads:  [0.15620388]
Stock Position:  0.156203884318469
Bond Position:  [-13.45584556]


portfolio before change:  [1.93904967]
curr_Stock_Price:  98.56718593387878
curr_Factors:  [98.56718593]
mat_Sqrt:  [[0.15]]
grads:  [0.13829313]
Stock Position:  0.13829313304365967
Bond Position:  [-11.69211529]


portfolio before change:  [2.01422869]
curr_Stock_Price:  99.1213755917325
curr_Factors:  [99.12137559]
mat_Sqrt:  [[0.15]]
grads:  [-0.09647869]
Stock Position:  -0.09647868914106512
Bond Position:  [11.57732907]


portfolio before change:  [1.97302791]
curr_Stock_Price:  99.563421733082
curr_Factors:  [99.56342173]
mat_Sqrt:  [[0.15]]
grads:  [0.11127193]
Stock Position:  0.1112719261211173
Bond Position:  [-9.1055858]


portfolio before change:  [2.07727148]
curr_Stock_Price:  100.51048754481052
curr_Factors:  [100.51048754]
mat_Sqrt:  [[0.15]]
grads:  [0.04857105]
Stock Position:  0.04857105279666781
Bond Position:  [-2.80462872]


portfolio before change:  [2.10471533]
curr_Stock_Price:  101.08273080651202
curr_Factors:  [101.08273081]
mat_Sqrt:  [[0.15]]
grads:  [-0.0041745]
Stock Position:  -0.004174497967889777
Bond Position:  [2.52668499]


portfolio before change:  [2.10793046]
curr_Stock_Price:  100.38821087736248
curr_Factors:  [100.38821088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02344589]
Stock Position:  -0.023445887825420404
Bond Position:  [4.46162119]


portfolio before change:  [2.08236385]
curr_Stock_Price:  101.50245118640163
curr_Factors:  [101.50245119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03900615]
Stock Position:  -0.0390061507016393
Bond Position:  [6.04158375]


portfolio before change:  [2.06810781]
curr_Stock_Price:  101.88729521566462
curr_Factors:  [101.88729522]
mat_Sqrt:  [[0.15]]
grads:  [0.04654711]
Stock Position:  0.04654711443320316
Bond Position:  [-2.67445178]


portfolio before change:  [2.07470663]
curr_Stock_Price:  102.03624435325666
curr_Factors:  [102.03624435]
mat_Sqrt:  [[0.15]]
grads:  [0.08700297]
Stock Position:  0.0870029730747139
Bond Position:  [-6.80274999]


portfolio before change:  [1.97371796]
curr_Stock_Price:  100.88526904907116
curr_Factors:  [100.88526905]
mat_Sqrt:  [[0.15]]
grads:  [0.05551301]
Stock Position:  0.0555130070363298
Bond Position:  [-3.62672669]


portfolio before change:  [1.95856973]
curr_Stock_Price:  100.62055885175657
curr_Factors:  [100.62055885]
mat_Sqrt:  [[0.15]]
grads:  [-0.03415268]
Stock Position:  -0.034152683438483385
Bond Position:  [5.39503183]


portfolio before change:  [1.9693954]
curr_Stock_Price:  100.32332754950292
curr_Factors:  [100.32332755]
mat_Sqrt:  [[0.15]]
grads:  [-0.03093645]
Stock Position:  -0.030936451013570405
Bond Position:  [5.07304311]


portfolio before change:  [1.989228]
curr_Stock_Price:  99.70275113282896
curr_Factors:  [99.70275113]
mat_Sqrt:  [[0.15]]
grads:  [0.04709876]
Stock Position:  0.04709875820789952
Bond Position:  [-2.70664776]


portfolio before change:  [2.04280254]
curr_Stock_Price:  100.84742855037285
curr_Factors:  [100.84742855]
mat_Sqrt:  [[0.15]]
grads:  [-0.06794711]
Stock Position:  -0.06794710560896154
Bond Position:  [8.89509341]


portfolio before change:  [2.08241494]
curr_Stock_Price:  100.2808046739431
curr_Factors:  [100.28080467]
mat_Sqrt:  [[0.15]]
grads:  [0.07232213]
Stock Position:  0.07232212704588414
Bond Position:  [-5.17010615]


portfolio before change:  [2.09108348]
curr_Stock_Price:  100.40960123391976
curr_Factors:  [100.40960123]
mat_Sqrt:  [[0.15]]
grads:  [0.05102128]
Stock Position:  0.051021277078633874
Bond Position:  [-3.0319426]


portfolio before change:  [2.10318589]
curr_Stock_Price:  100.6542329325008
curr_Factors:  [100.65423293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333919]
Stock Position:  -0.02333919316828985
Bond Position:  [4.45237447]


portfolio before change:  [2.09915977]
curr_Stock_Price:  100.8505851082148
curr_Factors:  [100.85058511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847564]
Stock Position:  -0.008475644804949183
Bond Position:  [2.95393351]


portfolio before change:  [2.08859701]
curr_Stock_Price:  102.14040091982797
curr_Factors:  [102.14040092]
mat_Sqrt:  [[0.15]]
grads:  [0.01755485]
Stock Position:  0.01755485126092866
Bond Position:  [0.29553747]


portfolio before change:  [2.07733849]
curr_Stock_Price:  101.49696220274407
curr_Factors:  [101.4969622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04320569]
Stock Position:  -0.04320568852717795
Bond Position:  [6.46258462]


portfolio before change:  [1.99474509]
curr_Stock_Price:  103.42729305109842
curr_Factors:  [103.42729305]
mat_Sqrt:  [[0.15]]
grads:  [-0.11932277]
Stock Position:  -0.11932276770128875
Bond Position:  [14.33597595]


portfolio before change:  [1.98620404]
curr_Stock_Price:  103.51389140453958
curr_Factors:  [103.5138914]
mat_Sqrt:  [[0.15]]
grads:  [0.04885744]
Stock Position:  0.04885744071531763
Bond Position:  [-3.07121977]


portfolio before change:  [2.02488217]
curr_Stock_Price:  104.31340233185226
curr_Factors:  [104.31340233]
mat_Sqrt:  [[0.15]]
grads:  [0.01416065]
Stock Position:  0.014160647284346066
Bond Position:  [0.54773687]


portfolio before change:  [2.04490384]
curr_Stock_Price:  105.72246194946254
curr_Factors:  [105.72246195]
mat_Sqrt:  [[0.15]]
grads:  [0.237127]
Stock Position:  0.23712700489543284
Bond Position:  [-23.02474691]


portfolio before change:  [1.95334314]
curr_Stock_Price:  105.34847493038463
curr_Factors:  [105.34847493]
mat_Sqrt:  [[0.15]]
grads:  [-0.13434733]
Stock Position:  -0.13434733394698456
Bond Position:  [16.10662989]


portfolio before change:  [1.95120323]
curr_Stock_Price:  105.3793900634441
curr_Factors:  [105.37939006]
mat_Sqrt:  [[0.15]]
grads:  [-0.04276155]
Stock Position:  -0.042761551644406225
Bond Position:  [6.45738946]


portfolio before change:  [1.92521071]
curr_Stock_Price:  106.00611530117128
curr_Factors:  [106.0061153]
mat_Sqrt:  [[0.15]]
grads:  [0.10185305]
Stock Position:  0.10185304770686003
Bond Position:  [-8.87183521]


portfolio before change:  [1.92885135]
curr_Stock_Price:  106.0527480489365
curr_Factors:  [106.05274805]
mat_Sqrt:  [[0.15]]
grads:  [0.12609857]
Stock Position:  0.12609857332181715
Bond Position:  [-11.44424887]


portfolio before change:  [2.07838788]
curr_Stock_Price:  107.24996339864255
curr_Factors:  [107.2499634]
mat_Sqrt:  [[0.15]]
grads:  [0.05460505]
Stock Position:  0.05460504555195592
Bond Position:  [-3.77800126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.08666152]
Stock Price:  107.41013024079913
PL:  [-5.32346872]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.17492374e-02]
 [ 1.57864441e-02]
 [-1.51169585e-02]
 [-7.99130234e-03]
 [-5.01314766e-03]
 [ 5.03073799e-02]
 [ 3.55859561e-03]
 [-1.98509894e-03]
 [-1.73392811e-02]
 [ 2.34406760e-02]
 [ 2.00912369e-02]
 [-1.19949459e-02]
 [ 1.47615176e-03]
 [ 9.29743479e-03]
 [-1.64113447e-02]
 [ 5.92345856e-05]
 [-6.05191730e-03]
 [ 4.29464418e-03]
 [ 6.10331934e-03]
 [-1.15404519e-02]
 [-4.65276521e-03]
 [-4.45212544e-03]
 [ 5.74846874e-03]
 [-1.17624123e-02]
 [ 3.51313363e-03]
 [ 3.87826934e-03]
 [-8.12929403e-04]
 [-1.43631251e-04]
 [ 1.74093629e-03]
 [-6.10236045e-03]
 [-1.90678389e-02]
 [ 1.07119980e-02]
 [-3.37901571e-03]
 [-1.92736333e-02]
 [-2.04410700e-02]
 [ 2.26176769e-02]
 [ 4.10729100e-03]
 [ 1.45296398e-02]
 [ 9.04196752e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.04866199]
curr_Stock_Price:  99.82076731669437
curr_Factors:  [99.82076732]
mat_Sqrt:  [[0.15]]
grads:  [0.07832825]
Stock Position:  0.07832824937291628
Bond Position:  [-9.86744795]


portfolio before change:  [-2.12987217]
curr_Stock_Price:  98.79972226024852
curr_Factors:  [98.79972226]
mat_Sqrt:  [[0.15]]
grads:  [0.10524296]
Stock Position:  0.10524296055804232
Bond Position:  [-12.52784745]


portfolio before change:  [-2.21321691]
curr_Stock_Price:  98.0226759042739
curr_Factors:  [98.0226759]
mat_Sqrt:  [[0.15]]
grads:  [-0.10077972]
Stock Position:  -0.10077972354693493
Bond Position:  [7.66548127]


portfolio before change:  [-2.2031202]
curr_Stock_Price:  97.93199825530307
curr_Factors:  [97.93199826]
mat_Sqrt:  [[0.15]]
grads:  [-0.05327535]
Stock Position:  -0.05327534894201546
Bond Position:  [3.01424118]


portfolio before change:  [-2.18875392]
curr_Stock_Price:  97.6694101474308
curr_Factors:  [97.66941015]
mat_Sqrt:  [[0.15]]
grads:  [-0.03342098]
Stock Position:  -0.033420984388560025
Bond Position:  [1.07545391]


portfolio before change:  [-2.17421515]
curr_Stock_Price:  97.23841358220659
curr_Factors:  [97.23841358]
mat_Sqrt:  [[0.15]]
grads:  [0.33538253]
Stock Position:  0.3353825324282495
Bond Position:  [-34.78628055]


portfolio before change:  [-2.15677584]
curr_Stock_Price:  97.30337782771831
curr_Factors:  [97.30337783]
mat_Sqrt:  [[0.15]]
grads:  [0.02372397]
Stock Position:  0.0237239707047919
Bond Position:  [-4.46519832]


portfolio before change:  [-2.13656107]
curr_Stock_Price:  98.17898782733475
curr_Factors:  [98.17898783]
mat_Sqrt:  [[0.15]]
grads:  [-0.01323399]
Stock Position:  -0.01323399293292365
Bond Position:  [-0.83726104]


portfolio before change:  [-2.13780144]
curr_Stock_Price:  98.26480510348814
curr_Factors:  [98.2648051]
mat_Sqrt:  [[0.15]]
grads:  [-0.11559521]
Stock Position:  -0.11559520746320193
Bond Position:  [9.22113909]


portfolio before change:  [-2.17805681]
curr_Stock_Price:  98.62302138666719
curr_Factors:  [98.62302139]
mat_Sqrt:  [[0.15]]
grads:  [0.15627117]
Stock Position:  0.15627117332517174
Bond Position:  [-17.58999208]


portfolio before change:  [-2.10749678]
curr_Stock_Price:  99.0886153970184
curr_Factors:  [99.0886154]
mat_Sqrt:  [[0.15]]
grads:  [0.13394158]
Stock Position:  0.1339415790616648
Bond Position:  [-15.37958239]


portfolio before change:  [-2.20572953]
curr_Stock_Price:  98.36956921305092
curr_Factors:  [98.36956921]
mat_Sqrt:  [[0.15]]
grads:  [-0.07996631]
Stock Position:  -0.07996630576217999
Bond Position:  [5.66052152]


portfolio before change:  [-2.20774557]
curr_Stock_Price:  98.40362917189725
curr_Factors:  [98.40362917]
mat_Sqrt:  [[0.15]]
grads:  [0.00984101]
Stock Position:  0.009841011752717902
Bond Position:  [-3.17613684]


portfolio before change:  [-2.21372589]
curr_Stock_Price:  97.83628064265193
curr_Factors:  [97.83628064]
mat_Sqrt:  [[0.15]]
grads:  [0.0619829]
Stock Position:  0.0619828985752207
Bond Position:  [-8.27790215]


portfolio before change:  [-2.20721574]
curr_Stock_Price:  97.95800700857083
curr_Factors:  [97.95800701]
mat_Sqrt:  [[0.15]]
grads:  [-0.10940896]
Stock Position:  -0.10940896466739937
Bond Position:  [8.51026839]


portfolio before change:  [-2.2844316]
curr_Stock_Price:  98.67348503095502
curr_Factors:  [98.67348503]
mat_Sqrt:  [[0.15]]
grads:  [0.0003949]
Stock Position:  0.0003948972374606125
Bond Position:  [-2.32339749]


portfolio before change:  [-2.2846192]
curr_Stock_Price:  98.93391695056846
curr_Factors:  [98.93391695]
mat_Sqrt:  [[0.15]]
grads:  [-0.04034612]
Stock Position:  -0.04034611535679443
Bond Position:  [1.70698003]


portfolio before change:  [-2.29641385]
curr_Stock_Price:  99.23154255548785
curr_Factors:  [99.23154256]
mat_Sqrt:  [[0.15]]
grads:  [0.02863096]
Stock Position:  0.02863096121399215
Bond Position:  [-5.1375083]


portfolio before change:  [-2.2875003]
curr_Stock_Price:  99.56529953954441
curr_Factors:  [99.56529954]
mat_Sqrt:  [[0.15]]
grads:  [0.0406888]
Stock Position:  0.04068879561816762
Bond Position:  [-6.33869242]


portfolio before change:  [-2.27766791]
curr_Stock_Price:  99.82642225471336
curr_Factors:  [99.82642225]
mat_Sqrt:  [[0.15]]
grads:  [-0.07693635]
Stock Position:  -0.0769363461856916
Bond Position:  [5.40261227]


portfolio before change:  [-2.36611464]
curr_Stock_Price:  100.9848096654285
curr_Factors:  [100.98480967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03101843]
Stock Position:  -0.03101843474664869
Bond Position:  [0.76627609]


portfolio before change:  [-2.35780697]
curr_Stock_Price:  100.72006780418688
curr_Factors:  [100.7200678]
mat_Sqrt:  [[0.15]]
grads:  [-0.02968084]
Stock Position:  -0.029680836272408233
Bond Position:  [0.63164887]


portfolio before change:  [-2.3645099]
curr_Stock_Price:  100.94856158652979
curr_Factors:  [100.94856159]
mat_Sqrt:  [[0.15]]
grads:  [0.03832312]
Stock Position:  0.03832312496300425
Bond Position:  [-6.23317424]


portfolio before change:  [-2.33778081]
curr_Stock_Price:  101.66636014908077
curr_Factors:  [101.66636015]
mat_Sqrt:  [[0.15]]
grads:  [-0.07841608]
Stock Position:  -0.0784160817025424
Bond Position:  [5.63449679]


portfolio before change:  [-2.34794169]
curr_Stock_Price:  101.8049188733502
curr_Factors:  [101.80491887]
mat_Sqrt:  [[0.15]]
grads:  [0.02342089]
Stock Position:  0.02342089084282933
Bond Position:  [-4.73230358]


portfolio before change:  [-2.31618451]
curr_Stock_Price:  103.18611090590743
curr_Factors:  [103.18611091]
mat_Sqrt:  [[0.15]]
grads:  [0.02585513]
Stock Position:  0.02585512893779718
Bond Position:  [-4.98407471]


portfolio before change:  [-2.3303168]
curr_Stock_Price:  102.66361336690791
curr_Factors:  [102.66361337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00541953]
Stock Position:  -0.005419529356083681
Bond Position:  [-1.77392834]


portfolio before change:  [-2.32550601]
curr_Stock_Price:  101.73501884258468
curr_Factors:  [101.73501884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00095754]
Stock Position:  -0.0009575416738714232
Bond Position:  [-2.22809049]


portfolio before change:  [-2.32562088]
curr_Stock_Price:  101.5641015849722
curr_Factors:  [101.56410158]
mat_Sqrt:  [[0.15]]
grads:  [0.01160624]
Stock Position:  0.011606241916354018
Bond Position:  [-3.50439841]


portfolio before change:  [-2.31894198]
curr_Stock_Price:  102.17730453944392
curr_Factors:  [102.17730454]
mat_Sqrt:  [[0.15]]
grads:  [-0.0406824]
Stock Position:  -0.04068240300776421
Bond Position:  [1.83787631]


portfolio before change:  [-2.33692875]
curr_Stock_Price:  102.62507858245309
curr_Factors:  [102.62507858]
mat_Sqrt:  [[0.15]]
grads:  [-0.12711893]
Stock Position:  -0.12711892621805576
Bond Position:  [10.70866104]


portfolio before change:  [-2.32873739]
curr_Stock_Price:  102.57117087354838
curr_Factors:  [102.57117087]
mat_Sqrt:  [[0.15]]
grads:  [0.07141332]
Stock Position:  0.07141331994160573
Bond Position:  [-9.65368524]


portfolio before change:  [-2.3678485]
curr_Stock_Price:  102.04039712827152
curr_Factors:  [102.04039713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02252677]
Stock Position:  -0.022526771409669064
Bond Position:  [-0.06920779]


portfolio before change:  [-2.36163745]
curr_Stock_Price:  101.76429474321701
curr_Factors:  [101.76429474]
mat_Sqrt:  [[0.15]]
grads:  [-0.12849089]
Stock Position:  -0.12849088889161778
Bond Position:  [10.71414724]


portfolio before change:  [-2.39008794]
curr_Stock_Price:  101.99613869677245
curr_Factors:  [101.9961387]
mat_Sqrt:  [[0.15]]
grads:  [-0.1362738]
Stock Position:  -0.13627379976531703
Bond Position:  [11.50931345]


portfolio before change:  [-2.40831351]
curr_Stock_Price:  102.14043887180165
curr_Factors:  [102.14043887]
mat_Sqrt:  [[0.15]]
grads:  [0.15078451]
Stock Position:  0.15078451292181816
Bond Position:  [-17.80950984]


portfolio before change:  [-2.42069199]
curr_Stock_Price:  102.0731100164654
curr_Factors:  [102.07311002]
mat_Sqrt:  [[0.15]]
grads:  [0.02738194]
Stock Position:  0.027381940014570377
Bond Position:  [-5.21565177]


portfolio before change:  [-2.4340932]
curr_Stock_Price:  101.60750352558978
curr_Factors:  [101.60750353]
mat_Sqrt:  [[0.15]]
grads:  [0.09686427]
Stock Position:  0.09686426521269734
Bond Position:  [-12.27622937]


portfolio before change:  [-2.42074879]
curr_Stock_Price:  101.76111053436398
curr_Factors:  [101.76111053]
mat_Sqrt:  [[0.15]]
grads:  [0.06027978]
Stock Position:  0.06027978347643339
Bond Position:  [-8.5548865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.39492289]
Stock Price:  102.20728555233167
PL:  [-4.60220844]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.66046177e-02]
 [ 3.15746817e-02]
 [-3.46164396e-03]
 [-2.30101491e-03]
 [-6.90460281e-03]
 [ 3.08520800e-02]
 [ 3.66940971e-03]
 [-7.82383080e-04]
 [-2.02209334e-02]
 [ 2.34427368e-02]
 [ 2.10366242e-02]
 [-1.06422645e-02]
 [-3.64674209e-03]
 [ 1.05718843e-02]
 [-1.73277444e-02]
 [ 3.08423396e-04]
 [-6.10425917e-03]
 [ 2.35220245e-03]
 [ 2.48735030e-03]
 [-2.80167592e-02]
 [-4.77717227e-03]
 [-1.40628673e-02]
 [ 6.36670069e-03]
 [-9.53498097e-03]
 [ 1.14776408e-02]
 [-1.02476224e-03]
 [ 3.02417466e-02]
 [-5.25402270e-03]
 [-4.09463054e-02]
 [-9.54053813e-03]
 [ 4.21164567e-02]
 [ 4.55808431e-03]
 [-1.30641354e-02]
 [-4.96461152e-02]
 [-2.26916125e-02]
 [ 3.81293541e-02]
 [ 1.89986662e-03]
 [ 6.73477443e-03]
 [ 1.12550015e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.82268194]
curr_Stock_Price:  99.87660586741552
curr_Factors:  [99.87660587]
mat_Sqrt:  [[0.15]]
grads:  [0.11069745]
Stock Position:  0.11069745112355633
Bond Position:  [-11.87876763]


portfolio before change:  [-0.87496024]
curr_Stock_Price:  99.41775732985852
curr_Factors:  [99.41775733]
mat_Sqrt:  [[0.15]]
grads:  [0.21049788]
Stock Position:  0.21049787790918095
Bond Position:  [-21.80218718]


portfolio before change:  [-0.56398741]
curr_Stock_Price:  100.90802544201793
curr_Factors:  [100.90802544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02307763]
Stock Position:  -0.02307762637193354
Bond Position:  [1.7647303]


portfolio before change:  [-0.55853724]
curr_Stock_Price:  100.68141790687764
curr_Factors:  [100.68141791]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153401]
Stock Position:  -0.01534009941194975
Bond Position:  [0.98592572]


portfolio before change:  [-0.5549237]
curr_Stock_Price:  100.4538904428644
curr_Factors:  [100.45389044]
mat_Sqrt:  [[0.15]]
grads:  [-0.04603069]
Stock Position:  -0.04603068539546847
Bond Position:  [4.06903773]


portfolio before change:  [-0.54491897]
curr_Stock_Price:  100.2475917730738
curr_Factors:  [100.24759177]
mat_Sqrt:  [[0.15]]
grads:  [0.20568053]
Stock Position:  0.205680533060759
Bond Position:  [-21.16389708]


portfolio before change:  [-0.58019186]
curr_Stock_Price:  100.08896110127937
curr_Factors:  [100.0889611]
mat_Sqrt:  [[0.15]]
grads:  [0.02446273]
Stock Position:  0.02446273141299033
Bond Position:  [-3.02864123]


portfolio before change:  [-0.59049686]
curr_Stock_Price:  99.68318471122778
curr_Factors:  [99.68318471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00521589]
Stock Position:  -0.0052158872012840595
Bond Position:  [-0.07056062]


portfolio before change:  [-0.58442739]
curr_Stock_Price:  98.51784260521728
curr_Factors:  [98.51784261]
mat_Sqrt:  [[0.15]]
grads:  [-0.13480622]
Stock Position:  -0.13480622286680435
Bond Position:  [12.69639086]


portfolio before change:  [-0.50877009]
curr_Stock_Price:  97.9683861066419
curr_Factors:  [97.96838611]
mat_Sqrt:  [[0.15]]
grads:  [0.15628491]
Stock Position:  0.1562849120619222
Bond Position:  [-15.81975069]


portfolio before change:  [-0.48194559]
curr_Stock_Price:  98.15267830893607
curr_Factors:  [98.15267831]
mat_Sqrt:  [[0.15]]
grads:  [0.14024416]
Stock Position:  0.14024416157632724
Bond Position:  [-14.24728566]


portfolio before change:  [-0.50489415]
curr_Stock_Price:  98.00174485575457
curr_Factors:  [98.00174486]
mat_Sqrt:  [[0.15]]
grads:  [-0.07094843]
Stock Position:  -0.07094843002202157
Bond Position:  [6.44817579]


portfolio before change:  [-0.50016735]
curr_Stock_Price:  97.94648327214183
curr_Factors:  [97.94648327]
mat_Sqrt:  [[0.15]]
grads:  [-0.02431161]
Stock Position:  -0.02431161390938963
Bond Position:  [1.88106973]


portfolio before change:  [-0.49307833]
curr_Stock_Price:  97.66456565918841
curr_Factors:  [97.66456566]
mat_Sqrt:  [[0.15]]
grads:  [0.07047923]
Stock Position:  0.07047922876635142
Bond Position:  [-7.3764016]


portfolio before change:  [-0.50962502]
curr_Stock_Price:  97.44287506715014
curr_Factors:  [97.44287507]
mat_Sqrt:  [[0.15]]
grads:  [-0.1155183]
Stock Position:  -0.11551829608626975
Bond Position:  [10.74680987]


portfolio before change:  [-0.4677258]
curr_Stock_Price:  97.09179837768471
curr_Factors:  [97.09179838]
mat_Sqrt:  [[0.15]]
grads:  [0.00205616]
Stock Position:  0.0020561559705703503
Bond Position:  [-0.66736169]


portfolio before change:  [-0.46765355]
curr_Stock_Price:  97.16751171502827
curr_Factors:  [97.16751172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069506]
Stock Position:  -0.04069506115575507
Bond Position:  [3.48658428]


portfolio before change:  [-0.49670686]
curr_Stock_Price:  97.89214895636148
curr_Factors:  [97.89214896]
mat_Sqrt:  [[0.15]]
grads:  [0.01568135]
Stock Position:  0.015681349679623445
Bond Position:  [-2.03178788]


portfolio before change:  [-0.50189831]
curr_Stock_Price:  97.57728671735909
curr_Factors:  [97.57728672]
mat_Sqrt:  [[0.15]]
grads:  [0.01658234]
Stock Position:  0.016582335360856463
Bond Position:  [-2.1199576]


portfolio before change:  [-0.49796249]
curr_Stock_Price:  97.83061844456518
curr_Factors:  [97.83061844]
mat_Sqrt:  [[0.15]]
grads:  [-0.18677839]
Stock Position:  -0.18677839459935894
Bond Position:  [17.77468336]


portfolio before change:  [-0.49666792]
curr_Stock_Price:  97.83558367981271
curr_Factors:  [97.83558368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03184782]
Stock Position:  -0.03184781511003696
Bond Position:  [2.61918166]


portfolio before change:  [-0.5029952]
curr_Stock_Price:  98.04453676498787
curr_Factors:  [98.04453676]
mat_Sqrt:  [[0.15]]
grads:  [-0.09375245]
Stock Position:  -0.09375244861317722
Bond Position:  [8.6889202]


portfolio before change:  [-0.45036468]
curr_Stock_Price:  97.49474491642289
curr_Factors:  [97.49474492]
mat_Sqrt:  [[0.15]]
grads:  [0.04244467]
Stock Position:  0.042444671263693126
Bond Position:  [-4.58849708]


portfolio before change:  [-0.47373363]
curr_Stock_Price:  96.95768466772375
curr_Factors:  [96.95768467]
mat_Sqrt:  [[0.15]]
grads:  [-0.06356654]
Stock Position:  -0.06356653977569263
Bond Position:  [5.68953089]


portfolio before change:  [-0.38733539]
curr_Stock_Price:  95.60969559097347
curr_Factors:  [95.60969559]
mat_Sqrt:  [[0.15]]
grads:  [0.07651761]
Stock Position:  0.07651760552730485
Bond Position:  [-7.70316036]


portfolio before change:  [-0.45455107]
curr_Stock_Price:  94.74384609930551
curr_Factors:  [94.7438461]
mat_Sqrt:  [[0.15]]
grads:  [-0.00683175]
Stock Position:  -0.0068317482975943766
Bond Position:  [0.19271504]


portfolio before change:  [-0.45178213]
curr_Stock_Price:  94.34206731432172
curr_Factors:  [94.34206731]
mat_Sqrt:  [[0.15]]
grads:  [0.20161164]
Stock Position:  0.20161164388998104
Bond Position:  [-19.47224141]


portfolio before change:  [-0.56607208]
curr_Stock_Price:  93.78725924843137
curr_Factors:  [93.78725925]
mat_Sqrt:  [[0.15]]
grads:  [-0.03502682]
Stock Position:  -0.03502681803175082
Bond Position:  [2.71899718]


portfolio before change:  [-0.59073948]
curr_Stock_Price:  94.50120626953529
curr_Factors:  [94.50120627]
mat_Sqrt:  [[0.15]]
grads:  [-0.27297537]
Stock Position:  -0.27297536902714103
Bond Position:  [25.20576218]


portfolio before change:  [-0.74293573]
curr_Stock_Price:  95.07029488072011
curr_Factors:  [95.07029488]
mat_Sqrt:  [[0.15]]
grads:  [-0.06360359]
Stock Position:  -0.06360358755351675
Bond Position:  [5.30387609]


portfolio before change:  [-0.79257759]
curr_Stock_Price:  95.8612076009616
curr_Factors:  [95.8612076]
mat_Sqrt:  [[0.15]]
grads:  [0.28077638]
Stock Position:  0.28077637813151063
Bond Position:  [-27.70814027]


portfolio before change:  [-0.6369301]
curr_Stock_Price:  96.42789070639382
curr_Factors:  [96.42789071]
mat_Sqrt:  [[0.15]]
grads:  [0.03038723]
Stock Position:  0.030387228735106124
Bond Position:  [-3.56710647]


portfolio before change:  [-0.60758168]
curr_Stock_Price:  97.4083795444752
curr_Factors:  [97.40837954]
mat_Sqrt:  [[0.15]]
grads:  [-0.08709424]
Stock Position:  -0.08709423578087044
Bond Position:  [7.8761267]


portfolio before change:  [-0.6116137]
curr_Stock_Price:  97.46597924663276
curr_Factors:  [97.46597925]
mat_Sqrt:  [[0.15]]
grads:  [-0.3309741]
Stock Position:  -0.3309741014016626
Bond Position:  [31.6471012]


portfolio before change:  [-0.54301572]
curr_Stock_Price:  97.27067137174355
curr_Factors:  [97.27067137]
mat_Sqrt:  [[0.15]]
grads:  [-0.15127742]
Stock Position:  -0.1512774165497814
Bond Position:  [14.17184015]


portfolio before change:  [-0.62753236]
curr_Stock_Price:  97.84106868181446
curr_Factors:  [97.84106868]
mat_Sqrt:  [[0.15]]
grads:  [0.25419569]
Stock Position:  0.25419569404431097
Bond Position:  [-25.49831072]


portfolio before change:  [-0.60328384]
curr_Stock_Price:  97.94900131202672
curr_Factors:  [97.94900131]
mat_Sqrt:  [[0.15]]
grads:  [0.01266578]
Stock Position:  0.0126657774376071
Bond Position:  [-1.84388409]


portfolio before change:  [-0.6073702]
curr_Stock_Price:  97.64456946475576
curr_Factors:  [97.64456946]
mat_Sqrt:  [[0.15]]
grads:  [0.0448985]
Stock Position:  0.044898496173353564
Bond Position:  [-4.99146453]


portfolio before change:  [-0.64026078]
curr_Stock_Price:  96.92591273338248
curr_Factors:  [96.92591273]
mat_Sqrt:  [[0.15]]
grads:  [0.07503334]
Stock Position:  0.07503334356023154
Bond Position:  [-7.91293609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.62857839]
Stock Price:  97.09479185113618
PL:  [-0.62857839]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 8.00796324e-03]
 [ 2.89061451e-02]
 [-1.13561531e-02]
 [-2.61167761e-03]
 [-7.39799222e-03]
 [ 2.83126693e-02]
 [ 3.65221071e-03]
 [ 7.64684898e-03]
 [-1.53326480e-02]
 [ 2.29260155e-02]
 [ 2.01393088e-02]
 [-1.32539778e-02]
 [ 2.24271425e-02]
 [ 5.72664621e-03]
 [-2.58304487e-03]
 [-3.45206915e-03]
 [-6.15220991e-03]
 [ 6.72126700e-03]
 [ 1.98762737e-02]
 [ 1.76948345e-02]
 [-5.32699922e-04]
 [-4.96407675e-03]
 [ 3.96595755e-03]
 [-1.14293448e-02]
 [-8.27141397e-04]
 [ 4.25174946e-03]
 [ 4.72643139e-03]
 [ 2.58212315e-03]
 [ 5.41912319e-03]
 [ 7.02721599e-04]
 [-1.35533458e-02]
 [ 4.02763353e-03]
 [ 6.49468653e-03]
 [ 3.99154999e-02]
 [-2.00183077e-02]
 [-2.05543089e-02]
 [ 3.04453695e-02]
 [ 1.04016349e-02]
 [ 8.03707750e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.91523995]
curr_Stock_Price:  99.00701523777566
curr_Factors:  [99.00701524]
mat_Sqrt:  [[0.15]]
grads:  [0.05338642]
Stock Position:  0.05338642159105028
Bond Position:  [-25.20087021]


portfolio before change:  [-19.90580807]
curr_Stock_Price:  99.24269664709065
curr_Factors:  [99.24269665]
mat_Sqrt:  [[0.15]]
grads:  [0.19270763]
Stock Position:  0.19270763367691915
Bond Position:  [-39.0306333]


portfolio before change:  [-19.90797309]
curr_Stock_Price:  99.2567807571575
curr_Factors:  [99.25678076]
mat_Sqrt:  [[0.15]]
grads:  [-0.07570769]
Stock Position:  -0.07570768759523885
Bond Position:  [-12.39347174]


portfolio before change:  [-20.00471413]
curr_Stock_Price:  100.51414003720363
curr_Factors:  [100.51414004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01741118]
Stock Position:  -0.017411184080829974
Bond Position:  [-18.25464394]


portfolio before change:  [-19.99333717]
curr_Stock_Price:  99.72964807052213
curr_Factors:  [99.72964807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04931995]
Stock Position:  -0.049319948158427676
Bond Position:  [-15.0746761]


portfolio before change:  [-20.0009319]
curr_Stock_Price:  99.84542833014767
curr_Factors:  [99.84542833]
mat_Sqrt:  [[0.15]]
grads:  [0.18875113]
Stock Position:  0.18875112869388053
Bond Position:  [-38.84686919]


portfolio before change:  [-19.97439267]
curr_Stock_Price:  100.01176056266728
curr_Factors:  [100.01176056]
mat_Sqrt:  [[0.15]]
grads:  [0.02434807]
Stock Position:  0.024348071408433824
Bond Position:  [-22.40948615]


portfolio before change:  [-19.94825034]
curr_Stock_Price:  101.20050722466576
curr_Factors:  [101.20050722]
mat_Sqrt:  [[0.15]]
grads:  [0.05097899]
Stock Position:  0.050978993213902965
Bond Position:  [-25.10735031]


portfolio before change:  [-19.94530651]
curr_Stock_Price:  101.3198200646472
curr_Factors:  [101.31982006]
mat_Sqrt:  [[0.15]]
grads:  [-0.10221765]
Stock Position:  -0.10221765331801606
Bond Position:  [-9.58863226]


portfolio before change:  [-20.01478955]
curr_Stock_Price:  101.98784941937521
curr_Factors:  [101.98784942]
mat_Sqrt:  [[0.15]]
grads:  [0.1528401]
Stock Position:  0.15284010332025988
Bond Position:  [-35.602623]


portfolio before change:  [-20.08040196]
curr_Stock_Price:  101.5876808870985
curr_Factors:  [101.58768089]
mat_Sqrt:  [[0.15]]
grads:  [0.13426206]
Stock Position:  0.13426205846878783
Bond Position:  [-33.71977311]


portfolio before change:  [-20.14617856]
curr_Stock_Price:  101.12916443858977
curr_Factors:  [101.12916444]
mat_Sqrt:  [[0.15]]
grads:  [-0.08835985]
Stock Position:  -0.08835985183548521
Bond Position:  [-11.21042057]


portfolio before change:  [-20.05874832]
curr_Stock_Price:  100.12382522234738
curr_Factors:  [100.12382522]
mat_Sqrt:  [[0.15]]
grads:  [0.14951428]
Stock Position:  0.14951428363416805
Bond Position:  [-35.02869032]


portfolio before change:  [-20.03075692]
curr_Stock_Price:  100.34032800598187
curr_Factors:  [100.34032801]
mat_Sqrt:  [[0.15]]
grads:  [0.03817764]
Stock Position:  0.03817764140494268
Bond Position:  [-23.86151398]


portfolio before change:  [-20.00170429]
curr_Stock_Price:  101.17944492940455
curr_Factors:  [101.17944493]
mat_Sqrt:  [[0.15]]
grads:  [-0.0172203]
Stock Position:  -0.01722029916098401
Bond Position:  [-18.25936398]


portfolio before change:  [-19.98934602]
curr_Stock_Price:  100.32923662193917
curr_Factors:  [100.32923662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02301379]
Stock Position:  -0.023013794317140422
Bond Position:  [-17.6803896]


portfolio before change:  [-19.98305717]
curr_Stock_Price:  99.95993505770834
curr_Factors:  [99.95993506]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101473]
Stock Position:  -0.04101473273162278
Bond Position:  [-15.88322715]


portfolio before change:  [-20.04357876]
curr_Stock_Price:  101.387130906001
curr_Factors:  [101.38713091]
mat_Sqrt:  [[0.15]]
grads:  [0.04480845]
Stock Position:  0.04480844666812954
Bond Position:  [-24.5865786]


portfolio before change:  [-19.94353817]
curr_Stock_Price:  103.68835094655495
curr_Factors:  [103.68835095]
mat_Sqrt:  [[0.15]]
grads:  [0.13250849]
Stock Position:  0.13250849158956307
Bond Position:  [-33.68312515]


portfolio before change:  [-20.1063598]
curr_Stock_Price:  102.49136369378427
curr_Factors:  [102.49136369]
mat_Sqrt:  [[0.15]]
grads:  [0.11796556]
Stock Position:  0.11796556301417116
Bond Position:  [-32.19681123]


portfolio before change:  [-20.06467542]
curr_Stock_Price:  102.87884319973796
curr_Factors:  [102.8788432]
mat_Sqrt:  [[0.15]]
grads:  [-0.00355133]
Stock Position:  -0.0035513328104786247
Bond Position:  [-19.69931841]


portfolio before change:  [-20.06980025]
curr_Stock_Price:  103.62849352856473
curr_Factors:  [103.62849353]
mat_Sqrt:  [[0.15]]
grads:  [-0.03309385]
Stock Position:  -0.03309384500268429
Bond Position:  [-16.64033494]


portfolio before change:  [-20.04012797]
curr_Stock_Price:  102.66902660752704
curr_Factors:  [102.66902661]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [-22.75466797]


portfolio before change:  [-20.02677244]
curr_Stock_Price:  103.28174282482259
curr_Factors:  [103.28174282]
mat_Sqrt:  [[0.15]]
grads:  [-0.07619563]
Stock Position:  -0.07619563190771636
Bond Position:  [-12.15715478]


portfolio before change:  [-20.0322785]
curr_Stock_Price:  103.3340598379341
curr_Factors:  [103.33405984]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551428]
Stock Position:  -0.005514275978620153
Bond Position:  [-19.46246598]


portfolio before change:  [-20.03579111]
curr_Stock_Price:  103.52985039556464
curr_Factors:  [103.5298504]
mat_Sqrt:  [[0.15]]
grads:  [0.028345]
Stock Position:  0.028344996369233297
Bond Position:  [-22.97034434]


portfolio before change:  [-20.02532456]
curr_Stock_Price:  104.000410166986
curr_Factors:  [104.00041017]
mat_Sqrt:  [[0.15]]
grads:  [0.03150954]
Stock Position:  0.03150954258495546
Bond Position:  [-23.30232992]


portfolio before change:  [-19.98139254]
curr_Stock_Price:  105.48710264029206
curr_Factors:  [105.48710264]
mat_Sqrt:  [[0.15]]
grads:  [0.01721415]
Stock Position:  0.01721415430215674
Bond Position:  [-21.7972638]


portfolio before change:  [-19.98224774]
curr_Stock_Price:  105.59571218860789
curr_Factors:  [105.59571219]
mat_Sqrt:  [[0.15]]
grads:  [0.03612749]
Stock Position:  0.036127487919509545
Bond Position:  [-23.79715556]


portfolio before change:  [-19.98059774]
curr_Stock_Price:  105.72372656701847
curr_Factors:  [105.72372657]
mat_Sqrt:  [[0.15]]
grads:  [0.00468481]
Stock Position:  0.004684810659533774
Bond Position:  [-20.47589338]


portfolio before change:  [-19.98283271]
curr_Stock_Price:  105.79303039584867
curr_Factors:  [105.7930304]
mat_Sqrt:  [[0.15]]
grads:  [-0.09035564]
Stock Position:  -0.09035563872394288
Bond Position:  [-10.42383587]


portfolio before change:  [-20.05832834]
curr_Stock_Price:  106.61414762469067
curr_Factors:  [106.61414762]
mat_Sqrt:  [[0.15]]
grads:  [0.02685089]
Stock Position:  0.026850890190930773
Bond Position:  [-22.92101311]


portfolio before change:  [-20.08091032]
curr_Stock_Price:  105.87984513446187
curr_Factors:  [105.87984513]
mat_Sqrt:  [[0.15]]
grads:  [0.04329791]
Stock Position:  0.043297910174435315
Bond Position:  [-24.66528635]


portfolio before change:  [-20.08196288]
curr_Stock_Price:  105.92674804651111
curr_Factors:  [105.92674805]
mat_Sqrt:  [[0.15]]
grads:  [0.26610333]
Stock Position:  0.26610333261712393
Bond Position:  [-48.26942355]


portfolio before change:  [-19.78600729]
curr_Stock_Price:  107.06160658376501
curr_Factors:  [107.06160658]
mat_Sqrt:  [[0.15]]
grads:  [-0.13345538]
Stock Position:  -0.13345538472775095
Bond Position:  [-5.4980594]


portfolio before change:  [-19.81571486]
curr_Stock_Price:  107.27905951370053
curr_Factors:  [107.27905951]
mat_Sqrt:  [[0.15]]
grads:  [-0.13702873]
Stock Position:  -0.13702872592020465
Bond Position:  [-5.11540201]


portfolio before change:  [-20.03355014]
curr_Stock_Price:  108.86409807728438
curr_Factors:  [108.86409808]
mat_Sqrt:  [[0.15]]
grads:  [0.20296913]
Stock Position:  0.20296913027227675
Bond Position:  [-42.12960144]


portfolio before change:  [-19.99861203]
curr_Stock_Price:  109.06218057823192
curr_Factors:  [109.06218058]
mat_Sqrt:  [[0.15]]
grads:  [0.06934423]
Stock Position:  0.06934423250370968
Bond Position:  [-27.56144524]


portfolio before change:  [-20.00822467]
curr_Stock_Price:  108.97324397672452
curr_Factors:  [108.97324398]
mat_Sqrt:  [[0.15]]
grads:  [0.05358052]
Stock Position:  0.0535805166928063
Bond Position:  [-25.84706739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.01219052]
Stock Price:  108.95953063600537
PL:  [-28.97172116]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 7.44809482e-03]
 [ 2.35784175e-02]
 [-1.52657012e-02]
 [-7.95137031e-03]
 [-3.32498705e-03]
 [ 6.20494015e-02]
 [ 3.38841933e-03]
 [ 3.53222829e-03]
 [-2.60333782e-03]
 [ 2.34447908e-02]
 [ 2.12424815e-02]
 [-8.73019766e-03]
 [-4.08676464e-04]
 [ 6.27895472e-03]
 [-1.00638623e-02]
 [-2.95444981e-03]
 [-6.12798788e-03]
 [ 6.86787605e-03]
 [ 6.27524618e-03]
 [-1.27329873e-02]
 [-3.88514415e-03]
 [-9.84274855e-03]
 [ 6.61097647e-03]
 [-7.00566148e-03]
 [ 1.50690308e-02]
 [ 8.22296373e-03]
 [-2.69723326e-03]
 [-4.23991529e-04]
 [ 4.71818021e-04]
 [-1.06715520e-02]
 [-2.00043028e-03]
 [ 1.50722942e-02]
 [-9.40491196e-03]
 [-1.93036610e-02]
 [-2.13298323e-02]
 [ 2.88845700e-02]
 [ 3.11294607e-03]
 [ 6.94773524e-03]
 [ 4.73318826e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.04445584]
curr_Stock_Price:  99.77541283874699
curr_Factors:  [99.77541284]
mat_Sqrt:  [[0.15]]
grads:  [0.04965397]
Stock Position:  0.049653965458976115
Bond Position:  [-7.99870075]


portfolio before change:  [-3.08081105]
curr_Stock_Price:  99.0633789754528
curr_Factors:  [99.06337898]
mat_Sqrt:  [[0.15]]
grads:  [0.15718945]
Stock Position:  0.15718945005857504
Bond Position:  [-18.65252911]


portfolio before change:  [-3.23527172]
curr_Stock_Price:  98.0955725581062
curr_Factors:  [98.09557256]
mat_Sqrt:  [[0.15]]
grads:  [-0.10177134]
Stock Position:  -0.10177134161320156
Bond Position:  [6.74804631]


portfolio before change:  [-3.22094531]
curr_Stock_Price:  97.96309075144703
curr_Factors:  [97.96309075]
mat_Sqrt:  [[0.15]]
grads:  [-0.05300914]
Stock Position:  -0.053009135400548975
Bond Position:  [1.97199343]


portfolio before change:  [-3.14309897]
curr_Stock_Price:  96.49919549576067
curr_Factors:  [96.4991955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02216658]
Stock Position:  -0.022166580333617025
Bond Position:  [-1.0040418]


portfolio before change:  [-3.13051906]
curr_Stock_Price:  95.9260162340576
curr_Factors:  [95.92601623]
mat_Sqrt:  [[0.15]]
grads:  [0.41366268]
Stock Position:  0.413662676771416
Bond Position:  [-42.81153171]


portfolio before change:  [-3.08137556]
curr_Stock_Price:  96.05775467884864
curr_Factors:  [96.05775468]
mat_Sqrt:  [[0.15]]
grads:  [0.02258946]
Stock Position:  0.0225894621878648
Bond Position:  [-5.25126858]


portfolio before change:  [-3.06652703]
curr_Stock_Price:  96.74413595712379
curr_Factors:  [96.74413596]
mat_Sqrt:  [[0.15]]
grads:  [0.02354819]
Stock Position:  0.023548188601712965
Bond Position:  [-5.34467619]


portfolio before change:  [-3.04331618]
curr_Stock_Price:  97.7581832390706
curr_Factors:  [97.75818324]
mat_Sqrt:  [[0.15]]
grads:  [-0.01735559]
Stock Position:  -0.017355585495412995
Bond Position:  [-1.34666567]


portfolio before change:  [-3.03580875]
curr_Stock_Price:  97.31591830366936
curr_Factors:  [97.3159183]
mat_Sqrt:  [[0.15]]
grads:  [0.15629861]
Stock Position:  0.15629860531014247
Bond Position:  [-18.24615106]


portfolio before change:  [-2.98872263]
curr_Stock_Price:  97.6317690918068
curr_Factors:  [97.63176909]
mat_Sqrt:  [[0.15]]
grads:  [0.14161654]
Stock Position:  0.14161654324654063
Bond Position:  [-16.81499628]


portfolio before change:  [-3.01206117]
curr_Stock_Price:  97.48181105666066
curr_Factors:  [97.48181106]
mat_Sqrt:  [[0.15]]
grads:  [-0.05820132]
Stock Position:  -0.05820131771058825
Bond Position:  [2.66150869]


portfolio before change:  [-3.05593914]
curr_Stock_Price:  98.24142757689219
curr_Factors:  [98.24142758]
mat_Sqrt:  [[0.15]]
grads:  [-0.00272451]
Stock Position:  -0.00272450976047541
Bond Position:  [-2.78827942]


portfolio before change:  [-3.0576887]
curr_Stock_Price:  98.75564841748515
curr_Factors:  [98.75564842]
mat_Sqrt:  [[0.15]]
grads:  [0.0418597]
Stock Position:  0.04185969812931063
Bond Position:  [-7.19157033]


portfolio before change:  [-3.04622665]
curr_Stock_Price:  99.05094557795078
curr_Factors:  [99.05094558]
mat_Sqrt:  [[0.15]]
grads:  [-0.06709242]
Stock Position:  -0.06709241508401363
Bond Position:  [3.5993405]


portfolio before change:  [-3.10691205]
curr_Stock_Price:  99.9621565972681
curr_Factors:  [99.9621566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01969633]
Stock Position:  -0.01969633204349911
Bond Position:  [-1.13802423]


portfolio before change:  [-3.10868621]
curr_Stock_Price:  100.04500903511442
curr_Factors:  [100.04500904]
mat_Sqrt:  [[0.15]]
grads:  [-0.04085325]
Stock Position:  -0.040853252517919915
Bond Position:  [0.97847781]


portfolio before change:  [-3.17374934]
curr_Stock_Price:  101.64060896677915
curr_Factors:  [101.64060897]
mat_Sqrt:  [[0.15]]
grads:  [0.04578584]
Stock Position:  0.04578584034134295
Bond Position:  [-7.82745003]


portfolio before change:  [-3.24597972]
curr_Stock_Price:  100.08440976695812
curr_Factors:  [100.08440977]
mat_Sqrt:  [[0.15]]
grads:  [0.04183497]
Stock Position:  0.04183497450838854
Bond Position:  [-7.43300845]


portfolio before change:  [-3.26014188]
curr_Stock_Price:  99.76809604180478
curr_Factors:  [99.76809604]
mat_Sqrt:  [[0.15]]
grads:  [-0.08488658]
Stock Position:  -0.08488658231025896
Bond Position:  [5.20883082]


portfolio before change:  [-3.25491706]
curr_Stock_Price:  99.71421620595089
curr_Factors:  [99.71421621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02590096]
Stock Position:  -0.02590096101704875
Bond Position:  [-0.67222303]


portfolio before change:  [-3.23442254]
curr_Stock_Price:  98.9197072142422
curr_Factors:  [98.91970721]
mat_Sqrt:  [[0.15]]
grads:  [-0.06561832]
Stock Position:  -0.0656183236982928
Bond Position:  [3.25652282]


portfolio before change:  [-3.21242206]
curr_Stock_Price:  98.59063155235475
curr_Factors:  [98.59063155]
mat_Sqrt:  [[0.15]]
grads:  [0.04407318]
Stock Position:  0.04407317648555063
Bond Position:  [-7.55762436]


portfolio before change:  [-3.23171909]
curr_Stock_Price:  98.17422711160854
curr_Factors:  [98.17422711]
mat_Sqrt:  [[0.15]]
grads:  [-0.04670441]
Stock Position:  -0.04670440989650402
Bond Position:  [1.35345026]


portfolio before change:  [-3.29613933]
curr_Stock_Price:  99.5571679655158
curr_Factors:  [99.55716797]
mat_Sqrt:  [[0.15]]
grads:  [0.10046021]
Stock Position:  0.10046020517594635
Bond Position:  [-13.29767285]


portfolio before change:  [-3.26816077]
curr_Stock_Price:  99.85221890129958
curr_Factors:  [99.8522189]
mat_Sqrt:  [[0.15]]
grads:  [0.05481976]
Stock Position:  0.05481975819732997
Bond Position:  [-8.74203526]


portfolio before change:  [-3.19718658]
curr_Stock_Price:  101.16683628446194
curr_Factors:  [101.16683628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798156]
Stock Position:  -0.017981555060908514
Bond Position:  [-1.37804955]


portfolio before change:  [-3.20384389]
curr_Stock_Price:  101.5274856697484
curr_Factors:  [101.52748567]
mat_Sqrt:  [[0.15]]
grads:  [-0.00282661]
Stock Position:  -0.0028266101954660164
Bond Position:  [-2.91686526]


portfolio before change:  [-3.20026053]
curr_Stock_Price:  100.13076323631358
curr_Factors:  [100.13076324]
mat_Sqrt:  [[0.15]]
grads:  [0.00314545]
Stock Position:  0.0031454534747227796
Bond Position:  [-3.51521719]


portfolio before change:  [-3.20191988]
curr_Stock_Price:  99.74292554633173
curr_Factors:  [99.74292555]
mat_Sqrt:  [[0.15]]
grads:  [-0.07114368]
Stock Position:  -0.07114367997060304
Bond Position:  [3.89415889]


portfolio before change:  [-3.1517567]
curr_Stock_Price:  99.04467124888286
curr_Factors:  [99.04467125]
mat_Sqrt:  [[0.15]]
grads:  [-0.0133362]
Stock Position:  -0.013336201893758748
Bond Position:  [-1.83087697]


portfolio before change:  [-3.15573332]
curr_Stock_Price:  99.3256912747101
curr_Factors:  [99.32569127]
mat_Sqrt:  [[0.15]]
grads:  [0.10048196]
Stock Position:  0.10048196124709208
Bond Position:  [-13.13617358]


portfolio before change:  [-3.19180418]
curr_Stock_Price:  98.98305527978238
curr_Factors:  [98.98305528]
mat_Sqrt:  [[0.15]]
grads:  [-0.06269941]
Stock Position:  -0.0626994130370144
Bond Position:  [3.01437529]


portfolio before change:  [-3.29231016]
curr_Stock_Price:  100.59204639379787
curr_Factors:  [100.59204639]
mat_Sqrt:  [[0.15]]
grads:  [-0.12869107]
Stock Position:  -0.12869107312940242
Bond Position:  [9.65298824]


portfolio before change:  [-3.25815037]
curr_Stock_Price:  100.33598287282747
curr_Factors:  [100.33598287]
mat_Sqrt:  [[0.15]]
grads:  [-0.14219888]
Stock Position:  -0.142198881841637
Bond Position:  [11.00951421]


portfolio before change:  [-3.20961964]
curr_Stock_Price:  100.00437371992743
curr_Factors:  [100.00437372]
mat_Sqrt:  [[0.15]]
grads:  [0.1925638]
Stock Position:  0.19256379980396898
Bond Position:  [-22.46684184]


portfolio before change:  [-3.39450674]
curr_Stock_Price:  99.05882441693167
curr_Factors:  [99.05882442]
mat_Sqrt:  [[0.15]]
grads:  [0.02075297]
Stock Position:  0.020752973789780364
Bond Position:  [-5.45027193]


portfolio before change:  [-3.41744374]
curr_Stock_Price:  97.98641569043133
curr_Factors:  [97.98641569]
mat_Sqrt:  [[0.15]]
grads:  [0.04631823]
Stock Position:  0.04631823494118925
Bond Position:  [-7.95600156]


portfolio before change:  [-3.40382727]
curr_Stock_Price:  98.30186444054735
curr_Factors:  [98.30186444]
mat_Sqrt:  [[0.15]]
grads:  [0.03155459]
Stock Position:  0.031554588385880704
Bond Position:  [-6.50570214]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.40061929]
Stock Price:  98.4293019980263
PL:  [-3.40061929]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.94041295e-03]
 [ 4.09261476e-02]
 [-3.97881162e-03]
 [ 4.73525246e-04]
 [-1.12527690e-04]
 [ 2.58187104e-02]
 [ 3.68568473e-03]
 [ 6.25825195e-03]
 [-1.23911425e-02]
 [ 2.29338673e-02]
 [ 1.89132223e-02]
 [-1.43052822e-02]
 [ 3.17003031e-02]
 [ 1.15621281e-02]
 [-1.22792658e-02]
 [-3.26180890e-03]
 [-5.52926094e-03]
 [ 7.80304515e-03]
 [ 2.05012871e-02]
 [ 1.62264086e-02]
 [ 7.15624063e-04]
 [-6.82807142e-03]
 [ 5.43238901e-03]
 [-7.81562871e-03]
 [-7.17040338e-03]
 [ 4.88466790e-03]
 [ 6.81399675e-03]
 [ 2.33020135e-03]
 [ 5.16296886e-03]
 [-4.13511787e-03]
 [-1.42235855e-02]
 [ 5.38124813e-03]
 [ 4.62478965e-03]
 [-6.65248059e-03]
 [-2.03090282e-02]
 [ 2.01646028e-02]
 [ 2.36985924e-03]
 [ 2.15802233e-02]
 [ 8.95424578e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.91638853]
curr_Stock_Price:  99.32578528487038
curr_Factors:  [99.32578528]
mat_Sqrt:  [[0.15]]
grads:  [-0.05293609]
Stock Position:  -0.05293608636115765
Bond Position:  [-7.65847018]


portfolio before change:  [-12.95188264]
curr_Stock_Price:  99.97820873209726
curr_Factors:  [99.97820873]
mat_Sqrt:  [[0.15]]
grads:  [0.27284098]
Stock Position:  0.2728409839547426
Bond Position:  [-40.23003548]


portfolio before change:  [-12.65708527]
curr_Stock_Price:  101.07711415952868
curr_Factors:  [101.07711416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652541]
Stock Position:  -0.026525410828720637
Bond Position:  [-9.97597329]


portfolio before change:  [-12.68124987]
curr_Stock_Price:  101.94109803140154
curr_Factors:  [101.94109803]
mat_Sqrt:  [[0.15]]
grads:  [0.00315683]
Stock Position:  0.0031568349745767464
Bond Position:  [-13.0030611]


portfolio before change:  [-12.6811295]
curr_Stock_Price:  102.49413742502365
curr_Factors:  [102.49413743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075018]
Stock Position:  -0.0007501845985230284
Bond Position:  [-12.60423998]


portfolio before change:  [-12.68205129]
curr_Stock_Price:  101.62256563457336
curr_Factors:  [101.62256563]
mat_Sqrt:  [[0.15]]
grads:  [0.17212474]
Stock Position:  0.1721247358537588
Bond Position:  [-30.17380856]


portfolio before change:  [-12.75192821]
curr_Stock_Price:  101.23851301751066
curr_Factors:  [101.23851302]
mat_Sqrt:  [[0.15]]
grads:  [0.02457123]
Stock Position:  0.024571231565231538
Bond Position:  [-15.23948315]


portfolio before change:  [-12.76145431]
curr_Stock_Price:  100.92835174797166
curr_Factors:  [100.92835175]
mat_Sqrt:  [[0.15]]
grads:  [0.04172168]
Stock Position:  0.041721679656525366
Bond Position:  [-16.97235467]


portfolio before change:  [-12.72221828]
curr_Stock_Price:  101.9196278090906
curr_Factors:  [101.91962781]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260762]
Stock Position:  -0.08260761656474754
Bond Position:  [-4.30288075]


portfolio before change:  [-12.72551347]
curr_Stock_Price:  101.95300602001568
curr_Factors:  [101.95300602]
mat_Sqrt:  [[0.15]]
grads:  [0.15289245]
Stock Position:  0.15289244888045891
Bond Position:  [-28.31335823]


portfolio before change:  [-12.70024711]
curr_Stock_Price:  102.14141135536998
curr_Factors:  [102.14141136]
mat_Sqrt:  [[0.15]]
grads:  [0.12608815]
Stock Position:  0.12608814850757805
Bond Position:  [-25.57906855]


portfolio before change:  [-12.93926886]
curr_Stock_Price:  100.27109943389084
curr_Factors:  [100.27109943]
mat_Sqrt:  [[0.15]]
grads:  [-0.09536855]
Stock Position:  -0.0953685478923994
Bond Position:  [-3.37655971]


portfolio before change:  [-12.97312054]
curr_Stock_Price:  100.62162994642912
curr_Factors:  [100.62162995]
mat_Sqrt:  [[0.15]]
grads:  [0.21133535]
Stock Position:  0.21133535399956008
Bond Position:  [-34.23802833]


portfolio before change:  [-12.92958863]
curr_Stock_Price:  100.84786719357844
curr_Factors:  [100.84786719]
mat_Sqrt:  [[0.15]]
grads:  [0.07708085]
Stock Position:  0.07708085367677336
Bond Position:  [-20.70302833]


portfolio before change:  [-12.84748174]
curr_Stock_Price:  101.94664759096509
curr_Factors:  [101.94664759]
mat_Sqrt:  [[0.15]]
grads:  [-0.08186177]
Stock Position:  -0.08186177229442135
Bond Position:  [-4.50194849]


portfolio before change:  [-12.81186833]
curr_Stock_Price:  101.5047295858617
curr_Factors:  [101.50472959]
mat_Sqrt:  [[0.15]]
grads:  [-0.02174539]
Stock Position:  -0.021745392675708252
Bond Position:  [-10.60460813]


portfolio before change:  [-12.82803858]
curr_Stock_Price:  102.18738436865836
curr_Factors:  [102.18738437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03686174]
Stock Position:  -0.03686173960501138
Bond Position:  [-9.06123383]


portfolio before change:  [-12.88348575]
curr_Stock_Price:  103.66084809506124
curr_Factors:  [103.6608481]
mat_Sqrt:  [[0.15]]
grads:  [0.0520203]
Stock Position:  0.05202030097573951
Bond Position:  [-18.27595426]


portfolio before change:  [-12.87647022]
curr_Stock_Price:  103.83962763830762
curr_Factors:  [103.83962764]
mat_Sqrt:  [[0.15]]
grads:  [0.13667525]
Stock Position:  0.13667524712781987
Bond Position:  [-27.06877699]


portfolio before change:  [-13.02838011]
curr_Stock_Price:  102.752919665144
curr_Factors:  [102.75291967]
mat_Sqrt:  [[0.15]]
grads:  [0.10817606]
Stock Position:  0.10817605732675473
Bond Position:  [-24.14378583]


portfolio before change:  [-12.88742574]
curr_Stock_Price:  104.08382904510789
curr_Factors:  [104.08382905]
mat_Sqrt:  [[0.15]]
grads:  [0.00477083]
Stock Position:  0.004770827085318162
Bond Position:  [-13.38399169]


portfolio before change:  [-12.88915796]
curr_Stock_Price:  104.07143740621285
curr_Factors:  [104.07143741]
mat_Sqrt:  [[0.15]]
grads:  [-0.04552048]
Stock Position:  -0.04552047616404287
Bond Position:  [-8.15177658]


portfolio before change:  [-12.89893787]
curr_Stock_Price:  104.26389745576398
curr_Factors:  [104.26389746]
mat_Sqrt:  [[0.15]]
grads:  [0.03621593]
Stock Position:  0.03621592673438263
Bond Position:  [-16.67495154]


portfolio before change:  [-12.8682214]
curr_Stock_Price:  105.16960313127667
curr_Factors:  [105.16960313]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210419]
Stock Position:  -0.052104191402702546
Bond Position:  [-7.38844427]


portfolio before change:  [-12.87830396]
curr_Stock_Price:  105.34538445126263
curr_Factors:  [105.34538445]
mat_Sqrt:  [[0.15]]
grads:  [-0.04780269]
Stock Position:  -0.04780268920829162
Bond Position:  [-7.84251128]


portfolio before change:  [-12.93951458]
curr_Stock_Price:  106.60536066328466
curr_Factors:  [106.60536066]
mat_Sqrt:  [[0.15]]
grads:  [0.03256445]
Stock Position:  0.03256445266803121
Bond Position:  [-16.4110598]


portfolio before change:  [-12.98549754]
curr_Stock_Price:  105.2562990915485
curr_Factors:  [105.25629909]
mat_Sqrt:  [[0.15]]
grads:  [0.04542665]
Stock Position:  0.045426645002838946
Bond Position:  [-17.76693808]


portfolio before change:  [-12.9965341]
curr_Stock_Price:  105.06223780498007
curr_Factors:  [105.0622378]
mat_Sqrt:  [[0.15]]
grads:  [0.01553468]
Stock Position:  0.015534675689003215
Bond Position:  [-14.6286419]


portfolio before change:  [-13.00999421]
curr_Stock_Price:  104.313498885676
curr_Factors:  [104.31349889]
mat_Sqrt:  [[0.15]]
grads:  [0.03441979]
Stock Position:  0.03441979241805584
Bond Position:  [-16.60044319]


portfolio before change:  [-13.00387666]
curr_Stock_Price:  104.55152310644709
curr_Factors:  [104.55152311]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756745]
Stock Position:  -0.027567452475191143
Bond Position:  [-10.12165751]


portfolio before change:  [-13.03047458]
curr_Stock_Price:  105.4704559187314
curr_Factors:  [105.47045592]
mat_Sqrt:  [[0.15]]
grads:  [-0.0948239]
Stock Position:  -0.09482390339396472
Bond Position:  [-3.02935426]


portfolio before change:  [-12.97655711]
curr_Stock_Price:  104.89785600372431
curr_Factors:  [104.897856]
mat_Sqrt:  [[0.15]]
grads:  [0.03587499]
Stock Position:  0.03587498755983121
Bond Position:  [-16.73976639]


portfolio before change:  [-12.96746361]
curr_Stock_Price:  105.20966402023889
curr_Factors:  [105.20966402]
mat_Sqrt:  [[0.15]]
grads:  [0.03083193]
Stock Position:  0.030831931029485598
Bond Position:  [-16.21128071]


portfolio before change:  [-13.01489262]
curr_Stock_Price:  103.7370843805331
curr_Factors:  [103.73708438]
mat_Sqrt:  [[0.15]]
grads:  [-0.04434987]
Stock Position:  -0.04434987057650774
Bond Position:  [-8.41416635]


portfolio before change:  [-12.99503964]
curr_Stock_Price:  103.26572315629771
curr_Factors:  [103.26572316]
mat_Sqrt:  [[0.15]]
grads:  [-0.13539352]
Stock Position:  -0.13539352112347858
Bond Position:  [0.98647023]


portfolio before change:  [-12.92266252]
curr_Stock_Price:  102.732065389907
curr_Factors:  [102.73206539]
mat_Sqrt:  [[0.15]]
grads:  [0.13443069]
Stock Position:  0.1344306850982133
Bond Position:  [-26.73300445]


portfolio before change:  [-12.91757118]
curr_Stock_Price:  102.79479788958086
curr_Factors:  [102.79479789]
mat_Sqrt:  [[0.15]]
grads:  [0.01579906]
Stock Position:  0.015799061580183092
Bond Position:  [-14.54163253]


portfolio before change:  [-12.91053236]
curr_Stock_Price:  103.35537812216081
curr_Factors:  [103.35537812]
mat_Sqrt:  [[0.15]]
grads:  [0.14386816]
Stock Position:  0.14386815552171087
Bond Position:  [-27.78007997]


portfolio before change:  [-13.15051617]
curr_Stock_Price:  101.71143490706478
curr_Factors:  [101.71143491]
mat_Sqrt:  [[0.15]]
grads:  [0.05969497]
Stock Position:  0.0596949718985668
Bond Position:  [-19.22217741]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.18835125]
Stock Price:  101.11788137121789
PL:  [-14.30623262]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.88791939e-03]
 [ 3.22792091e-02]
 [-2.78816374e-03]
 [-7.16438804e-03]
 [-7.58361215e-03]
 [ 3.18663983e-02]
 [ 3.70790923e-03]
 [ 4.80618016e-03]
 [-2.76663017e-02]
 [ 2.33942246e-02]
 [ 1.91395998e-02]
 [-1.52868183e-02]
 [ 1.93327843e-02]
 [ 6.38277018e-03]
 [-1.72701213e-02]
 [ 1.77417363e-04]
 [-6.10756185e-03]
 [-3.43337634e-03]
 [ 1.31588867e-03]
 [-1.65515482e-02]
 [-6.13253924e-03]
 [-1.85516118e-02]
 [ 6.57820026e-03]
 [-6.41534489e-03]
 [ 1.42490003e-02]
 [ 8.08647071e-03]
 [-7.95196476e-03]
 [-3.53341727e-03]
 [-1.40505996e-02]
 [-1.25164695e-02]
 [ 3.72318894e-02]
 [ 5.73804902e-03]
 [-1.68756095e-02]
 [-3.23577486e-02]
 [-2.34298331e-02]
 [ 3.71429076e-02]
 [-5.25739002e-03]
 [-2.95893053e-03]
 [ 3.11855560e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.34700954]
curr_Stock_Price:  99.7160866612487
curr_Factors:  [99.71608666]
mat_Sqrt:  [[0.15]]
grads:  [0.01258613]
Stock Position:  0.012586129257617467
Bond Position:  [-5.60204909]


portfolio before change:  [-4.35059154]
curr_Stock_Price:  99.48712763506646
curr_Factors:  [99.48712764]
mat_Sqrt:  [[0.15]]
grads:  [0.21519473]
Stock Position:  0.21519472737000991
Bond Position:  [-25.75969685]


portfolio before change:  [-4.30394022]
curr_Stock_Price:  99.7188781361939
curr_Factors:  [99.71887814]
mat_Sqrt:  [[0.15]]
grads:  [-0.01858776]
Stock Position:  -0.018587758256005775
Bond Position:  [-2.45038982]


portfolio before change:  [-4.289477]
curr_Stock_Price:  98.92429408529154
curr_Factors:  [98.92429409]
mat_Sqrt:  [[0.15]]
grads:  [-0.04776259]
Stock Position:  -0.04776258690383638
Bond Position:  [0.43540319]


portfolio before change:  [-4.31572609]
curr_Stock_Price:  99.47500779337255
curr_Factors:  [99.47500779]
mat_Sqrt:  [[0.15]]
grads:  [-0.05055741]
Stock Position:  -0.05055741431248497
Bond Position:  [0.7134731]


portfolio before change:  [-4.36601639]
curr_Stock_Price:  100.47148852504546
curr_Factors:  [100.47148853]
mat_Sqrt:  [[0.15]]
grads:  [0.21244266]
Stock Position:  0.21244265521444872
Bond Position:  [-25.71044618]


portfolio before change:  [-4.3696723]
curr_Stock_Price:  100.46940838179187
curr_Factors:  [100.46940838]
mat_Sqrt:  [[0.15]]
grads:  [0.02471939]
Stock Position:  0.024719394862697138
Bond Position:  [-6.85321528]


portfolio before change:  [-4.36876131]
curr_Stock_Price:  100.54091911545736
curr_Factors:  [100.54091912]
mat_Sqrt:  [[0.15]]
grads:  [0.0320412]
Stock Position:  0.03204120109740144
Bond Position:  [-7.59021311]


portfolio before change:  [-4.39493278]
curr_Stock_Price:  99.75372520535585
curr_Factors:  [99.75372521]
mat_Sqrt:  [[0.15]]
grads:  [-0.18444201]
Stock Position:  -0.18444201126073323
Bond Position:  [14.00384493]


portfolio before change:  [-4.44151828]
curr_Stock_Price:  100.0157917771885
curr_Factors:  [100.01579178]
mat_Sqrt:  [[0.15]]
grads:  [0.1559615]
Stock Position:  0.15596149712035468
Bond Position:  [-20.0401309]


portfolio before change:  [-4.43626308]
curr_Stock_Price:  100.06555000994419
curr_Factors:  [100.06555001]
mat_Sqrt:  [[0.15]]
grads:  [0.12759733]
Stock Position:  0.1275973322875186
Bond Position:  [-17.20436032]


portfolio before change:  [-4.48491205]
curr_Stock_Price:  99.70113573818313
curr_Factors:  [99.70113574]
mat_Sqrt:  [[0.15]]
grads:  [-0.10191212]
Stock Position:  -0.10191212189505135
Bond Position:  [5.67584225]


portfolio before change:  [-4.5059033]
curr_Stock_Price:  99.91407191877325
curr_Factors:  [99.91407192]
mat_Sqrt:  [[0.15]]
grads:  [0.12888523]
Stock Position:  0.12888522845799652
Bond Position:  [-17.38335129]


portfolio before change:  [-4.61721076]
curr_Stock_Price:  99.06731542479153
curr_Factors:  [99.06731542]
mat_Sqrt:  [[0.15]]
grads:  [0.0425518]
Stock Position:  0.04255180122913374
Bond Position:  [-8.83270348]


portfolio before change:  [-4.68605947]
curr_Stock_Price:  97.47526650040604
curr_Factors:  [97.4752665]
mat_Sqrt:  [[0.15]]
grads:  [-0.11513414]
Stock Position:  -0.11513414207643104
Bond Position:  [6.53667171]


portfolio before change:  [-4.62122376]
curr_Stock_Price:  96.91923185115951
curr_Factors:  [96.91923185]
mat_Sqrt:  [[0.15]]
grads:  [0.00118278]
Stock Position:  0.0011827824202530607
Bond Position:  [-4.73585812]


portfolio before change:  [-4.6222049]
curr_Stock_Price:  96.59024290523433
curr_Factors:  [96.59024291]
mat_Sqrt:  [[0.15]]
grads:  [-0.04071708]
Stock Position:  -0.04071707897122172
Bond Position:  [-0.68933235]


portfolio before change:  [-4.59631619]
curr_Stock_Price:  95.9523071538149
curr_Factors:  [95.95230715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02288918]
Stock Position:  -0.022889175574440843
Bond Position:  [-2.40004699]


portfolio before change:  [-4.59782736]
curr_Stock_Price:  96.0052202278567
curr_Factors:  [96.00522023]
mat_Sqrt:  [[0.15]]
grads:  [0.00877259]
Stock Position:  0.008772591164878264
Bond Position:  [-5.4400419]


portfolio before change:  [-4.59102217]
curr_Stock_Price:  96.85847244597176
curr_Factors:  [96.85847245]
mat_Sqrt:  [[0.15]]
grads:  [-0.11034365]
Stock Position:  -0.11034365449066698
Bond Position:  [6.09669565]


portfolio before change:  [-4.65814718]
curr_Stock_Price:  97.4737062153742
curr_Factors:  [97.47370622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04088359]
Stock Position:  -0.04088359493052904
Bond Position:  [-0.67307166]


portfolio before change:  [-4.64351127]
curr_Stock_Price:  97.11365855786927
curr_Factors:  [97.11365856]
mat_Sqrt:  [[0.15]]
grads:  [-0.12367741]
Stock Position:  -0.12367741212392222
Bond Position:  [7.3672547]


portfolio before change:  [-4.78067838]
curr_Stock_Price:  98.23017668877424
curr_Factors:  [98.23017669]
mat_Sqrt:  [[0.15]]
grads:  [0.04385467]
Stock Position:  0.043854668381518296
Bond Position:  [-9.08853021]


portfolio before change:  [-4.75484165]
curr_Stock_Price:  98.84522793156077
curr_Factors:  [98.84522793]
mat_Sqrt:  [[0.15]]
grads:  [-0.04276897]
Stock Position:  -0.042768965906987214
Bond Position:  [-0.52733347]


portfolio before change:  [-4.72927972]
curr_Stock_Price:  98.24601176976171
curr_Factors:  [98.24601177]
mat_Sqrt:  [[0.15]]
grads:  [0.09499334]
Stock Position:  0.09499333546582808
Bond Position:  [-14.06199607]


portfolio before change:  [-4.6084702]
curr_Stock_Price:  99.53628523232967
curr_Factors:  [99.53628523]
mat_Sqrt:  [[0.15]]
grads:  [0.0539098]
Stock Position:  0.053909804745890105
Bond Position:  [-9.9744519]


portfolio before change:  [-4.61612002]
curr_Stock_Price:  99.41751399617144
curr_Factors:  [99.417514]
mat_Sqrt:  [[0.15]]
grads:  [-0.0530131]
Stock Position:  -0.053013098427442465
Bond Position:  [0.65431044]


portfolio before change:  [-4.52666277]
curr_Stock_Price:  97.7316014247021
curr_Factors:  [97.73160142]
mat_Sqrt:  [[0.15]]
grads:  [-0.02355612]
Stock Position:  -0.023556115111598906
Bond Position:  [-2.22448592]


portfolio before change:  [-4.52387168]
curr_Stock_Price:  97.60130945653326
curr_Factors:  [97.60130946]
mat_Sqrt:  [[0.15]]
grads:  [-0.09367066]
Stock Position:  -0.09367066417494796
Bond Position:  [4.6185078]


portfolio before change:  [-4.45328481]
curr_Stock_Price:  96.85390879609584
curr_Factors:  [96.8539088]
mat_Sqrt:  [[0.15]]
grads:  [-0.08344313]
Stock Position:  -0.08344313008537992
Bond Position:  [3.6285085]


portfolio before change:  [-4.44917396]
curr_Stock_Price:  96.81007940247682
curr_Factors:  [96.8100794]
mat_Sqrt:  [[0.15]]
grads:  [0.2482126]
Stock Position:  0.2482125959378904
Bond Position:  [-28.47865508]


portfolio before change:  [-4.4522269]
curr_Stock_Price:  96.81212247795436
curr_Factors:  [96.81212248]
mat_Sqrt:  [[0.15]]
grads:  [0.03825366]
Stock Position:  0.038253660162381395
Bond Position:  [-8.15564493]


portfolio before change:  [-4.48231636]
curr_Stock_Price:  96.05219670524274
curr_Factors:  [96.05219671]
mat_Sqrt:  [[0.15]]
grads:  [-0.11250406]
Stock Position:  -0.11250406312302591
Bond Position:  [6.32394604]


portfolio before change:  [-4.39862633]
curr_Stock_Price:  95.31533899524977
curr_Factors:  [95.315339]
mat_Sqrt:  [[0.15]]
grads:  [-0.21571832]
Stock Position:  -0.21571832414745307
Bond Position:  [16.16263887]


portfolio before change:  [-4.3536174]
curr_Stock_Price:  95.1160584138463
curr_Factors:  [95.11605841]
mat_Sqrt:  [[0.15]]
grads:  [-0.15619889]
Stock Position:  -0.15619888757502587
Bond Position:  [10.50340512]


portfolio before change:  [-4.44088038]
curr_Stock_Price:  95.6831302554379
curr_Factors:  [95.68313026]
mat_Sqrt:  [[0.15]]
grads:  [0.24761938]
Stock Position:  0.24761938409924542
Bond Position:  [-28.13387816]


portfolio before change:  [-4.59394262]
curr_Stock_Price:  95.07919822054174
curr_Factors:  [95.07919822]
mat_Sqrt:  [[0.15]]
grads:  [-0.03504927]
Stock Position:  -0.03504926681379711
Bond Position:  [-1.26148643]


portfolio before change:  [-4.59382999]
curr_Stock_Price:  95.07148574815824
curr_Factors:  [95.07148575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197262]
Stock Position:  -0.019726203521729664
Bond Position:  [-2.71843052]


portfolio before change:  [-4.57224262]
curr_Stock_Price:  93.9599083866731
curr_Factors:  [93.95990839]
mat_Sqrt:  [[0.15]]
grads:  [0.20790371]
Stock Position:  0.20790370645768633
Bond Position:  [-24.10685583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.74567068]
Stock Price:  93.14022835148623
PL:  [-4.74567068]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.27917051e-02]
 [-2.52012522e-02]
 [ 2.98521158e-03]
 [-2.63162723e-03]
 [ 6.21596987e-04]
 [ 8.25039675e-03]
 [ 3.48262511e-03]
 [ 2.30772592e-02]
 [-1.01966224e-03]
 [ 2.29581706e-02]
 [ 2.00111030e-02]
 [-1.13572204e-02]
 [ 1.53572711e-02]
 [ 1.47011092e-02]
 [-7.09017677e-03]
 [-2.87207159e-03]
 [-5.89721656e-03]
 [ 7.29876967e-03]
 [ 1.37642815e-02]
 [ 1.56519722e-02]
 [-1.11668324e-03]
 [-6.07614958e-03]
 [ 5.38179743e-03]
 [-9.17737555e-03]
 [ 1.18225706e-02]
 [ 8.06516132e-03]
 [-7.94183822e-03]
 [-2.82014093e-03]
 [-1.13170524e-03]
 [-1.39037542e-02]
 [ 1.82065220e-02]
 [ 7.50205591e-03]
 [-1.48017876e-02]
 [-4.59870091e-02]
 [-2.21152171e-02]
 [ 3.89596563e-02]
 [ 2.25507986e-03]
 [ 7.21399083e-03]
 [ 4.93769913e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.80173719]
curr_Stock_Price:  99.99613779588566
curr_Factors:  [99.9961378]
mat_Sqrt:  [[0.15]]
grads:  [0.1519447]
Stock Position:  0.1519447009485405
Bond Position:  [-13.39214607]


portfolio before change:  [2.06806157]
curr_Stock_Price:  101.75992752184506
curr_Factors:  [101.75992752]
mat_Sqrt:  [[0.15]]
grads:  [-0.16800835]
Stock Position:  -0.16800834787221913
Bond Position:  [19.16457887]


portfolio before change:  [2.08713789]
curr_Stock_Price:  101.66064313756502
curr_Factors:  [101.66064314]
mat_Sqrt:  [[0.15]]
grads:  [0.01990141]
Stock Position:  0.0199014105304002
Bond Position:  [0.0639477]


portfolio before change:  [2.07821808]
curr_Stock_Price:  101.21204131887919
curr_Factors:  [101.21204132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754418]
Stock Position:  -0.017544181559524075
Bond Position:  [3.85390051]


portfolio before change:  [2.05184368]
curr_Stock_Price:  102.74281494640911
curr_Factors:  [102.74281495]
mat_Sqrt:  [[0.15]]
grads:  [0.00414398]
Stock Position:  0.004143979915060785
Bond Position:  [1.62607951]


portfolio before change:  [2.05038732]
curr_Stock_Price:  102.34232305939526
curr_Factors:  [102.34232306]
mat_Sqrt:  [[0.15]]
grads:  [0.05500264]
Stock Position:  0.05500264498247358
Bond Position:  [-3.57871114]


portfolio before change:  [2.05970731]
curr_Stock_Price:  102.51990289499723
curr_Factors:  [102.51990289]
mat_Sqrt:  [[0.15]]
grads:  [0.0232175]
Stock Position:  0.023217500751984792
Bond Position:  [-0.32054861]


portfolio before change:  [2.06476502]
curr_Stock_Price:  102.7394691908605
curr_Factors:  [102.73946919]
mat_Sqrt:  [[0.15]]
grads:  [0.15384839]
Stock Position:  0.15384839478633347
Bond Position:  [-13.74153739]


portfolio before change:  [1.99260693]
curr_Stock_Price:  102.28161394026002
curr_Factors:  [102.28161394]
mat_Sqrt:  [[0.15]]
grads:  [-0.00679775]
Stock Position:  -0.0067977482917882855
Bond Position:  [2.68789159]


portfolio before change:  [1.99590986]
curr_Stock_Price:  101.8451573256729
curr_Factors:  [101.84515733]
mat_Sqrt:  [[0.15]]
grads:  [0.15305447]
Stock Position:  0.15305447096859826
Bond Position:  [-13.59194682]


portfolio before change:  [1.90366921]
curr_Stock_Price:  101.25359308196082
curr_Factors:  [101.25359308]
mat_Sqrt:  [[0.15]]
grads:  [0.13340735]
Stock Position:  0.1334073530952157
Bond Position:  [-11.60430464]


portfolio before change:  [1.94074505]
curr_Stock_Price:  101.54238131101059
curr_Factors:  [101.54238131]
mat_Sqrt:  [[0.15]]
grads:  [-0.0757148]
Stock Position:  -0.0757148025671778
Bond Position:  [9.6290064]


portfolio before change:  [1.90987581]
curr_Stock_Price:  101.96598330177449
curr_Factors:  [101.9659833]
mat_Sqrt:  [[0.15]]
grads:  [0.10238181]
Stock Position:  0.10238180715097332
Bond Position:  [-8.52958583]


portfolio before change:  [1.82432189]
curr_Stock_Price:  101.14076197626517
curr_Factors:  [101.14076198]
mat_Sqrt:  [[0.15]]
grads:  [0.09800739]
Stock Position:  0.09800739452227734
Bond Position:  [-8.08822067]


portfolio before change:  [1.84893369]
curr_Stock_Price:  101.4022002826161
curr_Factors:  [101.40220028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04726785]
Stock Position:  -0.04726784512202607
Bond Position:  [6.64199719]


portfolio before change:  [1.8187952]
curr_Stock_Price:  102.05737690579997
curr_Factors:  [102.05737691]
mat_Sqrt:  [[0.15]]
grads:  [-0.01914714]
Stock Position:  -0.019147143946864703
Bond Position:  [3.77290249]


portfolio before change:  [1.83127426]
curr_Stock_Price:  101.43026431611878
curr_Factors:  [101.43026432]
mat_Sqrt:  [[0.15]]
grads:  [-0.03931478]
Stock Position:  -0.039314777035056044
Bond Position:  [5.81898249]


portfolio before change:  [1.78713561]
curr_Stock_Price:  102.5714653847081
curr_Factors:  [102.57146538]
mat_Sqrt:  [[0.15]]
grads:  [0.04865846]
Stock Position:  0.048658464484004973
Bond Position:  [-3.20383439]


portfolio before change:  [1.76909904]
curr_Stock_Price:  102.20901934891658
curr_Factors:  [102.20901935]
mat_Sqrt:  [[0.15]]
grads:  [0.09176188]
Stock Position:  0.09176187652307391
Bond Position:  [-7.60979237]


portfolio before change:  [1.82744602]
curr_Stock_Price:  102.85523826744993
curr_Factors:  [102.85523827]
mat_Sqrt:  [[0.15]]
grads:  [0.10434648]
Stock Position:  0.10434648106437772
Bond Position:  [-8.90513615]


portfolio before change:  [1.79382465]
curr_Stock_Price:  102.54369777175437
curr_Factors:  [102.54369777]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744455]
Stock Position:  -0.00744455493444062
Bond Position:  [2.55721685]


portfolio before change:  [1.80045989]
curr_Stock_Price:  101.69535126926333
curr_Factors:  [101.69535127]
mat_Sqrt:  [[0.15]]
grads:  [-0.04050766]
Stock Position:  -0.04050766385072507
Bond Position:  [5.91990099]


portfolio before change:  [1.82402722]
curr_Stock_Price:  101.13182095070695
curr_Factors:  [101.13182095]
mat_Sqrt:  [[0.15]]
grads:  [0.03587865]
Stock Position:  0.03587864951157714
Bond Position:  [-1.80444594]


portfolio before change:  [1.80013251]
curr_Stock_Price:  100.47212125757468
curr_Factors:  [100.47212126]
mat_Sqrt:  [[0.15]]
grads:  [-0.0611825]
Stock Position:  -0.06118250367275198
Bond Position:  [7.94726844]


portfolio before change:  [1.82108154]
curr_Stock_Price:  100.145956878491
curr_Factors:  [100.14595688]
mat_Sqrt:  [[0.15]]
grads:  [0.07881714]
Stock Position:  0.07881713709759307
Bond Position:  [-6.07213607]


portfolio before change:  [1.77051438]
curr_Stock_Price:  99.51401193202253
curr_Factors:  [99.51401193]
mat_Sqrt:  [[0.15]]
grads:  [0.05376774]
Stock Position:  0.05376774214020918
Bond Position:  [-3.58012935]


portfolio before change:  [1.75034843]
curr_Stock_Price:  99.14727879835307
curr_Factors:  [99.1472788]
mat_Sqrt:  [[0.15]]
grads:  [-0.05294559]
Stock Position:  -0.052945588151578585
Bond Position:  [6.99975942]


portfolio before change:  [1.77084126]
curr_Stock_Price:  98.77675108632509
curr_Factors:  [98.77675109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01880094]
Stock Position:  -0.01880093954295607
Bond Position:  [3.62793698]


portfolio before change:  [1.76262491]
curr_Stock_Price:  99.23789133313842
curr_Factors:  [99.23789133]
mat_Sqrt:  [[0.15]]
grads:  [-0.0075447]
Stock Position:  -0.0075447016303928595
Bond Position:  [2.51134519]


portfolio before change:  [1.77545412]
curr_Stock_Price:  97.57907459954518
curr_Factors:  [97.5790746]
mat_Sqrt:  [[0.15]]
grads:  [-0.09269169]
Stock Position:  -0.09269169453513296
Bond Position:  [10.8202239]


portfolio before change:  [1.73141544]
curr_Stock_Price:  98.06877642975725
curr_Factors:  [98.06877643]
mat_Sqrt:  [[0.15]]
grads:  [0.12137681]
Stock Position:  0.12137681351510055
Bond Position:  [-10.17186014]


portfolio before change:  [1.64733569]
curr_Stock_Price:  97.38653583455165
curr_Factors:  [97.38653583]
mat_Sqrt:  [[0.15]]
grads:  [0.05001371]
Stock Position:  0.0500137060904719
Bond Position:  [-3.22332589]


portfolio before change:  [1.61663479]
curr_Stock_Price:  96.7807427289961
curr_Factors:  [96.78074273]
mat_Sqrt:  [[0.15]]
grads:  [-0.09867858]
Stock Position:  -0.09867858405651789
Bond Position:  [11.16682145]


portfolio before change:  [1.48771651]
curr_Stock_Price:  98.10133549852291
curr_Factors:  [98.1013355]
mat_Sqrt:  [[0.15]]
grads:  [-0.30658006]
Stock Position:  -0.3065800607329604
Bond Position:  [31.5636299]


portfolio before change:  [1.33323694]
curr_Stock_Price:  98.61808557088443
curr_Factors:  [98.61808557]
mat_Sqrt:  [[0.15]]
grads:  [-0.14743478]
Stock Position:  -0.14743478097491544
Bond Position:  [15.87297279]


portfolio before change:  [1.35873168]
curr_Stock_Price:  98.45862191522266
curr_Factors:  [98.45862192]
mat_Sqrt:  [[0.15]]
grads:  [0.25973104]
Stock Position:  0.2597310421261735
Bond Position:  [-24.2140288]


portfolio before change:  [1.25924276]
curr_Stock_Price:  98.08723013601451
curr_Factors:  [98.08723014]
mat_Sqrt:  [[0.15]]
grads:  [0.01503387]
Stock Position:  0.01503386572699617
Bond Position:  [-0.21538749]


portfolio before change:  [1.26592982]
curr_Stock_Price:  98.53382112727645
curr_Factors:  [98.53382113]
mat_Sqrt:  [[0.15]]
grads:  [0.04809327]
Stock Position:  0.0480932722097613
Bond Position:  [-3.47288406]


portfolio before change:  [1.29809992]
curr_Stock_Price:  99.21175871766302
curr_Factors:  [99.21175872]
mat_Sqrt:  [[0.15]]
grads:  [0.03291799]
Stock Position:  0.03291799422867855
Bond Position:  [-1.96775218]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.28251221]
Stock Price:  98.74569983608735
PL:  [1.28251221]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.86436466e-02]
 [-7.38940895e-02]
 [ 2.12706151e-02]
 [ 8.18026488e-03]
 [ 2.10734454e-03]
 [-2.93258562e-02]
 [ 3.32311348e-03]
 [ 4.04497282e-02]
 [ 9.59444855e-02]
 [ 2.25507927e-02]
 [ 1.62877521e-02]
 [-4.06509402e-04]
 [ 1.24231389e-02]
 [ 2.33408640e-02]
 [-8.53492067e-03]
 [-4.12328895e-03]
 [-4.23257626e-03]
 [ 7.78039998e-03]
 [ 2.42303998e-02]
 [ 5.56688028e-04]
 [-3.14734525e-04]
 [-8.76952636e-03]
 [ 5.19324673e-03]
 [-1.13077952e-02]
 [ 1.37472422e-03]
 [ 2.86114306e-03]
 [ 5.05310180e-03]
 [ 1.94915366e-03]
 [ 4.68772080e-03]
 [-6.02943927e-03]
 [-1.94723464e-02]
 [ 1.91309233e-02]
 [-3.37302955e-03]
 [-1.76733012e-02]
 [-2.16318889e-02]
 [ 3.51778021e-02]
 [ 2.08235340e-03]
 [ 6.63118943e-03]
 [ 1.29720573e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.63370987]
curr_Stock_Price:  101.53705056424904
curr_Factors:  [101.53705056]
mat_Sqrt:  [[0.15]]
grads:  [-0.39095764]
Stock Position:  -0.39095764402208644
Bond Position:  [75.33039594]


portfolio before change:  [35.15509587]
curr_Stock_Price:  102.78534662685153
curr_Factors:  [102.78534663]
mat_Sqrt:  [[0.15]]
grads:  [-0.49262726]
Stock Position:  -0.4926272630378439
Bond Position:  [85.78995986]


portfolio before change:  [34.98345882]
curr_Stock_Price:  103.1555280582465
curr_Factors:  [103.15552806]
mat_Sqrt:  [[0.15]]
grads:  [0.1418041]
Stock Position:  0.1418041006033878
Bond Position:  [20.35558194]


portfolio before change:  [35.01710463]
curr_Stock_Price:  103.37485320922829
curr_Factors:  [103.37485321]
mat_Sqrt:  [[0.15]]
grads:  [0.0545351]
Stock Position:  0.05453509916876325
Bond Position:  [29.37954676]


portfolio before change:  [35.01375559]
curr_Stock_Price:  103.24609733111352
curr_Factors:  [103.24609733]
mat_Sqrt:  [[0.15]]
grads:  [0.01404896]
Stock Position:  0.014048963581494111
Bond Position:  [33.56325493]


portfolio before change:  [35.02844204]
curr_Stock_Price:  103.99282712861194
curr_Factors:  [103.99282713]
mat_Sqrt:  [[0.15]]
grads:  [-0.19550571]
Stock Position:  -0.19550570807065376
Bond Position:  [55.35963334]


portfolio before change:  [34.7942144]
curr_Stock_Price:  105.22628484642699
curr_Factors:  [105.22628485]
mat_Sqrt:  [[0.15]]
grads:  [0.02215409]
Stock Position:  0.02215408989726596
Bond Position:  [32.46302183]


portfolio before change:  [34.78393197]
curr_Stock_Price:  104.57897474226333
curr_Factors:  [104.57897474]
mat_Sqrt:  [[0.15]]
grads:  [0.26966485]
Stock Position:  0.26966485490342285
Bond Position:  [6.58265792]


portfolio before change:  [34.90486071]
curr_Stock_Price:  105.02436411658725
curr_Factors:  [105.02436412]
mat_Sqrt:  [[0.15]]
grads:  [0.6396299]
Stock Position:  0.6396299031972685
Bond Position:  [-32.27186314]


portfolio before change:  [34.37828367]
curr_Stock_Price:  104.20741855963726
curr_Factors:  [104.20741856]
mat_Sqrt:  [[0.15]]
grads:  [0.15033862]
Stock Position:  0.15033861771448873
Bond Position:  [18.71188441]


portfolio before change:  [34.28917975]
curr_Stock_Price:  103.59917133270348
curr_Factors:  [103.59917133]
mat_Sqrt:  [[0.15]]
grads:  [0.10858501]
Stock Position:  0.10858501384824018
Bond Position:  [23.0398623]


portfolio before change:  [34.27241024]
curr_Stock_Price:  103.4182101157292
curr_Factors:  [103.41821012]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271006]
Stock Position:  -0.0027100626814298887
Bond Position:  [34.55268007]


portfolio before change:  [34.27953717]
curr_Stock_Price:  102.38222774205802
curr_Factors:  [102.38222774]
mat_Sqrt:  [[0.15]]
grads:  [0.08282093]
Stock Position:  0.08282092608191964
Bond Position:  [25.80014625]


portfolio before change:  [34.41234415]
curr_Stock_Price:  103.94682943452706
curr_Factors:  [103.94682943]
mat_Sqrt:  [[0.15]]
grads:  [0.15560576]
Stock Position:  0.15560575976030844
Bond Position:  [18.23761878]


portfolio before change:  [34.58968824]
curr_Stock_Price:  105.07187932526608
curr_Factors:  [105.07187933]
mat_Sqrt:  [[0.15]]
grads:  [-0.05689947]
Stock Position:  -0.056899471128508176
Bond Position:  [40.5682226]


portfolio before change:  [34.62540013]
curr_Stock_Price:  104.53337622134556
curr_Factors:  [104.53337622]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748859]
Stock Position:  -0.027488592997901795
Bond Position:  [37.49887556]


portfolio before change:  [34.61083179]
curr_Stock_Price:  105.23388444801924
curr_Factors:  [105.23388445]
mat_Sqrt:  [[0.15]]
grads:  [-0.02821718]
Stock Position:  -0.028217175079547643
Bond Position:  [37.58023473]


portfolio before change:  [34.62699095]
curr_Stock_Price:  104.82770142870291
curr_Factors:  [104.82770143]
mat_Sqrt:  [[0.15]]
grads:  [0.05186933]
Stock Position:  0.05186933320807279
Bond Position:  [29.18964798]


portfolio before change:  [34.62620566]
curr_Stock_Price:  104.74221293243149
curr_Factors:  [104.74221293]
mat_Sqrt:  [[0.15]]
grads:  [0.161536]
Stock Position:  0.16153599883693717
Bond Position:  [17.70656767]


portfolio before change:  [34.61565507]
curr_Stock_Price:  104.6631962015153
curr_Factors:  [104.6631962]
mat_Sqrt:  [[0.15]]
grads:  [0.00371125]
Stock Position:  0.0037112535198752473
Bond Position:  [34.22722341]


portfolio before change:  [34.62273287]
curr_Stock_Price:  105.4174228482843
curr_Factors:  [105.41742285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00209823]
Stock Position:  -0.0020982301672279493
Bond Position:  [34.84392288]


portfolio before change:  [34.62931472]
curr_Stock_Price:  104.35648458920267
curr_Factors:  [104.35648459]
mat_Sqrt:  [[0.15]]
grads:  [-0.05846351]
Stock Position:  -0.058463509042087386
Bond Position:  [40.730361]


portfolio before change:  [34.65047611]
curr_Stock_Price:  104.08161605725793
curr_Factors:  [104.08161606]
mat_Sqrt:  [[0.15]]
grads:  [0.03462164]
Stock Position:  0.03462164485296611
Bond Position:  [31.04699937]


portfolio before change:  [34.63019197]
curr_Stock_Price:  103.38363469224339
curr_Factors:  [103.38363469]
mat_Sqrt:  [[0.15]]
grads:  [-0.0753853]
Stock Position:  -0.07538530113865327
Bond Position:  [42.4237984]


portfolio before change:  [34.70331746]
curr_Stock_Price:  102.48396082758894
curr_Factors:  [102.48396083]
mat_Sqrt:  [[0.15]]
grads:  [0.00916483]
Stock Position:  0.009164828157864341
Bond Position:  [33.76406957]


portfolio before change:  [34.70591779]
curr_Stock_Price:  102.307149432159
curr_Factors:  [102.30714943]
mat_Sqrt:  [[0.15]]
grads:  [0.01907429]
Stock Position:  0.019074287096615884
Bond Position:  [32.75448184]


portfolio before change:  [34.74374898]
curr_Stock_Price:  104.0758459180859
curr_Factors:  [104.07584592]
mat_Sqrt:  [[0.15]]
grads:  [0.03368735]
Stock Position:  0.033687345351385733
Bond Position:  [31.23771001]


portfolio before change:  [34.75923419]
curr_Stock_Price:  104.41960279196454
curr_Factors:  [104.41960279]
mat_Sqrt:  [[0.15]]
grads:  [0.01299436]
Stock Position:  0.012994357755581639
Bond Position:  [33.40236851]


portfolio before change:  [34.75138781]
curr_Stock_Price:  103.49443658930531
curr_Factors:  [103.49443659]
mat_Sqrt:  [[0.15]]
grads:  [0.03125147]
Stock Position:  0.03125147201482396
Bond Position:  [31.51703432]


portfolio before change:  [34.7351101]
curr_Stock_Price:  102.84750437042374
curr_Factors:  [102.84750437]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019626]
Stock Position:  -0.04019626177141353
Bond Position:  [38.86919531]


portfolio before change:  [34.76006374]
curr_Stock_Price:  102.34759003468335
curr_Factors:  [102.34759003]
mat_Sqrt:  [[0.15]]
grads:  [-0.12981564]
Stock Position:  -0.12981564235763587
Bond Position:  [48.04638188]


portfolio before change:  [34.95973741]
curr_Stock_Price:  100.85572441734736
curr_Factors:  [100.85572442]
mat_Sqrt:  [[0.15]]
grads:  [0.12753949]
Stock Position:  0.12753948879790605
Bond Position:  [22.09664987]


portfolio before change:  [35.05421711]
curr_Stock_Price:  101.5748542448962
curr_Factors:  [101.57485424]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248686]
Stock Position:  -0.022486863683577094
Bond Position:  [37.33831701]


portfolio before change:  [35.07193446]
curr_Stock_Price:  100.99452589103176
curr_Factors:  [100.99452589]
mat_Sqrt:  [[0.15]]
grads:  [-0.11782201]
Stock Position:  -0.11782200773663257
Bond Position:  [46.97131227]


portfolio before change:  [35.22907147]
curr_Stock_Price:  99.71068059779809
curr_Factors:  [99.7106806]
mat_Sqrt:  [[0.15]]
grads:  [-0.14421259]
Stock Position:  -0.14421259252500981
Bond Position:  [49.60860722]


portfolio before change:  [35.31942568]
curr_Stock_Price:  99.12714802630835
curr_Factors:  [99.12714803]
mat_Sqrt:  [[0.15]]
grads:  [0.23451868]
Stock Position:  0.2345186803481259
Bond Position:  [12.07225773]


portfolio before change:  [35.06129138]
curr_Stock_Price:  98.02001480750673
curr_Factors:  [98.02001481]
mat_Sqrt:  [[0.15]]
grads:  [0.01388236]
Stock Position:  0.013882356022183769
Bond Position:  [33.70054264]


portfolio before change:  [35.05993298]
curr_Stock_Price:  97.61869716850454
curr_Factors:  [97.61869717]
mat_Sqrt:  [[0.15]]
grads:  [0.04420793]
Stock Position:  0.04420792951658617
Bond Position:  [30.74441249]


portfolio before change:  [35.02109691]
curr_Stock_Price:  96.65327403057951
curr_Factors:  [96.65327403]
mat_Sqrt:  [[0.15]]
grads:  [0.08648038]
Stock Position:  0.08648038210207115
Bond Position:  [26.66248484]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.02792271]
Stock Price:  96.69366220846298
PL:  [35.02792271]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.19177935e-02]
 [ 4.36807008e-02]
 [-1.10781121e-03]
 [-5.73788858e-03]
 [-6.31460547e-03]
 [ 3.96089851e-02]
 [ 3.54965896e-03]
 [-1.37355924e-03]
 [-2.66781562e-02]
 [ 2.34061145e-02]
 [ 2.06444295e-02]
 [-1.46266913e-02]
 [ 1.61411154e-02]
 [ 9.10209670e-03]
 [-5.10764404e-03]
 [ 2.20063913e-04]
 [-6.09155667e-03]
 [ 3.24946860e-03]
 [ 4.98879321e-03]
 [-2.85001874e-02]
 [-2.98188744e-03]
 [-1.17924407e-02]
 [ 6.60273506e-03]
 [-6.34598366e-03]
 [ 1.42489543e-02]
 [ 8.06985060e-03]
 [-6.27493202e-03]
 [-1.50533825e-03]
 [ 5.19065918e-04]
 [-8.95297888e-03]
 [-1.14502683e-02]
 [ 1.57448775e-02]
 [-9.28037095e-03]
 [-2.19435609e-02]
 [-2.11389327e-02]
 [ 2.62473155e-02]
 [ 4.07901454e-03]
 [ 9.02524130e-03]
 [ 7.80691274e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.19075072]
curr_Stock_Price:  100.10494792898031
curr_Factors:  [100.10494793]
mat_Sqrt:  [[0.15]]
grads:  [0.14611862]
Stock Position:  0.14611862321293617
Bond Position:  [-10.43644645]


portfolio before change:  [4.20336803]
curr_Stock_Price:  100.20022637172109
curr_Factors:  [100.20022637]
mat_Sqrt:  [[0.15]]
grads:  [0.29120467]
Stock Position:  0.2912046721376822
Bond Position:  [-24.97540604]


portfolio before change:  [4.11883573]
curr_Stock_Price:  99.9206629176183
curr_Factors:  [99.92066292]
mat_Sqrt:  [[0.15]]
grads:  [-0.00738541]
Stock Position:  -0.0073854080864715205
Bond Position:  [4.8567906]


portfolio before change:  [4.11823898]
curr_Stock_Price:  100.083671608112
curr_Factors:  [100.08367161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03825259]
Stock Position:  -0.0382525905060804
Bond Position:  [7.94669869]


portfolio before change:  [4.16777099]
curr_Stock_Price:  98.81477416988994
curr_Factors:  [98.81477417]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209737]
Stock Position:  -0.0420973698329974
Bond Position:  [8.32761309]


portfolio before change:  [4.19135941]
curr_Stock_Price:  98.2791729798484
curr_Factors:  [98.27917298]
mat_Sqrt:  [[0.15]]
grads:  [0.2640599]
Stock Position:  0.26405990074698354
Bond Position:  [-21.76022925]


portfolio before change:  [4.48206417]
curr_Stock_Price:  99.39037903119383
curr_Factors:  [99.39037903]
mat_Sqrt:  [[0.15]]
grads:  [0.02366439]
Stock Position:  0.023664393094561573
Bond Position:  [2.13005117]


portfolio before change:  [4.48522876]
curr_Stock_Price:  99.51285462088403
curr_Factors:  [99.51285462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00915706]
Stock Position:  -0.009157061609254216
Bond Position:  [5.3964741]


portfolio before change:  [4.48028742]
curr_Stock_Price:  100.12614502616621
curr_Factors:  [100.12614503]
mat_Sqrt:  [[0.15]]
grads:  [-0.17785437]
Stock Position:  -0.17785437439545623
Bond Position:  [22.2881603]


portfolio before change:  [4.5783357]
curr_Stock_Price:  99.59052655045454
curr_Factors:  [99.59052655]
mat_Sqrt:  [[0.15]]
grads:  [0.15604076]
Stock Position:  0.15604076332830072
Bond Position:  [-10.96184608]


portfolio before change:  [4.43162171]
curr_Stock_Price:  98.65907972694302
curr_Factors:  [98.65907973]
mat_Sqrt:  [[0.15]]
grads:  [0.13762953]
Stock Position:  0.13762952975966156
Bond Position:  [-9.14678104]


portfolio before change:  [4.50403773]
curr_Stock_Price:  99.19355398666971
curr_Factors:  [99.19355399]
mat_Sqrt:  [[0.15]]
grads:  [-0.09751128]
Stock Position:  -0.09751127533456225
Bond Position:  [14.17652769]


portfolio before change:  [4.47663026]
curr_Stock_Price:  99.49279786667142
curr_Factors:  [99.49279787]
mat_Sqrt:  [[0.15]]
grads:  [0.10760744]
Stock Position:  0.10760743594829744
Bond Position:  [-6.22953461]


portfolio before change:  [4.60051978]
curr_Stock_Price:  100.6513447723975
curr_Factors:  [100.65134477]
mat_Sqrt:  [[0.15]]
grads:  [0.06068064]
Stock Position:  0.06068064464180248
Bond Position:  [-1.5070687]


portfolio before change:  [4.54826631]
curr_Stock_Price:  99.79332692393974
curr_Factors:  [99.79332692]
mat_Sqrt:  [[0.15]]
grads:  [-0.03405096]
Stock Position:  -0.03405096029240322
Bond Position:  [7.94632492]


portfolio before change:  [4.58959012]
curr_Stock_Price:  98.60891220000794
curr_Factors:  [98.6089122]
mat_Sqrt:  [[0.15]]
grads:  [0.00146709]
Stock Position:  0.0014670927508427952
Bond Position:  [4.4449217]


portfolio before change:  [4.59103121]
curr_Stock_Price:  99.21244493253457
curr_Factors:  [99.21244493]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061038]
Stock Position:  -0.04061037781237192
Bond Position:  [8.62008608]


portfolio before change:  [4.62446183]
curr_Stock_Price:  98.4157756544595
curr_Factors:  [98.41577565]
mat_Sqrt:  [[0.15]]
grads:  [0.02166312]
Stock Position:  0.021663124023533643
Bond Position:  [2.49246867]


portfolio before change:  [4.62351074]
curr_Stock_Price:  98.35748910543998
curr_Factors:  [98.35748911]
mat_Sqrt:  [[0.15]]
grads:  [0.03325862]
Stock Position:  0.03325862137371521
Bond Position:  [1.35227625]


portfolio before change:  [4.6314794]
curr_Stock_Price:  98.59200337414848
curr_Factors:  [98.59200337]
mat_Sqrt:  [[0.15]]
grads:  [-0.19000125]
Stock Position:  -0.19000124929229878
Bond Position:  [23.36408321]


portfolio before change:  [4.654174]
curr_Stock_Price:  98.48793089306069
curr_Factors:  [98.48793089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01987925]
Stock Position:  -0.01987924957147454
Bond Position:  [6.61204016]


portfolio before change:  [4.65445491]
curr_Stock_Price:  98.51537902645288
curr_Factors:  [98.51537903]
mat_Sqrt:  [[0.15]]
grads:  [-0.07861627]
Stock Position:  -0.07861627141415194
Bond Position:  [12.39936668]


portfolio before change:  [4.68591235]
curr_Stock_Price:  98.1349562089183
curr_Factors:  [98.13495621]
mat_Sqrt:  [[0.15]]
grads:  [0.04401823]
Stock Position:  0.044018233724554004
Bond Position:  [0.36618491]


portfolio before change:  [4.73615828]
curr_Stock_Price:  99.27539620639612
curr_Factors:  [99.27539621]
mat_Sqrt:  [[0.15]]
grads:  [-0.04230656]
Stock Position:  -0.042306557752580416
Bond Position:  [8.93615856]


portfolio before change:  [4.78082634]
curr_Stock_Price:  98.24598193894738
curr_Factors:  [98.24598194]
mat_Sqrt:  [[0.15]]
grads:  [0.09499303]
Stock Position:  0.09499302859804773
Bond Position:  [-4.55185703]


portfolio before change:  [4.90117693]
curr_Stock_Price:  99.51891332659704
curr_Factors:  [99.51891333]
mat_Sqrt:  [[0.15]]
grads:  [0.053799]
Stock Position:  0.05379900400419529
Bond Position:  [-0.45284149]


portfolio before change:  [4.92026579]
curr_Stock_Price:  99.87478361311807
curr_Factors:  [99.87478361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04183288]
Stock Position:  -0.04183288012665892
Bond Position:  [9.09831564]


portfolio before change:  [4.89232104]
curr_Stock_Price:  100.56998090382992
curr_Factors:  [100.5699809]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003559]
Stock Position:  -0.010035588337555105
Bond Position:  [5.90159997]


portfolio before change:  [4.89523043]
curr_Stock_Price:  100.35358729665363
curr_Factors:  [100.3535873]
mat_Sqrt:  [[0.15]]
grads:  [0.00346044]
Stock Position:  0.0034604394509421084
Bond Position:  [4.54796292]


portfolio before change:  [4.89542111]
curr_Stock_Price:  100.244397308738
curr_Factors:  [100.24439731]
mat_Sqrt:  [[0.15]]
grads:  [-0.05968653]
Stock Position:  -0.0596865258672902
Bond Position:  [10.87866093]


portfolio before change:  [4.934623]
curr_Stock_Price:  99.61038534361518
curr_Factors:  [99.61038534]
mat_Sqrt:  [[0.15]]
grads:  [-0.07633512]
Stock Position:  -0.07633512209429841
Bond Position:  [12.53839393]


portfolio before change:  [4.91590282]
curr_Stock_Price:  99.87615522878812
curr_Factors:  [99.87615523]
mat_Sqrt:  [[0.15]]
grads:  [0.10496585]
Stock Position:  0.1049658501193893
Bond Position:  [-5.56768272]


portfolio before change:  [4.85994166]
curr_Stock_Price:  99.34964909747286
curr_Factors:  [99.3496491]
mat_Sqrt:  [[0.15]]
grads:  [-0.06186914]
Stock Position:  -0.061869139682281554
Bond Position:  [11.00661897]


portfolio before change:  [4.81748652]
curr_Stock_Price:  100.05809683073907
curr_Factors:  [100.05809683]
mat_Sqrt:  [[0.15]]
grads:  [-0.14629041]
Stock Position:  -0.14629040622312184
Bond Position:  [19.45502615]


portfolio before change:  [4.73934215]
curr_Stock_Price:  100.60889439152481
curr_Factors:  [100.60889439]
mat_Sqrt:  [[0.15]]
grads:  [-0.14092622]
Stock Position:  -0.14092621819612056
Bond Position:  [18.91777315]


portfolio before change:  [4.74349753]
curr_Stock_Price:  100.59618907407965
curr_Factors:  [100.59618907]
mat_Sqrt:  [[0.15]]
grads:  [0.1749821]
Stock Position:  0.17498210324378743
Bond Position:  [-12.85903521]


portfolio before change:  [4.72096169]
curr_Stock_Price:  100.47658618762839
curr_Factors:  [100.47658619]
mat_Sqrt:  [[0.15]]
grads:  [0.02719343]
Stock Position:  0.027193430291858417
Bond Position:  [1.98865864]


portfolio before change:  [4.71182542]
curr_Stock_Price:  100.13147107753755
curr_Factors:  [100.13147108]
mat_Sqrt:  [[0.15]]
grads:  [0.06016828]
Stock Position:  0.06016827534683832
Bond Position:  [-1.3129125]


portfolio before change:  [4.77029946]
curr_Stock_Price:  101.10604053261466
curr_Factors:  [101.10604053]
mat_Sqrt:  [[0.15]]
grads:  [0.05204608]
Stock Position:  0.052046084916448715
Bond Position:  [-0.49187411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.80713565]
Stock Price:  101.81498299567154
PL:  [2.99215266]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.28813044e-02]
 [ 4.34012021e-02]
 [-1.73471710e-02]
 [-7.92771793e-03]
 [-4.15768997e-03]
 [ 6.10650510e-02]
 [ 3.54215102e-03]
 [ 3.85426722e-03]
 [ 3.36346626e-02]
 [ 2.34127411e-02]
 [ 2.17358667e-02]
 [-3.32179278e-03]
 [-2.76700446e-02]
 [ 1.67576426e-02]
 [-4.94918451e-03]
 [-1.54075417e-03]
 [-6.04077011e-03]
 [-9.28104928e-03]
 [ 1.76342515e-03]
 [ 8.15725869e-03]
 [-1.62935870e-02]
 [-2.15812868e-02]
 [ 4.52085613e-03]
 [-1.16155912e-02]
 [ 1.16789961e-02]
 [ 4.46556453e-03]
 [ 6.67164902e-05]
 [-2.31619795e-03]
 [-2.44161327e-04]
 [-1.30791350e-02]
 [ 5.25650088e-03]
 [ 7.35785423e-03]
 [-1.32377071e-02]
 [-4.86989945e-02]
 [-2.26188248e-02]
 [ 3.91450179e-02]
 [-3.18205350e-03]
 [ 1.52967774e-05]
 [ 2.60842666e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.47800569]
curr_Stock_Price:  100.93786018504201
curr_Factors:  [100.93786019]
mat_Sqrt:  [[0.15]]
grads:  [-0.28587536]
Stock Position:  -0.2858753625435724
Bond Position:  [51.33365307]


portfolio before change:  [22.71242241]
curr_Stock_Price:  100.14031118502386
curr_Factors:  [100.14031119]
mat_Sqrt:  [[0.15]]
grads:  [0.28934135]
Stock Position:  0.28934134760939445
Bond Position:  [-6.26231018]


portfolio before change:  [22.29981435]
curr_Stock_Price:  98.71699153389753
curr_Factors:  [98.71699153]
mat_Sqrt:  [[0.15]]
grads:  [-0.11564781]
Stock Position:  -0.11564780667932185
Bond Position:  [33.7162179]


portfolio before change:  [22.38908627]
curr_Stock_Price:  97.98150733538519
curr_Factors:  [97.98150734]
mat_Sqrt:  [[0.15]]
grads:  [-0.05285145]
Stock Position:  -0.052851452852027275
Bond Position:  [27.56755129]


portfolio before change:  [22.4441492]
curr_Stock_Price:  97.00486877959014
curr_Factors:  [97.00486878]
mat_Sqrt:  [[0.15]]
grads:  [-0.02771793]
Stock Position:  -0.02771793312476995
Bond Position:  [25.13292366]


portfolio before change:  [22.47414504]
curr_Stock_Price:  96.03603638700318
curr_Factors:  [96.03603639]
mat_Sqrt:  [[0.15]]
grads:  [0.40710034]
Stock Position:  0.4071003399415043
Bond Position:  [-16.62215802]


portfolio before change:  [22.87292666]
curr_Stock_Price:  97.02070645386935
curr_Factors:  [97.02070645]
mat_Sqrt:  [[0.15]]
grads:  [0.02361434]
Stock Position:  0.02361434015121882
Bond Position:  [20.5818467]


portfolio before change:  [22.86678247]
curr_Stock_Price:  96.65156295505753
curr_Factors:  [96.65156296]
mat_Sqrt:  [[0.15]]
grads:  [0.02569511]
Stock Position:  0.025695114791513866
Bond Position:  [20.38330947]


portfolio before change:  [22.87074689]
curr_Stock_Price:  96.70668403722308
curr_Factors:  [96.70668404]
mat_Sqrt:  [[0.15]]
grads:  [0.22423108]
Stock Position:  0.22423108383759077
Bond Position:  [1.18610231]


portfolio before change:  [22.80557465]
curr_Stock_Price:  96.41537515827582
curr_Factors:  [96.41537516]
mat_Sqrt:  [[0.15]]
grads:  [0.15608494]
Stock Position:  0.15608494034603912
Bond Position:  [7.75658657]


portfolio before change:  [22.79483028]
curr_Stock_Price:  96.34032621826157
curr_Factors:  [96.34032622]
mat_Sqrt:  [[0.15]]
grads:  [0.14490578]
Stock Position:  0.14490577822492076
Bond Position:  [8.83456033]


portfolio before change:  [22.66150754]
curr_Stock_Price:  95.41263975465849
curr_Factors:  [95.41263975]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214529]
Stock Position:  -0.022145285178673185
Bond Position:  [24.77444766]


portfolio before change:  [22.66858327]
curr_Stock_Price:  95.23297466860392
curr_Factors:  [95.23297467]
mat_Sqrt:  [[0.15]]
grads:  [-0.18446696]
Stock Position:  -0.18446696415520017
Bond Position:  [40.235921]


portfolio before change:  [22.74128129]
curr_Stock_Price:  94.86614362227839
curr_Factors:  [94.86614362]
mat_Sqrt:  [[0.15]]
grads:  [0.11171762]
Stock Position:  0.11171761703588876
Bond Position:  [12.14306178]


portfolio before change:  [22.79312692]
curr_Stock_Price:  95.31663349111112
curr_Factors:  [95.31663349]
mat_Sqrt:  [[0.15]]
grads:  [-0.03299456]
Stock Position:  -0.03299456340652739
Bond Position:  [25.93805763]


portfolio before change:  [22.80559394]
curr_Stock_Price:  95.03705526690207
curr_Factors:  [95.03705527]
mat_Sqrt:  [[0.15]]
grads:  [-0.01027169]
Stock Position:  -0.010271694467930045
Bond Position:  [23.78178553]


portfolio before change:  [22.81273225]
curr_Stock_Price:  94.6315333597357
curr_Factors:  [94.63153336]
mat_Sqrt:  [[0.15]]
grads:  [-0.0402718]
Stock Position:  -0.04027180070365777
Bond Position:  [26.6237145]


portfolio before change:  [22.82310264]
curr_Stock_Price:  94.4566659267645
curr_Factors:  [94.45666593]
mat_Sqrt:  [[0.15]]
grads:  [-0.06187366]
Stock Position:  -0.06187366184655757
Bond Position:  [28.66748245]


portfolio before change:  [22.83819254]
curr_Stock_Price:  94.27070246896417
curr_Factors:  [94.27070247]
mat_Sqrt:  [[0.15]]
grads:  [0.01175617]
Stock Position:  0.011756167678449263
Bond Position:  [21.72993036]


portfolio before change:  [22.84858929]
curr_Stock_Price:  94.92400480197182
curr_Factors:  [94.9240048]
mat_Sqrt:  [[0.15]]
grads:  [0.05438172]
Stock Position:  0.054381724575567454
Bond Position:  [17.6864582]


portfolio before change:  [22.86061567]
curr_Stock_Price:  95.10449627274114
curr_Factors:  [95.10449627]
mat_Sqrt:  [[0.15]]
grads:  [-0.10862391]
Stock Position:  -0.10862391345408433
Bond Position:  [33.19123824]


portfolio before change:  [22.79831125]
curr_Stock_Price:  95.71627302757743
curr_Factors:  [95.71627303]
mat_Sqrt:  [[0.15]]
grads:  [-0.14387525]
Stock Position:  -0.1438752452948595
Bond Position:  [36.56951351]


portfolio before change:  [22.87785766]
curr_Stock_Price:  95.19516228969755
curr_Factors:  [95.19516229]
mat_Sqrt:  [[0.15]]
grads:  [0.03013904]
Stock Position:  0.030139040870175642
Bond Position:  [20.00876677]


portfolio before change:  [22.87026961]
curr_Stock_Price:  94.86040370125124
curr_Factors:  [94.8604037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07743727]
Stock Position:  -0.07743727499020794
Bond Position:  [30.21600078]


portfolio before change:  [22.80063611]
curr_Stock_Price:  95.80840626468053
curr_Factors:  [95.80840626]
mat_Sqrt:  [[0.15]]
grads:  [0.07785997]
Stock Position:  0.07785997429552281
Bond Position:  [15.34099606]


portfolio before change:  [22.92831112]
curr_Stock_Price:  97.42357847628803
curr_Factors:  [97.42357848]
mat_Sqrt:  [[0.15]]
grads:  [0.02977043]
Stock Position:  0.029770430199882632
Bond Position:  [20.02796928]


portfolio before change:  [22.95894693]
curr_Stock_Price:  98.36854821077897
curr_Factors:  [98.36854821]
mat_Sqrt:  [[0.15]]
grads:  [0.00044478]
Stock Position:  0.000444776601029809
Bond Position:  [22.9151949]


portfolio before change:  [22.96223703]
curr_Stock_Price:  99.32527079967701
curr_Factors:  [99.3252708]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544132]
Stock Position:  -0.015441319668907286
Bond Position:  [24.49595029]


portfolio before change:  [22.96320179]
curr_Stock_Price:  99.46110308823103
curr_Factors:  [99.46110309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162774]
Stock Position:  -0.001627742179893559
Bond Position:  [23.12509882]


portfolio before change:  [22.96637651]
curr_Stock_Price:  99.28668819119088
curr_Factors:  [99.28668819]
mat_Sqrt:  [[0.15]]
grads:  [-0.08719423]
Stock Position:  -0.08719423357518963
Bond Position:  [31.62360319]


portfolio before change:  [23.02411705]
curr_Stock_Price:  98.66982009186194
curr_Factors:  [98.66982009]
mat_Sqrt:  [[0.15]]
grads:  [0.03504334]
Stock Position:  0.03504333916731609
Bond Position:  [19.56639708]


portfolio before change:  [22.97994693]
curr_Stock_Price:  97.33957945641247
curr_Factors:  [97.33957946]
mat_Sqrt:  [[0.15]]
grads:  [0.04905236]
Stock Position:  0.049052361516583945
Bond Position:  [18.20521069]


portfolio before change:  [22.98252225]
curr_Stock_Price:  97.34568574529817
curr_Factors:  [97.34568575]
mat_Sqrt:  [[0.15]]
grads:  [-0.08825138]
Stock Position:  -0.08825138078332855
Bond Position:  [31.57341343]


portfolio before change:  [22.95560128]
curr_Stock_Price:  97.69545808805724
curr_Factors:  [97.69545809]
mat_Sqrt:  [[0.15]]
grads:  [-0.32465996]
Stock Position:  -0.32465996321737395
Bond Position:  [54.67340511]


portfolio before change:  [23.0313756]
curr_Stock_Price:  97.48311372029582
curr_Factors:  [97.48311372]
mat_Sqrt:  [[0.15]]
grads:  [-0.15079217]
Stock Position:  -0.15079216519217548
Bond Position:  [37.73106539]


portfolio before change:  [23.16905588]
curr_Stock_Price:  96.60134636677543
curr_Factors:  [96.60134637]
mat_Sqrt:  [[0.15]]
grads:  [0.26096679]
Stock Position:  0.26096678596400547
Bond Position:  [-2.040687]


portfolio before change:  [22.98077922]
curr_Stock_Price:  95.88086554739293
curr_Factors:  [95.88086555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02121369]
Stock Position:  -0.021213689998478072
Bond Position:  [25.01476618]


portfolio before change:  [22.98394426]
curr_Stock_Price:  95.87907410525783
curr_Factors:  [95.87907411]
mat_Sqrt:  [[0.15]]
grads:  [0.00010198]
Stock Position:  0.00010197851610437825
Bond Position:  [22.97416666]


portfolio before change:  [22.98669058]
curr_Stock_Price:  94.64711825942607
curr_Factors:  [94.64711826]
mat_Sqrt:  [[0.15]]
grads:  [0.17389511]
Stock Position:  0.1738951108392813
Bond Position:  [6.52801946]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.09260988]
Stock Price:  95.25152423574934
PL:  [23.09260988]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.11528293e-03]
 [ 4.47364379e-04]
 [-1.42784907e-02]
 [-8.80702194e-03]
 [-4.21470817e-03]
 [ 5.37548891e-02]
 [ 3.45069132e-03]
 [ 3.92354972e-03]
 [ 3.23729279e-02]
 [ 2.34451383e-02]
 [ 2.13583318e-02]
 [-5.02660688e-03]
 [-1.49059779e-02]
 [ 1.47890288e-02]
 [-1.80608537e-02]
 [-9.25168855e-04]
 [-6.06974944e-03]
 [-4.86731459e-03]
 [ 1.69521502e-03]
 [-1.61266510e-03]
 [-1.32822557e-02]
 [-2.14014511e-02]
 [ 4.54758245e-03]
 [-1.09170894e-02]
 [ 1.24962556e-02]
 [ 4.12158890e-03]
 [ 5.58488671e-03]
 [-2.89931930e-03]
 [ 1.34136848e-04]
 [-1.35946682e-02]
 [-1.05513287e-02]
 [ 1.90308203e-02]
 [-8.05339861e-03]
 [-2.93908696e-02]
 [-2.17747603e-02]
 [ 3.45011160e-02]
 [ 3.55491850e-03]
 [ 8.07937694e-03]
 [ 6.51639997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.89268026]
curr_Stock_Price:  99.14468089713205
curr_Factors:  [99.1446809]
mat_Sqrt:  [[0.15]]
grads:  [0.00743522]
Stock Position:  0.007435219541124782
Bond Position:  [-17.62984273]


portfolio before change:  [-16.90235375]
curr_Stock_Price:  98.14005364426959
curr_Factors:  [98.14005364]
mat_Sqrt:  [[0.15]]
grads:  [0.00298243]
Stock Position:  0.0029824291930399816
Bond Position:  [-17.19504951]


portfolio before change:  [-16.90594532]
curr_Stock_Price:  97.65653763020224
curr_Factors:  [97.65653763]
mat_Sqrt:  [[0.15]]
grads:  [-0.09518994]
Stock Position:  -0.09518993831300103
Bond Position:  [-7.61002552]


portfolio before change:  [-16.87265799]
curr_Stock_Price:  97.29685003335747
curr_Factors:  [97.29685003]
mat_Sqrt:  [[0.15]]
grads:  [-0.05871348]
Stock Position:  -0.05871347963236531
Bond Position:  [-11.16002137]


portfolio before change:  [-16.85894282]
curr_Stock_Price:  97.03949406894858
curr_Factors:  [97.03949407]
mat_Sqrt:  [[0.15]]
grads:  [-0.02809805]
Stock Position:  -0.028098054445930307
Bond Position:  [-14.13232183]


portfolio before change:  [-16.85547182]
curr_Stock_Price:  96.85308794461295
curr_Factors:  [96.85308794]
mat_Sqrt:  [[0.15]]
grads:  [0.35836593]
Stock Position:  0.35836592733718897
Bond Position:  [-51.56431849]


portfolio before change:  [-17.05307911]
curr_Stock_Price:  96.31966293449236
curr_Factors:  [96.31966293]
mat_Sqrt:  [[0.15]]
grads:  [0.02300461]
Stock Position:  0.02300460879078536
Bond Position:  [-19.26887527]


portfolio before change:  [-17.04831079]
curr_Stock_Price:  96.63164707282901
curr_Factors:  [96.63164707]
mat_Sqrt:  [[0.15]]
grads:  [0.026157]
Stock Position:  0.026156998150539176
Bond Position:  [-19.57590461]


portfolio before change:  [-17.04783756]
curr_Stock_Price:  96.74329513453567
curr_Factors:  [96.74329513]
mat_Sqrt:  [[0.15]]
grads:  [0.21581952]
Stock Position:  0.21581951962067203
Bond Position:  [-37.92692904]


portfolio before change:  [-16.95282116]
curr_Stock_Price:  97.20552190099853
curr_Factors:  [97.2055219]
mat_Sqrt:  [[0.15]]
grads:  [0.15630092]
Stock Position:  0.15630092218361505
Bond Position:  [-32.14613388]


portfolio before change:  [-16.9376135]
curr_Stock_Price:  97.32852936685774
curr_Factors:  [97.32852937]
mat_Sqrt:  [[0.15]]
grads:  [0.14238888]
Stock Position:  0.14238887838467865
Bond Position:  [-30.79611363]


portfolio before change:  [-17.09957203]
curr_Stock_Price:  96.21812817876643
curr_Factors:  [96.21812818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351071]
Stock Position:  -0.03351071250573475
Bond Position:  [-13.875234]


portfolio before change:  [-17.12564923]
curr_Stock_Price:  96.94454311764474
curr_Factors:  [96.94454312]
mat_Sqrt:  [[0.15]]
grads:  [-0.09937319]
Stock Position:  -0.09937318608423854
Bond Position:  [-7.49196111]


portfolio before change:  [-17.13101438]
curr_Stock_Price:  96.98910839561441
curr_Factors:  [96.9891084]
mat_Sqrt:  [[0.15]]
grads:  [0.09859353]
Stock Position:  0.09859352544815732
Bond Position:  [-26.6935125]


portfolio before change:  [-17.13024318]
curr_Stock_Price:  97.03077541261764
curr_Factors:  [97.03077541]
mat_Sqrt:  [[0.15]]
grads:  [-0.12040569]
Stock Position:  -0.12040569126544358
Bond Position:  [-5.44718559]


portfolio before change:  [-16.95881038]
curr_Stock_Price:  95.60132691052495
curr_Factors:  [95.60132691]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616779]
Stock Position:  -0.006167792364589834
Bond Position:  [-16.36916125]


portfolio before change:  [-16.96011679]
curr_Stock_Price:  95.48137052127385
curr_Factors:  [95.48137052]
mat_Sqrt:  [[0.15]]
grads:  [-0.040465]
Stock Position:  -0.04046499627973019
Bond Position:  [-13.09646348]


portfolio before change:  [-16.9659697]
curr_Stock_Price:  95.58555320103133
curr_Factors:  [95.5855532]
mat_Sqrt:  [[0.15]]
grads:  [-0.03244876]
Stock Position:  -0.032448763916180026
Bond Position:  [-13.86433665]


portfolio before change:  [-16.95567371]
curr_Stock_Price:  95.21484137598917
curr_Factors:  [95.21484138]
mat_Sqrt:  [[0.15]]
grads:  [0.01130143]
Stock Position:  0.011301433459770718
Bond Position:  [-18.0317379]


portfolio before change:  [-16.9525703]
curr_Stock_Price:  95.688898127473
curr_Factors:  [95.68889813]
mat_Sqrt:  [[0.15]]
grads:  [-0.0107511]
Stock Position:  -0.010751100664087484
Bond Position:  [-15.92380932]


portfolio before change:  [-16.95572836]
curr_Stock_Price:  95.79748811081096
curr_Factors:  [95.79748811]
mat_Sqrt:  [[0.15]]
grads:  [-0.08854837]
Stock Position:  -0.08854837161023192
Bond Position:  [-8.47301678]


portfolio before change:  [-16.95725461]
curr_Stock_Price:  95.80276274287712
curr_Factors:  [95.80276274]
mat_Sqrt:  [[0.15]]
grads:  [-0.14267634]
Stock Position:  -0.14267634051672154
Bond Position:  [-3.28846701]


portfolio before change:  [-16.87886217]
curr_Stock_Price:  95.25043899470805
curr_Factors:  [95.25043899]
mat_Sqrt:  [[0.15]]
grads:  [0.03031722]
Stock Position:  0.030317216306221795
Bond Position:  [-19.76659033]


portfolio before change:  [-16.87147184]
curr_Stock_Price:  95.5757097574763
curr_Factors:  [95.57570976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0727806]
Stock Position:  -0.07278059613658765
Bond Position:  [-9.91541471]


portfolio before change:  [-16.95647041]
curr_Stock_Price:  96.72655306757397
curr_Factors:  [96.72655307]
mat_Sqrt:  [[0.15]]
grads:  [0.08330837]
Stock Position:  0.08330837063297956
Bond Position:  [-25.01460194]


portfolio before change:  [-16.91360069]
curr_Stock_Price:  97.27867935193238
curr_Factors:  [97.27867935]
mat_Sqrt:  [[0.15]]
grads:  [0.02747726]
Stock Position:  0.027477259308438716
Bond Position:  [-19.58655218]


portfolio before change:  [-16.90055195]
curr_Stock_Price:  97.84268060151037
curr_Factors:  [97.8426806]
mat_Sqrt:  [[0.15]]
grads:  [0.03723258]
Stock Position:  0.037232578089255154
Bond Position:  [-20.5434872]


portfolio before change:  [-16.87402202]
curr_Stock_Price:  98.62420109319707
curr_Factors:  [98.62420109]
mat_Sqrt:  [[0.15]]
grads:  [-0.0193288]
Stock Position:  -0.019328795362335473
Bond Position:  [-14.96773502]


portfolio before change:  [-16.89700089]
curr_Stock_Price:  99.71623904859266
curr_Factors:  [99.71623905]
mat_Sqrt:  [[0.15]]
grads:  [0.00089425]
Stock Position:  0.0008942456549764082
Bond Position:  [-16.9861717]


portfolio before change:  [-16.89959319]
curr_Stock_Price:  99.19188707950454
curr_Factors:  [99.19188708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09063112]
Stock Position:  -0.09063112102901363
Bond Position:  [-7.90972127]


portfolio before change:  [-16.93363137]
curr_Stock_Price:  99.55654548085838
curr_Factors:  [99.55654548]
mat_Sqrt:  [[0.15]]
grads:  [-0.07034219]
Stock Position:  -0.07034219159728931
Bond Position:  [-9.93060577]


portfolio before change:  [-17.0179883]
curr_Stock_Price:  100.7381340407368
curr_Factors:  [100.73813404]
mat_Sqrt:  [[0.15]]
grads:  [0.12687214]
Stock Position:  0.12687213511468307
Bond Position:  [-29.79885045]


portfolio before change:  [-17.13073151]
curr_Stock_Price:  99.8788584845636
curr_Factors:  [99.87885848]
mat_Sqrt:  [[0.15]]
grads:  [-0.05368932]
Stock Position:  -0.0536893240765836
Bond Position:  [-11.76830311]


portfolio before change:  [-17.1212465]
curr_Stock_Price:  99.67479286692185
curr_Factors:  [99.67479287]
mat_Sqrt:  [[0.15]]
grads:  [-0.19593913]
Stock Position:  -0.19593913040183678
Bond Position:  [2.40894574]


portfolio before change:  [-17.05336796]
curr_Stock_Price:  99.32990310478192
curr_Factors:  [99.3299031]
mat_Sqrt:  [[0.15]]
grads:  [-0.14516507]
Stock Position:  -0.14516506862555284
Bond Position:  [-2.63413576]


portfolio before change:  [-17.03796083]
curr_Stock_Price:  99.2214995235289
curr_Factors:  [99.22149952]
mat_Sqrt:  [[0.15]]
grads:  [0.23000744]
Stock Position:  0.23000743993422873
Bond Position:  [-39.85964392]


portfolio before change:  [-16.85962613]
curr_Stock_Price:  100.018506210897
curr_Factors:  [100.01850621]
mat_Sqrt:  [[0.15]]
grads:  [0.02369946]
Stock Position:  0.023699456685764404
Bond Position:  [-19.23001039]


portfolio before change:  [-16.88121706]
curr_Stock_Price:  99.20890835303447
curr_Factors:  [99.20890835]
mat_Sqrt:  [[0.15]]
grads:  [0.05386251]
Stock Position:  0.053862512900891626
Bond Position:  [-22.22485817]


portfolio before change:  [-16.83020757]
curr_Stock_Price:  100.20752074901316
curr_Factors:  [100.20752075]
mat_Sqrt:  [[0.15]]
grads:  [0.04344267]
Stock Position:  0.04344266644820672
Bond Position:  [-21.18348947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.89347299]
Stock Price:  98.81218010244605
PL:  [-16.89347299]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.26160414e-02]
 [ 4.25780344e-02]
 [-2.56419124e-03]
 [-2.22064746e-03]
 [-3.11205149e-03]
 [ 3.07662672e-02]
 [ 3.72482611e-03]
 [ 5.05415292e-03]
 [-2.77241559e-02]
 [ 2.33754810e-02]
 [ 1.95461986e-02]
 [-1.20317836e-02]
 [ 1.14731681e-02]
 [ 2.15395731e-02]
 [-2.60887797e-03]
 [-2.08034681e-03]
 [-6.15370680e-03]
 [ 3.29801346e-03]
 [ 5.67867084e-03]
 [-1.99279671e-02]
 [-2.86912724e-03]
 [-1.20143840e-02]
 [ 7.11464703e-03]
 [-6.50084343e-03]
 [ 1.37189369e-02]
 [ 6.60982554e-03]
 [ 1.70247691e-02]
 [-4.00775064e-03]
 [-1.33241402e-02]
 [-1.49227950e-02]
 [ 2.71037504e-02]
 [ 1.17994407e-02]
 [-1.22603151e-02]
 [-4.66579549e-02]
 [-2.25588477e-02]
 [ 3.89657039e-02]
 [ 1.84652153e-03]
 [ 5.84463356e-03]
 [ 8.03124293e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.34078523]
curr_Stock_Price:  100.06623535722305
curr_Factors:  [100.06623536]
mat_Sqrt:  [[0.15]]
grads:  [0.15077361]
Stock Position:  0.15077360956722974
Bond Position:  [-11.74656227]


portfolio before change:  [3.34305544]
curr_Stock_Price:  100.09103164263637
curr_Factors:  [100.09103164]
mat_Sqrt:  [[0.15]]
grads:  [0.28385356]
Stock Position:  0.28385356261698497
Bond Position:  [-25.06814047]


portfolio before change:  [3.37869581]
curr_Stock_Price:  100.22763053318508
curr_Factors:  [100.22763053]
mat_Sqrt:  [[0.15]]
grads:  [-0.01709461]
Stock Position:  -0.017094608244536114
Bond Position:  [5.09204789]


portfolio before change:  [3.36707837]
curr_Stock_Price:  100.94446394867535
curr_Factors:  [100.94446395]
mat_Sqrt:  [[0.15]]
grads:  [-0.01480432]
Stock Position:  -0.014804316406998736
Bond Position:  [4.86149215]


portfolio before change:  [3.36465411]
curr_Stock_Price:  101.14926837613994
curr_Factors:  [101.14926838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074701]
Stock Position:  -0.020747009913715288
Bond Position:  [5.46319898]


portfolio before change:  [3.36417872]
curr_Stock_Price:  101.2050995233504
curr_Factors:  [101.20509952]
mat_Sqrt:  [[0.15]]
grads:  [0.20510845]
Stock Position:  0.20510844832278174
Bond Position:  [-17.39384221]


portfolio before change:  [3.24439374]
curr_Stock_Price:  100.63169256795702
curr_Factors:  [100.63169257]
mat_Sqrt:  [[0.15]]
grads:  [0.02483217]
Stock Position:  0.024832174041166256
Bond Position:  [0.74549004]


portfolio before change:  [3.24473854]
curr_Stock_Price:  100.64182497805392
curr_Factors:  [100.64182498]
mat_Sqrt:  [[0.15]]
grads:  [0.03369435]
Stock Position:  0.03369435278079417
Bond Position:  [-0.14632261]


portfolio before change:  [3.19996662]
curr_Stock_Price:  99.31360132211759
curr_Factors:  [99.31360132]
mat_Sqrt:  [[0.15]]
grads:  [-0.18482771]
Stock Position:  -0.1848277059816173
Bond Position:  [21.55587172]


portfolio before change:  [3.01091417]
curr_Stock_Price:  100.35103829890865
curr_Factors:  [100.3510383]
mat_Sqrt:  [[0.15]]
grads:  [0.15583654]
Stock Position:  0.15583653986801546
Bond Position:  [-12.62744441]


portfolio before change:  [3.05781382]
curr_Stock_Price:  100.66212178133728
curr_Factors:  [100.66212178]
mat_Sqrt:  [[0.15]]
grads:  [0.13030799]
Stock Position:  0.13030799075186683
Bond Position:  [-10.05926502]


portfolio before change:  [3.15534936]
curr_Stock_Price:  101.42027198207634
curr_Factors:  [101.42027198]
mat_Sqrt:  [[0.15]]
grads:  [-0.08021189]
Stock Position:  -0.08021189053416557
Bond Position:  [11.29046111]


portfolio before change:  [3.06879066]
curr_Stock_Price:  102.51699333135704
curr_Factors:  [102.51699333]
mat_Sqrt:  [[0.15]]
grads:  [0.07648779]
Stock Position:  0.076487787643644
Bond Position:  [-4.77250735]


portfolio before change:  [3.01741828]
curr_Stock_Price:  101.85315159438358
curr_Factors:  [101.85315159]
mat_Sqrt:  [[0.15]]
grads:  [0.14359715]
Stock Position:  0.1435971541496065
Bond Position:  [-11.60840443]


portfolio before change:  [2.91940811]
curr_Stock_Price:  101.18072167482761
curr_Factors:  [101.18072167]
mat_Sqrt:  [[0.15]]
grads:  [-0.01739252]
Stock Position:  -0.017392519788801918
Bond Position:  [4.67919582]


portfolio before change:  [2.94813971]
curr_Stock_Price:  99.562401838854
curr_Factors:  [99.56240184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01386898]
Stock Position:  -0.013868978708442115
Bond Position:  [4.32896854]


portfolio before change:  [2.94361599]
curr_Stock_Price:  99.92759637523953
curr_Factors:  [99.92759638]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102471]
Stock Position:  -0.041024712006443996
Bond Position:  [7.04311685]


portfolio before change:  [2.9946596]
curr_Stock_Price:  98.70484141320468
curr_Factors:  [98.70484141]
mat_Sqrt:  [[0.15]]
grads:  [0.02198676]
Stock Position:  0.021986756385807323
Bond Position:  [0.8244603]


portfolio before change:  [3.00795186]
curr_Stock_Price:  99.30471156410832
curr_Factors:  [99.30471156]
mat_Sqrt:  [[0.15]]
grads:  [0.03785781]
Stock Position:  0.03785780560152149
Bond Position:  [-0.7515066]


portfolio before change:  [3.00848206]
curr_Stock_Price:  99.32119790825148
curr_Factors:  [99.32119791]
mat_Sqrt:  [[0.15]]
grads:  [-0.13285311]
Stock Position:  -0.1328531139548577
Bond Position:  [16.20361248]


portfolio before change:  [3.0927058]
curr_Stock_Price:  98.70248325183076
curr_Factors:  [98.70248325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01912751]
Stock Position:  -0.01912751493554405
Bond Position:  [4.98063903]


portfolio before change:  [3.09778764]
curr_Stock_Price:  98.46935230274792
curr_Factors:  [98.4693523]
mat_Sqrt:  [[0.15]]
grads:  [-0.08009589]
Stock Position:  -0.08009589357831619
Bond Position:  [10.9847784]


portfolio before change:  [3.01278617]
curr_Stock_Price:  99.54774284729594
curr_Factors:  [99.54774285]
mat_Sqrt:  [[0.15]]
grads:  [0.04743098]
Stock Position:  0.04743098020740147
Bond Position:  [-1.70886085]


portfolio before change:  [2.97104807]
curr_Stock_Price:  98.67227129387153
curr_Factors:  [98.67227129]
mat_Sqrt:  [[0.15]]
grads:  [-0.04333896]
Stock Position:  -0.04333895616736997
Bond Position:  [7.24740131]


portfolio before change:  [3.00531544]
curr_Stock_Price:  97.90249307972938
curr_Factors:  [97.90249308]
mat_Sqrt:  [[0.15]]
grads:  [0.09145958]
Stock Position:  0.09145957950793811
Bond Position:  [-5.94880541]


portfolio before change:  [3.04332825]
curr_Stock_Price:  98.32624813289608
curr_Factors:  [98.32624813]
mat_Sqrt:  [[0.15]]
grads:  [0.0440655]
Stock Position:  0.044065503602075166
Bond Position:  [-1.28946739]


portfolio before change:  [2.97349626]
curr_Stock_Price:  96.74517467024499
curr_Factors:  [96.74517467]
mat_Sqrt:  [[0.15]]
grads:  [0.11349846]
Stock Position:  0.11349846041005085
Bond Position:  [-8.00693212]


portfolio before change:  [2.9644093]
curr_Stock_Price:  96.67393116523712
curr_Factors:  [96.67393117]
mat_Sqrt:  [[0.15]]
grads:  [-0.02671834]
Stock Position:  -0.026718337594600183
Bond Position:  [5.54737603]


portfolio before change:  [2.9376041]
curr_Stock_Price:  97.70313696814507
curr_Factors:  [97.70313697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0888276]
Stock Position:  -0.08882760118676494
Bond Position:  [11.61633938]


portfolio before change:  [2.89412462]
curr_Stock_Price:  98.20896639919896
curr_Factors:  [98.2089664]
mat_Sqrt:  [[0.15]]
grads:  [-0.0994853]
Stock Position:  -0.099485299920349
Bond Position:  [12.66447309]


portfolio before change:  [2.95186833]
curr_Stock_Price:  97.64445534456381
curr_Factors:  [97.64445534]
mat_Sqrt:  [[0.15]]
grads:  [0.18069167]
Stock Position:  0.1806916690949763
Bond Position:  [-14.69167129]


portfolio before change:  [3.09993865]
curr_Stock_Price:  98.47408351422249
curr_Factors:  [98.47408351]
mat_Sqrt:  [[0.15]]
grads:  [0.07866294]
Stock Position:  0.07866293822055165
Bond Position:  [-4.6463221]


portfolio before change:  [3.03836529]
curr_Stock_Price:  97.69871796823485
curr_Factors:  [97.69871797]
mat_Sqrt:  [[0.15]]
grads:  [-0.08173543]
Stock Position:  -0.08173543378633345
Bond Position:  [11.02381239]


portfolio before change:  [3.01301484]
curr_Stock_Price:  98.02573054244395
curr_Factors:  [98.02573054]
mat_Sqrt:  [[0.15]]
grads:  [-0.31105303]
Stock Position:  -0.31105303286470776
Bond Position:  [33.50421562]


portfolio before change:  [3.13153512]
curr_Stock_Price:  97.65816623416359
curr_Factors:  [97.65816623]
mat_Sqrt:  [[0.15]]
grads:  [-0.15039232]
Stock Position:  -0.15039231803088432
Bond Position:  [17.81857312]


portfolio before change:  [3.16759747]
curr_Stock_Price:  97.4331887569894
curr_Factors:  [97.43318876]
mat_Sqrt:  [[0.15]]
grads:  [0.25977136]
Stock Position:  0.2597713591093291
Bond Position:  [-22.1427544]


portfolio before change:  [3.29343022]
curr_Stock_Price:  97.92824243255635
curr_Factors:  [97.92824243]
mat_Sqrt:  [[0.15]]
grads:  [0.01231014]
Stock Position:  0.012310143511509318
Bond Position:  [2.0879195]


portfolio before change:  [3.28742676]
curr_Stock_Price:  97.41935594141624
curr_Factors:  [97.41935594]
mat_Sqrt:  [[0.15]]
grads:  [0.03896422]
Stock Position:  0.03896422370479444
Bond Position:  [-0.50844282]


portfolio before change:  [3.28855769]
curr_Stock_Price:  97.45001202979253
curr_Factors:  [97.45001203]
mat_Sqrt:  [[0.15]]
grads:  [0.05354162]
Stock Position:  0.053541619505471434
Bond Position:  [-1.92907378]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.24113837]
Stock Price:  96.56886255862744
PL:  [3.24113837]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.16756159e-02]
 [ 4.16161439e-02]
 [-2.57496103e-03]
 [-6.97846602e-03]
 [-7.44240808e-03]
 [ 2.88944565e-02]
 [ 3.67253161e-03]
 [ 1.20250552e-02]
 [-1.90542355e-02]
 [ 2.31251314e-02]
 [ 1.92128241e-02]
 [-1.52286245e-02]
 [ 3.67556386e-03]
 [ 7.18921048e-03]
 [-1.05267702e-02]
 [-1.41847797e-03]
 [-6.15358142e-03]
 [ 5.93046699e-03]
 [ 6.90174032e-03]
 [-1.01366133e-02]
 [-4.77584870e-03]
 [-4.52127126e-03]
 [ 7.07514351e-03]
 [-1.09600742e-02]
 [ 9.59162486e-03]
 [ 6.40509246e-03]
 [-2.49148372e-03]
 [-7.93279960e-04]
 [ 1.86224206e-03]
 [-8.33385179e-03]
 [-2.09696574e-02]
 [ 1.49946981e-02]
 [-8.12605729e-03]
 [-3.51856904e-02]
 [-2.22061350e-02]
 [ 3.46209946e-02]
 [ 3.14028605e-03]
 [ 9.83519856e-03]
 [ 5.05233920e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.72210154]
curr_Stock_Price:  100.26578701543411
curr_Factors:  [100.26578702]
mat_Sqrt:  [[0.15]]
grads:  [0.07783744]
Stock Position:  0.07783743906063251
Bond Position:  [-0.08233054]


portfolio before change:  [7.74912704]
curr_Stock_Price:  100.61312358408304
curr_Factors:  [100.61312358]
mat_Sqrt:  [[0.15]]
grads:  [0.27744096]
Stock Position:  0.2774409595995178
Bond Position:  [-20.16507452]


portfolio before change:  [7.639124]
curr_Stock_Price:  100.22571775927675
curr_Factors:  [100.22571776]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716641]
Stock Position:  -0.017166406867364925
Bond Position:  [9.35963945]


portfolio before change:  [7.65027156]
curr_Stock_Price:  99.64449353322365
curr_Factors:  [99.64449353]
mat_Sqrt:  [[0.15]]
grads:  [-0.04652311]
Stock Position:  -0.046523106769174254
Bond Position:  [12.28604298]


portfolio before change:  [7.6431126]
curr_Stock_Price:  99.8313859573679
curr_Factors:  [99.83138596]
mat_Sqrt:  [[0.15]]
grads:  [-0.04961605]
Stock Position:  -0.049616053855693794
Bond Position:  [12.59635202]


portfolio before change:  [7.63956958]
curr_Stock_Price:  99.9345311813837
curr_Factors:  [99.93453118]
mat_Sqrt:  [[0.15]]
grads:  [0.19262971]
Stock Position:  0.19262971003784127
Bond Position:  [-11.61079018]


portfolio before change:  [7.67431215]
curr_Stock_Price:  100.12242539566307
curr_Factors:  [100.1224254]
mat_Sqrt:  [[0.15]]
grads:  [0.02448354]
Stock Position:  0.024483544075739043
Bond Position:  [5.22296034]


portfolio before change:  [7.71264305]
curr_Stock_Price:  101.66133615183104
curr_Factors:  [101.66133615]
mat_Sqrt:  [[0.15]]
grads:  [0.08016703]
Stock Position:  0.08016703463976069
Bond Position:  [-0.43724481]


portfolio before change:  [7.65720747]
curr_Stock_Price:  100.97051699201342
curr_Factors:  [100.97051699]
mat_Sqrt:  [[0.15]]
grads:  [-0.12702824]
Stock Position:  -0.12702823684096423
Bond Position:  [20.48331422]


portfolio before change:  [7.63403915]
curr_Stock_Price:  101.17306167623236
curr_Factors:  [101.17306168]
mat_Sqrt:  [[0.15]]
grads:  [0.15416754]
Stock Position:  0.154167542465735
Bond Position:  [-7.96356313]


portfolio before change:  [7.50910848]
curr_Stock_Price:  100.36916247603583
curr_Factors:  [100.36916248]
mat_Sqrt:  [[0.15]]
grads:  [0.12808549]
Stock Position:  0.12808549404234731
Bond Position:  [-5.34672529]


portfolio before change:  [7.40156935]
curr_Stock_Price:  99.53479209324657
curr_Factors:  [99.53479209]
mat_Sqrt:  [[0.15]]
grads:  [-0.10152416]
Stock Position:  -0.10152416300231565
Bond Position:  [17.50675581]


portfolio before change:  [7.50464386]
curr_Stock_Price:  98.54107769019402
curr_Factors:  [98.54107769]
mat_Sqrt:  [[0.15]]
grads:  [0.02450376]
Stock Position:  0.024503759048920833
Bond Position:  [5.09001703]


portfolio before change:  [7.49906183]
curr_Stock_Price:  98.28730791985924
curr_Factors:  [98.28730792]
mat_Sqrt:  [[0.15]]
grads:  [0.04792807]
Stock Position:  0.04792806987820922
Bond Position:  [2.78834087]


portfolio before change:  [7.53244076]
curr_Stock_Price:  98.97647313260971
curr_Factors:  [98.97647313]
mat_Sqrt:  [[0.15]]
grads:  [-0.07017847]
Stock Position:  -0.07017846820860969
Bond Position:  [14.47845803]


portfolio before change:  [7.51475756]
curr_Stock_Price:  99.2542381383193
curr_Factors:  [99.25423814]
mat_Sqrt:  [[0.15]]
grads:  [-0.00945652]
Stock Position:  -0.009456519797493592
Bond Position:  [8.45335722]


portfolio before change:  [7.50947906]
curr_Stock_Price:  99.92417076809852
curr_Factors:  [99.92417077]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102388]
Stock Position:  -0.04102387615092804
Bond Position:  [11.60875587]


portfolio before change:  [7.47898843]
curr_Stock_Price:  100.70278606389898
curr_Factors:  [100.70278606]
mat_Sqrt:  [[0.15]]
grads:  [0.03953645]
Stock Position:  0.03953644657355023
Bond Position:  [3.49755811]


portfolio before change:  [7.47620037]
curr_Stock_Price:  100.62120872394215
curr_Factors:  [100.62120872]
mat_Sqrt:  [[0.15]]
grads:  [0.0460116]
Stock Position:  0.046011602162134804
Bond Position:  [2.84645735]


portfolio before change:  [7.443146]
curr_Stock_Price:  99.89508318471316
curr_Factors:  [99.89508318]
mat_Sqrt:  [[0.15]]
grads:  [-0.06757742]
Stock Position:  -0.06757742197632412
Bond Position:  [14.19379819]


portfolio before change:  [7.42100716]
curr_Stock_Price:  100.24894654200669
curr_Factors:  [100.24894654]
mat_Sqrt:  [[0.15]]
grads:  [-0.03183899]
Stock Position:  -0.03183899135291048
Bond Position:  [10.61283251]


portfolio before change:  [7.41197132]
curr_Stock_Price:  100.5744130974334
curr_Factors:  [100.5744131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03014181]
Stock Position:  -0.030141808393991828
Bond Position:  [10.44346601]


portfolio before change:  [7.42735881]
curr_Stock_Price:  100.10722257382409
curr_Factors:  [100.10722257]
mat_Sqrt:  [[0.15]]
grads:  [0.04716762]
Stock Position:  0.04716762336727808
Bond Position:  [2.70553904]


portfolio before change:  [7.47538156]
curr_Stock_Price:  101.11818171845444
curr_Factors:  [101.11818172]
mat_Sqrt:  [[0.15]]
grads:  [-0.07306716]
Stock Position:  -0.07306716126637114
Bond Position:  [14.86380005]


portfolio before change:  [7.52571503]
curr_Stock_Price:  100.45474583836217
curr_Factors:  [100.45474584]
mat_Sqrt:  [[0.15]]
grads:  [0.06394417]
Stock Position:  0.06394416574870324
Bond Position:  [1.10222011]


portfolio before change:  [7.55392895]
curr_Stock_Price:  100.89381858954133
curr_Factors:  [100.89381859]
mat_Sqrt:  [[0.15]]
grads:  [0.04270062]
Stock Position:  0.04270061639480417
Bond Position:  [3.24570071]


portfolio before change:  [7.585968]
curr_Stock_Price:  101.63463476766829
curr_Factors:  [101.63463477]
mat_Sqrt:  [[0.15]]
grads:  [-0.01660989]
Stock Position:  -0.016609891491502562
Bond Position:  [9.27410826]


portfolio before change:  [7.59335132]
curr_Stock_Price:  101.25991910009071
curr_Factors:  [101.2599191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528853]
Stock Position:  -0.005288533068607283
Bond Position:  [8.12886775]


portfolio before change:  [7.59229533]
curr_Stock_Price:  101.65174110600697
curr_Factors:  [101.65174111]
mat_Sqrt:  [[0.15]]
grads:  [0.01241495]
Stock Position:  0.012414947068880584
Bond Position:  [6.33029435]


portfolio before change:  [7.57830024]
curr_Stock_Price:  100.46072271384013
curr_Factors:  [100.46072271]
mat_Sqrt:  [[0.15]]
grads:  [-0.05555901]
Stock Position:  -0.05555901191872115
Bond Position:  [13.15979873]


portfolio before change:  [7.59551273]
curr_Stock_Price:  100.18052667122421
curr_Factors:  [100.18052667]
mat_Sqrt:  [[0.15]]
grads:  [-0.13979772]
Stock Position:  -0.13979771606982883
Bond Position:  [21.60052155]


portfolio before change:  [7.70720975]
curr_Stock_Price:  99.40085163594476
curr_Factors:  [99.40085164]
mat_Sqrt:  [[0.15]]
grads:  [0.09996465]
Stock Position:  0.09996465429317399
Bond Position:  [-2.22936202]


portfolio before change:  [7.75265889]
curr_Stock_Price:  99.85829158649838
curr_Factors:  [99.85829159]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417372]
Stock Position:  -0.054173715240938246
Bond Position:  [13.16235354]


portfolio before change:  [7.77964035]
curr_Stock_Price:  99.39060977200926
curr_Factors:  [99.39060977]
mat_Sqrt:  [[0.15]]
grads:  [-0.23457127]
Stock Position:  -0.23457126915643042
Bond Position:  [31.09382183]


portfolio before change:  [8.00932859]
curr_Stock_Price:  98.427997132809
curr_Factors:  [98.42799713]
mat_Sqrt:  [[0.15]]
grads:  [-0.1480409]
Stock Position:  -0.1480408998956008
Bond Position:  [22.58069786]


portfolio before change:  [7.89715503]
curr_Stock_Price:  99.20478464283684
curr_Factors:  [99.20478464]
mat_Sqrt:  [[0.15]]
grads:  [0.23080663]
Stock Position:  0.23080663069974722
Bond Position:  [-14.99996706]


portfolio before change:  [7.90590353]
curr_Stock_Price:  99.25081281657897
curr_Factors:  [99.25081282]
mat_Sqrt:  [[0.15]]
grads:  [0.02093524]
Stock Position:  0.020935240324111162
Bond Position:  [5.82806391]


portfolio before change:  [7.93182877]
curr_Stock_Price:  100.45436686865466
curr_Factors:  [100.45436687]
mat_Sqrt:  [[0.15]]
grads:  [0.06556799]
Stock Position:  0.06556799040114067
Bond Position:  [1.34523781]


portfolio before change:  [7.8588703]
curr_Stock_Price:  99.33908726815015
curr_Factors:  [99.33908727]
mat_Sqrt:  [[0.15]]
grads:  [0.03368226]
Stock Position:  0.033682261348067746
Bond Position:  [4.5129052]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.88855737]
Stock Price:  100.20372410453471
PL:  [7.68483326]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 5.03365418e-03]
 [ 1.67941313e-02]
 [-1.53967013e-02]
 [-6.74552677e-03]
 [-6.60566174e-03]
 [ 3.79841302e-02]
 [ 3.55509088e-03]
 [-1.37942100e-03]
 [-2.76290095e-02]
 [ 2.34404177e-02]
 [ 1.99758872e-02]
 [-1.26127109e-02]
 [ 2.76460125e-03]
 [ 7.68966011e-03]
 [-1.62029109e-02]
 [ 7.05719321e-04]
 [-6.10369599e-03]
 [-6.00559228e-04]
 [ 8.32857412e-04]
 [-1.58272778e-02]
 [-1.22340247e-02]
 [-2.35267420e-02]
 [ 5.07321996e-03]
 [-8.61802485e-03]
 [ 1.49645407e-02]
 [ 7.09197318e-03]
 [-8.06190708e-03]
 [-2.50223973e-03]
 [ 4.69103616e-04]
 [-1.43297587e-02]
 [ 2.67250406e-02]
 [ 8.82865108e-03]
 [-1.19045571e-02]
 [-4.55159913e-02]
 [-2.26959410e-02]
 [ 3.91823497e-02]
 [-1.61236825e-03]
 [ 1.95972819e-03]
 [ 6.95270291e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.61095391]
curr_Stock_Price:  99.06642031678705
curr_Factors:  [99.06642032]
mat_Sqrt:  [[0.15]]
grads:  [0.03355769]
Stock Position:  0.03355769450540218
Bond Position:  [-21.93539458]


portfolio before change:  [-18.62119456]
curr_Stock_Price:  98.84296793901922
curr_Factors:  [98.84296794]
mat_Sqrt:  [[0.15]]
grads:  [0.11196088]
Stock Position:  0.1119608751664106
Bond Position:  [-29.68773975]


portfolio before change:  [-18.70139677]
curr_Stock_Price:  98.15977379003408
curr_Factors:  [98.15977379]
mat_Sqrt:  [[0.15]]
grads:  [-0.10264468]
Stock Position:  -0.1026446752726958
Bond Position:  [-8.62581866]


portfolio before change:  [-18.82018964]
curr_Stock_Price:  99.30658999584027
curr_Factors:  [99.30659]
mat_Sqrt:  [[0.15]]
grads:  [-0.04497018]
Stock Position:  -0.044970178479686526
Bond Position:  [-14.35435457]


portfolio before change:  [-18.81252448]
curr_Stock_Price:  99.09623803959113
curr_Factors:  [99.09623804]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403774]
Stock Position:  -0.04403774494075789
Bond Position:  [-14.44854963]


portfolio before change:  [-18.78407471]
curr_Stock_Price:  98.40919198721043
curr_Factors:  [98.40919199]
mat_Sqrt:  [[0.15]]
grads:  [0.25322753]
Stock Position:  0.2532275347700905
Bond Position:  [-43.70399179]


portfolio before change:  [-18.70599821]
curr_Stock_Price:  98.73909226053875
curr_Factors:  [98.73909226]
mat_Sqrt:  [[0.15]]
grads:  [0.02370061]
Stock Position:  0.023700605888844654
Bond Position:  [-21.04617453]


portfolio before change:  [-18.69625745]
curr_Stock_Price:  99.2610916302027
curr_Factors:  [99.26109163]
mat_Sqrt:  [[0.15]]
grads:  [-0.00919614]
Stock Position:  -0.009196139975833323
Bond Position:  [-17.78343856]


portfolio before change:  [-18.70320957]
curr_Stock_Price:  99.77533448093673
curr_Factors:  [99.77533448]
mat_Sqrt:  [[0.15]]
grads:  [-0.1841934]
Stock Position:  -0.18419339686206382
Bond Position:  [-0.32525179]


portfolio before change:  [-18.50611465]
curr_Stock_Price:  98.70507040060654
curr_Factors:  [98.7050704]
mat_Sqrt:  [[0.15]]
grads:  [0.15626945]
Stock Position:  0.15626945137428164
Bond Position:  [-33.93070185]


portfolio before change:  [-18.4345743]
curr_Stock_Price:  99.19001450439404
curr_Factors:  [99.1900145]
mat_Sqrt:  [[0.15]]
grads:  [0.13317258]
Stock Position:  0.1331725814255802
Bond Position:  [-31.64396459]


portfolio before change:  [-18.52541998]
curr_Stock_Price:  98.53755335022822
curr_Factors:  [98.53755335]
mat_Sqrt:  [[0.15]]
grads:  [-0.08408474]
Stock Position:  -0.08408473904516711
Bond Position:  [-10.23991552]


portfolio before change:  [-18.52220953]
curr_Stock_Price:  98.48414863132597
curr_Factors:  [98.48414863]
mat_Sqrt:  [[0.15]]
grads:  [0.01843068]
Stock Position:  0.018430675000168085
Bond Position:  [-20.33733887]


portfolio before change:  [-18.53205885]
curr_Stock_Price:  98.0876904422635
curr_Factors:  [98.08769044]
mat_Sqrt:  [[0.15]]
grads:  [0.0512644]
Stock Position:  0.051264400731938824
Bond Position:  [-23.56046552]


portfolio before change:  [-18.53625456]
curr_Stock_Price:  98.06329793034516
curr_Factors:  [98.06329793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10801941]
Stock Position:  -0.10801940620053091
Bond Position:  [-7.94351534]


portfolio before change:  [-18.50813399]
curr_Stock_Price:  97.79377623700368
curr_Factors:  [97.79377624]
mat_Sqrt:  [[0.15]]
grads:  [0.0047048]
Stock Position:  0.0047047954710439386
Bond Position:  [-18.9682337]


portfolio before change:  [-18.51340584]
curr_Stock_Price:  97.17724065997
curr_Factors:  [97.17724066]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069131]
Stock Position:  -0.04069130662290801
Bond Position:  [-14.55913694]


portfolio before change:  [-18.49700424]
curr_Stock_Price:  96.7294396889848
curr_Factors:  [96.72943969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400373]
Stock Position:  -0.004003728185332535
Bond Position:  [-18.10972585]


portfolio before change:  [-18.50039812]
curr_Stock_Price:  97.01168260591447
curr_Factors:  [97.01168261]
mat_Sqrt:  [[0.15]]
grads:  [0.00555238]
Stock Position:  0.005552382749841994
Bond Position:  [-19.03904411]


portfolio before change:  [-18.50394367]
curr_Stock_Price:  96.80176887390384
curr_Factors:  [96.80176887]
mat_Sqrt:  [[0.15]]
grads:  [-0.10551519]
Stock Position:  -0.10551518530832305
Bond Position:  [-8.28988709]


portfolio before change:  [-18.42446625]
curr_Stock_Price:  96.03871549816148
curr_Factors:  [96.0387155]
mat_Sqrt:  [[0.15]]
grads:  [-0.08156016]
Stock Position:  -0.08156016447329477
Bond Position:  [-10.59153282]


portfolio before change:  [-18.32318069]
curr_Stock_Price:  94.78063091880976
curr_Factors:  [94.78063092]
mat_Sqrt:  [[0.15]]
grads:  [-0.15684495]
Stock Position:  -0.15684494684772257
Bond Position:  [-3.45731767]


portfolio before change:  [-18.50454854]
curr_Stock_Price:  95.93422663520107
curr_Factors:  [95.93422664]
mat_Sqrt:  [[0.15]]
grads:  [0.03382147]
Stock Position:  0.03382146638522975
Bond Position:  [-21.74918476]


portfolio before change:  [-18.45431065]
curr_Stock_Price:  97.49999880287277
curr_Factors:  [97.4999988]
mat_Sqrt:  [[0.15]]
grads:  [-0.0574535]
Stock Position:  -0.05745349902050932
Bond Position:  [-12.85259456]


portfolio before change:  [-18.52542077]
curr_Stock_Price:  98.70973272110011
curr_Factors:  [98.70973272]
mat_Sqrt:  [[0.15]]
grads:  [0.0997636]
Stock Position:  0.0997636048052819
Bond Position:  [-28.37305953]


portfolio before change:  [-18.545064]
curr_Stock_Price:  98.54838749866744
curr_Factors:  [98.5483875]
mat_Sqrt:  [[0.15]]
grads:  [0.04727982]
Stock Position:  0.04727982122402582
Bond Position:  [-23.20441415]


portfolio before change:  [-18.50857068]
curr_Stock_Price:  99.38159830464556
curr_Factors:  [99.3815983]
mat_Sqrt:  [[0.15]]
grads:  [-0.05374605]
Stock Position:  -0.05374604719395975
Bond Position:  [-13.16720261]


portfolio before change:  [-18.49394508]
curr_Stock_Price:  99.0788485672723
curr_Factors:  [99.07884857]
mat_Sqrt:  [[0.15]]
grads:  [-0.0166816]
Stock Position:  -0.01668159818978918
Bond Position:  [-16.84115154]


portfolio before change:  [-18.51338443]
curr_Stock_Price:  100.11796192959683
curr_Factors:  [100.11796193]
mat_Sqrt:  [[0.15]]
grads:  [0.00312736]
Stock Position:  0.0031273574392815372
Bond Position:  [-18.82648908]


portfolio before change:  [-18.51984403]
curr_Stock_Price:  98.80498685251486
curr_Factors:  [98.80498685]
mat_Sqrt:  [[0.15]]
grads:  [-0.09553172]
Stock Position:  -0.09553172435825455
Bond Position:  [-9.08083326]


portfolio before change:  [-18.41212101]
curr_Stock_Price:  97.66548898794152
curr_Factors:  [97.66548899]
mat_Sqrt:  [[0.15]]
grads:  [0.17816694]
Stock Position:  0.17816693759852534
Bond Position:  [-35.81288209]


portfolio before change:  [-18.38933375]
curr_Stock_Price:  97.81851486286929
curr_Factors:  [97.81851486]
mat_Sqrt:  [[0.15]]
grads:  [0.05885767]
Stock Position:  0.058857673861487776
Bond Position:  [-24.14670399]


portfolio before change:  [-18.39184008]
curr_Stock_Price:  97.82721710445581
curr_Factors:  [97.8272171]
mat_Sqrt:  [[0.15]]
grads:  [-0.07936371]
Stock Position:  -0.0793637138515057
Bond Position:  [-10.62790881]


portfolio before change:  [-18.30143962]
curr_Stock_Price:  96.6714114396339
curr_Factors:  [96.67141144]
mat_Sqrt:  [[0.15]]
grads:  [-0.30343994]
Stock Position:  -0.30343994225401394
Bond Position:  [11.03252788]


portfolio before change:  [-18.4780664]
curr_Stock_Price:  97.25803800644809
curr_Factors:  [97.25803801]
mat_Sqrt:  [[0.15]]
grads:  [-0.15130627]
Stock Position:  -0.15130627312052886
Bond Position:  [-3.76231514]


portfolio before change:  [-18.38176571]
curr_Stock_Price:  96.61846763307453
curr_Factors:  [96.61846763]
mat_Sqrt:  [[0.15]]
grads:  [0.26121566]
Stock Position:  0.26121566465270063
Bond Position:  [-43.62002295]


portfolio before change:  [-18.39668205]
curr_Stock_Price:  96.58223894021688
curr_Factors:  [96.58223894]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074912]
Stock Position:  -0.01074912166727442
Bond Position:  [-17.35850782]


portfolio before change:  [-18.39684074]
curr_Stock_Price:  96.39512894648655
curr_Factors:  [96.39512895]
mat_Sqrt:  [[0.15]]
grads:  [0.01306485]
Stock Position:  0.013064854606040604
Bond Position:  [-19.65622908]


portfolio before change:  [-18.3823431]
curr_Stock_Price:  97.69287167984909
curr_Factors:  [97.69287168]
mat_Sqrt:  [[0.15]]
grads:  [0.04635135]
Stock Position:  0.046351352733614376
Bond Position:  [-22.91053985]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.36332092]
Stock Price:  98.16505140992062
PL:  [-18.36332092]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.08151762e-02]
 [ 4.31652082e-02]
 [-3.77792266e-03]
 [-2.60405522e-03]
 [-4.04044818e-03]
 [ 3.90695713e-03]
 [ 3.43756030e-03]
 [ 2.71489616e-02]
 [ 7.43294148e-03]
 [ 2.31485442e-02]
 [ 2.00229054e-02]
 [-4.73153571e-03]
 [-1.78098422e-03]
 [ 2.32932167e-02]
 [-8.27828913e-03]
 [-5.10190472e-03]
 [-3.51984261e-03]
 [ 6.18087071e-03]
 [ 3.49434659e-02]
 [-1.05519539e-02]
 [-1.41287622e-03]
 [-3.29252716e-02]
 [ 8.18914883e-03]
 [-4.97043261e-03]
 [-1.16112769e-02]
 [ 4.76745510e-03]
 [ 6.70799421e-03]
 [ 3.97016194e-03]
 [ 5.49444147e-03]
 [ 5.97774715e-03]
 [-1.42139708e-02]
 [ 3.71899106e-03]
 [ 9.44524016e-03]
 [ 4.43918444e-02]
 [-2.00176862e-02]
 [-1.81116213e-02]
 [ 2.41649299e-02]
 [ 1.69486138e-02]
 [ 8.37171909e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.61083606]
curr_Stock_Price:  99.94189695194254
curr_Factors:  [99.94189695]
mat_Sqrt:  [[0.15]]
grads:  [0.13876784]
Stock Position:  0.1387678410038885
Bond Position:  [-13.2578852]


portfolio before change:  [0.63507753]
curr_Stock_Price:  100.12853103406749
curr_Factors:  [100.12853103]
mat_Sqrt:  [[0.15]]
grads:  [0.28776805]
Stock Position:  0.2877680547255189
Bond Position:  [-28.17871507]


portfolio before change:  [0.88562602]
curr_Stock_Price:  101.01143322220486
curr_Factors:  [101.01143322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02518615]
Stock Position:  -0.025186151071202763
Bond Position:  [3.42971523]


portfolio before change:  [0.88145434]
curr_Stock_Price:  101.19408995862146
curr_Factors:  [101.19408996]
mat_Sqrt:  [[0.15]]
grads:  [-0.01736037]
Stock Position:  -0.017360368158663188
Bond Position:  [2.63822099]


portfolio before change:  [0.88714342]
curr_Stock_Price:  100.88538184791307
curr_Factors:  [100.88538185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02693632]
Stock Position:  -0.026936321206762065
Bond Position:  [3.60462447]


portfolio before change:  [0.84346097]
curr_Stock_Price:  102.52380379556081
curr_Factors:  [102.5238038]
mat_Sqrt:  [[0.15]]
grads:  [0.02604638]
Stock Position:  0.026046380844587682
Bond Position:  [-1.82691307]


portfolio before change:  [0.86304605]
curr_Stock_Price:  103.28450289311009
curr_Factors:  [103.28450289]
mat_Sqrt:  [[0.15]]
grads:  [0.02291707]
Stock Position:  0.02291706867990359
Bond Position:  [-1.503932]


portfolio before change:  [0.85933772]
curr_Stock_Price:  103.13089120265559
curr_Factors:  [103.1308912]
mat_Sqrt:  [[0.15]]
grads:  [0.18099308]
Stock Position:  0.18099307705182577
Bond Position:  [-17.80663962]


portfolio before change:  [0.74667249]
curr_Stock_Price:  102.52070623271551
curr_Factors:  [102.52070623]
mat_Sqrt:  [[0.15]]
grads:  [0.04955294]
Stock Position:  0.04955294322766477
Bond Position:  [-4.33353024]


portfolio before change:  [0.67618277]
curr_Stock_Price:  101.10912514510645
curr_Factors:  [101.10912515]
mat_Sqrt:  [[0.15]]
grads:  [0.15432363]
Stock Position:  0.15432362770960986
Bond Position:  [-14.92734422]


portfolio before change:  [0.76709946]
curr_Stock_Price:  101.71034691292694
curr_Factors:  [101.71034691]
mat_Sqrt:  [[0.15]]
grads:  [0.13348604]
Stock Position:  0.13348603622318325
Bond Position:  [-12.80981159]


portfolio before change:  [0.8949983]
curr_Stock_Price:  102.68048708858353
curr_Factors:  [102.68048709]
mat_Sqrt:  [[0.15]]
grads:  [-0.03154357]
Stock Position:  -0.03154357138223355
Bond Position:  [4.13390757]


portfolio before change:  [0.83504281]
curr_Stock_Price:  104.59758951478784
curr_Factors:  [104.59758951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187323]
Stock Position:  -0.011873228125044535
Bond Position:  [2.07695385]


portfolio before change:  [0.82827922]
curr_Stock_Price:  105.18910767429598
curr_Factors:  [105.18910767]
mat_Sqrt:  [[0.15]]
grads:  [0.15528811]
Stock Position:  0.15528811135733528
Bond Position:  [-15.50633865]


portfolio before change:  [0.84139911]
curr_Stock_Price:  105.28607780224688
curr_Factors:  [105.2860778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05518859]
Stock Position:  -0.05518859419321165
Bond Position:  [6.65198973]


portfolio before change:  [0.81484832]
curr_Stock_Price:  105.78223730219196
curr_Factors:  [105.7822373]
mat_Sqrt:  [[0.15]]
grads:  [-0.0340127]
Stock Position:  -0.03401269816575547
Bond Position:  [4.41278763]


portfolio before change:  [0.78027076]
curr_Stock_Price:  106.81506292908077
curr_Factors:  [106.81506293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02346562]
Stock Position:  -0.0234656174254296
Bond Position:  [3.28675217]


portfolio before change:  [0.77613818]
curr_Stock_Price:  107.00868457535223
curr_Factors:  [107.00868458]
mat_Sqrt:  [[0.15]]
grads:  [0.0412058]
Stock Position:  0.041205804712005245
Bond Position:  [-3.63324078]


portfolio before change:  [0.78913739]
curr_Stock_Price:  107.33517712706838
curr_Factors:  [107.33517713]
mat_Sqrt:  [[0.15]]
grads:  [0.23295644]
Stock Position:  0.23295643904704802
Bond Position:  [-24.21528326]


portfolio before change:  [0.45790585]
curr_Stock_Price:  105.92631099386081
curr_Factors:  [105.92631099]
mat_Sqrt:  [[0.15]]
grads:  [-0.07034636]
Stock Position:  -0.07034635950828187
Bond Position:  [7.9094362]


portfolio before change:  [0.39470794]
curr_Stock_Price:  106.8387483782624
curr_Factors:  [106.83874838]
mat_Sqrt:  [[0.15]]
grads:  [-0.00941917]
Stock Position:  -0.009419174833190354
Bond Position:  [1.40104079]


portfolio before change:  [0.38612419]
curr_Stock_Price:  107.7686488812608
curr_Factors:  [107.76864888]
mat_Sqrt:  [[0.15]]
grads:  [-0.21950181]
Stock Position:  -0.21950181071772917
Bond Position:  [24.04153776]


portfolio before change:  [0.69719304]
curr_Stock_Price:  106.36518222845375
curr_Factors:  [106.36518223]
mat_Sqrt:  [[0.15]]
grads:  [0.05459433]
Stock Position:  0.054594325563072366
Bond Position:  [-5.10974235]


portfolio before change:  [0.71001741]
curr_Stock_Price:  106.61178536041159
curr_Factors:  [106.61178536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313622]
Stock Position:  -0.0331362174101233
Bond Position:  [4.24272871]


portfolio before change:  [0.70498168]
curr_Stock_Price:  106.77976187074226
curr_Factors:  [106.77976187]
mat_Sqrt:  [[0.15]]
grads:  [-0.07740851]
Stock Position:  -0.07740851288676213
Bond Position:  [8.97064426]


portfolio before change:  [0.7697438]
curr_Stock_Price:  105.95762081373205
curr_Factors:  [105.95762081]
mat_Sqrt:  [[0.15]]
grads:  [0.03178303]
Stock Position:  0.03178303396729436
Bond Position:  [-2.59791086]


portfolio before change:  [0.79662947]
curr_Stock_Price:  106.81375147840447
curr_Factors:  [106.81375148]
mat_Sqrt:  [[0.15]]
grads:  [0.04471996]
Stock Position:  0.04471996138825987
Bond Position:  [-3.98007737]


portfolio before change:  [0.81509016]
curr_Stock_Price:  107.23768355723263
curr_Factors:  [107.23768356]
mat_Sqrt:  [[0.15]]
grads:  [0.02646775]
Stock Position:  0.02646774628575739
Bond Position:  [-2.02324964]


portfolio before change:  [0.81039655]
curr_Stock_Price:  107.06990620896394
curr_Factors:  [107.06990621]
mat_Sqrt:  [[0.15]]
grads:  [0.03662961]
Stock Position:  0.036629609768301145
Bond Position:  [-3.11153234]


portfolio before change:  [0.7977014]
curr_Stock_Price:  106.73394354081809
curr_Factors:  [106.73394354]
mat_Sqrt:  [[0.15]]
grads:  [0.03985165]
Stock Position:  0.03985164764036366
Bond Position:  [-3.45582211]


portfolio before change:  [0.80153495]
curr_Stock_Price:  106.84097933654274
curr_Factors:  [106.84097934]
mat_Sqrt:  [[0.15]]
grads:  [-0.09475981]
Stock Position:  -0.09475980558028048
Bond Position:  [10.92576538]


portfolio before change:  [0.77456688]
curr_Stock_Price:  107.1399865921743
curr_Factors:  [107.13998659]
mat_Sqrt:  [[0.15]]
grads:  [0.02479327]
Stock Position:  0.02479327374620393
Bond Position:  [-1.88178413]


portfolio before change:  [0.76930736]
curr_Stock_Price:  106.93733945367556
curr_Factors:  [106.93733945]
mat_Sqrt:  [[0.15]]
grads:  [0.06296827]
Stock Position:  0.06296826770831622
Bond Position:  [-5.96435166]


portfolio before change:  [0.71817455]
curr_Stock_Price:  106.1371393121041
curr_Factors:  [106.13713931]
mat_Sqrt:  [[0.15]]
grads:  [0.29594563]
Stock Position:  0.29594562903220606
Bond Position:  [-30.69264791]


portfolio before change:  [0.99028506]
curr_Stock_Price:  107.06956508881636
curr_Factors:  [107.06956509]
mat_Sqrt:  [[0.15]]
grads:  [-0.13345124]
Stock Position:  -0.13345124109853668
Bond Position:  [15.27885141]


portfolio before change:  [1.02760718]
curr_Stock_Price:  106.80420871014546
curr_Factors:  [106.80420871]
mat_Sqrt:  [[0.15]]
grads:  [-0.12074414]
Stock Position:  -0.12074414198223477
Bond Position:  [13.92358972]


portfolio before change:  [0.9209071]
curr_Stock_Price:  107.70231134698427
curr_Factors:  [107.70231135]
mat_Sqrt:  [[0.15]]
grads:  [0.16109953]
Stock Position:  0.16109953293978269
Bond Position:  [-16.42988495]


portfolio before change:  [0.75055724]
curr_Stock_Price:  106.65764042988953
curr_Factors:  [106.65764043]
mat_Sqrt:  [[0.15]]
grads:  [0.11299076]
Stock Position:  0.11299075860774731
Bond Position:  [-11.30077046]


portfolio before change:  [0.76128877]
curr_Stock_Price:  106.76512012016069
curr_Factors:  [106.76512012]
mat_Sqrt:  [[0.15]]
grads:  [0.05581146]
Stock Position:  0.055811460570689364
Bond Position:  [-5.19742852]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.75985465]
Stock Price:  106.75106567875257
PL:  [-5.99121103]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 9.98952123e-03]
 [ 7.18353426e-03]
 [-5.52134290e-03]
 [-2.18138478e-03]
 [-1.91927455e-03]
 [ 3.13368605e-02]
 [ 3.65390319e-03]
 [-1.29858165e-03]
 [-2.63432121e-02]
 [ 2.33943413e-02]
 [ 2.04090387e-02]
 [-8.22209506e-03]
 [-2.71841838e-04]
 [ 6.40291109e-03]
 [ 7.68967789e-03]
 [-3.38212258e-03]
 [-5.98136070e-03]
 [ 6.29072079e-03]
 [ 8.72564177e-03]
 [-3.06058467e-03]
 [-4.80529168e-03]
 [-4.79732766e-03]
 [ 4.16875536e-03]
 [-1.19214313e-02]
 [ 1.18467533e-03]
 [ 3.18541243e-03]
 [ 2.88066830e-03]
 [ 1.91580860e-03]
 [ 5.27343715e-03]
 [-5.35380049e-03]
 [-1.73822378e-02]
 [ 5.90578277e-03]
 [ 2.73459575e-03]
 [ 2.25833073e-02]
 [-2.01663251e-02]
 [-9.74912838e-03]
 [ 1.48723089e-02]
 [ 1.97195013e-02]
 [ 1.00859810e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.45606875]
curr_Stock_Price:  99.80221154760306
curr_Factors:  [99.80221155]
mat_Sqrt:  [[0.15]]
grads:  [0.06659681]
Stock Position:  0.06659680817359667
Bond Position:  [-9.10257749]


portfolio before change:  [-2.54976396]
curr_Stock_Price:  98.41239539524535
curr_Factors:  [98.4123954]
mat_Sqrt:  [[0.15]]
grads:  [0.04789023]
Stock Position:  0.04789022842050031
Bond Position:  [-7.26275606]


portfolio before change:  [-2.49739069]
curr_Stock_Price:  99.5249641224077
curr_Factors:  [99.52496412]
mat_Sqrt:  [[0.15]]
grads:  [-0.03680895]
Stock Position:  -0.03680895267888496
Bond Position:  [1.166019]


portfolio before change:  [-2.54512455]
curr_Stock_Price:  100.82572411881065
curr_Factors:  [100.82572412]
mat_Sqrt:  [[0.15]]
grads:  [-0.01454257]
Stock Position:  -0.014542565196745075
Bond Position:  [-1.07885988]


portfolio before change:  [-2.55966951]
curr_Stock_Price:  101.81661516479092
curr_Factors:  [101.81661516]
mat_Sqrt:  [[0.15]]
grads:  [-0.01279516]
Stock Position:  -0.012795163637200145
Bond Position:  [-1.25690926]


portfolio before change:  [-2.54130841]
curr_Stock_Price:  100.36933234787887
curr_Factors:  [100.36933235]
mat_Sqrt:  [[0.15]]
grads:  [0.2089124]
Stock Position:  0.20891240310878445
Bond Position:  [-23.50970683]


portfolio before change:  [-2.61755902]
curr_Stock_Price:  100.0184115424006
curr_Factors:  [100.01841154]
mat_Sqrt:  [[0.15]]
grads:  [0.02435935]
Stock Position:  0.024359354619198723
Bond Position:  [-5.05394297]


portfolio before change:  [-2.63454848]
curr_Stock_Price:  99.34689633974907
curr_Factors:  [99.34689634]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865721]
Stock Position:  -0.008657211013312575
Bond Position:  [-1.77448143]


portfolio before change:  [-2.6419876]
curr_Stock_Price:  100.1805708489376
curr_Factors:  [100.18057085]
mat_Sqrt:  [[0.15]]
grads:  [-0.17562141]
Stock Position:  -0.17562141382812615
Bond Position:  [14.95186589]


portfolio before change:  [-2.61053727]
curr_Stock_Price:  100.01213334674547
curr_Factors:  [100.01213335]
mat_Sqrt:  [[0.15]]
grads:  [0.15596228]
Stock Position:  0.1559622752993756
Bond Position:  [-18.20865714]


portfolio before change:  [-2.79855184]
curr_Stock_Price:  98.8212148731072
curr_Factors:  [98.82121487]
mat_Sqrt:  [[0.15]]
grads:  [0.13606026]
Stock Position:  0.13606025819980186
Bond Position:  [-16.24419186]


portfolio before change:  [-3.00162082]
curr_Stock_Price:  97.34364658012844
curr_Factors:  [97.34364658]
mat_Sqrt:  [[0.15]]
grads:  [-0.05481397]
Stock Position:  -0.05481396704618448
Bond Position:  [2.33417062]


portfolio before change:  [-3.05122316]
curr_Stock_Price:  98.2538913742383
curr_Factors:  [98.25389137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00181228]
Stock Position:  -0.0018122789186935727
Bond Position:  [-2.8731597]


portfolio before change:  [-3.0532401]
curr_Stock_Price:  99.16863875339332
curr_Factors:  [99.16863875]
mat_Sqrt:  [[0.15]]
grads:  [0.04268607]
Stock Position:  0.04268607394326637
Bond Position:  [-7.28635995]


portfolio before change:  [-2.99251117]
curr_Stock_Price:  100.61266432744374
curr_Factors:  [100.61266433]
mat_Sqrt:  [[0.15]]
grads:  [0.05126452]
Stock Position:  0.051264519243531606
Bond Position:  [-8.15037104]


portfolio before change:  [-3.01132251]
curr_Stock_Price:  100.26559226616367
curr_Factors:  [100.26559227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02254748]
Stock Position:  -0.022547483843666078
Bond Position:  [-0.75058569]


portfolio before change:  [-3.03139203]
curr_Stock_Price:  101.15153090525119
curr_Factors:  [101.15153091]
mat_Sqrt:  [[0.15]]
grads:  [-0.03987574]
Stock Position:  -0.03987573800934862
Bond Position:  [1.00209992]


portfolio before change:  [-3.02425938]
curr_Stock_Price:  100.97580058294544
curr_Factors:  [100.97580058]
mat_Sqrt:  [[0.15]]
grads:  [0.04193814]
Stock Position:  0.04193813862669076
Bond Position:  [-7.25899651]


portfolio before change:  [-3.01471654]
curr_Stock_Price:  101.22498367301519
curr_Factors:  [101.22498367]
mat_Sqrt:  [[0.15]]
grads:  [0.05817095]
Stock Position:  0.058170945107738584
Bond Position:  [-8.90306951]


portfolio before change:  [-3.07428659]
curr_Stock_Price:  100.2200644349721
curr_Factors:  [100.22006443]
mat_Sqrt:  [[0.15]]
grads:  [-0.0204039]
Stock Position:  -0.020403897780169288
Bond Position:  [-1.02940664]


portfolio before change:  [-3.07564785]
curr_Stock_Price:  100.2804729819298
curr_Factors:  [100.28047298]
mat_Sqrt:  [[0.15]]
grads:  [-0.03203528]
Stock Position:  -0.03203527783918311
Bond Position:  [0.13686497]


portfolio before change:  [-3.06933075]
curr_Stock_Price:  100.08381525993737
curr_Factors:  [100.08381526]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198218]
Stock Position:  -0.03198218437084632
Bond Position:  [0.13156828]


portfolio before change:  [-3.13123072]
curr_Stock_Price:  102.01978099914973
curr_Factors:  [102.019781]
mat_Sqrt:  [[0.15]]
grads:  [0.0277917]
Stock Position:  0.02779170238599443
Bond Position:  [-5.96653411]


portfolio before change:  [-3.10836869]
curr_Stock_Price:  102.86923954190507
curr_Factors:  [102.86923954]
mat_Sqrt:  [[0.15]]
grads:  [-0.07947621]
Stock Position:  -0.07947620876776217
Bond Position:  [5.06728847]


portfolio before change:  [-3.0826052]
curr_Stock_Price:  102.55304382938964
curr_Factors:  [102.55304383]
mat_Sqrt:  [[0.15]]
grads:  [0.00789784]
Stock Position:  0.007897835559201438
Bond Position:  [-3.89255227]


portfolio before change:  [-3.08282069]
curr_Stock_Price:  102.58737056295583
curr_Factors:  [102.58737056]
mat_Sqrt:  [[0.15]]
grads:  [0.02123608]
Stock Position:  0.02123608283538352
Bond Position:  [-5.26137459]


portfolio before change:  [-3.06252242]
curr_Stock_Price:  103.57418079875882
curr_Factors:  [103.5741808]
mat_Sqrt:  [[0.15]]
grads:  [0.01920446]
Stock Position:  0.01920445535874726
Bond Position:  [-5.05160815]


portfolio before change:  [-3.04799803]
curr_Stock_Price:  104.36336650388793
curr_Factors:  [104.3633665]
mat_Sqrt:  [[0.15]]
grads:  [0.01277206]
Stock Position:  0.01277205730786764
Bond Position:  [-4.38093293]


portfolio before change:  [-3.04651748]
curr_Stock_Price:  104.5221662130944
curr_Factors:  [104.52216621]
mat_Sqrt:  [[0.15]]
grads:  [0.03515625]
Stock Position:  0.03515624766348897
Bond Position:  [-6.72112464]


portfolio before change:  [-3.07009693]
curr_Stock_Price:  103.87536071608847
curr_Factors:  [103.87536072]
mat_Sqrt:  [[0.15]]
grads:  [-0.035692]
Stock Position:  -0.03569200328546682
Bond Position:  [0.63742279]


portfolio before change:  [-3.06666311]
curr_Stock_Price:  103.78138621817605
curr_Factors:  [103.78138622]
mat_Sqrt:  [[0.15]]
grads:  [-0.11588159]
Stock Position:  -0.11588158511466322
Bond Position:  [8.95968843]


portfolio before change:  [-3.15172317]
curr_Stock_Price:  104.52507726719001
curr_Factors:  [104.52507727]
mat_Sqrt:  [[0.15]]
grads:  [0.03937189]
Stock Position:  0.039371885159140085
Bond Position:  [-7.26707251]


portfolio before change:  [-3.15235085]
curr_Stock_Price:  104.53220834079843
curr_Factors:  [104.53220834]
mat_Sqrt:  [[0.15]]
grads:  [0.01823064]
Stock Position:  0.01823063834560606
Bond Position:  [-5.05803974]


portfolio before change:  [-3.14241093]
curr_Stock_Price:  105.11212308290439
curr_Factors:  [105.11212308]
mat_Sqrt:  [[0.15]]
grads:  [0.15055538]
Stock Position:  0.15055538169549257
Bond Position:  [-18.96760674]


portfolio before change:  [-3.14240904]
curr_Stock_Price:  105.1278846407906
curr_Factors:  [105.12788464]
mat_Sqrt:  [[0.15]]
grads:  [-0.13444217]
Stock Position:  -0.13444216749966015
Bond Position:  [10.99121164]


portfolio before change:  [-3.2222696]
curr_Stock_Price:  105.73211879922728
curr_Factors:  [105.7321188]
mat_Sqrt:  [[0.15]]
grads:  [-0.06499419]
Stock Position:  -0.06499418923327001
Bond Position:  [3.64970373]


portfolio before change:  [-3.23438149]
curr_Stock_Price:  105.92549189960073
curr_Factors:  [105.9254919]
mat_Sqrt:  [[0.15]]
grads:  [0.09914873]
Stock Position:  0.09914872590586557
Bond Position:  [-13.73675905]


portfolio before change:  [-3.2480277]
curr_Stock_Price:  105.80517760005388
curr_Factors:  [105.8051776]
mat_Sqrt:  [[0.15]]
grads:  [0.13146334]
Stock Position:  0.13146334179107652
Bond Position:  [-17.15752993]


portfolio before change:  [-3.45870568]
curr_Stock_Price:  104.21893194051917
curr_Factors:  [104.21893194]
mat_Sqrt:  [[0.15]]
grads:  [0.06723987]
Stock Position:  0.06723987318794392
Bond Position:  [-10.46637345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.40222004]
Stock Price:  105.07845198703502
PL:  [-8.48067203]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.16406366e-02]
 [-4.98184269e-03]
 [-3.93625989e-05]
 [-2.60639413e-03]
 [-7.41366395e-03]
 [ 2.90293210e-02]
 [ 3.60821206e-03]
 [ 4.30126031e-03]
 [-2.65219787e-02]
 [ 2.34407432e-02]
 [ 2.03642676e-02]
 [-1.17026654e-02]
 [-9.12417856e-03]
 [ 6.32027665e-03]
 [-1.08698932e-02]
 [ 6.05377716e-04]
 [-6.04551216e-03]
 [ 2.54453280e-03]
 [ 5.04973187e-03]
 [-2.88835081e-02]
 [-3.18438771e-03]
 [-1.13057880e-02]
 [ 6.56302905e-03]
 [-7.07784694e-03]
 [ 1.54359431e-02]
 [ 7.95434187e-03]
 [-7.33629442e-03]
 [-2.97759396e-03]
 [-2.32179082e-03]
 [-1.41563294e-02]
 [-4.83356836e-03]
 [ 1.37136405e-02]
 [-9.36830192e-03]
 [-1.86612216e-02]
 [-2.22403237e-02]
 [ 3.89451370e-02]
 [ 3.23474823e-03]
 [ 1.00144393e-02]
 [ 7.73779144e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.78879633]
curr_Stock_Price:  101.27083783153013
curr_Factors:  [101.27083783]
mat_Sqrt:  [[0.15]]
grads:  [-0.34427091]
Stock Position:  -0.3442709109177384
Bond Position:  [64.65339992]


portfolio before change:  [29.77508942]
curr_Stock_Price:  101.33412837055393
curr_Factors:  [101.33412837]
mat_Sqrt:  [[0.15]]
grads:  [-0.03321228]
Stock Position:  -0.033212284588711824
Bond Position:  [33.14062733]


portfolio before change:  [29.77660299]
curr_Stock_Price:  101.4132937427155
curr_Factors:  [101.41329374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026242]
Stock Position:  -0.0002624173257075729
Bond Position:  [29.8032156]


portfolio before change:  [29.78038575]
curr_Stock_Price:  101.19561275766146
curr_Factors:  [101.19561276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737596]
Stock Position:  -0.017375960897394616
Bond Position:  [31.53875676]


portfolio before change:  [29.80882462]
curr_Stock_Price:  99.78583314409364
curr_Factors:  [99.78583314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04942443]
Stock Position:  -0.04942442631223188
Bond Position:  [34.74068217]


portfolio before change:  [29.84629587]
curr_Stock_Price:  99.11554933897155
curr_Factors:  [99.11554934]
mat_Sqrt:  [[0.15]]
grads:  [0.19352881]
Stock Position:  0.19352880672856032
Bond Position:  [10.66458188]


portfolio before change:  [29.97200956]
curr_Stock_Price:  99.75824712048245
curr_Factors:  [99.75824712]
mat_Sqrt:  [[0.15]]
grads:  [0.02405475]
Stock Position:  0.024054747098866368
Bond Position:  [27.57235015]


portfolio before change:  [29.98545203]
curr_Stock_Price:  100.17378718542193
curr_Factors:  [100.17378719]
mat_Sqrt:  [[0.15]]
grads:  [0.02867507]
Stock Position:  0.028675068709249907
Bond Position:  [27.1129618]


portfolio before change:  [29.95674402]
curr_Stock_Price:  99.05444062102755
curr_Factors:  [99.05444062]
mat_Sqrt:  [[0.15]]
grads:  [-0.17681319]
Stock Position:  -0.17681319161933465
Bond Position:  [47.47087581]


portfolio before change:  [30.04273532]
curr_Stock_Price:  98.60166290418066
curr_Factors:  [98.6016629]
mat_Sqrt:  [[0.15]]
grads:  [0.15627162]
Stock Position:  0.156271621572581
Bond Position:  [14.63409357]


portfolio before change:  [30.0833091]
curr_Stock_Price:  98.84959273023561
curr_Factors:  [98.84959273]
mat_Sqrt:  [[0.15]]
grads:  [0.13576178]
Stock Position:  0.1357617837754274
Bond Position:  [16.66331206]


portfolio before change:  [30.00943327]
curr_Stock_Price:  98.29009159560337
curr_Factors:  [98.2900916]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801777]
Stock Position:  -0.07801776901074226
Bond Position:  [37.67780693]


portfolio before change:  [30.0791647]
curr_Stock_Price:  97.45667364943816
curr_Factors:  [97.45667365]
mat_Sqrt:  [[0.15]]
grads:  [-0.06082786]
Stock Position:  -0.06082785708245441
Bond Position:  [36.00724531]


portfolio before change:  [30.00900532]
curr_Stock_Price:  98.68408104286777
curr_Factors:  [98.68408104]
mat_Sqrt:  [[0.15]]
grads:  [0.04213518]
Stock Position:  0.04213517764284826
Bond Position:  [25.85093404]


portfolio before change:  [30.02223096]
curr_Stock_Price:  98.92127164801684
curr_Factors:  [98.92127165]
mat_Sqrt:  [[0.15]]
grads:  [-0.07246595]
Stock Position:  -0.07246595471761794
Bond Position:  [37.19065535]


portfolio before change:  [30.06467212]
curr_Stock_Price:  98.39975722631324
curr_Factors:  [98.39975723]
mat_Sqrt:  [[0.15]]
grads:  [0.00403585]
Stock Position:  0.004035851438205747
Bond Position:  [29.66754532]


portfolio before change:  [30.06750345]
curr_Stock_Price:  98.18236754181572
curr_Factors:  [98.18236754]
mat_Sqrt:  [[0.15]]
grads:  [-0.04030341]
Stock Position:  -0.040303414419184655
Bond Position:  [34.02458809]


portfolio before change:  [30.08040125]
curr_Stock_Price:  97.96788289790355
curr_Factors:  [97.9678829]
mat_Sqrt:  [[0.15]]
grads:  [0.01696355]
Stock Position:  0.016963552013521795
Bond Position:  [28.41851797]


portfolio before change:  [30.09633016]
curr_Stock_Price:  98.69746930800066
curr_Factors:  [98.69746931]
mat_Sqrt:  [[0.15]]
grads:  [0.03366488]
Stock Position:  0.03366487912475831
Bond Position:  [26.77369179]


portfolio before change:  [30.09306]
curr_Stock_Price:  98.50091188420538
curr_Factors:  [98.50091188]
mat_Sqrt:  [[0.15]]
grads:  [-0.19255672]
Stock Position:  -0.19255672050008618
Bond Position:  [49.06007256]


portfolio before change:  [29.92439168]
curr_Stock_Price:  99.40870266163186
curr_Factors:  [99.40870266]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122925]
Stock Position:  -0.021229251393672047
Bond Position:  [32.03476402]


portfolio before change:  [29.94521836]
curr_Stock_Price:  98.61630133198831
curr_Factors:  [98.61630133]
mat_Sqrt:  [[0.15]]
grads:  [-0.07537192]
Stock Position:  -0.07537191969609437
Bond Position:  [37.37811831]


portfolio before change:  [30.01409336]
curr_Stock_Price:  97.76449285982989
curr_Factors:  [97.76449286]
mat_Sqrt:  [[0.15]]
grads:  [0.04375353]
Stock Position:  0.04375352702289165
Bond Position:  [25.73655198]


portfolio before change:  [30.03414502]
curr_Stock_Price:  98.14924803264837
curr_Factors:  [98.14924803]
mat_Sqrt:  [[0.15]]
grads:  [-0.04718565]
Stock Position:  -0.0471856462352554
Bond Position:  [34.66538072]


portfolio before change:  [29.99252136]
curr_Stock_Price:  99.12321175866458
curr_Factors:  [99.12321176]
mat_Sqrt:  [[0.15]]
grads:  [0.10290629]
Stock Position:  0.10290628719133443
Bond Position:  [19.79211966]


portfolio before change:  [30.02108104]
curr_Stock_Price:  99.37669981268378
curr_Factors:  [99.37669981]
mat_Sqrt:  [[0.15]]
grads:  [0.05302895]
Stock Position:  0.05302894576830099
Bond Position:  [24.75123942]


portfolio before change:  [30.00717001]
curr_Stock_Price:  99.05602347694087
curr_Factors:  [99.05602348]
mat_Sqrt:  [[0.15]]
grads:  [-0.04890863]
Stock Position:  -0.04890862945707838
Bond Position:  [34.85186436]


portfolio before change:  [30.04010844]
curr_Stock_Price:  98.47163430306571
curr_Factors:  [98.4716343]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985063]
Stock Position:  -0.01985062641247325
Bond Position:  [31.99483207]


portfolio before change:  [30.03143155]
curr_Stock_Price:  99.11022873967505
curr_Factors:  [99.11022874]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547861]
Stock Position:  -0.015478605458036938
Bond Position:  [31.56551967]


portfolio before change:  [30.03867017]
curr_Stock_Price:  98.89750392688198
curr_Factors:  [98.89750393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09437553]
Stock Position:  -0.09437552965419041
Bond Position:  [39.37217448]


portfolio before change:  [30.01371367]
curr_Stock_Price:  99.2140937264988
curr_Factors:  [99.21409373]
mat_Sqrt:  [[0.15]]
grads:  [-0.03222379]
Stock Position:  -0.032223789035120805
Bond Position:  [33.21076769]


portfolio before change:  [30.02791839]
curr_Stock_Price:  98.90211559570706
curr_Factors:  [98.9021156]
mat_Sqrt:  [[0.15]]
grads:  [0.09142427]
Stock Position:  0.0914242697936039
Bond Position:  [20.98586469]


portfolio before change:  [30.03953032]
curr_Stock_Price:  99.00043231819508
curr_Factors:  [99.00043232]
mat_Sqrt:  [[0.15]]
grads:  [-0.06245535]
Stock Position:  -0.06245534616446505
Bond Position:  [36.22263659]


portfolio before change:  [29.93474845]
curr_Stock_Price:  100.75064246475083
curr_Factors:  [100.75064246]
mat_Sqrt:  [[0.15]]
grads:  [-0.12440814]
Stock Position:  -0.1244081442396796
Bond Position:  [42.46894891]


portfolio before change:  [30.23790619]
curr_Stock_Price:  98.35651630934609
curr_Factors:  [98.35651631]
mat_Sqrt:  [[0.15]]
grads:  [-0.14826882]
Stock Position:  -0.14826882474997755
Bond Position:  [44.82111127]


portfolio before change:  [30.26367094]
curr_Stock_Price:  98.22053521649727
curr_Factors:  [98.22053522]
mat_Sqrt:  [[0.15]]
grads:  [0.25963425]
Stock Position:  0.25963424678078467
Bond Position:  [4.76225626]


portfolio before change:  [30.66212586]
curr_Stock_Price:  99.75292012537658
curr_Factors:  [99.75292013]
mat_Sqrt:  [[0.15]]
grads:  [0.02156499]
Stock Position:  0.021564988222303058
Bond Position:  [28.51095531]


portfolio before change:  [30.68188755]
curr_Stock_Price:  100.50402630550965
curr_Factors:  [100.50402631]
mat_Sqrt:  [[0.15]]
grads:  [0.06676293]
Stock Position:  0.06676292847360196
Bond Position:  [23.97194443]


portfolio before change:  [30.71523866]
curr_Stock_Price:  100.9586862249297
curr_Factors:  [100.95868622]
mat_Sqrt:  [[0.15]]
grads:  [0.05158528]
Stock Position:  0.05158527629847764
Bond Position:  [25.50725693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.77103601]
Stock Price:  101.9785265248533
PL:  [28.79250948]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.22417810e-02]
 [ 1.23187213e-02]
 [-1.48480213e-02]
 [-7.49987189e-03]
 [-3.82139302e-03]
 [ 5.26493088e-02]
 [ 3.50110857e-03]
 [ 1.04145816e-03]
 [-1.69658155e-02]
 [ 2.34379777e-02]
 [ 1.96531195e-02]
 [-1.22119229e-02]
 [-1.92234016e-03]
 [ 7.82125705e-03]
 [-1.00778674e-02]
 [ 7.06156411e-04]
 [-6.06987448e-03]
 [ 5.17663879e-04]
 [ 9.83666579e-04]
 [-1.76048931e-02]
 [-1.42331732e-02]
 [-2.10857294e-02]
 [ 4.97731833e-03]
 [-1.14091413e-02]
 [ 1.04329165e-02]
 [-2.45726689e-04]
 [ 2.91801157e-02]
 [-5.37756850e-03]
 [-4.69979060e-02]
 [-8.75550179e-03]
 [ 5.75826985e-02]
 [-6.57378994e-03]
 [-2.22856067e-02]
 [-7.16959306e-03]
 [-2.42297207e-02]
 [ 2.94242411e-02]
 [-1.09447383e-02]
 [-9.96719171e-03]
 [ 3.47725179e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.39747097]
curr_Stock_Price:  99.53160413623414
curr_Factors:  [99.53160414]
mat_Sqrt:  [[0.15]]
grads:  [-0.08161187]
Stock Position:  -0.08161187363373311
Bond Position:  [-0.27451027]


portfolio before change:  [-8.32503326]
curr_Stock_Price:  98.64359576302118
curr_Factors:  [98.64359576]
mat_Sqrt:  [[0.15]]
grads:  [0.08212481]
Stock Position:  0.08212480898087562
Bond Position:  [-16.42611972]


portfolio before change:  [-8.38860951]
curr_Stock_Price:  97.89445731092002
curr_Factors:  [97.89445731]
mat_Sqrt:  [[0.15]]
grads:  [-0.09898681]
Stock Position:  -0.09898680899498377
Bond Position:  [1.30165044]


portfolio before change:  [-8.44649583]
curr_Stock_Price:  98.48088932623392
curr_Factors:  [98.48088933]
mat_Sqrt:  [[0.15]]
grads:  [-0.04999915]
Stock Position:  -0.049999145915444965
Bond Position:  [-3.52253547]


portfolio before change:  [-8.36292547]
curr_Stock_Price:  96.8006466270026
curr_Factors:  [96.80064663]
mat_Sqrt:  [[0.15]]
grads:  [-0.02547595]
Stock Position:  -0.025475953465104173
Bond Position:  [-5.8968367]


portfolio before change:  [-8.36814667]
curr_Stock_Price:  96.97665786581919
curr_Factors:  [96.97665787]
mat_Sqrt:  [[0.15]]
grads:  [0.35099539]
Stock Position:  0.3509953918190083
Bond Position:  [-42.4065067]


portfolio before change:  [-8.5296219]
curr_Stock_Price:  96.53171162702687
curr_Factors:  [96.53171163]
mat_Sqrt:  [[0.15]]
grads:  [0.02334072]
Stock Position:  0.023340723794656022
Bond Position:  [-10.78274192]


portfolio before change:  [-8.50929986]
curr_Stock_Price:  97.46013035331728
curr_Factors:  [97.46013035]
mat_Sqrt:  [[0.15]]
grads:  [0.00694305]
Stock Position:  0.006943054419735982
Bond Position:  [-9.18597085]


portfolio before change:  [-8.5051105]
curr_Stock_Price:  98.22890954553826
curr_Factors:  [98.22890955]
mat_Sqrt:  [[0.15]]
grads:  [-0.11310544]
Stock Position:  -0.11310543697667551
Bond Position:  [2.60511323]


portfolio before change:  [-8.57660357]
curr_Stock_Price:  98.86388105647958
curr_Factors:  [98.86388106]
mat_Sqrt:  [[0.15]]
grads:  [0.15625318]
Stock Position:  0.1562531849089368
Bond Position:  [-24.02439986]


portfolio before change:  [-8.48431342]
curr_Stock_Price:  99.47374630962435
curr_Factors:  [99.47374631]
mat_Sqrt:  [[0.15]]
grads:  [0.1310208]
Stock Position:  0.13102079633445668
Bond Position:  [-21.51744288]


portfolio before change:  [-8.62394309]
curr_Stock_Price:  98.42857012859
curr_Factors:  [98.42857013]
mat_Sqrt:  [[0.15]]
grads:  [-0.08141282]
Stock Position:  -0.0814128193340323
Bond Position:  [-0.61059569]


portfolio before change:  [-8.59755887]
curr_Stock_Price:  98.10355313647845
curr_Factors:  [98.10355314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128156]
Stock Position:  -0.01281560105041819
Bond Position:  [-7.34030287]


portfolio before change:  [-8.59760047]
curr_Stock_Price:  98.03519954485805
curr_Factors:  [98.03519954]
mat_Sqrt:  [[0.15]]
grads:  [0.05214171]
Stock Position:  0.052141713694025794
Bond Position:  [-13.70932378]


portfolio before change:  [-8.54646899]
curr_Stock_Price:  99.04869244107626
curr_Factors:  [99.04869244]
mat_Sqrt:  [[0.15]]
grads:  [-0.06718578]
Stock Position:  -0.06718578250413362
Bond Position:  [-1.89180508]


portfolio before change:  [-8.45561304]
curr_Stock_Price:  97.69286343511425
curr_Factors:  [97.69286344]
mat_Sqrt:  [[0.15]]
grads:  [0.00470771]
Stock Position:  0.004707709405352383
Bond Position:  [-8.91552266]


portfolio before change:  [-8.45640439]
curr_Stock_Price:  97.76150807454982
curr_Factors:  [97.76150807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04046583]
Stock Position:  -0.0404658298407241
Bond Position:  [-4.50040384]


portfolio before change:  [-8.43302151]
curr_Stock_Price:  97.16976251565468
curr_Factors:  [97.16976252]
mat_Sqrt:  [[0.15]]
grads:  [0.00345109]
Stock Position:  0.003451092526874066
Bond Position:  [-8.76836335]


portfolio before change:  [-8.43574761]
curr_Stock_Price:  96.6974508688981
curr_Factors:  [96.69745087]
mat_Sqrt:  [[0.15]]
grads:  [0.00655778]
Stock Position:  0.006557777194654014
Bond Position:  [-9.06986795]


portfolio before change:  [-8.43528467]
curr_Stock_Price:  96.94093946645333
curr_Factors:  [96.94093947]
mat_Sqrt:  [[0.15]]
grads:  [-0.11736595]
Stock Position:  -0.11736595401137777
Bond Position:  [2.94228117]


portfolio before change:  [-8.27503108]
curr_Stock_Price:  95.57865531429401
curr_Factors:  [95.57865531]
mat_Sqrt:  [[0.15]]
grads:  [-0.09488782]
Stock Position:  -0.09488782140161675
Bond Position:  [0.79421929]


portfolio before change:  [-8.31060485]
curr_Stock_Price:  95.95460508191557
curr_Factors:  [95.95460508]
mat_Sqrt:  [[0.15]]
grads:  [-0.14057153]
Stock Position:  -0.14057152949767562
Bond Position:  [5.17788074]


portfolio before change:  [-8.29263244]
curr_Stock_Price:  95.83135724334042
curr_Factors:  [95.83135724]
mat_Sqrt:  [[0.15]]
grads:  [0.03318212]
Stock Position:  0.033182122218374833
Bond Position:  [-11.47252025]


portfolio before change:  [-8.31930706]
curr_Stock_Price:  95.07069284627778
curr_Factors:  [95.07069285]
mat_Sqrt:  [[0.15]]
grads:  [-0.07606094]
Stock Position:  -0.07606094220495034
Bond Position:  [-1.08814058]


portfolio before change:  [-8.2820211]
curr_Stock_Price:  94.57869286795987
curr_Factors:  [94.57869287]
mat_Sqrt:  [[0.15]]
grads:  [0.06955278]
Stock Position:  0.06955277656516745
Bond Position:  [-14.86023179]


portfolio before change:  [-8.23417953]
curr_Stock_Price:  95.29324693703032
curr_Factors:  [95.29324694]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163818]
Stock Position:  -0.00163817792659093
Bond Position:  [-8.07807223]


portfolio before change:  [-8.23394736]
curr_Stock_Price:  94.53509276825974
curr_Factors:  [94.53509277]
mat_Sqrt:  [[0.15]]
grads:  [0.1945341]
Stock Position:  0.19453410438796254
Bond Position:  [-26.62424696]


portfolio before change:  [-8.43842306]
curr_Stock_Price:  93.50109686107761
curr_Factors:  [93.50109686]
mat_Sqrt:  [[0.15]]
grads:  [-0.03585046]
Stock Position:  -0.035850456694438926
Bond Position:  [-5.08636604]


portfolio before change:  [-8.45225817]
curr_Stock_Price:  93.8692727149751
curr_Factors:  [93.86927271]
mat_Sqrt:  [[0.15]]
grads:  [-0.31331937]
Stock Position:  -0.3133193730138814
Bond Position:  [20.9588035]


portfolio before change:  [-8.55720027]
curr_Stock_Price:  94.21257134907277
curr_Factors:  [94.21257135]
mat_Sqrt:  [[0.15]]
grads:  [-0.05837001]
Stock Position:  -0.058370011916559196
Bond Position:  [-3.05801136]


portfolio before change:  [-8.4634887]
curr_Stock_Price:  92.60054764506319
curr_Factors:  [92.60054765]
mat_Sqrt:  [[0.15]]
grads:  [0.38388466]
Stock Position:  0.3838846567422292
Bond Position:  [-44.01141815]


portfolio before change:  [-8.55756666]
curr_Stock_Price:  92.36981117084767
curr_Factors:  [92.36981117]
mat_Sqrt:  [[0.15]]
grads:  [-0.04382527]
Stock Position:  -0.043825266299076564
Bond Position:  [-4.50943509]


portfolio before change:  [-8.58809853]
curr_Stock_Price:  93.05362106037416
curr_Factors:  [93.05362106]
mat_Sqrt:  [[0.15]]
grads:  [-0.14857071]
Stock Position:  -0.14857071160442253
Bond Position:  [5.23694417]


portfolio before change:  [-8.48716391]
curr_Stock_Price:  92.37865655025567
curr_Factors:  [92.37865655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04779729]
Stock Position:  -0.04779728709082236
Bond Position:  [-4.07171475]


portfolio before change:  [-8.50692587]
curr_Stock_Price:  92.78146099816342
curr_Factors:  [92.781461]
mat_Sqrt:  [[0.15]]
grads:  [-0.16153147]
Stock Position:  -0.16153147108835778
Bond Position:  [6.48020002]


portfolio before change:  [-8.42975189]
curr_Stock_Price:  92.30871161411098
curr_Factors:  [92.30871161]
mat_Sqrt:  [[0.15]]
grads:  [0.19616161]
Stock Position:  0.19616160756982912
Bond Position:  [-26.53717715]


portfolio before change:  [-8.32055872]
curr_Stock_Price:  92.88227197613611
curr_Factors:  [92.88227198]
mat_Sqrt:  [[0.15]]
grads:  [-0.07296492]
Stock Position:  -0.07296492184174211
Bond Position:  [-1.54341101]


portfolio before change:  [-8.3128825]
curr_Stock_Price:  92.77442337073289
curr_Factors:  [92.77442337]
mat_Sqrt:  [[0.15]]
grads:  [-0.06644794]
Stock Position:  -0.0664479447293842
Bond Position:  [-2.14821274]


portfolio before change:  [-8.35981575]
curr_Stock_Price:  93.47669807293605
curr_Factors:  [93.47669807]
mat_Sqrt:  [[0.15]]
grads:  [0.23181679]
Stock Position:  0.23181678572224196
Bond Position:  [-30.02928344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.64043416]
Stock Price:  92.28237336058561
PL:  [-8.64043416]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.10487877e-03]
 [-2.16676570e-03]
 [-1.71047231e-02]
 [-7.22674519e-03]
 [-7.45054863e-03]
 [ 3.07180023e-02]
 [ 3.69556703e-03]
 [ 2.84354671e-03]
 [-2.48769722e-02]
 [ 2.34400214e-02]
 [ 2.06242332e-02]
 [-1.30428270e-02]
 [ 1.48665528e-02]
 [ 6.36491905e-03]
 [-1.60392530e-02]
 [ 6.15059563e-04]
 [-6.09757881e-03]
 [-6.39798203e-04]
 [ 1.15097225e-03]
 [-2.33425416e-02]
 [-1.03083115e-02]
 [-1.73664965e-02]
 [ 6.20049520e-03]
 [-9.02971254e-03]
 [ 1.33476720e-02]
 [ 2.86783482e-03]
 [ 1.87273285e-02]
 [-4.14250941e-03]
 [-1.24883238e-02]
 [-1.44658088e-02]
 [-1.03678406e-02]
 [ 1.88381770e-02]
 [-5.54545644e-03]
 [-2.37886351e-02]
 [-2.13444381e-02]
 [ 3.10305904e-02]
 [ 3.15224646e-03]
 [ 7.66089949e-03]
 [ 4.88422106e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.9191009]
curr_Stock_Price:  99.18902359268121
curr_Factors:  [99.18902359]
mat_Sqrt:  [[0.15]]
grads:  [-0.00736586]
Stock Position:  -0.007365858462962302
Bond Position:  [-15.18848859]


portfolio before change:  [-15.91225953]
curr_Stock_Price:  98.00246211229556
curr_Factors:  [98.00246211]
mat_Sqrt:  [[0.15]]
grads:  [-0.0144451]
Stock Position:  -0.014445104663776086
Bond Position:  [-14.49660371]


portfolio before change:  [-15.92365473]
curr_Stock_Price:  98.66587055061534
curr_Factors:  [98.66587055]
mat_Sqrt:  [[0.15]]
grads:  [-0.11403149]
Stock Position:  -0.11403148756805977
Bond Position:  [-4.67263874]


portfolio before change:  [-15.94431341]
curr_Stock_Price:  98.84191459740227
curr_Factors:  [98.8419146]
mat_Sqrt:  [[0.15]]
grads:  [-0.0481783]
Stock Position:  -0.0481783012831375
Bond Position:  [-11.18227787]


portfolio before change:  [-15.98523627]
curr_Stock_Price:  99.66230446362498
curr_Factors:  [99.66230446]
mat_Sqrt:  [[0.15]]
grads:  [-0.04967032]
Stock Position:  -0.04967032418338446
Bond Position:  [-11.0349773]


portfolio before change:  [-16.06345056]
curr_Stock_Price:  101.20920061635178
curr_Factors:  [101.20920062]
mat_Sqrt:  [[0.15]]
grads:  [0.20478668]
Stock Position:  0.20478668171269268
Bond Position:  [-36.78974692]


portfolio before change:  [-16.24379573]
curr_Stock_Price:  100.35100925143173
curr_Factors:  [100.35100925]
mat_Sqrt:  [[0.15]]
grads:  [0.02463711]
Stock Position:  0.02463711354515775
Bond Position:  [-18.71615494]


portfolio before change:  [-16.25594305]
curr_Stock_Price:  99.95292484125326
curr_Factors:  [99.95292484]
mat_Sqrt:  [[0.15]]
grads:  [0.01895698]
Stock Position:  0.018956978062375104
Bond Position:  [-18.15074845]


portfolio before change:  [-16.27798717]
curr_Stock_Price:  98.90976601170851
curr_Factors:  [98.90976601]
mat_Sqrt:  [[0.15]]
grads:  [-0.16584648]
Stock Position:  -0.16584648159404608
Bond Position:  [0.12584952]


portfolio before change:  [-16.25919021]
curr_Stock_Price:  98.79652132014498
curr_Factors:  [98.79652132]
mat_Sqrt:  [[0.15]]
grads:  [0.15626681]
Stock Position:  0.15626680900436168
Bond Position:  [-31.69780733]


portfolio before change:  [-16.28171668]
curr_Stock_Price:  98.67772448878253
curr_Factors:  [98.67772449]
mat_Sqrt:  [[0.15]]
grads:  [0.13749489]
Stock Position:  0.13749488818297306
Bond Position:  [-29.84939938]


portfolio before change:  [-16.288663]
curr_Stock_Price:  98.65434245366475
curr_Factors:  [98.65434245]
mat_Sqrt:  [[0.15]]
grads:  [-0.08695218]
Stock Position:  -0.08695217990912842
Bond Position:  [-7.71045287]


portfolio before change:  [-16.34992133]
curr_Stock_Price:  99.347763397926
curr_Factors:  [99.3477634]
mat_Sqrt:  [[0.15]]
grads:  [0.09911035]
Stock Position:  0.09911035188271787
Bond Position:  [-26.19631312]


portfolio before change:  [-16.38989189]
curr_Stock_Price:  98.97751131863326
curr_Factors:  [98.97751132]
mat_Sqrt:  [[0.15]]
grads:  [0.04243279]
Stock Position:  0.04243279367933712
Bond Position:  [-20.5897842]


portfolio before change:  [-16.43014118]
curr_Stock_Price:  98.08962714788856
curr_Factors:  [98.08962715]
mat_Sqrt:  [[0.15]]
grads:  [-0.10692835]
Stock Position:  -0.10692835348034407
Bond Position:  [-5.94157885]


portfolio before change:  [-16.36737757]
curr_Stock_Price:  97.49571213155053
curr_Factors:  [97.49571213]
mat_Sqrt:  [[0.15]]
grads:  [0.0041004]
Stock Position:  0.004100397089280049
Bond Position:  [-16.7671487]


portfolio before change:  [-16.37034614]
curr_Stock_Price:  97.28291515375601
curr_Factors:  [97.28291515]
mat_Sqrt:  [[0.15]]
grads:  [-0.04065053]
Stock Position:  -0.04065052539119254
Bond Position:  [-12.41574453]


portfolio before change:  [-16.34877104]
curr_Stock_Price:  96.71398855378796
curr_Factors:  [96.71398855]
mat_Sqrt:  [[0.15]]
grads:  [-0.00426532]
Stock Position:  -0.0042653213522451825
Bond Position:  [-15.9362548]


portfolio before change:  [-16.34920575]
curr_Stock_Price:  96.34884639144524
curr_Factors:  [96.34884639]
mat_Sqrt:  [[0.15]]
grads:  [0.00767315]
Stock Position:  0.007673148316602342
Bond Position:  [-17.08850474]


portfolio before change:  [-16.34311106]
curr_Stock_Price:  97.42153320524282
curr_Factors:  [97.42153321]
mat_Sqrt:  [[0.15]]
grads:  [-0.15561694]
Stock Position:  -0.1556169439936632
Bond Position:  [-1.18266978]


portfolio before change:  [-16.19703234]
curr_Stock_Price:  96.48187613811884
curr_Factors:  [96.48187614]
mat_Sqrt:  [[0.15]]
grads:  [-0.06872208]
Stock Position:  -0.06872207680433715
Bond Position:  [-9.56659744]


portfolio before change:  [-16.25853546]
curr_Stock_Price:  97.3594283944239
curr_Factors:  [97.35942839]
mat_Sqrt:  [[0.15]]
grads:  [-0.11577664]
Stock Position:  -0.11577664343614236
Bond Position:  [-4.98658763]


portfolio before change:  [-16.24866464]
curr_Stock_Price:  97.26878677929317
curr_Factors:  [97.26878678]
mat_Sqrt:  [[0.15]]
grads:  [0.04133663]
Stock Position:  0.041336634692017864
Bond Position:  [-20.26942894]


portfolio before change:  [-16.25170575]
curr_Stock_Price:  97.25651490039344
curr_Factors:  [97.2565149]
mat_Sqrt:  [[0.15]]
grads:  [-0.06019808]
Stock Position:  -0.06019808361201771
Bond Position:  [-10.39704994]


portfolio before change:  [-16.27740809]
curr_Stock_Price:  97.66188705024614
curr_Factors:  [97.66188705]
mat_Sqrt:  [[0.15]]
grads:  [0.08898448]
Stock Position:  0.08898447985583255
Bond Position:  [-24.96780031]


portfolio before change:  [-16.36162521]
curr_Stock_Price:  96.75053767412415
curr_Factors:  [96.75053767]
mat_Sqrt:  [[0.15]]
grads:  [0.0191189]
Stock Position:  0.01911889877662763
Bond Position:  [-18.21138895]


portfolio before change:  [-16.36992274]
curr_Stock_Price:  96.43561576652316
curr_Factors:  [96.43561577]
mat_Sqrt:  [[0.15]]
grads:  [0.12484886]
Stock Position:  0.1248488565603755
Bond Position:  [-28.4097991]


portfolio before change:  [-16.3826904]
curr_Stock_Price:  96.36179677500142
curr_Factors:  [96.36179678]
mat_Sqrt:  [[0.15]]
grads:  [-0.02761673]
Stock Position:  -0.0276167294277479
Bond Position:  [-13.72149273]


portfolio before change:  [-16.42468459]
curr_Stock_Price:  97.82029298943667
curr_Factors:  [97.82029299]
mat_Sqrt:  [[0.15]]
grads:  [-0.08325549]
Stock Position:  -0.08325549221956063
Bond Position:  [-8.28060795]


portfolio before change:  [-16.50171965]
curr_Stock_Price:  98.7331446751166
curr_Factors:  [98.73314468]
mat_Sqrt:  [[0.15]]
grads:  [-0.09643873]
Stock Position:  -0.09643872508713058
Bond Position:  [-6.98002105]


portfolio before change:  [-16.58094011]
curr_Stock_Price:  99.54555589105331
curr_Factors:  [99.54555589]
mat_Sqrt:  [[0.15]]
grads:  [-0.06911894]
Stock Position:  -0.06911893721809732
Bond Position:  [-9.70045708]


portfolio before change:  [-16.65447196]
curr_Stock_Price:  100.59185702557382
curr_Factors:  [100.59185703]
mat_Sqrt:  [[0.15]]
grads:  [0.12558785]
Stock Position:  0.12558784663285408
Bond Position:  [-29.28758667]


portfolio before change:  [-16.66317428]
curr_Stock_Price:  100.5517166606209
curr_Factors:  [100.55171666]
mat_Sqrt:  [[0.15]]
grads:  [-0.03696971]
Stock Position:  -0.0369697095862055
Bond Position:  [-12.94580652]


portfolio before change:  [-16.6426885]
curr_Stock_Price:  99.95381883093472
curr_Factors:  [99.95381883]
mat_Sqrt:  [[0.15]]
grads:  [-0.1585909]
Stock Position:  -0.1585909008780749
Bond Position:  [-0.79092232]


portfolio before change:  [-16.69899825]
curr_Stock_Price:  100.30825834659089
curr_Factors:  [100.30825835]
mat_Sqrt:  [[0.15]]
grads:  [-0.14229625]
Stock Position:  -0.14229625375134436
Bond Position:  [-2.42550887]


portfolio before change:  [-16.6118924]
curr_Stock_Price:  99.69398312057342
curr_Factors:  [99.69398312]
mat_Sqrt:  [[0.15]]
grads:  [0.2068706]
Stock Position:  0.20687060249533878
Bond Position:  [-37.23564675]


portfolio before change:  [-16.62226735]
curr_Stock_Price:  99.66633199270576
curr_Factors:  [99.66633199]
mat_Sqrt:  [[0.15]]
grads:  [0.02101498]
Stock Position:  0.021014976408757574
Bond Position:  [-18.71675296]


portfolio before change:  [-16.64108026]
curr_Stock_Price:  98.88245432949154
curr_Factors:  [98.88245433]
mat_Sqrt:  [[0.15]]
grads:  [0.05107266]
Stock Position:  0.05107266328658089
Bond Position:  [-21.69127055]


portfolio before change:  [-16.63000695]
curr_Stock_Price:  99.15236163316895
curr_Factors:  [99.15236163]
mat_Sqrt:  [[0.15]]
grads:  [0.03256147]
Stock Position:  0.03256147372724573
Bond Position:  [-19.85855397]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.66024642]
Stock Price:  98.2999127287471
PL:  [-16.66024642]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 4.60750653e-03]
 [ 3.25651129e-02]
 [-3.48567014e-03]
 [ 1.70861998e-03]
 [-1.15879812e-03]
 [ 2.18698778e-02]
 [ 3.66606070e-03]
 [ 7.13408141e-03]
 [-1.61158023e-02]
 [ 2.30429021e-02]
 [ 2.00870912e-02]
 [-1.39067819e-02]
 [ 3.18214607e-02]
 [ 1.55400665e-02]
 [ 7.73837358e-03]
 [-3.06246572e-03]
 [-5.50869690e-03]
 [ 7.46175442e-03]
 [ 1.78823528e-02]
 [ 1.49598634e-02]
 [ 9.15373088e-04]
 [-1.01470564e-02]
 [ 5.34318824e-03]
 [-8.62899480e-03]
 [-6.24632121e-03]
 [ 4.53191027e-03]
 [ 6.81436648e-03]
 [ 3.09600138e-03]
 [ 5.16273965e-03]
 [-5.98855347e-03]
 [-1.90851381e-02]
 [ 1.49903892e-02]
 [-2.67588409e-03]
 [-1.96979093e-02]
 [-2.04060667e-02]
 [ 1.74323381e-02]
 [ 5.04743384e-03]
 [ 1.18436525e-02]
 [ 9.17854068e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.42408079]
curr_Stock_Price:  99.07493164974596
curr_Factors:  [99.07493165]
mat_Sqrt:  [[0.15]]
grads:  [0.03071671]
Stock Position:  0.030716710179041
Bond Position:  [-21.46733675]


portfolio before change:  [-18.41323836]
curr_Stock_Price:  99.51527875008554
curr_Factors:  [99.51527875]
mat_Sqrt:  [[0.15]]
grads:  [0.21710075]
Stock Position:  0.21710075256339326
Bond Position:  [-40.01808027]


portfolio before change:  [-18.13772476]
curr_Stock_Price:  100.8073800887471
curr_Factors:  [100.80738009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0232378]
Stock Position:  -0.02323780092988419
Bond Position:  [-15.79518293]


portfolio before change:  [-18.17138388]
curr_Stock_Price:  102.17087398812356
curr_Factors:  [102.17087399]
mat_Sqrt:  [[0.15]]
grads:  [0.0113908]
Stock Position:  0.01139079987493764
Bond Position:  [-19.33519186]


portfolio before change:  [-18.17415576]
curr_Stock_Price:  102.13972359521014
curr_Factors:  [102.1397236]
mat_Sqrt:  [[0.15]]
grads:  [-0.00772532]
Stock Position:  -0.007725320828499931
Bond Position:  [-17.38509362]


portfolio before change:  [-18.17353081]
curr_Stock_Price:  101.7775098308545
curr_Factors:  [101.77750983]
mat_Sqrt:  [[0.15]]
grads:  [0.14579919]
Stock Position:  0.14579918557218932
Bond Position:  [-33.01260886]


portfolio before change:  [-18.24197545]
curr_Stock_Price:  101.3363701716494
curr_Factors:  [101.33637017]
mat_Sqrt:  [[0.15]]
grads:  [0.0244404]
Stock Position:  0.024440404653064074
Bond Position:  [-20.71867734]


portfolio before change:  [-18.25034223]
curr_Stock_Price:  101.1000083039173
curr_Factors:  [101.1000083]
mat_Sqrt:  [[0.15]]
grads:  [0.04756054]
Stock Position:  0.04756054272799885
Bond Position:  [-23.05871349]


portfolio before change:  [-18.24595354]
curr_Stock_Price:  101.25289142568909
curr_Factors:  [101.25289143]
mat_Sqrt:  [[0.15]]
grads:  [-0.10743868]
Stock Position:  -0.10743868186090268
Bond Position:  [-7.36747635]


portfolio before change:  [-18.27010926]
curr_Stock_Price:  101.46915174185638
curr_Factors:  [101.46915174]
mat_Sqrt:  [[0.15]]
grads:  [0.15361935]
Stock Position:  0.15361934762485505
Bond Position:  [-33.85773415]


portfolio before change:  [-18.27809527]
curr_Stock_Price:  101.44471775214666
curr_Factors:  [101.44471775]
mat_Sqrt:  [[0.15]]
grads:  [0.13391394]
Stock Position:  0.1339139416586521
Bond Position:  [-31.86295729]


portfolio before change:  [-18.36186539]
curr_Stock_Price:  100.8489097613566
curr_Factors:  [100.84890976]
mat_Sqrt:  [[0.15]]
grads:  [-0.09271188]
Stock Position:  -0.09271187952377002
Bond Position:  [-9.01197341]


portfolio before change:  [-18.35603711]
curr_Stock_Price:  100.77389413697195
curr_Factors:  [100.77389414]
mat_Sqrt:  [[0.15]]
grads:  [0.21214307]
Stock Position:  0.2121430716466298
Bond Position:  [-39.73452056]


portfolio before change:  [-18.26801787]
curr_Stock_Price:  101.21221327253433
curr_Factors:  [101.21221327]
mat_Sqrt:  [[0.15]]
grads:  [0.10360044]
Stock Position:  0.10360044309006929
Bond Position:  [-28.75364801]


portfolio before change:  [-18.34741041]
curr_Stock_Price:  100.48057448096651
curr_Factors:  [100.48057448]
mat_Sqrt:  [[0.15]]
grads:  [0.05158916]
Stock Position:  0.05158915720758688
Bond Position:  [-23.53111856]


portfolio before change:  [-18.29079418]
curr_Stock_Price:  101.63503798669016
curr_Factors:  [101.63503799]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041644]
Stock Position:  -0.020416438156474967
Bond Position:  [-16.21576871]


portfolio before change:  [-18.30519227]
curr_Stock_Price:  102.24097101238486
curr_Factors:  [102.24097101]
mat_Sqrt:  [[0.15]]
grads:  [-0.03672465]
Stock Position:  -0.036724645991892436
Bond Position:  [-14.55042881]


portfolio before change:  [-18.33207903]
curr_Stock_Price:  102.92356018154783
curr_Factors:  [102.92356018]
mat_Sqrt:  [[0.15]]
grads:  [0.04974503]
Stock Position:  0.049745029494920205
Bond Position:  [-23.45201457]


portfolio before change:  [-18.32097332]
curr_Stock_Price:  103.20574722045075
curr_Factors:  [103.20574722]
mat_Sqrt:  [[0.15]]
grads:  [0.11921569]
Stock Position:  0.11921568537315144
Bond Position:  [-30.62471721]


portfolio before change:  [-18.35189109]
curr_Stock_Price:  102.97851666382354
curr_Factors:  [102.97851666]
mat_Sqrt:  [[0.15]]
grads:  [0.09973242]
Stock Position:  0.09973242252783841
Bond Position:  [-28.62218803]


portfolio before change:  [-18.27815316]
curr_Stock_Price:  103.7537502658086
curr_Factors:  [103.75375027]
mat_Sqrt:  [[0.15]]
grads:  [0.00610249]
Stock Position:  0.006102487252112532
Bond Position:  [-18.9113091]


portfolio before change:  [-18.27567332]
curr_Stock_Price:  104.5475099112484
curr_Factors:  [104.54750991]
mat_Sqrt:  [[0.15]]
grads:  [-0.06764704]
Stock Position:  -0.06764704258026359
Bond Position:  [-11.20334346]


portfolio before change:  [-18.25328886]
curr_Stock_Price:  104.19590596138218
curr_Factors:  [104.19590596]
mat_Sqrt:  [[0.15]]
grads:  [0.03562125]
Stock Position:  0.03562125493313594
Bond Position:  [-21.96487779]


portfolio before change:  [-18.23390121]
curr_Stock_Price:  104.81726041818324
curr_Factors:  [104.81726042]
mat_Sqrt:  [[0.15]]
grads:  [-0.05752663]
Stock Position:  -0.05752663197085875
Bond Position:  [-12.20411725]


portfolio before change:  [-18.25007523]
curr_Stock_Price:  105.07189746194626
curr_Factors:  [105.07189746]
mat_Sqrt:  [[0.15]]
grads:  [-0.04164214]
Stock Position:  -0.04164214138311746
Bond Position:  [-13.87465642]


portfolio before change:  [-18.23448898]
curr_Stock_Price:  104.6559560977747
curr_Factors:  [104.6559561]
mat_Sqrt:  [[0.15]]
grads:  [0.03021274]
Stock Position:  0.030212735101413212
Bond Position:  [-21.39643166]


portfolio before change:  [-18.21918983]
curr_Stock_Price:  105.25086680232434
curr_Factors:  [105.2508668]
mat_Sqrt:  [[0.15]]
grads:  [0.04542911]
Stock Position:  0.04542910986777912
Bond Position:  [-23.00064302]


portfolio before change:  [-18.17890721]
curr_Stock_Price:  106.20087173800788
curr_Factors:  [106.20087174]
mat_Sqrt:  [[0.15]]
grads:  [0.02064001]
Stock Position:  0.020640009207810155
Bond Position:  [-20.37089418]


portfolio before change:  [-18.22041806]
curr_Stock_Price:  104.31306592247344
curr_Factors:  [104.31306592]
mat_Sqrt:  [[0.15]]
grads:  [0.03441826]
Stock Position:  0.034418264349308544
Bond Position:  [-21.81069274]


portfolio before change:  [-18.27144583]
curr_Stock_Price:  102.90970436122538
curr_Factors:  [102.90970436]
mat_Sqrt:  [[0.15]]
grads:  [-0.03992369]
Stock Position:  -0.03992368979423418
Bond Position:  [-14.16291072]


portfolio before change:  [-18.26137922]
curr_Stock_Price:  102.61321147175204
curr_Factors:  [102.61321147]
mat_Sqrt:  [[0.15]]
grads:  [-0.12723425]
Stock Position:  -0.12723425432516125
Bond Position:  [-5.20546377]


portfolio before change:  [-18.18031695]
curr_Stock_Price:  101.97098669410316
curr_Factors:  [101.97098669]
mat_Sqrt:  [[0.15]]
grads:  [0.09993593]
Stock Position:  0.09993592802948792
Bond Position:  [-28.37088214]


portfolio before change:  [-18.12184074]
curr_Stock_Price:  102.59161232264671
curr_Factors:  [102.59161232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01783923]
Stock Position:  -0.01783922725909059
Bond Position:  [-16.29168565]


portfolio before change:  [-18.11211223]
curr_Stock_Price:  101.93210553295043
curr_Factors:  [101.93210553]
mat_Sqrt:  [[0.15]]
grads:  [-0.1313194]
Stock Position:  -0.13131939521962502
Bond Position:  [-4.72644978]


portfolio before change:  [-18.16306934]
curr_Stock_Price:  102.31564573075451
curr_Factors:  [102.31564573]
mat_Sqrt:  [[0.15]]
grads:  [-0.13604044]
Stock Position:  -0.1360404446591286
Bond Position:  [-4.2440034]


portfolio before change:  [-18.28876698]
curr_Stock_Price:  103.23571843657672
curr_Factors:  [103.23571844]
mat_Sqrt:  [[0.15]]
grads:  [0.11621559]
Stock Position:  0.11621558739634659
Bond Position:  [-30.28636663]


portfolio before change:  [-18.47355616]
curr_Stock_Price:  101.67824100896898
curr_Factors:  [101.67824101]
mat_Sqrt:  [[0.15]]
grads:  [0.03364956]
Stock Position:  0.033649558921329044
Bond Position:  [-21.89498412]


portfolio before change:  [-18.50019578]
curr_Stock_Price:  100.96790270850792
curr_Factors:  [100.96790271]
mat_Sqrt:  [[0.15]]
grads:  [0.07895768]
Stock Position:  0.07895768301007978
Bond Position:  [-26.47238743]


portfolio before change:  [-18.42986844]
curr_Stock_Price:  101.90051098955007
curr_Factors:  [101.90051099]
mat_Sqrt:  [[0.15]]
grads:  [0.06119027]
Stock Position:  0.06119027121785048
Bond Position:  [-24.66518835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.52071352]
Stock Price:  100.46626769241576
PL:  [-18.98698121]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.42715214e-02]
 [ 4.05083246e-02]
 [-3.42594362e-03]
 [-1.54261832e-03]
 [-7.40274521e-03]
 [ 2.79074764e-02]
 [ 3.63474423e-03]
 [ 6.12367786e-03]
 [-2.74092234e-02]
 [ 2.34056680e-02]
 [ 1.91559127e-02]
 [-1.52282665e-02]
 [ 1.41723040e-02]
 [ 6.38417750e-03]
 [-1.14968505e-02]
 [-2.28181364e-04]
 [-6.02301472e-03]
 [ 3.80967385e-03]
 [ 5.59454564e-03]
 [-1.70710086e-02]
 [-3.00730820e-03]
 [-4.57039520e-03]
 [ 7.14182287e-03]
 [-6.42356067e-03]
 [ 1.45348848e-02]
 [ 3.82234854e-03]
 [ 5.16930529e-03]
 [-3.14358296e-03]
 [-4.40953785e-03]
 [-9.50230040e-03]
 [-1.94042543e-02]
 [ 1.52178859e-02]
 [-3.45410122e-03]
 [-2.82209923e-02]
 [-2.17389505e-02]
 [ 3.51941980e-02]
 [ 3.16118146e-03]
 [ 9.13499732e-03]
 [ 5.93445639e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.28922089]
curr_Stock_Price:  100.7015315253996
curr_Factors:  [100.70153153]
mat_Sqrt:  [[0.15]]
grads:  [-0.22847681]
Stock Position:  -0.22847680914136342
Bond Position:  [40.29718549]


portfolio before change:  [17.46604089]
curr_Stock_Price:  99.94967166134619
curr_Factors:  [99.94967166]
mat_Sqrt:  [[0.15]]
grads:  [0.2700555]
Stock Position:  0.2700554970803617
Bond Position:  [-9.52591737]


portfolio before change:  [17.71888006]
curr_Stock_Price:  100.89033010073796
curr_Factors:  [100.8903301]
mat_Sqrt:  [[0.15]]
grads:  [-0.02283962]
Stock Position:  -0.022839624148579808
Bond Position:  [20.02317728]


portfolio before change:  [17.70587813]
curr_Stock_Price:  101.56919369861804
curr_Factors:  [101.5691937]
mat_Sqrt:  [[0.15]]
grads:  [-0.01028412]
Stock Position:  -0.010284122145978375
Bond Position:  [18.75042812]


portfolio before change:  [17.72674474]
curr_Stock_Price:  99.76810078807557
curr_Factors:  [99.76810079]
mat_Sqrt:  [[0.15]]
grads:  [-0.04935163]
Stock Position:  -0.04935163473370118
Bond Position:  [22.65046361]


portfolio before change:  [17.74382459]
curr_Stock_Price:  99.47938960235565
curr_Factors:  [99.4793896]
mat_Sqrt:  [[0.15]]
grads:  [0.18604984]
Stock Position:  0.1860498424443639
Bond Position:  [-0.76430017]


portfolio before change:  [17.82748132]
curr_Stock_Price:  99.929550011634
curr_Factors:  [99.92955001]
mat_Sqrt:  [[0.15]]
grads:  [0.02423163]
Stock Position:  0.024231628222984053
Bond Position:  [15.40602562]


portfolio before change:  [17.85297066]
curr_Stock_Price:  100.90197615092583
curr_Factors:  [100.90197615]
mat_Sqrt:  [[0.15]]
grads:  [0.04082452]
Stock Position:  0.040824519051556964
Bond Position:  [13.73369602]


portfolio before change:  [17.8122616]
curr_Stock_Price:  99.8627505812405
curr_Factors:  [99.86275058]
mat_Sqrt:  [[0.15]]
grads:  [-0.18272816]
Stock Position:  -0.182728155741335
Bond Position:  [36.05999784]


portfolio before change:  [17.89458361]
curr_Stock_Price:  99.43690363887328
curr_Factors:  [99.43690364]
mat_Sqrt:  [[0.15]]
grads:  [0.15603779]
Stock Position:  0.15603778691228665
Bond Position:  [2.37866922]


portfolio before change:  [18.00352947]
curr_Stock_Price:  100.1331997681403
curr_Factors:  [100.13319977]
mat_Sqrt:  [[0.15]]
grads:  [0.12770608]
Stock Position:  0.1277060847628823
Bond Position:  [5.21591057]


portfolio before change:  [17.92763052]
curr_Stock_Price:  99.53376886526571
curr_Factors:  [99.53376887]
mat_Sqrt:  [[0.15]]
grads:  [-0.10152178]
Stock Position:  -0.10152177655470225
Bond Position:  [28.03247556]


portfolio before change:  [17.95744442]
curr_Stock_Price:  99.27461642186807
curr_Factors:  [99.27461642]
mat_Sqrt:  [[0.15]]
grads:  [0.09448203]
Stock Position:  0.09448202673142071
Bond Position:  [8.57777745]


portfolio before change:  [17.9395994]
curr_Stock_Price:  99.07439522171293
curr_Factors:  [99.07439522]
mat_Sqrt:  [[0.15]]
grads:  [0.04256118]
Stock Position:  0.042561183308870966
Bond Position:  [13.7228759]


portfolio before change:  [17.93050483]
curr_Stock_Price:  98.82040701135341
curr_Factors:  [98.82040701]
mat_Sqrt:  [[0.15]]
grads:  [-0.07664567]
Stock Position:  -0.07664567012392029
Bond Position:  [25.50466115]


portfolio before change:  [17.93610934]
curr_Stock_Price:  98.7888822776853
curr_Factors:  [98.78888228]
mat_Sqrt:  [[0.15]]
grads:  [-0.00152121]
Stock Position:  -0.0015212090937342447
Bond Position:  [18.08638789]


portfolio before change:  [17.93877797]
curr_Stock_Price:  98.52087820506725
curr_Factors:  [98.52087821]
mat_Sqrt:  [[0.15]]
grads:  [-0.04015343]
Stock Position:  -0.04015343144404919
Bond Position:  [21.8947293]


portfolio before change:  [17.92234937]
curr_Stock_Price:  98.9981876524995
curr_Factors:  [98.99818765]
mat_Sqrt:  [[0.15]]
grads:  [0.02539783]
Stock Position:  0.02539782566914497
Bond Position:  [15.40801066]


portfolio before change:  [17.93114726]
curr_Stock_Price:  99.26875287998018
curr_Factors:  [99.26875288]
mat_Sqrt:  [[0.15]]
grads:  [0.03729697]
Stock Position:  0.037296970942816865
Bond Position:  [14.22872347]


portfolio before change:  [17.94320363]
curr_Stock_Price:  99.54431576403904
curr_Factors:  [99.54431576]
mat_Sqrt:  [[0.15]]
grads:  [-0.11380672]
Stock Position:  -0.11380672428861593
Bond Position:  [29.27201613]


portfolio before change:  [17.96909179]
curr_Stock_Price:  99.3489939831669
curr_Factors:  [99.34899398]
mat_Sqrt:  [[0.15]]
grads:  [-0.02004872]
Stock Position:  -0.020048721363530947
Bond Position:  [19.96091209]


portfolio before change:  [17.94909359]
curr_Stock_Price:  100.47093419671077
curr_Factors:  [100.4709342]
mat_Sqrt:  [[0.15]]
grads:  [-0.0304693]
Stock Position:  -0.030469301335816348
Bond Position:  [21.01037276]


portfolio before change:  [17.98377738]
curr_Stock_Price:  99.4188153984629
curr_Factors:  [99.4188154]
mat_Sqrt:  [[0.15]]
grads:  [0.04761215]
Stock Position:  0.04761215247881051
Bond Position:  [13.25023358]


portfolio before change:  [17.95636019]
curr_Stock_Price:  98.80818189623513
curr_Factors:  [98.8081819]
mat_Sqrt:  [[0.15]]
grads:  [-0.04282374]
Stock Position:  -0.04282373778237719
Bond Position:  [22.18769586]


portfolio before change:  [17.97527395]
curr_Stock_Price:  98.43128517607846
curr_Factors:  [98.43128518]
mat_Sqrt:  [[0.15]]
grads:  [0.09689923]
Stock Position:  0.09689923177484405
Bond Position:  [8.43735803]


portfolio before change:  [17.85242748]
curr_Stock_Price:  97.15262488495507
curr_Factors:  [97.15262488]
mat_Sqrt:  [[0.15]]
grads:  [0.02548232]
Stock Position:  0.025482323619943067
Bond Position:  [15.37675286]


portfolio before change:  [17.87294312]
curr_Stock_Price:  97.88228445537132
curr_Factors:  [97.88228446]
mat_Sqrt:  [[0.15]]
grads:  [0.03446204]
Stock Position:  0.034462035298015996
Bond Position:  [14.49972038]


portfolio before change:  [17.88338517]
curr_Stock_Price:  98.13268950892794
curr_Factors:  [98.13268951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095722]
Stock Position:  -0.02095721972887537
Bond Position:  [19.9399735]


portfolio before change:  [17.87007765]
curr_Stock_Price:  98.88661453553243
curr_Factors:  [98.88661454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02939692]
Stock Position:  -0.029396919022176803
Bond Position:  [20.77703944]


portfolio before change:  [17.83840261]
curr_Stock_Price:  100.05246224115393
curr_Factors:  [100.05246224]
mat_Sqrt:  [[0.15]]
grads:  [-0.06334867]
Stock Position:  -0.06334866933258863
Bond Position:  [24.17659295]


portfolio before change:  [17.83925148]
curr_Stock_Price:  100.08677054727342
curr_Factors:  [100.08677055]
mat_Sqrt:  [[0.15]]
grads:  [-0.1293617]
Stock Position:  -0.1293616951415434
Bond Position:  [30.78664578]


portfolio before change:  [17.88859537]
curr_Stock_Price:  99.73507980983631
curr_Factors:  [99.73507981]
mat_Sqrt:  [[0.15]]
grads:  [0.10145257]
Stock Position:  0.10145257277794391
Bond Position:  [7.77021492]


portfolio before change:  [18.03799646]
curr_Stock_Price:  101.19812554022414
curr_Factors:  [101.19812554]
mat_Sqrt:  [[0.15]]
grads:  [-0.02302734]
Stock Position:  -0.02302734143915307
Bond Position:  [20.36832025]


portfolio before change:  [18.07429984]
curr_Stock_Price:  99.73216467234923
curr_Factors:  [99.73216467]
mat_Sqrt:  [[0.15]]
grads:  [-0.18813995]
Stock Position:  -0.18813994886166133
Bond Position:  [36.8379042]


portfolio before change:  [18.14050029]
curr_Stock_Price:  99.40477314634653
curr_Factors:  [99.40477315]
mat_Sqrt:  [[0.15]]
grads:  [-0.14492634]
Stock Position:  -0.14492633685814882
Bond Position:  [32.54686993]


portfolio before change:  [18.18513541]
curr_Stock_Price:  99.12486191670419
curr_Factors:  [99.12486192]
mat_Sqrt:  [[0.15]]
grads:  [0.23462799]
Stock Position:  0.23462798640410418
Bond Position:  [-5.07233134]


portfolio before change:  [18.2381726]
curr_Stock_Price:  99.35361241698793
curr_Factors:  [99.35361242]
mat_Sqrt:  [[0.15]]
grads:  [0.02107454]
Stock Position:  0.0210745430805072
Bond Position:  [16.14434061]


portfolio before change:  [18.25920644]
curr_Stock_Price:  100.25591786515078
curr_Factors:  [100.25591787]
mat_Sqrt:  [[0.15]]
grads:  [0.06089998]
Stock Position:  0.06089998211726984
Bond Position:  [12.15362284]


portfolio before change:  [18.23968838]
curr_Stock_Price:  99.91047675017717
curr_Factors:  [99.91047675]
mat_Sqrt:  [[0.15]]
grads:  [0.03956304]
Stock Position:  0.039563042572886245
Bond Position:  [14.28692594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.24672998]
Stock Price:  100.04331835139946
PL:  [18.20341163]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.37704621e-02]
 [-2.96230554e-03]
 [-3.45774145e-03]
 [ 3.86247903e-03]
 [-6.54656990e-06]
 [ 1.87854388e-02]
 [ 3.44215712e-03]
 [ 2.00089618e-02]
 [ 2.28731048e-02]
 [ 2.28091518e-02]
 [ 1.82384255e-02]
 [-1.24864506e-02]
 [ 1.87818745e-02]
 [ 1.99084161e-02]
 [-3.72392393e-03]
 [-3.73424889e-03]
 [-5.81760529e-03]
 [ 7.06023308e-03]
 [ 1.26082316e-02]
 [ 6.56890510e-03]
 [ 3.94594220e-05]
 [-1.57068065e-02]
 [ 7.22458679e-03]
 [-8.21641400e-03]
 [-9.42744289e-03]
 [ 4.54838244e-03]
 [ 6.79954617e-03]
 [ 2.75376734e-03]
 [ 5.47367405e-03]
 [ 5.69240229e-03]
 [-1.31996086e-02]
 [ 4.37015328e-03]
 [ 6.53860825e-03]
 [ 2.23259427e-02]
 [-2.01184153e-02]
 [-9.51246603e-03]
 [ 1.77892820e-02]
 [ 1.72335463e-02]
 [ 9.25363587e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.91476557]
curr_Stock_Price:  100.59338446138086
curr_Factors:  [100.59338446]
mat_Sqrt:  [[0.15]]
grads:  [-0.15846975]
Stock Position:  -0.15846974765825456
Bond Position:  [30.85577382]


portfolio before change:  [14.80797689]
curr_Stock_Price:  101.29159907682958
curr_Factors:  [101.29159908]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197487]
Stock Position:  -0.01974870357666215
Bond Position:  [16.80835466]


portfolio before change:  [14.81887475]
curr_Stock_Price:  100.84616830642817
curr_Factors:  [100.84616831]
mat_Sqrt:  [[0.15]]
grads:  [-0.02305161]
Stock Position:  -0.023051609664833765
Bond Position:  [17.14354126]


portfolio before change:  [14.7812444]
curr_Stock_Price:  102.57157606416969
curr_Factors:  [102.57157606]
mat_Sqrt:  [[0.15]]
grads:  [0.02574986]
Stock Position:  0.025749860225438126
Bond Position:  [12.14004065]


portfolio before change:  [14.78169239]
curr_Stock_Price:  102.53003748809232
curr_Factors:  [102.53003749]
mat_Sqrt:  [[0.15]]
grads:  [-4.36437993e-05]
Stock Position:  -4.364379930945836e-05
Bond Position:  [14.78616719]


portfolio before change:  [14.78356818]
curr_Stock_Price:  101.90214031078598
curr_Factors:  [101.90214031]
mat_Sqrt:  [[0.15]]
grads:  [0.12523626]
Stock Position:  0.12523625879173528
Bond Position:  [2.02172536]


portfolio before change:  [14.9471753]
curr_Stock_Price:  103.20651014553673
curr_Factors:  [103.20651015]
mat_Sqrt:  [[0.15]]
grads:  [0.02294771]
Stock Position:  0.022947714145269273
Bond Position:  [12.57882181]


portfolio before change:  [14.93126152]
curr_Stock_Price:  102.44450677572671
curr_Factors:  [102.44450678]
mat_Sqrt:  [[0.15]]
grads:  [0.13339308]
Stock Position:  0.13339307853482854
Bond Position:  [1.26587338]


portfolio before change:  [14.99984287]
curr_Stock_Price:  102.95745024256107
curr_Factors:  [102.95745024]
mat_Sqrt:  [[0.15]]
grads:  [0.15248737]
Stock Position:  0.15248736540840316
Bond Position:  [-0.69986746]


portfolio before change:  [14.9524328]
curr_Stock_Price:  102.64711251041014
curr_Factors:  [102.64711251]
mat_Sqrt:  [[0.15]]
grads:  [0.15206101]
Stock Position:  0.15206101190124366
Bond Position:  [-0.656191]


portfolio before change:  [14.92134806]
curr_Stock_Price:  102.4432291153522
curr_Factors:  [102.44322912]
mat_Sqrt:  [[0.15]]
grads:  [0.1215895]
Stock Position:  0.12158950330017677
Bond Position:  [2.46532671]


portfolio before change:  [14.78726812]
curr_Stock_Price:  101.33796822366031
curr_Factors:  [101.33796822]
mat_Sqrt:  [[0.15]]
grads:  [-0.083243]
Stock Position:  -0.08324300408495694
Bond Position:  [23.22294502]


portfolio before change:  [14.75981708]
curr_Stock_Price:  101.70261253550497
curr_Factors:  [101.70261254]
mat_Sqrt:  [[0.15]]
grads:  [0.1252125]
Stock Position:  0.12521249688507163
Bond Position:  [2.02537902]


portfolio before change:  [14.74525]
curr_Stock_Price:  101.58425157768986
curr_Factors:  [101.58425158]
mat_Sqrt:  [[0.15]]
grads:  [0.13272277]
Stock Position:  0.13272277422281356
Bond Position:  [1.26270631]


portfolio before change:  [14.5319201]
curr_Stock_Price:  99.97572771421434
curr_Factors:  [99.97572771]
mat_Sqrt:  [[0.15]]
grads:  [-0.02482616]
Stock Position:  -0.02482615950441238
Bond Position:  [17.01393346]


portfolio before change:  [14.51269485]
curr_Stock_Price:  100.83579313951854
curr_Factors:  [100.83579314]
mat_Sqrt:  [[0.15]]
grads:  [-0.02489499]
Stock Position:  -0.02489499256858026
Bond Position:  [17.02300117]


portfolio before change:  [14.49693967]
curr_Stock_Price:  101.5541378666785
curr_Factors:  [101.55413787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03878404]
Stock Position:  -0.03878403524006763
Bond Position:  [18.43561893]


portfolio before change:  [14.47977396]
curr_Stock_Price:  102.05615649160485
curr_Factors:  [102.05615649]
mat_Sqrt:  [[0.15]]
grads:  [0.04706822]
Stock Position:  0.04706822055513957
Bond Position:  [9.67617228]


portfolio before change:  [14.4750085]
curr_Stock_Price:  101.92921186700633
curr_Factors:  [101.92921187]
mat_Sqrt:  [[0.15]]
grads:  [0.08405488]
Stock Position:  0.08405487710771502
Bond Position:  [5.90736112]


portfolio before change:  [14.64808986]
curr_Stock_Price:  103.97957345538595
curr_Factors:  [103.97957346]
mat_Sqrt:  [[0.15]]
grads:  [0.0437927]
Stock Position:  0.04379270066695712
Bond Position:  [10.09454352]


portfolio before change:  [14.69224302]
curr_Stock_Price:  104.95898938787364
curr_Factors:  [104.95898939]
mat_Sqrt:  [[0.15]]
grads:  [0.00026306]
Stock Position:  0.00026306281309574985
Bond Position:  [14.66463221]


portfolio before change:  [14.69417188]
curr_Stock_Price:  105.32265903791291
curr_Factors:  [105.32265904]
mat_Sqrt:  [[0.15]]
grads:  [-0.10471204]
Stock Position:  -0.10471204357194934
Bond Position:  [25.72272275]


portfolio before change:  [14.66520887]
curr_Stock_Price:  105.62996419657388
curr_Factors:  [105.6299642]
mat_Sqrt:  [[0.15]]
grads:  [0.04816391]
Stock Position:  0.04816391194586606
Bond Position:  [9.57765658]


portfolio before change:  [14.63578515]
curr_Stock_Price:  104.99419757172824
curr_Factors:  [104.99419757]
mat_Sqrt:  [[0.15]]
grads:  [-0.05477609]
Stock Position:  -0.05477609335933121
Bond Position:  [20.38695712]


portfolio before change:  [14.57963714]
curr_Stock_Price:  106.06576969573955
curr_Factors:  [106.0657697]
mat_Sqrt:  [[0.15]]
grads:  [-0.06284962]
Stock Position:  -0.06284961925249043
Bond Position:  [21.24583038]


portfolio before change:  [14.66517819]
curr_Stock_Price:  104.74698441770748
curr_Factors:  [104.74698442]
mat_Sqrt:  [[0.15]]
grads:  [0.03032255]
Stock Position:  0.0303225496072542
Bond Position:  [11.48898256]


portfolio before change:  [14.6884961]
curr_Stock_Price:  105.46861567584756
curr_Factors:  [105.46861568]
mat_Sqrt:  [[0.15]]
grads:  [0.04533031]
Stock Position:  0.04533030777128451
Bond Position:  [9.90757129]


portfolio before change:  [14.70231815]
curr_Stock_Price:  105.74621195226764
curr_Factors:  [105.74621195]
mat_Sqrt:  [[0.15]]
grads:  [0.01835845]
Stock Position:  0.018358448927735735
Bond Position:  [12.76098172]


portfolio before change:  [14.72075204]
curr_Stock_Price:  106.66342845515742
curr_Factors:  [106.66342846]
mat_Sqrt:  [[0.15]]
grads:  [0.03649116]
Stock Position:  0.036491160311570424
Bond Position:  [10.82847978]


portfolio before change:  [14.72268476]
curr_Stock_Price:  106.67929731817404
curr_Factors:  [106.67929732]
mat_Sqrt:  [[0.15]]
grads:  [0.03794935]
Stock Position:  0.03794934857671503
Bond Position:  [10.67427492]


portfolio before change:  [14.69684666]
curr_Stock_Price:  105.96327784167099
curr_Factors:  [105.96327784]
mat_Sqrt:  [[0.15]]
grads:  [-0.08799739]
Stock Position:  -0.08799739062530974
Bond Position:  [24.02133861]


portfolio before change:  [14.69392609]
curr_Stock_Price:  106.0305914047831
curr_Factors:  [106.0305914]
mat_Sqrt:  [[0.15]]
grads:  [0.02913436]
Stock Position:  0.029134355184502574
Bond Position:  [11.60479318]


portfolio before change:  [14.69144352]
curr_Stock_Price:  105.8955869168249
curr_Factors:  [105.89558692]
mat_Sqrt:  [[0.15]]
grads:  [0.04359072]
Stock Position:  0.0435907216644596
Bond Position:  [10.07537846]


portfolio before change:  [14.65802398]
curr_Stock_Price:  105.1000267726479
curr_Factors:  [105.10002677]
mat_Sqrt:  [[0.15]]
grads:  [0.14883962]
Stock Position:  0.14883961809102508
Bond Position:  [-0.98502387]


portfolio before change:  [14.75907625]
curr_Stock_Price:  105.77978802577199
curr_Factors:  [105.77978803]
mat_Sqrt:  [[0.15]]
grads:  [-0.13412277]
Stock Position:  -0.1341227689651182
Bond Position:  [28.94655432]


portfolio before change:  [14.77247985]
curr_Stock_Price:  105.70683201461542
curr_Factors:  [105.70683201]
mat_Sqrt:  [[0.15]]
grads:  [-0.06341644]
Stock Position:  -0.0634164401756463
Bond Position:  [21.47603084]


portfolio before change:  [14.72453195]
curr_Stock_Price:  106.50524610742177
curr_Factors:  [106.50524611]
mat_Sqrt:  [[0.15]]
grads:  [0.11859521]
Stock Position:  0.11859521306576469
Bond Position:  [2.09351959]


portfolio before change:  [14.7324709]
curr_Stock_Price:  106.56998101620103
curr_Factors:  [106.56998102]
mat_Sqrt:  [[0.15]]
grads:  [0.11489031]
Stock Position:  0.11489030865789396
Bond Position:  [2.48861289]


portfolio before change:  [14.58127835]
curr_Stock_Price:  105.25130017052913
curr_Factors:  [105.25130017]
mat_Sqrt:  [[0.15]]
grads:  [0.06169091]
Stock Position:  0.06169090579504044
Bond Position:  [8.0882303]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.55064759]
Stock Price:  104.73839065963807
PL:  [9.81225693]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.17861634e-02]
 [ 2.16235780e-02]
 [-2.46209565e-03]
 [-5.69726192e-03]
 [-7.72816491e-03]
 [ 2.98143820e-02]
 [ 3.62563288e-03]
 [-3.08723328e-03]
 [-1.36847304e-02]
 [ 2.34423659e-02]
 [ 2.07069034e-02]
 [-1.10036055e-02]
 [ 1.56633834e-02]
 [ 6.43205603e-03]
 [ 5.31244651e-03]
 [-3.75565830e-03]
 [-6.13541681e-03]
 [ 5.58704602e-03]
 [ 6.22687938e-03]
 [-2.15403595e-02]
 [-2.77528179e-03]
 [-8.15631771e-03]
 [ 6.70609899e-03]
 [-1.06023783e-02]
 [ 5.49267616e-03]
 [ 3.11931837e-03]
 [-2.47558606e-03]
 [ 1.29789644e-03]
 [ 2.98610408e-03]
 [-6.11880712e-03]
 [-2.61255856e-02]
 [ 1.81655898e-02]
 [-8.69874781e-03]
 [-4.55833481e-02]
 [-2.24883848e-02]
 [ 3.91621677e-02]
 [-7.29166373e-04]
 [ 1.78095892e-03]
 [ 2.17780027e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.48308801]
curr_Stock_Price:  100.5737232530054
curr_Factors:  [100.57372325]
mat_Sqrt:  [[0.15]]
grads:  [-0.14524109]
Stock Position:  -0.14524108919384657
Bond Position:  [29.09052512]


portfolio before change:  [14.44046535]
curr_Stock_Price:  100.89222265585894
curr_Factors:  [100.89222266]
mat_Sqrt:  [[0.15]]
grads:  [0.14415719]
Stock Position:  0.14415718636889144
Bond Position:  [-0.10387359]


portfolio before change:  [14.36803501]
curr_Stock_Price:  100.38987269523076
curr_Factors:  [100.3898727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01641397]
Stock Position:  -0.01641397102055006
Bond Position:  [16.01583147]


portfolio before change:  [14.37496595]
curr_Stock_Price:  100.08959011052376
curr_Factors:  [100.08959011]
mat_Sqrt:  [[0.15]]
grads:  [-0.03798175]
Stock Position:  -0.03798174614729951
Bond Position:  [18.17654335]


portfolio before change:  [14.37752818]
curr_Stock_Price:  100.0819541196752
curr_Factors:  [100.08195412]
mat_Sqrt:  [[0.15]]
grads:  [-0.0515211]
Stock Position:  -0.05152109939648583
Bond Position:  [19.53386049]


portfolio before change:  [14.38142455]
curr_Stock_Price:  100.05372330440684
curr_Factors:  [100.0537233]
mat_Sqrt:  [[0.15]]
grads:  [0.19876255]
Stock Position:  0.19876254653052067
Bond Position:  [-5.50550828]


portfolio before change:  [14.34745985]
curr_Stock_Price:  99.88630509720734
curr_Factors:  [99.8863051]
mat_Sqrt:  [[0.15]]
grads:  [0.02417089]
Stock Position:  0.02417088585392061
Bond Position:  [11.93311937]


portfolio before change:  [14.31803173]
curr_Stock_Price:  98.60708630976967
curr_Factors:  [98.60708631]
mat_Sqrt:  [[0.15]]
grads:  [-0.02058156]
Stock Position:  -0.020581555192884175
Bond Position:  [16.34751892]


portfolio before change:  [14.33092919]
curr_Stock_Price:  98.07972624022007
curr_Factors:  [98.07972624]
mat_Sqrt:  [[0.15]]
grads:  [-0.09123154]
Stock Position:  -0.09123153571824516
Bond Position:  [23.27889324]


portfolio before change:  [14.33324882]
curr_Stock_Price:  98.08619786560409
curr_Factors:  [98.08619787]
mat_Sqrt:  [[0.15]]
grads:  [0.15628244]
Stock Position:  0.15628243956343046
Bond Position:  [-0.99590147]


portfolio before change:  [14.41364216]
curr_Stock_Price:  98.60140504857313
curr_Factors:  [98.60140505]
mat_Sqrt:  [[0.15]]
grads:  [0.13804602]
Stock Position:  0.13804602259006443
Bond Position:  [0.80211037]


portfolio before change:  [14.34452567]
curr_Stock_Price:  98.10000155405005
curr_Factors:  [98.10000155]
mat_Sqrt:  [[0.15]]
grads:  [-0.07335737]
Stock Position:  -0.07335736971916361
Bond Position:  [21.54088375]


portfolio before change:  [14.24952719]
curr_Stock_Price:  99.43171853106931
curr_Factors:  [99.43171853]
mat_Sqrt:  [[0.15]]
grads:  [0.10442256]
Stock Position:  0.10442255582126489
Bond Position:  [3.86661302]


portfolio before change:  [14.23784954]
curr_Stock_Price:  99.3152588653014
curr_Factors:  [99.31525887]
mat_Sqrt:  [[0.15]]
grads:  [0.04288037]
Stock Position:  0.0428803735250502
Bond Position:  [9.97917414]


portfolio before change:  [14.30247495]
curr_Stock_Price:  100.79327618105725
curr_Factors:  [100.79327618]
mat_Sqrt:  [[0.15]]
grads:  [0.03541631]
Stock Position:  0.03541631005050673
Bond Position:  [10.73274902]


portfolio before change:  [14.29724839]
curr_Stock_Price:  100.60781841324882
curr_Factors:  [100.60781841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02503772]
Stock Position:  -0.025037721984214584
Bond Position:  [16.81623898]


portfolio before change:  [14.32657127]
curr_Stock_Price:  99.520630347735
curr_Factors:  [99.52063035]
mat_Sqrt:  [[0.15]]
grads:  [-0.04090278]
Stock Position:  -0.04090277871952367
Bond Position:  [18.39724159]


portfolio before change:  [14.28989885]
curr_Stock_Price:  100.47343140061625
curr_Factors:  [100.4734314]
mat_Sqrt:  [[0.15]]
grads:  [0.03724697]
Stock Position:  0.03724697346828571
Bond Position:  [10.54756762]


portfolio before change:  [14.27451039]
curr_Stock_Price:  100.02488518571626
curr_Factors:  [100.02488519]
mat_Sqrt:  [[0.15]]
grads:  [0.04151253]
Stock Position:  0.04151252918129691
Bond Position:  [10.12222443]


portfolio before change:  [14.24069933]
curr_Stock_Price:  99.17992533962992
curr_Factors:  [99.17992534]
mat_Sqrt:  [[0.15]]
grads:  [-0.1436024]
Stock Position:  -0.14360239683960715
Bond Position:  [28.48317433]


portfolio before change:  [14.24711011]
curr_Stock_Price:  99.16007777937583
curr_Factors:  [99.16007778]
mat_Sqrt:  [[0.15]]
grads:  [-0.01850188]
Stock Position:  -0.018501878589529477
Bond Position:  [16.08175783]


portfolio before change:  [14.24709704]
curr_Stock_Price:  99.26944013157947
curr_Factors:  [99.26944013]
mat_Sqrt:  [[0.15]]
grads:  [-0.05437545]
Stock Position:  -0.054375451419415466
Bond Position:  [19.64491766]


portfolio before change:  [14.18736124]
curr_Stock_Price:  100.41318372994624
curr_Factors:  [100.41318373]
mat_Sqrt:  [[0.15]]
grads:  [0.04470733]
Stock Position:  0.04470732658496545
Bond Position:  [9.69815624]


portfolio before change:  [14.21440245]
curr_Stock_Price:  100.9909160663902
curr_Factors:  [100.99091607]
mat_Sqrt:  [[0.15]]
grads:  [-0.07068252]
Stock Position:  -0.07068252205445019
Bond Position:  [21.3526951]


portfolio before change:  [14.20047001]
curr_Stock_Price:  101.22579299120999
curr_Factors:  [101.22579299]
mat_Sqrt:  [[0.15]]
grads:  [0.03661784]
Stock Position:  0.03661784108418454
Bond Position:  [10.49380001]


portfolio before change:  [14.23023753]
curr_Stock_Price:  102.00289257084442
curr_Factors:  [102.00289257]
mat_Sqrt:  [[0.15]]
grads:  [0.02079546]
Stock Position:  0.02079545580727284
Bond Position:  [12.10904088]


portfolio before change:  [14.22920557]
curr_Stock_Price:  101.88047749312973
curr_Factors:  [101.88047749]
mat_Sqrt:  [[0.15]]
grads:  [-0.01650391]
Stock Position:  -0.016503907082222012
Bond Position:  [15.91063151]


portfolio before change:  [14.20741598]
curr_Stock_Price:  103.32126075924486
curr_Factors:  [103.32126076]
mat_Sqrt:  [[0.15]]
grads:  [0.00865264]
Stock Position:  0.008652642931087657
Bond Position:  [13.313414]


portfolio before change:  [14.20062383]
curr_Stock_Price:  102.34393734270678
curr_Factors:  [102.34393734]
mat_Sqrt:  [[0.15]]
grads:  [0.01990736]
Stock Position:  0.019907360514093746
Bond Position:  [12.16322617]


portfolio before change:  [14.2025101]
curr_Stock_Price:  102.36231113970999
curr_Factors:  [102.36231114]
mat_Sqrt:  [[0.15]]
grads:  [-0.04079205]
Stock Position:  -0.04079204747526314
Bond Position:  [18.37807835]


portfolio before change:  [14.25030959]
curr_Stock_Price:  101.24684642435962
curr_Factors:  [101.24684642]
mat_Sqrt:  [[0.15]]
grads:  [-0.17417057]
Stock Position:  -0.1741705708489905
Bond Position:  [31.88453063]


portfolio before change:  [14.40361321]
curr_Stock_Price:  100.38953852621572
curr_Factors:  [100.38953853]
mat_Sqrt:  [[0.15]]
grads:  [0.12110393]
Stock Position:  0.12110393175491184
Bond Position:  [2.24604539]


portfolio before change:  [14.31992612]
curr_Stock_Price:  99.69618475278342
curr_Factors:  [99.69618475]
mat_Sqrt:  [[0.15]]
grads:  [-0.05799165]
Stock Position:  -0.057991652087033926
Bond Position:  [20.10147258]


portfolio before change:  [14.41228908]
curr_Stock_Price:  98.1468216962168
curr_Factors:  [98.1468217]
mat_Sqrt:  [[0.15]]
grads:  [-0.30388899]
Stock Position:  -0.3038889872211739
Bond Position:  [44.23802733]


portfolio before change:  [14.51170398]
curr_Stock_Price:  97.83787729906136
curr_Factors:  [97.8378773]
mat_Sqrt:  [[0.15]]
grads:  [-0.14992257]
Stock Position:  -0.14992256508432847
Bond Position:  [29.17980951]


portfolio before change:  [14.59190402]
curr_Stock_Price:  97.32726479112665
curr_Factors:  [97.32726479]
mat_Sqrt:  [[0.15]]
grads:  [0.26108112]
Stock Position:  0.26108111822044533
Bond Position:  [-10.8184071]


portfolio before change:  [14.48577095]
curr_Stock_Price:  96.92593095933321
curr_Factors:  [96.92593096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00486111]
Stock Position:  -0.004861109151898007
Bond Position:  [14.95693848]


portfolio before change:  [14.49045008]
curr_Stock_Price:  96.34799773035293
curr_Factors:  [96.34799773]
mat_Sqrt:  [[0.15]]
grads:  [0.01187306]
Stock Position:  0.011873059458323973
Bond Position:  [13.34650458]


portfolio before change:  [14.47914178]
curr_Stock_Price:  95.25504251111957
curr_Factors:  [95.25504251]
mat_Sqrt:  [[0.15]]
grads:  [0.14518668]
Stock Position:  0.14518668435894289
Bond Position:  [0.64937799]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.6785559]
Stock Price:  96.6279848200732
PL:  [14.6785559]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.16562542e-02]
 [ 4.41378562e-02]
 [-3.05707930e-03]
 [-6.53156387e-03]
 [-6.54311916e-03]
 [ 2.89374698e-02]
 [ 3.73358384e-03]
 [ 6.13905145e-03]
 [-1.66240968e-02]
 [ 2.32436033e-02]
 [ 1.99608885e-02]
 [-1.11337659e-02]
 [ 2.29424066e-02]
 [ 5.57111450e-03]
 [-6.07455595e-03]
 [-2.39493601e-03]
 [-6.11464864e-03]
 [ 4.17732901e-03]
 [ 3.38390216e-03]
 [-1.69492637e-02]
 [-2.85235370e-03]
 [-9.58801733e-03]
 [ 7.14038884e-03]
 [-7.93560415e-03]
 [ 1.09623591e-02]
 [ 8.19920286e-03]
 [-6.56250518e-03]
 [-2.40650607e-04]
 [ 8.79752245e-04]
 [-1.30600556e-02]
 [ 1.06398058e-02]
 [ 1.13592796e-02]
 [-1.33909649e-02]
 [-4.90844096e-02]
 [-2.30766013e-02]
 [ 3.95058453e-02]
 [-2.42295260e-03]
 [ 2.35546508e-03]
 [ 1.30665491e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.1703186]
curr_Stock_Price:  99.54195002974382
curr_Factors:  [99.54195003]
mat_Sqrt:  [[0.15]]
grads:  [-0.07770836]
Stock Position:  -0.07770836141231406
Bond Position:  [-0.43507678]


portfolio before change:  [-8.23089569]
curr_Stock_Price:  100.32079407262299
curr_Factors:  [100.32079407]
mat_Sqrt:  [[0.15]]
grads:  [0.29425237]
Stock Position:  0.29425237456890185
Bond Position:  [-37.75052756]


portfolio before change:  [-8.28878713]
curr_Stock_Price:  100.14009093078703
curr_Factors:  [100.14009093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02038053]
Stock Position:  -0.02038052869121631
Bond Position:  [-6.24787913]


portfolio before change:  [-8.28401024]
curr_Stock_Price:  99.86738349664945
curr_Factors:  [99.8673835]
mat_Sqrt:  [[0.15]]
grads:  [-0.04354376]
Stock Position:  -0.04354375911194015
Bond Position:  [-3.93540895]


portfolio before change:  [-8.24998194]
curr_Stock_Price:  99.07461195281486
curr_Factors:  [99.07461195]
mat_Sqrt:  [[0.15]]
grads:  [-0.04362079]
Stock Position:  -0.04362079441491823
Bond Position:  [-3.92826866]


portfolio before change:  [-8.25271683]
curr_Stock_Price:  99.12605128942187
curr_Factors:  [99.12605129]
mat_Sqrt:  [[0.15]]
grads:  [0.19291647]
Stock Position:  0.19291646531947265
Bond Position:  [-27.37576427]


portfolio before change:  [-7.94946849]
curr_Stock_Price:  100.71570580286279
curr_Factors:  [100.7157058]
mat_Sqrt:  [[0.15]]
grads:  [0.02489056]
Stock Position:  0.024890558926576864
Bond Position:  [-10.4563387]


portfolio before change:  [-7.94606424]
curr_Stock_Price:  100.9049892694997
curr_Factors:  [100.90498927]
mat_Sqrt:  [[0.15]]
grads:  [0.04092701]
Stock Position:  0.04092700967111986
Bond Position:  [-12.07580371]


portfolio before change:  [-7.93511304]
curr_Stock_Price:  101.20945240006115
curr_Factors:  [101.2094524]
mat_Sqrt:  [[0.15]]
grads:  [-0.11082731]
Stock Position:  -0.11082731184366096
Bond Position:  [3.2816585]


portfolio before change:  [-7.89481402]
curr_Stock_Price:  100.84953400010527
curr_Factors:  [100.849534]
mat_Sqrt:  [[0.15]]
grads:  [0.15495736]
Stock Position:  0.15495735535266034
Bond Position:  [-23.5221911]


portfolio before change:  [-7.85471347]
curr_Stock_Price:  101.12729434906343
curr_Factors:  [101.12729435]
mat_Sqrt:  [[0.15]]
grads:  [0.13307259]
Stock Position:  0.1330725899607647
Bond Position:  [-21.31198444]


portfolio before change:  [-7.79675819]
curr_Stock_Price:  101.58283100301621
curr_Factors:  [101.582831]
mat_Sqrt:  [[0.15]]
grads:  [-0.07422511]
Stock Position:  -0.07422510620429945
Bond Position:  [-0.25676177]


portfolio before change:  [-7.78436941]
curr_Stock_Price:  101.41549037429456
curr_Factors:  [101.41549037]
mat_Sqrt:  [[0.15]]
grads:  [0.15294938]
Stock Position:  0.15294937702922087
Bond Position:  [-23.29580549]


portfolio before change:  [-7.95474051]
curr_Stock_Price:  100.32062524630607
curr_Factors:  [100.32062525]
mat_Sqrt:  [[0.15]]
grads:  [0.03714076]
Stock Position:  0.03714076336234225
Bond Position:  [-11.68072511]


portfolio before change:  [-7.97803852]
curr_Stock_Price:  99.73265044315065
curr_Factors:  [99.73265044]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049704]
Stock Position:  -0.04049703968593205
Bond Position:  [-3.93916142]


portfolio before change:  [-7.97746276]
curr_Stock_Price:  99.70627336411357
curr_Factors:  [99.70627336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01596624]
Stock Position:  -0.015966240079056285
Bond Position:  [-6.38552846]


portfolio before change:  [-7.97296705]
curr_Stock_Price:  99.37470175493971
curr_Factors:  [99.37470175]
mat_Sqrt:  [[0.15]]
grads:  [-0.04076432]
Stock Position:  -0.04076432423463192
Bond Position:  [-3.92202448]


portfolio before change:  [-7.96570984]
curr_Stock_Price:  99.18464600455088
curr_Factors:  [99.184646]
mat_Sqrt:  [[0.15]]
grads:  [0.02784886]
Stock Position:  0.02784886006653508
Bond Position:  [-10.72788916]


portfolio before change:  [-8.00408905]
curr_Stock_Price:  97.85467629313271
curr_Factors:  [97.85467629]
mat_Sqrt:  [[0.15]]
grads:  [0.02255935]
Stock Position:  0.022559347717489558
Bond Position:  [-10.21162671]


portfolio before change:  [-7.96706253]
curr_Stock_Price:  99.5525554624076
curr_Factors:  [99.55255546]
mat_Sqrt:  [[0.15]]
grads:  [-0.11299509]
Stock Position:  -0.11299509135843905
Bond Position:  [3.28188757]


portfolio before change:  [-7.87263866]
curr_Stock_Price:  98.72054049883187
curr_Factors:  [98.7205405]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901569]
Stock Position:  -0.01901569131145282
Bond Position:  [-5.99539934]


portfolio before change:  [-7.87817996]
curr_Stock_Price:  98.97253350968035
curr_Factors:  [98.97253351]
mat_Sqrt:  [[0.15]]
grads:  [-0.06392012]
Stock Position:  -0.06392011554248274
Bond Position:  [-1.55184418]


portfolio before change:  [-7.91002326]
curr_Stock_Price:  99.46767201146822
curr_Factors:  [99.46767201]
mat_Sqrt:  [[0.15]]
grads:  [0.04760259]
Stock Position:  0.04760259228019481
Bond Position:  [-12.6449423]


portfolio before change:  [-7.88728325]
curr_Stock_Price:  99.9785839128194
curr_Factors:  [99.97858391]
mat_Sqrt:  [[0.15]]
grads:  [-0.05290403]
Stock Position:  -0.05290402765472303
Bond Position:  [-2.59801348]


portfolio before change:  [-7.90276165]
curr_Stock_Price:  100.26502020251054
curr_Factors:  [100.2650202]
mat_Sqrt:  [[0.15]]
grads:  [0.07308239]
Stock Position:  0.0730823938360951
Bond Position:  [-15.23036935]


portfolio before change:  [-7.94931186]
curr_Stock_Price:  99.65411671241422
curr_Factors:  [99.65411671]
mat_Sqrt:  [[0.15]]
grads:  [0.05466135]
Stock Position:  0.054661352422310655
Bond Position:  [-13.39654065]


portfolio before change:  [-7.94285456]
curr_Stock_Price:  99.8028866144595
curr_Factors:  [99.80288661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04375003]
Stock Position:  -0.04375003454565373
Bond Position:  [-3.57647483]


portfolio before change:  [-8.02456463]
curr_Stock_Price:  101.66032465859456
curr_Factors:  [101.66032466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00160434]
Stock Position:  -0.0016043373775138001
Bond Position:  [-7.86146717]


portfolio before change:  [-8.02428712]
curr_Stock_Price:  100.8747925134271
curr_Factors:  [100.87479251]
mat_Sqrt:  [[0.15]]
grads:  [0.00586501]
Stock Position:  0.0058650149679329135
Bond Position:  [-8.61591928]


portfolio before change:  [-8.03465722]
curr_Stock_Price:  99.29030374036162
curr_Factors:  [99.29030374]
mat_Sqrt:  [[0.15]]
grads:  [-0.08706704]
Stock Position:  -0.08706703757705099
Bond Position:  [0.61025538]


portfolio before change:  [-7.95880331]
curr_Stock_Price:  98.4199671178338
curr_Factors:  [98.41996712]
mat_Sqrt:  [[0.15]]
grads:  [0.07093204]
Stock Position:  0.07093203858133408
Bond Position:  [-14.93993221]


portfolio before change:  [-7.96231402]
curr_Stock_Price:  98.39680257958739
curr_Factors:  [98.39680258]
mat_Sqrt:  [[0.15]]
grads:  [0.07572853]
Stock Position:  0.07572853072836665
Bond Position:  [-15.41375931]


portfolio before change:  [-8.04803246]
curr_Stock_Price:  97.29032932715556
curr_Factors:  [97.29032933]
mat_Sqrt:  [[0.15]]
grads:  [-0.0892731]
Stock Position:  -0.08927309909436588
Bond Position:  [0.63737676]


portfolio before change:  [-8.02690624]
curr_Stock_Price:  97.05457478531558
curr_Factors:  [97.05457479]
mat_Sqrt:  [[0.15]]
grads:  [-0.3272294]
Stock Position:  -0.32722939717536914
Bond Position:  [23.73220376]


portfolio before change:  [-7.72696123]
curr_Stock_Price:  96.14702093877018
curr_Factors:  [96.14702094]
mat_Sqrt:  [[0.15]]
grads:  [-0.15384401]
Stock Position:  -0.15384400885960337
Bond Position:  [7.06468191]


portfolio before change:  [-7.82143208]
curr_Stock_Price:  96.76683054122574
curr_Factors:  [96.76683054]
mat_Sqrt:  [[0.15]]
grads:  [0.2633723]
Stock Position:  0.26337230221597935
Bond Position:  [-33.30713502]


portfolio before change:  [-7.98170629]
curr_Stock_Price:  96.17409336040443
curr_Factors:  [96.17409336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01615302]
Stock Position:  -0.016153017328626798
Bond Position:  [-6.4282045]


portfolio before change:  [-7.98776556]
curr_Stock_Price:  96.49946209447566
curr_Factors:  [96.49946209]
mat_Sqrt:  [[0.15]]
grads:  [0.0157031]
Stock Position:  0.015703100544081302
Bond Position:  [-9.50310631]


portfolio before change:  [-7.9867738]
curr_Stock_Price:  96.63827037318765
curr_Factors:  [96.63827037]
mat_Sqrt:  [[0.15]]
grads:  [0.08711033]
Stock Position:  0.08711032731039045
Bond Position:  [-16.40496516]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.01802159]
Stock Price:  96.30309719348993
PL:  [-8.01802159]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 3.72021719e-03]
 [ 1.41257547e-02]
 [-1.42792365e-02]
 [-8.30328168e-03]
 [-6.17552584e-03]
 [ 3.29268043e-02]
 [ 3.58618429e-03]
 [-5.75057979e-04]
 [-2.07978166e-02]
 [ 2.34406076e-02]
 [ 2.08890920e-02]
 [-1.03411029e-02]
 [-1.49331611e-02]
 [ 1.06005018e-02]
 [-1.78051362e-02]
 [ 6.66704909e-04]
 [-6.07749224e-03]
 [ 5.83903804e-03]
 [ 1.19050522e-02]
 [ 1.32833961e-02]
 [-1.52937908e-03]
 [-3.36899044e-03]
 [ 3.96595755e-03]
 [-1.07471956e-02]
 [-9.22052079e-04]
 [ 3.43763101e-03]
 [ 2.96588807e-03]
 [ 7.11997790e-04]
 [ 2.20604537e-03]
 [-5.61920175e-03]
 [-1.82222193e-02]
 [ 7.48935163e-03]
 [ 4.44801461e-04]
 [-1.18268385e-02]
 [-2.02359251e-02]
 [-1.12022540e-02]
 [ 2.08714833e-02]
 [ 1.29264571e-02]
 [ 8.12963670e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.90752828]
curr_Stock_Price:  99.73610329706656
curr_Factors:  [99.7361033]
mat_Sqrt:  [[0.15]]
grads:  [0.02480145]
Stock Position:  0.024801447919725952
Bond Position:  [-6.38112805]


portfolio before change:  [-3.93340395]
curr_Stock_Price:  98.72495341582832
curr_Factors:  [98.72495342]
mat_Sqrt:  [[0.15]]
grads:  [0.0941717]
Stock Position:  0.09417169777272093
Bond Position:  [-13.23050043]


portfolio before change:  [-4.03564306]
curr_Stock_Price:  97.65684918481013
curr_Factors:  [97.65684918]
mat_Sqrt:  [[0.15]]
grads:  [-0.09519491]
Stock Position:  -0.09519491029578467
Bond Position:  [5.26079194]


portfolio before change:  [-4.03805364]
curr_Stock_Price:  97.68908007809146
curr_Factors:  [97.68908008]
mat_Sqrt:  [[0.15]]
grads:  [-0.05535521]
Stock Position:  -0.055355211168019405
Bond Position:  [1.36954602]


portfolio before change:  [-4.08817984]
curr_Stock_Price:  98.59771016006137
curr_Factors:  [98.59771016]
mat_Sqrt:  [[0.15]]
grads:  [-0.04117017]
Stock Position:  -0.04117017224108237
Bond Position:  [-0.02889513]


portfolio before change:  [-4.096868]
curr_Stock_Price:  98.80865285403347
curr_Factors:  [98.80865285]
mat_Sqrt:  [[0.15]]
grads:  [0.21951203]
Stock Position:  0.21951202873665052
Bond Position:  [-25.78655585]


portfolio before change:  [-4.31367075]
curr_Stock_Price:  97.83568008774704
curr_Factors:  [97.83568009]
mat_Sqrt:  [[0.15]]
grads:  [0.0239079]
Stock Position:  0.023907895297370908
Bond Position:  [-6.65271594]


portfolio before change:  [-4.31461797]
curr_Stock_Price:  97.83084585896908
curr_Factors:  [97.83084586]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383372]
Stock Position:  -0.003833719859580584
Bond Position:  [-3.93956191]


portfolio before change:  [-4.31791925]
curr_Stock_Price:  98.56350422832553
curr_Factors:  [98.56350423]
mat_Sqrt:  [[0.15]]
grads:  [-0.13865211]
Stock Position:  -0.13865211057965052
Bond Position:  [9.34811864]


portfolio before change:  [-4.32801626]
curr_Stock_Price:  98.64475508800696
curr_Factors:  [98.64475509]
mat_Sqrt:  [[0.15]]
grads:  [0.15627072]
Stock Position:  0.15627071720309826
Bond Position:  [-19.74330289]


portfolio before change:  [-4.36955631]
curr_Stock_Price:  98.39472757313199
curr_Factors:  [98.39472757]
mat_Sqrt:  [[0.15]]
grads:  [0.13926061]
Stock Position:  0.13926061311072652
Bond Position:  [-18.0720664]


portfolio before change:  [-4.43794689]
curr_Stock_Price:  97.91985227009515
curr_Factors:  [97.91985227]
mat_Sqrt:  [[0.15]]
grads:  [-0.06894069]
Stock Position:  -0.06894068598096563
Bond Position:  [2.3127149]


portfolio before change:  [-4.3702533]
curr_Stock_Price:  96.94213532901841
curr_Factors:  [96.94213533]
mat_Sqrt:  [[0.15]]
grads:  [-0.09955441]
Stock Position:  -0.09955440747020819
Bond Position:  [5.28076354]


portfolio before change:  [-4.44113042]
curr_Stock_Price:  97.66070983891393
curr_Factors:  [97.66070984]
mat_Sqrt:  [[0.15]]
grads:  [0.07067001]
Stock Position:  0.0706700118974963
Bond Position:  [-11.34281395]


portfolio before change:  [-4.47690735]
curr_Stock_Price:  97.1745208315408
curr_Factors:  [97.17452083]
mat_Sqrt:  [[0.15]]
grads:  [-0.11870091]
Stock Position:  -0.11870090782351538
Bond Position:  [7.05779649]


portfolio before change:  [-4.52222591]
curr_Stock_Price:  97.56374150191216
curr_Factors:  [97.5637415]
mat_Sqrt:  [[0.15]]
grads:  [0.0044447]
Stock Position:  0.004444699393527296
Bond Position:  [-4.95586742]


portfolio before change:  [-4.51595669]
curr_Stock_Price:  99.11362053465987
curr_Factors:  [99.11362053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051661]
Stock Position:  -0.040516614960004325
Bond Position:  [-0.50020829]


portfolio before change:  [-4.5776597]
curr_Stock_Price:  100.63498363394622
curr_Factors:  [100.63498363]
mat_Sqrt:  [[0.15]]
grads:  [0.03892692]
Stock Position:  0.038926920244017234
Bond Position:  [-8.49506969]


portfolio before change:  [-4.53496653]
curr_Stock_Price:  101.75901605700837
curr_Factors:  [101.75901606]
mat_Sqrt:  [[0.15]]
grads:  [0.07936701]
Stock Position:  0.07936701458454071
Bond Position:  [-12.61127584]


portfolio before change:  [-4.56854282]
curr_Stock_Price:  101.35582869894951
curr_Factors:  [101.3558287]
mat_Sqrt:  [[0.15]]
grads:  [0.08855597]
Stock Position:  0.08855597398337375
Bond Position:  [-13.54420695]


portfolio before change:  [-4.48601703]
curr_Stock_Price:  102.30685346442674
curr_Factors:  [102.30685346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01019586]
Stock Position:  -0.01019586054755943
Bond Position:  [-3.44291061]


portfolio before change:  [-4.49644372]
curr_Stock_Price:  103.28728133553383
curr_Factors:  [103.28728134]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245994]
Stock Position:  -0.022459936259175667
Bond Position:  [-2.17661797]


portfolio before change:  [-4.48019333]
curr_Stock_Price:  102.55163852713045
curr_Factors:  [102.55163853]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [-7.19162962]


portfolio before change:  [-4.44474957]
curr_Stock_Price:  103.92619035942252
curr_Factors:  [103.92619036]
mat_Sqrt:  [[0.15]]
grads:  [-0.07164797]
Stock Position:  -0.07164797076697949
Bond Position:  [3.00135107]


portfolio before change:  [-4.40612755]
curr_Stock_Price:  103.39237435551016
curr_Factors:  [103.39237436]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614701]
Stock Position:  -0.006147013857295102
Bond Position:  [-3.77057319]


portfolio before change:  [-4.40299032]
curr_Stock_Price:  102.80532817687404
curr_Factors:  [102.80532818]
mat_Sqrt:  [[0.15]]
grads:  [0.02291754]
Stock Position:  0.022917540046196023
Bond Position:  [-6.75903554]


portfolio before change:  [-4.38576404]
curr_Stock_Price:  103.59386001229517
curr_Factors:  [103.59386001]
mat_Sqrt:  [[0.15]]
grads:  [0.01977259]
Stock Position:  0.01977258711399246
Bond Position:  [-6.43408266]


portfolio before change:  [-4.4077123]
curr_Stock_Price:  102.52450312666247
curr_Factors:  [102.52450313]
mat_Sqrt:  [[0.15]]
grads:  [0.00474665]
Stock Position:  0.004746651933800472
Bond Position:  [-4.89436043]


portfolio before change:  [-4.41131689]
curr_Stock_Price:  101.89400539856172
curr_Factors:  [101.8940054]
mat_Sqrt:  [[0.15]]
grads:  [0.01470697]
Stock Position:  0.014706969120136413
Bond Position:  [-5.90986888]


portfolio before change:  [-4.38885399]
curr_Stock_Price:  103.47160300898148
curr_Factors:  [103.47160301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03746134]
Stock Position:  -0.037461344970395445
Bond Position:  [-0.51266858]


portfolio before change:  [-4.378937]
curr_Stock_Price:  103.2051662498344
curr_Factors:  [103.20516625]
mat_Sqrt:  [[0.15]]
grads:  [-0.12148146]
Stock Position:  -0.12148146194224524
Bond Position:  [8.15857748]


portfolio before change:  [-4.40154439]
curr_Stock_Price:  103.39965913117766
curr_Factors:  [103.39965913]
mat_Sqrt:  [[0.15]]
grads:  [0.04992901]
Stock Position:  0.04992901085420751
Bond Position:  [-9.5641871]


portfolio before change:  [-4.3871684]
curr_Stock_Price:  103.71153372924788
curr_Factors:  [103.71153373]
mat_Sqrt:  [[0.15]]
grads:  [0.00296534]
Stock Position:  0.002965343076519617
Bond Position:  [-4.69470868]


portfolio before change:  [-4.38840822]
curr_Stock_Price:  103.49134284914315
curr_Factors:  [103.49134285]
mat_Sqrt:  [[0.15]]
grads:  [-0.07884559]
Stock Position:  -0.07884559021241228
Bond Position:  [3.77142779]


portfolio before change:  [-4.43069511]
curr_Stock_Price:  104.03364771797234
curr_Factors:  [104.03364772]
mat_Sqrt:  [[0.15]]
grads:  [-0.13490617]
Stock Position:  -0.13490616719866225
Bond Position:  [9.60408557]


portfolio before change:  [-4.67957466]
curr_Stock_Price:  105.88738165855395
curr_Factors:  [105.88738166]
mat_Sqrt:  [[0.15]]
grads:  [-0.07468169]
Stock Position:  -0.0746816933484248
Bond Position:  [3.2282743]


portfolio before change:  [-4.7692142]
curr_Stock_Price:  107.09307332411888
curr_Factors:  [107.09307332]
mat_Sqrt:  [[0.15]]
grads:  [0.13914322]
Stock Position:  0.13914322199927928
Bond Position:  [-19.67048947]


portfolio before change:  [-4.66008272]
curr_Stock_Price:  107.89505590215849
curr_Factors:  [107.8950559]
mat_Sqrt:  [[0.15]]
grads:  [0.08617638]
Stock Position:  0.08617638096710056
Bond Position:  [-13.95808816]


portfolio before change:  [-4.65835666]
curr_Stock_Price:  107.9353330117107
curr_Factors:  [107.93533301]
mat_Sqrt:  [[0.15]]
grads:  [0.05419758]
Stock Position:  0.05419757798300451
Bond Position:  [-10.50819029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.7308937]
Stock Price:  106.62118872637221
PL:  [-11.35208243]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.07485698e-02]
 [ 1.77848144e-02]
 [-1.66488280e-02]
 [-7.31720401e-03]
 [-6.44411376e-03]
 [ 2.77899840e-02]
 [ 3.54594122e-03]
 [ 2.43918463e-03]
 [-1.84285851e-02]
 [ 2.34435659e-02]
 [ 2.15054720e-02]
 [-4.60144641e-03]
 [-2.40903415e-02]
 [ 1.53132361e-02]
 [-1.77223368e-02]
 [ 7.05924366e-04]
 [-6.04164447e-03]
 [ 1.61872688e-03]
 [ 1.27975232e-03]
 [-2.58366427e-02]
 [-4.15741079e-03]
 [-1.35295932e-02]
 [ 6.80634380e-03]
 [-6.33876290e-03]
 [ 1.07330454e-02]
 [ 6.29342441e-03]
 [-2.69837710e-03]
 [-6.22517528e-04]
 [ 1.70551900e-03]
 [-6.63712998e-03]
 [-2.77599451e-02]
 [ 1.87127797e-02]
 [-3.77110451e-03]
 [-2.11730464e-02]
 [-2.17783170e-02]
 [ 3.51351856e-02]
 [ 2.61797804e-03]
 [ 7.05653429e-03]
 [ 4.49024998e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.45051873]
curr_Stock_Price:  99.43809591732769
curr_Factors:  [99.43809592]
mat_Sqrt:  [[0.15]]
grads:  [-0.07165713]
Stock Position:  -0.07165713195428042
Bond Position:  [-3.32506997]


portfolio before change:  [-10.41069008]
curr_Stock_Price:  98.87647257702186
curr_Factors:  [98.87647258]
mat_Sqrt:  [[0.15]]
grads:  [0.11856543]
Stock Position:  0.11856542924888433
Bond Position:  [-22.13402149]


portfolio before change:  [-10.44982447]
curr_Stock_Price:  98.56974345258342
curr_Factors:  [98.56974345]
mat_Sqrt:  [[0.15]]
grads:  [-0.11099219]
Stock Position:  -0.1109921863714943
Bond Position:  [0.49064686]


portfolio before change:  [-10.46670796]
curr_Stock_Price:  98.722410250317
curr_Factors:  [98.72241025]
mat_Sqrt:  [[0.15]]
grads:  [-0.04878136]
Stock Position:  -0.048781360087521576
Bond Position:  [-5.65089452]


portfolio before change:  [-10.4806349]
curr_Stock_Price:  98.99342644925197
curr_Factors:  [98.99342645]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296076]
Stock Position:  -0.0429607584078159
Bond Position:  [-6.22780223]


portfolio before change:  [-10.5099113]
curr_Stock_Price:  99.6567730418851
curr_Factors:  [99.65677304]
mat_Sqrt:  [[0.15]]
grads:  [0.18526656]
Stock Position:  0.18526656004963601
Bond Position:  [-28.97297883]


portfolio before change:  [-10.61523774]
curr_Stock_Price:  99.10780947152274
curr_Factors:  [99.10780947]
mat_Sqrt:  [[0.15]]
grads:  [0.02363961]
Stock Position:  0.02363960814105576
Bond Position:  [-12.95810752]


portfolio before change:  [-10.59759052]
curr_Stock_Price:  99.92284354185097
curr_Factors:  [99.92284354]
mat_Sqrt:  [[0.15]]
grads:  [0.01626123]
Stock Position:  0.016261230872890147
Bond Position:  [-12.22245895]


portfolio before change:  [-10.62438704]
curr_Stock_Price:  98.36892568954971
curr_Factors:  [98.36892569]
mat_Sqrt:  [[0.15]]
grads:  [-0.12285723]
Stock Position:  -0.12285723386727918
Bond Position:  [1.46094707]


portfolio before change:  [-10.54263679]
curr_Stock_Price:  97.70500366849154
curr_Factors:  [97.70500367]
mat_Sqrt:  [[0.15]]
grads:  [0.15629044]
Stock Position:  0.15629043963138387
Bond Position:  [-25.81299476]


portfolio before change:  [-10.6648969]
curr_Stock_Price:  96.9433877634094
curr_Factors:  [96.94338776]
mat_Sqrt:  [[0.15]]
grads:  [0.14336981]
Stock Position:  0.14336981316672903
Bond Position:  [-24.56365229]


portfolio before change:  [-10.8007479]
curr_Stock_Price:  96.01724889520939
curr_Factors:  [96.0172489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03067631]
Stock Position:  -0.030676309390248475
Bond Position:  [-7.85529307]


portfolio before change:  [-10.79563319]
curr_Stock_Price:  95.8185065331283
curr_Factors:  [95.81850653]
mat_Sqrt:  [[0.15]]
grads:  [-0.16060228]
Stock Position:  -0.16060227649735212
Bond Position:  [4.59303709]


portfolio before change:  [-10.96128388]
curr_Stock_Price:  96.85351584501211
curr_Factors:  [96.85351585]
mat_Sqrt:  [[0.15]]
grads:  [0.10208824]
Stock Position:  0.10208824086906777
Bond Position:  [-20.84888893]


portfolio before change:  [-10.92636776]
curr_Stock_Price:  97.2210644742339
curr_Factors:  [97.22106447]
mat_Sqrt:  [[0.15]]
grads:  [-0.11814891]
Stock Position:  -0.11814891227482048
Bond Position:  [0.56019526]


portfolio before change:  [-10.98836988]
curr_Stock_Price:  97.74643665207479
curr_Factors:  [97.74643665]
mat_Sqrt:  [[0.15]]
grads:  [0.00470616]
Stock Position:  0.004706162437752897
Bond Position:  [-11.44838049]


portfolio before change:  [-10.9875984]
curr_Stock_Price:  98.21446462529009
curr_Factors:  [98.21446463]
mat_Sqrt:  [[0.15]]
grads:  [-0.04027763]
Stock Position:  -0.04027762977198484
Bond Position:  [-7.03175256]


portfolio before change:  [-10.9638623]
curr_Stock_Price:  97.60332820627501
curr_Factors:  [97.60332821]
mat_Sqrt:  [[0.15]]
grads:  [0.01079151]
Stock Position:  0.010791512543213035
Bond Position:  [-12.01714984]


portfolio before change:  [-10.96977881]
curr_Stock_Price:  97.19427778443125
curr_Factors:  [97.19427778]
mat_Sqrt:  [[0.15]]
grads:  [0.00853168]
Stock Position:  0.008531682108473763
Bond Position:  [-11.79900949]


portfolio before change:  [-10.96745259]
curr_Stock_Price:  97.63981571257276
curr_Factors:  [97.63981571]
mat_Sqrt:  [[0.15]]
grads:  [-0.17224428]
Stock Position:  -0.1722442844998055
Bond Position:  [5.8504476]


portfolio before change:  [-11.02894307]
curr_Stock_Price:  98.00105747013832
curr_Factors:  [98.00105747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02771607]
Stock Position:  -0.0277160719583475
Bond Position:  [-8.31273871]


portfolio before change:  [-11.03425244]
curr_Stock_Price:  98.15512742813789
curr_Factors:  [98.15512743]
mat_Sqrt:  [[0.15]]
grads:  [-0.09019729]
Stock Position:  -0.09019728797660233
Bond Position:  [-2.18092615]


portfolio before change:  [-11.10129817]
curr_Stock_Price:  98.89542794356545
curr_Factors:  [98.89542794]
mat_Sqrt:  [[0.15]]
grads:  [0.04537563]
Stock Position:  0.04537562535170011
Bond Position:  [-15.58874006]


portfolio before change:  [-11.08985571]
curr_Stock_Price:  99.19054616312157
curr_Factors:  [99.19054616]
mat_Sqrt:  [[0.15]]
grads:  [-0.04225842]
Stock Position:  -0.042258419313197404
Bond Position:  [-6.89822002]


portfolio before change:  [-11.13746489]
curr_Stock_Price:  100.2967598963783
curr_Factors:  [100.2967599]
mat_Sqrt:  [[0.15]]
grads:  [0.07155364]
Stock Position:  0.07155363595007884
Bond Position:  [-18.31406273]


portfolio before change:  [-11.09476431]
curr_Stock_Price:  100.92551872253874
curr_Factors:  [100.92551872]
mat_Sqrt:  [[0.15]]
grads:  [0.04195616]
Stock Position:  0.04195616272183892
Bond Position:  [-15.32921179]


portfolio before change:  [-11.08658882]
curr_Stock_Price:  101.1660496612447
curr_Factors:  [101.16604966]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798918]
Stock Position:  -0.017989180663366782
Bond Position:  [-9.26669448]


portfolio before change:  [-11.09166158]
curr_Stock_Price:  101.38364439043596
curr_Factors:  [101.38364439]
mat_Sqrt:  [[0.15]]
grads:  [-0.00415012]
Stock Position:  -0.004150116850629342
Bond Position:  [-10.67090761]


portfolio before change:  [-11.09363826]
curr_Stock_Price:  101.53851373184332
curr_Factors:  [101.53851373]
mat_Sqrt:  [[0.15]]
grads:  [0.01137013]
Stock Position:  0.011370126652109156
Bond Position:  [-12.24814402]


portfolio before change:  [-11.09929159]
curr_Stock_Price:  101.17596516785902
curr_Factors:  [101.17596517]
mat_Sqrt:  [[0.15]]
grads:  [-0.04424753]
Stock Position:  -0.044247533187439264
Bond Position:  [-6.62250472]


portfolio before change:  [-11.09511477]
curr_Stock_Price:  101.06285852217425
curr_Factors:  [101.06285852]
mat_Sqrt:  [[0.15]]
grads:  [-0.1850663]
Stock Position:  -0.18506630092570192
Bond Position:  [7.60821462]


portfolio before change:  [-10.99357206]
curr_Stock_Price:  100.51931479968104
curr_Factors:  [100.5193148]
mat_Sqrt:  [[0.15]]
grads:  [0.12475186]
Stock Position:  0.12475186477747471
Bond Position:  [-23.53354402]


portfolio before change:  [-10.92756096]
curr_Stock_Price:  101.072035785129
curr_Factors:  [101.07203579]
mat_Sqrt:  [[0.15]]
grads:  [-0.0251407]
Stock Position:  -0.0251406967221348
Bond Position:  [-8.38653956]


portfolio before change:  [-10.90493998]
curr_Stock_Price:  100.13055973980568
curr_Factors:  [100.13055974]
mat_Sqrt:  [[0.15]]
grads:  [-0.14115364]
Stock Position:  -0.14115364241455713
Bond Position:  [3.22885325]


portfolio before change:  [-10.7904711]
curr_Stock_Price:  99.32246693414953
curr_Factors:  [99.32246693]
mat_Sqrt:  [[0.15]]
grads:  [-0.14518878]
Stock Position:  -0.14518877971373562
Bond Position:  [3.63003667]


portfolio before change:  [-10.76252193]
curr_Stock_Price:  99.133090106406
curr_Factors:  [99.13309011]
mat_Sqrt:  [[0.15]]
grads:  [0.23423457]
Stock Position:  0.23423457089921487
Bond Position:  [-33.98291875]


portfolio before change:  [-10.97866816]
curr_Stock_Price:  98.22844950125467
curr_Factors:  [98.2284495]
mat_Sqrt:  [[0.15]]
grads:  [0.01745319]
Stock Position:  0.017453186932316567
Bond Position:  [-12.69306766]


portfolio before change:  [-10.97837719]
curr_Stock_Price:  98.33603488350667
curr_Factors:  [98.33603488]
mat_Sqrt:  [[0.15]]
grads:  [0.04704356]
Stock Position:  0.04704356195328534
Bond Position:  [-15.60445454]


portfolio before change:  [-10.97640161]
curr_Stock_Price:  98.41949503889542
curr_Factors:  [98.41949504]
mat_Sqrt:  [[0.15]]
grads:  [0.029935]
Stock Position:  0.02993499988750935
Bond Position:  [-13.92258918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.96095278]
Stock Price:  98.99371435517293
PL:  [-10.96095278]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.39458547e-03]
 [ 3.21527130e-02]
 [-2.46860996e-03]
 [-6.48899781e-03]
 [-6.58321709e-03]
 [ 3.56057307e-02]
 [ 3.55955989e-03]
 [ 2.49767237e-03]
 [ 3.89026680e-02]
 [ 2.34455779e-02]
 [ 2.16264783e-02]
 [-8.20851502e-03]
 [-1.09891773e-02]
 [ 1.54831757e-02]
 [-1.72442307e-02]
 [ 3.84502665e-04]
 [-6.11813819e-03]
 [-2.45630564e-03]
 [ 9.53051103e-04]
 [-8.89209485e-03]
 [-1.74331449e-02]
 [-2.24860964e-02]
 [ 4.51380824e-03]
 [-1.14585418e-02]
 [ 1.06502168e-02]
 [-4.09960114e-04]
 [ 2.94817950e-02]
 [-4.59508669e-03]
 [-2.69158513e-02]
 [-8.85713879e-03]
 [ 4.90245728e-02]
 [-1.91808101e-03]
 [-2.01982566e-02]
 [-1.16272914e-02]
 [-2.43893035e-02]
 [ 2.95476046e-02]
 [-1.63672785e-02]
 [-1.17203847e-02]
 [ 4.35720181e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.03799021]
curr_Stock_Price:  99.27470075669133
curr_Factors:  [99.27470076]
mat_Sqrt:  [[0.15]]
grads:  [-0.0359639]
Stock Position:  -0.03596390312347867
Bond Position:  [-10.46768449]


portfolio before change:  [-14.04649052]
curr_Stock_Price:  99.4746723766785
curr_Factors:  [99.47467238]
mat_Sqrt:  [[0.15]]
grads:  [0.21435142]
Stock Position:  0.21435142023061313
Bond Position:  [-35.36902782]


portfolio before change:  [-13.88535027]
curr_Stock_Price:  100.24705660630784
curr_Factors:  [100.24705661]
mat_Sqrt:  [[0.15]]
grads:  [-0.0164574]
Stock Position:  -0.016457399732948026
Bond Position:  [-12.23554438]


portfolio before change:  [-13.8809399]
curr_Stock_Price:  99.88613046241223
curr_Factors:  [99.88613046]
mat_Sqrt:  [[0.15]]
grads:  [-0.04325999]
Stock Position:  -0.0432599854159867
Bond Position:  [-9.55986735]


portfolio before change:  [-13.84764377]
curr_Stock_Price:  99.08883053397554
curr_Factors:  [99.08883053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388811]
Stock Position:  -0.04388811393145412
Bond Position:  [-9.49882189]


portfolio before change:  [-13.82724804]
curr_Stock_Price:  98.59705362263905
curr_Factors:  [98.59705362]
mat_Sqrt:  [[0.15]]
grads:  [0.23737154]
Stock Position:  0.23737153827882038
Bond Position:  [-37.23138233]


portfolio before change:  [-14.13504954]
curr_Stock_Price:  97.31995320897396
curr_Factors:  [97.31995321]
mat_Sqrt:  [[0.15]]
grads:  [0.0237304]
Stock Position:  0.023730399258904016
Bond Position:  [-16.44449089]


portfolio before change:  [-14.14371236]
curr_Stock_Price:  97.04152841173061
curr_Factors:  [97.04152841]
mat_Sqrt:  [[0.15]]
grads:  [0.01665115]
Stock Position:  0.016651149128069778
Bond Position:  [-15.75956532]


portfolio before change:  [-14.15380325]
curr_Stock_Price:  96.55382506531888
curr_Factors:  [96.55382507]
mat_Sqrt:  [[0.15]]
grads:  [0.25935112]
Stock Position:  0.25935111991095783
Bond Position:  [-39.19514592]


portfolio before change:  [-14.02589938]
curr_Stock_Price:  97.06588599028187
curr_Factors:  [97.06588599]
mat_Sqrt:  [[0.15]]
grads:  [0.15630385]
Stock Position:  0.15630385270245015
Bond Position:  [-29.19767132]


portfolio before change:  [-14.09820328]
curr_Stock_Price:  96.62665203330184
curr_Factors:  [96.62665203]
mat_Sqrt:  [[0.15]]
grads:  [0.14417652]
Stock Position:  0.14417652189826785
Bond Position:  [-28.02949789]


portfolio before change:  [-13.9988658]
curr_Stock_Price:  97.33995386355947
curr_Factors:  [97.33995386]
mat_Sqrt:  [[0.15]]
grads:  [-0.05472343]
Stock Position:  -0.054723433457252724
Bond Position:  [-8.67208932]


portfolio before change:  [-13.99729717]
curr_Stock_Price:  97.29147891615746
curr_Factors:  [97.29147892]
mat_Sqrt:  [[0.15]]
grads:  [-0.07326118]
Stock Position:  -0.07326118208139289
Bond Position:  [-6.86960842]


portfolio before change:  [-13.96284989]
curr_Stock_Price:  96.80955893228872
curr_Factors:  [96.80955893]
mat_Sqrt:  [[0.15]]
grads:  [0.10322117]
Stock Position:  0.10322117110799045
Bond Position:  [-23.95564594]


portfolio before change:  [-13.99398545]
curr_Stock_Price:  96.5369316120489
curr_Factors:  [96.53693161]
mat_Sqrt:  [[0.15]]
grads:  [-0.11496154]
Stock Position:  -0.11496153769787361
Bond Position:  [-2.89595135]


portfolio before change:  [-14.06965664]
curr_Stock_Price:  97.19201311555126
curr_Factors:  [97.19201312]
mat_Sqrt:  [[0.15]]
grads:  [0.00256335]
Stock Position:  0.00256335109796262
Bond Position:  [-14.3187939]


portfolio before change:  [-14.07219411]
curr_Stock_Price:  96.90040073822547
curr_Factors:  [96.90040074]
mat_Sqrt:  [[0.15]]
grads:  [-0.04078759]
Stock Position:  -0.04078758791567602
Bond Position:  [-10.11986049]


portfolio before change:  [-14.04498163]
curr_Stock_Price:  96.2022095051765
curr_Factors:  [96.20220951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01637537]
Stock Position:  -0.016375370920072622
Bond Position:  [-12.46963477]


portfolio before change:  [-14.05569481]
curr_Stock_Price:  96.76124244471865
curr_Factors:  [96.76124244]
mat_Sqrt:  [[0.15]]
grads:  [0.00635367]
Stock Position:  0.006353674017283255
Bond Position:  [-14.6704842]


portfolio before change:  [-14.06072103]
curr_Stock_Price:  96.25880914733872
curr_Factors:  [96.25880915]
mat_Sqrt:  [[0.15]]
grads:  [-0.05928063]
Stock Position:  -0.05928063232753407
Bond Position:  [-8.35443796]


portfolio before change:  [-13.977791]
curr_Stock_Price:  94.8422520178583
curr_Factors:  [94.84225202]
mat_Sqrt:  [[0.15]]
grads:  [-0.11622097]
Stock Position:  -0.11622096615080023
Bond Position:  [-2.95513284]


portfolio before change:  [-14.02916564]
curr_Stock_Price:  95.28111630545209
curr_Factors:  [95.28111631]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990731]
Stock Position:  -0.14990730901003554
Bond Position:  [0.2541701]


portfolio before change:  [-14.01406357]
curr_Stock_Price:  95.18058549471164
curr_Factors:  [95.18058549]
mat_Sqrt:  [[0.15]]
grads:  [0.03009205]
Stock Position:  0.030092054950839865
Bond Position:  [-16.87824298]


portfolio before change:  [-14.0210061]
curr_Stock_Price:  95.0199907780194
curr_Factors:  [95.01999078]
mat_Sqrt:  [[0.15]]
grads:  [-0.07639028]
Stock Position:  -0.07639027836495038
Bond Position:  [-6.76240256]


portfolio before change:  [-14.0045222]
curr_Stock_Price:  94.79313914516081
curr_Factors:  [94.79313915]
mat_Sqrt:  [[0.15]]
grads:  [0.07100145]
Stock Position:  0.07100144552494117
Bond Position:  [-20.7349721]


portfolio before change:  [-13.9792779]
curr_Stock_Price:  95.1851921100446
curr_Factors:  [95.18519211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273307]
Stock Position:  -0.0027330674272072614
Bond Position:  [-13.71913036]


portfolio before change:  [-13.97906623]
curr_Stock_Price:  94.48024151314038
curr_Factors:  [94.48024151]
mat_Sqrt:  [[0.15]]
grads:  [0.1965453]
Stock Position:  0.19654529989053715
Bond Position:  [-32.54871363]


portfolio before change:  [-13.81935874]
curr_Stock_Price:  95.31351675051734
curr_Factors:  [95.31351675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03063391]
Stock Position:  -0.030633911264511534
Bond Position:  [-10.89953292]


portfolio before change:  [-13.84071934]
curr_Stock_Price:  95.96632521902106
curr_Factors:  [95.96632522]
mat_Sqrt:  [[0.15]]
grads:  [-0.17943901]
Stock Position:  -0.17943900857823183
Bond Position:  [3.37938291]


portfolio before change:  [-13.54553132]
curr_Stock_Price:  94.3236190041334
curr_Factors:  [94.323619]
mat_Sqrt:  [[0.15]]
grads:  [-0.05904759]
Stock Position:  -0.059047591906641085
Bond Position:  [-7.97594876]


portfolio before change:  [-13.54334708]
curr_Stock_Price:  94.26974219668006
curr_Factors:  [94.2697422]
mat_Sqrt:  [[0.15]]
grads:  [0.32683049]
Stock Position:  0.32683048508334306
Bond Position:  [-44.35357265]


portfolio before change:  [-13.47055113]
curr_Stock_Price:  94.50943982428237
curr_Factors:  [94.50943982]
mat_Sqrt:  [[0.15]]
grads:  [-0.01278721]
Stock Position:  -0.012787206717470509
Bond Position:  [-12.26203938]


portfolio before change:  [-13.4773182]
curr_Stock_Price:  94.91877215450424
curr_Factors:  [94.91877215]
mat_Sqrt:  [[0.15]]
grads:  [-0.13465504]
Stock Position:  -0.1346550439068589
Bond Position:  [-0.69602676]


portfolio before change:  [-13.25359103]
curr_Stock_Price:  93.25664221858042
curr_Factors:  [93.25664222]
mat_Sqrt:  [[0.15]]
grads:  [-0.07751528]
Stock Position:  -0.07751527619515565
Bond Position:  [-6.02477665]


portfolio before change:  [-13.18140627]
curr_Stock_Price:  92.31569349930447
curr_Factors:  [92.3156935]
mat_Sqrt:  [[0.15]]
grads:  [-0.16259536]
Stock Position:  -0.1625953564798074
Bond Position:  [1.82869682]


portfolio before change:  [-13.19654451]
curr_Stock_Price:  92.41020321311827
curr_Factors:  [92.41020321]
mat_Sqrt:  [[0.15]]
grads:  [0.19698403]
Stock Position:  0.19698403040644197
Bond Position:  [-31.39987879]


portfolio before change:  [-13.52647699]
curr_Stock_Price:  90.75520989672566
curr_Factors:  [90.7552099]
mat_Sqrt:  [[0.15]]
grads:  [-0.10911519]
Stock Position:  -0.10911518989271052
Bond Position:  [-3.62370503]


portfolio before change:  [-13.6805299]
curr_Stock_Price:  92.16289578208216
curr_Factors:  [92.16289578]
mat_Sqrt:  [[0.15]]
grads:  [-0.0781359]
Stock Position:  -0.07813589811741677
Bond Position:  [-6.47929926]


portfolio before change:  [-13.69137215]
curr_Stock_Price:  92.2912911987493
curr_Factors:  [92.2912912]
mat_Sqrt:  [[0.15]]
grads:  [0.29048012]
Stock Position:  0.29048012079046
Bond Position:  [-40.50015757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.67702593]
Stock Price:  92.35810837513748
PL:  [-13.67702593]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.98956626e-02]
 [ 3.89919400e-02]
 [-7.30702436e-03]
 [-6.80497183e-03]
 [-6.79836459e-03]
 [ 3.19468850e-02]
 [ 3.66034986e-03]
 [ 1.30928331e-02]
 [ 5.73845757e-03]
 [ 2.28651284e-02]
 [ 1.92840237e-02]
 [-1.42977649e-02]
 [ 3.12611438e-02]
 [ 1.93075974e-02]
 [-9.48452361e-03]
 [-3.24690651e-03]
 [-4.82222574e-03]
 [ 7.70601246e-03]
 [ 1.94350053e-02]
 [ 7.75154874e-03]
 [ 1.68668163e-04]
 [-3.33825960e-03]
 [ 3.96595755e-03]
 [-1.19686871e-02]
 [ 5.22814910e-03]
 [ 5.52044546e-03]
 [-2.71934336e-03]
 [-1.17898579e-03]
 [ 1.10204939e-03]
 [-8.10482949e-03]
 [-2.67868741e-02]
 [ 1.89428569e-02]
 [-3.38949726e-03]
 [-2.07689109e-02]
 [-2.04115896e-02]
 [ 2.54165938e-02]
 [ 3.96067655e-03]
 [ 7.61944309e-03]
 [ 4.47840712e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.29778037]
curr_Stock_Price:  99.92763850132273
curr_Factors:  [99.9276385]
mat_Sqrt:  [[0.15]]
grads:  [0.13263775]
Stock Position:  0.13263775033551178
Bond Position:  [-12.9563968]


portfolio before change:  [0.2877907]
curr_Stock_Price:  99.86453413863308
curr_Factors:  [99.86453414]
mat_Sqrt:  [[0.15]]
grads:  [0.25994627]
Stock Position:  0.25994626668873116
Bond Position:  [-25.67162213]


portfolio before change:  [0.1746437]
curr_Stock_Price:  99.44160887552695
curr_Factors:  [99.44160888]
mat_Sqrt:  [[0.15]]
grads:  [-0.0487135]
Stock Position:  -0.04871349574407289
Bond Position:  [5.01879209]


portfolio before change:  [0.1764759]
curr_Stock_Price:  99.41687625852478
curr_Factors:  [99.41687626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04536648]
Stock Position:  -0.04536647889594777
Bond Position:  [4.68666952]


portfolio before change:  [0.12921702]
curr_Stock_Price:  100.47150419885894
curr_Factors:  [100.4715042]
mat_Sqrt:  [[0.15]]
grads:  [-0.04532243]
Stock Position:  -0.045322430589563
Bond Position:  [4.68282979]


portfolio before change:  [0.10548144]
curr_Stock_Price:  101.0081251859513
curr_Factors:  [101.00812519]
mat_Sqrt:  [[0.15]]
grads:  [0.21297923]
Stock Position:  0.2129792332054811
Bond Position:  [-21.40715161]


portfolio before change:  [0.17877989]
curr_Stock_Price:  101.36484780675376
curr_Factors:  [101.36484781]
mat_Sqrt:  [[0.15]]
grads:  [0.02440233]
Stock Position:  0.024402332412977748
Bond Position:  [-2.29475882]


portfolio before change:  [0.18830037]
curr_Stock_Price:  101.76674980037441
curr_Factors:  [101.7667498]
mat_Sqrt:  [[0.15]]
grads:  [0.08728555]
Stock Position:  0.08728555380022303
Bond Position:  [-8.69446674]


portfolio before change:  [0.24883935]
curr_Stock_Price:  102.47277567106681
curr_Factors:  [102.47277567]
mat_Sqrt:  [[0.15]]
grads:  [0.03825638]
Stock Position:  0.038256383785786705
Bond Position:  [-3.67139848]


portfolio before change:  [0.24264975]
curr_Stock_Price:  102.32297971823081
curr_Factors:  [102.32297972]
mat_Sqrt:  [[0.15]]
grads:  [0.15243419]
Stock Position:  0.15243418959884275
Bond Position:  [-15.35487074]


portfolio before change:  [-0.04327886]
curr_Stock_Price:  100.4598206978461
curr_Factors:  [100.4598207]
mat_Sqrt:  [[0.15]]
grads:  [0.12856016]
Stock Position:  0.1285601578347962
Bond Position:  [-12.95840927]


portfolio before change:  [-0.06758831]
curr_Stock_Price:  100.28333099708453
curr_Factors:  [100.283331]
mat_Sqrt:  [[0.15]]
grads:  [-0.09531843]
Stock Position:  -0.09531843281951904
Bond Position:  [9.49126164]


portfolio before change:  [-0.11840659]
curr_Stock_Price:  100.82892078309638
curr_Factors:  [100.82892078]
mat_Sqrt:  [[0.15]]
grads:  [0.20840763]
Stock Position:  0.20840762524212963
Bond Position:  [-21.13192253]


portfolio before change:  [0.02570427]
curr_Stock_Price:  101.53308177354421
curr_Factors:  [101.53308177]
mat_Sqrt:  [[0.15]]
grads:  [0.12871732]
Stock Position:  0.12871731575341347
Bond Position:  [-13.04336147]


portfolio before change:  [0.02210874]
curr_Stock_Price:  101.51781570183873
curr_Factors:  [101.5178157]
mat_Sqrt:  [[0.15]]
grads:  [-0.06323016]
Stock Position:  -0.06323015739034056
Bond Position:  [6.44109621]


portfolio before change:  [-0.08275023]
curr_Stock_Price:  103.18891957271252
curr_Factors:  [103.18891957]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164604]
Stock Position:  -0.021646043407898732
Bond Position:  [2.1508816]


portfolio before change:  [-0.09843113]
curr_Stock_Price:  103.92576455342483
curr_Factors:  [103.92576455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03214817]
Stock Position:  -0.03214817159392686
Bond Position:  [3.24259218]


portfolio before change:  [-0.08277033]
curr_Stock_Price:  103.45122907190878
curr_Factors:  [103.45122907]
mat_Sqrt:  [[0.15]]
grads:  [0.05137342]
Stock Position:  0.05137341639174685
Bond Position:  [-5.3974134]


portfolio before change:  [-0.07675016]
curr_Stock_Price:  103.5815474108981
curr_Factors:  [103.58154741]
mat_Sqrt:  [[0.15]]
grads:  [0.1295667]
Stock Position:  0.12956670182309205
Bond Position:  [-13.49746962]


portfolio before change:  [-0.04428977]
curr_Stock_Price:  103.84510025137199
curr_Factors:  [103.84510025]
mat_Sqrt:  [[0.15]]
grads:  [0.05167699]
Stock Position:  0.05167699160066509
Bond Position:  [-5.41069215]


portfolio before change:  [-0.0740988]
curr_Stock_Price:  103.28135522254873
curr_Factors:  [103.28135522]
mat_Sqrt:  [[0.15]]
grads:  [0.00112445]
Stock Position:  0.0011244544195484095
Bond Position:  [-0.19023397]


portfolio before change:  [-0.07412331]
curr_Stock_Price:  103.28070756208207
curr_Factors:  [103.28070756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225506]
Stock Position:  -0.022255064017168265
Bond Position:  [2.22439545]


portfolio before change:  [-0.06162192]
curr_Stock_Price:  102.7314699270487
curr_Factors:  [102.73146993]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [-2.77781291]


portfolio before change:  [-0.05937394]
curr_Stock_Price:  102.82962626175302
curr_Factors:  [102.82962626]
mat_Sqrt:  [[0.15]]
grads:  [-0.07979125]
Stock Position:  -0.07979124725496708
Bond Position:  [8.14553019]


portfolio before change:  [0.0627048]
curr_Stock_Price:  101.31241114994421
curr_Factors:  [101.31241115]
mat_Sqrt:  [[0.15]]
grads:  [0.03485433]
Stock Position:  0.03485432734415083
Bond Position:  [-3.46847115]


portfolio before change:  [0.05639057]
curr_Stock_Price:  101.14369069532927
curr_Factors:  [101.1436907]
mat_Sqrt:  [[0.15]]
grads:  [0.03680297]
Stock Position:  0.03680296974664681
Bond Position:  [-3.66599762]


portfolio before change:  [0.05622452]
curr_Stock_Price:  101.15163108720864
curr_Factors:  [101.15163109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01812896]
Stock Position:  -0.01812895573127663
Bond Position:  [1.88999797]


portfolio before change:  [0.05999436]
curr_Stock_Price:  100.9567177292499
curr_Factors:  [100.95671773]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785991]
Stock Position:  -0.007859905279930697
Bond Position:  [0.8535046]


portfolio before change:  [0.05898174]
curr_Stock_Price:  101.09912624465072
curr_Factors:  [101.09912624]
mat_Sqrt:  [[0.15]]
grads:  [0.007347]
Stock Position:  0.007346995935036743
Bond Position:  [-0.68379313]


portfolio before change:  [0.05479383]
curr_Stock_Price:  100.54074399370117
curr_Factors:  [100.54074399]
mat_Sqrt:  [[0.15]]
grads:  [-0.0540322]
Stock Position:  -0.05403219657008972
Bond Position:  [5.48723107]


portfolio before change:  [0.02134991]
curr_Stock_Price:  101.17240191747698
curr_Factors:  [101.17240192]
mat_Sqrt:  [[0.15]]
grads:  [-0.17857916]
Stock Position:  -0.1785791609956946
Bond Position:  [18.08863256]


portfolio before change:  [0.11647009]
curr_Stock_Price:  100.65241428874793
curr_Factors:  [100.65241429]
mat_Sqrt:  [[0.15]]
grads:  [0.12628571]
Stock Position:  0.12628571291145146
Bond Position:  [-12.59449181]


portfolio before change:  [0.21373501]
curr_Stock_Price:  101.43507866963276
curr_Factors:  [101.43507867]
mat_Sqrt:  [[0.15]]
grads:  [-0.02259665]
Stock Position:  -0.02259664838094238
Bond Position:  [2.50582781]


portfolio before change:  [0.19375904]
curr_Stock_Price:  102.33296458972906
curr_Factors:  [102.33296459]
mat_Sqrt:  [[0.15]]
grads:  [-0.13845941]
Stock Position:  -0.13845940604453905
Bond Position:  [14.36272054]


portfolio before change:  [0.2047559]
curr_Stock_Price:  102.26650896887
curr_Factors:  [102.26650897]
mat_Sqrt:  [[0.15]]
grads:  [-0.13607726]
Stock Position:  -0.13607726385137472
Bond Position:  [14.12090262]


portfolio before change:  [0.31553345]
curr_Stock_Price:  101.46540284827802
curr_Factors:  [101.46540285]
mat_Sqrt:  [[0.15]]
grads:  [0.16944396]
Stock Position:  0.16944395864576806
Bond Position:  [-16.87716607]


portfolio before change:  [0.12539187]
curr_Stock_Price:  100.35570377120366
curr_Factors:  [100.35570377]
mat_Sqrt:  [[0.15]]
grads:  [0.02640451]
Stock Position:  0.02640451030411178
Bond Position:  [-2.52445134]


portfolio before change:  [0.08532194]
curr_Stock_Price:  98.85011421295933
curr_Factors:  [98.85011421]
mat_Sqrt:  [[0.15]]
grads:  [0.05079629]
Stock Position:  0.05079628727303087
Bond Position:  [-4.93589686]


portfolio before change:  [0.0667573]
curr_Stock_Price:  98.496788912135
curr_Factors:  [98.49678891]
mat_Sqrt:  [[0.15]]
grads:  [0.02985605]
Stock Position:  0.029856047464975288
Bond Position:  [-2.87396751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.06576104]
Stock Price:  98.47545358358757
PL:  [0.06576104]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.77440538e-03]
 [ 7.03360298e-03]
 [-1.09711295e-02]
 [-6.85550944e-03]
 [-6.79020343e-03]
 [ 3.58434304e-02]
 [ 3.57726098e-03]
 [ 4.01404064e-03]
 [-2.64031526e-02]
 [ 2.34055037e-02]
 [ 2.12686266e-02]
 [-5.86169500e-03]
 [-1.16484065e-02]
 [ 7.07071434e-03]
 [-1.18361587e-02]
 [-5.31749215e-04]
 [-6.14246925e-03]
 [ 4.06343126e-03]
 [ 6.25492772e-03]
 [-4.50790939e-03]
 [-4.79750916e-03]
 [-5.42283537e-03]
 [ 5.51584047e-03]
 [-1.23229475e-02]
 [ 3.81625371e-03]
 [ 3.06718066e-03]
 [-2.51552952e-03]
 [-1.01188631e-05]
 [ 1.93327554e-03]
 [-6.55844161e-03]
 [-1.84876406e-02]
 [ 1.84705115e-02]
 [-9.21493711e-03]
 [-3.17450562e-02]
 [-2.17516594e-02]
 [ 3.18011986e-02]
 [ 3.12853823e-03]
 [ 7.11928236e-03]
 [ 6.03307575e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.37536356]
curr_Stock_Price:  99.71479524754511
curr_Factors:  [99.71479525]
mat_Sqrt:  [[0.15]]
grads:  [0.01182937]
Stock Position:  0.01182936917316496
Bond Position:  [-5.55492668]


portfolio before change:  [-4.39154439]
curr_Stock_Price:  98.40564507310668
curr_Factors:  [98.40564507]
mat_Sqrt:  [[0.15]]
grads:  [0.04689069]
Stock Position:  0.04689068655433467
Bond Position:  [-9.00585265]


portfolio before change:  [-4.35193575]
curr_Stock_Price:  99.27435569614771
curr_Factors:  [99.2743557]
mat_Sqrt:  [[0.15]]
grads:  [-0.07314086]
Stock Position:  -0.0731408634612266
Bond Position:  [2.90907634]


portfolio before change:  [-4.3688539]
curr_Stock_Price:  99.51063683626037
curr_Factors:  [99.51063684]
mat_Sqrt:  [[0.15]]
grads:  [-0.0457034]
Stock Position:  -0.045703396251574324
Bond Position:  [0.17912017]


portfolio before change:  [-4.35267565]
curr_Stock_Price:  99.15714313179019
curr_Factors:  [99.15714313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04526802]
Stock Position:  -0.04526802283596765
Bond Position:  [0.13597217]


portfolio before change:  [-4.32645459]
curr_Stock_Price:  98.57827854141141
curr_Factors:  [98.57827854]
mat_Sqrt:  [[0.15]]
grads:  [0.2389562]
Stock Position:  0.2389562025525546
Bond Position:  [-27.88234569]


portfolio before change:  [-4.0935063]
curr_Stock_Price:  99.56772262599084
curr_Factors:  [99.56772263]
mat_Sqrt:  [[0.15]]
grads:  [0.02384841]
Stock Position:  0.023848406505250563
Bond Position:  [-6.46803783]


portfolio before change:  [-4.08104963]
curr_Stock_Price:  100.12395384647607
curr_Factors:  [100.12395385]
mat_Sqrt:  [[0.15]]
grads:  [0.02676027]
Stock Position:  0.026760270959157485
Bond Position:  [-6.76039377]


portfolio before change:  [-4.11079485]
curr_Stock_Price:  99.04399012773803
curr_Factors:  [99.04399013]
mat_Sqrt:  [[0.15]]
grads:  [-0.17602102]
Stock Position:  -0.1760210171661472
Bond Position:  [13.32302903]


portfolio before change:  [-4.17491333]
curr_Stock_Price:  99.41771799490428
curr_Factors:  [99.41771799]
mat_Sqrt:  [[0.15]]
grads:  [0.15603669]
Stock Position:  0.15603669154411093
Bond Position:  [-19.68772513]


portfolio before change:  [-4.46672642]
curr_Stock_Price:  97.56333383012068
curr_Factors:  [97.56333383]
mat_Sqrt:  [[0.15]]
grads:  [0.14179084]
Stock Position:  0.14179084414757454
Bond Position:  [-18.30031388]


portfolio before change:  [-4.60380676]
curr_Stock_Price:  96.61268956642334
curr_Factors:  [96.61268957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03907797]
Stock Position:  -0.0390779666626713
Bond Position:  [-0.82837929]


portfolio before change:  [-4.62815417]
curr_Stock_Price:  97.23308681602819
curr_Factors:  [97.23308682]
mat_Sqrt:  [[0.15]]
grads:  [-0.07765604]
Stock Position:  -0.07765604349046767
Bond Position:  [2.92258265]


portfolio before change:  [-4.7133259]
curr_Stock_Price:  98.33457321611205
curr_Factors:  [98.33457322]
mat_Sqrt:  [[0.15]]
grads:  [0.0471381]
Stock Position:  0.0471380956329772
Bond Position:  [-9.34863042]


portfolio before change:  [-4.69416644]
curr_Stock_Price:  98.76581925386864
curr_Factors:  [98.76581925]
mat_Sqrt:  [[0.15]]
grads:  [-0.07890772]
Stock Position:  -0.07890772448213852
Bond Position:  [3.09921962]


portfolio before change:  [-4.70514992]
curr_Stock_Price:  98.90992313588114
curr_Factors:  [98.90992314]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354499]
Stock Position:  -0.003544994763993277
Bond Position:  [-4.35451476]


portfolio before change:  [-4.70821348]
curr_Stock_Price:  99.62056225951576
curr_Factors:  [99.62056226]
mat_Sqrt:  [[0.15]]
grads:  [-0.0409498]
Stock Position:  -0.04094979502132339
Bond Position:  [-0.62877188]


portfolio before change:  [-4.68835918]
curr_Stock_Price:  99.13379778458506
curr_Factors:  [99.13379778]
mat_Sqrt:  [[0.15]]
grads:  [0.02708954]
Stock Position:  0.027089541706043756
Bond Position:  [-7.37384833]


portfolio before change:  [-4.6735053]
curr_Stock_Price:  99.71615027473364
curr_Factors:  [99.71615027]
mat_Sqrt:  [[0.15]]
grads:  [0.04169952]
Stock Position:  0.041699518158526815
Bond Position:  [-8.83162072]


portfolio before change:  [-4.6563291]
curr_Stock_Price:  100.15452999221169
curr_Factors:  [100.15452999]
mat_Sqrt:  [[0.15]]
grads:  [-0.03005273]
Stock Position:  -0.03005272927963147
Bond Position:  [-1.64641213]


portfolio before change:  [-4.66006941]
curr_Stock_Price:  100.27213974848088
curr_Factors:  [100.27213975]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198339]
Stock Position:  -0.03198339436876998
Bond Position:  [-1.45302602]


portfolio before change:  [-4.64898697]
curr_Stock_Price:  99.91995437129978
curr_Factors:  [99.91995437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615224]
Stock Position:  -0.03615223578289063
Bond Position:  [-1.03665722]


portfolio before change:  [-4.6905409]
curr_Stock_Price:  101.06578518270223
curr_Factors:  [101.06578518]
mat_Sqrt:  [[0.15]]
grads:  [0.03677227]
Stock Position:  0.03677226982516779
Bond Position:  [-8.40695922]


portfolio before change:  [-4.65180594]
curr_Stock_Price:  102.14773903703086
curr_Factors:  [102.14773904]
mat_Sqrt:  [[0.15]]
grads:  [-0.08215298]
Stock Position:  -0.08215298321630381
Bond Position:  [3.73993555]


portfolio before change:  [-4.61676836]
curr_Stock_Price:  101.72693798262124
curr_Factors:  [101.72693798]
mat_Sqrt:  [[0.15]]
grads:  [0.02544169]
Stock Position:  0.025441691366922186
Bond Position:  [-7.20487372]


portfolio before change:  [-4.60931818]
curr_Stock_Price:  102.05517252161313
curr_Factors:  [102.05517252]
mat_Sqrt:  [[0.15]]
grads:  [0.02044787]
Stock Position:  0.020447871039700763
Bond Position:  [-6.69612919]


portfolio before change:  [-4.61411209]
curr_Stock_Price:  101.86166353254072
curr_Factors:  [101.86166353]
mat_Sqrt:  [[0.15]]
grads:  [-0.0167702]
Stock Position:  -0.016770196819004282
Bond Position:  [-2.90587195]


portfolio before change:  [-4.61441743]
curr_Stock_Price:  101.8582100001556
curr_Factors:  [101.85821]
mat_Sqrt:  [[0.15]]
grads:  [-6.74590874e-05]
Stock Position:  -6.745908741614497e-05
Bond Position:  [-4.60754617]


portfolio before change:  [-4.61498295]
curr_Stock_Price:  101.70306050811175
curr_Factors:  [101.70306051]
mat_Sqrt:  [[0.15]]
grads:  [0.0128885]
Stock Position:  0.01288850356960881
Bond Position:  [-5.92578321]


portfolio before change:  [-4.62043404]
curr_Stock_Price:  101.33759344407622
curr_Factors:  [101.33759344]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372294]
Stock Position:  -0.04372294405351027
Bond Position:  [-0.18965611]


portfolio before change:  [-4.56336777]
curr_Stock_Price:  100.031872135345
curr_Factors:  [100.03187214]
mat_Sqrt:  [[0.15]]
grads:  [-0.12325094]
Stock Position:  -0.123250937233981
Bond Position:  [7.76565422]


portfolio before change:  [-4.61302493]
curr_Stock_Price:  100.44264326345613
curr_Factors:  [100.44264326]
mat_Sqrt:  [[0.15]]
grads:  [0.12313674]
Stock Position:  0.12313674358200603
Bond Position:  [-16.98120494]


portfolio before change:  [-4.74280376]
curr_Stock_Price:  99.40594175242121
curr_Factors:  [99.40594175]
mat_Sqrt:  [[0.15]]
grads:  [-0.06143291]
Stock Position:  -0.06143291404456643
Bond Position:  [1.36399292]


portfolio before change:  [-4.75205704]
curr_Stock_Price:  99.55934148799771
curr_Factors:  [99.55934149]
mat_Sqrt:  [[0.15]]
grads:  [-0.21163371]
Stock Position:  -0.21163370819288332
Bond Position:  [16.31805558]


portfolio before change:  [-4.71168191]
curr_Stock_Price:  99.37820185634793
curr_Factors:  [99.37820186]
mat_Sqrt:  [[0.15]]
grads:  [-0.14501106]
Stock Position:  -0.14501106248259094
Bond Position:  [9.69925673]


portfolio before change:  [-4.74009866]
curr_Stock_Price:  99.58252585801597
curr_Factors:  [99.58252586]
mat_Sqrt:  [[0.15]]
grads:  [0.21200799]
Stock Position:  0.21200799089321098
Bond Position:  [-25.8523899]


portfolio before change:  [-4.82590944]
curr_Stock_Price:  99.19301683249707
curr_Factors:  [99.19301683]
mat_Sqrt:  [[0.15]]
grads:  [0.02085692]
Stock Position:  0.020856921538248252
Bond Position:  [-6.89477041]


portfolio before change:  [-4.84206109]
curr_Stock_Price:  98.45993910110323
curr_Factors:  [98.4599391]
mat_Sqrt:  [[0.15]]
grads:  [0.04746188]
Stock Position:  0.047461882404891055
Bond Position:  [-9.51515514]


portfolio before change:  [-4.86907423]
curr_Stock_Price:  97.91584614549458
curr_Factors:  [97.91584615]
mat_Sqrt:  [[0.15]]
grads:  [0.04022051]
Stock Position:  0.04022050500996261
Bond Position:  [-8.80729901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.84568255]
Stock Price:  98.52480577473824
PL:  [-4.84568255]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.70064622e-03]
 [ 2.22006726e-02]
 [-1.05431840e-02]
 [-6.73522400e-03]
 [-7.73918596e-03]
 [ 3.12594672e-02]
 [ 3.67326776e-03]
 [ 4.37324835e-03]
 [-8.95669827e-03]
 [ 2.29548700e-02]
 [ 1.98970452e-02]
 [-1.24219788e-02]
 [ 2.29498216e-02]
 [ 1.34474644e-02]
 [-2.83274672e-03]
 [-3.73209017e-03]
 [-6.03842758e-03]
 [ 5.75360286e-03]
 [ 1.18901689e-02]
 [ 1.08784851e-02]
 [-3.62572685e-03]
 [-5.98083645e-03]
 [ 4.53672806e-03]
 [-1.15498853e-02]
 [ 7.22921271e-04]
 [ 3.54637800e-03]
 [-1.17492708e-03]
 [ 1.08394128e-03]
 [ 5.05829376e-03]
 [-2.05210440e-03]
 [-1.45373492e-02]
 [ 4.09441812e-03]
 [ 1.13422317e-02]
 [ 4.85294571e-02]
 [-2.00539531e-02]
 [-1.13118790e-02]
 [ 1.34024910e-02]
 [ 1.89838963e-02]
 [ 8.38029502e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.19972551]
curr_Stock_Price:  99.63170276405724
curr_Factors:  [99.63170276]
mat_Sqrt:  [[0.15]]
grads:  [-0.03800431]
Stock Position:  -0.038004308135894165
Bond Position:  [-2.41329158]


portfolio before change:  [-6.17673926]
curr_Stock_Price:  99.01893179237467
curr_Factors:  [99.01893179]
mat_Sqrt:  [[0.15]]
grads:  [0.14800448]
Stock Position:  0.148004484008438
Bond Position:  [-20.83198516]


portfolio before change:  [-6.13864839]
curr_Stock_Price:  99.29388986435943
curr_Factors:  [99.29388986]
mat_Sqrt:  [[0.15]]
grads:  [-0.07028789]
Stock Position:  -0.07028789342067264
Bond Position:  [0.84050996]


portfolio before change:  [-6.13809248]
curr_Stock_Price:  99.28747563610926
curr_Factors:  [99.28747564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490149]
Stock Position:  -0.04490149332766858
Bond Position:  [-1.67993655]


portfolio before change:  [-6.1797152]
curr_Stock_Price:  100.2097771293116
curr_Factors:  [100.20977713]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159457]
Stock Position:  -0.05159457308123937
Bond Position:  [-1.00943453]


portfolio before change:  [-6.18730666]
curr_Stock_Price:  100.35446831724353
curr_Factors:  [100.35446832]
mat_Sqrt:  [[0.15]]
grads:  [0.20839645]
Stock Position:  0.2083964481369669
Bond Position:  [-27.10082142]


portfolio before change:  [-6.23658121]
curr_Stock_Price:  100.13427873357311
curr_Factors:  [100.13427873]
mat_Sqrt:  [[0.15]]
grads:  [0.02448845]
Stock Position:  0.02448845171133817
Bond Position:  [-8.68871465]


portfolio before change:  [-6.236394]
curr_Stock_Price:  100.18627729312014
curr_Factors:  [100.18627729]
mat_Sqrt:  [[0.15]]
grads:  [0.02915499]
Stock Position:  0.02915498899203452
Bond Position:  [-9.15732381]


portfolio before change:  [-6.1833222]
curr_Stock_Price:  102.04587463085339
curr_Factors:  [102.04587463]
mat_Sqrt:  [[0.15]]
grads:  [-0.05971132]
Stock Position:  -0.059711321810086634
Bond Position:  [-0.09002814]


portfolio before change:  [-6.17222295]
curr_Stock_Price:  101.85980436523128
curr_Factors:  [101.85980437]
mat_Sqrt:  [[0.15]]
grads:  [0.15303247]
Stock Position:  0.15303246658598824
Bond Position:  [-21.76008006]


portfolio before change:  [-6.31161457]
curr_Stock_Price:  100.96671650746563
curr_Factors:  [100.96671651]
mat_Sqrt:  [[0.15]]
grads:  [0.13264697]
Stock Position:  0.13264696778433058
Bond Position:  [-19.70454336]


portfolio before change:  [-6.26328429]
curr_Stock_Price:  101.34963890316727
curr_Factors:  [101.3496389]
mat_Sqrt:  [[0.15]]
grads:  [-0.08281319]
Stock Position:  -0.08281319194172894
Bond Position:  [2.12980281]


portfolio before change:  [-6.26842904]
curr_Stock_Price:  101.41497865489853
curr_Factors:  [101.41497865]
mat_Sqrt:  [[0.15]]
grads:  [0.15299881]
Stock Position:  0.1529988106901242
Bond Position:  [-21.78480017]


portfolio before change:  [-6.33084096]
curr_Stock_Price:  101.02485374106217
curr_Factors:  [101.02485374]
mat_Sqrt:  [[0.15]]
grads:  [0.08964976]
Stock Position:  0.08964976289943512
Bond Position:  [-15.38769515]


portfolio before change:  [-6.31779912]
curr_Stock_Price:  101.19178590886808
curr_Factors:  [101.19178591]
mat_Sqrt:  [[0.15]]
grads:  [-0.01888498]
Stock Position:  -0.018884978111629244
Bond Position:  [-4.40679445]


portfolio before change:  [-6.31206119]
curr_Stock_Price:  100.85877987001314
curr_Factors:  [100.85877987]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248806]
Stock Position:  -0.024880601137281952
Bond Position:  [-3.80263411]


portfolio before change:  [-6.30852563]
curr_Stock_Price:  100.6975732527956
curr_Factors:  [100.69757325]
mat_Sqrt:  [[0.15]]
grads:  [-0.04025618]
Stock Position:  -0.04025618386072128
Bond Position:  [-2.25482561]


portfolio before change:  [-6.30367544]
curr_Stock_Price:  100.57008831885398
curr_Factors:  [100.57008832]
mat_Sqrt:  [[0.15]]
grads:  [0.03835735]
Stock Position:  0.03835735240405618
Bond Position:  [-10.16127776]


portfolio before change:  [-6.25947974]
curr_Stock_Price:  101.75541374936373
curr_Factors:  [101.75541375]
mat_Sqrt:  [[0.15]]
grads:  [0.07926779]
Stock Position:  0.07926779285279288
Bond Position:  [-14.3254068]


portfolio before change:  [-6.3127838]
curr_Stock_Price:  101.1055498480791
curr_Factors:  [101.10554985]
mat_Sqrt:  [[0.15]]
grads:  [0.07252323]
Stock Position:  0.07252323420276464
Bond Position:  [-13.64528527]


portfolio before change:  [-6.29145478]
curr_Stock_Price:  101.42316933811028
curr_Factors:  [101.42316934]
mat_Sqrt:  [[0.15]]
grads:  [-0.02417151]
Stock Position:  -0.024171512303617252
Bond Position:  [-3.83990339]


portfolio before change:  [-6.29576564]
curr_Stock_Price:  101.58165528633053
curr_Factors:  [101.58165529]
mat_Sqrt:  [[0.15]]
grads:  [-0.03987224]
Stock Position:  -0.03987224297288132
Bond Position:  [-2.2454772]


portfolio before change:  [-6.29997308]
curr_Stock_Price:  101.68013834277247
curr_Factors:  [101.68013834]
mat_Sqrt:  [[0.15]]
grads:  [0.03024485]
Stock Position:  0.030244853747026658
Bond Position:  [-9.37527399]


portfolio before change:  [-6.30712019]
curr_Stock_Price:  101.48258007392282
curr_Factors:  [101.48258007]
mat_Sqrt:  [[0.15]]
grads:  [-0.07699924]
Stock Position:  -0.07699923531649852
Bond Position:  [1.50696088]


portfolio before change:  [-6.40228087]
curr_Stock_Price:  102.72089199109766
curr_Factors:  [102.72089199]
mat_Sqrt:  [[0.15]]
grads:  [0.00481948]
Stock Position:  0.004819475137097998
Bond Position:  [-6.89734166]


portfolio before change:  [-6.40228325]
curr_Stock_Price:  102.89930315321322
curr_Factors:  [102.89930315]
mat_Sqrt:  [[0.15]]
grads:  [0.02364252]
Stock Position:  0.02364252000335744
Bond Position:  [-8.83508208]


portfolio before change:  [-6.4129912]
curr_Stock_Price:  102.49310710917509
curr_Factors:  [102.49310711]
mat_Sqrt:  [[0.15]]
grads:  [-0.00783285]
Stock Position:  -0.007832847183376138
Bond Position:  [-5.61017835]


portfolio before change:  [-6.41735296]
curr_Stock_Price:  102.96042646500086
curr_Factors:  [102.96042647]
mat_Sqrt:  [[0.15]]
grads:  [0.00722628]
Stock Position:  0.007226275226097154
Bond Position:  [-7.16137334]


portfolio before change:  [-6.40989932]
curr_Stock_Price:  104.11577449269872
curr_Factors:  [104.11577449]
mat_Sqrt:  [[0.15]]
grads:  [0.03372196]
Stock Position:  0.03372195836727402
Bond Position:  [-9.92088713]


portfolio before change:  [-6.37470708]
curr_Stock_Price:  105.19615149572125
curr_Factors:  [105.1961515]
mat_Sqrt:  [[0.15]]
grads:  [-0.0136807]
Stock Position:  -0.01368069596789624
Bond Position:  [-4.93555052]


portfolio before change:  [-6.39989708]
curr_Stock_Price:  106.99233301282008
curr_Factors:  [106.99233301]
mat_Sqrt:  [[0.15]]
grads:  [-0.09691566]
Stock Position:  -0.09691566141897305
Bond Position:  [3.96933564]


portfolio before change:  [-6.35172154]
curr_Stock_Price:  106.50036568177019
curr_Factors:  [106.50036568]
mat_Sqrt:  [[0.15]]
grads:  [0.02729612]
Stock Position:  0.027296120786880578
Bond Position:  [-9.25876839]


portfolio before change:  [-6.32239286]
curr_Stock_Price:  107.61723145529973
curr_Factors:  [107.61723146]
mat_Sqrt:  [[0.15]]
grads:  [0.07561488]
Stock Position:  0.07561487820388584
Bond Position:  [-14.4598567]


portfolio before change:  [-6.42141256]
curr_Stock_Price:  106.33160995453805
curr_Factors:  [106.33160995]
mat_Sqrt:  [[0.15]]
grads:  [0.32352971]
Stock Position:  0.3235297140425256
Bond Position:  [-40.82284793]


portfolio before change:  [-6.33800506]
curr_Stock_Price:  106.60518814635817
curr_Factors:  [106.60518815]
mat_Sqrt:  [[0.15]]
grads:  [-0.13369302]
Stock Position:  -0.1336930209118034
Bond Position:  [7.91436458]


portfolio before change:  [-6.24261596]
curr_Stock_Price:  105.89909481170064
curr_Factors:  [105.89909481]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541253]
Stock Position:  -0.07541252633579909
Bond Position:  [1.74350232]


portfolio before change:  [-6.22235847]
curr_Stock_Price:  105.63336266790508
curr_Factors:  [105.63336267]
mat_Sqrt:  [[0.15]]
grads:  [0.08934994]
Stock Position:  0.08934994001252607
Bond Position:  [-15.66069309]


portfolio before change:  [-6.18874386]
curr_Stock_Price:  106.03148628001453
curr_Factors:  [106.03148628]
mat_Sqrt:  [[0.15]]
grads:  [0.12655931]
Stock Position:  0.12655930871260407
Bond Position:  [-19.60801547]


portfolio before change:  [-6.10092936]
curr_Stock_Price:  106.74471436254419
curr_Factors:  [106.74471436]
mat_Sqrt:  [[0.15]]
grads:  [0.05586863]
Stock Position:  0.055868633467425245
Bond Position:  [-12.06461068]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.07426973]
Stock Price:  107.24889362815446
PL:  [-13.32316335]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.07433164e-02]
 [ 3.53203677e-02]
 [-1.51789351e-03]
 [-2.60361889e-03]
 [-3.55154143e-03]
 [ 1.67367593e-02]
 [ 3.70369755e-03]
 [ 4.40653624e-03]
 [-2.22693572e-02]
 [ 2.31851708e-02]
 [ 1.93582050e-02]
 [-1.38708194e-02]
 [ 1.98413432e-02]
 [ 2.33822408e-02]
 [-1.06258028e-02]
 [-3.10163725e-03]
 [-4.96606238e-03]
 [ 7.94404409e-03]
 [ 2.33943387e-02]
 [ 3.15810995e-03]
 [ 8.25988120e-04]
 [-4.06562848e-03]
 [ 4.58646345e-03]
 [-9.42445197e-03]
 [-5.84603020e-03]
 [ 4.28794008e-03]
 [ 4.38620475e-03]
 [ 1.23719750e-03]
 [ 4.29793305e-03]
 [-5.40349106e-03]
 [-1.34864537e-02]
 [ 3.60810804e-03]
 [ 1.34598949e-02]
 [ 8.13895645e-02]
 [-1.99476594e-02]
 [-2.34617657e-02]
 [ 2.46897056e-02]
 [ 1.12737107e-02]
 [ 8.08438481e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.81614868]
curr_Stock_Price:  99.55808107113123
curr_Factors:  [99.55808107]
mat_Sqrt:  [[0.15]]
grads:  [-0.07162211]
Stock Position:  -0.07162210920595109
Bond Position:  [-0.68558893]


portfolio before change:  [-7.82694421]
curr_Stock_Price:  99.70761344891422
curr_Factors:  [99.70761345]
mat_Sqrt:  [[0.15]]
grads:  [0.23546912]
Stock Position:  0.235469117856337
Bond Position:  [-31.305008]


portfolio before change:  [-7.77020532]
curr_Stock_Price:  99.96519400308595
curr_Factors:  [99.965194]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011929]
Stock Position:  -0.010119290094533554
Bond Position:  [-6.75862852]


portfolio before change:  [-7.78476615]
curr_Stock_Price:  101.3206204213647
curr_Factors:  [101.32062042]
mat_Sqrt:  [[0.15]]
grads:  [-0.01735746]
Stock Position:  -0.01735745923512506
Bond Position:  [-6.02609761]


portfolio before change:  [-7.78037693]
curr_Stock_Price:  101.02434820399553
curr_Factors:  [101.0243482]
mat_Sqrt:  [[0.15]]
grads:  [-0.02367694]
Stock Position:  -0.023676942856400613
Bond Position:  [-5.38842921]


portfolio before change:  [-7.80386069]
curr_Stock_Price:  101.98773971957121
curr_Factors:  [101.98773972]
mat_Sqrt:  [[0.15]]
grads:  [0.1115784]
Stock Position:  0.11157839546583714
Bond Position:  [-19.18348905]


portfolio before change:  [-7.98017983]
curr_Stock_Price:  100.42900557769941
curr_Factors:  [100.42900558]
mat_Sqrt:  [[0.15]]
grads:  [0.02469132]
Stock Position:  0.02469131698794501
Bond Position:  [-10.45990424]


portfolio before change:  [-7.98733808]
curr_Stock_Price:  100.19205282742377
curr_Factors:  [100.19205283]
mat_Sqrt:  [[0.15]]
grads:  [0.02937691]
Stock Position:  0.029376908299953618
Bond Position:  [-10.93067082]


portfolio before change:  [-7.97452881]
curr_Stock_Price:  100.67459804316445
curr_Factors:  [100.67459804]
mat_Sqrt:  [[0.15]]
grads:  [-0.14846238]
Stock Position:  -0.14846238149239388
Bond Position:  [6.97186177]


portfolio before change:  [-8.02331879]
curr_Stock_Price:  101.00910377695872
curr_Factors:  [101.00910378]
mat_Sqrt:  [[0.15]]
grads:  [0.15456781]
Stock Position:  0.154567805167553
Bond Position:  [-23.63607426]


portfolio before change:  [-8.10206269]
curr_Stock_Price:  100.51877392352088
curr_Factors:  [100.51877392]
mat_Sqrt:  [[0.15]]
grads:  [0.1290547]
Stock Position:  0.12905470006924477
Bond Position:  [-21.07448291]


portfolio before change:  [-8.0600991]
curr_Stock_Price:  100.86434881385158
curr_Factors:  [100.86434881]
mat_Sqrt:  [[0.15]]
grads:  [-0.09247213]
Stock Position:  -0.09247212907748881
Bond Position:  [1.26704198]


portfolio before change:  [-8.13069565]
curr_Stock_Price:  101.62949762086193
curr_Factors:  [101.62949762]
mat_Sqrt:  [[0.15]]
grads:  [0.13227562]
Stock Position:  0.13227562156919626
Bond Position:  [-21.57380062]


portfolio before change:  [-7.96956417]
curr_Stock_Price:  102.86803556178717
curr_Factors:  [102.86803556]
mat_Sqrt:  [[0.15]]
grads:  [0.15588161]
Stock Position:  0.15588160549264354
Bond Position:  [-24.00479871]


portfolio before change:  [-7.90106501]
curr_Stock_Price:  103.32671669137306
curr_Factors:  [103.32671669]
mat_Sqrt:  [[0.15]]
grads:  [-0.07083869]
Stock Position:  -0.07083868554662884
Bond Position:  [-0.58153621]


portfolio before change:  [-7.86031107]
curr_Stock_Price:  102.75038419973558
curr_Factors:  [102.7503842]
mat_Sqrt:  [[0.15]]
grads:  [-0.02067758]
Stock Position:  -0.02067758164395433
Bond Position:  [-5.73568161]


portfolio before change:  [-7.87873393]
curr_Stock_Price:  103.6066672307962
curr_Factors:  [103.60666723]
mat_Sqrt:  [[0.15]]
grads:  [-0.03310708]
Stock Position:  -0.03310708252264544
Bond Position:  [-4.44861945]


portfolio before change:  [-7.90052475]
curr_Stock_Price:  104.24806179553246
curr_Factors:  [104.2480618]
mat_Sqrt:  [[0.15]]
grads:  [0.05296029]
Stock Position:  0.05296029391972866
Bond Position:  [-13.42153274]


portfolio before change:  [-7.88674911]
curr_Stock_Price:  104.5398547486306
curr_Factors:  [104.53985475]
mat_Sqrt:  [[0.15]]
grads:  [0.15596226]
Stock Position:  0.1559622579433798
Bond Position:  [-24.1910209]


portfolio before change:  [-7.91666961]
curr_Stock_Price:  104.36739996270542
curr_Factors:  [104.36739996]
mat_Sqrt:  [[0.15]]
grads:  [0.02105407]
Stock Position:  0.02105406632019864
Bond Position:  [-10.11402777]


portfolio before change:  [-7.92693975]
curr_Stock_Price:  103.93965318604143
curr_Factors:  [103.93965319]
mat_Sqrt:  [[0.15]]
grads:  [0.00550659]
Stock Position:  0.005506587469640497
Bond Position:  [-8.49929254]


portfolio before change:  [-7.93077397]
curr_Stock_Price:  103.4363023582829
curr_Factors:  [103.43630236]
mat_Sqrt:  [[0.15]]
grads:  [-0.02710419]
Stock Position:  -0.027104189861902203
Bond Position:  [-5.1272168]


portfolio before change:  [-7.93636971]
curr_Stock_Price:  103.61910770174286
curr_Factors:  [103.6191077]
mat_Sqrt:  [[0.15]]
grads:  [0.03057642]
Stock Position:  0.030576423029759024
Bond Position:  [-11.10467138]


portfolio before change:  [-7.91095313]
curr_Stock_Price:  104.49575526608355
curr_Factors:  [104.49575527]
mat_Sqrt:  [[0.15]]
grads:  [-0.06282968]
Stock Position:  -0.06282967978086056
Bond Position:  [-1.34551829]


portfolio before change:  [-7.93987684]
curr_Stock_Price:  104.95342922734358
curr_Factors:  [104.95342923]
mat_Sqrt:  [[0.15]]
grads:  [-0.03897353]
Stock Position:  -0.03897353463565155
Bond Position:  [-3.84947073]


portfolio before change:  [-7.88642639]
curr_Stock_Price:  103.56962689086377
curr_Factors:  [103.56962689]
mat_Sqrt:  [[0.15]]
grads:  [0.02858627]
Stock Position:  0.028586267229842265
Bond Position:  [-10.84709542]


portfolio before change:  [-7.87771379]
curr_Stock_Price:  103.92184397132722
curr_Factors:  [103.92184397]
mat_Sqrt:  [[0.15]]
grads:  [0.02924137]
Stock Position:  0.029241365019824786
Bond Position:  [-10.91653036]


portfolio before change:  [-7.8996337]
curr_Stock_Price:  103.21889229973813
curr_Factors:  [103.2188923]
mat_Sqrt:  [[0.15]]
grads:  [0.00824798]
Stock Position:  0.008247983321457326
Bond Position:  [-8.75098141]


portfolio before change:  [-7.90065353]
curr_Stock_Price:  103.22787782499562
curr_Factors:  [103.22787782]
mat_Sqrt:  [[0.15]]
grads:  [0.02865289]
Stock Position:  0.02865288697305487
Bond Position:  [-10.85843025]


portfolio before change:  [-7.88562468]
curr_Stock_Price:  103.79976593602396
curr_Factors:  [103.79976594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03602327]
Stock Position:  -0.03602327373102568
Bond Position:  [-4.14641729]


portfolio before change:  [-7.95910665]
curr_Stock_Price:  105.82522438879546
curr_Factors:  [105.82522439]
mat_Sqrt:  [[0.15]]
grads:  [-0.08990969]
Stock Position:  -0.08990969122506845
Bond Position:  [1.55560659]


portfolio before change:  [-8.09410718]
curr_Stock_Price:  107.32889972643017
curr_Factors:  [107.32889973]
mat_Sqrt:  [[0.15]]
grads:  [0.02405405]
Stock Position:  0.024054053574808002
Bond Position:  [-10.67580228]


portfolio before change:  [-8.0702496]
curr_Stock_Price:  108.3762133524835
curr_Factors:  [108.37621335]
mat_Sqrt:  [[0.15]]
grads:  [0.08973263]
Stock Position:  0.08973263279423578
Bond Position:  [-17.79513255]


portfolio before change:  [-8.06807253]
curr_Stock_Price:  108.4252656920936
curr_Factors:  [108.42526569]
mat_Sqrt:  [[0.15]]
grads:  [0.5425971]
Stock Position:  0.5425970967273207
Bond Position:  [-66.89930691]


portfolio before change:  [-7.54139106]
curr_Stock_Price:  109.41134618157629
curr_Factors:  [109.41134618]
mat_Sqrt:  [[0.15]]
grads:  [-0.1329844]
Stock Position:  -0.1329843962615048
Bond Position:  [7.00861076]


portfolio before change:  [-7.33211692]
curr_Stock_Price:  107.84425999460537
curr_Factors:  [107.84425999]
mat_Sqrt:  [[0.15]]
grads:  [-0.15641177]
Stock Position:  -0.15641177129817646
Bond Position:  [9.53599481]


portfolio before change:  [-7.32390617]
curr_Stock_Price:  107.79938693108558
curr_Factors:  [107.79938693]
mat_Sqrt:  [[0.15]]
grads:  [0.16459804]
Stock Position:  0.16459803702072334
Bond Position:  [-25.06747365]


portfolio before change:  [-7.20603504]
curr_Stock_Price:  108.5345400252752
curr_Factors:  [108.53454003]
mat_Sqrt:  [[0.15]]
grads:  [0.07515807]
Stock Position:  0.0751580711237471
Bond Position:  [-15.36328172]


portfolio before change:  [-7.21485326]
curr_Stock_Price:  108.44276433196208
curr_Factors:  [108.44276433]
mat_Sqrt:  [[0.15]]
grads:  [0.0538959]
Stock Position:  0.05389589871019951
Bond Position:  [-13.0594735]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.21351084]
Stock Price:  108.4979624765476
PL:  [-15.71147331]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.80985974e-02]
 [-2.00762368e-02]
 [ 1.03232385e-02]
 [-5.11284854e-04]
 [-6.64574300e-04]
 [-4.97457205e-03]
 [ 3.41508772e-03]
 [ 3.95246900e-02]
 [ 9.29583144e-02]
 [ 2.25900486e-02]
 [ 1.52498929e-02]
 [ 7.64516391e-03]
 [-5.19029348e-03]
 [ 2.32764052e-02]
 [-9.13244791e-03]
 [-5.05977215e-03]
 [-4.51141016e-03]
 [ 7.94404409e-03]
 [ 2.15911879e-02]
 [ 1.49971096e-02]
 [-2.39119692e-04]
 [-3.67934345e-03]
 [ 4.27843825e-03]
 [-1.18963563e-02]
 [ 1.72454993e-03]
 [ 2.88650935e-03]
 [-5.68202510e-04]
 [ 9.74984957e-04]
 [ 3.76361647e-03]
 [-6.40570201e-03]
 [-2.88765740e-02]
 [ 1.85445013e-02]
 [-3.72353703e-03]
 [-2.06056326e-02]
 [-2.16821057e-02]
 [ 3.86525486e-02]
 [ 3.90733031e-04]
 [ 6.96518757e-03]
 [ 8.59395044e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.03945855]
curr_Stock_Price:  100.78124793975644
curr_Factors:  [100.78124794]
mat_Sqrt:  [[0.15]]
grads:  [-0.25399065]
Stock Position:  -0.25399064900627233
Bond Position:  [44.63695312]


portfolio before change:  [18.82387559]
curr_Stock_Price:  101.65200017503025
curr_Factors:  [101.65200018]
mat_Sqrt:  [[0.15]]
grads:  [-0.13384158]
Stock Position:  -0.13384157833509047
Bond Position:  [32.42913973]


portfolio before change:  [18.74645394]
curr_Stock_Price:  102.26074629359452
curr_Factors:  [102.26074629]
mat_Sqrt:  [[0.15]]
grads:  [0.06882159]
Stock Position:  0.06882158978309803
Bond Position:  [11.70870681]


portfolio before change:  [18.7133099]
curr_Stock_Price:  101.75788481177636
curr_Factors:  [101.75788481]
mat_Sqrt:  [[0.15]]
grads:  [-0.00340857]
Stock Position:  -0.003408565693086904
Bond Position:  [19.06015833]


portfolio before change:  [18.7138204]
curr_Stock_Price:  102.30713705966876
curr_Factors:  [102.30713706]
mat_Sqrt:  [[0.15]]
grads:  [-0.0044305]
Stock Position:  -0.004430495336092631
Bond Position:  [19.1670917]


portfolio before change:  [18.71361237]
curr_Stock_Price:  102.89489827223036
curr_Factors:  [102.89489827]
mat_Sqrt:  [[0.15]]
grads:  [-0.03316381]
Stock Position:  -0.03316381365645762
Bond Position:  [22.1259996]


portfolio before change:  [18.69081265]
curr_Stock_Price:  103.66578784200655
curr_Factors:  [103.66578784]
mat_Sqrt:  [[0.15]]
grads:  [0.02276725]
Stock Position:  0.022767251484594842
Bond Position:  [16.33062759]


portfolio before change:  [18.71133324]
curr_Stock_Price:  104.47744207853832
curr_Factors:  [104.47744208]
mat_Sqrt:  [[0.15]]
grads:  [0.26349793]
Stock Position:  0.26349793325482535
Bond Position:  [-8.81825682]


portfolio before change:  [18.8320867]
curr_Stock_Price:  104.93989659614945
curr_Factors:  [104.9398966]
mat_Sqrt:  [[0.15]]
grads:  [0.6197221]
Stock Position:  0.619722096305128
Bond Position:  [-46.201486]


portfolio before change:  [18.19167403]
curr_Stock_Price:  103.91582930923538
curr_Factors:  [103.91582931]
mat_Sqrt:  [[0.15]]
grads:  [0.15060032]
Stock Position:  0.1506003241050243
Bond Position:  [2.54191645]


portfolio before change:  [18.28796113]
curr_Stock_Price:  104.55307459362476
curr_Factors:  [104.55307459]
mat_Sqrt:  [[0.15]]
grads:  [0.10166595]
Stock Position:  0.10166595272939491
Bond Position:  [7.65847319]


portfolio before change:  [18.31316742]
curr_Stock_Price:  104.79159015800053
curr_Factors:  [104.79159016]
mat_Sqrt:  [[0.15]]
grads:  [0.05096776]
Stock Position:  0.05096775940249553
Bond Position:  [12.97217486]


portfolio before change:  [18.36383786]
curr_Stock_Price:  105.75394020139277
curr_Factors:  [105.7539402]
mat_Sqrt:  [[0.15]]
grads:  [-0.03460196]
Stock Position:  -0.0346019565273954
Bond Position:  [22.02313111]


portfolio before change:  [18.37096864]
curr_Stock_Price:  105.62742385234249
curr_Factors:  [105.62742385]
mat_Sqrt:  [[0.15]]
grads:  [0.15517603]
Stock Position:  0.15517603466670624
Bond Position:  [1.98012386]


portfolio before change:  [18.20761829]
curr_Stock_Price:  104.57315097617025
curr_Factors:  [104.57315098]
mat_Sqrt:  [[0.15]]
grads:  [-0.06088299]
Stock Position:  -0.06088298605108795
Bond Position:  [24.57434398]


portfolio before change:  [18.14048646]
curr_Stock_Price:  105.7262451476867
curr_Factors:  [105.72624515]
mat_Sqrt:  [[0.15]]
grads:  [-0.03373181]
Stock Position:  -0.03373181432201141
Bond Position:  [21.70682453]


portfolio before change:  [18.18067418]
curr_Stock_Price:  104.6152996977148
curr_Factors:  [104.6152997]
mat_Sqrt:  [[0.15]]
grads:  [-0.03007607]
Stock Position:  -0.030076067760060554
Bond Position:  [21.32709103]


portfolio before change:  [18.19816616]
curr_Stock_Price:  104.12235229611642
curr_Factors:  [104.1223523]
mat_Sqrt:  [[0.15]]
grads:  [0.05296029]
Stock Position:  0.05296029391972866
Bond Position:  [12.68381578]


portfolio before change:  [18.19874931]
curr_Stock_Price:  104.10342455965217
curr_Factors:  [104.10342456]
mat_Sqrt:  [[0.15]]
grads:  [0.14394125]
Stock Position:  0.14394125268526964
Bond Position:  [3.21397197]


portfolio before change:  [18.03627548]
curr_Stock_Price:  102.97188236356642
curr_Factors:  [102.97188236]
mat_Sqrt:  [[0.15]]
grads:  [0.09998073]
Stock Position:  0.09998073083355724
Bond Position:  [7.74107143]


portfolio before change:  [18.04478625]
curr_Stock_Price:  103.04732758697226
curr_Factors:  [103.04732759]
mat_Sqrt:  [[0.15]]
grads:  [-0.00159413]
Stock Position:  -0.0015941312819680751
Bond Position:  [18.20905722]


portfolio before change:  [18.04747898]
curr_Stock_Price:  102.78608132602581
curr_Factors:  [102.78608133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02452896]
Stock Position:  -0.02452895636643004
Bond Position:  [20.56871429]


portfolio before change:  [18.07296528]
curr_Stock_Price:  101.85187758283323
curr_Factors:  [101.85187758]
mat_Sqrt:  [[0.15]]
grads:  [0.02852292]
Stock Position:  0.028522921657725304
Bond Position:  [15.16785215]


portfolio before change:  [18.07287359]
curr_Stock_Price:  101.78218663758715
curr_Factors:  [101.78218664]
mat_Sqrt:  [[0.15]]
grads:  [-0.07930904]
Stock Position:  -0.07930904216905342
Bond Position:  [26.14512132]


portfolio before change:  [18.03056999]
curr_Stock_Price:  102.35679876102127
curr_Factors:  [102.35679876]
mat_Sqrt:  [[0.15]]
grads:  [0.011497]
Stock Position:  0.01149699950208061
Bond Position:  [16.85377393]


portfolio before change:  [18.03129189]
curr_Stock_Price:  102.23633670890513
curr_Factors:  [102.23633671]
mat_Sqrt:  [[0.15]]
grads:  [0.0192434]
Stock Position:  0.01924339569099794
Bond Position:  [16.06391761]


portfolio before change:  [18.04371877]
curr_Stock_Price:  102.77775679339898
curr_Factors:  [102.77775679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00378802]
Stock Position:  -0.003788016736173868
Bond Position:  [18.43304263]


portfolio before change:  [18.04602715]
curr_Stock_Price:  102.7766721671118
curr_Factors:  [102.77667217]
mat_Sqrt:  [[0.15]]
grads:  [0.0064999]
Stock Position:  0.006499899711509978
Bond Position:  [17.37798909]


portfolio before change:  [18.04875729]
curr_Stock_Price:  102.86248213486205
curr_Factors:  [102.86248213]
mat_Sqrt:  [[0.15]]
grads:  [0.02509078]
Stock Position:  0.025090776467452554
Bond Position:  [15.46785775]


portfolio before change:  [18.02030203]
curr_Stock_Price:  101.65132515899349
curr_Factors:  [101.65132516]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270468]
Stock Position:  -0.04270468009335172
Bond Position:  [22.36128935]


portfolio before change:  [18.06429516]
curr_Stock_Price:  100.68661133275029
curr_Factors:  [100.68661133]
mat_Sqrt:  [[0.15]]
grads:  [-0.19251049]
Stock Position:  -0.19251049303260695
Bond Position:  [37.44752435]


portfolio before change:  [17.98275944]
curr_Stock_Price:  101.13446717156158
curr_Factors:  [101.13446717]
mat_Sqrt:  [[0.15]]
grads:  [0.12363001]
Stock Position:  0.12363000888594526
Bond Position:  [5.47950437]


portfolio before change:  [17.97745114]
curr_Stock_Price:  101.08598954828427
curr_Factors:  [101.08598955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02482358]
Stock Position:  -0.024823580221053656
Bond Position:  [20.48676731]


portfolio before change:  [18.00025217]
curr_Stock_Price:  100.27063458110165
curr_Factors:  [100.27063458]
mat_Sqrt:  [[0.15]]
grads:  [-0.13737088]
Stock Position:  -0.1373708842358389
Bond Position:  [31.77451791]


portfolio before change:  [18.10684193]
curr_Stock_Price:  99.52362263320333
curr_Factors:  [99.52362263]
mat_Sqrt:  [[0.15]]
grads:  [-0.14454737]
Stock Position:  -0.1445473715542776
Bond Position:  [32.49271999]


portfolio before change:  [18.31893443]
curr_Stock_Price:  98.08443590132511
curr_Factors:  [98.0844359]
mat_Sqrt:  [[0.15]]
grads:  [0.25768366]
Stock Position:  0.2576836576370531
Bond Position:  [-6.95582177]


portfolio before change:  [18.13183597]
curr_Stock_Price:  97.36173221530652
curr_Factors:  [97.36173222]
mat_Sqrt:  [[0.15]]
grads:  [0.00260489]
Stock Position:  0.0026048868755485723
Bond Position:  [17.87821967]


portfolio before change:  [18.1358442]
curr_Stock_Price:  98.04249769076416
curr_Factors:  [98.04249769]
mat_Sqrt:  [[0.15]]
grads:  [0.04643458]
Stock Position:  0.04643458378741813
Bond Position:  [13.58328163]


portfolio before change:  [18.10582668]
curr_Stock_Price:  97.35948226078186
curr_Factors:  [97.35948226]
mat_Sqrt:  [[0.15]]
grads:  [0.057293]
Stock Position:  0.05729300295552075
Bond Position:  [12.52780958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.18582615]
Stock Price:  98.72846963009896
PL:  [18.18582615]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-6.55892048e-03]
 [ 3.08463161e-02]
 [-1.67168133e-03]
 [-6.80777742e-03]
 [-7.67887170e-03]
 [ 2.86878176e-02]
 [ 3.63682381e-03]
 [ 8.78880049e-03]
 [-1.27329452e-02]
 [ 2.29988981e-02]
 [ 1.91097213e-02]
 [-1.15581655e-02]
 [ 1.64989172e-02]
 [ 1.00423494e-02]
 [ 5.08262819e-03]
 [-3.52630191e-03]
 [-5.26756484e-03]
 [ 7.59122152e-03]
 [ 1.87660322e-02]
 [ 1.27299535e-02]
 [-6.72520861e-04]
 [-7.96065711e-03]
 [ 5.80723703e-03]
 [-7.87529249e-03]
 [-5.26380816e-03]
 [ 4.69032641e-03]
 [ 6.74523956e-03]
 [ 2.90807579e-03]
 [ 5.42326230e-03]
 [-2.62897956e-03]
 [-1.52035995e-02]
 [ 5.58230702e-03]
 [ 5.33283099e-03]
 [ 2.50369524e-02]
 [-2.01929988e-02]
 [-4.38560229e-03]
 [ 4.67435216e-03]
 [ 2.30954019e-02]
 [ 9.34284922e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.44660849]
curr_Stock_Price:  99.62045821930646
curr_Factors:  [99.62045822]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372614]
Stock Position:  -0.04372613653087303
Bond Position:  [-2.09059073]


portfolio before change:  [-6.43476095]
curr_Stock_Price:  99.34353281655777
curr_Factors:  [99.34353282]
mat_Sqrt:  [[0.15]]
grads:  [0.20564211]
Stock Position:  0.2056421075799427
Bond Position:  [-26.86397441]


portfolio before change:  [-6.32870839]
curr_Stock_Price:  99.87557741459315
curr_Factors:  [99.87557741]
mat_Sqrt:  [[0.15]]
grads:  [-0.01114454]
Stock Position:  -0.011144542221218311
Bond Position:  [-5.2156408]


portfolio before change:  [-6.32430638]
curr_Stock_Price:  99.42208136653208
curr_Factors:  [99.42208137]
mat_Sqrt:  [[0.15]]
grads:  [-0.04538518]
Stock Position:  -0.045385182825338155
Bond Position:  [-1.81201704]


portfolio before change:  [-6.35251965]
curr_Stock_Price:  100.03873097708623
curr_Factors:  [100.03873098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05119248]
Stock Position:  -0.05119247801741699
Bond Position:  [-1.23128911]


portfolio before change:  [-6.34571921]
curr_Stock_Price:  99.90288366558376
curr_Factors:  [99.90288367]
mat_Sqrt:  [[0.15]]
grads:  [0.19125212]
Stock Position:  0.19125211703535452
Bond Position:  [-25.45235721]


portfolio before change:  [-6.34191325]
curr_Stock_Price:  99.93942025137088
curr_Factors:  [99.93942025]
mat_Sqrt:  [[0.15]]
grads:  [0.02424549]
Stock Position:  0.02424549209004889
Bond Position:  [-8.76499368]


portfolio before change:  [-6.30900646]
curr_Stock_Price:  101.34184515649383
curr_Factors:  [101.34184516]
mat_Sqrt:  [[0.15]]
grads:  [0.058592]
Stock Position:  0.058592003291073017
Bond Position:  [-12.24682819]


portfolio before change:  [-6.28527532]
curr_Stock_Price:  101.77299778534001
curr_Factors:  [101.77299779]
mat_Sqrt:  [[0.15]]
grads:  [-0.0848863]
Stock Position:  -0.08488630135051778
Bond Position:  [2.35385804]


portfolio before change:  [-6.27576471]
curr_Stock_Price:  101.66442482967322
curr_Factors:  [101.66442483]
mat_Sqrt:  [[0.15]]
grads:  [0.15332599]
Stock Position:  0.15332598706413322
Bond Position:  [-21.86356299]


portfolio before change:  [-6.21719144]
curr_Stock_Price:  102.06426823496263
curr_Factors:  [102.06426823]
mat_Sqrt:  [[0.15]]
grads:  [0.12739814]
Stock Position:  0.12739814207032216
Bond Position:  [-19.21998958]


portfolio before change:  [-6.29071563]
curr_Stock_Price:  101.5060062594267
curr_Factors:  [101.50600626]
mat_Sqrt:  [[0.15]]
grads:  [-0.07705444]
Stock Position:  -0.07705443655095459
Bond Position:  [1.53077249]


portfolio before change:  [-6.3178135]
curr_Stock_Price:  101.86016152901598
curr_Factors:  [101.86016153]
mat_Sqrt:  [[0.15]]
grads:  [0.10999278]
Stock Position:  0.10999278158541353
Bond Position:  [-17.521696]


portfolio before change:  [-6.4449451]
curr_Stock_Price:  100.72425743571063
curr_Factors:  [100.72425744]
mat_Sqrt:  [[0.15]]
grads:  [0.066949]
Stock Position:  0.0669489959943693
Bond Position:  [-13.18833301]


portfolio before change:  [-6.46692926]
curr_Stock_Price:  100.4205110511302
curr_Factors:  [100.42051105]
mat_Sqrt:  [[0.15]]
grads:  [0.03388419]
Stock Position:  0.033884187932126296
Bond Position:  [-9.86959673]


portfolio before change:  [-6.46896711]
curr_Stock_Price:  100.3967809855292
curr_Factors:  [100.39678099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02350868]
Stock Position:  -0.023508679429613058
Bond Position:  [-4.10877137]


portfolio before change:  [-6.52760694]
curr_Stock_Price:  102.86932305117219
curr_Factors:  [102.86932305]
mat_Sqrt:  [[0.15]]
grads:  [-0.0351171]
Stock Position:  -0.035117098936927806
Bond Position:  [-2.91513475]


portfolio before change:  [-6.5396978]
curr_Stock_Price:  103.20324702553765
curr_Factors:  [103.20324703]
mat_Sqrt:  [[0.15]]
grads:  [0.05060814]
Stock Position:  0.05060814346712399
Bond Position:  [-11.76262253]


portfolio before change:  [-6.53021743]
curr_Stock_Price:  103.4196308193129
curr_Factors:  [103.41963082]
mat_Sqrt:  [[0.15]]
grads:  [0.12510688]
Stock Position:  0.1251068815632313
Bond Position:  [-19.46872494]


portfolio before change:  [-6.55024159]
curr_Stock_Price:  103.27902775789975
curr_Factors:  [103.27902776]
mat_Sqrt:  [[0.15]]
grads:  [0.08486636]
Stock Position:  0.08486635643234836
Bond Position:  [-15.31515637]


portfolio before change:  [-6.59292821]
curr_Stock_Price:  102.79860058474719
curr_Factors:  [102.79860058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00448347]
Stock Position:  -0.004483472406850703
Bond Position:  [-6.13203352]


portfolio before change:  [-6.60017659]
curr_Stock_Price:  104.24431679258372
curr_Factors:  [104.24431679]
mat_Sqrt:  [[0.15]]
grads:  [-0.05307105]
Stock Position:  -0.05307104739814414
Bond Position:  [-1.06782151]


portfolio before change:  [-6.61651272]
curr_Stock_Price:  104.54961782729146
curr_Factors:  [104.54961783]
mat_Sqrt:  [[0.15]]
grads:  [0.03871491]
Stock Position:  0.03871491354933558
Bond Position:  [-10.66414213]


portfolio before change:  [-6.59485407]
curr_Stock_Price:  105.14349099871924
curr_Factors:  [105.143491]
mat_Sqrt:  [[0.15]]
grads:  [-0.05250195]
Stock Position:  -0.05250194993584977
Bond Position:  [-1.07461577]


portfolio before change:  [-6.57596309]
curr_Stock_Price:  104.78111754853728
curr_Factors:  [104.78111755]
mat_Sqrt:  [[0.15]]
grads:  [-0.03509205]
Stock Position:  -0.03509205442053868
Bond Position:  [-2.89897841]


portfolio before change:  [-6.60265421]
curr_Stock_Price:  105.53139327993132
curr_Factors:  [105.53139328]
mat_Sqrt:  [[0.15]]
grads:  [0.03126884]
Stock Position:  0.03126884271302636
Bond Position:  [-9.90249874]


portfolio before change:  [-6.58090552]
curr_Stock_Price:  106.26652057336318
curr_Factors:  [106.26652057]
mat_Sqrt:  [[0.15]]
grads:  [0.04496826]
Stock Position:  0.04496826375515574
Bond Position:  [-11.35952644]


portfolio before change:  [-6.59650444]
curr_Stock_Price:  105.95121156655215
curr_Factors:  [105.95121157]
mat_Sqrt:  [[0.15]]
grads:  [0.01938717]
Stock Position:  0.019387171924691873
Bond Position:  [-8.6505988]


portfolio before change:  [-6.60290733]
curr_Stock_Price:  105.67672635998298
curr_Factors:  [105.67672636]
mat_Sqrt:  [[0.15]]
grads:  [0.03615508]
Stock Position:  0.03615508197086754
Bond Position:  [-10.42365803]


portfolio before change:  [-6.6255799]
curr_Stock_Price:  105.08567447978352
curr_Factors:  [105.08567448]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752653]
Stock Position:  -0.017526530387999544
Bond Position:  [-4.78379263]


portfolio before change:  [-6.62465517]
curr_Stock_Price:  104.99879257627869
curr_Factors:  [104.99879258]
mat_Sqrt:  [[0.15]]
grads:  [-0.10135733]
Stock Position:  -0.10135732993179804
Bond Position:  [4.01774209]


portfolio before change:  [-6.59943936]
curr_Stock_Price:  104.75496653174169
curr_Factors:  [104.75496653]
mat_Sqrt:  [[0.15]]
grads:  [0.03721538]
Stock Position:  0.03721538013744469
Bond Position:  [-10.49793526]


portfolio before change:  [-6.57438596]
curr_Stock_Price:  105.4634298510049
curr_Factors:  [105.46342985]
mat_Sqrt:  [[0.15]]
grads:  [0.03555221]
Stock Position:  0.03555220661901427
Bond Position:  [-10.3238436]


portfolio before change:  [-6.58406626]
curr_Stock_Price:  105.22744608917172
curr_Factors:  [105.22744609]
mat_Sqrt:  [[0.15]]
grads:  [0.16691302]
Stock Position:  0.1669130157769667
Bond Position:  [-24.14789663]


portfolio before change:  [-6.67369932]
curr_Stock_Price:  104.70852679216328
curr_Factors:  [104.70852679]
mat_Sqrt:  [[0.15]]
grads:  [-0.13461999]
Stock Position:  -0.13461999180030254
Bond Position:  [7.4221617]


portfolio before change:  [-6.73792349]
curr_Stock_Price:  105.19249646230287
curr_Factors:  [105.19249646]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923735]
Stock Position:  -0.02923734857282291
Bond Position:  [-3.6623738]


portfolio before change:  [-6.70075144]
curr_Stock_Price:  103.90544832627023
curr_Factors:  [103.90544833]
mat_Sqrt:  [[0.15]]
grads:  [0.03116235]
Stock Position:  0.03116234773426122
Bond Position:  [-9.93868915]


portfolio before change:  [-6.70521868]
curr_Stock_Price:  103.80196346940764
curr_Factors:  [103.80196347]
mat_Sqrt:  [[0.15]]
grads:  [0.15396935]
Stock Position:  0.15396934568770684
Bond Position:  [-22.68753908]


portfolio before change:  [-6.50193846]
curr_Stock_Price:  105.14064771356736
curr_Factors:  [105.14064771]
mat_Sqrt:  [[0.15]]
grads:  [0.06228566]
Stock Position:  0.06228566148179721
Bond Position:  [-13.05069325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.45930934]
Stock Price:  105.85125370904275
PL:  [-12.31056305]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.23063094e-02]
 [ 5.30756207e-03]
 [-1.57070918e-02]
 [-8.96877095e-03]
 [-5.44715465e-03]
 [ 4.00742475e-02]
 [ 3.58032584e-03]
 [-3.00476718e-03]
 [-2.33400971e-02]
 [ 2.34344396e-02]
 [ 2.03301300e-02]
 [-9.38395809e-03]
 [-7.92492520e-03]
 [ 1.13192796e-02]
 [-1.66745528e-02]
 [ 4.43030421e-04]
 [-6.10393123e-03]
 [ 9.93161413e-04]
 [ 9.95104169e-04]
 [-1.42115254e-02]
 [-5.54070704e-03]
 [-7.41763629e-03]
 [ 7.05161090e-03]
 [-6.52813669e-03]
 [ 1.22566755e-02]
 [ 7.86605678e-03]
 [-2.22996850e-03]
 [-3.49958305e-03]
 [-1.60790906e-02]
 [-1.37244228e-02]
 [ 2.05098161e-02]
 [ 7.84700995e-03]
 [-1.50034382e-02]
 [-4.65631073e-02]
 [-2.29418522e-02]
 [ 3.73405302e-02]
 [-3.54291026e-03]
 [-8.36322003e-06]
 [ 1.62029743e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.12736513]
curr_Stock_Price:  99.49836033937825
curr_Factors:  [99.49836034]
mat_Sqrt:  [[0.15]]
grads:  [-0.08204206]
Stock Position:  -0.08204206263575721
Bond Position:  [-0.96431442]


portfolio before change:  [-9.03146148]
curr_Stock_Price:  98.3279339230125
curr_Factors:  [98.32793392]
mat_Sqrt:  [[0.15]]
grads:  [0.03538375]
Stock Position:  0.03538374712369105
Bond Position:  [-12.51067223]


portfolio before change:  [-9.03339466]
curr_Stock_Price:  98.31749854047611
curr_Factors:  [98.31749854]
mat_Sqrt:  [[0.15]]
grads:  [-0.10471395]
Stock Position:  -0.10471394523720208
Bond Position:  [1.2618185]


portfolio before change:  [-8.91317274]
curr_Stock_Price:  97.1709065224637
curr_Factors:  [97.17090652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05979181]
Stock Position:  -0.05979180630978853
Bond Position:  [-3.10314872]


portfolio before change:  [-8.96409137]
curr_Stock_Price:  98.01601739013032
curr_Factors:  [98.01601739]
mat_Sqrt:  [[0.15]]
grads:  [-0.03631436]
Stock Position:  -0.03631436432842645
Bond Position:  [-5.404702]


portfolio before change:  [-8.97284466]
curr_Stock_Price:  98.23845439586266
curr_Factors:  [98.2384544]
mat_Sqrt:  [[0.15]]
grads:  [0.26716165]
Stock Position:  0.26716165003680564
Bond Position:  [-35.21839223]


portfolio before change:  [-9.03937788]
curr_Stock_Price:  98.00589613693329
curr_Factors:  [98.00589614]
mat_Sqrt:  [[0.15]]
grads:  [0.02386884]
Stock Position:  0.023868838944999145
Bond Position:  [-11.37866483]


portfolio before change:  [-9.02611069]
curr_Stock_Price:  98.62132665095663
curr_Factors:  [98.62132665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02003178]
Stock Position:  -0.02003178117885163
Bond Position:  [-7.05054985]


portfolio before change:  [-9.03006243]
curr_Stock_Price:  98.7746013153122
curr_Factors:  [98.77460132]
mat_Sqrt:  [[0.15]]
grads:  [-0.15560065]
Stock Position:  -0.15560064759448258
Bond Position:  [6.3393295]


portfolio before change:  [-9.06130838]
curr_Stock_Price:  98.98050289430425
curr_Factors:  [98.98050289]
mat_Sqrt:  [[0.15]]
grads:  [0.1562296]
Stock Position:  0.15622959712291498
Bond Position:  [-24.52499247]


portfolio before change:  [-9.08029222]
curr_Stock_Price:  98.87861426704475
curr_Factors:  [98.87861427]
mat_Sqrt:  [[0.15]]
grads:  [0.1355342]
Stock Position:  0.13553420030562313
Bond Position:  [-22.48172613]


portfolio before change:  [-9.24832301]
curr_Stock_Price:  97.65958315961609
curr_Factors:  [97.65958316]
mat_Sqrt:  [[0.15]]
grads:  [-0.06255972]
Stock Position:  -0.06255972058064918
Bond Position:  [-3.13876678]


portfolio before change:  [-9.24266686]
curr_Stock_Price:  97.56289910326184
curr_Factors:  [97.5628991]
mat_Sqrt:  [[0.15]]
grads:  [-0.05283283]
Stock Position:  -0.052832834696932694
Bond Position:  [-4.08814234]


portfolio before change:  [-9.24322889]
curr_Stock_Price:  97.56386416712732
curr_Factors:  [97.56386417]
mat_Sqrt:  [[0.15]]
grads:  [0.07546186]
Stock Position:  0.07546186400314327
Bond Position:  [-16.60557994]


portfolio before change:  [-9.22672701]
curr_Stock_Price:  97.81005095364677
curr_Factors:  [97.81005095]
mat_Sqrt:  [[0.15]]
grads:  [-0.11116369]
Stock Position:  -0.11116368516184978
Bond Position:  [1.6461987]


portfolio before change:  [-9.16638804]
curr_Stock_Price:  97.26910827967303
curr_Factors:  [97.26910828]
mat_Sqrt:  [[0.15]]
grads:  [0.00295354]
Stock Position:  0.0029535361388111805
Bond Position:  [-9.45367586]


portfolio before change:  [-9.16785316]
curr_Stock_Price:  97.17317699353491
curr_Factors:  [97.17317699]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069287]
Stock Position:  -0.040692874847335365
Bond Position:  [-5.21359723]


portfolio before change:  [-9.17598515]
curr_Stock_Price:  97.3569992280699
curr_Factors:  [97.35699923]
mat_Sqrt:  [[0.15]]
grads:  [0.00662108]
Stock Position:  0.0066210760872422066
Bond Position:  [-9.82059325]


portfolio before change:  [-9.18173752]
curr_Stock_Price:  96.6736190693143
curr_Factors:  [96.67361907]
mat_Sqrt:  [[0.15]]
grads:  [0.00663403]
Stock Position:  0.006634027796006166
Bond Position:  [-9.82307299]


portfolio before change:  [-9.18295452]
curr_Stock_Price:  96.67527063086817
curr_Factors:  [96.67527063]
mat_Sqrt:  [[0.15]]
grads:  [-0.0947435]
Stock Position:  -0.0947435029284733
Bond Position:  [-0.02360073]


portfolio before change:  [-9.27357512]
curr_Stock_Price:  97.63172300390177
curr_Factors:  [97.631723]
mat_Sqrt:  [[0.15]]
grads:  [-0.03693805]
Stock Position:  -0.03693804692219472
Bond Position:  [-5.66724995]


portfolio before change:  [-9.34043611]
curr_Stock_Price:  99.42262827525452
curr_Factors:  [99.42262828]
mat_Sqrt:  [[0.15]]
grads:  [-0.04945091]
Stock Position:  -0.049450908579440934
Bond Position:  [-4.42389681]


portfolio before change:  [-9.33384079]
curr_Stock_Price:  99.27807393152932
curr_Factors:  [99.27807393]
mat_Sqrt:  [[0.15]]
grads:  [0.04701074]
Stock Position:  0.04701073930820254
Bond Position:  [-14.00097644]


portfolio before change:  [-9.33205942]
curr_Stock_Price:  99.35319722478064
curr_Factors:  [99.35319722]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352091]
Stock Position:  -0.043520911293510885
Bond Position:  [-5.00811774]


portfolio before change:  [-9.36457213]
curr_Stock_Price:  100.08587168804232
curr_Factors:  [100.08587169]
mat_Sqrt:  [[0.15]]
grads:  [0.08171117]
Stock Position:  0.08171116969645525
Bond Position:  [-17.54270578]


portfolio before change:  [-9.43530885]
curr_Stock_Price:  99.2470176417085
curr_Factors:  [99.24701764]
mat_Sqrt:  [[0.15]]
grads:  [0.05244038]
Stock Position:  0.05244037853608789
Bond Position:  [-14.63986003]


portfolio before change:  [-9.47206971]
curr_Stock_Price:  98.58091335966766
curr_Factors:  [98.58091336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486646]
Stock Position:  -0.014866456661924595
Bond Position:  [-8.00652084]


portfolio before change:  [-9.46096185]
curr_Stock_Price:  97.76641237566422
curr_Factors:  [97.76641238]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333055]
Stock Position:  -0.02333055363699594
Bond Position:  [-7.18001732]


portfolio before change:  [-9.45137382]
curr_Stock_Price:  97.31697673928399
curr_Factors:  [97.31697674]
mat_Sqrt:  [[0.15]]
grads:  [-0.10719394]
Stock Position:  -0.1071939373792393
Bond Position:  [0.98041609]


portfolio before change:  [-9.46929813]
curr_Stock_Price:  97.48533393794015
curr_Factors:  [97.48533394]
mat_Sqrt:  [[0.15]]
grads:  [-0.09149615]
Stock Position:  -0.09149615201741802
Bond Position:  [-0.5497652]


portfolio before change:  [-9.5129685]
curr_Stock_Price:  97.96187464828046
curr_Factors:  [97.96187465]
mat_Sqrt:  [[0.15]]
grads:  [0.13673211]
Stock Position:  0.13673210763223745
Bond Position:  [-22.90750209]


portfolio before change:  [-9.57914065]
curr_Stock_Price:  97.49886317813328
curr_Factors:  [97.49886318]
mat_Sqrt:  [[0.15]]
grads:  [0.0523134]
Stock Position:  0.052313399689739026
Bond Position:  [-14.67963765]


portfolio before change:  [-9.62235333]
curr_Stock_Price:  96.70790689416556
curr_Factors:  [96.70790689]
mat_Sqrt:  [[0.15]]
grads:  [-0.10002292]
Stock Position:  -0.10002292150903083
Bond Position:  [0.05065405]


portfolio before change:  [-9.62994273]
curr_Stock_Price:  96.78384682259102
curr_Factors:  [96.78384682]
mat_Sqrt:  [[0.15]]
grads:  [-0.31042072]
Stock Position:  -0.31042071560973383
Bond Position:  [20.41376826]


portfolio before change:  [-9.55179122]
curr_Stock_Price:  96.54030754176098
curr_Factors:  [96.54030754]
mat_Sqrt:  [[0.15]]
grads:  [-0.15294568]
Stock Position:  -0.1529456811046617
Bond Position:  [5.21363188]


portfolio before change:  [-9.43390006]
curr_Stock_Price:  95.77376473932213
curr_Factors:  [95.77376474]
mat_Sqrt:  [[0.15]]
grads:  [0.24893687]
Stock Position:  0.24893686792932732
Bond Position:  [-33.27552108]


portfolio before change:  [-9.44609844]
curr_Stock_Price:  95.74147269697778
curr_Factors:  [95.7414727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0236194]
Stock Position:  -0.023619401725560846
Bond Position:  [-7.18474213]


portfolio before change:  [-9.45009802]
curr_Stock_Price:  95.87278112426118
curr_Factors:  [95.87278112]
mat_Sqrt:  [[0.15]]
grads:  [-5.57548002e-05]
Stock Position:  -5.575480021258415e-05
Bond Position:  [-9.44475265]


portfolio before change:  [-9.4512936]
curr_Stock_Price:  96.14026039757972
curr_Factors:  [96.1402604]
mat_Sqrt:  [[0.15]]
grads:  [0.10801983]
Stock Position:  0.1080198288829684
Bond Position:  [-19.83634807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.48273689]
Stock Price:  95.87212815055717
PL:  [-9.48273689]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 5.33190902e-02]
 [-1.27909308e-02]
 [-1.29216299e-02]
 [-8.82309167e-03]
 [-4.45608074e-03]
 [ 4.80422882e-02]
 [ 3.54789784e-03]
 [-1.92531001e-03]
 [-2.07567540e-02]
 [ 2.33947937e-02]
 [ 1.98095250e-02]
 [-1.12479740e-02]
 [ 1.85397677e-02]
 [ 1.74166032e-02]
 [-2.07977605e-03]
 [-1.83386099e-03]
 [-6.01803644e-03]
 [ 6.01247763e-03]
 [ 7.54090152e-03]
 [ 9.88470435e-03]
 [-5.03662708e-03]
 [-4.62683949e-03]
 [ 7.06693837e-03]
 [-9.18569979e-03]
 [ 1.16222862e-02]
 [ 8.11086090e-03]
 [-1.66128326e-03]
 [-3.16002834e-03]
 [-4.95455584e-03]
 [-1.27214048e-02]
 [-5.86072338e-03]
 [ 1.56984160e-02]
 [-6.04710888e-03]
 [-3.79560518e-02]
 [-2.08911274e-02]
 [ 2.64514581e-02]
 [ 5.15324373e-03]
 [ 1.46659947e-02]
 [ 9.50237017e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-39.17841299]
curr_Stock_Price:  98.12965376729291
curr_Factors:  [98.12965377]
mat_Sqrt:  [[0.15]]
grads:  [0.3554606]
Stock Position:  0.3554606011514852
Bond Position:  [-74.05963871]


portfolio before change:  [-39.43679961]
curr_Stock_Price:  97.42879246380093
curr_Factors:  [97.42879246]
mat_Sqrt:  [[0.15]]
grads:  [-0.08527287]
Stock Position:  -0.0852728719424554
Bond Position:  [-31.12876666]


portfolio before change:  [-39.40734822]
curr_Stock_Price:  97.03778028915738
curr_Factors:  [97.03778029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0861442]
Stock Position:  -0.08614419932245976
Bond Position:  [-31.04810633]


portfolio before change:  [-39.43246895]
curr_Stock_Price:  97.28433757792776
curr_Factors:  [97.28433758]
mat_Sqrt:  [[0.15]]
grads:  [-0.05882061]
Stock Position:  -0.05882061111055077
Bond Position:  [-33.71014476]


portfolio before change:  [-39.43316475]
curr_Stock_Price:  97.2245246183317
curr_Factors:  [97.22452462]
mat_Sqrt:  [[0.15]]
grads:  [-0.0297072]
Stock Position:  -0.029707204908919056
Bond Position:  [-36.54489587]


portfolio before change:  [-39.44566665]
curr_Stock_Price:  97.49158125621715
curr_Factors:  [97.49158126]
mat_Sqrt:  [[0.15]]
grads:  [0.32028192]
Stock Position:  0.32028192125090976
Bond Position:  [-70.6704576]


portfolio before change:  [-38.97114437]
curr_Stock_Price:  99.00074119774521
curr_Factors:  [99.0007412]
mat_Sqrt:  [[0.15]]
grads:  [0.02365265]
Stock Position:  0.023652652292594754
Bond Position:  [-41.31277447]


portfolio before change:  [-38.98087405]
curr_Stock_Price:  98.80772855413485
curr_Factors:  [98.80772855]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128354]
Stock Position:  -0.01283540005369958
Bond Position:  [-37.71263732]


portfolio before change:  [-39.0112919]
curr_Stock_Price:  100.81027444972119
curr_Factors:  [100.81027445]
mat_Sqrt:  [[0.15]]
grads:  [-0.13837836]
Stock Position:  -0.13837836003612156
Bond Position:  [-25.06133145]


portfolio before change:  [-38.90201738]
curr_Stock_Price:  99.99795537034592
curr_Factors:  [99.99795537]
mat_Sqrt:  [[0.15]]
grads:  [0.15596529]
Stock Position:  0.15596529107457344
Bond Position:  [-54.4982276]


portfolio before change:  [-39.01203211]
curr_Stock_Price:  99.33625667886596
curr_Factors:  [99.33625668]
mat_Sqrt:  [[0.15]]
grads:  [0.1320635]
Stock Position:  0.13206349980370582
Bond Position:  [-52.13072583]


portfolio before change:  [-38.72458866]
curr_Stock_Price:  101.56215707866785
curr_Factors:  [101.56215708]
mat_Sqrt:  [[0.15]]
grads:  [-0.07498649]
Stock Position:  -0.0749864932107539
Bond Position:  [-31.10879866]


portfolio before change:  [-38.74026264]
curr_Stock_Price:  101.71932055068162
curr_Factors:  [101.71932055]
mat_Sqrt:  [[0.15]]
grads:  [0.12359845]
Stock Position:  0.12359845144724496
Bond Position:  [-51.31261315]


portfolio before change:  [-38.78960146]
curr_Stock_Price:  101.37203187571029
curr_Factors:  [101.37203188]
mat_Sqrt:  [[0.15]]
grads:  [0.11611069]
Stock Position:  0.11611068791799975
Bond Position:  [-50.55997782]


portfolio before change:  [-38.94434952]
curr_Stock_Price:  100.09370284860401
curr_Factors:  [100.09370285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01386517]
Stock Position:  -0.01386517368631289
Bond Position:  [-37.55653294]


portfolio before change:  [-38.94011484]
curr_Stock_Price:  99.44967613226514
curr_Factors:  [99.44967613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01222574]
Stock Position:  -0.012225739926636711
Bond Position:  [-37.72426896]


portfolio before change:  [-38.96173406]
curr_Stock_Price:  100.83228338081064
curr_Factors:  [100.83228338]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012024]
Stock Position:  -0.040120242937432965
Bond Position:  [-34.91631836]


portfolio before change:  [-38.96324443]
curr_Stock_Price:  100.76113622923349
curr_Factors:  [100.76113623]
mat_Sqrt:  [[0.15]]
grads:  [0.04008318]
Stock Position:  0.040083184190011854
Bond Position:  [-43.00207162]


portfolio before change:  [-38.96046254]
curr_Stock_Price:  100.96465019677176
curr_Factors:  [100.9646502]
mat_Sqrt:  [[0.15]]
grads:  [0.05027268]
Stock Position:  0.05027267680444367
Bond Position:  [-44.03622577]


portfolio before change:  [-38.96319719]
curr_Stock_Price:  101.01975408059431
curr_Factors:  [101.01975408]
mat_Sqrt:  [[0.15]]
grads:  [0.06589803]
Stock Position:  0.06589802900373018
Bond Position:  [-45.62019988]


portfolio before change:  [-39.00129395]
curr_Stock_Price:  100.52817832795007
curr_Factors:  [100.52817833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03357751]
Stock Position:  -0.03357751388358894
Bond Position:  [-35.62580764]


portfolio before change:  [-38.99699412]
curr_Stock_Price:  100.26748802720631
curr_Factors:  [100.26748803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0308456]
Stock Position:  -0.030845596581988485
Bond Position:  [-35.90418363]


portfolio before change:  [-38.98385893]
curr_Stock_Price:  99.69614237535299
curr_Factors:  [99.69614238]
mat_Sqrt:  [[0.15]]
grads:  [0.04711292]
Stock Position:  0.047112922448316344
Bond Position:  [-43.68083555]


portfolio before change:  [-38.95260487]
curr_Stock_Price:  100.475429696499
curr_Factors:  [100.4754297]
mat_Sqrt:  [[0.15]]
grads:  [-0.061238]
Stock Position:  -0.06123799862684849
Bond Position:  [-32.79969064]


portfolio before change:  [-38.93822645]
curr_Stock_Price:  100.17367857802066
curr_Factors:  [100.17367858]
mat_Sqrt:  [[0.15]]
grads:  [0.07748191]
Stock Position:  0.07748190787495814
Bond Position:  [-46.69987419]


portfolio before change:  [-38.95062821]
curr_Stock_Price:  100.08896315771197
curr_Factors:  [100.08896316]
mat_Sqrt:  [[0.15]]
grads:  [0.05407241]
Stock Position:  0.054072405971368476
Bond Position:  [-44.36267926]


portfolio before change:  [-39.04053789]
curr_Stock_Price:  98.52875885924733
curr_Factors:  [98.52875886]
mat_Sqrt:  [[0.15]]
grads:  [-0.01107522]
Stock Position:  -0.011075221736232058
Bond Position:  [-37.94931004]


portfolio before change:  [-39.0407079]
curr_Stock_Price:  98.1157693814705
curr_Factors:  [98.11576938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02106686]
Stock Position:  -0.02106685559903373
Bond Position:  [-36.97371716]


portfolio before change:  [-39.06032571]
curr_Stock_Price:  98.82758880618546
curr_Factors:  [98.82758881]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303037]
Stock Position:  -0.03303037229473399
Bond Position:  [-35.79601365]


portfolio before change:  [-39.08220384]
curr_Stock_Price:  99.35447813223716
curr_Factors:  [99.35447813]
mat_Sqrt:  [[0.15]]
grads:  [-0.08480937]
Stock Position:  -0.08480936510627769
Bond Position:  [-30.65601363]


portfolio before change:  [-39.07934756]
curr_Stock_Price:  99.27561275070553
curr_Factors:  [99.27561275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03907149]
Stock Position:  -0.03907148918584591
Bond Position:  [-35.20050153]


portfolio before change:  [-39.10678858]
curr_Stock_Price:  99.8653185344971
curr_Factors:  [99.86531853]
mat_Sqrt:  [[0.15]]
grads:  [0.10465611]
Stock Position:  0.10465610650908486
Bond Position:  [-49.55830399]


portfolio before change:  [-39.05643935]
curr_Stock_Price:  100.40560620046735
curr_Factors:  [100.4056062]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031406]
Stock Position:  -0.04031405921422662
Bond Position:  [-35.00868179]


portfolio before change:  [-39.01001293]
curr_Stock_Price:  99.14543099934615
curr_Factors:  [99.145431]
mat_Sqrt:  [[0.15]]
grads:  [-0.25304035]
Stock Position:  -0.2530403455301847
Bond Position:  [-13.92221881]


portfolio before change:  [-39.49886713]
curr_Stock_Price:  101.07047506424544
curr_Factors:  [101.07047506]
mat_Sqrt:  [[0.15]]
grads:  [-0.13927418]
Stock Position:  -0.13927418276677195
Bond Position:  [-25.42235931]


portfolio before change:  [-39.52228747]
curr_Stock_Price:  101.21581676263412
curr_Factors:  [101.21581676]
mat_Sqrt:  [[0.15]]
grads:  [0.17634305]
Stock Position:  0.17634305418472274
Bond Position:  [-57.37099373]


portfolio before change:  [-39.46326654]
curr_Stock_Price:  101.59118030731061
curr_Factors:  [101.59118031]
mat_Sqrt:  [[0.15]]
grads:  [0.03435496]
Stock Position:  0.034354958207095124
Bond Position:  [-42.95342729]


portfolio before change:  [-39.46687487]
curr_Stock_Price:  101.6424445836848
curr_Factors:  [101.64244458]
mat_Sqrt:  [[0.15]]
grads:  [0.0977733]
Stock Position:  0.09777329801196165
Bond Position:  [-49.4047919]


portfolio before change:  [-39.41550152]
curr_Stock_Price:  102.23104429342355
curr_Factors:  [102.23104429]
mat_Sqrt:  [[0.15]]
grads:  [0.06334913]
Stock Position:  0.06334913447912999
Bond Position:  [-45.89174969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-39.45716801]
Stock Price:  101.6638753645343
PL:  [-41.12104337]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.03023696e-02]
 [-7.56237852e-04]
 [ 1.00389326e-02]
 [ 8.85434290e-04]
 [ 3.76059865e-04]
 [ 2.43403158e-02]
 [ 3.70890382e-03]
 [ 1.15183252e-02]
 [-1.58744738e-02]
 [ 2.31767408e-02]
 [ 1.99043781e-02]
 [-1.25351364e-02]
 [ 2.76099720e-02]
 [ 5.35218144e-03]
 [ 9.86316045e-05]
 [-8.79117425e-04]
 [-6.13823732e-03]
 [ 4.76827415e-03]
 [ 6.10598161e-03]
 [-2.84676818e-02]
 [-4.13531274e-03]
 [-7.37823886e-03]
 [ 7.06581532e-03]
 [-7.84514114e-03]
 [ 1.52677912e-02]
 [ 7.69828061e-03]
 [-2.76572247e-03]
 [-5.54682104e-04]
 [ 5.52192316e-04]
 [-6.38156240e-03]
 [-2.43917764e-02]
 [ 1.63403751e-02]
 [-3.37305087e-03]
 [-1.75610808e-02]
 [-2.07807925e-02]
 [ 1.95829823e-02]
 [ 5.12260763e-03]
 [ 1.76468500e-02]
 [ 9.85005684e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.43624699]
curr_Stock_Price:  99.93394510932872
curr_Factors:  [99.93394511]
mat_Sqrt:  [[0.15]]
grads:  [0.13534913]
Stock Position:  0.13534913040880872
Bond Position:  [-13.08972557]


portfolio before change:  [0.61207999]
curr_Stock_Price:  101.24514164947774
curr_Factors:  [101.24514165]
mat_Sqrt:  [[0.15]]
grads:  [-0.00504159]
Stock Position:  -0.005041585682421709
Bond Position:  [1.12251604]


portfolio before change:  [0.60721727]
curr_Stock_Price:  102.23749578288606
curr_Factors:  [102.23749578]
mat_Sqrt:  [[0.15]]
grads:  [0.06692622]
Stock Position:  0.066926217062349
Bond Position:  [-6.23515156]


portfolio before change:  [0.59172969]
curr_Stock_Price:  102.01772923386541
curr_Factors:  [102.01772923]
mat_Sqrt:  [[0.15]]
grads:  [0.0059029]
Stock Position:  0.005902895268967371
Bond Position:  [-0.01047028]


portfolio before change:  [0.59551752]
curr_Stock_Price:  102.65964165868071
curr_Factors:  [102.65964166]
mat_Sqrt:  [[0.15]]
grads:  [0.00250707]
Stock Position:  0.0025070657661238095
Bond Position:  [0.33814305]


portfolio before change:  [0.59310521]
curr_Stock_Price:  101.68057484646289
curr_Factors:  [101.68057485]
mat_Sqrt:  [[0.15]]
grads:  [0.16226877]
Stock Position:  0.16226877182900173
Bond Position:  [-15.90647679]


portfolio before change:  [0.50030084]
curr_Stock_Price:  101.12091117818942
curr_Factors:  [101.12091118]
mat_Sqrt:  [[0.15]]
grads:  [0.02472603]
Stock Position:  0.02472602544603463
Bond Position:  [-2.00001739]


portfolio before change:  [0.51217644]
curr_Stock_Price:  101.6113105235507
curr_Factors:  [101.61131052]
mat_Sqrt:  [[0.15]]
grads:  [0.07678883]
Stock Position:  0.0767888345836154
Bond Position:  [-7.29043767]


portfolio before change:  [0.48532619]
curr_Stock_Price:  101.27351544547918
curr_Factors:  [101.27351545]
mat_Sqrt:  [[0.15]]
grads:  [-0.10582983]
Stock Position:  -0.10582982505954858
Bond Position:  [11.20308462]


portfolio before change:  [0.512273]
curr_Stock_Price:  101.03212470963787
curr_Factors:  [101.03212471]
mat_Sqrt:  [[0.15]]
grads:  [0.15451161]
Stock Position:  0.154511605248224
Bond Position:  [-15.09836277]


portfolio before change:  [0.50312904]
curr_Stock_Price:  100.98516023818787
curr_Factors:  [100.98516024]
mat_Sqrt:  [[0.15]]
grads:  [0.13269585]
Stock Position:  0.1326958541109461
Bond Position:  [-12.89718305]


portfolio before change:  [0.54716348]
curr_Stock_Price:  101.32915513486807
curr_Factors:  [101.32915513]
mat_Sqrt:  [[0.15]]
grads:  [-0.08356758]
Stock Position:  -0.08356757581019263
Bond Position:  [9.01499534]


portfolio before change:  [0.5679938]
curr_Stock_Price:  101.09337737112912
curr_Factors:  [101.09337737]
mat_Sqrt:  [[0.15]]
grads:  [0.18406648]
Stock Position:  0.18406647967293951
Bond Position:  [-18.03990829]


portfolio before change:  [0.39500407]
curr_Stock_Price:  100.16580701839612
curr_Factors:  [100.16580702]
mat_Sqrt:  [[0.15]]
grads:  [0.03568121]
Stock Position:  0.035681209606398395
Bond Position:  [-3.17903309]


portfolio before change:  [0.39703268]
curr_Stock_Price:  100.23379839619503
curr_Factors:  [100.2337984]
mat_Sqrt:  [[0.15]]
grads:  [0.00065754]
Stock Position:  0.0006575440299960249
Bond Position:  [0.33112454]


portfolio before change:  [0.39629306]
curr_Stock_Price:  99.04603500607354
curr_Factors:  [99.04603501]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586078]
Stock Position:  -0.005860782834804339
Bond Position:  [0.97678036]


portfolio before change:  [0.39351221]
curr_Stock_Price:  99.541353296867
curr_Factors:  [99.5413533]
mat_Sqrt:  [[0.15]]
grads:  [-0.04092158]
Stock Position:  -0.04092158216628335
Bond Position:  [4.46690188]


portfolio before change:  [0.39598206]
curr_Stock_Price:  99.49464318419841
curr_Factors:  [99.49464318]
mat_Sqrt:  [[0.15]]
grads:  [0.03178849]
Stock Position:  0.03178849435643921
Bond Position:  [-2.76680284]


portfolio before change:  [0.39796646]
curr_Stock_Price:  99.56794850395785
curr_Factors:  [99.5679485]
mat_Sqrt:  [[0.15]]
grads:  [0.04070654]
Stock Position:  0.040706544076853535
Bond Position:  [-3.65510063]


portfolio before change:  [0.35809663]
curr_Stock_Price:  98.59972792309252
curr_Factors:  [98.59972792]
mat_Sqrt:  [[0.15]]
grads:  [-0.18978455]
Stock Position:  -0.18978454559767227
Bond Position:  [19.07080119]


portfolio before change:  [0.47297928]
curr_Stock_Price:  98.00695756021823
curr_Factors:  [98.00695756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756875]
Stock Position:  -0.027568751607891923
Bond Position:  [3.17490875]


portfolio before change:  [0.43412265]
curr_Stock_Price:  99.43079853536449
curr_Factors:  [99.43079854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04918826]
Stock Position:  -0.04918825903646686
Bond Position:  [5.32495053]


portfolio before change:  [0.42156468]
curr_Stock_Price:  99.69963566146919
curr_Factors:  [99.69963566]
mat_Sqrt:  [[0.15]]
grads:  [0.04710544]
Stock Position:  0.04710543545177054
Bond Position:  [-4.27483007]


portfolio before change:  [0.43247664]
curr_Stock_Price:  99.94262973374272
curr_Factors:  [99.94262973]
mat_Sqrt:  [[0.15]]
grads:  [-0.05230094]
Stock Position:  -0.052300940953387914
Bond Position:  [5.65957021]


portfolio before change:  [0.4624054]
curr_Stock_Price:  99.38391559321869
curr_Factors:  [99.38391559]
mat_Sqrt:  [[0.15]]
grads:  [0.10178527]
Stock Position:  0.10178527456521784
Bond Position:  [-9.65341373]


portfolio before change:  [0.56243438]
curr_Stock_Price:  100.37851657627272
curr_Factors:  [100.37851658]
mat_Sqrt:  [[0.15]]
grads:  [0.05132187]
Stock Position:  0.0513218707421424
Bond Position:  [-4.58917887]


portfolio before change:  [0.59990147]
curr_Stock_Price:  101.1197360058409
curr_Factors:  [101.11973601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01843815]
Stock Position:  -0.01843814977175688
Bond Position:  [2.46436231]


portfolio before change:  [0.59443732]
curr_Stock_Price:  101.43279429605411
curr_Factors:  [101.4327943]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369788]
Stock Position:  -0.0036978806949360555
Bond Position:  [0.96952369]


portfolio before change:  [0.59805971]
curr_Stock_Price:  100.48598287086377
curr_Factors:  [100.48598287]
mat_Sqrt:  [[0.15]]
grads:  [0.00368128]
Stock Position:  0.003681282105564474
Bond Position:  [0.22814246]


portfolio before change:  [0.60256072]
curr_Stock_Price:  101.70090864858498
curr_Factors:  [101.70090865]
mat_Sqrt:  [[0.15]]
grads:  [-0.04254375]
Stock Position:  -0.04254374934242911
Bond Position:  [4.92929868]


portfolio before change:  [0.61419059]
curr_Stock_Price:  101.4420298745039
curr_Factors:  [101.44202987]
mat_Sqrt:  [[0.15]]
grads:  [-0.16261184]
Stock Position:  -0.16261184246004018
Bond Position:  [17.10986597]


portfolio before change:  [0.57733895]
curr_Stock_Price:  101.68180643438806
curr_Factors:  [101.68180643]
mat_Sqrt:  [[0.15]]
grads:  [0.10893583]
Stock Position:  0.10893583386738
Bond Position:  [-10.49945342]


portfolio before change:  [0.57752804]
curr_Stock_Price:  101.69559074828969
curr_Factors:  [101.69559075]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248701]
Stock Position:  -0.022487005767744483
Bond Position:  [2.86435738]


portfolio before change:  [0.59302799]
curr_Stock_Price:  101.02222921438745
curr_Factors:  [101.02222921]
mat_Sqrt:  [[0.15]]
grads:  [-0.11707387]
Stock Position:  -0.11707387215402577
Bond Position:  [12.42009154]


portfolio before change:  [0.56238086]
curr_Stock_Price:  101.29726702461896
curr_Factors:  [101.29726702]
mat_Sqrt:  [[0.15]]
grads:  [-0.13853862]
Stock Position:  -0.1385386169539857
Bond Position:  [14.59596413]


portfolio before change:  [0.34599715]
curr_Stock_Price:  102.8723392105949
curr_Factors:  [102.87233921]
mat_Sqrt:  [[0.15]]
grads:  [0.13055322]
Stock Position:  0.1305532153745178
Bond Position:  [-13.08431751]


portfolio before change:  [0.1827202]
curr_Stock_Price:  101.6342133747853
curr_Factors:  [101.63421337]
mat_Sqrt:  [[0.15]]
grads:  [0.03415072]
Stock Position:  0.03415071754440201
Bond Position:  [-3.28816112]


portfolio before change:  [0.2069452]
curr_Stock_Price:  102.355605122171
curr_Factors:  [102.35560512]
mat_Sqrt:  [[0.15]]
grads:  [0.11764567]
Stock Position:  0.11764566689772783
Bond Position:  [-11.83474823]


portfolio before change:  [0.23256233]
curr_Stock_Price:  102.58592865806257
curr_Factors:  [102.58592866]
mat_Sqrt:  [[0.15]]
grads:  [0.06566705]
Stock Position:  0.06566704558776341
Bond Position:  [-6.50395253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.24249388]
Stock Price:  102.74955099202892
PL:  [-2.50705712]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.91670743e-02]
 [ 3.05703219e-02]
 [-1.05652614e-02]
 [-9.08722507e-03]
 [-4.50582165e-03]
 [ 4.71742779e-02]
 [ 3.54757331e-03]
 [-1.83221492e-03]
 [-1.81461821e-02]
 [ 2.34231040e-02]
 [ 1.91864256e-02]
 [-1.52868292e-02]
 [ 2.00241905e-02]
 [ 6.90437689e-03]
 [-1.21657256e-02]
 [-2.97595104e-03]
 [-5.54156006e-03]
 [ 7.25505523e-03]
 [ 2.37674208e-02]
 [-8.41552057e-03]
 [ 2.35442878e-04]
 [-1.22985921e-02]
 [ 4.23294298e-03]
 [-1.23838888e-02]
 [-8.09169616e-04]
 [ 3.97931203e-03]
 [ 3.06003111e-03]
 [ 1.54278958e-03]
 [ 4.92477015e-03]
 [-5.75729842e-03]
 [-1.87120269e-02]
 [ 1.49089107e-02]
 [-3.37667853e-03]
 [-2.14827132e-02]
 [-2.03596817e-02]
 [ 1.20868860e-02]
 [ 9.48198142e-03]
 [ 2.37518153e-02]
 [ 1.05285709e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.99824225]
curr_Stock_Price:  100.18727203151532
curr_Factors:  [100.18727203]
mat_Sqrt:  [[0.15]]
grads:  [0.1277805]
Stock Position:  0.12778049531812818
Bond Position:  [-6.80373699]


portfolio before change:  [5.88546995]
curr_Stock_Price:  99.31138102253061
curr_Factors:  [99.31138102]
mat_Sqrt:  [[0.15]]
grads:  [0.20380215]
Stock Position:  0.20380214583894035
Bond Position:  [-14.35440261]


portfolio before change:  [5.87990542]
curr_Stock_Price:  99.29288210948746
curr_Factors:  [99.29288211]
mat_Sqrt:  [[0.15]]
grads:  [-0.07043508]
Stock Position:  -0.07043507626597055
Bond Position:  [12.87360714]


portfolio before change:  [6.03747264]
curr_Stock_Price:  97.07867394064742
curr_Factors:  [97.07867394]
mat_Sqrt:  [[0.15]]
grads:  [-0.0605815]
Stock Position:  -0.06058150045754008
Bond Position:  [11.91864437]


portfolio before change:  [6.02772016]
curr_Stock_Price:  97.26424877126358
curr_Factors:  [97.26424877]
mat_Sqrt:  [[0.15]]
grads:  [-0.03003881]
Stock Position:  -0.030038810983639867
Bond Position:  [8.94942254]


portfolio before change:  [6.01909584]
curr_Stock_Price:  97.58859814326432
curr_Factors:  [97.58859814]
mat_Sqrt:  [[0.15]]
grads:  [0.31449519]
Stock Position:  0.3144951860578762
Bond Position:  [-24.67204849]


portfolio before change:  [6.46570898]
curr_Stock_Price:  99.01850027394593
curr_Factors:  [99.01850027]
mat_Sqrt:  [[0.15]]
grads:  [0.02365049]
Stock Position:  0.02365048870040278
Bond Position:  [4.12387305]


portfolio before change:  [6.4450957]
curr_Stock_Price:  98.12512360449907
curr_Factors:  [98.1251236]
mat_Sqrt:  [[0.15]]
grads:  [-0.01221477]
Stock Position:  -0.012214766115746687
Bond Position:  [7.64367113]


portfolio before change:  [6.44339772]
curr_Stock_Price:  98.34236020390259
curr_Factors:  [98.3423602]
mat_Sqrt:  [[0.15]]
grads:  [-0.12097455]
Stock Position:  -0.12097454716760335
Bond Position:  [18.34032021]


portfolio before change:  [6.34515988]
curr_Stock_Price:  99.17336580354642
curr_Factors:  [99.1733658]
mat_Sqrt:  [[0.15]]
grads:  [0.15615403]
Stock Position:  0.1561540266595055
Bond Position:  [-9.14116053]


portfolio before change:  [6.51365844]
curr_Stock_Price:  100.25973724081484
curr_Factors:  [100.25973724]
mat_Sqrt:  [[0.15]]
grads:  [0.1279095]
Stock Position:  0.1279095040173862
Bond Position:  [-6.31051483]


portfolio before change:  [6.44526957]
curr_Stock_Price:  99.73123854466142
curr_Factors:  [99.73123854]
mat_Sqrt:  [[0.15]]
grads:  [-0.10191219]
Stock Position:  -0.10191219481943817
Bond Position:  [16.60909898]


portfolio before change:  [6.42253404]
curr_Stock_Price:  99.97470099142723
curr_Factors:  [99.97470099]
mat_Sqrt:  [[0.15]]
grads:  [0.1334946]
Stock Position:  0.13349460352634357
Bond Position:  [-6.92354903]


portfolio before change:  [6.48924616]
curr_Stock_Price:  100.48092079654285
curr_Factors:  [100.4809208]
mat_Sqrt:  [[0.15]]
grads:  [0.04602918]
Stock Position:  0.04602917929934755
Bond Position:  [1.86419184]


portfolio before change:  [6.56130744]
curr_Stock_Price:  102.04141440956433
curr_Factors:  [102.04141441]
mat_Sqrt:  [[0.15]]
grads:  [-0.08110484]
Stock Position:  -0.0811048371076814
Bond Position:  [14.83735973]


portfolio before change:  [6.53643402]
curr_Stock_Price:  102.37096567767436
curr_Factors:  [102.37096568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983967]
Stock Position:  -0.019839673566769654
Bond Position:  [8.56744056]


portfolio before change:  [6.54178306]
curr_Stock_Price:  102.15533481558266
curr_Factors:  [102.15533482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694373]
Stock Position:  -0.03694373371258072
Bond Position:  [10.31578255]


portfolio before change:  [6.53118802]
curr_Stock_Price:  102.47702937947886
curr_Factors:  [102.47702938]
mat_Sqrt:  [[0.15]]
grads:  [0.04836703]
Stock Position:  0.04836703484637982
Bond Position:  [1.57467797]


portfolio before change:  [6.63552515]
curr_Stock_Price:  104.63015462979881
curr_Factors:  [104.63015463]
mat_Sqrt:  [[0.15]]
grads:  [0.15844947]
Stock Position:  0.15844947210441349
Bond Position:  [-9.94306762]


portfolio before change:  [6.80116623]
curr_Stock_Price:  105.68338655870075
curr_Factors:  [105.68338656]
mat_Sqrt:  [[0.15]]
grads:  [-0.05610347]
Stock Position:  -0.05610347048252552
Bond Position:  [12.73037099]


portfolio before change:  [6.85763011]
curr_Stock_Price:  104.70532787109116
curr_Factors:  [104.70532787]
mat_Sqrt:  [[0.15]]
grads:  [0.00156962]
Stock Position:  0.0015696191853557186
Bond Position:  [6.69328262]


portfolio before change:  [6.85868742]
curr_Stock_Price:  104.84586841385683
curr_Factors:  [104.84586841]
mat_Sqrt:  [[0.15]]
grads:  [-0.08199061]
Stock Position:  -0.08199061381868165
Bond Position:  [15.45506453]


portfolio before change:  [6.9832958]
curr_Stock_Price:  103.3496438240163
curr_Factors:  [103.34964382]
mat_Sqrt:  [[0.15]]
grads:  [0.02821962]
Stock Position:  0.028219619859075427
Bond Position:  [4.06680814]


portfolio before change:  [6.95250114]
curr_Stock_Price:  102.24037863695295
curr_Factors:  [102.24037864]
mat_Sqrt:  [[0.15]]
grads:  [-0.08255926]
Stock Position:  -0.08255925844043155
Bond Position:  [15.39339098]


portfolio before change:  [6.86504355]
curr_Stock_Price:  103.32301771181837
curr_Factors:  [103.32301771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00539446]
Stock Position:  -0.005394464107666587
Bond Position:  [7.42241586]


portfolio before change:  [6.86623892]
curr_Stock_Price:  103.27342812026936
curr_Factors:  [103.27342812]
mat_Sqrt:  [[0.15]]
grads:  [0.02652875]
Stock Position:  0.026528746881568668
Bond Position:  [4.12652429]


portfolio before change:  [6.87583216]
curr_Stock_Price:  103.61559981712908
curr_Factors:  [103.61559982]
mat_Sqrt:  [[0.15]]
grads:  [0.02040021]
Stock Position:  0.020400207392422886
Bond Position:  [4.76205243]


portfolio before change:  [6.87884838]
curr_Stock_Price:  103.73427180768068
curr_Factors:  [103.73427181]
mat_Sqrt:  [[0.15]]
grads:  [0.01028526]
Stock Position:  0.01028526386177667
Bond Position:  [5.81191403]


portfolio before change:  [6.88090465]
curr_Stock_Price:  103.86355718660297
curr_Factors:  [103.86355719]
mat_Sqrt:  [[0.15]]
grads:  [0.0328318]
Stock Position:  0.03283180100358298
Bond Position:  [3.47087701]


portfolio before change:  [6.86157241]
curr_Stock_Price:  103.26151508947007
curr_Factors:  [103.26151509]
mat_Sqrt:  [[0.15]]
grads:  [-0.03838199]
Stock Position:  -0.038381989473146576
Bond Position:  [10.8249548]


portfolio before change:  [6.87798489]
curr_Stock_Price:  102.86916249417328
curr_Factors:  [102.86916249]
mat_Sqrt:  [[0.15]]
grads:  [-0.12474685]
Stock Position:  -0.12474684625497978
Bond Position:  [19.71058849]


portfolio before change:  [6.99064855]
curr_Stock_Price:  101.98577594702088
curr_Factors:  [101.98577595]
mat_Sqrt:  [[0.15]]
grads:  [0.09939274]
Stock Position:  0.09939273824151591
Bond Position:  [-3.14599698]


portfolio before change:  [6.98225587]
curr_Stock_Price:  101.9052931568464
curr_Factors:  [101.90529316]
mat_Sqrt:  [[0.15]]
grads:  [-0.02251119]
Stock Position:  -0.02251119021261997
Bond Position:  [9.27626531]


portfolio before change:  [6.96777388]
curr_Stock_Price:  102.6001295564828
curr_Factors:  [102.60012956]
mat_Sqrt:  [[0.15]]
grads:  [-0.14321809]
Stock Position:  -0.143218087986239
Bond Position:  [21.66196827]


portfolio before change:  [6.94774316]
curr_Stock_Price:  102.75889886888667
curr_Factors:  [102.75889887]
mat_Sqrt:  [[0.15]]
grads:  [-0.13573121]
Stock Position:  -0.13573121109968475
Bond Position:  [20.89533296]


portfolio before change:  [6.8256579]
curr_Stock_Price:  103.67760679340189
curr_Factors:  [103.67760679]
mat_Sqrt:  [[0.15]]
grads:  [0.08057924]
Stock Position:  0.08057923990439016
Bond Position:  [-1.52860485]


portfolio before change:  [6.92027206]
curr_Stock_Price:  104.85415358050238
curr_Factors:  [104.85415358]
mat_Sqrt:  [[0.15]]
grads:  [0.06321321]
Stock Position:  0.06321320946596559
Bond Position:  [0.29210449]


portfolio before change:  [6.87339052]
curr_Stock_Price:  104.11193437539663
curr_Factors:  [104.11193438]
mat_Sqrt:  [[0.15]]
grads:  [0.15834544]
Stock Position:  0.15834543527515438
Bond Position:  [-9.61225905]


portfolio before change:  [6.80220778]
curr_Stock_Price:  103.66998208205281
curr_Factors:  [103.66998208]
mat_Sqrt:  [[0.15]]
grads:  [0.07019047]
Stock Position:  0.07019047237961026
Bond Position:  [-0.47443723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.82699406]
Stock Price:  104.02395587913236
PL:  [2.80303818]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.72304851e-02]
 [-3.21537009e-03]
 [-1.57219313e-02]
 [-7.86147119e-03]
 [-4.99863024e-03]
 [ 2.84772039e-02]
 [ 3.70260424e-03]
 [ 5.24972057e-03]
 [-1.45118120e-02]
 [ 2.29944150e-02]
 [ 1.72703151e-02]
 [ 6.38362225e-03]
 [-4.01063763e-03]
 [ 2.32990406e-02]
 [-9.97203992e-03]
 [-3.23428584e-03]
 [-4.91556834e-03]
 [ 7.63711115e-03]
 [ 1.68624660e-02]
 [ 9.99187292e-03]
 [ 6.89940560e-04]
 [-7.00276883e-03]
 [ 7.32025028e-03]
 [-5.97546850e-03]
 [-7.71286125e-03]
 [ 4.64337289e-03]
 [ 6.71656475e-03]
 [ 3.19636875e-03]
 [ 5.40446098e-03]
 [-1.81468314e-03]
 [-1.46673800e-02]
 [ 7.43026500e-03]
 [ 1.62338420e-03]
 [-2.16643077e-02]
 [-2.03686970e-02]
 [ 1.69391080e-02]
 [ 2.37036943e-03]
 [ 2.06382607e-02]
 [ 9.98448992e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.34464871]
curr_Stock_Price:  98.62308895301352
curr_Factors:  [98.62308895]
mat_Sqrt:  [[0.15]]
grads:  [0.18153657]
Stock Position:  0.1815365671383225
Bond Position:  [-46.24834571]


portfolio before change:  [-28.47337539]
curr_Stock_Price:  97.94584095622561
curr_Factors:  [97.94584096]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214358]
Stock Position:  -0.02143580057334125
Bond Position:  [-26.37382787]


portfolio before change:  [-28.4848611]
curr_Stock_Price:  98.3278551201918
curr_Factors:  [98.32785512]
mat_Sqrt:  [[0.15]]
grads:  [-0.10481288]
Stock Position:  -0.10481287561943323
Bond Position:  [-18.17883585]


portfolio before change:  [-28.45623835]
curr_Stock_Price:  98.03308939740617
curr_Factors:  [98.0330894]
mat_Sqrt:  [[0.15]]
grads:  [-0.05240981]
Stock Position:  -0.05240980791804822
Bond Position:  [-23.31834297]


portfolio before change:  [-28.43948533]
curr_Stock_Price:  97.65781622907201
curr_Factors:  [97.65781623]
mat_Sqrt:  [[0.15]]
grads:  [-0.0333242]
Stock Position:  -0.03332420161350139
Bond Position:  [-25.18511658]


portfolio before change:  [-28.49555028]
curr_Stock_Price:  99.24574944882399
curr_Factors:  [99.24574945]
mat_Sqrt:  [[0.15]]
grads:  [0.18984803]
Stock Position:  0.18984802630581765
Bond Position:  [-47.33715993]


portfolio before change:  [-28.27882011]
curr_Stock_Price:  100.41851739412941
curr_Factors:  [100.41851739]
mat_Sqrt:  [[0.15]]
grads:  [0.02468403]
Stock Position:  0.02468402823877844
Bond Position:  [-30.75755363]


portfolio before change:  [-28.27518854]
curr_Stock_Price:  100.72140599083856
curr_Factors:  [100.72140599]
mat_Sqrt:  [[0.15]]
grads:  [0.03499814]
Stock Position:  0.03499813713846801
Bond Position:  [-31.80025012]


portfolio before change:  [-28.25576536]
curr_Stock_Price:  101.38996899825358
curr_Factors:  [101.389969]
mat_Sqrt:  [[0.15]]
grads:  [-0.09674541]
Stock Position:  -0.09674541317816823
Bond Position:  [-18.44675091]


portfolio before change:  [-28.28654836]
curr_Stock_Price:  101.68431898714924
curr_Factors:  [101.68431899]
mat_Sqrt:  [[0.15]]
grads:  [0.1532961]
Stock Position:  0.1532960998878843
Bond Position:  [-43.87435788]


portfolio before change:  [-28.09817512]
curr_Stock_Price:  102.94891655777306
curr_Factors:  [102.94891656]
mat_Sqrt:  [[0.15]]
grads:  [0.11513543]
Stock Position:  0.11513543381809091
Bond Position:  [-39.95124329]


portfolio before change:  [-27.9157874]
curr_Stock_Price:  104.57640803717636
curr_Factors:  [104.57640804]
mat_Sqrt:  [[0.15]]
grads:  [0.04255748]
Stock Position:  0.04255748166310224
Bond Position:  [-32.36629596]


portfolio before change:  [-27.88674827]
curr_Stock_Price:  105.35383104533236
curr_Factors:  [105.35383105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02673758]
Stock Position:  -0.02673758420095879
Bond Position:  [-25.06984134]


portfolio before change:  [-27.88141799]
curr_Stock_Price:  105.03726504780593
curr_Factors:  [105.03726505]
mat_Sqrt:  [[0.15]]
grads:  [0.15532694]
Stock Position:  0.15532693725499955
Bond Position:  [-44.19653467]


portfolio before change:  [-28.06788056]
curr_Stock_Price:  103.87238235589977
curr_Factors:  [103.87238236]
mat_Sqrt:  [[0.15]]
grads:  [-0.06648027]
Stock Position:  -0.06648026613589651
Bond Position:  [-21.16241694]


portfolio before change:  [-28.02255641]
curr_Stock_Price:  103.15082058568959
curr_Factors:  [103.15082059]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156191]
Stock Position:  -0.021561905583562503
Bond Position:  [-25.79842816]


portfolio before change:  [-28.03802569]
curr_Stock_Price:  103.71868674866373
curr_Factors:  [103.71868675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03277046]
Stock Position:  -0.03277045563079911
Bond Position:  [-24.63911707]


portfolio before change:  [-28.02746328]
curr_Stock_Price:  103.3023820645011
curr_Factors:  [103.30238206]
mat_Sqrt:  [[0.15]]
grads:  [0.05091407]
Stock Position:  0.05091407432909698
Bond Position:  [-33.28700844]


portfolio before change:  [-28.04911267]
curr_Stock_Price:  102.95889631362334
curr_Factors:  [102.95889631]
mat_Sqrt:  [[0.15]]
grads:  [0.11241644]
Stock Position:  0.11241643975751836
Bond Position:  [-39.62338524]


portfolio before change:  [-27.98307869]
curr_Stock_Price:  103.59036284730817
curr_Factors:  [103.59036285]
mat_Sqrt:  [[0.15]]
grads:  [0.06661249]
Stock Position:  0.06661248614817483
Bond Position:  [-34.8834903]


portfolio before change:  [-27.95235404]
curr_Stock_Price:  104.11707122015476
curr_Factors:  [104.11707122]
mat_Sqrt:  [[0.15]]
grads:  [0.0045996]
Stock Position:  0.004599603731511152
Bond Position:  [-28.43125131]


portfolio before change:  [-27.95593387]
curr_Stock_Price:  104.1114841772486
curr_Factors:  [104.11148418]
mat_Sqrt:  [[0.15]]
grads:  [-0.04668513]
Stock Position:  -0.0466851255484656
Bond Position:  [-23.09547616]


portfolio before change:  [-28.03311558]
curr_Stock_Price:  105.70288176646429
curr_Factors:  [105.70288177]
mat_Sqrt:  [[0.15]]
grads:  [0.04880167]
Stock Position:  0.048801668521501085
Bond Position:  [-33.19159258]


portfolio before change:  [-28.02005812]
curr_Stock_Price:  106.05546532255062
curr_Factors:  [106.05546532]
mat_Sqrt:  [[0.15]]
grads:  [-0.03983646]
Stock Position:  -0.039836456698669524
Bond Position:  [-23.79518417]


portfolio before change:  [-28.00114108]
curr_Stock_Price:  105.50592771701996
curr_Factors:  [105.50592772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05141908]
Stock Position:  -0.0514190750158209
Bond Position:  [-22.57612386]


portfolio before change:  [-27.99193078]
curr_Stock_Price:  105.27191938287955
curr_Factors:  [105.27191938]
mat_Sqrt:  [[0.15]]
grads:  [0.03095582]
Stock Position:  0.030955819273678853
Bond Position:  [-31.25070929]


portfolio before change:  [-27.95200675]
curr_Stock_Price:  106.68782795653966
curr_Factors:  [106.68782796]
mat_Sqrt:  [[0.15]]
grads:  [0.0447771]
Stock Position:  0.04477709834496105
Bond Position:  [-32.72917811]


portfolio before change:  [-27.97193212]
curr_Stock_Price:  106.33421033110801
curr_Factors:  [106.33421033]
mat_Sqrt:  [[0.15]]
grads:  [0.02130912]
Stock Position:  0.021309124989235713
Bond Position:  [-30.2378211]


portfolio before change:  [-27.99756416]
curr_Stock_Price:  105.30873084197127
curr_Factors:  [105.30873084]
mat_Sqrt:  [[0.15]]
grads:  [0.03602974]
Stock Position:  0.036029739860331436
Bond Position:  [-31.79181033]


portfolio before change:  [-28.00395637]
curr_Stock_Price:  105.24161989855385
curr_Factors:  [105.2416199]
mat_Sqrt:  [[0.15]]
grads:  [-0.01209789]
Stock Position:  -0.012097887569638529
Bond Position:  [-26.73075509]


portfolio before change:  [-28.00748236]
curr_Stock_Price:  105.25686551162586
curr_Factors:  [105.25686551]
mat_Sqrt:  [[0.15]]
grads:  [-0.09778253]
Stock Position:  -0.09778253322250594
Bond Position:  [-17.71519942]


portfolio before change:  [-27.83220064]
curr_Stock_Price:  103.44165109087261
curr_Factors:  [103.44165109]
mat_Sqrt:  [[0.15]]
grads:  [0.0495351]
Stock Position:  0.04953510002009466
Bond Position:  [-32.95619317]


portfolio before change:  [-27.80202761]
curr_Stock_Price:  104.13394413263077
curr_Factors:  [104.13394413]
mat_Sqrt:  [[0.15]]
grads:  [0.01082256]
Stock Position:  0.010822561323092032
Bond Position:  [-28.92902361]


portfolio before change:  [-27.82150818]
curr_Stock_Price:  102.66809752650647
curr_Factors:  [102.66809753]
mat_Sqrt:  [[0.15]]
grads:  [-0.14442872]
Stock Position:  -0.14442871809053662
Bond Position:  [-12.99328647]


portfolio before change:  [-27.82321855]
curr_Stock_Price:  102.66869367424808
curr_Factors:  [102.66869367]
mat_Sqrt:  [[0.15]]
grads:  [-0.13579131]
Stock Position:  -0.13579131356672866
Bond Position:  [-13.88170177]


portfolio before change:  [-27.90799792]
curr_Stock_Price:  103.2802501409087
curr_Factors:  [103.28025014]
mat_Sqrt:  [[0.15]]
grads:  [0.11292739]
Stock Position:  0.11292738662226613
Bond Position:  [-39.57116666]


portfolio before change:  [-27.96772968]
curr_Stock_Price:  102.79511491761686
curr_Factors:  [102.79511492]
mat_Sqrt:  [[0.15]]
grads:  [0.01580246]
Stock Position:  0.01580246289998142
Bond Position:  [-29.59214567]


portfolio before change:  [-27.96696271]
curr_Stock_Price:  103.07774305564591
curr_Factors:  [103.07774306]
mat_Sqrt:  [[0.15]]
grads:  [0.1375884]
Stock Position:  0.13758840491881946
Bond Position:  [-42.14926496]


portfolio before change:  [-28.02113459]
curr_Stock_Price:  102.72231419086047
curr_Factors:  [102.72231419]
mat_Sqrt:  [[0.15]]
grads:  [0.06656327]
Stock Position:  0.06656326614368394
Bond Position:  [-34.85866733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.11604757]
Stock Price:  101.36187347644686
PL:  [-29.47792105]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.85830500e-02]
 [ 3.79466978e-02]
 [-1.99743327e-03]
 [-6.84406573e-03]
 [-7.59747258e-03]
 [ 2.84004058e-02]
 [ 3.54563909e-03]
 [-1.68085382e-03]
 [-1.90432323e-02]
 [ 2.34453030e-02]
 [ 2.11210997e-02]
 [-9.82872953e-03]
 [ 6.23906394e-03]
 [ 7.52197839e-03]
 [-1.47535530e-02]
 [ 7.05701665e-04]
 [-6.06030444e-03]
 [ 4.23165283e-03]
 [ 5.04124023e-03]
 [-2.07234024e-02]
 [-4.36718129e-03]
 [-1.27708243e-02]
 [ 6.47785459e-03]
 [-7.79747045e-03]
 [ 1.51703462e-02]
 [ 7.92736202e-03]
 [-4.86872185e-03]
 [-2.84810254e-03]
 [ 3.59175658e-04]
 [-9.35846225e-03]
 [-2.57903669e-02]
 [ 1.90345971e-02]
 [-3.37715968e-03]
 [-1.88813901e-02]
 [-2.11488432e-02]
 [ 2.66272992e-02]
 [ 3.83322982e-03]
 [ 1.26620782e-02]
 [ 7.87986098e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.99689085]
curr_Stock_Price:  100.64267099486715
curr_Factors:  [100.64267099]
mat_Sqrt:  [[0.15]]
grads:  [-0.19055367]
Stock Position:  -0.19055366684479433
Bond Position:  [35.17472085]


portfolio before change:  [16.15833476]
curr_Stock_Price:  99.81851054677117
curr_Factors:  [99.81851055]
mat_Sqrt:  [[0.15]]
grads:  [0.25297799]
Stock Position:  0.2529779852757228
Bond Position:  [-9.09355093]


portfolio before change:  [16.16550756]
curr_Stock_Price:  99.85135752245523
curr_Factors:  [99.85135752]
mat_Sqrt:  [[0.15]]
grads:  [-0.01331622]
Stock Position:  -0.013316221778704937
Bond Position:  [17.49515038]


portfolio before change:  [16.17664569]
curr_Stock_Price:  99.17916214029766
curr_Factors:  [99.17916214]
mat_Sqrt:  [[0.15]]
grads:  [-0.0456271]
Stock Position:  -0.04562710485123837
Bond Position:  [20.70190372]


portfolio before change:  [16.14327061]
curr_Stock_Price:  99.96735550977174
curr_Factors:  [99.96735551]
mat_Sqrt:  [[0.15]]
grads:  [-0.05064982]
Stock Position:  -0.05064981723211456
Bond Position:  [21.20659889]


portfolio before change:  [16.1514166]
curr_Stock_Price:  99.85886549664804
curr_Factors:  [99.8588655]
mat_Sqrt:  [[0.15]]
grads:  [0.18933604]
Stock Position:  0.18933603863313683
Bond Position:  [-2.75546542]


portfolio before change:  [16.01200049]
curr_Stock_Price:  99.12434261935698
curr_Factors:  [99.12434262]
mat_Sqrt:  [[0.15]]
grads:  [0.02363759]
Stock Position:  0.023637593903988553
Bond Position:  [13.66893953]


portfolio before change:  [16.00722303]
curr_Stock_Price:  98.849941528922
curr_Factors:  [98.84994153]
mat_Sqrt:  [[0.15]]
grads:  [-0.01120569]
Stock Position:  -0.011205692149353137
Bond Position:  [17.11490505]


portfolio before change:  [16.01417388]
curr_Stock_Price:  98.42057452659903
curr_Factors:  [98.42057453]
mat_Sqrt:  [[0.15]]
grads:  [-0.12695488]
Stock Position:  -0.12695488190226184
Bond Position:  [28.5091463]


portfolio before change:  [16.17863573]
curr_Stock_Price:  97.1532110388961
curr_Factors:  [97.15321104]
mat_Sqrt:  [[0.15]]
grads:  [0.15630202]
Stock Position:  0.15630202002417684
Bond Position:  [0.99339259]


portfolio before change:  [16.3070376]
curr_Stock_Price:  97.9739150013895
curr_Factors:  [97.973915]
mat_Sqrt:  [[0.15]]
grads:  [0.14080733]
Stock Position:  0.1408073314268813
Bond Position:  [2.51159208]


portfolio before change:  [16.28012105]
curr_Stock_Price:  97.78052647583904
curr_Factors:  [97.78052648]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552486]
Stock Position:  -0.0655248635236501
Bond Position:  [22.6871767]


portfolio before change:  [16.22262492]
curr_Stock_Price:  98.70127926831609
curr_Factors:  [98.70127927]
mat_Sqrt:  [[0.15]]
grads:  [0.04159376]
Stock Position:  0.04159375962197351
Bond Position:  [12.11726764]


portfolio before change:  [16.20140018]
curr_Stock_Price:  98.15457469855363
curr_Factors:  [98.1545747]
mat_Sqrt:  [[0.15]]
grads:  [0.05014652]
Stock Position:  0.05014652262538666
Bond Position:  [11.27928957]


portfolio before change:  [16.20992573]
curr_Stock_Price:  98.29647004897562
curr_Factors:  [98.29647005]
mat_Sqrt:  [[0.15]]
grads:  [-0.09835702]
Stock Position:  -0.09835701977056621
Bond Position:  [25.87807358]


portfolio before change:  [16.26220324]
curr_Stock_Price:  97.7978523645105
curr_Factors:  [97.79785236]
mat_Sqrt:  [[0.15]]
grads:  [0.00470468]
Stock Position:  0.004704677769745968
Bond Position:  [15.80209586]


portfolio before change:  [16.26980071]
curr_Stock_Price:  98.99284958982915
curr_Factors:  [98.99284959]
mat_Sqrt:  [[0.15]]
grads:  [-0.04040203]
Stock Position:  -0.04040202960948372
Bond Position:  [20.26931275]


portfolio before change:  [16.2637082]
curr_Stock_Price:  99.20636186402767
curr_Factors:  [99.20636186]
mat_Sqrt:  [[0.15]]
grads:  [0.02821102]
Stock Position:  0.028211018866606426
Bond Position:  [13.46499565]


portfolio before change:  [16.25160192]
curr_Stock_Price:  98.71756312982744
curr_Factors:  [98.71756313]
mat_Sqrt:  [[0.15]]
grads:  [0.03360827]
Stock Position:  0.03360826820350614
Bond Position:  [12.93387558]


portfolio before change:  [16.27096729]
curr_Stock_Price:  99.24566352535139
curr_Factors:  [99.24566353]
mat_Sqrt:  [[0.15]]
grads:  [-0.13815602]
Stock Position:  -0.1381560159067646
Bond Position:  [29.98235276]


portfolio before change:  [16.45440296]
curr_Stock_Price:  97.94504960244495
curr_Factors:  [97.9450496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02911454]
Stock Position:  -0.02911454191136797
Bond Position:  [19.30602821]


portfolio before change:  [16.44611876]
curr_Stock_Price:  98.31248131353732
curr_Factors:  [98.31248131]
mat_Sqrt:  [[0.15]]
grads:  [-0.08513883]
Stock Position:  -0.08513882893991777
Bond Position:  [24.81632829]


portfolio before change:  [16.50583959]
curr_Stock_Price:  97.64746628819395
curr_Factors:  [97.64746629]
mat_Sqrt:  [[0.15]]
grads:  [0.0431857]
Stock Position:  0.04318569729143799
Bond Position:  [12.28886567]


portfolio before change:  [16.51829154]
curr_Stock_Price:  97.9002292584769
curr_Factors:  [97.90022926]
mat_Sqrt:  [[0.15]]
grads:  [-0.05198314]
Stock Position:  -0.051983136300993146
Bond Position:  [21.6074525]


portfolio before change:  [16.46975064]
curr_Stock_Price:  98.88597201884075
curr_Factors:  [98.88597202]
mat_Sqrt:  [[0.15]]
grads:  [0.10113564]
Stock Position:  0.10113564110037165
Bond Position:  [6.46885447]


portfolio before change:  [16.51593383]
curr_Stock_Price:  99.33462222278749
curr_Factors:  [99.33462222]
mat_Sqrt:  [[0.15]]
grads:  [0.05284908]
Stock Position:  0.052849080140411786
Bond Position:  [11.26619042]


portfolio before change:  [16.49029894]
curr_Stock_Price:  98.82291517990055
curr_Factors:  [98.82291518]
mat_Sqrt:  [[0.15]]
grads:  [-0.03245815]
Stock Position:  -0.03245814569266819
Bond Position:  [19.69790752]


portfolio before change:  [16.49600834]
curr_Stock_Price:  98.72287851551197
curr_Factors:  [98.72287852]
mat_Sqrt:  [[0.15]]
grads:  [-0.01898735]
Stock Position:  -0.018987350236431267
Bond Position:  [18.37049421]


portfolio before change:  [16.47657378]
curr_Stock_Price:  99.86737826990381
curr_Factors:  [99.86737827]
mat_Sqrt:  [[0.15]]
grads:  [0.0023945]
Stock Position:  0.002394504389862414
Bond Position:  [16.2374409]


portfolio before change:  [16.47916711]
curr_Stock_Price:  100.1027198478876
curr_Factors:  [100.10271985]
mat_Sqrt:  [[0.15]]
grads:  [-0.06238975]
Stock Position:  -0.062389748337077666
Bond Position:  [22.72455061]


portfolio before change:  [16.40827167]
curr_Stock_Price:  101.28458364327321
curr_Factors:  [101.28458364]
mat_Sqrt:  [[0.15]]
grads:  [-0.17193578]
Stock Position:  -0.1719357796141078
Bond Position:  [33.82271552]


portfolio before change:  [16.50408094]
curr_Stock_Price:  100.75193610936236
curr_Factors:  [100.75193611]
mat_Sqrt:  [[0.15]]
grads:  [0.12689731]
Stock Position:  0.12689731421826397
Bond Position:  [3.71893085]


portfolio before change:  [16.60452344]
curr_Stock_Price:  101.53979830345425
curr_Factors:  [101.5397983]
mat_Sqrt:  [[0.15]]
grads:  [-0.0225144]
Stock Position:  -0.022514397864100463
Bond Position:  [18.89063085]


portfolio before change:  [16.60541859]
curr_Stock_Price:  101.60492667031012
curr_Factors:  [101.60492667]
mat_Sqrt:  [[0.15]]
grads:  [-0.12587593]
Stock Position:  -0.12587593430759098
Bond Position:  [29.39503366]


portfolio before change:  [16.73598146]
curr_Stock_Price:  100.59688434919441
curr_Factors:  [100.59688435]
mat_Sqrt:  [[0.15]]
grads:  [-0.14099229]
Stock Position:  -0.1409922881842207
Bond Position:  [30.91936637]


portfolio before change:  [16.65856126]
curr_Stock_Price:  101.17340783528972
curr_Factors:  [101.17340784]
mat_Sqrt:  [[0.15]]
grads:  [0.17751533]
Stock Position:  0.17751532803443976
Bond Position:  [-1.30126942]


portfolio before change:  [16.83678555]
curr_Stock_Price:  102.17831801928618
curr_Factors:  [102.17831802]
mat_Sqrt:  [[0.15]]
grads:  [0.02555487]
Stock Position:  0.025554865437217245
Bond Position:  [14.22563239]


portfolio before change:  [16.81257945]
curr_Stock_Price:  101.16150876932913
curr_Factors:  [101.16150877]
mat_Sqrt:  [[0.15]]
grads:  [0.08441385]
Stock Position:  0.0844138549140863
Bond Position:  [8.27314652]


portfolio before change:  [16.82205879]
curr_Stock_Price:  101.2615532146572
curr_Factors:  [101.26155321]
mat_Sqrt:  [[0.15]]
grads:  [0.05253241]
Stock Position:  0.05253240652600906
Bond Position:  [11.50254571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.83870281]
Stock Price:  101.55101484214258
PL:  [15.28768797]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.53619436e-02]
 [ 4.35096599e-02]
 [-1.98708088e-03]
 [-5.55541352e-03]
 [-7.63166123e-03]
 [ 2.87920237e-02]
 [ 3.55144868e-03]
 [ 4.10371272e-04]
 [-2.27710598e-02]
 [ 2.34422804e-02]
 [ 2.08950996e-02]
 [-1.45552218e-02]
 [ 6.01587352e-03]
 [ 6.35319914e-03]
 [-1.56475681e-02]
 [ 7.05586070e-04]
 [-6.05817150e-03]
 [ 4.66233807e-03]
 [ 5.35032750e-03]
 [-2.99874005e-02]
 [-5.72210103e-03]
 [-1.61818002e-02]
 [ 5.92962426e-03]
 [-9.67083023e-03]
 [ 1.25532099e-02]
 [ 2.16307993e-03]
 [ 2.05215435e-02]
 [-3.81857496e-03]
 [-2.95053995e-02]
 [-9.90336790e-03]
 [ 4.31047662e-02]
 [ 5.27838579e-03]
 [-1.76265726e-02]
 [-2.73862277e-02]
 [-2.33931202e-02]
 [ 3.52867531e-02]
 [-5.36552948e-03]
 [-3.59343293e-03]
 [ 2.69728333e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.54841856]
curr_Stock_Price:  101.03215931582594
curr_Factors:  [101.03215932]
mat_Sqrt:  [[0.15]]
grads:  [-0.30241296]
Stock Position:  -0.3024129575185277
Bond Position:  [55.10185266]


portfolio before change:  [24.81798213]
curr_Stock_Price:  100.16356090660405
curr_Factors:  [100.16356091]
mat_Sqrt:  [[0.15]]
grads:  [0.2900644]
Stock Position:  0.29006439929101807
Bond Position:  [-4.23590099]


portfolio before change:  [24.72370595]
curr_Stock_Price:  99.84036831651451
curr_Factors:  [99.84036832]
mat_Sqrt:  [[0.15]]
grads:  [-0.01324721]
Stock Position:  -0.01324720585740135
Bond Position:  [26.04631186]


portfolio before change:  [24.7233867]
curr_Stock_Price:  100.11025462656164
curr_Factors:  [100.11025463]
mat_Sqrt:  [[0.15]]
grads:  [-0.03703609]
Stock Position:  -0.03703609010014031
Bond Position:  [28.43107911]


portfolio before change:  [24.73112294]
curr_Stock_Price:  99.99733409279641
curr_Factors:  [99.99733409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05087774]
Stock Position:  -0.05087774150383589
Bond Position:  [29.81876146]


portfolio before change:  [24.77833333]
curr_Stock_Price:  99.14268109956967
curr_Factors:  [99.1426811]
mat_Sqrt:  [[0.15]]
grads:  [0.19194682]
Stock Position:  0.19194682435354374
Bond Position:  [5.74821054]


portfolio before change:  [24.72189679]
curr_Stock_Price:  98.84491573526847
curr_Factors:  [98.84491574]
mat_Sqrt:  [[0.15]]
grads:  [0.02367632]
Stock Position:  0.02367632451856255
Bond Position:  [22.38161249]


portfolio before change:  [24.69543071]
curr_Stock_Price:  97.60891513300815
curr_Factors:  [97.60891513]
mat_Sqrt:  [[0.15]]
grads:  [0.00273581]
Stock Position:  0.0027358084813100046
Bond Position:  [24.42839142]


portfolio before change:  [24.70153663]
curr_Stock_Price:  98.72455576558242
curr_Factors:  [98.72455577]
mat_Sqrt:  [[0.15]]
grads:  [-0.15180707]
Stock Position:  -0.15180706533062943
Bond Position:  [39.68862172]


portfolio before change:  [24.79928063]
curr_Stock_Price:  98.11336809150274
curr_Factors:  [98.11336809]
mat_Sqrt:  [[0.15]]
grads:  [0.15628187]
Stock Position:  0.1562818693457956
Bond Position:  [9.46594006]


portfolio before change:  [24.84289496]
curr_Stock_Price:  98.38487120200803
curr_Factors:  [98.3848712]
mat_Sqrt:  [[0.15]]
grads:  [0.13930066]
Stock Position:  0.1393006637125227
Bond Position:  [11.1378171]


portfolio before change:  [24.9522979]
curr_Stock_Price:  99.16024892841261
curr_Factors:  [99.16024893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09703481]
Stock Position:  -0.09703481221343281
Bond Position:  [34.57429404]


portfolio before change:  [25.00250943]
curr_Stock_Price:  98.68733136260701
curr_Factors:  [98.68733136]
mat_Sqrt:  [[0.15]]
grads:  [0.04010582]
Stock Position:  0.04010582348953845
Bond Position:  [21.04457274]


portfolio before change:  [25.00437693]
curr_Stock_Price:  98.66830074660952
curr_Factors:  [98.66830075]
mat_Sqrt:  [[0.15]]
grads:  [0.04235466]
Stock Position:  0.04235466090322324
Bond Position:  [20.82531451]


portfolio before change:  [24.98513967]
curr_Stock_Price:  98.15264125478764
curr_Factors:  [98.15264125]
mat_Sqrt:  [[0.15]]
grads:  [-0.10431712]
Stock Position:  -0.10431712082108041
Bond Position:  [35.22414061]


portfolio before change:  [25.0237695]
curr_Stock_Price:  97.82454043181484
curr_Factors:  [97.82454043]
mat_Sqrt:  [[0.15]]
grads:  [0.00470391]
Stock Position:  0.004703907131397694
Bond Position:  [24.56361194]


portfolio before change:  [25.02749463]
curr_Stock_Price:  97.96367729825593
curr_Factors:  [97.9636773]
mat_Sqrt:  [[0.15]]
grads:  [-0.04038781]
Stock Position:  -0.040387809973655785
Bond Position:  [28.98403301]


portfolio before change:  [24.97410244]
curr_Stock_Price:  99.37537601991421
curr_Factors:  [99.37537602]
mat_Sqrt:  [[0.15]]
grads:  [0.03108225]
Stock Position:  0.03108225382543324
Bond Position:  [21.88529178]


portfolio before change:  [24.96979864]
curr_Stock_Price:  99.14889208177226
curr_Factors:  [99.14889208]
mat_Sqrt:  [[0.15]]
grads:  [0.03566885]
Stock Position:  0.03566885001636131
Bond Position:  [21.43327168]


portfolio before change:  [24.94000837]
curr_Stock_Price:  98.23858529379504
curr_Factors:  [98.23858529]
mat_Sqrt:  [[0.15]]
grads:  [-0.199916]
Stock Position:  -0.1999160034501135
Bond Position:  [44.57947373]


portfolio before change:  [25.07658486]
curr_Stock_Price:  97.58329154527124
curr_Factors:  [97.58329155]
mat_Sqrt:  [[0.15]]
grads:  [-0.03814734]
Stock Position:  -0.03814734023160199
Bond Position:  [28.79912788]


portfolio before change:  [25.07935261]
curr_Stock_Price:  97.60511134207398
curr_Factors:  [97.60511134]
mat_Sqrt:  [[0.15]]
grads:  [-0.10787867]
Stock Position:  -0.1078786679680111
Bond Position:  [35.60886201]


portfolio before change:  [25.15934222]
curr_Stock_Price:  96.90489666828853
curr_Factors:  [96.90489667]
mat_Sqrt:  [[0.15]]
grads:  [0.03953083]
Stock Position:  0.03953082837071293
Bond Position:  [21.32861138]


portfolio before change:  [25.16002835]
curr_Stock_Price:  96.85480644619062
curr_Factors:  [96.85480645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0644722]
Stock Position:  -0.06447220150496634
Bond Position:  [31.40447095]


portfolio before change:  [25.16742297]
curr_Stock_Price:  96.80100317512495
curr_Factors:  [96.80100318]
mat_Sqrt:  [[0.15]]
grads:  [0.08368807]
Stock Position:  0.08368806627316548
Bond Position:  [17.0663342]


portfolio before change:  [25.140488]
curr_Stock_Price:  96.45366093130224
curr_Factors:  [96.45366093]
mat_Sqrt:  [[0.15]]
grads:  [0.01442053]
Stock Position:  0.0144205328754305
Bond Position:  [23.74957481]


portfolio before change:  [25.13849234]
curr_Stock_Price:  96.10939206419165
curr_Factors:  [96.10939206]
mat_Sqrt:  [[0.15]]
grads:  [0.13681029]
Stock Position:  0.1368102901052339
Bond Position:  [11.98973853]


portfolio before change:  [25.27717307]
curr_Stock_Price:  97.11210846008512
curr_Factors:  [97.11210846]
mat_Sqrt:  [[0.15]]
grads:  [-0.02545717]
Stock Position:  -0.025457166395665694
Bond Position:  [27.74937218]


portfolio before change:  [25.31669427]
curr_Stock_Price:  95.69591371398936
curr_Factors:  [95.69591371]
mat_Sqrt:  [[0.15]]
grads:  [-0.19670266]
Stock Position:  -0.1967026635279241
Bond Position:  [44.14033538]


portfolio before change:  [25.36729529]
curr_Stock_Price:  95.4667193636577
curr_Factors:  [95.46671936]
mat_Sqrt:  [[0.15]]
grads:  [-0.06602245]
Stock Position:  -0.06602245265310308
Bond Position:  [31.67024225]


portfolio before change:  [25.36668242]
curr_Stock_Price:  95.5359669369893
curr_Factors:  [95.53596694]
mat_Sqrt:  [[0.15]]
grads:  [0.28736511]
Stock Position:  0.2873651077580239
Bond Position:  [-2.08702101]


portfolio before change:  [25.69013127]
curr_Stock_Price:  96.66244239322374
curr_Factors:  [96.66244239]
mat_Sqrt:  [[0.15]]
grads:  [0.03518924]
Stock Position:  0.03518923860822428
Bond Position:  [22.28865352]


portfolio before change:  [25.66260783]
curr_Stock_Price:  95.80110806491659
curr_Factors:  [95.80110806]
mat_Sqrt:  [[0.15]]
grads:  [-0.11751048]
Stock Position:  -0.11751048414744915
Bond Position:  [36.92024242]


portfolio before change:  [25.77867985]
curr_Stock_Price:  94.85262504595227
curr_Factors:  [94.85262505]
mat_Sqrt:  [[0.15]]
grads:  [-0.18257485]
Stock Position:  -0.182574851306918
Bond Position:  [43.09638376]


portfolio before change:  [25.71640757]
curr_Stock_Price:  95.2232109046354
curr_Factors:  [95.2232109]
mat_Sqrt:  [[0.15]]
grads:  [-0.15595413]
Stock Position:  -0.15595413462449326
Bond Position:  [40.56686103]


portfolio before change:  [25.78251264]
curr_Stock_Price:  94.83185295971133
curr_Factors:  [94.83185296]
mat_Sqrt:  [[0.15]]
grads:  [0.23524502]
Stock Position:  0.23524502034749345
Bond Position:  [3.47379146]


portfolio before change:  [25.83130687]
curr_Stock_Price:  95.03742577924746
curr_Factors:  [95.03742578]
mat_Sqrt:  [[0.15]]
grads:  [-0.0357702]
Stock Position:  -0.035770196557261366
Bond Position:  [29.23081427]


portfolio before change:  [25.8401872]
curr_Stock_Price:  94.891319443287
curr_Factors:  [94.89131944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02395622]
Stock Position:  -0.02395621951045399
Bond Position:  [28.11342448]


portfolio before change:  [25.85241933]
curr_Stock_Price:  94.52741679988495
curr_Factors:  [94.5274168]
mat_Sqrt:  [[0.15]]
grads:  [0.17981889]
Stock Position:  0.17981888855824654
Bond Position:  [8.8546043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.8885444]
Stock Price:  94.72215815224969
PL:  [25.8885444]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.59062772e-03]
 [ 3.99434438e-02]
 [-3.76099476e-03]
 [-1.65712166e-03]
 [-2.16707460e-03]
 [ 2.51458063e-02]
 [ 3.50078071e-03]
 [ 1.86433304e-02]
 [ 5.46392256e-04]
 [ 2.27247862e-02]
 [ 1.82764379e-02]
 [-5.70033781e-03]
 [ 3.33224480e-03]
 [ 2.33558290e-02]
 [-8.71397514e-03]
 [-3.94261965e-03]
 [-5.11889512e-03]
 [ 7.27962768e-03]
 [ 1.10301816e-02]
 [ 1.56252399e-02]
 [-3.69462133e-03]
 [-5.25902203e-03]
 [ 4.39193320e-03]
 [-1.23390150e-02]
 [ 4.16925490e-03]
 [ 3.28887428e-03]
 [-2.58316509e-03]
 [ 4.32526103e-04]
 [ 4.28243874e-03]
 [-6.11008617e-03]
 [-1.80919345e-02]
 [ 7.66442126e-03]
 [-5.28022968e-04]
 [-1.37018784e-02]
 [-2.02752501e-02]
 [ 2.25829081e-02]
 [ 5.14791599e-03]
 [ 8.89674459e-03]
 [ 5.74911223e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.39489671]
curr_Stock_Price:  100.43306833305022
curr_Factors:  [100.43306833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05060418]
Stock Position:  -0.05060418479345468
Bond Position:  [16.47723026]


portfolio before change:  [11.42329218]
curr_Stock_Price:  99.9126431913909
curr_Factors:  [99.91264319]
mat_Sqrt:  [[0.15]]
grads:  [0.26628963]
Stock Position:  0.2662896250491193
Bond Position:  [-15.18240811]


portfolio before change:  [11.73761223]
curr_Stock_Price:  101.10013957063455
curr_Factors:  [101.10013957]
mat_Sqrt:  [[0.15]]
grads:  [-0.0250733]
Stock Position:  -0.025073298391526506
Bond Position:  [14.27252619]


portfolio before change:  [11.72815021]
curr_Stock_Price:  101.54867223602837
curr_Factors:  [101.54867224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01104748]
Stock Position:  -0.011047477729180919
Bond Position:  [12.85000691]


portfolio before change:  [11.72805065]
curr_Stock_Price:  101.70308844176743
curr_Factors:  [101.70308844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01444716]
Stock Position:  -0.014447163969685713
Bond Position:  [13.19737185]


portfolio before change:  [11.7304823]
curr_Stock_Price:  101.6489690298985
curr_Factors:  [101.64896903]
mat_Sqrt:  [[0.15]]
grads:  [0.16763871]
Stock Position:  0.1676387084457067
Bond Position:  [-5.30981958]


portfolio before change:  [11.82418132]
curr_Stock_Price:  102.2118628062428
curr_Factors:  [102.21186281]
mat_Sqrt:  [[0.15]]
grads:  [0.02333854]
Stock Position:  0.023338538055642892
Bond Position:  [9.43870587]


portfolio before change:  [11.82772689]
curr_Stock_Price:  102.31322552575557
curr_Factors:  [102.31322553]
mat_Sqrt:  [[0.15]]
grads:  [0.12428887]
Stock Position:  0.12428886949574006
Bond Position:  [-0.88866825]


portfolio before change:  [11.82919255]
curr_Stock_Price:  102.32591171790087
curr_Factors:  [102.32591172]
mat_Sqrt:  [[0.15]]
grads:  [0.00364262]
Stock Position:  0.0036426150390387003
Bond Position:  [11.45645864]


portfolio before change:  [11.83357419]
curr_Stock_Price:  103.13563128730762
curr_Factors:  [103.13563129]
mat_Sqrt:  [[0.15]]
grads:  [0.15149857]
Stock Position:  0.1514985747865945
Bond Position:  [-3.79132696]


portfolio before change:  [11.72536537]
curr_Stock_Price:  102.42450332922826
curr_Factors:  [102.42450333]
mat_Sqrt:  [[0.15]]
grads:  [0.12184292]
Stock Position:  0.12184291913029721
Bond Position:  [-0.7543351]


portfolio before change:  [11.73632643]
curr_Stock_Price:  102.51523777724387
curr_Factors:  [102.51523778]
mat_Sqrt:  [[0.15]]
grads:  [-0.03800225]
Stock Position:  -0.03800225205369001
Bond Position:  [15.63213633]


portfolio before change:  [11.7123895]
curr_Stock_Price:  103.19654134602449
curr_Factors:  [103.19654135]
mat_Sqrt:  [[0.15]]
grads:  [0.02221497]
Stock Position:  0.02221496530740695
Bond Position:  [9.41988191]


portfolio before change:  [11.72156699]
curr_Stock_Price:  103.55665593661311
curr_Factors:  [103.55665594]
mat_Sqrt:  [[0.15]]
grads:  [0.15570553]
Stock Position:  0.1557055264506739
Bond Position:  [-4.40277664]


portfolio before change:  [11.93367531]
curr_Stock_Price:  104.92243083822859
curr_Factors:  [104.92243084]
mat_Sqrt:  [[0.15]]
grads:  [-0.05809317]
Stock Position:  -0.05809316761548352
Bond Position:  [18.02895167]


portfolio before change:  [11.97109761]
curr_Stock_Price:  104.31704916417601
curr_Factors:  [104.31704916]
mat_Sqrt:  [[0.15]]
grads:  [-0.02628413]
Stock Position:  -0.026284130991128408
Bond Position:  [14.71298059]


portfolio before change:  [12.00080634]
curr_Stock_Price:  103.25673283912938
curr_Factors:  [103.25673284]
mat_Sqrt:  [[0.15]]
grads:  [-0.03412597]
Stock Position:  -0.034125967492686836
Bond Position:  [15.52454224]


portfolio before change:  [12.02754363]
curr_Stock_Price:  102.53011306921837
curr_Factors:  [102.53011307]
mat_Sqrt:  [[0.15]]
grads:  [0.04853085]
Stock Position:  0.04853085118345419
Bond Position:  [7.05166997]


portfolio before change:  [11.98327561]
curr_Stock_Price:  101.59978661531548
curr_Factors:  [101.59978662]
mat_Sqrt:  [[0.15]]
grads:  [0.07353454]
Stock Position:  0.07353454428738823
Bond Position:  [4.5121816]


portfolio before change:  [12.00037065]
curr_Stock_Price:  101.8245923081187
curr_Factors:  [101.82459231]
mat_Sqrt:  [[0.15]]
grads:  [0.10416827]
Stock Position:  0.10416826624921494
Bond Position:  [1.39347941]


portfolio before change:  [11.95575706]
curr_Stock_Price:  101.3946361915441
curr_Factors:  [101.39463619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02463081]
Stock Position:  -0.024630808874995084
Bond Position:  [14.45318897]


portfolio before change:  [11.93993774]
curr_Stock_Price:  102.11024757117767
curr_Factors:  [102.11024757]
mat_Sqrt:  [[0.15]]
grads:  [-0.03506015]
Stock Position:  -0.035060146886708485
Bond Position:  [15.51993801]


portfolio before change:  [11.95358211]
curr_Stock_Price:  101.77641376046573
curr_Factors:  [101.77641376]
mat_Sqrt:  [[0.15]]
grads:  [0.02927955]
Stock Position:  0.029279554662913626
Bond Position:  [8.97361404]


portfolio before change:  [11.96629128]
curr_Stock_Price:  102.17216402355584
curr_Factors:  [102.17216402]
mat_Sqrt:  [[0.15]]
grads:  [-0.0822601]
Stock Position:  -0.0822601001175329
Bond Position:  [20.37098372]


portfolio before change:  [12.01428395]
curr_Stock_Price:  101.61969517009679
curr_Factors:  [101.61969517]
mat_Sqrt:  [[0.15]]
grads:  [0.02779503]
Stock Position:  0.027795032650799308
Bond Position:  [9.18976121]


portfolio before change:  [12.0448144]
curr_Stock_Price:  102.6767783212618
curr_Factors:  [102.67677832]
mat_Sqrt:  [[0.15]]
grads:  [0.02192583]
Stock Position:  0.021925828502917754
Bond Position:  [9.79354097]


portfolio before change:  [12.02387656]
curr_Stock_Price:  101.6660018323426
curr_Factors:  [101.66600183]
mat_Sqrt:  [[0.15]]
grads:  [-0.0172211]
Stock Position:  -0.01722110057452344
Bond Position:  [13.774677]


portfolio before change:  [12.01525492]
curr_Stock_Price:  102.26663611380843
curr_Factors:  [102.26663611]
mat_Sqrt:  [[0.15]]
grads:  [0.00288351]
Stock Position:  0.0028835073519299127
Bond Position:  [11.72036832]


portfolio before change:  [12.01946125]
curr_Stock_Price:  103.21728194483632
curr_Factors:  [103.21728194]
mat_Sqrt:  [[0.15]]
grads:  [0.02854959]
Stock Position:  0.028549591567414614
Bond Position:  [9.07265001]


portfolio before change:  [11.99934561]
curr_Stock_Price:  102.47297023169105
curr_Factors:  [102.47297023]
mat_Sqrt:  [[0.15]]
grads:  [-0.04073391]
Stock Position:  -0.040733907831400885
Bond Position:  [16.17347013]


portfolio before change:  [11.96790165]
curr_Stock_Price:  103.29454046437706
curr_Factors:  [103.29454046]
mat_Sqrt:  [[0.15]]
grads:  [-0.1206129]
Stock Position:  -0.12061289677529843
Bond Position:  [24.4265554]


portfolio before change:  [11.97247525]
curr_Stock_Price:  103.28193745961676
curr_Factors:  [103.28193746]
mat_Sqrt:  [[0.15]]
grads:  [0.05109614]
Stock Position:  0.051096141720577304
Bond Position:  [6.69516673]


portfolio before change:  [11.97744744]
curr_Stock_Price:  103.36286821184619
curr_Factors:  [103.36286821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00352015]
Stock Position:  -0.0035201531218203323
Bond Position:  [12.34130057]


portfolio before change:  [11.97885142]
curr_Stock_Price:  103.40229312101805
curr_Factors:  [103.40229312]
mat_Sqrt:  [[0.15]]
grads:  [-0.09134586]
Stock Position:  -0.09134585599036668
Bond Position:  [21.4242224]


portfolio before change:  [11.96313224]
curr_Stock_Price:  103.60369669415847
curr_Factors:  [103.60369669]
mat_Sqrt:  [[0.15]]
grads:  [-0.13516833]
Stock Position:  -0.1351683340541265
Bond Position:  [25.96707132]


portfolio before change:  [12.163031]
curr_Stock_Price:  102.14882432880783
curr_Factors:  [102.14882433]
mat_Sqrt:  [[0.15]]
grads:  [0.15055272]
Stock Position:  0.15055272087750507
Bond Position:  [-3.21575244]


portfolio before change:  [12.0823874]
curr_Stock_Price:  101.61584427891448
curr_Factors:  [101.61584428]
mat_Sqrt:  [[0.15]]
grads:  [0.03431944]
Stock Position:  0.03431943995968998
Bond Position:  [8.59498854]


portfolio before change:  [12.02774467]
curr_Stock_Price:  99.99235705932036
curr_Factors:  [99.99235706]
mat_Sqrt:  [[0.15]]
grads:  [0.05931163]
Stock Position:  0.0593116306300383
Bond Position:  [6.09703493]


portfolio before change:  [12.01780358]
curr_Stock_Price:  99.8118988149693
curr_Factors:  [99.81189881]
mat_Sqrt:  [[0.15]]
grads:  [0.03832741]
Stock Position:  0.03832741486563694
Bond Position:  [8.19227152]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.04800731]
Stock Price:  100.5732242307904
PL:  [11.47478308]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.82976015e-02]
 [-1.99112740e-02]
 [-3.53501493e-03]
 [-2.02061494e-03]
 [-5.40864165e-03]
 [ 2.94033162e-02]
 [ 3.74869166e-03]
 [ 4.48599983e-03]
 [-2.15448091e-02]
 [ 2.33583539e-02]
 [ 1.96967819e-02]
 [-1.47214976e-02]
 [ 1.36051466e-02]
 [ 6.29639937e-03]
 [-1.26276130e-02]
 [ 5.40086267e-04]
 [-6.08861514e-03]
 [ 2.90299123e-03]
 [ 3.85168739e-03]
 [-2.81869107e-02]
 [-2.78599153e-03]
 [-1.29264791e-02]
 [ 6.70702806e-03]
 [-7.32384482e-03]
 [ 1.25629251e-02]
 [ 5.56672691e-03]
 [-3.24117594e-04]
 [-3.66901023e-03]
 [-1.90996862e-02]
 [-1.37066894e-02]
 [ 3.52227969e-02]
 [ 5.27988635e-03]
 [-1.44503276e-02]
 [-3.42585204e-02]
 [-2.30339921e-02]
 [ 3.74160598e-02]
 [-4.92185676e-03]
 [-2.14426378e-03]
 [ 1.70075050e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.15949469]
curr_Stock_Price:  100.78671511208208
curr_Factors:  [100.78671511]
mat_Sqrt:  [[0.15]]
grads:  [-0.25531734]
Stock Position:  -0.2553173430583308
Bond Position:  [44.89209101]


portfolio before change:  [18.94507122]
curr_Stock_Price:  101.64852623485
curr_Factors:  [101.64852623]
mat_Sqrt:  [[0.15]]
grads:  [-0.13274183]
Stock Position:  -0.13274182635352438
Bond Position:  [32.43808224]


portfolio before change:  [19.04423736]
curr_Stock_Price:  100.9320141870934
curr_Factors:  [100.93201419]
mat_Sqrt:  [[0.15]]
grads:  [-0.02356677]
Stock Position:  -0.02356676617751491
Bond Position:  [21.42287853]


portfolio before change:  [19.03391802]
curr_Stock_Price:  101.48352641622328
curr_Factors:  [101.48352642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347077]
Stock Position:  -0.013470766276631614
Bond Position:  [20.40097889]


portfolio before change:  [19.04772705]
curr_Stock_Price:  100.64773534816436
curr_Factors:  [100.64773535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03605761]
Stock Position:  -0.03605761099158946
Bond Position:  [22.67684394]


portfolio before change:  [19.02382521]
curr_Stock_Price:  101.38923262021873
curr_Factors:  [101.38923262]
mat_Sqrt:  [[0.15]]
grads:  [0.19602211]
Stock Position:  0.19602210819326793
Bond Position:  [-0.85070591]


portfolio before change:  [18.92823629]
curr_Stock_Price:  100.90213155348833
curr_Factors:  [100.90213155]
mat_Sqrt:  [[0.15]]
grads:  [0.02499128]
Stock Position:  0.024991277711083247
Bond Position:  [16.4065631]


portfolio before change:  [18.91288602]
curr_Stock_Price:  100.20583996151484
curr_Factors:  [100.20583996]
mat_Sqrt:  [[0.15]]
grads:  [0.02990667]
Stock Position:  0.029906665564793742
Bond Position:  [15.91606348]


portfolio before change:  [18.93083828]
curr_Stock_Price:  100.73958804550917
curr_Factors:  [100.73958805]
mat_Sqrt:  [[0.15]]
grads:  [-0.14363206]
Stock Position:  -0.14363206062291226
Bond Position:  [33.4002729]


portfolio before change:  [18.9689427]
curr_Stock_Price:  100.50336551800848
curr_Factors:  [100.50336552]
mat_Sqrt:  [[0.15]]
grads:  [0.15572236]
Stock Position:  0.15572235939209997
Bond Position:  [3.3183215]


portfolio before change:  [18.80304588]
curr_Stock_Price:  99.43536448923447
curr_Factors:  [99.43536449]
mat_Sqrt:  [[0.15]]
grads:  [0.13131188]
Stock Position:  0.13131187906597513
Bond Position:  [5.74600132]


portfolio before change:  [18.77781296]
curr_Stock_Price:  99.23773410630453
curr_Factors:  [99.23773411]
mat_Sqrt:  [[0.15]]
grads:  [-0.09814332]
Stock Position:  -0.098143317396479
Bond Position:  [28.51733339]


portfolio before change:  [18.78362279]
curr_Stock_Price:  99.21485995800008
curr_Factors:  [99.21485996]
mat_Sqrt:  [[0.15]]
grads:  [0.09070098]
Stock Position:  0.09070097712994536
Bond Position:  [9.78473805]


portfolio before change:  [18.73793226]
curr_Stock_Price:  98.69762515336879
curr_Factors:  [98.69762515]
mat_Sqrt:  [[0.15]]
grads:  [0.041976]
Stock Position:  0.041975995810913824
Bond Position:  [14.59500116]


portfolio before change:  [18.73727451]
curr_Stock_Price:  98.63849039703038
curr_Factors:  [98.6384904]
mat_Sqrt:  [[0.15]]
grads:  [-0.08418409]
Stock Position:  -0.0841840869635657
Bond Position:  [27.04106576]


portfolio before change:  [18.75454909]
curr_Stock_Price:  98.47344446257763
curr_Factors:  [98.47344446]
mat_Sqrt:  [[0.15]]
grads:  [0.00360058]
Stock Position:  0.003600575110283587
Bond Position:  [18.39998806]


portfolio before change:  [18.75943564]
curr_Stock_Price:  99.19177608579275
curr_Factors:  [99.19177609]
mat_Sqrt:  [[0.15]]
grads:  [-0.04059077]
Stock Position:  -0.04059076757373309
Bond Position:  [22.78570597]


portfolio before change:  [18.80558999]
curr_Stock_Price:  98.12488441797821
curr_Factors:  [98.12488442]
mat_Sqrt:  [[0.15]]
grads:  [0.01935327]
Stock Position:  0.019353274840226496
Bond Position:  [16.90655213]


portfolio before change:  [18.80527504]
curr_Stock_Price:  97.99940718400421
curr_Factors:  [97.99940718]
mat_Sqrt:  [[0.15]]
grads:  [0.02567792]
Stock Position:  0.02567791596473838
Bond Position:  [16.2888545]


portfolio before change:  [18.82443954]
curr_Stock_Price:  98.66644976744755
curr_Factors:  [98.66644977]
mat_Sqrt:  [[0.15]]
grads:  [-0.18791274]
Stock Position:  -0.18791273789877244
Bond Position:  [37.36512225]


portfolio before change:  [18.80552147]
curr_Stock_Price:  98.79198145701795
curr_Factors:  [98.79198146]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857328]
Stock Position:  -0.018573276869624625
Bond Position:  [20.64041229]


portfolio before change:  [18.81760711]
curr_Stock_Price:  98.28020153996019
curr_Factors:  [98.28020154]
mat_Sqrt:  [[0.15]]
grads:  [-0.08617653]
Stock Position:  -0.0861765275765848
Bond Position:  [27.28705361]


portfolio before change:  [18.7813527]
curr_Stock_Price:  98.74048351133341
curr_Factors:  [98.74048351]
mat_Sqrt:  [[0.15]]
grads:  [0.04471352]
Stock Position:  0.044713520399357394
Bond Position:  [14.36631808]


portfolio before change:  [18.75290614]
curr_Stock_Price:  98.06412283836956
curr_Factors:  [98.06412284]
mat_Sqrt:  [[0.15]]
grads:  [-0.04882563]
Stock Position:  -0.048825632116863714
Bond Position:  [23.54094892]


portfolio before change:  [18.81690149]
curr_Stock_Price:  96.81370275571459
curr_Factors:  [96.81370276]
mat_Sqrt:  [[0.15]]
grads:  [0.08375283]
Stock Position:  0.0837528341498105
Bond Position:  [10.7084795]


portfolio before change:  [18.90814404]
curr_Stock_Price:  97.88714588409727
curr_Factors:  [97.88714588]
mat_Sqrt:  [[0.15]]
grads:  [0.03711151]
Stock Position:  0.03711151274740639
Bond Position:  [15.27540398]


portfolio before change:  [18.92930139]
curr_Stock_Price:  98.4057937064598
curr_Factors:  [98.40579371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00216078]
Stock Position:  -0.002160783956963094
Bond Position:  [19.14193505]


portfolio before change:  [18.9336947]
curr_Stock_Price:  97.48000785524033
curr_Factors:  [97.48000786]
mat_Sqrt:  [[0.15]]
grads:  [-0.02446007]
Stock Position:  -0.02446006817236724
Bond Position:  [21.31806234]


portfolio before change:  [18.95070367]
curr_Stock_Price:  96.89358114617077
curr_Factors:  [96.89358115]
mat_Sqrt:  [[0.15]]
grads:  [-0.12733124]
Stock Position:  -0.12733124107947827
Bond Position:  [31.28828361]


portfolio before change:  [18.88044665]
curr_Stock_Price:  97.47606428445522
curr_Factors:  [97.47606428]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137793]
Stock Position:  -0.0913779294160839
Bond Position:  [27.78760757]


portfolio before change:  [18.92117951]
curr_Stock_Price:  97.06831598092161
curr_Factors:  [97.06831598]
mat_Sqrt:  [[0.15]]
grads:  [0.23481865]
Stock Position:  0.2348186458668268
Bond Position:  [-3.87227101]


portfolio before change:  [18.8255035]
curr_Stock_Price:  96.66293102151603
curr_Factors:  [96.66293102]
mat_Sqrt:  [[0.15]]
grads:  [0.03519924]
Stock Position:  0.03519924236439201
Bond Position:  [15.42304156]


portfolio before change:  [18.83604681]
curr_Stock_Price:  96.90768945661388
curr_Factors:  [96.90768946]
mat_Sqrt:  [[0.15]]
grads:  [-0.09633552]
Stock Position:  -0.09633551706473296
Bond Position:  [28.17169918]


portfolio before change:  [18.97592565]
curr_Stock_Price:  95.49224936529447
curr_Factors:  [95.49224937]
mat_Sqrt:  [[0.15]]
grads:  [-0.22839014]
Stock Position:  -0.22839013586544177
Bond Position:  [40.78541345]


portfolio before change:  [18.8030778]
curr_Stock_Price:  96.27138256136664
curr_Factors:  [96.27138256]
mat_Sqrt:  [[0.15]]
grads:  [-0.15355995]
Stock Position:  -0.15355994757610572
Bond Position:  [33.58650626]


portfolio before change:  [18.87837128]
curr_Stock_Price:  95.80840442309712
curr_Factors:  [95.80840442]
mat_Sqrt:  [[0.15]]
grads:  [0.2494404]
Stock Position:  0.2494403983881205
Bond Position:  [-5.02011529]


portfolio before change:  [18.72818041]
curr_Stock_Price:  95.20880903162075
curr_Factors:  [95.20880903]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281238]
Stock Position:  -0.03281237842790905
Bond Position:  [21.85220788]


portfolio before change:  [18.72782773]
curr_Stock_Price:  95.3028095366467
curr_Factors:  [95.30280954]
mat_Sqrt:  [[0.15]]
grads:  [-0.01429509]
Stock Position:  -0.014295091835347062
Bond Position:  [20.09019014]


portfolio before change:  [18.72019386]
curr_Stock_Price:  96.01251487588016
curr_Factors:  [96.01251488]
mat_Sqrt:  [[0.15]]
grads:  [0.11338337]
Stock Position:  0.11338336639766684
Bond Position:  [7.8339717]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.60172833]
Stock Price:  94.9590549755277
PL:  [18.60172833]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.01810560e-02]
 [ 3.63596246e-02]
 [-2.57105815e-03]
 [-6.88453067e-03]
 [-5.39275647e-03]
 [ 3.25417126e-02]
 [ 3.74592729e-03]
 [ 1.25291379e-02]
 [ 1.26578771e-02]
 [ 2.28647686e-02]
 [ 1.80374025e-02]
 [-1.57758343e-03]
 [ 7.95358964e-03]
 [ 2.33778143e-02]
 [-1.26695774e-02]
 [-3.70352423e-03]
 [-6.00280284e-03]
 [ 6.96642383e-03]
 [ 1.16519018e-02]
 [ 1.71829570e-02]
 [-2.25408839e-03]
 [-4.25397886e-03]
 [ 3.96595755e-03]
 [-1.24553784e-02]
 [-2.49247924e-03]
 [ 4.54512768e-03]
 [ 5.66232887e-03]
 [ 1.47249912e-03]
 [ 5.26735881e-03]
 [-5.48147357e-03]
 [-1.86125209e-02]
 [ 7.76688472e-03]
 [ 7.64383307e-04]
 [ 3.00389707e-03]
 [-2.02047859e-02]
 [ 6.80358511e-03]
 [ 4.39999342e-03]
 [ 1.97482893e-02]
 [ 9.34361727e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39494483]
curr_Stock_Price:  99.93206395895888
curr_Factors:  [99.93206396]
mat_Sqrt:  [[0.15]]
grads:  [0.13454037]
Stock Position:  0.13454037336812888
Bond Position:  [-13.04995236]


portfolio before change:  [0.36901983]
curr_Stock_Price:  99.7514961951385
curr_Factors:  [99.7514962]
mat_Sqrt:  [[0.15]]
grads:  [0.2423975]
Stock Position:  0.24239749741258843
Bond Position:  [-23.81049321]


portfolio before change:  [0.52284646]
curr_Stock_Price:  100.39838044408592
curr_Factors:  [100.39838044]
mat_Sqrt:  [[0.15]]
grads:  [-0.01714039]
Stock Position:  -0.017140387649880903
Bond Position:  [2.24371362]


portfolio before change:  [0.53489297]
curr_Stock_Price:  99.71192965931263
curr_Factors:  [99.71192966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04589687]
Stock Position:  -0.04589687110507152
Bond Position:  [5.11135856]


portfolio before change:  [0.49249112]
curr_Stock_Price:  100.64970194825027
curr_Factors:  [100.64970195]
mat_Sqrt:  [[0.15]]
grads:  [-0.03595171]
Stock Position:  -0.0359517097919202
Bond Position:  [4.11101999]


portfolio before change:  [0.49532559]
curr_Stock_Price:  100.58515521809134
curr_Factors:  [100.58515522]
mat_Sqrt:  [[0.15]]
grads:  [0.21694475]
Stock Position:  0.2169447507572774
Bond Position:  [-21.32609584]


portfolio before change:  [0.56792973]
curr_Stock_Price:  100.93211020716792
curr_Factors:  [100.93211021]
mat_Sqrt:  [[0.15]]
grads:  [0.02497285]
Stock Position:  0.024972848591268037
Bond Position:  [-1.95263258]


portfolio before change:  [0.58713924]
curr_Stock_Price:  101.71110043061381
curr_Factors:  [101.71110043]
mat_Sqrt:  [[0.15]]
grads:  [0.08352759]
Stock Position:  0.08352758592431259
Bond Position:  [-7.90854344]


portfolio before change:  [0.66611988]
curr_Stock_Price:  102.668499962742
curr_Factors:  [102.66849996]
mat_Sqrt:  [[0.15]]
grads:  [0.08438585]
Stock Position:  0.08438584730709373
Bond Position:  [-7.99764848]


portfolio before change:  [0.6361389]
curr_Stock_Price:  102.3250630996684
curr_Factors:  [102.3250631]
mat_Sqrt:  [[0.15]]
grads:  [0.15243179]
Stock Position:  0.15243179097856469
Bond Position:  [-14.96145373]


portfolio before change:  [0.66737597]
curr_Stock_Price:  102.54225774402428
curr_Factors:  [102.54225774]
mat_Sqrt:  [[0.15]]
grads:  [0.12024935]
Stock Position:  0.12024935010316161
Bond Position:  [-11.66326388]


portfolio before change:  [0.74723075]
curr_Stock_Price:  103.21845912760709
curr_Factors:  [103.21845913]
mat_Sqrt:  [[0.15]]
grads:  [-0.01051722]
Stock Position:  -0.010517222878526286
Bond Position:  [1.83280229]


portfolio before change:  [0.75129849]
curr_Stock_Price:  102.85347476256096
curr_Factors:  [102.85347476]
mat_Sqrt:  [[0.15]]
grads:  [0.05302393]
Stock Position:  0.05302393093808768
Bond Position:  [-4.70239706]


portfolio before change:  [0.75760223]
curr_Stock_Price:  102.98344591198189
curr_Factors:  [102.98344591]
mat_Sqrt:  [[0.15]]
grads:  [0.1558521]
Stock Position:  0.15585209526518215
Bond Position:  [-15.29258359]


portfolio before change:  [0.5723505]
curr_Stock_Price:  101.80707391587815
curr_Factors:  [101.80707392]
mat_Sqrt:  [[0.15]]
grads:  [-0.08446385]
Stock Position:  -0.08446384920242146
Bond Position:  [9.17136784]


portfolio before change:  [0.62790136]
curr_Stock_Price:  101.16295970193582
curr_Factors:  [101.1629597]
mat_Sqrt:  [[0.15]]
grads:  [-0.02469016]
Stock Position:  -0.02469016156370084
Bond Position:  [3.12563118]


portfolio before change:  [0.63318256]
curr_Stock_Price:  100.96488572849046
curr_Factors:  [100.96488573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04001869]
Stock Position:  -0.04001868560338604
Bond Position:  [4.67366458]


portfolio before change:  [0.59820559]
curr_Stock_Price:  101.85350102483284
curr_Factors:  [101.85350102]
mat_Sqrt:  [[0.15]]
grads:  [0.04644283]
Stock Position:  0.04644282551539014
Bond Position:  [-4.13215878]


portfolio before change:  [0.59094135]
curr_Stock_Price:  101.70821072597542
curr_Factors:  [101.70821073]
mat_Sqrt:  [[0.15]]
grads:  [0.07767935]
Stock Position:  0.0776793452136288
Bond Position:  [-7.30968586]


portfolio before change:  [0.65794485]
curr_Stock_Price:  102.58253929113341
curr_Factors:  [102.58253929]
mat_Sqrt:  [[0.15]]
grads:  [0.11455305]
Stock Position:  0.11455304666379731
Bond Position:  [-11.09319756]


portfolio before change:  [0.58882335]
curr_Stock_Price:  101.99124326518806
curr_Factors:  [101.99124327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01502726]
Stock Position:  -0.015027255942312504
Bond Position:  [2.12147187]


portfolio before change:  [0.58077633]
curr_Stock_Price:  102.54438669203745
curr_Factors:  [102.54438669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02835986]
Stock Position:  -0.028359859035255536
Bond Position:  [3.48892068]


portfolio before change:  [0.56998235]
curr_Stock_Price:  102.94037319352991
curr_Factors:  [102.94037319]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [-2.15173199]


portfolio before change:  [0.5544987]
curr_Stock_Price:  102.36492585659363
curr_Factors:  [102.36492586]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303586]
Stock Position:  -0.08303585608852569
Bond Position:  [9.05445795]


portfolio before change:  [0.42310516]
curr_Stock_Price:  103.96092814920559
curr_Factors:  [103.96092815]
mat_Sqrt:  [[0.15]]
grads:  [-0.01661653]
Stock Position:  -0.01661652827973675
Bond Position:  [2.15057486]


portfolio before change:  [0.41061134]
curr_Stock_Price:  104.72899799489022
curr_Factors:  [104.72899799]
mat_Sqrt:  [[0.15]]
grads:  [0.03030085]
Stock Position:  0.030300851193672818
Bond Position:  [-2.76276644]


portfolio before change:  [0.39473778]
curr_Stock_Price:  104.21653053200998
curr_Factors:  [104.21653053]
mat_Sqrt:  [[0.15]]
grads:  [0.03774886]
Stock Position:  0.03774885911549237
Bond Position:  [-3.53931735]


portfolio before change:  [0.3716157]
curr_Stock_Price:  103.61572730635656
curr_Factors:  [103.61572731]
mat_Sqrt:  [[0.15]]
grads:  [0.00981666]
Stock Position:  0.009816660818800366
Bond Position:  [-0.64554475]


portfolio before change:  [0.38032049]
curr_Stock_Price:  104.51068462331614
curr_Factors:  [104.51068462]
mat_Sqrt:  [[0.15]]
grads:  [0.03511573]
Stock Position:  0.03511572537797961
Bond Position:  [-3.28964801]


portfolio before change:  [0.35077886]
curr_Stock_Price:  103.6811303286462
curr_Factors:  [103.68113033]
mat_Sqrt:  [[0.15]]
grads:  [-0.03654316]
Stock Position:  -0.036543157120879244
Bond Position:  [4.1396147]


portfolio before change:  [0.37847377]
curr_Stock_Price:  102.93742274281954
curr_Factors:  [102.93742274]
mat_Sqrt:  [[0.15]]
grads:  [-0.12408347]
Stock Position:  -0.12408347288085089
Bond Position:  [13.15130667]


portfolio before change:  [0.34267178]
curr_Stock_Price:  103.23920348415513
curr_Factors:  [103.23920348]
mat_Sqrt:  [[0.15]]
grads:  [0.05177923]
Stock Position:  0.05177923149008091
Bond Position:  [-5.00297484]


portfolio before change:  [0.37243405]
curr_Stock_Price:  103.82607358474039
curr_Factors:  [103.82607358]
mat_Sqrt:  [[0.15]]
grads:  [0.00509589]
Stock Position:  0.005095888714903892
Bond Position:  [-0.15665206]


portfolio before change:  [0.37427856]
curr_Stock_Price:  104.1918773503627
curr_Factors:  [104.19187735]
mat_Sqrt:  [[0.15]]
grads:  [0.02002598]
Stock Position:  0.020025980449573218
Bond Position:  [-1.71226593]


portfolio before change:  [0.38069981]
curr_Stock_Price:  104.52321135311378
curr_Factors:  [104.52321135]
mat_Sqrt:  [[0.15]]
grads:  [-0.13469857]
Stock Position:  -0.13469857287003828
Bond Position:  [14.45982721]


portfolio before change:  [0.43351229]
curr_Stock_Price:  104.14455187937035
curr_Factors:  [104.14455188]
mat_Sqrt:  [[0.15]]
grads:  [0.04535723]
Stock Position:  0.04535723404353443
Bond Position:  [-4.29019653]


portfolio before change:  [0.41811118]
curr_Stock_Price:  103.81682464282514
curr_Factors:  [103.81682464]
mat_Sqrt:  [[0.15]]
grads:  [0.02933329]
Stock Position:  0.029333289480549113
Bond Position:  [-2.62717779]


portfolio before change:  [0.38840862]
curr_Stock_Price:  102.81543191330563
curr_Factors:  [102.81543191]
mat_Sqrt:  [[0.15]]
grads:  [0.13165526]
Stock Position:  0.13165526190870092
Bond Position:  [-13.147784]


portfolio before change:  [0.288494]
curr_Stock_Price:  102.06900493523555
curr_Factors:  [102.06900494]
mat_Sqrt:  [[0.15]]
grads:  [0.06229078]
Stock Position:  0.062290781771024775
Bond Position:  [-6.06946411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.28309535]
Stock Price:  101.9945168641939
PL:  [-1.71142151]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.85866952e-02]
 [ 3.09902409e-02]
 [-3.55400869e-03]
 [-2.30382156e-03]
 [-4.08869473e-03]
 [ 3.30205284e-02]
 [ 3.66916311e-03]
 [ 3.32200795e-03]
 [-2.76767163e-02]
 [ 2.34413542e-02]
 [ 2.11604837e-02]
 [-1.26707152e-02]
 [-8.36151266e-04]
 [ 7.82149063e-03]
 [-1.72197826e-02]
 [ 7.05168631e-04]
 [-6.03239211e-03]
 [ 2.96582002e-03]
 [ 4.34846372e-03]
 [-3.06196747e-02]
 [-6.49492336e-03]
 [-1.54730023e-02]
 [ 6.39464276e-03]
 [-8.68543067e-03]
 [ 1.35646699e-02]
 [ 7.35880834e-03]
 [-1.38959350e-03]
 [-2.99245327e-03]
 [-1.62882773e-02]
 [-1.31391223e-02]
 [ 4.10794681e-02]
 [ 3.06644805e-03]
 [-1.87873525e-02]
 [-3.29740777e-02]
 [-2.33819229e-02]
 [ 3.75861396e-02]
 [-1.15956632e-03]
 [ 4.88627728e-04]
 [ 1.42836762e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.58617656]
curr_Stock_Price:  101.5348856096443
curr_Factors:  [101.53488561]
mat_Sqrt:  [[0.15]]
grads:  [-0.39057797]
Stock Position:  -0.39057796775047227
Bond Position:  [75.24346583]


portfolio before change:  [35.89516282]
curr_Stock_Price:  100.76786784915465
curr_Factors:  [100.76786785]
mat_Sqrt:  [[0.15]]
grads:  [0.20660161]
Stock Position:  0.20660160600181982
Bond Position:  [15.07635949]


portfolio before change:  [35.86300054]
curr_Stock_Price:  100.6030727346123
curr_Factors:  [100.60307273]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369339]
Stock Position:  -0.0236933912759005
Bond Position:  [38.24662851]


portfolio before change:  [35.8584099]
curr_Stock_Price:  100.99861626462263
curr_Factors:  [100.99861626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535881]
Stock Position:  -0.015358810396081056
Bond Position:  [37.4096285]


portfolio before change:  [35.86503617]
curr_Stock_Price:  100.87166829683014
curr_Factors:  [100.8716683]
mat_Sqrt:  [[0.15]]
grads:  [-0.02725796]
Stock Position:  -0.027257964896402524
Bond Position:  [38.61459256]


portfolio before change:  [35.87588326]
curr_Stock_Price:  100.65081689447483
curr_Factors:  [100.65081689]
mat_Sqrt:  [[0.15]]
grads:  [0.22013686]
Stock Position:  0.2201368557742643
Bond Position:  [13.71892889]


portfolio before change:  [35.753479]
curr_Stock_Price:  100.08698933851862
curr_Factors:  [100.08698934]
mat_Sqrt:  [[0.15]]
grads:  [0.02446109]
Stock Position:  0.024461087404375838
Bond Position:  [33.30524241]


portfolio before change:  [35.75560958]
curr_Stock_Price:  100.00388442043355
curr_Factors:  [100.00388442]
mat_Sqrt:  [[0.15]]
grads:  [0.02214672]
Stock Position:  0.02214671963579648
Bond Position:  [33.54085159]


portfolio before change:  [35.74905272]
curr_Stock_Price:  99.51849753062754
curr_Factors:  [99.51849753]
mat_Sqrt:  [[0.15]]
grads:  [-0.18451144]
Stock Position:  -0.1845114418367026
Bond Position:  [54.11135419]


portfolio before change:  [35.96079575]
curr_Stock_Price:  98.40757086887061
curr_Factors:  [98.40757087]
mat_Sqrt:  [[0.15]]
grads:  [0.15627569]
Stock Position:  0.15627569495429425
Bond Position:  [20.58208422]


portfolio before change:  [35.87567122]
curr_Stock_Price:  97.84639951058402
curr_Factors:  [97.84639951]
mat_Sqrt:  [[0.15]]
grads:  [0.14106989]
Stock Position:  0.1410698912069283
Bond Position:  [22.07249029]


portfolio before change:  [35.9781565]
curr_Stock_Price:  98.55332601669443
curr_Factors:  [98.55332602]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447143]
Stock Position:  -0.0844714343345402
Bond Position:  [44.30309731]


portfolio before change:  [36.01333033]
curr_Stock_Price:  98.20249036162909
curr_Factors:  [98.20249036]
mat_Sqrt:  [[0.15]]
grads:  [-0.00557434]
Stock Position:  -0.005574341771521765
Bond Position:  [36.56074457]


portfolio before change:  [36.01883355]
curr_Stock_Price:  98.03514432534273
curr_Factors:  [98.03514433]
mat_Sqrt:  [[0.15]]
grads:  [0.05214327]
Stock Position:  0.05214327085558089
Bond Position:  [30.90696046]


portfolio before change:  [35.99497878]
curr_Stock_Price:  97.50356317638072
curr_Factors:  [97.50356318]
mat_Sqrt:  [[0.15]]
grads:  [-0.11479855]
Stock Position:  -0.11479855082750774
Bond Position:  [47.18824653]


portfolio before change:  [35.95296615]
curr_Stock_Price:  97.92091622432218
curr_Factors:  [97.92091622]
mat_Sqrt:  [[0.15]]
grads:  [0.00470112]
Stock Position:  0.004701124206704007
Bond Position:  [35.49262777]


portfolio before change:  [35.95908724]
curr_Stock_Price:  98.27917648941664
curr_Factors:  [98.27917649]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021595]
Stock Position:  -0.040215947413262045
Bond Position:  [39.91147743]


portfolio before change:  [35.96816013]
curr_Stock_Price:  98.17763344559796
curr_Factors:  [98.17763345]
mat_Sqrt:  [[0.15]]
grads:  [0.01977213]
Stock Position:  0.019772133448143204
Bond Position:  [34.02697886]


portfolio before change:  [35.97192885]
curr_Stock_Price:  98.15310780140335
curr_Factors:  [98.1531078]
mat_Sqrt:  [[0.15]]
grads:  [0.02898976]
Stock Position:  0.028989758116176927
Bond Position:  [33.12649399]


portfolio before change:  [35.97419211]
curr_Stock_Price:  98.08833304186024
curr_Factors:  [98.08833304]
mat_Sqrt:  [[0.15]]
grads:  [-0.20413116]
Stock Position:  -0.20413116453667027
Bond Position:  [55.99707776]


portfolio before change:  [36.1264074]
curr_Stock_Price:  97.37695113091543
curr_Factors:  [97.37695113]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329949]
Stock Position:  -0.04329948905380376
Bond Position:  [40.34277963]


portfolio before change:  [36.11520671]
curr_Stock_Price:  97.75210222782863
curr_Factors:  [97.75210223]
mat_Sqrt:  [[0.15]]
grads:  [-0.10315335]
Stock Position:  -0.10315334852344527
Bond Position:  [46.19866338]


portfolio before change:  [36.14356898]
curr_Stock_Price:  97.53313629497312
curr_Factors:  [97.53313629]
mat_Sqrt:  [[0.15]]
grads:  [0.04263095]
Stock Position:  0.04263095174570313
Bond Position:  [31.98563855]


portfolio before change:  [36.14445524]
curr_Stock_Price:  97.46013306831337
curr_Factors:  [97.46013307]
mat_Sqrt:  [[0.15]]
grads:  [-0.05790287]
Stock Position:  -0.057902871154300296
Bond Position:  [41.78767676]


portfolio before change:  [36.129854]
curr_Stock_Price:  97.80251707603308
curr_Factors:  [97.80251708]
mat_Sqrt:  [[0.15]]
grads:  [0.09043113]
Stock Position:  0.09043113241332862
Bond Position:  [27.28546163]


portfolio before change:  [36.21504017]
curr_Stock_Price:  98.70679935484922
curr_Factors:  [98.70679935]
mat_Sqrt:  [[0.15]]
grads:  [0.04905872]
Stock Position:  0.049058722273987575
Bond Position:  [31.37261071]


portfolio before change:  [36.20900516]
curr_Stock_Price:  98.5038420113279
curr_Factors:  [98.50384201]
mat_Sqrt:  [[0.15]]
grads:  [-0.00926396]
Stock Position:  -0.00926395668127034
Bond Position:  [37.12154049]


portfolio before change:  [36.21426867]
curr_Stock_Price:  98.43658954749975
curr_Factors:  [98.43658955]
mat_Sqrt:  [[0.15]]
grads:  [-0.01994969]
Stock Position:  -0.019949688440766562
Bond Position:  [38.17804796]


portfolio before change:  [36.24196211]
curr_Stock_Price:  97.28765512597069
curr_Factors:  [97.28765513]
mat_Sqrt:  [[0.15]]
grads:  [-0.10858852]
Stock Position:  -0.1085885155039885
Bond Position:  [46.80628416]


portfolio before change:  [36.25957028]
curr_Stock_Price:  97.17938383016806
curr_Factors:  [97.17938383]
mat_Sqrt:  [[0.15]]
grads:  [-0.08759415]
Stock Position:  -0.08759414881114465
Bond Position:  [44.77191569]


portfolio before change:  [36.35714704]
curr_Stock_Price:  96.12931460161309
curr_Factors:  [96.1293146]
mat_Sqrt:  [[0.15]]
grads:  [0.27386312]
Stock Position:  0.27386312090844056
Bond Position:  [10.03087293]


portfolio before change:  [36.3071488]
curr_Stock_Price:  95.94216936511219
curr_Factors:  [95.94216937]
mat_Sqrt:  [[0.15]]
grads:  [0.02044299]
Stock Position:  0.020442986986336575
Bond Position:  [34.34580428]


portfolio before change:  [36.30041696]
curr_Stock_Price:  95.40284850276026
curr_Factors:  [95.4028485]
mat_Sqrt:  [[0.15]]
grads:  [-0.12524902]
Stock Position:  -0.1252490163578796
Bond Position:  [48.24952989]


portfolio before change:  [36.31022428]
curr_Stock_Price:  95.37270254301625
curr_Factors:  [95.37270254]
mat_Sqrt:  [[0.15]]
grads:  [-0.21982718]
Stock Position:  -0.21982718490326317
Bond Position:  [57.275737]


portfolio before change:  [36.34306231]
curr_Stock_Price:  95.2558921081911
curr_Factors:  [95.25589211]
mat_Sqrt:  [[0.15]]
grads:  [-0.15587949]
Stock Position:  -0.15587948567384058
Bond Position:  [51.19150177]


portfolio before change:  [36.25117729]
curr_Stock_Price:  95.88640713218113
curr_Factors:  [95.88640713]
mat_Sqrt:  [[0.15]]
grads:  [0.25057426]
Stock Position:  0.25057426381678094
Bond Position:  [12.22451141]


portfolio before change:  [36.47121538]
curr_Stock_Price:  96.75844373995201
curr_Factors:  [96.75844374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00773044]
Stock Position:  -0.007730442127442981
Bond Position:  [37.21920093]


portfolio before change:  [36.48169276]
curr_Stock_Price:  96.00496856855177
curr_Factors:  [96.00496857]
mat_Sqrt:  [[0.15]]
grads:  [0.00325752]
Stock Position:  0.00325751818989143
Bond Position:  [36.16895483]


portfolio before change:  [36.48764761]
curr_Stock_Price:  96.4450116847479
curr_Factors:  [96.44501168]
mat_Sqrt:  [[0.15]]
grads:  [0.09522451]
Stock Position:  0.09522450784445041
Bond Position:  [27.30371884]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.45127155]
Stock Price:  96.02716506696368
PL:  [36.45127155]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.36331858e-02]
 [ 1.48095822e-02]
 [-1.52852371e-02]
 [-7.33880889e-03]
 [-6.84503497e-03]
 [ 2.77608194e-02]
 [ 3.66401799e-03]
 [ 4.78549258e-03]
 [-2.71217404e-02]
 [ 2.33581525e-02]
 [ 1.93911456e-02]
 [-1.44416966e-02]
 [-1.19913900e-03]
 [ 6.57256635e-03]
 [-1.63935963e-02]
 [-1.52363800e-03]
 [-6.03502715e-03]
 [ 1.64844451e-03]
 [ 4.64281293e-03]
 [-2.25989091e-02]
 [-1.22670126e-02]
 [-1.94222365e-02]
 [ 6.51429311e-03]
 [-7.62538578e-03]
 [ 1.33826049e-02]
 [ 3.85539000e-03]
 [ 1.98738810e-02]
 [-3.93837059e-03]
 [-1.53710230e-02]
 [-1.31210304e-02]
 [ 3.51285252e-02]
 [ 6.56597804e-03]
 [-1.72958779e-02]
 [-4.20619148e-02]
 [-2.28747751e-02]
 [ 3.93785979e-02]
 [ 2.88592225e-03]
 [ 7.60349371e-03]
 [ 4.64309409e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.61249319]
curr_Stock_Price:  99.84063308342824
curr_Factors:  [99.84063308]
mat_Sqrt:  [[0.15]]
grads:  [0.09088791]
Stock Position:  0.09088790524980321
Bond Position:  [-10.68679919]


portfolio before change:  [-1.71243267]
curr_Stock_Price:  98.75574122892007
curr_Factors:  [98.75574123]
mat_Sqrt:  [[0.15]]
grads:  [0.09873055]
Stock Position:  0.09873054807952093
Bond Position:  [-11.46264113]


portfolio before change:  [-1.77809913]
curr_Stock_Price:  98.10514681824553
curr_Factors:  [98.10514682]
mat_Sqrt:  [[0.15]]
grads:  [-0.10190158]
Stock Position:  -0.10190158091536622
Bond Position:  [8.21897042]


portfolio before change:  [-1.83706334]
curr_Stock_Price:  98.69386824151579
curr_Factors:  [98.69386824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04892539]
Stock Position:  -0.04892539258610534
Bond Position:  [2.99157291]


portfolio before change:  [-1.86024065]
curr_Stock_Price:  99.17523942523695
curr_Factors:  [99.17523943]
mat_Sqrt:  [[0.15]]
grads:  [-0.04563357]
Stock Position:  -0.04563356648771997
Bond Position:  [2.66547924]


portfolio before change:  [-1.88389083]
curr_Stock_Price:  99.70080412623584
curr_Factors:  [99.70080413]
mat_Sqrt:  [[0.15]]
grads:  [0.18507213]
Stock Position:  0.18507212942362036
Bond Position:  [-20.33573096]


portfolio before change:  [-1.82029637]
curr_Stock_Price:  100.05815986139842
curr_Factors:  [100.05815986]
mat_Sqrt:  [[0.15]]
grads:  [0.02442679]
Stock Position:  0.02442678658843996
Bond Position:  [-4.26439569]


portfolio before change:  [-1.80924283]
curr_Stock_Price:  100.53250085828482
curr_Factors:  [100.53250086]
mat_Sqrt:  [[0.15]]
grads:  [0.03190328]
Stock Position:  0.031903283877748136
Bond Position:  [-5.01655974]


portfolio before change:  [-1.82758931]
curr_Stock_Price:  99.97709190768994
curr_Factors:  [99.97709191]
mat_Sqrt:  [[0.15]]
grads:  [-0.1808116]
Stock Position:  -0.18081160246647848
Bond Position:  [16.24942889]


portfolio before change:  [-1.92101343]
curr_Stock_Price:  100.50501948966013
curr_Factors:  [100.50501949]
mat_Sqrt:  [[0.15]]
grads:  [0.15572102]
Stock Position:  0.15572101691096082
Bond Position:  [-17.57175727]


portfolio before change:  [-2.0479399]
curr_Stock_Price:  99.70403669342191
curr_Factors:  [99.70403669]
mat_Sqrt:  [[0.15]]
grads:  [0.1292743]
Stock Position:  0.12927430402957563
Bond Position:  [-14.93710985]


portfolio before change:  [-2.00519476]
curr_Stock_Price:  100.04913534826382
curr_Factors:  [100.04913535]
mat_Sqrt:  [[0.15]]
grads:  [-0.09627798]
Stock Position:  -0.09627797755006806
Bond Position:  [7.62733364]


portfolio before change:  [-1.82326677]
curr_Stock_Price:  98.1694270522812
curr_Factors:  [98.16942705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00799426]
Stock Position:  -0.007994260010000647
Bond Position:  [-1.03847485]


portfolio before change:  [-1.82654415]
curr_Stock_Price:  98.56315439365628
curr_Factors:  [98.56315439]
mat_Sqrt:  [[0.15]]
grads:  [0.04381711]
Stock Position:  0.04381710900844824
Bond Position:  [-6.14529663]


portfolio before change:  [-1.85339101]
curr_Stock_Price:  97.96798382410762
curr_Factors:  [97.96798382]
mat_Sqrt:  [[0.15]]
grads:  [-0.10929064]
Stock Position:  -0.10929064221887892
Bond Position:  [8.85359286]


portfolio before change:  [-1.9978352]
curr_Stock_Price:  99.29976261487425
curr_Factors:  [99.29976261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015759]
Stock Position:  -0.010157586643823342
Bond Position:  [-0.98918926]


portfolio before change:  [-1.98740497]
curr_Stock_Price:  98.26074674279127
curr_Factors:  [98.26074674]
mat_Sqrt:  [[0.15]]
grads:  [-0.04023351]
Stock Position:  -0.04023351436574998
Bond Position:  [1.9659702]


portfolio before change:  [-1.96117976]
curr_Stock_Price:  97.61503011811227
curr_Factors:  [97.61503012]
mat_Sqrt:  [[0.15]]
grads:  [0.01098963]
Stock Position:  0.010989630036681557
Bond Position:  [-3.03393282]


portfolio before change:  [-1.95464492]
curr_Stock_Price:  98.2441782768268
curr_Factors:  [98.24417828]
mat_Sqrt:  [[0.15]]
grads:  [0.03095209]
Stock Position:  0.03095208620803959
Bond Position:  [-4.99550719]


portfolio before change:  [-1.98274641]
curr_Stock_Price:  97.35645084964219
curr_Factors:  [97.35645085]
mat_Sqrt:  [[0.15]]
grads:  [-0.15065939]
Stock Position:  -0.1506593937952971
Bond Position:  [12.68491746]


portfolio before change:  [-1.78148776]
curr_Stock_Price:  96.03112405789676
curr_Factors:  [96.03112406]
mat_Sqrt:  [[0.15]]
grads:  [-0.08178008]
Stock Position:  -0.08178008376861316
Bond Position:  [6.07194561]


portfolio before change:  [-1.839898]
curr_Stock_Price:  96.75464097471065
curr_Factors:  [96.75464097]
mat_Sqrt:  [[0.15]]
grads:  [-0.12948158]
Stock Position:  -0.12948157676479036
Bond Position:  [10.68804547]


portfolio before change:  [-1.96064886]
curr_Stock_Price:  97.69753146612275
curr_Factors:  [97.69753147]
mat_Sqrt:  [[0.15]]
grads:  [0.04342862]
Stock Position:  0.04342862072447618
Bond Position:  [-6.2035179]


portfolio before change:  [-1.95003536]
curr_Stock_Price:  97.95977749547815
curr_Factors:  [97.9597775]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083591]
Stock Position:  -0.050835905228170775
Bond Position:  [3.0298386]


portfolio before change:  [-1.93566395]
curr_Stock_Price:  97.68452607538858
curr_Factors:  [97.68452608]
mat_Sqrt:  [[0.15]]
grads:  [0.08921737]
Stock Position:  0.08921736613625743
Bond Position:  [-10.65082008]


portfolio before change:  [-1.98320843]
curr_Stock_Price:  97.16654353828804
curr_Factors:  [97.16654354]
mat_Sqrt:  [[0.15]]
grads:  [0.0257026]
Stock Position:  0.025702599972979644
Bond Position:  [-4.48064123]


portfolio before change:  [-2.0079134]
curr_Stock_Price:  96.22714989398887
curr_Factors:  [96.22714989]
mat_Sqrt:  [[0.15]]
grads:  [0.13249254]
Stock Position:  0.1324925399067072
Bond Position:  [-14.7572929]


portfolio before change:  [-1.92927128]
curr_Stock_Price:  96.83463237917212
curr_Factors:  [96.83463238]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262558]
Stock Position:  -0.026255803946618844
Bond Position:  [0.61319984]


portfolio before change:  [-1.94446484]
curr_Stock_Price:  97.41622627598358
curr_Factors:  [97.41622628]
mat_Sqrt:  [[0.15]]
grads:  [-0.10247349]
Stock Position:  -0.102473486587742
Bond Position:  [8.03811552]


portfolio before change:  [-1.91822084]
curr_Stock_Price:  97.16992677329148
curr_Factors:  [97.16992677]
mat_Sqrt:  [[0.15]]
grads:  [-0.08747354]
Stock Position:  -0.08747353611869284
Bond Position:  [6.58157626]


portfolio before change:  [-1.9094214]
curr_Stock_Price:  97.07873696009668
curr_Factors:  [97.07873696]
mat_Sqrt:  [[0.15]]
grads:  [0.23419017]
Stock Position:  0.23419016792925185
Bond Position:  [-24.64430711]


portfolio before change:  [-1.91180332]
curr_Stock_Price:  97.08172090554056
curr_Factors:  [97.08172091]
mat_Sqrt:  [[0.15]]
grads:  [0.04377319]
Stock Position:  0.04377318691805441
Bond Position:  [-6.16137964]


portfolio before change:  [-1.96366353]
curr_Stock_Price:  95.91456826910397
curr_Factors:  [95.91456827]
mat_Sqrt:  [[0.15]]
grads:  [-0.11530585]
Stock Position:  -0.1153058529768825
Bond Position:  [9.09584758]


portfolio before change:  [-2.00702963]
curr_Stock_Price:  96.30052567610721
curr_Factors:  [96.30052568]
mat_Sqrt:  [[0.15]]
grads:  [-0.28041277]
Stock Position:  -0.2804127653284817
Bond Position:  [24.99686708]


portfolio before change:  [-2.12604055]
curr_Stock_Price:  96.73608260388082
curr_Factors:  [96.7360826]
mat_Sqrt:  [[0.15]]
grads:  [-0.1524985]
Stock Position:  -0.15249850042093072
Bond Position:  [12.62606699]


portfolio before change:  [-2.19682172]
curr_Stock_Price:  97.210575971408
curr_Factors:  [97.21057597]
mat_Sqrt:  [[0.15]]
grads:  [0.26252399]
Stock Position:  0.26252398569191066
Bond Position:  [-27.71692957]


portfolio before change:  [-1.90569731]
curr_Stock_Price:  98.33271817473039
curr_Factors:  [98.33271817]
mat_Sqrt:  [[0.15]]
grads:  [0.01923948]
Stock Position:  0.019239481696929444
Bond Position:  [-3.79756784]


portfolio before change:  [-1.89645698]
curr_Stock_Price:  98.8376721093155
curr_Factors:  [98.83767211]
mat_Sqrt:  [[0.15]]
grads:  [0.05068996]
Stock Position:  0.0506899580641726
Bond Position:  [-6.90653443]


portfolio before change:  [-1.89879753]
curr_Stock_Price:  98.80853067505544
curr_Factors:  [98.80853068]
mat_Sqrt:  [[0.15]]
grads:  [0.03095396]
Stock Position:  0.030953960585824055
Bond Position:  [-4.95731289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.91791421]
Stock Price:  98.21096651131057
PL:  [-1.91791421]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.53657707e-02]
 [ 3.18429538e-02]
 [-2.57006074e-03]
 [-6.82585407e-03]
 [-7.57614566e-03]
 [ 2.80724837e-02]
 [ 3.61787823e-03]
 [-1.22714702e-03]
 [-2.75039334e-02]
 [ 2.34405941e-02]
 [ 2.07039118e-02]
 [-1.45028248e-02]
 [ 2.03448440e-02]
 [ 6.50013991e-03]
 [-1.62979635e-02]
 [ 4.04939366e-04]
 [-6.09539981e-03]
 [ 3.93124204e-03]
 [ 1.07677123e-02]
 [ 1.65085715e-02]
 [-9.74354094e-04]
 [-5.29669056e-03]
 [ 4.31218040e-03]
 [-1.06522929e-02]
 [ 5.62853902e-03]
 [ 6.95660861e-03]
 [-6.79677759e-03]
 [-2.85852372e-03]
 [ 3.64073809e-04]
 [-1.38464128e-02]
 [-1.04872540e-02]
 [ 1.56560785e-02]
 [-6.24641980e-03]
 [-1.79731990e-02]
 [-2.13617959e-02]
 [ 2.90536831e-02]
 [ 2.83390285e-03]
 [ 7.12099945e-03]
 [ 4.99779402e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.14176594]
curr_Stock_Price:  98.86005971905689
curr_Factors:  [98.86005972]
mat_Sqrt:  [[0.15]]
grads:  [0.10243847]
Stock Position:  0.10243847106052795
Bond Position:  [-33.26883931]


portfolio before change:  [-23.0860892]
curr_Stock_Price:  99.44417236379968
curr_Factors:  [99.44417236]
mat_Sqrt:  [[0.15]]
grads:  [0.21228636]
Stock Position:  0.21228635840602222
Bond Position:  [-44.19673042]


portfolio before change:  [-22.92551795]
curr_Stock_Price:  100.22658807705932
curr_Factors:  [100.22658808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713374]
Stock Position:  -0.017133738281736532
Bond Position:  [-21.20826183]


portfolio before change:  [-22.91495956]
curr_Stock_Price:  99.45561830877479
curr_Factors:  [99.45561831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04550569]
Stock Position:  -0.04550569379241091
Bond Position:  [-18.38916265]


portfolio before change:  [-22.91934029]
curr_Stock_Price:  99.50136961183672
curr_Factors:  [99.50136961]
mat_Sqrt:  [[0.15]]
grads:  [-0.05050764]
Stock Position:  -0.0505076377198084
Bond Position:  [-17.89376116]


portfolio before change:  [-22.9162676]
curr_Stock_Price:  99.39624579900811
curr_Factors:  [99.3962458]
mat_Sqrt:  [[0.15]]
grads:  [0.18714989]
Stock Position:  0.1871498915654407
Bond Position:  [-41.51826422]


portfolio before change:  [-22.83972367]
curr_Stock_Price:  99.8329761106982
curr_Factors:  [99.83297611]
mat_Sqrt:  [[0.15]]
grads:  [0.02411919]
Stock Position:  0.024119188176422997
Bond Position:  [-25.24761401]


portfolio before change:  [-22.86013782]
curr_Stock_Price:  99.11744613515154
curr_Factors:  [99.11744614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818098]
Stock Position:  -0.00818098015648003
Bond Position:  [-22.04925996]


portfolio before change:  [-22.86308522]
curr_Stock_Price:  99.14080131485434
curr_Factors:  [99.14080131]
mat_Sqrt:  [[0.15]]
grads:  [-0.18335956]
Stock Position:  -0.1833595558448124
Bond Position:  [-4.68467193]


portfolio before change:  [-22.77349962]
curr_Stock_Price:  98.64902863245625
curr_Factors:  [98.64902863]
mat_Sqrt:  [[0.15]]
grads:  [0.15627063]
Stock Position:  0.1562706275148337
Bond Position:  [-38.18944523]


portfolio before change:  [-22.78528418]
curr_Stock_Price:  98.60416682281709
curr_Factors:  [98.60416682]
mat_Sqrt:  [[0.15]]
grads:  [0.13802608]
Stock Position:  0.13802607867005806
Bond Position:  [-36.39523067]


portfolio before change:  [-22.71645026]
curr_Stock_Price:  99.13583168118326
curr_Factors:  [99.13583168]
mat_Sqrt:  [[0.15]]
grads:  [-0.0966855]
Stock Position:  -0.09668549837243955
Bond Position:  [-13.13145296]


portfolio before change:  [-22.80138874]
curr_Stock_Price:  99.9973564203051
curr_Factors:  [99.99735642]
mat_Sqrt:  [[0.15]]
grads:  [0.13563229]
Stock Position:  0.13563229317330844
Bond Position:  [-36.3642595]


portfolio before change:  [-22.85199344]
curr_Stock_Price:  99.6577700284185
curr_Factors:  [99.65777003]
mat_Sqrt:  [[0.15]]
grads:  [0.04333427]
Stock Position:  0.04333426607010462
Bond Position:  [-27.17058976]


portfolio before change:  [-22.92628607]
curr_Stock_Price:  98.0217415042574
curr_Factors:  [98.0217415]
mat_Sqrt:  [[0.15]]
grads:  [-0.10865309]
Stock Position:  -0.10865309005420846
Bond Position:  [-12.27592096]


portfolio before change:  [-22.98312598]
curr_Stock_Price:  98.53074982644202
curr_Factors:  [98.53074983]
mat_Sqrt:  [[0.15]]
grads:  [0.0026996]
Stock Position:  0.0026995957712101348
Bond Position:  [-23.24911918]


portfolio before change:  [-22.9841191]
curr_Stock_Price:  99.23944893891992
curr_Factors:  [99.23944894]
mat_Sqrt:  [[0.15]]
grads:  [-0.040636]
Stock Position:  -0.04063599873917235
Bond Position:  [-18.95142498]


portfolio before change:  [-22.97932429]
curr_Stock_Price:  99.06315473531875
curr_Factors:  [99.06315474]
mat_Sqrt:  [[0.15]]
grads:  [0.02620828]
Stock Position:  0.026208280272983237
Bond Position:  [-25.57559921]


portfolio before change:  [-22.91724031]
curr_Stock_Price:  101.55401359780292
curr_Factors:  [101.5540136]
mat_Sqrt:  [[0.15]]
grads:  [0.07178475]
Stock Position:  0.07178474856180538
Bond Position:  [-30.20726964]


portfolio before change:  [-22.88890039]
curr_Stock_Price:  102.00140754849971
curr_Factors:  [102.00140755]
mat_Sqrt:  [[0.15]]
grads:  [0.11005714]
Stock Position:  0.11005714319249021
Bond Position:  [-34.11488391]


portfolio before change:  [-22.82449241]
curr_Stock_Price:  102.62537983543258
curr_Factors:  [102.62537984]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649569]
Stock Position:  -0.0064956939597999004
Bond Position:  [-22.15786935]


portfolio before change:  [-22.81900131]
curr_Stock_Price:  101.3536121787077
curr_Factors:  [101.35361218]
mat_Sqrt:  [[0.15]]
grads:  [-0.03531127]
Stock Position:  -0.03531127038274156
Bond Position:  [-19.2400765]


portfolio before change:  [-22.83820863]
curr_Stock_Price:  101.82944212215845
curr_Factors:  [101.82944212]
mat_Sqrt:  [[0.15]]
grads:  [0.02874787]
Stock Position:  0.028747869314769133
Bond Position:  [-25.76558812]


portfolio before change:  [-22.86502482]
curr_Stock_Price:  101.00867531785428
curr_Factors:  [101.00867532]
mat_Sqrt:  [[0.15]]
grads:  [-0.07101529]
Stock Position:  -0.07101528589707949
Bond Position:  [-15.69186487]


portfolio before change:  [-22.8792458]
curr_Stock_Price:  101.18130532864383
curr_Factors:  [101.18130533]
mat_Sqrt:  [[0.15]]
grads:  [0.03752359]
Stock Position:  0.037523593473104654
Bond Position:  [-26.67593197]


portfolio before change:  [-22.90040296]
curr_Stock_Price:  100.7063385938367
curr_Factors:  [100.70633859]
mat_Sqrt:  [[0.15]]
grads:  [0.04637739]
Stock Position:  0.04637739070552006
Bond Position:  [-27.57090017]


portfolio before change:  [-22.94846566]
curr_Stock_Price:  99.74431549078564
curr_Factors:  [99.74431549]
mat_Sqrt:  [[0.15]]
grads:  [-0.04531185]
Stock Position:  -0.045311850625210176
Bond Position:  [-18.42886613]


portfolio before change:  [-22.90357643]
curr_Stock_Price:  98.70280041289861
curr_Factors:  [98.70280041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01905682]
Stock Position:  -0.019056824794176152
Bond Position:  [-21.02261446]


portfolio before change:  [-22.92846027]
curr_Stock_Price:  99.87066793660699
curr_Factors:  [99.87066794]
mat_Sqrt:  [[0.15]]
grads:  [0.00242716]
Stock Position:  0.0024271587277868542
Bond Position:  [-23.17086223]


portfolio before change:  [-22.93331283]
curr_Stock_Price:  99.06477673561055
curr_Factors:  [99.06477674]
mat_Sqrt:  [[0.15]]
grads:  [-0.09230942]
Stock Position:  -0.09230941839714862
Bond Position:  [-13.78870091]


portfolio before change:  [-22.98007717]
curr_Stock_Price:  99.55270787374451
curr_Factors:  [99.55270787]
mat_Sqrt:  [[0.15]]
grads:  [-0.06991503]
Stock Position:  -0.06991502645364597
Bond Position:  [-16.01984696]


portfolio before change:  [-23.00324556]
curr_Stock_Price:  99.85544373785632
curr_Factors:  [99.85544374]
mat_Sqrt:  [[0.15]]
grads:  [0.10437386]
Stock Position:  0.10437385667528899
Bond Position:  [-33.42554333]


portfolio before change:  [-22.95527328]
curr_Stock_Price:  100.35509696762819
curr_Factors:  [100.35509697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0416428]
Stock Position:  -0.041642798647567016
Bond Position:  [-18.77620618]


portfolio before change:  [-22.99290616]
curr_Stock_Price:  101.20243937732266
curr_Factors:  [101.20243938]
mat_Sqrt:  [[0.15]]
grads:  [-0.11982133]
Stock Position:  -0.1198213264362018
Bond Position:  [-10.86669564]


portfolio before change:  [-22.8831747]
curr_Stock_Price:  100.27530989303928
curr_Factors:  [100.27530989]
mat_Sqrt:  [[0.15]]
grads:  [-0.14241197]
Stock Position:  -0.1424119727294379
Bond Position:  [-8.60277]


portfolio before change:  [-22.8421822]
curr_Stock_Price:  99.97991397257096
curr_Factors:  [99.97991397]
mat_Sqrt:  [[0.15]]
grads:  [0.19369122]
Stock Position:  0.19369122047984685
Bond Position:  [-42.20741376]


portfolio before change:  [-23.17042671]
curr_Stock_Price:  98.31247517578623
curr_Factors:  [98.31247518]
mat_Sqrt:  [[0.15]]
grads:  [0.01889269]
Stock Position:  0.018892685657154046
Bond Position:  [-25.0278134]


portfolio before change:  [-23.17074409]
curr_Stock_Price:  98.46127859983338
curr_Factors:  [98.4612786]
mat_Sqrt:  [[0.15]]
grads:  [0.04747333]
Stock Position:  0.047473329652424186
Bond Position:  [-27.84502882]


portfolio before change:  [-23.1875073]
curr_Stock_Price:  98.18149266132917
curr_Factors:  [98.18149266]
mat_Sqrt:  [[0.15]]
grads:  [0.03331863]
Stock Position:  0.033318626802278435
Bond Position:  [-26.45877981]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.17583406]
Stock Price:  98.6311149818824
PL:  [-23.17583406]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.95046360e-03]
 [ 3.84355737e-02]
 [-3.35718967e-03]
 [-6.99951372e-03]
 [-7.39384399e-03]
 [ 3.00130782e-02]
 [ 3.72792207e-03]
 [ 4.99805249e-03]
 [-2.67573282e-02]
 [ 2.34051601e-02]
 [ 2.01090204e-02]
 [-1.52157320e-02]
 [ 2.80278484e-02]
 [ 7.11663829e-03]
 [-1.15145221e-02]
 [-3.73566387e-03]
 [-5.99763677e-03]
 [ 6.76995378e-03]
 [ 7.09843486e-03]
 [ 1.52042898e-02]
 [-2.43193120e-03]
 [-4.47571617e-03]
 [ 4.55893454e-03]
 [-1.23531304e-02]
 [-2.50094113e-03]
 [ 4.52351980e-03]
 [ 2.15224607e-03]
 [ 1.62316511e-03]
 [ 5.20210382e-03]
 [-5.18198156e-03]
 [-1.63079396e-02]
 [ 5.98276925e-03]
 [ 1.97432177e-03]
 [ 1.94345993e-03]
 [-2.02811759e-02]
 [ 1.87415215e-02]
 [ 2.94974348e-03]
 [ 1.97196977e-02]
 [ 8.59862265e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.30577744]
curr_Stock_Price:  99.67241856888009
curr_Factors:  [99.67241857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300309]
Stock Position:  -0.013003090662316828
Bond Position:  [-4.00972795]


portfolio before change:  [-5.30844676]
curr_Stock_Price:  99.8391533912925
curr_Factors:  [99.83915339]
mat_Sqrt:  [[0.15]]
grads:  [0.25623716]
Stock Position:  0.25623715828265997
Bond Position:  [-30.89094771]


portfolio before change:  [-5.25080951]
curr_Stock_Price:  100.07916095219394
curr_Factors:  [100.07916095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02238126]
Stock Position:  -0.02238126447604457
Bond Position:  [-3.01091134]


portfolio before change:  [-5.24192411]
curr_Stock_Price:  99.66534221761444
curr_Factors:  [99.66534222]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666342]
Stock Position:  -0.046663424774326195
Bond Position:  [-0.59119791]


portfolio before change:  [-5.24611853]
curr_Stock_Price:  99.75364494106378
curr_Factors:  [99.75364494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04929229]
Stock Position:  -0.04929229327214292
Bond Position:  [-0.3290326]


portfolio before change:  [-5.26267878]
curr_Stock_Price:  100.08877084220816
curr_Factors:  [100.08877084]
mat_Sqrt:  [[0.15]]
grads:  [0.20008719]
Stock Position:  0.20008718830351513
Bond Position:  [-25.28915952]


portfolio before change:  [-5.07869209]
curr_Stock_Price:  101.02410328239812
curr_Factors:  [101.02410328]
mat_Sqrt:  [[0.15]]
grads:  [0.02485281]
Stock Position:  0.024852813786243006
Bond Position:  [-7.58942531]


portfolio before change:  [-5.08970887]
curr_Stock_Price:  100.61899641355927
curr_Factors:  [100.61899641]
mat_Sqrt:  [[0.15]]
grads:  [0.03332035]
Stock Position:  0.03332034993445137
Bond Position:  [-8.44236904]


portfolio before change:  [-5.10778493]
curr_Stock_Price:  100.10817647521777
curr_Factors:  [100.10817648]
mat_Sqrt:  [[0.15]]
grads:  [-0.17838219]
Stock Position:  -0.17838218815677553
Bond Position:  [12.74973064]


portfolio before change:  [-4.97586782]
curr_Stock_Price:  99.37759182251672
curr_Factors:  [99.37759182]
mat_Sqrt:  [[0.15]]
grads:  [0.1560344]
Stock Position:  0.15603440061593993
Bond Position:  [-20.4821908]


portfolio before change:  [-5.02595778]
curr_Stock_Price:  99.07298260110841
curr_Factors:  [99.0729826]
mat_Sqrt:  [[0.15]]
grads:  [0.13406014]
Stock Position:  0.134060136151676
Bond Position:  [-18.30769531]


portfolio before change:  [-4.97127656]
curr_Stock_Price:  99.49793980190866
curr_Factors:  [99.4979398]
mat_Sqrt:  [[0.15]]
grads:  [-0.10143821]
Stock Position:  -0.10143821337588016
Bond Position:  [5.12161669]


portfolio before change:  [-5.05872163]
curr_Stock_Price:  100.3663040117055
curr_Factors:  [100.36630401]
mat_Sqrt:  [[0.15]]
grads:  [0.18685232]
Stock Position:  0.1868523228634556
Bond Position:  [-23.81239867]


portfolio before change:  [-5.03720637]
curr_Stock_Price:  100.49738077969306
curr_Factors:  [100.49738078]
mat_Sqrt:  [[0.15]]
grads:  [0.04744426]
Stock Position:  0.047444255267697105
Bond Position:  [-9.80522976]


portfolio before change:  [-4.98556177]
curr_Stock_Price:  101.61174821789169
curr_Factors:  [101.61174822]
mat_Sqrt:  [[0.15]]
grads:  [-0.07676348]
Stock Position:  -0.076763480696864
Bond Position:  [2.81450971]


portfolio before change:  [-4.9244883]
curr_Stock_Price:  100.82072586779292
curr_Factors:  [100.82072587]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490443]
Stock Position:  -0.024904425819905013
Bond Position:  [-2.41360601]


portfolio before change:  [-4.92950016]
curr_Stock_Price:  101.00985427626979
curr_Factors:  [101.00985428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03998425]
Stock Position:  -0.03998424514355752
Bond Position:  [-0.89069738]


portfolio before change:  [-4.9467056]
curr_Stock_Price:  101.43737523244921
curr_Factors:  [101.43737523]
mat_Sqrt:  [[0.15]]
grads:  [0.04513303]
Stock Position:  0.045133025213031294
Bond Position:  [-9.52488122]


portfolio before change:  [-4.97853189]
curr_Stock_Price:  100.7585905542346
curr_Factors:  [100.75859055]
mat_Sqrt:  [[0.15]]
grads:  [0.0473229]
Stock Position:  0.047322899091411505
Bond Position:  [-9.74672051]


portfolio before change:  [-4.93329149]
curr_Stock_Price:  101.74033130170274
curr_Factors:  [101.7403313]
mat_Sqrt:  [[0.15]]
grads:  [0.10136193]
Stock Position:  0.10136193181316186
Bond Position:  [-15.24588802]


portfolio before change:  [-4.91723023]
curr_Stock_Price:  101.91758838924973
curr_Factors:  [101.91758839]
mat_Sqrt:  [[0.15]]
grads:  [-0.01621287]
Stock Position:  -0.01621287463688061
Bond Position:  [-3.26485314]


portfolio before change:  [-4.89741743]
curr_Stock_Price:  100.67037425270438
curr_Factors:  [100.67037425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02983811]
Stock Position:  -0.02983810782487983
Bond Position:  [-1.89360395]


portfolio before change:  [-4.92734303]
curr_Stock_Price:  101.66537305684757
curr_Factors:  [101.66537306]
mat_Sqrt:  [[0.15]]
grads:  [0.0303929]
Stock Position:  0.030392896906136918
Bond Position:  [-8.01724823]


portfolio before change:  [-4.9027549]
curr_Stock_Price:  102.50735747688414
curr_Factors:  [102.50735748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0823542]
Stock Position:  -0.08235420265953604
Bond Position:  [3.53915679]


portfolio before change:  [-5.02222638]
curr_Stock_Price:  103.9634324901796
curr_Factors:  [103.96343249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01667294]
Stock Position:  -0.016672940880495427
Bond Position:  [-3.28885021]


portfolio before change:  [-5.02688178]
curr_Stock_Price:  104.21799323027302
curr_Factors:  [104.21799323]
mat_Sqrt:  [[0.15]]
grads:  [0.0301568]
Stock Position:  0.030156798687861232
Bond Position:  [-8.16976283]


portfolio before change:  [-5.05239105]
curr_Stock_Price:  103.40597126421717
curr_Factors:  [103.40597126]
mat_Sqrt:  [[0.15]]
grads:  [0.01434831]
Stock Position:  0.014348307122355112
Bond Position:  [-6.53609169]


portfolio before change:  [-5.0465526]
curr_Stock_Price:  103.86982474429927
curr_Factors:  [103.86982474]
mat_Sqrt:  [[0.15]]
grads:  [0.0108211]
Stock Position:  0.010821100765844959
Bond Position:  [-6.17053844]


portfolio before change:  [-5.04172299]
curr_Stock_Price:  104.38742225161887
curr_Factors:  [104.38742225]
mat_Sqrt:  [[0.15]]
grads:  [0.03468069]
Stock Position:  0.03468069215392848
Bond Position:  [-8.66195105]


portfolio before change:  [-5.05308198]
curr_Stock_Price:  104.09111390442189
curr_Factors:  [104.0911139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03454654]
Stock Position:  -0.034546543755174915
Bond Position:  [-1.45709376]


portfolio before change:  [-5.06625983]
curr_Stock_Price:  104.4672932496067
curr_Factors:  [104.46729325]
mat_Sqrt:  [[0.15]]
grads:  [-0.1087196]
Stock Position:  -0.10871959766212926
Bond Position:  [6.29138226]


portfolio before change:  [-5.06580722]
curr_Stock_Price:  104.47036416011602
curr_Factors:  [104.47036416]
mat_Sqrt:  [[0.15]]
grads:  [0.03988513]
Stock Position:  0.039885128308566706
Bond Position:  [-9.2326211]


portfolio before change:  [-5.07536286]
curr_Stock_Price:  104.25972204948422
curr_Factors:  [104.25972205]
mat_Sqrt:  [[0.15]]
grads:  [0.01316215]
Stock Position:  0.013162145138742073
Bond Position:  [-6.44764445]


portfolio before change:  [-5.07771787]
curr_Stock_Price:  104.14203607627957
curr_Factors:  [104.14203608]
mat_Sqrt:  [[0.15]]
grads:  [0.0129564]
Stock Position:  0.012956399539443369
Bond Position:  [-6.42702369]


portfolio before change:  [-5.08626444]
curr_Stock_Price:  103.54440514175178
curr_Factors:  [103.54440514]
mat_Sqrt:  [[0.15]]
grads:  [-0.13520784]
Stock Position:  -0.1352078391911509
Bond Position:  [8.91375084]


portfolio before change:  [-5.02172085]
curr_Stock_Price:  103.07528071072188
curr_Factors:  [103.07528071]
mat_Sqrt:  [[0.15]]
grads:  [0.12494348]
Stock Position:  0.12494347637571644
Bond Position:  [-17.90030475]


portfolio before change:  [-5.09365268]
curr_Stock_Price:  102.51747524861733
curr_Factors:  [102.51747525]
mat_Sqrt:  [[0.15]]
grads:  [0.01966496]
Stock Position:  0.01966495654414483
Bond Position:  [-7.10965438]


portfolio before change:  [-5.08884786]
curr_Stock_Price:  102.8070048036803
curr_Factors:  [102.8070048]
mat_Sqrt:  [[0.15]]
grads:  [0.13146465]
Stock Position:  0.13146465145226766
Bond Position:  [-18.60433491]


portfolio before change:  [-5.25374887]
curr_Stock_Price:  101.57035813010441
curr_Factors:  [101.57035813]
mat_Sqrt:  [[0.15]]
grads:  [0.05732415]
Stock Position:  0.05732415100614132
Bond Position:  [-11.07618342]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.27648009]
Stock Price:  101.1979739485491
PL:  [-6.47445403]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.21090027e-02]
 [ 3.14262368e-02]
 [-1.02968223e-02]
 [-8.07028624e-03]
 [-4.71738265e-03]
 [ 4.84148520e-02]
 [ 3.58518690e-03]
 [ 3.03059092e-03]
 [ 3.49500798e-03]
 [ 2.34422185e-02]
 [ 2.17718785e-02]
 [-4.10798007e-03]
 [-2.33449725e-02]
 [ 1.72946070e-02]
 [-1.43949656e-02]
 [ 3.65975873e-04]
 [-6.10069519e-03]
 [-2.94367740e-03]
 [ 1.53795795e-03]
 [-1.73958221e-03]
 [-8.35757222e-03]
 [-1.66762497e-02]
 [ 6.63146983e-03]
 [-8.85759305e-03]
 [ 1.24683798e-02]
 [ 1.02172129e-03]
 [ 2.36115119e-02]
 [-4.63827876e-03]
 [-3.57840064e-02]
 [-9.23683700e-03]
 [ 4.69087721e-02]
 [-1.23389159e-03]
 [-2.07088682e-02]
 [-3.42606249e-02]
 [-2.35207394e-02]
 [ 3.51220240e-02]
 [-5.62897520e-03]
 [-1.07561639e-03]
 [ 1.68178206e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.34596026]
curr_Stock_Price:  99.53395024600573
curr_Factors:  [99.53395025]
mat_Sqrt:  [[0.15]]
grads:  [-0.08072668]
Stock Position:  -0.08072668492019189
Bond Position:  [-0.31091442]


portfolio before change:  [-8.33543932]
curr_Stock_Price:  99.40314091228912
curr_Factors:  [99.40314091]
mat_Sqrt:  [[0.15]]
grads:  [0.20950825]
Stock Position:  0.2095082453455893
Bond Position:  [-29.16121695]


portfolio before change:  [-8.35961767]
curr_Stock_Price:  99.30513538559771
curr_Factors:  [99.30513539]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864548]
Stock Position:  -0.06864548229594643
Bond Position:  [-1.54276875]


portfolio before change:  [-8.26132919]
curr_Stock_Price:  97.87049859075017
curr_Factors:  [97.87049859]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380191]
Stock Position:  -0.05380190825792858
Bond Position:  [-2.9957096]


portfolio before change:  [-8.23817649]
curr_Stock_Price:  97.43320589925614
curr_Factors:  [97.4332059]
mat_Sqrt:  [[0.15]]
grads:  [-0.03144922]
Stock Position:  -0.03144921764745814
Bond Position:  [-5.1739784]


portfolio before change:  [-8.23934956]
curr_Stock_Price:  97.44994006984203
curr_Factors:  [97.44994007]
mat_Sqrt:  [[0.15]]
grads:  [0.32276568]
Stock Position:  0.3227656797594605
Bond Position:  [-39.69284571]


portfolio before change:  [-8.11045436]
curr_Stock_Price:  97.8646592300891
curr_Factors:  [97.86465923]
mat_Sqrt:  [[0.15]]
grads:  [0.02390125]
Stock Position:  0.023901245985510182
Bond Position:  [-10.44954166]


portfolio before change:  [-8.13509598]
curr_Stock_Price:  96.88833615451392
curr_Factors:  [96.88833615]
mat_Sqrt:  [[0.15]]
grads:  [0.02020394]
Stock Position:  0.02020393948543397
Bond Position:  [-10.09262206]


portfolio before change:  [-8.12235843]
curr_Stock_Price:  97.58123071195551
curr_Factors:  [97.58123071]
mat_Sqrt:  [[0.15]]
grads:  [0.02330005]
Stock Position:  0.023300053216134497
Bond Position:  [-10.3960063]


portfolio before change:  [-8.11080114]
curr_Stock_Price:  98.13302659648217
curr_Factors:  [98.1330266]
mat_Sqrt:  [[0.15]]
grads:  [0.15628146]
Stock Position:  0.15628145677557054
Bond Position:  [-23.4471735]


portfolio before change:  [-8.40862935]
curr_Stock_Price:  96.2460648699418
curr_Factors:  [96.24606487]
mat_Sqrt:  [[0.15]]
grads:  [0.14514586]
Stock Position:  0.1451458567683498
Bond Position:  [-22.37834689]


portfolio before change:  [-8.47847961]
curr_Stock_Price:  95.78409654066851
curr_Factors:  [95.78409654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02738653]
Stock Position:  -0.02738653381761701
Bond Position:  [-5.85528521]


portfolio before change:  [-8.4834929]
curr_Stock_Price:  95.94042649674783
curr_Factors:  [95.9404265]
mat_Sqrt:  [[0.15]]
grads:  [-0.15563315]
Stock Position:  -0.15563315008883458
Bond Position:  [6.4480179]


portfolio before change:  [-8.54503097]
curr_Stock_Price:  96.34101033801961
curr_Factors:  [96.34101034]
mat_Sqrt:  [[0.15]]
grads:  [0.11529738]
Stock Position:  0.11529738024016098
Bond Position:  [-19.65289707]


portfolio before change:  [-8.55750382]
curr_Stock_Price:  96.25413862838596
curr_Factors:  [96.25413863]
mat_Sqrt:  [[0.15]]
grads:  [-0.09596644]
Stock Position:  -0.09596643738266698
Bond Position:  [0.67966295]


portfolio before change:  [-8.64508134]
curr_Stock_Price:  97.16760886410387
curr_Factors:  [97.16760886]
mat_Sqrt:  [[0.15]]
grads:  [0.00243984]
Stock Position:  0.0024398391506656363
Bond Position:  [-8.88215467]


portfolio before change:  [-8.64809166]
curr_Stock_Price:  96.38887403301568
curr_Factors:  [96.38887403]
mat_Sqrt:  [[0.15]]
grads:  [-0.0406713]
Stock Position:  -0.040671301289293894
Bond Position:  [-4.72783073]


portfolio before change:  [-8.63602097]
curr_Stock_Price:  96.07755593624562
curr_Factors:  [96.07755594]
mat_Sqrt:  [[0.15]]
grads:  [-0.01962452]
Stock Position:  -0.019624516008390273
Bond Position:  [-6.75054543]


portfolio before change:  [-8.62636479]
curr_Stock_Price:  95.54250820459683
curr_Factors:  [95.5425082]
mat_Sqrt:  [[0.15]]
grads:  [0.01025305]
Stock Position:  0.010253053011763439
Bond Position:  [-9.60596719]


portfolio before change:  [-8.62596278]
curr_Stock_Price:  95.69883454555443
curr_Factors:  [95.69883455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01159721]
Stock Position:  -0.011597214704868615
Bond Position:  [-7.51612285]


portfolio before change:  [-8.64118968]
curr_Stock_Price:  96.93079599734011
curr_Factors:  [96.930796]
mat_Sqrt:  [[0.15]]
grads:  [-0.05571715]
Stock Position:  -0.055717148141057375
Bond Position:  [-3.24048216]


portfolio before change:  [-8.6734525]
curr_Stock_Price:  97.5025721360707
curr_Factors:  [97.50257214]
mat_Sqrt:  [[0.15]]
grads:  [-0.111175]
Stock Position:  -0.1111749982232511
Bond Position:  [2.16639578]


portfolio before change:  [-8.71275507]
curr_Stock_Price:  97.85852797133761
curr_Factors:  [97.85852797]
mat_Sqrt:  [[0.15]]
grads:  [0.0442098]
Stock Position:  0.04420979888806032
Bond Position:  [-13.03906092]


portfolio before change:  [-8.73649954]
curr_Stock_Price:  97.35831130240369
curr_Factors:  [97.3583113]
mat_Sqrt:  [[0.15]]
grads:  [-0.05905062]
Stock Position:  -0.05905062033586931
Bond Position:  [-2.98743086]


portfolio before change:  [-8.69741553]
curr_Stock_Price:  96.690114090943
curr_Factors:  [96.69011409]
mat_Sqrt:  [[0.15]]
grads:  [0.08312253]
Stock Position:  0.08312253180729154
Bond Position:  [-16.73454261]


portfolio before change:  [-8.75912699]
curr_Stock_Price:  95.97286563211442
curr_Factors:  [95.97286563]
mat_Sqrt:  [[0.15]]
grads:  [0.00681148]
Stock Position:  0.0068114752655690745
Bond Position:  [-9.41284379]


portfolio before change:  [-8.76320052]
curr_Stock_Price:  95.54757483465508
curr_Factors:  [95.54757483]
mat_Sqrt:  [[0.15]]
grads:  [0.15741008]
Stock Position:  0.1574100791684757
Bond Position:  [-23.80335184]


portfolio before change:  [-8.81876707]
curr_Stock_Price:  95.21347331382148
curr_Factors:  [95.21347331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03092186]
Stock Position:  -0.030921858409392648
Bond Position:  [-5.87458953]


portfolio before change:  [-8.81414584]
curr_Stock_Price:  95.0402752092962
curr_Factors:  [95.04027521]
mat_Sqrt:  [[0.15]]
grads:  [-0.23856004]
Stock Position:  -0.23856004276712275
Bond Position:  [13.85866628]


portfolio before change:  [-8.74041564]
curr_Stock_Price:  94.73847380039925
curr_Factors:  [94.7384738]
mat_Sqrt:  [[0.15]]
grads:  [-0.06157891]
Stock Position:  -0.061578913334236686
Bond Position:  [-2.90652337]


portfolio before change:  [-8.73732677]
curr_Stock_Price:  94.68241233460232
curr_Factors:  [94.68241233]
mat_Sqrt:  [[0.15]]
grads:  [0.31272515]
Stock Position:  0.31272514735341406
Bond Position:  [-38.34689812]


portfolio before change:  [-8.72062475]
curr_Stock_Price:  94.75114901515735
curr_Factors:  [94.75114902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00822594]
Stock Position:  -0.008225943902989436
Bond Position:  [-7.94120711]


portfolio before change:  [-8.72155522]
curr_Stock_Price:  94.74358306171194
curr_Factors:  [94.74358306]
mat_Sqrt:  [[0.15]]
grads:  [-0.13805912]
Stock Position:  -0.1380591214640904
Bond Position:  [4.35866062]


portfolio before change:  [-8.82439761]
curr_Stock_Price:  95.49244524325474
curr_Factors:  [95.49244524]
mat_Sqrt:  [[0.15]]
grads:  [-0.22840417]
Stock Position:  -0.2284041662958324
Bond Position:  [12.98647473]


portfolio before change:  [-8.67620472]
curr_Stock_Price:  94.85073419004202
curr_Factors:  [94.85073419]
mat_Sqrt:  [[0.15]]
grads:  [-0.15680493]
Stock Position:  -0.15680492935852217
Bond Position:  [6.19685795]


portfolio before change:  [-8.66062299]
curr_Stock_Price:  94.75630425449329
curr_Factors:  [94.75630425]
mat_Sqrt:  [[0.15]]
grads:  [0.23414683]
Stock Position:  0.234146826886873
Bond Position:  [-30.84751095]


portfolio before change:  [-8.62248331]
curr_Stock_Price:  94.9356611642309
curr_Factors:  [94.93566116]
mat_Sqrt:  [[0.15]]
grads:  [-0.0375265]
Stock Position:  -0.037526501324817926
Bond Position:  [-5.0598801]


portfolio before change:  [-8.64763028]
curr_Stock_Price:  95.58891786860227
curr_Factors:  [95.58891787]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717078]
Stock Position:  -0.007170775919693532
Bond Position:  [-7.96218357]


portfolio before change:  [-8.65187911]
curr_Stock_Price:  96.04263347266495
curr_Factors:  [96.04263347]
mat_Sqrt:  [[0.15]]
grads:  [0.1121188]
Stock Position:  0.11211880368270005
Bond Position:  [-19.42006427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.78448042]
Stock Price:  94.88160023355512
PL:  [-8.78448042]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.21001640e-02]
 [ 3.62328330e-02]
 [-2.57977080e-03]
 [-4.59017033e-03]
 [-2.79123034e-03]
 [ 3.22055547e-02]
 [ 3.72916518e-03]
 [-1.28330062e-03]
 [-2.68047863e-02]
 [ 2.31446310e-02]
 [ 1.99909322e-02]
 [-1.40759316e-02]
 [ 2.83025989e-02]
 [ 2.19947881e-02]
 [-5.29749803e-03]
 [-3.04603325e-03]
 [-5.10113076e-03]
 [ 7.42681882e-03]
 [ 1.51233749e-02]
 [ 1.77842195e-02]
 [-1.03869550e-03]
 [-2.95620498e-03]
 [ 3.96595755e-03]
 [-1.12171272e-02]
 [ 1.23323658e-03]
 [ 6.60201910e-03]
 [-2.32613959e-03]
 [ 2.18317111e-04]
 [ 3.25652431e-03]
 [-6.11157887e-03]
 [-1.93958179e-02]
 [ 1.25944895e-02]
 [-3.27410219e-03]
 [-2.48231810e-03]
 [-2.02358892e-02]
 [ 6.63579169e-04]
 [ 1.50202312e-02]
 [ 2.05502116e-02]
 [ 8.73432976e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.7959231]
curr_Stock_Price:  100.67906375904792
curr_Factors:  [100.67906376]
mat_Sqrt:  [[0.15]]
grads:  [-0.21400109]
Stock Position:  -0.21400109353477836
Bond Position:  [38.34135284]


portfolio before change:  [17.00036226]
curr_Stock_Price:  99.74614240381453
curr_Factors:  [99.7461424]
mat_Sqrt:  [[0.15]]
grads:  [0.24155222]
Stock Position:  0.2415522199049349
Bond Position:  [-7.09353986]


portfolio before change:  [16.99646114]
curr_Stock_Price:  99.73366323049217
curr_Factors:  [99.73366323]
mat_Sqrt:  [[0.15]]
grads:  [-0.01719847]
Stock Position:  -0.017198471981592276
Bond Position:  [18.71172775]


portfolio before change:  [16.99009449]
curr_Stock_Price:  100.23985755653091
curr_Factors:  [100.23985756]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060114]
Stock Position:  -0.03060113551397526
Bond Position:  [20.05754795]


portfolio before change:  [16.95934082]
curr_Stock_Price:  101.32677840858345
curr_Factors:  [101.32677841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0186082]
Stock Position:  -0.018608202269799555
Bond Position:  [18.84485001]


portfolio before change:  [16.97638459]
curr_Stock_Price:  100.53744831732101
curr_Factors:  [100.53744832]
mat_Sqrt:  [[0.15]]
grads:  [0.2147037]
Stock Position:  0.2147036977776629
Bond Position:  [-4.60937733]


portfolio before change:  [17.00497999]
curr_Stock_Price:  100.6733174824586
curr_Factors:  [100.67331748]
mat_Sqrt:  [[0.15]]
grads:  [0.0248611]
Stock Position:  0.02486110121991526
Bond Position:  [14.50213046]


portfolio before change:  [16.97513329]
curr_Stock_Price:  99.39985877302091
curr_Factors:  [99.39985877]
mat_Sqrt:  [[0.15]]
grads:  [-0.00855534]
Stock Position:  -0.008555337434093594
Bond Position:  [17.82553262]


portfolio before change:  [16.9714065]
curr_Stock_Price:  100.09592914136641
curr_Factors:  [100.09592914]
mat_Sqrt:  [[0.15]]
grads:  [-0.17869858]
Stock Position:  -0.1786985751245812
Bond Position:  [34.85840642]


portfolio before change:  [16.79279779]
curr_Stock_Price:  101.11981131444578
curr_Factors:  [101.11981131]
mat_Sqrt:  [[0.15]]
grads:  [0.15429754]
Stock Position:  0.1542975400674115
Bond Position:  [1.19025965]


portfolio before change:  [16.80576075]
curr_Stock_Price:  101.20285976357177
curr_Factors:  [101.20285976]
mat_Sqrt:  [[0.15]]
grads:  [0.13327288]
Stock Position:  0.13327288108353824
Bond Position:  [3.31816406]


portfolio before change:  [16.74932567]
curr_Stock_Price:  100.77629229822281
curr_Factors:  [100.7762923]
mat_Sqrt:  [[0.15]]
grads:  [-0.09383954]
Stock Position:  -0.09383954388010225
Bond Position:  [26.20612698]


portfolio before change:  [16.72733195]
curr_Stock_Price:  101.04557854185818
curr_Factors:  [101.04557854]
mat_Sqrt:  [[0.15]]
grads:  [0.18868399]
Stock Position:  0.18868399297434985
Bond Position:  [-2.33835128]


portfolio before change:  [16.90265846]
curr_Stock_Price:  101.97633489894946
curr_Factors:  [101.9763349]
mat_Sqrt:  [[0.15]]
grads:  [0.14663192]
Stock Position:  0.14663192090870658
Bond Position:  [1.94967259]


portfolio before change:  [16.80572424]
curr_Stock_Price:  101.313600970433
curr_Factors:  [101.31360097]
mat_Sqrt:  [[0.15]]
grads:  [-0.03531665]
Stock Position:  -0.035316653527495065
Bond Position:  [20.38378158]


portfolio before change:  [16.76345811]
curr_Stock_Price:  102.58252818359107
curr_Factors:  [102.58252818]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030689]
Stock Position:  -0.02030688832364026
Bond Position:  [18.84659005]


portfolio before change:  [16.75118305]
curr_Stock_Price:  103.30302396407974
curr_Factors:  [103.30302396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03400754]
Stock Position:  -0.034007538400408266
Bond Position:  [20.2642646]


portfolio before change:  [16.76918746]
curr_Stock_Price:  102.84808904073121
curr_Factors:  [102.84808904]
mat_Sqrt:  [[0.15]]
grads:  [0.04951213]
Stock Position:  0.0495121254540731
Bond Position:  [11.67695997]


portfolio before change:  [16.75529256]
curr_Stock_Price:  102.5379709846761
curr_Factors:  [102.53797098]
mat_Sqrt:  [[0.15]]
grads:  [0.1008225]
Stock Position:  0.10082249937408483
Bond Position:  [6.41715805]


portfolio before change:  [16.73612177]
curr_Stock_Price:  102.33987051781341
curr_Factors:  [102.33987052]
mat_Sqrt:  [[0.15]]
grads:  [0.11856146]
Stock Position:  0.1185614634073195
Bond Position:  [4.60255696]


portfolio before change:  [16.76616962]
curr_Stock_Price:  102.58845458664922
curr_Factors:  [102.58845459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692464]
Stock Position:  -0.006924636691798511
Bond Position:  [17.4765574]


portfolio before change:  [16.76487967]
curr_Stock_Price:  103.09023712409385
curr_Factors:  [103.09023712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01970803]
Stock Position:  -0.01970803320677994
Bond Position:  [18.79658548]


portfolio before change:  [16.7678165]
curr_Stock_Price:  103.06044647163313
curr_Factors:  [103.06044647]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [14.04292746]


portfolio before change:  [16.78012652]
curr_Stock_Price:  103.45963931170013
curr_Factors:  [103.45963931]
mat_Sqrt:  [[0.15]]
grads:  [-0.07478085]
Stock Position:  -0.07478084777749965
Bond Position:  [24.51692606]


portfolio before change:  [16.85230735]
curr_Stock_Price:  102.53539175770736
curr_Factors:  [102.53539176]
mat_Sqrt:  [[0.15]]
grads:  [0.00822158]
Stock Position:  0.008221577197369627
Bond Position:  [16.00930471]


portfolio before change:  [16.84026194]
curr_Stock_Price:  100.82687620626446
curr_Factors:  [100.82687621]
mat_Sqrt:  [[0.15]]
grads:  [0.04401346]
Stock Position:  0.04401346064896272
Bond Position:  [12.40252219]


portfolio before change:  [16.87487479]
curr_Stock_Price:  101.57806536160554
curr_Factors:  [101.57806536]
mat_Sqrt:  [[0.15]]
grads:  [-0.0155076]
Stock Position:  -0.015507597248618037
Bond Position:  [18.45010651]


portfolio before change:  [16.86956819]
curr_Stock_Price:  102.06898663677492
curr_Factors:  [102.06898664]
mat_Sqrt:  [[0.15]]
grads:  [0.00145545]
Stock Position:  0.001455447406732777
Bond Position:  [16.72101214]


portfolio before change:  [16.87230862]
curr_Stock_Price:  102.51570403059992
curr_Factors:  [102.51570403]
mat_Sqrt:  [[0.15]]
grads:  [0.02171016]
Stock Position:  0.021710162076917453
Bond Position:  [14.64667607]


portfolio before change:  [16.8728006]
curr_Stock_Price:  102.45402959760177
curr_Factors:  [102.4540296]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074386]
Stock Position:  -0.040743859130483166
Bond Position:  [21.04717315]


portfolio before change:  [16.87762946]
curr_Stock_Price:  102.40008791007938
curr_Factors:  [102.40008791]
mat_Sqrt:  [[0.15]]
grads:  [-0.12930545]
Stock Position:  -0.1293054524092147
Bond Position:  [30.11851915]


portfolio before change:  [16.89222077]
curr_Stock_Price:  102.31636161661007
curr_Factors:  [102.31636162]
mat_Sqrt:  [[0.15]]
grads:  [0.08396326]
Stock Position:  0.08396326364038897
Bond Position:  [8.30140513]


portfolio before change:  [16.89829291]
curr_Stock_Price:  102.37632114583074
curr_Factors:  [102.37632115]
mat_Sqrt:  [[0.15]]
grads:  [-0.02182735]
Stock Position:  -0.021827347947555392
Bond Position:  [19.13289649]


portfolio before change:  [16.86668421]
curr_Stock_Price:  103.93402146777066
curr_Factors:  [103.93402147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01654879]
Stock Position:  -0.016548787324156523
Bond Position:  [18.58666622]


portfolio before change:  [16.86734964]
curr_Stock_Price:  104.0342125856612
curr_Factors:  [104.03421259]
mat_Sqrt:  [[0.15]]
grads:  [-0.13490593]
Stock Position:  -0.13490592767243886
Bond Position:  [30.9021816]


portfolio before change:  [16.78112933]
curr_Stock_Price:  104.70196182067734
curr_Factors:  [104.70196182]
mat_Sqrt:  [[0.15]]
grads:  [0.00442386]
Stock Position:  0.004423861128453495
Bond Position:  [16.31794239]


portfolio before change:  [16.78871199]
curr_Stock_Price:  105.95489175842626
curr_Factors:  [105.95489176]
mat_Sqrt:  [[0.15]]
grads:  [0.10013487]
Stock Position:  0.10013487481076472
Bond Position:  [6.17893216]


portfolio before change:  [16.74890154]
curr_Stock_Price:  105.54960977887963
curr_Factors:  [105.54960978]
mat_Sqrt:  [[0.15]]
grads:  [0.13700141]
Stock Position:  0.13700141063160798
Bond Position:  [2.28845611]


portfolio before change:  [16.79750896]
curr_Stock_Price:  105.90231671493616
curr_Factors:  [105.90231671]
mat_Sqrt:  [[0.15]]
grads:  [0.05822887]
Stock Position:  0.05822886505610678
Bond Position:  [10.63093725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.82565499]
Stock Price:  106.36286274994914
PL:  [10.46279224]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 3.00817620e-02]
 [ 2.93613138e-02]
 [-1.72812426e-02]
 [-6.98225839e-03]
 [-7.43801992e-03]
 [ 2.78236729e-02]
 [ 3.59332554e-03]
 [ 2.47134092e-03]
 [-2.77029350e-02]
 [ 2.34055947e-02]
 [ 1.98001365e-02]
 [-1.43938456e-02]
 [ 1.68422779e-02]
 [ 6.49796210e-03]
 [ 6.79966220e-03]
 [-3.49553657e-03]
 [-5.88842220e-03]
 [ 5.87204171e-03]
 [ 7.56243872e-03]
 [ 5.89777397e-03]
 [-4.89654827e-03]
 [-5.79381943e-03]
 [ 3.96595755e-03]
 [-1.15879741e-02]
 [ 2.58327299e-04]
 [ 4.43153337e-03]
 [ 6.86439338e-03]
 [ 1.01726470e-03]
 [ 4.40611191e-03]
 [-5.79807863e-03]
 [-1.63053600e-02]
 [ 7.39686743e-03]
 [-3.38444706e-04]
 [ 5.14840606e-03]
 [-2.02388090e-02]
 [ 1.42792741e-02]
 [ 5.45159237e-03]
 [ 2.08583465e-02]
 [ 1.00856656e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.59498302]
curr_Stock_Price:  98.56614116208262
curr_Factors:  [98.56614116]
mat_Sqrt:  [[0.15]]
grads:  [0.20054508]
Stock Position:  0.20054507993372117
Bond Position:  [-49.36193768]


portfolio before change:  [-29.46196567]
curr_Stock_Price:  99.26018947134573
curr_Factors:  [99.26018947]
mat_Sqrt:  [[0.15]]
grads:  [0.19574209]
Stock Position:  0.19574209220430558
Bond Position:  [-48.89136283]


portfolio before change:  [-29.53838509]
curr_Stock_Price:  98.90100451667747
curr_Factors:  [98.90100452]
mat_Sqrt:  [[0.15]]
grads:  [-0.11520828]
Stock Position:  -0.11520828408750121
Bond Position:  [-18.14417006]


portfolio before change:  [-29.62952267]
curr_Stock_Price:  99.67238494089676
curr_Factors:  [99.67238494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04654839]
Stock Position:  -0.046548389289791235
Bond Position:  [-24.98993369]


portfolio before change:  [-29.63292465]
curr_Stock_Price:  99.6783582262329
curr_Factors:  [99.67835823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0495868]
Stock Position:  -0.049586799498751
Bond Position:  [-24.69019389]


portfolio before change:  [-29.63241872]
curr_Stock_Price:  99.60591148292293
curr_Factors:  [99.60591148]
mat_Sqrt:  [[0.15]]
grads:  [0.18549115]
Stock Position:  0.18549115240058678
Bond Position:  [-48.10843402]


portfolio before change:  [-29.62637083]
curr_Stock_Price:  99.67093784898292
curr_Factors:  [99.67093785]
mat_Sqrt:  [[0.15]]
grads:  [0.0239555]
Stock Position:  0.02395550360813455
Bond Position:  [-32.01403834]


portfolio before change:  [-29.624281]
curr_Stock_Price:  99.92523571209038
curr_Factors:  [99.92523571]
mat_Sqrt:  [[0.15]]
grads:  [0.01647561]
Stock Position:  0.01647560612687929
Bond Position:  [-31.27060983]


portfolio before change:  [-29.63686193]
curr_Stock_Price:  99.39889027451754
curr_Factors:  [99.39889027]
mat_Sqrt:  [[0.15]]
grads:  [-0.18468623]
Stock Position:  -0.18468623305090773
Bond Position:  [-11.27925532]


portfolio before change:  [-29.64371194]
curr_Stock_Price:  99.42834570237888
curr_Factors:  [99.4283457]
mat_Sqrt:  [[0.15]]
grads:  [0.1560373]
Stock Position:  0.15603729831303498
Bond Position:  [-45.15824238]


portfolio before change:  [-29.66243861]
curr_Stock_Price:  99.34450973439107
curr_Factors:  [99.34450973]
mat_Sqrt:  [[0.15]]
grads:  [0.13200091]
Stock Position:  0.13200090970450737
Bond Position:  [-42.77600427]


portfolio before change:  [-29.70203527]
curr_Stock_Price:  99.08504695554026
curr_Factors:  [99.08504696]
mat_Sqrt:  [[0.15]]
grads:  [-0.09595897]
Stock Position:  -0.09595897062705121
Bond Position:  [-20.19393616]


portfolio before change:  [-29.75233175]
curr_Stock_Price:  99.58288553264919
curr_Factors:  [99.58288553]
mat_Sqrt:  [[0.15]]
grads:  [0.11228185]
Stock Position:  0.11228185245147594
Bond Position:  [-40.93368261]


portfolio before change:  [-29.75027076]
curr_Stock_Price:  99.64681404174895
curr_Factors:  [99.64681404]
mat_Sqrt:  [[0.15]]
grads:  [0.04331975]
Stock Position:  0.04331974730047469
Bond Position:  [-34.06694557]


portfolio before change:  [-29.70907947]
curr_Stock_Price:  100.69598755903115
curr_Factors:  [100.69598756]
mat_Sqrt:  [[0.15]]
grads:  [0.04533108]
Stock Position:  0.04533108132515392
Bond Position:  [-34.27373747]


portfolio before change:  [-29.72819628]
curr_Stock_Price:  100.36878760949635
curr_Factors:  [100.36878761]
mat_Sqrt:  [[0.15]]
grads:  [-0.02330358]
Stock Position:  -0.023303577118921424
Bond Position:  [-27.3892445]


portfolio before change:  [-29.75668288]
curr_Stock_Price:  101.44427635258972
curr_Factors:  [101.44427635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03925615]
Stock Position:  -0.039256147992909815
Bond Position:  [-25.77437136]


portfolio before change:  [-29.72911928]
curr_Stock_Price:  100.66005274715172
curr_Factors:  [100.66005275]
mat_Sqrt:  [[0.15]]
grads:  [0.03914694]
Stock Position:  0.03914694476563163
Bond Position:  [-33.66965281]


portfolio before change:  [-29.72104669]
curr_Stock_Price:  100.9737824514278
curr_Factors:  [100.97378245]
mat_Sqrt:  [[0.15]]
grads:  [0.05041626]
Stock Position:  0.050416258110055095
Bond Position:  [-34.81176697]


portfolio before change:  [-29.73810538]
curr_Stock_Price:  100.72174185445866
curr_Factors:  [100.72174185]
mat_Sqrt:  [[0.15]]
grads:  [0.03931849]
Stock Position:  0.03931849311498007
Bond Position:  [-33.69833249]


portfolio before change:  [-29.73862224]
curr_Stock_Price:  100.81573576911887
curr_Factors:  [100.81573577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03264366]
Stock Position:  -0.03264365512696664
Bond Position:  [-26.44762813]


portfolio before change:  [-29.77532183]
curr_Stock_Price:  101.8387043278234
curr_Factors:  [101.83870433]
mat_Sqrt:  [[0.15]]
grads:  [-0.03862546]
Stock Position:  -0.0386254628893129
Bond Position:  [-25.84175473]


portfolio before change:  [-29.80819409]
curr_Stock_Price:  102.60612129897555
curr_Factors:  [102.6061213]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [-32.52107089]


portfolio before change:  [-29.79791205]
curr_Stock_Price:  103.14876802375095
curr_Factors:  [103.14876802]
mat_Sqrt:  [[0.15]]
grads:  [-0.07725316]
Stock Position:  -0.07725316059519599
Bond Position:  [-21.82934371]


portfolio before change:  [-29.78063266]
curr_Stock_Price:  102.88977246283244
curr_Factors:  [102.88977246]
mat_Sqrt:  [[0.15]]
grads:  [0.00172218]
Stock Position:  0.0017221819945085054
Bond Position:  [-29.95782757]


portfolio before change:  [-29.78293499]
curr_Stock_Price:  103.72744779269914
curr_Factors:  [103.72744779]
mat_Sqrt:  [[0.15]]
grads:  [0.02954356]
Stock Position:  0.029543555812497718
Bond Position:  [-32.84741264]


portfolio before change:  [-29.76374921]
curr_Stock_Price:  104.51584182263274
curr_Factors:  [104.51584182]
mat_Sqrt:  [[0.15]]
grads:  [0.04576262]
Stock Position:  0.0457626225413209
Bond Position:  [-34.54666823]


portfolio before change:  [-29.8443937]
curr_Stock_Price:  102.84797674681627
curr_Factors:  [102.84797675]
mat_Sqrt:  [[0.15]]
grads:  [0.00678176]
Stock Position:  0.006781764687569056
Bond Position:  [-30.54188447]


portfolio before change:  [-29.84513357]
curr_Stock_Price:  103.30185660906136
curr_Factors:  [103.30185661]
mat_Sqrt:  [[0.15]]
grads:  [0.02937408]
Stock Position:  0.029374079398220062
Bond Position:  [-32.8795305]


portfolio before change:  [-29.85225111]
curr_Stock_Price:  103.19947572798907
curr_Factors:  [103.19947573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03865386]
Stock Position:  -0.038653857542640994
Bond Position:  [-25.86319327]


portfolio before change:  [-29.90453824]
curr_Stock_Price:  104.46853476855172
curr_Factors:  [104.46853477]
mat_Sqrt:  [[0.15]]
grads:  [-0.1087024]
Stock Position:  -0.10870240028405774
Bond Position:  [-18.54855775]


portfolio before change:  [-29.7978123]
curr_Stock_Price:  103.46538623735655
curr_Factors:  [103.46538624]
mat_Sqrt:  [[0.15]]
grads:  [0.04931245]
Stock Position:  0.04931244950753968
Bond Position:  [-34.89994393]


portfolio before change:  [-29.8038799]
curr_Stock_Price:  103.43081408240778
curr_Factors:  [103.43081408]
mat_Sqrt:  [[0.15]]
grads:  [-0.0022563]
Stock Position:  -0.0022562980423048522
Bond Position:  [-29.57050916]


portfolio before change:  [-29.80952105]
curr_Stock_Price:  104.29267074637659
curr_Factors:  [104.29267075]
mat_Sqrt:  [[0.15]]
grads:  [0.03432271]
Stock Position:  0.03432270703682727
Bond Position:  [-33.38912784]


portfolio before change:  [-29.82414152]
curr_Stock_Price:  103.98830750925543
curr_Factors:  [103.98830751]
mat_Sqrt:  [[0.15]]
grads:  [-0.13492539]
Stock Position:  -0.1349253932389819
Bond Position:  [-15.79347824]


portfolio before change:  [-29.76092597]
curr_Stock_Price:  103.50515262045973
curr_Factors:  [103.50515262]
mat_Sqrt:  [[0.15]]
grads:  [0.09519516]
Stock Position:  0.09519516054981697
Bond Position:  [-39.61411559]


portfolio before change:  [-29.71354135]
curr_Stock_Price:  104.05493571557835
curr_Factors:  [104.05493572]
mat_Sqrt:  [[0.15]]
grads:  [0.03634395]
Stock Position:  0.03634394916566981
Bond Position:  [-33.49530865]


portfolio before change:  [-29.750886]
curr_Stock_Price:  103.14261137295647
curr_Factors:  [103.14261137]
mat_Sqrt:  [[0.15]]
grads:  [0.13905564]
Stock Position:  0.13905564340512816
Bond Position:  [-44.09344818]


portfolio before change:  [-29.60667518]
curr_Stock_Price:  104.21932313148625
curr_Factors:  [104.21932313]
mat_Sqrt:  [[0.15]]
grads:  [0.06723777]
Stock Position:  0.067237770540984
Bond Position:  [-36.61415011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.68254886]
Stock Price:  103.15895742594302
PL:  [-32.84150628]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-8.36984454e-03]
 [ 4.03570054e-02]
 [-3.35846401e-03]
 [-2.91507664e-03]
 [-7.44189962e-03]
 [ 2.77974629e-02]
 [ 3.72399381e-03]
 [-1.36458006e-03]
 [-2.77582239e-02]
 [ 2.34422432e-02]
 [ 2.12572401e-02]
 [-4.50853711e-03]
 [-2.48858540e-02]
 [ 1.69809914e-02]
 [ 9.42640581e-03]
 [-2.48989230e-03]
 [-6.00699883e-03]
 [-7.53210381e-03]
 [ 1.80437259e-03]
 [ 2.85448087e-02]
 [-2.46561639e-02]
 [-2.78515520e-02]
 [ 3.73622465e-03]
 [-1.25919662e-02]
 [ 9.39947222e-03]
 [-1.76281909e-03]
 [ 2.75064225e-02]
 [-4.89196198e-03]
 [-5.07086840e-02]
 [-8.14724142e-03]
 [ 5.82835416e-02]
 [-7.21277881e-03]
 [-2.23121181e-02]
 [-1.29796472e-02]
 [-2.38744778e-02]
 [ 3.01528425e-02]
 [-1.21318909e-02]
 [-1.25284129e-02]
 [ 4.14234042e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.96752161]
curr_Stock_Price:  99.59673268351587
curr_Factors:  [99.59673268]
mat_Sqrt:  [[0.15]]
grads:  [-0.05579896]
Stock Position:  -0.05579896361116196
Bond Position:  [-1.41012715]


portfolio before change:  [-6.98681483]
curr_Stock_Price:  99.93933664823916
curr_Factors:  [99.93933665]
mat_Sqrt:  [[0.15]]
grads:  [0.2690467]
Stock Position:  0.26904670246344725
Bond Position:  [-33.87516381]


portfolio before change:  [-6.953042]
curr_Stock_Price:  100.08060390481262
curr_Factors:  [100.0806039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02238976]
Stock Position:  -0.022389760095261578
Bond Position:  [-4.71226129]


portfolio before change:  [-6.96245528]
curr_Stock_Price:  100.4747218038519
curr_Factors:  [100.4747218]
mat_Sqrt:  [[0.15]]
grads:  [-0.01943384]
Stock Position:  -0.01943384424832068
Bond Position:  [-5.00984518]


portfolio before change:  [-6.94750853]
curr_Stock_Price:  99.67338694949174
curr_Factors:  [99.67338695]
mat_Sqrt:  [[0.15]]
grads:  [-0.04961266]
Stock Position:  -0.049612664109569576
Bond Position:  [-2.00244626]


portfolio before change:  [-6.94637441]
curr_Stock_Price:  99.64548185710588
curr_Factors:  [99.64548186]
mat_Sqrt:  [[0.15]]
grads:  [0.18531642]
Stock Position:  0.18531641919250036
Bond Position:  [-25.41231829]


portfolio before change:  [-6.76826973]
curr_Stock_Price:  100.6237082794394
curr_Factors:  [100.62370828]
mat_Sqrt:  [[0.15]]
grads:  [0.02482663]
Stock Position:  0.02482662537052277
Bond Position:  [-9.26641684]


portfolio before change:  [-6.79725962]
curr_Stock_Price:  99.50267317337787
curr_Factors:  [99.50267317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0090972]
Stock Position:  -0.009097200383624774
Bond Position:  [-5.89206386]


portfolio before change:  [-6.79503054]
curr_Stock_Price:  99.17667885631506
curr_Factors:  [99.17667886]
mat_Sqrt:  [[0.15]]
grads:  [-0.18505483]
Stock Position:  -0.1850548259305907
Bond Position:  [11.5580925]


portfolio before change:  [-6.59900263]
curr_Stock_Price:  98.12519014807933
curr_Factors:  [98.12519015]
mat_Sqrt:  [[0.15]]
grads:  [0.15628162]
Stock Position:  0.15628162123798944
Bond Position:  [-21.93416643]


portfolio before change:  [-6.68489451]
curr_Stock_Price:  97.59313822118322
curr_Factors:  [97.59313822]
mat_Sqrt:  [[0.15]]
grads:  [0.14171493]
Stock Position:  0.1417149339794978
Bond Position:  [-20.51529965]


portfolio before change:  [-6.91700709]
curr_Stock_Price:  95.97335122678078
curr_Factors:  [95.97335123]
mat_Sqrt:  [[0.15]]
grads:  [-0.03005691]
Stock Position:  -0.030056914070066706
Bond Position:  [-4.03234432]


portfolio before change:  [-6.90894594]
curr_Stock_Price:  95.68838458528164
curr_Factors:  [95.68838459]
mat_Sqrt:  [[0.15]]
grads:  [-0.16590569]
Stock Position:  -0.16590569349467243
Bond Position:  [8.96630186]


portfolio before change:  [-6.80184334]
curr_Stock_Price:  95.0495774270854
curr_Factors:  [95.04957743]
mat_Sqrt:  [[0.15]]
grads:  [0.11320661]
Stock Position:  0.11320660962635994
Bond Position:  [-17.56208375]


portfolio before change:  [-6.93532881]
curr_Stock_Price:  93.88983885807856
curr_Factors:  [93.88983886]
mat_Sqrt:  [[0.15]]
grads:  [0.06284271]
Stock Position:  0.06284270537082783
Bond Position:  [-12.83562029]


portfolio before change:  [-6.92030412]
curr_Stock_Price:  94.15445576026448
curr_Factors:  [94.15445576]
mat_Sqrt:  [[0.15]]
grads:  [-0.01659928]
Stock Position:  -0.016599281987679643
Bond Position:  [-5.35740776]


portfolio before change:  [-6.91245366]
curr_Stock_Price:  93.64116958960233
curr_Factors:  [93.64116959]
mat_Sqrt:  [[0.15]]
grads:  [-0.04004666]
Stock Position:  -0.04004665886737247
Bond Position:  [-3.16243768]


portfolio before change:  [-6.96342066]
curr_Stock_Price:  94.90398830107195
curr_Factors:  [94.9039883]
mat_Sqrt:  [[0.15]]
grads:  [-0.05021403]
Stock Position:  -0.05021402540099743
Bond Position:  [-2.19790938]


portfolio before change:  [-6.94625903]
curr_Stock_Price:  94.55674705495623
curr_Factors:  [94.55674705]
mat_Sqrt:  [[0.15]]
grads:  [0.01202915]
Stock Position:  0.0120291506262392
Bond Position:  [-8.08369639]


portfolio before change:  [-6.96205213]
curr_Stock_Price:  93.32785100644206
curr_Factors:  [93.32785101]
mat_Sqrt:  [[0.15]]
grads:  [0.19029872]
Stock Position:  0.19029872470330597
Bond Position:  [-24.72222316]


portfolio before change:  [-6.99327225]
curr_Stock_Price:  93.18003264594792
curr_Factors:  [93.18003265]
mat_Sqrt:  [[0.15]]
grads:  [-0.16437443]
Stock Position:  -0.16437442586165918
Bond Position:  [8.32314212]


portfolio before change:  [-6.91343654]
curr_Stock_Price:  92.70066822554163
curr_Factors:  [92.70066823]
mat_Sqrt:  [[0.15]]
grads:  [-0.18567701]
Stock Position:  -0.1856770132115454
Bond Position:  [10.29894666]


portfolio before change:  [-6.989722]
curr_Stock_Price:  93.11845237517397
curr_Factors:  [93.11845238]
mat_Sqrt:  [[0.15]]
grads:  [0.02490816]
Stock Position:  0.024908164339077905
Bond Position:  [-9.30913172]


portfolio before change:  [-6.96903353]
curr_Stock_Price:  93.99576256531053
curr_Factors:  [93.99576257]
mat_Sqrt:  [[0.15]]
grads:  [-0.08394644]
Stock Position:  -0.08394644163643002
Bond Position:  [0.92157626]


portfolio before change:  [-6.93223873]
curr_Stock_Price:  93.55882207289753
curr_Factors:  [93.55882207]
mat_Sqrt:  [[0.15]]
grads:  [0.06266315]
Stock Position:  0.06266314815533534
Bond Position:  [-12.79492906]


portfolio before change:  [-6.89331461]
curr_Stock_Price:  94.20551131195165
curr_Factors:  [94.20551131]
mat_Sqrt:  [[0.15]]
grads:  [-0.01175213]
Stock Position:  -0.011752127288891183
Bond Position:  [-5.78619945]


portfolio before change:  [-6.90148751]
curr_Stock_Price:  94.83940322322302
curr_Factors:  [94.83940322]
mat_Sqrt:  [[0.15]]
grads:  [0.18337615]
Stock Position:  0.1833761497144237
Bond Position:  [-24.29277211]


portfolio before change:  [-6.94367923]
curr_Stock_Price:  94.6258807247512
curr_Factors:  [94.62588072]
mat_Sqrt:  [[0.15]]
grads:  [-0.03261308]
Stock Position:  -0.03261307988242637
Bond Position:  [-3.85763782]


portfolio before change:  [-6.90684874]
curr_Stock_Price:  93.48177768254959
curr_Factors:  [93.48177768]
mat_Sqrt:  [[0.15]]
grads:  [-0.33805789]
Stock Position:  -0.33805789341718046
Bond Position:  [24.6954041]


portfolio before change:  [-6.9419315]
curr_Stock_Price:  93.59468697162716
curr_Factors:  [93.59468697]
mat_Sqrt:  [[0.15]]
grads:  [-0.05431494]
Stock Position:  -0.054314942830901644
Bond Position:  [-1.85834143]


portfolio before change:  [-6.88074266]
curr_Stock_Price:  92.46385375053974
curr_Factors:  [92.46385375]
mat_Sqrt:  [[0.15]]
grads:  [0.38855694]
Stock Position:  0.3885569442927181
Bond Position:  [-42.80821513]


portfolio before change:  [-7.03673884]
curr_Stock_Price:  92.07615044060876
curr_Factors:  [92.07615044]
mat_Sqrt:  [[0.15]]
grads:  [-0.04808519]
Stock Position:  -0.048085192070449125
Bond Position:  [-2.60923946]


portfolio before change:  [-7.08241732]
curr_Stock_Price:  93.0193162106817
curr_Factors:  [93.01931621]
mat_Sqrt:  [[0.15]]
grads:  [-0.14874745]
Stock Position:  -0.14874745384883561
Bond Position:  [6.75396912]


portfolio before change:  [-7.15482317]
curr_Stock_Price:  93.51176258656692
curr_Factors:  [93.51176259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08653098]
Stock Position:  -0.08653098106483614
Bond Position:  [0.93684139]


portfolio before change:  [-7.18123043]
curr_Stock_Price:  93.8182929876646
curr_Factors:  [93.81829299]
mat_Sqrt:  [[0.15]]
grads:  [-0.15916319]
Stock Position:  -0.1591631856031741
Bond Position:  [7.75118795]


portfolio before change:  [-7.03539782]
curr_Stock_Price:  92.90813497871395
curr_Factors:  [92.90813498]
mat_Sqrt:  [[0.15]]
grads:  [0.20101895]
Stock Position:  0.20101895013483606
Bond Position:  [-25.71169358]


portfolio before change:  [-7.13599359]
curr_Stock_Price:  92.42369504175372
curr_Factors:  [92.42369504]
mat_Sqrt:  [[0.15]]
grads:  [-0.08087927]
Stock Position:  -0.0808792725815957
Bond Position:  [0.33916763]


portfolio before change:  [-7.09206239]
curr_Stock_Price:  91.88104917753353
curr_Factors:  [91.88104918]
mat_Sqrt:  [[0.15]]
grads:  [-0.08352275]
Stock Position:  -0.08352275234554395
Bond Position:  [0.58209572]


portfolio before change:  [-7.15042951]
curr_Stock_Price:  92.58073737204387
curr_Factors:  [92.58073737]
mat_Sqrt:  [[0.15]]
grads:  [0.27615603]
Stock Position:  0.27615602817893237
Bond Position:  [-32.71715823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.2530454]
Stock Price:  92.22396085067345
PL:  [-7.2530454]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.06805378e-02]
 [ 2.70518450e-02]
 [-3.42017528e-03]
 [-2.20120805e-03]
 [-7.17247090e-03]
 [ 3.11120063e-02]
 [ 3.58732819e-03]
 [-1.33184640e-03]
 [-2.77312186e-02]
 [ 2.34459042e-02]
 [ 2.18647789e-02]
 [-2.53090419e-03]
 [-2.50096457e-02]
 [ 1.75989829e-02]
 [-3.65571330e-03]
 [-1.36002498e-03]
 [-6.11738526e-03]
 [-4.84494196e-03]
 [ 1.41710677e-03]
 [-1.35881288e-02]
 [-1.19370201e-02]
 [-2.39319068e-02]
 [ 4.02748761e-03]
 [-1.32954965e-02]
 [ 9.33298578e-03]
 [-3.74666194e-03]
 [ 3.68418422e-02]
 [-6.07699094e-03]
 [-6.12798441e-02]
 [-6.01640146e-03]
 [ 5.68854350e-02]
 [ 3.35354744e-04]
 [-1.78709007e-02]
 [-3.67868963e-02]
 [-2.31135678e-02]
 [ 3.93035039e-02]
 [-4.04307053e-04]
 [ 6.98029317e-03]
 [ 4.91897057e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.50830555]
curr_Stock_Price:  99.43546395607956
curr_Factors:  [99.43546396]
mat_Sqrt:  [[0.15]]
grads:  [-0.07120359]
Stock Position:  -0.07120358516517686
Bond Position:  [-3.42814402]


portfolio before change:  [-10.49021907]
curr_Stock_Price:  99.17543460196782
curr_Factors:  [99.1754346]
mat_Sqrt:  [[0.15]]
grads:  [0.18034563]
Stock Position:  0.18034563351024935
Bond Position:  [-28.37607565]


portfolio before change:  [-10.26125667]
curr_Stock_Price:  100.46467917664447
curr_Factors:  [100.46467918]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280117]
Stock Position:  -0.02280116850437437
Bond Position:  [-7.97054459]


portfolio before change:  [-10.26439517]
curr_Stock_Price:  100.55862705099969
curr_Factors:  [100.55862705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01467472]
Stock Position:  -0.014674720323590382
Bond Position:  [-8.78872545]


portfolio before change:  [-10.26322393]
curr_Stock_Price:  100.40394607856928
curr_Factors:  [100.40394608]
mat_Sqrt:  [[0.15]]
grads:  [-0.04781647]
Stock Position:  -0.04781647266490219
Bond Position:  [-5.46226139]


portfolio before change:  [-10.25951851]
curr_Stock_Price:  100.31217330390089
curr_Factors:  [100.3121733]
mat_Sqrt:  [[0.15]]
grads:  [0.20741338]
Stock Position:  0.20741337558199502
Bond Position:  [-31.06560499]


portfolio before change:  [-10.40439505]
curr_Stock_Price:  99.63240471770362
curr_Factors:  [99.63240472]
mat_Sqrt:  [[0.15]]
grads:  [0.02391552]
Stock Position:  0.023915521262454983
Bond Position:  [-12.78715594]


portfolio before change:  [-10.41366603]
curr_Stock_Price:  99.31158838525339
curr_Factors:  [99.31158839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00887898]
Stock Position:  -0.008878975988518398
Bond Position:  [-9.53188082]


portfolio before change:  [-10.41462343]
curr_Stock_Price:  99.28521570169738
curr_Factors:  [99.2852157]
mat_Sqrt:  [[0.15]]
grads:  [-0.18487479]
Stock Position:  -0.1848747905898562
Bond Position:  [7.94071003]


portfolio before change:  [-9.98417029]
curr_Stock_Price:  96.96223543692321
curr_Factors:  [96.96223544]
mat_Sqrt:  [[0.15]]
grads:  [0.15630603]
Stock Position:  0.1563060280017505
Bond Position:  [-25.13995218]


portfolio before change:  [-10.13726341]
curr_Stock_Price:  96.00289670025121
curr_Factors:  [96.0028967]
mat_Sqrt:  [[0.15]]
grads:  [0.14576519]
Stock Position:  0.1457651929122546
Bond Position:  [-24.13114417]


portfolio before change:  [-10.31008817]
curr_Stock_Price:  94.8379534087052
curr_Factors:  [94.83795341]
mat_Sqrt:  [[0.15]]
grads:  [-0.01687269]
Stock Position:  -0.01687269459719745
Bond Position:  [-8.70991635]


portfolio before change:  [-10.3251844]
curr_Stock_Price:  95.6681359802353
curr_Factors:  [95.66813598]
mat_Sqrt:  [[0.15]]
grads:  [-0.16673097]
Stock Position:  -0.16673097161225245
Bond Position:  [5.62565687]


portfolio before change:  [-10.30597242]
curr_Stock_Price:  95.55712647879228
curr_Factors:  [95.55712648]
mat_Sqrt:  [[0.15]]
grads:  [0.11732655]
Stock Position:  0.11732655239311078
Bond Position:  [-21.51736063]


portfolio before change:  [-10.35194069]
curr_Stock_Price:  95.18825491763705
curr_Factors:  [95.18825492]
mat_Sqrt:  [[0.15]]
grads:  [-0.02437142]
Stock Position:  -0.024371422019218367
Bond Position:  [-8.03206756]


portfolio before change:  [-10.35339153]
curr_Stock_Price:  95.20658634825581
curr_Factors:  [95.20658635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00906683]
Stock Position:  -0.009066833185342148
Bond Position:  [-9.49016929]


portfolio before change:  [-10.36973521]
curr_Stock_Price:  96.87832070000164
curr_Factors:  [96.8783207]
mat_Sqrt:  [[0.15]]
grads:  [-0.04078257]
Stock Position:  -0.040782568406177715
Bond Position:  [-6.41878847]


portfolio before change:  [-10.31804859]
curr_Stock_Price:  95.5912753799772
curr_Factors:  [95.59127538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229961]
Stock Position:  -0.032299613035255394
Bond Position:  [-7.23048739]


portfolio before change:  [-10.32551067]
curr_Stock_Price:  95.79431834890161
curr_Factors:  [95.79431835]
mat_Sqrt:  [[0.15]]
grads:  [0.00944738]
Stock Position:  0.00944737843975755
Bond Position:  [-11.23051585]


portfolio before change:  [-10.31905297]
curr_Stock_Price:  96.62646452693178
curr_Factors:  [96.62646453]
mat_Sqrt:  [[0.15]]
grads:  [-0.09058753]
Stock Position:  -0.09058752544464053
Bond Position:  [-1.56590066]


portfolio before change:  [-10.27219757]
curr_Stock_Price:  96.10706457913975
curr_Factors:  [96.10706458]
mat_Sqrt:  [[0.15]]
grads:  [-0.07958013]
Stock Position:  -0.0795801341759831
Bond Position:  [-2.62398447]


portfolio before change:  [-10.15146092]
curr_Stock_Price:  94.58577205359543
curr_Factors:  [94.58577205]
mat_Sqrt:  [[0.15]]
grads:  [-0.15954605]
Stock Position:  -0.15954604516627532
Bond Position:  [4.93932494]


portfolio before change:  [-10.04099205]
curr_Stock_Price:  93.89724720869874
curr_Factors:  [93.89724721]
mat_Sqrt:  [[0.15]]
grads:  [0.02684992]
Stock Position:  0.026849917421615917
Bond Position:  [-12.56212538]


portfolio before change:  [-10.05633779]
curr_Stock_Price:  93.38419616205778
curr_Factors:  [93.38419616]
mat_Sqrt:  [[0.15]]
grads:  [-0.08863664]
Stock Position:  -0.08863664314666016
Bond Position:  [-1.77907612]


portfolio before change:  [-10.06622271]
curr_Stock_Price:  93.49320887390407
curr_Factors:  [93.49320887]
mat_Sqrt:  [[0.15]]
grads:  [0.06221991]
Stock Position:  0.06221990518570252
Bond Position:  [-15.8833613]


portfolio before change:  [-10.11392135]
curr_Stock_Price:  92.7585067608577
curr_Factors:  [92.75850676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02497775]
Stock Position:  -0.024977746291724823
Bond Position:  [-7.7970229]


portfolio before change:  [-10.12447583]
curr_Stock_Price:  93.14203968209036
curr_Factors:  [93.14203968]
mat_Sqrt:  [[0.15]]
grads:  [0.24561228]
Stock Position:  0.24561228109795316
Bond Position:  [-33.00130466]


portfolio before change:  [-10.43831264]
curr_Stock_Price:  91.88106287564682
curr_Factors:  [91.88106288]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051327]
Stock Position:  -0.04051327292828564
Bond Position:  [-6.71591006]


portfolio before change:  [-10.45928038]
curr_Stock_Price:  92.37789273629568
curr_Factors:  [92.37789274]
mat_Sqrt:  [[0.15]]
grads:  [-0.40853229]
Stock Position:  -0.40853229432720267
Bond Position:  [27.28007208]


portfolio before change:  [-10.1568641]
curr_Stock_Price:  91.64598961441284
curr_Factors:  [91.64598961]
mat_Sqrt:  [[0.15]]
grads:  [-0.04010934]
Stock Position:  -0.04010934303534837
Bond Position:  [-6.48100367]


portfolio before change:  [-10.20141567]
curr_Stock_Price:  92.7365433566209
curr_Factors:  [92.73654336]
mat_Sqrt:  [[0.15]]
grads:  [0.37923623]
Stock Position:  0.37923623354640107
Bond Position:  [-45.37047309]


portfolio before change:  [-9.30992579]
curr_Stock_Price:  95.10224965377621
curr_Factors:  [95.10224965]
mat_Sqrt:  [[0.15]]
grads:  [0.0022357]
Stock Position:  0.0022356982934490397
Bond Position:  [-9.52254573]


portfolio before change:  [-9.30974116]
curr_Stock_Price:  95.71727992808977
curr_Factors:  [95.71727993]
mat_Sqrt:  [[0.15]]
grads:  [-0.11913934]
Stock Position:  -0.11913933828835765
Bond Position:  [2.09395223]


portfolio before change:  [-9.311485]
curr_Stock_Price:  95.73411400062139
curr_Factors:  [95.734114]
mat_Sqrt:  [[0.15]]
grads:  [-0.24524598]
Stock Position:  -0.2452459750476252
Bond Position:  [14.16692113]


portfolio before change:  [-9.38451762]
curr_Stock_Price:  96.03912857962108
curr_Factors:  [96.03912858]
mat_Sqrt:  [[0.15]]
grads:  [-0.15409045]
Stock Position:  -0.15409045178451541
Bond Position:  [5.41419509]


portfolio before change:  [-9.48167334]
curr_Stock_Price:  96.67403188900887
curr_Factors:  [96.67403189]
mat_Sqrt:  [[0.15]]
grads:  [0.26202336]
Stock Position:  0.2620233595342375
Bond Position:  [-34.81252796]


portfolio before change:  [-9.38689758]
curr_Stock_Price:  97.05234775993823
curr_Factors:  [97.05234776]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269538]
Stock Position:  -0.0026953803519393403
Bond Position:  [-9.12530459]


portfolio before change:  [-9.39083799]
curr_Stock_Price:  98.0910386355668
curr_Factors:  [98.09103864]
mat_Sqrt:  [[0.15]]
grads:  [0.04653529]
Stock Position:  0.04653528780812226
Bond Position:  [-13.9555327]


portfolio before change:  [-9.38670459]
curr_Stock_Price:  98.21735023018198
curr_Factors:  [98.21735023]
mat_Sqrt:  [[0.15]]
grads:  [0.03279314]
Stock Position:  0.03279313711203859
Bond Position:  [-12.60755962]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.39480303]
Stock Price:  98.01845504572846
PL:  [-9.39480303]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.17359986e-04]
 [ 1.90126615e-02]
 [-2.13490323e-03]
 [-5.27968125e-03]
 [-7.59035253e-03]
 [ 3.37640528e-02]
 [ 3.54452964e-03]
 [-1.43163557e-03]
 [-2.77235079e-02]
 [ 2.34045399e-02]
 [ 1.91672360e-02]
 [-1.47700739e-02]
 [ 1.76646569e-02]
 [ 6.34632809e-03]
 [ 7.92067035e-03]
 [-3.71446058e-03]
 [-6.00878171e-03]
 [ 5.38569124e-03]
 [ 6.92931655e-03]
 [ 9.65889500e-03]
 [-4.91780653e-03]
 [-4.43763289e-03]
 [ 6.19277048e-03]
 [-1.13018259e-02]
 [ 1.55105746e-03]
 [ 3.84210142e-03]
 [-1.72575913e-03]
 [-7.85992563e-04]
 [ 1.05527842e-03]
 [-6.61783767e-03]
 [-2.90976931e-02]
 [ 1.88488041e-02]
 [-4.29055364e-03]
 [-2.12047591e-02]
 [-2.16235454e-02]
 [ 2.91431104e-02]
 [ 3.36131757e-03]
 [ 7.65129215e-03]
 [ 5.37506995e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.00133113]
curr_Stock_Price:  99.18527833019013
curr_Factors:  [99.18527833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00611573]
Stock Position:  -0.006115733237382626
Bond Position:  [-15.39474043]


portfolio before change:  [-16.00160928]
curr_Stock_Price:  98.91608393273182
curr_Factors:  [98.91608393]
mat_Sqrt:  [[0.15]]
grads:  [0.12675108]
Stock Position:  0.1267510763967903
Bond Position:  [-28.53932939]


portfolio before change:  [-15.86825679]
curr_Stock_Price:  99.99631240108823
curr_Factors:  [99.9963124]
mat_Sqrt:  [[0.15]]
grads:  [-0.01423269]
Stock Position:  -0.014232688214200461
Bond Position:  [-14.44504046]


portfolio before change:  [-15.87223248]
curr_Stock_Price:  100.14877443563405
curr_Factors:  [100.14877444]
mat_Sqrt:  [[0.15]]
grads:  [-0.03519787]
Stock Position:  -0.0351978749893567
Bond Position:  [-12.34720844]


portfolio before change:  [-15.86717067]
curr_Stock_Price:  99.96111223246238
curr_Factors:  [99.96111223]
mat_Sqrt:  [[0.15]]
grads:  [-0.05060235]
Stock Position:  -0.05060235019764185
Bond Position:  [-10.80890346]


portfolio before change:  [-15.80685831]
curr_Stock_Price:  98.74252146141244
curr_Factors:  [98.74252146]
mat_Sqrt:  [[0.15]]
grads:  [0.22509369]
Stock Position:  0.2250936852945181
Bond Position:  [-38.03317636]


portfolio before change:  [-15.71200177]
curr_Stock_Price:  99.1850526700732
curr_Factors:  [99.18505267]
mat_Sqrt:  [[0.15]]
grads:  [0.0236302]
Stock Position:  0.023630197585046045
Bond Position:  [-18.05576416]


portfolio before change:  [-15.70495675]
curr_Stock_Price:  99.57870705587011
curr_Factors:  [99.57870706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954424]
Stock Position:  -0.009544237152473442
Bond Position:  [-14.75455396]


portfolio before change:  [-15.70429581]
curr_Stock_Price:  99.31620556930275
curr_Factors:  [99.31620557]
mat_Sqrt:  [[0.15]]
grads:  [-0.18482339]
Stock Position:  -0.18482338619023525
Bond Position:  [2.65166161]


portfolio before change:  [-15.76607786]
curr_Stock_Price:  99.65227518566428
curr_Factors:  [99.65227519]
mat_Sqrt:  [[0.15]]
grads:  [0.15603027]
Stock Position:  0.15603026604653591
Bond Position:  [-31.31484887]


portfolio before change:  [-15.73120471]
curr_Stock_Price:  99.90086634025829
curr_Factors:  [99.90086634]
mat_Sqrt:  [[0.15]]
grads:  [0.12778157]
Stock Position:  0.12778157359983097
Bond Position:  [-28.49669462]


portfolio before change:  [-15.81661055]
curr_Stock_Price:  99.26037083299238
curr_Factors:  [99.26037083]
mat_Sqrt:  [[0.15]]
grads:  [-0.09846716]
Stock Position:  -0.09846715905940549
Bond Position:  [-6.04272382]


portfolio before change:  [-15.85952727]
curr_Stock_Price:  99.68854750145313
curr_Factors:  [99.6885475]
mat_Sqrt:  [[0.15]]
grads:  [0.11776438]
Stock Position:  0.11776437933653748
Bond Position:  [-27.5992872]


portfolio before change:  [-15.95772616]
curr_Stock_Price:  98.88398533371061
curr_Factors:  [98.88398533]
mat_Sqrt:  [[0.15]]
grads:  [0.04230885]
Stock Position:  0.042308853931099996
Bond Position:  [-20.14139426]


portfolio before change:  [-15.8925197]
curr_Stock_Price:  100.48469737972387
curr_Factors:  [100.48469738]
mat_Sqrt:  [[0.15]]
grads:  [0.05280447]
Stock Position:  0.05280446902084323
Bond Position:  [-21.19856079]


portfolio before change:  [-15.8655037]
curr_Stock_Price:  101.04650574651642
curr_Factors:  [101.04650575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476307]
Stock Position:  -0.024763070544785288
Bond Position:  [-13.36328195]


portfolio before change:  [-15.86386429]
curr_Stock_Price:  100.91284210852807
curr_Factors:  [100.91284211]
mat_Sqrt:  [[0.15]]
grads:  [-0.04005854]
Stock Position:  -0.04005854471138835
Bond Position:  [-11.82144269]


portfolio before change:  [-15.83788059]
curr_Stock_Price:  100.22730854541717
curr_Factors:  [100.22730855]
mat_Sqrt:  [[0.15]]
grads:  [0.03590461]
Stock Position:  0.03590460829783913
Bond Position:  [-19.43650284]


portfolio before change:  [-15.82547592]
curr_Stock_Price:  100.64046941533805
curr_Factors:  [100.64046942]
mat_Sqrt:  [[0.15]]
grads:  [0.04619544]
Stock Position:  0.04619544368928151
Bond Position:  [-20.47460706]


portfolio before change:  [-15.81141475]
curr_Stock_Price:  101.00025935244207
curr_Factors:  [101.00025935]
mat_Sqrt:  [[0.15]]
grads:  [0.06439263]
Stock Position:  0.06439263336366126
Bond Position:  [-22.31508742]


portfolio before change:  [-15.85279544]
curr_Stock_Price:  100.40094970179577
curr_Factors:  [100.4009497]
mat_Sqrt:  [[0.15]]
grads:  [-0.03278538]
Stock Position:  -0.03278537686964096
Bond Position:  [-12.56111246]


portfolio before change:  [-15.86582897]
curr_Stock_Price:  100.75059616094921
curr_Factors:  [100.75059616]
mat_Sqrt:  [[0.15]]
grads:  [-0.02958422]
Stock Position:  -0.02958421926840705
Bond Position:  [-12.88520124]


portfolio before change:  [-15.86579396]
curr_Stock_Price:  100.69496643456448
curr_Factors:  [100.69496643]
mat_Sqrt:  [[0.15]]
grads:  [0.04128514]
Stock Position:  0.041285136511557574
Bond Position:  [-20.02299939]


portfolio before change:  [-15.84441895]
curr_Stock_Price:  101.27333530971985
curr_Factors:  [101.27333531]
mat_Sqrt:  [[0.15]]
grads:  [-0.07534551]
Stock Position:  -0.07534550620216336
Bond Position:  [-8.21392824]


portfolio before change:  [-15.9318315]
curr_Stock_Price:  102.4198634813305
curr_Factors:  [102.41986348]
mat_Sqrt:  [[0.15]]
grads:  [0.01034038]
Stock Position:  0.010340383087248373
Bond Position:  [-16.99089212]


portfolio before change:  [-15.92635539]
curr_Stock_Price:  103.1548559812517
curr_Factors:  [103.15485598]
mat_Sqrt:  [[0.15]]
grads:  [0.02561401]
Stock Position:  0.025614009494933764
Bond Position:  [-18.56856485]


portfolio before change:  [-15.9522722]
curr_Stock_Price:  102.23365706808738
curr_Factors:  [102.23365707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01150506]
Stock Position:  -0.011505060847402555
Bond Position:  [-14.77606776]


portfolio before change:  [-15.94297716]
curr_Stock_Price:  101.2651991569015
curr_Factors:  [101.26519916]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523995]
Stock Position:  -0.005239950419995314
Bond Position:  [-15.41235254]


portfolio before change:  [-15.94380631]
curr_Stock_Price:  101.05574722440477
curr_Factors:  [101.05574722]
mat_Sqrt:  [[0.15]]
grads:  [0.00703519]
Stock Position:  0.007035189499594675
Bond Position:  [-16.65475264]


portfolio before change:  [-15.94476374]
curr_Stock_Price:  101.21559215475955
curr_Factors:  [101.21559215]
mat_Sqrt:  [[0.15]]
grads:  [-0.04411892]
Stock Position:  -0.04411891777914034
Bond Position:  [-11.47924135]


portfolio before change:  [-15.92402813]
curr_Stock_Price:  100.713072878207
curr_Factors:  [100.71307288]
mat_Sqrt:  [[0.15]]
grads:  [-0.19398462]
Stock Position:  -0.19398462061314733
Bond Position:  [3.6127591]


portfolio before change:  [-15.98204403]
curr_Stock_Price:  101.01447573668347
curr_Factors:  [101.01447574]
mat_Sqrt:  [[0.15]]
grads:  [0.12565869]
Stock Position:  0.1256586937771268
Bond Position:  [-28.6753911]


portfolio before change:  [-15.99754346]
curr_Stock_Price:  100.91965708108509
curr_Factors:  [100.91965708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02860369]
Stock Position:  -0.028603690964475802
Bond Position:  [-13.11086878]


portfolio before change:  [-15.97638739]
curr_Stock_Price:  100.12273095776335
curr_Factors:  [100.12273096]
mat_Sqrt:  [[0.15]]
grads:  [-0.14136506]
Stock Position:  -0.14136506074654256
Bond Position:  [-1.82253145]


portfolio before change:  [-15.92686085]
curr_Stock_Price:  99.7707743252915
curr_Factors:  [99.77077433]
mat_Sqrt:  [[0.15]]
grads:  [-0.14415697]
Stock Position:  -0.14415696910373813
Bond Position:  [-1.54420842]


portfolio before change:  [-15.95533825]
curr_Stock_Price:  99.96697961851031
curr_Factors:  [99.96697962]
mat_Sqrt:  [[0.15]]
grads:  [0.1942874]
Stock Position:  0.1942874023612282
Bond Position:  [-35.37766304]


portfolio before change:  [-16.23200308]
curr_Stock_Price:  98.56574445303116
curr_Factors:  [98.56574445]
mat_Sqrt:  [[0.15]]
grads:  [0.02240878]
Stock Position:  0.02240878377190407
Bond Position:  [-18.44074153]


portfolio before change:  [-16.22737918]
curr_Stock_Price:  98.87495964726766
curr_Factors:  [98.87495965]
mat_Sqrt:  [[0.15]]
grads:  [0.05100861]
Stock Position:  0.05100861434001022
Bond Position:  [-21.27085386]


portfolio before change:  [-16.19241968]
curr_Stock_Price:  99.61245318166208
curr_Factors:  [99.61245318]
mat_Sqrt:  [[0.15]]
grads:  [0.0358338]
Stock Position:  0.03583379966940858
Bond Position:  [-19.76191237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.17928841]
Stock Price:  100.04784274343625
PL:  [-16.22713115]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 9.92322504e-03]
 [ 4.28247218e-02]
 [-3.37016326e-03]
 [-2.23594655e-03]
 [-4.80652065e-03]
 [ 2.84291440e-02]
 [ 3.61019136e-03]
 [-1.13363956e-03]
 [-1.85100543e-02]
 [ 2.34410788e-02]
 [ 2.00483986e-02]
 [-1.37588173e-02]
 [ 1.07424302e-02]
 [ 6.39646997e-03]
 [-1.68277060e-02]
 [ 4.79949167e-04]
 [-6.10318153e-03]
 [-2.82937572e-03]
 [ 1.63550800e-03]
 [ 8.40040341e-03]
 [-1.57185228e-02]
 [-2.07291445e-02]
 [ 5.62426847e-03]
 [-9.99673041e-03]
 [ 1.25533357e-02]
 [ 4.53985484e-03]
 [ 1.79735768e-02]
 [-4.27884106e-03]
 [-3.57972579e-02]
 [-9.51861799e-03]
 [ 4.07446242e-02]
 [ 2.70529518e-03]
 [-1.54759277e-02]
 [-4.65054583e-02]
 [-2.29691359e-02]
 [ 3.82828521e-02]
 [-3.17182114e-03]
 [ 2.48480571e-03]
 [ 1.27777325e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.47141754]
curr_Stock_Price:  99.8015124708569
curr_Factors:  [99.80151247]
mat_Sqrt:  [[0.15]]
grads:  [0.06615483]
Stock Position:  0.06615483362104449
Bond Position:  [-9.07376999]


portfolio before change:  [-2.42136699]
curr_Stock_Price:  100.57522521924359
curr_Factors:  [100.57522522]
mat_Sqrt:  [[0.15]]
grads:  [0.28549815]
Stock Position:  0.2854981455503437
Bond Position:  [-31.13540728]


portfolio before change:  [-2.4579347]
curr_Stock_Price:  100.46077425804594
curr_Factors:  [100.46077426]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246776]
Stock Position:  -0.022467755065116238
Bond Position:  [-0.20080663]


portfolio before change:  [-2.46905102]
curr_Stock_Price:  100.95442475581058
curr_Factors:  [100.95442476]
mat_Sqrt:  [[0.15]]
grads:  [-0.01490631]
Stock Position:  -0.014906310339968682
Bond Position:  [-0.96419303]


portfolio before change:  [-2.46571111]
curr_Stock_Price:  100.72227848945354
curr_Factors:  [100.72227849]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204347]
Stock Position:  -0.03204347098101946
Bond Position:  [0.7617803]


portfolio before change:  [-2.41887542]
curr_Stock_Price:  99.2636206823556
curr_Factors:  [99.26362068]
mat_Sqrt:  [[0.15]]
grads:  [0.18952763]
Stock Position:  0.1895276265354173
Bond Position:  [-21.23207385]


portfolio before change:  [-2.32582008]
curr_Stock_Price:  99.76861045668211
curr_Factors:  [99.76861046]
mat_Sqrt:  [[0.15]]
grads:  [0.02406794]
Stock Position:  0.02406794240274289
Bond Position:  [-4.72704525]


portfolio before change:  [-2.37002127]
curr_Stock_Price:  97.95664526579574
curr_Factors:  [97.95664527]
mat_Sqrt:  [[0.15]]
grads:  [-0.0075576]
Stock Position:  -0.00755759705070145
Bond Position:  [-1.62970442]


portfolio before change:  [-2.37339259]
curr_Stock_Price:  98.37577154948018
curr_Factors:  [98.37577155]
mat_Sqrt:  [[0.15]]
grads:  [-0.12340036]
Stock Position:  -0.12340036176897869
Bond Position:  [9.76621321]


portfolio before change:  [-2.38689112]
curr_Stock_Price:  98.49505311310661
curr_Factors:  [98.49505311]
mat_Sqrt:  [[0.15]]
grads:  [0.15627386]
Stock Position:  0.15627385897697896
Bond Position:  [-17.77909316]


portfolio before change:  [-2.29047052]
curr_Stock_Price:  99.126272764557
curr_Factors:  [99.12627276]
mat_Sqrt:  [[0.15]]
grads:  [0.13365599]
Stock Position:  0.1336559904863032
Bond Position:  [-15.53929069]


portfolio before change:  [-2.32994659]
curr_Stock_Price:  98.84545081194574
curr_Factors:  [98.84545081]
mat_Sqrt:  [[0.15]]
grads:  [-0.09172545]
Stock Position:  -0.0917254486844029
Bond Position:  [6.73669674]


portfolio before change:  [-2.34169456]
curr_Stock_Price:  98.98270948321307
curr_Factors:  [98.98270948]
mat_Sqrt:  [[0.15]]
grads:  [0.0716162]
Stock Position:  0.07161620128730187
Bond Position:  [-9.43046021]


portfolio before change:  [-2.33187851]
curr_Stock_Price:  99.13623524945335
curr_Factors:  [99.13623525]
mat_Sqrt:  [[0.15]]
grads:  [0.04264313]
Stock Position:  0.042643133127153295
Bond Position:  [-6.55935819]


portfolio before change:  [-2.39292234]
curr_Stock_Price:  97.7239595812426
curr_Factors:  [97.72395958]
mat_Sqrt:  [[0.15]]
grads:  [-0.11218471]
Stock Position:  -0.11218470654304265
Bond Position:  [8.57021139]


portfolio before change:  [-2.34627928]
curr_Stock_Price:  97.3177391690003
curr_Factors:  [97.31773917]
mat_Sqrt:  [[0.15]]
grads:  [0.00319966]
Stock Position:  0.0031996611163607534
Bond Position:  [-2.65766306]


portfolio before change:  [-2.34935026]
curr_Stock_Price:  96.46178731288428
curr_Factors:  [96.46178731]
mat_Sqrt:  [[0.15]]
grads:  [-0.04068788]
Stock Position:  -0.040687876844876854
Bond Position:  [1.57547506]


portfolio before change:  [-2.33470925]
curr_Stock_Price:  96.10679052434065
curr_Factors:  [96.10679052]
mat_Sqrt:  [[0.15]]
grads:  [-0.0188625]
Stock Position:  -0.01886250478694937
Bond Position:  [-0.52189445]


portfolio before change:  [-2.32029674]
curr_Stock_Price:  95.33924919205766
curr_Factors:  [95.33924919]
mat_Sqrt:  [[0.15]]
grads:  [0.01090339]
Stock Position:  0.010903386692266941
Bond Position:  [-3.35981744]


portfolio before change:  [-2.32545187]
curr_Stock_Price:  94.90496885221387
curr_Factors:  [94.90496885]
mat_Sqrt:  [[0.15]]
grads:  [0.05600269]
Stock Position:  0.05600268941800833
Bond Position:  [-7.64038536]


portfolio before change:  [-2.3078216]
curr_Stock_Price:  95.23683469782401
curr_Factors:  [95.2368347]
mat_Sqrt:  [[0.15]]
grads:  [-0.10479015]
Stock Position:  -0.1047901517207565
Bond Position:  [7.67206076]


portfolio before change:  [-2.40004878]
curr_Stock_Price:  96.12610008713912
curr_Factors:  [96.12610009]
mat_Sqrt:  [[0.15]]
grads:  [-0.1381943]
Stock Position:  -0.13819429677726522
Bond Position:  [10.88403002]


portfolio before change:  [-2.45385697]
curr_Stock_Price:  96.52531177394064
curr_Factors:  [96.52531177]
mat_Sqrt:  [[0.15]]
grads:  [0.03749512]
Stock Position:  0.037495123133193246
Bond Position:  [-6.07308542]


portfolio before change:  [-2.45480336]
curr_Stock_Price:  96.52031916411251
curr_Factors:  [96.52031916]
mat_Sqrt:  [[0.15]]
grads:  [-0.06664487]
Stock Position:  -0.06664486942232038
Bond Position:  [3.97778071]


portfolio before change:  [-2.47302321]
curr_Stock_Price:  96.80116758059776
curr_Factors:  [96.80116758]
mat_Sqrt:  [[0.15]]
grads:  [0.0836889]
Stock Position:  0.08368890474127981
Bond Position:  [-10.5742069]


portfolio before change:  [-2.41963716]
curr_Stock_Price:  97.45487313832962
curr_Factors:  [97.45487314]
mat_Sqrt:  [[0.15]]
grads:  [0.0302657]
Stock Position:  0.030265698948886404
Bond Position:  [-5.36917702]


portfolio before change:  [-2.44700907]
curr_Stock_Price:  96.57266270305611
curr_Factors:  [96.5726627]
mat_Sqrt:  [[0.15]]
grads:  [0.11982385]
Stock Position:  0.11982384515823138
Bond Position:  [-14.01871685]


portfolio before change:  [-2.51186596]
curr_Stock_Price:  96.04601922433423
curr_Factors:  [96.04601922]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852561]
Stock Position:  -0.028525607082647057
Bond Position:  [0.22790504]


portfolio before change:  [-2.48310854]
curr_Stock_Price:  95.03889143180466
curr_Factors:  [95.03889143]
mat_Sqrt:  [[0.15]]
grads:  [-0.23864839]
Stock Position:  -0.23864838611308453
Bond Position:  [20.19776952]


portfolio before change:  [-2.48236248]
curr_Stock_Price:  95.04634513465928
curr_Factors:  [95.04634513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06345745]
Stock Position:  -0.06345745327729539
Bond Position:  [3.54903653]


portfolio before change:  [-2.55495473]
curr_Stock_Price:  96.19728812824695
curr_Factors:  [96.19728813]
mat_Sqrt:  [[0.15]]
grads:  [0.27163083]
Stock Position:  0.2716308281227611
Bond Position:  [-28.68510377]


portfolio before change:  [-2.65978309]
curr_Stock_Price:  95.82456719887745
curr_Factors:  [95.8245672]
mat_Sqrt:  [[0.15]]
grads:  [0.0180353]
Stock Position:  0.018035301196513837
Bond Position:  [-4.38800802]


portfolio before change:  [-2.64747827]
curr_Stock_Price:  96.53724456485939
curr_Factors:  [96.53724456]
mat_Sqrt:  [[0.15]]
grads:  [-0.10317285]
Stock Position:  -0.1031728512318542
Bond Position:  [7.3125445]


portfolio before change:  [-2.67136815]
curr_Stock_Price:  96.77765668180955
curr_Factors:  [96.77765668]
mat_Sqrt:  [[0.15]]
grads:  [-0.31003639]
Stock Position:  -0.3100363884637866
Bond Position:  [27.33322701]


portfolio before change:  [-2.56967561]
curr_Stock_Price:  96.46067559213893
curr_Factors:  [96.46067559]
mat_Sqrt:  [[0.15]]
grads:  [-0.15312757]
Stock Position:  -0.1531275728598896
Bond Position:  [12.20111352]


portfolio before change:  [-2.52914277]
curr_Stock_Price:  96.20593631805251
curr_Factors:  [96.20593632]
mat_Sqrt:  [[0.15]]
grads:  [0.25521901]
Stock Position:  0.2552190139999734
Bond Position:  [-27.08272698]


portfolio before change:  [-2.61448379]
curr_Stock_Price:  95.88481813358136
curr_Factors:  [95.88481813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02114547]
Stock Position:  -0.021145474283558122
Bond Position:  [-0.58695383]


portfolio before change:  [-2.62827516]
curr_Stock_Price:  96.5335618083931
curr_Factors:  [96.53356181]
mat_Sqrt:  [[0.15]]
grads:  [0.01656537]
Stock Position:  0.016565371389589183
Bond Position:  [-4.22738946]


portfolio before change:  [-2.6263094]
curr_Stock_Price:  96.68412944375122
curr_Factors:  [96.68412944]
mat_Sqrt:  [[0.15]]
grads:  [0.08518488]
Stock Position:  0.0851848833332982
Bond Position:  [-10.86233569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.58435214]
Stock Price:  97.19261332752477
PL:  [-2.58435214]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.49465922e-02]
 [-9.95455757e-02]
 [ 2.81013779e-02]
 [ 1.04973157e-02]
 [ 2.74324432e-03]
 [ 2.88928805e-02]
 [ 3.47885941e-03]
 [ 2.48913877e-02]
 [-5.92442063e-03]
 [ 2.28026115e-02]
 [ 1.69441936e-02]
 [-7.53842184e-03]
 [ 1.83430214e-02]
 [ 2.33236874e-02]
 [-1.19193185e-02]
 [-2.83342721e-03]
 [-5.75456098e-03]
 [ 7.25631031e-03]
 [ 1.70734641e-02]
 [ 1.74644325e-02]
 [ 3.90001130e-04]
 [-6.18005801e-03]
 [ 5.56857694e-03]
 [-1.08543467e-02]
 [-1.36648665e-03]
 [ 4.52842460e-03]
 [ 6.83530106e-03]
 [ 1.85051261e-03]
 [ 5.32447010e-03]
 [-5.41206462e-03]
 [-1.88517071e-02]
 [ 7.22593391e-03]
 [-6.58170182e-04]
 [-1.44448124e-02]
 [-2.02363222e-02]
 [ 4.44826422e-03]
 [ 4.27214352e-03]
 [ 2.31523409e-02]
 [ 1.04370378e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.44258623]
curr_Stock_Price:  100.70851671095693
curr_Factors:  [100.70851671]
mat_Sqrt:  [[0.15]]
grads:  [-0.23297728]
Stock Position:  -0.23297728141815868
Bond Position:  [40.90538267]


portfolio before change:  [16.83799286]
curr_Stock_Price:  103.32553950719814
curr_Factors:  [103.32553951]
mat_Sqrt:  [[0.15]]
grads:  [-0.66363717]
Stock Position:  -0.6636371710278064
Bond Position:  [85.4086616]


portfolio before change:  [16.52114701]
curr_Stock_Price:  103.81906612086745
curr_Factors:  [103.81906612]
mat_Sqrt:  [[0.15]]
grads:  [0.18734252]
Stock Position:  0.18734251923896938
Bond Position:  [-2.92857839]


portfolio before change:  [16.51831721]
curr_Stock_Price:  103.80591534477225
curr_Factors:  [103.80591534]
mat_Sqrt:  [[0.15]]
grads:  [0.0699821]
Stock Position:  0.06998210478492285
Bond Position:  [9.25376077]


portfolio before change:  [16.49537124]
curr_Stock_Price:  103.4615021350088
curr_Factors:  [103.46150214]
mat_Sqrt:  [[0.15]]
grads:  [0.0182883]
Stock Position:  0.018288295473682763
Bond Position:  [14.60323672]


portfolio before change:  [16.46090036]
curr_Stock_Price:  101.4768227859136
curr_Factors:  [101.47682279]
mat_Sqrt:  [[0.15]]
grads:  [0.1926192]
Stock Position:  0.19261920305281718
Bond Position:  [-3.08548437]


portfolio before change:  [16.67373864]
curr_Stock_Price:  102.58379441220858
curr_Factors:  [102.58379441]
mat_Sqrt:  [[0.15]]
grads:  [0.0231924]
Stock Position:  0.023192396042395997
Bond Position:  [14.29457465]


portfolio before change:  [16.68318072]
curr_Stock_Price:  102.91386549058316
curr_Factors:  [102.91386549]
mat_Sqrt:  [[0.15]]
grads:  [0.16594258]
Stock Position:  0.1659425846928721
Bond Position:  [-0.39461213]


portfolio before change:  [16.55519153]
curr_Stock_Price:  102.14287681678803
curr_Factors:  [102.14287682]
mat_Sqrt:  [[0.15]]
grads:  [-0.03949614]
Stock Position:  -0.039496137548815195
Bond Position:  [20.58944064]


portfolio before change:  [16.53635424]
curr_Stock_Price:  102.68498378025642
curr_Factors:  [102.68498378]
mat_Sqrt:  [[0.15]]
grads:  [0.15201741]
Stock Position:  0.15201741028601878
Bond Position:  [0.92644893]


portfolio before change:  [16.60934047]
curr_Stock_Price:  103.16433952972307
curr_Factors:  [103.16433953]
mat_Sqrt:  [[0.15]]
grads:  [0.11296129]
Stock Position:  0.11296129080463953
Bond Position:  [4.95576352]


portfolio before change:  [16.50122061]
curr_Stock_Price:  102.20171438561442
curr_Factors:  [102.20171439]
mat_Sqrt:  [[0.15]]
grads:  [-0.05025615]
Stock Position:  -0.05025614559884523
Bond Position:  [21.63748484]


portfolio before change:  [16.52748635]
curr_Stock_Price:  101.73289819519952
curr_Factors:  [101.7328982]
mat_Sqrt:  [[0.15]]
grads:  [0.12228681]
Stock Position:  0.12228680940246045
Bond Position:  [4.08689482]


portfolio before change:  [16.61066106]
curr_Stock_Price:  102.40888122040855
curr_Factors:  [102.40888122]
mat_Sqrt:  [[0.15]]
grads:  [0.15549125]
Stock Position:  0.15549124905156142
Bond Position:  [0.6869762]


portfolio before change:  [16.58558811]
curr_Stock_Price:  102.2470790267614
curr_Factors:  [102.24707903]
mat_Sqrt:  [[0.15]]
grads:  [-0.07946212]
Stock Position:  -0.07946212304673679
Bond Position:  [24.71035808]


portfolio before change:  [16.61110751]
curr_Stock_Price:  101.96480097774342
curr_Factors:  [101.96480098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01888951]
Stock Position:  -0.01888951470743834
Bond Position:  [18.53717312]


portfolio before change:  [16.61896006]
curr_Stock_Price:  101.67176762863673
curr_Factors:  [101.67176763]
mat_Sqrt:  [[0.15]]
grads:  [-0.03836374]
Stock Position:  -0.03836373988685807
Bond Position:  [20.51946931]


portfolio before change:  [16.59052828]
curr_Stock_Price:  102.47974073119894
curr_Factors:  [102.47974073]
mat_Sqrt:  [[0.15]]
grads:  [0.0483754]
Stock Position:  0.04837540208139085
Bond Position:  [11.63302962]


portfolio before change:  [16.61763235]
curr_Stock_Price:  103.00996578258572
curr_Factors:  [103.00996578]
mat_Sqrt:  [[0.15]]
grads:  [0.11382309]
Stock Position:  0.11382309394971045
Bond Position:  [4.89271934]


portfolio before change:  [16.52945977]
curr_Stock_Price:  102.22994650458637
curr_Factors:  [102.2299465]
mat_Sqrt:  [[0.15]]
grads:  [0.11642955]
Stock Position:  0.11642955003282071
Bond Position:  [4.6268731]


portfolio before change:  [16.66724233]
curr_Stock_Price:  103.40837722758775
curr_Factors:  [103.40837723]
mat_Sqrt:  [[0.15]]
grads:  [0.00260001]
Stock Position:  0.002600007534574371
Bond Position:  [16.39837977]


portfolio before change:  [16.67054086]
curr_Stock_Price:  103.88860963055592
curr_Factors:  [103.88860963]
mat_Sqrt:  [[0.15]]
grads:  [-0.04120039]
Stock Position:  -0.04120038676111708
Bond Position:  [20.95079176]


portfolio before change:  [16.653421]
curr_Stock_Price:  104.36770396938077
curr_Factors:  [104.36770397]
mat_Sqrt:  [[0.15]]
grads:  [0.03712385]
Stock Position:  0.03712384627630307
Bond Position:  [12.7788904]


portfolio before change:  [16.63411756]
curr_Stock_Price:  103.80469932469772
curr_Factors:  [103.80469932]
mat_Sqrt:  [[0.15]]
grads:  [-0.07236231]
Stock Position:  -0.07236231133454135
Bond Position:  [24.14566553]


portfolio before change:  [16.64994515]
curr_Stock_Price:  103.62768470821624
curr_Factors:  [103.62768471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00910991]
Stock Position:  -0.009109911015155927
Bond Position:  [17.59398413]


portfolio before change:  [16.64689824]
curr_Stock_Price:  104.20357296952088
curr_Factors:  [104.20357297]
mat_Sqrt:  [[0.15]]
grads:  [0.0301895]
Stock Position:  0.0301894973129839
Bond Position:  [13.50104476]


portfolio before change:  [16.67091747]
curr_Stock_Price:  104.94328350220906
curr_Factors:  [104.9432835]
mat_Sqrt:  [[0.15]]
grads:  [0.04556867]
Stock Position:  0.04556867373512046
Bond Position:  [11.88879122]


portfolio before change:  [16.64095953]
curr_Stock_Price:  104.25324515388519
curr_Factors:  [104.25324515]
mat_Sqrt:  [[0.15]]
grads:  [0.01233675]
Stock Position:  0.012336750742556371
Bond Position:  [15.35481323]


portfolio before change:  [16.64738585]
curr_Stock_Price:  104.61856410912807
curr_Factors:  [104.61856411]
mat_Sqrt:  [[0.15]]
grads:  [0.03549647]
Stock Position:  0.035496467366597256
Bond Position:  [12.9337964]


portfolio before change:  [16.61947525]
curr_Stock_Price:  103.78672288334974
curr_Factors:  [103.78672288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03608043]
Stock Position:  -0.03608043082397771
Bond Position:  [20.36414492]


portfolio before change:  [16.6585841]
curr_Stock_Price:  102.7733431286151
curr_Factors:  [102.77334313]
mat_Sqrt:  [[0.15]]
grads:  [-0.12567805]
Stock Position:  -0.1256780473141295
Bond Position:  [29.57493718]


portfolio before change:  [16.56003923]
curr_Stock_Price:  103.58686607120606
curr_Factors:  [103.58686607]
mat_Sqrt:  [[0.15]]
grads:  [0.04817289]
Stock Position:  0.04817289272030958
Bond Position:  [11.56996024]


portfolio before change:  [16.54844789]
curr_Stock_Price:  103.31622274920727
curr_Factors:  [103.31622275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0043878]
Stock Position:  -0.004387801212945104
Bond Position:  [17.00177894]


portfolio before change:  [16.5503504]
curr_Stock_Price:  103.36700956757711
curr_Factors:  [103.36700957]
mat_Sqrt:  [[0.15]]
grads:  [-0.09629875]
Stock Position:  -0.09629874922079942
Bond Position:  [26.50446414]


portfolio before change:  [16.49006848]
curr_Stock_Price:  104.02740433644608
curr_Factors:  [104.02740434]
mat_Sqrt:  [[0.15]]
grads:  [-0.13490881]
Stock Position:  -0.13490881463916488
Bond Position:  [30.52428229]


portfolio before change:  [16.44999654]
curr_Stock_Price:  104.35271823922193
curr_Factors:  [104.35271824]
mat_Sqrt:  [[0.15]]
grads:  [0.02965509]
Stock Position:  0.02965509482620317
Bond Position:  [13.35540678]


portfolio before change:  [16.43454939]
curr_Stock_Price:  103.77552641803113
curr_Factors:  [103.77552642]
mat_Sqrt:  [[0.15]]
grads:  [0.02848096]
Stock Position:  0.028480956831005086
Bond Position:  [13.4789231]


portfolio before change:  [16.43746529]
curr_Stock_Price:  103.81874575890062
curr_Factors:  [103.81874576]
mat_Sqrt:  [[0.15]]
grads:  [0.15434894]
Stock Position:  0.15434893964132518
Bond Position:  [0.41315197]


portfolio before change:  [16.43207861]
curr_Stock_Price:  103.78351175822573
curr_Factors:  [103.78351176]
mat_Sqrt:  [[0.15]]
grads:  [0.06958025]
Stock Position:  0.06958025167260079
Bond Position:  [9.21079574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.47063185]
Stock Price:  104.3210468137446
PL:  [12.14958504]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.84760305e-04]
 [ 2.45557391e-02]
 [-1.73630079e-02]
 [-6.78267133e-03]
 [-7.07826603e-03]
 [ 3.87694377e-02]
 [ 3.55172768e-03]
 [ 2.80749333e-04]
 [-2.38882856e-02]
 [ 2.34407271e-02]
 [ 2.09086098e-02]
 [-1.12997713e-02]
 [-6.13762351e-03]
 [ 1.47018329e-02]
 [-1.84034248e-02]
 [-9.55755454e-05]
 [-6.08665379e-03]
 [-5.40919651e-03]
 [ 1.30476005e-03]
 [ 6.76989887e-03]
 [-1.20675516e-02]
 [-2.10165979e-02]
 [ 4.98022152e-03]
 [-1.07553896e-02]
 [ 1.15471499e-02]
 [ 1.64587150e-03]
 [ 2.15624155e-02]
 [-4.30457103e-03]
 [-2.58978647e-02]
 [-1.12828491e-02]
 [ 3.76386935e-02]
 [ 5.29218939e-03]
 [-1.26497048e-02]
 [-4.62768926e-02]
 [-2.25581270e-02]
 [ 3.87946565e-02]
 [ 3.15411540e-03]
 [ 9.01614670e-03]
 [ 5.23632690e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.02978646]
curr_Stock_Price:  100.37089295123789
curr_Factors:  [100.37089295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00656507]
Stock Position:  -0.006565068697321405
Bond Position:  [10.68872826]


portfolio before change:  [10.03949956]
curr_Stock_Price:  99.09490817248873
curr_Factors:  [99.09490817]
mat_Sqrt:  [[0.15]]
grads:  [0.16370493]
Stock Position:  0.16370492717787888
Bond Position:  [-6.18282517]


portfolio before change:  [9.9774065]
curr_Stock_Price:  98.72033080486393
curr_Factors:  [98.7203308]
mat_Sqrt:  [[0.15]]
grads:  [-0.11575339]
Stock Position:  -0.11575338617201308
Bond Position:  [21.40461907]


portfolio before change:  [9.90424385]
curr_Stock_Price:  99.37550294815973
curr_Factors:  [99.37550295]
mat_Sqrt:  [[0.15]]
grads:  [-0.04521781]
Stock Position:  -0.045217808882832555
Bond Position:  [14.39778635]


portfolio before change:  [9.91161855]
curr_Stock_Price:  99.25221368276155
curr_Factors:  [99.25221368]
mat_Sqrt:  [[0.15]]
grads:  [-0.04718844]
Stock Position:  -0.047188440211958546
Bond Position:  [14.5951757]


portfolio before change:  [9.95615098]
curr_Stock_Price:  98.34716323745822
curr_Factors:  [98.34716324]
mat_Sqrt:  [[0.15]]
grads:  [0.25846292]
Stock Position:  0.2584629179082429
Bond Position:  [-15.4629438]


portfolio before change:  [9.6539253]
curr_Stock_Price:  97.18532270376102
curr_Factors:  [97.1853227]
mat_Sqrt:  [[0.15]]
grads:  [0.02367818]
Stock Position:  0.023678184502901885
Bond Position:  [7.3527533]


portfolio before change:  [9.66556558]
curr_Stock_Price:  97.63810757977576
curr_Factors:  [97.63810758]
mat_Sqrt:  [[0.15]]
grads:  [0.00187166]
Stock Position:  0.0018716622232855448
Bond Position:  [9.48282002]


portfolio before change:  [9.66896837]
curr_Stock_Price:  98.82281325127659
curr_Factors:  [98.82281325]
mat_Sqrt:  [[0.15]]
grads:  [-0.15925524]
Stock Position:  -0.15925523718672602
Bond Position:  [25.40701893]


portfolio before change:  [9.7065498]
curr_Stock_Price:  98.60677421081577
curr_Factors:  [98.60677421]
mat_Sqrt:  [[0.15]]
grads:  [0.15627151]
Stock Position:  0.15627151430232158
Bond Position:  [-5.70288013]


portfolio before change:  [9.66769592]
curr_Stock_Price:  98.36270557247931
curr_Factors:  [98.36270557]
mat_Sqrt:  [[0.15]]
grads:  [0.13939073]
Stock Position:  0.13939073203388064
Bond Position:  [-4.04315362]


portfolio before change:  [9.64179769]
curr_Stock_Price:  98.18053567243135
curr_Factors:  [98.18053567]
mat_Sqrt:  [[0.15]]
grads:  [-0.07533181]
Stock Position:  -0.0753318084913641
Bond Position:  [17.037915]


portfolio before change:  [9.67852927]
curr_Stock_Price:  97.72121171663858
curr_Factors:  [97.72121172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04091749]
Stock Position:  -0.04091749009451331
Bond Position:  [13.67703598]


portfolio before change:  [9.70927197]
curr_Stock_Price:  97.01166267400019
curr_Factors:  [97.01166267]
mat_Sqrt:  [[0.15]]
grads:  [0.09801222]
Stock Position:  0.09801221929135084
Bond Position:  [0.20094362]


portfolio before change:  [9.69229635]
curr_Stock_Price:  96.83820735221124
curr_Factors:  [96.83820735]
mat_Sqrt:  [[0.15]]
grads:  [-0.1226895]
Stock Position:  -0.12268949859152156
Bond Position:  [21.57332746]


portfolio before change:  [9.72917116]
curr_Stock_Price:  96.55963438033292
curr_Factors:  [96.55963438]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063717]
Stock Position:  -0.0006371703023568797
Bond Position:  [9.7906961]


portfolio before change:  [9.73076625]
curr_Stock_Price:  95.97710106915632
curr_Factors:  [95.97710107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057769]
Stock Position:  -0.040577691926742744
Bond Position:  [13.62529549]


portfolio before change:  [9.75398151]
curr_Stock_Price:  95.44695773612798
curr_Factors:  [95.44695774]
mat_Sqrt:  [[0.15]]
grads:  [-0.03606131]
Stock Position:  -0.03606131009448916
Bond Position:  [13.19592385]


portfolio before change:  [9.73466324]
curr_Stock_Price:  96.02840824745195
curr_Factors:  [96.02840825]
mat_Sqrt:  [[0.15]]
grads:  [0.0086984]
Stock Position:  0.00869840035809151
Bond Position:  [8.8993697]


portfolio before change:  [9.72711398]
curr_Stock_Price:  95.03262205263555
curr_Factors:  [95.03262205]
mat_Sqrt:  [[0.15]]
grads:  [0.04513266]
Stock Position:  0.045132659157382515
Bond Position:  [5.43803904]


portfolio before change:  [9.77493049]
curr_Stock_Price:  96.07702563412363
curr_Factors:  [96.07702563]
mat_Sqrt:  [[0.15]]
grads:  [-0.08045034]
Stock Position:  -0.08045034370008931
Bond Position:  [17.50436022]


portfolio before change:  [9.78429264]
curr_Stock_Price:  95.9878530348853
curr_Factors:  [95.98785303]
mat_Sqrt:  [[0.15]]
grads:  [-0.14011065]
Stock Position:  -0.1401106523917607
Bond Position:  [23.23321335]


portfolio before change:  [9.80868738]
curr_Stock_Price:  95.83447135893633
curr_Factors:  [95.83447136]
mat_Sqrt:  [[0.15]]
grads:  [0.03320148]
Stock Position:  0.03320147677666601
Bond Position:  [6.6268414]


portfolio before change:  [9.80643465]
curr_Stock_Price:  95.7416701976874
curr_Factors:  [95.7416702]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717026]
Stock Position:  -0.0717025972310496
Bond Position:  [16.67136107]


portfolio before change:  [9.8130631]
curr_Stock_Price:  95.67829171535351
curr_Factors:  [95.67829172]
mat_Sqrt:  [[0.15]]
grads:  [0.076981]
Stock Position:  0.07698099933132548
Bond Position:  [2.44765259]


portfolio before change:  [9.85628568]
curr_Stock_Price:  96.23578779903282
curr_Factors:  [96.2357878]
mat_Sqrt:  [[0.15]]
grads:  [0.01097248]
Stock Position:  0.010972476669641107
Bond Position:  [8.80034075]


portfolio before change:  [9.85392237]
curr_Stock_Price:  95.9201409968002
curr_Factors:  [95.920141]
mat_Sqrt:  [[0.15]]
grads:  [0.14374944]
Stock Position:  0.14374943661641057
Bond Position:  [-3.93454386]


portfolio before change:  [9.86295842]
curr_Stock_Price:  95.98642230253543
curr_Factors:  [95.9864223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869714]
Stock Position:  -0.028697140209081352
Bond Position:  [12.61749424]


portfolio before change:  [9.86206186]
curr_Stock_Price:  96.07262765187656
curr_Factors:  [96.07262765]
mat_Sqrt:  [[0.15]]
grads:  [-0.17265243]
Stock Position:  -0.17265243150224915
Bond Position:  [26.44923462]


portfolio before change:  [9.84181166]
curr_Stock_Price:  96.20906684129135
curr_Factors:  [96.20906684]
mat_Sqrt:  [[0.15]]
grads:  [-0.07521899]
Stock Position:  -0.07521899382502908
Bond Position:  [17.07856086]


portfolio before change:  [9.80386358]
curr_Stock_Price:  96.74195135225888
curr_Factors:  [96.74195135]
mat_Sqrt:  [[0.15]]
grads:  [0.25092462]
Stock Position:  0.2509246235193398
Bond Position:  [-14.47107414]


portfolio before change:  [9.7832317]
curr_Stock_Price:  96.66693725868205
curr_Factors:  [96.66693726]
mat_Sqrt:  [[0.15]]
grads:  [0.03528126]
Stock Position:  0.035281262624767745
Bond Position:  [6.3727001]


portfolio before change:  [9.81546866]
curr_Stock_Price:  97.55807111167545
curr_Factors:  [97.55807111]
mat_Sqrt:  [[0.15]]
grads:  [-0.08433137]
Stock Position:  -0.08433136527103346
Bond Position:  [18.04267399]


portfolio before change:  [9.88560726]
curr_Stock_Price:  96.75311415730337
curr_Factors:  [96.75311416]
mat_Sqrt:  [[0.15]]
grads:  [-0.30851262]
Stock Position:  -0.3085126172393834
Bond Position:  [39.73516373]


portfolio before change:  [9.61070556]
curr_Stock_Price:  97.66026959939785
curr_Factors:  [97.6602696]
mat_Sqrt:  [[0.15]]
grads:  [-0.15038751]
Stock Position:  -0.15038751361762864
Bond Position:  [24.29759069]


portfolio before change:  [9.48249288]
curr_Stock_Price:  98.53301539892486
curr_Factors:  [98.5330154]
mat_Sqrt:  [[0.15]]
grads:  [0.25863104]
Stock Position:  0.2586310434166996
Bond Position:  [-16.0012037]


portfolio before change:  [9.68373366]
curr_Stock_Price:  99.31884936608381
curr_Factors:  [99.31884937]
mat_Sqrt:  [[0.15]]
grads:  [0.02102744]
Stock Position:  0.021027436002343365
Bond Position:  [7.59531291]


portfolio before change:  [9.70155365]
curr_Stock_Price:  100.12115917238032
curr_Factors:  [100.12115917]
mat_Sqrt:  [[0.15]]
grads:  [0.06010764]
Stock Position:  0.06010764468722625
Bond Position:  [3.68350659]


portfolio before change:  [9.66617562]
curr_Stock_Price:  99.52492048377307
curr_Factors:  [99.52492048]
mat_Sqrt:  [[0.15]]
grads:  [0.03490885]
Stock Position:  0.03490884596781009
Bond Position:  [6.1918755]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.66544253]
Stock Price:  99.4817473426716
PL:  [9.66544253]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.06354340e-02]
 [-2.66597167e-02]
 [ 9.62324425e-03]
 [ 6.70722183e-04]
 [-1.77437518e-03]
 [ 1.09260666e-02]
 [ 3.47496356e-03]
 [ 2.27399000e-02]
 [ 3.39144601e-02]
 [ 2.27209804e-02]
 [ 1.74151202e-02]
 [-8.21938513e-03]
 [ 1.68333546e-03]
 [ 2.33686790e-02]
 [-1.08086434e-02]
 [-2.94454980e-03]
 [-5.97464861e-03]
 [ 6.38640473e-03]
 [ 1.11486426e-02]
 [ 1.50566020e-02]
 [-2.20963995e-03]
 [-5.07632488e-03]
 [ 4.32177419e-03]
 [-1.20222454e-02]
 [ 2.24117578e-03]
 [ 3.38563074e-03]
 [-2.25996748e-03]
 [-1.33689773e-03]
 [-1.00151729e-04]
 [-9.11218189e-03]
 [-2.94730544e-02]
 [ 1.64477267e-02]
 [-5.14917889e-03]
 [-1.94978174e-02]
 [-2.13383074e-02]
 [ 2.92488648e-02]
 [ 5.05782895e-03]
 [ 1.09301212e-02]
 [ 6.60902328e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.60353766]
curr_Stock_Price:  100.85248556739204
curr_Factors:  [100.85248557]
mat_Sqrt:  [[0.15]]
grads:  [-0.27090289]
Stock Position:  -0.2709028931676689
Bond Position:  [47.92476778]


portfolio before change:  [20.35537954]
curr_Stock_Price:  101.79064122471534
curr_Factors:  [101.79064122]
mat_Sqrt:  [[0.15]]
grads:  [-0.17773144]
Stock Position:  -0.1777314443678782
Bond Position:  [38.44677723]


portfolio before change:  [20.28680756]
curr_Stock_Price:  102.20350083170533
curr_Factors:  [102.20350083]
mat_Sqrt:  [[0.15]]
grads:  [0.06415496]
Stock Position:  0.06415496167277317
Bond Position:  [13.72994588]


portfolio before change:  [20.27404308]
curr_Stock_Price:  101.9777843791315
curr_Factors:  [101.97778438]
mat_Sqrt:  [[0.15]]
grads:  [0.00447148]
Stock Position:  0.004471481223211257
Bond Position:  [19.81805133]


portfolio before change:  [20.27609666]
curr_Stock_Price:  101.88299913075709
curr_Factors:  [101.88299913]
mat_Sqrt:  [[0.15]]
grads:  [-0.01182917]
Stock Position:  -0.01182916787050169
Bond Position:  [21.48128776]


portfolio before change:  [20.27467103]
curr_Stock_Price:  102.23052628744078
curr_Factors:  [102.23052629]
mat_Sqrt:  [[0.15]]
grads:  [0.07284044]
Stock Position:  0.07284044378622237
Bond Position:  [12.82815413]


portfolio before change:  [20.30682157]
curr_Stock_Price:  102.64989390476083
curr_Factors:  [102.6498939]
mat_Sqrt:  [[0.15]]
grads:  [0.02316642]
Stock Position:  0.0231664237594245
Bond Position:  [17.92879063]


portfolio before change:  [20.31038664]
curr_Stock_Price:  102.70703807741928
curr_Factors:  [102.70703808]
mat_Sqrt:  [[0.15]]
grads:  [0.15159933]
Stock Position:  0.1515993330490022
Bond Position:  [4.74006817]


portfolio before change:  [20.39628875]
curr_Stock_Price:  103.26976855591727
curr_Factors:  [103.26976856]
mat_Sqrt:  [[0.15]]
grads:  [0.2260964]
Stock Position:  0.22609640044281146
Bond Position:  [-2.9526342]


portfolio before change:  [20.37057437]
curr_Stock_Price:  103.15766913258574
curr_Factors:  [103.15766913]
mat_Sqrt:  [[0.15]]
grads:  [0.1514732]
Stock Position:  0.15147320236961187
Bond Position:  [4.74495188]


portfolio before change:  [20.32731386]
curr_Stock_Price:  102.8681547856558
curr_Factors:  [102.86815479]
mat_Sqrt:  [[0.15]]
grads:  [0.1161008]
Stock Position:  0.11610080159357296
Bond Position:  [8.38423863]


portfolio before change:  [20.2375023]
curr_Stock_Price:  102.08556195879187
curr_Factors:  [102.08556196]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547959]
Stock Position:  -0.054795900881211224
Bond Position:  [25.83137264]


portfolio before change:  [20.16746828]
curr_Stock_Price:  103.42258069819796
curr_Factors:  [103.4225807]
mat_Sqrt:  [[0.15]]
grads:  [0.01122224]
Stock Position:  0.011222236401421838
Bond Position:  [19.00683563]


portfolio before change:  [20.16758909]
curr_Stock_Price:  103.22162354914495
curr_Factors:  [103.22162355]
mat_Sqrt:  [[0.15]]
grads:  [0.15579119]
Stock Position:  0.1557911936542171
Bond Position:  [4.08656915]


portfolio before change:  [20.16069746]
curr_Stock_Price:  103.17410813991268
curr_Factors:  [103.17410814]
mat_Sqrt:  [[0.15]]
grads:  [-0.07205762]
Stock Position:  -0.07205762255543947
Bond Position:  [27.59517841]


portfolio before change:  [20.22885019]
curr_Stock_Price:  102.27617239112718
curr_Factors:  [102.27617239]
mat_Sqrt:  [[0.15]]
grads:  [-0.01963033]
Stock Position:  -0.019630332019527196
Bond Position:  [22.23656541]


portfolio before change:  [20.2525601]
curr_Stock_Price:  101.20995691873863
curr_Factors:  [101.20995692]
mat_Sqrt:  [[0.15]]
grads:  [-0.03983099]
Stock Position:  -0.03983099076110909
Bond Position:  [24.28385296]


portfolio before change:  [20.26120542]
curr_Stock_Price:  101.0691205413613
curr_Factors:  [101.06912054]
mat_Sqrt:  [[0.15]]
grads:  [0.04257603]
Stock Position:  0.042576031529726326
Bond Position:  [15.95808336]


portfolio before change:  [20.28667354]
curr_Stock_Price:  101.62044547034675
curr_Factors:  [101.62044547]
mat_Sqrt:  [[0.15]]
grads:  [0.07432428]
Stock Position:  0.07432428414273509
Bond Position:  [12.73380667]


portfolio before change:  [20.29497858]
curr_Stock_Price:  101.7107688419531
curr_Factors:  [101.71076884]
mat_Sqrt:  [[0.15]]
grads:  [0.10037735]
Stock Position:  0.1003773465068778
Bond Position:  [10.0855215]


portfolio before change:  [20.32624044]
curr_Stock_Price:  102.00965190765334
curr_Factors:  [102.00965191]
mat_Sqrt:  [[0.15]]
grads:  [-0.01473093]
Stock Position:  -0.014730932985136884
Bond Position:  [21.82893779]


portfolio before change:  [20.34056636]
curr_Stock_Price:  101.22238777015482
curr_Factors:  [101.22238777]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384217]
Stock Position:  -0.03384216588657852
Bond Position:  [23.7661512]


portfolio before change:  [20.32320916]
curr_Stock_Price:  101.82306312405441
curr_Factors:  [101.82306312]
mat_Sqrt:  [[0.15]]
grads:  [0.02881183]
Stock Position:  0.028811827915779856
Bond Position:  [17.38950059]


portfolio before change:  [20.35309036]
curr_Stock_Price:  102.78472971016052
curr_Factors:  [102.78472971]
mat_Sqrt:  [[0.15]]
grads:  [-0.0801483]
Stock Position:  -0.08014830280906714
Bond Position:  [28.591112]


portfolio before change:  [20.40601379]
curr_Stock_Price:  102.16900463770592
curr_Factors:  [102.16900464]
mat_Sqrt:  [[0.15]]
grads:  [0.01494117]
Stock Position:  0.014941171847102839
Bond Position:  [18.87948914]


portfolio before change:  [20.41720989]
curr_Stock_Price:  102.76039154463656
curr_Factors:  [102.76039154]
mat_Sqrt:  [[0.15]]
grads:  [0.02257087]
Stock Position:  0.022570871613985567
Bond Position:  [18.09781828]


portfolio before change:  [20.40190412]
curr_Stock_Price:  101.98203703487327
curr_Factors:  [101.98203703]
mat_Sqrt:  [[0.15]]
grads:  [-0.01506645]
Stock Position:  -0.015066449854080633
Bond Position:  [21.93841136]


portfolio before change:  [20.42274927]
curr_Stock_Price:  100.78051449339698
curr_Factors:  [100.78051449]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891265]
Stock Position:  -0.00891265150572692
Bond Position:  [21.32097087]


portfolio before change:  [20.43630249]
curr_Stock_Price:  99.55888755414144
curr_Factors:  [99.55888755]
mat_Sqrt:  [[0.15]]
grads:  [-0.00066768]
Stock Position:  -0.0006676781921224212
Bond Position:  [20.50277579]


portfolio before change:  [20.43844494]
curr_Stock_Price:  100.18877116011667
curr_Factors:  [100.18877116]
mat_Sqrt:  [[0.15]]
grads:  [-0.06074788]
Stock Position:  -0.06074787926788304
Bond Position:  [26.52470031]


portfolio before change:  [20.40246525]
curr_Stock_Price:  100.83563292384002
curr_Factors:  [100.83563292]
mat_Sqrt:  [[0.15]]
grads:  [-0.19648703]
Stock Position:  -0.1964870295456276
Bond Position:  [40.21535924]


portfolio before change:  [20.56380678]
curr_Stock_Price:  100.04008782732177
curr_Factors:  [100.04008783]
mat_Sqrt:  [[0.15]]
grads:  [0.10965151]
Stock Position:  0.10965151103707621
Bond Position:  [9.59425999]


portfolio before change:  [20.63383377]
curr_Stock_Price:  100.66778217517968
curr_Factors:  [100.66778218]
mat_Sqrt:  [[0.15]]
grads:  [-0.03432786]
Stock Position:  -0.03432785927535229
Bond Position:  [24.08954323]


portfolio before change:  [20.64109035]
curr_Stock_Price:  100.54411587192492
curr_Factors:  [100.54411587]
mat_Sqrt:  [[0.15]]
grads:  [-0.12998545]
Stock Position:  -0.12998544956379696
Bond Position:  [33.71036246]


portfolio before change:  [20.6744498]
curr_Stock_Price:  100.31989546579929
curr_Factors:  [100.31989547]
mat_Sqrt:  [[0.15]]
grads:  [-0.14225538]
Stock Position:  -0.1422553827726613
Bond Position:  [34.94549493]


portfolio before change:  [20.73119836]
curr_Stock_Price:  99.95168377587112
curr_Factors:  [99.95168378]
mat_Sqrt:  [[0.15]]
grads:  [0.19499243]
Stock Position:  0.1949924320982517
Bond Position:  [1.24137644]


portfolio before change:  [21.0286707]
curr_Stock_Price:  101.47644635619719
curr_Factors:  [101.47644636]
mat_Sqrt:  [[0.15]]
grads:  [0.03371886]
Stock Position:  0.03371885967411218
Bond Position:  [17.60700065]


portfolio before change:  [21.00643742]
curr_Stock_Price:  100.75179857527213
curr_Factors:  [100.75179858]
mat_Sqrt:  [[0.15]]
grads:  [0.07286747]
Stock Position:  0.07286747439212898
Bond Position:  [13.66490832]


portfolio before change:  [20.97165106]
curr_Stock_Price:  100.25096366184921
curr_Factors:  [100.25096366]
mat_Sqrt:  [[0.15]]
grads:  [0.04406016]
Stock Position:  0.044060155179414875
Bond Position:  [16.55457805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.98976356]
Stock Price:  100.61508040932507
PL:  [20.37468315]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.87279147e-02]
 [ 3.12868701e-02]
 [-1.59303847e-02]
 [-7.32403219e-03]
 [-5.18354420e-03]
 [ 4.55101833e-02]
 [ 3.58417719e-03]
 [ 2.41615779e-03]
 [ 3.26813673e-02]
 [ 2.34448881e-02]
 [ 2.15299126e-02]
 [-8.56888237e-03]
 [-1.82419055e-02]
 [ 1.21518267e-02]
 [-1.75315720e-02]
 [ 1.90789866e-04]
 [-6.10809034e-03]
 [-2.52764316e-03]
 [ 1.26781007e-03]
 [-2.12703231e-03]
 [-1.34594160e-02]
 [-2.38362406e-02]
 [ 3.95348333e-03]
 [-1.37008689e-02]
 [ 8.08135686e-03]
 [-6.18463688e-03]
 [ 3.98255817e-02]
 [-5.45180759e-03]
 [-5.26142836e-02]
 [-7.30855683e-03]
 [ 5.64406030e-02]
 [-4.98105040e-03]
 [-2.21669999e-02]
 [-1.83684372e-02]
 [-2.32293939e-02]
 [ 3.42517677e-02]
 [-7.45337025e-03]
 [-2.73477556e-03]
 [ 2.41026991e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.09978862]
curr_Stock_Price:  99.9095308034427
curr_Factors:  [99.9095308]
mat_Sqrt:  [[0.15]]
grads:  [0.12485276]
Stock Position:  0.12485276494264298
Bond Position:  [-12.57376979]


portfolio before change:  [-0.16629792]
curr_Stock_Price:  99.38941836500703
curr_Factors:  [99.38941837]
mat_Sqrt:  [[0.15]]
grads:  [0.20857913]
Stock Position:  0.20857913398288497
Bond Position:  [-20.89685673]


portfolio before change:  [-0.24500529]
curr_Stock_Price:  99.02459232900071
curr_Factors:  [99.02459233]
mat_Sqrt:  [[0.15]]
grads:  [-0.10620256]
Stock Position:  -0.10620256465761915
Bond Position:  [10.27166038]


portfolio before change:  [-0.21067072]
curr_Stock_Price:  98.71338960934865
curr_Factors:  [98.71338961]
mat_Sqrt:  [[0.15]]
grads:  [-0.04882688]
Stock Position:  -0.04882688125131012
Bond Position:  [4.60919623]


portfolio before change:  [-0.16576475]
curr_Stock_Price:  97.80549246456339
curr_Factors:  [97.80549246]
mat_Sqrt:  [[0.15]]
grads:  [-0.03455696]
Stock Position:  -0.03455696136208049
Bond Position:  [3.21409587]


portfolio before change:  [-0.16377551]
curr_Stock_Price:  97.75955517507651
curr_Factors:  [97.75955518]
mat_Sqrt:  [[0.15]]
grads:  [0.30340122]
Stock Position:  0.3034012217902735
Bond Position:  [-29.82414399]


portfolio before change:  [-0.12671423]
curr_Stock_Price:  97.89399607322284
curr_Factors:  [97.89399607]
mat_Sqrt:  [[0.15]]
grads:  [0.02389451]
Stock Position:  0.02389451459861463
Bond Position:  [-2.46584375]


portfolio before change:  [-0.14683188]
curr_Stock_Price:  97.06496051597898
curr_Factors:  [97.06496052]
mat_Sqrt:  [[0.15]]
grads:  [0.01610772]
Stock Position:  0.016107718568726358
Bond Position:  [-1.71032695]


portfolio before change:  [-0.15237114]
curr_Stock_Price:  96.73434531141206
curr_Factors:  [96.73434531]
mat_Sqrt:  [[0.15]]
grads:  [0.21787578]
Stock Position:  0.21787578172316177
Bond Position:  [-21.22844225]


portfolio before change:  [-0.0350479]
curr_Stock_Price:  97.28501214570831
curr_Factors:  [97.28501215]
mat_Sqrt:  [[0.15]]
grads:  [0.15629925]
Stock Position:  0.1562992539332478
Bond Position:  [-15.24062271]


portfolio before change:  [-0.10034775]
curr_Stock_Price:  96.87941421084997
curr_Factors:  [96.87941421]
mat_Sqrt:  [[0.15]]
grads:  [0.14353275]
Stock Position:  0.14353275033652577
Bond Position:  [-14.00571652]


portfolio before change:  [-0.021931]
curr_Stock_Price:  97.4379458161166
curr_Factors:  [97.43794582]
mat_Sqrt:  [[0.15]]
grads:  [-0.05712588]
Stock Position:  -0.05712588243640941
Bond Position:  [5.54429764]


portfolio before change:  [0.02382795]
curr_Stock_Price:  96.64905891130454
curr_Factors:  [96.64905891]
mat_Sqrt:  [[0.15]]
grads:  [-0.1216127]
Stock Position:  -0.12161270363131858
Bond Position:  [11.7775813]


portfolio before change:  [-0.07230985]
curr_Stock_Price:  97.45168960857414
curr_Factors:  [97.45168961]
mat_Sqrt:  [[0.15]]
grads:  [0.08101218]
Stock Position:  0.08101217807177306
Bond Position:  [-7.96708349]


portfolio before change:  [-0.083302]
curr_Stock_Price:  97.32829832064273
curr_Factors:  [97.32829832]
mat_Sqrt:  [[0.15]]
grads:  [-0.11687715]
Stock Position:  -0.11687714662731523
Bond Position:  [11.2921518]


portfolio before change:  [-0.03613864]
curr_Stock_Price:  96.93684666188327
curr_Factors:  [96.93684666]
mat_Sqrt:  [[0.15]]
grads:  [0.00127193]
Stock Position:  0.0012719324430863494
Bond Position:  [-0.15943576]


portfolio before change:  [-0.03657971]
curr_Stock_Price:  96.60574123714613
curr_Factors:  [96.60574124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407206]
Stock Position:  -0.04072060224520569
Bond Position:  [3.89726425]


portfolio before change:  [-0.01891749]
curr_Stock_Price:  96.18396372648682
curr_Factors:  [96.18396373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01685095]
Stock Position:  -0.01685095443300799
Bond Position:  [1.6018741]


portfolio before change:  [-0.01739335]
curr_Stock_Price:  96.10539864154526
curr_Factors:  [96.10539864]
mat_Sqrt:  [[0.15]]
grads:  [0.00845207]
Stock Position:  0.00845206714152885
Bond Position:  [-0.82968263]


portfolio before change:  [-0.02067699]
curr_Stock_Price:  95.72916825216811
curr_Factors:  [95.72916825]
mat_Sqrt:  [[0.15]]
grads:  [-0.01418022]
Stock Position:  -0.01418021542649905
Bond Position:  [1.33678324]


portfolio before change:  [-0.02090055]
curr_Stock_Price:  95.75671855410492
curr_Factors:  [95.75671855]
mat_Sqrt:  [[0.15]]
grads:  [-0.08972944]
Stock Position:  -0.08972944027027133
Bond Position:  [8.57129621]


portfolio before change:  [0.0811109]
curr_Stock_Price:  94.63178150465043
curr_Factors:  [94.6317815]
mat_Sqrt:  [[0.15]]
grads:  [-0.15890827]
Stock Position:  -0.15890827048383843
Bond Position:  [15.11888363]


portfolio before change:  [0.2311687]
curr_Stock_Price:  93.69937051815116
curr_Factors:  [93.69937052]
mat_Sqrt:  [[0.15]]
grads:  [0.02635656]
Stock Position:  0.02635655555364588
Bond Position:  [-2.23842397]


portfolio before change:  [0.21329436]
curr_Stock_Price:  93.0318130998639
curr_Factors:  [93.0318131]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133913]
Stock Position:  -0.09133912575801809
Bond Position:  [8.71073884]


portfolio before change:  [0.35942276]
curr_Stock_Price:  91.44389019424167
curr_Factors:  [91.44389019]
mat_Sqrt:  [[0.15]]
grads:  [0.05387571]
Stock Position:  0.05387571240149283
Bond Position:  [-4.56718197]


portfolio before change:  [0.33387346]
curr_Stock_Price:  90.98026065268778
curr_Factors:  [90.98026065]
mat_Sqrt:  [[0.15]]
grads:  [-0.04123091]
Stock Position:  -0.04123091253238869
Bond Position:  [4.08507263]


portfolio before change:  [0.26761988]
curr_Stock_Price:  92.59953695384277
curr_Factors:  [92.59953695]
mat_Sqrt:  [[0.15]]
grads:  [0.26550388]
Stock Position:  0.26550387783191454
Bond Position:  [-24.31791626]


portfolio before change:  [0.45829264]
curr_Stock_Price:  93.32914091989049
curr_Factors:  [93.32914092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03634538]
Stock Position:  -0.03634538393749947
Bond Position:  [3.8503761]


portfolio before change:  [0.46045872]
curr_Stock_Price:  93.28278697349315
curr_Factors:  [93.28278697]
mat_Sqrt:  [[0.15]]
grads:  [-0.35076189]
Stock Position:  -0.35076189038262817
Bond Position:  [33.18050542]


portfolio before change:  [0.62423633]
curr_Stock_Price:  92.82769251515752
curr_Factors:  [92.82769252]
mat_Sqrt:  [[0.15]]
grads:  [-0.04872371]
Stock Position:  -0.04872371223078891
Bond Position:  [5.14714611]


portfolio before change:  [0.62509357]
curr_Stock_Price:  92.82330432552726
curr_Factors:  [92.82330433]
mat_Sqrt:  [[0.15]]
grads:  [0.37627069]
Stock Position:  0.37627068635570365
Bond Position:  [-34.30159485]


portfolio before change:  [0.72559086]
curr_Stock_Price:  93.10178802119576
curr_Factors:  [93.10178802]
mat_Sqrt:  [[0.15]]
grads:  [-0.033207]
Stock Position:  -0.03320700267796185
Bond Position:  [3.81722218]


portfolio before change:  [0.72257112]
curr_Stock_Price:  93.20709464362353
curr_Factors:  [93.20709464]
mat_Sqrt:  [[0.15]]
grads:  [-0.14778]
Stock Position:  -0.1477799993347348
Bond Position:  [14.49671551]


portfolio before change:  [0.60524038]
curr_Stock_Price:  94.01331298861552
curr_Factors:  [94.01331299]
mat_Sqrt:  [[0.15]]
grads:  [-0.12245625]
Stock Position:  -0.1224562479682755
Bond Position:  [12.11775795]


portfolio before change:  [0.40007857]
curr_Stock_Price:  95.70107186876778
curr_Factors:  [95.70107187]
mat_Sqrt:  [[0.15]]
grads:  [-0.15486263]
Stock Position:  -0.15486262587789765
Bond Position:  [15.22059786]


portfolio before change:  [0.61009932]
curr_Stock_Price:  94.35718369221631
curr_Factors:  [94.35718369]
mat_Sqrt:  [[0.15]]
grads:  [0.22834512]
Stock Position:  0.22834511803922486
Bond Position:  [-20.93590293]


portfolio before change:  [0.57865236]
curr_Stock_Price:  94.2309282766983
curr_Factors:  [94.23092828]
mat_Sqrt:  [[0.15]]
grads:  [-0.04968913]
Stock Position:  -0.049689134967424504
Bond Position:  [5.26090567]


portfolio before change:  [0.5343808]
curr_Stock_Price:  95.13513432073842
curr_Factors:  [95.13513432]
mat_Sqrt:  [[0.15]]
grads:  [-0.01823184]
Stock Position:  -0.018231837081422588
Bond Position:  [2.26886907]


portfolio before change:  [0.538695]
curr_Stock_Price:  94.91406111616851
curr_Factors:  [94.91406112]
mat_Sqrt:  [[0.15]]
grads:  [0.16068466]
Stock Position:  0.16068466083249125
Bond Position:  [-14.71253872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.61185214]
Stock Price:  95.38079096604547
PL:  [0.61185214]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.18558062e-02]
 [ 4.21573381e-02]
 [-1.92906193e-03]
 [-5.43130924e-03]
 [-7.22105456e-03]
 [ 3.42970202e-02]
 [ 3.58870466e-03]
 [ 2.55494280e-03]
 [-2.67643270e-02]
 [ 2.31856410e-02]
 [ 1.91836214e-02]
 [-1.29925701e-02]
 [-2.57702524e-06]
 [ 1.62679424e-02]
 [-1.80338292e-02]
 [-1.32892725e-04]
 [-6.07430050e-03]
 [-2.48747936e-03]
 [ 1.46365688e-03]
 [-7.13439418e-03]
 [-1.12428926e-02]
 [-1.90816325e-02]
 [ 6.60020660e-03]
 [-8.68314888e-03]
 [ 1.24505376e-02]
 [ 1.64022017e-03]
 [ 2.11394899e-02]
 [-4.54789820e-03]
 [-3.02892436e-02]
 [-9.62134242e-03]
 [ 4.84074591e-02]
 [-3.47778071e-03]
 [-2.25166788e-02]
 [-8.26966235e-03]
 [-2.41654845e-02]
 [ 3.04903584e-02]
 [-1.13344728e-02]
 [-1.04010357e-02]
 [ 3.86694083e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.7404089]
curr_Stock_Price:  100.67653530649758
curr_Factors:  [100.67653531]
mat_Sqrt:  [[0.15]]
grads:  [-0.21237204]
Stock Position:  -0.21237204151997507
Bond Position:  [38.12129024]


portfolio before change:  [16.76219803]
curr_Stock_Price:  100.59637568237024
curr_Factors:  [100.59637568]
mat_Sqrt:  [[0.15]]
grads:  [0.28104892]
Stock Position:  0.2810489209912124
Bond Position:  [-11.51030481]


portfolio before change:  [16.53097487]
curr_Stock_Price:  99.77878038968278
curr_Factors:  [99.77878039]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286041]
Stock Position:  -0.012860412895795252
Bond Position:  [17.81417119]


portfolio before change:  [16.52870638]
curr_Stock_Price:  100.12833417242342
curr_Factors:  [100.12833417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620873]
Stock Position:  -0.03620872826680625
Bond Position:  [20.15422602]


portfolio before change:  [16.56124268]
curr_Stock_Price:  99.29933879901282
curr_Factors:  [99.2993388]
mat_Sqrt:  [[0.15]]
grads:  [-0.04814036]
Stock Position:  -0.04814036371687023
Bond Position:  [21.34154897]


portfolio before change:  [16.59274251]
curr_Stock_Price:  98.70042418824772
curr_Factors:  [98.70042419]
mat_Sqrt:  [[0.15]]
grads:  [0.2286468]
Stock Position:  0.2286468014699891
Bond Position:  [-5.97479378]


portfolio before change:  [16.80711211]
curr_Stock_Price:  99.64124859946746
curr_Factors:  [99.6412486]
mat_Sqrt:  [[0.15]]
grads:  [0.0239247]
Stock Position:  0.023924697758786615
Bond Position:  [14.42322535]


portfolio before change:  [16.81585822]
curr_Stock_Price:  99.93145502248088
curr_Factors:  [99.93145502]
mat_Sqrt:  [[0.15]]
grads:  [0.01703295]
Stock Position:  0.01703295201415234
Bond Position:  [15.11373054]


portfolio before change:  [16.82072688]
curr_Stock_Price:  100.10637032539206
curr_Factors:  [100.10637033]
mat_Sqrt:  [[0.15]]
grads:  [-0.17842885]
Stock Position:  -0.1784288466600621
Bond Position:  [34.68259108]


portfolio before change:  [16.66421791]
curr_Stock_Price:  101.00781968107019
curr_Factors:  [101.00781968]
mat_Sqrt:  [[0.15]]
grads:  [0.15457094]
Stock Position:  0.1545709399704019
Bond Position:  [1.05134427]


portfolio before change:  [16.54692002]
curr_Stock_Price:  100.24810824003252
curr_Factors:  [100.24810824]
mat_Sqrt:  [[0.15]]
grads:  [0.12789081]
Stock Position:  0.1278908094550581
Bond Position:  [3.72610831]


portfolio before change:  [16.3418137]
curr_Stock_Price:  98.64070486600856
curr_Factors:  [98.64070487]
mat_Sqrt:  [[0.15]]
grads:  [-0.08661713]
Stock Position:  -0.0866171336975285
Bond Position:  [24.88578882]


portfolio before change:  [16.37630488]
curr_Stock_Price:  98.27841778358247
curr_Factors:  [98.27841778]
mat_Sqrt:  [[0.15]]
grads:  [-1.71801682e-05]
Stock Position:  -1.7180168236915462e-05
Bond Position:  [16.37799332]


portfolio before change:  [16.37838098]
curr_Stock_Price:  96.60656952992495
curr_Factors:  [96.60656953]
mat_Sqrt:  [[0.15]]
grads:  [0.10845295]
Stock Position:  0.1084529496354301
Bond Position:  [5.90111356]


portfolio before change:  [16.38006554]
curr_Stock_Price:  96.61530021749057
curr_Factors:  [96.61530022]
mat_Sqrt:  [[0.15]]
grads:  [-0.12022553]
Stock Position:  -0.12022552799439713
Bond Position:  [27.99569102]


portfolio before change:  [16.39616744]
curr_Stock_Price:  96.5104786582231
curr_Factors:  [96.51047866]
mat_Sqrt:  [[0.15]]
grads:  [-0.00088595]
Stock Position:  -0.0008859515022915874
Bond Position:  [16.48167105]


portfolio before change:  [16.39902128]
curr_Stock_Price:  95.61483310278786
curr_Factors:  [95.6148331]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049534]
Stock Position:  -0.040495336657259746
Bond Position:  [20.27097614]


portfolio before change:  [16.37809218]
curr_Stock_Price:  96.1942362996797
curr_Factors:  [96.1942363]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165832]
Stock Position:  -0.016583195707603575
Bond Position:  [17.97330003]


portfolio before change:  [16.38857937]
curr_Stock_Price:  95.69732474945012
curr_Factors:  [95.69732475]
mat_Sqrt:  [[0.15]]
grads:  [0.00975771]
Stock Position:  0.009757712548580454
Bond Position:  [15.45479238]


portfolio before change:  [16.39464737]
curr_Stock_Price:  96.12119768364991
curr_Factors:  [96.12119768]
mat_Sqrt:  [[0.15]]
grads:  [-0.04756263]
Stock Position:  -0.04756262784691711
Bond Position:  [20.96642412]


portfolio before change:  [16.39034297]
curr_Stock_Price:  96.26680281151197
curr_Factors:  [96.26680281]
mat_Sqrt:  [[0.15]]
grads:  [-0.07495262]
Stock Position:  -0.07495261709442076
Bond Position:  [23.60579178]


portfolio before change:  [16.34445121]
curr_Stock_Price:  96.91845016813335
curr_Factors:  [96.91845017]
mat_Sqrt:  [[0.15]]
grads:  [-0.12721088]
Stock Position:  -0.12721088337636943
Bond Position:  [28.67353287]


portfolio before change:  [16.19203449]
curr_Stock_Price:  98.14476924055803
curr_Factors:  [98.14476924]
mat_Sqrt:  [[0.15]]
grads:  [0.04400138]
Stock Position:  0.044001377351966936
Bond Position:  [11.87352946]


portfolio before change:  [16.16345322]
curr_Stock_Price:  97.46148258876585
curr_Factors:  [97.46148259]
mat_Sqrt:  [[0.15]]
grads:  [-0.05788766]
Stock Position:  -0.057887659171076446
Bond Position:  [21.80527031]


portfolio before change:  [16.21218188]
curr_Stock_Price:  96.6667910274375
curr_Factors:  [96.66679103]
mat_Sqrt:  [[0.15]]
grads:  [0.08300358]
Stock Position:  0.08300358415469462
Bond Position:  [8.18849176]


portfolio before change:  [16.1772331]
curr_Stock_Price:  96.2334071843908
curr_Factors:  [96.23340718]
mat_Sqrt:  [[0.15]]
grads:  [0.0109348]
Stock Position:  0.010934801105864539
Bond Position:  [15.12493993]


portfolio before change:  [16.17653917]
curr_Stock_Price:  95.99703721132968
curr_Factors:  [95.99703721]
mat_Sqrt:  [[0.15]]
grads:  [0.14092993]
Stock Position:  0.14092993284224545
Bond Position:  [2.64768316]


portfolio before change:  [16.09594532]
curr_Stock_Price:  95.4228168751148
curr_Factors:  [95.42281688]
mat_Sqrt:  [[0.15]]
grads:  [-0.03031932]
Stock Position:  -0.030319321323857267
Bond Position:  [18.98910037]


portfolio before change:  [16.0925207]
curr_Stock_Price:  95.61406141904618
curr_Factors:  [95.61406142]
mat_Sqrt:  [[0.15]]
grads:  [-0.20192829]
Stock Position:  -0.20192829095296128
Bond Position:  [35.39970471]


portfolio before change:  [16.18892034]
curr_Stock_Price:  95.15858090472335
curr_Factors:  [95.1585809]
mat_Sqrt:  [[0.15]]
grads:  [-0.06414228]
Stock Position:  -0.0641422827941846
Bond Position:  [22.29260895]


portfolio before change:  [16.24099887]
curr_Stock_Price:  94.39010531342007
curr_Factors:  [94.39010531]
mat_Sqrt:  [[0.15]]
grads:  [0.32271639]
Stock Position:  0.32271639429792204
Bond Position:  [-14.22023557]


portfolio before change:  [16.04641168]
curr_Stock_Price:  93.7926471270854
curr_Factors:  [93.79264713]
mat_Sqrt:  [[0.15]]
grads:  [-0.0231852]
Stock Position:  -0.02318520471004069
Bond Position:  [18.2210134]


portfolio before change:  [16.0727563]
curr_Stock_Price:  92.75462096466786
curr_Factors:  [92.75462096]
mat_Sqrt:  [[0.15]]
grads:  [-0.15011119]
Stock Position:  -0.1501111919874768
Bond Position:  [29.99626301]


portfolio before change:  [16.10041809]
curr_Stock_Price:  92.59532555487445
curr_Factors:  [92.59532555]
mat_Sqrt:  [[0.15]]
grads:  [-0.05513108]
Stock Position:  -0.05513108233464865
Bond Position:  [21.20529861]


portfolio before change:  [16.0824709]
curr_Stock_Price:  92.9689444781015
curr_Factors:  [92.96894448]
mat_Sqrt:  [[0.15]]
grads:  [-0.16110323]
Stock Position:  -0.16110322966762125
Bond Position:  [31.06006812]


portfolio before change:  [16.05141581]
curr_Stock_Price:  93.18581068261726
curr_Factors:  [93.18581068]
mat_Sqrt:  [[0.15]]
grads:  [0.20326906]
Stock Position:  0.20326905597902664
Bond Position:  [-2.89037596]


portfolio before change:  [15.95875274]
curr_Stock_Price:  92.73172413016245
curr_Factors:  [92.73172413]
mat_Sqrt:  [[0.15]]
grads:  [-0.07556315]
Stock Position:  -0.07556315207713263
Bond Position:  [22.96585411]


portfolio before change:  [15.969832]
curr_Stock_Price:  92.62309516427322
curr_Factors:  [92.62309516]
mat_Sqrt:  [[0.15]]
grads:  [-0.06934024]
Stock Position:  -0.06934023782657307
Bond Position:  [22.39233945]


portfolio before change:  [15.94984316]
curr_Stock_Price:  92.95173636062849
curr_Factors:  [92.95173636]
mat_Sqrt:  [[0.15]]
grads:  [0.25779606]
Stock Position:  0.2577960553702366
Bond Position:  [-8.01274782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.09032797]
Stock Price:  93.50056734917833
PL:  [16.09032797]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.74601677e-02]
 [ 4.37004704e-02]
 [-8.64248604e-04]
 [ 1.05690663e-03]
 [-1.26801098e-03]
 [ 6.03663777e-03]
 [ 3.60753603e-03]
 [ 1.07817602e-02]
 [ 2.45953373e-03]
 [ 2.27533239e-02]
 [ 1.93493485e-02]
 [-6.30628053e-03]
 [ 1.07788448e-02]
 [ 2.27754315e-02]
 [-1.23007114e-02]
 [-3.30481235e-03]
 [-4.77531233e-03]
 [ 7.78447793e-03]
 [ 1.61569851e-02]
 [ 1.34153471e-02]
 [-3.35652589e-03]
 [-5.64862259e-03]
 [ 4.03691064e-03]
 [-1.23290596e-02]
 [-2.95975217e-04]
 [ 3.03505334e-03]
 [-6.79742206e-04]
 [-2.11447949e-04]
 [ 1.44210698e-03]
 [-6.11685272e-03]
 [-2.48986912e-02]
 [ 1.81840981e-02]
 [-6.52088863e-03]
 [-1.92870745e-02]
 [-2.20662738e-02]
 [ 3.87369516e-02]
 [ 3.23292490e-03]
 [ 6.94887085e-03]
 [ 4.82772520e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.53140314]
curr_Stock_Price:  99.88987246651656
curr_Factors:  [99.88987247]
mat_Sqrt:  [[0.15]]
grads:  [0.11640112]
Stock Position:  0.11640111819924136
Bond Position:  [-12.15869599]


portfolio before change:  [-0.45916651]
curr_Stock_Price:  100.52351380289034
curr_Factors:  [100.5235138]
mat_Sqrt:  [[0.15]]
grads:  [0.29133647]
Stock Position:  0.29133646958815085
Bond Position:  [-29.74533213]


portfolio before change:  [-0.22331286]
curr_Stock_Price:  101.34583464197893
curr_Factors:  [101.34583464]
mat_Sqrt:  [[0.15]]
grads:  [-0.00576166]
Stock Position:  -0.005761657359861378
Bond Position:  [0.36060711]


portfolio before change:  [-0.22732281]
curr_Stock_Price:  102.04962980043538
curr_Factors:  [102.0496298]
mat_Sqrt:  [[0.15]]
grads:  [0.00704604]
Stock Position:  0.007046044226699973
Bond Position:  [-0.94636901]


portfolio before change:  [-0.22706697]
curr_Stock_Price:  102.10272881307938
curr_Factors:  [102.10272881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00845341]
Stock Position:  -0.008453406539196436
Bond Position:  [0.6360489]


portfolio before change:  [-0.22979476]
curr_Stock_Price:  102.43481993817639
curr_Factors:  [102.43481994]
mat_Sqrt:  [[0.15]]
grads:  [0.04024425]
Stock Position:  0.04024425183008058
Bond Position:  [-4.35220745]


portfolio before change:  [-0.26280027]
curr_Stock_Price:  101.6282090878084
curr_Factors:  [101.62820909]
mat_Sqrt:  [[0.15]]
grads:  [0.02405024]
Stock Position:  0.024050240187446694
Bond Position:  [-2.70698311]


portfolio before change:  [-0.26529391]
curr_Stock_Price:  101.53859502227586
curr_Factors:  [101.53859502]
mat_Sqrt:  [[0.15]]
grads:  [0.0718784]
Stock Position:  0.07187840129304744
Bond Position:  [-7.56372579]


portfolio before change:  [-0.20575863]
curr_Stock_Price:  102.38002727764099
curr_Factors:  [102.38002728]
mat_Sqrt:  [[0.15]]
grads:  [0.01639689]
Stock Position:  0.016396891565490998
Bond Position:  [-1.88447283]


portfolio before change:  [-0.19631419]
curr_Stock_Price:  102.97038390559479
curr_Factors:  [102.97038391]
mat_Sqrt:  [[0.15]]
grads:  [0.15168883]
Stock Position:  0.15168882593960883
Bond Position:  [-15.81577083]


portfolio before change:  [-0.35000899]
curr_Stock_Price:  101.97019353728423
curr_Factors:  [101.97019354]
mat_Sqrt:  [[0.15]]
grads:  [0.12899566]
Stock Position:  0.12899565650485634
Bond Position:  [-13.50372104]


portfolio before change:  [-0.29472121]
curr_Stock_Price:  102.41188166564936
curr_Factors:  [102.41188167]
mat_Sqrt:  [[0.15]]
grads:  [-0.04204187]
Stock Position:  -0.042041870221055495
Bond Position:  [4.01086583]


portfolio before change:  [-0.30277998]
curr_Stock_Price:  102.61549203845006
curr_Factors:  [102.61549204]
mat_Sqrt:  [[0.15]]
grads:  [0.07185897]
Stock Position:  0.07185896546985462
Bond Position:  [-7.67662308]


portfolio before change:  [-0.33263227]
curr_Stock_Price:  102.21341756766863
curr_Factors:  [102.21341757]
mat_Sqrt:  [[0.15]]
grads:  [0.15183621]
Stock Position:  0.15183621025197488
Bond Position:  [-15.85233023]


portfolio before change:  [-0.37783708]
curr_Stock_Price:  101.92874799793414
curr_Factors:  [101.928748]
mat_Sqrt:  [[0.15]]
grads:  [-0.08200474]
Stock Position:  -0.08200474250270418
Bond Position:  [7.98080365]


portfolio before change:  [-0.49451429]
curr_Stock_Price:  103.3637243343602
curr_Factors:  [103.36372433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02203208]
Stock Position:  -0.0220320823416841
Bond Position:  [1.7828038]


portfolio before change:  [-0.50896735]
curr_Stock_Price:  104.0298405619407
curr_Factors:  [104.02984056]
mat_Sqrt:  [[0.15]]
grads:  [-0.03183542]
Stock Position:  -0.031835415532042145
Bond Position:  [2.80286585]


portfolio before change:  [-0.495593]
curr_Stock_Price:  103.62073747648637
curr_Factors:  [103.62073748]
mat_Sqrt:  [[0.15]]
grads:  [0.05189652]
Stock Position:  0.051896519553518
Bond Position:  [-5.87314863]


portfolio before change:  [-0.53953592]
curr_Stock_Price:  102.78814346500461
curr_Factors:  [102.78814347]
mat_Sqrt:  [[0.15]]
grads:  [0.10771323]
Stock Position:  0.107713234198142
Bond Position:  [-11.61117929]


portfolio before change:  [-0.6924217]
curr_Stock_Price:  101.38224115007831
curr_Factors:  [101.38224115]
mat_Sqrt:  [[0.15]]
grads:  [0.08943565]
Stock Position:  0.0894356474443975
Bond Position:  [-9.75960807]


portfolio before change:  [-0.68000997]
curr_Stock_Price:  101.53466084901112
curr_Factors:  [101.53466085]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237684]
Stock Position:  -0.022376839270424505
Bond Position:  [1.59201482]


portfolio before change:  [-0.68826419]
curr_Stock_Price:  101.91242799010858
curr_Factors:  [101.91242799]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765748]
Stock Position:  -0.037657483904937686
Bond Position:  [3.14950143]


portfolio before change:  [-0.704012]
curr_Stock_Price:  102.34106856853346
curr_Factors:  [102.34106857]
mat_Sqrt:  [[0.15]]
grads:  [0.02691274]
Stock Position:  0.026912737598016902
Bond Position:  [-3.45829033]


portfolio before change:  [-0.69942598]
curr_Stock_Price:  102.52753539521007
curr_Factors:  [102.5275354]
mat_Sqrt:  [[0.15]]
grads:  [-0.08219373]
Stock Position:  -0.08219373069559006
Bond Position:  [7.72769465]


portfolio before change:  [-0.74479476]
curr_Stock_Price:  103.09126209950851
curr_Factors:  [103.0912621]
mat_Sqrt:  [[0.15]]
grads:  [-0.00197317]
Stock Position:  -0.0019731681165435144
Bond Position:  [-0.54137837]


portfolio before change:  [-0.74288163]
curr_Stock_Price:  102.08738748640833
curr_Factors:  [102.08738749]
mat_Sqrt:  [[0.15]]
grads:  [0.02023369]
Stock Position:  0.020233688912785097
Bond Position:  [-2.80848607]


portfolio before change:  [-0.73030421]
curr_Stock_Price:  102.72634650667221
curr_Factors:  [102.72634651]
mat_Sqrt:  [[0.15]]
grads:  [-0.00453161]
Stock Position:  -0.00453161470375148
Bond Position:  [-0.26478799]


portfolio before change:  [-0.72560239]
curr_Stock_Price:  101.68148333625018
curr_Factors:  [101.68148334]
mat_Sqrt:  [[0.15]]
grads:  [-0.00140965]
Stock Position:  -0.001409652994661184
Bond Position:  [-0.58226679]


portfolio before change:  [-0.72520538]
curr_Stock_Price:  101.34820701571122
curr_Factors:  [101.34820702]
mat_Sqrt:  [[0.15]]
grads:  [0.00961405]
Stock Position:  0.009614046517492739
Bond Position:  [-1.69957175]


portfolio before change:  [-0.71617348]
curr_Stock_Price:  102.30975410072796
curr_Factors:  [102.3097541]
mat_Sqrt:  [[0.15]]
grads:  [-0.04077902]
Stock Position:  -0.04077901810658344
Bond Position:  [3.45591784]


portfolio before change:  [-0.67802943]
curr_Stock_Price:  101.38496397853842
curr_Factors:  [101.38496398]
mat_Sqrt:  [[0.15]]
grads:  [-0.16599127]
Stock Position:  -0.16599127443160064
Bond Position:  [16.15098995]


portfolio before change:  [-0.64928588]
curr_Stock_Price:  101.22396423874552
curr_Factors:  [101.22396424]
mat_Sqrt:  [[0.15]]
grads:  [0.12122732]
Stock Position:  0.1212273207212816
Bond Position:  [-12.92039585]


portfolio before change:  [-0.76446548]
curr_Stock_Price:  100.2871749447446
curr_Factors:  [100.28717494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04347259]
Stock Position:  -0.04347259085150191
Bond Position:  [3.59527784]


portfolio before change:  [-0.7774476]
curr_Stock_Price:  100.59614101754578
curr_Factors:  [100.59614102]
mat_Sqrt:  [[0.15]]
grads:  [-0.1285805]
Stock Position:  -0.1285804967309006
Bond Position:  [12.15725418]


portfolio before change:  [-0.53474607]
curr_Stock_Price:  98.72041502565106
curr_Factors:  [98.72041503]
mat_Sqrt:  [[0.15]]
grads:  [-0.14710849]
Stock Position:  -0.14710849169974735
Bond Position:  [13.98786528]


portfolio before change:  [-0.50925678]
curr_Stock_Price:  98.5590328168864
curr_Factors:  [98.55903282]
mat_Sqrt:  [[0.15]]
grads:  [0.25824634]
Stock Position:  0.2582463440484577
Bond Position:  [-25.96176668]


portfolio before change:  [-0.53171944]
curr_Stock_Price:  98.48461847920532
curr_Factors:  [98.48461848]
mat_Sqrt:  [[0.15]]
grads:  [0.02155283]
Stock Position:  0.021552832649057153
Bond Position:  [-2.65434194]


portfolio before change:  [-0.54271028]
curr_Stock_Price:  97.990064912647
curr_Factors:  [97.99006491]
mat_Sqrt:  [[0.15]]
grads:  [0.04632581]
Stock Position:  0.046325805691018185
Bond Position:  [-5.08217899]


portfolio before change:  [-0.53089351]
curr_Stock_Price:  98.258858651036
curr_Factors:  [98.25885865]
mat_Sqrt:  [[0.15]]
grads:  [0.03218483]
Stock Position:  0.03218483465554854
Bond Position:  [-3.69333863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54317971]
Stock Price:  97.89146492335375
PL:  [-0.54317971]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.79467074e-02]
 [ 4.32523517e-02]
 [-1.77219635e-02]
 [-7.57285440e-03]
 [-6.32768914e-03]
 [ 3.65437800e-02]
 [ 3.58024491e-03]
 [ 3.99920783e-04]
 [-1.52106553e-02]
 [ 2.34431006e-02]
 [ 2.11197739e-02]
 [-1.32617175e-02]
 [ 5.24088854e-03]
 [ 1.34567968e-02]
 [-1.69164122e-02]
 [-1.15514774e-04]
 [-6.06810816e-03]
 [-1.57217369e-03]
 [ 1.17796108e-03]
 [-2.17612337e-03]
 [-1.22727356e-02]
 [-2.21293783e-02]
 [ 5.49541915e-03]
 [-1.00082427e-02]
 [ 1.19683806e-02]
 [ 5.24471802e-04]
 [ 2.51353129e-02]
 [-4.50188591e-03]
 [-3.30056102e-02]
 [-1.09588724e-02]
 [ 4.12276761e-02]
 [ 3.50716366e-03]
 [-1.51392798e-02]
 [-4.25756716e-02]
 [-2.30827846e-02]
 [ 3.87790375e-02]
 [ 3.19534632e-03]
 [ 8.76016873e-03]
 [ 6.30078617e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.85232393]
curr_Stock_Price:  100.63608654272183
curr_Factors:  [100.63608654]
mat_Sqrt:  [[0.15]]
grads:  [-0.18631138]
Stock Position:  -0.18631138235647574
Bond Position:  [34.60197233]


portfolio before change:  [15.95037111]
curr_Stock_Price:  100.13304879558095
curr_Factors:  [100.1330488]
mat_Sqrt:  [[0.15]]
grads:  [0.28834901]
Stock Position:  0.28834901113662953
Bond Position:  [-12.92289449]


portfolio before change:  [15.58066513]
curr_Stock_Price:  98.85650369663864
curr_Factors:  [98.8565037]
mat_Sqrt:  [[0.15]]
grads:  [-0.11814642]
Stock Position:  -0.11814642345049926
Bond Position:  [27.26020748]


portfolio before change:  [15.63991966]
curr_Stock_Price:  98.38381233059796
curr_Factors:  [98.38381233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0504857]
Stock Position:  -0.05048569601360599
Bond Position:  [20.6068949]


portfolio before change:  [15.61897833]
curr_Stock_Price:  98.84963440539734
curr_Factors:  [98.84963441]
mat_Sqrt:  [[0.15]]
grads:  [-0.04218459]
Stock Position:  -0.042184594244064066
Bond Position:  [19.78891005]


portfolio before change:  [15.63523272]
curr_Stock_Price:  98.52296031985448
curr_Factors:  [98.52296032]
mat_Sqrt:  [[0.15]]
grads:  [0.2436252]
Stock Position:  0.2436252001629972
Bond Position:  [-8.36744321]


portfolio before change:  [15.50878975]
curr_Stock_Price:  98.0082476996583
curr_Factors:  [98.0082477]
mat_Sqrt:  [[0.15]]
grads:  [0.0238683]
Stock Position:  0.023868299375065263
Bond Position:  [13.16949956]


portfolio before change:  [15.50096083]
curr_Stock_Price:  97.61126871108155
curr_Factors:  [97.61126871]
mat_Sqrt:  [[0.15]]
grads:  [0.00266614]
Stock Position:  0.002666138552602764
Bond Position:  [15.24071566]


portfolio before change:  [15.50423306]
curr_Stock_Price:  98.12400321129786
curr_Factors:  [98.12400321]
mat_Sqrt:  [[0.15]]
grads:  [-0.10140437]
Stock Position:  -0.10140436889971119
Bond Position:  [25.45443568]


portfolio before change:  [15.53491322]
curr_Stock_Price:  97.85282990838294
curr_Factors:  [97.85282991]
mat_Sqrt:  [[0.15]]
grads:  [0.15628734]
Stock Position:  0.15628733722328486
Bond Position:  [0.241755]


portfolio before change:  [15.55577928]
curr_Stock_Price:  97.9861474256613
curr_Factors:  [97.98614743]
mat_Sqrt:  [[0.15]]
grads:  [0.14079849]
Stock Position:  0.14079849238184372
Bond Position:  [1.75947745]


portfolio before change:  [15.65844317]
curr_Stock_Price:  98.71373999958047
curr_Factors:  [98.71374]
mat_Sqrt:  [[0.15]]
grads:  [-0.08841145]
Stock Position:  -0.08841144992367148
Bond Position:  [24.38586805]


portfolio before change:  [15.66810831]
curr_Stock_Price:  98.63889999393814
curr_Factors:  [98.63889999]
mat_Sqrt:  [[0.15]]
grads:  [0.03493926]
Stock Position:  0.0349392569175525
Bond Position:  [12.22173844]


portfolio before change:  [15.6220126]
curr_Stock_Price:  97.27586238721348
curr_Factors:  [97.27586239]
mat_Sqrt:  [[0.15]]
grads:  [0.08971198]
Stock Position:  0.08971197874808703
Bond Position:  [6.8952025]


portfolio before change:  [15.55366471]
curr_Stock_Price:  96.50439523781968
curr_Factors:  [96.50439524]
mat_Sqrt:  [[0.15]]
grads:  [-0.11277608]
Stock Position:  -0.11277608145220268
Bond Position:  [26.43705225]


portfolio before change:  [15.55370193]
curr_Stock_Price:  96.53336960915706
curr_Factors:  [96.53336961]
mat_Sqrt:  [[0.15]]
grads:  [-0.0007701]
Stock Position:  -0.0007700984948170835
Bond Position:  [15.62804213]


portfolio before change:  [15.55650277]
curr_Stock_Price:  95.43323896473038
curr_Factors:  [95.43323896]
mat_Sqrt:  [[0.15]]
grads:  [-0.04045405]
Stock Position:  -0.040454054414377015
Bond Position:  [19.41716421]


portfolio before change:  [15.51867414]
curr_Stock_Price:  96.42834119901335
curr_Factors:  [96.4283412]
mat_Sqrt:  [[0.15]]
grads:  [-0.01048116]
Stock Position:  -0.010481157953331592
Bond Position:  [16.52935482]


portfolio before change:  [15.52216305]
curr_Stock_Price:  96.29261141989315
curr_Factors:  [96.29261142]
mat_Sqrt:  [[0.15]]
grads:  [0.00785307]
Stock Position:  0.007853073898083866
Bond Position:  [14.76597005]


portfolio before change:  [15.51961433]
curr_Stock_Price:  95.7330116208577
curr_Factors:  [95.73301162]
mat_Sqrt:  [[0.15]]
grads:  [-0.01450749]
Stock Position:  -0.014507489116626754
Bond Position:  [16.90845995]


portfolio before change:  [15.51742226]
curr_Stock_Price:  96.02980701789969
curr_Factors:  [96.02980702]
mat_Sqrt:  [[0.15]]
grads:  [-0.08181824]
Stock Position:  -0.08181823759686728
Bond Position:  [23.37441183]


portfolio before change:  [15.56756414]
curr_Stock_Price:  95.45267533461553
curr_Factors:  [95.45267533]
mat_Sqrt:  [[0.15]]
grads:  [-0.14752919]
Stock Position:  -0.147529188801359
Bond Position:  [29.64961991]


portfolio before change:  [15.43341554]
curr_Stock_Price:  96.38710086012007
curr_Factors:  [96.38710086]
mat_Sqrt:  [[0.15]]
grads:  [0.03663613]
Stock Position:  0.036636127663806514
Bond Position:  [11.90216541]


portfolio before change:  [15.43935113]
curr_Stock_Price:  96.50850350453679
curr_Factors:  [96.5085035]
mat_Sqrt:  [[0.15]]
grads:  [-0.06672162]
Stock Position:  -0.06672161824315159
Bond Position:  [21.87855465]


portfolio before change:  [15.46974313]
curr_Stock_Price:  96.0939899294659
curr_Factors:  [96.09398993]
mat_Sqrt:  [[0.15]]
grads:  [0.0797892]
Stock Position:  0.0797892042919257
Bond Position:  [7.80248014]


portfolio before change:  [15.44434101]
curr_Stock_Price:  95.76340016921075
curr_Factors:  [95.76340017]
mat_Sqrt:  [[0.15]]
grads:  [0.00349648]
Stock Position:  0.003496478681362259
Bond Position:  [15.10950632]


portfolio before change:  [15.44450646]
curr_Stock_Price:  95.27051774058214
curr_Factors:  [95.27051774]
mat_Sqrt:  [[0.15]]
grads:  [0.16756875]
Stock Position:  0.16756875248129813
Bond Position:  [-0.51985534]


portfolio before change:  [15.48782082]
curr_Stock_Price:  95.5293926195412
curr_Factors:  [95.52939262]
mat_Sqrt:  [[0.15]]
grads:  [-0.03001257]
Stock Position:  -0.030012572752089805
Bond Position:  [18.35490366]


portfolio before change:  [15.49608739]
curr_Stock_Price:  95.33040701172357
curr_Factors:  [95.33040701]
mat_Sqrt:  [[0.15]]
grads:  [-0.2200374]
Stock Position:  -0.2200374014081653
Bond Position:  [36.47234243]


portfolio before change:  [15.34457205]
curr_Stock_Price:  96.03971676067702
curr_Factors:  [96.03971676]
mat_Sqrt:  [[0.15]]
grads:  [-0.07305915]
Stock Position:  -0.07305914965190004
Bond Position:  [22.36115209]


portfolio before change:  [15.3430195]
curr_Stock_Price:  96.09922829919546
curr_Factors:  [96.0992283]
mat_Sqrt:  [[0.15]]
grads:  [0.27485117]
Stock Position:  0.2748511737454867
Bond Position:  [-11.06996619]


portfolio before change:  [15.33791178]
curr_Stock_Price:  96.08567953681109
curr_Factors:  [96.08567954]
mat_Sqrt:  [[0.15]]
grads:  [0.02338109]
Stock Position:  0.023381091037963462
Bond Position:  [13.09132376]


portfolio before change:  [15.35294944]
curr_Stock_Price:  96.65884117416799
curr_Factors:  [96.65884117]
mat_Sqrt:  [[0.15]]
grads:  [-0.10092853]
Stock Position:  -0.10092853184741328
Bond Position:  [25.10858437]


portfolio before change:  [15.38668472]
curr_Stock_Price:  96.35569095031245
curr_Factors:  [96.35569095]
mat_Sqrt:  [[0.15]]
grads:  [-0.28383781]
Stock Position:  -0.28383781059630425
Bond Position:  [42.73607307]


portfolio before change:  [15.45637789]
curr_Stock_Price:  96.12897403876856
curr_Factors:  [96.12897404]
mat_Sqrt:  [[0.15]]
grads:  [-0.15388523]
Stock Position:  -0.15388523078539193
Bond Position:  [30.24920725]


portfolio before change:  [15.4132974]
curr_Stock_Price:  96.43349890941258
curr_Factors:  [96.43349891]
mat_Sqrt:  [[0.15]]
grads:  [0.25852692]
Stock Position:  0.2585269164847648
Bond Position:  [-9.51735772]


portfolio before change:  [16.04853377]
curr_Stock_Price:  98.89523917338826
curr_Factors:  [98.89523917]
mat_Sqrt:  [[0.15]]
grads:  [0.02130231]
Stock Position:  0.02130230878413835
Bond Position:  [13.94183685]


portfolio before change:  [16.07074965]
curr_Stock_Price:  99.8563106615946
curr_Factors:  [99.85631066]
mat_Sqrt:  [[0.15]]
grads:  [0.05840112]
Stock Position:  0.05840112489037943
Bond Position:  [10.23902878]


portfolio before change:  [16.08615981]
curr_Stock_Price:  100.09826148796043
curr_Factors:  [100.09826149]
mat_Sqrt:  [[0.15]]
grads:  [0.04200524]
Stock Position:  0.04200524116044244
Bond Position:  [11.8815082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.10137025]
Stock Price:  100.42501003413125
PL:  [15.67636021]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-6.11115336e-02]
 [-6.08880278e-02]
 [ 6.68684749e-03]
 [-2.36474562e-03]
 [-4.22173623e-03]
 [ 2.87615990e-02]
 [ 3.68446477e-03]
 [ 4.48997743e-03]
 [-2.58919640e-02]
 [ 2.31109415e-02]
 [ 1.91587899e-02]
 [-1.23912234e-02]
 [-7.47834549e-03]
 [ 1.36714192e-02]
 [-1.83195075e-02]
 [-3.54944176e-04]
 [-6.08229379e-03]
 [ 3.46418035e-03]
 [ 5.21958482e-03]
 [-2.58539624e-02]
 [-2.74510699e-03]
 [-1.10018119e-02]
 [ 7.09436913e-03]
 [-6.35684143e-03]
 [ 1.43877922e-02]
 [ 7.68844527e-03]
 [-4.92699030e-03]
 [-2.40607277e-03]
 [ 5.54029505e-04]
 [-6.33671897e-03]
 [-1.72434536e-02]
 [ 5.85042308e-03]
 [ 4.82672135e-04]
 [-6.75773376e-03]
 [-2.02294772e-02]
 [ 2.28543796e-03]
 [ 1.08760193e-02]
 [ 1.87832953e-02]
 [ 9.27317661e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.6934793]
curr_Stock_Price:  101.63086492858761
curr_Factors:  [101.63086493]
mat_Sqrt:  [[0.15]]
grads:  [-0.40741022]
Stock Position:  -0.4074102236733151
Bond Position:  [79.09893271]


portfolio before change:  [37.34460675]
curr_Stock_Price:  102.5114528707329
curr_Factors:  [102.51145287]
mat_Sqrt:  [[0.15]]
grads:  [-0.40592019]
Stock Position:  -0.4059201853680641
Bond Position:  [78.9560747]


portfolio before change:  [37.57695779]
curr_Stock_Price:  101.96336257820644
curr_Factors:  [101.96336258]
mat_Sqrt:  [[0.15]]
grads:  [0.04457898]
Stock Position:  0.04457898329545023
Bond Position:  [33.03153475]


portfolio before change:  [37.55694694]
curr_Stock_Price:  101.42185079126386
curr_Factors:  [101.42185079]
mat_Sqrt:  [[0.15]]
grads:  [-0.01576497]
Stock Position:  -0.01576497081758651
Bond Position:  [39.15585946]


portfolio before change:  [37.57111151]
curr_Stock_Price:  100.83385271669265
curr_Factors:  [100.83385272]
mat_Sqrt:  [[0.15]]
grads:  [-0.02814491]
Stock Position:  -0.028144908230610326
Bond Position:  [40.40907104]


portfolio before change:  [37.60204696]
curr_Stock_Price:  99.91418356670975
curr_Factors:  [99.91418357]
mat_Sqrt:  [[0.15]]
grads:  [0.19174399]
Stock Position:  0.19174399339046458
Bond Position:  [18.44410241]


portfolio before change:  [37.66768974]
curr_Stock_Price:  100.24450486773338
curr_Factors:  [100.24450487]
mat_Sqrt:  [[0.15]]
grads:  [0.0245631]
Stock Position:  0.024563098465927323
Bond Position:  [35.2053741]


portfolio before change:  [37.67435917]
curr_Stock_Price:  100.33685819510814
curr_Factors:  [100.3368582]
mat_Sqrt:  [[0.15]]
grads:  [0.02993318]
Stock Position:  0.029933182843966205
Bond Position:  [34.67095765]


portfolio before change:  [37.67620996]
curr_Stock_Price:  100.25389516240604
curr_Factors:  [100.25389516]
mat_Sqrt:  [[0.15]]
grads:  [-0.17261309]
Stock Position:  -0.17261309365464397
Bond Position:  [54.98134496]


portfolio before change:  [37.51767734]
curr_Stock_Price:  101.21214064704229
curr_Factors:  [101.21214065]
mat_Sqrt:  [[0.15]]
grads:  [0.15407294]
Stock Position:  0.15407294301081745
Bond Position:  [21.92362497]


portfolio before change:  [37.35602072]
curr_Stock_Price:  100.14513146559693
curr_Factors:  [100.14513147]
mat_Sqrt:  [[0.15]]
grads:  [0.12772527]
Stock Position:  0.12772526593467506
Bond Position:  [24.56495718]


portfolio before change:  [37.14607063]
curr_Stock_Price:  98.47732593809327
curr_Factors:  [98.47732594]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260816]
Stock Position:  -0.08260815570311648
Bond Position:  [45.28110091]


portfolio before change:  [37.22400256]
curr_Stock_Price:  97.60245549227459
curr_Factors:  [97.60245549]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985564]
Stock Position:  -0.049855636631276026
Bond Position:  [42.09003511]


portfolio before change:  [37.24698835]
curr_Stock_Price:  97.24694489487979
curr_Factors:  [97.24694489]
mat_Sqrt:  [[0.15]]
grads:  [0.09114279]
Stock Position:  0.09114279484934325
Bond Position:  [28.38363]


portfolio before change:  [37.21758243]
curr_Stock_Price:  96.88537940939814
curr_Factors:  [96.88537941]
mat_Sqrt:  [[0.15]]
grads:  [-0.12213005]
Stock Position:  -0.1221300502096827
Bond Position:  [49.05019869]


portfolio before change:  [37.32975295]
curr_Stock_Price:  96.01713401379551
curr_Factors:  [96.01713401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236629]
Stock Position:  -0.0023662945052673086
Bond Position:  [37.55695776]


portfolio before change:  [37.33082783]
curr_Stock_Price:  97.54696416781695
curr_Factors:  [97.54696417]
mat_Sqrt:  [[0.15]]
grads:  [-0.04054863]
Stock Position:  -0.04054862526713357
Bond Position:  [41.28622313]


portfolio before change:  [37.2846305]
curr_Stock_Price:  98.81355296679799
curr_Factors:  [98.81355297]
mat_Sqrt:  [[0.15]]
grads:  [0.02309454]
Stock Position:  0.023094535686564867
Bond Position:  [35.00257737]


portfolio before change:  [37.29302673]
curr_Stock_Price:  98.98764767332243
curr_Factors:  [98.98764767]
mat_Sqrt:  [[0.15]]
grads:  [0.03479723]
Stock Position:  0.03479723216276865
Bond Position:  [33.84853057]


portfolio before change:  [37.29534417]
curr_Stock_Price:  98.93264642863079
curr_Factors:  [98.93264643]
mat_Sqrt:  [[0.15]]
grads:  [-0.17235975]
Stock Position:  -0.17235974951812758
Bond Position:  [54.34735033]


portfolio before change:  [37.30247147]
curr_Stock_Price:  98.93071173161967
curr_Factors:  [98.93071173]
mat_Sqrt:  [[0.15]]
grads:  [-0.01830071]
Stock Position:  -0.018300713250461922
Bond Position:  [39.11297406]


portfolio before change:  [37.31196118]
curr_Stock_Price:  98.67934004873105
curr_Factors:  [98.67934005]
mat_Sqrt:  [[0.15]]
grads:  [-0.07334541]
Stock Position:  -0.07334541259359179
Bond Position:  [44.54963809]


portfolio before change:  [37.26872313]
curr_Stock_Price:  99.3447818897547
curr_Factors:  [99.34478189]
mat_Sqrt:  [[0.15]]
grads:  [0.04729579]
Stock Position:  0.047295794207339245
Bond Position:  [32.57013277]


portfolio before change:  [37.26164447]
curr_Stock_Price:  99.10902766711565
curr_Factors:  [99.10902767]
mat_Sqrt:  [[0.15]]
grads:  [-0.04237894]
Stock Position:  -0.04237894289597661
Bond Position:  [41.46178029]


portfolio before change:  [37.29958936]
curr_Stock_Price:  98.33595873844558
curr_Factors:  [98.33595874]
mat_Sqrt:  [[0.15]]
grads:  [0.09591861]
Stock Position:  0.09591861448471017
Bond Position:  [27.86734044]


portfolio before change:  [37.37231694]
curr_Stock_Price:  99.05786183663359
curr_Factors:  [99.05786184]
mat_Sqrt:  [[0.15]]
grads:  [0.0512563]
Stock Position:  0.05125630178729247
Bond Position:  [32.29497728]


portfolio before change:  [37.43451795]
curr_Stock_Price:  100.19262747507923
curr_Factors:  [100.19262748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0328466]
Stock Position:  -0.03284660198825045
Bond Position:  [40.72550531]


portfolio before change:  [37.47154572]
curr_Stock_Price:  99.22032730180405
curr_Factors:  [99.2203273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604049]
Stock Position:  -0.016040485140444795
Bond Position:  [39.0630879]


portfolio before change:  [37.4560843]
curr_Stock_Price:  100.48865584973838
curr_Factors:  [100.48865585]
mat_Sqrt:  [[0.15]]
grads:  [0.00369353]
Stock Position:  0.003693530032352972
Bond Position:  [37.08492643]


portfolio before change:  [37.46545207]
curr_Stock_Price:  101.76977853759752
curr_Factors:  [101.76977854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04224479]
Stock Position:  -0.04224479310017425
Bond Position:  [41.76469531]


portfolio before change:  [37.38167113]
curr_Stock_Price:  103.87659095663338
curr_Factors:  [103.87659096]
mat_Sqrt:  [[0.15]]
grads:  [-0.11495636]
Stock Position:  -0.11495635718426413
Bond Position:  [49.32294562]


portfolio before change:  [37.3087665]
curr_Stock_Price:  104.56442055675251
curr_Factors:  [104.56442056]
mat_Sqrt:  [[0.15]]
grads:  [0.03900282]
Stock Position:  0.039002820506743925
Bond Position:  [33.23045917]


portfolio before change:  [37.28018496]
curr_Stock_Price:  103.72510678274057
curr_Factors:  [103.72510678]
mat_Sqrt:  [[0.15]]
grads:  [0.00321781]
Stock Position:  0.0032178142342145838
Bond Position:  [36.94641684]


portfolio before change:  [37.28482601]
curr_Stock_Price:  103.73208567789906
curr_Factors:  [103.73208568]
mat_Sqrt:  [[0.15]]
grads:  [-0.04505156]
Stock Position:  -0.04505155841751646
Bond Position:  [41.95811813]


portfolio before change:  [37.27191827]
curr_Stock_Price:  104.13502029662028
curr_Factors:  [104.1350203]
mat_Sqrt:  [[0.15]]
grads:  [-0.13486318]
Stock Position:  -0.13486318121911903
Bond Position:  [51.31589838]


portfolio before change:  [37.22319416]
curr_Stock_Price:  104.54387167141007
curr_Factors:  [104.54387167]
mat_Sqrt:  [[0.15]]
grads:  [0.01523625]
Stock Position:  0.015236253058353879
Bond Position:  [35.63033728]


portfolio before change:  [37.23659724]
curr_Stock_Price:  105.13122138736045
curr_Factors:  [105.13122139]
mat_Sqrt:  [[0.15]]
grads:  [0.0725068]
Stock Position:  0.07250679539565999
Bond Position:  [29.61386928]


portfolio before change:  [37.31004927]
curr_Stock_Price:  106.09320114389726
curr_Factors:  [106.09320114]
mat_Sqrt:  [[0.15]]
grads:  [0.12522197]
Stock Position:  0.1252219683420668
Bond Position:  [24.0248498]


portfolio before change:  [37.20459311]
curr_Stock_Price:  105.22706354287584
curr_Factors:  [105.22706354]
mat_Sqrt:  [[0.15]]
grads:  [0.06182118]
Stock Position:  0.06182117739063264
Bond Position:  [30.69933215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [37.27711902]
Stock Price:  106.33814315314363
PL:  [30.93897587]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.43838904e-02]
 [-1.89201295e-02]
 [ 6.36325305e-03]
 [-8.10346045e-04]
 [-4.43450358e-03]
 [ 3.26364805e-02]
 [ 3.55310540e-03]
 [-1.44697469e-03]
 [-2.76756234e-02]
 [ 2.34391104e-02]
 [ 2.05445166e-02]
 [-1.33712058e-02]
 [ 7.71925450e-03]
 [ 6.80020236e-03]
 [-1.73078377e-02]
 [ 5.83469050e-05]
 [-6.08605413e-03]
 [-2.92319202e-03]
 [ 1.23663175e-03]
 [ 2.62867518e-03]
 [-1.29787483e-02]
 [-2.05624089e-02]
 [ 4.92982958e-03]
 [-1.07725436e-02]
 [ 1.10277948e-02]
 [-5.17273070e-04]
 [ 2.51331720e-02]
 [-4.51479424e-03]
 [-3.30621678e-02]
 [-8.70629587e-03]
 [ 5.30895948e-02]
 [-5.33600896e-03]
 [-2.19784804e-02]
 [-8.44192043e-03]
 [-2.44462192e-02]
 [ 3.03149301e-02]
 [-1.14019236e-02]
 [-8.67571175e-03]
 [ 4.12881019e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.87274827]
curr_Stock_Price:  100.50037863643435
curr_Factors:  [100.50037864]
mat_Sqrt:  [[0.15]]
grads:  [-0.0958926]
Stock Position:  -0.09589260235150585
Bond Position:  [22.50999112]


portfolio before change:  [12.76746485]
curr_Stock_Price:  101.62765379131348
curr_Factors:  [101.62765379]
mat_Sqrt:  [[0.15]]
grads:  [-0.1261342]
Stock Position:  -0.12613419641509288
Bond Position:  [25.58618729]


portfolio before change:  [12.73165692]
curr_Stock_Price:  101.9368990545983
curr_Factors:  [101.93689905]
mat_Sqrt:  [[0.15]]
grads:  [0.04242169]
Stock Position:  0.04242168699470378
Bond Position:  [8.4073217]


portfolio before change:  [12.7227536]
curr_Stock_Price:  101.7022477262584
curr_Factors:  [101.70224773]
mat_Sqrt:  [[0.15]]
grads:  [-0.00540231]
Stock Position:  -0.005402306969801126
Bond Position:  [13.27218036]


portfolio before change:  [12.72943077]
curr_Stock_Price:  100.77337594299274
curr_Factors:  [100.77337594]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956336]
Stock Position:  -0.029563357216782524
Bond Position:  [15.70863008]


portfolio before change:  [12.78880035]
curr_Stock_Price:  98.83158453809055
curr_Factors:  [98.83158454]
mat_Sqrt:  [[0.15]]
grads:  [0.21757654]
Stock Position:  0.21757653668624696
Bond Position:  [-8.71463353]


portfolio before change:  [12.78013828]
curr_Stock_Price:  98.79677991117416
curr_Factors:  [98.79677991]
mat_Sqrt:  [[0.15]]
grads:  [0.02368737]
Stock Position:  0.023687369362550642
Bond Position:  [10.43990246]


portfolio before change:  [12.80037714]
curr_Stock_Price:  99.59609999649368
curr_Factors:  [99.5961]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096465]
Stock Position:  -0.009646497930461856
Bond Position:  [13.76113071]


portfolio before change:  [12.80288858]
curr_Stock_Price:  99.51408180293033
curr_Factors:  [99.5140818]
mat_Sqrt:  [[0.15]]
grads:  [-0.18450416]
Stock Position:  -0.18450415598222053
Bond Position:  [31.16365025]


portfolio before change:  [12.93363745]
curr_Stock_Price:  98.82654619097113
curr_Factors:  [98.82654619]
mat_Sqrt:  [[0.15]]
grads:  [0.15626074]
Stock Position:  0.15626073621180764
Bond Position:  [-2.50907141]


portfolio before change:  [12.91907237]
curr_Stock_Price:  98.73534329161963
curr_Factors:  [98.73534329]
mat_Sqrt:  [[0.15]]
grads:  [0.13696344]
Stock Position:  0.1369634437623562
Bond Position:  [-0.60406027]


portfolio before change:  [12.92010724]
curr_Stock_Price:  98.74345044708001
curr_Factors:  [98.74345045]
mat_Sqrt:  [[0.15]]
grads:  [-0.08914137]
Stock Position:  -0.08914137174933505
Bond Position:  [21.72223386]


portfolio before change:  [12.91833613]
curr_Stock_Price:  98.79378125998281
curr_Factors:  [98.79378126]
mat_Sqrt:  [[0.15]]
grads:  [0.0514617]
Stock Position:  0.05146169668678741
Bond Position:  [7.83424053]


portfolio before change:  [12.90183205]
curr_Stock_Price:  98.45404467171635
curr_Factors:  [98.45404467]
mat_Sqrt:  [[0.15]]
grads:  [0.04533468]
Stock Position:  0.04533468238718084
Bond Position:  [8.43844921]


portfolio before change:  [12.85755317]
curr_Stock_Price:  97.45406512613674
curr_Factors:  [97.45406513]
mat_Sqrt:  [[0.15]]
grads:  [-0.11538558]
Stock Position:  -0.11538558488463374
Bond Position:  [24.10234747]


portfolio before change:  [12.94037579]
curr_Stock_Price:  96.76238735356542
curr_Factors:  [96.76238735]
mat_Sqrt:  [[0.15]]
grads:  [0.00038898]
Stock Position:  0.00038897936661459455
Bond Position:  [12.90273722]


portfolio before change:  [12.94167644]
curr_Stock_Price:  95.95951567535646
curr_Factors:  [95.95951568]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057369]
Stock Position:  -0.040573694195836896
Bond Position:  [16.83510848]


portfolio before change:  [12.93877904]
curr_Stock_Price:  96.08279542012235
curr_Factors:  [96.08279542]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948795]
Stock Position:  -0.019487946767337377
Bond Position:  [14.81123545]


portfolio before change:  [12.93892405]
curr_Stock_Price:  96.17036297856966
curr_Factors:  [96.17036298]
mat_Sqrt:  [[0.15]]
grads:  [0.00824421]
Stock Position:  0.0082442116773565
Bond Position:  [12.14607522]


portfolio before change:  [12.93373556]
curr_Stock_Price:  95.35684099598173
curr_Factors:  [95.356841]
mat_Sqrt:  [[0.15]]
grads:  [0.0175245]
Stock Position:  0.017524501166836227
Bond Position:  [11.26265449]


portfolio before change:  [12.94408961]
curr_Stock_Price:  95.86733368233101
curr_Factors:  [95.86733368]
mat_Sqrt:  [[0.15]]
grads:  [-0.08652499]
Stock Position:  -0.08652498891417555
Bond Position:  [21.23900959]


portfolio before change:  [12.9174165]
curr_Stock_Price:  96.20628949265138
curr_Factors:  [96.20628949]
mat_Sqrt:  [[0.15]]
grads:  [-0.13708273]
Stock Position:  -0.13708272575299257
Bond Position:  [26.1056369]


portfolio before change:  [12.97905951]
curr_Stock_Price:  95.78041817887627
curr_Factors:  [95.78041818]
mat_Sqrt:  [[0.15]]
grads:  [0.03286553]
Stock Position:  0.032865530537009344
Bond Position:  [9.83118525]


portfolio before change:  [12.97843638]
curr_Stock_Price:  95.72406419910781
curr_Factors:  [95.7240642]
mat_Sqrt:  [[0.15]]
grads:  [-0.07181696]
Stock Position:  -0.07181695729887998
Bond Position:  [19.85304741]


portfolio before change:  [13.02101403]
curr_Stock_Price:  95.16575789166609
curr_Factors:  [95.16575789]
mat_Sqrt:  [[0.15]]
grads:  [0.07351863]
Stock Position:  0.07351863173557435
Bond Position:  [6.02455772]


portfolio before change:  [13.01796242]
curr_Stock_Price:  95.11400603691852
curr_Factors:  [95.11400604]
mat_Sqrt:  [[0.15]]
grads:  [-0.00344849]
Stock Position:  -0.0034484871314277694
Bond Position:  [13.34596185]


portfolio before change:  [13.0190897]
curr_Stock_Price:  95.27090700131498
curr_Factors:  [95.270907]
mat_Sqrt:  [[0.15]]
grads:  [0.16755448]
Stock Position:  0.1675544797097178
Bond Position:  [-2.94397756]


portfolio before change:  [13.05702242]
curr_Stock_Price:  95.49949377396422
curr_Factors:  [95.49949377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03009863]
Stock Position:  -0.030098628244618574
Bond Position:  [15.93142618]


portfolio before change:  [13.06428101]
curr_Stock_Price:  95.32450103325209
curr_Factors:  [95.32450103]
mat_Sqrt:  [[0.15]]
grads:  [-0.22041445]
Stock Position:  -0.22041445183898867
Bond Position:  [34.07517865]


portfolio before change:  [13.32547595]
curr_Stock_Price:  94.15880941287196
curr_Factors:  [94.15880941]
mat_Sqrt:  [[0.15]]
grads:  [-0.05804197]
Stock Position:  -0.0580419724619859
Bond Position:  [18.79063898]


portfolio before change:  [13.36740477]
curr_Stock_Price:  93.47689188568609
curr_Factors:  [93.47689189]
mat_Sqrt:  [[0.15]]
grads:  [0.35393063]
Stock Position:  0.3539306320970239
Bond Position:  [-19.71693066]


portfolio before change:  [13.17444302]
curr_Stock_Price:  92.93865937354386
curr_Factors:  [92.93865937]
mat_Sqrt:  [[0.15]]
grads:  [-0.03557339]
Stock Position:  -0.03557339306872372
Bond Position:  [16.48058649]


portfolio before change:  [13.15827636]
curr_Stock_Price:  93.45103302387517
curr_Factors:  [93.45103302]
mat_Sqrt:  [[0.15]]
grads:  [-0.1465232]
Stock Position:  -0.14652320278233222
Bond Position:  [26.85102102]


portfolio before change:  [13.28204273]
curr_Stock_Price:  92.62925340588755
curr_Factors:  [92.62925341]
mat_Sqrt:  [[0.15]]
grads:  [-0.05627947]
Stock Position:  -0.056279469538582094
Bond Position:  [18.49516797]


portfolio before change:  [13.31135076]
curr_Stock_Price:  92.1495759600725
curr_Factors:  [92.14957596]
mat_Sqrt:  [[0.15]]
grads:  [-0.16297479]
Stock Position:  -0.16297479476969537
Bond Position:  [28.32940899]


portfolio before change:  [13.16953345]
curr_Stock_Price:  93.0414851115489
curr_Factors:  [93.04148511]
mat_Sqrt:  [[0.15]]
grads:  [0.20209953]
Stock Position:  0.20209953410022263
Bond Position:  [-5.63410735]


portfolio before change:  [13.10096086]
curr_Stock_Price:  92.70566902855248
curr_Factors:  [92.70566903]
mat_Sqrt:  [[0.15]]
grads:  [-0.07601282]
Stock Position:  -0.07601282408905244
Bond Position:  [20.14778058]


portfolio before change:  [13.06401115]
curr_Stock_Price:  93.22490179644004
curr_Factors:  [93.2249018]
mat_Sqrt:  [[0.15]]
grads:  [-0.05783808]
Stock Position:  -0.057838078323198795
Bond Position:  [18.45596032]


portfolio before change:  [13.1025213]
curr_Stock_Price:  92.59896435698906
curr_Factors:  [92.59896436]
mat_Sqrt:  [[0.15]]
grads:  [0.27525401]
Stock Position:  0.27525401238300046
Bond Position:  [-12.38571518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.19866115]
Stock Price:  92.95386619448503
PL:  [13.19866115]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.04871246e-02]
 [ 3.22980530e-02]
 [-8.06471033e-03]
 [-3.07936318e-03]
 [-7.58707128e-03]
 [ 3.29046743e-02]
 [ 3.49964153e-03]
 [ 1.93887815e-02]
 [-1.13125348e-02]
 [ 2.28082785e-02]
 [ 1.88192372e-02]
 [-8.56278213e-03]
 [ 9.05663705e-03]
 [ 2.30849922e-02]
 [-1.04208730e-02]
 [-3.40323307e-03]
 [-4.96029243e-03]
 [ 7.85379614e-03]
 [ 2.68906975e-02]
 [ 5.28591373e-03]
 [-6.86996278e-05]
 [-4.59119848e-03]
 [ 4.13896393e-03]
 [-1.08199994e-02]
 [-6.09881015e-03]
 [ 4.53036926e-03]
 [ 3.73454533e-03]
 [ 6.98397861e-04]
 [ 4.80162256e-03]
 [-3.60341841e-03]
 [-1.68727730e-02]
 [ 7.30478821e-03]
 [-3.22344996e-04]
 [-1.76624866e-02]
 [-2.03518028e-02]
 [ 2.15689997e-02]
 [ 4.54443154e-03]
 [ 9.78717265e-03]
 [ 9.04007571e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.67259192]
curr_Stock_Price:  99.4279813607757
curr_Factors:  [99.42798136]
mat_Sqrt:  [[0.15]]
grads:  [-0.06991416]
Stock Position:  -0.06991416379674723
Bond Position:  [-3.72116774]


portfolio before change:  [-10.67732197]
curr_Stock_Price:  99.48898307159077
curr_Factors:  [99.48898307]
mat_Sqrt:  [[0.15]]
grads:  [0.21532035]
Stock Position:  0.21532035325579235
Bond Position:  [-32.09932495]


portfolio before change:  [-10.69898226]
curr_Stock_Price:  99.40702324499709
curr_Factors:  [99.40702324]
mat_Sqrt:  [[0.15]]
grads:  [-0.05376474]
Stock Position:  -0.05376473553405998
Bond Position:  [-5.35438994]


portfolio before change:  [-10.75566445]
curr_Stock_Price:  100.44883716162832
curr_Factors:  [100.44883716]
mat_Sqrt:  [[0.15]]
grads:  [-0.02052909]
Stock Position:  -0.02052908786149049
Bond Position:  [-8.69354145]


portfolio before change:  [-10.7466796]
curr_Stock_Price:  99.95823503938259
curr_Factors:  [99.95823504]
mat_Sqrt:  [[0.15]]
grads:  [-0.05058048]
Stock Position:  -0.05058047517650488
Bond Position:  [-5.69074457]


portfolio before change:  [-10.78965977]
curr_Stock_Price:  100.79390901632148
curr_Factors:  [100.79390902]
mat_Sqrt:  [[0.15]]
grads:  [0.2193645]
Stock Position:  0.21936449514722772
Bond Position:  [-32.90026474]


portfolio before change:  [-10.47848395]
curr_Stock_Price:  102.23119087344499
curr_Factors:  [102.23119087]
mat_Sqrt:  [[0.15]]
grads:  [0.02333094]
Stock Position:  0.02333094353394108
Bond Position:  [-12.86363409]


portfolio before change:  [-10.47650612]
curr_Stock_Price:  102.38488742983922
curr_Factors:  [102.38488743]
mat_Sqrt:  [[0.15]]
grads:  [0.12925854]
Stock Position:  0.12925854304059295
Bond Position:  [-23.7106275]


portfolio before change:  [-10.53402107]
curr_Stock_Price:  101.96285778153448
curr_Factors:  [101.96285778]
mat_Sqrt:  [[0.15]]
grads:  [-0.0754169]
Stock Position:  -0.07541689854474126
Bond Position:  [-2.84429857]


portfolio before change:  [-10.58636235]
curr_Stock_Price:  102.65216903609407
curr_Factors:  [102.65216904]
mat_Sqrt:  [[0.15]]
grads:  [0.15205519]
Stock Position:  0.15205519026684533
Bond Position:  [-26.19515744]


portfolio before change:  [-10.66168986]
curr_Stock_Price:  102.17830874310096
curr_Factors:  [102.17830874]
mat_Sqrt:  [[0.15]]
grads:  [0.12546158]
Stock Position:  0.1254615814183239
Bond Position:  [-23.48114207]


portfolio before change:  [-10.68361007]
curr_Stock_Price:  102.02698847168888
curr_Factors:  [102.02698847]
mat_Sqrt:  [[0.15]]
grads:  [-0.05708521]
Stock Position:  -0.057085214197829415
Bond Position:  [-4.85937758]


portfolio before change:  [-10.72672326]
curr_Stock_Price:  102.7715897878172
curr_Factors:  [102.77158979]
mat_Sqrt:  [[0.15]]
grads:  [0.06037758]
Stock Position:  0.060377580329059335
Bond Position:  [-16.93182318]


portfolio before change:  [-10.75686368]
curr_Stock_Price:  102.30744710352808
curr_Factors:  [102.3074471]
mat_Sqrt:  [[0.15]]
grads:  [0.15389995]
Stock Position:  0.1538999478206979
Bond Position:  [-26.50197445]


portfolio before change:  [-10.57698721]
curr_Stock_Price:  103.49776217421834
curr_Factors:  [103.49776217]
mat_Sqrt:  [[0.15]]
grads:  [-0.06947249]
Stock Position:  -0.06947248642321975
Bond Position:  [-3.38674033]


portfolio before change:  [-10.58873961]
curr_Stock_Price:  103.6608344420087
curr_Factors:  [103.66083444]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268822]
Stock Position:  -0.022688220470258952
Bond Position:  [-8.23685975]


portfolio before change:  [-10.58883075]
curr_Stock_Price:  103.6194676917083
curr_Factors:  [103.61946769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03306862]
Stock Position:  -0.03306861619594575
Bond Position:  [-7.16227834]


portfolio before change:  [-10.62152632]
curr_Stock_Price:  104.58111159871825
curr_Factors:  [104.5811116]
mat_Sqrt:  [[0.15]]
grads:  [0.05235864]
Stock Position:  0.05235864093108347
Bond Position:  [-16.09725119]


portfolio before change:  [-10.58139025]
curr_Stock_Price:  105.38610484086942
curr_Factors:  [105.38610484]
mat_Sqrt:  [[0.15]]
grads:  [0.17927132]
Stock Position:  0.1792713164489127
Bond Position:  [-29.474096]


portfolio before change:  [-10.81107278]
curr_Stock_Price:  104.12545675773472
curr_Factors:  [104.12545676]
mat_Sqrt:  [[0.15]]
grads:  [0.03523942]
Stock Position:  0.035239424893380375
Bond Position:  [-14.480394]


portfolio before change:  [-10.84742906]
curr_Stock_Price:  103.1451309036771
curr_Factors:  [103.1451309]
mat_Sqrt:  [[0.15]]
grads:  [-0.000458]
Stock Position:  -0.00045799751853574714
Bond Position:  [-10.80018885]


portfolio before change:  [-10.84843907]
curr_Stock_Price:  102.40255036520097
curr_Factors:  [102.40255037]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060799]
Stock Position:  -0.03060798988552704
Bond Position:  [-7.71410285]


portfolio before change:  [-10.87619946]
curr_Stock_Price:  103.2780101827977
curr_Factors:  [103.27801018]
mat_Sqrt:  [[0.15]]
grads:  [0.02759309]
Stock Position:  0.027593092867124164
Bond Position:  [-13.72595919]


portfolio before change:  [-10.86230775]
curr_Stock_Price:  103.84364327765826
curr_Factors:  [103.84364328]
mat_Sqrt:  [[0.15]]
grads:  [-0.07213333]
Stock Position:  -0.07213332945514637
Bond Position:  [-3.37172001]


portfolio before change:  [-10.9481782]
curr_Stock_Price:  105.02824078583286
curr_Factors:  [105.02824079]
mat_Sqrt:  [[0.15]]
grads:  [-0.04065873]
Stock Position:  -0.0406587343049341
Bond Position:  [-6.67786286]


portfolio before change:  [-10.93353012]
curr_Stock_Price:  104.64744024088166
curr_Factors:  [104.64744024]
mat_Sqrt:  [[0.15]]
grads:  [0.03020246]
Stock Position:  0.030202461764310976
Bond Position:  [-14.09414043]


portfolio before change:  [-10.96175175]
curr_Stock_Price:  103.77136074554238
curr_Factors:  [103.77136075]
mat_Sqrt:  [[0.15]]
grads:  [0.02489697]
Stock Position:  0.02489696888619965
Bond Position:  [-13.54534409]


portfolio before change:  [-10.99480042]
curr_Stock_Price:  102.51195454602937
curr_Factors:  [102.51195455]
mat_Sqrt:  [[0.15]]
grads:  [0.00465599]
Stock Position:  0.004655985742115255
Bond Position:  [-11.47209462]


portfolio before change:  [-10.99102455]
curr_Stock_Price:  103.630939492918
curr_Factors:  [103.63093949]
mat_Sqrt:  [[0.15]]
grads:  [0.03201082]
Stock Position:  0.03201081708236106
Bond Position:  [-14.30833559]


portfolio before change:  [-10.95642817]
curr_Stock_Price:  104.76758752264455
curr_Factors:  [104.76758752]
mat_Sqrt:  [[0.15]]
grads:  [-0.02402279]
Stock Position:  -0.02402278941648567
Bond Position:  [-8.43961848]


portfolio before change:  [-10.94218757]
curr_Stock_Price:  104.13087461309452
curr_Factors:  [104.13087461]
mat_Sqrt:  [[0.15]]
grads:  [-0.11248515]
Stock Position:  -0.11248515307180097
Bond Position:  [0.7709898]


portfolio before change:  [-10.87459457]
curr_Stock_Price:  103.53082552451293
curr_Factors:  [103.53082552]
mat_Sqrt:  [[0.15]]
grads:  [0.04869859]
Stock Position:  0.04869858808323974
Bond Position:  [-15.9163996]


portfolio before change:  [-10.88117366]
curr_Stock_Price:  103.43658430543945
curr_Factors:  [103.43658431]
mat_Sqrt:  [[0.15]]
grads:  [-0.00214897]
Stock Position:  -0.0021489666382290377
Bond Position:  [-10.65889189]


portfolio before change:  [-10.88199392]
curr_Stock_Price:  103.19824151798281
curr_Factors:  [103.19824152]
mat_Sqrt:  [[0.15]]
grads:  [-0.11774991]
Stock Position:  -0.11774991072340445
Bond Position:  [1.26958981]


portfolio before change:  [-10.83938527]
curr_Stock_Price:  102.83773219175242
curr_Factors:  [102.83773219]
mat_Sqrt:  [[0.15]]
grads:  [-0.13567869]
Stock Position:  -0.1356786855526973
Bond Position:  [3.11350306]


portfolio before change:  [-10.77870372]
curr_Stock_Price:  102.39335631580153
curr_Factors:  [102.39335632]
mat_Sqrt:  [[0.15]]
grads:  [0.14379333]
Stock Position:  0.14379333148186815
Bond Position:  [-25.50218555]


portfolio before change:  [-10.98914764]
curr_Stock_Price:  100.9520102423531
curr_Factors:  [100.95201024]
mat_Sqrt:  [[0.15]]
grads:  [0.03029621]
Stock Position:  0.03029621025375212
Bond Position:  [-14.04761097]


portfolio before change:  [-11.00638353]
curr_Stock_Price:  100.44106107715433
curr_Factors:  [100.44106108]
mat_Sqrt:  [[0.15]]
grads:  [0.06524782]
Stock Position:  0.0652478176836289
Bond Position:  [-17.55994357]


portfolio before change:  [-10.9225743]
curr_Stock_Price:  101.75917956246792
curr_Factors:  [101.75917956]
mat_Sqrt:  [[0.15]]
grads:  [0.06026717]
Stock Position:  0.060267171421199986
Bond Position:  [-17.05531222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.94084067]
Stock Price:  101.49146633409318
PL:  [-12.43230701]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.05181470e-02]
 [ 4.41333675e-02]
 [ 5.02456683e-03]
 [ 1.01738398e-03]
 [-1.77208010e-03]
 [ 1.61028720e-02]
 [ 3.74390872e-03]
 [ 5.50671004e-03]
 [-1.33016704e-02]
 [ 2.31071869e-02]
 [ 1.94704321e-02]
 [-1.43927065e-02]
 [ 3.13707905e-02]
 [ 8.86363159e-03]
 [-1.19424140e-02]
 [-3.61413284e-03]
 [-5.97088227e-03]
 [ 7.51955069e-03]
 [ 1.64728417e-02]
 [ 1.47041988e-02]
 [-5.50891615e-04]
 [-5.62069195e-03]
 [ 6.19373102e-03]
 [-8.40646763e-03]
 [-8.05076971e-03]
 [ 4.77319445e-03]
 [ 6.82178218e-03]
 [ 3.02445104e-03]
 [ 5.43030222e-03]
 [-3.03913817e-04]
 [-1.35459280e-02]
 [ 4.45497533e-03]
 [ 5.32155427e-03]
 [ 4.89606529e-02]
 [-2.01351293e-02]
 [ 1.48375524e-03]
 [ 9.63147968e-03]
 [ 2.36569780e-02]
 [ 1.02263412e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.64624125]
curr_Stock_Price:  99.42918152961457
curr_Factors:  [99.42918153]
mat_Sqrt:  [[0.15]]
grads:  [-0.07012098]
Stock Position:  -0.07012098018647855
Bond Position:  [-3.67416958]


portfolio before change:  [-10.70854536]
curr_Stock_Price:  100.31115448348768
curr_Factors:  [100.31115448]
mat_Sqrt:  [[0.15]]
grads:  [0.29422245]
Stock Position:  0.29422244978625567
Bond Position:  [-40.22233897]


portfolio before change:  [-10.26745369]
curr_Stock_Price:  101.82742142041175
curr_Factors:  [101.82742142]
mat_Sqrt:  [[0.15]]
grads:  [0.03349711]
Stock Position:  0.03349711221992786
Bond Position:  [-13.67837825]


portfolio before change:  [-10.26196655]
curr_Stock_Price:  102.04227703915993
curr_Factors:  [102.04227704]
mat_Sqrt:  [[0.15]]
grads:  [0.00678256]
Stock Position:  0.0067825598346575935
Bond Position:  [-10.9540744]


portfolio before change:  [-10.26440908]
curr_Stock_Price:  101.8840505951609
curr_Factors:  [101.8840506]
mat_Sqrt:  [[0.15]]
grads:  [-0.01181387]
Stock Position:  -0.011813867335980598
Bond Position:  [-9.06076442]


portfolio before change:  [-10.26707961]
curr_Stock_Price:  102.01422525820213
curr_Factors:  [102.01422526]
mat_Sqrt:  [[0.15]]
grads:  [0.10735248]
Stock Position:  0.10735247998502803
Bond Position:  [-21.21855968]


portfolio before change:  [-10.39849844]
curr_Stock_Price:  100.81475273697262
curr_Factors:  [100.81475274]
mat_Sqrt:  [[0.15]]
grads:  [0.02495939]
Stock Position:  0.024959391461174082
Bond Position:  [-12.91477332]


portfolio before change:  [-10.40095397]
curr_Stock_Price:  100.7810546990272
curr_Factors:  [100.7810547]
mat_Sqrt:  [[0.15]]
grads:  [0.0367114]
Stock Position:  0.03671140029445275
Bond Position:  [-14.10076762]


portfolio before change:  [-10.37525782]
curr_Stock_Price:  101.5290202367963
curr_Factors:  [101.52902024]
mat_Sqrt:  [[0.15]]
grads:  [-0.0886778]
Stock Position:  -0.08867780266597325
Bond Position:  [-1.3718874]


portfolio before change:  [-10.34845899]
curr_Stock_Price:  101.22488180444917
curr_Factors:  [101.2248818]
mat_Sqrt:  [[0.15]]
grads:  [0.15404791]
Stock Position:  0.15404791247400737
Bond Position:  [-25.94194072]


portfolio before change:  [-10.44673702]
curr_Stock_Price:  100.60796278248584
curr_Factors:  [100.60796278]
mat_Sqrt:  [[0.15]]
grads:  [0.12980288]
Stock Position:  0.12980288063265877
Bond Position:  [-23.5059404]


portfolio before change:  [-10.53140054]
curr_Stock_Price:  99.97835354901264
curr_Factors:  [99.97835355]
mat_Sqrt:  [[0.15]]
grads:  [-0.09595138]
Stock Position:  -0.09595137679057897
Bond Position:  [-0.93833987]


portfolio before change:  [-10.58303075]
curr_Stock_Price:  100.51521829084035
curr_Factors:  [100.51521829]
mat_Sqrt:  [[0.15]]
grads:  [0.2091386]
Stock Position:  0.20913860329374645
Bond Position:  [-31.60464311]


portfolio before change:  [-10.56237966]
curr_Stock_Price:  100.63285280119237
curr_Factors:  [100.6328528]
mat_Sqrt:  [[0.15]]
grads:  [0.05909088]
Stock Position:  0.05909087727563988
Bond Position:  [-16.50886321]


portfolio before change:  [-10.50452386]
curr_Stock_Price:  101.64687627401314
curr_Factors:  [101.64687627]
mat_Sqrt:  [[0.15]]
grads:  [-0.07961609]
Stock Position:  -0.07961609343700017
Bond Position:  [-2.41179666]


portfolio before change:  [-10.47874686]
curr_Stock_Price:  101.31932325587434
curr_Factors:  [101.31932326]
mat_Sqrt:  [[0.15]]
grads:  [-0.02409422]
Stock Position:  -0.024094218959670375
Bond Position:  [-8.0375369]


portfolio before change:  [-10.47790644]
curr_Stock_Price:  101.24274141229805
curr_Factors:  [101.24274141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980588]
Stock Position:  -0.03980588181076067
Bond Position:  [-6.44784984]


portfolio before change:  [-10.55058898]
curr_Stock_Price:  103.04841703929455
curr_Factors:  [103.04841704]
mat_Sqrt:  [[0.15]]
grads:  [0.05013034]
Stock Position:  0.05013033792383773
Bond Position:  [-15.71644095]


portfolio before change:  [-10.56176884]
curr_Stock_Price:  102.86459260511302
curr_Factors:  [102.86459261]
mat_Sqrt:  [[0.15]]
grads:  [0.10981894]
Stock Position:  0.10981894443182759
Bond Position:  [-21.85824982]


portfolio before change:  [-10.54698923]
curr_Stock_Price:  103.02405563019477
curr_Factors:  [103.02405563]
mat_Sqrt:  [[0.15]]
grads:  [0.09802799]
Stock Position:  0.09802799204600826
Bond Position:  [-20.64623053]


portfolio before change:  [-10.56482848]
curr_Stock_Price:  102.86840306769258
curr_Factors:  [102.86840307]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367261]
Stock Position:  -0.0036726107682315827
Bond Position:  [-10.18703287]


portfolio before change:  [-10.56940931]
curr_Stock_Price:  103.768953081788
curr_Factors:  [103.76895308]
mat_Sqrt:  [[0.15]]
grads:  [-0.03747128]
Stock Position:  -0.0374712796361378
Bond Position:  [-6.68105385]


portfolio before change:  [-10.61053593]
curr_Stock_Price:  104.8442151038835
curr_Factors:  [104.8442151]
mat_Sqrt:  [[0.15]]
grads:  [0.04129154]
Stock Position:  0.041291540151033194
Bond Position:  [-14.93971505]


portfolio before change:  [-10.60964505]
curr_Stock_Price:  104.91101971184827
curr_Factors:  [104.91101971]
mat_Sqrt:  [[0.15]]
grads:  [-0.05604312]
Stock Position:  -0.05604311754678336
Bond Position:  [-4.73010444]


portfolio before change:  [-10.64972738]
curr_Stock_Price:  105.61567419494776
curr_Factors:  [105.61567419]
mat_Sqrt:  [[0.15]]
grads:  [-0.0536718]
Stock Position:  -0.05367179805120496
Bond Position:  [-4.98114425]


portfolio before change:  [-10.67040525]
curr_Stock_Price:  105.98933758814316
curr_Factors:  [105.98933759]
mat_Sqrt:  [[0.15]]
grads:  [0.0318213]
Stock Position:  0.031821296366417964
Bond Position:  [-14.04312337]


portfolio before change:  [-10.69912697]
curr_Stock_Price:  105.14191085704132
curr_Factors:  [105.14191086]
mat_Sqrt:  [[0.15]]
grads:  [0.04547855]
Stock Position:  0.04547854789997342
Bond Position:  [-15.4808284]


portfolio before change:  [-10.65722515]
curr_Stock_Price:  106.10581672590645
curr_Factors:  [106.10581673]
mat_Sqrt:  [[0.15]]
grads:  [0.02016301]
Stock Position:  0.02016300695945983
Bond Position:  [-12.79663748]


portfolio before change:  [-10.6646983]
curr_Stock_Price:  105.81451775113894
curr_Factors:  [105.81451775]
mat_Sqrt:  [[0.15]]
grads:  [0.03620201]
Stock Position:  0.03620201478101285
Bond Position:  [-14.49539703]


portfolio before change:  [-10.67677619]
curr_Stock_Price:  105.53094642311436
curr_Factors:  [105.53094642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00202609]
Stock Position:  -0.0020260921164494987
Bond Position:  [-10.46296077]


portfolio before change:  [-10.67862238]
curr_Stock_Price:  105.79660046301862
curr_Factors:  [105.79660046]
mat_Sqrt:  [[0.15]]
grads:  [-0.09030619]
Stock Position:  -0.09030618656285512
Bond Position:  [-1.12453484]


portfolio before change:  [-10.6868434]
curr_Stock_Price:  105.88607876384327
curr_Factors:  [105.88607876]
mat_Sqrt:  [[0.15]]
grads:  [0.02969984]
Stock Position:  0.02969983550234924
Bond Position:  [-13.83164252]


portfolio before change:  [-10.7012451]
curr_Stock_Price:  105.45938821269542
curr_Factors:  [105.45938821]
mat_Sqrt:  [[0.15]]
grads:  [0.03547703]
Stock Position:  0.0354770284652167
Bond Position:  [-14.44263082]


portfolio before change:  [-10.67138771]
curr_Stock_Price:  106.35187645168183
curr_Factors:  [106.35187645]
mat_Sqrt:  [[0.15]]
grads:  [0.32640435]
Stock Position:  0.3264043524613579
Bond Position:  [-45.38510308]


portfolio before change:  [-10.93364792]
curr_Stock_Price:  105.56577567590516
curr_Factors:  [105.56577568]
mat_Sqrt:  [[0.15]]
grads:  [-0.1342342]
Stock Position:  -0.1342341953975196
Bond Position:  [3.23688904]


portfolio before change:  [-10.80557982]
curr_Stock_Price:  104.61472544571924
curr_Factors:  [104.61472545]
mat_Sqrt:  [[0.15]]
grads:  [0.0098917]
Stock Position:  0.009891701570452436
Bond Position:  [-11.84039747]


portfolio before change:  [-10.8043977]
curr_Stock_Price:  104.8838666571757
curr_Factors:  [104.88386666]
mat_Sqrt:  [[0.15]]
grads:  [0.06420986]
Stock Position:  0.06420986452463312
Bond Position:  [-17.53897657]


portfolio before change:  [-10.84327881]
curr_Stock_Price:  104.31248096475655
curr_Factors:  [104.31248096]
mat_Sqrt:  [[0.15]]
grads:  [0.15771319]
Stock Position:  0.15771318696498748
Bond Position:  [-27.29473262]


portfolio before change:  [-10.88890115]
curr_Stock_Price:  104.04484139650408
curr_Factors:  [104.0448414]
mat_Sqrt:  [[0.15]]
grads:  [0.06817561]
Stock Position:  0.06817560786484654
Bond Position:  [-17.98222146]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.81469175]
Stock Price:  105.16631753537646
PL:  [-15.98100929]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.86103305e-03]
 [ 3.42763506e-02]
 [-1.34318027e-02]
 [-6.58754042e-03]
 [-7.63988908e-03]
 [ 3.14678374e-02]
 [ 3.57565203e-03]
 [ 1.00610121e-02]
 [-1.31216373e-02]
 [ 2.32479124e-02]
 [ 1.98855797e-02]
 [-1.23550888e-02]
 [ 2.05652469e-02]
 [ 2.14987272e-02]
 [-1.16507819e-02]
 [-3.06775631e-03]
 [-4.98308141e-03]
 [ 7.45166609e-03]
 [ 1.92110010e-02]
 [ 1.14379524e-02]
 [-2.25789976e-04]
 [-3.61293848e-03]
 [ 4.11894073e-03]
 [-1.08874268e-02]
 [-2.75229968e-03]
 [ 3.85474307e-03]
 [ 2.89533135e-03]
 [ 6.19761355e-04]
 [ 3.64520104e-03]
 [-5.64184451e-03]
 [-1.93531880e-02]
 [ 9.96618978e-03]
 [-4.63627790e-04]
 [-8.51725038e-03]
 [-2.02748274e-02]
 [ 1.90137273e-03]
 [ 5.84812460e-03]
 [ 2.36414493e-02]
 [ 1.03649805e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.28343909]
curr_Stock_Price:  99.67343599248902
curr_Factors:  [99.67343599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01240689]
Stock Position:  -0.012406887002656512
Bond Position:  [-4.04680204]


portfolio before change:  [-5.28378483]
curr_Stock_Price:  99.66052845432178
curr_Factors:  [99.66052845]
mat_Sqrt:  [[0.15]]
grads:  [0.228509]
Stock Position:  0.22850900414606648
Bond Position:  [-28.05711294]


portfolio before change:  [-5.40120247]
curr_Stock_Price:  99.16203484398449
curr_Factors:  [99.16203484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08954535]
Stock Position:  -0.0895453513656049
Bond Position:  [3.47829678]


portfolio before change:  [-5.46172077]
curr_Stock_Price:  99.84273027059601
curr_Factors:  [99.84273027]
mat_Sqrt:  [[0.15]]
grads:  [-0.04391694]
Stock Position:  -0.04391693614564733
Bond Position:  [-1.07693396]


portfolio before change:  [-5.46896196]
curr_Stock_Price:  100.00454875495679
curr_Factors:  [100.00454875]
mat_Sqrt:  [[0.15]]
grads:  [-0.05093259]
Stock Position:  -0.05093259388352547
Bond Position:  [-0.3754709]


portfolio before change:  [-5.4888695]
curr_Stock_Price:  100.3944875759641
curr_Factors:  [100.39448758]
mat_Sqrt:  [[0.15]]
grads:  [0.20978558]
Stock Position:  0.20978558248496953
Bond Position:  [-26.55018555]


portfolio before change:  [-5.66780051]
curr_Stock_Price:  99.55738509398667
curr_Factors:  [99.55738509]
mat_Sqrt:  [[0.15]]
grads:  [0.02383768]
Stock Position:  0.02383768018313911
Bond Position:  [-8.04101761]


portfolio before change:  [-5.6232744]
curr_Stock_Price:  101.4674410076375
curr_Factors:  [101.46744101]
mat_Sqrt:  [[0.15]]
grads:  [0.06707341]
Stock Position:  0.06707341423922766
Bond Position:  [-12.4290421]


portfolio before change:  [-5.61551755]
curr_Stock_Price:  101.6062526571231
curr_Factors:  [101.60625266]
mat_Sqrt:  [[0.15]]
grads:  [-0.08747758]
Stock Position:  -0.08747758229728406
Bond Position:  [3.27275178]


portfolio before change:  [-5.54788312]
curr_Stock_Price:  100.83776652160591
curr_Factors:  [100.83776652]
mat_Sqrt:  [[0.15]]
grads:  [0.15498608]
Stock Position:  0.15498608274401265
Bond Position:  [-21.17633355]


portfolio before change:  [-5.53501433]
curr_Stock_Price:  100.93787873687118
curr_Factors:  [100.93787874]
mat_Sqrt:  [[0.15]]
grads:  [0.13257053]
Stock Position:  0.13257053136843536
Bond Position:  [-18.91640255]


portfolio before change:  [-5.48118654]
curr_Stock_Price:  101.36174732798551
curr_Factors:  [101.36174733]
mat_Sqrt:  [[0.15]]
grads:  [-0.08236726]
Stock Position:  -0.08236725835070416
Bond Position:  [2.86770268]


portfolio before change:  [-5.49876707]
curr_Stock_Price:  101.57954036109633
curr_Factors:  [101.57954036]
mat_Sqrt:  [[0.15]]
grads:  [0.13710165]
Stock Position:  0.1371016458670293
Bond Position:  [-19.42548924]


portfolio before change:  [-5.46519826]
curr_Stock_Price:  101.84209850804118
curr_Factors:  [101.84209851]
mat_Sqrt:  [[0.15]]
grads:  [0.14332485]
Stock Position:  0.14332484826257427
Bond Position:  [-20.06170157]


portfolio before change:  [-5.37753823]
curr_Stock_Price:  102.47121409605168
curr_Factors:  [102.4712141]
mat_Sqrt:  [[0.15]]
grads:  [-0.07767188]
Stock Position:  -0.07767187912976241
Bond Position:  [2.58159352]


portfolio before change:  [-5.39095498]
curr_Stock_Price:  102.648105238771
curr_Factors:  [102.64810524]
mat_Sqrt:  [[0.15]]
grads:  [-0.02045171]
Stock Position:  -0.020451708729124805
Bond Position:  [-3.29162583]


portfolio before change:  [-5.41019851]
curr_Stock_Price:  103.5689110204691
curr_Factors:  [103.56891102]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322054]
Stock Position:  -0.03322054271219331
Bond Position:  [-1.96958308]


portfolio before change:  [-5.38828182]
curr_Stock_Price:  102.90176643257139
curr_Factors:  [102.90176643]
mat_Sqrt:  [[0.15]]
grads:  [0.04967777]
Stock Position:  0.04967777395661907
Bond Position:  [-10.50021251]


portfolio before change:  [-5.35851782]
curr_Stock_Price:  103.5273299723881
curr_Factors:  [103.52732997]
mat_Sqrt:  [[0.15]]
grads:  [0.12807334]
Stock Position:  0.12807334015868574
Bond Position:  [-18.61760877]


portfolio before change:  [-5.3738311]
curr_Stock_Price:  103.42593551630381
curr_Factors:  [103.42593552]
mat_Sqrt:  [[0.15]]
grads:  [0.07625302]
Stock Position:  0.07625301583286187
Bond Position:  [-13.26037059]


portfolio before change:  [-5.40377542]
curr_Stock_Price:  103.05497745201791
curr_Factors:  [103.05497745]
mat_Sqrt:  [[0.15]]
grads:  [-0.00150527]
Stock Position:  -0.001505266504607999
Bond Position:  [-5.24865021]


portfolio before change:  [-5.40485977]
curr_Stock_Price:  103.33946537407127
curr_Factors:  [103.33946537]
mat_Sqrt:  [[0.15]]
grads:  [-0.02408626]
Stock Position:  -0.024086256522662233
Bond Position:  [-2.9157989]


portfolio before change:  [-5.40337643]
curr_Stock_Price:  103.26274790402333
curr_Factors:  [103.2627479]
mat_Sqrt:  [[0.15]]
grads:  [0.0274596]
Stock Position:  0.027459604893482634
Bond Position:  [-8.23893069]


portfolio before change:  [-5.39055452]
curr_Stock_Price:  103.76719209777308
curr_Factors:  [103.7671921]
mat_Sqrt:  [[0.15]]
grads:  [-0.07258285]
Stock Position:  -0.07258284558079008
Bond Position:  [2.14116356]


portfolio before change:  [-5.40993005]
curr_Stock_Price:  104.0378233775825
curr_Factors:  [104.03782338]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834866]
Stock Position:  -0.018348664543797553
Bond Position:  [-3.50097493]


portfolio before change:  [-5.39436687]
curr_Stock_Price:  103.16578040750757
curr_Factors:  [103.16578041]
mat_Sqrt:  [[0.15]]
grads:  [0.02569829]
Stock Position:  0.025698287144022124
Bond Position:  [-8.04555072]


portfolio before change:  [-5.38479043]
curr_Stock_Price:  103.5775668342055
curr_Factors:  [103.57756683]
mat_Sqrt:  [[0.15]]
grads:  [0.01930221]
Stock Position:  0.019302208973650873
Bond Position:  [-7.38406627]


portfolio before change:  [-5.40768268]
curr_Stock_Price:  102.43939706754834
curr_Factors:  [102.43939707]
mat_Sqrt:  [[0.15]]
grads:  [0.00413174]
Stock Position:  0.004131742367943827
Bond Position:  [-5.83093588]


portfolio before change:  [-5.4069981]
curr_Stock_Price:  102.78150301470376
curr_Factors:  [102.78150301]
mat_Sqrt:  [[0.15]]
grads:  [0.02430134]
Stock Position:  0.024301340296093023
Bond Position:  [-7.90472638]


portfolio before change:  [-5.392053]
curr_Stock_Price:  103.43715633722225
curr_Factors:  [103.43715634]
mat_Sqrt:  [[0.15]]
grads:  [-0.0376123]
Stock Position:  -0.03761229671986756
Bond Position:  [-1.50154398]


portfolio before change:  [-5.3543341]
curr_Stock_Price:  102.42933161489049
curr_Factors:  [102.42933161]
mat_Sqrt:  [[0.15]]
grads:  [-0.12902125]
Stock Position:  -0.12902125339855616
Bond Position:  [7.86122665]


portfolio before change:  [-5.39347816]
curr_Stock_Price:  102.74034066719449
curr_Factors:  [102.74034067]
mat_Sqrt:  [[0.15]]
grads:  [0.06644127]
Stock Position:  0.06644126522595882
Bond Position:  [-12.21967639]


portfolio before change:  [-5.35211076]
curr_Stock_Price:  103.3859477906408
curr_Factors:  [103.38594779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00309085]
Stock Position:  -0.003090851934690724
Bond Position:  [-5.03256011]


portfolio before change:  [-5.35355145]
curr_Stock_Price:  103.64852240044554
curr_Factors:  [103.6485224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05678167]
Stock Position:  -0.056781669215595264
Bond Position:  [0.53178466]


portfolio before change:  [-5.35117983]
curr_Stock_Price:  103.60792570883831
curr_Factors:  [103.60792571]
mat_Sqrt:  [[0.15]]
grads:  [-0.13516552]
Stock Position:  -0.13516551632044235
Bond Position:  [8.65303895]


portfolio before change:  [-5.48119383]
curr_Stock_Price:  104.57781586148417
curr_Factors:  [104.57781586]
mat_Sqrt:  [[0.15]]
grads:  [0.01267582]
Stock Position:  0.012675818228523386
Bond Position:  [-6.80680322]


portfolio before change:  [-5.48769687]
curr_Stock_Price:  104.13191730017472
curr_Factors:  [104.1319173]
mat_Sqrt:  [[0.15]]
grads:  [0.0389875]
Stock Position:  0.03898749732393151
Bond Position:  [-9.54753971]


portfolio before change:  [-5.4805704]
curr_Stock_Price:  104.34531865888107
curr_Factors:  [104.34531866]
mat_Sqrt:  [[0.15]]
grads:  [0.15760966]
Stock Position:  0.15760966201008192
Bond Position:  [-21.92640081]


portfolio before change:  [-5.55777143]
curr_Stock_Price:  103.87288533852781
curr_Factors:  [103.87288534]
mat_Sqrt:  [[0.15]]
grads:  [0.06909987]
Stock Position:  0.06909986970377739
Bond Position:  [-12.73537427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.55419569]
Stock Price:  103.94767212871662
PL:  [-9.50186782]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 3.32098448e-03]
 [ 5.97446760e-03]
 [ 1.39896647e-02]
 [ 4.90882342e-03]
 [ 3.47638114e-03]
 [-3.92823889e-02]
 [ 3.31392918e-03]
 [ 5.63747505e-02]
 [ 1.73021183e-01]
 [ 2.20770948e-02]
 [ 1.39008816e-02]
 [ 2.73363558e-02]
 [-1.16081722e-02]
 [ 2.31617054e-02]
 [-3.77044749e-03]
 [-7.99258891e-03]
 [-2.63977873e-03]
 [ 3.89940345e-03]
 [ 3.72815693e-02]
 [-2.47245997e-02]
 [-2.04456687e-03]
 [-3.19008257e-02]
 [ 1.03497847e-02]
 [-6.69054594e-03]
 [-6.30667187e-03]
 [ 4.52984007e-03]
 [ 6.85152758e-03]
 [ 2.05102753e-03]
 [ 5.38038080e-03]
 [ 1.91417448e-03]
 [-1.68319549e-02]
 [ 7.52597028e-03]
 [ 3.98335200e-03]
 [ 3.17174601e-04]
 [-2.01977198e-02]
 [ 4.52957547e-03]
 [ 6.63374984e-03]
 [ 2.01856897e-02]
 [ 9.46515952e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.99995802]
curr_Stock_Price:  99.73189348751418
curr_Factors:  [99.73189349]
mat_Sqrt:  [[0.15]]
grads:  [0.0221399]
Stock Position:  0.02213989651858805
Bond Position:  [-6.20801182]


portfolio before change:  [-3.97007526]
curr_Stock_Price:  101.11666988439958
curr_Factors:  [101.11666988]
mat_Sqrt:  [[0.15]]
grads:  [0.03982978]
Stock Position:  0.03982978403056919
Bond Position:  [-7.99753039]


portfolio before change:  [-3.91474495]
curr_Stock_Price:  102.53093989731265
curr_Factors:  [102.5309399]
mat_Sqrt:  [[0.15]]
grads:  [0.09326443]
Stock Position:  0.09326443102916136
Bond Position:  [-13.47723472]


portfolio before change:  [-3.89448485]
curr_Stock_Price:  102.76623706957344
curr_Factors:  [102.76623707]
mat_Sqrt:  [[0.15]]
grads:  [0.03272549]
Stock Position:  0.03272548948112416
Bond Position:  [-7.25756026]


portfolio before change:  [-3.86451207]
curr_Stock_Price:  103.70984502815519
curr_Factors:  [103.70984503]
mat_Sqrt:  [[0.15]]
grads:  [0.02317587]
Stock Position:  0.023175874246650227
Bond Position:  [-6.2680784]


portfolio before change:  [-3.84731289]
curr_Stock_Price:  104.48576995490566
curr_Factors:  [104.48576995]
mat_Sqrt:  [[0.15]]
grads:  [-0.26188259]
Stock Position:  -0.26188259298723315
Bond Position:  [23.51569148]


portfolio before change:  [-4.07910961]
curr_Stock_Price:  105.38211193707679
curr_Factors:  [105.38211194]
mat_Sqrt:  [[0.15]]
grads:  [0.02209286]
Stock Position:  0.022092861207956716
Bond Position:  [-6.40730198]


portfolio before change:  [-4.05903721]
curr_Stock_Price:  106.32691320523745
curr_Factors:  [106.32691321]
mat_Sqrt:  [[0.15]]
grads:  [0.37583167]
Stock Position:  0.3758316701159682
Bond Position:  [-44.02005858]


portfolio before change:  [-3.7346876]
curr_Stock_Price:  107.20457330314821
curr_Factors:  [107.2045733]
mat_Sqrt:  [[0.15]]
grads:  [1.15347455]
Stock Position:  1.1534745531357087
Bond Position:  [-127.39243488]


portfolio before change:  [-3.07142036]
curr_Stock_Price:  107.79339624751215
curr_Factors:  [107.79339625]
mat_Sqrt:  [[0.15]]
grads:  [0.14718063]
Stock Position:  0.14718063187097172
Bond Position:  [-18.93652054]


portfolio before change:  [-3.08001218]
curr_Stock_Price:  107.75110399789605
curr_Factors:  [107.751104]
mat_Sqrt:  [[0.15]]
grads:  [0.09267254]
Stock Position:  0.09267254381952174
Bond Position:  [-13.06558108]


portfolio before change:  [-3.0475172]
curr_Stock_Price:  108.11937139723248
curr_Factors:  [108.1193714]
mat_Sqrt:  [[0.15]]
grads:  [0.18224237]
Stock Position:  0.18224237184071318
Bond Position:  [-22.75144789]


portfolio before change:  [-3.03621283]
curr_Stock_Price:  108.19700693550494
curr_Factors:  [108.19700694]
mat_Sqrt:  [[0.15]]
grads:  [-0.07738781]
Stock Position:  -0.07738781497803547
Bond Position:  [5.33691713]


portfolio before change:  [-3.06811933]
curr_Stock_Price:  108.61792147263908
curr_Factors:  [108.61792147]
mat_Sqrt:  [[0.15]]
grads:  [0.15441137]
Stock Position:  0.1544113695838188
Bond Position:  [-19.83996134]


portfolio before change:  [-3.00410326]
curr_Stock_Price:  109.04856471851903
curr_Factors:  [109.04856472]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513632]
Stock Position:  -0.02513631662736831
Bond Position:  [-0.26302401]


portfolio before change:  [-3.01859586]
curr_Stock_Price:  109.62381663731678
curr_Factors:  [109.62381664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328393]
Stock Position:  -0.05328392605887823
Bond Position:  [2.82259148]


portfolio before change:  [-2.98010553]
curr_Stock_Price:  108.90807580057809
curr_Factors:  [108.9080758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01759852]
Stock Position:  -0.01759852483930181
Bond Position:  [-1.06348405]


portfolio before change:  [-2.97998932]
curr_Stock_Price:  108.89391799985655
curr_Factors:  [108.893918]
mat_Sqrt:  [[0.15]]
grads:  [0.02599602]
Stock Position:  0.025996023029564976
Bond Position:  [-5.81079812]


portfolio before change:  [-3.0065254]
curr_Stock_Price:  107.90108595447325
curr_Factors:  [107.90108595]
mat_Sqrt:  [[0.15]]
grads:  [0.2485438]
Stock Position:  0.2485437956544553
Bond Position:  [-29.82467085]


portfolio before change:  [-3.09507978]
curr_Stock_Price:  107.5597937010339
curr_Factors:  [107.5597937]
mat_Sqrt:  [[0.15]]
grads:  [-0.16483066]
Stock Position:  -0.1648306649665928
Bond Position:  [14.63407253]


portfolio before change:  [-3.10916519]
curr_Stock_Price:  107.65634599270085
curr_Factors:  [107.65634599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01363045]
Stock Position:  -0.013630445768722724
Bond Position:  [-1.6417612]


portfolio before change:  [-3.10891754]
curr_Stock_Price:  107.62311998100523
curr_Factors:  [107.62311998]
mat_Sqrt:  [[0.15]]
grads:  [-0.21267217]
Stock Position:  -0.21267217133114358
Bond Position:  [19.77952507]


portfolio before change:  [-3.19320831]
curr_Stock_Price:  108.03108765818575
curr_Factors:  [108.03108766]
mat_Sqrt:  [[0.15]]
grads:  [0.06899856]
Stock Position:  0.06899856486300408
Bond Position:  [-10.64719832]


portfolio before change:  [-3.35794647]
curr_Stock_Price:  105.6628184668869
curr_Factors:  [105.66281847]
mat_Sqrt:  [[0.15]]
grads:  [-0.04460364]
Stock Position:  -0.04460363959532232
Bond Position:  [1.3549998]


portfolio before change:  [-3.33221653]
curr_Stock_Price:  105.0897585591998
curr_Factors:  [105.08975856]
mat_Sqrt:  [[0.15]]
grads:  [-0.04204448]
Stock Position:  -0.04204447914739476
Bond Position:  [1.08622763]


portfolio before change:  [-3.29464656]
curr_Stock_Price:  104.19941143246139
curr_Factors:  [104.19941143]
mat_Sqrt:  [[0.15]]
grads:  [0.03019893]
Stock Position:  0.03019893379562331
Bond Position:  [-6.44135769]


portfolio before change:  [-3.28018735]
curr_Stock_Price:  104.70487389234762
curr_Factors:  [104.70487389]
mat_Sqrt:  [[0.15]]
grads:  [0.04567685]
Stock Position:  0.04567685050268596
Bond Position:  [-8.06277623]


portfolio before change:  [-3.28637782]
curr_Stock_Price:  104.59141255464473
curr_Factors:  [104.59141255]
mat_Sqrt:  [[0.15]]
grads:  [0.01367352]
Stock Position:  0.013673516862125451
Bond Position:  [-4.71651026]


portfolio before change:  [-3.28360373]
curr_Stock_Price:  104.83741293195013
curr_Factors:  [104.83741293]
mat_Sqrt:  [[0.15]]
grads:  [0.03586921]
Stock Position:  0.03586920534650179
Bond Position:  [-7.04403842]


portfolio before change:  [-3.2443711]
curr_Stock_Price:  105.95573117962547
curr_Factors:  [105.95573118]
mat_Sqrt:  [[0.15]]
grads:  [0.01276116]
Stock Position:  0.012761163167910207
Bond Position:  [-4.59648948]


portfolio before change:  [-3.26787567]
curr_Stock_Price:  104.15887545257749
curr_Factors:  [104.15887545]
mat_Sqrt:  [[0.15]]
grads:  [-0.11221303]
Stock Position:  -0.11221303259561367
Bond Position:  [8.42010762]


portfolio before change:  [-3.17870886]
curr_Stock_Price:  103.37363481321862
curr_Factors:  [103.37363481]
mat_Sqrt:  [[0.15]]
grads:  [0.05017314]
Stock Position:  0.05017313522632287
Bond Position:  [-8.36528822]


portfolio before change:  [-3.09916978]
curr_Stock_Price:  104.97976930738204
curr_Factors:  [104.97976931]
mat_Sqrt:  [[0.15]]
grads:  [0.02655568]
Stock Position:  0.026555679975573943
Bond Position:  [-5.88697894]


portfolio before change:  [-3.1241821]
curr_Stock_Price:  104.06559954831236
curr_Factors:  [104.06559955]
mat_Sqrt:  [[0.15]]
grads:  [0.0021145]
Stock Position:  0.0021144973430378923
Bond Position:  [-3.34422853]


portfolio before change:  [-3.12339763]
curr_Stock_Price:  104.63430421372178
curr_Factors:  [104.63430421]
mat_Sqrt:  [[0.15]]
grads:  [-0.13465147]
Stock Position:  -0.13465146510680306
Bond Position:  [10.96576473]


portfolio before change:  [-3.0831432]
curr_Stock_Price:  104.34553184437605
curr_Factors:  [104.34553184]
mat_Sqrt:  [[0.15]]
grads:  [0.03019717]
Stock Position:  0.030197169791731406
Bond Position:  [-6.23408294]


portfolio before change:  [-3.08565794]
curr_Stock_Price:  104.28806188231431
curr_Factors:  [104.28806188]
mat_Sqrt:  [[0.15]]
grads:  [0.044225]
Stock Position:  0.0442249989594566
Bond Position:  [-7.69779737]


portfolio before change:  [-3.02586865]
curr_Stock_Price:  105.66175484578811
curr_Factors:  [105.66175485]
mat_Sqrt:  [[0.15]]
grads:  [0.13457126]
Stock Position:  0.13457126470082656
Bond Position:  [-17.24490463]


portfolio before change:  [-3.11856531]
curr_Stock_Price:  104.98894469127092
curr_Factors:  [104.98894469]
mat_Sqrt:  [[0.15]]
grads:  [0.06310106]
Stock Position:  0.06310106348629284
Bond Position:  [-9.74347938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.13609836]
Stock Price:  104.73039071199638
PL:  [-7.86648907]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.90453536e-03]
 [ 3.21686218e-02]
 [-3.35597624e-03]
 [-6.87823269e-03]
 [-7.74389450e-03]
 [ 3.26746101e-02]
 [ 3.72556724e-03]
 [ 6.13155417e-03]
 [-1.30238098e-02]
 [ 2.32191425e-02]
 [ 1.93135436e-02]
 [-1.43217812e-02]
 [ 2.83740327e-02]
 [ 8.19915118e-03]
 [ 8.53665180e-03]
 [-3.69195654e-03]
 [-5.76388219e-03]
 [ 7.02411391e-03]
 [ 1.70439762e-02]
 [ 1.09588015e-02]
 [ 4.32473400e-04]
 [-4.32488690e-03]
 [ 4.05692942e-03]
 [-1.17128265e-02]
 [-1.76332350e-03]
 [ 4.56830105e-03]
 [ 6.82487349e-03]
 [ 1.61867881e-03]
 [ 3.38967142e-03]
 [-6.10619261e-03]
 [-2.15304074e-02]
 [ 1.85836362e-02]
 [-2.97364918e-03]
 [-1.89675581e-02]
 [-2.04254461e-02]
 [ 2.23156772e-02]
 [ 3.74667009e-03]
 [ 1.70483095e-02]
 [ 9.86862142e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.52169879]
curr_Stock_Price:  99.66258420422407
curr_Factors:  [99.6625842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01936357]
Stock Position:  -0.019363569052391408
Bond Position:  [-3.59187546]


portfolio before change:  [-5.51853949]
curr_Stock_Price:  99.47623880925447
curr_Factors:  [99.47623881]
mat_Sqrt:  [[0.15]]
grads:  [0.21445748]
Stock Position:  0.2144574785502036
Bond Position:  [-26.85196284]


portfolio before change:  [-5.39091277]
curr_Stock_Price:  100.08700520781669
curr_Factors:  [100.08700521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237317]
Stock Position:  -0.022373174965088276
Bond Position:  [-3.15164869]


portfolio before change:  [-5.37043031]
curr_Stock_Price:  99.15390388331143
curr_Factors:  [99.15390388]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585488]
Stock Position:  -0.045854884616142226
Bond Position:  [-0.82373949]


portfolio before change:  [-5.41372138]
curr_Stock_Price:  100.09574674021957
curr_Factors:  [100.09574674]
mat_Sqrt:  [[0.15]]
grads:  [-0.05162596]
Stock Position:  -0.05162596335853884
Bond Position:  [-0.24618203]


portfolio before change:  [-5.45263662]
curr_Stock_Price:  100.84894258315971
curr_Factors:  [100.84894258]
mat_Sqrt:  [[0.15]]
grads:  [0.21783073]
Stock Position:  0.2178307338192256
Bond Position:  [-27.42063579]


portfolio before change:  [-5.41529796]
curr_Stock_Price:  101.03608997107271
curr_Factors:  [101.03608997]
mat_Sqrt:  [[0.15]]
grads:  [0.02483711]
Stock Position:  0.024837114939065052
Bond Position:  [-7.92474294]


portfolio before change:  [-5.41958127]
curr_Stock_Price:  100.90351985407288
curr_Factors:  [100.90351985]
mat_Sqrt:  [[0.15]]
grads:  [0.04087703]
Stock Position:  0.040877027802236295
Bond Position:  [-9.54421726]


portfolio before change:  [-5.39033326]
curr_Stock_Price:  101.64821971767616
curr_Factors:  [101.64821972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0868254]
Stock Position:  -0.08682539865890258
Bond Position:  [3.43531394]


portfolio before change:  [-5.32635741]
curr_Stock_Price:  100.91633240330943
curr_Factors:  [100.9163324]
mat_Sqrt:  [[0.15]]
grads:  [0.15479428]
Stock Position:  0.15479428355519237
Bond Position:  [-20.94762878]


portfolio before change:  [-5.50607292]
curr_Stock_Price:  99.77225336914769
curr_Factors:  [99.77225337]
mat_Sqrt:  [[0.15]]
grads:  [0.12875696]
Stock Position:  0.12875695763735992
Bond Position:  [-18.35244472]


portfolio before change:  [-5.44759384]
curr_Stock_Price:  100.24425335864719
curr_Factors:  [100.24425336]
mat_Sqrt:  [[0.15]]
grads:  [-0.09547854]
Stock Position:  -0.09547854143910127
Bond Position:  [4.12358126]


portfolio before change:  [-5.46001852]
curr_Stock_Price:  100.3797829628112
curr_Factors:  [100.37978296]
mat_Sqrt:  [[0.15]]
grads:  [0.18916022]
Stock Position:  0.18916021797025137
Bond Position:  [-24.44788015]


portfolio before change:  [-5.42495094]
curr_Stock_Price:  100.58132512520369
curr_Factors:  [100.58132513]
mat_Sqrt:  [[0.15]]
grads:  [0.05466101]
Stock Position:  0.054661007856506884
Bond Position:  [-10.92282754]


portfolio before change:  [-5.4303754]
curr_Stock_Price:  100.50706715164735
curr_Factors:  [100.50706715]
mat_Sqrt:  [[0.15]]
grads:  [0.05691101]
Stock Position:  0.056911011975886466
Bond Position:  [-11.1503343]


portfolio before change:  [-5.38743165]
curr_Stock_Price:  101.28613649584042
curr_Factors:  [101.2861365]
mat_Sqrt:  [[0.15]]
grads:  [-0.02461304]
Stock Position:  -0.02461304357741635
Bond Position:  [-2.89447156]


portfolio before change:  [-5.39664704]
curr_Stock_Price:  101.64584635059369
curr_Factors:  [101.64584635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842588]
Stock Position:  -0.038425881257578356
Bond Position:  [-1.49081581]


portfolio before change:  [-5.40960163]
curr_Stock_Price:  101.97812850287188
curr_Factors:  [101.9781285]
mat_Sqrt:  [[0.15]]
grads:  [0.04682743]
Stock Position:  0.04682742607822526
Bond Position:  [-10.18497491]


portfolio before change:  [-5.36289077]
curr_Stock_Price:  103.00282860504076
curr_Factors:  [103.00282861]
mat_Sqrt:  [[0.15]]
grads:  [0.11362651]
Stock Position:  0.11362650798713791
Bond Position:  [-17.06674249]


portfolio before change:  [-5.31075747]
curr_Stock_Price:  103.48041765503228
curr_Factors:  [103.48041766]
mat_Sqrt:  [[0.15]]
grads:  [0.07305868]
Stock Position:  0.07305867659200198
Bond Position:  [-12.87089983]


portfolio before change:  [-5.31584883]
curr_Stock_Price:  103.43275187407424
curr_Factors:  [103.43275187]
mat_Sqrt:  [[0.15]]
grads:  [0.00288316]
Stock Position:  0.0028831559980218775
Bond Position:  [-5.61406159]


portfolio before change:  [-5.31919791]
curr_Stock_Price:  102.51456240191324
curr_Factors:  [102.5145624]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883258]
Stock Position:  -0.028832579305239307
Bond Position:  [-2.36343866]


portfolio before change:  [-5.31308455]
curr_Stock_Price:  102.29228554354421
curr_Factors:  [102.29228554]
mat_Sqrt:  [[0.15]]
grads:  [0.0270462]
Stock Position:  0.027046196110896217
Bond Position:  [-8.07970176]


portfolio before change:  [-5.29376065]
curr_Stock_Price:  103.04410751693496
curr_Factors:  [103.04410752]
mat_Sqrt:  [[0.15]]
grads:  [-0.07808551]
Stock Position:  -0.07808550993892198
Bond Position:  [2.75249103]


portfolio before change:  [-5.34815632]
curr_Stock_Price:  103.7451306655409
curr_Factors:  [103.74513067]
mat_Sqrt:  [[0.15]]
grads:  [-0.01175549]
Stock Position:  -0.01175549001977529
Bond Position:  [-4.12858147]


portfolio before change:  [-5.36174368]
curr_Stock_Price:  104.857058390835
curr_Factors:  [104.85705839]
mat_Sqrt:  [[0.15]]
grads:  [0.03045534]
Stock Position:  0.030455340358241097
Bond Position:  [-8.55520108]


portfolio before change:  [-5.35552113]
curr_Stock_Price:  105.09649153036271
curr_Factors:  [105.09649153]
mat_Sqrt:  [[0.15]]
grads:  [0.04549916]
Stock Position:  0.04549915661598933
Bond Position:  [-10.13732285]


portfolio before change:  [-5.41294493]
curr_Stock_Price:  103.86225861547061
curr_Factors:  [103.86225862]
mat_Sqrt:  [[0.15]]
grads:  [0.01079119]
Stock Position:  0.010791192073724653
Bond Position:  [-6.53374251]


portfolio before change:  [-5.42731005]
curr_Stock_Price:  102.60675750483318
curr_Factors:  [102.6067575]
mat_Sqrt:  [[0.15]]
grads:  [0.02259781]
Stock Position:  0.022597809484634107
Bond Position:  [-7.74599801]


portfolio before change:  [-5.43018521]
curr_Stock_Price:  102.52237527830717
curr_Factors:  [102.52237528]
mat_Sqrt:  [[0.15]]
grads:  [-0.04070795]
Stock Position:  -0.0407079507070125
Bond Position:  [-1.25670941]


portfolio before change:  [-5.39947644]
curr_Stock_Price:  101.76414827271273
curr_Factors:  [101.76414827]
mat_Sqrt:  [[0.15]]
grads:  [-0.14353605]
Stock Position:  -0.14353604955225374
Bond Position:  [9.20734739]


portfolio before change:  [-5.30654861]
curr_Stock_Price:  101.12474901938698
curr_Factors:  [101.12474902]
mat_Sqrt:  [[0.15]]
grads:  [0.12389091]
Stock Position:  0.12389090781757602
Bond Position:  [-17.83498557]


portfolio before change:  [-5.14032348]
curr_Stock_Price:  102.48445040897019
curr_Factors:  [102.48445041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982433]
Stock Position:  -0.019824327862234155
Bond Position:  [-3.10863814]


portfolio before change:  [-5.12397017]
curr_Stock_Price:  101.63993665332889
curr_Factors:  [101.63993665]
mat_Sqrt:  [[0.15]]
grads:  [-0.12645039]
Stock Position:  -0.1264503876087561
Bond Position:  [7.72843922]


portfolio before change:  [-5.18507729]
curr_Stock_Price:  102.13082665377347
curr_Factors:  [102.13082665]
mat_Sqrt:  [[0.15]]
grads:  [-0.13616964]
Stock Position:  -0.13616964046568641
Bond Position:  [8.72204066]


portfolio before change:  [-5.19521385]
curr_Stock_Price:  102.21327444444009
curr_Factors:  [102.21327444]
mat_Sqrt:  [[0.15]]
grads:  [0.14877118]
Stock Position:  0.14877118123719818
Bond Position:  [-20.40160343]


portfolio before change:  [-5.1980212]
curr_Stock_Price:  102.2115470086474
curr_Factors:  [102.21154701]
mat_Sqrt:  [[0.15]]
grads:  [0.0249778]
Stock Position:  0.024977800574609386
Bond Position:  [-7.75104084]


portfolio before change:  [-5.19903053]
curr_Stock_Price:  102.20992985098619
curr_Factors:  [102.20992985]
mat_Sqrt:  [[0.15]]
grads:  [0.1136554]
Stock Position:  0.11365539670360433
Bond Position:  [-16.81574066]


portfolio before change:  [-5.15624469]
curr_Stock_Price:  102.60487756193461
curr_Factors:  [102.60487756]
mat_Sqrt:  [[0.15]]
grads:  [0.06579081]
Stock Position:  0.06579080949273608
Bond Position:  [-11.90670265]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.24236207]
Stock Price:  101.31854376872042
PL:  [-6.56090584]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.03111072e-02]
 [ 4.40519361e-02]
 [-1.32786129e-02]
 [-2.21488069e-03]
 [-6.29109193e-03]
 [ 2.91098012e-02]
 [ 3.64112605e-03]
 [-1.03961958e-03]
 [-2.77531556e-02]
 [ 2.33964759e-02]
 [ 1.91306838e-02]
 [-1.16646057e-02]
 [-3.36352864e-04]
 [ 6.80921704e-03]
 [-1.74691641e-02]
 [ 3.63657504e-04]
 [-6.09562230e-03]
 [ 5.12494016e-03]
 [ 1.03762120e-02]
 [ 1.26111329e-02]
 [-4.24428592e-03]
 [-4.91376049e-03]
 [ 7.07117773e-03]
 [-9.01539799e-03]
 [ 2.32457880e-03]
 [ 5.23000793e-03]
 [-2.74953060e-03]
 [-7.03589278e-04]
 [ 3.81937856e-03]
 [-5.62191359e-03]
 [-1.84254747e-02]
 [ 9.89040173e-03]
 [ 5.36652306e-04]
 [ 1.89148496e-02]
 [-2.01685208e-02]
 [ 1.78094916e-02]
 [ 4.72516195e-03]
 [ 1.17387738e-02]
 [ 7.74795042e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9708542]
curr_Stock_Price:  100.27711671681669
curr_Factors:  [100.27711672]
mat_Sqrt:  [[0.15]]
grads:  [0.06874071]
Stock Position:  0.06874071488487044
Bond Position:  [1.07773351]


portfolio before change:  [7.97047128]
curr_Stock_Price:  100.26958627227106
curr_Factors:  [100.26958627]
mat_Sqrt:  [[0.15]]
grads:  [0.29367957]
Stock Position:  0.2936795737356187
Bond Position:  [-21.47665808]


portfolio before change:  [7.64457487]
curr_Stock_Price:  99.16902740644255
curr_Factors:  [99.16902741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08852409]
Stock Position:  -0.08852408590994917
Bond Position:  [16.42342237]


portfolio before change:  [7.52375015]
curr_Stock_Price:  100.55709903653324
curr_Factors:  [100.55709904]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476587]
Stock Position:  -0.014765871248899344
Bond Position:  [9.00856333]


portfolio before change:  [7.52515111]
curr_Stock_Price:  100.53848718113004
curr_Factors:  [100.53848718]
mat_Sqrt:  [[0.15]]
grads:  [-0.04194061]
Stock Position:  -0.041940612845141965
Bond Position:  [11.74179688]


portfolio before change:  [7.55056598]
curr_Stock_Price:  99.96751201031168
curr_Factors:  [99.96751201]
mat_Sqrt:  [[0.15]]
grads:  [0.19406534]
Stock Position:  0.19406534117661975
Bond Position:  [-11.84966335]


portfolio before change:  [7.54759577]
curr_Stock_Price:  99.95983980598155
curr_Factors:  [99.95983981]
mat_Sqrt:  [[0.15]]
grads:  [0.02427417]
Stock Position:  0.02427417366194506
Bond Position:  [5.12115326]


portfolio before change:  [7.54082195]
curr_Stock_Price:  99.65441215875242
curr_Factors:  [99.65441216]
mat_Sqrt:  [[0.15]]
grads:  [-0.0069308]
Stock Position:  -0.006930797221077551
Bond Position:  [8.23150647]


portfolio before change:  [7.54502085]
curr_Stock_Price:  99.19704881115423
curr_Factors:  [99.19704881]
mat_Sqrt:  [[0.15]]
grads:  [-0.18502104]
Stock Position:  -0.1850210372964425
Bond Position:  [25.89856171]


portfolio before change:  [7.40982887]
curr_Stock_Price:  99.94523130814059
curr_Factors:  [99.94523131]
mat_Sqrt:  [[0.15]]
grads:  [0.15597651]
Stock Position:  0.15597650592743034
Bond Position:  [-8.1792791]


portfolio before change:  [7.40730464]
curr_Stock_Price:  99.93560325157002
curr_Factors:  [99.93560325]
mat_Sqrt:  [[0.15]]
grads:  [0.12753789]
Stock Position:  0.12753789226103657
Bond Position:  [-5.33827156]


portfolio before change:  [7.19545231]
curr_Stock_Price:  98.27974233241535
curr_Factors:  [98.27974233]
mat_Sqrt:  [[0.15]]
grads:  [-0.07776404]
Stock Position:  -0.07776403820803612
Bond Position:  [14.83808194]


portfolio before change:  [7.1997744]
curr_Stock_Price:  98.24801528581703
curr_Factors:  [98.24801529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00224235]
Stock Position:  -0.002242352429844144
Bond Position:  [7.42008108]


portfolio before change:  [7.20024967]
curr_Stock_Price:  98.44972378368968
curr_Factors:  [98.44972378]
mat_Sqrt:  [[0.15]]
grads:  [0.04539478]
Stock Position:  0.045394780282447283
Bond Position:  [2.73114609]


portfolio before change:  [7.15127672]
curr_Stock_Price:  97.3633793971434
curr_Factors:  [97.3633794]
mat_Sqrt:  [[0.15]]
grads:  [-0.11646109]
Stock Position:  -0.11646109414514275
Bond Position:  [18.49032242]


portfolio before change:  [7.17674346]
curr_Stock_Price:  97.16455501384007
curr_Factors:  [97.16455501]
mat_Sqrt:  [[0.15]]
grads:  [0.00242438]
Stock Position:  0.0024243833603639887
Bond Position:  [6.94117933]


portfolio before change:  [7.18264529]
curr_Stock_Price:  99.24101225079028
curr_Factors:  [99.24101225]
mat_Sqrt:  [[0.15]]
grads:  [-0.04063748]
Stock Position:  -0.040637481982007694
Bond Position:  [11.21555014]


portfolio before change:  [7.15948437]
curr_Stock_Price:  99.8454531818088
curr_Factors:  [99.84545318]
mat_Sqrt:  [[0.15]]
grads:  [0.03416627]
Stock Position:  0.034166267741635614
Bond Position:  [3.74813788]


portfolio before change:  [7.21599534]
curr_Stock_Price:  101.485738389599
curr_Factors:  [101.48573839]
mat_Sqrt:  [[0.15]]
grads:  [0.06917475]
Stock Position:  0.06917474655689713
Bond Position:  [0.1957451]


portfolio before change:  [7.2000678]
curr_Stock_Price:  101.25513399330826
curr_Factors:  [101.25513399]
mat_Sqrt:  [[0.15]]
grads:  [0.08407422]
Stock Position:  0.0840742195918872
Bond Position:  [-1.31287857]


portfolio before change:  [7.19249293]
curr_Stock_Price:  101.16698865056645
curr_Factors:  [101.16698865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02829524]
Stock Position:  -0.028295239463155496
Bond Position:  [10.0550371]


portfolio before change:  [7.22512498]
curr_Stock_Price:  100.05814189916732
curr_Factors:  [100.0581419]
mat_Sqrt:  [[0.15]]
grads:  [-0.0327584]
Stock Position:  -0.03275840328662301
Bond Position:  [10.50286994]


portfolio before change:  [7.23872842]
curr_Stock_Price:  99.682955670441
curr_Factors:  [99.68295567]
mat_Sqrt:  [[0.15]]
grads:  [0.04714118]
Stock Position:  0.04714118489543415
Bond Position:  [2.53955577]


portfolio before change:  [7.27321326]
curr_Stock_Price:  100.40774388921044
curr_Factors:  [100.40774389]
mat_Sqrt:  [[0.15]]
grads:  [-0.06010265]
Stock Position:  -0.06010265327081043
Bond Position:  [13.30798507]


portfolio before change:  [7.17084255]
curr_Stock_Price:  102.13868753768095
curr_Factors:  [102.13868754]
mat_Sqrt:  [[0.15]]
grads:  [0.01549719]
Stock Position:  0.015497192001747527
Bond Position:  [5.5879797]


portfolio before change:  [7.15746156]
curr_Stock_Price:  101.23016575071281
curr_Factors:  [101.23016575]
mat_Sqrt:  [[0.15]]
grads:  [0.03486672]
Stock Position:  0.034866719561232905
Bond Position:  [3.62789776]


portfolio before change:  [7.154453]
curr_Stock_Price:  101.13087120976172
curr_Factors:  [101.13087121]
mat_Sqrt:  [[0.15]]
grads:  [-0.0183302]
Stock Position:  -0.01833020401510066
Bond Position:  [9.0082025]


portfolio before change:  [7.15202243]
curr_Stock_Price:  101.32490415322353
curr_Factors:  [101.32490415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0046906]
Stock Position:  -0.004690595183748595
Bond Position:  [7.62729654]


portfolio before change:  [7.14558488]
curr_Stock_Price:  102.90061538606902
curr_Factors:  [102.90061539]
mat_Sqrt:  [[0.15]]
grads:  [0.02546252]
Stock Position:  0.025462523749659006
Bond Position:  [4.52547552]


portfolio before change:  [7.16058434]
curr_Stock_Price:  103.46747745380439
curr_Factors:  [103.46747745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03747942]
Stock Position:  -0.03747942392373754
Bond Position:  [11.03848579]


portfolio before change:  [7.17702132]
curr_Stock_Price:  103.06573483647772
curr_Factors:  [103.06573484]
mat_Sqrt:  [[0.15]]
grads:  [-0.1228365]
Stock Position:  -0.12283649783754783
Bond Position:  [19.83725523]


portfolio before change:  [7.21735975]
curr_Stock_Price:  102.75753147974183
curr_Factors:  [102.75753148]
mat_Sqrt:  [[0.15]]
grads:  [0.06593601]
Stock Position:  0.06593601154709708
Bond Position:  [0.44193797]


portfolio before change:  [7.2824887]
curr_Stock_Price:  103.74445356691024
curr_Factors:  [103.74445357]
mat_Sqrt:  [[0.15]]
grads:  [0.00357768]
Stock Position:  0.003577682041383083
Bond Position:  [6.91132403]


portfolio before change:  [7.28762889]
curr_Stock_Price:  104.93970305232605
curr_Factors:  [104.93970305]
mat_Sqrt:  [[0.15]]
grads:  [0.126099]
Stock Position:  0.12609899732081922
Bond Position:  [-5.94516244]


portfolio before change:  [7.30626225]
curr_Stock_Price:  105.09336442255024
curr_Factors:  [105.09336442]
mat_Sqrt:  [[0.15]]
grads:  [-0.13445681]
Stock Position:  -0.13445680543641683
Bond Position:  [21.4367803]


portfolio before change:  [7.56329363]
curr_Stock_Price:  103.20166680620359
curr_Factors:  [103.20166681]
mat_Sqrt:  [[0.15]]
grads:  [0.11872994]
Stock Position:  0.11872994428053006
Bond Position:  [-4.68983452]


portfolio before change:  [7.31752525]
curr_Stock_Price:  101.13662659099161
curr_Factors:  [101.13662659]
mat_Sqrt:  [[0.15]]
grads:  [0.03150108]
Stock Position:  0.03150107967821827
Bond Position:  [4.13161232]


portfolio before change:  [7.31194521]
curr_Stock_Price:  100.94309269972123
curr_Factors:  [100.9430927]
mat_Sqrt:  [[0.15]]
grads:  [0.07825849]
Stock Position:  0.07825849171252469
Bond Position:  [-0.58770897]


portfolio before change:  [7.31478692]
curr_Stock_Price:  100.98034334557735
curr_Factors:  [100.98034335]
mat_Sqrt:  [[0.15]]
grads:  [0.051653]
Stock Position:  0.051653002773472914
Bond Position:  [2.09884897]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.34364251]
Stock Price:  101.53390677580357
PL:  [5.80973573]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.07629255e-03]
 [ 3.12658084e-02]
 [-1.20204224e-02]
 [-6.77642659e-03]
 [-7.62663663e-03]
 [ 2.81289475e-02]
 [ 3.71707186e-03]
 [ 4.53009507e-03]
 [-2.58867774e-02]
 [ 2.33990003e-02]
 [ 1.94352481e-02]
 [-1.41594840e-02]
 [-1.98697748e-03]
 [ 7.34495594e-03]
 [-1.00861876e-02]
 [-1.90732758e-03]
 [-6.08588643e-03]
 [ 5.39686358e-03]
 [ 6.61707069e-03]
 [-4.94073869e-03]
 [-4.99795195e-03]
 [-6.35553631e-03]
 [ 5.97959113e-03]
 [-7.71568706e-03]
 [ 1.26215920e-02]
 [ 7.75970092e-03]
 [-7.13715707e-03]
 [-2.76560353e-03]
 [-1.31681910e-03]
 [-8.54076775e-03]
 [-7.57809380e-03]
 [ 1.58342210e-02]
 [-4.51549164e-03]
 [-2.08245904e-02]
 [-2.16324991e-02]
 [ 3.79582621e-02]
 [ 4.38791716e-04]
 [ 6.97325727e-03]
 [ 8.63664851e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.30053253]
curr_Stock_Price:  99.30828904212188
curr_Factors:  [99.30828904]
mat_Sqrt:  [[0.15]]
grads:  [-0.04717528]
Stock Position:  -0.0471752836343884
Bond Position:  [-8.61563583]


portfolio before change:  [-13.30533902]
curr_Stock_Price:  99.38734455107176
curr_Factors:  [99.38734455]
mat_Sqrt:  [[0.15]]
grads:  [0.20843872]
Stock Position:  0.20843872243597633
Bond Position:  [-34.02151015]


portfolio before change:  [-13.3431267]
curr_Stock_Price:  99.22645926054058
curr_Factors:  [99.22645926]
mat_Sqrt:  [[0.15]]
grads:  [-0.08013615]
Stock Position:  -0.08013614958528749
Bond Position:  [-5.39150032]


portfolio before change:  [-13.35481604]
curr_Stock_Price:  99.36391730473582
curr_Factors:  [99.3639173]
mat_Sqrt:  [[0.15]]
grads:  [-0.04517618]
Stock Position:  -0.0451761772670732
Bond Position:  [-8.8659341]


portfolio before change:  [-13.39839924]
curr_Stock_Price:  100.30412282382294
curr_Factors:  [100.30412282]
mat_Sqrt:  [[0.15]]
grads:  [-0.05084424]
Stock Position:  -0.05084424422134945
Bond Position:  [-8.29851192]


portfolio before change:  [-13.35220876]
curr_Stock_Price:  99.37524960017748
curr_Factors:  [99.3752496]
mat_Sqrt:  [[0.15]]
grads:  [0.18752632]
Stock Position:  0.1875263164648578
Bond Position:  [-31.98768327]


portfolio before change:  [-13.13454082]
curr_Stock_Price:  100.5573058302652
curr_Factors:  [100.55730583]
mat_Sqrt:  [[0.15]]
grads:  [0.02478048]
Stock Position:  0.024780479077139723
Bond Position:  [-15.62639904]


portfolio before change:  [-13.1431506]
curr_Stock_Price:  100.28869283786665
curr_Factors:  [100.28869284]
mat_Sqrt:  [[0.15]]
grads:  [0.03020063]
Stock Position:  0.030200633825524112
Bond Position:  [-16.17193269]


portfolio before change:  [-13.14619768]
curr_Stock_Price:  100.25473795473566
curr_Factors:  [100.25473795]
mat_Sqrt:  [[0.15]]
grads:  [-0.17257852]
Stock Position:  -0.1725785159130009
Bond Position:  [4.15561621]


portfolio before change:  [-13.07860984]
curr_Stock_Price:  99.8661127499496
curr_Factors:  [99.86611275]
mat_Sqrt:  [[0.15]]
grads:  [0.15599334]
Stock Position:  0.15599333511227018
Bond Position:  [-28.65705783]


portfolio before change:  [-13.11352263]
curr_Stock_Price:  99.66526802174737
curr_Factors:  [99.66526802]
mat_Sqrt:  [[0.15]]
grads:  [0.12956832]
Stock Position:  0.12956832059089926
Bond Position:  [-26.02698403]


portfolio before change:  [-13.20610508]
curr_Stock_Price:  98.97583349908699
curr_Factors:  [98.9758335]
mat_Sqrt:  [[0.15]]
grads:  [-0.09439656]
Stock Position:  -0.09439655977854389
Bond Position:  [-3.8631269]


portfolio before change:  [-13.12369197]
curr_Stock_Price:  98.09766554440581
curr_Factors:  [98.09766554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01324652]
Stock Position:  -0.013246516518902874
Bond Position:  [-11.82423962]


portfolio before change:  [-13.12685927]
curr_Stock_Price:  98.2251847537011
curr_Factors:  [98.22518475]
mat_Sqrt:  [[0.15]]
grads:  [0.04896637]
Stock Position:  0.04896637292902989
Bond Position:  [-17.9365903]


portfolio before change:  [-13.08884285]
curr_Stock_Price:  99.0473538935629
curr_Factors:  [99.04735389]
mat_Sqrt:  [[0.15]]
grads:  [-0.06724125]
Stock Position:  -0.06724125038513099
Bond Position:  [-6.42877492]


portfolio before change:  [-13.11895836]
curr_Stock_Price:  99.4832747136641
curr_Factors:  [99.48327471]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271552]
Stock Position:  -0.012715517224461195
Bond Position:  [-11.85397706]


portfolio before change:  [-13.11648984]
curr_Stock_Price:  99.17260266756784
curr_Factors:  [99.17260267]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057258]
Stock Position:  -0.04057257617139656
Bond Position:  [-9.09280186]


portfolio before change:  [-13.16098592]
curr_Stock_Price:  100.24129026456318
curr_Factors:  [100.24129026]
mat_Sqrt:  [[0.15]]
grads:  [0.03597909]
Stock Position:  0.035979090503059766
Bond Position:  [-16.76757637]


portfolio before change:  [-13.15790137]
curr_Stock_Price:  100.38528010776723
curr_Factors:  [100.38528011]
mat_Sqrt:  [[0.15]]
grads:  [0.0441138]
Stock Position:  0.04411380456984423
Bond Position:  [-17.586278]


portfolio before change:  [-13.17114362]
curr_Stock_Price:  100.13493160764844
curr_Factors:  [100.13493161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03293826]
Stock Position:  -0.03293825790163864
Bond Position:  [-9.87287342]


portfolio before change:  [-13.18396663]
curr_Stock_Price:  100.48676643537695
curr_Factors:  [100.48676644]
mat_Sqrt:  [[0.15]]
grads:  [-0.03331968]
Stock Position:  -0.03331967966878689
Bond Position:  [-9.83577977]


portfolio before change:  [-13.15787431]
curr_Stock_Price:  99.66677425305791
curr_Factors:  [99.66677425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04237024]
Stock Position:  -0.042370242038288104
Bond Position:  [-8.93496896]


portfolio before change:  [-13.20771148]
curr_Stock_Price:  100.81664331744484
curr_Factors:  [100.81664332]
mat_Sqrt:  [[0.15]]
grads:  [0.03986394]
Stock Position:  0.03986394084006885
Bond Position:  [-17.22666018]


portfolio before change:  [-13.24798367]
curr_Stock_Price:  99.86042253607656
curr_Factors:  [99.86042254]
mat_Sqrt:  [[0.15]]
grads:  [-0.05143791]
Stock Position:  -0.05143791373912703
Bond Position:  [-8.11137187]


portfolio before change:  [-13.25799623]
curr_Stock_Price:  100.03536297593628
curr_Factors:  [100.03536298]
mat_Sqrt:  [[0.15]]
grads:  [0.08414395]
Stock Position:  0.08414394652997842
Bond Position:  [-21.67536646]


portfolio before change:  [-13.33657119]
curr_Stock_Price:  99.13374891900997
curr_Factors:  [99.13374892]
mat_Sqrt:  [[0.15]]
grads:  [0.05173134]
Stock Position:  0.05173133944072429
Bond Position:  [-18.4648928]


portfolio before change:  [-13.34419711]
curr_Stock_Price:  99.03095487787745
curr_Factors:  [99.03095488]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758105]
Stock Position:  -0.04758104712100254
Bond Position:  [-8.63220058]


portfolio before change:  [-13.33818051]
curr_Stock_Price:  98.88182625552841
curr_Factors:  [98.88182626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01843736]
Stock Position:  -0.018437356835418965
Bond Position:  [-11.515061]


portfolio before change:  [-13.34579401]
curr_Stock_Price:  99.21669154483475
curr_Factors:  [99.21669154]
mat_Sqrt:  [[0.15]]
grads:  [-0.00877879]
Stock Position:  -0.00877879399278425
Bond Position:  [-12.47479112]


portfolio before change:  [-13.35763987]
curr_Stock_Price:  100.38842547354012
curr_Factors:  [100.38842547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05693845]
Stock Position:  -0.05693845169205905
Bond Position:  [-7.64167836]


portfolio before change:  [-13.30108987]
curr_Stock_Price:  99.3784705961919
curr_Factors:  [99.3784706]
mat_Sqrt:  [[0.15]]
grads:  [-0.05052063]
Stock Position:  -0.05052062533718253
Bond Position:  [-8.28042739]


portfolio before change:  [-13.3283211]
curr_Stock_Price:  99.89699370705824
curr_Factors:  [99.89699371]
mat_Sqrt:  [[0.15]]
grads:  [0.10556147]
Stock Position:  0.10556147322356632
Bond Position:  [-23.87359493]


portfolio before change:  [-13.23031709]
curr_Stock_Price:  100.85367225493226
curr_Factors:  [100.85367225]
mat_Sqrt:  [[0.15]]
grads:  [-0.03010328]
Stock Position:  -0.030103277632329836
Bond Position:  [-10.194291]


portfolio before change:  [-13.21241294]
curr_Stock_Price:  100.2165814855655
curr_Factors:  [100.21658149]
mat_Sqrt:  [[0.15]]
grads:  [-0.1388306]
Stock Position:  -0.1388306023931652
Bond Position:  [0.70071544]


portfolio before change:  [-13.14148069]
curr_Stock_Price:  99.70628580536443
curr_Factors:  [99.70628581]
mat_Sqrt:  [[0.15]]
grads:  [-0.14421666]
Stock Position:  -0.14421666039367323
Bond Position:  [1.23782687]


portfolio before change:  [-13.0018941]
curr_Stock_Price:  98.73946372252051
curr_Factors:  [98.73946372]
mat_Sqrt:  [[0.15]]
grads:  [0.25305508]
Stock Position:  0.25305508041173785
Bond Position:  [-37.98841703]


portfolio before change:  [-13.35055234]
curr_Stock_Price:  97.38043392647167
curr_Factors:  [97.38043393]
mat_Sqrt:  [[0.15]]
grads:  [0.00292528]
Stock Position:  0.002925278107449835
Bond Position:  [-13.63541719]


portfolio before change:  [-13.3502443]
curr_Stock_Price:  98.06842918725341
curr_Factors:  [98.06842919]
mat_Sqrt:  [[0.15]]
grads:  [0.04648838]
Stock Position:  0.04648838179176189
Bond Position:  [-17.90928687]


portfolio before change:  [-13.38576024]
curr_Stock_Price:  97.35261289069177
curr_Factors:  [97.35261289]
mat_Sqrt:  [[0.15]]
grads:  [0.05757766]
Stock Position:  0.05757765673902027
Bond Position:  [-18.99109557]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.36568266]
Stock Price:  97.74254914213167
PL:  [-13.36568266]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.28487672e-02]
 [ 4.38606847e-02]
 [-3.55810361e-03]
 [-2.61627151e-03]
 [-1.37606718e-03]
 [ 1.32838243e-02]
 [ 3.50840620e-03]
 [ 1.00285255e-02]
 [ 4.91879653e-02]
 [ 2.24921954e-02]
 [ 1.53038178e-02]
 [ 3.81412287e-03]
 [-1.23328162e-03]
 [ 2.33133868e-02]
 [-1.05864182e-02]
 [-3.01605649e-03]
 [-5.62499980e-03]
 [ 7.31698716e-03]
 [ 1.17618935e-02]
 [ 9.51421162e-03]
 [-3.76098282e-03]
 [-4.70316007e-03]
 [ 4.81403677e-03]
 [-1.20537350e-02]
 [ 8.60940574e-04]
 [ 4.21488686e-03]
 [ 5.40975646e-03]
 [ 2.09456320e-03]
 [ 4.80182823e-03]
 [-4.74545516e-03]
 [-1.52822039e-02]
 [ 6.67334552e-03]
 [ 1.71533448e-03]
 [ 3.63608705e-03]
 [-2.02198188e-02]
 [ 7.14080118e-03]
 [ 9.75935343e-03]
 [ 2.27765063e-02]
 [ 1.04386926e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.66659816]
curr_Stock_Price:  99.51934645578568
curr_Factors:  [99.51934646]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565845]
Stock Position:  -0.0856584478386511
Bond Position:  [-0.14192541]


portfolio before change:  [-8.74794369]
curr_Stock_Price:  100.46878920710076
curr_Factors:  [100.46878921]
mat_Sqrt:  [[0.15]]
grads:  [0.29240456]
Stock Position:  0.29240456496830447
Bond Position:  [-38.12547629]


portfolio before change:  [-8.69968183]
curr_Stock_Price:  100.65014015799673
curr_Factors:  [100.65014016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02372069]
Stock Position:  -0.023720690756239584
Bond Position:  [-6.31219098]


portfolio before change:  [-8.71356243]
curr_Stock_Price:  101.20204363902822
curr_Factors:  [101.20204364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01744181]
Stock Position:  -0.01744181006746224
Bond Position:  [-6.94841561]


portfolio before change:  [-8.72949092]
curr_Stock_Price:  102.06547932795289
curr_Factors:  [102.06547933]
mat_Sqrt:  [[0.15]]
grads:  [-0.00917378]
Stock Position:  -0.0091737812054861
Bond Position:  [-7.79316454]


portfolio before change:  [-8.73107549]
curr_Stock_Price:  102.13201274632443
curr_Factors:  [102.13201275]
mat_Sqrt:  [[0.15]]
grads:  [0.08855883]
Stock Position:  0.08855882898784229
Bond Position:  [-17.77576694]


portfolio before change:  [-8.73413742]
curr_Stock_Price:  102.12252953923047
curr_Factors:  [102.12252954]
mat_Sqrt:  [[0.15]]
grads:  [0.02338937]
Stock Position:  0.02338937467536481
Bond Position:  [-11.12271953]


portfolio before change:  [-8.75092497]
curr_Stock_Price:  101.46423384796839
curr_Factors:  [101.46423385]
mat_Sqrt:  [[0.15]]
grads:  [0.06685684]
Stock Position:  0.06685683670993514
Bond Position:  [-15.53450269]


portfolio before change:  [-8.60327041]
curr_Stock_Price:  103.70179843551037
curr_Factors:  [103.70179844]
mat_Sqrt:  [[0.15]]
grads:  [0.32791977]
Stock Position:  0.32791976840716186
Bond Position:  [-42.60914014]


portfolio before change:  [-8.29733151]
curr_Stock_Price:  104.65101042421567
curr_Factors:  [104.65101042]
mat_Sqrt:  [[0.15]]
grads:  [0.14994797]
Stock Position:  0.1499479692078417
Bond Position:  [-23.989538]


portfolio before change:  [-8.33418457]
curr_Stock_Price:  104.42523761258869
curr_Factors:  [104.42523761]
mat_Sqrt:  [[0.15]]
grads:  [0.10202545]
Stock Position:  0.10202545231458506
Bond Position:  [-18.98821667]


portfolio before change:  [-8.36585088]
curr_Stock_Price:  104.13812657336423
curr_Factors:  [104.13812657]
mat_Sqrt:  [[0.15]]
grads:  [0.02542749]
Stock Position:  0.02542748580392152
Bond Position:  [-11.01382161]


portfolio before change:  [-8.36026829]
curr_Stock_Price:  104.41182277308859
curr_Factors:  [104.41182277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00822188]
Stock Position:  -0.008221877486191919
Bond Position:  [-7.50180707]


portfolio before change:  [-8.36327307]
curr_Stock_Price:  104.66322537044248
curr_Factors:  [104.66322537]
mat_Sqrt:  [[0.15]]
grads:  [0.15542258]
Stock Position:  0.15542257855528122
Bond Position:  [-24.63030144]


portfolio before change:  [-8.56896654]
curr_Stock_Price:  103.35958921846374
curr_Factors:  [103.35958922]
mat_Sqrt:  [[0.15]]
grads:  [-0.07057612]
Stock Position:  -0.07057612136224667
Bond Position:  [-1.27424763]


portfolio before change:  [-8.50789723]
curr_Stock_Price:  102.49203505263242
curr_Factors:  [102.49203505]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010704]
Stock Position:  -0.020107043242414305
Bond Position:  [-6.44708545]


portfolio before change:  [-8.49806642]
curr_Stock_Price:  101.963029231541
curr_Factors:  [101.96302923]
mat_Sqrt:  [[0.15]]
grads:  [-0.0375]
Stock Position:  -0.03749999864612385
Bond Position:  [-4.67445296]


portfolio before change:  [-8.52294293]
curr_Stock_Price:  102.61082050183997
curr_Factors:  [102.6108205]
mat_Sqrt:  [[0.15]]
grads:  [0.04877991]
Stock Position:  0.04877991442776928
Bond Position:  [-13.52828998]


portfolio before change:  [-8.56772761]
curr_Stock_Price:  101.72739260345519
curr_Factors:  [101.7273926]
mat_Sqrt:  [[0.15]]
grads:  [0.07841262]
Stock Position:  0.07841262366121064
Bond Position:  [-16.54443937]


portfolio before change:  [-8.62779167]
curr_Stock_Price:  100.98776844658164
curr_Factors:  [100.98776845]
mat_Sqrt:  [[0.15]]
grads:  [0.06342808]
Stock Position:  0.06342807745521511
Bond Position:  [-15.03325167]


portfolio before change:  [-8.60560737]
curr_Stock_Price:  101.36715210436971
curr_Factors:  [101.3671521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507322]
Stock Position:  -0.025073218792084417
Bond Position:  [-6.06400658]


portfolio before change:  [-8.59665604]
curr_Stock_Price:  100.9799112468481
curr_Factors:  [100.97991125]
mat_Sqrt:  [[0.15]]
grads:  [-0.0313544]
Stock Position:  -0.03135440049207934
Bond Position:  [-5.43049146]


portfolio before change:  [-8.61350881]
curr_Stock_Price:  101.49575326832459
curr_Factors:  [101.49575327]
mat_Sqrt:  [[0.15]]
grads:  [0.03209358]
Stock Position:  0.03209357845529776
Bond Position:  [-11.87087073]


portfolio before change:  [-8.60143243]
curr_Stock_Price:  101.91827793142166
curr_Factors:  [101.91827793]
mat_Sqrt:  [[0.15]]
grads:  [-0.08035823]
Stock Position:  -0.08035823347924186
Bond Position:  [-0.41145966]


portfolio before change:  [-8.66194893]
curr_Stock_Price:  102.67072180712954
curr_Factors:  [102.67072181]
mat_Sqrt:  [[0.15]]
grads:  [0.0057396]
Stock Position:  0.00573960382439169
Bond Position:  [-9.2512382]


portfolio before change:  [-8.65840689]
curr_Stock_Price:  103.48933535833203
curr_Factors:  [103.48933536]
mat_Sqrt:  [[0.15]]
grads:  [0.02809925]
Stock Position:  0.028099245761312504
Bond Position:  [-11.56637916]


portfolio before change:  [-8.64105803]
curr_Stock_Price:  104.15820572463376
curr_Factors:  [104.15820572]
mat_Sqrt:  [[0.15]]
grads:  [0.03606504]
Stock Position:  0.036065043086574926
Bond Position:  [-12.3975282]


portfolio before change:  [-8.6243362]
curr_Stock_Price:  104.66483524871174
curr_Factors:  [104.66483525]
mat_Sqrt:  [[0.15]]
grads:  [0.01396375]
Stock Position:  0.013963754684032029
Bond Position:  [-10.08585028]


portfolio before change:  [-8.64002865]
curr_Stock_Price:  103.63132798513857
curr_Factors:  [103.63132799]
mat_Sqrt:  [[0.15]]
grads:  [0.03201219]
Stock Position:  0.0320121881984681
Bond Position:  [-11.95749422]


portfolio before change:  [-8.62065886]
curr_Stock_Price:  104.28309761127089
curr_Factors:  [104.28309761]
mat_Sqrt:  [[0.15]]
grads:  [-0.03163637]
Stock Position:  -0.03163636774549671
Bond Position:  [-5.32152043]


portfolio before change:  [-8.64276925]
curr_Stock_Price:  104.96096165214172
curr_Factors:  [104.96096165]
mat_Sqrt:  [[0.15]]
grads:  [-0.10188136]
Stock Position:  -0.10188135955517755
Bond Position:  [2.05079623]


portfolio before change:  [-8.5425286]
curr_Stock_Price:  103.97958217572189
curr_Factors:  [103.97958218]
mat_Sqrt:  [[0.15]]
grads:  [0.04448897]
Stock Position:  0.04448897014506049
Bond Position:  [-13.16847313]


portfolio before change:  [-8.53584121]
curr_Stock_Price:  104.16689961012804
curr_Factors:  [104.16689961]
mat_Sqrt:  [[0.15]]
grads:  [0.01143556]
Stock Position:  0.011435563221346257
Bond Position:  [-9.72704837]


portfolio before change:  [-8.53643174]
curr_Stock_Price:  104.22159071375032
curr_Factors:  [104.22159071]
mat_Sqrt:  [[0.15]]
grads:  [0.02424058]
Stock Position:  0.02424058030571772
Bond Position:  [-11.06282358]


portfolio before change:  [-8.53623234]
curr_Stock_Price:  104.28686703583774
curr_Factors:  [104.28686704]
mat_Sqrt:  [[0.15]]
grads:  [-0.13479879]
Stock Position:  -0.13479879220077928
Bond Position:  [5.52151138]


portfolio before change:  [-8.51234071]
curr_Stock_Price:  104.11474827875153
curr_Factors:  [104.11474828]
mat_Sqrt:  [[0.15]]
grads:  [0.04760534]
Stock Position:  0.0476053412133393
Bond Position:  [-13.46875883]


portfolio before change:  [-8.47620037]
curr_Stock_Price:  104.90928181912723
curr_Factors:  [104.90928182]
mat_Sqrt:  [[0.15]]
grads:  [0.06506236]
Stock Position:  0.06506235617349014
Bond Position:  [-15.30184543]


portfolio before change:  [-8.55627328]
curr_Stock_Price:  103.70797185464161
curr_Factors:  [103.70797185]
mat_Sqrt:  [[0.15]]
grads:  [0.15184338]
Stock Position:  0.1518433754098783
Bond Position:  [-24.30364178]


portfolio before change:  [-8.54815285]
curr_Stock_Price:  103.78145923543039
curr_Factors:  [103.78145924]
mat_Sqrt:  [[0.15]]
grads:  [0.06959128]
Stock Position:  0.06959128395907944
Bond Position:  [-15.77043785]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.59704989]
Stock Price:  103.10715629819562
PL:  [-11.70420618]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.21605057e-02]
 [ 4.41350498e-02]
 [-3.55450193e-03]
 [-2.15343728e-03]
 [-6.77625892e-03]
 [ 3.24573753e-02]
 [ 3.61470125e-03]
 [-1.17891041e-03]
 [-8.77575015e-03]
 [ 2.34426256e-02]
 [ 2.12907557e-02]
 [-6.33828920e-03]
 [-2.30676690e-02]
 [ 1.78868128e-02]
 [-3.46086662e-03]
 [-1.60696703e-03]
 [-6.07148123e-03]
 [-5.84288077e-03]
 [ 1.74799316e-03]
 [ 4.35737139e-03]
 [-1.61543818e-02]
 [-2.66893983e-02]
 [ 4.01565151e-03]
 [-1.27380975e-02]
 [ 1.03428900e-02]
 [-2.92509517e-03]
 [ 3.57999295e-02]
 [-5.60656677e-03]
 [-5.54829854e-02]
 [-9.10276605e-03]
 [ 4.75909436e-02]
 [-5.15698830e-03]
 [-2.25581731e-02]
 [-8.20052206e-03]
 [-2.42569125e-02]
 [ 3.00846888e-02]
 [-1.39080652e-02]
 [-1.09581793e-02]
 [ 4.57207756e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.3659406]
curr_Stock_Price:  99.53304022026235
curr_Factors:  [99.53304022]
mat_Sqrt:  [[0.15]]
grads:  [-0.08107004]
Stock Position:  -0.08107003821372996
Bond Position:  [-0.29679323]


portfolio before change:  [-8.42935235]
curr_Stock_Price:  100.31476735493288
curr_Factors:  [100.31476735]
mat_Sqrt:  [[0.15]]
grads:  [0.29423367]
Stock Position:  0.2942336654502451
Bond Position:  [-37.94533405]


portfolio before change:  [-8.34759856]
curr_Stock_Price:  100.60874205471083
curr_Factors:  [100.60874205]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369668]
Stock Position:  -0.023696679526699384
Bond Position:  [-5.96350544]


portfolio before change:  [-8.34816218]
curr_Stock_Price:  100.60106727531912
curr_Factors:  [100.60106728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01435625]
Stock Position:  -0.014356248518904626
Bond Position:  [-6.90390825]


portfolio before change:  [-8.34721695]
curr_Stock_Price:  100.4751099451349
curr_Factors:  [100.47510995]
mat_Sqrt:  [[0.15]]
grads:  [-0.04517506]
Stock Position:  -0.04517505945967989
Bond Position:  [-3.80824788]


portfolio before change:  [-8.35214184]
curr_Stock_Price:  100.57358975377939
curr_Factors:  [100.57358975]
mat_Sqrt:  [[0.15]]
grads:  [0.2163825]
Stock Position:  0.21638250229382996
Bond Position:  [-30.11450685]


portfolio before change:  [-8.52498033]
curr_Stock_Price:  99.79222367493436
curr_Factors:  [99.79222367]
mat_Sqrt:  [[0.15]]
grads:  [0.02409801]
Stock Position:  0.024098008356827294
Bond Position:  [-10.92977417]


portfolio before change:  [-8.54538882]
curr_Stock_Price:  99.002026622866
curr_Factors:  [99.00202662]
mat_Sqrt:  [[0.15]]
grads:  [-0.0078594]
Stock Position:  -0.007859402710494168
Bond Position:  [-7.76729202]


portfolio before change:  [-8.53799155]
curr_Stock_Price:  97.93728491572273
curr_Factors:  [97.93728492]
mat_Sqrt:  [[0.15]]
grads:  [-0.058505]
Stock Position:  -0.05850500097601024
Bond Position:  [-2.8081706]


portfolio before change:  [-8.54222881]
curr_Stock_Price:  98.00371018000926
curr_Factors:  [98.00371018]
mat_Sqrt:  [[0.15]]
grads:  [0.15628417]
Stock Position:  0.1562841707206597
Bond Position:  [-23.85865738]


portfolio before change:  [-8.62308765]
curr_Stock_Price:  97.50541070032885
curr_Factors:  [97.5054107]
mat_Sqrt:  [[0.15]]
grads:  [0.14193837]
Stock Position:  0.1419383712186291
Bond Position:  [-22.46284683]


portfolio before change:  [-8.721564]
curr_Stock_Price:  96.83139757799408
curr_Factors:  [96.83139758]
mat_Sqrt:  [[0.15]]
grads:  [-0.04225526]
Stock Position:  -0.04225526135517978
Bond Position:  [-4.62992799]


portfolio before change:  [-8.6864112]
curr_Stock_Price:  95.98578502434178
curr_Factors:  [95.98578502]
mat_Sqrt:  [[0.15]]
grads:  [-0.15378446]
Stock Position:  -0.15378445976259825
Bond Position:  [6.07471089]


portfolio before change:  [-8.6560841]
curr_Stock_Price:  95.79351779941857
curr_Factors:  [95.7935178]
mat_Sqrt:  [[0.15]]
grads:  [0.11924542]
Stock Position:  0.11924541857611627
Bond Position:  [-20.07902223]


portfolio before change:  [-8.73307502]
curr_Stock_Price:  95.16891615005767
curr_Factors:  [95.16891615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02307244]
Stock Position:  -0.02307244414012137
Bond Position:  [-6.53729552]


portfolio before change:  [-8.72942929]
curr_Stock_Price:  94.97548420754771
curr_Factors:  [94.97548421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01071311]
Stock Position:  -0.01071311355305142
Bond Position:  [-7.71194614]


portfolio before change:  [-8.73635703]
curr_Stock_Price:  95.53215625849425
curr_Factors:  [95.53215626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04047654]
Stock Position:  -0.040476541526517
Bond Position:  [-4.86954574]


portfolio before change:  [-8.72902748]
curr_Stock_Price:  95.33603565427175
curr_Factors:  [95.33603565]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895254]
Stock Position:  -0.03895253848482084
Bond Position:  [-5.01544688]


portfolio before change:  [-8.72064999]
curr_Stock_Price:  95.10487081713205
curr_Factors:  [95.10487082]
mat_Sqrt:  [[0.15]]
grads:  [0.01165329]
Stock Position:  0.011653287763278102
Bond Position:  [-9.82893442]


portfolio before change:  [-8.72051957]
curr_Stock_Price:  95.22150030866533
curr_Factors:  [95.22150031]
mat_Sqrt:  [[0.15]]
grads:  [0.02904914]
Stock Position:  0.0290491426310778
Bond Position:  [-11.48662251]


portfolio before change:  [-8.72442376]
curr_Stock_Price:  95.13653130816981
curr_Factors:  [95.13653131]
mat_Sqrt:  [[0.15]]
grads:  [-0.10769588]
Stock Position:  -0.10769587843420757
Bond Position:  [1.52138855]


portfolio before change:  [-8.52209488]
curr_Stock_Price:  93.25959133613753
curr_Factors:  [93.25959134]
mat_Sqrt:  [[0.15]]
grads:  [-0.17792932]
Stock Position:  -0.17792932222211963
Bond Position:  [8.071521]


portfolio before change:  [-8.62891244]
curr_Stock_Price:  93.86559918964919
curr_Factors:  [93.86559919]
mat_Sqrt:  [[0.15]]
grads:  [0.02677101]
Stock Position:  0.026771010068998343
Bond Position:  [-11.14178934]


portfolio before change:  [-8.63022135]
curr_Stock_Price:  93.8687332054254
curr_Factors:  [93.86873321]
mat_Sqrt:  [[0.15]]
grads:  [-0.08492065]
Stock Position:  -0.08492065031173972
Bond Position:  [-0.65882749]


portfolio before change:  [-8.68304925]
curr_Stock_Price:  94.48984881570156
curr_Factors:  [94.48984882]
mat_Sqrt:  [[0.15]]
grads:  [0.0689526]
Stock Position:  0.06895260004335015
Bond Position:  [-15.19837001]


portfolio before change:  [-8.7630101]
curr_Stock_Price:  93.35775325164751
curr_Factors:  [93.35775325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950063]
Stock Position:  -0.019500634440224776
Bond Position:  [-6.94247468]


portfolio before change:  [-8.76336562]
curr_Stock_Price:  93.33147996647999
curr_Factors:  [93.33147997]
mat_Sqrt:  [[0.15]]
grads:  [0.2386662]
Stock Position:  0.23866619668946026
Bond Position:  [-31.03843497]


portfolio before change:  [-8.85335626]
curr_Stock_Price:  92.97068068935566
curr_Factors:  [92.97068069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03737711]
Stock Position:  -0.037377111788370325
Bond Position:  [-5.37838073]


portfolio before change:  [-8.85449747]
curr_Stock_Price:  92.98322507645375
curr_Factors:  [92.98322508]
mat_Sqrt:  [[0.15]]
grads:  [-0.36988657]
Stock Position:  -0.36988656936386083
Bond Position:  [25.53874866]


portfolio before change:  [-9.44636513]
curr_Stock_Price:  94.59198910258868
curr_Factors:  [94.5919891]
mat_Sqrt:  [[0.15]]
grads:  [-0.06068511]
Stock Position:  -0.060685106976637905
Bond Position:  [-3.70604015]


portfolio before change:  [-9.44424148]
curr_Stock_Price:  94.54936020001784
curr_Factors:  [94.5493602]
mat_Sqrt:  [[0.15]]
grads:  [0.31727296]
Stock Position:  0.3172729571451556
Bond Position:  [-39.44219658]


portfolio before change:  [-9.93410097]
curr_Stock_Price:  93.020932071829
curr_Factors:  [93.02093207]
mat_Sqrt:  [[0.15]]
grads:  [-0.03437992]
Stock Position:  -0.03437992199269639
Bond Position:  [-6.73604858]


portfolio before change:  [-9.92394134]
curr_Stock_Price:  92.70092860964544
curr_Factors:  [92.70092861]
mat_Sqrt:  [[0.15]]
grads:  [-0.15038782]
Stock Position:  -0.15038782072713236
Bond Position:  [4.0171493]


portfolio before change:  [-9.90550979]
curr_Stock_Price:  92.58170772380203
curr_Factors:  [92.58170772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467015]
Stock Position:  -0.05467014707108465
Bond Position:  [-4.84405421]


portfolio before change:  [-9.91269705]
curr_Stock_Price:  92.70209724996504
curr_Factors:  [92.70209725]
mat_Sqrt:  [[0.15]]
grads:  [-0.16171275]
Stock Position:  -0.1617127502298303
Bond Position:  [5.07841405]


portfolio before change:  [-9.93631385]
curr_Stock_Price:  92.85206463159494
curr_Factors:  [92.85206463]
mat_Sqrt:  [[0.15]]
grads:  [0.20056459]
Stock Position:  0.2005645919970337
Bond Position:  [-28.55915031]


portfolio before change:  [-10.16340832]
curr_Stock_Price:  91.73758899090801
curr_Factors:  [91.73758899]
mat_Sqrt:  [[0.15]]
grads:  [-0.09272043]
Stock Position:  -0.09272043493408491
Bond Position:  [-1.65745916]


portfolio before change:  [-10.2277011]
curr_Stock_Price:  92.4287590516874
curr_Factors:  [92.42875905]
mat_Sqrt:  [[0.15]]
grads:  [-0.07305453]
Stock Position:  -0.07305452883759059
Bond Position:  [-3.47536166]


portfolio before change:  [-10.19694613]
curr_Stock_Price:  92.00182568655383
curr_Factors:  [92.00182569]
mat_Sqrt:  [[0.15]]
grads:  [0.30480517]
Stock Position:  0.30480517044420574
Bond Position:  [-38.23957829]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.7041046]
Stock Price:  90.35363114410472
PL:  [-10.7041046]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.80082693e-02]
 [ 8.33597141e-03]
 [-2.80951296e-03]
 [-2.16080791e-03]
 [-1.80065731e-03]
 [ 3.17043986e-02]
 [ 3.54556609e-03]
 [-1.37155878e-03]
 [-1.89932688e-02]
 [ 2.34160665e-02]
 [ 2.00037195e-02]
 [-1.41334094e-02]
 [ 7.59957490e-03]
 [ 6.54505485e-03]
 [-8.95218833e-03]
 [ 6.99262706e-04]
 [-6.11127622e-03]
 [ 8.09628590e-04]
 [ 8.47045883e-04]
 [ 1.21919229e-04]
 [-1.89340941e-02]
 [-2.45852572e-02]
 [ 4.18753741e-03]
 [-1.13422069e-02]
 [ 1.01966196e-02]
 [-3.12350644e-03]
 [ 4.08004133e-02]
 [-6.24697962e-03]
 [-5.90018775e-02]
 [-7.55293725e-03]
 [ 5.27927681e-02]
 [-5.52206069e-03]
 [-2.18895378e-02]
 [-1.26175023e-02]
 [-2.36521469e-02]
 [ 3.32184759e-02]
 [-8.41091751e-03]
 [-8.96839958e-03]
 [ 2.56036199e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.75711806]
curr_Stock_Price:  101.13275685712733
curr_Factors:  [101.13275686]
mat_Sqrt:  [[0.15]]
grads:  [-0.32005513]
Stock Position:  -0.32005512855116464
Bond Position:  [59.12517556]


portfolio before change:  [26.78134267]
curr_Stock_Price:  101.08016123774105
curr_Factors:  [101.08016124]
mat_Sqrt:  [[0.15]]
grads:  [0.05557314]
Stock Position:  0.0555731427036503
Bond Position:  [21.16400044]


portfolio before change:  [26.73418917]
curr_Stock_Price:  100.18406006118036
curr_Factors:  [100.18406006]
mat_Sqrt:  [[0.15]]
grads:  [-0.01873009]
Stock Position:  -0.01873008636997692
Bond Position:  [28.61064527]


portfolio before change:  [26.72425302]
curr_Stock_Price:  100.90550409817295
curr_Factors:  [100.9055041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01440539]
Stock Position:  -0.014405386046565681
Bond Position:  [28.17783576]


portfolio before change:  [26.71386773]
curr_Stock_Price:  101.87095827926
curr_Factors:  [101.87095828]
mat_Sqrt:  [[0.15]]
grads:  [-0.01200438]
Stock Position:  -0.012004382041639963
Bond Position:  [27.93676563]


portfolio before change:  [26.73453802]
curr_Stock_Price:  100.43998251002846
curr_Factors:  [100.43998251]
mat_Sqrt:  [[0.15]]
grads:  [0.21136266]
Stock Position:  0.21136265725670647
Bond Position:  [5.50527643]


portfolio before change:  [26.45799338]
curr_Stock_Price:  99.12833716667495
curr_Factors:  [99.12833717]
mat_Sqrt:  [[0.15]]
grads:  [0.02363711]
Stock Position:  0.023637107247402925
Bond Position:  [24.11488624]


portfolio before change:  [26.46434312]
curr_Stock_Price:  99.26943676472894
curr_Factors:  [99.26943676]
mat_Sqrt:  [[0.15]]
grads:  [-0.00914373]
Stock Position:  -0.009143725199114478
Bond Position:  [27.37203557]


portfolio before change:  [26.47556499]
curr_Stock_Price:  98.41637609591719
curr_Factors:  [98.4163761]
mat_Sqrt:  [[0.15]]
grads:  [-0.12662179]
Stock Position:  -0.1266217922875426
Bond Position:  [38.93722292]


portfolio before change:  [26.37678968]
curr_Stock_Price:  99.2348984545944
curr_Factors:  [99.23489845]
mat_Sqrt:  [[0.15]]
grads:  [0.15610711]
Stock Position:  0.15610710996608806
Bond Position:  [10.88551647]


portfolio before change:  [26.3673244]
curr_Stock_Price:  99.16554833362115
curr_Factors:  [99.16554833]
mat_Sqrt:  [[0.15]]
grads:  [0.13335813]
Stock Position:  0.13335812968113542
Bond Position:  [13.14279235]


portfolio before change:  [26.34204692]
curr_Stock_Price:  98.96368264598274
curr_Factors:  [98.96368265]
mat_Sqrt:  [[0.15]]
grads:  [-0.09422273]
Stock Position:  -0.09422272932463087
Bond Position:  [35.66667521]


portfolio before change:  [26.36321882]
curr_Stock_Price:  98.78630208652514
curr_Factors:  [98.78630209]
mat_Sqrt:  [[0.15]]
grads:  [0.05066383]
Stock Position:  0.05066383264464879
Bond Position:  [21.35832614]


portfolio before change:  [26.35525135]
curr_Stock_Price:  98.57634111558099
curr_Factors:  [98.57634112]
mat_Sqrt:  [[0.15]]
grads:  [0.0436337]
Stock Position:  0.04363369897137826
Bond Position:  [22.05400095]


portfolio before change:  [26.38980777]
curr_Stock_Price:  99.30512409210637
curr_Factors:  [99.30512409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05968126]
Stock Position:  -0.05968125555916938
Bond Position:  [32.31646226]


portfolio before change:  [26.49521596]
curr_Stock_Price:  97.60662796889285
curr_Factors:  [97.60662797]
mat_Sqrt:  [[0.15]]
grads:  [0.00466175]
Stock Position:  0.00466175137157706
Bond Position:  [26.04019813]


portfolio before change:  [26.49424084]
curr_Stock_Price:  96.69916917792251
curr_Factors:  [96.69916918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074184]
Stock Position:  -0.04074184144920435
Bond Position:  [30.43394306]


portfolio before change:  [26.47418852]
curr_Stock_Price:  97.28472948979247
curr_Factors:  [97.28472949]
mat_Sqrt:  [[0.15]]
grads:  [0.00539752]
Stock Position:  0.005397523936083287
Bond Position:  [25.94909186]


portfolio before change:  [26.47619058]
curr_Stock_Price:  97.05466549255988
curr_Factors:  [97.05466549]
mat_Sqrt:  [[0.15]]
grads:  [0.00564697]
Stock Position:  0.005646972550320424
Bond Position:  [25.92812555]


portfolio before change:  [26.47095248]
curr_Stock_Price:  95.55309645645714
curr_Factors:  [95.55309646]
mat_Sqrt:  [[0.15]]
grads:  [0.00081279]
Stock Position:  0.0008127948630865546
Bond Position:  [26.39328741]


portfolio before change:  [26.47339333]
curr_Stock_Price:  94.49684149553799
curr_Factors:  [94.4968415]
mat_Sqrt:  [[0.15]]
grads:  [-0.12622729]
Stock Position:  -0.1262272938060616
Bond Position:  [38.4014739]


portfolio before change:  [26.50663157]
curr_Stock_Price:  94.27155143394025
curr_Factors:  [94.27155143]
mat_Sqrt:  [[0.15]]
grads:  [-0.16390171]
Stock Position:  -0.16390171451943386
Bond Position:  [41.95790048]


portfolio before change:  [26.50308401]
curr_Stock_Price:  94.325197095538
curr_Factors:  [94.3251971]
mat_Sqrt:  [[0.15]]
grads:  [0.02791692]
Stock Position:  0.02791691604072721
Bond Position:  [23.86981541]


portfolio before change:  [26.52879771]
curr_Stock_Price:  95.13939091742155
curr_Factors:  [95.13939092]
mat_Sqrt:  [[0.15]]
grads:  [-0.07561471]
Stock Position:  -0.075614712697416
Bond Position:  [33.72273542]


portfolio before change:  [26.59304318]
curr_Stock_Price:  94.34549952143506
curr_Factors:  [94.34549952]
mat_Sqrt:  [[0.15]]
grads:  [0.06797746]
Stock Position:  0.0679774637775288
Bond Position:  [20.17967541]


portfolio before change:  [26.51858361]
curr_Stock_Price:  93.21303311114669
curr_Factors:  [93.21303311]
mat_Sqrt:  [[0.15]]
grads:  [-0.02082338]
Stock Position:  -0.02082337626495066
Bond Position:  [28.45959367]


portfolio before change:  [26.53860715]
curr_Stock_Price:  92.42229331704183
curr_Factors:  [92.42229332]
mat_Sqrt:  [[0.15]]
grads:  [0.27200276]
Stock Position:  0.27200275565008425
Bond Position:  [1.39948868]


portfolio before change:  [26.28446879]
curr_Stock_Price:  91.48732738643835
curr_Factors:  [91.48732739]
mat_Sqrt:  [[0.15]]
grads:  [-0.04164653]
Stock Position:  -0.0416465307780797
Bond Position:  [30.09459858]


portfolio before change:  [26.24123523]
curr_Stock_Price:  92.61576758240467
curr_Factors:  [92.61576758]
mat_Sqrt:  [[0.15]]
grads:  [-0.39334585]
Stock Position:  -0.3933458500079961
Bond Position:  [62.67126305]


portfolio before change:  [26.07780059]
curr_Stock_Price:  93.0511834726104
curr_Factors:  [93.05118347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035291]
Stock Position:  -0.05035291498397537
Bond Position:  [30.76319892]


portfolio before change:  [26.05729546]
curr_Stock_Price:  93.5347855910842
curr_Factors:  [93.53478559]
mat_Sqrt:  [[0.15]]
grads:  [0.35195179]
Stock Position:  0.35195178702917185
Bond Position:  [-6.86243948]


portfolio before change:  [25.81653663]
curr_Stock_Price:  92.85315540203491
curr_Factors:  [92.8531554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03681374]
Stock Position:  -0.036813737909824236
Bond Position:  [29.23480836]


portfolio before change:  [25.79394425]
curr_Stock_Price:  93.5661219818759
curr_Factors:  [93.56612198]
mat_Sqrt:  [[0.15]]
grads:  [-0.14593025]
Stock Position:  -0.14593025219585323
Bond Position:  [39.44807203]


portfolio before change:  [25.81557705]
curr_Stock_Price:  93.45167357432453
curr_Factors:  [93.45167357]
mat_Sqrt:  [[0.15]]
grads:  [-0.08411668]
Stock Position:  -0.08411668201999781
Bond Position:  [33.67642176]


portfolio before change:  [25.73436408]
curr_Stock_Price:  94.46720091210982
curr_Factors:  [94.46720091]
mat_Sqrt:  [[0.15]]
grads:  [-0.15768098]
Stock Position:  -0.15768097900244638
Bond Position:  [40.6300448]


portfolio before change:  [25.83151462]
curr_Stock_Price:  93.88329111806864
curr_Factors:  [93.88329112]
mat_Sqrt:  [[0.15]]
grads:  [0.22145651]
Stock Position:  0.22145650592517627
Bond Position:  [5.040449]


portfolio before change:  [25.82721794]
curr_Stock_Price:  93.86104399666262
curr_Factors:  [93.861044]
mat_Sqrt:  [[0.15]]
grads:  [-0.05607278]
Stock Position:  -0.056072783393403755
Bond Position:  [31.09026793]


portfolio before change:  [25.87249931]
curr_Stock_Price:  93.12280996601307
curr_Factors:  [93.12280997]
mat_Sqrt:  [[0.15]]
grads:  [-0.05978933]
Stock Position:  -0.059789330527472984
Bond Position:  [31.44024977]


portfolio before change:  [25.78142089]
curr_Stock_Price:  94.71186760610388
curr_Factors:  [94.71186761]
mat_Sqrt:  [[0.15]]
grads:  [0.1706908]
Stock Position:  0.17069079955821617
Bond Position:  [9.61497648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.71065254]
Stock Price:  94.2902262540854
PL:  [25.71065254]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.38929228e-02]
 [ 3.07571564e-02]
 [-3.71539364e-03]
 [-6.48170910e-03]
 [-7.70256319e-03]
 [ 2.81923349e-02]
 [ 3.58623903e-03]
 [-1.34441291e-03]
 [-1.92964318e-02]
 [ 2.34440166e-02]
 [ 2.13253252e-02]
 [-1.22756069e-02]
 [-3.93368895e-03]
 [ 7.68065440e-03]
 [-1.74545972e-02]
 [ 7.05726295e-04]
 [-6.02811661e-03]
 [ 3.50075742e-03]
 [ 6.60575210e-03]
 [ 3.54728752e-03]
 [-3.29449326e-03]
 [-1.41678494e-02]
 [ 6.63634881e-03]
 [-7.33502669e-03]
 [ 1.47997690e-02]
 [ 5.51656165e-03]
 [-2.67194436e-03]
 [-2.11797788e-03]
 [ 1.68041053e-04]
 [-8.97239308e-03]
 [-2.49772838e-02]
 [ 1.63807038e-02]
 [-9.30009617e-03]
 [-3.77294564e-02]
 [-2.23245490e-02]
 [ 3.90450871e-02]
 [ 3.11251217e-03]
 [ 7.69734886e-03]
 [ 4.85287758e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.32233152]
curr_Stock_Price:  100.97631589249114
curr_Factors:  [100.97631589]
mat_Sqrt:  [[0.15]]
grads:  [-0.29261949]
Stock Position:  -0.29261948530464443
Bond Position:  [52.8699691]


portfolio before change:  [23.38903112]
curr_Stock_Price:  100.77096235361097
curr_Factors:  [100.77096235]
mat_Sqrt:  [[0.15]]
grads:  [0.20504771]
Stock Position:  0.20504770921288498
Bond Position:  [2.72617614]


portfolio before change:  [23.45784735]
curr_Stock_Price:  101.10491113763311
curr_Factors:  [101.10491114]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476929]
Stock Position:  -0.024769290947694346
Bond Position:  [25.96214431]


portfolio before change:  [23.49120164]
curr_Stock_Price:  99.88934056260173
curr_Factors:  [99.88934056]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321139]
Stock Position:  -0.04321139397955482
Bond Position:  [27.80755929]


portfolio before change:  [23.48732476]
curr_Stock_Price:  100.05950504412696
curr_Factors:  [100.05950504]
mat_Sqrt:  [[0.15]]
grads:  [-0.05135042]
Stock Position:  -0.05135042124298758
Bond Position:  [28.62542249]


portfolio before change:  [23.50284246]
curr_Stock_Price:  99.82699866822956
curr_Factors:  [99.82699867]
mat_Sqrt:  [[0.15]]
grads:  [0.1879489]
Stock Position:  0.18794889911424925
Bond Position:  [4.74046796]


portfolio before change:  [23.4655461]
curr_Stock_Price:  99.6254068719774
curr_Factors:  [99.62540687]
mat_Sqrt:  [[0.15]]
grads:  [0.02390826]
Stock Position:  0.023908260230777894
Bond Position:  [21.08367595]


portfolio before change:  [23.46470066]
curr_Stock_Price:  99.47980575103239
curr_Factors:  [99.47980575]
mat_Sqrt:  [[0.15]]
grads:  [-0.00896275]
Stock Position:  -0.008962752710269728
Bond Position:  [24.35631355]


portfolio before change:  [23.47704832]
curr_Stock_Price:  98.44185089430376
curr_Factors:  [98.44185089]
mat_Sqrt:  [[0.15]]
grads:  [-0.12864288]
Stock Position:  -0.12864287859875254
Bond Position:  [36.14089139]


portfolio before change:  [23.5947707]
curr_Stock_Price:  97.56186060571659
curr_Factors:  [97.56186061]
mat_Sqrt:  [[0.15]]
grads:  [0.15629344]
Stock Position:  0.15629344375431634
Bond Position:  [8.34649152]


portfolio before change:  [23.57284894]
curr_Stock_Price:  97.41492462690809
curr_Factors:  [97.41492463]
mat_Sqrt:  [[0.15]]
grads:  [0.14216883]
Stock Position:  0.14216883434158145
Bond Position:  [9.72348266]


portfolio before change:  [23.72063521]
curr_Stock_Price:  98.44588724555379
curr_Factors:  [98.44588725]
mat_Sqrt:  [[0.15]]
grads:  [-0.08183738]
Stock Position:  -0.08183737960542138
Bond Position:  [31.77718865]


portfolio before change:  [23.7676165]
curr_Stock_Price:  97.92034626506903
curr_Factors:  [97.92034627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02622459]
Stock Position:  -0.02622459302013721
Bond Position:  [26.33553773]


portfolio before change:  [23.76642591]
curr_Stock_Price:  98.09128260477893
curr_Factors:  [98.0912826]
mat_Sqrt:  [[0.15]]
grads:  [0.05120436]
Stock Position:  0.051204362689297594
Bond Position:  [18.7437243]


portfolio before change:  [23.73191649]
curr_Stock_Price:  97.37156784144678
curr_Factors:  [97.37156784]
mat_Sqrt:  [[0.15]]
grads:  [-0.11636398]
Stock Position:  -0.11636398131630983
Bond Position:  [35.06245979]


portfolio before change:  [23.70759764]
curr_Stock_Price:  97.61822433643725
curr_Factors:  [97.61822434]
mat_Sqrt:  [[0.15]]
grads:  [0.00470484]
Stock Position:  0.004704841969427803
Bond Position:  [23.24831932]


portfolio before change:  [23.71375423]
curr_Stock_Price:  98.3090797987672
curr_Factors:  [98.3090798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018744]
Stock Position:  -0.0401874440363426
Bond Position:  [27.66454487]


portfolio before change:  [23.69615348]
curr_Stock_Price:  98.83310006507259
curr_Factors:  [98.83310007]
mat_Sqrt:  [[0.15]]
grads:  [0.02333838]
Stock Position:  0.023338382802687147
Bond Position:  [21.38954875]


portfolio before change:  [23.73475348]
curr_Stock_Price:  100.37245878388502
curr_Factors:  [100.37245878]
mat_Sqrt:  [[0.15]]
grads:  [0.04403835]
Stock Position:  0.044038347324317925
Bond Position:  [19.31451628]


portfolio before change:  [23.74584092]
curr_Stock_Price:  100.56940012039193
curr_Factors:  [100.56940012]
mat_Sqrt:  [[0.15]]
grads:  [0.02364858]
Stock Position:  0.023648583482573628
Bond Position:  [21.36751706]


portfolio before change:  [23.72222161]
curr_Stock_Price:  99.457688143988
curr_Factors:  [99.45768814]
mat_Sqrt:  [[0.15]]
grads:  [-0.02196329]
Stock Position:  -0.021963288416833617
Bond Position:  [25.9066395]


portfolio before change:  [23.75697576]
curr_Stock_Price:  98.02276551909453
curr_Factors:  [98.02276552]
mat_Sqrt:  [[0.15]]
grads:  [-0.09445233]
Stock Position:  -0.09445232936444971
Bond Position:  [33.01545429]


portfolio before change:  [23.7759824]
curr_Stock_Price:  97.86523150326084
curr_Factors:  [97.8652315]
mat_Sqrt:  [[0.15]]
grads:  [0.04424233]
Stock Position:  0.04424232538762839
Bond Position:  [19.44619699]


portfolio before change:  [23.78704156]
curr_Stock_Price:  98.06025345837077
curr_Factors:  [98.06025346]
mat_Sqrt:  [[0.15]]
grads:  [-0.04890018]
Stock Position:  -0.04890017795047233
Bond Position:  [28.5822054]


portfolio before change:  [23.76407665]
curr_Stock_Price:  98.60294897908595
curr_Factors:  [98.60294898]
mat_Sqrt:  [[0.15]]
grads:  [0.09866513]
Stock Position:  0.09866512691893214
Bond Position:  [14.03540417]


portfolio before change:  [23.69312281]
curr_Stock_Price:  97.86602834148418
curr_Factors:  [97.86602834]
mat_Sqrt:  [[0.15]]
grads:  [0.03677708]
Stock Position:  0.03677707766171473
Bond Position:  [20.09389629]


portfolio before change:  [23.72341681]
curr_Stock_Price:  98.62144725856305
curr_Factors:  [98.62144726]
mat_Sqrt:  [[0.15]]
grads:  [-0.01781296]
Stock Position:  -0.01781296236954769
Bond Position:  [25.48015694]


portfolio before change:  [23.70820069]
curr_Stock_Price:  99.65447786038233
curr_Factors:  [99.65447786]
mat_Sqrt:  [[0.15]]
grads:  [-0.01411985]
Stock Position:  -0.01411985254761285
Bond Position:  [25.11530723]


portfolio before change:  [23.71014673]
curr_Stock_Price:  99.73900958810705
curr_Factors:  [99.73900959]
mat_Sqrt:  [[0.15]]
grads:  [0.00112027]
Stock Position:  0.0011202736873308936
Bond Position:  [23.59841174]


portfolio before change:  [23.71365529]
curr_Stock_Price:  100.23761391204637
curr_Factors:  [100.23761391]
mat_Sqrt:  [[0.15]]
grads:  [-0.05981595]
Stock Position:  -0.05981595386697523
Bond Position:  [29.70946377]


portfolio before change:  [23.70642647]
curr_Stock_Price:  100.42055398636498
curr_Factors:  [100.42055399]
mat_Sqrt:  [[0.15]]
grads:  [-0.16651523]
Stock Position:  -0.1665152250560582
Bond Position:  [40.42797761]


portfolio before change:  [23.77743672]
curr_Stock_Price:  100.02445539980326
curr_Factors:  [100.0244554]
mat_Sqrt:  [[0.15]]
grads:  [0.10920469]
Stock Position:  0.10920469170201233
Bond Position:  [12.85429691]


portfolio before change:  [23.69865889]
curr_Stock_Price:  99.28836317479433
curr_Factors:  [99.28836317]
mat_Sqrt:  [[0.15]]
grads:  [-0.06200064]
Stock Position:  -0.06200064111566996
Bond Position:  [29.85460106]


portfolio before change:  [23.7048428]
curr_Stock_Price:  99.24881759229281
curr_Factors:  [99.24881759]
mat_Sqrt:  [[0.15]]
grads:  [-0.25152971]
Stock Position:  -0.25152970912830697
Bond Position:  [48.66886902]


portfolio before change:  [23.97966042]
curr_Stock_Price:  98.18042041929567
curr_Factors:  [98.18042042]
mat_Sqrt:  [[0.15]]
grads:  [-0.14883033]
Stock Position:  -0.148830326816569
Bond Position:  [38.59188447]


portfolio before change:  [23.94881256]
curr_Stock_Price:  98.42010373259943
curr_Factors:  [98.42010373]
mat_Sqrt:  [[0.15]]
grads:  [0.26030058]
Stock Position:  0.2603005806000868
Bond Position:  [-1.66999759]


portfolio before change:  [24.12927045]
curr_Stock_Price:  99.11417309482805
curr_Factors:  [99.11417309]
mat_Sqrt:  [[0.15]]
grads:  [0.02075008]
Stock Position:  0.020750081142583705
Bond Position:  [22.07264332]


portfolio before change:  [24.12781153]
curr_Stock_Price:  98.91088845878289
curr_Factors:  [98.91088846]
mat_Sqrt:  [[0.15]]
grads:  [0.05131566]
Stock Position:  0.051315659049891764
Bond Position:  [19.0521341]


portfolio before change:  [24.14079812]
curr_Stock_Price:  99.1175490266012
curr_Factors:  [99.11754903]
mat_Sqrt:  [[0.15]]
grads:  [0.03235252]
Stock Position:  0.032352517209338405
Bond Position:  [20.93409591]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.10217973]
Stock Price:  97.84298605375486
PL:  [24.10217973]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.30176071e-03]
 [ 2.18215436e-02]
 [-1.46974601e-02]
 [-8.16729094e-03]
 [-5.26978417e-03]
 [ 5.90131543e-02]
 [ 3.42260547e-03]
 [ 6.95358606e-03]
 [ 6.24609609e-02]
 [ 2.33020020e-02]
 [ 2.25121706e-02]
 [-5.30969033e-03]
 [-9.84332733e-03]
 [ 7.78802102e-03]
 [-1.49986040e-02]
 [ 7.04485175e-04]
 [-6.06080856e-03]
 [ 3.79949911e-03]
 [ 4.25115503e-03]
 [-9.40057954e-03]
 [-4.94147137e-03]
 [-1.03147882e-02]
 [ 7.06427715e-03]
 [-6.33347401e-03]
 [ 1.47047126e-02]
 [ 5.86685999e-03]
 [ 4.07692238e-03]
 [-3.02331742e-03]
 [-1.69920633e-02]
 [-1.21899501e-02]
 [ 3.89410992e-02]
 [ 9.98341422e-04]
 [-2.04065032e-02]
 [-3.14323263e-02]
 [-2.36068677e-02]
 [ 3.40748336e-02]
 [-7.90102109e-03]
 [-5.60798671e-03]
 [ 3.08328600e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.07869548]
curr_Stock_Price:  99.27284679253688
curr_Factors:  [99.27284679]
mat_Sqrt:  [[0.15]]
grads:  [-0.03534507]
Stock Position:  -0.03534507136941159
Bond Position:  [-10.56988963]


portfolio before change:  [-14.07060985]
curr_Stock_Price:  99.00670077942472
curr_Factors:  [99.00670078]
mat_Sqrt:  [[0.15]]
grads:  [0.14547696]
Stock Position:  0.1454769573819075
Bond Position:  [-28.47380344]


portfolio before change:  [-14.06071005]
curr_Stock_Price:  99.0992188487001
curr_Factors:  [99.09921885]
mat_Sqrt:  [[0.15]]
grads:  [-0.09798307]
Stock Position:  -0.09798306715490136
Bond Position:  [-4.35066464]


portfolio before change:  [-13.93345935]
curr_Stock_Price:  97.7949672854876
curr_Factors:  [97.79496729]
mat_Sqrt:  [[0.15]]
grads:  [-0.05444861]
Stock Position:  -0.05444860629633679
Bond Position:  [-8.60865968]


portfolio before change:  [-13.93885862]
curr_Stock_Price:  97.87436554398067
curr_Factors:  [97.87436554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03513189]
Stock Position:  -0.03513189449051369
Bond Position:  [-10.50034674]


portfolio before change:  [-13.88364438]
curr_Stock_Price:  96.26537540508586
curr_Factors:  [96.26537541]
mat_Sqrt:  [[0.15]]
grads:  [0.39342103]
Stock Position:  0.39342102897340914
Bond Position:  [-51.75646742]


portfolio before change:  [-13.91522957]
curr_Stock_Price:  96.20153735476704
curr_Factors:  [96.20153735]
mat_Sqrt:  [[0.15]]
grads:  [0.02281737]
Stock Position:  0.022817369816509954
Bond Position:  [-16.11029563]


portfolio before change:  [-13.9273037]
curr_Stock_Price:  95.76063572768673
curr_Factors:  [95.76063573]
mat_Sqrt:  [[0.15]]
grads:  [0.04635724]
Stock Position:  0.04635724041081929
Bond Position:  [-18.36650251]


portfolio before change:  [-13.92451841]
curr_Stock_Price:  95.87024633876013
curr_Factors:  [95.87024634]
mat_Sqrt:  [[0.15]]
grads:  [0.41640641]
Stock Position:  0.4164064058170815
Bond Position:  [-53.84550311]


portfolio before change:  [-14.19414294]
curr_Stock_Price:  95.23890776997614
curr_Factors:  [95.23890777]
mat_Sqrt:  [[0.15]]
grads:  [0.15534668]
Stock Position:  0.15534668021968953
Bond Position:  [-28.98919109]


portfolio before change:  [-14.34232745]
curr_Stock_Price:  94.3083398718176
curr_Factors:  [94.30833987]
mat_Sqrt:  [[0.15]]
grads:  [0.15008114]
Stock Position:  0.15008113727736283
Bond Position:  [-28.49623035]


portfolio before change:  [-14.03919301]
curr_Stock_Price:  96.35187909536505
curr_Factors:  [96.3518791]
mat_Sqrt:  [[0.15]]
grads:  [-0.03539794]
Stock Position:  -0.035397935558273134
Bond Position:  [-10.62853541]


portfolio before change:  [-14.07737428]
curr_Stock_Price:  97.3929740951153
curr_Factors:  [97.3929741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06562218]
Stock Position:  -0.06562218221289198
Bond Position:  [-7.68623478]


portfolio before change:  [-14.12134931]
curr_Stock_Price:  98.04845660847926
curr_Factors:  [98.04845661]
mat_Sqrt:  [[0.15]]
grads:  [0.05192014]
Stock Position:  0.051920140157869527
Bond Position:  [-19.21203892]


portfolio before change:  [-14.11292096]
curr_Stock_Price:  98.25704634030825
curr_Factors:  [98.25704634]
mat_Sqrt:  [[0.15]]
grads:  [-0.09999069]
Stock Position:  -0.09999069325555575
Bond Position:  [-4.28813078]


portfolio before change:  [-14.09562489]
curr_Stock_Price:  98.07870861004044
curr_Factors:  [98.07870861]
mat_Sqrt:  [[0.15]]
grads:  [0.00469657]
Stock Position:  0.004696567830924642
Bond Position:  [-14.5562582]


portfolio before change:  [-14.09313458]
curr_Stock_Price:  98.99639182825476
curr_Factors:  [98.99639183]
mat_Sqrt:  [[0.15]]
grads:  [-0.04040539]
Stock Position:  -0.040405390423065124
Bond Position:  [-10.09314671]


portfolio before change:  [-14.09424916]
curr_Stock_Price:  98.99275018346624
curr_Factors:  [98.99275018]
mat_Sqrt:  [[0.15]]
grads:  [0.02532999]
Stock Position:  0.02532999405935118
Bond Position:  [-16.60173493]


portfolio before change:  [-14.11835525]
curr_Stock_Price:  98.12300088040756
curr_Factors:  [98.12300088]
mat_Sqrt:  [[0.15]]
grads:  [0.02834103]
Stock Position:  0.028341033526184275
Bond Position:  [-16.89926251]


portfolio before change:  [-14.17217266]
curr_Stock_Price:  96.29861872535082
curr_Factors:  [96.29861873]
mat_Sqrt:  [[0.15]]
grads:  [-0.06267053]
Stock Position:  -0.06267053024019709
Bond Position:  [-8.13708717]


portfolio before change:  [-14.26676309]
curr_Stock_Price:  97.79171648668387
curr_Factors:  [97.79171649]
mat_Sqrt:  [[0.15]]
grads:  [-0.03294314]
Stock Position:  -0.03294314249957256
Bond Position:  [-11.04519664]


portfolio before change:  [-14.30207852]
curr_Stock_Price:  98.82181539269574
curr_Factors:  [98.82181539]
mat_Sqrt:  [[0.15]]
grads:  [-0.06876525]
Stock Position:  -0.0687652543766308
Bond Position:  [-7.50657125]


portfolio before change:  [-14.36370945]
curr_Stock_Price:  99.70442019558007
curr_Factors:  [99.7044202]
mat_Sqrt:  [[0.15]]
grads:  [0.04709518]
Stock Position:  0.04709518098386551
Bond Position:  [-19.05930716]


portfolio before change:  [-14.38916986]
curr_Stock_Price:  99.2143944387951
curr_Factors:  [99.21439444]
mat_Sqrt:  [[0.15]]
grads:  [-0.04222316]
Stock Position:  -0.04222316008040845
Bond Position:  [-10.2000246]


portfolio before change:  [-14.3620267]
curr_Stock_Price:  98.54134564710785
curr_Factors:  [98.54134565]
mat_Sqrt:  [[0.15]]
grads:  [0.09803142]
Stock Position:  0.09803141717410603
Bond Position:  [-24.02217446]


portfolio before change:  [-14.41677612]
curr_Stock_Price:  98.01348974811852
curr_Factors:  [98.01348975]
mat_Sqrt:  [[0.15]]
grads:  [0.0391124]
Stock Position:  0.03911239996069376
Bond Position:  [-18.25031893]


portfolio before change:  [-14.42011765]
curr_Stock_Price:  97.98638577336267
curr_Factors:  [97.98638577]
mat_Sqrt:  [[0.15]]
grads:  [0.02717948]
Stock Position:  0.027179482515852674
Bond Position:  [-17.08333691]


portfolio before change:  [-14.41199532]
curr_Stock_Price:  98.36379833694639
curr_Factors:  [98.36379834]
mat_Sqrt:  [[0.15]]
grads:  [-0.02015545]
Stock Position:  -0.020155449469567637
Bond Position:  [-12.42942876]


portfolio before change:  [-14.38987063]
curr_Stock_Price:  97.18900574842287
curr_Factors:  [97.18900575]
mat_Sqrt:  [[0.15]]
grads:  [-0.11328042]
Stock Position:  -0.11328042186256201
Bond Position:  [-3.38025906]


portfolio before change:  [-14.33299864]
curr_Stock_Price:  96.68322954004479
curr_Factors:  [96.68322954]
mat_Sqrt:  [[0.15]]
grads:  [-0.08126633]
Stock Position:  -0.08126633397569637
Bond Position:  [-6.47590702]


portfolio before change:  [-14.32085483]
curr_Stock_Price:  96.52383567754765
curr_Factors:  [96.52383568]
mat_Sqrt:  [[0.15]]
grads:  [0.25960733]
Stock Position:  0.25960732798352615
Bond Position:  [-39.37914989]


portfolio before change:  [-14.65161163]
curr_Stock_Price:  95.26873204678733
curr_Factors:  [95.26873205]
mat_Sqrt:  [[0.15]]
grads:  [0.00665561]
Stock Position:  0.006655609478081788
Bond Position:  [-15.28568311]


portfolio before change:  [-14.65632719]
curr_Stock_Price:  94.84732346519114
curr_Factors:  [94.84732347]
mat_Sqrt:  [[0.15]]
grads:  [-0.13604335]
Stock Position:  -0.13604335453686292
Bond Position:  [-1.75297914]


portfolio before change:  [-14.70849908]
curr_Stock_Price:  95.22920724567525
curr_Factors:  [95.22920725]
mat_Sqrt:  [[0.15]]
grads:  [-0.20954884]
Stock Position:  -0.20954884231733956
Bond Position:  [5.24667106]


portfolio before change:  [-14.57585845]
curr_Stock_Price:  94.5993552749895
curr_Factors:  [94.59935527]
mat_Sqrt:  [[0.15]]
grads:  [-0.15737912]
Stock Position:  -0.1573791178884175
Bond Position:  [0.31210464]


portfolio before change:  [-14.52493596]
curr_Stock_Price:  94.2760374278178
curr_Factors:  [94.27603743]
mat_Sqrt:  [[0.15]]
grads:  [0.22716556]
Stock Position:  0.2271655571631107
Bond Position:  [-35.94120453]


portfolio before change:  [-14.57895759]
curr_Stock_Price:  94.05800834218984
curr_Factors:  [94.05800834]
mat_Sqrt:  [[0.15]]
grads:  [-0.05267347]
Stock Position:  -0.05267347392781188
Bond Position:  [-9.62459554]


portfolio before change:  [-14.5926412]
curr_Stock_Price:  94.29494855665887
curr_Factors:  [94.29494856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03738658]
Stock Position:  -0.03738657803349386
Bond Position:  [-11.06727575]


portfolio before change:  [-14.58327503]
curr_Stock_Price:  94.0074211048677
curr_Factors:  [94.0074211]
mat_Sqrt:  [[0.15]]
grads:  [0.2055524]
Stock Position:  0.20555240027906874
Bond Position:  [-33.90672608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.62220134]
Stock Price:  93.8386675100409
PL:  [-14.62220134]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.19536058e-02]
 [ 4.19286154e-02]
 [-3.55736247e-03]
 [-2.18173042e-03]
 [-6.87125107e-03]
 [ 3.16705947e-02]
 [ 3.68204801e-03]
 [-1.73703682e-03]
 [-1.81145460e-02]
 [ 2.34417862e-02]
 [ 2.09955282e-02]
 [-9.80062347e-03]
 [-4.25850961e-03]
 [ 8.30632013e-03]
 [-1.15015874e-02]
 [-1.15569172e-03]
 [-6.12509092e-03]
 [ 5.22630541e-03]
 [ 6.00900553e-03]
 [-4.88044295e-03]
 [-5.01458083e-03]
 [-5.72862646e-03]
 [ 4.08042498e-03]
 [-1.16142581e-02]
 [ 4.96089027e-03]
 [ 5.09565518e-03]
 [-5.90603961e-03]
 [-1.73098971e-03]
 [ 1.48202343e-03]
 [-6.61028000e-03]
 [-2.53030881e-02]
 [ 1.52468320e-02]
 [-9.08927471e-03]
 [-1.75784820e-02]
 [-2.04635753e-02]
 [ 2.43602051e-02]
 [ 4.79242823e-03]
 [ 1.49219518e-02]
 [ 9.96667809e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.70372178]
curr_Stock_Price:  100.90259461021948
curr_Factors:  [100.90259461]
mat_Sqrt:  [[0.15]]
grads:  [-0.27969071]
Stock Position:  -0.27969070539853386
Bond Position:  [49.92523965]


portfolio before change:  [21.94935511]
curr_Stock_Price:  100.04667670053311
curr_Factors:  [100.0466767]
mat_Sqrt:  [[0.15]]
grads:  [0.2795241]
Stock Position:  0.2795241025220691
Bond Position:  [-6.0161024]


portfolio before change:  [22.11490444]
curr_Stock_Price:  100.64162140057549
curr_Factors:  [100.6416214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02371575]
Stock Position:  -0.023715749809101946
Bond Position:  [24.50169595]


portfolio before change:  [22.11360783]
curr_Stock_Price:  100.82544467216053
curr_Factors:  [100.82544467]
mat_Sqrt:  [[0.15]]
grads:  [-0.01454487]
Stock Position:  -0.01454486948365143
Bond Position:  [23.58010077]


portfolio before change:  [22.12187647]
curr_Stock_Price:  100.45961538587322
curr_Factors:  [100.45961539]
mat_Sqrt:  [[0.15]]
grads:  [-0.04580834]
Stock Position:  -0.04580834048686997
Bond Position:  [26.72376473]


portfolio before change:  [22.12641671]
curr_Stock_Price:  100.43342884462773
curr_Factors:  [100.43342884]
mat_Sqrt:  [[0.15]]
grads:  [0.2111373]
Stock Position:  0.2111372980235587
Bond Position:  [0.92117391]


portfolio before change:  [22.08174794]
curr_Stock_Price:  100.2213207770227
curr_Factors:  [100.22132078]
mat_Sqrt:  [[0.15]]
grads:  [0.02454699]
Stock Position:  0.024546986713046837
Bond Position:  [19.62161651]


portfolio before change:  [22.03194558]
curr_Stock_Price:  98.09253771227559
curr_Factors:  [98.09253771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01158025]
Stock Position:  -0.011580245445135199
Bond Position:  [23.16788125]


portfolio before change:  [22.03198396]
curr_Stock_Price:  98.3393195088035
curr_Factors:  [98.33931951]
mat_Sqrt:  [[0.15]]
grads:  [-0.12076364]
Stock Position:  -0.12076363993148242
Bond Position:  [33.90779813]


portfolio before change:  [22.04455124]
curr_Stock_Price:  98.27035382676328
curr_Factors:  [98.27035383]
mat_Sqrt:  [[0.15]]
grads:  [0.15627857]
Stock Position:  0.15627857470868067
Bond Position:  [6.68700041]


portfolio before change:  [22.03753399]
curr_Stock_Price:  98.2201026479175
curr_Factors:  [98.22010265]
mat_Sqrt:  [[0.15]]
grads:  [0.13997019]
Stock Position:  0.13997018798929883
Bond Position:  [8.28964776]


portfolio before change:  [21.97597295]
curr_Stock_Price:  97.77288380849906
curr_Factors:  [97.77288381]
mat_Sqrt:  [[0.15]]
grads:  [-0.06533749]
Stock Position:  -0.0653374897866258
Bond Position:  [28.36420775]


portfolio before change:  [21.971817]
curr_Stock_Price:  97.89075946436142
curr_Factors:  [97.89075946]
mat_Sqrt:  [[0.15]]
grads:  [-0.02839006]
Stock Position:  -0.02839006405321545
Bond Position:  [24.75094193]


portfolio before change:  [21.97266653]
curr_Stock_Price:  97.96982005211561
curr_Factors:  [97.96982005]
mat_Sqrt:  [[0.15]]
grads:  [0.05537547]
Stock Position:  0.055375467508653776
Bond Position:  [16.54754194]


portfolio before change:  [22.02179455]
curr_Stock_Price:  98.81964494433637
curr_Factors:  [98.81964494]
mat_Sqrt:  [[0.15]]
grads:  [-0.07667725]
Stock Position:  -0.07667724931120747
Bond Position:  [29.5990131]


portfolio before change:  [21.99994941]
curr_Stock_Price:  99.15279779121501
curr_Factors:  [99.15279779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00770461]
Stock Position:  -0.007704611448869966
Bond Position:  [22.7638832]


portfolio before change:  [22.00052008]
curr_Stock_Price:  99.44807497900483
curr_Factors:  [99.44807498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04083394]
Stock Position:  -0.040833939460463875
Bond Position:  [26.06137676]


portfolio before change:  [21.98010372]
curr_Stock_Price:  100.02784363383108
curr_Factors:  [100.02784363]
mat_Sqrt:  [[0.15]]
grads:  [0.03484204]
Stock Position:  0.034842036068777754
Bond Position:  [18.49492998]


portfolio before change:  [21.96303009]
curr_Stock_Price:  99.47145704518982
curr_Factors:  [99.47145705]
mat_Sqrt:  [[0.15]]
grads:  [0.04006004]
Stock Position:  0.04006003683771684
Bond Position:  [17.97819986]


portfolio before change:  [21.99196569]
curr_Stock_Price:  100.137661780813
curr_Factors:  [100.13766178]
mat_Sqrt:  [[0.15]]
grads:  [-0.03253629]
Stock Position:  -0.0325362863624043
Bond Position:  [25.25007333]


portfolio before change:  [21.98318425]
curr_Stock_Price:  100.50457202405006
curr_Factors:  [100.50457202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03343054]
Stock Position:  -0.03343053888553267
Bond Position:  [25.34310625]


portfolio before change:  [21.94064497]
curr_Stock_Price:  101.87180604553562
curr_Factors:  [101.87180605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03819084]
Stock Position:  -0.03819084303865731
Bond Position:  [25.83121512]


portfolio before change:  [21.93000224]
curr_Stock_Price:  102.23503005382591
curr_Factors:  [102.23503005]
mat_Sqrt:  [[0.15]]
grads:  [0.02720283]
Stock Position:  0.027202833230338255
Bond Position:  [19.14891977]


portfolio before change:  [21.91344149]
curr_Stock_Price:  101.53824567689274
curr_Factors:  [101.53824568]
mat_Sqrt:  [[0.15]]
grads:  [-0.07742839]
Stock Position:  -0.07742838743392554
Bond Position:  [29.77538412]


portfolio before change:  [21.92787369]
curr_Stock_Price:  101.3999238131106
curr_Factors:  [101.39992381]
mat_Sqrt:  [[0.15]]
grads:  [0.0330726]
Stock Position:  0.03307260182405056
Bond Position:  [18.57431438]


portfolio before change:  [21.92590426]
curr_Stock_Price:  101.27016802684746
curr_Factors:  [101.27016803]
mat_Sqrt:  [[0.15]]
grads:  [0.03397103]
Stock Position:  0.03397103450802109
Bond Position:  [18.48565189]


portfolio before change:  [21.88394554]
curr_Stock_Price:  99.96701147261396
curr_Factors:  [99.96701147]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393736]
Stock Position:  -0.03937359737931442
Bond Position:  [25.8200064]


portfolio before change:  [21.87573239]
curr_Stock_Price:  100.25758301224008
curr_Factors:  [100.25758301]
mat_Sqrt:  [[0.15]]
grads:  [-0.01153993]
Stock Position:  -0.011539931429817052
Bond Position:  [23.03269803]


portfolio before change:  [21.86569314]
curr_Stock_Price:  101.37704537039637
curr_Factors:  [101.37704537]
mat_Sqrt:  [[0.15]]
grads:  [0.00988016]
Stock Position:  0.009880156210344887
Bond Position:  [20.8640721]


portfolio before change:  [21.86685951]
curr_Stock_Price:  101.23111582644971
curr_Factors:  [101.23111583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04406853]
Stock Position:  -0.04406853334345887
Bond Position:  [26.32796631]


portfolio before change:  [21.86537706]
curr_Stock_Price:  101.33943902205272
curr_Factors:  [101.33943902]
mat_Sqrt:  [[0.15]]
grads:  [-0.16868725]
Stock Position:  -0.1686872540679286
Bond Position:  [38.96004876]


portfolio before change:  [22.13714491]
curr_Stock_Price:  99.75723570357648
curr_Factors:  [99.7572357]
mat_Sqrt:  [[0.15]]
grads:  [0.10164555]
Stock Position:  0.10164554675582359
Bond Position:  [11.99726614]


portfolio before change:  [22.11319974]
curr_Stock_Price:  99.50690578980787
curr_Factors:  [99.50690579]
mat_Sqrt:  [[0.15]]
grads:  [-0.06059516]
Stock Position:  -0.06059516474659208
Bond Position:  [28.14283709]


portfolio before change:  [22.02515684]
curr_Stock_Price:  101.017933457919
curr_Factors:  [101.01793346]
mat_Sqrt:  [[0.15]]
grads:  [-0.11718988]
Stock Position:  -0.11718988019490297
Bond Position:  [33.86343636]


portfolio before change:  [21.92699322]
curr_Stock_Price:  101.89170189197813
curr_Factors:  [101.89170189]
mat_Sqrt:  [[0.15]]
grads:  [-0.13642384]
Stock Position:  -0.1364238354487551
Bond Position:  [35.82744999]


portfolio before change:  [21.95487158]
curr_Stock_Price:  101.72018013607347
curr_Factors:  [101.72018014]
mat_Sqrt:  [[0.15]]
grads:  [0.16240137]
Stock Position:  0.16240136712820974
Bond Position:  [5.43537527]


portfolio before change:  [21.87194017]
curr_Stock_Price:  101.20533918455061
curr_Factors:  [101.20533918]
mat_Sqrt:  [[0.15]]
grads:  [0.03194952]
Stock Position:  0.03194952156142925
Bond Position:  [18.63847801]


portfolio before change:  [21.89033098]
curr_Stock_Price:  101.7080337951875
curr_Factors:  [101.7080338]
mat_Sqrt:  [[0.15]]
grads:  [0.09947968]
Stock Position:  0.09947967863648875
Bond Position:  [11.77244847]


portfolio before change:  [21.99097694]
curr_Stock_Price:  102.70496416492827
curr_Factors:  [102.70496416]
mat_Sqrt:  [[0.15]]
grads:  [0.06644452]
Stock Position:  0.06644452059421097
Bond Position:  [15.16679484]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.07256044]
Stock Price:  103.90427336083764
PL:  [18.16828707]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.03512847e-02]
 [ 4.40304725e-02]
 [-3.55115986e-03]
 [-3.35100474e-03]
 [-3.98818826e-03]
 [ 3.04158303e-02]
 [ 3.54434319e-03]
 [-1.39489584e-03]
 [-2.39318205e-02]
 [ 2.34055967e-02]
 [ 1.91762586e-02]
 [-1.50623968e-02]
 [ 9.40029235e-03]
 [ 6.26852581e-03]
 [-9.68876667e-03]
 [-1.24579374e-03]
 [-6.06221648e-03]
 [ 1.34147225e-03]
 [ 3.32950436e-03]
 [-3.03638928e-02]
 [-8.92379391e-03]
 [-2.09879913e-02]
 [ 5.67878313e-03]
 [-9.54795331e-03]
 [ 1.34731638e-02]
 [ 5.36161386e-03]
 [ 3.23508712e-03]
 [-3.61366756e-03]
 [-9.73345404e-03]
 [-1.46195014e-02]
 [-1.82015035e-02]
 [ 1.58351434e-02]
 [-9.29877420e-03]
 [-2.61537956e-02]
 [-2.14071151e-02]
 [ 2.62941340e-02]
 [ 5.15234550e-03]
 [ 1.83533056e-02]
 [ 9.07266605e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.39824404]
curr_Stock_Price:  100.84313525368962
curr_Factors:  [100.84313525]
mat_Sqrt:  [[0.15]]
grads:  [-0.26900856]
Stock Position:  -0.2690085643750688
Bond Position:  [47.52591108]


portfolio before change:  [20.5184878]
curr_Stock_Price:  100.4182318679555
curr_Factors:  [100.41823187]
mat_Sqrt:  [[0.15]]
grads:  [0.29353648]
Stock Position:  0.2935364836405217
Bond Position:  [-8.95792688]


portfolio before change:  [20.56201375]
curr_Stock_Price:  100.57032799700399
curr_Factors:  [100.570328]
mat_Sqrt:  [[0.15]]
grads:  [-0.0236744]
Stock Position:  -0.02367439906735792
Bond Position:  [22.94295583]


portfolio before change:  [20.56877127]
curr_Stock_Price:  100.40603788850683
curr_Factors:  [100.40603789]
mat_Sqrt:  [[0.15]]
grads:  [-0.02234003]
Stock Position:  -0.022340031591355825
Bond Position:  [22.81184533]


portfolio before change:  [20.56058252]
curr_Stock_Price:  100.90023615323935
curr_Factors:  [100.90023615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02658792]
Stock Position:  -0.026587921762788604
Bond Position:  [23.24331011]


portfolio before change:  [20.58303623]
curr_Stock_Price:  100.16501079263274
curr_Factors:  [100.16501079]
mat_Sqrt:  [[0.15]]
grads:  [0.2027722]
Stock Position:  0.2027722016998956
Bond Position:  [0.27235646]


portfolio before change:  [20.38643079]
curr_Stock_Price:  99.19525516498562
curr_Factors:  [99.19525516]
mat_Sqrt:  [[0.15]]
grads:  [0.02362895]
Stock Position:  0.023628954612828258
Bond Position:  [18.04255061]


portfolio before change:  [20.38985379]
curr_Stock_Price:  99.24466628520554
curr_Factors:  [99.24466629]
mat_Sqrt:  [[0.15]]
grads:  [-0.00929931]
Stock Position:  -0.009299305573446461
Bond Position:  [21.31276027]


portfolio before change:  [20.39640538]
curr_Stock_Price:  98.82664205309976
curr_Factors:  [98.82664205]
mat_Sqrt:  [[0.15]]
grads:  [-0.15954547]
Stock Position:  -0.1595454702797106
Bond Position:  [36.16374847]


portfolio before change:  [20.2758121]
curr_Stock_Price:  99.61083248948273
curr_Factors:  [99.61083249]
mat_Sqrt:  [[0.15]]
grads:  [0.15603731]
Stock Position:  0.15603731131413467
Bond Position:  [4.73280562]


portfolio before change:  [20.37107814]
curr_Stock_Price:  100.21757451473816
curr_Factors:  [100.21757451]
mat_Sqrt:  [[0.15]]
grads:  [0.12784172]
Stock Position:  0.12784172401415803
Bond Position:  [7.55909063]


portfolio before change:  [20.31666011]
curr_Stock_Price:  99.78451583012145
curr_Factors:  [99.78451583]
mat_Sqrt:  [[0.15]]
grads:  [-0.10041598]
Stock Position:  -0.1004159784538152
Bond Position:  [30.3366199]


portfolio before change:  [20.40938895]
curr_Stock_Price:  98.89883486099656
curr_Factors:  [98.89883486]
mat_Sqrt:  [[0.15]]
grads:  [0.06266862]
Stock Position:  0.06266861563585134
Bond Position:  [14.21153588]


portfolio before change:  [20.40439083]
curr_Stock_Price:  98.7907318208211
curr_Factors:  [98.79073182]
mat_Sqrt:  [[0.15]]
grads:  [0.04179017]
Stock Position:  0.04179017206032268
Bond Position:  [16.27590915]


portfolio before change:  [20.42172205]
curr_Stock_Price:  99.1567653277042
curr_Factors:  [99.15676533]
mat_Sqrt:  [[0.15]]
grads:  [-0.06459178]
Stock Position:  -0.06459177779487277
Bond Position:  [26.8264338]


portfolio before change:  [20.42308527]
curr_Stock_Price:  99.18757883692152
curr_Factors:  [99.18757884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00830529]
Stock Position:  -0.008305291612991067
Bond Position:  [21.24686703]


portfolio before change:  [20.4364865]
curr_Stock_Price:  97.89380007743353
curr_Factors:  [97.89380008]
mat_Sqrt:  [[0.15]]
grads:  [-0.04041478]
Stock Position:  -0.04041477654838821
Bond Position:  [24.39284256]


portfolio before change:  [20.45568742]
curr_Stock_Price:  97.49415362129352
curr_Factors:  [97.49415362]
mat_Sqrt:  [[0.15]]
grads:  [0.00894315]
Stock Position:  0.008943148324801267
Bond Position:  [19.58378274]


portfolio before change:  [20.46120924]
curr_Stock_Price:  97.83784583246823
curr_Factors:  [97.83784583]
mat_Sqrt:  [[0.15]]
grads:  [0.0221967]
Stock Position:  0.022196695764622108
Bond Position:  [18.28953234]


portfolio before change:  [20.47040475]
curr_Stock_Price:  98.14911649322416
curr_Factors:  [98.14911649]
mat_Sqrt:  [[0.15]]
grads:  [-0.20242595]
Stock Position:  -0.2024259518986128
Bond Position:  [40.33833308]


portfolio before change:  [20.74844385]
curr_Stock_Price:  96.80049249642919
curr_Factors:  [96.8004925]
mat_Sqrt:  [[0.15]]
grads:  [-0.05949196]
Stock Position:  -0.0594919593887974
Bond Position:  [26.50729482]


portfolio before change:  [20.7992845]
curr_Stock_Price:  96.0016109972355
curr_Factors:  [96.001611]
mat_Sqrt:  [[0.15]]
grads:  [-0.13991994]
Stock Position:  -0.13991994200796593
Bond Position:  [34.23182434]


portfolio before change:  [20.72210568]
curr_Stock_Price:  96.58378721803734
curr_Factors:  [96.58378722]
mat_Sqrt:  [[0.15]]
grads:  [0.03785855]
Stock Position:  0.03785855421226613
Bond Position:  [17.06558314]


portfolio before change:  [20.73810377]
curr_Stock_Price:  96.9500124531564
curr_Factors:  [96.95001245]
mat_Sqrt:  [[0.15]]
grads:  [-0.06365302]
Stock Position:  -0.0636530220509884
Bond Position:  [26.90926505]


portfolio before change:  [20.69097792]
curr_Stock_Price:  97.74321462856949
curr_Factors:  [97.74321463]
mat_Sqrt:  [[0.15]]
grads:  [0.08982109]
Stock Position:  0.08982109172814112
Bond Position:  [11.91157567]


portfolio before change:  [20.69763949]
curr_Stock_Price:  97.80080160039536
curr_Factors:  [97.8008016]
mat_Sqrt:  [[0.15]]
grads:  [0.03574409]
Stock Position:  0.03574409237809947
Bond Position:  [17.2018386]


portfolio before change:  [20.70929095]
curr_Stock_Price:  98.06661053524853
curr_Factors:  [98.06661054]
mat_Sqrt:  [[0.15]]
grads:  [0.02156725]
Stock Position:  0.02156724749190441
Bond Position:  [18.59426409]


portfolio before change:  [20.70260941]
curr_Stock_Price:  97.64903445998314
curr_Factors:  [97.64903446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02409112]
Stock Position:  -0.02409111705210234
Bond Position:  [23.05508373]


portfolio before change:  [20.69149435]
curr_Stock_Price:  98.23004208572402
curr_Factors:  [98.23004209]
mat_Sqrt:  [[0.15]]
grads:  [-0.06488969]
Stock Position:  -0.06488969358380187
Bond Position:  [27.06561169]


portfolio before change:  [20.66762974]
curr_Stock_Price:  98.64995505514098
curr_Factors:  [98.64995506]
mat_Sqrt:  [[0.15]]
grads:  [-0.09746334]
Stock Position:  -0.09746334271468904
Bond Position:  [30.28238412]


portfolio before change:  [20.5383993]
curr_Stock_Price:  100.0147346318998
curr_Factors:  [100.01473463]
mat_Sqrt:  [[0.15]]
grads:  [-0.12134336]
Stock Position:  -0.12134335683201596
Bond Position:  [32.67452293]


portfolio before change:  [20.55674484]
curr_Stock_Price:  99.89720884663394
curr_Factors:  [99.89720885]
mat_Sqrt:  [[0.15]]
grads:  [0.10556762]
Stock Position:  0.10556762252584447
Bond Position:  [10.01083401]


portfolio before change:  [20.49513255]
curr_Stock_Price:  99.30172588395924
curr_Factors:  [99.30172588]
mat_Sqrt:  [[0.15]]
grads:  [-0.06199183]
Stock Position:  -0.061991827975979436
Bond Position:  [26.65102806]


portfolio before change:  [20.4654959]
curr_Stock_Price:  99.83354181465171
curr_Factors:  [99.83354181]
mat_Sqrt:  [[0.15]]
grads:  [-0.17435864]
Stock Position:  -0.1743586371014419
Bond Position:  [37.87233619]


portfolio before change:  [20.40820325]
curr_Stock_Price:  100.18928549886277
curr_Factors:  [100.1892855]
mat_Sqrt:  [[0.15]]
grads:  [-0.1427141]
Stock Position:  -0.1427141008693709
Bond Position:  [34.70662705]


portfolio before change:  [20.3511102]
curr_Stock_Price:  100.61973805624842
curr_Factors:  [100.61973806]
mat_Sqrt:  [[0.15]]
grads:  [0.17529423]
Stock Position:  0.1752942269625997
Bond Position:  [2.713051]


portfolio before change:  [20.52519179]
curr_Stock_Price:  101.61088555897872
curr_Factors:  [101.61088556]
mat_Sqrt:  [[0.15]]
grads:  [0.03434897]
Stock Position:  0.0343489699979891
Bond Position:  [17.03496253]


portfolio before change:  [20.55872424]
curr_Stock_Price:  102.52511810190425
curr_Factors:  [102.5251181]
mat_Sqrt:  [[0.15]]
grads:  [0.12235537]
Stock Position:  0.12235537059756432
Bond Position:  [8.01422542]


portfolio before change:  [20.47007954]
curr_Stock_Price:  101.79244457600534
curr_Factors:  [101.79244458]
mat_Sqrt:  [[0.15]]
grads:  [0.06048444]
Stock Position:  0.060484440346207924
Bond Position:  [14.3132205]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.47186663]
Stock Price:  101.79240854681971
PL:  [18.67945808]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.02653603e-03]
 [-8.98162255e-03]
 [-1.27365798e-02]
 [-1.12675586e-02]
 [-1.46154124e-03]
 [ 6.53908694e-02]
 [ 3.15391387e-03]
 [ 9.77011758e-03]
 [ 7.66837657e-02]
 [ 2.34455694e-02]
 [ 2.12154722e-02]
 [-9.89918579e-03]
 [-1.16213627e-03]
 [ 9.86174493e-03]
 [-1.43911794e-02]
 [ 3.20575935e-05]
 [-6.07012174e-03]
 [ 2.37362230e-03]
 [ 9.80422474e-04]
 [-3.52410436e-03]
 [-1.21066962e-02]
 [-2.12826949e-02]
 [ 6.37002871e-03]
 [-8.85437830e-03]
 [ 1.20757390e-02]
 [ 2.59498116e-04]
 [ 2.31146236e-02]
 [-4.27044303e-03]
 [-2.87701959e-02]
 [-9.99301806e-03]
 [ 4.31154595e-02]
 [ 4.30047489e-03]
 [-1.97871408e-02]
 [-3.23475764e-02]
 [-2.32194004e-02]
 [ 3.63857502e-02]
 [-5.13420985e-03]
 [-2.26034384e-03]
 [ 1.63990087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.00581741]
curr_Stock_Price:  99.64053451231565
curr_Factors:  [99.64053451]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351024]
Stock Position:  -0.03351024020497056
Bond Position:  [-2.66683917]


portfolio before change:  [-5.9389275]
curr_Stock_Price:  97.63448246390267
curr_Factors:  [97.63448246]
mat_Sqrt:  [[0.15]]
grads:  [-0.05987748]
Stock Position:  -0.05987748367851871
Bond Position:  [-0.09282037]


portfolio before change:  [-5.86742686]
curr_Stock_Price:  96.44017301747438
curr_Factors:  [96.44017302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08491053]
Stock Position:  -0.08491053196103499
Bond Position:  [2.32135953]


portfolio before change:  [-5.77720079]
curr_Stock_Price:  95.38098893635984
curr_Factors:  [95.38098894]
mat_Sqrt:  [[0.15]]
grads:  [-0.07511706]
Stock Position:  -0.07511705704948475
Bond Position:  [1.3875384]


portfolio before change:  [-5.78138539]
curr_Stock_Price:  95.43900570859587
curr_Factors:  [95.43900571]
mat_Sqrt:  [[0.15]]
grads:  [-0.00974361]
Stock Position:  -0.009743608276890024
Bond Position:  [-4.8514651]


portfolio before change:  [-5.78309812]
curr_Stock_Price:  95.55254276254536
curr_Factors:  [95.55254276]
mat_Sqrt:  [[0.15]]
grads:  [0.43593913]
Stock Position:  0.43593912932563356
Bond Position:  [-47.43819042]


portfolio before change:  [-5.99875374]
curr_Stock_Price:  95.07145386873476
curr_Factors:  [95.07145387]
mat_Sqrt:  [[0.15]]
grads:  [0.02102609]
Stock Position:  0.02102609248892122
Bond Position:  [-7.99773492]


portfolio before change:  [-6.00228623]
curr_Stock_Price:  94.95099827529192
curr_Factors:  [94.95099828]
mat_Sqrt:  [[0.15]]
grads:  [0.06513412]
Stock Position:  0.06513411716745908
Bond Position:  [-12.18683567]


portfolio before change:  [-5.97081584]
curr_Stock_Price:  95.45755061233693
curr_Factors:  [95.45755061]
mat_Sqrt:  [[0.15]]
grads:  [0.5112251]
Stock Position:  0.5112251045087826
Bond Position:  [-54.77111212]


portfolio before change:  [-5.34716158]
curr_Stock_Price:  96.69086460375662
curr_Factors:  [96.6908646]
mat_Sqrt:  [[0.15]]
grads:  [0.1563038]
Stock Position:  0.156303796164891
Bond Position:  [-20.46031077]


portfolio before change:  [-5.19160208]
curr_Stock_Price:  97.70246640230712
curr_Factors:  [97.7024664]
mat_Sqrt:  [[0.15]]
grads:  [0.14143648]
Stock Position:  0.1414364810298228
Bond Position:  [-19.01029511]


portfolio before change:  [-5.18022824]
curr_Stock_Price:  97.79968511084644
curr_Factors:  [97.79968511]
mat_Sqrt:  [[0.15]]
grads:  [-0.06599457]
Stock Position:  -0.06599457192229381
Bond Position:  [1.27402011]


portfolio before change:  [-5.20469237]
curr_Stock_Price:  98.17279750403067
curr_Factors:  [98.1727975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00774758]
Stock Position:  -0.0077475751553581
Bond Position:  [-4.44409124]


portfolio before change:  [-5.20205165]
curr_Stock_Price:  97.76024741847245
curr_Factors:  [97.76024742]
mat_Sqrt:  [[0.15]]
grads:  [0.06574497]
Stock Position:  0.06574496618921197
Bond Position:  [-11.62929581]


portfolio before change:  [-5.16441863]
curr_Stock_Price:  98.35476856243793
curr_Factors:  [98.35476856]
mat_Sqrt:  [[0.15]]
grads:  [-0.0959412]
Stock Position:  -0.09594119592046624
Bond Position:  [4.27185549]


portfolio before change:  [-5.19550952]
curr_Stock_Price:  98.68439656898737
curr_Factors:  [98.68439657]
mat_Sqrt:  [[0.15]]
grads:  [0.00021372]
Stock Position:  0.0002137172899376617
Bond Position:  [-5.21660009]


portfolio before change:  [-5.19635979]
curr_Stock_Price:  97.75723653564943
curr_Factors:  [97.75723654]
mat_Sqrt:  [[0.15]]
grads:  [-0.04046748]
Stock Position:  -0.04046747828597742
Bond Position:  [-1.24037094]


portfolio before change:  [-5.20231573]
curr_Stock_Price:  97.90058345065458
curr_Factors:  [97.90058345]
mat_Sqrt:  [[0.15]]
grads:  [0.01582415]
Stock Position:  0.015824148641986557
Bond Position:  [-6.75150912]


portfolio before change:  [-5.22209131]
curr_Stock_Price:  96.70421040939776
curr_Factors:  [96.70421041]
mat_Sqrt:  [[0.15]]
grads:  [0.00653615]
Stock Position:  0.006536149829664198
Bond Position:  [-5.85416452]


portfolio before change:  [-5.22848124]
curr_Stock_Price:  95.83854587963472
curr_Factors:  [95.83854588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349403]
Stock Position:  -0.023494029075276576
Bond Position:  [-2.97684766]


portfolio before change:  [-5.23424458]
curr_Stock_Price:  96.06801735216007
curr_Factors:  [96.06801735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08071131]
Stock Position:  -0.08071130801678948
Bond Position:  [2.51953076]


portfolio before change:  [-5.21713034]
curr_Stock_Price:  95.85987701167467
curr_Factors:  [95.85987701]
mat_Sqrt:  [[0.15]]
grads:  [-0.14188463]
Stock Position:  -0.1418846328607995
Bond Position:  [8.38391312]


portfolio before change:  [-5.44869369]
curr_Stock_Price:  97.49931749265352
curr_Factors:  [97.49931749]
mat_Sqrt:  [[0.15]]
grads:  [0.04246686]
Stock Position:  0.042466858060219784
Bond Position:  [-9.58918337]


portfolio before change:  [-5.45579976]
curr_Stock_Price:  97.36021259817917
curr_Factors:  [97.3602126]
mat_Sqrt:  [[0.15]]
grads:  [-0.05902919]
Stock Position:  -0.05902918866405784
Bond Position:  [0.29129459]


portfolio before change:  [-5.3872733]
curr_Stock_Price:  96.19993824047981
curr_Factors:  [96.19993824]
mat_Sqrt:  [[0.15]]
grads:  [0.08050493]
Stock Position:  0.08050492680998309
Bond Position:  [-13.13184228]


portfolio before change:  [-5.43514777]
curr_Stock_Price:  95.6256517374147
curr_Factors:  [95.62565174]
mat_Sqrt:  [[0.15]]
grads:  [0.00172999]
Stock Position:  0.0017299874395280447
Bond Position:  [-5.60057895]


portfolio before change:  [-5.43582667]
curr_Stock_Price:  95.637918934888
curr_Factors:  [95.63791893]
mat_Sqrt:  [[0.15]]
grads:  [0.15409749]
Stock Position:  0.15409749046513174
Bond Position:  [-20.17338997]


portfolio before change:  [-5.37246378]
curr_Stock_Price:  96.06547113797966
curr_Factors:  [96.06547114]
mat_Sqrt:  [[0.15]]
grads:  [-0.02846962]
Stock Position:  -0.028469620171544623
Bond Position:  [-2.6375163]


portfolio before change:  [-5.36445803]
curr_Stock_Price:  95.77268676336911
curr_Factors:  [95.77268676]
mat_Sqrt:  [[0.15]]
grads:  [-0.19180131]
Stock Position:  -0.1918013061179563
Bond Position:  [13.00486838]


portfolio before change:  [-5.31721344]
curr_Stock_Price:  95.5348423196598
curr_Factors:  [95.53484232]
mat_Sqrt:  [[0.15]]
grads:  [-0.06662012]
Stock Position:  -0.06662012041945357
Bond Position:  [1.04732926]


portfolio before change:  [-5.316923]
curr_Stock_Price:  95.53244788754795
curr_Factors:  [95.53244789]
mat_Sqrt:  [[0.15]]
grads:  [0.2874364]
Stock Position:  0.28743639670765314
Bond Position:  [-32.77642559]


portfolio before change:  [-5.08774915]
curr_Stock_Price:  96.34400538023496
curr_Factors:  [96.34400538]
mat_Sqrt:  [[0.15]]
grads:  [0.02866983]
Stock Position:  0.028669832583030446
Bond Position:  [-7.84991565]


portfolio before change:  [-5.1255477]
curr_Stock_Price:  95.05982456798493
curr_Factors:  [95.05982457]
mat_Sqrt:  [[0.15]]
grads:  [-0.13191427]
Stock Position:  -0.1319142719360132
Bond Position:  [7.41419985]


portfolio before change:  [-5.15820197]
curr_Stock_Price:  95.31439223632508
curr_Factors:  [95.31439224]
mat_Sqrt:  [[0.15]]
grads:  [-0.21565051]
Stock Position:  -0.21565050929390267
Bond Position:  [15.39639526]


portfolio before change:  [-5.24595498]
curr_Stock_Price:  95.73023950599155
curr_Factors:  [95.73023951]
mat_Sqrt:  [[0.15]]
grads:  [-0.154796]
Stock Position:  -0.15479600245908579
Bond Position:  [9.57270341]


portfolio before change:  [-5.18371298]
curr_Stock_Price:  95.33587960251917
curr_Factors:  [95.3358796]
mat_Sqrt:  [[0.15]]
grads:  [0.24257167]
Stock Position:  0.2425716682564517
Bond Position:  [-28.30949634]


portfolio before change:  [-5.23797337]
curr_Stock_Price:  95.1267806321491
curr_Factors:  [95.12678063]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422807]
Stock Position:  -0.034228065688590166
Bond Position:  [-1.98196768]


portfolio before change:  [-5.24311808]
curr_Stock_Price:  95.26984872212881
curr_Factors:  [95.26984872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01506896]
Stock Position:  -0.015068958916162774
Bond Position:  [-3.80750064]


portfolio before change:  [-5.2562412]
curr_Stock_Price:  96.10913353489494
curr_Factors:  [96.10913353]
mat_Sqrt:  [[0.15]]
grads:  [0.10932672]
Stock Position:  0.10932672476083247
Bond Position:  [-15.76353798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.37678729]
Stock Price:  95.02453571710208
PL:  [-5.37678729]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.49263120e-02]
 [-2.60048252e-02]
 [ 1.44249031e-02]
 [ 8.85205701e-03]
 [ 1.42415903e-03]
 [-1.69808409e-02]
 [ 3.45821262e-03]
 [ 2.72046211e-02]
 [ 2.28093427e-02]
 [ 2.29034214e-02]
 [ 2.01270754e-02]
 [-1.32250968e-02]
 [ 3.19707230e-02]
 [ 1.35457531e-02]
 [-1.25332262e-02]
 [-3.24274714e-03]
 [-5.85542750e-03]
 [ 6.73209327e-03]
 [ 1.44262332e-02]
 [ 1.78198135e-02]
 [-5.45421973e-04]
 [-3.69083031e-03]
 [ 4.08210819e-03]
 [-1.13799517e-02]
 [ 6.43213469e-04]
 [ 3.05444574e-03]
 [-2.50889818e-03]
 [-8.21153521e-04]
 [ 5.42479495e-04]
 [-7.60485358e-03]
 [-2.94598889e-02]
 [ 1.20084740e-02]
 [-3.50252251e-03]
 [-1.85614788e-02]
 [-2.04676585e-02]
 [ 2.06165857e-02]
 [ 3.15044734e-03]
 [ 2.17735414e-02]
 [ 1.05107832e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.53111548]
curr_Stock_Price:  101.39573964068347
curr_Factors:  [101.39573964]
mat_Sqrt:  [[0.15]]
grads:  [-0.36617541]
Stock Position:  -0.36617541326304426
Bond Position:  [69.65974235]


portfolio before change:  [32.40027028]
curr_Stock_Price:  101.77684990981722
curr_Factors:  [101.77684991]
mat_Sqrt:  [[0.15]]
grads:  [-0.1733655]
Stock Position:  -0.17336550105837745
Bond Position:  [50.04486486]


portfolio before change:  [32.27041141]
curr_Stock_Price:  102.5619823090913
curr_Factors:  [102.56198231]
mat_Sqrt:  [[0.15]]
grads:  [0.09616602]
Stock Position:  0.09616602059840627
Bond Position:  [22.40743371]


portfolio before change:  [32.36340187]
curr_Stock_Price:  103.49983283803238
curr_Factors:  [103.49983284]
mat_Sqrt:  [[0.15]]
grads:  [0.05901371]
Stock Position:  0.05901371343073267
Bond Position:  [26.25549239]


portfolio before change:  [32.33805304]
curr_Stock_Price:  103.01467495443434
curr_Factors:  [103.01467495]
mat_Sqrt:  [[0.15]]
grads:  [0.00949439]
Stock Position:  0.00949439356132381
Bond Position:  [31.35999117]


portfolio before change:  [32.34559898]
curr_Stock_Price:  103.39655288176081
curr_Factors:  [103.39655288]
mat_Sqrt:  [[0.15]]
grads:  [-0.11320561]
Stock Position:  -0.11320560589550328
Bond Position:  [44.0506684]


portfolio before change:  [32.40345773]
curr_Stock_Price:  102.93410172152521
curr_Factors:  [102.93410172]
mat_Sqrt:  [[0.15]]
grads:  [0.02305475]
Stock Position:  0.023054750801664973
Bond Position:  [30.03033766]


portfolio before change:  [32.41187204]
curr_Stock_Price:  103.13624187877889
curr_Factors:  [103.13624188]
mat_Sqrt:  [[0.15]]
grads:  [0.18136414]
Stock Position:  0.18136414050481386
Bond Position:  [13.70665618]


portfolio before change:  [32.38083199]
curr_Stock_Price:  102.95564665349582
curr_Factors:  [102.95564665]
mat_Sqrt:  [[0.15]]
grads:  [0.15206228]
Stock Position:  0.152062284825512
Bond Position:  [16.72516112]


portfolio before change:  [32.25300044]
curr_Stock_Price:  102.10124462327084
curr_Factors:  [102.10124462]
mat_Sqrt:  [[0.15]]
grads:  [0.15268948]
Stock Position:  0.15268947568593597
Bond Position:  [16.66321493]


portfolio before change:  [32.18376771]
curr_Stock_Price:  101.63418061570383
curr_Factors:  [101.63418062]
mat_Sqrt:  [[0.15]]
grads:  [0.1341805]
Stock Position:  0.13418050275246324
Bond Position:  [18.54644226]


portfolio before change:  [32.11998652]
curr_Stock_Price:  101.14156329392894
curr_Factors:  [101.14156329]
mat_Sqrt:  [[0.15]]
grads:  [-0.08816731]
Stock Position:  -0.08816731209887185
Bond Position:  [41.0373663]


portfolio before change:  [32.16269993]
curr_Stock_Price:  100.71528949503968
curr_Factors:  [100.7152895]
mat_Sqrt:  [[0.15]]
grads:  [0.21313815]
Stock Position:  0.21313815345436093
Bond Position:  [10.6964291]


portfolio before change:  [32.23195622]
curr_Stock_Price:  101.03395210807062
curr_Factors:  [101.03395211]
mat_Sqrt:  [[0.15]]
grads:  [0.09030502]
Stock Position:  0.09030502061888615
Bond Position:  [23.1080831]


portfolio before change:  [32.30813737]
curr_Stock_Price:  101.84556202008248
curr_Factors:  [101.84556202]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355484]
Stock Position:  -0.08355484126137526
Bond Position:  [40.81782713]


portfolio before change:  [32.34067698]
curr_Stock_Price:  101.5171900449185
curr_Factors:  [101.51719004]
mat_Sqrt:  [[0.15]]
grads:  [-0.02161831]
Stock Position:  -0.02161831427347184
Bond Position:  [34.5353075]


portfolio before change:  [32.34546388]
curr_Stock_Price:  101.49546253658345
curr_Factors:  [101.49546254]
mat_Sqrt:  [[0.15]]
grads:  [-0.03903618]
Stock Position:  -0.03903618333619457
Bond Position:  [36.30745936]


portfolio before change:  [32.35389002]
curr_Stock_Price:  101.395877272771
curr_Factors:  [101.39587727]
mat_Sqrt:  [[0.15]]
grads:  [0.04488062]
Stock Position:  0.04488062178616841
Bond Position:  [27.80318]


portfolio before change:  [32.4010506]
curr_Stock_Price:  102.36923651938572
curr_Factors:  [102.36923652]
mat_Sqrt:  [[0.15]]
grads:  [0.09617489]
Stock Position:  0.09617488803622624
Bond Position:  [22.55570074]


portfolio before change:  [32.40316425]
curr_Stock_Price:  102.36189579956273
curr_Factors:  [102.3618958]
mat_Sqrt:  [[0.15]]
grads:  [0.11879876]
Stock Position:  0.11879875669550322
Bond Position:  [20.2426983]


portfolio before change:  [32.46624009]
curr_Stock_Price:  102.87154207115424
curr_Factors:  [102.87154207]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363615]
Stock Position:  -0.003636146485255652
Bond Position:  [32.84029608]


portfolio before change:  [32.4706737]
curr_Stock_Price:  102.78124989442766
curr_Factors:  [102.78124989]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460554]
Stock Position:  -0.02460553541122772
Bond Position:  [34.99966138]


portfolio before change:  [32.48858989]
curr_Stock_Price:  102.23092830997385
curr_Factors:  [102.23092831]
mat_Sqrt:  [[0.15]]
grads:  [0.02721405]
Stock Position:  0.027214054605700477
Bond Position:  [29.70647182]


portfolio before change:  [32.52202715]
curr_Stock_Price:  103.32314779148022
curr_Factors:  [103.32314779]
mat_Sqrt:  [[0.15]]
grads:  [-0.07586634]
Stock Position:  -0.07586634440593618
Bond Position:  [40.36077666]


portfolio before change:  [32.57056536]
curr_Stock_Price:  102.7498658735528
curr_Factors:  [102.74986587]
mat_Sqrt:  [[0.15]]
grads:  [0.00428809]
Stock Position:  0.0042880897938386495
Bond Position:  [32.12996471]


portfolio before change:  [32.57165771]
curr_Stock_Price:  102.06794217764512
curr_Factors:  [102.06794218]
mat_Sqrt:  [[0.15]]
grads:  [0.02036297]
Stock Position:  0.020362971611552903
Bond Position:  [30.4932511]


portfolio before change:  [32.57133276]
curr_Stock_Price:  101.86478699428041
curr_Factors:  [101.86478699]
mat_Sqrt:  [[0.15]]
grads:  [-0.01672599]
Stock Position:  -0.01672598784978783
Bond Position:  [34.27512195]


portfolio before change:  [32.58607223]
curr_Stock_Price:  101.23972341461132
curr_Factors:  [101.23972341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00547436]
Stock Position:  -0.005474356806169356
Bond Position:  [33.14029459]


portfolio before change:  [32.59446157]
curr_Stock_Price:  100.46400720625208
curr_Factors:  [100.46400721]
mat_Sqrt:  [[0.15]]
grads:  [0.00361653]
Stock Position:  0.0036165299690210963
Bond Position:  [32.23113048]


portfolio before change:  [32.59940002]
curr_Stock_Price:  100.71543751332709
curr_Factors:  [100.71543751]
mat_Sqrt:  [[0.15]]
grads:  [-0.05069902]
Stock Position:  -0.05069902384985296
Bond Position:  [37.70557439]


portfolio before change:  [32.601901]
curr_Stock_Price:  100.75907758427789
curr_Factors:  [100.75907758]
mat_Sqrt:  [[0.15]]
grads:  [-0.19639926]
Stock Position:  -0.1963992594935018
Bond Position:  [52.39090922]


portfolio before change:  [32.28905255]
curr_Stock_Price:  102.38534503438972
curr_Factors:  [102.38534503]
mat_Sqrt:  [[0.15]]
grads:  [0.08005649]
Stock Position:  0.08005649328098233
Bond Position:  [24.09244086]


portfolio before change:  [32.19499749]
curr_Stock_Price:  101.17286625079421
curr_Factors:  [101.17286625]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335015]
Stock Position:  -0.023350150079528773
Bond Position:  [34.5573991]


portfolio before change:  [32.20860147]
curr_Stock_Price:  100.77526552210212
curr_Factors:  [100.77526552]
mat_Sqrt:  [[0.15]]
grads:  [-0.12374319]
Stock Position:  -0.12374319205612583
Bond Position:  [44.67885451]


portfolio before change:  [32.07698009]
curr_Stock_Price:  101.88406668229908
curr_Factors:  [101.88406668]
mat_Sqrt:  [[0.15]]
grads:  [-0.13645106]
Stock Position:  -0.13645105670629165
Bond Position:  [45.97916865]


portfolio before change:  [31.9818918]
curr_Stock_Price:  102.62305723435797
curr_Factors:  [102.62305723]
mat_Sqrt:  [[0.15]]
grads:  [0.1374439]
Stock Position:  0.13744390467621106
Bond Position:  [17.8769781]


portfolio before change:  [31.95902529]
curr_Stock_Price:  102.44042803175725
curr_Factors:  [102.44042803]
mat_Sqrt:  [[0.15]]
grads:  [0.02100298]
Stock Position:  0.021002982239972167
Bond Position:  [29.8074708]


portfolio before change:  [31.98316486]
curr_Stock_Price:  103.4123568986974
curr_Factors:  [103.4123569]
mat_Sqrt:  [[0.15]]
grads:  [0.14515694]
Stock Position:  0.14515694267240908
Bond Position:  [16.9721433]


portfolio before change:  [31.99330513]
curr_Stock_Price:  103.46759792681154
curr_Factors:  [103.46759793]
mat_Sqrt:  [[0.15]]
grads:  [0.07007189]
Stock Position:  0.07007188825162886
Bond Position:  [24.74313517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.87640941]
Stock Price:  101.7552306136392
PL:  [30.12117879]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.92404652e-03]
 [ 4.41753680e-02]
 [ 1.96367271e-03]
 [-2.24128135e-03]
 [-3.30611123e-03]
 [ 3.15454548e-02]
 [ 3.68847500e-03]
 [ 4.43426764e-03]
 [-2.44383122e-02]
 [ 2.33900199e-02]
 [ 1.98291714e-02]
 [-1.44553166e-02]
 [ 1.31471605e-02]
 [ 6.36580127e-03]
 [-1.26328718e-02]
 [ 7.04263983e-04]
 [-6.07799505e-03]
 [ 3.08666336e-03]
 [ 2.41019499e-03]
 [-2.78220353e-02]
 [-2.73376715e-03]
 [-6.18557623e-03]
 [ 7.06356554e-03]
 [-6.41698532e-03]
 [ 1.51312814e-02]
 [ 6.60396906e-03]
 [-7.83485457e-03]
 [-3.03748350e-03]
 [-1.11156485e-02]
 [-1.34496379e-02]
 [ 3.75991360e-02]
 [ 3.69202319e-03]
 [-1.48266884e-02]
 [-4.30978509e-02]
 [-2.28906764e-02]
 [ 3.95551311e-02]
 [-7.09040276e-04]
 [ 3.75186561e-03]
 [ 1.52006021e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.31951108]
curr_Stock_Price:  100.33854271237483
curr_Factors:  [100.33854271]
mat_Sqrt:  [[0.15]]
grads:  [0.01949364]
Stock Position:  0.019493643460694668
Bond Position:  [7.3635473]


portfolio before change:  [9.32165595]
curr_Stock_Price:  100.40135123314789
curr_Factors:  [100.40135123]
mat_Sqrt:  [[0.15]]
grads:  [0.29450245]
Stock Position:  0.2945024532273991
Bond Position:  [-20.2467883]


portfolio before change:  [9.66538636]
curr_Stock_Price:  101.57710178405209
curr_Factors:  [101.57710178]
mat_Sqrt:  [[0.15]]
grads:  [0.01309115]
Stock Position:  0.013091151414439997
Bond Position:  [8.33562514]


portfolio before change:  [9.65427709]
curr_Stock_Price:  100.64889516602106
curr_Factors:  [100.64889517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494188]
Stock Position:  -0.014941875689057029
Bond Position:  [11.15816037]


portfolio before change:  [9.64901961]
curr_Stock_Price:  101.09410903411239
curr_Factors:  [101.09410903]
mat_Sqrt:  [[0.15]]
grads:  [-0.02204074]
Stock Position:  -0.022040741506692357
Bond Position:  [11.87720874]


portfolio before change:  [9.66559597]
curr_Stock_Price:  100.40939466877711
curr_Factors:  [100.40939467]
mat_Sqrt:  [[0.15]]
grads:  [0.21030303]
Stock Position:  0.21030303221586014
Bond Position:  [-11.45080419]


portfolio before change:  [9.83560449]
curr_Stock_Price:  101.22459909425018
curr_Factors:  [101.22459909]
mat_Sqrt:  [[0.15]]
grads:  [0.02458983]
Stock Position:  0.024589833328509086
Bond Position:  [7.34650847]


portfolio before change:  [9.81125104]
curr_Stock_Price:  100.19686429503722
curr_Factors:  [100.1968643]
mat_Sqrt:  [[0.15]]
grads:  [0.02956178]
Stock Position:  0.029561784279683347
Bond Position:  [6.84925295]


portfolio before change:  [9.82043701]
curr_Stock_Price:  100.4786390401936
curr_Factors:  [100.47863904]
mat_Sqrt:  [[0.15]]
grads:  [-0.16292208]
Stock Position:  -0.16292208122579477
Bond Position:  [26.190626]


portfolio before change:  [9.87710539]
curr_Stock_Price:  100.15090969657396
curr_Factors:  [100.1509097]
mat_Sqrt:  [[0.15]]
grads:  [0.15593347]
Stock Position:  0.1559334663233835
Bond Position:  [-5.73977311]


portfolio before change:  [9.74666318]
curr_Stock_Price:  99.31898635651152
curr_Factors:  [99.31898636]
mat_Sqrt:  [[0.15]]
grads:  [0.13219448]
Stock Position:  0.1321944756811935
Bond Position:  [-3.38275814]


portfolio before change:  [9.83811107]
curr_Stock_Price:  100.01395306450166
curr_Factors:  [100.01395306]
mat_Sqrt:  [[0.15]]
grads:  [-0.09636878]
Stock Position:  -0.09636877740964316
Bond Position:  [19.47633345]


portfolio before change:  [9.92220357]
curr_Stock_Price:  99.16660593362658
curr_Factors:  [99.16660593]
mat_Sqrt:  [[0.15]]
grads:  [0.08764774]
Stock Position:  0.08764773656286724
Bond Position:  [1.23047502]


portfolio before change:  [9.90617267]
curr_Stock_Price:  98.98194949707211
curr_Factors:  [98.9819495]
mat_Sqrt:  [[0.15]]
grads:  [0.04243868]
Stock Position:  0.04243867511131351
Bond Position:  [5.70550988]


portfolio before change:  [9.89227405]
curr_Stock_Price:  98.63764437674786
curr_Factors:  [98.63764438]
mat_Sqrt:  [[0.15]]
grads:  [-0.08421915]
Stock Position:  -0.08421914507834162
Bond Position:  [18.19945214]


portfolio before change:  [9.93732137]
curr_Stock_Price:  98.12977603237402
curr_Factors:  [98.12977603]
mat_Sqrt:  [[0.15]]
grads:  [0.00469509]
Stock Position:  0.004695093220060684
Bond Position:  [9.47659292]


portfolio before change:  [9.93611832]
curr_Stock_Price:  97.62122506706899
curr_Factors:  [97.62122507]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051997]
Stock Position:  -0.04051996697097055
Bond Position:  [13.89172713]


portfolio before change:  [9.91119824]
curr_Stock_Price:  98.27908962384247
curr_Factors:  [98.27908962]
mat_Sqrt:  [[0.15]]
grads:  [0.02057776]
Stock Position:  0.020577755760091538
Bond Position:  [7.88883514]


portfolio before change:  [9.89725166]
curr_Stock_Price:  97.5534151687096
curr_Factors:  [97.55341517]
mat_Sqrt:  [[0.15]]
grads:  [0.01606797]
Stock Position:  0.016067966567970427
Bond Position:  [8.32976664]


portfolio before change:  [9.9024732]
curr_Stock_Price:  97.8135763020954
curr_Factors:  [97.8135763]
mat_Sqrt:  [[0.15]]
grads:  [-0.18548024]
Stock Position:  -0.18548023512123346
Bond Position:  [28.04495833]


portfolio before change:  [9.68424899]
curr_Stock_Price:  99.00901393049041
curr_Factors:  [99.00901393]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822511]
Stock Position:  -0.018225114328166026
Bond Position:  [11.48869959]


portfolio before change:  [9.67285659]
curr_Stock_Price:  99.71290963182118
curr_Factors:  [99.71290963]
mat_Sqrt:  [[0.15]]
grads:  [-0.04123717]
Stock Position:  -0.04123717489329529
Bond Position:  [13.78473528]


portfolio before change:  [9.69174208]
curr_Stock_Price:  99.29672460439673
curr_Factors:  [99.2967246]
mat_Sqrt:  [[0.15]]
grads:  [0.04709044]
Stock Position:  0.04709043693071242
Bond Position:  [5.01581594]


portfolio before change:  [9.6707596]
curr_Stock_Price:  98.83783099952282
curr_Factors:  [98.837831]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427799]
Stock Position:  -0.0427799021336654
Bond Position:  [13.89903234]


portfolio before change:  [9.67193038]
curr_Stock_Price:  98.85107811698514
curr_Factors:  [98.85107812]
mat_Sqrt:  [[0.15]]
grads:  [0.10087521]
Stock Position:  0.1008752093912281
Bond Position:  [-0.29969283]


portfolio before change:  [9.61870189]
curr_Stock_Price:  98.32378279045136
curr_Factors:  [98.32378279]
mat_Sqrt:  [[0.15]]
grads:  [0.04402646]
Stock Position:  0.04402646037498818
Bond Position:  [5.28985376]


portfolio before change:  [9.65490896]
curr_Stock_Price:  99.13115638520449
curr_Factors:  [99.13115639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05223236]
Stock Position:  -0.052232363816501794
Bond Position:  [14.83276359]


portfolio before change:  [9.69858917]
curr_Stock_Price:  98.33038850935085
curr_Factors:  [98.33038851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024989]
Stock Position:  -0.020249889999486976
Bond Position:  [11.68976872]


portfolio before change:  [9.70648363]
curr_Stock_Price:  98.01270031218924
curr_Factors:  [98.01270031]
mat_Sqrt:  [[0.15]]
grads:  [-0.07410432]
Stock Position:  -0.07410432306371544
Bond Position:  [16.96964844]


portfolio before change:  [9.75832918]
curr_Stock_Price:  97.34169750441532
curr_Factors:  [97.3416975]
mat_Sqrt:  [[0.15]]
grads:  [-0.08966425]
Stock Position:  -0.08966425260011486
Bond Position:  [18.48639973]


portfolio before change:  [9.81382191]
curr_Stock_Price:  96.74857610840235
curr_Factors:  [96.74857611]
mat_Sqrt:  [[0.15]]
grads:  [0.25066091]
Stock Position:  0.25066090657273776
Bond Position:  [-14.43726388]


portfolio before change:  [9.66094362]
curr_Stock_Price:  96.14587532422489
curr_Factors:  [96.14587532]
mat_Sqrt:  [[0.15]]
grads:  [0.02461349]
Stock Position:  0.024613487911283538
Bond Position:  [7.29445828]


portfolio before change:  [9.67726041]
curr_Stock_Price:  96.77174860333773
curr_Factors:  [96.7717486]
mat_Sqrt:  [[0.15]]
grads:  [-0.09884459]
Stock Position:  -0.09884458943015413
Bond Position:  [19.24262416]


portfolio before change:  [9.71524875]
curr_Stock_Price:  96.41176060125085
curr_Factors:  [96.4117606]
mat_Sqrt:  [[0.15]]
grads:  [-0.28731901]
Stock Position:  -0.2873190058841307
Bond Position:  [37.41617996]


portfolio before change:  [9.64007681]
curr_Stock_Price:  96.68967208599773
curr_Factors:  [96.68967209]
mat_Sqrt:  [[0.15]]
grads:  [-0.15260451]
Stock Position:  -0.15260450926033314
Bond Position:  [24.39535677]


portfolio before change:  [9.62790228]
curr_Stock_Price:  96.78943419025418
curr_Factors:  [96.78943419]
mat_Sqrt:  [[0.15]]
grads:  [0.26370087]
Stock Position:  0.26370087408862236
Bond Position:  [-15.89555612]


portfolio before change:  [9.66397481]
curr_Stock_Price:  96.93376289330998
curr_Factors:  [96.93376289]
mat_Sqrt:  [[0.15]]
grads:  [-0.00472694]
Stock Position:  -0.004726935174296374
Bond Position:  [10.12217443]


portfolio before change:  [9.66555285]
curr_Stock_Price:  96.8676129191034
curr_Factors:  [96.86761292]
mat_Sqrt:  [[0.15]]
grads:  [0.02501244]
Stock Position:  0.025012437378831357
Bond Position:  [7.24265775]


portfolio before change:  [9.65224634]
curr_Stock_Price:  96.29941973737672
curr_Factors:  [96.29941974]
mat_Sqrt:  [[0.15]]
grads:  [0.10133735]
Stock Position:  0.10133734734891207
Bond Position:  [-0.1064814]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.69151186]
Stock Price:  96.68702441133428
PL:  [9.69151186]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.97908589e-03]
 [ 1.76208112e-02]
 [-3.35652796e-03]
 [-6.25323153e-03]
 [-7.43300918e-03]
 [ 2.80351445e-02]
 [ 3.54435142e-03]
 [-1.40342144e-03]
 [-2.38049672e-02]
 [ 2.33944085e-02]
 [ 1.98535059e-02]
 [-1.44507003e-02]
 [ 1.50271871e-02]
 [ 6.41551764e-03]
 [ 5.62574291e-03]
 [-3.73866802e-03]
 [-6.03170455e-03]
 [ 6.15248564e-03]
 [ 6.65484907e-03]
 [ 2.49529625e-04]
 [-3.94890035e-03]
 [-4.95003985e-03]
 [ 4.41638107e-03]
 [-1.24492990e-02]
 [ 4.05348446e-04]
 [ 4.24668807e-03]
 [ 3.20906515e-03]
 [ 1.32658818e-03]
 [ 2.65648253e-03]
 [-6.85442711e-03]
 [-2.28370975e-02]
 [ 1.91421162e-02]
 [-8.20123188e-03]
 [-2.30629592e-02]
 [-2.13211322e-02]
 [ 2.87327073e-02]
 [ 3.41034564e-03]
 [ 9.16966576e-03]
 [ 7.47199006e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.70999013]
curr_Stock_Price:  99.10745565939631
curr_Factors:  [99.10745566]
mat_Sqrt:  [[0.15]]
grads:  [0.01986057]
Stock Position:  0.019860572592486476
Bond Position:  [-19.67832095]


portfolio before change:  [-17.71714261]
curr_Stock_Price:  98.87118169857592
curr_Factors:  [98.8711817]
mat_Sqrt:  [[0.15]]
grads:  [0.11747207]
Stock Position:  0.11747207449531191
Bond Position:  [-29.33174544]


portfolio before change:  [-17.57799551]
curr_Stock_Price:  100.08690722008484
curr_Factors:  [100.08690722]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237685]
Stock Position:  -0.022376853070576373
Bond Position:  [-15.3383655]


portfolio before change:  [-17.57774371]
curr_Stock_Price:  99.98996678348685
curr_Factors:  [99.98996678]
mat_Sqrt:  [[0.15]]
grads:  [-0.04168821]
Stock Position:  -0.04168821017628054
Bond Position:  [-13.40934096]


portfolio before change:  [-17.57221974]
curr_Stock_Price:  99.81725038407001
curr_Factors:  [99.81725038]
mat_Sqrt:  [[0.15]]
grads:  [-0.04955339]
Stock Position:  -0.049553394537809325
Bond Position:  [-12.62593615]


portfolio before change:  [-17.55362391]
curr_Stock_Price:  99.41013049525814
curr_Factors:  [99.4101305]
mat_Sqrt:  [[0.15]]
grads:  [0.18690096]
Stock Position:  0.18690096339365458
Bond Position:  [-36.13347307]


portfolio before change:  [-17.59838539]
curr_Stock_Price:  99.19480514260273
curr_Factors:  [99.19480514]
mat_Sqrt:  [[0.15]]
grads:  [0.02362901]
Stock Position:  0.023629009439154955
Bond Position:  [-19.94226038]


portfolio before change:  [-17.60789511]
curr_Stock_Price:  98.89784887151154
curr_Factors:  [98.89784887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00935614]
Stock Position:  -0.00935614292217609
Bond Position:  [-16.6825927]


portfolio before change:  [-17.62531231]
curr_Stock_Price:  100.53653092852227
curr_Factors:  [100.53653093]
mat_Sqrt:  [[0.15]]
grads:  [-0.15869978]
Stock Position:  -0.158699781137323
Bond Position:  [-1.67018686]


portfolio before change:  [-17.54196509]
curr_Stock_Price:  100.01002732785454
curr_Factors:  [100.01002733]
mat_Sqrt:  [[0.15]]
grads:  [0.15596272]
Stock Position:  0.15596272326736188
Bond Position:  [-33.13980131]


portfolio before change:  [-17.65722073]
curr_Stock_Price:  99.29759488325408
curr_Factors:  [99.29759488]
mat_Sqrt:  [[0.15]]
grads:  [0.13235671]
Stock Position:  0.13235670583087705
Bond Position:  [-30.79992329]


portfolio before change:  [-17.56353858]
curr_Stock_Price:  100.03448522579275
curr_Factors:  [100.03448523]
mat_Sqrt:  [[0.15]]
grads:  [-0.096338]
Stock Position:  -0.09633800192665144
Bond Position:  [-7.92641615]


portfolio before change:  [-17.50000252]
curr_Stock_Price:  99.36468804772983
curr_Factors:  [99.36468805]
mat_Sqrt:  [[0.15]]
grads:  [0.10018125]
Stock Position:  0.10018124758593665
Bond Position:  [-27.45448094]


portfolio before change:  [-17.51672151]
curr_Stock_Price:  99.23205881863572
curr_Factors:  [99.23205882]
mat_Sqrt:  [[0.15]]
grads:  [0.04277012]
Stock Position:  0.04277011761226214
Bond Position:  [-21.76088834]


portfolio before change:  [-17.45335346]
curr_Stock_Price:  100.7772575218596
curr_Factors:  [100.77725752]
mat_Sqrt:  [[0.15]]
grads:  [0.03750495]
Stock Position:  0.03750495270853174
Bond Position:  [-21.23299974]


portfolio before change:  [-17.45557723]
curr_Stock_Price:  100.78873672167032
curr_Factors:  [100.78873672]
mat_Sqrt:  [[0.15]]
grads:  [-0.02492445]
Stock Position:  -0.024924453444051996
Bond Position:  [-14.94347305]


portfolio before change:  [-17.45625164]
curr_Stock_Price:  100.7408467243877
curr_Factors:  [100.74084672]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021136]
Stock Position:  -0.04021136365047465
Bond Position:  [-13.40532482]


portfolio before change:  [-17.46274894]
curr_Stock_Price:  100.86075123845205
curr_Factors:  [100.86075124]
mat_Sqrt:  [[0.15]]
grads:  [0.04101657]
Stock Position:  0.04101657096606876
Bond Position:  [-21.5997111]


portfolio before change:  [-17.48281735]
curr_Stock_Price:  100.4373059421304
curr_Factors:  [100.43730594]
mat_Sqrt:  [[0.15]]
grads:  [0.04436566]
Stock Position:  0.04436566048961715
Bond Position:  [-21.93878476]


portfolio before change:  [-17.48854836]
curr_Stock_Price:  100.3699454477618
curr_Factors:  [100.36994545]
mat_Sqrt:  [[0.15]]
grads:  [0.00166353]
Stock Position:  0.0016635308338731197
Bond Position:  [-17.65551686]


portfolio before change:  [-17.48922602]
curr_Stock_Price:  101.2893247095474
curr_Factors:  [101.28932471]
mat_Sqrt:  [[0.15]]
grads:  [-0.026326]
Stock Position:  -0.026326002305400283
Bond Position:  [-14.82268302]


portfolio before change:  [-17.48715653]
curr_Stock_Price:  101.14032977763266
curr_Factors:  [101.14032978]
mat_Sqrt:  [[0.15]]
grads:  [-0.03300027]
Stock Position:  -0.033000265683809246
Bond Position:  [-14.14949878]


portfolio before change:  [-17.50937983]
curr_Stock_Price:  101.76015815270544
curr_Factors:  [101.76015815]
mat_Sqrt:  [[0.15]]
grads:  [0.02944254]
Stock Position:  0.02944254043496925
Bond Position:  [-20.5054574]


portfolio before change:  [-17.49231725]
curr_Stock_Price:  102.4267418434225
curr_Factors:  [102.42674184]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299533]
Stock Position:  -0.08299532672483241
Bond Position:  [-8.99137635]


portfolio before change:  [-17.52743516]
curr_Stock_Price:  102.83633009792992
curr_Factors:  [102.8363301]
mat_Sqrt:  [[0.15]]
grads:  [0.00270232]
Stock Position:  0.002702322970170197
Bond Position:  [-17.80533213]


portfolio before change:  [-17.52780188]
curr_Stock_Price:  103.52428751377703
curr_Factors:  [103.52428751]
mat_Sqrt:  [[0.15]]
grads:  [0.02831125]
Stock Position:  0.028311253796734784
Bond Position:  [-20.45870426]


portfolio before change:  [-17.52679987]
curr_Stock_Price:  103.65001522341089
curr_Factors:  [103.65001522]
mat_Sqrt:  [[0.15]]
grads:  [0.02139377]
Stock Position:  0.021393767685991046
Bond Position:  [-19.74426421]


portfolio before change:  [-17.53526614]
curr_Stock_Price:  103.36964924320017
curr_Factors:  [103.36964924]
mat_Sqrt:  [[0.15]]
grads:  [0.00884392]
Stock Position:  0.008843921232258828
Bond Position:  [-18.44945918]


portfolio before change:  [-17.54832522]
curr_Stock_Price:  102.15381413499546
curr_Factors:  [102.15381413]
mat_Sqrt:  [[0.15]]
grads:  [0.01770988]
Stock Position:  0.017709883526652447
Bond Position:  [-19.35745737]


portfolio before change:  [-17.57200342]
curr_Stock_Price:  100.95344676336912
curr_Factors:  [100.95344676]
mat_Sqrt:  [[0.15]]
grads:  [-0.04569618]
Stock Position:  -0.045696180753575136
Bond Position:  [-12.95881647]


portfolio before change:  [-17.6039474]
curr_Stock_Price:  101.6170477383627
curr_Factors:  [101.61704774]
mat_Sqrt:  [[0.15]]
grads:  [-0.15224732]
Stock Position:  -0.152247316420242
Bond Position:  [-2.13302458]


portfolio before change:  [-17.48960145]
curr_Stock_Price:  100.86424241589695
curr_Factors:  [100.86424242]
mat_Sqrt:  [[0.15]]
grads:  [0.12761411]
Stock Position:  0.12761410832527303
Bond Position:  [-30.36130181]


portfolio before change:  [-17.62448588]
curr_Stock_Price:  99.83701252903134
curr_Factors:  [99.83701253]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467488]
Stock Position:  -0.05467487916902087
Bond Position:  [-12.16590928]


portfolio before change:  [-17.63463547]
curr_Stock_Price:  99.99483183380885
curr_Factors:  [99.99483183]
mat_Sqrt:  [[0.15]]
grads:  [-0.15375306]
Stock Position:  -0.15375306141449488
Bond Position:  [-2.26012395]


portfolio before change:  [-17.68991016]
curr_Stock_Price:  100.3524973342665
curr_Factors:  [100.35249733]
mat_Sqrt:  [[0.15]]
grads:  [-0.14214088]
Stock Position:  -0.14214088104355724
Bond Position:  [-3.42571778]


portfolio before change:  [-17.64397789]
curr_Stock_Price:  100.02633844147202
curr_Factors:  [100.02633844]
mat_Sqrt:  [[0.15]]
grads:  [0.19155138]
Stock Position:  0.19155138210200415
Bond Position:  [-36.80416127]


portfolio before change:  [-17.67305085]
curr_Stock_Price:  99.8985808328735
curr_Factors:  [99.89858083]
mat_Sqrt:  [[0.15]]
grads:  [0.02273564]
Stock Position:  0.022735637602930202
Bond Position:  [-19.94430878]


portfolio before change:  [-17.66714316]
curr_Stock_Price:  100.26808384705218
curr_Factors:  [100.26808385]
mat_Sqrt:  [[0.15]]
grads:  [0.06113111]
Stock Position:  0.06113110504657936
Bond Position:  [-23.79664192]


portfolio before change:  [-17.64642135]
curr_Stock_Price:  100.65571912471185
curr_Factors:  [100.65571912]
mat_Sqrt:  [[0.15]]
grads:  [0.04981327]
Stock Position:  0.04981326704269844
Bond Position:  [-22.66041157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.66355731]
Stock Price:  100.36858220728736
PL:  [-18.03213951]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.16691433e-02]
 [ 4.41651709e-02]
 [-2.49055626e-03]
 [-4.16841197e-03]
 [-7.42617943e-03]
 [ 2.87060177e-02]
 [ 3.62989576e-03]
 [ 2.30023147e-03]
 [-2.73304494e-02]
 [ 2.33900649e-02]
 [ 1.91675829e-02]
 [-1.43203002e-02]
 [ 2.61263050e-02]
 [ 6.43340501e-03]
 [-1.06724571e-02]
 [ 7.06008101e-04]
 [-6.11089454e-03]
 [ 2.68649400e-03]
 [ 1.84199024e-03]
 [-2.67540578e-02]
 [-5.53444261e-03]
 [-1.85517200e-02]
 [ 6.08791333e-03]
 [-1.00080209e-02]
 [ 1.33774090e-02]
 [ 4.57459954e-03]
 [ 5.97422393e-03]
 [-2.89912341e-03]
 [-1.42335004e-02]
 [-1.49670647e-02]
 [ 3.10868353e-02]
 [ 5.93390124e-03]
 [-1.18581117e-02]
 [-4.64549874e-02]
 [-2.28894029e-02]
 [ 3.95111648e-02]
 [-5.14384751e-04]
 [ 3.77038054e-03]
 [ 9.45808116e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.68007744]
curr_Stock_Price:  100.12723482920963
curr_Factors:  [100.12723483]
mat_Sqrt:  [[0.15]]
grads:  [0.14446096]
Stock Position:  0.14446095531290404
Bond Position:  [-9.78439855]


portfolio before change:  [4.71528996]
curr_Stock_Price:  100.37945274597986
curr_Factors:  [100.37945275]
mat_Sqrt:  [[0.15]]
grads:  [0.29443447]
Stock Position:  0.2944344723768033
Bond Position:  [-24.83988125]


portfolio before change:  [4.67133369]
curr_Stock_Price:  100.24070850548016
curr_Factors:  [100.24070851]
mat_Sqrt:  [[0.15]]
grads:  [-0.01660371]
Stock Position:  -0.016603708407338533
Bond Position:  [6.33570118]


portfolio before change:  [4.67121235]
curr_Stock_Price:  100.2957174810891
curr_Factors:  [100.29571748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02778941]
Stock Position:  -0.027789413113453686
Bond Position:  [7.45837148]


portfolio before change:  [4.68574926]
curr_Stock_Price:  99.80615866684117
curr_Factors:  [99.80615867]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950786]
Stock Position:  -0.049507862877781555
Bond Position:  [9.62693887]


portfolio before change:  [4.71890974]
curr_Stock_Price:  99.16066440864627
curr_Factors:  [99.16066441]
mat_Sqrt:  [[0.15]]
grads:  [0.19137345]
Stock Position:  0.191373451357714
Bond Position:  [-14.25780885]


portfolio before change:  [4.85986778]
curr_Stock_Price:  99.9065378555761
curr_Factors:  [99.90653786]
mat_Sqrt:  [[0.15]]
grads:  [0.02419931]
Stock Position:  0.024199305049386714
Bond Position:  [2.44219899]


portfolio before change:  [4.86031751]
curr_Stock_Price:  99.91250653990951
curr_Factors:  [99.91250654]
mat_Sqrt:  [[0.15]]
grads:  [0.01533488]
Stock Position:  0.01533487647713434
Bond Position:  [3.32817156]


portfolio before change:  [4.86045101]
curr_Stock_Price:  99.89408154256867
curr_Factors:  [99.89408154]
mat_Sqrt:  [[0.15]]
grads:  [-0.182203]
Stock Position:  -0.18220299604271611
Bond Position:  [23.06145196]


portfolio before change:  [4.81697763]
curr_Stock_Price:  100.14850239049537
curr_Factors:  [100.14850239]
mat_Sqrt:  [[0.15]]
grads:  [0.15593377]
Stock Position:  0.155933765803779
Bond Position:  [-10.79955548]


portfolio before change:  [4.82078803]
curr_Stock_Price:  100.1815961177449
curr_Factors:  [100.18159612]
mat_Sqrt:  [[0.15]]
grads:  [0.12778389]
Stock Position:  0.12778388582172442
Bond Position:  [-7.98080561]


portfolio before change:  [4.8281049]
curr_Stock_Price:  100.2466632327407
curr_Factors:  [100.24666323]
mat_Sqrt:  [[0.15]]
grads:  [-0.09546867]
Stock Position:  -0.0954686677202711
Bond Position:  [14.39852028]


portfolio before change:  [4.8255512]
curr_Stock_Price:  100.2922659514149
curr_Factors:  [100.29226595]
mat_Sqrt:  [[0.15]]
grads:  [0.17417537]
Stock Position:  0.17417536634650252
Bond Position:  [-12.64289097]


portfolio before change:  [4.65498218]
curr_Stock_Price:  99.32204521701182
curr_Factors:  [99.32204522]
mat_Sqrt:  [[0.15]]
grads:  [0.04288937]
Stock Position:  0.042889366733977016
Bond Position:  [0.39512256]


portfolio before change:  [4.63920497]
curr_Stock_Price:  98.95303509454413
curr_Factors:  [98.95303509]
mat_Sqrt:  [[0.15]]
grads:  [-0.07114971]
Stock Position:  -0.07114971375151727
Bond Position:  [11.67968509]


portfolio before change:  [4.72788965]
curr_Stock_Price:  97.727104282565
curr_Factors:  [97.72710428]
mat_Sqrt:  [[0.15]]
grads:  [0.00470672]
Stock Position:  0.004706720674703194
Bond Position:  [4.26791546]


portfolio before change:  [4.72524981]
curr_Stock_Price:  97.05288561945734
curr_Factors:  [97.05288562]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407393]
Stock Position:  -0.040739296932967156
Bond Position:  [8.67911614]


portfolio before change:  [4.68678109]
curr_Stock_Price:  98.02378297370177
curr_Factors:  [98.02378297]
mat_Sqrt:  [[0.15]]
grads:  [0.01790996]
Stock Position:  0.01790996000700728
Bond Position:  [2.93117906]


portfolio before change:  [4.67554007]
curr_Stock_Price:  97.37568328154804
curr_Factors:  [97.37568328]
mat_Sqrt:  [[0.15]]
grads:  [0.01227993]
Stock Position:  0.012279934962287752
Bond Position:  [3.47977301]


portfolio before change:  [4.68020458]
curr_Stock_Price:  97.72010743507221
curr_Factors:  [97.72010744]
mat_Sqrt:  [[0.15]]
grads:  [-0.17836039]
Stock Position:  -0.1783603852636889
Bond Position:  [22.10960059]


portfolio before change:  [4.69843441]
curr_Stock_Price:  97.63339558197302
curr_Factors:  [97.63339558]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689628]
Stock Position:  -0.03689628403649554
Bond Position:  [8.3007439]


portfolio before change:  [4.71864926]
curr_Stock_Price:  97.11363613328187
curr_Factors:  [97.11363613]
mat_Sqrt:  [[0.15]]
grads:  [-0.12367813]
Stock Position:  -0.12367813300765793
Bond Position:  [16.72948247]


portfolio before change:  [4.72019744]
curr_Stock_Price:  97.11802762904725
curr_Factors:  [97.11802763]
mat_Sqrt:  [[0.15]]
grads:  [0.04058609]
Stock Position:  0.040586088866597515
Bond Position:  [0.77855654]


portfolio before change:  [4.69556581]
curr_Stock_Price:  96.50873119599748
curr_Factors:  [96.5087312]
mat_Sqrt:  [[0.15]]
grads:  [-0.06672014]
Stock Position:  -0.0667201392693365
Bond Position:  [11.1346418]


portfolio before change:  [4.6187332]
curr_Stock_Price:  97.68115877219441
curr_Factors:  [97.68115877]
mat_Sqrt:  [[0.15]]
grads:  [0.08918273]
Stock Position:  0.08918272689225193
Bond Position:  [-4.09273891]


portfolio before change:  [4.59934531]
curr_Stock_Price:  97.46950046771498
curr_Factors:  [97.46950047]
mat_Sqrt:  [[0.15]]
grads:  [0.03049733]
Stock Position:  0.030497330255830683
Bond Position:  [1.62678576]


portfolio before change:  [4.60979813]
curr_Stock_Price:  97.80557775353994
curr_Factors:  [97.80557775]
mat_Sqrt:  [[0.15]]
grads:  [0.03982816]
Stock Position:  0.03982815952786527
Bond Position:  [0.71438197]


portfolio before change:  [4.64250672]
curr_Stock_Price:  98.62457851800107
curr_Factors:  [98.62457852]
mat_Sqrt:  [[0.15]]
grads:  [-0.01932749]
Stock Position:  -0.019327489391256246
Bond Position:  [6.54867222]


portfolio before change:  [4.66359808]
curr_Stock_Price:  97.57567233300138
curr_Factors:  [97.57567233]
mat_Sqrt:  [[0.15]]
grads:  [-0.09489]
Stock Position:  -0.09489000266348997
Bond Position:  [13.92255389]


portfolio before change:  [4.60117739]
curr_Stock_Price:  98.25183545524436
curr_Factors:  [98.25183546]
mat_Sqrt:  [[0.15]]
grads:  [-0.09978043]
Stock Position:  -0.0997804310976106
Bond Position:  [14.40478789]


portfolio before change:  [4.68565634]
curr_Stock_Price:  97.42323370023003
curr_Factors:  [97.4232337]
mat_Sqrt:  [[0.15]]
grads:  [0.20724557]
Stock Position:  0.20724556863186616
Bond Position:  [-15.50487712]


portfolio before change:  [4.57028517]
curr_Stock_Price:  96.8758978119574
curr_Factors:  [96.87589781]
mat_Sqrt:  [[0.15]]
grads:  [0.03955934]
Stock Position:  0.039559341599522464
Bond Position:  [0.73793844]


portfolio before change:  [4.60868227]
curr_Stock_Price:  97.8441860651315
curr_Factors:  [97.84418607]
mat_Sqrt:  [[0.15]]
grads:  [-0.07905408]
Stock Position:  -0.07905407822618683
Bond Position:  [12.34366421]


portfolio before change:  [4.69496724]
curr_Stock_Price:  96.772237310174
curr_Factors:  [96.77223731]
mat_Sqrt:  [[0.15]]
grads:  [-0.30969992]
Stock Position:  -0.30969991604626906
Bond Position:  [34.66532101]


portfolio before change:  [4.72372]
curr_Stock_Price:  96.69338897978521
curr_Factors:  [96.69338898]
mat_Sqrt:  [[0.15]]
grads:  [-0.15259602]
Stock Position:  -0.15259601929696778
Bond Position:  [19.47874625]


portfolio before change:  [4.65814093]
curr_Stock_Price:  97.13910219805857
curr_Factors:  [97.1391022]
mat_Sqrt:  [[0.15]]
grads:  [0.26340777]
Stock Position:  0.26340776515662284
Bond Position:  [-20.92905289]


portfolio before change:  [4.62138951]
curr_Stock_Price:  97.00951177035071
curr_Factors:  [97.00951177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00342923]
Stock Position:  -0.0034292316745517205
Bond Position:  [4.9540576]


portfolio before change:  [4.62247867]
curr_Stock_Price:  96.87249424575876
curr_Factors:  [96.87249425]
mat_Sqrt:  [[0.15]]
grads:  [0.02513587]
Stock Position:  0.025135870251978134
Bond Position:  [2.18750423]


portfolio before change:  [4.63149852]
curr_Stock_Price:  97.22045878606676
curr_Factors:  [97.22045879]
mat_Sqrt:  [[0.15]]
grads:  [0.06305387]
Stock Position:  0.06305387441155103
Bond Position:  [-1.49862808]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.68491994]
Stock Price:  98.0706643596678
PL:  [4.68491994]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 4.44348655e-02]
 [-4.53016749e-03]
 [-1.51668577e-02]
 [-7.92547676e-03]
 [-5.97663437e-03]
 [ 4.72396569e-02]
 [ 3.57120880e-03]
 [ 2.41407620e-03]
 [-1.80962378e-02]
 [ 2.34463488e-02]
 [ 2.15816635e-02]
 [-7.51743961e-03]
 [-9.17793226e-03]
 [ 6.72310364e-03]
 [-1.66211027e-02]
 [-8.01684694e-05]
 [-6.08634865e-03]
 [-9.79250147e-03]
 [ 1.77352269e-03]
 [ 2.30885819e-03]
 [-1.54357820e-02]
 [-2.43470765e-02]
 [ 4.23199328e-03]
 [-1.33375266e-02]
 [ 1.03550804e-02]
 [-1.87998248e-03]
 [ 3.36939070e-02]
 [-5.04100663e-03]
 [-4.22701895e-02]
 [-9.49153611e-03]
 [ 4.53194158e-02]
 [-3.89765847e-04]
 [-1.94974027e-02]
 [-3.04996095e-02]
 [-2.34264934e-02]
 [ 3.57817070e-02]
 [-1.36168368e-03]
 [-1.61087765e-03]
 [ 1.72188202e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-35.67083452]
curr_Stock_Price:  98.28941011691505
curr_Factors:  [98.28941012]
mat_Sqrt:  [[0.15]]
grads:  [0.29623244]
Stock Position:  0.29623243661251075
Bond Position:  [-64.78734597]


portfolio before change:  [-35.80174071]
curr_Stock_Price:  97.87484626108771
curr_Factors:  [97.87484626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03020112]
Stock Position:  -0.030201116567385167
Bond Position:  [-32.84581107]


portfolio before change:  [-35.81104987]
curr_Stock_Price:  98.047130769563
curr_Factors:  [98.04713077]
mat_Sqrt:  [[0.15]]
grads:  [-0.10111238]
Stock Position:  -0.10111238471797551
Bond Position:  [-25.89727067]


portfolio before change:  [-35.80782834]
curr_Stock_Price:  97.9832523886393
curr_Factors:  [97.98325239]
mat_Sqrt:  [[0.15]]
grads:  [-0.05283651]
Stock Position:  -0.05283651172910575
Bond Position:  [-30.63073508]


portfolio before change:  [-35.83573073]
curr_Stock_Price:  98.43887119169949
curr_Factors:  [98.43887119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984423]
Stock Position:  -0.03984422913283115
Bond Position:  [-31.91350979]


portfolio before change:  [-35.80555054]
curr_Stock_Price:  97.58129077524696
curr_Factors:  [97.58129078]
mat_Sqrt:  [[0.15]]
grads:  [0.31493105]
Stock Position:  0.3149310462978978
Bond Position:  [-66.53692854]


portfolio before change:  [-35.83311063]
curr_Stock_Price:  97.52019022937628
curr_Factors:  [97.52019023]
mat_Sqrt:  [[0.15]]
grads:  [0.02380806]
Stock Position:  0.023808058680491784
Bond Position:  [-38.15487704]


portfolio before change:  [-35.84870418]
curr_Stock_Price:  97.06555888591237
curr_Factors:  [97.06555889]
mat_Sqrt:  [[0.15]]
grads:  [0.01609384]
Stock Position:  0.01609384134693945
Bond Position:  [-37.41086188]


portfolio before change:  [-35.83290945]
curr_Stock_Price:  98.33755981656708
curr_Factors:  [98.33755982]
mat_Sqrt:  [[0.15]]
grads:  [-0.12064159]
Stock Position:  -0.12064158500196388
Bond Position:  [-23.96931037]


portfolio before change:  [-35.65294752]
curr_Stock_Price:  96.82101576897828
curr_Factors:  [96.82101577]
mat_Sqrt:  [[0.15]]
grads:  [0.15630899]
Stock Position:  0.15630899175867147
Bond Position:  [-50.78694288]


portfolio before change:  [-35.67134152]
curr_Stock_Price:  96.74395534769869
curr_Factors:  [96.74395535]
mat_Sqrt:  [[0.15]]
grads:  [0.14387776]
Stock Position:  0.14387775671654918
Bond Position:  [-49.59064479]


portfolio before change:  [-35.61882716]
curr_Stock_Price:  97.15203498163358
curr_Factors:  [97.15203498]
mat_Sqrt:  [[0.15]]
grads:  [-0.05011626]
Stock Position:  -0.05011626404929555
Bond Position:  [-30.74993012]


portfolio before change:  [-35.63769987]
curr_Stock_Price:  97.4519123442306
curr_Factors:  [97.45191234]
mat_Sqrt:  [[0.15]]
grads:  [-0.06118622]
Stock Position:  -0.06118621508751299
Bond Position:  [-29.6749862]


portfolio before change:  [-35.70498728]
curr_Stock_Price:  98.49099937073288
curr_Factors:  [98.49099937]
mat_Sqrt:  [[0.15]]
grads:  [0.04482069]
Stock Position:  0.04482069090732517
Bond Position:  [-40.11942192]


portfolio before change:  [-35.73917643]
curr_Stock_Price:  97.84009661842508
curr_Factors:  [97.84009662]
mat_Sqrt:  [[0.15]]
grads:  [-0.11080735]
Stock Position:  -0.11080735135866385
Bond Position:  [-24.89777447]


portfolio before change:  [-35.60265304]
curr_Stock_Price:  96.57992921350794
curr_Factors:  [96.57992921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00053446]
Stock Position:  -0.0005344564628885091
Bond Position:  [-35.55103527]


portfolio before change:  [-35.60677023]
curr_Stock_Price:  95.96815256708605
curr_Factors:  [95.96815257]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057566]
Stock Position:  -0.040575657641716514
Bond Position:  [-31.71279932]


portfolio before change:  [-35.5440972]
curr_Stock_Price:  94.32585338015235
curr_Factors:  [94.32585338]
mat_Sqrt:  [[0.15]]
grads:  [-0.06528334]
Stock Position:  -0.06528334314939208
Bond Position:  [-29.38619015]


portfolio before change:  [-35.59515487]
curr_Stock_Price:  95.05167651646799
curr_Factors:  [95.05167652]
mat_Sqrt:  [[0.15]]
grads:  [0.01182348]
Stock Position:  0.011823484621466634
Bond Position:  [-36.7189969]


portfolio before change:  [-35.59584088]
curr_Stock_Price:  95.38187966411276
curr_Factors:  [95.38187966]
mat_Sqrt:  [[0.15]]
grads:  [0.01539239]
Stock Position:  0.015392387914907983
Bond Position:  [-37.06399577]


portfolio before change:  [-35.60170523]
curr_Stock_Price:  95.30190127478598
curr_Factors:  [95.30190127]
mat_Sqrt:  [[0.15]]
grads:  [-0.10290521]
Stock Position:  -0.10290521351993358
Bond Position:  [-25.79464273]


portfolio before change:  [-35.51068918]
curr_Stock_Price:  94.38610142975838
curr_Factors:  [94.38610143]
mat_Sqrt:  [[0.15]]
grads:  [-0.16231384]
Stock Position:  -0.16231384321188863
Bond Position:  [-20.19051831]


portfolio before change:  [-35.52262154]
curr_Stock_Price:  94.44406563451099
curr_Factors:  [94.44406563]
mat_Sqrt:  [[0.15]]
grads:  [0.02821329]
Stock Position:  0.028213288515263203
Bond Position:  [-38.18719922]


portfolio before change:  [-35.55832845]
curr_Stock_Price:  93.34766008198733
curr_Factors:  [93.34766008]
mat_Sqrt:  [[0.15]]
grads:  [-0.08891684]
Stock Position:  -0.08891684424504108
Bond Position:  [-27.2581491]


portfolio before change:  [-35.66436544]
curr_Stock_Price:  94.50187910901924
curr_Factors:  [94.50187911]
mat_Sqrt:  [[0.15]]
grads:  [0.06903387]
Stock Position:  0.06903386940709867
Bond Position:  [-42.18819582]


portfolio before change:  [-35.69599823]
curr_Stock_Price:  94.12005295363974
curr_Factors:  [94.12005295]
mat_Sqrt:  [[0.15]]
grads:  [-0.01253322]
Stock Position:  -0.012533216530653738
Bond Position:  [-34.51637123]


portfolio before change:  [-35.69522887]
curr_Stock_Price:  93.71439642055292
curr_Factors:  [93.71439642]
mat_Sqrt:  [[0.15]]
grads:  [0.22462605]
Stock Position:  0.22462604667616584
Bond Position:  [-56.74592325]


portfolio before change:  [-35.57512573]
curr_Stock_Price:  94.2806567486408
curr_Factors:  [94.28065675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03360671]
Stock Position:  -0.033606710864613865
Bond Position:  [-32.40666296]


portfolio before change:  [-35.58194279]
curr_Stock_Price:  94.36296072357513
curr_Factors:  [94.36296072]
mat_Sqrt:  [[0.15]]
grads:  [-0.28180126]
Stock Position:  -0.28180126348569307
Bond Position:  [-8.99034123]


portfolio before change:  [-35.76730691]
curr_Stock_Price:  95.01675572090008
curr_Factors:  [95.01675572]
mat_Sqrt:  [[0.15]]
grads:  [-0.06327691]
Stock Position:  -0.06327690741461563
Bond Position:  [-29.75494045]


portfolio before change:  [-35.76948558]
curr_Stock_Price:  94.99240367062923
curr_Factors:  [94.99240367]
mat_Sqrt:  [[0.15]]
grads:  [0.30212944]
Stock Position:  0.3021294388535798
Bond Position:  [-64.4694872]


portfolio before change:  [-35.79337373]
curr_Stock_Price:  94.94001234422397
curr_Factors:  [94.94001234]
mat_Sqrt:  [[0.15]]
grads:  [-0.00259844]
Stock Position:  -0.0025984389787726886
Bond Position:  [-35.54667791]


portfolio before change:  [-35.79838698]
curr_Stock_Price:  95.15923270329962
curr_Factors:  [95.1592327]
mat_Sqrt:  [[0.15]]
grads:  [-0.12998268]
Stock Position:  -0.12998268477474964
Bond Position:  [-23.42933443]


portfolio before change:  [-35.79912742]
curr_Stock_Price:  95.14239657045475
curr_Factors:  [95.14239657]
mat_Sqrt:  [[0.15]]
grads:  [-0.20333073]
Stock Position:  -0.2033307301104192
Bond Position:  [-16.45375446]


portfolio before change:  [-35.7978109]
curr_Stock_Price:  95.1258060267868
curr_Factors:  [95.12580603]
mat_Sqrt:  [[0.15]]
grads:  [-0.15617662]
Stock Position:  -0.1561766225113744
Bond Position:  [-20.9413838]


portfolio before change:  [-35.78997189]
curr_Stock_Price:  95.05885078047665
curr_Factors:  [95.05885078]
mat_Sqrt:  [[0.15]]
grads:  [0.23854471]
Stock Position:  0.23854471319623496
Bond Position:  [-58.46575819]


portfolio before change:  [-35.41061382]
curr_Stock_Price:  96.67979113831758
curr_Factors:  [96.67979114]
mat_Sqrt:  [[0.15]]
grads:  [-0.00907789]
Stock Position:  -0.009077891230221444
Bond Position:  [-34.53296519]


portfolio before change:  [-35.40373549]
curr_Stock_Price:  95.44655145576371
curr_Factors:  [95.44655146]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073918]
Stock Position:  -0.010739184348250783
Bond Position:  [-34.37871738]


portfolio before change:  [-35.41375075]
curr_Stock_Price:  95.9789616701381
curr_Factors:  [95.97896167]
mat_Sqrt:  [[0.15]]
grads:  [0.11479213]
Stock Position:  0.11479213498181351
Bond Position:  [-46.43138068]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-35.42179454]
Stock Price:  95.95945244757361
PL:  [-35.42179454]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-8.88875374e-03]
 [ 3.21651067e-02]
 [-1.59135524e-02]
 [-7.24577417e-03]
 [-6.30307879e-03]
 [ 3.53662051e-02]
 [ 3.57940211e-03]
 [ 2.71461590e-03]
 [ 2.28001776e-02]
 [ 2.34185397e-02]
 [ 2.15384077e-02]
 [-6.49128717e-03]
 [-6.61385600e-03]
 [ 1.00199299e-02]
 [-1.71367533e-02]
 [-4.55832384e-04]
 [-6.11353551e-03]
 [ 3.96447339e-03]
 [ 5.33096230e-03]
 [-1.63916687e-03]
 [-4.83703587e-03]
 [-5.94397843e-03]
 [ 6.89505968e-03]
 [-6.36769773e-03]
 [ 1.28981899e-02]
 [ 4.60985385e-03]
 [ 4.01681040e-03]
 [-3.66851404e-03]
 [-1.30184505e-02]
 [-1.31178134e-02]
 [ 3.26631450e-02]
 [ 1.10817882e-02]
 [-1.08995329e-02]
 [-5.03149629e-02]
 [-2.28801071e-02]
 [ 3.87233104e-02]
 [ 2.38036485e-03]
 [ 6.93582733e-03]
 [ 5.25794435e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.05934765]
curr_Stock_Price:  99.36482011284751
curr_Factors:  [99.36482011]
mat_Sqrt:  [[0.15]]
grads:  [-0.05925836]
Stock Position:  -0.059258358271649325
Bond Position:  [-6.17115154]


portfolio before change:  [-12.06670107]
curr_Stock_Price:  99.47589269666517
curr_Factors:  [99.4758927]
mat_Sqrt:  [[0.15]]
grads:  [0.21443404]
Stock Position:  0.21443404433402796
Bond Position:  [-33.39771905]


portfolio before change:  [-12.16732228]
curr_Stock_Price:  99.0261216141435
curr_Factors:  [99.02612161]
mat_Sqrt:  [[0.15]]
grads:  [-0.10609035]
Stock Position:  -0.106090349005576
Bond Position:  [-1.66160647]


portfolio before change:  [-12.1453204]
curr_Stock_Price:  98.81677558654344
curr_Factors:  [98.81677559]
mat_Sqrt:  [[0.15]]
grads:  [-0.04830516]
Stock Position:  -0.04830516111879749
Bond Position:  [-7.37196013]


portfolio before change:  [-12.14466173]
curr_Stock_Price:  98.78406237136835
curr_Factors:  [98.78406237]
mat_Sqrt:  [[0.15]]
grads:  [-0.04202053]
Stock Position:  -0.04202052529939541
Bond Position:  [-7.99370354]


portfolio before change:  [-12.1385978]
curr_Stock_Price:  98.61597293377233
curr_Factors:  [98.61597293]
mat_Sqrt:  [[0.15]]
grads:  [0.2357747]
Stock Position:  0.23577470063678757
Bond Position:  [-35.3897493]


portfolio before change:  [-12.28053453]
curr_Stock_Price:  98.03273506547124
curr_Factors:  [98.03273507]
mat_Sqrt:  [[0.15]]
grads:  [0.02386268]
Stock Position:  0.023862680708714917
Bond Position:  [-14.61985839]


portfolio before change:  [-12.30750311]
curr_Stock_Price:  96.9791660317464
curr_Factors:  [96.97916603]
mat_Sqrt:  [[0.15]]
grads:  [0.01809744]
Stock Position:  0.018097439340745734
Bond Position:  [-14.06257768]


portfolio before change:  [-12.30850282]
curr_Stock_Price:  97.02106265079247
curr_Factors:  [97.02106265]
mat_Sqrt:  [[0.15]]
grads:  [0.15200118]
Stock Position:  0.152001183873509
Bond Position:  [-27.0558192]


portfolio before change:  [-12.39655363]
curr_Stock_Price:  96.46403661496863
curr_Factors:  [96.46403661]
mat_Sqrt:  [[0.15]]
grads:  [0.1561236]
Stock Position:  0.15612359824428435
Bond Position:  [-27.45686612]


portfolio before change:  [-12.33860731]
curr_Stock_Price:  96.85717794347993
curr_Factors:  [96.85717794]
mat_Sqrt:  [[0.15]]
grads:  [0.14358938]
Stock Position:  0.1435893849038926
Bond Position:  [-26.24626991]


portfolio before change:  [-12.33961625]
curr_Stock_Price:  96.87300115201558
curr_Factors:  [96.87300115]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327525]
Stock Position:  -0.04327524780640355
Bond Position:  [-8.14741312]


portfolio before change:  [-12.37551579]
curr_Stock_Price:  97.67902879389509
curr_Factors:  [97.67902879]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409237]
Stock Position:  -0.04409237332147269
Bond Position:  [-8.06861559]


portfolio before change:  [-12.3791658]
curr_Stock_Price:  97.73893411946175
curr_Factors:  [97.73893412]
mat_Sqrt:  [[0.15]]
grads:  [0.06679953]
Stock Position:  0.06679953243733285
Bond Position:  [-18.9080809]


portfolio before change:  [-12.3941344]
curr_Stock_Price:  97.5502360807295
curr_Factors:  [97.55023608]
mat_Sqrt:  [[0.15]]
grads:  [-0.11424502]
Stock Position:  -0.11424502226905227
Bond Position:  [-1.2495055]


portfolio before change:  [-12.54621343]
curr_Stock_Price:  98.88003441719954
curr_Factors:  [98.88003442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00303888]
Stock Position:  -0.0030388825582302464
Bond Position:  [-12.24572862]


portfolio before change:  [-12.55144433]
curr_Stock_Price:  100.0976152006967
curr_Factors:  [100.0976152]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407569]
Stock Position:  -0.04075690343128338
Bond Position:  [-8.47177549]


portfolio before change:  [-12.51106577]
curr_Stock_Price:  99.08091385109269
curr_Factors:  [99.08091385]
mat_Sqrt:  [[0.15]]
grads:  [0.02642982]
Stock Position:  0.026429822575862016
Bond Position:  [-15.12975674]


portfolio before change:  [-12.51179168]
curr_Stock_Price:  99.12500905199765
curr_Factors:  [99.12500905]
mat_Sqrt:  [[0.15]]
grads:  [0.03553975]
Stock Position:  0.03553974863945445
Bond Position:  [-16.03466959]


portfolio before change:  [-12.47259076]
curr_Stock_Price:  100.28442581939706
curr_Factors:  [100.28442582]
mat_Sqrt:  [[0.15]]
grads:  [-0.01092778]
Stock Position:  -0.010927779158717022
Bond Position:  [-11.3767047]


portfolio before change:  [-12.47434118]
curr_Stock_Price:  100.3144634886421
curr_Factors:  [100.31446349]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224691]
Stock Position:  -0.03224690582970288
Bond Position:  [-9.23951012]


portfolio before change:  [-12.45821274]
curr_Stock_Price:  99.77849095475487
curr_Factors:  [99.77849095]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962652]
Stock Position:  -0.03962652284419085
Bond Position:  [-8.50433808]


portfolio before change:  [-12.47833263]
curr_Stock_Price:  100.2594008695077
curr_Factors:  [100.25940087]
mat_Sqrt:  [[0.15]]
grads:  [0.04596706]
Stock Position:  0.045967064565955965
Bond Position:  [-17.08696299]


portfolio before change:  [-12.53559812]
curr_Stock_Price:  99.06007520518915
curr_Factors:  [99.06007521]
mat_Sqrt:  [[0.15]]
grads:  [-0.04245132]
Stock Position:  -0.04245131820202761
Bond Position:  [-8.33036734]


portfolio before change:  [-12.45988249]
curr_Stock_Price:  97.25195725099393
curr_Factors:  [97.25195725]
mat_Sqrt:  [[0.15]]
grads:  [0.08598793]
Stock Position:  0.08598793261539048
Bond Position:  [-20.82237723]


portfolio before change:  [-12.44250324]
curr_Stock_Price:  97.48434110311075
curr_Factors:  [97.4843411]
mat_Sqrt:  [[0.15]]
grads:  [0.03073236]
Stock Position:  0.030732358983426505
Bond Position:  [-15.43842701]


portfolio before change:  [-12.4288281]
curr_Stock_Price:  97.99211429218103
curr_Factors:  [97.99211429]
mat_Sqrt:  [[0.15]]
grads:  [0.02677874]
Stock Position:  0.026778735998294185
Bond Position:  [-15.05293305]


portfolio before change:  [-12.44483298]
curr_Stock_Price:  97.46471256752208
curr_Factors:  [97.46471257]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445676]
Stock Position:  -0.02445676029863643
Bond Position:  [-10.06116187]


portfolio before change:  [-12.45296973]
curr_Stock_Price:  97.74598535597869
curr_Factors:  [97.74598536]
mat_Sqrt:  [[0.15]]
grads:  [-0.08678967]
Stock Position:  -0.0867896701999855
Bond Position:  [-3.96962789]


portfolio before change:  [-12.40332408]
curr_Stock_Price:  97.16824517522937
curr_Factors:  [97.16824518]
mat_Sqrt:  [[0.15]]
grads:  [-0.08745209]
Stock Position:  -0.08745208948127277
Bond Position:  [-3.90575801]


portfolio before change:  [-12.41843929]
curr_Stock_Price:  97.33550202908324
curr_Factors:  [97.33550203]
mat_Sqrt:  [[0.15]]
grads:  [0.2177543]
Stock Position:  0.21775430002827562
Bond Position:  [-33.6136634]


portfolio before change:  [-12.20214756]
curr_Stock_Price:  98.34808225494213
curr_Factors:  [98.34808225]
mat_Sqrt:  [[0.15]]
grads:  [0.07387859]
Stock Position:  0.07387858822526748
Bond Position:  [-19.46796504]


portfolio before change:  [-12.21033663]
curr_Stock_Price:  98.27017846735005
curr_Factors:  [98.27017847]
mat_Sqrt:  [[0.15]]
grads:  [-0.07266355]
Stock Position:  -0.07266355247952785
Bond Position:  [-5.06967636]


portfolio before change:  [-12.14075886]
curr_Stock_Price:  97.30392346230995
curr_Factors:  [97.30392346]
mat_Sqrt:  [[0.15]]
grads:  [-0.33543309]
Stock Position:  -0.33543308598353305
Bond Position:  [20.49819646]


portfolio before change:  [-11.94250364]
curr_Stock_Price:  96.7205201196677
curr_Factors:  [96.72052012]
mat_Sqrt:  [[0.15]]
grads:  [-0.15253405]
Stock Position:  -0.15253404755474648
Bond Position:  [2.81066877]


portfolio before change:  [-12.07079274]
curr_Stock_Price:  97.5638757903365
curr_Factors:  [97.56387579]
mat_Sqrt:  [[0.15]]
grads:  [0.2581554]
Stock Position:  0.25815540250085894
Bond Position:  [-37.25743437]


portfolio before change:  [-11.9277574]
curr_Stock_Price:  98.13598393901552
curr_Factors:  [98.13598394]
mat_Sqrt:  [[0.15]]
grads:  [0.0158691]
Stock Position:  0.015869098977335093
Bond Position:  [-13.48508705]


portfolio before change:  [-11.93243637]
curr_Stock_Price:  97.9473642597799
curr_Factors:  [97.94736426]
mat_Sqrt:  [[0.15]]
grads:  [0.04623885]
Stock Position:  0.046238848888952196
Bond Position:  [-16.46140974]


portfolio before change:  [-11.92722627]
curr_Stock_Price:  98.10454608614124
curr_Factors:  [98.10454609]
mat_Sqrt:  [[0.15]]
grads:  [0.03505296]
Stock Position:  0.0350529623330679
Bond Position:  [-15.36608123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.92431936]
Stock Price:  98.2422744440355
PL:  [-11.92431936]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.18704049e-02]
 [ 4.41544584e-02]
 [-2.77160022e-03]
 [ 2.39964363e-03]
 [-3.21054457e-04]
 [ 2.02759454e-02]
 [ 3.60140625e-03]
 [-1.36898132e-03]
 [-2.71093878e-02]
 [ 2.34404558e-02]
 [ 2.00462897e-02]
 [-1.38048194e-02]
 [ 5.44285944e-03]
 [ 5.35876483e-03]
 [ 8.47217177e-03]
 [-2.78942302e-03]
 [-5.96595545e-03]
 [ 5.53265289e-03]
 [ 6.28477791e-03]
 [-2.80475609e-03]
 [-4.15572168e-03]
 [-1.18138437e-02]
 [ 6.16958484e-03]
 [-9.70219389e-03]
 [ 1.32046970e-02]
 [ 2.34151692e-03]
 [ 1.86517345e-02]
 [-4.52662875e-03]
 [-3.11156445e-02]
 [-9.61868619e-03]
 [ 4.33906699e-02]
 [ 4.53386107e-03]
 [-1.58194772e-02]
 [-4.65666596e-02]
 [-2.32164706e-02]
 [ 3.93382458e-02]
 [ 8.77873190e-05]
 [ 6.69608925e-03]
 [ 5.92406815e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.6342799]
curr_Stock_Price:  100.89943180651252
curr_Factors:  [100.89943181]
mat_Sqrt:  [[0.15]]
grads:  [-0.27913603]
Stock Position:  -0.2791360325584339
Bond Position:  [49.79894698]


portfolio before change:  [21.7920716]
curr_Stock_Price:  100.35644764683154
curr_Factors:  [100.35644765]
mat_Sqrt:  [[0.15]]
grads:  [0.29436306]
Stock Position:  0.29436305620105924
Bond Position:  [-7.74915904]


portfolio before change:  [21.80805557]
curr_Stock_Price:  100.41403869050073
curr_Factors:  [100.41403869]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847733]
Stock Position:  -0.018477334799535616
Bond Position:  [23.66343938]


portfolio before change:  [21.77617665]
curr_Stock_Price:  102.29943143049448
curr_Factors:  [102.29943143]
mat_Sqrt:  [[0.15]]
grads:  [0.01599762]
Stock Position:  0.0159976242061833
Bond Position:  [20.13962879]


portfolio before change:  [21.78067908]
curr_Stock_Price:  102.42350103156572
curr_Factors:  [102.42350103]
mat_Sqrt:  [[0.15]]
grads:  [-0.00214036]
Stock Position:  -0.0021403630445012505
Bond Position:  [21.99990256]


portfolio before change:  [21.78467803]
curr_Stock_Price:  101.8400525114926
curr_Factors:  [101.84005251]
mat_Sqrt:  [[0.15]]
grads:  [0.13517297]
Stock Position:  0.13517296966091358
Bond Position:  [8.0186557]


portfolio before change:  [21.49903572]
curr_Stock_Price:  99.71947540382122
curr_Factors:  [99.7194754]
mat_Sqrt:  [[0.15]]
grads:  [0.02400937]
Stock Position:  0.024009374983581848
Bond Position:  [19.10483344]


portfolio before change:  [21.49633851]
curr_Stock_Price:  99.50766374321644
curr_Factors:  [99.50766374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912654]
Stock Position:  -0.00912654214735193
Bond Position:  [22.4044994]


portfolio before change:  [21.49481015]
curr_Stock_Price:  99.98200491718657
curr_Factors:  [99.98200492]
mat_Sqrt:  [[0.15]]
grads:  [-0.18072925]
Stock Position:  -0.18072925214982083
Bond Position:  [39.56448313]


portfolio before change:  [21.73272476]
curr_Stock_Price:  98.69295660124178
curr_Factors:  [98.6929566]
mat_Sqrt:  [[0.15]]
grads:  [0.15626971]
Stock Position:  0.15626970560485184
Bond Position:  [6.31000549]


portfolio before change:  [21.80151744]
curr_Stock_Price:  99.12812657949361
curr_Factors:  [99.12812658]
mat_Sqrt:  [[0.15]]
grads:  [0.13364193]
Stock Position:  0.1336419313950461
Bond Position:  [8.55384315]


portfolio before change:  [21.76610585]
curr_Stock_Price:  98.85515167748132
curr_Factors:  [98.85515168]
mat_Sqrt:  [[0.15]]
grads:  [-0.09203213]
Stock Position:  -0.09203212915521372
Bond Position:  [30.86395593]


portfolio before change:  [21.78870457]
curr_Stock_Price:  98.65152182172807
curr_Factors:  [98.65152182]
mat_Sqrt:  [[0.15]]
grads:  [0.03628573]
Stock Position:  0.0362857295721385
Bond Position:  [18.20906213]


portfolio before change:  [21.84586138]
curr_Stock_Price:  100.16397674792088
curr_Factors:  [100.16397675]
mat_Sqrt:  [[0.15]]
grads:  [0.0357251]
Stock Position:  0.035725098848029685
Bond Position:  [18.26749341]


portfolio before change:  [21.86155725]
curr_Stock_Price:  100.53940728308007
curr_Factors:  [100.53940728]
mat_Sqrt:  [[0.15]]
grads:  [0.05648115]
Stock Position:  0.056481145105668415
Bond Position:  [16.1829764]


portfolio before change:  [21.93554376]
curr_Stock_Price:  101.81352294423955
curr_Factors:  [101.81352294]
mat_Sqrt:  [[0.15]]
grads:  [-0.01859615]
Stock Position:  -0.01859615343620868
Bond Position:  [23.82888366]


portfolio before change:  [21.94833938]
curr_Stock_Price:  101.28562738880292
curr_Factors:  [101.28562739]
mat_Sqrt:  [[0.15]]
grads:  [-0.03977304]
Stock Position:  -0.03977303634823276
Bond Position:  [25.97677632]


portfolio before change:  [21.98636432]
curr_Stock_Price:  100.4112250902778
curr_Factors:  [100.41122509]
mat_Sqrt:  [[0.15]]
grads:  [0.03688435]
Stock Position:  0.03688435261216409
Bond Position:  [18.28276129]


portfolio before change:  [21.96992762]
curr_Stock_Price:  99.90363359780288
curr_Factors:  [99.9036336]
mat_Sqrt:  [[0.15]]
grads:  [0.04189852]
Stock Position:  0.0418985194177961
Bond Position:  [17.78411329]


portfolio before change:  [21.98589411]
curr_Stock_Price:  100.23164827842783
curr_Factors:  [100.23164828]
mat_Sqrt:  [[0.15]]
grads:  [-0.01869837]
Stock Position:  -0.018698373953117468
Bond Position:  [23.86006295]


portfolio before change:  [21.99679466]
curr_Stock_Price:  99.80819665489734
curr_Factors:  [99.80819665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02770481]
Stock Position:  -0.02770481117733166
Bond Position:  [24.7619619]


portfolio before change:  [22.03583033]
curr_Stock_Price:  98.51094046934581
curr_Factors:  [98.51094047]
mat_Sqrt:  [[0.15]]
grads:  [-0.07875896]
Stock Position:  -0.07875895781335454
Bond Position:  [29.79444934]


portfolio before change:  [22.14064561]
curr_Stock_Price:  97.22739450542649
curr_Factors:  [97.22739451]
mat_Sqrt:  [[0.15]]
grads:  [0.04113057]
Stock Position:  0.041130565618899544
Bond Position:  [18.14162788]


portfolio before change:  [22.12626471]
curr_Stock_Price:  96.82261638139542
curr_Factors:  [96.82261638]
mat_Sqrt:  [[0.15]]
grads:  [-0.06468129]
Stock Position:  -0.06468129262676799
Bond Position:  [28.38887669]


portfolio before change:  [22.08152166]
curr_Stock_Price:  97.5692290881435
curr_Factors:  [97.56922909]
mat_Sqrt:  [[0.15]]
grads:  [0.08803131]
Stock Position:  0.08803131301185296
Bond Position:  [13.49237432]


portfolio before change:  [21.99162037]
curr_Stock_Price:  96.5288271961615
curr_Factors:  [96.5288272]
mat_Sqrt:  [[0.15]]
grads:  [0.01561011]
Stock Position:  0.0156101128080929
Bond Position:  [20.48479449]


portfolio before change:  [21.99294064]
curr_Stock_Price:  96.44936024671179
curr_Factors:  [96.44936025]
mat_Sqrt:  [[0.15]]
grads:  [0.1243449]
Stock Position:  0.12434489659299784
Bond Position:  [9.99995492]


portfolio before change:  [21.87267117]
curr_Stock_Price:  95.47208213819151
curr_Factors:  [95.47208214]
mat_Sqrt:  [[0.15]]
grads:  [-0.03017752]
Stock Position:  -0.03017752499704892
Bond Position:  [24.75378231]


portfolio before change:  [21.87408521]
curr_Stock_Price:  95.52776517447568
curr_Factors:  [95.52776517]
mat_Sqrt:  [[0.15]]
grads:  [-0.20743763]
Stock Position:  -0.20743762972737853
Bond Position:  [41.69013839]


portfolio before change:  [21.95648153]
curr_Stock_Price:  95.15567873556674
curr_Factors:  [95.15567874]
mat_Sqrt:  [[0.15]]
grads:  [-0.06412457]
Stock Position:  -0.0641245746152295
Bond Position:  [28.05829895]


portfolio before change:  [21.94163654]
curr_Stock_Price:  95.44187949322288
curr_Factors:  [95.44187949]
mat_Sqrt:  [[0.15]]
grads:  [0.28927113]
Stock Position:  0.2892711324249738
Bond Position:  [-5.66694403]


portfolio before change:  [22.22387099]
curr_Stock_Price:  96.42000289709046
curr_Factors:  [96.4200029]
mat_Sqrt:  [[0.15]]
grads:  [0.03022574]
Stock Position:  0.030225740499127147
Bond Position:  [19.309505]


portfolio before change:  [22.22607785]
curr_Stock_Price:  96.41315511218636
curr_Factors:  [96.41315511]
mat_Sqrt:  [[0.15]]
grads:  [-0.10546318]
Stock Position:  -0.10546318124699475
Bond Position:  [32.3941159]


portfolio before change:  [22.19099281]
curr_Stock_Price:  96.78422825237853
curr_Factors:  [96.78422825]
mat_Sqrt:  [[0.15]]
grads:  [-0.3104444]
Stock Position:  -0.3104443974332643
Bond Position:  [52.23711423]


portfolio before change:  [22.52207311]
curr_Stock_Price:  95.73879064084277
curr_Factors:  [95.73879064]
mat_Sqrt:  [[0.15]]
grads:  [-0.15477647]
Stock Position:  -0.15477647033743533
Bond Position:  [37.3401852]


portfolio before change:  [22.37952146]
curr_Stock_Price:  96.68996533092064
curr_Factors:  [96.68996533]
mat_Sqrt:  [[0.15]]
grads:  [0.26225497]
Stock Position:  0.26225497173278123
Bond Position:  [-2.97790266]


portfolio before change:  [22.52440636]
curr_Stock_Price:  97.243842946467
curr_Factors:  [97.24384295]
mat_Sqrt:  [[0.15]]
grads:  [0.00058525]
Stock Position:  0.0005852487933482246
Bond Position:  [22.46749452]


portfolio before change:  [22.52744384]
curr_Stock_Price:  97.63490711672515
curr_Factors:  [97.63490712]
mat_Sqrt:  [[0.15]]
grads:  [0.0446406]
Stock Position:  0.044640595007131655
Bond Position:  [18.16896349]


portfolio before change:  [22.54344102]
curr_Stock_Price:  97.94238323004154
curr_Factors:  [97.94238323]
mat_Sqrt:  [[0.15]]
grads:  [0.03949379]
Stock Position:  0.03949378768060444
Bond Position:  [18.67532533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.54917254]
Stock Price:  98.02839566399955
PL:  [22.54917254]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.69100620e-03]
 [ 3.09256040e-02]
 [-4.97175441e-03]
 [-6.65427255e-03]
 [-6.33361245e-03]
 [ 4.25506535e-02]
 [ 3.57449278e-03]
 [-1.21150075e-03]
 [-2.73537757e-02]
 [ 2.34428633e-02]
 [ 2.14079929e-02]
 [-5.46416989e-03]
 [-1.17129450e-02]
 [ 1.00022873e-02]
 [-1.83385358e-02]
 [ 7.05601468e-04]
 [-6.07331435e-03]
 [-6.64940386e-03]
 [ 1.45792361e-03]
 [-6.52523391e-03]
 [-5.73192706e-03]
 [-1.94466845e-02]
 [ 4.67370643e-03]
 [-1.11619594e-02]
 [ 1.18498328e-02]
 [ 1.75667231e-03]
 [ 1.71897857e-02]
 [-4.09889845e-03]
 [-1.96000353e-02]
 [-1.49536333e-02]
 [ 2.51650531e-02]
 [ 3.79415036e-03]
 [-1.75501715e-02]
 [-3.38599303e-02]
 [-2.32778935e-02]
 [ 3.54454518e-02]
 [-5.86936546e-03]
 [-5.41387880e-03]
 [ 3.49935843e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.22355655]
curr_Stock_Price:  99.22070289143443
curr_Factors:  [99.22070289]
mat_Sqrt:  [[0.15]]
grads:  [-0.01794004]
Stock Position:  -0.017940041339176614
Bond Position:  [-13.44353304]


portfolio before change:  [-15.22760637]
curr_Stock_Price:  99.35276941653059
curr_Factors:  [99.35276942]
mat_Sqrt:  [[0.15]]
grads:  [0.20617069]
Stock Position:  0.20617069365363372
Bond Position:  [-35.71123576]


portfolio before change:  [-15.18852999]
curr_Stock_Price:  99.56395641070452
curr_Factors:  [99.56395641]
mat_Sqrt:  [[0.15]]
grads:  [-0.03314503]
Stock Position:  -0.033145029416314115
Bond Position:  [-11.88847972]


portfolio before change:  [-15.19828197]
curr_Stock_Price:  99.8133400682915
curr_Factors:  [99.81334007]
mat_Sqrt:  [[0.15]]
grads:  [-0.04436182]
Stock Position:  -0.044361817010012294
Bond Position:  [-10.77038084]


portfolio before change:  [-15.15923577]
curr_Stock_Price:  98.90281417467219
curr_Factors:  [98.90281417]
mat_Sqrt:  [[0.15]]
grads:  [-0.04222408]
Stock Position:  -0.04222408300046609
Bond Position:  [-10.98315513]


portfolio before change:  [-15.12339326]
curr_Stock_Price:  98.02143365248685
curr_Factors:  [98.02143365]
mat_Sqrt:  [[0.15]]
grads:  [0.28367102]
Stock Position:  0.2836710230087744
Bond Position:  [-42.92923363]


portfolio before change:  [-15.08509121]
curr_Stock_Price:  98.17537446950949
curr_Factors:  [98.17537447]
mat_Sqrt:  [[0.15]]
grads:  [0.02382995]
Stock Position:  0.02382995186291662
Bond Position:  [-17.42460565]


portfolio before change:  [-15.06502001]
curr_Stock_Price:  99.10904836056774
curr_Factors:  [99.10904836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00807667]
Stock Position:  -0.008076671685110474
Bond Position:  [-14.26454877]


portfolio before change:  [-15.06695299]
curr_Stock_Price:  99.12759528522442
curr_Factors:  [99.12759529]
mat_Sqrt:  [[0.15]]
grads:  [-0.1823585]
Stock Position:  -0.18235850460148526
Bond Position:  [3.00980705]


portfolio before change:  [-14.84786004]
curr_Stock_Price:  97.928217733078
curr_Factors:  [97.92821773]
mat_Sqrt:  [[0.15]]
grads:  [0.15628576]
Stock Position:  0.1562857550698182
Bond Position:  [-30.1526455]


portfolio before change:  [-14.96566751]
curr_Stock_Price:  97.19854054375394
curr_Factors:  [97.19854054]
mat_Sqrt:  [[0.15]]
grads:  [0.14271995]
Stock Position:  0.1427199528692803
Bond Position:  [-28.83783864]


portfolio before change:  [-15.07969106]
curr_Stock_Price:  96.4248674042209
curr_Factors:  [96.4248674]
mat_Sqrt:  [[0.15]]
grads:  [-0.0364278]
Stock Position:  -0.036427799297091
Bond Position:  [-11.56714534]


portfolio before change:  [-15.11037046]
curr_Stock_Price:  97.22737023197004
curr_Factors:  [97.22737023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0780863]
Stock Position:  -0.0780863002309046
Bond Position:  [-7.51824483]


portfolio before change:  [-15.15144205]
curr_Stock_Price:  97.74131121791699
curr_Factors:  [97.74131122]
mat_Sqrt:  [[0.15]]
grads:  [0.06668192]
Stock Position:  0.06668191536650228
Bond Position:  [-21.66901989]


portfolio before change:  [-15.21193926]
curr_Stock_Price:  96.87468313018401
curr_Factors:  [96.87468313]
mat_Sqrt:  [[0.15]]
grads:  [-0.12225691]
Stock Position:  -0.12225690531109056
Bond Position:  [-3.3683403]


portfolio before change:  [-15.32805231]
curr_Stock_Price:  97.8209853150783
curr_Factors:  [97.82098532]
mat_Sqrt:  [[0.15]]
grads:  [0.00470401]
Stock Position:  0.004704009788111706
Bond Position:  [-15.78820318]


portfolio before change:  [-15.33058527]
curr_Stock_Price:  97.70208418288429
curr_Factors:  [97.70208418]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048876]
Stock Position:  -0.04048876233283857
Bond Position:  [-11.3747488]


portfolio before change:  [-15.22785673]
curr_Stock_Price:  95.12975373750348
curr_Factors:  [95.12975374]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432936]
Stock Position:  -0.04432935907988967
Bond Position:  [-11.01081571]


portfolio before change:  [-15.25492278]
curr_Stock_Price:  95.70927080937355
curr_Factors:  [95.70927081]
mat_Sqrt:  [[0.15]]
grads:  [0.00971949]
Stock Position:  0.009719490749603566
Bond Position:  [-16.18516816]


portfolio before change:  [-15.25340587]
curr_Stock_Price:  96.07350615298856
curr_Factors:  [96.07350615]
mat_Sqrt:  [[0.15]]
grads:  [-0.04350156]
Stock Position:  -0.043501559422843436
Bond Position:  [-11.07405854]


portfolio before change:  [-15.32035411]
curr_Stock_Price:  97.58066803545984
curr_Factors:  [97.58066804]
mat_Sqrt:  [[0.15]]
grads:  [-0.03821285]
Stock Position:  -0.038212847093294644
Bond Position:  [-11.59151896]


portfolio before change:  [-15.28978899]
curr_Stock_Price:  96.74288300180994
curr_Factors:  [96.742883]
mat_Sqrt:  [[0.15]]
grads:  [-0.12964456]
Stock Position:  -0.12964456365685062
Bond Position:  [-2.74760014]


portfolio before change:  [-15.12973664]
curr_Stock_Price:  95.50568630961554
curr_Factors:  [95.50568631]
mat_Sqrt:  [[0.15]]
grads:  [0.03115804]
Stock Position:  0.031158042868578754
Bond Position:  [-18.1055069]


portfolio before change:  [-15.13764887]
curr_Stock_Price:  95.3243877212689
curr_Factors:  [95.32438772]
mat_Sqrt:  [[0.15]]
grads:  [-0.07441306]
Stock Position:  -0.07441306276311958
Bond Position:  [-8.04426923]


portfolio before change:  [-15.18721728]
curr_Stock_Price:  95.97699907142128
curr_Factors:  [95.97699907]
mat_Sqrt:  [[0.15]]
grads:  [0.07899889]
Stock Position:  0.07899888502484106
Bond Position:  [-22.7692932]


portfolio before change:  [-15.16593235]
curr_Stock_Price:  96.28246244456338
curr_Factors:  [96.28246244]
mat_Sqrt:  [[0.15]]
grads:  [0.01171115]
Stock Position:  0.011711148755998378
Bond Position:  [-16.29351059]


portfolio before change:  [-15.16290165]
curr_Stock_Price:  96.71517138964731
curr_Factors:  [96.71517139]
mat_Sqrt:  [[0.15]]
grads:  [0.11459857]
Stock Position:  0.11459857129847456
Bond Position:  [-26.24632212]


portfolio before change:  [-15.19510285]
curr_Stock_Price:  96.46281047052022
curr_Factors:  [96.46281047]
mat_Sqrt:  [[0.15]]
grads:  [-0.02732599]
Stock Position:  -0.027325989663309763
Bond Position:  [-12.55916109]


portfolio before change:  [-15.2065276]
curr_Stock_Price:  96.82344741843242
curr_Factors:  [96.82344742]
mat_Sqrt:  [[0.15]]
grads:  [-0.1306669]
Stock Position:  -0.13066690209737522
Bond Position:  [-2.55490768]


portfolio before change:  [-15.39188894]
curr_Stock_Price:  98.23958226925473
curr_Factors:  [98.23958227]
mat_Sqrt:  [[0.15]]
grads:  [-0.09969089]
Stock Position:  -0.09969088885246848
Bond Position:  [-5.59829766]


portfolio before change:  [-15.34336449]
curr_Stock_Price:  97.74581317365319
curr_Factors:  [97.74581317]
mat_Sqrt:  [[0.15]]
grads:  [0.16776702]
Stock Position:  0.1677670206566243
Bond Position:  [-31.74188835]


portfolio before change:  [-15.61017008]
curr_Stock_Price:  96.17913098329724
curr_Factors:  [96.17913098]
mat_Sqrt:  [[0.15]]
grads:  [0.02529434]
Stock Position:  0.025294335725088768
Bond Position:  [-18.04295731]


portfolio before change:  [-15.62132439]
curr_Stock_Price:  95.82732102275689
curr_Factors:  [95.82732102]
mat_Sqrt:  [[0.15]]
grads:  [-0.11700114]
Stock Position:  -0.11700114341127305
Bond Position:  [-4.40941826]


portfolio before change:  [-15.57833133]
curr_Stock_Price:  95.4551514220943
curr_Factors:  [95.45515142]
mat_Sqrt:  [[0.15]]
grads:  [-0.22573287]
Stock Position:  -0.225732868508879
Bond Position:  [5.96903381]


portfolio before change:  [-15.60114413]
curr_Stock_Price:  95.55951801856892
curr_Factors:  [95.55951802]
mat_Sqrt:  [[0.15]]
grads:  [-0.15518596]
Stock Position:  -0.1551859568825276
Bond Position:  [-0.77164888]


portfolio before change:  [-15.4996121]
curr_Stock_Price:  94.90463602461014
curr_Factors:  [94.90463602]
mat_Sqrt:  [[0.15]]
grads:  [0.23630301]
Stock Position:  0.23630301182048
Bond Position:  [-37.92586343]


portfolio before change:  [-15.51896458]
curr_Stock_Price:  94.84280248097423
curr_Factors:  [94.84280248]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391291]
Stock Position:  -0.03912910305515559
Bond Position:  [-11.80785079]


portfolio before change:  [-15.50165291]
curr_Stock_Price:  94.36265492909496
curr_Factors:  [94.36265493]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609253]
Stock Position:  -0.03609252533694761
Bond Position:  [-12.0958664]


portfolio before change:  [-15.47011372]
curr_Stock_Price:  93.44691755167534
curr_Factors:  [93.44691755]
mat_Sqrt:  [[0.15]]
grads:  [0.23329056]
Stock Position:  0.23329056214050445
Bond Position:  [-37.27039764]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.39936057]
Stock Price:  93.77017209140718
PL:  [-15.39936057]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.34144365e-02]
 [ 4.16773640e-02]
 [-3.44905508e-03]
 [-4.86786339e-03]
 [-4.86389665e-03]
 [ 3.20132980e-02]
 [ 3.74397975e-03]
 [-1.29025457e-03]
 [-2.77323750e-02]
 [ 2.34411506e-02]
 [ 1.96632644e-02]
 [-1.51305239e-02]
 [ 3.19772061e-02]
 [ 6.05726538e-03]
 [ 2.83959089e-03]
 [-3.31619924e-03]
 [-6.09316859e-03]
 [ 6.76351867e-03]
 [ 9.20949651e-03]
 [ 1.54561508e-02]
 [-3.30741126e-04]
 [-4.23232659e-03]
 [ 5.39766277e-03]
 [-7.74644472e-03]
 [-7.42019744e-03]
 [ 4.59474043e-03]
 [ 6.77209632e-03]
 [ 2.46205502e-03]
 [ 5.37827301e-03]
 [-2.30821560e-03]
 [-1.57439025e-02]
 [ 6.91246674e-03]
 [-6.60164751e-04]
 [-2.92864712e-03]
 [-2.03358989e-02]
 [ 2.18084453e-02]
 [ 2.95166223e-03]
 [ 2.01517311e-02]
 [ 8.59844381e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.66313768]
curr_Stock_Price:  99.83832642693706
curr_Factors:  [99.83832643]
mat_Sqrt:  [[0.15]]
grads:  [0.08942958]
Stock Position:  0.08942957685283684
Bond Position:  [-10.59163697]


portfolio before change:  [-1.64736368]
curr_Stock_Price:  100.02951637633913
curr_Factors:  [100.02951638]
mat_Sqrt:  [[0.15]]
grads:  [0.27784909]
Stock Position:  0.2778490932606276
Bond Position:  [-29.44047411]


portfolio before change:  [-1.42078603]
curr_Stock_Price:  100.8582321999877
curr_Factors:  [100.8582322]
mat_Sqrt:  [[0.15]]
grads:  [-0.0229937]
Stock Position:  -0.022993700543519267
Bond Position:  [0.89831796]


portfolio before change:  [-1.40561105]
curr_Stock_Price:  100.20315357840147
curr_Factors:  [100.20315358]
mat_Sqrt:  [[0.15]]
grads:  [-0.03245242]
Stock Position:  -0.032452422615560354
Bond Position:  [1.84622404]


portfolio before change:  [-1.4219966]
curr_Stock_Price:  100.71517528737732
curr_Factors:  [100.71517529]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242598]
Stock Position:  -0.03242597763641684
Bond Position:  [1.84379142]


portfolio before change:  [-1.41479072]
curr_Stock_Price:  100.50005786057618
curr_Factors:  [100.50005786]
mat_Sqrt:  [[0.15]]
grads:  [0.21342199]
Stock Position:  0.21342198643137916
Bond Position:  [-22.86371271]


portfolio before change:  [-1.35034063]
curr_Stock_Price:  100.81543416863789
curr_Factors:  [100.81543417]
mat_Sqrt:  [[0.15]]
grads:  [0.02495987]
Stock Position:  0.024959865021199908
Bond Position:  [-3.86668026]


portfolio before change:  [-1.38569388]
curr_Stock_Price:  99.41839591270424
curr_Factors:  [99.41839591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086017]
Stock Position:  -0.008601697154484328
Bond Position:  [-0.53052695]


portfolio before change:  [-1.38457464]
curr_Stock_Price:  99.28056788741452
curr_Factors:  [99.28056789]
mat_Sqrt:  [[0.15]]
grads:  [-0.1848825]
Stock Position:  -0.18488250014530846
Bond Position:  [16.97066496]


portfolio before change:  [-1.23301015]
curr_Stock_Price:  98.47225434797947
curr_Factors:  [98.47225435]
mat_Sqrt:  [[0.15]]
grads:  [0.15627434]
Stock Position:  0.15627433745139344
Bond Position:  [-16.62169646]


portfolio before change:  [-1.07997415]
curr_Stock_Price:  99.46482830353322
curr_Factors:  [99.4648283]
mat_Sqrt:  [[0.15]]
grads:  [0.13108843]
Stock Position:  0.13108842933222312
Bond Position:  [-14.11866227]


portfolio before change:  [-1.04195179]
curr_Stock_Price:  99.76834335341925
curr_Factors:  [99.76834335]
mat_Sqrt:  [[0.15]]
grads:  [-0.10087016]
Stock Position:  -0.10087015933231805
Bond Position:  [9.0216969]


portfolio before change:  [-1.13656769]
curr_Stock_Price:  100.71752084451323
curr_Factors:  [100.71752084]
mat_Sqrt:  [[0.15]]
grads:  [0.21318137]
Stock Position:  0.21318137421758793
Bond Position:  [-22.60766719]


portfolio before change:  [-1.21083336]
curr_Stock_Price:  100.38240933092995
curr_Factors:  [100.38240933]
mat_Sqrt:  [[0.15]]
grads:  [0.04038177]
Stock Position:  0.04038176919736678
Bond Position:  [-5.26445264]


portfolio before change:  [-1.21200138]
curr_Stock_Price:  100.36978159711268
curr_Factors:  [100.3697816]
mat_Sqrt:  [[0.15]]
grads:  [0.01893061]
Stock Position:  0.018930605907439963
Bond Position:  [-3.11206217]


portfolio before change:  [-1.21549831]
curr_Stock_Price:  100.2056086481265
curr_Factors:  [100.20560865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02210799]
Stock Position:  -0.022107994921407265
Bond Position:  [0.99984678]


portfolio before change:  [-1.21893977]
curr_Stock_Price:  100.36692822759215
curr_Factors:  [100.36692823]
mat_Sqrt:  [[0.15]]
grads:  [-0.04062112]
Stock Position:  -0.04062112394172778
Bond Position:  [2.85807766]


portfolio before change:  [-1.26154218]
curr_Stock_Price:  101.42449828432645
curr_Factors:  [101.42449828]
mat_Sqrt:  [[0.15]]
grads:  [0.04509012]
Stock Position:  0.045090124457082756
Bond Position:  [-5.83478543]


portfolio before change:  [-1.26804783]
curr_Stock_Price:  101.29639351930305
curr_Factors:  [101.29639352]
mat_Sqrt:  [[0.15]]
grads:  [0.06139664]
Stock Position:  0.06139664341420787
Bond Position:  [-7.48730638]


portfolio before change:  [-1.23863222]
curr_Stock_Price:  101.79074596462563
curr_Factors:  [101.79074596]
mat_Sqrt:  [[0.15]]
grads:  [0.10304101]
Stock Position:  0.1030410050958156
Bond Position:  [-11.72725299]


portfolio before change:  [-1.1160368]
curr_Stock_Price:  102.99474645411502
curr_Factors:  [102.99474645]
mat_Sqrt:  [[0.15]]
grads:  [-0.00220494]
Stock Position:  -0.0022049408370154013
Bond Position:  [-0.88893948]


portfolio before change:  [-1.11720015]
curr_Stock_Price:  103.47196151249867
curr_Factors:  [103.47196151]
mat_Sqrt:  [[0.15]]
grads:  [-0.02821551]
Stock Position:  -0.028215510616394747
Bond Position:  [1.80231407]


portfolio before change:  [-1.13857288]
curr_Stock_Price:  104.23742807542818
curr_Factors:  [104.23742808]
mat_Sqrt:  [[0.15]]
grads:  [0.03598442]
Stock Position:  0.035984418451982136
Bond Position:  [-4.88949611]


portfolio before change:  [-1.10455077]
curr_Stock_Price:  105.1998818298092
curr_Factors:  [105.19988183]
mat_Sqrt:  [[0.15]]
grads:  [-0.05164296]
Stock Position:  -0.05164296477988834
Bond Position:  [4.32828303]


portfolio before change:  [-1.11534174]
curr_Stock_Price:  105.41931232062342
curr_Factors:  [105.41931232]
mat_Sqrt:  [[0.15]]
grads:  [-0.04946798]
Stock Position:  -0.04946798296120041
Bond Position:  [4.09953901]


portfolio before change:  [-1.09424341]
curr_Stock_Price:  105.00316729699819
curr_Factors:  [105.0031673]
mat_Sqrt:  [[0.15]]
grads:  [0.0306316]
Stock Position:  0.030631602837227056
Bond Position:  [-4.31065873]


portfolio before change:  [-1.06817083]
curr_Stock_Price:  105.87192520410018
curr_Factors:  [105.8719252]
mat_Sqrt:  [[0.15]]
grads:  [0.04514731]
Stock Position:  0.04514730876751073
Bond Position:  [-5.84800333]


portfolio before change:  [-1.09541765]
curr_Stock_Price:  105.2846083477545
curr_Factors:  [105.28460835]
mat_Sqrt:  [[0.15]]
grads:  [0.0164137]
Stock Position:  0.01641370012158713
Bond Position:  [-2.82352764]


portfolio before change:  [-1.1037879]
curr_Stock_Price:  104.79615750372614
curr_Factors:  [104.7961575]
mat_Sqrt:  [[0.15]]
grads:  [0.03585515]
Stock Position:  0.03585515342958549
Bond Position:  [-4.8612702]


portfolio before change:  [-1.09181236]
curr_Stock_Price:  105.14710379246266
curr_Factors:  [105.14710379]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153881]
Stock Position:  -0.015388104009450027
Bond Position:  [0.52620221]


portfolio before change:  [-1.08546286]
curr_Stock_Price:  104.73875431102722
curr_Factors:  [104.73875431]
mat_Sqrt:  [[0.15]]
grads:  [-0.10495935]
Stock Position:  -0.1049593501655767
Bond Position:  [9.90784873]


portfolio before change:  [-0.98670532]
curr_Stock_Price:  103.80964238878055
curr_Factors:  [103.80964239]
mat_Sqrt:  [[0.15]]
grads:  [0.04608311]
Stock Position:  0.04608311158807058
Bond Position:  [-5.77057665]


portfolio before change:  [-1.01019794]
curr_Stock_Price:  103.31550788478619
curr_Factors:  [103.31550788]
mat_Sqrt:  [[0.15]]
grads:  [-0.0044011]
Stock Position:  -0.004401098342296317
Bond Position:  [-0.55549623]


portfolio before change:  [-1.01289719]
curr_Stock_Price:  103.9130436970175
curr_Factors:  [103.9130437]
mat_Sqrt:  [[0.15]]
grads:  [-0.01952431]
Stock Position:  -0.01952431414167537
Bond Position:  [1.01593371]


portfolio before change:  [-0.99488238]
curr_Stock_Price:  102.99686206729925
curr_Factors:  [102.99686207]
mat_Sqrt:  [[0.15]]
grads:  [-0.13557266]
Stock Position:  -0.1355726595290401
Bond Position:  [12.96867614]


portfolio before change:  [-0.90361314]
curr_Stock_Price:  102.33560739719123
curr_Factors:  [102.3356074]
mat_Sqrt:  [[0.15]]
grads:  [0.14538964]
Stock Position:  0.14538963564175647
Bond Position:  [-15.78214981]


portfolio before change:  [-0.78626292]
curr_Stock_Price:  103.15632002828504
curr_Factors:  [103.15632003]
mat_Sqrt:  [[0.15]]
grads:  [0.01967775]
Stock Position:  0.01967774822116698
Bond Position:  [-2.81614701]


portfolio before change:  [-0.79098297]
curr_Stock_Price:  102.93434278391513
curr_Factors:  [102.93434278]
mat_Sqrt:  [[0.15]]
grads:  [0.13434487]
Stock Position:  0.1343448739262819
Bond Position:  [-14.61968428]


portfolio before change:  [-0.97606442]
curr_Stock_Price:  101.57028718327079
curr_Factors:  [101.57028718]
mat_Sqrt:  [[0.15]]
grads:  [0.05732296]
Stock Position:  0.05732295873170019
Bond Position:  [-6.7983738]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.98964945]
Stock Price:  101.34812184143398
PL:  [-2.33777129]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.66242456e-02]
 [-1.29995036e-02]
 [-1.39406668e-02]
 [-1.00944283e-02]
 [-2.72304605e-03]
 [ 4.85469916e-02]
 [ 3.49294453e-03]
 [ 5.46322114e-03]
 [ 1.97755613e-02]
 [ 2.34455391e-02]
 [ 2.14552066e-02]
 [-7.66325589e-03]
 [-1.18405303e-02]
 [ 1.77270364e-02]
 [-1.33585613e-02]
 [ 1.80655860e-04]
 [-6.11332972e-03]
 [-1.54052821e-03]
 [ 1.02160421e-03]
 [-2.82678923e-02]
 [-3.10700328e-03]
 [-1.62959018e-02]
 [ 6.56661363e-03]
 [-8.26974156e-03]
 [ 1.27777448e-02]
 [ 7.09478436e-03]
 [ 4.53127124e-03]
 [-3.06155585e-03]
 [-1.87294142e-03]
 [-8.71741442e-03]
 [-2.90635415e-02]
 [ 1.68595135e-02]
 [-3.40778868e-03]
 [-2.04054666e-02]
 [-2.14687258e-02]
 [ 3.60112924e-02]
 [ 3.13643182e-03]
 [ 8.35644484e-03]
 [ 5.35979248e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.69362899]
curr_Stock_Price:  98.8349245361899
curr_Factors:  [98.83492454]
mat_Sqrt:  [[0.15]]
grads:  [0.1108283]
Stock Position:  0.11082830387636969
Bond Position:  [-34.64733604]


portfolio before change:  [-23.85504759]
curr_Stock_Price:  97.41753022522909
curr_Factors:  [97.41753023]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666336]
Stock Position:  -0.0866633572412646
Bond Position:  [-15.41251736]


portfolio before change:  [-23.86545709]
curr_Stock_Price:  97.51541268849707
curr_Factors:  [97.51541269]
mat_Sqrt:  [[0.15]]
grads:  [-0.09293778]
Stock Position:  -0.0929377784578756
Bond Position:  [-14.80259127]


portfolio before change:  [-23.75383209]
curr_Stock_Price:  96.2944297591453
curr_Factors:  [96.29442976]
mat_Sqrt:  [[0.15]]
grads:  [-0.06729619]
Stock Position:  -0.06729618878507909
Bond Position:  [-17.27358397]


portfolio before change:  [-23.74517199]
curr_Stock_Price:  96.13365638990352
curr_Factors:  [96.13365639]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815364]
Stock Position:  -0.0181536403574164
Bond Position:  [-21.99999617]


portfolio before change:  [-23.77154939]
curr_Stock_Price:  97.4351709221485
curr_Factors:  [97.43517092]
mat_Sqrt:  [[0.15]]
grads:  [0.32364661]
Stock Position:  0.3236466103822669
Bond Position:  [-55.30611219]


portfolio before change:  [-24.08197766]
curr_Stock_Price:  96.49737469172942
curr_Factors:  [96.49737469]
mat_Sqrt:  [[0.15]]
grads:  [0.0232863]
Stock Position:  0.023286296865621656
Bond Position:  [-26.32904417]


portfolio before change:  [-24.09244863]
curr_Stock_Price:  96.18905460068908
curr_Factors:  [96.1890546]
mat_Sqrt:  [[0.15]]
grads:  [0.03642147]
Stock Position:  0.03642147427896733
Bond Position:  [-27.5957958]


portfolio before change:  [-24.06239887]
curr_Stock_Price:  97.10882636801095
curr_Factors:  [97.10882637]
mat_Sqrt:  [[0.15]]
grads:  [0.13183708]
Stock Position:  0.13183707524286087
Bond Position:  [-36.86494252]


portfolio before change:  [-24.07104418]
curr_Stock_Price:  97.07820596396209
curr_Factors:  [97.07820596]
mat_Sqrt:  [[0.15]]
grads:  [0.15630359]
Stock Position:  0.15630359414492914
Bond Position:  [-39.24471669]


portfolio before change:  [-24.07645774]
curr_Stock_Price:  97.07495804056386
curr_Factors:  [97.07495804]
mat_Sqrt:  [[0.15]]
grads:  [0.14303471]
Stock Position:  0.14303471080440489
Bond Position:  [-37.96154629]


portfolio before change:  [-24.06450712]
curr_Stock_Price:  97.19168569569581
curr_Factors:  [97.1916857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05108837]
Stock Position:  -0.05108837262592692
Bond Position:  [-19.09914207]


portfolio before change:  [-24.06814038]
curr_Stock_Price:  97.21606920246255
curr_Factors:  [97.2160692]
mat_Sqrt:  [[0.15]]
grads:  [-0.07893687]
Stock Position:  -0.07893686834466214
Bond Position:  [-16.39420832]


portfolio before change:  [-23.94753974]
curr_Stock_Price:  95.66229535942561
curr_Factors:  [95.66229536]
mat_Sqrt:  [[0.15]]
grads:  [0.11818024]
Stock Position:  0.11818024282479486
Bond Position:  [-35.25293304]


portfolio before change:  [-23.89415899]
curr_Stock_Price:  96.15127425185872
curr_Factors:  [96.15127425]
mat_Sqrt:  [[0.15]]
grads:  [-0.08905708]
Stock Position:  -0.08905707518531111
Bond Position:  [-15.33120773]


portfolio before change:  [-23.96484748]
curr_Stock_Price:  96.92349773186372
curr_Factors:  [96.92349773]
mat_Sqrt:  [[0.15]]
grads:  [0.00120437]
Stock Position:  0.0012043723974686227
Bond Position:  [-24.08157946]


portfolio before change:  [-23.9677527]
curr_Stock_Price:  97.01081791141945
curr_Factors:  [97.01081791]
mat_Sqrt:  [[0.15]]
grads:  [-0.04075553]
Stock Position:  -0.04075553143656181
Bond Position:  [-20.01402526]


portfolio before change:  [-23.94684533]
curr_Stock_Price:  96.43643506587247
curr_Factors:  [96.43643507]
mat_Sqrt:  [[0.15]]
grads:  [-0.01027019]
Stock Position:  -0.010270188079172158
Bond Position:  [-22.956425]


portfolio before change:  [-23.95664283]
curr_Stock_Price:  97.11098656137534
curr_Factors:  [97.11098656]
mat_Sqrt:  [[0.15]]
grads:  [0.00681069]
Stock Position:  0.0068106947653173945
Bond Position:  [-24.61803612]


portfolio before change:  [-23.95466939]
curr_Stock_Price:  97.85259749128213
curr_Factors:  [97.85259749]
mat_Sqrt:  [[0.15]]
grads:  [-0.18845262]
Stock Position:  -0.18845261530642915
Bond Position:  [-5.51409148]


portfolio before change:  [-24.06312924]
curr_Stock_Price:  98.42446827419515
curr_Factors:  [98.42446827]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071336]
Stock Position:  -0.020713355204822606
Bond Position:  [-22.02442827]


portfolio before change:  [-24.04842071]
curr_Stock_Price:  97.58144889736577
curr_Factors:  [97.5814489]
mat_Sqrt:  [[0.15]]
grads:  [-0.10863935]
Stock Position:  -0.10863934513184746
Bond Position:  [-13.447236]


portfolio before change:  [-24.07052255]
curr_Stock_Price:  97.76941793700766
curr_Factors:  [97.76941794]
mat_Sqrt:  [[0.15]]
grads:  [0.04377742]
Stock Position:  0.04377742420463548
Bond Position:  [-28.35061583]


portfolio before change:  [-24.07684359]
curr_Stock_Price:  97.70598352551198
curr_Factors:  [97.70598353]
mat_Sqrt:  [[0.15]]
grads:  [-0.05513161]
Stock Position:  -0.055131610427115556
Bond Position:  [-18.69015537]


portfolio before change:  [-24.04546864]
curr_Stock_Price:  97.09451272127464
curr_Factors:  [97.09451272]
mat_Sqrt:  [[0.15]]
grads:  [0.08518497]
Stock Position:  0.08518496531994918
Bond Position:  [-32.31646134]


portfolio before change:  [-23.92554178]
curr_Stock_Price:  98.54977733557061
curr_Factors:  [98.54977734]
mat_Sqrt:  [[0.15]]
grads:  [0.04729856]
Stock Position:  0.04729856242603812
Bond Position:  [-28.58680458]


portfolio before change:  [-23.95781091]
curr_Stock_Price:  97.94308748039779
curr_Factors:  [97.94308748]
mat_Sqrt:  [[0.15]]
grads:  [0.03020847]
Stock Position:  0.03020847494340742
Bond Position:  [-26.91652222]


portfolio before change:  [-23.95119095]
curr_Stock_Price:  98.27361534054943
curr_Factors:  [98.27361534]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041037]
Stock Position:  -0.020410372364487873
Bond Position:  [-21.94538986]


portfolio before change:  [-23.97196686]
curr_Stock_Price:  99.15711537714057
curr_Factors:  [99.15711538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01248628]
Stock Position:  -0.012486276104046616
Bond Position:  [-22.73386374]


portfolio before change:  [-23.98941258]
curr_Stock_Price:  100.3267044437372
curr_Factors:  [100.32670444]
mat_Sqrt:  [[0.15]]
grads:  [-0.0581161]
Stock Position:  -0.05811609613613806
Bond Position:  [-18.15881618]


portfolio before change:  [-24.02593631]
curr_Stock_Price:  100.9161062585016
curr_Factors:  [100.91610626]
mat_Sqrt:  [[0.15]]
grads:  [-0.19375694]
Stock Position:  -0.19375694326757048
Bond Position:  [-4.47274003]


portfolio before change:  [-24.14987699]
curr_Stock_Price:  101.55289146962431
curr_Factors:  [101.55289147]
mat_Sqrt:  [[0.15]]
grads:  [0.11239676]
Stock Position:  0.11239675688790057
Bond Position:  [-35.56409264]


portfolio before change:  [-24.18501472]
curr_Stock_Price:  101.27982360586535
curr_Factors:  [101.27982361]
mat_Sqrt:  [[0.15]]
grads:  [-0.02271859]
Stock Position:  -0.022718591217936557
Bond Position:  [-21.88407981]


portfolio before change:  [-24.16594567]
curr_Stock_Price:  100.32004864586101
curr_Factors:  [100.32004865]
mat_Sqrt:  [[0.15]]
grads:  [-0.13603644]
Stock Position:  -0.13603644433297843
Bond Position:  [-10.51876295]


portfolio before change:  [-24.13356277]
curr_Stock_Price:  100.07233689160515
curr_Factors:  [100.07233689]
mat_Sqrt:  [[0.15]]
grads:  [-0.14312484]
Stock Position:  -0.1431248386085522
Bond Position:  [-9.8107257]


portfolio before change:  [-23.98287593]
curr_Stock_Price:  99.01093304405494
curr_Factors:  [99.01093304]
mat_Sqrt:  [[0.15]]
grads:  [0.24007528]
Stock Position:  0.24007528241683804
Bond Position:  [-47.75295364]


portfolio before change:  [-23.93580846]
curr_Stock_Price:  99.2318510921997
curr_Factors:  [99.23185109]
mat_Sqrt:  [[0.15]]
grads:  [0.02090955]
Stock Position:  0.02090954547255986
Bond Position:  [-26.01070136]


portfolio before change:  [-23.93441179]
curr_Stock_Price:  99.45415188503544
curr_Factors:  [99.45415189]
mat_Sqrt:  [[0.15]]
grads:  [0.05570963]
Stock Position:  0.05570963227879672
Bond Position:  [-29.47496602]


portfolio before change:  [-23.92973131]
curr_Stock_Price:  99.60430697569907
curr_Factors:  [99.60430698]
mat_Sqrt:  [[0.15]]
grads:  [0.03573195]
Stock Position:  0.0357319498437489
Bond Position:  [-27.48878741]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.90613263]
Stock Price:  100.3609125942838
PL:  [-24.26704522]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.80126619e-02]
 [ 1.42000378e-02]
 [-3.83218960e-03]
 [-2.14058891e-03]
 [-6.31049576e-03]
 [ 3.17506500e-02]
 [ 3.73133062e-03]
 [ 1.65406396e-02]
 [ 4.82249655e-03]
 [ 2.27712197e-02]
 [ 1.89914402e-02]
 [-3.12277858e-03]
 [ 1.01656710e-02]
 [ 2.10338449e-02]
 [-1.20446278e-02]
 [-2.99053323e-03]
 [-5.17766570e-03]
 [ 7.94404409e-03]
 [ 1.87515134e-02]
 [-6.55275638e-03]
 [-3.14195455e-04]
 [-1.43201957e-02]
 [ 5.97661984e-03]
 [-7.52655800e-03]
 [-4.53151571e-03]
 [ 4.54331484e-03]
 [ 6.82341460e-03]
 [ 2.61801798e-03]
 [ 5.42255658e-03]
 [-1.01430194e-04]
 [-1.46369073e-02]
 [ 5.95629262e-03]
 [ 2.02239178e-03]
 [-1.13159033e-02]
 [-2.04080162e-02]
 [ 2.60364111e-02]
 [ 5.07417393e-03]
 [ 1.95653669e-02]
 [ 1.04851490e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.98762361]
curr_Stock_Price:  100.77888706292649
curr_Factors:  [100.77888706]
mat_Sqrt:  [[0.15]]
grads:  [-0.25341775]
Stock Position:  -0.25341774567317893
Bond Position:  [44.52678198]


portfolio before change:  [18.93949239]
curr_Stock_Price:  100.99077994379635
curr_Factors:  [100.99077994]
mat_Sqrt:  [[0.15]]
grads:  [0.09466692]
Stock Position:  0.09466691889188811
Bond Position:  [9.37900641]


portfolio before change:  [18.94429966]
curr_Stock_Price:  101.02917587749707
curr_Factors:  [101.02917588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02554793]
Stock Position:  -0.025547930686302876
Bond Position:  [21.52538604]


portfolio before change:  [18.95134563]
curr_Stock_Price:  100.85870690018182
curr_Factors:  [100.8587069]
mat_Sqrt:  [[0.15]]
grads:  [-0.01427059]
Stock Position:  -0.014270592742515974
Bond Position:  [20.39065916]


portfolio before change:  [18.95849863]
curr_Stock_Price:  100.53608496799308
curr_Factors:  [100.53608497]
mat_Sqrt:  [[0.15]]
grads:  [-0.04206997]
Stock Position:  -0.04206997175999598
Bond Position:  [23.18804888]


portfolio before change:  [18.93979682]
curr_Stock_Price:  101.04952704213025
curr_Factors:  [101.04952704]
mat_Sqrt:  [[0.15]]
grads:  [0.211671]
Stock Position:  0.2116709998527137
Bond Position:  [-2.4494576]


portfolio before change:  [18.93043656]
curr_Stock_Price:  101.00675283665439
curr_Factors:  [101.00675284]
mat_Sqrt:  [[0.15]]
grads:  [0.02487554]
Stock Position:  0.02487553749281406
Bond Position:  [16.41783929]


portfolio before change:  [18.95995988]
curr_Stock_Price:  102.11108907215075
curr_Factors:  [102.11108907]
mat_Sqrt:  [[0.15]]
grads:  [0.11027093]
Stock Position:  0.11027093069303251
Bond Position:  [7.70007505]


portfolio before change:  [18.99794895]
curr_Stock_Price:  102.4468665872304
curr_Factors:  [102.44686659]
mat_Sqrt:  [[0.15]]
grads:  [0.03214998]
Stock Position:  0.03214997702618426
Bond Position:  [15.70428454]


portfolio before change:  [19.0134116]
curr_Stock_Price:  102.86675795171263
curr_Factors:  [102.86675795]
mat_Sqrt:  [[0.15]]
grads:  [0.15180813]
Stock Position:  0.15180813165570514
Bond Position:  [3.39740127]


portfolio before change:  [18.89906116]
curr_Stock_Price:  102.11070393583628
curr_Factors:  [102.11070394]
mat_Sqrt:  [[0.15]]
grads:  [0.1266096]
Stock Position:  0.12660960164176835
Bond Position:  [5.97086561]


portfolio before change:  [19.00669013]
curr_Stock_Price:  102.95489401577657
curr_Factors:  [102.95489402]
mat_Sqrt:  [[0.15]]
grads:  [-0.02081852]
Stock Position:  -0.0208185238621718
Bond Position:  [21.15005905]


portfolio before change:  [19.01486415]
curr_Stock_Price:  102.68926040048717
curr_Factors:  [102.6892604]
mat_Sqrt:  [[0.15]]
grads:  [0.06777114]
Stock Position:  0.06777114002536783
Bond Position:  [12.05549591]


portfolio before change:  [18.95043249]
curr_Stock_Price:  101.71629917885707
curr_Factors:  [101.71629918]
mat_Sqrt:  [[0.15]]
grads:  [0.14022563]
Stock Position:  0.14022563263533905
Bond Position:  [4.68720009]


portfolio before change:  [19.01078119]
curr_Stock_Price:  102.14248912963609
curr_Factors:  [102.14248913]
mat_Sqrt:  [[0.15]]
grads:  [-0.08029752]
Stock Position:  -0.08029751854150911
Bond Position:  [27.2125696]


portfolio before change:  [18.99230214]
curr_Stock_Price:  102.41498606135482
curr_Factors:  [102.41498606]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993689]
Stock Position:  -0.019936888206809503
Bond Position:  [21.03413827]


portfolio before change:  [18.98120303]
curr_Stock_Price:  103.1035860179856
curr_Factors:  [103.10358602]
mat_Sqrt:  [[0.15]]
grads:  [-0.03451777]
Stock Position:  -0.03451777130028171
Bond Position:  [22.54010904]


portfolio before change:  [18.95138773]
curr_Stock_Price:  104.04898300765329
curr_Factors:  [104.04898301]
mat_Sqrt:  [[0.15]]
grads:  [0.05296029]
Stock Position:  0.05296029391972866
Bond Position:  [13.440923]


portfolio before change:  [18.91955116]
curr_Stock_Price:  103.41611670776747
curr_Factors:  [103.41611671]
mat_Sqrt:  [[0.15]]
grads:  [0.12501009]
Stock Position:  0.12501008909920833
Bond Position:  [5.9914932]


portfolio before change:  [19.17725377]
curr_Stock_Price:  105.47157984011375
curr_Factors:  [105.47157984]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368504]
Stock Position:  -0.04368504256375257
Bond Position:  [23.78478423]


portfolio before change:  [19.18262339]
curr_Stock_Price:  105.41672513000337
curr_Factors:  [105.41672513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00209464]
Stock Position:  -0.002094636369171578
Bond Position:  [19.40343309]


portfolio before change:  [19.18565749]
curr_Stock_Price:  105.12620893146838
curr_Factors:  [105.12620893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09546797]
Stock Position:  -0.09546797126022037
Bond Position:  [29.22184339]


portfolio before change:  [19.2320307]
curr_Stock_Price:  104.67872646984642
curr_Factors:  [104.67872647]
mat_Sqrt:  [[0.15]]
grads:  [0.03984413]
Stock Position:  0.03984413228063046
Bond Position:  [15.06119767]


portfolio before change:  [19.25851282]
curr_Stock_Price:  105.29611627953274
curr_Factors:  [105.29611628]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017705]
Stock Position:  -0.050177053350550484
Bond Position:  [24.54196167]


portfolio before change:  [19.29829654]
curr_Stock_Price:  104.56439173808945
curr_Factors:  [104.56439174]
mat_Sqrt:  [[0.15]]
grads:  [-0.0302101]
Stock Position:  -0.030210104739675083
Bond Position:  [22.45719777]


portfolio before change:  [19.31514506]
curr_Stock_Price:  104.09960705399088
curr_Factors:  [104.09960705]
mat_Sqrt:  [[0.15]]
grads:  [0.03028877]
Stock Position:  0.030288765575368304
Bond Position:  [16.16209647]


portfolio before change:  [19.34800909]
curr_Stock_Price:  105.11792640314286
curr_Factors:  [105.1179264]
mat_Sqrt:  [[0.15]]
grads:  [0.04548943]
Stock Position:  0.045489430685680204
Bond Position:  [14.56625446]


portfolio before change:  [19.36937737]
curr_Stock_Price:  105.54763909304023
curr_Factors:  [105.54763909]
mat_Sqrt:  [[0.15]]
grads:  [0.01745345]
Stock Position:  0.017453453178544263
Bond Position:  [17.52720659]


portfolio before change:  [19.37358034]
curr_Stock_Price:  105.66291352789011
curr_Factors:  [105.66291353]
mat_Sqrt:  [[0.15]]
grads:  [0.03615038]
Stock Position:  0.03615037721376508
Bond Position:  [15.55382616]


portfolio before change:  [19.37215585]
curr_Stock_Price:  105.56972394025149
curr_Factors:  [105.56972394]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006762]
Stock Position:  -0.000676201291952445
Bond Position:  [19.44354224]


portfolio before change:  [19.37478809]
curr_Stock_Price:  105.2715314687268
curr_Factors:  [105.27153147]
mat_Sqrt:  [[0.15]]
grads:  [-0.09757938]
Stock Position:  -0.09757938206637028
Bond Position:  [29.64711908]


portfolio before change:  [19.45483551]
curr_Stock_Price:  104.48918069228489
curr_Factors:  [104.48918069]
mat_Sqrt:  [[0.15]]
grads:  [0.03970862]
Stock Position:  0.03970861747326403
Bond Position:  [15.30571461]


portfolio before change:  [19.44832148]
curr_Stock_Price:  104.27695059914943
curr_Factors:  [104.2769506]
mat_Sqrt:  [[0.15]]
grads:  [0.01348261]
Stock Position:  0.013482611854777784
Bond Position:  [18.04239583]


portfolio before change:  [19.44031204]
curr_Stock_Price:  103.51560827732483
curr_Factors:  [103.51560828]
mat_Sqrt:  [[0.15]]
grads:  [-0.07543936]
Stock Position:  -0.07543935520335102
Bond Position:  [27.24946278]


portfolio before change:  [19.53555132]
curr_Stock_Price:  102.29830090475231
curr_Factors:  [102.2983009]
mat_Sqrt:  [[0.15]]
grads:  [-0.13605344]
Stock Position:  -0.1360534414960905
Bond Position:  [33.45358722]


portfolio before change:  [19.67339002]
curr_Stock_Price:  101.31591681356998
curr_Factors:  [101.31591681]
mat_Sqrt:  [[0.15]]
grads:  [0.17357607]
Stock Position:  0.17357607375358636
Bond Position:  [2.08737097]


portfolio before change:  [19.70441314]
curr_Stock_Price:  101.49314277509279
curr_Factors:  [101.49314278]
mat_Sqrt:  [[0.15]]
grads:  [0.03382783]
Stock Position:  0.03382782621349909
Bond Position:  [16.27112074]


portfolio before change:  [19.74935351]
curr_Stock_Price:  102.76151717482988
curr_Factors:  [102.76151717]
mat_Sqrt:  [[0.15]]
grads:  [0.13043578]
Stock Position:  0.13043577938548084
Bond Position:  [6.34557492]


portfolio before change:  [19.87566791]
curr_Stock_Price:  103.72383872170488
curr_Factors:  [103.72383872]
mat_Sqrt:  [[0.15]]
grads:  [0.06990099]
Stock Position:  0.06990099355932748
Bond Position:  [12.62526853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.8590014]
Stock Price:  103.46283001718423
PL:  [16.39617139]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-6.48475026e-02]
 [-6.50286583e-02]
 [ 2.58891623e-02]
 [ 8.09314578e-03]
 [ 3.52646791e-03]
 [-2.22955790e-02]
 [ 3.41926656e-03]
 [ 3.51117197e-02]
 [ 1.14800386e-02]
 [ 2.28690284e-02]
 [ 2.00779900e-02]
 [-1.42050124e-02]
 [ 3.16640803e-02]
 [ 1.88041218e-02]
 [-1.12767803e-02]
 [-3.72824388e-03]
 [-6.08760699e-03]
 [ 5.90622222e-03]
 [ 7.49924503e-03]
 [ 1.36379264e-02]
 [-2.80901929e-03]
 [-4.46198486e-03]
 [ 4.59304111e-03]
 [-1.22372906e-02]
 [-4.12033794e-04]
 [ 4.53184478e-03]
 [ 1.07481339e-03]
 [ 1.70867623e-03]
 [ 5.26046390e-03]
 [-5.53467085e-03]
 [-1.64913437e-02]
 [ 5.51160656e-03]
 [-1.87101808e-03]
 [-1.96377287e-02]
 [-2.02018132e-02]
 [-2.01419867e-03]
 [ 8.71518600e-03]
 [ 2.36526006e-02]
 [ 9.69276948e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.81162649]
curr_Stock_Price:  101.7728842213097
curr_Factors:  [101.77288422]
mat_Sqrt:  [[0.15]]
grads:  [-0.43231668]
Stock Position:  -0.4323166838086609
Bond Position:  [84.8097423]


portfolio before change:  [40.465236]
curr_Stock_Price:  102.59865012394229
curr_Factors:  [102.59865012]
mat_Sqrt:  [[0.15]]
grads:  [-0.43352439]
Stock Position:  -0.4335243889605816
Bond Position:  [84.9442531]


portfolio before change:  [40.04649004]
curr_Stock_Price:  103.5890549574048
curr_Factors:  [103.58905496]
mat_Sqrt:  [[0.15]]
grads:  [0.17259442]
Stock Position:  0.17259441564059624
Bond Position:  [22.16759764]


portfolio before change:  [40.00949381]
curr_Stock_Price:  103.35864564835163
curr_Factors:  [103.35864565]
mat_Sqrt:  [[0.15]]
grads:  [0.05395431]
Stock Position:  0.053954305210671225
Bond Position:  [34.43284989]


portfolio before change:  [40.03366231]
curr_Stock_Price:  103.72681142979401
curr_Factors:  [103.72681143]
mat_Sqrt:  [[0.15]]
grads:  [0.02350979]
Stock Position:  0.023509786054847874
Bond Position:  [37.59506717]


portfolio before change:  [40.03643302]
curr_Stock_Price:  103.64476171325339
curr_Factors:  [103.64476171]
mat_Sqrt:  [[0.15]]
grads:  [-0.14863719]
Stock Position:  -0.14863719353641225
Bond Position:  [55.44189952]


portfolio before change:  [40.05077695]
curr_Stock_Price:  103.59488684102564
curr_Factors:  [103.59488684]
mat_Sqrt:  [[0.15]]
grads:  [0.02279511]
Stock Position:  0.022795110410425215
Bond Position:  [37.68932006]


portfolio before change:  [40.06456509]
curr_Stock_Price:  103.99307224296238
curr_Factors:  [103.99307224]
mat_Sqrt:  [[0.15]]
grads:  [0.23407813]
Stock Position:  0.2340781316328485
Bond Position:  [15.72206103]


portfolio before change:  [39.74867837]
curr_Stock_Price:  102.63518335092081
curr_Factors:  [102.63518335]
mat_Sqrt:  [[0.15]]
grads:  [0.07653359]
Stock Position:  0.07653359035674197
Bond Position:  [31.89363929]


portfolio before change:  [39.72704293]
curr_Stock_Price:  102.30039711533875
curr_Factors:  [102.30039712]
mat_Sqrt:  [[0.15]]
grads:  [0.15246019]
Stock Position:  0.15246018920134016
Bond Position:  [24.13030503]


portfolio before change:  [39.59611235]
curr_Stock_Price:  101.42182639923851
curr_Factors:  [101.4218264]
mat_Sqrt:  [[0.15]]
grads:  [0.13385327]
Stock Position:  0.13385326661563654
Bond Position:  [26.02046958]


portfolio before change:  [39.47830463]
curr_Stock_Price:  100.51739954985723
curr_Factors:  [100.51739955]
mat_Sqrt:  [[0.15]]
grads:  [-0.09470008]
Stock Position:  -0.09470008283941621
Bond Position:  [48.99731069]


portfolio before change:  [39.47574782]
curr_Stock_Price:  100.6090769045295
curr_Factors:  [100.6090769]
mat_Sqrt:  [[0.15]]
grads:  [0.21109387]
Stock Position:  0.21109386847177952
Bond Position:  [18.23778857]


portfolio before change:  [39.66402787]
curr_Stock_Price:  101.49020237959674
curr_Factors:  [101.49020238]
mat_Sqrt:  [[0.15]]
grads:  [0.12536081]
Stock Position:  0.12536081215686098
Bond Position:  [26.94113368]


portfolio before change:  [39.829509]
curr_Stock_Price:  102.78337586843325
curr_Factors:  [102.78337587]
mat_Sqrt:  [[0.15]]
grads:  [-0.07517854]
Stock Position:  -0.0751785356476938
Bond Position:  [47.55661269]


portfolio before change:  [39.9770632]
curr_Stock_Price:  100.89973649605324
curr_Factors:  [100.8997365]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485496]
Stock Position:  -0.0248549591926827
Bond Position:  [42.48492203]


portfolio before change:  [39.99418022]
curr_Stock_Price:  100.42473768602625
curr_Factors:  [100.42473769]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058405]
Stock Position:  -0.040584046591227274
Bond Position:  [44.06982246]


portfolio before change:  [39.98910504]
curr_Stock_Price:  100.68553603597785
curr_Factors:  [100.68553604]
mat_Sqrt:  [[0.15]]
grads:  [0.03937481]
Stock Position:  0.03937481482674313
Bond Position:  [36.02463071]


portfolio before change:  [40.00390298]
curr_Stock_Price:  100.94698690730536
curr_Factors:  [100.94698691]
mat_Sqrt:  [[0.15]]
grads:  [0.04999497]
Stock Position:  0.04999496683483631
Bond Position:  [34.95706172]


portfolio before change:  [40.03226086]
curr_Stock_Price:  101.42679453514857
curr_Factors:  [101.42679454]
mat_Sqrt:  [[0.15]]
grads:  [0.09091951]
Stock Position:  0.09091950936444423
Bond Position:  [30.81058646]


portfolio before change:  [40.06653592]
curr_Stock_Price:  101.76141464344921
curr_Factors:  [101.76141464]
mat_Sqrt:  [[0.15]]
grads:  [-0.0187268]
Stock Position:  -0.01872679527367414
Bond Position:  [41.97220109]


portfolio before change:  [40.08935253]
curr_Stock_Price:  100.82319945306605
curr_Factors:  [100.82319945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02974657]
Stock Position:  -0.029746565753423933
Bond Position:  [43.08849646]


portfolio before change:  [40.07036174]
curr_Stock_Price:  101.64269528923916
curr_Factors:  [101.64269529]
mat_Sqrt:  [[0.15]]
grads:  [0.03062027]
Stock Position:  0.03062027403756504
Bond Position:  [36.95803456]


portfolio before change:  [40.08828048]
curr_Stock_Price:  102.07700536164178
curr_Factors:  [102.07700536]
mat_Sqrt:  [[0.15]]
grads:  [-0.08158194]
Stock Position:  -0.08158193733114263
Bond Position:  [48.41592034]


portfolio before change:  [40.00814609]
curr_Stock_Price:  103.13344953279866
curr_Factors:  [103.13344953]
mat_Sqrt:  [[0.15]]
grads:  [-0.00274689]
Stock Position:  -0.002746891960933133
Bond Position:  [40.29144253]


portfolio before change:  [40.0110548]
curr_Stock_Price:  103.90815439495324
curr_Factors:  [103.90815439]
mat_Sqrt:  [[0.15]]
grads:  [0.0302123]
Stock Position:  0.030212298526953625
Bond Position:  [36.87175062]


portfolio before change:  [39.99297501]
curr_Stock_Price:  103.15716715055632
curr_Factors:  [103.15716715]
mat_Sqrt:  [[0.15]]
grads:  [0.00716542]
Stock Position:  0.007165422626220312
Bond Position:  [39.25381031]


portfolio before change:  [40.00402189]
curr_Stock_Price:  104.01403880194445
curr_Factors:  [104.0140388]
mat_Sqrt:  [[0.15]]
grads:  [0.01139117]
Stock Position:  0.011391174835056438
Bond Position:  [38.81917979]


portfolio before change:  [40.01438361]
curr_Stock_Price:  104.49766059827166
curr_Factors:  [104.4976606]
mat_Sqrt:  [[0.15]]
grads:  [0.03506976]
Stock Position:  0.0350697593339453
Bond Position:  [36.3496758]


portfolio before change:  [39.9874539]
curr_Stock_Price:  103.60020074554382
curr_Factors:  [103.60020075]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689781]
Stock Position:  -0.036897805669764965
Bond Position:  [43.81007398]


portfolio before change:  [39.96419363]
curr_Stock_Price:  104.37902413610482
curr_Factors:  [104.37902414]
mat_Sqrt:  [[0.15]]
grads:  [-0.10994229]
Stock Position:  -0.10994229130125202
Bond Position:  [51.43986271]


portfolio before change:  [39.92376791]
curr_Stock_Price:  104.80521226944073
curr_Factors:  [104.80521227]
mat_Sqrt:  [[0.15]]
grads:  [0.03674404]
Stock Position:  0.036744043705627456
Bond Position:  [36.07280061]


portfolio before change:  [39.85758401]
curr_Stock_Price:  102.88127348207182
curr_Factors:  [102.88127348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01247345]
Stock Position:  -0.012473453892839267
Bond Position:  [41.14086883]


portfolio before change:  [39.86137893]
curr_Stock_Price:  102.98934358142623
curr_Factors:  [102.98934358]
mat_Sqrt:  [[0.15]]
grads:  [-0.13091819]
Stock Position:  -0.13091819135474653
Bond Position:  [53.34455752]


portfolio before change:  [39.66111745]
curr_Stock_Price:  104.56994874377091
curr_Factors:  [104.56994874]
mat_Sqrt:  [[0.15]]
grads:  [-0.13467875]
Stock Position:  -0.13467875436936003
Bond Position:  [53.74446789]


portfolio before change:  [39.61341559]
curr_Stock_Price:  104.97402386718471
curr_Factors:  [104.97402387]
mat_Sqrt:  [[0.15]]
grads:  [-0.01342799]
Stock Position:  -0.013427991142115833
Bond Position:  [41.02300585]


portfolio before change:  [39.62219986]
curr_Stock_Price:  104.70175146451602
curr_Factors:  [104.70175146]
mat_Sqrt:  [[0.15]]
grads:  [0.05810124]
Stock Position:  0.058101240028418565
Bond Position:  [33.53889826]


portfolio before change:  [39.6043132]
curr_Stock_Price:  104.32173759739804
curr_Factors:  [104.3217376]
mat_Sqrt:  [[0.15]]
grads:  [0.157684]
Stock Position:  0.15768400426801882
Bond Position:  [23.15444389]


portfolio before change:  [39.6679002]
curr_Stock_Price:  104.70663716858658
curr_Factors:  [104.70663717]
mat_Sqrt:  [[0.15]]
grads:  [0.06461846]
Stock Position:  0.06461846318206999
Bond Position:  [32.90191822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.64934977]
Stock Price:  104.35591045218042
PL:  [35.29343932]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.44453431e-02]
 [ 1.30799675e-02]
 [-3.55417843e-03]
 [-2.54932469e-03]
 [-7.72057603e-03]
 [ 2.95529094e-02]
 [ 3.64927326e-03]
 [ 6.32363374e-03]
 [-2.12591130e-02]
 [ 2.33815228e-02]
 [ 1.93386654e-02]
 [-1.31521269e-02]
 [ 3.13986912e-02]
 [ 1.74657633e-02]
 [ 7.82081350e-03]
 [-3.21549399e-03]
 [-6.14333966e-03]
 [ 5.42788512e-03]
 [ 6.28506588e-03]
 [-1.25483010e-02]
 [-4.95868894e-03]
 [-4.55360846e-03]
 [ 6.65967859e-03]
 [-6.33642793e-03]
 [ 1.48485830e-02]
 [ 8.02343666e-03]
 [-2.94558794e-03]
 [-1.08520435e-03]
 [ 3.46223440e-04]
 [-1.37602557e-02]
 [-2.87498941e-03]
 [ 1.48643492e-02]
 [-9.29823207e-03]
 [-1.97271200e-02]
 [-2.13015928e-02]
 [ 2.69905034e-02]
 [ 4.59547719e-03]
 [ 1.23390665e-02]
 [ 9.46952003e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.88611711]
curr_Stock_Price:  100.50098753428614
curr_Factors:  [100.50098753]
mat_Sqrt:  [[0.15]]
grads:  [-0.09630229]
Stock Position:  -0.09630228732952507
Bond Position:  [22.56459209]


portfolio before change:  [12.84022509]
curr_Stock_Price:  101.00681946418882
curr_Factors:  [101.00681946]
mat_Sqrt:  [[0.15]]
grads:  [0.08719978]
Stock Position:  0.08719978330613547
Bond Position:  [4.03245232]


portfolio before change:  [12.80569268]
curr_Stock_Price:  100.60502373331109
curr_Factors:  [100.60502373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369452]
Stock Position:  -0.023694522870677803
Bond Position:  [15.18948071]


portfolio before change:  [12.79447816]
curr_Stock_Price:  101.15845645019203
curr_Factors:  [101.15845645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0169955]
Stock Position:  -0.01699549796080735
Bond Position:  [14.5137165]


portfolio before change:  [12.81134706]
curr_Stock_Price:  100.27265898299716
curr_Factors:  [100.27265898]
mat_Sqrt:  [[0.15]]
grads:  [-0.05147051]
Stock Position:  -0.05147050688732605
Bond Position:  [17.97243164]


portfolio before change:  [12.75744439]
curr_Stock_Price:  101.36356260420543
curr_Factors:  [101.3635626]
mat_Sqrt:  [[0.15]]
grads:  [0.1970194]
Stock Position:  0.19701939628781856
Bond Position:  [-7.21314352]


portfolio before change:  [12.76767817]
curr_Stock_Price:  101.42008232866831
curr_Factors:  [101.42008233]
mat_Sqrt:  [[0.15]]
grads:  [0.02432849]
Stock Position:  0.024328488430790392
Bond Position:  [10.30028087]


portfolio before change:  [12.75731448]
curr_Stock_Price:  100.94116612952203
curr_Factors:  [100.94116613]
mat_Sqrt:  [[0.15]]
grads:  [0.04215756]
Stock Position:  0.04215755825612799
Bond Position:  [8.50188139]


portfolio before change:  [12.75095958]
curr_Stock_Price:  100.76521421237307
curr_Factors:  [100.76521421]
mat_Sqrt:  [[0.15]]
grads:  [-0.14172742]
Stock Position:  -0.1417274198452288
Bond Position:  [27.0321534]


portfolio before change:  [12.82125769]
curr_Stock_Price:  100.29304808912346
curr_Factors:  [100.29304809]
mat_Sqrt:  [[0.15]]
grads:  [0.15587682]
Stock Position:  0.1558768188391069
Bond Position:  [-2.81210359]


portfolio before change:  [13.08298801]
curr_Stock_Price:  101.97438759101405
curr_Factors:  [101.97438759]
mat_Sqrt:  [[0.15]]
grads:  [0.12892444]
Stock Position:  0.1289244358521416
Bond Position:  [-0.06400238]


portfolio before change:  [12.97964738]
curr_Stock_Price:  101.17288993119328
curr_Factors:  [101.17288993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08768085]
Stock Position:  -0.0876808460241529
Bond Position:  [21.85057196]


portfolio before change:  [13.03940402]
curr_Stock_Price:  100.52251817796464
curr_Factors:  [100.52251818]
mat_Sqrt:  [[0.15]]
grads:  [0.20932461]
Stock Position:  0.2093246079983821
Bond Position:  [-8.0024327]


portfolio before change:  [13.21710417]
curr_Stock_Price:  101.37621868771551
curr_Factors:  [101.37621869]
mat_Sqrt:  [[0.15]]
grads:  [0.11643842]
Stock Position:  0.11643842225050309
Bond Position:  [1.41301722]


portfolio before change:  [13.12694424]
curr_Stock_Price:  100.60038741694122
curr_Factors:  [100.60038742]
mat_Sqrt:  [[0.15]]
grads:  [0.05213876]
Stock Position:  0.05213875665497472
Bond Position:  [7.88176512]


portfolio before change:  [13.10256869]
curr_Stock_Price:  100.11397698398807
curr_Factors:  [100.11397698]
mat_Sqrt:  [[0.15]]
grads:  [-0.02143663]
Stock Position:  -0.021436626593941424
Bond Position:  [15.24867463]


portfolio before change:  [13.11454225]
curr_Stock_Price:  99.6443435289503
curr_Factors:  [99.64434353]
mat_Sqrt:  [[0.15]]
grads:  [-0.0409556]
Stock Position:  -0.040955597702254064
Bond Position:  [17.1955359]


portfolio before change:  [13.09065353]
curr_Stock_Price:  100.28011246767853
curr_Factors:  [100.28011247]
mat_Sqrt:  [[0.15]]
grads:  [0.0361859]
Stock Position:  0.036185900786499255
Bond Position:  [9.46192733]


portfolio before change:  [13.08506435]
curr_Stock_Price:  100.09296803157144
curr_Factors:  [100.09296803]
mat_Sqrt:  [[0.15]]
grads:  [0.04190044]
Stock Position:  0.04190043922617066
Bond Position:  [8.89112503]


portfolio before change:  [13.07294202]
curr_Stock_Price:  99.77712894463707
curr_Factors:  [99.77712894]
mat_Sqrt:  [[0.15]]
grads:  [-0.08365534]
Stock Position:  -0.08365533984095003
Bond Position:  [21.41983165]


portfolio before change:  [13.01977168]
curr_Stock_Price:  100.44472506628124
curr_Factors:  [100.44472507]
mat_Sqrt:  [[0.15]]
grads:  [-0.03305793]
Stock Position:  -0.03305792627582522
Bond Position:  [16.340266]


portfolio before change:  [13.01977896]
curr_Stock_Price:  100.50629523547488
curr_Factors:  [100.50629524]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035739]
Stock Position:  -0.03035738972359439
Bond Position:  [16.07088774]


portfolio before change:  [13.07763591]
curr_Stock_Price:  98.6666126757563
curr_Factors:  [98.66661268]
mat_Sqrt:  [[0.15]]
grads:  [0.04439786]
Stock Position:  0.04439785725893507
Bond Position:  [8.69704972]


portfolio before change:  [13.10557059]
curr_Stock_Price:  99.27131476952452
curr_Factors:  [99.27131477]
mat_Sqrt:  [[0.15]]
grads:  [-0.04224285]
Stock Position:  -0.042242852836886356
Bond Position:  [17.29907413]


portfolio before change:  [13.08935414]
curr_Stock_Price:  99.70639348569598
curr_Factors:  [99.70639349]
mat_Sqrt:  [[0.15]]
grads:  [0.09899055]
Stock Position:  0.09899055305445377
Bond Position:  [3.2193631]


portfolio before change:  [13.13410025]
curr_Stock_Price:  100.15435207059278
curr_Factors:  [100.15435207]
mat_Sqrt:  [[0.15]]
grads:  [0.05348958]
Stock Position:  0.053489577742683224
Bond Position:  [7.77688625]


portfolio before change:  [13.18060705]
curr_Stock_Price:  101.00563243511422
curr_Factors:  [101.00563244]
mat_Sqrt:  [[0.15]]
grads:  [-0.01963725]
Stock Position:  -0.019637252956898762
Bond Position:  [15.16408021]


portfolio before change:  [13.18172477]
curr_Stock_Price:  101.04524656627584
curr_Factors:  [101.04524657]
mat_Sqrt:  [[0.15]]
grads:  [-0.0072347]
Stock Position:  -0.007234695648565629
Bond Position:  [13.91275637]


portfolio before change:  [13.19204842]
curr_Stock_Price:  99.85867937862044
curr_Factors:  [99.85867938]
mat_Sqrt:  [[0.15]]
grads:  [0.00230816]
Stock Position:  0.002308156269775028
Bond Position:  [12.96155899]


portfolio before change:  [13.1919436]
curr_Stock_Price:  99.1112786949235
curr_Factors:  [99.11127869]
mat_Sqrt:  [[0.15]]
grads:  [-0.09173504]
Stock Position:  -0.09173503800417657
Bond Position:  [22.28392052]


portfolio before change:  [13.19456148]
curr_Stock_Price:  99.11310774061195
curr_Factors:  [99.11310774]
mat_Sqrt:  [[0.15]]
grads:  [-0.0191666]
Stock Position:  -0.019166596054917023
Bond Position:  [15.09422238]


portfolio before change:  [13.19513899]
curr_Stock_Price:  99.18142372666937
curr_Factors:  [99.18142373]
mat_Sqrt:  [[0.15]]
grads:  [0.09909566]
Stock Position:  0.09909566125490418
Bond Position:  [3.36669022]


portfolio before change:  [13.20800877]
curr_Stock_Price:  99.30704900402321
curr_Factors:  [99.307049]
mat_Sqrt:  [[0.15]]
grads:  [-0.06198821]
Stock Position:  -0.06198821380898679
Bond Position:  [19.36387536]


portfolio before change:  [13.1372548]
curr_Stock_Price:  100.48750899230582
curr_Factors:  [100.48750899]
mat_Sqrt:  [[0.15]]
grads:  [-0.13151413]
Stock Position:  -0.13151413333648368
Bond Position:  [26.35278246]


portfolio before change:  [13.15472011]
curr_Stock_Price:  100.3797562803586
curr_Factors:  [100.37975628]
mat_Sqrt:  [[0.15]]
grads:  [-0.14201062]
Stock Position:  -0.142010618533443
Bond Position:  [27.40971139]


portfolio before change:  [13.05787925]
curr_Stock_Price:  101.08581113136894
curr_Factors:  [101.08581113]
mat_Sqrt:  [[0.15]]
grads:  [0.17993669]
Stock Position:  0.1799366890958464
Bond Position:  [-5.13116692]


portfolio before change:  [13.0425446]
curr_Stock_Price:  101.00415343925471
curr_Factors:  [101.00415344]
mat_Sqrt:  [[0.15]]
grads:  [0.03063651]
Stock Position:  0.030636514588140568
Bond Position:  [9.94812938]


portfolio before change:  [13.04626804]
curr_Stock_Price:  101.08509740484533
curr_Factors:  [101.0850974]
mat_Sqrt:  [[0.15]]
grads:  [0.08226044]
Stock Position:  0.08226044329941395
Bond Position:  [4.73096311]


portfolio before change:  [13.13836733]
curr_Stock_Price:  102.19751409515557
curr_Factors:  [102.1975141]
mat_Sqrt:  [[0.15]]
grads:  [0.06313013]
Stock Position:  0.06313013351209931
Bond Position:  [6.68662462]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.15158458]
Stock Price:  102.39363859306884
PL:  [10.75794599]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.66823326e-02]
 [ 4.35364679e-02]
 [-8.09277169e-03]
 [-7.77253955e-03]
 [-5.86393997e-03]
 [ 3.95899978e-02]
 [ 3.56758931e-03]
 [-1.31361723e-03]
 [-1.95702041e-02]
 [ 2.31395544e-02]
 [ 2.00016774e-02]
 [-1.37687878e-02]
 [ 2.04530937e-02]
 [ 6.02107135e-03]
 [ 8.74918456e-05]
 [-3.16135007e-03]
 [-6.00618810e-03]
 [ 6.84983014e-03]
 [ 1.57680367e-02]
 [ 1.65404668e-02]
 [-1.74720631e-03]
 [-4.50975622e-03]
 [ 5.84726533e-03]
 [-1.14364211e-02]
 [ 4.39761609e-03]
 [ 3.01415073e-03]
 [-2.23238023e-03]
 [-8.21363978e-04]
 [ 3.48326725e-03]
 [-5.33928335e-03]
 [-1.64718397e-02]
 [ 6.24404015e-03]
 [ 9.22527168e-05]
 [-8.61987433e-03]
 [-2.03256464e-02]
 [ 2.13309214e-02]
 [ 4.65102404e-03]
 [ 1.15243632e-02]
 [ 6.62603598e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.65045314]
curr_Stock_Price:  101.08235263947434
curr_Factors:  [101.08235264]
mat_Sqrt:  [[0.15]]
grads:  [-0.31121555]
Stock Position:  -0.311215550395508
Bond Position:  [57.10885315]


portfolio before change:  [25.94174599]
curr_Stock_Price:  100.16930764338737
curr_Factors:  [100.16930764]
mat_Sqrt:  [[0.15]]
grads:  [0.29024312]
Stock Position:  0.2902431191815211
Bond Position:  [-3.13170631]


portfolio before change:  [25.71973493]
curr_Stock_Price:  99.40574234515744
curr_Factors:  [99.40574235]
mat_Sqrt:  [[0.15]]
grads:  [-0.05395181]
Stock Position:  -0.05395181126863473
Bond Position:  [31.08285478]


portfolio before change:  [25.7930856]
curr_Stock_Price:  98.11820304128824
curr_Factors:  [98.11820304]
mat_Sqrt:  [[0.15]]
grads:  [-0.05181693]
Stock Position:  -0.05181693030798791
Bond Position:  [30.87726969]


portfolio before change:  [25.784993]
curr_Stock_Price:  98.34887103555663
curr_Factors:  [98.34887104]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909293]
Stock Position:  -0.03909293310006382
Bond Position:  [29.62973883]


portfolio before change:  [25.79135669]
curr_Stock_Price:  98.2808346990743
curr_Factors:  [98.2808347]
mat_Sqrt:  [[0.15]]
grads:  [0.26393332]
Stock Position:  0.26393331882972765
Bond Position:  [-0.14823019]


portfolio before change:  [25.81644312]
curr_Stock_Price:  98.37595328985181
curr_Factors:  [98.37595329]
mat_Sqrt:  [[0.15]]
grads:  [0.02378393]
Stock Position:  0.02378392872277761
Bond Position:  [23.47667646]


portfolio before change:  [25.83836016]
curr_Stock_Price:  99.17406645500431
curr_Factors:  [99.17406646]
mat_Sqrt:  [[0.15]]
grads:  [-0.00875745]
Stock Position:  -0.008757448177561281
Bond Position:  [26.7068719]


portfolio before change:  [25.82643766]
curr_Stock_Price:  100.91670475797201
curr_Factors:  [100.91670476]
mat_Sqrt:  [[0.15]]
grads:  [-0.13046803]
Stock Position:  -0.13046802736122018
Bond Position:  [38.99284106]


portfolio before change:  [25.80300442]
curr_Stock_Price:  101.13367476468886
curr_Factors:  [101.13367476]
mat_Sqrt:  [[0.15]]
grads:  [0.1542637]
Stock Position:  0.15426369587890096
Bond Position:  [10.20174997]


portfolio before change:  [25.81912164]
curr_Stock_Price:  101.22988615933276
curr_Factors:  [101.22988616]
mat_Sqrt:  [[0.15]]
grads:  [0.13334452]
Stock Position:  0.13334451633078362
Bond Position:  [12.32067144]


portfolio before change:  [25.77776032]
curr_Stock_Price:  100.90815187594025
curr_Factors:  [100.90815188]
mat_Sqrt:  [[0.15]]
grads:  [-0.09179192]
Stock Position:  -0.09179191870268415
Bond Position:  [35.0403132]


portfolio before change:  [25.86504225]
curr_Stock_Price:  100.00500469303685
curr_Factors:  [100.00500469]
mat_Sqrt:  [[0.15]]
grads:  [0.13635396]
Stock Position:  0.13635395832138297
Bond Position:  [12.22896401]


portfolio before change:  [25.86314055]
curr_Stock_Price:  99.97984656968073
curr_Factors:  [99.97984657]
mat_Sqrt:  [[0.15]]
grads:  [0.04014048]
Stock Position:  0.04014047569731875
Bond Position:  [21.84990195]


portfolio before change:  [25.87603695]
curr_Stock_Price:  100.23308198730133
curr_Factors:  [100.23308199]
mat_Sqrt:  [[0.15]]
grads:  [0.00058328]
Stock Position:  0.0005832789708167437
Bond Position:  [25.8175731]


portfolio before change:  [25.87916614]
curr_Stock_Price:  100.06471145818426
curr_Factors:  [100.06471146]
mat_Sqrt:  [[0.15]]
grads:  [-0.02107567]
Stock Position:  -0.021075667159540432
Bond Position:  [27.9880967]


portfolio before change:  [25.86431415]
curr_Stock_Price:  100.93541837865581
curr_Factors:  [100.93541838]
mat_Sqrt:  [[0.15]]
grads:  [-0.04004125]
Stock Position:  -0.04004125402350077
Bond Position:  [29.90589487]


portfolio before change:  [25.84137689]
curr_Stock_Price:  101.60162451478462
curr_Factors:  [101.60162451]
mat_Sqrt:  [[0.15]]
grads:  [0.04566553]
Stock Position:  0.04566553427068485
Bond Position:  [21.20168442]


portfolio before change:  [25.89391133]
curr_Stock_Price:  102.69400333461037
curr_Factors:  [102.69400333]
mat_Sqrt:  [[0.15]]
grads:  [0.10512024]
Stock Position:  0.10512024445763574
Bond Position:  [15.09869259]


portfolio before change:  [25.82366408]
curr_Stock_Price:  102.00779199071101
curr_Factors:  [102.00779199]
mat_Sqrt:  [[0.15]]
grads:  [0.11026978]
Stock Position:  0.1102697786782824
Bond Position:  [14.57528743]


portfolio before change:  [25.84681008]
curr_Stock_Price:  102.201172122155
curr_Factors:  [102.20117212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01164804]
Stock Position:  -0.01164804208608729
Bond Position:  [27.03725364]


portfolio before change:  [25.86587907]
curr_Stock_Price:  100.85424051681798
curr_Factors:  [100.85424052]
mat_Sqrt:  [[0.15]]
grads:  [-0.03006504]
Stock Position:  -0.030065041468752548
Bond Position:  [28.89806599]


portfolio before change:  [25.86835116]
curr_Stock_Price:  100.89217122606796
curr_Factors:  [100.89217123]
mat_Sqrt:  [[0.15]]
grads:  [0.03898177]
Stock Position:  0.038981768859074645
Bond Position:  [21.93539587]


portfolio before change:  [25.89028368]
curr_Stock_Price:  101.38446333067017
curr_Factors:  [101.38446333]
mat_Sqrt:  [[0.15]]
grads:  [-0.07624281]
Stock Position:  -0.07624280754287648
Bond Position:  [33.6201198]


portfolio before change:  [25.88089959]
curr_Stock_Price:  101.56266850575489
curr_Factors:  [101.56266851]
mat_Sqrt:  [[0.15]]
grads:  [0.02931744]
Stock Position:  0.02931744060837689
Bond Position:  [22.90334209]


portfolio before change:  [25.89976059]
curr_Stock_Price:  102.10834712098179
curr_Factors:  [102.10834712]
mat_Sqrt:  [[0.15]]
grads:  [0.02009434]
Stock Position:  0.020094338174988055
Bond Position:  [23.84796093]


portfolio before change:  [25.89138645]
curr_Stock_Price:  101.5432467178103
curr_Factors:  [101.54324672]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488253]
Stock Position:  -0.014882534858864475
Bond Position:  [27.40260736]


portfolio before change:  [25.89933146]
curr_Stock_Price:  101.23957092842494
curr_Factors:  [101.23957093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00547576]
Stock Position:  -0.005475759855999391
Bond Position:  [26.45369504]


portfolio before change:  [25.89480151]
curr_Stock_Price:  102.67076358952855
curr_Factors:  [102.67076359]
mat_Sqrt:  [[0.15]]
grads:  [0.02322178]
Stock Position:  0.0232217816684125
Bond Position:  [23.51060345]


portfolio before change:  [25.92622626]
curr_Stock_Price:  103.897445793527
curr_Factors:  [103.89744579]
mat_Sqrt:  [[0.15]]
grads:  [-0.03559522]
Stock Position:  -0.03559522235116126
Bond Position:  [29.62447895]


portfolio before change:  [25.91245354]
curr_Stock_Price:  104.38841105159445
curr_Factors:  [104.38841105]
mat_Sqrt:  [[0.15]]
grads:  [-0.10981226]
Stock Position:  -0.10981226482421112
Bond Position:  [37.37558138]


portfolio before change:  [25.9285164]
curr_Stock_Price:  104.28468292668127
curr_Factors:  [104.28468293]
mat_Sqrt:  [[0.15]]
grads:  [0.04162693]
Stock Position:  0.04162693436078722
Bond Position:  [21.58746475]


portfolio before change:  [25.90209677]
curr_Stock_Price:  103.58517835954699
curr_Factors:  [103.58517836]
mat_Sqrt:  [[0.15]]
grads:  [0.00061502]
Stock Position:  0.0006150181119465511
Bond Position:  [25.83839001]


portfolio before change:  [25.90536273]
curr_Stock_Price:  103.64364856577568
curr_Factors:  [103.64364857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05746583]
Stock Position:  -0.057465828842064956
Bond Position:  [31.8613309]


portfolio before change:  [25.94061867]
curr_Stock_Price:  103.09944640500936
curr_Factors:  [103.09944641]
mat_Sqrt:  [[0.15]]
grads:  [-0.13550431]
Stock Position:  -0.1355043090110777
Bond Position:  [39.91103792]


portfolio before change:  [26.03350557]
curr_Stock_Price:  102.45077547716693
curr_Factors:  [102.45077548]
mat_Sqrt:  [[0.15]]
grads:  [0.14220614]
Stock Position:  0.14220614252057437
Bond Position:  [11.46437599]


portfolio before change:  [25.83728911]
curr_Stock_Price:  101.06089461931747
curr_Factors:  [101.06089462]
mat_Sqrt:  [[0.15]]
grads:  [0.03100683]
Stock Position:  0.031006826933011034
Bond Position:  [22.70371144]


portfolio before change:  [25.8349019]
curr_Stock_Price:  100.89237192801636
curr_Factors:  [100.89237193]
mat_Sqrt:  [[0.15]]
grads:  [0.07682909]
Stock Position:  0.07682908785836938
Bond Position:  [18.08343299]


portfolio before change:  [25.78849671]
curr_Stock_Price:  100.2589430938662
curr_Factors:  [100.25894309]
mat_Sqrt:  [[0.15]]
grads:  [0.04417357]
Stock Position:  0.04417357320390451
Bond Position:  [21.35970095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.81519577]
Stock Price:  100.80290939102444
PL:  [25.01228638]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.22106271e-02]
 [ 2.55505827e-02]
 [-1.43567449e-02]
 [-7.35753601e-03]
 [-5.02940233e-03]
 [ 4.85983200e-02]
 [ 3.46646091e-03]
 [ 8.50657375e-03]
 [ 8.26252747e-02]
 [ 2.33217928e-02]
 [ 2.14575480e-02]
 [-6.33292086e-03]
 [-1.70260897e-02]
 [ 1.29584944e-02]
 [-1.72168687e-02]
 [ 4.99254315e-04]
 [-6.02225535e-03]
 [ 3.42110614e-03]
 [ 5.25261199e-03]
 [-2.42537096e-02]
 [-4.47472047e-03]
 [-1.17510187e-02]
 [ 6.72900813e-03]
 [-6.36089067e-03]
 [ 1.52475777e-02]
 [ 7.51345062e-03]
 [ 1.22352585e-03]
 [-2.17795519e-03]
 [-1.43194093e-03]
 [-1.48025977e-02]
 [-9.19231606e-03]
 [ 1.85594690e-02]
 [-6.92312420e-03]
 [-2.29448935e-02]
 [-2.12983738e-02]
 [ 2.63234701e-02]
 [ 4.76110016e-03]
 [ 1.72419107e-02]
 [ 1.05313650e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.38538496]
curr_Stock_Price:  99.53215460623615
curr_Factors:  [99.53215461]
mat_Sqrt:  [[0.15]]
grads:  [-0.08140418]
Stock Position:  -0.08140418095079871
Bond Position:  [-0.28305144]


portfolio before change:  [-8.35243928]
curr_Stock_Price:  99.1270026452539
curr_Factors:  [99.12700265]
mat_Sqrt:  [[0.15]]
grads:  [0.17033722]
Stock Position:  0.1703372179628095
Bond Position:  [-25.23745714]


portfolio before change:  [-8.35713014]
curr_Stock_Price:  99.11798536887783
curr_Factors:  [99.11798537]
mat_Sqrt:  [[0.15]]
grads:  [-0.09571163]
Stock Position:  -0.09571163291896351
Bond Position:  [1.12961409]


portfolio before change:  [-8.31402806]
curr_Stock_Price:  98.66912800900208
curr_Factors:  [98.66912801]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905024]
Stock Position:  -0.04905024005319644
Bond Position:  [-3.47428365]


portfolio before change:  [-8.26606271]
curr_Stock_Price:  97.68239147362203
curr_Factors:  [97.68239147]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352935]
Stock Position:  -0.03352934885463981
Bond Position:  [-4.99083573]


portfolio before change:  [-8.2582051]
curr_Stock_Price:  97.42943398265089
curr_Factors:  [97.42943398]
mat_Sqrt:  [[0.15]]
grads:  [0.3239888]
Stock Position:  0.32398879977528433
Bond Position:  [-39.82425048]


portfolio before change:  [-8.6012483]
curr_Stock_Price:  96.38598788074596
curr_Factors:  [96.38598788]
mat_Sqrt:  [[0.15]]
grads:  [0.02310974]
Stock Position:  0.023109739406307166
Bond Position:  [-10.82870336]


portfolio before change:  [-8.62737035]
curr_Stock_Price:  95.31421537295081
curr_Factors:  [95.31421537]
mat_Sqrt:  [[0.15]]
grads:  [0.05671049]
Stock Position:  0.05671049168117203
Bond Position:  [-14.03268637]


portfolio before change:  [-8.63077966]
curr_Stock_Price:  95.2850300005824
curr_Factors:  [95.28503]
mat_Sqrt:  [[0.15]]
grads:  [0.55083516]
Stock Position:  0.5508351643403686
Bond Position:  [-61.11712482]


portfolio before change:  [-8.54748768]
curr_Stock_Price:  95.45011042921062
curr_Factors:  [95.45011043]
mat_Sqrt:  [[0.15]]
grads:  [0.15547862]
Stock Position:  0.15547861897752463
Bond Position:  [-23.38793903]


portfolio before change:  [-8.29873514]
curr_Stock_Price:  97.06882955260728
curr_Factors:  [97.06882955]
mat_Sqrt:  [[0.15]]
grads:  [0.14305032]
Stock Position:  0.14305031973095078
Bond Position:  [-22.18446224]


portfolio before change:  [-8.33568191]
curr_Stock_Price:  96.82993780624696
curr_Factors:  [96.82993781]
mat_Sqrt:  [[0.15]]
grads:  [-0.04221947]
Stock Position:  -0.042219472425046894
Bond Position:  [-4.24757302]


portfolio before change:  [-8.333123]
curr_Stock_Price:  96.75675141130955
curr_Factors:  [96.75675141]
mat_Sqrt:  [[0.15]]
grads:  [-0.11350726]
Stock Position:  -0.11350726451761856
Bond Position:  [2.64947118]


portfolio before change:  [-8.39933549]
curr_Stock_Price:  97.34300196076961
curr_Factors:  [97.34300196]
mat_Sqrt:  [[0.15]]
grads:  [0.08638996]
Stock Position:  0.08638996237934256
Bond Position:  [-16.80879377]


portfolio before change:  [-8.38742434]
curr_Stock_Price:  97.50520115438259
curr_Factors:  [97.50520115]
mat_Sqrt:  [[0.15]]
grads:  [-0.11477912]
Stock Position:  -0.11477912483260136
Bond Position:  [2.80413732]


portfolio before change:  [-8.50019517]
curr_Stock_Price:  98.49075813997456
curr_Factors:  [98.49075814]
mat_Sqrt:  [[0.15]]
grads:  [0.00332836]
Stock Position:  0.00332836209973663
Bond Position:  [-8.82800807]


portfolio before change:  [-8.50103702]
curr_Stock_Price:  98.56938947787958
curr_Factors:  [98.56938948]
mat_Sqrt:  [[0.15]]
grads:  [-0.04014837]
Stock Position:  -0.040148369013152226
Bond Position:  [-4.5436368]


portfolio before change:  [-8.5104836]
curr_Stock_Price:  98.79053373761433
curr_Factors:  [98.79053374]
mat_Sqrt:  [[0.15]]
grads:  [0.02280737]
Stock Position:  0.022807374258667565
Bond Position:  [-10.76363627]


portfolio before change:  [-8.50640449]
curr_Stock_Price:  99.02837994331225
curr_Factors:  [99.02837994]
mat_Sqrt:  [[0.15]]
grads:  [0.03501741]
Stock Position:  0.035017413278391904
Bond Position:  [-11.97412219]


portfolio before change:  [-8.50804136]
curr_Stock_Price:  99.02438152184226
curr_Factors:  [99.02438152]
mat_Sqrt:  [[0.15]]
grads:  [-0.1616914]
Stock Position:  -0.16169139766466914
Bond Position:  [7.50334929]


portfolio before change:  [-8.32794213]
curr_Stock_Price:  97.91633707748034
curr_Factors:  [97.91633708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02983147]
Stock Position:  -0.02983146981975048
Bond Position:  [-5.40695387]


portfolio before change:  [-8.3467446]
curr_Stock_Price:  98.52396914246172
curr_Factors:  [98.52396914]
mat_Sqrt:  [[0.15]]
grads:  [-0.07834012]
Stock Position:  -0.07834012475377114
Bond Position:  [-0.62836456]


portfolio before change:  [-8.36647131]
curr_Stock_Price:  98.77477504162931
curr_Factors:  [98.77477504]
mat_Sqrt:  [[0.15]]
grads:  [0.04486005]
Stock Position:  0.04486005417088609
Bond Position:  [-12.79751307]


portfolio before change:  [-8.35389559]
curr_Stock_Price:  99.09076912682237
curr_Factors:  [99.09076913]
mat_Sqrt:  [[0.15]]
grads:  [-0.04240594]
Stock Position:  -0.04240593780879132
Bond Position:  [-4.1518586]


portfolio before change:  [-8.36759292]
curr_Stock_Price:  99.40153494294175
curr_Factors:  [99.40153494]
mat_Sqrt:  [[0.15]]
grads:  [0.10165052]
Stock Position:  0.10165051819410832
Bond Position:  [-18.47181046]


portfolio before change:  [-8.42378108]
curr_Stock_Price:  98.87149298532331
curr_Factors:  [98.87149299]
mat_Sqrt:  [[0.15]]
grads:  [0.05008967]
Stock Position:  0.05008967080047796
Bond Position:  [-13.37622162]


portfolio before change:  [-8.45616749]
curr_Stock_Price:  98.25830721610352
curr_Factors:  [98.25830722]
mat_Sqrt:  [[0.15]]
grads:  [0.00815684]
Stock Position:  0.008156839022264897
Bond Position:  [-9.25764468]


portfolio before change:  [-8.4468273]
curr_Stock_Price:  99.5452595547254
curr_Factors:  [99.54525955]
mat_Sqrt:  [[0.15]]
grads:  [-0.0145197]
Stock Position:  -0.014519701235957761
Bond Position:  [-7.00145987]


portfolio before change:  [-8.44274272]
curr_Stock_Price:  99.20366707524643
curr_Factors:  [99.20366708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954627]
Stock Position:  -0.009546272846675577
Bond Position:  [-7.49571744]


portfolio before change:  [-8.43734049]
curr_Stock_Price:  98.53961207617131
curr_Factors:  [98.53961208]
mat_Sqrt:  [[0.15]]
grads:  [-0.09868398]
Stock Position:  -0.0986839846634386
Bond Position:  [1.28694108]


portfolio before change:  [-8.52950228]
curr_Stock_Price:  99.47515062579326
curr_Factors:  [99.47515063]
mat_Sqrt:  [[0.15]]
grads:  [-0.06128211]
Stock Position:  -0.061282107038330556
Bond Position:  [-2.43345546]


portfolio before change:  [-8.5900459]
curr_Stock_Price:  100.45813597005544
curr_Factors:  [100.45813597]
mat_Sqrt:  [[0.15]]
grads:  [0.12372979]
Stock Position:  0.12372979344620427
Bond Position:  [-21.01971031]


portfolio before change:  [-8.62614257]
curr_Stock_Price:  100.18763484864058
curr_Factors:  [100.18763485]
mat_Sqrt:  [[0.15]]
grads:  [-0.04615416]
Stock Position:  -0.04615416133626613
Bond Position:  [-4.00206631]


portfolio before change:  [-8.61805218]
curr_Stock_Price:  100.00150454740962
curr_Factors:  [100.00150455]
mat_Sqrt:  [[0.15]]
grads:  [-0.15296596]
Stock Position:  -0.15296595696164328
Bond Position:  [6.67877366]


portfolio before change:  [-8.67574836]
curr_Stock_Price:  100.38414577805516
curr_Factors:  [100.38414578]
mat_Sqrt:  [[0.15]]
grads:  [-0.14198916]
Stock Position:  -0.14198915864561504
Bond Position:  [5.57771204]


portfolio before change:  [-8.68139129]
curr_Stock_Price:  100.42879841768679
curr_Factors:  [100.42879842]
mat_Sqrt:  [[0.15]]
grads:  [0.1754898]
Stock Position:  0.1754898008545498
Bond Position:  [-26.30562113]


portfolio before change:  [-8.55402068]
curr_Stock_Price:  101.17333751827617
curr_Factors:  [101.17333752]
mat_Sqrt:  [[0.15]]
grads:  [0.03174067]
Stock Position:  0.031740667743712814
Bond Position:  [-11.76532997]


portfolio before change:  [-8.52118497]
curr_Stock_Price:  102.25417405212336
curr_Factors:  [102.25417405]
mat_Sqrt:  [[0.15]]
grads:  [0.11494607]
Stock Position:  0.11494607129283581
Bond Position:  [-20.27490055]


portfolio before change:  [-8.37999498]
curr_Stock_Price:  103.50453871782348
curr_Factors:  [103.50453872]
mat_Sqrt:  [[0.15]]
grads:  [0.0702091]
Stock Position:  0.07020910011899566
Bond Position:  [-15.6469555]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.28420522]
Stock Price:  104.89674793832562
PL:  [-13.18095316]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.08794605e-03]
 [ 3.37492674e-02]
 [-5.18670176e-03]
 [-6.53186458e-03]
 [-7.46606492e-03]
 [ 3.53319110e-02]
 [ 3.55603732e-03]
 [ 3.12914423e-03]
 [ 1.99036794e-03]
 [ 2.34427963e-02]
 [ 2.00967133e-02]
 [-1.33935813e-02]
 [ 1.71842754e-02]
 [ 6.51736206e-03]
 [ 1.90819562e-03]
 [-2.87182224e-03]
 [-5.79198974e-03]
 [ 7.23409242e-03]
 [ 1.36083550e-02]
 [ 1.43378059e-02]
 [ 6.29562016e-04]
 [-1.20785992e-02]
 [ 4.05651383e-03]
 [-1.23245676e-02]
 [ 7.89021967e-04]
 [ 3.70336096e-03]
 [ 1.94878704e-03]
 [ 1.03057891e-03]
 [ 4.96848798e-03]
 [-4.72067305e-03]
 [-1.49366794e-02]
 [ 8.93667823e-03]
 [ 4.56448109e-04]
 [ 5.01851005e-03]
 [-2.02636680e-02]
 [ 1.02783508e-02]
 [ 3.80292763e-03]
 [ 2.30159947e-02]
 [ 9.88339292e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.5610959]
curr_Stock_Price:  99.66078982113102
curr_Factors:  [99.66078982]
mat_Sqrt:  [[0.15]]
grads:  [-0.02058631]
Stock Position:  -0.020586306972317295
Bond Position:  [-3.50944829]


portfolio before change:  [-5.56085756]
curr_Stock_Price:  99.62790119940281
curr_Factors:  [99.6279012]
mat_Sqrt:  [[0.15]]
grads:  [0.22499512]
Stock Position:  0.22499511614049325
Bond Position:  [-27.97664876]


portfolio before change:  [-5.58217332]
curr_Stock_Price:  99.54870629326012
curr_Factors:  [99.54870629]
mat_Sqrt:  [[0.15]]
grads:  [-0.03457801]
Stock Position:  -0.034578011744412974
Bond Position:  [-2.13997699]


portfolio before change:  [-5.59345548]
curr_Stock_Price:  99.86725105556837
curr_Factors:  [99.86725106]
mat_Sqrt:  [[0.15]]
grads:  [-0.04354576]
Stock Position:  -0.04354576387876736
Bond Position:  [-1.24465975]


portfolio before change:  [-5.58382074]
curr_Stock_Price:  99.64242253211161
curr_Factors:  [99.64242253]
mat_Sqrt:  [[0.15]]
grads:  [-0.04977377]
Stock Position:  -0.04977376610538817
Bond Position:  [-0.62424211]


portfolio before change:  [-5.53294334]
curr_Stock_Price:  98.61868170810412
curr_Factors:  [98.61868171]
mat_Sqrt:  [[0.15]]
grads:  [0.23554607]
Stock Position:  0.2355460732419362
Bond Position:  [-28.76218657]


portfolio before change:  [-5.85671171]
curr_Stock_Price:  97.25940252477804
curr_Factors:  [97.25940252]
mat_Sqrt:  [[0.15]]
grads:  [0.02370692]
Stock Position:  0.023706915434075063
Bond Position:  [-8.16243215]


portfolio before change:  [-5.86720054]
curr_Stock_Price:  96.86000611473763
curr_Factors:  [96.86000611]
mat_Sqrt:  [[0.15]]
grads:  [0.02086096]
Stock Position:  0.020860961543661245
Bond Position:  [-7.8877934]


portfolio before change:  [-5.85223036]
curr_Stock_Price:  97.6248900692759
curr_Factors:  [97.62489007]
mat_Sqrt:  [[0.15]]
grads:  [0.01326912]
Stock Position:  0.013269119572325249
Bond Position:  [-7.1476267]


portfolio before change:  [-5.84881666]
curr_Stock_Price:  97.94949398295526
curr_Factors:  [97.94949398]
mat_Sqrt:  [[0.15]]
grads:  [0.15628531]
Stock Position:  0.15628530854821296
Bond Position:  [-21.15688355]


portfolio before change:  [-5.67418587]
curr_Stock_Price:  99.08380126944134
curr_Factors:  [99.08380127]
mat_Sqrt:  [[0.15]]
grads:  [0.13397809]
Stock Position:  0.13397808877878553
Bond Position:  [-18.9492442]


portfolio before change:  [-5.41055054]
curr_Stock_Price:  101.06923141451244
curr_Factors:  [101.06923141]
mat_Sqrt:  [[0.15]]
grads:  [-0.08929054]
Stock Position:  -0.08929054167375014
Bond Position:  [3.61397588]


portfolio before change:  [-5.28130565]
curr_Stock_Price:  99.62682649856553
curr_Factors:  [99.6268265]
mat_Sqrt:  [[0.15]]
grads:  [0.11456184]
Stock Position:  0.1145618357767822
Bond Position:  [-16.69473779]


portfolio before change:  [-5.27276226]
curr_Stock_Price:  99.71961799825404
curr_Factors:  [99.719618]
mat_Sqrt:  [[0.15]]
grads:  [0.04344908]
Stock Position:  0.0434490804316971
Bond Position:  [-9.60548796]


portfolio before change:  [-5.22017927]
curr_Stock_Price:  100.95747497486668
curr_Factors:  [100.95747497]
mat_Sqrt:  [[0.15]]
grads:  [0.0127213]
Stock Position:  0.012721304103708992
Bond Position:  [-6.50449001]


portfolio before change:  [-5.20700977]
curr_Stock_Price:  102.05662415759178
curr_Factors:  [102.05662416]
mat_Sqrt:  [[0.15]]
grads:  [-0.01914548]
Stock Position:  -0.01914548157729897
Bond Position:  [-3.25308655]


portfolio before change:  [-5.19855691]
curr_Stock_Price:  101.59387643480508
curr_Factors:  [101.59387643]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861326]
Stock Position:  -0.038613264930302114
Bond Position:  [-1.27568564]


portfolio before change:  [-5.23106916]
curr_Stock_Price:  102.43174358658138
curr_Factors:  [102.43174359]
mat_Sqrt:  [[0.15]]
grads:  [0.04822728]
Stock Position:  0.048227282829321906
Bond Position:  [-10.17107383]


portfolio before change:  [-5.24490211]
curr_Stock_Price:  102.1712792959276
curr_Factors:  [102.1712793]
mat_Sqrt:  [[0.15]]
grads:  [0.09072237]
Stock Position:  0.09072236691333813
Bond Position:  [-14.5141224]


portfolio before change:  [-5.16342989]
curr_Stock_Price:  103.0893175195059
curr_Factors:  [103.08931752]
mat_Sqrt:  [[0.15]]
grads:  [0.09558537]
Stock Position:  0.09558537284958242
Bond Position:  [-15.01726074]


portfolio before change:  [-5.05959914]
curr_Stock_Price:  104.19521920907764
curr_Factors:  [104.19521921]
mat_Sqrt:  [[0.15]]
grads:  [0.00419708]
Stock Position:  0.004197080107897924
Bond Position:  [-5.49691482]


portfolio before change:  [-5.05768351]
curr_Stock_Price:  104.81536148107274
curr_Factors:  [104.81536148]
mat_Sqrt:  [[0.15]]
grads:  [-0.08052399]
Stock Position:  -0.08052399443351661
Bond Position:  [3.38246808]


portfolio before change:  [-4.92797978]
curr_Stock_Price:  103.20986612863497
curr_Factors:  [103.20986613]
mat_Sqrt:  [[0.15]]
grads:  [0.02704343]
Stock Position:  0.02704342551512322
Bond Position:  [-7.7191281]


portfolio before change:  [-4.94729545]
curr_Stock_Price:  102.53130093461856
curr_Factors:  [102.53130093]
mat_Sqrt:  [[0.15]]
grads:  [-0.08216378]
Stock Position:  -0.08216378392435048
Bond Position:  [3.4770642]


portfolio before change:  [-4.96046411]
curr_Stock_Price:  102.6968643078331
curr_Factors:  [102.69686431]
mat_Sqrt:  [[0.15]]
grads:  [0.00526015]
Stock Position:  0.00526014644647546
Bond Position:  [-5.50066465]


portfolio before change:  [-4.95937329]
curr_Stock_Price:  103.03496179603269
curr_Factors:  [103.0349618]
mat_Sqrt:  [[0.15]]
grads:  [0.02468907]
Stock Position:  0.024689073042167258
Bond Position:  [-7.50321099]


portfolio before change:  [-4.95231135]
curr_Stock_Price:  103.35898787100227
curr_Factors:  [103.35898787]
mat_Sqrt:  [[0.15]]
grads:  [0.01299191]
Stock Position:  0.012991913605650043
Bond Position:  [-6.29514239]


portfolio before change:  [-4.95944558]
curr_Stock_Price:  102.87043109097287
curr_Factors:  [102.87043109]
mat_Sqrt:  [[0.15]]
grads:  [0.00687053]
Stock Position:  0.006870526071541209
Bond Position:  [-5.66621956]


portfolio before change:  [-4.95276323]
curr_Stock_Price:  103.94613729951848
curr_Factors:  [103.9461373]
mat_Sqrt:  [[0.15]]
grads:  [0.03312325]
Stock Position:  0.03312325323080748
Bond Position:  [-8.39579746]


portfolio before change:  [-4.94229053]
curr_Stock_Price:  104.29399675110498
curr_Factors:  [104.29399675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03147115]
Stock Position:  -0.03147115364586328
Bond Position:  [-1.66003814]


portfolio before change:  [-4.9687217]
curr_Stock_Price:  105.1272564813554
curr_Factors:  [105.12725648]
mat_Sqrt:  [[0.15]]
grads:  [-0.09957786]
Stock Position:  -0.09957786264859286
Bond Position:  [5.49962581]


portfolio before change:  [-4.7536038]
curr_Stock_Price:  102.97386217583453
curr_Factors:  [102.97386218]
mat_Sqrt:  [[0.15]]
grads:  [0.05957785]
Stock Position:  0.05957785484273208
Bond Position:  [-10.88856561]


portfolio before change:  [-4.71076737]
curr_Stock_Price:  103.71570795039061
curr_Factors:  [103.71570795]
mat_Sqrt:  [[0.15]]
grads:  [0.00304299]
Stock Position:  0.00304298739177632
Bond Position:  [-5.02637297]


portfolio before change:  [-4.7096586]
curr_Stock_Price:  104.28656554476461
curr_Factors:  [104.28656554]
mat_Sqrt:  [[0.15]]
grads:  [0.03345673]
Stock Position:  0.03345673365306931
Bond Position:  [-8.19874644]


portfolio before change:  [-4.72965287]
curr_Stock_Price:  103.71958368742004
curr_Factors:  [103.71958369]
mat_Sqrt:  [[0.15]]
grads:  [-0.13509112]
Stock Position:  -0.13509112016172015
Bond Position:  [9.28194188]


portfolio before change:  [-4.74441491]
curr_Stock_Price:  103.83744751696533
curr_Factors:  [103.83744752]
mat_Sqrt:  [[0.15]]
grads:  [0.06852234]
Stock Position:  0.06852233841569089
Bond Position:  [-11.85959963]


portfolio before change:  [-4.76052613]
curr_Stock_Price:  103.62395974557636
curr_Factors:  [103.62395975]
mat_Sqrt:  [[0.15]]
grads:  [0.02535285]
Stock Position:  0.025352850861307803
Bond Position:  [-7.38768893]


portfolio before change:  [-4.73186154]
curr_Stock_Price:  104.79101224476844
curr_Factors:  [104.79101224]
mat_Sqrt:  [[0.15]]
grads:  [0.15343996]
Stock Position:  0.1534399643856043
Bond Position:  [-20.81099073]


portfolio before change:  [-4.78368781]
curr_Stock_Price:  104.47020448319415
curr_Factors:  [104.47020448]
mat_Sqrt:  [[0.15]]
grads:  [0.06588929]
Stock Position:  0.06588928615368216
Bond Position:  [-11.66715501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.77108058]
Stock Price:  104.68367952971269
PL:  [-9.45476011]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 6.87478490e-03]
 [ 4.34201147e-02]
 [-3.92609756e-03]
 [-2.14989785e-03]
 [-2.45549002e-03]
 [ 3.23537758e-02]
 [ 3.61541942e-03]
 [-1.42551472e-03]
 [ 2.04372838e-02]
 [ 2.34435218e-02]
 [ 2.13281201e-02]
 [-1.02040472e-02]
 [-1.26774510e-02]
 [ 1.49033171e-02]
 [-1.83219585e-02]
 [-9.20999826e-04]
 [-6.07971715e-03]
 [-6.06094504e-03]
 [ 1.78356288e-03]
 [ 1.57206071e-02]
 [-2.19648237e-02]
 [-2.25379740e-02]
 [ 4.41202862e-03]
 [-1.14263429e-02]
 [ 1.03603995e-02]
 [-1.08010292e-03]
 [ 3.19735901e-02]
 [-5.21340210e-03]
 [-3.37158199e-02]
 [-1.09028857e-02]
 [ 3.49413137e-02]
 [ 6.57226204e-03]
 [-1.46752460e-02]
 [-3.50489448e-02]
 [-2.33290946e-02]
 [ 3.70126596e-02]
 [-3.48227113e-03]
 [ 4.73301920e-04]
 [ 1.28315359e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.59730265]
curr_Stock_Price:  100.3056489701812
curr_Factors:  [100.30564897]
mat_Sqrt:  [[0.15]]
grads:  [0.0458319]
Stock Position:  0.04583189935607797
Bond Position:  [4.00010424]


portfolio before change:  [8.59041076]
curr_Stock_Price:  100.14436539849241
curr_Factors:  [100.1443654]
mat_Sqrt:  [[0.15]]
grads:  [0.28946743]
Stock Position:  0.2894674310919859
Bond Position:  [-20.39812143]


portfolio before change:  [8.85952553]
curr_Stock_Price:  101.08286369789786
curr_Factors:  [101.0828637]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617398]
Stock Position:  -0.02617398374547791
Bond Position:  [11.50526676]


portfolio before change:  [8.86702784]
curr_Stock_Price:  100.85118077938023
curr_Factors:  [100.85118078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433265]
Stock Position:  -0.014332652322094429
Bond Position:  [10.31249275]


portfolio before change:  [8.8580942]
curr_Stock_Price:  101.56443206413621
curr_Factors:  [101.56443206]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636993]
Stock Position:  -0.016369933435118347
Bond Position:  [10.5206972]


portfolio before change:  [8.86986555]
curr_Stock_Price:  100.92568922618027
curr_Factors:  [100.92568923]
mat_Sqrt:  [[0.15]]
grads:  [0.21569184]
Stock Position:  0.21569183859797
Bond Position:  [-12.89898192]


portfolio before change:  [8.62483646]
curr_Stock_Price:  99.79715036511509
curr_Factors:  [99.79715037]
mat_Sqrt:  [[0.15]]
grads:  [0.0241028]
Stock Position:  0.024102796155093413
Bond Position:  [6.21944608]


portfolio before change:  [8.6038463]
curr_Stock_Price:  98.89403377869408
curr_Factors:  [98.89403378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00950343]
Stock Position:  -0.00950343145021265
Bond Position:  [9.54367897]


portfolio before change:  [8.6221874]
curr_Stock_Price:  97.08962550903931
curr_Factors:  [97.08962551]
mat_Sqrt:  [[0.15]]
grads:  [0.13624856]
Stock Position:  0.13624855892172583
Bond Position:  [-4.60613416]


portfolio before change:  [8.70736568]
curr_Stock_Price:  97.71901991624341
curr_Factors:  [97.71901992]
mat_Sqrt:  [[0.15]]
grads:  [0.15629015]
Stock Position:  0.1562901454744022
Bond Position:  [-6.56515416]


portfolio before change:  [8.65787449]
curr_Stock_Price:  97.40760872432455
curr_Factors:  [97.40760872]
mat_Sqrt:  [[0.15]]
grads:  [0.14218747]
Stock Position:  0.14218746754880202
Bond Position:  [-5.19226672]


portfolio before change:  [8.72476091]
curr_Stock_Price:  97.88258374823376
curr_Factors:  [97.88258375]
mat_Sqrt:  [[0.15]]
grads:  [-0.06802698]
Stock Position:  -0.06802698113108635
Bond Position:  [15.38341759]


portfolio before change:  [8.77706786]
curr_Stock_Price:  97.14193783952182
curr_Factors:  [97.14193784]
mat_Sqrt:  [[0.15]]
grads:  [-0.08451634]
Stock Position:  -0.08451633997642628
Bond Position:  [16.98714891]


portfolio before change:  [8.79460645]
curr_Stock_Price:  96.95954634280564
curr_Factors:  [96.95954634]
mat_Sqrt:  [[0.15]]
grads:  [0.09935545]
Stock Position:  0.09935544755498174
Bond Position:  [-0.83885267]


portfolio before change:  [8.78699581]
curr_Stock_Price:  96.88400166856623
curr_Factors:  [96.88400167]
mat_Sqrt:  [[0.15]]
grads:  [-0.12214639]
Stock Position:  -0.12214638985914103
Bond Position:  [20.62102685]


portfolio before change:  [8.94589313]
curr_Stock_Price:  95.60422966791646
curr_Factors:  [95.60422967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614]
Stock Position:  -0.006139998837057451
Bond Position:  [9.53290299]


portfolio before change:  [8.94604439]
curr_Stock_Price:  95.7736798188238
curr_Factors:  [95.77367982]
mat_Sqrt:  [[0.15]]
grads:  [-0.04053145]
Stock Position:  -0.0405314476726409
Bond Position:  [12.82789029]


portfolio before change:  [8.96764692]
curr_Stock_Price:  95.28026202980301
curr_Factors:  [95.28026203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404063]
Stock Position:  -0.04040630029488824
Bond Position:  [12.8175698]


portfolio before change:  [9.00435762]
curr_Stock_Price:  94.4113776084912
curr_Factors:  [94.41137761]
mat_Sqrt:  [[0.15]]
grads:  [0.01189042]
Stock Position:  0.01189041917681501
Bond Position:  [7.88176676]


portfolio before change:  [9.00439747]
curr_Stock_Price:  94.33186561205424
curr_Factors:  [94.33186561]
mat_Sqrt:  [[0.15]]
grads:  [0.10480405]
Stock Position:  0.10480404764810976
Bond Position:  [-0.88196387]


portfolio before change:  [8.94848115]
curr_Stock_Price:  93.79938554805827
curr_Factors:  [93.79938555]
mat_Sqrt:  [[0.15]]
grads:  [-0.14643216]
Stock Position:  -0.14643215811856491
Bond Position:  [22.68372761]


portfolio before change:  [8.73799723]
curr_Stock_Price:  95.25616639886618
curr_Factors:  [95.2561664]
mat_Sqrt:  [[0.15]]
grads:  [-0.15025316]
Stock Position:  -0.1502531600989922
Bond Position:  [23.05053725]


portfolio before change:  [8.79056931]
curr_Stock_Price:  94.92545398582496
curr_Factors:  [94.92545399]
mat_Sqrt:  [[0.15]]
grads:  [0.02941352]
Stock Position:  0.029413524154772032
Bond Position:  [5.99847718]


portfolio before change:  [8.79507187]
curr_Stock_Price:  95.05303800717984
curr_Factors:  [95.05303801]
mat_Sqrt:  [[0.15]]
grads:  [-0.07617562]
Stock Position:  -0.07617561951721115
Bond Position:  [16.03579592]


portfolio before change:  [8.83866148]
curr_Stock_Price:  94.50712831275844
curr_Factors:  [94.50712831]
mat_Sqrt:  [[0.15]]
grads:  [0.06906933]
Stock Position:  0.06906932984324955
Bond Position:  [2.31111746]


portfolio before change:  [8.85251232]
curr_Stock_Price:  94.70348089915373
curr_Factors:  [94.7034809]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720069]
Stock Position:  -0.007200686154615633
Bond Position:  [9.53444237]


portfolio before change:  [8.85857401]
curr_Stock_Price:  94.02718397654856
curr_Factors:  [94.02718398]
mat_Sqrt:  [[0.15]]
grads:  [0.21315727]
Stock Position:  0.2131572676206862
Bond Position:  [-11.18400361]


portfolio before change:  [8.82608961]
curr_Stock_Price:  93.88134653671912
curr_Factors:  [93.88134654]
mat_Sqrt:  [[0.15]]
grads:  [-0.03475601]
Stock Position:  -0.034756013999754025
Bond Position:  [12.089031]


portfolio before change:  [8.77981488]
curr_Stock_Price:  95.25624392913527
curr_Factors:  [95.25624393]
mat_Sqrt:  [[0.15]]
grads:  [-0.22477213]
Stock Position:  -0.22477213289697412
Bond Position:  [30.190764]


portfolio before change:  [8.61406418]
curr_Stock_Price:  96.01045120301612
curr_Factors:  [96.0104512]
mat_Sqrt:  [[0.15]]
grads:  [-0.0726859]
Stock Position:  -0.07268590480927598
Bond Position:  [15.5926707]


portfolio before change:  [8.53685986]
curr_Stock_Price:  97.0994316939914
curr_Factors:  [97.09943169]
mat_Sqrt:  [[0.15]]
grads:  [0.23294209]
Stock Position:  0.23294209100113192
Bond Position:  [-14.0816848]


portfolio before change:  [8.53145061]
curr_Stock_Price:  97.08376716448534
curr_Factors:  [97.08376716]
mat_Sqrt:  [[0.15]]
grads:  [0.04381508]
Stock Position:  0.04381508026697306
Bond Position:  [4.27771756]


portfolio before change:  [8.52071095]
curr_Stock_Price:  96.82644934388522
curr_Factors:  [96.82644934]
mat_Sqrt:  [[0.15]]
grads:  [-0.09783497]
Stock Position:  -0.09783497301854507
Bond Position:  [17.99372401]


portfolio before change:  [8.64629429]
curr_Stock_Price:  95.56581647546274
curr_Factors:  [95.56581648]
mat_Sqrt:  [[0.15]]
grads:  [-0.23365963]
Stock Position:  -0.2336596323254482
Bond Position:  [30.97616783]


portfolio before change:  [8.68655599]
curr_Stock_Price:  95.41007954715434
curr_Factors:  [95.41007955]
mat_Sqrt:  [[0.15]]
grads:  [-0.1555273]
Stock Position:  -0.15552729758802555
Bond Position:  [23.52542782]


portfolio before change:  [8.65632042]
curr_Stock_Price:  95.62339535758416
curr_Factors:  [95.62339536]
mat_Sqrt:  [[0.15]]
grads:  [0.24675106]
Stock Position:  0.24675106380170408
Bond Position:  [-14.93885411]


portfolio before change:  [8.68936852]
curr_Stock_Price:  95.76489656548651
curr_Factors:  [95.76489657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321514]
Stock Position:  -0.023215140854237305
Bond Position:  [10.91256408]


portfolio before change:  [8.685254]
curr_Stock_Price:  96.00089227814956
curr_Factors:  [96.00089228]
mat_Sqrt:  [[0.15]]
grads:  [0.00315535]
Stock Position:  0.003155346134429502
Bond Position:  [8.38233796]


portfolio before change:  [8.68843075]
curr_Stock_Price:  96.67558639952799
curr_Factors:  [96.6755864]
mat_Sqrt:  [[0.15]]
grads:  [0.08554357]
Stock Position:  0.08554357252702845
Bond Position:  [0.41845572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.72786185]
Stock Price:  97.13592236319231
PL:  [8.72786185]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.63811380e-02]
 [ 8.16798472e-03]
 [-1.57416099e-02]
 [-7.78042931e-03]
 [-4.49390693e-03]
 [ 5.28338404e-02]
 [ 3.55585087e-03]
 [ 7.06796281e-03]
 [ 6.15590630e-02]
 [ 2.32455957e-02]
 [ 2.24577083e-02]
 [-1.58189071e-03]
 [-3.30253711e-02]
 [ 1.55570794e-02]
 [ 7.18503231e-03]
 [-1.29251137e-03]
 [-6.07780297e-03]
 [ 1.11952799e-03]
 [ 8.32263313e-04]
 [-2.74125743e-02]
 [-4.68149355e-03]
 [-1.35962929e-02]
 [ 6.52229545e-03]
 [-6.95949358e-03]
 [ 1.38028224e-02]
 [ 3.32797185e-03]
 [ 1.77316895e-02]
 [-3.92420942e-03]
 [-2.07830558e-02]
 [-1.17720557e-02]
 [ 3.89688783e-02]
 [ 5.57118044e-03]
 [-1.27165126e-02]
 [-4.45280175e-02]
 [-2.22762273e-02]
 [ 3.85493739e-02]
 [ 3.10946829e-03]
 [ 7.57622693e-03]
 [ 5.13725323e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.97219528]
curr_Stock_Price:  98.64005273576183
curr_Factors:  [98.64005274]
mat_Sqrt:  [[0.15]]
grads:  [0.17587425]
Stock Position:  0.1758742530053507
Bond Position:  [-45.32044087]


portfolio before change:  [-28.01010454]
curr_Stock_Price:  98.45671808582524
curr_Factors:  [98.45671809]
mat_Sqrt:  [[0.15]]
grads:  [0.05445323]
Stock Position:  0.0544532314810349
Bond Position:  [-33.371391]


portfolio before change:  [-28.02054538]
curr_Stock_Price:  98.34158887851893
curr_Factors:  [98.34158888]
mat_Sqrt:  [[0.15]]
grads:  [-0.10494407]
Stock Position:  -0.10494406622464057
Bond Position:  [-17.70017916]


portfolio before change:  [-27.99821369]
curr_Stock_Price:  98.10770855083858
curr_Factors:  [98.10770855]
mat_Sqrt:  [[0.15]]
grads:  [-0.05186953]
Stock Position:  -0.05186952871531323
Bond Position:  [-22.90941308]


portfolio before change:  [-27.95683412]
curr_Stock_Price:  97.25473342009052
curr_Factors:  [97.25473342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02995938]
Stock Position:  -0.02995937950381661
Bond Position:  [-25.04314266]


portfolio before change:  [-27.95101583]
curr_Stock_Price:  96.95603289723432
curr_Factors:  [96.9560329]
mat_Sqrt:  [[0.15]]
grads:  [0.3522256]
Stock Position:  0.35222560271525355
Bond Position:  [-62.10141295]


portfolio before change:  [-27.85305325]
curr_Stock_Price:  97.25619773754275
curr_Factors:  [97.25619774]
mat_Sqrt:  [[0.15]]
grads:  [0.02370567]
Stock Position:  0.023705672497466756
Bond Position:  [-30.15857682]


portfolio before change:  [-27.89305602]
curr_Stock_Price:  95.72775709715383
curr_Factors:  [95.7277571]
mat_Sqrt:  [[0.15]]
grads:  [0.04711975]
Stock Position:  0.047119752065409366
Bond Position:  [-32.4037242]


portfolio before change:  [-27.88915956]
curr_Stock_Price:  95.89641623901174
curr_Factors:  [95.89641624]
mat_Sqrt:  [[0.15]]
grads:  [0.41039375]
Stock Position:  0.41039375357021507
Bond Position:  [-67.24444978]


portfolio before change:  [-28.43786624]
curr_Stock_Price:  94.57987428129428
curr_Factors:  [94.57987428]
mat_Sqrt:  [[0.15]]
grads:  [0.15497064]
Stock Position:  0.1549706382945928
Bond Position:  [-43.09496973]


portfolio before change:  [-28.46324134]
curr_Stock_Price:  94.45089573449532
curr_Factors:  [94.45089573]
mat_Sqrt:  [[0.15]]
grads:  [0.14971806]
Stock Position:  0.14971805522433665
Bond Position:  [-42.60424576]


portfolio before change:  [-28.56265551]
curr_Stock_Price:  93.82245909148888
curr_Factors:  [93.82245909]
mat_Sqrt:  [[0.15]]
grads:  [-0.01054594]
Stock Position:  -0.010545938041849341
Bond Position:  [-27.57320967]


portfolio before change:  [-28.57173966]
curr_Stock_Price:  94.35700418237408
curr_Factors:  [94.35700418]
mat_Sqrt:  [[0.15]]
grads:  [-0.22016914]
Stock Position:  -0.22016914078797709
Bond Position:  [-7.79723912]


portfolio before change:  [-28.46772255]
curr_Stock_Price:  93.88013526499076
curr_Factors:  [93.88013526]
mat_Sqrt:  [[0.15]]
grads:  [0.10371386]
Stock Position:  0.10371386254969422
Bond Position:  [-38.204394]


portfolio before change:  [-28.44841992]
curr_Stock_Price:  94.112297874201
curr_Factors:  [94.11229787]
mat_Sqrt:  [[0.15]]
grads:  [0.04790022]
Stock Position:  0.047900215382089786
Bond Position:  [-32.95641926]


portfolio before change:  [-28.39707602]
curr_Stock_Price:  95.27019900561156
curr_Factors:  [95.27019901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00861674]
Stock Position:  -0.00861674246107626
Bond Position:  [-27.57615725]


portfolio before change:  [-28.40437792]
curr_Stock_Price:  95.71754541011845
curr_Factors:  [95.71754541]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051869]
Stock Position:  -0.0405186864991854
Bond Position:  [-24.52602871]


portfolio before change:  [-28.47588857]
curr_Stock_Price:  97.4067586094295
curr_Factors:  [97.40675861]
mat_Sqrt:  [[0.15]]
grads:  [0.00746352]
Stock Position:  0.007463519958689011
Bond Position:  [-29.20288585]


portfolio before change:  [-28.48247857]
curr_Stock_Price:  97.01292049512284
curr_Factors:  [97.0129205]
mat_Sqrt:  [[0.15]]
grads:  [0.00554842]
Stock Position:  0.005548422083916863
Bond Position:  [-29.0207472]


portfolio before change:  [-28.47595068]
curr_Stock_Price:  98.84329841621891
curr_Factors:  [98.84329842]
mat_Sqrt:  [[0.15]]
grads:  [-0.1827505]
Stock Position:  -0.18275049531069018
Bond Position:  [-10.41228894]


portfolio before change:  [-28.29776045]
curr_Stock_Price:  97.86112950745053
curr_Factors:  [97.86112951]
mat_Sqrt:  [[0.15]]
grads:  [-0.03120996]
Stock Position:  -0.031209957004598565
Bond Position:  [-25.2435188]


portfolio before change:  [-28.30966004]
curr_Stock_Price:  98.1412952063112
curr_Factors:  [98.14129521]
mat_Sqrt:  [[0.15]]
grads:  [-0.09064195]
Stock Position:  -0.0906419527353974
Bond Position:  [-19.4139414]


portfolio before change:  [-28.33980979]
curr_Stock_Price:  98.447145350473
curr_Factors:  [98.44714535]
mat_Sqrt:  [[0.15]]
grads:  [0.04348197]
Stock Position:  0.04348196963401723
Bond Position:  [-32.62048558]


portfolio before change:  [-28.35505996]
curr_Stock_Price:  98.19020307091223
curr_Factors:  [98.19020307]
mat_Sqrt:  [[0.15]]
grads:  [-0.04639662]
Stock Position:  -0.04639662384179725
Bond Position:  [-23.79936605]


portfolio before change:  [-28.34720859]
curr_Stock_Price:  97.95685685096976
curr_Factors:  [97.95685685]
mat_Sqrt:  [[0.15]]
grads:  [0.09201882]
Stock Position:  0.09201881632994607
Bond Position:  [-37.36108261]


portfolio before change:  [-28.4450469]
curr_Stock_Price:  96.94436957995123
curr_Factors:  [96.94436958]
mat_Sqrt:  [[0.15]]
grads:  [0.02218648]
Stock Position:  0.022186478972521743
Bond Position:  [-30.59590112]


portfolio before change:  [-28.45614274]
curr_Stock_Price:  96.6166425850731
curr_Factors:  [96.61664259]
mat_Sqrt:  [[0.15]]
grads:  [0.11821126]
Stock Position:  0.11821126326336316
Bond Position:  [-39.87731811]


portfolio before change:  [-28.43148145]
curr_Stock_Price:  96.86743312906293
curr_Factors:  [96.86743313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261614]
Stock Position:  -0.02616139613144423
Bond Position:  [-25.89729416]


portfolio before change:  [-28.42934545]
curr_Stock_Price:  96.66204041421744
curr_Factors:  [96.66204041]
mat_Sqrt:  [[0.15]]
grads:  [-0.13855371]
Stock Position:  -0.13855370561618188
Bond Position:  [-15.03646156]


portfolio before change:  [-28.40389486]
curr_Stock_Price:  96.46478649148354
curr_Factors:  [96.46478649]
mat_Sqrt:  [[0.15]]
grads:  [-0.07848037]
Stock Position:  -0.07848037164320694
Bond Position:  [-20.83330257]


portfolio before change:  [-28.41076828]
curr_Stock_Price:  96.51918347260877
curr_Factors:  [96.51918347]
mat_Sqrt:  [[0.15]]
grads:  [0.25979252]
Stock Position:  0.2597925220125409
Bond Position:  [-53.48573038]


portfolio before change:  [-28.3554675]
curr_Stock_Price:  96.75778508104072
curr_Factors:  [96.75778508]
mat_Sqrt:  [[0.15]]
grads:  [0.0371412]
Stock Position:  0.03714120294672274
Bond Position:  [-31.94916804]


portfolio before change:  [-28.33063406]
curr_Stock_Price:  97.53394024553822
curr_Factors:  [97.53394025]
mat_Sqrt:  [[0.15]]
grads:  [-0.08477675]
Stock Position:  -0.08477675080392849
Bond Position:  [-20.06202352]


portfolio before change:  [-28.39518164]
curr_Stock_Price:  98.26574072292185
curr_Factors:  [98.26574072]
mat_Sqrt:  [[0.15]]
grads:  [-0.29685345]
Stock Position:  -0.2968534498705455
Bond Position:  [0.7753425]


portfolio before change:  [-28.39974809]
curr_Stock_Price:  98.28145006039138
curr_Factors:  [98.28145006]
mat_Sqrt:  [[0.15]]
grads:  [-0.14850818]
Stock Position:  -0.14850818214728684
Bond Position:  [-13.8041486]


portfolio before change:  [-28.45525683]
curr_Stock_Price:  98.64360598950479
curr_Factors:  [98.64360599]
mat_Sqrt:  [[0.15]]
grads:  [0.25699583]
Stock Position:  0.2569958261790597
Bond Position:  [-53.80625185]


portfolio before change:  [-28.34904968]
curr_Stock_Price:  99.08304251464165
curr_Factors:  [99.08304251]
mat_Sqrt:  [[0.15]]
grads:  [0.02072979]
Stock Position:  0.020729788603442937
Bond Position:  [-30.40302021]


portfolio before change:  [-28.35837771]
curr_Stock_Price:  98.81640131025692
curr_Factors:  [98.81640131]
mat_Sqrt:  [[0.15]]
grads:  [0.05050818]
Stock Position:  0.05050817954018427
Bond Position:  [-33.34941425]


portfolio before change:  [-28.33138319]
curr_Stock_Price:  99.43339967065268
curr_Factors:  [99.43339967]
mat_Sqrt:  [[0.15]]
grads:  [0.03424835]
Stock Position:  0.03424835487467695
Bond Position:  [-31.73681354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.37430412]
Stock Price:  98.29601414340331
PL:  [-28.37430412]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.99843963e-02]
 [-5.22769471e-03]
 [ 4.66095876e-03]
 [-2.47618861e-03]
 [-2.76246237e-03]
 [ 2.49694029e-02]
 [ 3.49054561e-03]
 [ 2.56806440e-02]
 [ 6.39144964e-03]
 [ 2.27684159e-02]
 [ 2.01333955e-02]
 [-1.01677781e-02]
 [ 2.51372125e-02]
 [ 1.87449539e-02]
 [-7.52713893e-03]
 [-3.14419724e-03]
 [-5.16799250e-03]
 [ 7.19978978e-03]
 [ 1.22640333e-02]
 [ 1.05435799e-02]
 [-5.12721758e-03]
 [-4.67448725e-03]
 [ 7.07120416e-03]
 [-9.65753781e-03]
 [ 1.28557924e-02]
 [ 7.85092639e-03]
 [-6.03901215e-03]
 [-2.08782454e-03]
 [-2.89601001e-04]
 [-9.17023326e-03]
 [-1.94093221e-02]
 [ 1.82883902e-02]
 [-8.56075667e-03]
 [-2.02005455e-02]
 [-2.09707627e-02]
 [ 2.20989057e-02]
 [ 2.46411437e-03]
 [ 2.32616291e-02]
 [ 1.01434783e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.40645051]
curr_Stock_Price:  101.20787743788846
curr_Factors:  [101.20787744]
mat_Sqrt:  [[0.15]]
grads:  [-0.33322931]
Stock Position:  -0.3332293087221063
Bond Position:  [62.13188155]


portfolio before change:  [28.37042172]
curr_Stock_Price:  101.33930575133826
curr_Factors:  [101.33930575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348513]
Stock Position:  -0.03485129806661977
Bond Position:  [31.90222807]


portfolio before change:  [28.35843461]
curr_Stock_Price:  101.79768558609234
curr_Factors:  [101.79768559]
mat_Sqrt:  [[0.15]]
grads:  [0.03107306]
Stock Position:  0.031073058404311415
Bond Position:  [25.19526918]


portfolio before change:  [28.34024181]
curr_Stock_Price:  101.11083960622057
curr_Factors:  [101.11083961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01650792]
Stock Position:  -0.016507924099941514
Bond Position:  [30.00937188]


portfolio before change:  [28.34009236]
curr_Stock_Price:  101.34714180407985
curr_Factors:  [101.3471418]
mat_Sqrt:  [[0.15]]
grads:  [-0.01841642]
Stock Position:  -0.0184164158089438
Bond Position:  [30.20654347]


portfolio before change:  [28.33818237]
curr_Stock_Price:  101.65589074128799
curr_Factors:  [101.65589074]
mat_Sqrt:  [[0.15]]
grads:  [0.16646269]
Stock Position:  0.16646268594475322
Bond Position:  [11.41626975]


portfolio before change:  [28.46106525]
curr_Stock_Price:  102.38551831111751
curr_Factors:  [102.38551831]
mat_Sqrt:  [[0.15]]
grads:  [0.0232703]
Stock Position:  0.02327030409895105
Bond Position:  [26.07852311]


portfolio before change:  [28.47838566]
curr_Stock_Price:  102.98973849254794
curr_Factors:  [102.98973849]
mat_Sqrt:  [[0.15]]
grads:  [0.17120429]
Stock Position:  0.17120429320389288
Bond Position:  [10.84610028]


portfolio before change:  [28.39439751]
curr_Stock_Price:  102.49124635504741
curr_Factors:  [102.49124636]
mat_Sqrt:  [[0.15]]
grads:  [0.04260966]
Stock Position:  0.042609664288696114
Bond Position:  [24.02727991]


portfolio before change:  [28.41409334]
curr_Stock_Price:  102.88299370357262
curr_Factors:  [102.8829937]
mat_Sqrt:  [[0.15]]
grads:  [0.15178944]
Stock Position:  0.151789439253566
Bond Position:  [12.79754141]


portfolio before change:  [28.22249006]
curr_Stock_Price:  101.61015769684549
curr_Factors:  [101.6101577]
mat_Sqrt:  [[0.15]]
grads:  [0.13422264]
Stock Position:  0.13422263646838936
Bond Position:  [14.58410681]


portfolio before change:  [28.24351581]
curr_Stock_Price:  101.75322308884041
curr_Factors:  [101.75322309]
mat_Sqrt:  [[0.15]]
grads:  [-0.06778519]
Stock Position:  -0.06778518730139531
Bond Position:  [35.14087709]


portfolio before change:  [28.3498193]
curr_Stock_Price:  100.24978824583481
curr_Factors:  [100.24978825]
mat_Sqrt:  [[0.15]]
grads:  [0.16758142]
Stock Position:  0.16758141673226826
Bond Position:  [11.54981776]


portfolio before change:  [28.55828901]
curr_Stock_Price:  101.48516323991244
curr_Factors:  [101.48516324]
mat_Sqrt:  [[0.15]]
grads:  [0.12496636]
Stock Position:  0.12496635950917333
Bond Position:  [15.87605762]


portfolio before change:  [28.55260483]
curr_Stock_Price:  101.42379620258959
curr_Factors:  [101.4237962]
mat_Sqrt:  [[0.15]]
grads:  [-0.05018093]
Stock Position:  -0.05018092617089211
Bond Position:  [33.64214486]


portfolio before change:  [28.48379375]
curr_Stock_Price:  102.87886327492267
curr_Factors:  [102.87886327]
mat_Sqrt:  [[0.15]]
grads:  [-0.02096131]
Stock Position:  -0.020961314905745716
Bond Position:  [30.64027]


portfolio before change:  [28.48238517]
curr_Stock_Price:  103.12879283201262
curr_Factors:  [103.12879283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445328]
Stock Position:  -0.03445328334265149
Bond Position:  [32.03551069]


portfolio before change:  [28.51295861]
curr_Stock_Price:  102.35763982722825
curr_Factors:  [102.35763983]
mat_Sqrt:  [[0.15]]
grads:  [0.0479986]
Stock Position:  0.047998598529488186
Bond Position:  [23.59993535]


portfolio before change:  [28.49134613]
curr_Stock_Price:  101.84590297340816
curr_Factors:  [101.84590297]
mat_Sqrt:  [[0.15]]
grads:  [0.08176022]
Stock Position:  0.081760222261919
Bond Position:  [20.16440247]


portfolio before change:  [28.43097145]
curr_Stock_Price:  101.07663658103256
curr_Factors:  [101.07663658]
mat_Sqrt:  [[0.15]]
grads:  [0.07029053]
Stock Position:  0.07029053283795876
Bond Position:  [21.32624081]


portfolio before change:  [28.40342746]
curr_Stock_Price:  100.64684994242798
curr_Factors:  [100.64684994]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418145]
Stock Position:  -0.03418145052188734
Bond Position:  [31.84368279]


portfolio before change:  [28.39666049]
curr_Stock_Price:  100.96128010616604
curr_Factors:  [100.96128011]
mat_Sqrt:  [[0.15]]
grads:  [-0.03116325]
Stock Position:  -0.03116324834911392
Bond Position:  [31.54294194]


portfolio before change:  [28.42778469]
curr_Stock_Price:  100.08906407579875
curr_Factors:  [100.08906408]
mat_Sqrt:  [[0.15]]
grads:  [0.04714136]
Stock Position:  0.0471413610946471
Bond Position:  [23.70944998]


portfolio before change:  [28.45713958]
curr_Stock_Price:  100.64889142637223
curr_Factors:  [100.64889143]
mat_Sqrt:  [[0.15]]
grads:  [-0.06438359]
Stock Position:  -0.06438358543075866
Bond Position:  [34.93727608]


portfolio before change:  [28.50309524]
curr_Stock_Price:  100.00294690488458
curr_Factors:  [100.0029469]
mat_Sqrt:  [[0.15]]
grads:  [0.08570528]
Stock Position:  0.08570528245402399
Bond Position:  [19.93231443]


portfolio before change:  [28.52875605]
curr_Stock_Price:  100.27328167026975
curr_Factors:  [100.27328167]
mat_Sqrt:  [[0.15]]
grads:  [0.05233951]
Stock Position:  0.052339509291795885
Bond Position:  [23.28050169]


portfolio before change:  [28.46137233]
curr_Stock_Price:  98.93024327924516
curr_Factors:  [98.93024328]
mat_Sqrt:  [[0.15]]
grads:  [-0.04026008]
Stock Position:  -0.04026008100916399
Bond Position:  [32.44431194]


portfolio before change:  [28.43405973]
curr_Stock_Price:  99.70938691677877
curr_Factors:  [99.70938692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01391883]
Stock Position:  -0.013918830255183815
Bond Position:  [29.82189776]


portfolio before change:  [28.44175071]
curr_Stock_Price:  99.42466414864447
curr_Factors:  [99.42466415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00193067]
Stock Position:  -0.0019306733386549512
Bond Position:  [28.63370726]


portfolio before change:  [28.44389407]
curr_Stock_Price:  100.16848778707259
curr_Factors:  [100.16848779]
mat_Sqrt:  [[0.15]]
grads:  [-0.06113489]
Stock Position:  -0.061134888390200114
Bond Position:  [34.56768339]


portfolio before change:  [28.45319252]
curr_Stock_Price:  100.08707407507141
curr_Factors:  [100.08707408]
mat_Sqrt:  [[0.15]]
grads:  [-0.12939548]
Stock Position:  -0.12939548090740727
Bond Position:  [41.4040076]


portfolio before change:  [28.41646346]
curr_Stock_Price:  100.41092526691837
curr_Factors:  [100.41092527]
mat_Sqrt:  [[0.15]]
grads:  [0.1219226]
Stock Position:  0.12192260108089886
Bond Position:  [16.17410227]


portfolio before change:  [28.33610463]
curr_Stock_Price:  99.73524477808952
curr_Factors:  [99.73524478]
mat_Sqrt:  [[0.15]]
grads:  [-0.05707171]
Stock Position:  -0.0570717111665432
Bond Position:  [34.02816571]


portfolio before change:  [28.30409551]
curr_Stock_Price:  100.3706366035968
curr_Factors:  [100.3706366]
mat_Sqrt:  [[0.15]]
grads:  [-0.1346703]
Stock Position:  -0.1346703031394621
Bond Position:  [41.82103957]


portfolio before change:  [28.24357976]
curr_Stock_Price:  100.85881933178392
curr_Factors:  [100.85881933]
mat_Sqrt:  [[0.15]]
grads:  [-0.13980508]
Stock Position:  -0.13980508453353363
Bond Position:  [42.34415552]


portfolio before change:  [28.05220432]
curr_Stock_Price:  102.26555487124837
curr_Factors:  [102.26555487]
mat_Sqrt:  [[0.15]]
grads:  [0.14732604]
Stock Position:  0.14732603793749427
Bond Position:  [12.98582531]


portfolio before change:  [28.14042759]
curr_Stock_Price:  102.8533663708577
curr_Factors:  [102.85336637]
mat_Sqrt:  [[0.15]]
grads:  [0.01642743]
Stock Position:  0.01642742914496153
Bond Position:  [26.4508112]


portfolio before change:  [28.16012201]
curr_Stock_Price:  103.85095747445817
curr_Factors:  [103.85095747]
mat_Sqrt:  [[0.15]]
grads:  [0.15507753]
Stock Position:  0.15507752750571782
Bond Position:  [12.05517229]


portfolio before change:  [28.20763428]
curr_Stock_Price:  104.14761733365742
curr_Factors:  [104.14761733]
mat_Sqrt:  [[0.15]]
grads:  [0.06762319]
Stock Position:  0.06762318838169973
Bond Position:  [21.16484033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.31281505]
Stock Price:  105.66388725800037
PL:  [22.6489278]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 8.76746688e-02]
 [-2.13023034e-02]
 [-1.27671452e-02]
 [-9.63208766e-03]
 [-3.41112338e-03]
 [ 4.82225988e-02]
 [ 3.57467935e-03]
 [-1.92123435e-03]
 [-2.37828046e-02]
 [ 2.34411046e-02]
 [ 2.10774159e-02]
 [-1.06126456e-02]
 [ 3.93011169e-03]
 [ 6.41551618e-03]
 [-9.34649032e-03]
 [-3.74506895e-03]
 [-6.02054749e-03]
 [ 5.07067938e-03]
 [ 5.04729371e-03]
 [-2.37373471e-02]
 [-5.37620820e-03]
 [-1.05926474e-02]
 [ 7.07518541e-03]
 [-1.01488646e-02]
 [ 1.09247728e-02]
 [ 7.94247512e-03]
 [-3.48197903e-03]
 [-3.31811927e-04]
 [ 2.54537184e-03]
 [-6.11204786e-03]
 [-1.96044341e-02]
 [ 9.88411927e-03]
 [-1.86590889e-03]
 [-1.84868373e-02]
 [-2.03542290e-02]
 [ 1.92071332e-02]
 [ 2.59650980e-03]
 [ 1.66771049e-02]
 [ 9.28202416e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-52.74233018]
curr_Stock_Price:  97.51187089709445
curr_Factors:  [97.5118709]
mat_Sqrt:  [[0.15]]
grads:  [0.58449779]
Stock Position:  0.584497791673274
Bond Position:  [-109.73780339]


portfolio before change:  [-53.04844566]
curr_Stock_Price:  97.01161684263694
curr_Factors:  [97.01161684]
mat_Sqrt:  [[0.15]]
grads:  [-0.14201536]
Stock Position:  -0.14201535587184758
Bond Position:  [-39.27130637]


portfolio before change:  [-52.98621927]
curr_Stock_Price:  96.53888202555072
curr_Factors:  [96.53888203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0851143]
Stock Position:  -0.0851143013716706
Bond Position:  [-44.76937978]


portfolio before change:  [-53.00165012]
curr_Stock_Price:  96.65442459976288
curr_Factors:  [96.6544246]
mat_Sqrt:  [[0.15]]
grads:  [-0.06421392]
Stock Position:  -0.06421391771277192
Bond Position:  [-46.79509085]


portfolio before change:  [-53.00089089]
curr_Stock_Price:  96.55150327792518
curr_Factors:  [96.55150328]
mat_Sqrt:  [[0.15]]
grads:  [-0.02274082]
Stock Position:  -0.022740822560374425
Bond Position:  [-50.80523029]


portfolio before change:  [-53.02816179]
curr_Stock_Price:  97.47142807309969
curr_Factors:  [97.47142807]
mat_Sqrt:  [[0.15]]
grads:  [0.32148399]
Stock Position:  0.3214839917104652
Bond Position:  [-84.36366556]


portfolio before change:  [-52.8141431]
curr_Stock_Price:  98.16995371273302
curr_Factors:  [98.16995371]
mat_Sqrt:  [[0.15]]
grads:  [0.0238312]
Stock Position:  0.023831195664472313
Bond Position:  [-55.15365047]


portfolio before change:  [-52.82135866]
curr_Stock_Price:  98.15648700159512
curr_Factors:  [98.156487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01280823]
Stock Position:  -0.012808228969477475
Bond Position:  [-51.5641479]


portfolio before change:  [-52.83622022]
curr_Stock_Price:  98.81353643761099
curr_Factors:  [98.81353644]
mat_Sqrt:  [[0.15]]
grads:  [-0.15855203]
Stock Position:  -0.1585520306883082
Bond Position:  [-37.16913336]


portfolio before change:  [-52.78907276]
curr_Stock_Price:  98.48686830620524
curr_Factors:  [98.48686831]
mat_Sqrt:  [[0.15]]
grads:  [0.15627403]
Stock Position:  0.15627403075034776
Bond Position:  [-68.18001265]


portfolio before change:  [-52.86027965]
curr_Stock_Price:  98.08575328200344
curr_Factors:  [98.08575328]
mat_Sqrt:  [[0.15]]
grads:  [0.14051611]
Stock Position:  0.14051610624746075
Bond Position:  [-66.64290778]


portfolio before change:  [-52.8815468]
curr_Stock_Price:  97.99369081744341
curr_Factors:  [97.99369082]
mat_Sqrt:  [[0.15]]
grads:  [-0.07075097]
Stock Position:  -0.07075097078568808
Bond Position:  [-45.94839804]


portfolio before change:  [-52.92714433]
curr_Stock_Price:  98.5569852242663
curr_Factors:  [98.55698522]
mat_Sqrt:  [[0.15]]
grads:  [0.02620074]
Stock Position:  0.0262007446192126
Bond Position:  [-55.50941073]


portfolio before change:  [-52.9163962]
curr_Stock_Price:  99.23205145229416
curr_Factors:  [99.23205145]
mat_Sqrt:  [[0.15]]
grads:  [0.04277011]
Stock Position:  0.04277010785045603
Bond Position:  [-57.16056175]


portfolio before change:  [-52.91013837]
curr_Stock_Price:  99.54543272997269
curr_Factors:  [99.54543273]
mat_Sqrt:  [[0.15]]
grads:  [-0.06230994]
Stock Position:  -0.06230993546472767
Bond Position:  [-46.70746888]


portfolio before change:  [-52.98920035]
curr_Stock_Price:  100.72057734954456
curr_Factors:  [100.72057735]
mat_Sqrt:  [[0.15]]
grads:  [-0.02496713]
Stock Position:  -0.024967126364479113
Bond Position:  [-50.47449697]


portfolio before change:  [-52.99780911]
curr_Stock_Price:  100.81266028061796
curr_Factors:  [100.81266028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04013698]
Stock Position:  -0.040136983237478496
Bond Position:  [-48.95149305]


portfolio before change:  [-52.96244438]
curr_Stock_Price:  99.77909866370612
curr_Factors:  [99.77909866]
mat_Sqrt:  [[0.15]]
grads:  [0.03380453]
Stock Position:  0.03380452921797963
Bond Position:  [-56.33542984]


portfolio before change:  [-53.00585569]
curr_Stock_Price:  98.70323874795623
curr_Factors:  [98.70323875]
mat_Sqrt:  [[0.15]]
grads:  [0.03364862]
Stock Position:  0.03364862471015226
Bond Position:  [-56.32708393]


portfolio before change:  [-53.05486198]
curr_Stock_Price:  97.45608639175877
curr_Factors:  [97.45608639]
mat_Sqrt:  [[0.15]]
grads:  [-0.15824898]
Stock Position:  -0.1582489808197043
Bond Position:  [-37.63253563]


portfolio before change:  [-53.09431103]
curr_Stock_Price:  97.67564352304181
curr_Factors:  [97.67564352]
mat_Sqrt:  [[0.15]]
grads:  [-0.03584139]
Stock Position:  -0.035841388026435834
Bond Position:  [-49.59348039]


portfolio before change:  [-53.13952572]
curr_Stock_Price:  98.76419278916228
curr_Factors:  [98.76419279]
mat_Sqrt:  [[0.15]]
grads:  [-0.07061765]
Stock Position:  -0.07061764956103433
Bond Position:  [-46.16503056]


portfolio before change:  [-53.20929726]
curr_Stock_Price:  99.67048964189159
curr_Factors:  [99.67048964]
mat_Sqrt:  [[0.15]]
grads:  [0.0471679]
Stock Position:  0.04716790275065264
Bond Position:  [-57.91054522]


portfolio before change:  [-53.16172127]
curr_Stock_Price:  100.83262011162432
curr_Factors:  [100.83262011]
mat_Sqrt:  [[0.15]]
grads:  [-0.0676591]
Stock Position:  -0.06765909717292835
Bond Position:  [-46.33947723]


portfolio before change:  [-53.12946276]
curr_Stock_Price:  100.27022258177821
curr_Factors:  [100.27022258]
mat_Sqrt:  [[0.15]]
grads:  [0.07283182]
Stock Position:  0.0728318186930377
Bond Position:  [-60.43232543]


portfolio before change:  [-53.20344208]
curr_Stock_Price:  99.35819250994481
curr_Factors:  [99.35819251]
mat_Sqrt:  [[0.15]]
grads:  [0.05294983]
Stock Position:  0.05294983411680474
Bond Position:  [-58.46444189]


portfolio before change:  [-53.14149218]
curr_Stock_Price:  100.66619320609264
curr_Factors:  [100.66619321]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321319]
Stock Position:  -0.02321319350858798
Bond Position:  [-50.80470835]


portfolio before change:  [-53.16938688]
curr_Stock_Price:  101.59427406039869
curr_Factors:  [101.59427406]
mat_Sqrt:  [[0.15]]
grads:  [-0.00221208]
Stock Position:  -0.0022120795132040544
Bond Position:  [-52.94465227]


portfolio before change:  [-53.17710136]
curr_Stock_Price:  102.08972633539385
curr_Factors:  [102.08972634]
mat_Sqrt:  [[0.15]]
grads:  [0.01696915]
Stock Position:  0.016969145630971013
Bond Position:  [-54.90947679]


portfolio before change:  [-53.18097696]
curr_Stock_Price:  102.26584096063614
curr_Factors:  [102.26584096]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074699]
Stock Position:  -0.040746985744012344
Bond Position:  [-49.01395219]


portfolio before change:  [-53.18674298]
curr_Stock_Price:  102.25697898543383
curr_Factors:  [102.25697899]
mat_Sqrt:  [[0.15]]
grads:  [-0.13069623]
Stock Position:  -0.13069622745168546
Bond Position:  [-39.8221416]


portfolio before change:  [-53.25732763]
curr_Stock_Price:  102.75895651560705
curr_Factors:  [102.75895652]
mat_Sqrt:  [[0.15]]
grads:  [0.06589413]
Stock Position:  0.06589412844172172
Bond Position:  [-60.02853951]


portfolio before change:  [-53.25665054]
curr_Stock_Price:  102.88311221709225
curr_Factors:  [102.88311222]
mat_Sqrt:  [[0.15]]
grads:  [-0.01243939]
Stock Position:  -0.012439392593699923
Bond Position:  [-51.97684711]


portfolio before change:  [-53.26598358]
curr_Stock_Price:  103.11105972006295
curr_Factors:  [103.11105972]
mat_Sqrt:  [[0.15]]
grads:  [-0.12324558]
Stock Position:  -0.12324558195825569
Bond Position:  [-40.55800102]


portfolio before change:  [-53.23437543]
curr_Stock_Price:  102.81345708323111
curr_Factors:  [102.81345708]
mat_Sqrt:  [[0.15]]
grads:  [-0.13569486]
Stock Position:  -0.1356948597200026
Bond Position:  [-39.2831178]


portfolio before change:  [-53.25957638]
curr_Stock_Price:  102.96298559784236
curr_Factors:  [102.9629856]
mat_Sqrt:  [[0.15]]
grads:  [0.12804755]
Stock Position:  0.1280475545149873
Bond Position:  [-66.44373489]


portfolio before change:  [-53.30347504]
curr_Stock_Price:  102.68502107173411
curr_Factors:  [102.68502107]
mat_Sqrt:  [[0.15]]
grads:  [0.01731007]
Stock Position:  0.01731006535162427
Bond Position:  [-55.08095947]


portfolio before change:  [-53.32005291]
curr_Stock_Price:  102.12509745518953
curr_Factors:  [102.12509746]
mat_Sqrt:  [[0.15]]
grads:  [0.1111807]
Stock Position:  0.11118069912100152
Bond Position:  [-64.67439264]


portfolio before change:  [-53.34136385]
curr_Stock_Price:  102.00613675149206
curr_Factors:  [102.00613675]
mat_Sqrt:  [[0.15]]
grads:  [0.06188016]
Stock Position:  0.06188016108440559
Bond Position:  [-59.65352002]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-53.35237589]
Stock Price:  101.94868889185598
PL:  [-55.30106478]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.84178969e-02]
 [ 4.41239695e-02]
 [-3.33760276e-03]
 [-2.42172714e-03]
 [-7.72268630e-03]
 [ 2.79065697e-02]
 [ 3.57219342e-03]
 [-1.28449335e-03]
 [-2.74092319e-02]
 [ 2.34409911e-02]
 [ 1.98654209e-02]
 [-1.28426779e-02]
 [ 4.56678563e-03]
 [ 6.41578475e-03]
 [-8.63109532e-03]
 [-2.26814858e-03]
 [-6.04247831e-03]
 [ 4.69178389e-03]
 [ 6.26255279e-03]
 [-1.00609239e-02]
 [-3.09997945e-03]
 [-1.21061893e-02]
 [ 6.03519494e-03]
 [-9.14782644e-03]
 [ 1.27258883e-02]
 [ 4.83610311e-03]
 [ 8.97752069e-04]
 [-2.17392573e-03]
 [ 7.73507779e-04]
 [-1.08451244e-02]
 [-2.92212003e-02]
 [ 1.57129093e-02]
 [-6.92651405e-03]
 [-2.11645321e-02]
 [-2.14139042e-02]
 [ 2.57170763e-02]
 [ 4.13829629e-03]
 [ 1.13558023e-02]
 [ 6.07889704e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.7503329]
curr_Stock_Price:  100.54034915079089
curr_Factors:  [100.54034915]
mat_Sqrt:  [[0.15]]
grads:  [-0.12278598]
Stock Position:  -0.12278597904391352
Bond Position:  [26.0952781]


portfolio before change:  [13.76933669]
curr_Stock_Price:  100.4121449080606
curr_Factors:  [100.41214491]
mat_Sqrt:  [[0.15]]
grads:  [0.2941598]
Stock Position:  0.2941597964429768
Bond Position:  [-15.76787941]


portfolio before change:  [13.66289108]
curr_Stock_Price:  100.05698247312775
curr_Factors:  [100.05698247]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225069]
Stock Position:  -0.022250685058180127
Bond Position:  [15.88922748]


portfolio before change:  [13.65422657]
curr_Stock_Price:  100.53565480643442
curr_Factors:  [100.53565481]
mat_Sqrt:  [[0.15]]
grads:  [-0.01614485]
Stock Position:  -0.016144847621128913
Bond Position:  [15.27735939]


portfolio before change:  [13.6604975]
curr_Stock_Price:  100.26552851240095
curr_Factors:  [100.26552851]
mat_Sqrt:  [[0.15]]
grads:  [-0.05148458]
Stock Position:  -0.05148457533944435
Bond Position:  [18.82262566]


portfolio before change:  [13.70325403]
curr_Stock_Price:  99.48075840384705
curr_Factors:  [99.4807584]
mat_Sqrt:  [[0.15]]
grads:  [0.1860438]
Stock Position:  0.18604379814782232
Bond Position:  [-4.8045241]


portfolio before change:  [13.47222395]
curr_Stock_Price:  98.24218188025132
curr_Factors:  [98.24218188]
mat_Sqrt:  [[0.15]]
grads:  [0.02381462]
Stock Position:  0.023814622792670583
Bond Position:  [11.13262345]


portfolio before change:  [13.50140398]
curr_Stock_Price:  99.40904331342132
curr_Factors:  [99.40904331]
mat_Sqrt:  [[0.15]]
grads:  [-0.00856329]
Stock Position:  -0.008563288983049748
Bond Position:  [14.35267235]


portfolio before change:  [13.49931298]
curr_Stock_Price:  99.86274718713102
curr_Factors:  [99.86274719]
mat_Sqrt:  [[0.15]]
grads:  [-0.18272821]
Stock Position:  -0.18272821263232883
Bond Position:  [31.74705428]


portfolio before change:  [13.74810413]
curr_Stock_Price:  98.5229293335769
curr_Factors:  [98.52292933]
mat_Sqrt:  [[0.15]]
grads:  [0.15627327]
Stock Position:  0.15627327394273727
Bond Position:  [-1.6483966]


portfolio before change:  [13.86732078]
curr_Stock_Price:  99.28712087496874
curr_Factors:  [99.28712087]
mat_Sqrt:  [[0.15]]
grads:  [0.13243614]
Stock Position:  0.13243613934681456
Bond Position:  [0.71811781]


portfolio before change:  [13.77641496]
curr_Stock_Price:  98.60003054146425
curr_Factors:  [98.60003054]
mat_Sqrt:  [[0.15]]
grads:  [-0.08561785]
Stock Position:  -0.08561785298223534
Bond Position:  [22.21833788]


portfolio before change:  [13.77947132]
curr_Stock_Price:  98.59677307916014
curr_Factors:  [98.59677308]
mat_Sqrt:  [[0.15]]
grads:  [0.03044524]
Stock Position:  0.03044523753187528
Bond Position:  [10.77766915]


portfolio before change:  [13.80020095]
curr_Stock_Price:  99.2334025504396
curr_Factors:  [99.23340255]
mat_Sqrt:  [[0.15]]
grads:  [0.0427719]
Stock Position:  0.04277189831290533
Bond Position:  [9.55579995]


portfolio before change:  [13.80651766]
curr_Stock_Price:  99.35315775622502
curr_Factors:  [99.35315776]
mat_Sqrt:  [[0.15]]
grads:  [-0.05754064]
Stock Position:  -0.05754063545959698
Bond Position:  [19.52336149]


portfolio before change:  [13.79197616]
curr_Stock_Price:  99.64828948767676
curr_Factors:  [99.64828949]
mat_Sqrt:  [[0.15]]
grads:  [-0.01512099]
Stock Position:  -0.015120990513862656
Bond Position:  [15.298757]


portfolio before change:  [13.80569353]
curr_Stock_Price:  98.86759336336692
curr_Factors:  [98.86759336]
mat_Sqrt:  [[0.15]]
grads:  [-0.04028319]
Stock Position:  -0.04028318870255715
Bond Position:  [17.78839545]


portfolio before change:  [13.78612667]
curr_Stock_Price:  99.40852732302807
curr_Factors:  [99.40852732]
mat_Sqrt:  [[0.15]]
grads:  [0.03127856]
Stock Position:  0.031278559271740926
Bond Position:  [10.67677116]


portfolio before change:  [13.79732066]
curr_Stock_Price:  99.72373723754957
curr_Factors:  [99.72373724]
mat_Sqrt:  [[0.15]]
grads:  [0.04175035]
Stock Position:  0.041750351946783365
Bond Position:  [9.63381954]


portfolio before change:  [13.80583328]
curr_Stock_Price:  99.89878510673574
curr_Factors:  [99.89878511]
mat_Sqrt:  [[0.15]]
grads:  [-0.06707283]
Stock Position:  -0.06707282631124223
Bond Position:  [20.50632714]


portfolio before change:  [13.84333953]
curr_Stock_Price:  99.37781695425635
curr_Factors:  [99.37781695]
mat_Sqrt:  [[0.15]]
grads:  [-0.02066653]
Stock Position:  -0.020666529691080064
Bond Position:  [15.89713414]


portfolio before change:  [13.86449507]
curr_Stock_Price:  98.45031367575741
curr_Factors:  [98.45031368]
mat_Sqrt:  [[0.15]]
grads:  [-0.08070793]
Stock Position:  -0.08070792876576513
Bond Position:  [21.81021598]


portfolio before change:  [13.98044519]
curr_Stock_Price:  97.04743206940671
curr_Factors:  [97.04743207]
mat_Sqrt:  [[0.15]]
grads:  [0.04023463]
Stock Position:  0.04023463290193468
Bond Position:  [10.07577739]


portfolio before change:  [13.98730648]
curr_Stock_Price:  97.18665895570727
curr_Factors:  [97.18665896]
mat_Sqrt:  [[0.15]]
grads:  [-0.06098551]
Stock Position:  -0.060985509587446196
Bond Position:  [19.9142844]


portfolio before change:  [13.99954949]
curr_Stock_Price:  97.02672647167739
curr_Factors:  [97.02672647]
mat_Sqrt:  [[0.15]]
grads:  [0.08483926]
Stock Position:  0.08483925536353297
Bond Position:  [5.76787426]


portfolio before change:  [14.04717444]
curr_Stock_Price:  97.57958287401347
curr_Factors:  [97.57958287]
mat_Sqrt:  [[0.15]]
grads:  [0.03224069]
Stock Position:  0.03224068740955439
Bond Position:  [10.90114161]


portfolio before change:  [14.07142064]
curr_Stock_Price:  98.28935263047227
curr_Factors:  [98.28935263]
mat_Sqrt:  [[0.15]]
grads:  [0.00598501]
Stock Position:  0.00598501379327721
Bond Position:  [13.4831575]


portfolio before change:  [14.08066667]
curr_Stock_Price:  99.55259717056248
curr_Factors:  [99.55259717]
mat_Sqrt:  [[0.15]]
grads:  [-0.01449284]
Stock Position:  -0.014492838192712515
Bond Position:  [15.52346635]


portfolio before change:  [14.06513448]
curr_Stock_Price:  100.758209657177
curr_Factors:  [100.75820966]
mat_Sqrt:  [[0.15]]
grads:  [0.00515672]
Stock Position:  0.00515671852739967
Bond Position:  [13.54555275]


portfolio before change:  [14.06142263]
curr_Stock_Price:  99.71003355288998
curr_Factors:  [99.71003355]
mat_Sqrt:  [[0.15]]
grads:  [-0.07230083]
Stock Position:  -0.07230082919994558
Bond Position:  [21.27054074]


portfolio before change:  [13.99049242]
curr_Stock_Price:  100.72785311318096
curr_Factors:  [100.72785311]
mat_Sqrt:  [[0.15]]
grads:  [-0.194808]
Stock Position:  -0.19480800230329146
Bond Position:  [33.61308426]


portfolio before change:  [14.16206442]
curr_Stock_Price:  99.86869896869645
curr_Factors:  [99.86869897]
mat_Sqrt:  [[0.15]]
grads:  [0.10475273]
Stock Position:  0.10475272895364046
Bond Position:  [3.70054566]


portfolio before change:  [14.19584854]
curr_Stock_Price:  100.18679597242661
curr_Factors:  [100.18679597]
mat_Sqrt:  [[0.15]]
grads:  [-0.04617676]
Stock Position:  -0.04617676032686177
Bond Position:  [18.82215021]


portfolio before change:  [14.20070121]
curr_Stock_Price:  100.13266162804261
curr_Factors:  [100.13266163]
mat_Sqrt:  [[0.15]]
grads:  [-0.14109688]
Stock Position:  -0.1410968803661728
Bond Position:  [28.32910739]


portfolio before change:  [14.19807143]
curr_Stock_Price:  100.17639849544605
curr_Factors:  [100.1763985]
mat_Sqrt:  [[0.15]]
grads:  [-0.14275936]
Stock Position:  -0.1427593615934815
Bond Position:  [28.49919013]


portfolio before change:  [14.02796234]
curr_Stock_Price:  101.39293319510186
curr_Factors:  [101.3929332]
mat_Sqrt:  [[0.15]]
grads:  [0.17144718]
Stock Position:  0.17144717553042504
Bond Position:  [-3.35556968]


portfolio before change:  [13.88081998]
curr_Stock_Price:  100.5371425642681
curr_Factors:  [100.53714256]
mat_Sqrt:  [[0.15]]
grads:  [0.02758864]
Stock Position:  0.027588641914272818
Bond Position:  [11.10713675]


portfolio before change:  [13.89090867]
curr_Stock_Price:  100.85249732303565
curr_Factors:  [100.85249732]
mat_Sqrt:  [[0.15]]
grads:  [0.07570535]
Stock Position:  0.0757053487643748
Bond Position:  [6.25583518]


portfolio before change:  [13.82598006]
curr_Stock_Price:  99.98451863903446
curr_Factors:  [99.98451864]
mat_Sqrt:  [[0.15]]
grads:  [0.04052598]
Stock Position:  0.04052598023503009
Bond Position:  [9.77400944]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.82671477]
Stock Price:  99.97249853298099
PL:  [13.82671477]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.57809493e-02]
 [ 2.74782473e-02]
 [-3.54483085e-03]
 [-2.19325864e-03]
 [-3.30181583e-03]
 [ 3.31463681e-02]
 [ 3.71148549e-03]
 [ 9.04256573e-03]
 [-4.17086949e-03]
 [ 2.25271889e-02]
 [ 1.62858589e-02]
 [-1.31013570e-03]
 [ 1.57208554e-03]
 [ 2.33867790e-02]
 [-1.06347961e-02]
 [-4.45706608e-03]
 [-4.71240294e-03]
 [ 7.31961876e-03]
 [ 1.93169480e-02]
 [ 1.48498947e-02]
 [-1.01023735e-03]
 [-6.10089526e-03]
 [ 4.20529943e-03]
 [-1.23049347e-02]
 [ 4.27251760e-03]
 [ 3.46485446e-03]
 [ 1.22745648e-03]
 [ 1.14590195e-03]
 [ 4.08310863e-03]
 [-5.51468635e-03]
 [-1.77754565e-02]
 [ 9.73676181e-03]
 [-3.15622558e-03]
 [-2.06483693e-02]
 [-2.07752073e-02]
 [ 2.71334524e-02]
 [ 4.08539287e-03]
 [ 1.16294907e-02]
 [ 6.80356711e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.10310636]
curr_Stock_Price:  99.86383364214248
curr_Factors:  [99.86383364]
mat_Sqrt:  [[0.15]]
grads:  [0.10520633]
Stock Position:  0.10520632862727107
Bond Position:  [-11.60941366]


portfolio before change:  [-1.00454212]
curr_Stock_Price:  100.81449419705426
curr_Factors:  [100.8144942]
mat_Sqrt:  [[0.15]]
grads:  [0.18318832]
Stock Position:  0.18318831534295785
Bond Position:  [-19.47257948]


portfolio before change:  [-1.06503099]
curr_Stock_Price:  100.49758180926382
curr_Factors:  [100.49758181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02363221]
Stock Position:  -0.023632205699219422
Bond Position:  [1.30994853]


portfolio before change:  [-1.0723951]
curr_Stock_Price:  100.81612429832298
curr_Factors:  [100.8161243]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462172]
Stock Position:  -0.014621724280049988
Bond Position:  [0.40171047]


portfolio before change:  [-1.07642735]
curr_Stock_Price:  101.09532995325682
curr_Factors:  [101.09532995]
mat_Sqrt:  [[0.15]]
grads:  [-0.02201211]
Stock Position:  -0.022012105529330295
Bond Position:  [1.14889372]


portfolio before change:  [-1.06837618]
curr_Stock_Price:  100.73609352419561
curr_Factors:  [100.73609352]
mat_Sqrt:  [[0.15]]
grads:  [0.22097579]
Stock Position:  0.22097578751071809
Bond Position:  [-23.32861378]


portfolio before change:  [-1.12264233]
curr_Stock_Price:  100.50371560742357
curr_Factors:  [100.50371561]
mat_Sqrt:  [[0.15]]
grads:  [0.02474324]
Stock Position:  0.024743236623337696
Bond Position:  [-3.60942955]


portfolio before change:  [-1.10173563]
curr_Stock_Price:  101.36689748239087
curr_Factors:  [101.36689748]
mat_Sqrt:  [[0.15]]
grads:  [0.06028377]
Stock Position:  0.060283771523900354
Bond Position:  [-7.21251452]


portfolio before change:  [-1.05286813]
curr_Stock_Price:  102.19247816766413
curr_Factors:  [102.19247817]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278058]
Stock Position:  -0.027805796578553855
Bond Position:  [1.78867513]


portfolio before change:  [-1.11364002]
curr_Stock_Price:  104.38610309952934
curr_Factors:  [104.3861031]
mat_Sqrt:  [[0.15]]
grads:  [0.15018126]
Stock Position:  0.15018125944387198
Bond Position:  [-16.79047645]


portfolio before change:  [-1.23373303]
curr_Stock_Price:  103.60042536644279
curr_Factors:  [103.60042537]
mat_Sqrt:  [[0.15]]
grads:  [0.10857239]
Stock Position:  0.10857239287866449
Bond Position:  [-12.48187912]


portfolio before change:  [-1.27181142]
curr_Stock_Price:  103.2640778907878
curr_Factors:  [103.26407789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00873424]
Stock Position:  -0.008734237995730275
Bond Position:  [-0.36987838]


portfolio before change:  [-1.27357162]
curr_Stock_Price:  103.46031383009225
curr_Factors:  [103.46031383]
mat_Sqrt:  [[0.15]]
grads:  [0.01048057]
Stock Position:  0.010480570299148784
Bond Position:  [-2.35789472]


portfolio before change:  [-1.28131386]
curr_Stock_Price:  102.74971501257377
curr_Factors:  [102.74971501]
mat_Sqrt:  [[0.15]]
grads:  [0.15591186]
Stock Position:  0.1559118598529739
Bond Position:  [-17.30121303]


portfolio before change:  [-1.19468555]
curr_Stock_Price:  103.31921046105067
curr_Factors:  [103.31921046]
mat_Sqrt:  [[0.15]]
grads:  [-0.07089864]
Stock Position:  -0.07089864039089604
Bond Position:  [6.13050599]


portfolio before change:  [-1.30833675]
curr_Stock_Price:  104.93302919719005
curr_Factors:  [104.9330292]
mat_Sqrt:  [[0.15]]
grads:  [-0.02971377]
Stock Position:  -0.029713773849510784
Bond Position:  [1.80961955]


portfolio before change:  [-1.28542032]
curr_Stock_Price:  104.16940317345274
curr_Factors:  [104.16940317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141602]
Stock Position:  -0.03141601961760144
Bond Position:  [1.98716769]


portfolio before change:  [-1.23638604]
curr_Stock_Price:  102.61650552817684
curr_Factors:  [102.61650553]
mat_Sqrt:  [[0.15]]
grads:  [0.04879746]
Stock Position:  0.04879745842659934
Bond Position:  [-6.24381071]


portfolio before change:  [-1.19146933]
curr_Stock_Price:  103.55297312071912
curr_Factors:  [103.55297312]
mat_Sqrt:  [[0.15]]
grads:  [0.12877965]
Stock Position:  0.12877965339893888
Bond Position:  [-14.52698532]


portfolio before change:  [-1.26474114]
curr_Stock_Price:  102.99810427727884
curr_Factors:  [102.99810428]
mat_Sqrt:  [[0.15]]
grads:  [0.0989993]
Stock Position:  0.0989992981708342
Bond Position:  [-11.46148117]


portfolio before change:  [-1.30511208]
curr_Stock_Price:  102.60478659543004
curr_Factors:  [102.6047866]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673492]
Stock Position:  -0.00673491565548076
Bond Position:  [-0.6140775]


portfolio before change:  [-1.29897926]
curr_Stock_Price:  101.6827866537077
curr_Factors:  [101.68278665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04067264]
Stock Position:  -0.040672635088284434
Bond Position:  [2.83672762]


portfolio before change:  [-1.30870908]
curr_Stock_Price:  101.93072809528553
curr_Factors:  [101.9307281]
mat_Sqrt:  [[0.15]]
grads:  [0.02803533]
Stock Position:  0.02803532951079702
Bond Position:  [-4.16637062]


portfolio before change:  [-1.3036457]
curr_Stock_Price:  102.12991270850002
curr_Factors:  [102.12991271]
mat_Sqrt:  [[0.15]]
grads:  [-0.0820329]
Stock Position:  -0.08203289811356071
Bond Position:  [7.07436703]


portfolio before change:  [-1.25879135]
curr_Stock_Price:  101.59390826878555
curr_Factors:  [101.59390827]
mat_Sqrt:  [[0.15]]
grads:  [0.02848345]
Stock Position:  0.028483450677884346
Bond Position:  [-4.15253642]


portfolio before change:  [-1.22413494]
curr_Stock_Price:  102.82885363923715
curr_Factors:  [102.82885364]
mat_Sqrt:  [[0.15]]
grads:  [0.02309903]
Stock Position:  0.023099029729520427
Bond Position:  [-3.59938169]


portfolio before change:  [-1.21618696]
curr_Stock_Price:  103.19241596903373
curr_Factors:  [103.19241597]
mat_Sqrt:  [[0.15]]
grads:  [0.00818304]
Stock Position:  0.00818304322751631
Bond Position:  [-2.06061496]


portfolio before change:  [-1.21748783]
curr_Stock_Price:  103.06492281419706
curr_Factors:  [103.06492281]
mat_Sqrt:  [[0.15]]
grads:  [0.00763935]
Stock Position:  0.007639346323164466
Bond Position:  [-2.00483647]


portfolio before change:  [-1.21761587]
curr_Stock_Price:  103.08096881922405
curr_Factors:  [103.08096882]
mat_Sqrt:  [[0.15]]
grads:  [0.02722072]
Stock Position:  0.027220724178153802
Bond Position:  [-4.02355449]


portfolio before change:  [-1.2031574]
curr_Stock_Price:  103.63060337525843
curr_Factors:  [103.63060338]
mat_Sqrt:  [[0.15]]
grads:  [-0.03676458]
Stock Position:  -0.03676457566786371
Bond Position:  [2.60677776]


portfolio before change:  [-1.19845795]
curr_Stock_Price:  103.5116416391578
curr_Factors:  [103.51164164]
mat_Sqrt:  [[0.15]]
grads:  [-0.11850304]
Stock Position:  -0.11850304306544787
Bond Position:  [11.06798658]


portfolio before change:  [-1.11183982]
curr_Stock_Price:  102.79238123582927
curr_Factors:  [102.79238124]
mat_Sqrt:  [[0.15]]
grads:  [0.06491175]
Stock Position:  0.06491174539201634
Bond Position:  [-7.7842727]


portfolio before change:  [-1.13706639]
curr_Stock_Price:  102.41874345880022
curr_Factors:  [102.41874346]
mat_Sqrt:  [[0.15]]
grads:  [-0.0210415]
Stock Position:  -0.02104150383397768
Bond Position:  [1.01797799]


portfolio before change:  [-1.1341849]
curr_Stock_Price:  102.28784776924746
curr_Factors:  [102.28784777]
mat_Sqrt:  [[0.15]]
grads:  [-0.1376558]
Stock Position:  -0.13765579544580975
Bond Position:  [12.94633015]


portfolio before change:  [-0.99778767]
curr_Stock_Price:  101.30874744221195
curr_Factors:  [101.30874744]
mat_Sqrt:  [[0.15]]
grads:  [-0.13850138]
Stock Position:  -0.1385013819361129
Bond Position:  [13.03361385]


portfolio before change:  [-0.96050639]
curr_Stock_Price:  101.0513350346102
curr_Factors:  [101.05133503]
mat_Sqrt:  [[0.15]]
grads:  [0.18088968]
Stock Position:  0.18088968246779233
Bond Position:  [-19.2396503]


portfolio before change:  [-1.06569906]
curr_Stock_Price:  100.48310165311507
curr_Factors:  [100.48310165]
mat_Sqrt:  [[0.15]]
grads:  [0.02723595]
Stock Position:  0.027235952447718342
Bond Position:  [-3.80245203]


portfolio before change:  [-1.0543502]
curr_Stock_Price:  100.91724078738953
curr_Factors:  [100.91724079]
mat_Sqrt:  [[0.15]]
grads:  [0.07752994]
Stock Position:  0.07752993767278683
Bond Position:  [-8.87845759]


portfolio before change:  [-1.10004217]
curr_Stock_Price:  100.34221013797271
curr_Factors:  [100.34221014]
mat_Sqrt:  [[0.15]]
grads:  [0.04535711]
Stock Position:  0.04535711404083759
Bond Position:  [-5.65127523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.11941533]
Stock Price:  99.93066029470451
PL:  [-1.11941533]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.28219289e-02]
 [ 6.53914295e-03]
 [ 1.83475729e-03]
 [-2.31739005e-03]
 [-2.75541106e-03]
 [ 3.32909017e-02]
 [ 3.72331325e-03]
 [ 4.53444932e-03]
 [-2.09817777e-02]
 [ 2.31820743e-02]
 [ 2.00665965e-02]
 [-1.17819360e-02]
 [ 3.14056054e-02]
 [ 1.12804309e-02]
 [ 8.33736183e-03]
 [-3.25675844e-03]
 [-6.04617493e-03]
 [ 6.79450111e-03]
 [ 6.80029725e-03]
 [-1.26149857e-02]
 [-4.54940270e-03]
 [-5.22641240e-03]
 [ 6.98845672e-03]
 [-8.94373269e-03]
 [ 1.50976034e-02]
 [ 6.71910280e-03]
 [ 9.31501467e-03]
 [-3.67066710e-03]
 [-1.84337833e-02]
 [-1.22273357e-02]
 [ 4.14150960e-02]
 [-1.25562788e-03]
 [-1.96221552e-02]
 [-2.92380307e-02]
 [-2.34513605e-02]
 [ 3.22386935e-02]
 [-5.60061053e-03]
 [-5.76884320e-03]
 [ 3.75615952e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83550607]
curr_Stock_Price:  99.99767583531496
curr_Factors:  [99.99767584]
mat_Sqrt:  [[0.15]]
grads:  [0.15214619]
Stock Position:  0.15214619281878652
Bond Position:  [-13.3787596]


portfolio before change:  [2.0027561]
curr_Stock_Price:  101.10794005181887
curr_Factors:  [101.10794005]
mat_Sqrt:  [[0.15]]
grads:  [0.04359429]
Stock Position:  0.04359428636229318
Bond Position:  [-2.40497239]


portfolio before change:  [2.02244863]
curr_Stock_Price:  101.56655909260913
curr_Factors:  [101.56655909]
mat_Sqrt:  [[0.15]]
grads:  [0.01223172]
Stock Position:  0.012231715249149781
Bond Position:  [0.7801154]


portfolio before change:  [2.01182841]
curr_Stock_Price:  100.69033357367474
curr_Factors:  [100.69033357]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544927]
Stock Position:  -0.01544926702607142
Bond Position:  [3.56742026]


portfolio before change:  [2.00205004]
curr_Stock_Price:  101.35213307104138
curr_Factors:  [101.35213307]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836941]
Stock Position:  -0.01836940707575362
Bond Position:  [3.86382864]


portfolio before change:  [2.01473473]
curr_Stock_Price:  100.68789413010623
curr_Factors:  [100.68789413]
mat_Sqrt:  [[0.15]]
grads:  [0.22193934]
Stock Position:  0.22193934447686503
Bond Position:  [-20.33187049]


portfolio before change:  [2.09201784]
curr_Stock_Price:  101.04756338354069
curr_Factors:  [101.04756338]
mat_Sqrt:  [[0.15]]
grads:  [0.02482209]
Stock Position:  0.02482208832464018
Bond Position:  [-0.4161937]


portfolio before change:  [2.0729993]
curr_Stock_Price:  100.28346512274261
curr_Factors:  [100.28346512]
mat_Sqrt:  [[0.15]]
grads:  [0.03022966]
Stock Position:  0.030229662106871637
Bond Position:  [-0.95853596]


portfolio before change:  [2.08819459]
curr_Stock_Price:  100.79009043178894
curr_Factors:  [100.79009043]
mat_Sqrt:  [[0.15]]
grads:  [-0.13987852]
Stock Position:  -0.1398785182070815
Bond Position:  [16.18656309]


portfolio before change:  [2.05839998]
curr_Stock_Price:  101.01755962782123
curr_Factors:  [101.01755963]
mat_Sqrt:  [[0.15]]
grads:  [0.15454716]
Stock Position:  0.1545471622968686
Bond Position:  [-13.5535772]


portfolio before change:  [2.11475514]
curr_Stock_Price:  101.3931696150436
curr_Factors:  [101.39316962]
mat_Sqrt:  [[0.15]]
grads:  [0.13377731]
Stock Position:  0.13377730991614892
Bond Position:  [-11.44935034]


portfolio before change:  [2.12299996]
curr_Stock_Price:  101.46549936177
curr_Factors:  [101.46549936]
mat_Sqrt:  [[0.15]]
grads:  [-0.07854624]
Stock Position:  -0.0785462397049131
Bond Position:  [10.09273339]


portfolio before change:  [2.17513989]
curr_Stock_Price:  100.81775015076768
curr_Factors:  [100.81775015]
mat_Sqrt:  [[0.15]]
grads:  [0.2093707]
Stock Position:  0.209370702496616
Bond Position:  [-18.93314328]


portfolio before change:  [2.17327507]
curr_Stock_Price:  100.82014767123106
curr_Factors:  [100.82014767]
mat_Sqrt:  [[0.15]]
grads:  [0.07520287]
Stock Position:  0.0752028729682376
Bond Position:  [-5.40868968]


portfolio before change:  [2.15243559]
curr_Stock_Price:  100.55202818383681
curr_Factors:  [100.55202818]
mat_Sqrt:  [[0.15]]
grads:  [0.05558241]
Stock Position:  0.05558241218704081
Bond Position:  [-3.43648869]


portfolio before change:  [2.12974498]
curr_Stock_Price:  100.151523487024
curr_Factors:  [100.15152349]
mat_Sqrt:  [[0.15]]
grads:  [-0.02171172]
Stock Position:  -0.02171172290679842
Bond Position:  [4.30420711]


portfolio before change:  [2.11951005]
curr_Stock_Price:  100.64770666622583
curr_Factors:  [100.64770667]
mat_Sqrt:  [[0.15]]
grads:  [-0.04030783]
Stock Position:  -0.040307832845933436
Bond Position:  [6.17640099]


portfolio before change:  [2.08647239]
curr_Stock_Price:  101.48649552960985
curr_Factors:  [101.48649553]
mat_Sqrt:  [[0.15]]
grads:  [0.04529667]
Stock Position:  0.04529667407303437
Bond Position:  [-2.51052832]


portfolio before change:  [2.04375452]
curr_Stock_Price:  100.55035553530313
curr_Factors:  [100.55035554]
mat_Sqrt:  [[0.15]]
grads:  [0.04533531]
Stock Position:  0.0453353149959643
Bond Position:  [-2.51472752]


portfolio before change:  [2.00823783]
curr_Stock_Price:  99.77386743235166
curr_Factors:  [99.77386743]
mat_Sqrt:  [[0.15]]
grads:  [-0.0840999]
Stock Position:  -0.08409990484010046
Bond Position:  [10.39921059]


portfolio before change:  [1.98997541]
curr_Stock_Price:  100.00647658251444
curr_Factors:  [100.00647658]
mat_Sqrt:  [[0.15]]
grads:  [-0.03032935]
Stock Position:  -0.030329351301847714
Bond Position:  [5.02310697]


portfolio before change:  [1.99161038]
curr_Stock_Price:  99.97327306003204
curr_Factors:  [99.97327306]
mat_Sqrt:  [[0.15]]
grads:  [-0.03484275]
Stock Position:  -0.03484274930990487
Bond Position:  [5.47495407]


portfolio before change:  [1.9849737]
curr_Stock_Price:  100.18339107684105
curr_Factors:  [100.18339108]
mat_Sqrt:  [[0.15]]
grads:  [0.04658971]
Stock Position:  0.04658971147521718
Bond Position:  [-2.68254159]


portfolio before change:  [1.99376387]
curr_Stock_Price:  100.37926078535712
curr_Factors:  [100.37926079]
mat_Sqrt:  [[0.15]]
grads:  [-0.05962488]
Stock Position:  -0.05962488457777333
Bond Position:  [7.97886571]


portfolio before change:  [2.08767266]
curr_Stock_Price:  98.82099585165336
curr_Factors:  [98.82099585]
mat_Sqrt:  [[0.15]]
grads:  [0.10065069]
Stock Position:  0.10065068947919069
Bond Position:  [-7.85872871]


portfolio before change:  [2.04152362]
curr_Stock_Price:  98.37224942880408
curr_Factors:  [98.37224943]
mat_Sqrt:  [[0.15]]
grads:  [0.04479402]
Stock Position:  0.04479401863911308
Bond Position:  [-2.36496475]


portfolio before change:  [2.00158346]
curr_Stock_Price:  97.48720887917716
curr_Factors:  [97.48720888]
mat_Sqrt:  [[0.15]]
grads:  [0.0621001]
Stock Position:  0.06210009783259754
Bond Position:  [-4.05238175]


portfolio before change:  [2.00380144]
curr_Stock_Price:  97.53108254615871
curr_Factors:  [97.53108255]
mat_Sqrt:  [[0.15]]
grads:  [-0.02447111]
Stock Position:  -0.0244711139684001
Bond Position:  [4.39049568]


portfolio before change:  [2.01766654]
curr_Stock_Price:  96.9869204655524
curr_Factors:  [96.98692047]
mat_Sqrt:  [[0.15]]
grads:  [-0.12289189]
Stock Position:  -0.1228918887287829
Bond Position:  [13.93657238]


portfolio before change:  [2.05432828]
curr_Stock_Price:  96.70277186368784
curr_Factors:  [96.70277186]
mat_Sqrt:  [[0.15]]
grads:  [-0.08151557]
Stock Position:  -0.08151557137609639
Bond Position:  [9.93710998]


portfolio before change:  [2.10787006]
curr_Stock_Price:  96.06118192598107
curr_Factors:  [96.06118193]
mat_Sqrt:  [[0.15]]
grads:  [0.27610064]
Stock Position:  0.27610064024595576
Bond Position:  [-24.41468377]


portfolio before change:  [1.74177437]
curr_Stock_Price:  94.74628577083725
curr_Factors:  [94.74628577]
mat_Sqrt:  [[0.15]]
grads:  [-0.00837085]
Stock Position:  -0.008370852559923063
Bond Position:  [2.53488156]


portfolio before change:  [1.73899282]
curr_Stock_Price:  95.11643055567949
curr_Factors:  [95.11643056]
mat_Sqrt:  [[0.15]]
grads:  [-0.13081437]
Stock Position:  -0.13081436800224247
Bond Position:  [14.18158857]


portfolio before change:  [1.75272897]
curr_Stock_Price:  95.02497775384413
curr_Factors:  [95.02497775]
mat_Sqrt:  [[0.15]]
grads:  [-0.1949202]
Stock Position:  -0.19492020484916264
Bond Position:  [20.2750171]


portfolio before change:  [1.74975709]
curr_Stock_Price:  95.05322731074361
curr_Factors:  [95.05322731]
mat_Sqrt:  [[0.15]]
grads:  [-0.1563424]
Stock Position:  -0.15634240358437257
Bond Position:  [16.61060712]


portfolio before change:  [1.97783286]
curr_Stock_Price:  93.60768658740845
curr_Factors:  [93.60768659]
mat_Sqrt:  [[0.15]]
grads:  [0.21492462]
Stock Position:  0.21492462361150988
Bond Position:  [-18.14076395]


portfolio before change:  [2.26333444]
curr_Stock_Price:  94.94661795585391
curr_Factors:  [94.94661796]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373374]
Stock Position:  -0.037337403519441106
Bond Position:  [5.80839463]


portfolio before change:  [2.29048711]
curr_Stock_Price:  94.23884054052525
curr_Factors:  [94.23884054]
mat_Sqrt:  [[0.15]]
grads:  [-0.03845895]
Stock Position:  -0.038458954635033044
Bond Position:  [5.9148144]


portfolio before change:  [2.3349877]
curr_Stock_Price:  93.10097316669194
curr_Factors:  [93.10097317]
mat_Sqrt:  [[0.15]]
grads:  [0.25041063]
Stock Position:  0.2504106344238481
Bond Position:  [-20.97848606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.34325272]
Stock Price:  93.14445175009376
PL:  [2.34325272]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.22595947e-02]
 [ 3.33521228e-02]
 [-3.48642192e-03]
 [-6.81480206e-03]
 [-7.34563075e-03]
 [ 2.94916447e-02]
 [ 3.54593803e-03]
 [-3.35225215e-04]
 [-2.77319180e-02]
 [ 2.34354605e-02]
 [ 1.95000710e-02]
 [-9.33663205e-03]
 [-1.51109956e-02]
 [ 1.62636451e-02]
 [-1.46137826e-02]
 [-1.30753421e-03]
 [-6.07332587e-03]
 [-1.43182991e-03]
 [ 1.33947844e-03]
 [-5.00406712e-03]
 [-9.15472911e-03]
 [-2.05425206e-02]
 [ 5.00469761e-03]
 [-1.12535986e-02]
 [ 1.14517185e-02]
 [ 1.75316737e-03]
 [ 1.91886451e-02]
 [-3.82206010e-03]
 [-1.51330127e-02]
 [-1.46300998e-02]
 [ 7.91160209e-03]
 [ 1.50311938e-02]
 [-7.49099467e-03]
 [-3.44337970e-02]
 [-2.12580209e-02]
 [ 2.64571103e-02]
 [ 3.89976848e-03]
 [ 9.92338588e-03]
 [ 8.54546924e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.70895345]
curr_Stock_Price:  100.08300396571516
curr_Factors:  [100.08300397]
mat_Sqrt:  [[0.15]]
grads:  [0.1483973]
Stock Position:  0.1483972978169581
Bond Position:  [-11.1430939]


portfolio before change:  [3.63481116]
curr_Stock_Price:  99.59277057519647
curr_Factors:  [99.59277058]
mat_Sqrt:  [[0.15]]
grads:  [0.22234749]
Stock Position:  0.22234748509397395
Bond Position:  [-18.50939091]


portfolio before change:  [3.90233056]
curr_Stock_Price:  100.80633599325223
curr_Factors:  [100.80633599]
mat_Sqrt:  [[0.15]]
grads:  [-0.02324281]
Stock Position:  -0.023242812798761163
Bond Position:  [6.24535336]


portfolio before change:  [3.92783458]
curr_Stock_Price:  99.74263957316792
curr_Factors:  [99.74263957]
mat_Sqrt:  [[0.15]]
grads:  [-0.04543201]
Stock Position:  -0.04543201370535141
Bond Position:  [8.45934354]


portfolio before change:  [3.9471642]
curr_Stock_Price:  99.34045321892674
curr_Factors:  [99.34045322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04897087]
Stock Position:  -0.04897087164597947
Bond Position:  [8.81195278]


portfolio before change:  [3.9151529]
curr_Stock_Price:  100.01662791244581
curr_Factors:  [100.01662791]
mat_Sqrt:  [[0.15]]
grads:  [0.19661096]
Stock Position:  0.19661096474905768
Bond Position:  [-15.74921281]


portfolio before change:  [3.7345348]
curr_Stock_Price:  99.10798417613448
curr_Factors:  [99.10798418]
mat_Sqrt:  [[0.15]]
grads:  [0.02363959]
Stock Position:  0.023639586856754203
Bond Position:  [1.391663]


portfolio before change:  [3.74909264]
curr_Stock_Price:  99.71644967433272
curr_Factors:  [99.71644967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223483]
Stock Position:  -0.002234834767371966
Bond Position:  [3.97194243]


portfolio before change:  [3.75055918]
curr_Stock_Price:  99.28240461450045
curr_Factors:  [99.28240461]
mat_Sqrt:  [[0.15]]
grads:  [-0.18487945]
Stock Position:  -0.18487945347681928
Bond Position:  [22.10583589]


portfolio before change:  [3.81535946]
curr_Stock_Price:  98.9468515076437
curr_Factors:  [98.94685151]
mat_Sqrt:  [[0.15]]
grads:  [0.1562364]
Stock Position:  0.15623640340999373
Bond Position:  [-11.64374075]


portfolio before change:  [3.91724387]
curr_Stock_Price:  99.60828487205163
curr_Factors:  [99.60828487]
mat_Sqrt:  [[0.15]]
grads:  [0.13000047]
Stock Position:  0.13000047338343174
Bond Position:  [-9.03188031]


portfolio before change:  [3.66110969]
curr_Stock_Price:  97.64671415146239
curr_Factors:  [97.64671415]
mat_Sqrt:  [[0.15]]
grads:  [-0.06224421]
Stock Position:  -0.062244213697738665
Bond Position:  [9.73905264]


portfolio before change:  [3.70716357]
curr_Stock_Price:  96.9263834053548
curr_Factors:  [96.92638341]
mat_Sqrt:  [[0.15]]
grads:  [-0.10073997]
Stock Position:  -0.10073997060759556
Bond Position:  [13.47152459]


portfolio before change:  [3.74095368]
curr_Stock_Price:  96.607681079458
curr_Factors:  [96.60768108]
mat_Sqrt:  [[0.15]]
grads:  [0.1084243]
Stock Position:  0.10842430094288083
Bond Position:  [-6.73366661]


portfolio before change:  [3.70413407]
curr_Stock_Price:  96.27585647742337
curr_Factors:  [96.27585648]
mat_Sqrt:  [[0.15]]
grads:  [-0.09742522]
Stock Position:  -0.09742521728502407
Bond Position:  [13.08383031]


portfolio before change:  [3.80512508]
curr_Stock_Price:  95.25604419040364
curr_Factors:  [95.25604419]
mat_Sqrt:  [[0.15]]
grads:  [-0.00871689]
Stock Position:  -0.008716894715259759
Bond Position:  [4.63546199]


portfolio before change:  [3.80282617]
curr_Stock_Price:  95.58625156111005
curr_Factors:  [95.58625156]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048884]
Stock Position:  -0.040488839144960466
Bond Position:  [7.67300253]


portfolio before change:  [3.76823677]
curr_Stock_Price:  96.4642364939602
curr_Factors:  [96.46423649]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954553]
Stock Position:  -0.009545532746042286
Bond Position:  [4.68903929]


portfolio before change:  [3.77367367]
curr_Stock_Price:  95.95606770237465
curr_Factors:  [95.9560677]
mat_Sqrt:  [[0.15]]
grads:  [0.00892986]
Stock Position:  0.00892985623471923
Bond Position:  [2.91679978]


portfolio before change:  [3.77402352]
curr_Stock_Price:  95.95441307142168
curr_Factors:  [95.95441307]
mat_Sqrt:  [[0.15]]
grads:  [-0.03336045]
Stock Position:  -0.03336044743985615
Bond Position:  [6.97510567]


portfolio before change:  [3.74844281]
curr_Stock_Price:  96.74734782589007
curr_Factors:  [96.74734783]
mat_Sqrt:  [[0.15]]
grads:  [-0.06103153]
Stock Position:  -0.061031527387400725
Bond Position:  [9.65308121]


portfolio before change:  [3.78208737]
curr_Stock_Price:  96.21585448756397
curr_Factors:  [96.21585449]
mat_Sqrt:  [[0.15]]
grads:  [-0.13695014]
Stock Position:  -0.13695013752485688
Bond Position:  [16.95886187]


portfolio before change:  [3.83284228]
curr_Stock_Price:  95.8607257670027
curr_Factors:  [95.86072577]
mat_Sqrt:  [[0.15]]
grads:  [0.03336465]
Stock Position:  0.03336465070379688
Bond Position:  [0.63448265]


portfolio before change:  [3.8118888]
curr_Stock_Price:  95.23033399939074
curr_Factors:  [95.230334]
mat_Sqrt:  [[0.15]]
grads:  [-0.07502399]
Stock Position:  -0.07502399033789271
Bond Position:  [10.95644846]


portfolio before change:  [3.78671647]
curr_Stock_Price:  95.5841137717606
curr_Factors:  [95.58411377]
mat_Sqrt:  [[0.15]]
grads:  [0.07634479]
Stock Position:  0.07634479027533654
Bond Position:  [-3.51063265]


portfolio before change:  [3.83948018]
curr_Stock_Price:  96.2809859953987
curr_Factors:  [96.280986]
mat_Sqrt:  [[0.15]]
grads:  [0.01168778]
Stock Position:  0.011687782498526504
Bond Position:  [2.71416895]


portfolio before change:  [3.84064642]
curr_Stock_Price:  96.35173930719986
curr_Factors:  [96.35173931]
mat_Sqrt:  [[0.15]]
grads:  [0.1279243]
Stock Position:  0.127924300456706
Bond Position:  [-8.48508243]


portfolio before change:  [3.93582275]
curr_Stock_Price:  97.10403602067075
curr_Factors:  [97.10403602]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254804]
Stock Position:  -0.025480400662283943
Bond Position:  [6.41007249]


portfolio before change:  [3.92781925]
curr_Stock_Price:  97.44958807571169
curr_Factors:  [97.44958808]
mat_Sqrt:  [[0.15]]
grads:  [-0.10088675]
Stock Position:  -0.10088675138303249
Bond Position:  [13.75919162]


portfolio before change:  [3.80923627]
curr_Stock_Price:  98.64204384267535
curr_Factors:  [98.64204384]
mat_Sqrt:  [[0.15]]
grads:  [-0.097534]
Stock Position:  -0.09753399873167085
Bond Position:  [13.43018925]


portfolio before change:  [3.82022514]
curr_Stock_Price:  98.54659004152435
curr_Factors:  [98.54659004]
mat_Sqrt:  [[0.15]]
grads:  [0.05274401]
Stock Position:  0.05274401394432417
Bond Position:  [-1.37751758]


portfolio before change:  [3.86324562]
curr_Stock_Price:  99.3655015871804
curr_Factors:  [99.36550159]
mat_Sqrt:  [[0.15]]
grads:  [0.10020796]
Stock Position:  0.10020795841980086
Bond Position:  [-6.09396843]


portfolio before change:  [3.92987889]
curr_Stock_Price:  100.03805357872034
curr_Factors:  [100.03805358]
mat_Sqrt:  [[0.15]]
grads:  [-0.04993996]
Stock Position:  -0.04993996446126094
Bond Position:  [8.92577573]


portfolio before change:  [3.96148654]
curr_Stock_Price:  99.42748328101123
curr_Factors:  [99.42748328]
mat_Sqrt:  [[0.15]]
grads:  [-0.22955865]
Stock Position:  -0.22955864686596203
Bond Position:  [26.78592506]


portfolio before change:  [3.73126016]
curr_Stock_Price:  100.44497850849534
curr_Factors:  [100.44497851]
mat_Sqrt:  [[0.15]]
grads:  [-0.14172014]
Stock Position:  -0.14172013959742996
Bond Position:  [17.96633654]


portfolio before change:  [3.6947789]
curr_Stock_Price:  100.71824376336023
curr_Factors:  [100.71824376]
mat_Sqrt:  [[0.15]]
grads:  [0.17638074]
Stock Position:  0.17638073531061227
Bond Position:  [-14.06997899]


portfolio before change:  [3.62005499]
curr_Stock_Price:  100.30456448365969
curr_Factors:  [100.30456448]
mat_Sqrt:  [[0.15]]
grads:  [0.02599846]
Stock Position:  0.025998456502444273
Bond Position:  [1.01229113]


portfolio before change:  [3.62471138]
curr_Stock_Price:  100.47879955859273
curr_Factors:  [100.47879956]
mat_Sqrt:  [[0.15]]
grads:  [0.06615591]
Stock Position:  0.06615590587639826
Bond Position:  [-3.02255463]


portfolio before change:  [3.69515161]
curr_Stock_Price:  101.54927201094507
curr_Factors:  [101.54927201]
mat_Sqrt:  [[0.15]]
grads:  [0.05696979]
Stock Position:  0.05696979493903895
Bond Position:  [-2.09008959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6972951]
Stock Price:  101.59148320329665
PL:  [2.10581189]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.14990128e-02]
 [ 4.32450151e-02]
 [-3.54435837e-03]
 [-6.42936163e-03]
 [-7.39522467e-03]
 [ 2.84007345e-02]
 [ 3.66686226e-03]
 [ 5.09668020e-03]
 [-8.20140427e-03]
 [ 2.26713800e-02]
 [ 1.51777298e-02]
 [ 6.93606120e-03]
 [ 8.09751914e-03]
 [ 2.33463599e-02]
 [-1.22127284e-02]
 [-3.01522822e-03]
 [-5.69010912e-03]
 [ 6.93181392e-03]
 [ 1.33592866e-02]
 [ 1.71734298e-02]
 [-1.91805827e-03]
 [-5.50291695e-03]
 [ 3.96595755e-03]
 [-1.21706054e-02]
 [ 1.42844634e-04]
 [ 4.53270109e-03]
 [ 6.84549449e-03]
 [ 2.03463090e-03]
 [ 4.79874466e-03]
 [-5.71336162e-03]
 [-1.66166468e-02]
 [ 5.54247276e-03]
 [ 5.85822833e-03]
 [ 4.24734112e-02]
 [-2.01375457e-02]
 [-1.19989382e-02]
 [ 1.34587392e-02]
 [ 2.32546369e-02]
 [ 9.74186688e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.01488265]
curr_Stock_Price:  100.14248388459697
curr_Factors:  [100.14248388]
mat_Sqrt:  [[0.15]]
grads:  [0.14332675]
Stock Position:  0.14332675228953995
Bond Position:  [-9.33821433]


portfolio before change:  [5.07325556]
curr_Stock_Price:  100.55790009887313
curr_Factors:  [100.5579001]
mat_Sqrt:  [[0.15]]
grads:  [0.2883001]
Stock Position:  0.2883001004437201
Bond Position:  [-23.91759714]


portfolio before change:  [5.11869201]
curr_Stock_Price:  100.7258720761003
curr_Factors:  [100.72587208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362906]
Stock Position:  -0.02362905582361128
Bond Position:  [7.49874927]


portfolio before change:  [5.1388511]
curr_Stock_Price:  99.91239546421852
curr_Factors:  [99.91239546]
mat_Sqrt:  [[0.15]]
grads:  [-0.04286241]
Stock Position:  -0.042862410857463056
Bond Position:  [9.42133724]


portfolio before change:  [5.14770983]
curr_Stock_Price:  99.73319429576698
curr_Factors:  [99.7331943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0493015]
Stock Position:  -0.04930149782049434
Bond Position:  [10.06470569]


portfolio before change:  [5.14276974]
curr_Stock_Price:  99.85891583356367
curr_Factors:  [99.85891583]
mat_Sqrt:  [[0.15]]
grads:  [0.18933823]
Stock Position:  0.1893382297619185
Bond Position:  [-13.76434061]


portfolio before change:  [5.18088987]
curr_Stock_Price:  100.0693370712094
curr_Factors:  [100.06933707]
mat_Sqrt:  [[0.15]]
grads:  [0.02444575]
Stock Position:  0.024445748428517253
Bond Position:  [2.73462003]


portfolio before change:  [5.19564966]
curr_Stock_Price:  100.6591303142216
curr_Factors:  [100.65913031]
mat_Sqrt:  [[0.15]]
grads:  [0.03397787]
Stock Position:  0.033977867978832114
Bond Position:  [1.77546702]


portfolio before change:  [5.24389457]
curr_Stock_Price:  102.07249028447517
curr_Factors:  [102.07249028]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467603]
Stock Position:  -0.0546760284482128
Bond Position:  [10.82481295]


portfolio before change:  [5.17021094]
curr_Stock_Price:  103.4448797946428
curr_Factors:  [103.44487979]
mat_Sqrt:  [[0.15]]
grads:  [0.15114253]
Stock Position:  0.15114253353209084
Bond Position:  [-10.46471027]


portfolio before change:  [5.3622546]
curr_Stock_Price:  104.7241479348445
curr_Factors:  [104.72414793]
mat_Sqrt:  [[0.15]]
grads:  [0.10118487]
Stock Position:  0.10118486506049768
Bond Position:  [-5.23424418]


portfolio before change:  [5.35618588]
curr_Stock_Price:  104.67063797004559
curr_Factors:  [104.67063797]
mat_Sqrt:  [[0.15]]
grads:  [0.04624041]
Stock Position:  0.04624040803151707
Bond Position:  [0.51617287]


portfolio before change:  [5.27172998]
curr_Stock_Price:  102.842790123537
curr_Factors:  [102.84279012]
mat_Sqrt:  [[0.15]]
grads:  [0.05398346]
Stock Position:  0.053983460931192585
Bond Position:  [-0.28007977]


portfolio before change:  [5.32355938]
curr_Stock_Price:  103.80353653000797
curr_Factors:  [103.80353653]
mat_Sqrt:  [[0.15]]
grads:  [0.1556424]
Stock Position:  0.15564239950881303
Bond Position:  [-10.83267212]


portfolio before change:  [5.04183828]
curr_Stock_Price:  102.00218333480427
curr_Factors:  [102.00218333]
mat_Sqrt:  [[0.15]]
grads:  [-0.08141819]
Stock Position:  -0.0814181892000957
Bond Position:  [13.34667134]


portfolio before change:  [5.00382745]
curr_Stock_Price:  102.48953469054439
curr_Factors:  [102.48953469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010152]
Stock Position:  -0.020101521441374955
Bond Position:  [7.06402303]


portfolio before change:  [5.0180012]
curr_Stock_Price:  101.82835634062445
curr_Factors:  [101.82835634]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793406]
Stock Position:  -0.03793406081360418
Bond Position:  [8.88076426]


portfolio before change:  [5.02099376]
curr_Stock_Price:  101.77873349587766
curr_Factors:  [101.7787335]
mat_Sqrt:  [[0.15]]
grads:  [0.04621209]
Stock Position:  0.0462120928216825
Bond Position:  [0.31758548]


portfolio before change:  [5.03638798]
curr_Stock_Price:  102.11099539369243
curr_Factors:  [102.11099539]
mat_Sqrt:  [[0.15]]
grads:  [0.08906191]
Stock Position:  0.08906191095944388
Bond Position:  [-4.0578124]


portfolio before change:  [5.07802846]
curr_Stock_Price:  102.58423626704982
curr_Factors:  [102.58423627]
mat_Sqrt:  [[0.15]]
grads:  [0.11448953]
Stock Position:  0.11448953232192145
Bond Position:  [-6.66679278]


portfolio before change:  [5.02523699]
curr_Stock_Price:  102.13041255543848
curr_Factors:  [102.13041256]
mat_Sqrt:  [[0.15]]
grads:  [-0.01278706]
Stock Position:  -0.012787055139193216
Bond Position:  [6.33118421]


portfolio before change:  [5.02786981]
curr_Stock_Price:  101.98640999057046
curr_Factors:  [101.98640999]
mat_Sqrt:  [[0.15]]
grads:  [-0.03668611]
Stock Position:  -0.03668611298481029
Bond Position:  [8.76935477]


portfolio before change:  [5.00625294]
curr_Stock_Price:  102.6055298893218
curr_Factors:  [102.60552989]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [2.29339177]


portfolio before change:  [4.99104094]
curr_Stock_Price:  102.01934011361898
curr_Factors:  [102.01934011]
mat_Sqrt:  [[0.15]]
grads:  [-0.08113737]
Stock Position:  -0.08113736901658934
Bond Position:  [13.26862179]


portfolio before change:  [4.91866904]
curr_Stock_Price:  102.93175055176008
curr_Factors:  [102.93175055]
mat_Sqrt:  [[0.15]]
grads:  [0.0009523]
Stock Position:  0.0009522975570777579
Bond Position:  [4.82064739]


portfolio before change:  [4.9202151]
curr_Stock_Price:  103.92244748468177
curr_Factors:  [103.92244748]
mat_Sqrt:  [[0.15]]
grads:  [0.03021801]
Stock Position:  0.0302180072509263
Bond Position:  [1.77988583]


portfolio before change:  [4.94675954]
curr_Stock_Price:  104.79351564146573
curr_Factors:  [104.79351564]
mat_Sqrt:  [[0.15]]
grads:  [0.04563663]
Stock Position:  0.0456366299012743
Bond Position:  [0.16433665]


portfolio before change:  [4.9362948]
curr_Stock_Price:  104.5637597265798
curr_Factors:  [104.56375973]
mat_Sqrt:  [[0.15]]
grads:  [0.01356421]
Stock Position:  0.01356420601908016
Bond Position:  [3.51797042]


portfolio before change:  [4.92400787]
curr_Stock_Price:  103.62550332144204
curr_Factors:  [103.62550332]
mat_Sqrt:  [[0.15]]
grads:  [0.03199163]
Stock Position:  0.03199163105526186
Bond Position:  [1.608859]


portfolio before change:  [4.91470278]
curr_Stock_Price:  103.32835660463765
curr_Factors:  [103.3283566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03808908]
Stock Position:  -0.03808907746926886
Bond Position:  [8.85038456]


portfolio before change:  [4.87854972]
curr_Stock_Price:  104.30657489463648
curr_Factors:  [104.30657489]
mat_Sqrt:  [[0.15]]
grads:  [-0.11077765]
Stock Position:  -0.11077764554123348
Bond Position:  [16.4333865]


portfolio before change:  [4.82779618]
curr_Stock_Price:  104.78327612787818
curr_Factors:  [104.78327613]
mat_Sqrt:  [[0.15]]
grads:  [0.03694982]
Stock Position:  0.03694981842733371
Bond Position:  [0.95607315]


portfolio before change:  [4.8600051]
curr_Stock_Price:  105.65173508772104
curr_Factors:  [105.65173509]
mat_Sqrt:  [[0.15]]
grads:  [0.03905486]
Stock Position:  0.0390548555358073
Bond Position:  [0.73379185]


portfolio before change:  [4.87553273]
curr_Stock_Price:  106.04697163666137
curr_Factors:  [106.04697164]
mat_Sqrt:  [[0.15]]
grads:  [0.28315607]
Stock Position:  0.28315607481741206
Bond Position:  [-25.1523115]


portfolio before change:  [4.72737396]
curr_Stock_Price:  105.53483522761454
curr_Factors:  [105.53483523]
mat_Sqrt:  [[0.15]]
grads:  [-0.1342503]
Stock Position:  -0.1342503046723912
Bond Position:  [18.89545775]


portfolio before change:  [4.67097869]
curr_Stock_Price:  105.97250538703939
curr_Factors:  [105.97250539]
mat_Sqrt:  [[0.15]]
grads:  [-0.07999292]
Stock Position:  -0.07999292150418806
Bond Position:  [13.148029]


portfolio before change:  [4.69885704]
curr_Stock_Price:  105.64454211218622
curr_Factors:  [105.64454211]
mat_Sqrt:  [[0.15]]
grads:  [0.08972493]
Stock Position:  0.08972492809667469
Bond Position:  [-4.78009191]


portfolio before change:  [4.61508914]
curr_Stock_Price:  104.71759401610738
curr_Factors:  [104.71759402]
mat_Sqrt:  [[0.15]]
grads:  [0.15503091]
Stock Position:  0.15503091273976996
Bond Position:  [-11.61937504]


portfolio before change:  [4.60249719]
curr_Stock_Price:  104.64574103014785
curr_Factors:  [104.64574103]
mat_Sqrt:  [[0.15]]
grads:  [0.06494578]
Stock Position:  0.06494577922757346
Bond Position:  [-2.193802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.65179126]
Stock Price:  105.40896716453163
PL:  [-0.7571759]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.06661952e-02]
 [-1.00232885e-02]
 [-1.26671636e-02]
 [-1.04648064e-02]
 [-1.53477756e-03]
 [ 6.55211698e-02]
 [ 3.04123025e-03]
 [ 1.22762389e-02]
 [ 1.13581514e-01]
 [ 2.32485137e-02]
 [ 2.22819585e-02]
 [-4.00351255e-03]
 [-2.42007745e-02]
 [ 1.79570591e-02]
 [-1.14585031e-02]
 [-3.39803610e-04]
 [-6.11159134e-03]
 [-3.34100576e-04]
 [ 2.36664105e-03]
 [-2.98832739e-02]
 [-4.30849612e-03]
 [-1.57145355e-02]
 [ 6.18558206e-03]
 [-8.56962891e-03]
 [ 1.27720879e-02]
 [ 3.60303117e-03]
 [ 1.53118963e-02]
 [-3.76790135e-03]
 [-2.31301747e-02]
 [-1.09940627e-02]
 [ 4.17958879e-02]
 [ 3.31370202e-03]
 [-1.46966037e-02]
 [-4.83227993e-02]
 [-2.25276720e-02]
 [ 3.98582073e-02]
 [-1.60107550e-03]
 [ 3.99531334e-03]
 [ 9.10255409e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.7862299]
curr_Stock_Price:  99.55944375346219
curr_Factors:  [99.55944375]
mat_Sqrt:  [[0.15]]
grads:  [-0.07110797]
Stock Position:  -0.07110796829314768
Bond Position:  [-0.70676013]


portfolio before change:  [-7.64543859]
curr_Stock_Price:  97.5782359597358
curr_Factors:  [97.57823596]
mat_Sqrt:  [[0.15]]
grads:  [-0.06682192]
Stock Position:  -0.06682192342328096
Bond Position:  [-1.12507318]


portfolio before change:  [-7.55455187]
curr_Stock_Price:  96.21599790292932
curr_Factors:  [96.2159979]
mat_Sqrt:  [[0.15]]
grads:  [-0.08444776]
Stock Position:  -0.08444775726741548
Bond Position:  [0.57067337]


portfolio before change:  [-7.53675008]
curr_Stock_Price:  96.00604026623944
curr_Factors:  [96.00604027]
mat_Sqrt:  [[0.15]]
grads:  [-0.06976538]
Stock Position:  -0.06976537581569286
Bond Position:  [-0.8388526]


portfolio before change:  [-7.49997569]
curr_Stock_Price:  95.47742201115597
curr_Factors:  [95.47742201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023185]
Stock Position:  -0.010231850396179779
Bond Position:  [-6.52306499]


portfolio before change:  [-7.50028991]
curr_Stock_Price:  95.42843576570083
curr_Factors:  [95.42843577]
mat_Sqrt:  [[0.15]]
grads:  [0.4368078]
Stock Position:  0.4368077987910759
Bond Position:  [-49.18417487]


portfolio before change:  [-7.86938855]
curr_Stock_Price:  94.59752056453468
curr_Factors:  [94.59752056]
mat_Sqrt:  [[0.15]]
grads:  [0.02027487]
Stock Position:  0.020274868359822982
Bond Position:  [-9.78734083]


portfolio before change:  [-7.87805149]
curr_Stock_Price:  94.23059102525029
curr_Factors:  [94.23059103]
mat_Sqrt:  [[0.15]]
grads:  [0.08184159]
Stock Position:  0.08184159297482146
Bond Position:  [-15.59003317]


portfolio before change:  [-7.86862312]
curr_Stock_Price:  94.36960651095349
curr_Factors:  [94.36960651]
mat_Sqrt:  [[0.15]]
grads:  [0.7572101]
Stock Position:  0.7572100953653126
Bond Position:  [-79.32624187]


portfolio before change:  [-7.68970686]
curr_Stock_Price:  94.61898599069455
curr_Factors:  [94.61898599]
mat_Sqrt:  [[0.15]]
grads:  [0.15499009]
Stock Position:  0.1549900915385041
Bond Position:  [-22.35471216]


portfolio before change:  [-7.64725399]
curr_Stock_Price:  94.91092325442354
curr_Factors:  [94.91092325]
mat_Sqrt:  [[0.15]]
grads:  [0.14854639]
Stock Position:  0.1485463900732399
Bond Position:  [-21.74592902]


portfolio before change:  [-7.52759772]
curr_Stock_Price:  95.73473785552642
curr_Factors:  [95.73473786]
mat_Sqrt:  [[0.15]]
grads:  [-0.02669008]
Stock Position:  -0.02669008364881044
Bond Position:  [-4.97242956]


portfolio before change:  [-7.52997299]
curr_Stock_Price:  95.80044301520007
curr_Factors:  [95.80044302]
mat_Sqrt:  [[0.15]]
grads:  [-0.1613385]
Stock Position:  -0.16133849640181314
Bond Position:  [7.92632644]


portfolio before change:  [-7.53717285]
curr_Stock_Price:  95.85121027740092
curr_Factors:  [95.85121028]
mat_Sqrt:  [[0.15]]
grads:  [0.11971373]
Stock Position:  0.1197137274155477
Bond Position:  [-19.01187851]


portfolio before change:  [-7.52620368]
curr_Stock_Price:  95.9626911885745
curr_Factors:  [95.96269119]
mat_Sqrt:  [[0.15]]
grads:  [-0.07639002]
Stock Position:  -0.07639002044289098
Bond Position:  [-0.19561174]


portfolio before change:  [-7.53350514]
curr_Stock_Price:  96.05795232110192
curr_Factors:  [96.05795232]
mat_Sqrt:  [[0.15]]
grads:  [-0.00226536]
Stock Position:  -0.0022653574031780382
Bond Position:  [-7.31589954]


portfolio before change:  [-7.5358932]
curr_Stock_Price:  96.70841036084978
curr_Factors:  [96.70841036]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074394]
Stock Position:  -0.04074394227009102
Bond Position:  [-3.59561131]


portfolio before change:  [-7.54147449]
curr_Stock_Price:  96.83436313938628
curr_Factors:  [96.83436314]
mat_Sqrt:  [[0.15]]
grads:  [-0.00222734]
Stock Position:  -0.002227337174299284
Bond Position:  [-7.32579172]


portfolio before change:  [-7.54396183]
curr_Stock_Price:  97.53993975473927
curr_Factors:  [97.53993975]
mat_Sqrt:  [[0.15]]
grads:  [0.01577761]
Stock Position:  0.01577760700565845
Bond Position:  [-9.08290867]


portfolio before change:  [-7.53793368]
curr_Stock_Price:  97.99397489739981
curr_Factors:  [97.9939749]
mat_Sqrt:  [[0.15]]
grads:  [-0.19922183]
Stock Position:  -0.19922182581325412
Bond Position:  [11.98460492]


portfolio before change:  [-7.52981007]
curr_Stock_Price:  97.96071830311124
curr_Factors:  [97.9607183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02872331]
Stock Position:  -0.02872330746543943
Bond Position:  [-4.71605424]


portfolio before change:  [-7.52296874]
curr_Stock_Price:  97.70201293722974
curr_Factors:  [97.70201294]
mat_Sqrt:  [[0.15]]
grads:  [-0.10476357]
Stock Position:  -0.10476357012062973
Bond Position:  [2.71264294]


portfolio before change:  [-7.47515116]
curr_Stock_Price:  97.24881648997123
curr_Factors:  [97.24881649]
mat_Sqrt:  [[0.15]]
grads:  [0.04123721]
Stock Position:  0.04123721374636674
Bond Position:  [-11.48542139]


portfolio before change:  [-7.46504855]
curr_Stock_Price:  97.52862155267715
curr_Factors:  [97.52862155]
mat_Sqrt:  [[0.15]]
grads:  [-0.05713086]
Stock Position:  -0.0571308593828174
Bond Position:  [-1.89315458]


portfolio before change:  [-7.44006173]
curr_Stock_Price:  97.08711809189941
curr_Factors:  [97.08711809]
mat_Sqrt:  [[0.15]]
grads:  [0.08514725]
Stock Position:  0.08514725270103016
Bond Position:  [-15.70676311]


portfolio before change:  [-7.44431398]
curr_Stock_Price:  97.06023783289459
curr_Factors:  [97.06023783]
mat_Sqrt:  [[0.15]]
grads:  [0.02402021]
Stock Position:  0.024020207824050187
Bond Position:  [-9.77572107]


portfolio before change:  [-7.44900734]
curr_Stock_Price:  96.915721292804
curr_Factors:  [96.91572129]
mat_Sqrt:  [[0.15]]
grads:  [0.10207931]
Stock Position:  0.10207930839801185
Bond Position:  [-17.34209714]


portfolio before change:  [-7.41914687]
curr_Stock_Price:  97.22948096638271
curr_Factors:  [97.22948097]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511934]
Stock Position:  -0.025119342354507676
Bond Position:  [-4.97680625]


portfolio before change:  [-7.39796945]
curr_Stock_Price:  96.3616414710034
curr_Factors:  [96.36164147]
mat_Sqrt:  [[0.15]]
grads:  [-0.15420116]
Stock Position:  -0.15420116461361127
Bond Position:  [7.46110789]


portfolio before change:  [-7.35023208]
curr_Stock_Price:  96.05811150829581
curr_Factors:  [96.05811151]
mat_Sqrt:  [[0.15]]
grads:  [-0.07329375]
Stock Position:  -0.0732937511845151
Bond Position:  [-0.30977276]


portfolio before change:  [-7.34357113]
curr_Stock_Price:  95.96670292170522
curr_Factors:  [95.96670292]
mat_Sqrt:  [[0.15]]
grads:  [0.27863925]
Stock Position:  0.278639252543485
Bond Position:  [-34.0836615]


portfolio before change:  [-7.3322337]
curr_Stock_Price:  96.02268264686535
curr_Factors:  [96.02268265]
mat_Sqrt:  [[0.15]]
grads:  [0.02209135]
Stock Position:  0.022091346796155698
Bond Position:  [-9.45350408]


portfolio before change:  [-7.3158296]
curr_Stock_Price:  96.81873496168124
curr_Factors:  [96.81873496]
mat_Sqrt:  [[0.15]]
grads:  [-0.09797736]
Stock Position:  -0.09797735805393208
Bond Position:  [2.17021427]


portfolio before change:  [-7.41038783]
curr_Stock_Price:  97.7866068030495
curr_Factors:  [97.7866068]
mat_Sqrt:  [[0.15]]
grads:  [-0.322152]
Stock Position:  -0.32215199525741284
Bond Position:  [24.09176266]


portfolio before change:  [-7.39531176]
curr_Stock_Price:  97.74915736582051
curr_Factors:  [97.74915737]
mat_Sqrt:  [[0.15]]
grads:  [-0.15018448]
Stock Position:  -0.15018448013760402
Bond Position:  [7.28509462]


portfolio before change:  [-7.27114089]
curr_Stock_Price:  96.92843225607218
curr_Factors:  [96.92843226]
mat_Sqrt:  [[0.15]]
grads:  [0.26572138]
Stock Position:  0.265721382136771
Bond Position:  [-33.02709788]


portfolio before change:  [-7.36609279]
curr_Stock_Price:  96.58663343840388
curr_Factors:  [96.58663344]
mat_Sqrt:  [[0.15]]
grads:  [-0.01067384]
Stock Position:  -0.010673836647883093
Bond Position:  [-6.33514284]


portfolio before change:  [-7.37056894]
curr_Stock_Price:  96.93179613921866
curr_Factors:  [96.93179614]
mat_Sqrt:  [[0.15]]
grads:  [0.02663542]
Stock Position:  0.026635422240528166
Bond Position:  [-9.95238826]


portfolio before change:  [-7.36260092]
curr_Stock_Price:  97.27765685551086
curr_Factors:  [97.27765686]
mat_Sqrt:  [[0.15]]
grads:  [0.06068369]
Stock Position:  0.060683693934651096
Bond Position:  [-13.26576848]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.34336258]
Stock Price:  97.6220107121163
PL:  [-7.34336258]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.50475495e-02]
 [ 4.13533066e-02]
 [-2.76163028e-03]
 [-7.00831729e-03]
 [-7.39448175e-03]
 [ 2.83516433e-02]
 [ 3.67493510e-03]
 [-1.16949346e-03]
 [-2.77235481e-02]
 [ 2.34405776e-02]
 [ 2.04007143e-02]
 [-1.08860752e-02]
 [ 1.99594828e-03]
 [ 6.35516715e-03]
 [-1.02457404e-02]
 [ 5.94063550e-05]
 [-6.02297679e-03]
 [ 4.73535342e-03]
 [ 5.33713619e-03]
 [-2.80010815e-02]
 [-2.83328905e-03]
 [-1.18979211e-02]
 [ 6.59135697e-03]
 [-8.24023132e-03]
 [ 1.34290761e-02]
 [ 5.27643347e-03]
 [ 2.00720156e-02]
 [-4.25189590e-03]
 [-3.34772913e-02]
 [-9.66333816e-03]
 [ 4.74206924e-02]
 [-2.69591009e-03]
 [-2.11720438e-02]
 [-1.30449192e-02]
 [-2.39648961e-02]
 [ 3.52473463e-02]
 [-7.30638120e-03]
 [-3.53367166e-03]
 [ 3.00736027e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.01712509]
curr_Stock_Price:  100.50695443038373
curr_Factors:  [100.50695443]
mat_Sqrt:  [[0.15]]
grads:  [-0.100317]
Stock Position:  -0.10031699634741734
Bond Position:  [23.09968087]


portfolio before change:  [13.07012819]
curr_Stock_Price:  100.00738344216435
curr_Factors:  [100.00738344]
mat_Sqrt:  [[0.15]]
grads:  [0.27568871]
Stock Position:  0.2756887104318089
Bond Position:  [-14.50077838]


portfolio before change:  [13.18021113]
curr_Stock_Price:  100.41326024179956
curr_Factors:  [100.41326024]
mat_Sqrt:  [[0.15]]
grads:  [-0.01841087]
Stock Position:  -0.018410868559026648
Bond Position:  [15.02890647]


portfolio before change:  [13.20704621]
curr_Stock_Price:  99.0577375974105
curr_Factors:  [99.0577376]
mat_Sqrt:  [[0.15]]
grads:  [-0.04672212]
Stock Position:  -0.04672211524120488
Bond Position:  [17.83523325]


portfolio before change:  [13.19531341]
curr_Stock_Price:  99.35657572757162
curr_Factors:  [99.35657573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04929655]
Stock Position:  -0.049296545005709194
Bond Position:  [18.09324931]


portfolio before change:  [13.17318221]
curr_Stock_Price:  99.85139734613239
curr_Factors:  [99.85139735]
mat_Sqrt:  [[0.15]]
grads:  [0.18901096]
Stock Position:  0.18901095555372854
Bond Position:  [-5.69982582]


portfolio before change:  [13.22949223]
curr_Stock_Price:  100.15308641875163
curr_Factors:  [100.15308642]
mat_Sqrt:  [[0.15]]
grads:  [0.02449957]
Stock Position:  0.02449956733688316
Bond Position:  [10.77578494]


portfolio before change:  [13.20466025]
curr_Stock_Price:  99.08453548770395
curr_Factors:  [99.08453549]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779662]
Stock Position:  -0.007796623083441412
Bond Position:  [13.97718502]


portfolio before change:  [13.20460252]
curr_Stock_Price:  99.3160439424101
curr_Factors:  [99.31604394]
mat_Sqrt:  [[0.15]]
grads:  [-0.18482365]
Stock Position:  -0.18482365428861755
Bond Position:  [31.56055669]


portfolio before change:  [13.33086018]
curr_Stock_Price:  98.65426532139658
curr_Factors:  [98.65426532]
mat_Sqrt:  [[0.15]]
grads:  [0.15627052]
Stock Position:  0.15627051761319383
Bond Position:  [-2.08589293]


portfolio before change:  [13.35751326]
curr_Stock_Price:  98.82649122755903
curr_Factors:  [98.82649123]
mat_Sqrt:  [[0.15]]
grads:  [0.13600476]
Stock Position:  0.136004762224518
Bond Position:  [-0.08336018]


portfolio before change:  [13.25435019]
curr_Stock_Price:  98.06804243328384
curr_Factors:  [98.06804243]
mat_Sqrt:  [[0.15]]
grads:  [-0.07257383]
Stock Position:  -0.07257383438737407
Bond Position:  [20.37152406]


portfolio before change:  [13.2301845]
curr_Stock_Price:  98.43611297104864
curr_Factors:  [98.43611297]
mat_Sqrt:  [[0.15]]
grads:  [0.01330632]
Stock Position:  0.013306321849033664
Bond Position:  [11.9203619]


portfolio before change:  [13.23822586]
curr_Stock_Price:  98.92845222372719
curr_Factors:  [98.92845222]
mat_Sqrt:  [[0.15]]
grads:  [0.04236778]
Stock Position:  0.04236778103203468
Bond Position:  [9.04684686]


portfolio before change:  [13.24330686]
curr_Stock_Price:  99.02168509722962
curr_Factors:  [99.0216851]
mat_Sqrt:  [[0.15]]
grads:  [-0.06830494]
Stock Position:  -0.06830493600424466
Bond Position:  [20.00697672]


portfolio before change:  [13.26959638]
curr_Stock_Price:  98.67341606570722
curr_Factors:  [98.67341607]
mat_Sqrt:  [[0.15]]
grads:  [0.00039604]
Stock Position:  0.0003960423665835417
Bond Position:  [13.23051753]


portfolio before change:  [13.27119085]
curr_Stock_Price:  98.52330097036365
curr_Factors:  [98.52330097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04015318]
Stock Position:  -0.04015317861452768
Bond Position:  [17.22721455]


portfolio before change:  [13.23583012]
curr_Stock_Price:  99.45757967280572
curr_Factors:  [99.45757967]
mat_Sqrt:  [[0.15]]
grads:  [0.03156902]
Stock Position:  0.031569022768227845
Bond Position:  [10.09605153]


portfolio before change:  [13.22683365]
curr_Stock_Price:  99.1326232868658
curr_Factors:  [99.13262329]
mat_Sqrt:  [[0.15]]
grads:  [0.03558091]
Stock Position:  0.035580907915092615
Bond Position:  [9.69960491]


portfolio before change:  [13.21303056]
curr_Stock_Price:  98.71060981574382
curr_Factors:  [98.71060982]
mat_Sqrt:  [[0.15]]
grads:  [-0.18667388]
Stock Position:  -0.1866738764856362
Bond Position:  [31.63972274]


portfolio before change:  [13.10965479]
curr_Stock_Price:  99.28557498661345
curr_Factors:  [99.28557499]
mat_Sqrt:  [[0.15]]
grads:  [-0.01888859]
Stock Position:  -0.018888593692716938
Bond Position:  [14.98501968]


portfolio before change:  [13.12648914]
curr_Stock_Price:  98.49350445599595
curr_Factors:  [98.49350446]
mat_Sqrt:  [[0.15]]
grads:  [-0.07931947]
Stock Position:  -0.0793194737425892
Bond Position:  [20.93894208]


portfolio before change:  [13.15404388]
curr_Stock_Price:  98.17911498401149
curr_Factors:  [98.17911498]
mat_Sqrt:  [[0.15]]
grads:  [0.04394238]
Stock Position:  0.04394237981994152
Bond Position:  [8.83981991]


portfolio before change:  [13.13512533]
curr_Stock_Price:  97.72343673051192
curr_Factors:  [97.72343673]
mat_Sqrt:  [[0.15]]
grads:  [-0.05493488]
Stock Position:  -0.05493487546013224
Bond Position:  [18.50355016]


portfolio before change:  [13.13792152]
curr_Stock_Price:  97.71464272092572
curr_Factors:  [97.71464272]
mat_Sqrt:  [[0.15]]
grads:  [0.08952717]
Stock Position:  0.08952717424477205
Bond Position:  [4.38980568]


portfolio before change:  [13.14297362]
curr_Stock_Price:  97.76494411060399
curr_Factors:  [97.76494411]
mat_Sqrt:  [[0.15]]
grads:  [0.03517622]
Stock Position:  0.035176223147726275
Bond Position:  [9.70397213]


portfolio before change:  [13.08882569]
curr_Stock_Price:  96.19112511592591
curr_Factors:  [96.19112512]
mat_Sqrt:  [[0.15]]
grads:  [0.13381344]
Stock Position:  0.13381343714896296
Bond Position:  [0.21716061]


portfolio before change:  [13.07778723]
curr_Stock_Price:  96.10843082332818
curr_Factors:  [96.10843082]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834597]
Stock Position:  -0.028345972692513054
Bond Position:  [15.80207418]


portfolio before change:  [13.10321263]
curr_Stock_Price:  95.28115208955289
curr_Factors:  [95.28115209]
mat_Sqrt:  [[0.15]]
grads:  [-0.22318194]
Stock Position:  -0.22318194209931985
Bond Position:  [34.3682452]


portfolio before change:  [13.12462409]
curr_Stock_Price:  95.20446507198386
curr_Factors:  [95.20446507]
mat_Sqrt:  [[0.15]]
grads:  [-0.06442225]
Stock Position:  -0.06442225442960825
Bond Position:  [19.25791036]


portfolio before change:  [13.16709559]
curr_Stock_Price:  94.58256634908948
curr_Factors:  [94.58256635]
mat_Sqrt:  [[0.15]]
grads:  [0.31613795]
Stock Position:  0.3161379490495275
Bond Position:  [-16.73404295]


portfolio before change:  [13.02887654]
curr_Stock_Price:  94.1519721629321
curr_Factors:  [94.15197216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01797273]
Stock Position:  -0.017972733913358477
Bond Position:  [14.72104489]


portfolio before change:  [13.02455996]
curr_Stock_Price:  94.49453710982905
curr_Factors:  [94.49453711]
mat_Sqrt:  [[0.15]]
grads:  [-0.14114696]
Stock Position:  -0.14114695843614888
Bond Position:  [26.36217646]


portfolio before change:  [13.1657136]
curr_Stock_Price:  93.51783764132598
curr_Factors:  [93.51783764]
mat_Sqrt:  [[0.15]]
grads:  [-0.08696613]
Stock Position:  -0.08696612768774911
Bond Position:  [21.29859781]


portfolio before change:  [13.16519701]
curr_Stock_Price:  93.55439299497267
curr_Factors:  [93.55439299]
mat_Sqrt:  [[0.15]]
grads:  [-0.15976597]
Stock Position:  -0.15976597422135036
Bond Position:  [28.11200575]


portfolio before change:  [12.96750403]
curr_Stock_Price:  94.81378008437801
curr_Factors:  [94.81378008]
mat_Sqrt:  [[0.15]]
grads:  [0.23498231]
Stock Position:  0.23498230884968052
Bond Position:  [-9.31205693]


portfolio before change:  [12.84272223]
curr_Stock_Price:  94.28770765326762
curr_Factors:  [94.28770765]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870921]
Stock Position:  -0.04870920800802575
Bond Position:  [17.4354018]


portfolio before change:  [12.81467379]
curr_Stock_Price:  94.90828859489228
curr_Factors:  [94.90828859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02355781]
Stock Position:  -0.023557811036368278
Bond Position:  [15.05050532]


portfolio before change:  [12.83536815]
curr_Stock_Price:  94.10970291560584
curr_Factors:  [94.10970292]
mat_Sqrt:  [[0.15]]
grads:  [0.20049068]
Stock Position:  0.2004906849597341
Bond Position:  [-6.03275065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.66213611]
Stock Price:  93.24942407035462
PL:  [12.66213611]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.19073510e-02]
 [ 3.10872810e-02]
 [-1.76914279e-02]
 [-6.84009774e-03]
 [-7.40194311e-03]
 [ 2.78625779e-02]
 [ 3.56263848e-03]
 [-1.26356329e-03]
 [-2.52047505e-02]
 [ 2.33852045e-02]
 [ 1.91756288e-02]
 [-1.45078470e-02]
 [ 1.45410272e-02]
 [ 6.49192669e-03]
 [ 8.39239340e-03]
 [-2.22641518e-03]
 [-6.10460853e-03]
 [ 3.26293129e-03]
 [ 3.94095674e-03]
 [-2.87537047e-02]
 [-2.76533030e-03]
 [-9.60952643e-03]
 [ 7.04461334e-03]
 [-8.14077399e-03]
 [ 1.40234795e-02]
 [ 7.98408852e-03]
 [-6.38974609e-03]
 [-1.92927162e-03]
 [ 6.99308651e-04]
 [-8.90839088e-03]
 [-2.45859635e-02]
 [ 1.50209926e-02]
 [-1.00199637e-02]
 [-4.19493181e-02]
 [-2.18437061e-02]
 [ 3.91406925e-02]
 [ 2.73948149e-03]
 [ 7.06153754e-03]
 [ 5.37590134e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.46624284]
curr_Stock_Price:  99.48292579766192
curr_Factors:  [99.4829258]
mat_Sqrt:  [[0.15]]
grads:  [-0.07938234]
Stock Position:  -0.07938234002711915
Bond Position:  [-1.5690554]


portfolio before change:  [-9.45745611]
curr_Stock_Price:  99.36976610896824
curr_Factors:  [99.36976611]
mat_Sqrt:  [[0.15]]
grads:  [0.20724854]
Stock Position:  0.20724854032464385
Bond Position:  [-30.05169509]


portfolio before change:  [-9.56694669]
curr_Stock_Price:  98.85958696481465
curr_Factors:  [98.85958696]
mat_Sqrt:  [[0.15]]
grads:  [-0.11794285]
Stock Position:  -0.11794285255929507
Bond Position:  [2.092835]


portfolio before change:  [-9.64009943]
curr_Stock_Price:  99.48204407300268
curr_Factors:  [99.48204407]
mat_Sqrt:  [[0.15]]
grads:  [-0.04560065]
Stock Position:  -0.045600651596842845
Bond Position:  [-5.1036534]


portfolio before change:  [-9.65179748]
curr_Stock_Price:  99.7245855648115
curr_Factors:  [99.72458556]
mat_Sqrt:  [[0.15]]
grads:  [-0.04934629]
Stock Position:  -0.04934628741628645
Bond Position:  [-4.73075942]


portfolio before change:  [-9.6436343]
curr_Stock_Price:  99.54717488157178
curr_Factors:  [99.54717488]
mat_Sqrt:  [[0.15]]
grads:  [0.18575052]
Stock Position:  0.18575051903529946
Bond Position:  [-28.13457371]


portfolio before change:  [-9.66078583]
curr_Stock_Price:  99.47377275930593
curr_Factors:  [99.47377276]
mat_Sqrt:  [[0.15]]
grads:  [0.02375092]
Stock Position:  0.023750923224716787
Bond Position:  [-12.02337977]


portfolio before change:  [-9.6702457]
curr_Stock_Price:  99.13876041091271
curr_Factors:  [99.13876041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00842376]
Stock Position:  -0.008423755262685682
Bond Position:  [-8.83512504]


portfolio before change:  [-9.68168443]
curr_Stock_Price:  100.36556204962886
curr_Factors:  [100.36556205]
mat_Sqrt:  [[0.15]]
grads:  [-0.16803167]
Stock Position:  -0.1680316699269326
Bond Position:  [7.18290856]


portfolio before change:  [-9.66195229]
curr_Stock_Price:  100.25347471387104
curr_Factors:  [100.25347471]
mat_Sqrt:  [[0.15]]
grads:  [0.15590136]
Stock Position:  0.155901363210024
Bond Position:  [-25.29160566]


portfolio before change:  [-9.67111802]
curr_Stock_Price:  100.2149626314741
curr_Factors:  [100.21496263]
mat_Sqrt:  [[0.15]]
grads:  [0.12783753]
Stock Position:  0.12783752519988428
Bond Position:  [-22.48235084]


portfolio before change:  [-9.71212686]
curr_Stock_Price:  99.91615858627951
curr_Factors:  [99.91615859]
mat_Sqrt:  [[0.15]]
grads:  [-0.09671898]
Stock Position:  -0.0967189799209755
Bond Position:  [-0.04833793]


portfolio before change:  [-9.65384105]
curr_Stock_Price:  99.31346559114118
curr_Factors:  [99.31346559]
mat_Sqrt:  [[0.15]]
grads:  [0.09694018]
Stock Position:  0.09694018148974246
Bond Position:  [-19.28130643]


portfolio before change:  [-9.62687985]
curr_Stock_Price:  99.61645156558764
curr_Factors:  [99.61645157]
mat_Sqrt:  [[0.15]]
grads:  [0.04327951]
Stock Position:  0.04327951123501722
Bond Position:  [-13.93823119]


portfolio before change:  [-9.58835392]
curr_Stock_Price:  100.546876130226
curr_Factors:  [100.54687613]
mat_Sqrt:  [[0.15]]
grads:  [0.05594929]
Stock Position:  0.055949289343259795
Bond Position:  [-15.21388019]


portfolio before change:  [-9.64159891]
curr_Stock_Price:  99.62920349384001
curr_Factors:  [99.62920349]
mat_Sqrt:  [[0.15]]
grads:  [-0.01484277]
Stock Position:  -0.014842767859856802
Bond Position:  [-8.16282577]


portfolio before change:  [-9.6377947]
curr_Stock_Price:  99.30415442864378
curr_Factors:  [99.30415443]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069739]
Stock Position:  -0.040697390170952634
Bond Position:  [-5.59637478]


portfolio before change:  [-9.60327916]
curr_Stock_Price:  98.43886235558764
curr_Factors:  [98.43886236]
mat_Sqrt:  [[0.15]]
grads:  [0.02175288]
Stock Position:  0.021752875279885953
Bond Position:  [-11.74460745]


portfolio before change:  [-9.61370593]
curr_Stock_Price:  98.02702676387221
curr_Factors:  [98.02702676]
mat_Sqrt:  [[0.15]]
grads:  [0.02627304]
Stock Position:  0.026273044926220235
Bond Position:  [-12.18917441]


portfolio before change:  [-9.60196885]
curr_Stock_Price:  98.5317580662669
curr_Factors:  [98.53175807]
mat_Sqrt:  [[0.15]]
grads:  [-0.19169136]
Stock Position:  -0.19169136490893637
Bond Position:  [9.28571834]


portfolio before change:  [-9.71712445]
curr_Stock_Price:  99.13854798540552
curr_Factors:  [99.13854799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01843554]
Stock Position:  -0.018435535308430926
Bond Position:  [-7.88945225]


portfolio before change:  [-9.71496789]
curr_Stock_Price:  98.96807294123045
curr_Factors:  [98.96807294]
mat_Sqrt:  [[0.15]]
grads:  [-0.06406351]
Stock Position:  -0.06406350954083824
Bond Position:  [-3.37472581]


portfolio before change:  [-9.73455013]
curr_Stock_Price:  99.2671569129558
curr_Factors:  [99.26715691]
mat_Sqrt:  [[0.15]]
grads:  [0.04696409]
Stock Position:  0.04696408895776258
Bond Position:  [-14.39654172]


portfolio before change:  [-9.69910865]
curr_Stock_Price:  100.06012788948765
curr_Factors:  [100.06012789]
mat_Sqrt:  [[0.15]]
grads:  [-0.05427183]
Stock Position:  -0.054271826591189495
Bond Position:  [-4.26866274]


portfolio before change:  [-9.68776745]
curr_Stock_Price:  99.84132535914239
curr_Factors:  [99.84132536]
mat_Sqrt:  [[0.15]]
grads:  [0.09348986]
Stock Position:  0.09348986328939396
Bond Position:  [-19.02191931]


portfolio before change:  [-9.65834443]
curr_Stock_Price:  100.1814789111881
curr_Factors:  [100.18147891]
mat_Sqrt:  [[0.15]]
grads:  [0.05322726]
Stock Position:  0.05322725680974746
Bond Position:  [-14.99072974]


portfolio before change:  [-9.67807083]
curr_Stock_Price:  99.84607861568145
curr_Factors:  [99.84607862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04259831]
Stock Position:  -0.04259830724753472
Bond Position:  [-5.42479689]


portfolio before change:  [-9.68411076]
curr_Stock_Price:  99.97194731903053
curr_Factors:  [99.97194732]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286181]
Stock Position:  -0.01286181081946541
Bond Position:  [-8.39829049]


portfolio before change:  [-9.694222]
curr_Stock_Price:  100.67646620989531
curr_Factors:  [100.67646621]
mat_Sqrt:  [[0.15]]
grads:  [0.00466206]
Stock Position:  0.004662057673893856
Bond Position:  [-10.1635815]


portfolio before change:  [-9.69743423]
curr_Stock_Price:  100.25997652966018
curr_Factors:  [100.25997653]
mat_Sqrt:  [[0.15]]
grads:  [-0.05938927]
Stock Position:  -0.059389272515869146
Bond Position:  [-3.74306716]


portfolio before change:  [-9.7060468]
curr_Stock_Price:  100.39711678579022
curr_Factors:  [100.39711679]
mat_Sqrt:  [[0.15]]
grads:  [-0.16390642]
Stock Position:  -0.16390642356777346
Bond Position:  [6.74968555]


portfolio before change:  [-9.57198926]
curr_Stock_Price:  99.58437392362495
curr_Factors:  [99.58437392]
mat_Sqrt:  [[0.15]]
grads:  [0.10013995]
Stock Position:  0.10013995074188244
Bond Position:  [-19.54436356]


portfolio before change:  [-9.66396111]
curr_Stock_Price:  98.69033864565677
curr_Factors:  [98.69033865]
mat_Sqrt:  [[0.15]]
grads:  [-0.06679976]
Stock Position:  -0.0667997579329491
Bond Position:  [-3.07147038]


portfolio before change:  [-9.6553926]
curr_Stock_Price:  98.55631925926137
curr_Factors:  [98.55631926]
mat_Sqrt:  [[0.15]]
grads:  [-0.27966212]
Stock Position:  -0.2796621205908482
Bond Position:  [17.90707664]


portfolio before change:  [-9.82918288]
curr_Stock_Price:  99.18575308775624
curr_Factors:  [99.18575309]
mat_Sqrt:  [[0.15]]
grads:  [-0.14562471]
Stock Position:  -0.1456247075895055
Bond Position:  [4.61471341]


portfolio before change:  [-9.7108313]
curr_Stock_Price:  98.37699811490782
curr_Factors:  [98.37699811]
mat_Sqrt:  [[0.15]]
grads:  [0.26093795]
Stock Position:  0.2609379499162176
Bond Position:  [-35.38112351]


portfolio before change:  [-9.74167845]
curr_Stock_Price:  98.27573174383377
curr_Factors:  [98.27573174]
mat_Sqrt:  [[0.15]]
grads:  [0.01826321]
Stock Position:  0.018263209919689386
Bond Position:  [-11.53650877]


portfolio before change:  [-9.74172565]
curr_Stock_Price:  98.35211252397853
curr_Factors:  [98.35211252]
mat_Sqrt:  [[0.15]]
grads:  [0.04707692]
Stock Position:  0.047076916949681386
Bond Position:  [-14.37183988]


portfolio before change:  [-9.68416842]
curr_Stock_Price:  99.61289649220014
curr_Factors:  [99.61289649]
mat_Sqrt:  [[0.15]]
grads:  [0.03583934]
Stock Position:  0.03583934226202406
Bond Position:  [-13.25422911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.70548546]
Stock Price:  99.06433279399918
PL:  [-9.70548546]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.67207578e-03]
 [ 3.61548995e-02]
 [-1.66371918e-02]
 [-7.42039008e-03]
 [-5.76435713e-03]
 [ 4.23516607e-02]
 [ 3.66803067e-03]
 [ 4.71676060e-03]
 [-2.40805290e-02]
 [ 2.30696608e-02]
 [ 1.96918026e-02]
 [-9.96538488e-03]
 [ 1.80505749e-02]
 [ 2.31208787e-02]
 [-1.12553945e-02]
 [-3.66037154e-03]
 [-4.92426796e-03]
 [ 6.97077268e-03]
 [ 1.23648356e-02]
 [ 1.76621629e-02]
 [ 8.45903335e-04]
 [-7.03093189e-03]
 [ 5.61844414e-03]
 [-9.74788017e-03]
 [-7.25282740e-04]
 [ 3.20610413e-03]
 [ 8.89482875e-04]
 [ 5.89518012e-04]
 [ 1.69353939e-03]
 [-9.23026180e-03]
 [-2.79472594e-02]
 [ 1.74947316e-02]
 [-4.97703493e-03]
 [-2.07199479e-02]
 [-2.16078735e-02]
 [ 2.95240695e-02]
 [ 3.15379020e-03]
 [ 8.67524541e-03]
 [ 5.25478374e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.19150721]
curr_Stock_Price:  99.63207707515902
curr_Factors:  [99.63207708]
mat_Sqrt:  [[0.15]]
grads:  [-0.03781384]
Stock Position:  -0.03781383854035121
Bond Position:  [-2.42403594]


portfolio before change:  [-6.19599905]
curr_Stock_Price:  99.74285165312962
curr_Factors:  [99.74285165]
mat_Sqrt:  [[0.15]]
grads:  [0.24103266]
Stock Position:  0.24103266331990475
Bond Position:  [-30.23728423]


portfolio before change:  [-6.48312772]
curr_Stock_Price:  98.56728992869552
curr_Factors:  [98.56728993]
mat_Sqrt:  [[0.15]]
grads:  [-0.11091461]
Stock Position:  -0.11091461201170272
Bond Position:  [4.449425]


portfolio before change:  [-6.48465694]
curr_Stock_Price:  98.58609205010241
curr_Factors:  [98.58609205]
mat_Sqrt:  [[0.15]]
grads:  [-0.04946927]
Stock Position:  -0.04946926720422697
Bond Position:  [-1.60767521]


portfolio before change:  [-6.46918852]
curr_Stock_Price:  98.26934205743564
curr_Factors:  [98.26934206]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842905]
Stock Position:  -0.03842904752127078
Bond Position:  [-2.6927913]


portfolio before change:  [-6.46067492]
curr_Stock_Price:  98.03904183140219
curr_Factors:  [98.03904183]
mat_Sqrt:  [[0.15]]
grads:  [0.2823444]
Stock Position:  0.2823444043663594
Bond Position:  [-34.14144979]


portfolio before change:  [-5.8892729]
curr_Stock_Price:  100.07793462256032
curr_Factors:  [100.07793462]
mat_Sqrt:  [[0.15]]
grads:  [0.02445354]
Stock Position:  0.02445353779884848
Bond Position:  [-8.33653245]


portfolio before change:  [-5.87988321]
curr_Stock_Price:  100.50453222289494
curr_Factors:  [100.50453222]
mat_Sqrt:  [[0.15]]
grads:  [0.03144507]
Stock Position:  0.0314450706928333
Bond Position:  [-9.04025533]


portfolio before change:  [-5.8808187]
curr_Stock_Price:  100.51072126373404
curr_Factors:  [100.51072126]
mat_Sqrt:  [[0.15]]
grads:  [-0.16053686]
Stock Position:  -0.16053685973533707
Bond Position:  [10.25485687]


portfolio before change:  [-6.01462933]
curr_Stock_Price:  101.35222624898573
curr_Factors:  [101.35222625]
mat_Sqrt:  [[0.15]]
grads:  [0.15379774]
Stock Position:  0.15379773898468146
Bond Position:  [-21.60237256]


portfolio before change:  [-5.9429649]
curr_Stock_Price:  101.83575023725537
curr_Factors:  [101.83575024]
mat_Sqrt:  [[0.15]]
grads:  [0.13127868]
Stock Position:  0.13127868390460204
Bond Position:  [-19.31182816]


portfolio before change:  [-5.95168103]
curr_Stock_Price:  101.7877454539691
curr_Factors:  [101.78774545]
mat_Sqrt:  [[0.15]]
grads:  [-0.0664359]
Stock Position:  -0.06643589918284361
Bond Position:  [0.81067937]


portfolio before change:  [-5.94927667]
curr_Stock_Price:  101.75308020092898
curr_Factors:  [101.7530802]
mat_Sqrt:  [[0.15]]
grads:  [0.12033717]
Stock Position:  0.12033716583741097
Bond Position:  [-18.19395396]


portfolio before change:  [-5.88352837]
curr_Stock_Price:  102.31834768084838
curr_Factors:  [102.31834768]
mat_Sqrt:  [[0.15]]
grads:  [0.15413919]
Stock Position:  0.1541391910619954
Bond Position:  [-21.65479571]


portfolio before change:  [-5.81180497]
curr_Stock_Price:  102.80122562441869
curr_Factors:  [102.80122562]
mat_Sqrt:  [[0.15]]
grads:  [-0.07503596]
Stock Position:  -0.07503596350504092
Bond Position:  [1.90198404]


portfolio before change:  [-5.89994979]
curr_Stock_Price:  103.97909522392256
curr_Factors:  [103.97909522]
mat_Sqrt:  [[0.15]]
grads:  [-0.02440248]
Stock Position:  -0.024402476951173518
Bond Position:  [-3.36260232]


portfolio before change:  [-5.89354457]
curr_Stock_Price:  103.69938691119395
curr_Factors:  [103.69938691]
mat_Sqrt:  [[0.15]]
grads:  [-0.03282845]
Stock Position:  -0.03282845306217774
Bond Position:  [-2.48925411]


portfolio before change:  [-5.83356658]
curr_Stock_Price:  101.86289581033094
curr_Factors:  [101.86289581]
mat_Sqrt:  [[0.15]]
grads:  [0.04647182]
Stock Position:  0.046471817835921185
Bond Position:  [-10.56732052]


portfolio before change:  [-5.83454345]
curr_Stock_Price:  101.8703009114484
curr_Factors:  [101.87030091]
mat_Sqrt:  [[0.15]]
grads:  [0.08243224]
Stock Position:  0.08243223750943272
Bond Position:  [-14.23194029]


portfolio before change:  [-5.80178556]
curr_Stock_Price:  102.28927525592796
curr_Factors:  [102.28927526]
mat_Sqrt:  [[0.15]]
grads:  [0.11774775]
Stock Position:  0.11774775236776862
Bond Position:  [-17.84611781]


portfolio before change:  [-5.61456525]
curr_Stock_Price:  103.89823350813845
curr_Factors:  [103.89823351]
mat_Sqrt:  [[0.15]]
grads:  [0.00563936]
Stock Position:  0.00563935556721281
Bond Position:  [-6.20048433]


portfolio before change:  [-5.61411574]
curr_Stock_Price:  104.11538961397298
curr_Factors:  [104.11538961]
mat_Sqrt:  [[0.15]]
grads:  [-0.04687288]
Stock Position:  -0.04687287923868633
Bond Position:  [-0.73392765]


portfolio before change:  [-5.62781583]
curr_Stock_Price:  104.40571424111097
curr_Factors:  [104.40571424]
mat_Sqrt:  [[0.15]]
grads:  [0.03745629]
Stock Position:  0.03745629428264847
Bond Position:  [-9.53846699]


portfolio before change:  [-5.63053198]
curr_Stock_Price:  104.36503316569143
curr_Factors:  [104.36503317]
mat_Sqrt:  [[0.15]]
grads:  [-0.06498587]
Stock Position:  -0.06498586777248623
Bond Position:  [1.15172027]


portfolio before change:  [-5.55932227]
curr_Stock_Price:  103.27147638237241
curr_Factors:  [103.27147638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483522]
Stock Position:  -0.004835218266093968
Bond Position:  [-5.05998214]


portfolio before change:  [-5.55340015]
curr_Stock_Price:  101.91587005129053
curr_Factors:  [101.91587005]
mat_Sqrt:  [[0.15]]
grads:  [0.02137403]
Stock Position:  0.021374027550129307
Bond Position:  [-7.73175277]


portfolio before change:  [-5.52874991]
curr_Stock_Price:  103.1143700491976
curr_Factors:  [103.11437005]
mat_Sqrt:  [[0.15]]
grads:  [0.00592989]
Stock Position:  0.00592988583663161
Bond Position:  [-6.14020635]


portfolio before change:  [-5.53368547]
curr_Stock_Price:  102.41149169846021
curr_Factors:  [102.4114917]
mat_Sqrt:  [[0.15]]
grads:  [0.00393012]
Stock Position:  0.0039301200795935996
Bond Position:  [-5.93617493]


portfolio before change:  [-5.53789247]
curr_Stock_Price:  101.52985885081989
curr_Factors:  [101.52985885]
mat_Sqrt:  [[0.15]]
grads:  [0.01129026]
Stock Position:  0.011290262604525227
Bond Position:  [-6.68419123]


portfolio before change:  [-5.55433508]
curr_Stock_Price:  100.14751358059479
curr_Factors:  [100.14751358]
mat_Sqrt:  [[0.15]]
grads:  [-0.06153508]
Stock Position:  -0.06153507869496989
Bond Position:  [0.60825005]


portfolio before change:  [-5.58176645]
curr_Stock_Price:  100.59453349004112
curr_Factors:  [100.59453349]
mat_Sqrt:  [[0.15]]
grads:  [-0.18631506]
Stock Position:  -0.18631506249696686
Bond Position:  [13.16051034]


portfolio before change:  [-5.7292884]
curr_Stock_Price:  101.39515106532615
curr_Factors:  [101.39515107]
mat_Sqrt:  [[0.15]]
grads:  [0.11663154]
Stock Position:  0.11663154372977039
Bond Position:  [-17.55516139]


portfolio before change:  [-5.81042744]
curr_Stock_Price:  100.71828004244227
curr_Factors:  [100.71828004]
mat_Sqrt:  [[0.15]]
grads:  [-0.03318023]
Stock Position:  -0.03318023287520616
Bond Position:  [-2.46857146]


portfolio before change:  [-5.79494669]
curr_Stock_Price:  100.24241408066779
curr_Factors:  [100.24241408]
mat_Sqrt:  [[0.15]]
grads:  [-0.13813299]
Stock Position:  -0.1381329863223806
Bond Position:  [8.05183732]


portfolio before change:  [-5.73396201]
curr_Stock_Price:  99.80820832007194
curr_Factors:  [99.80820832]
mat_Sqrt:  [[0.15]]
grads:  [-0.14405249]
Stock Position:  -0.14405249029136158
Bond Position:  [8.64365895]


portfolio before change:  [-5.74781557]
curr_Stock_Price:  99.91187942423498
curr_Factors:  [99.91187942]
mat_Sqrt:  [[0.15]]
grads:  [0.19682713]
Stock Position:  0.19682713007654515
Bond Position:  [-25.41318405]


portfolio before change:  [-5.85224333]
curr_Stock_Price:  99.3974639704423
curr_Factors:  [99.39746397]
mat_Sqrt:  [[0.15]]
grads:  [0.02102527]
Stock Position:  0.021025268006095433
Bond Position:  [-7.94210165]


portfolio before change:  [-5.84536739]
curr_Stock_Price:  99.77171655643606
curr_Factors:  [99.77171656]
mat_Sqrt:  [[0.15]]
grads:  [0.05783497]
Stock Position:  0.05783496937596863
Bond Position:  [-11.61566156]


portfolio before change:  [-5.8603812]
curr_Stock_Price:  99.53722596369936
curr_Factors:  [99.53722596]
mat_Sqrt:  [[0.15]]
grads:  [0.03503189]
Stock Position:  0.03503189163119806
Bond Position:  [-9.34735851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.89257308]
Stock Price:  98.65165023419388
PL:  [-5.89257308]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.17222505e-02]
 [ 4.03006971e-02]
 [-2.61346606e-03]
 [-2.01555766e-03]
 [-3.91158435e-03]
 [ 3.29742173e-02]
 [ 3.54455892e-03]
 [-2.30560612e-04]
 [-2.38129889e-02]
 [ 2.30103328e-02]
 [ 1.76233473e-02]
 [-9.84453489e-04]
 [ 1.08038013e-02]
 [ 2.28614486e-02]
 [ 7.57200484e-03]
 [-3.65474799e-03]
 [-5.46368473e-03]
 [ 7.70528968e-03]
 [ 1.73317288e-02]
 [ 1.66944533e-02]
 [-9.79105528e-04]
 [-4.74307847e-03]
 [ 4.11118891e-03]
 [-1.14021223e-02]
 [-4.79393809e-03]
 [ 4.53281048e-03]
 [ 1.52230829e-04]
 [ 6.41629348e-04]
 [ 3.36023808e-03]
 [-6.57650234e-03]
 [-2.05239956e-02]
 [ 1.43558451e-02]
 [-3.38192580e-03]
 [-2.06347845e-02]
 [-2.06052516e-02]
 [ 2.39992901e-02]
 [ 2.48135599e-03]
 [ 1.98303569e-02]
 [ 1.02277725e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.57556597]
curr_Stock_Price:  100.12247474425419
curr_Factors:  [100.12247474]
mat_Sqrt:  [[0.15]]
grads:  [0.144815]
Stock Position:  0.1448150036529989
Bond Position:  [-9.92367058]


portfolio before change:  [4.54724736]
curr_Stock_Price:  99.93549082914399
curr_Factors:  [99.93549083]
mat_Sqrt:  [[0.15]]
grads:  [0.26867131]
Stock Position:  0.26867131429889746
Bond Position:  [-22.30255231]


portfolio before change:  [4.62059765]
curr_Stock_Price:  100.21887905632144
curr_Factors:  [100.21887906]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742311]
Stock Position:  -0.01742310707223506
Bond Position:  [6.36672191]


portfolio before change:  [4.59934366]
curr_Stock_Price:  101.48443279044137
curr_Factors:  [101.48443279]
mat_Sqrt:  [[0.15]]
grads:  [-0.01343705]
Stock Position:  -0.013437051047182264
Bond Position:  [5.96299517]


portfolio before change:  [4.60764639]
curr_Stock_Price:  100.92200997045589
curr_Factors:  [100.92200997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02607723]
Stock Position:  -0.02607722902793533
Bond Position:  [7.23941275]


portfolio before change:  [4.61578894]
curr_Stock_Price:  100.64446609174392
curr_Factors:  [100.64446609]
mat_Sqrt:  [[0.15]]
grads:  [0.21982812]
Stock Position:  0.21982811511493683
Bond Position:  [-17.50869433]


portfolio before change:  [4.29242793]
curr_Stock_Price:  99.18345056230304
curr_Factors:  [99.18345056]
mat_Sqrt:  [[0.15]]
grads:  [0.02363039]
Stock Position:  0.02363039277019098
Bond Position:  [1.94868404]


portfolio before change:  [4.3054505]
curr_Stock_Price:  99.72423588238975
curr_Factors:  [99.72423588]
mat_Sqrt:  [[0.15]]
grads:  [-0.00153707]
Stock Position:  -0.0015370707444218364
Bond Position:  [4.45873371]


portfolio before change:  [4.30476048]
curr_Stock_Price:  100.53577959288457
curr_Factors:  [100.53577959]
mat_Sqrt:  [[0.15]]
grads:  [-0.15875326]
Stock Position:  -0.158753259655206
Bond Position:  [20.2651432]


portfolio before change:  [4.13617327]
curr_Stock_Price:  101.61368193890938
curr_Factors:  [101.61368194]
mat_Sqrt:  [[0.15]]
grads:  [0.15340222]
Stock Position:  0.15340221857690103
Bond Position:  [-11.45159098]


portfolio before change:  [4.30936545]
curr_Stock_Price:  102.75202091460802
curr_Factors:  [102.75202091]
mat_Sqrt:  [[0.15]]
grads:  [0.11748898]
Stock Position:  0.1174889818403951
Bond Position:  [-7.76286486]


portfolio before change:  [4.37508282]
curr_Stock_Price:  103.31962975324508
curr_Factors:  [103.31962975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00656302]
Stock Position:  -0.006563023257178148
Bond Position:  [5.05317195]


portfolio before change:  [4.38035901]
curr_Stock_Price:  102.61195164036829
curr_Factors:  [102.61195164]
mat_Sqrt:  [[0.15]]
grads:  [0.07202534]
Stock Position:  0.07202534200035395
Bond Position:  [-3.0103019]


portfolio before change:  [4.35316001]
curr_Stock_Price:  102.23954537491878
curr_Factors:  [102.23954537]
mat_Sqrt:  [[0.15]]
grads:  [0.15240966]
Stock Position:  0.1524096570622527
Bond Position:  [-11.22913403]


portfolio before change:  [4.10548293]
curr_Stock_Price:  100.6236808728004
curr_Factors:  [100.62368087]
mat_Sqrt:  [[0.15]]
grads:  [0.05048003]
Stock Position:  0.05048003229189173
Bond Position:  [-0.97400373]


portfolio before change:  [4.13968598]
curr_Stock_Price:  101.30364889382713
curr_Factors:  [101.30364889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02436499]
Stock Position:  -0.02436498659291259
Bond Position:  [6.60794803]


portfolio before change:  [4.1148163]
curr_Stock_Price:  102.35826561085614
curr_Factors:  [102.35826561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03642456]
Stock Position:  -0.036424564867464725
Bond Position:  [7.84317159]


portfolio before change:  [4.07604292]
curr_Stock_Price:  103.44966765411077
curr_Factors:  [103.44966765]
mat_Sqrt:  [[0.15]]
grads:  [0.0513686]
Stock Position:  0.05136859785434726
Bond Position:  [-1.23802146]


portfolio before change:  [4.05651232]
curr_Stock_Price:  103.07247554069947
curr_Factors:  [103.07247554]
mat_Sqrt:  [[0.15]]
grads:  [0.11554486]
Stock Position:  0.115544858735798
Bond Position:  [-7.8529823]


portfolio before change:  [4.00897484]
curr_Stock_Price:  102.66955156056855
curr_Factors:  [102.66955156]
mat_Sqrt:  [[0.15]]
grads:  [0.11129636]
Stock Position:  0.11129635517217507
Bond Position:  [-7.41777203]


portfolio before change:  [4.00282793]
curr_Stock_Price:  102.6226530083511
curr_Factors:  [102.62265301]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652737]
Stock Position:  -0.0065273701893868875
Bond Position:  [4.67268397]


portfolio before change:  [3.99715514]
curr_Stock_Price:  103.5812187775972
curr_Factors:  [103.58121878]
mat_Sqrt:  [[0.15]]
grads:  [-0.03162052]
Stock Position:  -0.031620523128705245
Bond Position:  [7.27244746]


portfolio before change:  [4.04300195]
curr_Stock_Price:  102.16006257113176
curr_Factors:  [102.16006257]
mat_Sqrt:  [[0.15]]
grads:  [0.02740793]
Stock Position:  0.02740792606246327
Bond Position:  [1.24300651]


portfolio before change:  [4.07452571]
curr_Stock_Price:  103.30456272474072
curr_Factors:  [103.30456272]
mat_Sqrt:  [[0.15]]
grads:  [-0.07601415]
Stock Position:  -0.07601414865965458
Bond Position:  [11.9271341]


portfolio before change:  [3.97434821]
curr_Stock_Price:  104.64205702327398
curr_Factors:  [104.64205702]
mat_Sqrt:  [[0.15]]
grads:  [-0.03195959]
Stock Position:  -0.03195958724679887
Bond Position:  [7.31866516]


portfolio before change:  [3.99820316]
curr_Stock_Price:  103.92427343062697
curr_Factors:  [103.92427343]
mat_Sqrt:  [[0.15]]
grads:  [0.03021874]
Stock Position:  0.030218736541904545
Bond Position:  [0.85774293]


portfolio before change:  [3.96869144]
curr_Stock_Price:  102.94412150715108
curr_Factors:  [102.94412151]
mat_Sqrt:  [[0.15]]
grads:  [0.00101487]
Stock Position:  0.0010148721933185788
Bond Position:  [3.86421631]


portfolio before change:  [3.96868274]
curr_Stock_Price:  102.459574546466
curr_Factors:  [102.45957455]
mat_Sqrt:  [[0.15]]
grads:  [0.00427753]
Stock Position:  0.004277528989137294
Bond Position:  [3.53040894]


portfolio before change:  [3.96966755]
curr_Stock_Price:  102.58662933439176
curr_Factors:  [102.58662933]
mat_Sqrt:  [[0.15]]
grads:  [0.02240159]
Stock Position:  0.022401587226616462
Bond Position:  [1.67156422]


portfolio before change:  [3.94106508]
curr_Stock_Price:  101.30049615275625
curr_Factors:  [101.30049615]
mat_Sqrt:  [[0.15]]
grads:  [-0.04384335]
Stock Position:  -0.04384334895035231
Bond Position:  [8.38241809]


portfolio before change:  [3.91681758]
curr_Stock_Price:  101.87744501240373
curr_Factors:  [101.87744501]
mat_Sqrt:  [[0.15]]
grads:  [-0.13682664]
Stock Position:  -0.13682663725078217
Bond Position:  [17.85636579]


portfolio before change:  [3.89060662]
curr_Stock_Price:  102.0853222591597
curr_Factors:  [102.08532226]
mat_Sqrt:  [[0.15]]
grads:  [0.09570563]
Stock Position:  0.09570563401334614
Bond Position:  [-5.87953387]


portfolio before change:  [3.83379022]
curr_Stock_Price:  101.49934412140416
curr_Factors:  [101.49934412]
mat_Sqrt:  [[0.15]]
grads:  [-0.02254617]
Stock Position:  -0.022546172014377853
Bond Position:  [6.1222119]


portfolio before change:  [3.81689245]
curr_Stock_Price:  102.28276318837146
curr_Factors:  [102.28276319]
mat_Sqrt:  [[0.15]]
grads:  [-0.13756523]
Stock Position:  -0.1375652300416334
Bond Position:  [17.8874443]


portfolio before change:  [3.90936906]
curr_Stock_Price:  101.62677956917912
curr_Factors:  [101.62677957]
mat_Sqrt:  [[0.15]]
grads:  [-0.13736834]
Stock Position:  -0.1373683437306789
Bond Position:  [17.86967144]


portfolio before change:  [3.88681545]
curr_Stock_Price:  101.80722474147613
curr_Factors:  [101.80722474]
mat_Sqrt:  [[0.15]]
grads:  [0.15999527]
Stock Position:  0.15999526725579674
Bond Position:  [-12.40185868]


portfolio before change:  [4.03338093]
curr_Stock_Price:  102.73297594290607
curr_Factors:  [102.73297594]
mat_Sqrt:  [[0.15]]
grads:  [0.01654237]
Stock Position:  0.01654237326014232
Bond Position:  [2.3339337]


portfolio before change:  [4.03543685]
curr_Stock_Price:  102.83962060376798
curr_Factors:  [102.8396206]
mat_Sqrt:  [[0.15]]
grads:  [0.13220238]
Stock Position:  0.1322023791926262
Bond Position:  [-9.56020567]


portfolio before change:  [4.05255341]
curr_Stock_Price:  102.9781329828408
curr_Factors:  [102.97813298]
mat_Sqrt:  [[0.15]]
grads:  [0.06818515]
Stock Position:  0.06818515006219913
Bond Position:  [-2.96902604]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.06477933]
Stock Price:  103.16288089459177
PL:  [0.90189843]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.18528728e-02]
 [ 2.81026906e-02]
 [-3.49212801e-03]
 [-3.17835797e-03]
 [-7.72810886e-03]
 [ 3.18129131e-02]
 [ 3.57957371e-03]
 [-1.42750936e-03]
 [-2.76980758e-02]
 [ 2.34056950e-02]
 [ 1.94406999e-02]
 [-1.44674063e-02]
 [ 1.93457292e-02]
 [ 6.55908707e-03]
 [-5.88360978e-03]
 [-3.46832533e-03]
 [-6.07923131e-03]
 [ 6.47540828e-03]
 [ 6.22793074e-03]
 [-5.73384879e-04]
 [-4.82783788e-03]
 [-4.73365602e-03]
 [ 4.43119757e-03]
 [-1.08474870e-02]
 [ 7.36396621e-04]
 [ 2.94881609e-03]
 [ 4.06333256e-03]
 [ 1.47700746e-03]
 [ 4.85419858e-03]
 [-5.02581433e-03]
 [-1.58160776e-02]
 [ 4.17382443e-03]
 [ 7.71579675e-03]
 [ 2.86537446e-02]
 [-2.02949507e-02]
 [ 2.18305119e-02]
 [ 3.57474751e-03]
 [ 1.32435484e-02]
 [ 9.59360336e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.96593471]
curr_Stock_Price:  101.27890578539385
curr_Factors:  [101.27890579]
mat_Sqrt:  [[0.15]]
grads:  [-0.34568582]
Stock Position:  -0.34568581848014673
Bond Position:  [64.97661615]


portfolio before change:  [30.13746364]
curr_Stock_Price:  100.80620388792163
curr_Factors:  [100.80620389]
mat_Sqrt:  [[0.15]]
grads:  [0.18735127]
Stock Position:  0.18735127097036855
Bond Position:  [11.25129322]


portfolio before change:  [30.13741017]
curr_Stock_Price:  100.79841120162061
curr_Factors:  [100.7984112]
mat_Sqrt:  [[0.15]]
grads:  [-0.02328085]
Stock Position:  -0.023280853396329453
Bond Position:  [32.4840832]


portfolio before change:  [30.14997244]
curr_Stock_Price:  100.43323975037114
curr_Factors:  [100.43323975]
mat_Sqrt:  [[0.15]]
grads:  [-0.02118905]
Stock Position:  -0.021189053137960143
Bond Position:  [32.27805769]


portfolio before change:  [30.15794932]
curr_Stock_Price:  100.24720599339605
curr_Factors:  [100.24720599]
mat_Sqrt:  [[0.15]]
grads:  [-0.05152073]
Stock Position:  -0.05152072575586206
Bond Position:  [35.32275813]


portfolio before change:  [30.12170558]
curr_Stock_Price:  101.03639071167423
curr_Factors:  [101.03639071]
mat_Sqrt:  [[0.15]]
grads:  [0.21208609]
Stock Position:  0.21208608717539884
Bond Position:  [8.69329281]


portfolio before change:  [29.81445971]
curr_Stock_Price:  99.58258202618241
curr_Factors:  [99.58258203]
mat_Sqrt:  [[0.15]]
grads:  [0.02386382]
Stock Position:  0.02386382476105602
Bond Position:  [27.43803842]


portfolio before change:  [29.81768556]
curr_Stock_Price:  99.57402836277808
curr_Factors:  [99.57402836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00951673]
Stock Position:  -0.009516729049851983
Bond Position:  [30.7653046]


portfolio before change:  [29.82301234]
curr_Stock_Price:  99.4184198700956
curr_Factors:  [99.41841987]
mat_Sqrt:  [[0.15]]
grads:  [-0.18465384]
Stock Position:  -0.18465383836151078
Bond Position:  [48.18100518]


portfolio before change:  [29.84617826]
curr_Stock_Price:  99.32558175062718
curr_Factors:  [99.32558175]
mat_Sqrt:  [[0.15]]
grads:  [0.15603797]
Stock Position:  0.15603796683109233
Bond Position:  [14.34761643]


portfolio before change:  [29.90022797]
curr_Stock_Price:  99.66047556099777
curr_Factors:  [99.66047556]
mat_Sqrt:  [[0.15]]
grads:  [0.12960467]
Stock Position:  0.12960466598961978
Bond Position:  [16.98376533]


portfolio before change:  [29.83221564]
curr_Stock_Price:  99.11932654772156
curr_Factors:  [99.11932655]
mat_Sqrt:  [[0.15]]
grads:  [-0.09644938]
Stock Position:  -0.09644937545852322
Bond Position:  [39.39221278]


portfolio before change:  [29.76031046]
curr_Stock_Price:  99.91590524312917
curr_Factors:  [99.91590524]
mat_Sqrt:  [[0.15]]
grads:  [0.12897153]
Stock Position:  0.12897152789965266
Bond Position:  [16.8740035]


portfolio before change:  [29.75069004]
curr_Stock_Price:  99.8249564563032
curr_Factors:  [99.82495646]
mat_Sqrt:  [[0.15]]
grads:  [0.04372725]
Stock Position:  0.0437272471285122
Bond Position:  [25.38561949]


portfolio before change:  [29.75004638]
curr_Stock_Price:  99.73766399441554
curr_Factors:  [99.73766399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03922407]
Stock Position:  -0.039224065229969594
Bond Position:  [33.66216302]


portfolio before change:  [29.73047034]
curr_Stock_Price:  100.34402811493617
curr_Factors:  [100.34402811]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312217]
Stock Position:  -0.023122168862200716
Bond Position:  [32.05064191]


portfolio before change:  [29.73067951]
curr_Stock_Price:  100.50826080137793
curr_Factors:  [100.5082608]
mat_Sqrt:  [[0.15]]
grads:  [-0.04052821]
Stock Position:  -0.0405282087559059
Bond Position:  [33.80409928]


portfolio before change:  [29.70865661]
curr_Stock_Price:  101.15592515900448
curr_Factors:  [101.15592516]
mat_Sqrt:  [[0.15]]
grads:  [0.04316939]
Stock Position:  0.04316938851879149
Bond Position:  [25.34181718]


portfolio before change:  [29.66290318]
curr_Stock_Price:  100.02268341451241
curr_Factors:  [100.02268341]
mat_Sqrt:  [[0.15]]
grads:  [0.04151954]
Stock Position:  0.04151953826218664
Bond Position:  [25.51000755]


portfolio before change:  [29.67896322]
curr_Stock_Price:  100.33268411825672
curr_Factors:  [100.33268412]
mat_Sqrt:  [[0.15]]
grads:  [-0.00382257]
Stock Position:  -0.003822565861184545
Bond Position:  [30.06249151]


portfolio before change:  [29.68282856]
curr_Stock_Price:  100.30461461896995
curr_Factors:  [100.30461462]
mat_Sqrt:  [[0.15]]
grads:  [-0.03218559]
Stock Position:  -0.032185585870125544
Bond Position:  [32.91119135]


portfolio before change:  [29.66457012]
curr_Stock_Price:  100.99972702323524
curr_Factors:  [100.99972702]
mat_Sqrt:  [[0.15]]
grads:  [-0.03155771]
Stock Position:  -0.03155770678371025
Bond Position:  [32.85188989]


portfolio before change:  [29.64499029]
curr_Stock_Price:  101.75030652447575
curr_Factors:  [101.75030652]
mat_Sqrt:  [[0.15]]
grads:  [0.02954132]
Stock Position:  0.0295413171313991
Bond Position:  [26.63915222]


portfolio before change:  [29.62846324]
curr_Stock_Price:  101.07812399413457
curr_Factors:  [101.07812399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07231658]
Stock Position:  -0.0723165799539422
Bond Position:  [36.93808747]


portfolio before change:  [29.51463565]
curr_Stock_Price:  102.71599368487405
curr_Factors:  [102.71599368]
mat_Sqrt:  [[0.15]]
grads:  [0.00490931]
Stock Position:  0.004909310806793145
Bond Position:  [29.01037091]


portfolio before change:  [29.51560067]
curr_Stock_Price:  102.1738599966375
curr_Factors:  [102.17386]
mat_Sqrt:  [[0.15]]
grads:  [0.01965877]
Stock Position:  0.019658773922861555
Bond Position:  [27.50698786]


portfolio before change:  [29.55193675]
curr_Stock_Price:  103.84728531634941
curr_Factors:  [103.84728532]
mat_Sqrt:  [[0.15]]
grads:  [0.02708888]
Stock Position:  0.027088883700232803
Bond Position:  [26.73882972]


portfolio before change:  [29.54921263]
curr_Stock_Price:  103.62333059308453
curr_Factors:  [103.62333059]
mat_Sqrt:  [[0.15]]
grads:  [0.00984672]
Stock Position:  0.009846716395040112
Bond Position:  [28.52886308]


portfolio before change:  [29.55383179]
curr_Stock_Price:  103.73025213721216
curr_Factors:  [103.73025214]
mat_Sqrt:  [[0.15]]
grads:  [0.03236132]
Stock Position:  0.032361323885381515
Bond Position:  [26.1969835]


portfolio before change:  [29.57100722]
curr_Stock_Price:  104.15979603701753
curr_Factors:  [104.15979604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03350543]
Stock Position:  -0.033505428871761396
Bond Position:  [33.06092586]


portfolio before change:  [29.55690572]
curr_Stock_Price:  104.7040177331287
curr_Factors:  [104.70401773]
mat_Sqrt:  [[0.15]]
grads:  [-0.10544052]
Stock Position:  -0.10544051725966438
Bond Position:  [40.59695151]


portfolio before change:  [29.3868374]
curr_Stock_Price:  106.36507991798182
curr_Factors:  [106.36507992]
mat_Sqrt:  [[0.15]]
grads:  [0.0278255]
Stock Position:  0.027825496184144604
Bond Position:  [26.42717627]


portfolio before change:  [29.388817]
curr_Stock_Price:  106.31749761698802
curr_Factors:  [106.31749762]
mat_Sqrt:  [[0.15]]
grads:  [0.05143864]
Stock Position:  0.05143864497600001
Bond Position:  [23.91998898]


portfolio before change:  [29.34448056]
curr_Stock_Price:  105.39743780862693
curr_Factors:  [105.39743781]
mat_Sqrt:  [[0.15]]
grads:  [0.19102496]
Stock Position:  0.19102496389322612
Bond Position:  [9.2109388]


portfolio before change:  [28.96532819]
curr_Stock_Price:  103.40657863229004
curr_Factors:  [103.40657863]
mat_Sqrt:  [[0.15]]
grads:  [-0.13529967]
Stock Position:  -0.1352996710781713
Bond Position:  [42.95620427]


portfolio before change:  [29.11632017]
curr_Stock_Price:  102.33028543598772
curr_Factors:  [102.33028544]
mat_Sqrt:  [[0.15]]
grads:  [0.14553675]
Stock Position:  0.14553674608143882
Bond Position:  [14.2235034]


portfolio before change:  [29.11042262]
curr_Stock_Price:  102.2775455228737
curr_Factors:  [102.27754552]
mat_Sqrt:  [[0.15]]
grads:  [0.02383165]
Stock Position:  0.023831650051332483
Bond Position:  [26.67297995]


portfolio before change:  [29.09043805]
curr_Stock_Price:  101.2990608320504
curr_Factors:  [101.29906083]
mat_Sqrt:  [[0.15]]
grads:  [0.08829032]
Stock Position:  0.08829032291707405
Bond Position:  [20.14671126]


portfolio before change:  [29.18346343]
curr_Stock_Price:  102.32416615831002
curr_Factors:  [102.32416616]
mat_Sqrt:  [[0.15]]
grads:  [0.06395736]
Stock Position:  0.06395735570999919
Bond Position:  [22.63908033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.18028959]
Stock Price:  102.23029269772927
PL:  [26.94999689]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.59649148e-02]
 [-1.42258997e-03]
 [-1.57711819e-02]
 [-7.56393160e-03]
 [-6.26940636e-03]
 [ 4.06455960e-02]
 [ 3.53863938e-03]
 [ 7.25468478e-04]
 [ 3.47899342e-03]
 [ 2.34431731e-02]
 [ 2.02893954e-02]
 [-1.25172630e-02]
 [ 1.29068725e-02]
 [ 6.66494756e-03]
 [-1.66274333e-02]
 [ 4.63176135e-04]
 [-6.06671493e-03]
 [ 1.78560771e-03]
 [ 1.41690083e-03]
 [-2.94086510e-02]
 [-6.95008170e-03]
 [-1.53741577e-02]
 [ 6.35821101e-03]
 [-8.16368601e-03]
 [ 1.21843571e-02]
 [-1.45742314e-04]
 [ 2.60951284e-02]
 [-4.83827402e-03]
 [-3.41447953e-02]
 [-8.60205121e-03]
 [ 5.01202958e-02]
 [-1.24069703e-03]
 [-2.02948579e-02]
 [-3.30227401e-02]
 [-2.32451110e-02]
 [ 3.53574429e-02]
 [-3.99422360e-03]
 [-5.80226708e-03]
 [ 3.01442186e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.78967424]
curr_Stock_Price:  98.64836584863329
curr_Factors:  [98.64836585]
mat_Sqrt:  [[0.15]]
grads:  [0.17309943]
Stock Position:  0.1730994322475344
Bond Position:  [-44.86565036]


portfolio before change:  [-27.90013271]
curr_Stock_Price:  98.04264513147605
curr_Factors:  [98.04264513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00948393]
Stock Position:  -0.009483933127966323
Bond Position:  [-26.97030282]


portfolio before change:  [-27.9065351]
curr_Stock_Price:  98.3622272491915
curr_Factors:  [98.36222725]
mat_Sqrt:  [[0.15]]
grads:  [-0.10514121]
Stock Position:  -0.10514121257559038
Bond Position:  [-17.56461126]


portfolio before change:  [-27.91224817]
curr_Stock_Price:  98.39568090492172
curr_Factors:  [98.3956809]
mat_Sqrt:  [[0.15]]
grads:  [-0.05042621]
Stock Position:  -0.050426210695128905
Bond Position:  [-22.95052684]


portfolio before change:  [-27.93017768]
curr_Stock_Price:  98.69434522080185
curr_Factors:  [98.69434522]
mat_Sqrt:  [[0.15]]
grads:  [-0.04179604]
Stock Position:  -0.04179604243211594
Bond Position:  [-23.80514464]


portfolio before change:  [-27.91200915]
curr_Stock_Price:  98.18845142804692
curr_Factors:  [98.18845143]
mat_Sqrt:  [[0.15]]
grads:  [0.27097064]
Stock Position:  0.27097063980830327
Bond Position:  [-54.51819665]


portfolio before change:  [-28.25160549]
curr_Stock_Price:  96.96034368882027
curr_Factors:  [96.96034369]
mat_Sqrt:  [[0.15]]
grads:  [0.02359093]
Stock Position:  0.023590929208478415
Bond Position:  [-30.53899009]


portfolio before change:  [-28.2417968]
curr_Stock_Price:  97.53795138639806
curr_Factors:  [97.53795139]
mat_Sqrt:  [[0.15]]
grads:  [0.00483646]
Stock Position:  0.00483645652142334
Bond Position:  [-28.71353486]


portfolio before change:  [-28.24517465]
curr_Stock_Price:  97.58169539811584
curr_Factors:  [97.5816954]
mat_Sqrt:  [[0.15]]
grads:  [0.02319329]
Stock Position:  0.023193289481495707
Bond Position:  [-30.50841516]


portfolio before change:  [-28.24323453]
curr_Stock_Price:  97.82978049480113
curr_Factors:  [97.82978049]
mat_Sqrt:  [[0.15]]
grads:  [0.15628782]
Stock Position:  0.15628782095802252
Bond Position:  [-43.53283775]


portfolio before change:  [-28.07916016]
curr_Stock_Price:  98.91442239094475
curr_Factors:  [98.91442239]
mat_Sqrt:  [[0.15]]
grads:  [0.13526264]
Stock Position:  0.13526263615338927
Bond Position:  [-41.45858568]


portfolio before change:  [-28.13882977]
curr_Stock_Price:  98.51159894036535
curr_Factors:  [98.51159894]
mat_Sqrt:  [[0.15]]
grads:  [-0.08344842]
Stock Position:  -0.08344842000209736
Bond Position:  [-19.91819248]


portfolio before change:  [-28.19386632]
curr_Stock_Price:  99.14128887580948
curr_Factors:  [99.14128888]
mat_Sqrt:  [[0.15]]
grads:  [0.08604582]
Stock Position:  0.08604581695160458
Bond Position:  [-36.72455952]


portfolio before change:  [-28.25201333]
curr_Stock_Price:  98.51887454533957
curr_Factors:  [98.51887455]
mat_Sqrt:  [[0.15]]
grads:  [0.04443298]
Stock Position:  0.044432983724513625
Bond Position:  [-32.62950088]


portfolio before change:  [-28.28641052]
curr_Stock_Price:  97.83653803400755
curr_Factors:  [97.83653803]
mat_Sqrt:  [[0.15]]
grads:  [-0.11084956]
Stock Position:  -0.11084955524826896
Bond Position:  [-17.44127379]


portfolio before change:  [-28.22863307]
curr_Stock_Price:  97.29564504140906
curr_Factors:  [97.29564504]
mat_Sqrt:  [[0.15]]
grads:  [0.00308784]
Stock Position:  0.0030878408981292044
Bond Position:  [-28.52906654]


portfolio before change:  [-28.23059238]
curr_Stock_Price:  97.81608922668202
curr_Factors:  [97.81608923]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044477]
Stock Position:  -0.04044476622799549
Bond Position:  [-24.27444351]


portfolio before change:  [-28.22767954]
curr_Stock_Price:  97.66904088674004
curr_Factors:  [97.66904089]
mat_Sqrt:  [[0.15]]
grads:  [0.01190405]
Stock Position:  0.011904051393606218
Bond Position:  [-29.39033682]


portfolio before change:  [-28.2364784]
curr_Stock_Price:  97.23852861229315
curr_Factors:  [97.23852861]
mat_Sqrt:  [[0.15]]
grads:  [0.00944601]
Stock Position:  0.009446005513515175
Bond Position:  [-29.15499407]


portfolio before change:  [-28.22937732]
curr_Stock_Price:  98.3761180559741
curr_Factors:  [98.37611806]
mat_Sqrt:  [[0.15]]
grads:  [-0.19605767]
Stock Position:  -0.19605767360947
Bond Position:  [-8.94198448]


portfolio before change:  [-28.01077481]
curr_Stock_Price:  97.25542570552925
curr_Factors:  [97.25542571]
mat_Sqrt:  [[0.15]]
grads:  [-0.04633388]
Stock Position:  -0.046333878023243846
Bond Position:  [-23.50455377]


portfolio before change:  [-28.03767578]
curr_Stock_Price:  97.77260066345855
curr_Factors:  [97.77260066]
mat_Sqrt:  [[0.15]]
grads:  [-0.10249438]
Stock Position:  -0.10249438483349965
Bond Position:  [-18.01653322]


portfolio before change:  [-28.01025379]
curr_Stock_Price:  97.48308041543625
curr_Factors:  [97.48308042]
mat_Sqrt:  [[0.15]]
grads:  [0.04238807]
Stock Position:  0.04238807342979789
Bond Position:  [-32.14237376]


portfolio before change:  [-28.00216464]
curr_Stock_Price:  97.76870782353306
curr_Factors:  [97.76870782]
mat_Sqrt:  [[0.15]]
grads:  [-0.05442457]
Stock Position:  -0.0544245733700089
Bond Position:  [-22.68114443]


portfolio before change:  [-27.92609167]
curr_Stock_Price:  96.3188427147915
curr_Factors:  [96.31884271]
mat_Sqrt:  [[0.15]]
grads:  [0.08122905]
Stock Position:  0.08122904733174514
Bond Position:  [-35.7499795]


portfolio before change:  [-28.00852536]
curr_Stock_Price:  95.35903010083973
curr_Factors:  [95.3590301]
mat_Sqrt:  [[0.15]]
grads:  [-0.00097162]
Stock Position:  -0.0009716154288159976
Bond Position:  [-27.91587306]


portfolio before change:  [-28.0117595]
curr_Stock_Price:  95.0960043345819
curr_Factors:  [95.09600433]
mat_Sqrt:  [[0.15]]
grads:  [0.17396752]
Stock Position:  0.17396752269216856
Bond Position:  [-44.5553758]


portfolio before change:  [-28.07748187]
curr_Stock_Price:  94.75023520922322
curr_Factors:  [94.75023521]
mat_Sqrt:  [[0.15]]
grads:  [-0.03225516]
Stock Position:  -0.03225516016335727
Bond Position:  [-25.02129786]


portfolio before change:  [-28.09548624]
curr_Stock_Price:  95.21144851901236
curr_Factors:  [95.21144852]
mat_Sqrt:  [[0.15]]
grads:  [-0.22763197]
Stock Position:  -0.22763196870019262
Bond Position:  [-6.42231677]


portfolio before change:  [-27.83074822]
curr_Stock_Price:  94.04491264614613
curr_Factors:  [94.04491265]
mat_Sqrt:  [[0.15]]
grads:  [-0.05734701]
Stock Position:  -0.057347008034089555
Bond Position:  [-22.43755386]


portfolio before change:  [-27.83419064]
curr_Stock_Price:  94.05603010514125
curr_Factors:  [94.05603011]
mat_Sqrt:  [[0.15]]
grads:  [0.33413531]
Stock Position:  0.3341353054498038
Bond Position:  [-59.26163099]


portfolio before change:  [-27.60984381]
curr_Stock_Price:  94.74962637488242
curr_Factors:  [94.74962637]
mat_Sqrt:  [[0.15]]
grads:  [-0.00827131]
Stock Position:  -0.008271313566265698
Bond Position:  [-26.82613994]


portfolio before change:  [-27.6143222]
curr_Stock_Price:  94.88562856054762
curr_Factors:  [94.88562856]
mat_Sqrt:  [[0.15]]
grads:  [-0.13529905]
Stock Position:  -0.13529905297474912
Bond Position:  [-14.77638652]


portfolio before change:  [-27.68268281]
curr_Stock_Price:  95.3772316904802
curr_Factors:  [95.37723169]
mat_Sqrt:  [[0.15]]
grads:  [-0.2201516]
Stock Position:  -0.22015160061666567
Bond Position:  [-6.68523259]


portfolio before change:  [-27.74471344]
curr_Stock_Price:  95.65519892187606
curr_Factors:  [95.65519892]
mat_Sqrt:  [[0.15]]
grads:  [-0.15496741]
Stock Position:  -0.1549674068215668
Bond Position:  [-12.92127532]


portfolio before change:  [-27.62376097]
curr_Stock_Price:  94.8642730377797
curr_Factors:  [94.86427304]
mat_Sqrt:  [[0.15]]
grads:  [0.23571629]
Stock Position:  0.23571628610413076
Bond Position:  [-49.98481509]


portfolio before change:  [-27.46433274]
curr_Stock_Price:  95.56713800071553
curr_Factors:  [95.567138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02662816]
Stock Position:  -0.026628157353890815
Bond Position:  [-24.91955595]


portfolio before change:  [-27.43176732]
curr_Stock_Price:  94.22718202543925
curr_Factors:  [94.22718203]
mat_Sqrt:  [[0.15]]
grads:  [-0.03868178]
Stock Position:  -0.038681780527809934
Bond Position:  [-23.78689215]


portfolio before change:  [-27.4298286]
curr_Stock_Price:  94.1001900493673
curr_Factors:  [94.10019005]
mat_Sqrt:  [[0.15]]
grads:  [0.20096146]
Stock Position:  0.2009614570395681
Bond Position:  [-46.3403399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.63540024]
Stock Price:  93.1060753315795
PL:  [-27.63540024]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.24751831e-02]
 [ 1.94035309e-02]
 [-2.28962893e-03]
 [-2.12527638e-03]
 [-2.93112414e-03]
 [ 2.95295718e-02]
 [ 3.52404906e-03]
 [ 1.57989516e-02]
 [-1.56954965e-02]
 [ 2.33607606e-02]
 [ 1.91566299e-02]
 [-1.52474101e-02]
 [ 1.58511410e-02]
 [ 6.06376578e-03]
 [ 3.40342674e-03]
 [-1.28249252e-03]
 [-6.06038583e-03]
 [ 3.61098757e-03]
 [ 6.12810600e-03]
 [ 5.02773057e-03]
 [-4.77436060e-03]
 [-4.56108614e-03]
 [ 4.01143424e-03]
 [-1.19093502e-02]
 [ 1.50559969e-03]
 [ 2.98308645e-03]
 [-1.80211927e-03]
 [-7.13412432e-04]
 [ 1.65803714e-03]
 [-6.37511198e-03]
 [-2.22527606e-02]
 [ 1.44835716e-02]
 [-4.43985066e-03]
 [-2.09055151e-02]
 [-2.18336099e-02]
 [ 3.12137706e-02]
 [ 3.56591219e-03]
 [ 8.94737837e-03]
 [ 7.73369800e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.44808866]
curr_Stock_Price:  99.98003050169598
curr_Factors:  [99.9800305]
mat_Sqrt:  [[0.15]]
grads:  [0.14983455]
Stock Position:  0.14983455424546802
Bond Position:  [-13.53237465]


portfolio before change:  [1.58749114]
curr_Stock_Price:  100.92169670873984
curr_Factors:  [100.92169671]
mat_Sqrt:  [[0.15]]
grads:  [0.12935687]
Stock Position:  0.12935687285343328
Bond Position:  [-11.46742395]


portfolio before change:  [1.50834501]
curr_Stock_Price:  100.32093533876235
curr_Factors:  [100.32093534]
mat_Sqrt:  [[0.15]]
grads:  [-0.01526419]
Stock Position:  -0.015264192847003848
Bond Position:  [3.03966311]


portfolio before change:  [1.50015514]
curr_Stock_Price:  100.88237051772309
curr_Factors:  [100.88237052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01416851]
Stock Position:  -0.01416850917286233
Bond Position:  [2.92950793]


portfolio before change:  [1.49561475]
curr_Stock_Price:  101.22867380670802
curr_Factors:  [101.22867381]
mat_Sqrt:  [[0.15]]
grads:  [-0.01954083]
Stock Position:  -0.019540827580065208
Bond Position:  [3.47370681]


portfolio before change:  [1.49333489]
curr_Stock_Price:  101.36756731055334
curr_Factors:  [101.36756731]
mat_Sqrt:  [[0.15]]
grads:  [0.19686381]
Stock Position:  0.1968638122024456
Bond Position:  [-18.46227084]


portfolio before change:  [1.62429542]
curr_Stock_Price:  102.04452492523534
curr_Factors:  [102.04452493]
mat_Sqrt:  [[0.15]]
grads:  [0.02349366]
Stock Position:  0.02349366038522031
Bond Position:  [-0.77310399]


portfolio before change:  [1.62408751]
curr_Stock_Price:  102.03978891436385
curr_Factors:  [102.03978891]
mat_Sqrt:  [[0.15]]
grads:  [0.10532634]
Stock Position:  0.10532634385253088
Bond Position:  [-9.12339038]


portfolio before change:  [1.54384925]
curr_Stock_Price:  101.28881090669302
curr_Factors:  [101.28881091]
mat_Sqrt:  [[0.15]]
grads:  [-0.10463664]
Stock Position:  -0.10463664317482543
Bond Position:  [12.14237041]


portfolio before change:  [1.62962194]
curr_Stock_Price:  100.48359773366987
curr_Factors:  [100.48359773]
mat_Sqrt:  [[0.15]]
grads:  [0.1557384]
Stock Position:  0.15573840433314304
Bond Position:  [-14.01953323]


portfolio before change:  [1.57376215]
curr_Stock_Price:  100.13617384481046
curr_Factors:  [100.13617384]
mat_Sqrt:  [[0.15]]
grads:  [0.12771087]
Stock Position:  0.1277108658324445
Bond Position:  [-11.21471531]


portfolio before change:  [1.50241503]
curr_Stock_Price:  99.58848986421799
curr_Factors:  [99.58848986]
mat_Sqrt:  [[0.15]]
grads:  [-0.1016494]
Stock Position:  -0.10164940089629343
Bond Position:  [11.62552536]


portfolio before change:  [1.51738248]
curr_Stock_Price:  99.45554100376609
curr_Factors:  [99.455541]
mat_Sqrt:  [[0.15]]
grads:  [0.10567427]
Stock Position:  0.10567427347892687
Bond Position:  [-8.99250956]


portfolio before change:  [1.61429192]
curr_Stock_Price:  100.38323670419581
curr_Factors:  [100.3832367]
mat_Sqrt:  [[0.15]]
grads:  [0.04042511]
Stock Position:  0.04042510520003003
Bond Position:  [-2.44371099]


portfolio before change:  [1.63421272]
curr_Stock_Price:  100.88357637468475
curr_Factors:  [100.88357637]
mat_Sqrt:  [[0.15]]
grads:  [0.02268951]
Stock Position:  0.022689511616616094
Bond Position:  [-0.65478636]


portfolio before change:  [1.59597094]
curr_Stock_Price:  99.20174524191907
curr_Factors:  [99.20174524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00854995]
Stock Position:  -0.00854995011321965
Bond Position:  [2.44414091]


portfolio before change:  [1.60718895]
curr_Stock_Price:  97.92542461347271
curr_Factors:  [97.92542461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04040257]
Stock Position:  -0.04040257220762534
Bond Position:  [5.56362799]


portfolio before change:  [1.56883199]
curr_Stock_Price:  98.8920080013329
curr_Factors:  [98.892008]
mat_Sqrt:  [[0.15]]
grads:  [0.02407325]
Stock Position:  0.024073250462938973
Bond Position:  [-0.81182008]


portfolio before change:  [1.58553254]
curr_Stock_Price:  99.58996232593056
curr_Factors:  [99.58996233]
mat_Sqrt:  [[0.15]]
grads:  [0.04085404]
Stock Position:  0.04085403998424433
Bond Position:  [-2.48311976]


portfolio before change:  [1.62920257]
curr_Stock_Price:  100.66648839750799
curr_Factors:  [100.6664884]
mat_Sqrt:  [[0.15]]
grads:  [0.0335182]
Stock Position:  0.03351820378060161
Bond Position:  [-1.7449573]


portfolio before change:  [1.63625315]
curr_Stock_Price:  100.88334713558942
curr_Factors:  [100.88334714]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182907]
Stock Position:  -0.0318290706943206
Bond Position:  [4.84727634]


portfolio before change:  [1.64936167]
curr_Stock_Price:  100.49054360590998
curr_Factors:  [100.49054361]
mat_Sqrt:  [[0.15]]
grads:  [-0.03040724]
Stock Position:  -0.030407240924841174
Bond Position:  [4.70500184]


portfolio before change:  [1.59179272]
curr_Stock_Price:  102.40315108245949
curr_Factors:  [102.40315108]
mat_Sqrt:  [[0.15]]
grads:  [0.02674289]
Stock Position:  0.026742894912242365
Bond Position:  [-1.14676399]


portfolio before change:  [1.57534346]
curr_Stock_Price:  101.79342293125579
curr_Factors:  [101.79342293]
mat_Sqrt:  [[0.15]]
grads:  [-0.07939567]
Stock Position:  -0.07939566800193161
Bond Position:  [9.65730028]


portfolio before change:  [1.52550211]
curr_Stock_Price:  102.43638743772361
curr_Factors:  [102.43638744]
mat_Sqrt:  [[0.15]]
grads:  [0.01003733]
Stock Position:  0.010037331252425868
Bond Position:  [0.49731415]


portfolio before change:  [1.52532479]
curr_Stock_Price:  102.41252822247844
curr_Factors:  [102.41252822]
mat_Sqrt:  [[0.15]]
grads:  [0.01988724]
Stock Position:  0.019887242990488992
Bond Position:  [-0.51137804]


portfolio before change:  [1.52098833]
curr_Stock_Price:  102.19769031333321
curr_Factors:  [102.19769031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01201413]
Stock Position:  -0.012014128441708016
Bond Position:  [2.74880451]


portfolio before change:  [1.53190323]
curr_Stock_Price:  101.31778682312951
curr_Factors:  [101.31778682]
mat_Sqrt:  [[0.15]]
grads:  [-0.00475608]
Stock Position:  -0.004756082878181308
Bond Position:  [2.01377902]


portfolio before change:  [1.53126832]
curr_Stock_Price:  101.50420961652443
curr_Factors:  [101.50420962]
mat_Sqrt:  [[0.15]]
grads:  [0.01105358]
Stock Position:  0.0110535809375309
Bond Position:  [0.40928333]


portfolio before change:  [1.53363401]
curr_Stock_Price:  101.71360119265182
curr_Factors:  [101.71360119]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250075]
Stock Position:  -0.04250074654211938
Bond Position:  [5.856538]


portfolio before change:  [1.53567395]
curr_Stock_Price:  101.68282941593806
curr_Factors:  [101.68282942]
mat_Sqrt:  [[0.15]]
grads:  [-0.14835174]
Stock Position:  -0.14835173744824878
Bond Position:  [16.62049836]


portfolio before change:  [1.48145166]
curr_Stock_Price:  102.06233276325435
curr_Factors:  [102.06233276]
mat_Sqrt:  [[0.15]]
grads:  [0.09655714]
Stock Position:  0.09655714388583615
Bond Position:  [-8.37339569]


portfolio before change:  [1.36584262]
curr_Stock_Price:  100.87586129098531
curr_Factors:  [100.87586129]
mat_Sqrt:  [[0.15]]
grads:  [-0.029599]
Stock Position:  -0.029599004383801163
Bond Position:  [4.35166769]


portfolio before change:  [1.38649196]
curr_Stock_Price:  100.19660397212932
curr_Factors:  [100.19660397]
mat_Sqrt:  [[0.15]]
grads:  [-0.1393701]
Stock Position:  -0.13937010043322753
Bond Position:  [15.35090272]


portfolio before change:  [1.52635138]
curr_Stock_Price:  99.20686196357691
curr_Factors:  [99.20686196]
mat_Sqrt:  [[0.15]]
grads:  [-0.1455574]
Stock Position:  -0.14555739950302302
Bond Position:  [15.96664422]


portfolio before change:  [1.4612997]
curr_Stock_Price:  99.66748876439229
curr_Factors:  [99.66748876]
mat_Sqrt:  [[0.15]]
grads:  [0.2080918]
Stock Position:  0.20809180419122586
Bond Position:  [-19.27868786]


portfolio before change:  [1.53383125]
curr_Stock_Price:  100.0276256430436
curr_Factors:  [100.02762564]
mat_Sqrt:  [[0.15]]
grads:  [0.02377275]
Stock Position:  0.023772747951319485
Bond Position:  [-0.84410029]


portfolio before change:  [1.53409564]
curr_Stock_Price:  100.04318624159636
curr_Factors:  [100.04318624]
mat_Sqrt:  [[0.15]]
grads:  [0.05964919]
Stock Position:  0.05964918912996167
Bond Position:  [-4.43339929]


portfolio before change:  [1.58762974]
curr_Stock_Price:  100.94995971977848
curr_Factors:  [100.94995972]
mat_Sqrt:  [[0.15]]
grads:  [0.05155799]
Stock Position:  0.05155798663968424
Bond Position:  [-3.61714694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.59446398]
Stock Price:  101.09128435013378
PL:  [0.50317963]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 5.09233795e-03]
 [ 4.05645918e-02]
 [-3.31987783e-03]
 [-3.85964949e-03]
 [-7.70553485e-03]
 [ 2.71426316e-02]
 [ 3.71411683e-03]
 [ 3.10651575e-03]
 [-2.77152656e-02]
 [ 2.34351954e-02]
 [ 2.11331898e-02]
 [-7.69123278e-03]
 [-1.18323549e-02]
 [ 1.42515288e-02]
 [-1.66231486e-02]
 [-7.25460775e-04]
 [-6.07870630e-03]
 [-3.56833705e-03]
 [ 1.10119369e-03]
 [-1.05024354e-02]
 [-9.63873854e-03]
 [-1.86417784e-02]
 [ 4.45322157e-03]
 [-1.12593472e-02]
 [ 1.09774815e-02]
 [ 1.26499485e-04]
 [ 2.49487770e-02]
 [-4.14676411e-03]
 [-1.98540661e-02]
 [-1.10492005e-02]
 [ 3.79215202e-02]
 [ 8.51301548e-03]
 [-1.14343492e-02]
 [-4.79985201e-02]
 [-2.23775380e-02]
 [ 3.84142159e-02]
 [ 3.07215851e-03]
 [ 7.00306954e-03]
 [ 4.67923787e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58985701]
curr_Stock_Price:  99.75057196898383
curr_Factors:  [99.75057197]
mat_Sqrt:  [[0.15]]
grads:  [0.03394892]
Stock Position:  0.03394891968413492
Bond Position:  [-6.97628117]


portfolio before change:  [-3.58383942]
curr_Stock_Price:  99.9535146822711
curr_Factors:  [99.95351468]
mat_Sqrt:  [[0.15]]
grads:  [0.27043061]
Stock Position:  0.27043061211713953
Bond Position:  [-30.61432958]


portfolio before change:  [-3.45154971]
curr_Stock_Price:  100.45684799146261
curr_Factors:  [100.45684799]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213252]
Stock Position:  -0.022132518872100826
Bond Position:  [-1.22818663]


portfolio before change:  [-3.44904211]
curr_Stock_Price:  100.33661162875606
curr_Factors:  [100.33661163]
mat_Sqrt:  [[0.15]]
grads:  [-0.025731]
Stock Position:  -0.025730996601886616
Bond Position:  [-0.8672811]


portfolio before change:  [-3.44781448]
curr_Stock_Price:  100.28468780121517
curr_Factors:  [100.2846878]
mat_Sqrt:  [[0.15]]
grads:  [-0.05137023]
Stock Position:  -0.051370232325693946
Bond Position:  [1.70383323]


portfolio before change:  [-3.51366]
curr_Stock_Price:  101.57061764540926
curr_Factors:  [101.57061765]
mat_Sqrt:  [[0.15]]
grads:  [0.18095088]
Stock Position:  0.18095087735237123
Bond Position:  [-21.89295238]


portfolio before change:  [-3.70488599]
curr_Stock_Price:  100.52895812895319
curr_Factors:  [100.52895813]
mat_Sqrt:  [[0.15]]
grads:  [0.02476078]
Stock Position:  0.02476077887996709
Bond Position:  [-6.1940613]


portfolio before change:  [-3.71941809]
curr_Stock_Price:  99.97332994626349
curr_Factors:  [99.97332995]
mat_Sqrt:  [[0.15]]
grads:  [0.0207101]
Stock Position:  0.02071010498060773
Bond Position:  [-5.78987625]


portfolio before change:  [-3.73306492]
curr_Stock_Price:  99.34933230540804
curr_Factors:  [99.34933231]
mat_Sqrt:  [[0.15]]
grads:  [-0.18476844]
Stock Position:  -0.1847684372629734
Bond Position:  [14.62355595]


portfolio before change:  [-3.65848563]
curr_Stock_Price:  98.95558952833626
curr_Factors:  [98.95558953]
mat_Sqrt:  [[0.15]]
grads:  [0.15623464]
Stock Position:  0.15623463606893484
Bond Position:  [-19.11877614]


portfolio before change:  [-3.82300778]
curr_Stock_Price:  97.91784165158025
curr_Factors:  [97.91784165]
mat_Sqrt:  [[0.15]]
grads:  [0.14088793]
Stock Position:  0.1408879319473212
Bond Position:  [-17.61845]


portfolio before change:  [-3.92644503]
curr_Stock_Price:  97.19929323813577
curr_Factors:  [97.19929324]
mat_Sqrt:  [[0.15]]
grads:  [-0.05127489]
Stock Position:  -0.051274885212847225
Bond Position:  [1.05743757]


portfolio before change:  [-3.92721016]
curr_Stock_Price:  97.2167933494255
curr_Factors:  [97.21679335]
mat_Sqrt:  [[0.15]]
grads:  [-0.07888237]
Stock Position:  -0.07888236567161347
Bond Position:  [3.74148049]


portfolio before change:  [-3.9197492]
curr_Stock_Price:  97.12813925860024
curr_Factors:  [97.12813926]
mat_Sqrt:  [[0.15]]
grads:  [0.09501019]
Stock Position:  0.09501019215513527
Bond Position:  [-13.14791237]


portfolio before change:  [-3.98342027]
curr_Stock_Price:  96.47528847579514
curr_Factors:  [96.47528848]
mat_Sqrt:  [[0.15]]
grads:  [-0.11082099]
Stock Position:  -0.11082099099223491
Bond Position:  [6.70806681]


portfolio before change:  [-3.9011381]
curr_Stock_Price:  95.74037705538612
curr_Factors:  [95.74037706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483641]
Stock Position:  -0.004836405166717334
Bond Position:  [-3.43809884]


portfolio before change:  [-3.90158558]
curr_Stock_Price:  95.74403584720086
curr_Factors:  [95.74403585]
mat_Sqrt:  [[0.15]]
grads:  [-0.04052471]
Stock Position:  -0.04052470863552419
Bond Position:  [-0.02158642]


portfolio before change:  [-3.90862956]
curr_Stock_Price:  95.91778866862177
curr_Factors:  [95.91778867]
mat_Sqrt:  [[0.15]]
grads:  [-0.02378891]
Stock Position:  -0.02378891368529752
Bond Position:  [-1.62684957]


portfolio before change:  [-3.92155472]
curr_Stock_Price:  96.45256689971633
curr_Factors:  [96.4525669]
mat_Sqrt:  [[0.15]]
grads:  [0.00734129]
Stock Position:  0.007341291248888603
Bond Position:  [-4.62964111]


portfolio before change:  [-3.92263035]
curr_Stock_Price:  96.38488370065106
curr_Factors:  [96.3848837]
mat_Sqrt:  [[0.15]]
grads:  [-0.07001624]
Stock Position:  -0.07001623633176468
Bond Position:  [2.82587645]


portfolio before change:  [-3.93985676]
curr_Stock_Price:  96.63596367170757
curr_Factors:  [96.63596367]
mat_Sqrt:  [[0.15]]
grads:  [-0.06425826]
Stock Position:  -0.06425825694638235
Bond Position:  [2.26980182]


portfolio before change:  [-3.96906731]
curr_Stock_Price:  97.09495977152946
curr_Factors:  [97.09495977]
mat_Sqrt:  [[0.15]]
grads:  [-0.12427852]
Stock Position:  -0.12427852244601925
Bond Position:  [8.09775083]


portfolio before change:  [-3.71212058]
curr_Stock_Price:  95.03559792902382
curr_Factors:  [95.03559793]
mat_Sqrt:  [[0.15]]
grads:  [0.02968814]
Stock Position:  0.0296881437747576
Bond Position:  [-6.53355108]


portfolio before change:  [-3.70733114]
curr_Stock_Price:  95.22443384043397
curr_Factors:  [95.22443384]
mat_Sqrt:  [[0.15]]
grads:  [-0.07506231]
Stock Position:  -0.07506231492229244
Bond Position:  [3.4404353]


portfolio before change:  [-3.69876968]
curr_Stock_Price:  95.11610541536189
curr_Factors:  [95.11610542]
mat_Sqrt:  [[0.15]]
grads:  [0.07318321]
Stock Position:  0.07318320972621785
Bond Position:  [-10.65967157]


portfolio before change:  [-3.66921583]
curr_Stock_Price:  95.53814735714312
curr_Factors:  [95.53814736]
mat_Sqrt:  [[0.15]]
grads:  [0.00084333]
Stock Position:  0.0008433298982601518
Bond Position:  [-3.74978601]


portfolio before change:  [-3.66988168]
curr_Stock_Price:  95.30443363511576
curr_Factors:  [95.30443364]
mat_Sqrt:  [[0.15]]
grads:  [0.16632518]
Stock Position:  0.16632518030772855
Bond Position:  [-19.52140879]


portfolio before change:  [-3.49809502]
curr_Stock_Price:  96.35194185188169
curr_Factors:  [96.35194185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764509]
Stock Position:  -0.027645094076834978
Bond Position:  [-0.83443652]


portfolio before change:  [-3.51024978]
curr_Stock_Price:  96.78784003187874
curr_Factors:  [96.78784003]
mat_Sqrt:  [[0.15]]
grads:  [-0.13236044]
Stock Position:  -0.13236044064304409
Bond Position:  [9.30063138]


portfolio before change:  [-3.41631481]
curr_Stock_Price:  96.08693334373865
curr_Factors:  [96.08693334]
mat_Sqrt:  [[0.15]]
grads:  [-0.07366134]
Stock Position:  -0.07366133691647521
Bond Position:  [3.66157716]


portfolio before change:  [-3.46061759]
curr_Stock_Price:  96.694585977593
curr_Factors:  [96.69458598]
mat_Sqrt:  [[0.15]]
grads:  [0.25281013]
Stock Position:  0.2528101347307828
Bond Position:  [-27.9059889]


portfolio before change:  [-3.20594936]
curr_Stock_Price:  97.71573448038203
curr_Factors:  [97.71573448]
mat_Sqrt:  [[0.15]]
grads:  [0.05675344]
Stock Position:  0.05675343654758357
Bond Position:  [-8.7516531]


portfolio before change:  [-3.18906109]
curr_Stock_Price:  98.03258400608006
curr_Factors:  [98.03258401]
mat_Sqrt:  [[0.15]]
grads:  [-0.07622899]
Stock Position:  -0.0762289949805421
Bond Position:  [4.28386427]


portfolio before change:  [-3.17456773]
curr_Stock_Price:  97.84947989509523
curr_Factors:  [97.8494799]
mat_Sqrt:  [[0.15]]
grads:  [-0.31999013]
Stock Position:  -0.3199901341620396
Bond Position:  [28.13630047]


portfolio before change:  [-3.24149714]
curr_Stock_Price:  98.0696325335284
curr_Factors:  [98.06963253]
mat_Sqrt:  [[0.15]]
grads:  [-0.14918359]
Stock Position:  -0.1491835867750711
Bond Position:  [11.38888239]


portfolio before change:  [-3.22574308]
curr_Stock_Price:  97.97357391456833
curr_Factors:  [97.97357391]
mat_Sqrt:  [[0.15]]
grads:  [0.25609477]
Stock Position:  0.2560947724354871
Bond Position:  [-28.31626319]


portfolio before change:  [-3.11751484]
curr_Stock_Price:  98.41000605736686
curr_Factors:  [98.41000606]
mat_Sqrt:  [[0.15]]
grads:  [0.02048106]
Stock Position:  0.02048105676606447
Bond Position:  [-5.13305576]


portfolio before change:  [-3.12319028]
curr_Stock_Price:  98.16422913485863
curr_Factors:  [98.16422913]
mat_Sqrt:  [[0.15]]
grads:  [0.04668713]
Stock Position:  0.04668713029050486
Bond Position:  [-7.70619644]


portfolio before change:  [-3.09086186]
curr_Stock_Price:  98.87731116005088
curr_Factors:  [98.87731116]
mat_Sqrt:  [[0.15]]
grads:  [0.03119492]
Stock Position:  0.031194919106638293
Bond Position:  [-6.17533159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.1226561]
Stock Price:  97.88284564670846
PL:  [-3.1226561]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.87669537e-03]
 [-6.84137812e-02]
 [ 2.50659770e-02]
 [ 2.17828179e-03]
 [-1.17470998e-03]
 [-1.80719768e-04]
 [ 3.44223211e-03]
 [ 3.08786960e-02]
 [ 1.08001435e-02]
 [ 2.31304863e-02]
 [ 1.98450986e-02]
 [-1.41715111e-02]
 [ 1.76209563e-02]
 [ 6.19774356e-03]
 [-4.72828560e-03]
 [-3.71339057e-03]
 [-6.01102688e-03]
 [ 5.71517010e-03]
 [ 7.55921402e-03]
 [ 1.66833561e-02]
 [-1.60164916e-03]
 [-4.51525682e-03]
 [ 3.96595755e-03]
 [-1.05122171e-02]
 [-7.16505129e-03]
 [ 4.68520319e-03]
 [ 6.83833764e-03]
 [ 2.57093612e-03]
 [ 5.41398280e-03]
 [ 7.72683636e-03]
 [-1.58136006e-02]
 [ 3.24678572e-03]
 [ 1.52566489e-02]
 [ 9.25146437e-02]
 [-1.99983761e-02]
 [-4.43413949e-02]
 [ 4.72952079e-02]
 [ 5.18545841e-03]
 [ 7.72235454e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.89222308]
curr_Stock_Price:  100.45571958551784
curr_Factors:  [100.45571959]
mat_Sqrt:  [[0.15]]
grads:  [-0.06584464]
Stock Position:  -0.06584463578522465
Bond Position:  [18.50669335]


portfolio before change:  [11.74874221]
curr_Stock_Price:  102.66993719246162
curr_Factors:  [102.66993719]
mat_Sqrt:  [[0.15]]
grads:  [-0.45609187]
Stock Position:  -0.45609187452341116
Bond Position:  [58.57566632]


portfolio before change:  [11.37210449]
curr_Stock_Price:  103.51178542488212
curr_Factors:  [103.51178542]
mat_Sqrt:  [[0.15]]
grads:  [0.16710651]
Stock Position:  0.1671065133817747
Bond Position:  [-5.92538907]


portfolio before change:  [11.16188974]
curr_Stock_Price:  102.25824946439003
curr_Factors:  [102.25824946]
mat_Sqrt:  [[0.15]]
grads:  [0.01452188]
Stock Position:  0.0145218785787063
Bond Position:  [9.67690786]


portfolio before change:  [11.16129994]
curr_Stock_Price:  102.13433361092395
curr_Factors:  [102.13433361]
mat_Sqrt:  [[0.15]]
grads:  [-0.0078314]
Stock Position:  -0.00783139985677454
Bond Position:  [11.96115475]


portfolio before change:  [11.15840752]
curr_Stock_Price:  102.69459806850963
curr_Factors:  [102.69459807]
mat_Sqrt:  [[0.15]]
grads:  [-0.0012048]
Stock Position:  -0.0012047984554211986
Bond Position:  [11.28213382]


portfolio before change:  [11.15920266]
curr_Stock_Price:  103.20523792978742
curr_Factors:  [103.20523793]
mat_Sqrt:  [[0.15]]
grads:  [0.02294821]
Stock Position:  0.02294821403333447
Bond Position:  [8.79082677]


portfolio before change:  [11.1677188]
curr_Stock_Price:  103.5284534240613
curr_Factors:  [103.52845342]
mat_Sqrt:  [[0.15]]
grads:  [0.20585797]
Stock Position:  0.20585797323744862
Bond Position:  [-10.14443879]


portfolio before change:  [10.97860491]
curr_Stock_Price:  102.61595168180011
curr_Factors:  [102.61595168]
mat_Sqrt:  [[0.15]]
grads:  [0.07200096]
Stock Position:  0.07200095635631128
Bond Position:  [3.59015825]


portfolio before change:  [10.87411135]
curr_Stock_Price:  101.15843834453175
curr_Factors:  [101.15843834]
mat_Sqrt:  [[0.15]]
grads:  [0.15420324]
Stock Position:  0.15420324171707947
Bond Position:  [-4.72484777]


portfolio before change:  [10.82772344]
curr_Stock_Price:  100.86144546188675
curr_Factors:  [100.86144546]
mat_Sqrt:  [[0.15]]
grads:  [0.13230066]
Stock Position:  0.13230065758893217
Bond Position:  [-2.51631212]


portfolio before change:  [10.79809237]
curr_Stock_Price:  100.63985535815003
curr_Factors:  [100.63985536]
mat_Sqrt:  [[0.15]]
grads:  [-0.09447674]
Stock Position:  -0.09447674074206636
Bond Position:  [20.30621789]


portfolio before change:  [10.89103774]
curr_Stock_Price:  99.68293270252632
curr_Factors:  [99.6829327]
mat_Sqrt:  [[0.15]]
grads:  [0.11747304]
Stock Position:  0.11747304191003487
Bond Position:  [-0.81901959]


portfolio before change:  [10.92004478]
curr_Stock_Price:  99.93072930640504
curr_Factors:  [99.93072931]
mat_Sqrt:  [[0.15]]
grads:  [0.04131829]
Stock Position:  0.04131829037843549
Bond Position:  [6.79107788]


portfolio before change:  [10.91728267]
curr_Stock_Price:  99.84333362673617
curr_Factors:  [99.84333363]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315219]
Stock Position:  -0.031521903972708085
Bond Position:  [14.06453465]


portfolio before change:  [10.88075542]
curr_Stock_Price:  101.05789963912507
curr_Factors:  [101.05789964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02475594]
Stock Position:  -0.024755937106528902
Bond Position:  [13.38253842]


portfolio before change:  [10.88650319]
curr_Stock_Price:  100.8932988042111
curr_Factors:  [100.8932988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04007351]
Stock Position:  -0.040073512514897304
Bond Position:  [14.92965206]


portfolio before change:  [10.90226086]
curr_Stock_Price:  100.5466520727607
curr_Factors:  [100.54665207]
mat_Sqrt:  [[0.15]]
grads:  [0.03810113]
Stock Position:  0.03810113401102454
Bond Position:  [7.0713194]


portfolio before change:  [10.91936689]
curr_Stock_Price:  100.97241510603334
curr_Factors:  [100.97241511]
mat_Sqrt:  [[0.15]]
grads:  [0.05039476]
Stock Position:  0.05039476010716859
Bond Position:  [5.83088625]


portfolio before change:  [11.00572219]
curr_Stock_Price:  102.67152818451173
curr_Factors:  [102.67152818]
mat_Sqrt:  [[0.15]]
grads:  [0.11122237]
Stock Position:  0.11122237417593507
Bond Position:  [-0.41364894]


portfolio before change:  [10.96049749]
curr_Stock_Price:  102.26537798957426
curr_Factors:  [102.26537799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01067766]
Stock Position:  -0.010677661052101483
Bond Position:  [12.05245253]


portfolio before change:  [10.94847441]
curr_Stock_Price:  103.53248440911311
curr_Factors:  [103.53248441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03010171]
Stock Position:  -0.03010171214329198
Bond Position:  [14.06497945]


portfolio before change:  [10.96582235]
curr_Stock_Price:  103.01458344635942
curr_Factors:  [103.01458345]
mat_Sqrt:  [[0.15]]
grads:  [0.02643972]
Stock Position:  0.026439716980788282
Bond Position:  [8.24214591]


portfolio before change:  [10.99439024]
curr_Stock_Price:  104.05610609166655
curr_Factors:  [104.05610609]
mat_Sqrt:  [[0.15]]
grads:  [-0.07008145]
Stock Position:  -0.07008144721393114
Bond Position:  [18.28679275]


portfolio before change:  [10.90643275]
curr_Stock_Price:  105.34380047209413
curr_Factors:  [105.34380047]
mat_Sqrt:  [[0.15]]
grads:  [-0.04776701]
Stock Position:  -0.04776700860993446
Bond Position:  [15.93839097]


portfolio before change:  [10.9008168]
curr_Stock_Price:  105.5030814371874
curr_Factors:  [105.50308144]
mat_Sqrt:  [[0.15]]
grads:  [0.03123469]
Stock Position:  0.031234687946436458
Bond Position:  [7.60546097]


portfolio before change:  [10.88288888]
curr_Stock_Price:  104.8986682393226
curr_Factors:  [104.89866824]
mat_Sqrt:  [[0.15]]
grads:  [0.04558892]
Stock Position:  0.04558891761256293
Bond Position:  [6.10067214]


portfolio before change:  [10.90961748]
curr_Stock_Price:  105.46823577416583
curr_Factors:  [105.46823577]
mat_Sqrt:  [[0.15]]
grads:  [0.01713957]
Stock Position:  0.017139574116830324
Bond Position:  [9.10193684]


portfolio before change:  [10.91121574]
curr_Stock_Price:  105.4951000962375
curr_Factors:  [105.4951001]
mat_Sqrt:  [[0.15]]
grads:  [0.03609322]
Stock Position:  0.03609321866516838
Bond Position:  [7.10355802]


portfolio before change:  [10.96890762]
curr_Stock_Price:  107.06891056581186
curr_Factors:  [107.06891057]
mat_Sqrt:  [[0.15]]
grads:  [0.05151224]
Stock Position:  0.05151224241101409
Bond Position:  [5.45354795]


portfolio before change:  [11.00246593]
curr_Stock_Price:  107.70713886869414
curr_Factors:  [107.70713887]
mat_Sqrt:  [[0.15]]
grads:  [-0.105424]
Stock Position:  -0.1054240042446538
Bond Position:  [22.35738379]


portfolio before change:  [10.98023825]
curr_Stock_Price:  107.94449017143876
curr_Factors:  [107.94449017]
mat_Sqrt:  [[0.15]]
grads:  [0.02164524]
Stock Position:  0.021645238136636852
Bond Position:  [8.64375406]


portfolio before change:  [11.00460234]
curr_Stock_Price:  109.02017965243314
curr_Factors:  [109.02017965]
mat_Sqrt:  [[0.15]]
grads:  [0.10171099]
Stock Position:  0.10171099251648803
Bond Position:  [-0.08394833]


portfolio before change:  [11.03457159]
curr_Stock_Price:  109.31493385742432
curr_Factors:  [109.31493386]
mat_Sqrt:  [[0.15]]
grads:  [0.61676429]
Stock Position:  0.6167642912554063
Bond Position:  [-56.38697611]


portfolio before change:  [11.92497395]
curr_Stock_Price:  110.77002972304871
curr_Factors:  [110.77002972]
mat_Sqrt:  [[0.15]]
grads:  [-0.13332251]
Stock Position:  -0.13332250703388074
Bond Position:  [26.69311202]


portfolio before change:  [11.77723444]
curr_Stock_Price:  111.90319439419353
curr_Factors:  [111.90319439]
mat_Sqrt:  [[0.15]]
grads:  [-0.2956093]
Stock Position:  -0.29560929909836825
Bond Position:  [44.8568593]


portfolio before change:  [11.75982281]
curr_Stock_Price:  111.98106437577707
curr_Factors:  [111.98106438]
mat_Sqrt:  [[0.15]]
grads:  [0.31530139]
Stock Position:  0.3153013857656172
Bond Position:  [-23.54796197]


portfolio before change:  [11.8316404]
curr_Stock_Price:  112.2181748797146
curr_Factors:  [112.21817488]
mat_Sqrt:  [[0.15]]
grads:  [0.03456972]
Stock Position:  0.034569722751264034
Bond Position:  [7.95228921]


portfolio before change:  [11.84245955]
curr_Stock_Price:  112.50238460075747
curr_Factors:  [112.5023846]
mat_Sqrt:  [[0.15]]
grads:  [0.05148236]
Stock Position:  0.05148236363328293
Bond Position:  [6.05057088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.8595808]
Stock Price:  112.82025818225955
PL:  [-0.96067738]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.30987381e-02]
 [ 4.21804023e-02]
 [-3.44687926e-03]
 [-6.97899718e-03]
 [-7.32461045e-03]
 [ 3.12578485e-02]
 [ 3.57805229e-03]
 [-6.93027642e-04]
 [ 2.66892989e-02]
 [ 2.32292964e-02]
 [ 2.24646914e-02]
 [-3.94594186e-03]
 [-2.72996132e-02]
 [ 1.68845699e-02]
 [ 2.89851413e-04]
 [ 1.03964355e-04]
 [-6.11505921e-03]
 [ 1.56126394e-04]
 [ 3.52955883e-03]
 [-2.48842994e-02]
 [-7.51695683e-03]
 [-1.70514662e-02]
 [ 6.65429776e-03]
 [-6.37652250e-03]
 [ 1.25418920e-02]
 [ 7.88295561e-03]
 [-8.02780138e-03]
 [-2.32807244e-03]
 [-4.83693868e-05]
 [-1.16295786e-02]
 [-2.00771012e-02]
 [ 1.72337661e-02]
 [-3.37742935e-03]
 [-2.11172449e-02]
 [-2.09573390e-02]
 [ 2.65355269e-02]
 [ 5.15355676e-03]
 [ 1.41850303e-02]
 [ 8.56633970e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.14478367]
curr_Stock_Price:  100.01176220844226
curr_Factors:  [100.01176221]
mat_Sqrt:  [[0.15]]
grads:  [0.15399159]
Stock Position:  0.15399158742465888
Bond Position:  [-13.25618636]


portfolio before change:  [2.15115125]
curr_Stock_Price:  100.06387359841194
curr_Factors:  [100.0638736]
mat_Sqrt:  [[0.15]]
grads:  [0.28120268]
Stock Position:  0.2812026817196116
Bond Position:  [-25.98707834]


portfolio before change:  [2.26119659]
curr_Stock_Price:  100.46676421331304
curr_Factors:  [100.46676421]
mat_Sqrt:  [[0.15]]
grads:  [-0.0229792]
Stock Position:  -0.022979195069874257
Bond Position:  [4.56984196]


portfolio before change:  [2.28065088]
curr_Stock_Price:  99.64501967690214
curr_Factors:  [99.64501968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04652665]
Stock Position:  -0.04652664787661303
Bond Position:  [6.91679963]


portfolio before change:  [2.29600877]
curr_Stock_Price:  99.33351579790477
curr_Factors:  [99.3335158]
mat_Sqrt:  [[0.15]]
grads:  [-0.04883074]
Stock Position:  -0.04883073630712835
Bond Position:  [7.14653748]


portfolio before change:  [2.31613877]
curr_Stock_Price:  98.93957069809616
curr_Factors:  [98.9395707]
mat_Sqrt:  [[0.15]]
grads:  [0.20838566]
Stock Position:  0.2083856569284498
Bond Position:  [-18.30144867]


portfolio before change:  [2.13305199]
curr_Stock_Price:  98.07195359822353
curr_Factors:  [98.0719536]
mat_Sqrt:  [[0.15]]
grads:  [0.02385368]
Stock Position:  0.023853681951887935
Bond Position:  [-0.2063252]


portfolio before change:  [2.12790864]
curr_Stock_Price:  97.85741407056608
curr_Factors:  [97.85741407]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462018]
Stock Position:  -0.004620184276788045
Bond Position:  [2.58002792]


portfolio before change:  [2.13261664]
curr_Stock_Price:  96.90821404214007
curr_Factors:  [96.90821404]
mat_Sqrt:  [[0.15]]
grads:  [0.17792866]
Stock Position:  0.17792865909678696
Bond Position:  [-15.11013194]


portfolio before change:  [1.67757712]
curr_Stock_Price:  94.36140321762713
curr_Factors:  [94.36140322]
mat_Sqrt:  [[0.15]]
grads:  [0.15486198]
Stock Position:  0.15486197592840537
Bond Position:  [-12.93541623]


portfolio before change:  [1.68698846]
curr_Stock_Price:  94.4326173815717
curr_Factors:  [94.43261738]
mat_Sqrt:  [[0.15]]
grads:  [0.14976461]
Stock Position:  0.14976460919820195
Bond Position:  [-12.45567558]


portfolio before change:  [1.87636923]
curr_Stock_Price:  95.70753692934468
curr_Factors:  [95.70753693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02630628]
Stock Position:  -0.026306279064542294
Bond Position:  [4.3940784]


portfolio before change:  [1.88780855]
curr_Stock_Price:  95.29356611924665
curr_Factors:  [95.29356612]
mat_Sqrt:  [[0.15]]
grads:  [-0.18199742]
Stock Position:  -0.18199742127985377
Bond Position:  [19.23099185]


portfolio before change:  [1.94903024]
curr_Stock_Price:  94.97038756012033
curr_Factors:  [94.97038756]
mat_Sqrt:  [[0.15]]
grads:  [0.1125638]
Stock Position:  0.11256379940239167
Bond Position:  [-8.74119741]


portfolio before change:  [1.92838129]
curr_Stock_Price:  94.79665287303452
curr_Factors:  [94.79665287]
mat_Sqrt:  [[0.15]]
grads:  [0.00193234]
Stock Position:  0.0019323427507379524
Bond Position:  [1.74520166]


portfolio before change:  [1.93251404]
curr_Stock_Price:  96.82247653283912
curr_Factors:  [96.82247653]
mat_Sqrt:  [[0.15]]
grads:  [0.0006931]
Stock Position:  0.0006930957030482742
Bond Position:  [1.8654068]


portfolio before change:  [1.93285706]
curr_Stock_Price:  96.98094089579772
curr_Factors:  [96.9809409]
mat_Sqrt:  [[0.15]]
grads:  [-0.04076706]
Stock Position:  -0.0407670613853071
Bond Position:  [5.88648503]


portfolio before change:  [1.93169892]
curr_Stock_Price:  97.02739986322689
curr_Factors:  [97.02739986]
mat_Sqrt:  [[0.15]]
grads:  [0.00104084]
Stock Position:  0.0010408426245699504
Bond Position:  [1.83070867]


portfolio before change:  [1.93283574]
curr_Stock_Price:  97.89974188691927
curr_Factors:  [97.89974189]
mat_Sqrt:  [[0.15]]
grads:  [0.02353039]
Stock Position:  0.023530392177866517
Bond Position:  [-0.37078358]


portfolio before change:  [1.924712]
curr_Stock_Price:  97.55646709062819
curr_Factors:  [97.55646709]
mat_Sqrt:  [[0.15]]
grads:  [-0.16589533]
Stock Position:  -0.16589532903497184
Bond Position:  [18.10887421]


portfolio before change:  [1.99867935]
curr_Stock_Price:  97.12424519100402
curr_Factors:  [97.12424519]
mat_Sqrt:  [[0.15]]
grads:  [-0.05011305]
Stock Position:  -0.05011304551139853
Bond Position:  [6.86587107]


portfolio before change:  [1.98447795]
curr_Stock_Price:  97.42475954894923
curr_Factors:  [97.42475955]
mat_Sqrt:  [[0.15]]
grads:  [-0.11367644]
Stock Position:  -0.11367644128259066
Bond Position:  [13.0593779]


portfolio before change:  [1.84589531]
curr_Stock_Price:  98.65821794223852
curr_Factors:  [98.65821794]
mat_Sqrt:  [[0.15]]
grads:  [0.04436199]
Stock Position:  0.04436198507846596
Bond Position:  [-2.53077908]


portfolio before change:  [1.86164087]
curr_Stock_Price:  99.02028313990236
curr_Factors:  [99.02028314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04251015]
Stock Position:  -0.04251015003172916
Bond Position:  [6.07100797]


portfolio before change:  [1.81877965]
curr_Stock_Price:  100.04639438890723
curr_Factors:  [100.04639439]
mat_Sqrt:  [[0.15]]
grads:  [0.08361261]
Stock Position:  0.08361261312633918
Bond Position:  [-6.54636082]


portfolio before change:  [1.7526575]
curr_Stock_Price:  99.26536626977767
curr_Factors:  [99.26536627]
mat_Sqrt:  [[0.15]]
grads:  [0.05255304]
Stock Position:  0.05255303738929729
Bond Position:  [-3.464039]


portfolio before change:  [1.75891834]
curr_Stock_Price:  99.39273987213848
curr_Factors:  [99.39273987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05351868]
Stock Position:  -0.053518675875072
Bond Position:  [7.07828617]


portfolio before change:  [1.7641561]
curr_Stock_Price:  99.31140540210478
curr_Factors:  [99.3114054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01552048]
Stock Position:  -0.015520482910487781
Bond Position:  [3.30551707]


portfolio before change:  [1.7601885]
curr_Stock_Price:  99.59366530135124
curr_Factors:  [99.5936653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032246]
Stock Position:  -0.00032246257847452363
Bond Position:  [1.79230373]


portfolio before change:  [1.76042297]
curr_Stock_Price:  99.56137935150656
curr_Factors:  [99.56137935]
mat_Sqrt:  [[0.15]]
grads:  [-0.07753052]
Stock Position:  -0.07753052422812866
Bond Position:  [9.4794689]


portfolio before change:  [1.71774975]
curr_Stock_Price:  100.12706912331531
curr_Factors:  [100.12706912]
mat_Sqrt:  [[0.15]]
grads:  [-0.13384734]
Stock Position:  -0.13384734114770658
Bond Position:  [15.11949173]


portfolio before change:  [1.70674299]
curr_Stock_Price:  100.22342373311551
curr_Factors:  [100.22342373]
mat_Sqrt:  [[0.15]]
grads:  [0.11489177]
Stock Position:  0.1148917737808546
Bond Position:  [-9.80810393]


portfolio before change:  [1.90373639]
curr_Stock_Price:  101.94869503446363
curr_Factors:  [101.94869503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0225162]
Stock Position:  -0.02251619564066419
Bond Position:  [4.19923315]


portfolio before change:  [1.89267346]
curr_Stock_Price:  102.46334052618859
curr_Factors:  [102.46334053]
mat_Sqrt:  [[0.15]]
grads:  [-0.14078163]
Stock Position:  -0.14078163272717956
Bond Position:  [16.31762984]


portfolio before change:  [2.11515687]
curr_Stock_Price:  100.89748590003158
curr_Factors:  [100.8974859]
mat_Sqrt:  [[0.15]]
grads:  [-0.13971559]
Stock Position:  -0.13971559315607032
Bond Position:  [16.21210896]


portfolio before change:  [2.13494753]
curr_Stock_Price:  100.77034174226102
curr_Factors:  [100.77034174]
mat_Sqrt:  [[0.15]]
grads:  [0.17690351]
Stock Position:  0.17690351242558353
Bond Position:  [-15.69167988]


portfolio before change:  [2.27698035]
curr_Stock_Price:  101.58431317501154
curr_Factors:  [101.58431318]
mat_Sqrt:  [[0.15]]
grads:  [0.03435705]
Stock Position:  0.03435704505302118
Bond Position:  [-1.21315647]


portfolio before change:  [2.27468014]
curr_Stock_Price:  101.52177693252936
curr_Factors:  [101.52177693]
mat_Sqrt:  [[0.15]]
grads:  [0.09456687]
Stock Position:  0.09456686883123014
Bond Position:  [-7.32591643]


portfolio before change:  [2.27714742]
curr_Stock_Price:  101.55755138497891
curr_Factors:  [101.55755138]
mat_Sqrt:  [[0.15]]
grads:  [0.05710893]
Stock Position:  0.057108931325328384
Bond Position:  [-3.52269581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26789072]
Stock Price:  101.40317386059185
PL:  [0.86471686]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.97843060e-02]
 [ 4.12407891e-02]
 [-2.61753887e-03]
 [-6.41491632e-03]
 [-2.56130316e-03]
 [ 1.58480739e-02]
 [ 3.67933160e-03]
 [ 4.82339393e-03]
 [-2.64784090e-02]
 [ 2.33734456e-02]
 [ 1.91915441e-02]
 [-1.41975175e-02]
 [ 3.01088379e-02]
 [ 1.84178114e-02]
 [-1.19245709e-02]
 [-2.89263630e-03]
 [-5.43036223e-03]
 [ 7.21680455e-03]
 [ 2.16590571e-02]
 [ 1.24900451e-02]
 [-1.06006520e-03]
 [-3.67205079e-03]
 [ 5.32463305e-03]
 [-1.12753986e-02]
 [-1.33911757e-03]
 [ 4.47383590e-03]
 [ 5.97630775e-03]
 [ 1.82852797e-03]
 [ 4.74489168e-03]
 [-4.09333696e-03]
 [-1.86073815e-02]
 [ 7.28281915e-03]
 [-5.49525408e-04]
 [-2.09683498e-02]
 [-2.02462102e-02]
 [ 1.90336918e-03]
 [ 1.12182018e-02]
 [ 2.16704145e-02]
 [ 9.90296007e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.04759062]
curr_Stock_Price:  100.55388806656929
curr_Factors:  [100.55388807]
mat_Sqrt:  [[0.15]]
grads:  [-0.13189537]
Stock Position:  -0.1318953730033536
Bond Position:  [27.3101832]


portfolio before change:  [14.12409964]
curr_Stock_Price:  99.9996985648596
curr_Factors:  [99.99969856]
mat_Sqrt:  [[0.15]]
grads:  [0.27493859]
Stock Position:  0.27493859402882087
Bond Position:  [-13.36967689]


portfolio before change:  [14.18249063]
curr_Stock_Price:  100.21815570339496
curr_Factors:  [100.2181557]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745026]
Stock Position:  -0.017450259128063104
Bond Position:  [15.93132341]


portfolio before change:  [14.18970674]
curr_Stock_Price:  99.91875747335217
curr_Factors:  [99.91875747]
mat_Sqrt:  [[0.15]]
grads:  [-0.04276611]
Stock Position:  -0.0427661088281966
Bond Position:  [18.4628432]


portfolio before change:  [14.12483882]
curr_Stock_Price:  101.48953226910518
curr_Factors:  [101.48953227]
mat_Sqrt:  [[0.15]]
grads:  [-0.01707535]
Stock Position:  -0.01707535442497027
Bond Position:  [15.85780855]


portfolio before change:  [14.11768006]
curr_Stock_Price:  102.02487141634533
curr_Factors:  [102.02487142]
mat_Sqrt:  [[0.15]]
grads:  [0.10565383]
Stock Position:  0.10565382604653481
Bond Position:  [3.33836204]


portfolio before change:  [14.03836278]
curr_Stock_Price:  101.27019356105922
curr_Factors:  [101.27019356]
mat_Sqrt:  [[0.15]]
grads:  [0.02452888]
Stock Position:  0.02452887730176739
Bond Position:  [11.55431863]


portfolio before change:  [14.02209069]
curr_Stock_Price:  100.5479237956272
curr_Factors:  [100.5479238]
mat_Sqrt:  [[0.15]]
grads:  [0.03215596]
Stock Position:  0.032155959531811454
Bond Position:  [10.78887572]


portfolio before change:  [14.01092038]
curr_Stock_Price:  100.1586023954829
curr_Factors:  [100.1586024]
mat_Sqrt:  [[0.15]]
grads:  [-0.17652273]
Stock Position:  -0.17652272662032076
Bond Position:  [31.69118997]


portfolio before change:  [13.97761834]
curr_Stock_Price:  100.369700959266
curr_Factors:  [100.36970096]
mat_Sqrt:  [[0.15]]
grads:  [0.15582297]
Stock Position:  0.1558229703849174
Bond Position:  [-1.6622866]


portfolio before change:  [13.96358321]
curr_Stock_Price:  100.28096355191936
curr_Factors:  [100.28096355]
mat_Sqrt:  [[0.15]]
grads:  [0.12794363]
Stock Position:  0.1279436270347777
Bond Position:  [1.13327301]


portfolio before change:  [13.99748049]
curr_Stock_Price:  100.54479547763947
curr_Factors:  [100.54479548]
mat_Sqrt:  [[0.15]]
grads:  [-0.09465012]
Stock Position:  -0.09465011653683705
Bond Position:  [23.5140571]


portfolio before change:  [13.96509381]
curr_Stock_Price:  100.91802395217734
curr_Factors:  [100.91802395]
mat_Sqrt:  [[0.15]]
grads:  [0.20072559]
Stock Position:  0.20072558604153382
Bond Position:  [-6.29173569]


portfolio before change:  [14.07255411]
curr_Stock_Price:  101.45730156390819
curr_Factors:  [101.45730156]
mat_Sqrt:  [[0.15]]
grads:  [0.12278541]
Stock Position:  0.12278540947455142
Bond Position:  [1.6150778]


portfolio before change:  [14.16919087]
curr_Stock_Price:  102.24269507313151
curr_Factors:  [102.24269507]
mat_Sqrt:  [[0.15]]
grads:  [-0.07949714]
Stock Position:  -0.07949713919277332
Bond Position:  [22.29719264]


portfolio before change:  [14.18177526]
curr_Stock_Price:  102.11945714674756
curr_Factors:  [102.11945715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01928424]
Stock Position:  -0.019284241985834876
Bond Position:  [16.15107158]


portfolio before change:  [14.17751452]
curr_Stock_Price:  102.44509878537237
curr_Factors:  [102.44509879]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620241]
Stock Position:  -0.036202414853857376
Bond Position:  [17.88627448]


portfolio before change:  [14.18158598]
curr_Stock_Price:  102.3943967046417
curr_Factors:  [102.3943967]
mat_Sqrt:  [[0.15]]
grads:  [0.04811203]
Stock Position:  0.048112030302028985
Bond Position:  [9.25518366]


portfolio before change:  [14.26575808]
curr_Stock_Price:  104.11985144636846
curr_Factors:  [104.11985145]
mat_Sqrt:  [[0.15]]
grads:  [0.14439371]
Stock Position:  0.14439371380408703
Bond Position:  [-0.76849395]


portfolio before change:  [14.14819126]
curr_Stock_Price:  103.30630667993206
curr_Factors:  [103.30630668]
mat_Sqrt:  [[0.15]]
grads:  [0.08326697]
Stock Position:  0.08326696747424443
Bond Position:  [5.54618838]


portfolio before change:  [14.08809003]
curr_Stock_Price:  102.57619061352523
curr_Factors:  [102.57619061]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070671]
Stock Position:  -0.007067101328064836
Bond Position:  [14.81300636]


portfolio before change:  [14.08843677]
curr_Stock_Price:  102.78914865901957
curr_Factors:  [102.78914866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02448034]
Stock Position:  -0.024480338596320105
Bond Position:  [16.60474994]


portfolio before change:  [14.05642084]
curr_Stock_Price:  104.18176264353775
curr_Factors:  [104.18176264]
mat_Sqrt:  [[0.15]]
grads:  [0.03549755]
Stock Position:  0.035497553691169983
Bond Position:  [10.35822312]


portfolio before change:  [14.03034812]
curr_Stock_Price:  103.41079188449868
curr_Factors:  [103.41079188]
mat_Sqrt:  [[0.15]]
grads:  [-0.07516932]
Stock Position:  -0.07516932405389824
Bond Position:  [21.80366744]


portfolio before change:  [14.01737893]
curr_Stock_Price:  103.61958468415628
curr_Factors:  [103.61958468]
mat_Sqrt:  [[0.15]]
grads:  [-0.00892745]
Stock Position:  -0.008927450468381525
Bond Position:  [14.94243764]


portfolio before change:  [14.01786884]
curr_Stock_Price:  103.77394177269021
curr_Factors:  [103.77394177]
mat_Sqrt:  [[0.15]]
grads:  [0.02982557]
Stock Position:  0.02982557267902204
Bond Position:  [10.9227516]


portfolio before change:  [14.03459724]
curr_Stock_Price:  104.28903551581625
curr_Factors:  [104.28903552]
mat_Sqrt:  [[0.15]]
grads:  [0.03984205]
Stock Position:  0.03984205169342706
Bond Position:  [9.87950809]


portfolio before change:  [14.03292907]
curr_Stock_Price:  104.21616816517049
curr_Factors:  [104.21616817]
mat_Sqrt:  [[0.15]]
grads:  [0.01219019]
Stock Position:  0.012190186460434179
Bond Position:  [12.76251454]


portfolio before change:  [14.02620303]
curr_Stock_Price:  103.53353324402983
curr_Factors:  [103.53353324]
mat_Sqrt:  [[0.15]]
grads:  [0.03163261]
Stock Position:  0.031632611169686985
Bond Position:  [10.75116703]


portfolio before change:  [14.06032995]
curr_Stock_Price:  104.56989829283799
curr_Factors:  [104.56989829]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728891]
Stock Position:  -0.027288913074708654
Bond Position:  [16.91392881]


portfolio before change:  [14.10689659]
curr_Stock_Price:  102.940948352543
curr_Factors:  [102.94094835]
mat_Sqrt:  [[0.15]]
grads:  [-0.12404921]
Stock Position:  -0.12404920995822057
Bond Position:  [26.87663991]


portfolio before change:  [14.03514579]
curr_Stock_Price:  103.54643860233588
curr_Factors:  [103.5464386]
mat_Sqrt:  [[0.15]]
grads:  [0.04855213]
Stock Position:  0.048552127652410106
Bond Position:  [9.00774589]


portfolio before change:  [14.02698493]
curr_Stock_Price:  103.35516162174795
curr_Factors:  [103.35516162]
mat_Sqrt:  [[0.15]]
grads:  [-0.0036635]
Stock Position:  -0.00366350271703345
Bond Position:  [14.40562684]


portfolio before change:  [14.03064146]
curr_Stock_Price:  102.84861955981137
curr_Factors:  [102.84861956]
mat_Sqrt:  [[0.15]]
grads:  [-0.139789]
Stock Position:  -0.13978899897851468
Bond Position:  [28.40774704]


portfolio before change:  [13.88802333]
curr_Stock_Price:  103.89426211248185
curr_Factors:  [103.89426211]
mat_Sqrt:  [[0.15]]
grads:  [-0.13497473]
Stock Position:  -0.13497473435569618
Bond Position:  [27.91112376]


portfolio before change:  [13.79927377]
curr_Stock_Price:  104.57763941321782
curr_Factors:  [104.57763941]
mat_Sqrt:  [[0.15]]
grads:  [0.01268913]
Stock Position:  0.0126891278489865
Bond Position:  [12.47227473]


portfolio before change:  [13.80872035]
curr_Stock_Price:  105.1992308363935
curr_Factors:  [105.19923084]
mat_Sqrt:  [[0.15]]
grads:  [0.07478801]
Stock Position:  0.07478801191730207
Bond Position:  [5.94107902]


portfolio before change:  [13.80989297]
curr_Stock_Price:  105.20497964023512
curr_Factors:  [105.20497964]
mat_Sqrt:  [[0.15]]
grads:  [0.14446943]
Stock Position:  0.14446942997600604
Bond Position:  [-1.38901046]


portfolio before change:  [13.70006061]
curr_Stock_Price:  104.44593510484376
curr_Factors:  [104.4459351]
mat_Sqrt:  [[0.15]]
grads:  [0.06601973]
Stock Position:  0.06601973378389547
Bond Position:  [6.80456778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.82359445]
Stock Price:  106.30421618219302
PL:  [7.51937827]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.62867710e-02]
 [ 4.34131218e-02]
 [-1.55712649e-03]
 [-6.46255249e-03]
 [-7.56476301e-03]
 [ 4.17316748e-02]
 [ 3.55817748e-03]
 [-3.04348373e-03]
 [-2.30427744e-02]
 [ 2.34003418e-02]
 [ 1.94528408e-02]
 [-1.26876974e-02]
 [ 2.75045674e-02]
 [ 1.70338361e-02]
 [-1.09426927e-02]
 [-3.66143964e-03]
 [-6.10229441e-03]
 [ 6.00585515e-03]
 [ 6.84085417e-03]
 [ 1.39972745e-02]
 [-3.60825145e-03]
 [-4.64292766e-03]
 [ 4.71830924e-03]
 [-1.01004353e-02]
 [ 3.80424464e-03]
 [ 6.93282305e-03]
 [-8.32854385e-03]
 [-1.70396318e-03]
 [ 9.99065448e-04]
 [-6.46384630e-03]
 [-2.24440411e-02]
 [ 1.81521952e-02]
 [-3.38030011e-03]
 [-1.94301630e-02]
 [-2.10731279e-02]
 [ 2.09901518e-02]
 [ 4.13595542e-03]
 [ 2.03476400e-02]
 [ 1.04074810e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.93089534]
curr_Stock_Price:  99.87167717415898
curr_Factors:  [99.87167717]
mat_Sqrt:  [[0.15]]
grads:  [0.10857847]
Stock Position:  0.1085784735891241
Bond Position:  [-11.7748096]


portfolio before change:  [-0.90292198]
curr_Stock_Price:  100.14286636590155
curr_Factors:  [100.14286637]
mat_Sqrt:  [[0.15]]
grads:  [0.28942081]
Stock Position:  0.289420812123589
Bond Position:  [-29.88635169]


portfolio before change:  [-0.95750741]
curr_Stock_Price:  99.96717268700297
curr_Factors:  [99.96717269]
mat_Sqrt:  [[0.15]]
grads:  [-0.01038084]
Stock Position:  -0.010380843234354398
Bond Position:  [0.08023614]


portfolio before change:  [-0.956777]
curr_Stock_Price:  99.89777752665124
curr_Factors:  [99.89777753]
mat_Sqrt:  [[0.15]]
grads:  [-0.04308368]
Stock Position:  -0.04308368326085752
Bond Position:  [3.34718721]


portfolio before change:  [-0.95812054]
curr_Stock_Price:  99.93867385484695
curr_Factors:  [99.93867385]
mat_Sqrt:  [[0.15]]
grads:  [-0.05043175]
Stock Position:  -0.05043175337949322
Bond Position:  [4.08196201]


portfolio before change:  [-0.8645499]
curr_Stock_Price:  98.09340056697037
curr_Factors:  [98.09340057]
mat_Sqrt:  [[0.15]]
grads:  [0.27821117]
Stock Position:  0.2782111651896495
Bond Position:  [-28.15522916]


portfolio before change:  [-0.71338097]
curr_Stock_Price:  98.64941185707846
curr_Factors:  [98.64941186]
mat_Sqrt:  [[0.15]]
grads:  [0.02372118]
Stock Position:  0.023721183204879964
Bond Position:  [-3.05346174]


portfolio before change:  [-0.71458748]
curr_Stock_Price:  98.61464103183457
curr_Factors:  [98.61464103]
mat_Sqrt:  [[0.15]]
grads:  [-0.02028989]
Stock Position:  -0.020289891543818994
Bond Position:  [1.28629289]


portfolio before change:  [-0.7171417]
curr_Stock_Price:  98.74845245412688
curr_Factors:  [98.74845245]
mat_Sqrt:  [[0.15]]
grads:  [-0.1536185]
Stock Position:  -0.15361849620343523
Bond Position:  [14.45244706]


portfolio before change:  [-0.87946929]
curr_Stock_Price:  99.81690614879146
curr_Factors:  [99.81690615]
mat_Sqrt:  [[0.15]]
grads:  [0.15600228]
Stock Position:  0.156002278746067
Bond Position:  [-16.4511341]


portfolio before change:  [-0.90759428]
curr_Stock_Price:  99.64980301405257
curr_Factors:  [99.64980301]
mat_Sqrt:  [[0.15]]
grads:  [0.12968561]
Stock Position:  0.1296856051969192
Bond Position:  [-13.83073929]


portfolio before change:  [-0.6951169]
curr_Stock_Price:  101.30153855643887
curr_Factors:  [101.30153856]
mat_Sqrt:  [[0.15]]
grads:  [-0.08458465]
Stock Position:  -0.08458464947382933
Bond Position:  [7.87343823]


portfolio before change:  [-0.67714069]
curr_Stock_Price:  101.10065143660667
curr_Factors:  [101.10065144]
mat_Sqrt:  [[0.15]]
grads:  [0.18336378]
Stock Position:  0.18336378266947498
Bond Position:  [-19.21533857]


portfolio before change:  [-0.6357589]
curr_Stock_Price:  101.33943283234585
curr_Factors:  [101.33943283]
mat_Sqrt:  [[0.15]]
grads:  [0.11355891]
Stock Position:  0.11355890730209456
Bond Position:  [-12.14375416]


portfolio before change:  [-0.60935788]
curr_Stock_Price:  101.58528840795518
curr_Factors:  [101.58528841]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295128]
Stock Position:  -0.07295128469119068
Bond Position:  [6.80141942]


portfolio before change:  [-0.53077472]
curr_Stock_Price:  100.51974274909013
curr_Factors:  [100.51974275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0244096]
Stock Position:  -0.024409597625526427
Bond Position:  [1.92287175]


portfolio before change:  [-0.52448878]
curr_Stock_Price:  100.27207088210788
curr_Factors:  [100.27207088]
mat_Sqrt:  [[0.15]]
grads:  [-0.04068196]
Stock Position:  -0.04068196275844282
Bond Position:  [3.55477588]


portfolio before change:  [-0.54374885]
curr_Stock_Price:  100.75642437189896
curr_Factors:  [100.75642437]
mat_Sqrt:  [[0.15]]
grads:  [0.04003903]
Stock Position:  0.04003903436398443
Bond Position:  [-4.57793879]


portfolio before change:  [-0.55143774]
curr_Stock_Price:  100.57868262675551
curr_Factors:  [100.57868263]
mat_Sqrt:  [[0.15]]
grads:  [0.04560569]
Stock Position:  0.045605694477426864
Bond Position:  [-5.13839841]


portfolio before change:  [-0.51012092]
curr_Stock_Price:  101.49872473150829
curr_Factors:  [101.49872473]
mat_Sqrt:  [[0.15]]
grads:  [0.09331516]
Stock Position:  0.0933151630080737
Bond Position:  [-9.98149096]


portfolio before change:  [-0.51774377]
curr_Stock_Price:  101.43040689692747
curr_Factors:  [101.4304069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02405501]
Stock Position:  -0.024055009697002843
Bond Position:  [1.92216565]


portfolio before change:  [-0.50572534]
curr_Stock_Price:  100.94077318477039
curr_Factors:  [100.94077318]
mat_Sqrt:  [[0.15]]
grads:  [-0.03095285]
Stock Position:  -0.03095285103435502
Bond Position:  [2.61867937]


portfolio before change:  [-0.52454636]
curr_Stock_Price:  101.55940336826093
curr_Factors:  [101.55940337]
mat_Sqrt:  [[0.15]]
grads:  [0.03145539]
Stock Position:  0.031455394953793764
Bond Position:  [-3.7191375]


portfolio before change:  [-0.54839471]
curr_Stock_Price:  100.81601962736842
curr_Factors:  [100.81601963]
mat_Sqrt:  [[0.15]]
grads:  [-0.06733624]
Stock Position:  -0.06733623535142713
Bond Position:  [6.24017652]


portfolio before change:  [-0.60920593]
curr_Stock_Price:  101.73070236108752
curr_Factors:  [101.73070236]
mat_Sqrt:  [[0.15]]
grads:  [0.02536163]
Stock Position:  0.02536163096252896
Bond Position:  [-3.18926246]


portfolio before change:  [-0.63537908]
curr_Stock_Price:  100.7144241536233
curr_Factors:  [100.71442415]
mat_Sqrt:  [[0.15]]
grads:  [0.04621882]
Stock Position:  0.04621882030231866
Bond Position:  [-5.29028095]


portfolio before change:  [-0.70379269]
curr_Stock_Price:  99.24852182480501
curr_Factors:  [99.24852182]
mat_Sqrt:  [[0.15]]
grads:  [-0.05552363]
Stock Position:  -0.05552362564572468
Bond Position:  [4.80684509]


portfolio before change:  [-0.76129601]
curr_Stock_Price:  100.29499926268409
curr_Factors:  [100.29499926]
mat_Sqrt:  [[0.15]]
grads:  [-0.01135975]
Stock Position:  -0.011359754548317226
Bond Position:  [0.37803056]


portfolio before change:  [-0.76929841]
curr_Stock_Price:  101.00361095032768
curr_Factors:  [101.00361095]
mat_Sqrt:  [[0.15]]
grads:  [0.00666044]
Stock Position:  0.0066604363197156555
Bond Position:  [-1.44202653]


portfolio before change:  [-0.76596007]
curr_Stock_Price:  101.53189505035238
curr_Factors:  [101.53189505]
mat_Sqrt:  [[0.15]]
grads:  [-0.04309231]
Stock Position:  -0.043092308661343906
Bond Position:  [3.60928369]


portfolio before change:  [-0.77108507]
curr_Stock_Price:  101.66129603385366
curr_Factors:  [101.66129603]
mat_Sqrt:  [[0.15]]
grads:  [-0.14962694]
Stock Position:  -0.14962694041563748
Bond Position:  [14.44018361]


portfolio before change:  [-0.70502871]
curr_Stock_Price:  101.23188652551066
curr_Factors:  [101.23188653]
mat_Sqrt:  [[0.15]]
grads:  [0.12101463]
Stock Position:  0.12101463459371768
Bond Position:  [-12.95556846]


portfolio before change:  [-0.59982174]
curr_Stock_Price:  102.11464351332448
curr_Factors:  [102.11464351]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253533]
Stock Position:  -0.02253533405622559
Bond Position:  [1.70136586]


portfolio before change:  [-0.59314703]
curr_Stock_Price:  101.82789261598874
curr_Factors:  [101.82789262]
mat_Sqrt:  [[0.15]]
grads:  [-0.12953442]
Stock Position:  -0.1295344200450395
Bond Position:  [12.59706999]


portfolio before change:  [-0.44399987]
curr_Stock_Price:  100.68864001317806
curr_Factors:  [100.68864001]
mat_Sqrt:  [[0.15]]
grads:  [-0.14048752]
Stock Position:  -0.14048751930325065
Bond Position:  [13.70149739]


portfolio before change:  [-0.70139122]
curr_Stock_Price:  102.53296146153852
curr_Factors:  [102.53296146]
mat_Sqrt:  [[0.15]]
grads:  [0.13993435]
Stock Position:  0.13993434537018495
Bond Position:  [-15.04927406]


portfolio before change:  [-0.76916132]
curr_Stock_Price:  102.06210617542165
curr_Factors:  [102.06210618]
mat_Sqrt:  [[0.15]]
grads:  [0.02757304]
Stock Position:  0.027573036106932406
Bond Position:  [-3.58332346]


portfolio before change:  [-0.74396692]
curr_Stock_Price:  102.99208519338038
curr_Factors:  [102.99208519]
mat_Sqrt:  [[0.15]]
grads:  [0.13565093]
Stock Position:  0.13565093347849747
Bond Position:  [-14.71493942]


portfolio before change:  [-0.7062485]
curr_Stock_Price:  103.28370065246949
curr_Factors:  [103.28370065]
mat_Sqrt:  [[0.15]]
grads:  [0.06938321]
Stock Position:  0.06938320679356909
Bond Position:  [-7.87240286]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.69942404]
Stock Price:  103.39624332981856
PL:  [-4.09566737]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.27174560e-02]
 [-8.13666842e-02]
 [ 3.07572903e-02]
 [ 1.47407238e-02]
 [ 3.40530046e-03]
 [-4.12621196e-02]
 [ 3.31167750e-03]
 [ 4.99403134e-02]
 [ 8.30769036e-02]
 [ 2.23190776e-02]
 [ 1.41417650e-02]
 [ 1.86401930e-02]
 [-7.22932051e-03]
 [ 2.32951514e-02]
 [-8.91056477e-03]
 [-3.89633932e-03]
 [-4.55868614e-03]
 [ 7.06588601e-03]
 [ 2.88062049e-02]
 [-5.76394854e-03]
 [-1.56449324e-04]
 [-2.88185896e-02]
 [ 1.05274461e-02]
 [-2.24023842e-03]
 [-1.97052876e-02]
 [ 4.84796662e-03]
 [ 6.59610500e-03]
 [ 4.72341792e-03]
 [ 5.51292065e-03]
 [ 1.73117150e-03]
 [-1.29259457e-02]
 [ 4.79613650e-03]
 [ 7.05098777e-03]
 [ 4.91608461e-02]
 [-2.01632642e-02]
 [-1.72238081e-02]
 [ 1.57215723e-02]
 [ 1.80679882e-02]
 [ 8.51947823e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [47.38011601]
curr_Stock_Price:  102.07205298259363
curr_Factors:  [102.07205298]
mat_Sqrt:  [[0.15]]
grads:  [-0.48478304]
Stock Position:  -0.48478304020179935
Bond Position:  [96.86291617]


portfolio before change:  [46.97014415]
curr_Stock_Price:  102.9427114838689
curr_Factors:  [102.94271148]
mat_Sqrt:  [[0.15]]
grads:  [-0.54244456]
Stock Position:  -0.542444561077992
Bond Position:  [102.8108581]


portfolio before change:  [46.34856637]
curr_Stock_Price:  104.11228712027012
curr_Factors:  [104.11228712]
mat_Sqrt:  [[0.15]]
grads:  [0.2050486]
Stock Position:  0.2050486018759142
Bond Position:  [25.00048746]


portfolio before change:  [46.45074408]
curr_Stock_Price:  104.5953553116176
curr_Factors:  [104.59535531]
mat_Sqrt:  [[0.15]]
grads:  [0.09827149]
Stock Position:  0.09827149184995182
Bond Position:  [36.17200248]


portfolio before change:  [46.36587928]
curr_Stock_Price:  103.68576714623316
curr_Factors:  [103.68576715]
mat_Sqrt:  [[0.15]]
grads:  [0.022702]
Stock Position:  0.022702003047482454
Bond Position:  [44.01200468]


portfolio before change:  [46.39176794]
curr_Stock_Price:  104.58378540267977
curr_Factors:  [104.5837854]
mat_Sqrt:  [[0.15]]
grads:  [-0.2750808]
Stock Position:  -0.27508079722090906
Bond Position:  [75.160759]


portfolio before change:  [46.17105024]
curr_Stock_Price:  105.4203155501366
curr_Factors:  [105.42031555]
mat_Sqrt:  [[0.15]]
grads:  [0.02207785]
Stock Position:  0.02207784997245988
Bond Position:  [43.84359633]


portfolio before change:  [46.18095434]
curr_Stock_Price:  105.62066614758835
curr_Factors:  [105.62066615]
mat_Sqrt:  [[0.15]]
grads:  [0.33293542]
Stock Position:  0.3329354226495349
Bond Position:  [11.01609322]


portfolio before change:  [45.86262108]
curr_Stock_Price:  104.66038873797615
curr_Factors:  [104.66038874]
mat_Sqrt:  [[0.15]]
grads:  [0.55384602]
Stock Position:  0.5538460242183778
Bond Position:  [-12.10311912]


portfolio before change:  [46.581747]
curr_Stock_Price:  105.96154263277944
curr_Factors:  [105.96154263]
mat_Sqrt:  [[0.15]]
grads:  [0.14879385]
Stock Position:  0.14879385099452677
Bond Position:  [30.81532102]


portfolio before change:  [46.76690624]
curr_Stock_Price:  107.18005457566015
curr_Factors:  [107.18005458]
mat_Sqrt:  [[0.15]]
grads:  [0.09427843]
Stock Position:  0.09427843304463501
Bond Position:  [36.66213864]


portfolio before change:  [46.72288285]
curr_Stock_Price:  106.66449182495995
curr_Factors:  [106.66449182]
mat_Sqrt:  [[0.15]]
grads:  [0.12426795]
Stock Position:  0.12426795345876365
Bond Position:  [33.46790474]


portfolio before change:  [46.70255195]
curr_Stock_Price:  106.46721931628142
curr_Factors:  [106.46721932]
mat_Sqrt:  [[0.15]]
grads:  [-0.04819547]
Stock Position:  -0.0481954700774824
Bond Position:  [51.83378963]


portfolio before change:  [46.77306183]
curr_Stock_Price:  105.13866601122864
curr_Factors:  [105.13866601]
mat_Sqrt:  [[0.15]]
grads:  [0.15530101]
Stock Position:  0.1553010092035695
Bond Position:  [30.44492089]


portfolio before change:  [46.71780369]
curr_Stock_Price:  104.75834656785315
curr_Factors:  [104.75834657]
mat_Sqrt:  [[0.15]]
grads:  [-0.05940377]
Stock Position:  -0.05940376513974027
Bond Position:  [52.9408439]


portfolio before change:  [46.75392826]
curr_Stock_Price:  104.26163472399618
curr_Factors:  [104.26163472]
mat_Sqrt:  [[0.15]]
grads:  [-0.0259756]
Stock Position:  -0.025975595439928733
Bond Position:  [49.4621863]


portfolio before change:  [46.75364909]
curr_Stock_Price:  104.51041934062783
curr_Factors:  [104.51041934]
mat_Sqrt:  [[0.15]]
grads:  [-0.03039124]
Stock Position:  -0.030391240948572804
Bond Position:  [49.92985043]


portfolio before change:  [46.70581577]
curr_Stock_Price:  106.28971292929431
curr_Factors:  [106.28971293]
mat_Sqrt:  [[0.15]]
grads:  [0.04710591]
Stock Position:  0.0471059067179166
Bond Position:  [41.69894247]


portfolio before change:  [46.69030265]
curr_Stock_Price:  105.84972954405433
curr_Factors:  [105.84972954]
mat_Sqrt:  [[0.15]]
grads:  [0.19204137]
Stock Position:  0.19204136566989125
Bond Position:  [26.36277603]


portfolio before change:  [46.60375327]
curr_Stock_Price:  105.38188797178861
curr_Factors:  [105.38188797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842632]
Stock Position:  -0.03842632362826922
Bond Position:  [50.6531918]


portfolio before change:  [46.61659219]
curr_Stock_Price:  105.21255420697844
curr_Factors:  [105.21255421]
mat_Sqrt:  [[0.15]]
grads:  [-0.001043]
Stock Position:  -0.0010429954900500879
Bond Position:  [46.72632841]


portfolio before change:  [46.62037581]
curr_Stock_Price:  107.1852692167239
curr_Factors:  [107.18526922]
mat_Sqrt:  [[0.15]]
grads:  [-0.19212393]
Stock Position:  -0.1921239309477479
Bond Position:  [67.21323107]


portfolio before change:  [46.4347238]
curr_Stock_Price:  108.19531616008659
curr_Factors:  [108.19531616]
mat_Sqrt:  [[0.15]]
grads:  [0.07018297]
Stock Position:  0.07018297424608341
Bond Position:  [38.84125471]


portfolio before change:  [46.50027685]
curr_Stock_Price:  109.06016399819062
curr_Factors:  [109.060164]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493492]
Stock Position:  -0.014934922778719445
Bond Position:  [48.12908198]


portfolio before change:  [46.50052137]
curr_Stock_Price:  109.44664068235684
curr_Factors:  [109.44664068]
mat_Sqrt:  [[0.15]]
grads:  [-0.13136858]
Stock Position:  -0.13136858379103908
Bond Position:  [60.87837155]


portfolio before change:  [46.65892997]
curr_Stock_Price:  108.29873815902974
curr_Factors:  [108.29873816]
mat_Sqrt:  [[0.15]]
grads:  [0.03231978]
Stock Position:  0.03231977745983067
Bond Position:  [43.15873885]


portfolio before change:  [46.66946257]
curr_Stock_Price:  108.45769432554776
curr_Factors:  [108.45769433]
mat_Sqrt:  [[0.15]]
grads:  [0.04397403]
Stock Position:  0.04397403330520248
Bond Position:  [41.90014031]


portfolio before change:  [46.65169895]
curr_Stock_Price:  107.93462487101428
curr_Factors:  [107.93462487]
mat_Sqrt:  [[0.15]]
grads:  [0.03148945]
Stock Position:  0.031489452798042904
Bond Position:  [43.25289667]


portfolio before change:  [46.64126582]
curr_Stock_Price:  107.43159676401879
curr_Factors:  [107.43159676]
mat_Sqrt:  [[0.15]]
grads:  [0.0367528]
Stock Position:  0.036752804359845216
Bond Position:  [42.69285336]


portfolio before change:  [46.59107249]
curr_Stock_Price:  105.92068438928169
curr_Factors:  [105.92068439]
mat_Sqrt:  [[0.15]]
grads:  [0.01154114]
Stock Position:  0.011541143316050509
Bond Position:  [45.36862669]


portfolio before change:  [46.60040765]
curr_Stock_Price:  106.23813340076052
curr_Factors:  [106.2381334]
mat_Sqrt:  [[0.15]]
grads:  [-0.08617297]
Stock Position:  -0.08617297133578698
Bond Position:  [55.75526327]


portfolio before change:  [46.68703988]
curr_Stock_Price:  105.31368588264505
curr_Factors:  [105.31368588]
mat_Sqrt:  [[0.15]]
grads:  [0.03197424]
Stock Position:  0.03197424333059335
Bond Position:  [43.31971446]


portfolio before change:  [46.71693276]
curr_Stock_Price:  106.07922649918711
curr_Factors:  [106.0792265]
mat_Sqrt:  [[0.15]]
grads:  [0.04700659]
Stock Position:  0.047006585160656394
Bond Position:  [41.73051057]


portfolio before change:  [46.73540804]
curr_Stock_Price:  106.36128567129118
curr_Factors:  [106.36128567]
mat_Sqrt:  [[0.15]]
grads:  [0.32773897]
Stock Position:  0.32773897402858776
Bond Position:  [11.8766694]


portfolio before change:  [46.34843103]
curr_Stock_Price:  105.17600800221382
curr_Factors:  [105.176008]
mat_Sqrt:  [[0.15]]
grads:  [-0.13442176]
Stock Position:  -0.13442176129260416
Bond Position:  [60.48637527]


portfolio before change:  [46.16032629]
curr_Stock_Price:  106.63162060125693
curr_Factors:  [106.6316206]
mat_Sqrt:  [[0.15]]
grads:  [-0.11482539]
Stock Position:  -0.11482538702836546
Bond Position:  [58.4043434]


portfolio before change:  [46.22932709]
curr_Stock_Price:  106.09428468926858
curr_Factors:  [106.09428469]
mat_Sqrt:  [[0.15]]
grads:  [0.10481048]
Stock Position:  0.10481048182359491
Bond Position:  [35.109534]


portfolio before change:  [46.25666751]
curr_Stock_Price:  106.31326517080532
curr_Factors:  [106.31326517]
mat_Sqrt:  [[0.15]]
grads:  [0.12045325]
Stock Position:  0.12045325479768684
Bond Position:  [33.45088869]


portfolio before change:  [46.27292743]
curr_Stock_Price:  106.41353893025276
curr_Factors:  [106.41353893]
mat_Sqrt:  [[0.15]]
grads:  [0.05679652]
Stock Position:  0.05679652152469695
Bond Position:  [40.22900858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [46.25012805]
Stock Price:  105.92357357534368
PL:  [40.32655447]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 9.53809541e-03]
 [-1.94270753e-02]
 [-1.28437993e-02]
 [-9.11091720e-03]
 [-5.75852255e-03]
 [ 4.42972531e-02]
 [ 3.58045508e-03]
 [ 5.04752191e-04]
 [ 6.59502965e-04]
 [ 2.34449212e-02]
 [ 2.12475909e-02]
 [-5.47341467e-03]
 [-2.23977648e-02]
 [ 1.74471121e-02]
 [-1.80450337e-02]
 [ 7.05138976e-04]
 [-6.05575625e-03]
 [ 2.70283881e-03]
 [ 5.09589744e-03]
 [-2.70962018e-02]
 [-4.80625382e-03]
 [-1.73007551e-02]
 [ 6.55520529e-03]
 [-6.90867313e-03]
 [ 1.43061512e-02]
 [ 5.58563706e-03]
 [ 5.64840033e-03]
 [-3.39495153e-03]
 [-1.01816405e-02]
 [-1.44543247e-02]
 [ 1.38754920e-02]
 [ 9.29075130e-03]
 [-1.10550577e-02]
 [-4.90775341e-02]
 [-2.31394813e-02]
 [ 3.81936680e-02]
 [-1.67383169e-03]
 [ 5.38175157e-03]
 [ 8.46622222e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.58622941]
curr_Stock_Price:  98.97645431746797
curr_Factors:  [98.97645432]
mat_Sqrt:  [[0.15]]
grads:  [0.0635873]
Stock Position:  0.06358730270007766
Bond Position:  [-26.87987517]


portfolio before change:  [-20.7090301]
curr_Stock_Price:  97.09808407351282
curr_Factors:  [97.09808407]
mat_Sqrt:  [[0.15]]
grads:  [-0.12951384]
Stock Position:  -0.129513835239382
Bond Position:  [-8.13348484]


portfolio before change:  [-20.66968354]
curr_Stock_Price:  96.78643156607187
curr_Factors:  [96.78643157]
mat_Sqrt:  [[0.15]]
grads:  [-0.08562533]
Stock Position:  -0.08562532893600489
Bond Position:  [-12.3823135]


portfolio before change:  [-20.6946752]
curr_Stock_Price:  97.06022640620921
curr_Factors:  [97.06022641]
mat_Sqrt:  [[0.15]]
grads:  [-0.06073945]
Stock Position:  -0.06073944800383475
Bond Position:  [-14.79929062]


portfolio before change:  [-20.76968322]
curr_Stock_Price:  98.26468243850604
curr_Factors:  [98.26468244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03839015]
Stock Position:  -0.03839015033079875
Bond Position:  [-16.99728729]


portfolio before change:  [-20.75653644]
curr_Stock_Price:  97.8668831355768
curr_Factors:  [97.86688314]
mat_Sqrt:  [[0.15]]
grads:  [0.29531502]
Stock Position:  0.29531502083010314
Bond Position:  [-49.65809707]


portfolio before change:  [-20.72280038]
curr_Stock_Price:  98.00214109479818
curr_Factors:  [98.00214109]
mat_Sqrt:  [[0.15]]
grads:  [0.0238697]
Stock Position:  0.023869700545591472
Bond Position:  [-23.06208214]


portfolio before change:  [-20.73557687]
curr_Stock_Price:  97.58765939510704
curr_Factors:  [97.5876594]
mat_Sqrt:  [[0.15]]
grads:  [0.00336501]
Stock Position:  0.0033650146083267995
Bond Position:  [-21.06396077]


portfolio before change:  [-20.73795481]
curr_Stock_Price:  97.66350708563722
curr_Factors:  [97.66350709]
mat_Sqrt:  [[0.15]]
grads:  [0.00439669]
Stock Position:  0.004396686435032017
Bond Position:  [-21.16735062]


portfolio before change:  [-20.74231129]
curr_Stock_Price:  97.27448719604088
curr_Factors:  [97.2744872]
mat_Sqrt:  [[0.15]]
grads:  [0.15629947]
Stock Position:  0.15629947481885728
Bond Position:  [-35.94626255]


portfolio before change:  [-20.69305221]
curr_Stock_Price:  97.61839522085171
curr_Factors:  [97.61839522]
mat_Sqrt:  [[0.15]]
grads:  [0.14165061]
Stock Position:  0.14165060577074745
Bond Position:  [-34.52075703]


portfolio before change:  [-20.86581279]
curr_Stock_Price:  96.42923536410893
curr_Factors:  [96.42923536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03648943]
Stock Position:  -0.0364894311333645
Bond Position:  [-17.34716484]


portfolio before change:  [-20.85579844]
curr_Stock_Price:  96.09536121831187
curr_Factors:  [96.09536122]
mat_Sqrt:  [[0.15]]
grads:  [-0.14931843]
Stock Position:  -0.14931843186169766
Bond Position:  [-6.50698979]


portfolio before change:  [-20.8874016]
curr_Stock_Price:  96.30156307174471
curr_Factors:  [96.30156307]
mat_Sqrt:  [[0.15]]
grads:  [0.11631408]
Stock Position:  0.11631408041396354
Bond Position:  [-32.08862935]


portfolio before change:  [-20.80556091]
curr_Stock_Price:  97.03966824558385
curr_Factors:  [97.03966825]
mat_Sqrt:  [[0.15]]
grads:  [-0.12030022]
Stock Position:  -0.12030022456949034
Bond Position:  [-9.13166702]


portfolio before change:  [-20.91354042]
curr_Stock_Price:  97.9277628572441
curr_Factors:  [97.92776286]
mat_Sqrt:  [[0.15]]
grads:  [0.00470093]
Stock Position:  0.004700926504943743
Bond Position:  [-21.37389163]


portfolio before change:  [-20.91584735]
curr_Stock_Price:  98.00540073051373
curr_Factors:  [98.00540073]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037171]
Stock Position:  -0.040371708330790894
Bond Position:  [-16.9592019]


portfolio before change:  [-20.91896934]
curr_Stock_Price:  98.0302190727252
curr_Factors:  [98.03021907]
mat_Sqrt:  [[0.15]]
grads:  [0.01801893]
Stock Position:  0.018018925432825798
Bond Position:  [-22.68536855]


portfolio before change:  [-20.91175048]
curr_Stock_Price:  98.58822739946392
curr_Factors:  [98.5882274]
mat_Sqrt:  [[0.15]]
grads:  [0.03397265]
Stock Position:  0.0339726495994311
Bond Position:  [-24.26105379]


portfolio before change:  [-20.94325835]
curr_Stock_Price:  97.75005170935778
curr_Factors:  [97.75005171]
mat_Sqrt:  [[0.15]]
grads:  [-0.18064135]
Stock Position:  -0.1806413451575687
Bond Position:  [-3.28555752]


portfolio before change:  [-20.95771706]
curr_Stock_Price:  97.82781902380991
curr_Factors:  [97.82781902]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204169]
Stock Position:  -0.03204169212343984
Bond Position:  [-17.82314821]


portfolio before change:  [-20.94537391]
curr_Stock_Price:  97.37306188800284
curr_Factors:  [97.37306189]
mat_Sqrt:  [[0.15]]
grads:  [-0.11533837]
Stock Position:  -0.11533836719897902
Bond Position:  [-9.71452394]


portfolio before change:  [-21.05573982]
curr_Stock_Price:  98.31942102463599
curr_Factors:  [98.31942102]
mat_Sqrt:  [[0.15]]
grads:  [0.04370137]
Stock Position:  0.04370136858265879
Bond Position:  [-25.35243307]


portfolio before change:  [-21.06378754]
curr_Stock_Price:  98.20778899557507
curr_Factors:  [98.207789]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605782]
Stock Position:  -0.04605782087745254
Bond Position:  [-16.54055079]


portfolio before change:  [-21.06932158]
curr_Stock_Price:  98.28304962018053
curr_Factors:  [98.28304962]
mat_Sqrt:  [[0.15]]
grads:  [0.09537434]
Stock Position:  0.095374341589753
Bond Position:  [-30.44300273]


portfolio before change:  [-21.11012703]
curr_Stock_Price:  97.89510629005973
curr_Factors:  [97.89510629]
mat_Sqrt:  [[0.15]]
grads:  [0.03723758]
Stock Position:  0.0372375804011564
Bond Position:  [-24.75550392]


portfolio before change:  [-21.11539926]
curr_Stock_Price:  97.8366279155581
curr_Factors:  [97.83662792]
mat_Sqrt:  [[0.15]]
grads:  [0.037656]
Stock Position:  0.0376560021704459
Bond Position:  [-24.79953553]


portfolio before change:  [-21.11708969]
curr_Stock_Price:  97.87406440017354
curr_Factors:  [97.8740644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02263301]
Stock Position:  -0.022633010228350105
Bond Position:  [-18.90190498]


portfolio before change:  [-21.12581909]
curr_Stock_Price:  98.1553578348103
curr_Factors:  [98.15535783]
mat_Sqrt:  [[0.15]]
grads:  [-0.0678776]
Stock Position:  -0.0678776035088387
Bond Position:  [-14.46326863]


portfolio before change:  [-21.16725752]
curr_Stock_Price:  98.73920890354485
curr_Factors:  [98.7392089]
mat_Sqrt:  [[0.15]]
grads:  [-0.09636216]
Stock Position:  -0.09636216477390394
Bond Position:  [-11.6525336]


portfolio before change:  [-21.12348002]
curr_Stock_Price:  98.26979063247197
curr_Factors:  [98.26979063]
mat_Sqrt:  [[0.15]]
grads:  [0.09250328]
Stock Position:  0.09250327968090163
Bond Position:  [-30.21375795]


portfolio before change:  [-21.15508216]
curr_Stock_Price:  97.96898850226438
curr_Factors:  [97.9689885]
mat_Sqrt:  [[0.15]]
grads:  [0.06193834]
Stock Position:  0.0619383419725774
Bond Position:  [-27.22311887]


portfolio before change:  [-21.1444316]
curr_Stock_Price:  98.19588604947955
curr_Factors:  [98.19588605]
mat_Sqrt:  [[0.15]]
grads:  [-0.07370038]
Stock Position:  -0.07370038437663154
Bond Position:  [-13.90735706]


portfolio before change:  [-21.10252884]
curr_Stock_Price:  97.60374133233915
curr_Factors:  [97.60374133]
mat_Sqrt:  [[0.15]]
grads:  [-0.32718356]
Stock Position:  -0.3271835608868743
Bond Position:  [10.83181081]


portfolio before change:  [-20.56451345]
curr_Stock_Price:  95.9634959386656
curr_Factors:  [95.96349594]
mat_Sqrt:  [[0.15]]
grads:  [-0.15426321]
Stock Position:  -0.15426320849688033
Bond Position:  [-5.76087667]


portfolio before change:  [-20.59632356]
curr_Stock_Price:  96.16503431821793
curr_Factors:  [96.16503432]
mat_Sqrt:  [[0.15]]
grads:  [0.25462445]
Stock Position:  0.2546244530658709
Bond Position:  [-45.08229283]


portfolio before change:  [-20.50680495]
curr_Stock_Price:  96.53873859728569
curr_Factors:  [96.5387386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01115888]
Stock Position:  -0.011158877902445527
Bond Position:  [-19.42954095]


portfolio before change:  [-20.51769872]
curr_Stock_Price:  97.29732047889853
curr_Factors:  [97.29732048]
mat_Sqrt:  [[0.15]]
grads:  [0.03587834]
Stock Position:  0.03587834381437004
Bond Position:  [-24.00856543]


portfolio before change:  [-20.51773244]
curr_Stock_Price:  97.38003149192492
curr_Factors:  [97.38003149]
mat_Sqrt:  [[0.15]]
grads:  [0.05644148]
Stock Position:  0.05644148144537267
Bond Position:  [-26.01400568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.50591366]
Stock Price:  97.64704674221072
PL:  [-20.50591366]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 7.98924450e-03]
 [ 3.66899717e-02]
 [-3.42483916e-03]
 [-2.25826738e-03]
 [-2.75921133e-03]
 [ 3.32429943e-02]
 [ 3.58628468e-03]
 [ 6.78276492e-03]
 [-1.79349256e-02]
 [ 2.26989759e-02]
 [ 1.63811009e-02]
 [ 4.28112516e-03]
 [-3.41295100e-03]
 [ 2.32880880e-02]
 [-6.79051125e-03]
 [-5.66618003e-03]
 [-3.94568943e-03]
 [ 6.46706683e-03]
 [ 3.47847614e-02]
 [-8.70485098e-03]
 [-1.14152146e-03]
 [-2.06099331e-02]
 [ 9.13751831e-03]
 [-3.58259338e-03]
 [-1.84050609e-02]
 [ 4.83202166e-03]
 [ 6.59924378e-03]
 [ 5.24422043e-03]
 [ 5.49285107e-03]
 [ 4.86676990e-03]
 [-1.47493792e-02]
 [ 3.82517650e-03]
 [ 1.18819541e-02]
 [ 7.53722850e-02]
 [-1.99799217e-02]
 [-1.98235386e-02]
 [ 1.54928669e-02]
 [ 1.99435184e-02]
 [ 9.89416137e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.91916971]
curr_Stock_Price:  99.78111912747313
curr_Factors:  [99.78111913]
mat_Sqrt:  [[0.15]]
grads:  [0.05326163]
Stock Position:  0.05326163002560211
Bond Position:  [-8.23367476]


portfolio before change:  [-2.92103381]
curr_Stock_Price:  99.76544514088746
curr_Factors:  [99.76544514]
mat_Sqrt:  [[0.15]]
grads:  [0.24459981]
Stock Position:  0.24459981150807328
Bond Position:  [-27.32364288]


portfolio before change:  [-2.64892763]
curr_Stock_Price:  100.8918640138834
curr_Factors:  [100.89186401]
mat_Sqrt:  [[0.15]]
grads:  [-0.02283226]
Stock Position:  -0.022832261056229923
Bond Position:  [-0.34533825]


portfolio before change:  [-2.64604146]
curr_Stock_Price:  100.76356581595658
curr_Factors:  [100.76356582]
mat_Sqrt:  [[0.15]]
grads:  [-0.01505512]
Stock Position:  -0.015055115851212077
Bond Position:  [-1.12903431]


portfolio before change:  [-2.65500305]
curr_Stock_Price:  101.34944305284769
curr_Factors:  [101.34944305]
mat_Sqrt:  [[0.15]]
grads:  [-0.01839474]
Stock Position:  -0.018394742195777955
Bond Position:  [-0.79070617]


portfolio before change:  [-2.64339431]
curr_Stock_Price:  100.71297961702912
curr_Factors:  [100.71297962]
mat_Sqrt:  [[0.15]]
grads:  [0.22161996]
Stock Position:  0.2216199619480247
Bond Position:  [-24.96340102]


portfolio before change:  [-2.88747777]
curr_Stock_Price:  99.62570011985451
curr_Factors:  [99.62570012]
mat_Sqrt:  [[0.15]]
grads:  [0.02390856]
Stock Position:  0.023908564507580776
Bond Position:  [-5.26938525]


portfolio before change:  [-2.85453414]
curr_Stock_Price:  101.03115268617282
curr_Factors:  [101.03115269]
mat_Sqrt:  [[0.15]]
grads:  [0.04521843]
Stock Position:  0.0452184328010169
Bond Position:  [-7.42300452]


portfolio before change:  [-2.85246518]
curr_Stock_Price:  101.0974285090447
curr_Factors:  [101.09742851]
mat_Sqrt:  [[0.15]]
grads:  [-0.11956617]
Stock Position:  -0.11956617074751794
Bond Position:  [9.23536722]


portfolio before change:  [-3.11288051]
curr_Stock_Price:  103.28508598499376
curr_Factors:  [103.28508598]
mat_Sqrt:  [[0.15]]
grads:  [0.15132651]
Stock Position:  0.1513265059267828
Bond Position:  [-18.74265169]


portfolio before change:  [-3.07705132]
curr_Stock_Price:  103.53733636876557
curr_Factors:  [103.53733637]
mat_Sqrt:  [[0.15]]
grads:  [0.10920734]
Stock Position:  0.10920733936796184
Bond Position:  [-14.38408835]


portfolio before change:  [-3.00453962]
curr_Stock_Price:  104.21778350883406
curr_Factors:  [104.21778351]
mat_Sqrt:  [[0.15]]
grads:  [0.02854083]
Stock Position:  0.02854083438792164
Bond Position:  [-5.97900212]


portfolio before change:  [-2.9786491]
curr_Stock_Price:  105.15111099475483
curr_Factors:  [105.15111099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02275301]
Stock Position:  -0.022753006663486956
Bond Position:  [-0.58614517]


portfolio before change:  [-2.98262937]
curr_Stock_Price:  105.32282451796848
curr_Factors:  [105.32282452]
mat_Sqrt:  [[0.15]]
grads:  [0.15525392]
Stock Position:  0.15525392019107043
Bond Position:  [-19.33441077]


portfolio before change:  [-2.79796028]
curr_Stock_Price:  106.52785718759245
curr_Factors:  [106.52785719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04527007]
Stock Position:  -0.04527007498121044
Bond Position:  [2.0245638]


portfolio before change:  [-2.79790071]
curr_Stock_Price:  106.53213186860494
curr_Factors:  [106.53213187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03777453]
Stock Position:  -0.037774533552838344
Bond Position:  [1.22630088]


portfolio before change:  [-2.77274832]
curr_Stock_Price:  105.87033438582361
curr_Factors:  [105.87033439]
mat_Sqrt:  [[0.15]]
grads:  [-0.0263046]
Stock Position:  -0.026304596196354762
Bond Position:  [0.01212807]


portfolio before change:  [-2.7965748]
curr_Stock_Price:  106.77618362428642
curr_Factors:  [106.77618362]
mat_Sqrt:  [[0.15]]
grads:  [0.04311378]
Stock Position:  0.04311377887938884
Bond Position:  [-7.40009957]


portfolio before change:  [-2.77505566]
curr_Stock_Price:  107.29676469195368
curr_Factors:  [107.29676469]
mat_Sqrt:  [[0.15]]
grads:  [0.23189841]
Stock Position:  0.2318984093869748
Bond Position:  [-27.65700472]


portfolio before change:  [-3.14502371]
curr_Stock_Price:  105.7162850466032
curr_Factors:  [105.71628505]
mat_Sqrt:  [[0.15]]
grads:  [-0.05803234]
Stock Position:  -0.058032339894123465
Bond Position:  [2.98993967]


portfolio before change:  [-3.18940731]
curr_Stock_Price:  106.48753372121071
curr_Factors:  [106.48753372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00761014]
Stock Position:  -0.007610143041444531
Bond Position:  [-2.37902195]


portfolio before change:  [-3.18614046]
curr_Stock_Price:  106.01917859688065
curr_Factors:  [106.0191786]
mat_Sqrt:  [[0.15]]
grads:  [-0.13739955]
Stock Position:  -0.13739955378538224
Bond Position:  [11.38084737]


portfolio before change:  [-3.33158129]
curr_Stock_Price:  107.08805779886745
curr_Factors:  [107.0880578]
mat_Sqrt:  [[0.15]]
grads:  [0.06091679]
Stock Position:  0.06091678871002308
Bond Position:  [-9.85504188]


portfolio before change:  [-3.30527591]
curr_Stock_Price:  107.54010612767459
curr_Factors:  [107.54010613]
mat_Sqrt:  [[0.15]]
grads:  [-0.02388396]
Stock Position:  -0.023883955885559874
Bond Position:  [-0.73679276]


portfolio before change:  [-3.34060071]
curr_Stock_Price:  109.01526749015906
curr_Factors:  [109.01526749]
mat_Sqrt:  [[0.15]]
grads:  [-0.12270041]
Stock Position:  -0.12270040622322287
Bond Position:  [10.0356169]


portfolio before change:  [-3.28412559]
curr_Stock_Price:  108.56522339709817
curr_Factors:  [108.5652234]
mat_Sqrt:  [[0.15]]
grads:  [0.03221348]
Stock Position:  0.032213477710182625
Bond Position:  [-6.78138899]


portfolio before change:  [-3.28992278]
curr_Stock_Price:  108.41157750217002
curr_Factors:  [108.4115775]
mat_Sqrt:  [[0.15]]
grads:  [0.04399496]
Stock Position:  0.043994958505685355
Bond Position:  [-8.05948563]


portfolio before change:  [-3.2907141]
curr_Stock_Price:  108.41649132334884
curr_Factors:  [108.41649132]
mat_Sqrt:  [[0.15]]
grads:  [0.03496147]
Stock Position:  0.034961469528706136
Bond Position:  [-7.08111395]


portfolio before change:  [-3.33976619]
curr_Stock_Price:  107.03877754733865
curr_Factors:  [107.03877755]
mat_Sqrt:  [[0.15]]
grads:  [0.03661901]
Stock Position:  0.03661900710616183
Bond Position:  [-7.25941994]


portfolio before change:  [-3.35962755]
curr_Stock_Price:  106.52118095616738
curr_Factors:  [106.52118096]
mat_Sqrt:  [[0.15]]
grads:  [0.03244513]
Stock Position:  0.032445132679632734
Bond Position:  [-6.8157214]


portfolio before change:  [-3.34197317]
curr_Stock_Price:  107.09157131327613
curr_Factors:  [107.09157131]
mat_Sqrt:  [[0.15]]
grads:  [-0.09832919]
Stock Position:  -0.09832919477159585
Bond Position:  [7.1882548]


portfolio before change:  [-3.32804651]
curr_Stock_Price:  106.9590768124705
curr_Factors:  [106.95907681]
mat_Sqrt:  [[0.15]]
grads:  [0.02550118]
Stock Position:  0.025501176660877246
Bond Position:  [-6.05562882]


portfolio before change:  [-3.30708686]
curr_Stock_Price:  107.81067084486824
curr_Factors:  [107.81067084]
mat_Sqrt:  [[0.15]]
grads:  [0.07921303]
Stock Position:  0.07921302704006822
Bond Position:  [-11.84709644]


portfolio before change:  [-3.29800119]
curr_Stock_Price:  107.94406623639631
curr_Factors:  [107.94406624]
mat_Sqrt:  [[0.15]]
grads:  [0.5024819]
Stock Position:  0.5024818998165209
Bond Position:  [-57.53794066]


portfolio before change:  [-3.50163903]
curr_Stock_Price:  107.55311652741653
curr_Factors:  [107.55311653]
mat_Sqrt:  [[0.15]]
grads:  [-0.13319948]
Stock Position:  -0.13319947800299894
Bond Position:  [10.82437995]


portfolio before change:  [-3.4448594]
curr_Stock_Price:  107.13700006485034
curr_Factors:  [107.13700006]
mat_Sqrt:  [[0.15]]
grads:  [-0.13215692]
Stock Position:  -0.13215692407915755
Bond Position:  [10.71403698]


portfolio before change:  [-3.29971073]
curr_Stock_Price:  106.04882903139263
curr_Factors:  [106.04882903]
mat_Sqrt:  [[0.15]]
grads:  [0.10328578]
Stock Position:  0.10328577901798401
Bond Position:  [-14.25304665]


portfolio before change:  [-3.33377653]
curr_Stock_Price:  105.73625877151709
curr_Factors:  [105.73625877]
mat_Sqrt:  [[0.15]]
grads:  [0.13295679]
Stock Position:  0.1329567896558814
Bond Position:  [-17.39213005]


portfolio before change:  [-3.506057]
curr_Stock_Price:  104.45684824150112
curr_Factors:  [104.45684824]
mat_Sqrt:  [[0.15]]
grads:  [0.06596108]
Stock Position:  0.06596107579955829
Bond Position:  [-10.39614309]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.46448665]
Stock Price:  105.10677622668648
PL:  [-8.57126288]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.28698164e-02]
 [ 2.50514429e-02]
 [-3.83492508e-03]
 [-6.73638663e-03]
 [-7.58018718e-03]
 [ 2.81921431e-02]
 [ 3.71324371e-03]
 [ 9.99852480e-03]
 [-1.37969289e-02]
 [ 2.30613341e-02]
 [ 1.99483361e-02]
 [-1.31307045e-02]
 [ 2.95509310e-02]
 [ 2.03516407e-02]
 [-7.44833287e-03]
 [-2.85150658e-03]
 [-6.10042335e-03]
 [ 5.43574868e-03]
 [ 6.44731348e-03]
 [-1.03437626e-02]
 [-3.73536335e-03]
 [-1.15076018e-02]
 [ 6.85055780e-03]
 [-6.43643844e-03]
 [ 1.43508082e-02]
 [ 6.84014844e-03]
 [ 7.03313643e-03]
 [-2.80630142e-03]
 [-1.25907816e-03]
 [-1.39614625e-02]
 [ 2.32765684e-02]
 [ 6.76138780e-03]
 [-1.02458932e-02]
 [-3.82738434e-02]
 [-2.22533942e-02]
 [ 3.57234959e-02]
 [ 3.93752091e-03]
 [ 8.56230709e-03]
 [ 5.52891991e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.07866507]
curr_Stock_Price:  100.0542968189018
curr_Factors:  [100.05429682]
mat_Sqrt:  [[0.15]]
grads:  [0.15246544]
Stock Position:  0.1524654427868546
Bond Position:  [-12.1761576]


portfolio before change:  [2.93330754]
curr_Stock_Price:  99.1108999861691
curr_Factors:  [99.11089999]
mat_Sqrt:  [[0.15]]
grads:  [0.16700962]
Stock Position:  0.16700961952421245
Bond Position:  [-13.61916616]


portfolio before change:  [3.02074014]
curr_Stock_Price:  99.64461235197432
curr_Factors:  [99.64461235]
mat_Sqrt:  [[0.15]]
grads:  [-0.02556617]
Stock Position:  -0.02556616722609848
Bond Position:  [5.56827096]


portfolio before change:  [3.01804709]
curr_Stock_Price:  99.77717533806936
curr_Factors:  [99.77717534]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490924]
Stock Position:  -0.044909244219735564
Bond Position:  [7.49896462]


portfolio before change:  [3.03265398]
curr_Stock_Price:  99.47279565703077
curr_Factors:  [99.47279566]
mat_Sqrt:  [[0.15]]
grads:  [-0.05053458]
Stock Position:  -0.0505345811957053
Bond Position:  [8.05947005]


portfolio before change:  [3.01576346]
curr_Stock_Price:  99.8269692939904
curr_Factors:  [99.82696929]
mat_Sqrt:  [[0.15]]
grads:  [0.18794762]
Stock Position:  0.18794762047530086
Bond Position:  [-15.74647788]


portfolio before change:  [3.14415794]
curr_Stock_Price:  100.52058228607376
curr_Factors:  [100.52058229]
mat_Sqrt:  [[0.15]]
grads:  [0.02475496]
Stock Position:  0.02475495809914271
Bond Position:  [0.65577513]


portfolio before change:  [3.16752665]
curr_Stock_Price:  101.461272104803
curr_Factors:  [101.4612721]
mat_Sqrt:  [[0.15]]
grads:  [0.06665683]
Stock Position:  0.06665683200691469
Bond Position:  [-3.59556032]


portfolio before change:  [3.16639668]
curr_Stock_Price:  101.45106315386917
curr_Factors:  [101.45106315]
mat_Sqrt:  [[0.15]]
grads:  [-0.09197953]
Stock Position:  -0.09197952617914755
Bond Position:  [12.4978174]


portfolio before change:  [3.17381858]
curr_Stock_Price:  101.38735788624832
curr_Factors:  [101.38735789]
mat_Sqrt:  [[0.15]]
grads:  [0.15374223]
Stock Position:  0.15374222728847398
Bond Position:  [-12.41369964]


portfolio before change:  [3.12743015]
curr_Stock_Price:  101.09572280894619
curr_Factors:  [101.09572281]
mat_Sqrt:  [[0.15]]
grads:  [0.13298891]
Stock Position:  0.13298890750816497
Bond Position:  [-10.31717958]


portfolio before change:  [3.13762587]
curr_Stock_Price:  101.18208676336509
curr_Factors:  [101.18208676]
mat_Sqrt:  [[0.15]]
grads:  [-0.08753803]
Stock Position:  -0.08753802996608967
Bond Position:  [11.99490641]


portfolio before change:  [3.15861626]
curr_Stock_Price:  100.95942999170255
curr_Factors:  [100.95942999]
mat_Sqrt:  [[0.15]]
grads:  [0.19700621]
Stock Position:  0.19700620676720293
Bond Position:  [-16.73101808]


portfolio before change:  [3.28705508]
curr_Stock_Price:  101.62199959119427
curr_Factors:  [101.62199959]
mat_Sqrt:  [[0.15]]
grads:  [0.1356776]
Stock Position:  0.13567760477022078
Bond Position:  [-10.50077442]


portfolio before change:  [3.2583222]
curr_Stock_Price:  101.41990138165293
curr_Factors:  [101.41990138]
mat_Sqrt:  [[0.15]]
grads:  [-0.04965555]
Stock Position:  -0.049655552439499984
Bond Position:  [8.29438343]


portfolio before change:  [3.23078754]
curr_Stock_Price:  101.99529573581694
curr_Factors:  [101.99529574]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901004]
Stock Position:  -0.019010043856212078
Bond Position:  [5.16972258]


portfolio before change:  [3.26382265]
curr_Stock_Price:  100.29151947820236
curr_Factors:  [100.29151948]
mat_Sqrt:  [[0.15]]
grads:  [-0.04066949]
Stock Position:  -0.04066948897934731
Bond Position:  [7.3426275]


portfolio before change:  [3.26480423]
curr_Stock_Price:  100.28995339363595
curr_Factors:  [100.28995339]
mat_Sqrt:  [[0.15]]
grads:  [0.03623832]
Stock Position:  0.03623832451630447
Bond Position:  [-0.36953565]


portfolio before change:  [3.2627439]
curr_Stock_Price:  100.23437324509541
curr_Factors:  [100.23437325]
mat_Sqrt:  [[0.15]]
grads:  [0.04298209]
Stock Position:  0.042982089866166986
Bond Position:  [-1.04553894]


portfolio before change:  [3.24759433]
curr_Stock_Price:  99.8849516309318
curr_Factors:  [99.88495163]
mat_Sqrt:  [[0.15]]
grads:  [-0.06895842]
Stock Position:  -0.06895841760168452
Bond Position:  [10.13550254]


portfolio before change:  [3.26479918]
curr_Stock_Price:  99.65382932855175
curr_Factors:  [99.65382933]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490242]
Stock Position:  -0.024902422305317612
Bond Position:  [5.74642092]


portfolio before change:  [3.29239671]
curr_Stock_Price:  98.5744490614689
curr_Factors:  [98.57444906]
mat_Sqrt:  [[0.15]]
grads:  [-0.07671735]
Stock Position:  -0.07671734561600331
Bond Position:  [10.85476679]


portfolio before change:  [3.2638371]
curr_Stock_Price:  98.96440707075729
curr_Factors:  [98.96440707]
mat_Sqrt:  [[0.15]]
grads:  [0.04567039]
Stock Position:  0.045670385357362
Bond Position:  [-1.25590551]


portfolio before change:  [3.27964756]
curr_Stock_Price:  99.31403115976714
curr_Factors:  [99.31403116]
mat_Sqrt:  [[0.15]]
grads:  [-0.04290959]
Stock Position:  -0.04290958960748373
Bond Position:  [7.54117188]


portfolio before change:  [3.32358742]
curr_Stock_Price:  98.31199048745916
curr_Factors:  [98.31199049]
mat_Sqrt:  [[0.15]]
grads:  [0.09567205]
Stock Position:  0.09567205453853801
Bond Position:  [-6.08212269]


portfolio before change:  [3.33353241]
curr_Stock_Price:  98.42388629889562
curr_Factors:  [98.4238863]
mat_Sqrt:  [[0.15]]
grads:  [0.04560099]
Stock Position:  0.045600989606904854
Bond Position:  [-1.1546942]


portfolio before change:  [3.30059091]
curr_Stock_Price:  97.70466608093137
curr_Factors:  [97.70466608]
mat_Sqrt:  [[0.15]]
grads:  [0.04688758]
Stock Position:  0.046887576221987554
Bond Position:  [-1.28054406]


portfolio before change:  [3.35194852]
curr_Stock_Price:  98.80341514786217
curr_Factors:  [98.80341515]
mat_Sqrt:  [[0.15]]
grads:  [-0.01870868]
Stock Position:  -0.01870867614941507
Bond Position:  [5.20042961]


portfolio before change:  [3.34474304]
curr_Stock_Price:  99.22330420835196
curr_Factors:  [99.22330421]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839385]
Stock Position:  -0.00839385441580534
Bond Position:  [4.17760901]


portfolio before change:  [3.34711716]
curr_Stock_Price:  99.00268039684796
curr_Factors:  [99.0026804]
mat_Sqrt:  [[0.15]]
grads:  [-0.09307642]
Stock Position:  -0.09307641660512778
Bond Position:  [12.56193189]


portfolio before change:  [3.4575141]
curr_Stock_Price:  97.8334625860161
curr_Factors:  [97.83346259]
mat_Sqrt:  [[0.15]]
grads:  [0.15517712]
Stock Position:  0.15517712283233998
Bond Position:  [-11.72400114]


portfolio before change:  [3.34926952]
curr_Stock_Price:  97.14535216506154
curr_Factors:  [97.14535217]
mat_Sqrt:  [[0.15]]
grads:  [0.04507592]
Stock Position:  0.04507591869793817
Bond Position:  [-1.02964648]


portfolio before change:  [3.41391772]
curr_Stock_Price:  98.58241468547594
curr_Factors:  [98.58241469]
mat_Sqrt:  [[0.15]]
grads:  [-0.06830595]
Stock Position:  -0.06830595476412903
Bond Position:  [10.14768367]


portfolio before change:  [3.38290444]
curr_Stock_Price:  99.05502079131296
curr_Factors:  [99.05502079]
mat_Sqrt:  [[0.15]]
grads:  [-0.25515896]
Stock Position:  -0.2551589563003997
Bond Position:  [28.65768017]


portfolio before change:  [3.57168938]
curr_Stock_Price:  98.32918891688553
curr_Factors:  [98.32918892]
mat_Sqrt:  [[0.15]]
grads:  [-0.14835596]
Stock Position:  -0.1483559612943726
Bond Position:  [18.15941073]


portfolio before change:  [3.46686542]
curr_Stock_Price:  99.05106099588332
curr_Factors:  [99.051061]
mat_Sqrt:  [[0.15]]
grads:  [0.23815664]
Stock Position:  0.23815663943450213
Bond Position:  [-20.1228024]


portfolio before change:  [3.77033826]
curr_Stock_Price:  100.33588069638435
curr_Factors:  [100.3358807]
mat_Sqrt:  [[0.15]]
grads:  [0.02625014]
Stock Position:  0.026250139373272554
Bond Position:  [1.13650741]


portfolio before change:  [3.75271779]
curr_Stock_Price:  99.65921606531491
curr_Factors:  [99.65921607]
mat_Sqrt:  [[0.15]]
grads:  [0.05708205]
Stock Position:  0.0570820472509246
Bond Position:  [-1.93603429]


portfolio before change:  [3.7544892]
curr_Stock_Price:  99.69448856964063
curr_Factors:  [99.69448857]
mat_Sqrt:  [[0.15]]
grads:  [0.03685947]
Stock Position:  0.03685946609639278
Bond Position:  [0.07980358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.72864881]
Stock Price:  98.99316645984062
PL:  [3.72864881]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.23290109e-02]
 [-4.44175577e-03]
 [-1.48968968e-02]
 [-7.94625289e-03]
 [-6.01927660e-03]
 [ 3.14076284e-02]
 [ 3.59140241e-03]
 [-2.24751342e-04]
 [-2.21652833e-02]
 [ 2.34461886e-02]
 [ 2.14566812e-02]
 [-1.29990856e-02]
 [ 9.94178449e-03]
 [ 6.29476055e-03]
 [-8.21564906e-03]
 [-1.29473735e-03]
 [-6.02765923e-03]
 [ 1.61960887e-03]
 [ 8.24369826e-04]
 [ 3.49291114e-03]
 [-1.42808664e-02]
 [-2.15590985e-02]
 [ 4.52161707e-03]
 [-1.09031894e-02]
 [ 1.17251287e-02]
 [ 2.72890809e-03]
 [ 2.18238310e-02]
 [-4.27926781e-03]
 [-1.67807682e-02]
 [-1.21735724e-02]
 [ 3.98202025e-02]
 [ 2.81658808e-03]
 [-1.20321452e-02]
 [-4.51787495e-02]
 [-2.17473796e-02]
 [ 3.84091631e-02]
 [ 3.22673078e-03]
 [ 9.66931990e-03]
 [ 7.45642369e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.10808235]
curr_Stock_Price:  99.49923859373328
curr_Factors:  [99.49923859]
mat_Sqrt:  [[0.15]]
grads:  [-0.08219341]
Stock Position:  -0.08219340583772314
Bond Position:  [-0.92990106]


portfolio before change:  [-8.97507665]
curr_Stock_Price:  97.87962020031196
curr_Factors:  [97.8796202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961171]
Stock Position:  -0.029611705122550108
Bond Position:  [-6.0766942]


portfolio before change:  [-8.97688023]
curr_Stock_Price:  97.9148748900271
curr_Factors:  [97.91487489]
mat_Sqrt:  [[0.15]]
grads:  [-0.09931265]
Stock Position:  -0.09931264545909987
Bond Position:  [0.74730502]


portfolio before change:  [-8.98197098]
curr_Stock_Price:  97.96707535355853
curr_Factors:  [97.96707535]
mat_Sqrt:  [[0.15]]
grads:  [-0.05297502]
Stock Position:  -0.05297501928987976
Bond Position:  [-3.79216327]


portfolio before change:  [-9.00924249]
curr_Stock_Price:  98.47292618905358
curr_Factors:  [98.47292619]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012851]
Stock Position:  -0.040128510688603625
Bond Position:  [-5.05767062]


portfolio before change:  [-9.02813246]
curr_Stock_Price:  98.92790745805151
curr_Factors:  [98.92790746]
mat_Sqrt:  [[0.15]]
grads:  [0.20938419]
Stock Position:  0.2093841894604928
Bond Position:  [-29.74207218]


portfolio before change:  [-8.87885881]
curr_Stock_Price:  99.65858171016586
curr_Factors:  [99.65858171]
mat_Sqrt:  [[0.15]]
grads:  [0.02394268]
Stock Position:  0.023942682760281137
Bond Position:  [-11.26495262]


portfolio before change:  [-8.87868474]
curr_Stock_Price:  99.72466804549055
curr_Factors:  [99.72466805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00149834]
Stock Position:  -0.0014983422823040683
Bond Position:  [-8.72926305]


portfolio before change:  [-8.87819832]
curr_Stock_Price:  98.67174234836625
curr_Factors:  [98.67174235]
mat_Sqrt:  [[0.15]]
grads:  [-0.14776856]
Stock Position:  -0.14776855514710285
Bond Position:  [5.70238248]


portfolio before change:  [-8.61152579]
curr_Stock_Price:  96.87190285528935
curr_Factors:  [96.87190286]
mat_Sqrt:  [[0.15]]
grads:  [0.15630792]
Stock Position:  0.15630792379868802
Bond Position:  [-23.7533718]


portfolio before change:  [-8.58335933]
curr_Stock_Price:  97.07109824502746
curr_Factors:  [97.07109825]
mat_Sqrt:  [[0.15]]
grads:  [0.14304454]
Stock Position:  0.1430445414943625
Bond Position:  [-22.46885007]


portfolio before change:  [-8.36139155]
curr_Stock_Price:  98.64247291272679
curr_Factors:  [98.64247291]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666057]
Stock Position:  -0.08666057080457447
Bond Position:  [0.18702146]


portfolio before change:  [-8.3865172]
curr_Stock_Price:  98.93267449157099
curr_Factors:  [98.93267449]
mat_Sqrt:  [[0.15]]
grads:  [0.06627856]
Stock Position:  0.06627856325739373
Bond Position:  [-14.94363273]


portfolio before change:  [-8.40364245]
curr_Stock_Price:  98.70247676945989
curr_Factors:  [98.70247677]
mat_Sqrt:  [[0.15]]
grads:  [0.04196507]
Stock Position:  0.041965070337172075
Bond Position:  [-12.54569883]


portfolio before change:  [-8.37529682]
curr_Stock_Price:  99.41530612241388
curr_Factors:  [99.41530612]
mat_Sqrt:  [[0.15]]
grads:  [-0.05477099]
Stock Position:  -0.05477099370394804
Bond Position:  [-2.93022172]


portfolio before change:  [-8.36422507]
curr_Stock_Price:  99.20647197350216
curr_Factors:  [99.20647197]
mat_Sqrt:  [[0.15]]
grads:  [-0.00863158]
Stock Position:  -0.008631582331153695
Bond Position:  [-7.50791624]


portfolio before change:  [-8.35744532]
curr_Stock_Price:  98.31227874007054
curr_Factors:  [98.31227874]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018439]
Stock Position:  -0.04018439485443957
Bond Position:  [-4.40682589]


portfolio before change:  [-8.32952141]
curr_Stock_Price:  97.60367550761715
curr_Factors:  [97.60367551]
mat_Sqrt:  [[0.15]]
grads:  [0.01079739]
Stock Position:  0.010797392477392913
Bond Position:  [-9.3833866]


portfolio before change:  [-8.33689544]
curr_Stock_Price:  97.02936766495365
curr_Factors:  [97.02936766]
mat_Sqrt:  [[0.15]]
grads:  [0.0054958]
Stock Position:  0.005495798840517661
Bond Position:  [-8.87014932]


portfolio before change:  [-8.347568]
curr_Stock_Price:  95.2891794320943
curr_Factors:  [95.28917943]
mat_Sqrt:  [[0.15]]
grads:  [0.02328607]
Stock Position:  0.023286074276698245
Bond Position:  [-10.56647891]


portfolio before change:  [-8.34240371]
curr_Stock_Price:  95.56767976476922
curr_Factors:  [95.56767976]
mat_Sqrt:  [[0.15]]
grads:  [-0.09520578]
Stock Position:  -0.0952057762340403
Bond Position:  [0.75619142]


portfolio before change:  [-8.35747208]
curr_Stock_Price:  95.7269442214281
curr_Factors:  [95.72694422]
mat_Sqrt:  [[0.15]]
grads:  [-0.14372732]
Stock Position:  -0.14372732313727496
Bond Position:  [5.40110537]


portfolio before change:  [-8.2805915]
curr_Stock_Price:  95.19673609527746
curr_Factors:  [95.1967361]
mat_Sqrt:  [[0.15]]
grads:  [0.03014411]
Stock Position:  0.030144113775577634
Bond Position:  [-11.15021275]


portfolio before change:  [-8.2701315]
curr_Stock_Price:  95.58997599749861
curr_Factors:  [95.589976]
mat_Sqrt:  [[0.15]]
grads:  [-0.07268793]
Stock Position:  -0.07268792952814386
Bond Position:  [-1.32189406]


portfolio before change:  [-8.28948323]
curr_Stock_Price:  95.85393291787307
curr_Factors:  [95.85393292]
mat_Sqrt:  [[0.15]]
grads:  [0.07816752]
Stock Position:  0.07816752474677507
Bond Position:  [-15.7821479]


portfolio before change:  [-8.22594531]
curr_Stock_Price:  96.69201503618663
curr_Factors:  [96.69201504]
mat_Sqrt:  [[0.15]]
grads:  [0.01819272]
Stock Position:  0.0181927205791706
Bond Position:  [-9.98503613]


portfolio before change:  [-8.24210072]
curr_Stock_Price:  95.87261049983786
curr_Factors:  [95.8726105]
mat_Sqrt:  [[0.15]]
grads:  [0.14549221]
Stock Position:  0.14549220661351872
Bond Position:  [-22.19081837]


portfolio before change:  [-8.21978894]
curr_Stock_Price:  96.04503078077511
curr_Factors:  [96.04503078]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852845]
Stock Position:  -0.028528452041898095
Bond Position:  [-5.47977288]


portfolio before change:  [-8.25395472]
curr_Stock_Price:  97.21862289460536
curr_Factors:  [97.21862289]
mat_Sqrt:  [[0.15]]
grads:  [-0.11187179]
Stock Position:  -0.1118717877692646
Bond Position:  [2.62206643]


portfolio before change:  [-8.19277379]
curr_Stock_Price:  96.67466852205716
curr_Factors:  [96.67466852]
mat_Sqrt:  [[0.15]]
grads:  [-0.08115715]
Stock Position:  -0.08115714911585131
Bond Position:  [-0.3469333]


portfolio before change:  [-8.16862766]
curr_Stock_Price:  96.376611027332
curr_Factors:  [96.37661103]
mat_Sqrt:  [[0.15]]
grads:  [0.26546802]
Stock Position:  0.2654680169475717
Bond Position:  [-33.75353547]


portfolio before change:  [-8.30977646]
curr_Stock_Price:  95.86080749434876
curr_Factors:  [95.86080749]
mat_Sqrt:  [[0.15]]
grads:  [0.01877725]
Stock Position:  0.018777253893635725
Bond Position:  [-10.10977918]


portfolio before change:  [-8.27498183]
curr_Stock_Price:  97.7811324915184
curr_Factors:  [97.78113249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0802143]
Stock Position:  -0.08021430163292478
Bond Position:  [-0.43153658]


portfolio before change:  [-8.3080264]
curr_Stock_Price:  98.19241354282956
curr_Factors:  [98.19241354]
mat_Sqrt:  [[0.15]]
grads:  [-0.30119166]
Stock Position:  -0.30119166326372376
Bond Position:  [21.26670995]


portfolio before change:  [-8.66521252]
curr_Stock_Price:  99.38714988997206
curr_Factors:  [99.38714989]
mat_Sqrt:  [[0.15]]
grads:  [-0.14498253]
Stock Position:  -0.14498253064479255
Bond Position:  [5.74418798]


portfolio before change:  [-8.42126794]
curr_Stock_Price:  97.70952355882004
curr_Factors:  [97.70952356]
mat_Sqrt:  [[0.15]]
grads:  [0.25606109]
Stock Position:  0.2560610870520594
Bond Position:  [-33.44087476]


portfolio before change:  [-7.90391693]
curr_Stock_Price:  99.74626952298665
curr_Factors:  [99.74626952]
mat_Sqrt:  [[0.15]]
grads:  [0.02151154]
Stock Position:  0.021511538505475873
Bond Position:  [-10.04961265]


portfolio before change:  [-7.89092956]
curr_Stock_Price:  100.40840944865228
curr_Factors:  [100.40840945]
mat_Sqrt:  [[0.15]]
grads:  [0.06446213]
Stock Position:  0.0644621326961232
Bond Position:  [-14.36346977]


portfolio before change:  [-7.87725364]
curr_Stock_Price:  100.6484180648105
curr_Factors:  [100.64841806]
mat_Sqrt:  [[0.15]]
grads:  [0.04970949]
Stock Position:  0.049709491261548944
Bond Position:  [-12.8804353]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.86448431]
Stock Price:  100.93768850423223
PL:  [-8.80217281]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 7.07720897e-03]
 [ 4.41316461e-02]
 [-2.72904568e-03]
 [-6.61380388e-03]
 [-7.72145021e-03]
 [ 2.77355294e-02]
 [ 3.54362739e-03]
 [ 5.13865686e-04]
 [-1.96661036e-02]
 [ 2.28911103e-02]
 [ 1.73023231e-02]
 [-6.67594688e-03]
 [ 1.09558926e-03]
 [ 2.33409462e-02]
 [-1.13818506e-02]
 [-2.96799363e-03]
 [-6.13040677e-03]
 [ 3.28903588e-03]
 [ 5.88371350e-03]
 [ 1.18087363e-02]
 [-3.23495876e-03]
 [-4.62684489e-03]
 [ 6.91971670e-03]
 [-7.39431704e-03]
 [ 1.10489464e-02]
 [ 8.10594843e-03]
 [-6.57001098e-03]
 [-3.00971847e-03]
 [-6.62635279e-03]
 [-1.22709263e-02]
 [-9.44013480e-03]
 [ 1.48532606e-02]
 [-9.76006630e-03]
 [-2.97923468e-02]
 [-2.13711600e-02]
 [ 2.66003229e-02]
 [ 3.97051070e-03]
 [ 8.84018405e-03]
 [ 5.79246293e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.56040034]
curr_Stock_Price:  100.30396821554204
curr_Factors:  [100.30396822]
mat_Sqrt:  [[0.15]]
grads:  [0.04718139]
Stock Position:  0.04718139311970062
Bond Position:  [3.82791938]


portfolio before change:  [8.5610435]
curr_Stock_Price:  100.30745778344478
curr_Factors:  [100.30745778]
mat_Sqrt:  [[0.15]]
grads:  [0.29421097]
Stock Position:  0.29421097388788053
Bond Position:  [-20.95051134]


portfolio before change:  [8.38649195]
curr_Stock_Price:  99.72307245309395
curr_Factors:  [99.72307245]
mat_Sqrt:  [[0.15]]
grads:  [-0.01819364]
Stock Position:  -0.018193637881649058
Bond Position:  [10.20081742]


portfolio before change:  [8.38580056]
curr_Stock_Price:  99.83116330566241
curr_Factors:  [99.83116331]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409203]
Stock Position:  -0.04409202583385084
Bond Position:  [12.78755879]


portfolio before change:  [8.36806291]
curr_Stock_Price:  100.26970520002091
curr_Factors:  [100.2697052]
mat_Sqrt:  [[0.15]]
grads:  [-0.05147633]
Stock Position:  -0.0514763347150703
Bond Position:  [13.52957981]


portfolio before change:  [8.39707371]
curr_Stock_Price:  99.73898561102557
curr_Factors:  [99.73898561]
mat_Sqrt:  [[0.15]]
grads:  [0.18490353]
Stock Position:  0.1849035292153947
Bond Position:  [-10.04501673]


portfolio before change:  [8.30252288]
curr_Stock_Price:  99.23442455108331
curr_Factors:  [99.23442455]
mat_Sqrt:  [[0.15]]
grads:  [0.02362418]
Stock Position:  0.02362418259783332
Bond Position:  [5.95819072]


portfolio before change:  [8.31614739]
curr_Stock_Price:  99.77961523557025
curr_Factors:  [99.77961524]
mat_Sqrt:  [[0.15]]
grads:  [0.00342577]
Stock Position:  0.0034257712423977835
Bond Position:  [7.97432525]


portfolio before change:  [8.32101018]
curr_Stock_Price:  100.90810282997265
curr_Factors:  [100.90810283]
mat_Sqrt:  [[0.15]]
grads:  [-0.13110736]
Stock Position:  -0.13110735757870137
Bond Position:  [21.5508049]


portfolio before change:  [8.15792827]
curr_Stock_Price:  102.17253171315977
curr_Factors:  [102.17253171]
mat_Sqrt:  [[0.15]]
grads:  [0.1526074]
Stock Position:  0.15260740206452167
Bond Position:  [-7.43435636]


portfolio before change:  [8.27275668]
curr_Stock_Price:  102.93106479063536
curr_Factors:  [102.93106479]
mat_Sqrt:  [[0.15]]
grads:  [0.11534882]
Stock Position:  0.11534882092288495
Bond Position:  [-3.60022028]


portfolio before change:  [8.20514623]
curr_Stock_Price:  102.34882739554345
curr_Factors:  [102.3488274]
mat_Sqrt:  [[0.15]]
grads:  [-0.04450631]
Stock Position:  -0.044506312537239606
Bond Position:  [12.76031513]


portfolio before change:  [8.1500803]
curr_Stock_Price:  103.62192920796846
curr_Factors:  [103.62192921]
mat_Sqrt:  [[0.15]]
grads:  [0.00730393]
Stock Position:  0.007303928410192287
Bond Position:  [7.39323315]


portfolio before change:  [8.15336191]
curr_Stock_Price:  103.94468643241932
curr_Factors:  [103.94468643]
mat_Sqrt:  [[0.15]]
grads:  [0.15560631]
Stock Position:  0.1556063077222507
Bond Position:  [-8.02108696]


portfolio before change:  [7.95800571]
curr_Stock_Price:  102.6956785935775
curr_Factors:  [102.69567859]
mat_Sqrt:  [[0.15]]
grads:  [-0.075879]
Stock Position:  -0.07587900395612439
Bond Position:  [15.75045151]


portfolio before change:  [8.03576906]
curr_Stock_Price:  101.69679333728466
curr_Factors:  [101.69679334]
mat_Sqrt:  [[0.15]]
grads:  [-0.01978662]
Stock Position:  -0.019786624178729877
Bond Position:  [10.04800529]


portfolio before change:  [8.08078061]
curr_Stock_Price:  99.4854270397567
curr_Factors:  [99.48542704]
mat_Sqrt:  [[0.15]]
grads:  [-0.04086938]
Stock Position:  -0.04086937843943286
Bond Position:  [12.14668818]


portfolio before change:  [8.11698284]
curr_Stock_Price:  98.63677698151552
curr_Factors:  [98.63677698]
mat_Sqrt:  [[0.15]]
grads:  [0.02192691]
Stock Position:  0.021926905867123647
Bond Position:  [5.95418352]


portfolio before change:  [8.1345434]
curr_Stock_Price:  99.40369937511446
curr_Factors:  [99.40369938]
mat_Sqrt:  [[0.15]]
grads:  [0.03922476]
Stock Position:  0.039224756654458764
Bond Position:  [4.23545748]


portfolio before change:  [8.20497772]
curr_Stock_Price:  101.18586093363388
curr_Factors:  [101.18586093]
mat_Sqrt:  [[0.15]]
grads:  [0.07872491]
Stock Position:  0.07872490868107582
Bond Position:  [0.23913005]


portfolio before change:  [8.06687221]
curr_Stock_Price:  99.431201502535
curr_Factors:  [99.4312015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156639]
Stock Position:  -0.021566391734172765
Bond Position:  [10.21124445]


portfolio before change:  [8.04828988]
curr_Stock_Price:  100.3520237015041
curr_Factors:  [100.3520237]
mat_Sqrt:  [[0.15]]
grads:  [-0.03084563]
Stock Position:  -0.03084563262284263
Bond Position:  [11.14371153]


portfolio before change:  [8.05315891]
curr_Stock_Price:  100.23933412579994
curr_Factors:  [100.23933413]
mat_Sqrt:  [[0.15]]
grads:  [0.04613144]
Stock Position:  0.04613144464791959
Bond Position:  [3.42897362]


portfolio before change:  [8.02977567]
curr_Stock_Price:  99.72315929749517
curr_Factors:  [99.7231593]
mat_Sqrt:  [[0.15]]
grads:  [-0.04929545]
Stock Position:  -0.0492954469273555
Bond Position:  [12.94567338]


portfolio before change:  [8.00527349]
curr_Stock_Price:  100.25303550444568
curr_Factors:  [100.2530355]
mat_Sqrt:  [[0.15]]
grads:  [0.07365964]
Stock Position:  0.07365964268274484
Bond Position:  [0.62067072]


portfolio before change:  [7.99389203]
curr_Stock_Price:  100.09746796846547
curr_Factors:  [100.09746797]
mat_Sqrt:  [[0.15]]
grads:  [0.05403966]
Stock Position:  0.05403965620415446
Bond Position:  [2.58465928]


portfolio before change:  [7.97819465]
curr_Stock_Price:  99.80101006900894
curr_Factors:  [99.80101007]
mat_Sqrt:  [[0.15]]
grads:  [-0.04380007]
Stock Position:  -0.04380007317689062
Bond Position:  [12.3494862]


portfolio before change:  [8.04128365]
curr_Stock_Price:  98.39587063516599
curr_Factors:  [98.39587064]
mat_Sqrt:  [[0.15]]
grads:  [-0.02006479]
Stock Position:  -0.020064789772778476
Bond Position:  [10.01557611]


portfolio before change:  [8.0376065]
curr_Stock_Price:  98.64153349412157
curr_Factors:  [98.64153349]
mat_Sqrt:  [[0.15]]
grads:  [-0.04417569]
Stock Position:  -0.044175685276485466
Bond Position:  [12.39516384]


portfolio before change:  [8.00389008]
curr_Stock_Price:  99.43984387821443
curr_Factors:  [99.43984388]
mat_Sqrt:  [[0.15]]
grads:  [-0.08180618]
Stock Position:  -0.08180617506415465
Bond Position:  [16.13868336]


portfolio before change:  [8.00180502]
curr_Stock_Price:  99.48999314445227
curr_Factors:  [99.48999314]
mat_Sqrt:  [[0.15]]
grads:  [-0.06293423]
Stock Position:  -0.06293423202842975
Bond Position:  [14.26313134]


portfolio before change:  [8.02317699]
curr_Stock_Price:  99.1787322240463
curr_Factors:  [99.17873222]
mat_Sqrt:  [[0.15]]
grads:  [0.09902174]
Stock Position:  0.09902173726934203
Bond Position:  [-1.79767337]


portfolio before change:  [7.98688342]
curr_Stock_Price:  98.81448042497719
curr_Factors:  [98.81448042]
mat_Sqrt:  [[0.15]]
grads:  [-0.06506711]
Stock Position:  -0.0650671086492136
Bond Position:  [14.41645596]


portfolio before change:  [7.93398864]
curr_Stock_Price:  99.65510406896574
curr_Factors:  [99.65510407]
mat_Sqrt:  [[0.15]]
grads:  [-0.19861565]
Stock Position:  -0.19861564560688463
Bond Position:  [27.72705148]


portfolio before change:  [7.8178025]
curr_Stock_Price:  100.2575351641781
curr_Factors:  [100.25753516]
mat_Sqrt:  [[0.15]]
grads:  [-0.1424744]
Stock Position:  -0.1424743997400556
Bond Position:  [22.10193464]


portfolio before change:  [7.68915006]
curr_Stock_Price:  101.17991392412137
curr_Factors:  [101.17991392]
mat_Sqrt:  [[0.15]]
grads:  [0.17733549]
Stock Position:  0.17733548576351174
Bond Position:  [-10.25363913]


portfolio before change:  [7.543488]
curr_Stock_Price:  100.36574937160542
curr_Factors:  [100.36574937]
mat_Sqrt:  [[0.15]]
grads:  [0.02647007]
Stock Position:  0.026470071327627534
Bond Position:  [4.88679946]


portfolio before change:  [7.53272381]
curr_Stock_Price:  99.93601578212837
curr_Factors:  [99.93601578]
mat_Sqrt:  [[0.15]]
grads:  [0.05893456]
Stock Position:  0.058934560328137084
Bond Position:  [1.64303866]


portfolio before change:  [7.52697672]
curr_Stock_Price:  99.83501413751704
curr_Factors:  [99.83501414]
mat_Sqrt:  [[0.15]]
grads:  [0.03861642]
Stock Position:  0.038616419536308004
Bond Position:  [3.67170593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.57740632]
Stock Price:  101.12903903069099
PL:  [6.44836729]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.16018864e-03]
 [ 4.12942237e-02]
 [-1.52966172e-02]
 [-2.13171535e-03]
 [-4.40537212e-03]
 [ 3.26848294e-02]
 [ 3.71966635e-03]
 [ 7.00012056e-03]
 [-2.53077592e-02]
 [ 2.33998254e-02]
 [ 1.91641764e-02]
 [-1.49196166e-02]
 [ 1.26325092e-04]
 [ 1.11622518e-02]
 [-1.45765008e-02]
 [-1.39195703e-03]
 [-6.04897754e-03]
 [ 2.21327807e-03]
 [ 5.07272699e-03]
 [-2.88124057e-02]
 [-2.74816327e-03]
 [-4.53267241e-03]
 [ 6.93389731e-03]
 [-1.06145325e-02]
 [ 1.53752198e-02]
 [ 6.78291638e-03]
 [ 9.69307557e-03]
 [-3.80431398e-03]
 [-1.70455344e-02]
 [-1.26312733e-02]
 [ 4.48784470e-02]
 [ 1.89691736e-03]
 [-1.72336896e-02]
 [-4.78329448e-02]
 [-2.24877254e-02]
 [ 3.87710509e-02]
 [-3.53201637e-04]
 [ 4.33346812e-03]
 [ 4.80988017e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.81404469]
curr_Stock_Price:  99.37599269410738
curr_Factors:  [99.37599269]
mat_Sqrt:  [[0.15]]
grads:  [-0.06106792]
Stock Position:  -0.06106792424971438
Bond Position:  [-5.74535909]


portfolio before change:  [-11.8530742]
curr_Stock_Price:  100.00334811481417
curr_Factors:  [100.00334811]
mat_Sqrt:  [[0.15]]
grads:  [0.27529482]
Stock Position:  0.2752948244767372
Bond Position:  [-39.38347836]


portfolio before change:  [-12.11598468]
curr_Stock_Price:  99.06621739365632
curr_Factors:  [99.06621739]
mat_Sqrt:  [[0.15]]
grads:  [-0.10197745]
Stock Position:  -0.10197744832478937
Bond Position:  [-2.01346461]


portfolio before change:  [-12.27155038]
curr_Stock_Price:  100.58924047843455
curr_Factors:  [100.58924048]
mat_Sqrt:  [[0.15]]
grads:  [-0.01421144]
Stock Position:  -0.014211435659926018
Bond Position:  [-10.84203286]


portfolio before change:  [-12.27564022]
curr_Stock_Price:  100.78165624048674
curr_Factors:  [100.78165624]
mat_Sqrt:  [[0.15]]
grads:  [-0.02936915]
Stock Position:  -0.029369147458771016
Bond Position:  [-9.3157689]


portfolio before change:  [-12.27870912]
curr_Stock_Price:  100.8464980182759
curr_Factors:  [100.84649802]
mat_Sqrt:  [[0.15]]
grads:  [0.21789886]
Stock Position:  0.2178988627684837
Bond Position:  [-34.25304635]


portfolio before change:  [-12.34058238]
curr_Stock_Price:  100.5821948330212
curr_Factors:  [100.58219483]
mat_Sqrt:  [[0.15]]
grads:  [0.02479778]
Stock Position:  0.024797775656369463
Bond Position:  [-14.83479708]


portfolio before change:  [-12.3302473]
curr_Stock_Price:  101.07375289718635
curr_Factors:  [101.0737529]
mat_Sqrt:  [[0.15]]
grads:  [0.04666747]
Stock Position:  0.04666747037230949
Bond Position:  [-17.04710367]


portfolio before change:  [-12.36620892]
curr_Stock_Price:  100.34882393108734
curr_Factors:  [100.34882393]
mat_Sqrt:  [[0.15]]
grads:  [-0.16871839]
Stock Position:  -0.16871839466110017
Bond Position:  [4.56448356]


portfolio before change:  [-12.27931059]
curr_Stock_Price:  99.83715635721974
curr_Factors:  [99.83715636]
mat_Sqrt:  [[0.15]]
grads:  [0.15599884]
Stock Position:  0.1559988362061154
Bond Position:  [-27.85379079]


portfolio before change:  [-12.23126407]
curr_Stock_Price:  100.16746948332336
curr_Factors:  [100.16746948]
mat_Sqrt:  [[0.15]]
grads:  [0.12776118]
Stock Position:  0.12776117611066456
Bond Position:  [-25.02877778]


portfolio before change:  [-12.34138149]
curr_Stock_Price:  99.3300583519422
curr_Factors:  [99.33005835]
mat_Sqrt:  [[0.15]]
grads:  [-0.09946411]
Stock Position:  -0.09946411070940067
Bond Position:  [-2.46160557]


portfolio before change:  [-12.23825655]
curr_Stock_Price:  98.29015903586411
curr_Factors:  [98.29015904]
mat_Sqrt:  [[0.15]]
grads:  [0.00084217]
Stock Position:  0.0008421672806211012
Bond Position:  [-12.32103331]


portfolio before change:  [-12.24039062]
curr_Stock_Price:  97.58502155458439
curr_Factors:  [97.58502155]
mat_Sqrt:  [[0.15]]
grads:  [0.07441501]
Stock Position:  0.07441501214321176
Bond Position:  [-19.50218119]


portfolio before change:  [-12.18776646]
curr_Stock_Price:  98.3249541315693
curr_Factors:  [98.32495413]
mat_Sqrt:  [[0.15]]
grads:  [-0.09717667]
Stock Position:  -0.097176671902481
Bond Position:  [-2.63287465]


portfolio before change:  [-12.27740546]
curr_Stock_Price:  99.24400056634335
curr_Factors:  [99.24400057]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927971]
Stock Position:  -0.009279713543115693
Bond Position:  [-11.35644956]


portfolio before change:  [-12.26841793]
curr_Stock_Price:  98.12250310012853
curr_Factors:  [98.1225031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04032652]
Stock Position:  -0.04032651692557477
Bond Position:  [-8.31147915]


portfolio before change:  [-12.25796152]
curr_Stock_Price:  97.83744468881108
curr_Factors:  [97.83744469]
mat_Sqrt:  [[0.15]]
grads:  [0.01475519]
Stock Position:  0.014755187141412355
Bond Position:  [-13.70157132]


portfolio before change:  [-12.25114151]
curr_Stock_Price:  98.41573701394458
curr_Factors:  [98.41573701]
mat_Sqrt:  [[0.15]]
grads:  [0.03381818]
Stock Position:  0.03381817993661776
Bond Position:  [-15.57938261]


portfolio before change:  [-12.24963718]
curr_Stock_Price:  98.51780848905567
curr_Factors:  [98.51780849]
mat_Sqrt:  [[0.15]]
grads:  [-0.1920827]
Stock Position:  -0.1920827049007009
Bond Position:  [6.67392995]


portfolio before change:  [-12.32406078]
curr_Stock_Price:  98.90960791179445
curr_Factors:  [98.90960791]
mat_Sqrt:  [[0.15]]
grads:  [-0.01832109]
Stock Position:  -0.01832108848970292
Bond Position:  [-10.5119291]


portfolio before change:  [-12.34845303]
curr_Stock_Price:  100.16925888533602
curr_Factors:  [100.16925889]
mat_Sqrt:  [[0.15]]
grads:  [-0.03021782]
Stock Position:  -0.030217816090716335
Bond Position:  [-9.32155679]


portfolio before change:  [-12.35138708]
curr_Stock_Price:  100.22779344227385
curr_Factors:  [100.22779344]
mat_Sqrt:  [[0.15]]
grads:  [0.04622598]
Stock Position:  0.04622598208416532
Bond Position:  [-16.98451527]


portfolio before change:  [-12.31803429]
curr_Stock_Price:  100.99524043988238
curr_Factors:  [100.99524044]
mat_Sqrt:  [[0.15]]
grads:  [-0.07076355]
Stock Position:  -0.07076354997069609
Bond Position:  [-5.17125255]


portfolio before change:  [-12.18237113]
curr_Stock_Price:  99.06897172950286
curr_Factors:  [99.06897173]
mat_Sqrt:  [[0.15]]
grads:  [0.10250147]
Stock Position:  0.10250146506633909
Bond Position:  [-22.33708587]


portfolio before change:  [-12.253825]
curr_Stock_Price:  98.39911235968637
curr_Factors:  [98.39911236]
mat_Sqrt:  [[0.15]]
grads:  [0.04521944]
Stock Position:  0.04521944250381904
Bond Position:  [-16.70337801]


portfolio before change:  [-12.298778]
curr_Stock_Price:  97.45118063575462
curr_Factors:  [97.45118064]
mat_Sqrt:  [[0.15]]
grads:  [0.0646205]
Stock Position:  0.06462050381242382
Bond Position:  [-18.59612239]


portfolio before change:  [-12.32087914]
curr_Stock_Price:  97.14514038004135
curr_Factors:  [97.14514038]
mat_Sqrt:  [[0.15]]
grads:  [-0.02536209]
Stock Position:  -0.025362093221897582
Bond Position:  [-9.85707503]


portfolio before change:  [-12.32303377]
curr_Stock_Price:  97.1815107213416
curr_Factors:  [97.18151072]
mat_Sqrt:  [[0.15]]
grads:  [-0.1136369]
Stock Position:  -0.11363689613634344
Bond Position:  [-1.27962853]


portfolio before change:  [-12.29278549]
curr_Stock_Price:  96.9139193953472
curr_Factors:  [96.9139194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08420849]
Stock Position:  -0.08420848870020206
Bond Position:  [-4.1318108]


portfolio before change:  [-12.13873662]
curr_Stock_Price:  95.07841115242856
curr_Factors:  [95.07841115]
mat_Sqrt:  [[0.15]]
grads:  [0.29918965]
Stock Position:  0.2991896463495989
Bond Position:  [-40.58521283]


portfolio before change:  [-11.99932421]
curr_Stock_Price:  95.56133522266134
curr_Factors:  [95.56133522]
mat_Sqrt:  [[0.15]]
grads:  [0.01264612]
Stock Position:  0.012646115700582102
Bond Position:  [-13.20780391]


portfolio before change:  [-11.99623844]
curr_Stock_Price:  95.93590487981416
curr_Factors:  [95.93590488]
mat_Sqrt:  [[0.15]]
grads:  [-0.11489126]
Stock Position:  -0.11489126393764315
Bond Position:  [-0.97404107]


portfolio before change:  [-12.10944679]
curr_Stock_Price:  96.92019719672055
curr_Factors:  [96.9201972]
mat_Sqrt:  [[0.15]]
grads:  [-0.3188863]
Stock Position:  -0.3188862985404134
Bond Position:  [18.79707615]


portfolio before change:  [-12.40017225]
curr_Stock_Price:  97.83925595353112
curr_Factors:  [97.83925595]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991817]
Stock Position:  -0.14991816908545727
Bond Position:  [2.26770986]


portfolio before change:  [-12.5054915]
curr_Stock_Price:  98.54365844896985
curr_Factors:  [98.54365845]
mat_Sqrt:  [[0.15]]
grads:  [0.25847367]
Stock Position:  0.2584736728953618
Bond Position:  [-37.97643284]


portfolio before change:  [-12.89056306]
curr_Stock_Price:  97.07223508590798
curr_Factors:  [97.07223509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235468]
Stock Position:  -0.002354677578251885
Bond Position:  [-12.66198924]


portfolio before change:  [-12.89202514]
curr_Stock_Price:  97.02094818378653
curr_Factors:  [97.02094818]
mat_Sqrt:  [[0.15]]
grads:  [0.02888979]
Stock Position:  0.028889787454100715
Bond Position:  [-15.69493971]


portfolio before change:  [-12.85798964]
curr_Stock_Price:  98.26697653250964
curr_Factors:  [98.26697653]
mat_Sqrt:  [[0.15]]
grads:  [0.03206587]
Stock Position:  0.032065867777495455
Bond Position:  [-16.00900551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.87411782]
Stock Price:  97.82641653729723
PL:  [-12.87411782]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.33245832e-02]
 [-1.78560504e-02]
 [ 4.71038030e-03]
 [ 4.61805400e-03]
 [ 3.95955697e-03]
 [-3.64054668e-02]
 [ 3.43098809e-03]
 [ 3.63391749e-02]
 [ 6.41604906e-02]
 [ 2.25691631e-02]
 [ 1.48865512e-02]
 [ 1.52188070e-02]
 [-8.81069901e-03]
 [ 2.32393668e-02]
 [-8.79006692e-03]
 [-4.25217800e-03]
 [-4.51256318e-03]
 [ 7.91702461e-03]
 [ 2.35754671e-02]
 [-8.56240590e-03]
 [-5.03474823e-04]
 [-1.93196646e-02]
 [ 5.95733307e-03]
 [-1.24662490e-02]
 [ 1.09983634e-03]
 [ 5.70188303e-03]
 [-3.33426788e-03]
 [-9.25134437e-04]
 [ 1.32659178e-03]
 [-6.41607151e-03]
 [-1.95103970e-02]
 [ 1.70479481e-02]
 [-7.51944072e-03]
 [-2.00974174e-02]
 [-2.12262972e-02]
 [ 3.05909915e-02]
 [ 4.32281561e-03]
 [ 9.33401577e-03]
 [ 7.31794697e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.84797895]
curr_Stock_Price:  100.9547110060256
curr_Factors:  [100.95471101]
mat_Sqrt:  [[0.15]]
grads:  [-0.28883055]
Stock Position:  -0.2888305547081846
Bond Position:  [52.00678413]


portfolio before change:  [22.66658599]
curr_Stock_Price:  101.60524542323223
curr_Factors:  [101.60524542]
mat_Sqrt:  [[0.15]]
grads:  [-0.11904034]
Stock Position:  -0.11904033586417447
Bond Position:  [34.76170853]


portfolio before change:  [22.64754221]
curr_Stock_Price:  101.80172727526421
curr_Factors:  [101.80172728]
mat_Sqrt:  [[0.15]]
grads:  [0.03140254]
Stock Position:  0.031402535356375
Bond Position:  [19.45070987]


portfolio before change:  [22.67856305]
curr_Stock_Price:  102.71214257722235
curr_Factors:  [102.71214258]
mat_Sqrt:  [[0.15]]
grads:  [0.03078703]
Stock Position:  0.03078702665117488
Bond Position:  [19.51636158]


portfolio before change:  [22.71675798]
curr_Stock_Price:  103.87351609465021
curr_Factors:  [103.87351609]
mat_Sqrt:  [[0.15]]
grads:  [0.02639705]
Stock Position:  0.02639704647435112
Bond Position:  [19.97480395]


portfolio before change:  [22.73165682]
curr_Stock_Price:  104.34333501810791
curr_Factors:  [104.34333502]
mat_Sqrt:  [[0.15]]
grads:  [-0.24270311]
Stock Position:  -0.24270311231802502
Bond Position:  [48.05610898]


portfolio before change:  [22.96758259]
curr_Stock_Price:  103.39601142942298
curr_Factors:  [103.39601143]
mat_Sqrt:  [[0.15]]
grads:  [0.02287325]
Stock Position:  0.02287325395233112
Bond Position:  [20.60257937]


portfolio before change:  [22.98689642]
curr_Stock_Price:  104.12779833895013
curr_Factors:  [104.12779834]
mat_Sqrt:  [[0.15]]
grads:  [0.24226117]
Stock Position:  0.24226116601307604
Bond Position:  [-2.23922542]


portfolio before change:  [22.98601482]
curr_Stock_Price:  104.12531472946773
curr_Factors:  [104.12531473]
mat_Sqrt:  [[0.15]]
grads:  [0.4277366]
Stock Position:  0.4277366039444029
Bond Position:  [-21.55219369]


portfolio before change:  [22.95895532]
curr_Stock_Price:  104.06835139238629
curr_Factors:  [104.06835139]
mat_Sqrt:  [[0.15]]
grads:  [0.15046109]
Stock Position:  0.1504610870056284
Bond Position:  [7.30071805]


portfolio before change:  [23.16240033]
curr_Stock_Price:  105.41442936541529
curr_Factors:  [105.41442937]
mat_Sqrt:  [[0.15]]
grads:  [0.09924367]
Stock Position:  0.0992436749139263
Bond Position:  [12.70068497]


portfolio before change:  [23.23042111]
curr_Stock_Price:  106.08382316420604
curr_Factors:  [106.08382316]
mat_Sqrt:  [[0.15]]
grads:  [0.10145871]
Stock Position:  0.1014587132791313
Bond Position:  [12.46729291]


portfolio before change:  [23.3342593]
curr_Stock_Price:  107.09191481011665
curr_Factors:  [107.09191481]
mat_Sqrt:  [[0.15]]
grads:  [-0.05873799]
Stock Position:  -0.05873799339722072
Bond Position:  [29.62462349]


portfolio before change:  [23.36726176]
curr_Stock_Price:  106.5931039463592
curr_Factors:  [106.59310395]
mat_Sqrt:  [[0.15]]
grads:  [0.15492911]
Stock Position:  0.15492911193246886
Bond Position:  [6.85288683]


portfolio before change:  [23.09944293]
curr_Stock_Price:  104.85892054894147
curr_Factors:  [104.85892055]
mat_Sqrt:  [[0.15]]
grads:  [-0.05860045]
Stock Position:  -0.05860044614811856
Bond Position:  [29.24422246]


portfolio before change:  [23.11313209]
curr_Stock_Price:  104.68770342470002
curr_Factors:  [104.68770342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834785]
Stock Position:  -0.028347853302572477
Bond Position:  [26.08080375]


portfolio before change:  [23.11851739]
curr_Stock_Price:  104.612741757007
curr_Factors:  [104.61274176]
mat_Sqrt:  [[0.15]]
grads:  [-0.03008375]
Stock Position:  -0.030083754560061005
Bond Position:  [26.26566144]


portfolio before change:  [23.12914303]
curr_Stock_Price:  104.36868226512114
curr_Factors:  [104.36868227]
mat_Sqrt:  [[0.15]]
grads:  [0.05278016]
Stock Position:  0.05278016404714047
Bond Position:  [17.62054686]


portfolio before change:  [23.14269413]
curr_Stock_Price:  104.58369461928027
curr_Factors:  [104.58369462]
mat_Sqrt:  [[0.15]]
grads:  [0.15716978]
Stock Position:  0.15716978054127362
Bond Position:  [6.70529779]


portfolio before change:  [23.31899568]
curr_Stock_Price:  105.70008824236194
curr_Factors:  [105.70008824]
mat_Sqrt:  [[0.15]]
grads:  [-0.05708271]
Stock Position:  -0.05708270596689831
Bond Position:  [29.35264274]


portfolio before change:  [23.32485575]
curr_Stock_Price:  105.66170954116248
curr_Factors:  [105.66170954]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033565]
Stock Position:  -0.0033564988210103945
Bond Position:  [23.67950915]


portfolio before change:  [23.32723124]
curr_Stock_Price:  105.8358879506275
curr_Factors:  [105.83588795]
mat_Sqrt:  [[0.15]]
grads:  [-0.12879776]
Stock Position:  -0.12879776393714595
Bond Position:  [36.95865696]


portfolio before change:  [23.48278463]
curr_Stock_Price:  104.66402551695359
curr_Factors:  [104.66402552]
mat_Sqrt:  [[0.15]]
grads:  [0.03971555]
Stock Position:  0.03971555381333381
Bond Position:  [19.32599489]


portfolio before change:  [23.39495667]
curr_Stock_Price:  102.39177070589632
curr_Factors:  [102.39177071]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310833]
Stock Position:  -0.08310832694102442
Bond Position:  [31.90456542]


portfolio before change:  [23.38297887]
curr_Stock_Price:  102.58388290472537
curr_Factors:  [102.5838829]
mat_Sqrt:  [[0.15]]
grads:  [0.00733224]
Stock Position:  0.007332242299187541
Bond Position:  [22.63080898]


portfolio before change:  [23.37485196]
curr_Stock_Price:  101.08966935770408
curr_Factors:  [101.08966936]
mat_Sqrt:  [[0.15]]
grads:  [0.03801255]
Stock Position:  0.038012553533892296
Bond Position:  [19.53217549]


portfolio before change:  [23.36474943]
curr_Stock_Price:  100.75966783815542
curr_Factors:  [100.75966784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02222845]
Stock Position:  -0.022228452504105163
Bond Position:  [25.60448092]


portfolio before change:  [23.35895397]
curr_Stock_Price:  101.16438442545463
curr_Factors:  [101.16438443]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616756]
Stock Position:  -0.0061675629151443515
Bond Position:  [23.98289167]


portfolio before change:  [23.361333]
curr_Stock_Price:  101.26475099619734
curr_Factors:  [101.264751]
mat_Sqrt:  [[0.15]]
grads:  [0.00884395]
Stock Position:  0.008843945172878186
Bond Position:  [22.46575309]


portfolio before change:  [23.36737187]
curr_Stock_Price:  101.63002590667594
curr_Factors:  [101.63002591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04277381]
Stock Position:  -0.04277381005370343
Bond Position:  [27.71447529]


portfolio before change:  [23.43657538]
curr_Stock_Price:  100.09312771318005
curr_Factors:  [100.09312771]
mat_Sqrt:  [[0.15]]
grads:  [-0.13006931]
Stock Position:  -0.13006931309384853
Bond Position:  [36.45561975]


portfolio before change:  [23.42982234]
curr_Stock_Price:  100.18008353556036
curr_Factors:  [100.18008354]
mat_Sqrt:  [[0.15]]
grads:  [0.11365299]
Stock Position:  0.11365298740361465
Bond Position:  [12.04405656]


portfolio before change:  [23.41427068]
curr_Stock_Price:  100.03000158758562
curr_Factors:  [100.03000159]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501296]
Stock Position:  -0.05012960479247447
Bond Position:  [28.42873512]


portfolio before change:  [23.39947235]
curr_Stock_Price:  100.39609537287565
curr_Factors:  [100.39609537]
mat_Sqrt:  [[0.15]]
grads:  [-0.13398278]
Stock Position:  -0.13398278233402294
Bond Position:  [36.85082055]


portfolio before change:  [23.39018752]
curr_Stock_Price:  100.49977637660447
curr_Factors:  [100.49977638]
mat_Sqrt:  [[0.15]]
grads:  [-0.14150865]
Stock Position:  -0.14150864825481932
Bond Position:  [37.61177503]


portfolio before change:  [23.49991866]
curr_Stock_Price:  99.75756469564148
curr_Factors:  [99.7575647]
mat_Sqrt:  [[0.15]]
grads:  [0.20393994]
Stock Position:  0.20393994334780519
Bond Position:  [3.15536657]


portfolio before change:  [23.69774014]
curr_Stock_Price:  100.72562928585863
curr_Factors:  [100.72562929]
mat_Sqrt:  [[0.15]]
grads:  [0.02881877]
Stock Position:  0.028818770716175376
Bond Position:  [20.79495133]


portfolio before change:  [23.6885206]
curr_Stock_Price:  100.31551194514526
curr_Factors:  [100.31551195]
mat_Sqrt:  [[0.15]]
grads:  [0.06222677]
Stock Position:  0.06222677178977077
Bond Position:  [17.44621013]


portfolio before change:  [23.70737559]
curr_Stock_Price:  100.58346862644719
curr_Factors:  [100.58346863]
mat_Sqrt:  [[0.15]]
grads:  [0.04878631]
Stock Position:  0.048786313148723004
Bond Position:  [18.80027899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.68265575]
Stock Price:  100.02859937269359
PL:  [23.65405637]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.00087683e-03]
 [-1.35252860e-02]
 [ 5.93775079e-03]
 [ 3.74964176e-03]
 [-1.78923208e-03]
 [ 3.18419727e-02]
 [ 3.67854864e-03]
 [ 1.02123675e-03]
 [-2.06990723e-02]
 [ 2.34358184e-02]
 [ 2.02558393e-02]
 [-1.50695922e-02]
 [ 2.81103114e-02]
 [ 6.45009634e-03]
 [-1.32665017e-02]
 [ 5.75820252e-04]
 [-6.08027129e-03]
 [ 1.74650587e-03]
 [ 3.64131047e-03]
 [-2.56255808e-02]
 [-5.79507613e-03]
 [-1.36554474e-02]
 [ 6.82927006e-03]
 [-6.58977964e-03]
 [ 1.40353946e-02]
 [ 4.33950783e-03]
 [ 1.42366717e-02]
 [-3.54371594e-03]
 [-8.59875944e-03]
 [-1.17155233e-02]
 [ 4.22293371e-02]
 [ 4.97455455e-03]
 [-1.70987925e-02]
 [-3.86945868e-02]
 [-2.32799710e-02]
 [ 3.63731019e-02]
 [-1.72023760e-03]
 [ 6.12410883e-03]
 [ 9.24405383e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.99843653]
curr_Stock_Price:  99.64087068229756
curr_Factors:  [99.64087068]
mat_Sqrt:  [[0.15]]
grads:  [-0.03333918]
Stock Position:  -0.03333917886005585
Bond Position:  [-2.67649172]


portfolio before change:  [-6.06122118]
curr_Stock_Price:  101.51404415366865
curr_Factors:  [101.51404415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09016857]
Stock Position:  -0.09016857304747453
Bond Position:  [3.09215532]


portfolio before change:  [-6.09582522]
curr_Stock_Price:  101.90210151945129
curr_Factors:  [101.90210152]
mat_Sqrt:  [[0.15]]
grads:  [0.03958501]
Stock Position:  0.03958500526783974
Bond Position:  [-10.12962044]


portfolio before change:  [-6.07142132]
curr_Stock_Price:  102.55058391471435
curr_Factors:  [102.55058391]
mat_Sqrt:  [[0.15]]
grads:  [0.02499761]
Stock Position:  0.02499761171230296
Bond Position:  [-8.634941]


portfolio before change:  [-6.08935893]
curr_Stock_Price:  101.87619261339565
curr_Factors:  [101.87619261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01192821]
Stock Position:  -0.011928213880504647
Bond Position:  [-4.87415791]


portfolio before change:  [-6.07987776]
curr_Stock_Price:  101.03025967730974
curr_Factors:  [101.03025968]
mat_Sqrt:  [[0.15]]
grads:  [0.21227982]
Stock Position:  0.21227981819093478
Bond Position:  [-27.52656292]


portfolio before change:  [-6.03155688]
curr_Stock_Price:  101.27409783623797
curr_Factors:  [101.27409784]
mat_Sqrt:  [[0.15]]
grads:  [0.02452366]
Stock Position:  0.024523657609141086
Bond Position:  [-8.51516818]


portfolio before change:  [-6.06834589]
curr_Stock_Price:  99.81735957864007
curr_Factors:  [99.81735958]
mat_Sqrt:  [[0.15]]
grads:  [0.00680825]
Stock Position:  0.006808245030802592
Bond Position:  [-6.74792694]


portfolio before change:  [-6.0777792]
curr_Stock_Price:  98.55568839015945
curr_Factors:  [98.55568839]
mat_Sqrt:  [[0.15]]
grads:  [-0.13799382]
Stock Position:  -0.13799381519016635
Bond Position:  [7.52229625]


portfolio before change:  [-6.1291892]
curr_Stock_Price:  98.93505569740945
curr_Factors:  [98.9350557]
mat_Sqrt:  [[0.15]]
grads:  [0.15623879]
Stock Position:  0.15623878921571374
Bond Position:  [-21.58668251]


portfolio before change:  [-6.13050272]
curr_Stock_Price:  98.9439201990271
curr_Factors:  [98.9439202]
mat_Sqrt:  [[0.15]]
grads:  [0.13503893]
Stock Position:  0.13503892861520592
Bond Position:  [-19.4917837]


portfolio before change:  [-6.0713579]
curr_Stock_Price:  99.39994755801476
curr_Factors:  [99.39994756]
mat_Sqrt:  [[0.15]]
grads:  [-0.10046395]
Stock Position:  -0.1004639477011733
Bond Position:  [3.91475323]


portfolio before change:  [-6.16827508]
curr_Stock_Price:  100.36951476946177
curr_Factors:  [100.36951477]
mat_Sqrt:  [[0.15]]
grads:  [0.18740208]
Stock Position:  0.1874020757378971
Bond Position:  [-24.97773049]


portfolio before change:  [-6.35195941]
curr_Stock_Price:  99.40601467384296
curr_Factors:  [99.40601467]
mat_Sqrt:  [[0.15]]
grads:  [0.04300064]
Stock Position:  0.04300064226181975
Bond Position:  [-10.62648188]


portfolio before change:  [-6.39071162]
curr_Stock_Price:  98.53570625406473
curr_Factors:  [98.53570625]
mat_Sqrt:  [[0.15]]
grads:  [-0.08844334]
Stock Position:  -0.08844334451991556
Bond Position:  [2.32411579]


portfolio before change:  [-6.3817204]
curr_Stock_Price:  98.4373303659414
curr_Factors:  [98.43733037]
mat_Sqrt:  [[0.15]]
grads:  [0.0038388]
Stock Position:  0.0038388016809075016
Bond Position:  [-6.75960179]


portfolio before change:  [-6.38584922]
curr_Stock_Price:  97.5819029016656
curr_Factors:  [97.5819029]
mat_Sqrt:  [[0.15]]
grads:  [-0.04053514]
Stock Position:  -0.04053514193213116
Bond Position:  [-2.43035293]


portfolio before change:  [-6.38906106]
curr_Stock_Price:  97.65364375038293
curr_Factors:  [97.65364375]
mat_Sqrt:  [[0.15]]
grads:  [0.01164337]
Stock Position:  0.011643372446090167
Bond Position:  [-7.5260788]


portfolio before change:  [-6.38673389]
curr_Stock_Price:  97.93431740176955
curr_Factors:  [97.9343174]
mat_Sqrt:  [[0.15]]
grads:  [0.0242754]
Stock Position:  0.02427540315717484
Bond Position:  [-8.76412892]


portfolio before change:  [-6.39542703]
curr_Stock_Price:  97.62134367823529
curr_Factors:  [97.62134368]
mat_Sqrt:  [[0.15]]
grads:  [-0.17083721]
Stock Position:  -0.17083720516703063
Bond Position:  [10.28193048]


portfolio before change:  [-6.38431239]
curr_Stock_Price:  97.56380749169654
curr_Factors:  [97.56380749]
mat_Sqrt:  [[0.15]]
grads:  [-0.03863384]
Stock Position:  -0.03863384087177006
Bond Position:  [-2.61504778]


portfolio before change:  [-6.40647592]
curr_Stock_Price:  98.12902771781984
curr_Factors:  [98.12902772]
mat_Sqrt:  [[0.15]]
grads:  [-0.09103632]
Stock Position:  -0.09103631597504046
Bond Position:  [2.52682925]


portfolio before change:  [-6.47918646]
curr_Stock_Price:  98.93119564426118
curr_Factors:  [98.93119564]
mat_Sqrt:  [[0.15]]
grads:  [0.04552847]
Stock Position:  0.0455284670603269
Bond Position:  [-10.98337214]


portfolio before change:  [-6.49894154]
curr_Stock_Price:  98.52744660735357
curr_Factors:  [98.52744661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04393186]
Stock Position:  -0.04393186428399521
Bond Position:  [-2.17044713]


portfolio before change:  [-6.48076735]
curr_Stock_Price:  98.10758009864229
curr_Factors:  [98.1075801]
mat_Sqrt:  [[0.15]]
grads:  [0.0935693]
Stock Position:  0.09356929724964594
Bond Position:  [-15.66062467]


portfolio before change:  [-6.55169524]
curr_Stock_Price:  97.3704773159917
curr_Factors:  [97.37047732]
mat_Sqrt:  [[0.15]]
grads:  [0.02893005]
Stock Position:  0.02893005220840114
Bond Position:  [-9.36862823]


portfolio before change:  [-6.56305815]
curr_Stock_Price:  97.01818746152144
curr_Factors:  [97.01818746]
mat_Sqrt:  [[0.15]]
grads:  [0.09491114]
Stock Position:  0.09491114476215169
Bond Position:  [-15.77116539]


portfolio before change:  [-6.49832441]
curr_Stock_Price:  97.72100545094209
curr_Factors:  [97.72100545]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362477]
Stock Position:  -0.023624772916114672
Bond Position:  [-4.18968785]


portfolio before change:  [-6.5151753]
curr_Stock_Price:  98.41210811198265
curr_Factors:  [98.41210811]
mat_Sqrt:  [[0.15]]
grads:  [-0.05732506]
Stock Position:  -0.05732506292753394
Bond Position:  [-0.87369501]


portfolio before change:  [-6.40196018]
curr_Stock_Price:  96.43523568673295
curr_Factors:  [96.43523569]
mat_Sqrt:  [[0.15]]
grads:  [-0.07810349]
Stock Position:  -0.07810348883795344
Bond Position:  [1.12996817]


portfolio before change:  [-6.35408397]
curr_Stock_Price:  95.82406002343238
curr_Factors:  [95.82406002]
mat_Sqrt:  [[0.15]]
grads:  [0.28152891]
Stock Position:  0.2815289142431728
Bond Position:  [-33.33132755]


portfolio before change:  [-6.15007527]
curr_Stock_Price:  96.56350586268894
curr_Factors:  [96.56350586]
mat_Sqrt:  [[0.15]]
grads:  [0.0331637]
Stock Position:  0.03316369701924106
Bond Position:  [-9.35247812]


portfolio before change:  [-6.17052306]
curr_Stock_Price:  95.98218759713436
curr_Factors:  [95.9821876]
mat_Sqrt:  [[0.15]]
grads:  [-0.11399195]
Stock Position:  -0.11399195019152898
Bond Position:  [4.77067369]


portfolio before change:  [-6.16499848]
curr_Stock_Price:  95.93895464025509
curr_Factors:  [95.93895464]
mat_Sqrt:  [[0.15]]
grads:  [-0.25796391]
Stock Position:  -0.25796391171235983
Bond Position:  [18.58378954]


portfolio before change:  [-6.06323026]
curr_Stock_Price:  95.55345458687876
curr_Factors:  [95.55345459]
mat_Sqrt:  [[0.15]]
grads:  [-0.15519981]
Stock Position:  -0.15519980670333525
Bond Position:  [8.76664742]


portfolio before change:  [-6.02746648]
curr_Stock_Price:  95.33007877868833
curr_Factors:  [95.33007878]
mat_Sqrt:  [[0.15]]
grads:  [0.24248735]
Stock Position:  0.24248734613896678
Bond Position:  [-29.14380429]


portfolio before change:  [-5.74619078]
curr_Stock_Price:  96.50506340010556
curr_Factors:  [96.5050634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01146825]
Stock Position:  -0.011468250678775885
Bond Position:  [-4.63944652]


portfolio before change:  [-5.75808969]
curr_Stock_Price:  97.49204427935051
curr_Factors:  [97.49204428]
mat_Sqrt:  [[0.15]]
grads:  [0.04082739]
Stock Position:  0.0408273922274413
Bond Position:  [-9.73843562]


portfolio before change:  [-5.76898938]
curr_Stock_Price:  97.2548920286494
curr_Factors:  [97.25489203]
mat_Sqrt:  [[0.15]]
grads:  [0.06162703]
Stock Position:  0.06162702556649522
Bond Position:  [-11.7625191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.8428096]
Stock Price:  96.08089712970397
PL:  [-5.8428096]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.09316213e-02]
 [ 3.18303246e-02]
 [-4.34184336e-03]
 [-6.35612073e-03]
 [-7.47527005e-03]
 [ 3.27453486e-02]
 [ 3.72601462e-03]
 [ 1.78401180e-02]
 [-3.30552219e-03]
 [ 2.30599764e-02]
 [ 1.93123457e-02]
 [-1.50899538e-02]
 [-2.45569291e-03]
 [ 6.41984050e-03]
 [-1.22776020e-02]
 [ 8.07458513e-05]
 [-6.08295170e-03]
 [ 4.76617243e-03]
 [ 5.83762855e-03]
 [-2.09220926e-02]
 [-4.95554889e-03]
 [-6.12738176e-03]
 [ 7.14349944e-03]
 [-6.45972259e-03]
 [ 1.54299829e-02]
 [ 7.47274028e-03]
 [-2.83454394e-03]
 [-8.43873969e-04]
 [ 4.84962310e-04]
 [-1.01069062e-02]
 [-1.49070590e-02]
 [ 1.82284940e-02]
 [-4.60699447e-03]
 [-2.31840957e-02]
 [-2.10208070e-02]
 [ 2.62821829e-02]
 [ 4.97478075e-03]
 [ 1.43129892e-02]
 [ 9.08321409e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.8507441]
curr_Stock_Price:  100.86374484473926
curr_Factors:  [100.86374484]
mat_Sqrt:  [[0.15]]
grads:  [-0.27287748]
Stock Position:  -0.2728774751911833
Bond Position:  [48.37418813]


portfolio before change:  [21.24449993]
curr_Stock_Price:  99.44292885207514
curr_Factors:  [99.44292885]
mat_Sqrt:  [[0.15]]
grads:  [0.21220216]
Stock Position:  0.21220216406154782
Bond Position:  [0.14249523]


portfolio before change:  [21.27968359]
curr_Stock_Price:  99.60864743671482
curr_Factors:  [99.60864744]
mat_Sqrt:  [[0.15]]
grads:  [-0.02894562]
Stock Position:  -0.028945622380219967
Bond Position:  [24.16291788]


portfolio before change:  [21.27297827]
curr_Stock_Price:  99.94465226390486
curr_Factors:  [99.94465226]
mat_Sqrt:  [[0.15]]
grads:  [-0.04237414]
Stock Position:  -0.042374138174702
Bond Position:  [25.50804678]


portfolio before change:  [21.25924034]
curr_Stock_Price:  100.34410913650021
curr_Factors:  [100.34410914]
mat_Sqrt:  [[0.15]]
grads:  [-0.04983513]
Stock Position:  -0.04983513363536468
Bond Position:  [26.25990242]


portfolio before change:  [21.23820786]
curr_Stock_Price:  100.8320212482621
curr_Factors:  [100.83202125]
mat_Sqrt:  [[0.15]]
grads:  [0.21830232]
Stock Position:  0.21830232398819327
Bond Position:  [-0.77365671]


portfolio before change:  [21.28216269]
curr_Stock_Price:  101.03381270595366
curr_Factors:  [101.03381271]
mat_Sqrt:  [[0.15]]
grads:  [0.0248401]
Stock Position:  0.024840097450587472
Bond Position:  [18.77247294]


portfolio before change:  [21.31437212]
curr_Stock_Price:  102.23601088894124
curr_Factors:  [102.23601089]
mat_Sqrt:  [[0.15]]
grads:  [0.11893412]
Stock Position:  0.11893412009634309
Bond Position:  [9.15502212]


portfolio before change:  [21.31325024]
curr_Stock_Price:  102.21695558037628
curr_Factors:  [102.21695558]
mat_Sqrt:  [[0.15]]
grads:  [-0.02203681]
Stock Position:  -0.02203681457259854
Bond Position:  [23.56578634]


portfolio before change:  [21.33434507]
curr_Stock_Price:  101.39338266866744
curr_Factors:  [101.39338267]
mat_Sqrt:  [[0.15]]
grads:  [0.15373318]
Stock Position:  0.15373317620228252
Bond Position:  [5.74681831]


portfolio before change:  [21.19500426]
curr_Stock_Price:  100.48232875136286
curr_Factors:  [100.48232875]
mat_Sqrt:  [[0.15]]
grads:  [0.12874897]
Stock Position:  0.12874897164357188
Bond Position:  [8.25800776]


portfolio before change:  [21.05790276]
curr_Stock_Price:  99.40943618243101
curr_Factors:  [99.40943618]
mat_Sqrt:  [[0.15]]
grads:  [-0.10059969]
Stock Position:  -0.10059969223492209
Bond Position:  [31.05846144]


portfolio before change:  [21.198044]
curr_Stock_Price:  98.05497186111127
curr_Factors:  [98.05497186]
mat_Sqrt:  [[0.15]]
grads:  [-0.01637129]
Stock Position:  -0.01637128608704288
Bond Position:  [22.80333]


portfolio before change:  [21.18126814]
curr_Stock_Price:  99.25380594239705
curr_Factors:  [99.25380594]
mat_Sqrt:  [[0.15]]
grads:  [0.04279894]
Stock Position:  0.04279893669442522
Bond Position:  [16.93331078]


portfolio before change:  [21.15946008]
curr_Stock_Price:  98.69480002914052
curr_Factors:  [98.69480003]
mat_Sqrt:  [[0.15]]
grads:  [-0.08185068]
Stock Position:  -0.08185068008639637
Bond Position:  [29.23769658]


portfolio before change:  [21.16556659]
curr_Stock_Price:  98.66484827703552
curr_Factors:  [98.66484828]
mat_Sqrt:  [[0.15]]
grads:  [0.00053831]
Stock Position:  0.0005383056751402775
Bond Position:  [21.11245474]


portfolio before change:  [21.16846804]
curr_Stock_Price:  99.15198170366322
curr_Factors:  [99.1519817]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055301]
Stock Position:  -0.04055301136315237
Bond Position:  [25.18937948]


portfolio before change:  [21.15781691]
curr_Stock_Price:  99.49227697593604
curr_Factors:  [99.49227698]
mat_Sqrt:  [[0.15]]
grads:  [0.03177448]
Stock Position:  0.031774482853862446
Bond Position:  [17.99650126]


portfolio before change:  [21.15654518]
curr_Stock_Price:  99.38145108676271
curr_Factors:  [99.38145109]
mat_Sqrt:  [[0.15]]
grads:  [0.03891752]
Stock Position:  0.038917523664059796
Bond Position:  [17.2888652]


portfolio before change:  [21.15248795]
curr_Stock_Price:  99.22166508469181
curr_Factors:  [99.22166508]
mat_Sqrt:  [[0.15]]
grads:  [-0.13948062]
Stock Position:  -0.1394806176155429
Bond Position:  [34.99198707]


portfolio before change:  [20.98673803]
curr_Stock_Price:  100.44136281520517
curr_Factors:  [100.44136282]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303699]
Stock Position:  -0.03303699259440417
Bond Position:  [24.30501859]


portfolio before change:  [21.01332037]
curr_Stock_Price:  99.72870642583926
curr_Factors:  [99.72870643]
mat_Sqrt:  [[0.15]]
grads:  [-0.04084921]
Stock Position:  -0.040849211712372616
Bond Position:  [25.08715941]


portfolio before change:  [21.02751475]
curr_Stock_Price:  99.45799637611711
curr_Factors:  [99.45799638]
mat_Sqrt:  [[0.15]]
grads:  [0.04762333]
Stock Position:  0.0476233296163427
Bond Position:  [16.29099381]


portfolio before change:  [21.02316877]
curr_Stock_Price:  99.32397626216166
curr_Factors:  [99.32397626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04306482]
Stock Position:  -0.04306481727106014
Bond Position:  [25.30053766]


portfolio before change:  [21.03014755]
curr_Stock_Price:  99.23536524672892
curr_Factors:  [99.23536525]
mat_Sqrt:  [[0.15]]
grads:  [0.10286655]
Stock Position:  0.10286655241466656
Bond Position:  [10.82214765]


portfolio before change:  [21.16295457]
curr_Stock_Price:  100.5132749591444
curr_Factors:  [100.51327496]
mat_Sqrt:  [[0.15]]
grads:  [0.04981827]
Stock Position:  0.04981826852853438
Bond Position:  [16.15555725]


portfolio before change:  [21.19300331]
curr_Stock_Price:  101.07590334588907
curr_Factors:  [101.07590335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01889696]
Stock Position:  -0.01889695962024421
Bond Position:  [23.10303058]


portfolio before change:  [21.19310675]
curr_Stock_Price:  101.22326139781535
curr_Factors:  [101.2232614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00562583]
Stock Position:  -0.00562582646001985
Bond Position:  [21.76257125]


portfolio before change:  [21.20162471]
curr_Stock_Price:  100.19275253139446
curr_Factors:  [100.19275253]
mat_Sqrt:  [[0.15]]
grads:  [0.00323308]
Stock Position:  0.0032330820665203
Bond Position:  [20.87769332]


portfolio before change:  [21.2031262]
curr_Stock_Price:  99.84992601472888
curr_Factors:  [99.84992601]
mat_Sqrt:  [[0.15]]
grads:  [-0.06737937]
Stock Position:  -0.0673793745397291
Bond Position:  [27.93095176]


portfolio before change:  [21.20880791]
curr_Stock_Price:  99.81742166019333
curr_Factors:  [99.81742166]
mat_Sqrt:  [[0.15]]
grads:  [-0.09938039]
Stock Position:  -0.09938039361020379
Bond Position:  [31.12870256]


portfolio before change:  [21.15475329]
curr_Stock_Price:  100.4004938328468
curr_Factors:  [100.40049383]
mat_Sqrt:  [[0.15]]
grads:  [0.12152329]
Stock Position:  0.12152329315365647
Bond Position:  [8.95375465]


portfolio before change:  [21.20768238]
curr_Stock_Price:  100.82683020149088
curr_Factors:  [100.8268302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307133]
Stock Position:  -0.030713296447644995
Bond Position:  [24.30440671]


portfolio before change:  [21.23648431]
curr_Stock_Price:  99.98798556919772
curr_Factors:  [99.98798557]
mat_Sqrt:  [[0.15]]
grads:  [-0.15456064]
Stock Position:  -0.15456063771451564
Bond Position:  [36.69069112]


portfolio before change:  [21.1229774]
curr_Stock_Price:  100.7520451088327
curr_Factors:  [100.75204511]
mat_Sqrt:  [[0.15]]
grads:  [-0.14013871]
Stock Position:  -0.14013871337899633
Bond Position:  [35.24223937]


portfolio before change:  [21.16991326]
curr_Stock_Price:  100.44855794667725
curr_Factors:  [100.44855795]
mat_Sqrt:  [[0.15]]
grads:  [0.17521455]
Stock Position:  0.17521455286574003
Bond Position:  [3.56986409]


portfolio before change:  [21.3355964]
curr_Stock_Price:  101.39161251435225
curr_Factors:  [101.39161251]
mat_Sqrt:  [[0.15]]
grads:  [0.03316521]
Stock Position:  0.03316520501160389
Bond Position:  [17.97292279]


portfolio before change:  [21.34316399]
curr_Stock_Price:  101.55204676056552
curr_Factors:  [101.55204676]
mat_Sqrt:  [[0.15]]
grads:  [0.09541993]
Stock Position:  0.09541992779317307
Bond Position:  [11.65307502]


portfolio before change:  [21.36858679]
curr_Stock_Price:  101.80321097729912
curr_Factors:  [101.80321098]
mat_Sqrt:  [[0.15]]
grads:  [0.06055476]
Stock Position:  0.06055476060724353
Bond Position:  [15.20391772]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.33419002]
Stock Price:  101.20379688211545
PL:  [20.13039314]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-8.68122123e-03]
 [ 4.41617225e-02]
 [-1.12477871e-03]
 [-4.77043182e-03]
 [-7.72367730e-03]
 [ 2.32471148e-02]
 [ 3.68717892e-03]
 [ 6.09041983e-03]
 [-2.35898462e-02]
 [ 2.30439348e-02]
 [ 1.91329142e-02]
 [-1.42553765e-02]
 [ 2.90980379e-02]
 [ 6.38136631e-03]
 [-1.06704516e-02]
 [-4.86823707e-04]
 [-6.10138153e-03]
 [ 6.56988669e-04]
 [ 1.25116841e-03]
 [-7.42767400e-03]
 [-1.44584121e-02]
 [-2.37557078e-02]
 [ 4.79667497e-03]
 [-1.01921248e-02]
 [ 1.16153571e-02]
 [-1.20636133e-03]
 [ 3.21456657e-02]
 [-4.51958200e-03]
 [-3.75797271e-02]
 [-8.84518408e-03]
 [ 4.47861425e-02]
 [-3.20975070e-03]
 [-2.10371386e-02]
 [-1.78652301e-02]
 [-2.35084192e-02]
 [ 3.67678491e-02]
 [-5.90375040e-03]
 [-9.07414191e-04]
 [ 1.71822652e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.24690032]
curr_Stock_Price:  99.35627782921779
curr_Factors:  [99.35627783]
mat_Sqrt:  [[0.15]]
grads:  [-0.05787481]
Stock Position:  -0.05787480817953173
Bond Position:  [-6.4966748]


portfolio before change:  [-12.30649992]
curr_Stock_Price:  100.37204727636907
curr_Factors:  [100.37204728]
mat_Sqrt:  [[0.15]]
grads:  [0.29441148]
Stock Position:  0.29441148311186777
Bond Position:  [-41.85718322]


portfolio before change:  [-12.44322797]
curr_Stock_Price:  99.92540853129996
curr_Factors:  [99.92540853]
mat_Sqrt:  [[0.15]]
grads:  [-0.00749852]
Stock Position:  -0.007498524751209275
Bond Position:  [-11.69393482]


portfolio before change:  [-12.44686895]
curr_Stock_Price:  100.21601908499426
curr_Factors:  [100.21601908]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180288]
Stock Position:  -0.0318028788048699
Bond Position:  [-9.25971104]


portfolio before change:  [-12.44363769]
curr_Stock_Price:  100.07801912679602
curr_Factors:  [100.07801913]
mat_Sqrt:  [[0.15]]
grads:  [-0.05149118]
Stock Position:  -0.0514911820256255
Bond Position:  [-7.29050219]


portfolio before change:  [-12.52927526]
curr_Stock_Price:  101.72346983969238
curr_Factors:  [101.72346984]
mat_Sqrt:  [[0.15]]
grads:  [0.15498077]
Stock Position:  0.15498076538414018
Bond Position:  [-28.29445648]


portfolio before change:  [-12.75798819]
curr_Stock_Price:  100.27054178009728
curr_Factors:  [100.27054178]
mat_Sqrt:  [[0.15]]
grads:  [0.02458119]
Stock Position:  0.024581192783406196
Bond Position:  [-15.22275771]


portfolio before change:  [-12.74452998]
curr_Stock_Price:  100.89545780536879
curr_Factors:  [100.89545781]
mat_Sqrt:  [[0.15]]
grads:  [0.0406028]
Stock Position:  0.0406027988443067
Bond Position:  [-16.84116795]


portfolio before change:  [-12.76041195]
curr_Stock_Price:  100.5561537635895
curr_Factors:  [100.55615376]
mat_Sqrt:  [[0.15]]
grads:  [-0.15726564]
Stock Position:  -0.1572656412994481
Bond Position:  [3.05361606]


portfolio before change:  [-12.90289276]
curr_Stock_Price:  101.46456920351886
curr_Factors:  [101.4645692]
mat_Sqrt:  [[0.15]]
grads:  [0.15362623]
Stock Position:  0.15362623201446163
Bond Position:  [-28.49051221]


portfolio before change:  [-13.12563967]
curr_Stock_Price:  100.03782471254813
curr_Factors:  [100.03782471]
mat_Sqrt:  [[0.15]]
grads:  [0.12755276]
Stock Position:  0.12755276162233928
Bond Position:  [-25.88574048]


portfolio before change:  [-13.08876308]
curr_Stock_Price:  100.35230253736707
curr_Factors:  [100.35230254]
mat_Sqrt:  [[0.15]]
grads:  [-0.09503584]
Stock Position:  -0.09503584311997006
Bond Position:  [-3.5516974]


portfolio before change:  [-13.09449773]
curr_Stock_Price:  100.40797266447619
curr_Factors:  [100.40797266]
mat_Sqrt:  [[0.15]]
grads:  [0.19398692]
Stock Position:  0.19398691954550024
Bond Position:  [-32.57233104]


portfolio before change:  [-13.36000952]
curr_Stock_Price:  99.06025293919537
curr_Factors:  [99.06025294]
mat_Sqrt:  [[0.15]]
grads:  [0.04254244]
Stock Position:  0.04254244209020086
Bond Position:  [-17.57427459]


portfolio before change:  [-13.36675403]
curr_Stock_Price:  98.95335772671545
curr_Factors:  [98.95335773]
mat_Sqrt:  [[0.15]]
grads:  [-0.07113634]
Stock Position:  -0.07113634424262258
Bond Position:  [-6.32757391]


portfolio before change:  [-13.36319703]
curr_Stock_Price:  98.89223580818839
curr_Factors:  [98.89223581]
mat_Sqrt:  [[0.15]]
grads:  [-0.00324549]
Stock Position:  -0.003245491378518767
Bond Position:  [-13.04224313]


portfolio before change:  [-13.35939117]
curr_Stock_Price:  97.21722299332862
curr_Factors:  [97.21722299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04067588]
Stock Position:  -0.04067587689390902
Bond Position:  [-9.40499538]


portfolio before change:  [-13.36086793]
curr_Stock_Price:  97.2246244522019
curr_Factors:  [97.22462445]
mat_Sqrt:  [[0.15]]
grads:  [0.00437992]
Stock Position:  0.004379924456794637
Bond Position:  [-13.78670444]


portfolio before change:  [-13.36734163]
curr_Stock_Price:  96.14007385192224
curr_Factors:  [96.14007385]
mat_Sqrt:  [[0.15]]
grads:  [0.00834112]
Stock Position:  0.008341122702190165
Bond Position:  [-14.16925778]


portfolio before change:  [-13.36907882]
curr_Stock_Price:  96.14415874107844
curr_Factors:  [96.14415874]
mat_Sqrt:  [[0.15]]
grads:  [-0.04951783]
Stock Position:  -0.04951782668438885
Bond Position:  [-8.60822903]


portfolio before change:  [-13.33958572]
curr_Stock_Price:  95.52682151608933
curr_Factors:  [95.52682152]
mat_Sqrt:  [[0.15]]
grads:  [-0.09638941]
Stock Position:  -0.09638941424531061
Bond Position:  [-4.13181135]


portfolio before change:  [-13.25756313]
curr_Stock_Price:  94.67051271560902
curr_Factors:  [94.67051272]
mat_Sqrt:  [[0.15]]
grads:  [-0.15837139]
Stock Position:  -0.15837138544819582
Bond Position:  [1.73553713]


portfolio before change:  [-13.41050341]
curr_Stock_Price:  95.63758917772012
curr_Factors:  [95.63758918]
mat_Sqrt:  [[0.15]]
grads:  [0.03197783]
Stock Position:  0.03197783316566105
Bond Position:  [-16.46878628]


portfolio before change:  [-13.39074727]
curr_Stock_Price:  96.31977636959557
curr_Factors:  [96.31977637]
mat_Sqrt:  [[0.15]]
grads:  [-0.0679475]
Stock Position:  -0.06794749860749136
Bond Position:  [-6.8460594]


portfolio before change:  [-13.35258944]
curr_Stock_Price:  95.74560308949161
curr_Factors:  [95.74560309]
mat_Sqrt:  [[0.15]]
grads:  [0.07743571]
Stock Position:  0.07743571414207603
Bond Position:  [-20.76671859]


portfolio before change:  [-13.44301415]
curr_Stock_Price:  94.6113886828561
curr_Factors:  [94.61138868]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804241]
Stock Position:  -0.008042408846474567
Bond Position:  [-12.68211068]


portfolio before change:  [-13.43964948]
curr_Stock_Price:  93.99589724101524
curr_Factors:  [93.99589724]
mat_Sqrt:  [[0.15]]
grads:  [0.21430444]
Stock Position:  0.2143044381213048
Bond Position:  [-33.58338742]


portfolio before change:  [-13.12399681]
curr_Stock_Price:  95.48840413672417
curr_Factors:  [95.48840414]
mat_Sqrt:  [[0.15]]
grads:  [-0.03013055]
Stock Position:  -0.030130546674117804
Bond Position:  [-10.24687899]


portfolio before change:  [-13.1061254]
curr_Stock_Price:  94.85275851005306
curr_Factors:  [94.85275851]
mat_Sqrt:  [[0.15]]
grads:  [-0.25053151]
Stock Position:  -0.2505315141461201
Bond Position:  [10.65747981]


portfolio before change:  [-12.96895467]
curr_Stock_Price:  94.31055740005372
curr_Factors:  [94.3105574]
mat_Sqrt:  [[0.15]]
grads:  [-0.05896789]
Stock Position:  -0.0589678938566648
Bond Position:  [-7.40765973]


portfolio before change:  [-13.01622101]
curr_Stock_Price:  95.09641440952082
curr_Factors:  [95.09641441]
mat_Sqrt:  [[0.15]]
grads:  [0.29857428]
Stock Position:  0.2985742831377033
Bond Position:  [-41.40956478]


portfolio before change:  [-13.37389089]
curr_Stock_Price:  93.91582593627813
curr_Factors:  [93.91582594]
mat_Sqrt:  [[0.15]]
grads:  [-0.02139834]
Stock Position:  -0.021398337997081917
Bond Position:  [-11.3642483]


portfolio before change:  [-13.39061408]
curr_Stock_Price:  94.63095463121803
curr_Factors:  [94.63095463]
mat_Sqrt:  [[0.15]]
grads:  [-0.14024759]
Stock Position:  -0.14024759054307082
Bond Position:  [-0.1188507]


portfolio before change:  [-13.29743769]
curr_Stock_Price:  93.96647803595665
curr_Factors:  [93.96647804]
mat_Sqrt:  [[0.15]]
grads:  [-0.11910153]
Stock Position:  -0.11910153392995011
Bond Position:  [-2.10588602]


portfolio before change:  [-13.40729993]
curr_Stock_Price:  94.88669277364805
curr_Factors:  [94.88669277]
mat_Sqrt:  [[0.15]]
grads:  [-0.15672279]
Stock Position:  -0.15672279436222164
Bond Position:  [1.46360771]


portfolio before change:  [-13.50497885]
curr_Stock_Price:  95.51111937864749
curr_Factors:  [95.51111938]
mat_Sqrt:  [[0.15]]
grads:  [0.24511899]
Stock Position:  0.24511899419181213
Bond Position:  [-36.91656837]


portfolio before change:  [-13.67666663]
curr_Stock_Price:  94.8295201590484
curr_Factors:  [94.82952016]
mat_Sqrt:  [[0.15]]
grads:  [-0.03935834]
Stock Position:  -0.03935833602890361
Bond Position:  [-9.94433451]


portfolio before change:  [-13.70955918]
curr_Stock_Price:  95.6336555415565
curr_Factors:  [95.63365554]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604943]
Stock Position:  -0.006049427941185737
Bond Position:  [-13.13103027]


portfolio before change:  [-13.71332467]
curr_Stock_Price:  95.98476597497043
curr_Factors:  [95.98476597]
mat_Sqrt:  [[0.15]]
grads:  [0.11454843]
Stock Position:  0.1145484348011682
Bond Position:  [-24.70822938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.7320535]
Stock Price:  95.84822891807737
PL:  [-13.7320535]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 6.19407138e-03]
 [ 1.26953102e-02]
 [-1.52172840e-02]
 [-8.24913187e-03]
 [-2.45064090e-03]
 [ 6.52234478e-02]
 [ 3.16122191e-03]
 [ 1.25885799e-02]
 [ 1.26145021e-01]
 [ 2.32853449e-02]
 [ 2.24133355e-02]
 [-1.52542669e-03]
 [-3.81644529e-02]
 [ 1.59367290e-02]
 [ 9.65004921e-03]
 [-2.63815853e-03]
 [-6.03198415e-03]
 [-5.26823768e-03]
 [ 1.12526125e-03]
 [-1.72138877e-03]
 [-9.04641968e-03]
 [-1.77627105e-02]
 [ 6.39145945e-03]
 [-8.68821595e-03]
 [ 1.29952841e-02]
 [ 3.68653716e-03]
 [ 1.70187669e-02]
 [-4.04322693e-03]
 [-2.20720469e-02]
 [-1.18922585e-02]
 [ 3.84566440e-02]
 [ 6.19681002e-03]
 [-1.16110998e-02]
 [-4.04452477e-02]
 [-2.14605218e-02]
 [ 2.64759674e-02]
 [ 3.67806380e-03]
 [ 1.14626672e-02]
 [ 7.83155590e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.11981696]
curr_Stock_Price:  99.04324361450857
curr_Factors:  [99.04324361]
mat_Sqrt:  [[0.15]]
grads:  [0.04129381]
Stock Position:  0.04129380919244921
Bond Position:  [-23.20968976]


portfolio before change:  [-19.13852119]
curr_Stock_Price:  98.66055083894356
curr_Factors:  [98.66055084]
mat_Sqrt:  [[0.15]]
grads:  [0.0846354]
Stock Position:  0.08463540149487421
Bond Position:  [-27.48869652]


portfolio before change:  [-19.19178293]
curr_Stock_Price:  98.0718439787861
curr_Factors:  [98.07184398]
mat_Sqrt:  [[0.15]]
grads:  [-0.10144856]
Stock Position:  -0.10144856015885959
Bond Position:  [-9.24253557]


portfolio before change:  [-19.15838485]
curr_Stock_Price:  97.73124303990956
curr_Factors:  [97.73124304]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499421]
Stock Position:  -0.05499421244561635
Bond Position:  [-13.78373211]


portfolio before change:  [-19.06315261]
curr_Stock_Price:  95.96823364051747
curr_Factors:  [95.96823364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633761]
Stock Position:  -0.016337606030726086
Bond Position:  [-17.49526142]


portfolio before change:  [-19.05885398]
curr_Stock_Price:  95.57125535760616
curr_Factors:  [95.57125536]
mat_Sqrt:  [[0.15]]
grads:  [0.43482299]
Stock Position:  0.4348229851605595
Bond Position:  [-60.61543253]


portfolio before change:  [-19.27039154]
curr_Stock_Price:  95.10219055188008
curr_Factors:  [95.10219055]
mat_Sqrt:  [[0.15]]
grads:  [0.02107481]
Stock Position:  0.02107481271563365
Bond Position:  [-21.27465239]


portfolio before change:  [-19.29331204]
curr_Stock_Price:  94.14080578076094
curr_Factors:  [94.14080578]
mat_Sqrt:  [[0.15]]
grads:  [0.08392387]
Stock Position:  0.0839238663001901
Bond Position:  [-27.19397244]


portfolio before change:  [-19.30864155]
curr_Stock_Price:  93.99865254873465
curr_Factors:  [93.99865255]
mat_Sqrt:  [[0.15]]
grads:  [0.84096681]
Stock Position:  0.8409668057284135
Bond Position:  [-98.35838813]


portfolio before change:  [-18.42741461]
curr_Stock_Price:  95.06114692538169
curr_Factors:  [95.06114693]
mat_Sqrt:  [[0.15]]
grads:  [0.15523563]
Stock Position:  0.15523563263575982
Bond Position:  [-33.1842919]


portfolio before change:  [-18.50826557]
curr_Stock_Price:  94.5670422098717
curr_Factors:  [94.56704221]
mat_Sqrt:  [[0.15]]
grads:  [0.14942224]
Stock Position:  0.14942223644888067
Bond Position:  [-32.63868451]


portfolio before change:  [-18.63263095]
curr_Stock_Price:  93.76203962377417
curr_Factors:  [93.76203962]
mat_Sqrt:  [[0.15]]
grads:  [-0.01016951]
Stock Position:  -0.010169511254467084
Bond Position:  [-17.67911683]


portfolio before change:  [-18.63234299]
curr_Stock_Price:  93.5164048351894
curr_Factors:  [93.51640484]
mat_Sqrt:  [[0.15]]
grads:  [-0.25442969]
Stock Position:  -0.25442968591176585
Bond Position:  [5.16100652]


portfolio before change:  [-18.80357327]
curr_Stock_Price:  94.19193703095515
curr_Factors:  [94.19193703]
mat_Sqrt:  [[0.15]]
grads:  [0.10624486]
Stock Position:  0.10624486014692117
Bond Position:  [-28.81098244]


portfolio before change:  [-18.84162955]
curr_Stock_Price:  93.86764198094362
curr_Factors:  [93.86764198]
mat_Sqrt:  [[0.15]]
grads:  [0.06433366]
Stock Position:  0.06433366141365991
Bond Position:  [-24.88047864]


portfolio before change:  [-18.83515784]
curr_Stock_Price:  94.01658362154298
curr_Factors:  [94.01658362]
mat_Sqrt:  [[0.15]]
grads:  [-0.01758772]
Stock Position:  -0.017587723537595027
Bond Position:  [-17.18162016]


portfolio before change:  [-18.8435897]
curr_Stock_Price:  94.37387967287212
curr_Factors:  [94.37387967]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021323]
Stock Position:  -0.04021322765612157
Bond Position:  [-15.04851139]


portfolio before change:  [-18.89007261]
curr_Stock_Price:  95.48301034180616
curr_Factors:  [95.48301034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512158]
Stock Position:  -0.03512158452012307
Bond Position:  [-15.53655799]


portfolio before change:  [-18.92430588]
curr_Stock_Price:  96.40241879766948
curr_Factors:  [96.4024188]
mat_Sqrt:  [[0.15]]
grads:  [0.00750174]
Stock Position:  0.0075017416976386085
Bond Position:  [-19.64749192]


portfolio before change:  [-18.93205076]
curr_Stock_Price:  95.69741017012619
curr_Factors:  [95.69741017]
mat_Sqrt:  [[0.15]]
grads:  [-0.01147593]
Stock Position:  -0.011475925117483746
Bond Position:  [-17.83383445]


portfolio before change:  [-18.94661517]
curr_Stock_Price:  96.77227286593428
curr_Factors:  [96.77227287]
mat_Sqrt:  [[0.15]]
grads:  [-0.06030946]
Stock Position:  -0.060309464504581134
Bond Position:  [-13.11033122]


portfolio before change:  [-18.97870965]
curr_Stock_Price:  97.27726132226483
curr_Factors:  [97.27726132]
mat_Sqrt:  [[0.15]]
grads:  [-0.11841807]
Stock Position:  -0.11841807022789817
Bond Position:  [-7.45932409]


portfolio before change:  [-19.00942441]
curr_Stock_Price:  97.5287625360372
curr_Factors:  [97.52876254]
mat_Sqrt:  [[0.15]]
grads:  [0.04260973]
Stock Position:  0.042609729639242075
Bond Position:  [-23.16509862]


portfolio before change:  [-19.01531471]
curr_Stock_Price:  97.45848577322752
curr_Factors:  [97.45848577]
mat_Sqrt:  [[0.15]]
grads:  [-0.05792144]
Stock Position:  -0.057921439694824974
Bond Position:  [-13.3703789]


portfolio before change:  [-19.0123751]
curr_Stock_Price:  97.37887781275708
curr_Factors:  [97.37887781]
mat_Sqrt:  [[0.15]]
grads:  [0.08663523]
Stock Position:  0.0866352276366692
Bond Position:  [-27.44881635]


portfolio before change:  [-19.04036432]
curr_Stock_Price:  97.09541457964221
curr_Factors:  [97.09541458]
mat_Sqrt:  [[0.15]]
grads:  [0.02457691]
Stock Position:  0.024576914374597487
Bond Position:  [-21.42667001]


portfolio before change:  [-19.05162381]
curr_Stock_Price:  96.74626597488935
curr_Factors:  [96.74626597]
mat_Sqrt:  [[0.15]]
grads:  [0.11345845]
Stock Position:  0.11345844624833462
Bond Position:  [-30.02830483]


portfolio before change:  [-19.07290767]
curr_Stock_Price:  96.59175936500584
curr_Factors:  [96.59175937]
mat_Sqrt:  [[0.15]]
grads:  [-0.02695485]
Stock Position:  -0.0269548462157331
Bond Position:  [-16.46929165]


portfolio before change:  [-19.07233396]
curr_Stock_Price:  96.49409625253222
curr_Factors:  [96.49409625]
mat_Sqrt:  [[0.15]]
grads:  [-0.14714698]
Stock Position:  -0.14714697929905732
Bond Position:  [-4.87351918]


portfolio before change:  [-19.077876]
curr_Stock_Price:  96.52761924471395
curr_Factors:  [96.52761924]
mat_Sqrt:  [[0.15]]
grads:  [-0.07928172]
Stock Position:  -0.07928172323072359
Bond Position:  [-11.425]


portfolio before change:  [-19.08543656]
curr_Stock_Price:  96.60496805257294
curr_Factors:  [96.60496805]
mat_Sqrt:  [[0.15]]
grads:  [0.25637763]
Stock Position:  0.2563776268822422
Bond Position:  [-43.85278901]


portfolio before change:  [-18.99950944]
curr_Stock_Price:  96.96150876740289
curr_Factors:  [96.96150877]
mat_Sqrt:  [[0.15]]
grads:  [0.04131207]
Stock Position:  0.041312066804157076
Bond Position:  [-23.00518977]


portfolio before change:  [-18.96138325]
curr_Stock_Price:  97.9540035713286
curr_Factors:  [97.95400357]
mat_Sqrt:  [[0.15]]
grads:  [-0.07740733]
Stock Position:  -0.07740733200765668
Bond Position:  [-11.37902518]


portfolio before change:  [-19.01987669]
curr_Stock_Price:  98.69128470030869
curr_Factors:  [98.6912847]
mat_Sqrt:  [[0.15]]
grads:  [-0.26963498]
Stock Position:  -0.26963498492049653
Bond Position:  [7.59074638]


portfolio before change:  [-19.39550672]
curr_Stock_Price:  100.08790962027469
curr_Factors:  [100.08790962]
mat_Sqrt:  [[0.15]]
grads:  [-0.14307015]
Stock Position:  -0.1430701452905504
Bond Position:  [-5.07591495]


portfolio before change:  [-19.43447053]
curr_Stock_Price:  100.35581514080974
curr_Factors:  [100.35581514]
mat_Sqrt:  [[0.15]]
grads:  [0.17650645]
Stock Position:  0.17650644959080564
Bond Position:  [-37.14791916]


portfolio before change:  [-19.48062123]
curr_Stock_Price:  100.12065709860227
curr_Factors:  [100.1206571]
mat_Sqrt:  [[0.15]]
grads:  [0.02452043]
Stock Position:  0.024520425329111112
Bond Position:  [-21.93562232]


portfolio before change:  [-19.46479844]
curr_Stock_Price:  100.87777717867124
curr_Factors:  [100.87777718]
mat_Sqrt:  [[0.15]]
grads:  [0.07641778]
Stock Position:  0.07641778120306605
Bond Position:  [-27.17365435]


portfolio before change:  [-19.44673739]
curr_Stock_Price:  101.1585753783709
curr_Factors:  [101.15857538]
mat_Sqrt:  [[0.15]]
grads:  [0.05221037]
Stock Position:  0.05221037268006135
Bond Position:  [-24.72826431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.45241505]
Stock Price:  101.10903663803649
PL:  [-20.56145169]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.82583751e-02]
 [ 4.39583961e-02]
 [-7.40068499e-03]
 [-6.98219005e-03]
 [-7.09629772e-03]
 [ 4.20521108e-02]
 [ 3.54221194e-03]
 [ 6.45442374e-03]
 [ 2.19356807e-02]
 [ 2.34468446e-02]
 [ 2.14721625e-02]
 [-6.19282007e-03]
 [-1.45710141e-02]
 [ 1.39743435e-02]
 [-1.65003378e-02]
 [-4.23159237e-04]
 [-6.08279257e-03]
 [-9.33810139e-03]
 [ 1.59141270e-03]
 [ 2.14907019e-03]
 [-1.06858529e-02]
 [-2.22494278e-02]
 [ 4.75844050e-03]
 [-1.02518275e-02]
 [ 1.17609063e-02]
 [ 2.11412450e-03]
 [ 2.20539763e-02]
 [-4.32381098e-03]
 [-4.11292015e-02]
 [-8.82579066e-03]
 [ 4.93196592e-02]
 [-2.69668230e-03]
 [-2.16117752e-02]
 [-2.35326406e-02]
 [-2.39201584e-02]
 [ 3.50510044e-02]
 [-5.25262764e-03]
 [-5.28856590e-03]
 [ 2.72812381e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.96586358]
curr_Stock_Price:  101.14226439107125
curr_Factors:  [101.14226439]
mat_Sqrt:  [[0.15]]
grads:  [-0.3217225]
Stock Position:  -0.32172250071321906
Bond Position:  [59.5056058]


portfolio before change:  [27.20071198]
curr_Stock_Price:  100.43541381919275
curr_Factors:  [100.43541382]
mat_Sqrt:  [[0.15]]
grads:  [0.29305597]
Stock Position:  0.2930559740307399
Bond Position:  [-2.23248605]


portfolio before change:  [26.90793953]
curr_Stock_Price:  99.43733360558883
curr_Factors:  [99.43733361]
mat_Sqrt:  [[0.15]]
grads:  [-0.0493379]
Stock Position:  -0.0493378999632106
Bond Position:  [31.81396875]


portfolio before change:  [26.92969204]
curr_Stock_Price:  99.07705241108414
curr_Factors:  [99.07705241]
mat_Sqrt:  [[0.15]]
grads:  [-0.04654793]
Stock Position:  -0.046547933637139785
Bond Position:  [31.5415241]


portfolio before change:  [26.92520457]
curr_Stock_Price:  99.25816475838172
curr_Factors:  [99.25816476]
mat_Sqrt:  [[0.15]]
grads:  [-0.04730865]
Stock Position:  -0.0473086514541366
Bond Position:  [31.62097449]


portfolio before change:  [26.98558758]
curr_Stock_Price:  98.06535681855803
curr_Factors:  [98.06535682]
mat_Sqrt:  [[0.15]]
grads:  [0.28034741]
Stock Position:  0.2803474054074441
Bond Position:  [-0.50678077]


portfolio before change:  [26.69295276]
curr_Stock_Price:  97.0217535795561
curr_Factors:  [97.02175358]
mat_Sqrt:  [[0.15]]
grads:  [0.02361475]
Stock Position:  0.023614746265807424
Bond Position:  [24.40180867]


portfolio before change:  [26.66961065]
curr_Stock_Price:  95.90412445057162
curr_Factors:  [95.90412445]
mat_Sqrt:  [[0.15]]
grads:  [0.04302949]
Stock Position:  0.043029491604723656
Bond Position:  [22.54290493]


portfolio before change:  [26.72156935]
curr_Stock_Price:  97.04614730585584
curr_Factors:  [97.04614731]
mat_Sqrt:  [[0.15]]
grads:  [0.14623787]
Stock Position:  0.14623787158808327
Bond Position:  [12.52974733]


portfolio before change:  [26.67276837]
curr_Stock_Price:  96.70172692295851
curr_Factors:  [96.70172692]
mat_Sqrt:  [[0.15]]
grads:  [0.1563123]
Stock Position:  0.15631229722755446
Bond Position:  [11.55709929]


portfolio before change:  [26.72561623]
curr_Stock_Price:  97.03057584683285
curr_Factors:  [97.03057585]
mat_Sqrt:  [[0.15]]
grads:  [0.14314775]
Stock Position:  0.14314774984548656
Bond Position:  [12.83590763]


portfolio before change:  [26.68979673]
curr_Stock_Price:  96.76913912225662
curr_Factors:  [96.76913912]
mat_Sqrt:  [[0.15]]
grads:  [-0.04128547]
Stock Position:  -0.04128546711079149
Bond Position:  [30.68495585]


portfolio before change:  [26.68516602]
curr_Stock_Price:  96.97421297822605
curr_Factors:  [96.97421298]
mat_Sqrt:  [[0.15]]
grads:  [-0.09714009]
Stock Position:  -0.0971400941935088
Bond Position:  [36.10525021]


portfolio before change:  [26.66776236]
curr_Stock_Price:  97.19983659918354
curr_Factors:  [97.1998366]
mat_Sqrt:  [[0.15]]
grads:  [0.09316229]
Stock Position:  0.09316228973968854
Bond Position:  [17.61240302]


portfolio before change:  [26.60132792]
curr_Stock_Price:  96.46309935272286
curr_Factors:  [96.46309935]
mat_Sqrt:  [[0.15]]
grads:  [-0.11000225]
Stock Position:  -0.11000225209526794
Bond Position:  [37.21248609]


portfolio before change:  [26.6623273]
curr_Stock_Price:  95.95085963924575
curr_Factors:  [95.95085964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00282106]
Stock Position:  -0.002821061581094678
Bond Position:  [26.93301058]


portfolio before change:  [26.66593954]
curr_Stock_Price:  95.863868428512
curr_Factors:  [95.86386843]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055195]
Stock Position:  -0.040551950471521034
Bond Position:  [30.55340638]


portfolio before change:  [26.7274155]
curr_Stock_Price:  94.44207388410196
curr_Factors:  [94.44207388]
mat_Sqrt:  [[0.15]]
grads:  [-0.06225401]
Stock Position:  -0.062254009269837866
Bond Position:  [32.60681324]


portfolio before change:  [26.66991903]
curr_Stock_Price:  95.43112785365165
curr_Factors:  [95.43112785]
mat_Sqrt:  [[0.15]]
grads:  [0.01060942]
Stock Position:  0.01060941798993136
Bond Position:  [25.6574503]


portfolio before change:  [26.67273664]
curr_Stock_Price:  95.3943895642169
curr_Factors:  [95.39438956]
mat_Sqrt:  [[0.15]]
grads:  [0.01432713]
Stock Position:  0.014327134617378145
Bond Position:  [25.30600838]


portfolio before change:  [26.69023587]
curr_Stock_Price:  96.3949932727001
curr_Factors:  [96.39499327]
mat_Sqrt:  [[0.15]]
grads:  [-0.07123902]
Stock Position:  -0.07123901929111429
Bond Position:  [33.55732066]


portfolio before change:  [26.76567368]
curr_Stock_Price:  95.39493905887687
curr_Factors:  [95.39493906]
mat_Sqrt:  [[0.15]]
grads:  [-0.14832952]
Stock Position:  -0.14832951860491062
Bond Position:  [40.91555907]


portfolio before change:  [26.74087962]
curr_Stock_Price:  95.59657675972089
curr_Factors:  [95.59657676]
mat_Sqrt:  [[0.15]]
grads:  [0.03172294]
Stock Position:  0.03172293664355528
Bond Position:  [23.70827547]


portfolio before change:  [26.76484151]
curr_Stock_Price:  96.25850055627862
curr_Factors:  [96.25850056]
mat_Sqrt:  [[0.15]]
grads:  [-0.06834552]
Stock Position:  -0.06834551671112861
Bond Position:  [33.34367847]


portfolio before change:  [26.79424699]
curr_Stock_Price:  95.8892405794991
curr_Factors:  [95.88924058]
mat_Sqrt:  [[0.15]]
grads:  [0.07840604]
Stock Position:  0.07840604189012389
Bond Position:  [19.27595118]


portfolio before change:  [26.83929368]
curr_Stock_Price:  96.43303854259764
curr_Factors:  [96.43303854]
mat_Sqrt:  [[0.15]]
grads:  [0.01409416]
Stock Position:  0.01409416332903258
Bond Position:  [25.48015069]


portfolio before change:  [26.83399037]
curr_Stock_Price:  95.83076554070543
curr_Factors:  [95.83076554]
mat_Sqrt:  [[0.15]]
grads:  [0.14702651]
Stock Position:  0.14702650867150208
Bond Position:  [12.74432748]


portfolio before change:  [26.85191702]
curr_Stock_Price:  95.94185786008393
curr_Factors:  [95.94185786]
mat_Sqrt:  [[0.15]]
grads:  [-0.02882541]
Stock Position:  -0.028825406534099183
Bond Position:  [29.61748008]


portfolio before change:  [26.89769734]
curr_Stock_Price:  94.48210748927657
curr_Factors:  [94.48210749]
mat_Sqrt:  [[0.15]]
grads:  [-0.27419468]
Stock Position:  -0.27419467643903467
Bond Position:  [52.80418823]


portfolio before change:  [26.95714632]
curr_Stock_Price:  94.28936832943766
curr_Factors:  [94.28936833]
mat_Sqrt:  [[0.15]]
grads:  [-0.0588386]
Stock Position:  -0.05883860440656314
Bond Position:  [32.50500117]


portfolio before change:  [26.96575089]
curr_Stock_Price:  94.212187922725
curr_Factors:  [94.21218792]
mat_Sqrt:  [[0.15]]
grads:  [0.32879773]
Stock Position:  0.3287977281604041
Bond Position:  [-4.01100246]


portfolio before change:  [26.94533399]
curr_Stock_Price:  94.1516172782948
curr_Factors:  [94.15161728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01797788]
Stock Position:  -0.017977881970475618
Bond Position:  [28.63798066]


portfolio before change:  [26.95297839]
curr_Stock_Price:  93.92553818722331
curr_Factors:  [93.92553819]
mat_Sqrt:  [[0.15]]
grads:  [-0.1440785]
Stock Position:  -0.14407850157222316
Bond Position:  [40.48562919]


portfolio before change:  [26.87614198]
curr_Stock_Price:  94.4939604556327
curr_Factors:  [94.49396046]
mat_Sqrt:  [[0.15]]
grads:  [-0.15688427]
Stock Position:  -0.1568842704930795
Bond Position:  [41.70075803]


portfolio before change:  [27.00827321]
curr_Stock_Price:  93.68496723169878
curr_Factors:  [93.68496723]
mat_Sqrt:  [[0.15]]
grads:  [-0.15946772]
Stock Position:  -0.15946772236115642
Bond Position:  [41.94800156]


portfolio before change:  [26.84786744]
curr_Stock_Price:  94.72373292800324
curr_Factors:  [94.72373293]
mat_Sqrt:  [[0.15]]
grads:  [0.23367336]
Stock Position:  0.23367336254818058
Bond Position:  [4.71345425]


portfolio before change:  [26.9319493]
curr_Stock_Price:  95.0810378495677
curr_Factors:  [95.08103785]
mat_Sqrt:  [[0.15]]
grads:  [-0.03501752]
Stock Position:  -0.035017517573372764
Bond Position:  [30.26145121]


portfolio before change:  [26.95935758]
curr_Stock_Price:  94.40636506028271
curr_Factors:  [94.40636506]
mat_Sqrt:  [[0.15]]
grads:  [-0.03525711]
Stock Position:  -0.03525710599465041
Bond Position:  [30.2878528]


portfolio before change:  [26.96034067]
curr_Stock_Price:  94.48587066657869
curr_Factors:  [94.48587067]
mat_Sqrt:  [[0.15]]
grads:  [0.18187492]
Stock Position:  0.1818749207881979
Bond Position:  [9.77573042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.09447745]
Stock Price:  95.21667369537053
PL:  [27.09447745]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.07229661e-02]
 [ 4.41299927e-02]
 [-6.80899064e-03]
 [-7.14227447e-03]
 [-6.41838049e-03]
 [ 3.00392981e-02]
 [ 3.54747647e-03]
 [ 1.79210077e-04]
 [-1.63940014e-02]
 [ 2.34425140e-02]
 [ 2.01820569e-02]
 [-1.50954122e-02]
 [-1.59664056e-03]
 [ 1.23970398e-02]
 [-1.55885838e-02]
 [-1.61937633e-04]
 [-6.04783019e-03]
 [ 1.87044927e-03]
 [ 4.30352486e-03]
 [-2.14756602e-02]
 [-5.57420747e-03]
 [-1.29800961e-02]
 [ 6.57349500e-03]
 [-6.74787304e-03]
 [ 1.48587652e-02]
 [ 7.95607112e-03]
 [-5.59860988e-03]
 [-1.88221698e-03]
 [ 1.21787960e-03]
 [-7.32310709e-03]
 [-2.81785781e-02]
 [ 1.81015135e-02]
 [-7.44350380e-03]
 [-3.85222969e-02]
 [-2.18565444e-02]
 [ 3.11072414e-02]
 [ 3.53300302e-03]
 [ 8.86495278e-03]
 [ 7.75670023e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.28626272]
curr_Stock_Price:  99.80994554160668
curr_Factors:  [99.80994554]
mat_Sqrt:  [[0.15]]
grads:  [0.07148644]
Stock Position:  0.07148644090414039
Bond Position:  [-9.4213205]


portfolio before change:  [-2.25212891]
curr_Stock_Price:  100.30390710030652
curr_Factors:  [100.3039071]
mat_Sqrt:  [[0.15]]
grads:  [0.29419995]
Stock Position:  0.29419995127896237
Bond Position:  [-31.76153349]


portfolio before change:  [-2.50309927]
curr_Stock_Price:  99.46434231779013
curr_Factors:  [99.46434232]
mat_Sqrt:  [[0.15]]
grads:  [-0.04539327]
Stock Position:  -0.04539327094655161
Bond Position:  [2.01191257]


portfolio before change:  [-2.47965933]
curr_Stock_Price:  98.95350811760866
curr_Factors:  [98.95350812]
mat_Sqrt:  [[0.15]]
grads:  [-0.04761516]
Stock Position:  -0.04761516315039053
Bond Position:  [2.23202811]


portfolio before change:  [-2.48027627]
curr_Stock_Price:  98.97232488552493
curr_Factors:  [98.97232489]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427892]
Stock Position:  -0.04278920325012347
Bond Position:  [1.75467066]


portfolio before change:  [-2.52804113]
curr_Stock_Price:  100.09373419665305
curr_Factors:  [100.0937342]
mat_Sqrt:  [[0.15]]
grads:  [0.20026199]
Stock Position:  0.20026198738327974
Bond Position:  [-22.57301127]


portfolio before change:  [-2.74513025]
curr_Stock_Price:  99.02379917761672
curr_Factors:  [99.02379918]
mat_Sqrt:  [[0.15]]
grads:  [0.02364984]
Stock Position:  0.02364984313379341
Bond Position:  [-5.08702757]


portfolio before change:  [-2.77799673]
curr_Stock_Price:  97.66097546296263
curr_Factors:  [97.66097546]
mat_Sqrt:  [[0.15]]
grads:  [0.00119473]
Stock Position:  0.0011947338437579523
Bond Position:  [-2.89467561]


portfolio before change:  [-2.77774572]
curr_Stock_Price:  98.17394975954767
curr_Factors:  [98.17394976]
mat_Sqrt:  [[0.15]]
grads:  [-0.10929334]
Stock Position:  -0.10929334264187722
Bond Position:  [7.95201341]


portfolio before change:  [-2.76201947]
curr_Stock_Price:  98.03915480112768
curr_Factors:  [98.0391548]
mat_Sqrt:  [[0.15]]
grads:  [0.15628343]
Stock Position:  0.15628342684947888
Bond Position:  [-18.08391455]


portfolio before change:  [-2.61274387]
curr_Stock_Price:  99.00877920839069
curr_Factors:  [99.00877921]
mat_Sqrt:  [[0.15]]
grads:  [0.13454705]
Stock Position:  0.13454704632777478
Bond Position:  [-15.93408268]


portfolio before change:  [-2.56048631]
curr_Stock_Price:  99.41197978978003
curr_Factors:  [99.41197979]
mat_Sqrt:  [[0.15]]
grads:  [-0.10063608]
Stock Position:  -0.10063608115479998
Bond Position:  [7.44394576]


portfolio before change:  [-2.43086639]
curr_Stock_Price:  98.13321999675692
curr_Factors:  [98.13322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01064427]
Stock Position:  -0.010644270421930408
Bond Position:  [-1.38630985]


portfolio before change:  [-2.42343361]
curr_Stock_Price:  97.4186504324464
curr_Factors:  [97.41865043]
mat_Sqrt:  [[0.15]]
grads:  [0.08264693]
Stock Position:  0.08264693203419576
Bond Position:  [-10.47478619]


portfolio before change:  [-2.36329669]
curr_Stock_Price:  98.16213062863676
curr_Factors:  [98.16213063]
mat_Sqrt:  [[0.15]]
grads:  [-0.10392389]
Stock Position:  -0.10392389200089384
Bond Position:  [7.83809398]


portfolio before change:  [-2.42468729]
curr_Stock_Price:  98.76228547882297
curr_Factors:  [98.76228548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00107958]
Stock Position:  -0.0010795842185002224
Bond Position:  [-2.31806509]


portfolio before change:  [-2.42430777]
curr_Stock_Price:  98.14232349629289
curr_Factors:  [98.1423235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031887]
Stock Position:  -0.040318867963751406
Bond Position:  [1.53267962]


portfolio before change:  [-2.40638093]
curr_Stock_Price:  97.70244895541195
curr_Factors:  [97.70244896]
mat_Sqrt:  [[0.15]]
grads:  [0.01246966]
Stock Position:  0.012469661775820172
Bond Position:  [-3.62469742]


portfolio before change:  [-2.40138785]
curr_Stock_Price:  98.13920389650993
curr_Factors:  [98.1392039]
mat_Sqrt:  [[0.15]]
grads:  [0.02869017]
Stock Position:  0.02869016570675899
Bond Position:  [-5.21701788]


portfolio before change:  [-2.42731776]
curr_Stock_Price:  97.25814465646125
curr_Factors:  [97.25814466]
mat_Sqrt:  [[0.15]]
grads:  [-0.14317107]
Stock Position:  -0.14317106791945752
Bond Position:  [11.49723468]


portfolio before change:  [-2.47808553]
curr_Stock_Price:  97.62277852567514
curr_Factors:  [97.62277853]
mat_Sqrt:  [[0.15]]
grads:  [-0.03716138]
Stock Position:  -0.03716138311692127
Bond Position:  [1.14971194]


portfolio before change:  [-2.50195936]
curr_Stock_Price:  98.26908243491602
curr_Factors:  [98.26908243]
mat_Sqrt:  [[0.15]]
grads:  [-0.08653397]
Stock Position:  -0.08653397370667484
Bond Position:  [6.00165484]


portfolio before change:  [-2.45878931]
curr_Stock_Price:  97.77887268527991
curr_Factors:  [97.77887269]
mat_Sqrt:  [[0.15]]
grads:  [0.0438233]
Stock Position:  0.04382330000102373
Bond Position:  [-6.74378218]


portfolio before change:  [-2.43810927]
curr_Stock_Price:  98.27000562351981
curr_Factors:  [98.27000562]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498582]
Stock Position:  -0.044985820294789605
Bond Position:  [1.98264755]


portfolio before change:  [-2.45455913]
curr_Stock_Price:  98.64118269315065
curr_Factors:  [98.64118269]
mat_Sqrt:  [[0.15]]
grads:  [0.09905843]
Stock Position:  0.09905843481975037
Bond Position:  [-12.22580029]


portfolio before change:  [-2.38296112]
curr_Stock_Price:  99.37939674789745
curr_Factors:  [99.37939675]
mat_Sqrt:  [[0.15]]
grads:  [0.05304047]
Stock Position:  0.05304047413641285
Bond Position:  [-7.65409144]


portfolio before change:  [-2.34871058]
curr_Stock_Price:  100.04317967323009
curr_Factors:  [100.04317967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03732407]
Stock Position:  -0.03732406589272131
Bond Position:  [1.38530765]


portfolio before change:  [-2.34871508]
curr_Stock_Price:  100.04794005195932
curr_Factors:  [100.04794005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01254811]
Stock Position:  -0.012548113227601031
Bond Position:  [-1.0933022]


portfolio before change:  [-2.36313489]
curr_Stock_Price:  101.18620994176187
curr_Factors:  [101.18620994]
mat_Sqrt:  [[0.15]]
grads:  [0.0081192]
Stock Position:  0.008119197311903142
Bond Position:  [-3.18468569]


portfolio before change:  [-2.36658587]
curr_Stock_Price:  100.81020351594655
curr_Factors:  [100.81020352]
mat_Sqrt:  [[0.15]]
grads:  [-0.04882071]
Stock Position:  -0.04882071395434589
Bond Position:  [2.55504024]


portfolio before change:  [-2.37630047]
curr_Stock_Price:  101.01573094566606
curr_Factors:  [101.01573095]
mat_Sqrt:  [[0.15]]
grads:  [-0.18785719]
Stock Position:  -0.1878571874280418
Bond Position:  [16.60023063]


portfolio before change:  [-2.25449418]
curr_Stock_Price:  100.37837909222269
curr_Factors:  [100.37837909]
mat_Sqrt:  [[0.15]]
grads:  [0.12067676]
Stock Position:  0.12067675650495288
Bond Position:  [-14.36783139]


portfolio before change:  [-2.29573741]
curr_Stock_Price:  100.05149643245932
curr_Factors:  [100.05149643]
mat_Sqrt:  [[0.15]]
grads:  [-0.04962336]
Stock Position:  -0.04962335864378525
Bond Position:  [2.66915388]


portfolio before change:  [-2.24260925]
curr_Stock_Price:  98.98759222097772
curr_Factors:  [98.98759222]
mat_Sqrt:  [[0.15]]
grads:  [-0.25681531]
Stock Position:  -0.2568153124675726
Bond Position:  [23.17892018]


portfolio before change:  [-2.28370907]
curr_Stock_Price:  99.15891130844362
curr_Factors:  [99.15891131]
mat_Sqrt:  [[0.15]]
grads:  [-0.1457103]
Stock Position:  -0.14571029570033944
Bond Position:  [12.16476522]


portfolio before change:  [-2.35853844]
curr_Stock_Price:  99.68289666045543
curr_Factors:  [99.68289666]
mat_Sqrt:  [[0.15]]
grads:  [0.20738161]
Stock Position:  0.20738160958699678
Bond Position:  [-23.03093799]


portfolio before change:  [-2.29558827]
curr_Stock_Price:  100.00032698457157
curr_Factors:  [100.00032698]
mat_Sqrt:  [[0.15]]
grads:  [0.02355335]
Stock Position:  0.02355335345446854
Bond Position:  [-4.65093132]


portfolio before change:  [-2.29710329]
curr_Stock_Price:  99.96068849573241
curr_Factors:  [99.9606885]
mat_Sqrt:  [[0.15]]
grads:  [0.05909969]
Stock Position:  0.05909968522467962
Bond Position:  [-8.20474852]


portfolio before change:  [-2.23676528]
curr_Stock_Price:  100.99899639510431
curr_Factors:  [100.9989964]
mat_Sqrt:  [[0.15]]
grads:  [0.05171133]
Stock Position:  0.05171133487185883
Bond Position:  [-7.45955821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29455966]
Stock Price:  99.89939458461916
PL:  [-2.29455966]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-6.18982921e-02]
 [ 4.38740826e-02]
 [-3.50633386e-03]
 [-6.50494569e-03]
 [-7.75017686e-03]
 [ 2.78139127e-02]
 [ 3.63127452e-03]
 [ 6.94761482e-03]
 [-1.33272621e-02]
 [ 2.30579578e-02]
 [ 1.98170107e-02]
 [-1.39704092e-02]
 [ 3.39354932e-03]
 [ 6.48651539e-03]
 [-4.97329480e-03]
 [-3.20143881e-03]
 [-5.98791346e-03]
 [ 6.78196370e-03]
 [ 7.60842174e-03]
 [ 1.52828900e-03]
 [-3.57424767e-03]
 [-5.99059027e-03]
 [ 4.83309710e-03]
 [-1.06353076e-02]
 [ 2.78133769e-03]
 [ 4.90623643e-03]
 [-1.65013134e-03]
 [-3.78093995e-04]
 [ 3.14760983e-03]
 [-6.47657875e-03]
 [-2.42314475e-02]
 [ 1.63727503e-02]
 [-3.38664692e-03]
 [-1.84714357e-02]
 [-2.02432598e-02]
 [ 1.78687061e-02]
 [ 3.76695504e-03]
 [ 2.36191590e-02]
 [ 1.03941773e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.35013063]
curr_Stock_Price:  101.66077280414882
curr_Factors:  [101.6607728]
mat_Sqrt:  [[0.15]]
grads:  [-0.41265528]
Stock Position:  -0.4126552808491437
Bond Position:  [80.30098539]


portfolio before change:  [38.85393565]
curr_Stock_Price:  100.46421290033355
curr_Factors:  [100.4642129]
mat_Sqrt:  [[0.15]]
grads:  [0.29249388]
Stock Position:  0.2924938837114708
Bond Position:  [9.46876784]


portfolio before change:  [38.94709951]
curr_Stock_Price:  100.77868167723449
curr_Factors:  [100.77868168]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337556]
Stock Position:  -0.023375559091099535
Bond Position:  [41.30285754]


portfolio before change:  [38.97329076]
curr_Stock_Price:  99.87910668999858
curr_Factors:  [99.87910669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433663]
Stock Position:  -0.04336630458691704
Bond Position:  [43.30467852]


portfolio before change:  [38.96597475]
curr_Stock_Price:  100.17263954701227
curr_Factors:  [100.17263955]
mat_Sqrt:  [[0.15]]
grads:  [-0.05166785]
Stock Position:  -0.05166784570628085
Bond Position:  [44.14167923]


portfolio before change:  [39.00001308]
curr_Stock_Price:  99.62064679488134
curr_Factors:  [99.62064679]
mat_Sqrt:  [[0.15]]
grads:  [0.18542608]
Stock Position:  0.18542608482455786
Bond Position:  [20.52774657]


portfolio before change:  [39.05680429]
curr_Stock_Price:  99.9130818287914
curr_Factors:  [99.91308183]
mat_Sqrt:  [[0.15]]
grads:  [0.0242085]
Stock Position:  0.024208496799248073
Bond Position:  [36.63805877]


portfolio before change:  [39.08923331]
curr_Stock_Price:  101.06346213350805
curr_Factors:  [101.06346213]
mat_Sqrt:  [[0.15]]
grads:  [0.04631743]
Stock Position:  0.046317432124789885
Bond Position:  [34.40823326]


portfolio before change:  [39.11458957]
curr_Stock_Price:  101.5180416625094
curr_Factors:  [101.51804166]
mat_Sqrt:  [[0.15]]
grads:  [-0.08884841]
Stock Position:  -0.08884841376973705
Bond Position:  [48.13430654]


portfolio before change:  [39.13088658]
curr_Stock_Price:  101.40234067986887
curr_Factors:  [101.40234068]
mat_Sqrt:  [[0.15]]
grads:  [0.15371972]
Stock Position:  0.1537197184994398
Bond Position:  [23.54334731]


portfolio before change:  [39.04754341]
curr_Stock_Price:  100.8410186085373
curr_Factors:  [100.84101861]
mat_Sqrt:  [[0.15]]
grads:  [0.1321134]
Stock Position:  0.1321134045005658
Bond Position:  [25.72509313]


portfolio before change:  [39.048193]
curr_Stock_Price:  100.82159399821978
curr_Factors:  [100.821594]
mat_Sqrt:  [[0.15]]
grads:  [-0.09313606]
Stock Position:  -0.09313606140958787
Bond Position:  [48.43831917]


portfolio before change:  [39.2682879]
curr_Stock_Price:  98.52345367116173
curr_Factors:  [98.52345367]
mat_Sqrt:  [[0.15]]
grads:  [0.02262366]
Stock Position:  0.022623662117966944
Bond Position:  [37.03932658]


portfolio before change:  [39.29702985]
curr_Stock_Price:  99.58922881976922
curr_Factors:  [99.58922882]
mat_Sqrt:  [[0.15]]
grads:  [0.04324344]
Stock Position:  0.043243435910434794
Bond Position:  [34.99044941]


portfolio before change:  [39.31099566]
curr_Stock_Price:  99.81103672549871
curr_Factors:  [99.81103673]
mat_Sqrt:  [[0.15]]
grads:  [-0.0331553]
Stock Position:  -0.033155298650091085
Bond Position:  [42.62026039]


portfolio before change:  [39.30670347]
curr_Stock_Price:  100.10118818230735
curr_Factors:  [100.10118818]
mat_Sqrt:  [[0.15]]
grads:  [-0.02134293]
Stock Position:  -0.021342925399322785
Bond Position:  [41.44315566]


portfolio before change:  [39.29068418]
curr_Stock_Price:  101.09449181969526
curr_Factors:  [101.09449182]
mat_Sqrt:  [[0.15]]
grads:  [-0.03991942]
Stock Position:  -0.039919423038813726
Bond Position:  [43.32631797]


portfolio before change:  [39.28145324]
curr_Stock_Price:  101.46140761831198
curr_Factors:  [101.46140762]
mat_Sqrt:  [[0.15]]
grads:  [0.04521309]
Stock Position:  0.04521309135222284
Bond Position:  [34.69406935]


portfolio before change:  [39.26462479]
curr_Stock_Price:  100.99328028771762
curr_Factors:  [100.99328029]
mat_Sqrt:  [[0.15]]
grads:  [0.05072281]
Stock Position:  0.05072281162794669
Bond Position:  [34.14196166]


portfolio before change:  [39.24067635]
curr_Stock_Price:  100.43699307603204
curr_Factors:  [100.43699308]
mat_Sqrt:  [[0.15]]
grads:  [0.01018859]
Stock Position:  0.010188593343352925
Bond Position:  [38.21736467]


portfolio before change:  [39.25571879]
curr_Stock_Price:  101.44448981032382
curr_Factors:  [101.44448981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02382832]
Stock Position:  -0.023828317774927235
Bond Position:  [41.67297033]


portfolio before change:  [39.25752333]
curr_Stock_Price:  101.58738333248854
curr_Factors:  [101.58738333]
mat_Sqrt:  [[0.15]]
grads:  [-0.03993727]
Stock Position:  -0.0399372684508103
Bond Position:  [43.31464593]


portfolio before change:  [39.26710359]
curr_Stock_Price:  101.48307987869543
curr_Factors:  [101.48307988]
mat_Sqrt:  [[0.15]]
grads:  [0.03222065]
Stock Position:  0.032220647355072574
Bond Position:  [35.99725306]


portfolio before change:  [39.25612319]
curr_Stock_Price:  101.00263206325482
curr_Factors:  [101.00263206]
mat_Sqrt:  [[0.15]]
grads:  [-0.07090205]
Stock Position:  -0.07090205045883076
Bond Position:  [46.4174169]


portfolio before change:  [39.19265229]
curr_Stock_Price:  101.97966212965957
curr_Factors:  [101.97966213]
mat_Sqrt:  [[0.15]]
grads:  [0.01854225]
Stock Position:  0.018542251284946742
Bond Position:  [37.30171977]


portfolio before change:  [39.18520542]
curr_Stock_Price:  101.32656568526835
curr_Factors:  [101.32656569]
mat_Sqrt:  [[0.15]]
grads:  [0.03270824]
Stock Position:  0.03270824287302248
Bond Position:  [35.8709915]


portfolio before change:  [39.22052407]
curr_Stock_Price:  102.26927887625988
curr_Factors:  [102.26927888]
mat_Sqrt:  [[0.15]]
grads:  [-0.01100088]
Stock Position:  -0.011000875570885034
Bond Position:  [40.34557568]


portfolio before change:  [39.23336212]
curr_Stock_Price:  101.56074055866927
curr_Factors:  [101.56074056]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252063]
Stock Position:  -0.002520626634878477
Bond Position:  [39.48935883]


portfolio before change:  [39.23607924]
curr_Stock_Price:  102.44122218746485
curr_Factors:  [102.44122219]
mat_Sqrt:  [[0.15]]
grads:  [0.02098407]
Stock Position:  0.02098406551072339
Bond Position:  [37.08644592]


portfolio before change:  [39.22108516]
curr_Stock_Price:  101.50574221487066
curr_Factors:  [101.50574221]
mat_Sqrt:  [[0.15]]
grads:  [-0.04317719]
Stock Position:  -0.04317719166347845
Bond Position:  [43.60381804]


portfolio before change:  [39.22850759]
curr_Stock_Price:  101.46007888362215
curr_Factors:  [101.46007888]
mat_Sqrt:  [[0.15]]
grads:  [-0.16154298]
Stock Position:  -0.1615429834254593
Bond Position:  [55.61867143]


portfolio before change:  [39.20094056]
curr_Stock_Price:  101.6737668734614
curr_Factors:  [101.67376687]
mat_Sqrt:  [[0.15]]
grads:  [0.10915167]
Stock Position:  0.10915166840247029
Bond Position:  [28.10307928]


portfolio before change:  [39.18104119]
curr_Stock_Price:  101.45927196923022
curr_Factors:  [101.45927197]
mat_Sqrt:  [[0.15]]
grads:  [-0.02257765]
Stock Position:  -0.022577646104832434
Bond Position:  [41.47175273]


portfolio before change:  [39.18669757]
curr_Stock_Price:  101.43836253568031
curr_Factors:  [101.43836254]
mat_Sqrt:  [[0.15]]
grads:  [-0.1231429]
Stock Position:  -0.12314290479019571
Bond Position:  [51.67811219]


portfolio before change:  [38.88709595]
curr_Stock_Price:  103.92378215952434
curr_Factors:  [103.92378216]
mat_Sqrt:  [[0.15]]
grads:  [-0.13495507]
Stock Position:  -0.13495506555877584
Bond Position:  [52.91213678]


portfolio before change:  [38.991885]
curr_Stock_Price:  103.19632057707072
curr_Factors:  [103.19632058]
mat_Sqrt:  [[0.15]]
grads:  [0.11912471]
Stock Position:  0.11912470740574248
Bond Position:  [26.69865351]


portfolio before change:  [38.87698404]
curr_Stock_Price:  102.20375991638258
curr_Factors:  [102.20375992]
mat_Sqrt:  [[0.15]]
grads:  [0.02511303]
Stock Position:  0.025113033617031023
Bond Position:  [36.31033758]


portfolio before change:  [38.92553563]
curr_Stock_Price:  103.95633622506763
curr_Factors:  [103.95633623]
mat_Sqrt:  [[0.15]]
grads:  [0.15746106]
Stock Position:  0.15746106025242282
Bond Position:  [22.55646071]


portfolio before change:  [38.81887953]
curr_Stock_Price:  103.26107971038006
curr_Factors:  [103.26107971]
mat_Sqrt:  [[0.15]]
grads:  [0.06929452]
Stock Position:  0.06929451556529526
Bond Position:  [31.66345304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.8622894]
Stock Price:  103.83041326335851
PL:  [35.03187614]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 3.20423299e-02]
 [ 1.29261515e-02]
 [-1.12353510e-02]
 [-7.54054059e-03]
 [-6.49041726e-03]
 [ 2.86932927e-02]
 [ 3.60513984e-03]
 [ 1.76990505e-03]
 [-2.74181033e-02]
 [ 2.33925109e-02]
 [ 2.00689353e-02]
 [-1.26475248e-02]
 [ 3.08845626e-02]
 [ 7.75603596e-03]
 [ 2.76017272e-03]
 [-2.04041390e-03]
 [-6.08271734e-03]
 [ 3.36677570e-03]
 [ 5.96591626e-03]
 [-1.77299640e-02]
 [-4.93200925e-03]
 [-4.55001467e-03]
 [ 7.08941326e-03]
 [-8.41172006e-03]
 [ 1.54023352e-02]
 [ 7.39771041e-03]
 [-6.43393950e-03]
 [-3.08202389e-03]
 [-1.91044661e-02]
 [-1.32005870e-02]
 [ 3.23171302e-02]
 [ 9.90319616e-03]
 [-1.06313517e-02]
 [-4.70734038e-02]
 [-2.29869132e-02]
 [ 3.98766968e-02]
 [ 4.03268360e-04]
 [ 6.89780220e-03]
 [ 6.57742331e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-30.454726]
curr_Stock_Price:  98.52698326400792
curr_Factors:  [98.52698326]
mat_Sqrt:  [[0.15]]
grads:  [0.21361553]
Stock Position:  0.21361553261373467
Bond Position:  [-51.50162001]


portfolio before change:  [-30.43041187]
curr_Stock_Price:  98.67094395219239
curr_Factors:  [98.67094395]
mat_Sqrt:  [[0.15]]
grads:  [0.08617434]
Stock Position:  0.08617434313330272
Bond Position:  [-38.93331565]


portfolio before change:  [-30.38431955]
curr_Stock_Price:  99.26229494108723
curr_Factors:  [99.26229494]
mat_Sqrt:  [[0.15]]
grads:  [-0.07490234]
Stock Position:  -0.07490233968489368
Bond Position:  [-22.94934142]


portfolio before change:  [-30.32460744]
curr_Stock_Price:  98.42679424579259
curr_Factors:  [98.42679425]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027027]
Stock Position:  -0.050270270567854575
Bond Position:  [-25.37666586]


portfolio before change:  [-30.35817321]
curr_Stock_Price:  99.03139582012658
curr_Factors:  [99.03139582]
mat_Sqrt:  [[0.15]]
grads:  [-0.04326945]
Stock Position:  -0.043269448393643814
Bond Position:  [-26.07313934]


portfolio before change:  [-30.36723068]
curr_Stock_Price:  99.16539622702183
curr_Factors:  [99.16539623]
mat_Sqrt:  [[0.15]]
grads:  [0.19128862]
Stock Position:  0.1912886181805068
Bond Position:  [-49.33644229]


portfolio before change:  [-30.26317636]
curr_Stock_Price:  99.74160278142371
curr_Factors:  [99.74160278]
mat_Sqrt:  [[0.15]]
grads:  [0.02403427]
Stock Position:  0.024034265600456205
Bond Position:  [-32.66039253]


portfolio before change:  [-30.26409982]
curr_Stock_Price:  99.87305450274151
curr_Factors:  [99.8730545]
mat_Sqrt:  [[0.15]]
grads:  [0.01179937]
Stock Position:  0.011799367026801608
Bond Position:  [-31.44253865]


portfolio before change:  [-30.26819364]
curr_Stock_Price:  99.85921875651617
curr_Factors:  [99.85921876]
mat_Sqrt:  [[0.15]]
grads:  [-0.18278736]
Stock Position:  -0.18278735507417304
Bond Position:  [-12.01519116]


portfolio before change:  [-30.30813286]
curr_Stock_Price:  100.06950260596129
curr_Factors:  [100.06950261]
mat_Sqrt:  [[0.15]]
grads:  [0.15595007]
Stock Position:  0.1559500723739237
Bond Position:  [-45.91397903]


portfolio before change:  [-30.10652911]
curr_Stock_Price:  101.3990521904471
curr_Factors:  [101.39905219]
mat_Sqrt:  [[0.15]]
grads:  [0.1337929]
Stock Position:  0.1337929020708407
Bond Position:  [-43.67300257]


portfolio before change:  [-30.12406226]
curr_Stock_Price:  101.30881059242428
curr_Factors:  [101.30881059]
mat_Sqrt:  [[0.15]]
grads:  [-0.08431683]
Stock Position:  -0.08431683221686007
Bond Position:  [-21.58202428]


portfolio before change:  [-30.08875266]
curr_Stock_Price:  100.85804029102106
curr_Factors:  [100.85804029]
mat_Sqrt:  [[0.15]]
grads:  [0.20589708]
Stock Position:  0.2058970837688373
Bond Position:  [-50.85512903]


portfolio before change:  [-30.15915977]
curr_Stock_Price:  100.54696339360552
curr_Factors:  [100.54696339]
mat_Sqrt:  [[0.15]]
grads:  [0.05170691]
Stock Position:  0.05170690637464295
Bond Position:  [-35.3581322]


portfolio before change:  [-30.17283421]
curr_Stock_Price:  100.36798544329129
curr_Factors:  [100.36798544]
mat_Sqrt:  [[0.15]]
grads:  [0.01840115]
Stock Position:  0.018401151490529274
Bond Position:  [-32.01972072]


portfolio before change:  [-30.19199665]
curr_Stock_Price:  99.54413926476818
curr_Factors:  [99.54413926]
mat_Sqrt:  [[0.15]]
grads:  [-0.01360276]
Stock Position:  -0.013602759308257873
Bond Position:  [-28.83792168]


portfolio before change:  [-30.19024479]
curr_Stock_Price:  99.15033491712889
curr_Factors:  [99.15033492]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055145]
Stock Position:  -0.04055144892102248
Bond Position:  [-26.16955504]


portfolio before change:  [-30.17774833]
curr_Stock_Price:  98.76149908801517
curr_Factors:  [98.76149909]
mat_Sqrt:  [[0.15]]
grads:  [0.02244517]
Stock Position:  0.02244517136425818
Bond Position:  [-32.3944671]


portfolio before change:  [-30.16649286]
curr_Stock_Price:  99.44338415025203
curr_Factors:  [99.44338415]
mat_Sqrt:  [[0.15]]
grads:  [0.03977278]
Stock Position:  0.03977277508832975
Bond Position:  [-34.12163222]


portfolio before change:  [-30.16851779]
curr_Stock_Price:  99.49971765785718
curr_Factors:  [99.49971766]
mat_Sqrt:  [[0.15]]
grads:  [-0.11819976]
Stock Position:  -0.11819976029329256
Bond Position:  [-18.40767502]


portfolio before change:  [-30.27914186]
curr_Stock_Price:  100.41615745044722
curr_Factors:  [100.41615745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03288006]
Stock Position:  -0.03288006169781015
Bond Position:  [-26.97745241]


portfolio before change:  [-30.2857269]
curr_Stock_Price:  100.51386549074587
curr_Factors:  [100.51386549]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033343]
Stock Position:  -0.030333431166325853
Bond Position:  [-27.23679648]


portfolio before change:  [-30.26220679]
curr_Stock_Price:  99.62623339653216
curr_Factors:  [99.6262334]
mat_Sqrt:  [[0.15]]
grads:  [0.04726276]
Stock Position:  0.04726275508885632
Bond Position:  [-34.97081705]


portfolio before change:  [-30.2409818]
curr_Stock_Price:  100.16781437829154
curr_Factors:  [100.16781438]
mat_Sqrt:  [[0.15]]
grads:  [-0.05607813]
Stock Position:  -0.056078133701486954
Bond Position:  [-24.62375771]


portfolio before change:  [-30.18379715]
curr_Stock_Price:  99.09319207279546
curr_Factors:  [99.09319207]
mat_Sqrt:  [[0.15]]
grads:  [0.10268223]
Stock Position:  0.1026822343430404
Bond Position:  [-40.35890752]


portfolio before change:  [-30.22426381]
curr_Stock_Price:  98.74822995954884
curr_Factors:  [98.74822996]
mat_Sqrt:  [[0.15]]
grads:  [0.04931807]
Stock Position:  0.04931806940686516
Bond Position:  [-35.09433587]


portfolio before change:  [-30.21788808]
curr_Stock_Price:  98.96646232787654
curr_Factors:  [98.96646233]
mat_Sqrt:  [[0.15]]
grads:  [-0.04289293]
Stock Position:  -0.04289292996831391
Bond Position:  [-25.97292654]


portfolio before change:  [-30.1893461]
curr_Stock_Price:  98.22534272910339
curr_Factors:  [98.22534273]
mat_Sqrt:  [[0.15]]
grads:  [-0.02054683]
Stock Position:  -0.020546825957147522
Bond Position:  [-28.17112708]


portfolio before change:  [-30.16549048]
curr_Stock_Price:  96.89291114964398
curr_Factors:  [96.89291115]
mat_Sqrt:  [[0.15]]
grads:  [-0.12736311]
Stock Position:  -0.12736310707845838
Bond Position:  [-17.82490826]


portfolio before change:  [-30.20829683]
curr_Stock_Price:  97.21151284490782
curr_Factors:  [97.21151284]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800391]
Stock Position:  -0.08800391339479482
Bond Position:  [-21.65330327]


portfolio before change:  [-30.22361312]
curr_Stock_Price:  97.35479577188435
curr_Factors:  [97.35479577]
mat_Sqrt:  [[0.15]]
grads:  [0.21544753]
Stock Position:  0.21544753448555523
Bond Position:  [-51.19846384]


portfolio before change:  [-30.06059484]
curr_Stock_Price:  98.1411519010847
curr_Factors:  [98.1411519]
mat_Sqrt:  [[0.15]]
grads:  [0.06602131]
Stock Position:  0.0660213077254018
Bond Position:  [-36.54000203]


portfolio before change:  [-30.04818632]
curr_Stock_Price:  98.3982855572962
curr_Factors:  [98.39828556]
mat_Sqrt:  [[0.15]]
grads:  [-0.07087568]
Stock Position:  -0.070875678011196
Bond Position:  [-23.07414112]


portfolio before change:  [-30.02134767]
curr_Stock_Price:  97.97891604435466
curr_Factors:  [97.97891604]
mat_Sqrt:  [[0.15]]
grads:  [-0.31382269]
Stock Position:  -0.3138226918417777
Bond Position:  [0.7266595]


portfolio before change:  [-29.52851558]
curr_Stock_Price:  96.40878975745368
curr_Factors:  [96.40878976]
mat_Sqrt:  [[0.15]]
grads:  [-0.15324609]
Stock Position:  -0.15324608817424717
Bond Position:  [-14.75424568]


portfolio before change:  [-29.61129264]
curr_Stock_Price:  96.93691198719868
curr_Factors:  [96.93691199]
mat_Sqrt:  [[0.15]]
grads:  [0.26584465]
Stock Position:  0.26584464547059067
Bond Position:  [-55.38145164]


portfolio before change:  [-29.50398277]
curr_Stock_Price:  97.36661025359265
curr_Factors:  [97.36661025]
mat_Sqrt:  [[0.15]]
grads:  [0.00268846]
Stock Position:  0.00268845573627752
Bond Position:  [-29.76574859]


portfolio before change:  [-29.50647886]
curr_Stock_Price:  97.82221012378075
curr_Factors:  [97.82221012]
mat_Sqrt:  [[0.15]]
grads:  [0.04598535]
Stock Position:  0.045985348028348534
Bond Position:  [-34.00486724]


portfolio before change:  [-29.51249671]
curr_Stock_Price:  97.78378549117609
curr_Factors:  [97.78378549]
mat_Sqrt:  [[0.15]]
grads:  [0.04384949]
Stock Position:  0.043849488733317184
Bond Position:  [-33.80026571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.54229469]
Stock Price:  97.2005931097016
PL:  [-29.54229469]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.42132431e-03]
 [ 2.84660201e-02]
 [-1.94748923e-03]
 [-2.65604119e-03]
 [-2.54813117e-03]
 [ 1.74147541e-02]
 [ 3.46578028e-03]
 [ 2.32409273e-02]
 [ 9.87360244e-03]
 [ 2.26773781e-02]
 [ 1.53299417e-02]
 [ 2.89958127e-03]
 [-3.77658057e-03]
 [ 2.32691627e-02]
 [-7.99638685e-03]
 [-4.87047828e-03]
 [-4.57760500e-03]
 [ 7.40154400e-03]
 [ 1.49148080e-02]
 [ 1.60748364e-02]
 [-2.39336388e-03]
 [-4.70859913e-03]
 [ 4.80672924e-03]
 [-1.18285736e-02]
 [-9.00164778e-04]
 [ 3.40699285e-03]
 [-7.98701838e-04]
 [ 1.12680276e-03]
 [ 2.83975350e-03]
 [-6.66223280e-03]
 [-2.58946742e-02]
 [ 1.89041459e-02]
 [-4.85802270e-03]
 [-1.98736141e-02]
 [-2.11044824e-02]
 [ 2.83308851e-02]
 [ 4.35270150e-03]
 [ 1.69076077e-02]
 [ 1.01761465e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.50305005]
curr_Stock_Price:  100.39244823940683
curr_Factors:  [100.39244824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280883]
Stock Position:  -0.02280882875254065
Bond Position:  [12.79288421]


portfolio before change:  [10.53125956]
curr_Stock_Price:  99.22578198019916
curr_Factors:  [99.22578198]
mat_Sqrt:  [[0.15]]
grads:  [0.18977347]
Stock Position:  0.1897734673903101
Bond Position:  [-8.29916115]


portfolio before change:  [10.63887865]
curr_Stock_Price:  99.7983412208156
curr_Factors:  [99.79834122]
mat_Sqrt:  [[0.15]]
grads:  [-0.01298326]
Stock Position:  -0.012983261515558214
Bond Position:  [11.93458661]


portfolio before change:  [10.62180975]
curr_Stock_Price:  101.22793655946202
curr_Factors:  [101.22793656]
mat_Sqrt:  [[0.15]]
grads:  [-0.01770694]
Stock Position:  -0.01770694127171759
Bond Position:  [12.41424688]


portfolio before change:  [10.61856448]
curr_Stock_Price:  101.49885605914088
curr_Factors:  [101.49885606]
mat_Sqrt:  [[0.15]]
grads:  [-0.01698754]
Stock Position:  -0.016987541137985642
Bond Position:  [12.34278047]


portfolio before change:  [10.61228372]
curr_Stock_Price:  101.95941125214533
curr_Factors:  [101.95941125]
mat_Sqrt:  [[0.15]]
grads:  [0.11609836]
Stock Position:  0.11609836051963345
Bond Position:  [-1.22503677]


portfolio before change:  [10.71038374]
curr_Stock_Price:  102.80570366842045
curr_Factors:  [102.80570367]
mat_Sqrt:  [[0.15]]
grads:  [0.0231052]
Stock Position:  0.023105201878359537
Bond Position:  [8.33503721]


portfolio before change:  [10.71025886]
curr_Stock_Price:  102.75520297264833
curr_Factors:  [102.75520297]
mat_Sqrt:  [[0.15]]
grads:  [0.15493952]
Stock Position:  0.1549395150979038
Bond Position:  [-5.21058246]


portfolio before change:  [10.68397126]
curr_Stock_Price:  102.58974332970337
curr_Factors:  [102.58974333]
mat_Sqrt:  [[0.15]]
grads:  [0.06582402]
Stock Position:  0.06582401627568918
Bond Position:  [3.93110232]


portfolio before change:  [10.73846499]
curr_Stock_Price:  103.41014769085083
curr_Factors:  [103.41014769]
mat_Sqrt:  [[0.15]]
grads:  [0.15118252]
Stock Position:  0.15118252099043697
Bond Position:  [-4.89534184]


portfolio before change:  [10.8819541]
curr_Stock_Price:  104.36330725038736
curr_Factors:  [104.36330725]
mat_Sqrt:  [[0.15]]
grads:  [0.10219961]
Stock Position:  0.1021996111482935
Bond Position:  [0.21606468]


portfolio before change:  [10.8430252]
curr_Stock_Price:  103.9821325169499
curr_Factors:  [103.98213252]
mat_Sqrt:  [[0.15]]
grads:  [0.01933054]
Stock Position:  0.01933054180544149
Bond Position:  [8.83299424]


portfolio before change:  [10.86911049]
curr_Stock_Price:  105.27444486326867
curr_Factors:  [105.27444486]
mat_Sqrt:  [[0.15]]
grads:  [-0.0251772]
Stock Position:  -0.02517720378010065
Bond Position:  [13.51962664]


portfolio before change:  [10.85715934]
curr_Stock_Price:  105.81625271873943
curr_Factors:  [105.81625272]
mat_Sqrt:  [[0.15]]
grads:  [0.15512775]
Stock Position:  0.15512775145129926
Bond Position:  [-5.55787801]


portfolio before change:  [10.81071985]
curr_Stock_Price:  105.52136859881058
curr_Factors:  [105.5213686]
mat_Sqrt:  [[0.15]]
grads:  [-0.05330925]
Stock Position:  -0.05330924564413367
Bond Position:  [16.43598441]


portfolio before change:  [10.81526327]
curr_Stock_Price:  105.47468275483571
curr_Factors:  [105.47468275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03246986]
Stock Position:  -0.0324698551695231
Bond Position:  [14.24001094]


portfolio before change:  [10.84971566]
curr_Stock_Price:  104.4684484192989
curr_Factors:  [104.46844842]
mat_Sqrt:  [[0.15]]
grads:  [-0.03051737]
Stock Position:  -0.030517366654734132
Bond Position:  [14.03781761]


portfolio before change:  [10.90258588]
curr_Stock_Price:  102.79348802841642
curr_Factors:  [102.79348803]
mat_Sqrt:  [[0.15]]
grads:  [0.04934363]
Stock Position:  0.04934362665751518
Bond Position:  [5.83038238]


portfolio before change:  [10.88821567]
curr_Stock_Price:  102.48748995960894
curr_Factors:  [102.48748996]
mat_Sqrt:  [[0.15]]
grads:  [0.09943205]
Stock Position:  0.0994320532429693
Bond Position:  [0.69767411]


portfolio before change:  [10.831338]
curr_Stock_Price:  101.91458739517624
curr_Factors:  [101.9145874]
mat_Sqrt:  [[0.15]]
grads:  [0.10716558]
Stock Position:  0.10716557571212759
Bond Position:  [-0.09039743]


portfolio before change:  [10.83336005]
curr_Stock_Price:  101.93356131959995
curr_Factors:  [101.93356132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01595576]
Stock Position:  -0.015955759210522263
Bond Position:  [12.45978741]


portfolio before change:  [10.82822243]
curr_Stock_Price:  102.35317104151984
curr_Factors:  [102.35317104]
mat_Sqrt:  [[0.15]]
grads:  [-0.03139066]
Stock Position:  -0.03139066089378733
Bond Position:  [14.04115612]


portfolio before change:  [10.78496882]
curr_Stock_Price:  103.78700087011374
curr_Factors:  [103.78700087]
mat_Sqrt:  [[0.15]]
grads:  [0.03204486]
Stock Position:  0.03204486160078738
Bond Position:  [7.45912874]


portfolio before change:  [10.75898611]
curr_Stock_Price:  102.9470797158224
curr_Factors:  [102.94707972]
mat_Sqrt:  [[0.15]]
grads:  [-0.07885716]
Stock Position:  -0.078857157516754
Bond Position:  [18.8771002]


portfolio before change:  [10.72729169]
curr_Stock_Price:  103.37892647642215
curr_Factors:  [103.37892648]
mat_Sqrt:  [[0.15]]
grads:  [-0.0060011]
Stock Position:  -0.006001098520248601
Bond Position:  [11.34767881]


portfolio before change:  [10.73231135]
curr_Stock_Price:  102.77885185542267
curr_Factors:  [102.77885186]
mat_Sqrt:  [[0.15]]
grads:  [0.02271329]
Stock Position:  0.022713285646361648
Bond Position:  [8.39786593]


portfolio before change:  [10.73089591]
curr_Stock_Price:  102.67031476076431
curr_Factors:  [102.67031476]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532468]
Stock Position:  -0.0053246789178859385
Bond Position:  [11.27758237]


portfolio before change:  [10.73037605]
curr_Stock_Price:  103.03271213251928
curr_Factors:  [103.03271213]
mat_Sqrt:  [[0.15]]
grads:  [0.00751202]
Stock Position:  0.007512018414387948
Bond Position:  [9.95639242]


portfolio before change:  [10.72581247]
curr_Stock_Price:  102.25952344308789
curr_Factors:  [102.25952344]
mat_Sqrt:  [[0.15]]
grads:  [0.01893169]
Stock Position:  0.018931690031433066
Bond Position:  [8.78986687]


portfolio before change:  [10.70542152]
curr_Stock_Price:  101.12440322119998
curr_Factors:  [101.12440322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04441489]
Stock Position:  -0.04441488532145101
Bond Position:  [15.1968503]


portfolio before change:  [10.73614226]
curr_Stock_Price:  100.47549892254233
curr_Factors:  [100.47549892]
mat_Sqrt:  [[0.15]]
grads:  [-0.17263116]
Stock Position:  -0.17263116159105252
Bond Position:  [28.08134435]


portfolio before change:  [10.65107851]
curr_Stock_Price:  100.98858207993527
curr_Factors:  [100.98858208]
mat_Sqrt:  [[0.15]]
grads:  [0.12602764]
Stock Position:  0.12602763958314134
Bond Position:  [-2.07627412]


portfolio before change:  [10.62115329]
curr_Stock_Price:  100.7531918907098
curr_Factors:  [100.75319189]
mat_Sqrt:  [[0.15]]
grads:  [-0.03238682]
Stock Position:  -0.032386818005992996
Bond Position:  [13.88422857]


portfolio before change:  [10.63266479]
curr_Stock_Price:  100.45134466218693
curr_Factors:  [100.45134466]
mat_Sqrt:  [[0.15]]
grads:  [-0.13249076]
Stock Position:  -0.13249076064706586
Bond Position:  [23.94153986]


portfolio before change:  [10.60925247]
curr_Stock_Price:  100.65064308148527
curr_Factors:  [100.65064308]
mat_Sqrt:  [[0.15]]
grads:  [-0.14069655]
Stock Position:  -0.1406965491097842
Bond Position:  [24.77045062]


portfolio before change:  [10.69200952]
curr_Stock_Price:  100.08445617637064
curr_Factors:  [100.08445618]
mat_Sqrt:  [[0.15]]
grads:  [0.18887257]
Stock Position:  0.18887256719010131
Bond Position:  [-8.21119866]


portfolio before change:  [10.81784906]
curr_Stock_Price:  100.75615776678573
curr_Factors:  [100.75615777]
mat_Sqrt:  [[0.15]]
grads:  [0.02901801]
Stock Position:  0.029018010022530013
Bond Position:  [7.89410586]


portfolio before change:  [10.86008838]
curr_Stock_Price:  102.17777488587438
curr_Factors:  [102.17777489]
mat_Sqrt:  [[0.15]]
grads:  [0.11271738]
Stock Position:  0.11271738459533401
Bond Position:  [-0.65712317]


portfolio before change:  [10.94090795]
curr_Stock_Price:  102.89551432943277
curr_Factors:  [102.89551433]
mat_Sqrt:  [[0.15]]
grads:  [0.06784098]
Stock Position:  0.06784097662483794
Bond Position:  [3.96037577]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.90023379]
Stock Price:  102.28866527493742
PL:  [8.61156852]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.67900803e-02]
 [-1.62273834e-02]
 [ 1.99233306e-03]
 [-2.18487911e-03]
 [-2.33060640e-03]
 [ 1.29885560e-02]
 [ 3.41736973e-03]
 [ 1.95099625e-02]
 [ 5.93910010e-02]
 [ 2.26320092e-02]
 [ 1.51821444e-02]
 [ 9.92488534e-04]
 [ 3.36113139e-03]
 [ 2.25727540e-02]
 [-9.06773909e-03]
 [-3.75355192e-03]
 [-6.02444001e-03]
 [ 5.17857776e-03]
 [ 6.29457340e-03]
 [-2.30072368e-02]
 [-3.18375564e-03]
 [-1.39065898e-02]
 [ 6.38095958e-03]
 [-1.09798356e-02]
 [ 5.31515179e-04]
 [ 3.63299732e-03]
 [-2.15829318e-05]
 [ 1.21450039e-03]
 [ 4.83701108e-03]
 [-4.47069018e-03]
 [-1.46674904e-02]
 [ 5.01689053e-03]
 [ 5.29269280e-03]
 [ 4.54506947e-02]
 [-2.01114111e-02]
 [-1.95845102e-02]
 [ 2.61205902e-02]
 [ 1.29319845e-02]
 [ 8.10071326e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.25018165]
curr_Stock_Price:  100.74529949373829
curr_Factors:  [100.74529949]
mat_Sqrt:  [[0.15]]
grads:  [-0.2452672]
Stock Position:  -0.24526720173364594
Bond Position:  [42.95969935]


portfolio before change:  [18.05304759]
curr_Stock_Price:  101.5709474367862
curr_Factors:  [101.57094744]
mat_Sqrt:  [[0.15]]
grads:  [-0.10818256]
Stock Position:  -0.10818255576419453
Bond Position:  [29.04125227]


portfolio before change:  [18.05575862]
curr_Stock_Price:  101.57944562461202
curr_Factors:  [101.57944562]
mat_Sqrt:  [[0.15]]
grads:  [0.01328222]
Stock Position:  0.013282220398464797
Bond Position:  [16.70655803]


portfolio before change:  [18.04910379]
curr_Stock_Price:  100.9211761812816
curr_Factors:  [100.92117618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01456586]
Stock Position:  -0.014565860732239543
Bond Position:  [19.51910758]


portfolio before change:  [18.04124588]
curr_Stock_Price:  101.62816823994108
curr_Factors:  [101.62816824]
mat_Sqrt:  [[0.15]]
grads:  [-0.01553738]
Stock Position:  -0.015537375992289654
Bond Position:  [19.62028094]


portfolio before change:  [18.03567846]
curr_Stock_Price:  102.14434986184398
curr_Factors:  [102.14434986]
mat_Sqrt:  [[0.15]]
grads:  [0.08659037]
Stock Position:  0.08659037336422161
Bond Position:  [9.19096107]


portfolio before change:  [18.16521667]
curr_Stock_Price:  103.62706977365987
curr_Factors:  [103.62706977]
mat_Sqrt:  [[0.15]]
grads:  [0.02278246]
Stock Position:  0.022782464863523807
Bond Position:  [15.8043366]


portfolio before change:  [18.13915777]
curr_Stock_Price:  102.39653683904211
curr_Factors:  [102.39653684]
mat_Sqrt:  [[0.15]]
grads:  [0.13006642]
Stock Position:  0.1300664166446924
Bond Position:  [4.82080714]


portfolio before change:  [18.34706898]
curr_Stock_Price:  103.99040385096505
curr_Factors:  [103.99040385]
mat_Sqrt:  [[0.15]]
grads:  [0.39594001]
Stock Position:  0.39594000682685004
Bond Position:  [-22.82689224]


portfolio before change:  [18.21848566]
curr_Stock_Price:  103.67285631277402
curr_Factors:  [103.67285631]
mat_Sqrt:  [[0.15]]
grads:  [0.15088006]
Stock Position:  0.15088006162491094
Bond Position:  [2.57631871]


portfolio before change:  [18.37584762]
curr_Stock_Price:  104.71368235217373
curr_Factors:  [104.71368235]
mat_Sqrt:  [[0.15]]
grads:  [0.1012143]
Stock Position:  0.10121429607958442
Bond Position:  [7.77732597]


portfolio before change:  [18.26985211]
curr_Stock_Price:  103.65683825792206
curr_Factors:  [103.65683826]
mat_Sqrt:  [[0.15]]
grads:  [0.00661659]
Stock Position:  0.006616590223517382
Bond Position:  [17.58399729]


portfolio before change:  [18.26899047]
curr_Stock_Price:  103.19439694286702
curr_Factors:  [103.19439694]
mat_Sqrt:  [[0.15]]
grads:  [0.02240754]
Stock Position:  0.022407542627269107
Bond Position:  [15.95665762]


portfolio before change:  [18.24762435]
curr_Stock_Price:  102.15185394195228
curr_Factors:  [102.15185394]
mat_Sqrt:  [[0.15]]
grads:  [0.15048503]
Stock Position:  0.1504850266467774
Bond Position:  [2.87529988]


portfolio before change:  [18.14966833]
curr_Stock_Price:  101.49853016132744
curr_Factors:  [101.49853016]
mat_Sqrt:  [[0.15]]
grads:  [-0.06045159]
Stock Position:  -0.0604515939508916
Bond Position:  [24.28541627]


portfolio before change:  [18.20519325]
curr_Stock_Price:  100.6302478058693
curr_Factors:  [100.63024781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502368]
Stock Position:  -0.025023679488565556
Bond Position:  [20.72333232]


portfolio before change:  [18.25506361]
curr_Stock_Price:  98.74084639737733
curr_Factors:  [98.7408464]
mat_Sqrt:  [[0.15]]
grads:  [-0.04016293]
Stock Position:  -0.04016293340815919
Bond Position:  [22.22078565]


portfolio before change:  [18.2085507]
curr_Stock_Price:  99.96811441158682
curr_Factors:  [99.96811441]
mat_Sqrt:  [[0.15]]
grads:  [0.03452385]
Stock Position:  0.034523851720886664
Bond Position:  [14.75726634]


portfolio before change:  [18.20305858]
curr_Stock_Price:  99.75559782608119
curr_Factors:  [99.75559783]
mat_Sqrt:  [[0.15]]
grads:  [0.04196382]
Stock Position:  0.041963822666283755
Bond Position:  [14.01693236]


portfolio before change:  [18.17712468]
curr_Stock_Price:  99.09583604833914
curr_Factors:  [99.09583605]
mat_Sqrt:  [[0.15]]
grads:  [-0.15338158]
Stock Position:  -0.15338157855941048
Bond Position:  [33.37660044]


portfolio before change:  [18.13335217]
curr_Stock_Price:  99.40842145630441
curr_Factors:  [99.40842146]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122504]
Stock Position:  -0.021225037591713927
Bond Position:  [20.24329965]


portfolio before change:  [18.16414336]
curr_Stock_Price:  98.07694568097426
curr_Factors:  [98.07694568]
mat_Sqrt:  [[0.15]]
grads:  [-0.0927106]
Stock Position:  -0.09271059843245648
Bond Position:  [27.25691569]


portfolio before change:  [17.93479076]
curr_Stock_Price:  100.58755329197376
curr_Factors:  [100.58755329]
mat_Sqrt:  [[0.15]]
grads:  [0.04253973]
Stock Position:  0.04253973056177683
Bond Position:  [13.65582334]


portfolio before change:  [17.95936973]
curr_Stock_Price:  101.12521269835463
curr_Factors:  [101.1252127]
mat_Sqrt:  [[0.15]]
grads:  [-0.0731989]
Stock Position:  -0.07319890420011868
Bond Position:  [25.36162449]


portfolio before change:  [17.84064524]
curr_Stock_Price:  102.79046833755255
curr_Factors:  [102.79046834]
mat_Sqrt:  [[0.15]]
grads:  [0.00354343]
Stock Position:  0.0035434345235949307
Bond Position:  [17.47641395]


portfolio before change:  [17.84348082]
curr_Stock_Price:  102.9741562446123
curr_Factors:  [102.97415624]
mat_Sqrt:  [[0.15]]
grads:  [0.02421998]
Stock Position:  0.024219982143917684
Bond Position:  [15.34944859]


portfolio before change:  [17.84370004]
curr_Stock_Price:  102.90398389137931
curr_Factors:  [102.90398389]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014389]
Stock Position:  -0.00014388621222715647
Bond Position:  [17.85850651]


portfolio before change:  [17.84589269]
curr_Stock_Price:  103.18061373528852
curr_Factors:  [103.18061374]
mat_Sqrt:  [[0.15]]
grads:  [0.00809667]
Stock Position:  0.00809666924462121
Bond Position:  [17.01047339]


portfolio before change:  [17.85220651]
curr_Stock_Price:  103.69778607306336
curr_Factors:  [103.69778607]
mat_Sqrt:  [[0.15]]
grads:  [0.03224674]
Stock Position:  0.032246740526612666
Bond Position:  [14.50829091]


portfolio before change:  [17.87679128]
curr_Stock_Price:  104.40393887033575
curr_Factors:  [104.40393887]
mat_Sqrt:  [[0.15]]
grads:  [-0.0298046]
Stock Position:  -0.02980460119154421
Bond Position:  [20.98850905]


portfolio before change:  [17.85399546]
curr_Stock_Price:  105.25681237016387
curr_Factors:  [105.25681237]
mat_Sqrt:  [[0.15]]
grads:  [-0.09778327]
Stock Position:  -0.09778326933194408
Bond Position:  [28.14635069]


portfolio before change:  [17.86729357]
curr_Stock_Price:  105.15679937093748
curr_Factors:  [105.15679937]
mat_Sqrt:  [[0.15]]
grads:  [0.03344594]
Stock Position:  0.03344593689137573
Bond Position:  [14.35022589]


portfolio before change:  [17.87886186]
curr_Stock_Price:  105.44904410667927
curr_Factors:  [105.44904411]
mat_Sqrt:  [[0.15]]
grads:  [0.03528462]
Stock Position:  0.03528461867160426
Bond Position:  [14.15813255]


portfolio before change:  [17.90666691]
curr_Stock_Price:  106.18690600422975
curr_Factors:  [106.186906]
mat_Sqrt:  [[0.15]]
grads:  [0.30300463]
Stock Position:  0.3030046310959396
Bond Position:  [-14.26845737]


portfolio before change:  [17.80869949]
curr_Stock_Price:  105.86947272071949
curr_Factors:  [105.86947272]
mat_Sqrt:  [[0.15]]
grads:  [-0.13407607]
Stock Position:  -0.13407607425051307
Bond Position:  [32.00326277]


portfolio before change:  [17.64898508]
curr_Stock_Price:  107.09053369534462
curr_Factors:  [107.0905337]
mat_Sqrt:  [[0.15]]
grads:  [-0.1305634]
Stock Position:  -0.13056340146354106
Bond Position:  [31.63108943]


portfolio before change:  [17.52582983]
curr_Stock_Price:  108.06407903480276
curr_Factors:  [108.06407903]
mat_Sqrt:  [[0.15]]
grads:  [0.17413727]
Stock Position:  0.17413726785430894
Bond Position:  [-1.29215365]


portfolio before change:  [17.49593895]
curr_Stock_Price:  107.89335540530374
curr_Factors:  [107.89335541]
mat_Sqrt:  [[0.15]]
grads:  [0.08621323]
Stock Position:  0.08621323016275276
Bond Position:  [8.19410427]


portfolio before change:  [17.52854406]
curr_Stock_Price:  108.25966552379693
curr_Factors:  [108.25966552]
mat_Sqrt:  [[0.15]]
grads:  [0.05400476]
Stock Position:  0.05400475504817944
Bond Position:  [11.68200734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.53547095]
Stock Price:  108.36088905988113
PL:  [9.17458189]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.80587983e-02]
 [ 3.16474256e-02]
 [-1.27156797e-03]
 [-6.76501158e-03]
 [-7.45544017e-03]
 [ 4.43419896e-02]
 [ 3.52757239e-03]
 [ 5.58492748e-03]
 [ 7.59904034e-02]
 [ 2.34013683e-02]
 [ 2.18408962e-02]
 [-4.60277525e-03]
 [-2.49371102e-02]
 [ 1.77474620e-02]
 [-9.02343181e-03]
 [-6.57839818e-04]
 [-6.09607630e-03]
 [ 1.42584996e-04]
 [ 1.24817383e-03]
 [-1.40064586e-02]
 [-7.17237499e-03]
 [-1.25866093e-02]
 [ 6.52969258e-03]
 [-6.34083976e-03]
 [ 1.45052236e-02]
 [ 7.88883938e-03]
 [-5.44747534e-04]
 [-3.73551228e-03]
 [-3.01627484e-02]
 [-1.15252233e-02]
 [ 4.02917838e-02]
 [ 3.80551562e-03]
 [-1.66103866e-02]
 [-3.17800976e-02]
 [-2.36855934e-02]
 [ 3.38301731e-02]
 [-4.98576530e-03]
 [ 2.34137415e-03]
 [ 2.28905774e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.32759463]
curr_Stock_Price:  99.89915513935924
curr_Factors:  [99.89915514]
mat_Sqrt:  [[0.15]]
grads:  [0.12039199]
Stock Position:  0.12039198843387035
Bond Position:  [-12.35465256]


portfolio before change:  [-0.38623318]
curr_Stock_Price:  99.42491995456227
curr_Factors:  [99.42491995]
mat_Sqrt:  [[0.15]]
grads:  [0.21098284]
Stock Position:  0.2109828371417677
Bond Position:  [-21.36318487]


portfolio before change:  [-0.27753628]
curr_Stock_Price:  99.95277076894104
curr_Factors:  [99.95277077]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847712]
Stock Position:  -0.008477119827025778
Bond Position:  [0.56977534]


portfolio before change:  [-0.27140249]
curr_Stock_Price:  99.23760367667934
curr_Factors:  [99.23760368]
mat_Sqrt:  [[0.15]]
grads:  [-0.04510008]
Stock Position:  -0.04510007721727024
Bond Position:  [4.20422109]


portfolio before change:  [-0.28974829]
curr_Stock_Price:  99.65603664807422
curr_Factors:  [99.65603665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04970293]
Stock Position:  -0.0497029344399329
Bond Position:  [4.66344916]


portfolio before change:  [-0.20004239]
curr_Stock_Price:  97.86292455697394
curr_Factors:  [97.86292456]
mat_Sqrt:  [[0.15]]
grads:  [0.29561326]
Stock Position:  0.2956132642882856
Bond Position:  [-29.12962097]


portfolio before change:  [-0.56430521]
curr_Stock_Price:  96.64301518992536
curr_Factors:  [96.64301519]
mat_Sqrt:  [[0.15]]
grads:  [0.02351715]
Stock Position:  0.023517149298757405
Bond Position:  [-2.83707343]


portfolio before change:  [-0.57615849]
curr_Stock_Price:  96.15406901205908
curr_Factors:  [96.15406901]
mat_Sqrt:  [[0.15]]
grads:  [0.03723285]
Stock Position:  0.03723284989409071
Bond Position:  [-4.15624851]


portfolio before change:  [-0.60186233]
curr_Stock_Price:  95.47766954485435
curr_Factors:  [95.47766954]
mat_Sqrt:  [[0.15]]
grads:  [0.50660269]
Stock Position:  0.5066026893049669
Bond Position:  [-48.97110649]


portfolio before change:  [-0.19173403]
curr_Stock_Price:  96.2993194865802
curr_Factors:  [96.29931949]
mat_Sqrt:  [[0.15]]
grads:  [0.15600912]
Stock Position:  0.1560091217116177
Bond Position:  [-15.21530629]


portfolio before change:  [-0.23012808]
curr_Stock_Price:  96.06541002111672
curr_Factors:  [96.06541002]
mat_Sqrt:  [[0.15]]
grads:  [0.14560597]
Stock Position:  0.1456059748734102
Bond Position:  [-14.21782575]


portfolio before change:  [-0.23882655]
curr_Stock_Price:  96.01787674393603
curr_Factors:  [96.01787674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03068517]
Stock Position:  -0.030685168324605782
Bond Position:  [2.70749816]


portfolio before change:  [-0.2281203]
curr_Stock_Price:  95.68000061616854
curr_Factors:  [95.68000062]
mat_Sqrt:  [[0.15]]
grads:  [-0.1662474]
Stock Position:  -0.166247401292897
Bond Position:  [15.67843116]


portfolio before change:  [-0.22600577]
curr_Stock_Price:  95.67907064347975
curr_Factors:  [95.67907064]
mat_Sqrt:  [[0.15]]
grads:  [0.11831641]
Stock Position:  0.11831641332884099
Bond Position:  [-11.54641024]


portfolio before change:  [-0.22248735]
curr_Stock_Price:  95.72100743741655
curr_Factors:  [95.72100744]
mat_Sqrt:  [[0.15]]
grads:  [-0.06015621]
Stock Position:  -0.06015621209892378
Bond Position:  [5.53572588]


portfolio before change:  [-0.22579283]
curr_Stock_Price:  95.78745929589108
curr_Factors:  [95.7874593]
mat_Sqrt:  [[0.15]]
grads:  [-0.0043856]
Stock Position:  -0.004385598788068322
Bond Position:  [0.19429253]


portfolio before change:  [-0.22781207]
curr_Stock_Price:  96.25342198207277
curr_Factors:  [96.25342198]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064051]
Stock Position:  -0.04064050864077668
Bond Position:  [3.68397596]


portfolio before change:  [-0.2585897]
curr_Stock_Price:  97.02206766555797
curr_Factors:  [97.02206767]
mat_Sqrt:  [[0.15]]
grads:  [0.00095057]
Stock Position:  0.0009505666379159769
Bond Position:  [-0.35081564]


portfolio before change:  [-0.25946601]
curr_Stock_Price:  96.14631345532933
curr_Factors:  [96.14631346]
mat_Sqrt:  [[0.15]]
grads:  [0.00832116]
Stock Position:  0.008321158892477972
Bond Position:  [-1.05951476]


portfolio before change:  [-0.25533052]
curr_Stock_Price:  96.659215819062
curr_Factors:  [96.65921582]
mat_Sqrt:  [[0.15]]
grads:  [-0.09337639]
Stock Position:  -0.09337639039556965
Bond Position:  [8.77035815]


portfolio before change:  [-0.30506148]
curr_Stock_Price:  97.2035431429637
curr_Factors:  [97.20354314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04781583]
Stock Position:  -0.04781583324244584
Bond Position:  [4.34280693]


portfolio before change:  [-0.35937008]
curr_Stock_Price:  98.35068393423893
curr_Factors:  [98.35068393]
mat_Sqrt:  [[0.15]]
grads:  [-0.08391073]
Stock Position:  -0.083910728398119
Bond Position:  [7.89330744]


portfolio before change:  [-0.36406855]
curr_Stock_Price:  98.41843680527121
curr_Factors:  [98.41843681]
mat_Sqrt:  [[0.15]]
grads:  [0.04353128]
Stock Position:  0.04353128384721053
Bond Position:  [-4.64834946]


portfolio before change:  [-0.33144638]
curr_Stock_Price:  99.1811813097644
curr_Factors:  [99.18118131]
mat_Sqrt:  [[0.15]]
grads:  [-0.04227227]
Stock Position:  -0.04227226507500741
Bond Position:  [3.8611668]


portfolio before change:  [-0.29845132]
curr_Stock_Price:  98.4120626074368
curr_Factors:  [98.41206261]
mat_Sqrt:  [[0.15]]
grads:  [0.09670149]
Stock Position:  0.09670149037551246
Bond Position:  [-9.81504444]


portfolio before change:  [-0.21627518]
curr_Stock_Price:  99.27454256433492
curr_Factors:  [99.27454256]
mat_Sqrt:  [[0.15]]
grads:  [0.05259226]
Stock Position:  0.05259226254421468
Bond Position:  [-5.43734798]


portfolio before change:  [-0.2615627]
curr_Stock_Price:  98.42636062724992
curr_Factors:  [98.42636063]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363165]
Stock Position:  -0.0036316502256418352
Bond Position:  [0.09588742]


portfolio before change:  [-0.25747651]
curr_Stock_Price:  97.30450201842703
curr_Factors:  [97.30450202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490342]
Stock Position:  -0.024903415168721143
Bond Position:  [2.1657379]


portfolio before change:  [-0.21543699]
curr_Stock_Price:  95.62727058379087
curr_Factors:  [95.62727058]
mat_Sqrt:  [[0.15]]
grads:  [-0.20108499]
Stock Position:  -0.20108498932532087
Bond Position:  [19.0137717]


portfolio before change:  [-0.355527]
curr_Stock_Price:  96.33576146972247
curr_Factors:  [96.33576147]
mat_Sqrt:  [[0.15]]
grads:  [-0.07683482]
Stock Position:  -0.07683482213754628
Bond Position:  [7.0464141]


portfolio before change:  [-0.35106975]
curr_Stock_Price:  96.28921502286828
curr_Factors:  [96.28921502]
mat_Sqrt:  [[0.15]]
grads:  [0.26861189]
Stock Position:  0.2686118918716175
Bond Position:  [-26.21549797]


portfolio before change:  [-0.38292268]
curr_Stock_Price:  96.18283185086082
curr_Factors:  [96.18283185]
mat_Sqrt:  [[0.15]]
grads:  [0.0253701]
Stock Position:  0.025370104110384453
Bond Position:  [-2.82309114]


portfolio before change:  [-0.3845187]
curr_Stock_Price:  96.13383298347058
curr_Factors:  [96.13383298]
mat_Sqrt:  [[0.15]]
grads:  [-0.11073591]
Stock Position:  -0.11073591057063469
Bond Position:  [10.26094884]


portfolio before change:  [-0.28664575]
curr_Stock_Price:  95.26157533289098
curr_Factors:  [95.26157533]
mat_Sqrt:  [[0.15]]
grads:  [-0.21186732]
Stock Position:  -0.21186731752467525
Bond Position:  [19.89616868]


portfolio before change:  [-0.09517431]
curr_Stock_Price:  94.36958184286283
curr_Factors:  [94.36958184]
mat_Sqrt:  [[0.15]]
grads:  [-0.15790396]
Stock Position:  -0.157903956135787
Bond Position:  [14.806156]


portfolio before change:  [-0.06083443]
curr_Stock_Price:  94.16383020892506
curr_Factors:  [94.16383021]
mat_Sqrt:  [[0.15]]
grads:  [0.22553449]
Stock Position:  0.2255344870651287
Bond Position:  [-21.29802557]


portfolio before change:  [0.1666142]
curr_Stock_Price:  95.18412224564763
curr_Factors:  [95.18412225]
mat_Sqrt:  [[0.15]]
grads:  [-0.03323844]
Stock Position:  -0.033238435362268594
Bond Position:  [3.33038549]


portfolio before change:  [0.12343416]
curr_Stock_Price:  96.49574712176249
curr_Factors:  [96.49574712]
mat_Sqrt:  [[0.15]]
grads:  [0.01560916]
Stock Position:  0.01560916096821937
Bond Position:  [-1.38278349]


portfolio before change:  [0.10113747]
curr_Stock_Price:  95.07838492696034
curr_Factors:  [95.07838493]
mat_Sqrt:  [[0.15]]
grads:  [0.15260385]
Stock Position:  0.1526038491040394
Bond Position:  [-14.40819004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.09843385]
Stock Price:  95.07247100948423
PL:  [0.09843385]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.03558396e-02]
 [ 2.20186580e-02]
 [-1.68006980e-02]
 [-8.44885109e-03]
 [-3.50718847e-03]
 [ 5.10763187e-02]
 [ 3.57240734e-03]
 [-2.01500462e-03]
 [-1.23865313e-02]
 [ 2.34420655e-02]
 [ 2.09022827e-02]
 [-1.50771299e-02]
 [ 3.17456464e-02]
 [ 1.83853508e-02]
 [ 1.77991134e-03]
 [-1.02851688e-03]
 [-6.14800025e-03]
 [ 5.15348707e-03]
 [ 5.72639084e-03]
 [-2.93230736e-02]
 [-3.92216480e-03]
 [-1.51092134e-02]
 [ 6.52448010e-03]
 [-6.36467444e-03]
 [ 1.54685637e-02]
 [ 8.12435035e-03]
 [-3.14703655e-03]
 [-1.90524736e-03]
 [-6.11334525e-04]
 [-1.39672679e-02]
 [ 3.86656584e-03]
 [ 1.25023836e-02]
 [-1.18076108e-02]
 [-4.93902032e-02]
 [-2.18675571e-02]
 [ 2.75100756e-02]
 [ 3.15413495e-03]
 [ 9.05944801e-03]
 [ 5.46617363e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.78410616]
curr_Stock_Price:  99.42290232746458
curr_Factors:  [99.42290233]
mat_Sqrt:  [[0.15]]
grads:  [-0.06903893]
Stock Position:  -0.06903893083059404
Bond Position:  [-3.92005528]


portfolio before change:  [-10.75630111]
curr_Stock_Price:  99.0130598505818
curr_Factors:  [99.01305985]
mat_Sqrt:  [[0.15]]
grads:  [0.14679105]
Stock Position:  0.1467910530937898
Bond Position:  [-25.29053243]


portfolio before change:  [-10.76937673]
curr_Stock_Price:  98.94552093126536
curr_Factors:  [98.94552093]
mat_Sqrt:  [[0.15]]
grads:  [-0.11200465]
Stock Position:  -0.11200465362490168
Bond Position:  [0.31298207]


portfolio before change:  [-10.61591516]
curr_Stock_Price:  97.57573457118066
curr_Factors:  [97.57573457]
mat_Sqrt:  [[0.15]]
grads:  [-0.05632567]
Stock Position:  -0.056325673901673666
Bond Position:  [-5.11989615]


portfolio before change:  [-10.56215055]
curr_Stock_Price:  96.60984046965115
curr_Factors:  [96.60984047]
mat_Sqrt:  [[0.15]]
grads:  [-0.02338126]
Stock Position:  -0.023381256497606556
Bond Position:  [-8.30329109]


portfolio before change:  [-10.57587588]
curr_Stock_Price:  97.15246984379044
curr_Factors:  [97.15246984]
mat_Sqrt:  [[0.15]]
grads:  [0.34050879]
Stock Position:  0.34050879107095156
Bond Position:  [-43.65714594]


portfolio before change:  [-10.21239321]
curr_Stock_Price:  98.23596656343055
curr_Factors:  [98.23596656]
mat_Sqrt:  [[0.15]]
grads:  [0.02381605]
Stock Position:  0.02381604890733492
Bond Position:  [-12.55198579]


portfolio before change:  [-10.21506838]
curr_Stock_Price:  98.18952422239923
curr_Factors:  [98.18952422]
mat_Sqrt:  [[0.15]]
grads:  [-0.01343336]
Stock Position:  -0.013433364163784187
Bond Position:  [-8.89605274]


portfolio before change:  [-10.21419947]
curr_Stock_Price:  98.04205707385356
curr_Factors:  [98.04205707]
mat_Sqrt:  [[0.15]]
grads:  [-0.08257688]
Stock Position:  -0.08257687537894513
Bond Position:  [-2.11819274]


portfolio before change:  [-10.225989]
curr_Stock_Price:  98.18162076038216
curr_Factors:  [98.18162076]
mat_Sqrt:  [[0.15]]
grads:  [0.15628044]
Stock Position:  0.15628043693682092
Bond Position:  [-25.56985559]


portfolio before change:  [-10.19926313]
curr_Stock_Price:  98.3730861617902
curr_Factors:  [98.37308616]
mat_Sqrt:  [[0.15]]
grads:  [0.13934855]
Stock Position:  0.13934855131202353
Bond Position:  [-23.90741018]


portfolio before change:  [-10.05867062]
curr_Stock_Price:  99.40346019715764
curr_Factors:  [99.4034602]
mat_Sqrt:  [[0.15]]
grads:  [-0.1005142]
Stock Position:  -0.10051419961775902
Bond Position:  [-0.06721138]


portfolio before change:  [-10.18270183]
curr_Stock_Price:  100.63734368397223
curr_Factors:  [100.63734368]
mat_Sqrt:  [[0.15]]
grads:  [0.21163764]
Stock Position:  0.2116376424993798
Bond Position:  [-31.48135199]


portfolio before change:  [-10.01368838]
curr_Stock_Price:  101.45453699519915
curr_Factors:  [101.454537]
mat_Sqrt:  [[0.15]]
grads:  [0.12256901]
Stock Position:  0.1225690051842728
Bond Position:  [-22.44887005]


portfolio before change:  [-10.07664195]
curr_Stock_Price:  100.96381515065049
curr_Factors:  [100.96381515]
mat_Sqrt:  [[0.15]]
grads:  [0.01186608]
Stock Position:  0.011866075618654309
Bond Position:  [-11.27468622]


portfolio before change:  [-10.10012357]
curr_Stock_Price:  99.10370595555845
curr_Factors:  [99.10370596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685678]
Stock Position:  -0.006856779208631812
Bond Position:  [-9.42059134]


portfolio before change:  [-10.10727357]
curr_Stock_Price:  99.97472046498932
curr_Factors:  [99.97472046]
mat_Sqrt:  [[0.15]]
grads:  [-0.04098667]
Stock Position:  -0.04098666832461826
Bond Position:  [-6.00964286]


portfolio before change:  [-10.10573169]
curr_Stock_Price:  99.91877205616622
curr_Factors:  [99.91877206]
mat_Sqrt:  [[0.15]]
grads:  [0.03435658]
Stock Position:  0.034356580448565606
Bond Position:  [-13.53859902]


portfolio before change:  [-10.12772964]
curr_Stock_Price:  99.32774920240415
curr_Factors:  [99.3277492]
mat_Sqrt:  [[0.15]]
grads:  [0.03817594]
Stock Position:  0.03817593895153281
Bond Position:  [-13.91965973]


portfolio before change:  [-10.16502276]
curr_Stock_Price:  98.39645450308456
curr_Factors:  [98.3964545]
mat_Sqrt:  [[0.15]]
grads:  [-0.19548716]
Stock Position:  -0.19548715703221475
Bond Position:  [9.0702204]


portfolio before change:  [-10.09887236]
curr_Stock_Price:  98.0638671925982
curr_Factors:  [98.06386719]
mat_Sqrt:  [[0.15]]
grads:  [-0.02614777]
Stock Position:  -0.026147765339381037
Bond Position:  [-7.53472137]


portfolio before change:  [-10.09363496]
curr_Stock_Price:  97.82754494951878
curr_Factors:  [97.82754495]
mat_Sqrt:  [[0.15]]
grads:  [-0.10072809]
Stock Position:  -0.10072808958359178
Bond Position:  [-0.23965325]


portfolio before change:  [-10.08197876]
curr_Stock_Price:  97.71152801537474
curr_Factors:  [97.71152802]
mat_Sqrt:  [[0.15]]
grads:  [0.04349653]
Stock Position:  0.043496533991454214
Bond Position:  [-14.33209155]


portfolio before change:  [-10.02452029]
curr_Stock_Price:  99.0737076092916
curr_Factors:  [99.07370761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04243116]
Stock Position:  -0.042431162945676976
Bond Position:  [-5.82070766]


portfolio before change:  [-10.03001037]
curr_Stock_Price:  99.18594693521156
curr_Factors:  [99.18594694]
mat_Sqrt:  [[0.15]]
grads:  [0.10312376]
Stock Position:  0.10312375788245932
Bond Position:  [-20.25843794]


portfolio before change:  [-9.99233164]
curr_Stock_Price:  99.57587832239167
curr_Factors:  [99.57587832]
mat_Sqrt:  [[0.15]]
grads:  [0.05416234]
Stock Position:  0.05416233568937856
Bond Position:  [-15.38559379]


portfolio before change:  [-9.92372079]
curr_Stock_Price:  100.87815164443371
curr_Factors:  [100.87815164]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098024]
Stock Position:  -0.020980243660329856
Bond Position:  [-7.80727259]


portfolio before change:  [-9.90649839]
curr_Stock_Price:  100.01074625028714
curr_Factors:  [100.01074625]
mat_Sqrt:  [[0.15]]
grads:  [-0.01270165]
Stock Position:  -0.012701649040397448
Bond Position:  [-8.63619699]


portfolio before change:  [-9.8985184]
curr_Stock_Price:  99.29748573324235
curr_Factors:  [99.29748573]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407556]
Stock Position:  -0.004075563497686881
Bond Position:  [-9.49382519]


portfolio before change:  [-9.89849093]
curr_Stock_Price:  98.99954701319231
curr_Factors:  [98.99954701]
mat_Sqrt:  [[0.15]]
grads:  [-0.09311512]
Stock Position:  -0.09311511936436741
Bond Position:  [-0.68013629]


portfolio before change:  [-9.87388029]
curr_Stock_Price:  98.7343305381
curr_Factors:  [98.73433054]
mat_Sqrt:  [[0.15]]
grads:  [0.02577711]
Stock Position:  0.025777105602929024
Bond Position:  [-12.41896555]


portfolio before change:  [-9.87868634]
curr_Stock_Price:  98.60811080291884
curr_Factors:  [98.6081108]
mat_Sqrt:  [[0.15]]
grads:  [0.08334922]
Stock Position:  0.08334922432605382
Bond Position:  [-18.09759588]


portfolio before change:  [-9.94274986]
curr_Stock_Price:  97.86663797516768
curr_Factors:  [97.86663798]
mat_Sqrt:  [[0.15]]
grads:  [-0.07871741]
Stock Position:  -0.07871740514708317
Bond Position:  [-2.23894207]


portfolio before change:  [-9.91637182]
curr_Stock_Price:  97.52798442818022
curr_Factors:  [97.52798443]
mat_Sqrt:  [[0.15]]
grads:  [-0.32926802]
Stock Position:  -0.32926802130293814
Bond Position:  [22.19647464]


portfolio before change:  [-10.4430277]
curr_Stock_Price:  99.13588612402381
curr_Factors:  [99.13588612]
mat_Sqrt:  [[0.15]]
grads:  [-0.14578371]
Stock Position:  -0.145783714157929
Bond Position:  [4.00936999]


portfolio before change:  [-10.59811973]
curr_Stock_Price:  100.20317431012958
curr_Factors:  [100.20317431]
mat_Sqrt:  [[0.15]]
grads:  [0.1834005]
Stock Position:  0.18340050418590007
Bond Position:  [-28.97543242]


portfolio before change:  [-10.76390989]
curr_Stock_Price:  99.31894553073943
curr_Factors:  [99.31894553]
mat_Sqrt:  [[0.15]]
grads:  [0.02102757]
Stock Position:  0.021027566314149385
Bond Position:  [-12.8523456]


portfolio before change:  [-10.74761554]
curr_Stock_Price:  100.17025633574701
curr_Factors:  [100.17025634]
mat_Sqrt:  [[0.15]]
grads:  [0.06039632]
Stock Position:  0.06039632009246079
Bond Position:  [-16.7975304]


portfolio before change:  [-10.78047068]
curr_Stock_Price:  99.66103119465106
curr_Factors:  [99.66103119]
mat_Sqrt:  [[0.15]]
grads:  [0.03644116]
Stock Position:  0.03644115752118619
Bond Position:  [-14.41223402]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.76590155]
Stock Price:  100.11026978629653
PL:  [-10.87617134]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.54499091e-02]
 [ 3.98091359e-02]
 [-3.49151956e-03]
 [-6.77770246e-03]
 [-7.12207451e-03]
 [ 3.91147007e-02]
 [ 3.55952197e-03]
 [-4.11823660e-04]
 [-1.99194203e-02]
 [ 2.34422760e-02]
 [ 1.98318830e-02]
 [-1.26455205e-02]
 [ 1.32110880e-02]
 [ 6.42209413e-03]
 [ 2.44511352e-03]
 [-3.75272035e-03]
 [-6.01722141e-03]
 [ 6.85260600e-03]
 [ 1.61100307e-02]
 [ 1.47374981e-02]
 [-3.41683511e-04]
 [-6.06689117e-03]
 [ 4.07081686e-03]
 [-1.18929651e-02]
 [-6.97850631e-04]
 [ 3.59697621e-03]
 [-3.25575145e-03]
 [ 2.69549400e-04]
 [ 1.77296001e-03]
 [-6.71324804e-03]
 [-2.81027604e-02]
 [ 1.80124432e-02]
 [-3.50645936e-03]
 [-1.87516390e-02]
 [-2.08435717e-02]
 [ 2.71193592e-02]
 [ 3.22333142e-03]
 [ 8.34498261e-03]
 [ 6.45488440e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.10465709]
curr_Stock_Price:  100.51094116712298
curr_Factors:  [100.51094117]
mat_Sqrt:  [[0.15]]
grads:  [-0.10299939]
Stock Position:  -0.10299939397547501
Bond Position:  [23.45722311]


portfolio before change:  [13.16991319]
curr_Stock_Price:  99.90585244303936
curr_Factors:  [99.90585244]
mat_Sqrt:  [[0.15]]
grads:  [0.26539424]
Stock Position:  0.26539423950607394
Bond Position:  [-13.34452454]


portfolio before change:  [13.40534924]
curr_Stock_Price:  100.79925623801473
curr_Factors:  [100.79925624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0232768]
Stock Position:  -0.023276797051271968
Bond Position:  [15.75163308]


portfolio before change:  [13.44067332]
curr_Stock_Price:  99.36628438004654
curr_Factors:  [99.36628438]
mat_Sqrt:  [[0.15]]
grads:  [-0.04518468]
Stock Position:  -0.04518468306741628
Bond Position:  [17.93050738]


portfolio before change:  [13.44741573]
curr_Stock_Price:  99.266671984153
curr_Factors:  [99.26667198]
mat_Sqrt:  [[0.15]]
grads:  [-0.0474805]
Stock Position:  -0.0474804967208964
Bond Position:  [18.16064662]


portfolio before change:  [13.49463953]
curr_Stock_Price:  98.31989208980671
curr_Factors:  [98.31989209]
mat_Sqrt:  [[0.15]]
grads:  [0.26076467]
Stock Position:  0.2607646716457136
Bond Position:  [-12.14371485]


portfolio before change:  [13.23220278]
curr_Stock_Price:  97.31930145494336
curr_Factors:  [97.31930145]
mat_Sqrt:  [[0.15]]
grads:  [0.02373015]
Stock Position:  0.023730146484262617
Bond Position:  [10.9228015]


portfolio before change:  [13.24483486]
curr_Stock_Price:  97.79408349288263
curr_Factors:  [97.79408349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00274549]
Stock Position:  -0.0027454910672963565
Bond Position:  [13.51332765]


portfolio before change:  [13.24460258]
curr_Stock_Price:  98.49397715372173
curr_Factors:  [98.49397715]
mat_Sqrt:  [[0.15]]
grads:  [-0.13279614]
Stock Position:  -0.1327961356114582
Bond Position:  [26.32422213]


portfolio before change:  [13.29825227]
curr_Stock_Price:  98.11475710227825
curr_Factors:  [98.1147571]
mat_Sqrt:  [[0.15]]
grads:  [0.15628184]
Stock Position:  0.15628184019482563
Bond Position:  [-2.03530252]


portfolio before change:  [13.48582448]
curr_Stock_Price:  99.31660264821312
curr_Factors:  [99.31660265]
mat_Sqrt:  [[0.15]]
grads:  [0.13221255]
Stock Position:  0.13221255341475563
Bond Position:  [0.35492285]


portfolio before change:  [13.38404831]
curr_Stock_Price:  98.54647502032631
curr_Factors:  [98.54647502]
mat_Sqrt:  [[0.15]]
grads:  [-0.08430347]
Stock Position:  -0.0843034698354025
Bond Position:  [21.69185809]


portfolio before change:  [13.33391295]
curr_Stock_Price:  99.17334141692247
curr_Factors:  [99.17334142]
mat_Sqrt:  [[0.15]]
grads:  [0.08807392]
Stock Position:  0.0880739196865527
Bond Position:  [4.59932804]


portfolio before change:  [13.34257325]
curr_Stock_Price:  99.26514331211277
curr_Factors:  [99.26514331]
mat_Sqrt:  [[0.15]]
grads:  [0.04281396]
Stock Position:  0.04281396086925097
Bond Position:  [9.09263929]


portfolio before change:  [13.39062187]
curr_Stock_Price:  100.36085993489796
curr_Factors:  [100.36085993]
mat_Sqrt:  [[0.15]]
grads:  [0.01630076]
Stock Position:  0.01630075683241647
Bond Position:  [11.7546639]


portfolio before change:  [13.39662686]
curr_Stock_Price:  100.63910272907347
curr_Factors:  [100.63910273]
mat_Sqrt:  [[0.15]]
grads:  [-0.02501814]
Stock Position:  -0.02501813563712599
Bond Position:  [15.91442959]


portfolio before change:  [13.39360578]
curr_Stock_Price:  100.83937787071198
curr_Factors:  [100.83937787]
mat_Sqrt:  [[0.15]]
grads:  [-0.04011481]
Stock Position:  -0.04011480941763931
Bond Position:  [17.43875821]


portfolio before change:  [13.36496783]
curr_Stock_Price:  101.60762117948423
curr_Factors:  [101.60762118]
mat_Sqrt:  [[0.15]]
grads:  [0.04568404]
Stock Position:  0.04568403998591624
Bond Position:  [8.7231212]


portfolio before change:  [13.41947013]
curr_Stock_Price:  102.77677874219913
curr_Factors:  [102.77677874]
mat_Sqrt:  [[0.15]]
grads:  [0.1074002]
Stock Position:  0.10740020499885257
Bond Position:  [2.38122302]


portfolio before change:  [13.44568837]
curr_Stock_Price:  103.0181243570267
curr_Factors:  [103.01812436]
mat_Sqrt:  [[0.15]]
grads:  [0.09824999]
Stock Position:  0.09824998748396474
Bond Position:  [3.32415894]


portfolio before change:  [13.44319004]
curr_Stock_Price:  102.98846666774249
curr_Factors:  [102.98846667]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227789]
Stock Position:  -0.002277890073967158
Bond Position:  [13.67778645]


portfolio before change:  [13.44783474]
curr_Stock_Price:  101.70005222090492
curr_Factors:  [101.70005222]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044594]
Stock Position:  -0.04044594116557104
Bond Position:  [17.56118907]


portfolio before change:  [13.42744536]
curr_Stock_Price:  102.25844374324706
curr_Factors:  [102.25844374]
mat_Sqrt:  [[0.15]]
grads:  [0.02713878]
Stock Position:  0.027138779060432768
Bond Position:  [10.65227604]


portfolio before change:  [13.44600083]
curr_Stock_Price:  102.89310202250601
curr_Factors:  [102.89310202]
mat_Sqrt:  [[0.15]]
grads:  [-0.07928643]
Stock Position:  -0.07928643403159755
Bond Position:  [21.60402797]


portfolio before change:  [13.42003789]
curr_Stock_Price:  103.25462169141306
curr_Factors:  [103.25462169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00465234]
Stock Position:  -0.004652337538504319
Bond Position:  [13.90041324]


portfolio before change:  [13.42883888]
curr_Stock_Price:  101.73639039121882
curr_Factors:  [101.73639039]
mat_Sqrt:  [[0.15]]
grads:  [0.02397984]
Stock Position:  0.023979841408255723
Bond Position:  [10.98921637]


portfolio before change:  [13.40798244]
curr_Stock_Price:  100.809354638066
curr_Factors:  [100.80935464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170501]
Stock Position:  -0.021705009638659407
Bond Position:  [15.59605046]


portfolio before change:  [13.38156571]
curr_Stock_Price:  102.11625839270252
curr_Factors:  [102.11625839]
mat_Sqrt:  [[0.15]]
grads:  [0.001797]
Stock Position:  0.0017969960017127397
Bond Position:  [13.19806321]


portfolio before change:  [13.38226493]
curr_Stock_Price:  101.58723769470454
curr_Factors:  [101.58723769]
mat_Sqrt:  [[0.15]]
grads:  [0.01181973]
Stock Position:  0.011819733397469641
Bond Position:  [12.18153086]


portfolio before change:  [13.37707858]
curr_Stock_Price:  101.01961637855689
curr_Factors:  [101.01961638]
mat_Sqrt:  [[0.15]]
grads:  [-0.04475499]
Stock Position:  -0.04475498694423544
Bond Position:  [17.89821019]


portfolio before change:  [13.3791079]
curr_Stock_Price:  101.0242661229789
curr_Factors:  [101.02426612]
mat_Sqrt:  [[0.15]]
grads:  [-0.18735174]
Stock Position:  -0.18735173578120506
Bond Position:  [32.30617951]


portfolio before change:  [13.33774655]
curr_Stock_Price:  101.26659040367777
curr_Factors:  [101.2665904]
mat_Sqrt:  [[0.15]]
grads:  [0.12008295]
Stock Position:  0.12008295493131411
Bond Position:  [1.17735514]


portfolio before change:  [13.32639244]
curr_Stock_Price:  101.17081256664162
curr_Factors:  [101.17081257]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233764]
Stock Position:  -0.023376395750092822
Bond Position:  [15.69140139]


portfolio before change:  [13.31943832]
curr_Stock_Price:  101.55220887217395
curr_Factors:  [101.55220887]
mat_Sqrt:  [[0.15]]
grads:  [-0.12501093]
Stock Position:  -0.1250109263710473
Bond Position:  [26.01457402]


portfolio before change:  [13.37069249]
curr_Stock_Price:  101.16822527476303
curr_Factors:  [101.16822527]
mat_Sqrt:  [[0.15]]
grads:  [-0.13895714]
Stock Position:  -0.13895714457489347
Bond Position:  [27.42874019]


portfolio before change:  [13.40360685]
curr_Stock_Price:  100.95603354045171
curr_Factors:  [100.95603354]
mat_Sqrt:  [[0.15]]
grads:  [0.18079573]
Stock Position:  0.18079572809355504
Bond Position:  [-4.84881274]


portfolio before change:  [13.18377073]
curr_Stock_Price:  99.74344970203916
curr_Factors:  [99.7434497]
mat_Sqrt:  [[0.15]]
grads:  [0.02148888]
Stock Position:  0.02148887610253696
Bond Position:  [11.0403961]


portfolio before change:  [13.17868883]
curr_Stock_Price:  99.44273408795252
curr_Factors:  [99.44273409]
mat_Sqrt:  [[0.15]]
grads:  [0.05563322]
Stock Position:  0.05563321739422755
Bond Position:  [7.64636959]


portfolio before change:  [13.22050839]
curr_Stock_Price:  100.17725395666773
curr_Factors:  [100.17725396]
mat_Sqrt:  [[0.15]]
grads:  [0.04303256]
Stock Position:  0.043032562644509026
Bond Position:  [8.90962443]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.18565108]
Stock Price:  99.34135027783321
PL:  [13.18565108]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.68860046e-02]
 [ 3.99476882e-02]
 [-1.03654183e-02]
 [-9.48016316e-03]
 [-3.78622864e-03]
 [ 6.55684015e-02]
 [ 3.13783170e-03]
 [ 8.65075722e-03]
 [ 6.98931252e-02]
 [ 2.34276587e-02]
 [ 2.18916522e-02]
 [-7.25693223e-03]
 [-1.88449500e-02]
 [ 1.74925910e-02]
 [ 1.23196932e-03]
 [-2.84477392e-03]
 [-5.97032032e-03]
 [-1.61420736e-02]
 [ 1.36215402e-03]
 [ 5.00105176e-02]
 [-2.90703373e-02]
 [-2.84190196e-02]
 [ 3.22268631e-03]
 [-1.43260875e-02]
 [ 8.03852143e-03]
 [-5.20539105e-03]
 [ 3.84572163e-02]
 [-5.29445844e-03]
 [-5.07049429e-02]
 [-7.99729840e-03]
 [ 5.76779990e-02]
 [-5.27476919e-03]
 [-2.28397672e-02]
 [-1.03202027e-02]
 [-2.41194228e-02]
 [ 3.01919012e-02]
 [-1.29386992e-02]
 [-1.14531306e-02]
 [ 4.99877366e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.72688154]
curr_Stock_Price:  99.88096919740713
curr_Factors:  [99.8809692]
mat_Sqrt:  [[0.15]]
grads:  [0.11257336]
Stock Position:  0.11257336381405796
Bond Position:  [-11.97081822]


portfolio before change:  [-0.72478818]
curr_Stock_Price:  99.91285779250683
curr_Factors:  [99.91285779]
mat_Sqrt:  [[0.15]]
grads:  [0.26631792]
Stock Position:  0.2663179210080888
Bond Position:  [-27.33337274]


portfolio before change:  [-0.89088631]
curr_Stock_Price:  99.30200422946915
curr_Factors:  [99.30200423]
mat_Sqrt:  [[0.15]]
grads:  [-0.06910279]
Stock Position:  -0.06910278841362973
Bond Position:  [5.97115908]


portfolio before change:  [-0.71535917]
curr_Stock_Price:  96.77271840439873
curr_Factors:  [96.7727184]
mat_Sqrt:  [[0.15]]
grads:  [-0.06320109]
Stock Position:  -0.06320108771932863
Bond Position:  [5.4007819]


portfolio before change:  [-0.71509951]
curr_Stock_Price:  96.779292448104
curr_Factors:  [96.77929245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02524152]
Stock Position:  -0.025241524270558414
Bond Position:  [1.72775735]


portfolio before change:  [-0.68149268]
curr_Stock_Price:  95.45643828949008
curr_Factors:  [95.45643829]
mat_Sqrt:  [[0.15]]
grads:  [0.43712268]
Stock Position:  0.4371226766448147
Bond Position:  [-42.40766648]


portfolio before change:  [-0.8846462]
curr_Stock_Price:  95.00381425131168
curr_Factors:  [95.00381425]
mat_Sqrt:  [[0.15]]
grads:  [0.02091888]
Stock Position:  0.020918878009075874
Bond Position:  [-2.8720194]


portfolio before change:  [-0.879379]
curr_Stock_Price:  95.27276853229709
curr_Factors:  [95.27276853]
mat_Sqrt:  [[0.15]]
grads:  [0.05767171]
Stock Position:  0.057671714777515995
Bond Position:  [-6.37392293]


portfolio before change:  [-0.85815543]
curr_Stock_Price:  95.65459109235684
curr_Factors:  [95.65459109]
mat_Sqrt:  [[0.15]]
grads:  [0.46595417]
Stock Position:  0.465954168298706
Bond Position:  [-45.42881086]


portfolio before change:  [-0.4510131]
curr_Stock_Price:  96.54056080647953
curr_Factors:  [96.54056081]
mat_Sqrt:  [[0.15]]
grads:  [0.15618439]
Stock Position:  0.1561843910073823
Bond Position:  [-15.5291418]


portfolio before change:  [-0.5479153]
curr_Stock_Price:  95.93255555878856
curr_Factors:  [95.93255556]
mat_Sqrt:  [[0.15]]
grads:  [0.14594435]
Stock Position:  0.14594434798574465
Bond Position:  [-14.54872957]


portfolio before change:  [-0.38209625]
curr_Stock_Price:  97.08119718995628
curr_Factors:  [97.08119719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04837955]
Stock Position:  -0.04837954816743136
Bond Position:  [4.31464821]


portfolio before change:  [-0.35806601]
curr_Stock_Price:  96.59564344978297
curr_Factors:  [96.59564345]
mat_Sqrt:  [[0.15]]
grads:  [-0.125633]
Stock Position:  -0.12563300004075278
Bond Position:  [11.77753447]


portfolio before change:  [-0.21514412]
curr_Stock_Price:  95.46974810391804
curr_Factors:  [95.4697481]
mat_Sqrt:  [[0.15]]
grads:  [0.11661727]
Stock Position:  0.11661727335432047
Bond Position:  [-11.34856583]


portfolio before change:  [-0.30596176]
curr_Stock_Price:  94.70314653697558
curr_Factors:  [94.70314654]
mat_Sqrt:  [[0.15]]
grads:  [0.00821313]
Stock Position:  0.008213128824499986
Bond Position:  [-1.0837709]


portfolio before change:  [-0.31331407]
curr_Stock_Price:  93.82445284681715
curr_Factors:  [93.82445285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896516]
Stock Position:  -0.018965159490336947
Bond Position:  [1.46608165]


portfolio before change:  [-0.28925549]
curr_Stock_Price:  92.56554925524944
curr_Factors:  [92.56554926]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980214]
Stock Position:  -0.03980213544625682
Bond Position:  [3.39505104]


portfolio before change:  [-0.29425586]
curr_Stock_Price:  92.70184295763961
curr_Factors:  [92.70184296]
mat_Sqrt:  [[0.15]]
grads:  [-0.10761382]
Stock Position:  -0.10761382380021024
Bond Position:  [9.68174393]


portfolio before change:  [-0.16021987]
curr_Stock_Price:  91.4675619384606
curr_Factors:  [91.46756194]
mat_Sqrt:  [[0.15]]
grads:  [0.00908103]
Stock Position:  0.009081026799860782
Bond Position:  [-0.99083925]


portfolio before change:  [-0.15871164]
curr_Stock_Price:  91.6472874914471
curr_Factors:  [91.64728749]
mat_Sqrt:  [[0.15]]
grads:  [0.33340345]
Stock Position:  0.33340345065262195
Bond Position:  [-30.71423353]


portfolio before change:  [0.00979174]
curr_Stock_Price:  92.16420745432693
curr_Factors:  [92.16420745]
mat_Sqrt:  [[0.15]]
grads:  [-0.19380225]
Stock Position:  -0.193802248846166
Bond Position:  [17.87142241]


portfolio before change:  [-0.03904968]
curr_Stock_Price:  92.42775184244634
curr_Factors:  [92.42775184]
mat_Sqrt:  [[0.15]]
grads:  [-0.18946013]
Stock Position:  -0.18946013071391515
Bond Position:  [17.47232426]


portfolio before change:  [0.09242708]
curr_Stock_Price:  91.74532548419542
curr_Factors:  [91.74532548]
mat_Sqrt:  [[0.15]]
grads:  [0.02148458]
Stock Position:  0.02148457540589752
Bond Position:  [-1.87868228]


portfolio before change:  [0.10815519]
curr_Stock_Price:  92.48832158382884
curr_Factors:  [92.48832158]
mat_Sqrt:  [[0.15]]
grads:  [-0.09550725]
Stock Position:  -0.0955072499645589
Bond Position:  [8.94146044]


portfolio before change:  [0.2236867]
curr_Stock_Price:  91.29036270280567
curr_Factors:  [91.2903627]
mat_Sqrt:  [[0.15]]
grads:  [0.05359014]
Stock Position:  0.053590142865378686
Bond Position:  [-4.66857688]


portfolio before change:  [0.2447618]
curr_Stock_Price:  91.69451741543669
curr_Factors:  [91.69451742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03470261]
Stock Position:  -0.03470260700137087
Bond Position:  [3.4268006]


portfolio before change:  [0.20514977]
curr_Stock_Price:  92.84833278911067
curr_Factors:  [92.84833279]
mat_Sqrt:  [[0.15]]
grads:  [0.25638144]
Stock Position:  0.25638144182090195
Bond Position:  [-23.59943966]


portfolio before change:  [0.41891053]
curr_Stock_Price:  93.69360017132557
curr_Factors:  [93.69360017]
mat_Sqrt:  [[0.15]]
grads:  [-0.03529639]
Stock Position:  -0.03529638957722677
Bond Position:  [3.72595634]


portfolio before change:  [0.42683908]
curr_Stock_Price:  93.48216834497762
curr_Factors:  [93.48216834]
mat_Sqrt:  [[0.15]]
grads:  [-0.33803295]
Stock Position:  -0.3380329526833958
Bond Position:  [32.02689247]


portfolio before change:  [0.4391608]
curr_Stock_Price:  93.45756096853032
curr_Factors:  [93.45756097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05331532]
Stock Position:  -0.053315322692686816
Bond Position:  [5.42188082]


portfolio before change:  [0.48652152]
curr_Stock_Price:  92.58196003981037
curr_Factors:  [92.58196004]
mat_Sqrt:  [[0.15]]
grads:  [0.38451999]
Stock Position:  0.38451999335999876
Bond Position:  [-35.11309314]


portfolio before change:  [0.63011207]
curr_Stock_Price:  92.96680339200422
curr_Factors:  [92.96680339]
mat_Sqrt:  [[0.15]]
grads:  [-0.03516513]
Stock Position:  -0.03516512796139466
Bond Position:  [3.89930161]


portfolio before change:  [0.6527623]
curr_Stock_Price:  92.33655453294554
curr_Factors:  [92.33655453]
mat_Sqrt:  [[0.15]]
grads:  [-0.15226511]
Stock Position:  -0.15226511483275404
Bond Position:  [14.71239838]


portfolio before change:  [0.55370386]
curr_Stock_Price:  92.99919878114737
curr_Factors:  [92.99919878]
mat_Sqrt:  [[0.15]]
grads:  [-0.06880135]
Stock Position:  -0.06880135119087215
Bond Position:  [6.9521744]


portfolio before change:  [0.54740494]
curr_Stock_Price:  93.10338275571584
curr_Factors:  [93.10338276]
mat_Sqrt:  [[0.15]]
grads:  [-0.16079615]
Stock Position:  -0.16079615173720332
Bond Position:  [15.5180706]


portfolio before change:  [0.57557293]
curr_Stock_Price:  92.9402686851832
curr_Factors:  [92.94026869]
mat_Sqrt:  [[0.15]]
grads:  [0.20127934]
Stock Position:  0.20127934108624315
Bond Position:  [-18.13138311]


portfolio before change:  [0.40660078]
curr_Stock_Price:  92.11203866569704
curr_Factors:  [92.11203867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08625799]
Stock Position:  -0.08625799463560839
Bond Position:  [8.35200051]


portfolio before change:  [0.39521701]
curr_Stock_Price:  92.25611613537266
curr_Factors:  [92.25611614]
mat_Sqrt:  [[0.15]]
grads:  [-0.0763542]
Stock Position:  -0.07635420393992359
Bond Position:  [7.43935931]


portfolio before change:  [0.45945267]
curr_Stock_Price:  91.42701066881305
curr_Factors:  [91.42701067]
mat_Sqrt:  [[0.15]]
grads:  [0.33325158]
Stock Position:  0.3332515770934884
Bond Position:  [-30.00874282]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.95843795]
Stock Price:  92.9355904811334
PL:  [0.95843795]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 9.71499575e-02]
 [-3.72084518e-02]
 [-1.27602316e-02]
 [-1.10027793e-02]
 [-4.34446630e-03]
 [ 4.06550761e-02]
 [ 3.56257327e-03]
 [ 4.59780728e-03]
 [ 2.44568561e-02]
 [ 2.34429733e-02]
 [ 2.09470763e-02]
 [-1.52856016e-02]
 [ 2.07245603e-03]
 [ 1.14581403e-02]
 [-1.70834198e-02]
 [-1.37614196e-04]
 [-6.09208762e-03]
 [-2.83554120e-03]
 [ 1.34421781e-03]
 [-4.39195348e-03]
 [-9.53174820e-03]
 [-2.11488219e-02]
 [ 4.63704227e-03]
 [-1.08981486e-02]
 [ 1.15626178e-02]
 [ 1.08825070e-04]
 [ 2.64841509e-02]
 [-4.86334816e-03]
 [-4.38288170e-02]
 [-8.34334273e-03]
 [ 5.33190834e-02]
 [-2.13062066e-03]
 [-2.19342114e-02]
 [-2.15906318e-02]
 [-2.34666779e-02]
 [ 3.53557398e-02]
 [-4.33440132e-03]
 [-4.36744680e-03]
 [ 2.15678684e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-56.4832665]
curr_Stock_Price:  97.34148601901194
curr_Factors:  [97.34148602]
mat_Sqrt:  [[0.15]]
grads:  [0.64766638]
Stock Position:  0.6476663832058948
Bond Position:  [-119.52807469]


portfolio before change:  [-57.18687575]
curr_Stock_Price:  96.27818040637227
curr_Factors:  [96.27818041]
mat_Sqrt:  [[0.15]]
grads:  [-0.24805635]
Stock Position:  -0.2480563455934484
Bond Position:  [-33.30446216]


portfolio before change:  [-57.25016941]
curr_Stock_Price:  96.51655504082925
curr_Factors:  [96.51655504]
mat_Sqrt:  [[0.15]]
grads:  [-0.08506821]
Stock Position:  -0.08506821078068372
Bond Position:  [-49.03967876]


portfolio before change:  [-57.17723739]
curr_Stock_Price:  95.58715542127769
curr_Factors:  [95.58715542]
mat_Sqrt:  [[0.15]]
grads:  [-0.07335186]
Stock Position:  -0.07335186232766175
Bond Position:  [-50.16574152]


portfolio before change:  [-57.29707416]
curr_Stock_Price:  97.1353869489549
curr_Factors:  [97.13538695]
mat_Sqrt:  [[0.15]]
grads:  [-0.02896311]
Stock Position:  -0.028963108673500937
Bond Position:  [-54.48373139]


portfolio before change:  [-57.33436105]
curr_Stock_Price:  98.18762175310297
curr_Factors:  [98.18762175]
mat_Sqrt:  [[0.15]]
grads:  [0.27103384]
Stock Position:  0.27103384052444546
Bond Position:  [-83.94652926]


portfolio before change:  [-57.56598356]
curr_Stock_Price:  97.37175113627094
curr_Factors:  [97.37175114]
mat_Sqrt:  [[0.15]]
grads:  [0.02375049]
Stock Position:  0.023750488436545845
Bond Position:  [-59.87861021]


portfolio before change:  [-57.59565004]
curr_Stock_Price:  96.43782564171198
curr_Factors:  [96.43782564]
mat_Sqrt:  [[0.15]]
grads:  [0.03065205]
Stock Position:  0.03065204851427281
Bond Position:  [-60.55166695]


portfolio before change:  [-57.58681554]
curr_Stock_Price:  96.97299167301996
curr_Factors:  [96.97299167]
mat_Sqrt:  [[0.15]]
grads:  [0.16304571]
Stock Position:  0.16304570715154612
Bond Position:  [-73.39784554]


portfolio before change:  [-57.44594321]
curr_Stock_Price:  97.89327124888555
curr_Factors:  [97.89327125]
mat_Sqrt:  [[0.15]]
grads:  [0.15628649]
Stock Position:  0.15628648848667082
Bond Position:  [-72.74533882]


portfolio before change:  [-57.39153398]
curr_Stock_Price:  98.29959537072494
curr_Factors:  [98.29959537]
mat_Sqrt:  [[0.15]]
grads:  [0.13964718]
Stock Position:  0.13964717545793098
Bond Position:  [-71.11879482]


portfolio before change:  [-57.20518888]
curr_Stock_Price:  99.69765805082177
curr_Factors:  [99.69765805]
mat_Sqrt:  [[0.15]]
grads:  [-0.10190401]
Stock Position:  -0.10190401097660602
Bond Position:  [-47.04559764]


portfolio before change:  [-57.08300067]
curr_Stock_Price:  98.44089419289568
curr_Factors:  [98.44089419]
mat_Sqrt:  [[0.15]]
grads:  [0.01381637]
Stock Position:  0.013816373529321978
Bond Position:  [-58.44309683]


portfolio before change:  [-57.10268238]
curr_Stock_Price:  97.54515454944315
curr_Factors:  [97.54515455]
mat_Sqrt:  [[0.15]]
grads:  [0.0763876]
Stock Position:  0.07638760202779504
Bond Position:  [-64.55392283]


portfolio before change:  [-57.10807385]
curr_Stock_Price:  97.58021621842063
curr_Factors:  [97.58021622]
mat_Sqrt:  [[0.15]]
grads:  [-0.11388947]
Stock Position:  -0.11388946560014562
Bond Position:  [-45.99471517]


portfolio before change:  [-56.9912834]
curr_Stock_Price:  96.50425934309104
curr_Factors:  [96.50425934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091743]
Stock Position:  -0.0009174279736951878
Bond Position:  [-56.90274769]


portfolio before change:  [-56.99919807]
curr_Stock_Price:  97.37777555217141
curr_Factors:  [97.37777555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061392]
Stock Position:  -0.04061391746670855
Bond Position:  [-53.04430513]


portfolio before change:  [-56.9541453]
curr_Stock_Price:  96.1052135977794
curr_Factors:  [96.1052136]
mat_Sqrt:  [[0.15]]
grads:  [-0.01890361]
Stock Position:  -0.018903608007941067
Bond Position:  [-55.13741001]


portfolio before change:  [-56.95803183]
curr_Stock_Price:  95.94619255758116
curr_Factors:  [95.94619256]
mat_Sqrt:  [[0.15]]
grads:  [0.00896145]
Stock Position:  0.008961452074819153
Bond Position:  [-57.81784904]


portfolio before change:  [-56.96561531]
curr_Stock_Price:  95.90649031979076
curr_Factors:  [95.90649032]
mat_Sqrt:  [[0.15]]
grads:  [-0.02927969]
Stock Position:  -0.029279689897704506
Bond Position:  [-54.15750301]


portfolio before change:  [-56.99446508]
curr_Stock_Price:  96.66058515177026
curr_Factors:  [96.66058515]
mat_Sqrt:  [[0.15]]
grads:  [-0.06354499]
Stock Position:  -0.06354498800712231
Bond Position:  [-50.85216936]


portfolio before change:  [-56.95403233]
curr_Stock_Price:  95.92426156132404
curr_Factors:  [95.92426156]
mat_Sqrt:  [[0.15]]
grads:  [-0.14099215]
Stock Position:  -0.1409921458876901
Bond Position:  [-43.42946485]


portfolio before change:  [-56.89054477]
curr_Stock_Price:  95.43546428548417
curr_Factors:  [95.43546429]
mat_Sqrt:  [[0.15]]
grads:  [0.03091362]
Stock Position:  0.030913615130235342
Bond Position:  [-59.84079998]


portfolio before change:  [-56.89308889]
curr_Stock_Price:  95.59514962968797
curr_Factors:  [95.59514963]
mat_Sqrt:  [[0.15]]
grads:  [-0.07265432]
Stock Position:  -0.07265432411090898
Bond Position:  [-49.9476879]


portfolio before change:  [-56.90648242]
curr_Stock_Price:  95.69355641855694
curr_Factors:  [95.69355642]
mat_Sqrt:  [[0.15]]
grads:  [0.07708412]
Stock Position:  0.07708411840617989
Bond Position:  [-64.28293585]


portfolio before change:  [-56.92739424]
curr_Stock_Price:  95.52651875125561
curr_Factors:  [95.52651875]
mat_Sqrt:  [[0.15]]
grads:  [0.0007255]
Stock Position:  0.0007255004699208261
Bond Position:  [-56.99669877]


portfolio before change:  [-56.93488293]
curr_Stock_Price:  95.02527237140504
curr_Factors:  [95.02527237]
mat_Sqrt:  [[0.15]]
grads:  [0.17656101]
Stock Position:  0.17656100584802456
Bond Position:  [-73.7126406]


portfolio before change:  [-57.0029127]
curr_Stock_Price:  94.69215736052695
curr_Factors:  [94.69215736]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242232]
Stock Position:  -0.03242232106131573
Bond Position:  [-53.93277317]


portfolio before change:  [-56.9937044]
curr_Stock_Price:  94.20020229182676
curr_Factors:  [94.20020229]
mat_Sqrt:  [[0.15]]
grads:  [-0.29219211]
Stock Position:  -0.29219211355521024
Bond Position:  [-29.46914819]


portfolio before change:  [-56.87286283]
curr_Stock_Price:  93.77402568443756
curr_Factors:  [93.77402568]
mat_Sqrt:  [[0.15]]
grads:  [-0.05562228]
Stock Position:  -0.055622284872806
Bond Position:  [-51.65693726]


portfolio before change:  [-56.86030344]
curr_Stock_Price:  93.43213196364727
curr_Factors:  [93.43213196]
mat_Sqrt:  [[0.15]]
grads:  [0.35546056]
Stock Position:  0.35546055577965674
Bond Position:  [-90.07174099]


portfolio before change:  [-56.523343]
curr_Stock_Price:  94.41176276934056
curr_Factors:  [94.41176277]
mat_Sqrt:  [[0.15]]
grads:  [-0.01420414]
Stock Position:  -0.014204137756495863
Bond Position:  [-55.18230531]


portfolio before change:  [-56.51740853]
curr_Stock_Price:  93.50831577234635
curr_Factors:  [93.50831577]
mat_Sqrt:  [[0.15]]
grads:  [-0.14622808]
Stock Position:  -0.1462280759526941
Bond Position:  [-42.84386743]


portfolio before change:  [-56.64046278]
curr_Stock_Price:  94.31321203299659
curr_Factors:  [94.31321203]
mat_Sqrt:  [[0.15]]
grads:  [-0.14393755]
Stock Position:  -0.14393754510106435
Bond Position:  [-43.06525057]


portfolio before change:  [-56.74592735]
curr_Stock_Price:  95.0085210536994
curr_Factors:  [95.00852105]
mat_Sqrt:  [[0.15]]
grads:  [-0.15644452]
Stock Position:  -0.15644451962701672
Bond Position:  [-41.88236491]


portfolio before change:  [-56.72847396]
curr_Stock_Price:  94.86349193586467
curr_Factors:  [94.86349194]
mat_Sqrt:  [[0.15]]
grads:  [0.23570493]
Stock Position:  0.23570493182595095
Bond Position:  [-79.08826686]


portfolio before change:  [-56.60348054]
curr_Stock_Price:  95.4357331128939
curr_Factors:  [95.43573311]
mat_Sqrt:  [[0.15]]
grads:  [-0.02889601]
Stock Position:  -0.028896008816049774
Bond Position:  [-53.84576876]


portfolio before change:  [-56.58812952]
curr_Stock_Price:  94.67153899768233
curr_Factors:  [94.671539]
mat_Sqrt:  [[0.15]]
grads:  [-0.02911631]
Stock Position:  -0.029116312012663008
Bond Position:  [-53.83164346]


portfolio before change:  [-56.61281986]
curr_Stock_Price:  95.28840818374375
curr_Factors:  [95.28840818]
mat_Sqrt:  [[0.15]]
grads:  [0.14378579]
Stock Position:  0.14378578956089397
Bond Position:  [-70.31393886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-56.5606617]
Stock Price:  95.71228836359855
PL:  [-56.5606617]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 4.09056668e-03]
 [ 4.41715853e-02]
 [-2.68280943e-03]
 [-2.17203579e-03]
 [-3.28173773e-03]
 [ 3.14646372e-02]
 [ 3.67935105e-03]
 [ 4.54334151e-03]
 [-2.67521426e-02]
 [ 2.34412115e-02]
 [ 2.08755259e-02]
 [-1.12204510e-02]
 [-6.99939294e-03]
 [ 1.51026038e-02]
 [-1.75317836e-02]
 [ 4.73057616e-04]
 [-6.06753104e-03]
 [ 1.05125658e-03]
 [ 1.68759357e-03]
 [-1.66596820e-02]
 [-8.01620753e-03]
 [-1.99018799e-02]
 [ 5.39080182e-03]
 [-1.11190359e-02]
 [ 1.09550209e-02]
 [-1.44032811e-03]
 [ 3.33865109e-02]
 [-5.20640000e-03]
 [-3.69388656e-02]
 [-8.97661958e-03]
 [ 4.90567564e-02]
 [-2.70804469e-03]
 [-2.16113779e-02]
 [-2.07665457e-02]
 [-2.36565854e-02]
 [ 3.22709707e-02]
 [-1.11627576e-02]
 [-9.31055068e-03]
 [ 4.05154119e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.82178554]
curr_Stock_Price:  99.74000854031677
curr_Factors:  [99.74000854]
mat_Sqrt:  [[0.15]]
grads:  [0.02727044]
Stock Position:  0.027270444560787168
Bond Position:  [-6.54173992]


portfolio before change:  [-3.80478973]
curr_Stock_Price:  100.39322788740357
curr_Factors:  [100.39322789]
mat_Sqrt:  [[0.15]]
grads:  [0.29447724]
Stock Position:  0.29447723541444365
Bond Position:  [-33.36830993]


portfolio before change:  [-3.80487426]
curr_Stock_Price:  100.4071059405071
curr_Factors:  [100.40710594]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178854]
Stock Position:  -0.01788539620707135
Bond Position:  [-2.00905339]


portfolio before change:  [-3.80877559]
curr_Stock_Price:  100.61119348775615
curr_Factors:  [100.61119349]
mat_Sqrt:  [[0.15]]
grads:  [-0.01448024]
Stock Position:  -0.014480238622729782
Bond Position:  [-2.3519015]


portfolio before change:  [-3.81616265]
curr_Stock_Price:  101.10103693301551
curr_Factors:  [101.10103693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02187825]
Stock Position:  -0.021878251503105354
Bond Position:  [-1.60424873]


portfolio before change:  [-3.81655645]
curr_Stock_Price:  101.10987029625794
curr_Factors:  [101.1098703]
mat_Sqrt:  [[0.15]]
grads:  [0.20976425]
Stock Position:  0.2097642482007316
Bond Position:  [-25.02579238]


portfolio before change:  [-4.01149781]
curr_Stock_Price:  100.19544877988506
curr_Factors:  [100.19544878]
mat_Sqrt:  [[0.15]]
grads:  [0.02452901]
Stock Position:  0.024529007003184215
Bond Position:  [-6.46919268]


portfolio before change:  [-4.01040943]
curr_Stock_Price:  100.27278913275377
curr_Factors:  [100.27278913]
mat_Sqrt:  [[0.15]]
grads:  [0.03028894]
Stock Position:  0.030288943386304827
Bond Position:  [-7.04756626]


portfolio before change:  [-4.01623584]
curr_Stock_Price:  100.10951470390889
curr_Factors:  [100.1095147]
mat_Sqrt:  [[0.15]]
grads:  [-0.17834762]
Stock Position:  -0.17834761752099867
Bond Position:  [13.8380576]


portfolio before change:  [-3.71905754]
curr_Stock_Price:  98.452927223219
curr_Factors:  [98.45292722]
mat_Sqrt:  [[0.15]]
grads:  [0.15627474]
Stock Position:  0.15627474306698938
Bond Position:  [-19.10476345]


portfolio before change:  [-3.72706269]
curr_Stock_Price:  98.41698476721517
curr_Factors:  [98.41698477]
mat_Sqrt:  [[0.15]]
grads:  [0.13917017]
Stock Position:  0.1391701727238829
Bond Position:  [-17.42377146]


portfolio before change:  [-3.76514921]
curr_Stock_Price:  98.15896672708749
curr_Factors:  [98.15896673]
mat_Sqrt:  [[0.15]]
grads:  [-0.07480301]
Stock Position:  -0.07480300699929643
Bond Position:  [3.57743667]


portfolio before change:  [-3.72624672]
curr_Stock_Price:  97.6448793490838
curr_Factors:  [97.64487935]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666262]
Stock Position:  -0.0466626195844126
Bond Position:  [0.83011914]


portfolio before change:  [-3.69175816]
curr_Stock_Price:  96.90799844038776
curr_Factors:  [96.90799844]
mat_Sqrt:  [[0.15]]
grads:  [0.10068403]
Stock Position:  0.10068402533226506
Bond Position:  [-13.44884553]


portfolio before change:  [-3.65113386]
curr_Stock_Price:  97.32817934883633
curr_Factors:  [97.32817935]
mat_Sqrt:  [[0.15]]
grads:  [-0.11687856]
Stock Position:  -0.11687855760212952
Bond Position:  [7.72444336]


portfolio before change:  [-3.64788701]
curr_Stock_Price:  97.30866133418526
curr_Factors:  [97.30866133]
mat_Sqrt:  [[0.15]]
grads:  [0.00315372]
Stock Position:  0.0031537174389787595
Bond Position:  [-3.95477103]


portfolio before change:  [-3.64682556]
curr_Stock_Price:  97.80199102922789
curr_Factors:  [97.80199103]
mat_Sqrt:  [[0.15]]
grads:  [-0.04045021]
Stock Position:  -0.04045020691511448
Bond Position:  [0.30928521]


portfolio before change:  [-3.62971223]
curr_Stock_Price:  97.37987536758163
curr_Factors:  [97.37987537]
mat_Sqrt:  [[0.15]]
grads:  [0.00700838]
Stock Position:  0.0070083771952433
Bond Position:  [-4.31218713]


portfolio before change:  [-3.6306298]
curr_Stock_Price:  97.32586735182532
curr_Factors:  [97.32586735]
mat_Sqrt:  [[0.15]]
grads:  [0.01125062]
Stock Position:  0.011250623812867032
Bond Position:  [-4.72560652]


portfolio before change:  [-3.63638377]
curr_Stock_Price:  96.86693831292949
curr_Factors:  [96.86693831]
mat_Sqrt:  [[0.15]]
grads:  [-0.11106455]
Stock Position:  -0.1110645469532854
Bond Position:  [7.12209884]


portfolio before change:  [-3.65131075]
curr_Stock_Price:  97.00935359391565
curr_Factors:  [97.00935359]
mat_Sqrt:  [[0.15]]
grads:  [-0.05344138]
Stock Position:  -0.05344138350637238
Bond Position:  [1.53300332]


portfolio before change:  [-3.62517914]
curr_Stock_Price:  96.52396254021822
curr_Factors:  [96.52396254]
mat_Sqrt:  [[0.15]]
grads:  [-0.1326792]
Stock Position:  -0.13267919946904116
Bond Position:  [9.18154294]


portfolio before change:  [-3.59098364]
curr_Stock_Price:  96.27488252640077
curr_Factors:  [96.27488253]
mat_Sqrt:  [[0.15]]
grads:  [0.03593868]
Stock Position:  0.03593867883301338
Bond Position:  [-7.05097572]


portfolio before change:  [-3.62444133]
curr_Stock_Price:  95.36844219620285
curr_Factors:  [95.3684422]
mat_Sqrt:  [[0.15]]
grads:  [-0.07412691]
Stock Position:  -0.07412690616036269
Bond Position:  [3.44492623]


portfolio before change:  [-3.60366268]
curr_Stock_Price:  95.09393986453378
curr_Factors:  [95.09393986]
mat_Sqrt:  [[0.15]]
grads:  [0.07303347]
Stock Position:  0.07303347271105437
Bond Position:  [-10.54870334]


portfolio before change:  [-3.6526872]
curr_Stock_Price:  94.44073453901285
curr_Factors:  [94.44073454]
mat_Sqrt:  [[0.15]]
grads:  [-0.00960219]
Stock Position:  -0.009602187415256268
Bond Position:  [-2.74584957]


portfolio before change:  [-3.6465927]
curr_Stock_Price:  93.77028710645746
curr_Factors:  [93.77028711]
mat_Sqrt:  [[0.15]]
grads:  [0.22257674]
Stock Position:  0.2225767390371258
Bond Position:  [-24.51767742]


portfolio before change:  [-3.62132847]
curr_Stock_Price:  93.89756511036634
curr_Factors:  [93.89756511]
mat_Sqrt:  [[0.15]]
grads:  [-0.03470933]
Stock Position:  -0.034709333356525325
Bond Position:  [-0.36220658]


portfolio before change:  [-3.65685068]
curr_Stock_Price:  94.91967995979117
curr_Factors:  [94.91967996]
mat_Sqrt:  [[0.15]]
grads:  [-0.2462591]
Stock Position:  -0.2462591041505607
Bond Position:  [19.71798468]


portfolio before change:  [-3.53974789]
curr_Stock_Price:  94.45416262235953
curr_Factors:  [94.45416262]
mat_Sqrt:  [[0.15]]
grads:  [-0.05984413]
Stock Position:  -0.059844130505268926
Bond Position:  [2.11277934]


portfolio before change:  [-3.52807165]
curr_Stock_Price:  94.26346503219601
curr_Factors:  [94.26346503]
mat_Sqrt:  [[0.15]]
grads:  [0.32704504]
Stock Position:  0.3270450427091504
Bond Position:  [-34.35647059]


portfolio before change:  [-3.5706535]
curr_Stock_Price:  94.14639545120232
curr_Factors:  [94.14639545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01805363]
Stock Position:  -0.018053631274057222
Bond Position:  [-1.87096919]


portfolio before change:  [-3.56690939]
curr_Stock_Price:  93.92605236754808
curr_Factors:  [93.92605237]
mat_Sqrt:  [[0.15]]
grads:  [-0.14407585]
Stock Position:  -0.14407585246034957
Bond Position:  [9.96556667]


portfolio before change:  [-3.61039335]
curr_Stock_Price:  94.23651194352234
curr_Factors:  [94.23651194]
mat_Sqrt:  [[0.15]]
grads:  [-0.13844364]
Stock Position:  -0.13844363825815287
Bond Position:  [9.43605222]


portfolio before change:  [-3.63935769]
curr_Stock_Price:  94.45424618605435
curr_Factors:  [94.45424619]
mat_Sqrt:  [[0.15]]
grads:  [-0.15771057]
Stock Position:  -0.15771056961113936
Bond Position:  [11.25707528]


portfolio before change:  [-3.50533836]
curr_Stock_Price:  93.61338872911556
curr_Factors:  [93.61338873]
mat_Sqrt:  [[0.15]]
grads:  [0.2151398]
Stock Position:  0.21513980498966606
Bond Position:  [-23.64530455]


portfolio before change:  [-3.68370499]
curr_Stock_Price:  92.7980547958177
curr_Factors:  [92.7980548]
mat_Sqrt:  [[0.15]]
grads:  [-0.07441838]
Stock Position:  -0.07441838418009326
Bond Position:  [3.2221763]


portfolio before change:  [-3.69858848]
curr_Stock_Price:  93.00346495526651
curr_Factors:  [93.00346496]
mat_Sqrt:  [[0.15]]
grads:  [-0.06207034]
Stock Position:  -0.06207033787462781
Bond Position:  [2.07416801]


portfolio before change:  [-3.67968269]
curr_Stock_Price:  92.70305572561453
curr_Factors:  [92.70305573]
mat_Sqrt:  [[0.15]]
grads:  [0.27010275]
Stock Position:  0.2701027457855498
Bond Position:  [-28.71903259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.70654255]
Stock Price:  92.61690424947865
PL:  [-3.70654255]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.79202262e-03]
 [ 2.81809799e-02]
 [-4.76922677e-03]
 [-6.93244401e-03]
 [-7.39667456e-03]
 [ 3.03441531e-02]
 [ 3.71654244e-03]
 [ 6.08803711e-03]
 [-2.49801248e-02]
 [ 2.33670877e-02]
 [ 1.92153974e-02]
 [-1.22439250e-02]
 [-2.41207163e-03]
 [ 6.28543605e-03]
 [-1.20103255e-02]
 [ 7.04646682e-04]
 [-6.02422852e-03]
 [ 3.84959573e-03]
 [ 3.74147201e-03]
 [-2.89152707e-02]
 [-4.51940811e-03]
 [-6.01777143e-03]
 [ 7.10082843e-03]
 [-7.42626746e-03]
 [ 1.53340985e-02]
 [ 7.32565139e-03]
 [ 9.31213033e-03]
 [-3.65778296e-03]
 [-1.46387802e-02]
 [-1.22995479e-02]
 [ 3.74298468e-02]
 [ 6.29113304e-03]
 [-1.27109488e-02]
 [-4.47515939e-02]
 [-2.23259840e-02]
 [ 3.85502085e-02]
 [ 1.70003342e-03]
 [ 8.07370930e-03]
 [ 4.75587706e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.9866725]
curr_Stock_Price:  99.32258412742266
curr_Factors:  [99.32258413]
mat_Sqrt:  [[0.15]]
grads:  [-0.05194682]
Stock Position:  -0.051946817479850936
Bond Position:  [-7.82718035]


portfolio before change:  [-12.98205334]
curr_Stock_Price:  99.21482745377263
curr_Factors:  [99.21482745]
mat_Sqrt:  [[0.15]]
grads:  [0.1878732]
Stock Position:  0.1878731992778669
Bond Position:  [-31.62186039]


portfolio before change:  [-12.9177148]
curr_Stock_Price:  99.57832537262638
curr_Factors:  [99.57832537]
mat_Sqrt:  [[0.15]]
grads:  [-0.03179485]
Stock Position:  -0.03179484515824611
Bond Position:  [-9.75163737]


portfolio before change:  [-12.91958822]
curr_Stock_Price:  99.59890668690153
curr_Factors:  [99.59890669]
mat_Sqrt:  [[0.15]]
grads:  [-0.04621629]
Stock Position:  -0.04621629338866625
Bond Position:  [-8.31649592]


portfolio before change:  [-12.92674826]
curr_Stock_Price:  99.73133646776442
curr_Factors:  [99.73133647]
mat_Sqrt:  [[0.15]]
grads:  [-0.04931116]
Stock Position:  -0.04931116374753044
Bond Position:  [-8.00887999]


portfolio before change:  [-12.94846535]
curr_Stock_Price:  100.15144248190417
curr_Factors:  [100.15144248]
mat_Sqrt:  [[0.15]]
grads:  [0.20229435]
Stock Position:  0.20229435385411984
Bond Position:  [-33.20853669]


portfolio before change:  [-12.8715402]
curr_Stock_Price:  100.55222711252756
curr_Factors:  [100.55222711]
mat_Sqrt:  [[0.15]]
grads:  [0.02477695]
Stock Position:  0.024776949629029824
Bond Position:  [-15.36291767]


portfolio before change:  [-12.86496805]
curr_Stock_Price:  100.89499080883289
curr_Factors:  [100.89499081]
mat_Sqrt:  [[0.15]]
grads:  [0.04058691]
Stock Position:  0.040586914051483125
Bond Position:  [-16.95998437]


portfolio before change:  [-12.88709464]
curr_Stock_Price:  100.40206198059414
curr_Factors:  [100.40206198]
mat_Sqrt:  [[0.15]]
grads:  [-0.16653417]
Stock Position:  -0.16653416557319817
Bond Position:  [3.83327897]


portfolio before change:  [-12.89093437]
curr_Stock_Price:  100.4279960930424
curr_Factors:  [100.42799609]
mat_Sqrt:  [[0.15]]
grads:  [0.15578058]
Stock Position:  0.15578058442185902
Bond Position:  [-28.53566629]


portfolio before change:  [-12.90258343]
curr_Stock_Price:  100.3761162055598
curr_Factors:  [100.37611621]
mat_Sqrt:  [[0.15]]
grads:  [0.12810265]
Stock Position:  0.12810264961578202
Bond Position:  [-25.76102987]


portfolio before change:  [-13.15417481]
curr_Stock_Price:  98.4372722226848
curr_Factors:  [98.43727222]
mat_Sqrt:  [[0.15]]
grads:  [-0.08162617]
Stock Position:  -0.08162616682358642
Bond Position:  [-5.1191176]


portfolio before change:  [-13.12393335]
curr_Stock_Price:  98.05894517428166
curr_Factors:  [98.05894517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01608048]
Stock Position:  -0.01608047753829642
Bond Position:  [-11.54709869]


portfolio before change:  [-13.13622954]
curr_Stock_Price:  98.73384488278755
curr_Factors:  [98.73384488]
mat_Sqrt:  [[0.15]]
grads:  [0.04190291]
Stock Position:  0.041902906994853883
Bond Position:  [-17.27346466]


portfolio before change:  [-13.13822315]
curr_Stock_Price:  98.73779937189519
curr_Factors:  [98.73779937]
mat_Sqrt:  [[0.15]]
grads:  [-0.08006884]
Stock Position:  -0.08006883640640626
Bond Position:  [-5.23240245]


portfolio before change:  [-13.08311902]
curr_Stock_Price:  98.04142076458939
curr_Factors:  [98.04142076]
mat_Sqrt:  [[0.15]]
grads:  [0.00469764]
Stock Position:  0.004697644545970728
Bond Position:  [-13.54368276]


portfolio before change:  [-13.08292403]
curr_Stock_Price:  98.44333586699227
curr_Factors:  [98.44333587]
mat_Sqrt:  [[0.15]]
grads:  [-0.04016152]
Stock Position:  -0.04016152343391744
Bond Position:  [-9.12928969]


portfolio before change:  [-13.10720579]
curr_Stock_Price:  99.01952224670559
curr_Factors:  [99.01952225]
mat_Sqrt:  [[0.15]]
grads:  [0.02566397]
Stock Position:  0.025663971528632867
Bond Position:  [-15.64843998]


portfolio before change:  [-13.13621731]
curr_Stock_Price:  97.96530698156626
curr_Factors:  [97.96530698]
mat_Sqrt:  [[0.15]]
grads:  [0.02494315]
Stock Position:  0.02494314671190348
Bond Position:  [-15.57978034]


portfolio before change:  [-13.12499351]
curr_Stock_Price:  98.49336388628728
curr_Factors:  [98.49336389]
mat_Sqrt:  [[0.15]]
grads:  [-0.19276847]
Stock Position:  -0.19276847125054755
Bond Position:  [5.86142168]


portfolio before change:  [-13.40975004]
curr_Stock_Price:  99.97435949693688
curr_Factors:  [99.9743595]
mat_Sqrt:  [[0.15]]
grads:  [-0.03012939]
Stock Position:  -0.030129387401936557
Bond Position:  [-10.39758383]


portfolio before change:  [-13.4045449]
curr_Stock_Price:  99.75845996671644
curr_Factors:  [99.75845997]
mat_Sqrt:  [[0.15]]
grads:  [-0.04011848]
Stock Position:  -0.040118476200519546
Bond Position:  [-9.4023875]


portfolio before change:  [-13.39899105]
curr_Stock_Price:  99.59072609229973
curr_Factors:  [99.59072609]
mat_Sqrt:  [[0.15]]
grads:  [0.04733886]
Stock Position:  0.04733885623124664
Bond Position:  [-18.11350211]


portfolio before change:  [-13.39434012]
curr_Stock_Price:  99.7368059272938
curr_Factors:  [99.73680593]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950845]
Stock Position:  -0.04950844970754824
Bond Position:  [-8.45652548]


portfolio before change:  [-13.36051533]
curr_Stock_Price:  99.03224091720026
curr_Factors:  [99.03224092]
mat_Sqrt:  [[0.15]]
grads:  [0.10222732]
Stock Position:  0.10222732351960728
Bond Position:  [-23.48431626]


portfolio before change:  [-13.40032993]
curr_Stock_Price:  98.67148728506307
curr_Factors:  [98.67148729]
mat_Sqrt:  [[0.15]]
grads:  [0.04883768]
Stock Position:  0.048837675921383786
Bond Position:  [-18.21921605]


portfolio before change:  [-13.46043146]
curr_Stock_Price:  97.48748374980407
curr_Factors:  [97.48748375]
mat_Sqrt:  [[0.15]]
grads:  [0.06208087]
Stock Position:  0.06208086887481532
Bond Position:  [-19.51253916]


portfolio before change:  [-13.45565926]
curr_Stock_Price:  97.60364552790136
curr_Factors:  [97.60364553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02438522]
Stock Position:  -0.02438521974588289
Bond Position:  [-11.07557291]


portfolio before change:  [-13.45497638]
curr_Stock_Price:  97.51886443786407
curr_Factors:  [97.51886444]
mat_Sqrt:  [[0.15]]
grads:  [-0.09759187]
Stock Position:  -0.09759186790620597
Bond Position:  [-3.93792825]


portfolio before change:  [-13.37950845]
curr_Stock_Price:  96.74051883358482
curr_Factors:  [96.74051883]
mat_Sqrt:  [[0.15]]
grads:  [-0.08199699]
Stock Position:  -0.08199698580878825
Bond Position:  [-5.4470775]


portfolio before change:  [-13.38317476]
curr_Stock_Price:  96.77692720438102
curr_Factors:  [96.7769272]
mat_Sqrt:  [[0.15]]
grads:  [0.24953231]
Stock Position:  0.24953231190413092
Bond Position:  [-37.53214514]


portfolio before change:  [-13.33414327]
curr_Stock_Price:  96.99222316116831
curr_Factors:  [96.99222316]
mat_Sqrt:  [[0.15]]
grads:  [0.04194089]
Stock Position:  0.04194088693374898
Bond Position:  [-17.40208314]


portfolio before change:  [-13.31351429]
curr_Stock_Price:  97.53594987717783
curr_Factors:  [97.53594988]
mat_Sqrt:  [[0.15]]
grads:  [-0.08473966]
Stock Position:  -0.0847396588548191
Bond Position:  [-5.04835117]


portfolio before change:  [-13.37385271]
curr_Stock_Price:  98.24054720626792
curr_Factors:  [98.24054721]
mat_Sqrt:  [[0.15]]
grads:  [-0.29834396]
Stock Position:  -0.2983439592728137
Bond Position:  [15.93562111]


portfolio before change:  [-13.35302705]
curr_Stock_Price:  98.1774201385397
curr_Factors:  [98.17742014]
mat_Sqrt:  [[0.15]]
grads:  [-0.14883989]
Stock Position:  -0.14883989355798674
Bond Position:  [1.25968971]


portfolio before change:  [-13.33194442]
curr_Stock_Price:  98.03683176284858
curr_Factors:  [98.03683176]
mat_Sqrt:  [[0.15]]
grads:  [0.25700139]
Stock Position:  0.25700139031196334
Bond Position:  [-38.52754649]


portfolio before change:  [-13.3793186]
curr_Stock_Price:  97.8712375811741
curr_Factors:  [97.87123758]
mat_Sqrt:  [[0.15]]
grads:  [0.01133356]
Stock Position:  0.011333556160895892
Bond Position:  [-14.48854777]


portfolio before change:  [-13.36601932]
curr_Stock_Price:  99.20448703041755
curr_Factors:  [99.20448703]
mat_Sqrt:  [[0.15]]
grads:  [0.05382473]
Stock Position:  0.053824728636315294
Bond Position:  [-18.70567392]


portfolio before change:  [-13.37883599]
curr_Stock_Price:  99.00981238298954
curr_Factors:  [99.00981238]
mat_Sqrt:  [[0.15]]
grads:  [0.03170585]
Stock Position:  0.031705847048162844
Bond Position:  [-16.51802596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.37781617]
Stock Price:  99.10710361782503
PL:  [-13.37781617]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.64051724e-03]
 [ 3.22563278e-02]
 [-1.43621666e-02]
 [-1.03363674e-02]
 [-4.21352100e-04]
 [ 6.45159207e-02]
 [ 2.88525839e-03]
 [ 1.63962632e-02]
 [ 1.18704886e-01]
 [ 2.32852772e-02]
 [ 2.21784296e-02]
 [-1.73472012e-03]
 [-3.63441867e-02]
 [ 1.68283560e-02]
 [-1.75658919e-03]
 [-2.13513346e-03]
 [-5.99093928e-03]
 [-1.41138241e-02]
 [ 1.60966921e-03]
 [ 3.35973067e-02]
 [-2.39761069e-02]
 [-2.49200960e-02]
 [ 4.68267412e-03]
 [-1.00723803e-02]
 [ 1.10520338e-02]
 [-8.08233792e-04]
 [ 2.51868381e-02]
 [-5.29256899e-03]
 [-5.15096382e-02]
 [-7.31571030e-03]
 [ 6.25942680e-02]
 [-8.42727403e-03]
 [-2.25010522e-02]
 [-4.32327841e-03]
 [-2.41464620e-02]
 [ 3.20297206e-02]
 [-9.96648228e-03]
 [-1.11776528e-02]
 [ 4.31124101e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.38832297]
curr_Stock_Price:  99.5775668432616
curr_Factors:  [99.57756684]
mat_Sqrt:  [[0.15]]
grads:  [-0.06427011]
Stock Position:  -0.06427011495010772
Bond Position:  [-0.9884613]


portfolio before change:  [-7.3824892]
curr_Stock_Price:  99.48487465912238
curr_Factors:  [99.48487466]
mat_Sqrt:  [[0.15]]
grads:  [0.21504219]
Stock Position:  0.21504218531593483
Bond Position:  [-28.77593405]


portfolio before change:  [-7.77173913]
curr_Stock_Price:  97.6914929705578
curr_Factors:  [97.69149297]
mat_Sqrt:  [[0.15]]
grads:  [-0.09574778]
Stock Position:  -0.09574777743994638
Bond Position:  [1.5820042]


portfolio before change:  [-7.61973848]
curr_Stock_Price:  96.106047414977
curr_Factors:  [96.10604741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06890912]
Stock Position:  -0.06890911592860988
Bond Position:  [-0.99715572]


portfolio before change:  [-7.53629872]
curr_Stock_Price:  94.89337176704979
curr_Factors:  [94.89337177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00280901]
Stock Position:  -0.0028090139972848536
Bond Position:  [-7.26974191]


portfolio before change:  [-7.53703636]
curr_Stock_Price:  94.83244776050262
curr_Factors:  [94.83244776]
mat_Sqrt:  [[0.15]]
grads:  [0.43010614]
Stock Position:  0.4301061377070853
Bond Position:  [-48.3250542]


portfolio before change:  [-7.92626989]
curr_Stock_Price:  93.94152227944615
curr_Factors:  [93.94152228]
mat_Sqrt:  [[0.15]]
grads:  [0.01923506]
Stock Position:  0.019235055930440528
Bond Position:  [-9.73324032]


portfolio before change:  [-7.94470718]
curr_Stock_Price:  93.04625280357092
curr_Factors:  [93.0462528]
mat_Sqrt:  [[0.15]]
grads:  [0.10930842]
Stock Position:  0.10930842119635874
Bond Position:  [-18.11544617]


portfolio before change:  [-7.8188536]
curr_Stock_Price:  94.21833226670978
curr_Factors:  [94.21833227]
mat_Sqrt:  [[0.15]]
grads:  [0.79136591]
Stock Position:  0.7913659053874815
Bond Position:  [-82.38002941]


portfolio before change:  [-7.16274835]
curr_Stock_Price:  95.06042489108346
curr_Factors:  [95.06042489]
mat_Sqrt:  [[0.15]]
grads:  [0.15523518]
Stock Position:  0.15523518157937277
Bond Position:  [-21.91947067]


portfolio before change:  [-7.14662945]
curr_Stock_Price:  95.18191153957127
curr_Factors:  [95.18191154]
mat_Sqrt:  [[0.15]]
grads:  [0.1478562]
Stock Position:  0.1478561976036401
Bond Position:  [-21.21986497]


portfolio before change:  [-7.32610583]
curr_Stock_Price:  93.98599459549162
curr_Factors:  [93.9859946]
mat_Sqrt:  [[0.15]]
grads:  [-0.0115648]
Stock Position:  -0.011564800781345176
Bond Position:  [-6.23917653]


portfolio before change:  [-7.32489838]
curr_Stock_Price:  93.8141456874173
curr_Factors:  [93.81414569]
mat_Sqrt:  [[0.15]]
grads:  [-0.24229458]
Stock Position:  -0.242294577864022
Bond Position:  [15.40576045]


portfolio before change:  [-7.59193747]
curr_Stock_Price:  94.92421975730424
curr_Factors:  [94.92421976]
mat_Sqrt:  [[0.15]]
grads:  [0.11218904]
Stock Position:  0.11218904014586399
Bond Position:  [-18.24139457]


portfolio before change:  [-7.58574249]
curr_Stock_Price:  94.99976456500556
curr_Factors:  [94.99976457]
mat_Sqrt:  [[0.15]]
grads:  [-0.01171059]
Stock Position:  -0.011710594617103665
Bond Position:  [-6.47323876]


portfolio before change:  [-7.58051582]
curr_Stock_Price:  94.48434449091286
curr_Factors:  [94.48434449]
mat_Sqrt:  [[0.15]]
grads:  [-0.01423422]
Stock Position:  -0.014234223091477642
Bond Position:  [-6.23560458]


portfolio before change:  [-7.56258968]
curr_Stock_Price:  93.17021315464675
curr_Factors:  [93.17021315]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399396]
Stock Position:  -0.03993959518049912
Bond Position:  [-3.84140908]


portfolio before change:  [-7.5650824]
curr_Stock_Price:  93.22060205390929
curr_Factors:  [93.22060205]
mat_Sqrt:  [[0.15]]
grads:  [-0.09409216]
Stock Position:  -0.09409216064911867
Bond Position:  [1.20624547]


portfolio before change:  [-7.56267479]
curr_Stock_Price:  93.19661693071352
curr_Factors:  [93.19661693]
mat_Sqrt:  [[0.15]]
grads:  [0.01073113]
Stock Position:  0.010731128049073675
Bond Position:  [-8.56277962]


portfolio before change:  [-7.56658176]
curr_Stock_Price:  92.93228783994414
curr_Factors:  [92.93228784]
mat_Sqrt:  [[0.15]]
grads:  [0.22398204]
Stock Position:  0.22398204463275137
Bond Position:  [-28.3817456]


portfolio before change:  [-7.47958607]
curr_Stock_Price:  93.33653284335232
curr_Factors:  [93.33653284]
mat_Sqrt:  [[0.15]]
grads:  [-0.15984071]
Stock Position:  -0.15984071263595362
Bond Position:  [7.43939185]


portfolio before change:  [-7.60236995]
curr_Stock_Price:  94.110514955677
curr_Factors:  [94.11051496]
mat_Sqrt:  [[0.15]]
grads:  [-0.16613397]
Stock Position:  -0.16613397303219865
Bond Position:  [8.03258381]


portfolio before change:  [-7.83474925]
curr_Stock_Price:  95.51530555123917
curr_Factors:  [95.51530555]
mat_Sqrt:  [[0.15]]
grads:  [0.03121783]
Stock Position:  0.031217827474187932
Bond Position:  [-10.81652958]


portfolio before change:  [-7.80715091]
curr_Stock_Price:  96.44267603685695
curr_Factors:  [96.44267604]
mat_Sqrt:  [[0.15]]
grads:  [-0.0671492]
Stock Position:  -0.06714920169631036
Bond Position:  [-1.33110221]


portfolio before change:  [-7.72317953]
curr_Stock_Price:  95.18967861132076
curr_Factors:  [95.18967861]
mat_Sqrt:  [[0.15]]
grads:  [0.07368023]
Stock Position:  0.07368022560659648
Bond Position:  [-14.73677653]


portfolio before change:  [-7.74623412]
curr_Stock_Price:  94.90178081506973
curr_Factors:  [94.90178082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00538823]
Stock Position:  -0.005388225278652176
Bond Position:  [-7.23488194]


portfolio before change:  [-7.7490749]
curr_Stock_Price:  95.26114943482739
curr_Factors:  [95.26114943]
mat_Sqrt:  [[0.15]]
grads:  [0.16791225]
Stock Position:  0.1679122540905075
Bond Position:  [-23.74458922]


portfolio before change:  [-8.01451903]
curr_Stock_Price:  93.69797658352479
curr_Factors:  [93.69797658]
mat_Sqrt:  [[0.15]]
grads:  [-0.03528379]
Stock Position:  -0.035283793294659825
Bond Position:  [-4.70849899]


portfolio before change:  [-8.00452821]
curr_Stock_Price:  93.3981386788584
curr_Factors:  [93.39813868]
mat_Sqrt:  [[0.15]]
grads:  [-0.34339759]
Stock Position:  -0.34339758819049043
Bond Position:  [24.06816735]


portfolio before change:  [-7.80787617]
curr_Stock_Price:  92.8342345044982
curr_Factors:  [92.8342345]
mat_Sqrt:  [[0.15]]
grads:  [-0.0487714]
Stock Position:  -0.048771401977016716
Bond Position:  [-3.2802204]


portfolio before change:  [-7.74921656]
curr_Stock_Price:  91.62308075456205
curr_Factors:  [91.62308075]
mat_Sqrt:  [[0.15]]
grads:  [0.41729512]
Stock Position:  0.41729512031432087
Bond Position:  [-45.98308106]


portfolio before change:  [-7.79881294]
curr_Stock_Price:  91.51800369734023
curr_Factors:  [91.5180037]
mat_Sqrt:  [[0.15]]
grads:  [-0.05618183]
Stock Position:  -0.05618182689773022
Bond Position:  [-2.6571643]


portfolio before change:  [-7.86975654]
curr_Stock_Price:  92.77484133142923
curr_Factors:  [92.77484133]
mat_Sqrt:  [[0.15]]
grads:  [-0.15000701]
Stock Position:  -0.15000701450131104
Bond Position:  [6.04712042]


portfolio before change:  [-7.72516853]
curr_Stock_Price:  91.81600567572754
curr_Factors:  [91.81600568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02882186]
Stock Position:  -0.028821856049558878
Bond Position:  [-5.07886083]


portfolio before change:  [-7.76063346]
curr_Stock_Price:  93.0244644907103
curr_Factors:  [93.02446449]
mat_Sqrt:  [[0.15]]
grads:  [-0.16097641]
Stock Position:  -0.16097641332579338
Bond Position:  [7.21411119]


portfolio before change:  [-7.84767379]
curr_Stock_Price:  93.57076909749628
curr_Factors:  [93.5707691]
mat_Sqrt:  [[0.15]]
grads:  [0.21353147]
Stock Position:  0.21353147051826546
Bond Position:  [-27.82797772]


portfolio before change:  [-7.91747825]
curr_Stock_Price:  93.2601556879405
curr_Factors:  [93.26015569]
mat_Sqrt:  [[0.15]]
grads:  [-0.06644322]
Stock Position:  -0.06644321521006108
Bond Position:  [-1.72097365]


portfolio before change:  [-7.85736621]
curr_Stock_Price:  92.3522049534612
curr_Factors:  [92.35220495]
mat_Sqrt:  [[0.15]]
grads:  [-0.07451769]
Stock Position:  -0.07451768560817029
Bond Position:  [-0.97549364]


portfolio before change:  [-7.85756278]
curr_Stock_Price:  92.35320636458248
curr_Factors:  [92.35320636]
mat_Sqrt:  [[0.15]]
grads:  [0.28741607]
Stock Position:  0.28741606725899455
Bond Position:  [-34.40135815]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.95970725]
Stock Price:  92.0127799281188
PL:  [-7.95970725]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.22721512e-02]
 [ 4.39686330e-02]
 [-1.93788503e-03]
 [-7.18088306e-03]
 [-5.21870036e-03]
 [ 4.70459517e-02]
 [ 3.28696005e-03]
 [ 1.77325132e-03]
 [-2.31556588e-03]
 [ 2.34453979e-02]
 [ 2.18101589e-02]
 [-5.71313436e-03]
 [-1.99848581e-02]
 [ 1.71199319e-02]
 [-6.93575795e-03]
 [-9.06472133e-04]
 [-6.08805252e-03]
 [-2.08932043e-03]
 [ 3.49070492e-03]
 [-2.90200689e-02]
 [-6.00765069e-03]
 [-2.02433602e-02]
 [ 6.15768187e-03]
 [-9.67746733e-03]
 [ 1.27556040e-02]
 [ 5.16018179e-03]
 [ 7.62441803e-03]
 [-3.39922688e-03]
 [-2.00327670e-02]
 [-1.48608206e-02]
 [ 3.28217124e-03]
 [ 7.48465658e-03]
 [-1.16316960e-02]
 [-4.61922292e-02]
 [-2.27034460e-02]
 [ 3.89833676e-02]
 [ 3.54736227e-04]
 [ 4.72424253e-03]
 [ 1.15971826e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22124205]
curr_Stock_Price:  99.96969853433568
curr_Factors:  [99.96969853]
mat_Sqrt:  [[0.15]]
grads:  [0.14848101]
Stock Position:  0.14848100804429626
Bond Position:  [-13.62235957]


portfolio before change:  [1.28816984]
curr_Stock_Price:  100.43191720661113
curr_Factors:  [100.43191721]
mat_Sqrt:  [[0.15]]
grads:  [0.29312422]
Stock Position:  0.2931242196831865
Bond Position:  [-28.15085752]


portfolio before change:  [1.09259427]
curr_Stock_Price:  99.77671206928662
curr_Factors:  [99.77671207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291923]
Stock Position:  -0.012919233558397967
Bond Position:  [2.38163291]


portfolio before change:  [1.10418611]
curr_Stock_Price:  98.90250264848233
curr_Factors:  [98.90250265]
mat_Sqrt:  [[0.15]]
grads:  [-0.04787255]
Stock Position:  -0.04787255376402628
Bond Position:  [5.83890148]


portfolio before change:  [1.1560886]
curr_Stock_Price:  97.83356891754657
curr_Factors:  [97.83356892]
mat_Sqrt:  [[0.15]]
grads:  [-0.03479134]
Stock Position:  -0.034791335708131026
Bond Position:  [4.55984914]


portfolio before change:  [1.16468247]
curr_Stock_Price:  97.60294106724538
curr_Factors:  [97.60294107]
mat_Sqrt:  [[0.15]]
grads:  [0.31363968]
Stock Position:  0.31363967826435274
Bond Position:  [-29.44747256]


portfolio before change:  [0.54253161]
curr_Stock_Price:  95.6310295496189
curr_Factors:  [95.63102955]
mat_Sqrt:  [[0.15]]
grads:  [0.02191307]
Stock Position:  0.021913066984723367
Bond Position:  [-1.55303754]


portfolio before change:  [0.57780903]
curr_Stock_Price:  97.24976979347835
curr_Factors:  [97.24976979]
mat_Sqrt:  [[0.15]]
grads:  [0.01182168]
Stock Position:  0.011821675455447843
Bond Position:  [-0.57184618]


portfolio before change:  [0.58364913]
curr_Stock_Price:  97.7498331102767
curr_Factors:  [97.74983311]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543711]
Stock Position:  -0.01543710586149613
Bond Position:  [2.09262366]


portfolio before change:  [0.59358615]
curr_Stock_Price:  97.12306916281645
curr_Factors:  [97.12306916]
mat_Sqrt:  [[0.15]]
grads:  [0.15630265]
Stock Position:  0.15630265260740794
Bond Position:  [-14.58700719]


portfolio before change:  [0.43902311]
curr_Stock_Price:  96.14586534890772
curr_Factors:  [96.14586535]
mat_Sqrt:  [[0.15]]
grads:  [0.14540106]
Stock Position:  0.14540105951572135
Bond Position:  [-13.54068758]


portfolio before change:  [0.4950012]
curr_Stock_Price:  96.54249782231821
curr_Factors:  [96.54249782]
mat_Sqrt:  [[0.15]]
grads:  [-0.03808756]
Stock Position:  -0.03808756240270893
Bond Position:  [4.17206961]


portfolio before change:  [0.49752072]
curr_Stock_Price:  96.49004023623972
curr_Factors:  [96.49004024]
mat_Sqrt:  [[0.15]]
grads:  [-0.13323239]
Stock Position:  -0.13323238760242342
Bond Position:  [13.35311917]


portfolio before change:  [0.6759031]
curr_Stock_Price:  95.16368755193203
curr_Factors:  [95.16368755]
mat_Sqrt:  [[0.15]]
grads:  [0.11413288]
Stock Position:  0.11413287908129006
Bond Position:  [-10.18540254]


portfolio before change:  [0.71458957]
curr_Stock_Price:  95.51380329441811
curr_Factors:  [95.51380329]
mat_Sqrt:  [[0.15]]
grads:  [-0.04623839]
Stock Position:  -0.04623838630635269
Bond Position:  [5.1309937]


portfolio before change:  [0.7105821]
curr_Stock_Price:  95.61434482071274
curr_Factors:  [95.61434482]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604315]
Stock Position:  -0.006043147554011623
Bond Position:  [1.2883937]


portfolio before change:  [0.70830309]
curr_Stock_Price:  96.01811970066638
curr_Factors:  [96.0181197]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058702]
Stock Position:  -0.04058701679332065
Bond Position:  [4.60539213]


portfolio before change:  [0.69759754]
curr_Stock_Price:  96.2960721761767
curr_Factors:  [96.29607218]
mat_Sqrt:  [[0.15]]
grads:  [-0.0139288]
Stock Position:  -0.013928802890995316
Bond Position:  [2.03888655]


portfolio before change:  [0.67568266]
curr_Stock_Price:  97.887720641607
curr_Factors:  [97.88772064]
mat_Sqrt:  [[0.15]]
grads:  [0.02327137]
Stock Position:  0.023271366107498883
Bond Position:  [-1.60229833]


portfolio before change:  [0.67619695]
curr_Stock_Price:  97.91842762062412
curr_Factors:  [97.91842762]
mat_Sqrt:  [[0.15]]
grads:  [-0.19346713]
Stock Position:  -0.19346712604080604
Bond Position:  [19.62019373]


portfolio before change:  [0.75823749]
curr_Stock_Price:  97.50705094991181
curr_Factors:  [97.50705095]
mat_Sqrt:  [[0.15]]
grads:  [-0.040051]
Stock Position:  -0.040051004595227986
Bond Position:  [4.66349284]


portfolio before change:  [0.80477174]
curr_Stock_Price:  96.35973190710166
curr_Factors:  [96.35973191]
mat_Sqrt:  [[0.15]]
grads:  [-0.13495573]
Stock Position:  -0.13495573477821501
Bond Position:  [13.80907017]


portfolio before change:  [0.69155305]
curr_Stock_Price:  97.211455149851
curr_Factors:  [97.21145515]
mat_Sqrt:  [[0.15]]
grads:  [0.04105121]
Stock Position:  0.04105121244685282
Bond Position:  [-3.29909505]


portfolio before change:  [0.67622014]
curr_Stock_Price:  96.84799445787934
curr_Factors:  [96.84799446]
mat_Sqrt:  [[0.15]]
grads:  [-0.06451645]
Stock Position:  -0.06451644889268573
Bond Position:  [6.92450882]


portfolio before change:  [0.66304852]
curr_Stock_Price:  97.06557053689326
curr_Factors:  [97.06557054]
mat_Sqrt:  [[0.15]]
grads:  [0.08503736]
Stock Position:  0.08503736014396537
Bond Position:  [-7.59115136]


portfolio before change:  [0.71741095]
curr_Stock_Price:  97.71600686365407
curr_Factors:  [97.71600686]
mat_Sqrt:  [[0.15]]
grads:  [0.03440121]
Stock Position:  0.03440121193183452
Bond Position:  [-2.64413811]


portfolio before change:  [0.71475185]
curr_Stock_Price:  97.64831844672686
curr_Factors:  [97.64831845]
mat_Sqrt:  [[0.15]]
grads:  [0.05082945]
Stock Position:  0.05082945350233503
Bond Position:  [-4.24865881]


portfolio before change:  [0.72547169]
curr_Stock_Price:  97.86966563409958
curr_Factors:  [97.86966563]
mat_Sqrt:  [[0.15]]
grads:  [-0.02266151]
Stock Position:  -0.022661512528191215
Bond Position:  [2.94334635]


portfolio before change:  [0.75092307]
curr_Stock_Price:  96.76279159547354
curr_Factors:  [96.7627916]
mat_Sqrt:  [[0.15]]
grads:  [-0.13355178]
Stock Position:  -0.1335517803246848
Bond Position:  [13.67376616]


portfolio before change:  [0.56828894]
curr_Stock_Price:  98.14310614497097
curr_Factors:  [98.14310614]
mat_Sqrt:  [[0.15]]
grads:  [-0.09907214]
Stock Position:  -0.09907213706062222
Bond Position:  [10.2915362]


portfolio before change:  [0.50831444]
curr_Stock_Price:  98.76145378884277
curr_Factors:  [98.76145379]
mat_Sqrt:  [[0.15]]
grads:  [0.02188114]
Stock Position:  0.02188114159919921
Bond Position:  [-1.65269892]


portfolio before change:  [0.47789909]
curr_Stock_Price:  97.38087009198291
curr_Factors:  [97.38087009]
mat_Sqrt:  [[0.15]]
grads:  [0.04989771]
Stock Position:  0.04989771054116941
Bond Position:  [-4.38118338]


portfolio before change:  [0.50549255]
curr_Stock_Price:  97.94484682715661
curr_Factors:  [97.94484683]
mat_Sqrt:  [[0.15]]
grads:  [-0.07754464]
Stock Position:  -0.07754464011418216
Bond Position:  [8.10059045]


portfolio before change:  [0.59962262]
curr_Stock_Price:  96.74402331811835
curr_Factors:  [96.74402332]
mat_Sqrt:  [[0.15]]
grads:  [-0.30794819]
Stock Position:  -0.30794819449011235
Bond Position:  [30.39176993]


portfolio before change:  [0.45187744]
curr_Stock_Price:  97.23613331653888
curr_Factors:  [97.23613332]
mat_Sqrt:  [[0.15]]
grads:  [-0.15135631]
Stock Position:  -0.15135630683832957
Bond Position:  [15.16917947]


portfolio before change:  [0.42538955]
curr_Stock_Price:  97.42366532855308
curr_Factors:  [97.42366533]
mat_Sqrt:  [[0.15]]
grads:  [0.25988912]
Stock Position:  0.25988911713568214
Bond Position:  [-24.89396082]


portfolio before change:  [0.40254137]
curr_Stock_Price:  97.34772430316839
curr_Factors:  [97.3477243]
mat_Sqrt:  [[0.15]]
grads:  [0.00236491]
Stock Position:  0.002364908181263733
Bond Position:  [0.17232294]


portfolio before change:  [0.40203376]
curr_Stock_Price:  97.12397300942831
curr_Factors:  [97.12397301]
mat_Sqrt:  [[0.15]]
grads:  [0.03149495]
Stock Position:  0.03149495017568518
Bond Position:  [-2.65688093]


portfolio before change:  [0.39375253]
curr_Stock_Price:  96.8715803027652
curr_Factors:  [96.8715803]
mat_Sqrt:  [[0.15]]
grads:  [0.07731455]
Stock Position:  0.07731455096385313
Bond Position:  [-7.0958302]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.39587747]
Stock Price:  96.91053765926121
PL:  [0.39587747]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.88599181e-02]
 [ 4.34056927e-02]
 [-1.97538857e-03]
 [-5.53633523e-03]
 [-1.63641641e-03]
 [ 1.05631322e-02]
 [ 3.66243710e-03]
 [ 6.90070019e-03]
 [ 9.51869221e-03]
 [ 2.29348954e-02]
 [ 1.96996550e-02]
 [-6.61073303e-03]
 [ 2.46947817e-03]
 [ 2.33627459e-02]
 [-1.08195513e-02]
 [-3.15749564e-03]
 [-4.84390257e-03]
 [ 7.65252722e-03]
 [ 1.46857660e-02]
 [ 1.47595356e-02]
 [-9.16045513e-04]
 [-4.47330466e-03]
 [ 4.89403230e-03]
 [-1.07626097e-02]
 [-3.09558879e-03]
 [ 4.20022170e-03]
 [ 6.83058603e-03]
 [ 1.33126589e-03]
 [ 5.18494754e-03]
 [-4.67116633e-03]
 [-1.87492884e-02]
 [ 1.36420016e-02]
 [-2.93719124e-03]
 [-1.98540059e-02]
 [-2.05463494e-02]
 [ 2.19533581e-02]
 [ 4.44990750e-03]
 [ 1.68373990e-02]
 [ 9.19737396e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.49867523]
curr_Stock_Price:  100.80216344636814
curr_Factors:  [100.80216345]
mat_Sqrt:  [[0.15]]
grads:  [-0.25906612]
Stock Position:  -0.25906612066964313
Bond Position:  [45.61310067]


portfolio before change:  [19.67559133]
curr_Stock_Price:  100.1412738155616
curr_Factors:  [100.14127382]
mat_Sqrt:  [[0.15]]
grads:  [0.28937128]
Stock Position:  0.28937128481215846
Bond Position:  [-9.30241773]


portfolio before change:  [19.5837635]
curr_Stock_Price:  99.82795676362888
curr_Factors:  [99.82795676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01316926]
Stock Position:  -0.013169257117349847
Bond Position:  [20.89842353]


portfolio before change:  [19.58262171]
curr_Stock_Price:  100.11303395645552
curr_Factors:  [100.11303396]
mat_Sqrt:  [[0.15]]
grads:  [-0.0369089]
Stock Position:  -0.03690890153611205
Bond Position:  [23.27768383]


portfolio before change:  [19.51787134]
curr_Stock_Price:  101.94620334577202
curr_Factors:  [101.94620335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01090944]
Stock Position:  -0.010909442704141037
Bond Position:  [20.6300476]


portfolio before change:  [19.51718301]
curr_Stock_Price:  102.24569067564693
curr_Factors:  [102.24569068]
mat_Sqrt:  [[0.15]]
grads:  [0.07042088]
Stock Position:  0.07042088102895992
Bond Position:  [12.3169514]


portfolio before change:  [19.45596004]
curr_Stock_Price:  101.35443957004492
curr_Factors:  [101.35443957]
mat_Sqrt:  [[0.15]]
grads:  [0.02441625]
Stock Position:  0.024416247363618925
Bond Position:  [16.98126497]


portfolio before change:  [19.45075375]
curr_Stock_Price:  101.05426718876545
curr_Factors:  [101.05426719]
mat_Sqrt:  [[0.15]]
grads:  [0.04600467]
Stock Position:  0.046004667936984225
Bond Position:  [14.80178574]


portfolio before change:  [19.52278131]
curr_Stock_Price:  102.57970425717888
curr_Factors:  [102.57970426]
mat_Sqrt:  [[0.15]]
grads:  [0.06345795]
Stock Position:  0.06345794803835562
Bond Position:  [13.01328377]


portfolio before change:  [19.48434958]
curr_Stock_Price:  101.94844379805737
curr_Factors:  [101.9484438]
mat_Sqrt:  [[0.15]]
grads:  [0.1528993]
Stock Position:  0.1528993027485817
Bond Position:  [3.89650361]


portfolio before change:  [19.46713456]
curr_Stock_Price:  101.83266748384472
curr_Factors:  [101.83266748]
mat_Sqrt:  [[0.15]]
grads:  [0.13133103]
Stock Position:  0.1313310331886618
Bond Position:  [6.09334512]


portfolio before change:  [19.53714496]
curr_Stock_Price:  102.35995097149876
curr_Factors:  [102.35995097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04407155]
Stock Position:  -0.044071553539228314
Bond Position:  [24.04830702]


portfolio before change:  [19.50045867]
curr_Stock_Price:  103.26058902267317
curr_Factors:  [103.26058902]
mat_Sqrt:  [[0.15]]
grads:  [0.01646319]
Stock Position:  0.016463187770019008
Bond Position:  [17.8004602]


portfolio before change:  [19.5045891]
curr_Stock_Price:  103.37631618736921
curr_Factors:  [103.37631619]
mat_Sqrt:  [[0.15]]
grads:  [0.15575164]
Stock Position:  0.15575163901346867
Bond Position:  [3.40355842]


portfolio before change:  [19.47210232]
curr_Stock_Price:  103.16500376929656
curr_Factors:  [103.16500377]
mat_Sqrt:  [[0.15]]
grads:  [-0.07213034]
Stock Position:  -0.07213034229610676
Bond Position:  [26.91342935]


portfolio before change:  [19.49321045]
curr_Stock_Price:  102.91900817032311
curr_Factors:  [102.91900817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02104997]
Stock Position:  -0.021049970915291615
Bond Position:  [21.65965258]


portfolio before change:  [19.47573817]
curr_Stock_Price:  103.87767515214438
curr_Factors:  [103.87767515]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229268]
Stock Position:  -0.03229268378244505
Bond Position:  [22.83022708]


portfolio before change:  [19.49609443]
curr_Stock_Price:  103.33568529928436
curr_Factors:  [103.3356853]
mat_Sqrt:  [[0.15]]
grads:  [0.05101685]
Stock Position:  0.05101684815589195
Bond Position:  [14.22423346]


portfolio before change:  [19.45177211]
curr_Stock_Price:  102.43205319681232
curr_Factors:  [102.4320532]
mat_Sqrt:  [[0.15]]
grads:  [0.09790511]
Stock Position:  0.09790510658826912
Bond Position:  [9.42315102]


portfolio before change:  [19.50994513]
curr_Stock_Price:  103.01419903817161
curr_Factors:  [103.01419904]
mat_Sqrt:  [[0.15]]
grads:  [0.0983969]
Stock Position:  0.0983969041498595
Bond Position:  [9.37366686]


portfolio before change:  [19.47615096]
curr_Stock_Price:  102.6588428706764
curr_Factors:  [102.65884287]
mat_Sqrt:  [[0.15]]
grads:  [-0.00610697]
Stock Position:  -0.006106970085719359
Bond Position:  [20.10308544]


portfolio before change:  [19.47992635]
curr_Stock_Price:  102.45213712053769
curr_Factors:  [102.45213712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02982203]
Stock Position:  -0.02982203104886112
Bond Position:  [22.53525716]


portfolio before change:  [19.44095058]
curr_Stock_Price:  103.85354586978289
curr_Factors:  [103.85354587]
mat_Sqrt:  [[0.15]]
grads:  [0.03262688]
Stock Position:  0.03262688197226193
Bond Position:  [16.0525332]


portfolio before change:  [19.44475721]
curr_Stock_Price:  103.90871337513937
curr_Factors:  [103.90871338]
mat_Sqrt:  [[0.15]]
grads:  [-0.07175073]
Stock Position:  -0.07175073159126912
Bond Position:  [26.90028342]


portfolio before change:  [19.43156648]
curr_Stock_Price:  104.13942159749925
curr_Factors:  [104.1394216]
mat_Sqrt:  [[0.15]]
grads:  [-0.02063726]
Stock Position:  -0.020637258580078043
Bond Position:  [21.58071865]


portfolio before change:  [19.44801287]
curr_Stock_Price:  103.4732171306837
curr_Factors:  [103.47321713]
mat_Sqrt:  [[0.15]]
grads:  [0.02800148]
Stock Position:  0.028001478006085292
Bond Position:  [16.55060985]


portfolio before change:  [19.49318569]
curr_Stock_Price:  105.01255955738849
curr_Factors:  [105.01255956]
mat_Sqrt:  [[0.15]]
grads:  [0.04553724]
Stock Position:  0.045537240187943584
Bond Position:  [14.71120354]


portfolio before change:  [19.42057034]
curr_Stock_Price:  103.3775381755391
curr_Factors:  [103.37753818]
mat_Sqrt:  [[0.15]]
grads:  [0.00887511]
Stock Position:  0.008875105957476578
Bond Position:  [18.50308374]


portfolio before change:  [19.43155858]
curr_Stock_Price:  104.35501516872014
curr_Factors:  [104.35501517]
mat_Sqrt:  [[0.15]]
grads:  [0.03456632]
Stock Position:  0.03456631695928132
Bond Position:  [15.82439005]


portfolio before change:  [19.43218019]
curr_Stock_Price:  104.31576973862974
curr_Factors:  [104.31576974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03114111]
Stock Position:  -0.03114110883636588
Bond Position:  [22.68068892]


portfolio before change:  [19.4808604]
curr_Stock_Price:  102.84360143851688
curr_Factors:  [102.84360144]
mat_Sqrt:  [[0.15]]
grads:  [-0.12499526]
Stock Position:  -0.1249952561871636
Bond Position:  [32.33582271]


portfolio before change:  [19.56621814]
curr_Stock_Price:  102.19305266276996
curr_Factors:  [102.19305266]
mat_Sqrt:  [[0.15]]
grads:  [0.09094668]
Stock Position:  0.09094667764650388
Bond Position:  [10.27209953]


portfolio before change:  [19.59519718]
curr_Stock_Price:  102.49757116217768
curr_Factors:  [102.49757116]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958127]
Stock Position:  -0.019581274950875
Bond Position:  [21.6022303]


portfolio before change:  [19.60782614]
curr_Stock_Price:  101.99053004923391
curr_Factors:  [101.99053005]
mat_Sqrt:  [[0.15]]
grads:  [-0.13236004]
Stock Position:  -0.13236003948511096
Bond Position:  [33.10729673]


portfolio before change:  [19.64553244]
curr_Stock_Price:  101.73692153700524
curr_Factors:  [101.73692154]
mat_Sqrt:  [[0.15]]
grads:  [-0.13697566]
Stock Position:  -0.13697566258663627
Bond Position:  [33.58101468]


portfolio before change:  [19.5725122]
curr_Stock_Price:  102.30065767858846
curr_Factors:  [102.30065768]
mat_Sqrt:  [[0.15]]
grads:  [0.14635572]
Stock Position:  0.1463557209388526
Bond Position:  [4.6002257]


portfolio before change:  [19.52053487]
curr_Stock_Price:  101.94158465322177
curr_Factors:  [101.94158465]
mat_Sqrt:  [[0.15]]
grads:  [0.02966605]
Stock Position:  0.029666049977849027
Bond Position:  [16.49633073]


portfolio before change:  [19.52912788]
curr_Stock_Price:  102.16172989530058
curr_Factors:  [102.1617299]
mat_Sqrt:  [[0.15]]
grads:  [0.11224933]
Stock Position:  0.11224932638463518
Bond Position:  [8.06154252]


portfolio before change:  [19.50297178]
curr_Stock_Price:  101.91973415103763
curr_Factors:  [101.91973415]
mat_Sqrt:  [[0.15]]
grads:  [0.06131583]
Stock Position:  0.061315826423981916
Bond Position:  [13.25367905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.492002]
Stock Price:  101.7138069460858
PL:  [17.77819505]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.21170800e-02]
 [-6.51525227e-03]
 [-2.45373064e-03]
 [-2.59377680e-03]
 [-3.03660220e-03]
 [ 1.20826272e-02]
 [ 3.43265182e-03]
 [ 2.68588308e-02]
 [ 6.41761022e-02]
 [ 2.26328518e-02]
 [ 1.49834138e-02]
 [ 9.67856873e-03]
 [-1.24220276e-03]
 [ 2.33026476e-02]
 [-7.54575140e-03]
 [-5.44741251e-03]
 [-4.29907924e-03]
 [ 7.47574278e-03]
 [ 2.83174722e-02]
 [-4.83663271e-03]
 [-9.72035473e-04]
 [-2.25016008e-02]
 [ 7.34152851e-03]
 [-7.41760800e-03]
 [-4.87089545e-03]
 [ 4.62574244e-03]
 [ 6.80649658e-03]
 [ 1.95604705e-03]
 [ 5.05221685e-03]
 [-5.77083903e-03]
 [-1.67039841e-02]
 [ 6.05123687e-03]
 [ 3.75644450e-03]
 [ 2.56819075e-02]
 [-2.00852588e-02]
 [-9.36698986e-03]
 [ 1.55694007e-02]
 [ 1.69391197e-02]
 [ 9.14585539e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.84016202]
curr_Stock_Price:  100.90880892434745
curr_Factors:  [100.90880892]
mat_Sqrt:  [[0.15]]
grads:  [-0.28078053]
Stock Position:  -0.2807805331545419
Bond Position:  [50.17339119]


portfolio before change:  [21.71794571]
curr_Stock_Price:  101.36642033727567
curr_Factors:  [101.36642034]
mat_Sqrt:  [[0.15]]
grads:  [-0.04343502]
Stock Position:  -0.04343501513332233
Bond Position:  [26.12079771]


portfolio before change:  [21.72775117]
curr_Stock_Price:  101.21584694918957
curr_Factors:  [101.21584695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0163582]
Stock Position:  -0.016358204250190394
Bond Position:  [23.38346067]


portfolio before change:  [21.72873712]
curr_Stock_Price:  101.33426853565523
curr_Factors:  [101.33426854]
mat_Sqrt:  [[0.15]]
grads:  [-0.01729185]
Stock Position:  -0.017291845348103223
Bond Position:  [23.48099362]


portfolio before change:  [21.73450059]
curr_Stock_Price:  101.17071400374608
curr_Factors:  [101.170714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024401]
Stock Position:  -0.020244014683071826
Bond Position:  [23.78260201]


portfolio before change:  [21.71699702]
curr_Stock_Price:  102.1822020357643
curr_Factors:  [102.18220204]
mat_Sqrt:  [[0.15]]
grads:  [0.08055085]
Stock Position:  0.08055084779589562
Bond Position:  [13.48613402]


portfolio before change:  [21.81418248]
curr_Stock_Price:  103.36778346227884
curr_Factors:  [103.36778346]
mat_Sqrt:  [[0.15]]
grads:  [0.02288435]
Stock Position:  0.022884345486048997
Bond Position:  [19.44867841]


portfolio before change:  [21.81055433]
curr_Stock_Price:  103.10300027021043
curr_Factors:  [103.10300027]
mat_Sqrt:  [[0.15]]
grads:  [0.17905887]
Stock Position:  0.17905887182958946
Bond Position:  [3.34904742]


portfolio before change:  [21.99410653]
curr_Stock_Price:  104.12575632286759
curr_Factors:  [104.12575632]
mat_Sqrt:  [[0.15]]
grads:  [0.42784068]
Stock Position:  0.42784068129963015
Bond Position:  [-22.55512799]


portfolio before change:  [21.79543044]
curr_Stock_Price:  103.66797720915282
curr_Factors:  [103.66797721]
mat_Sqrt:  [[0.15]]
grads:  [0.15088568]
Stock Position:  0.1508856789913103
Bond Position:  [6.15341731]


portfolio before change:  [22.02506687]
curr_Stock_Price:  105.18480244450865
curr_Factors:  [105.18480244]
mat_Sqrt:  [[0.15]]
grads:  [0.09988943]
Stock Position:  0.0998894253231223
Bond Position:  [11.5182174]


portfolio before change:  [22.02187457]
curr_Stock_Price:  105.13842956480606
curr_Factors:  [105.13842956]
mat_Sqrt:  [[0.15]]
grads:  [0.06452379]
Stock Position:  0.06452379152555711
Bond Position:  [15.23794446]


portfolio before change:  [21.97709125]
curr_Stock_Price:  104.41484859372572
curr_Factors:  [104.41484859]
mat_Sqrt:  [[0.15]]
grads:  [-0.00828135]
Stock Position:  -0.00828135170647207
Bond Position:  [22.84178733]


portfolio before change:  [21.97557102]
curr_Stock_Price:  104.94322055707902
curr_Factors:  [104.94322056]
mat_Sqrt:  [[0.15]]
grads:  [0.15535098]
Stock Position:  0.15535098426905125
Bond Position:  [5.67253841]


portfolio before change:  [22.12452732]
curr_Stock_Price:  105.89749316746678
curr_Factors:  [105.89749317]
mat_Sqrt:  [[0.15]]
grads:  [-0.05030501]
Stock Position:  -0.050305009300426015
Bond Position:  [27.4517017]


portfolio before change:  [22.11065874]
curr_Stock_Price:  106.24140042674533
curr_Factors:  [106.24140043]
mat_Sqrt:  [[0.15]]
grads:  [-0.03631608]
Stock Position:  -0.036316083425166956
Bond Position:  [25.9689303]


portfolio before change:  [22.15585198]
curr_Stock_Price:  105.08634955917516
curr_Factors:  [105.08634956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02866053]
Stock Position:  -0.028660528273847335
Bond Position:  [25.16768227]


portfolio before change:  [22.13707536]
curr_Stock_Price:  105.85126138345942
curr_Factors:  [105.85126138]
mat_Sqrt:  [[0.15]]
grads:  [0.04983829]
Stock Position:  0.04983828516826517
Bond Position:  [16.86163001]


portfolio before change:  [22.1332114]
curr_Stock_Price:  105.73143790446431
curr_Factors:  [105.7314379]
mat_Sqrt:  [[0.15]]
grads:  [0.18878315]
Stock Position:  0.18878314830222812
Bond Position:  [2.17289768]


portfolio before change:  [22.04758841]
curr_Stock_Price:  105.27644696860384
curr_Factors:  [105.27644697]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224422]
Stock Position:  -0.03224421804413643
Bond Position:  [25.44214512]


portfolio before change:  [22.01879161]
curr_Stock_Price:  106.26816790032558
curr_Factors:  [106.2681679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00648024]
Stock Position:  -0.00648023648419842
Bond Position:  [22.70743447]


portfolio before change:  [22.02150233]
curr_Stock_Price:  106.28790173942376
curr_Factors:  [106.28790174]
mat_Sqrt:  [[0.15]]
grads:  [-0.15001067]
Stock Position:  -0.15001067195625134
Bond Position:  [37.9658219]


portfolio before change:  [22.11157459]
curr_Stock_Price:  105.71910067253881
curr_Factors:  [105.71910067]
mat_Sqrt:  [[0.15]]
grads:  [0.04894352]
Stock Position:  0.048943523413459075
Bond Position:  [16.93730931]


portfolio before change:  [22.09532329]
curr_Stock_Price:  105.34379875880327
curr_Factors:  [105.34379876]
mat_Sqrt:  [[0.15]]
grads:  [-0.04945072]
Stock Position:  -0.04945071998923766
Bond Position:  [27.30464998]


portfolio before change:  [22.13231193]
curr_Stock_Price:  104.66483295979378
curr_Factors:  [104.66483296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247264]
Stock Position:  -0.032472636319239814
Bond Position:  [25.53105499]


portfolio before change:  [22.1189536]
curr_Stock_Price:  105.17449021872604
curr_Factors:  [105.17449022]
mat_Sqrt:  [[0.15]]
grads:  [0.03083828]
Stock Position:  0.03083828293417575
Bond Position:  [18.87555291]


portfolio before change:  [22.12723432]
curr_Stock_Price:  105.3664959923277
curr_Factors:  [105.36649599]
mat_Sqrt:  [[0.15]]
grads:  [0.04537664]
Stock Position:  0.04537664389537955
Bond Position:  [17.34605635]


portfolio before change:  [22.08696341]
curr_Stock_Price:  104.43122844549136
curr_Factors:  [104.43122845]
mat_Sqrt:  [[0.15]]
grads:  [0.01304031]
Stock Position:  0.013040313633403064
Bond Position:  [20.72514743]


portfolio before change:  [22.0852909]
curr_Stock_Price:  104.10429562324536
curr_Factors:  [104.10429562]
mat_Sqrt:  [[0.15]]
grads:  [0.03368145]
Stock Position:  0.03368144568268102
Bond Position:  [18.57890773]


portfolio before change:  [22.05853353]
curr_Stock_Price:  103.24091561712338
curr_Factors:  [103.24091562]
mat_Sqrt:  [[0.15]]
grads:  [-0.03847226]
Stock Position:  -0.0384722602084638
Bond Position:  [26.0304449]


portfolio before change:  [22.02309419]
curr_Stock_Price:  104.24666229589229
curr_Factors:  [104.2466623]
mat_Sqrt:  [[0.15]]
grads:  [-0.11135989]
Stock Position:  -0.11135989397381307
Bond Position:  [33.63199145]


portfolio before change:  [22.00780568]
curr_Stock_Price:  104.42170526733375
curr_Factors:  [104.42170527]
mat_Sqrt:  [[0.15]]
grads:  [0.04034158]
Stock Position:  0.040341579143013284
Bond Position:  [17.7952692]


portfolio before change:  [22.02926264]
curr_Stock_Price:  104.89844443883548
curr_Factors:  [104.89844444]
mat_Sqrt:  [[0.15]]
grads:  [0.02504296]
Stock Position:  0.0250429633475582
Bond Position:  [19.40229474]


portfolio before change:  [22.04068639]
curr_Stock_Price:  105.25775942560733
curr_Factors:  [105.25775943]
mat_Sqrt:  [[0.15]]
grads:  [0.17121272]
Stock Position:  0.17121271694893456
Bond Position:  [4.01921942]


portfolio before change:  [22.20325509]
curr_Stock_Price:  106.20433786499973
curr_Factors:  [106.20433786]
mat_Sqrt:  [[0.15]]
grads:  [-0.13390173]
Stock Position:  -0.13390172530109057
Bond Position:  [36.42419917]


portfolio before change:  [22.27650663]
curr_Stock_Price:  105.69128824832521
curr_Factors:  [105.69128825]
mat_Sqrt:  [[0.15]]
grads:  [-0.0624466]
Stock Position:  -0.06244659909095639
Bond Position:  [28.87656813]


portfolio before change:  [22.25683933]
curr_Stock_Price:  106.06404028179763
curr_Factors:  [106.06404028]
mat_Sqrt:  [[0.15]]
grads:  [0.103796]
Stock Position:  0.10379600452682279
Bond Position:  [11.24781572]


portfolio before change:  [22.32016189]
curr_Stock_Price:  106.66056129701664
curr_Factors:  [106.6605613]
mat_Sqrt:  [[0.15]]
grads:  [0.11292746]
Stock Position:  0.11292746439821151
Bond Position:  [10.27525515]


portfolio before change:  [22.17739841]
curr_Stock_Price:  105.38498166457626
curr_Factors:  [105.38498166]
mat_Sqrt:  [[0.15]]
grads:  [0.06097237]
Stock Position:  0.06097236929814034
Bond Position:  [15.75182639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.23069707]
Stock Price:  106.22683117684424
PL:  [16.00386589]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.66956609e-02]
 [ 4.11286918e-02]
 [-9.37408522e-03]
 [-7.64614328e-03]
 [-6.46264219e-03]
 [ 3.35696371e-02]
 [ 3.54261238e-03]
 [ 1.32100452e-03]
 [-2.76752074e-02]
 [ 2.34007941e-02]
 [ 1.91741456e-02]
 [-1.35443989e-02]
 [ 2.44781171e-02]
 [ 2.12575447e-02]
 [-1.93538507e-03]
 [-3.05459263e-03]
 [-4.89944273e-03]
 [ 7.93090191e-03]
 [ 2.62729542e-02]
 [-7.41676697e-03]
 [-8.33793355e-04]
 [-2.13870607e-02]
 [ 6.68829710e-03]
 [-7.41976637e-03]
 [-1.03177825e-02]
 [ 4.84074419e-03]
 [ 6.78355854e-03]
 [ 2.66018903e-03]
 [ 5.46994678e-03]
 [ 4.55450694e-03]
 [-1.65096039e-02]
 [ 3.12044558e-03]
 [ 1.28164375e-02]
 [ 7.79445907e-02]
 [-2.00119125e-02]
 [-1.66437763e-02]
 [ 1.88274729e-02]
 [ 1.88739266e-02]
 [ 8.67139018e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.79168554]
curr_Stock_Price:  99.87801763095167
curr_Factors:  [99.87801763]
mat_Sqrt:  [[0.15]]
grads:  [0.11130441]
Stock Position:  0.11130440616444871
Bond Position:  [-11.90854898]


portfolio before change:  [-0.78048274]
curr_Stock_Price:  99.9920423817682
curr_Factors:  [99.99204238]
mat_Sqrt:  [[0.15]]
grads:  [0.27419128]
Stock Position:  0.2741912784513049
Bond Position:  [-28.19742868]


portfolio before change:  [-0.96080272]
curr_Stock_Price:  99.34725500567022
curr_Factors:  [99.34725501]
mat_Sqrt:  [[0.15]]
grads:  [-0.0624939]
Stock Position:  -0.06249390149229907
Bond Position:  [5.24779485]


portfolio before change:  [-0.89384522]
curr_Stock_Price:  98.2863278255283
curr_Factors:  [98.28632783]
mat_Sqrt:  [[0.15]]
grads:  [-0.05097429]
Stock Position:  -0.05097428854987178
Bond Position:  [4.11623041]


portfolio before change:  [-0.93014899]
curr_Stock_Price:  99.00861995854822
curr_Factors:  [99.00861996]
mat_Sqrt:  [[0.15]]
grads:  [-0.04308428]
Stock Position:  -0.04308428123848977
Bond Position:  [3.33556624]


portfolio before change:  [-0.91892897]
curr_Stock_Price:  98.75787769103795
curr_Factors:  [98.75787769]
mat_Sqrt:  [[0.15]]
grads:  [0.22379758]
Stock Position:  0.22379758073061604
Bond Position:  [-23.02070307]


portfolio before change:  [-0.80272647]
curr_Stock_Price:  99.28996685625236
curr_Factors:  [99.28996686]
mat_Sqrt:  [[0.15]]
grads:  [0.02361742]
Stock Position:  0.023617415866476907
Bond Position:  [-3.14769891]


portfolio before change:  [-0.79013763]
curr_Stock_Price:  99.83965989922461
curr_Factors:  [99.8396599]
mat_Sqrt:  [[0.15]]
grads:  [0.0088067]
Stock Position:  0.00880669681762303
Bond Position:  [-1.66939524]


portfolio before change:  [-0.79322838]
curr_Stock_Price:  99.51240087618015
curr_Factors:  [99.51240088]
mat_Sqrt:  [[0.15]]
grads:  [-0.18450138]
Stock Position:  -0.18450138248971
Bond Position:  [17.56694715]


portfolio before change:  [-0.84394145]
curr_Stock_Price:  99.7991687454675
curr_Factors:  [99.79916875]
mat_Sqrt:  [[0.15]]
grads:  [0.15600529]
Stock Position:  0.15600529410859018
Bond Position:  [-16.41314012]


portfolio before change:  [-0.78208671]
curr_Stock_Price:  100.2088119266791
curr_Factors:  [100.20881193]
mat_Sqrt:  [[0.15]]
grads:  [0.12782764]
Stock Position:  0.1278276374428616
Bond Position:  [-13.59154239]


portfolio before change:  [-0.68207688]
curr_Stock_Price:  101.0044840258108
curr_Factors:  [101.00448403]
mat_Sqrt:  [[0.15]]
grads:  [-0.09029599]
Stock Position:  -0.09029599296953454
Bond Position:  [8.4382233]


portfolio before change:  [-0.70856462]
curr_Stock_Price:  101.30950956916801
curr_Factors:  [101.30950957]
mat_Sqrt:  [[0.15]]
grads:  [0.16318745]
Stock Position:  0.16318744739266178
Bond Position:  [-17.24100488]


portfolio before change:  [-0.6344585]
curr_Stock_Price:  101.77683338911835
curr_Factors:  [101.77683339]
mat_Sqrt:  [[0.15]]
grads:  [0.14171696]
Stock Position:  0.14171696467693906
Bond Position:  [-15.0579624]


portfolio before change:  [-0.72553719]
curr_Stock_Price:  101.14743572887919
curr_Factors:  [101.14743573]
mat_Sqrt:  [[0.15]]
grads:  [-0.01290257]
Stock Position:  -0.012902567128530834
Bond Position:  [0.57952439]


portfolio before change:  [-0.7443145]
curr_Stock_Price:  102.60836705246045
curr_Factors:  [102.60836705]
mat_Sqrt:  [[0.15]]
grads:  [-0.02036395]
Stock Position:  -0.020363950896161467
Bond Position:  [1.34519724]


portfolio before change:  [-0.76748534]
curr_Stock_Price:  103.7544609522324
curr_Factors:  [103.75446095]
mat_Sqrt:  [[0.15]]
grads:  [-0.03266295]
Stock Position:  -0.032662951517365625
Bond Position:  [2.62144158]


portfolio before change:  [-0.78569706]
curr_Stock_Price:  104.32205855959519
curr_Factors:  [104.32205856]
mat_Sqrt:  [[0.15]]
grads:  [0.05287268]
Stock Position:  0.05287267937589766
Bond Position:  [-6.30148381]


portfolio before change:  [-0.73813118]
curr_Stock_Price:  105.23658777417864
curr_Factors:  [105.23658777]
mat_Sqrt:  [[0.15]]
grads:  [0.17515303]
Stock Position:  0.17515302791100443
Bond Position:  [-19.17063818]


portfolio before change:  [-0.68216056]
curr_Stock_Price:  105.56982268146902
curr_Factors:  [105.56982268]
mat_Sqrt:  [[0.15]]
grads:  [-0.04944511]
Stock Position:  -0.049445113122631196
Bond Position:  [4.53775127]


portfolio before change:  [-0.707276]
curr_Stock_Price:  106.08924103640577
curr_Factors:  [106.08924104]
mat_Sqrt:  [[0.15]]
grads:  [-0.00555862]
Stock Position:  -0.005558622369498565
Bond Position:  [-0.11756597]


portfolio before change:  [-0.7075149]
curr_Stock_Price:  106.1295744030161
curr_Factors:  [106.1295744]
mat_Sqrt:  [[0.15]]
grads:  [-0.1425804]
Stock Position:  -0.14258040476668202
Bond Position:  [14.42448278]


portfolio before change:  [-0.57619365]
curr_Stock_Price:  105.22118815608553
curr_Factors:  [105.22118816]
mat_Sqrt:  [[0.15]]
grads:  [0.04458865]
Stock Position:  0.044588647326168206
Bond Position:  [-5.2678641]


portfolio before change:  [-0.57142725]
curr_Stock_Price:  105.34285413674695
curr_Factors:  [105.34285414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04946511]
Stock Position:  -0.04946510914273461
Bond Position:  [4.63936853]


portfolio before change:  [-0.62100526]
curr_Stock_Price:  106.35686118680428
curr_Factors:  [106.35686119]
mat_Sqrt:  [[0.15]]
grads:  [-0.06878522]
Stock Position:  -0.06878521659462798
Bond Position:  [6.69477447]


portfolio before change:  [-0.62056517]
curr_Stock_Price:  106.3626300182353
curr_Factors:  [106.36263002]
mat_Sqrt:  [[0.15]]
grads:  [0.03227163]
Stock Position:  0.032271627909118465
Bond Position:  [-4.05306039]


portfolio before change:  [-0.64234254]
curr_Stock_Price:  105.70351531092534
curr_Factors:  [105.70351531]
mat_Sqrt:  [[0.15]]
grads:  [0.04522372]
Stock Position:  0.04522372363132555
Bond Position:  [-5.4226491]


portfolio before change:  [-0.64685335]
curr_Stock_Price:  105.61876036029808
curr_Factors:  [105.61876036]
mat_Sqrt:  [[0.15]]
grads:  [0.01773459]
Stock Position:  0.017734593525714267
Bond Position:  [-2.51995913]


portfolio before change:  [-0.6299354]
curr_Stock_Price:  106.59047510871933
curr_Factors:  [106.59047511]
mat_Sqrt:  [[0.15]]
grads:  [0.03646631]
Stock Position:  0.03646631183933189
Bond Position:  [-4.5168969]


portfolio before change:  [-0.63520768]
curr_Stock_Price:  106.46137966467784
curr_Factors:  [106.46137966]
mat_Sqrt:  [[0.15]]
grads:  [0.03036338]
Stock Position:  0.030363379626972775
Bond Position:  [-3.86773497]


portfolio before change:  [-0.58342276]
curr_Stock_Price:  108.18280927754486
curr_Factors:  [108.18280928]
mat_Sqrt:  [[0.15]]
grads:  [-0.11006403]
Stock Position:  -0.11006402629543581
Bond Position:  [11.32361281]


portfolio before change:  [-0.57946788]
curr_Stock_Price:  108.15973782549827
curr_Factors:  [108.15973783]
mat_Sqrt:  [[0.15]]
grads:  [0.02080297]
Stock Position:  0.0208029705603075
Bond Position:  [-2.82951172]


portfolio before change:  [-0.58011581]
curr_Stock_Price:  108.14559474008901
curr_Factors:  [108.14559474]
mat_Sqrt:  [[0.15]]
grads:  [0.08544292]
Stock Position:  0.0854429165495753
Bond Position:  [-9.82039083]


portfolio before change:  [-0.58098647]
curr_Stock_Price:  108.14977250526813
curr_Factors:  [108.14977251]
mat_Sqrt:  [[0.15]]
grads:  [0.5196306]
Stock Position:  0.5196306047534821
Bond Position:  [-56.77891816]


portfolio before change:  [-1.11097764]
curr_Stock_Price:  107.14349351616204
curr_Factors:  [107.14349352]
mat_Sqrt:  [[0.15]]
grads:  [-0.13341275]
Stock Position:  -0.13341274995109914
Bond Position:  [13.18333047]


portfolio before change:  [-1.02599611]
curr_Stock_Price:  106.51886424794048
curr_Factors:  [106.51886425]
mat_Sqrt:  [[0.15]]
grads:  [-0.11095851]
Stock Position:  -0.11095850866073154
Bond Position:  [10.79317821]


portfolio before change:  [-1.04603129]
curr_Stock_Price:  106.71158862173812
curr_Factors:  [106.71158862]
mat_Sqrt:  [[0.15]]
grads:  [0.12551649]
Stock Position:  0.12551648591046818
Bond Position:  [-14.4400949]


portfolio before change:  [-1.12895398]
curr_Stock_Price:  106.06531843708402
curr_Factors:  [106.06531844]
mat_Sqrt:  [[0.15]]
grads:  [0.12582618]
Stock Position:  0.1258261772330086
Bond Position:  [-14.47474753]


portfolio before change:  [-1.13242962]
curr_Stock_Price:  106.05207646618209
curr_Factors:  [106.05207647]
mat_Sqrt:  [[0.15]]
grads:  [0.05780927]
Stock Position:  0.05780926785446765
Bond Position:  [-7.26322252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.1054521]
Stock Price:  106.53444684011387
PL:  [-7.63989894]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.71598094e-02]
 [ 4.13931677e-02]
 [ 1.82925322e-02]
 [ 5.28012530e-03]
 [ 3.69794511e-03]
 [-4.42859133e-02]
 [ 3.39051823e-03]
 [ 3.80619428e-02]
 [ 8.20835177e-02]
 [ 2.24471329e-02]
 [ 1.52803017e-02]
 [-2.31228907e-03]
 [ 8.64568646e-04]
 [ 2.33567901e-02]
 [-1.07141678e-02]
 [-3.78736975e-03]
 [-4.45877494e-03]
 [ 7.94404409e-03]
 [ 1.76121257e-02]
 [ 1.74169369e-02]
 [-1.70921505e-03]
 [-5.09335493e-03]
 [ 4.04511718e-03]
 [-1.22836752e-02]
 [ 3.10693533e-03]
 [ 3.23438584e-03]
 [-2.95392098e-03]
 [-1.35196786e-03]
 [ 1.26117526e-03]
 [-6.63964754e-03]
 [-2.31715126e-02]
 [ 1.74866690e-02]
 [-3.37913599e-03]
 [-2.15423382e-02]
 [-2.03699720e-02]
 [ 1.88189159e-02]
 [ 3.80933513e-03]
 [ 2.28409493e-02]
 [ 1.04857999e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.47319644]
curr_Stock_Price:  100.75545693695436
curr_Factors:  [100.75545694]
mat_Sqrt:  [[0.15]]
grads:  [-0.24773206]
Stock Position:  -0.24773206267020603
Bond Position:  [43.43355362]


portfolio before change:  [18.5121771]
curr_Stock_Price:  100.62002385118825
curr_Factors:  [100.62002385]
mat_Sqrt:  [[0.15]]
grads:  [0.27595445]
Stock Position:  0.2759544511559592
Bond Position:  [-9.25436636]


portfolio before change:  [19.13356297]
curr_Stock_Price:  102.87598581568058
curr_Factors:  [102.87598582]
mat_Sqrt:  [[0.15]]
grads:  [0.12195021]
Stock Position:  0.12195021441657064
Bond Position:  [6.58781444]


portfolio before change:  [19.12942653]
curr_Stock_Price:  102.83531375029965
curr_Factors:  [102.83531375]
mat_Sqrt:  [[0.15]]
grads:  [0.03520084]
Stock Position:  0.03520083534692862
Bond Position:  [15.50953759]


portfolio before change:  [19.16479149]
curr_Stock_Price:  103.78489764606135
curr_Factors:  [103.78489765]
mat_Sqrt:  [[0.15]]
grads:  [0.02465297]
Stock Position:  0.02465296737980297
Bond Position:  [16.6061858]


portfolio before change:  [19.19025306]
curr_Stock_Price:  104.73349187889426
curr_Factors:  [104.73349188]
mat_Sqrt:  [[0.15]]
grads:  [-0.29523942]
Stock Position:  -0.2952394221423175
Bond Position:  [50.11170868]


portfolio before change:  [19.38867148]
curr_Stock_Price:  104.08265039853265
curr_Factors:  [104.0826504]
mat_Sqrt:  [[0.15]]
grads:  [0.02260345]
Stock Position:  0.022603454882529312
Bond Position:  [17.03604399]


portfolio before change:  [19.39609575]
curr_Stock_Price:  104.31689021218722
curr_Factors:  [104.31689021]
mat_Sqrt:  [[0.15]]
grads:  [0.25374629]
Stock Position:  0.2537462854205401
Bond Position:  [-7.07392765]


portfolio before change:  [19.47524287]
curr_Stock_Price:  104.63228959382603
curr_Factors:  [104.63228959]
mat_Sqrt:  [[0.15]]
grads:  [0.54722345]
Stock Position:  0.5472234510366858
Bond Position:  [-37.78199973]


portfolio before change:  [19.66743917]
curr_Stock_Price:  104.99214139195051
curr_Factors:  [104.99214139]
mat_Sqrt:  [[0.15]]
grads:  [0.14964755]
Stock Position:  0.1496475527354987
Bond Position:  [3.95562215]


portfolio before change:  [19.59144051]
curr_Stock_Price:  104.48098604991529
curr_Factors:  [104.48098605]
mat_Sqrt:  [[0.15]]
grads:  [0.10186868]
Stock Position:  0.10186867811723288
Bond Position:  [8.94810057]


portfolio before change:  [19.45118103]
curr_Stock_Price:  103.09313982845964
curr_Factors:  [103.09313983]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541526]
Stock Position:  -0.015415260447350412
Bond Position:  [21.04038863]


portfolio before change:  [19.44445193]
curr_Stock_Price:  103.70028550437189
curr_Factors:  [103.7002855]
mat_Sqrt:  [[0.15]]
grads:  [0.00576379]
Stock Position:  0.005763790975936717
Bond Position:  [18.84674516]


portfolio before change:  [19.44583564]
curr_Stock_Price:  103.5315981459813
curr_Factors:  [103.53159815]
mat_Sqrt:  [[0.15]]
grads:  [0.15571193]
Stock Position:  0.15571193368451366
Bond Position:  [3.3247303]


portfolio before change:  [19.40286438]
curr_Stock_Price:  103.2529625572266
curr_Factors:  [103.25296256]
mat_Sqrt:  [[0.15]]
grads:  [-0.07142779]
Stock Position:  -0.07142778519277303
Bond Position:  [26.77799481]


portfolio before change:  [19.34348425]
curr_Stock_Price:  104.13115840145048
curr_Factors:  [104.1311584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02524913]
Stock Position:  -0.02524913165243014
Bond Position:  [21.97270558]


portfolio before change:  [19.33105853]
curr_Stock_Price:  104.73206937901418
curr_Factors:  [104.73206938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02972517]
Stock Position:  -0.02972516627765831
Bond Position:  [22.44423671]


portfolio before change:  [19.35393764]
curr_Stock_Price:  104.05676920357638
curr_Factors:  [104.0567692]
mat_Sqrt:  [[0.15]]
grads:  [0.05296029]
Stock Position:  0.05296029391972866
Bond Position:  [13.84306056]


portfolio before change:  [19.30713389]
curr_Stock_Price:  103.14034211068152
curr_Factors:  [103.14034211]
mat_Sqrt:  [[0.15]]
grads:  [0.11741417]
Stock Position:  0.11741417120594048
Bond Position:  [7.1969961]


portfolio before change:  [19.2376462]
curr_Stock_Price:  102.54086279102545
curr_Factors:  [102.54086279]
mat_Sqrt:  [[0.15]]
grads:  [0.11611291]
Stock Position:  0.11611291292384757
Bond Position:  [7.33132793]


portfolio before change:  [19.20094716]
curr_Stock_Price:  102.2169064772305
curr_Factors:  [102.21690648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01139477]
Stock Position:  -0.011394766993476996
Bond Position:  [20.36568499]


portfolio before change:  [19.20378435]
curr_Stock_Price:  102.19134075599113
curr_Factors:  [102.19134076]
mat_Sqrt:  [[0.15]]
grads:  [-0.0339557]
Stock Position:  -0.033955699523311254
Bond Position:  [22.67376281]


portfolio before change:  [19.20221369]
curr_Stock_Price:  102.32107035908943
curr_Factors:  [102.32107036]
mat_Sqrt:  [[0.15]]
grads:  [0.02696745]
Stock Position:  0.02696744784391159
Bond Position:  [16.44287556]


portfolio before change:  [19.19869573]
curr_Stock_Price:  102.1143972942402
curr_Factors:  [102.11439729]
mat_Sqrt:  [[0.15]]
grads:  [-0.08189117]
Stock Position:  -0.08189116824228135
Bond Position:  [27.56096302]


portfolio before change:  [19.21953853]
curr_Stock_Price:  101.9019511237793
curr_Factors:  [101.90195112]
mat_Sqrt:  [[0.15]]
grads:  [0.0207129]
Stock Position:  0.02071290217209117
Bond Position:  [17.10885338]


portfolio before change:  [19.22124831]
curr_Stock_Price:  101.88124154568942
curr_Factors:  [101.88124155]
mat_Sqrt:  [[0.15]]
grads:  [0.02156257]
Stock Position:  0.02156257223944402
Bond Position:  [17.02442668]


portfolio before change:  [19.20438241]
curr_Stock_Price:  101.00035911687476
curr_Factors:  [101.00035912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01969281]
Stock Position:  -0.01969280656096749
Bond Position:  [21.19336294]


portfolio before change:  [19.21166302]
curr_Stock_Price:  100.76518288764825
curr_Factors:  [100.76518289]
mat_Sqrt:  [[0.15]]
grads:  [-0.00901312]
Stock Position:  -0.009013119086784458
Bond Position:  [20.11987162]


portfolio before change:  [19.21010147]
curr_Stock_Price:  101.2174896633936
curr_Factors:  [101.21748966]
mat_Sqrt:  [[0.15]]
grads:  [0.00840784]
Stock Position:  0.00840783503783428
Bond Position:  [18.35908152]


portfolio before change:  [19.21200389]
curr_Stock_Price:  101.17079402586936
curr_Factors:  [101.17079403]
mat_Sqrt:  [[0.15]]
grads:  [-0.04426432]
Stock Position:  -0.04426431691465152
Bond Position:  [23.69025998]


portfolio before change:  [19.19687865]
curr_Stock_Price:  101.57940097748033
curr_Factors:  [101.57940098]
mat_Sqrt:  [[0.15]]
grads:  [-0.15447675]
Stock Position:  -0.15447675074698064
Bond Position:  [34.88853446]


portfolio before change:  [19.22939304]
curr_Stock_Price:  101.39715318820429
curr_Factors:  [101.39715319]
mat_Sqrt:  [[0.15]]
grads:  [0.11657779]
Stock Position:  0.11657779362270158
Bond Position:  [7.40873664]


portfolio before change:  [19.3061177]
curr_Stock_Price:  102.04735000382631
curr_Factors:  [102.04735]
mat_Sqrt:  [[0.15]]
grads:  [-0.02252757]
Stock Position:  -0.022527573267104743
Bond Position:  [21.60499685]


portfolio before change:  [19.29586297]
curr_Stock_Price:  102.62244625884966
curr_Factors:  [102.62244626]
mat_Sqrt:  [[0.15]]
grads:  [-0.14361559]
Stock Position:  -0.14361558803964017
Bond Position:  [34.03404593]


portfolio before change:  [19.29530773]
curr_Stock_Price:  102.65593676513926
curr_Factors:  [102.65593677]
mat_Sqrt:  [[0.15]]
grads:  [-0.13579981]
Stock Position:  -0.13579981331790564
Bond Position:  [33.23596478]


portfolio before change:  [19.24505047]
curr_Stock_Price:  103.05661490361949
curr_Factors:  [103.0566149]
mat_Sqrt:  [[0.15]]
grads:  [0.12545944]
Stock Position:  0.12545943937973797
Bond Position:  [6.31562534]


portfolio before change:  [19.13680015]
curr_Stock_Price:  102.1874908326898
curr_Factors:  [102.18749083]
mat_Sqrt:  [[0.15]]
grads:  [0.02539557]
Stock Position:  0.025395567534745735
Bond Position:  [16.54169083]


portfolio before change:  [19.17796383]
curr_Stock_Price:  103.72696584919846
curr_Factors:  [103.72696585]
mat_Sqrt:  [[0.15]]
grads:  [0.152273]
Stock Position:  0.15227299530720229
Bond Position:  [3.38314805]


portfolio before change:  [19.13206397]
curr_Stock_Price:  103.42275704006461
curr_Factors:  [103.42275704]
mat_Sqrt:  [[0.15]]
grads:  [0.06990533]
Stock Position:  0.06990533248396995
Bond Position:  [11.90226175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.14002655]
Stock Price:  103.51537809706896
PL:  [15.62464845]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.71173340e-03]
 [ 4.10008582e-02]
 [ 3.20152786e-03]
 [-2.20490381e-03]
 [-7.56135181e-03]
 [ 2.82887104e-02]
 [ 3.54750803e-03]
 [ 1.22543745e-03]
 [ 1.59213404e-02]
 [ 2.34466522e-02]
 [ 2.12037082e-02]
 [-9.26978369e-03]
 [-5.58923766e-03]
 [ 1.36856167e-02]
 [-1.39469218e-02]
 [-4.58214723e-04]
 [-6.04794312e-03]
 [ 4.35712468e-03]
 [ 5.98761770e-03]
 [-1.43377853e-02]
 [-3.20153155e-03]
 [-1.06623821e-02]
 [ 7.12559408e-03]
 [-6.43557016e-03]
 [ 1.38902143e-02]
 [ 5.55116649e-03]
 [ 6.66562429e-03]
 [-2.38994741e-03]
 [-7.22521249e-03]
 [-1.37652724e-02]
 [ 3.86233889e-02]
 [ 4.41510134e-03]
 [-1.52661639e-02]
 [-4.96251596e-02]
 [-2.27141577e-02]
 [ 3.90400037e-02]
 [-2.86416941e-03]
 [ 1.09401845e-03]
 [ 2.06067106e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.20291474]
curr_Stock_Price:  99.6315575071597
curr_Factors:  [99.63155751]
mat_Sqrt:  [[0.15]]
grads:  [-0.03807822]
Stock Position:  -0.03807822264815664
Bond Position:  [-2.40912212]


portfolio before change:  [-6.24131723]
curr_Stock_Price:  100.63216433690054
curr_Factors:  [100.63216434]
mat_Sqrt:  [[0.15]]
grads:  [0.27333905]
Stock Position:  0.2733390546437536
Bond Position:  [-33.7480179]


portfolio before change:  [-5.95957712]
curr_Stock_Price:  101.67833346320715
curr_Factors:  [101.67833346]
mat_Sqrt:  [[0.15]]
grads:  [0.02134352]
Stock Position:  0.021343519095829874
Bond Position:  [-8.12975057]


portfolio before change:  [-5.98298797]
curr_Stock_Price:  100.62908892089797
curr_Factors:  [100.62908892]
mat_Sqrt:  [[0.15]]
grads:  [-0.01469936]
Stock Position:  -0.01469935871595741
Bond Position:  [-4.5038049]


portfolio before change:  [-5.96725288]
curr_Stock_Price:  99.5203258351206
curr_Factors:  [99.52032584]
mat_Sqrt:  [[0.15]]
grads:  [-0.05040901]
Stock Position:  -0.05040901208229868
Bond Position:  [-0.95053157]


portfolio before change:  [-5.95706384]
curr_Stock_Price:  99.31584128667477
curr_Factors:  [99.31584129]
mat_Sqrt:  [[0.15]]
grads:  [0.1885914]
Stock Position:  0.18859140298910115
Bond Position:  [-24.68717768]


portfolio before change:  [-6.01555227]
curr_Stock_Price:  99.02207207999766
curr_Factors:  [99.02207208]
mat_Sqrt:  [[0.15]]
grads:  [0.02365005]
Stock Position:  0.023650053546479373
Bond Position:  [-8.35742958]


portfolio before change:  [-6.05478779]
curr_Stock_Price:  97.40724384217042
curr_Factors:  [97.40724384]
mat_Sqrt:  [[0.15]]
grads:  [0.00816958]
Stock Position:  0.008169583033199104
Bond Position:  [-6.85056436]


portfolio before change:  [-6.05716846]
curr_Stock_Price:  97.22066229013691
curr_Factors:  [97.22066229]
mat_Sqrt:  [[0.15]]
grads:  [0.10614227]
Stock Position:  0.106142269302232
Bond Position:  [-16.37639018]


portfolio before change:  [-6.11186678]
curr_Stock_Price:  96.72461916763554
curr_Factors:  [96.72461917]
mat_Sqrt:  [[0.15]]
grads:  [0.15631101]
Stock Position:  0.156311014820321
Bond Position:  [-21.23099016]


portfolio before change:  [-5.95685936]
curr_Stock_Price:  97.73325860757475
curr_Factors:  [97.73325861]
mat_Sqrt:  [[0.15]]
grads:  [0.14135805]
Stock Position:  0.141358054952524
Bond Position:  [-19.77224271]


portfolio before change:  [-5.97413435]
curr_Stock_Price:  97.6285365846029
curr_Factors:  [97.62853658]
mat_Sqrt:  [[0.15]]
grads:  [-0.06179856]
Stock Position:  -0.06179855794942901
Bond Position:  [0.05916843]


portfolio before change:  [-5.98285595]
curr_Stock_Price:  97.76978571994758
curr_Factors:  [97.76978572]
mat_Sqrt:  [[0.15]]
grads:  [-0.03726158]
Stock Position:  -0.037261584378596585
Bond Position:  [-2.33979883]


portfolio before change:  [-5.96359528]
curr_Stock_Price:  97.245031976832
curr_Factors:  [97.24503198]
mat_Sqrt:  [[0.15]]
grads:  [0.09123744]
Stock Position:  0.09123744461743476
Bond Position:  [-14.8359835]


portfolio before change:  [-5.85767945]
curr_Stock_Price:  98.42624054361642
curr_Factors:  [98.42624054]
mat_Sqrt:  [[0.15]]
grads:  [-0.09297948]
Stock Position:  -0.09297947860573488
Bond Position:  [3.29394108]


portfolio before change:  [-5.8995484]
curr_Stock_Price:  98.88097235236721
curr_Factors:  [98.88097235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305476]
Stock Position:  -0.0030547648194149497
Bond Position:  [-5.59749029]


portfolio before change:  [-5.90032456]
curr_Stock_Price:  98.90599213928907
curr_Factors:  [98.90599214]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031962]
Stock Position:  -0.040319620786489
Bond Position:  [-1.91247247]


portfolio before change:  [-5.91469675]
curr_Stock_Price:  99.25651903208217
curr_Factors:  [99.25651903]
mat_Sqrt:  [[0.15]]
grads:  [0.0290475]
Stock Position:  0.029047497837977842
Bond Position:  [-8.79785027]


portfolio before change:  [-5.91006426]
curr_Stock_Price:  99.4538608861505
curr_Factors:  [99.45386089]
mat_Sqrt:  [[0.15]]
grads:  [0.03991745]
Stock Position:  0.039917451337073584
Bond Position:  [-9.88000892]


portfolio before change:  [-5.90188898]
curr_Stock_Price:  99.68960631082362
curr_Factors:  [99.68960631]
mat_Sqrt:  [[0.15]]
grads:  [-0.09558524]
Stock Position:  -0.09558523500063956
Bond Position:  [3.62696546]


portfolio before change:  [-5.77592398]
curr_Stock_Price:  98.3765206196164
curr_Factors:  [98.37652062]
mat_Sqrt:  [[0.15]]
grads:  [-0.02134354]
Stock Position:  -0.021343543644959866
Bond Position:  [-3.67622042]


portfolio before change:  [-5.78434917]
curr_Stock_Price:  98.74973117360251
curr_Factors:  [98.74973117]
mat_Sqrt:  [[0.15]]
grads:  [-0.07108255]
Stock Position:  -0.07108254745489782
Bond Position:  [1.23503328]


portfolio before change:  [-5.82995527]
curr_Stock_Price:  99.39349653934947
curr_Factors:  [99.39349654]
mat_Sqrt:  [[0.15]]
grads:  [0.04750396]
Stock Position:  0.04750396051756873
Bond Position:  [-10.55154]


portfolio before change:  [-5.86048607]
curr_Stock_Price:  98.77856297075137
curr_Factors:  [98.77856297]
mat_Sqrt:  [[0.15]]
grads:  [-0.0429038]
Stock Position:  -0.0429038010880324
Bond Position:  [-1.62251025]


portfolio before change:  [-5.82786449]
curr_Stock_Price:  98.01349294205612
curr_Factors:  [98.01349294]
mat_Sqrt:  [[0.15]]
grads:  [0.09260143]
Stock Position:  0.09260142836857807
Bond Position:  [-14.90405393]


portfolio before change:  [-5.84203409]
curr_Stock_Price:  97.88059557848031
curr_Factors:  [97.88059558]
mat_Sqrt:  [[0.15]]
grads:  [0.03700778]
Stock Position:  0.03700777662334839
Bond Position:  [-9.46437731]


portfolio before change:  [-5.84843185]
curr_Stock_Price:  97.73968905519266
curr_Factors:  [97.73968906]
mat_Sqrt:  [[0.15]]
grads:  [0.0444375]
Stock Position:  0.04443749524734083
Bond Position:  [-10.19173882]


portfolio before change:  [-5.78307333]
curr_Stock_Price:  99.23915628815018
curr_Factors:  [99.23915629]
mat_Sqrt:  [[0.15]]
grads:  [-0.01593298]
Stock Position:  -0.01593298273475684
Bond Position:  [-4.20189757]


portfolio before change:  [-5.77296683]
curr_Stock_Price:  98.57187563911474
curr_Factors:  [98.57187564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04816808]
Stock Position:  -0.04816808329848037
Bond Position:  [-1.02494851]


portfolio before change:  [-5.72178686]
curr_Stock_Price:  97.50668696348217
curr_Factors:  [97.50668696]
mat_Sqrt:  [[0.15]]
grads:  [-0.09176848]
Stock Position:  -0.09176848260992967
Bond Position:  [3.22625385]


portfolio before change:  [-5.63607154]
curr_Stock_Price:  96.5770430605874
curr_Factors:  [96.57704306]
mat_Sqrt:  [[0.15]]
grads:  [0.25748926]
Stock Position:  0.2574892592896615
Bond Position:  [-30.50362283]


portfolio before change:  [-5.69027844]
curr_Stock_Price:  96.38133117962667
curr_Factors:  [96.38133118]
mat_Sqrt:  [[0.15]]
grads:  [0.02943401]
Stock Position:  0.029434008955511588
Bond Position:  [-8.52716741]


portfolio before change:  [-5.68452514]
curr_Stock_Price:  96.61301085185062
curr_Factors:  [96.61301085]
mat_Sqrt:  [[0.15]]
grads:  [-0.10177443]
Stock Position:  -0.10177442616434282
Bond Position:  [4.1482086]


portfolio before change:  [-5.7713337]
curr_Stock_Price:  97.47105660344721
curr_Factors:  [97.4710566]
mat_Sqrt:  [[0.15]]
grads:  [-0.3308344]
Stock Position:  -0.33083439731243747
Bond Position:  [26.47544457]


portfolio before change:  [-5.67996021]
curr_Stock_Price:  97.20486950775032
curr_Factors:  [97.20486951]
mat_Sqrt:  [[0.15]]
grads:  [-0.15142772]
Stock Position:  -0.15142771823893755
Bond Position:  [9.03955138]


portfolio before change:  [-5.580147]
curr_Stock_Price:  96.55318433221139
curr_Factors:  [96.55318433]
mat_Sqrt:  [[0.15]]
grads:  [0.26026669]
Stock Position:  0.260266691485143
Bond Position:  [-30.70972484]


portfolio before change:  [-5.72700915]
curr_Stock_Price:  96.00365878318614
curr_Factors:  [96.00365878]
mat_Sqrt:  [[0.15]]
grads:  [-0.01909446]
Stock Position:  -0.0190944627463315
Bond Position:  [-3.89387087]


portfolio before change:  [-5.7305955]
curr_Stock_Price:  96.16598770343099
curr_Factors:  [96.1659877]
mat_Sqrt:  [[0.15]]
grads:  [0.00729346]
Stock Position:  0.0072934563483783325
Bond Position:  [-6.43197793]


portfolio before change:  [-5.73668704]
curr_Stock_Price:  95.4410233902826
curr_Factors:  [95.44102339]
mat_Sqrt:  [[0.15]]
grads:  [0.13737807]
Stock Position:  0.137378070725086
Bond Position:  [-18.8481907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.77485971]
Stock Price:  95.18030858156777
PL:  [-5.77485971]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.26980992e-02]
 [ 3.25369600e-02]
 [-1.57825978e-02]
 [-7.78730777e-03]
 [-6.31920667e-03]
 [ 4.34644968e-02]
 [ 3.58660413e-03]
 [-1.68854940e-03]
 [-1.74683954e-02]
 [ 2.34429234e-02]
 [ 2.09968749e-02]
 [-1.10537574e-02]
 [-3.16342304e-03]
 [ 8.25141482e-03]
 [-1.83074343e-02]
 [ 4.66885537e-04]
 [-6.08223976e-03]
 [ 1.95792860e-03]
 [ 2.80355725e-03]
 [-1.89217419e-02]
 [-7.89897830e-03]
 [-2.09501619e-02]
 [ 4.79661271e-03]
 [-1.14759318e-02]
 [ 1.12150302e-02]
 [-5.75987295e-04]
 [ 2.34417137e-02]
 [-4.89328652e-03]
 [-4.20244602e-02]
 [-7.36691089e-03]
 [ 5.78924810e-02]
 [-7.59914475e-03]
 [-2.31952989e-02]
 [ 2.47177107e-03]
 [-2.52254033e-02]
 [ 2.77391035e-02]
 [-1.65628009e-02]
 [-1.32607256e-02]
 [ 4.13285013e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.32509739]
curr_Stock_Price:  100.93089581570649
curr_Factors:  [100.93089582]
mat_Sqrt:  [[0.15]]
grads:  [-0.28465399]
Stock Position:  -0.2846539947709415
Bond Position:  [51.05548008]


portfolio before change:  [22.73522985]
curr_Stock_Price:  99.51250672062656
curr_Factors:  [99.51250672]
mat_Sqrt:  [[0.15]]
grads:  [0.21691307]
Stock Position:  0.2169130669963376
Bond Position:  [1.14966681]


portfolio before change:  [22.48759111]
curr_Stock_Price:  98.37019445669605
curr_Factors:  [98.37019446]
mat_Sqrt:  [[0.15]]
grads:  [-0.10521732]
Stock Position:  -0.1052173186748409
Bond Position:  [32.83783921]


portfolio before change:  [22.52027683]
curr_Stock_Price:  98.09855922764685
curr_Factors:  [98.09855923]
mat_Sqrt:  [[0.15]]
grads:  [-0.05191539]
Stock Position:  -0.05191538514162654
Bond Position:  [27.61310131]


portfolio before change:  [22.48590965]
curr_Stock_Price:  98.82703364986153
curr_Factors:  [98.82703365]
mat_Sqrt:  [[0.15]]
grads:  [-0.04212804]
Stock Position:  -0.042128044494397575
Bond Position:  [26.64929932]


portfolio before change:  [22.52658596]
curr_Stock_Price:  97.9405708394553
curr_Factors:  [97.94057084]
mat_Sqrt:  [[0.15]]
grads:  [0.28976331]
Stock Position:  0.2897633120388637
Bond Position:  [-5.85299822]


portfolio before change:  [22.49192617]
curr_Stock_Price:  97.8234817423331
curr_Factors:  [97.82348174]
mat_Sqrt:  [[0.15]]
grads:  [0.02391069]
Stock Position:  0.023910694227783892
Bond Position:  [20.15289881]


portfolio before change:  [22.50061765]
curr_Stock_Price:  98.08161775280317
curr_Factors:  [98.08161775]
mat_Sqrt:  [[0.15]]
grads:  [-0.011257]
Stock Position:  -0.011256996003559774
Bond Position:  [23.60472203]


portfolio before change:  [22.50136659]
curr_Stock_Price:  98.27721488858514
curr_Factors:  [98.27721489]
mat_Sqrt:  [[0.15]]
grads:  [-0.11645597]
Stock Position:  -0.11645596902934754
Bond Position:  [33.94633488]


portfolio before change:  [22.54847683]
curr_Stock_Price:  97.90912141319752
curr_Factors:  [97.90912141]
mat_Sqrt:  [[0.15]]
grads:  [0.15628616]
Stock Position:  0.15628615584154523
Bond Position:  [7.24663662]


portfolio before change:  [22.59763946]
curr_Stock_Price:  98.2178931359385
curr_Factors:  [98.21789314]
mat_Sqrt:  [[0.15]]
grads:  [0.13997917]
Stock Position:  0.13997916617034778
Bond Position:  [8.84918068]


portfolio before change:  [22.58415227]
curr_Stock_Price:  98.11363897955843
curr_Factors:  [98.11363898]
mat_Sqrt:  [[0.15]]
grads:  [-0.07369172]
Stock Position:  -0.07369171573570865
Bond Position:  [29.81431466]


portfolio before change:  [22.59695309]
curr_Stock_Price:  97.9905071481871
curr_Factors:  [97.99050715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02108949]
Stock Position:  -0.021089486945342996
Bond Position:  [24.66352261]


portfolio before change:  [22.60031648]
curr_Stock_Price:  97.97721780534475
curr_Factors:  [97.97721781]
mat_Sqrt:  [[0.15]]
grads:  [0.05500943]
Stock Position:  0.05500943215844933
Bond Position:  [17.21064537]


portfolio before change:  [22.54277987]
curr_Stock_Price:  96.89216608549089
curr_Factors:  [96.89216609]
mat_Sqrt:  [[0.15]]
grads:  [-0.12204956]
Stock Position:  -0.12204956198879678
Bond Position:  [34.3684263]


portfolio before change:  [22.49723541]
curr_Stock_Price:  97.30053121903624
curr_Factors:  [97.30053122]
mat_Sqrt:  [[0.15]]
grads:  [0.00311257]
Stock Position:  0.0031125702496879815
Bond Position:  [22.19438067]


portfolio before change:  [22.50077982]
curr_Stock_Price:  97.54789753202753
curr_Factors:  [97.54789753]
mat_Sqrt:  [[0.15]]
grads:  [-0.04054827]
Stock Position:  -0.04054826506912568
Bond Position:  [26.45617783]


portfolio before change:  [22.4964235]
curr_Stock_Price:  97.73689570220621
curr_Factors:  [97.7368957]
mat_Sqrt:  [[0.15]]
grads:  [0.01305286]
Stock Position:  0.013052857344880483
Bond Position:  [21.22067775]


portfolio before change:  [22.4982699]
curr_Stock_Price:  97.67511988709141
curr_Factors:  [97.67511989]
mat_Sqrt:  [[0.15]]
grads:  [0.01869038]
Stock Position:  0.01869038164467186
Bond Position:  [20.67268463]


portfolio before change:  [22.48905896]
curr_Stock_Price:  97.04403636497001
curr_Factors:  [97.04403636]
mat_Sqrt:  [[0.15]]
grads:  [-0.12614495]
Stock Position:  -0.12614494586548708
Bond Position:  [34.73067367]


portfolio before change:  [22.49437251]
curr_Stock_Price:  97.03633132783429
curr_Factors:  [97.03633133]
mat_Sqrt:  [[0.15]]
grads:  [-0.05265986]
Stock Position:  -0.05265985536075313
Bond Position:  [27.60429169]


portfolio before change:  [22.55135342]
curr_Stock_Price:  96.01980455483897
curr_Factors:  [96.01980455]
mat_Sqrt:  [[0.15]]
grads:  [-0.13966775]
Stock Position:  -0.1396677462056494
Bond Position:  [35.96222311]


portfolio before change:  [22.60924147]
curr_Stock_Price:  95.63752239423107
curr_Factors:  [95.63752239]
mat_Sqrt:  [[0.15]]
grads:  [0.03197742]
Stock Position:  0.031977418099202466
Bond Position:  [19.55100043]


portfolio before change:  [22.59136769]
curr_Stock_Price:  95.00214253563713
curr_Factors:  [95.00214254]
mat_Sqrt:  [[0.15]]
grads:  [-0.07650621]
Stock Position:  -0.07650621193158469
Bond Position:  [29.85962174]


portfolio before change:  [22.56844625]
curr_Stock_Price:  95.35053415157195
curr_Factors:  [95.35053415]
mat_Sqrt:  [[0.15]]
grads:  [0.07476687]
Stock Position:  0.07476686805714892
Bond Position:  [15.43938544]


portfolio before change:  [22.54948987]
curr_Stock_Price:  95.07118018931703
curr_Factors:  [95.07118019]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383992]
Stock Position:  -0.00383991530172815
Bond Position:  [22.91455515]


portfolio before change:  [22.55040651]
curr_Stock_Price:  95.57844748496666
curr_Factors:  [95.57844748]
mat_Sqrt:  [[0.15]]
grads:  [0.15627809]
Stock Position:  0.15627809166291887
Bond Position:  [7.61358913]


portfolio before change:  [22.4020135]
curr_Stock_Price:  94.62281277717636
curr_Factors:  [94.62281278]
mat_Sqrt:  [[0.15]]
grads:  [-0.03262191]
Stock Position:  -0.03262191011431362
Bond Position:  [25.48879039]


portfolio before change:  [22.41283958]
curr_Stock_Price:  94.38862081127165
curr_Factors:  [94.38862081]
mat_Sqrt:  [[0.15]]
grads:  [-0.28016307]
Stock Position:  -0.28016306802533414
Bond Position:  [48.85704518]


portfolio before change:  [22.84131038]
curr_Stock_Price:  92.88105850718891
curr_Factors:  [92.88105851]
mat_Sqrt:  [[0.15]]
grads:  [-0.04911274]
Stock Position:  -0.049112739250651224
Bond Position:  [27.40295359]


portfolio before change:  [22.86148004]
curr_Stock_Price:  92.54012703145473
curr_Factors:  [92.54012703]
mat_Sqrt:  [[0.15]]
grads:  [0.38594987]
Stock Position:  0.38594987320079754
Bond Position:  [-12.85437025]


portfolio before change:  [22.61227119]
curr_Stock_Price:  91.89858787487165
curr_Factors:  [91.89858787]
mat_Sqrt:  [[0.15]]
grads:  [-0.05066096]
Stock Position:  -0.05066096496728532
Bond Position:  [27.26794233]


portfolio before change:  [22.61679851]
curr_Stock_Price:  91.8765074993887
curr_Factors:  [91.8765075]
mat_Sqrt:  [[0.15]]
grads:  [-0.15463533]
Stock Position:  -0.15463532621614068
Bond Position:  [36.82415221]


portfolio before change:  [22.84007923]
curr_Stock_Price:  90.46235832493954
curr_Factors:  [90.46235832]
mat_Sqrt:  [[0.15]]
grads:  [0.01647847]
Stock Position:  0.016478473832818218
Bond Position:  [21.34939763]


portfolio before change:  [22.83307598]
curr_Stock_Price:  89.87540491492017
curr_Factors:  [89.87540491]
mat_Sqrt:  [[0.15]]
grads:  [-0.16816936]
Stock Position:  -0.1681693550567969
Bond Position:  [37.94736486]


portfolio before change:  [22.66175697]
curr_Stock_Price:  90.92234191083178
curr_Factors:  [90.92234191]
mat_Sqrt:  [[0.15]]
grads:  [0.18492736]
Stock Position:  0.18492735650750433
Bond Position:  [5.84772864]


portfolio before change:  [22.61489384]
curr_Stock_Price:  90.66497522287648
curr_Factors:  [90.66497522]
mat_Sqrt:  [[0.15]]
grads:  [-0.11041867]
Stock Position:  -0.11041867288769397
Bond Position:  [32.62600009]


portfolio before change:  [22.51210232]
curr_Stock_Price:  91.63283716518589
curr_Factors:  [91.63283717]
mat_Sqrt:  [[0.15]]
grads:  [-0.08840484]
Stock Position:  -0.08840483746981721
Bond Position:  [30.61288839]


portfolio before change:  [22.43099998]
curr_Stock_Price:  92.59352202524629
curr_Factors:  [92.59352203]
mat_Sqrt:  [[0.15]]
grads:  [0.27552334]
Stock Position:  0.2755233421275215
Bond Position:  [-3.08067667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.49578265]
Stock Price:  92.8300456378938
PL:  [22.49578265]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.13137156e-02]
 [ 4.35536381e-02]
 [-1.77666023e-02]
 [-6.52426259e-03]
 [-3.92556675e-03]
 [ 3.31279304e-02]
 [ 3.73019786e-03]
 [ 4.52721463e-03]
 [-2.73795143e-02]
 [ 2.31417063e-02]
 [ 1.99242924e-02]
 [-1.41123680e-02]
 [ 3.09898117e-02]
 [ 1.30493399e-02]
 [-7.31071450e-03]
 [-2.95910617e-03]
 [-4.96804869e-03]
 [ 7.92325479e-03]
 [ 1.70688863e-02]
 [ 1.40098462e-02]
 [ 8.94420133e-04]
 [-4.85164260e-03]
 [ 4.12349789e-03]
 [-1.19043918e-02]
 [ 2.59151572e-04]
 [ 4.00788712e-03]
 [-2.61527252e-03]
 [-1.68932372e-03]
 [ 5.96858370e-04]
 [-6.65794801e-03]
 [-1.96185585e-02]
 [ 1.10045436e-02]
 [-1.94445335e-03]
 [-1.49576216e-02]
 [-2.03297115e-02]
 [ 1.05124416e-02]
 [ 4.13635058e-03]
 [ 1.98123911e-02]
 [ 9.72851401e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.03743235]
curr_Stock_Price:  99.54800247375648
curr_Factors:  [99.54800247]
mat_Sqrt:  [[0.15]]
grads:  [-0.07542477]
Stock Position:  -0.07542477042513478
Bond Position:  [-0.52904712]


portfolio before change:  [-8.11270105]
curr_Stock_Price:  100.54505638332968
curr_Factors:  [100.54505638]
mat_Sqrt:  [[0.15]]
grads:  [0.29035759]
Stock Position:  0.2903575871203374
Bond Position:  [-37.30672102]


portfolio before change:  [-8.6125545]
curr_Stock_Price:  98.83960821062996
curr_Factors:  [98.83960821]
mat_Sqrt:  [[0.15]]
grads:  [-0.11844402]
Stock Position:  -0.11844401555489162
Bond Position:  [3.09440559]


portfolio before change:  [-8.73428238]
curr_Stock_Price:  99.87059912706398
curr_Factors:  [99.87059913]
mat_Sqrt:  [[0.15]]
grads:  [-0.04349508]
Stock Position:  -0.04349508396423359
Bond Position:  [-4.39040228]


portfolio before change:  [-8.78038955]
curr_Stock_Price:  100.91803562928654
curr_Factors:  [100.91803563]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617044]
Stock Position:  -0.026170444982714106
Bond Position:  [-6.13931965]


portfolio before change:  [-8.77454923]
curr_Stock_Price:  100.66554530873599
curr_Factors:  [100.66554531]
mat_Sqrt:  [[0.15]]
grads:  [0.22085287]
Stock Position:  0.22085286924886294
Bond Position:  [-31.00682375]


portfolio before change:  [-8.77452094]
curr_Stock_Price:  100.68322397613174
curr_Factors:  [100.68322398]
mat_Sqrt:  [[0.15]]
grads:  [0.02486799]
Stock Position:  0.024867985724464768
Bond Position:  [-11.27830992]


portfolio before change:  [-8.78229261]
curr_Stock_Price:  100.427401572319
curr_Factors:  [100.42740157]
mat_Sqrt:  [[0.15]]
grads:  [0.03018143]
Stock Position:  0.030181430884801
Bond Position:  [-11.81333529]


portfolio before change:  [-8.80045471]
curr_Stock_Price:  99.87456684836523
curr_Factors:  [99.87456685]
mat_Sqrt:  [[0.15]]
grads:  [-0.1825301]
Stock Position:  -0.1825300951961439
Bond Position:  [9.42965949]


portfolio before change:  [-9.02802839]
curr_Stock_Price:  101.12779831582881
curr_Factors:  [101.12779832]
mat_Sqrt:  [[0.15]]
grads:  [0.15427804]
Stock Position:  0.15427804177689206
Bond Position:  [-24.62982708]


portfolio before change:  [-9.04538573]
curr_Stock_Price:  101.03524840954796
curr_Factors:  [101.03524841]
mat_Sqrt:  [[0.15]]
grads:  [0.13282862]
Stock Position:  0.13282861611780675
Bond Position:  [-22.46575795]


portfolio before change:  [-9.08466867]
curr_Stock_Price:  100.76064980429697
curr_Factors:  [100.7606498]
mat_Sqrt:  [[0.15]]
grads:  [-0.09408245]
Stock Position:  -0.09408245353410379
Bond Position:  [0.39514048]


portfolio before change:  [-9.09301632]
curr_Stock_Price:  100.84990180350728
curr_Factors:  [100.8499018]
mat_Sqrt:  [[0.15]]
grads:  [0.20659874]
Stock Position:  0.20659874433556275
Bond Position:  [-29.9284794]


portfolio before change:  [-9.06822666]
curr_Stock_Price:  100.98800021811894
curr_Factors:  [100.98800022]
mat_Sqrt:  [[0.15]]
grads:  [0.0869956]
Stock Position:  0.08699559920443876
Bond Position:  [-17.85373825]


portfolio before change:  [-9.03347672]
curr_Stock_Price:  101.41309988826346
curr_Factors:  [101.41309989]
mat_Sqrt:  [[0.15]]
grads:  [-0.0487381]
Stock Position:  -0.04873809666446682
Bond Position:  [-4.09079525]


portfolio before change:  [-9.07819428]
curr_Stock_Price:  102.32011481611285
curr_Factors:  [102.32011482]
mat_Sqrt:  [[0.15]]
grads:  [-0.01972737]
Stock Position:  -0.01972737449554167
Bond Position:  [-7.05968705]


portfolio before change:  [-9.10437017]
curr_Stock_Price:  103.60226064865854
curr_Factors:  [103.60226065]
mat_Sqrt:  [[0.15]]
grads:  [-0.03312032]
Stock Position:  -0.033120324626136954
Bond Position:  [-5.67302966]


portfolio before change:  [-9.11562073]
curr_Stock_Price:  103.9205361337494
curr_Factors:  [103.92053613]
mat_Sqrt:  [[0.15]]
grads:  [0.0528217]
Stock Position:  0.05282169860820786
Bond Position:  [-14.60487996]


portfolio before change:  [-9.16560285]
curr_Stock_Price:  103.0088577952836
curr_Factors:  [103.0088578]
mat_Sqrt:  [[0.15]]
grads:  [0.11379258]
Stock Position:  0.11379257561820853
Bond Position:  [-20.88724609]


portfolio before change:  [-9.15403093]
curr_Stock_Price:  103.13349678613784
curr_Factors:  [103.13349679]
mat_Sqrt:  [[0.15]]
grads:  [0.09339897]
Stock Position:  0.09339897473091305
Bond Position:  [-18.78659379]


portfolio before change:  [-9.09437822]
curr_Stock_Price:  103.79732823552395
curr_Factors:  [103.79732824]
mat_Sqrt:  [[0.15]]
grads:  [0.0059628]
Stock Position:  0.005962800889781909
Bond Position:  [-9.71330102]


portfolio before change:  [-9.10456243]
curr_Stock_Price:  102.29300621555163
curr_Factors:  [102.29300622]
mat_Sqrt:  [[0.15]]
grads:  [-0.03234428]
Stock Position:  -0.03234428401966201
Bond Position:  [-5.79596838]


portfolio before change:  [-9.10001683]
curr_Stock_Price:  102.13006727826385
curr_Factors:  [102.13006728]
mat_Sqrt:  [[0.15]]
grads:  [0.02748999]
Stock Position:  0.027489985901524388
Bond Position:  [-11.90757094]


portfolio before change:  [-9.11087759]
curr_Stock_Price:  101.78913523634962
curr_Factors:  [101.78913524]
mat_Sqrt:  [[0.15]]
grads:  [-0.07936261]
Stock Position:  -0.07936261216044786
Bond Position:  [-1.03262592]


portfolio before change:  [-9.19833234]
curr_Stock_Price:  102.8894728385219
curr_Factors:  [102.88947284]
mat_Sqrt:  [[0.15]]
grads:  [0.00172768]
Stock Position:  0.001727677149234713
Bond Position:  [-9.37609213]


portfolio before change:  [-9.19879841]
curr_Stock_Price:  103.29812161290637
curr_Factors:  [103.29812161]
mat_Sqrt:  [[0.15]]
grads:  [0.02671925]
Stock Position:  0.026719247458759886
Bond Position:  [-11.95884648]


portfolio before change:  [-9.23992972]
curr_Stock_Price:  101.81468310807576
curr_Factors:  [101.81468311]
mat_Sqrt:  [[0.15]]
grads:  [-0.01743515]
Stock Position:  -0.01743515010225998
Bond Position:  [-7.46477544]


portfolio before change:  [-9.21472032]
curr_Stock_Price:  100.31526651798858
curr_Factors:  [100.31526652]
mat_Sqrt:  [[0.15]]
grads:  [-0.01126216]
Stock Position:  -0.011262158161346535
Bond Position:  [-8.08495392]


portfolio before change:  [-9.21838552]
curr_Stock_Price:  100.55096879092726
curr_Factors:  [100.55096879]
mat_Sqrt:  [[0.15]]
grads:  [0.00397906]
Stock Position:  0.003979055798721093
Bond Position:  [-9.61848344]


portfolio before change:  [-9.21727116]
curr_Stock_Price:  101.1332043023233
curr_Factors:  [101.1332043]
mat_Sqrt:  [[0.15]]
grads:  [-0.04438632]
Stock Position:  -0.04438632007512042
Bond Position:  [-4.72834038]


portfolio before change:  [-9.26731239]
curr_Stock_Price:  102.24728978869878
curr_Factors:  [102.24728979]
mat_Sqrt:  [[0.15]]
grads:  [-0.13079039]
Stock Position:  -0.13079038994388506
Bond Position:  [4.10565051]


portfolio before change:  [-9.30048078]
curr_Stock_Price:  102.50481348385235
curr_Factors:  [102.50481348]
mat_Sqrt:  [[0.15]]
grads:  [0.07336362]
Stock Position:  0.07336362422019678
Bond Position:  [-16.8206054]


portfolio before change:  [-9.2769039]
curr_Stock_Price:  102.85484505327031
curr_Factors:  [102.85484505]
mat_Sqrt:  [[0.15]]
grads:  [-0.01296302]
Stock Position:  -0.012963022323955185
Bond Position:  [-7.94359425]


portfolio before change:  [-9.28422041]
curr_Stock_Price:  103.34265513918551
curr_Factors:  [103.34265514]
mat_Sqrt:  [[0.15]]
grads:  [-0.09971748]
Stock Position:  -0.09971747754456846
Bond Position:  [1.02084849]


portfolio before change:  [-9.25578461]
curr_Stock_Price:  103.05877128871455
curr_Factors:  [103.05877129]
mat_Sqrt:  [[0.15]]
grads:  [-0.13553141]
Stock Position:  -0.13553141027554932
Bond Position:  [4.711916]


portfolio before change:  [-9.35792663]
curr_Stock_Price:  103.81675825803573
curr_Factors:  [103.81675826]
mat_Sqrt:  [[0.15]]
grads:  [0.07008294]
Stock Position:  0.07008294419391234
Bond Position:  [-16.6337107]


portfolio before change:  [-9.36596974]
curr_Stock_Price:  103.73166242012819
curr_Factors:  [103.73166242]
mat_Sqrt:  [[0.15]]
grads:  [0.02757567]
Stock Position:  0.027575670520546686
Bond Position:  [-12.22643988]


portfolio before change:  [-9.39224281]
curr_Stock_Price:  102.83432536237042
curr_Factors:  [102.83432536]
mat_Sqrt:  [[0.15]]
grads:  [0.13208261]
Stock Position:  0.1320826075954138
Bond Position:  [-22.97486865]


portfolio before change:  [-9.44430976]
curr_Stock_Price:  102.46186968634129
curr_Factors:  [102.46186969]
mat_Sqrt:  [[0.15]]
grads:  [0.06485676]
Stock Position:  0.06485676004877973
Bond Position:  [-16.08965466]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.45207431]
Stock Price:  102.37316315774898
PL:  [-11.82523747]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-9.80540242e-03]
 [ 1.69557275e-02]
 [-2.84578764e-03]
 [-6.73056359e-03]
 [-5.23707445e-03]
 [ 4.91677542e-02]
 [ 3.24112260e-03]
 [ 8.54322102e-03]
 [ 7.72867686e-02]
 [ 2.33440640e-02]
 [ 2.21790292e-02]
 [-1.84328148e-03]
 [-3.63283616e-02]
 [ 1.63781467e-02]
 [ 3.13403074e-03]
 [-2.64928640e-03]
 [-6.02955585e-03]
 [-1.17232158e-02]
 [ 1.63168073e-03]
 [ 3.40479091e-02]
 [-2.11455898e-02]
 [-2.46049780e-02]
 [ 4.41111487e-03]
 [-1.28218551e-02]
 [ 9.10275115e-03]
 [-1.80887342e-03]
 [ 2.95411481e-02]
 [-5.34932340e-03]
 [-4.93446950e-02]
 [-8.09697847e-03]
 [ 4.62642163e-02]
 [-1.30440828e-03]
 [-2.13454890e-02]
 [-1.18868053e-02]
 [-2.40704253e-02]
 [ 3.34529661e-02]
 [-9.03633287e-03]
 [-6.55909180e-03]
 [ 2.85585878e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.2516509]
curr_Stock_Price:  99.40160751035518
curr_Factors:  [99.40160751]
mat_Sqrt:  [[0.15]]
grads:  [-0.06536935]
Stock Position:  -0.06536934947510993
Bond Position:  [-4.75383248]


portfolio before change:  [-11.21611457]
curr_Stock_Price:  98.84889280271314
curr_Factors:  [98.8488928]
mat_Sqrt:  [[0.15]]
grads:  [0.11303818]
Stock Position:  0.11303818350316844
Bond Position:  [-22.38981385]


portfolio before change:  [-11.12103404]
curr_Stock_Price:  99.71478982710236
curr_Factors:  [99.71478983]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897192]
Stock Position:  -0.01897191757158878
Bond Position:  [-9.22925327]


portfolio before change:  [-11.12342]
curr_Stock_Price:  99.77973992739098
curr_Factors:  [99.77973993]
mat_Sqrt:  [[0.15]]
grads:  [-0.04487042]
Stock Position:  -0.04487042391144646
Bond Position:  [-6.64626077]


portfolio before change:  [-11.03758374]
curr_Stock_Price:  97.84824286063281
curr_Factors:  [97.84824286]
mat_Sqrt:  [[0.15]]
grads:  [-0.03491383]
Stock Position:  -0.03491382966478842
Bond Position:  [-7.62132686]


portfolio before change:  [-11.02169215]
curr_Stock_Price:  97.36578872647698
curr_Factors:  [97.36578873]
mat_Sqrt:  [[0.15]]
grads:  [0.32778503]
Stock Position:  0.3277850279885454
Bond Position:  [-42.93673993]


portfolio before change:  [-11.65888022]
curr_Stock_Price:  95.43824294995103
curr_Factors:  [95.43824295]
mat_Sqrt:  [[0.15]]
grads:  [0.02160748]
Stock Position:  0.02160748401734415
Bond Position:  [-13.72106053]


portfolio before change:  [-11.66350301]
curr_Stock_Price:  95.30368078332333
curr_Factors:  [95.30368078]
mat_Sqrt:  [[0.15]]
grads:  [0.05695481]
Stock Position:  0.05695480682560118
Bond Position:  [-17.09150574]


portfolio before change:  [-11.65787249]
curr_Stock_Price:  95.44005359110737
curr_Factors:  [95.44005359]
mat_Sqrt:  [[0.15]]
grads:  [0.51524512]
Stock Position:  0.5152451238056768
Bond Position:  [-60.83289472]


portfolio before change:  [-11.53783587]
curr_Stock_Price:  95.68778269705295
curr_Factors:  [95.6877827]
mat_Sqrt:  [[0.15]]
grads:  [0.15562709]
Stock Position:  0.15562709335708316
Bond Position:  [-26.42944736]


portfolio before change:  [-11.62011125]
curr_Stock_Price:  95.18034218525062
curr_Factors:  [95.18034219]
mat_Sqrt:  [[0.15]]
grads:  [0.14786019]
Stock Position:  0.1478601946640063
Bond Position:  [-25.69349517]


portfolio before change:  [-11.78274322]
curr_Stock_Price:  94.10216095840043
curr_Factors:  [94.10216096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01228854]
Stock Position:  -0.012288543185004237
Bond Position:  [-10.62636475]


portfolio before change:  [-11.78056412]
curr_Stock_Price:  93.81673420214254
curr_Factors:  [93.8167342]
mat_Sqrt:  [[0.15]]
grads:  [-0.24218908]
Stock Position:  -0.2421890770379212
Bond Position:  [10.94082415]


portfolio before change:  [-11.95786753]
curr_Stock_Price:  94.55446812526101
curr_Factors:  [94.55446813]
mat_Sqrt:  [[0.15]]
grads:  [0.10918764]
Stock Position:  0.10918764440527952
Bond Position:  [-22.28204717]


portfolio before change:  [-11.96503176]
curr_Stock_Price:  94.51436465303414
curr_Factors:  [94.51436465]
mat_Sqrt:  [[0.15]]
grads:  [0.02089354]
Stock Position:  0.020893538277077482
Bond Position:  [-13.93977126]


portfolio before change:  [-11.97739095]
curr_Stock_Price:  94.00623586628012
curr_Factors:  [94.00623587]
mat_Sqrt:  [[0.15]]
grads:  [-0.01766191]
Stock Position:  -0.01766190931105884
Bond Position:  [-10.31706134]


portfolio before change:  [-11.98391623]
curr_Stock_Price:  94.30266826295046
curr_Factors:  [94.30266826]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019704]
Stock Position:  -0.04019703899082734
Bond Position:  [-8.19322819]


portfolio before change:  [-11.9660226]
curr_Stock_Price:  93.83204053533386
curr_Factors:  [93.83204054]
mat_Sqrt:  [[0.15]]
grads:  [-0.07815477]
Stock Position:  -0.07815477228737275
Bond Position:  [-4.63260084]


portfolio before change:  [-11.92895778]
curr_Stock_Price:  93.35038177755027
curr_Factors:  [93.35038178]
mat_Sqrt:  [[0.15]]
grads:  [0.01087787]
Stock Position:  0.010877871540164048
Bond Position:  [-12.94441125]


portfolio before change:  [-11.93550766]
curr_Stock_Price:  92.89700990385327
curr_Factors:  [92.8970099]
mat_Sqrt:  [[0.15]]
grads:  [0.22698606]
Stock Position:  0.2269860604472658
Bond Position:  [-33.02183396]


portfolio before change:  [-11.69201556]
curr_Stock_Price:  93.98791427478812
curr_Factors:  [93.98791427]
mat_Sqrt:  [[0.15]]
grads:  [-0.1409706]
Stock Position:  -0.14097059835073936
Bond Position:  [1.55751695]


portfolio before change:  [-11.73046832]
curr_Stock_Price:  94.26206694254708
curr_Factors:  [94.26206694]
mat_Sqrt:  [[0.15]]
grads:  [-0.16403319]
Stock Position:  -0.16403318682235515
Bond Position:  [3.73163891]


portfolio before change:  [-11.83841856]
curr_Stock_Price:  94.92301075129956
curr_Factors:  [94.92301075]
mat_Sqrt:  [[0.15]]
grads:  [0.02940743]
Stock Position:  0.02940743248856314
Bond Position:  [-14.62986059]


portfolio before change:  [-11.87339213]
curr_Stock_Price:  93.79592421205038
curr_Factors:  [93.79592421]
mat_Sqrt:  [[0.15]]
grads:  [-0.08547903]
Stock Position:  -0.08547903424007455
Bond Position:  [-3.85580711]


portfolio before change:  [-11.81605376]
curr_Stock_Price:  93.11949661367294
curr_Factors:  [93.11949661]
mat_Sqrt:  [[0.15]]
grads:  [0.06068501]
Stock Position:  0.060685007665965685
Bond Position:  [-17.46701112]


portfolio before change:  [-11.75437098]
curr_Stock_Price:  94.17191952764581
curr_Factors:  [94.17191953]
mat_Sqrt:  [[0.15]]
grads:  [-0.01205916]
Stock Position:  -0.01205915613722382
Bond Position:  [-10.61873709]


portfolio before change:  [-11.75928637]
curr_Stock_Price:  94.46944994068033
curr_Factors:  [94.46944994]
mat_Sqrt:  [[0.15]]
grads:  [0.19694099]
Stock Position:  0.19694098749969216
Bond Position:  [-30.36419313]


portfolio before change:  [-11.94090615]
curr_Stock_Price:  93.56651945643189
curr_Factors:  [93.56651946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566216]
Stock Position:  -0.03566215599061312
Bond Position:  [-8.60412234]


portfolio before change:  [-11.94403914]
curr_Stock_Price:  93.62421114552045
curr_Factors:  [93.62421115]
mat_Sqrt:  [[0.15]]
grads:  [-0.32896463]
Stock Position:  -0.32896463328488523
Bond Position:  [18.85501514]


portfolio before change:  [-11.91684835]
curr_Stock_Price:  93.54872046112717
curr_Factors:  [93.54872046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397986]
Stock Position:  -0.05397985649759118
Bond Position:  [-6.86710185]


portfolio before change:  [-11.98568942]
curr_Stock_Price:  94.80812782533373
curr_Factors:  [94.80812783]
mat_Sqrt:  [[0.15]]
grads:  [0.30842811]
Stock Position:  0.30842810889170724
Bond Position:  [-41.22718099]


portfolio before change:  [-12.01328317]
curr_Stock_Price:  94.73537172354791
curr_Factors:  [94.73537172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00869606]
Stock Position:  -0.008696055208671338
Bond Position:  [-11.18945915]


portfolio before change:  [-12.01063595]
curr_Stock_Price:  94.27010434539359
curr_Factors:  [94.27010435]
mat_Sqrt:  [[0.15]]
grads:  [-0.14230326]
Stock Position:  -0.14230325997548737
Bond Position:  [1.40430722]


portfolio before change:  [-11.87351508]
curr_Stock_Price:  93.30775592024773
curr_Factors:  [93.30775592]
mat_Sqrt:  [[0.15]]
grads:  [-0.07924537]
Stock Position:  -0.07924536870581064
Bond Position:  [-4.47930756]


portfolio before change:  [-11.86921203]
curr_Stock_Price:  93.2463895577031
curr_Factors:  [93.24638956]
mat_Sqrt:  [[0.15]]
grads:  [-0.1604695]
Stock Position:  -0.1604695019647634
Bond Position:  [3.09398966]


portfolio before change:  [-11.98828588]
curr_Stock_Price:  93.99083399568153
curr_Factors:  [93.990834]
mat_Sqrt:  [[0.15]]
grads:  [0.22301977]
Stock Position:  0.22301977407901016
Bond Position:  [-32.95010045]


portfolio before change:  [-12.0752294]
curr_Stock_Price:  93.61945664309627
curr_Factors:  [93.61945664]
mat_Sqrt:  [[0.15]]
grads:  [-0.06024222]
Stock Position:  -0.060242219113087705
Bond Position:  [-6.43538558]


portfolio before change:  [-12.09674147]
curr_Stock_Price:  93.96319557613761
curr_Factors:  [93.96319558]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372728]
Stock Position:  -0.043727278673392565
Bond Position:  [-7.98798663]


portfolio before change:  [-12.11307079]
curr_Stock_Price:  94.31379508683534
curr_Factors:  [94.31379509]
mat_Sqrt:  [[0.15]]
grads:  [0.19039059]
Stock Position:  0.19039058541893256
Bond Position:  [-30.06952945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.24660139]
Stock Price:  93.63218748425622
PL:  [-12.24660139]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.10207954e-02]
 [ 3.18833154e-02]
 [-8.42072048e-03]
 [-6.27671748e-03]
 [-6.45468014e-03]
 [ 2.95609807e-02]
 [ 3.61018103e-03]
 [-1.17280175e-03]
 [ 6.39500316e-03]
 [ 2.34455358e-02]
 [ 2.15437613e-02]
 [-5.36111099e-03]
 [-6.67775020e-03]
 [ 1.81259977e-02]
 [ 3.20160883e-03]
 [-3.34137896e-03]
 [-6.04012988e-03]
 [-1.89843521e-03]
 [ 1.67967754e-03]
 [-8.86211896e-03]
 [-8.64752109e-03]
 [-1.46153753e-02]
 [ 6.74558472e-03]
 [-7.75631457e-03]
 [ 1.51005165e-02]
 [ 7.66470046e-03]
 [-4.27299455e-03]
 [-1.81401430e-03]
 [ 4.26768161e-04]
 [-6.71598484e-03]
 [-2.70456152e-02]
 [ 1.43422280e-02]
 [-3.36748179e-03]
 [-1.84619220e-02]
 [-2.13121757e-02]
 [ 3.86960156e-02]
 [ 2.46036934e-03]
 [ 6.91345025e-03]
 [ 8.05931243e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.21928866]
curr_Stock_Price:  99.4486275343316
curr_Factors:  [99.44862753]
mat_Sqrt:  [[0.15]]
grads:  [-0.07347197]
Stock Position:  -0.0734719691140563
Bond Position:  [-2.91260217]


portfolio before change:  [-10.21961741]
curr_Stock_Price:  99.44814651996178
curr_Factors:  [99.44814652]
mat_Sqrt:  [[0.15]]
grads:  [0.21255544]
Stock Position:  0.21255543626536394
Bond Position:  [-31.35786158]


portfolio before change:  [-10.23573252]
curr_Stock_Price:  99.39077266625821
curr_Factors:  [99.39077267]
mat_Sqrt:  [[0.15]]
grads:  [-0.05613814]
Stock Position:  -0.0561381365297504
Bond Position:  [-4.65611975]


portfolio before change:  [-10.26937153]
curr_Stock_Price:  99.97962308479637
curr_Factors:  [99.97962308]
mat_Sqrt:  [[0.15]]
grads:  [-0.04184478]
Stock Position:  -0.04184478322625384
Bond Position:  [-6.08574588]


portfolio before change:  [-10.29267039]
curr_Stock_Price:  100.51823480766362
curr_Factors:  [100.51823481]
mat_Sqrt:  [[0.15]]
grads:  [-0.0430312]
Stock Position:  -0.04303120094264676
Bond Position:  [-5.96725003]


portfolio before change:  [-10.27221421]
curr_Stock_Price:  100.025519560479
curr_Factors:  [100.02551956]
mat_Sqrt:  [[0.15]]
grads:  [0.1970732]
Stock Position:  0.19707320458921593
Bond Position:  [-29.98456389]


portfolio before change:  [-10.32660307]
curr_Stock_Price:  99.76855638354681
curr_Factors:  [99.76855638]
mat_Sqrt:  [[0.15]]
grads:  [0.02406787]
Stock Position:  0.02406787355315254
Bond Position:  [-12.72782007]


portfolio before change:  [-10.34535472]
curr_Stock_Price:  99.05554911217973
curr_Factors:  [99.05554911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781868]
Stock Position:  -0.007818678335911771
Bond Position:  [-9.57087124]


portfolio before change:  [-10.33436601]
curr_Stock_Price:  97.4970830608548
curr_Factors:  [97.49708306]
mat_Sqrt:  [[0.15]]
grads:  [0.04263335]
Stock Position:  0.04263335439781561
Bond Position:  [-14.4909937]


portfolio before change:  [-10.35399049]
curr_Stock_Price:  97.07926487259546
curr_Factors:  [97.07926487]
mat_Sqrt:  [[0.15]]
grads:  [0.15630357]
Stock Position:  0.1563035719217655
Bond Position:  [-25.52782635]


portfolio before change:  [-10.39408494]
curr_Stock_Price:  96.84316485494482
curr_Factors:  [96.84316485]
mat_Sqrt:  [[0.15]]
grads:  [0.14362508]
Stock Position:  0.1436250754806181
Bond Position:  [-24.3031918]


portfolio before change:  [-10.46419459]
curr_Stock_Price:  96.37617426198618
curr_Factors:  [96.37617426]
mat_Sqrt:  [[0.15]]
grads:  [-0.03574074]
Stock Position:  -0.03574073992686124
Bond Position:  [-7.01963881]


portfolio before change:  [-10.51143481]
curr_Stock_Price:  97.6733692803525
curr_Factors:  [97.67336928]
mat_Sqrt:  [[0.15]]
grads:  [-0.04451833]
Stock Position:  -0.04451833466911048
Bond Position:  [-6.16317907]


portfolio before change:  [-10.44331722]
curr_Stock_Price:  96.12596109749197
curr_Factors:  [96.1259611]
mat_Sqrt:  [[0.15]]
grads:  [0.12083998]
Stock Position:  0.12083998485810393
Bond Position:  [-22.0591769]


portfolio before change:  [-10.64163058]
curr_Stock_Price:  94.50765744617529
curr_Factors:  [94.50765745]
mat_Sqrt:  [[0.15]]
grads:  [0.02134406]
Stock Position:  0.02134405888572172
Bond Position:  [-12.65880758]


portfolio before change:  [-10.66765188]
curr_Stock_Price:  93.36266193250432
curr_Factors:  [93.36266193]
mat_Sqrt:  [[0.15]]
grads:  [-0.02227586]
Stock Position:  -0.022275859761710887
Bond Position:  [-8.58791831]


portfolio before change:  [-10.69657241]
curr_Stock_Price:  94.61275826424294
curr_Factors:  [94.61275826]
mat_Sqrt:  [[0.15]]
grads:  [-0.04026753]
Stock Position:  -0.040267532514934444
Bond Position:  [-6.88675009]


portfolio before change:  [-10.76718215]
curr_Stock_Price:  96.34489430016765
curr_Factors:  [96.3448943]
mat_Sqrt:  [[0.15]]
grads:  [-0.01265623]
Stock Position:  -0.01265623471884436
Bond Position:  [-9.54781855]


portfolio before change:  [-10.75448322]
curr_Stock_Price:  95.24721587047534
curr_Factors:  [95.24721587]
mat_Sqrt:  [[0.15]]
grads:  [0.01119785]
Stock Position:  0.011197850234158115
Bond Position:  [-11.82104728]


portfolio before change:  [-10.74465956]
curr_Stock_Price:  96.25646231691647
curr_Factors:  [96.25646232]
mat_Sqrt:  [[0.15]]
grads:  [-0.05908079]
Stock Position:  -0.05908079309418719
Bond Position:  [-5.05775142]


portfolio before change:  [-10.7811898]
curr_Stock_Price:  96.8640706244854
curr_Factors:  [96.86407062]
mat_Sqrt:  [[0.15]]
grads:  [-0.05765014]
Stock Position:  -0.05765014062553272
Bond Position:  [-5.1969625]


portfolio before change:  [-10.84328798]
curr_Stock_Price:  97.92995736535872
curr_Factors:  [97.92995737]
mat_Sqrt:  [[0.15]]
grads:  [-0.09743584]
Stock Position:  -0.09743583525470027
Bond Position:  [-1.30140078]


portfolio before change:  [-11.08227481]
curr_Stock_Price:  100.38104885225528
curr_Factors:  [100.38104885]
mat_Sqrt:  [[0.15]]
grads:  [0.04497056]
Stock Position:  0.04497056480167152
Bond Position:  [-15.59646727]


portfolio before change:  [-11.10685698]
curr_Stock_Price:  99.87777531680425
curr_Factors:  [99.87777532]
mat_Sqrt:  [[0.15]]
grads:  [-0.05170876]
Stock Position:  -0.051708763802007965
Bond Position:  [-5.94230069]


portfolio before change:  [-11.08960246]
curr_Stock_Price:  99.52972301088067
curr_Factors:  [99.52972301]
mat_Sqrt:  [[0.15]]
grads:  [0.10067011]
Stock Position:  0.10067010977231536
Bond Position:  [-21.1092706]


portfolio before change:  [-11.14228936]
curr_Stock_Price:  99.03257368067975
curr_Factors:  [99.03257368]
mat_Sqrt:  [[0.15]]
grads:  [0.051098]
Stock Position:  0.05109800309023155
Bond Position:  [-16.20265612]


portfolio before change:  [-11.15781967]
curr_Stock_Price:  98.76828063369508
curr_Factors:  [98.76828063]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848663]
Stock Position:  -0.028486630328620085
Bond Position:  [-8.34424417]


portfolio before change:  [-11.19801368]
curr_Stock_Price:  100.14264156408404
curr_Factors:  [100.14264156]
mat_Sqrt:  [[0.15]]
grads:  [-0.01209343]
Stock Position:  -0.012093428678688189
Bond Position:  [-9.98694578]


portfolio before change:  [-11.19654913]
curr_Stock_Price:  99.91830525494038
curr_Factors:  [99.91830525]
mat_Sqrt:  [[0.15]]
grads:  [0.00284512]
Stock Position:  0.002845121075401418
Bond Position:  [-11.48082881]


portfolio before change:  [-11.19486695]
curr_Stock_Price:  101.01399490415606
curr_Factors:  [101.0139949]
mat_Sqrt:  [[0.15]]
grads:  [-0.04477323]
Stock Position:  -0.04477323229372704
Bond Position:  [-6.67214389]


portfolio before change:  [-11.20148927]
curr_Stock_Price:  101.14327416236668
curr_Factors:  [101.14327416]
mat_Sqrt:  [[0.15]]
grads:  [-0.1803041]
Stock Position:  -0.18030410135129823
Bond Position:  [7.03505788]


portfolio before change:  [-11.37090688]
curr_Stock_Price:  102.08777319415466
curr_Factors:  [102.08777319]
mat_Sqrt:  [[0.15]]
grads:  [0.09561485]
Stock Position:  0.09561485362591898
Bond Position:  [-21.13201438]


portfolio before change:  [-11.34917233]
curr_Stock_Price:  102.34271500249912
curr_Factors:  [102.342715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244988]
Stock Position:  -0.02244987859401576
Bond Position:  [-9.0515908]


portfolio before change:  [-11.31566655]
curr_Stock_Price:  100.79984266972296
curr_Factors:  [100.79984267]
mat_Sqrt:  [[0.15]]
grads:  [-0.12307948]
Stock Position:  -0.1230794796769994
Bond Position:  [1.09072564]


portfolio before change:  [-11.26205]
curr_Stock_Price:  100.3653250708057
curr_Factors:  [100.36532507]
mat_Sqrt:  [[0.15]]
grads:  [-0.14208117]
Stock Position:  -0.14208117151231123
Bond Position:  [2.99797296]


portfolio before change:  [-11.00765748]
curr_Stock_Price:  98.5774896411549
curr_Factors:  [98.57748964]
mat_Sqrt:  [[0.15]]
grads:  [0.25797344]
Stock Position:  0.2579734373116578
Bond Position:  [-36.43803132]


portfolio before change:  [-11.11807772]
curr_Stock_Price:  98.16711714399214
curr_Factors:  [98.16711714]
mat_Sqrt:  [[0.15]]
grads:  [0.01640246]
Stock Position:  0.016402462251284416
Bond Position:  [-12.72826016]


portfolio before change:  [-11.1244814]
curr_Stock_Price:  97.87371338587192
curr_Factors:  [97.87371339]
mat_Sqrt:  [[0.15]]
grads:  [0.04608967]
Stock Position:  0.04608966836230931
Bond Position:  [-15.63544839]


portfolio before change:  [-11.14617234]
curr_Stock_Price:  97.44549613898185
curr_Factors:  [97.44549614]
mat_Sqrt:  [[0.15]]
grads:  [0.05372875]
Stock Position:  0.05372874953169964
Bond Position:  [-16.381797]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.09803266]
Stock Price:  98.37958700937301
PL:  [-11.09803266]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-6.18744168e-03]
 [ 3.89443038e-02]
 [-1.76843528e-02]
 [-7.16338261e-03]
 [-7.48031019e-03]
 [ 2.82149367e-02]
 [ 3.54234327e-03]
 [ 5.62110008e-03]
 [-1.91929250e-02]
 [ 2.33861539e-02]
 [ 1.95192740e-02]
 [-1.38719747e-02]
 [ 1.81147620e-02]
 [ 5.55867237e-03]
 [ 5.28993228e-03]
 [-3.73176799e-03]
 [-6.15208807e-03]
 [ 5.03945095e-03]
 [ 9.82903355e-03]
 [ 5.53304117e-03]
 [-4.65687966e-03]
 [-5.10518298e-03]
 [ 5.51615867e-03]
 [-1.20216629e-02]
 [ 7.90177918e-04]
 [ 3.95554412e-03]
 [ 2.12514624e-04]
 [ 8.48989491e-04]
 [ 3.62887528e-03]
 [-6.37897677e-03]
 [-2.33299151e-02]
 [ 1.15558510e-02]
 [ 1.69114793e-03]
 [ 3.12704191e-03]
 [-2.01194780e-02]
 [-8.21010501e-03]
 [ 9.98513990e-03]
 [ 1.90530018e-02]
 [ 9.07061469e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.33975245]
curr_Stock_Price:  99.62532509020747
curr_Factors:  [99.62532509]
mat_Sqrt:  [[0.15]]
grads:  [-0.04124961]
Stock Position:  -0.04124961118162115
Bond Position:  [-2.23024652]


portfolio before change:  [-6.34979917]
curr_Stock_Price:  99.86212560201692
curr_Factors:  [99.8621256]
mat_Sqrt:  [[0.15]]
grads:  [0.25962869]
Stock Position:  0.2596286921366539
Bond Position:  [-32.27687224]


portfolio before change:  [-6.62722472]
curr_Stock_Price:  98.80911915829678
curr_Factors:  [98.80911916]
mat_Sqrt:  [[0.15]]
grads:  [-0.11789569]
Stock Position:  -0.11789568556707436
Bond Position:  [5.02194412]


portfolio before change:  [-6.64033216]
curr_Stock_Price:  98.92562234757976
curr_Factors:  [98.92562235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04775588]
Stock Position:  -0.04775588404919553
Bond Position:  [-1.91605161]


portfolio before change:  [-6.67393141]
curr_Stock_Price:  99.62416922445098
curr_Factors:  [99.62416922]
mat_Sqrt:  [[0.15]]
grads:  [-0.04986873]
Stock Position:  -0.04986873460611324
Bond Position:  [-1.70580015]


portfolio before change:  [-6.66013677]
curr_Stock_Price:  99.34327425621609
curr_Factors:  [99.34327426]
mat_Sqrt:  [[0.15]]
grads:  [0.18809958]
Stock Position:  0.18809957811719816
Bond Position:  [-25.34656474]


portfolio before change:  [-6.67056241]
curr_Stock_Price:  99.3046929511012
curr_Factors:  [99.30469295]
mat_Sqrt:  [[0.15]]
grads:  [0.02361562]
Stock Position:  0.02361562178307561
Bond Position:  [-9.01570448]


portfolio before change:  [-6.63629479]
curr_Stock_Price:  100.80347436050374
curr_Factors:  [100.80347436]
mat_Sqrt:  [[0.15]]
grads:  [0.037474]
Stock Position:  0.037474000550232395
Bond Position:  [-10.41380425]


portfolio before change:  [-6.63193988]
curr_Stock_Price:  100.95442486558048
curr_Factors:  [100.95442487]
mat_Sqrt:  [[0.15]]
grads:  [-0.12795283]
Stock Position:  -0.12795283302338864
Bond Position:  [6.28546479]


portfolio before change:  [-6.5401598]
curr_Stock_Price:  100.24326947162103
curr_Factors:  [100.24326947]
mat_Sqrt:  [[0.15]]
grads:  [0.15590769]
Stock Position:  0.15590769274975838
Bond Position:  [-22.16885666]


portfolio before change:  [-6.64456187]
curr_Stock_Price:  99.59140434556323
curr_Factors:  [99.59140435]
mat_Sqrt:  [[0.15]]
grads:  [0.13012849]
Stock Position:  0.13012849309979213
Bond Position:  [-19.60424124]


portfolio before change:  [-6.48143075]
curr_Stock_Price:  100.86385281957203
curr_Factors:  [100.86385282]
mat_Sqrt:  [[0.15]]
grads:  [-0.09247983]
Stock Position:  -0.09247983128913086
Bond Position:  [2.84644134]


portfolio before change:  [-6.56290087]
curr_Stock_Price:  101.74865058515178
curr_Factors:  [101.74865059]
mat_Sqrt:  [[0.15]]
grads:  [0.12076508]
Stock Position:  0.12076508028810755
Bond Position:  [-18.85058483]


portfolio before change:  [-6.76334236]
curr_Stock_Price:  100.10839974552421
curr_Factors:  [100.10839975]
mat_Sqrt:  [[0.15]]
grads:  [0.03705782]
Stock Position:  0.03705781579904988
Bond Position:  [-10.473141]


portfolio before change:  [-6.75291168]
curr_Stock_Price:  100.42519952567025
curr_Factors:  [100.42519953]
mat_Sqrt:  [[0.15]]
grads:  [0.03526622]
Stock Position:  0.03526621519740862
Bond Position:  [-10.29452838]


portfolio before change:  [-6.73878685]
curr_Stock_Price:  100.86221055703875
curr_Factors:  [100.86221056]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487845]
Stock Position:  -0.024878453267812423
Bond Position:  [-4.22949106]


portfolio before change:  [-6.71496351]
curr_Stock_Price:  99.88336909894309
curr_Factors:  [99.8833691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101392]
Stock Position:  -0.041013920455829446
Bond Position:  [-2.61835496]


portfolio before change:  [-6.7099506]
curr_Stock_Price:  99.75316383582712
curr_Factors:  [99.75316384]
mat_Sqrt:  [[0.15]]
grads:  [0.03359634]
Stock Position:  0.03359633965055068
Bond Position:  [-10.06129177]


portfolio before change:  [-6.6560681]
curr_Stock_Price:  101.39442110887045
curr_Factors:  [101.39442111]
mat_Sqrt:  [[0.15]]
grads:  [0.06552689]
Stock Position:  0.06552689030878549
Bond Position:  [-13.30012921]


portfolio before change:  [-6.70329025]
curr_Stock_Price:  100.69914113744791
curr_Factors:  [100.69914114]
mat_Sqrt:  [[0.15]]
grads:  [0.03688694]
Stock Position:  0.0368869411314738
Bond Position:  [-10.41777355]


portfolio before change:  [-6.69420389]
curr_Stock_Price:  100.98077662147405
curr_Factors:  [100.98077662]
mat_Sqrt:  [[0.15]]
grads:  [-0.03104586]
Stock Position:  -0.03104586443095062
Bond Position:  [-3.55916838]


portfolio before change:  [-6.70273199]
curr_Stock_Price:  101.24113930028587
curr_Factors:  [101.2411393]
mat_Sqrt:  [[0.15]]
grads:  [-0.03403455]
Stock Position:  -0.034034553203576075
Bond Position:  [-3.25703505]


portfolio before change:  [-6.6971658]
curr_Stock_Price:  101.06563081553605
curr_Factors:  [101.06563082]
mat_Sqrt:  [[0.15]]
grads:  [0.03677439]
Stock Position:  0.036774391141432654
Bond Position:  [-10.41379283]


portfolio before change:  [-6.66813192]
curr_Stock_Price:  101.8905439954665
curr_Factors:  [101.890544]
mat_Sqrt:  [[0.15]]
grads:  [-0.08014442]
Stock Position:  -0.08014441962104703
Bond Position:  [1.49782659]


portfolio before change:  [-6.73253308]
curr_Stock_Price:  102.69644411811012
curr_Factors:  [102.69644412]
mat_Sqrt:  [[0.15]]
grads:  [0.00526785]
Stock Position:  0.005267852788920722
Bond Position:  [-7.27352283]


portfolio before change:  [-6.73051106]
curr_Stock_Price:  103.25288880502153
curr_Factors:  [103.25288881]
mat_Sqrt:  [[0.15]]
grads:  [0.02637029]
Stock Position:  0.026370294147994678
Bond Position:  [-9.45332011]


portfolio before change:  [-6.73946798]
curr_Stock_Price:  102.95804242918217
curr_Factors:  [102.95804243]
mat_Sqrt:  [[0.15]]
grads:  [0.00141676]
Stock Position:  0.0014167641618945243
Bond Position:  [-6.88533525]


portfolio before change:  [-6.74076384]
curr_Stock_Price:  102.65090462747807
curr_Factors:  [102.65090463]
mat_Sqrt:  [[0.15]]
grads:  [0.00565993]
Stock Position:  0.005659929940081132
Bond Position:  [-7.32176077]


portfolio before change:  [-6.74100313]
curr_Stock_Price:  102.77033853707054
curr_Factors:  [102.77033854]
mat_Sqrt:  [[0.15]]
grads:  [0.0241925]
Stock Position:  0.024192501839207216
Bond Position:  [-9.22727474]


portfolio before change:  [-6.76790244]
curr_Stock_Price:  101.70613181617031
curr_Factors:  [101.70613182]
mat_Sqrt:  [[0.15]]
grads:  [-0.04252651]
Stock Position:  -0.04252651180905678
Bond Position:  [-2.44269542]


portfolio before change:  [-6.76206004]
curr_Stock_Price:  101.56156882426959
curr_Factors:  [101.56156882]
mat_Sqrt:  [[0.15]]
grads:  [-0.15553277]
Stock Position:  -0.15553276761419438
Bond Position:  [9.03409185]


portfolio before change:  [-6.89734183]
curr_Stock_Price:  102.43862600698799
curr_Factors:  [102.43862601]
mat_Sqrt:  [[0.15]]
grads:  [0.07703901]
Stock Position:  0.07703900688835116
Bond Position:  [-14.78911185]


portfolio before change:  [-6.76671393]
curr_Stock_Price:  104.15823101996311
curr_Factors:  [104.15823102]
mat_Sqrt:  [[0.15]]
grads:  [0.01127432]
Stock Position:  0.011274319548675108
Bond Position:  [-7.94102711]


portfolio before change:  [-6.76726202]
curr_Stock_Price:  104.19766524255095
curr_Factors:  [104.19766524]
mat_Sqrt:  [[0.15]]
grads:  [0.02084695]
Stock Position:  0.02084694606244509
Bond Position:  [-8.93946513]


portfolio before change:  [-6.73568075]
curr_Stock_Price:  105.76618148651357
curr_Factors:  [105.76618149]
mat_Sqrt:  [[0.15]]
grads:  [-0.13412985]
Stock Position:  -0.1341298532671589
Bond Position:  [7.45072165]


portfolio before change:  [-6.70812411]
curr_Stock_Price:  105.5676779785259
curr_Factors:  [105.56767798]
mat_Sqrt:  [[0.15]]
grads:  [-0.05473403]
Stock Position:  -0.05473403342941187
Bond Position:  [-0.92997929]


portfolio before change:  [-6.6746599]
curr_Stock_Price:  104.95415732963981
curr_Factors:  [104.95415733]
mat_Sqrt:  [[0.15]]
grads:  [0.0665676]
Stock Position:  0.06656759930446571
Bond Position:  [-13.66120619]


portfolio before change:  [-6.6060677]
curr_Stock_Price:  106.01022600372255
curr_Factors:  [106.010226]
mat_Sqrt:  [[0.15]]
grads:  [0.12702001]
Stock Position:  0.12702001175860095
Bond Position:  [-20.07148786]


portfolio before change:  [-6.67614158]
curr_Stock_Price:  105.47830366657047
curr_Factors:  [105.47830367]
mat_Sqrt:  [[0.15]]
grads:  [0.06047076]
Stock Position:  0.06047076460801773
Bond Position:  [-13.05449525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.56685936]
Stock Price:  107.3124813921275
PL:  [-13.87934075]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.16035913e-02]
 [-1.10252981e-02]
 [ 8.74173174e-03]
 [-5.83429202e-03]
 [-6.18969558e-03]
 [ 2.80437237e-02]
 [ 3.59135462e-03]
 [ 5.74385066e-04]
 [-2.47045183e-02]
 [ 2.34401491e-02]
 [ 2.02094052e-02]
 [-1.44548305e-02]
 [ 1.72339454e-02]
 [ 6.47029192e-03]
 [-8.80071982e-03]
 [ 4.14441728e-04]
 [-6.11586652e-03]
 [-3.99350029e-03]
 [ 1.06303513e-03]
 [-6.48406721e-03]
 [-1.00383847e-02]
 [-2.29292222e-02]
 [ 4.59113488e-03]
 [-1.06087002e-02]
 [ 1.32348023e-02]
 [ 2.76732523e-03]
 [ 1.53540071e-02]
 [-3.64190527e-03]
 [-1.10877310e-02]
 [-1.29978012e-02]
 [ 2.66145627e-02]
 [ 9.59133503e-03]
 [-1.11659276e-02]
 [-4.83569263e-02]
 [-2.26385252e-02]
 [ 3.87236851e-02]
 [ 9.53422763e-04]
 [ 6.98796693e-03]
 [ 5.57922697e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.75787721]
curr_Stock_Price:  101.26942958773458
curr_Factors:  [101.26942959]
mat_Sqrt:  [[0.15]]
grads:  [-0.34402394]
Stock Position:  -0.3440239418807654
Bond Position:  [64.59698557]


portfolio before change:  [29.69991092]
curr_Stock_Price:  101.46139708233895
curr_Factors:  [101.46139708]
mat_Sqrt:  [[0.15]]
grads:  [-0.07350199]
Stock Position:  -0.07350198755257373
Bond Position:  [37.15752527]


portfolio before change:  [29.65530856]
curr_Stock_Price:  102.13141082061644
curr_Factors:  [102.13141082]
mat_Sqrt:  [[0.15]]
grads:  [0.05827821]
Stock Position:  0.05827821160178324
Bond Position:  [23.70327259]


portfolio before change:  [29.53811462]
curr_Stock_Price:  100.06962752647829
curr_Factors:  [100.06962753]
mat_Sqrt:  [[0.15]]
grads:  [-0.03889528]
Stock Position:  -0.03889528016304414
Bond Position:  [33.43035081]


portfolio before change:  [29.52356899]
curr_Stock_Price:  100.551040143138
curr_Factors:  [100.55104014]
mat_Sqrt:  [[0.15]]
grads:  [-0.04126464]
Stock Position:  -0.041264637213100946
Bond Position:  [33.67277118]


portfolio before change:  [29.55859486]
curr_Stock_Price:  99.80423831828078
curr_Factors:  [99.80423832]
mat_Sqrt:  [[0.15]]
grads:  [0.18695816]
Stock Position:  0.18695815788129447
Bond Position:  [10.89937831]


portfolio before change:  [29.53266826]
curr_Stock_Price:  99.65827462641192
curr_Factors:  [99.65827463]
mat_Sqrt:  [[0.15]]
grads:  [0.02394236]
Stock Position:  0.023942364127240028
Bond Position:  [27.14661356]


portfolio before change:  [29.53907477]
curr_Stock_Price:  99.78411739257544
curr_Factors:  [99.78411739]
mat_Sqrt:  [[0.15]]
grads:  [0.00382923]
Stock Position:  0.0038292337700978193
Bond Position:  [29.15697806]


portfolio before change:  [29.53931345]
curr_Stock_Price:  98.89459907687522
curr_Factors:  [98.89459908]
mat_Sqrt:  [[0.15]]
grads:  [-0.16469679]
Stock Position:  -0.16469678865848478
Bond Position:  [45.82693633]


portfolio before change:  [29.56220516]
curr_Stock_Price:  98.79038947903953
curr_Factors:  [98.79038948]
mat_Sqrt:  [[0.15]]
grads:  [0.15626766]
Stock Position:  0.15626766079501692
Bond Position:  [14.12446209]


portfolio before change:  [29.5943413]
curr_Stock_Price:  98.98473853130169
curr_Factors:  [98.98473853]
mat_Sqrt:  [[0.15]]
grads:  [0.13472937]
Stock Position:  0.13472936769459748
Bond Position:  [16.25819007]


portfolio before change:  [29.6137171]
curr_Stock_Price:  99.11346617469553
curr_Factors:  [99.11346617]
mat_Sqrt:  [[0.15]]
grads:  [-0.09636554]
Stock Position:  -0.0963655367934951
Bond Position:  [39.16483947]


portfolio before change:  [29.56852778]
curr_Stock_Price:  99.63320827342105
curr_Factors:  [99.63320827]
mat_Sqrt:  [[0.15]]
grads:  [0.11489297]
Stock Position:  0.1148929696049302
Bond Position:  [18.12137261]


portfolio before change:  [29.55636309]
curr_Stock_Price:  99.50761307282868
curr_Factors:  [99.50761307]
mat_Sqrt:  [[0.15]]
grads:  [0.04313528]
Stock Position:  0.04313527949661662
Bond Position:  [25.26407439]


portfolio before change:  [29.55176427]
curr_Stock_Price:  99.32778290913907
curr_Factors:  [99.32778291]
mat_Sqrt:  [[0.15]]
grads:  [-0.05867147]
Stock Position:  -0.058671465445035945
Bond Position:  [35.37947085]


portfolio before change:  [29.60318648]
curr_Stock_Price:  98.52672060837897
curr_Factors:  [98.52672061]
mat_Sqrt:  [[0.15]]
grads:  [0.00276294]
Stock Position:  0.0027629448537850026
Bond Position:  [29.33096258]


portfolio before change:  [29.60217559]
curr_Stock_Price:  96.8337827682238
curr_Factors:  [96.83378277]
mat_Sqrt:  [[0.15]]
grads:  [-0.04077244]
Stock Position:  -0.04077244348839779
Bond Position:  [33.55032552]


portfolio before change:  [29.64815066]
curr_Stock_Price:  95.80904598102546
curr_Factors:  [95.80904598]
mat_Sqrt:  [[0.15]]
grads:  [-0.02662334]
Stock Position:  -0.026623335293313594
Bond Position:  [32.19890702]


portfolio before change:  [29.63292632]
curr_Stock_Price:  96.53207553244403
curr_Factors:  [96.53207553]
mat_Sqrt:  [[0.15]]
grads:  [0.0070869]
Stock Position:  0.0070869008476578494
Bond Position:  [28.94881307]


portfolio before change:  [29.63327247]
curr_Stock_Price:  96.07028318654743
curr_Factors:  [96.07028319]
mat_Sqrt:  [[0.15]]
grads:  [-0.04322711]
Stock Position:  -0.04322711473498332
Bond Position:  [33.78611362]


portfolio before change:  [29.61701885]
curr_Stock_Price:  96.54399388466614
curr_Factors:  [96.54399388]
mat_Sqrt:  [[0.15]]
grads:  [-0.06692256]
Stock Position:  -0.06692256438362898
Bond Position:  [36.0779905]


portfolio before change:  [29.72030614]
curr_Stock_Price:  95.06800050893976
curr_Factors:  [95.06800051]
mat_Sqrt:  [[0.15]]
grads:  [-0.15286148]
Stock Position:  -0.15286148160558707
Bond Position:  [44.25254155]


portfolio before change:  [29.68418089]
curr_Stock_Price:  95.34051632267011
curr_Factors:  [95.34051632]
mat_Sqrt:  [[0.15]]
grads:  [0.03060757]
Stock Position:  0.030607565870011216
Bond Position:  [26.76603975]


portfolio before change:  [29.7044133]
curr_Stock_Price:  95.89222465149741
curr_Factors:  [95.89222465]
mat_Sqrt:  [[0.15]]
grads:  [-0.07072467]
Stock Position:  -0.07072466817624204
Bond Position:  [36.48635907]


portfolio before change:  [29.58898893]
curr_Stock_Price:  97.58873946816433
curr_Factors:  [97.58873947]
mat_Sqrt:  [[0.15]]
grads:  [0.08823202]
Stock Position:  0.08823201510940937
Bond Position:  [20.9785378]


portfolio before change:  [29.51391948]
curr_Stock_Price:  96.7081981874745
curr_Factors:  [96.70819819]
mat_Sqrt:  [[0.15]]
grads:  [0.01844883]
Stock Position:  0.01844883483541738
Bond Position:  [27.72976591]


portfolio before change:  [29.52114044]
curr_Stock_Price:  96.91170823243864
curr_Factors:  [96.91170823]
mat_Sqrt:  [[0.15]]
grads:  [0.10236005]
Stock Position:  0.10236004762872038
Bond Position:  [19.60125337]


portfolio before change:  [29.59608964]
curr_Stock_Price:  97.61998157405337
curr_Factors:  [97.61998157]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427937]
Stock Position:  -0.024279368496279152
Bond Position:  [31.96624115]


portfolio before change:  [29.5904557]
curr_Stock_Price:  98.01661349105242
curr_Factors:  [98.01661349]
mat_Sqrt:  [[0.15]]
grads:  [-0.07391821]
Stock Position:  -0.07391820664568226
Bond Position:  [36.83566799]


portfolio before change:  [29.66240744]
curr_Stock_Price:  97.10551198730371
curr_Factors:  [97.10551199]
mat_Sqrt:  [[0.15]]
grads:  [-0.08665201]
Stock Position:  -0.0866520077221645
Bond Position:  [38.07679501]


portfolio before change:  [29.61811251]
curr_Stock_Price:  97.67162496249935
curr_Factors:  [97.67162496]
mat_Sqrt:  [[0.15]]
grads:  [0.17743042]
Stock Position:  0.1774304181116525
Bond Position:  [12.28819525]


portfolio before change:  [29.68977669]
curr_Stock_Price:  98.06686754890733
curr_Factors:  [98.06686755]
mat_Sqrt:  [[0.15]]
grads:  [0.06394223]
Stock Position:  0.06394223354421028
Bond Position:  [23.41916214]


portfolio before change:  [29.69785227]
curr_Stock_Price:  98.14737779606615
curr_Factors:  [98.1473778]
mat_Sqrt:  [[0.15]]
grads:  [-0.07443952]
Stock Position:  -0.07443951739709148
Bond Position:  [37.00389571]


portfolio before change:  [29.72994918]
curr_Stock_Price:  97.77833813447623
curr_Factors:  [97.77833813]
mat_Sqrt:  [[0.15]]
grads:  [-0.32237951]
Stock Position:  -0.3223795086771581
Bond Position:  [61.25168179]


portfolio before change:  [29.8513168]
curr_Stock_Price:  97.42561508352603
curr_Factors:  [97.42561508]
mat_Sqrt:  [[0.15]]
grads:  [-0.1509235]
Stock Position:  -0.15092350101925123
Bond Position:  [44.55513172]


portfolio before change:  [29.75246101]
curr_Stock_Price:  98.11752544913672
curr_Factors:  [98.11752545]
mat_Sqrt:  [[0.15]]
grads:  [0.2581579]
Stock Position:  0.2581579003814096
Bond Position:  [4.42264665]


portfolio before change:  [29.61442791]
curr_Stock_Price:  97.58069910725908
curr_Factors:  [97.58069911]
mat_Sqrt:  [[0.15]]
grads:  [0.00635615]
Stock Position:  0.006356151753867758
Bond Position:  [28.99419018]


portfolio before change:  [29.62145294]
curr_Stock_Price:  98.11569779117048
curr_Factors:  [98.11569779]
mat_Sqrt:  [[0.15]]
grads:  [0.04658645]
Stock Position:  0.046586446188465996
Bond Position:  [25.05059127]


portfolio before change:  [29.62042124]
curr_Stock_Price:  98.02633223526279
curr_Factors:  [98.02633224]
mat_Sqrt:  [[0.15]]
grads:  [0.03719485]
Stock Position:  0.037194846484984126
Bond Position:  [25.97434686]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.61438392]
Stock Price:  97.77671931234187
PL:  [29.61438392]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.03012673e-02]
 [ 3.32203534e-02]
 [-1.52178636e-02]
 [-7.19637673e-03]
 [-7.40533774e-03]
 [ 3.29821371e-02]
 [ 3.59156240e-03]
 [ 3.48159714e-03]
 [-2.64385091e-02]
 [ 2.34045473e-02]
 [ 1.95585541e-02]
 [-1.43883479e-02]
 [ 1.26026008e-04]
 [ 6.60339164e-03]
 [-1.30947285e-02]
 [ 4.93689782e-04]
 [-6.11886171e-03]
 [ 7.03949216e-03]
 [ 1.33664021e-02]
 [ 1.52210081e-02]
 [-1.81581907e-03]
 [-6.04523182e-03]
 [ 6.18284037e-03]
 [-1.08109799e-02]
 [ 3.92008503e-03]
 [ 8.00146037e-03]
 [-2.56897669e-03]
 [ 4.80928944e-04]
 [ 1.66016573e-03]
 [-6.59130297e-03]
 [-2.89679384e-02]
 [ 1.90653579e-02]
 [-3.41206766e-03]
 [-2.10821397e-02]
 [-2.03451506e-02]
 [ 2.43115358e-02]
 [ 4.05095581e-03]
 [ 9.10953733e-03]
 [ 7.93338028e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.83046019]
curr_Stock_Price:  99.42079108407026
curr_Factors:  [99.42079108]
mat_Sqrt:  [[0.15]]
grads:  [-0.06867512]
Stock Position:  -0.06867511557184312
Bond Position:  [-4.00272588]


portfolio before change:  [-10.84188025]
curr_Stock_Price:  99.57979609193632
curr_Factors:  [99.57979609]
mat_Sqrt:  [[0.15]]
grads:  [0.22146902]
Stock Position:  0.22146902283952274
Bond Position:  [-32.89572039]


portfolio before change:  [-11.17989425]
curr_Stock_Price:  98.0721280210865
curr_Factors:  [98.07212802]
mat_Sqrt:  [[0.15]]
grads:  [-0.10145242]
Stock Position:  -0.10145242400530331
Bond Position:  [-1.23023913]


portfolio before change:  [-11.26221497]
curr_Stock_Price:  98.88203409853557
curr_Factors:  [98.8820341]
mat_Sqrt:  [[0.15]]
grads:  [-0.04797584]
Stock Position:  -0.047975844895766465
Bond Position:  [-6.51826584]


portfolio before change:  [-11.30324324]
curr_Stock_Price:  99.72023582665581
curr_Factors:  [99.72023583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04936892]
Stock Position:  -0.049368918279627784
Bond Position:  [-6.38016307]


portfolio before change:  [-11.25882118]
curr_Stock_Price:  98.80428230950702
curr_Factors:  [98.80428231]
mat_Sqrt:  [[0.15]]
grads:  [0.21988091]
Stock Position:  0.21988091373287796
Bond Position:  [-32.98399705]


portfolio before change:  [-11.07487429]
curr_Stock_Price:  99.6596095977348
curr_Factors:  [99.6596096]
mat_Sqrt:  [[0.15]]
grads:  [0.02394375]
Stock Position:  0.023943749306256916
Bond Position:  [-13.461099]


portfolio before change:  [-11.06765082]
curr_Stock_Price:  100.03157355040837
curr_Factors:  [100.03157355]
mat_Sqrt:  [[0.15]]
grads:  [0.02321065]
Stock Position:  0.02321064761853557
Bond Position:  [-13.38944843]


portfolio before change:  [-11.0662257]
curr_Stock_Price:  100.16508581370175
curr_Factors:  [100.16508581]
mat_Sqrt:  [[0.15]]
grads:  [-0.17625673]
Stock Position:  -0.17625672756900645
Bond Position:  [6.58854454]


portfolio before change:  [-10.97496456]
curr_Stock_Price:  99.65198471885078
curr_Factors:  [99.65198472]
mat_Sqrt:  [[0.15]]
grads:  [0.15603032]
Stock Position:  0.15603031542595902
Bond Position:  [-26.52369517]


portfolio before change:  [-10.99312027]
curr_Stock_Price:  99.55687476153656
curr_Factors:  [99.55687476]
mat_Sqrt:  [[0.15]]
grads:  [0.13039036]
Stock Position:  0.13039036097199275
Bond Position:  [-23.97437711]


portfolio before change:  [-11.0579731]
curr_Stock_Price:  99.08248503014636
curr_Factors:  [99.08248503]
mat_Sqrt:  [[0.15]]
grads:  [-0.09592232]
Stock Position:  -0.09592231964869652
Bond Position:  [-1.5537513]


portfolio before change:  [-10.98216297]
curr_Stock_Price:  98.29013179334869
curr_Factors:  [98.29013179]
mat_Sqrt:  [[0.15]]
grads:  [0.00084017]
Stock Position:  0.0008401733888656223
Bond Position:  [-11.06474372]


portfolio before change:  [-10.98332918]
curr_Stock_Price:  98.54837932003876
curr_Factors:  [98.54837932]
mat_Sqrt:  [[0.15]]
grads:  [0.04402261]
Stock Position:  0.04402261093799311
Bond Position:  [-15.32168614]


portfolio before change:  [-10.98458585]
curr_Stock_Price:  98.56334104812397
curr_Factors:  [98.56334105]
mat_Sqrt:  [[0.15]]
grads:  [-0.08729819]
Stock Position:  -0.08729819019923186
Bond Position:  [-2.38018456]


portfolio before change:  [-10.97875302]
curr_Stock_Price:  98.49311762867494
curr_Factors:  [98.49311763]
mat_Sqrt:  [[0.15]]
grads:  [0.00329127]
Stock Position:  0.003291265213398748
Bond Position:  [-11.30291999]


portfolio before change:  [-10.97495279]
curr_Stock_Price:  100.07706248198073
curr_Factors:  [100.07706248]
mat_Sqrt:  [[0.15]]
grads:  [-0.04079241]
Stock Position:  -0.040792411381679376
Bond Position:  [-6.89256809]


portfolio before change:  [-11.05471867]
curr_Stock_Price:  102.01135002986842
curr_Factors:  [102.01135003]
mat_Sqrt:  [[0.15]]
grads:  [0.04692995]
Stock Position:  0.04692994775468166
Bond Position:  [-15.84210599]


portfolio before change:  [-11.05194188]
curr_Stock_Price:  102.11271759134361
curr_Factors:  [102.11271759]
mat_Sqrt:  [[0.15]]
grads:  [0.08910935]
Stock Position:  0.08910934706158147
Bond Position:  [-20.15113947]


portfolio before change:  [-10.98145507]
curr_Stock_Price:  102.93200158025914
curr_Factors:  [102.93200158]
mat_Sqrt:  [[0.15]]
grads:  [0.10147339]
Stock Position:  0.10147338708214396
Bond Position:  [-21.42631391]


portfolio before change:  [-11.06117678]
curr_Stock_Price:  102.17275565443157
curr_Factors:  [102.17275565]
mat_Sqrt:  [[0.15]]
grads:  [-0.01210546]
Stock Position:  -0.012105460484221661
Bond Position:  [-9.82432852]


portfolio before change:  [-11.05681574]
curr_Stock_Price:  101.71104975438149
curr_Factors:  [101.71104975]
mat_Sqrt:  [[0.15]]
grads:  [-0.04030155]
Stock Position:  -0.04030154544572601
Bond Position:  [-6.95770324]


portfolio before change:  [-11.0169642]
curr_Stock_Price:  100.70063426498962
curr_Factors:  [100.70063426]
mat_Sqrt:  [[0.15]]
grads:  [0.04121894]
Stock Position:  0.04121893580131382
Bond Position:  [-15.16773718]


portfolio before change:  [-11.00383595]
curr_Stock_Price:  101.06513502148603
curr_Factors:  [101.06513502]
mat_Sqrt:  [[0.15]]
grads:  [-0.0720732]
Stock Position:  -0.072073199175249
Bond Position:  [-3.71974834]


portfolio before change:  [-11.04965343]
curr_Stock_Price:  101.69439085709088
curr_Factors:  [101.69439086]
mat_Sqrt:  [[0.15]]
grads:  [0.0261339]
Stock Position:  0.026133900201697095
Bond Position:  [-13.70732449]


portfolio before change:  [-11.09121823]
curr_Stock_Price:  100.1695026547155
curr_Factors:  [100.16950265]
mat_Sqrt:  [[0.15]]
grads:  [0.05334307]
Stock Position:  0.0533430691455017
Bond Position:  [-16.43456693]


portfolio before change:  [-11.0043505]
curr_Stock_Price:  101.83648912451451
curr_Factors:  [101.83648912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01712651]
Stock Position:  -0.01712651129384478
Bond Position:  [-9.26024672]


portfolio before change:  [-11.01363991]
curr_Stock_Price:  102.31129715320917
curr_Factors:  [102.31129715]
mat_Sqrt:  [[0.15]]
grads:  [0.00320619]
Stock Position:  0.003206192958977022
Bond Position:  [-11.34166967]


portfolio before change:  [-11.01764046]
curr_Stock_Price:  101.50574745743842
curr_Factors:  [101.50574746]
mat_Sqrt:  [[0.15]]
grads:  [0.01106777]
Stock Position:  0.011067771565870826
Bond Position:  [-12.14108288]


portfolio before change:  [-11.02176633]
curr_Stock_Price:  101.27009521346372
curr_Factors:  [101.27009521]
mat_Sqrt:  [[0.15]]
grads:  [-0.04394202]
Stock Position:  -0.04394201981901063
Bond Position:  [-6.5717538]


portfolio before change:  [-11.00750579]
curr_Stock_Price:  100.92686876631677
curr_Factors:  [100.92686877]
mat_Sqrt:  [[0.15]]
grads:  [-0.19311959]
Stock Position:  -0.19311958951381905
Bond Position:  [8.48344968]


portfolio before change:  [-10.98306996]
curr_Stock_Price:  100.80582807516497
curr_Factors:  [100.80582808]
mat_Sqrt:  [[0.15]]
grads:  [0.12710239]
Stock Position:  0.1271023859445451
Bond Position:  [-23.79573123]


portfolio before change:  [-10.80424247]
curr_Stock_Price:  102.23618790833385
curr_Factors:  [102.23618791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02274712]
Stock Position:  -0.022747117711743994
Bond Position:  [-8.47866387]


portfolio before change:  [-10.81895968]
curr_Stock_Price:  102.83658535791682
curr_Factors:  [102.83658536]
mat_Sqrt:  [[0.15]]
grads:  [-0.1405476]
Stock Position:  -0.14054759789209736
Bond Position:  [3.63447537]


portfolio before change:  [-10.82802141]
curr_Stock_Price:  102.90429246252914
curr_Factors:  [102.90429246]
mat_Sqrt:  [[0.15]]
grads:  [-0.13563434]
Stock Position:  -0.1356343373696817
Bond Position:  [3.12933411]


portfolio before change:  [-10.668616]
curr_Stock_Price:  101.73191807800968
curr_Factors:  [101.73191808]
mat_Sqrt:  [[0.15]]
grads:  [0.16207691]
Stock Position:  0.162076905199013
Bond Position:  [-27.15701044]


portfolio before change:  [-10.8801166]
curr_Stock_Price:  100.44792415049325
curr_Factors:  [100.44792415]
mat_Sqrt:  [[0.15]]
grads:  [0.02700637]
Stock Position:  0.02700637203595801
Bond Position:  [-13.59285061]


portfolio before change:  [-10.88778082]
curr_Stock_Price:  100.22705006972186
curr_Factors:  [100.22705007]
mat_Sqrt:  [[0.15]]
grads:  [0.06073025]
Stock Position:  0.06073024883794704
Bond Position:  [-16.97459451]


portfolio before change:  [-10.82435028]
curr_Stock_Price:  101.30645446283881
curr_Factors:  [101.30645446]
mat_Sqrt:  [[0.15]]
grads:  [0.0528892]
Stock Position:  0.052889201885374625
Bond Position:  [-16.1823678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.88851132]
Stock Price:  100.13158097115493
PL:  [-11.02009229]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 7.52409293e-03]
 [ 1.57088270e-02]
 [-1.60248987e-02]
 [-6.94315484e-03]
 [-7.47162609e-03]
 [ 2.97733205e-02]
 [ 3.56792429e-03]
 [-1.40985672e-03]
 [-2.43616603e-02]
 [ 2.31668013e-02]
 [ 1.94796875e-02]
 [-1.52337136e-02]
 [ 3.17987131e-02]
 [ 1.75571145e-02]
 [-1.16207745e-02]
 [-3.16009994e-03]
 [-4.39528192e-03]
 [ 7.66785706e-03]
 [ 2.38311839e-02]
 [-4.12213020e-03]
 [-1.05864453e-03]
 [-2.35456591e-02]
 [ 7.63793958e-03]
 [-5.53439628e-03]
 [-1.07891154e-02]
 [ 4.77007209e-03]
 [ 6.70387949e-03]
 [ 3.20354351e-03]
 [ 5.50456607e-03]
 [ 1.38501239e-02]
 [-1.55369315e-02]
 [ 4.03563809e-03]
 [ 7.12068109e-03]
 [ 2.04122430e-02]
 [-2.00120124e-02]
 [-1.21276196e-02]
 [ 1.47394766e-02]
 [ 1.95382695e-02]
 [ 8.39489997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.70305444]
curr_Stock_Price:  99.01667944988183
curr_Factors:  [99.01667945]
mat_Sqrt:  [[0.15]]
grads:  [0.05016062]
Stock Position:  0.050160619563004556
Bond Position:  [-24.66979243]


portfolio before change:  [-19.71719635]
curr_Stock_Price:  98.79622772528123
curr_Factors:  [98.79622773]
mat_Sqrt:  [[0.15]]
grads:  [0.10472551]
Stock Position:  0.10472551354872434
Bond Position:  [-30.06368204]


portfolio before change:  [-19.75845068]
curr_Stock_Price:  98.43818577774267
curr_Factors:  [98.43818578]
mat_Sqrt:  [[0.15]]
grads:  [-0.10683266]
Stock Position:  -0.10683265792689098
Bond Position:  [-9.24203765]


portfolio before change:  [-19.83094071]
curr_Stock_Price:  99.10590956529917
curr_Factors:  [99.10590957]
mat_Sqrt:  [[0.15]]
grads:  [-0.0462877]
Stock Position:  -0.04628769890255517
Bond Position:  [-15.24355621]


portfolio before change:  [-19.84658299]
curr_Stock_Price:  99.40267763767106
curr_Factors:  [99.40267764]
mat_Sqrt:  [[0.15]]
grads:  [-0.04981084]
Stock Position:  -0.04981084057711192
Bond Position:  [-14.89525206]


portfolio before change:  [-19.83113535]
curr_Stock_Price:  99.05516971300635
curr_Factors:  [99.05516971]
mat_Sqrt:  [[0.15]]
grads:  [0.1984888]
Stock Position:  0.19848880351396384
Bond Position:  [-39.49247746]


portfolio before change:  [-19.74624323]
curr_Stock_Price:  99.50773418470573
curr_Factors:  [99.50773418]
mat_Sqrt:  [[0.15]]
grads:  [0.02378616]
Stock Position:  0.02378616192463614
Bond Position:  [-22.11315031]


portfolio before change:  [-19.74790678]
curr_Stock_Price:  99.55401213762926
curr_Factors:  [99.55401214]
mat_Sqrt:  [[0.15]]
grads:  [-0.00939904]
Stock Position:  -0.009399044823796804
Bond Position:  [-18.81219415]


portfolio before change:  [-19.75901222]
curr_Stock_Price:  100.48535906182391
curr_Factors:  [100.48535906]
mat_Sqrt:  [[0.15]]
grads:  [-0.16241107]
Stock Position:  -0.16241106842816472
Bond Position:  [-3.43907769]


portfolio before change:  [-19.85265126]
curr_Stock_Price:  101.05926777785727
curr_Factors:  [101.05926778]
mat_Sqrt:  [[0.15]]
grads:  [0.15444534]
Stock Position:  0.15444534215343417
Bond Position:  [-35.46078445]


portfolio before change:  [-19.92565007]
curr_Stock_Price:  100.61531822949695
curr_Factors:  [100.61531823]
mat_Sqrt:  [[0.15]]
grads:  [0.12986458]
Stock Position:  0.12986458343447496
Bond Position:  [-32.99201646]


portfolio before change:  [-20.06820728]
curr_Stock_Price:  99.549338995451
curr_Factors:  [99.549339]
mat_Sqrt:  [[0.15]]
grads:  [-0.10155809]
Stock Position:  -0.10155809035838698
Bond Position:  [-9.95816652]


portfolio before change:  [-20.19428171]
curr_Stock_Price:  100.77848361115264
curr_Factors:  [100.77848361]
mat_Sqrt:  [[0.15]]
grads:  [0.21199142]
Stock Position:  0.21199142051722747
Bond Position:  [-41.55845561]


portfolio before change:  [-20.07111282]
curr_Stock_Price:  101.38399877385561
curr_Factors:  [101.38399877]
mat_Sqrt:  [[0.15]]
grads:  [0.11704743]
Stock Position:  0.11704743009102207
Bond Position:  [-31.93784933]


portfolio before change:  [-19.944918]
curr_Stock_Price:  102.49625984478195
curr_Factors:  [102.49625984]
mat_Sqrt:  [[0.15]]
grads:  [-0.07747183]
Stock Position:  -0.07747183011711907
Bond Position:  [-12.00434517]


portfolio before change:  [-19.97977879]
curr_Stock_Price:  102.92686996695898
curr_Factors:  [102.92686997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02106733]
Stock Position:  -0.021067332911397143
Bond Position:  [-17.81138416]


portfolio before change:  [-20.02300358]
curr_Stock_Price:  104.87292677091884
curr_Factors:  [104.87292677]
mat_Sqrt:  [[0.15]]
grads:  [-0.02930188]
Stock Position:  -0.029301879452887977
Bond Position:  [-16.95002973]


portfolio before change:  [-20.03487666]
curr_Stock_Price:  105.20581304824427
curr_Factors:  [105.20581305]
mat_Sqrt:  [[0.15]]
grads:  [0.05111905]
Stock Position:  0.051119047052260204
Bond Position:  [-25.41289757]


portfolio before change:  [-20.06669166]
curr_Stock_Price:  104.64558768898024
curr_Factors:  [104.64558769]
mat_Sqrt:  [[0.15]]
grads:  [0.15887456]
Stock Position:  0.15887455930106914
Bond Position:  [-36.69221329]


portfolio before change:  [-19.98395842]
curr_Stock_Price:  105.19520403332473
curr_Factors:  [105.19520403]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748087]
Stock Position:  -0.02748086803142812
Bond Position:  [-17.0931029]


portfolio before change:  [-20.01866172]
curr_Stock_Price:  106.38026606515446
curr_Factors:  [106.38026607]
mat_Sqrt:  [[0.15]]
grads:  [-0.00705763]
Stock Position:  -0.007057630223042365
Bond Position:  [-19.26786914]


portfolio before change:  [-20.02146524]
curr_Stock_Price:  106.43621669705891
curr_Factors:  [106.4362167]
mat_Sqrt:  [[0.15]]
grads:  [-0.15697106]
Stock Position:  -0.1569710604049097
Bond Position:  [-3.31405944]


portfolio before change:  [-19.94477806]
curr_Stock_Price:  105.94503405187076
curr_Factors:  [105.94503405]
mat_Sqrt:  [[0.15]]
grads:  [0.0509196]
Stock Position:  0.05091959719843246
Bond Position:  [-25.33945652]


portfolio before change:  [-19.92989067]
curr_Stock_Price:  106.29961313732669
curr_Factors:  [106.29961314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689598]
Stock Position:  -0.03689597519621414
Bond Position:  [-16.00786278]


portfolio before change:  [-19.93968965]
curr_Stock_Price:  106.51096079998082
curr_Factors:  [106.5109608]
mat_Sqrt:  [[0.15]]
grads:  [-0.07192744]
Stock Position:  -0.07192743573352971
Bond Position:  [-12.27862936]


portfolio before change:  [-19.90246447]
curr_Stock_Price:  105.9720828284711
curr_Factors:  [105.97208283]
mat_Sqrt:  [[0.15]]
grads:  [0.03180048]
Stock Position:  0.03180048061470263
Bond Position:  [-23.27242763]


portfolio before change:  [-19.87668571]
curr_Stock_Price:  106.87420731686748
curr_Factors:  [106.87420732]
mat_Sqrt:  [[0.15]]
grads:  [0.04469253]
Stock Position:  0.0446925299554867
Bond Position:  [-24.65316442]


portfolio before change:  [-19.90347538]
curr_Stock_Price:  106.34374204126969
curr_Factors:  [106.34374204]
mat_Sqrt:  [[0.15]]
grads:  [0.02135696]
Stock Position:  0.021356956735055634
Bond Position:  [-22.17465408]


portfolio before change:  [-19.88650648]
curr_Stock_Price:  107.26807366116074
curr_Factors:  [107.26807366]
mat_Sqrt:  [[0.15]]
grads:  [0.03669711]
Stock Position:  0.036697107130312843
Bond Position:  [-23.82293447]


portfolio before change:  [-19.85375975]
curr_Stock_Price:  108.24157767796494
curr_Factors:  [108.24157768]
mat_Sqrt:  [[0.15]]
grads:  [0.09233416]
Stock Position:  0.09233415912338197
Bond Position:  [-29.84815481]


portfolio before change:  [-19.9242969]
curr_Stock_Price:  107.51805450490589
curr_Factors:  [107.5180545]
mat_Sqrt:  [[0.15]]
grads:  [-0.10357954]
Stock Position:  -0.10357954303556738
Bond Position:  [-8.78762595]


portfolio before change:  [-19.8303566]
curr_Stock_Price:  106.60051012481075
curr_Factors:  [106.60051012]
mat_Sqrt:  [[0.15]]
grads:  [0.02690425]
Stock Position:  0.026904253950091214
Bond Position:  [-22.69836379]


portfolio before change:  [-19.84654679]
curr_Stock_Price:  106.10420496055623
curr_Factors:  [106.10420496]
mat_Sqrt:  [[0.15]]
grads:  [0.04747121]
Stock Position:  0.04747120729322935
Bond Position:  [-24.8834415]


portfolio before change:  [-19.90159677]
curr_Stock_Price:  105.01008157164559
curr_Factors:  [105.01008157]
mat_Sqrt:  [[0.15]]
grads:  [0.13608162]
Stock Position:  0.13608162007309388
Bond Position:  [-34.1915388]


portfolio before change:  [-19.61572691]
curr_Stock_Price:  107.14221431258547
curr_Factors:  [107.14221431]
mat_Sqrt:  [[0.15]]
grads:  [-0.13341342]
Stock Position:  -0.13341341597383544
Bond Position:  [-5.3215181]


portfolio before change:  [-19.46217161]
curr_Stock_Price:  105.98625467684288
curr_Factors:  [105.98625468]
mat_Sqrt:  [[0.15]]
grads:  [-0.0808508]
Stock Position:  -0.0808507976384381
Bond Position:  [-10.89309838]


portfolio before change:  [-19.4564861]
curr_Stock_Price:  105.89909122730862
curr_Factors:  [105.89909123]
mat_Sqrt:  [[0.15]]
grads:  [0.09826318]
Stock Position:  0.09826317763762471
Bond Position:  [-29.86246731]


portfolio before change:  [-19.46396864]
curr_Stock_Price:  105.86093350125135
curr_Factors:  [105.8609335]
mat_Sqrt:  [[0.15]]
grads:  [0.13025513]
Stock Position:  0.13025513014033488
Bond Position:  [-33.25289831]


portfolio before change:  [-19.35753506]
curr_Stock_Price:  106.70996304473522
curr_Factors:  [106.70996304]
mat_Sqrt:  [[0.15]]
grads:  [0.055966]
Stock Position:  0.05596599978637671
Bond Position:  [-25.32966483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.36960836]
Stock Price:  106.5508147017537
PL:  [-25.92042307]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.02897194e-02]
 [ 1.94286053e-02]
 [-1.68027151e-02]
 [-6.97785991e-03]
 [-6.88287482e-03]
 [ 4.02682416e-02]
 [ 3.56590651e-03]
 [-1.10117699e-04]
 [ 1.29732755e-02]
 [ 2.34439430e-02]
 [ 2.17839447e-02]
 [-2.84692462e-03]
 [-3.07014348e-02]
 [ 1.65116039e-02]
 [ 2.98108824e-03]
 [-2.29338568e-03]
 [-6.03134015e-03]
 [-1.21781412e-02]
 [ 1.60212645e-03]
 [ 1.52638542e-02]
 [-2.64666892e-02]
 [-2.50839151e-02]
 [ 4.34367457e-03]
 [-1.14955246e-02]
 [ 1.14175548e-02]
 [-1.33328480e-03]
 [ 2.57964993e-02]
 [-4.68141219e-03]
 [-3.21807478e-02]
 [-1.11135142e-02]
 [ 4.69436465e-02]
 [ 6.94217326e-04]
 [-1.75227041e-02]
 [-3.74905911e-02]
 [-2.33511634e-02]
 [ 3.64303555e-02]
 [ 6.67463315e-04]
 [ 6.87961803e-03]
 [ 6.81251860e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.64017789]
curr_Stock_Price:  99.56609584612008
curr_Factors:  [99.56609585]
mat_Sqrt:  [[0.15]]
grads:  [-0.06859813]
Stock Position:  -0.06859812948958091
Bond Position:  [-0.81012995]


portfolio before change:  [-7.59661006]
curr_Stock_Price:  98.92950262157218
curr_Factors:  [98.92950262]
mat_Sqrt:  [[0.15]]
grads:  [0.12952404]
Stock Position:  0.12952403506144677
Bond Position:  [-20.41035842]


portfolio before change:  [-7.64155622]
curr_Stock_Price:  98.60219110177715
curr_Factors:  [98.6021911]
mat_Sqrt:  [[0.15]]
grads:  [-0.1120181]
Stock Position:  -0.11201810082266755
Bond Position:  [3.40367397]


portfolio before change:  [-7.69468237]
curr_Stock_Price:  99.0802535029058
curr_Factors:  [99.0802535]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651907]
Stock Position:  -0.046519066089273926
Bond Position:  [-3.08556151]


portfolio before change:  [-7.7000677]
curr_Stock_Price:  99.18772787526548
curr_Factors:  [99.18772788]
mat_Sqrt:  [[0.15]]
grads:  [-0.04588583]
Stock Position:  -0.04588583215978074
Bond Position:  [-3.14875627]


portfolio before change:  [-7.65612407]
curr_Stock_Price:  98.22147652461611
curr_Factors:  [98.22147652]
mat_Sqrt:  [[0.15]]
grads:  [0.26845494]
Stock Position:  0.2684549440300401
Bond Position:  [-34.02416506]


portfolio before change:  [-7.87310887]
curr_Stock_Price:  97.42904742726098
curr_Factors:  [97.42904743]
mat_Sqrt:  [[0.15]]
grads:  [0.02377271]
Stock Position:  0.02377271008571175
Bond Position:  [-10.18926137]


portfolio before change:  [-7.86732001]
curr_Stock_Price:  97.72613561839933
curr_Factors:  [97.72613562]
mat_Sqrt:  [[0.15]]
grads:  [-0.00073412]
Stock Position:  -0.000734117990456298
Bond Position:  [-7.7955775]


portfolio before change:  [-7.86798624]
curr_Stock_Price:  97.30620475403401
curr_Factors:  [97.30620475]
mat_Sqrt:  [[0.15]]
grads:  [0.0864885]
Stock Position:  0.08648850360927848
Bond Position:  [-16.28385429]


portfolio before change:  [-7.84588921]
curr_Stock_Price:  97.58523189245048
curr_Factors:  [97.58523189]
mat_Sqrt:  [[0.15]]
grads:  [0.15629295]
Stock Position:  0.15629295326447298
Bond Position:  [-23.0977733]


portfolio before change:  [-8.06301523]
curr_Stock_Price:  96.21448156619894
curr_Factors:  [96.21448157]
mat_Sqrt:  [[0.15]]
grads:  [0.1452263]
Stock Position:  0.14522629773057272
Bond Position:  [-22.03588818]


portfolio before change:  [-8.21656848]
curr_Stock_Price:  95.17611187778229
curr_Factors:  [95.17611188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0189795]
Stock Position:  -0.018979497436670285
Bond Position:  [-6.4101737]


portfolio before change:  [-8.20903815]
curr_Stock_Price:  94.73713033445874
curr_Factors:  [94.73713033]
mat_Sqrt:  [[0.15]]
grads:  [-0.20467623]
Stock Position:  -0.20467623179411934
Bond Position:  [11.1814007]


portfolio before change:  [-8.19268769]
curr_Stock_Price:  94.66407497753387
curr_Factors:  [94.66407498]
mat_Sqrt:  [[0.15]]
grads:  [0.11007736]
Stock Position:  0.11007735931399465
Bond Position:  [-18.61305909]


portfolio before change:  [-8.20982324]
curr_Stock_Price:  94.5295443798155
curr_Factors:  [94.52954438]
mat_Sqrt:  [[0.15]]
grads:  [0.01987392]
Stock Position:  0.019873921633000148
Bond Position:  [-10.088496]


portfolio before change:  [-8.21490729]
curr_Stock_Price:  94.33718642929354
curr_Factors:  [94.33718643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528924]
Stock Position:  -0.015289237859931661
Bond Position:  [-6.77256361]


portfolio before change:  [-8.21602618]
curr_Stock_Price:  94.35499389545349
curr_Factors:  [94.3549939]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020893]
Stock Position:  -0.04020893430580331
Bond Position:  [-4.42211242]


portfolio before change:  [-8.19087307]
curr_Stock_Price:  93.71568569066406
curr_Factors:  [93.71568569]
mat_Sqrt:  [[0.15]]
grads:  [-0.08118761]
Stock Position:  -0.08118760781148418
Bond Position:  [-0.58232074]


portfolio before change:  [-8.14452605]
curr_Stock_Price:  93.14392587240576
curr_Factors:  [93.14392587]
mat_Sqrt:  [[0.15]]
grads:  [0.01068084]
Stock Position:  0.010680843019664252
Bond Position:  [-9.13938171]


portfolio before change:  [-8.13259841]
curr_Stock_Price:  94.36762507959105
curr_Factors:  [94.36762508]
mat_Sqrt:  [[0.15]]
grads:  [0.10175903]
Stock Position:  0.10175902807206229
Bond Position:  [-17.73535622]


portfolio before change:  [-8.29806189]
curr_Stock_Price:  92.76337996352756
curr_Factors:  [92.76337996]
mat_Sqrt:  [[0.15]]
grads:  [-0.17644459]
Stock Position:  -0.17644459451412284
Bond Position:  [8.06953507]


portfolio before change:  [-8.52084633]
curr_Stock_Price:  94.03172820198199
curr_Factors:  [94.0317282]
mat_Sqrt:  [[0.15]]
grads:  [-0.1672261]
Stock Position:  -0.16722610075087246
Bond Position:  [7.20371293]


portfolio before change:  [-8.63883637]
curr_Stock_Price:  94.74268518204958
curr_Factors:  [94.74268518]
mat_Sqrt:  [[0.15]]
grads:  [0.02895783]
Stock Position:  0.028957830469034045
Bond Position:  [-11.38237899]


portfolio before change:  [-8.63332825]
curr_Stock_Price:  94.9820334504347
curr_Factors:  [94.98203345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07663683]
Stock Position:  -0.07663683084180219
Bond Position:  [-1.35420622]


portfolio before change:  [-8.67705525]
curr_Stock_Price:  95.55039876525595
curr_Factors:  [95.55039877]
mat_Sqrt:  [[0.15]]
grads:  [0.07611703]
Stock Position:  0.07611703214383932
Bond Position:  [-15.95006803]


portfolio before change:  [-8.75757051]
curr_Stock_Price:  94.51881136710719
curr_Factors:  [94.51881137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00888857]
Stock Position:  -0.008888565346448739
Bond Position:  [-7.91743388]


portfolio before change:  [-8.76417329]
curr_Stock_Price:  95.15030100246757
curr_Factors:  [95.150301]
mat_Sqrt:  [[0.15]]
grads:  [0.17197666]
Stock Position:  0.1719766618810755
Bond Position:  [-25.12780443]


portfolio before change:  [-8.77363207]
curr_Stock_Price:  95.11356570228457
curr_Factors:  [95.1135657]
mat_Sqrt:  [[0.15]]
grads:  [-0.03120941]
Stock Position:  -0.03120941461941578
Bond Position:  [-5.80519336]


portfolio before change:  [-8.7838135]
curr_Stock_Price:  95.41654260846889
curr_Factors:  [95.41654261]
mat_Sqrt:  [[0.15]]
grads:  [-0.21453832]
Stock Position:  -0.21453831873813348
Bond Position:  [11.68669113]


portfolio before change:  [-8.93338948]
curr_Stock_Price:  96.12055160625398
curr_Factors:  [96.12055161]
mat_Sqrt:  [[0.15]]
grads:  [-0.07409009]
Stock Position:  -0.07409009495509601
Bond Position:  [-1.81180868]


portfolio before change:  [-8.82656013]
curr_Stock_Price:  94.675610358636
curr_Factors:  [94.67561036]
mat_Sqrt:  [[0.15]]
grads:  [0.31295764]
Stock Position:  0.31295764338212767
Bond Position:  [-38.45601604]


portfolio before change:  [-8.67271962]
curr_Stock_Price:  95.18254098817391
curr_Factors:  [95.18254099]
mat_Sqrt:  [[0.15]]
grads:  [0.00462812]
Stock Position:  0.004628115508204205
Bond Position:  [-9.11323541]


portfolio before change:  [-8.67083111]
curr_Stock_Price:  95.836744997905
curr_Factors:  [95.836745]
mat_Sqrt:  [[0.15]]
grads:  [-0.11681803]
Stock Position:  -0.11681802731774076
Bond Position:  [2.52462838]


portfolio before change:  [-8.66735315]
curr_Stock_Price:  95.80967410733848
curr_Factors:  [95.80967411]
mat_Sqrt:  [[0.15]]
grads:  [-0.24993727]
Stock Position:  -0.24993727387058842
Bond Position:  [15.27905561]


portfolio before change:  [-8.54947083]
curr_Stock_Price:  95.34566841699483
curr_Factors:  [95.34566842]
mat_Sqrt:  [[0.15]]
grads:  [-0.15567442]
Stock Position:  -0.15567442262485476
Bond Position:  [6.29341105]


portfolio before change:  [-8.55034487]
curr_Stock_Price:  95.35633663327904
curr_Factors:  [95.35633663]
mat_Sqrt:  [[0.15]]
grads:  [0.24286904]
Stock Position:  0.24286903638922627
Bond Position:  [-31.70944646]


portfolio before change:  [-8.0411063]
curr_Stock_Price:  97.46941992795989
curr_Factors:  [97.46941993]
mat_Sqrt:  [[0.15]]
grads:  [0.00444976]
Stock Position:  0.004449755433990709
Bond Position:  [-8.47482138]


portfolio before change:  [-8.04086221]
curr_Stock_Price:  97.7623595864267
curr_Factors:  [97.76235959]
mat_Sqrt:  [[0.15]]
grads:  [0.04586412]
Stock Position:  0.04586412021109969
Bond Position:  [-12.52464682]


portfolio before change:  [-8.04405732]
curr_Stock_Price:  97.72683219960292
curr_Factors:  [97.7268322]
mat_Sqrt:  [[0.15]]
grads:  [0.04541679]
Stock Position:  0.04541679064053574
Bond Position:  [-12.4824964]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.08667079]
Stock Price:  96.82291409786414
PL:  [-8.08667079]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-7.40189064e-03]
 [-4.14237214e-03]
 [-1.56924613e-02]
 [-7.29287569e-03]
 [-7.44183302e-03]
 [ 3.26551885e-02]
 [ 3.69317330e-03]
 [ 1.48683708e-02]
 [-2.13746058e-02]
 [ 2.30231665e-02]
 [ 1.91797331e-02]
 [-1.43921147e-02]
 [ 2.28501645e-02]
 [ 6.46418238e-03]
 [-1.63488350e-02]
 [ 7.05014114e-04]
 [-6.03116639e-03]
 [ 3.07214107e-03]
 [ 8.77230261e-04]
 [-1.56562472e-02]
 [-8.01963777e-03]
 [-2.02649107e-02]
 [ 6.49442610e-03]
 [-6.60220839e-03]
 [ 1.50084673e-02]
 [ 8.24570130e-03]
 [-8.32287021e-03]
 [-2.65665342e-03]
 [ 4.28545974e-04]
 [-1.09792352e-02]
 [ 3.69273303e-03]
 [ 1.29483809e-02]
 [-9.76365716e-03]
 [-2.04334048e-02]
 [-2.08964212e-02]
 [ 2.63374034e-02]
 [ 2.47840631e-03]
 [ 1.71076298e-02]
 [ 9.80311691e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.15775213]
curr_Stock_Price:  99.31479212579687
curr_Factors:  [99.31479213]
mat_Sqrt:  [[0.15]]
grads:  [-0.04934594]
Stock Position:  -0.049345937618061886
Bond Position:  [-8.25697059]


portfolio before change:  [-13.08876212]
curr_Stock_Price:  97.89578592231645
curr_Factors:  [97.89578592]
mat_Sqrt:  [[0.15]]
grads:  [-0.02761581]
Stock Position:  -0.02761581428357973
Bond Position:  [-10.38529028]


portfolio before change:  [-13.10142433]
curr_Stock_Price:  98.30728787428978
curr_Factors:  [98.30728787]
mat_Sqrt:  [[0.15]]
grads:  [-0.10461641]
Stock Position:  -0.10461640868204808
Bond Position:  [-2.81686892]


portfolio before change:  [-13.14856743]
curr_Stock_Price:  98.75455017602397
curr_Factors:  [98.75455018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04861917]
Stock Position:  -0.04861917129989506
Bond Position:  [-8.34720304]


portfolio before change:  [-13.20194125]
curr_Stock_Price:  99.83088170926136
curr_Factors:  [99.83088171]
mat_Sqrt:  [[0.15]]
grads:  [-0.04961222]
Stock Position:  -0.04961222010603441
Bond Position:  [-8.24910957]


portfolio before change:  [-13.24116567]
curr_Stock_Price:  100.60071656830812
curr_Factors:  [100.60071657]
mat_Sqrt:  [[0.15]]
grads:  [0.21770126]
Stock Position:  0.2177012569391774
Bond Position:  [-35.14206811]


portfolio before change:  [-13.1148798]
curr_Stock_Price:  101.20098363725728
curr_Factors:  [101.20098364]
mat_Sqrt:  [[0.15]]
grads:  [0.02462116]
Stock Position:  0.02462115534118798
Bond Position:  [-15.60656494]


portfolio before change:  [-13.0985039]
curr_Stock_Price:  101.94533721956738
curr_Factors:  [101.94533722]
mat_Sqrt:  [[0.15]]
grads:  [0.09912247]
Stock Position:  0.09912247181368568
Bond Position:  [-23.20357772]


portfolio before change:  [-13.21940809]
curr_Stock_Price:  100.75485481719357
curr_Factors:  [100.75485482]
mat_Sqrt:  [[0.15]]
grads:  [-0.14249737]
Stock Position:  -0.14249737215982103
Bond Position:  [1.13789396]


portfolio before change:  [-13.33353105]
curr_Stock_Price:  101.55673072024139
curr_Factors:  [101.55673072]
mat_Sqrt:  [[0.15]]
grads:  [0.15348778]
Stock Position:  0.15348777691793525
Bond Position:  [-28.92124788]


portfolio before change:  [-13.540479]
curr_Stock_Price:  100.23198311587358
curr_Factors:  [100.23198312]
mat_Sqrt:  [[0.15]]
grads:  [0.12786489]
Stock Position:  0.12786488700958903
Bond Position:  [-26.35663019]


portfolio before change:  [-13.57623758]
curr_Stock_Price:  99.97809169718566
curr_Factors:  [99.9780917]
mat_Sqrt:  [[0.15]]
grads:  [-0.09594743]
Stock Position:  -0.09594743116653133
Bond Position:  [-3.98359651]


portfolio before change:  [-13.59260483]
curr_Stock_Price:  100.14348712074397
curr_Factors:  [100.14348712]
mat_Sqrt:  [[0.15]]
grads:  [0.15233443]
Stock Position:  0.15233442978069126
Bond Position:  [-28.84790583]


portfolio before change:  [-13.69775861]
curr_Stock_Price:  99.47687765556265
curr_Factors:  [99.47687766]
mat_Sqrt:  [[0.15]]
grads:  [0.04309455]
Stock Position:  0.04309454921314376
Bond Position:  [-17.98466981]


portfolio before change:  [-13.76394761]
curr_Stock_Price:  97.99314533132818
curr_Factors:  [97.99314533]
mat_Sqrt:  [[0.15]]
grads:  [-0.10899223]
Stock Position:  -0.10899223325945107
Bond Position:  [-3.08345586]


portfolio before change:  [-13.76034885]
curr_Stock_Price:  97.95659027871868
curr_Factors:  [97.95659028]
mat_Sqrt:  [[0.15]]
grads:  [0.00470009]
Stock Position:  0.0047000940911082895
Bond Position:  [-14.22075404]


portfolio before change:  [-13.76057008]
curr_Stock_Price:  98.28774927470052
curr_Factors:  [98.28774927]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020778]
Stock Position:  -0.04020777596550249
Bond Position:  [-9.80863828]


portfolio before change:  [-13.76095782]
curr_Stock_Price:  98.26689717089407
curr_Factors:  [98.26689717]
mat_Sqrt:  [[0.15]]
grads:  [0.02048094]
Stock Position:  0.020480940442359607
Bond Position:  [-15.77355629]


portfolio before change:  [-13.79053122]
curr_Stock_Price:  96.91922564558946
curr_Factors:  [96.91922565]
mat_Sqrt:  [[0.15]]
grads:  [0.0058482]
Stock Position:  0.0058482017373751435
Bond Position:  [-14.3573344]


portfolio before change:  [-13.79309122]
curr_Stock_Price:  96.78837878500457
curr_Factors:  [96.78837879]
mat_Sqrt:  [[0.15]]
grads:  [-0.10437498]
Stock Position:  -0.10437498145094494
Bond Position:  [-3.69080598]


portfolio before change:  [-13.81653444]
curr_Stock_Price:  97.00856419862983
curr_Factors:  [97.0085642]
mat_Sqrt:  [[0.15]]
grads:  [-0.05346425]
Stock Position:  -0.05346425179604232
Bond Position:  [-8.63004414]


portfolio before change:  [-13.78236981]
curr_Stock_Price:  96.34936747348027
curr_Factors:  [96.34936747]
mat_Sqrt:  [[0.15]]
grads:  [-0.1350994]
Stock Position:  -0.1350994046810275
Bond Position:  [-0.76562762]


portfolio before change:  [-13.96091392]
curr_Stock_Price:  97.67023493230755
curr_Factors:  [97.67023493]
mat_Sqrt:  [[0.15]]
grads:  [0.04329617]
Stock Position:  0.043296174022421884
Bond Position:  [-18.18966141]


portfolio before change:  [-13.92695006]
curr_Stock_Price:  98.50720749529998
curr_Factors:  [98.5072075]
mat_Sqrt:  [[0.15]]
grads:  [-0.04401472]
Stock Position:  -0.044014722628786924
Bond Position:  [-9.59118265]


portfolio before change:  [-13.93845593]
curr_Stock_Price:  98.74137661141881
curr_Factors:  [98.74137661]
mat_Sqrt:  [[0.15]]
grads:  [0.10005645]
Stock Position:  0.10005644883219199
Bond Position:  [-23.81816742]


portfolio before change:  [-13.84524493]
curr_Stock_Price:  99.70271845613621
curr_Factors:  [99.70271846]
mat_Sqrt:  [[0.15]]
grads:  [0.05497134]
Stock Position:  0.054971341972964084
Bond Position:  [-19.32603716]


portfolio before change:  [-13.8705402]
curr_Stock_Price:  99.28651310581319
curr_Factors:  [99.28651311]
mat_Sqrt:  [[0.15]]
grads:  [-0.0554858]
Stock Position:  -0.055485801373794594
Bond Position:  [-8.36154846]


portfolio before change:  [-13.85350379]
curr_Stock_Price:  98.96063390094527
curr_Factors:  [98.9606339]
mat_Sqrt:  [[0.15]]
grads:  [-0.01771102]
Stock Position:  -0.017711022769011233
Bond Position:  [-12.10080975]


portfolio before change:  [-13.87212632]
curr_Stock_Price:  99.92668953229253
curr_Factors:  [99.92668953]
mat_Sqrt:  [[0.15]]
grads:  [0.00285697]
Stock Position:  0.0028569731607759863
Bond Position:  [-14.15761419]


portfolio before change:  [-13.87458772]
curr_Stock_Price:  99.68461953343628
curr_Factors:  [99.68461953]
mat_Sqrt:  [[0.15]]
grads:  [-0.0731949]
Stock Position:  -0.07319490128096544
Bond Position:  [-6.57818184]


portfolio before change:  [-13.80644428]
curr_Stock_Price:  98.74239856440188
curr_Factors:  [98.74239856]
mat_Sqrt:  [[0.15]]
grads:  [0.02461822]
Stock Position:  0.024618220174651668
Bond Position:  [-16.23730638]


portfolio before change:  [-13.80911493]
curr_Stock_Price:  98.71636640744835
curr_Factors:  [98.71636641]
mat_Sqrt:  [[0.15]]
grads:  [0.08632254]
Stock Position:  0.08632253955810372
Bond Position:  [-22.33056238]


portfolio before change:  [-13.80358433]
curr_Stock_Price:  98.81277335381442
curr_Factors:  [98.81277335]
mat_Sqrt:  [[0.15]]
grads:  [-0.06509105]
Stock Position:  -0.06509104775270277
Bond Position:  [-7.37175738]


portfolio before change:  [-13.90216706]
curr_Stock_Price:  100.31315169084749
curr_Factors:  [100.31315169]
mat_Sqrt:  [[0.15]]
grads:  [-0.1362227]
Stock Position:  -0.1362226984293192
Bond Position:  [-0.23723885]


portfolio before change:  [-14.00387908]
curr_Stock_Price:  101.05959384330765
curr_Factors:  [101.05959384]
mat_Sqrt:  [[0.15]]
grads:  [-0.13930947]
Stock Position:  -0.13930947437988747
Bond Position:  [0.07467982]


portfolio before change:  [-14.02946512]
curr_Stock_Price:  101.24332421020057
curr_Factors:  [101.24332421]
mat_Sqrt:  [[0.15]]
grads:  [0.17558269]
Stock Position:  0.1755826892456911
Bond Position:  [-31.80604026]


portfolio before change:  [-13.74918629]
curr_Stock_Price:  102.8622471314183
curr_Factors:  [102.86224713]
mat_Sqrt:  [[0.15]]
grads:  [0.01652271]
Stock Position:  0.01652270875210169
Bond Position:  [-15.44874924]


portfolio before change:  [-13.76167156]
curr_Stock_Price:  102.22348646737785
curr_Factors:  [102.22348647]
mat_Sqrt:  [[0.15]]
grads:  [0.11405087]
Stock Position:  0.11405086503262765
Bond Position:  [-25.42034862]


portfolio before change:  [-13.72897682]
curr_Stock_Price:  102.53801699123136
curr_Factors:  [102.53801699]
mat_Sqrt:  [[0.15]]
grads:  [0.06535411]
Stock Position:  0.06535411271202464
Bond Position:  [-20.43025794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.7906147]
Stock Price:  101.6339586188838
PL:  [-15.42457332]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.07694244e-02]
 [ 2.13919474e-02]
 [-1.28907292e-02]
 [-1.03021981e-02]
 [-2.71398110e-03]
 [ 6.39684730e-02]
 [ 2.76504156e-03]
 [ 1.52536085e-02]
 [ 1.16076230e-01]
 [ 2.32582768e-02]
 [ 2.20020759e-02]
 [-2.46588266e-03]
 [-3.23331046e-02]
 [ 1.65130690e-02]
 [ 4.78357181e-03]
 [-2.48756380e-03]
 [-6.02898502e-03]
 [-6.60977758e-03]
 [ 1.60601271e-03]
 [ 1.13443762e-02]
 [-1.85491536e-02]
 [-2.40814021e-02]
 [ 4.64104131e-03]
 [-1.07549994e-02]
 [ 1.22607000e-02]
 [ 2.28786336e-03]
 [ 2.05923716e-02]
 [-3.98248366e-03]
 [-2.00307859e-02]
 [-1.24419405e-02]
 [ 4.00685121e-02]
 [ 5.71112578e-03]
 [-1.08580461e-02]
 [-4.25666950e-02]
 [-2.17081744e-02]
 [ 3.88090847e-02]
 [ 3.15498262e-03]
 [ 9.77502819e-03]
 [ 5.10902374e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.1261885]
curr_Stock_Price:  98.95186131307031
curr_Factors:  [98.95186131]
mat_Sqrt:  [[0.15]]
grads:  [0.07179616]
Stock Position:  0.07179616262472932
Bond Position:  [-28.23055242]


portfolio before change:  [-21.1267753]
curr_Stock_Price:  98.99284165137108
curr_Factors:  [98.99284165]
mat_Sqrt:  [[0.15]]
grads:  [0.14261298]
Stock Position:  0.14261298239313536
Bond Position:  [-35.24443969]


portfolio before change:  [-21.42422989]
curr_Stock_Price:  96.93798836413063
curr_Factors:  [96.93798836]
mat_Sqrt:  [[0.15]]
grads:  [-0.08593819]
Stock Position:  -0.08593819439803413
Bond Position:  [-13.0935542]


portfolio before change:  [-21.3566576]
curr_Stock_Price:  96.13265280816718
curr_Factors:  [96.13265281]
mat_Sqrt:  [[0.15]]
grads:  [-0.06868132]
Stock Position:  -0.06868132090339023
Bond Position:  [-14.75414003]


portfolio before change:  [-21.35819283]
curr_Stock_Price:  96.12815153795574
curr_Factors:  [96.12815154]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809321]
Stock Position:  -0.01809320731457586
Bond Position:  [-19.61892626]


portfolio before change:  [-21.33132943]
curr_Stock_Price:  94.50787924112431
curr_Factors:  [94.50787924]
mat_Sqrt:  [[0.15]]
grads:  [0.42645649]
Stock Position:  0.42645648671338265
Bond Position:  [-61.63482758]


portfolio before change:  [-21.79618453]
curr_Stock_Price:  93.43590524377711
curr_Factors:  [93.43590524]
mat_Sqrt:  [[0.15]]
grads:  [0.01843361]
Stock Position:  0.01843361042342185
Bond Position:  [-23.51854561]


portfolio before change:  [-21.80025241]
curr_Stock_Price:  93.37471923701591
curr_Factors:  [93.37471924]
mat_Sqrt:  [[0.15]]
grads:  [0.10169072]
Stock Position:  0.10169072302633585
Bond Position:  [-31.29559512]


portfolio before change:  [-21.71048431]
curr_Stock_Price:  94.29594676948841
curr_Factors:  [94.29594677]
mat_Sqrt:  [[0.15]]
grads:  [0.77384153]
Stock Position:  0.7738415328472267
Bond Position:  [-94.6806043]


portfolio before change:  [-21.37107334]
curr_Stock_Price:  94.7498469144982
curr_Factors:  [94.74984691]
mat_Sqrt:  [[0.15]]
grads:  [0.15505518]
Stock Position:  0.15505517868269278
Bond Position:  [-36.06252779]


portfolio before change:  [-21.23701281]
curr_Stock_Price:  95.64351995006285
curr_Factors:  [95.64351995]
mat_Sqrt:  [[0.15]]
grads:  [0.14668051]
Stock Position:  0.14668050600999244
Bond Position:  [-35.26605271]


portfolio before change:  [-21.36978776]
curr_Stock_Price:  94.76837695265499
curr_Factors:  [94.76837695]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643922]
Stock Position:  -0.01643921772593316
Bond Position:  [-19.81186978]


portfolio before change:  [-21.36736323]
curr_Stock_Price:  94.47023818158434
curr_Factors:  [94.47023818]
mat_Sqrt:  [[0.15]]
grads:  [-0.21555403]
Stock Position:  -0.21555403068530693
Bond Position:  [-1.00392261]


portfolio before change:  [-21.4095304]
curr_Stock_Price:  94.66527825280018
curr_Factors:  [94.66527825]
mat_Sqrt:  [[0.15]]
grads:  [0.11008713]
Stock Position:  0.11008712669551803
Bond Position:  [-31.83095888]


portfolio before change:  [-21.44814651]
curr_Stock_Price:  94.35064571769969
curr_Factors:  [94.35064572]
mat_Sqrt:  [[0.15]]
grads:  [0.03189048]
Stock Position:  0.03189047872410224
Bond Position:  [-24.45703377]


portfolio before change:  [-21.45739137]
curr_Stock_Price:  94.15662102293234
curr_Factors:  [94.15662102]
mat_Sqrt:  [[0.15]]
grads:  [-0.01658376]
Stock Position:  -0.016583758651295376
Bond Position:  [-19.89592069]


portfolio before change:  [-21.46202292]
curr_Stock_Price:  94.28592823734135
curr_Factors:  [94.28592824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019323]
Stock Position:  -0.040193233439555415
Bond Position:  [-17.67236659]


portfolio before change:  [-21.49855554]
curr_Stock_Price:  95.13988882905844
curr_Factors:  [95.13988883]
mat_Sqrt:  [[0.15]]
grads:  [-0.04406518]
Stock Position:  -0.04406518386831865
Bond Position:  [-17.30619884]


portfolio before change:  [-21.51221193]
curr_Stock_Price:  95.40070671053496
curr_Factors:  [95.40070671]
mat_Sqrt:  [[0.15]]
grads:  [0.01070675]
Stock Position:  0.010706751405660606
Bond Position:  [-22.53364359]


portfolio before change:  [-21.52280431]
curr_Stock_Price:  94.67448341587843
curr_Factors:  [94.67448342]
mat_Sqrt:  [[0.15]]
grads:  [0.07562917]
Stock Position:  0.07562917476521096
Bond Position:  [-28.68295736]


portfolio before change:  [-21.53312516]
curr_Stock_Price:  94.58542709010518
curr_Factors:  [94.58542709]
mat_Sqrt:  [[0.15]]
grads:  [-0.12366102]
Stock Position:  -0.12366102431658278
Bond Position:  [-9.83659436]


portfolio before change:  [-21.5255065]
curr_Stock_Price:  94.51387417064167
curr_Factors:  [94.51387417]
mat_Sqrt:  [[0.15]]
grads:  [-0.16054268]
Stock Position:  -0.16054268060567603
Bond Position:  [-6.35199579]


portfolio before change:  [-21.67558295]
curr_Stock_Price:  95.44373529151864
curr_Factors:  [95.44373529]
mat_Sqrt:  [[0.15]]
grads:  [0.03094028]
Stock Position:  0.030940275368150246
Bond Position:  [-24.6286384]


portfolio before change:  [-21.66943114]
curr_Stock_Price:  95.7420706268589
curr_Factors:  [95.74207063]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717]
Stock Position:  -0.0716999962364506
Bond Position:  [-14.80472504]


portfolio before change:  [-21.71979168]
curr_Stock_Price:  96.4186372858302
curr_Factors:  [96.41863729]
mat_Sqrt:  [[0.15]]
grads:  [0.081738]
Stock Position:  0.0817379997669269
Bond Position:  [-29.60085823]


portfolio before change:  [-21.71633271]
curr_Stock_Price:  96.50622573035037
curr_Factors:  [96.50622573]
mat_Sqrt:  [[0.15]]
grads:  [0.01525242]
Stock Position:  0.015252422423609658
Bond Position:  [-23.18828643]


portfolio before change:  [-21.72548052]
curr_Stock_Price:  96.09651412234626
curr_Factors:  [96.09651412]
mat_Sqrt:  [[0.15]]
grads:  [0.13728248]
Stock Position:  0.13728247727151752
Bond Position:  [-34.91784804]


portfolio before change:  [-21.64254189]
curr_Stock_Price:  96.73245569580813
curr_Factors:  [96.7324557]
mat_Sqrt:  [[0.15]]
grads:  [-0.02654989]
Stock Position:  -0.026549891047380217
Bond Position:  [-19.07430573]


portfolio before change:  [-21.64573912]
curr_Stock_Price:  96.7630692931425
curr_Factors:  [96.76306929]
mat_Sqrt:  [[0.15]]
grads:  [-0.13353857]
Stock Position:  -0.13353857262392493
Bond Position:  [-8.72413696]


portfolio before change:  [-21.65375788]
curr_Stock_Price:  96.81495073968563
curr_Factors:  [96.81495074]
mat_Sqrt:  [[0.15]]
grads:  [-0.08294627]
Stock Position:  -0.08294626978966109
Bond Position:  [-13.62331885]


portfolio before change:  [-21.61561256]
curr_Stock_Price:  96.33453931242016
curr_Factors:  [96.33453931]
mat_Sqrt:  [[0.15]]
grads:  [0.26712341]
Stock Position:  0.2671234140833804
Bond Position:  [-47.3488236]


portfolio before change:  [-21.49629976]
curr_Stock_Price:  96.80335546575233
curr_Factors:  [96.80335547]
mat_Sqrt:  [[0.15]]
grads:  [0.03807417]
Stock Position:  0.03807417188105224
Bond Position:  [-25.18200736]


portfolio before change:  [-21.4428451]
curr_Stock_Price:  98.28999621444487
curr_Factors:  [98.28999621]
mat_Sqrt:  [[0.15]]
grads:  [-0.07238697]
Stock Position:  -0.07238697415692634
Bond Position:  [-14.32792968]


portfolio before change:  [-21.45887866]
curr_Stock_Price:  98.48675066455637
curr_Factors:  [98.48675066]
mat_Sqrt:  [[0.15]]
grads:  [-0.28377797]
Stock Position:  -0.2837779669784219
Bond Position:  [6.48949122]


portfolio before change:  [-21.73684192]
curr_Stock_Price:  99.46911903826454
curr_Factors:  [99.46911904]
mat_Sqrt:  [[0.15]]
grads:  [-0.14472116]
Stock Position:  -0.144721162556362
Bond Position:  [-7.34155537]


portfolio before change:  [-21.60134422]
curr_Stock_Price:  98.52651014563159
curr_Factors:  [98.52651015]
mat_Sqrt:  [[0.15]]
grads:  [0.25872723]
Stock Position:  0.2587272315486606
Bond Position:  [-47.09283542]


portfolio before change:  [-21.31049132]
curr_Stock_Price:  99.67343182530298
curr_Factors:  [99.67343183]
mat_Sqrt:  [[0.15]]
grads:  [0.02103322]
Stock Position:  0.02103321748899716
Bond Position:  [-23.40694429]


portfolio before change:  [-21.29734243]
curr_Stock_Price:  100.43769639865772
curr_Factors:  [100.4376964]
mat_Sqrt:  [[0.15]]
grads:  [0.06516685]
Stock Position:  0.06516685457385925
Bond Position:  [-27.84255118]


portfolio before change:  [-21.36831306]
curr_Stock_Price:  99.40204570711927
curr_Factors:  [99.40204571]
mat_Sqrt:  [[0.15]]
grads:  [0.03406016]
Stock Position:  0.034060158250279395
Bond Position:  [-24.75396247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.33325096]
Stock Price:  100.5223146421065
PL:  [-21.8555656]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-8.02921065e-03]
 [ 4.39002222e-02]
 [ 1.81029248e-03]
 [-4.57464864e-03]
 [-7.54095259e-03]
 [ 2.99036374e-02]
 [ 3.56694630e-03]
 [-1.28774856e-03]
 [-2.07962297e-02]
 [ 2.34423673e-02]
 [ 2.10660593e-02]
 [-8.21531600e-03]
 [-5.93510415e-03]
 [ 1.42218849e-02]
 [-1.58360647e-02]
 [ 6.47611937e-04]
 [-6.11644839e-03]
 [-1.33523697e-03]
 [ 1.51268647e-03]
 [-1.17573407e-02]
 [-1.22496704e-02]
 [-2.12290544e-02]
 [ 4.99395668e-03]
 [-9.70064152e-03]
 [ 1.23327091e-02]
 [ 3.45864839e-03]
 [ 1.69808874e-02]
 [-3.89006339e-03]
 [-2.84854712e-02]
 [-9.32292701e-03]
 [ 4.18505776e-02]
 [-1.91343974e-03]
 [-2.11231269e-02]
 [-1.78088858e-02]
 [-2.38928287e-02]
 [ 3.01809077e-02]
 [-1.16624781e-02]
 [-5.89332831e-03]
 [ 2.07476298e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.49030896]
curr_Stock_Price:  100.43741398433048
curr_Factors:  [100.43741398]
mat_Sqrt:  [[0.15]]
grads:  [-0.05352807]
Stock Position:  -0.0535280710314806
Bond Position:  [16.86652999]


portfolio before change:  [11.49146084]
curr_Stock_Price:  100.45528434539509
curr_Factors:  [100.45528435]
mat_Sqrt:  [[0.15]]
grads:  [0.29266815]
Stock Position:  0.29266814810106817
Bond Position:  [-17.90860119]


portfolio before change:  [11.8138713]
curr_Stock_Price:  101.5645583632532
curr_Factors:  [101.56455836]
mat_Sqrt:  [[0.15]]
grads:  [0.01206862]
Stock Position:  0.012068616558959962
Bond Position:  [10.58812759]


portfolio before change:  [11.7992324]
curr_Stock_Price:  100.241913332115
curr_Factors:  [100.24191333]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049766]
Stock Position:  -0.030497657567917343
Bond Position:  [14.85637595]


portfolio before change:  [11.8109744]
curr_Stock_Price:  99.91779550070812
curr_Factors:  [99.9177955]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027302]
Stock Position:  -0.05027301726918703
Bond Position:  [16.83414346]


portfolio before change:  [11.85695576]
curr_Stock_Price:  99.04502204175193
curr_Factors:  [99.04502204]
mat_Sqrt:  [[0.15]]
grads:  [0.19935758]
Stock Position:  0.19935758267251782
Bond Position:  [-7.88842041]


portfolio before change:  [11.94696213]
curr_Stock_Price:  99.50145059584837
curr_Factors:  [99.5014506]
mat_Sqrt:  [[0.15]]
grads:  [0.02377964]
Stock Position:  0.023779642012719777
Bond Position:  [9.58085326]


portfolio before change:  [11.944758]
curr_Stock_Price:  99.35839482837248
curr_Factors:  [99.35839483]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858499]
Stock Position:  -0.00858499040237953
Bond Position:  [12.79774887]


portfolio before change:  [11.95318303]
curr_Stock_Price:  98.56337862556302
curr_Factors:  [98.56337863]
mat_Sqrt:  [[0.15]]
grads:  [-0.13864153]
Stock Position:  -0.13864153158380757
Bond Position:  [25.6181608]


portfolio before change:  [12.02260219]
curr_Stock_Price:  98.08576780333532
curr_Factors:  [98.0857678]
mat_Sqrt:  [[0.15]]
grads:  [0.15628245]
Stock Position:  0.15628244858908563
Bond Position:  [-3.30648177]


portfolio before change:  [12.0250985]
curr_Stock_Price:  98.10438564210915
curr_Factors:  [98.10438564]
mat_Sqrt:  [[0.15]]
grads:  [0.1404404]
Stock Position:  0.14044039509314943
Bond Position:  [-1.75272018]


portfolio before change:  [11.91778201]
curr_Stock_Price:  97.34180320383287
curr_Factors:  [97.3418032]
mat_Sqrt:  [[0.15]]
grads:  [-0.05476877]
Stock Position:  -0.054768773360540486
Bond Position:  [17.24907317]


portfolio before change:  [11.89817608]
curr_Stock_Price:  97.7391501373261
curr_Factors:  [97.73915014]
mat_Sqrt:  [[0.15]]
grads:  [-0.03956736]
Stock Position:  -0.03956736100778991
Bond Position:  [15.76545632]


portfolio before change:  [11.92401958]
curr_Stock_Price:  97.13580703004425
curr_Factors:  [97.13580703]
mat_Sqrt:  [[0.15]]
grads:  [0.09481257]
Stock Position:  0.09481256567056628
Bond Position:  [2.7143245]


portfolio before change:  [12.01789234]
curr_Stock_Price:  98.12231600476684
curr_Factors:  [98.122316]
mat_Sqrt:  [[0.15]]
grads:  [-0.10557376]
Stock Position:  -0.10557376456565014
Bond Position:  [22.37703463]


portfolio before change:  [11.99909825]
curr_Stock_Price:  98.32683079052426
curr_Factors:  [98.32683079]
mat_Sqrt:  [[0.15]]
grads:  [0.00431741]
Stock Position:  0.004317412911191531
Bond Position:  [11.57458072]


portfolio before change:  [11.99417272]
curr_Stock_Price:  96.85084633252988
curr_Factors:  [96.85084633]
mat_Sqrt:  [[0.15]]
grads:  [-0.04077632]
Stock Position:  -0.04077632259051895
Bond Position:  [15.94339408]


portfolio before change:  [12.01092291]
curr_Stock_Price:  96.48894177214078
curr_Factors:  [96.48894177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00890158]
Stock Position:  -0.008901579797527214
Bond Position:  [12.86982693]


portfolio before change:  [12.02048777]
curr_Stock_Price:  95.59516482894696
curr_Factors:  [95.59516483]
mat_Sqrt:  [[0.15]]
grads:  [0.01008458]
Stock Position:  0.010084576466055992
Bond Position:  [11.05645102]


portfolio before change:  [12.03082467]
curr_Stock_Price:  96.48313100401631
curr_Factors:  [96.483131]
mat_Sqrt:  [[0.15]]
grads:  [-0.07838227]
Stock Position:  -0.07838227147289228
Bond Position:  [19.59339164]


portfolio before change:  [12.06839051]
curr_Stock_Price:  96.03511497085084
curr_Factors:  [96.03511497]
mat_Sqrt:  [[0.15]]
grads:  [-0.08166447]
Stock Position:  -0.08166446950650562
Bond Position:  [19.91104723]


portfolio before change:  [12.08308351]
curr_Stock_Price:  95.88567473207141
curr_Factors:  [95.88567473]
mat_Sqrt:  [[0.15]]
grads:  [-0.14152703]
Stock Position:  -0.1415270295302581
Bond Position:  [25.65349823]


portfolio before change:  [12.09145193]
curr_Stock_Price:  95.84920445398019
curr_Factors:  [95.84920445]
mat_Sqrt:  [[0.15]]
grads:  [0.03329304]
Stock Position:  0.033293044522966816
Bond Position:  [8.90034009]


portfolio before change:  [12.12502543]
curr_Stock_Price:  96.82420965988123
curr_Factors:  [96.82420966]
mat_Sqrt:  [[0.15]]
grads:  [-0.06467094]
Stock Position:  -0.06467094345884739
Bond Position:  [18.38673842]


portfolio before change:  [12.14746522]
curr_Stock_Price:  96.51276684883562
curr_Factors:  [96.51276685]
mat_Sqrt:  [[0.15]]
grads:  [0.08221806]
Stock Position:  0.08221806065416291
Bond Position:  [4.2123727]


portfolio before change:  [12.18800321]
curr_Stock_Price:  96.99941684306528
curr_Factors:  [96.99941684]
mat_Sqrt:  [[0.15]]
grads:  [0.02305766]
Stock Position:  0.023057655951596943
Bond Position:  [9.95142403]


portfolio before change:  [12.18356896]
curr_Stock_Price:  96.75315322582321
curr_Factors:  [96.75315323]
mat_Sqrt:  [[0.15]]
grads:  [0.11320592]
Stock Position:  0.11320591587189853
Bond Position:  [1.23053963]


portfolio before change:  [12.20561347]
curr_Stock_Price:  96.94652370353774
curr_Factors:  [96.9465237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02593376]
Stock Position:  -0.025933755959742906
Bond Position:  [14.71980095]


portfolio before change:  [12.23712449]
curr_Stock_Price:  95.80241891007279
curr_Factors:  [95.80241891]
mat_Sqrt:  [[0.15]]
grads:  [-0.18990314]
Stock Position:  -0.18990314160921656
Bond Position:  [30.43030482]


portfolio before change:  [12.42511253]
curr_Stock_Price:  94.83253495611284
curr_Factors:  [94.83253496]
mat_Sqrt:  [[0.15]]
grads:  [-0.06215285]
Stock Position:  -0.06215284672275088
Bond Position:  [18.31922454]


portfolio before change:  [12.35802942]
curr_Stock_Price:  95.94870519067477
curr_Factors:  [95.94870519]
mat_Sqrt:  [[0.15]]
grads:  [0.27900385]
Stock Position:  0.27900385081419865
Bond Position:  [-14.41202881]


portfolio before change:  [11.95526233]
curr_Stock_Price:  94.51157281594368
curr_Factors:  [94.51157282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01275626]
Stock Position:  -0.012756264935977236
Bond Position:  [13.160877]


portfolio before change:  [11.95631742]
curr_Stock_Price:  94.5578340601751
curr_Factors:  [94.55783406]
mat_Sqrt:  [[0.15]]
grads:  [-0.14082085]
Stock Position:  -0.14082084579700435
Bond Position:  [25.27203159]


portfolio before change:  [12.04349036]
curr_Stock_Price:  93.96123390855915
curr_Factors:  [93.96123391]
mat_Sqrt:  [[0.15]]
grads:  [-0.11872591]
Stock Position:  -0.11872590532779656
Bond Position:  [23.19912293]


portfolio before change:  [12.06972016]
curr_Stock_Price:  93.76473321099188
curr_Factors:  [93.76473321]
mat_Sqrt:  [[0.15]]
grads:  [-0.15928552]
Stock Position:  -0.15928552446131902
Bond Position:  [27.00508486]


portfolio before change:  [12.20586191]
curr_Stock_Price:  92.93122430950382
curr_Factors:  [92.93122431]
mat_Sqrt:  [[0.15]]
grads:  [0.20120605]
Stock Position:  0.20120605126546529
Bond Position:  [-6.49246277]


portfolio before change:  [12.13941627]
curr_Stock_Price:  92.6050212281319
curr_Factors:  [92.60502123]
mat_Sqrt:  [[0.15]]
grads:  [-0.07774985]
Stock Position:  -0.07774985431015603
Bond Position:  [19.33944317]


portfolio before change:  [12.01818064]
curr_Stock_Price:  94.19541914719426
curr_Factors:  [94.19541915]
mat_Sqrt:  [[0.15]]
grads:  [-0.03928886]
Stock Position:  -0.03928885541255288
Bond Position:  [15.71901084]


portfolio before change:  [11.97208638]
curr_Stock_Price:  95.41864787141363
curr_Factors:  [95.41864787]
mat_Sqrt:  [[0.15]]
grads:  [0.13831753]
Stock Position:  0.1383175317196314
Bond Position:  [-1.22598547]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.91679815]
Stock Price:  95.02003626996057
PL:  [11.91679815]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.13869055e-02]
 [ 1.07966640e-02]
 [-1.54429395e-02]
 [-6.95088045e-03]
 [-7.18785507e-03]
 [ 3.21868787e-02]
 [ 3.70520572e-03]
 [ 5.63965895e-03]
 [-2.00784524e-02]
 [ 2.33878965e-02]
 [ 1.97665770e-02]
 [-1.44157509e-02]
 [ 2.19618725e-02]
 [ 5.84027874e-03]
 [-5.89194093e-03]
 [-3.10903219e-03]
 [-5.97064161e-03]
 [ 4.73403228e-03]
 [ 5.24607069e-03]
 [-1.94473389e-02]
 [-2.74396026e-03]
 [-8.04454076e-03]
 [ 6.61997741e-03]
 [-6.44182610e-03]
 [ 1.18243962e-02]
 [ 7.44206567e-03]
 [ 1.12731135e-02]
 [-3.61563649e-03]
 [-3.45688621e-02]
 [-1.28010669e-02]
 [ 3.16334532e-02]
 [ 8.52603881e-03]
 [-1.15790946e-02]
 [-4.84987388e-02]
 [-2.24076634e-02]
 [ 3.89331218e-02]
 [ 3.14618904e-03]
 [ 8.20068837e-03]
 [ 5.72298664e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.90831244]
curr_Stock_Price:  99.46279127290734
curr_Factors:  [99.46279127]
mat_Sqrt:  [[0.15]]
grads:  [-0.0759127]
Stock Position:  -0.07591270343614079
Bond Position:  [-2.35782307]


portfolio before change:  [-9.84121776]
curr_Stock_Price:  98.57506851916636
curr_Factors:  [98.57506852]
mat_Sqrt:  [[0.15]]
grads:  [0.07197776]
Stock Position:  0.07197776002547426
Bond Position:  [-16.93643038]


portfolio before change:  [-9.80856324]
curr_Stock_Price:  99.05815799509573
curr_Factors:  [99.058158]
mat_Sqrt:  [[0.15]]
grads:  [-0.10295293]
Stock Position:  -0.10295292985456661
Bond Position:  [0.38976435]


portfolio before change:  [-9.8128427]
curr_Stock_Price:  99.10019833254951
curr_Factors:  [99.10019833]
mat_Sqrt:  [[0.15]]
grads:  [-0.0463392]
Stock Position:  -0.046339202981151524
Bond Position:  [-5.22061849]


portfolio before change:  [-9.82221559]
curr_Stock_Price:  99.28838182935003
curr_Factors:  [99.28838183]
mat_Sqrt:  [[0.15]]
grads:  [-0.04791903]
Stock Position:  -0.04791903382329514
Bond Position:  [-5.06441226]


portfolio before change:  [-9.88252869]
curr_Stock_Price:  100.53381617556204
curr_Factors:  [100.53381618]
mat_Sqrt:  [[0.15]]
grads:  [0.21457919]
Stock Position:  0.21457919121344604
Bond Position:  [-31.45499365]


portfolio before change:  [-9.90584647]
curr_Stock_Price:  100.44347350574289
curr_Factors:  [100.44347351]
mat_Sqrt:  [[0.15]]
grads:  [0.02470137]
Stock Position:  0.02470137145521906
Bond Position:  [-12.38693802]


portfolio before change:  [-9.89841257]
curr_Stock_Price:  100.80711177139871
curr_Factors:  [100.80711177]
mat_Sqrt:  [[0.15]]
grads:  [0.03759773]
Stock Position:  0.03759772634697445
Bond Position:  [-13.68853077]


portfolio before change:  [-9.89771732]
curr_Stock_Price:  100.87111626709698
curr_Factors:  [100.87111627]
mat_Sqrt:  [[0.15]]
grads:  [-0.13385635]
Stock Position:  -0.1338563491174484
Bond Position:  [3.60452204]


portfolio before change:  [-9.81071817]
curr_Stock_Price:  100.2245384121407
curr_Factors:  [100.22453841]
mat_Sqrt:  [[0.15]]
grads:  [0.15591931]
Stock Position:  0.15591931020893704
Bond Position:  [-25.43765907]


portfolio before change:  [-9.94651181]
curr_Stock_Price:  99.37401043500014
curr_Factors:  [99.37401044]
mat_Sqrt:  [[0.15]]
grads:  [0.13177718]
Stock Position:  0.13177718022977747
Bond Position:  [-23.0417387]


portfolio before change:  [-9.86844258]
curr_Stock_Price:  99.98830213042581
curr_Factors:  [99.98830213]
mat_Sqrt:  [[0.15]]
grads:  [-0.09610501]
Stock Position:  -0.09610500620473562
Bond Position:  [-0.25906619]


portfolio before change:  [-9.87933666]
curr_Stock_Price:  100.10132114688572
curr_Factors:  [100.10132115]
mat_Sqrt:  [[0.15]]
grads:  [0.14641248]
Stock Position:  0.1464124831821402
Bond Position:  [-24.53541966]


portfolio before change:  [-9.89283007]
curr_Stock_Price:  100.03010936476505
curr_Factors:  [100.03010936]
mat_Sqrt:  [[0.15]]
grads:  [0.03893519]
Stock Position:  0.038935191566727076
Bond Position:  [-13.78752155]


portfolio before change:  [-9.90594856]
curr_Stock_Price:  99.73744524896213
curr_Factors:  [99.73744525]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927961]
Stock Position:  -0.03927960617486681
Bond Position:  [-5.98830099]


portfolio before change:  [-9.91840449]
curr_Stock_Price:  100.03549673321642
curr_Factors:  [100.03549673]
mat_Sqrt:  [[0.15]]
grads:  [-0.02072688]
Stock Position:  -0.02072688126125768
Bond Position:  [-7.84498062]


portfolio before change:  [-9.94445101]
curr_Stock_Price:  101.24483625976495
curr_Factors:  [101.24483626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980428]
Stock Position:  -0.03980427741138391
Bond Position:  [-5.91447346]


portfolio before change:  [-9.8739907]
curr_Stock_Price:  99.45609228862115
curr_Factors:  [99.45609229]
mat_Sqrt:  [[0.15]]
grads:  [0.03156022]
Stock Position:  0.03156021522255818
Bond Position:  [-13.01284638]


portfolio before change:  [-9.88937071]
curr_Stock_Price:  99.02031258190605
curr_Factors:  [99.02031258]
mat_Sqrt:  [[0.15]]
grads:  [0.0349738]
Stock Position:  0.03497380459576779
Bond Position:  [-13.35248777]


portfolio before change:  [-9.87909846]
curr_Stock_Price:  99.36175134670496
curr_Factors:  [99.36175135]
mat_Sqrt:  [[0.15]]
grads:  [-0.12964893]
Stock Position:  -0.12964892581821524
Bond Position:  [3.00304587]


portfolio before change:  [-9.82386583]
curr_Stock_Price:  98.93862998180347
curr_Factors:  [98.93862998]
mat_Sqrt:  [[0.15]]
grads:  [-0.01829307]
Stock Position:  -0.018293068367061616
Bond Position:  [-8.0139747]


portfolio before change:  [-9.83134321]
curr_Stock_Price:  99.29262049427719
curr_Factors:  [99.29262049]
mat_Sqrt:  [[0.15]]
grads:  [-0.05363027]
Stock Position:  -0.0536302717572535
Bond Position:  [-4.50625299]


portfolio before change:  [-9.79501177]
curr_Stock_Price:  98.604674088159
curr_Factors:  [98.60467409]
mat_Sqrt:  [[0.15]]
grads:  [0.04413318]
Stock Position:  0.044133182723693556
Bond Position:  [-14.14674987]


portfolio before change:  [-9.76537248]
curr_Stock_Price:  99.3163323323359
curr_Factors:  [99.31633233]
mat_Sqrt:  [[0.15]]
grads:  [-0.04294551]
Stock Position:  -0.04294550735143072
Bond Position:  [-5.5001822]


portfolio before change:  [-9.80167784]
curr_Stock_Price:  100.14570418559487
curr_Factors:  [100.14570419]
mat_Sqrt:  [[0.15]]
grads:  [0.07882931]
Stock Position:  0.07882930817458306
Bond Position:  [-17.69609442]


portfolio before change:  [-9.91032816]
curr_Stock_Price:  98.79546819251682
curr_Factors:  [98.79546819]
mat_Sqrt:  [[0.15]]
grads:  [0.04961377]
Stock Position:  0.049613771107848835
Bond Position:  [-14.81194391]


portfolio before change:  [-9.98634547]
curr_Stock_Price:  97.300607035258
curr_Factors:  [97.30060704]
mat_Sqrt:  [[0.15]]
grads:  [0.07515409]
Stock Position:  0.0751540898839089
Bond Position:  [-17.29888404]


portfolio before change:  [-9.96247447]
curr_Stock_Price:  97.64700869296048
curr_Factors:  [97.64700869]
mat_Sqrt:  [[0.15]]
grads:  [-0.02410424]
Stock Position:  -0.024104243237518173
Bond Position:  [-7.60876722]


portfolio before change:  [-9.90365088]
curr_Stock_Price:  95.1671656830469
curr_Factors:  [95.16716568]
mat_Sqrt:  [[0.15]]
grads:  [-0.23045908]
Stock Position:  -0.23045908066131934
Bond Position:  [12.02848663]


portfolio before change:  [-10.32515688]
curr_Stock_Price:  97.0026744110919
curr_Factors:  [97.00267441]
mat_Sqrt:  [[0.15]]
grads:  [-0.08534045]
Stock Position:  -0.08534044566707688
Bond Position:  [-2.04690542]


portfolio before change:  [-10.3587126]
curr_Stock_Price:  97.39287438753392
curr_Factors:  [97.39287439]
mat_Sqrt:  [[0.15]]
grads:  [0.21088969]
Stock Position:  0.2108896882738165
Bond Position:  [-30.89786552]


portfolio before change:  [-10.29359287]
curr_Stock_Price:  97.71997526393541
curr_Factors:  [97.71997526]
mat_Sqrt:  [[0.15]]
grads:  [0.05684026]
Stock Position:  0.05684025870933534
Bond Position:  [-15.84802155]


portfolio before change:  [-10.28146299]
curr_Stock_Price:  97.9682325529254
curr_Factors:  [97.96823255]
mat_Sqrt:  [[0.15]]
grads:  [-0.07719396]
Stock Position:  -0.0771939641899971
Bond Position:  [-2.71890676]


portfolio before change:  [-10.2644918]
curr_Stock_Price:  97.74397823422865
curr_Factors:  [97.74397823]
mat_Sqrt:  [[0.15]]
grads:  [-0.32332493]
Stock Position:  -0.3233249255043262
Bond Position:  [21.33857268]


portfolio before change:  [-10.34675177]
curr_Stock_Price:  98.00664732604264
curr_Factors:  [98.00664733]
mat_Sqrt:  [[0.15]]
grads:  [-0.14938442]
Stock Position:  -0.14938442237752514
Bond Position:  [4.29391463]


portfolio before change:  [-10.41552014]
curr_Stock_Price:  98.47058553338289
curr_Factors:  [98.47058553]
mat_Sqrt:  [[0.15]]
grads:  [0.25955415]
Stock Position:  0.25955414538895966
Bond Position:  [-35.97396881]


portfolio before change:  [-10.20996822]
curr_Stock_Price:  99.27985386181999
curr_Factors:  [99.27985386]
mat_Sqrt:  [[0.15]]
grads:  [0.02097459]
Stock Position:  0.020974593567067448
Bond Position:  [-12.2923228]


portfolio before change:  [-10.21100798]
curr_Stock_Price:  99.30354333693862
curr_Factors:  [99.30354334]
mat_Sqrt:  [[0.15]]
grads:  [0.05467126]
Stock Position:  0.054671255799753675
Bond Position:  [-15.6400574]


portfolio before change:  [-10.18593228]
curr_Stock_Price:  99.79796820873518
curr_Factors:  [99.79796821]
mat_Sqrt:  [[0.15]]
grads:  [0.03815324]
Stock Position:  0.03815324423666891
Bond Position:  [-13.99354853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.1629806]
Stock Price:  100.44538315868739
PL:  [-10.60836376]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.52917165e-02]
 [-2.04222239e-02]
 [ 9.65135975e-03]
 [-7.47252802e-04]
 [-2.44729072e-03]
 [ 3.02578295e-02]
 [ 3.64941098e-03]
 [ 6.98937894e-03]
 [ 2.70048370e-03]
 [ 2.28470527e-02]
 [ 2.01178849e-02]
 [-1.49816541e-02]
 [ 1.87900931e-02]
 [ 5.89250969e-03]
 [-1.08485085e-02]
 [-1.17308282e-03]
 [-6.06323685e-03]
 [ 1.22421765e-03]
 [ 1.21328476e-03]
 [-3.43155356e-03]
 [-1.38133620e-02]
 [-2.27960573e-02]
 [ 4.68085335e-03]
 [-1.11910450e-02]
 [ 1.11206886e-02]
 [ 2.23793307e-04]
 [ 2.54020512e-02]
 [-4.73425430e-03]
 [-3.22176341e-02]
 [-8.71703167e-03]
 [ 4.99687533e-02]
 [ 8.93608965e-04]
 [-1.83794982e-02]
 [-4.49288369e-02]
 [-2.28374166e-02]
 [ 3.98604470e-02]
 [-9.75074694e-04]
 [ 4.48325875e-03]
 [ 1.48196458e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.489805]
curr_Stock_Price:  101.02948969957426
curr_Factors:  [101.0294897]
mat_Sqrt:  [[0.15]]
grads:  [-0.30194478]
Stock Position:  -0.3019447768264902
Bond Position:  [54.99513172]


portfolio before change:  [24.30651602]
curr_Stock_Price:  101.65928629508474
curr_Factors:  [101.6592863]
mat_Sqrt:  [[0.15]]
grads:  [-0.13614816]
Stock Position:  -0.13614815949425144
Bond Position:  [38.14724075]


portfolio before change:  [24.23687788]
curr_Stock_Price:  102.20580011494044
curr_Factors:  [102.20580011]
mat_Sqrt:  [[0.15]]
grads:  [0.0643424]
Stock Position:  0.06434239836075328
Bond Position:  [17.66071157]


portfolio before change:  [24.20744107]
curr_Stock_Price:  101.71398553870765
curr_Factors:  [101.71398554]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498169]
Stock Position:  -0.004981685347361306
Bond Position:  [24.71414815]


portfolio before change:  [24.21124665]
curr_Stock_Price:  101.57023593305132
curr_Factors:  [101.57023593]
mat_Sqrt:  [[0.15]]
grads:  [-0.01631527]
Stock Position:  -0.016315271457026485
Bond Position:  [25.86839262]


portfolio before change:  [24.21973285]
curr_Stock_Price:  101.24830165420737
curr_Factors:  [101.24830165]
mat_Sqrt:  [[0.15]]
grads:  [0.20171886]
Stock Position:  0.20171886335365777
Bond Position:  [3.79604052]


portfolio before change:  [24.25472025]
curr_Stock_Price:  101.41939557827153
curr_Factors:  [101.41939558]
mat_Sqrt:  [[0.15]]
grads:  [0.02432941]
Stock Position:  0.024329406559205555
Bond Position:  [21.78724655]


portfolio before change:  [24.24898333]
curr_Stock_Price:  101.07164761494768
curr_Factors:  [101.07164761]
mat_Sqrt:  [[0.15]]
grads:  [0.04659586]
Stock Position:  0.046595859622281736
Bond Position:  [19.53946302]


portfolio before change:  [24.31270857]
curr_Stock_Price:  102.38684284369235
curr_Factors:  [102.38684284]
mat_Sqrt:  [[0.15]]
grads:  [0.01800322]
Stock Position:  0.018003224651960185
Bond Position:  [22.46941523]


portfolio before change:  [24.31625203]
curr_Stock_Price:  102.42764741501247
curr_Factors:  [102.42764742]
mat_Sqrt:  [[0.15]]
grads:  [0.15231368]
Stock Position:  0.1523136845125311
Bond Position:  [8.71511966]


portfolio before change:  [24.17942481]
curr_Stock_Price:  101.52216946894865
curr_Factors:  [101.52216947]
mat_Sqrt:  [[0.15]]
grads:  [0.13411923]
Stock Position:  0.13411923255025837
Bond Position:  [10.56334935]


portfolio before change:  [23.95026323]
curr_Stock_Price:  99.80368307911587
curr_Factors:  [99.80368308]
mat_Sqrt:  [[0.15]]
grads:  [-0.09987769]
Stock Position:  -0.0998776936785723
Bond Position:  [33.91842492]


portfolio before change:  [23.95115439]
curr_Stock_Price:  99.83721325652651
curr_Factors:  [99.83721326]
mat_Sqrt:  [[0.15]]
grads:  [0.12526729]
Stock Position:  0.12526728730267742
Bond Position:  [11.44481751]


portfolio before change:  [23.97492965]
curr_Stock_Price:  100.0155884514869
curr_Factors:  [100.01558845]
mat_Sqrt:  [[0.15]]
grads:  [0.0392834]
Stock Position:  0.039283397954900934
Bond Position:  [20.04597749]


portfolio before change:  [23.93458222]
curr_Stock_Price:  98.9247120115481
curr_Factors:  [98.92471201]
mat_Sqrt:  [[0.15]]
grads:  [-0.07232339]
Stock Position:  -0.07232338998005794
Bond Position:  [31.08915275]


portfolio before change:  [23.92148715]
curr_Stock_Price:  99.1595110786635
curr_Factors:  [99.15951108]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782055]
Stock Position:  -0.007820552143706494
Bond Position:  [24.69696927]


portfolio before change:  [23.93461087]
curr_Stock_Price:  97.87617321263986
curr_Factors:  [97.87617321]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042158]
Stock Position:  -0.040421578996470184
Bond Position:  [27.89092034]


portfolio before change:  [23.95540561]
curr_Stock_Price:  97.4479822670689
curr_Factors:  [97.44798227]
mat_Sqrt:  [[0.15]]
grads:  [0.00816145]
Stock Position:  0.008161451017878497
Bond Position:  [23.16008867]


portfolio before change:  [23.9482706]
curr_Stock_Price:  96.219009652407
curr_Factors:  [96.21900965]
mat_Sqrt:  [[0.15]]
grads:  [0.00808857]
Stock Position:  0.00808856509595439
Bond Position:  [23.16999688]


portfolio before change:  [23.94803102]
curr_Stock_Price:  95.83130002054628
curr_Factors:  [95.83130002]
mat_Sqrt:  [[0.15]]
grads:  [-0.02287702]
Stock Position:  -0.02287702372566108
Bond Position:  [26.14036594]


portfolio before change:  [23.95486837]
curr_Stock_Price:  95.67526565957877
curr_Factors:  [95.67526566]
mat_Sqrt:  [[0.15]]
grads:  [-0.09208908]
Stock Position:  -0.09208907988293559
Bond Position:  [32.76551555]


portfolio before change:  [24.00898905]
curr_Stock_Price:  95.13204451639376
curr_Factors:  [95.13204452]
mat_Sqrt:  [[0.15]]
grads:  [-0.15197372]
Stock Position:  -0.15197371516674937
Bond Position:  [38.46655929]


portfolio before change:  [23.95584888]
curr_Stock_Price:  95.51335248951226
curr_Factors:  [95.51335249]
mat_Sqrt:  [[0.15]]
grads:  [0.03120569]
Stock Position:  0.031205688988677125
Bond Position:  [20.97528891]


portfolio before change:  [23.95164263]
curr_Stock_Price:  95.2945357557111
curr_Factors:  [95.29453576]
mat_Sqrt:  [[0.15]]
grads:  [-0.07460697]
Stock Position:  -0.07460696672094565
Bond Position:  [31.06127889]


portfolio before change:  [23.95829375]
curr_Stock_Price:  95.25743166875397
curr_Factors:  [95.25743167]
mat_Sqrt:  [[0.15]]
grads:  [0.07413792]
Stock Position:  0.07413792416175152
Bond Position:  [16.89610551]


portfolio before change:  [23.98596337]
curr_Stock_Price:  95.60216031358809
curr_Factors:  [95.60216031]
mat_Sqrt:  [[0.15]]
grads:  [0.00149196]
Stock Position:  0.0014919553772891707
Bond Position:  [23.84332921]


portfolio before change:  [23.98837681]
curr_Stock_Price:  95.22201945353736
curr_Factors:  [95.22201945]
mat_Sqrt:  [[0.15]]
grads:  [0.16934701]
Stock Position:  0.16934700781155074
Bond Position:  [7.86281274]


portfolio before change:  [23.95026614]
curr_Stock_Price:  94.99117042297084
curr_Factors:  [94.99117042]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315617]
Stock Position:  -0.03156169531257576
Bond Position:  [26.94834851]


portfolio before change:  [23.94033099]
curr_Stock_Price:  95.41269078407656
curr_Factors:  [95.41269078]
mat_Sqrt:  [[0.15]]
grads:  [-0.21478423]
Stock Position:  -0.2147842275326876
Bond Position:  [44.43347208]


portfolio before change:  [24.21268008]
curr_Stock_Price:  94.17053925479749
curr_Factors:  [94.17053925]
mat_Sqrt:  [[0.15]]
grads:  [-0.05811354]
Stock Position:  -0.05811354449267154
Bond Position:  [29.6852639]


portfolio before change:  [24.22132783]
curr_Stock_Price:  94.08558726504396
curr_Factors:  [94.08558727]
mat_Sqrt:  [[0.15]]
grads:  [0.33312502]
Stock Position:  0.33312502221277424
Bond Position:  [-7.12093552]


portfolio before change:  [24.60321189]
curr_Stock_Price:  95.2346280292104
curr_Factors:  [95.23462803]
mat_Sqrt:  [[0.15]]
grads:  [0.00595739]
Stock Position:  0.005957393100571076
Bond Position:  [24.03586177]


portfolio before change:  [24.60805235]
curr_Stock_Price:  95.54278188769881
curr_Factors:  [95.54278189]
mat_Sqrt:  [[0.15]]
grads:  [-0.12252999]
Stock Position:  -0.12252998809199593
Bond Position:  [36.31490828]


portfolio before change:  [24.48202611]
curr_Stock_Price:  96.60836499657857
curr_Factors:  [96.608365]
mat_Sqrt:  [[0.15]]
grads:  [-0.29952558]
Stock Position:  -0.2995255790146278
Bond Position:  [53.41870258]


portfolio before change:  [24.41778991]
curr_Stock_Price:  96.84511925942387
curr_Factors:  [96.84511926]
mat_Sqrt:  [[0.15]]
grads:  [-0.15224944]
Stock Position:  -0.1522494437451236
Bond Position:  [39.16240545]


portfolio before change:  [24.40659784]
curr_Stock_Price:  96.95078582454539
curr_Factors:  [96.95078582]
mat_Sqrt:  [[0.15]]
grads:  [0.26573631]
Stock Position:  0.26573631360146677
Bond Position:  [-1.35674658]


portfolio before change:  [24.37439415]
curr_Stock_Price:  96.83023740418467
curr_Factors:  [96.8302374]
mat_Sqrt:  [[0.15]]
grads:  [-0.0065005]
Stock Position:  -0.006500497962275892
Bond Position:  [25.00383891]


portfolio before change:  [24.37602339]
curr_Stock_Price:  97.06043939233885
curr_Factors:  [97.06043939]
mat_Sqrt:  [[0.15]]
grads:  [0.02988839]
Stock Position:  0.02988839166148384
Bond Position:  [21.47504297]


portfolio before change:  [24.35777021]
curr_Stock_Price:  96.35990899268178
curr_Factors:  [96.35990899]
mat_Sqrt:  [[0.15]]
grads:  [0.09879764]
Stock Position:  0.09879763882724808
Bond Position:  [14.83763873]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.28341661]
Stock Price:  95.58855016787895
PL:  [24.28341661]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.13788345e-02]
 [-1.75915881e-03]
 [ 4.85674161e-03]
 [ 1.82917447e-03]
 [-2.90647902e-03]
 [ 2.92341026e-02]
 [ 3.70674791e-03]
 [ 7.62160542e-03]
 [-2.52694884e-02]
 [ 2.33956746e-02]
 [ 1.93148205e-02]
 [-1.31351447e-02]
 [-5.72049206e-03]
 [ 1.24942989e-02]
 [-1.05327332e-02]
 [-2.83187446e-03]
 [-6.08757573e-03]
 [ 5.56249435e-03]
 [ 6.30955023e-03]
 [-1.71535578e-02]
 [-4.85749801e-03]
 [-5.96357370e-03]
 [ 4.08561688e-03]
 [-1.24641237e-02]
 [ 2.19331064e-04]
 [ 4.01571659e-03]
 [ 5.42765454e-03]
 [ 1.17606284e-03]
 [ 4.66917244e-03]
 [-5.92262649e-03]
 [-1.86582220e-02]
 [ 1.49249878e-02]
 [-4.07760231e-03]
 [-1.77919619e-02]
 [-2.05955780e-02]
 [ 2.26616170e-02]
 [ 4.42351825e-03]
 [ 1.33776235e-02]
 [ 7.70574002e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.39447497]
curr_Stock_Price:  100.56968727889858
curr_Factors:  [100.56968728]
mat_Sqrt:  [[0.15]]
grads:  [-0.14252556]
Stock Position:  -0.1425255631686618
Bond Position:  [28.72822629]


portfolio before change:  [14.29878651]
curr_Stock_Price:  101.26626209275574
curr_Factors:  [101.26626209]
mat_Sqrt:  [[0.15]]
grads:  [-0.01172773]
Stock Position:  -0.011727725380078862
Bond Position:  [15.48640942]


portfolio before change:  [14.29430227]
curr_Stock_Price:  101.81369668963768
curr_Factors:  [101.81369669]
mat_Sqrt:  [[0.15]]
grads:  [0.03237828]
Stock Position:  0.032378277428078486
Bond Position:  [10.99775015]


portfolio before change:  [14.30796803]
curr_Stock_Price:  102.19330184139166
curr_Factors:  [102.19330184]
mat_Sqrt:  [[0.15]]
grads:  [0.0121945]
Stock Position:  0.012194496481120535
Bond Position:  [13.06177217]


portfolio before change:  [14.29804713]
curr_Stock_Price:  101.24584812573579
curr_Factors:  [101.24584813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01937653]
Stock Position:  -0.019376526767678374
Bond Position:  [16.25984002]


portfolio before change:  [14.29673881]
curr_Stock_Price:  101.41826948407794
curr_Factors:  [101.41826948]
mat_Sqrt:  [[0.15]]
grads:  [0.19489402]
Stock Position:  0.19489401701425088
Bond Position:  [-5.46907512]


portfolio before change:  [14.10895655]
curr_Stock_Price:  100.45826776942442
curr_Factors:  [100.45826777]
mat_Sqrt:  [[0.15]]
grads:  [0.02471165]
Stock Position:  0.024711652709009005
Bond Position:  [11.62646672]


portfolio before change:  [14.12862965]
curr_Stock_Price:  101.19555965974332
curr_Factors:  [101.19555966]
mat_Sqrt:  [[0.15]]
grads:  [0.0508107]
Stock Position:  0.05081070279260104
Bond Position:  [8.98681214]


portfolio before change:  [14.08704581]
curr_Stock_Price:  100.3550426321682
curr_Factors:  [100.35504263]
mat_Sqrt:  [[0.15]]
grads:  [-0.16846326]
Stock Position:  -0.1684632563170841
Bond Position:  [30.99318308]


portfolio before change:  [14.15572757]
curr_Stock_Price:  99.97034527311911
curr_Factors:  [99.97034527]
mat_Sqrt:  [[0.15]]
grads:  [0.15597116]
Stock Position:  0.15597116397519625
Bond Position:  [-1.43676355]


portfolio before change:  [14.12447627]
curr_Stock_Price:  99.77113094074167
curr_Factors:  [99.77113094]
mat_Sqrt:  [[0.15]]
grads:  [0.12876547]
Stock Position:  0.12876546998833863
Bond Position:  [1.2773997]


portfolio before change:  [13.98405788]
curr_Stock_Price:  98.67939354101398
curr_Factors:  [98.67939354]
mat_Sqrt:  [[0.15]]
grads:  [-0.08756763]
Stock Position:  -0.08756763127225844
Bond Position:  [22.62517862]


portfolio before change:  [14.06755647]
curr_Stock_Price:  97.75815968722122
curr_Factors:  [97.75815969]
mat_Sqrt:  [[0.15]]
grads:  [-0.03813661]
Stock Position:  -0.03813661374826412
Bond Position:  [17.79572164]


portfolio before change:  [14.08322856]
curr_Stock_Price:  97.40554607672426
curr_Factors:  [97.40554608]
mat_Sqrt:  [[0.15]]
grads:  [0.08329533]
Stock Position:  0.08329532584882673
Bond Position:  [5.96980186]


portfolio before change:  [14.21474581]
curr_Stock_Price:  98.9755138145903
curr_Factors:  [98.97551381]
mat_Sqrt:  [[0.15]]
grads:  [-0.07021822]
Stock Position:  -0.07021822125227634
Bond Position:  [21.16463033]


portfolio before change:  [14.15204751]
curr_Stock_Price:  99.90609903885718
curr_Factors:  [99.90609904]
mat_Sqrt:  [[0.15]]
grads:  [-0.01887916]
Stock Position:  -0.018879163034036864
Bond Position:  [16.03819104]


portfolio before change:  [14.14425481]
curr_Stock_Price:  100.42506259670684
curr_Factors:  [100.4250626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058384]
Stock Position:  -0.04058383820271247
Bond Position:  [18.2198893]


portfolio before change:  [14.1455784]
curr_Stock_Price:  100.4485704680464
curr_Factors:  [100.44857047]
mat_Sqrt:  [[0.15]]
grads:  [0.0370833]
Stock Position:  0.03708329567931902
Bond Position:  [10.42061436]


portfolio before change:  [14.12474918]
curr_Stock_Price:  99.85175520247495
curr_Factors:  [99.8517552]
mat_Sqrt:  [[0.15]]
grads:  [0.04206367]
Stock Position:  0.042063668216475295
Bond Position:  [9.92461808]


portfolio before change:  [14.1128228]
curr_Stock_Price:  99.53872883622604
curr_Factors:  [99.53872884]
mat_Sqrt:  [[0.15]]
grads:  [-0.11435705]
Stock Position:  -0.1143570520298414
Bond Position:  [25.49577839]


portfolio before change:  [14.02479367]
curr_Stock_Price:  100.33637358336067
curr_Factors:  [100.33637358]
mat_Sqrt:  [[0.15]]
grads:  [-0.03238332]
Stock Position:  -0.03238332007491081
Bond Position:  [17.27401857]


portfolio before change:  [13.98695499]
curr_Stock_Price:  101.57151753551116
curr_Factors:  [101.57151754]
mat_Sqrt:  [[0.15]]
grads:  [-0.03975716]
Stock Position:  -0.039757157990329244
Bond Position:  [18.02514986]


portfolio before change:  [13.92297962]
curr_Stock_Price:  103.2373474690669
curr_Factors:  [103.23734747]
mat_Sqrt:  [[0.15]]
grads:  [0.02723745]
Stock Position:  0.027237445893370547
Bond Position:  [11.11105795]


portfolio before change:  [13.90195127]
curr_Stock_Price:  102.41431468872094
curr_Factors:  [102.41431469]
mat_Sqrt:  [[0.15]]
grads:  [-0.08309416]
Stock Position:  -0.08309415802591157
Bond Position:  [22.41198252]


portfolio before change:  [13.86406731]
curr_Stock_Price:  102.9039476417544
curr_Factors:  [102.90394764]
mat_Sqrt:  [[0.15]]
grads:  [0.00146221]
Stock Position:  0.0014622070902523972
Bond Position:  [13.71360043]


portfolio before change:  [13.86636787]
curr_Stock_Price:  103.30488754077348
curr_Factors:  [103.30488754]
mat_Sqrt:  [[0.15]]
grads:  [0.02677144]
Stock Position:  0.026771443929419724
Bond Position:  [11.10074687]


portfolio before change:  [13.89071076]
curr_Stock_Price:  104.16233880551516
curr_Factors:  [104.16233881]
mat_Sqrt:  [[0.15]]
grads:  [0.03618436]
Stock Position:  0.03618436363215423
Bond Position:  [10.12166282]


portfolio before change:  [13.85410731]
curr_Stock_Price:  103.11578900447726
curr_Factors:  [103.115789]
mat_Sqrt:  [[0.15]]
grads:  [0.00784042]
Stock Position:  0.007840418926985514
Bond Position:  [13.04563633]


portfolio before change:  [13.85860742]
curr_Stock_Price:  103.48175217448343
curr_Factors:  [103.48175217]
mat_Sqrt:  [[0.15]]
grads:  [0.03112782]
Stock Position:  0.03112781623968894
Bond Position:  [10.63744645]


portfolio before change:  [13.84525256]
curr_Stock_Price:  103.00999977259283
curr_Factors:  [103.00999977]
mat_Sqrt:  [[0.15]]
grads:  [-0.03948418]
Stock Position:  -0.03948417656881239
Bond Position:  [17.91251758]


portfolio before change:  [13.85159526]
curr_Stock_Price:  102.90607222024364
curr_Factors:  [102.90607222]
mat_Sqrt:  [[0.15]]
grads:  [-0.12438815]
Stock Position:  -0.12438814657241107
Bond Position:  [26.65189086]


portfolio before change:  [13.96976085]
curr_Stock_Price:  101.98288223813451
curr_Factors:  [101.98288224]
mat_Sqrt:  [[0.15]]
grads:  [0.09949992]
Stock Position:  0.09949991856834917
Bond Position:  [3.82247237]


portfolio before change:  [13.87066349]
curr_Stock_Price:  100.98212565839592
curr_Factors:  [100.98212566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02718402]
Stock Position:  -0.02718401539424468
Bond Position:  [16.61576315]


portfolio before change:  [13.86945795]
curr_Stock_Price:  101.10288186283408
curr_Factors:  [101.10288186]
mat_Sqrt:  [[0.15]]
grads:  [-0.11861308]
Stock Position:  -0.11861307904975477
Bond Position:  [25.86158207]


portfolio before change:  [13.80840417]
curr_Stock_Price:  101.64486829548014
curr_Factors:  [101.6448683]
mat_Sqrt:  [[0.15]]
grads:  [-0.13730385]
Stock Position:  -0.13730385331092024
Bond Position:  [27.76463626]


portfolio before change:  [13.74528627]
curr_Stock_Price:  102.12984151038496
curr_Factors:  [102.12984151]
mat_Sqrt:  [[0.15]]
grads:  [0.15107745]
Stock Position:  0.15107744675539223
Bond Position:  [-1.68422942]


portfolio before change:  [13.71816485]
curr_Stock_Price:  101.9517150915777
curr_Factors:  [101.95171509]
mat_Sqrt:  [[0.15]]
grads:  [0.02949012]
Stock Position:  0.029490121665541012
Bond Position:  [10.71159637]


portfolio before change:  [13.70119236]
curr_Stock_Price:  101.33077751573569
curr_Factors:  [101.33077752]
mat_Sqrt:  [[0.15]]
grads:  [0.08918416]
Stock Position:  0.0891841569100695
Bond Position:  [4.66409239]


portfolio before change:  [13.66249699]
curr_Stock_Price:  100.89035829353426
curr_Factors:  [100.89035829]
mat_Sqrt:  [[0.15]]
grads:  [0.0513716]
Stock Position:  0.051371600158771756
Bond Position:  [8.47959784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.66554606]
Stock Price:  100.92907723222828
PL:  [12.73646883]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.97796010e-02]
 [ 3.12179368e-02]
 [-1.58089125e-02]
 [-7.44586173e-03]
 [-5.83927905e-03]
 [ 2.90633155e-02]
 [ 3.55994399e-03]
 [-1.21677364e-03]
 [-2.02571173e-02]
 [ 2.34049391e-02]
 [ 1.91993583e-02]
 [-1.25388126e-02]
 [ 1.37056913e-02]
 [ 2.33641702e-02]
 [-1.11704927e-02]
 [-3.64140274e-03]
 [-4.21111132e-03]
 [ 7.63848909e-03]
 [ 2.68288661e-02]
 [-2.49322375e-02]
 [-2.05687780e-03]
 [-3.33449920e-02]
 [ 9.89499700e-03]
 [-3.77634413e-03]
 [-1.57037955e-02]
 [ 4.88600938e-03]
 [ 6.73765609e-03]
 [ 3.24356463e-03]
 [ 5.46493975e-03]
 [ 5.57322343e-03]
 [-1.42041177e-02]
 [ 4.33800416e-03]
 [ 7.97771487e-03]
 [ 1.37027274e-02]
 [-2.01765222e-02]
 [-1.16954191e-02]
 [ 1.57358094e-02]
 [ 1.59170767e-02]
 [ 8.15434820e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.77384482]
curr_Stock_Price:  100.17705161452575
curr_Factors:  [100.17705161]
mat_Sqrt:  [[0.15]]
grads:  [0.13186401]
Stock Position:  0.13186400648726543
Bond Position:  [-7.43590256]


portfolio before change:  [5.66815978]
curr_Stock_Price:  99.38263093977245
curr_Factors:  [99.38263094]
mat_Sqrt:  [[0.15]]
grads:  [0.20811958]
Stock Position:  0.20811957834941996
Bond Position:  [-15.01531146]


portfolio before change:  [5.45939704]
curr_Stock_Price:  98.38855957938806
curr_Factors:  [98.38855958]
mat_Sqrt:  [[0.15]]
grads:  [-0.10539275]
Stock Position:  -0.10539275001004197
Bond Position:  [15.8288379]


portfolio before change:  [5.44410378]
curr_Stock_Price:  98.5524416851365
curr_Factors:  [98.55244169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04963908]
Stock Position:  -0.04963907817226608
Bond Position:  [10.33615614]


portfolio before change:  [5.45647857]
curr_Stock_Price:  98.32917630500208
curr_Factors:  [98.32917631]
mat_Sqrt:  [[0.15]]
grads:  [-0.03892853]
Stock Position:  -0.03892852701938341
Bond Position:  [9.28428857]


portfolio before change:  [5.42717814]
curr_Stock_Price:  99.1116625288504
curr_Factors:  [99.11166253]
mat_Sqrt:  [[0.15]]
grads:  [0.19375544]
Stock Position:  0.1937554365148748
Bond Position:  [-13.7762453]


portfolio before change:  [5.32594784]
curr_Stock_Price:  98.59808640954586
curr_Factors:  [98.59808641]
mat_Sqrt:  [[0.15]]
grads:  [0.02373296]
Stock Position:  0.023732959913210686
Bond Position:  [2.98592341]


portfolio before change:  [5.31154215]
curr_Stock_Price:  97.97536807797867
curr_Factors:  [97.97536808]
mat_Sqrt:  [[0.15]]
grads:  [-0.00811182]
Stock Position:  -0.008111824252565746
Bond Position:  [6.10630112]


portfolio before change:  [5.3078818]
curr_Stock_Price:  98.52070664525354
curr_Factors:  [98.52070665]
mat_Sqrt:  [[0.15]]
grads:  [-0.13504745]
Stock Position:  -0.13504744899138663
Bond Position:  [18.6128519]


portfolio before change:  [5.19797346]
curr_Stock_Price:  99.351785590358
curr_Factors:  [99.35178559]
mat_Sqrt:  [[0.15]]
grads:  [0.15603293]
Stock Position:  0.15603292725776194
Bond Position:  [-10.30417648]


portfolio before change:  [5.34672412]
curr_Stock_Price:  100.31336955075041
curr_Factors:  [100.31336955]
mat_Sqrt:  [[0.15]]
grads:  [0.12799572]
Stock Position:  0.12799572230730324
Bond Position:  [-7.49295808]


portfolio before change:  [5.47571847]
curr_Stock_Price:  101.32848966660079
curr_Factors:  [101.32848967]
mat_Sqrt:  [[0.15]]
grads:  [-0.08359208]
Stock Position:  -0.08359208392405558
Bond Position:  [13.94597808]


portfolio before change:  [5.40458696]
curr_Stock_Price:  102.20028117035372
curr_Factors:  [102.20028117]
mat_Sqrt:  [[0.15]]
grads:  [0.09137128]
Stock Position:  0.09137127512107003
Bond Position:  [-3.93358305]


portfolio before change:  [5.5081578]
curr_Stock_Price:  103.33917926923775
curr_Factors:  [103.33917927]
mat_Sqrt:  [[0.15]]
grads:  [0.15576113]
Stock Position:  0.15576113485937354
Bond Position:  [-10.58807004]


portfolio before change:  [5.43407974]
curr_Stock_Price:  102.87208925048625
curr_Factors:  [102.87208925]
mat_Sqrt:  [[0.15]]
grads:  [-0.07446995]
Stock Position:  -0.07446995134146608
Bond Position:  [13.09495922]


portfolio before change:  [5.35496943]
curr_Stock_Price:  103.95638264495797
curr_Factors:  [103.95638264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427602]
Stock Position:  -0.024276018251107916
Bond Position:  [7.87861648]


portfolio before change:  [5.32378566]
curr_Stock_Price:  105.28150378650658
curr_Factors:  [105.28150379]
mat_Sqrt:  [[0.15]]
grads:  [-0.02807408]
Stock Position:  -0.02807407546430266
Bond Position:  [8.27946654]


portfolio before change:  [5.32417559]
curr_Stock_Price:  105.3044809195202
curr_Factors:  [105.30448092]
mat_Sqrt:  [[0.15]]
grads:  [0.05092326]
Stock Position:  0.05092326058600026
Bond Position:  [-0.03827193]


portfolio before change:  [5.32756527]
curr_Stock_Price:  105.3711393388648
curr_Factors:  [105.37113934]
mat_Sqrt:  [[0.15]]
grads:  [0.17885911]
Stock Position:  0.17885910761728047
Bond Position:  [-13.51902268]


portfolio before change:  [5.72165618]
curr_Stock_Price:  107.58394748737025
curr_Factors:  [107.58394749]
mat_Sqrt:  [[0.15]]
grads:  [-0.16621492]
Stock Position:  -0.1662149166717573
Bond Position:  [23.60371305]


portfolio before change:  [5.70992464]
curr_Stock_Price:  107.67228003777554
curr_Factors:  [107.67228004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01371252]
Stock Position:  -0.013712518636504427
Bond Position:  [7.18638279]


portfolio before change:  [5.70868394]
curr_Stock_Price:  107.82827277329808
curr_Factors:  [107.82827277]
mat_Sqrt:  [[0.15]]
grads:  [-0.22229995]
Stock Position:  -0.22229994690046875
Bond Position:  [29.67890325]


portfolio before change:  [5.74859382]
curr_Stock_Price:  107.66543071011354
curr_Factors:  [107.66543071]
mat_Sqrt:  [[0.15]]
grads:  [0.06596665]
Stock Position:  0.06596664667010313
Bond Position:  [-1.35373361]


portfolio before change:  [5.72568428]
curr_Stock_Price:  107.3207063755554
curr_Factors:  [107.32070638]
mat_Sqrt:  [[0.15]]
grads:  [-0.02517563]
Stock Position:  -0.025175627527430144
Bond Position:  [8.42755041]


portfolio before change:  [5.70663836]
curr_Stock_Price:  108.11907489580916
curr_Factors:  [108.1190749]
mat_Sqrt:  [[0.15]]
grads:  [-0.10469197]
Stock Position:  -0.10469197017922996
Bond Position:  [17.02583733]


portfolio before change:  [5.86646434]
curr_Stock_Price:  106.61277393125222
curr_Factors:  [106.61277393]
mat_Sqrt:  [[0.15]]
grads:  [0.0325734]
Stock Position:  0.03257339586679754
Bond Position:  [2.39372425]


portfolio before change:  [5.85911429]
curr_Stock_Price:  106.37794146426377
curr_Factors:  [106.37794146]
mat_Sqrt:  [[0.15]]
grads:  [0.04491771]
Stock Position:  0.04491770727035673
Bond Position:  [1.08086105]


portfolio before change:  [5.86010144]
curr_Stock_Price:  106.39691031590068
curr_Factors:  [106.39691032]
mat_Sqrt:  [[0.15]]
grads:  [0.02162376]
Stock Position:  0.021623764197168556
Bond Position:  [3.55939974]


portfolio before change:  [5.86261282]
curr_Stock_Price:  106.49247332764222
curr_Factors:  [106.49247333]
mat_Sqrt:  [[0.15]]
grads:  [0.03643293]
Stock Position:  0.036432931677141685
Bond Position:  [1.98277982]


portfolio before change:  [5.86883569]
curr_Stock_Price:  106.65647344762364
curr_Factors:  [106.65647345]
mat_Sqrt:  [[0.15]]
grads:  [0.03715482]
Stock Position:  0.03715482288992259
Bond Position:  [1.90603331]


portfolio before change:  [5.8757579]
curr_Stock_Price:  106.83636770502517
curr_Factors:  [106.83636771]
mat_Sqrt:  [[0.15]]
grads:  [-0.09469412]
Stock Position:  -0.09469411829089577
Bond Position:  [15.99253354]


portfolio before change:  [5.94887269]
curr_Stock_Price:  106.08536435375385
curr_Factors:  [106.08536435]
mat_Sqrt:  [[0.15]]
grads:  [0.02892003]
Stock Position:  0.028920027743027807
Bond Position:  [2.88088101]


portfolio before change:  [5.95866093]
curr_Stock_Price:  106.41137048378185
curr_Factors:  [106.41137048]
mat_Sqrt:  [[0.15]]
grads:  [0.05318477]
Stock Position:  0.053184765800495734
Bond Position:  [0.29919711]


portfolio before change:  [5.8673992]
curr_Stock_Price:  104.69472972557573
curr_Factors:  [104.69472973]
mat_Sqrt:  [[0.15]]
grads:  [0.09135152]
Stock Position:  0.09135151571759084
Bond Position:  [-3.69662305]


portfolio before change:  [5.89186133]
curr_Stock_Price:  104.96756853229638
curr_Factors:  [104.96756853]
mat_Sqrt:  [[0.15]]
grads:  [-0.13451015]
Stock Position:  -0.1345101478652787
Bond Position:  [20.01106449]


portfolio before change:  [5.76355086]
curr_Stock_Price:  105.94007512178379
curr_Factors:  [105.94007512]
mat_Sqrt:  [[0.15]]
grads:  [-0.07796946]
Stock Position:  -0.07796946058454646
Bond Position:  [14.02364137]


portfolio before change:  [5.75305966]
curr_Stock_Price:  106.09711433850293
curr_Factors:  [106.09711434]
mat_Sqrt:  [[0.15]]
grads:  [0.1049054]
Stock Position:  0.10490539573152442
Bond Position:  [-5.3771001]


portfolio before change:  [5.84448165]
curr_Stock_Price:  106.97499256672324
curr_Factors:  [106.97499257]
mat_Sqrt:  [[0.15]]
grads:  [0.10611384]
Stock Position:  0.1061138444000055
Bond Position:  [-5.50704607]


portfolio before change:  [5.91629428]
curr_Stock_Price:  107.6582309922561
curr_Factors:  [107.65823099]
mat_Sqrt:  [[0.15]]
grads:  [0.05436232]
Stock Position:  0.05436232133325801
Bond Position:  [0.06374293]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.9212288]
Stock Price:  107.74885529877741
PL:  [-1.8276265]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.27255483e-02]
 [ 3.92338559e-02]
 [-2.47580400e-03]
 [-2.64190636e-03]
 [-2.61102378e-03]
 [ 2.00333406e-02]
 [ 3.54373907e-03]
 [ 1.66780926e-02]
 [-1.84097244e-02]
 [ 2.33692099e-02]
 [ 2.01149063e-02]
 [-1.36828035e-02]
 [ 1.32265101e-02]
 [ 2.33700962e-02]
 [-9.61836859e-03]
 [-3.45063640e-03]
 [-4.78931416e-03]
 [ 7.69951960e-03]
 [ 2.59074909e-02]
 [ 4.47804186e-03]
 [-9.55156203e-04]
 [-2.28762978e-02]
 [ 9.11512974e-03]
 [-4.81831132e-03]
 [-7.12401772e-03]
 [ 4.63445213e-03]
 [ 6.82030912e-03]
 [ 2.46169779e-03]
 [ 5.42752785e-03]
 [-1.84401670e-03]
 [-1.53121160e-02]
 [ 4.82643478e-03]
 [ 3.71332388e-03]
 [ 1.95307802e-02]
 [-2.02116662e-02]
 [ 5.23861876e-03]
 [ 9.36103565e-03]
 [ 1.87941321e-02]
 [ 8.59427107e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.77126104]
curr_Stock_Price:  99.51457947485001
curr_Factors:  [99.51457947]
mat_Sqrt:  [[0.15]]
grads:  [-0.08483699]
Stock Position:  -0.08483698859466753
Bond Position:  [-0.32874379]


portfolio before change:  [-8.80202892]
curr_Stock_Price:  99.87676566656592
curr_Factors:  [99.87676567]
mat_Sqrt:  [[0.15]]
grads:  [0.26155904]
Stock Position:  0.2615590393484573
Bond Position:  [-34.9256998]


portfolio before change:  [-8.7103087]
curr_Stock_Price:  100.24412519814511
curr_Factors:  [100.2441252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01650536]
Stock Position:  -0.0165053600136569
Bond Position:  [-7.05574332]


portfolio before change:  [-8.72808233]
curr_Stock_Price:  101.26752680109546
curr_Factors:  [101.2675268]
mat_Sqrt:  [[0.15]]
grads:  [-0.01761271]
Stock Position:  -0.017612709061420942
Bond Position:  [-6.94448684]


portfolio before change:  [-8.73224069]
curr_Stock_Price:  101.45433754969035
curr_Factors:  [101.45433755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01740683]
Stock Position:  -0.017406825209327972
Bond Position:  [-6.96624277]


portfolio before change:  [-8.73999874]
curr_Stock_Price:  101.84999957505129
curr_Factors:  [101.84999958]
mat_Sqrt:  [[0.15]]
grads:  [0.1335556]
Stock Position:  0.13355560412930506
Bond Position:  [-22.34263697]


portfolio before change:  [-8.72992511]
curr_Stock_Price:  101.9463387570623
curr_Factors:  [101.94633876]
mat_Sqrt:  [[0.15]]
grads:  [0.02362493]
Stock Position:  0.023624927161908102
Bond Position:  [-11.13839994]


portfolio before change:  [-8.72711311]
curr_Stock_Price:  102.1243027420977
curr_Factors:  [102.12430274]
mat_Sqrt:  [[0.15]]
grads:  [0.11118728]
Stock Position:  0.11118728404430694
Bond Position:  [-20.08203697]


portfolio before change:  [-8.84959495]
curr_Stock_Price:  101.0452995772141
curr_Factors:  [101.04529958]
mat_Sqrt:  [[0.15]]
grads:  [-0.1227315]
Stock Position:  -0.12273149625316812
Bond Position:  [3.55184585]


portfolio before change:  [-8.7710002]
curr_Stock_Price:  100.40853763080345
curr_Factors:  [100.40853763]
mat_Sqrt:  [[0.15]]
grads:  [0.15579473]
Stock Position:  0.1557947325266527
Bond Position:  [-24.41412146]


portfolio before change:  [-8.60172133]
curr_Stock_Price:  101.51467788693787
curr_Factors:  [101.51467789]
mat_Sqrt:  [[0.15]]
grads:  [0.13409938]
Stock Position:  0.13409937561726795
Bond Position:  [-22.21477625]


portfolio before change:  [-8.68088299]
curr_Stock_Price:  100.94506569663001
curr_Factors:  [100.9450657]
mat_Sqrt:  [[0.15]]
grads:  [-0.09121869]
Stock Position:  -0.0912186901974252
Bond Position:  [0.52719369]


portfolio before change:  [-8.80151706]
curr_Stock_Price:  102.26825919012052
curr_Factors:  [102.26825919]
mat_Sqrt:  [[0.15]]
grads:  [0.08817673]
Stock Position:  0.08817673405029436
Bond Position:  [-17.81919816]


portfolio before change:  [-8.72293794]
curr_Stock_Price:  103.18467627044926
curr_Factors:  [103.18467627]
mat_Sqrt:  [[0.15]]
grads:  [0.15580064]
Stock Position:  0.15580064100964536
Bond Position:  [-24.79917664]


portfolio before change:  [-8.5729017]
curr_Stock_Price:  104.16757545728302
curr_Factors:  [104.16757546]
mat_Sqrt:  [[0.15]]
grads:  [-0.06412246]
Stock Position:  -0.06412245726753223
Bond Position:  [-1.8934208]


portfolio before change:  [-8.54494954]
curr_Stock_Price:  103.72796574675156
curr_Factors:  [103.72796575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300424]
Stock Position:  -0.023004242638781203
Bond Position:  [-6.15876625]


portfolio before change:  [-8.55194927]
curr_Stock_Price:  103.9987779208399
curr_Factors:  [103.99877792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03192876]
Stock Position:  -0.031928761053656156
Bond Position:  [-5.23139714]


portfolio before change:  [-8.58774588]
curr_Stock_Price:  105.09943607223293
curr_Factors:  [105.09943607]
mat_Sqrt:  [[0.15]]
grads:  [0.05133013]
Stock Position:  0.051330130680145886
Bond Position:  [-13.98251367]


portfolio before change:  [-8.58699424]
curr_Stock_Price:  105.14813194509156
curr_Factors:  [105.14813195]
mat_Sqrt:  [[0.15]]
grads:  [0.17271661]
Stock Position:  0.17271660620274615
Bond Position:  [-26.74782274]


portfolio before change:  [-8.75110524]
curr_Stock_Price:  104.21731631301016
curr_Factors:  [104.21731631]
mat_Sqrt:  [[0.15]]
grads:  [0.02985361]
Stock Position:  0.029853612425066525
Bond Position:  [-11.86236861]


portfolio before change:  [-8.69201501]
curr_Stock_Price:  106.24632105051003
curr_Factors:  [106.24632105]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636771]
Stock Position:  -0.006367708020273942
Bond Position:  [-8.01546946]


portfolio before change:  [-8.69362072]
curr_Stock_Price:  106.34112978161998
curr_Factors:  [106.34112978]
mat_Sqrt:  [[0.15]]
grads:  [-0.15250865]
Stock Position:  -0.15250865230802874
Bond Position:  [7.52432167]


portfolio before change:  [-8.80399051]
curr_Stock_Price:  107.07099256748765
curr_Factors:  [107.07099257]
mat_Sqrt:  [[0.15]]
grads:  [0.06076753]
Stock Position:  0.060767531630507673
Bond Position:  [-15.31043044]


portfolio before change:  [-8.82869245]
curr_Stock_Price:  106.69598943957158
curr_Factors:  [106.69598944]
mat_Sqrt:  [[0.15]]
grads:  [-0.03212208]
Stock Position:  -0.03212207547554073
Bond Position:  [-5.40139583]


portfolio before change:  [-8.78554246]
curr_Stock_Price:  105.33165637128516
curr_Factors:  [105.33165637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04749345]
Stock Position:  -0.04749345148747552
Bond Position:  [-3.78297855]


portfolio before change:  [-8.78083692]
curr_Stock_Price:  105.22262160173632
curr_Factors:  [105.2226216]
mat_Sqrt:  [[0.15]]
grads:  [0.03089635]
Stock Position:  0.0308963475457671
Bond Position:  [-12.03183161]


portfolio before change:  [-8.78416597]
curr_Stock_Price:  105.16355406588735
curr_Factors:  [105.16355407]
mat_Sqrt:  [[0.15]]
grads:  [0.04546873]
Stock Position:  0.0454687274385664
Bond Position:  [-13.56581894]


portfolio before change:  [-8.78038501]
curr_Stock_Price:  105.2840058889244
curr_Factors:  [105.28400589]
mat_Sqrt:  [[0.15]]
grads:  [0.01641132]
Stock Position:  0.016411318618962403
Bond Position:  [-10.50823437]


portfolio before change:  [-8.77388339]
curr_Stock_Price:  105.76021553385397
curr_Factors:  [105.76021553]
mat_Sqrt:  [[0.15]]
grads:  [0.03618352]
Stock Position:  0.03618351902715683
Bond Position:  [-12.60066016]


portfolio before change:  [-8.79442645]
curr_Stock_Price:  105.23600224476137
curr_Factors:  [105.23600224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229344]
Stock Position:  -0.012293444682871609
Bond Position:  [-7.50071348]


portfolio before change:  [-8.79180593]
curr_Stock_Price:  104.94656550076188
curr_Factors:  [104.9465655]
mat_Sqrt:  [[0.15]]
grads:  [-0.10208077]
Stock Position:  -0.10208077339340103
Bond Position:  [1.92122064]


portfolio before change:  [-8.82684364]
curr_Stock_Price:  105.29215335972219
curr_Factors:  [105.29215336]
mat_Sqrt:  [[0.15]]
grads:  [0.03217623]
Stock Position:  0.032176231857127875
Bond Position:  [-12.21474837]


portfolio before change:  [-8.84153592]
curr_Stock_Price:  104.88298977705865
curr_Factors:  [104.88298978]
mat_Sqrt:  [[0.15]]
grads:  [0.02475549]
Stock Position:  0.024755492561955028
Bond Position:  [-11.43796599]


portfolio before change:  [-8.84084514]
curr_Stock_Price:  104.96865221483246
curr_Factors:  [104.96865221]
mat_Sqrt:  [[0.15]]
grads:  [0.1302052]
Stock Position:  0.13020520147358966
Bond Position:  [-22.50830965]


portfolio before change:  [-8.91574194]
curr_Stock_Price:  104.41504074931073
curr_Factors:  [104.41504075]
mat_Sqrt:  [[0.15]]
grads:  [-0.13474444]
Stock Position:  -0.13474444148090203
Bond Position:  [5.15360441]


portfolio before change:  [-8.89728784]
curr_Stock_Price:  104.28286566462539
curr_Factors:  [104.28286566]
mat_Sqrt:  [[0.15]]
grads:  [0.03492413]
Stock Position:  0.034924125095003096
Bond Position:  [-12.53927569]


portfolio before change:  [-8.87974313]
curr_Stock_Price:  104.83011536784034
curr_Factors:  [104.83011537]
mat_Sqrt:  [[0.15]]
grads:  [0.0624069]
Stock Position:  0.0624069043325598
Bond Position:  [-15.42186612]


portfolio before change:  [-8.80305378]
curr_Stock_Price:  106.08986718330583
curr_Factors:  [106.08986718]
mat_Sqrt:  [[0.15]]
grads:  [0.12529421]
Stock Position:  0.1252942141482178
Bond Position:  [-22.09550032]


portfolio before change:  [-8.78755951]
curr_Stock_Price:  106.23557527388144
curr_Factors:  [106.23557527]
mat_Sqrt:  [[0.15]]
grads:  [0.05729514]
Stock Position:  0.0572951404899776
Bond Position:  [-14.87434172]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.77536364]
Stock Price:  106.48088885729166
PL:  [-15.2562525]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.17613302e-02]
 [ 3.84757051e-02]
 [-3.68827168e-03]
 [-6.27872433e-03]
 [-3.63036603e-03]
 [ 3.31030243e-02]
 [ 3.74867982e-03]
 [ 6.54969471e-03]
 [-1.26172004e-02]
 [ 2.32221015e-02]
 [ 1.95046470e-02]
 [-9.17495625e-03]
 [ 2.86274904e-02]
 [ 1.87196605e-02]
 [-7.79064342e-03]
 [-3.62115376e-03]
 [-5.93524418e-03]
 [ 5.81721558e-03]
 [ 6.18459295e-03]
 [-1.07443267e-02]
 [-5.06130784e-03]
 [-5.02909972e-03]
 [ 6.69557473e-03]
 [-6.92431077e-03]
 [ 1.52102041e-02]
 [ 8.21205936e-03]
 [-4.97061493e-03]
 [-1.02521545e-03]
 [ 1.99634808e-03]
 [-6.09570507e-03]
 [-1.93664400e-02]
 [ 1.41019717e-02]
 [-3.37128407e-03]
 [-1.80069918e-02]
 [-2.09441887e-02]
 [ 2.71752748e-02]
 [ 4.73145252e-03]
 [ 1.30597766e-02]
 [ 8.61881369e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.5902738]
curr_Stock_Price:  99.47727667737438
curr_Factors:  [99.47727668]
mat_Sqrt:  [[0.15]]
grads:  [-0.07840887]
Stock Position:  -0.07840886810784689
Bond Position:  [-1.79037313]


portfolio before change:  [-9.61900482]
curr_Stock_Price:  99.84084794155673
curr_Factors:  [99.84084794]
mat_Sqrt:  [[0.15]]
grads:  [0.2565047]
Stock Position:  0.2565047005041012
Bond Position:  [-35.22865162]


portfolio before change:  [-9.33066659]
curr_Stock_Price:  100.98212170327189
curr_Factors:  [100.9821217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02458848]
Stock Position:  -0.024588477844567937
Bond Position:  [-6.84766993]


portfolio before change:  [-9.30685096]
curr_Stock_Price:  99.97873922634471
curr_Factors:  [99.97873923]
mat_Sqrt:  [[0.15]]
grads:  [-0.04185816]
Stock Position:  -0.04185816223289979
Bond Position:  [-5.12192467]


portfolio before change:  [-9.35032068]
curr_Stock_Price:  101.00194318008887
curr_Factors:  [101.00194318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02420244]
Stock Position:  -0.02420244019200981
Bond Position:  [-6.90582719]


portfolio before change:  [-9.34500068]
curr_Stock_Price:  100.74646177655859
curr_Factors:  [100.74646178]
mat_Sqrt:  [[0.15]]
grads:  [0.22068683]
Stock Position:  0.22068682887280086
Bond Position:  [-31.57841785]


portfolio before change:  [-9.32377664]
curr_Stock_Price:  100.86052203794068
curr_Factors:  [100.86052204]
mat_Sqrt:  [[0.15]]
grads:  [0.0249912]
Stock Position:  0.02499119877576375
Bond Position:  [-11.84440199]


portfolio before change:  [-9.32213462]
curr_Stock_Price:  100.98547252664186
curr_Factors:  [100.98547253]
mat_Sqrt:  [[0.15]]
grads:  [0.04366463]
Stock Position:  0.04366463140313251
Bond Position:  [-13.73162805]


portfolio before change:  [-9.28729608]
curr_Stock_Price:  101.82265116222189
curr_Factors:  [101.82265116]
mat_Sqrt:  [[0.15]]
grads:  [-0.08411467]
Stock Position:  -0.08411466951435817
Bond Position:  [-0.72251743]


portfolio before change:  [-9.21047202]
curr_Stock_Price:  100.90825198719166
curr_Factors:  [100.90825199]
mat_Sqrt:  [[0.15]]
grads:  [0.15481401]
Stock Position:  0.15481400989470662
Bond Position:  [-24.83248314]


portfolio before change:  [-9.25585566]
curr_Stock_Price:  100.63515400704091
curr_Factors:  [100.63515401]
mat_Sqrt:  [[0.15]]
grads:  [0.13003098]
Stock Position:  0.1300309802624065
Bond Position:  [-22.34154339]


portfolio before change:  [-9.09124464]
curr_Stock_Price:  101.92256946669896
curr_Factors:  [101.92256947]
mat_Sqrt:  [[0.15]]
grads:  [-0.06116637]
Stock Position:  -0.06116637498327354
Bond Position:  [-2.85701053]


portfolio before change:  [-9.03658802]
curr_Stock_Price:  101.02315748231861
curr_Factors:  [101.02315748]
mat_Sqrt:  [[0.15]]
grads:  [0.19084994]
Stock Position:  0.1908499359950242
Bond Position:  [-28.31685116]


portfolio before change:  [-8.9523652]
curr_Stock_Price:  101.48300907601164
curr_Factors:  [101.48300908]
mat_Sqrt:  [[0.15]]
grads:  [0.12479774]
Stock Position:  0.12479773634977201
Bond Position:  [-21.61721501]


portfolio before change:  [-8.96083189]
curr_Stock_Price:  101.43681934855803
curr_Factors:  [101.43681935]
mat_Sqrt:  [[0.15]]
grads:  [-0.05193762]
Stock Position:  -0.05193762279524938
Bond Position:  [-3.69244463]


portfolio before change:  [-8.95505028]
curr_Stock_Price:  101.31661371630653
curr_Factors:  [101.31661372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02414103]
Stock Position:  -0.024141025050644773
Bond Position:  [-6.50916337]


portfolio before change:  [-8.95692125]
curr_Stock_Price:  101.36040945538154
curr_Factors:  [101.36040946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03956829]
Stock Position:  -0.039568294515242367
Bond Position:  [-4.94626272]


portfolio before change:  [-8.92817982]
curr_Stock_Price:  100.61840761706694
curr_Factors:  [100.61840762]
mat_Sqrt:  [[0.15]]
grads:  [0.03878144]
Stock Position:  0.038781437228553386
Bond Position:  [-12.83030628]


portfolio before change:  [-8.9674886]
curr_Stock_Price:  99.6461669893993
curr_Factors:  [99.64616699]
mat_Sqrt:  [[0.15]]
grads:  [0.04123062]
Stock Position:  0.04123061965533383
Bond Position:  [-13.07596181]


portfolio before change:  [-8.96008572]
curr_Stock_Price:  99.8653602764584
curr_Factors:  [99.86536028]
mat_Sqrt:  [[0.15]]
grads:  [-0.07162884]
Stock Position:  -0.07162884460690862
Bond Position:  [-1.80684535]


portfolio before change:  [-9.02073047]
curr_Stock_Price:  100.70885957437211
curr_Factors:  [100.70885957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03374205]
Stock Position:  -0.03374205228456192
Bond Position:  [-5.62260687]


portfolio before change:  [-8.99842038]
curr_Stock_Price:  100.02683325863266
curr_Factors:  [100.02683326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352733]
Stock Position:  -0.033527331447507865
Bond Position:  [-5.64478758]


portfolio before change:  [-8.95539906]
curr_Stock_Price:  98.72261494494312
curr_Factors:  [98.72261494]
mat_Sqrt:  [[0.15]]
grads:  [0.04463716]
Stock Position:  0.044637164856096784
Bond Position:  [-13.3620967]


portfolio before change:  [-8.98029134]
curr_Stock_Price:  98.20237774245855
curr_Factors:  [98.20237774]
mat_Sqrt:  [[0.15]]
grads:  [-0.04616207]
Stock Position:  -0.04616207178446188
Bond Position:  [-4.44706613]


portfolio before change:  [-9.01404687]
curr_Stock_Price:  98.92157441877954
curr_Factors:  [98.92157442]
mat_Sqrt:  [[0.15]]
grads:  [0.10140136]
Stock Position:  0.10140136070673839
Bond Position:  [-19.04482912]


portfolio before change:  [-8.9407842]
curr_Stock_Price:  99.66755475653912
curr_Factors:  [99.66755476]
mat_Sqrt:  [[0.15]]
grads:  [0.05474706]
Stock Position:  0.05474706237715858
Bond Position:  [-14.39729003]


portfolio before change:  [-8.91436923]
curr_Stock_Price:  100.18292018542095
curr_Factors:  [100.18292019]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313743]
Stock Position:  -0.033137432890528305
Bond Position:  [-5.59456443]


portfolio before change:  [-8.94518889]
curr_Stock_Price:  101.09187109863971
curr_Factors:  [101.0918711]
mat_Sqrt:  [[0.15]]
grads:  [-0.00683477]
Stock Position:  -0.006834769652225171
Bond Position:  [-8.25424924]


portfolio before change:  [-8.95070952]
curr_Stock_Price:  101.74862839061366
curr_Factors:  [101.74862839]
mat_Sqrt:  [[0.15]]
grads:  [0.01330899]
Stock Position:  0.013308987170316939
Bond Position:  [-10.30488071]


portfolio before change:  [-8.93992883]
curr_Stock_Price:  102.65545043300338
curr_Factors:  [102.65545043]
mat_Sqrt:  [[0.15]]
grads:  [-0.04063803]
Stock Position:  -0.04063803379406451
Bond Position:  [-4.76821317]


portfolio before change:  [-8.93096644]
curr_Stock_Price:  102.42024089437206
curr_Factors:  [102.42024089]
mat_Sqrt:  [[0.15]]
grads:  [-0.1291096]
Stock Position:  -0.12910959972109587
Bond Position:  [4.29246986]


portfolio before change:  [-8.89308826]
curr_Stock_Price:  102.13101694800498
curr_Factors:  [102.13101695]
mat_Sqrt:  [[0.15]]
grads:  [0.09401314]
Stock Position:  0.09401314458981701
Bond Position:  [-18.49474632]


portfolio before change:  [-8.94593778]
curr_Stock_Price:  101.59345874853364
curr_Factors:  [101.59345875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247523]
Stock Position:  -0.022475227144241185
Bond Position:  [-6.66260172]


portfolio before change:  [-8.9384078]
curr_Stock_Price:  101.22136639066403
curr_Factors:  [101.22136639]
mat_Sqrt:  [[0.15]]
grads:  [-0.12004661]
Stock Position:  -0.12004661178922821
Bond Position:  [3.21287427]


portfolio before change:  [-8.90379975]
curr_Stock_Price:  100.93642361854248
curr_Factors:  [100.93642362]
mat_Sqrt:  [[0.15]]
grads:  [-0.13962792]
Stock Position:  -0.1396279246040599
Bond Position:  [5.18974359]


portfolio before change:  [-8.9083495]
curr_Stock_Price:  100.97365475002383
curr_Factors:  [100.97365475]
mat_Sqrt:  [[0.15]]
grads:  [0.1811685]
Stock Position:  0.18116849841407043
Bond Position:  [-27.20159491]


portfolio before change:  [-8.88106039]
curr_Stock_Price:  101.14305241461105
curr_Factors:  [101.14305241]
mat_Sqrt:  [[0.15]]
grads:  [0.03154302]
Stock Position:  0.03154301680059753
Bond Position:  [-12.07141739]


portfolio before change:  [-8.8790197]
curr_Stock_Price:  101.25558794377672
curr_Factors:  [101.25558794]
mat_Sqrt:  [[0.15]]
grads:  [0.08706518]
Stock Position:  0.08706517763712388
Bond Position:  [-17.69485545]


portfolio before change:  [-8.8531288]
curr_Stock_Price:  101.57836797465997
curr_Factors:  [101.57836797]
mat_Sqrt:  [[0.15]]
grads:  [0.05745876]
Stock Position:  0.05745875790053275
Bond Position:  [-14.68969565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.78490681]
Stock Price:  102.79764796910932
PL:  [-11.58255478]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.19234629e-02]
 [ 3.23001410e-03]
 [-1.33434923e-02]
 [-8.66872503e-03]
 [-5.85972162e-03]
 [ 3.92624115e-02]
 [ 3.54623216e-03]
 [-1.76015394e-03]
 [-2.16753806e-02]
 [ 2.34374170e-02]
 [ 1.91821057e-02]
 [-1.52923902e-02]
 [ 3.20032954e-02]
 [ 9.88912034e-03]
 [-1.19169316e-02]
 [-3.74722925e-03]
 [-5.73851875e-03]
 [ 6.64323121e-03]
 [ 1.28586737e-02]
 [ 1.40081104e-02]
 [-4.80915656e-03]
 [-4.51829816e-03]
 [ 7.03829036e-03]
 [-6.50084588e-03]
 [ 1.43541942e-02]
 [ 7.04768096e-03]
 [ 5.28125839e-03]
 [-3.77737673e-03]
 [-1.83712477e-02]
 [-1.01982932e-02]
 [ 4.58985221e-02]
 [-1.52475094e-04]
 [-2.10074863e-02]
 [-2.19257596e-02]
 [-2.38854563e-02]
 [ 3.01248034e-02]
 [-1.22409410e-02]
 [-1.34505735e-02]
 [ 4.61277900e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.17959367]
curr_Stock_Price:  100.10443976938674
curr_Factors:  [100.10443977]
mat_Sqrt:  [[0.15]]
grads:  [0.14615642]
Stock Position:  0.14615641939982724
Bond Position:  [-10.45131282]


portfolio before change:  [3.9059932]
curr_Stock_Price:  98.24140856406162
curr_Factors:  [98.24140856]
mat_Sqrt:  [[0.15]]
grads:  [0.02153343]
Stock Position:  0.021533427338989813
Bond Position:  [1.79051897]


portfolio before change:  [3.88521195]
curr_Stock_Price:  97.26594485752851
curr_Factors:  [97.26594486]
mat_Sqrt:  [[0.15]]
grads:  [-0.08895662]
Stock Position:  -0.0889566151903183
Bond Position:  [12.53766118]


portfolio before change:  [3.87445093]
curr_Stock_Price:  97.40453291484441
curr_Factors:  [97.40453291]
mat_Sqrt:  [[0.15]]
grads:  [-0.0577915]
Stock Position:  -0.057791500222825753
Bond Position:  [9.50360502]


portfolio before change:  [3.82125893]
curr_Stock_Price:  98.34550217396094
curr_Factors:  [98.34550217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03906481]
Stock Position:  -0.03906481078938958
Bond Position:  [7.66310737]


portfolio before change:  [3.82367311]
curr_Stock_Price:  98.30822492647907
curr_Factors:  [98.30822493]
mat_Sqrt:  [[0.15]]
grads:  [0.26174941]
Stock Position:  0.2617494096970135
Bond Position:  [-21.90844673]


portfolio before change:  [4.09842457]
curr_Stock_Price:  99.36836175632739
curr_Factors:  [99.36836176]
mat_Sqrt:  [[0.15]]
grads:  [0.02364155]
Stock Position:  0.023641547759510804
Bond Position:  [1.7492027]


portfolio before change:  [4.06865844]
curr_Stock_Price:  98.10005238868386
curr_Factors:  [98.10005239]
mat_Sqrt:  [[0.15]]
grads:  [-0.01173436]
Stock Position:  -0.011734359575274102
Bond Position:  [5.21979973]


portfolio before change:  [4.06305756]
curr_Stock_Price:  98.63296543357822
curr_Factors:  [98.63296543]
mat_Sqrt:  [[0.15]]
grads:  [-0.14450254]
Stock Position:  -0.14450253764764093
Bond Position:  [18.31577136]


portfolio before change:  [4.02930849]
curr_Stock_Price:  98.88236370963475
curr_Factors:  [98.88236371]
mat_Sqrt:  [[0.15]]
grads:  [0.15624945]
Stock Position:  0.15624944663079035
Bond Position:  [-11.42100612]


portfolio before change:  [4.24029549]
curr_Stock_Price:  100.24182270570599
curr_Factors:  [100.24182271]
mat_Sqrt:  [[0.15]]
grads:  [0.1278807]
Stock Position:  0.1278807049486234
Bond Position:  [-8.57869946]


portfolio before change:  [4.1721164]
curr_Stock_Price:  99.71706263687513
curr_Factors:  [99.71706264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10194927]
Stock Position:  -0.10194926778050796
Bond Position:  [14.33819792]


portfolio before change:  [4.07099737]
curr_Stock_Price:  100.72650020177656
curr_Factors:  [100.7265002]
mat_Sqrt:  [[0.15]]
grads:  [0.2133553]
Stock Position:  0.21335530245196088
Bond Position:  [-17.41953555]


portfolio before change:  [4.06580614]
curr_Stock_Price:  100.71237516334725
curr_Factors:  [100.71237516]
mat_Sqrt:  [[0.15]]
grads:  [0.06592747]
Stock Position:  0.06592746894191996
Bond Position:  [-2.57390585]


portfolio before change:  [4.16679486]
curr_Stock_Price:  102.2490711845639
curr_Factors:  [102.24907118]
mat_Sqrt:  [[0.15]]
grads:  [-0.07944621]
Stock Position:  -0.07944621099692287
Bond Position:  [12.29009614]


portfolio before change:  [4.29159181]
curr_Stock_Price:  100.69757376693549
curr_Factors:  [100.69757377]
mat_Sqrt:  [[0.15]]
grads:  [-0.02498153]
Stock Position:  -0.024981528346475115
Bond Position:  [6.8071711]


portfolio before change:  [4.26699144]
curr_Stock_Price:  101.71637936070563
curr_Factors:  [101.71637936]
mat_Sqrt:  [[0.15]]
grads:  [-0.03825679]
Stock Position:  -0.03825679168097247
Bond Position:  [8.15833377]


portfolio before change:  [4.28319073]
curr_Stock_Price:  101.31960184132205
curr_Factors:  [101.31960184]
mat_Sqrt:  [[0.15]]
grads:  [0.04428821]
Stock Position:  0.04428820807052675
Bond Position:  [-0.20407288]


portfolio before change:  [4.31284834]
curr_Stock_Price:  101.98982826153876
curr_Factors:  [101.98982826]
mat_Sqrt:  [[0.15]]
grads:  [0.08572449]
Stock Position:  0.08572449120821458
Bond Position:  [-4.43017779]


portfolio before change:  [4.27038087]
curr_Stock_Price:  101.50089375022996
curr_Factors:  [101.50089375]
mat_Sqrt:  [[0.15]]
grads:  [0.0933874]
Stock Position:  0.09338740273306649
Bond Position:  [-5.20852397]


portfolio before change:  [4.21026061]
curr_Stock_Price:  100.86409312625787
curr_Factors:  [100.86409313]
mat_Sqrt:  [[0.15]]
grads:  [-0.03206104]
Stock Position:  -0.03206104376462278
Bond Position:  [7.44406872]


portfolio before change:  [4.23394902]
curr_Stock_Price:  100.15426457373738
curr_Factors:  [100.15426457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03012199]
Stock Position:  -0.030121987743624772
Bond Position:  [7.25079455]


portfolio before change:  [4.24138942]
curr_Stock_Price:  99.93734698552224
curr_Factors:  [99.93734699]
mat_Sqrt:  [[0.15]]
grads:  [0.04692194]
Stock Position:  0.04692193570042895
Bond Position:  [-0.44786435]


portfolio before change:  [4.18197344]
curr_Stock_Price:  98.67226729985221
curr_Factors:  [98.6722673]
mat_Sqrt:  [[0.15]]
grads:  [-0.04333897]
Stock Position:  -0.04333897251877062
Bond Position:  [8.45832812]


portfolio before change:  [4.19854973]
curr_Stock_Price:  98.31418485905522
curr_Factors:  [98.31418486]
mat_Sqrt:  [[0.15]]
grads:  [0.09569463]
Stock Position:  0.09569462790623638
Bond Position:  [-5.20958961]


portfolio before change:  [4.21821491]
curr_Stock_Price:  98.52648958905324
curr_Factors:  [98.52648959]
mat_Sqrt:  [[0.15]]
grads:  [0.04698454]
Stock Position:  0.04698453970805201
Bond Position:  [-0.41100685]


portfolio before change:  [4.18739458]
curr_Stock_Price:  97.87161560939228
curr_Factors:  [97.87161561]
mat_Sqrt:  [[0.15]]
grads:  [0.03520839]
Stock Position:  0.03520838928724712
Bond Position:  [0.74149263]


portfolio before change:  [4.16410601]
curr_Stock_Price:  97.2075336715252
curr_Factors:  [97.20753367]
mat_Sqrt:  [[0.15]]
grads:  [-0.02518251]
Stock Position:  -0.02518251152482811
Bond Position:  [6.61203585]


portfolio before change:  [4.17026743]
curr_Stock_Price:  96.99568605080118
curr_Factors:  [96.99568605]
mat_Sqrt:  [[0.15]]
grads:  [-0.12247498]
Stock Position:  -0.12247498488014454
Bond Position:  [16.04981261]


portfolio before change:  [4.33804877]
curr_Stock_Price:  95.64214438282401
curr_Factors:  [95.64214438]
mat_Sqrt:  [[0.15]]
grads:  [-0.06798862]
Stock Position:  -0.06798862130855413
Bond Position:  [10.84062631]


portfolio before change:  [4.39125823]
curr_Stock_Price:  94.87945357768096
curr_Factors:  [94.87945358]
mat_Sqrt:  [[0.15]]
grads:  [0.30599015]
Stock Position:  0.30599014759224374
Bond Position:  [-24.64091977]


portfolio before change:  [4.42295365]
curr_Stock_Price:  94.99310339398127
curr_Factors:  [94.99310339]
mat_Sqrt:  [[0.15]]
grads:  [-0.0010165]
Stock Position:  -0.0010165006246332562
Bond Position:  [4.5195142]


portfolio before change:  [4.42387641]
curr_Stock_Price:  94.64112823298656
curr_Factors:  [94.64112823]
mat_Sqrt:  [[0.15]]
grads:  [-0.14004991]
Stock Position:  -0.14004990854755134
Bond Position:  [17.67835776]


portfolio before change:  [4.46764263]
curr_Stock_Price:  94.34440335437304
curr_Factors:  [94.34440335]
mat_Sqrt:  [[0.15]]
grads:  [-0.14617173]
Stock Position:  -0.14617173042110965
Bond Position:  [18.25812732]


portfolio before change:  [4.55151119]
curr_Stock_Price:  93.78625062481252
curr_Factors:  [93.78625062]
mat_Sqrt:  [[0.15]]
grads:  [-0.15923638]
Stock Position:  -0.1592363753423237
Bond Position:  [19.4856938]


portfolio before change:  [4.69744826]
curr_Stock_Price:  92.88506705915285
curr_Factors:  [92.88506706]
mat_Sqrt:  [[0.15]]
grads:  [0.20083202]
Stock Position:  0.20083202250707372
Bond Position:  [-13.95684762]


portfolio before change:  [4.59458538]
curr_Stock_Price:  92.38157083776358
curr_Factors:  [92.38157084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08160627]
Stock Position:  -0.08160627322209672
Bond Position:  [12.13350109]


portfolio before change:  [4.66240318]
curr_Stock_Price:  91.56912082701521
curr_Factors:  [91.56912083]
mat_Sqrt:  [[0.15]]
grads:  [-0.08967049]
Stock Position:  -0.0896704902553607
Bond Position:  [12.87345114]


portfolio before change:  [4.63012825]
curr_Stock_Price:  91.94699556132792
curr_Factors:  [91.94699556]
mat_Sqrt:  [[0.15]]
grads:  [0.3075186]
Stock Position:  0.3075185999661718
Bond Position:  [-23.6452831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.72852468]
Stock Price:  92.27657651507988
PL:  [4.72852468]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.80593214e-02]
 [ 3.99603635e-02]
 [-1.64811961e-02]
 [-7.50887644e-03]
 [-5.05385478e-03]
 [ 4.97422471e-02]
 [ 3.54876840e-03]
 [-5.86501695e-04]
 [-2.10964096e-02]
 [ 2.34418811e-02]
 [ 2.14190247e-02]
 [-5.06047432e-03]
 [-2.16997350e-02]
 [ 1.74706347e-02]
 [-3.81579134e-03]
 [-1.63586474e-03]
 [-6.06614760e-03]
 [-5.08081833e-03]
 [ 1.81928936e-03]
 [ 4.51042842e-03]
 [-1.59464057e-02]
 [-2.24680304e-02]
 [ 4.38712701e-03]
 [-1.11408072e-02]
 [ 1.19274165e-02]
 [ 1.55286470e-03]
 [ 2.39758480e-02]
 [-4.67390272e-03]
 [-2.74591763e-02]
 [-1.12555078e-02]
 [ 3.65297280e-02]
 [ 4.01358926e-03]
 [-1.61854866e-02]
 [-3.69003105e-02]
 [-2.30648230e-02]
 [ 3.56458007e-02]
 [-3.79384977e-03]
 [ 8.80460641e-04]
 [ 1.38665018e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.34522187]
curr_Stock_Price:  100.20307558303374
curr_Factors:  [100.20307558]
mat_Sqrt:  [[0.15]]
grads:  [0.12039548]
Stock Position:  0.12039547624383591
Bond Position:  [-5.71877514]


portfolio before change:  [6.30964323]
curr_Stock_Price:  99.9134986729501
curr_Factors:  [99.91349867]
mat_Sqrt:  [[0.15]]
grads:  [0.26640242]
Stock Position:  0.2664024234891141
Bond Position:  [-20.30755496]


portfolio before change:  [6.05696614]
curr_Stock_Price:  98.97454893795297
curr_Factors:  [98.97454894]
mat_Sqrt:  [[0.15]]
grads:  [-0.10987464]
Stock Position:  -0.10987464097597623
Bond Position:  [16.93175917]


portfolio before change:  [6.11463942]
curr_Stock_Price:  98.46891200058263
curr_Factors:  [98.468912]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005918]
Stock Position:  -0.05005917629579609
Bond Position:  [11.04391205]


portfolio before change:  [6.154415]
curr_Stock_Price:  97.70191972514691
curr_Factors:  [97.70191973]
mat_Sqrt:  [[0.15]]
grads:  [-0.03369237]
Stock Position:  -0.033692365215125496
Bond Position:  [9.44622376]


portfolio before change:  [6.16908431]
curr_Stock_Price:  97.30157806551662
curr_Factors:  [97.30157807]
mat_Sqrt:  [[0.15]]
grads:  [0.33161498]
Stock Position:  0.33161498072003814
Bond Position:  [-26.09757663]


portfolio before change:  [6.11040129]
curr_Stock_Price:  97.13445469425835
curr_Factors:  [97.13445469]
mat_Sqrt:  [[0.15]]
grads:  [0.02365846]
Stock Position:  0.023658455982234927
Bond Position:  [3.81235007]


portfolio before change:  [6.12741438]
curr_Stock_Price:  97.8334231239329
curr_Factors:  [97.83342312]
mat_Sqrt:  [[0.15]]
grads:  [-0.00391001]
Stock Position:  -0.003910011302094748
Bond Position:  [6.50994417]


portfolio before change:  [6.12528114]
curr_Stock_Price:  98.58713854841963
curr_Factors:  [98.58713855]
mat_Sqrt:  [[0.15]]
grads:  [-0.14064273]
Stock Position:  -0.14064273060285748
Bond Position:  [19.9908455]


portfolio before change:  [6.17657429]
curr_Stock_Price:  98.24020171523061
curr_Factors:  [98.24020172]
mat_Sqrt:  [[0.15]]
grads:  [0.15627921]
Stock Position:  0.15627920750672175
Bond Position:  [-9.17632658]


portfolio before change:  [6.00812449]
curr_Stock_Price:  97.16966461713223
curr_Factors:  [97.16966462]
mat_Sqrt:  [[0.15]]
grads:  [0.1427935]
Stock Position:  0.14279349828876642
Bond Position:  [-7.86707185]


portfolio before change:  [5.87355276]
curr_Stock_Price:  96.2341298275364
curr_Factors:  [96.23412983]
mat_Sqrt:  [[0.15]]
grads:  [-0.0337365]
Stock Position:  -0.0337364954850613
Bond Position:  [9.12015505]


portfolio before change:  [5.8755225]
curr_Stock_Price:  96.20953791218801
curr_Factors:  [96.20953791]
mat_Sqrt:  [[0.15]]
grads:  [-0.1446649]
Stock Position:  -0.1446649000861505
Bond Position:  [19.79366568]


portfolio before change:  [5.98762714]
curr_Stock_Price:  95.45171565366977
curr_Factors:  [95.45171565]
mat_Sqrt:  [[0.15]]
grads:  [0.1164709]
Stock Position:  0.11647089801834594
Bond Position:  [-5.1297199]


portfolio before change:  [5.95815086]
curr_Stock_Price:  95.20414285564229
curr_Factors:  [95.20414286]
mat_Sqrt:  [[0.15]]
grads:  [-0.02543861]
Stock Position:  -0.025438608949752466
Bond Position:  [8.38001182]


portfolio before change:  [5.96569877]
curr_Stock_Price:  94.94861235413059
curr_Factors:  [94.94861235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01090576]
Stock Position:  -0.010905764923277416
Bond Position:  [7.00118601]


portfolio before change:  [5.96191577]
curr_Stock_Price:  95.37574417312666
curr_Factors:  [95.37574417]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044098]
Stock Position:  -0.04044098398172502
Bond Position:  [9.81900471]


portfolio before change:  [5.95686671]
curr_Stock_Price:  95.53094600786787
curr_Factors:  [95.53094601]
mat_Sqrt:  [[0.15]]
grads:  [-0.03387212]
Stock Position:  -0.033872122228145306
Bond Position:  [9.19270259]


portfolio before change:  [5.98748446]
curr_Stock_Price:  94.6609504164926
curr_Factors:  [94.66095042]
mat_Sqrt:  [[0.15]]
grads:  [0.0121286]
Stock Position:  0.012128595755407288
Bond Position:  [4.83938006]


portfolio before change:  [5.99474277]
curr_Stock_Price:  95.2095173801434
curr_Factors:  [95.20951738]
mat_Sqrt:  [[0.15]]
grads:  [0.03006952]
Stock Position:  0.030069522811239
Bond Position:  [3.13183802]


portfolio before change:  [5.99437878]
curr_Stock_Price:  95.18439243795719
curr_Factors:  [95.18439244]
mat_Sqrt:  [[0.15]]
grads:  [-0.10630937]
Stock Position:  -0.10630937131975667
Bond Position:  [16.1133717]


portfolio before change:  [5.98518674]
curr_Stock_Price:  95.28980491381739
curr_Factors:  [95.28980491]
mat_Sqrt:  [[0.15]]
grads:  [-0.14978687]
Stock Position:  -0.14978686909358482
Bond Position:  [20.25834828]


portfolio before change:  [6.05226748]
curr_Stock_Price:  94.85887070427944
curr_Factors:  [94.8588707]
mat_Sqrt:  [[0.15]]
grads:  [0.02924751]
Stock Position:  0.029247513433307247
Bond Position:  [3.27788139]


portfolio before change:  [6.06692741]
curr_Stock_Price:  95.34609731358297
curr_Factors:  [95.34609731]
mat_Sqrt:  [[0.15]]
grads:  [-0.07427205]
Stock Position:  -0.07427204773131758
Bond Position:  [13.1484773]


portfolio before change:  [6.01602608]
curr_Stock_Price:  96.05356383652541
curr_Factors:  [96.05356384]
mat_Sqrt:  [[0.15]]
grads:  [0.07951611]
Stock Position:  0.07951611013159691
Bond Position:  [-1.62177968]


portfolio before change:  [6.02719773]
curr_Stock_Price:  96.19660885022478
curr_Factors:  [96.19660885]
mat_Sqrt:  [[0.15]]
grads:  [0.01035243]
Stock Position:  0.010352431342497137
Bond Position:  [5.03132894]


portfolio before change:  [6.02042183]
curr_Stock_Price:  95.48133133413255
curr_Factors:  [95.48133133]
mat_Sqrt:  [[0.15]]
grads:  [0.15983899]
Stock Position:  0.1598389867665935
Bond Position:  [-9.24121743]


portfolio before change:  [5.96326352]
curr_Stock_Price:  95.13095948368989
curr_Factors:  [95.13095948]
mat_Sqrt:  [[0.15]]
grads:  [-0.03115935]
Stock Position:  -0.031159351468251033
Bond Position:  [8.92748252]


portfolio before change:  [5.94011794]
curr_Stock_Price:  95.90958894352077
curr_Factors:  [95.90958894]
mat_Sqrt:  [[0.15]]
grads:  [-0.18306118]
Stock Position:  -0.18306117503617436
Bond Position:  [23.49743999]


portfolio before change:  [5.89084882]
curr_Stock_Price:  96.19477493329138
curr_Factors:  [96.19477493]
mat_Sqrt:  [[0.15]]
grads:  [-0.07503672]
Stock Position:  -0.07503671877617978
Bond Position:  [13.10898909]


portfolio before change:  [5.8377805]
curr_Stock_Price:  96.92384522965115
curr_Factors:  [96.92384523]
mat_Sqrt:  [[0.15]]
grads:  [0.24353152]
Stock Position:  0.24353151999055592
Bond Position:  [-17.76623085]


portfolio before change:  [5.67159995]
curr_Stock_Price:  96.25058684837069
curr_Factors:  [96.25058685]
mat_Sqrt:  [[0.15]]
grads:  [0.02675726]
Stock Position:  0.02675726176161591
Bond Position:  [3.0961978]


portfolio before change:  [5.67279951]
curr_Stock_Price:  96.28095318588323
curr_Factors:  [96.28095319]
mat_Sqrt:  [[0.15]]
grads:  [-0.10790324]
Stock Position:  -0.10790324390622191
Bond Position:  [16.06182669]


portfolio before change:  [5.73249905]
curr_Stock_Price:  95.74629199981446
curr_Factors:  [95.746292]
mat_Sqrt:  [[0.15]]
grads:  [-0.24600207]
Stock Position:  -0.24600207023809972
Bond Position:  [29.28628509]


portfolio before change:  [5.62912314]
curr_Stock_Price:  96.18139776782344
curr_Factors:  [96.18139777]
mat_Sqrt:  [[0.15]]
grads:  [-0.15376549]
Stock Position:  -0.15376548683665475
Bond Position:  [20.41850259]


portfolio before change:  [5.81386878]
curr_Stock_Price:  94.99652088458492
curr_Factors:  [94.99652088]
mat_Sqrt:  [[0.15]]
grads:  [0.23763867]
Stock Position:  0.2376386714067445
Bond Position:  [-16.76097823]


portfolio before change:  [5.9657677]
curr_Stock_Price:  95.64453901618197
curr_Factors:  [95.64453902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02529233]
Stock Position:  -0.0252923318073068
Bond Position:  [8.38484111]


portfolio before change:  [5.95506385]
curr_Stock_Price:  96.10918654560408
curr_Factors:  [96.10918655]
mat_Sqrt:  [[0.15]]
grads:  [0.00586974]
Stock Position:  0.005869737605311837
Bond Position:  [5.39092814]


portfolio before change:  [5.95809777]
curr_Stock_Price:  96.51125174412157
curr_Factors:  [96.51125174]
mat_Sqrt:  [[0.15]]
grads:  [0.09244335]
Stock Position:  0.09244334543108548
Bond Position:  [-2.96372521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.91066072]
Stock Price:  96.00211218220414
PL:  [5.91066072]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.11498535e-03]
 [ 3.28408195e-02]
 [-1.25198657e-02]
 [-7.69144426e-03]
 [-4.49458452e-03]
 [ 5.08760251e-02]
 [ 3.55984932e-03]
 [-1.18091085e-03]
 [-2.76610732e-02]
 [ 2.34054201e-02]
 [ 1.93390007e-02]
 [-1.52060655e-02]
 [ 9.24772309e-03]
 [ 6.38864550e-03]
 [-8.63290226e-03]
 [-8.85905377e-04]
 [-6.02126431e-03]
 [ 3.27430471e-03]
 [ 5.07729477e-03]
 [-2.07066627e-02]
 [-4.04373288e-03]
 [-7.50850104e-03]
 [ 7.04101770e-03]
 [-9.19352607e-03]
 [ 1.45725251e-02]
 [ 8.00390173e-03]
 [-7.70450168e-03]
 [-2.14244408e-03]
 [ 9.15843592e-04]
 [-6.71890643e-03]
 [-2.52265447e-02]
 [ 1.84138851e-02]
 [-4.03913683e-03]
 [-2.03004656e-02]
 [-2.03337541e-02]
 [ 1.34591268e-02]
 [ 9.14776836e-03]
 [ 2.36297011e-02]
 [ 8.67357696e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.54007635]
curr_Stock_Price:  99.70729323044588
curr_Factors:  [99.70729323]
mat_Sqrt:  [[0.15]]
grads:  [0.00743324]
Stock Position:  0.00743323563533356
Bond Position:  [-5.28122415]


portfolio before change:  [-4.54196204]
curr_Stock_Price:  99.54242581912189
curr_Factors:  [99.54242582]
mat_Sqrt:  [[0.15]]
grads:  [0.2189388]
Stock Position:  0.2189387968992831
Bond Position:  [-26.33566099]


portfolio before change:  [-4.61942286]
curr_Stock_Price:  99.20366147664652
curr_Factors:  [99.20366148]
mat_Sqrt:  [[0.15]]
grads:  [-0.08346577]
Stock Position:  -0.08346577149372113
Bond Position:  [3.66068728]


portfolio before change:  [-4.53736991]
curr_Stock_Price:  98.22607116594143
curr_Factors:  [98.22607117]
mat_Sqrt:  [[0.15]]
grads:  [-0.0512763]
Stock Position:  -0.05127629504940128
Bond Position:  [0.49929909]


portfolio before change:  [-4.48752865]
curr_Stock_Price:  97.25527456368485
curr_Factors:  [97.25527456]
mat_Sqrt:  [[0.15]]
grads:  [-0.0299639]
Stock Position:  -0.02996389681859711
Bond Position:  [-1.57338163]


portfolio before change:  [-4.48531569]
curr_Stock_Price:  97.17485650881048
curr_Factors:  [97.17485651]
mat_Sqrt:  [[0.15]]
grads:  [0.3391735]
Stock Position:  0.33917350083160225
Bond Position:  [-37.44445197]


portfolio before change:  [-4.00634178]
curr_Stock_Price:  98.60083688600142
curr_Factors:  [98.60083689]
mat_Sqrt:  [[0.15]]
grads:  [0.02373233]
Stock Position:  0.023732328811865343
Bond Position:  [-6.34636927]


portfolio before change:  [-3.99802993]
curr_Stock_Price:  98.98449928068314
curr_Factors:  [98.98449928]
mat_Sqrt:  [[0.15]]
grads:  [-0.00787274]
Stock Position:  -0.007872738974514465
Bond Position:  [-3.2187508]


portfolio before change:  [-3.99977162]
curr_Stock_Price:  99.15462140492983
curr_Factors:  [99.1546214]
mat_Sqrt:  [[0.15]]
grads:  [-0.18440715]
Stock Position:  -0.18440715446004013
Bond Position:  [14.28504996]


portfolio before change:  [-4.0833916]
curr_Stock_Price:  99.61775807869286
curr_Factors:  [99.61775808]
mat_Sqrt:  [[0.15]]
grads:  [0.15603613]
Stock Position:  0.15603613396242352
Bond Position:  [-19.62736144]


portfolio before change:  [-4.06523013]
curr_Stock_Price:  99.7498751505566
curr_Factors:  [99.74987515]
mat_Sqrt:  [[0.15]]
grads:  [0.12892667]
Stock Position:  0.1289266711352567
Bond Position:  [-16.92564948]


portfolio before change:  [-4.10338193]
curr_Stock_Price:  99.47036775644624
curr_Factors:  [99.47036776]
mat_Sqrt:  [[0.15]]
grads:  [-0.10137377]
Stock Position:  -0.10137377019867846
Bond Position:  [5.98030427]


portfolio before change:  [-4.04372935]
curr_Stock_Price:  98.88930030456454
curr_Factors:  [98.8893003]
mat_Sqrt:  [[0.15]]
grads:  [0.06165149]
Stock Position:  0.06165148723551336
Bond Position:  [-10.14040178]


portfolio before change:  [-4.03219984]
curr_Stock_Price:  99.09687253101333
curr_Factors:  [99.09687253]
mat_Sqrt:  [[0.15]]
grads:  [0.04259097]
Stock Position:  0.042590970025985476
Bond Position:  [-8.25283177]


portfolio before change:  [-4.01681046]
curr_Stock_Price:  99.48242482863967
curr_Factors:  [99.48242483]
mat_Sqrt:  [[0.15]]
grads:  [-0.05755268]
Stock Position:  -0.05755268176556465
Bond Position:  [1.70866988]


portfolio before change:  [-3.99163226]
curr_Stock_Price:  99.04865528074357
curr_Factors:  [99.04865528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590604]
Stock Position:  -0.0059060358450825
Bond Position:  [-3.40664736]


portfolio before change:  [-3.9901084]
curr_Stock_Price:  98.7185321645164
curr_Factors:  [98.71853216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04014176]
Stock Position:  -0.040141762056079826
Bond Position:  [-0.02737257]


portfolio before change:  [-3.98234676]
curr_Stock_Price:  98.52509113180953
curr_Factors:  [98.52509113]
mat_Sqrt:  [[0.15]]
grads:  [0.0218287]
Stock Position:  0.021828698097387807
Bond Position:  [-6.13302123]


portfolio before change:  [-3.97684705]
curr_Stock_Price:  98.81216192885908
curr_Factors:  [98.81216193]
mat_Sqrt:  [[0.15]]
grads:  [0.03384863]
Stock Position:  0.03384863177782701
Bond Position:  [-7.32150354]


portfolio before change:  [-3.96302043]
curr_Stock_Price:  99.24768540029818
curr_Factors:  [99.2476854]
mat_Sqrt:  [[0.15]]
grads:  [-0.13804442]
Stock Position:  -0.13804441786389862
Bond Position:  [9.73756853]


portfolio before change:  [-4.03352808]
curr_Stock_Price:  99.76726398924995
curr_Factors:  [99.76726399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02695822]
Stock Position:  -0.026958219231085732
Bond Position:  [-1.3439803]


portfolio before change:  [-4.02389733]
curr_Stock_Price:  99.40378469502708
curr_Factors:  [99.4037847]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005667]
Stock Position:  -0.05005667359403198
Bond Position:  [0.95192547]


portfolio before change:  [-4.04315096]
curr_Stock_Price:  99.79079865417789
curr_Factors:  [99.79079865]
mat_Sqrt:  [[0.15]]
grads:  [0.04694012]
Stock Position:  0.04694011801702865
Bond Position:  [-8.72734283]


portfolio before change:  [-4.01195928]
curr_Stock_Price:  100.47854021864978
curr_Factors:  [100.47854022]
mat_Sqrt:  [[0.15]]
grads:  [-0.06129017]
Stock Position:  -0.06129017377286827
Bond Position:  [2.14638791]


portfolio before change:  [-3.96736926]
curr_Stock_Price:  99.75539483545255
curr_Factors:  [99.75539484]
mat_Sqrt:  [[0.15]]
grads:  [0.09715017]
Stock Position:  0.09715016716783688
Bond Position:  [-13.65862254]


portfolio before change:  [-3.92900956]
curr_Stock_Price:  100.16781956687143
curr_Factors:  [100.16781957]
mat_Sqrt:  [[0.15]]
grads:  [0.05335934]
Stock Position:  0.053359344876983225
Bond Position:  [-9.27389879]


portfolio before change:  [-3.96589108]
curr_Stock_Price:  99.49835464219579
curr_Factors:  [99.49835464]
mat_Sqrt:  [[0.15]]
grads:  [-0.05136334]
Stock Position:  -0.051363344537967766
Bond Position:  [1.14467719]


portfolio before change:  [-3.97147862]
curr_Stock_Price:  99.60992506214457
curr_Factors:  [99.60992506]
mat_Sqrt:  [[0.15]]
grads:  [-0.01428296]
Stock Position:  -0.014282960534230223
Bond Position:  [-2.54875399]


portfolio before change:  [-3.99042412]
curr_Stock_Price:  100.91405833034365
curr_Factors:  [100.91405833]
mat_Sqrt:  [[0.15]]
grads:  [0.00610562]
Stock Position:  0.006105623947136066
Bond Position:  [-4.60656741]


portfolio before change:  [-3.99042644]
curr_Stock_Price:  101.00799388080378
curr_Factors:  [101.00799388]
mat_Sqrt:  [[0.15]]
grads:  [-0.04479271]
Stock Position:  -0.04479270952702269
Bond Position:  [0.53399529]


portfolio before change:  [-4.00559198]
curr_Stock_Price:  101.34805589546382
curr_Factors:  [101.3480559]
mat_Sqrt:  [[0.15]]
grads:  [-0.16817696]
Stock Position:  -0.16817696439302307
Bond Position:  [13.0388164]


portfolio before change:  [-3.97349619]
curr_Stock_Price:  101.1669024313082
curr_Factors:  [101.16690243]
mat_Sqrt:  [[0.15]]
grads:  [0.12275923]
Stock Position:  0.12275923381852553
Bond Position:  [-16.39266762]


portfolio before change:  [-3.99684328]
curr_Stock_Price:  100.99340938026674
curr_Factors:  [100.99340938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02692758]
Stock Position:  -0.02692757887894543
Bond Position:  [-1.27733528]


portfolio before change:  [-4.02835267]
curr_Stock_Price:  102.15763287891481
curr_Factors:  [102.15763288]
mat_Sqrt:  [[0.15]]
grads:  [-0.13533644]
Stock Position:  -0.13533643728034464
Bond Position:  [9.7972974]


portfolio before change:  [-4.14361066]
curr_Stock_Price:  103.01832290312672
curr_Factors:  [103.0183229]
mat_Sqrt:  [[0.15]]
grads:  [-0.13555836]
Stock Position:  -0.13555836047250322
Bond Position:  [9.8213843]


portfolio before change:  [-4.2161201]
curr_Stock_Price:  103.56227452625303
curr_Factors:  [103.56227453]
mat_Sqrt:  [[0.15]]
grads:  [0.08972751]
Stock Position:  0.08972751175119154
Bond Position:  [-13.5085053]


portfolio before change:  [-4.10785187]
curr_Stock_Price:  104.78772806851256
curr_Factors:  [104.78772807]
mat_Sqrt:  [[0.15]]
grads:  [0.06098512]
Stock Position:  0.06098512237565387
Bond Position:  [-10.49834429]


portfolio before change:  [-4.13462957]
curr_Stock_Price:  104.37016177884028
curr_Factors:  [104.37016178]
mat_Sqrt:  [[0.15]]
grads:  [0.15753134]
Stock Position:  0.1575313409542935
Bond Position:  [-20.57620111]


portfolio before change:  [-3.87306716]
curr_Stock_Price:  106.04687319585086
curr_Factors:  [106.0468732]
mat_Sqrt:  [[0.15]]
grads:  [0.05782385]
Stock Position:  0.057823846388767995
Bond Position:  [-10.00510527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.85347322]
Stock Price:  106.40735861471538
PL:  [-10.26083184]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.17499574e-03]
 [ 2.82858880e-02]
 [-2.36613213e-03]
 [-6.90035287e-03]
 [-7.51889051e-03]
 [ 2.79033223e-02]
 [ 3.62285091e-03]
 [-1.17967338e-03]
 [-2.16929817e-02]
 [ 2.34208137e-02]
 [ 1.94038990e-02]
 [-1.36702709e-02]
 [ 3.20170511e-02]
 [ 1.41475003e-02]
 [ 6.69292263e-03]
 [-3.74818351e-03]
 [-6.10319341e-03]
 [ 5.27480767e-03]
 [ 6.13949720e-03]
 [-1.40377273e-02]
 [-4.64907055e-03]
 [-5.66116612e-03]
 [ 6.99373349e-03]
 [-7.07200231e-03]
 [ 1.46246638e-02]
 [ 6.69488438e-03]
 [ 2.07678920e-03]
 [-2.43986816e-03]
 [ 1.10434687e-03]
 [-7.99741444e-03]
 [-2.50928168e-02]
 [ 1.50289754e-02]
 [-3.40666310e-03]
 [-2.02193094e-02]
 [-2.04330409e-02]
 [ 2.11157469e-02]
 [ 3.12690420e-03]
 [ 1.53548492e-02]
 [ 8.57544459e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.86938405]
curr_Stock_Price:  100.40913330653365
curr_Factors:  [100.40913331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03449997]
Stock Position:  -0.03449997160993423
Bond Position:  [14.3334963]


portfolio before change:  [10.85756084]
curr_Stock_Price:  100.80377170150318
curr_Factors:  [100.8037717]
mat_Sqrt:  [[0.15]]
grads:  [0.18857259]
Stock Position:  0.1885725866023414
Bond Position:  [-8.15126713]


portfolio before change:  [10.77707892]
curr_Stock_Price:  100.38237990069953
curr_Factors:  [100.3823799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01577421]
Stock Position:  -0.01577421417766544
Bond Position:  [12.36053208]


portfolio before change:  [10.79148419]
curr_Stock_Price:  99.5671189870732
curr_Factors:  [99.56711899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600235]
Stock Position:  -0.04600235247303435
Bond Position:  [15.37180589]


portfolio before change:  [10.79305547]
curr_Stock_Price:  99.57473399901242
curr_Factors:  [99.574734]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012594]
Stock Position:  -0.050125936716010185
Bond Position:  [15.78433229]


portfolio before change:  [10.79949349]
curr_Stock_Price:  99.48566124538233
curr_Factors:  [99.48566125]
mat_Sqrt:  [[0.15]]
grads:  [0.18602215]
Stock Position:  0.18602214838463763
Bond Position:  [-7.70704294]


portfolio before change:  [10.87060246]
curr_Stock_Price:  99.87310114434021
curr_Factors:  [99.87310114]
mat_Sqrt:  [[0.15]]
grads:  [0.02415234]
Stock Position:  0.024152339410048875
Bond Position:  [8.45843342]


portfolio before change:  [10.85045988]
curr_Stock_Price:  98.99534165798889
curr_Factors:  [98.99534166]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786449]
Stock Position:  -0.007864489189416192
Bond Position:  [11.62900768]


portfolio before change:  [10.85475255]
curr_Stock_Price:  98.6343586000389
curr_Factors:  [98.6343586]
mat_Sqrt:  [[0.15]]
grads:  [-0.14461988]
Stock Position:  -0.14461987823714068
Bond Position:  [25.11924148]


portfolio before change:  [10.77704539]
curr_Stock_Price:  99.19339143269157
curr_Factors:  [99.19339143]
mat_Sqrt:  [[0.15]]
grads:  [0.15613876]
Stock Position:  0.15613875775288288
Bond Position:  [-4.71088753]


portfolio before change:  [10.85443753]
curr_Stock_Price:  99.69282568320214
curr_Factors:  [99.69282568]
mat_Sqrt:  [[0.15]]
grads:  [0.12935933]
Stock Position:  0.12935932687228344
Bond Position:  [-2.04175929]


portfolio before change:  [11.01686722]
curr_Stock_Price:  100.95044605592632
curr_Factors:  [100.95044606]
mat_Sqrt:  [[0.15]]
grads:  [-0.09113514]
Stock Position:  -0.09113513950395703
Bond Position:  [20.21700021]


portfolio before change:  [11.03908092]
curr_Stock_Price:  100.7344326557596
curr_Factors:  [100.73443266]
mat_Sqrt:  [[0.15]]
grads:  [0.21344701]
Stock Position:  0.21344700712118156
Bond Position:  [-10.46238225]


portfolio before change:  [11.11359408]
curr_Stock_Price:  101.08965453919238
curr_Factors:  [101.08965454]
mat_Sqrt:  [[0.15]]
grads:  [0.09431667]
Stock Position:  0.0943166688576185
Bond Position:  [1.57915461]


portfolio before change:  [11.07760464]
curr_Stock_Price:  100.70598051323142
curr_Factors:  [100.70598051]
mat_Sqrt:  [[0.15]]
grads:  [0.04461948]
Stock Position:  0.044619484184246286
Bond Position:  [6.58415573]


portfolio before change:  [11.07759921]
curr_Stock_Price:  100.6874125298476
curr_Factors:  [100.68741253]
mat_Sqrt:  [[0.15]]
grads:  [-0.02498789]
Stock Position:  -0.02498789004917533
Bond Position:  [13.59356521]


portfolio before change:  [11.09213135]
curr_Stock_Price:  100.17385038392281
curr_Factors:  [100.17385038]
mat_Sqrt:  [[0.15]]
grads:  [-0.04068796]
Stock Position:  -0.040687956070807337
Bond Position:  [15.16800057]


portfolio before change:  [11.09749848]
curr_Stock_Price:  100.08854224363063
curr_Factors:  [100.08854224]
mat_Sqrt:  [[0.15]]
grads:  [0.03516538]
Stock Position:  0.03516538445422941
Bond Position:  [7.57784641]


portfolio before change:  [11.08131159]
curr_Stock_Price:  99.60129659799408
curr_Factors:  [99.6012966]
mat_Sqrt:  [[0.15]]
grads:  [0.04092998]
Stock Position:  0.04092998130623252
Bond Position:  [7.00463238]


portfolio before change:  [11.08640241]
curr_Stock_Price:  99.70428196810194
curr_Factors:  [99.70428197]
mat_Sqrt:  [[0.15]]
grads:  [-0.09358485]
Stock Position:  -0.09358484898502833
Bond Position:  [20.41721258]


portfolio before change:  [11.05068645]
curr_Stock_Price:  100.1131972162086
curr_Factors:  [100.11319722]
mat_Sqrt:  [[0.15]]
grads:  [-0.0309938]
Stock Position:  -0.030993803686946687
Bond Position:  [14.15357523]


portfolio before change:  [11.06045022]
curr_Stock_Price:  99.8552598838863
curr_Factors:  [99.85525988]
mat_Sqrt:  [[0.15]]
grads:  [-0.03774111]
Stock Position:  -0.0377411074929607
Bond Position:  [14.82909832]


portfolio before change:  [11.08749547]
curr_Stock_Price:  99.18777825314022
curr_Factors:  [99.18777825]
mat_Sqrt:  [[0.15]]
grads:  [0.04662489]
Stock Position:  0.046624889910613206
Bond Position:  [6.46287623]


portfolio before change:  [11.10684676]
curr_Stock_Price:  99.58549255515824
curr_Factors:  [99.58549256]
mat_Sqrt:  [[0.15]]
grads:  [-0.04714668]
Stock Position:  -0.0471466820461688
Bond Position:  [15.80197232]


portfolio before change:  [11.16049604]
curr_Stock_Price:  98.48946837501444
curr_Factors:  [98.48946838]
mat_Sqrt:  [[0.15]]
grads:  [0.09749776]
Stock Position:  0.09749775881821857
Bond Position:  [1.5579936]


portfolio before change:  [11.14826823]
curr_Stock_Price:  98.36205445582895
curr_Factors:  [98.36205446]
mat_Sqrt:  [[0.15]]
grads:  [0.04463256]
Stock Position:  0.04463256251123714
Bond Position:  [6.75811768]


portfolio before change:  [11.1408533]
curr_Stock_Price:  98.17699338636159
curr_Factors:  [98.17699339]
mat_Sqrt:  [[0.15]]
grads:  [0.01384526]
Stock Position:  0.013845261305877021
Bond Position:  [9.78156717]


portfolio before change:  [11.15588944]
curr_Stock_Price:  99.17468983721913
curr_Factors:  [99.17468984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01626579]
Stock Position:  -0.016265787732815278
Bond Position:  [12.76904389]


portfolio before change:  [11.12614853]
curr_Stock_Price:  101.10125710485983
curr_Factors:  [101.1012571]
mat_Sqrt:  [[0.15]]
grads:  [0.00736231]
Stock Position:  0.007362312461838538
Bond Position:  [10.38180949]


portfolio before change:  [11.12359598]
curr_Stock_Price:  100.57827522529175
curr_Factors:  [100.57827523]
mat_Sqrt:  [[0.15]]
grads:  [-0.0533161]
Stock Position:  -0.05331609629594985
Bond Position:  [16.48603699]


portfolio before change:  [11.08381252]
curr_Stock_Price:  101.36311029743929
curr_Factors:  [101.3631103]
mat_Sqrt:  [[0.15]]
grads:  [-0.16728545]
Stock Position:  -0.16728544544833854
Bond Position:  [28.04038558]


portfolio before change:  [10.98700085]
curr_Stock_Price:  101.96278557344993
curr_Factors:  [101.96278557]
mat_Sqrt:  [[0.15]]
grads:  [0.10019317]
Stock Position:  0.10019316966025338
Bond Position:  [0.77102617]


portfolio before change:  [10.91593255]
curr_Stock_Price:  101.2525108527306
curr_Factors:  [101.25251085]
mat_Sqrt:  [[0.15]]
grads:  [-0.02271109]
Stock Position:  -0.022711087336870276
Bond Position:  [13.21548717]


portfolio before change:  [10.89771815]
curr_Stock_Price:  102.12725739320538
curr_Factors:  [102.12725739]
mat_Sqrt:  [[0.15]]
grads:  [-0.1347954]
Stock Position:  -0.13479539600134657
Bond Position:  [24.66400225]


portfolio before change:  [10.91040647]
curr_Stock_Price:  102.05600030960727
curr_Factors:  [102.05600031]
mat_Sqrt:  [[0.15]]
grads:  [-0.13622027]
Stock Position:  -0.13622027294896608
Bond Position:  [24.81250269]


portfolio before change:  [10.85266266]
curr_Stock_Price:  102.50267075058422
curr_Factors:  [102.50267075]
mat_Sqrt:  [[0.15]]
grads:  [0.14077165]
Stock Position:  0.14077164568793965
Bond Position:  [-3.57680699]


portfolio before change:  [10.84472579]
curr_Stock_Price:  102.44946589121783
curr_Factors:  [102.44946589]
mat_Sqrt:  [[0.15]]
grads:  [0.02084603]
Stock Position:  0.02084602798923669
Bond Position:  [8.70906136]


portfolio before change:  [10.83267103]
curr_Stock_Price:  101.81896409630653
curr_Factors:  [101.8189641]
mat_Sqrt:  [[0.15]]
grads:  [0.10236566]
Stock Position:  0.10236566113522093
Bond Position:  [0.40990546]


portfolio before change:  [10.80633233]
curr_Stock_Price:  101.56116332421203
curr_Factors:  [101.56116332]
mat_Sqrt:  [[0.15]]
grads:  [0.05716963]
Stock Position:  0.05716963062099256
Bond Position:  [5.00011814]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.87891069]
Stock Price:  102.81975658803749
PL:  [8.05915411]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.16317453e-02]
 [-4.52466519e-02]
 [-1.63409710e-04]
 [-1.92408532e-04]
 [-2.33136658e-03]
 [ 1.41824440e-02]
 [ 3.72807927e-03]
 [ 4.98363910e-03]
 [-2.61078950e-02]
 [ 2.33700770e-02]
 [ 1.98962422e-02]
 [-1.05368077e-02]
 [ 1.92445785e-02]
 [ 2.10245226e-02]
 [-1.66848210e-04]
 [-3.69443718e-03]
 [-5.99318812e-03]
 [ 5.28385877e-03]
 [ 6.30763788e-03]
 [-3.48644984e-03]
 [-2.78656204e-03]
 [-1.04190334e-02]
 [ 6.76535316e-03]
 [-6.51887276e-03]
 [ 1.51682828e-02]
 [ 8.12697029e-03]
 [-8.26568770e-03]
 [-1.96546167e-03]
 [-4.01686585e-03]
 [-1.28405265e-02]
 [-1.06905442e-02]
 [ 1.51954657e-02]
 [-7.01855436e-03]
 [-3.77395387e-02]
 [-2.15962937e-02]
 [ 3.65621495e-02]
 [ 3.25960524e-03]
 [ 1.12523992e-02]
 [ 7.70622074e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.44949487]
curr_Stock_Price:  100.57219321782046
curr_Factors:  [100.57219322]
mat_Sqrt:  [[0.15]]
grads:  [-0.14421164]
Stock Position:  -0.1442116350263536
Bond Position:  [28.95317529]


portfolio before change:  [14.2209524]
curr_Stock_Price:  102.18206221243007
curr_Factors:  [102.18206221]
mat_Sqrt:  [[0.15]]
grads:  [-0.30164435]
Stock Position:  -0.3016443457217213
Bond Position:  [45.0435937]


portfolio before change:  [14.46153791]
curr_Stock_Price:  101.40314918148849
curr_Factors:  [101.40314918]
mat_Sqrt:  [[0.15]]
grads:  [-0.0010894]
Stock Position:  -0.0010893980684015606
Bond Position:  [14.57200631]


portfolio before change:  [14.46290845]
curr_Stock_Price:  101.81720828705645
curr_Factors:  [101.81720829]
mat_Sqrt:  [[0.15]]
grads:  [-0.00128272]
Stock Position:  -0.0012827235458397809
Bond Position:  [14.59351178]


portfolio before change:  [14.46497569]
curr_Stock_Price:  101.62781997101551
curr_Factors:  [101.62781997]
mat_Sqrt:  [[0.15]]
grads:  [-0.01554244]
Stock Position:  -0.015542443877325927
Bond Position:  [16.04452037]


portfolio before change:  [14.45972856]
curr_Stock_Price:  102.09446597027492
curr_Factors:  [102.09446597]
mat_Sqrt:  [[0.15]]
grads:  [0.09454963]
Stock Position:  0.09454962662172169
Bond Position:  [4.80673492]


portfolio before change:  [14.35905139]
curr_Stock_Price:  101.0233030909433
curr_Factors:  [101.02330309]
mat_Sqrt:  [[0.15]]
grads:  [0.02485386]
Stock Position:  0.02485386178904872
Bond Position:  [11.84823217]


portfolio before change:  [14.35033815]
curr_Stock_Price:  100.61313127112983
curr_Factors:  [100.61313127]
mat_Sqrt:  [[0.15]]
grads:  [0.03322426]
Stock Position:  0.03322426067034833
Bond Position:  [11.00754125]


portfolio before change:  [14.33861309]
curr_Stock_Price:  100.21880804596877
curr_Factors:  [100.21880805]
mat_Sqrt:  [[0.15]]
grads:  [-0.17405263]
Stock Position:  -0.17405263362732973
Bond Position:  [31.78196057]


portfolio before change:  [14.31094702]
curr_Stock_Price:  100.40058670464975
curr_Factors:  [100.4005867]
mat_Sqrt:  [[0.15]]
grads:  [0.15580051]
Stock Position:  0.1558005135865869
Bond Position:  [-1.33151595]


portfolio before change:  [14.39866924]
curr_Stock_Price:  100.96469692778939
curr_Factors:  [100.96469693]
mat_Sqrt:  [[0.15]]
grads:  [0.13264161]
Stock Position:  0.13264161475499148
Bond Position:  [1.0065488]


portfolio before change:  [14.49503723]
curr_Stock_Price:  101.6902774260199
curr_Factors:  [101.69027743]
mat_Sqrt:  [[0.15]]
grads:  [-0.07024538]
Stock Position:  -0.07024538476010227
Bond Position:  [21.6383099]


portfolio before change:  [14.49911876]
curr_Stock_Price:  101.67068090583585
curr_Factors:  [101.67068091]
mat_Sqrt:  [[0.15]]
grads:  [0.12829719]
Stock Position:  0.12829719010835433
Bond Position:  [1.45505608]


portfolio before change:  [14.50482969]
curr_Stock_Price:  101.71377651257782
curr_Factors:  [101.71377651]
mat_Sqrt:  [[0.15]]
grads:  [0.14016348]
Stock Position:  0.14016348376057425
Bond Position:  [0.24827243]


portfolio before change:  [14.41322928]
curr_Stock_Price:  101.06002957747451
curr_Factors:  [101.06002958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00111232]
Stock Position:  -0.0011123214004467308
Bond Position:  [14.52564052]


portfolio before change:  [14.41482298]
curr_Stock_Price:  101.25972180775342
curr_Factors:  [101.25972181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02462958]
Stock Position:  -0.02462958116935242
Bond Position:  [16.90880752]


portfolio before change:  [14.4221371]
curr_Stock_Price:  101.04857796532671
curr_Factors:  [101.04857797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03995459]
Stock Position:  -0.039954587488969254
Bond Position:  [18.45949135]


portfolio before change:  [14.46234994]
curr_Stock_Price:  100.0998693315947
curr_Factors:  [100.09986933]
mat_Sqrt:  [[0.15]]
grads:  [0.03522573]
Stock Position:  0.03522572513776656
Bond Position:  [10.93625946]


portfolio before change:  [14.45511813]
curr_Stock_Price:  99.85576006714781
curr_Factors:  [99.85576007]
mat_Sqrt:  [[0.15]]
grads:  [0.04205092]
Stock Position:  0.04205091919859589
Bond Position:  [10.25609163]


portfolio before change:  [14.47090869]
curr_Stock_Price:  100.20078138364316
curr_Factors:  [100.20078138]
mat_Sqrt:  [[0.15]]
grads:  [-0.023243]
Stock Position:  -0.023242998949438213
Bond Position:  [16.79987534]


portfolio before change:  [14.50576781]
curr_Stock_Price:  98.79136728284921
curr_Factors:  [98.79136728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857708]
Stock Position:  -0.018577080283365553
Bond Position:  [16.34102297]


portfolio before change:  [14.50764654]
curr_Stock_Price:  98.80019695330745
curr_Factors:  [98.80019695]
mat_Sqrt:  [[0.15]]
grads:  [-0.06946022]
Stock Position:  -0.06946022285360995
Bond Position:  [21.37033024]


portfolio before change:  [14.50814523]
curr_Stock_Price:  98.83147763878631
curr_Factors:  [98.83147764]
mat_Sqrt:  [[0.15]]
grads:  [0.04510235]
Stock Position:  0.04510235439327872
Bond Position:  [10.0506129]


portfolio before change:  [14.50089689]
curr_Stock_Price:  98.64291213385728
curr_Factors:  [98.64291213]
mat_Sqrt:  [[0.15]]
grads:  [-0.04345915]
Stock Position:  -0.043459151727175904
Bond Position:  [18.78783418]


portfolio before change:  [14.49276244]
curr_Stock_Price:  98.88412891009665
curr_Factors:  [98.88412891]
mat_Sqrt:  [[0.15]]
grads:  [0.10112189]
Stock Position:  0.10112188500160262
Bond Position:  [4.49341293]


portfolio before change:  [14.61171903]
curr_Stock_Price:  100.05494254588353
curr_Factors:  [100.05494255]
mat_Sqrt:  [[0.15]]
grads:  [0.0541798]
Stock Position:  0.05417980194525119
Bond Position:  [9.19076206]


portfolio before change:  [14.57277951]
curr_Stock_Price:  99.3150277397198
curr_Factors:  [99.31502774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05510458]
Stock Position:  -0.055104584684836484
Bond Position:  [20.04549287]


portfolio before change:  [14.54230675]
curr_Stock_Price:  99.91350078156327
curr_Factors:  [99.91350078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01310308]
Stock Position:  -0.013103077811053528
Bond Position:  [15.85148112]


portfolio before change:  [14.55718645]
curr_Stock_Price:  98.92914111628887
curr_Factors:  [98.92914112]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677911]
Stock Position:  -0.026779105642662296
Bond Position:  [17.20642037]


portfolio before change:  [14.54855174]
curr_Stock_Price:  99.33190455243881
curr_Factors:  [99.33190455]
mat_Sqrt:  [[0.15]]
grads:  [-0.08560351]
Stock Position:  -0.08560350975164296
Bond Position:  [23.0517114]


portfolio before change:  [14.53148957]
curr_Stock_Price:  99.56488346226418
curr_Factors:  [99.56488346]
mat_Sqrt:  [[0.15]]
grads:  [-0.07127029]
Stock Position:  -0.07127029468841516
Bond Position:  [21.62750816]


portfolio before change:  [14.52328629]
curr_Stock_Price:  99.71791897806592
curr_Factors:  [99.71791898]
mat_Sqrt:  [[0.15]]
grads:  [0.1013031]
Stock Position:  0.10130310492034929
Bond Position:  [4.42155148]


portfolio before change:  [14.56903034]
curr_Stock_Price:  100.16401901780125
curr_Factors:  [100.16401902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04679036]
Stock Position:  -0.04679036239926017
Bond Position:  [19.25574109]


portfolio before change:  [14.61447531]
curr_Stock_Price:  99.24421743925171
curr_Factors:  [99.24421744]
mat_Sqrt:  [[0.15]]
grads:  [-0.25159692]
Stock Position:  -0.2515969244068072
Bond Position:  [39.58401518]


portfolio before change:  [14.47199497]
curr_Stock_Price:  99.83018902792446
curr_Factors:  [99.83018903]
mat_Sqrt:  [[0.15]]
grads:  [-0.14397529]
Stock Position:  -0.14397529137073603
Bond Position:  [28.84507552]


portfolio before change:  [14.60461175]
curr_Stock_Price:  98.93412609137646
curr_Factors:  [98.93412609]
mat_Sqrt:  [[0.15]]
grads:  [0.24374766]
Stock Position:  0.24374766323959712
Bond Position:  [-9.5103503]


portfolio before change:  [14.80802791]
curr_Stock_Price:  99.77353939087466
curr_Factors:  [99.77353939]
mat_Sqrt:  [[0.15]]
grads:  [0.0217307]
Stock Position:  0.021730701617487764
Bond Position:  [12.6398789]


portfolio before change:  [14.83252296]
curr_Stock_Price:  100.82803636716358
curr_Factors:  [100.82803637]
mat_Sqrt:  [[0.15]]
grads:  [0.07501599]
Stock Position:  0.07501599441457679
Bond Position:  [7.26880754]


portfolio before change:  [14.83818363]
curr_Stock_Price:  100.89138308748065
curr_Factors:  [100.89138309]
mat_Sqrt:  [[0.15]]
grads:  [0.0513748]
Stock Position:  0.05137480490988867
Bond Position:  [9.65490851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.78774789]
Stock Price:  99.88616897073362
PL:  [14.78774789]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.14378956e-02]
 [ 4.34984664e-02]
 [-2.29864561e-03]
 [-8.66890843e-03]
 [-5.79403706e-03]
 [ 4.18614475e-02]
 [ 3.53417237e-03]
 [ 1.01893562e-02]
 [ 1.07743655e-01]
 [ 2.32360991e-02]
 [ 2.25869062e-02]
 [-3.62607446e-04]
 [-4.54490785e-02]
 [ 1.32620524e-02]
 [ 3.98998711e-02]
 [-6.42965009e-03]
 [-5.91196592e-03]
 [-1.88149323e-02]
 [ 1.47736505e-03]
 [ 5.27875530e-02]
 [-3.31007510e-02]
 [-3.11859231e-02]
 [ 2.94986938e-03]
 [-1.78560097e-02]
 [ 7.71883587e-03]
 [-7.71088494e-03]
 [ 5.63007768e-02]
 [-6.99593584e-03]
 [-8.13956299e-02]
 [-5.61506230e-03]
 [ 6.47403028e-02]
 [-9.00878004e-03]
 [-2.38033530e-02]
 [-6.19184075e-03]
 [-2.43553849e-02]
 [ 2.96192710e-02]
 [-1.25917431e-02]
 [-1.54712192e-02]
 [ 5.90872268e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13236687]
curr_Stock_Price:  100.14783482665474
curr_Factors:  [100.14783483]
mat_Sqrt:  [[0.15]]
grads:  [0.1429193]
Stock Position:  0.14291930374849227
Bond Position:  [-9.18069196]


portfolio before change:  [5.13312383]
curr_Stock_Price:  100.1611613909738
curr_Factors:  [100.16116139]
mat_Sqrt:  [[0.15]]
grads:  [0.28998978]
Stock Position:  0.2899897758678712
Bond Position:  [-23.91258891]


portfolio before change:  [5.01118054]
curr_Stock_Price:  99.75096061976959
curr_Factors:  [99.75096062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153243]
Stock Position:  -0.015324304074117157
Bond Position:  [6.53979459]


portfolio before change:  [5.04795763]
curr_Stock_Price:  97.40439011399016
curr_Factors:  [97.40439011]
mat_Sqrt:  [[0.15]]
grads:  [-0.05779272]
Stock Position:  -0.05779272288185427
Bond Position:  [10.67722255]


portfolio before change:  [4.99793457]
curr_Stock_Price:  98.29304508033653
curr_Factors:  [98.29304508]
mat_Sqrt:  [[0.15]]
grads:  [-0.03862691]
Stock Position:  -0.03862691370098886
Bond Position:  [8.79469154]


portfolio before change:  [5.00718433]
curr_Stock_Price:  98.08204318468201
curr_Factors:  [98.08204318]
mat_Sqrt:  [[0.15]]
grads:  [0.27907632]
Stock Position:  0.27907631689678036
Bond Position:  [-22.36519103]


portfolio before change:  [4.65898905]
curr_Stock_Price:  96.84439083078517
curr_Factors:  [96.84439083]
mat_Sqrt:  [[0.15]]
grads:  [0.02356115]
Stock Position:  0.023561149114252448
Bond Position:  [2.37722391]


portfolio before change:  [4.61183627]
curr_Stock_Price:  94.83048433388211
curr_Factors:  [94.83048433]
mat_Sqrt:  [[0.15]]
grads:  [0.06792904]
Stock Position:  0.06792904151120749
Bond Position:  [-1.82990764]


portfolio before change:  [4.59200948]
curr_Stock_Price:  94.54197694945499
curr_Factors:  [94.54197695]
mat_Sqrt:  [[0.15]]
grads:  [0.71829103]
Stock Position:  0.7182910316454533
Bond Position:  [-63.31664467]


portfolio before change:  [4.51988422]
curr_Stock_Price:  94.45258394763539
curr_Factors:  [94.45258395]
mat_Sqrt:  [[0.15]]
grads:  [0.15490733]
Stock Position:  0.1549073270779219
Bond Position:  [-10.1115131]


portfolio before change:  [4.46597254]
curr_Stock_Price:  94.11271842180535
curr_Factors:  [94.11271842]
mat_Sqrt:  [[0.15]]
grads:  [0.15057937]
Stock Position:  0.15057937450417505
Bond Position:  [-9.70546173]


portfolio before change:  [4.22459173]
curr_Stock_Price:  92.51776190497789
curr_Factors:  [92.5177619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241738]
Stock Position:  -0.00241738297506187
Bond Position:  [4.44824259]


portfolio before change:  [4.22561411]
curr_Stock_Price:  92.32485898767833
curr_Factors:  [92.32485899]
mat_Sqrt:  [[0.15]]
grads:  [-0.30299386]
Stock Position:  -0.30299385671732265
Bond Position:  [32.19947921]


portfolio before change:  [4.32950676]
curr_Stock_Price:  91.99525670732578
curr_Factors:  [91.99525671]
mat_Sqrt:  [[0.15]]
grads:  [0.08841368]
Stock Position:  0.08841368268778764
Bond Position:  [-3.80413267]


portfolio before change:  [4.22912854]
curr_Stock_Price:  90.8653107658175
curr_Factors:  [90.86531077]
mat_Sqrt:  [[0.15]]
grads:  [0.26599914]
Stock Position:  0.26599914077638614
Bond Position:  [-19.94096605]


portfolio before change:  [4.13474515]
curr_Stock_Price:  90.5198562182327
curr_Factors:  [90.51985622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04286433]
Stock Position:  -0.042864333917676495
Bond Position:  [8.01481849]


portfolio before change:  [4.12141263]
curr_Stock_Price:  90.85427019421095
curr_Factors:  [90.85427019]
mat_Sqrt:  [[0.15]]
grads:  [-0.03941311]
Stock Position:  -0.039413106160435016
Bond Position:  [7.70226163]


portfolio before change:  [4.07650083]
curr_Stock_Price:  92.01821414668584
curr_Factors:  [92.01821415]
mat_Sqrt:  [[0.15]]
grads:  [-0.12543288]
Stock Position:  -0.12543288194987762
Bond Position:  [15.61861062]


portfolio before change:  [4.04657175]
curr_Stock_Price:  92.27238612779561
curr_Factors:  [92.27238613]
mat_Sqrt:  [[0.15]]
grads:  [0.0098491]
Stock Position:  0.009849100346491063
Bond Position:  [3.13777176]


portfolio before change:  [4.03866599]
curr_Stock_Price:  91.42987168532154
curr_Factors:  [91.42987169]
mat_Sqrt:  [[0.15]]
grads:  [0.35191702]
Stock Position:  0.3519170201042001
Bond Position:  [-28.13706201]


portfolio before change:  [3.96716688]
curr_Stock_Price:  91.23669616646889
curr_Factors:  [91.23669617]
mat_Sqrt:  [[0.15]]
grads:  [-0.22067167]
Stock Position:  -0.22067167305454138
Bond Position:  [24.10052127]


portfolio before change:  [4.03315277]
curr_Stock_Price:  90.95132588755406
curr_Factors:  [90.95132589]
mat_Sqrt:  [[0.15]]
grads:  [-0.20790615]
Stock Position:  -0.20790615417316727
Bond Position:  [22.94249315]


portfolio before change:  [4.02260525]
curr_Stock_Price:  91.01585266310764
curr_Factors:  [91.01585266]
mat_Sqrt:  [[0.15]]
grads:  [0.0196658]
Stock Position:  0.01966579587886332
Bond Position:  [2.23270607]


portfolio before change:  [3.99149715]
curr_Stock_Price:  89.4198225733262
curr_Factors:  [89.41982257]
mat_Sqrt:  [[0.15]]
grads:  [-0.11904006]
Stock Position:  -0.11904006441717227
Bond Position:  [14.63603859]


portfolio before change:  [3.90705279]
curr_Stock_Price:  90.14457004172733
curr_Factors:  [90.14457004]
mat_Sqrt:  [[0.15]]
grads:  [0.05145891]
Stock Position:  0.05145890581039433
Bond Position:  [-0.73168815]


portfolio before change:  [3.89267907]
curr_Stock_Price:  89.86702333449446
curr_Factors:  [89.86702333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514059]
Stock Position:  -0.05140589962488271
Bond Position:  [8.51237425]


portfolio before change:  [3.90726304]
curr_Stock_Price:  89.60402133400612
curr_Factors:  [89.60402133]
mat_Sqrt:  [[0.15]]
grads:  [0.37533851]
Stock Position:  0.375338512051265
Bond Position:  [-29.724577]


portfolio before change:  [3.95929989]
curr_Stock_Price:  89.75256099016536
curr_Factors:  [89.75256099]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663957]
Stock Position:  -0.046639572274257024
Bond Position:  [8.14532094]


portfolio before change:  [3.93584368]
curr_Stock_Price:  90.27731789072593
curr_Factors:  [90.27731789]
mat_Sqrt:  [[0.15]]
grads:  [-0.54263753]
Stock Position:  -0.5426375326589329
Bond Position:  [52.92370471]


portfolio before change:  [3.39893278]
curr_Stock_Price:  91.27895663318857
curr_Factors:  [91.27895663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03743375]
Stock Position:  -0.03743374868318371
Bond Position:  [6.8158463]


portfolio before change:  [3.40257149]
curr_Stock_Price:  91.204513699277
curr_Factors:  [91.2045137]
mat_Sqrt:  [[0.15]]
grads:  [0.43160202]
Stock Position:  0.43160201857243946
Bond Position:  [-35.96148073]


portfolio before change:  [3.4180362]
curr_Stock_Price:  91.25076042140924
curr_Factors:  [91.25076042]
mat_Sqrt:  [[0.15]]
grads:  [-0.06005853]
Stock Position:  -0.06005853359064839
Bond Position:  [8.89842306]


portfolio before change:  [3.42882136]
curr_Stock_Price:  91.08970440022314
curr_Factors:  [91.0897044]
mat_Sqrt:  [[0.15]]
grads:  [-0.15868902]
Stock Position:  -0.1586890196998433
Bond Position:  [17.88375726]


portfolio before change:  [3.25707436]
curr_Stock_Price:  92.18607902492761
curr_Factors:  [92.18607902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04127894]
Stock Position:  -0.04127893832283194
Bond Position:  [7.06241783]


portfolio before change:  [3.24852039]
curr_Stock_Price:  92.41469027161598
curr_Factors:  [92.41469027]
mat_Sqrt:  [[0.15]]
grads:  [-0.16236923]
Stock Position:  -0.1623692324584429
Bond Position:  [18.25382271]


portfolio before change:  [3.24195748]
curr_Stock_Price:  92.46916347669476
curr_Factors:  [92.46916348]
mat_Sqrt:  [[0.15]]
grads:  [0.19746181]
Stock Position:  0.19746180657404866
Bond Position:  [-15.01717059]


portfolio before change:  [3.19602619]
curr_Stock_Price:  92.24606194153255
curr_Factors:  [92.24606194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08394495]
Stock Position:  -0.08394495371981349
Bond Position:  [10.93961759]


portfolio before change:  [3.31114801]
curr_Stock_Price:  90.89095620684724
curr_Factors:  [90.89095621]
mat_Sqrt:  [[0.15]]
grads:  [-0.10314146]
Stock Position:  -0.1031414612059105
Bond Position:  [12.68577405]


portfolio before change:  [3.3838772]
curr_Stock_Price:  90.20119125548986
curr_Factors:  [90.20119126]
mat_Sqrt:  [[0.15]]
grads:  [0.39391485]
Stock Position:  0.39391484516019365
Bond Position:  [-32.14771109]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.17281411]
Stock Price:  89.67558430825433
PL:  [3.17281411]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.66946897e-02]
 [ 4.08348279e-02]
 [-3.54548084e-03]
 [-1.20713507e-03]
 [-1.20244379e-03]
 [ 2.92865529e-02]
 [ 3.62735788e-03]
 [ 8.95272061e-03]
 [-2.05193402e-02]
 [ 2.31141243e-02]
 [ 1.91568170e-02]
 [-1.48311466e-02]
 [ 3.13961943e-02]
 [ 6.20130536e-03]
 [ 7.20768397e-03]
 [-3.48517329e-03]
 [-6.14530128e-03]
 [ 5.49109795e-03]
 [ 6.23892611e-03]
 [-2.09323915e-02]
 [-3.89509469e-03]
 [-7.71162706e-03]
 [ 6.55373657e-03]
 [-7.26245217e-03]
 [ 1.29060349e-02]
 [ 2.49811252e-03]
 [ 1.07703538e-02]
 [-3.78319601e-03]
 [-1.02995958e-02]
 [-1.49768674e-02]
 [-9.96262777e-04]
 [ 1.11235154e-02]
 [-1.02300747e-02]
 [-2.95103350e-02]
 [-2.18260816e-02]
 [ 3.31957204e-02]
 [ 3.48776026e-03]
 [ 9.38513431e-03]
 [ 6.02028077e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.66076674]
curr_Stock_Price:  101.08282238335345
curr_Factors:  [101.08282238]
mat_Sqrt:  [[0.15]]
grads:  [-0.31129793]
Stock Position:  -0.311297931155014
Bond Position:  [57.12764022]


portfolio before change:  [26.01371368]
curr_Stock_Price:  99.9719716474493
curr_Factors:  [99.97197165]
mat_Sqrt:  [[0.15]]
grads:  [0.27223219]
Stock Position:  0.2722321857507204
Bond Position:  [-1.20187468]


portfolio before change:  [26.15868528]
curr_Stock_Price:  100.50505280072802
curr_Factors:  [100.5050528]
mat_Sqrt:  [[0.15]]
grads:  [-0.02363654]
Stock Position:  -0.023636538933756113
Bond Position:  [28.53427687]


portfolio before change:  [26.13567851]
curr_Stock_Price:  101.62931951850929
curr_Factors:  [101.62931952]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804757]
Stock Position:  -0.008047567119355078
Bond Position:  [26.95354728]


portfolio before change:  [26.13505939]
curr_Stock_Price:  102.12493905435322
curr_Factors:  [102.12493905]
mat_Sqrt:  [[0.15]]
grads:  [-0.00801629]
Stock Position:  -0.008016291941644622
Bond Position:  [26.95372271]


portfolio before change:  [26.14416583]
curr_Stock_Price:  101.409269073315
curr_Factors:  [101.40926907]
mat_Sqrt:  [[0.15]]
grads:  [0.19524369]
Stock Position:  0.19524368576768186
Bond Position:  [6.34464637]


portfolio before change:  [26.16840703]
curr_Stock_Price:  101.52936548661371
curr_Factors:  [101.52936549]
mat_Sqrt:  [[0.15]]
grads:  [0.02418239]
Stock Position:  0.024182385897646676
Bond Position:  [23.71318473]


portfolio before change:  [26.16722801]
curr_Stock_Price:  101.35802775192121
curr_Factors:  [101.35802775]
mat_Sqrt:  [[0.15]]
grads:  [0.0596848]
Stock Position:  0.05968480405461346
Bond Position:  [20.11769398]


portfolio before change:  [26.13832134]
curr_Stock_Price:  100.8315698201031
curr_Factors:  [100.83156982]
mat_Sqrt:  [[0.15]]
grads:  [-0.1367956]
Stock Position:  -0.13679560163839918
Bond Position:  [39.93163659]


portfolio before change:  [26.09248664]
curr_Stock_Price:  101.20312022986582
curr_Factors:  [101.20312023]
mat_Sqrt:  [[0.15]]
grads:  [0.15409416]
Stock Position:  0.15409416193363887
Bond Position:  [10.49767664]


portfolio before change:  [25.92950827]
curr_Stock_Price:  100.1369496488561
curr_Factors:  [100.13694965]
mat_Sqrt:  [[0.15]]
grads:  [0.12771211]
Stock Position:  0.12771211300039617
Bond Position:  [13.14080684]


portfolio before change:  [25.82283595]
curr_Stock_Price:  99.28883097593284
curr_Factors:  [99.28883098]
mat_Sqrt:  [[0.15]]
grads:  [-0.09887431]
Stock Position:  -0.09887431068269723
Bond Position:  [35.63995067]


portfolio before change:  [25.70537584]
curr_Stock_Price:  100.52186489026145
curr_Factors:  [100.52186489]
mat_Sqrt:  [[0.15]]
grads:  [0.20930796]
Stock Position:  0.2093079619072574
Bond Position:  [4.66534917]


portfolio before change:  [25.5820224]
curr_Stock_Price:  99.9297390761379
curr_Factors:  [99.92973908]
mat_Sqrt:  [[0.15]]
grads:  [0.04134204]
Stock Position:  0.04134203575162044
Bond Position:  [21.45072355]


portfolio before change:  [25.61480295]
curr_Stock_Price:  100.65778857814337
curr_Factors:  [100.65778858]
mat_Sqrt:  [[0.15]]
grads:  [0.04805123]
Stock Position:  0.04805122644344607
Bond Position:  [20.77807276]


portfolio before change:  [25.60306042]
curr_Stock_Price:  100.3593580660531
curr_Factors:  [100.35935807]
mat_Sqrt:  [[0.15]]
grads:  [-0.02323449]
Stock Position:  -0.023234488590738525
Bond Position:  [27.93485878]


portfolio before change:  [25.62192022]
curr_Stock_Price:  99.69793948630695
curr_Factors:  [99.69793949]
mat_Sqrt:  [[0.15]]
grads:  [-0.04096868]
Stock Position:  -0.04096867523121317
Bond Position:  [29.70641273]


portfolio before change:  [25.59854194]
curr_Stock_Price:  100.3592207637688
curr_Factors:  [100.35922076]
mat_Sqrt:  [[0.15]]
grads:  [0.03660732]
Stock Position:  0.03660731966085406
Bond Position:  [21.92465986]


portfolio before change:  [25.58812002]
curr_Stock_Price:  99.99965681951285
curr_Factors:  [99.99965682]
mat_Sqrt:  [[0.15]]
grads:  [0.04159284]
Stock Position:  0.041592840731891345
Bond Position:  [21.42885022]


portfolio before change:  [25.55838817]
curr_Stock_Price:  99.22042115953685
curr_Factors:  [99.22042116]
mat_Sqrt:  [[0.15]]
grads:  [-0.13954928]
Stock Position:  -0.13954927646755808
Bond Position:  [39.40452615]


portfolio before change:  [25.49396794]
curr_Stock_Price:  99.71735029632188
curr_Factors:  [99.7173503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0259673]
Stock Position:  -0.02596729793985916
Bond Position:  [28.08335808]


portfolio before change:  [25.50671489]
curr_Stock_Price:  99.36166031298612
curr_Factors:  [99.36166031]
mat_Sqrt:  [[0.15]]
grads:  [-0.05141085]
Stock Position:  -0.051410847089392246
Bond Position:  [30.61498201]


portfolio before change:  [25.56383135]
curr_Stock_Price:  98.32512116650935
curr_Factors:  [98.32512117]
mat_Sqrt:  [[0.15]]
grads:  [0.04369158]
Stock Position:  0.043691577142179985
Bond Position:  [21.26785174]


portfolio before change:  [25.55601477]
curr_Stock_Price:  98.08536717051614
curr_Factors:  [98.08536717]
mat_Sqrt:  [[0.15]]
grads:  [-0.04841635]
Stock Position:  -0.04841634782588779
Bond Position:  [30.30495003]


portfolio before change:  [25.59965729]
curr_Stock_Price:  97.26221211351003
curr_Factors:  [97.26221211]
mat_Sqrt:  [[0.15]]
grads:  [0.08604023]
Stock Position:  0.08604023242684995
Bond Position:  [17.23119395]


portfolio before change:  [25.54438641]
curr_Stock_Price:  96.5947928125964
curr_Factors:  [96.59479281]
mat_Sqrt:  [[0.15]]
grads:  [0.01665408]
Stock Position:  0.016654083447096756
Bond Position:  [23.93568867]


portfolio before change:  [25.55993117]
curr_Stock_Price:  97.34851875159737
curr_Factors:  [97.34851875]
mat_Sqrt:  [[0.15]]
grads:  [0.07180236]
Stock Position:  0.0718023589946387
Bond Position:  [18.57007788]


portfolio before change:  [25.5511617]
curr_Stock_Price:  97.19405479380005
curr_Factors:  [97.19405479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02522131]
Stock Position:  -0.025221306717050022
Bond Position:  [28.00252277]


portfolio before change:  [25.53091266]
curr_Stock_Price:  98.13570217483247
curr_Factors:  [98.13570217]
mat_Sqrt:  [[0.15]]
grads:  [-0.06866397]
Stock Position:  -0.06866397199767683
Bond Position:  [32.26929976]


portfolio before change:  [25.52635835]
curr_Stock_Price:  98.26077832010543
curr_Factors:  [98.26077832]
mat_Sqrt:  [[0.15]]
grads:  [-0.09984578]
Stock Position:  -0.09984578260687049
Bond Position:  [35.33728266]


portfolio before change:  [25.46035313]
curr_Stock_Price:  98.96609256919105
curr_Factors:  [98.96609257]
mat_Sqrt:  [[0.15]]
grads:  [-0.00664175]
Stock Position:  -0.006641751846842188
Bond Position:  [26.11766136]


portfolio before change:  [25.46767406]
curr_Stock_Price:  98.35540846073766
curr_Factors:  [98.35540846]
mat_Sqrt:  [[0.15]]
grads:  [0.07415677]
Stock Position:  0.07415676903761428
Bond Position:  [18.17395475]


portfolio before change:  [25.48734034]
curr_Stock_Price:  98.5899710084857
curr_Factors:  [98.58997101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0682005]
Stock Position:  -0.06820049801704887
Bond Position:  [32.21122546]


portfolio before change:  [25.41778117]
curr_Stock_Price:  99.66893417578011
curr_Factors:  [99.66893418]
mat_Sqrt:  [[0.15]]
grads:  [-0.19673557]
Stock Position:  -0.19673556683017984
Bond Position:  [45.02620543]


portfolio before change:  [25.51121921]
curr_Stock_Price:  99.22260202488822
curr_Factors:  [99.22260202]
mat_Sqrt:  [[0.15]]
grads:  [-0.14550721]
Stock Position:  -0.14550721050115567
Bond Position:  [39.94882325]


portfolio before change:  [25.49141211]
curr_Stock_Price:  99.39304725319592
curr_Factors:  [99.39304725]
mat_Sqrt:  [[0.15]]
grads:  [0.2213048]
Stock Position:  0.22130480292781848
Bond Position:  [3.49525338]


portfolio before change:  [25.6179375]
curr_Stock_Price:  99.96279743107038
curr_Factors:  [99.96279743]
mat_Sqrt:  [[0.15]]
grads:  [0.02325174]
Stock Position:  0.023251735061173985
Bond Position:  [23.29362902]


portfolio before change:  [25.62937991]
curr_Stock_Price:  100.32967456326122
curr_Factors:  [100.32967456]
mat_Sqrt:  [[0.15]]
grads:  [0.06256756]
Stock Position:  0.06256756203356482
Bond Position:  [19.35199678]


portfolio before change:  [25.60832351]
curr_Stock_Price:  99.95447128940712
curr_Factors:  [99.95447129]
mat_Sqrt:  [[0.15]]
grads:  [0.04013521]
Stock Position:  0.040135205160942815
Bond Position:  [21.5966303]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.61683199]
Stock Price:  100.09920028448306
PL:  [25.5176317]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-4.57267386e-03]
 [ 4.37762153e-02]
 [-7.21279348e-03]
 [-2.17365174e-03]
 [-7.65456765e-03]
 [ 2.80864251e-02]
 [ 3.54755025e-03]
 [-2.31732705e-03]
 [ 7.83607764e-03]
 [ 2.34426178e-02]
 [ 2.10529997e-02]
 [-1.15768295e-02]
 [ 1.09053169e-02]
 [ 6.42246838e-03]
 [-5.29185352e-03]
 [-2.30625415e-03]
 [-5.92369214e-03]
 [ 5.45578098e-03]
 [ 6.52919235e-03]
 [-1.59157362e-03]
 [-4.17907430e-03]
 [-4.72190152e-03]
 [ 7.07612437e-03]
 [-9.28973206e-03]
 [ 1.30816162e-02]
 [ 7.60447556e-03]
 [-3.51283070e-03]
 [-1.56964790e-03]
 [ 4.49516188e-04]
 [-1.38842343e-02]
 [-2.75592808e-03]
 [ 1.24468154e-02]
 [-1.06249543e-02]
 [-3.87626994e-02]
 [-2.20786451e-02]
 [ 3.72652871e-02]
 [ 2.45375569e-03]
 [ 2.26590684e-03]
 [ 1.22674685e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.73835094]
curr_Stock_Price:  100.40316526576005
curr_Factors:  [100.40316527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03048449]
Stock Position:  -0.03048449241923542
Bond Position:  [13.79909047]


portfolio before change:  [10.74563825]
curr_Stock_Price:  100.22070148942692
curr_Factors:  [100.22070149]
mat_Sqrt:  [[0.15]]
grads:  [0.29184144]
Stock Position:  0.29184143538826346
Bond Position:  [-18.50291513]


portfolio before change:  [10.51720903]
curr_Stock_Price:  99.44591017529952
curr_Factors:  [99.44591018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04808529]
Stock Position:  -0.048085289861252774
Bond Position:  [15.29909445]


portfolio before change:  [10.46304625]
curr_Stock_Price:  100.61207330974807
curr_Factors:  [100.61207331]
mat_Sqrt:  [[0.15]]
grads:  [-0.01449101]
Stock Position:  -0.014491011576665078
Bond Position:  [11.92101697]


portfolio before change:  [10.4731536]
curr_Stock_Price:  100.01741977545294
curr_Factors:  [100.01741978]
mat_Sqrt:  [[0.15]]
grads:  [-0.05103045]
Stock Position:  -0.05103045100941006
Bond Position:  [15.57708764]


portfolio before change:  [10.48564587]
curr_Stock_Price:  99.81077819437083
curr_Factors:  [99.81077819]
mat_Sqrt:  [[0.15]]
grads:  [0.18724283]
Stock Position:  0.1872428338601522
Bond Position:  [-8.20320709]


portfolio before change:  [10.33650823]
curr_Stock_Price:  99.01976168068477
curr_Factors:  [99.01976168]
mat_Sqrt:  [[0.15]]
grads:  [0.02365034]
Stock Position:  0.023650335022940065
Bond Position:  [7.99465769]


portfolio before change:  [10.32039134]
curr_Stock_Price:  98.29603870483123
curr_Factors:  [98.2960387]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544885]
Stock Position:  -0.015448847005587461
Bond Position:  [11.8389518]


portfolio before change:  [10.33486023]
curr_Stock_Price:  97.45526815238114
curr_Factors:  [97.45526815]
mat_Sqrt:  [[0.15]]
grads:  [0.05224052]
Stock Position:  0.05224051762615601
Bond Position:  [5.24374658]


portfolio before change:  [10.36429552]
curr_Stock_Price:  98.00617730834108
curr_Factors:  [98.00617731]
mat_Sqrt:  [[0.15]]
grads:  [0.15628412]
Stock Position:  0.15628411894339123
Bond Position:  [-4.95251355]


portfolio before change:  [10.38237339]
curr_Stock_Price:  98.12581180863955
curr_Factors:  [98.12581181]
mat_Sqrt:  [[0.15]]
grads:  [0.14035333]
Stock Position:  0.14035333152249696
Bond Position:  [-3.3899112]


portfolio before change:  [10.40020429]
curr_Stock_Price:  98.25587402271223
curr_Factors:  [98.25587402]
mat_Sqrt:  [[0.15]]
grads:  [-0.07717886]
Stock Position:  -0.07717886366273811
Bond Position:  [17.983481]


portfolio before change:  [10.3455704]
curr_Stock_Price:  98.99288880926387
curr_Factors:  [98.99288881]
mat_Sqrt:  [[0.15]]
grads:  [0.07270211]
Stock Position:  0.07270211248793418
Bond Position:  [3.14857826]


portfolio before change:  [10.36589436]
curr_Stock_Price:  99.2670260580243
curr_Factors:  [99.26702606]
mat_Sqrt:  [[0.15]]
grads:  [0.04281646]
Stock Position:  0.04281645586627715
Bond Position:  [6.11563212]


portfolio before change:  [10.38815351]
curr_Stock_Price:  99.76904459012162
curr_Factors:  [99.76904459]
mat_Sqrt:  [[0.15]]
grads:  [-0.03527902]
Stock Position:  -0.03527902345924795
Bond Position:  [13.90790798]


portfolio before change:  [10.39353743]
curr_Stock_Price:  99.66571636437257
curr_Factors:  [99.66571636]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537503]
Stock Position:  -0.015375027685141988
Bond Position:  [11.92590058]


portfolio before change:  [10.36863572]
curr_Stock_Price:  101.38230123671914
curr_Factors:  [101.38230124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03949128]
Stock Position:  -0.039491280952302414
Bond Position:  [14.37235266]


portfolio before change:  [10.41258056]
curr_Stock_Price:  100.31502300634887
curr_Factors:  [100.31502301]
mat_Sqrt:  [[0.15]]
grads:  [0.03637187]
Stock Position:  0.036371873189352914
Bond Position:  [6.76393526]


portfolio before change:  [10.41308824]
curr_Stock_Price:  100.30573392926058
curr_Factors:  [100.30573393]
mat_Sqrt:  [[0.15]]
grads:  [0.04352795]
Stock Position:  0.0435279490164368
Bond Position:  [6.04698537]


portfolio before change:  [10.41301047]
curr_Stock_Price:  100.28658082793206
curr_Factors:  [100.28658083]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061049]
Stock Position:  -0.010610490823630508
Bond Position:  [11.47710031]


portfolio before change:  [10.40481707]
curr_Stock_Price:  101.19399651170082
curr_Factors:  [101.19399651]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278605]
Stock Position:  -0.02786049533178239
Bond Position:  [13.22413194]


portfolio before change:  [10.41209543]
curr_Stock_Price:  100.99208913947545
curr_Factors:  [100.99208914]
mat_Sqrt:  [[0.15]]
grads:  [-0.03147934]
Stock Position:  -0.03147934347395272
Bond Position:  [13.59126009]


portfolio before change:  [10.44150713]
curr_Stock_Price:  100.11174388143691
curr_Factors:  [100.11174388]
mat_Sqrt:  [[0.15]]
grads:  [0.04717416]
Stock Position:  0.04717416244407898
Bond Position:  [5.71881947]


portfolio before change:  [10.46126307]
curr_Stock_Price:  100.51537658663182
curr_Factors:  [100.51537659]
mat_Sqrt:  [[0.15]]
grads:  [-0.06193155]
Stock Position:  -0.06193154703406918
Bond Position:  [16.68633584]


portfolio before change:  [10.49702032]
curr_Stock_Price:  99.9716902439165
curr_Factors:  [99.97169024]
mat_Sqrt:  [[0.15]]
grads:  [0.08721077]
Stock Position:  0.08721077482406928
Bond Position:  [1.77841176]


portfolio before change:  [10.53836218]
curr_Stock_Price:  100.44318633269393
curr_Factors:  [100.44318633]
mat_Sqrt:  [[0.15]]
grads:  [0.0506965]
Stock Position:  0.05069650374529177
Bond Position:  [5.44624381]


portfolio before change:  [10.54935889]
curr_Stock_Price:  100.64666963425717
curr_Factors:  [100.64666963]
mat_Sqrt:  [[0.15]]
grads:  [-0.02341887]
Stock Position:  -0.023418871362740484
Bond Position:  [12.9063903]


portfolio before change:  [10.55485329]
curr_Stock_Price:  100.48094890820445
curr_Factors:  [100.48094891]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046432]
Stock Position:  -0.010464319360443348
Bond Position:  [11.60631803]


portfolio before change:  [10.56106923]
curr_Stock_Price:  100.02558638516149
curr_Factors:  [100.02558639]
mat_Sqrt:  [[0.15]]
grads:  [0.00299677]
Stock Position:  0.002996774588406462
Bond Position:  [10.26131509]


portfolio before change:  [10.55941147]
curr_Stock_Price:  99.04436314104247
curr_Factors:  [99.04436314]
mat_Sqrt:  [[0.15]]
grads:  [-0.09256156]
Stock Position:  -0.09256156193353306
Bond Position:  [19.72711242]


portfolio before change:  [10.55637678]
curr_Stock_Price:  99.10379088631416
curr_Factors:  [99.10379089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01837285]
Stock Position:  -0.018372853834565238
Bond Position:  [12.37719625]


portfolio before change:  [10.5672789]
curr_Stock_Price:  98.5946228967811
curr_Factors:  [98.5946229]
mat_Sqrt:  [[0.15]]
grads:  [0.08297877]
Stock Position:  0.08297876963281103
Bond Position:  [2.3860184]


portfolio before change:  [10.55153892]
curr_Stock_Price:  98.40134150575736
curr_Factors:  [98.40134151]
mat_Sqrt:  [[0.15]]
grads:  [-0.07083303]
Stock Position:  -0.07083302891009981
Bond Position:  [17.52160399]


portfolio before change:  [10.51682474]
curr_Stock_Price:  98.92234860727424
curr_Factors:  [98.92234861]
mat_Sqrt:  [[0.15]]
grads:  [-0.258418]
Stock Position:  -0.2584179960390786
Bond Position:  [36.08013983]


portfolio before change:  [10.58020248]
curr_Stock_Price:  98.69454931567398
curr_Factors:  [98.69454932]
mat_Sqrt:  [[0.15]]
grads:  [-0.14719097]
Stock Position:  -0.14719096750086813
Bond Position:  [25.10714868]


portfolio before change:  [10.56250809]
curr_Stock_Price:  98.83608640406705
curr_Factors:  [98.8360864]
mat_Sqrt:  [[0.15]]
grads:  [0.24843525]
Stock Position:  0.2484352475661301
Bond Position:  [-13.99185951]


portfolio before change:  [10.39392407]
curr_Stock_Price:  98.16454348903507
curr_Factors:  [98.16454349]
mat_Sqrt:  [[0.15]]
grads:  [0.01635837]
Stock Position:  0.016358371286832037
Bond Position:  [8.78811202]


portfolio before change:  [10.36739839]
curr_Stock_Price:  96.47585071587055
curr_Factors:  [96.47585072]
mat_Sqrt:  [[0.15]]
grads:  [0.01510605]
Stock Position:  0.01510604558219145
Bond Position:  [8.91002979]


portfolio before change:  [10.37288239]
curr_Stock_Price:  96.7651505270864
curr_Factors:  [96.76515053]
mat_Sqrt:  [[0.15]]
grads:  [0.08178312]
Stock Position:  0.08178312322329086
Bond Position:  [2.45912616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.24896773]
Stock Price:  95.24622999762285
PL:  [10.24896773]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.46101550e-02]
 [ 2.42782266e-02]
 [-1.42047295e-02]
 [-8.26178058e-03]
 [-4.43474339e-03]
 [ 4.95818282e-02]
 [ 3.55974944e-03]
 [-7.63595984e-04]
 [-1.08009152e-02]
 [ 2.34432036e-02]
 [ 2.06903580e-02]
 [-1.51713871e-02]
 [ 3.18648811e-02]
 [ 2.19935699e-02]
 [-1.14382463e-02]
 [-2.99781993e-03]
 [-5.28563375e-03]
 [ 7.16870532e-03]
 [ 1.65057059e-02]
 [ 1.30617896e-02]
 [-9.39716351e-04]
 [-4.87730615e-03]
 [ 6.83548333e-03]
 [-1.00730111e-02]
 [ 5.45557924e-03]
 [ 5.57011230e-03]
 [-7.94321478e-03]
 [-2.34559766e-03]
 [-3.14773101e-03]
 [-1.39164486e-02]
 [-2.31144959e-03]
 [ 1.48462880e-02]
 [-9.06550370e-03]
 [-2.21499932e-02]
 [-2.10058197e-02]
 [ 3.42377892e-02]
 [ 3.29927878e-03]
 [ 6.88411045e-03]
 [ 6.50675080e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.81041539]
curr_Stock_Price:  98.87515142809914
curr_Factors:  [98.87515143]
mat_Sqrt:  [[0.15]]
grads:  [0.09740103]
Stock Position:  0.0974010334401277
Bond Position:  [-32.44095733]


portfolio before change:  [-22.79393824]
curr_Stock_Price:  99.08595539195768
curr_Factors:  [99.08595539]
mat_Sqrt:  [[0.15]]
grads:  [0.16185484]
Stock Position:  0.16185484401090908
Bond Position:  [-38.8314801]


portfolio before change:  [-23.03513799]
curr_Stock_Price:  97.62572409800802
curr_Factors:  [97.6257241]
mat_Sqrt:  [[0.15]]
grads:  [-0.0946982]
Stock Position:  -0.09469819674440264
Bond Position:  [-13.79015796]


portfolio before change:  [-23.04592166]
curr_Stock_Price:  97.72139430208243
curr_Factors:  [97.7213943]
mat_Sqrt:  [[0.15]]
grads:  [-0.05507854]
Stock Position:  -0.05507853720885768
Bond Position:  [-17.66357021]


portfolio before change:  [-23.01982433]
curr_Stock_Price:  97.2074841605571
curr_Factors:  [97.20748416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956496]
Stock Position:  -0.029564955952125188
Bond Position:  [-20.14588934]


portfolio before change:  [-23.0256547]
curr_Stock_Price:  97.31950797064265
curr_Factors:  [97.31950797]
mat_Sqrt:  [[0.15]]
grads:  [0.33054552]
Stock Position:  0.3305455214108556
Bond Position:  [-55.19418221]


portfolio before change:  [-22.60805759]
curr_Stock_Price:  98.6037389872943
curr_Factors:  [98.60373899]
mat_Sqrt:  [[0.15]]
grads:  [0.02373166]
Stock Position:  0.023731662919951768
Bond Position:  [-24.94808829]


portfolio before change:  [-22.62851067]
curr_Stock_Price:  97.87330692484949
curr_Factors:  [97.87330692]
mat_Sqrt:  [[0.15]]
grads:  [-0.00509064]
Stock Position:  -0.00509063989387408
Bond Position:  [-22.13027291]


portfolio before change:  [-22.63190196]
curr_Stock_Price:  97.99604807674513
curr_Factors:  [97.99604808]
mat_Sqrt:  [[0.15]]
grads:  [-0.0720061]
Stock Position:  -0.07200610142947517
Bond Position:  [-15.57558858]


portfolio before change:  [-22.62118032]
curr_Stock_Price:  97.82010873163077
curr_Factors:  [97.82010873]
mat_Sqrt:  [[0.15]]
grads:  [0.15628802]
Stock Position:  0.15628802393792926
Bond Position:  [-37.90929182]


portfolio before change:  [-22.50142481]
curr_Stock_Price:  98.61667946610395
curr_Factors:  [98.61667947]
mat_Sqrt:  [[0.15]]
grads:  [0.13793572]
Stock Position:  0.137935719670829
Bond Position:  [-36.10418747]


portfolio before change:  [-22.39135423]
curr_Stock_Price:  99.44738441652365
curr_Factors:  [99.44738442]
mat_Sqrt:  [[0.15]]
grads:  [-0.10114258]
Stock Position:  -0.10114258076307159
Bond Position:  [-12.33298912]


portfolio before change:  [-22.5174308]
curr_Stock_Price:  100.67866455519287
curr_Factors:  [100.67866456]
mat_Sqrt:  [[0.15]]
grads:  [0.21243254]
Stock Position:  0.21243254085747548
Bond Position:  [-43.90485532]


portfolio before change:  [-22.24732188]
curr_Stock_Price:  101.97600523485622
curr_Factors:  [101.97600523]
mat_Sqrt:  [[0.15]]
grads:  [0.1466238]
Stock Position:  0.14662379924290644
Bond Position:  [-37.1994312]


portfolio before change:  [-22.15335257]
curr_Stock_Price:  102.6486076768264
curr_Factors:  [102.64860768]
mat_Sqrt:  [[0.15]]
grads:  [-0.07625498]
Stock Position:  -0.07625497556398964
Bond Position:  [-14.3258855]


portfolio before change:  [-22.13900598]
curr_Stock_Price:  102.43698296285667
curr_Factors:  [102.43698296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998547]
Stock Position:  -0.019985466176438677
Bond Position:  [-20.09175512]


portfolio before change:  [-22.14921712]
curr_Stock_Price:  102.82223833882627
curr_Factors:  [102.82223834]
mat_Sqrt:  [[0.15]]
grads:  [-0.03523756]
Stock Position:  -0.03523755830682437
Bond Position:  [-18.5260125]


portfolio before change:  [-22.13279544]
curr_Stock_Price:  102.29048829407164
curr_Factors:  [102.29048829]
mat_Sqrt:  [[0.15]]
grads:  [0.04779137]
Stock Position:  0.04779136880893505
Bond Position:  [-27.02139789]


portfolio before change:  [-22.10835594]
curr_Stock_Price:  102.87254699049844
curr_Factors:  [102.87254699]
mat_Sqrt:  [[0.15]]
grads:  [0.11003804]
Stock Position:  0.11003803951497707
Bond Position:  [-33.42824933]


portfolio before change:  [-22.0719583]
curr_Stock_Price:  103.24129613154042
curr_Factors:  [103.24129613]
mat_Sqrt:  [[0.15]]
grads:  [0.0870786]
Stock Position:  0.08707859731558075
Bond Position:  [-31.06206555]


portfolio before change:  [-22.12774344]
curr_Stock_Price:  102.64525828174342
curr_Factors:  [102.64525828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00626478]
Stock Position:  -0.006264775676256535
Bond Position:  [-21.48469393]


portfolio before change:  [-22.12070508]
curr_Stock_Price:  101.09306858135841
curr_Factors:  [101.09306858]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251537]
Stock Position:  -0.03251537433436909
Bond Position:  [-18.83362611]


portfolio before change:  [-22.09752893]
curr_Stock_Price:  100.30788620277136
curr_Factors:  [100.3078862]
mat_Sqrt:  [[0.15]]
grads:  [0.04556989]
Stock Position:  0.045569888862116
Bond Position:  [-26.66854815]


portfolio before change:  [-22.0781355]
curr_Stock_Price:  100.80661922523304
curr_Factors:  [100.80661923]
mat_Sqrt:  [[0.15]]
grads:  [-0.06715341]
Stock Position:  -0.06715340749475175
Bond Position:  [-15.30862752]


portfolio before change:  [-22.10901387]
curr_Stock_Price:  101.23794020619209
curr_Factors:  [101.23794021]
mat_Sqrt:  [[0.15]]
grads:  [0.03637053]
Stock Position:  0.036370528270830656
Bond Position:  [-25.79109124]


portfolio before change:  [-22.1162037]
curr_Stock_Price:  101.12890286049651
curr_Factors:  [101.12890286]
mat_Sqrt:  [[0.15]]
grads:  [0.03713408]
Stock Position:  0.0371340819709736
Bond Position:  [-25.87153267]


portfolio before change:  [-22.19301593]
curr_Stock_Price:  99.14748624474613
curr_Factors:  [99.14748624]
mat_Sqrt:  [[0.15]]
grads:  [-0.05295477]
Stock Position:  -0.05295476517826774
Bond Position:  [-16.94268408]


portfolio before change:  [-22.20273056]
curr_Stock_Price:  99.290941846419
curr_Factors:  [99.29094185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563732]
Stock Position:  -0.015637317742948353
Bond Position:  [-20.65008655]


portfolio before change:  [-22.20112629]
curr_Stock_Price:  99.02326886667306
curr_Factors:  [99.02326887]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098487]
Stock Position:  -0.020984873424685163
Bond Position:  [-20.12313553]


portfolio before change:  [-22.20371964]
curr_Stock_Price:  99.02697594703544
curr_Factors:  [99.02697595]
mat_Sqrt:  [[0.15]]
grads:  [-0.09277632]
Stock Position:  -0.09277632413869559
Bond Position:  [-13.01636082]


portfolio before change:  [-22.20924648]
curr_Stock_Price:  99.06900930608356
curr_Factors:  [99.06900931]
mat_Sqrt:  [[0.15]]
grads:  [-0.01540966]
Stock Position:  -0.015409663916894602
Bond Position:  [-20.68262634]


portfolio before change:  [-22.21349669]
curr_Stock_Price:  99.1770397914317
curr_Factors:  [99.17703979]
mat_Sqrt:  [[0.15]]
grads:  [0.09897525]
Stock Position:  0.09897525343421787
Bond Position:  [-32.02956933]


portfolio before change:  [-22.18296174]
curr_Stock_Price:  99.52600472354636
curr_Factors:  [99.52600472]
mat_Sqrt:  [[0.15]]
grads:  [-0.06043669]
Stock Position:  -0.06043669130648788
Bond Position:  [-16.16793932]


portfolio before change:  [-22.21643563]
curr_Stock_Price:  100.04642990395044
curr_Factors:  [100.0464299]
mat_Sqrt:  [[0.15]]
grads:  [-0.14766662]
Stock Position:  -0.14766662144467005
Bond Position:  [-7.44291734]


portfolio before change:  [-22.32636015]
curr_Stock_Price:  100.78453908507967
curr_Factors:  [100.78453909]
mat_Sqrt:  [[0.15]]
grads:  [-0.1400388]
Stock Position:  -0.14003879786743226
Bond Position:  [-8.21261445]


portfolio before change:  [-22.11364229]
curr_Stock_Price:  99.25821562830605
curr_Factors:  [99.25821563]
mat_Sqrt:  [[0.15]]
grads:  [0.22825193]
Stock Position:  0.22825192803891348
Bond Position:  [-44.76952138]


portfolio before change:  [-22.28878482]
curr_Stock_Price:  98.5154136215992
curr_Factors:  [98.51541362]
mat_Sqrt:  [[0.15]]
grads:  [0.02199519]
Stock Position:  0.02199519184499006
Bond Position:  [-24.45565024]


portfolio before change:  [-22.30808031]
curr_Stock_Price:  97.77714571567822
curr_Factors:  [97.77714572]
mat_Sqrt:  [[0.15]]
grads:  [0.04589407]
Stock Position:  0.045894069652724856
Bond Position:  [-26.79547144]


portfolio before change:  [-22.31033948]
curr_Stock_Price:  97.80090634448716
curr_Factors:  [97.80090634]
mat_Sqrt:  [[0.15]]
grads:  [0.04337834]
Stock Position:  0.04337833868550651
Bond Position:  [-26.55278032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.29874498]
Stock Price:  98.14471398205022
PL:  [-22.29874498]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.09408165e-02]
 [ 2.63403631e-02]
 [-9.19544141e-03]
 [-7.44767725e-03]
 [-5.35341601e-03]
 [ 4.45944094e-02]
 [ 3.57979696e-03]
 [ 2.50701422e-03]
 [-1.63546196e-02]
 [ 2.34401669e-02]
 [ 2.01164126e-02]
 [-1.43371542e-02]
 [ 7.97974856e-03]
 [ 5.91233647e-03]
 [-5.75864626e-03]
 [-1.74827242e-03]
 [-6.14283599e-03]
 [ 4.35827283e-03]
 [ 6.92002006e-03]
 [ 2.18488963e-03]
 [-2.91932889e-03]
 [-5.01336626e-03]
 [ 3.99789350e-03]
 [-1.16188446e-02]
 [ 3.73626606e-03]
 [ 3.78371155e-03]
 [-2.43230174e-03]
 [ 1.48151928e-03]
 [ 2.77218633e-03]
 [-6.12386407e-03]
 [-1.97948085e-02]
 [ 1.41798347e-02]
 [-3.38016539e-03]
 [-1.98568369e-02]
 [-2.04258952e-02]
 [ 1.98925079e-02]
 [ 4.03167756e-03]
 [ 1.65259027e-02]
 [ 1.01115444e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.23582635]
curr_Stock_Price:  99.81224271916025
curr_Factors:  [99.81224272]
mat_Sqrt:  [[0.15]]
grads:  [0.07293878]
Stock Position:  0.07293877646950812
Bond Position:  [-9.51600921]


portfolio before change:  [-2.2851381]
curr_Stock_Price:  99.15248161160847
curr_Factors:  [99.15248161]
mat_Sqrt:  [[0.15]]
grads:  [0.17560242]
Stock Position:  0.1756024209464904
Bond Position:  [-19.69655391]


portfolio before change:  [-2.2519657]
curr_Stock_Price:  99.35540945140248
curr_Factors:  [99.35540945]
mat_Sqrt:  [[0.15]]
grads:  [-0.06130294]
Stock Position:  -0.06130294270053911
Bond Position:  [3.83881327]


portfolio before change:  [-2.2021145]
curr_Stock_Price:  98.55004321746227
curr_Factors:  [98.55004322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04965118]
Stock Position:  -0.049651181640325934
Bond Position:  [2.6910116]


portfolio before change:  [-2.17154612]
curr_Stock_Price:  97.94115571180969
curr_Factors:  [97.94115571]
mat_Sqrt:  [[0.15]]
grads:  [-0.03568944]
Stock Position:  -0.03568944005785838
Bond Position:  [1.32391889]


portfolio before change:  [-2.16779144]
curr_Stock_Price:  97.84058881040919
curr_Factors:  [97.84058881]
mat_Sqrt:  [[0.15]]
grads:  [0.29729606]
Stock Position:  0.2972960628290962
Bond Position:  [-31.25541328]


portfolio before change:  [-2.11798496]
curr_Stock_Price:  98.02126274731478
curr_Factors:  [98.02126275]
mat_Sqrt:  [[0.15]]
grads:  [0.02386531]
Stock Position:  0.023865313050979855
Bond Position:  [-4.45729308]


portfolio before change:  [-2.14198791]
curr_Stock_Price:  97.03884301102744
curr_Factors:  [97.03884301]
mat_Sqrt:  [[0.15]]
grads:  [0.01671343]
Stock Position:  0.01671342816160085
Bond Position:  [-3.76383964]


portfolio before change:  [-2.12355016]
curr_Stock_Price:  98.1701645875065
curr_Factors:  [98.17016459]
mat_Sqrt:  [[0.15]]
grads:  [-0.1090308]
Stock Position:  -0.10903079735291278
Bond Position:  [8.58002116]


portfolio before change:  [-2.18948442]
curr_Stock_Price:  98.78473253652064
curr_Factors:  [98.78473254]
mat_Sqrt:  [[0.15]]
grads:  [0.15626778]
Stock Position:  0.15626777951645837
Bond Position:  [-17.62635523]


portfolio before change:  [-2.1476591]
curr_Stock_Price:  99.06648448417721
curr_Factors:  [99.06648448]
mat_Sqrt:  [[0.15]]
grads:  [0.13410942]
Stock Position:  0.13410941702493434
Bond Position:  [-15.43340758]


portfolio before change:  [-2.15064195]
curr_Stock_Price:  99.05862855057097
curr_Factors:  [99.05862855]
mat_Sqrt:  [[0.15]]
grads:  [-0.09558103]
Stock Position:  -0.0955810281658861
Bond Position:  [7.31748361]


portfolio before change:  [-2.12596881]
curr_Stock_Price:  98.81006039282566
curr_Factors:  [98.81006039]
mat_Sqrt:  [[0.15]]
grads:  [0.05319832]
Stock Position:  0.05319832370928305
Bond Position:  [-7.38249839]


portfolio before change:  [-2.06305285]
curr_Stock_Price:  100.01007633803158
curr_Factors:  [100.01007634]
mat_Sqrt:  [[0.15]]
grads:  [0.03941558]
Stock Position:  0.039415576494963786
Bond Position:  [-6.00500766]


portfolio before change:  [-2.07441148]
curr_Stock_Price:  99.7409450816062
curr_Factors:  [99.74094508]
mat_Sqrt:  [[0.15]]
grads:  [-0.03839098]
Stock Position:  -0.03839097507873588
Bond Position:  [1.75474066]


portfolio before change:  [-2.06146413]
curr_Stock_Price:  99.40940883679293
curr_Factors:  [99.40940884]
mat_Sqrt:  [[0.15]]
grads:  [-0.01165515]
Stock Position:  -0.011655149472247616
Bond Position:  [-0.90283261]


portfolio before change:  [-2.0641548]
curr_Stock_Price:  99.63058242574662
curr_Factors:  [99.63058243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04095224]
Stock Position:  -0.04095223996345192
Bond Position:  [2.01594072]


portfolio before change:  [-2.04860285]
curr_Stock_Price:  99.256978006867
curr_Factors:  [99.25697801]
mat_Sqrt:  [[0.15]]
grads:  [0.02905515]
Stock Position:  0.02905515223256996
Bond Position:  [-4.93252946]


portfolio before change:  [-2.00921056]
curr_Stock_Price:  100.6339762573212
curr_Factors:  [100.63397626]
mat_Sqrt:  [[0.15]]
grads:  [0.04613347]
Stock Position:  0.046133467093463255
Bond Position:  [-6.65180479]


portfolio before change:  [-2.01714309]
curr_Stock_Price:  100.48005331023813
curr_Factors:  [100.48005331]
mat_Sqrt:  [[0.15]]
grads:  [0.01456593]
Stock Position:  0.01456593089822801
Bond Position:  [-3.4807286]


portfolio before change:  [-1.99957944]
curr_Stock_Price:  101.71572913182267
curr_Factors:  [101.71572913]
mat_Sqrt:  [[0.15]]
grads:  [-0.01946219]
Stock Position:  -0.019462192570394943
Bond Position:  [-0.01996833]


portfolio before change:  [-1.98918424]
curr_Stock_Price:  101.18147826541808
curr_Factors:  [101.18147827]
mat_Sqrt:  [[0.15]]
grads:  [-0.03342244]
Stock Position:  -0.0334224417466813
Bond Position:  [1.39254782]


portfolio before change:  [-2.03094429]
curr_Stock_Price:  102.43614801272886
curr_Factors:  [102.43614801]
mat_Sqrt:  [[0.15]]
grads:  [0.02665262]
Stock Position:  0.02665262332198514
Bond Position:  [-4.76113636]


portfolio before change:  [-2.01323599]
curr_Stock_Price:  103.12289010669548
curr_Factors:  [103.12289011]
mat_Sqrt:  [[0.15]]
grads:  [-0.07745896]
Stock Position:  -0.07745896379578633
Bond Position:  [5.97455622]


portfolio before change:  [-1.90608993]
curr_Stock_Price:  101.74926989988403
curr_Factors:  [101.7492699]
mat_Sqrt:  [[0.15]]
grads:  [0.02490844]
Stock Position:  0.024908440420970172
Bond Position:  [-4.44050555]


portfolio before change:  [-1.90848621]
curr_Stock_Price:  101.67535169339918
curr_Factors:  [101.67535169]
mat_Sqrt:  [[0.15]]
grads:  [0.02522474]
Stock Position:  0.02522474369773792
Bond Position:  [-4.4732209]


portfolio before change:  [-1.91058322]
curr_Stock_Price:  101.61438675735502
curr_Factors:  [101.61438676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01621534]
Stock Position:  -0.016215344920279484
Bond Position:  [-0.26287089]


portfolio before change:  [-1.94331519]
curr_Stock_Price:  103.63093976120966
curr_Factors:  [103.63093976]
mat_Sqrt:  [[0.15]]
grads:  [0.0098768]
Stock Position:  0.00987679522027563
Bond Position:  [-2.96685676]


portfolio before change:  [-1.95761619]
curr_Stock_Price:  102.22055121212368
curr_Factors:  [102.22055121]
mat_Sqrt:  [[0.15]]
grads:  [0.01848124]
Stock Position:  0.01848124223116708
Bond Position:  [-3.84677895]


portfolio before change:  [-1.96234132]
curr_Stock_Price:  101.99089891555566
curr_Factors:  [101.99089892]
mat_Sqrt:  [[0.15]]
grads:  [-0.04082576]
Stock Position:  -0.04082576045971917
Bond Position:  [2.20151468]


portfolio before change:  [-1.96759739]
curr_Stock_Price:  102.12638379635851
curr_Factors:  [102.1263838]
mat_Sqrt:  [[0.15]]
grads:  [-0.13196539]
Stock Position:  -0.13196539029448143
Bond Position:  [11.50955071]


portfolio before change:  [-1.96492058]
curr_Stock_Price:  102.11700238602701
curr_Factors:  [102.11700239]
mat_Sqrt:  [[0.15]]
grads:  [0.09453223]
Stock Position:  0.09453223112968596
Bond Position:  [-11.61826866]


portfolio before change:  [-1.96733214]
curr_Stock_Price:  102.10685578587635
curr_Factors:  [102.10685579]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253444]
Stock Position:  -0.02253443591744659
Bond Position:  [0.33358826]


portfolio before change:  [-1.96469298]
curr_Stock_Price:  101.99158963115568
curr_Factors:  [101.99158963]
mat_Sqrt:  [[0.15]]
grads:  [-0.13237891]
Stock Position:  -0.1323789125185709
Bond Position:  [11.53684274]


portfolio before change:  [-1.98109708]
curr_Stock_Price:  102.12640185328925
curr_Factors:  [102.12640185]
mat_Sqrt:  [[0.15]]
grads:  [-0.13617263]
Stock Position:  -0.13617263458011267
Bond Position:  [11.92572412]


portfolio before change:  [-2.07101715]
curr_Stock_Price:  102.79768857195577
curr_Factors:  [102.79768857]
mat_Sqrt:  [[0.15]]
grads:  [0.13261672]
Stock Position:  0.13261671938230882
Bond Position:  [-15.70370937]


portfolio before change:  [-2.16522202]
curr_Stock_Price:  102.10213689096295
curr_Factors:  [102.10213689]
mat_Sqrt:  [[0.15]]
grads:  [0.02687785]
Stock Position:  0.026877850372788635
Bond Position:  [-4.90950798]


portfolio before change:  [-2.16614737]
curr_Stock_Price:  102.09054281017602
curr_Factors:  [102.09054281]
mat_Sqrt:  [[0.15]]
grads:  [0.11017268]
Stock Position:  0.11017268448603122
Bond Position:  [-13.41373653]


portfolio before change:  [-1.93682705]
curr_Stock_Price:  104.1872253252287
curr_Factors:  [104.18722533]
mat_Sqrt:  [[0.15]]
grads:  [0.0674103]
Stock Position:  0.0674102958813898
Bond Position:  [-8.96011874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.94156398]
Stock Price:  104.13357117668134
PL:  [-6.07513516]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.28316291e-02]
 [-1.13128588e-02]
 [-1.49502697e-02]
 [-7.23174708e-03]
 [-6.33039091e-03]
 [ 4.77848578e-02]
 [ 3.57182576e-03]
 [ 2.01916434e-03]
 [-1.21665487e-03]
 [ 2.34432203e-02]
 [ 2.16512816e-02]
 [-5.86351636e-03]
 [-2.59539749e-02]
 [ 1.68537891e-02]
 [ 3.93160094e-03]
 [-1.85855495e-03]
 [-6.02701117e-03]
 [-8.30773572e-03]
 [ 1.84725890e-03]
 [ 2.16396286e-02]
 [-1.53936075e-02]
 [-2.08149598e-02]
 [ 4.60059316e-03]
 [-1.11835571e-02]
 [ 1.14375772e-02]
 [ 7.23514082e-04]
 [ 2.57974243e-02]
 [-4.95201928e-03]
 [-3.59336977e-02]
 [-1.03487804e-02]
 [ 4.92435027e-02]
 [-3.49701106e-03]
 [-2.21266874e-02]
 [-9.62871169e-03]
 [-2.44121913e-02]
 [ 3.01375829e-02]
 [-1.33939329e-02]
 [-1.54857965e-02]
 [ 5.04249145e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.68115537]
curr_Stock_Price:  99.51868343213734
curr_Factors:  [99.51868343]
mat_Sqrt:  [[0.15]]
grads:  [-0.08554419]
Stock Position:  -0.08554419378304369
Bond Position:  [-0.16790983]


portfolio before change:  [-8.50922569]
curr_Stock_Price:  97.50860344595665
curr_Factors:  [97.50860345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541906]
Stock Position:  -0.07541905854089057
Bond Position:  [-1.15521862]


portfolio before change:  [-8.54197984]
curr_Stock_Price:  97.94098410093945
curr_Factors:  [97.9409841]
mat_Sqrt:  [[0.15]]
grads:  [-0.09966846]
Stock Position:  -0.09966846447270236
Bond Position:  [1.21964765]


portfolio before change:  [-8.63096313]
curr_Stock_Price:  98.83530665072486
curr_Factors:  [98.83530665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04821165]
Stock Position:  -0.04821164718661166
Bond Position:  [-3.8659502]


portfolio before change:  [-8.63248423]
curr_Stock_Price:  98.85683303491145
curr_Factors:  [98.85683303]
mat_Sqrt:  [[0.15]]
grads:  [-0.04220261]
Stock Position:  -0.042202606062134544
Bond Position:  [-4.46046825]


portfolio before change:  [-8.57663893]
curr_Stock_Price:  97.52035406551522
curr_Factors:  [97.52035407]
mat_Sqrt:  [[0.15]]
grads:  [0.31856572]
Stock Position:  0.31856571870890654
Bond Position:  [-39.64328061]


portfolio before change:  [-8.57826842]
curr_Stock_Price:  97.53079532078388
curr_Factors:  [97.53079532]
mat_Sqrt:  [[0.15]]
grads:  [0.02381217]
Stock Position:  0.023812171732428666
Bond Position:  [-10.90068847]


portfolio before change:  [-8.5880062]
curr_Stock_Price:  97.17907987269358
curr_Factors:  [97.17907987]
mat_Sqrt:  [[0.15]]
grads:  [0.0134611]
Stock Position:  0.013461095576868873
Bond Position:  [-9.89614308]


portfolio before change:  [-8.58198956]
curr_Stock_Price:  97.71794658124509
curr_Factors:  [97.71794658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00811103]
Stock Position:  -0.00811103244955103
Bond Position:  [-7.78939612]


portfolio before change:  [-8.58374887]
curr_Stock_Price:  97.81479951228603
curr_Factors:  [97.81479951]
mat_Sqrt:  [[0.15]]
grads:  [0.15628814]
Stock Position:  0.15628813536175437
Bond Position:  [-23.8710415]


portfolio before change:  [-8.782573]
curr_Stock_Price:  96.56172895827636
curr_Factors:  [96.56172896]
mat_Sqrt:  [[0.15]]
grads:  [0.14434188]
Stock Position:  0.1443418774503036
Bond Position:  [-22.72047425]


portfolio before change:  [-8.77793327]
curr_Stock_Price:  96.61355011915097
curr_Factors:  [96.61355012]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909011]
Stock Position:  -0.03909010904634082
Bond Position:  [-5.00129906]


portfolio before change:  [-8.73556412]
curr_Stock_Price:  95.51367209991892
curr_Factors:  [95.5136721]
mat_Sqrt:  [[0.15]]
grads:  [-0.1730265]
Stock Position:  -0.17302649962961145
Bond Position:  [7.79083223]


portfolio before change:  [-8.63621349]
curr_Stock_Price:  94.94510763599361
curr_Factors:  [94.94510764]
mat_Sqrt:  [[0.15]]
grads:  [0.11235859]
Stock Position:  0.1123585939346646
Bond Position:  [-19.30411228]


portfolio before change:  [-8.69591861]
curr_Stock_Price:  94.43520485097565
curr_Factors:  [94.43520485]
mat_Sqrt:  [[0.15]]
grads:  [0.02621067]
Stock Position:  0.02621067295827407
Bond Position:  [-11.17112888]


portfolio before change:  [-8.68928601]
curr_Stock_Price:  94.74153367824098
curr_Factors:  [94.74153368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239037]
Stock Position:  -0.012390366302851506
Bond Position:  [-7.5154037]


portfolio before change:  [-8.68386316]
curr_Stock_Price:  94.22804397225607
curr_Factors:  [94.22804397]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018007]
Stock Position:  -0.04018007446693713
Bond Position:  [-4.89777334]


portfolio before change:  [-8.70366396]
curr_Stock_Price:  94.70560732698704
curr_Factors:  [94.70560733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0553849]
Stock Position:  -0.055384904767645134
Bond Position:  [-3.45840291]


portfolio before change:  [-8.71244437]
curr_Stock_Price:  94.85633587233598
curr_Factors:  [94.85633587]
mat_Sqrt:  [[0.15]]
grads:  [0.01231506]
Stock Position:  0.012315059335923634
Bond Position:  [-9.88060577]


portfolio before change:  [-8.72584525]
curr_Stock_Price:  93.86846179073936
curr_Factors:  [93.86846179]
mat_Sqrt:  [[0.15]]
grads:  [0.14426419]
Stock Position:  0.14426419078547315
Bond Position:  [-22.26770293]


portfolio before change:  [-8.52043474]
curr_Stock_Price:  95.31160682646863
curr_Factors:  [95.31160683]
mat_Sqrt:  [[0.15]]
grads:  [-0.10262405]
Stock Position:  -0.10262404973384132
Bond Position:  [1.26082834]


portfolio before change:  [-8.59962824]
curr_Stock_Price:  96.08482829283969
curr_Factors:  [96.08482829]
mat_Sqrt:  [[0.15]]
grads:  [-0.1387664]
Stock Position:  -0.13876639891931244
Bond Position:  [4.73371737]


portfolio before change:  [-8.49846556]
curr_Stock_Price:  95.36007841859649
curr_Factors:  [95.36007842]
mat_Sqrt:  [[0.15]]
grads:  [0.03067062]
Stock Position:  0.030670621093201456
Bond Position:  [-11.42321839]


portfolio before change:  [-8.50166808]
curr_Stock_Price:  95.3022209293124
curr_Factors:  [95.30222093]
mat_Sqrt:  [[0.15]]
grads:  [-0.07455705]
Stock Position:  -0.07455704754309482
Bond Position:  [-1.39621586]


portfolio before change:  [-8.52181922]
curr_Stock_Price:  95.5701581235592
curr_Factors:  [95.57015812]
mat_Sqrt:  [[0.15]]
grads:  [0.07625051]
Stock Position:  0.07625051438196742
Bond Position:  [-15.80909294]


portfolio before change:  [-8.50266736]
curr_Stock_Price:  95.84724637579929
curr_Factors:  [95.84724638]
mat_Sqrt:  [[0.15]]
grads:  [0.00482343]
Stock Position:  0.004823427213051778
Bond Position:  [-8.96497957]


portfolio before change:  [-8.50715053]
curr_Stock_Price:  95.15013280979531
curr_Factors:  [95.15013281]
mat_Sqrt:  [[0.15]]
grads:  [0.17198283]
Stock Position:  0.17198282889302924
Bond Position:  [-24.87133954]


portfolio before change:  [-8.62434608]
curr_Stock_Price:  94.48677329730533
curr_Factors:  [94.4867733]
mat_Sqrt:  [[0.15]]
grads:  [-0.03301346]
Stock Position:  -0.03301346183538324
Bond Position:  [-5.5050106]


portfolio before change:  [-8.64279122]
curr_Stock_Price:  95.02464381170039
curr_Factors:  [95.02464381]
mat_Sqrt:  [[0.15]]
grads:  [-0.23955798]
Stock Position:  -0.23955798497540232
Bond Position:  [14.12112097]


portfolio before change:  [-8.80779755]
curr_Stock_Price:  95.72080755022947
curr_Factors:  [95.72080755]
mat_Sqrt:  [[0.15]]
grads:  [-0.06899187]
Stock Position:  -0.06899186962791853
Bond Position:  [-2.20384008]


portfolio before change:  [-8.70501535]
curr_Stock_Price:  94.22704165097153
curr_Factors:  [94.22704165]
mat_Sqrt:  [[0.15]]
grads:  [0.32829002]
Stock Position:  0.32829001792355267
Bond Position:  [-39.63881254]


portfolio before change:  [-8.85547923]
curr_Stock_Price:  93.78380941374627
curr_Factors:  [93.78380941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02331341]
Stock Position:  -0.023313407084197768
Bond Position:  [-6.6690591]


portfolio before change:  [-8.84408383]
curr_Stock_Price:  93.25925771179541
curr_Factors:  [93.25925771]
mat_Sqrt:  [[0.15]]
grads:  [-0.14751125]
Stock Position:  -0.1475112496440403
Bond Position:  [4.91270582]


portfolio before change:  [-8.78501769]
curr_Stock_Price:  92.863003118921
curr_Factors:  [92.86300312]
mat_Sqrt:  [[0.15]]
grads:  [-0.06419141]
Stock Position:  -0.0641914112429648
Bond Position:  [-2.82401047]


portfolio before change:  [-8.74595003]
curr_Stock_Price:  92.24889171184117
curr_Factors:  [92.24889171]
mat_Sqrt:  [[0.15]]
grads:  [-0.16274794]
Stock Position:  -0.16274794214965133
Bond Position:  [6.26736726]


portfolio before change:  [-8.85041388]
curr_Stock_Price:  92.89558081116962
curr_Factors:  [92.89558081]
mat_Sqrt:  [[0.15]]
grads:  [0.20091722]
Stock Position:  0.20091721921144776
Bond Position:  [-27.51473566]


portfolio before change:  [-9.04661166]
curr_Stock_Price:  91.93618958382832
curr_Factors:  [91.93618958]
mat_Sqrt:  [[0.15]]
grads:  [-0.08929289]
Stock Position:  -0.08929288629029804
Bond Position:  [-0.83736394]


portfolio before change:  [-8.95294757]
curr_Stock_Price:  90.88606378623123
curr_Factors:  [90.88606379]
mat_Sqrt:  [[0.15]]
grads:  [-0.10323864]
Stock Position:  -0.10323864359206898
Bond Position:  [0.43000637]


portfolio before change:  [-9.00266035]
curr_Stock_Price:  91.36811712707251
curr_Factors:  [91.36811713]
mat_Sqrt:  [[0.15]]
grads:  [0.3361661]
Stock Position:  0.3361660966965992
Bond Position:  [-39.71752365]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.55413503]
Stock Price:  89.74240386611207
PL:  [-9.55413503]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.16184234e-02]
 [ 4.39453022e-02]
 [-3.10079825e-03]
 [-6.89404236e-03]
 [-6.47683361e-03]
 [ 3.10881991e-02]
 [ 3.49911644e-03]
 [ 1.23593276e-02]
 [-1.63259016e-02]
 [ 2.33162777e-02]
 [ 1.91765063e-02]
 [-1.10609026e-02]
 [-7.14709418e-03]
 [ 6.88398247e-03]
 [-1.49031195e-02]
 [-2.09675542e-03]
 [-6.14209623e-03]
 [ 5.17797617e-03]
 [ 6.50864435e-03]
 [ 8.60169797e-03]
 [-4.40043400e-03]
 [-4.58261798e-03]
 [ 5.18668404e-03]
 [-1.12997923e-02]
 [ 5.20600067e-03]
 [ 6.45115165e-03]
 [-3.08097105e-03]
 [-1.41684791e-03]
 [ 4.75854421e-04]
 [-1.07545849e-02]
 [ 1.44580310e-02]
 [ 1.51356484e-02]
 [-9.29992758e-03]
 [-1.96487956e-02]
 [-2.15254289e-02]
 [ 2.88142801e-02]
 [ 4.90268874e-03]
 [ 1.11194099e-02]
 [ 8.92233401e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.07894784]
curr_Stock_Price:  99.81938791581807
curr_Factors:  [99.81938792]
mat_Sqrt:  [[0.15]]
grads:  [0.07745616]
Stock Position:  0.07745615616077157
Bond Position:  [-9.81057394]


portfolio before change:  [-2.03211282]
curr_Stock_Price:  100.43988633645905
curr_Factors:  [100.43988634]
mat_Sqrt:  [[0.15]]
grads:  [0.29296868]
Stock Position:  0.29296868101448414
Bond Position:  [-31.45785384]


portfolio before change:  [-2.12615078]
curr_Stock_Price:  100.13232620726728
curr_Factors:  [100.13232621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02067199]
Stock Position:  -0.02067198836292116
Bond Position:  [-0.0562165]


portfolio before change:  [-2.10569027]
curr_Stock_Price:  99.1422164345427
curr_Factors:  [99.14221643]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596028]
Stock Position:  -0.04596028240088737
Bond Position:  [2.45091399]


portfolio before change:  [-2.0997786]
curr_Stock_Price:  99.02025707883054
curr_Factors:  [99.02025708]
mat_Sqrt:  [[0.15]]
grads:  [-0.04317889]
Stock Position:  -0.04317889072008705
Bond Position:  [2.17580626]


portfolio before change:  [-2.15492792]
curr_Stock_Price:  100.30378502215162
curr_Factors:  [100.30378502]
mat_Sqrt:  [[0.15]]
grads:  [0.20725466]
Stock Position:  0.20725466041523904
Bond Position:  [-22.94335483]


portfolio before change:  [-1.75648574]
curr_Stock_Price:  102.24009990005266
curr_Factors:  [102.2400999]
mat_Sqrt:  [[0.15]]
grads:  [0.02332744]
Stock Position:  0.023327442935810586
Bond Position:  [-4.14148583]


portfolio before change:  [-1.76973472]
curr_Stock_Price:  101.69433634220282
curr_Factors:  [101.69433634]
mat_Sqrt:  [[0.15]]
grads:  [0.08239552]
Stock Position:  0.08239551729553088
Bond Position:  [-10.14889217]


portfolio before change:  [-1.80885592]
curr_Stock_Price:  101.23493626065273
curr_Factors:  [101.23493626]
mat_Sqrt:  [[0.15]]
grads:  [-0.10883934]
Stock Position:  -0.10883934427696858
Bond Position:  [9.20948816]


portfolio before change:  [-1.74999217]
curr_Stock_Price:  100.70468229885387
curr_Factors:  [100.7046823]
mat_Sqrt:  [[0.15]]
grads:  [0.15544185]
Stock Position:  0.1554418514665616
Bond Position:  [-17.40371444]


portfolio before change:  [-1.82772505]
curr_Stock_Price:  100.21860163644413
curr_Factors:  [100.21860164]
mat_Sqrt:  [[0.15]]
grads:  [0.12784338]
Stock Position:  0.12784337519564046
Bond Position:  [-14.64000934]


portfolio before change:  [-2.0984123]
curr_Stock_Price:  98.11558192307096
curr_Factors:  [98.11558192]
mat_Sqrt:  [[0.15]]
grads:  [-0.07373935]
Stock Position:  -0.0737393504907718
Bond Position:  [5.13656698]


portfolio before change:  [-2.06209617]
curr_Stock_Price:  97.6317965157893
curr_Factors:  [97.63179652]
mat_Sqrt:  [[0.15]]
grads:  [-0.04764729]
Stock Position:  -0.04764729454969096
Bond Position:  [2.5897948]


portfolio before change:  [-2.09903694]
curr_Stock_Price:  98.41388747213324
curr_Factors:  [98.41388747]
mat_Sqrt:  [[0.15]]
grads:  [0.04589322]
Stock Position:  0.045893216456997926
Bond Position:  [-6.61556678]


portfolio before change:  [-2.1063569]
curr_Stock_Price:  98.2724078486819
curr_Factors:  [98.27240785]
mat_Sqrt:  [[0.15]]
grads:  [-0.09935413]
Stock Position:  -0.09935412988372641
Bond Position:  [7.65741268]


portfolio before change:  [-2.23431146]
curr_Stock_Price:  99.5699060149179
curr_Factors:  [99.56990601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01397837]
Stock Position:  -0.013978369489896007
Bond Position:  [-0.84248653]


portfolio before change:  [-2.2349824]
curr_Stock_Price:  99.61037035546312
curr_Factors:  [99.61037036]
mat_Sqrt:  [[0.15]]
grads:  [-0.04094731]
Stock Position:  -0.040947308174796714
Bond Position:  [1.84379413]


portfolio before change:  [-2.24936974]
curr_Stock_Price:  99.9673615534323
curr_Factors:  [99.96736155]
mat_Sqrt:  [[0.15]]
grads:  [0.03451984]
Stock Position:  0.03451984116002629
Bond Position:  [-5.70022719]


portfolio before change:  [-2.23901995]
curr_Stock_Price:  100.28782552837978
curr_Factors:  [100.28782553]
mat_Sqrt:  [[0.15]]
grads:  [0.04339096]
Stock Position:  0.04339096231848341
Bond Position:  [-6.59060521]


portfolio before change:  [-2.21289096]
curr_Stock_Price:  100.90898868891846
curr_Factors:  [100.90898869]
mat_Sqrt:  [[0.15]]
grads:  [0.05734465]
Stock Position:  0.05734465311681189
Bond Position:  [-7.99948191]


portfolio before change:  [-2.27188636]
curr_Stock_Price:  99.89764067310568
curr_Factors:  [99.89764067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02933623]
Stock Position:  -0.02933622663923995
Bond Position:  [0.65873347]


portfolio before change:  [-2.28786696]
curr_Stock_Price:  100.44518708760008
curr_Factors:  [100.44518709]
mat_Sqrt:  [[0.15]]
grads:  [-0.03055079]
Stock Position:  -0.030550786512477866
Bond Position:  [0.78081251]


portfolio before change:  [-2.3123152]
curr_Stock_Price:  101.24863127506516
curr_Factors:  [101.24863128]
mat_Sqrt:  [[0.15]]
grads:  [0.03457789]
Stock Position:  0.034577893569257515
Bond Position:  [-5.8132796]


portfolio before change:  [-2.31224325]
curr_Stock_Price:  101.27172875040972
curr_Factors:  [101.27172875]
mat_Sqrt:  [[0.15]]
grads:  [-0.07533195]
Stock Position:  -0.07533194899091841
Bond Position:  [5.31675346]


portfolio before change:  [-2.31518963]
curr_Stock_Price:  101.31966355121277
curr_Factors:  [101.31966355]
mat_Sqrt:  [[0.15]]
grads:  [0.03470667]
Stock Position:  0.034706671131271044
Bond Position:  [-5.83165788]


portfolio before change:  [-2.33124171]
curr_Stock_Price:  100.87816142842206
curr_Factors:  [100.87816143]
mat_Sqrt:  [[0.15]]
grads:  [0.04300768]
Stock Position:  0.04300767767654649
Bond Position:  [-6.66977716]


portfolio before change:  [-2.33027785]
curr_Stock_Price:  100.91995923949378
curr_Factors:  [100.91995924]
mat_Sqrt:  [[0.15]]
grads:  [-0.02053981]
Stock Position:  -0.020539807017296727
Bond Position:  [-0.25740137]


portfolio before change:  [-2.32563784]
curr_Stock_Price:  100.69248927950396
curr_Factors:  [100.69248928]
mat_Sqrt:  [[0.15]]
grads:  [-0.00944565]
Stock Position:  -0.009445652766122378
Bond Position:  [-1.37453155]


portfolio before change:  [-2.32068361]
curr_Stock_Price:  100.14979915181736
curr_Factors:  [100.14979915]
mat_Sqrt:  [[0.15]]
grads:  [0.00317236]
Stock Position:  0.0031723628058741987
Bond Position:  [-2.6383951]


portfolio before change:  [-2.32235409]
curr_Stock_Price:  99.72719079319961
curr_Factors:  [99.72719079]
mat_Sqrt:  [[0.15]]
grads:  [-0.07169723]
Stock Position:  -0.07169723284337066
Bond Position:  [4.82780953]


portfolio before change:  [-2.21532053]
curr_Stock_Price:  98.24275350361147
curr_Factors:  [98.2427535]
mat_Sqrt:  [[0.15]]
grads:  [0.09638687]
Stock Position:  0.09638687320011577
Bond Position:  [-11.68463236]


portfolio before change:  [-2.11831506]
curr_Stock_Price:  99.26432567698777
curr_Factors:  [99.26432568]
mat_Sqrt:  [[0.15]]
grads:  [0.10090432]
Stock Position:  0.10090432284716497
Bond Position:  [-12.13451462]


portfolio before change:  [-2.11720087]
curr_Stock_Price:  99.29040082128039
curr_Factors:  [99.29040082]
mat_Sqrt:  [[0.15]]
grads:  [-0.06199952]
Stock Position:  -0.06199951720095121
Bond Position:  [4.03875604]


portfolio before change:  [-2.19211492]
curr_Stock_Price:  100.50684457650429
curr_Factors:  [100.50684458]
mat_Sqrt:  [[0.15]]
grads:  [-0.13099197]
Stock Position:  -0.1309919707654584
Bond Position:  [10.97347473]


portfolio before change:  [-2.11972706]
curr_Stock_Price:  99.96470378666046
curr_Factors:  [99.96470379]
mat_Sqrt:  [[0.15]]
grads:  [-0.14350286]
Stock Position:  -0.14350285917008537
Bond Position:  [12.22549375]


portfolio before change:  [-2.12535043]
curr_Stock_Price:  100.01454012759622
curr_Factors:  [100.01454013]
mat_Sqrt:  [[0.15]]
grads:  [0.1920952]
Stock Position:  0.1920952005973555
Bond Position:  [-21.33766358]


portfolio before change:  [-1.8776351]
curr_Stock_Price:  101.31797042887577
curr_Factors:  [101.31797043]
mat_Sqrt:  [[0.15]]
grads:  [0.03268459]
Stock Position:  0.032684591578400986
Bond Position:  [-5.18917159]


portfolio before change:  [-1.89532534]
curr_Stock_Price:  100.79657653836357
curr_Factors:  [100.79657654]
mat_Sqrt:  [[0.15]]
grads:  [0.0741294]
Stock Position:  0.07412939906071533
Bond Position:  [-9.36731498]


portfolio before change:  [-1.82961686]
curr_Stock_Price:  101.69877540968655
curr_Factors:  [101.69877541]
mat_Sqrt:  [[0.15]]
grads:  [0.05948223]
Stock Position:  0.05948222674292461
Bond Position:  [-7.87888648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.79243847]
Stock Price:  102.34036739360184
PL:  [-4.13280586]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.15970153e-02]
 [ 4.35831161e-02]
 [-2.61888737e-03]
 [-2.64805718e-03]
 [-7.72606209e-03]
 [ 2.98692733e-02]
 [ 3.67168508e-03]
 [ 5.53247172e-03]
 [-1.31894267e-02]
 [ 2.29408369e-02]
 [ 1.89729122e-02]
 [-3.82560935e-03]
 [ 1.73774323e-02]
 [ 2.33809851e-02]
 [-1.07484752e-02]
 [-3.17071329e-03]
 [-5.33763053e-03]
 [ 6.46362371e-03]
 [ 1.20722932e-02]
 [ 1.51599850e-02]
 [-5.10432015e-03]
 [-4.56502667e-03]
 [ 7.07357421e-03]
 [-1.10971155e-02]
 [ 9.03726414e-03]
 [ 6.87887786e-03]
 [-2.36803324e-03]
 [-3.52417557e-04]
 [ 2.60689132e-03]
 [-6.10983748e-03]
 [-1.63625412e-02]
 [ 6.16374981e-03]
 [ 1.62732204e-03]
 [ 1.27165398e-02]
 [-2.01848766e-02]
 [-9.78817708e-04]
 [ 7.35044539e-03]
 [ 2.00341065e-02]
 [ 8.46369012e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.82202054]
curr_Stock_Price:  100.13369977702204
curr_Factors:  [100.13369978]
mat_Sqrt:  [[0.15]]
grads:  [0.1439801]
Stock Position:  0.14398010170142314
Bond Position:  [-9.59523973]


portfolio before change:  [4.82738766]
curr_Stock_Price:  100.17930746949952
curr_Factors:  [100.17930747]
mat_Sqrt:  [[0.15]]
grads:  [0.29055411]
Stock Position:  0.2905541074684726
Bond Position:  [-24.2801216]


portfolio before change:  [4.69406233]
curr_Stock_Price:  99.73088798183751
curr_Factors:  [99.73088798]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745925]
Stock Position:  -0.01745924913906042
Bond Position:  [6.43528875]


portfolio before change:  [4.68126642]
curr_Stock_Price:  100.50986632631704
curr_Factors:  [100.50986633]
mat_Sqrt:  [[0.15]]
grads:  [-0.01765371]
Stock Position:  -0.01765371452653638
Bond Position:  [6.45563891]


portfolio before change:  [4.68658826]
curr_Stock_Price:  100.25412193194785
curr_Factors:  [100.25412193]
mat_Sqrt:  [[0.15]]
grads:  [-0.05150708]
Stock Position:  -0.051507080576479625
Bond Position:  [9.8503854]


portfolio before change:  [4.69773851]
curr_Stock_Price:  100.0615489234101
curr_Factors:  [100.06154892]
mat_Sqrt:  [[0.15]]
grads:  [0.19912849]
Stock Position:  0.1991284886160035
Bond Position:  [-15.22736649]


portfolio before change:  [4.70524295]
curr_Stock_Price:  100.10879469273985
curr_Factors:  [100.10879469]
mat_Sqrt:  [[0.15]]
grads:  [0.0244779]
Stock Position:  0.024477900557987767
Bond Position:  [2.25478983]


portfolio before change:  [4.72210392]
curr_Stock_Price:  100.78610381072315
curr_Factors:  [100.78610381]
mat_Sqrt:  [[0.15]]
grads:  [0.03688314]
Stock Position:  0.036883144808740984
Bond Position:  [1.00479546]


portfolio before change:  [4.7514066]
curr_Stock_Price:  101.5771716832843
curr_Factors:  [101.57717168]
mat_Sqrt:  [[0.15]]
grads:  [-0.08792951]
Stock Position:  -0.08792951138347575
Bond Position:  [13.68303767]


portfolio before change:  [4.72278968]
curr_Stock_Price:  101.92207760619179
curr_Factors:  [101.92207761]
mat_Sqrt:  [[0.15]]
grads:  [0.15293891]
Stock Position:  0.15293891292178194
Bond Position:  [-10.86506207]


portfolio before change:  [4.75139223]
curr_Stock_Price:  102.11797782040314
curr_Factors:  [102.11797782]
mat_Sqrt:  [[0.15]]
grads:  [0.12648608]
Stock Position:  0.12648608133421005
Bond Position:  [-8.16511062]


portfolio before change:  [4.84106632]
curr_Stock_Price:  102.83501163723875
curr_Factors:  [102.83501164]
mat_Sqrt:  [[0.15]]
grads:  [-0.02550406]
Stock Position:  -0.025504062306073844
Bond Position:  [7.46377686]


portfolio before change:  [4.86840823]
curr_Stock_Price:  101.79953439295112
curr_Factors:  [101.79953439]
mat_Sqrt:  [[0.15]]
grads:  [0.11584955]
Stock Position:  0.11584954861246935
Bond Position:  [-6.92502188]


portfolio before change:  [4.99512091]
curr_Stock_Price:  102.90077621403259
curr_Factors:  [102.90077621]
mat_Sqrt:  [[0.15]]
grads:  [0.15587323]
Stock Position:  0.15587323376434215
Bond Position:  [-11.04435583]


portfolio before change:  [5.0441733]
curr_Stock_Price:  103.22432772388451
curr_Factors:  [103.22432772]
mat_Sqrt:  [[0.15]]
grads:  [-0.0716565]
Stock Position:  -0.07165650145911427
Bond Position:  [12.44086749]


portfolio before change:  [5.06474746]
curr_Stock_Price:  102.95890928870757
curr_Factors:  [102.95890929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02113809]
Stock Position:  -0.021138088567538623
Bond Position:  [7.24110201]


portfolio before change:  [5.07140574]
curr_Stock_Price:  102.68674293290547
curr_Factors:  [102.68674293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0355842]
Stock Position:  -0.03558420354278094
Bond Position:  [8.7254317]


portfolio before change:  [5.1273784]
curr_Stock_Price:  101.14443174165335
curr_Factors:  [101.14443174]
mat_Sqrt:  [[0.15]]
grads:  [0.04309082]
Stock Position:  0.04309082473153327
Bond Position:  [0.76898142]


portfolio before change:  [5.15570173]
curr_Stock_Price:  101.79949465393526
curr_Factors:  [101.79949465]
mat_Sqrt:  [[0.15]]
grads:  [0.08048195]
Stock Position:  0.08048195447363986
Bond Position:  [-3.03732057]


portfolio before change:  [5.14984671]
curr_Stock_Price:  101.73146288046581
curr_Factors:  [101.73146288]
mat_Sqrt:  [[0.15]]
grads:  [0.10106657]
Stock Position:  0.10106656676865047
Bond Position:  [-5.13180298]


portfolio before change:  [5.04178045]
curr_Stock_Price:  100.66855208709948
curr_Factors:  [100.66855209]
mat_Sqrt:  [[0.15]]
grads:  [-0.0340288]
Stock Position:  -0.03402880099799837
Bond Position:  [8.46741057]


portfolio before change:  [5.05868082]
curr_Stock_Price:  100.20300880160256
curr_Factors:  [100.2030088]
mat_Sqrt:  [[0.15]]
grads:  [-0.03043351]
Stock Position:  -0.030433511134068857
Bond Position:  [8.10821021]


portfolio before change:  [5.06282967]
curr_Stock_Price:  100.09998888543038
curr_Factors:  [100.09998889]
mat_Sqrt:  [[0.15]]
grads:  [0.04715716]
Stock Position:  0.04715716142838546
Bond Position:  [0.34239833]


portfolio before change:  [5.11318686]
curr_Stock_Price:  101.16694003178215
curr_Factors:  [101.16694003]
mat_Sqrt:  [[0.15]]
grads:  [-0.07398077]
Stock Position:  -0.07398076980082237
Bond Position:  [12.59759496]


portfolio before change:  [5.16177379]
curr_Stock_Price:  100.53147584093043
curr_Factors:  [100.53147584]
mat_Sqrt:  [[0.15]]
grads:  [0.06024843]
Stock Position:  0.06024842762945794
Bond Position:  [-0.89508956]


portfolio before change:  [5.17378907]
curr_Stock_Price:  100.73276204486258
curr_Factors:  [100.73276204]
mat_Sqrt:  [[0.15]]
grads:  [0.04585919]
Stock Position:  0.0458591857334787
Bond Position:  [0.55426663]


portfolio before change:  [5.2034918]
curr_Stock_Price:  101.37894544748963
curr_Factors:  [101.37894545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578689]
Stock Position:  -0.015786888241479405
Bond Position:  [6.80394988]


portfolio before change:  [5.20117868]
curr_Stock_Price:  101.57934432691684
curr_Factors:  [101.57934433]
mat_Sqrt:  [[0.15]]
grads:  [-0.00234945]
Stock Position:  -0.0023494503828006635
Bond Position:  [5.4398343]


portfolio before change:  [5.20057621]
curr_Stock_Price:  102.12521030321062
curr_Factors:  [102.1252103]
mat_Sqrt:  [[0.15]]
grads:  [0.01737928]
Stock Position:  0.01737927548118297
Bond Position:  [3.42571405]


portfolio before change:  [5.20309743]
curr_Stock_Price:  102.24563957472374
curr_Factors:  [102.24563957]
mat_Sqrt:  [[0.15]]
grads:  [-0.04073225]
Stock Position:  -0.0407322498786966
Bond Position:  [9.36779237]


portfolio before change:  [5.11484591]
curr_Stock_Price:  104.4410145107394
curr_Factors:  [104.44101451]
mat_Sqrt:  [[0.15]]
grads:  [-0.10908361]
Stock Position:  -0.10908360773974854
Bond Position:  [16.50764857]


portfolio before change:  [5.12773828]
curr_Stock_Price:  104.34174404577251
curr_Factors:  [104.34174405]
mat_Sqrt:  [[0.15]]
grads:  [0.04109167]
Stock Position:  0.041091665390729844
Bond Position:  [0.84016225]


portfolio before change:  [5.11936246]
curr_Stock_Price:  104.13535547617786
curr_Factors:  [104.13535548]
mat_Sqrt:  [[0.15]]
grads:  [0.01084881]
Stock Position:  0.010848813598560679
Bond Position:  [3.98961739]


portfolio before change:  [5.12542688]
curr_Stock_Price:  104.64837823420895
curr_Factors:  [104.64837823]
mat_Sqrt:  [[0.15]]
grads:  [0.08477693]
Stock Position:  0.08477693221123787
Bond Position:  [-3.74634159]


portfolio before change:  [5.14088337]
curr_Stock_Price:  104.8362219091997
curr_Factors:  [104.83622191]
mat_Sqrt:  [[0.15]]
grads:  [-0.13456584]
Stock Position:  -0.1345658440242283
Bond Position:  [19.24825805]


portfolio before change:  [5.13758202]
curr_Stock_Price:  104.87863632342945
curr_Factors:  [104.87863632]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652545]
Stock Position:  -0.0065254513849046306
Bond Position:  [5.82196246]


portfolio before change:  [5.14123406]
curr_Stock_Price:  104.43050654861125
curr_Factors:  [104.43050655]
mat_Sqrt:  [[0.15]]
grads:  [0.04900297]
Stock Position:  0.049002969238535525
Bond Position:  [0.02382916]


portfolio before change:  [5.20385709]
curr_Stock_Price:  105.70838938916465
curr_Factors:  [105.70838939]
mat_Sqrt:  [[0.15]]
grads:  [0.13356071]
Stock Position:  0.13356070981023302
Bond Position:  [-8.91463043]


portfolio before change:  [5.31465227]
curr_Stock_Price:  106.54628233122199
curr_Factors:  [106.54628233]
mat_Sqrt:  [[0.15]]
grads:  [0.0564246]
Stock Position:  0.056424600770827345
Bond Position:  [-0.69717918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.36275827]
Stock Price:  107.4003982913762
PL:  [-2.03764003]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.75768918e-03]
 [-1.51982798e-02]
 [ 4.61858591e-03]
 [ 1.96570803e-03]
 [-7.42709214e-03]
 [ 2.77337392e-02]
 [ 3.71660983e-03]
 [ 7.17556577e-03]
 [-2.51385784e-02]
 [ 2.33609686e-02]
 [ 1.99996820e-02]
 [-9.73971523e-03]
 [ 1.29042219e-02]
 [ 2.33359874e-02]
 [ 7.88867828e-03]
 [-3.69570057e-03]
 [-5.69585382e-03]
 [ 6.90326660e-03]
 [ 1.42203560e-02]
 [ 1.70260991e-02]
 [-2.95736655e-03]
 [-5.04835934e-03]
 [ 3.99783896e-03]
 [-1.23816420e-02]
 [-7.57389241e-05]
 [ 3.56943215e-03]
 [ 2.32887159e-03]
 [ 1.35646804e-03]
 [ 4.42025690e-03]
 [-6.00394926e-03]
 [-1.83175961e-02]
 [ 9.32128741e-03]
 [-2.72353692e-03]
 [-1.81220305e-02]
 [-2.06201964e-02]
 [ 2.72097929e-02]
 [ 4.73813445e-03]
 [ 1.27490746e-02]
 [ 7.70132731e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.36873868]
curr_Stock_Price:  100.38633088678202
curr_Factors:  [100.38633089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01838459]
Stock Position:  -0.018384594533364836
Bond Position:  [12.21430067]


portfolio before change:  [10.3488853]
curr_Stock_Price:  101.54927561608504
curr_Factors:  [101.54927562]
mat_Sqrt:  [[0.15]]
grads:  [-0.10132187]
Stock Position:  -0.10132186544613324
Bond Position:  [20.63804734]


portfolio before change:  [10.32664696]
curr_Stock_Price:  101.79422033828554
curr_Factors:  [101.79422034]
mat_Sqrt:  [[0.15]]
grads:  [0.03079057]
Stock Position:  0.030790572731372104
Bond Position:  [7.19234461]


portfolio before change:  [10.34061611]
curr_Stock_Price:  102.21870242601919
curr_Factors:  [102.21870243]
mat_Sqrt:  [[0.15]]
grads:  [0.01310472]
Stock Position:  0.013104720184485413
Bond Position:  [9.00106861]


portfolio before change:  [10.3173373]
curr_Stock_Price:  100.35647160803289
curr_Factors:  [100.35647161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04951395]
Stock Position:  -0.049513947571300475
Bond Position:  [15.28638237]


portfolio before change:  [10.34968856]
curr_Stock_Price:  99.74168839914711
curr_Factors:  [99.7416884]
mat_Sqrt:  [[0.15]]
grads:  [0.18489159]
Stock Position:  0.18489159435632394
Bond Position:  [-8.09171124]


portfolio before change:  [10.59643124]
curr_Stock_Price:  101.08168556713692
curr_Factors:  [101.08168557]
mat_Sqrt:  [[0.15]]
grads:  [0.0247774]
Stock Position:  0.024777398839478968
Bond Position:  [8.09189]


portfolio before change:  [10.59809824]
curr_Stock_Price:  101.10813895265593
curr_Factors:  [101.10813895]
mat_Sqrt:  [[0.15]]
grads:  [0.04783711]
Stock Position:  0.04783710510224374
Bond Position:  [5.76137757]


portfolio before change:  [10.56381009]
curr_Stock_Price:  100.37631449961063
curr_Factors:  [100.3763145]
mat_Sqrt:  [[0.15]]
grads:  [-0.16759052]
Stock Position:  -0.16759052277308387
Bond Position:  [27.38592911]


portfolio before change:  [10.54954011]
curr_Stock_Price:  100.48188988462164
curr_Factors:  [100.48188988]
mat_Sqrt:  [[0.15]]
grads:  [0.15573979]
Stock Position:  0.15573979054501277
Bond Position:  [-5.09948837]


portfolio before change:  [10.74148728]
curr_Stock_Price:  101.71846947731447
curr_Factors:  [101.71846948]
mat_Sqrt:  [[0.15]]
grads:  [0.13333121]
Stock Position:  0.13333121319275745
Bond Position:  [-2.82075966]


portfolio before change:  [10.75550359]
curr_Stock_Price:  101.82623809797097
curr_Factors:  [101.8262381]
mat_Sqrt:  [[0.15]]
grads:  [-0.06493143]
Stock Position:  -0.0649314348447308
Bond Position:  [17.36722733]


portfolio before change:  [10.72600485]
curr_Stock_Price:  102.31397992631508
curr_Factors:  [102.31397993]
mat_Sqrt:  [[0.15]]
grads:  [0.08602815]
Stock Position:  0.08602814587340026
Bond Position:  [1.92412286]


portfolio before change:  [10.73981226]
curr_Stock_Price:  102.4716827013047
curr_Factors:  [102.4716827]
mat_Sqrt:  [[0.15]]
grads:  [0.15557325]
Stock Position:  0.15557324924913946
Bond Position:  [-5.20204038]


portfolio before change:  [10.44705004]
curr_Stock_Price:  100.59403391892477
curr_Factors:  [100.59403392]
mat_Sqrt:  [[0.15]]
grads:  [0.05259119]
Stock Position:  0.052591188531741266
Bond Position:  [5.15669024]


portfolio before change:  [10.48199647]
curr_Stock_Price:  101.2462687066092
curr_Factors:  [101.24626871]
mat_Sqrt:  [[0.15]]
grads:  [-0.024638]
Stock Position:  -0.024638003827847078
Bond Position:  [12.97650243]


portfolio before change:  [10.4695609]
curr_Stock_Price:  101.8168396756605
curr_Factors:  [101.81683968]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797236]
Stock Position:  -0.03797235881117302
Bond Position:  [14.33578647]


portfolio before change:  [10.47514175]
curr_Stock_Price:  101.7170629083931
curr_Factors:  [101.71706291]
mat_Sqrt:  [[0.15]]
grads:  [0.04602178]
Stock Position:  0.04602177730675657
Bond Position:  [5.79394173]


portfolio before change:  [10.50358696]
curr_Stock_Price:  102.31940650722427
curr_Factors:  [102.31940651]
mat_Sqrt:  [[0.15]]
grads:  [0.09480237]
Stock Position:  0.0948023733630166
Bond Position:  [0.80346438]


portfolio before change:  [10.48336118]
curr_Stock_Price:  102.10500032630797
curr_Factors:  [102.10500033]
mat_Sqrt:  [[0.15]]
grads:  [0.11350733]
Stock Position:  0.11350732723437727
Bond Position:  [-1.1063045]


portfolio before change:  [10.43724961]
curr_Stock_Price:  101.69997555850686
curr_Factors:  [101.69997556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971578]
Stock Position:  -0.019715777018016634
Bond Position:  [12.44234365]


portfolio before change:  [10.44857928]
curr_Stock_Price:  101.20421620630806
curr_Factors:  [101.20421621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03365573]
Stock Position:  -0.03365572891905094
Bond Position:  [13.85468095]


portfolio before change:  [10.40884519]
curr_Stock_Price:  102.43628092187238
curr_Factors:  [102.43628092]
mat_Sqrt:  [[0.15]]
grads:  [0.02665226]
Stock Position:  0.02665225971483604
Bond Position:  [7.67868682]


portfolio before change:  [10.40449282]
curr_Stock_Price:  102.23696326325475
curr_Factors:  [102.23696326]
mat_Sqrt:  [[0.15]]
grads:  [-0.08254428]
Stock Position:  -0.08254428016207258
Bond Position:  [18.84356935]


portfolio before change:  [10.34293911]
curr_Stock_Price:  103.01120593991813
curr_Factors:  [103.01120594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050493]
Stock Position:  -0.0005049261607134188
Bond Position:  [10.39495216]


portfolio before change:  [10.344285]
curr_Stock_Price:  102.91922566453685
curr_Factors:  [102.91922566]
mat_Sqrt:  [[0.15]]
grads:  [0.02379621]
Stock Position:  0.023796214337409017
Bond Position:  [7.89519705]


portfolio before change:  [10.35782524]
curr_Stock_Price:  103.44675818037784
curr_Factors:  [103.44675818]
mat_Sqrt:  [[0.15]]
grads:  [0.01552581]
Stock Position:  0.015525810594564487
Bond Position:  [8.75173046]


portfolio before change:  [10.35850447]
curr_Stock_Price:  103.42004146403539
curr_Factors:  [103.42004146]
mat_Sqrt:  [[0.15]]
grads:  [0.00904312]
Stock Position:  0.009043120248341113
Bond Position:  [9.4232646]


portfolio before change:  [10.35870117]
curr_Stock_Price:  103.31152974999976
curr_Factors:  [103.31152975]
mat_Sqrt:  [[0.15]]
grads:  [0.02946838]
Stock Position:  0.029468379352732988
Bond Position:  [7.31427782]


portfolio before change:  [10.34708417]
curr_Stock_Price:  102.88628258053744
curr_Factors:  [102.88628258]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002633]
Stock Position:  -0.04002632841184301
Bond Position:  [14.4652443]


portfolio before change:  [10.33874752]
curr_Stock_Price:  103.13973861586474
curr_Factors:  [103.13973862]
mat_Sqrt:  [[0.15]]
grads:  [-0.12211731]
Stock Position:  -0.12211730712547386
Bond Position:  [22.93389466]


portfolio before change:  [10.37252433]
curr_Stock_Price:  102.88662224531794
curr_Factors:  [102.88662225]
mat_Sqrt:  [[0.15]]
grads:  [0.06214192]
Stock Position:  0.06214191606529992
Bond Position:  [3.97895248]


portfolio before change:  [10.35362353]
curr_Stock_Price:  102.57446266655137
curr_Factors:  [102.57446267]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815691]
Stock Position:  -0.0181569128200385
Bond Position:  [12.21605911]


portfolio before change:  [10.3785488]
curr_Stock_Price:  101.2857984361159
curr_Factors:  [101.28579844]
mat_Sqrt:  [[0.15]]
grads:  [-0.12081354]
Stock Position:  -0.12081353659897286
Bond Position:  [22.61524432]


portfolio before change:  [10.34355694]
curr_Stock_Price:  101.598834051723
curr_Factors:  [101.59883405]
mat_Sqrt:  [[0.15]]
grads:  [-0.13746798]
Stock Position:  -0.13746797585077017
Bond Position:  [24.31014301]


portfolio before change:  [10.43104265]
curr_Stock_Price:  100.98453277188868
curr_Factors:  [100.98453277]
mat_Sqrt:  [[0.15]]
grads:  [0.18139862]
Stock Position:  0.18139861903550406
Bond Position:  [-7.88741214]


portfolio before change:  [10.46005006]
curr_Stock_Price:  101.14987801039115
curr_Factors:  [101.14987801]
mat_Sqrt:  [[0.15]]
grads:  [0.03158756]
Stock Position:  0.03158756297280731
Bond Position:  [7.26497192]


portfolio before change:  [10.46197569]
curr_Stock_Price:  101.18208855537567
curr_Factors:  [101.18208856]
mat_Sqrt:  [[0.15]]
grads:  [0.08499383]
Stock Position:  0.08499383081949591
Bond Position:  [1.86212238]


portfolio before change:  [10.43661365]
curr_Stock_Price:  100.88095118241742
curr_Factors:  [100.88095118]
mat_Sqrt:  [[0.15]]
grads:  [0.05134218]
Stock Position:  0.05134218209871662
Bond Position:  [5.25716549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.49324132]
Stock Price:  101.97109729930914
PL:  [8.52214402]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.01979671e-02]
 [ 4.37143764e-02]
 [ 2.30821313e-04]
 [-2.62240597e-03]
 [-3.14641344e-03]
 [ 2.85113575e-02]
 [ 3.73270640e-03]
 [ 1.03205024e-02]
 [-2.77100466e-02]
 [ 2.34334803e-02]
 [ 1.91444185e-02]
 [-1.42816713e-02]
 [ 6.48993198e-03]
 [ 1.32740867e-02]
 [-1.76981514e-02]
 [ 6.67303330e-05]
 [-6.10383522e-03]
 [ 4.12141862e-04]
 [ 1.96934834e-03]
 [-2.39454471e-02]
 [-5.61322171e-03]
 [-1.68093569e-02]
 [ 6.07189023e-03]
 [-1.05931938e-02]
 [ 1.14438217e-02]
 [-7.75440926e-04]
 [ 2.83756632e-02]
 [-4.83448906e-03]
 [-5.07471481e-02]
 [-8.73857015e-03]
 [ 4.63818061e-02]
 [ 1.52067174e-03]
 [-1.63894656e-02]
 [-4.39142994e-02]
 [-2.28197115e-02]
 [ 3.73993954e-02]
 [-6.95586648e-03]
 [-6.33372900e-03]
 [ 2.94323658e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.62057755]
curr_Stock_Price:  100.17007089534297
curr_Factors:  [100.1700709]
mat_Sqrt:  [[0.15]]
grads:  [0.13465311]
Stock Position:  0.13465311428790852
Bond Position:  [-7.86763446]


portfolio before change:  [5.66654663]
curr_Stock_Price:  100.51876393454356
curr_Factors:  [100.51876393]
mat_Sqrt:  [[0.15]]
grads:  [0.29142918]
Stock Position:  0.29142917584507794
Bond Position:  [-23.6275539]


portfolio before change:  [5.9307244]
curr_Stock_Price:  101.43538935784882
curr_Factors:  [101.43538936]
mat_Sqrt:  [[0.15]]
grads:  [0.00153881]
Stock Position:  0.0015388087504399767
Bond Position:  [5.77463473]


portfolio before change:  [5.93122957]
curr_Stock_Price:  101.29456818848217
curr_Factors:  [101.29456819]
mat_Sqrt:  [[0.15]]
grads:  [-0.01748271]
Stock Position:  -0.017482706447203736
Bond Position:  [7.70213277]


portfolio before change:  [5.93490339]
curr_Stock_Price:  101.1395013708954
curr_Factors:  [101.13950137]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097609]
Stock Position:  -0.020976089572557623
Bond Position:  [8.05641463]


portfolio before change:  [5.9624168]
curr_Stock_Price:  99.87585816565365
curr_Factors:  [99.87585817]
mat_Sqrt:  [[0.15]]
grads:  [0.19007572]
Stock Position:  0.1900757169719893
Bond Position:  [-13.02155855]


portfolio before change:  [6.1744135]
curr_Stock_Price:  100.99974976466234
curr_Factors:  [100.99974976]
mat_Sqrt:  [[0.15]]
grads:  [0.02488471]
Stock Position:  0.02488470934668997
Bond Position:  [3.66106408]


portfolio before change:  [6.18714701]
curr_Stock_Price:  101.49305852275724
curr_Factors:  [101.49305852]
mat_Sqrt:  [[0.15]]
grads:  [0.06880335]
Stock Position:  0.06880334935430124
Bond Position:  [-0.79591535]


portfolio before change:  [6.06045685]
curr_Stock_Price:  99.65316748480797
curr_Factors:  [99.65316748]
mat_Sqrt:  [[0.15]]
grads:  [-0.18473364]
Stock Position:  -0.18473364432665462
Bond Position:  [24.46974964]


portfolio before change:  [6.18193867]
curr_Stock_Price:  99.01212068128571
curr_Factors:  [99.01212068]
mat_Sqrt:  [[0.15]]
grads:  [0.1562232]
Stock Position:  0.15622320214914578
Bond Position:  [-9.28605188]


portfolio before change:  [6.34846977]
curr_Stock_Price:  100.08553312061687
curr_Factors:  [100.08553312]
mat_Sqrt:  [[0.15]]
grads:  [0.12762946]
Stock Position:  0.1276294567593433
Bond Position:  [-6.42539245]


portfolio before change:  [6.21330338]
curr_Stock_Price:  99.03277330044087
curr_Factors:  [99.0327733]
mat_Sqrt:  [[0.15]]
grads:  [-0.09521114]
Stock Position:  -0.0952111422140445
Bond Position:  [15.64232684]


portfolio before change:  [6.24532804]
curr_Stock_Price:  98.71695683946784
curr_Factors:  [98.71695684]
mat_Sqrt:  [[0.15]]
grads:  [0.04326621]
Stock Position:  0.043266213183967624
Bond Position:  [1.97421914]


portfolio before change:  [6.18428925]
curr_Stock_Price:  97.30048012075156
curr_Factors:  [97.30048012]
mat_Sqrt:  [[0.15]]
grads:  [0.08849391]
Stock Position:  0.08849391152717252
Bond Position:  [-2.42621083]


portfolio before change:  [6.17816125]
curr_Stock_Price:  97.23465972472113
curr_Factors:  [97.23465972]
mat_Sqrt:  [[0.15]]
grads:  [-0.11798768]
Stock Position:  -0.11798767612487311
Bond Position:  [17.65065279]


portfolio before change:  [6.2347871]
curr_Stock_Price:  96.77343034928388
curr_Factors:  [96.77343035]
mat_Sqrt:  [[0.15]]
grads:  [0.00044487]
Stock Position:  0.0004448688868536009
Bond Position:  [6.19173561]


portfolio before change:  [6.23573969]
curr_Stock_Price:  97.17483543333047
curr_Factors:  [97.17483543]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069223]
Stock Position:  -0.0406922348327475
Bond Position:  [10.19000091]


portfolio before change:  [6.23891077]
curr_Stock_Price:  97.12821110039141
curr_Factors:  [97.1282111]
mat_Sqrt:  [[0.15]]
grads:  [0.00274761]
Stock Position:  0.002747612415545693
Bond Position:  [5.97204009]


portfolio before change:  [6.24045018]
curr_Stock_Price:  97.41677524322245
curr_Factors:  [97.41677524]
mat_Sqrt:  [[0.15]]
grads:  [0.01312899]
Stock Position:  0.013128988960446423
Bond Position:  [4.96146641]


portfolio before change:  [6.24182563]
curr_Stock_Price:  97.4742992040474
curr_Factors:  [97.4742992]
mat_Sqrt:  [[0.15]]
grads:  [-0.15963631]
Stock Position:  -0.15963631430419548
Bond Position:  [21.8022635]


portfolio before change:  [6.22251127]
curr_Stock_Price:  97.61236188258059
curr_Factors:  [97.61236188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03742148]
Stock Position:  -0.03742147804606289
Bond Position:  [9.87531013]


portfolio before change:  [6.22888723]
curr_Stock_Price:  97.47496830343607
curr_Factors:  [97.4749683]
mat_Sqrt:  [[0.15]]
grads:  [-0.11206238]
Stock Position:  -0.11206237927700347
Bond Position:  [17.1521641]


portfolio before change:  [6.27343549]
curr_Stock_Price:  97.09657098722236
curr_Factors:  [97.09657099]
mat_Sqrt:  [[0.15]]
grads:  [0.04047927]
Stock Position:  0.0404792681998391
Bond Position:  [2.34303735]


portfolio before change:  [6.22562156]
curr_Stock_Price:  95.90813967040577
curr_Factors:  [95.90813967]
mat_Sqrt:  [[0.15]]
grads:  [-0.07062129]
Stock Position:  -0.07062129189606954
Bond Position:  [12.99877828]


portfolio before change:  [6.25068]
curr_Stock_Price:  95.57632060167215
curr_Factors:  [95.5763206]
mat_Sqrt:  [[0.15]]
grads:  [0.07629214]
Stock Position:  0.07629214434576977
Bond Position:  [-1.04104245]


portfolio before change:  [6.2009126]
curr_Stock_Price:  94.92569975892121
curr_Factors:  [94.92569976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00516961]
Stock Position:  -0.005169606174731146
Bond Position:  [6.69164108]


portfolio before change:  [6.20301226]
curr_Stock_Price:  94.68135810216502
curr_Factors:  [94.6813581]
mat_Sqrt:  [[0.15]]
grads:  [0.18917109]
Stock Position:  0.18917108797033036
Bond Position:  [-11.70796326]


portfolio before change:  [6.21623668]
curr_Stock_Price:  94.75900212589242
curr_Factors:  [94.75900213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03222993]
Stock Position:  -0.032229927037550364
Bond Position:  [9.2703124]


portfolio before change:  [6.25868984]
curr_Stock_Price:  93.47776109595307
curr_Factors:  [93.4777611]
mat_Sqrt:  [[0.15]]
grads:  [-0.33831432]
Stock Position:  -0.3383143209869672
Bond Position:  [37.88355511]


portfolio before change:  [6.02108735]
curr_Stock_Price:  94.19407199725009
curr_Factors:  [94.194072]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825713]
Stock Position:  -0.05825713433604934
Bond Position:  [11.50856405]


portfolio before change:  [5.988089]
curr_Stock_Price:  94.78519287119263
curr_Factors:  [94.78519287]
mat_Sqrt:  [[0.15]]
grads:  [0.30921204]
Stock Position:  0.30921204076429015
Bond Position:  [-23.32063392]


portfolio before change:  [6.18728262]
curr_Stock_Price:  95.43881840829381
curr_Factors:  [95.43881841]
mat_Sqrt:  [[0.15]]
grads:  [0.01013781]
Stock Position:  0.010137811624123031
Bond Position:  [5.21974186]


portfolio before change:  [6.19572561]
curr_Stock_Price:  96.20727632776962
curr_Factors:  [96.20727633]
mat_Sqrt:  [[0.15]]
grads:  [-0.1092631]
Stock Position:  -0.10926310419993653
Bond Position:  [16.70763127]


portfolio before change:  [6.16589282]
curr_Stock_Price:  96.49942777788311
curr_Factors:  [96.49942778]
mat_Sqrt:  [[0.15]]
grads:  [-0.292762]
Stock Position:  -0.2927619961129205
Bond Position:  [34.41725792]


portfolio before change:  [6.05386143]
curr_Stock_Price:  96.89679432097832
curr_Factors:  [96.89679432]
mat_Sqrt:  [[0.15]]
grads:  [-0.15213141]
Stock Position:  -0.15213140986937082
Bond Position:  [20.79490736]


portfolio before change:  [6.22320193]
curr_Stock_Price:  95.80076174482696
curr_Factors:  [95.80076174]
mat_Sqrt:  [[0.15]]
grads:  [0.2493293]
Stock Position:  0.24932930264831085
Bond Position:  [-17.66273519]


portfolio before change:  [5.8775039]
curr_Stock_Price:  94.42310555048805
curr_Factors:  [94.42310555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04637244]
Stock Position:  -0.04637244318690712
Bond Position:  [10.25613399]


portfolio before change:  [5.89646788]
curr_Stock_Price:  94.0418039037054
curr_Factors:  [94.0418039]
mat_Sqrt:  [[0.15]]
grads:  [-0.04222486]
Stock Position:  -0.042224859999934444
Bond Position:  [9.86736989]


portfolio before change:  [5.89118685]
curr_Stock_Price:  94.19608585865072
curr_Factors:  [94.19608586]
mat_Sqrt:  [[0.15]]
grads:  [0.19621577]
Stock Position:  0.19621577172751825
Bond Position:  [-12.59157083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.86636687]
Stock Price:  94.0776145945932
PL:  [5.86636687]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 1.25165335e-02]
 [ 3.97207525e-02]
 [-1.19658237e-02]
 [-6.95361145e-03]
 [-7.66173729e-03]
 [ 3.22808252e-02]
 [ 3.74916886e-03]
 [ 5.38155088e-03]
 [-2.74681956e-02]
 [ 2.29597986e-02]
 [ 1.65369199e-02]
 [-1.15209573e-03]
 [ 1.99635608e-03]
 [ 2.33343773e-02]
 [-7.96558266e-03]
 [-4.97124355e-03]
 [-3.89399048e-03]
 [ 7.05999916e-03]
 [ 3.13688065e-02]
 [-2.07901276e-02]
 [-1.27776667e-03]
 [-2.05657833e-02]
 [ 9.26312543e-03]
 [-3.33217059e-03]
 [-1.35418421e-02]
 [ 4.89704664e-03]
 [ 6.68265186e-03]
 [ 3.68838068e-03]
 [ 5.45975940e-03]
 [ 1.50936169e-02]
 [-1.70270416e-02]
 [ 2.51407234e-03]
 [ 1.63577712e-02]
 [ 9.53708811e-02]
 [-1.99281180e-02]
 [-2.05951297e-02]
 [ 2.24811760e-02]
 [ 1.29417625e-02]
 [ 8.06039739e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.8710188]
curr_Stock_Price:  99.82885826276906
curr_Factors:  [99.82885826]
mat_Sqrt:  [[0.15]]
grads:  [0.08344356]
Stock Position:  0.08344355651297697
Bond Position:  [-10.20109378]


portfolio before change:  [-1.86624224]
curr_Stock_Price:  99.90138367974033
curr_Factors:  [99.90138368]
mat_Sqrt:  [[0.15]]
grads:  [0.26480502]
Stock Position:  0.2648050163680469
Bond Position:  [-28.32062978]


portfolio before change:  [-2.04784595]
curr_Stock_Price:  99.22895149717951
curr_Factors:  [99.2289515]
mat_Sqrt:  [[0.15]]
grads:  [-0.07977216]
Stock Position:  -0.07977215781518646
Bond Position:  [5.86786163]


portfolio before change:  [-2.08331913]
curr_Stock_Price:  99.68282792986199
curr_Factors:  [99.68282793]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635741]
Stock Position:  -0.04635740969075057
Bond Position:  [2.53771857]


portfolio before change:  [-2.11140269]
curr_Stock_Price:  100.2954764670464
curr_Factors:  [100.29547647]
mat_Sqrt:  [[0.15]]
grads:  [-0.05107825]
Stock Position:  -0.051078248621660924
Bond Position:  [3.01151459]


portfolio before change:  [-2.14410773]
curr_Stock_Price:  100.94313970706
curr_Factors:  [100.94313971]
mat_Sqrt:  [[0.15]]
grads:  [0.2152055]
Stock Position:  0.21520550136296945
Bond Position:  [-23.86762672]


portfolio before change:  [-2.16386154]
curr_Stock_Price:  100.86521340925206
curr_Factors:  [100.86521341]
mat_Sqrt:  [[0.15]]
grads:  [0.02499446]
Stock Position:  0.024994459037991967
Bond Position:  [-4.68493298]


portfolio before change:  [-2.16716382]
curr_Stock_Price:  100.7565243621369
curr_Factors:  [100.75652436]
mat_Sqrt:  [[0.15]]
grads:  [0.03587701]
Stock Position:  0.03587700584088559
Bond Position:  [-5.78200623]


portfolio before change:  [-2.20079404]
curr_Stock_Price:  99.83929539237941
curr_Factors:  [99.83929539]
mat_Sqrt:  [[0.15]]
grads:  [-0.1831213]
Stock Position:  -0.18312130422421524
Bond Position:  [16.08190794]


portfolio before change:  [-2.56477679]
curr_Stock_Price:  101.83793293659264
curr_Factors:  [101.83793294]
mat_Sqrt:  [[0.15]]
grads:  [0.15306532]
Stock Position:  0.15306532423494004
Bond Position:  [-18.15263302]


portfolio before change:  [-2.32272501]
curr_Stock_Price:  103.43412070998325
curr_Factors:  [103.43412071]
mat_Sqrt:  [[0.15]]
grads:  [0.11024613]
Stock Position:  0.11024613254263889
Bond Position:  [-13.72593679]


portfolio before change:  [-2.34021552]
curr_Stock_Price:  103.29103488789282
curr_Factors:  [103.29103489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00768064]
Stock Position:  -0.007680638227288388
Bond Position:  [-1.54687445]


portfolio before change:  [-2.34060381]
curr_Stock_Price:  103.3164120920776
curr_Factors:  [103.31641209]
mat_Sqrt:  [[0.15]]
grads:  [0.01330904]
Stock Position:  0.013309040552894256
Bond Position:  [-3.71564612]


portfolio before change:  [-2.33042719]
curr_Stock_Price:  104.11595101627353
curr_Factors:  [104.11595102]
mat_Sqrt:  [[0.15]]
grads:  [0.15556252]
Stock Position:  0.1555625156635914
Bond Position:  [-18.52696646]


portfolio before change:  [-2.11011327]
curr_Stock_Price:  105.54707943219098
curr_Factors:  [105.54707943]
mat_Sqrt:  [[0.15]]
grads:  [-0.05310388]
Stock Position:  -0.053103884371551634
Bond Position:  [3.49484663]


portfolio before change:  [-2.1129431]
curr_Stock_Price:  105.60859491998008
curr_Factors:  [105.60859492]
mat_Sqrt:  [[0.15]]
grads:  [-0.03314162]
Stock Position:  -0.033141623634269604
Bond Position:  [1.3870972]


portfolio before change:  [-2.12524527]
curr_Stock_Price:  105.98502697993376
curr_Factors:  [105.98502698]
mat_Sqrt:  [[0.15]]
grads:  [-0.02595994]
Stock Position:  -0.025959936513755888
Bond Position:  [0.6261193]


portfolio before change:  [-2.13320078]
curr_Stock_Price:  106.29449530257523
curr_Factors:  [106.2944953]
mat_Sqrt:  [[0.15]]
grads:  [0.04706666]
Stock Position:  0.04706666109489033
Bond Position:  [-7.13612777]


portfolio before change:  [-2.12583359]
curr_Stock_Price:  106.46997536551744
curr_Factors:  [106.46997537]
mat_Sqrt:  [[0.15]]
grads:  [0.20912538]
Stock Position:  0.2091253769720916
Bond Position:  [-24.39140733]


portfolio before change:  [-1.999126]
curr_Stock_Price:  107.0904486698557
curr_Factors:  [107.09044867]
mat_Sqrt:  [[0.15]]
grads:  [-0.13860085]
Stock Position:  -0.13860085074120979
Bond Position:  [12.8437013]


portfolio before change:  [-1.9383971]
curr_Stock_Price:  106.66387598915668
curr_Factors:  [106.66387599]
mat_Sqrt:  [[0.15]]
grads:  [-0.00851844]
Stock Position:  -0.008518444453523335
Bond Position:  [-1.02978679]


portfolio before change:  [-1.93298058]
curr_Stock_Price:  106.01290684130873
curr_Factors:  [106.01290684]
mat_Sqrt:  [[0.15]]
grads:  [-0.13710522]
Stock Position:  -0.13710522167126749
Bond Position:  [12.60194251]


portfolio before change:  [-2.09194071]
curr_Stock_Price:  107.18379930581028
curr_Factors:  [107.18379931]
mat_Sqrt:  [[0.15]]
grads:  [0.06175417]
Stock Position:  0.06175416954575001
Bond Position:  [-8.71098723]


portfolio before change:  [-2.05351434]
curr_Stock_Price:  107.82368025799754
curr_Factors:  [107.82368026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02221447]
Stock Position:  -0.022214470578633874
Bond Position:  [0.34173164]


portfolio before change:  [-2.04430302]
curr_Stock_Price:  107.41094921536244
curr_Factors:  [107.41094922]
mat_Sqrt:  [[0.15]]
grads:  [-0.09027895]
Stock Position:  -0.09027894723513362
Bond Position:  [7.6526444]


portfolio before change:  [-2.04944233]
curr_Stock_Price:  107.47847270976371
curr_Factors:  [107.47847271]
mat_Sqrt:  [[0.15]]
grads:  [0.03264698]
Stock Position:  0.032646977617460174
Bond Position:  [-5.55828962]


portfolio before change:  [-2.05968236]
curr_Stock_Price:  107.18609634326629
curr_Factors:  [107.18609634]
mat_Sqrt:  [[0.15]]
grads:  [0.04455101]
Stock Position:  0.044551012393612484
Bond Position:  [-6.83493147]


portfolio before change:  [-2.06985797]
curr_Stock_Price:  106.97687125258969
curr_Factors:  [106.97687125]
mat_Sqrt:  [[0.15]]
grads:  [0.0245892]
Stock Position:  0.024589204533671215
Bond Position:  [-4.70033414]


portfolio before change:  [-2.08484971]
curr_Stock_Price:  106.39107894626669
curr_Factors:  [106.39107895]
mat_Sqrt:  [[0.15]]
grads:  [0.0363984]
Stock Position:  0.03639839596913427
Bond Position:  [-5.95731433]


portfolio before change:  [-2.0095713]
curr_Stock_Price:  108.47971827642374
curr_Factors:  [108.47971828]
mat_Sqrt:  [[0.15]]
grads:  [0.10062411]
Stock Position:  0.10062411249153745
Bond Position:  [-12.92524668]


portfolio before change:  [-2.00547925]
curr_Stock_Price:  108.53644236271646
curr_Factors:  [108.53644236]
mat_Sqrt:  [[0.15]]
grads:  [-0.11351361]
Stock Position:  -0.11351361088710016
Bond Position:  [10.31488424]


portfolio before change:  [-2.07869821]
curr_Stock_Price:  109.19282534332112
curr_Factors:  [109.19282534]
mat_Sqrt:  [[0.15]]
grads:  [0.01676048]
Stock Position:  0.01676048227594343
Bond Position:  [-3.90882263]


portfolio before change:  [-2.07546598]
curr_Stock_Price:  109.41482781860879
curr_Factors:  [109.41482782]
mat_Sqrt:  [[0.15]]
grads:  [0.10905181]
Stock Position:  0.10905180786435427
Bond Position:  [-14.00735076]


portfolio before change:  [-2.06320186]
curr_Stock_Price:  109.54334602802666
curr_Factors:  [109.54334603]
mat_Sqrt:  [[0.15]]
grads:  [0.63580587]
Stock Position:  0.6358058738923965
Bond Position:  [-71.71150471]


portfolio before change:  [-2.48894281]
curr_Stock_Price:  108.88783705945325
curr_Factors:  [108.88783706]
mat_Sqrt:  [[0.15]]
grads:  [-0.13285412]
Stock Position:  -0.13285412010210196
Bond Position:  [11.97725497]


portfolio before change:  [-2.27476709]
curr_Stock_Price:  107.28699494558838
curr_Factors:  [107.28699495]
mat_Sqrt:  [[0.15]]
grads:  [-0.13730086]
Stock Position:  -0.1373008644649712
Bond Position:  [12.45583006]


portfolio before change:  [-2.28746834]
curr_Stock_Price:  107.39084222594352
curr_Factors:  [107.39084223]
mat_Sqrt:  [[0.15]]
grads:  [0.14987451]
Stock Position:  0.14987450657361448
Bond Position:  [-18.38261783]


portfolio before change:  [-2.21490324]
curr_Stock_Price:  107.89034722059701
curr_Factors:  [107.89034722]
mat_Sqrt:  [[0.15]]
grads:  [0.08627842]
Stock Position:  0.08627841651490843
Bond Position:  [-11.52351156]


portfolio before change:  [-2.14547472]
curr_Stock_Price:  108.71174676965441
curr_Factors:  [108.71174677]
mat_Sqrt:  [[0.15]]
grads:  [0.05373598]
Stock Position:  0.05373598263296619
Bond Position:  [-7.98720726]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.19930866]
Stock Price:  107.72850471311001
PL:  [-9.92781337]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 2.31523219e-02]
 [ 4.36770102e-02]
 [-3.34710654e-03]
 [-6.87875616e-03]
 [-3.64382046e-03]
 [ 2.89332935e-02]
 [ 3.42466109e-03]
 [ 4.22419805e-02]
 [ 6.43758965e-02]
 [ 2.27458629e-02]
 [ 1.53659745e-02]
 [ 6.06939225e-03]
 [-1.89512557e-03]
 [ 2.33248782e-02]
 [-1.01203748e-02]
 [-3.34870286e-03]
 [-5.78364884e-03]
 [ 7.29519192e-03]
 [ 1.40747972e-02]
 [ 1.61465133e-02]
 [-1.03797309e-03]
 [-4.15509666e-03]
 [ 3.98555666e-03]
 [-1.14735479e-02]
 [-8.90425778e-04]
 [ 4.54389124e-03]
 [ 6.85435453e-03]
 [ 1.76255837e-03]
 [ 5.40744630e-03]
 [-2.99463344e-03]
 [-1.71353596e-02]
 [ 7.19931543e-03]
 [ 8.29227215e-04]
 [ 1.93884629e-02]
 [-2.01013457e-02]
 [-1.05186696e-02]
 [ 1.79105067e-02]
 [ 1.22282693e-02]
 [ 8.07146055e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.20465257]
curr_Stock_Price:  100.01448900061176
curr_Factors:  [100.014489]
mat_Sqrt:  [[0.15]]
grads:  [0.15434881]
Stock Position:  0.15434881263198907
Bond Position:  [-13.23246505]


portfolio before change:  [2.23154464]
curr_Stock_Price:  100.19943522158394
curr_Factors:  [100.19943522]
mat_Sqrt:  [[0.15]]
grads:  [0.29118007]
Stock Position:  0.29118006786725276
Bond Position:  [-26.94453371]


portfolio before change:  [2.19589768]
curr_Stock_Price:  100.0885805155367
curr_Factors:  [100.08858052]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231404]
Stock Position:  -0.022314043603911423
Bond Position:  [4.42927863]


portfolio before change:  [2.20856464]
curr_Stock_Price:  99.54572648446705
curr_Factors:  [99.54572648]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585837]
Stock Position:  -0.0458583744054197
Bond Position:  [6.77356984]


portfolio before change:  [2.14280704]
curr_Stock_Price:  100.99811890567216
curr_Factors:  [100.99811891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02429214]
Stock Position:  -0.024292136414830037
Bond Position:  [4.59626712]


portfolio before change:  [2.13192133]
curr_Stock_Price:  101.469887954547
curr_Factors:  [101.46988795]
mat_Sqrt:  [[0.15]]
grads:  [0.19288862]
Stock Position:  0.19288862340518628
Bond Position:  [-17.44046568]


portfolio before change:  [2.52197468]
curr_Stock_Price:  103.50335958367559
curr_Factors:  [103.50335958]
mat_Sqrt:  [[0.15]]
grads:  [0.02283107]
Stock Position:  0.02283107395168267
Bond Position:  [0.15888182]


portfolio before change:  [2.55104328]
curr_Stock_Price:  104.77569325348202
curr_Factors:  [104.77569325]
mat_Sqrt:  [[0.15]]
grads:  [0.2816132]
Stock Position:  0.28161320335609413
Bond Position:  [-26.95517533]


portfolio before change:  [2.36623437]
curr_Stock_Price:  104.13140774997414
curr_Factors:  [104.13140775]
mat_Sqrt:  [[0.15]]
grads:  [0.42917264]
Stock Position:  0.429172643205449
Bond Position:  [-42.32411714]


portfolio before change:  [1.88120534]
curr_Stock_Price:  103.01358677096093
curr_Factors:  [103.01358677]
mat_Sqrt:  [[0.15]]
grads:  [0.15163909]
Stock Position:  0.15163908599901654
Bond Position:  [-13.7396808]


portfolio before change:  [2.07120496]
curr_Stock_Price:  104.27788607035936
curr_Factors:  [104.27788607]
mat_Sqrt:  [[0.15]]
grads:  [0.10243983]
Stock Position:  0.10243983020335577
Bond Position:  [-8.61100398]


portfolio before change:  [2.09521844]
curr_Stock_Price:  104.52280958761877
curr_Factors:  [104.52280959]
mat_Sqrt:  [[0.15]]
grads:  [0.04046262]
Stock Position:  0.04046261501965778
Bond Position:  [-2.13404776]


portfolio before change:  [2.09954393]
curr_Stock_Price:  104.6363033495024
curr_Factors:  [104.63630335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01263417]
Stock Position:  -0.012634170497314273
Bond Position:  [3.42153682]


portfolio before change:  [2.10341681]
curr_Stock_Price:  104.36361736187169
curr_Factors:  [104.36361736]
mat_Sqrt:  [[0.15]]
grads:  [0.15549919]
Stock Position:  0.15549918780624752
Bond Position:  [-14.12504093]


portfolio before change:  [2.00601234]
curr_Stock_Price:  103.74857409957062
curr_Factors:  [103.7485741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06746917]
Stock Position:  -0.06746916527812497
Bond Position:  [9.00584203]


portfolio before change:  [2.02416426]
curr_Stock_Price:  103.4962199627628
curr_Factors:  [103.49621996]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232469]
Stock Position:  -0.02232468576185212
Bond Position:  [4.33468485]


portfolio before change:  [2.06688648]
curr_Stock_Price:  101.60681604732825
curr_Factors:  [101.60681605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03855766]
Stock Position:  -0.0385576589600068
Bond Position:  [5.98460744]


portfolio before change:  [2.03073799]
curr_Stock_Price:  102.56373639800279
curr_Factors:  [102.5637364]
mat_Sqrt:  [[0.15]]
grads:  [0.04863461]
Stock Position:  0.048634612820762084
Bond Position:  [-2.95740962]


portfolio before change:  [2.01677197]
curr_Stock_Price:  102.28417581399624
curr_Factors:  [102.28417581]
mat_Sqrt:  [[0.15]]
grads:  [0.09383198]
Stock Position:  0.09383198139830787
Bond Position:  [-7.58075491]


portfolio before change:  [1.98249136]
curr_Stock_Price:  101.92893486190513
curr_Factors:  [101.92893486]
mat_Sqrt:  [[0.15]]
grads:  [0.10764342]
Stock Position:  0.10764342177241107
Bond Position:  [-8.98948797]


portfolio before change:  [2.05240519]
curr_Stock_Price:  102.58886917952995
curr_Factors:  [102.58886918]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691982]
Stock Position:  -0.006919820567092948
Bond Position:  [2.76230176]


portfolio before change:  [2.04675398]
curr_Stock_Price:  103.45544090608098
curr_Factors:  [103.45544091]
mat_Sqrt:  [[0.15]]
grads:  [-0.02770064]
Stock Position:  -0.027700644428664527
Bond Position:  [4.91253636]


portfolio before change:  [2.07477038]
curr_Stock_Price:  102.46621121092153
curr_Factors:  [102.46621121]
mat_Sqrt:  [[0.15]]
grads:  [0.02657038]
Stock Position:  0.026570377710441514
Bond Position:  [-0.64779555]


portfolio before change:  [2.09537384]
curr_Stock_Price:  103.24468853592049
curr_Factors:  [103.24468854]
mat_Sqrt:  [[0.15]]
grads:  [-0.07649032]
Stock Position:  -0.07649031912057418
Bond Position:  [9.99259301]


portfolio before change:  [2.08681279]
curr_Stock_Price:  103.37294269179772
curr_Factors:  [103.37294269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00593617]
Stock Position:  -0.005936171854521242
Bond Position:  [2.70045234]


portfolio before change:  [2.08277965]
curr_Stock_Price:  104.10922813286321
curr_Factors:  [104.10922813]
mat_Sqrt:  [[0.15]]
grads:  [0.03029261]
Stock Position:  0.030292608277306225
Bond Position:  [-1.07096041]


portfolio before change:  [2.09943122]
curr_Stock_Price:  104.66333854220964
curr_Factors:  [104.66333854]
mat_Sqrt:  [[0.15]]
grads:  [0.0456957]
Stock Position:  0.045695696890296934
Bond Position:  [-2.68323297]


portfolio before change:  [2.07357805]
curr_Stock_Price:  104.10491076759926
curr_Factors:  [104.10491077]
mat_Sqrt:  [[0.15]]
grads:  [0.01175039]
Stock Position:  0.01175038913138774
Bond Position:  [0.85030484]


portfolio before change:  [2.08851629]
curr_Stock_Price:  105.36716202588046
curr_Factors:  [105.36716203]
mat_Sqrt:  [[0.15]]
grads:  [0.03604964]
Stock Position:  0.03604964197205254
Bond Position:  [-1.70993218]


portfolio before change:  [2.07472706]
curr_Stock_Price:  104.99058477800685
curr_Factors:  [104.99058478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996422]
Stock Position:  -0.019964222902396307
Bond Position:  [4.1707825]


portfolio before change:  [2.09600808]
curr_Stock_Price:  103.9507424907623
curr_Factors:  [103.95074249]
mat_Sqrt:  [[0.15]]
grads:  [-0.11423573]
Stock Position:  -0.11423573054771592
Bond Position:  [13.97089709]


portfolio before change:  [2.13716121]
curr_Stock_Price:  103.60578341519944
curr_Factors:  [103.60578342]
mat_Sqrt:  [[0.15]]
grads:  [0.04799544]
Stock Position:  0.04799543620706808
Bond Position:  [-2.83544356]


portfolio before change:  [2.14849511]
curr_Stock_Price:  103.84931399069015
curr_Factors:  [103.84931399]
mat_Sqrt:  [[0.15]]
grads:  [0.00552818]
Stock Position:  0.005528181433605296
Bond Position:  [1.57439726]


portfolio before change:  [2.15484285]
curr_Stock_Price:  104.96196320515165
curr_Factors:  [104.96196321]
mat_Sqrt:  [[0.15]]
grads:  [0.12925642]
Stock Position:  0.12925641964533524
Bond Position:  [-11.41216471]


portfolio before change:  [2.28737653]
curr_Stock_Price:  105.99835497213918
curr_Factors:  [105.99835497]
mat_Sqrt:  [[0.15]]
grads:  [-0.13400897]
Stock Position:  -0.1340089711628432
Bond Position:  [16.49210702]


portfolio before change:  [2.31409751]
curr_Stock_Price:  105.81434236791777
curr_Factors:  [105.81434237]
mat_Sqrt:  [[0.15]]
grads:  [-0.07012446]
Stock Position:  -0.07012446419732889
Bond Position:  [9.73427157]


portfolio before change:  [2.26517556]
curr_Stock_Price:  106.52933977480212
curr_Factors:  [106.52933977]
mat_Sqrt:  [[0.15]]
grads:  [0.11940338]
Stock Position:  0.11940337829686817
Bond Position:  [-10.4547875]


portfolio before change:  [2.45258727]
curr_Stock_Price:  108.10985320836255
curr_Factors:  [108.10985321]
mat_Sqrt:  [[0.15]]
grads:  [0.0815218]
Stock Position:  0.0815217954913041
Bond Position:  [-6.36072207]


portfolio before change:  [2.49074627]
curr_Stock_Price:  108.58769032195192
curr_Factors:  [108.58769032]
mat_Sqrt:  [[0.15]]
grads:  [0.05380974]
Stock Position:  0.05380973696667719
Bond Position:  [-3.35232878]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.46481517]
Stock Price:  108.11357477630142
PL:  [-5.6487596]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-5.73839403e-02]
 [-9.56770484e-02]
 [ 1.10439262e-02]
 [ 2.56997943e-03]
 [-2.72919471e-03]
 [ 3.20312045e-02]
 [ 3.68809019e-03]
 [ 6.45070610e-04]
 [-2.13455021e-02]
 [ 2.34449182e-02]
 [ 2.14371959e-02]
 [-6.44486904e-03]
 [-1.78289527e-02]
 [ 1.15943748e-02]
 [-1.79181685e-02]
 [-2.72892518e-04]
 [-6.11294923e-03]
 [-5.43940426e-03]
 [ 1.11473974e-03]
 [-4.01461386e-03]
 [-1.46947227e-02]
 [-2.33258125e-02]
 [ 4.21492169e-03]
 [-1.26866848e-02]
 [ 9.93539038e-03]
 [-2.16765792e-03]
 [ 3.24700455e-02]
 [-4.37662595e-03]
 [-3.96789831e-02]
 [-8.55539582e-03]
 [ 4.49405759e-02]
 [ 5.45324292e-04]
 [-1.76527158e-02]
 [-3.50452210e-02]
 [-2.33319382e-02]
 [ 3.73258279e-02]
 [-1.02274263e-02]
 [-9.51606513e-03]
 [ 3.61086698e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.58232279]
curr_Stock_Price:  101.48916403438626
curr_Factors:  [101.48916403]
mat_Sqrt:  [[0.15]]
grads:  [-0.3825596]
Stock Position:  -0.38255960228995894
Bond Position:  [73.40797702]


portfolio before change:  [33.92014229]
curr_Stock_Price:  103.24407245862785
curr_Factors:  [103.24407246]
mat_Sqrt:  [[0.15]]
grads:  [-0.63784699]
Stock Position:  -0.6378469894332598
Bond Position:  [99.77406309]


portfolio before change:  [34.52223318]
curr_Stock_Price:  102.31968406586346
curr_Factors:  [102.31968407]
mat_Sqrt:  [[0.15]]
grads:  [0.07362617]
Stock Position:  0.07362617438689915
Bond Position:  [26.98882628]


portfolio before change:  [34.52644902]
curr_Stock_Price:  102.33112055570727
curr_Factors:  [102.33112056]
mat_Sqrt:  [[0.15]]
grads:  [0.0171332]
Stock Position:  0.017133196214881113
Bond Position:  [32.77318986]


portfolio before change:  [34.51409069]
curr_Stock_Price:  101.37069030506011
curr_Factors:  [101.37069031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01819463]
Stock Position:  -0.018194631398664167
Bond Position:  [36.35849303]


portfolio before change:  [34.53441326]
curr_Stock_Price:  100.50354036681819
curr_Factors:  [100.50354037]
mat_Sqrt:  [[0.15]]
grads:  [0.21354136]
Stock Position:  0.21354136362418397
Bond Position:  [13.0727502]


portfolio before change:  [34.48815937]
curr_Stock_Price:  100.27928365991903
curr_Factors:  [100.27928366]
mat_Sqrt:  [[0.15]]
grads:  [0.02458727]
Stock Position:  0.02458726794111485
Bond Position:  [32.02256575]


portfolio before change:  [34.48011695]
curr_Stock_Price:  99.78937583081222
curr_Factors:  [99.78937583]
mat_Sqrt:  [[0.15]]
grads:  [0.00430047]
Stock Position:  0.004300470730587107
Bond Position:  [34.05097566]


portfolio before change:  [34.47928819]
curr_Stock_Price:  98.60685478999316
curr_Factors:  [98.60685479]
mat_Sqrt:  [[0.15]]
grads:  [-0.14230335]
Stock Position:  -0.1423033472443507
Bond Position:  [48.51137369]


portfolio before change:  [34.67481494]
curr_Stock_Price:  97.27545633774523
curr_Factors:  [97.27545634]
mat_Sqrt:  [[0.15]]
grads:  [0.15629945]
Stock Position:  0.15629945447961932
Bond Position:  [19.47071418]


portfolio before change:  [34.65327964]
curr_Stock_Price:  97.1221014011232
curr_Factors:  [97.1221014]
mat_Sqrt:  [[0.15]]
grads:  [0.14291464]
Stock Position:  0.14291463922111883
Bond Position:  [20.77310956]


portfolio before change:  [34.61847248]
curr_Stock_Price:  96.86037902315591
curr_Factors:  [96.86037902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296579]
Stock Position:  -0.04296579361345842
Bond Position:  [38.78015554]


portfolio before change:  [34.63082825]
curr_Stock_Price:  96.68563675684749
curr_Factors:  [96.68563676]
mat_Sqrt:  [[0.15]]
grads:  [-0.11885968]
Stock Position:  -0.11885968461936366
Bond Position:  [46.12285254]


portfolio before change:  [34.53661371]
curr_Stock_Price:  97.52679878185805
curr_Factors:  [97.52679878]
mat_Sqrt:  [[0.15]]
grads:  [0.07729583]
Stock Position:  0.07729583181164366
Bond Position:  [26.99819868]


portfolio before change:  [34.50784783]
curr_Stock_Price:  97.1109824264482
curr_Factors:  [97.11098243]
mat_Sqrt:  [[0.15]]
grads:  [-0.11945446]
Stock Position:  -0.11945445685304024
Bond Position:  [46.10818749]


portfolio before change:  [34.61785253]
curr_Stock_Price:  96.23834172293567
curr_Factors:  [96.23834172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00181928]
Stock Position:  -0.0018192834557192428
Bond Position:  [34.79293735]


portfolio before change:  [34.62127429]
curr_Stock_Price:  96.74823142227098
curr_Factors:  [96.74823142]
mat_Sqrt:  [[0.15]]
grads:  [-0.04075299]
Stock Position:  -0.040752994890109605
Bond Position:  [38.56405447]


portfolio before change:  [34.67944076]
curr_Stock_Price:  95.43923159377776
curr_Factors:  [95.43923159]
mat_Sqrt:  [[0.15]]
grads:  [-0.0362627]
Stock Position:  -0.036262695082373286
Bond Position:  [38.14032451]


portfolio before change:  [34.64848584]
curr_Stock_Price:  96.42434181797239
curr_Factors:  [96.42434182]
mat_Sqrt:  [[0.15]]
grads:  [0.0074316]
Stock Position:  0.007431598296353519
Bond Position:  [33.93189887]


portfolio before change:  [34.64865959]
curr_Stock_Price:  95.87694816952742
curr_Factors:  [95.87694817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676409]
Stock Position:  -0.026764092433123356
Bond Position:  [37.21471909]


portfolio before change:  [34.66413802]
curr_Stock_Price:  95.47243982722075
curr_Factors:  [95.47243983]
mat_Sqrt:  [[0.15]]
grads:  [-0.09796482]
Stock Position:  -0.09796481789430772
Bond Position:  [44.0170782]


portfolio before change:  [34.72794665]
curr_Stock_Price:  94.8772654280008
curr_Factors:  [94.87726543]
mat_Sqrt:  [[0.15]]
grads:  [-0.15550542]
Stock Position:  -0.1555054167729534
Bond Position:  [49.48187535]


portfolio before change:  [34.80859553]
curr_Stock_Price:  94.39841867802336
curr_Factors:  [94.39841868]
mat_Sqrt:  [[0.15]]
grads:  [0.02809948]
Stock Position:  0.028099477900897417
Bond Position:  [32.15604925]


portfolio before change:  [34.79898723]
curr_Stock_Price:  93.91342538664873
curr_Factors:  [93.91342539]
mat_Sqrt:  [[0.15]]
grads:  [-0.0845779]
Stock Position:  -0.08457789875646433
Bond Position:  [42.74198741]


portfolio before change:  [34.78959042]
curr_Stock_Price:  94.08770137096951
curr_Factors:  [94.08770137]
mat_Sqrt:  [[0.15]]
grads:  [0.06623594]
Stock Position:  0.06623593586041546
Bond Position:  [28.55760346]


portfolio before change:  [34.78140496]
curr_Stock_Price:  93.91022399966442
curr_Factors:  [93.910224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01445105]
Stock Position:  -0.014451052793810511
Bond Position:  [36.13850656]


portfolio before change:  [34.78553679]
curr_Stock_Price:  93.93691860347006
curr_Factors:  [93.9369186]
mat_Sqrt:  [[0.15]]
grads:  [0.21646697]
Stock Position:  0.21646696968636642
Bond Position:  [14.45129668]


portfolio before change:  [35.19486551]
curr_Stock_Price:  95.81952543556153
curr_Factors:  [95.81952544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02917751]
Stock Position:  -0.029177506317263395
Bond Position:  [37.99064032]


portfolio before change:  [35.23421858]
curr_Stock_Price:  94.63354537840004
curr_Factors:  [94.63354538]
mat_Sqrt:  [[0.15]]
grads:  [-0.26452655]
Stock Position:  -0.2645265542789558
Bond Position:  [60.26730426]


portfolio before change:  [35.41094576]
curr_Stock_Price:  93.99393740451536
curr_Factors:  [93.9939374]
mat_Sqrt:  [[0.15]]
grads:  [-0.05703597]
Stock Position:  -0.057035972166652835
Bond Position:  [40.77198135]


portfolio before change:  [35.35487971]
curr_Stock_Price:  95.06629339853461
curr_Factors:  [95.0662934]
mat_Sqrt:  [[0.15]]
grads:  [0.29960384]
Stock Position:  0.2996038391769817
Bond Position:  [6.87265323]


portfolio before change:  [35.38058634]
curr_Stock_Price:  95.1492279013216
curr_Factors:  [95.1492279]
mat_Sqrt:  [[0.15]]
grads:  [0.0036355]
Stock Position:  0.0036354952826223494
Bond Position:  [35.03467177]


portfolio before change:  [35.38730324]
curr_Stock_Price:  95.79213842697776
curr_Factors:  [95.79213843]
mat_Sqrt:  [[0.15]]
grads:  [-0.11768477]
Stock Position:  -0.11768477207095739
Bond Position:  [46.66057922]


portfolio before change:  [35.41981162]
curr_Stock_Price:  95.56546988185664
curr_Factors:  [95.56546988]
mat_Sqrt:  [[0.15]]
grads:  [-0.23363481]
Stock Position:  -0.23363480637025882
Bond Position:  [57.74723167]


portfolio before change:  [35.4652741]
curr_Stock_Price:  95.40178009716514
curr_Factors:  [95.4017801]
mat_Sqrt:  [[0.15]]
grads:  [-0.15554625]
Stock Position:  -0.15554625482231565
Bond Position:  [50.3046637]


portfolio before change:  [35.41475058]
curr_Stock_Price:  95.7670219275088
curr_Factors:  [95.76702193]
mat_Sqrt:  [[0.15]]
grads:  [0.24883885]
Stock Position:  0.24883885285655782
Bond Position:  [11.5841947]


portfolio before change:  [34.76731045]
curr_Stock_Price:  93.15935742895459
curr_Factors:  [93.15935743]
mat_Sqrt:  [[0.15]]
grads:  [-0.06818284]
Stock Position:  -0.06818284212054956
Bond Position:  [41.11918021]


portfolio before change:  [34.78796755]
curr_Stock_Price:  92.93177988912731
curr_Factors:  [92.93177989]
mat_Sqrt:  [[0.15]]
grads:  [-0.06344043]
Stock Position:  -0.06344043421566392
Bond Position:  [40.68360002]


portfolio before change:  [34.76990256]
curr_Stock_Price:  93.29670107363772
curr_Factors:  [93.29670107]
mat_Sqrt:  [[0.15]]
grads:  [0.24072447]
Stock Position:  0.24072446502716852
Bond Position:  [12.31110411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.93847217]
Stock Price:  93.99056749122951
PL:  [34.93847217]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 3.78501089e-02]
 [ 2.48736786e-03]
 [-1.62165830e-02]
 [-6.86257214e-03]
 [-7.19753389e-03]
 [ 3.18928789e-02]
 [ 3.60138793e-03]
 [ 5.94042506e-03]
 [-2.77176255e-02]
 [ 2.34007526e-02]
 [ 1.91493744e-02]
 [-1.40443151e-02]
 [ 5.15274593e-03]
 [ 6.41916077e-03]
 [ 3.65992618e-03]
 [-3.69556436e-03]
 [-6.10563534e-03]
 [ 4.50945452e-03]
 [ 5.07678184e-03]
 [-2.67550367e-02]
 [-2.88522728e-03]
 [-8.54743878e-03]
 [ 6.87402211e-03]
 [-6.74053067e-03]
 [ 1.46148050e-02]
 [ 5.54067628e-03]
 [ 8.80991629e-03]
 [-3.70992797e-03]
 [-1.33051539e-02]
 [-1.44007586e-02]
 [-4.77044615e-03]
 [ 1.51430803e-02]
 [-9.34906111e-03]
 [-2.76383160e-02]
 [-2.18857834e-02]
 [ 3.46834121e-02]
 [ 1.98046802e-03]
 [ 5.13254752e-03]
 [ 7.16653911e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.00153766]
curr_Stock_Price:  98.41098604887148
curr_Factors:  [98.41098605]
mat_Sqrt:  [[0.15]]
grads:  [0.25233406]
Stock Position:  0.25233405904133804
Bond Position:  [-57.83398123]


portfolio before change:  [-33.05838319]
curr_Stock_Price:  98.21435850097858
curr_Factors:  [98.2143585]
mat_Sqrt:  [[0.15]]
grads:  [0.01658245]
Stock Position:  0.016582452377625716
Bond Position:  [-34.68701811]


portfolio before change:  [-33.05833752]
curr_Stock_Price:  98.4786030877762
curr_Factors:  [98.47860309]
mat_Sqrt:  [[0.15]]
grads:  [-0.10811055]
Stock Position:  -0.10811055335140407
Bond Position:  [-22.41176124]


portfolio before change:  [-33.13539792]
curr_Stock_Price:  99.16548109839987
curr_Factors:  [99.1654811]
mat_Sqrt:  [[0.15]]
grads:  [-0.04575048]
Stock Position:  -0.04575048092223265
Bond Position:  [-28.59852947]


portfolio before change:  [-33.19541954]
curr_Stock_Price:  100.39927304992067
curr_Factors:  [100.39927305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04798356]
Stock Position:  -0.04798355928594886
Bond Position:  [-28.37790507]


portfolio before change:  [-33.22872863]
curr_Stock_Price:  101.01951945105007
curr_Factors:  [101.01951945]
mat_Sqrt:  [[0.15]]
grads:  [0.21261919]
Stock Position:  0.21261919240035232
Bond Position:  [-54.70741727]


portfolio before change:  [-33.09962988]
curr_Stock_Price:  101.65886718084055
curr_Factors:  [101.65886718]
mat_Sqrt:  [[0.15]]
grads:  [0.02400925]
Stock Position:  0.024009252855660485
Bond Position:  [-35.54038333]


portfolio before change:  [-33.12310742]
curr_Stock_Price:  100.86605986104988
curr_Factors:  [100.86605986]
mat_Sqrt:  [[0.15]]
grads:  [0.03960283]
Stock Position:  0.03960283370743624
Bond Position:  [-37.11768922]


portfolio before change:  [-33.18818975]
curr_Stock_Price:  99.33984774464207
curr_Factors:  [99.33984774]
mat_Sqrt:  [[0.15]]
grads:  [-0.18478417]
Stock Position:  -0.18478416976490122
Bond Position:  [-14.83175846]


portfolio before change:  [-33.27522018]
curr_Stock_Price:  99.80079817689038
curr_Factors:  [99.80079818]
mat_Sqrt:  [[0.15]]
grads:  [0.15600502]
Stock Position:  0.15600501710488468
Bond Position:  [-48.8446454]


portfolio before change:  [-33.23369983]
curr_Stock_Price:  100.10608522973531
curr_Factors:  [100.10608523]
mat_Sqrt:  [[0.15]]
grads:  [0.1276625]
Stock Position:  0.1276624959423378
Bond Position:  [-46.01349253]


portfolio before change:  [-33.39059417]
curr_Stock_Price:  98.92216434451873
curr_Factors:  [98.92216434]
mat_Sqrt:  [[0.15]]
grads:  [-0.09362877]
Stock Position:  -0.09362876731000744
Bond Position:  [-24.12863386]


portfolio before change:  [-33.36657301]
curr_Stock_Price:  98.63339167156803
curr_Factors:  [98.63339167]
mat_Sqrt:  [[0.15]]
grads:  [0.03435164]
Stock Position:  0.03435163953222452
Bond Position:  [-36.75479172]


portfolio before change:  [-33.34997286]
curr_Stock_Price:  99.25038640083169
curr_Factors:  [99.2503864]
mat_Sqrt:  [[0.15]]
grads:  [0.04279441]
Stock Position:  0.042794405150373416
Bond Position:  [-37.59733411]


portfolio before change:  [-33.285296]
curr_Stock_Price:  100.87155213162517
curr_Factors:  [100.87155213]
mat_Sqrt:  [[0.15]]
grads:  [0.02439951]
Stock Position:  0.024399507894761176
Bond Position:  [-35.74651223]


portfolio before change:  [-33.2805863]
curr_Stock_Price:  101.24771917006598
curr_Factors:  [101.24771917]
mat_Sqrt:  [[0.15]]
grads:  [-0.0246371]
Stock Position:  -0.02463709572805478
Bond Position:  [-30.78613655]


portfolio before change:  [-33.25946434]
curr_Stock_Price:  100.23418786215821
curr_Factors:  [100.23418786]
mat_Sqrt:  [[0.15]]
grads:  [-0.04070424]
Stock Position:  -0.04070423559695673
Bond Position:  [-29.17950834]


portfolio before change:  [-33.22538009]
curr_Stock_Price:  99.3072102442731
curr_Factors:  [99.30721024]
mat_Sqrt:  [[0.15]]
grads:  [0.03006303]
Stock Position:  0.030063030104832227
Bond Position:  [-36.21085574]


portfolio before change:  [-33.25016168]
curr_Stock_Price:  98.63346077955508
curr_Factors:  [98.63346078]
mat_Sqrt:  [[0.15]]
grads:  [0.03384521]
Stock Position:  0.03384521225374399
Bond Position:  [-36.5884321]


portfolio before change:  [-33.24635778]
curr_Stock_Price:  98.88099200440429
curr_Factors:  [98.880992]
mat_Sqrt:  [[0.15]]
grads:  [-0.17836691]
Stock Position:  -0.17836691158822043
Bond Position:  [-15.60926062]


portfolio before change:  [-33.21337751]
curr_Stock_Price:  98.68515105237375
curr_Factors:  [98.68515105]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923485]
Stock Position:  -0.019234848537208124
Bond Position:  [-31.31518358]


portfolio before change:  [-33.22697071]
curr_Stock_Price:  99.18832923907239
curr_Factors:  [99.18832924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05698293]
Stock Position:  -0.0569829251791804
Bond Position:  [-27.57492956]


portfolio before change:  [-33.21974403]
curr_Stock_Price:  99.00101418958977
curr_Factors:  [99.00101419]
mat_Sqrt:  [[0.15]]
grads:  [0.04582681]
Stock Position:  0.04582681404809215
Bond Position:  [-37.7566451]


portfolio before change:  [-33.25741578]
curr_Stock_Price:  98.28196202371038
curr_Factors:  [98.28196202]
mat_Sqrt:  [[0.15]]
grads:  [-0.04493687]
Stock Position:  -0.044936871135022434
Bond Position:  [-28.84093191]


portfolio before change:  [-33.27005869]
curr_Stock_Price:  98.48307913072591
curr_Factors:  [98.48307913]
mat_Sqrt:  [[0.15]]
grads:  [0.09743203]
Stock Position:  0.0974320330492108
Bond Position:  [-42.86546531]


portfolio before change:  [-33.33454866]
curr_Stock_Price:  97.87617962510903
curr_Factors:  [97.87617963]
mat_Sqrt:  [[0.15]]
grads:  [0.03693784]
Stock Position:  0.036937841888460304
Bond Position:  [-36.94988351]


portfolio before change:  [-33.35175744]
curr_Stock_Price:  97.53534347250891
curr_Factors:  [97.53534347]
mat_Sqrt:  [[0.15]]
grads:  [0.05873278]
Stock Position:  0.05873277527270831
Bond Position:  [-39.08027885]


portfolio before change:  [-33.36672026]
curr_Stock_Price:  97.36376154776673
curr_Factors:  [97.36376155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02473285]
Stock Position:  -0.024732853132430444
Bond Position:  [-30.95863665]


portfolio before change:  [-33.37904988]
curr_Stock_Price:  97.70579826267638
curr_Factors:  [97.70579826]
mat_Sqrt:  [[0.15]]
grads:  [-0.08870103]
Stock Position:  -0.0887010261890922
Bond Position:  [-24.71244531]


portfolio before change:  [-33.39394275]
curr_Stock_Price:  97.83887028787647
curr_Factors:  [97.83887029]
mat_Sqrt:  [[0.15]]
grads:  [-0.09600506]
Stock Position:  -0.09600505701840377
Bond Position:  [-24.00091643]


portfolio before change:  [-33.5286085]
curr_Stock_Price:  99.21031317090656
curr_Factors:  [99.21031317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180297]
Stock Position:  -0.0318029743126404
Bond Position:  [-30.37342546]


portfolio before change:  [-33.5472736]
curr_Stock_Price:  99.67782213346993
curr_Factors:  [99.67782213]
mat_Sqrt:  [[0.15]]
grads:  [0.10095387]
Stock Position:  0.10095386838343365
Bond Position:  [-43.61013533]


portfolio before change:  [-33.62018834]
curr_Stock_Price:  99.0095650176287
curr_Factors:  [99.00956502]
mat_Sqrt:  [[0.15]]
grads:  [-0.06232707]
Stock Position:  -0.06232707405412245
Bond Position:  [-27.44921185]


portfolio before change:  [-33.67043823]
curr_Stock_Price:  99.7607396282695
curr_Factors:  [99.76073963]
mat_Sqrt:  [[0.15]]
grads:  [-0.18425544]
Stock Position:  -0.18425544031143007
Bond Position:  [-15.28897922]


portfolio before change:  [-33.55019537]
curr_Stock_Price:  99.09777904690192
curr_Factors:  [99.09777905]
mat_Sqrt:  [[0.15]]
grads:  [-0.14590522]
Stock Position:  -0.14590522297082395
Bond Position:  [-19.09131183]


portfolio before change:  [-33.5669248]
curr_Stock_Price:  99.19608165953981
curr_Factors:  [99.19608166]
mat_Sqrt:  [[0.15]]
grads:  [0.23122275]
Stock Position:  0.23122274757258504
Bond Position:  [-56.50331535]


portfolio before change:  [-33.85508909]
curr_Stock_Price:  97.98036680153115
curr_Factors:  [97.9803668]
mat_Sqrt:  [[0.15]]
grads:  [0.01320312]
Stock Position:  0.013203120129554862
Bond Position:  [-35.14873564]


portfolio before change:  [-33.86936875]
curr_Stock_Price:  97.23161964639742
curr_Factors:  [97.23161965]
mat_Sqrt:  [[0.15]]
grads:  [0.03421698]
Stock Position:  0.03421698347192102
Bond Position:  [-37.19634147]


portfolio before change:  [-33.86000848]
curr_Stock_Price:  97.6410685336068
curr_Factors:  [97.64106853]
mat_Sqrt:  [[0.15]]
grads:  [0.04777693]
Stock Position:  0.04777692740476758
Bond Position:  [-38.52499872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-33.86995956]
Stock Price:  97.53358659885508
PL:  [-33.86995956]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-1.97053259e-02]
 [ 3.66483292e-02]
 [-3.49470421e-03]
 [ 6.57838834e-04]
 [-1.98330985e-03]
 [ 3.08085197e-02]
 [ 3.58903642e-03]
 [ 1.32083222e-02]
 [-1.40889903e-02]
 [ 2.33394884e-02]
 [ 2.00420559e-02]
 [-9.18941646e-03]
 [ 1.96995798e-02]
 [ 6.49741690e-03]
 [-9.69428279e-03]
 [-2.73869938e-03]
 [-6.08693716e-03]
 [ 5.17719189e-03]
 [ 5.26089828e-03]
 [-2.13925136e-02]
 [-5.60509739e-03]
 [-1.57114490e-02]
 [ 6.12075511e-03]
 [-9.74317769e-03]
 [ 1.25210164e-02]
 [ 4.28759685e-03]
 [ 6.84924277e-03]
 [-3.12996106e-03]
 [-7.51914672e-03]
 [-1.28841213e-02]
 [ 3.50506870e-02]
 [ 8.55459453e-03]
 [-1.53058636e-02]
 [-4.90698538e-02]
 [-2.29869921e-02]
 [ 3.74446312e-02]
 [-4.73598316e-03]
 [ 2.36163633e-03]
 [ 1.05073201e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.03040878]
curr_Stock_Price:  100.55310550134857
curr_Factors:  [100.5531055]
mat_Sqrt:  [[0.15]]
grads:  [-0.13136884]
Stock Position:  -0.13136883934208454
Bond Position:  [27.23995354]


portfolio before change:  [14.01546915]
curr_Stock_Price:  100.69274926257432
curr_Factors:  [100.69274926]
mat_Sqrt:  [[0.15]]
grads:  [0.24432219]
Stock Position:  0.24432219491165044
Bond Position:  [-10.58600436]


portfolio before change:  [14.03908721]
curr_Stock_Price:  100.79483329242521
curr_Factors:  [100.79483329]
mat_Sqrt:  [[0.15]]
grads:  [-0.02329803]
Stock Position:  -0.023298028081819497
Bond Position:  [16.38740806]


portfolio before change:  [14.01363118]
curr_Stock_Price:  101.9753875718999
curr_Factors:  [101.97538757]
mat_Sqrt:  [[0.15]]
grads:  [0.00438559]
Stock Position:  0.004385592225512773
Bond Position:  [13.56640871]


portfolio before change:  [14.01450211]
curr_Stock_Price:  101.7872781327667
curr_Factors:  [101.78727813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322207]
Stock Position:  -0.01322206565081787
Bond Position:  [15.36034018]


portfolio before change:  [14.02416735]
curr_Stock_Price:  101.20150931953845
curr_Factors:  [101.20150932]
mat_Sqrt:  [[0.15]]
grads:  [0.20539013]
Stock Position:  0.20539013120822514
Bond Position:  [-6.76162393]


portfolio before change:  [14.12990927]
curr_Stock_Price:  101.72045916805367
curr_Factors:  [101.72045917]
mat_Sqrt:  [[0.15]]
grads:  [0.02392691]
Stock Position:  0.02392690946878939
Bond Position:  [11.69605305]


portfolio before change:  [14.13275176]
curr_Stock_Price:  101.77815117164407
curr_Factors:  [101.77815117]
mat_Sqrt:  [[0.15]]
grads:  [0.08805548]
Stock Position:  0.08805548142306849
Bond Position:  [5.17062766]


portfolio before change:  [14.1023984]
curr_Stock_Price:  101.42610349001335
curr_Factors:  [101.42610349]
mat_Sqrt:  [[0.15]]
grads:  [-0.0939266]
Stock Position:  -0.09392660174262442
Bond Position:  [23.62900763]


portfolio before change:  [14.1774677]
curr_Stock_Price:  100.65831786394685
curr_Factors:  [100.65831786]
mat_Sqrt:  [[0.15]]
grads:  [0.15559659]
Stock Position:  0.15559658903703774
Bond Position:  [-1.48462321]


portfolio before change:  [14.28201847]
curr_Stock_Price:  101.3314454559556
curr_Factors:  [101.33144546]
mat_Sqrt:  [[0.15]]
grads:  [0.13361371]
Stock Position:  0.13361370595517763
Bond Position:  [0.74274851]


portfolio before change:  [14.36076403]
curr_Stock_Price:  101.92010297800857
curr_Factors:  [101.92010298]
mat_Sqrt:  [[0.15]]
grads:  [-0.06126278]
Stock Position:  -0.06126277637037691
Bond Position:  [20.60467251]


portfolio before change:  [14.38054372]
curr_Stock_Price:  101.63928084955626
curr_Factors:  [101.63928085]
mat_Sqrt:  [[0.15]]
grads:  [0.13133053]
Stock Position:  0.1313305317141529
Bond Position:  [1.03220293]


portfolio before change:  [14.11864083]
curr_Stock_Price:  99.64407130555324
curr_Factors:  [99.64407131]
mat_Sqrt:  [[0.15]]
grads:  [0.04331611]
Stock Position:  0.043316112652479505
Bond Position:  [9.80244701]


portfolio before change:  [14.09884024]
curr_Stock_Price:  99.15866365534484
curr_Factors:  [99.15866366]
mat_Sqrt:  [[0.15]]
grads:  [-0.06462855]
Stock Position:  -0.06462855192563308
Bond Position:  [20.50732108]


portfolio before change:  [14.05585209]
curr_Stock_Price:  99.86348715095066
curr_Factors:  [99.86348715]
mat_Sqrt:  [[0.15]]
grads:  [-0.018258]
Stock Position:  -0.018257995876227152
Bond Position:  [15.87915923]


portfolio before change:  [14.04746268]
curr_Stock_Price:  100.4317001817501
curr_Factors:  [100.43170018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057958]
Stock Position:  -0.04057958104352449
Bond Position:  [18.12293899]


portfolio before change:  [14.06861068]
curr_Stock_Price:  99.96638005507812
curr_Factors:  [99.96638006]
mat_Sqrt:  [[0.15]]
grads:  [0.03451461]
Stock Position:  0.03451461260686509
Bond Position:  [10.6183098]


portfolio before change:  [14.03791606]
curr_Stock_Price:  99.03859938541964
curr_Factors:  [99.03859939]
mat_Sqrt:  [[0.15]]
grads:  [0.03507266]
Stock Position:  0.03507265518277925
Bond Position:  [10.56436942]


portfolio before change:  [14.04449062]
curr_Stock_Price:  99.18840066091063
curr_Factors:  [99.18840066]
mat_Sqrt:  [[0.15]]
grads:  [-0.14261676]
Stock Position:  -0.14261675757846465
Bond Position:  [28.19041871]


portfolio before change:  [14.27247482]
curr_Stock_Price:  97.61453104201281
curr_Factors:  [97.61453104]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736732]
Stock Position:  -0.037367315936091404
Bond Position:  [17.92006785]


portfolio before change:  [14.27142209]
curr_Stock_Price:  97.7026530195298
curr_Factors:  [97.70265302]
mat_Sqrt:  [[0.15]]
grads:  [-0.10474299]
Stock Position:  -0.10474299337994905
Bond Position:  [24.50509043]


portfolio before change:  [14.33111438]
curr_Stock_Price:  97.1620062798074
curr_Factors:  [97.16200628]
mat_Sqrt:  [[0.15]]
grads:  [0.04080503]
Stock Position:  0.040805034069471294
Bond Position:  [10.3664154]


portfolio before change:  [14.31684503]
curr_Stock_Price:  96.78055271200297
curr_Factors:  [96.78055271]
mat_Sqrt:  [[0.15]]
grads:  [-0.06495452]
Stock Position:  -0.06495451791774877
Bond Position:  [20.60317918]


portfolio before change:  [14.32082573]
curr_Stock_Price:  96.75892009598353
curr_Factors:  [96.7589201]
mat_Sqrt:  [[0.15]]
grads:  [0.08347344]
Stock Position:  0.08347344251772464
Bond Position:  [6.24402557]


portfolio before change:  [14.37082972]
curr_Stock_Price:  97.3486099061126
curr_Factors:  [97.34860991]
mat_Sqrt:  [[0.15]]
grads:  [0.02858398]
Stock Position:  0.028583978979670327
Bond Position:  [11.5882191]


portfolio before change:  [14.38295676]
curr_Stock_Price:  97.72219068027054
curr_Factors:  [97.72219068]
mat_Sqrt:  [[0.15]]
grads:  [0.04566162]
Stock Position:  0.045661618451842224
Bond Position:  [9.92080338]


portfolio before change:  [14.40358094]
curr_Stock_Price:  98.14670465111082
curr_Factors:  [98.14670465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02086641]
Stock Position:  -0.020866407037748957
Bond Position:  [16.45155002]


portfolio before change:  [14.39747913]
curr_Stock_Price:  98.53768594873809
curr_Factors:  [98.53768595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012764]
Stock Position:  -0.05012764481841179
Bond Position:  [19.33694125]


portfolio before change:  [14.47466665]
curr_Stock_Price:  97.04608890757379
curr_Factors:  [97.04608891]
mat_Sqrt:  [[0.15]]
grads:  [-0.08589414]
Stock Position:  -0.08589414216911322
Bond Position:  [22.81035721]


portfolio before change:  [14.47397478]
curr_Stock_Price:  97.08734134551669
curr_Factors:  [97.08734135]
mat_Sqrt:  [[0.15]]
grads:  [0.23367125]
Stock Position:  0.23367124678834755
Bond Position:  [-8.21254532]


portfolio before change:  [14.62294932]
curr_Stock_Price:  97.72927386179391
curr_Factors:  [97.72927386]
mat_Sqrt:  [[0.15]]
grads:  [0.05703063]
Stock Position:  0.05703063021902776
Bond Position:  [9.04938724]


portfolio before change:  [14.55960159]
curr_Stock_Price:  96.59867140498075
curr_Factors:  [96.5986714]
mat_Sqrt:  [[0.15]]
grads:  [-0.10203909]
Stock Position:  -0.10203909060486653
Bond Position:  [24.41644217]


portfolio before change:  [14.51629335]
curr_Stock_Price:  97.05301184182989
curr_Factors:  [97.05301184]
mat_Sqrt:  [[0.15]]
grads:  [-0.32713236]
Stock Position:  -0.3271323587346709
Bond Position:  [46.26547404]


portfolio before change:  [14.73289813]
curr_Stock_Price:  96.40855945149667
curr_Factors:  [96.40855945]
mat_Sqrt:  [[0.15]]
grads:  [-0.15324661]
Stock Position:  -0.15324661422886418
Bond Position:  [29.50718345]


portfolio before change:  [14.82655041]
curr_Stock_Price:  95.82150798365008
curr_Factors:  [95.82150798]
mat_Sqrt:  [[0.15]]
grads:  [0.24963087]
Stock Position:  0.2496308747764126
Bond Position:  [-9.09345645]


portfolio before change:  [14.69038853]
curr_Stock_Price:  95.28060885660624
curr_Factors:  [95.28060886]
mat_Sqrt:  [[0.15]]
grads:  [-0.03157322]
Stock Position:  -0.03157322103600797
Bond Position:  [17.69870425]


portfolio before change:  [14.65406651]
curr_Stock_Price:  96.5010890991635
curr_Factors:  [96.5010891]
mat_Sqrt:  [[0.15]]
grads:  [0.01574424]
Stock Position:  0.015744242200319936
Bond Position:  [13.13473]


portfolio before change:  [14.66433104]
curr_Stock_Price:  97.04875485646365
curr_Factors:  [97.04875486]
mat_Sqrt:  [[0.15]]
grads:  [0.0700488]
Stock Position:  0.07004880072273974
Bond Position:  [7.86618215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.70892613]
Stock Price:  97.67134592137079
PL:  [14.70892613]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [ 9.56721055e-03]
 [ 2.90506809e-02]
 [-1.53535705e-02]
 [-7.70854361e-03]
 [-5.87083893e-03]
 [ 4.76617395e-02]
 [ 3.46598308e-03]
 [ 8.28553872e-03]
 [ 6.17015530e-02]
 [ 2.32479491e-02]
 [ 2.23809614e-02]
 [-2.26726382e-03]
 [-3.49036666e-02]
 [ 1.46645878e-02]
 [ 5.49206718e-03]
 [-2.73985961e-03]
 [-6.00549745e-03]
 [-1.48642356e-02]
 [ 1.71512554e-03]
 [ 1.56925052e-02]
 [-1.92821150e-02]
 [-2.44371296e-02]
 [ 4.27630855e-03]
 [-1.30105984e-02]
 [ 9.28037793e-03]
 [-3.34197594e-03]
 [ 3.19404310e-02]
 [-4.50939764e-03]
 [-2.28935902e-02]
 [-1.16756059e-02]
 [ 3.50345836e-02]
 [ 1.47341620e-02]
 [-9.36620515e-03]
 [-4.95054545e-02]
 [-2.25855586e-02]
 [ 3.91276936e-02]
 [ 2.38804882e-03]
 [ 8.23096898e-03]
 [ 4.48921655e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.5989969]
curr_Stock_Price:  98.97587280852049
curr_Factors:  [98.97587281]
mat_Sqrt:  [[0.15]]
grads:  [0.0637814]
Stock Position:  0.0637814036491787
Bond Position:  [-26.911817]


portfolio before change:  [-20.5849884]
curr_Stock_Price:  99.24825137786036
curr_Factors:  [99.24825138]
mat_Sqrt:  [[0.15]]
grads:  [0.19367121]
Stock Position:  0.19367120593407547
Bond Position:  [-39.80651693]


portfolio before change:  [-20.80486507]
curr_Stock_Price:  98.13863601725009
curr_Factors:  [98.13863602]
mat_Sqrt:  [[0.15]]
grads:  [-0.10235714]
Stock Position:  -0.1023571367332523
Bond Position:  [-10.75967529]


portfolio before change:  [-20.81283166]
curr_Stock_Price:  98.20332662732793
curr_Factors:  [98.20332663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05139029]
Stock Position:  -0.05139029072286173
Bond Position:  [-15.76613416]


portfolio before change:  [-20.82256526]
curr_Stock_Price:  98.35438069507909
curr_Factors:  [98.3543807]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913893]
Stock Position:  -0.039138926190726266
Bond Position:  [-16.97308042]


portfolio before change:  [-20.79258271]
curr_Stock_Price:  97.53411491216337
curr_Factors:  [97.53411491]
mat_Sqrt:  [[0.15]]
grads:  [0.31774493]
Stock Position:  0.31774492989565434
Bond Position:  [-51.78355322]


portfolio before change:  [-21.16450618]
curr_Stock_Price:  96.38397816834122
curr_Factors:  [96.38397817]
mat_Sqrt:  [[0.15]]
grads:  [0.02310655]
Stock Position:  0.023106553843196067
Bond Position:  [-23.39160776]


portfolio before change:  [-21.19068069]
curr_Stock_Price:  95.37775389218382
curr_Factors:  [95.37775389]
mat_Sqrt:  [[0.15]]
grads:  [0.05523692]
Stock Position:  0.055236924788473474
Bond Position:  [-26.45905451]


portfolio before change:  [-21.16556734]
curr_Stock_Price:  95.89228168093427
curr_Factors:  [95.89228168]
mat_Sqrt:  [[0.15]]
grads:  [0.41134369]
Stock Position:  0.4113436868781486
Bond Position:  [-60.61025203]


portfolio before change:  [-21.70001911]
curr_Stock_Price:  94.61141841977926
curr_Factors:  [94.61141842]
mat_Sqrt:  [[0.15]]
grads:  [0.15498633]
Stock Position:  0.15498632760680459
Bond Position:  [-36.3634954]


portfolio before change:  [-21.69830905]
curr_Stock_Price:  94.65178191209918
curr_Factors:  [94.65178191]
mat_Sqrt:  [[0.15]]
grads:  [0.14920641]
Stock Position:  0.14920640902179594
Bond Position:  [-35.82096153]


portfolio before change:  [-21.71710144]
curr_Stock_Price:  94.55584435608911
curr_Factors:  [94.55584436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01511509]
Stock Position:  -0.01511509214910638
Bond Position:  [-20.28788114]


portfolio before change:  [-21.71198825]
curr_Stock_Price:  94.04977148579626
curr_Factors:  [94.04977149]
mat_Sqrt:  [[0.15]]
grads:  [-0.23269111]
Stock Position:  -0.2326911106180285
Bond Position:  [0.17255753]


portfolio before change:  [-21.50193294]
curr_Stock_Price:  93.14714249957903
curr_Factors:  [93.1471425]
mat_Sqrt:  [[0.15]]
grads:  [0.09776392]
Stock Position:  0.0977639189298947
Bond Position:  [-30.60836263]


portfolio before change:  [-21.39497469]
curr_Stock_Price:  94.28032669936366
curr_Factors:  [94.2803267]
mat_Sqrt:  [[0.15]]
grads:  [0.03661378]
Stock Position:  0.03661378122637259
Bond Position:  [-24.84693395]


portfolio before change:  [-21.4112]
curr_Stock_Price:  93.92201221856921
curr_Factors:  [93.92201222]
mat_Sqrt:  [[0.15]]
grads:  [-0.01826573]
Stock Position:  -0.018265730747752895
Bond Position:  [-19.69564582]


portfolio before change:  [-21.4077281]
curr_Stock_Price:  93.59714071449645
curr_Factors:  [93.59714071]
mat_Sqrt:  [[0.15]]
grads:  [-0.04003665]
Stock Position:  -0.04003664967470019
Bond Position:  [-17.66041216]


portfolio before change:  [-21.38717619]
curr_Stock_Price:  93.02867162763923
curr_Factors:  [93.02867163]
mat_Sqrt:  [[0.15]]
grads:  [-0.0990949]
Stock Position:  -0.0990949039092002
Bond Position:  [-12.16850891]


portfolio before change:  [-21.47834123]
curr_Stock_Price:  93.93329818799421
curr_Factors:  [93.93329819]
mat_Sqrt:  [[0.15]]
grads:  [0.01143417]
Stock Position:  0.011434170270609226
Bond Position:  [-22.55239055]


portfolio before change:  [-21.47657801]
curr_Stock_Price:  94.33406573420504
curr_Factors:  [94.33406573]
mat_Sqrt:  [[0.15]]
grads:  [0.1046167]
Stock Position:  0.10461670103809648
Bond Position:  [-31.34549676]


portfolio before change:  [-21.47184606]
curr_Stock_Price:  94.4167521238642
curr_Factors:  [94.41675212]
mat_Sqrt:  [[0.15]]
grads:  [-0.12854743]
Stock Position:  -0.12854743301111093
Bond Position:  [-9.33481495]


portfolio before change:  [-21.46350554]
curr_Stock_Price:  94.3427915148701
curr_Factors:  [94.34279151]
mat_Sqrt:  [[0.15]]
grads:  [-0.1629142]
Stock Position:  -0.16291419741262148
Bond Position:  [-6.09372538]


portfolio before change:  [-21.50007043]
curr_Stock_Price:  94.5625582413063
curr_Factors:  [94.56255824]
mat_Sqrt:  [[0.15]]
grads:  [0.02850872]
Stock Position:  0.02850872368586059
Bond Position:  [-24.19592827]


portfolio before change:  [-21.52962832]
curr_Stock_Price:  93.63185300640313
curr_Factors:  [93.63185301]
mat_Sqrt:  [[0.15]]
grads:  [-0.08673732]
Stock Position:  -0.08673732281253231
Bond Position:  [-13.40825206]


portfolio before change:  [-21.51420942]
curr_Stock_Price:  93.4347632578779
curr_Factors:  [93.43476326]
mat_Sqrt:  [[0.15]]
grads:  [0.06186919]
Stock Position:  0.06186918617712025
Bond Position:  [-27.29494219]


portfolio before change:  [-21.54119865]
curr_Stock_Price:  93.0536826084248
curr_Factors:  [93.05368261]
mat_Sqrt:  [[0.15]]
grads:  [-0.02227984]
Stock Position:  -0.022279839574147933
Bond Position:  [-19.46797753]


portfolio before change:  [-21.56545608]
curr_Stock_Price:  94.03321296778445
curr_Factors:  [94.03321297]
mat_Sqrt:  [[0.15]]
grads:  [0.21293621]
Stock Position:  0.21293620649761152
Bond Position:  [-41.58853174]


portfolio before change:  [-21.25576903]
curr_Stock_Price:  95.51199361231639
curr_Factors:  [95.51199361]
mat_Sqrt:  [[0.15]]
grads:  [-0.03006265]
Stock Position:  -0.030062650944319327
Bond Position:  [-18.38442531]


portfolio before change:  [-21.28437394]
curr_Stock_Price:  96.38705641005032
curr_Factors:  [96.38705641]
mat_Sqrt:  [[0.15]]
grads:  [-0.15262393]
Stock Position:  -0.15262393456912374
Bond Position:  [-6.57340215]


portfolio before change:  [-21.28936436]
curr_Stock_Price:  96.41436994334096
curr_Factors:  [96.41436994]
mat_Sqrt:  [[0.15]]
grads:  [-0.07783737]
Stock Position:  -0.07783737290745195
Bond Position:  [-13.7847231]


portfolio before change:  [-21.34360845]
curr_Stock_Price:  97.0891214463453
curr_Factors:  [97.08912145]
mat_Sqrt:  [[0.15]]
grads:  [0.23356389]
Stock Position:  0.23356389084044185
Bond Position:  [-44.02012141]


portfolio before change:  [-20.86780565]
curr_Stock_Price:  99.14982377269399
curr_Factors:  [99.14982377]
mat_Sqrt:  [[0.15]]
grads:  [0.09822775]
Stock Position:  0.09822774661071182
Bond Position:  [-30.60706942]


portfolio before change:  [-20.8862084]
curr_Stock_Price:  99.00142755522994
curr_Factors:  [99.00142756]
mat_Sqrt:  [[0.15]]
grads:  [-0.06244137]
Stock Position:  -0.06244136769559254
Bond Position:  [-14.70442386]


portfolio before change:  [-20.79429913]
curr_Stock_Price:  97.50006008064011
curr_Factors:  [97.50006008]
mat_Sqrt:  [[0.15]]
grads:  [-0.33003636]
Stock Position:  -0.330036363115978
Bond Position:  [11.3842661]


portfolio before change:  [-20.81932721]
curr_Stock_Price:  97.58020639481644
curr_Factors:  [97.58020639]
mat_Sqrt:  [[0.15]]
grads:  [-0.15057039]
Stock Position:  -0.15057039042624112
Bond Position:  [-6.12663743]


portfolio before change:  [-20.78480619]
curr_Stock_Price:  97.34585160184619
curr_Factors:  [97.3458516]
mat_Sqrt:  [[0.15]]
grads:  [0.26085129]
Stock Position:  0.26085129067869633
Bond Position:  [-46.17759722]


portfolio before change:  [-20.58369172]
curr_Stock_Price:  98.1389741042989
curr_Factors:  [98.1389741]
mat_Sqrt:  [[0.15]]
grads:  [0.01592033]
Stock Position:  0.015920325452296262
Bond Position:  [-22.14609613]


portfolio before change:  [-20.56751197]
curr_Stock_Price:  99.32916245946207
curr_Factors:  [99.32916246]
mat_Sqrt:  [[0.15]]
grads:  [0.05487313]
Stock Position:  0.05487312656248487
Bond Position:  [-26.01801367]


portfolio before change:  [-20.62031061]
curr_Stock_Price:  98.42623983949473
curr_Factors:  [98.42623984]
mat_Sqrt:  [[0.15]]
grads:  [0.02992811]
Stock Position:  0.029928110358954173
Bond Position:  [-23.56602198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.64156914]
Stock Price:  97.81435405906159
PL:  [-20.64156914]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-2.26623207e-02]
 [ 3.88270313e-02]
 [ 3.07005254e-03]
 [-2.59587385e-03]
 [-4.47977644e-03]
 [ 3.04017133e-02]
 [ 3.52919349e-03]
 [ 2.67568170e-02]
 [ 3.72072335e-02]
 [ 2.29130796e-02]
 [ 1.99579127e-02]
 [-1.35847858e-02]
 [ 2.65262853e-02]
 [ 2.12919626e-02]
 [-1.21954028e-02]
 [-3.40785222e-03]
 [-5.07738943e-03]
 [ 7.94404409e-03]
 [ 2.31933651e-02]
 [-6.13277830e-03]
 [-8.30371710e-04]
 [-2.55220269e-02]
 [ 6.91637737e-03]
 [-7.27096959e-03]
 [-7.68989704e-03]
 [ 4.86129198e-03]
 [ 6.68765196e-03]
 [ 5.17470916e-03]
 [ 5.54149117e-03]
 [ 1.00273411e-02]
 [-1.70470714e-02]
 [ 1.56207529e-03]
 [ 2.00153871e-02]
 [ 1.08709161e-01]
 [-1.99690719e-02]
 [-4.09666044e-02]
 [ 4.98811991e-02]
 [ 5.65143074e-03]
 [ 7.86302131e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.6736931]
curr_Stock_Price:  100.58240456199508
curr_Factors:  [100.58240456]
mat_Sqrt:  [[0.15]]
grads:  [-0.15108214]
Stock Position:  -0.1510821376917498
Bond Position:  [29.86989779]


portfolio before change:  [14.66512603]
curr_Stock_Price:  100.66382411901239
curr_Factors:  [100.66382412]
mat_Sqrt:  [[0.15]]
grads:  [0.25884688]
Stock Position:  0.2588468751422978
Bond Position:  [-11.39139029]


portfolio before change:  [14.92352146]
curr_Stock_Price:  101.66758142319048
curr_Factors:  [101.66758142]
mat_Sqrt:  [[0.15]]
grads:  [0.02046702]
Stock Position:  0.020467016915055432
Bond Position:  [12.84268935]


portfolio before change:  [14.91824545]
curr_Stock_Price:  101.33136054313368
curr_Factors:  [101.33136054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01730583]
Stock Position:  -0.01730582564521281
Bond Position:  [16.67186831]


portfolio before change:  [14.93017019]
curr_Stock_Price:  100.7627297262717
curr_Factors:  [100.76272973]
mat_Sqrt:  [[0.15]]
grads:  [-0.02986518]
Stock Position:  -0.029865176299837468
Bond Position:  [17.93946688]


portfolio before change:  [14.9182762]
curr_Stock_Price:  101.23607579944385
curr_Factors:  [101.2360758]
mat_Sqrt:  [[0.15]]
grads:  [0.20267809]
Stock Position:  0.20267808857517086
Bond Position:  [-5.60005814]


portfolio before change:  [15.07623174]
curr_Stock_Price:  102.01887173986528
curr_Factors:  [102.01887174]
mat_Sqrt:  [[0.15]]
grads:  [0.02352796]
Stock Position:  0.023527956569886245
Bond Position:  [12.67593615]


portfolio before change:  [15.10309292]
curr_Stock_Price:  103.09319345798677
curr_Factors:  [103.09319346]
mat_Sqrt:  [[0.15]]
grads:  [0.17837878]
Stock Position:  0.17837878028177953
Bond Position:  [-3.28654518]


portfolio before change:  [15.15079355]
curr_Stock_Price:  103.36290870153474
curr_Factors:  [103.3629087]
mat_Sqrt:  [[0.15]]
grads:  [0.24804822]
Stock Position:  0.24804822314635502
Bond Position:  [-10.48819229]


portfolio before change:  [14.82265661]
curr_Stock_Price:  102.04531877954425
curr_Factors:  [102.04531878]
mat_Sqrt:  [[0.15]]
grads:  [0.15275386]
Stock Position:  0.15275386373337127
Bond Position:  [-0.76516011]


portfolio before change:  [14.68118585]
curr_Stock_Price:  101.1198095894237
curr_Factors:  [101.11980959]
mat_Sqrt:  [[0.15]]
grads:  [0.13305275]
Stock Position:  0.1330527511109194
Bond Position:  [1.226917]


portfolio before change:  [14.66368792]
curr_Stock_Price:  100.98714557816002
curr_Factors:  [100.98714558]
mat_Sqrt:  [[0.15]]
grads:  [-0.09056524]
Stock Position:  -0.09056523880333468
Bond Position:  [23.80961287]


portfolio before change:  [14.65027036]
curr_Stock_Price:  101.168163588457
curr_Factors:  [101.16816359]
mat_Sqrt:  [[0.15]]
grads:  [0.1768419]
Stock Position:  0.1768419020307517
Bond Position:  [-3.24050011]


portfolio before change:  [14.75915065]
curr_Stock_Price:  101.78614703806782
curr_Factors:  [101.78614704]
mat_Sqrt:  [[0.15]]
grads:  [0.14194642]
Stock Position:  0.14194641746144895
Bond Position:  [0.31097173]


portfolio before change:  [14.79190776]
curr_Stock_Price:  102.01664418499762
curr_Factors:  [102.01664418]
mat_Sqrt:  [[0.15]]
grads:  [-0.08130269]
Stock Position:  -0.08130268541403064
Bond Position:  [23.08613489]


portfolio before change:  [14.65998293]
curr_Stock_Price:  103.67477862933947
curr_Factors:  [103.67477863]
mat_Sqrt:  [[0.15]]
grads:  [-0.02271901]
Stock Position:  -0.022719014821390705
Bond Position:  [17.01537176]


portfolio before change:  [14.66926845]
curr_Stock_Price:  103.35969147623483
curr_Factors:  [103.35969148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384926]
Stock Position:  -0.03384926283373836
Bond Position:  [18.16791782]


portfolio before change:  [14.65070765]
curr_Stock_Price:  103.9751240358995
curr_Factors:  [103.97512404]
mat_Sqrt:  [[0.15]]
grads:  [0.05296029]
Stock Position:  0.05296029391972866
Bond Position:  [9.14415452]


portfolio before change:  [14.67918289]
curr_Stock_Price:  104.49121160152056
curr_Factors:  [104.4912116]
mat_Sqrt:  [[0.15]]
grads:  [0.15462243]
Stock Position:  0.15462243420536229
Bond Position:  [-1.47750261]


portfolio before change:  [14.82320129]
curr_Stock_Price:  105.42382598078763
curr_Factors:  [105.42382598]
mat_Sqrt:  [[0.15]]
grads:  [-0.04088519]
Stock Position:  -0.04088518869773163
Bond Position:  [19.13347431]


portfolio before change:  [14.79856857]
curr_Stock_Price:  106.08481239875117
curr_Factors:  [106.0848124]
mat_Sqrt:  [[0.15]]
grads:  [-0.00553581]
Stock Position:  -0.005535811401475357
Bond Position:  [15.38583408]


portfolio before change:  [14.7969924]
curr_Stock_Price:  106.71697201629075
curr_Factors:  [106.71697202]
mat_Sqrt:  [[0.15]]
grads:  [-0.17014685]
Stock Position:  -0.17014684599012447
Bond Position:  [32.95454861]


portfolio before change:  [15.02603492]
curr_Stock_Price:  105.39503775888552
curr_Factors:  [105.39503776]
mat_Sqrt:  [[0.15]]
grads:  [0.04610918]
Stock Position:  0.046109182466380357
Bond Position:  [10.1663559]


portfolio before change:  [15.02790236]
curr_Stock_Price:  105.40797574608901
curr_Factors:  [105.40797575]
mat_Sqrt:  [[0.15]]
grads:  [-0.04847313]
Stock Position:  -0.04847313057678833
Bond Position:  [20.13735693]


portfolio before change:  [15.02600109]
curr_Stock_Price:  105.49913133844971
curr_Factors:  [105.49913134]
mat_Sqrt:  [[0.15]]
grads:  [-0.05126598]
Stock Position:  -0.05126598029155416
Bond Position:  [20.43451748]


portfolio before change:  [14.97846616]
curr_Stock_Price:  106.47618097503043
curr_Factors:  [106.47618098]
mat_Sqrt:  [[0.15]]
grads:  [0.03240861]
Stock Position:  0.03240861321454239
Bond Position:  [11.52772079]


portfolio before change:  [15.0005337]
curr_Stock_Price:  107.11263192902702
curr_Factors:  [107.11263193]
mat_Sqrt:  [[0.15]]
grads:  [0.04458435]
Stock Position:  0.04458434638072866
Bond Position:  [10.22498702]


portfolio before change:  [15.05707621]
curr_Stock_Price:  108.3521768308833
curr_Factors:  [108.35217683]
mat_Sqrt:  [[0.15]]
grads:  [0.03449806]
Stock Position:  0.03449806106193567
Bond Position:  [11.31913619]


portfolio before change:  [15.04602451]
curr_Stock_Price:  107.99080350537936
curr_Factors:  [107.99080351]
mat_Sqrt:  [[0.15]]
grads:  [0.03694327]
Stock Position:  0.036943274487217605
Bond Position:  [11.05649061]


portfolio before change:  [15.02962495]
curr_Stock_Price:  107.50947884827914
curr_Factors:  [107.50947885]
mat_Sqrt:  [[0.15]]
grads:  [0.06684894]
Stock Position:  0.06684894073452156
Bond Position:  [7.84273017]


portfolio before change:  [15.10017186]
curr_Stock_Price:  108.55013130220927
curr_Factors:  [108.5501313]
mat_Sqrt:  [[0.15]]
grads:  [-0.11364714]
Stock Position:  -0.11364714238268343
Bond Position:  [27.43658409]


portfolio before change:  [14.84623335]
curr_Stock_Price:  110.814757513461
curr_Factors:  [110.81475751]
mat_Sqrt:  [[0.15]]
grads:  [0.01041384]
Stock Position:  0.01041383527585044
Bond Position:  [13.69222672]


portfolio before change:  [14.84701794]
curr_Stock_Price:  110.72573706961914
curr_Factors:  [110.72573707]
mat_Sqrt:  [[0.15]]
grads:  [0.13343591]
Stock Position:  0.13343591394732512
Bond Position:  [0.07222802]


portfolio before change:  [14.83158389]
curr_Stock_Price:  110.61000296484296
curr_Factors:  [110.61000296]
mat_Sqrt:  [[0.15]]
grads:  [0.72472774]
Stock Position:  0.7247277389320194
Bond Position:  [-65.33055347]


portfolio before change:  [14.37044462]
curr_Stock_Price:  109.98497867315898
curr_Factors:  [109.98497867]
mat_Sqrt:  [[0.15]]
grads:  [-0.13312715]
Stock Position:  -0.13312714570894332
Bond Position:  [29.0124309]


portfolio before change:  [14.2060427]
curr_Stock_Price:  111.24714570927893
curr_Factors:  [111.24714571]
mat_Sqrt:  [[0.15]]
grads:  [-0.2731107]
Stock Position:  -0.27311069575411373
Bond Position:  [44.58882807]


portfolio before change:  [13.88052781]
curr_Stock_Price:  112.45943381174082
curr_Factors:  [112.45943381]
mat_Sqrt:  [[0.15]]
grads:  [0.33254133]
Stock Position:  0.3325413276048573
Bond Position:  [-23.51688162]


portfolio before change:  [13.70360547]
curr_Stock_Price:  111.93624308314234
curr_Factors:  [111.93624308]
mat_Sqrt:  [[0.15]]
grads:  [0.0376762]
Stock Position:  0.03767620491595663
Bond Position:  [9.48627264]


portfolio before change:  [13.66669229]
curr_Stock_Price:  110.92502024252764
curr_Factors:  [110.92502024]
mat_Sqrt:  [[0.15]]
grads:  [0.05242014]
Stock Position:  0.05242014203510309
Bond Position:  [7.85198698]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.62110386]
Stock Price:  110.03662150721627
PL:  [3.58448236]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 3.29337001e+00]
 [-3.78154715e-02]
 [ 4.33962792e-02]
 [-3.54301138e-03]
 [-3.53086431e-03]
 [-2.90164652e-03]
 [ 2.10625150e-02]
 [ 3.60376094e-03]
 [ 1.19639545e-02]
 [-1.31812936e-02]
 [ 2.30180968e-02]
 [ 1.92699312e-02]
 [-1.38639603e-02]
 [ 1.17709544e-02]
 [ 1.72307554e-02]
 [-1.20871401e-02]
 [-3.11512213e-03]
 [-5.71633235e-03]
 [ 6.29004467e-03]
 [ 6.61125011e-03]
 [-5.99072063e-03]
 [-3.79011531e-03]
 [-4.48700951e-03]
 [ 5.09676750e-03]
 [-8.98946408e-03]
 [ 9.56740755e-03]
 [ 8.12317260e-03]
 [-4.72616732e-03]
 [-2.15496831e-03]
 [ 5.14219187e-04]
 [-9.05790920e-03]
 [-3.36757681e-03]
 [ 1.84663773e-02]
 [-6.06262359e-03]
 [-1.80348577e-02]
 [-2.13174319e-02]
 [ 2.88029783e-02]
 [ 4.14482839e-03]
 [ 1.39486275e-02]
 [ 7.97725429e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.29337001]
mat_Sqrt:  [[0.15]]
grads:  [21.95580008]
init_Out:  [2.16072952]
Stock Position:  21.95580007863106
Bond position:  [-2193.41927835]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.86868148]
curr_Stock_Price:  100.77346971893995
curr_Factors:  [100.77346972]
mat_Sqrt:  [[0.15]]
grads:  [-0.25210314]
Stock Position:  -0.2521031432394516
Bond Position:  [44.27398996]


portfolio before change:  [18.93013381]
curr_Stock_Price:  100.55166476226044
curr_Factors:  [100.55166476]
mat_Sqrt:  [[0.15]]
grads:  [0.28930853]
Stock Position:  0.2893085281810313
Bond Position:  [-10.16032033]


portfolio before change:  [18.90716665]
curr_Stock_Price:  100.47666856069544
curr_Factors:  [100.47666856]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362008]
Stock Position:  -0.02362007584852511
Bond Position:  [21.28043318]


portfolio before change:  [18.91210646]
curr_Stock_Price:  100.3801576906285
curr_Factors:  [100.38015769]
mat_Sqrt:  [[0.15]]
grads:  [-0.0235391]
Stock Position:  -0.023539095366973625
Bond Position:  [21.27496457]


portfolio before change:  [18.89430916]
curr_Stock_Price:  101.24921571856909
curr_Factors:  [101.24921572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01934431]
Stock Position:  -0.019344310163491446
Bond Position:  [20.85290539]


portfolio before change:  [18.88608363]
curr_Stock_Price:  101.80918911468798
curr_Factors:  [101.80918911]
mat_Sqrt:  [[0.15]]
grads:  [0.14041677]
Stock Position:  0.14041676661453553
Bond Position:  [4.59036649]


portfolio before change:  [18.86388816]
curr_Stock_Price:  101.64703393245088
curr_Factors:  [101.64703393]
mat_Sqrt:  [[0.15]]
grads:  [0.02402507]
Stock Position:  0.024025072928922933
Bond Position:  [16.42181076]


portfolio before change:  [18.86613971]
curr_Stock_Price:  101.65530414419754
curr_Factors:  [101.65530414]
mat_Sqrt:  [[0.15]]
grads:  [0.0797597]
Stock Position:  0.07975969685657558
Bond Position:  [10.75814346]


portfolio before change:  [18.86153102]
curr_Stock_Price:  101.58066071645048
curr_Factors:  [101.58066072]
mat_Sqrt:  [[0.15]]
grads:  [-0.08787529]
Stock Position:  -0.08787529051799735
Bond Position:  [27.78796109]


portfolio before change:  [18.86513063]
curr_Stock_Price:  101.57922806116476
curr_Factors:  [101.57922806]
mat_Sqrt:  [[0.15]]
grads:  [0.15345398]
Stock Position:  0.1534539789551857
Bond Position:  [3.2773939]


portfolio before change:  [18.69204421]
curr_Stock_Price:  100.44862118656798
curr_Factors:  [100.44862119]
mat_Sqrt:  [[0.15]]
grads:  [0.12846621]
Stock Position:  0.12846620824562932
Bond Position:  [5.78779072]


portfolio before change:  [18.74655296]
curr_Stock_Price:  100.8672934706199
curr_Factors:  [100.86729347]
mat_Sqrt:  [[0.15]]
grads:  [-0.0924264]
Stock Position:  -0.0924264019984093
Bond Position:  [28.06935398]


portfolio before change:  [18.60149057]
curr_Stock_Price:  102.47474851071564
curr_Factors:  [102.47474851]
mat_Sqrt:  [[0.15]]
grads:  [0.07847303]
Stock Position:  0.07847302956492276
Bond Position:  [10.5599866]


portfolio before change:  [18.51503506]
curr_Stock_Price:  101.35620381880109
curr_Factors:  [101.35620382]
mat_Sqrt:  [[0.15]]
grads:  [0.1148717]
Stock Position:  0.11487170282396408
Bond Position:  [6.87207533]


portfolio before change:  [18.60214005]
curr_Stock_Price:  102.1070060616957
curr_Factors:  [102.10700606]
mat_Sqrt:  [[0.15]]
grads:  [-0.08058093]
Stock Position:  -0.0805809340138719
Bond Position:  [26.83001797]


portfolio before change:  [18.64629931]
curr_Stock_Price:  101.60061708591918
curr_Factors:  [101.60061709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02076748]
Stock Position:  -0.020767480847083148
Bond Position:  [20.75628818]


portfolio before change:  [18.6452562]
curr_Stock_Price:  101.77578541582409
curr_Factors:  [101.77578542]
mat_Sqrt:  [[0.15]]
grads:  [-0.03810888]
Stock Position:  -0.03810888235755783
Bond Position:  [22.52381764]


portfolio before change:  [18.67858352]
curr_Stock_Price:  100.97514115985014
curr_Factors:  [100.97514116]
mat_Sqrt:  [[0.15]]
grads:  [0.04193363]
Stock Position:  0.04193363110954511
Bond Position:  [14.4443292]


portfolio before change:  [18.65531803]
curr_Stock_Price:  100.37726440816121
curr_Factors:  [100.37726441]
mat_Sqrt:  [[0.15]]
grads:  [0.044075]
Stock Position:  0.04407500074436785
Bond Position:  [14.23119002]


portfolio before change:  [18.64432077]
curr_Stock_Price:  100.08738873050862
curr_Factors:  [100.08738873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03993814]
Stock Position:  -0.039938137525226014
Bond Position:  [22.64162466]


portfolio before change:  [18.66349385]
curr_Stock_Price:  99.67818824111936
curr_Factors:  [99.67818824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02526744]
Stock Position:  -0.025267435423664962
Bond Position:  [21.18210604]


portfolio before change:  [18.64167288]
curr_Stock_Price:  100.6465850055458
curr_Factors:  [100.64658501]
mat_Sqrt:  [[0.15]]
grads:  [-0.0299134]
Stock Position:  -0.029913396704847908
Bond Position:  [21.6523541]


portfolio before change:  [18.62460151]
curr_Stock_Price:  101.30776304038608
curr_Factors:  [101.30776304]
mat_Sqrt:  [[0.15]]
grads:  [0.03397845]
Stock Position:  0.03397844999570919
Bond Position:  [15.18232075]


portfolio before change:  [18.59556794]
curr_Stock_Price:  100.39743655414118
curr_Factors:  [100.39743655]
mat_Sqrt:  [[0.15]]
grads:  [-0.05992976]
Stock Position:  -0.05992976052604161
Bond Position:  [24.61236227]


portfolio before change:  [18.59500926]
curr_Stock_Price:  100.45809779690308
curr_Factors:  [100.4580978]
mat_Sqrt:  [[0.15]]
grads:  [0.06378272]
Stock Position:  0.06378271702539969
Bond Position:  [12.18751883]


portfolio before change:  [18.57133]
curr_Stock_Price:  100.06296269863078
curr_Factors:  [100.0629627]
mat_Sqrt:  [[0.15]]
grads:  [0.05415448]
Stock Position:  0.054154483996258315
Bond Position:  [13.15247189]


portfolio before change:  [18.5828745]
curr_Stock_Price:  100.24577919512458
curr_Factors:  [100.2457792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150778]
Stock Position:  -0.03150778214721091
Bond Position:  [21.74139667]


portfolio before change:  [18.60634528]
curr_Stock_Price:  99.5871185086747
curr_Factors:  [99.58711851]
mat_Sqrt:  [[0.15]]
grads:  [-0.01436646]
Stock Position:  -0.014366455424905831
Bond Position:  [20.03705918]


portfolio before change:  [18.59816701]
curr_Stock_Price:  100.33072980699914
curr_Factors:  [100.33072981]
mat_Sqrt:  [[0.15]]
grads:  [0.00342813]
Stock Position:  0.003428127910250634
Bond Position:  [18.25422044]


portfolio before change:  [18.60002729]
curr_Stock_Price:  100.20773424827495
curr_Factors:  [100.20773425]
mat_Sqrt:  [[0.15]]
grads:  [-0.06038606]
Stock Position:  -0.060386061335105476
Bond Position:  [24.65117767]


portfolio before change:  [18.66744376]
curr_Stock_Price:  99.14234128612061
curr_Factors:  [99.14234129]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245051]
Stock Position:  -0.022450512068319606
Bond Position:  [20.89324009]


portfolio before change:  [18.62489579]
curr_Stock_Price:  101.15386730146643
curr_Factors:  [101.1538673]
mat_Sqrt:  [[0.15]]
grads:  [0.12310918]
Stock Position:  0.12310918218198824
Bond Position:  [6.17192591]


portfolio before change:  [18.53299321]
curr_Stock_Price:  100.4010874124139
curr_Factors:  [100.40108741]
mat_Sqrt:  [[0.15]]
grads:  [-0.04041749]
Stock Position:  -0.04041749059846664
Bond Position:  [22.59095322]


portfolio before change:  [18.51543946]
curr_Stock_Price:  100.90527007161941
curr_Factors:  [100.90527007]
mat_Sqrt:  [[0.15]]
grads:  [-0.12023238]
Stock Position:  -0.12023238477333903
Bond Position:  [30.64752072]


portfolio before change:  [18.58505127]
curr_Stock_Price:  100.3581576701285
curr_Factors:  [100.35815767]
mat_Sqrt:  [[0.15]]
grads:  [-0.14211621]
Stock Position:  -0.14211621233592783
Bond Position:  [32.84757251]


portfolio before change:  [18.63775879]
curr_Stock_Price:  100.0161747721318
curr_Factors:  [100.01617477]
mat_Sqrt:  [[0.15]]
grads:  [0.19201986]
Stock Position:  0.19201985509111327
Bond Position:  [-0.5673326]


portfolio before change:  [18.73900529]
curr_Stock_Price:  100.54381511770417
curr_Factors:  [100.54381512]
mat_Sqrt:  [[0.15]]
grads:  [0.02763219]
Stock Position:  0.02763218927980969
Bond Position:  [15.96075956]


portfolio before change:  [18.76647845]
curr_Stock_Price:  101.46585368860265
curr_Factors:  [101.46585369]
mat_Sqrt:  [[0.15]]
grads:  [0.09299085]
Stock Position:  0.09299084982129023
Bond Position:  [9.33108249]


portfolio before change:  [18.75444074]
curr_Stock_Price:  101.32385941496537
curr_Factors:  [101.32385941]
mat_Sqrt:  [[0.15]]
grads:  [0.0531817]
Stock Position:  0.05318169527104989
Bond Position:  [13.36586613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.79603425]
Stock Price:  102.0745437893137
PL:  [16.72149046]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.19355005416175575
FINAL STD P&L:  17.105666169022083
