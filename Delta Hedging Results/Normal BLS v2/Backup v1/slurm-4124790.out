WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 00:20:15.321299: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 00:20:15.352478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 00:20:15.354559: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:20:15.372425: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:20:15.391539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:20:15.435239: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:20:15.463535: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:20:15.477402: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:20:15.521419: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:20:15.523671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:20:15.524066: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 00:20:15.530819: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399830000 Hz
2019-12-17 00:20:15.531017: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b667df5030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:20:15.531036: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 00:20:15.532174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 00:20:15.532212: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:20:15.532226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:20:15.532238: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:20:15.532250: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:20:15.532261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:20:15.532273: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:20:15.532285: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:20:15.534318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:20:15.534349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:20:15.633923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 00:20:15.633955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 00:20:15.633965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 00:20:15.636918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-17 00:20:15.638939: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b66842e340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:20:15.638958: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 00:20:23.919699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4883e+02,   Y0: 2.2386e+00,  elapsed time   8
INFO   step:     1,    loss: 9.2151e+00,   Y0: 2.2336e+00,  elapsed time  11
INFO   step:     2,    loss: 9.2258e+00,   Y0: 2.2291e+00,  elapsed time  11
INFO   step:     3,    loss: 9.2015e+00,   Y0: 2.2244e+00,  elapsed time  11
INFO   step:     4,    loss: 9.1953e+00,   Y0: 2.2203e+00,  elapsed time  11
INFO   step:     5,    loss: 9.1919e+00,   Y0: 2.2159e+00,  elapsed time  11
INFO   step:     6,    loss: 9.1899e+00,   Y0: 2.2117e+00,  elapsed time  11
INFO   step:     7,    loss: 9.1889e+00,   Y0: 2.2073e+00,  elapsed time  11
INFO   step:     8,    loss: 9.1883e+00,   Y0: 2.2037e+00,  elapsed time  11
INFO   step:     9,    loss: 9.1875e+00,   Y0: 2.2000e+00,  elapsed time  11
INFO   step:    10,    loss: 9.1867e+00,   Y0: 2.1969e+00,  elapsed time  11
INFO   step:    11,    loss: 9.1860e+00,   Y0: 2.1941e+00,  elapsed time  11
INFO   step:    12,    loss: 9.1853e+00,   Y0: 2.1910e+00,  elapsed time  11
INFO   step:    13,    loss: 9.1847e+00,   Y0: 2.1879e+00,  elapsed time  11
INFO   step:    14,    loss: 9.1840e+00,   Y0: 2.1844e+00,  elapsed time  11
INFO   step:    15,    loss: 9.1835e+00,   Y0: 2.1808e+00,  elapsed time  12
INFO   step:    16,    loss: 9.1830e+00,   Y0: 2.1772e+00,  elapsed time  12
INFO   step:    17,    loss: 9.1824e+00,   Y0: 2.1739e+00,  elapsed time  12
INFO   step:    18,    loss: 9.1819e+00,   Y0: 2.1706e+00,  elapsed time  12
INFO   step:    19,    loss: 9.1814e+00,   Y0: 2.1674e+00,  elapsed time  12
INFO   step:    20,    loss: 9.1808e+00,   Y0: 2.1646e+00,  elapsed time  12
INFO   step:    21,    loss: 9.1803e+00,   Y0: 2.1617e+00,  elapsed time  12
INFO   step:    22,    loss: 9.1799e+00,   Y0: 2.1590e+00,  elapsed time  12
INFO   step:    23,    loss: 9.1794e+00,   Y0: 2.1566e+00,  elapsed time  12
INFO   step:    24,    loss: 9.1790e+00,   Y0: 2.1546e+00,  elapsed time  12
INFO   step:    25,    loss: 9.1785e+00,   Y0: 2.1524e+00,  elapsed time  12
INFO   step:    26,    loss: 9.1781e+00,   Y0: 2.1505e+00,  elapsed time  12
INFO   step:    27,    loss: 9.1777e+00,   Y0: 2.1494e+00,  elapsed time  12
INFO   step:    28,    loss: 9.1773e+00,   Y0: 2.1484e+00,  elapsed time  12
INFO   step:    29,    loss: 9.1768e+00,   Y0: 2.1469e+00,  elapsed time  12
INFO   step:    30,    loss: 9.1764e+00,   Y0: 2.1456e+00,  elapsed time  12
INFO   step:    31,    loss: 9.1760e+00,   Y0: 2.1443e+00,  elapsed time  12
INFO   step:    32,    loss: 9.1757e+00,   Y0: 2.1424e+00,  elapsed time  12
INFO   step:    33,    loss: 9.1753e+00,   Y0: 2.1408e+00,  elapsed time  12
INFO   step:    34,    loss: 9.1749e+00,   Y0: 2.1402e+00,  elapsed time  12
INFO   step:    35,    loss: 9.1745e+00,   Y0: 2.1399e+00,  elapsed time  12
INFO   step:    36,    loss: 9.1743e+00,   Y0: 2.1396e+00,  elapsed time  13
INFO   step:    37,    loss: 9.1743e+00,   Y0: 2.1397e+00,  elapsed time  13
INFO   step:    38,    loss: 9.1742e+00,   Y0: 2.1394e+00,  elapsed time  13
INFO   step:    39,    loss: 9.1741e+00,   Y0: 2.1390e+00,  elapsed time  13
INFO   step:    40,    loss: 9.1740e+00,   Y0: 2.1393e+00,  elapsed time  13
INFO   step:    41,    loss: 9.1737e+00,   Y0: 2.1404e+00,  elapsed time  13
INFO   step:    42,    loss: 9.1734e+00,   Y0: 2.1414e+00,  elapsed time  13
INFO   step:    43,    loss: 9.1732e+00,   Y0: 2.1423e+00,  elapsed time  13
INFO   step:    44,    loss: 9.1729e+00,   Y0: 2.1430e+00,  elapsed time  13
INFO   step:    45,    loss: 9.1726e+00,   Y0: 2.1440e+00,  elapsed time  13
INFO   step:    46,    loss: 9.1722e+00,   Y0: 2.1455e+00,  elapsed time  13
INFO   step:    47,    loss: 9.1718e+00,   Y0: 2.1462e+00,  elapsed time  13
INFO   step:    48,    loss: 9.1714e+00,   Y0: 2.1469e+00,  elapsed time  13
INFO   step:    49,    loss: 9.1710e+00,   Y0: 2.1472e+00,  elapsed time  13
INFO   step:    50,    loss: 9.1705e+00,   Y0: 2.1479e+00,  elapsed time  13
INFO   step:    51,    loss: 9.1701e+00,   Y0: 2.1486e+00,  elapsed time  13
INFO   step:    52,    loss: 9.1697e+00,   Y0: 2.1491e+00,  elapsed time  13
INFO   step:    53,    loss: 9.1693e+00,   Y0: 2.1492e+00,  elapsed time  13
INFO   step:    54,    loss: 9.1688e+00,   Y0: 2.1493e+00,  elapsed time  13
INFO   step:    55,    loss: 9.1684e+00,   Y0: 2.1492e+00,  elapsed time  13
INFO   step:    56,    loss: 9.1680e+00,   Y0: 2.1486e+00,  elapsed time  13
INFO   step:    57,    loss: 9.1675e+00,   Y0: 2.1482e+00,  elapsed time  14
INFO   step:    58,    loss: 9.1671e+00,   Y0: 2.1480e+00,  elapsed time  14
INFO   step:    59,    loss: 9.1667e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    60,    loss: 9.1663e+00,   Y0: 2.1469e+00,  elapsed time  14
INFO   step:    61,    loss: 9.1659e+00,   Y0: 2.1471e+00,  elapsed time  14
INFO   step:    62,    loss: 9.1656e+00,   Y0: 2.1471e+00,  elapsed time  14
INFO   step:    63,    loss: 9.1652e+00,   Y0: 2.1466e+00,  elapsed time  14
INFO   step:    64,    loss: 9.1648e+00,   Y0: 2.1463e+00,  elapsed time  14
INFO   step:    65,    loss: 9.1645e+00,   Y0: 2.1458e+00,  elapsed time  14
INFO   step:    66,    loss: 9.1641e+00,   Y0: 2.1455e+00,  elapsed time  14
INFO   step:    67,    loss: 9.1638e+00,   Y0: 2.1458e+00,  elapsed time  14
INFO   step:    68,    loss: 9.1634e+00,   Y0: 2.1454e+00,  elapsed time  14
INFO   step:    69,    loss: 9.1631e+00,   Y0: 2.1448e+00,  elapsed time  14
INFO   step:    70,    loss: 9.1628e+00,   Y0: 2.1437e+00,  elapsed time  14
INFO   step:    71,    loss: 9.1626e+00,   Y0: 2.1429e+00,  elapsed time  14
INFO   step:    72,    loss: 9.1623e+00,   Y0: 2.1423e+00,  elapsed time  14
INFO   step:    73,    loss: 9.1620e+00,   Y0: 2.1417e+00,  elapsed time  14
INFO   step:    74,    loss: 9.1617e+00,   Y0: 2.1415e+00,  elapsed time  14
INFO   step:    75,    loss: 9.1614e+00,   Y0: 2.1419e+00,  elapsed time  14
INFO   step:    76,    loss: 9.1611e+00,   Y0: 2.1417e+00,  elapsed time  14
INFO   step:    77,    loss: 9.1608e+00,   Y0: 2.1413e+00,  elapsed time  14
INFO   step:    78,    loss: 9.1605e+00,   Y0: 2.1415e+00,  elapsed time  15
INFO   step:    79,    loss: 9.1602e+00,   Y0: 2.1413e+00,  elapsed time  15
INFO   step:    80,    loss: 9.1600e+00,   Y0: 2.1410e+00,  elapsed time  15
INFO   step:    81,    loss: 9.1597e+00,   Y0: 2.1412e+00,  elapsed time  15
INFO   step:    82,    loss: 9.1594e+00,   Y0: 2.1411e+00,  elapsed time  15
INFO   step:    83,    loss: 9.1592e+00,   Y0: 2.1409e+00,  elapsed time  15
INFO   step:    84,    loss: 9.1589e+00,   Y0: 2.1409e+00,  elapsed time  15
INFO   step:    85,    loss: 9.1586e+00,   Y0: 2.1409e+00,  elapsed time  15
INFO   step:    86,    loss: 9.1584e+00,   Y0: 2.1410e+00,  elapsed time  15
INFO   step:    87,    loss: 9.1581e+00,   Y0: 2.1412e+00,  elapsed time  15
INFO   step:    88,    loss: 9.1578e+00,   Y0: 2.1416e+00,  elapsed time  15
INFO   step:    89,    loss: 9.1576e+00,   Y0: 2.1419e+00,  elapsed time  15
INFO   step:    90,    loss: 9.1573e+00,   Y0: 2.1430e+00,  elapsed time  15
INFO   step:    91,    loss: 9.1570e+00,   Y0: 2.1446e+00,  elapsed time  15
INFO   step:    92,    loss: 9.1567e+00,   Y0: 2.1461e+00,  elapsed time  15
INFO   step:    93,    loss: 9.1564e+00,   Y0: 2.1473e+00,  elapsed time  15
INFO   step:    94,    loss: 9.1561e+00,   Y0: 2.1483e+00,  elapsed time  15
INFO   step:    95,    loss: 9.1558e+00,   Y0: 2.1493e+00,  elapsed time  15
INFO   step:    96,    loss: 9.1556e+00,   Y0: 2.1505e+00,  elapsed time  15
INFO   step:    97,    loss: 9.1553e+00,   Y0: 2.1517e+00,  elapsed time  15
INFO   step:    98,    loss: 9.1550e+00,   Y0: 2.1529e+00,  elapsed time  15
INFO   step:    99,    loss: 9.1548e+00,   Y0: 2.1539e+00,  elapsed time  16
INFO   step:   100,    loss: 9.1545e+00,   Y0: 2.1558e+00,  elapsed time  16
INFO   step:   101,    loss: 9.1542e+00,   Y0: 2.1577e+00,  elapsed time  16
INFO   step:   102,    loss: 9.1540e+00,   Y0: 2.1595e+00,  elapsed time  16
INFO   step:   103,    loss: 9.1538e+00,   Y0: 2.1610e+00,  elapsed time  16
INFO   step:   104,    loss: 9.1535e+00,   Y0: 2.1634e+00,  elapsed time  16
INFO   step:   105,    loss: 9.1533e+00,   Y0: 2.1654e+00,  elapsed time  16
INFO   step:   106,    loss: 9.1531e+00,   Y0: 2.1676e+00,  elapsed time  16
INFO   step:   107,    loss: 9.1529e+00,   Y0: 2.1692e+00,  elapsed time  16
INFO   step:   108,    loss: 9.1527e+00,   Y0: 2.1713e+00,  elapsed time  16
INFO   step:   109,    loss: 9.1525e+00,   Y0: 2.1726e+00,  elapsed time  16
INFO   step:   110,    loss: 9.1523e+00,   Y0: 2.1734e+00,  elapsed time  16
INFO   step:   111,    loss: 9.1521e+00,   Y0: 2.1733e+00,  elapsed time  16
INFO   step:   112,    loss: 9.1518e+00,   Y0: 2.1732e+00,  elapsed time  16
INFO   step:   113,    loss: 9.1516e+00,   Y0: 2.1730e+00,  elapsed time  16
INFO   step:   114,    loss: 9.1514e+00,   Y0: 2.1724e+00,  elapsed time  16
INFO   step:   115,    loss: 9.1511e+00,   Y0: 2.1709e+00,  elapsed time  16
INFO   step:   116,    loss: 9.1509e+00,   Y0: 2.1701e+00,  elapsed time  16
INFO   step:   117,    loss: 9.1506e+00,   Y0: 2.1688e+00,  elapsed time  16
INFO   step:   118,    loss: 9.1504e+00,   Y0: 2.1669e+00,  elapsed time  16
INFO   step:   119,    loss: 9.1501e+00,   Y0: 2.1657e+00,  elapsed time  16
INFO   step:   120,    loss: 9.1499e+00,   Y0: 2.1643e+00,  elapsed time  17
INFO   step:   121,    loss: 9.1497e+00,   Y0: 2.1633e+00,  elapsed time  17
INFO   step:   122,    loss: 9.1494e+00,   Y0: 2.1621e+00,  elapsed time  17
INFO   step:   123,    loss: 9.1492e+00,   Y0: 2.1610e+00,  elapsed time  17
INFO   step:   124,    loss: 9.1490e+00,   Y0: 2.1603e+00,  elapsed time  17
INFO   step:   125,    loss: 9.1488e+00,   Y0: 2.1596e+00,  elapsed time  17
INFO   step:   126,    loss: 9.1486e+00,   Y0: 2.1596e+00,  elapsed time  17
INFO   step:   127,    loss: 9.1483e+00,   Y0: 2.1588e+00,  elapsed time  17
INFO   step:   128,    loss: 9.1481e+00,   Y0: 2.1583e+00,  elapsed time  17
INFO   step:   129,    loss: 9.1479e+00,   Y0: 2.1576e+00,  elapsed time  17
INFO   step:   130,    loss: 9.1477e+00,   Y0: 2.1572e+00,  elapsed time  17
INFO   step:   131,    loss: 9.1475e+00,   Y0: 2.1570e+00,  elapsed time  17
INFO   step:   132,    loss: 9.1473e+00,   Y0: 2.1565e+00,  elapsed time  17
INFO   step:   133,    loss: 9.1471e+00,   Y0: 2.1562e+00,  elapsed time  17
INFO   step:   134,    loss: 9.1469e+00,   Y0: 2.1563e+00,  elapsed time  17
INFO   step:   135,    loss: 9.1467e+00,   Y0: 2.1558e+00,  elapsed time  17
INFO   step:   136,    loss: 9.1464e+00,   Y0: 2.1552e+00,  elapsed time  17
INFO   step:   137,    loss: 9.1462e+00,   Y0: 2.1543e+00,  elapsed time  17
INFO   step:   138,    loss: 9.1460e+00,   Y0: 2.1533e+00,  elapsed time  17
INFO   step:   139,    loss: 9.1458e+00,   Y0: 2.1519e+00,  elapsed time  17
INFO   step:   140,    loss: 9.1457e+00,   Y0: 2.1501e+00,  elapsed time  17
INFO   step:   141,    loss: 9.1455e+00,   Y0: 2.1481e+00,  elapsed time  18
INFO   step:   142,    loss: 9.1453e+00,   Y0: 2.1468e+00,  elapsed time  18
INFO   step:   143,    loss: 9.1452e+00,   Y0: 2.1450e+00,  elapsed time  18
INFO   step:   144,    loss: 9.1450e+00,   Y0: 2.1441e+00,  elapsed time  18
INFO   step:   145,    loss: 9.1448e+00,   Y0: 2.1434e+00,  elapsed time  18
INFO   step:   146,    loss: 9.1446e+00,   Y0: 2.1429e+00,  elapsed time  18
INFO   step:   147,    loss: 9.1444e+00,   Y0: 2.1424e+00,  elapsed time  18
INFO   step:   148,    loss: 9.1442e+00,   Y0: 2.1423e+00,  elapsed time  18
INFO   step:   149,    loss: 9.1440e+00,   Y0: 2.1425e+00,  elapsed time  18
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  1
Loss out:  7.000789072189574
Output_Z_Vals:  [[[ 2.30314342e+00]
  [ 2.30314342e+00]
  [ 2.30314342e+00]
  ...
  [ 2.30314342e+00]
  [ 2.30314342e+00]
  [ 2.30314342e+00]]

 [[ 2.64948395e-02]
  [ 4.34176052e-03]
  [ 2.82317306e-02]
  ...
  [ 9.90577287e-03]
  [ 2.66222646e-02]
  [-2.62386470e-04]]

 [[ 6.84218802e-03]
  [ 3.47521338e-03]
  [ 2.38666585e-03]
  ...
  [ 6.92204927e-03]
  [ 3.62032235e-03]
  [ 7.05934840e-03]]

 ...

 [[ 2.03245733e-02]
  [ 1.35921006e-02]
  [ 8.25320933e-03]
  ...
  [ 2.04764311e-02]
  [ 2.36832862e-02]
  [ 1.68037668e-02]]

 [[ 1.49469094e-03]
  [ 8.12623760e-03]
  [ 2.39814368e-02]
  ...
  [ 1.34030162e-03]
  [ 3.02910208e-03]
  [ 1.59878149e-03]]

 [[-9.15415780e-04]
  [-5.53681675e-03]
  [-2.26870343e-03]
  ...
  [ 1.47876573e-03]
  [-5.31427779e-03]
  [ 3.80029321e-03]]]
Z_Vals dimensionality:  (10, 200, 1)
X_test:  [[[100.          99.54649114 100.18574474 ... 103.69720839 103.24114379
   102.87370365]]

 [[100.         101.00926494  97.92800061 ...  95.95279298  96.95739851
    96.96795864]]

 [[100.          99.3241651   96.56268485 ...  91.45549913  91.10203729
    89.12561096]]

 ...

 [[100.         100.25267327 101.93518875 ... 104.80596297 103.90836289
   102.9945043 ]]

 [[100.          99.53708509  98.11000421 ... 100.8594707  100.32643186
   100.39798245]]

 [[100.         101.74217591 101.29321419 ... 102.94967698 104.4658283
   105.17745012]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.64948395e-02]
 [ 6.84218802e-03]
 [-9.18860324e-04]
 [-9.84078208e-03]
 [ 1.01127161e-02]
 [ 1.64336561e-02]
 [ 2.03245733e-02]
 [ 1.49469094e-03]
 [-9.15415780e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.58695879]
curr_Stock_Price:  99.54649114346259
curr_Factors:  [99.54649114]
mat_Sqrt:  [[0.15]]
grads:  [0.17663226]
Stock Position:  0.17663226303798352
Bond Position:  [-23.17008079]


portfolio before change:  [-5.48563391]
curr_Stock_Price:  100.18574474018371
curr_Factors:  [100.18574474]
mat_Sqrt:  [[0.15]]
grads:  [0.04561459]
Stock Position:  0.04561458677935909
Bond Position:  [-10.05556526]


portfolio before change:  [-5.39338305]
curr_Stock_Price:  102.31839374342441
curr_Factors:  [102.31839374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612574]
Stock Position:  -0.006125735490575749
Bond Position:  [-4.76660763]


portfolio before change:  [-5.4013941]
curr_Stock_Price:  103.23700144442545
curr_Factors:  [103.23700144]
mat_Sqrt:  [[0.15]]
grads:  [-0.06560521]
Stock Position:  -0.06560521387483259
Bond Position:  [1.37149146]


portfolio before change:  [-5.34134361]
curr_Stock_Price:  102.33212565713092
curr_Factors:  [102.33212566]
mat_Sqrt:  [[0.15]]
grads:  [0.06741811]
Stock Position:  0.06741810756664939
Bond Position:  [-12.24038187]


portfolio before change:  [-5.25627254]
curr_Stock_Price:  103.68477106715916
curr_Factors:  [103.68477107]
mat_Sqrt:  [[0.15]]
grads:  [0.10955771]
Stock Position:  0.10955770729094037
Bond Position:  [-16.61573834]


portfolio before change:  [-5.26031164]
curr_Stock_Price:  103.72375369637162
curr_Factors:  [103.7237537]
mat_Sqrt:  [[0.15]]
grads:  [0.13549716]
Stock Position:  0.13549715503673448
Bond Position:  [-19.31458517]


portfolio before change:  [-5.27356816]
curr_Stock_Price:  103.69720839212415
curr_Factors:  [103.69720839]
mat_Sqrt:  [[0.15]]
grads:  [0.00996461]
Stock Position:  0.009964606298780635
Bond Position:  [-6.30687001]


portfolio before change:  [-5.28126689]
curr_Stock_Price:  103.24114379094488
curr_Factors:  [103.24114379]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.28126689]
Stock Price:  102.87370365182383
PL:  [-8.15497054]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.34176052e-03]
 [ 3.47521338e-03]
 [ 1.40191677e-03]
 [-4.75349948e-03]
 [ 8.30646524e-03]
 [ 1.64116899e-02]
 [ 1.35921006e-02]
 [ 8.12623760e-03]
 [-5.53681675e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.8728936]
curr_Stock_Price:  101.00926494313103
curr_Factors:  [101.00926494]
mat_Sqrt:  [[0.15]]
grads:  [0.02894507]
Stock Position:  0.02894507012528344
Bond Position:  [13.94917335]


portfolio before change:  [16.79068252]
curr_Stock_Price:  97.92800061076129
curr_Factors:  [97.92800061]
mat_Sqrt:  [[0.15]]
grads:  [0.02316809]
Stock Position:  0.023168089209260192
Bond Position:  [14.52187787]


portfolio before change:  [16.77610593]
curr_Stock_Price:  96.98535291591998
curr_Factors:  [96.98535292]
mat_Sqrt:  [[0.15]]
grads:  [0.00934611]
Stock Position:  0.009346111804025744
Bond Position:  [15.86966998]


portfolio before change:  [16.8003446]
curr_Stock_Price:  98.7295913187001
curr_Factors:  [98.72959132]
mat_Sqrt:  [[0.15]]
grads:  [-0.03169]
Stock Position:  -0.0316899965451525
Bond Position:  [19.929085]


portfolio before change:  [16.84438226]
curr_Stock_Price:  97.65446873933183
curr_Factors:  [97.65446874]
mat_Sqrt:  [[0.15]]
grads:  [0.05537643]
Stock Position:  0.05537643490831757
Bond Position:  [11.43662593]


portfolio before change:  [16.80796946]
curr_Stock_Price:  96.89362996562024
curr_Factors:  [96.89362997]
mat_Sqrt:  [[0.15]]
grads:  [0.10941127]
Stock Position:  0.1094112660979243
Bond Position:  [6.20671473]


portfolio before change:  [16.78840434]
curr_Stock_Price:  96.68643684211145
curr_Factors:  [96.68643684]
mat_Sqrt:  [[0.15]]
grads:  [0.090614]
Stock Position:  0.09061400376624029
Bond Position:  [8.02725918]


portfolio before change:  [16.72594056]
curr_Stock_Price:  95.95279298293073
curr_Factors:  [95.95279298]
mat_Sqrt:  [[0.15]]
grads:  [0.05417492]
Stock Position:  0.05417491735608723
Bond Position:  [11.52770593]


portfolio before change:  [16.78613028]
curr_Stock_Price:  96.95739851291272
curr_Factors:  [96.95739851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.78613028]
Stock Price:  96.96795863903631
PL:  [16.78613028]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.82317306e-02]
 [ 2.38666585e-03]
 [ 3.15091926e-03]
 [-4.92782682e-03]
 [ 1.41758306e-02]
 [ 1.66851382e-02]
 [ 8.25320933e-03]
 [ 2.39814368e-02]
 [-2.26870343e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.00061728]
curr_Stock_Price:  99.32416509630286
curr_Factors:  [99.3241651]
mat_Sqrt:  [[0.15]]
grads:  [0.18821154]
Stock Position:  0.18821153714223177
Bond Position:  [-27.69457107]


portfolio before change:  [-9.53421047]
curr_Stock_Price:  96.56268485251118
curr_Factors:  [96.56268485]
mat_Sqrt:  [[0.15]]
grads:  [0.01591111]
Stock Position:  0.01591110566319047
Bond Position:  [-11.07062955]


portfolio before change:  [-9.57304312]
curr_Stock_Price:  94.47006109678698
curr_Factors:  [94.4700611]
mat_Sqrt:  [[0.15]]
grads:  [0.02100613]
Stock Position:  0.021006128430333337
Bond Position:  [-11.55749336]


portfolio before change:  [-9.56307057]
curr_Stock_Price:  95.21997301096701
curr_Factors:  [95.21997301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03285218]
Stock Position:  -0.032852178800197106
Bond Position:  [-6.43488699]


portfolio before change:  [-9.53676127]
curr_Stock_Price:  94.3211726420161
curr_Factors:  [94.32117264]
mat_Sqrt:  [[0.15]]
grads:  [0.09450554]
Stock Position:  0.09450553760755649
Bond Position:  [-18.45063439]


portfolio before change:  [-9.6877717]
curr_Stock_Price:  92.82091332386653
curr_Factors:  [92.82091332]
mat_Sqrt:  [[0.15]]
grads:  [0.11123425]
Stock Position:  0.11123425488826312
Bond Position:  [-20.01263684]


portfolio before change:  [-9.8645875]
curr_Stock_Price:  91.32131253871373
curr_Factors:  [91.32131254]
mat_Sqrt:  [[0.15]]
grads:  [0.0550214]
Stock Position:  0.055021395555274376
Bond Position:  [-14.88921356]


portfolio before change:  [-9.86465083]
curr_Stock_Price:  91.45549912692331
curr_Factors:  [91.45549913]
mat_Sqrt:  [[0.15]]
grads:  [0.15987625]
Stock Position:  0.1598762452089065
Bond Position:  [-24.48621264]


portfolio before change:  [-9.93340715]
curr_Stock_Price:  91.10203729316306
curr_Factors:  [91.10203729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.93340715]
Stock Price:  89.12561096262321
PL:  [-9.93340715]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.48653438e-03]
 [ 6.92672698e-03]
 [ 1.97213339e-03]
 [-4.71823509e-03]
 [ 8.95530242e-03]
 [ 1.66444573e-02]
 [ 1.14820062e-02]
 [ 9.37216994e-03]
 [-4.09227898e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.58688884]
curr_Stock_Price:  100.27422573711438
curr_Factors:  [100.27422574]
mat_Sqrt:  [[0.15]]
grads:  [0.06324356]
Stock Position:  0.0632435625105404
Bond Position:  [-0.75481042]


portfolio before change:  [5.61702192]
curr_Stock_Price:  100.75665558211725
curr_Factors:  [100.75665558]
mat_Sqrt:  [[0.15]]
grads:  [0.04617818]
Stock Position:  0.04617817984129203
Bond Position:  [0.96426296]


portfolio before change:  [5.54973179]
curr_Stock_Price:  99.28902775797734
curr_Factors:  [99.28902776]
mat_Sqrt:  [[0.15]]
grads:  [0.01314756]
Stock Position:  0.013147555945629021
Bond Position:  [4.24432375]


portfolio before change:  [5.54316736]
curr_Stock_Price:  98.62828693099745
curr_Factors:  [98.62828693]
mat_Sqrt:  [[0.15]]
grads:  [-0.0314549]
Stock Position:  -0.03145490061643632
Bond Position:  [8.64551032]


portfolio before change:  [5.59879734]
curr_Stock_Price:  96.99718505493912
curr_Factors:  [96.99718505]
mat_Sqrt:  [[0.15]]
grads:  [0.05970202]
Stock Position:  0.059702016105023716
Bond Position:  [-0.19213016]


portfolio before change:  [5.39543791]
curr_Stock_Price:  93.59255385897148
curr_Factors:  [93.59255386]
mat_Sqrt:  [[0.15]]
grads:  [0.11096305]
Stock Position:  0.110963048640862
Bond Position:  [-4.9898772]


portfolio before change:  [5.4891718]
curr_Stock_Price:  94.45977461705039
curr_Factors:  [94.45977462]
mat_Sqrt:  [[0.15]]
grads:  [0.07654671]
Stock Position:  0.0765467082728317
Bond Position:  [-1.74141301]


portfolio before change:  [5.57553445]
curr_Stock_Price:  95.59938689844184
curr_Factors:  [95.5993869]
mat_Sqrt:  [[0.15]]
grads:  [0.06248113]
Stock Position:  0.06248113295990924
Bond Position:  [-0.39762355]


portfolio before change:  [5.50998831]
curr_Stock_Price:  94.5535147433882
curr_Factors:  [94.55351474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.50998831]
Stock Price:  92.30880092852742
PL:  [5.50998831]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.76734439e-02]
 [ 3.68050003e-03]
 [ 1.21057541e-03]
 [-4.83933704e-03]
 [ 1.12475825e-02]
 [ 1.65201121e-02]
 [ 1.25219532e-02]
 [ 9.62655973e-03]
 [-4.27407803e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.92278603]
curr_Stock_Price:  99.45949087907672
curr_Factors:  [99.45949088]
mat_Sqrt:  [[0.15]]
grads:  [0.18448963]
Stock Position:  0.18448962580271117
Bond Position:  [-25.27203029]


portfolio before change:  [-7.17046657]
curr_Stock_Price:  98.18548233999252
curr_Factors:  [98.18548234]
mat_Sqrt:  [[0.15]]
grads:  [0.02453667]
Stock Position:  0.02453666688893146
Bond Position:  [-9.57961104]


portfolio before change:  [-7.1979529]
curr_Stock_Price:  97.26052654117233
curr_Factors:  [97.26052654]
mat_Sqrt:  [[0.15]]
grads:  [0.0080705]
Stock Position:  0.008070502739042773
Bond Position:  [-7.98289425]


portfolio before change:  [-7.20894077]
curr_Stock_Price:  96.39373684788535
curr_Factors:  [96.39373685]
mat_Sqrt:  [[0.15]]
grads:  [-0.03226225]
Stock Position:  -0.03226224691757846
Bond Position:  [-4.09906224]


portfolio before change:  [-7.19194595]
curr_Stock_Price:  95.80342240155356
curr_Factors:  [95.8034224]
mat_Sqrt:  [[0.15]]
grads:  [0.07498388]
Stock Position:  0.0749838835334096
Bond Position:  [-14.37565862]


portfolio before change:  [-7.20299961]
curr_Stock_Price:  95.75189090181068
curr_Factors:  [95.7518909]
mat_Sqrt:  [[0.15]]
grads:  [0.11013408]
Stock Position:  0.11013408088532395
Bond Position:  [-17.7485461]


portfolio before change:  [-7.262503]
curr_Stock_Price:  95.29220669068016
curr_Factors:  [95.29220669]
mat_Sqrt:  [[0.15]]
grads:  [0.08347969]
Stock Position:  0.0834796877481421
Bond Position:  [-15.21746666]


portfolio before change:  [-7.25049398]
curr_Stock_Price:  95.52722977013899
curr_Factors:  [95.52722977]
mat_Sqrt:  [[0.15]]
grads:  [0.06417706]
Stock Position:  0.06417706489583765
Bond Position:  [-13.3811512]


portfolio before change:  [-7.29759367]
curr_Stock_Price:  94.8976054075295
curr_Factors:  [94.89760541]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.29759367]
Stock Price:  95.32886773675047
PL:  [-7.29759367]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.98847389e-02]
 [ 7.04491802e-03]
 [ 8.32977329e-04]
 [-7.58298983e-03]
 [ 1.21661385e-02]
 [ 1.62043801e-02]
 [ 2.19365647e-02]
 [ 3.66649359e-03]
 [-5.79618122e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.27780246]
curr_Stock_Price:  99.89226789360262
curr_Factors:  [99.89226789]
mat_Sqrt:  [[0.15]]
grads:  [0.13256493]
Stock Position:  0.1325649257320617
Bond Position:  [-13.52001354]


portfolio before change:  [-0.13064209]
curr_Stock_Price:  101.05337491312808
curr_Factors:  [101.05337491]
mat_Sqrt:  [[0.15]]
grads:  [0.04696612]
Stock Position:  0.046966120123128355
Bond Position:  [-4.87672704]


portfolio before change:  [-0.16467342]
curr_Stock_Price:  100.38071236848222
curr_Factors:  [100.38071237]
mat_Sqrt:  [[0.15]]
grads:  [0.00555318]
Stock Position:  0.005553182190317882
Bond Position:  [-0.7221058]


portfolio before change:  [-0.15968504]
curr_Stock_Price:  101.34403835096684
curr_Factors:  [101.34403835]
mat_Sqrt:  [[0.15]]
grads:  [-0.05055327]
Stock Position:  -0.050553265540405026
Bond Position:  [4.96358705]


portfolio before change:  [-0.1330752]
curr_Stock_Price:  100.86677098487642
curr_Factors:  [100.86677098]
mat_Sqrt:  [[0.15]]
grads:  [0.08110759]
Stock Position:  0.08110759011660916
Bond Position:  [-8.31413592]


portfolio before change:  [-0.02933626]
curr_Stock_Price:  102.19706626901122
curr_Factors:  [102.19706627]
mat_Sqrt:  [[0.15]]
grads:  [0.1080292]
Stock Position:  0.1080292005989608
Bond Position:  [-11.06960363]


portfolio before change:  [-0.18713251]
curr_Stock_Price:  100.78763196275877
curr_Factors:  [100.78763196]
mat_Sqrt:  [[0.15]]
grads:  [0.14624376]
Stock Position:  0.14624376442075426
Bond Position:  [-14.92669521]


portfolio before change:  [-0.36217315]
curr_Stock_Price:  99.6417682434051
curr_Factors:  [99.64176824]
mat_Sqrt:  [[0.15]]
grads:  [0.02444329]
Stock Position:  0.02444329059847559
Bond Position:  [-2.79774584]


portfolio before change:  [-0.35406412]
curr_Stock_Price:  100.03076055008417
curr_Factors:  [100.03076055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.35406412]
Stock Price:  99.15151661179054
PL:  [-0.35406412]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.83898197e-03]
 [ 6.62566741e-03]
 [ 1.37440820e-04]
 [-6.69548586e-03]
 [ 1.37307902e-02]
 [ 1.60716728e-02]
 [ 2.29769504e-02]
 [ 1.38782544e-03]
 [ 2.04356053e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.21616608]
curr_Stock_Price:  100.44546630416326
curr_Factors:  [100.4454663]
mat_Sqrt:  [[0.15]]
grads:  [0.04559321]
Stock Position:  0.04559321310187453
Bond Position:  [3.63653453]


portfolio before change:  [8.20010991]
curr_Stock_Price:  100.0534146897947
curr_Factors:  [100.05341469]
mat_Sqrt:  [[0.15]]
grads:  [0.04417112]
Stock Position:  0.04417111604055186
Bond Position:  [3.78063892]


portfolio before change:  [8.22440764]
curr_Stock_Price:  100.56069037472673
curr_Factors:  [100.56069037]
mat_Sqrt:  [[0.15]]
grads:  [0.00091627]
Stock Position:  0.0009162721358434713
Bond Position:  [8.13226668]


portfolio before change:  [8.2284763]
curr_Stock_Price:  100.56234573745677
curr_Factors:  [100.56234574]
mat_Sqrt:  [[0.15]]
grads:  [-0.04463657]
Stock Position:  -0.04463657240718371
Bond Position:  [12.71723473]


portfolio before change:  [8.2533096]
curr_Stock_Price:  100.14849029747151
curr_Factors:  [100.1484903]
mat_Sqrt:  [[0.15]]
grads:  [0.0915386]
Stock Position:  0.09153860134801609
Bond Position:  [-0.91414313]


portfolio before change:  [8.36480724]
curr_Stock_Price:  101.37152436329006
curr_Factors:  [101.37152436]
mat_Sqrt:  [[0.15]]
grads:  [0.10714449]
Stock Position:  0.10714448516757974
Bond Position:  [-2.49659255]


portfolio before change:  [8.33429852]
curr_Stock_Price:  101.09843414462398
curr_Factors:  [101.09843414]
mat_Sqrt:  [[0.15]]
grads:  [0.15317967]
Stock Position:  0.15317966919598988
Bond Position:  [-7.15192618]


portfolio before change:  [8.8463603]
curr_Stock_Price:  104.46466831653456
curr_Factors:  [104.46466832]
mat_Sqrt:  [[0.15]]
grads:  [0.00925217]
Stock Position:  0.009252169590937338
Bond Position:  [7.87983547]


portfolio before change:  [8.84661045]
curr_Stock_Price:  104.06576192965876
curr_Factors:  [104.06576193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.84661045]
Stock Price:  103.5204158151973
PL:  [5.32619464]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 8.49570982e-03]
 [ 4.55344484e-03]
 [ 1.38779114e-03]
 [-5.51501706e-03]
 [ 1.21305614e-02]
 [ 1.61079489e-02]
 [ 2.37303904e-02]
 [ 1.66031249e-03]
 [-3.86802969e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.36898886]
curr_Stock_Price:  100.32516264453048
curr_Factors:  [100.32516264]
mat_Sqrt:  [[0.15]]
grads:  [0.05663807]
Stock Position:  0.05663806549877029
Bond Position:  [0.68676573]


portfolio before change:  [6.28977926]
curr_Stock_Price:  98.92057591049542
curr_Factors:  [98.92057591]
mat_Sqrt:  [[0.15]]
grads:  [0.0303563]
Stock Position:  0.03035629891244053
Bond Position:  [3.28691669]


portfolio before change:  [6.29420154]
curr_Stock_Price:  99.01210253693033
curr_Factors:  [99.01210254]
mat_Sqrt:  [[0.15]]
grads:  [0.00925194]
Stock Position:  0.00925194093294639
Bond Position:  [5.37814741]


portfolio before change:  [6.303188]
curr_Stock_Price:  99.6926855870197
curr_Factors:  [99.69268559]
mat_Sqrt:  [[0.15]]
grads:  [-0.03676678]
Stock Position:  -0.03676678036722554
Bond Position:  [9.96856707]


portfolio before change:  [6.26396424]
curr_Stock_Price:  100.89511045255928
curr_Factors:  [100.89511045]
mat_Sqrt:  [[0.15]]
grads:  [0.08087041]
Stock Position:  0.08087040954557517
Bond Position:  [-1.89546467]


portfolio before change:  [6.32542533]
curr_Stock_Price:  101.66682741886218
curr_Factors:  [101.66682742]
mat_Sqrt:  [[0.15]]
grads:  [0.10738633]
Stock Position:  0.10738632587637773
Bond Position:  [-4.59220173]


portfolio before change:  [6.41271415]
curr_Stock_Price:  102.50106293388693
curr_Factors:  [102.50106293]
mat_Sqrt:  [[0.15]]
grads:  [0.1582026]
Stock Position:  0.15820260283014542
Bond Position:  [-9.8032208]


portfolio before change:  [6.4088754]
curr_Stock_Price:  102.5077890868877
curr_Factors:  [102.50778909]
mat_Sqrt:  [[0.15]]
grads:  [0.01106875]
Stock Position:  0.01106874991216727
Bond Position:  [5.27424232]


portfolio before change:  [6.40154337]
curr_Stock_Price:  101.60707188263927
curr_Factors:  [101.60707188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.40154337]
Stock Price:  99.87035178006356
PL:  [6.40154337]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.72953376e-02]
 [ 3.82245324e-03]
 [-6.53895932e-05]
 [-6.93644466e-03]
 [ 9.85628713e-03]
 [ 1.61229652e-02]
 [ 1.73220125e-02]
 [ 3.55416192e-03]
 [-4.56898184e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.17629291]
curr_Stock_Price:  98.98708172745201
curr_Factors:  [98.98708173]
mat_Sqrt:  [[0.15]]
grads:  [0.11530225]
Stock Position:  0.11530225046146243
Bond Position:  [-25.5897262]


portfolio before change:  [-14.26570903]
curr_Stock_Price:  98.32258421711522
curr_Factors:  [98.32258422]
mat_Sqrt:  [[0.15]]
grads:  [0.02548302]
Stock Position:  0.025483021594144523
Bond Position:  [-16.77126556]


portfolio before change:  [-14.20494933]
curr_Stock_Price:  101.03605463778638
curr_Factors:  [101.03605464]
mat_Sqrt:  [[0.15]]
grads:  [-0.00043593]
Stock Position:  -0.00043593062108112756
Bond Position:  [-14.16090462]


portfolio before change:  [-14.21192434]
curr_Stock_Price:  100.79011951152685
curr_Factors:  [100.79011951]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624296]
Stock Position:  -0.04624296438857484
Bond Position:  [-9.55109044]


portfolio before change:  [-14.29081384]
curr_Stock_Price:  102.39280120979768
curr_Factors:  [102.39280121]
mat_Sqrt:  [[0.15]]
grads:  [0.06570858]
Stock Position:  0.06570858085546002
Bond Position:  [-21.01889949]


portfolio before change:  [-14.34163828]
curr_Stock_Price:  101.77929894904426
curr_Factors:  [101.77929895]
mat_Sqrt:  [[0.15]]
grads:  [0.10748643]
Stock Position:  0.1074864349178415
Bond Position:  [-25.28153227]


portfolio before change:  [-14.62496708]
curr_Stock_Price:  99.26098236306144
curr_Factors:  [99.26098236]
mat_Sqrt:  [[0.15]]
grads:  [0.11548008]
Stock Position:  0.11548008361313945
Bond Position:  [-26.08763362]


portfolio before change:  [-14.5153159]
curr_Stock_Price:  100.32348809690414
curr_Factors:  [100.3234881]
mat_Sqrt:  [[0.15]]
grads:  [0.02369441]
Stock Position:  0.02369441277177926
Bond Position:  [-16.89242204]


portfolio before change:  [-14.50559602]
curr_Stock_Price:  101.09025977231555
curr_Factors:  [101.09025977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.50559602]
Stock Price:  102.11431793265619
PL:  [-16.61991395]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.46921112e-02]
 [ 7.02831601e-03]
 [ 4.45061212e-05]
 [-9.04906997e-03]
 [ 3.66664661e-03]
 [ 1.64236925e-02]
 [ 1.13262414e-02]
 [ 1.27781263e-03]
 [ 1.44007698e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.93106273]
curr_Stock_Price:  99.65433697118362
curr_Factors:  [99.65433697]
mat_Sqrt:  [[0.15]]
grads:  [0.16461407]
Stock Position:  0.1646140744383339
Bond Position:  [-20.33556917]


portfolio before change:  [-3.71779274]
curr_Stock_Price:  101.01169546085362
curr_Factors:  [101.01169546]
mat_Sqrt:  [[0.15]]
grads:  [0.04685544]
Stock Position:  0.046855440042865154
Bond Position:  [-8.45074018]


portfolio before change:  [-3.74001954]
curr_Stock_Price:  100.62752728632631
curr_Factors:  [100.62752729]
mat_Sqrt:  [[0.15]]
grads:  [0.00029671]
Stock Position:  0.0002967074747805415
Bond Position:  [-3.76987648]


portfolio before change:  [-3.74132502]
curr_Stock_Price:  102.5820596399817
curr_Factors:  [102.58205964]
mat_Sqrt:  [[0.15]]
grads:  [-0.06032713]
Stock Position:  -0.06032713316174855
Bond Position:  [2.44715655]


portfolio before change:  [-3.81760702]
curr_Stock_Price:  103.86681961486303
curr_Factors:  [103.86681961]
mat_Sqrt:  [[0.15]]
grads:  [0.02444431]
Stock Position:  0.02444431075385878
Bond Position:  [-6.35655984]


portfolio before change:  [-3.781023]
curr_Stock_Price:  105.49350057531997
curr_Factors:  [105.49350058]
mat_Sqrt:  [[0.15]]
grads:  [0.10949128]
Stock Position:  0.10949128308198489
Bond Position:  [-15.33164174]


portfolio before change:  [-3.66800732]
curr_Stock_Price:  106.59571999481611
curr_Factors:  [106.59571999]
mat_Sqrt:  [[0.15]]
grads:  [0.07550828]
Stock Position:  0.07550827600996668
Bond Position:  [-11.71686637]


portfolio before change:  [-3.7574798]
curr_Stock_Price:  105.48838994223478
curr_Factors:  [105.48838994]
mat_Sqrt:  [[0.15]]
grads:  [0.00851875]
Stock Position:  0.008518750854057329
Bond Position:  [-4.65610912]


portfolio before change:  [-3.75014171]
curr_Stock_Price:  106.62314905158327
curr_Factors:  [106.62314905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.75014171]
Stock Price:  105.52042423802524
PL:  [-9.27056595]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.94812539e-02]
 [ 7.04403810e-03]
 [ 3.51200187e-05]
 [-8.20911200e-03]
 [ 9.21017169e-03]
 [ 1.61733491e-02]
 [ 2.22486512e-02]
 [ 1.57758117e-03]
 [-4.66617850e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.23293041]
curr_Stock_Price:  98.00646731984295
curr_Factors:  [98.00646732]
mat_Sqrt:  [[0.15]]
grads:  [-0.12987503]
Stock Position:  -0.12987502617626281
Bond Position:  [-16.5043379]


portfolio before change:  [-29.67734833]
curr_Stock_Price:  101.36480109102429
curr_Factors:  [101.36480109]
mat_Sqrt:  [[0.15]]
grads:  [0.04696025]
Stock Position:  0.04696025403207893
Bond Position:  [-34.43746513]


portfolio before change:  [-29.7283176]
curr_Stock_Price:  100.64618836734775
curr_Factors:  [100.64618837]
mat_Sqrt:  [[0.15]]
grads:  [0.00023413]
Stock Position:  0.00023413345795950954
Bond Position:  [-29.75188224]


portfolio before change:  [-29.74290828]
curr_Stock_Price:  101.88046005441882
curr_Factors:  [101.88046005]
mat_Sqrt:  [[0.15]]
grads:  [-0.05472741]
Stock Position:  -0.054727413306517037
Bond Position:  [-24.16725423]


portfolio before change:  [-29.79140087]
curr_Stock_Price:  102.54568333520798
curr_Factors:  [102.54568334]
mat_Sqrt:  [[0.15]]
grads:  [0.06140114]
Stock Position:  0.06140114457238832
Bond Position:  [-36.0878232]


portfolio before change:  [-29.84023764]
curr_Stock_Price:  102.04425388468339
curr_Factors:  [102.04425388]
mat_Sqrt:  [[0.15]]
grads:  [0.10782233]
Stock Position:  0.10782232741264289
Bond Position:  [-40.84288659]


portfolio before change:  [-29.9861036]
curr_Stock_Price:  100.88086390816447
curr_Factors:  [100.88086391]
mat_Sqrt:  [[0.15]]
grads:  [0.14832434]
Stock Position:  0.14832434149863438
Bond Position:  [-44.94919131]


portfolio before change:  [-29.67914593]
curr_Stock_Price:  103.1019281392292
curr_Factors:  [103.10192814]
mat_Sqrt:  [[0.15]]
grads:  [0.01051721]
Stock Position:  0.010517207796432018
Bond Position:  [-30.76349033]


portfolio before change:  [-29.71863886]
curr_Stock_Price:  100.80974780851294
curr_Factors:  [100.80974781]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.71863886]
Stock Price:  101.27797534508996
PL:  [-30.9966142]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.83670738e-02]
 [ 7.05225180e-03]
 [-2.21498121e-04]
 [-6.73866659e-03]
 [ 9.02597855e-03]
 [ 1.62562712e-02]
 [ 1.38705216e-02]
 [ 3.53412636e-03]
 [-4.58864554e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.70894448]
curr_Stock_Price:  99.40828965316689
curr_Factors:  [99.40828965]
mat_Sqrt:  [[0.15]]
grads:  [0.18911383]
Stock Position:  0.1891138256118986
Bond Position:  [-26.50842643]


portfolio before change:  [-7.35946157]
curr_Stock_Price:  101.32639603153129
curr_Factors:  [101.32639603]
mat_Sqrt:  [[0.15]]
grads:  [0.04701501]
Stock Position:  0.047015011978056395
Bond Position:  [-12.12332329]


portfolio before change:  [-7.35462538]
curr_Stock_Price:  101.55822336869207
curr_Factors:  [101.55822337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00147665]
Stock Position:  -0.0014766541425317498
Bond Position:  [-7.20465901]


portfolio before change:  [-7.35682745]
curr_Stock_Price:  100.60934869214445
curr_Factors:  [100.60934869]
mat_Sqrt:  [[0.15]]
grads:  [-0.04492444]
Stock Position:  -0.04492444396251629
Bond Position:  [-2.8370084]


portfolio before change:  [-7.25930773]
curr_Stock_Price:  98.40701578177067
curr_Factors:  [98.40701578]
mat_Sqrt:  [[0.15]]
grads:  [0.06017319]
Stock Position:  0.060173190319795164
Bond Position:  [-13.18077182]


portfolio before change:  [-7.27756436]
curr_Stock_Price:  98.21316531468463
curr_Factors:  [98.21316531]
mat_Sqrt:  [[0.15]]
grads:  [0.10837514]
Stock Position:  0.10837514106057093
Bond Position:  [-17.92143001]


portfolio before change:  [-7.31617038]
curr_Stock_Price:  97.93964260934561
curr_Factors:  [97.93964261]
mat_Sqrt:  [[0.15]]
grads:  [0.09247014]
Stock Position:  0.0924701441409749
Bond Position:  [-16.37266325]


portfolio before change:  [-7.29068734]
curr_Stock_Price:  98.30377551214673
curr_Factors:  [98.30377551]
mat_Sqrt:  [[0.15]]
grads:  [0.02356084]
Stock Position:  0.02356084237387569
Bond Position:  [-9.6068071]


portfolio before change:  [-7.23498938]
curr_Stock_Price:  100.87170424462632
curr_Factors:  [100.87170424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.23498938]
Stock Price:  102.6731488721018
PL:  [-9.90813825]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.84516475e-03]
 [ 6.68001050e-03]
 [-1.79592068e-03]
 [-1.19207972e-02]
 [ 1.90663287e-03]
 [ 1.61647204e-02]
 [ 2.01573807e-02]
 [ 3.63248634e-03]
 [-4.56882340e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [51.7187069]
curr_Stock_Price:  103.27871631078614
curr_Factors:  [103.27871631]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896777]
Stock Position:  -0.0189677650108479
Bond Position:  [53.67767332]


portfolio before change:  [51.74504837]
curr_Stock_Price:  103.3052919609913
curr_Factors:  [103.30529196]
mat_Sqrt:  [[0.15]]
grads:  [0.0445334]
Stock Position:  0.04453340334563566
Bond Position:  [47.14451213]


portfolio before change:  [51.74961582]
curr_Stock_Price:  102.87840561106826
curr_Factors:  [102.87840561]
mat_Sqrt:  [[0.15]]
grads:  [-0.0119728]
Stock Position:  -0.011972804504641619
Bond Position:  [52.98135885]


portfolio before change:  [51.75121827]
curr_Stock_Price:  104.95768862653433
curr_Factors:  [104.95768863]
mat_Sqrt:  [[0.15]]
grads:  [-0.07947198]
Stock Position:  -0.07947198152887348
Bond Position:  [60.09241376]


portfolio before change:  [51.82804086]
curr_Stock_Price:  104.36919351237482
curr_Factors:  [104.36919351]
mat_Sqrt:  [[0.15]]
grads:  [0.01271089]
Stock Position:  0.012710885789558181
Bond Position:  [50.50141596]


portfolio before change:  [51.82320573]
curr_Stock_Price:  102.00176183486141
curr_Factors:  [102.00176183]
mat_Sqrt:  [[0.15]]
grads:  [0.1077648]
Stock Position:  0.10776480284892041
Bond Position:  [40.83100598]


portfolio before change:  [51.64156888]
curr_Stock_Price:  100.12677615685291
curr_Factors:  [100.12677616]
mat_Sqrt:  [[0.15]]
grads:  [0.13438254]
Stock Position:  0.13438253791895274
Bond Position:  [38.18627858]


portfolio before change:  [51.66656703]
curr_Stock_Price:  100.17068244431182
curr_Factors:  [100.17068244]
mat_Sqrt:  [[0.15]]
grads:  [0.02421658]
Stock Position:  0.024216575566782597
Bond Position:  [49.24077613]


portfolio before change:  [51.71511146]
curr_Stock_Price:  101.15834857727285
curr_Factors:  [101.15834858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [51.71511146]
Stock Price:  100.2642003845062
PL:  [51.45091108]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.52375585e-02]
 [ 7.04729839e-03]
 [-1.21435272e-04]
 [-5.20606478e-03]
 [ 1.31063797e-02]
 [ 1.59866147e-02]
 [ 1.44781466e-02]
 [ 3.30122172e-03]
 [-6.52526463e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.43656714]
curr_Stock_Price:  99.23064400811676
curr_Factors:  [99.23064401]
mat_Sqrt:  [[0.15]]
grads:  [0.16825039]
Stock Position:  0.16825039021231744
Bond Position:  [-27.13216171]


portfolio before change:  [-10.14245597]
curr_Stock_Price:  101.05935085677736
curr_Factors:  [101.05935086]
mat_Sqrt:  [[0.15]]
grads:  [0.04698199]
Stock Position:  0.04698198928374967
Bond Position:  [-14.89042531]


portfolio before change:  [-10.14218994]
curr_Stock_Price:  101.22352230235566
curr_Factors:  [101.2235223]
mat_Sqrt:  [[0.15]]
grads:  [-0.00080957]
Stock Position:  -0.0008095684827169285
Bond Position:  [-10.06024257]


portfolio before change:  [-10.14574611]
curr_Stock_Price:  99.40129663505714
curr_Factors:  [99.40129664]
mat_Sqrt:  [[0.15]]
grads:  [-0.0347071]
Stock Position:  -0.03470709856585365
Bond Position:  [-6.69581551]


portfolio before change:  [-10.15821948]
curr_Stock_Price:  99.66420042207196
curr_Factors:  [99.66420042]
mat_Sqrt:  [[0.15]]
grads:  [0.08737586]
Stock Position:  0.08737586467091273
Bond Position:  [-18.86646517]


portfolio before change:  [-10.19788763]
curr_Stock_Price:  99.31819452912066
curr_Factors:  [99.31819453]
mat_Sqrt:  [[0.15]]
grads:  [0.10657743]
Stock Position:  0.10657743164060852
Bond Position:  [-20.78296572]


portfolio before change:  [-10.33041241]
curr_Stock_Price:  98.17226063096416
curr_Factors:  [98.17226063]
mat_Sqrt:  [[0.15]]
grads:  [0.09652098]
Stock Position:  0.09652097707968384
Bond Position:  [-19.80609493]


portfolio before change:  [-10.10671994]
curr_Stock_Price:  100.59243913520322
curr_Factors:  [100.59243914]
mat_Sqrt:  [[0.15]]
grads:  [0.02200814]
Stock Position:  0.022008144833021426
Bond Position:  [-12.32057291]


portfolio before change:  [-10.17607888]
curr_Stock_Price:  97.72090606236219
curr_Factors:  [97.72090606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.17607888]
Stock Price:  98.19877835687727
PL:  [-10.17607888]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.84844881e-02]
 [ 4.45635941e-03]
 [ 2.24724724e-03]
 [-4.92802904e-03]
 [ 1.37434621e-02]
 [ 1.65977052e-02]
 [ 1.02081899e-02]
 [ 1.72277778e-02]
 [-3.05217625e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.86250887]
curr_Stock_Price:  97.7049503746703
curr_Factors:  [97.70495037]
mat_Sqrt:  [[0.15]]
grads:  [-0.18989659]
Stock Position:  -0.18989658738623447
Bond Position:  [-15.30867222]


portfolio before change:  [-34.08677338]
curr_Stock_Price:  98.8456146963952
curr_Factors:  [98.8456147]
mat_Sqrt:  [[0.15]]
grads:  [0.02970906]
Stock Position:  0.02970906276320146
Bond Position:  [-37.02338395]


portfolio before change:  [-34.19667348]
curr_Stock_Price:  95.76965836307944
curr_Factors:  [95.76965836]
mat_Sqrt:  [[0.15]]
grads:  [0.01498165]
Stock Position:  0.014981648241908289
Bond Position:  [-35.63146082]


portfolio before change:  [-34.22276905]
curr_Stock_Price:  95.21729062119235
curr_Factors:  [95.21729062]
mat_Sqrt:  [[0.15]]
grads:  [-0.03285353]
Stock Position:  -0.03285352696513448
Bond Position:  [-31.09454522]


portfolio before change:  [-34.21606991]
curr_Stock_Price:  94.54003325230413
curr_Factors:  [94.54003325]
mat_Sqrt:  [[0.15]]
grads:  [0.09162308]
Stock Position:  0.09162308065520533
Bond Position:  [-42.87811901]


portfolio before change:  [-34.24307409]
curr_Stock_Price:  94.47935253860555
curr_Factors:  [94.47935254]
mat_Sqrt:  [[0.15]]
grads:  [0.11065137]
Stock Position:  0.11065136809640863
Bond Position:  [-44.6973437]


portfolio before change:  [-34.38149653]
curr_Stock_Price:  93.43039863939009
curr_Factors:  [93.43039864]
mat_Sqrt:  [[0.15]]
grads:  [0.0680546]
Stock Position:  0.06805459925953222
Bond Position:  [-40.73986487]


portfolio before change:  [-34.405903]
curr_Stock_Price:  93.37116026050575
curr_Factors:  [93.37116026]
mat_Sqrt:  [[0.15]]
grads:  [0.11485185]
Stock Position:  0.11485185231422851
Bond Position:  [-45.12975371]


portfolio before change:  [-34.51877529]
curr_Stock_Price:  92.58491458638325
curr_Factors:  [92.58491459]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.51877529]
Stock Price:  91.02073331099496
PL:  [-34.51877529]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.23488824e-02]
 [ 3.49833966e-03]
 [ 2.16675610e-03]
 [-4.82493672e-03]
 [ 1.15842021e-02]
 [ 1.63489848e-02]
 [ 1.24928798e-02]
 [ 1.27013643e-02]
 [-5.39808651e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.0184157]
curr_Stock_Price:  99.12762077436628
curr_Factors:  [99.12762077]
mat_Sqrt:  [[0.15]]
grads:  [0.14899255]
Stock Position:  0.1489925490038704
Bond Position:  [-26.78769259]


portfolio before change:  [-12.20622564]
curr_Stock_Price:  97.95700685747697
curr_Factors:  [97.95700686]
mat_Sqrt:  [[0.15]]
grads:  [0.02332226]
Stock Position:  0.023322264427613457
Bond Position:  [-14.49080486]


portfolio before change:  [-12.26178707]
curr_Stock_Price:  95.88541502227534
curr_Factors:  [95.88541502]
mat_Sqrt:  [[0.15]]
grads:  [0.01444504]
Stock Position:  0.014445040695792537
Bond Position:  [-13.64685579]


portfolio before change:  [-12.2585103]
curr_Stock_Price:  96.58474836341759
curr_Factors:  [96.58474836]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216624]
Stock Position:  -0.03216624482634376
Bond Position:  [-9.15174164]


portfolio before change:  [-12.23247408]
curr_Stock_Price:  95.63302897874343
curr_Factors:  [95.63302898]
mat_Sqrt:  [[0.15]]
grads:  [0.07722801]
Stock Position:  0.07722801373832673
Bond Position:  [-19.61802296]


portfolio before change:  [-12.09658707]
curr_Stock_Price:  97.51963031218386
curr_Factors:  [97.51963031]
mat_Sqrt:  [[0.15]]
grads:  [0.10899323]
Stock Position:  0.10899323226901285
Bond Position:  [-22.72556679]


portfolio before change:  [-12.35326328]
curr_Stock_Price:  95.26893475864523
curr_Factors:  [95.26893476]
mat_Sqrt:  [[0.15]]
grads:  [0.08328587]
Stock Position:  0.08328586553458217
Bond Position:  [-20.28781897]


portfolio before change:  [-12.41453615]
curr_Stock_Price:  94.6550679443555
curr_Factors:  [94.65506794]
mat_Sqrt:  [[0.15]]
grads:  [0.08467576]
Stock Position:  0.08467576167650498
Bond Position:  [-20.42952613]


portfolio before change:  [-12.23887569]
curr_Stock_Price:  96.85023900864435
curr_Factors:  [96.85023901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.23887569]
Stock Price:  96.87861920700392
PL:  [-12.23887569]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-4.87084829e-02]
 [ 4.21878649e-03]
 [ 1.29049640e-03]
 [-4.84781552e-03]
 [ 1.48705450e-02]
 [ 1.67405732e-02]
 [ 7.38276764e-03]
 [ 2.20830914e-02]
 [-4.17391159e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.47862054]
curr_Stock_Price:  96.94841184036797
curr_Factors:  [96.94841184]
mat_Sqrt:  [[0.15]]
grads:  [-0.32472322]
Stock Position:  -0.3247232195710147
Bond Position:  [-13.99722012]


portfolio before change:  [-46.04212149]
curr_Stock_Price:  98.66218082546114
curr_Factors:  [98.66218083]
mat_Sqrt:  [[0.15]]
grads:  [0.02812524]
Stock Position:  0.02812524326816706
Bond Position:  [-48.81701932]


portfolio before change:  [-46.05784139]
curr_Stock_Price:  98.97132316813965
curr_Factors:  [98.97132317]
mat_Sqrt:  [[0.15]]
grads:  [0.00860331]
Stock Position:  0.008603309341384141
Bond Position:  [-46.9093223]


portfolio before change:  [-46.10444524]
curr_Stock_Price:  96.28127482391604
curr_Factors:  [96.28127482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231877]
Stock Position:  -0.03231877015627138
Bond Position:  [-42.99275285]


portfolio before change:  [-46.05123376]
curr_Stock_Price:  93.96951520881504
curr_Factors:  [93.96951521]
mat_Sqrt:  [[0.15]]
grads:  [0.09913697]
Stock Position:  0.09913696677081398
Bond Position:  [-55.36708647]


portfolio before change:  [-46.29703526]
curr_Stock_Price:  91.76941734138205
curr_Factors:  [91.76941734]
mat_Sqrt:  [[0.15]]
grads:  [0.11160382]
Stock Position:  0.11160382111319991
Bond Position:  [-56.53885289]


portfolio before change:  [-46.47913332]
curr_Stock_Price:  90.391135084062
curr_Factors:  [90.39113508]
mat_Sqrt:  [[0.15]]
grads:  [0.04921845]
Stock Position:  0.04921845093764287
Bond Position:  [-50.92804497]


portfolio before change:  [-46.42571511]
curr_Stock_Price:  91.9939608067001
curr_Factors:  [91.99396081]
mat_Sqrt:  [[0.15]]
grads:  [0.14722061]
Stock Position:  0.14722060909248105
Bond Position:  [-59.96912205]


portfolio before change:  [-46.05614163]
curr_Stock_Price:  94.70802060956343
curr_Factors:  [94.70802061]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.05614163]
Stock Price:  94.55643428417721
PL:  [-46.05614163]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.87353277e-02]
 [ 4.58803849e-03]
 [ 2.17010714e-03]
 [-5.15662606e-03]
 [ 9.17858927e-03]
 [ 1.63572452e-02]
 [ 1.79660826e-02]
 [ 3.57109901e-03]
 [-7.03415211e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.58674918]
curr_Stock_Price:  99.0254777552525
curr_Factors:  [99.02547776]
mat_Sqrt:  [[0.15]]
grads:  [0.12490218]
Stock Position:  0.12490218439755968
Bond Position:  [-25.95524766]


portfolio before change:  [-13.60949634]
curr_Stock_Price:  98.9472862231994
curr_Factors:  [98.94728622]
mat_Sqrt:  [[0.15]]
grads:  [0.03058692]
Stock Position:  0.03058692324459722
Bond Position:  [-16.63598939]


portfolio before change:  [-13.59936465]
curr_Stock_Price:  99.55054309887733
curr_Factors:  [99.5505431]
mat_Sqrt:  [[0.15]]
grads:  [0.01446738]
Stock Position:  0.014467380929330816
Bond Position:  [-15.03960027]


portfolio before change:  [-13.6100214]
curr_Stock_Price:  99.33384363798447
curr_Factors:  [99.33384364]
mat_Sqrt:  [[0.15]]
grads:  [-0.03437751]
Stock Position:  -0.03437750703974371
Bond Position:  [-10.19517149]


portfolio before change:  [-13.58946121]
curr_Stock_Price:  98.58745310745546
curr_Factors:  [98.58745311]
mat_Sqrt:  [[0.15]]
grads:  [0.0611906]
Stock Position:  0.06119059514495992
Bond Position:  [-19.62208614]


portfolio before change:  [-13.66966149]
curr_Stock_Price:  97.43716548487717
curr_Factors:  [97.43716548]
mat_Sqrt:  [[0.15]]
grads:  [0.1090483]
Stock Position:  0.10904830106841332
Bond Position:  [-24.29501885]


portfolio before change:  [-13.46377566]
curr_Stock_Price:  99.43661323525085
curr_Factors:  [99.43661324]
mat_Sqrt:  [[0.15]]
grads:  [0.11977388]
Stock Position:  0.1197738842461051
Bond Position:  [-25.37368506]


portfolio before change:  [-13.3738115]
curr_Stock_Price:  100.29367971039758
curr_Factors:  [100.29367971]
mat_Sqrt:  [[0.15]]
grads:  [0.02380733]
Stock Position:  0.023807326731655493
Bond Position:  [-15.7615359]


portfolio before change:  [-13.4335869]
curr_Stock_Price:  98.11398640402503
curr_Factors:  [98.1139864]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.4335869]
Stock Price:  95.34300790628136
PL:  [-13.4335869]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 3.90898667e-04]
 [ 3.22852081e-03]
 [ 9.06596290e-04]
 [-4.74145339e-03]
 [ 9.15826535e-03]
 [ 1.59346127e-02]
 [ 1.60343944e-02]
 [ 3.51577800e-03]
 [-6.48808687e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.09710852]
curr_Stock_Price:  98.5363402186209
curr_Factors:  [98.53634022]
mat_Sqrt:  [[0.15]]
grads:  [0.00260599]
Stock Position:  0.0026059911109136322
Bond Position:  [-21.35389335]


portfolio before change:  [-21.1101798]
curr_Stock_Price:  97.61858532222519
curr_Factors:  [97.61858532]
mat_Sqrt:  [[0.15]]
grads:  [0.02152347]
Stock Position:  0.021523472098353414
Bond Position:  [-23.2112707]


portfolio before change:  [-21.10149971]
curr_Stock_Price:  98.56121333927388
curr_Factors:  [98.56121334]
mat_Sqrt:  [[0.15]]
grads:  [0.00604398]
Stock Position:  0.006043975265980315
Bond Position:  [-21.69720124]


portfolio before change:  [-21.11760389]
curr_Stock_Price:  97.69210465703031
curr_Factors:  [97.69210466]
mat_Sqrt:  [[0.15]]
grads:  [-0.03160969]
Stock Position:  -0.03160968927191835
Bond Position:  [-18.02958682]


portfolio before change:  [-21.15416306]
curr_Stock_Price:  98.56342337830408
curr_Factors:  [98.56342338]
mat_Sqrt:  [[0.15]]
grads:  [0.0610551]
Stock Position:  0.06105510232332103
Bond Position:  [-27.17196295]


portfolio before change:  [-21.10137173]
curr_Stock_Price:  99.65064958242188
curr_Factors:  [99.65064958]
mat_Sqrt:  [[0.15]]
grads:  [0.10623075]
Stock Position:  0.10623075142923058
Bond Position:  [-31.68733511]


portfolio before change:  [-21.21097948]
curr_Stock_Price:  98.76804148074926
curr_Factors:  [98.76804148]
mat_Sqrt:  [[0.15]]
grads:  [0.10689596]
Stock Position:  0.10689596296327541
Bond Position:  [-31.76888438]


portfolio before change:  [-21.30105237]
curr_Stock_Price:  98.07405384998737
curr_Factors:  [98.07405385]
mat_Sqrt:  [[0.15]]
grads:  [0.02343852]
Stock Position:  0.023438520032115898
Bond Position:  [-23.59976304]


portfolio before change:  [-21.27694296]
curr_Stock_Price:  99.60624261805084
curr_Factors:  [99.60624262]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.27694296]
Stock Price:  100.99654313825411
PL:  [-22.2734861]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.65072705e-03]
 [ 3.78238934e-03]
 [ 7.45762986e-04]
 [-5.26651856e-03]
 [ 1.03258460e-02]
 [ 1.63757388e-02]
 [ 1.63807101e-02]
 [ 2.65317806e-03]
 [-6.33892986e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.48357642]
curr_Stock_Price:  100.46288230599367
curr_Factors:  [100.46288231]
mat_Sqrt:  [[0.15]]
grads:  [0.04433818]
Stock Position:  0.044338180325647306
Bond Position:  [4.02923502]


portfolio before change:  [8.38913117]
curr_Stock_Price:  98.28732231723627
curr_Factors:  [98.28732232]
mat_Sqrt:  [[0.15]]
grads:  [0.02521593]
Stock Position:  0.025215928929707174
Bond Position:  [5.91072503]


portfolio before change:  [8.38305151]
curr_Stock_Price:  97.92898693139739
curr_Factors:  [97.92898693]
mat_Sqrt:  [[0.15]]
grads:  [0.00497175]
Stock Position:  0.004971753240171913
Bond Position:  [7.89617275]


portfolio before change:  [8.39469986]
curr_Stock_Price:  99.4775909238115
curr_Factors:  [99.47759092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03511012]
Stock Position:  -0.0351101237276085
Bond Position:  [11.88737038]


portfolio before change:  [8.51326408]
curr_Stock_Price:  96.26999616618454
curr_Factors:  [96.26999617]
mat_Sqrt:  [[0.15]]
grads:  [0.06883897]
Stock Position:  0.0688389733557614
Bond Position:  [1.88613638]


portfolio before change:  [8.5818446]
curr_Stock_Price:  97.25253868345095
curr_Factors:  [97.25253868]
mat_Sqrt:  [[0.15]]
grads:  [0.10917159]
Stock Position:  0.1091715921322978
Bond Position:  [-2.03536989]


portfolio before change:  [8.76075054]
curr_Stock_Price:  98.90062203547936
curr_Factors:  [98.90062204]
mat_Sqrt:  [[0.15]]
grads:  [0.10920473]
Stock Position:  0.10920473368703976
Bond Position:  [-2.03966555]


portfolio before change:  [9.01393108]
curr_Stock_Price:  101.22836570019336
curr_Factors:  [101.2283657]
mat_Sqrt:  [[0.15]]
grads:  [0.01768785]
Stock Position:  0.017687853763473003
Bond Position:  [7.22341855]


portfolio before change:  [8.99047053]
curr_Stock_Price:  99.697757737924
curr_Factors:  [99.69775774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.99047053]
Stock Price:  101.2254868186073
PL:  [7.76498371]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [ 0.01114909]
 [ 0.00669506]
 [-0.00359854]
 [-0.00633219]
 [ 0.01356558]
 [ 0.0160466 ]
 [ 0.015363  ]
 [ 0.00357623]
 [-0.00680542]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.29156256]
curr_Stock_Price:  100.18986323510262
curr_Factors:  [100.18986324]
mat_Sqrt:  [[0.15]]
grads:  [0.07432727]
Stock Position:  0.07432726842262447
Bond Position:  [-3.15527629]


portfolio before change:  [4.516041]
curr_Stock_Price:  103.23122976288386
curr_Factors:  [103.23122976]
mat_Sqrt:  [[0.15]]
grads:  [0.04463372]
Stock Position:  0.0446337158743674
Bond Position:  [-0.09155238]


portfolio before change:  [4.56103582]
curr_Stock_Price:  104.24034599182521
curr_Factors:  [104.24034599]
mat_Sqrt:  [[0.15]]
grads:  [-0.02399024]
Stock Position:  -0.0239902448128287
Bond Position:  [7.06178724]


portfolio before change:  [4.66017484]
curr_Stock_Price:  100.25509078792537
curr_Factors:  [100.25509079]
mat_Sqrt:  [[0.15]]
grads:  [-0.04221457]
Stock Position:  -0.04221457111171198
Bond Position:  [8.8924005]


portfolio before change:  [4.67784442]
curr_Stock_Price:  99.94187501437516
curr_Factors:  [99.94187501]
mat_Sqrt:  [[0.15]]
grads:  [0.09043723]
Stock Position:  0.09043723110639972
Bond Position:  [-4.36062203]


portfolio before change:  [4.59265785]
curr_Stock_Price:  99.02404815929384
curr_Factors:  [99.02404816]
mat_Sqrt:  [[0.15]]
grads:  [0.1069773]
Stock Position:  0.10697730229857025
Bond Position:  [-6.00066769]


portfolio before change:  [4.53477328]
curr_Stock_Price:  98.51100955416062
curr_Factors:  [98.51100955]
mat_Sqrt:  [[0.15]]
grads:  [0.10241998]
Stock Position:  0.10241998389991412
Bond Position:  [-5.55472274]


portfolio before change:  [4.56276034]
curr_Stock_Price:  98.81139153798914
curr_Factors:  [98.81139154]
mat_Sqrt:  [[0.15]]
grads:  [0.02384156]
Stock Position:  0.023841556587626045
Bond Position:  [2.20694296]


portfolio before change:  [4.57817257]
curr_Stock_Price:  99.41154043479813
curr_Factors:  [99.41154043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.57817257]
Stock Price:  102.50015543065346
PL:  [2.07801714]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.57025906e-02]
 [ 6.04340802e-03]
 [ 2.11349658e-03]
 [-7.15677413e-03]
 [ 1.21950096e-02]
 [ 1.60359250e-02]
 [ 1.31675470e-02]
 [ 1.60140011e-02]
 [-4.07314064e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.16817798]
curr_Stock_Price:  99.24812375944279
curr_Factors:  [99.24812376]
mat_Sqrt:  [[0.15]]
grads:  [0.1713506]
Stock Position:  0.17135060405297609
Bond Position:  [-27.17440393]


portfolio before change:  [-10.10262499]
curr_Stock_Price:  99.71000471953295
curr_Factors:  [99.71000472]
mat_Sqrt:  [[0.15]]
grads:  [0.04028939]
Stock Position:  0.040289386792681056
Bond Position:  [-14.11987994]


portfolio before change:  [-10.11173445]
curr_Stock_Price:  99.6591785817274
curr_Factors:  [99.65917858]
mat_Sqrt:  [[0.15]]
grads:  [0.01408998]
Stock Position:  0.014089977208551584
Bond Position:  [-11.51593001]


portfolio before change:  [-10.09889924]
curr_Stock_Price:  100.97888381021461
curr_Factors:  [100.97888381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04771183]
Stock Position:  -0.04771182754347468
Bond Position:  [-5.28101215]


portfolio before change:  [-10.09518499]
curr_Stock_Price:  100.845679519529
curr_Factors:  [100.84567952]
mat_Sqrt:  [[0.15]]
grads:  [0.08130006]
Stock Position:  0.08130006423101378
Bond Position:  [-18.29394521]


portfolio before change:  [-10.24818558]
curr_Stock_Price:  99.07629179544938
curr_Factors:  [99.0762918]
mat_Sqrt:  [[0.15]]
grads:  [0.10690617]
Stock Position:  0.10690616691641441
Bond Position:  [-20.84005217]


portfolio before change:  [-10.60790438]
curr_Stock_Price:  95.80897636639237
curr_Factors:  [95.80897637]
mat_Sqrt:  [[0.15]]
grads:  [0.08778365]
Stock Position:  0.0877836467961798
Bond Position:  [-19.01836573]


portfolio before change:  [-10.80119372]
curr_Stock_Price:  93.71544548116302
curr_Factors:  [93.71544548]
mat_Sqrt:  [[0.15]]
grads:  [0.10676001]
Stock Position:  0.10676000727391284
Bond Position:  [-20.80625536]


portfolio before change:  [-10.72599435]
curr_Stock_Price:  94.51729165704704
curr_Factors:  [94.51729166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.72599435]
Stock Price:  94.70577362974791
PL:  [-10.72599435]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.52348054e-03]
 [ 6.88310682e-03]
 [-1.58372269e-04]
 [-7.40352315e-03]
 [ 7.37869147e-03]
 [ 1.64210926e-02]
 [ 1.24938032e-02]
 [ 1.27395080e-03]
 [ 9.30277972e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.55772566]
curr_Stock_Price:  100.27232638656352
curr_Factors:  [100.27232639]
mat_Sqrt:  [[0.15]]
grads:  [0.06348987]
Stock Position:  0.06348987024739454
Bond Position:  [-0.80855133]


portfolio before change:  [5.58202117]
curr_Stock_Price:  100.66136304124015
curr_Factors:  [100.66136304]
mat_Sqrt:  [[0.15]]
grads:  [0.04588738]
Stock Position:  0.0458873788008424
Bond Position:  [0.96293508]


portfolio before change:  [5.6139682]
curr_Stock_Price:  101.34707317400671
curr_Factors:  [101.34707317]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105582]
Stock Position:  -0.0010558151279343301
Bond Position:  [5.72097198]


portfolio before change:  [5.61699495]
curr_Stock_Price:  101.19028269441631
curr_Factors:  [101.19028269]
mat_Sqrt:  [[0.15]]
grads:  [-0.04935682]
Stock Position:  -0.04935682097787639
Bond Position:  [10.61142561]


portfolio before change:  [5.53401445]
curr_Stock_Price:  102.97904333478063
curr_Factors:  [102.97904333]
mat_Sqrt:  [[0.15]]
grads:  [0.04919128]
Stock Position:  0.04919127647445761
Bond Position:  [0.46834385]


portfolio before change:  [5.6811547]
curr_Stock_Price:  105.96546770780257
curr_Factors:  [105.96546771]
mat_Sqrt:  [[0.15]]
grads:  [0.10947395]
Stock Position:  0.10947395044972191
Bond Position:  [-5.91930366]


portfolio before change:  [5.70640338]
curr_Stock_Price:  106.22314609961342
curr_Factors:  [106.2231461]
mat_Sqrt:  [[0.15]]
grads:  [0.08329202]
Stock Position:  0.08329202150285246
Bond Position:  [-3.14113719]


portfolio before change:  [5.64298663]
curr_Stock_Price:  105.48062848784828
curr_Factors:  [105.48062849]
mat_Sqrt:  [[0.15]]
grads:  [0.00849301]
Stock Position:  0.008493005341343398
Bond Position:  [4.74713909]


portfolio before change:  [5.64641755]
curr_Stock_Price:  105.60505524440929
curr_Factors:  [105.60505524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.64641755]
Stock Price:  106.8036148764096
PL:  [-1.15719733]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.04386806e-03]
 [ 6.27012834e-03]
 [-7.74016267e-03]
 [-1.51739768e-02]
 [-3.24062851e-03]
 [ 1.64217562e-02]
 [ 1.88829621e-02]
 [ 1.50135217e-03]
 [-2.84238970e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.91606384]
curr_Stock_Price:  102.57515766888365
curr_Factors:  [102.57515767]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029245]
Stock Position:  -0.020292453756723533
Bond Position:  [42.99756548]


portfolio before change:  [40.88181216]
curr_Stock_Price:  105.32277170381947
curr_Factors:  [105.3227717]
mat_Sqrt:  [[0.15]]
grads:  [0.04180086]
Stock Position:  0.041800855570391364
Bond Position:  [36.47923019]


portfolio before change:  [40.98765541]
curr_Stock_Price:  107.4184004711848
curr_Factors:  [107.41840047]
mat_Sqrt:  [[0.15]]
grads:  [-0.05160108]
Stock Position:  -0.05160108447115248
Bond Position:  [46.53056137]


portfolio before change:  [40.97699911]
curr_Stock_Price:  108.0758943877734
curr_Factors:  [108.07589439]
mat_Sqrt:  [[0.15]]
grads:  [-0.10115985]
Stock Position:  -0.10115984529764524
Bond Position:  [51.90993987]


portfolio before change:  [41.02661844]
curr_Stock_Price:  107.84202820971784
curr_Factors:  [107.84202821]
mat_Sqrt:  [[0.15]]
grads:  [-0.02160419]
Stock Position:  -0.021604190071571636
Bond Position:  [43.35645811]


portfolio before change:  [41.07710679]
curr_Stock_Price:  106.50873609672756
curr_Factors:  [106.5087361]
mat_Sqrt:  [[0.15]]
grads:  [0.10947837]
Stock Position:  0.1094783747918595
Bond Position:  [29.41670346]


portfolio before change:  [40.8373205]
curr_Stock_Price:  104.1840914884302
curr_Factors:  [104.18409149]
mat_Sqrt:  [[0.15]]
grads:  [0.12588641]
Stock Position:  0.12588641411967819
Bond Position:  [27.72195882]


portfolio before change:  [40.78387084]
curr_Stock_Price:  103.64937049080564
curr_Factors:  [103.64937049]
mat_Sqrt:  [[0.15]]
grads:  [0.01000901]
Stock Position:  0.010009014450713368
Bond Position:  [39.74644279]


portfolio before change:  [40.79430663]
curr_Stock_Price:  102.7059814894236
curr_Factors:  [102.70598149]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.79430663]
Stock Price:  103.42081538422008
PL:  [37.37349125]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.42506144e-02]
 [ 6.99235377e-03]
 [-5.77664549e-04]
 [-8.18212210e-03]
 [ 5.17095083e-03]
 [ 1.61218182e-02]
 [ 2.01233639e-02]
 [ 1.62344945e-03]
 [ 5.59813729e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58324896]
curr_Stock_Price:  99.67698951855276
curr_Factors:  [99.67698952]
mat_Sqrt:  [[0.15]]
grads:  [0.16167076]
Stock Position:  0.1616707627546432
Bond Position:  [-19.69810388]


portfolio before change:  [-3.39191373]
curr_Stock_Price:  100.92141204738074
curr_Factors:  [100.92141205]
mat_Sqrt:  [[0.15]]
grads:  [0.04661569]
Stock Position:  0.046615691799922504
Bond Position:  [-8.09643517]


portfolio before change:  [-3.34099724]
curr_Stock_Price:  102.10053680502696
curr_Factors:  [102.10053681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0038511]
Stock Position:  -0.003851096991641247
Bond Position:  [-2.94779817]


portfolio before change:  [-3.34153493]
curr_Stock_Price:  101.85733682312073
curr_Factors:  [101.85733682]
mat_Sqrt:  [[0.15]]
grads:  [-0.05454748]
Stock Position:  -0.05454748064598696
Bond Position:  [2.21452618]


portfolio before change:  [-3.43013214]
curr_Stock_Price:  103.50186293224317
curr_Factors:  [103.50186293]
mat_Sqrt:  [[0.15]]
grads:  [0.03447301]
Stock Position:  0.034473005515081964
Bond Position:  [-6.99815243]


portfolio before change:  [-3.49330303]
curr_Stock_Price:  101.77091622237381
curr_Factors:  [101.77091622]
mat_Sqrt:  [[0.15]]
grads:  [0.10747879]
Stock Position:  0.10747878814505007
Bond Position:  [-14.43151777]


portfolio before change:  [-3.67873339]
curr_Stock_Price:  100.11279552380577
curr_Factors:  [100.11279552]
mat_Sqrt:  [[0.15]]
grads:  [0.13415576]
Stock Position:  0.134155759498095
Bond Position:  [-17.10944151]


portfolio before change:  [-3.33047252]
curr_Stock_Price:  102.77252280095578
curr_Factors:  [102.7725228]
mat_Sqrt:  [[0.15]]
grads:  [0.010823]
Stock Position:  0.01082299634288391
Bond Position:  [-4.44277916]


portfolio before change:  [-3.310357]
curr_Stock_Price:  104.8364124082137
curr_Factors:  [104.83641241]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.310357]
Stock Price:  103.83705284945148
PL:  [-7.14740985]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.29310036e-02]
 [ 4.47571953e-03]
 [ 8.18559033e-04]
 [-7.36000978e-03]
 [ 9.30187661e-03]
 [ 1.64562425e-02]
 [ 1.18258012e-02]
 [ 1.65229990e-02]
 [-3.14887121e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-30.67273866]
curr_Stock_Price:  97.91269494090895
curr_Factors:  [97.91269494]
mat_Sqrt:  [[0.15]]
grads:  [-0.15287336]
Stock Position:  -0.15287335730519616
Bond Position:  [-15.70449626]


portfolio before change:  [-30.82549664]
curr_Stock_Price:  98.86056295410886
curr_Factors:  [98.86056295]
mat_Sqrt:  [[0.15]]
grads:  [0.02983813]
Stock Position:  0.029838130213302796
Bond Position:  [-33.77531099]


portfolio before change:  [-30.85456921]
curr_Stock_Price:  98.45233722069811
curr_Factors:  [98.45233722]
mat_Sqrt:  [[0.15]]
grads:  [0.00545706]
Stock Position:  0.005457060218815752
Bond Position:  [-31.39182954]


portfolio before change:  [-30.85553135]
curr_Stock_Price:  101.15300320727899
curr_Factors:  [101.15300321]
mat_Sqrt:  [[0.15]]
grads:  [-0.04906673]
Stock Position:  -0.0490667318801485
Bond Position:  [-25.89228406]


portfolio before change:  [-30.74974989]
curr_Stock_Price:  98.7332203114478
curr_Factors:  [98.73322031]
mat_Sqrt:  [[0.15]]
grads:  [0.06201251]
Stock Position:  0.06201251076651838
Bond Position:  [-36.87244478]


portfolio before change:  [-30.90985022]
curr_Stock_Price:  96.4488505864248
curr_Factors:  [96.44885059]
mat_Sqrt:  [[0.15]]
grads:  [0.10970828]
Stock Position:  0.10970828322886773
Bond Position:  [-41.49108804]


portfolio before change:  [-31.11862813]
curr_Stock_Price:  94.73496748942478
curr_Factors:  [94.73496749]
mat_Sqrt:  [[0.15]]
grads:  [0.07883867]
Stock Position:  0.07883867490454012
Bond Position:  [-38.58740743]


portfolio before change:  [-31.22968685]
curr_Stock_Price:  93.57106929344565
curr_Factors:  [93.57106929]
mat_Sqrt:  [[0.15]]
grads:  [0.11015333]
Stock Position:  0.1101533267323846
Bond Position:  [-41.53685142]


portfolio before change:  [-31.33892905]
curr_Stock_Price:  92.76792893172954
curr_Factors:  [92.76792893]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.33892905]
Stock Price:  92.60500615580492
PL:  [-31.33892905]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.97193081e-03]
 [ 5.16305483e-03]
 [ 1.55660859e-03]
 [-6.32513013e-03]
 [ 1.33833536e-02]
 [ 1.60757232e-02]
 [ 1.88844360e-02]
 [ 3.67202923e-03]
 [-4.79689652e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.85554133]
curr_Stock_Price:  100.7476212978194
curr_Factors:  [100.7476213]
mat_Sqrt:  [[0.15]]
grads:  [0.03314621]
Stock Position:  0.03314620539739436
Bond Position:  [9.51613998]


portfolio before change:  [12.8096926]
curr_Stock_Price:  99.22081035180084
curr_Factors:  [99.22081035]
mat_Sqrt:  [[0.15]]
grads:  [0.03442037]
Stock Position:  0.03442036556421667
Bond Position:  [9.39447603]


portfolio before change:  [12.72978836]
curr_Stock_Price:  96.7628860667398
curr_Factors:  [96.76288607]
mat_Sqrt:  [[0.15]]
grads:  [0.01037739]
Stock Position:  0.010377390616492699
Bond Position:  [11.72564209]


portfolio before change:  [12.7718407]
curr_Stock_Price:  100.2500881744034
curr_Factors:  [100.25008817]
mat_Sqrt:  [[0.15]]
grads:  [-0.04216753]
Stock Position:  -0.04216753422954436
Bond Position:  [16.99913973]


portfolio before change:  [12.77729359]
curr_Stock_Price:  100.32239039133374
curr_Factors:  [100.32239039]
mat_Sqrt:  [[0.15]]
grads:  [0.08922236]
Stock Position:  0.08922235740264663
Bond Position:  [3.82629342]


portfolio before change:  [12.65090073]
curr_Stock_Price:  98.88433733156178
curr_Factors:  [98.88433733]
mat_Sqrt:  [[0.15]]
grads:  [0.10717149]
Stock Position:  0.10717148789817657
Bond Position:  [2.05331917]


portfolio before change:  [12.73182991]
curr_Stock_Price:  99.62989255654536
curr_Factors:  [99.62989256]
mat_Sqrt:  [[0.15]]
grads:  [0.12589624]
Stock Position:  0.12589623973360933
Bond Position:  [0.18880107]


portfolio before change:  [12.77599888]
curr_Stock_Price:  99.9799788176189
curr_Factors:  [99.97997882]
mat_Sqrt:  [[0.15]]
grads:  [0.02448019]
Stock Position:  0.02448019488343618
Bond Position:  [10.32846951]


portfolio before change:  [12.7989202]
curr_Stock_Price:  100.70529128988635
curr_Factors:  [100.70529129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.7989202]
Stock Price:  102.54776988004319
PL:  [10.25115032]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.19565405e-02]
 [ 3.73081164e-03]
 [ 1.36560729e-03]
 [-4.82446964e-03]
 [ 9.10403279e-03]
 [ 1.60543121e-02]
 [ 1.98583446e-02]
 [ 2.73833381e-03]
 [-6.46244682e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.77596388]
curr_Stock_Price:  99.79469506757755
curr_Factors:  [99.79469507]
mat_Sqrt:  [[0.15]]
grads:  [0.14637694]
Stock Position:  0.14637693676525274
Bond Position:  [-16.38360565]


portfolio before change:  [-2.01144722]
curr_Stock_Price:  98.24192664658773
curr_Factors:  [98.24192665]
mat_Sqrt:  [[0.15]]
grads:  [0.02487208]
Stock Position:  0.024872077615141715
Bond Position:  [-4.45492804]


portfolio before change:  [-2.04363007]
curr_Stock_Price:  97.03757065074123
curr_Factors:  [97.03757065]
mat_Sqrt:  [[0.15]]
grads:  [0.00910405]
Stock Position:  0.00910404857638255
Bond Position:  [-2.92706483]


portfolio before change:  [-2.04916008]
curr_Stock_Price:  96.59094396316826
curr_Factors:  [96.59094396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216313]
Stock Position:  -0.03216313092752537
Bond Position:  [1.05750709]


portfolio before change:  [-2.11000997]
curr_Stock_Price:  98.49930220864215
curr_Factors:  [98.49930221]
mat_Sqrt:  [[0.15]]
grads:  [0.06069355]
Stock Position:  0.06069355192258407
Bond Position:  [-8.08828249]


portfolio before change:  [-2.08449958]
curr_Stock_Price:  98.98626565959957
curr_Factors:  [98.98626566]
mat_Sqrt:  [[0.15]]
grads:  [0.10702875]
Stock Position:  0.10702874727354392
Bond Position:  [-12.6788756]


portfolio before change:  [-1.98156565]
curr_Stock_Price:  100.00725266241723
curr_Factors:  [100.00725266]
mat_Sqrt:  [[0.15]]
grads:  [0.13238896]
Stock Position:  0.1323889637877373
Bond Position:  [-15.2214222]


portfolio before change:  [-1.83857926]
curr_Stock_Price:  101.14480219268955
curr_Factors:  [101.14480219]
mat_Sqrt:  [[0.15]]
grads:  [0.01825556]
Stock Position:  0.01825555873930536
Bond Position:  [-3.68503414]


portfolio before change:  [-1.90381318]
curr_Stock_Price:  97.67238365076223
curr_Factors:  [97.67238365]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.90381318]
Stock Price:  101.06727910809114
PL:  [-2.97109228]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.04733956e-02]
 [ 4.31054919e-03]
 [ 1.97831678e-03]
 [-4.92284012e-03]
 [ 1.05306344e-02]
 [ 1.64759589e-02]
 [ 1.27484972e-02]
 [ 1.71707868e-02]
 [-3.13653413e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.87516993]
curr_Stock_Price:  99.07182175881589
curr_Factors:  [99.07182176]
mat_Sqrt:  [[0.15]]
grads:  [0.1364893]
Stock Position:  0.13648930416042845
Bond Position:  [-26.39741395]


portfolio before change:  [-12.93461308]
curr_Stock_Price:  98.73303227955233
curr_Factors:  [98.73303228]
mat_Sqrt:  [[0.15]]
grads:  [0.02873699]
Stock Position:  0.028736994596696253
Bond Position:  [-15.7719037]


portfolio before change:  [-13.01654524]
curr_Stock_Price:  96.15641514177594
curr_Factors:  [96.15641514]
mat_Sqrt:  [[0.15]]
grads:  [0.01318878]
Stock Position:  0.013188778549558893
Bond Position:  [-14.2847309]


portfolio before change:  [-12.98594118]
curr_Stock_Price:  99.01856074487523
curr_Factors:  [99.01856074]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281893]
Stock Position:  -0.032818934152248444
Bond Position:  [-9.73625756]


portfolio before change:  [-12.9914709]
curr_Stock_Price:  99.03868242953376
curr_Factors:  [99.03868243]
mat_Sqrt:  [[0.15]]
grads:  [0.07020423]
Stock Position:  0.07020422964449906
Bond Position:  [-19.94440531]


portfolio before change:  [-13.1970813]
curr_Stock_Price:  96.25201693130158
curr_Factors:  [96.25201693]
mat_Sqrt:  [[0.15]]
grads:  [0.10983973]
Stock Position:  0.10983972585020409
Bond Position:  [-23.76937646]


portfolio before change:  [-13.29447608]
curr_Stock_Price:  95.4735452748296
curr_Factors:  [95.47354527]
mat_Sqrt:  [[0.15]]
grads:  [0.08498998]
Stock Position:  0.08498998116644826
Bond Position:  [-21.40877089]


portfolio before change:  [-13.48249091]
curr_Stock_Price:  93.38732564387779
curr_Factors:  [93.38732564]
mat_Sqrt:  [[0.15]]
grads:  [0.11447191]
Stock Position:  0.1144719121674682
Bond Position:  [-24.17271664]


portfolio before change:  [-13.56815677]
curr_Stock_Price:  92.74457857050693
curr_Factors:  [92.74457857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.56815677]
Stock Price:  92.72815546822899
PL:  [-13.56815677]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 7.82912147e-03]
 [ 6.79330835e-03]
 [-2.45314402e-05]
 [-8.99672444e-03]
 [ 5.45319056e-03]
 [ 1.63224657e-02]
 [ 2.42036711e-02]
 [ 2.42190546e-03]
 [-3.78714818e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.94039117]
curr_Stock_Price:  100.3623771510728
curr_Factors:  [100.36237715]
mat_Sqrt:  [[0.15]]
grads:  [0.05219414]
Stock Position:  0.05219414310663108
Bond Position:  [1.7020629]


portfolio before change:  [6.94717075]
curr_Stock_Price:  100.47595946701514
curr_Factors:  [100.47595947]
mat_Sqrt:  [[0.15]]
grads:  [0.04528872]
Stock Position:  0.04528872231924524
Bond Position:  [2.39674292]


portfolio before change:  [6.96754595]
curr_Stock_Price:  100.89938785785415
curr_Factors:  [100.89938786]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016354]
Stock Position:  -0.00016354293476817899
Bond Position:  [6.98404733]


portfolio before change:  [6.97077074]
curr_Stock_Price:  102.53875693350129
curr_Factors:  [102.53875693]
mat_Sqrt:  [[0.15]]
grads:  [-0.05997816]
Stock Position:  -0.05997816295042934
Bond Position:  [13.12085701]


portfolio before change:  [6.92358348]
curr_Stock_Price:  103.4349052748582
curr_Factors:  [103.43490527]
mat_Sqrt:  [[0.15]]
grads:  [0.0363546]
Stock Position:  0.036354603743549326
Bond Position:  [3.16324848]


portfolio before change:  [6.90130505]
curr_Stock_Price:  102.77858004282643
curr_Factors:  [102.77858004]
mat_Sqrt:  [[0.15]]
grads:  [0.10881644]
Stock Position:  0.10881643788870048
Bond Position:  [-4.28269392]


portfolio before change:  [6.76345706]
curr_Stock_Price:  101.5314696246929
curr_Factors:  [101.53146962]
mat_Sqrt:  [[0.15]]
grads:  [0.16135781]
Stock Position:  0.16135780730844776
Bond Position:  [-9.61943825]


portfolio before change:  [6.74635783]
curr_Stock_Price:  101.45531397626148
curr_Factors:  [101.45531398]
mat_Sqrt:  [[0.15]]
grads:  [0.01614604]
Stock Position:  0.016146036414858685
Bond Position:  [5.10825663]


portfolio before change:  [6.75196742]
curr_Stock_Price:  101.64451386580463
curr_Factors:  [101.64451387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75196742]
Stock Price:  99.28850775258536
PL:  [6.75196742]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.55399547e-02]
 [ 3.98502178e-03]
 [-1.10084567e-04]
 [-6.65011012e-03]
 [ 1.25857238e-02]
 [ 1.63254164e-02]
 [ 1.32428443e-02]
 [ 3.54891252e-03]
 [-7.51524736e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.89496103]
curr_Stock_Price:  98.94027603673496
curr_Factors:  [98.94027604]
mat_Sqrt:  [[0.15]]
grads:  [0.1035997]
Stock Position:  0.10359969776377655
Bond Position:  [-25.14514373]


portfolio before change:  [-14.95681141]
curr_Stock_Price:  98.46465048777868
curr_Factors:  [98.46465049]
mat_Sqrt:  [[0.15]]
grads:  [0.02656681]
Stock Position:  0.026566811847420612
Bond Position:  [-17.57270325]


portfolio before change:  [-14.8933142]
curr_Stock_Price:  101.18555523153606
curr_Factors:  [101.18555523]
mat_Sqrt:  [[0.15]]
grads:  [-0.0007339]
Stock Position:  -0.0007338971119437447
Bond Position:  [-14.81905441]


portfolio before change:  [-14.90023195]
curr_Stock_Price:  100.51295347533181
curr_Factors:  [100.51295348]
mat_Sqrt:  [[0.15]]
grads:  [-0.04433407]
Stock Position:  -0.044334067438851696
Bond Position:  [-10.4440839]


portfolio before change:  [-14.86222099]
curr_Stock_Price:  99.53775949817864
curr_Factors:  [99.5377595]
mat_Sqrt:  [[0.15]]
grads:  [0.08390483]
Stock Position:  0.08390482559066478
Bond Position:  [-23.21391934]


portfolio before change:  [-15.02341968]
curr_Stock_Price:  97.75492008579398
curr_Factors:  [97.75492009]
mat_Sqrt:  [[0.15]]
grads:  [0.10883611]
Stock Position:  0.10883610921707546
Bond Position:  [-25.66268484]


portfolio before change:  [-15.24148338]
curr_Stock_Price:  95.86924853643882
curr_Factors:  [95.86924854]
mat_Sqrt:  [[0.15]]
grads:  [0.08828563]
Stock Position:  0.08828562855673627
Bond Position:  [-23.70536025]


portfolio before change:  [-15.02206159]
curr_Stock_Price:  98.48889847477938
curr_Factors:  [98.48889847]
mat_Sqrt:  [[0.15]]
grads:  [0.02365942]
Stock Position:  0.023659416770777913
Bond Position:  [-17.35225148]


portfolio before change:  [-15.03087268]
curr_Stock_Price:  98.48328562064619
curr_Factors:  [98.48328562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.03087268]
Stock Price:  101.46142247636219
PL:  [-16.49229516]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.94375738e-02]
 [ 4.53312936e-03]
 [ 1.61731126e-03]
 [-4.71597992e-03]
 [ 8.86781586e-03]
 [ 1.64813185e-02]
 [ 1.35770237e-02]
 [ 4.05078543e-03]
 [-3.97942160e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.21504742]
curr_Stock_Price:  98.00763201004852
curr_Factors:  [98.00763201]
mat_Sqrt:  [[0.15]]
grads:  [-0.12958383]
Stock Position:  -0.12958382550603634
Bond Position:  [-16.51484353]


portfolio before change:  [-29.33957703]
curr_Stock_Price:  98.90489000338422
curr_Factors:  [98.90489]
mat_Sqrt:  [[0.15]]
grads:  [0.03022086]
Stock Position:  0.03022086239052938
Bond Position:  [-32.3285681]


portfolio before change:  [-29.42311679]
curr_Stock_Price:  96.67558778229387
curr_Factors:  [96.67558778]
mat_Sqrt:  [[0.15]]
grads:  [0.01078208]
Stock Position:  0.010782075051254695
Bond Position:  [-30.46548023]


portfolio before change:  [-29.42375002]
curr_Stock_Price:  98.02999488857171
curr_Factors:  [98.02999489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03143987]
Stock Position:  -0.031439866165990135
Bond Position:  [-26.3417001]


portfolio before change:  [-29.44289834]
curr_Stock_Price:  98.22001416044809
curr_Factors:  [98.22001416]
mat_Sqrt:  [[0.15]]
grads:  [0.05911877]
Stock Position:  0.05911877238755669
Bond Position:  [-35.249545]


portfolio before change:  [-29.58003635]
curr_Stock_Price:  96.19851028042856
curr_Factors:  [96.19851028]
mat_Sqrt:  [[0.15]]
grads:  [0.10987546]
Stock Position:  0.10987545680508207
Bond Position:  [-40.14989161]


portfolio before change:  [-29.59208493]
curr_Stock_Price:  96.2716056415138
curr_Factors:  [96.27160564]
mat_Sqrt:  [[0.15]]
grads:  [0.09051349]
Stock Position:  0.09051349163191676
Bond Position:  [-38.3059641]


portfolio before change:  [-29.53240428]
curr_Stock_Price:  97.14261856319176
curr_Factors:  [97.14261856]
mat_Sqrt:  [[0.15]]
grads:  [0.02700524]
Stock Position:  0.027005236174137925
Bond Position:  [-32.15576363]


portfolio before change:  [-29.62417399]
curr_Stock_Price:  94.33990983263806
curr_Factors:  [94.33990983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.62417399]
Stock Price:  91.78415078291948
PL:  [-29.62417399]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-6.56134432e-04]
 [ 6.65037325e-03]
 [-7.27069533e-03]
 [-1.45398921e-02]
 [-2.92604233e-03]
 [ 1.64287670e-02]
 [ 7.85508410e-03]
 [ 3.97869025e-03]
 [ 1.64571903e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.08860858]
curr_Stock_Price:  101.80485466952263
curr_Factors:  [101.80485467]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437423]
Stock Position:  -0.004374229546407251
Bond Position:  [29.53392639]


portfolio before change:  [29.09617788]
curr_Stock_Price:  103.45116940085751
curr_Factors:  [103.4511694]
mat_Sqrt:  [[0.15]]
grads:  [0.04433582]
Stock Position:  0.04433582164738969
Bond Position:  [24.50958528]


portfolio before change:  [29.26835451]
curr_Stock_Price:  107.05815722302447
curr_Factors:  [107.05815722]
mat_Sqrt:  [[0.15]]
grads:  [-0.0484713]
Stock Position:  -0.04847130220104085
Bond Position:  [34.4576028]


portfolio before change:  [29.26662022]
curr_Stock_Price:  107.44946908253756
curr_Factors:  [107.44946908]
mat_Sqrt:  [[0.15]]
grads:  [-0.09693261]
Stock Position:  -0.09693261404817367
Bond Position:  [39.68197814]


portfolio before change:  [29.27032528]
curr_Stock_Price:  107.6159857178416
curr_Factors:  [107.61598572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950695]
Stock Position:  -0.01950694885686988
Bond Position:  [31.36958481]


portfolio before change:  [29.28496496]
curr_Stock_Price:  107.6697629583724
curr_Factors:  [107.66976296]
mat_Sqrt:  [[0.15]]
grads:  [0.10952511]
Stock Position:  0.10952511365734828
Bond Position:  [17.49242194]


portfolio before change:  [29.29739537]
curr_Stock_Price:  107.70338090708277
curr_Factors:  [107.70338091]
mat_Sqrt:  [[0.15]]
grads:  [0.05236723]
Stock Position:  0.05236722736292984
Bond Position:  [23.65726793]


portfolio before change:  [29.30761679]
curr_Stock_Price:  107.67263321306108
curr_Factors:  [107.67263321]
mat_Sqrt:  [[0.15]]
grads:  [0.0265246]
Stock Position:  0.02652460165528847
Bond Position:  [26.45164308]


portfolio before change:  [29.30224386]
curr_Stock_Price:  106.97131990653126
curr_Factors:  [106.97131991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.30224386]
Stock Price:  106.29186449433067
PL:  [23.01037937]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.05004369e-02]
 [ 6.90411436e-03]
 [ 8.75717859e-04]
 [-4.68843311e-03]
 [ 8.53533313e-03]
 [ 1.65297670e-02]
 [ 1.27132785e-02]
 [ 1.40822154e-02]
 [-3.24234803e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.7865724]
curr_Stock_Price:  100.22210242373988
curr_Factors:  [100.22210242]
mat_Sqrt:  [[0.15]]
grads:  [0.07000291]
Stock Position:  0.07000291262039642
Bond Position:  [-2.22926668]


portfolio before change:  [4.81906247]
curr_Stock_Price:  100.70215359252771
curr_Factors:  [100.70215359]
mat_Sqrt:  [[0.15]]
grads:  [0.04602743]
Stock Position:  0.04602742904174996
Bond Position:  [0.18400124]


portfolio before change:  [4.80361095]
curr_Stock_Price:  100.36445199208438
curr_Factors:  [100.36445199]
mat_Sqrt:  [[0.15]]
grads:  [0.00583812]
Stock Position:  0.005838119063071717
Bond Position:  [4.21767133]


portfolio before change:  [4.79422468]
curr_Stock_Price:  98.39538678540495
curr_Factors:  [98.39538679]
mat_Sqrt:  [[0.15]]
grads:  [-0.03125622]
Stock Position:  -0.03125622076577199
Bond Position:  [7.86969261]


portfolio before change:  [4.81425948]
curr_Stock_Price:  97.88032222683341
curr_Factors:  [97.88032223]
mat_Sqrt:  [[0.15]]
grads:  [0.05690222]
Stock Position:  0.0569022208345658
Bond Position:  [-0.75534823]


portfolio before change:  [4.68606011]
curr_Stock_Price:  95.63398446378987
curr_Factors:  [95.63398446]
mat_Sqrt:  [[0.15]]
grads:  [0.11019845]
Stock Position:  0.11019844669704869
Bond Position:  [-5.85265643]


portfolio before change:  [4.66234629]
curr_Stock_Price:  95.44535422440711
curr_Factors:  [95.44535422]
mat_Sqrt:  [[0.15]]
grads:  [0.08475519]
Stock Position:  0.08475518966794851
Bond Position:  [-3.42714281]


portfolio before change:  [4.56045489]
curr_Stock_Price:  94.26339241605193
curr_Factors:  [94.26339242]
mat_Sqrt:  [[0.15]]
grads:  [0.09388144]
Stock Position:  0.09388143618982127
Bond Position:  [-4.28912777]


portfolio before change:  [4.43452335]
curr_Stock_Price:  92.94485230782135
curr_Factors:  [92.94485231]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43452335]
Stock Price:  93.18910594737096
PL:  [4.43452335]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.61320479e-02]
 [ 5.38279566e-03]
 [ 6.97260992e-04]
 [-4.77350779e-03]
 [ 8.38466099e-03]
 [ 1.63849098e-02]
 [ 1.36010843e-02]
 [ 1.33777959e-02]
 [-3.73969082e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.17577173]
curr_Stock_Price:  99.57327108998551
curr_Factors:  [99.57327109]
mat_Sqrt:  [[0.15]]
grads:  [0.17421365]
Stock Position:  0.17421365251839666
Bond Position:  [-22.52279498]


portfolio before change:  [-5.22718024]
curr_Stock_Price:  99.34283970707074
curr_Factors:  [99.34283971]
mat_Sqrt:  [[0.15]]
grads:  [0.0358853]
Stock Position:  0.035885304403073755
Bond Position:  [-8.79212828]


portfolio before change:  [-5.27981086]
curr_Stock_Price:  97.99873907265953
curr_Factors:  [97.99873907]
mat_Sqrt:  [[0.15]]
grads:  [0.00464841]
Stock Position:  0.004648406612695118
Bond Position:  [-5.73534885]


portfolio before change:  [-5.28608104]
curr_Stock_Price:  97.26692227661536
curr_Factors:  [97.26692228]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182339]
Stock Position:  -0.03182338527638297
Bond Position:  [-2.1907183]


portfolio before change:  [-5.30196539]
curr_Stock_Price:  97.73163457905505
curr_Factors:  [97.73163458]
mat_Sqrt:  [[0.15]]
grads:  [0.05589774]
Stock Position:  0.05589773990802883
Bond Position:  [-10.76494288]


portfolio before change:  [-5.33924738]
curr_Stock_Price:  97.16098235159298
curr_Factors:  [97.16098235]
mat_Sqrt:  [[0.15]]
grads:  [0.10923273]
Stock Position:  0.10923273210478784
Bond Position:  [-15.95240693]


portfolio before change:  [-5.37206086]
curr_Stock_Price:  96.93362118502574
curr_Factors:  [96.93362119]
mat_Sqrt:  [[0.15]]
grads:  [0.0906739]
Stock Position:  0.09067389565923621
Bond Position:  [-14.16140991]


portfolio before change:  [-5.60314609]
curr_Stock_Price:  94.46319954029494
curr_Factors:  [94.46319954]
mat_Sqrt:  [[0.15]]
grads:  [0.08918531]
Stock Position:  0.08918530580049232
Bond Position:  [-14.02787542]


portfolio before change:  [-5.66162416]
curr_Stock_Price:  93.88617190705786
curr_Factors:  [93.88617191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.66162416]
Stock Price:  93.72089387372706
PL:  [-5.66162416]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.37632654e-04]
 [ 2.91777642e-03]
 [ 2.08837754e-03]
 [-4.68407480e-03]
 [ 8.59168205e-03]
 [ 1.65731785e-02]
 [ 1.30473782e-02]
 [ 8.59345454e-03]
 [-4.44533416e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.31349357]
curr_Stock_Price:  98.52224741103855
curr_Factors:  [98.52224741]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091755]
Stock Position:  -0.0009175510238968825
Bond Position:  [-21.22309438]


portfolio before change:  [-21.322921]
curr_Stock_Price:  97.22883273659669
curr_Factors:  [97.22883274]
mat_Sqrt:  [[0.15]]
grads:  [0.01945184]
Stock Position:  0.01945184281856708
Bond Position:  [-23.21420097]


portfolio before change:  [-21.28631865]
curr_Stock_Price:  99.70738193482056
curr_Factors:  [99.70738193]
mat_Sqrt:  [[0.15]]
grads:  [0.01392252]
Stock Position:  0.013922516961364373
Bond Position:  [-22.67449637]


portfolio before change:  [-21.31512014]
curr_Stock_Price:  98.45319725002913
curr_Factors:  [98.45319725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03122717]
Stock Position:  -0.031227165315980375
Bond Position:  [-18.24070587]


portfolio before change:  [-21.30808995]
curr_Stock_Price:  97.93592898821964
curr_Factors:  [97.93592899]
mat_Sqrt:  [[0.15]]
grads:  [0.05727788]
Stock Position:  0.05727788035997723
Bond Position:  [-26.91765238]


portfolio before change:  [-21.49289037]
curr_Stock_Price:  94.94457838286577
curr_Factors:  [94.94457838]
mat_Sqrt:  [[0.15]]
grads:  [0.11048786]
Stock Position:  0.11048785652635007
Bond Position:  [-31.98311332]


portfolio before change:  [-21.42400825]
curr_Stock_Price:  95.71278647839033
curr_Factors:  [95.71278648]
mat_Sqrt:  [[0.15]]
grads:  [0.08698252]
Stock Position:  0.08698252134657657
Bond Position:  [-29.74934775]


portfolio before change:  [-21.42953764]
curr_Stock_Price:  95.82026788314742
curr_Factors:  [95.82026788]
mat_Sqrt:  [[0.15]]
grads:  [0.0572897]
Stock Position:  0.05728969692563007
Bond Position:  [-26.91905175]


portfolio before change:  [-21.47728993]
curr_Stock_Price:  95.22174151941384
curr_Factors:  [95.22174152]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.47728993]
Stock Price:  94.97689475308519
PL:  [-21.47728993]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.12070140e-02]
 [ 6.79227110e-03]
 [-2.32594659e-04]
 [-6.02997152e-03]
 [ 1.30499366e-02]
 [ 1.60263630e-02]
 [ 1.36157219e-02]
 [ 3.48736896e-03]
 [-7.78004235e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.18548243]
curr_Stock_Price:  99.83315216817329
curr_Factors:  [99.83315217]
mat_Sqrt:  [[0.15]]
grads:  [0.14138009]
Stock Position:  0.14138009329066278
Bond Position:  [-15.29990279]


portfolio before change:  [-1.10676412]
curr_Stock_Price:  100.44405973952684
curr_Factors:  [100.44405974]
mat_Sqrt:  [[0.15]]
grads:  [0.04528181]
Stock Position:  0.045281807315393045
Bond Position:  [-5.65505268]


portfolio before change:  [-1.05339069]
curr_Stock_Price:  101.68521298477533
curr_Factors:  [101.68521298]
mat_Sqrt:  [[0.15]]
grads:  [-0.00155063]
Stock Position:  -0.00155063106296182
Bond Position:  [-0.89571444]


portfolio before change:  [-1.0512888]
curr_Stock_Price:  100.04081062820968
curr_Factors:  [100.04081063]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019981]
Stock Position:  -0.04019981011145975
Bond Position:  [2.97033279]


portfolio before change:  [-1.06618031]
curr_Stock_Price:  100.44820181106518
curr_Factors:  [100.44820181]
mat_Sqrt:  [[0.15]]
grads:  [0.08699958]
Stock Position:  0.08699957714123038
Bond Position:  [-9.80513139]


portfolio before change:  [-1.18636661]
curr_Stock_Price:  99.12310901869863
curr_Factors:  [99.12310902]
mat_Sqrt:  [[0.15]]
grads:  [0.10684242]
Stock Position:  0.10684242018451781
Bond Position:  [-11.77691948]


portfolio before change:  [-1.3831564]
curr_Stock_Price:  97.33636688328964
curr_Factors:  [97.33636688]
mat_Sqrt:  [[0.15]]
grads:  [0.09077148]
Stock Position:  0.09077147951904219
Bond Position:  [-10.21852243]


portfolio before change:  [-1.35359176]
curr_Stock_Price:  97.71837214359253
curr_Factors:  [97.71837214]
mat_Sqrt:  [[0.15]]
grads:  [0.02324913]
Stock Position:  0.023249126403154796
Bond Position:  [-3.62545854]


portfolio before change:  [-1.32738033]
curr_Stock_Price:  98.92377677821624
curr_Factors:  [98.92377678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.32738033]
Stock Price:  98.82346022053099
PL:  [-1.32738033]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.80604367e-02]
 [ 6.25449828e-03]
 [-2.14716445e-03]
 [-8.20075150e-03]
 [ 8.66496117e-03]
 [ 1.64343603e-02]
 [ 2.11762058e-02]
 [ 1.42406431e-03]
 [ 1.74178678e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.36140278]
curr_Stock_Price:  99.43092448108902
curr_Factors:  [99.43092448]
mat_Sqrt:  [[0.15]]
grads:  [0.18706958]
Stock Position:  0.18706957832878046
Bond Position:  [-25.96190389]


portfolio before change:  [-7.29981387]
curr_Stock_Price:  99.82956279365463
curr_Factors:  [99.82956279]
mat_Sqrt:  [[0.15]]
grads:  [0.04169666]
Stock Position:  0.041696655231709644
Bond Position:  [-11.46237274]


portfolio before change:  [-7.16806927]
curr_Stock_Price:  103.12664325311175
curr_Factors:  [103.12664325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01431443]
Stock Position:  -0.014314429641828323
Bond Position:  [-5.69187019]


portfolio before change:  [-7.15297498]
curr_Stock_Price:  101.87329731596753
curr_Factors:  [101.87329732]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467168]
Stock Position:  -0.05467167669386086
Bond Position:  [-1.58339101]


portfolio before change:  [-7.19758033]
curr_Stock_Price:  102.67468960327365
curr_Factors:  [102.6746896]
mat_Sqrt:  [[0.15]]
grads:  [0.05776641]
Stock Position:  0.05776640782132424
Bond Position:  [-13.12872833]


portfolio before change:  [-7.15318263]
curr_Stock_Price:  103.55692740349632
curr_Factors:  [103.5569274]
mat_Sqrt:  [[0.15]]
grads:  [0.1095624]
Stock Position:  0.1095624022517902
Bond Position:  [-18.49912837]


portfolio before change:  [-7.17395154]
curr_Stock_Price:  103.45180891711765
curr_Factors:  [103.45180892]
mat_Sqrt:  [[0.15]]
grads:  [0.14117471]
Stock Position:  0.14117470500600426
Bond Position:  [-21.77873015]


portfolio before change:  [-7.0785944]
curr_Stock_Price:  104.20441705162231
curr_Factors:  [104.20441705]
mat_Sqrt:  [[0.15]]
grads:  [0.00949376]
Stock Position:  0.00949376208129257
Bond Position:  [-8.06788634]


portfolio before change:  [-7.05481686]
curr_Stock_Price:  107.13397144185187
curr_Factors:  [107.13397144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.05481686]
Stock Price:  104.53380690941081
PL:  [-11.58862377]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.97353642e-02]
 [ 2.55040411e-03]
 [ 1.65460910e-03]
 [-4.72648168e-03]
 [ 8.84124790e-03]
 [ 1.65500833e-02]
 [ 1.31984176e-02]
 [ 6.83558805e-03]
 [-5.94166929e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.33696521]
curr_Stock_Price:  97.99969170143811
curr_Factors:  [97.9996917]
mat_Sqrt:  [[0.15]]
grads:  [-0.13156909]
Stock Position:  -0.13156909435958408
Bond Position:  [-16.44323453]


portfolio before change:  [-29.18314347]
curr_Stock_Price:  96.76805431552194
curr_Factors:  [96.76805432]
mat_Sqrt:  [[0.15]]
grads:  [0.01700269]
Stock Position:  0.01700269404113811
Bond Position:  [-30.82846109]


portfolio before change:  [-29.20104575]
curr_Stock_Price:  96.6219486585716
curr_Factors:  [96.62194866]
mat_Sqrt:  [[0.15]]
grads:  [0.01103073]
Stock Position:  0.01103072734267678
Bond Position:  [-30.26685612]


portfolio before change:  [-29.20218776]
curr_Stock_Price:  97.89069547373782
curr_Factors:  [97.89069547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150988]
Stock Position:  -0.03150987783567693
Bond Position:  [-26.1176639]


portfolio before change:  [-29.18979764]
curr_Stock_Price:  97.08294202449267
curr_Factors:  [97.08294202]
mat_Sqrt:  [[0.15]]
grads:  [0.05894165]
Stock Position:  0.05894165265667177
Bond Position:  [-34.91202669]


portfolio before change:  [-29.307476]
curr_Stock_Price:  95.38265063703079
curr_Factors:  [95.38265064]
mat_Sqrt:  [[0.15]]
grads:  [0.11033389]
Stock Position:  0.11033388854937427
Bond Position:  [-39.83141475]


portfolio before change:  [-29.27763211]
curr_Stock_Price:  95.83368688699277
curr_Factors:  [95.83368689]
mat_Sqrt:  [[0.15]]
grads:  [0.08798945]
Stock Position:  0.08798945041376467
Bond Position:  [-37.70998555]


portfolio before change:  [-29.25379968]
curr_Stock_Price:  96.31888301146516
curr_Factors:  [96.31888301]
mat_Sqrt:  [[0.15]]
grads:  [0.04557059]
Stock Position:  0.04557058698126058
Bond Position:  [-33.64310771]


portfolio before change:  [-29.22727705]
curr_Stock_Price:  97.27011906984292
curr_Factors:  [97.27011907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.22727705]
Stock Price:  95.90008599293785
PL:  [-29.22727705]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-8.74482514e-03]
 [ 3.46743779e-03]
 [ 1.00892162e-03]
 [-7.51180436e-03]
 [ 1.23116496e-02]
 [ 1.59307442e-02]
 [ 2.24165822e-02]
 [ 3.51359886e-03]
 [-7.44806755e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.83734861]
curr_Stock_Price:  98.29274444137104
curr_Factors:  [98.29274444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05829883]
Stock Position:  -0.05829883427522692
Bond Position:  [-19.10699619]


portfolio before change:  [-24.82507179]
curr_Stock_Price:  97.91824803862183
curr_Factors:  [97.91824804]
mat_Sqrt:  [[0.15]]
grads:  [0.02311625]
Stock Position:  0.023116251929041123
Bond Position:  [-27.08857468]


portfolio before change:  [-24.84711971]
curr_Stock_Price:  97.55053077018327
curr_Factors:  [97.55053077]
mat_Sqrt:  [[0.15]]
grads:  [0.00672614]
Stock Position:  0.006726144161542735
Bond Position:  [-25.50325864]


portfolio before change:  [-24.83476906]
curr_Stock_Price:  101.28305115980845
curr_Factors:  [101.28305116]
mat_Sqrt:  [[0.15]]
grads:  [-0.0500787]
Stock Position:  -0.0500786957269597
Bond Position:  [-19.76264595]


portfolio before change:  [-24.83538141]
curr_Stock_Price:  101.09791382543793
curr_Factors:  [101.09791383]
mat_Sqrt:  [[0.15]]
grads:  [0.08207766]
Stock Position:  0.08207766418929222
Bond Position:  [-33.13326203]


portfolio before change:  [-24.96549904]
curr_Stock_Price:  99.7145064150253
curr_Factors:  [99.71450642]
mat_Sqrt:  [[0.15]]
grads:  [0.10620496]
Stock Position:  0.1062049613672534
Bond Position:  [-35.55567434]


portfolio before change:  [-24.85408035]
curr_Stock_Price:  100.9310311934191
curr_Factors:  [100.93103119]
mat_Sqrt:  [[0.15]]
grads:  [0.14944388]
Stock Position:  0.14944388162306363
Bond Position:  [-39.93760543]


portfolio before change:  [-25.3050892]
curr_Stock_Price:  98.04677093137671
curr_Factors:  [98.04677093]
mat_Sqrt:  [[0.15]]
grads:  [0.02342399]
Stock Position:  0.023423992405669503
Bond Position:  [-27.60173601]


portfolio before change:  [-25.29479394]
curr_Stock_Price:  99.07561251130359
curr_Factors:  [99.07561251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.29479394]
Stock Price:  102.57302234200552
PL:  [-27.86781628]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.99684811e-03]
 [ 6.84938140e-03]
 [-2.45394060e-03]
 [-8.95345826e-03]
 [ 8.78282523e-03]
 [ 1.64351406e-02]
 [ 2.05085996e-02]
 [ 1.52083535e-03]
 [-1.18608848e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.47233641]
curr_Stock_Price:  102.74164356054818
curr_Factors:  [102.74164356]
mat_Sqrt:  [[0.15]]
grads:  [-0.01997899]
Stock Position:  -0.0199789873675695
Bond Position:  [45.52501041]


portfolio before change:  [43.50049917]
curr_Stock_Price:  102.4716319851342
curr_Factors:  [102.47163199]
mat_Sqrt:  [[0.15]]
grads:  [0.04566254]
Stock Position:  0.045662542669307395
Bond Position:  [38.8213839]


portfolio before change:  [43.56057329]
curr_Stock_Price:  103.36204629253155
curr_Factors:  [103.36204629]
mat_Sqrt:  [[0.15]]
grads:  [-0.0163596]
Stock Position:  -0.016359604014613643
Bond Position:  [45.25153544]


portfolio before change:  [43.59725895]
curr_Stock_Price:  102.5029650956997
curr_Factors:  [102.5029651]
mat_Sqrt:  [[0.15]]
grads:  [-0.05968972]
Stock Position:  -0.05968972173701972
Bond Position:  [49.71563241]


portfolio before change:  [43.61353746]
curr_Stock_Price:  102.64680092259722
curr_Factors:  [102.64680092]
mat_Sqrt:  [[0.15]]
grads:  [0.05855217]
Stock Position:  0.058552168188732066
Bond Position:  [37.60334471]


portfolio before change:  [43.67733998]
curr_Stock_Price:  103.41528056946227
curr_Factors:  [103.41528057]
mat_Sqrt:  [[0.15]]
grads:  [0.1095676]
Stock Position:  0.10956760412352355
Bond Position:  [32.34637546]


portfolio before change:  [43.72087729]
curr_Stock_Price:  103.6649900707497
curr_Factors:  [103.66499007]
mat_Sqrt:  [[0.15]]
grads:  [0.136724]
Stock Position:  0.13672399756615994
Bond Position:  [29.54738544]


portfolio before change:  [43.71438875]
curr_Stock_Price:  103.50945103217349
curr_Factors:  [103.50945103]
mat_Sqrt:  [[0.15]]
grads:  [0.0101389]
Stock Position:  0.01013890235143689
Bond Position:  [42.66491654]


portfolio before change:  [43.73224141]
curr_Stock_Price:  103.16571175246456
curr_Factors:  [103.16571175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.73224141]
Stock Price:  104.52209122538734
PL:  [39.21015018]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.40339249e-02]
 [ 6.66914059e-03]
 [ 1.04170821e-03]
 [-5.19094424e-03]
 [ 1.31488042e-02]
 [ 1.59421516e-02]
 [ 2.22196987e-02]
 [ 3.66799862e-03]
 [-5.61551857e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.22840372]
curr_Stock_Price:  100.05549304199522
curr_Factors:  [100.05549304]
mat_Sqrt:  [[0.15]]
grads:  [0.0935595]
Stock Position:  0.0935594995921337
Bond Position:  [-7.13273814]


portfolio before change:  [2.22712782]
curr_Stock_Price:  100.07998402175687
curr_Factors:  [100.07998402]
mat_Sqrt:  [[0.15]]
grads:  [0.04446094]
Stock Position:  0.044460937234787765
Bond Position:  [-2.22252207]


portfolio before change:  [2.23512566]
curr_Stock_Price:  100.28486890099579
curr_Factors:  [100.2848689]
mat_Sqrt:  [[0.15]]
grads:  [0.00694472]
Stock Position:  0.006944721420354177
Bond Position:  [1.53867518]


portfolio before change:  [2.22961575]
curr_Stock_Price:  99.38066652740282
curr_Factors:  [99.38066653]
mat_Sqrt:  [[0.15]]
grads:  [-0.03460629]
Stock Position:  -0.03460629491055758
Bond Position:  [5.66881241]


portfolio before change:  [2.19679847]
curr_Stock_Price:  100.41089516138341
curr_Factors:  [100.41089516]
mat_Sqrt:  [[0.15]]
grads:  [0.08765869]
Stock Position:  0.08765869445116334
Bond Position:  [-6.60508951]


portfolio before change:  [2.18182448]
curr_Stock_Price:  100.27775806389971
curr_Factors:  [100.27775806]
mat_Sqrt:  [[0.15]]
grads:  [0.10628101]
Stock Position:  0.10628101053845432
Bond Position:  [-8.47579698]


portfolio before change:  [2.24076497]
curr_Stock_Price:  100.87221470645044
curr_Factors:  [100.87221471]
mat_Sqrt:  [[0.15]]
grads:  [0.14813132]
Stock Position:  0.1481313247086289
Bond Position:  [-12.70156982]


portfolio before change:  [2.11462917]
curr_Stock_Price:  100.06358470552914
curr_Factors:  [100.06358471]
mat_Sqrt:  [[0.15]]
grads:  [0.02445332]
Stock Position:  0.024453324124142455
Bond Position:  [-0.3322581]


portfolio before change:  [2.11637087]
curr_Stock_Price:  100.14160591646929
curr_Factors:  [100.14160592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.11637087]
Stock Price:  100.31369572108656
PL:  [1.80267515]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.41496707e-04]
 [ 5.75418332e-03]
 [ 8.90039806e-04]
 [-7.42870834e-03]
 [ 9.54847501e-03]
 [ 1.64063494e-02]
 [ 1.66716496e-02]
 [ 3.54439970e-03]
 [-7.61532308e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.16139207]
curr_Stock_Price:  101.61420980012042
curr_Factors:  [101.6142098]
mat_Sqrt:  [[0.15]]
grads:  [0.00360998]
Stock Position:  0.003609978046736189
Bond Position:  [25.794567]


portfolio before change:  [26.16683751]
curr_Stock_Price:  99.5490835689452
curr_Factors:  [99.54908357]
mat_Sqrt:  [[0.15]]
grads:  [0.03836122]
Stock Position:  0.03836122212686647
Bond Position:  [22.34801301]


portfolio before change:  [26.2090314]
curr_Stock_Price:  100.35763670208453
curr_Factors:  [100.3576367]
mat_Sqrt:  [[0.15]]
grads:  [0.0059336]
Stock Position:  0.005933598705479136
Bond Position:  [25.61354946]


portfolio before change:  [26.22691]
curr_Stock_Price:  101.21185976930612
curr_Factors:  [101.21185977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04952472]
Stock Position:  -0.049524722273388694
Bond Position:  [31.23939924]


portfolio before change:  [26.36197208]
curr_Stock_Price:  98.80016567544801
curr_Factors:  [98.80016568]
mat_Sqrt:  [[0.15]]
grads:  [0.0636565]
Stock Position:  0.06365650008643188
Bond Position:  [20.07269933]


portfolio before change:  [26.25404146]
curr_Stock_Price:  96.94694592857354
curr_Factors:  [96.94694593]
mat_Sqrt:  [[0.15]]
grads:  [0.10937566]
Stock Position:  0.10937566248163588
Bond Position:  [15.65040502]


portfolio before change:  [26.48773559]
curr_Stock_Price:  99.01200287359096
curr_Factors:  [99.01200287]
mat_Sqrt:  [[0.15]]
grads:  [0.11114433]
Stock Position:  0.11114433047590458
Bond Position:  [15.48311282]


portfolio before change:  [26.43105927]
curr_Stock_Price:  98.43239791530738
curr_Factors:  [98.43239792]
mat_Sqrt:  [[0.15]]
grads:  [0.02362933]
Stock Position:  0.023629331315708567
Bond Position:  [24.10516753]


portfolio before change:  [26.45660902]
curr_Stock_Price:  99.00347409150224
curr_Factors:  [99.00347409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.45660902]
Stock Price:  101.82342899536698
PL:  [24.63318003]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.91100907e-03]
 [ 7.08260360e-03]
 [-1.56493193e-03]
 [-7.68227862e-03]
 [ 1.21737755e-02]
 [ 1.59482789e-02]
 [ 1.98844576e-02]
 [ 3.55541342e-03]
 [-4.05476997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.48708302]
curr_Stock_Price:  100.85388096521939
curr_Factors:  [100.85388097]
mat_Sqrt:  [[0.15]]
grads:  [0.03274006]
Stock Position:  0.0327400604845921
Bond Position:  [11.18512086]


portfolio before change:  [14.50350078]
curr_Stock_Price:  101.18447897752544
curr_Factors:  [101.18447898]
mat_Sqrt:  [[0.15]]
grads:  [0.04721736]
Stock Position:  0.04721735735856406
Bond Position:  [9.72583708]


portfolio before change:  [14.58138363]
curr_Stock_Price:  102.73091697215737
curr_Factors:  [102.73091697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01043288]
Stock Position:  -0.010432879548888732
Bond Position:  [15.65316291]


portfolio before change:  [14.60279384]
curr_Stock_Price:  101.42910268218911
curr_Factors:  [101.42910268]
mat_Sqrt:  [[0.15]]
grads:  [-0.05121519]
Stock Position:  -0.05121519082393161
Bond Position:  [19.79750469]


portfolio before change:  [14.63436171]
curr_Stock_Price:  101.00605168558437
curr_Factors:  [101.00605169]
mat_Sqrt:  [[0.15]]
grads:  [0.0811585]
Stock Position:  0.08115850334544085
Bond Position:  [6.43686172]


portfolio before change:  [14.5181264]
curr_Stock_Price:  99.5341845142784
curr_Factors:  [99.53418451]
mat_Sqrt:  [[0.15]]
grads:  [0.10632186]
Stock Position:  0.10632185927758275
Bond Position:  [3.93546685]


portfolio before change:  [14.57147564]
curr_Stock_Price:  100.01744366470923
curr_Factors:  [100.01744366]
mat_Sqrt:  [[0.15]]
grads:  [0.13256305]
Stock Position:  0.13256305041454025
Bond Position:  [1.31285821]


portfolio before change:  [14.61245913]
curr_Stock_Price:  100.32165280169535
curr_Factors:  [100.3216528]
mat_Sqrt:  [[0.15]]
grads:  [0.02370276]
Stock Position:  0.023702756157600667
Bond Position:  [12.23455945]


portfolio before change:  [14.64699689]
curr_Stock_Price:  101.5206253403835
curr_Factors:  [101.52062534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.64699689]
Stock Price:  101.42449679464963
PL:  [13.22250009]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.0030998 ]
 [ 0.00624781]
 [-0.00707687]
 [-0.01427929]
 [-0.00258087]
 [ 0.01643709]
 [ 0.0051111 ]
 [ 0.00562583]
 [ 0.03201353]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.87524572]
curr_Stock_Price:  102.37711411137434
curr_Factors:  [102.37711411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02066534]
Stock Position:  -0.020665338199043853
Bond Position:  [39.99090341]


portfolio before change:  [37.83210298]
curr_Stock_Price:  105.43262648202622
curr_Factors:  [105.43262648]
mat_Sqrt:  [[0.15]]
grads:  [0.04165206]
Stock Position:  0.0416520642723097
Bond Position:  [33.44061644]


portfolio before change:  [37.9103391]
curr_Stock_Price:  106.90942321932484
curr_Factors:  [106.90942322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04717911]
Stock Position:  -0.04717910574734169
Bond Position:  [42.95423008]


portfolio before change:  [37.91848926]
curr_Stock_Price:  107.19201266834861
curr_Factors:  [107.19201267]
mat_Sqrt:  [[0.15]]
grads:  [-0.09519525]
Stock Position:  -0.0951952516039367
Bond Position:  [48.12265988]


portfolio before change:  [37.92580654]
curr_Stock_Price:  107.36796758612608
curr_Factors:  [107.36796759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01720582]
Stock Position:  -0.017205815811000714
Bond Position:  [39.77316001]


portfolio before change:  [37.91679181]
curr_Stock_Price:  109.04799733257708
curr_Factors:  [109.04799733]
mat_Sqrt:  [[0.15]]
grads:  [0.1095806]
Stock Position:  0.10958059653475273
Bond Position:  [25.96724721]


portfolio before change:  [37.9093916]
curr_Stock_Price:  108.86195090011846
curr_Factors:  [108.8619509]
mat_Sqrt:  [[0.15]]
grads:  [0.034074]
Stock Position:  0.034074003691496074
Bond Position:  [34.20002908]


portfolio before change:  [37.92918864]
curr_Stock_Price:  108.94097733891387
curr_Factors:  [108.94097734]
mat_Sqrt:  [[0.15]]
grads:  [0.03750552]
Stock Position:  0.037505524140023484
Bond Position:  [33.84330018]


portfolio before change:  [37.97688962]
curr_Stock_Price:  109.76152593653683
curr_Factors:  [109.76152594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [37.97688962]
Stock Price:  110.35389638351604
PL:  [27.62299324]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.21527702e-02]
 [ 2.57484997e-03]
 [ 1.60102219e-03]
 [-4.74542986e-03]
 [ 1.23591932e-02]
 [ 1.65949104e-02]
 [ 1.28371292e-02]
 [ 1.47703491e-02]
 [-4.31060720e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.28170205]
curr_Stock_Price:  98.84995984083874
curr_Factors:  [98.84995984]
mat_Sqrt:  [[0.15]]
grads:  [0.08101847]
Stock Position:  0.08101846830773791
Bond Position:  [-24.29037439]


portfolio before change:  [-16.46003894]
curr_Stock_Price:  96.79871565203997
curr_Factors:  [96.79871565]
mat_Sqrt:  [[0.15]]
grads:  [0.01716567]
Stock Position:  0.017165666462182462
Bond Position:  [-18.1216534]


portfolio before change:  [-16.47081348]
curr_Stock_Price:  96.69901356364132
curr_Factors:  [96.69901356]
mat_Sqrt:  [[0.15]]
grads:  [0.01067348]
Stock Position:  0.010673481289720751
Bond Position:  [-17.50292859]


portfolio before change:  [-16.46953037]
curr_Stock_Price:  97.63935914231661
curr_Factors:  [97.63935914]
mat_Sqrt:  [[0.15]]
grads:  [-0.0316362]
Stock Position:  -0.03163619908574633
Bond Position:  [-13.38059217]


portfolio before change:  [-16.40033903]
curr_Stock_Price:  95.24073625561631
curr_Factors:  [95.24073626]
mat_Sqrt:  [[0.15]]
grads:  [0.08239462]
Stock Position:  0.08239462131401788
Bond Position:  [-24.24766343]


portfolio before change:  [-16.47083196]
curr_Stock_Price:  94.53236399724759
curr_Factors:  [94.532364]
mat_Sqrt:  [[0.15]]
grads:  [0.11063274]
Stock Position:  0.11063273631371515
Bond Position:  [-26.92920606]


portfolio before change:  [-16.37232552]
curr_Stock_Price:  95.54449130122819
curr_Factors:  [95.5444913]
mat_Sqrt:  [[0.15]]
grads:  [0.08558086]
Stock Position:  0.0855808610237454
Bond Position:  [-24.54910535]


portfolio before change:  [-16.51094501]
curr_Stock_Price:  94.0682047468137
curr_Factors:  [94.06820475]
mat_Sqrt:  [[0.15]]
grads:  [0.09846899]
Stock Position:  0.0984689940589646
Bond Position:  [-25.77374651]


portfolio before change:  [-16.43535684]
curr_Stock_Price:  94.96674408337792
curr_Factors:  [94.96674408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.43535684]
Stock Price:  95.85904944025175
PL:  [-16.43535684]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.17069221e-03]
 [ 6.97009692e-03]
 [ 2.07283746e-03]
 [-5.18224062e-03]
 [ 1.23065466e-02]
 [ 1.60191200e-02]
 [ 2.07448862e-02]
 [ 3.48099309e-03]
 [-7.87796294e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.27248384]
curr_Stock_Price:  100.70964770821365
curr_Factors:  [100.70964771]
mat_Sqrt:  [[0.15]]
grads:  [0.03447128]
Stock Position:  0.03447128141562559
Bond Position:  [8.80089323]


portfolio before change:  [12.3113871]
curr_Stock_Price:  101.7105305698736
curr_Factors:  [101.71053057]
mat_Sqrt:  [[0.15]]
grads:  [0.04646731]
Stock Position:  0.04646731283173805
Bond Position:  [7.58517206]


portfolio before change:  [12.22348542]
curr_Stock_Price:  99.73720331271454
curr_Factors:  [99.73720331]
mat_Sqrt:  [[0.15]]
grads:  [0.01381892]
Stock Position:  0.013818916381878727
Bond Position:  [10.84522535]


portfolio before change:  [12.22381834]
curr_Stock_Price:  99.36879151868814
curr_Factors:  [99.36879152]
mat_Sqrt:  [[0.15]]
grads:  [-0.03454827]
Stock Position:  -0.034548270769085745
Bond Position:  [15.65683825]


portfolio before change:  [12.18302338]
curr_Stock_Price:  100.77625231945706
curr_Factors:  [100.77625232]
mat_Sqrt:  [[0.15]]
grads:  [0.08204364]
Stock Position:  0.08204364393848673
Bond Position:  [3.91497241]


portfolio before change:  [12.19614117]
curr_Stock_Price:  100.91227528986548
curr_Factors:  [100.91227529]
mat_Sqrt:  [[0.15]]
grads:  [0.10679413]
Stock Position:  0.10679413333292698
Bond Position:  [1.41930219]


portfolio before change:  [12.13875085]
curr_Stock_Price:  100.36823648938078
curr_Factors:  [100.36823649]
mat_Sqrt:  [[0.15]]
grads:  [0.13829924]
Stock Position:  0.13829924131327034
Bond Position:  [-1.74210011]


portfolio before change:  [11.76036547]
curr_Stock_Price:  97.63854608433502
curr_Factors:  [97.63854608]
mat_Sqrt:  [[0.15]]
grads:  [0.02320662]
Stock Position:  0.02320662057061793
Bond Position:  [9.49450478]


portfolio before change:  [11.79098405]
curr_Stock_Price:  98.75332021360772
curr_Factors:  [98.75332021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.79098405]
Stock Price:  95.50737046396563
PL:  [11.79098405]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.00305772]
 [ 0.00667089]
 [-0.00433078]
 [-0.01038677]
 [ 0.00312376]
 [ 0.01618767]
 [ 0.02409568]
 [ 0.00367123]
 [-0.00457641]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.16279467]
curr_Stock_Price:  102.52609846823945
curr_Factors:  [102.52609847]
mat_Sqrt:  [[0.15]]
grads:  [-0.02038482]
Stock Position:  -0.02038482440943896
Bond Position:  [42.25277118]


portfolio before change:  [40.16712758]
curr_Stock_Price:  103.35018004906685
curr_Factors:  [103.35018005]
mat_Sqrt:  [[0.15]]
grads:  [0.04447261]
Stock Position:  0.044472605290219284
Bond Position:  [35.57087581]


portfolio before change:  [40.24949389]
curr_Stock_Price:  104.80222955649737
curr_Factors:  [104.80222956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02887187]
Stock Position:  -0.028871871956595123
Bond Position:  [43.27533044]


portfolio before change:  [40.30328744]
curr_Stock_Price:  103.68867245039209
curr_Factors:  [103.68867245]
mat_Sqrt:  [[0.15]]
grads:  [-0.06924516]
Stock Position:  -0.0692451647973066
Bond Position:  [47.48322665]


portfolio before change:  [40.30396883]
curr_Stock_Price:  104.02178103010951
curr_Factors:  [104.02178103]
mat_Sqrt:  [[0.15]]
grads:  [0.02082504]
Stock Position:  0.020825038042514003
Bond Position:  [38.13771128]


portfolio before change:  [40.28332918]
curr_Stock_Price:  102.11478463589333
curr_Factors:  [102.11478464]
mat_Sqrt:  [[0.15]]
grads:  [0.10791781]
Stock Position:  0.10791780999607602
Bond Position:  [29.26332526]


portfolio before change:  [40.23042511]
curr_Stock_Price:  101.48894358613333
curr_Factors:  [101.48894359]
mat_Sqrt:  [[0.15]]
grads:  [0.16063788]
Stock Position:  0.16063788038959761
Bond Position:  [23.92745633]


portfolio before change:  [40.00352974]
curr_Stock_Price:  100.00198366428219
curr_Factors:  [100.00198366]
mat_Sqrt:  [[0.15]]
grads:  [0.02447486]
Stock Position:  0.02447486121813873
Bond Position:  [37.55599507]


portfolio before change:  [40.04533157]
curr_Stock_Price:  100.94250539839602
curr_Factors:  [100.9425054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.04533157]
Stock Price:  100.65485842378747
PL:  [39.39047315]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.71730119e-03]
 [ 4.39251524e-03]
 [ 2.19347964e-03]
 [-6.99938747e-03]
 [ 1.21598105e-02]
 [ 1.64064501e-02]
 [ 1.62732515e-02]
 [ 1.35368441e-03]
 [-1.33079957e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.95500759]
curr_Stock_Price:  100.94948451434117
curr_Factors:  [100.94948451]
mat_Sqrt:  [[0.15]]
grads:  [0.03144867]
Stock Position:  0.03144867462805449
Bond Position:  [12.7802801]


portfolio before change:  [15.89368515]
curr_Stock_Price:  98.79631958665739
curr_Factors:  [98.79631959]
mat_Sqrt:  [[0.15]]
grads:  [0.02928343]
Stock Position:  0.02928343495839627
Bond Position:  [13.00058955]


portfolio before change:  [15.9180689]
curr_Stock_Price:  99.40696624523588
curr_Factors:  [99.40696625]
mat_Sqrt:  [[0.15]]
grads:  [0.0146232]
Stock Position:  0.014623197575112275
Bond Position:  [14.46442119]


portfolio before change:  [15.9463176]
curr_Stock_Price:  100.84404491510564
curr_Factors:  [100.84404492]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666258]
Stock Position:  -0.04666258313523737
Bond Position:  [20.65196123]


portfolio before change:  [15.91626173]
curr_Stock_Price:  101.70950150752088
curr_Factors:  [101.70950151]
mat_Sqrt:  [[0.15]]
grads:  [0.0810654]
Stock Position:  0.08106540308833662
Bond Position:  [7.67113999]


portfolio before change:  [16.04019749]
curr_Stock_Price:  103.19101182780189
curr_Factors:  [103.19101183]
mat_Sqrt:  [[0.15]]
grads:  [0.10937633]
Stock Position:  0.10937633367203581
Bond Position:  [4.75354294]


portfolio before change:  [16.24230658]
curr_Stock_Price:  105.01710824155015
curr_Factors:  [105.01710824]
mat_Sqrt:  [[0.15]]
grads:  [0.10848834]
Stock Position:  0.10848834326029211
Bond Position:  [4.8491745]


portfolio before change:  [16.21139825]
curr_Stock_Price:  104.70985382635233
curr_Factors:  [104.70985383]
mat_Sqrt:  [[0.15]]
grads:  [0.00902456]
Stock Position:  0.009024562712884883
Bond Position:  [15.26643761]


portfolio before change:  [16.20473423]
curr_Stock_Price:  103.12538314644974
curr_Factors:  [103.12538315]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.20473423]
Stock Price:  105.52143552466218
PL:  [10.6832987]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.86507625e-02]
 [ 3.27380896e-03]
 [ 1.00294048e-03]
 [-4.84650185e-03]
 [ 9.87093046e-03]
 [ 1.63321787e-02]
 [ 1.72880257e-02]
 [ 7.11854422e-03]
 [-4.93069582e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.81995721]
curr_Stock_Price:  99.33593119367366
curr_Factors:  [99.33593119]
mat_Sqrt:  [[0.15]]
grads:  [0.19100508]
Stock Position:  0.19100508324800974
Bond Position:  [-27.79362502]


portfolio before change:  [-9.15102965]
curr_Stock_Price:  97.67538818699742
curr_Factors:  [97.67538819]
mat_Sqrt:  [[0.15]]
grads:  [0.02182539]
Stock Position:  0.0218253930661081
Bond Position:  [-11.28283339]


portfolio before change:  [-9.15920981]
curr_Stock_Price:  97.55913242619147
curr_Factors:  [97.55913243]
mat_Sqrt:  [[0.15]]
grads:  [0.00668627]
Stock Position:  0.006686269880830553
Bond Position:  [-9.8115165]


portfolio before change:  [-9.17254439]
curr_Stock_Price:  96.29869987040507
curr_Factors:  [96.29869987]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231001]
Stock Position:  -0.03231001235495171
Bond Position:  [-6.0611322]


portfolio before change:  [-9.18208844]
curr_Stock_Price:  96.50026984280068
curr_Factors:  [96.50026984]
mat_Sqrt:  [[0.15]]
grads:  [0.0658062]
Stock Position:  0.06580620304943662
Bond Position:  [-15.53240479]


portfolio before change:  [-9.11173537]
curr_Stock_Price:  97.68741043224937
curr_Factors:  [97.68741043]
mat_Sqrt:  [[0.15]]
grads:  [0.10888119]
Stock Position:  0.10888119117128627
Bond Position:  [-19.74805698]


portfolio before change:  [-8.95169616]
curr_Stock_Price:  99.24797111954078
curr_Factors:  [99.24797112]
mat_Sqrt:  [[0.15]]
grads:  [0.1152535]
Stock Position:  0.11525350454819688
Bond Position:  [-20.39037265]


portfolio before change:  [-9.3087318]
curr_Stock_Price:  96.2386230895465
curr_Factors:  [96.23862309]
mat_Sqrt:  [[0.15]]
grads:  [0.04745696]
Stock Position:  0.04745696145261838
Bond Position:  [-13.87592443]


portfolio before change:  [-9.3203336]
curr_Stock_Price:  96.14038446991754
curr_Factors:  [96.14038447]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.3203336]
Stock Price:  98.23624963565604
PL:  [-9.3203336]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.79202414e-02]
 [ 7.06815855e-03]
 [-1.05599185e-03]
 [-9.40700755e-03]
 [-5.71885092e-04]
 [ 1.64231551e-02]
 [ 2.20615901e-02]
 [ 1.70380716e-03]
 [ 3.68230669e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.50168667]
curr_Stock_Price:  99.94303475818728
curr_Factors:  [99.94303476]
mat_Sqrt:  [[0.15]]
grads:  [0.11946828]
Stock Position:  0.11946827606934571
Bond Position:  [-11.4383354]


portfolio before change:  [0.65234831]
curr_Stock_Price:  101.25202022512717
curr_Factors:  [101.25202023]
mat_Sqrt:  [[0.15]]
grads:  [0.04712106]
Stock Position:  0.04712105702636179
Bond Position:  [-4.11875391]


portfolio before change:  [0.70466298]
curr_Stock_Price:  102.40595360290834
curr_Factors:  [102.4059536]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703995]
Stock Position:  -0.007039945654404103
Bond Position:  [1.42559533]


portfolio before change:  [0.70205163]
curr_Stock_Price:  102.87816257952113
curr_Factors:  [102.87816258]
mat_Sqrt:  [[0.15]]
grads:  [-0.06271338]
Stock Position:  -0.0627133836708269
Bond Position:  [7.15388931]


portfolio before change:  [0.51458764]
curr_Stock_Price:  105.9244315491356
curr_Factors:  [105.92443155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381257]
Stock Position:  -0.0038125672825733113
Bond Position:  [0.91843166]


portfolio before change:  [0.51193607]
curr_Stock_Price:  106.74038945139114
curr_Factors:  [106.74038945]
mat_Sqrt:  [[0.15]]
grads:  [0.1094877]
Stock Position:  0.10948770034266399
Bond Position:  [-11.1748237]


portfolio before change:  [0.11533351]
curr_Stock_Price:  103.16908643698386
curr_Factors:  [103.16908644]
mat_Sqrt:  [[0.15]]
grads:  [0.14707727]
Stock Position:  0.147077267330602
Bond Position:  [-15.0584938]


portfolio before change:  [-0.0162039]
curr_Stock_Price:  102.3259494770967
curr_Factors:  [102.32594948]
mat_Sqrt:  [[0.15]]
grads:  [0.01135871]
Stock Position:  0.011358714404870336
Bond Position:  [-1.17849514]


portfolio before change:  [0.00723673]
curr_Stock_Price:  104.4415080964667
curr_Factors:  [104.4415081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.00723673]
Stock Price:  105.38789202330133
PL:  [-5.38065529]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.02804380e-03]
 [ 6.56416122e-03]
 [-5.05043295e-03]
 [-1.45780102e-02]
 [ 5.49102578e-03]
 [ 1.64355403e-02]
 [ 2.09805024e-02]
 [ 1.25394426e-03]
 [-3.27985612e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.99761904]
curr_Stock_Price:  101.86405704813153
curr_Factors:  [101.86405705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685363]
Stock Position:  -0.0068536253061958485
Bond Position:  [30.69575712]


portfolio before change:  [29.99918499]
curr_Stock_Price:  103.87551333729544
curr_Factors:  [103.87551334]
mat_Sqrt:  [[0.15]]
grads:  [0.04376107]
Stock Position:  0.043761074821021886
Bond Position:  [25.45348088]


portfolio before change:  [30.07663481]
curr_Stock_Price:  105.35445078599284
curr_Factors:  [105.35445079]
mat_Sqrt:  [[0.15]]
grads:  [-0.03366955]
Stock Position:  -0.03366955302926022
Bond Position:  [33.62387207]


portfolio before change:  [30.0216447]
curr_Stock_Price:  107.48712674284839
curr_Factors:  [107.48712674]
mat_Sqrt:  [[0.15]]
grads:  [-0.09718673]
Stock Position:  -0.09718673475038252
Bond Position:  [40.46796758]


portfolio before change:  [30.43657826]
curr_Stock_Price:  103.42592936690713
curr_Factors:  [103.42592937]
mat_Sqrt:  [[0.15]]
grads:  [0.03660684]
Stock Position:  0.03660683856118212
Bond Position:  [26.65048196]


portfolio before change:  [30.44686106]
curr_Stock_Price:  103.34272707645975
curr_Factors:  [103.34272708]
mat_Sqrt:  [[0.15]]
grads:  [0.10957027]
Stock Position:  0.10957026859510866
Bond Position:  [19.12357069]


portfolio before change:  [30.47522466]
curr_Stock_Price:  103.514301254416
curr_Factors:  [103.51430125]
mat_Sqrt:  [[0.15]]
grads:  [0.13987002]
Stock Position:  0.13987001598538337
Bond Position:  [15.99667769]


portfolio before change:  [30.75063428]
curr_Stock_Price:  105.42614260453578
curr_Factors:  [105.4261426]
mat_Sqrt:  [[0.15]]
grads:  [0.00835963]
Stock Position:  0.008359628424119013
Bond Position:  [29.8693109]


portfolio before change:  [30.74867542]
curr_Stock_Price:  103.40485093844815
curr_Factors:  [103.40485094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.74867542]
Stock Price:  104.38276224766486
PL:  [26.36591317]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.59493447e-02]
 [ 4.31557515e-03]
 [ 2.10792603e-03]
 [-6.44004218e-03]
 [ 9.92041137e-03]
 [ 1.60385551e-02]
 [ 2.47146076e-02]
 [ 1.51661509e-03]
 [ 4.78312243e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96869644]
curr_Stock_Price:  99.58675756845642
curr_Factors:  [99.58675757]
mat_Sqrt:  [[0.15]]
grads:  [0.17299563]
Stock Position:  0.17299563146394703
Bond Position:  [-22.19677045]


portfolio before change:  [-5.12681702]
curr_Stock_Price:  98.73691290133817
curr_Factors:  [98.7369129]
mat_Sqrt:  [[0.15]]
grads:  [0.0287705]
Stock Position:  0.028770500973713642
Bond Position:  [-7.96752746]


portfolio before change:  [-5.10396018]
curr_Stock_Price:  99.6698684439518
curr_Factors:  [99.66986844]
mat_Sqrt:  [[0.15]]
grads:  [0.01405284]
Stock Position:  0.014052840228328615
Bond Position:  [-6.50460491]


portfolio before change:  [-5.09791458]
curr_Stock_Price:  100.33156474083505
curr_Factors:  [100.33156474]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293361]
Stock Position:  -0.04293361452693989
Bond Position:  [-0.79031785]


portfolio before change:  [-5.18615474]
curr_Stock_Price:  102.37762830075545
curr_Factors:  [102.3776283]
mat_Sqrt:  [[0.15]]
grads:  [0.06613608]
Stock Position:  0.06613607582096268
Bond Position:  [-11.95700933]


portfolio before change:  [-5.27781492]
curr_Stock_Price:  101.08211480237107
curr_Factors:  [101.0821148]
mat_Sqrt:  [[0.15]]
grads:  [0.1069237]
Stock Position:  0.10692370046380686
Bond Position:  [-16.08588869]


portfolio before change:  [-5.21629944]
curr_Stock_Price:  101.73267620963149
curr_Factors:  [101.73267621]
mat_Sqrt:  [[0.15]]
grads:  [0.16476405]
Stock Position:  0.1647640506749495
Bond Position:  [-21.97818726]


portfolio before change:  [-4.92954899]
curr_Stock_Price:  103.53975908885606
curr_Factors:  [103.53975909]
mat_Sqrt:  [[0.15]]
grads:  [0.01011077]
Stock Position:  0.010110767237879506
Bond Position:  [-5.97641539]


portfolio before change:  [-4.92112636]
curr_Stock_Price:  104.6684158824544
curr_Factors:  [104.66841588]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.92112636]
Stock Price:  105.3443649663601
PL:  [-10.26549132]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.00846377e-02]
 [ 6.75634299e-03]
 [ 1.86134207e-03]
 [-7.83006202e-03]
 [ 1.17278730e-02]
 [ 1.64269522e-02]
 [ 1.07015622e-02]
 [ 1.85957366e-03]
 [ 2.06540397e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11478043]
curr_Stock_Price:  100.24347808094241
curr_Factors:  [100.24347808]
mat_Sqrt:  [[0.15]]
grads:  [0.06723092]
Stock Position:  0.06723091787359181
Bond Position:  [-1.62468061]


portfolio before change:  [5.10655911]
curr_Stock_Price:  100.13327917171937
curr_Factors:  [100.13327917]
mat_Sqrt:  [[0.15]]
grads:  [0.04504229]
Stock Position:  0.04504228659016891
Bond Position:  [0.59632725]


portfolio before change:  [5.0662588]
curr_Stock_Price:  99.23193624712711
curr_Factors:  [99.23193625]
mat_Sqrt:  [[0.15]]
grads:  [0.01240895]
Stock Position:  0.012408947140338
Bond Position:  [3.83489495]


portfolio before change:  [5.09701237]
curr_Stock_Price:  101.55571410846957
curr_Factors:  [101.55571411]
mat_Sqrt:  [[0.15]]
grads:  [-0.05220041]
Stock Position:  -0.052200413455252906
Bond Position:  [10.39826263]


portfolio before change:  [5.08376035]
curr_Stock_Price:  101.90920651641811
curr_Factors:  [101.90920652]
mat_Sqrt:  [[0.15]]
grads:  [0.07818582]
Stock Position:  0.07818581988214292
Bond Position:  [-2.88409452]


portfolio before change:  [5.31629196]
curr_Stock_Price:  104.90174435947691
curr_Factors:  [104.90174436]
mat_Sqrt:  [[0.15]]
grads:  [0.10951301]
Stock Position:  0.10951301487679142
Bond Position:  [-6.17181433]


portfolio before change:  [5.52054775]
curr_Stock_Price:  106.79505777313351
curr_Factors:  [106.79505777]
mat_Sqrt:  [[0.15]]
grads:  [0.07134375]
Stock Position:  0.07134374770157331
Bond Position:  [-2.09861191]


portfolio before change:  [5.46569033]
curr_Stock_Price:  106.04085222790599
curr_Factors:  [106.04085223]
mat_Sqrt:  [[0.15]]
grads:  [0.01239716]
Stock Position:  0.01239715773465329
Bond Position:  [4.15108516]


portfolio before change:  [5.48811053]
curr_Stock_Price:  107.68188504188387
curr_Factors:  [107.68188504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.48811053]
Stock Price:  106.7078128518914
PL:  [-1.21970232]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.57488979e-02]
 [ 6.28846631e-03]
 [-2.29600358e-04]
 [-6.97634020e-03]
 [ 5.12430610e-03]
 [ 1.60258901e-02]
 [ 1.61117259e-02]
 [ 3.78356693e-03]
 [-6.33166069e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.7636056]
curr_Stock_Price:  99.60011480290952
curr_Factors:  [99.6001148]
mat_Sqrt:  [[0.15]]
grads:  [0.17165932]
Stock Position:  0.17165931923114358
Bond Position:  [-21.8608935]


portfolio before change:  [-4.73184935]
curr_Stock_Price:  99.84880173013157
curr_Factors:  [99.84880173]
mat_Sqrt:  [[0.15]]
grads:  [0.04192311]
Stock Position:  0.041923108763211855
Bond Position:  [-8.91782152]


portfolio before change:  [-4.6582205]
curr_Stock_Price:  101.71147065382492
curr_Factors:  [101.71147065]
mat_Sqrt:  [[0.15]]
grads:  [-0.00153067]
Stock Position:  -0.001530669050856609
Bond Position:  [-4.5025339]


portfolio before change:  [-4.65911436]
curr_Stock_Price:  100.82429947761622
curr_Factors:  [100.82429948]
mat_Sqrt:  [[0.15]]
grads:  [-0.04650893]
Stock Position:  -0.04650893466565273
Bond Position:  [0.03011639]


portfolio before change:  [-4.78414459]
curr_Stock_Price:  103.51292877795179
curr_Factors:  [103.51292878]
mat_Sqrt:  [[0.15]]
grads:  [0.03416204]
Stock Position:  0.03416204069798636
Bond Position:  [-8.32035747]


portfolio before change:  [-4.87512831]
curr_Stock_Price:  100.97143830224847
curr_Factors:  [100.9714383]
mat_Sqrt:  [[0.15]]
grads:  [0.10683927]
Stock Position:  0.1068392675991268
Bond Position:  [-15.66284282]


portfolio before change:  [-5.11520802]
curr_Stock_Price:  98.79764641809543
curr_Factors:  [98.79764642]
mat_Sqrt:  [[0.15]]
grads:  [0.10741151]
Stock Position:  0.10741150623251923
Bond Position:  [-15.72721203]


portfolio before change:  [-5.28491244]
curr_Stock_Price:  97.29092847421464
curr_Factors:  [97.29092847]
mat_Sqrt:  [[0.15]]
grads:  [0.02522378]
Stock Position:  0.025223779500083872
Bond Position:  [-7.73895736]


portfolio before change:  [-5.28170933]
curr_Stock_Price:  97.57136041893004
curr_Factors:  [97.57136042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.28170933]
Stock Price:  99.61966159587149
PL:  [-5.28170933]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.81266596e-03]
 [ 6.84702454e-03]
 [-3.84124762e-06]
 [-9.02456705e-03]
 [ 2.30256872e-03]
 [ 1.64307288e-02]
 [ 1.78652547e-02]
 [ 1.31361880e-03]
 [ 1.24440562e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.05443574]
curr_Stock_Price:  101.41185876796112
curr_Factors:  [101.41185877]
mat_Sqrt:  [[0.15]]
grads:  [0.01208444]
Stock Position:  0.012084439764550153
Bond Position:  [21.82893024]


portfolio before change:  [23.07829989]
curr_Stock_Price:  102.4832326743433
curr_Factors:  [102.48323267]
mat_Sqrt:  [[0.15]]
grads:  [0.04564683]
Stock Position:  0.045646830274869606
Bond Position:  [18.40026516]


portfolio before change:  [23.01083999]
curr_Stock_Price:  100.80376595544053
curr_Factors:  [100.80376596]
mat_Sqrt:  [[0.15]]
grads:  [-2.56083175e-05]
Stock Position:  -2.560831746994171e-05
Bond Position:  [23.0134214]


portfolio before change:  [23.02230456]
curr_Stock_Price:  102.56178965836295
curr_Factors:  [102.56178966]
mat_Sqrt:  [[0.15]]
grads:  [-0.06016378]
Stock Position:  -0.06016378032900757
Bond Position:  [29.19280954]


portfolio before change:  [22.93496377]
curr_Stock_Price:  104.25617857809537
curr_Factors:  [104.25617858]
mat_Sqrt:  [[0.15]]
grads:  [0.01535046]
Stock Position:  0.015350458143498046
Bond Position:  [21.33458366]


portfolio before change:  [22.94501964]
curr_Stock_Price:  104.21617396856992
curr_Factors:  [104.21617397]
mat_Sqrt:  [[0.15]]
grads:  [0.10953819]
Stock Position:  0.10953819192548432
Bond Position:  [11.52936837]


portfolio before change:  [22.9828688]
curr_Stock_Price:  104.5090676083305
curr_Factors:  [104.50906761]
mat_Sqrt:  [[0.15]]
grads:  [0.1191017]
Stock Position:  0.1191016978820104
Bond Position:  [10.53566141]


portfolio before change:  [23.04632143]
curr_Stock_Price:  104.99758693593374
curr_Factors:  [104.99758694]
mat_Sqrt:  [[0.15]]
grads:  [0.00875746]
Stock Position:  0.008757458695062436
Bond Position:  [22.1268094]


portfolio before change:  [23.0472768]
curr_Stock_Price:  103.84305057045032
curr_Factors:  [103.84305057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.0472768]
Stock Price:  103.26692003227205
PL:  [19.78035677]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-4.73099477e-02]
 [ 1.90562046e-03]
 [ 1.17477105e-03]
 [-4.89501511e-03]
 [ 1.50720933e-02]
 [ 1.66977083e-02]
 [ 9.29077885e-03]
 [ 2.19201288e-02]
 [-3.37532646e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-44.67533999]
curr_Stock_Price:  97.00072820128364
curr_Factors:  [97.0007282]
mat_Sqrt:  [[0.15]]
grads:  [-0.31539965]
Stock Position:  -0.31539965119927926
Bond Position:  [-14.08134415]


portfolio before change:  [-44.35392625]
curr_Stock_Price:  95.95933145577291
curr_Factors:  [95.95933146]
mat_Sqrt:  [[0.15]]
grads:  [0.01270414]
Stock Position:  0.012704136399020476
Bond Position:  [-45.57300669]


portfolio before change:  [-44.35953374]
curr_Stock_Price:  97.31201784088744
curr_Factors:  [97.31201784]
mat_Sqrt:  [[0.15]]
grads:  [0.00783181]
Stock Position:  0.007831807011484908
Bond Position:  [-45.12166269]


portfolio before change:  [-44.39507609]
curr_Stock_Price:  95.6552006963441
curr_Factors:  [95.6552007]
mat_Sqrt:  [[0.15]]
grads:  [-0.03263343]
Stock Position:  -0.032633434041050007
Bond Position:  [-41.2735184]


portfolio before change:  [-44.35737898]
curr_Stock_Price:  93.86749348904992
curr_Factors:  [93.86749349]
mat_Sqrt:  [[0.15]]
grads:  [0.10048062]
Stock Position:  0.10048062205460745
Bond Position:  [-53.78924312]


portfolio before change:  [-44.51339902]
curr_Stock_Price:  92.58248263785364
curr_Factors:  [92.58248264]
mat_Sqrt:  [[0.15]]
grads:  [0.11131806]
Stock Position:  0.11131805542578935
Bond Position:  [-54.81950095]


portfolio before change:  [-44.55777997]
curr_Stock_Price:  92.43008729282126
curr_Factors:  [92.43008729]
mat_Sqrt:  [[0.15]]
grads:  [0.06193853]
Stock Position:  0.061938525678496885
Bond Position:  [-50.28276331]


portfolio before change:  [-44.60707763]
curr_Stock_Price:  92.04018480551441
curr_Factors:  [92.04018481]
mat_Sqrt:  [[0.15]]
grads:  [0.14613419]
Stock Position:  0.14613419174690045
Bond Position:  [-58.05729564]


portfolio before change:  [-44.46713046]
curr_Stock_Price:  93.19654028968598
curr_Factors:  [93.19654029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-44.46713046]
Stock Price:  92.1545292905038
PL:  [-44.46713046]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.59966644e-02]
 [ 3.68355208e-03]
 [ 7.68882610e-04]
 [-4.69661725e-03]
 [ 1.21600548e-02]
 [ 1.61924647e-02]
 [ 2.34721340e-02]
 [ 1.59085761e-03]
 [ 1.74383971e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.02232848]
curr_Stock_Price:  99.58326460043662
curr_Factors:  [99.5832646]
mat_Sqrt:  [[0.15]]
grads:  [0.1733111]
Stock Position:  0.1733110962162776
Bond Position:  [-22.28121323]


portfolio before change:  [-5.27505961]
curr_Stock_Price:  98.18931038756816
curr_Factors:  [98.18931039]
mat_Sqrt:  [[0.15]]
grads:  [0.02455701]
Stock Position:  0.024557013887859778
Bond Position:  [-7.68629587]


portfolio before change:  [-5.27395322]
curr_Stock_Price:  98.39090213895133
curr_Factors:  [98.39090214]
mat_Sqrt:  [[0.15]]
grads:  [0.00512588]
Stock Position:  0.005125884067675809
Bond Position:  [-5.77829358]


portfolio before change:  [-5.27737656]
curr_Stock_Price:  98.28682911705542
curr_Factors:  [98.28682912]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131078]
Stock Position:  -0.031310781681390495
Bond Position:  [-2.19993911]


portfolio before change:  [-5.36292593]
curr_Stock_Price:  100.9839552039656
curr_Factors:  [100.9839552]
mat_Sqrt:  [[0.15]]
grads:  [0.08106703]
Stock Position:  0.08106703233266696
Bond Position:  [-13.54939549]


portfolio before change:  [-5.2761158]
curr_Stock_Price:  102.13838895179208
curr_Factors:  [102.13838895]
mat_Sqrt:  [[0.15]]
grads:  [0.10794976]
Stock Position:  0.10794976486715735
Bond Position:  [-16.30193088]


portfolio before change:  [-5.38056269]
curr_Stock_Price:  101.2463640378967
curr_Factors:  [101.24636404]
mat_Sqrt:  [[0.15]]
grads:  [0.15648089]
Stock Position:  0.15648089329613254
Bond Position:  [-21.22368418]


portfolio before change:  [-4.67331028]
curr_Stock_Price:  105.83393310465694
curr_Factors:  [105.8339331]
mat_Sqrt:  [[0.15]]
grads:  [0.01060572]
Stock Position:  0.010605717378133674
Bond Position:  [-5.79575506]


portfolio before change:  [-4.66238418]
curr_Stock_Price:  107.1374472249792
curr_Factors:  [107.13744722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.66238418]
Stock Price:  109.56161623327924
PL:  [-14.22400041]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.45449155e-03]
 [ 4.55750473e-03]
 [ 1.59296084e-03]
 [-5.33018005e-03]
 [ 1.28634336e-02]
 [ 1.59285042e-02]
 [ 1.92692156e-02]
 [ 3.25369269e-03]
 [-7.46065117e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.26203456]
curr_Stock_Price:  98.46047047301823
curr_Factors:  [98.46047047]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636328]
Stock Position:  -0.016363276994591204
Bond Position:  [-20.65089861]


portfolio before change:  [-22.27994272]
curr_Stock_Price:  98.92371062298896
curr_Factors:  [98.92371062]
mat_Sqrt:  [[0.15]]
grads:  [0.03038336]
Stock Position:  0.030383364899399606
Bond Position:  [-25.28557792]


portfolio before change:  [-22.28729026]
curr_Stock_Price:  99.09809578856215
curr_Factors:  [99.09809579]
mat_Sqrt:  [[0.15]]
grads:  [0.01061974]
Stock Position:  0.010619738947571535
Bond Position:  [-23.33968617]


portfolio before change:  [-22.29411091]
curr_Stock_Price:  99.55499086924085
curr_Factors:  [99.55499087]
mat_Sqrt:  [[0.15]]
grads:  [-0.03553453]
Stock Position:  -0.035534533672318146
Bond Position:  [-18.75647074]


portfolio before change:  [-22.30527569]
curr_Stock_Price:  99.60520112096052
curr_Factors:  [99.60520112]
mat_Sqrt:  [[0.15]]
grads:  [0.08575622]
Stock Position:  0.08575622386507725
Bond Position:  [-30.84704162]


portfolio before change:  [-22.30234819]
curr_Stock_Price:  99.81923662481191
curr_Factors:  [99.81923662]
mat_Sqrt:  [[0.15]]
grads:  [0.10619003]
Stock Position:  0.10619002817086269
Bond Position:  [-32.90215574]


portfolio before change:  [-22.32309095]
curr_Stock_Price:  99.77886032048569
curr_Factors:  [99.77886032]
mat_Sqrt:  [[0.15]]
grads:  [0.12846144]
Stock Position:  0.12846143732547136
Bond Position:  [-35.14082676]


portfolio before change:  [-22.23016076]
curr_Stock_Price:  100.63907947447684
curr_Factors:  [100.63907947]
mat_Sqrt:  [[0.15]]
grads:  [0.02169128]
Stock Position:  0.021691284597362654
Bond Position:  [-24.41315168]


portfolio before change:  [-22.29001399]
curr_Stock_Price:  98.44263983620102
curr_Factors:  [98.44263984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.29001399]
Stock Price:  97.66232162227283
PL:  [-22.29001399]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [ 0.00287798]
 [ 0.00697095]
 [-0.00331883]
 [-0.01253627]
 [ 0.01045488]
 [ 0.01616883]
 [ 0.02360709]
 [ 0.0026267 ]
 [-0.00516311]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.45061767]
curr_Stock_Price:  101.24227631539695
curr_Factors:  [101.24227632]
mat_Sqrt:  [[0.15]]
grads:  [0.01918655]
Stock Position:  0.01918655328941072
Bond Position:  [18.50812734]


portfolio before change:  [20.46878211]
curr_Stock_Price:  101.70656318870023
curr_Factors:  [101.70656319]
mat_Sqrt:  [[0.15]]
grads:  [0.04647297]
Stock Position:  0.04647296952507041
Bond Position:  [15.7421761]


portfolio before change:  [20.58443306]
curr_Stock_Price:  104.02571550122849
curr_Factors:  [104.0257155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02212554]
Stock Position:  -0.02212554170589909
Bond Position:  [22.88605837]


portfolio before change:  [20.56392222]
curr_Stock_Price:  105.47005239146668
curr_Factors:  [105.47005239]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357515]
Stock Position:  -0.08357515223703203
Bond Position:  [29.3785979]


portfolio before change:  [20.84763438]
curr_Stock_Price:  102.25116272620062
curr_Factors:  [102.25116273]
mat_Sqrt:  [[0.15]]
grads:  [0.06969923]
Stock Position:  0.06969922882485396
Bond Position:  [13.72080719]


portfolio before change:  [20.83852484]
curr_Stock_Price:  102.02201154715453
curr_Factors:  [102.02201155]
mat_Sqrt:  [[0.15]]
grads:  [0.10779222]
Stock Position:  0.10779221635027063
Bond Position:  [9.8413461]


portfolio before change:  [20.76524614]
curr_Stock_Price:  101.29653610272854
curr_Factors:  [101.2965361]
mat_Sqrt:  [[0.15]]
grads:  [0.1573806]
Stock Position:  0.157380597760339
Bond Position:  [4.82313674]


portfolio before change:  [20.76101827]
curr_Stock_Price:  101.2543451386956
curr_Factors:  [101.25434514]
mat_Sqrt:  [[0.15]]
grads:  [0.01751136]
Stock Position:  0.017511357384280498
Bond Position:  [18.98791725]


portfolio before change:  [20.75606801]
curr_Stock_Price:  100.42936118686681
curr_Factors:  [100.42936119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.75606801]
Stock Price:  99.3423493602325
PL:  [20.75606801]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.00298656]
 [ 0.00698063]
 [-0.00417618]
 [-0.01330059]
 [-0.00260728]
 [ 0.01642142]
 [ 0.01013142]
 [ 0.00323685]
 [ 0.00387897]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [44.0316254]
curr_Stock_Price:  102.7780691460353
curr_Factors:  [102.77806915]
mat_Sqrt:  [[0.15]]
grads:  [-0.0199104]
Stock Position:  -0.019910403797867664
Bond Position:  [46.07797826]


portfolio before change:  [44.07690632]
curr_Stock_Price:  101.66125735861172
curr_Factors:  [101.66125736]
mat_Sqrt:  [[0.15]]
grads:  [0.04653757]
Stock Position:  0.04653756659194652
Bond Position:  [39.34583879]


portfolio before change:  [44.23723658]
curr_Stock_Price:  104.68359885530218
curr_Factors:  [104.68359886]
mat_Sqrt:  [[0.15]]
grads:  [-0.02784121]
Stock Position:  -0.027841212070011032
Bond Position:  [47.15175485]


portfolio before change:  [44.21790007]
curr_Stock_Price:  106.225136583608
curr_Factors:  [106.22513658]
mat_Sqrt:  [[0.15]]
grads:  [-0.0886706]
Stock Position:  -0.08867059692345018
Bond Position:  [53.63694634]


portfolio before change:  [44.14170716]
curr_Stock_Price:  107.38694320231548
curr_Factors:  [107.3869432]
mat_Sqrt:  [[0.15]]
grads:  [-0.01738187]
Stock Position:  -0.017381873170908623
Bond Position:  [46.00829339]


portfolio before change:  [44.18095177]
curr_Stock_Price:  106.45294085475918
curr_Factors:  [106.45294085]
mat_Sqrt:  [[0.15]]
grads:  [0.10947613]
Stock Position:  0.10947612867129551
Bond Position:  [32.52689592]


portfolio before change:  [44.25459056]
curr_Stock_Price:  106.97699369026665
curr_Factors:  [106.97699369]
mat_Sqrt:  [[0.15]]
grads:  [0.06754278]
Stock Position:  0.0675427758857443
Bond Position:  [37.02906745]


portfolio before change:  [44.2815122]
curr_Stock_Price:  107.10139600369223
curr_Factors:  [107.101396]
mat_Sqrt:  [[0.15]]
grads:  [0.02157901]
Stock Position:  0.021579010479661785
Bond Position:  [41.97037006]


portfolio before change:  [44.24597967]
curr_Stock_Price:  104.48204659013632
curr_Factors:  [104.48204659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [44.24597967]
Stock Price:  105.65620677284068
PL:  [38.5897729]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.45249213e-03]
 [ 6.81483971e-03]
 [ 1.93960026e-03]
 [-5.10599068e-03]
 [ 9.75270510e-03]
 [ 1.60421153e-02]
 [ 2.38548084e-02]
 [ 1.60579993e-03]
 [-2.93608110e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.93476256]
curr_Stock_Price:  101.46919302750987
curr_Factors:  [101.46919303]
mat_Sqrt:  [[0.15]]
grads:  [0.00968328]
Stock Position:  0.009683280835532798
Bond Position:  [22.95220787]


portfolio before change:  [23.93587363]
curr_Stock_Price:  100.39849159335441
curr_Factors:  [100.39849159]
mat_Sqrt:  [[0.15]]
grads:  [0.04543226]
Stock Position:  0.045432264743913826
Bond Position:  [19.37454278]


portfolio before change:  [23.89439622]
curr_Stock_Price:  99.27226321446787
curr_Factors:  [99.27226321]
mat_Sqrt:  [[0.15]]
grads:  [0.01293067]
Stock Position:  0.012930668368677982
Bond Position:  [22.6107395]


portfolio before change:  [23.90560737]
curr_Stock_Price:  99.26475797096306
curr_Factors:  [99.26475797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03403994]
Stock Position:  -0.034039937896576
Bond Position:  [27.28457356]


portfolio before change:  [23.93337947]
curr_Stock_Price:  98.84976281413564
curr_Factors:  [98.84976281]
mat_Sqrt:  [[0.15]]
grads:  [0.06501803]
Stock Position:  0.0650180340056123
Bond Position:  [17.50636223]


portfolio before change:  [24.08930082]
curr_Stock_Price:  101.11322672716496
curr_Factors:  [101.11322673]
mat_Sqrt:  [[0.15]]
grads:  [0.10694744]
Stock Position:  0.106947435122322
Bond Position:  [13.27550056]


portfolio before change:  [24.12597758]
curr_Stock_Price:  101.3940876499104
curr_Factors:  [101.39408765]
mat_Sqrt:  [[0.15]]
grads:  [0.15903206]
Stock Position:  0.15903205618841035
Bond Position:  [8.00106734]


portfolio before change:  [24.36935195]
curr_Stock_Price:  102.8992736885232
curr_Factors:  [102.89927369]
mat_Sqrt:  [[0.15]]
grads:  [0.01070533]
Stock Position:  0.010705332889480635
Bond Position:  [23.26778097]


portfolio before change:  [24.37180288]
curr_Stock_Price:  102.0412089049522
curr_Factors:  [102.0412089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.37180288]
Stock Price:  105.33477349850007
PL:  [19.03702938]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.29415234e-02]
 [ 7.01548884e-03]
 [ 1.44538449e-03]
 [-5.30232336e-03]
 [ 1.29896910e-02]
 [ 1.59284729e-02]
 [ 1.62097412e-02]
 [ 3.65735724e-03]
 [-6.12056790e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.71790422]
curr_Stock_Price:  99.14719259967808
curr_Factors:  [99.1471926]
mat_Sqrt:  [[0.15]]
grads:  [0.15294349]
Stock Position:  0.15294348922751264
Bond Position:  [-26.88182181]


portfolio before change:  [-11.37176346]
curr_Stock_Price:  101.49828993897731
curr_Factors:  [101.49828994]
mat_Sqrt:  [[0.15]]
grads:  [0.04676993]
Stock Position:  0.046769925590428287
Bond Position:  [-16.11883093]


portfolio before change:  [-11.4949747]
curr_Stock_Price:  99.03624177056379
curr_Factors:  [99.03624177]
mat_Sqrt:  [[0.15]]
grads:  [0.0096359]
Stock Position:  0.009635896594720807
Bond Position:  [-12.44927769]


portfolio before change:  [-11.49652864]
curr_Stock_Price:  99.5211225666812
curr_Factors:  [99.52112257]
mat_Sqrt:  [[0.15]]
grads:  [-0.03534882]
Stock Position:  -0.035348822373207855
Bond Position:  [-7.97857415]


portfolio before change:  [-11.53409367]
curr_Stock_Price:  100.47093485071461
curr_Factors:  [100.47093485]
mat_Sqrt:  [[0.15]]
grads:  [0.08659794]
Stock Position:  0.08659793989778601
Bond Position:  [-20.23466965]


portfolio before change:  [-11.60052974]
curr_Stock_Price:  99.82061674014642
curr_Factors:  [99.82061674]
mat_Sqrt:  [[0.15]]
grads:  [0.10618982]
Stock Position:  0.10618981924242886
Bond Position:  [-22.20046299]


portfolio before change:  [-11.71627719]
curr_Stock_Price:  98.83516973880864
curr_Factors:  [98.83516974]
mat_Sqrt:  [[0.15]]
grads:  [0.10806494]
Stock Position:  0.10806494100277987
Bond Position:  [-22.39689398]


portfolio before change:  [-11.65699791]
curr_Stock_Price:  99.48737506240609
curr_Factors:  [99.48737506]
mat_Sqrt:  [[0.15]]
grads:  [0.02438238]
Stock Position:  0.024382381576777877
Bond Position:  [-14.08273705]


portfolio before change:  [-11.65564476]
curr_Stock_Price:  99.83173346746104
curr_Factors:  [99.83173347]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.65564476]
Stock Price:  97.20220603671032
PL:  [-11.65564476]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.67209507e-03]
 [ 6.70053219e-03]
 [-7.01315126e-05]
 [-8.54515799e-03]
 [ 1.24104285e-02]
 [ 1.61233201e-02]
 [ 2.26911696e-02]
 [ 1.75731306e-03]
 [-1.89162028e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.80164149]
curr_Stock_Price:  100.6138541286389
curr_Factors:  [100.61385413]
mat_Sqrt:  [[0.15]]
grads:  [0.03781397]
Stock Position:  0.037813967116736874
Bond Position:  [6.99703252]


portfolio before change:  [10.90309524]
curr_Stock_Price:  103.20428219862852
curr_Factors:  [103.2042822]
mat_Sqrt:  [[0.15]]
grads:  [0.04467021]
Stock Position:  0.04467021463328476
Bond Position:  [6.2929378]


portfolio before change:  [10.81009583]
curr_Stock_Price:  101.05191592405778
curr_Factors:  [101.05191592]
mat_Sqrt:  [[0.15]]
grads:  [-0.00046754]
Stock Position:  -0.00046754341734049534
Bond Position:  [10.85734199]


portfolio before change:  [10.81500535]
curr_Stock_Price:  102.1651997501114
curr_Factors:  [102.16519975]
mat_Sqrt:  [[0.15]]
grads:  [-0.05696772]
Stock Position:  -0.05696771995914898
Bond Position:  [16.63512384]


portfolio before change:  [10.90613382]
curr_Stock_Price:  100.71159008994704
curr_Factors:  [100.71159009]
mat_Sqrt:  [[0.15]]
grads:  [0.08273619]
Stock Position:  0.08273618982329606
Bond Position:  [2.57364059]


portfolio before change:  [10.99597372]
curr_Stock_Price:  101.78189266255008
curr_Factors:  [101.78189266]
mat_Sqrt:  [[0.15]]
grads:  [0.1074888]
Stock Position:  0.10748880091862442
Bond Position:  [0.05556012]


portfolio before change:  [10.91336068]
curr_Stock_Price:  101.01306072189722
curr_Factors:  [101.01306072]
mat_Sqrt:  [[0.15]]
grads:  [0.15127446]
Stock Position:  0.15127446400465194
Bond Position:  [-4.36733593]


portfolio before change:  [11.09233226]
curr_Stock_Price:  102.21059124344963
curr_Factors:  [102.21059124]
mat_Sqrt:  [[0.15]]
grads:  [0.01171542]
Stock Position:  0.011715420386513166
Bond Position:  [9.89489221]


portfolio before change:  [11.10616709]
curr_Stock_Price:  102.96909161694043
curr_Factors:  [102.96909162]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.10616709]
Stock Price:  101.8415984160049
PL:  [9.26456868]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.59984793e-03]
 [ 6.88921036e-03]
 [-1.22073427e-04]
 [-7.30450617e-03]
 [ 1.23172695e-02]
 [ 1.61278729e-02]
 [ 2.16081701e-02]
 [ 3.13028987e-03]
 [ 1.13855353e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.01357515]
curr_Stock_Price:  100.62765702478616
curr_Factors:  [100.62765702]
mat_Sqrt:  [[0.15]]
grads:  [0.03733232]
Stock Position:  0.0373323195596646
Bond Position:  [7.2569113]


portfolio before change:  [11.07174994]
curr_Stock_Price:  102.08873484699478
curr_Factors:  [102.08873485]
mat_Sqrt:  [[0.15]]
grads:  [0.04592807]
Stock Position:  0.04592806905374527
Bond Position:  [6.38301147]


portfolio before change:  [11.03530274]
curr_Stock_Price:  101.22565687125955
curr_Factors:  [101.22565687]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081382]
Stock Position:  -0.0008138228471300766
Bond Position:  [11.11768249]


portfolio before change:  [11.04096079]
curr_Stock_Price:  101.10545123445364
curr_Factors:  [101.10545123]
mat_Sqrt:  [[0.15]]
grads:  [-0.04869671]
Stock Position:  -0.04869670777436413
Bond Position:  [15.96446341]


portfolio before change:  [11.02305703]
curr_Stock_Price:  101.6370679951529
curr_Factors:  [101.637068]
mat_Sqrt:  [[0.15]]
grads:  [0.08211513]
Stock Position:  0.08211513016296078
Bond Position:  [2.67711597]


portfolio before change:  [11.03902042]
curr_Stock_Price:  101.81516536944466
curr_Factors:  [101.81516537]
mat_Sqrt:  [[0.15]]
grads:  [0.10751915]
Stock Position:  0.10751915247841899
Bond Position:  [0.09194013]


portfolio before change:  [11.20020621]
curr_Stock_Price:  103.31387331492694
curr_Factors:  [103.31387331]
mat_Sqrt:  [[0.15]]
grads:  [0.14405447]
Stock Position:  0.14405446712582676
Bond Position:  [-3.68261876]


portfolio before change:  [11.73215352]
curr_Stock_Price:  107.01934041268436
curr_Factors:  [107.01934041]
mat_Sqrt:  [[0.15]]
grads:  [0.0208686]
Stock Position:  0.020868599112643483
Bond Position:  [9.49880981]


portfolio before change:  [11.71644571]
curr_Stock_Price:  106.03899631870303
curr_Factors:  [106.03899632]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.71644571]
Stock Price:  105.52228879754286
PL:  [6.19415691]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.00240275]
 [ 0.00702746]
 [-0.00342256]
 [-0.0080712 ]
 [ 0.00825216]
 [ 0.01643547]
 [ 0.02419158]
 [ 0.00320132]
 [-0.00263859]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.54703826]
curr_Stock_Price:  102.09522497116505
curr_Factors:  [102.09522497]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601834]
Stock Position:  -0.016018337128041692
Bond Position:  [35.18243399]


portfolio before change:  [33.57509265]
curr_Stock_Price:  101.44229932697759
curr_Factors:  [101.44229933]
mat_Sqrt:  [[0.15]]
grads:  [0.04684976]
Stock Position:  0.04684975702273431
Bond Position:  [28.82254558]


portfolio before change:  [33.71426901]
curr_Stock_Price:  104.10531163101145
curr_Factors:  [104.10531163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281707]
Stock Position:  -0.022817070435546084
Bond Position:  [36.08964724]


portfolio before change:  [33.78577878]
curr_Stock_Price:  101.76230983394431
curr_Factors:  [101.76230983]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380803]
Stock Position:  -0.053808031268680695
Bond Position:  [39.26140833]


portfolio before change:  [33.75106526]
curr_Stock_Price:  102.77236594737008
curr_Factors:  [102.77236595]
mat_Sqrt:  [[0.15]]
grads:  [0.05501439]
Stock Position:  0.05501438807127425
Bond Position:  [28.09710644]


portfolio before change:  [33.7971917]
curr_Stock_Price:  103.355383791276
curr_Factors:  [103.35538379]
mat_Sqrt:  [[0.15]]
grads:  [0.1095698]
Stock Position:  0.10956980378692929
Bond Position:  [22.47256258]


portfolio before change:  [33.60806326]
curr_Stock_Price:  101.52670903123082
curr_Factors:  [101.52670903]
mat_Sqrt:  [[0.15]]
grads:  [0.16127721]
Stock Position:  0.16127721481737312
Bond Position:  [17.23411839]


portfolio before change:  [33.48181645]
curr_Stock_Price:  100.6904717243279
curr_Factors:  [100.69047172]
mat_Sqrt:  [[0.15]]
grads:  [0.02134214]
Stock Position:  0.021342141330987156
Bond Position:  [31.33286617]


portfolio before change:  [33.53009848]
curr_Stock_Price:  102.21851333041522
curr_Factors:  [102.21851333]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.53009848]
Stock Price:  100.4619100898085
PL:  [33.06818839]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.00293274]
 [ 0.00594139]
 [-0.00740421]
 [-0.01379254]
 [-0.00240807]
 [ 0.01642132]
 [ 0.01063426]
 [ 0.00256302]
 [ 0.0382203 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [46.95786027]
curr_Stock_Price:  102.96865008223948
curr_Factors:  [102.96865008]
mat_Sqrt:  [[0.15]]
grads:  [-0.01955157]
Stock Position:  -0.019551570281609636
Bond Position:  [48.97105906]


portfolio before change:  [46.90468908]
curr_Stock_Price:  106.94085451304105
curr_Factors:  [106.94085451]
mat_Sqrt:  [[0.15]]
grads:  [0.03960927]
Stock Position:  0.0396092654955878
Bond Position:  [42.66884038]


portfolio before change:  [46.93473302]
curr_Stock_Price:  107.16060578343047
curr_Factors:  [107.16060578]
mat_Sqrt:  [[0.15]]
grads:  [-0.04936137]
Stock Position:  -0.04936137214570911
Bond Position:  [52.22432757]


portfolio before change:  [46.98303786]
curr_Stock_Price:  106.71114208436107
curr_Factors:  [106.71114208]
mat_Sqrt:  [[0.15]]
grads:  [-0.09195025]
Stock Position:  -0.0919502499371881
Bond Position:  [56.79515405]


portfolio before change:  [46.96246399]
curr_Stock_Price:  107.24380563468856
curr_Factors:  [107.24380563]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605383]
Stock Position:  -0.016053830802822983
Bond Position:  [48.6841379]


portfolio before change:  [47.00800031]
curr_Stock_Price:  105.92398569117039
curr_Factors:  [105.92398569]
mat_Sqrt:  [[0.15]]
grads:  [0.10947547]
Stock Position:  0.10947547384508217
Bond Position:  [35.41192179]


portfolio before change:  [47.1234228]
curr_Stock_Price:  106.81653356379863
curr_Factors:  [106.81653356]
mat_Sqrt:  [[0.15]]
grads:  [0.07089508]
Stock Position:  0.07089507942140627
Bond Position:  [39.55065617]


portfolio before change:  [47.12661321]
curr_Stock_Price:  106.5825276430883
curr_Factors:  [106.58252764]
mat_Sqrt:  [[0.15]]
grads:  [0.01708681]
Stock Position:  0.01708681224147278
Bond Position:  [45.30545757]


portfolio before change:  [47.22334717]
curr_Stock_Price:  110.91777578430478
curr_Factors:  [110.91777578]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [47.22334717]
Stock Price:  107.20380955069041
PL:  [40.01953762]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.07167870e-02]
 [ 3.65933521e-03]
 [ 1.22437766e-03]
 [-4.85885082e-03]
 [ 8.83998414e-03]
 [ 1.63744951e-02]
 [ 1.37441134e-02]
 [ 3.52544334e-03]
 [-7.04381523e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.7899186]
curr_Stock_Price:  99.85891459905113
curr_Factors:  [99.8589146]
mat_Sqrt:  [[0.15]]
grads:  [0.13811191]
Stock Position:  0.13811191303294934
Bond Position:  [-14.58162433]


portfolio before change:  [-1.0319985]
curr_Stock_Price:  98.1589362653983
curr_Factors:  [98.15893627]
mat_Sqrt:  [[0.15]]
grads:  [0.02439557]
Stock Position:  0.024395568080557914
Bond Position:  [-3.42664151]


portfolio before change:  [-1.0561137]
curr_Stock_Price:  97.24067712208213
curr_Factors:  [97.24067712]
mat_Sqrt:  [[0.15]]
grads:  [0.00816252]
Stock Position:  0.008162517731042365
Bond Position:  [-1.84984245]


portfolio before change:  [-1.06606479]
curr_Stock_Price:  96.13489829582518
curr_Factors:  [96.1348983]
mat_Sqrt:  [[0.15]]
grads:  [-0.03239234]
Stock Position:  -0.03239233877209667
Bond Position:  [2.0479694]


portfolio before change:  [-1.13151641]
curr_Stock_Price:  98.18710768442708
curr_Factors:  [98.18710768]
mat_Sqrt:  [[0.15]]
grads:  [0.05893323]
Stock Position:  0.05893322758768844
Bond Position:  [-6.91799958]


portfolio before change:  [-1.18932169]
curr_Stock_Price:  97.26495538056375
curr_Factors:  [97.26495538]
mat_Sqrt:  [[0.15]]
grads:  [0.1091633]
Stock Position:  0.10916330044449764
Bond Position:  [-11.80708524]


portfolio before change:  [-1.12685837]
curr_Stock_Price:  97.89124955806687
curr_Factors:  [97.89124956]
mat_Sqrt:  [[0.15]]
grads:  [0.09162742]
Stock Position:  0.09162742282144634
Bond Position:  [-10.09638128]


portfolio before change:  [-1.10407009]
curr_Stock_Price:  98.195063999303
curr_Factors:  [98.195064]
mat_Sqrt:  [[0.15]]
grads:  [0.02350296]
Stock Position:  0.02350295559601462
Bond Position:  [-3.41194432]


portfolio before change:  [-1.10750662]
curr_Stock_Price:  98.12145049614476
curr_Factors:  [98.1214505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.10750662]
Stock Price:  99.38249324701268
PL:  [-1.10750662]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.76882328e-02]
 [ 6.45076521e-03]
 [ 1.78254895e-03]
 [-4.78819498e-03]
 [ 8.90364268e-03]
 [ 1.64590985e-02]
 [ 1.36214037e-02]
 [ 3.56030625e-03]
 [-5.56271999e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.93954781]
curr_Stock_Price:  99.4583992116883
curr_Factors:  [99.45839921]
mat_Sqrt:  [[0.15]]
grads:  [0.18458822]
Stock Position:  0.18458821891331645
Bond Position:  [-25.29839658]


portfolio before change:  [-6.86209875]
curr_Stock_Price:  99.94652040371034
curr_Factors:  [99.9465204]
mat_Sqrt:  [[0.15]]
grads:  [0.0430051]
Stock Position:  0.04300510141534064
Bond Position:  [-11.16030899]


portfolio before change:  [-6.90015718]
curr_Stock_Price:  99.19133362447675
curr_Factors:  [99.19133362]
mat_Sqrt:  [[0.15]]
grads:  [0.01188366]
Stock Position:  0.011883659682345915
Bond Position:  [-8.07891323]


portfolio before change:  [-6.90898126]
curr_Stock_Price:  98.78879706776905
curr_Factors:  [98.78879707]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319213]
Stock Position:  -0.03192129989639255
Bond Position:  [-3.75551444]


portfolio before change:  [-6.89405536]
curr_Stock_Price:  98.26237354497123
curr_Factors:  [98.26237354]
mat_Sqrt:  [[0.15]]
grads:  [0.05935762]
Stock Position:  0.05935761788164326
Bond Position:  [-12.72667578]


portfolio before change:  [-7.00975914]
curr_Stock_Price:  96.42033777434638
curr_Factors:  [96.42033777]
mat_Sqrt:  [[0.15]]
grads:  [0.10972732]
Stock Position:  0.10972732366562084
Bond Position:  [-17.58970476]


portfolio before change:  [-6.90088888]
curr_Stock_Price:  97.49269891924932
curr_Factors:  [97.49269892]
mat_Sqrt:  [[0.15]]
grads:  [0.09080936]
Stock Position:  0.09080935821904064
Bond Position:  [-15.7541383]


portfolio before change:  [-6.80534974]
curr_Stock_Price:  98.63154821725188
curr_Factors:  [98.63154822]
mat_Sqrt:  [[0.15]]
grads:  [0.02373537]
Stock Position:  0.02373537499947368
Bond Position:  [-9.14640653]


portfolio before change:  [-6.84918575]
curr_Stock_Price:  96.97740697468416
curr_Factors:  [96.97740697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.84918575]
Stock Price:  97.21113463481376
PL:  [-6.84918575]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.28830531e-03]
 [ 6.44613283e-03]
 [-2.88457227e-04]
 [-7.50828251e-03]
 [ 1.13043671e-02]
 [ 1.62378709e-02]
 [ 1.61789768e-02]
 [ 3.32983147e-03]
 [-5.56299155e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.24401687]
curr_Stock_Price:  102.0754896793423
curr_Factors:  [102.07548968]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525537]
Stock Position:  -0.015255368728232799
Bond Position:  [34.8012161]


portfolio before change:  [33.22509924]
curr_Stock_Price:  104.45646052459482
curr_Factors:  [104.45646052]
mat_Sqrt:  [[0.15]]
grads:  [0.04297422]
Stock Position:  0.04297421886877131
Bond Position:  [28.73616445]


portfolio before change:  [33.13029124]
curr_Stock_Price:  101.91587501751515
curr_Factors:  [101.91587502]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192305]
Stock Position:  -0.0019230481801309222
Bond Position:  [33.32628038]


portfolio before change:  [33.1481813]
curr_Stock_Price:  101.28003386199066
curr_Factors:  [101.28003386]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005522]
Stock Position:  -0.05005521672365917
Bond Position:  [38.21777534]


portfolio before change:  [33.2700809]
curr_Stock_Price:  99.2265828900522
curr_Factors:  [99.22658289]
mat_Sqrt:  [[0.15]]
grads:  [0.07536245]
Stock Position:  0.0753624475819641
Bond Position:  [25.79212275]


portfolio before change:  [33.21164668]
curr_Stock_Price:  98.28004383320217
curr_Factors:  [98.28004383]
mat_Sqrt:  [[0.15]]
grads:  [0.10825247]
Stock Position:  0.10825247235019284
Bond Position:  [22.57258896]


portfolio before change:  [33.2817546]
curr_Stock_Price:  98.82339218272281
curr_Factors:  [98.82339218]
mat_Sqrt:  [[0.15]]
grads:  [0.10785985]
Stock Position:  0.1078598454912711
Bond Position:  [22.62267879]


portfolio before change:  [33.48084976]
curr_Stock_Price:  100.56436433158865
curr_Factors:  [100.56436433]
mat_Sqrt:  [[0.15]]
grads:  [0.02219888]
Stock Position:  0.022198876483518374
Bond Position:  [31.24843386]


portfolio before change:  [33.41685611]
curr_Stock_Price:  96.97761673008274
curr_Factors:  [96.97761673]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.41685611]
Stock Price:  96.17712562934364
PL:  [33.41685611]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.70468553e-03]
 [ 6.91879951e-03]
 [-4.01990428e-05]
 [-6.07120477e-03]
 [ 8.90169922e-03]
 [ 1.63829664e-02]
 [ 1.41642003e-02]
 [ 1.42098925e-03]
 [-2.23386859e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.31835849]
curr_Stock_Price:  101.4290476289488
curr_Factors:  [101.42904763]
mat_Sqrt:  [[0.15]]
grads:  [0.01136457]
Stock Position:  0.011364570224679817
Bond Position:  [22.16566095]


portfolio before change:  [23.32157646]
curr_Stock_Price:  100.73675362251268
curr_Factors:  [100.73675362]
mat_Sqrt:  [[0.15]]
grads:  [0.04612533]
Stock Position:  0.046125330046819644
Bond Position:  [18.67506046]


portfolio before change:  [23.34083516]
curr_Stock_Price:  100.95179455357083
curr_Factors:  [100.95179455]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026799]
Stock Position:  -0.0002679936183992603
Bond Position:  [23.3678896]


portfolio before change:  [23.35275833]
curr_Stock_Price:  100.07004641414845
curr_Factors:  [100.07004641]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404747]
Stock Position:  -0.04047469846976281
Bond Position:  [27.40306329]


portfolio before change:  [23.26330839]
curr_Stock_Price:  102.61867327267069
curr_Factors:  [102.61867327]
mat_Sqrt:  [[0.15]]
grads:  [0.05934466]
Stock Position:  0.05934466148725226
Bond Position:  [17.17343796]


portfolio before change:  [23.2990678]
curr_Stock_Price:  103.07651639768194
curr_Factors:  [103.0765164]
mat_Sqrt:  [[0.15]]
grads:  [0.10921978]
Stock Position:  0.10921977589903265
Bond Position:  [12.04107378]


portfolio before change:  [23.59054653]
curr_Stock_Price:  105.69011534406495
curr_Factors:  [105.69011534]
mat_Sqrt:  [[0.15]]
grads:  [0.094428]
Stock Position:  0.09442800229617333
Bond Position:  [13.61044008]


portfolio before change:  [23.45914725]
curr_Stock_Price:  104.22650073248523
curr_Factors:  [104.22650073]
mat_Sqrt:  [[0.15]]
grads:  [0.00947326]
Stock Position:  0.00947326169503053
Bond Position:  [22.47178233]


portfolio before change:  [23.46287839]
curr_Stock_Price:  103.43400089450549
curr_Factors:  [103.43400089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.46287839]
Stock Price:  103.57533148018022
PL:  [19.88754691]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.76386356e-02]
 [ 6.87307077e-03]
 [-4.14047556e-03]
 [-9.27908128e-03]
 [ 8.98130908e-03]
 [ 1.64349030e-02]
 [ 1.80185634e-02]
 [ 1.60650636e-03]
 [-5.91513796e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.61332747]
curr_Stock_Price:  99.9503057425857
curr_Factors:  [99.95030574]
mat_Sqrt:  [[0.15]]
grads:  [0.1175909]
Stock Position:  0.11759090413156903
Bond Position:  [-11.13991935]


portfolio before change:  [0.88828635]
curr_Stock_Price:  102.33595144263387
curr_Factors:  [102.33595144]
mat_Sqrt:  [[0.15]]
grads:  [0.04582047]
Stock Position:  0.04582047182054913
Bond Position:  [-3.80079523]


portfolio before change:  [0.99270036]
curr_Stock_Price:  104.6561998566311
curr_Factors:  [104.65619986]
mat_Sqrt:  [[0.15]]
grads:  [-0.02760317]
Stock Position:  -0.027603170411499928
Bond Position:  [3.88154328]


portfolio before change:  [1.04664223]
curr_Stock_Price:  102.77233589958483
curr_Factors:  [102.7723359]
mat_Sqrt:  [[0.15]]
grads:  [-0.06186054]
Stock Position:  -0.06186054185417743
Bond Position:  [7.40419462]


portfolio before change:  [1.06101618]
curr_Stock_Price:  102.59983619996358
curr_Factors:  [102.5998362]
mat_Sqrt:  [[0.15]]
grads:  [0.05987539]
Stock Position:  0.059875393842181254
Bond Position:  [-5.08218942]


portfolio before change:  [1.10988203]
curr_Stock_Price:  103.45841226814197
curr_Factors:  [103.45841227]
mat_Sqrt:  [[0.15]]
grads:  [0.10956602]
Stock Position:  0.10956602014485078
Bond Position:  [-10.22564445]


portfolio before change:  [1.21452027]
curr_Stock_Price:  104.46011280939996
curr_Factors:  [104.46011281]
mat_Sqrt:  [[0.15]]
grads:  [0.12012376]
Stock Position:  0.12012375580835176
Bond Position:  [-11.33362081]


portfolio before change:  [1.02074877]
curr_Stock_Price:  102.89420042613577
curr_Factors:  [102.89420043]
mat_Sqrt:  [[0.15]]
grads:  [0.01071004]
Stock Position:  0.010710042423149227
Bond Position:  [-0.08125248]


portfolio before change:  [1.02539066]
curr_Stock_Price:  103.33140995835727
curr_Factors:  [103.33140996]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.02539066]
Stock Price:  101.52337393766895
PL:  [-0.49798327]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.67938463e-02]
 [ 4.34018859e-03]
 [ 1.91777170e-03]
 [-4.83819222e-03]
 [ 9.27279338e-03]
 [ 1.59879453e-02]
 [ 1.74857422e-02]
 [ 3.55016298e-03]
 [-5.65757216e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.13268374]
curr_Stock_Price:  98.07812460281198
curr_Factors:  [98.0781246]
mat_Sqrt:  [[0.15]]
grads:  [-0.11195898]
Stock Position:  -0.11195897542962352
Bond Position:  [-17.1519574]


portfolio before change:  [-28.21714684]
curr_Stock_Price:  98.75591734053224
curr_Factors:  [98.75591734]
mat_Sqrt:  [[0.15]]
grads:  [0.02893459]
Stock Position:  0.02893459063247974
Bond Position:  [-31.07460888]


portfolio before change:  [-28.30538418]
curr_Stock_Price:  96.24348679844707
curr_Factors:  [96.2434868]
mat_Sqrt:  [[0.15]]
grads:  [0.01278514]
Stock Position:  0.012785144682210838
Bond Position:  [-29.53587109]


portfolio before change:  [-28.3180407]
curr_Stock_Price:  96.40892211155844
curr_Factors:  [96.40892211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03225461]
Stock Position:  -0.03225461482762561
Bond Position:  [-25.20840805]


portfolio before change:  [-28.40450828]
curr_Stock_Price:  98.69883412420292
curr_Factors:  [98.69883412]
mat_Sqrt:  [[0.15]]
grads:  [0.06181862]
Stock Position:  0.0618186225414013
Bond Position:  [-34.50593425]


portfolio before change:  [-28.3839089]
curr_Stock_Price:  99.31121686825932
curr_Factors:  [99.31121687]
mat_Sqrt:  [[0.15]]
grads:  [0.1065863]
Stock Position:  0.10658630182413811
Bond Position:  [-38.96912424]


portfolio before change:  [-28.40392931]
curr_Stock_Price:  99.30623528157048
curr_Factors:  [99.30623528]
mat_Sqrt:  [[0.15]]
grads:  [0.11657161]
Stock Position:  0.11657161463275094
Bond Position:  [-39.9802175]


portfolio before change:  [-28.51737766]
curr_Stock_Price:  98.50455431812661
curr_Factors:  [98.50455432]
mat_Sqrt:  [[0.15]]
grads:  [0.02366775]
Stock Position:  0.023667753204540665
Bond Position:  [-30.84875914]


portfolio before change:  [-28.49467124]
curr_Stock_Price:  100.11580398670586
curr_Factors:  [100.11580399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.49467124]
Stock Price:  97.94410107054263
PL:  [-28.49467124]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.91907023e-03]
 [ 6.28762913e-03]
 [-2.21065257e-03]
 [-7.55380822e-03]
 [ 1.07061072e-02]
 [ 1.59597252e-02]
 [ 1.68317503e-02]
 [ 3.50175930e-03]
 [-5.63551154e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [47.70078468]
curr_Stock_Price:  103.0170355459231
curr_Factors:  [103.01703555]
mat_Sqrt:  [[0.15]]
grads:  [-0.01946047]
Stock Position:  -0.019460468168170653
Bond Position:  [49.70554442]


portfolio before change:  [47.6824493]
curr_Stock_Price:  105.2366310833147
curr_Factors:  [105.23663108]
mat_Sqrt:  [[0.15]]
grads:  [0.04191753]
Stock Position:  0.041917527552727346
Bond Position:  [43.27118992]


portfolio before change:  [47.61768694]
curr_Stock_Price:  103.17536052320253
curr_Factors:  [103.17536052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01473768]
Stock Position:  -0.01473768378734527
Bond Position:  [49.13825278]


portfolio before change:  [47.66962011]
curr_Stock_Price:  101.31903739801179
curr_Factors:  [101.3190374]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035872]
Stock Position:  -0.050358721450826954
Bond Position:  [52.77191729]


portfolio before change:  [47.80870247]
curr_Stock_Price:  99.08129587270818
curr_Factors:  [99.08129587]
mat_Sqrt:  [[0.15]]
grads:  [0.07137405]
Stock Position:  0.07137404810238346
Bond Position:  [40.73686929]


portfolio before change:  [47.92470187]
curr_Stock_Price:  100.421080708833
curr_Factors:  [100.42108071]
mat_Sqrt:  [[0.15]]
grads:  [0.10639817]
Stock Position:  0.106398168008341
Bond Position:  [37.24008285]


portfolio before change:  [47.79992458]
curr_Stock_Price:  99.07329448308094
curr_Factors:  [99.07329448]
mat_Sqrt:  [[0.15]]
grads:  [0.11221167]
Stock Position:  0.11221166854739599
Bond Position:  [36.6827449]


portfolio before change:  [47.68644931]
curr_Stock_Price:  97.8985393911342
curr_Factors:  [97.89853939]
mat_Sqrt:  [[0.15]]
grads:  [0.02334506]
Stock Position:  0.0233450619776259
Bond Position:  [45.40100184]


portfolio before change:  [47.6889642]
curr_Stock_Price:  97.03363340634805
curr_Factors:  [97.03363341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [47.6889642]
Stock Price:  96.25877308249677
PL:  [47.6889642]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.43086322e-03]
 [ 5.05940617e-03]
 [ 6.66941782e-04]
 [-7.42615013e-03]
 [ 1.05712091e-02]
 [ 1.60991882e-02]
 [ 1.80866429e-02]
 [ 3.15304582e-03]
 [ 1.94603682e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.50928408]
curr_Stock_Price:  100.65994174414818
curr_Factors:  [100.65994174]
mat_Sqrt:  [[0.15]]
grads:  [0.03620575]
Stock Position:  0.03620575481226805
Bond Position:  [7.86481491]


portfolio before change:  [11.45971281]
curr_Stock_Price:  99.18214740883728
curr_Factors:  [99.18214741]
mat_Sqrt:  [[0.15]]
grads:  [0.03372937]
Stock Position:  0.03372937447413558
Bond Position:  [8.11436102]


portfolio before change:  [11.42532608]
curr_Stock_Price:  98.0423420182468
curr_Factors:  [98.04234202]
mat_Sqrt:  [[0.15]]
grads:  [0.00444628]
Stock Position:  0.004446278546823646
Bond Position:  [10.98940252]


portfolio before change:  [11.44490497]
curr_Stock_Price:  101.20966805255074
curr_Factors:  [101.20966805]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950767]
Stock Position:  -0.0495076675018544
Bond Position:  [16.45555956]


portfolio before change:  [11.40293551]
curr_Stock_Price:  102.22363826787219
curr_Factors:  [102.22363827]
mat_Sqrt:  [[0.15]]
grads:  [0.07047473]
Stock Position:  0.07047472726953856
Bond Position:  [4.19875248]


portfolio before change:  [11.36080703]
curr_Stock_Price:  101.59606039923676
curr_Factors:  [101.5960604]
mat_Sqrt:  [[0.15]]
grads:  [0.10732792]
Stock Position:  0.10732792162814866
Bond Position:  [0.45671302]


portfolio before change:  [11.666095]
curr_Stock_Price:  104.43837352223412
curr_Factors:  [104.43837352]
mat_Sqrt:  [[0.15]]
grads:  [0.12057762]
Stock Position:  0.12057761960201951
Bond Position:  [-0.92683547]


portfolio before change:  [11.97895116]
curr_Stock_Price:  107.03686315548124
curr_Factors:  [107.03686316]
mat_Sqrt:  [[0.15]]
grads:  [0.02102031]
Stock Position:  0.021020305480379704
Bond Position:  [9.7290036]


portfolio before change:  [11.99312724]
curr_Stock_Price:  107.47978550900835
curr_Factors:  [107.47978551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.99312724]
Stock Price:  109.52419543323276
PL:  [2.46893181]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.31441748e-02]
 [ 6.10023259e-03]
 [ 1.24866539e-03]
 [-4.74206743e-03]
 [ 9.47829419e-03]
 [ 1.63579881e-02]
 [ 1.41320925e-02]
 [ 3.65308266e-03]
 [-3.46449771e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.86472991]
curr_Stock_Price:  100.09693593609353
curr_Factors:  [100.09693594]
mat_Sqrt:  [[0.15]]
grads:  [0.08762783]
Stock Position:  0.0876278320012778
Bond Position:  [-5.90654757]


portfolio before change:  [2.83069021]
curr_Stock_Price:  99.7421892290266
curr_Factors:  [99.74218923]
mat_Sqrt:  [[0.15]]
grads:  [0.04066822]
Stock Position:  0.04066821728797593
Bond Position:  [-1.22564681]


portfolio before change:  [2.7269247]
curr_Stock_Price:  97.2057482203176
curr_Factors:  [97.20574822]
mat_Sqrt:  [[0.15]]
grads:  [0.00832444]
Stock Position:  0.008324435951510995
Bond Position:  [1.91774168]


portfolio before change:  [2.73186466]
curr_Stock_Price:  97.68395981408933
curr_Factors:  [97.68395981]
mat_Sqrt:  [[0.15]]
grads:  [-0.03161378]
Stock Position:  -0.031613782857338735
Bond Position:  [5.82002415]


portfolio before change:  [2.76591312]
curr_Stock_Price:  96.69901837219123
curr_Factors:  [96.69901837]
mat_Sqrt:  [[0.15]]
grads:  [0.06318863]
Stock Position:  0.06318862796565407
Bond Position:  [-3.34436518]


portfolio before change:  [2.81041437]
curr_Stock_Price:  97.42974873743741
curr_Factors:  [97.42974874]
mat_Sqrt:  [[0.15]]
grads:  [0.10905325]
Stock Position:  0.10905325386332362
Bond Position:  [-7.81461675]


portfolio before change:  [2.873032]
curr_Stock_Price:  98.03978019606043
curr_Factors:  [98.0397802]
mat_Sqrt:  [[0.15]]
grads:  [0.09421395]
Stock Position:  0.09421394985235025
Bond Position:  [-6.36368294]


portfolio before change:  [3.06672212]
curr_Stock_Price:  100.12941510004897
curr_Factors:  [100.1294151]
mat_Sqrt:  [[0.15]]
grads:  [0.02435388]
Stock Position:  0.02435388441197747
Bond Position:  [0.62818192]


portfolio before change:  [3.10757239]
curr_Stock_Price:  101.79387647945774
curr_Factors:  [101.79387648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.10757239]
Stock Price:  103.83303638017003
PL:  [-0.72546399]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.08890274e-03]
 [ 4.51821202e-03]
 [ 7.50006808e-04]
 [-4.87987406e-03]
 [ 1.28574886e-02]
 [ 1.65569380e-02]
 [ 1.30486449e-02]
 [ 8.10001756e-03]
 [-5.25835179e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.58311539]
curr_Stock_Price:  98.634944138386
curr_Factors:  [98.63494414]
mat_Sqrt:  [[0.15]]
grads:  [0.02725935]
Stock Position:  0.027259351622676564
Bond Position:  [-22.27184002]


portfolio before change:  [-19.58720952]
curr_Stock_Price:  98.89337208788308
curr_Factors:  [98.89337209]
mat_Sqrt:  [[0.15]]
grads:  [0.03012141]
Stock Position:  0.030121413477305466
Bond Position:  [-22.56601767]


portfolio before change:  [-19.6143336]
curr_Stock_Price:  98.36755833956221
curr_Factors:  [98.36755834]
mat_Sqrt:  [[0.15]]
grads:  [0.00500005]
Stock Position:  0.0050000453869928265
Bond Position:  [-20.10617586]


portfolio before change:  [-19.63694692]
curr_Stock_Price:  95.85603756228072
curr_Factors:  [95.85603756]
mat_Sqrt:  [[0.15]]
grads:  [-0.03253249]
Stock Position:  -0.032532493743952194
Bond Position:  [-16.51851098]


portfolio before change:  [-19.61698522]
curr_Stock_Price:  94.98850414992927
curr_Factors:  [94.98850415]
mat_Sqrt:  [[0.15]]
grads:  [0.08571659]
Stock Position:  0.08571659042342943
Bond Position:  [-27.75907592]


portfolio before change:  [-19.60822834]
curr_Stock_Price:  95.2526290673839
curr_Factors:  [95.25262907]
mat_Sqrt:  [[0.15]]
grads:  [0.11037959]
Stock Position:  0.1103795868510846
Bond Position:  [-30.12217418]


portfolio before change:  [-19.57238929]
curr_Stock_Price:  95.71380041313544
curr_Factors:  [95.71380041]
mat_Sqrt:  [[0.15]]
grads:  [0.08699097]
Stock Position:  0.0869909659860852
Bond Position:  [-27.89862524]


portfolio before change:  [-19.56490492]
curr_Stock_Price:  95.96023024209792
curr_Factors:  [95.96023024]
mat_Sqrt:  [[0.15]]
grads:  [0.05400012]
Stock Position:  0.054000117088475824
Bond Position:  [-24.74676859]


portfolio before change:  [-19.53504934]
curr_Stock_Price:  96.74230360719153
curr_Factors:  [96.74230361]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.53504934]
Stock Price:  96.44091788632633
PL:  [-19.53504934]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.25495483e-02]
 [ 6.04807864e-03]
 [-2.17380139e-04]
 [-9.18772823e-03]
 [ 2.49519120e-03]
 [ 1.64234086e-02]
 [ 1.82756424e-02]
 [ 1.43725547e-03]
 [ 1.30112797e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.91666369]
curr_Stock_Price:  99.13424771744214
curr_Factors:  [99.13424772]
mat_Sqrt:  [[0.15]]
grads:  [0.15033032]
Stock Position:  0.1503303218248057
Bond Position:  [-26.81954706]


portfolio before change:  [-11.84312541]
curr_Stock_Price:  99.71265008461816
curr_Factors:  [99.71265008]
mat_Sqrt:  [[0.15]]
grads:  [0.04032052]
Stock Position:  0.04032052428650135
Bond Position:  [-15.86359173]


portfolio before change:  [-11.77720009]
curr_Stock_Price:  101.5444490947535
curr_Factors:  [101.54444909]
mat_Sqrt:  [[0.15]]
grads:  [-0.0014492]
Stock Position:  -0.0014492009266834963
Bond Position:  [-11.63004178]


portfolio before change:  [-11.7846865]
curr_Stock_Price:  102.69676432572172
curr_Factors:  [102.69676433]
mat_Sqrt:  [[0.15]]
grads:  [-0.06125152]
Stock Position:  -0.061251521535489635
Bond Position:  [-5.49435343]


portfolio before change:  [-11.87958315]
curr_Stock_Price:  104.20119690135114
curr_Factors:  [104.2011969]
mat_Sqrt:  [[0.15]]
grads:  [0.01663461]
Stock Position:  0.016634608020084974
Bond Position:  [-13.61292921]


portfolio before change:  [-11.84345428]
curr_Stock_Price:  106.78238410656031
curr_Factors:  [106.78238411]
mat_Sqrt:  [[0.15]]
grads:  [0.10948939]
Stock Position:  0.1094893909000525
Bond Position:  [-23.53499247]


portfolio before change:  [-12.11847687]
curr_Stock_Price:  104.3780218824505
curr_Factors:  [104.37802188]
mat_Sqrt:  [[0.15]]
grads:  [0.12183762]
Stock Position:  0.12183761603048139
Bond Position:  [-24.83564622]


portfolio before change:  [-12.16359143]
curr_Stock_Price:  104.10968412097502
curr_Factors:  [104.10968412]
mat_Sqrt:  [[0.15]]
grads:  [0.0095817]
Stock Position:  0.009581703112593386
Bond Position:  [-13.16113952]


portfolio before change:  [-12.14844201]
curr_Stock_Price:  106.37771934516651
curr_Factors:  [106.37771935]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.14844201]
Stock Price:  104.97302565321857
PL:  [-17.12146766]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 3.43620305e-03]
 [ 5.37186736e-03]
 [ 1.17670776e-03]
 [-6.84223903e-03]
 [ 1.22282666e-02]
 [ 1.62360185e-02]
 [ 2.41729104e-02]
 [ 1.74853804e-03]
 [-2.88439913e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.85033599]
curr_Stock_Price:  98.61754049379418
curr_Factors:  [98.61754049]
mat_Sqrt:  [[0.15]]
grads:  [0.02290802]
Stock Position:  0.022908020302761026
Bond Position:  [-22.10946861]


portfolio before change:  [-19.84491734]
curr_Stock_Price:  99.33677085870178
curr_Factors:  [99.33677086]
mat_Sqrt:  [[0.15]]
grads:  [0.03581245]
Stock Position:  0.035812449050661714
Bond Position:  [-23.40241039]


portfolio before change:  [-19.87308734]
curr_Stock_Price:  98.87699043161274
curr_Factors:  [98.87699043]
mat_Sqrt:  [[0.15]]
grads:  [0.00784472]
Stock Position:  0.007844718392357735
Bond Position:  [-20.64874948]


portfolio before change:  [-19.86903948]
curr_Stock_Price:  100.70941011572127
curr_Factors:  [100.70941012]
mat_Sqrt:  [[0.15]]
grads:  [-0.04561493]
Stock Position:  -0.045614926891139225
Bond Position:  [-15.2751871]


portfolio before change:  [-19.92086162]
curr_Stock_Price:  101.67801066381477
curr_Factors:  [101.67801066]
mat_Sqrt:  [[0.15]]
grads:  [0.08152178]
Stock Position:  0.08152177735710209
Bond Position:  [-28.20983377]


portfolio before change:  [-19.87995435]
curr_Stock_Price:  102.35286985080889
curr_Factors:  [102.35286985]
mat_Sqrt:  [[0.15]]
grads:  [0.10824012]
Stock Position:  0.1082401231858179
Bond Position:  [-30.95864159]


portfolio before change:  [-19.901989]
curr_Stock_Price:  102.29234276464355
curr_Factors:  [102.29234276]
mat_Sqrt:  [[0.15]]
grads:  [0.16115274]
Stock Position:  0.16115273574821723
Bond Position:  [-36.38667988]


portfolio before change:  [-19.93031254]
curr_Stock_Price:  102.22951010801268
curr_Factors:  [102.22951011]
mat_Sqrt:  [[0.15]]
grads:  [0.01165692]
Stock Position:  0.011656920252260283
Bond Position:  [-21.12199379]


portfolio before change:  [-19.94271213]
curr_Stock_Price:  102.07201122803086
curr_Factors:  [102.07201123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.94271213]
Stock Price:  101.45415417330754
PL:  [-21.39686631]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.77895399e-03]
 [ 7.06103783e-03]
 [-1.65593152e-04]
 [-7.55227124e-03]
 [ 1.15854091e-02]
 [ 1.62456205e-02]
 [ 2.43742358e-02]
 [ 3.29391655e-03]
 [-2.90657279e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.80431754]
curr_Stock_Price:  100.9396703155004
curr_Factors:  [100.93967032]
mat_Sqrt:  [[0.15]]
grads:  [0.03185969]
Stock Position:  0.03185969329932083
Bond Position:  [12.5884106]


portfolio before change:  [15.82162545]
curr_Stock_Price:  101.28531486866083
curr_Factors:  [101.28531487]
mat_Sqrt:  [[0.15]]
grads:  [0.04707359]
Stock Position:  0.047073585513076194
Bond Position:  [11.05376252]


portfolio before change:  [15.83119788]
curr_Stock_Price:  101.3712263669169
curr_Factors:  [101.37122637]
mat_Sqrt:  [[0.15]]
grads:  [-0.00110395]
Stock Position:  -0.0011039543490174828
Bond Position:  [15.94310708]


portfolio before change:  [15.83923049]
curr_Stock_Price:  101.31772061575177
curr_Factors:  [101.31772062]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034847]
Stock Position:  -0.050348474953167126
Bond Position:  [20.94042321]


portfolio before change:  [15.81674063]
curr_Stock_Price:  101.97241154187417
curr_Factors:  [101.97241154]
mat_Sqrt:  [[0.15]]
grads:  [0.07723606]
Stock Position:  0.07723606089898472
Bond Position:  [7.94079324]


portfolio before change:  [15.85374926]
curr_Stock_Price:  102.40015531536285
curr_Factors:  [102.40015532]
mat_Sqrt:  [[0.15]]
grads:  [0.10830414]
Stock Position:  0.10830413694204472
Bond Position:  [4.76338882]


portfolio before change:  [15.83313211]
curr_Stock_Price:  102.18779549902408
curr_Factors:  [102.1877955]
mat_Sqrt:  [[0.15]]
grads:  [0.16249491]
Stock Position:  0.16249490539520592
Bond Position:  [-0.77186405]


portfolio before change:  [15.57467366]
curr_Stock_Price:  100.59960771763974
curr_Factors:  [100.59960772]
mat_Sqrt:  [[0.15]]
grads:  [0.02195944]
Stock Position:  0.02195944367098993
Bond Position:  [13.36556224]


portfolio before change:  [15.62461476]
curr_Stock_Price:  102.569450398251
curr_Factors:  [102.5694504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.62461476]
Stock Price:  99.91033119700415
PL:  [15.62461476]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.00703873e-03]
 [ 6.64153784e-03]
 [-5.02752138e-03]
 [-1.24486444e-02]
 [ 1.51362306e-03]
 [ 1.64293051e-02]
 [ 2.34085362e-02]
 [ 1.58180792e-03]
 [-3.05163344e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.49929589]
curr_Stock_Price:  102.02698720805374
curr_Factors:  [102.02698721]
mat_Sqrt:  [[0.15]]
grads:  [-0.01338026]
Stock Position:  -0.013380258228821162
Bond Position:  [33.86444332]


portfolio before change:  [32.49659453]
curr_Stock_Price:  103.49465814421016
curr_Factors:  [103.49465814]
mat_Sqrt:  [[0.15]]
grads:  [0.04427692]
Stock Position:  0.04427691891524635
Bond Position:  [27.91416994]


portfolio before change:  [32.59212255]
curr_Stock_Price:  105.33686971156938
curr_Factors:  [105.33686971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351681]
Stock Position:  -0.03351680919491756
Bond Position:  [36.12267832]


portfolio before change:  [32.60826189]
curr_Stock_Price:  105.39434886022485
curr_Factors:  [105.39434886]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299096]
Stock Position:  -0.08299096282152452
Bond Position:  [41.35504038]


portfolio before change:  [32.70471331]
curr_Stock_Price:  104.48137324375318
curr_Factors:  [104.48137324]
mat_Sqrt:  [[0.15]]
grads:  [0.01009082]
Stock Position:  0.01009082040168089
Bond Position:  [31.65041053]


portfolio before change:  [32.72047426]
curr_Stock_Price:  104.47461402957754
curr_Factors:  [104.47461403]
mat_Sqrt:  [[0.15]]
grads:  [0.1095287]
Stock Position:  0.10952870091174383
Bond Position:  [21.27750551]


portfolio before change:  [32.37544871]
curr_Stock_Price:  101.22736499043519
curr_Factors:  [101.22736499]
mat_Sqrt:  [[0.15]]
grads:  [0.15605691]
Stock Position:  0.1560569079070263
Bond Position:  [16.57821913]


portfolio before change:  [32.67154137]
curr_Stock_Price:  103.07157349802776
curr_Factors:  [103.0715735]
mat_Sqrt:  [[0.15]]
grads:  [0.01054539]
Stock Position:  0.010545386154620492
Bond Position:  [31.58461182]


portfolio before change:  [32.68290979]
curr_Stock_Price:  102.65169059747174
curr_Factors:  [102.6516906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.68290979]
Stock Price:  104.05924374096526
PL:  [28.62366605]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 3.10363650e-03]
 [ 6.33935232e-03]
 [ 1.76889047e-03]
 [-7.40376714e-03]
 [ 7.26399476e-03]
 [ 1.64256575e-02]
 [ 1.54040446e-02]
 [ 1.33976333e-03]
 [ 6.10226568e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.89908169]
curr_Stock_Price:  101.20635567043684
curr_Factors:  [101.20635567]
mat_Sqrt:  [[0.15]]
grads:  [0.02069091]
Stock Position:  0.02069090998749898
Bond Position:  [17.80503009]


portfolio before change:  [19.88051041]
curr_Stock_Price:  99.87842862225727
curr_Factors:  [99.87842862]
mat_Sqrt:  [[0.15]]
grads:  [0.04226235]
Stock Position:  0.04226234877682929
Bond Position:  [15.65941342]


portfolio before change:  [19.89133353]
curr_Stock_Price:  99.94921154378898
curr_Factors:  [99.94921154]
mat_Sqrt:  [[0.15]]
grads:  [0.0117926]
Stock Position:  0.011792603131062337
Bond Position:  [18.71267214]


portfolio before change:  [19.91533013]
curr_Stock_Price:  101.19049173279693
curr_Factors:  [101.19049173]
mat_Sqrt:  [[0.15]]
grads:  [-0.04935845]
Stock Position:  -0.04935844760313009
Bond Position:  [24.90993571]


portfolio before change:  [19.83816853]
curr_Stock_Price:  103.0061825673965
curr_Factors:  [103.00618257]
mat_Sqrt:  [[0.15]]
grads:  [0.04842663]
Stock Position:  0.048426631719876094
Bond Position:  [14.84992606]


portfolio before change:  [19.9487729]
curr_Stock_Price:  105.13677781942859
curr_Factors:  [105.13677782]
mat_Sqrt:  [[0.15]]
grads:  [0.10950438]
Stock Position:  0.10950438345258734
Bond Position:  [8.43583487]


portfolio before change:  [19.97026049]
curr_Stock_Price:  105.29447581620897
curr_Factors:  [105.29447582]
mat_Sqrt:  [[0.15]]
grads:  [0.10269363]
Stock Position:  0.10269363075648456
Bond Position:  [9.15718847]


portfolio before change:  [19.92507006]
curr_Stock_Price:  104.80982870873265
curr_Factors:  [104.80982871]
mat_Sqrt:  [[0.15]]
grads:  [0.00893176]
Stock Position:  0.00893175555279145
Bond Position:  [18.98893429]


portfolio before change:  [19.93573248]
curr_Stock_Price:  104.94032685354125
curr_Factors:  [104.94032685]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.93573248]
Stock Price:  105.02846349166286
PL:  [14.90726899]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.80482874e-02]
 [ 6.81340894e-03]
 [-9.07463266e-05]
 [-9.11866599e-03]
 [ 4.91312983e-03]
 [ 1.63398642e-02]
 [ 2.02618032e-02]
 [ 3.64634090e-03]
 [-7.11143844e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.45092365]
curr_Stock_Price:  99.93972864452346
curr_Factors:  [99.93972864]
mat_Sqrt:  [[0.15]]
grads:  [0.12032192]
Stock Position:  0.12032191632979176
Bond Position:  [-11.57401602]


portfolio before change:  [0.50055017]
curr_Stock_Price:  100.40028465923385
curr_Factors:  [100.40028466]
mat_Sqrt:  [[0.15]]
grads:  [0.04542273]
Stock Position:  0.04542272628603231
Bond Position:  [-4.05990448]


portfolio before change:  [0.53125069]
curr_Stock_Price:  101.12087058901503
curr_Factors:  [101.12087059]
mat_Sqrt:  [[0.15]]
grads:  [-0.00060498]
Stock Position:  -0.000604975510622396
Bond Position:  [0.59242634]


portfolio before change:  [0.53062816]
curr_Stock_Price:  102.63963276845922
curr_Factors:  [102.63963277]
mat_Sqrt:  [[0.15]]
grads:  [-0.06079111]
Stock Position:  -0.0607911066277075
Bond Position:  [6.77020502]


portfolio before change:  [0.47787992]
curr_Stock_Price:  103.56302756667158
curr_Factors:  [103.56302757]
mat_Sqrt:  [[0.15]]
grads:  [0.0327542]
Stock Position:  0.03275419885009151
Bond Position:  [-2.91424408]


portfolio before change:  [0.45353483]
curr_Stock_Price:  102.86425907471451
curr_Factors:  [102.86425907]
mat_Sqrt:  [[0.15]]
grads:  [0.10893243]
Stock Position:  0.1089324277962285
Bond Position:  [-10.75171864]


portfolio before change:  [0.15463201]
curr_Stock_Price:  100.1696930373072
curr_Factors:  [100.16969304]
mat_Sqrt:  [[0.15]]
grads:  [0.13507869]
Stock Position:  0.13507868825383
Bond Position:  [-13.37615873]


portfolio before change:  [0.1443262]
curr_Stock_Price:  100.14292306460561
curr_Factors:  [100.14292306]
mat_Sqrt:  [[0.15]]
grads:  [0.02430894]
Stock Position:  0.024308939358028917
Bond Position:  [-2.29004204]


portfolio before change:  [0.0953108]
curr_Stock_Price:  98.17368473994992
curr_Factors:  [98.17368474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.0953108]
Stock Price:  98.65013063418468
PL:  [0.0953108]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.43840230e-04]
 [ 7.07268818e-03]
 [ 8.57988851e-04]
 [-7.36790211e-03]
 [ 1.22808639e-02]
 [ 1.64171216e-02]
 [ 1.72650512e-02]
 [ 1.56090995e-03]
 [-4.88896961e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.91124689]
curr_Stock_Price:  101.5979182500766
curr_Factors:  [101.59791825]
mat_Sqrt:  [[0.15]]
grads:  [0.00429227]
Stock Position:  0.004292268202099788
Bond Position:  [25.47516138]


portfolio before change:  [25.92241206]
curr_Stock_Price:  101.2308408650692
curr_Factors:  [101.23084087]
mat_Sqrt:  [[0.15]]
grads:  [0.04715125]
Stock Position:  0.04715125456463411
Bond Position:  [21.14925091]


portfolio before change:  [25.89253581]
curr_Stock_Price:  100.37288857841152
curr_Factors:  [100.37288858]
mat_Sqrt:  [[0.15]]
grads:  [0.00571993]
Stock Position:  0.005719925670615922
Bond Position:  [25.31841034]


portfolio before change:  [25.90969905]
curr_Stock_Price:  101.15976484980548
curr_Factors:  [101.15976485]
mat_Sqrt:  [[0.15]]
grads:  [-0.04911935]
Stock Position:  -0.04911934737811506
Bond Position:  [30.87860068]


portfolio before change:  [25.90087478]
curr_Stock_Price:  101.65381510812946
curr_Factors:  [101.65381511]
mat_Sqrt:  [[0.15]]
grads:  [0.08187243]
Stock Position:  0.08187242623575153
Bond Position:  [17.5782303]


portfolio before change:  [26.03972856]
curr_Stock_Price:  103.24241424269368
curr_Factors:  [103.24241424]
mat_Sqrt:  [[0.15]]
grads:  [0.10944748]
Stock Position:  0.10944747765352536
Bond Position:  [14.74010674]


portfolio before change:  [26.20669749]
curr_Stock_Price:  104.70062078572535
curr_Factors:  [104.70062079]
mat_Sqrt:  [[0.15]]
grads:  [0.11510034]
Stock Position:  0.11510034114729117
Bond Position:  [14.15562032]


portfolio before change:  [26.04354741]
curr_Stock_Price:  103.22165333336265
curr_Factors:  [103.22165333]
mat_Sqrt:  [[0.15]]
grads:  [0.01040607]
Stock Position:  0.01040606632774901
Bond Position:  [24.96941604]


portfolio before change:  [26.05747496]
curr_Stock_Price:  103.36000758611087
curr_Factors:  [103.36000759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.05747496]
Stock Price:  103.74776996215245
PL:  [22.309705]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.29129534e-03]
 [ 3.81164987e-03]
 [ 3.66080079e-04]
 [-5.26366782e-03]
 [ 1.15121043e-02]
 [ 1.59638094e-02]
 [ 1.76438825e-02]
 [ 2.11436796e-03]
 [-4.37183182e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.74099933]
curr_Stock_Price:  100.28426270359105
curr_Factors:  [100.2842627]
mat_Sqrt:  [[0.15]]
grads:  [0.06194197]
Stock Position:  0.06194196892286228
Bond Position:  [-0.47080535]


portfolio before change:  [5.61866467]
curr_Stock_Price:  98.31307572490911
curr_Factors:  [98.31307572]
mat_Sqrt:  [[0.15]]
grads:  [0.025411]
Stock Position:  0.025410999141388824
Bond Position:  [3.12043118]


portfolio before change:  [5.67583601]
curr_Stock_Price:  100.50152735819195
curr_Factors:  [100.50152736]
mat_Sqrt:  [[0.15]]
grads:  [0.00244053]
Stock Position:  0.0024405338606371682
Bond Position:  [5.43055863]


portfolio before change:  [5.67604456]
curr_Stock_Price:  99.47412498313531
curr_Factors:  [99.47412498]
mat_Sqrt:  [[0.15]]
grads:  [-0.03509112]
Stock Position:  -0.035091118808643906
Bond Position:  [9.1667029]


portfolio before change:  [5.68754528]
curr_Stock_Price:  99.27703171340684
curr_Factors:  [99.27703171]
mat_Sqrt:  [[0.15]]
grads:  [0.07674736]
Stock Position:  0.07674736183302014
Bond Position:  [-1.93170499]


portfolio before change:  [5.69891714]
curr_Stock_Price:  99.43779223488609
curr_Factors:  [99.43779223]
mat_Sqrt:  [[0.15]]
grads:  [0.1064254]
Stock Position:  0.10642539593395328
Bond Position:  [-4.88378927]


portfolio before change:  [5.68692966]
curr_Stock_Price:  99.34810524326438
curr_Factors:  [99.34810524]
mat_Sqrt:  [[0.15]]
grads:  [0.11762588]
Stock Position:  0.11762588354101966
Bond Position:  [-5.998979]


portfolio before change:  [5.96728969]
curr_Stock_Price:  101.75710115400263
curr_Factors:  [101.75710115]
mat_Sqrt:  [[0.15]]
grads:  [0.01409579]
Stock Position:  0.014095786400661725
Bond Position:  [4.53294333]


portfolio before change:  [5.96353697]
curr_Stock_Price:  101.33004040712032
curr_Factors:  [101.33004041]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.96353697]
Stock Price:  102.92266773347804
PL:  [3.04086924]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.13812145e-03]
 [ 7.02719577e-03]
 [ 1.76659855e-03]
 [-1.02309132e-02]
 [ 1.25731336e-02]
 [ 1.59460115e-02]
 [ 1.43331767e-02]
 [ 3.49127513e-03]
 [-5.94868406e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.4345744]
curr_Stock_Price:  100.52481926379309
curr_Factors:  [100.52481926]
mat_Sqrt:  [[0.15]]
grads:  [0.04092081]
Stock Position:  0.040920809672799464
Bond Position:  [5.3210174]


portfolio before change:  [9.47483083]
curr_Stock_Price:  101.44355140431772
curr_Factors:  [101.4435514]
mat_Sqrt:  [[0.15]]
grads:  [0.04684797]
Stock Position:  0.04684797181046657
Bond Position:  [4.7224062]


portfolio before change:  [9.40723372]
curr_Stock_Price:  99.95023363486018
curr_Factors:  [99.95023363]
mat_Sqrt:  [[0.15]]
grads:  [0.01177732]
Stock Position:  0.011777323652839648
Bond Position:  [8.23008747]


portfolio before change:  [9.45386007]
curr_Stock_Price:  103.55973640032212
curr_Factors:  [103.5597364]
mat_Sqrt:  [[0.15]]
grads:  [-0.06820609]
Stock Position:  -0.06820608792898308
Bond Position:  [16.51726456]


portfolio before change:  [9.62347071]
curr_Stock_Price:  101.1941126867472
curr_Factors:  [101.19411269]
mat_Sqrt:  [[0.15]]
grads:  [0.08382089]
Stock Position:  0.08382089052217513
Bond Position:  [1.14129007]


portfolio before change:  [9.48627082]
curr_Stock_Price:  99.55048095014865
curr_Factors:  [99.55048095]
mat_Sqrt:  [[0.15]]
grads:  [0.10630674]
Stock Position:  0.10630674356626192
Bond Position:  [-1.09661663]


portfolio before change:  [9.33330834]
curr_Stock_Price:  98.11676160447212
curr_Factors:  [98.1167616]
mat_Sqrt:  [[0.15]]
grads:  [0.09555451]
Stock Position:  0.09555451161404181
Bond Position:  [-0.0421909]


portfolio before change:  [9.29989246]
curr_Stock_Price:  97.76727748523737
curr_Factors:  [97.76727749]
mat_Sqrt:  [[0.15]]
grads:  [0.02327517]
Stock Position:  0.023275167551640004
Bond Position:  [7.02434269]


portfolio before change:  [9.29196017]
curr_Stock_Price:  97.27553748913523
curr_Factors:  [97.27553749]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.29196017]
Stock Price:  98.91127937572107
PL:  [9.29196017]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.27460528e-03]
 [ 7.04525508e-03]
 [-3.07370786e-05]
 [-6.69381939e-03]
 [ 1.21934343e-02]
 [ 1.59840036e-02]
 [ 1.36093956e-02]
 [ 3.61347727e-03]
 [-4.97481245e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.3695486]
curr_Stock_Price:  101.49750993810811
curr_Factors:  [101.49750994]
mat_Sqrt:  [[0.15]]
grads:  [0.00849737]
Stock Position:  0.008497368550972075
Bond Position:  [23.50708685]


portfolio before change:  [24.38012906]
curr_Stock_Price:  101.35911082337238
curr_Factors:  [101.35911082]
mat_Sqrt:  [[0.15]]
grads:  [0.04696837]
Stock Position:  0.04696836721749758
Bond Position:  [19.61945712]


portfolio before change:  [24.36932374]
curr_Stock_Price:  100.92014514994266
curr_Factors:  [100.92014515]
mat_Sqrt:  [[0.15]]
grads:  [-0.00020491]
Stock Position:  -0.00020491385730627142
Bond Position:  [24.39000367]


portfolio before change:  [24.38159548]
curr_Stock_Price:  100.56053175311182
curr_Factors:  [100.56053175]
mat_Sqrt:  [[0.15]]
grads:  [-0.04462546]
Stock Position:  -0.04462546258444601
Bond Position:  [28.86915572]


portfolio before change:  [24.44592669]
curr_Stock_Price:  99.44249224756004
curr_Factors:  [99.44249225]
mat_Sqrt:  [[0.15]]
grads:  [0.08128956]
Stock Position:  0.08128956195779209
Bond Position:  [16.36229006]


portfolio before change:  [24.44511892]
curr_Stock_Price:  99.33188807624813
curr_Factors:  [99.33188808]
mat_Sqrt:  [[0.15]]
grads:  [0.10656002]
Stock Position:  0.10656002404820684
Bond Position:  [13.86031054]


portfolio before change:  [24.22085965]
curr_Stock_Price:  97.16230185817683
curr_Factors:  [97.16230186]
mat_Sqrt:  [[0.15]]
grads:  [0.0907293]
Stock Position:  0.0907293041784215
Bond Position:  [15.40539161]


portfolio before change:  [24.40634223]
curr_Stock_Price:  99.12173450546027
curr_Factors:  [99.12173451]
mat_Sqrt:  [[0.15]]
grads:  [0.02408985]
Stock Position:  0.02408984848521436
Bond Position:  [22.01851467]


portfolio before change:  [24.45207698]
curr_Stock_Price:  100.56311900730097
curr_Factors:  [100.56311901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.45207698]
Stock Price:  97.56510134341437
PL:  [24.45207698]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.96924775e-04]
 [ 6.74316137e-03]
 [-2.67404141e-03]
 [-1.31739535e-02]
 [-2.06660366e-03]
 [ 1.64464103e-02]
 [ 3.92708140e-03]
 [ 6.70283374e-03]
 [ 3.21578099e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.21063839]
curr_Stock_Price:  101.74767389327448
curr_Factors:  [101.74767389]
mat_Sqrt:  [[0.15]]
grads:  [-0.0019795]
Stock Position:  -0.001979498498391024
Bond Position:  [28.41204776]


portfolio before change:  [28.22237996]
curr_Stock_Price:  102.99445726209
curr_Factors:  [102.99445726]
mat_Sqrt:  [[0.15]]
grads:  [0.04495441]
Stock Position:  0.04495440914159012
Bond Position:  [23.59232499]


portfolio before change:  [28.25829631]
curr_Stock_Price:  103.53093946769748
curr_Factors:  [103.53093947]
mat_Sqrt:  [[0.15]]
grads:  [-0.01782694]
Stock Position:  -0.017826942730541414
Bond Position:  [30.10393644]


portfolio before change:  [28.22755301]
curr_Stock_Price:  106.10003022763446
curr_Factors:  [106.10003023]
mat_Sqrt:  [[0.15]]
grads:  [-0.08782636]
Stock Position:  -0.0878263566077117
Bond Position:  [37.5459321]


portfolio before change:  [28.16742614]
curr_Stock_Price:  106.99844538005637
curr_Factors:  [106.99844538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01377736]
Stock Position:  -0.01377735776364735
Bond Position:  [29.641582]


portfolio before change:  [28.13274685]
curr_Stock_Price:  110.59157152001426
curr_Factors:  [110.59157152]
mat_Sqrt:  [[0.15]]
grads:  [0.10964274]
Stock Position:  0.10964273541258743
Bond Position:  [16.00718444]


portfolio before change:  [28.04823621]
curr_Stock_Price:  109.74777432037827
curr_Factors:  [109.74777432]
mat_Sqrt:  [[0.15]]
grads:  [0.02618054]
Stock Position:  0.026180542682063112
Bond Position:  [25.17497992]


portfolio before change:  [28.06141665]
curr_Stock_Price:  109.77030239419315
curr_Factors:  [109.77030239]
mat_Sqrt:  [[0.15]]
grads:  [0.04468556]
Stock Position:  0.044685558297194575
Bond Position:  [23.1562694]


portfolio before change:  [28.07380651]
curr_Stock_Price:  109.78840279146324
curr_Factors:  [109.78840279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.07380651]
Stock Price:  111.27682610274114
PL:  [16.7969804]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [-0.00264751]
 [ 0.00656828]
 [-0.00295087]
 [-0.01069217]
 [ 0.00875035]
 [ 0.01601671]
 [ 0.014828  ]
 [ 0.00416296]
 [-0.0049    ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [62.4645456]
curr_Stock_Price:  103.97857537629966
curr_Factors:  [103.97857538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01765004]
Stock Position:  -0.017650041977443007
Bond Position:  [64.29977182]


portfolio before change:  [62.49888079]
curr_Stock_Price:  103.8552181638954
curr_Factors:  [103.85521816]
mat_Sqrt:  [[0.15]]
grads:  [0.04378856]
Stock Position:  0.04378856334035875
Bond Position:  [57.95120999]


portfolio before change:  [62.5229658]
curr_Stock_Price:  103.74336622165997
curr_Factors:  [103.74336622]
mat_Sqrt:  [[0.15]]
grads:  [-0.0196725]
Stock Position:  -0.019672499841311364
Bond Position:  [64.56385716]


portfolio before change:  [62.55136174]
curr_Stock_Price:  103.94131057664224
curr_Factors:  [103.94131058]
mat_Sqrt:  [[0.15]]
grads:  [-0.07128114]
Stock Position:  -0.07128113869987808
Bond Position:  [69.96041672]


portfolio before change:  [62.67807712]
curr_Stock_Price:  102.6544844927292
curr_Factors:  [102.65448449]
mat_Sqrt:  [[0.15]]
grads:  [0.05833568]
Stock Position:  0.05833568448482555
Bond Position:  [56.68965751]


portfolio before change:  [62.50318183]
curr_Stock_Price:  99.17038695980173
curr_Factors:  [99.17038696]
mat_Sqrt:  [[0.15]]
grads:  [0.10677805]
Stock Position:  0.10677804613524802
Bond Position:  [51.91396167]


portfolio before change:  [62.43686878]
curr_Stock_Price:  98.30619694897838
curr_Factors:  [98.30619695]
mat_Sqrt:  [[0.15]]
grads:  [0.09885336]
Stock Position:  0.09885335719764007
Bond Position:  [52.71897117]


portfolio before change:  [62.3428448]
curr_Stock_Price:  97.08833183331448
curr_Factors:  [97.08833183]
mat_Sqrt:  [[0.15]]
grads:  [0.02775309]
Stock Position:  0.027753092678529635
Bond Position:  [59.64834333]


portfolio before change:  [62.34475559]
curr_Stock_Price:  96.08228788985987
curr_Factors:  [96.08228789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [62.34475559]
Stock Price:  96.45915724327028
PL:  [62.34475559]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.43512811e-03]
 [ 6.71452656e-03]
 [ 7.83590632e-04]
 [-4.82165232e-03]
 [ 1.11666565e-02]
 [ 1.65726322e-02]
 [ 1.04097395e-02]
 [ 1.99566754e-02]
 [-3.30662038e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.49677321]
curr_Stock_Price:  100.65912693167203
curr_Factors:  [100.65912693]
mat_Sqrt:  [[0.15]]
grads:  [0.03623419]
Stock Position:  0.03623418742774387
Bond Position:  [7.84947154]


portfolio before change:  [11.48071923]
curr_Stock_Price:  100.10772238987117
curr_Factors:  [100.10772239]
mat_Sqrt:  [[0.15]]
grads:  [0.04476351]
Stock Position:  0.04476351040390194
Bond Position:  [6.99954616]


portfolio before change:  [11.4081832]
curr_Stock_Price:  98.40909162301122
curr_Factors:  [98.40909162]
mat_Sqrt:  [[0.15]]
grads:  [0.00522394]
Stock Position:  0.005223937543815211
Bond Position:  [10.89410026]


portfolio before change:  [11.40432895]
curr_Stock_Price:  96.62831402236553
curr_Factors:  [96.62831402]
mat_Sqrt:  [[0.15]]
grads:  [-0.03214435]
Stock Position:  -0.03214434879377545
Bond Position:  [14.51038318]


portfolio before change:  [11.4367848]
curr_Stock_Price:  95.84438636050872
curr_Factors:  [95.84438636]
mat_Sqrt:  [[0.15]]
grads:  [0.07444438]
Stock Position:  0.07444437645568208
Bond Position:  [4.30170922]


portfolio before change:  [11.37272192]
curr_Stock_Price:  94.95494020293147
curr_Factors:  [94.9549402]
mat_Sqrt:  [[0.15]]
grads:  [0.11048421]
Stock Position:  0.11048421468768505
Bond Position:  [0.88169992]


portfolio before change:  [11.22362601]
curr_Stock_Price:  93.60147197780756
curr_Factors:  [93.60147198]
mat_Sqrt:  [[0.15]]
grads:  [0.06939826]
Stock Position:  0.0693982636489618
Bond Position:  [4.72784638]


portfolio before change:  [11.15628984]
curr_Stock_Price:  92.59711422631521
curr_Factors:  [92.59711423]
mat_Sqrt:  [[0.15]]
grads:  [0.1330445]
Stock Position:  0.1330445024395602
Bond Position:  [-1.16324715]


portfolio before change:  [11.21815733]
curr_Stock_Price:  93.0665004339845
curr_Factors:  [93.06650043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.21815733]
Stock Price:  92.28313499466654
PL:  [11.21815733]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.94085481e-02]
 [ 7.02683842e-03]
 [-9.74082690e-04]
 [-8.77058226e-03]
 [ 1.37132308e-02]
 [ 1.59367485e-02]
 [ 2.18214494e-02]
 [ 3.66486294e-03]
 [-5.19168809e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.08834293]
curr_Stock_Price:  99.90460708603075
curr_Factors:  [99.90460709]
mat_Sqrt:  [[0.15]]
grads:  [0.12939032]
Stock Position:  0.12939032092428565
Bond Position:  [-13.0150321]


portfolio before change:  [0.10448862]
curr_Stock_Price:  101.44522226532384
curr_Factors:  [101.44522227]
mat_Sqrt:  [[0.15]]
grads:  [0.04684559]
Stock Position:  0.04684558949631535
Bond Position:  [-4.64777262]


portfolio before change:  [0.14472016]
curr_Stock_Price:  102.35365378053979
curr_Factors:  [102.35365378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649388]
Stock Position:  -0.0064938846002000755
Bond Position:  [0.80939298]


portfolio before change:  [0.14513777]
curr_Stock_Price:  102.35168139179176
curr_Factors:  [102.35168139]
mat_Sqrt:  [[0.15]]
grads:  [-0.05847055]
Stock Position:  -0.05847054837782547
Bond Position:  [6.12969671]


portfolio before change:  [0.27830923]
curr_Stock_Price:  100.12652958500426
curr_Factors:  [100.12652959]
mat_Sqrt:  [[0.15]]
grads:  [0.09142154]
Stock Position:  0.09142153897569982
Bond Position:  [-8.8754122]


portfolio before change:  [0.227966]
curr_Stock_Price:  99.62441143064333
curr_Factors:  [99.62441143]
mat_Sqrt:  [[0.15]]
grads:  [0.10624499]
Stock Position:  0.10624499010532171
Bond Position:  [-10.35662861]


portfolio before change:  [0.34271906]
curr_Stock_Price:  100.75324273334147
curr_Factors:  [100.75324273]
mat_Sqrt:  [[0.15]]
grads:  [0.14547633]
Stock Position:  0.1454763295877659
Bond Position:  [-14.31449289]


portfolio before change:  [0.18349486]
curr_Stock_Price:  99.70795128893339
curr_Factors:  [99.70795129]
mat_Sqrt:  [[0.15]]
grads:  [0.02443242]
Stock Position:  0.024432419614039337
Bond Position:  [-2.25261164]


portfolio before change:  [0.19951445]
curr_Stock_Price:  100.40973094272624
curr_Factors:  [100.40973094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.19951445]
Stock Price:  102.17524820413747
PL:  [-1.97573376]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.76685660e-03]
 [ 6.36876496e-03]
 [-5.08702092e-03]
 [-1.49189807e-02]
 [-4.08680009e-03]
 [ 1.64217837e-02]
 [ 1.91016056e-02]
 [ 1.41579960e-03]
 [-2.87870739e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [55.97598359]
curr_Stock_Price:  103.55598584437399
curr_Factors:  [103.55598584]
mat_Sqrt:  [[0.15]]
grads:  [-0.01844571]
Stock Position:  -0.01844571068752158
Bond Position:  [57.88614734]


portfolio before change:  [55.98129965]
curr_Stock_Price:  104.83727267146011
curr_Factors:  [104.83727267]
mat_Sqrt:  [[0.15]]
grads:  [0.04245843]
Stock Position:  0.04245843307790925
Bond Position:  [51.53007333]


portfolio before change:  [56.03022175]
curr_Stock_Price:  105.38252636658116
curr_Factors:  [105.38252637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03391347]
Stock Position:  -0.03391347281067779
Bond Position:  [59.60410919]


portfolio before change:  [55.97723314]
curr_Stock_Price:  107.82397846292331
curr_Factors:  [107.82397846]
mat_Sqrt:  [[0.15]]
grads:  [-0.09945987]
Stock Position:  -0.09945987107747077
Bond Position:  [66.70139213]


portfolio before change:  [55.94832461]
curr_Stock_Price:  108.45003562975711
curr_Factors:  [108.45003563]
mat_Sqrt:  [[0.15]]
grads:  [-0.02724533]
Stock Position:  -0.027245333953709254
Bond Position:  [58.90308205]


portfolio before change:  [56.04889451]
curr_Stock_Price:  105.84001064393976
curr_Factors:  [105.84001064]
mat_Sqrt:  [[0.15]]
grads:  [0.10947856]
Stock Position:  0.10947855776451797
Bond Position:  [44.4616828]


portfolio before change:  [55.88219974]
curr_Stock_Price:  104.11427388255956
curr_Factors:  [104.11427388]
mat_Sqrt:  [[0.15]]
grads:  [0.12734404]
Stock Position:  0.12734403705015956
Bond Position:  [42.62386779]


portfolio before change:  [55.92255451]
curr_Stock_Price:  104.26377050201842
curr_Factors:  [104.2637705]
mat_Sqrt:  [[0.15]]
grads:  [0.00943866]
Stock Position:  0.009438663990233492
Bond Position:  [54.93844381]


portfolio before change:  [55.93524551]
curr_Stock_Price:  102.6973314069636
curr_Factors:  [102.69733141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [55.93524551]
Stock Price:  105.25881126263835
PL:  [50.67643424]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.71606398e-02]
 [ 5.13268590e-03]
 [ 1.24800795e-03]
 [-5.34952513e-03]
 [ 8.61554060e-03]
 [ 1.65555923e-02]
 [ 1.33609224e-02]
 [ 1.32934285e-02]
 [-4.12629431e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.34157519]
curr_Stock_Price:  99.49734419976163
curr_Factors:  [99.4973442]
mat_Sqrt:  [[0.15]]
grads:  [0.18107093]
Stock Position:  0.18107093191056783
Bond Position:  [-24.35765202]


portfolio before change:  [-6.40658281]
curr_Stock_Price:  99.20560353570205
curr_Factors:  [99.20560354]
mat_Sqrt:  [[0.15]]
grads:  [0.03421791]
Stock Position:  0.03421790600275376
Bond Position:  [-9.80119083]


portfolio before change:  [-6.42061926]
curr_Stock_Price:  98.93864909606854
curr_Factors:  [98.9386491]
mat_Sqrt:  [[0.15]]
grads:  [0.00832005]
Stock Position:  0.008320053002471588
Bond Position:  [-7.24379406]


portfolio before change:  [-6.41895798]
curr_Stock_Price:  99.5737508409359
curr_Factors:  [99.57375084]
mat_Sqrt:  [[0.15]]
grads:  [-0.0356635]
Stock Position:  -0.035663500862765
Bond Position:  [-2.86780943]


portfolio before change:  [-6.36282145]
curr_Stock_Price:  97.95947329337346
curr_Factors:  [97.95947329]
mat_Sqrt:  [[0.15]]
grads:  [0.05743694]
Stock Position:  0.057436937321392184
Bond Position:  [-11.98931358]


portfolio before change:  [-6.52282435]
curr_Stock_Price:  95.2781544081968
curr_Factors:  [95.27815441]
mat_Sqrt:  [[0.15]]
grads:  [0.11037062]
Stock Position:  0.11037061553402623
Bond Position:  [-17.0387329]


portfolio before change:  [-6.45567459]
curr_Stock_Price:  95.96376492586839
curr_Factors:  [95.96376493]
mat_Sqrt:  [[0.15]]
grads:  [0.08907282]
Stock Position:  0.08907281613486277
Bond Position:  [-15.00343738]


portfolio before change:  [-6.59470621]
curr_Stock_Price:  94.48713016463108
curr_Factors:  [94.48713016]
mat_Sqrt:  [[0.15]]
grads:  [0.08862286]
Stock Position:  0.08862285672563387
Bond Position:  [-14.9684256]


portfolio before change:  [-6.59060349]
curr_Stock_Price:  94.61789548882797
curr_Factors:  [94.61789549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.59060349]
Stock Price:  94.51969614564729
PL:  [-6.59060349]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 8.32611364e-03]
 [ 5.55881662e-03]
 [ 7.49364780e-04]
 [-5.13198174e-03]
 [ 9.63992892e-03]
 [ 1.63762078e-02]
 [ 1.35986411e-02]
 [ 3.50735005e-03]
 [-5.43752810e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.50285835]
curr_Stock_Price:  100.3338813475689
curr_Factors:  [100.33388135]
mat_Sqrt:  [[0.15]]
grads:  [0.05550742]
Stock Position:  0.055507424284210696
Bond Position:  [0.93358303]


portfolio before change:  [6.45374096]
curr_Stock_Price:  99.44058997359244
curr_Factors:  [99.44058997]
mat_Sqrt:  [[0.15]]
grads:  [0.03705878]
Stock Position:  0.03705877747125061
Bond Position:  [2.76859426]


portfolio before change:  [6.41533094]
curr_Stock_Price:  98.36676434043392
curr_Factors:  [98.36676434]
mat_Sqrt:  [[0.15]]
grads:  [0.00499577]
Stock Position:  0.004995765201017016
Bond Position:  [5.92391368]


portfolio before change:  [6.42295696]
curr_Stock_Price:  99.30021954011687
curr_Factors:  [99.30021954]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421321]
Stock Position:  -0.03421321163092273
Bond Position:  [9.82033638]


portfolio before change:  [6.44421694]
curr_Stock_Price:  98.82237519394882
curr_Factors:  [98.82237519]
mat_Sqrt:  [[0.15]]
grads:  [0.06426619]
Stock Position:  0.06426619277370477
Bond Position:  [0.09327913]


portfolio before change:  [6.34307527]
curr_Stock_Price:  97.24785639109831
curr_Factors:  [97.24785639]
mat_Sqrt:  [[0.15]]
grads:  [0.10917472]
Stock Position:  0.1091747188982988
Bond Position:  [-4.27393212]


portfolio before change:  [6.29929206]
curr_Stock_Price:  96.86639711431567
curr_Factors:  [96.86639711]
mat_Sqrt:  [[0.15]]
grads:  [0.09065761]
Stock Position:  0.09065760750440305
Bond Position:  [-2.48238375]


portfolio before change:  [6.3979678]
curr_Stock_Price:  97.96853570606272
curr_Factors:  [97.96853571]
mat_Sqrt:  [[0.15]]
grads:  [0.02338233]
Stock Position:  0.023382333661437212
Bond Position:  [4.10723481]


portfolio before change:  [6.37458591]
curr_Stock_Price:  96.8807049056469
curr_Factors:  [96.88070491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.37458591]
Stock Price:  98.58625689818292
PL:  [6.37458591]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.88419094e-02]
 [ 3.51131324e-03]
 [ 8.61220671e-04]
 [-4.77692586e-03]
 [ 9.15966006e-03]
 [ 1.59878882e-02]
 [ 1.35784508e-02]
 [ 8.02612244e-03]
 [-6.99239978e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.54311376]
curr_Stock_Price:  99.02831965942096
curr_Factors:  [99.02831966]
mat_Sqrt:  [[0.15]]
grads:  [0.12561273]
Stock Position:  0.12561272905107373
Bond Position:  [-25.98233125]


portfolio before change:  [-13.68863471]
curr_Stock_Price:  97.97327902425329
curr_Factors:  [97.97327902]
mat_Sqrt:  [[0.15]]
grads:  [0.02340875]
Stock Position:  0.023408754930517563
Bond Position:  [-15.98206719]


portfolio before change:  [-13.70155143]
curr_Stock_Price:  97.76294384580517
curr_Factors:  [97.76294385]
mat_Sqrt:  [[0.15]]
grads:  [0.00574147]
Stock Position:  0.005741471140879048
Bond Position:  [-14.26285455]


portfolio before change:  [-13.71179284]
curr_Stock_Price:  97.22158371446059
curr_Factors:  [97.22158371]
mat_Sqrt:  [[0.15]]
grads:  [-0.03184617]
Stock Position:  -0.03184617236735126
Bond Position:  [-10.61565753]


portfolio before change:  [-13.75988697]
curr_Stock_Price:  98.56507239556852
curr_Factors:  [98.5650724]
mat_Sqrt:  [[0.15]]
grads:  [0.0610644]
Stock Position:  0.061064400389091056
Bond Position:  [-19.77870401]


portfolio before change:  [-13.72419766]
curr_Stock_Price:  99.3115160563129
curr_Factors:  [99.31151606]
mat_Sqrt:  [[0.15]]
grads:  [0.10658592]
Stock Position:  0.10658592148852164
Bond Position:  [-24.30940711]


portfolio before change:  [-14.05618201]
curr_Stock_Price:  96.31087015685769
curr_Factors:  [96.31087016]
mat_Sqrt:  [[0.15]]
grads:  [0.09052301]
Stock Position:  0.0905230052852644
Bond Position:  [-22.77453142]


portfolio before change:  [-14.09741572]
curr_Stock_Price:  95.98119043793535
curr_Factors:  [95.98119044]
mat_Sqrt:  [[0.15]]
grads:  [0.05350748]
Stock Position:  0.05350748293936112
Bond Position:  [-19.23312763]


portfolio before change:  [-13.9946398]
curr_Stock_Price:  98.08173561750174
curr_Factors:  [98.08173562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.9946398]
Stock Price:  96.86774953017009
PL:  [-13.9946398]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.90139329e-03]
 [ 6.82931013e-03]
 [ 6.45109017e-04]
 [-7.02157913e-03]
 [ 1.21455500e-02]
 [ 1.61815857e-02]
 [ 2.29620387e-02]
 [ 2.21621548e-03]
 [-5.71048734e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.80285978]
curr_Stock_Price:  100.87444699359548
curr_Factors:  [100.87444699]
mat_Sqrt:  [[0.15]]
grads:  [0.03267596]
Stock Position:  0.032675955292639135
Bond Position:  [11.50669086]


portfolio before change:  [14.79802245]
curr_Stock_Price:  100.55029101716603
curr_Factors:  [100.55029102]
mat_Sqrt:  [[0.15]]
grads:  [0.04552873]
Stock Position:  0.045528734220153834
Bond Position:  [10.22009498]


portfolio before change:  [14.79762637]
curr_Stock_Price:  100.42932543731551
curr_Factors:  [100.42932544]
mat_Sqrt:  [[0.15]]
grads:  [0.00430073]
Stock Position:  0.004300726780040091
Bond Position:  [14.36570728]


portfolio before change:  [14.80667638]
curr_Stock_Price:  100.86305731631877
curr_Factors:  [100.86305732]
mat_Sqrt:  [[0.15]]
grads:  [-0.04681053]
Stock Position:  -0.046810527507251995
Bond Position:  [19.5281293]


portfolio before change:  [14.81187706]
curr_Stock_Price:  100.96059578634602
curr_Factors:  [100.96059579]
mat_Sqrt:  [[0.15]]
grads:  [0.08097033]
Stock Position:  0.08097033324616204
Bond Position:  [6.63706397]


portfolio before change:  [14.90622485]
curr_Stock_Price:  102.08481523551269
curr_Factors:  [102.08481524]
mat_Sqrt:  [[0.15]]
grads:  [0.10787724]
Stock Position:  0.1078772382493812
Bond Position:  [3.89359691]


portfolio before change:  [14.80128351]
curr_Stock_Price:  101.0939794788896
curr_Factors:  [101.09397948]
mat_Sqrt:  [[0.15]]
grads:  [0.15308026]
Stock Position:  0.1530802582550699
Bond Position:  [-0.67420898]


portfolio before change:  [14.88715783]
curr_Stock_Price:  101.65715797894268
curr_Factors:  [101.65715798]
mat_Sqrt:  [[0.15]]
grads:  [0.01477477]
Stock Position:  0.014774769840645017
Bond Position:  [13.38519672]


portfolio before change:  [14.87059927]
curr_Stock_Price:  100.08333793712605
curr_Factors:  [100.08333794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.87059927]
Stock Price:  102.17535267485061
PL:  [12.6952466]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.40292923e-02]
 [ 1.82997512e-03]
 [ 2.21831040e-03]
 [-4.70958270e-03]
 [ 1.05175771e-02]
 [ 1.63934821e-02]
 [ 1.50292740e-02]
 [ 3.66500015e-03]
 [-4.19242876e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.00085269]
curr_Stock_Price:  98.15183892563323
curr_Factors:  [98.15183893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09352862]
Stock Position:  -0.0935286150573259
Bond Position:  [-17.82084713]


portfolio before change:  [-26.79582929]
curr_Stock_Price:  95.86445293927707
curr_Factors:  [95.86445294]
mat_Sqrt:  [[0.15]]
grads:  [0.01219983]
Stock Position:  0.01219983413126651
Bond Position:  [-27.96535972]


portfolio before change:  [-26.81046425]
curr_Stock_Price:  95.81127327402103
curr_Factors:  [95.81127327]
mat_Sqrt:  [[0.15]]
grads:  [0.01478874]
Stock Position:  0.014788736012086613
Bond Position:  [-28.22739188]


portfolio before change:  [-26.79051449]
curr_Stock_Price:  98.11485020807272
curr_Factors:  [98.11485021]
mat_Sqrt:  [[0.15]]
grads:  [-0.03139722]
Stock Position:  -0.03139721801411412
Bond Position:  [-23.70998115]


portfolio before change:  [-26.74140198]
curr_Stock_Price:  96.17294382694436
curr_Factors:  [96.17294383]
mat_Sqrt:  [[0.15]]
grads:  [0.07011718]
Stock Position:  0.07011718047405752
Bond Position:  [-33.48477764]


portfolio before change:  [-26.69487068]
curr_Stock_Price:  97.07540279900847
curr_Factors:  [97.0754028]
mat_Sqrt:  [[0.15]]
grads:  [0.10928988]
Stock Position:  0.10928988087194079
Bond Position:  [-37.30422989]


portfolio before change:  [-26.57059304]
curr_Stock_Price:  98.38324962778974
curr_Factors:  [98.38324963]
mat_Sqrt:  [[0.15]]
grads:  [0.10019516]
Stock Position:  0.10019516006902997
Bond Position:  [-36.42811848]


portfolio before change:  [-26.69166348]
curr_Stock_Price:  97.35673464943675
curr_Factors:  [97.35673465]
mat_Sqrt:  [[0.15]]
grads:  [0.02443333]
Stock Position:  0.02443333434888067
Bond Position:  [-29.07041313]


portfolio before change:  [-26.77006291]
curr_Stock_Price:  94.74306800858616
curr_Factors:  [94.74306801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.77006291]
Stock Price:  95.20242743186789
PL:  [-26.77006291]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.20085450e-02]
 [ 2.90903362e-03]
 [ 1.10351628e-03]
 [-4.80867397e-03]
 [ 1.37075304e-02]
 [ 1.65858315e-02]
 [ 1.09899906e-02]
 [ 1.64912246e-02]
 [-3.36674917e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.34074903]
curr_Stock_Price:  98.84611420660201
curr_Factors:  [98.84611421]
mat_Sqrt:  [[0.15]]
grads:  [0.08005697]
Stock Position:  0.08005696690434881
Bond Position:  [-24.25406913]


portfolio before change:  [-16.48323163]
curr_Stock_Price:  97.21786703808306
curr_Factors:  [97.21786704]
mat_Sqrt:  [[0.15]]
grads:  [0.01939356]
Stock Position:  0.01939355747819551
Bond Position:  [-18.36863192]


portfolio before change:  [-16.48860499]
curr_Stock_Price:  97.41449141855043
curr_Factors:  [97.41449142]
mat_Sqrt:  [[0.15]]
grads:  [0.00735678]
Stock Position:  0.007356775203955045
Bond Position:  [-17.20526151]


portfolio before change:  [-16.50172704]
curr_Stock_Price:  96.80046400275711
curr_Factors:  [96.800464]
mat_Sqrt:  [[0.15]]
grads:  [-0.03205783]
Stock Position:  -0.03205782648082718
Bond Position:  [-13.39851456]


portfolio before change:  [-16.43654655]
curr_Stock_Price:  94.55822151151736
curr_Factors:  [94.55822151]
mat_Sqrt:  [[0.15]]
grads:  [0.09138354]
Stock Position:  0.09138353606949234
Bond Position:  [-25.0776112]


portfolio before change:  [-16.43571421]
curr_Stock_Price:  94.70457479527077
curr_Factors:  [94.7045748]
mat_Sqrt:  [[0.15]]
grads:  [0.11057221]
Stock Position:  0.110572209887006
Bond Position:  [-26.90740833]


portfolio before change:  [-16.5197868]
curr_Stock_Price:  94.06593760677836
curr_Factors:  [94.06593761]
mat_Sqrt:  [[0.15]]
grads:  [0.0732666]
Stock Position:  0.0732666041113861
Bond Position:  [-23.41167861]


portfolio before change:  [-16.56709256]
curr_Stock_Price:  93.58008204227981
curr_Factors:  [93.58008204]
mat_Sqrt:  [[0.15]]
grads:  [0.1099415]
Stock Position:  0.10994149723004885
Bond Position:  [-26.85542689]


portfolio before change:  [-16.6244756]
curr_Stock_Price:  93.18030607026054
curr_Factors:  [93.18030607]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.6244756]
Stock Price:  92.12734224729365
PL:  [-16.6244756]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.60616327e-02]
 [ 6.84438573e-03]
 [-2.15096264e-03]
 [-8.25460217e-03]
 [ 1.27270353e-02]
 [ 1.61683702e-02]
 [ 1.36044198e-02]
 [ 6.03276289e-03]
 [-6.53616303e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.96096001]
curr_Stock_Price:  99.26161952981029
curr_Factors:  [99.26161953]
mat_Sqrt:  [[0.15]]
grads:  [0.17374422]
Stock Position:  0.1737442178580757
Bond Position:  [-27.20709246]


portfolio before change:  [-9.74525977]
curr_Stock_Price:  100.5814170436323
curr_Factors:  [100.58141704]
mat_Sqrt:  [[0.15]]
grads:  [0.04562924]
Stock Position:  0.04562923820217406
Bond Position:  [-14.33471321]


portfolio before change:  [-9.6361592]
curr_Stock_Price:  103.12955777693917
curr_Factors:  [103.12955778]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433975]
Stock Position:  -0.014339750935280577
Bond Position:  [-8.15730703]


portfolio before change:  [-9.62288599]
curr_Stock_Price:  101.91943314968017
curr_Factors:  [101.91943315]
mat_Sqrt:  [[0.15]]
grads:  [-0.05503068]
Stock Position:  -0.05503068115991817
Bond Position:  [-4.01419016]


portfolio before change:  [-9.58809453]
curr_Stock_Price:  101.25073250541786
curr_Factors:  [101.25073251]
mat_Sqrt:  [[0.15]]
grads:  [0.0848469]
Stock Position:  0.08484690223921973
Bond Position:  [-18.17890554]


portfolio before change:  [-9.82780683]
curr_Stock_Price:  98.53265368279189
curr_Factors:  [98.53265368]
mat_Sqrt:  [[0.15]]
grads:  [0.10778913]
Stock Position:  0.1077891348665753
Bond Position:  [-20.44855632]


portfolio before change:  [-10.00049969]
curr_Stock_Price:  97.02539571896307
curr_Factors:  [97.02539572]
mat_Sqrt:  [[0.15]]
grads:  [0.09069613]
Stock Position:  0.0906961323045739
Bond Position:  [-18.80032782]


portfolio before change:  [-10.05332689]
curr_Stock_Price:  96.54660267541115
curr_Factors:  [96.54660268]
mat_Sqrt:  [[0.15]]
grads:  [0.04021842]
Stock Position:  0.040218419293766565
Bond Position:  [-13.93627863]


portfolio before change:  [-10.01272957]
curr_Stock_Price:  97.72932431806277
curr_Factors:  [97.72932432]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.01272957]
Stock Price:  95.79863056211586
PL:  [-10.01272957]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.91360709e-03]
 [ 6.96187385e-03]
 [-2.04404675e-03]
 [-1.08110774e-02]
 [ 8.34121943e-03]
 [ 1.60653953e-02]
 [ 2.39125724e-02]
 [ 2.03013923e-03]
 [-1.05961853e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24978216]
curr_Stock_Price:  100.25227052490506
curr_Factors:  [100.25227052]
mat_Sqrt:  [[0.15]]
grads:  [0.06609071]
Stock Position:  0.06609071393763259
Bond Position:  [-1.37596198]


portfolio before change:  [5.28826078]
curr_Stock_Price:  100.84489201818091
curr_Factors:  [100.84489202]
mat_Sqrt:  [[0.15]]
grads:  [0.04641249]
Stock Position:  0.04641249232124871
Bond Position:  [0.60779801]


portfolio before change:  [5.39079405]
curr_Stock_Price:  103.04751644496656
curr_Factors:  [103.04751644]
mat_Sqrt:  [[0.15]]
grads:  [-0.01362698]
Stock Position:  -0.013626978364148534
Bond Position:  [6.79502032]


portfolio before change:  [5.38067227]
curr_Stock_Price:  104.03967573753668
curr_Factors:  [104.03967574]
mat_Sqrt:  [[0.15]]
grads:  [-0.07207385]
Stock Position:  -0.07207384922016213
Bond Position:  [12.87921217]


portfolio before change:  [5.47997223]
curr_Stock_Price:  102.75129251730668
curr_Factors:  [102.75129252]
mat_Sqrt:  [[0.15]]
grads:  [0.05560813]
Stock Position:  0.05560812953725784
Bond Position:  [-0.23383496]


portfolio before change:  [5.40007841]
curr_Stock_Price:  101.31666644998623
curr_Factors:  [101.31666645]
mat_Sqrt:  [[0.15]]
grads:  [0.10710264]
Stock Position:  0.10710263517444224
Bond Position:  [-5.45120356]


portfolio before change:  [5.40808045]
curr_Stock_Price:  101.41683507799566
curr_Factors:  [101.41683508]
mat_Sqrt:  [[0.15]]
grads:  [0.15941715]
Stock Position:  0.1594171493305856
Bond Position:  [-10.75950229]


portfolio before change:  [5.47052046]
curr_Stock_Price:  101.84226677650756
curr_Factors:  [101.84226678]
mat_Sqrt:  [[0.15]]
grads:  [0.01353426]
Stock Position:  0.013534261545072906
Bond Position:  [4.09216059]


portfolio before change:  [5.49095592]
curr_Stock_Price:  103.20095685071537
curr_Factors:  [103.20095685]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.49095592]
Stock Price:  105.58109845656163
PL:  [-0.09014254]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.73334483e-02]
 [ 7.03838068e-03]
 [ 2.13193910e-03]
 [-4.82260478e-03]
 [ 1.21633879e-02]
 [ 1.59351453e-02]
 [ 1.68158012e-02]
 [ 3.24260054e-03]
 [-6.20214301e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.53743597]
curr_Stock_Price:  99.48458810461219
curr_Factors:  [99.4845881]
mat_Sqrt:  [[0.15]]
grads:  [0.18222299]
Stock Position:  0.1822229889503722
Bond Position:  [-24.66581496]


portfolio before change:  [-6.20233365]
curr_Stock_Price:  101.39125370884906
curr_Factors:  [101.39125371]
mat_Sqrt:  [[0.15]]
grads:  [0.04692254]
Stock Position:  0.04692253788121409
Bond Position:  [-10.95986859]


portfolio before change:  [-6.29074896]
curr_Stock_Price:  99.62378743954757
curr_Factors:  [99.62378744]
mat_Sqrt:  [[0.15]]
grads:  [0.01421293]
Stock Position:  0.014212927356982489
Bond Position:  [-7.70669461]


portfolio before change:  [-6.30563637]
curr_Stock_Price:  98.84751528139438
curr_Factors:  [98.84751528]
mat_Sqrt:  [[0.15]]
grads:  [-0.0321507]
Stock Position:  -0.03215069855790689
Bond Position:  [-3.1276197]


portfolio before change:  [-6.37606118]
curr_Stock_Price:  100.98932288264899
curr_Factors:  [100.98932288]
mat_Sqrt:  [[0.15]]
grads:  [0.08108925]
Stock Position:  0.08108925247675543
Bond Position:  [-14.56520988]


portfolio before change:  [-6.49242817]
curr_Stock_Price:  99.64410681129635
curr_Factors:  [99.64410681]
mat_Sqrt:  [[0.15]]
grads:  [0.1062343]
Stock Position:  0.10623430199939196
Bond Position:  [-17.07805031]


portfolio before change:  [-6.56225783]
curr_Stock_Price:  99.06718865790441
curr_Factors:  [99.06718866]
mat_Sqrt:  [[0.15]]
grads:  [0.11210534]
Stock Position:  0.11210534111166681
Bond Position:  [-17.66821881]


portfolio before change:  [-6.39365655]
curr_Stock_Price:  100.64996421863434
curr_Factors:  [100.64996422]
mat_Sqrt:  [[0.15]]
grads:  [0.02161734]
Stock Position:  0.0216173369663517
Bond Position:  [-8.56944075]


portfolio before change:  [-6.46665623]
curr_Stock_Price:  97.4713169806529
curr_Factors:  [97.47131698]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.46665623]
Stock Price:  97.0193552689381
PL:  [-6.46665623]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-6.04108856e-02]
 [-2.97078410e-04]
 [ 1.44805883e-03]
 [-4.94650633e-03]
 [ 9.03270720e-03]
 [ 1.63485500e-02]
 [ 1.45974346e-02]
 [ 2.98704715e-03]
 [-6.36837533e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-52.20016184]
curr_Stock_Price:  96.51064874528826
curr_Factors:  [96.51064875]
mat_Sqrt:  [[0.15]]
grads:  [-0.40273924]
Stock Position:  -0.40273923743164913
Bond Position:  [-13.33153676]


portfolio before change:  [-50.87212627]
curr_Stock_Price:  93.19658624807377
curr_Factors:  [93.19658625]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198052]
Stock Position:  -0.00198052273063928
Bond Position:  [-50.68754831]


portfolio before change:  [-50.90484869]
curr_Stock_Price:  96.91899467037936
curr_Factors:  [96.91899467]
mat_Sqrt:  [[0.15]]
grads:  [0.00965373]
Stock Position:  0.009653725513262462
Bond Position:  [-51.84047807]


portfolio before change:  [-50.94956923]
curr_Stock_Price:  94.97220056768381
curr_Factors:  [94.97220057]
mat_Sqrt:  [[0.15]]
grads:  [-0.03297671]
Stock Position:  -0.032976708845619936
Bond Position:  [-47.81769862]


portfolio before change:  [-51.03834213]
curr_Stock_Price:  96.9389848227017
curr_Factors:  [96.93898482]
mat_Sqrt:  [[0.15]]
grads:  [0.06021805]
Stock Position:  0.06021804797402887
Bond Position:  [-56.87581857]


portfolio before change:  [-51.03156039]
curr_Stock_Price:  97.52397162073578
curr_Factors:  [97.52397162]
mat_Sqrt:  [[0.15]]
grads:  [0.10899033]
Stock Position:  0.10899033320698133
Bond Position:  [-61.66073055]


portfolio before change:  [-50.98676394]
curr_Stock_Price:  98.21792784205253
curr_Factors:  [98.21792784]
mat_Sqrt:  [[0.15]]
grads:  [0.09731623]
Stock Position:  0.09731623035201685
Bond Position:  [-60.54496243]


portfolio before change:  [-50.75596289]
curr_Stock_Price:  100.9007392851468
curr_Factors:  [100.90073929]
mat_Sqrt:  [[0.15]]
grads:  [0.01991365]
Stock Position:  0.01991364767270496
Bond Position:  [-52.76526467]


portfolio before change:  [-50.80666764]
curr_Stock_Price:  99.67969149721867
curr_Factors:  [99.6796915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-50.80666764]
Stock Price:  100.77393716541467
PL:  [-51.5806048]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-8.52957684e-03]
 [ 3.84238814e-03]
 [ 7.04268382e-04]
 [-5.51771692e-03]
 [ 1.31925648e-02]
 [ 1.61251698e-02]
 [ 1.36195891e-02]
 [ 7.65412536e-03]
 [-5.05389640e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.74922419]
curr_Stock_Price:  98.2984838416953
curr_Factors:  [98.29848384]
mat_Sqrt:  [[0.15]]
grads:  [-0.05686385]
Stock Position:  -0.056863845629216474
Bond Position:  [-19.15959438]


portfolio before change:  [-24.76117453]
curr_Stock_Price:  98.34012975395369
curr_Factors:  [98.34012975]
mat_Sqrt:  [[0.15]]
grads:  [0.02561592]
Stock Position:  0.025615920961429478
Bond Position:  [-27.28024752]


portfolio before change:  [-24.77606029]
curr_Stock_Price:  98.29163549874721
curr_Factors:  [98.2916355]
mat_Sqrt:  [[0.15]]
grads:  [0.00469512]
Stock Position:  0.004695122545763574
Bond Position:  [-25.23755156]


portfolio before change:  [-24.78209501]
curr_Stock_Price:  99.69462591240215
curr_Factors:  [99.69462591]
mat_Sqrt:  [[0.15]]
grads:  [-0.03678478]
Stock Position:  -0.036784779491089124
Bond Position:  [-21.11485018]


portfolio before change:  [-24.81839547]
curr_Stock_Price:  100.39438252802739
curr_Factors:  [100.39438253]
mat_Sqrt:  [[0.15]]
grads:  [0.08795043]
Stock Position:  0.08795043232015855
Bond Position:  [-33.64812481]


portfolio before change:  [-24.98515378]
curr_Stock_Price:  98.68967184098287
curr_Factors:  [98.68967184]
mat_Sqrt:  [[0.15]]
grads:  [0.10750113]
Stock Position:  0.10750113185158353
Bond Position:  [-35.5944052]


portfolio before change:  [-25.13699873]
curr_Stock_Price:  97.44277054437723
curr_Factors:  [97.44277054]
mat_Sqrt:  [[0.15]]
grads:  [0.09079726]
Stock Position:  0.09079726075020388
Bond Position:  [-33.98453538]


portfolio before change:  [-25.27712214]
curr_Stock_Price:  96.0867066256316
curr_Factors:  [96.08670663]
mat_Sqrt:  [[0.15]]
grads:  [0.0510275]
Stock Position:  0.051027502420729384
Bond Position:  [-30.18018679]


portfolio before change:  [-25.27757829]
curr_Stock_Price:  96.37356593359377
curr_Factors:  [96.37356593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.27757829]
Stock Price:  98.19908807146095
PL:  [-25.27757829]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.97267111e-03]
 [ 6.83093304e-03]
 [-4.80132312e-03]
 [-1.20246069e-02]
 [-1.26253685e-03]
 [ 1.64225703e-02]
 [ 6.95674514e-03]
 [ 2.71694202e-03]
 [ 2.19917896e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [44.78673565]
curr_Stock_Price:  102.82724825331084
curr_Factors:  [102.82724825]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981781]
Stock Position:  -0.019817807380084117
Bond Position:  [46.82454625]


portfolio before change:  [44.81540176]
curr_Stock_Price:  102.56243661543975
curr_Factors:  [102.56243662]
mat_Sqrt:  [[0.15]]
grads:  [0.04553955]
Stock Position:  0.045539553582846774
Bond Position:  [40.14475418]


portfolio before change:  [44.95392121]
curr_Stock_Price:  105.16329769132221
curr_Factors:  [105.16329769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03200882]
Stock Position:  -0.03200882081670025
Bond Position:  [48.32007436]


portfolio before change:  [44.98191979]
curr_Stock_Price:  105.04356487779022
curr_Factors:  [105.04356488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08016405]
Stock Position:  -0.08016404574341937
Bond Position:  [53.40263693]


portfolio before change:  [44.89823172]
curr_Stock_Price:  106.42069188721976
curr_Factors:  [106.42069189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00841691]
Stock Position:  -0.008416912357753804
Bond Position:  [45.79396535]


portfolio before change:  [44.92722392]
curr_Stock_Price:  105.69720893988624
curr_Factors:  [105.69720894]
mat_Sqrt:  [[0.15]]
grads:  [0.1094838]
Stock Position:  0.1094838020479702
Bond Position:  [33.35509162]


portfolio before change:  [45.19867923]
curr_Stock_Price:  108.02425271273688
curr_Factors:  [108.02425271]
mat_Sqrt:  [[0.15]]
grads:  [0.0463783]
Stock Position:  0.04637830091313287
Bond Position:  [40.18869793]


portfolio before change:  [45.15741074]
curr_Stock_Price:  106.70105063018687
curr_Factors:  [106.70105063]
mat_Sqrt:  [[0.15]]
grads:  [0.01811295]
Stock Position:  0.018112946795542248
Bond Position:  [43.22474029]


portfolio before change:  [45.20089678]
curr_Stock_Price:  107.90837839003962
curr_Factors:  [107.90837839]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [45.20089678]
Stock Price:  106.86950661615974
PL:  [38.33139016]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 3.63290697e-03]
 [ 6.77923225e-03]
 [-3.02675675e-03]
 [-1.02219479e-02]
 [ 8.24179633e-04]
 [ 1.62599661e-02]
 [ 1.37568151e-02]
 [ 1.25841037e-03]
 [ 3.68008707e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.60545362]
curr_Stock_Price:  101.1221037701481
curr_Factors:  [101.12210377]
mat_Sqrt:  [[0.15]]
grads:  [0.02421938]
Stock Position:  0.02421937977601869
Bond Position:  [16.15633898]


portfolio before change:  [18.65458103]
curr_Stock_Price:  102.8169129035026
curr_Factors:  [102.8169129]
mat_Sqrt:  [[0.15]]
grads:  [0.04519488]
Stock Position:  0.04519488166370084
Bond Position:  [14.00778282]


portfolio before change:  [18.70608921]
curr_Stock_Price:  103.80159369207253
curr_Factors:  [103.80159369]
mat_Sqrt:  [[0.15]]
grads:  [-0.02017838]
Stock Position:  -0.020178378314985257
Bond Position:  [20.80063704]


portfolio before change:  [18.72152207]
curr_Stock_Price:  103.55231989513493
curr_Factors:  [103.5523199]
mat_Sqrt:  [[0.15]]
grads:  [-0.06814632]
Stock Position:  -0.06814631939272321
Bond Position:  [25.77823153]


portfolio before change:  [18.64112315]
curr_Stock_Price:  104.9213043708418
curr_Factors:  [104.92130437]
mat_Sqrt:  [[0.15]]
grads:  [0.00549453]
Stock Position:  0.005494530884867551
Bond Position:  [18.06462981]


portfolio before change:  [18.63669336]
curr_Stock_Price:  102.47080007029936
curr_Factors:  [102.47080007]
mat_Sqrt:  [[0.15]]
grads:  [0.10839977]
Stock Position:  0.10839977386057488
Bond Position:  [7.5288818]


portfolio before change:  [19.00352358]
curr_Stock_Price:  105.8201137035212
curr_Factors:  [105.8201137]
mat_Sqrt:  [[0.15]]
grads:  [0.0917121]
Stock Position:  0.09171210041058991
Bond Position:  [9.29853869]


portfolio before change:  [18.96910056]
curr_Stock_Price:  105.39406902954865
curr_Factors:  [105.39406903]
mat_Sqrt:  [[0.15]]
grads:  [0.0083894]
Stock Position:  0.008389402476738321
Bond Position:  [18.0849073]


portfolio before change:  [18.97015002]
curr_Stock_Price:  104.44105057319722
curr_Factors:  [104.44105057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.97015002]
Stock Price:  103.87414369092815
PL:  [15.09600633]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.07677863e-02]
 [ 6.82592784e-03]
 [-8.81620726e-04]
 [-7.95479110e-03]
 [ 1.35250246e-02]
 [ 1.59505050e-02]
 [ 1.66836068e-02]
 [ 3.55782299e-03]
 [-7.26555777e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.57554216]
curr_Stock_Price:  100.2083583659801
curr_Factors:  [100.20835837]
mat_Sqrt:  [[0.15]]
grads:  [0.07178524]
Stock Position:  0.07178524172255857
Bond Position:  [-2.61793907]


portfolio before change:  [4.74498944]
curr_Stock_Price:  102.58707267159639
curr_Factors:  [102.58707267]
mat_Sqrt:  [[0.15]]
grads:  [0.04550619]
Stock Position:  0.0455061856143797
Bond Position:  [0.07664307]


portfolio before change:  [4.73171918]
curr_Stock_Price:  102.29461588546896
curr_Factors:  [102.29461589]
mat_Sqrt:  [[0.15]]
grads:  [-0.00587747]
Stock Position:  -0.005877471508140592
Bond Position:  [5.33295287]


portfolio before change:  [4.73810113]
curr_Stock_Price:  101.66257406558192
curr_Factors:  [101.66257407]
mat_Sqrt:  [[0.15]]
grads:  [-0.05303194]
Stock Position:  -0.05303194068168119
Bond Position:  [10.12946473]


portfolio before change:  [4.83710928]
curr_Stock_Price:  99.89114830856354
curr_Factors:  [99.89114831]
mat_Sqrt:  [[0.15]]
grads:  [0.09016683]
Stock Position:  0.09016683056584511
Bond Position:  [-4.16975897]


portfolio before change:  [4.87602603]
curr_Stock_Price:  100.3458848445833
curr_Factors:  [100.34588484]
mat_Sqrt:  [[0.15]]
grads:  [0.1063367]
Stock Position:  0.10633670000232186
Bond Position:  [-5.79442423]


portfolio before change:  [4.73177425]
curr_Stock_Price:  99.01658046752033
curr_Factors:  [99.01658047]
mat_Sqrt:  [[0.15]]
grads:  [0.11122405]
Stock Position:  0.11122404514349644
Bond Position:  [-6.28125037]


portfolio before change:  [4.68234999]
curr_Stock_Price:  98.60045779009505
curr_Factors:  [98.60045779]
mat_Sqrt:  [[0.15]]
grads:  [0.02371882]
Stock Position:  0.023718819948372327
Bond Position:  [2.34366349]


portfolio before change:  [4.67622321]
curr_Stock_Price:  98.29273125224722
curr_Factors:  [98.29273125]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.67622321]
Stock Price:  94.93848884238551
PL:  [4.67622321]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.22996617e-02]
 [ 4.75583727e-03]
 [-4.27524992e-05]
 [-5.34403927e-03]
 [ 1.34268764e-02]
 [ 1.59697103e-02]
 [ 2.41826590e-02]
 [ 3.67225118e-03]
 [-4.57845608e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.04337412]
curr_Stock_Price:  99.1259952727898
curr_Factors:  [99.12599527]
mat_Sqrt:  [[0.15]]
grads:  [0.14866441]
Stock Position:  0.1486644110065287
Bond Position:  [-26.77988182]


portfolio before change:  [-12.06412243]
curr_Stock_Price:  99.07652124063334
curr_Factors:  [99.07652124]
mat_Sqrt:  [[0.15]]
grads:  [0.03170558]
Stock Position:  0.0317055818306427
Bond Position:  [-15.20540119]


portfolio before change:  [-12.0119996]
curr_Stock_Price:  100.96033563141245
curr_Factors:  [100.96033563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028502]
Stock Position:  -0.00028501666110973317
Bond Position:  [-11.98322423]


portfolio before change:  [-12.01759639]
curr_Stock_Price:  99.56980829431843
curr_Factors:  [99.56980829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03562693]
Stock Position:  -0.03562692844787648
Bond Position:  [-8.47022996]


portfolio before change:  [-12.02920159]
curr_Stock_Price:  99.77664706640277
curr_Factors:  [99.77664707]
mat_Sqrt:  [[0.15]]
grads:  [0.08951251]
Stock Position:  0.08951250920583356
Bond Position:  [-20.96045963]


portfolio before change:  [-12.07278625]
curr_Stock_Price:  99.40684614751235
curr_Factors:  [99.40684615]
mat_Sqrt:  [[0.15]]
grads:  [0.10646474]
Stock Position:  0.10646473540315105
Bond Position:  [-22.65610983]


portfolio before change:  [-11.85880061]
curr_Stock_Price:  101.52319507180964
curr_Factors:  [101.52319507]
mat_Sqrt:  [[0.15]]
grads:  [0.16121773]
Stock Position:  0.16121772669986323
Bond Position:  [-28.22613933]


portfolio before change:  [-12.13813598]
curr_Stock_Price:  99.87809828444902
curr_Factors:  [99.87809828]
mat_Sqrt:  [[0.15]]
grads:  [0.02448167]
Stock Position:  0.024481674551039726
Bond Position:  [-14.58331907]


portfolio before change:  [-12.1203704]
curr_Stock_Price:  100.90168254944942
curr_Factors:  [100.90168255]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.1203704]
Stock Price:  103.42975823127296
PL:  [-15.55012863]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.10180099e-02]
 [ 6.82906970e-03]
 [ 9.00773105e-04]
 [-4.82408476e-03]
 [ 8.33744165e-03]
 [ 1.64742310e-02]
 [ 1.62892075e-02]
 [ 3.56368265e-03]
 [-7.13832264e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.0365839]
curr_Stock_Price:  99.84284968795087
curr_Factors:  [99.84284969]
mat_Sqrt:  [[0.15]]
grads:  [0.14012007]
Stock Position:  0.14012006620412476
Bond Position:  [-15.02657061]


portfolio before change:  [-0.99717599]
curr_Stock_Price:  100.17772727187861
curr_Factors:  [100.17772727]
mat_Sqrt:  [[0.15]]
grads:  [0.04552713]
Stock Position:  0.04552713135359825
Bond Position:  [-5.55798054]


portfolio before change:  [-1.11248349]
curr_Stock_Price:  97.70606232946298
curr_Factors:  [97.70606233]
mat_Sqrt:  [[0.15]]
grads:  [0.00600515]
Stock Position:  0.006005154034940916
Bond Position:  [-1.69922345]


portfolio before change:  [-1.11999912]
curr_Stock_Price:  96.5960491478984
curr_Factors:  [96.59604915]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216057]
Stock Position:  -0.03216056506960379
Bond Position:  [1.98658441]


portfolio before change:  [-1.15402805]
curr_Stock_Price:  97.68503716130125
curr_Factors:  [97.68503716]
mat_Sqrt:  [[0.15]]
grads:  [0.05558294]
Stock Position:  0.0555829443075945
Bond Position:  [-6.58365003]


portfolio before change:  [-1.23601339]
curr_Stock_Price:  96.26926664861921
curr_Factors:  [96.26926665]
mat_Sqrt:  [[0.15]]
grads:  [0.10982821]
Stock Position:  0.10982820674255898
Bond Position:  [-11.80909431]


portfolio before change:  [-0.95676966]
curr_Stock_Price:  98.86559196615637
curr_Factors:  [98.86559197]
mat_Sqrt:  [[0.15]]
grads:  [0.10859472]
Stock Position:  0.10859471663990183
Bond Position:  [-11.6930506]


portfolio before change:  [-0.98344298]
curr_Stock_Price:  98.67382077777597
curr_Factors:  [98.67382078]
mat_Sqrt:  [[0.15]]
grads:  [0.02375788]
Stock Position:  0.02375788432030517
Bond Position:  [-3.3277242]


portfolio before change:  [-0.99649608]
curr_Stock_Price:  98.19445092317106
curr_Factors:  [98.19445092]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.99649608]
Stock Price:  99.05838199694098
PL:  [-0.99649608]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.25472146e-03]
 [ 6.71661819e-03]
 [-1.79394431e-04]
 [-6.35946614e-03]
 [ 1.33245898e-02]
 [ 1.62497211e-02]
 [ 2.48347721e-02]
 [ 1.68537660e-03]
 [-1.39185146e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.55165824]
curr_Stock_Price:  101.90014072356124
curr_Factors:  [101.90014072]
mat_Sqrt:  [[0.15]]
grads:  [-0.00836481]
Stock Position:  -0.008364809720745303
Bond Position:  [31.40403353]


portfolio before change:  [30.55711759]
curr_Stock_Price:  103.12510534844327
curr_Factors:  [103.12510535]
mat_Sqrt:  [[0.15]]
grads:  [0.04477745]
Stock Position:  0.04477745463239438
Bond Position:  [25.93943786]


portfolio before change:  [30.49362342]
curr_Stock_Price:  101.4173903800461
curr_Factors:  [101.41739038]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119596]
Stock Position:  -0.001195962873206175
Bond Position:  [30.61491485]


portfolio before change:  [30.51030164]
curr_Stock_Price:  100.27443357721548
curr_Factors:  [100.27443358]
mat_Sqrt:  [[0.15]]
grads:  [-0.04239644]
Stock Position:  -0.042396440947675786
Bond Position:  [34.76158074]


portfolio before change:  [30.52471348]
curr_Stock_Price:  100.34456430619149
curr_Factors:  [100.34456431]
mat_Sqrt:  [[0.15]]
grads:  [0.0888306]
Stock Position:  0.08883059852758257
Bond Position:  [21.61104578]


portfolio before change:  [30.71991487]
curr_Stock_Price:  102.42034857967543
curr_Factors:  [102.42034858]
mat_Sqrt:  [[0.15]]
grads:  [0.10833147]
Stock Position:  0.10833147402567754
Bond Position:  [19.62456754]


portfolio before change:  [30.67525049]
curr_Stock_Price:  101.91745585829797
curr_Factors:  [101.91745586]
mat_Sqrt:  [[0.15]]
grads:  [0.16556515]
Stock Position:  0.16556514701529446
Bond Position:  [13.80127193]


portfolio before change:  [30.75636408]
curr_Stock_Price:  102.36568560639866
curr_Factors:  [102.36568561]
mat_Sqrt:  [[0.15]]
grads:  [0.01123584]
Stock Position:  0.011235843981483794
Bond Position:  [29.60619921]


portfolio before change:  [30.77951556]
curr_Stock_Price:  103.10836898617491
curr_Factors:  [103.10836899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.77951556]
Stock Price:  103.54536573326142
PL:  [27.23414982]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.44171652e-02]
 [ 4.69815598e-03]
 [ 1.83604143e-03]
 [-5.30289455e-03]
 [ 1.22058453e-02]
 [ 1.59791661e-02]
 [ 2.47246440e-02]
 [ 3.05887984e-03]
 [-2.55442886e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.71445866]
curr_Stock_Price:  99.66844404296037
curr_Factors:  [99.66844404]
mat_Sqrt:  [[0.15]]
grads:  [0.1627811]
Stock Position:  0.16278110137324953
Bond Position:  [-19.93859776]


portfolio before change:  [-3.8279811]
curr_Stock_Price:  99.03230970961229
curr_Factors:  [99.03230971]
mat_Sqrt:  [[0.15]]
grads:  [0.03132104]
Stock Position:  0.03132103987546127
Bond Position:  [-6.92977602]


portfolio before change:  [-3.8256027]
curr_Stock_Price:  99.21889865836152
curr_Factors:  [99.21889866]
mat_Sqrt:  [[0.15]]
grads:  [0.01224028]
Stock Position:  0.01224027621678703
Bond Position:  [-5.04006942]


portfolio before change:  [-3.82441556]
curr_Stock_Price:  99.52181702665389
curr_Factors:  [99.52181703]
mat_Sqrt:  [[0.15]]
grads:  [-0.03535263]
Stock Position:  -0.03535263033091343
Bond Position:  [-0.30605755]


portfolio before change:  [-3.8711322]
curr_Stock_Price:  100.83893474830296
curr_Factors:  [100.83893475]
mat_Sqrt:  [[0.15]]
grads:  [0.0813723]
Stock Position:  0.08137230212927384
Bond Position:  [-12.07662846]


portfolio before change:  [-3.89827211]
curr_Stock_Price:  100.57963169286784
curr_Factors:  [100.57963169]
mat_Sqrt:  [[0.15]]
grads:  [0.10652777]
Stock Position:  0.10652777371123752
Bond Position:  [-14.61279635]


portfolio before change:  [-3.78232804]
curr_Stock_Price:  101.73662854617231
curr_Factors:  [101.73662855]
mat_Sqrt:  [[0.15]]
grads:  [0.16483096]
Stock Position:  0.16483096011595255
Bond Position:  [-20.5516742]


portfolio before change:  [-3.94200573]
curr_Stock_Price:  100.83024971785686
curr_Factors:  [100.83024972]
mat_Sqrt:  [[0.15]]
grads:  [0.02039253]
Stock Position:  0.020392532287414784
Bond Position:  [-5.99818986]


portfolio before change:  [-3.913899]
curr_Stock_Price:  102.35564035530028
curr_Factors:  [102.35564036]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.913899]
Stock Price:  101.00392258272821
PL:  [-4.91782158]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.26363757e-02]
 [ 8.15954546e-04]
 [ 1.53482982e-03]
 [-4.89938305e-03]
 [ 1.24682269e-02]
 [ 1.65307845e-02]
 [ 1.35755976e-02]
 [ 1.14005310e-02]
 [-4.21616649e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.08371002]
curr_Stock_Price:  98.8628547407618
curr_Factors:  [98.86285474]
mat_Sqrt:  [[0.15]]
grads:  [0.0842425]
Stock Position:  0.08424250460694677
Bond Position:  [-24.41216452]


portfolio before change:  [-16.45565502]
curr_Stock_Price:  94.59261296172613
curr_Factors:  [94.59261296]
mat_Sqrt:  [[0.15]]
grads:  [0.0054397]
Stock Position:  0.005439696972848058
Bond Position:  [-16.97021017]


portfolio before change:  [-16.45216624]
curr_Stock_Price:  96.79420676237713
curr_Factors:  [96.79420676]
mat_Sqrt:  [[0.15]]
grads:  [0.0102322]
Stock Position:  0.010232198782646194
Bond Position:  [-17.44258381]


portfolio before change:  [-16.48603948]
curr_Stock_Price:  94.33630229969876
curr_Factors:  [94.3363023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03266255]
Stock Position:  -0.032662553689809935
Bond Position:  [-13.40477495]


portfolio before change:  [-16.52048197]
curr_Stock_Price:  95.18554450230457
curr_Factors:  [95.1855445]
mat_Sqrt:  [[0.15]]
grads:  [0.08312151]
Stock Position:  0.08312151252041876
Bond Position:  [-24.4324484]


portfolio before change:  [-16.49645911]
curr_Stock_Price:  95.62155846065116
curr_Factors:  [95.62155846]
mat_Sqrt:  [[0.15]]
grads:  [0.11020523]
Stock Position:  0.11020523012458618
Bond Position:  [-27.03445496]


portfolio before change:  [-16.44266565]
curr_Stock_Price:  96.23236488715851
curr_Factors:  [96.23236489]
mat_Sqrt:  [[0.15]]
grads:  [0.09050398]
Stock Position:  0.09050398373577243
Bond Position:  [-25.15207804]


portfolio before change:  [-16.56460246]
curr_Stock_Price:  95.0240465569023
curr_Factors:  [95.02404656]
mat_Sqrt:  [[0.15]]
grads:  [0.07600354]
Stock Position:  0.07600353999292711
Bond Position:  [-23.78676638]


portfolio before change:  [-16.59443946]
curr_Stock_Price:  94.78799637155635
curr_Factors:  [94.78799637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.59443946]
Stock Price:  95.22374008034579
PL:  [-16.59443946]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.71642407e-03]
 [ 6.84261905e-03]
 [-2.13595251e-04]
 [-8.69146772e-03]
 [ 1.06281358e-02]
 [ 1.60582192e-02]
 [ 2.16781019e-02]
 [ 3.67407314e-03]
 [-7.55785569e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.72982359]
curr_Stock_Price:  101.97687272376893
curr_Factors:  [101.97687272]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144283]
Stock Position:  -0.011442827142143949
Bond Position:  [32.89672731]


portfolio before change:  [31.76228576]
curr_Stock_Price:  100.57776944471443
curr_Factors:  [100.57776944]
mat_Sqrt:  [[0.15]]
grads:  [0.04561746]
Stock Position:  0.045617460334656815
Bond Position:  [27.17418335]


portfolio before change:  [31.8193962]
curr_Stock_Price:  101.53178899111863
curr_Factors:  [101.53178899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142397]
Stock Position:  -0.001423968340247313
Bond Position:  [31.96397425]


portfolio before change:  [31.83430788]
curr_Stock_Price:  102.28623409271349
curr_Factors:  [102.28623409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05794312]
Stock Position:  -0.05794311811662566
Bond Position:  [37.76109122]


portfolio before change:  [31.85760062]
curr_Stock_Price:  102.21016842829835
curr_Factors:  [102.21016843]
mat_Sqrt:  [[0.15]]
grads:  [0.07085424]
Stock Position:  0.07085423844883315
Bond Position:  [24.61557698]


portfolio before change:  [31.80215979]
curr_Stock_Price:  101.25395602120794
curr_Factors:  [101.25395602]
mat_Sqrt:  [[0.15]]
grads:  [0.10705479]
Stock Position:  0.10705479465598348
Bond Position:  [20.96243832]


portfolio before change:  [31.75445543]
curr_Stock_Price:  100.71041945022469
curr_Factors:  [100.71041945]
mat_Sqrt:  [[0.15]]
grads:  [0.14452068]
Stock Position:  0.14452067923782821
Bond Position:  [17.19971721]


portfolio before change:  [31.64858282]
curr_Stock_Price:  99.91832092255058
curr_Factors:  [99.91832092]
mat_Sqrt:  [[0.15]]
grads:  [0.02449382]
Stock Position:  0.02449382094604102
Bond Position:  [29.20120136]


portfolio before change:  [31.62881455]
curr_Stock_Price:  98.51500668190499
curr_Factors:  [98.51500668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.62881455]
Stock Price:  97.18393275596215
PL:  [31.62881455]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.16330642e-02]
 [ 6.97018084e-03]
 [-1.64917469e-04]
 [-4.74081195e-03]
 [ 8.36329904e-03]
 [ 1.59574496e-02]
 [ 1.59222462e-02]
 [ 3.55807769e-03]
 [-5.77346175e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.5211273]
curr_Stock_Price:  99.81129216130962
curr_Factors:  [99.81129216]
mat_Sqrt:  [[0.15]]
grads:  [0.14422043]
Stock Position:  0.1442204278702104
Bond Position:  [-15.91595456]


portfolio before change:  [-1.25523488]
curr_Stock_Price:  101.71013820961686
curr_Factors:  [101.71013821]
mat_Sqrt:  [[0.15]]
grads:  [0.04646787]
Stock Position:  0.04646787225911627
Bond Position:  [-5.98148859]


portfolio before change:  [-1.2740799]
curr_Stock_Price:  101.36896626794636
curr_Factors:  [101.36896627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00109945]
Stock Position:  -0.0010994497932671665
Bond Position:  [-1.16262981]


portfolio before change:  [-1.2717357]
curr_Stock_Price:  98.70794081723389
curr_Factors:  [98.70794082]
mat_Sqrt:  [[0.15]]
grads:  [-0.03160541]
Stock Position:  -0.03160541297642967
Bond Position:  [1.84796953]


portfolio before change:  [-1.23928866]
curr_Stock_Price:  97.71055398659716
curr_Factors:  [97.71055399]
mat_Sqrt:  [[0.15]]
grads:  [0.05575533]
Stock Position:  0.055755326914344296
Bond Position:  [-6.68717254]


portfolio before change:  [-1.14447078]
curr_Stock_Price:  99.47114450934185
curr_Factors:  [99.47114451]
mat_Sqrt:  [[0.15]]
grads:  [0.106383]
Stock Position:  0.10638299765730587
Bond Position:  [-11.72650932]


portfolio before change:  [-1.22970115]
curr_Stock_Price:  98.72510757672354
curr_Factors:  [98.72510758]
mat_Sqrt:  [[0.15]]
grads:  [0.10614831]
Stock Position:  0.1061483077669812
Bond Position:  [-11.70920425]


portfolio before change:  [-1.06650137]
curr_Stock_Price:  100.31774574110848
curr_Factors:  [100.31774574]
mat_Sqrt:  [[0.15]]
grads:  [0.02372052]
Stock Position:  0.023720517939872718
Bond Position:  [-3.44609026]


portfolio before change:  [-1.07470163]
curr_Stock_Price:  100.0447000552289
curr_Factors:  [100.04470006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.07470163]
Stock Price:  97.52535792577181
PL:  [-1.07470163]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.62330491e-03]
 [ 6.88220678e-03]
 [-4.57250878e-03]
 [-9.72691027e-03]
 [ 3.14134890e-03]
 [ 1.64343859e-02]
 [ 2.33098376e-02]
 [ 1.55107529e-03]
 [-2.61538847e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.51726674]
curr_Stock_Price:  101.44200220123743
curr_Factors:  [101.4420022]
mat_Sqrt:  [[0.15]]
grads:  [0.01082203]
Stock Position:  0.010822032705799558
Bond Position:  [22.41945807]


portfolio before change:  [23.53583262]
curr_Stock_Price:  102.12148174138947
curr_Factors:  [102.12148174]
mat_Sqrt:  [[0.15]]
grads:  [0.04588138]
Stock Position:  0.045881378521355376
Bond Position:  [18.85035826]


portfolio before change:  [23.67676704]
curr_Stock_Price:  104.98771822911087
curr_Factors:  [104.98771823]
mat_Sqrt:  [[0.15]]
grads:  [-0.03048339]
Stock Position:  -0.03048339184438477
Bond Position:  [26.87714879]


portfolio before change:  [23.7464483]
curr_Stock_Price:  103.14280127923894
curr_Factors:  [103.14280128]
mat_Sqrt:  [[0.15]]
grads:  [-0.06484607]
Stock Position:  -0.06484606844898443
Bond Position:  [30.43485345]


portfolio before change:  [23.70499679]
curr_Stock_Price:  104.01675927402215
curr_Factors:  [104.01675927]
mat_Sqrt:  [[0.15]]
grads:  [0.02094233]
Stock Position:  0.020942325979908548
Bond Position:  [21.52664391]


portfolio before change:  [23.70603573]
curr_Stock_Price:  103.55228955186247
curr_Factors:  [103.55228955]
mat_Sqrt:  [[0.15]]
grads:  [0.10956257]
Stock Position:  0.1095625725733472
Bond Position:  [12.36058049]


portfolio before change:  [23.6187752]
curr_Stock_Price:  102.69942202590795
curr_Factors:  [102.69942203]
mat_Sqrt:  [[0.15]]
grads:  [0.15539892]
Stock Position:  0.15539891745037945
Bond Position:  [7.6593962]


portfolio before change:  [23.71473556]
curr_Stock_Price:  103.29228139417675
curr_Factors:  [103.29228139]
mat_Sqrt:  [[0.15]]
grads:  [0.0103405]
Stock Position:  0.010340501962070352
Bond Position:  [22.64664153]


portfolio before change:  [23.7151014]
curr_Stock_Price:  102.23234087928155
curr_Factors:  [102.23234088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.7151014]
Stock Price:  104.24603758796009
PL:  [19.46906381]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-4.21039966e-02]
 [ 2.82589436e-03]
 [ 2.15213218e-03]
 [-4.90878834e-03]
 [ 1.51040930e-02]
 [ 1.65651904e-02]
 [ 1.30118134e-02]
 [ 1.81510884e-02]
 [-2.64409709e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-41.68518351]
curr_Stock_Price:  97.19547224867347
curr_Factors:  [97.19547225]
mat_Sqrt:  [[0.15]]
grads:  [-0.28069331]
Stock Position:  -0.2806933106004914
Bond Position:  [-14.40306463]


portfolio before change:  [-41.66940283]
curr_Stock_Price:  97.11358923354112
curr_Factors:  [97.11358923]
mat_Sqrt:  [[0.15]]
grads:  [0.0188393]
Stock Position:  0.01883929572064369
Bond Position:  [-43.49895445]


portfolio before change:  [-41.71389947]
curr_Stock_Price:  95.90644611900653
curr_Factors:  [95.90644612]
mat_Sqrt:  [[0.15]]
grads:  [0.01434755]
Stock Position:  0.014347547857908021
Bond Position:  [-43.0899218]


portfolio before change:  [-41.74167578]
curr_Stock_Price:  95.47250700155368
curr_Factors:  [95.472507]
mat_Sqrt:  [[0.15]]
grads:  [-0.03272526]
Stock Position:  -0.03272525560849005
Bond Position:  [-38.61731359]


portfolio before change:  [-41.70793471]
curr_Stock_Price:  93.85129557001831
curr_Factors:  [93.85129557]
mat_Sqrt:  [[0.15]]
grads:  [0.10069395]
Stock Position:  0.10069395328979341
Bond Position:  [-51.15819268]


portfolio before change:  [-41.60817614]
curr_Stock_Price:  95.09609780892394
curr_Factors:  [95.09609781]
mat_Sqrt:  [[0.15]]
grads:  [0.1104346]
Stock Position:  0.11043460243577277
Bond Position:  [-52.1100759]


portfolio before change:  [-41.56927778]
curr_Stock_Price:  95.68431844370797
curr_Factors:  [95.68431844]
mat_Sqrt:  [[0.15]]
grads:  [0.08674542]
Stock Position:  0.08674542296172631
Bond Position:  [-49.86945446]


portfolio before change:  [-41.81759283]
curr_Stock_Price:  93.10926517052269
curr_Factors:  [93.10926517]
mat_Sqrt:  [[0.15]]
grads:  [0.12100726]
Stock Position:  0.12100725590929569
Bond Position:  [-53.08448951]


portfolio before change:  [-42.00105437]
curr_Stock_Price:  91.81254406692027
curr_Factors:  [91.81254407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-42.00105437]
Stock Price:  91.33586079904605
PL:  [-42.00105437]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.56732786e-03]
 [ 7.00421645e-03]
 [-7.69342521e-04]
 [-8.97720200e-03]
 [ 9.75245653e-03]
 [ 1.63597784e-02]
 [ 2.06444059e-02]
 [ 3.63288523e-03]
 [-4.76683662e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.65408428]
curr_Stock_Price:  101.45091290578667
curr_Factors:  [101.45091291]
mat_Sqrt:  [[0.15]]
grads:  [0.01044885]
Stock Position:  0.010448852377656984
Bond Position:  [22.59403866]


portfolio before change:  [23.66642988]
curr_Stock_Price:  101.55099665950456
curr_Factors:  [101.55099666]
mat_Sqrt:  [[0.15]]
grads:  [0.04669478]
Stock Position:  0.04669477633162278
Bond Position:  [18.92452881]


portfolio before change:  [23.70727006]
curr_Stock_Price:  102.22292512064509
curr_Factors:  [102.22292512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00512895]
Stock Position:  -0.005128950139549007
Bond Position:  [24.23156635]


portfolio before change:  [23.71785182]
curr_Stock_Price:  102.52260703980103
curr_Factors:  [102.52260704]
mat_Sqrt:  [[0.15]]
grads:  [-0.05984801]
Stock Position:  -0.05984801330678255
Bond Position:  [29.85362617]


portfolio before change:  [23.73908063]
curr_Stock_Price:  102.41736933075518
curr_Factors:  [102.41736933]
mat_Sqrt:  [[0.15]]
grads:  [0.06501638]
Stock Position:  0.0650163768758566
Bond Position:  [17.08027435]


portfolio before change:  [23.78305408]
curr_Stock_Price:  102.96232706412097
curr_Factors:  [102.96232706]
mat_Sqrt:  [[0.15]]
grads:  [0.10906519]
Stock Position:  0.1090651895323505
Bond Position:  [12.55344837]


portfolio before change:  [23.50190337]
curr_Stock_Price:  100.32693982924638
curr_Factors:  [100.32693983]
mat_Sqrt:  [[0.15]]
grads:  [0.13762937]
Stock Position:  0.13762937240673406
Bond Position:  [9.6939696]


portfolio before change:  [23.36313755]
curr_Stock_Price:  99.28345607831278
curr_Factors:  [99.28345608]
mat_Sqrt:  [[0.15]]
grads:  [0.02421923]
Stock Position:  0.024219234875154882
Bond Position:  [20.95856821]


portfolio before change:  [23.40863698]
curr_Stock_Price:  100.72931210032002
curr_Factors:  [100.7293121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.40863698]
Stock Price:  101.88525434043086
PL:  [21.52338264]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.49122967e-03]
 [ 6.90318199e-03]
 [ 9.27610192e-04]
 [-8.38605079e-03]
 [ 8.42358071e-03]
 [ 1.63883901e-02]
 [ 2.48349701e-02]
 [ 3.58689723e-03]
 [-7.50532360e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.33220185]
curr_Stock_Price:  100.64840866576823
curr_Factors:  [100.64840867]
mat_Sqrt:  [[0.15]]
grads:  [0.0366082]
Stock Position:  0.03660819781900885
Bond Position:  [7.647645]


portfolio before change:  [11.3209926]
curr_Stock_Price:  100.23773467470758
curr_Factors:  [100.23773467]
mat_Sqrt:  [[0.15]]
grads:  [0.04602121]
Stock Position:  0.046021213299260746
Bond Position:  [6.70793043]


portfolio before change:  [11.32904265]
curr_Stock_Price:  100.33975833051832
curr_Factors:  [100.33975833]
mat_Sqrt:  [[0.15]]
grads:  [0.00618407]
Stock Position:  0.006184067948021529
Bond Position:  [10.70853477]


portfolio before change:  [11.34486351]
curr_Stock_Price:  102.03204997237005
curr_Factors:  [102.03204997]
mat_Sqrt:  [[0.15]]
grads:  [-0.05590701]
Stock Position:  -0.05590700524567473
Bond Position:  [17.04916986]


portfolio before change:  [11.31426905]
curr_Stock_Price:  102.73180441022
curr_Factors:  [102.73180441]
mat_Sqrt:  [[0.15]]
grads:  [0.0561572]
Stock Position:  0.05615720471088208
Bond Position:  [5.54513808]


portfolio before change:  [11.33790027]
curr_Stock_Price:  103.10322538974182
curr_Factors:  [103.10322539]
mat_Sqrt:  [[0.15]]
grads:  [0.10925593]
Stock Position:  0.10925593379497198
Bond Position:  [0.07326111]


portfolio before change:  [11.20877877]
curr_Stock_Price:  101.9210640081396
curr_Factors:  [101.92106401]
mat_Sqrt:  [[0.15]]
grads:  [0.16556647]
Stock Position:  0.16556646705976638
Bond Position:  [-5.66593172]


portfolio before change:  [10.93126403]
curr_Stock_Price:  100.26202597192763
curr_Factors:  [100.26202597]
mat_Sqrt:  [[0.15]]
grads:  [0.02391265]
Stock Position:  0.023912648223819475
Bond Position:  [8.53373347]


portfolio before change:  [10.8928209]
curr_Stock_Price:  98.47589757567881
curr_Factors:  [98.47589758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.8928209]
Stock Price:  98.42967622786682
PL:  [10.8928209]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.63624273e-02]
 [ 7.06568391e-03]
 [-2.31430508e-04]
 [-6.17942760e-03]
 [ 8.86385935e-03]
 [ 1.61718605e-02]
 [ 1.98210305e-02]
 [ 3.54778089e-03]
 [-5.19374322e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.43688314]
curr_Stock_Price:  99.55626532746842
curr_Factors:  [99.55626533]
mat_Sqrt:  [[0.15]]
grads:  [0.17574952]
Stock Position:  0.17574951503710065
Bond Position:  [-22.93384849]


portfolio before change:  [-5.14829127]
curr_Stock_Price:  101.26359099660422
curr_Factors:  [101.263591]
mat_Sqrt:  [[0.15]]
grads:  [0.04710456]
Stock Position:  0.04710455941672851
Bond Position:  [-9.91826811]


portfolio before change:  [-5.13291045]
curr_Stock_Price:  101.69542167481849
curr_Factors:  [101.69542167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00154287]
Stock Position:  -0.0015428700544033516
Bond Position:  [-4.97600763]


portfolio before change:  [-5.13300972]
curr_Stock_Price:  100.14678010013155
curr_Factors:  [100.1467801]
mat_Sqrt:  [[0.15]]
grads:  [-0.04119618]
Stock Position:  -0.041196184015272294
Bond Position:  [-1.00734454]


portfolio before change:  [-5.0539454]
curr_Stock_Price:  98.2153362320308
curr_Factors:  [98.21533623]
mat_Sqrt:  [[0.15]]
grads:  [0.0590924]
Stock Position:  0.059092395655771894
Bond Position:  [-10.85772491]


portfolio before change:  [-5.04137421]
curr_Stock_Price:  98.51996790305621
curr_Factors:  [98.5199679]
mat_Sqrt:  [[0.15]]
grads:  [0.1078124]
Stock Position:  0.10781240314875039
Bond Position:  [-15.66304871]


portfolio before change:  [-4.89042995]
curr_Stock_Price:  99.99269025397386
curr_Factors:  [99.99269025]
mat_Sqrt:  [[0.15]]
grads:  [0.1321402]
Stock Position:  0.1321402031171581
Bond Position:  [-18.10348435]


portfolio before change:  [-5.10006746]
curr_Stock_Price:  98.47473054887337
curr_Factors:  [98.47473055]
mat_Sqrt:  [[0.15]]
grads:  [0.02365187]
Stock Position:  0.02365187262427293
Bond Position:  [-7.42917925]


portfolio before change:  [-5.1472191]
curr_Stock_Price:  96.6382537044944
curr_Factors:  [96.6382537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.1472191]
Stock Price:  96.39305721141504
PL:  [-5.1472191]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.15149890e-02]
 [ 6.66028054e-03]
 [ 1.33183248e-03]
 [-4.73295479e-03]
 [ 9.15627170e-03]
 [ 1.63187822e-02]
 [ 1.36268189e-02]
 [ 8.43810131e-03]
 [-3.42245687e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.02988131]
curr_Stock_Price:  100.1728203592097
curr_Factors:  [100.17282036]
mat_Sqrt:  [[0.15]]
grads:  [0.07676659]
Stock Position:  0.07676659310755568
Bond Position:  [-3.66004483]


portfolio before change:  [4.02050842]
curr_Stock_Price:  100.07456906134756
curr_Factors:  [100.07456906]
mat_Sqrt:  [[0.15]]
grads:  [0.04440187]
Stock Position:  0.044401870251289624
Bond Position:  [-0.42298962]


portfolio before change:  [3.97207996]
curr_Stock_Price:  98.98864845509571
curr_Factors:  [98.98864846]
mat_Sqrt:  [[0.15]]
grads:  [0.00887888]
Stock Position:  0.008878883210863778
Bond Position:  [3.09317131]


portfolio before change:  [3.96311598]
curr_Stock_Price:  97.80483351122136
curr_Factors:  [97.80483351]
mat_Sqrt:  [[0.15]]
grads:  [-0.03155303]
Stock Position:  -0.031553031924770075
Bond Position:  [7.04915501]


portfolio before change:  [3.94278]
curr_Stock_Price:  98.5610662173816
curr_Factors:  [98.56106622]
mat_Sqrt:  [[0.15]]
grads:  [0.06104181]
Stock Position:  0.06104181135435366
Bond Position:  [-2.07356601]


portfolio before change:  [3.89714239]
curr_Stock_Price:  97.83041015858652
curr_Factors:  [97.83041016]
mat_Sqrt:  [[0.15]]
grads:  [0.10879188]
Stock Position:  0.10879188159980245
Bond Position:  [-6.74601201]


portfolio before change:  [3.8732378]
curr_Stock_Price:  97.64169441756438
curr_Factors:  [97.64169442]
mat_Sqrt:  [[0.15]]
grads:  [0.09084546]
Stock Position:  0.09084545930188748
Bond Position:  [-4.99706677]


portfolio before change:  [3.70927348]
curr_Stock_Price:  95.86433349942104
curr_Factors:  [95.8643335]
mat_Sqrt:  [[0.15]]
grads:  [0.05625401]
Stock Position:  0.056254008731372505
Bond Position:  [-1.68347958]


portfolio before change:  [3.56337552]
curr_Stock_Price:  93.28574390551454
curr_Factors:  [93.28574391]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.56337552]
Stock Price:  93.7744804248747
PL:  [3.56337552]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-9.44206886e-04]
 [ 3.78498529e-03]
 [-2.33565796e-04]
 [-9.63438198e-03]
 [ 9.86190128e-03]
 [ 1.61961884e-02]
 [ 2.28988179e-02]
 [ 2.24275693e-03]
 [-5.21126251e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.64371166]
curr_Stock_Price:  98.50074084175998
curr_Factors:  [98.50074084]
mat_Sqrt:  [[0.15]]
grads:  [-0.00629471]
Stock Position:  -0.006294712571422445
Bond Position:  [-21.02367781]


portfolio before change:  [-21.6528971]
curr_Stock_Price:  98.28960712470825
curr_Factors:  [98.28960712]
mat_Sqrt:  [[0.15]]
grads:  [0.02523324]
Stock Position:  0.025233235294863567
Bond Position:  [-24.13306189]


portfolio before change:  [-21.57949942]
curr_Stock_Price:  101.67669688388794
curr_Factors:  [101.67669688]
mat_Sqrt:  [[0.15]]
grads:  [-0.00155711]
Stock Position:  -0.0015571053051606687
Bond Position:  [-21.42117809]


portfolio before change:  [-21.59237638]
curr_Stock_Price:  103.06625749426324
curr_Factors:  [103.06625749]
mat_Sqrt:  [[0.15]]
grads:  [-0.06422921]
Stock Position:  -0.06422921322238946
Bond Position:  [-14.97251175]


portfolio before change:  [-21.55652361]
curr_Stock_Price:  102.39147280325122
curr_Factors:  [102.3914728]
mat_Sqrt:  [[0.15]]
grads:  [0.06574601]
Stock Position:  0.06574600855697554
Bond Position:  [-28.28835426]


portfolio before change:  [-21.58610497]
curr_Stock_Price:  102.15672633319987
curr_Factors:  [102.15672633]
mat_Sqrt:  [[0.15]]
grads:  [0.10797459]
Stock Position:  0.10797458950775991
Bond Position:  [-32.61643556]


portfolio before change:  [-21.52462257]
curr_Stock_Price:  102.87721713055534
curr_Factors:  [102.87721713]
mat_Sqrt:  [[0.15]]
grads:  [0.15265879]
Stock Position:  0.15265878625784612
Bond Position:  [-37.22973367]


portfolio before change:  [-21.73347086]
curr_Stock_Price:  101.63111279923885
curr_Factors:  [101.6311128]
mat_Sqrt:  [[0.15]]
grads:  [0.01495171]
Stock Position:  0.014951712845504388
Bond Position:  [-23.25303008]


portfolio before change:  [-21.76356305]
curr_Stock_Price:  100.3962870060593
curr_Factors:  [100.39628701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.76356305]
Stock Price:  98.68165151948578
PL:  [-21.76356305]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.04337029e-03]
 [ 5.96542852e-03]
 [-9.00148429e-03]
 [-1.37238758e-02]
 [-4.05991891e-03]
 [ 1.64217799e-02]
 [ 1.55380537e-02]
 [ 1.28493106e-03]
 [-2.58975114e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.94312538]
curr_Stock_Price:  102.57692014353947
curr_Factors:  [102.57692014]
mat_Sqrt:  [[0.15]]
grads:  [-0.02028914]
Stock Position:  -0.020289135297959737
Bond Position:  [43.02432239]


portfolio before change:  [40.87850309]
curr_Stock_Price:  106.8225337327166
curr_Factors:  [106.82253373]
mat_Sqrt:  [[0.15]]
grads:  [0.03976952]
Stock Position:  0.03976952345415717
Bond Position:  [36.63022183]


portfolio before change:  [40.96517294]
curr_Stock_Price:  108.54119040217638
curr_Factors:  [108.5411904]
mat_Sqrt:  [[0.15]]
grads:  [-0.0600099]
Stock Position:  -0.060009895261315754
Bond Position:  [47.47871841]


portfolio before change:  [41.10280985]
curr_Stock_Price:  106.64330977987053
curr_Factors:  [106.64330978]
mat_Sqrt:  [[0.15]]
grads:  [-0.09149251]
Stock Position:  -0.09149250527893538
Bond Position:  [50.85987344]


portfolio before change:  [40.96471147]
curr_Stock_Price:  108.43072044342759
curr_Factors:  [108.43072044]
mat_Sqrt:  [[0.15]]
grads:  [-0.02706613]
Stock Position:  -0.027066126033535802
Bond Position:  [43.89951101]


portfolio before change:  [41.05676849]
curr_Stock_Price:  105.84070162539777
curr_Factors:  [105.84070163]
mat_Sqrt:  [[0.15]]
grads:  [0.10947853]
Stock Position:  0.10947853238875196
Bond Position:  [29.46948381]


portfolio before change:  [41.0070253]
curr_Stock_Price:  105.25171295679223
curr_Factors:  [105.25171296]
mat_Sqrt:  [[0.15]]
grads:  [0.10358702]
Stock Position:  0.1035870245732117
Bond Position:  [30.10431352]


portfolio before change:  [41.01709832]
curr_Stock_Price:  105.20360942632162
curr_Factors:  [105.20360943]
mat_Sqrt:  [[0.15]]
grads:  [0.00856621]
Stock Position:  0.008566207034715017
Bond Position:  [40.11590242]


portfolio before change:  [41.01183967]
curr_Stock_Price:  102.24762066071425
curr_Factors:  [102.24762066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [41.01183967]
Stock Price:  101.35609460630634
PL:  [39.65574507]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.63097808e-03]
 [ 6.86306222e-03]
 [-1.14979488e-04]
 [-7.82121809e-03]
 [ 1.34026293e-02]
 [ 1.62288473e-02]
 [ 2.05207321e-02]
 [ 1.54851477e-03]
 [-2.58227754e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.16599613]
curr_Stock_Price:  100.96322585589176
curr_Factors:  [100.96322586]
mat_Sqrt:  [[0.15]]
grads:  [0.03087319]
Stock Position:  0.030873187210575297
Bond Position:  [13.04893956]


portfolio before change:  [16.15322131]
curr_Stock_Price:  100.33805825222312
curr_Factors:  [100.33805825]
mat_Sqrt:  [[0.15]]
grads:  [0.04575375]
Stock Position:  0.04575374812365277
Bond Position:  [11.56237907]


portfolio before change:  [16.19852924]
curr_Stock_Price:  101.20192829379643
curr_Factors:  [101.20192829]
mat_Sqrt:  [[0.15]]
grads:  [-0.00076653]
Stock Position:  -0.0007665299181689472
Bond Position:  [16.27610355]


portfolio before change:  [16.20640395]
curr_Stock_Price:  101.54813719555082
curr_Factors:  [101.5481372]
mat_Sqrt:  [[0.15]]
grads:  [-0.05214145]
Stock Position:  -0.05214145395765934
Bond Position:  [21.50127147]


portfolio before change:  [16.31099351]
curr_Stock_Price:  99.74848976408282
curr_Factors:  [99.74848976]
mat_Sqrt:  [[0.15]]
grads:  [0.08935086]
Stock Position:  0.08935086196369872
Bond Position:  [7.39837997]


portfolio before change:  [16.54424186]
curr_Stock_Price:  102.31755554991054
curr_Factors:  [102.31755555]
mat_Sqrt:  [[0.15]]
grads:  [0.10819232]
Stock Position:  0.10819231566039013
Bond Position:  [5.4742686]


portfolio before change:  [16.69234259]
curr_Stock_Price:  103.6611159016911
curr_Factors:  [103.6611159]
mat_Sqrt:  [[0.15]]
grads:  [0.13680488]
Stock Position:  0.13680488085606834
Bond Position:  [2.51099598]


portfolio before change:  [16.64565568]
curr_Stock_Price:  103.31066991960857
curr_Factors:  [103.31066992]
mat_Sqrt:  [[0.15]]
grads:  [0.01032343]
Stock Position:  0.010323431806217209
Bond Position:  [15.57913502]


portfolio before change:  [16.64251886]
curr_Stock_Price:  102.25207490753337
curr_Factors:  [102.25207491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.64251886]
Stock Price:  102.17727766795015
PL:  [14.46524119]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.09971112e-02]
 [ 3.26445166e-03]
 [ 1.45954559e-03]
 [-7.83174297e-03]
 [ 1.12985277e-02]
 [ 1.63610387e-02]
 [ 2.22614392e-02]
 [ 1.67234403e-03]
 [-2.72625964e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-35.30569111]
curr_Stock_Price:  97.6109582532258
curr_Factors:  [97.61095825]
mat_Sqrt:  [[0.15]]
grads:  [-0.20664741]
Stock Position:  -0.2066474078820486
Bond Position:  [-15.13463961]


portfolio before change:  [-35.3241493]
curr_Stock_Price:  97.663651745582
curr_Factors:  [97.66365175]
mat_Sqrt:  [[0.15]]
grads:  [0.02176301]
Stock Position:  0.02176301104075886
Bond Position:  [-37.44960443]


portfolio before change:  [-35.29013584]
curr_Stock_Price:  100.08716505205943
curr_Factors:  [100.08716505]
mat_Sqrt:  [[0.15]]
grads:  [0.0097303]
Stock Position:  0.009730303904765696
Bond Position:  [-36.26401437]


portfolio before change:  [-35.29396894]
curr_Stock_Price:  101.55715424173735
curr_Factors:  [101.55715424]
mat_Sqrt:  [[0.15]]
grads:  [-0.05221162]
Stock Position:  -0.05221161980470509
Bond Position:  [-29.99150541]


portfolio before change:  [-35.18721149]
curr_Stock_Price:  99.22516477921506
curr_Factors:  [99.22516478]
mat_Sqrt:  [[0.15]]
grads:  [0.07532352]
Stock Position:  0.0753235177957506
Bond Position:  [-42.66119996]


portfolio before change:  [-35.34607847]
curr_Stock_Price:  97.39929351763786
curr_Factors:  [97.39929352]
mat_Sqrt:  [[0.15]]
grads:  [0.10907359]
Stock Position:  0.10907359141139854
Bond Position:  [-45.96976922]


portfolio before change:  [-34.98890503]
curr_Stock_Price:  100.8846841404157
curr_Factors:  [100.88468414]
mat_Sqrt:  [[0.15]]
grads:  [0.14840959]
Stock Position:  0.14840959433358816
Bond Position:  [-49.96116008]


portfolio before change:  [-34.78583086]
curr_Stock_Price:  102.42138393718662
curr_Factors:  [102.42138394]
mat_Sqrt:  [[0.15]]
grads:  [0.01114896]
Stock Position:  0.011148960224700579
Bond Position:  [-35.9277228]


portfolio before change:  [-34.8002861]
curr_Stock_Price:  102.73649132335863
curr_Factors:  [102.73649132]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.8002861]
Stock Price:  104.513285141003
PL:  [-39.31357124]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-9.51916541e-03]
 [ 2.88618291e-03]
 [ 6.41565279e-04]
 [-5.83124303e-03]
 [ 1.11742286e-02]
 [ 1.64311300e-02]
 [ 1.03435277e-02]
 [ 2.95588467e-03]
 [ 1.01398417e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.15436985]
curr_Stock_Price:  98.2720973614
curr_Factors:  [98.27209736]
mat_Sqrt:  [[0.15]]
grads:  [-0.0634611]
Stock Position:  -0.06346110274542904
Bond Position:  [-18.91791418]


portfolio before change:  [-25.09510972]
curr_Stock_Price:  97.18920642634157
curr_Factors:  [97.18920643]
mat_Sqrt:  [[0.15]]
grads:  [0.01924122]
Stock Position:  0.019241219393344736
Bond Position:  [-26.96514856]


portfolio before change:  [-25.09147809]
curr_Stock_Price:  98.07883671135885
curr_Factors:  [98.07883671]
mat_Sqrt:  [[0.15]]
grads:  [0.0042771]
Stock Position:  0.004277101863139521
Bond Position:  [-25.51097127]


portfolio before change:  [-25.09644421]
curr_Stock_Price:  99.90076130724579
curr_Factors:  [99.90076131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03887495]
Stock Position:  -0.038874953564386194
Bond Position:  [-21.21280675]


portfolio before change:  [-25.19180813]
curr_Stock_Price:  102.0809533820281
curr_Factors:  [102.08095338]
mat_Sqrt:  [[0.15]]
grads:  [0.07449486]
Stock Position:  0.07449485750177616
Bond Position:  [-32.79631421]


portfolio before change:  [-25.05457319]
curr_Stock_Price:  104.14333998070842
curr_Factors:  [104.14333998]
mat_Sqrt:  [[0.15]]
grads:  [0.10954087]
Stock Position:  0.1095408666980288
Bond Position:  [-36.46252492]


portfolio before change:  [-24.76982247]
curr_Stock_Price:  106.90930808812305
curr_Factors:  [106.90930809]
mat_Sqrt:  [[0.15]]
grads:  [0.06895685]
Stock Position:  0.06895685107298144
Bond Position:  [-32.14195171]


portfolio before change:  [-24.78757068]
curr_Stock_Price:  106.88504337463729
curr_Factors:  [106.88504337]
mat_Sqrt:  [[0.15]]
grads:  [0.0197059]
Stock Position:  0.019705897812053796
Bond Position:  [-26.89383643]


portfolio before change:  [-24.82280754]
curr_Stock_Price:  105.77945668990975
curr_Factors:  [105.77945669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.82280754]
Stock Price:  106.41789657486558
PL:  [-31.24070412]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.99251675e-03]
 [ 6.89106870e-03]
 [ 1.65873264e-03]
 [-6.22638573e-03]
 [ 9.33926898e-03]
 [ 1.59536916e-02]
 [ 1.90002189e-02]
 [ 3.55850340e-03]
 [-6.50279808e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.70781347]
curr_Stock_Price:  102.7569798000656
curr_Factors:  [102.7569798]
mat_Sqrt:  [[0.15]]
grads:  [-0.01995011]
Stock Position:  -0.019950111673800223
Bond Position:  [45.7578267]


portfolio before change:  [43.74420302]
curr_Stock_Price:  102.08004572247614
curr_Factors:  [102.08004572]
mat_Sqrt:  [[0.15]]
grads:  [0.04594046]
Stock Position:  0.045940458010233394
Bond Position:  [39.05459897]


portfolio before change:  [43.66810054]
curr_Stock_Price:  99.99833684034951
curr_Factors:  [99.99833684]
mat_Sqrt:  [[0.15]]
grads:  [0.01105822]
Stock Position:  0.01105821759525006
Bond Position:  [42.56229717]


portfolio before change:  [43.69139671]
curr_Stock_Price:  100.1800750179957
curr_Factors:  [100.18007502]
mat_Sqrt:  [[0.15]]
grads:  [-0.04150924]
Stock Position:  -0.041509238206142364
Bond Position:  [47.84979531]


portfolio before change:  [43.77471548]
curr_Stock_Price:  98.74936013138819
curr_Factors:  [98.74936013]
mat_Sqrt:  [[0.15]]
grads:  [0.06226179]
Stock Position:  0.062261793186997004
Bond Position:  [37.62640324]


portfolio before change:  [43.89455398]
curr_Stock_Price:  100.37187365675493
curr_Factors:  [100.37187366]
mat_Sqrt:  [[0.15]]
grads:  [0.10635794]
Stock Position:  0.10635794426194885
Bond Position:  [33.21920784]


portfolio before change:  [43.8370197]
curr_Stock_Price:  99.67471800117796
curr_Factors:  [99.674718]
mat_Sqrt:  [[0.15]]
grads:  [0.12666813]
Stock Position:  0.1266681256744615
Bond Position:  [31.21140999]


portfolio before change:  [43.71763383]
curr_Stock_Price:  98.60897651273305
curr_Factors:  [98.60897651]
mat_Sqrt:  [[0.15]]
grads:  [0.02372336]
Stock Position:  0.023723356003405565
Bond Position:  [41.37829797]


portfolio before change:  [43.71684845]
curr_Stock_Price:  97.70355220971844
curr_Factors:  [97.70355221]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.71684845]
Stock Price:  97.70121061494073
PL:  [43.71684845]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.86792866e-02]
 [ 2.81151513e-03]
 [ 2.16450685e-03]
 [-4.76362972e-03]
 [ 8.22652919e-03]
 [ 1.61626608e-02]
 [ 1.82289353e-02]
 [ 3.67206975e-03]
 [-3.79194332e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.10724877]
curr_Stock_Price:  99.38234873997969
curr_Factors:  [99.38234874]
mat_Sqrt:  [[0.15]]
grads:  [0.19119524]
Stock Position:  0.19119524385394443
Bond Position:  [-27.10868117]


portfolio before change:  [-8.55803077]
curr_Stock_Price:  97.09555402468368
curr_Factors:  [97.09555402]
mat_Sqrt:  [[0.15]]
grads:  [0.01874343]
Stock Position:  0.018743434222570805
Bond Position:  [-10.3779349]


portfolio before change:  [-8.58584257]
curr_Stock_Price:  95.88864973720482
curr_Factors:  [95.88864974]
mat_Sqrt:  [[0.15]]
grads:  [0.01443005]
Stock Position:  0.01443004568425091
Bond Position:  [-9.96952016]


portfolio before change:  [-8.56904932]
curr_Stock_Price:  97.39794900870915
curr_Factors:  [97.39794901]
mat_Sqrt:  [[0.15]]
grads:  [-0.03175753]
Stock Position:  -0.031757531444201174
Bond Position:  [-5.47593089]


portfolio before change:  [-8.57742926]
curr_Stock_Price:  97.57558552104746
curr_Factors:  [97.57558552]
mat_Sqrt:  [[0.15]]
grads:  [0.05484353]
Stock Position:  0.05484352790915232
Bond Position:  [-13.92881861]


portfolio before change:  [-8.53076832]
curr_Stock_Price:  98.55340545334475
curr_Factors:  [98.55340545]
mat_Sqrt:  [[0.15]]
grads:  [0.10775107]
Stock Position:  0.10775107192815789
Bond Position:  [-19.1500034]


portfolio before change:  [-8.43814047]
curr_Stock_Price:  99.5019365452933
curr_Factors:  [99.50193655]
mat_Sqrt:  [[0.15]]
grads:  [0.12152624]
Stock Position:  0.12152623527958012
Bond Position:  [-20.53023622]


portfolio before change:  [-8.4031814]
curr_Stock_Price:  99.87409288016134
curr_Factors:  [99.87409288]
mat_Sqrt:  [[0.15]]
grads:  [0.02448047]
Stock Position:  0.02448046500276257
Bond Position:  [-10.84814564]


portfolio before change:  [-8.36532044]
curr_Stock_Price:  101.64229408211308
curr_Factors:  [101.64229408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.36532044]
Stock Price:  101.73281573638636
PL:  [-10.09813618]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 8.53827675e-03]
 [ 5.34748570e-03]
 [ 9.60655213e-04]
 [-4.72873016e-03]
 [ 8.78837825e-03]
 [ 1.63470601e-02]
 [ 1.31797903e-02]
 [ 7.02570224e-03]
 [-4.65355593e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.76150526]
curr_Stock_Price:  98.75358265492655
curr_Factors:  [98.75358265]
mat_Sqrt:  [[0.15]]
grads:  [0.05692185]
Stock Position:  0.056921845018701483
Bond Position:  [-23.38274139]


portfolio before change:  [-17.74077413]
curr_Stock_Price:  99.32323091660018
curr_Factors:  [99.32323092]
mat_Sqrt:  [[0.15]]
grads:  [0.0356499]
Stock Position:  0.035649904661103245
Bond Position:  [-21.28163784]


portfolio before change:  [-17.77620009]
curr_Stock_Price:  98.6280682809999
curr_Factors:  [98.62806828]
mat_Sqrt:  [[0.15]]
grads:  [0.00640437]
Stock Position:  0.00640436808480584
Bond Position:  [-18.40785054]


portfolio before change:  [-17.79031973]
curr_Stock_Price:  97.86087061211987
curr_Factors:  [97.86087061]
mat_Sqrt:  [[0.15]]
grads:  [-0.03152487]
Stock Position:  -0.03152486776483451
Bond Position:  [-14.70526873]


portfolio before change:  [-17.7744033]
curr_Stock_Price:  97.12269442439879
curr_Factors:  [97.12269442]
mat_Sqrt:  [[0.15]]
grads:  [0.05858919]
Stock Position:  0.05858918833767532
Bond Position:  [-23.46474313]


portfolio before change:  [-17.76175666]
curr_Stock_Price:  97.53884533879913
curr_Factors:  [97.53884534]
mat_Sqrt:  [[0.15]]
grads:  [0.1089804]
Stock Position:  0.10898040075670984
Bond Position:  [-28.39157911]


portfolio before change:  [-17.96340978]
curr_Stock_Price:  95.81877658474765
curr_Factors:  [95.81877658]
mat_Sqrt:  [[0.15]]
grads:  [0.08786527]
Stock Position:  0.08786526872650065
Bond Position:  [-26.38255233]


portfolio before change:  [-17.93740055]
curr_Stock_Price:  96.26495752094836
curr_Factors:  [96.26495752]
mat_Sqrt:  [[0.15]]
grads:  [0.04683801]
Stock Position:  0.04683801493576838
Bond Position:  [-22.44626007]


portfolio before change:  [-17.97902975]
curr_Stock_Price:  95.61584239629121
curr_Factors:  [95.6158424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.97902975]
Stock Price:  99.78546933624449
PL:  [-17.97902975]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.09139580e-02]
 [ 6.99281773e-03]
 [-1.13918822e-04]
 [-6.31462011e-03]
 [ 1.32456483e-02]
 [ 1.62059073e-02]
 [ 1.57430791e-02]
 [ 1.27282093e-03]
 [ 1.88619087e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.95461118]
curr_Stock_Price:  99.84818843841741
curr_Factors:  [99.84818844]
mat_Sqrt:  [[0.15]]
grads:  [0.13942639]
Stock Position:  0.1394263867530503
Bond Position:  [-14.87608332]


portfolio before change:  [-0.71720362]
curr_Stock_Price:  101.60429405502421
curr_Factors:  [101.60429406]
mat_Sqrt:  [[0.15]]
grads:  [0.04661878]
Stock Position:  0.04661878488822622
Bond Position:  [-5.45387235]


portfolio before change:  [-0.73885444]
curr_Stock_Price:  101.1983804637831
curr_Factors:  [101.19838046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075946]
Stock Position:  -0.0007594588127457003
Bond Position:  [-0.66199843]


portfolio before change:  [-0.73845967]
curr_Stock_Price:  100.2426362111331
curr_Factors:  [100.24263621]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209747]
Stock Position:  -0.04209746743011591
Bond Position:  [3.48150144]


portfolio before change:  [-0.71379159]
curr_Stock_Price:  99.69802171885541
curr_Factors:  [99.69802172]
mat_Sqrt:  [[0.15]]
grads:  [0.08830432]
Stock Position:  0.08830432231947558
Bond Position:  [-9.51755784]


portfolio before change:  [-0.497211]
curr_Stock_Price:  102.20458715249512
curr_Factors:  [102.20458715]
mat_Sqrt:  [[0.15]]
grads:  [0.10803938]
Stock Position:  0.10803938216334831
Bond Position:  [-11.53933145]


portfolio before change:  [-0.18084094]
curr_Stock_Price:  105.18628849226289
curr_Factors:  [105.18628849]
mat_Sqrt:  [[0.15]]
grads:  [0.10495386]
Stock Position:  0.10495386048807806
Bond Position:  [-11.22054799]


portfolio before change:  [-0.17550694]
curr_Stock_Price:  105.29057888163868
curr_Factors:  [105.29057888]
mat_Sqrt:  [[0.15]]
grads:  [0.00848547]
Stock Position:  0.00848547287458724
Bond Position:  [-1.06894729]


portfolio before change:  [-0.18680684]
curr_Stock_Price:  104.02190558638104
curr_Factors:  [104.02190559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.18680684]
Stock Price:  102.84880689371771
PL:  [-3.03561373]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.33987768e-03]
 [ 6.81694289e-03]
 [ 2.03771782e-03]
 [-5.16882552e-03]
 [ 1.01981480e-02]
 [ 1.63143291e-02]
 [ 1.35953168e-02]
 [ 3.52447978e-03]
 [-6.14092990e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.92512841]
curr_Stock_Price:  100.49163987210683
curr_Factors:  [100.49163987]
mat_Sqrt:  [[0.15]]
grads:  [0.04226585]
Stock Position:  0.04226585118903041
Bond Position:  [4.67776371]


portfolio before change:  [8.92886759]
curr_Stock_Price:  100.52475682661279
curr_Factors:  [100.52475683]
mat_Sqrt:  [[0.15]]
grads:  [0.04544629]
Stock Position:  0.045446285924639944
Bond Position:  [4.36039075]


portfolio before change:  [8.89831978]
curr_Stock_Price:  99.80459779514095
curr_Factors:  [99.8045978]
mat_Sqrt:  [[0.15]]
grads:  [0.01358479]
Stock Position:  0.013584785435336626
Bond Position:  [7.54249573]


portfolio before change:  [8.89592299]
curr_Stock_Price:  99.35048828312455
curr_Factors:  [99.35048828]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445884]
Stock Position:  -0.03445883676905677
Bond Position:  [12.31942525]


portfolio before change:  [9.00600702]
curr_Stock_Price:  96.33463561726202
curr_Factors:  [96.33463562]
mat_Sqrt:  [[0.15]]
grads:  [0.06798765]
Stock Position:  0.06798765326253285
Bond Position:  [2.45644122]


portfolio before change:  [9.11238872]
curr_Stock_Price:  97.88128659762677
curr_Factors:  [97.8812866]
mat_Sqrt:  [[0.15]]
grads:  [0.10876219]
Stock Position:  0.10876219391311788
Bond Position:  [-1.53339476]


portfolio before change:  [8.99129195]
curr_Stock_Price:  96.77492900242335
curr_Factors:  [96.774929]
mat_Sqrt:  [[0.15]]
grads:  [0.09063545]
Stock Position:  0.09063544510404464
Bond Position:  [0.22005318]


portfolio before change:  [9.11902317]
curr_Stock_Price:  98.18300026397453
curr_Factors:  [98.18300026]
mat_Sqrt:  [[0.15]]
grads:  [0.02349653]
Stock Position:  0.023496531890292317
Bond Position:  [6.81206317]


portfolio before change:  [9.10459698]
curr_Stock_Price:  97.42403408905939
curr_Factors:  [97.42403409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.10459698]
Stock Price:  96.04775286897338
PL:  [9.10459698]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.92342821e-03]
 [ 6.89529005e-03]
 [-2.26765373e-04]
 [-6.95554975e-03]
 [ 3.85830499e-03]
 [ 1.64243718e-02]
 [ 2.32582356e-02]
 [ 1.62663382e-03]
 [-2.30302671e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.07924551]
curr_Stock_Price:  100.82731916883654
curr_Factors:  [100.82731917]
mat_Sqrt:  [[0.15]]
grads:  [0.03282285]
Stock Position:  0.03282285474241383
Bond Position:  [10.76980506]


portfolio before change:  [14.06497805]
curr_Stock_Price:  100.22853789217329
curr_Factors:  [100.22853789]
mat_Sqrt:  [[0.15]]
grads:  [0.0459686]
Stock Position:  0.0459686003576695
Bond Position:  [9.45761245]


portfolio before change:  [14.13164172]
curr_Stock_Price:  101.57584184212631
curr_Factors:  [101.57584184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151177]
Stock Position:  -0.0015117691515887906
Bond Position:  [14.28520094]


portfolio before change:  [14.13994919]
curr_Stock_Price:  100.8064875386127
curr_Factors:  [100.80648754]
mat_Sqrt:  [[0.15]]
grads:  [-0.04637033]
Stock Position:  -0.04637033165066802
Bond Position:  [18.81437945]


portfolio before change:  [14.00993319]
curr_Stock_Price:  103.81327085839519
curr_Factors:  [103.81327086]
mat_Sqrt:  [[0.15]]
grads:  [0.02572203]
Stock Position:  0.025722033257949268
Bond Position:  [11.33964478]


portfolio before change:  [14.05565119]
curr_Stock_Price:  105.37017584633709
curr_Factors:  [105.37017585]
mat_Sqrt:  [[0.15]]
grads:  [0.10949581]
Stock Position:  0.109495812088412
Bond Position:  [2.51805822]


portfolio before change:  [13.76713917]
curr_Stock_Price:  102.72376078494291
curr_Factors:  [102.72376078]
mat_Sqrt:  [[0.15]]
grads:  [0.1550549]
Stock Position:  0.15505490386283624
Bond Position:  [-2.16068368]


portfolio before change:  [13.77007345]
curr_Stock_Price:  102.74965411926163
curr_Factors:  [102.74965412]
mat_Sqrt:  [[0.15]]
grads:  [0.01084423]
Stock Position:  0.01084422544916125
Bond Position:  [12.65583303]


portfolio before change:  [13.77753926]
curr_Stock_Price:  102.8544393974721
curr_Factors:  [102.8544394]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.77753926]
Stock Price:  101.60616635179437
PL:  [12.17137291]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [ 0.006984  ]
 [ 0.00708254]
 [-0.00276282]
 [-0.00766868]
 [ 0.01215085]
 [ 0.01643033]
 [ 0.0239157 ]
 [ 0.00293341]
 [-0.00685808]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.01017398]
curr_Stock_Price:  100.43205037225864
curr_Factors:  [100.43205037]
mat_Sqrt:  [[0.15]]
grads:  [0.04655999]
Stock Position:  0.04655999264334884
Bond Position:  [3.33405845]


portfolio before change:  [8.04516747]
curr_Stock_Price:  101.14781601785265
curr_Factors:  [101.14781602]
mat_Sqrt:  [[0.15]]
grads:  [0.04721691]
Stock Position:  0.04721690914459219
Bond Position:  [3.26928023]


portfolio before change:  [8.16254287]
curr_Stock_Price:  103.59906395758762
curr_Factors:  [103.59906396]
mat_Sqrt:  [[0.15]]
grads:  [-0.01841881]
Stock Position:  -0.018418806205311212
Bond Position:  [10.07071395]


portfolio before change:  [8.20776212]
curr_Stock_Price:  101.41745480557343
curr_Factors:  [101.41745481]
mat_Sqrt:  [[0.15]]
grads:  [-0.05112455]
Stock Position:  -0.05112455325680403
Bond Position:  [13.39268419]


portfolio before change:  [8.24199082]
curr_Stock_Price:  100.87895267099775
curr_Factors:  [100.87895267]
mat_Sqrt:  [[0.15]]
grads:  [0.08100564]
Stock Position:  0.08100563833322472
Bond Position:  [0.07022686]


portfolio before change:  [8.51820372]
curr_Stock_Price:  104.28831752344789
curr_Factors:  [104.28831752]
mat_Sqrt:  [[0.15]]
grads:  [0.10953554]
Stock Position:  0.10953554250856357
Bond Position:  [-2.90507372]


portfolio before change:  [8.31140914]
curr_Stock_Price:  102.4136595322858
curr_Factors:  [102.41365953]
mat_Sqrt:  [[0.15]]
grads:  [0.159438]
Stock Position:  0.15943799686585197
Bond Position:  [-8.01721959]


portfolio before change:  [8.07457389]
curr_Stock_Price:  100.95337003473688
curr_Factors:  [100.95337003]
mat_Sqrt:  [[0.15]]
grads:  [0.01955609]
Stock Position:  0.01955609041695295
Bond Position:  [6.10032066]


portfolio before change:  [8.01943792]
curr_Stock_Price:  97.9779849812918
curr_Factors:  [97.97798498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.01943792]
Stock Price:  98.04965719905606
PL:  [8.01943792]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.75271514e-03]
 [ 4.69701573e-03]
 [ 6.97576697e-04]
 [-6.62026209e-03]
 [ 1.27241635e-02]
 [ 1.63014382e-02]
 [ 1.36075415e-02]
 [ 1.63974041e-02]
 [-3.48289009e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.86844981]
curr_Stock_Price:  100.94384714598779
curr_Factors:  [100.94384715]
mat_Sqrt:  [[0.15]]
grads:  [0.03168477]
Stock Position:  0.03168476762837341
Bond Position:  [12.67006747]


portfolio before change:  [15.81419191]
curr_Stock_Price:  99.03142930391442
curr_Factors:  [99.0314293]
mat_Sqrt:  [[0.15]]
grads:  [0.03131344]
Stock Position:  0.031313438205711135
Bond Position:  [12.71317737]


portfolio before change:  [15.86389789]
curr_Stock_Price:  100.41574882649263
curr_Factors:  [100.41574883]
mat_Sqrt:  [[0.15]]
grads:  [0.00465051]
Stock Position:  0.004650511315072453
Bond Position:  [15.39691332]


portfolio before change:  [15.87189923]
curr_Stock_Price:  100.48046340205985
curr_Factors:  [100.4804634]
mat_Sqrt:  [[0.15]]
grads:  [-0.04413508]
Stock Position:  -0.04413508063072839
Bond Position:  [20.30661258]


portfolio before change:  [15.92217757]
curr_Stock_Price:  99.57137947172819
curr_Factors:  [99.57137947]
mat_Sqrt:  [[0.15]]
grads:  [0.08482776]
Stock Position:  0.08482775654113663
Bond Position:  [7.47576083]


portfolio before change:  [15.79583399]
curr_Stock_Price:  98.03789092069148
curr_Factors:  [98.03789092]
mat_Sqrt:  [[0.15]]
grads:  [0.10867625]
Stock Position:  0.10867625490344868
Bond Position:  [5.14144316]


portfolio before change:  [15.69770535]
curr_Stock_Price:  97.11128552678879
curr_Factors:  [97.11128553]
mat_Sqrt:  [[0.15]]
grads:  [0.09071694]
Stock Position:  0.09071694310156506
Bond Position:  [6.88806639]


portfolio before change:  [15.38322441]
curr_Stock_Price:  93.6066940156181
curr_Factors:  [93.60669402]
mat_Sqrt:  [[0.15]]
grads:  [0.10931603]
Stock Position:  0.10931602755679534
Bond Position:  [5.15051247]


portfolio before change:  [15.36321909]
curr_Stock_Price:  93.40012573439164
curr_Factors:  [93.40012573]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.36321909]
Stock Price:  91.07026069893993
PL:  [15.36321909]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.70808362e-02]
 [ 3.11857735e-03]
 [ 8.62531556e-04]
 [-4.89622313e-03]
 [ 1.35805078e-02]
 [ 1.61974916e-02]
 [ 2.02185625e-02]
 [ 3.67257327e-03]
 [-7.43538195e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.25112598]
curr_Stock_Price:  99.50323501015713
curr_Factors:  [99.50323501]
mat_Sqrt:  [[0.15]]
grads:  [0.18053891]
Stock Position:  0.18053890784624585
Bond Position:  [-24.21533136]


portfolio before change:  [-6.62838506]
curr_Stock_Price:  97.48068822807532
curr_Factors:  [97.48068823]
mat_Sqrt:  [[0.15]]
grads:  [0.02079052]
Stock Position:  0.020790515683509776
Bond Position:  [-8.65505884]


portfolio before change:  [-6.62688463]
curr_Stock_Price:  97.76105862345905
curr_Factors:  [97.76105862]
mat_Sqrt:  [[0.15]]
grads:  [0.00575021]
Stock Position:  0.005750210374924464
Bond Position:  [-7.18903128]


portfolio before change:  [-6.62351031]
curr_Stock_Price:  98.9731404725107
curr_Factors:  [98.97314047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03264149]
Stock Position:  -0.032641487512735184
Bond Position:  [-3.39287979]


portfolio before change:  [-6.65743733]
curr_Stock_Price:  99.96053876888737
curr_Factors:  [99.96053877]
mat_Sqrt:  [[0.15]]
grads:  [0.09053672]
Stock Position:  0.0905367189250581
Bond Position:  [-15.70753653]


portfolio before change:  [-6.80415202]
curr_Stock_Price:  98.42680787423062
curr_Factors:  [98.42680787]
mat_Sqrt:  [[0.15]]
grads:  [0.10798328]
Stock Position:  0.10798327745709542
Bond Position:  [-17.43260133]


portfolio before change:  [-6.62658709]
curr_Stock_Price:  100.15192143974588
curr_Factors:  [100.15192144]
mat_Sqrt:  [[0.15]]
grads:  [0.13479042]
Stock Position:  0.13479041698474759
Bond Position:  [-20.12610634]


portfolio before change:  [-6.6618458]
curr_Stock_Price:  99.96501541448536
curr_Factors:  [99.96501541]
mat_Sqrt:  [[0.15]]
grads:  [0.02448382]
Stock Position:  0.024483821801871312
Bond Position:  [-9.10937142]


portfolio before change:  [-6.70413579]
curr_Stock_Price:  98.42382740241969
curr_Factors:  [98.4238274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.70413579]
Stock Price:  100.16508079360005
PL:  [-6.86921659]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.94064997e-03]
 [ 6.80097567e-03]
 [-1.15234946e-04]
 [-9.27705226e-03]
 [ 2.72257146e-03]
 [ 1.62543617e-02]
 [ 1.87757534e-02]
 [ 1.62590436e-03]
 [-2.30631893e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.51369268]
curr_Stock_Price:  100.79048562923185
curr_Factors:  [100.79048563]
mat_Sqrt:  [[0.15]]
grads:  [0.03293767]
Stock Position:  0.032937666464127144
Bond Position:  [10.19388928]


portfolio before change:  [13.49804253]
curr_Stock_Price:  100.16055715132156
curr_Factors:  [100.16055715]
mat_Sqrt:  [[0.15]]
grads:  [0.04533984]
Stock Position:  0.04533983779077536
Bond Position:  [8.95677911]


portfolio before change:  [13.54977638]
curr_Stock_Price:  101.20278277820161
curr_Factors:  [101.20278278]
mat_Sqrt:  [[0.15]]
grads:  [-0.00076823]
Stock Position:  -0.000768232973075455
Bond Position:  [13.62752369]


portfolio before change:  [13.55538735]
curr_Stock_Price:  102.77065739919044
curr_Factors:  [102.7706574]
mat_Sqrt:  [[0.15]]
grads:  [-0.06184702]
Stock Position:  -0.06184701506370779
Bond Position:  [19.91144575]


portfolio before change:  [13.48088501]
curr_Stock_Price:  104.13629405287662
curr_Factors:  [104.13629405]
mat_Sqrt:  [[0.15]]
grads:  [0.01815048]
Stock Position:  0.018150476392857683
Bond Position:  [11.59076166]


portfolio before change:  [13.4559514]
curr_Stock_Price:  102.44320123369612
curr_Factors:  [102.44320123]
mat_Sqrt:  [[0.15]]
grads:  [0.10836241]
Stock Position:  0.10836241131766391
Bond Position:  [2.35495909]


portfolio before change:  [13.64948593]
curr_Stock_Price:  104.21832555569704
curr_Factors:  [104.21832556]
mat_Sqrt:  [[0.15]]
grads:  [0.12517169]
Stock Position:  0.12517168950502652
Bond Position:  [0.60430204]


portfolio before change:  [13.4666078]
curr_Stock_Price:  102.75489278744949
curr_Factors:  [102.75489279]
mat_Sqrt:  [[0.15]]
grads:  [0.01083936]
Stock Position:  0.010839362368499283
Bond Position:  [12.35281028]


portfolio before change:  [13.48012496]
curr_Stock_Price:  103.43198182235854
curr_Factors:  [103.43198182]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.48012496]
Stock Price:  102.91633428473408
PL:  [10.56379068]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.31243997e-03]
 [ 6.71567776e-03]
 [ 4.15802606e-04]
 [-6.43629931e-03]
 [ 1.05289803e-02]
 [ 1.61131057e-02]
 [ 1.36866297e-02]
 [ 6.24419731e-03]
 [-6.95645403e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.85667327]
curr_Stock_Price:  100.68256663941646
curr_Factors:  [100.68256664]
mat_Sqrt:  [[0.15]]
grads:  [0.03541627]
Stock Position:  0.03541626647455123
Bond Position:  [8.29087266]


portfolio before change:  [11.94748928]
curr_Stock_Price:  103.1297342650367
curr_Factors:  [103.12973427]
mat_Sqrt:  [[0.15]]
grads:  [0.04477119]
Stock Position:  0.0447711850597832
Bond Position:  [7.33024886]


portfolio before change:  [11.83291135]
curr_Stock_Price:  100.48866108718717
curr_Factors:  [100.48866109]
mat_Sqrt:  [[0.15]]
grads:  [0.00277202]
Stock Position:  0.0027720173714870055
Bond Position:  [11.55435503]


portfolio before change:  [11.83824714]
curr_Stock_Price:  100.3289109218162
curr_Factors:  [100.32891092]
mat_Sqrt:  [[0.15]]
grads:  [-0.04290866]
Stock Position:  -0.04290866209518885
Bond Position:  [16.14322648]


portfolio before change:  [11.90169999]
curr_Stock_Price:  99.03828071093757
curr_Factors:  [99.03828071]
mat_Sqrt:  [[0.15]]
grads:  [0.0701932]
Stock Position:  0.07019320172012374
Bond Position:  [4.94988597]


portfolio before change:  [11.88278346]
curr_Stock_Price:  98.73352058426279
curr_Factors:  [98.73352058]
mat_Sqrt:  [[0.15]]
grads:  [0.1074207]
Stock Position:  0.10742070440030199
Bond Position:  [1.27675913]


portfolio before change:  [11.79058069]
curr_Stock_Price:  97.86924297960189
curr_Factors:  [97.86924298]
mat_Sqrt:  [[0.15]]
grads:  [0.0912442]
Stock Position:  0.09124419811557873
Bond Position:  [2.86058009]


portfolio before change:  [11.6658559]
curr_Stock_Price:  96.48662974985733
curr_Factors:  [96.48662975]
mat_Sqrt:  [[0.15]]
grads:  [0.04162798]
Stock Position:  0.04162798203732373
Bond Position:  [7.64931221]


portfolio before change:  [11.73492673]
curr_Stock_Price:  98.05397001797289
curr_Factors:  [98.05397002]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.73492673]
Stock Price:  99.00331039044123
PL:  [11.73492673]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.56481073e-02]
 [ 5.34696734e-03]
 [ 1.63363691e-03]
 [-4.78029810e-03]
 [ 1.01839165e-02]
 [ 1.64440829e-02]
 [ 1.36240550e-02]
 [ 3.50816897e-03]
 [-7.55696807e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.85068247]
curr_Stock_Price:  98.94315982788603
curr_Factors:  [98.94315983]
mat_Sqrt:  [[0.15]]
grads:  [0.10432072]
Stock Position:  0.10432071517421301
Bond Position:  [-25.17250366]


portfolio before change:  [-14.82365261]
curr_Stock_Price:  99.32294305209695
curr_Factors:  [99.32294305]
mat_Sqrt:  [[0.15]]
grads:  [0.03564645]
Stock Position:  0.03564644890334598
Bond Position:  [-18.36416282]


portfolio before change:  [-14.92804272]
curr_Stock_Price:  96.65210937690517
curr_Factors:  [96.65210938]
mat_Sqrt:  [[0.15]]
grads:  [0.01089091]
Stock Position:  0.010890912759511625
Bond Position:  [-15.98067241]


portfolio before change:  [-14.93032012]
curr_Stock_Price:  97.17685286418208
curr_Factors:  [97.17685286]
mat_Sqrt:  [[0.15]]
grads:  [-0.03186865]
Stock Position:  -0.03186865402327382
Bond Position:  [-11.83342462]


portfolio before change:  [-14.90962756]
curr_Stock_Price:  96.34183945059688
curr_Factors:  [96.34183945]
mat_Sqrt:  [[0.15]]
grads:  [0.06789278]
Stock Position:  0.06789277671324284
Bond Position:  [-21.45054255]


portfolio before change:  [-14.90484857]
curr_Stock_Price:  96.57024281083773
curr_Factors:  [96.57024281]
mat_Sqrt:  [[0.15]]
grads:  [0.10962722]
Stock Position:  0.10962721928593225
Bond Position:  [-25.49157576]


portfolio before change:  [-14.80847426]
curr_Stock_Price:  97.56564604678684
curr_Factors:  [97.56564605]
mat_Sqrt:  [[0.15]]
grads:  [0.09082703]
Stock Position:  0.09082703305032386
Bond Position:  [-23.67007242]


portfolio before change:  [-14.78278774]
curr_Stock_Price:  97.97878865551455
curr_Factors:  [97.97878866]
mat_Sqrt:  [[0.15]]
grads:  [0.02338779]
Stock Position:  0.02338779315870492
Bond Position:  [-17.07429538]


portfolio before change:  [-14.77880152]
curr_Stock_Price:  98.51434586671283
curr_Factors:  [98.51434587]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.77880152]
Stock Price:  97.93536950923988
PL:  [-14.77880152]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.77998480e-03]
 [ 6.68906849e-03]
 [-4.43853286e-03]
 [-1.02135905e-02]
 [ 1.10199141e-02]
 [ 1.62156807e-02]
 [ 2.29570583e-02]
 [ 1.59619119e-03]
 [-2.21810268e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.89811592]
curr_Stock_Price:  101.98783333084742
curr_Factors:  [101.98783333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01186657]
Stock Position:  -0.011866565332525014
Bond Position:  [33.10836121]


portfolio before change:  [31.89956959]
curr_Stock_Price:  103.26070764789617
curr_Factors:  [103.26070765]
mat_Sqrt:  [[0.15]]
grads:  [0.04459379]
Stock Position:  0.044593789957194895
Bond Position:  [27.29478329]


portfolio before change:  [31.98564985]
curr_Stock_Price:  104.88491252934648
curr_Factors:  [104.88491253]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959022]
Stock Position:  -0.029590219083945407
Bond Position:  [35.08921739]


portfolio before change:  [32.04283513]
curr_Stock_Price:  103.54540628286858
curr_Factors:  [103.54540628]
mat_Sqrt:  [[0.15]]
grads:  [-0.0680906]
Stock Position:  -0.06809060359734545
Bond Position:  [39.09330434]


portfolio before change:  [32.15961592]
curr_Stock_Price:  102.11746688546381
curr_Factors:  [102.11746689]
mat_Sqrt:  [[0.15]]
grads:  [0.07346609]
Stock Position:  0.07346609374604743
Bond Position:  [24.65744453]


portfolio before change:  [32.18188396]
curr_Stock_Price:  102.25271609792264
curr_Factors:  [102.2527161]
mat_Sqrt:  [[0.15]]
grads:  [0.10810454]
Stock Position:  0.10810453780069082
Bond Position:  [21.12790135]


portfolio before change:  [32.25730304]
curr_Stock_Price:  102.85262139033998
curr_Factors:  [102.85262139]
mat_Sqrt:  [[0.15]]
grads:  [0.15304706]
Stock Position:  0.15304705546831263
Bond Position:  [16.51601219]


portfolio before change:  [32.28326421]
curr_Stock_Price:  102.96827932207314
curr_Factors:  [102.96827932]
mat_Sqrt:  [[0.15]]
grads:  [0.01064127]
Stock Position:  0.010641274630768674
Bond Position:  [31.18755047]


portfolio before change:  [32.29790233]
curr_Stock_Price:  102.87810633098748
curr_Factors:  [102.87810633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.29790233]
Stock Price:  104.72613482652365
PL:  [27.57176751]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.31282005e-03]
 [ 4.13633152e-03]
 [ 1.14474550e-03]
 [-4.72993404e-03]
 [ 1.09225325e-02]
 [ 1.64531159e-02]
 [ 1.12734630e-02]
 [ 1.72155051e-02]
 [-4.23362734e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.9436291]
curr_Stock_Price:  101.01387183137392
curr_Factors:  [101.01387183]
mat_Sqrt:  [[0.15]]
grads:  [0.02875213]
Stock Position:  0.028752133634495313
Bond Position:  [14.03926476]


portfolio before change:  [16.88105568]
curr_Stock_Price:  98.59336265793392
curr_Factors:  [98.59336266]
mat_Sqrt:  [[0.15]]
grads:  [0.02757554]
Stock Position:  0.02757554348032767
Bond Position:  [14.16229012]


portfolio before change:  [16.85399555]
curr_Stock_Price:  97.35519847158173
curr_Factors:  [97.35519847]
mat_Sqrt:  [[0.15]]
grads:  [0.00763164]
Stock Position:  0.007631636650336328
Bond Position:  [16.11101605]


portfolio before change:  [16.86579031]
curr_Stock_Price:  97.8449019068929
curr_Factors:  [97.84490191]
mat_Sqrt:  [[0.15]]
grads:  [-0.03153289]
Stock Position:  -0.03153289361129631
Bond Position:  [19.95112319]


portfolio before change:  [16.83512396]
curr_Stock_Price:  99.1338546006619
curr_Factors:  [99.1338546]
mat_Sqrt:  [[0.15]]
grads:  [0.07281688]
Stock Position:  0.07281688316810482
Bond Position:  [9.61650565]


portfolio before change:  [16.64669264]
curr_Stock_Price:  96.48006381008872
curr_Factors:  [96.48006381]
mat_Sqrt:  [[0.15]]
grads:  [0.10968744]
Stock Position:  0.10968743949695522
Bond Position:  [6.06404148]


portfolio before change:  [16.40981497]
curr_Stock_Price:  94.29284484320235
curr_Factors:  [94.29284484]
mat_Sqrt:  [[0.15]]
grads:  [0.07515642]
Stock Position:  0.07515641982459781
Bond Position:  [9.32310234]


portfolio before change:  [16.3454688]
curr_Stock_Price:  93.3746413854615
curr_Factors:  [93.37464139]
mat_Sqrt:  [[0.15]]
grads:  [0.11477003]
Stock Position:  0.11477003432722842
Bond Position:  [5.628858]


portfolio before change:  [16.51428767]
curr_Stock_Price:  94.8210444776537
curr_Factors:  [94.82104448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.51428767]
Stock Price:  93.83797023672506
PL:  [16.51428767]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.83381707e-03]
 [ 6.83177105e-03]
 [-3.00021286e-03]
 [-1.15118268e-02]
 [ 1.09513358e-03]
 [ 1.64236020e-02]
 [ 1.66173111e-02]
 [ 4.86190700e-03]
 [ 1.62009659e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.0027388]
curr_Stock_Price:  101.4084918300608
curr_Factors:  [101.40849183]
mat_Sqrt:  [[0.15]]
grads:  [0.01222545]
Stock Position:  0.0122254471319846
Bond Position:  [21.76297464]


portfolio before change:  [23.02768007]
curr_Stock_Price:  102.55831185645103
curr_Factors:  [102.55831186]
mat_Sqrt:  [[0.15]]
grads:  [0.04554514]
Stock Position:  0.04554514030610291
Bond Position:  [18.35664737]


portfolio before change:  [23.09255846]
curr_Stock_Price:  103.78122538239073
curr_Factors:  [103.78122538]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000142]
Stock Position:  -0.020001419066367033
Bond Position:  [25.16833024]


portfolio before change:  [23.08838171]
curr_Stock_Price:  104.61936886562621
curr_Factors:  [104.61936887]
mat_Sqrt:  [[0.15]]
grads:  [-0.07674551]
Stock Position:  -0.0767455117986034
Bond Position:  [31.11744872]


portfolio before change:  [23.09571379]
curr_Stock_Price:  104.7266133465497
curr_Factors:  [104.72661335]
mat_Sqrt:  [[0.15]]
grads:  [0.00730089]
Stock Position:  0.007300890551533267
Bond Position:  [22.33111625]


portfolio before change:  [23.11260095]
curr_Stock_Price:  105.50991566234252
curr_Factors:  [105.50991566]
mat_Sqrt:  [[0.15]]
grads:  [0.10949068]
Stock Position:  0.1094906802504584
Bond Position:  [11.56024851]


portfolio before change:  [23.05240362]
curr_Stock_Price:  104.90731736408729
curr_Factors:  [104.90731736]
mat_Sqrt:  [[0.15]]
grads:  [0.11078207]
Stock Position:  0.11078207413788534
Bond Position:  [11.43055341]


portfolio before change:  [23.43981091]
curr_Stock_Price:  108.35273562517469
curr_Factors:  [108.35273563]
mat_Sqrt:  [[0.15]]
grads:  [0.03241271]
Stock Position:  0.03241271334112891
Bond Position:  [19.92780475]


portfolio before change:  [23.40359577]
curr_Stock_Price:  106.92793877247006
curr_Factors:  [106.92793877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.40359577]
Stock Price:  107.00846737690595
PL:  [16.39512839]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.01320037e-03]
 [ 6.98896551e-03]
 [ 2.10074230e-03]
 [-5.35049402e-03]
 [ 8.25257362e-03]
 [ 1.64655849e-02]
 [ 1.17837878e-02]
 [ 9.26952053e-03]
 [-3.94765334e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.96133916]
curr_Stock_Price:  101.86169419800495
curr_Factors:  [101.8616942]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675467]
Stock Position:  -0.006754669137163198
Bond Position:  [30.6493812]


portfolio before change:  [29.98307643]
curr_Stock_Price:  100.91290581184
curr_Factors:  [100.91290581]
mat_Sqrt:  [[0.15]]
grads:  [0.0465931]
Stock Position:  0.04659310343128977
Bond Position:  [25.28123097]


portfolio before change:  [29.93844555]
curr_Stock_Price:  99.68365401622681
curr_Factors:  [99.68365402]
mat_Sqrt:  [[0.15]]
grads:  [0.01400495]
Stock Position:  0.014004948635884293
Bond Position:  [28.5423811]


portfolio before change:  [29.95119087]
curr_Stock_Price:  99.57444715599979
curr_Factors:  [99.57444716]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566996]
Stock Position:  -0.035669960120164
Bond Position:  [33.50300743]


portfolio before change:  [30.03832911]
curr_Stock_Price:  97.60128692576507
curr_Factors:  [97.60128693]
mat_Sqrt:  [[0.15]]
grads:  [0.05501716]
Stock Position:  0.05501715746890253
Bond Position:  [24.66858374]


portfolio before change:  [29.98213139]
curr_Stock_Price:  96.35558280875027
curr_Factors:  [96.35558281]
mat_Sqrt:  [[0.15]]
grads:  [0.10977057]
Stock Position:  0.10977056607971497
Bond Position:  [19.40512452]


portfolio before change:  [29.81024895]
curr_Stock_Price:  94.70133760862673
curr_Factors:  [94.70133761]
mat_Sqrt:  [[0.15]]
grads:  [0.07855859]
Stock Position:  0.078558585656761
Bond Position:  [22.3706458]


portfolio before change:  [29.89427388]
curr_Stock_Price:  95.62850318896201
curr_Factors:  [95.62850319]
mat_Sqrt:  [[0.15]]
grads:  [0.0617968]
Stock Position:  0.06179680352343681
Bond Position:  [23.98473806]


portfolio before change:  [29.8229226]
curr_Stock_Price:  94.2797821166134
curr_Factors:  [94.27978212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.8229226]
Stock Price:  92.67414344843934
PL:  [29.8229226]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 8.14396604e-04]
 [ 6.89885531e-03]
 [-1.83435819e-05]
 [-6.22736972e-03]
 [ 1.21749637e-02]
 [ 1.60928199e-02]
 [ 1.86539420e-02]
 [ 1.27788624e-03]
 [ 1.11522713e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.49437778]
curr_Stock_Price:  101.57076823990796
curr_Factors:  [101.57076824]
mat_Sqrt:  [[0.15]]
grads:  [0.00542931]
Stock Position:  0.005429310693840922
Bond Position:  [24.94291852]


portfolio before change:  [25.49991605]
curr_Stock_Price:  100.2932016802035
curr_Factors:  [100.29320168]
mat_Sqrt:  [[0.15]]
grads:  [0.04599237]
Stock Position:  0.04599236876097709
Bond Position:  [20.88719413]


portfolio before change:  [25.53729025]
curr_Stock_Price:  100.8786900383985
curr_Factors:  [100.87869004]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012229]
Stock Position:  -0.00012229054588447943
Bond Position:  [25.54962676]


portfolio before change:  [25.55015361]
curr_Stock_Price:  100.1807726983323
curr_Factors:  [100.1807727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0415158]
Stock Position:  -0.04151579811880389
Bond Position:  [29.70923834]


portfolio before change:  [25.53067038]
curr_Stock_Price:  101.00796529317739
curr_Factors:  [101.00796529]
mat_Sqrt:  [[0.15]]
grads:  [0.08116642]
Stock Position:  0.0811664249515863
Bond Position:  [17.33221495]


portfolio before change:  [25.58289681]
curr_Stock_Price:  101.54461762657742
curr_Factors:  [101.54461763]
mat_Sqrt:  [[0.15]]
grads:  [0.10728547]
Stock Position:  0.10728546574290876
Bond Position:  [14.68863521]


portfolio before change:  [25.88126605]
curr_Stock_Price:  104.25722260603922
curr_Factors:  [104.25722261]
mat_Sqrt:  [[0.15]]
grads:  [0.12435961]
Stock Position:  0.12435961306957947
Bond Position:  [12.91587819]


portfolio before change:  [26.01170959]
curr_Stock_Price:  105.25420212815331
curr_Factors:  [105.25420213]
mat_Sqrt:  [[0.15]]
grads:  [0.00851924]
Stock Position:  0.008519241588328253
Bond Position:  [25.11502361]


portfolio before change:  [26.03054205]
curr_Stock_Price:  105.99039587703382
curr_Factors:  [105.99039588]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.03054205]
Stock Price:  104.96762923836548
PL:  [21.06291282]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.56571240e-02]
 [ 1.59564862e-03]
 [ 3.62118228e-03]
 [-4.86576757e-03]
 [ 1.41200966e-02]
 [ 1.65885498e-02]
 [ 1.18150910e-02]
 [ 1.74149097e-02]
 [-2.92756085e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.84699095]
curr_Stock_Price:  98.94340025080713
curr_Factors:  [98.94340025]
mat_Sqrt:  [[0.15]]
grads:  [0.10438083]
Stock Position:  0.1043808267089585
Bond Position:  [-25.17478486]


portfolio before change:  [-15.21164261]
curr_Stock_Price:  95.57054784639026
curr_Factors:  [95.57054785]
mat_Sqrt:  [[0.15]]
grads:  [0.01063766]
Stock Position:  0.010637657462391653
Bond Position:  [-16.22828936]


portfolio before change:  [-15.23865962]
curr_Stock_Price:  93.79376204955487
curr_Factors:  [93.79376205]
mat_Sqrt:  [[0.15]]
grads:  [0.02414122]
Stock Position:  0.02414121521235143
Bond Position:  [-17.50295501]


portfolio before change:  [-15.24469303]
curr_Stock_Price:  93.90644301061046
curr_Factors:  [93.90644301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03243845]
Stock Position:  -0.032438450462662756
Bond Position:  [-12.19851353]


portfolio before change:  [-15.26516215]
curr_Stock_Price:  94.34938465885294
curr_Factors:  [94.34938466]
mat_Sqrt:  [[0.15]]
grads:  [0.09413398]
Stock Position:  0.09413397726161675
Bond Position:  [-24.14664498]


portfolio before change:  [-15.24865669]
curr_Stock_Price:  94.65301360133235
curr_Factors:  [94.6530136]
mat_Sqrt:  [[0.15]]
grads:  [0.11059033]
Stock Position:  0.11059033194939567
Bond Position:  [-25.71636489]


portfolio before change:  [-15.25340288]
curr_Stock_Price:  94.72639442929957
curr_Factors:  [94.72639443]
mat_Sqrt:  [[0.15]]
grads:  [0.07876727]
Stock Position:  0.07876727346318342
Bond Position:  [-22.7147427]


portfolio before change:  [-15.37569212]
curr_Stock_Price:  93.31808071395149
curr_Factors:  [93.31808071]
mat_Sqrt:  [[0.15]]
grads:  [0.1160994]
Stock Position:  0.11609939777873407
Bond Position:  [-26.2098651]


portfolio before change:  [-15.5013036]
curr_Stock_Price:  92.34905528967175
curr_Factors:  [92.34905529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.5013036]
Stock Price:  92.65164228645212
PL:  [-15.5013036]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-5.85248840e-02]
 [ 2.67365524e-03]
 [ 2.28989798e-03]
 [-4.86643498e-03]
 [ 1.64518346e-02]
 [ 1.65469349e-02]
 [ 1.33740931e-02]
 [ 3.47059803e-03]
 [-6.93173986e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-51.11689389]
curr_Stock_Price:  96.58120023144122
curr_Factors:  [96.58120023]
mat_Sqrt:  [[0.15]]
grads:  [-0.39016589]
Stock Position:  -0.39016589338856317
Bond Position:  [-13.43420362]


portfolio before change:  [-51.25683185]
curr_Stock_Price:  96.92264261928113
curr_Factors:  [96.92264262]
mat_Sqrt:  [[0.15]]
grads:  [0.01782437]
Stock Position:  0.017824368272916443
Bond Position:  [-52.98441672]


portfolio before change:  [-51.3049752]
curr_Stock_Price:  95.70832107452893
curr_Factors:  [95.70832107]
mat_Sqrt:  [[0.15]]
grads:  [0.01526599]
Stock Position:  0.015265986543679713
Bond Position:  [-52.76605714]


portfolio before change:  [-51.35874198]
curr_Stock_Price:  93.91497755639298
curr_Factors:  [93.91497756]
mat_Sqrt:  [[0.15]]
grads:  [-0.0324429]
Stock Position:  -0.032442899870412344
Bond Position:  [-48.31186777]


portfolio before change:  [-51.35870495]
curr_Stock_Price:  93.16908233612784
curr_Factors:  [93.16908234]
mat_Sqrt:  [[0.15]]
grads:  [0.1096789]
Stock Position:  0.10967889706942384
Bond Position:  [-61.57738714]


portfolio before change:  [-51.14214851]
curr_Stock_Price:  95.42432776290606
curr_Factors:  [95.42432776]
mat_Sqrt:  [[0.15]]
grads:  [0.1103129]
Stock Position:  0.1103128995120301
Bond Position:  [-61.66868279]


portfolio before change:  [-51.11232071]
curr_Stock_Price:  95.97430744716893
curr_Factors:  [95.97430745]
mat_Sqrt:  [[0.15]]
grads:  [0.08916062]
Stock Position:  0.08916062039674828
Bond Position:  [-59.6694495]


portfolio before change:  [-51.00538226]
curr_Stock_Price:  97.50839981805352
curr_Factors:  [97.50839982]
mat_Sqrt:  [[0.15]]
grads:  [0.02313732]
Stock Position:  0.02313732020114819
Bond Position:  [-53.26146533]


portfolio before change:  [-50.98977924]
curr_Stock_Price:  99.33403982848395
curr_Factors:  [99.33403983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-50.98977924]
Stock Price:  97.49449682630285
PL:  [-50.98977924]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-6.09432413e-03]
 [ 4.74407706e-03]
 [ 7.27295828e-04]
 [-6.39447401e-03]
 [ 1.03491823e-02]
 [ 1.60714356e-02]
 [ 1.90601774e-02]
 [ 1.72107329e-03]
 [-2.88699123e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.7522118]
curr_Stock_Price:  98.36341764330245
curr_Factors:  [98.36341764]
mat_Sqrt:  [[0.15]]
grads:  [-0.04062883]
Stock Position:  -0.040628827546428894
Bond Position:  [-19.75582147]


portfolio before change:  [-23.79067752]
curr_Stock_Price:  99.06699037396348
curr_Factors:  [99.06699037]
mat_Sqrt:  [[0.15]]
grads:  [0.03162718]
Stock Position:  0.03162718037934247
Bond Position:  [-26.92388709]


portfolio before change:  [-23.83929471]
curr_Stock_Price:  97.95554509338949
curr_Factors:  [97.95554509]
mat_Sqrt:  [[0.15]]
grads:  [0.00484864]
Stock Position:  0.004848638853190449
Bond Position:  [-24.31424577]


portfolio before change:  [-23.84009107]
curr_Stock_Price:  100.29925535420674
curr_Factors:  [100.29925535]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262983]
Stock Position:  -0.04262982675579403
Bond Position:  [-19.56435119]


portfolio before change:  [-23.79425918]
curr_Stock_Price:  98.99461690078208
curr_Factors:  [98.9946169]
mat_Sqrt:  [[0.15]]
grads:  [0.06899455]
Stock Position:  0.06899454873044675
Bond Position:  [-30.6243481]


portfolio before change:  [-23.81587634]
curr_Stock_Price:  98.90328852911901
curr_Factors:  [98.90328853]
mat_Sqrt:  [[0.15]]
grads:  [0.1071429]
Stock Position:  0.1071429041393617
Bond Position:  [-34.4126619]


portfolio before change:  [-23.74794667]
curr_Stock_Price:  99.69793098663612
curr_Factors:  [99.69793099]
mat_Sqrt:  [[0.15]]
grads:  [0.12706785]
Stock Position:  0.127067849029516
Bond Position:  [-36.41634832]


portfolio before change:  [-23.43695292]
curr_Stock_Price:  102.28872386055131
curr_Factors:  [102.28872386]
mat_Sqrt:  [[0.15]]
grads:  [0.01147382]
Stock Position:  0.011473821924050182
Bond Position:  [-24.61059553]


portfolio before change:  [-23.44616767]
curr_Stock_Price:  102.55834889881855
curr_Factors:  [102.5583489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.44616767]
Stock Price:  101.69123996467259
PL:  [-25.13740763]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.56880017e-02]
 [ 6.38678481e-03]
 [-1.04799002e-04]
 [-8.46714002e-03]
 [ 1.10818324e-02]
 [ 1.61464228e-02]
 [ 2.09362447e-02]
 [ 1.60710294e-03]
 [ 2.54785720e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.3866437]
curr_Stock_Price:  100.0006705756714
curr_Factors:  [100.00067058]
mat_Sqrt:  [[0.15]]
grads:  [0.10458668]
Stock Position:  0.10458667814170801
Bond Position:  [-9.07209425]


portfolio before change:  [1.37235352]
curr_Stock_Price:  99.9074177518473
curr_Factors:  [99.90741775]
mat_Sqrt:  [[0.15]]
grads:  [0.04257857]
Stock Position:  0.042578565389637196
Bond Position:  [-2.881561]


portfolio before change:  [1.42458086]
curr_Stock_Price:  101.167875501594
curr_Factors:  [101.1678755]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069866]
Stock Position:  -0.0006986600138284801
Bond Position:  [1.49526281]


portfolio before change:  [1.42467698]
curr_Stock_Price:  102.10065958027475
curr_Factors:  [102.10065958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0564476]
Stock Position:  -0.056447600120527144
Bond Position:  [7.18801418]


portfolio before change:  [1.42815016]
curr_Stock_Price:  102.10281592617994
curr_Factors:  [102.10281593]
mat_Sqrt:  [[0.15]]
grads:  [0.07387888]
Stock Position:  0.07387888283719642
Bond Position:  [-6.11509181]


portfolio before change:  [1.4109691]
curr_Stock_Price:  101.91165500969083
curr_Factors:  [101.91165501]
mat_Sqrt:  [[0.15]]
grads:  [0.10764282]
Stock Position:  0.10764281871711054
Bond Position:  [-9.55908871]


portfolio before change:  [1.58022297]
curr_Stock_Price:  103.52843368452847
curr_Factors:  [103.52843368]
mat_Sqrt:  [[0.15]]
grads:  [0.13957496]
Stock Position:  0.13957496498874028
Bond Position:  [-12.86975454]


portfolio before change:  [1.48466542]
curr_Stock_Price:  102.88991611463597
curr_Factors:  [102.88991611]
mat_Sqrt:  [[0.15]]
grads:  [0.01071402]
Stock Position:  0.010714019569946375
Bond Position:  [0.38230084]


portfolio before change:  [1.49896039]
curr_Stock_Price:  104.20630113411458
curr_Factors:  [104.20630113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.49896039]
Stock Price:  106.14845671257014
PL:  [-4.64949632]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.15823164e-02]
 [ 6.95679337e-03]
 [-9.48006995e-05]
 [-6.38652452e-03]
 [ 8.23988683e-03]
 [ 1.59528012e-02]
 [ 2.48271333e-02]
 [ 3.18955901e-03]
 [-4.60946740e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.48114788]
curr_Stock_Price:  99.81389595589032
curr_Factors:  [99.81389596]
mat_Sqrt:  [[0.15]]
grads:  [0.14388211]
Stock Position:  0.14388210923052694
Bond Position:  [-15.84258176]


portfolio before change:  [-1.34256442]
curr_Stock_Price:  100.83213744069111
curr_Factors:  [100.83213744]
mat_Sqrt:  [[0.15]]
grads:  [0.04637862]
Stock Position:  0.04637862245052689
Bond Position:  [-6.01902006]


portfolio before change:  [-1.33155468]
curr_Stock_Price:  101.13443209500744
curr_Factors:  [101.1344321]
mat_Sqrt:  [[0.15]]
grads:  [-0.000632]
Stock Position:  -0.0006320046631496474
Bond Position:  [-1.26763724]


portfolio before change:  [-1.33165725]
curr_Stock_Price:  100.29361889105026
curr_Factors:  [100.29361889]
mat_Sqrt:  [[0.15]]
grads:  [-0.04257683]
Stock Position:  -0.04257683012669831
Bond Position:  [2.93852712]


portfolio before change:  [-1.43584844]
curr_Stock_Price:  102.7752695693218
curr_Factors:  [102.77526957]
mat_Sqrt:  [[0.15]]
grads:  [0.05493258]
Stock Position:  0.054932578857060044
Bond Position:  [-7.08155904]


portfolio before change:  [-1.57181376]
curr_Stock_Price:  100.36461177743868
curr_Factors:  [100.36461178]
mat_Sqrt:  [[0.15]]
grads:  [0.10635201]
Stock Position:  0.10635200812109889
Bond Position:  [-12.24579176]


portfolio before change:  [-1.42545863]
curr_Stock_Price:  101.79833693129981
curr_Factors:  [101.79833693]
mat_Sqrt:  [[0.15]]
grads:  [0.16551422]
Stock Position:  0.16551422180428313
Bond Position:  [-18.27453115]


portfolio before change:  [-1.61605522]
curr_Stock_Price:  100.70201398529845
curr_Factors:  [100.70201399]
mat_Sqrt:  [[0.15]]
grads:  [0.02126373]
Stock Position:  0.021263726731348253
Bond Position:  [-3.75735533]


portfolio before change:  [-1.61467993]
curr_Stock_Price:  100.85506553415682
curr_Factors:  [100.85506553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.61467993]
Stock Price:  102.09007952564595
PL:  [-3.70475945]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.71368546e-02]
 [ 5.23522186e-03]
 [ 1.04495177e-03]
 [-5.01617063e-03]
 [ 1.22082462e-02]
 [ 1.61206900e-02]
 [ 1.80788213e-02]
 [ 2.80168172e-03]
 [ 5.61589326e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.81225531]
curr_Stock_Price:  99.96326159029377
curr_Factors:  [99.96326159]
mat_Sqrt:  [[0.15]]
grads:  [0.1142457]
Stock Position:  0.11424569754269384
Bond Position:  [-10.60811724]


portfolio before change:  [0.72670666]
curr_Stock_Price:  99.26088708772984
curr_Factors:  [99.26088709]
mat_Sqrt:  [[0.15]]
grads:  [0.03490148]
Stock Position:  0.03490147903783262
Bond Position:  [-2.73764511]


portfolio before change:  [0.70688966]
curr_Stock_Price:  98.73231825258752
curr_Factors:  [98.73231825]
mat_Sqrt:  [[0.15]]
grads:  [0.00696635]
Stock Position:  0.006966345107789479
Bond Position:  [0.01908626]


portfolio before change:  [0.70979298]
curr_Stock_Price:  99.14771182470712
curr_Factors:  [99.14771182]
mat_Sqrt:  [[0.15]]
grads:  [-0.03344114]
Stock Position:  -0.033441137559764675
Bond Position:  [4.02540525]


portfolio before change:  [0.7018281]
curr_Stock_Price:  99.44608931241137
curr_Factors:  [99.44608931]
mat_Sqrt:  [[0.15]]
grads:  [0.08138831]
Stock Position:  0.08138830809384351
Bond Position:  [-7.39192085]


portfolio before change:  [0.63789288]
curr_Stock_Price:  98.70595427408664
curr_Factors:  [98.70595427]
mat_Sqrt:  [[0.15]]
grads:  [0.10747127]
Stock Position:  0.1074712665807173
Bond Position:  [-9.97016104]


portfolio before change:  [0.71503361]
curr_Stock_Price:  99.4701311211285
curr_Factors:  [99.47013112]
mat_Sqrt:  [[0.15]]
grads:  [0.12052548]
Stock Position:  0.12052547546639573
Bond Position:  [-11.27365124]


portfolio before change:  [0.90374362]
curr_Stock_Price:  101.08263876292196
curr_Factors:  [101.08263876]
mat_Sqrt:  [[0.15]]
grads:  [0.01867788]
Stock Position:  0.01867787811588555
Bond Position:  [-0.98426558]


portfolio before change:  [0.97343225]
curr_Stock_Price:  104.84007239093889
curr_Factors:  [104.84007239]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.97343225]
Stock Price:  105.82211901435033
PL:  [-4.84868676]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.11311659e-03]
 [ 6.64244949e-03]
 [-1.39745173e-04]
 [-9.01599694e-03]
 [ 5.00161793e-03]
 [ 1.64326494e-02]
 [ 2.26081889e-02]
 [ 1.78082938e-03]
 [-5.41740305e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.50792503]
curr_Stock_Price:  100.5295964715542
curr_Factors:  [100.52959647]
mat_Sqrt:  [[0.15]]
grads:  [0.04075411]
Stock Position:  0.04075411056681434
Bond Position:  [5.41093074]


portfolio before change:  [9.4916428]
curr_Stock_Price:  100.06367133143362
curr_Factors:  [100.06367133]
mat_Sqrt:  [[0.15]]
grads:  [0.044283]
Stock Position:  0.044282996615226056
Bond Position:  [5.06052359]


portfolio before change:  [9.54824749]
curr_Stock_Price:  101.28476724417722
curr_Factors:  [101.28476724]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093163]
Stock Position:  -0.000931634488877391
Bond Position:  [9.64260787]


portfolio before change:  [9.55188688]
curr_Stock_Price:  102.5547000580324
curr_Factors:  [102.55470006]
mat_Sqrt:  [[0.15]]
grads:  [-0.06010665]
Stock Position:  -0.06010664627142513
Bond Position:  [15.71610596]


portfolio before change:  [9.50040151]
curr_Stock_Price:  103.54203493021483
curr_Factors:  [103.54203493]
mat_Sqrt:  [[0.15]]
grads:  [0.03334412]
Stock Position:  0.033344119541922276
Bond Position:  [6.04788352]


portfolio before change:  [9.51427927]
curr_Stock_Price:  103.86752131955438
curr_Factors:  [103.86752132]
mat_Sqrt:  [[0.15]]
grads:  [0.109551]
Stock Position:  0.10955099592757894
Bond Position:  [-1.86451114]


portfolio before change:  [9.41771141]
curr_Stock_Price:  102.99454553599139
curr_Factors:  [102.99454554]
mat_Sqrt:  [[0.15]]
grads:  [0.15072126]
Stock Position:  0.1507212596506039
Bond Position:  [-6.10575623]


portfolio before change:  [9.28885748]
curr_Stock_Price:  102.15989027080485
curr_Factors:  [102.15989027]
mat_Sqrt:  [[0.15]]
grads:  [0.0118722]
Stock Position:  0.011872195847143335
Bond Position:  [8.07599525]


portfolio before change:  [9.27037812]
curr_Stock_Price:  100.26315946951603
curr_Factors:  [100.26315947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.27037812]
Stock Price:  101.92425412585808
PL:  [7.346124]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.57448199e-02]
 [ 6.99492424e-03]
 [-4.55970712e-05]
 [-8.81728913e-03]
 [ 1.32007911e-02]
 [ 1.60408046e-02]
 [ 1.45974377e-02]
 [ 3.49051784e-03]
 [-4.91761846e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.76039294]
curr_Stock_Price:  99.60032403775455
curr_Factors:  [99.60032404]
mat_Sqrt:  [[0.15]]
grads:  [0.17163213]
Stock Position:  0.17163213273622205
Bond Position:  [-21.85500898]


portfolio before change:  [-4.42906802]
curr_Stock_Price:  101.59444458656886
curr_Factors:  [101.59444459]
mat_Sqrt:  [[0.15]]
grads:  [0.04663283]
Stock Position:  0.04663282826346649
Bond Position:  [-9.1667043]


portfolio before change:  [-4.46277911]
curr_Stock_Price:  100.96985046445383
curr_Factors:  [100.96985046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00030398]
Stock Position:  -0.0003039804748403087
Bond Position:  [-4.43208624]


portfolio before change:  [-4.4654275]
curr_Stock_Price:  102.39031952945096
curr_Factors:  [102.39031953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05878193]
Stock Position:  -0.058781927507673165
Bond Position:  [1.55327284]


portfolio before change:  [-4.34714318]
curr_Stock_Price:  100.39127843705275
curr_Factors:  [100.39127844]
mat_Sqrt:  [[0.15]]
grads:  [0.08800527]
Stock Position:  0.08800527402024298
Bond Position:  [-13.18210515]


portfolio before change:  [-4.47156417]
curr_Stock_Price:  99.05240083309272
curr_Factors:  [99.05240083]
mat_Sqrt:  [[0.15]]
grads:  [0.1069387]
Stock Position:  0.106938697055248
Bond Position:  [-15.06409885]


portfolio before change:  [-4.56833543]
curr_Stock_Price:  98.21792906098709
curr_Factors:  [98.21792906]
mat_Sqrt:  [[0.15]]
grads:  [0.09731625]
Stock Position:  0.0973162515786621
Bond Position:  [-14.12653612]


portfolio before change:  [-4.62017887]
curr_Stock_Price:  97.75779614365103
curr_Factors:  [97.75779614]
mat_Sqrt:  [[0.15]]
grads:  [0.02327012]
Stock Position:  0.02327011892063601
Bond Position:  [-6.89501441]


portfolio before change:  [-4.66184057]
curr_Stock_Price:  96.1156329704976
curr_Factors:  [96.11563297]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.66184057]
Stock Price:  95.82171743778248
PL:  [-4.66184057]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.01915269e-02]
 [ 6.90736146e-03]
 [-2.64485087e-05]
 [-5.14446317e-03]
 [ 1.33124209e-02]
 [ 1.60452765e-02]
 [ 2.42271521e-02]
 [ 1.39023861e-03]
 [ 1.43578982e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.41091303]
curr_Stock_Price:  99.88359861822926
curr_Factors:  [99.88359862]
mat_Sqrt:  [[0.15]]
grads:  [0.13461018]
Stock Position:  0.13461017950397486
Bond Position:  [-13.85626217]


portfolio before change:  [-0.36951695]
curr_Stock_Price:  100.24260516984225
curr_Factors:  [100.24260517]
mat_Sqrt:  [[0.15]]
grads:  [0.04604908]
Stock Position:  0.04604907642150851
Bond Position:  [-4.98559634]


portfolio before change:  [-0.34147085]
curr_Stock_Price:  100.90580027625853
curr_Factors:  [100.90580028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017632]
Stock Position:  -0.00017632339109925534
Bond Position:  [-0.3236788]


portfolio before change:  [-0.34135263]
curr_Stock_Price:  99.31724889206613
curr_Factors:  [99.31724889]
mat_Sqrt:  [[0.15]]
grads:  [-0.03429642]
Stock Position:  -0.03429642112999912
Bond Position:  [3.06487356]


portfolio before change:  [-0.3534351]
curr_Stock_Price:  99.71423738978544
curr_Factors:  [99.71423739]
mat_Sqrt:  [[0.15]]
grads:  [0.08874947]
Stock Position:  0.08874947271681066
Bond Position:  [-9.20302109]


portfolio before change:  [-0.23142648]
curr_Stock_Price:  101.14085187562196
curr_Factors:  [101.14085188]
mat_Sqrt:  [[0.15]]
grads:  [0.10696851]
Stock Position:  0.10696850978965292
Bond Position:  [-11.05031268]


portfolio before change:  [-0.11651641]
curr_Stock_Price:  102.26675896176236
curr_Factors:  [102.26675896]
mat_Sqrt:  [[0.15]]
grads:  [0.16151435]
Stock Position:  0.1615143472748982
Bond Position:  [-16.63406523]


portfolio before change:  [0.22735927]
curr_Stock_Price:  104.44733798208178
curr_Factors:  [104.44733798]
mat_Sqrt:  [[0.15]]
grads:  [0.00926826]
Stock Position:  0.009268257423058153
Bond Position:  [-0.74068554]


portfolio before change:  [0.22188247]
curr_Stock_Price:  103.89638620567224
curr_Factors:  [103.89638621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.22188247]
Stock Price:  104.55050015108631
PL:  [-4.32861768]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 7.23658092e-03]
 [ 4.76998487e-03]
 [-1.05347647e-05]
 [-6.61289295e-03]
 [ 9.03661909e-03]
 [ 1.63828973e-02]
 [ 1.36359732e-02]
 [ 1.17332522e-02]
 [-4.43102772e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.65138897]
curr_Stock_Price:  100.40868328561345
curr_Factors:  [100.40868329]
mat_Sqrt:  [[0.15]]
grads:  [0.04824387]
Stock Position:  0.04824387278474003
Bond Position:  [2.80728522]


portfolio before change:  [7.58907745]
curr_Stock_Price:  99.08798691917426
curr_Factors:  [99.08798692]
mat_Sqrt:  [[0.15]]
grads:  [0.0317999]
Stock Position:  0.03179989915443822
Bond Position:  [4.43808946]


portfolio before change:  [7.64741062]
curr_Stock_Price:  100.85257026004705
curr_Factors:  [100.85257026]
mat_Sqrt:  [[0.15]]
grads:  [-7.02317647e-05]
Stock Position:  -7.023176469641661e-05
Bond Position:  [7.65449368]


portfolio before change:  [7.65126553]
curr_Stock_Price:  100.47244196658356
curr_Factors:  [100.47244197]
mat_Sqrt:  [[0.15]]
grads:  [-0.04408595]
Stock Position:  -0.0440859530147751
Bond Position:  [12.08068888]


portfolio before change:  [7.74780903]
curr_Stock_Price:  98.41959648669076
curr_Factors:  [98.41959649]
mat_Sqrt:  [[0.15]]
grads:  [0.06024413]
Stock Position:  0.06024412724950821
Bond Position:  [1.81860633]


portfolio before change:  [7.67410482]
curr_Stock_Price:  97.18107344681592
curr_Factors:  [97.18107345]
mat_Sqrt:  [[0.15]]
grads:  [0.10921932]
Stock Position:  0.1092193155667473
Bond Position:  [-2.93994551]


portfolio before change:  [7.73395108]
curr_Stock_Price:  97.74248151070238
curr_Factors:  [97.74248151]
mat_Sqrt:  [[0.15]]
grads:  [0.09090649]
Stock Position:  0.09090648827041654
Bond Position:  [-1.15147466]


portfolio before change:  [7.47767247]
curr_Stock_Price:  94.92967089911278
curr_Factors:  [94.9296709]
mat_Sqrt:  [[0.15]]
grads:  [0.07822168]
Stock Position:  0.07822168109393846
Bond Position:  [0.05211403]


portfolio before change:  [7.49842672]
curr_Stock_Price:  95.19466375015274
curr_Factors:  [95.19466375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.49842672]
Stock Price:  94.95789573046136
PL:  [7.49842672]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.85897289e-03]
 [ 6.88092231e-03]
 [ 1.38656629e-03]
 [-5.77492303e-03]
 [ 9.26683904e-03]
 [ 1.63395357e-02]
 [ 1.19407828e-02]
 [ 3.47565930e-03]
 [-6.29750710e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [50.96801813]
curr_Stock_Price:  103.22982516722361
curr_Factors:  [103.22982517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01905982]
Stock Position:  -0.019059819238872365
Bond Position:  [52.93555994]


portfolio before change:  [51.01550288]
curr_Stock_Price:  102.12748757087046
curr_Factors:  [102.12748757]
mat_Sqrt:  [[0.15]]
grads:  [0.04587282]
Stock Position:  0.045872815407780994
Bond Position:  [46.3306275]


portfolio before change:  [50.9465716]
curr_Stock_Price:  100.11971044153694
curr_Factors:  [100.11971044]
mat_Sqrt:  [[0.15]]
grads:  [0.00924378]
Stock Position:  0.009243775273631292
Bond Position:  [50.0210875]


portfolio before change:  [50.96924976]
curr_Stock_Price:  99.86671479491612
curr_Factors:  [99.86671479]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849949]
Stock Position:  -0.03849948686288871
Bond Position:  [54.81406704]


portfolio before change:  [51.04189749]
curr_Stock_Price:  98.69179409005417
curr_Factors:  [98.69179409]
mat_Sqrt:  [[0.15]]
grads:  [0.06177893]
Stock Position:  0.06177892695909823
Bond Position:  [44.94482435]


portfolio before change:  [50.99778832]
curr_Stock_Price:  97.613963763271
curr_Factors:  [97.61396376]
mat_Sqrt:  [[0.15]]
grads:  [0.10893024]
Stock Position:  0.1089302377771266
Bond Position:  [40.36467604]


portfolio before change:  [50.71439165]
curr_Stock_Price:  94.82700522562389
curr_Factors:  [94.82700523]
mat_Sqrt:  [[0.15]]
grads:  [0.07960522]
Stock Position:  0.0796052188139307
Bond Position:  [43.16566715]


portfolio before change:  [50.95447725]
curr_Stock_Price:  97.57176705771661
curr_Factors:  [97.57176706]
mat_Sqrt:  [[0.15]]
grads:  [0.02317106]
Stock Position:  0.023171062030602083
Bond Position:  [48.69363578]


portfolio before change:  [50.97820945]
curr_Stock_Price:  97.54497913781852
curr_Factors:  [97.54497914]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [50.97820945]
Stock Price:  97.38471222453022
PL:  [50.97820945]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.39487761e-02]
 [ 1.51107743e-03]
 [ 3.00857955e-03]
 [-4.87052298e-03]
 [ 1.62251577e-02]
 [ 1.67717429e-02]
 [ 8.80069198e-03]
 [ 2.14077531e-02]
 [-3.77657037e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-31.25731947]
curr_Stock_Price:  97.87462213981335
curr_Factors:  [97.87462214]
mat_Sqrt:  [[0.15]]
grads:  [-0.15965851]
Stock Position:  -0.15965850745527113
Bond Position:  [-15.63080338]


portfolio before change:  [-30.88033618]
curr_Stock_Price:  95.46447403835754
curr_Factors:  [95.46447404]
mat_Sqrt:  [[0.15]]
grads:  [0.01007385]
Stock Position:  0.010073849511805141
Bond Position:  [-31.84203092]


portfolio before change:  [-30.90421659]
curr_Stock_Price:  94.67476401585681
curr_Factors:  [94.67476402]
mat_Sqrt:  [[0.15]]
grads:  [0.0200572]
Stock Position:  0.02005719700947294
Bond Position:  [-32.80312699]


portfolio before change:  [-30.8944414]
curr_Stock_Price:  95.9800740705063
curr_Factors:  [95.98007407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247015]
Stock Position:  -0.03247015318743693
Bond Position:  [-27.77795369]


portfolio before change:  [-30.82078619]
curr_Stock_Price:  93.28382388945153
curr_Factors:  [93.28382389]
mat_Sqrt:  [[0.15]]
grads:  [0.10816772]
Stock Position:  0.1081677179327753
Bond Position:  [-40.91108454]


portfolio before change:  [-31.06900887]
curr_Stock_Price:  91.17818623549013
curr_Factors:  [91.17818624]
mat_Sqrt:  [[0.15]]
grads:  [0.11181162]
Stock Position:  0.11181161938490936
Bond Position:  [-41.26378952]


portfolio before change:  [-31.00822682]
curr_Stock_Price:  91.90636725062724
curr_Factors:  [91.90636725]
mat_Sqrt:  [[0.15]]
grads:  [0.05867128]
Stock Position:  0.05867127985911349
Bond Position:  [-36.40049102]


portfolio before change:  [-31.01005342]
curr_Stock_Price:  92.18551908922862
curr_Factors:  [92.18551909]
mat_Sqrt:  [[0.15]]
grads:  [0.14271835]
Stock Position:  0.14271835385349482
Bond Position:  [-44.16661896]


portfolio before change:  [-30.77946588]
curr_Stock_Price:  93.95597374990813
curr_Factors:  [93.95597375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-30.77946588]
Stock Price:  91.92965509060545
PL:  [-30.77946588]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.93993828e-03]
 [ 3.33766498e-03]
 [ 1.92044703e-03]
 [-4.87310878e-03]
 [ 1.09149662e-02]
 [ 1.59247254e-02]
 [ 2.48185715e-02]
 [ 1.77803722e-03]
 [ 8.96350170e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.53706432]
curr_Stock_Price:  100.79200778651925
curr_Factors:  [100.79200779]
mat_Sqrt:  [[0.15]]
grads:  [0.03293292]
Stock Position:  0.03293292183462052
Bond Position:  [10.21768901]


portfolio before change:  [13.44217271]
curr_Stock_Price:  97.75547988901462
curr_Factors:  [97.75547989]
mat_Sqrt:  [[0.15]]
grads:  [0.0222511]
Stock Position:  0.022251099837749456
Bond Position:  [11.26700577]


portfolio before change:  [13.4140785]
curr_Stock_Price:  96.23963933574082
curr_Factors:  [96.23963934]
mat_Sqrt:  [[0.15]]
grads:  [0.01280298]
Stock Position:  0.012802980178984066
Bond Position:  [12.18192431]


portfolio before change:  [13.41640865]
curr_Stock_Price:  95.94577502283843
curr_Factors:  [95.94577502]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248739]
Stock Position:  -0.03248739183555874
Bond Position:  [16.53343664]


portfolio before change:  [13.32116474]
curr_Stock_Price:  99.13201713136914
curr_Factors:  [99.13201713]
mat_Sqrt:  [[0.15]]
grads:  [0.07276644]
Stock Position:  0.07276644121048895
Bond Position:  [6.10768064]


portfolio before change:  [13.38633511]
curr_Stock_Price:  99.98564924900198
curr_Factors:  [99.98564925]
mat_Sqrt:  [[0.15]]
grads:  [0.10616484]
Stock Position:  0.10616483583507133
Bond Position:  [2.77137508]


portfolio before change:  [13.57754047]
curr_Stock_Price:  101.77361716719467
curr_Factors:  [101.77361717]
mat_Sqrt:  [[0.15]]
grads:  [0.16545714]
Stock Position:  0.16545714362297811
Bond Position:  [-3.26163152]


portfolio before change:  [13.64081692]
curr_Stock_Price:  102.16591013986724
curr_Factors:  [102.16591014]
mat_Sqrt:  [[0.15]]
grads:  [0.01185358]
Stock Position:  0.011853581455821854
Bond Position:  [12.42978498]


portfolio before change:  [13.68696164]
curr_Stock_Price:  105.53436684211123
curr_Factors:  [105.53436684]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.68696164]
Stock Price:  107.56587496406526
PL:  [6.12108668]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.27338174e-03]
 [ 5.48872191e-03]
 [-9.71212800e-04]
 [-8.84233005e-03]
 [ 6.08310734e-03]
 [ 1.64353750e-02]
 [ 1.71014266e-02]
 [ 1.35740380e-03]
 [-5.51800983e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.92836712]
curr_Stock_Price:  101.33851974332127
curr_Factors:  [101.33851974]
mat_Sqrt:  [[0.15]]
grads:  [0.01515588]
Stock Position:  0.015155878294415791
Bond Position:  [20.39249285]


portfolio before change:  [21.90921117]
curr_Stock_Price:  99.40166405935416
curr_Factors:  [99.40166406]
mat_Sqrt:  [[0.15]]
grads:  [0.03659148]
Stock Position:  0.03659147938973974
Bond Position:  [18.27195723]


portfolio before change:  [22.02630005]
curr_Stock_Price:  102.35182132680592
curr_Factors:  [102.35182133]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647475]
Stock Position:  -0.006474751999507092
Bond Position:  [22.68900271]


portfolio before change:  [22.037264]
curr_Stock_Price:  102.41103457311306
curr_Factors:  [102.41103457]
mat_Sqrt:  [[0.15]]
grads:  [-0.05894887]
Stock Position:  -0.05894886703066851
Bond Position:  [28.07427846]


portfolio before change:  [21.99974995]
curr_Stock_Price:  103.28560102301758
curr_Factors:  [103.28560102]
mat_Sqrt:  [[0.15]]
grads:  [0.04055405]
Stock Position:  0.04055404890045324
Bond Position:  [17.81110063]


portfolio before change:  [22.01219103]
curr_Stock_Price:  103.37272689162974
curr_Factors:  [103.37272689]
mat_Sqrt:  [[0.15]]
grads:  [0.10956917]
Stock Position:  0.1095691668748224
Bond Position:  [10.68572747]


portfolio before change:  [22.16875242]
curr_Stock_Price:  104.75283406983135
curr_Factors:  [104.75283407]
mat_Sqrt:  [[0.15]]
grads:  [0.11400951]
Stock Position:  0.11400951079105326
Bond Position:  [10.22593306]


portfolio before change:  [22.1659212]
curr_Stock_Price:  104.68314279258338
curr_Factors:  [104.68314279]
mat_Sqrt:  [[0.15]]
grads:  [0.00904936]
Stock Position:  0.009049358692917373
Bond Position:  [21.21860589]


portfolio before change:  [22.13597655]
curr_Stock_Price:  100.20143229095444
curr_Factors:  [100.20143229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.13597655]
Stock Price:  100.82816237744971
PL:  [21.30781417]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.88559946e-03]
 [ 3.71820728e-03]
 [ 1.59472411e-03]
 [-4.73676513e-03]
 [ 1.21775067e-02]
 [ 1.65392558e-02]
 [ 1.24068520e-02]
 [ 9.02759296e-03]
 [-4.86450819e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.48516579]
curr_Stock_Price:  98.57619505764286
curr_Factors:  [98.57619506]
mat_Sqrt:  [[0.15]]
grads:  [0.01257066]
Stock Position:  0.012570663072105267
Bond Position:  [-21.72433392]


portfolio before change:  [-20.5003721]
curr_Stock_Price:  98.2308330248107
curr_Factors:  [98.23083302]
mat_Sqrt:  [[0.15]]
grads:  [0.02478805]
Stock Position:  0.02478804853534564
Bond Position:  [-22.93532276]


portfolio before change:  [-20.49032656]
curr_Stock_Price:  99.09883483033967
curr_Factors:  [99.09883483]
mat_Sqrt:  [[0.15]]
grads:  [0.01063149]
Stock Position:  0.010631494054592452
Bond Position:  [-21.54389523]


portfolio before change:  [-20.5153957]
curr_Stock_Price:  97.75429167177346
curr_Factors:  [97.75429167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03157843]
Stock Position:  -0.03157843417482983
Bond Position:  [-17.42846824]


portfolio before change:  [-20.44764217]
curr_Stock_Price:  95.3327041400978
curr_Factors:  [95.33270414]
mat_Sqrt:  [[0.15]]
grads:  [0.08118338]
Stock Position:  0.08118337792185229
Bond Position:  [-28.18707312]


portfolio before change:  [-20.44668771]
curr_Stock_Price:  95.51810563935838
curr_Factors:  [95.51810564]
mat_Sqrt:  [[0.15]]
grads:  [0.11026171]
Stock Position:  0.11026170562269719
Bond Position:  [-30.97867696]


portfolio before change:  [-20.49724771]
curr_Stock_Price:  95.2000732759439
curr_Factors:  [95.20007328]
mat_Sqrt:  [[0.15]]
grads:  [0.08271235]
Stock Position:  0.08271234697212962
Bond Position:  [-28.37146921]


portfolio before change:  [-20.47032464]
curr_Stock_Price:  95.69712543438489
curr_Factors:  [95.69712543]
mat_Sqrt:  [[0.15]]
grads:  [0.06018395]
Stock Position:  0.060183953064099016
Bond Position:  [-26.22975595]


portfolio before change:  [-20.46430516]
curr_Stock_Price:  96.01511127420393
curr_Factors:  [96.01511127]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.46430516]
Stock Price:  97.50588251911664
PL:  [-20.46430516]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.72645427e-02]
 [ 6.91504818e-03]
 [ 2.22229731e-03]
 [-5.88461947e-03]
 [ 1.27801135e-02]
 [ 1.63186021e-02]
 [ 1.32656807e-02]
 [ 9.21095823e-03]
 [-4.98222377e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.45933846]
curr_Stock_Price:  99.48967446871819
curr_Factors:  [99.48967447]
mat_Sqrt:  [[0.15]]
grads:  [0.18176362]
Stock Position:  0.18176361784137046
Bond Position:  [-24.54294163]


portfolio before change:  [-6.24665118]
curr_Stock_Price:  100.7273358885209
curr_Factors:  [100.72733589]
mat_Sqrt:  [[0.15]]
grads:  [0.04610032]
Stock Position:  0.04610032118760421
Bond Position:  [-10.89021372]


portfolio before change:  [-6.31096525]
curr_Stock_Price:  99.45039031871745
curr_Factors:  [99.45039032]
mat_Sqrt:  [[0.15]]
grads:  [0.01481532]
Stock Position:  0.014815315424461708
Bond Position:  [-7.78435415]


portfolio before change:  [-6.307638]
curr_Stock_Price:  99.93775106056471
curr_Factors:  [99.93775106]
mat_Sqrt:  [[0.15]]
grads:  [-0.0392308]
Stock Position:  -0.03923079647123537
Bond Position:  [-2.38700043]


portfolio before change:  [-6.36305504]
curr_Stock_Price:  101.31991131053259
curr_Factors:  [101.31991131]
mat_Sqrt:  [[0.15]]
grads:  [0.08520076]
Stock Position:  0.0852007569287705
Bond Position:  [-14.99558818]


portfolio before change:  [-6.6676875]
curr_Stock_Price:  97.83246828288381
curr_Factors:  [97.83246828]
mat_Sqrt:  [[0.15]]
grads:  [0.10879068]
Stock Position:  0.10879068063231241
Bond Position:  [-17.31094831]


portfolio before change:  [-6.8879365]
curr_Stock_Price:  95.88752810322143
curr_Factors:  [95.8875281]
mat_Sqrt:  [[0.15]]
grads:  [0.08843787]
Stock Position:  0.0884378714427757
Bond Position:  [-15.36802539]


portfolio before change:  [-6.917061]
curr_Stock_Price:  95.6451142610846
curr_Factors:  [95.64511426]
mat_Sqrt:  [[0.15]]
grads:  [0.06140639]
Stock Position:  0.06140638821222248
Bond Position:  [-12.79028202]


portfolio before change:  [-6.88705621]
curr_Stock_Price:  96.23791130671331
curr_Factors:  [96.23791131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.88705621]
Stock Price:  97.84922047853073
PL:  [-6.88705621]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 6.88869972e-03]
 [ 7.04415677e-03]
 [ 2.16913419e-03]
 [-6.40847000e-03]
 [ 9.00730453e-03]
 [ 1.62836214e-02]
 [ 1.69828195e-02]
 [ 3.59888355e-03]
 [-4.19402229e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.14554354]
curr_Stock_Price:  100.44086677256858
curr_Factors:  [100.44086677]
mat_Sqrt:  [[0.15]]
grads:  [0.04592466]
Stock Position:  0.04592466477274749
Bond Position:  [3.53283041]


portfolio before change:  [8.18971629]
curr_Stock_Price:  101.36424626589535
curr_Factors:  [101.36424627]
mat_Sqrt:  [[0.15]]
grads:  [0.04696105]
Stock Position:  0.04696104510192335
Bond Position:  [3.42954535]


portfolio before change:  [8.10634578]
curr_Stock_Price:  99.55241018917961
curr_Factors:  [99.55241019]
mat_Sqrt:  [[0.15]]
grads:  [0.01446089]
Stock Position:  0.014460894587956866
Bond Position:  [6.66672887]


portfolio before change:  [8.12062353]
curr_Stock_Price:  100.30917898723527
curr_Factors:  [100.30917899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04272313]
Stock Position:  -0.042723133335522384
Bond Position:  [12.40614596]


portfolio before change:  [8.20903781]
curr_Stock_Price:  98.38493679673213
curr_Factors:  [98.3849368]
mat_Sqrt:  [[0.15]]
grads:  [0.0600487]
Stock Position:  0.06004869686575133
Bond Position:  [2.30115056]


portfolio before change:  [8.19390468]
curr_Stock_Price:  98.11375695176399
curr_Factors:  [98.11375695]
mat_Sqrt:  [[0.15]]
grads:  [0.10855748]
Stock Position:  0.10855747607561884
Bond Position:  [-2.45707715]


portfolio before change:  [8.30311912]
curr_Stock_Price:  99.13112854737929
curr_Factors:  [99.13112855]
mat_Sqrt:  [[0.15]]
grads:  [0.1132188]
Stock Position:  0.11321879658936425
Bond Position:  [-2.92038796]


portfolio before change:  [8.28682692]
curr_Stock_Price:  99.00012873118249
curr_Factors:  [99.00012873]
mat_Sqrt:  [[0.15]]
grads:  [0.02399256]
Stock Position:  0.02399255699928457
Bond Position:  [5.91156069]


portfolio before change:  [8.34847979]
curr_Stock_Price:  101.44656865346685
curr_Factors:  [101.44656865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.34847979]
Stock Price:  102.34740630555862
PL:  [6.00107349]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 8.55205692e-03]
 [ 5.08794611e-03]
 [ 1.24824135e-03]
 [-4.71579318e-03]
 [ 1.02246910e-02]
 [ 1.61230561e-02]
 [ 1.74227228e-02]
 [ 3.53338616e-03]
 [-4.57230048e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.75586355]
curr_Stock_Price:  98.75395009059831
curr_Factors:  [98.75395009]
mat_Sqrt:  [[0.15]]
grads:  [0.05701371]
Stock Position:  0.057013712807551103
Bond Position:  [-23.3861929]


portfolio before change:  [-17.74262561]
curr_Stock_Price:  99.19128276472247
curr_Factors:  [99.19128276]
mat_Sqrt:  [[0.15]]
grads:  [0.03391964]
Stock Position:  0.033919640727417266
Bond Position:  [-21.10715829]


portfolio before change:  [-17.71949344]
curr_Stock_Price:  100.18446504126129
curr_Factors:  [100.18446504]
mat_Sqrt:  [[0.15]]
grads:  [0.00832161]
Stock Position:  0.008321609013530427
Bond Position:  [-18.55318939]


portfolio before change:  [-17.7466804]
curr_Stock_Price:  98.0324719163674
curr_Factors:  [98.03247192]
mat_Sqrt:  [[0.15]]
grads:  [-0.03143862]
Stock Position:  -0.03143862121566465
Bond Position:  [-14.66467465]


portfolio before change:  [-17.70021454]
curr_Stock_Price:  96.32119981067756
curr_Factors:  [96.32119981]
mat_Sqrt:  [[0.15]]
grads:  [0.06816461]
Stock Position:  0.06816460668530198
Bond Position:  [-24.26591124]


portfolio before change:  [-17.5503809]
curr_Stock_Price:  98.69735415059293
curr_Factors:  [98.69735415]
mat_Sqrt:  [[0.15]]
grads:  [0.10748704]
Stock Position:  0.10748704094416688
Bond Position:  [-28.15906745]


portfolio before change:  [-17.50081058]
curr_Stock_Price:  99.2895499834579
curr_Factors:  [99.28954998]
mat_Sqrt:  [[0.15]]
grads:  [0.11615149]
Stock Position:  0.11615148549210609
Bond Position:  [-29.0334393]


portfolio before change:  [-17.6309065]
curr_Stock_Price:  98.29450826312309
curr_Factors:  [98.29450826]
mat_Sqrt:  [[0.15]]
grads:  [0.02355591]
Stock Position:  0.023555907743020306
Bond Position:  [-19.94632287]


portfolio before change:  [-17.70760327]
curr_Stock_Price:  95.46205039404012
curr_Factors:  [95.46205039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.70760327]
Stock Price:  95.47659031387577
PL:  [-17.70760327]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.60322830e-03]
 [ 3.45644393e-03]
 [ 8.11856060e-04]
 [-4.92990139e-03]
 [ 1.36931108e-02]
 [ 1.66157213e-02]
 [ 1.00698439e-02]
 [ 1.20955496e-02]
 [-3.33133646e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.32550539]
curr_Stock_Price:  98.78197862050632
curr_Factors:  [98.78197862]
mat_Sqrt:  [[0.15]]
grads:  [0.06402152]
Stock Position:  0.06402152197054761
Bond Position:  [-23.649678]


portfolio before change:  [-17.39351333]
curr_Stock_Price:  97.9044589446146
curr_Factors:  [97.90445894]
mat_Sqrt:  [[0.15]]
grads:  [0.02304296]
Stock Position:  0.02304295955859779
Bond Position:  [-19.64952182]


portfolio before change:  [-17.40496559]
curr_Stock_Price:  97.83393654206186
curr_Factors:  [97.83393654]
mat_Sqrt:  [[0.15]]
grads:  [0.00541237]
Stock Position:  0.005412373732616891
Bond Position:  [-17.93447942]


portfolio before change:  [-17.43075337]
curr_Stock_Price:  94.7265566775167
curr_Factors:  [94.72655668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286601]
Stock Position:  -0.03286600925700915
Bond Position:  [-14.31746949]


portfolio before change:  [-17.43262129]
curr_Stock_Price:  94.56552057793647
curr_Factors:  [94.56552058]
mat_Sqrt:  [[0.15]]
grads:  [0.09128741]
Stock Position:  0.09128740527319343
Bond Position:  [-26.06526229]


portfolio before change:  [-17.48471899]
curr_Stock_Price:  94.13762128343335
curr_Factors:  [94.13762128]
mat_Sqrt:  [[0.15]]
grads:  [0.11077148]
Stock Position:  0.11077147538356964
Bond Position:  [-27.91248219]


portfolio before change:  [-17.59560422]
curr_Stock_Price:  93.26261715549705
curr_Factors:  [93.26261716]
mat_Sqrt:  [[0.15]]
grads:  [0.06713229]
Stock Position:  0.06713229237481079
Bond Position:  [-23.8565375]


portfolio before change:  [-17.50252118]
curr_Stock_Price:  94.82690598070678
curr_Factors:  [94.82690598]
mat_Sqrt:  [[0.15]]
grads:  [0.080637]
Stock Position:  0.08063699765540597
Bond Position:  [-25.14907817]


portfolio before change:  [-17.65328047]
curr_Stock_Price:  93.11328051499687
curr_Factors:  [93.11328051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.65328047]
Stock Price:  91.54401891650666
PL:  [-17.65328047]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [ 0.00483664]
 [ 0.00671856]
 [-0.00578317]
 [-0.00964116]
 [ 0.01226285]
 [ 0.01594639]
 [ 0.01428769]
 [ 0.01062829]
 [-0.00442592]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.66333172]
curr_Stock_Price:  100.93048813717122
curr_Factors:  [100.93048814]
mat_Sqrt:  [[0.15]]
grads:  [0.03224424]
Stock Position:  0.03224424295002466
Bond Position:  [12.40890454]


portfolio before change:  [15.73999326]
curr_Stock_Price:  103.11554595618841
curr_Factors:  [103.11554596]
mat_Sqrt:  [[0.15]]
grads:  [0.0447904]
Stock Position:  0.04479040222016152
Bond Position:  [11.12140648]


portfolio before change:  [15.87102082]
curr_Stock_Price:  105.9167144650232
curr_Factors:  [105.91671447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03855448]
Stock Position:  -0.0385544825948903
Bond Position:  [19.95458494]


portfolio before change:  [15.99068224]
curr_Stock_Price:  103.07186668270414
curr_Factors:  [103.07186668]
mat_Sqrt:  [[0.15]]
grads:  [-0.06427442]
Stock Position:  -0.06427441685594143
Bond Position:  [22.61556636]


portfolio before change:  [16.14779374]
curr_Stock_Price:  100.80345418707942
curr_Factors:  [100.80345419]
mat_Sqrt:  [[0.15]]
grads:  [0.08175231]
Stock Position:  0.0817523062963462
Bond Position:  [7.90687888]


portfolio before change:  [16.1115976]
curr_Stock_Price:  100.31232959596973
curr_Factors:  [100.3123296]
mat_Sqrt:  [[0.15]]
grads:  [0.10630927]
Stock Position:  0.1063092706450782
Bond Position:  [5.447467]


portfolio before change:  [15.87906137]
curr_Stock_Price:  98.0993462659039
curr_Factors:  [98.09934627]
mat_Sqrt:  [[0.15]]
grads:  [0.09525124]
Stock Position:  0.09525123920797476
Bond Position:  [6.53497707]


portfolio before change:  [15.61026793]
curr_Stock_Price:  95.24309219292634
curr_Factors:  [95.24309219]
mat_Sqrt:  [[0.15]]
grads:  [0.07085524]
Stock Position:  0.07085524074243953
Bond Position:  [8.86179571]


portfolio before change:  [15.61058336]
curr_Stock_Price:  95.18499369069362
curr_Factors:  [95.18499369]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.61058336]
Stock Price:  96.31100340611431
PL:  [15.61058336]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.73856363e-02]
 [ 3.04100870e-03]
 [ 1.37108514e-03]
 [-4.79646985e-03]
 [ 1.49296024e-02]
 [ 1.64835817e-02]
 [ 1.36128463e-02]
 [ 3.50382346e-03]
 [-7.40243078e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.23135833]
curr_Stock_Price:  97.74605618682219
curr_Factors:  [97.74605619]
mat_Sqrt:  [[0.15]]
grads:  [-0.18257091]
Stock Position:  -0.18257090870051715
Bond Position:  [-15.38577203]


portfolio before change:  [-33.17284219]
curr_Stock_Price:  97.38339738662438
curr_Factors:  [97.38339739]
mat_Sqrt:  [[0.15]]
grads:  [0.02027339]
Stock Position:  0.02027339132504094
Bond Position:  [-35.14713392]


portfolio before change:  [-33.19759095]
curr_Stock_Price:  97.02969278998667
curr_Factors:  [97.02969279]
mat_Sqrt:  [[0.15]]
grads:  [0.00914057]
Stock Position:  0.009140567594446076
Bond Position:  [-34.08449741]


portfolio before change:  [-33.21525306]
curr_Stock_Price:  96.96234434729459
curr_Factors:  [96.96234435]
mat_Sqrt:  [[0.15]]
grads:  [-0.03197647]
Stock Position:  -0.03197646567091958
Bond Position:  [-30.11473998]


portfolio before change:  [-33.13365819]
curr_Stock_Price:  93.93962097949218
curr_Factors:  [93.93962098]
mat_Sqrt:  [[0.15]]
grads:  [0.09953068]
Stock Position:  0.09953068233723546
Bond Position:  [-42.48353276]


portfolio before change:  [-32.9323253]
curr_Stock_Price:  96.17591598048159
curr_Factors:  [96.17591598]
mat_Sqrt:  [[0.15]]
grads:  [0.10989054]
Stock Position:  0.10989054494643896
Bond Position:  [-43.50114911]


portfolio before change:  [-32.83525334]
curr_Stock_Price:  97.25724617785288
curr_Factors:  [97.25724618]
mat_Sqrt:  [[0.15]]
grads:  [0.09075231]
Stock Position:  0.09075230885164508
Bond Position:  [-41.66157299]


portfolio before change:  [-32.79554515]
curr_Stock_Price:  97.9243827952248
curr_Factors:  [97.9243828]
mat_Sqrt:  [[0.15]]
grads:  [0.02335882]
Stock Position:  0.023358823090433856
Bond Position:  [-35.08294348]


portfolio before change:  [-32.80201721]
curr_Stock_Price:  98.39845617852255
curr_Factors:  [98.39845618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-32.80201721]
Stock Price:  99.07842977643807
PL:  [-32.80201721]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.12291255e-03]
 [ 3.56537410e-03]
 [ 1.93870916e-03]
 [-4.87178757e-03]
 [ 1.46650613e-02]
 [ 1.66257398e-02]
 [ 1.03434266e-02]
 [ 2.31958906e-02]
 [-2.24729115e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.1262834]
curr_Stock_Price:  98.46931172598707
curr_Factors:  [98.46931173]
mat_Sqrt:  [[0.15]]
grads:  [-0.01415275]
Stock Position:  -0.0141527503001584
Bond Position:  [-20.73267182]


portfolio before change:  [-22.13059175]
curr_Stock_Price:  98.04108510694009
curr_Factors:  [98.04108511]
mat_Sqrt:  [[0.15]]
grads:  [0.02376916]
Stock Position:  0.023769160663336574
Bond Position:  [-24.46094605]


portfolio before change:  [-22.18626839]
curr_Stock_Price:  96.21337602261065
curr_Factors:  [96.21337602]
mat_Sqrt:  [[0.15]]
grads:  [0.01292473]
Stock Position:  0.012924727749357571
Bond Position:  [-23.42980008]


portfolio before change:  [-22.20121838]
curr_Stock_Price:  95.96330004819649
curr_Factors:  [95.96330005]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247858]
Stock Position:  -0.032478583785014614
Bond Position:  [-19.0844663]


portfolio before change:  [-22.14938591]
curr_Stock_Price:  94.07352900986365
curr_Factors:  [94.07352901]
mat_Sqrt:  [[0.15]]
grads:  [0.09776708]
Stock Position:  0.09776707520568302
Bond Position:  [-31.3466797]


portfolio before change:  [-22.17737594]
curr_Stock_Price:  93.94758916856976
curr_Factors:  [93.94758917]
mat_Sqrt:  [[0.15]]
grads:  [0.11083827]
Stock Position:  0.11083826541651007
Bond Position:  [-32.59036377]


portfolio before change:  [-22.23792159]
curr_Stock_Price:  93.54839133181586
curr_Factors:  [93.54839133]
mat_Sqrt:  [[0.15]]
grads:  [0.06895618]
Stock Position:  0.06895617709216673
Bond Position:  [-28.68866103]


portfolio before change:  [-22.38122264]
curr_Stock_Price:  91.67831764129822
curr_Factors:  [91.67831764]
mat_Sqrt:  [[0.15]]
grads:  [0.15463927]
Stock Position:  0.1546392707985819
Bond Position:  [-36.55829083]


portfolio before change:  [-22.49488899]
curr_Stock_Price:  91.0615103213179
curr_Factors:  [91.06151032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.49488899]
Stock Price:  91.1696974257809
PL:  [-22.49488899]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.67245848e-02]
 [ 6.74990352e-03]
 [ 6.74169085e-04]
 [-4.81238020e-03]
 [ 1.32086563e-02]
 [ 1.63405228e-02]
 [ 1.69420257e-02]
 [ 3.53403295e-03]
 [-7.13664503e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.40996377]
curr_Stock_Price:  98.97186312248833
curr_Factors:  [98.97186312]
mat_Sqrt:  [[0.15]]
grads:  [0.11149723]
Stock Position:  0.11149723180146064
Bond Position:  [-25.44505254]


portfolio before change:  [-14.29363361]
curr_Stock_Price:  100.12934358807415
curr_Factors:  [100.12934359]
mat_Sqrt:  [[0.15]]
grads:  [0.04499936]
Stock Position:  0.044999356811065164
Bond Position:  [-18.79938967]


portfolio before change:  [-14.3974171]
curr_Stock_Price:  98.0319482210946
curr_Factors:  [98.03194822]
mat_Sqrt:  [[0.15]]
grads:  [0.00449446]
Stock Position:  0.004494460569554919
Bond Position:  [-14.83801783]


portfolio before change:  [-14.40125085]
curr_Stock_Price:  98.83006765832148
curr_Factors:  [98.83006766]
mat_Sqrt:  [[0.15]]
grads:  [-0.03208253]
Stock Position:  -0.032082534675996754
Bond Position:  [-11.23053178]


portfolio before change:  [-14.4568599]
curr_Stock_Price:  100.38831059072038
curr_Factors:  [100.38831059]
mat_Sqrt:  [[0.15]]
grads:  [0.08805771]
Stock Position:  0.08805770861052538
Bond Position:  [-23.2968245]


portfolio before change:  [-14.71368167]
curr_Stock_Price:  97.6041086338437
curr_Factors:  [97.60410863]
mat_Sqrt:  [[0.15]]
grads:  [0.10893682]
Stock Position:  0.10893681888768275
Bond Position:  [-25.34636278]


portfolio before change:  [-14.56171061]
curr_Stock_Price:  99.11551141397226
curr_Factors:  [99.11551141]
mat_Sqrt:  [[0.15]]
grads:  [0.11294684]
Stock Position:  0.11294683830353035
Bond Position:  [-25.75649425]


portfolio before change:  [-14.66640717]
curr_Stock_Price:  98.3026060443015
curr_Factors:  [98.30260604]
mat_Sqrt:  [[0.15]]
grads:  [0.02356022]
Stock Position:  0.02356021965486828
Bond Position:  [-16.98243816]


portfolio before change:  [-14.6774792]
curr_Stock_Price:  98.19315509091334
curr_Factors:  [98.19315509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.6774792]
Stock Price:  100.95661713925556
PL:  [-15.63409634]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.93225932e-03]
 [ 7.08172651e-03]
 [-1.17803957e-04]
 [-8.34196201e-03]
 [ 1.35194128e-02]
 [ 1.63083567e-02]
 [ 2.34390239e-02]
 [ 1.83670409e-03]
 [ 1.51967914e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.762129]
curr_Stock_Price:  101.39282130333946
curr_Factors:  [101.3928213]
mat_Sqrt:  [[0.15]]
grads:  [0.01288173]
Stock Position:  0.012881728829098396
Bond Position:  [21.45601417]


portfolio before change:  [22.77022871]
curr_Stock_Price:  101.18858004727073
curr_Factors:  [101.18858005]
mat_Sqrt:  [[0.15]]
grads:  [0.04721151]
Stock Position:  0.04721151005202355
Bond Position:  [17.99296304]


portfolio before change:  [22.78030366]
curr_Stock_Price:  101.21137588488716
curr_Factors:  [101.21137588]
mat_Sqrt:  [[0.15]]
grads:  [-0.00078536]
Stock Position:  -0.0007853597133811767
Bond Position:  [22.859791]


portfolio before change:  [22.79112156]
curr_Stock_Price:  101.9942775121828
curr_Factors:  [101.99427751]
mat_Sqrt:  [[0.15]]
grads:  [-0.05561308]
Stock Position:  -0.055613080094443
Bond Position:  [28.46333748]


portfolio before change:  [22.92270859]
curr_Stock_Price:  99.88412987363533
curr_Factors:  [99.88412987]
mat_Sqrt:  [[0.15]]
grads:  [0.09012942]
Stock Position:  0.09012941854454277
Bond Position:  [13.92021005]


portfolio before change:  [23.18428337]
curr_Stock_Price:  102.7091002331493
curr_Factors:  [102.70910023]
mat_Sqrt:  [[0.15]]
grads:  [0.10872238]
Stock Position:  0.10872237804089502
Bond Position:  [12.01750575]


portfolio before change:  [23.18261668]
curr_Stock_Price:  102.63848967532303
curr_Factors:  [102.63848968]
mat_Sqrt:  [[0.15]]
grads:  [0.15626016]
Stock Position:  0.1562601592454951
Bond Position:  [7.14430994]


portfolio before change:  [23.09315574]
curr_Stock_Price:  102.0431108636597
curr_Factors:  [102.04311086]
mat_Sqrt:  [[0.15]]
grads:  [0.01224469]
Stock Position:  0.012244693930324296
Bond Position:  [21.84366908]


portfolio before change:  [23.12705936]
curr_Stock_Price:  103.91976478404933
curr_Factors:  [103.91976478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.12705936]
Stock Price:  104.03698249929221
PL:  [19.09007686]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.50168573e-02]
 [ 2.11199149e-03]
 [ 1.09680729e-03]
 [-4.71932886e-03]
 [ 1.20363917e-02]
 [ 1.63826790e-02]
 [ 1.36263567e-02]
 [ 3.46849811e-03]
 [-4.92977814e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.67337836]
curr_Stock_Price:  100.01934513955584
curr_Factors:  [100.01934514]
mat_Sqrt:  [[0.15]]
grads:  [0.10011238]
Stock Position:  0.10011238203811389
Bond Position:  [-8.33979653]


portfolio before change:  [1.28866305]
curr_Stock_Price:  96.21817327584805
curr_Factors:  [96.21817328]
mat_Sqrt:  [[0.15]]
grads:  [0.01407994]
Stock Position:  0.0140799432905542
Bond Position:  [-0.06608337]


portfolio before change:  [1.30560994]
curr_Stock_Price:  97.4241398174128
curr_Factors:  [97.42413982]
mat_Sqrt:  [[0.15]]
grads:  [0.00731205]
Stock Position:  0.007312048588022535
Bond Position:  [0.5932399]


portfolio before change:  [1.31474226]
curr_Stock_Price:  98.632505718554
curr_Factors:  [98.63250572]
mat_Sqrt:  [[0.15]]
grads:  [-0.03146219]
Stock Position:  -0.03146219237144188
Bond Position:  [4.41793713]


portfolio before change:  [1.29266773]
curr_Stock_Price:  99.40435456968132
curr_Factors:  [99.40435457]
mat_Sqrt:  [[0.15]]
grads:  [0.08024261]
Stock Position:  0.08024261160128657
Bond Position:  [-6.68379729]


portfolio before change:  [1.11109805]
curr_Stock_Price:  97.1832535295557
curr_Factors:  [97.18325353]
mat_Sqrt:  [[0.15]]
grads:  [0.10921786]
Stock Position:  0.10921785973954201
Bond Position:  [-9.50304891]


portfolio before change:  [1.1550263]
curr_Stock_Price:  97.62897703155777
curr_Factors:  [97.62897703]
mat_Sqrt:  [[0.15]]
grads:  [0.09084238]
Stock Position:  0.09084237792418805
Bond Position:  [-7.71382213]


portfolio before change:  [1.13782657]
curr_Stock_Price:  97.48210883554329
curr_Factors:  [97.48210884]
mat_Sqrt:  [[0.15]]
grads:  [0.02312332]
Stock Position:  0.023123320761488958
Bond Position:  [-1.1162835]


portfolio before change:  [1.106203]
curr_Stock_Price:  96.13864756344225
curr_Factors:  [96.13864756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.106203]
Stock Price:  97.489090667033
PL:  [1.106203]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.62997404e-03]
 [ 6.88238616e-03]
 [ 2.18619583e-03]
 [-4.78820300e-03]
 [ 8.51271081e-03]
 [ 1.60541134e-02]
 [ 2.39806224e-02]
 [ 3.08977735e-03]
 [-4.29546589e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.5009263]
curr_Stock_Price:  101.9619650143675
curr_Factors:  [101.96196501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01086649]
Stock Position:  -0.010866493572364832
Bond Position:  [32.60889534]


portfolio before change:  [31.53138398]
curr_Stock_Price:  100.65987511546209
curr_Factors:  [100.65987512]
mat_Sqrt:  [[0.15]]
grads:  [0.04588257]
Stock Position:  0.045882574382077046
Bond Position:  [26.91284977]


portfolio before change:  [31.49252817]
curr_Stock_Price:  99.51966895689908
curr_Factors:  [99.51966896]
mat_Sqrt:  [[0.15]]
grads:  [0.01457464]
Stock Position:  0.014574638850525594
Bond Position:  [30.04206494]


portfolio before change:  [31.49690097]
curr_Stock_Price:  98.78881074488923
curr_Factors:  [98.78881074]
mat_Sqrt:  [[0.15]]
grads:  [-0.03192135]
Stock Position:  -0.031921353329780106
Bond Position:  [34.6503735]


portfolio before change:  [31.54394329]
curr_Stock_Price:  97.85799786451592
curr_Factors:  [97.85799786]
mat_Sqrt:  [[0.15]]
grads:  [0.05675141]
Stock Position:  0.05675140537356366
Bond Position:  [25.99036439]


portfolio before change:  [31.62102771]
curr_Stock_Price:  98.98723831873201
curr_Factors:  [98.98723832]
mat_Sqrt:  [[0.15]]
grads:  [0.10702742]
Stock Position:  0.10702742289254392
Bond Position:  [21.02667869]


portfolio before change:  [31.89444528]
curr_Stock_Price:  101.44363314711674
curr_Factors:  [101.44363315]
mat_Sqrt:  [[0.15]]
grads:  [0.15987082]
Stock Position:  0.15987081611890963
Bond Position:  [15.67656886]


portfolio before change:  [31.79937617]
curr_Stock_Price:  100.79992993106751
curr_Factors:  [100.79992993]
mat_Sqrt:  [[0.15]]
grads:  [0.02059852]
Stock Position:  0.020598515668685747
Bond Position:  [29.72304723]


portfolio before change:  [31.82619179]
curr_Stock_Price:  101.3800871496198
curr_Factors:  [101.38008715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.82619179]
Stock Price:  102.13066378444898
PL:  [29.695528]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.87708502e-02]
 [ 6.14794157e-03]
 [ 1.83967785e-03]
 [-4.76872978e-03]
 [ 1.04158586e-02]
 [ 1.65061453e-02]
 [ 1.29880802e-02]
 [ 8.53268669e-03]
 [-6.91935697e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.76818298]
curr_Stock_Price:  99.3393031655842
curr_Factors:  [99.33930317]
mat_Sqrt:  [[0.15]]
grads:  [0.19180567]
Stock Position:  0.19180566807258204
Bond Position:  [-27.82202439]


portfolio before change:  [-8.69963875]
curr_Stock_Price:  99.76921081491436
curr_Factors:  [99.76921081]
mat_Sqrt:  [[0.15]]
grads:  [0.04098628]
Stock Position:  0.04098627715362442
Bond Position:  [-12.78880727]


portfolio before change:  [-8.72851319]
curr_Stock_Price:  99.22077253054574
curr_Factors:  [99.22077253]
mat_Sqrt:  [[0.15]]
grads:  [0.01226452]
Stock Position:  0.012264519024073908
Bond Position:  [-9.94540824]


portfolio before change:  [-8.75667288]
curr_Stock_Price:  97.33029970874735
curr_Factors:  [97.33029971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03179153]
Stock Position:  -0.031791531877362444
Bond Position:  [-5.66239355]


portfolio before change:  [-8.72434758]
curr_Stock_Price:  96.22443269063092
curr_Factors:  [96.22443269]
mat_Sqrt:  [[0.15]]
grads:  [0.06943906]
Stock Position:  0.0694390573850894
Bond Position:  [-15.40608148]


portfolio before change:  [-8.75302155]
curr_Stock_Price:  95.92245558028914
curr_Factors:  [95.92245558]
mat_Sqrt:  [[0.15]]
grads:  [0.11004097]
Stock Position:  0.11004096863321866
Bond Position:  [-19.30842148]


portfolio before change:  [-8.79097351]
curr_Stock_Price:  95.66532100437148
curr_Factors:  [95.665321]
mat_Sqrt:  [[0.15]]
grads:  [0.0865872]
Stock Position:  0.08658720121466047
Bond Position:  [-17.07436591]


portfolio before change:  [-8.78460394]
curr_Stock_Price:  95.83750455448356
curr_Factors:  [95.83750455]
mat_Sqrt:  [[0.15]]
grads:  [0.05688458]
Stock Position:  0.056884577957128986
Bond Position:  [-14.23627994]


portfolio before change:  [-8.59239274]
curr_Stock_Price:  99.34163733685229
curr_Factors:  [99.34163734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.59239274]
Stock Price:  100.99317599782417
PL:  [-9.58556874]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.79070197e-03]
 [ 7.01612248e-03]
 [-2.12935275e-04]
 [-9.11358340e-03]
 [ 1.25844974e-02]
 [ 1.64267491e-02]
 [ 2.21619396e-02]
 [ 1.43289530e-03]
 [ 1.84718338e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.66394749]
curr_Stock_Price:  101.25617014136235
curr_Factors:  [101.25617014]
mat_Sqrt:  [[0.15]]
grads:  [0.01860468]
Stock Position:  0.018604679824267466
Bond Position:  [18.78010887]


portfolio before change:  [20.67778934]
curr_Stock_Price:  101.49532718242837
curr_Factors:  [101.49532718]
mat_Sqrt:  [[0.15]]
grads:  [0.04677415]
Stock Position:  0.04677414988965324
Bond Position:  [15.93043169]


portfolio before change:  [20.68735876]
curr_Stock_Price:  101.52958143247652
curr_Factors:  [101.52958143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00141957]
Stock Position:  -0.0014195685015211922
Bond Position:  [20.83148695]


portfolio before change:  [20.69620728]
curr_Stock_Price:  102.63542820146756
curr_Factors:  [102.6354282]
mat_Sqrt:  [[0.15]]
grads:  [-0.06075722]
Stock Position:  -0.06075722263405341
Bond Position:  [26.93205084]


portfolio before change:  [20.77780308]
curr_Stock_Price:  101.514139174748
curr_Factors:  [101.51413917]
mat_Sqrt:  [[0.15]]
grads:  [0.08389665]
Stock Position:  0.08389664961179144
Bond Position:  [12.26110692]


portfolio before change:  [21.07123807]
curr_Stock_Price:  104.93862515534857
curr_Factors:  [104.93862516]
mat_Sqrt:  [[0.15]]
grads:  [0.10951166]
Stock Position:  0.10951166045774735
Bond Position:  [9.57923498]


portfolio before change:  [20.87873459]
curr_Stock_Price:  103.13704267255252
curr_Factors:  [103.13704267]
mat_Sqrt:  [[0.15]]
grads:  [0.14774626]
Stock Position:  0.14774626371384392
Bond Position:  [5.64062189]


portfolio before change:  [21.0298861]
curr_Stock_Price:  104.14099690991162
curr_Factors:  [104.14099691]
mat_Sqrt:  [[0.15]]
grads:  [0.00955264]
Stock Position:  0.009552635301292994
Bond Position:  [20.03506513]


portfolio before change:  [21.0342389]
curr_Stock_Price:  103.5477331155767
curr_Factors:  [103.54773312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.0342389]
Stock Price:  102.78743658361358
PL:  [18.24680232]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.08746721e-03]
 [ 7.00456834e-03]
 [-1.62769607e-03]
 [-1.01469032e-02]
 [ 1.36217112e-03]
 [ 1.64312685e-02]
 [ 9.33768592e-03]
 [ 1.06036146e-02]
 [ 3.81639818e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.54576583]
curr_Stock_Price:  102.42078399965064
curr_Factors:  [102.420784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02058311]
Stock Position:  -0.020583114762236142
Bond Position:  [40.65390458]


portfolio before change:  [38.58403466]
curr_Stock_Price:  101.54935131791478
curr_Factors:  [101.54935132]
mat_Sqrt:  [[0.15]]
grads:  [0.04669712]
Stock Position:  0.04669712226018211
Bond Position:  [33.84197219]


portfolio before change:  [38.65800701]
curr_Stock_Price:  102.77099250561814
curr_Factors:  [102.77099251]
mat_Sqrt:  [[0.15]]
grads:  [-0.01085131]
Stock Position:  -0.0108513071277657
Bond Position:  [39.77320661]


portfolio before change:  [38.67009381]
curr_Stock_Price:  103.49023934485766
curr_Factors:  [103.49023934]
mat_Sqrt:  [[0.15]]
grads:  [-0.06764602]
Stock Position:  -0.06764602127027497
Bond Position:  [45.67079675]


portfolio before change:  [38.62227885]
curr_Stock_Price:  104.5347364195439
curr_Factors:  [104.53473642]
mat_Sqrt:  [[0.15]]
grads:  [0.00908114]
Stock Position:  0.009081140787348108
Bond Position:  [37.67298419]


portfolio before change:  [38.63733738]
curr_Stock_Price:  104.11819482339322
curr_Factors:  [104.11819482]
mat_Sqrt:  [[0.15]]
grads:  [0.10954179]
Stock Position:  0.10954179013471524
Bond Position:  [27.23204393]


portfolio before change:  [38.9918598]
curr_Stock_Price:  107.23027642282233
curr_Factors:  [107.23027642]
mat_Sqrt:  [[0.15]]
grads:  [0.06225124]
Stock Position:  0.06225123948627774
Bond Position:  [32.31664218]


portfolio before change:  [39.35312684]
curr_Stock_Price:  112.77401630429479
curr_Factors:  [112.7740163]
mat_Sqrt:  [[0.15]]
grads:  [0.07069076]
Stock Position:  0.07069076377797785
Bond Position:  [31.38104549]


portfolio before change:  [39.23686053]
curr_Stock_Price:  110.90728373528825
curr_Factors:  [110.90728374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.23686053]
Stock Price:  109.32446183821702
PL:  [29.91239869]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.66509537e-02]
 [ 2.05404355e-03]
 [ 2.88868573e-03]
 [-4.80362992e-03]
 [ 1.09628679e-02]
 [ 1.66301911e-02]
 [ 1.15846400e-02]
 [ 2.09446777e-02]
 [-2.33761580e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.76389826]
curr_Stock_Price:  99.53496736207693
curr_Factors:  [99.53496736]
mat_Sqrt:  [[0.15]]
grads:  [0.17767302]
Stock Position:  0.17767302459667367
Bond Position:  [-23.44857697]


portfolio before change:  [-6.37784386]
curr_Stock_Price:  96.14549179524852
curr_Factors:  [96.1454918]
mat_Sqrt:  [[0.15]]
grads:  [0.01369362]
Stock Position:  0.013693623638394934
Bond Position:  [-7.69442404]


portfolio before change:  [-6.39947053]
curr_Stock_Price:  94.84718683516635
curr_Factors:  [94.84718684]
mat_Sqrt:  [[0.15]]
grads:  [0.0192579]
Stock Position:  0.019257904885747416
Bond Position:  [-8.22602863]


portfolio before change:  [-6.36468007]
curr_Stock_Price:  96.86737030768187
curr_Factors:  [96.86737031]
mat_Sqrt:  [[0.15]]
grads:  [-0.0320242]
Stock Position:  -0.03202419947581829
Bond Position:  [-3.26258008]


portfolio before change:  [-6.33685501]
curr_Stock_Price:  95.94754206664945
curr_Factors:  [95.94754207]
mat_Sqrt:  [[0.15]]
grads:  [0.07308579]
Stock Position:  0.07308578624637632
Bond Position:  [-13.34925656]


portfolio before change:  [-6.49587022]
curr_Stock_Price:  93.86315714205325
curr_Factors:  [93.86315714]
mat_Sqrt:  [[0.15]]
grads:  [0.11086794]
Stock Position:  0.11086794049451633
Bond Position:  [-16.90228514]


portfolio before change:  [-6.42906949]
curr_Stock_Price:  94.54192846720397
curr_Factors:  [94.54192847]
mat_Sqrt:  [[0.15]]
grads:  [0.07723093]
Stock Position:  0.07723093341861285
Bond Position:  [-13.73063088]


portfolio before change:  [-6.60777991]
curr_Stock_Price:  92.31686944221964
curr_Factors:  [92.31686944]
mat_Sqrt:  [[0.15]]
grads:  [0.13963118]
Stock Position:  0.1396311847314367
Bond Position:  [-19.49809376]


portfolio before change:  [-6.76894771]
curr_Stock_Price:  91.23246759367726
curr_Factors:  [91.23246759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.76894771]
Stock Price:  92.46466954299449
PL:  [-6.76894771]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.19502846e-02]
 [ 2.27790620e-03]
 [ 1.01194222e-03]
 [-4.72442443e-03]
 [ 9.84469121e-03]
 [ 1.65694601e-02]
 [ 1.13006785e-02]
 [ 1.24164601e-02]
 [-4.63491518e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.14968993]
curr_Stock_Price:  98.20727377732787
curr_Factors:  [98.20727378]
mat_Sqrt:  [[0.15]]
grads:  [-0.07966856]
Stock Position:  -0.07966856378350355
Bond Position:  [-18.32565747]


portfolio before change:  [-26.01696524]
curr_Stock_Price:  96.42627256042881
curr_Factors:  [96.42627256]
mat_Sqrt:  [[0.15]]
grads:  [0.01518604]
Stock Position:  0.01518604133053239
Bond Position:  [-27.4812986]


portfolio before change:  [-25.99630956]
curr_Stock_Price:  98.69149517975035
curr_Factors:  [98.69149518]
mat_Sqrt:  [[0.15]]
grads:  [0.00674628]
Stock Position:  0.006746281460838933
Bond Position:  [-26.66211016]


portfolio before change:  [-26.00990931]
curr_Stock_Price:  98.65216000706319
curr_Factors:  [98.65216001]
mat_Sqrt:  [[0.15]]
grads:  [-0.03149616]
Stock Position:  -0.03149616285578048
Bond Position:  [-22.90274481]


portfolio before change:  [-26.02829086]
curr_Stock_Price:  98.87210157792688
curr_Factors:  [98.87210158]
mat_Sqrt:  [[0.15]]
grads:  [0.06563127]
Stock Position:  0.0656312747170548
Bond Position:  [-32.51739292]


portfolio before change:  [-26.29769294]
curr_Stock_Price:  95.01510943927259
curr_Factors:  [95.01510944]
mat_Sqrt:  [[0.15]]
grads:  [0.11046307]
Stock Position:  0.1104630671817484
Bond Position:  [-36.79335335]


portfolio before change:  [-26.39347135]
curr_Stock_Price:  94.31462972166761
curr_Factors:  [94.31462972]
mat_Sqrt:  [[0.15]]
grads:  [0.07533786]
Stock Position:  0.07533785698933035
Bond Position:  [-33.49893344]


portfolio before change:  [-26.37848888]
curr_Stock_Price:  94.73588041415074
curr_Factors:  [94.73588041]
mat_Sqrt:  [[0.15]]
grads:  [0.0827764]
Stock Position:  0.08277640049666711
Bond Position:  [-34.22038406]


portfolio before change:  [-26.32568372]
curr_Stock_Price:  95.58056109723444
curr_Factors:  [95.5805611]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.32568372]
Stock Price:  95.95726822839399
PL:  [-26.32568372]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.10531819e-02]
 [ 7.05472196e-03]
 [-1.03877391e-04]
 [-6.70324549e-03]
 [ 1.14101614e-02]
 [ 1.62476620e-02]
 [ 2.46146864e-02]
 [ 3.59089202e-03]
 [-4.74896024e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-35.33789661]
curr_Stock_Price:  97.60886076151907
curr_Factors:  [97.60886076]
mat_Sqrt:  [[0.15]]
grads:  [-0.20702121]
Stock Position:  -0.20702121269175974
Bond Position:  [-15.13079188]


portfolio before change:  [-36.11268149]
curr_Stock_Price:  101.3148461775524
curr_Factors:  [101.31484618]
mat_Sqrt:  [[0.15]]
grads:  [0.04703148]
Stock Position:  0.04703147976351417
Bond Position:  [-40.87766863]


portfolio before change:  [-36.14018267]
curr_Stock_Price:  101.16479279756237
curr_Factors:  [101.1647928]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069252]
Stock Position:  -0.0006925159412222544
Bond Position:  [-36.07012444]


portfolio before change:  [-36.15781089]
curr_Stock_Price:  100.5707922289548
curr_Factors:  [100.57079223]
mat_Sqrt:  [[0.15]]
grads:  [-0.0446883]
Stock Position:  -0.04468830329646073
Bond Position:  [-31.66347282]


portfolio before change:  [-36.23863836]
curr_Stock_Price:  102.02512760497288
curr_Factors:  [102.0251276]
mat_Sqrt:  [[0.15]]
grads:  [0.07606774]
Stock Position:  0.0760677423434345
Bond Position:  [-43.99945948]


portfolio before change:  [-36.23135138]
curr_Stock_Price:  102.41020827186196
curr_Factors:  [102.41020827]
mat_Sqrt:  [[0.15]]
grads:  [0.10831775]
Stock Position:  0.10831774635696244
Bond Position:  [-47.32419434]


portfolio before change:  [-36.29345152]
curr_Stock_Price:  102.05539908973695
curr_Factors:  [102.05539909]
mat_Sqrt:  [[0.15]]
grads:  [0.16409791]
Stock Position:  0.16409790958251796
Bond Position:  [-53.04052917]


portfolio before change:  [-36.83226941]
curr_Stock_Price:  98.93353730808892
curr_Factors:  [98.93353731]
mat_Sqrt:  [[0.15]]
grads:  [0.02393928]
Stock Position:  0.02393928010070447
Bond Position:  [-39.20066707]


portfolio before change:  [-36.80854311]
curr_Stock_Price:  100.74359707945072
curr_Factors:  [100.74359708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-36.80854311]
Stock Price:  102.11667184826904
PL:  [-38.92521496]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.11965255e-03]
 [ 5.91000101e-03]
 [ 1.88487378e-03]
 [-4.84800115e-03]
 [ 8.34043298e-03]
 [ 1.65664570e-02]
 [ 9.02289862e-03]
 [ 2.43770079e-02]
 [-2.82863521e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.42220634]
curr_Stock_Price:  100.7193988922026
curr_Factors:  [100.71939889]
mat_Sqrt:  [[0.15]]
grads:  [0.03413102]
Stock Position:  0.03413101703221379
Bond Position:  [8.98455082]


portfolio before change:  [12.38970907]
curr_Stock_Price:  99.63561428976449
curr_Factors:  [99.63561429]
mat_Sqrt:  [[0.15]]
grads:  [0.03940001]
Stock Position:  0.039400006716050935
Bond Position:  [8.4640652]


portfolio before change:  [12.37851501]
curr_Stock_Price:  99.24406229326443
curr_Factors:  [99.24406229]
mat_Sqrt:  [[0.15]]
grads:  [0.01256583]
Stock Position:  0.012565825182572656
Bond Position:  [11.13143147]


portfolio before change:  [12.37964375]
curr_Stock_Price:  98.89085261594943
curr_Factors:  [98.89085262]
mat_Sqrt:  [[0.15]]
grads:  [-0.03232001]
Stock Position:  -0.03232000763471153
Bond Position:  [15.57579686]


portfolio before change:  [12.42631015]
curr_Stock_Price:  97.68798909251122
curr_Factors:  [97.68798909]
mat_Sqrt:  [[0.15]]
grads:  [0.05560289]
Stock Position:  0.05560288650616408
Bond Position:  [6.99457598]


portfolio before change:  [12.28435581]
curr_Stock_Price:  95.07207277914233
curr_Factors:  [95.07207278]
mat_Sqrt:  [[0.15]]
grads:  [0.11044305]
Stock Position:  0.1104430464428905
Bond Position:  [1.78430646]


portfolio before change:  [11.96184339]
curr_Stock_Price:  92.1438232586733
curr_Factors:  [92.14382326]
mat_Sqrt:  [[0.15]]
grads:  [0.06015266]
Stock Position:  0.06015265747896901
Bond Position:  [6.41914755]


portfolio before change:  [11.91689994]
curr_Stock_Price:  91.34329621060941
curr_Factors:  [91.34329621]
mat_Sqrt:  [[0.15]]
grads:  [0.16251339]
Stock Position:  0.16251338603693946
Bond Position:  [-2.92760842]


portfolio before change:  [12.04845667]
curr_Stock_Price:  92.16181896288131
curr_Factors:  [92.16181896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.04845667]
Stock Price:  92.32551923702832
PL:  [12.04845667]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.53794658e-02]
 [ 3.51000286e-03]
 [ 5.00276714e-04]
 [-6.76656405e-03]
 [ 1.27379525e-02]
 [ 1.61007958e-02]
 [ 2.40504177e-02]
 [ 1.52470192e-03]
 [-2.79261423e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-32.07906867]
curr_Stock_Price:  97.82110294585684
curr_Factors:  [97.82110295]
mat_Sqrt:  [[0.15]]
grads:  [-0.16919644]
Stock Position:  -0.1691964389038731
Bond Position:  [-15.5280864]


portfolio before change:  [-32.11230422]
curr_Stock_Price:  97.97163547051942
curr_Factors:  [97.97163547]
mat_Sqrt:  [[0.15]]
grads:  [0.02340002]
Stock Position:  0.023400019044821117
Bond Position:  [-34.40484235]


portfolio before change:  [-32.07112399]
curr_Stock_Price:  100.46680244793262
curr_Factors:  [100.46680245]
mat_Sqrt:  [[0.15]]
grads:  [0.00333518]
Stock Position:  0.003335178094574122
Bond Position:  [-32.40619867]


portfolio before change:  [-32.08675444]
curr_Stock_Price:  100.63971554341016
curr_Factors:  [100.63971554]
mat_Sqrt:  [[0.15]]
grads:  [-0.04511043]
Stock Position:  -0.04511042700895459
Bond Position:  [-27.5468539]


portfolio before change:  [-32.13385293]
curr_Stock_Price:  101.37838334136622
curr_Factors:  [101.37838334]
mat_Sqrt:  [[0.15]]
grads:  [0.08491968]
Stock Position:  0.0849196833699032
Bond Position:  [-40.74287315]


portfolio before change:  [-32.13464167]
curr_Stock_Price:  101.60904590421804
curr_Factors:  [101.6090459]
mat_Sqrt:  [[0.15]]
grads:  [0.10733864]
Stock Position:  0.10733863860705099
Bond Position:  [-43.04121833]


portfolio before change:  [-32.1709726]
curr_Stock_Price:  101.47111851006908
curr_Factors:  [101.47111851]
mat_Sqrt:  [[0.15]]
grads:  [0.16033612]
Stock Position:  0.16033611816288038
Bond Position:  [-48.44045785]


portfolio before change:  [-31.87283277]
curr_Stock_Price:  103.48168307074208
curr_Factors:  [103.48168307]
mat_Sqrt:  [[0.15]]
grads:  [0.01016468]
Stock Position:  0.010164679482458954
Bond Position:  [-32.92469091]


portfolio before change:  [-31.89922849]
curr_Stock_Price:  102.50484311683911
curr_Factors:  [102.50484312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.89922849]
Stock Price:  105.20292336247739
PL:  [-37.10215186]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.83006303e-02]
 [ 7.03702753e-03]
 [-7.63526512e-05]
 [-1.03172523e-02]
 [-1.82476940e-03]
 [ 1.64287393e-02]
 [ 1.24257398e-02]
 [ 3.91245655e-03]
 [ 1.24511265e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.97091208]
curr_Stock_Price:  99.32609974781197
curr_Factors:  [99.32609975]
mat_Sqrt:  [[0.15]]
grads:  [0.18867087]
Stock Position:  0.18867086856020068
Bond Position:  [-27.71085359]


portfolio before change:  [-8.59394286]
curr_Stock_Price:  101.39758069659024
curr_Factors:  [101.3975807]
mat_Sqrt:  [[0.15]]
grads:  [0.04691352]
Stock Position:  0.046913516860090716
Bond Position:  [-13.35085997]


portfolio before change:  [-8.61586008]
curr_Stock_Price:  101.07272506295988
curr_Factors:  [101.07272506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050902]
Stock Position:  -0.0005090176746729051
Bond Position:  [-8.56441228]


portfolio before change:  [-8.62144564]
curr_Stock_Price:  103.63116016942844
curr_Factors:  [103.63116017]
mat_Sqrt:  [[0.15]]
grads:  [-0.06878168]
Stock Position:  -0.06878168169260918
Bond Position:  [-1.49352017]


portfolio before change:  [-8.84184812]
curr_Stock_Price:  106.82467799141092
curr_Factors:  [106.82467799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01216513]
Stock Position:  -0.012165129344940089
Bond Position:  [-7.54231209]


portfolio before change:  [-8.81828093]
curr_Stock_Price:  104.57732952019695
curr_Factors:  [104.57732952]
mat_Sqrt:  [[0.15]]
grads:  [0.10952493]
Stock Position:  0.10952492876384604
Bond Position:  [-20.2721055]


portfolio before change:  [-8.64578277]
curr_Stock_Price:  106.24486544057976
curr_Factors:  [106.24486544]
mat_Sqrt:  [[0.15]]
grads:  [0.08283827]
Stock Position:  0.08283826501445643
Bond Position:  [-17.44692309]


portfolio before change:  [-8.54045951]
curr_Stock_Price:  107.62163135116685
curr_Factors:  [107.62163135]
mat_Sqrt:  [[0.15]]
grads:  [0.02608304]
Stock Position:  0.026083043658036827
Bond Position:  [-11.34755922]


portfolio before change:  [-8.58162381]
curr_Stock_Price:  106.26101170861111
curr_Factors:  [106.26101171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.58162381]
Stock Price:  104.73959449849929
PL:  [-13.32121831]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-5.31134167e-02]
 [ 2.34256072e-03]
 [ 6.30869235e-04]
 [-4.95312909e-03]
 [ 8.25050474e-03]
 [ 1.60639269e-02]
 [ 1.55212499e-02]
 [ 3.61059408e-03]
 [-5.71407260e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-48.00869451]
curr_Stock_Price:  96.7836322216132
curr_Factors:  [96.78363222]
mat_Sqrt:  [[0.15]]
grads:  [-0.35408944]
Stock Position:  -0.3540894448749083
Bond Position:  [-13.73863191]


portfolio before change:  [-47.91774252]
curr_Stock_Price:  96.5073657915797
curr_Factors:  [96.50736579]
mat_Sqrt:  [[0.15]]
grads:  [0.01561707]
Stock Position:  0.015617071471804342
Bond Position:  [-49.42490495]


portfolio before change:  [-47.91693996]
curr_Stock_Price:  98.14155093067383
curr_Factors:  [98.14155093]
mat_Sqrt:  [[0.15]]
grads:  [0.00420579]
Stock Position:  0.004205794902639197
Bond Position:  [-48.3297032]


portfolio before change:  [-47.93721593]
curr_Stock_Price:  99.0676378943794
curr_Factors:  [99.06763789]
mat_Sqrt:  [[0.15]]
grads:  [-0.03302086]
Stock Position:  -0.03302086059714052
Bond Position:  [-44.66591727]


portfolio before change:  [-47.91106688]
curr_Stock_Price:  97.59924529829136
curr_Factors:  [97.5992453]
mat_Sqrt:  [[0.15]]
grads:  [0.05500336]
Stock Position:  0.0550033649589862
Bond Position:  [-53.27935379]


portfolio before change:  [-47.86401176]
curr_Stock_Price:  98.93918989564155
curr_Factors:  [98.9391899]
mat_Sqrt:  [[0.15]]
grads:  [0.10709285]
Stock Position:  0.10709284603668247
Bond Position:  [-58.45969119]


portfolio before change:  [-47.93261585]
curr_Stock_Price:  98.57159353860342
curr_Factors:  [98.57159354]
mat_Sqrt:  [[0.15]]
grads:  [0.103475]
Stock Position:  0.10347499931974971
Bond Position:  [-58.13231143]


portfolio before change:  [-48.08427226]
curr_Stock_Price:  97.38693076124726
curr_Factors:  [97.38693076]
mat_Sqrt:  [[0.15]]
grads:  [0.02407063]
Stock Position:  0.024070627200421614
Bond Position:  [-50.42843676]


portfolio before change:  [-48.11653619]
curr_Stock_Price:  97.09431638346665
curr_Factors:  [97.09431638]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-48.11653619]
Stock Price:  96.73365129820478
PL:  [-48.11653619]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-4.06273936e-02]
 [ 5.92997467e-03]
 [ 9.02599664e-04]
 [-7.44051027e-03]
 [ 9.29641482e-03]
 [ 1.62512960e-02]
 [ 2.05231813e-02]
 [ 3.64280143e-03]
 [-6.94014864e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-40.83706301]
curr_Stock_Price:  97.25070896296997
curr_Factors:  [97.25070896]
mat_Sqrt:  [[0.15]]
grads:  [-0.27084929]
Stock Position:  -0.2708492909982111
Bond Position:  [-14.49677744]


portfolio before change:  [-41.4932674]
curr_Stock_Price:  99.64670632652151
curr_Factors:  [99.64670633]
mat_Sqrt:  [[0.15]]
grads:  [0.03953316]
Stock Position:  0.03953316447478372
Bond Position:  [-45.43261703]


portfolio before change:  [-41.55909776]
curr_Stock_Price:  98.55627069233401
curr_Factors:  [98.55627069]
mat_Sqrt:  [[0.15]]
grads:  [0.00601733]
Stock Position:  0.006017331095524882
Bond Position:  [-42.15214347]


portfolio before change:  [-41.5641387]
curr_Stock_Price:  101.22197091162005
curr_Factors:  [101.22197091]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496034]
Stock Position:  -0.049603401793309236
Bond Position:  [-36.5431846]


portfolio before change:  [-41.45864404]
curr_Stock_Price:  98.72676262791877
curr_Factors:  [98.72676263]
mat_Sqrt:  [[0.15]]
grads:  [0.0619761]
Stock Position:  0.061976098797116436
Bond Position:  [-47.57734363]


portfolio before change:  [-41.51314871]
curr_Stock_Price:  98.23124822428835
curr_Factors:  [98.23124822]
mat_Sqrt:  [[0.15]]
grads:  [0.10834197]
Stock Position:  0.10834197335216261
Bond Position:  [-52.15571599]


portfolio before change:  [-41.31757958]
curr_Stock_Price:  100.27711744562163
curr_Factors:  [100.27711745]
mat_Sqrt:  [[0.15]]
grads:  [0.13682121]
Stock Position:  0.1368212086101668
Bond Position:  [-55.03761598]


portfolio before change:  [-41.3624956]
curr_Stock_Price:  100.15001483812541
curr_Factors:  [100.15001484]
mat_Sqrt:  [[0.15]]
grads:  [0.02428534]
Stock Position:  0.024285342898169884
Bond Position:  [-43.79467305]


portfolio before change:  [-41.43560745]
curr_Stock_Price:  98.04137523314087
curr_Factors:  [98.04137523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-41.43560745]
Stock Price:  95.67538791758388
PL:  [-41.43560745]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.04486662e-03]
 [ 6.88135516e-03]
 [-2.76635949e-03]
 [-8.87424139e-03]
 [ 1.26089681e-02]
 [ 1.64320857e-02]
 [ 1.84283900e-02]
 [ 1.39613791e-03]
 [ 6.62539562e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.48689741]
curr_Stock_Price:  101.37489591573987
curr_Factors:  [101.37489592]
mat_Sqrt:  [[0.15]]
grads:  [0.01363244]
Stock Position:  0.01363244410526381
Bond Position:  [21.1049098]


portfolio before change:  [22.50768457]
curr_Stock_Price:  102.12546366692536
curr_Factors:  [102.12546367]
mat_Sqrt:  [[0.15]]
grads:  [0.0458757]
Stock Position:  0.04587570109066633
Bond Position:  [17.82260733]


portfolio before change:  [22.58432512]
curr_Stock_Price:  103.60177924846201
curr_Factors:  [103.60177925]
mat_Sqrt:  [[0.15]]
grads:  [-0.0184424]
Stock Position:  -0.01844239656898986
Bond Position:  [24.49499021]


portfolio before change:  [22.61804901]
curr_Stock_Price:  102.43743314238291
curr_Factors:  [102.43743314]
mat_Sqrt:  [[0.15]]
grads:  [-0.05916161]
Stock Position:  -0.05916160925962825
Bond Position:  [28.6784124]


portfolio before change:  [22.68768133]
curr_Stock_Price:  101.50288231150351
curr_Factors:  [101.50288231]
mat_Sqrt:  [[0.15]]
grads:  [0.08405979]
Stock Position:  0.08405978727744869
Bond Position:  [14.15537063]


portfolio before change:  [22.90213405]
curr_Stock_Price:  103.9698557481888
curr_Factors:  [103.96985575]
mat_Sqrt:  [[0.15]]
grads:  [0.10954724]
Stock Position:  0.10954723777389135
Bond Position:  [11.51252354]


portfolio before change:  [22.94726198]
curr_Stock_Price:  104.32924624828918
curr_Factors:  [104.32924625]
mat_Sqrt:  [[0.15]]
grads:  [0.12285593]
Stock Position:  0.12285593342930541
Bond Position:  [10.12979505]


portfolio before change:  [22.9616315]
curr_Stock_Price:  104.4049719242381
curr_Factors:  [104.40497192]
mat_Sqrt:  [[0.15]]
grads:  [0.00930759]
Stock Position:  0.009307586036597981
Bond Position:  [21.98987324]


portfolio before change:  [22.97861569]
curr_Stock_Price:  105.0481580314321
curr_Factors:  [105.04815803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.97861569]
Stock Price:  103.9090015105534
PL:  [19.06961418]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.41685968e-02]
 [ 5.73822988e-03]
 [ 1.02374913e-03]
 [-6.65293677e-03]
 [ 1.13988769e-02]
 [ 1.60963443e-02]
 [ 1.36188687e-02]
 [ 4.05261562e-03]
 [-5.95916728e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.13208989]
curr_Stock_Price:  100.04922027817
curr_Factors:  [100.04922028]
mat_Sqrt:  [[0.15]]
grads:  [0.09445731]
Stock Position:  0.09445731212903984
Bond Position:  [-7.31829054]


portfolio before change:  [2.08035142]
curr_Stock_Price:  99.54022409416459
curr_Factors:  [99.54022409]
mat_Sqrt:  [[0.15]]
grads:  [0.03825487]
Stock Position:  0.03825486584341901
Bond Position:  [-1.7275465]


portfolio before change:  [2.1083077]
curr_Stock_Price:  100.2935995173922
curr_Factors:  [100.29359952]
mat_Sqrt:  [[0.15]]
grads:  [0.00682499]
Stock Position:  0.006824994176513417
Bond Position:  [1.42380447]


portfolio before change:  [2.11053787]
curr_Stock_Price:  100.5160303369191
curr_Factors:  [100.51603034]
mat_Sqrt:  [[0.15]]
grads:  [-0.04435291]
Stock Position:  -0.04435291180590397
Bond Position:  [6.5687165]


portfolio before change:  [2.16999583]
curr_Stock_Price:  99.24953452817901
curr_Factors:  [99.24953453]
mat_Sqrt:  [[0.15]]
grads:  [0.07599251]
Stock Position:  0.07599251283647847
Bond Position:  [-5.3722257]


portfolio before change:  [2.13272543]
curr_Stock_Price:  98.79444219812635
curr_Factors:  [98.7944422]
mat_Sqrt:  [[0.15]]
grads:  [0.10730896]
Stock Position:  0.10730896185617197
Bond Position:  [-8.4688036]


portfolio before change:  [1.9813164]
curr_Stock_Price:  97.4229484754994
curr_Factors:  [97.42294848]
mat_Sqrt:  [[0.15]]
grads:  [0.09079246]
Stock Position:  0.09079245793294527
Bond Position:  [-6.86395255]


portfolio before change:  [1.9523395]
curr_Stock_Price:  97.14160277818232
curr_Factors:  [97.14160278]
mat_Sqrt:  [[0.15]]
grads:  [0.02701744]
Stock Position:  0.02701743749616682
Bond Position:  [-0.67217768]


portfolio before change:  [1.95584068]
curr_Stock_Price:  97.28363505101579
curr_Factors:  [97.28363505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.95584068]
Stock Price:  98.89935629917407
PL:  [1.95584068]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.30314342]
 [ 0.00491933]
 [ 0.00692634]
 [-0.00251342]
 [-0.00984794]
 [ 0.00667478]
 [ 0.0164347 ]
 [ 0.02279998]
 [ 0.00383109]
 [ 0.01907433]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.21376957]
curr_Stock_Price:  100.83608050267365
curr_Factors:  [100.8360805]
mat_Sqrt:  [[0.15]]
grads:  [0.03279555]
Stock Position:  0.03279554528931498
Bond Position:  [10.90679532]


portfolio before change:  [14.21658808]
curr_Stock_Price:  100.75569623657931
curr_Factors:  [100.75569624]
mat_Sqrt:  [[0.15]]
grads:  [0.04617563]
Stock Position:  0.04617563229243174
Bond Position:  [9.5641301]


portfolio before change:  [14.34382866]
curr_Stock_Price:  103.40768632529159
curr_Factors:  [103.40768633]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675612]
Stock Position:  -0.016756123216761672
Bond Position:  [16.0765406]


portfolio before change:  [14.35462979]
curr_Stock_Price:  103.24292010622541
curr_Factors:  [103.24292011]
mat_Sqrt:  [[0.15]]
grads:  [-0.06565291]
Stock Position:  -0.06565291150915938
Bond Position:  [21.13282808]


portfolio before change:  [14.37158819]
curr_Stock_Price:  103.14560003931598
curr_Factors:  [103.14560004]
mat_Sqrt:  [[0.15]]
grads:  [0.04449856]
Stock Position:  0.044498560498806766
Bond Position:  [9.78175746]


portfolio before change:  [14.38485501]
curr_Stock_Price:  103.33380199306878
curr_Factors:  [103.33380199]
mat_Sqrt:  [[0.15]]
grads:  [0.10956466]
Stock Position:  0.10956465994362001
Bond Position:  [3.06312213]


portfolio before change:  [14.34093479]
curr_Stock_Price:  102.91895875599477
curr_Factors:  [102.91895876]
mat_Sqrt:  [[0.15]]
grads:  [0.15199985]
Stock Position:  0.1519998515069078
Bond Position:  [-1.30273166]


portfolio before change:  [15.04556524]
curr_Stock_Price:  107.55897626852531
curr_Factors:  [107.55897627]
mat_Sqrt:  [[0.15]]
grads:  [0.0255406]
Stock Position:  0.025540595759443903
Bond Position:  [12.2984449]


portfolio before change:  [15.04802407]
curr_Stock_Price:  107.4144250784034
curr_Factors:  [107.41442508]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.04802407]
Stock Price:  107.82897200485174
PL:  [7.21905207]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 7.55456360e-03]
 [ 5.54768798e-03]
 [ 1.21368004e-03]
 [-6.60946501e-03]
 [ 1.33888857e-02]
 [ 1.60070673e-02]
 [ 1.52183717e-02]
 [ 3.47415570e-03]
 [-7.76584059e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.19970432]
curr_Stock_Price:  100.37926579648635
curr_Factors:  [100.3792658]
mat_Sqrt:  [[0.15]]
grads:  [0.05036376]
Stock Position:  0.05036375732588266
Bond Position:  [2.14422734]


portfolio before change:  [7.15319021]
curr_Stock_Price:  99.43440987139337
curr_Factors:  [99.43440987]
mat_Sqrt:  [[0.15]]
grads:  [0.03698459]
Stock Position:  0.03698458653809799
Bond Position:  [3.47564967]


portfolio before change:  [7.18329035]
curr_Stock_Price:  100.20126665267802
curr_Factors:  [100.20126665]
mat_Sqrt:  [[0.15]]
grads:  [0.0080912]
Stock Position:  0.008091200238746024
Bond Position:  [6.37254184]


portfolio before change:  [7.18864136]
curr_Stock_Price:  100.46871059245889
curr_Factors:  [100.46871059]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440631]
Stock Position:  -0.044063100058403956
Bond Position:  [11.61560421]


portfolio before change:  [7.22688902]
curr_Stock_Price:  99.73252982027358
curr_Factors:  [99.73252982]
mat_Sqrt:  [[0.15]]
grads:  [0.08925924]
Stock Position:  0.08925923809746165
Bond Position:  [-1.6751606]


portfolio before change:  [7.32202009]
curr_Stock_Price:  100.80769986786065
curr_Factors:  [100.80769987]
mat_Sqrt:  [[0.15]]
grads:  [0.10671378]
Stock Position:  0.10671378170208945
Bond Position:  [-3.43555079]


portfolio before change:  [7.06930492]
curr_Stock_Price:  98.45564220461934
curr_Factors:  [98.4556422]
mat_Sqrt:  [[0.15]]
grads:  [0.10145581]
Stock Position:  0.10145581146954862
Bond Position:  [-2.91959216]


portfolio before change:  [6.97626057]
curr_Stock_Price:  97.55294190226809
curr_Factors:  [97.5529419]
mat_Sqrt:  [[0.15]]
grads:  [0.02316104]
Stock Position:  0.023161037999447107
Bond Position:  [4.71683317]


portfolio before change:  [7.00448826]
curr_Stock_Price:  98.66984733706465
curr_Factors:  [98.66984734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.00448826]
Stock Price:  97.73287785399648
PL:  [7.00448826]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.01405318e-02]
 [ 6.96741566e-03]
 [ 1.85537476e-03]
 [-4.85993412e-03]
 [ 1.28140694e-02]
 [ 1.67221968e-02]
 [ 6.68876207e-03]
 [ 1.90594072e-02]
 [-2.93068271e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.40876234]
curr_Stock_Price:  98.25552919034294
curr_Factors:  [98.25552919]
mat_Sqrt:  [[0.15]]
grads:  [-0.06760355]
Stock Position:  -0.06760354551101971
Bond Position:  [-18.76634021]


portfolio before change:  [-25.59413852]
curr_Stock_Price:  100.85880476838561
curr_Factors:  [100.85880477]
mat_Sqrt:  [[0.15]]
grads:  [0.04644944]
Stock Position:  0.04644943772780539
Bond Position:  [-30.27897329]


portfolio before change:  [-25.65332335]
curr_Stock_Price:  99.91064355314434
curr_Factors:  [99.91064355]
mat_Sqrt:  [[0.15]]
grads:  [0.01236917]
Stock Position:  0.012369165034151728
Bond Position:  [-26.88913459]


portfolio before change:  [-25.71365183]
curr_Stock_Price:  96.1205289477514
curr_Factors:  [96.12052895]
mat_Sqrt:  [[0.15]]
grads:  [-0.03239956]
Stock Position:  -0.03239956078413565
Bond Position:  [-22.59938891]


portfolio before change:  [-25.68898933]
curr_Stock_Price:  95.01048251083117
curr_Factors:  [95.01048251]
mat_Sqrt:  [[0.15]]
grads:  [0.08542713]
Stock Position:  0.08542712911241708
Bond Position:  [-33.80546209]


portfolio before change:  [-25.95299425]
curr_Stock_Price:  92.11798261379316
curr_Factors:  [92.11798261]
mat_Sqrt:  [[0.15]]
grads:  [0.11148131]
Stock Position:  0.11148131189394006
Bond Position:  [-36.2224278]


portfolio before change:  [-26.24629945]
curr_Stock_Price:  89.64950202421902
curr_Factors:  [89.64950202]
mat_Sqrt:  [[0.15]]
grads:  [0.04459175]
Stock Position:  0.04459174712822313
Bond Position:  [-30.24392737]


portfolio before change:  [-26.11863705]
curr_Stock_Price:  92.85162244240003
curr_Factors:  [92.85162244]
mat_Sqrt:  [[0.15]]
grads:  [0.12706271]
Stock Position:  0.1270627148911033
Bond Position:  [-37.91661628]


portfolio before change:  [-26.20070686]
curr_Stock_Price:  92.35496403795024
curr_Factors:  [92.35496404]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.20070686]
Stock Price:  92.6351272771344
PL:  [-26.20070686]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-5.27330042e-02]
 [ 2.04600739e-03]
 [ 2.47814306e-03]
 [-4.92399724e-03]
 [ 1.69534154e-02]
 [ 1.67658036e-02]
 [ 9.84762532e-03]
 [ 1.87261810e-02]
 [-3.00923681e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-47.79019593]
curr_Stock_Price:  96.79786268060039
curr_Factors:  [96.79786268]
mat_Sqrt:  [[0.15]]
grads:  [-0.35155336]
Stock Position:  -0.351553361420209
Bond Position:  [-13.76058192]


portfolio before change:  [-47.56419132]
curr_Stock_Price:  96.13541240468929
curr_Factors:  [96.1354124]
mat_Sqrt:  [[0.15]]
grads:  [0.01364005]
Stock Position:  0.013640049239212465
Bond Position:  [-48.87548307]


portfolio before change:  [-47.59815336]
curr_Stock_Price:  95.43760030289951
curr_Factors:  [95.4376003]
mat_Sqrt:  [[0.15]]
grads:  [0.01652095]
Stock Position:  0.016520953730498607
Bond Position:  [-49.17487354]


portfolio before change:  [-47.63574139]
curr_Stock_Price:  94.65105716742048
curr_Factors:  [94.65105717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03282665]
Stock Position:  -0.03282664827472939
Bond Position:  [-44.52866442]


portfolio before change:  [-47.60102849]
curr_Stock_Price:  92.9151871440238
curr_Factors:  [92.91518714]
mat_Sqrt:  [[0.15]]
grads:  [0.11302277]
Stock Position:  0.11302276950350727
Bond Position:  [-58.10256027]


portfolio before change:  [-47.81367482]
curr_Stock_Price:  91.29084374685047
curr_Factors:  [91.29084375]
mat_Sqrt:  [[0.15]]
grads:  [0.11177202]
Stock Position:  0.11177202397810063
Bond Position:  [-58.0174372]


portfolio before change:  [-47.64884405]
curr_Stock_Price:  93.02514843309363
curr_Factors:  [93.02514843]
mat_Sqrt:  [[0.15]]
grads:  [0.06565084]
Stock Position:  0.06565083543599184
Bond Position:  [-53.75602276]


portfolio before change:  [-47.68091566]
curr_Stock_Price:  92.94614135057876
curr_Factors:  [92.94614135]
mat_Sqrt:  [[0.15]]
grads:  [0.12484121]
Stock Position:  0.12484120693063389
Bond Position:  [-59.28442413]


portfolio before change:  [-47.76580729]
curr_Stock_Price:  92.5036432057172
curr_Factors:  [92.50364321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-47.76580729]
Stock Price:  90.21657638915377
PL:  [-47.76580729]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-3.07818152e-03]
 [ 6.60466192e-03]
 [-1.34536670e-03]
 [-1.15189806e-02]
 [ 1.13471718e-03]
 [ 1.64237681e-02]
 [ 2.14121281e-02]
 [ 3.32991926e-03]
 [-4.63610575e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.05058903]
curr_Stock_Price:  102.45366231708613
curr_Factors:  [102.45366232]
mat_Sqrt:  [[0.15]]
grads:  [-0.02052121]
Stock Position:  -0.02052121013269334
Bond Position:  [41.15306216]


portfolio before change:  [39.04608347]
curr_Stock_Price:  103.67616497658902
curr_Factors:  [103.67616498]
mat_Sqrt:  [[0.15]]
grads:  [0.04403108]
Stock Position:  0.04403107947483978
Bond Position:  [34.48111001]


portfolio before change:  [39.01553513]
curr_Stock_Price:  102.59072235915701
curr_Factors:  [102.59072236]
mat_Sqrt:  [[0.15]]
grads:  [-0.00896911]
Stock Position:  -0.008969111323650504
Bond Position:  [39.93568274]


portfolio before change:  [39.01725973]
curr_Stock_Price:  104.62528682279938
curr_Factors:  [104.62528682]
mat_Sqrt:  [[0.15]]
grads:  [-0.0767932]
Stock Position:  -0.07679320375444532
Bond Position:  [47.0517707]


portfolio before change:  [39.03519449]
curr_Stock_Price:  104.69817098259013
curr_Factors:  [104.69817098]
mat_Sqrt:  [[0.15]]
grads:  [0.00756478]
Stock Position:  0.007564781191936494
Bond Position:  [38.24317573]


portfolio before change:  [39.06023349]
curr_Stock_Price:  105.47977068572708
curr_Factors:  [105.47977069]
mat_Sqrt:  [[0.15]]
grads:  [0.10949179]
Stock Position:  0.10949178730168782
Bond Position:  [27.51106487]


portfolio before change:  [38.84369872]
curr_Stock_Price:  103.37647376463792
curr_Factors:  [103.37647376]
mat_Sqrt:  [[0.15]]
grads:  [0.14274752]
Stock Position:  0.14274752097923066
Bond Position:  [24.08696336]


portfolio before change:  [38.45431127]
curr_Stock_Price:  100.56427818207463
curr_Factors:  [100.56427818]
mat_Sqrt:  [[0.15]]
grads:  [0.02219946]
Stock Position:  0.022199461757033533
Bond Position:  [36.22183842]


portfolio before change:  [38.47840948]
curr_Stock_Price:  100.83377888251843
curr_Factors:  [100.83377888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.47840948]
Stock Price:  98.52437082235114
PL:  [38.47840948]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 5.81441285e-03]
 [ 6.83466485e-03]
 [-1.69024264e-04]
 [-7.74787182e-03]
 [ 1.14767963e-02]
 [ 1.59255534e-02]
 [ 1.60855660e-02]
 [ 3.57598792e-03]
 [-6.66319845e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.38415877]
curr_Stock_Price:  100.586664155669
curr_Factors:  [100.58666416]
mat_Sqrt:  [[0.15]]
grads:  [0.03876275]
Stock Position:  0.038762752351233457
Bond Position:  [6.48514282]


portfolio before change:  [10.379145]
curr_Stock_Price:  100.37364636208798
curr_Factors:  [100.37364636]
mat_Sqrt:  [[0.15]]
grads:  [0.04556443]
Stock Position:  0.045564432331679186
Bond Position:  [5.80567678]


portfolio before change:  [10.42802566]
curr_Stock_Price:  101.38270312221198
curr_Factors:  [101.38270312]
mat_Sqrt:  [[0.15]]
grads:  [-0.00112683]
Stock Position:  -0.0011268284287518785
Bond Position:  [10.54226657]


portfolio before change:  [10.4331825]
curr_Stock_Price:  101.48529876766374
curr_Factors:  [101.48529877]
mat_Sqrt:  [[0.15]]
grads:  [-0.05165248]
Stock Position:  -0.05165247880676047
Bond Position:  [15.67514975]


portfolio before change:  [10.5555274]
curr_Stock_Price:  99.26845720151923
curr_Factors:  [99.2684572]
mat_Sqrt:  [[0.15]]
grads:  [0.07651198]
Stock Position:  0.0765119754965434
Bond Position:  [2.96030163]


portfolio before change:  [10.60909172]
curr_Stock_Price:  99.94918456696963
curr_Factors:  [99.94918457]
mat_Sqrt:  [[0.15]]
grads:  [0.10617036]
Stock Position:  0.10617035603234455
Bond Position:  [-0.00254879]


portfolio before change:  [10.48576795]
curr_Stock_Price:  98.78763156518872
curr_Factors:  [98.78763157]
mat_Sqrt:  [[0.15]]
grads:  [0.10723711]
Stock Position:  0.10723710660626246
Bond Position:  [-0.10793183]


portfolio before change:  [10.48804248]
curr_Stock_Price:  98.80934527508664
curr_Factors:  [98.80934528]
mat_Sqrt:  [[0.15]]
grads:  [0.02383992]
Stock Position:  0.023839919461761182
Bond Position:  [8.13243565]


portfolio before change:  [10.46870142]
curr_Stock_Price:  97.82745038953901
curr_Factors:  [97.82745039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.46870142]
Stock Price:  100.08745076848871
PL:  [10.38125065]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.76664855e-02]
 [ 6.98415724e-03]
 [ 7.71343882e-04]
 [-4.78034616e-03]
 [ 1.07810312e-02]
 [ 1.62017236e-02]
 [ 1.35886536e-02]
 [ 3.86657450e-03]
 [-5.43517240e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.02434193]
curr_Stock_Price:  98.99697804859308
curr_Factors:  [98.99697805]
mat_Sqrt:  [[0.15]]
grads:  [0.11777657]
Stock Position:  0.11777656967120904
Bond Position:  [-25.68386641]


portfolio before change:  [-13.81295738]
curr_Stock_Price:  100.90083459775524
curr_Factors:  [100.9008346]
mat_Sqrt:  [[0.15]]
grads:  [0.04656105]
Stock Position:  0.04656104823692254
Bond Position:  [-18.511006]


portfolio before change:  [-13.96230046]
curr_Stock_Price:  97.89219829431178
curr_Factors:  [97.89219829]
mat_Sqrt:  [[0.15]]
grads:  [0.00514229]
Stock Position:  0.00514229254571677
Bond Position:  [-14.46569078]


portfolio before change:  [-13.9732169]
curr_Stock_Price:  97.17621538082737
curr_Factors:  [97.17621538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03186897]
Stock Position:  -0.03186897442141842
Bond Position:  [-10.87631058]


portfolio before change:  [-13.9424332]
curr_Stock_Price:  96.03958597004086
curr_Factors:  [96.03958597]
mat_Sqrt:  [[0.15]]
grads:  [0.07187354]
Stock Position:  0.07187354166338357
Bond Position:  [-20.84513839]


portfolio before change:  [-13.78238584]
curr_Stock_Price:  98.41142596374496
curr_Factors:  [98.41142596]
mat_Sqrt:  [[0.15]]
grads:  [0.10801149]
Stock Position:  0.10801149098760196
Bond Position:  [-24.41195069]


portfolio before change:  [-13.99115763]
curr_Stock_Price:  96.59159396378796
curr_Factors:  [96.59159396]
mat_Sqrt:  [[0.15]]
grads:  [0.09059102]
Stock Position:  0.09059102367189852
Bond Position:  [-22.74148901]


portfolio before change:  [-13.94335135]
curr_Stock_Price:  97.24485813985758
curr_Factors:  [97.24485814]
mat_Sqrt:  [[0.15]]
grads:  [0.02577716]
Stock Position:  0.02577716331678377
Bond Position:  [-16.45004794]


portfolio before change:  [-13.96101217]
curr_Stock_Price:  96.8788852922942
curr_Factors:  [96.87888529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.96101217]
Stock Price:  95.81210568080574
PL:  [-13.96101217]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.50126574e-02]
 [ 6.85034480e-03]
 [-1.50484274e-03]
 [-9.05421205e-03]
 [ 8.18171662e-03]
 [ 1.60783644e-02]
 [ 1.65222936e-02]
 [ 3.66679320e-03]
 [-6.79171364e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.56636684]
curr_Stock_Price:  99.22219036373312
curr_Factors:  [99.22219036]
mat_Sqrt:  [[0.15]]
grads:  [0.16675105]
Stock Position:  0.16675104935595045
Bond Position:  [-27.1117712]


portfolio before change:  [-10.03886905]
curr_Stock_Price:  102.46689001764783
curr_Factors:  [102.46689002]
mat_Sqrt:  [[0.15]]
grads:  [0.04566897]
Stock Position:  0.04566896536215041
Bond Position:  [-14.7184259]


portfolio before change:  [-10.03592447]
curr_Stock_Price:  102.69254941895426
curr_Factors:  [102.69254942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003228]
Stock Position:  -0.010032284946450403
Bond Position:  [-9.00568355]


portfolio before change:  [-10.03936264]
curr_Stock_Price:  102.58631341048489
curr_Factors:  [102.58631341]
mat_Sqrt:  [[0.15]]
grads:  [-0.06036141]
Stock Position:  -0.060361413679343404
Bond Position:  [-3.84710774]


portfolio before change:  [-10.05352316]
curr_Stock_Price:  102.78903365088996
curr_Factors:  [102.78903365]
mat_Sqrt:  [[0.15]]
grads:  [0.05454478]
Stock Position:  0.054544777443449835
Bond Position:  [-15.66012812]


portfolio before change:  [-10.13560069]
curr_Stock_Price:  101.42784909551095
curr_Factors:  [101.4278491]
mat_Sqrt:  [[0.15]]
grads:  [0.1071891]
Stock Position:  0.107189096299772
Bond Position:  [-21.00756017]


portfolio before change:  [-10.41118835]
curr_Stock_Price:  98.9548247073378
curr_Factors:  [98.95482471]
mat_Sqrt:  [[0.15]]
grads:  [0.11014862]
Stock Position:  0.11014862430653027
Bond Position:  [-21.31092616]


portfolio before change:  [-10.35135911]
curr_Stock_Price:  99.59475429572257
curr_Factors:  [99.5947543]
mat_Sqrt:  [[0.15]]
grads:  [0.02444529]
Stock Position:  0.024445287992396106
Bond Position:  [-12.78598156]


portfolio before change:  [-10.39852929]
curr_Stock_Price:  97.9267194758449
curr_Factors:  [97.92671948]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.39852929]
Stock Price:  97.35607234580307
PL:  [-10.39852929]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-1.44120959e-03]
 [ 7.06868667e-03]
 [ 2.31225642e-03]
 [-4.81201855e-03]
 [ 8.99326323e-03]
 [ 1.60385747e-02]
 [ 2.46100791e-02]
 [ 1.59063836e-03]
 [ 9.55615880e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.84718863]
curr_Stock_Price:  98.48748871615011
curr_Factors:  [98.48748872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00960806]
Stock Position:  -0.009608063916737714
Bond Position:  [-20.90091455]


portfolio before change:  [-21.88417977]
curr_Stock_Price:  101.24955090574306
curr_Factors:  [101.24955091]
mat_Sqrt:  [[0.15]]
grads:  [0.04712458]
Stock Position:  0.047124577782720986
Bond Position:  [-26.65552211]


portfolio before change:  [-22.16015424]
curr_Stock_Price:  95.67616674947058
curr_Factors:  [95.67616675]
mat_Sqrt:  [[0.15]]
grads:  [0.01541504]
Stock Position:  0.015415042793112059
Bond Position:  [-23.63500645]


portfolio before change:  [-22.15532748]
curr_Stock_Price:  96.7561002116328
curr_Factors:  [96.75610021]
mat_Sqrt:  [[0.15]]
grads:  [-0.03208012]
Stock Position:  -0.03208012365338861
Bond Position:  [-19.05137982]


portfolio before change:  [-22.21657625]
curr_Stock_Price:  98.36833524307417
curr_Factors:  [98.36833524]
mat_Sqrt:  [[0.15]]
grads:  [0.05995509]
Stock Position:  0.05995508818067053
Bond Position:  [-28.11425846]


portfolio before change:  [-22.1889691]
curr_Stock_Price:  99.06331865173358
curr_Factors:  [99.06331865]
mat_Sqrt:  [[0.15]]
grads:  [0.10692383]
Stock Position:  0.10692383125993826
Bond Position:  [-32.78119867]


portfolio before change:  [-21.88516784]
curr_Stock_Price:  102.0579359959617
curr_Factors:  [102.057936]
mat_Sqrt:  [[0.15]]
grads:  [0.16406719]
Stock Position:  0.16406719370945932
Bond Position:  [-38.629527]


portfolio before change:  [-21.74858729]
curr_Stock_Price:  103.00815730456243
curr_Factors:  [103.0081573]
mat_Sqrt:  [[0.15]]
grads:  [0.01060426]
Stock Position:  0.010604255709445929
Bond Position:  [-22.84091213]


portfolio before change:  [-21.73191262]
curr_Stock_Price:  105.65784664788147
curr_Factors:  [105.65784665]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.73191262]
Stock Price:  107.23073753648951
PL:  [-28.96265016]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.59468298e-02]
 [ 4.57177536e-03]
 [ 9.88636658e-04]
 [-9.19601256e-03]
 [ 4.84520450e-03]
 [ 1.60997564e-02]
 [ 2.32823916e-02]
 [ 1.41668199e-03]
 [-2.81707699e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.72838302]
curr_Stock_Price:  98.95112499256452
curr_Factors:  [98.95112499]
mat_Sqrt:  [[0.15]]
grads:  [0.1063122]
Stock Position:  0.10631219864487534
Bond Position:  [-25.24809468]


portfolio before change:  [-14.7427533]
curr_Stock_Price:  98.93472919954785
curr_Factors:  [98.9347292]
mat_Sqrt:  [[0.15]]
grads:  [0.0304785]
Stock Position:  0.03047850238013136
Bond Position:  [-17.75813568]


portfolio before change:  [-14.709698]
curr_Stock_Price:  100.31066906564351
curr_Factors:  [100.31066907]
mat_Sqrt:  [[0.15]]
grads:  [0.00659091]
Stock Position:  0.006590911051915305
Bond Position:  [-15.3708367]


portfolio before change:  [-14.70161363]
curr_Stock_Price:  102.70361751999891
curr_Factors:  [102.70361752]
mat_Sqrt:  [[0.15]]
grads:  [-0.06130675]
Stock Position:  -0.06130675043108319
Bond Position:  [-8.40518858]


portfolio before change:  [-14.75949284]
curr_Stock_Price:  103.57914195630742
curr_Factors:  [103.57914196]
mat_Sqrt:  [[0.15]]
grads:  [0.03230136]
Stock Position:  0.032301363309306934
Bond Position:  [-18.10524033]


portfolio before change:  [-14.83245571]
curr_Stock_Price:  101.60064995723171
curr_Factors:  [101.60064996]
mat_Sqrt:  [[0.15]]
grads:  [0.10733171]
Stock Position:  0.10733170940507945
Bond Position:  [-25.73742714]


portfolio before change:  [-14.72600512]
curr_Stock_Price:  102.71236731020271
curr_Factors:  [102.71236731]
mat_Sqrt:  [[0.15]]
grads:  [0.15521594]
Stock Position:  0.15521594371348463
Bond Position:  [-30.66860214]


portfolio before change:  [-14.50152434]
curr_Stock_Price:  104.2574335462466
curr_Factors:  [104.25743355]
mat_Sqrt:  [[0.15]]
grads:  [0.00944455]
Stock Position:  0.009444546616497419
Bond Position:  [-15.48618853]


portfolio before change:  [-14.5256908]
curr_Stock_Price:  102.51871195194833
curr_Factors:  [102.51871195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.5256908]
Stock Price:  103.00029081746358
PL:  [-17.52598162]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.60659670e-02]
 [ 3.97991930e-03]
 [ 1.38306428e-03]
 [-5.04881522e-03]
 [ 1.34677106e-02]
 [ 1.60834644e-02]
 [ 1.52658445e-02]
 [ 3.56670163e-03]
 [-7.74592810e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-32.47337626]
curr_Stock_Price:  97.79542233138679
curr_Factors:  [97.79542233]
mat_Sqrt:  [[0.15]]
grads:  [-0.17377311]
Stock Position:  -0.17377311359318928
Bond Position:  [-15.47916122]


portfolio before change:  [-32.59665738]
curr_Stock_Price:  98.46031005057607
curr_Factors:  [98.46031005]
mat_Sqrt:  [[0.15]]
grads:  [0.0265328]
Stock Position:  0.02653279535697071
Bond Position:  [-35.20908464]


portfolio before change:  [-32.59967829]
curr_Stock_Price:  99.010121357533
curr_Factors:  [99.01012136]
mat_Sqrt:  [[0.15]]
grads:  [0.00922043]
Stock Position:  0.009220428538719341
Bond Position:  [-33.51259404]


portfolio before change:  [-32.61478782]
curr_Stock_Price:  99.18917623373709
curr_Factors:  [99.18917623]
mat_Sqrt:  [[0.15]]
grads:  [-0.03365877]
Stock Position:  -0.03365876813956509
Bond Position:  [-29.27620233]


portfolio before change:  [-32.6507992]
curr_Stock_Price:  99.82406641858512
curr_Factors:  [99.82406642]
mat_Sqrt:  [[0.15]]
grads:  [0.08978474]
Stock Position:  0.08978473725584059
Bond Position:  [-41.61347678]


portfolio before change:  [-32.75905659]
curr_Stock_Price:  98.85012087105392
curr_Factors:  [98.85012087]
mat_Sqrt:  [[0.15]]
grads:  [0.1072231]
Stock Position:  0.10722309598530155
Bond Position:  [-43.35807259]


portfolio before change:  [-32.82108959]
curr_Stock_Price:  98.4738162766906
curr_Factors:  [98.47381628]
mat_Sqrt:  [[0.15]]
grads:  [0.1017723]
Stock Position:  0.10177229653491257
Bond Position:  [-42.84299602]


portfolio before change:  [-32.81831476]
curr_Stock_Price:  98.71161849636627
curr_Factors:  [98.7116185]
mat_Sqrt:  [[0.15]]
grads:  [0.02377801]
Stock Position:  0.02377801087436056
Bond Position:  [-35.1654807]


portfolio before change:  [-32.83724763]
curr_Stock_Price:  98.65502288207617
curr_Factors:  [98.65502288]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-32.83724763]
Stock Price:  97.12723566479666
PL:  [-32.83724763]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.51315511e-02]
 [ 6.47965056e-03]
 [ 9.79508737e-04]
 [-4.69807138e-03]
 [ 8.34797805e-03]
 [ 1.65772564e-02]
 [ 1.17066598e-02]
 [ 1.11331903e-02]
 [-5.96340808e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.62306125]
curr_Stock_Price:  100.01606806798944
curr_Factors:  [100.01606807]
mat_Sqrt:  [[0.15]]
grads:  [0.10087701]
Stock Position:  0.10087700718446996
Bond Position:  [-8.46626036]


portfolio before change:  [1.61359216]
curr_Stock_Price:  99.96417414764348
curr_Factors:  [99.96417415]
mat_Sqrt:  [[0.15]]
grads:  [0.04319767]
Stock Position:  0.043197670395122366
Bond Position:  [-2.70462728]


portfolio before change:  [1.55553006]
curr_Stock_Price:  98.65138452984051
curr_Factors:  [98.65138453]
mat_Sqrt:  [[0.15]]
grads:  [0.00653006]
Stock Position:  0.006530058249618869
Bond Position:  [0.91133077]


portfolio before change:  [1.55347932]
curr_Stock_Price:  98.26754099457239
curr_Factors:  [98.26754099]
mat_Sqrt:  [[0.15]]
grads:  [-0.03132048]
Stock Position:  -0.031320475861813094
Bond Position:  [4.63126546]


portfolio before change:  [1.57371417]
curr_Stock_Price:  97.69543478884428
curr_Factors:  [97.69543479]
mat_Sqrt:  [[0.15]]
grads:  [0.05565319]
Stock Position:  0.05565318698547818
Bond Position:  [-3.86334813]


portfolio before change:  [1.41438326]
curr_Stock_Price:  94.86722751376762
curr_Factors:  [94.86722751]
mat_Sqrt:  [[0.15]]
grads:  [0.11051504]
Stock Position:  0.11051504281061969
Bond Position:  [-9.06987245]


portfolio before change:  [1.38469093]
curr_Stock_Price:  94.63960000301161
curr_Factors:  [94.6396]
mat_Sqrt:  [[0.15]]
grads:  [0.0780444]
Stock Position:  0.07804439889468935
Bond Position:  [-6.00139977]


portfolio before change:  [1.41761153]
curr_Stock_Price:  95.09987717671167
curr_Factors:  [95.09987718]
mat_Sqrt:  [[0.15]]
grads:  [0.07422127]
Stock Position:  0.07422126881777479
Bond Position:  [-5.64082202]


portfolio before change:  [1.57711482]
curr_Stock_Price:  97.28691078055708
curr_Factors:  [97.28691078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.57711482]
Stock Price:  98.26069148649187
PL:  [1.57711482]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.99092914e-03]
 [ 6.48896595e-03]
 [-5.71703790e-03]
 [-1.27771212e-02]
 [ 3.68756221e-03]
 [ 1.63957455e-02]
 [ 2.41592119e-02]
 [ 2.01543066e-03]
 [-2.66444026e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.79412494]
curr_Stock_Price:  102.76260112570641
curr_Factors:  [102.76260113]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993953]
Stock Position:  -0.019939527613893986
Bond Position:  [45.84316266]


portfolio before change:  [43.78748132]
curr_Stock_Price:  104.24563177500136
curr_Factors:  [104.24563178]
mat_Sqrt:  [[0.15]]
grads:  [0.04325977]
Stock Position:  0.04325977297790526
Bond Position:  [39.27783895]


portfolio before change:  [43.87722046]
curr_Stock_Price:  105.86596652040762
curr_Factors:  [105.86596652]
mat_Sqrt:  [[0.15]]
grads:  [-0.03811359]
Stock Position:  -0.03811358601150236
Bond Position:  [47.91215208]


portfolio before change:  [43.90720352]
curr_Stock_Price:  105.70799146241353
curr_Factors:  [105.70799146]
mat_Sqrt:  [[0.15]]
grads:  [-0.08518081]
Stock Position:  -0.08518080811933726
Bond Position:  [52.91149566]


portfolio before change:  [44.09100693]
curr_Stock_Price:  103.8608495181164
curr_Factors:  [103.86084952]
mat_Sqrt:  [[0.15]]
grads:  [0.02458375]
Stock Position:  0.02458374809834106
Bond Position:  [41.53771797]


portfolio before change:  [44.09404621]
curr_Stock_Price:  103.1394474125087
curr_Factors:  [103.13944741]
mat_Sqrt:  [[0.15]]
grads:  [0.10930497]
Stock Position:  0.10930497016920059
Bond Position:  [32.82039199]


portfolio before change:  [44.01857399]
curr_Stock_Price:  102.29880382359065
curr_Factors:  [102.29880382]
mat_Sqrt:  [[0.15]]
grads:  [0.16106141]
Stock Position:  0.16106141260127602
Bond Position:  [27.54218414]


portfolio before change:  [43.96127775]
curr_Stock_Price:  101.85753871714464
curr_Factors:  [101.85753872]
mat_Sqrt:  [[0.15]]
grads:  [0.0134362]
Stock Position:  0.013436204388702588
Bond Position:  [42.59269904]


portfolio before change:  [43.99022333]
curr_Stock_Price:  102.42644305756997
curr_Factors:  [102.42644306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.99022333]
Stock Price:  101.19766689810328
PL:  [42.79255644]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-5.52622921e-02]
 [ 2.35863730e-03]
 [ 1.08922232e-03]
 [-4.74320606e-03]
 [ 9.66979793e-03]
 [ 1.64392522e-02]
 [ 1.34144279e-02]
 [ 5.26384766e-03]
 [-7.37943415e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-49.24294998]
curr_Stock_Price:  96.70324716268361
curr_Factors:  [96.70324716]
mat_Sqrt:  [[0.15]]
grads:  [-0.36841528]
Stock Position:  -0.3684152806149814
Bond Position:  [-13.61599604]


portfolio before change:  [-49.18502276]
curr_Stock_Price:  96.52752991596839
curr_Factors:  [96.52752992]
mat_Sqrt:  [[0.15]]
grads:  [0.01572425]
Stock Position:  0.01572424867094354
Bond Position:  [-50.70284564]


portfolio before change:  [-49.19611048]
curr_Stock_Price:  97.43504797774463
curr_Factors:  [97.43504798]
mat_Sqrt:  [[0.15]]
grads:  [0.00726148]
Stock Position:  0.0072614821567783
Bond Position:  [-49.90363334]


portfolio before change:  [-49.21937074]
curr_Stock_Price:  97.66885653814639
curr_Factors:  [97.66885654]
mat_Sqrt:  [[0.15]]
grads:  [-0.03162137]
Stock Position:  -0.03162137374038562
Bond Position:  [-46.13094733]


portfolio before change:  [-49.20870908]
curr_Stock_Price:  96.60208110588778
curr_Factors:  [96.60208111]
mat_Sqrt:  [[0.15]]
grads:  [0.06446532]
Stock Position:  0.06446531954039927
Bond Position:  [-55.4361931]


portfolio before change:  [-49.23537766]
curr_Stock_Price:  96.61846891957487
curr_Factors:  [96.61846892]
mat_Sqrt:  [[0.15]]
grads:  [0.10959501]
Stock Position:  0.10959501459946594
Bond Position:  [-59.82428017]


portfolio before change:  [-49.33235575]
curr_Stock_Price:  96.00659372101799
curr_Factors:  [96.00659372]
mat_Sqrt:  [[0.15]]
grads:  [0.08942952]
Stock Position:  0.08942951930276168
Bond Position:  [-57.91817928]


portfolio before change:  [-49.29352465]
curr_Stock_Price:  96.76470386193205
curr_Factors:  [96.76470386]
mat_Sqrt:  [[0.15]]
grads:  [0.03509232]
Stock Position:  0.03509231774033099
Bond Position:  [-52.68922239]


portfolio before change:  [-49.26316705]
curr_Stock_Price:  98.38069287021105
curr_Factors:  [98.38069287]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-49.26316705]
Stock Price:  95.81942756773115
PL:  [-49.26316705]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 1.44670056e-02]
 [ 6.93142937e-03]
 [-2.33532177e-04]
 [-4.78385392e-03]
 [ 1.22840445e-02]
 [ 1.65660786e-02]
 [ 1.03914346e-02]
 [ 7.80458766e-03]
 [-3.32010225e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.91867569]
curr_Stock_Price:  100.0353209574304
curr_Factors:  [100.03532096]
mat_Sqrt:  [[0.15]]
grads:  [0.0964467]
Stock Position:  0.0964467038488944
Bond Position:  [-7.72940128]


portfolio before change:  [1.98551896]
curr_Stock_Price:  100.76846096335524
curr_Factors:  [100.76846096]
mat_Sqrt:  [[0.15]]
grads:  [0.04620953]
Stock Position:  0.046209529114654715
Bond Position:  [-2.67094417]


portfolio before change:  [2.02253777]
curr_Stock_Price:  101.59847618232754
curr_Factors:  [101.59847618]
mat_Sqrt:  [[0.15]]
grads:  [-0.00155688]
Stock Position:  -0.0015568811792643225
Bond Position:  [2.18071452]


portfolio before change:  [2.03058577]
curr_Stock_Price:  97.12968703539103
curr_Factors:  [97.12968704]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189236]
Stock Position:  -0.031892359495617396
Bond Position:  [5.12828067]


portfolio before change:  [2.09218048]
curr_Stock_Price:  95.27877577149779
curr_Factors:  [95.27877577]
mat_Sqrt:  [[0.15]]
grads:  [0.08189363]
Stock Position:  0.08189362998957492
Bond Position:  [-5.71054433]


portfolio before change:  [2.07298452]
curr_Stock_Price:  95.07924896760261
curr_Factors:  [95.07924897]
mat_Sqrt:  [[0.15]]
grads:  [0.11044052]
Stock Position:  0.11044052424887088
Bond Position:  [-8.42761758]


portfolio before change:  [1.90394498]
curr_Stock_Price:  93.58681964261292
curr_Factors:  [93.58681964]
mat_Sqrt:  [[0.15]]
grads:  [0.06927623]
Stock Position:  0.06927623046164497
Bond Position:  [-4.5793971]


portfolio before change:  [2.07188086]
curr_Stock_Price:  96.04402831118205
curr_Factors:  [96.04402831]
mat_Sqrt:  [[0.15]]
grads:  [0.05203058]
Stock Position:  0.05203058441898752
Bond Position:  [-2.92534606]


portfolio before change:  [1.91682298]
curr_Stock_Price:  93.09201753776422
curr_Factors:  [93.09201754]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.91682298]
Stock Price:  92.49678560828606
PL:  [1.91682298]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.28807622e-03]
 [ 6.41264189e-03]
 [-3.06030693e-03]
 [-1.33073956e-02]
 [-3.74702946e-04]
 [ 1.64228712e-02]
 [ 5.64608475e-03]
 [ 5.61840361e-03]
 [ 3.65556529e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.2434103]
curr_Stock_Price:  102.07545017424493
curr_Factors:  [102.07545017]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525384]
Stock Position:  -0.015253841457129047
Bond Position:  [34.80045303]


portfolio before change:  [33.22198079]
curr_Stock_Price:  104.62130616257842
curr_Factors:  [104.62130616]
mat_Sqrt:  [[0.15]]
grads:  [0.04275095]
Stock Position:  0.0427509459546654
Bond Position:  [28.74932099]


portfolio before change:  [33.20241617]
curr_Stock_Price:  103.82733824295117
curr_Factors:  [103.82733824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02040205]
Stock Position:  -0.020402046181915327
Bond Position:  [35.32070632]


portfolio before change:  [33.17102376]
curr_Stock_Price:  106.23186045673236
curr_Factors:  [106.23186046]
mat_Sqrt:  [[0.15]]
grads:  [-0.08871597]
Stock Position:  -0.08871597083531357
Bond Position:  [42.5954864]


portfolio before change:  [33.23217024]
curr_Stock_Price:  105.78274845499695
curr_Factors:  [105.78274845]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249802]
Stock Position:  -0.0024980196416072207
Bond Position:  [33.49641762]


portfolio before change:  [33.24927275]
curr_Stock_Price:  105.64259054323622
curr_Factors:  [105.64259054]
mat_Sqrt:  [[0.15]]
grads:  [0.10948581]
Stock Position:  0.10948580786684778
Bond Position:  [21.68290838]


portfolio before change:  [33.58287671]
curr_Stock_Price:  108.59055060773555
curr_Factors:  [108.59055061]
mat_Sqrt:  [[0.15]]
grads:  [0.03764057]
Stock Position:  0.0376405650204615
Bond Position:  [29.49546703]


portfolio before change:  [33.61060318]
curr_Stock_Price:  108.93525986421285
curr_Factors:  [108.93525986]
mat_Sqrt:  [[0.15]]
grads:  [0.03745602]
Stock Position:  0.037456024051506054
Bond Position:  [29.53032147]


portfolio before change:  [33.68801389]
curr_Stock_Price:  110.60767050981045
curr_Factors:  [110.60767051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.68801389]
Stock Price:  110.95395211310438
PL:  [22.73406177]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 4.90136917e-03]
 [ 6.96820006e-03]
 [-1.02682893e-04]
 [-1.11303972e-02]
 [-1.62059039e-03]
 [ 1.64209033e-02]
 [ 1.54392480e-02]
 [ 3.05383679e-03]
 [ 1.68663446e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.8036521]
curr_Stock_Price:  100.87449859612445
curr_Factors:  [100.8744986]
mat_Sqrt:  [[0.15]]
grads:  [0.03267579]
Stock Position:  0.03267579444534516
Bond Position:  [11.50749772]


portfolio before change:  [14.80895882]
curr_Stock_Price:  100.86077401739456
curr_Factors:  [100.86077402]
mat_Sqrt:  [[0.15]]
grads:  [0.04645467]
Stock Position:  0.046454667082474754
Bond Position:  [10.12350514]


portfolio before change:  [14.82795932]
curr_Stock_Price:  101.16079731056628
curr_Factors:  [101.16079731]
mat_Sqrt:  [[0.15]]
grads:  [-0.00068455]
Stock Position:  -0.0006845526200765064
Bond Position:  [14.89720921]


portfolio before change:  [14.83325822]
curr_Stock_Price:  104.30383221780069
curr_Factors:  [104.30383222]
mat_Sqrt:  [[0.15]]
grads:  [-0.07420265]
Stock Position:  -0.07420264786190059
Bond Position:  [22.57287875]


portfolio before change:  [14.66838036]
curr_Stock_Price:  106.67796737767304
curr_Factors:  [106.67796738]
mat_Sqrt:  [[0.15]]
grads:  [-0.01080394]
Stock Position:  -0.010803935955098539
Bond Position:  [15.82092229]


portfolio before change:  [14.68361936]
curr_Stock_Price:  105.99982941567919
curr_Factors:  [105.99982942]
mat_Sqrt:  [[0.15]]
grads:  [0.10947269]
Stock Position:  0.10947268854225936
Bond Position:  [3.07953305]


portfolio before change:  [14.60671279]
curr_Stock_Price:  105.28324225972852
curr_Factors:  [105.28324226]
mat_Sqrt:  [[0.15]]
grads:  [0.10292832]
Stock Position:  0.10292832015837144
Bond Position:  [3.77008552]


portfolio before change:  [14.78123247]
curr_Stock_Price:  106.96046933369102
curr_Factors:  [106.96046933]
mat_Sqrt:  [[0.15]]
grads:  [0.02035891]
Stock Position:  0.02035891192141389
Bond Position:  [12.6036337]


portfolio before change:  [14.7891671]
curr_Stock_Price:  107.040593499085
curr_Factors:  [107.0405935]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.7891671]
Stock Price:  106.41294662888441
PL:  [8.37622047]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 9.90577287e-03]
 [ 6.92204927e-03]
 [ 1.39256888e-03]
 [-1.01328047e-02]
 [ 2.15833432e-03]
 [ 1.64248508e-02]
 [ 2.04764311e-02]
 [ 1.34030162e-03]
 [ 1.47876573e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.25596604]
curr_Stock_Price:  100.25267327111187
curr_Factors:  [100.25267327]
mat_Sqrt:  [[0.15]]
grads:  [0.06603849]
Stock Position:  0.06603848581856162
Bond Position:  [-1.3645687]


portfolio before change:  [5.36639436]
curr_Stock_Price:  101.93518874801498
curr_Factors:  [101.93518875]
mat_Sqrt:  [[0.15]]
grads:  [0.046147]
Stock Position:  0.04614699513025654
Bond Position:  [0.6623917]


portfolio before change:  [5.28282324]
curr_Stock_Price:  100.11703356429511
curr_Factors:  [100.11703356]
mat_Sqrt:  [[0.15]]
grads:  [0.00928379]
Stock Position:  0.009283792536939117
Bond Position:  [4.35335747]


portfolio before change:  [5.31620833]
curr_Stock_Price:  103.47857644227102
curr_Factors:  [103.47857644]
mat_Sqrt:  [[0.15]]
grads:  [-0.06755203]
Stock Position:  -0.06755203163519066
Bond Position:  [12.3063964]


portfolio before change:  [5.26705335]
curr_Stock_Price:  104.29734848238631
curr_Factors:  [104.29734848]
mat_Sqrt:  [[0.15]]
grads:  [0.0143889]
Stock Position:  0.01438889548035433
Bond Position:  [3.7663297]


portfolio before change:  [5.28312259]
curr_Stock_Price:  105.2832202926321
curr_Factors:  [105.28322029]
mat_Sqrt:  [[0.15]]
grads:  [0.10949901]
Stock Position:  0.10949900546467033
Bond Position:  [-6.24528532]


portfolio before change:  [5.10392935]
curr_Stock_Price:  103.67526217556821
curr_Factors:  [103.67526218]
mat_Sqrt:  [[0.15]]
grads:  [0.13650954]
Stock Position:  0.13650954083506645
Bond Position:  [-9.04873308]


portfolio before change:  [5.2537553]
curr_Stock_Price:  104.80596296698619
curr_Factors:  [104.80596297]
mat_Sqrt:  [[0.15]]
grads:  [0.00893534]
Stock Position:  0.008935344139290386
Bond Position:  [4.31727796]


portfolio before change:  [5.24789412]
curr_Stock_Price:  103.90836288802545
curr_Factors:  [103.90836289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.24789412]
Stock Price:  102.99450430236791
PL:  [2.25338981]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [ 2.66222646e-02]
 [ 3.62032235e-03]
 [ 1.16938637e-03]
 [-4.83411024e-03]
 [ 1.25345162e-02]
 [ 1.59539953e-02]
 [ 2.36832862e-02]
 [ 3.02910208e-03]
 [-5.31427779e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.73138209]
curr_Stock_Price:  99.53708508736649
curr_Factors:  [99.53708509]
mat_Sqrt:  [[0.15]]
grads:  [0.17748176]
Stock Position:  0.17748176384644818
Bond Position:  [-23.39739952]


portfolio before change:  [-5.99636455]
curr_Stock_Price:  98.11000420706088
curr_Factors:  [98.11000421]
mat_Sqrt:  [[0.15]]
grads:  [0.02413548]
Stock Position:  0.02413548235307365
Bond Position:  [-8.36429683]


portfolio before change:  [-6.01962063]
curr_Stock_Price:  97.31976171602008
curr_Factors:  [97.31976172]
mat_Sqrt:  [[0.15]]
grads:  [0.00779591]
Stock Position:  0.007795909104088296
Bond Position:  [-6.77831665]


portfolio before change:  [-6.01094735]
curr_Stock_Price:  98.86714863401104
curr_Factors:  [98.86714863]
mat_Sqrt:  [[0.15]]
grads:  [-0.0322274]
Stock Position:  -0.03222740158637495
Bond Position:  [-2.82471604]


portfolio before change:  [-6.0868942]
curr_Stock_Price:  101.17990550743328
curr_Factors:  [101.17990551]
mat_Sqrt:  [[0.15]]
grads:  [0.08356344]
Stock Position:  0.08356344122642537
Bond Position:  [-14.54183529]


portfolio before change:  [-6.16148188]
curr_Stock_Price:  100.37435056576108
curr_Factors:  [100.37435057]
mat_Sqrt:  [[0.15]]
grads:  [0.10635997]
Stock Position:  0.10635996898311162
Bond Position:  [-16.83729469]


portfolio before change:  [-5.94134254]
curr_Stock_Price:  102.52328025616086
curr_Factors:  [102.52328026]
mat_Sqrt:  [[0.15]]
grads:  [0.15788857]
Stock Position:  0.15788857446369997
Bond Position:  [-22.12859711]


portfolio before change:  [-6.21510612]
curr_Stock_Price:  100.85947069766706
curr_Factors:  [100.8594707]
mat_Sqrt:  [[0.15]]
grads:  [0.02019401]
Stock Position:  0.020194013865528437
Bond Position:  [-8.25186367]


portfolio before change:  [-6.22999728]
curr_Stock_Price:  100.32643186045715
curr_Factors:  [100.32643186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.22999728]
Stock Price:  100.39798245268989
PL:  [-6.62797973]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.30314342e+00]
 [-2.62386470e-04]
 [ 7.05934840e-03]
 [-4.51341379e-03]
 [-1.41321717e-02]
 [ 4.82994504e-03]
 [ 1.64211719e-02]
 [ 1.68037668e-02]
 [ 1.59878149e-03]
 [ 3.80029321e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30314342]
mat_Sqrt:  [[0.15]]
grads:  [15.3542895]
init_Out:  [2.14318206]
Stock Position:  15.354289497234625
Bond position:  [-1533.28576766]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.12622083]
curr_Stock_Price:  101.74217591444766
curr_Factors:  [101.74217591]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174924]
Stock Position:  -0.0017492431317850852
Bond Position:  [28.30419263]


portfolio before change:  [28.14116181]
curr_Stock_Price:  101.29321419362874
curr_Factors:  [101.29321419]
mat_Sqrt:  [[0.15]]
grads:  [0.04706232]
Stock Position:  0.04706232265303741
Bond Position:  [23.37406788]


portfolio before change:  [28.32458961]
curr_Stock_Price:  104.94237200964156
curr_Factors:  [104.94237201]
mat_Sqrt:  [[0.15]]
grads:  [-0.03008943]
Stock Position:  -0.030089425283078137
Bond Position:  [31.48224527]


portfolio before change:  [28.27701744]
curr_Stock_Price:  107.04667370348145
curr_Factors:  [107.0466737]
mat_Sqrt:  [[0.15]]
grads:  [-0.09421448]
Stock Position:  -0.09421447798429339
Bond Position:  [38.36236392]


portfolio before change:  [28.62255404]
curr_Stock_Price:  103.58276206127952
curr_Factors:  [103.58276206]
mat_Sqrt:  [[0.15]]
grads:  [0.03219963]
Stock Position:  0.032199633598793576
Bond Position:  [25.28722706]


portfolio before change:  [28.7114592]
curr_Stock_Price:  105.95106172919728
curr_Factors:  [105.95106173]
mat_Sqrt:  [[0.15]]
grads:  [0.10947448]
Stock Position:  0.10947447949827716
Bond Position:  [17.11252187]


portfolio before change:  [28.59924063]
curr_Stock_Price:  104.84781856338293
curr_Factors:  [104.84781856]
mat_Sqrt:  [[0.15]]
grads:  [0.11202511]
Stock Position:  0.11202511217081725
Bond Position:  [16.85365199]


portfolio before change:  [28.39503004]
curr_Stock_Price:  102.94967697819517
curr_Factors:  [102.94967698]
mat_Sqrt:  [[0.15]]
grads:  [0.01065854]
Stock Position:  0.010658543275305044
Bond Position:  [27.29773645]


portfolio before change:  [28.42484228]
curr_Stock_Price:  104.46582829748141
curr_Factors:  [104.4658283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.42484228]
Stock Price:  105.177450123925
PL:  [23.24739216]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.0037828242656904364
FINAL STD P&L:  22.613716892276067
