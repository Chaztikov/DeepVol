WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 00:37:38.613136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 00:37:39.014203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-17 00:37:39.015900: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:37:39.032115: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:37:39.050865: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:37:39.086711: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:37:39.109933: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:37:39.125759: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:37:39.163692: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:37:39.232003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:37:39.232417: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 00:37:39.239150: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399950000 Hz
2019-12-17 00:37:39.239341: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c179218030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:37:39.239359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 00:37:39.273679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-17 00:37:39.273723: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:37:39.273737: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:37:39.273749: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:37:39.273760: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:37:39.273772: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:37:39.273783: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:37:39.273795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:37:39.342844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:37:39.342887: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:37:40.533047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 00:37:40.533096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 00:37:40.533107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 00:37:40.639209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-17 00:37:40.643537: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c179851280 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:37:40.643573: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 00:38:51.497701: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4975e+02,   Y0: 2.1435e+00,  elapsed time  71
INFO   step:     1,    loss: 2.4162e+02,   Y0: 2.1485e+00,  elapsed time 108
INFO   step:     2,    loss: 1.6346e+01,   Y0: 2.1462e+00,  elapsed time 108
INFO   step:     3,    loss: 1.2619e+01,   Y0: 2.1426e+00,  elapsed time 108
INFO   step:     4,    loss: 1.1321e+01,   Y0: 2.1399e+00,  elapsed time 109
INFO   step:     5,    loss: 1.0675e+01,   Y0: 2.1394e+00,  elapsed time 109
INFO   step:     6,    loss: 1.0277e+01,   Y0: 2.1406e+00,  elapsed time 109
INFO   step:     7,    loss: 1.0061e+01,   Y0: 2.1403e+00,  elapsed time 110
INFO   step:     8,    loss: 9.9116e+00,   Y0: 2.1385e+00,  elapsed time 110
INFO   step:     9,    loss: 9.7914e+00,   Y0: 2.1377e+00,  elapsed time 110
INFO   step:    10,    loss: 9.7027e+00,   Y0: 2.1363e+00,  elapsed time 110
INFO   step:    11,    loss: 9.6198e+00,   Y0: 2.1366e+00,  elapsed time 111
INFO   step:    12,    loss: 9.5481e+00,   Y0: 2.1372e+00,  elapsed time 111
INFO   step:    13,    loss: 9.4856e+00,   Y0: 2.1368e+00,  elapsed time 111
INFO   step:    14,    loss: 9.4321e+00,   Y0: 2.1374e+00,  elapsed time 111
INFO   step:    15,    loss: 9.3869e+00,   Y0: 2.1382e+00,  elapsed time 112
INFO   step:    16,    loss: 9.3464e+00,   Y0: 2.1381e+00,  elapsed time 112
INFO   step:    17,    loss: 9.3137e+00,   Y0: 2.1385e+00,  elapsed time 112
INFO   step:    18,    loss: 9.2845e+00,   Y0: 2.1398e+00,  elapsed time 112
INFO   step:    19,    loss: 9.2609e+00,   Y0: 2.1415e+00,  elapsed time 113
INFO   step:    20,    loss: 9.2376e+00,   Y0: 2.1438e+00,  elapsed time 113
INFO   step:    21,    loss: 9.2169e+00,   Y0: 2.1453e+00,  elapsed time 113
INFO   step:    22,    loss: 9.1981e+00,   Y0: 2.1459e+00,  elapsed time 114
INFO   step:    23,    loss: 9.1807e+00,   Y0: 2.1461e+00,  elapsed time 114
INFO   step:    24,    loss: 9.1656e+00,   Y0: 2.1458e+00,  elapsed time 114
INFO   step:    25,    loss: 9.1504e+00,   Y0: 2.1453e+00,  elapsed time 114
INFO   step:    26,    loss: 9.1369e+00,   Y0: 2.1452e+00,  elapsed time 115
INFO   step:    27,    loss: 9.1246e+00,   Y0: 2.1456e+00,  elapsed time 115
INFO   step:    28,    loss: 9.1133e+00,   Y0: 2.1457e+00,  elapsed time 115
INFO   step:    29,    loss: 9.1027e+00,   Y0: 2.1450e+00,  elapsed time 115
INFO   step:    30,    loss: 9.0921e+00,   Y0: 2.1442e+00,  elapsed time 116
INFO   step:    31,    loss: 9.0827e+00,   Y0: 2.1434e+00,  elapsed time 116
INFO   step:    32,    loss: 9.0738e+00,   Y0: 2.1434e+00,  elapsed time 116
INFO   step:    33,    loss: 9.0659e+00,   Y0: 2.1435e+00,  elapsed time 116
INFO   step:    34,    loss: 9.0588e+00,   Y0: 2.1440e+00,  elapsed time 117
INFO   step:    35,    loss: 9.0526e+00,   Y0: 2.1442e+00,  elapsed time 117
INFO   step:    36,    loss: 9.0470e+00,   Y0: 2.1451e+00,  elapsed time 117
INFO   step:    37,    loss: 9.0419e+00,   Y0: 2.1454e+00,  elapsed time 117
INFO   step:    38,    loss: 9.0374e+00,   Y0: 2.1457e+00,  elapsed time 118
INFO   step:    39,    loss: 9.0336e+00,   Y0: 2.1458e+00,  elapsed time 118
INFO   step:    40,    loss: 9.0302e+00,   Y0: 2.1459e+00,  elapsed time 118
INFO   step:    41,    loss: 9.0272e+00,   Y0: 2.1462e+00,  elapsed time 119
INFO   step:    42,    loss: 9.0243e+00,   Y0: 2.1465e+00,  elapsed time 119
INFO   step:    43,    loss: 9.0213e+00,   Y0: 2.1464e+00,  elapsed time 119
INFO   step:    44,    loss: 9.0188e+00,   Y0: 2.1458e+00,  elapsed time 119
INFO   step:    45,    loss: 9.0164e+00,   Y0: 2.1456e+00,  elapsed time 120
INFO   step:    46,    loss: 9.0143e+00,   Y0: 2.1459e+00,  elapsed time 120
INFO   step:    47,    loss: 9.0122e+00,   Y0: 2.1458e+00,  elapsed time 120
INFO   step:    48,    loss: 9.0104e+00,   Y0: 2.1458e+00,  elapsed time 120
INFO   step:    49,    loss: 9.0084e+00,   Y0: 2.1467e+00,  elapsed time 121
INFO   step:    50,    loss: 9.0066e+00,   Y0: 2.1480e+00,  elapsed time 121
INFO   step:    51,    loss: 9.0050e+00,   Y0: 2.1494e+00,  elapsed time 121
INFO   step:    52,    loss: 9.0035e+00,   Y0: 2.1505e+00,  elapsed time 121
INFO   step:    53,    loss: 9.0024e+00,   Y0: 2.1508e+00,  elapsed time 122
INFO   step:    54,    loss: 9.0012e+00,   Y0: 2.1510e+00,  elapsed time 122
INFO   step:    55,    loss: 9.0000e+00,   Y0: 2.1508e+00,  elapsed time 122
INFO   step:    56,    loss: 8.9990e+00,   Y0: 2.1505e+00,  elapsed time 123
INFO   step:    57,    loss: 8.9981e+00,   Y0: 2.1510e+00,  elapsed time 123
INFO   step:    58,    loss: 8.9971e+00,   Y0: 2.1516e+00,  elapsed time 123
INFO   step:    59,    loss: 8.9963e+00,   Y0: 2.1524e+00,  elapsed time 123
INFO   step:    60,    loss: 8.9957e+00,   Y0: 2.1536e+00,  elapsed time 124
INFO   step:    61,    loss: 8.9952e+00,   Y0: 2.1544e+00,  elapsed time 124
INFO   step:    62,    loss: 8.9947e+00,   Y0: 2.1554e+00,  elapsed time 124
INFO   step:    63,    loss: 8.9943e+00,   Y0: 2.1564e+00,  elapsed time 124
INFO   step:    64,    loss: 8.9939e+00,   Y0: 2.1578e+00,  elapsed time 125
INFO   step:    65,    loss: 8.9937e+00,   Y0: 2.1594e+00,  elapsed time 125
INFO   step:    66,    loss: 8.9938e+00,   Y0: 2.1614e+00,  elapsed time 125
INFO   step:    67,    loss: 8.9941e+00,   Y0: 2.1626e+00,  elapsed time 126
INFO   step:    68,    loss: 8.9941e+00,   Y0: 2.1630e+00,  elapsed time 126
INFO   step:    69,    loss: 8.9942e+00,   Y0: 2.1632e+00,  elapsed time 126
INFO   step:    70,    loss: 8.9942e+00,   Y0: 2.1630e+00,  elapsed time 126
INFO   step:    71,    loss: 8.9943e+00,   Y0: 2.1625e+00,  elapsed time 127
INFO   step:    72,    loss: 8.9941e+00,   Y0: 2.1613e+00,  elapsed time 127
INFO   step:    73,    loss: 8.9938e+00,   Y0: 2.1597e+00,  elapsed time 127
INFO   step:    74,    loss: 8.9936e+00,   Y0: 2.1589e+00,  elapsed time 127
INFO   step:    75,    loss: 8.9934e+00,   Y0: 2.1580e+00,  elapsed time 128
INFO   step:    76,    loss: 8.9931e+00,   Y0: 2.1575e+00,  elapsed time 128
INFO   step:    77,    loss: 8.9927e+00,   Y0: 2.1574e+00,  elapsed time 128
INFO   step:    78,    loss: 8.9924e+00,   Y0: 2.1565e+00,  elapsed time 129
INFO   step:    79,    loss: 8.9920e+00,   Y0: 2.1563e+00,  elapsed time 129
INFO   step:    80,    loss: 8.9916e+00,   Y0: 2.1561e+00,  elapsed time 129
INFO   step:    81,    loss: 8.9912e+00,   Y0: 2.1555e+00,  elapsed time 129
INFO   step:    82,    loss: 8.9908e+00,   Y0: 2.1555e+00,  elapsed time 130
INFO   step:    83,    loss: 8.9904e+00,   Y0: 2.1554e+00,  elapsed time 130
INFO   step:    84,    loss: 8.9900e+00,   Y0: 2.1553e+00,  elapsed time 130
INFO   step:    85,    loss: 8.9897e+00,   Y0: 2.1551e+00,  elapsed time 130
INFO   step:    86,    loss: 8.9895e+00,   Y0: 2.1554e+00,  elapsed time 131
INFO   step:    87,    loss: 8.9892e+00,   Y0: 2.1552e+00,  elapsed time 131
INFO   step:    88,    loss: 8.9890e+00,   Y0: 2.1545e+00,  elapsed time 131
INFO   step:    89,    loss: 8.9887e+00,   Y0: 2.1544e+00,  elapsed time 132
INFO   step:    90,    loss: 8.9885e+00,   Y0: 2.1536e+00,  elapsed time 132
INFO   step:    91,    loss: 8.9884e+00,   Y0: 2.1527e+00,  elapsed time 132
INFO   step:    92,    loss: 8.9882e+00,   Y0: 2.1526e+00,  elapsed time 132
INFO   step:    93,    loss: 8.9881e+00,   Y0: 2.1534e+00,  elapsed time 133
INFO   step:    94,    loss: 8.9880e+00,   Y0: 2.1546e+00,  elapsed time 133
INFO   step:    95,    loss: 8.9878e+00,   Y0: 2.1559e+00,  elapsed time 133
INFO   step:    96,    loss: 8.9877e+00,   Y0: 2.1564e+00,  elapsed time 133
INFO   step:    97,    loss: 8.9876e+00,   Y0: 2.1563e+00,  elapsed time 134
INFO   step:    98,    loss: 8.9875e+00,   Y0: 2.1564e+00,  elapsed time 134
INFO   step:    99,    loss: 8.9874e+00,   Y0: 2.1565e+00,  elapsed time 134
INFO   step:   100,    loss: 8.9873e+00,   Y0: 2.1557e+00,  elapsed time 135
INFO   step:   101,    loss: 8.9872e+00,   Y0: 2.1548e+00,  elapsed time 135
INFO   step:   102,    loss: 8.9871e+00,   Y0: 2.1549e+00,  elapsed time 135
INFO   step:   103,    loss: 8.9870e+00,   Y0: 2.1541e+00,  elapsed time 135
INFO   step:   104,    loss: 8.9870e+00,   Y0: 2.1538e+00,  elapsed time 136
INFO   step:   105,    loss: 8.9869e+00,   Y0: 2.1529e+00,  elapsed time 136
INFO   step:   106,    loss: 8.9868e+00,   Y0: 2.1512e+00,  elapsed time 136
INFO   step:   107,    loss: 8.9868e+00,   Y0: 2.1495e+00,  elapsed time 136
INFO   step:   108,    loss: 8.9867e+00,   Y0: 2.1484e+00,  elapsed time 137
INFO   step:   109,    loss: 8.9867e+00,   Y0: 2.1478e+00,  elapsed time 137
INFO   step:   110,    loss: 8.9866e+00,   Y0: 2.1475e+00,  elapsed time 137
INFO   step:   111,    loss: 8.9866e+00,   Y0: 2.1469e+00,  elapsed time 137
INFO   step:   112,    loss: 8.9866e+00,   Y0: 2.1465e+00,  elapsed time 138
INFO   step:   113,    loss: 8.9865e+00,   Y0: 2.1460e+00,  elapsed time 138
INFO   step:   114,    loss: 8.9865e+00,   Y0: 2.1454e+00,  elapsed time 138
INFO   step:   115,    loss: 8.9865e+00,   Y0: 2.1443e+00,  elapsed time 139
INFO   step:   116,    loss: 8.9864e+00,   Y0: 2.1429e+00,  elapsed time 139
INFO   step:   117,    loss: 8.9864e+00,   Y0: 2.1420e+00,  elapsed time 139
INFO   step:   118,    loss: 8.9864e+00,   Y0: 2.1398e+00,  elapsed time 139
INFO   step:   119,    loss: 8.9864e+00,   Y0: 2.1381e+00,  elapsed time 140
INFO   step:   120,    loss: 8.9865e+00,   Y0: 2.1367e+00,  elapsed time 140
INFO   step:   121,    loss: 8.9865e+00,   Y0: 2.1354e+00,  elapsed time 140
INFO   step:   122,    loss: 8.9864e+00,   Y0: 2.1350e+00,  elapsed time 140
INFO   step:   123,    loss: 8.9864e+00,   Y0: 2.1349e+00,  elapsed time 141
INFO   step:   124,    loss: 8.9864e+00,   Y0: 2.1348e+00,  elapsed time 141
INFO   step:   125,    loss: 8.9863e+00,   Y0: 2.1352e+00,  elapsed time 141
INFO   step:   126,    loss: 8.9863e+00,   Y0: 2.1361e+00,  elapsed time 141
INFO   step:   127,    loss: 8.9862e+00,   Y0: 2.1370e+00,  elapsed time 142
INFO   step:   128,    loss: 8.9861e+00,   Y0: 2.1387e+00,  elapsed time 142
INFO   step:   129,    loss: 8.9860e+00,   Y0: 2.1397e+00,  elapsed time 142
INFO   step:   130,    loss: 8.9860e+00,   Y0: 2.1403e+00,  elapsed time 143
INFO   step:   131,    loss: 8.9860e+00,   Y0: 2.1399e+00,  elapsed time 143
INFO   step:   132,    loss: 8.9860e+00,   Y0: 2.1392e+00,  elapsed time 143
INFO   step:   133,    loss: 8.9860e+00,   Y0: 2.1382e+00,  elapsed time 143
INFO   step:   134,    loss: 8.9860e+00,   Y0: 2.1368e+00,  elapsed time 144
INFO   step:   135,    loss: 8.9860e+00,   Y0: 2.1359e+00,  elapsed time 144
INFO   step:   136,    loss: 8.9860e+00,   Y0: 2.1347e+00,  elapsed time 144
INFO   step:   137,    loss: 8.9860e+00,   Y0: 2.1339e+00,  elapsed time 144
INFO   step:   138,    loss: 8.9860e+00,   Y0: 2.1334e+00,  elapsed time 145
INFO   step:   139,    loss: 8.9860e+00,   Y0: 2.1334e+00,  elapsed time 145
INFO   step:   140,    loss: 8.9859e+00,   Y0: 2.1338e+00,  elapsed time 145
INFO   step:   141,    loss: 8.9859e+00,   Y0: 2.1339e+00,  elapsed time 146
INFO   step:   142,    loss: 8.9859e+00,   Y0: 2.1336e+00,  elapsed time 146
INFO   step:   143,    loss: 8.9858e+00,   Y0: 2.1339e+00,  elapsed time 146
INFO   step:   144,    loss: 8.9858e+00,   Y0: 2.1342e+00,  elapsed time 146
INFO   step:   145,    loss: 8.9857e+00,   Y0: 2.1345e+00,  elapsed time 147
INFO   step:   146,    loss: 8.9857e+00,   Y0: 2.1350e+00,  elapsed time 147
INFO   step:   147,    loss: 8.9856e+00,   Y0: 2.1357e+00,  elapsed time 147
INFO   step:   148,    loss: 8.9856e+00,   Y0: 2.1366e+00,  elapsed time 147
INFO   step:   149,    loss: 8.9855e+00,   Y0: 2.1366e+00,  elapsed time 148
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_40:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_41:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_42:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_43:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_44:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_45:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_46:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_47:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_48:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_49:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_50:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_51:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_52:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_53:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_54:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_55:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_56:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_57:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_58:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_59:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_60:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_61:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_62:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_63:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_64:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_65:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_66:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_67:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_68:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_69:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_70:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_71:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_72:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_73:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_74:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_75:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_76:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_77:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_78:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_79:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  80
# of dimensions:  1
Loss out:  10.149858783789396
Output_Z_Vals:  [[[ 2.30680653e+00]
  [ 2.30680653e+00]
  [ 2.30680653e+00]
  ...
  [ 2.30680653e+00]
  [ 2.30680653e+00]
  [ 2.30680653e+00]]

 [[ 3.82112456e-03]
  [ 1.03294495e-03]
  [ 2.72007099e-03]
  ...
  [ 4.69511855e-03]
  [ 6.75520108e-04]
  [ 6.86059923e-04]]

 [[ 3.12883457e-03]
  [ 2.92979462e-03]
  [ 7.94955292e-04]
  ...
  [-5.22474347e-04]
  [ 2.82451537e-03]
  [-3.25407269e-04]]

 ...

 [[ 4.84194483e-03]
  [-1.00535666e-02]
  [-7.37261789e-04]
  ...
  [-1.28616710e-03]
  [-7.64951145e-03]
  [ 1.78199613e-02]]

 [[ 8.63891708e-03]
  [-6.69240295e-03]
  [-1.02399276e-03]
  ...
  [ 1.66037727e-03]
  [-1.54964789e-03]
  [-2.48581062e-02]]

 [[ 6.55096871e-03]
  [ 3.01847009e-02]
  [-5.26172673e-03]
  ...
  [-3.44776096e-03]
  [ 1.23756063e-02]
  [ 2.51410509e-02]]]
Z_Vals dimensionality:  (80, 200, 1)
X_test:  [[[100.          99.5456484  100.21244643 ...  93.41354337  92.27336236
    92.79075085]]

 [[100.         100.10265089 100.28085211 ... 103.58174773 103.43824928
   103.61440553]]

 [[100.          99.88211983  99.76411119 ...  99.12469051  98.95658171
    99.49377358]]

 ...

 [[100.          99.42910078  99.6188788  ...  98.38102339  99.24432952
    99.39713649]]

 [[100.         100.19722749 100.06356115 ... 100.63110311 101.14548749
   101.16228089]]

 [[100.         100.1944386  101.03582145 ... 112.21094782 112.44946736
   113.42682654]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.82112456e-03]
 [ 3.12883457e-03]
 [-1.33221116e-03]
 [ 5.61144123e-03]
 [ 4.59866188e-03]
 [ 1.78326201e-02]
 [ 1.08838094e-03]
 [-1.75461946e-02]
 [-5.24863938e-03]
 [ 2.91593497e-02]
 [-3.43378414e-02]
 [ 2.29019818e-02]
 [-1.13345806e-02]
 [ 1.13263921e-02]
 [-6.91260753e-03]
 [ 7.09884605e-03]
 [ 9.20627633e-03]
 [-8.56501099e-03]
 [ 1.66540713e-03]
 [ 9.14331143e-03]
 [ 1.26303422e-02]
 [-1.04747526e-02]
 [ 3.68400468e-03]
 [-3.43667011e-02]
 [-1.17092867e-02]
 [-4.29912556e-03]
 [-4.69038878e-04]
 [ 1.11237894e-02]
 [-4.29513459e-02]
 [ 4.86649408e-03]
 [ 1.47514042e-02]
 [-1.32016536e-02]
 [-6.37994895e-03]
 [ 8.84301455e-03]
 [ 1.38739108e-02]
 [-3.77173134e-03]
 [-2.77085560e-02]
 [ 7.19874877e-03]
 [-5.59667354e-02]
 [-1.99826836e-02]
 [-1.60318829e-02]
 [ 6.53025638e-02]
 [ 2.35776929e-02]
 [ 2.77922622e-03]
 [ 1.23095741e-02]
 [ 3.31291625e-02]
 [-5.17612213e-03]
 [ 3.11787115e-03]
 [ 3.26296389e-02]
 [ 8.55336523e-03]
 [ 2.31125727e-02]
 [ 1.44882835e-02]
 [-6.97692312e-04]
 [ 4.34188721e-03]
 [ 4.28081971e-03]
 [ 5.21133379e-03]
 [-2.26259468e-02]
 [ 5.62495755e-04]
 [ 1.61057787e-03]
 [-9.91397694e-02]
 [-1.58490594e-02]
 [ 1.74564182e-02]
 [ 1.79337425e-02]
 [-1.98377665e-02]
 [-4.74831773e-03]
 [-1.78437498e-02]
 [-3.68002263e-03]
 [-9.21547280e-03]
 [-2.41057158e-02]
 [ 1.85309091e-02]
 [ 2.03211576e-02]
 [ 1.36671235e-02]
 [ 9.23336849e-04]
 [ 8.05538197e-03]
 [ 2.26097776e-02]
 [-2.06210723e-02]
 [ 4.84194483e-03]
 [ 8.63891708e-03]
 [ 6.55096871e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.94576484]
curr_Stock_Price:  99.54564840005536
curr_Factors:  [99.5456484]
mat_Sqrt:  [[0.15]]
grads:  [0.02547416]
Stock Position:  0.02547416376195636
Bond Position:  [-7.48160699]


portfolio before change:  [-4.92924634]
curr_Stock_Price:  100.21244643482353
curr_Factors:  [100.21244643]
mat_Sqrt:  [[0.15]]
grads:  [0.0208589]
Stock Position:  0.020858897149613632
Bond Position:  [-7.01956745]


portfolio before change:  [-4.92611169]
curr_Stock_Price:  100.38375856132615
curr_Factors:  [100.38375856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00888141]
Stock Position:  -0.008881407718751006
Bond Position:  [-4.0345626]


portfolio before change:  [-4.92914961]
curr_Stock_Price:  100.6974202092316
curr_Factors:  [100.69742021]
mat_Sqrt:  [[0.15]]
grads:  [0.03740961]
Stock Position:  0.0374096081695191
Bond Position:  [-8.69620065]


portfolio before change:  [-4.96109479]
curr_Stock_Price:  99.8580195572154
curr_Factors:  [99.85801956]
mat_Sqrt:  [[0.15]]
grads:  [0.03065775]
Stock Position:  0.030657745892517456
Bond Position:  [-8.02251658]


portfolio before change:  [-4.9883791]
curr_Stock_Price:  98.98441046639996
curr_Factors:  [98.98441047]
mat_Sqrt:  [[0.15]]
grads:  [0.11888413]
Stock Position:  0.11888413411921629
Bond Position:  [-16.75605503]


portfolio before change:  [-4.955539]
curr_Stock_Price:  99.2694560040567
curr_Factors:  [99.269456]
mat_Sqrt:  [[0.15]]
grads:  [0.00725587]
Stock Position:  0.007255872957598124
Bond Position:  [-5.67582556]


portfolio before change:  [-4.9572578]
curr_Stock_Price:  99.0814631928017
curr_Factors:  [99.08146319]
mat_Sqrt:  [[0.15]]
grads:  [-0.11697463]
Stock Position:  -0.11697463078756877
Bond Position:  [6.63275978]


portfolio before change:  [-4.8743701]
curr_Stock_Price:  98.37641171003582
curr_Factors:  [98.37641171]
mat_Sqrt:  [[0.15]]
grads:  [-0.03499093]
Stock Position:  -0.034990929202214846
Bond Position:  [-1.43208804]


portfolio before change:  [-4.85652539]
curr_Stock_Price:  97.86387259550234
curr_Factors:  [97.8638726]
mat_Sqrt:  [[0.15]]
grads:  [0.19439566]
Stock Position:  0.1943956645973954
Bond Position:  [-23.88083794]


portfolio before change:  [-4.85345597]
curr_Stock_Price:  97.88734029098198
curr_Factors:  [97.88734029]
mat_Sqrt:  [[0.15]]
grads:  [-0.22891894]
Stock Position:  -0.2289189425548843
Bond Position:  [17.55481046]


portfolio before change:  [-4.99734805]
curr_Stock_Price:  98.52070547489393
curr_Factors:  [98.52070547]
mat_Sqrt:  [[0.15]]
grads:  [0.15267988]
Stock Position:  0.15267987864516164
Bond Position:  [-20.0394774]


portfolio before change:  [-4.84949447]
curr_Stock_Price:  99.49729834424312
curr_Factors:  [99.49729834]
mat_Sqrt:  [[0.15]]
grads:  [-0.07556387]
Stock Position:  -0.07556387078031042
Bond Position:  [2.66890652]


portfolio before change:  [-4.86273659]
curr_Stock_Price:  99.6747499050835
curr_Factors:  [99.67474991]
mat_Sqrt:  [[0.15]]
grads:  [0.07550928]
Stock Position:  0.07550928083874316
Bond Position:  [-12.38910527]


portfolio before change:  [-4.84861951]
curr_Stock_Price:  99.87196298553384
curr_Factors:  [99.87196299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608405]
Stock Position:  -0.04608405022160654
Bond Position:  [-0.24611496]


portfolio before change:  [-4.81043195]
curr_Stock_Price:  99.04297891562366
curr_Factors:  [99.04297892]
mat_Sqrt:  [[0.15]]
grads:  [0.04732564]
Stock Position:  0.047325640357630885
Bond Position:  [-9.49770435]


portfolio before change:  [-4.85701402]
curr_Stock_Price:  98.07123427303115
curr_Factors:  [98.07123427]
mat_Sqrt:  [[0.15]]
grads:  [0.06137518]
Stock Position:  0.06137517550578099
Bond Position:  [-10.87615323]


portfolio before change:  [-4.84843705]
curr_Stock_Price:  98.22205656006247
curr_Factors:  [98.22205656]
mat_Sqrt:  [[0.15]]
grads:  [-0.05710007]
Stock Position:  -0.05710007327505859
Bond Position:  [0.76004957]


portfolio before change:  [-4.84021499]
curr_Stock_Price:  98.07889467510508
curr_Factors:  [98.07889468]
mat_Sqrt:  [[0.15]]
grads:  [0.01110271]
Stock Position:  0.011102714192844022
Bond Position:  [-5.92915693]


portfolio before change:  [-4.84614342]
curr_Stock_Price:  97.5783103516026
curr_Factors:  [97.57831035]
mat_Sqrt:  [[0.15]]
grads:  [0.06095541]
Stock Position:  0.06095540955115356
Bond Position:  [-10.79406929]


portfolio before change:  [-4.86024116]
curr_Stock_Price:  97.35809878045212
curr_Factors:  [97.35809878]
mat_Sqrt:  [[0.15]]
grads:  [0.08420228]
Stock Position:  0.08420228165197322
Bond Position:  [-13.05801521]


portfolio before change:  [-4.90728143]
curr_Stock_Price:  96.80913365965787
curr_Factors:  [96.80913366]
mat_Sqrt:  [[0.15]]
grads:  [-0.06983168]
Stock Position:  -0.06983168366693526
Bond Position:  [1.85306337]


portfolio before change:  [-4.92286535]
curr_Stock_Price:  97.03395632901231
curr_Factors:  [97.03395633]
mat_Sqrt:  [[0.15]]
grads:  [0.02456003]
Stock Position:  0.024560031178546313
Bond Position:  [-7.30602235]


portfolio before change:  [-4.925137]
curr_Stock_Price:  96.96005529042979
curr_Factors:  [96.96005529]
mat_Sqrt:  [[0.15]]
grads:  [-0.22911134]
Stock Position:  -0.2291113403367991
Bond Position:  [17.28951122]


portfolio before change:  [-4.81860415]
curr_Stock_Price:  96.49978898108996
curr_Factors:  [96.49978898]
mat_Sqrt:  [[0.15]]
grads:  [-0.07806191]
Stock Position:  -0.07806191158671319
Bond Position:  [2.71435385]


portfolio before change:  [-4.85797171]
curr_Stock_Price:  97.00627436271036
curr_Factors:  [97.00627436]
mat_Sqrt:  [[0.15]]
grads:  [-0.02866084]
Stock Position:  -0.028660837085067704
Bond Position:  [-2.07769068]


portfolio before change:  [-4.84932625]
curr_Stock_Price:  96.7000962016529
curr_Factors:  [96.7000962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00312693]
Stock Position:  -0.0031269258556937294
Bond Position:  [-4.54695222]


portfolio before change:  [-4.84808005]
curr_Stock_Price:  96.21067182356822
curr_Factors:  [96.21067182]
mat_Sqrt:  [[0.15]]
grads:  [0.0741586]
Stock Position:  0.07415859574656034
Bond Position:  [-11.98292837]


portfolio before change:  [-4.83127827]
curr_Stock_Price:  96.44733665307704
curr_Factors:  [96.44733665]
mat_Sqrt:  [[0.15]]
grads:  [-0.28634231]
Stock Position:  -0.2863423057757908
Bond Position:  [22.78567449]


portfolio before change:  [-4.72883825]
curr_Stock_Price:  96.0945565384886
curr_Factors:  [96.09455654]
mat_Sqrt:  [[0.15]]
grads:  [0.03244329]
Stock Position:  0.03244329388695555
Bond Position:  [-7.84646219]


portfolio before change:  [-4.7571812]
curr_Stock_Price:  95.23605774935378
curr_Factors:  [95.23605775]
mat_Sqrt:  [[0.15]]
grads:  [0.09834269]
Stock Position:  0.09834269447822815
Bond Position:  [-14.12295173]


portfolio before change:  [-4.77939719]
curr_Stock_Price:  95.0191298104163
curr_Factors:  [95.01912981]
mat_Sqrt:  [[0.15]]
grads:  [-0.08801102]
Stock Position:  -0.08801102408655316
Bond Position:  [3.58333373]


portfolio before change:  [-4.71207956]
curr_Stock_Price:  94.25679731383799
curr_Factors:  [94.25679731]
mat_Sqrt:  [[0.15]]
grads:  [-0.04253299]
Stock Position:  -0.0425329930235215
Bond Position:  [-0.70305586]


portfolio before change:  [-4.67204881]
curr_Stock_Price:  93.31459490902505
curr_Factors:  [93.31459491]
mat_Sqrt:  [[0.15]]
grads:  [0.05895343]
Stock Position:  0.05895343036491647
Bond Position:  [-10.17326429]


portfolio before change:  [-4.66728162]
curr_Stock_Price:  93.40624420410009
curr_Factors:  [93.4062442]
mat_Sqrt:  [[0.15]]
grads:  [0.09249274]
Stock Position:  0.09249273894415716
Bond Position:  [-13.30668098]


portfolio before change:  [-4.63374885]
curr_Stock_Price:  93.77778107856957
curr_Factors:  [93.77778108]
mat_Sqrt:  [[0.15]]
grads:  [-0.02514488]
Stock Position:  -0.025144875614492638
Bond Position:  [-2.27571821]


portfolio before change:  [-4.63054963]
curr_Stock_Price:  93.64489257413045
curr_Factors:  [93.64489257]
mat_Sqrt:  [[0.15]]
grads:  [-0.18472371]
Stock Position:  -0.18472370695994403
Bond Position:  [12.66788207]


portfolio before change:  [-4.60582424]
curr_Stock_Price:  93.5153281866953
curr_Factors:  [93.51532819]
mat_Sqrt:  [[0.15]]
grads:  [0.04799166]
Stock Position:  0.047991658473862345
Bond Position:  [-9.09377994]


portfolio before change:  [-4.63369325]
curr_Stock_Price:  92.94646616268678
curr_Factors:  [92.94646616]
mat_Sqrt:  [[0.15]]
grads:  [-0.37311157]
Stock Position:  -0.37311156917759086
Bond Position:  [30.04570858]


portfolio before change:  [-4.57531844]
curr_Stock_Price:  92.79504523747815
curr_Factors:  [92.79504524]
mat_Sqrt:  [[0.15]]
grads:  [-0.13321789]
Stock Position:  -0.13321789089610062
Bond Position:  [7.78664177]


portfolio before change:  [-4.70786398]
curr_Stock_Price:  93.79365150968148
curr_Factors:  [93.79365151]
mat_Sqrt:  [[0.15]]
grads:  [-0.10687922]
Stock Position:  -0.10687921929597435
Bond Position:  [5.31672827]


portfolio before change:  [-4.72349194]
curr_Stock_Price:  93.94298140120412
curr_Factors:  [93.9429814]
mat_Sqrt:  [[0.15]]
grads:  [0.43535043]
Stock Position:  0.4353504251109516
Bond Position:  [-45.62160883]


portfolio before change:  [-4.90278067]
curr_Stock_Price:  93.53770490534706
curr_Factors:  [93.53770491]
mat_Sqrt:  [[0.15]]
grads:  [0.15718462]
Stock Position:  0.1571846191196778
Bond Position:  [-19.60546919]


portfolio before change:  [-4.88382458]
curr_Stock_Price:  93.66609834599876
curr_Factors:  [93.66609835]
mat_Sqrt:  [[0.15]]
grads:  [0.01852817]
Stock Position:  0.0185281748251202
Bond Position:  [-6.61928642]


portfolio before change:  [-4.8845412]
curr_Stock_Price:  93.64975027979101
curr_Factors:  [93.64975028]
mat_Sqrt:  [[0.15]]
grads:  [0.08206383]
Stock Position:  0.0820638271284576
Bond Position:  [-12.56979811]


portfolio before change:  [-4.89488805]
curr_Stock_Price:  93.53324077837682
curr_Factors:  [93.53324078]
mat_Sqrt:  [[0.15]]
grads:  [0.22086108]
Stock Position:  0.2208610834417991
Bond Position:  [-25.55274095]


portfolio before change:  [-5.01669336]
curr_Stock_Price:  92.98897006958475
curr_Factors:  [92.98897007]
mat_Sqrt:  [[0.15]]
grads:  [-0.03450748]
Stock Position:  -0.03450748089336618
Bond Position:  [-1.80787826]


portfolio before change:  [-5.02003213]
curr_Stock_Price:  93.08245048191921
curr_Factors:  [93.08245048]
mat_Sqrt:  [[0.15]]
grads:  [0.02078581]
Stock Position:  0.0207858076663929
Bond Position:  [-6.95482605]


portfolio before change:  [-5.01893592]
curr_Stock_Price:  93.15610163692634
curr_Factors:  [93.15610164]
mat_Sqrt:  [[0.15]]
grads:  [0.21753093]
Stock Position:  0.21753092586047865
Bond Position:  [-25.28326896]


portfolio before change:  [-4.9739462]
curr_Stock_Price:  93.37018602553911
curr_Factors:  [93.37018603]
mat_Sqrt:  [[0.15]]
grads:  [0.05702243]
Stock Position:  0.057022434842793616
Bond Position:  [-10.29814155]


portfolio before change:  [-5.00839195]
curr_Stock_Price:  92.77740021086763
curr_Factors:  [92.77740021]
mat_Sqrt:  [[0.15]]
grads:  [0.15408382]
Stock Position:  0.1540838177057124
Bond Position:  [-19.30388797]


portfolio before change:  [-4.87445424]
curr_Stock_Price:  93.65448281348915
curr_Factors:  [93.65448281]
mat_Sqrt:  [[0.15]]
grads:  [0.09658856]
Stock Position:  0.09658855674471292
Bond Position:  [-13.92040557]


portfolio before change:  [-4.88451707]
curr_Stock_Price:  93.55930827852576
curr_Factors:  [93.55930828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00465128]
Stock Position:  -0.004651282081895517
Bond Position:  [-4.44934633]


portfolio before change:  [-4.88419103]
curr_Stock_Price:  93.42942454357065
curr_Factors:  [93.42942454]
mat_Sqrt:  [[0.15]]
grads:  [0.02894591]
Stock Position:  0.02894591475242354
Bond Position:  [-7.58859119]


portfolio before change:  [-4.87944188]
curr_Stock_Price:  93.60988013265843
curr_Factors:  [93.60988013]
mat_Sqrt:  [[0.15]]
grads:  [0.0285388]
Stock Position:  0.028538798061804697
Bond Position:  [-7.55095535]


portfolio before change:  [-4.87515505]
curr_Stock_Price:  93.77662799803146
curr_Factors:  [93.776628]
mat_Sqrt:  [[0.15]]
grads:  [0.03474223]
Stock Position:  0.03474222524608807
Bond Position:  [-8.13316378]


portfolio before change:  [-4.8844889]
curr_Stock_Price:  93.52259956105738
curr_Factors:  [93.52259956]
mat_Sqrt:  [[0.15]]
grads:  [-0.15083965]
Stock Position:  -0.15083964559417937
Bond Position:  [9.22242687]


portfolio before change:  [-4.94621027]
curr_Stock_Price:  93.93560630788663
curr_Factors:  [93.93560631]
mat_Sqrt:  [[0.15]]
grads:  [0.00374997]
Stock Position:  0.0037499717000082236
Bond Position:  [-5.29846614]


portfolio before change:  [-4.94684831]
curr_Stock_Price:  93.8537722006958
curr_Factors:  [93.8537722]
mat_Sqrt:  [[0.15]]
grads:  [0.01073719]
Stock Position:  0.010737185829539156
Bond Position:  [-5.9545737]


portfolio before change:  [-4.94944085]
curr_Stock_Price:  93.64697994021533
curr_Factors:  [93.64697994]
mat_Sqrt:  [[0.15]]
grads:  [-0.6609318]
Stock Position:  -0.6609317963040601
Bond Position:  [56.94482582]


portfolio before change:  [-4.5401141]
curr_Stock_Price:  93.0330473150147
curr_Factors:  [93.03304732]
mat_Sqrt:  [[0.15]]
grads:  [-0.1056604]
Stock Position:  -0.10566039626334094
Bond Position:  [5.28979455]


portfolio before change:  [-4.56001586]
curr_Stock_Price:  93.2245324147217
curr_Factors:  [93.22453241]
mat_Sqrt:  [[0.15]]
grads:  [0.11637612]
Stock Position:  0.11637612141407339
Bond Position:  [-15.40912537]


portfolio before change:  [-4.56266801]
curr_Stock_Price:  93.21001870346541
curr_Factors:  [93.2100187]
mat_Sqrt:  [[0.15]]
grads:  [0.11955828]
Stock Position:  0.11955828309068431
Bond Position:  [-15.70669782]


portfolio before change:  [-4.55081573]
curr_Stock_Price:  93.31736373816145
curr_Factors:  [93.31736374]
mat_Sqrt:  [[0.15]]
grads:  [-0.13225178]
Stock Position:  -0.1322517766140465
Bond Position:  [7.79057142]


portfolio before change:  [-4.54205973]
curr_Stock_Price:  93.25483852059793
curr_Factors:  [93.25483852]
mat_Sqrt:  [[0.15]]
grads:  [-0.03165545]
Stock Position:  -0.0316554515601059
Bond Position:  [-1.59003571]


portfolio before change:  [-4.53547233]
curr_Stock_Price:  93.04360214904676
curr_Factors:  [93.04360215]
mat_Sqrt:  [[0.15]]
grads:  [-0.11895833]
Stock Position:  -0.11895833174583119
Bond Position:  [6.53283937]


portfolio before change:  [-4.55394851]
curr_Stock_Price:  93.20235104165127
curr_Factors:  [93.20235104]
mat_Sqrt:  [[0.15]]
grads:  [-0.02453348]
Stock Position:  -0.02453348418500661
Bond Position:  [-2.26737011]


portfolio before change:  [-4.54305232]
curr_Stock_Price:  92.75243904589182
curr_Factors:  [92.75243905]
mat_Sqrt:  [[0.15]]
grads:  [-0.06143649]
Stock Position:  -0.06143648534416261
Bond Position:  [1.15533154]


portfolio before change:  [-4.4819345]
curr_Stock_Price:  91.75880138802694
curr_Factors:  [91.75880139]
mat_Sqrt:  [[0.15]]
grads:  [-0.16070477]
Stock Position:  -0.16070477228898442
Bond Position:  [10.26414278]


portfolio before change:  [-4.38551516]
curr_Stock_Price:  91.16281526127216
curr_Factors:  [91.16281526]
mat_Sqrt:  [[0.15]]
grads:  [0.12353939]
Stock Position:  0.12353939421357324
Bond Position:  [-15.64771413]


portfolio before change:  [-4.39342292]
curr_Stock_Price:  91.1067218740878
curr_Factors:  [91.10672187]
mat_Sqrt:  [[0.15]]
grads:  [0.13547438]
Stock Position:  0.13547438371119652
Bond Position:  [-16.73604991]


portfolio before change:  [-4.37117433]
curr_Stock_Price:  91.27867044628347
curr_Factors:  [91.27867045]
mat_Sqrt:  [[0.15]]
grads:  [0.09111416]
Stock Position:  0.09111415663567676
Bond Position:  [-12.6879534]


portfolio before change:  [-4.37342329]
curr_Stock_Price:  91.26269112113934
curr_Factors:  [91.26269112]
mat_Sqrt:  [[0.15]]
grads:  [0.00615558]
Stock Position:  0.006155578991195703
Bond Position:  [-4.93519799]


portfolio before change:  [-4.36905909]
curr_Stock_Price:  92.02178524670259
curr_Factors:  [92.02178525]
mat_Sqrt:  [[0.15]]
grads:  [0.05370255]
Stock Position:  0.053702546481606286
Bond Position:  [-9.31086329]


portfolio before change:  [-4.32984855]
curr_Stock_Price:  92.76276472280352
curr_Factors:  [92.76276472]
mat_Sqrt:  [[0.15]]
grads:  [0.15073185]
Stock Position:  0.15073185039436798
Bond Position:  [-18.31215172]


portfolio before change:  [-4.15458886]
curr_Stock_Price:  93.93308298610508
curr_Factors:  [93.93308299]
mat_Sqrt:  [[0.15]]
grads:  [-0.13747382]
Stock Position:  -0.13747381551299534
Bond Position:  [8.75875046]


portfolio before change:  [-4.12692651]
curr_Stock_Price:  93.7358461357506
curr_Factors:  [93.73584614]
mat_Sqrt:  [[0.15]]
grads:  [0.03227963]
Stock Position:  0.032279632182403706
Bond Position:  [-7.15268515]


portfolio before change:  [-4.13777739]
curr_Stock_Price:  93.41354336519638
curr_Factors:  [93.41354337]
mat_Sqrt:  [[0.15]]
grads:  [0.05759278]
Stock Position:  0.05759278053265281
Bond Position:  [-9.51772309]


portfolio before change:  [-4.20403846]
curr_Stock_Price:  92.27336236153702
curr_Factors:  [92.27336236]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.20403846]
Stock Price:  92.79075085027144
PL:  [-4.20403846]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.03294495e-03]
 [ 2.92979462e-03]
 [ 4.73980289e-04]
 [ 8.12255715e-03]
 [ 4.80856127e-03]
 [ 2.36075339e-02]
 [ 1.35935124e-03]
 [-1.84293109e-02]
 [ 1.97699270e-02]
 [-3.67428605e-03]
 [ 1.43988872e-02]
 [-2.30714320e-02]
 [ 1.71590311e-02]
 [ 1.69868640e-03]
 [-6.91473949e-03]
 [ 9.71543254e-03]
 [ 7.23218225e-03]
 [-1.19962546e-02]
 [-4.87894209e-04]
 [ 1.57401079e-02]
 [ 1.15744889e-02]
 [-8.04006328e-03]
 [ 7.53924351e-03]
 [ 2.22078430e-02]
 [-8.04547565e-03]
 [ 9.63026860e-03]
 [-7.21116409e-03]
 [ 6.29534810e-03]
 [-1.26684841e-02]
 [ 1.84344926e-03]
 [-6.07383541e-03]
 [-1.05260064e-02]
 [-9.06951482e-03]
 [ 4.75188945e-03]
 [ 1.21837500e-02]
 [ 1.37200694e-02]
 [-3.52610647e-02]
 [ 9.61214450e-03]
 [-1.28620892e-02]
 [ 2.48259266e-02]
 [-5.88461825e-03]
 [-1.34583261e-02]
 [ 2.34551247e-02]
 [ 3.16956225e-03]
 [-8.29113634e-03]
 [-2.94503319e-03]
 [ 9.07381819e-03]
 [-1.14757717e-02]
 [-1.52585305e-02]
 [-6.07820959e-03]
 [ 4.69518600e-02]
 [-8.69740268e-03]
 [ 2.90955211e-03]
 [ 5.41367536e-03]
 [ 5.80031386e-03]
 [-2.95834709e-03]
 [ 5.08874957e-03]
 [-3.93504369e-04]
 [ 1.56031708e-03]
 [-4.82032078e-03]
 [ 9.00849938e-04]
 [-1.19788702e-02]
 [-8.19012796e-03]
 [-1.37115389e-02]
 [-5.70001620e-03]
 [-4.73877267e-04]
 [-5.50455290e-03]
 [ 1.86916017e-02]
 [-8.26493460e-03]
 [ 1.04344710e-02]
 [-1.14795417e-02]
 [ 1.18098171e-02]
 [-3.13030948e-05]
 [ 2.23186160e-02]
 [-2.24879953e-02]
 [-2.30223921e-03]
 [-1.00535666e-02]
 [-6.69240295e-03]
 [ 3.01847009e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.62021502]
curr_Stock_Price:  100.10265088849077
curr_Factors:  [100.10265089]
mat_Sqrt:  [[0.15]]
grads:  [0.0068863]
Stock Position:  0.0068862996364822395
Bond Position:  [2.93087817]


portfolio before change:  [3.62162535]
curr_Stock_Price:  100.2808521121803
curr_Factors:  [100.28085211]
mat_Sqrt:  [[0.15]]
grads:  [0.01953196]
Stock Position:  0.0195319641491367
Bond Position:  [1.66294334]


portfolio before change:  [3.61633433]
curr_Stock_Price:  100.00464037116565
curr_Factors:  [100.00464037]
mat_Sqrt:  [[0.15]]
grads:  [0.00315987]
Stock Position:  0.003159868590389027
Bond Position:  [3.30033281]


portfolio before change:  [3.61629168]
curr_Stock_Price:  99.92586166970916
curr_Factors:  [99.92586167]
mat_Sqrt:  [[0.15]]
grads:  [0.05415038]
Stock Position:  0.05415038100940465
Bond Position:  [-1.7947318]


portfolio before change:  [3.62340983]
curr_Stock_Price:  100.05938478073234
curr_Factors:  [100.05938478]
mat_Sqrt:  [[0.15]]
grads:  [0.03205708]
Stock Position:  0.03205707513641193
Bond Position:  [0.41579862]


portfolio before change:  [3.61845439]
curr_Stock_Price:  99.90399213335812
curr_Factors:  [99.90399213]
mat_Sqrt:  [[0.15]]
grads:  [0.15738356]
Stock Position:  0.15738355919102592
Bond Position:  [-12.10479147]


portfolio before change:  [3.62928699]
curr_Stock_Price:  99.97762863229455
curr_Factors:  [99.97762863]
mat_Sqrt:  [[0.15]]
grads:  [0.00906234]
Stock Position:  0.009062341580724088
Bond Position:  [2.72325557]


portfolio before change:  [3.62797778]
curr_Stock_Price:  99.81437998831694
curr_Factors:  [99.81437999]
mat_Sqrt:  [[0.15]]
grads:  [-0.12286207]
Stock Position:  -0.12286207287882016
Bond Position:  [15.89137941]


portfolio before change:  [3.60698032]
curr_Stock_Price:  99.99336693022087
curr_Factors:  [99.99336693]
mat_Sqrt:  [[0.15]]
grads:  [0.13179951]
Stock Position:  0.13179951348662552
Bond Position:  [-9.5720968]


portfolio before change:  [3.59354918]
curr_Stock_Price:  99.8960004195248
curr_Factors:  [99.89600042]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449524]
Stock Position:  -0.02449524031769715
Bond Position:  [6.04052572]


portfolio before change:  [3.58321988]
curr_Stock_Price:  100.33309943616418
curr_Factors:  [100.33309944]
mat_Sqrt:  [[0.15]]
grads:  [0.09599258]
Stock Position:  0.0959925813633133
Bond Position:  [-6.04801333]


portfolio before change:  [3.62623474]
curr_Stock_Price:  100.78514340189842
curr_Factors:  [100.7851434]
mat_Sqrt:  [[0.15]]
grads:  [-0.15380955]
Stock Position:  -0.1538095469007225
Bond Position:  [19.12795198]


portfolio before change:  [3.63396739]
curr_Stock_Price:  100.74264202500102
curr_Factors:  [100.74264203]
mat_Sqrt:  [[0.15]]
grads:  [0.11439354]
Stock Position:  0.11439354037879101
Bond Position:  [-7.8903401]


portfolio before change:  [3.59533855]
curr_Stock_Price:  100.40926937382154
curr_Factors:  [100.40926937]
mat_Sqrt:  [[0.15]]
grads:  [0.01132458]
Stock Position:  0.011324576013352839
Bond Position:  [2.45824615]


portfolio before change:  [3.59364476]
curr_Stock_Price:  100.24613473650088
curr_Factors:  [100.24613474]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609826]
Stock Position:  -0.04609826328393007
Bond Position:  [8.21481748]


portfolio before change:  [3.62842056]
curr_Stock_Price:  99.50288867284031
curr_Factors:  [99.50288867]
mat_Sqrt:  [[0.15]]
grads:  [0.06476955]
Stock Position:  0.06476955024619827
Bond Position:  [-2.81633679]


portfolio before change:  [3.59570895]
curr_Stock_Price:  99.0005603466294
curr_Factors:  [99.00056035]
mat_Sqrt:  [[0.15]]
grads:  [0.04821455]
Stock Position:  0.04821454832877745
Bond Position:  [-1.17755835]


portfolio before change:  [3.62837617]
curr_Stock_Price:  99.6796253857163
curr_Factors:  [99.67962539]
mat_Sqrt:  [[0.15]]
grads:  [-0.07997503]
Stock Position:  -0.07997503066481117
Bond Position:  [11.60025726]


portfolio before change:  [3.65157769]
curr_Stock_Price:  99.39858164357062
curr_Factors:  [99.39858164]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325263]
Stock Position:  -0.0032526280600578272
Bond Position:  [3.9748843]


portfolio before change:  [3.65127596]
curr_Stock_Price:  99.56772739348327
curr_Factors:  [99.56772739]
mat_Sqrt:  [[0.15]]
grads:  [0.10493405]
Stock Position:  0.1049340529287859
Bond Position:  [-6.79676922]


portfolio before change:  [3.61505508]
curr_Stock_Price:  99.22659819526507
curr_Factors:  [99.2265982]
mat_Sqrt:  [[0.15]]
grads:  [0.07716326]
Stock Position:  0.07716325926746223
Bond Position:  [-4.04159265]


portfolio before change:  [3.61540425]
curr_Stock_Price:  99.2343969674088
curr_Factors:  [99.23439697]
mat_Sqrt:  [[0.15]]
grads:  [-0.05360042]
Stock Position:  -0.05360042186015761
Bond Position:  [8.93440979]


portfolio before change:  [3.64534634]
curr_Stock_Price:  98.68619850948141
curr_Factors:  [98.68619851]
mat_Sqrt:  [[0.15]]
grads:  [0.05026162]
Stock Position:  0.05026162342938709
Bond Position:  [-1.31478221]


portfolio before change:  [3.66215851]
curr_Stock_Price:  99.02232682236487
curr_Factors:  [99.02232682]
mat_Sqrt:  [[0.15]]
grads:  [0.14805229]
Stock Position:  0.1480522867877356
Bond Position:  [-10.99832342]


portfolio before change:  [3.65832041]
curr_Stock_Price:  99.00104593524217
curr_Factors:  [99.00104594]
mat_Sqrt:  [[0.15]]
grads:  [-0.0536365]
Stock Position:  -0.05363650431302731
Bond Position:  [8.96839044]


portfolio before change:  [3.61436206]
curr_Stock_Price:  99.83105712805872
curr_Factors:  [99.83105713]
mat_Sqrt:  [[0.15]]
grads:  [0.06420179]
Stock Position:  0.06420179068850103
Bond Position:  [-2.79497058]


portfolio before change:  [3.62299217]
curr_Stock_Price:  99.96819985223826
curr_Factors:  [99.96819985]
mat_Sqrt:  [[0.15]]
grads:  [-0.04807443]
Stock Position:  -0.048074427275468824
Bond Position:  [8.42890613]


portfolio before change:  [3.67053265]
curr_Stock_Price:  98.99026506249001
curr_Factors:  [98.99026506]
mat_Sqrt:  [[0.15]]
grads:  [0.04196899]
Stock Position:  0.0419689873033068
Bond Position:  [-0.48398853]


portfolio before change:  [3.66661521]
curr_Stock_Price:  98.89764449543682
curr_Factors:  [98.8976445]
mat_Sqrt:  [[0.15]]
grads:  [-0.08445656]
Stock Position:  -0.08445656071938999
Bond Position:  [12.01917013]


portfolio before change:  [3.78559056]
curr_Stock_Price:  97.49782274552423
curr_Factors:  [97.49782275]
mat_Sqrt:  [[0.15]]
grads:  [0.01228966]
Stock Position:  0.012289661713123099
Bond Position:  [2.5873753]


portfolio before change:  [3.80358153]
curr_Stock_Price:  98.94857504886616
curr_Factors:  [98.94857505]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049224]
Stock Position:  -0.04049223607345888
Bond Position:  [7.81023059]


portfolio before change:  [3.81863403]
curr_Stock_Price:  98.58889267428295
curr_Factors:  [98.58889267]
mat_Sqrt:  [[0.15]]
grads:  [-0.07017338]
Stock Position:  -0.07017337578164334
Bond Position:  [10.73694944]


portfolio before change:  [3.86731875]
curr_Stock_Price:  97.90467827551468
curr_Factors:  [97.90467828]
mat_Sqrt:  [[0.15]]
grads:  [-0.06046343]
Stock Position:  -0.060463432119425356
Bond Position:  [9.78697161]


portfolio before change:  [3.83475569]
curr_Stock_Price:  98.45335305445808
curr_Factors:  [98.45335305]
mat_Sqrt:  [[0.15]]
grads:  [0.03167926]
Stock Position:  0.031679263023514315
Bond Position:  [0.71582602]


portfolio before change:  [3.85929934]
curr_Stock_Price:  99.22669510886752
curr_Factors:  [99.22669511]
mat_Sqrt:  [[0.15]]
grads:  [0.081225]
Stock Position:  0.08122500018855963
Bond Position:  [-4.20038899]


portfolio before change:  [3.87359133]
curr_Stock_Price:  99.4058829077606
curr_Factors:  [99.40588291]
mat_Sqrt:  [[0.15]]
grads:  [0.09146713]
Stock Position:  0.09146712904226689
Bond Position:  [-5.21877939]


portfolio before change:  [3.88146234]
curr_Stock_Price:  99.49550184756305
curr_Factors:  [99.49550185]
mat_Sqrt:  [[0.15]]
grads:  [-0.23507376]
Stock Position:  -0.2350737649588888
Bond Position:  [27.27024455]


portfolio before change:  [3.81607674]
curr_Stock_Price:  99.78090178847812
curr_Factors:  [99.78090179]
mat_Sqrt:  [[0.15]]
grads:  [0.06408096]
Stock Position:  0.06408096333471562
Bond Position:  [-2.57797957]


portfolio before change:  [3.80338813]
curr_Stock_Price:  99.58540722172417
curr_Factors:  [99.58540722]
mat_Sqrt:  [[0.15]]
grads:  [-0.08574726]
Stock Position:  -0.0857472610898742
Bond Position:  [12.34256405]


portfolio before change:  [3.77324082]
curr_Stock_Price:  99.9459872029886
curr_Factors:  [99.9459872]
mat_Sqrt:  [[0.15]]
grads:  [0.16550618]
Stock Position:  0.16550617701445278
Bond Position:  [-12.76843743]


portfolio before change:  [3.71128104]
curr_Stock_Price:  99.57644372074103
curr_Factors:  [99.57644372]
mat_Sqrt:  [[0.15]]
grads:  [-0.03923079]
Stock Position:  -0.03923078830363006
Bond Position:  [7.61774342]


portfolio before change:  [3.68224727]
curr_Stock_Price:  100.32865622313402
curr_Factors:  [100.32865622]
mat_Sqrt:  [[0.15]]
grads:  [-0.08972217]
Stock Position:  -0.08972217430728956
Bond Position:  [12.68395246]


portfolio before change:  [3.68829265]
curr_Stock_Price:  100.27011318536735
curr_Factors:  [100.27011319]
mat_Sqrt:  [[0.15]]
grads:  [0.1563675]
Stock Position:  0.15636749791977175
Bond Position:  [-11.99069406]


portfolio before change:  [3.74642428]
curr_Stock_Price:  100.64666885164834
curr_Factors:  [100.64666885]
mat_Sqrt:  [[0.15]]
grads:  [0.02113042]
Stock Position:  0.021130415016639613
Bond Position:  [1.6197184]


portfolio before change:  [3.73251836]
curr_Stock_Price:  99.98377809496372
curr_Factors:  [99.98377809]
mat_Sqrt:  [[0.15]]
grads:  [-0.05527424]
Stock Position:  -0.055274242278209526
Bond Position:  [9.25904593]


portfolio before change:  [3.73165193]
curr_Stock_Price:  100.00992288500206
curr_Factors:  [100.00992289]
mat_Sqrt:  [[0.15]]
grads:  [-0.01963355]
Stock Position:  -0.019633554594472767
Bond Position:  [5.69520221]


portfolio before change:  [3.71989573]
curr_Stock_Price:  100.62683461851391
curr_Factors:  [100.62683462]
mat_Sqrt:  [[0.15]]
grads:  [0.06049212]
Stock Position:  0.0604921212613178
Bond Position:  [-2.36723496]


portfolio before change:  [3.69602945]
curr_Stock_Price:  100.23474527948156
curr_Factors:  [100.23474528]
mat_Sqrt:  [[0.15]]
grads:  [-0.07650514]
Stock Position:  -0.07650514489158836
Bond Position:  [11.36450316]


portfolio before change:  [3.71305908]
curr_Stock_Price:  100.02143514212835
curr_Factors:  [100.02143514]
mat_Sqrt:  [[0.15]]
grads:  [-0.10172354]
Stock Position:  -0.1017235367033673
Bond Position:  [13.88759321]


portfolio before change:  [3.77532587]
curr_Stock_Price:  99.41785026603173
curr_Factors:  [99.41785027]
mat_Sqrt:  [[0.15]]
grads:  [-0.0405214]
Stock Position:  -0.040521397243436535
Bond Position:  [7.80387607]


portfolio before change:  [3.75792606]
curr_Stock_Price:  99.85928541464781
curr_Factors:  [99.85928541]
mat_Sqrt:  [[0.15]]
grads:  [0.3130124]
Stock Position:  0.3130123999644547
Bond Position:  [-27.49926853]


portfolio before change:  [3.68368718]
curr_Stock_Price:  99.62760092207502
curr_Factors:  [99.62760092]
mat_Sqrt:  [[0.15]]
grads:  [-0.05798268]
Stock Position:  -0.05798268451769365
Bond Position:  [9.46036293]


portfolio before change:  [3.67907403]
curr_Stock_Price:  99.71735954608538
curr_Factors:  [99.71735955]
mat_Sqrt:  [[0.15]]
grads:  [0.01939701]
Stock Position:  0.019397014055825383
Bond Position:  [1.744855]


portfolio before change:  [3.66821046]
curr_Stock_Price:  99.1516735819738
curr_Factors:  [99.15167358]
mat_Sqrt:  [[0.15]]
grads:  [0.03609117]
Stock Position:  0.036091169041704375
Bond Position:  [0.08971065]


portfolio before change:  [3.6853482]
curr_Stock_Price:  99.62636403446068
curr_Factors:  [99.62636403]
mat_Sqrt:  [[0.15]]
grads:  [0.03866876]
Stock Position:  0.03866875904025724
Bond Position:  [-0.16707966]


portfolio before change:  [3.70622469]
curr_Stock_Price:  100.1665139892179
curr_Factors:  [100.16651399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01972231]
Stock Position:  -0.019722313909338943
Bond Position:  [5.68174012]


portfolio before change:  [3.70505068]
curr_Stock_Price:  100.24404708653097
curr_Factors:  [100.24404709]
mat_Sqrt:  [[0.15]]
grads:  [0.033925]
Stock Position:  0.03392499714140284
Bond Position:  [0.30427167]


portfolio before change:  [3.7275475]
curr_Stock_Price:  100.90662051003049
curr_Factors:  [100.90662051]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262336]
Stock Position:  -0.002623362457957554
Bond Position:  [3.99226214]


portfolio before change:  [3.72768242]
curr_Stock_Price:  100.950304406798
curr_Factors:  [100.95030441]
mat_Sqrt:  [[0.15]]
grads:  [0.01040211]
Stock Position:  0.01040211387656543
Bond Position:  [2.67758586]


portfolio before change:  [3.72036901]
curr_Stock_Price:  100.23114621753123
curr_Factors:  [100.23114622]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213547]
Stock Position:  -0.03213547188457201
Bond Position:  [6.94134419]


portfolio before change:  [3.72006381]
curr_Stock_Price:  100.25414414201302
curr_Factors:  [100.25414414]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [3.11797088]


portfolio before change:  [3.7244926]
curr_Stock_Price:  100.95913043949756
curr_Factors:  [100.95913044]
mat_Sqrt:  [[0.15]]
grads:  [-0.07985913]
Stock Position:  -0.07985913484538398
Bond Position:  [11.78700141]


portfolio before change:  [3.74937717]
curr_Stock_Price:  100.65674980484656
curr_Factors:  [100.6567498]
mat_Sqrt:  [[0.15]]
grads:  [-0.05460085]
Stock Position:  -0.054600853076959256
Bond Position:  [9.24532158]


portfolio before change:  [3.74638051]
curr_Stock_Price:  100.72221606156165
curr_Factors:  [100.72221606]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141026]
Stock Position:  -0.09141025951784393
Bond Position:  [12.95342441]


portfolio before change:  [3.70987204]
curr_Stock_Price:  101.13046429840705
curr_Factors:  [101.1304643]
mat_Sqrt:  [[0.15]]
grads:  [-0.03800011]
Stock Position:  -0.03800010798592398
Bond Position:  [7.55284061]


portfolio before change:  [3.71143644]
curr_Stock_Price:  101.10171894823141
curr_Factors:  [101.10171895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00315918]
Stock Position:  -0.003159181779734399
Bond Position:  [4.03083514]


portfolio before change:  [3.70961288]
curr_Stock_Price:  101.7586902560722
curr_Factors:  [101.75869026]
mat_Sqrt:  [[0.15]]
grads:  [-0.03669702]
Stock Position:  -0.03669701935481011
Bond Position:  [7.4438535]


portfolio before change:  [3.72892085]
curr_Stock_Price:  101.24522312335311
curr_Factors:  [101.24522312]
mat_Sqrt:  [[0.15]]
grads:  [0.12461068]
Stock Position:  0.12461067819132549
Bond Position:  [-8.88731507]


portfolio before change:  [3.7447375]
curr_Stock_Price:  101.37660938745596
curr_Factors:  [101.37660939]
mat_Sqrt:  [[0.15]]
grads:  [-0.05509956]
Stock Position:  -0.055099564026952444
Bond Position:  [9.33054448]


portfolio before change:  [3.73260008]
curr_Stock_Price:  101.60747519603393
curr_Factors:  [101.6074752]
mat_Sqrt:  [[0.15]]
grads:  [0.06956314]
Stock Position:  0.06956314014400085
Bond Position:  [-3.33553496]


portfolio before change:  [3.76193554]
curr_Stock_Price:  102.03218200563724
curr_Factors:  [102.03218201]
mat_Sqrt:  [[0.15]]
grads:  [-0.07653028]
Stock Position:  -0.07653027819335637
Bond Position:  [11.57048681]


portfolio before change:  [3.76230528]
curr_Stock_Price:  102.03680027885675
curr_Factors:  [102.03680028]
mat_Sqrt:  [[0.15]]
grads:  [0.07873211]
Stock Position:  0.07873211419615476
Bond Position:  [-4.27126773]


portfolio before change:  [3.76996627]
curr_Stock_Price:  102.13749559855142
curr_Factors:  [102.1374956]
mat_Sqrt:  [[0.15]]
grads:  [-0.00020869]
Stock Position:  -0.00020868729867416997
Bond Position:  [3.79128107]


portfolio before change:  [3.77003018]
curr_Stock_Price:  102.96676003562848
curr_Factors:  [102.96676004]
mat_Sqrt:  [[0.15]]
grads:  [0.14879077]
Stock Position:  0.14879077355186224
Bond Position:  [-11.5504737]


portfolio before change:  [3.78317027]
curr_Stock_Price:  103.05992458151114
curr_Factors:  [103.05992458]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991997]
Stock Position:  -0.14991996861852053
Bond Position:  [19.23391093]


portfolio before change:  [3.93841464]
curr_Stock_Price:  102.0324283234366
curr_Factors:  [102.03242832]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534826]
Stock Position:  -0.015348261375998606
Bond Position:  [5.50443502]


portfolio before change:  [3.9315608]
curr_Stock_Price:  102.5013984245486
curr_Factors:  [102.50139842]
mat_Sqrt:  [[0.15]]
grads:  [-0.06702378]
Stock Position:  -0.06702377764126022
Bond Position:  [10.80159174]


portfolio before change:  [3.85982683]
curr_Stock_Price:  103.58174772734007
curr_Factors:  [103.58174773]
mat_Sqrt:  [[0.15]]
grads:  [-0.04461602]
Stock Position:  -0.044616019669729015
Bond Position:  [8.48123212]


portfolio before change:  [3.86675925]
curr_Stock_Price:  103.43824928446139
curr_Factors:  [103.43824928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.86675925]
Stock Price:  103.61440552744875
PL:  [0.25235373]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.72007099e-03]
 [ 7.94955292e-04]
 [-9.50471155e-05]
 [ 8.50765281e-03]
 [-4.42802247e-03]
 [ 1.52673523e-02]
 [ 3.99915394e-03]
 [-2.74048229e-02]
 [-2.98352665e-02]
 [ 3.07829121e-02]
 [-3.45249243e-02]
 [ 1.93350452e-02]
 [-3.13797367e-04]
 [ 6.85677873e-03]
 [-6.97193915e-03]
 [ 9.39884288e-03]
 [ 8.26847266e-03]
 [-8.24267140e-03]
 [ 7.86413026e-04]
 [ 1.59298802e-02]
 [ 1.18114062e-02]
 [-7.94477275e-03]
 [ 7.08788921e-03]
 [ 4.25176076e-02]
 [-8.09473675e-03]
 [ 3.70559350e-04]
 [-4.57457824e-03]
 [ 6.85624731e-03]
 [-1.67053704e-02]
 [ 1.00342002e-03]
 [-6.82474140e-04]
 [-1.00790600e-02]
 [-8.89341573e-03]
 [ 5.48693249e-03]
 [ 1.30578741e-02]
 [ 1.55878813e-02]
 [-3.44729288e-02]
 [ 8.70560697e-03]
 [-2.29697803e-02]
 [ 2.02930484e-02]
 [-6.80763921e-03]
 [ 3.08285500e-02]
 [ 2.30540979e-02]
 [ 4.58389840e-03]
 [ 8.84422092e-04]
 [ 4.00417029e-04]
 [ 1.84393702e-03]
 [-1.21646247e-02]
 [-7.81744491e-03]
 [-3.23695166e-03]
 [ 4.61837160e-02]
 [-9.80331884e-03]
 [ 3.35773654e-03]
 [ 5.34784528e-03]
 [ 5.68467539e-03]
 [-3.43130819e-03]
 [ 6.75532237e-03]
 [-1.34775608e-04]
 [ 1.54520464e-03]
 [ 1.56823109e-03]
 [-9.36244016e-05]
 [ 3.13966152e-03]
 [ 8.45753705e-03]
 [-1.83133789e-02]
 [-9.40276346e-03]
 [-3.24950375e-03]
 [-4.80656391e-03]
 [ 1.87148573e-02]
 [-9.32317716e-03]
 [ 6.65491901e-03]
 [-5.00143924e-03]
 [ 1.16258695e-02]
 [-1.23609116e-03]
 [ 6.04102684e-03]
 [-1.57765813e-02]
 [-6.90948136e-03]
 [-7.37261789e-04]
 [-1.02399276e-03]
 [-5.26172673e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.22873181]
curr_Stock_Price:  99.88211983186959
curr_Factors:  [99.88211983]
mat_Sqrt:  [[0.15]]
grads:  [0.01813381]
Stock Position:  0.01813380660354463
Bond Position:  [-1.58251124]


portfolio before change:  [0.22649295]
curr_Stock_Price:  99.76411118727668
curr_Factors:  [99.76411119]
mat_Sqrt:  [[0.15]]
grads:  [0.0052997]
Stock Position:  0.005299701949490933
Bond Position:  [-0.30222711]


portfolio before change:  [0.22633114]
curr_Stock_Price:  99.73714424791089
curr_Factors:  [99.73714425]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063365]
Stock Position:  -0.0006336474363618251
Bond Position:  [0.28952933]


portfolio before change:  [0.2264926]
curr_Stock_Price:  99.51089502239651
curr_Factors:  [99.51089502]
mat_Sqrt:  [[0.15]]
grads:  [0.05671769]
Stock Position:  0.056717685401719925
Bond Position:  [-5.41753504]


portfolio before change:  [0.15960595]
curr_Stock_Price:  98.33757408553228
curr_Factors:  [98.33757409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02952015]
Stock Position:  -0.029520149812988512
Bond Position:  [3.06254587]


portfolio before change:  [0.15276123]
curr_Stock_Price:  98.57592415143478
curr_Factors:  [98.57592415]
mat_Sqrt:  [[0.15]]
grads:  [0.10178235]
Stock Position:  0.10178234877384021
Bond Position:  [-9.88052786]


portfolio before change:  [0.06969432]
curr_Stock_Price:  97.76586860638827
curr_Factors:  [97.76586861]
mat_Sqrt:  [[0.15]]
grads:  [0.02666103]
Stock Position:  0.026661026268070886
Bond Position:  [-2.53684407]


portfolio before change:  [0.05936618]
curr_Stock_Price:  97.38442827551684
curr_Factors:  [97.38442828]
mat_Sqrt:  [[0.15]]
grads:  [-0.18269882]
Stock Position:  -0.18269881905564705
Bond Position:  [17.85138622]


portfolio before change:  [0.07695749]
curr_Stock_Price:  97.29424942060385
curr_Factors:  [97.29424942]
mat_Sqrt:  [[0.15]]
grads:  [-0.19890178]
Stock Position:  -0.19890177645579937
Bond Position:  [19.42895654]


portfolio before change:  [0.00341257]
curr_Stock_Price:  97.6701096822039
curr_Factors:  [97.67010968]
mat_Sqrt:  [[0.15]]
grads:  [0.20521941]
Stock Position:  0.2052194136682981
Bond Position:  [-20.04039008]


portfolio before change:  [0.04599109]
curr_Stock_Price:  97.88369128699357
curr_Factors:  [97.88369129]
mat_Sqrt:  [[0.15]]
grads:  [-0.23016616]
Stock Position:  -0.23016616207755516
Bond Position:  [22.57550465]


portfolio before change:  [-0.20545001]
curr_Stock_Price:  98.98225468999838
curr_Factors:  [98.98225469]
mat_Sqrt:  [[0.15]]
grads:  [0.1289003]
Stock Position:  0.12890030161327806
Bond Position:  [-12.9642925]


portfolio before change:  [-0.09043815]
curr_Stock_Price:  99.88079528849511
curr_Factors:  [99.88079529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00209198]
Stock Position:  -0.0020919824476131844
Bond Position:  [0.11851072]


portfolio before change:  [-0.08777282]
curr_Stock_Price:  98.61026455488485
curr_Factors:  [98.61026455]
mat_Sqrt:  [[0.15]]
grads:  [0.04571186]
Stock Position:  0.045711858177202185
Bond Position:  [-4.59543125]


portfolio before change:  [-0.09075047]
curr_Stock_Price:  98.5514082514033
curr_Factors:  [98.55140825]
mat_Sqrt:  [[0.15]]
grads:  [-0.04647959]
Stock Position:  -0.046479594355921035
Bond Position:  [4.48987901]


portfolio before change:  [-0.06209546]
curr_Stock_Price:  97.94093844415536
curr_Factors:  [97.94093844]
mat_Sqrt:  [[0.15]]
grads:  [0.06265895]
Stock Position:  0.06265895252648367
Bond Position:  [-6.19897207]


portfolio before change:  [-0.03822759]
curr_Stock_Price:  98.32803897836523
curr_Factors:  [98.32803898]
mat_Sqrt:  [[0.15]]
grads:  [0.05512315]
Stock Position:  0.05512315107765597
Bond Position:  [-5.45837894]


portfolio before change:  [-0.0520548]
curr_Stock_Price:  98.08338594191436
curr_Factors:  [98.08338594]
mat_Sqrt:  [[0.15]]
grads:  [-0.05495114]
Stock Position:  -0.05495114268071104
Bond Position:  [5.33773934]


portfolio before change:  [-0.08265767]
curr_Stock_Price:  98.6463677072218
curr_Factors:  [98.64636771]
mat_Sqrt:  [[0.15]]
grads:  [0.00524275]
Stock Position:  0.005242753505495527
Bond Position:  [-0.59983626]


portfolio before change:  [-0.07841539]
curr_Stock_Price:  99.46268943680994
curr_Factors:  [99.46268944]
mat_Sqrt:  [[0.15]]
grads:  [0.1061992]
Stock Position:  0.10619920141473285
Bond Position:  [-10.64127358]


portfolio before change:  [-0.14426582]
curr_Stock_Price:  98.8488869490515
curr_Factors:  [98.84888695]
mat_Sqrt:  [[0.15]]
grads:  [0.07874271]
Stock Position:  0.07874270801960277
Bond Position:  [-7.92789486]


portfolio before change:  [-0.10890217]
curr_Stock_Price:  99.30428357853837
curr_Factors:  [99.30428358]
mat_Sqrt:  [[0.15]]
grads:  [-0.05296515]
Stock Position:  -0.052965151652169556
Bond Position:  [5.15076427]


portfolio before change:  [-0.12704266]
curr_Stock_Price:  99.65286041140057
curr_Factors:  [99.65286041]
mat_Sqrt:  [[0.15]]
grads:  [0.04725259]
Stock Position:  0.047252594752173464
Bond Position:  [-4.83589889]


portfolio before change:  [-0.11648678]
curr_Stock_Price:  99.8826494656748
curr_Factors:  [99.88264947]
mat_Sqrt:  [[0.15]]
grads:  [0.28345072]
Stock Position:  0.2834507175709924
Bond Position:  [-28.42829545]


portfolio before change:  [-0.46450843]
curr_Stock_Price:  98.66111499653807
curr_Factors:  [98.661115]
mat_Sqrt:  [[0.15]]
grads:  [-0.05396491]
Stock Position:  -0.053964911693121814
Bond Position:  [4.85972993]


portfolio before change:  [-0.49755856]
curr_Stock_Price:  99.27918086396693
curr_Factors:  [99.27918086]
mat_Sqrt:  [[0.15]]
grads:  [0.0024704]
Stock Position:  0.0024703956638086914
Bond Position:  [-0.74281741]


portfolio before change:  [-0.49937421]
curr_Stock_Price:  98.56301100230922
curr_Factors:  [98.563011]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049719]
Stock Position:  -0.030497188268673713
Bond Position:  [2.5065205]


portfolio before change:  [-0.50115697]
curr_Stock_Price:  98.6266046657944
curr_Factors:  [98.62660467]
mat_Sqrt:  [[0.15]]
grads:  [0.04570832]
Stock Position:  0.04570831538979212
Bond Position:  [-5.00921292]


portfolio before change:  [-0.51512405]
curr_Stock_Price:  98.32788461023003
curr_Factors:  [98.32788461]
mat_Sqrt:  [[0.15]]
grads:  [-0.11136914]
Stock Position:  -0.11136913626815804
Bond Position:  [10.43556753]


portfolio before change:  [-0.46507701]
curr_Stock_Price:  97.88436142732623
curr_Factors:  [97.88436143]
mat_Sqrt:  [[0.15]]
grads:  [0.00668947]
Stock Position:  0.0066894668044885745
Bond Position:  [-1.1198712]


portfolio before change:  [-0.46470473]
curr_Stock_Price:  97.95047575406018
curr_Factors:  [97.95047575]
mat_Sqrt:  [[0.15]]
grads:  [-0.00454983]
Stock Position:  -0.004549827601944493
Bond Position:  [-0.01904696]


portfolio before change:  [-0.46243682]
curr_Stock_Price:  97.45175164277671
curr_Factors:  [97.45175164]
mat_Sqrt:  [[0.15]]
grads:  [-0.06719373]
Stock Position:  -0.0671937334865303
Bond Position:  [6.08571021]


portfolio before change:  [-0.46245037]
curr_Stock_Price:  97.45761408834359
curr_Factors:  [97.45761409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05928944]
Stock Position:  -0.05928943821576843
Bond Position:  [5.31575682]


portfolio before change:  [-0.45428489]
curr_Stock_Price:  97.32549564548647
curr_Factors:  [97.32549565]
mat_Sqrt:  [[0.15]]
grads:  [0.03657955]
Stock Position:  0.03657954996635594
Bond Position:  [-4.01440773]


portfolio before change:  [-0.43240953]
curr_Stock_Price:  97.93037653095645
curr_Factors:  [97.93037653]
mat_Sqrt:  [[0.15]]
grads:  [0.08705249]
Stock Position:  0.08705249373089755
Bond Position:  [-8.95749302]


portfolio before change:  [-0.45650914]
curr_Stock_Price:  97.65996786785114
curr_Factors:  [97.65996787]
mat_Sqrt:  [[0.15]]
grads:  [0.10391921]
Stock Position:  0.10391920887319091
Bond Position:  [-10.60525574]


portfolio before change:  [-0.43189374]
curr_Stock_Price:  97.90321695954304
curr_Factors:  [97.90321696]
mat_Sqrt:  [[0.15]]
grads:  [-0.22981953]
Stock Position:  -0.22981952520187643
Bond Position:  [22.0681771]


portfolio before change:  [-0.36492746]
curr_Stock_Price:  97.61783227376719
curr_Factors:  [97.61783227]
mat_Sqrt:  [[0.15]]
grads:  [0.05803738]
Stock Position:  0.05803737976817162
Bond Position:  [-6.03041066]


portfolio before change:  [-0.35689563]
curr_Stock_Price:  97.76271721589359
curr_Factors:  [97.76271722]
mat_Sqrt:  [[0.15]]
grads:  [-0.15313187]
Stock Position:  -0.1531318685286742
Bond Position:  [14.61369193]


portfolio before change:  [-0.38884249]
curr_Stock_Price:  97.97730507996076
curr_Factors:  [97.97730508]
mat_Sqrt:  [[0.15]]
grads:  [0.13528699]
Stock Position:  0.13528698906475328
Bond Position:  [-13.64389709]


portfolio before change:  [-0.37615145]
curr_Stock_Price:  98.07741677549984
curr_Factors:  [98.07741678]
mat_Sqrt:  [[0.15]]
grads:  [-0.04538426]
Stock Position:  -0.04538426138668484
Bond Position:  [4.07501967]


portfolio before change:  [-0.32880342]
curr_Stock_Price:  97.03975913046801
curr_Factors:  [97.03975913]
mat_Sqrt:  [[0.15]]
grads:  [0.20552367]
Stock Position:  0.20552366668056632
Bond Position:  [-20.27277053]


portfolio before change:  [-0.22315967]
curr_Stock_Price:  97.55994661234747
curr_Factors:  [97.55994661]
mat_Sqrt:  [[0.15]]
grads:  [0.15369399]
Stock Position:  0.1536939860299841
Bond Position:  [-15.21753675]


portfolio before change:  [-0.11612965]
curr_Stock_Price:  98.26251897474192
curr_Factors:  [98.26251897]
mat_Sqrt:  [[0.15]]
grads:  [0.03055932]
Stock Position:  0.030559322641423397
Bond Position:  [-3.11896567]


portfolio before change:  [-0.13779598]
curr_Stock_Price:  97.55990576080791
curr_Factors:  [97.55990576]
mat_Sqrt:  [[0.15]]
grads:  [0.00589615]
Stock Position:  0.005896147277972261
Bond Position:  [-0.71302355]


portfolio before change:  [-0.13732498]
curr_Stock_Price:  97.64734676093043
curr_Factors:  [97.64734676]
mat_Sqrt:  [[0.15]]
grads:  [0.00266945]
Stock Position:  0.002669446857657317
Bond Position:  [-0.39798938]


portfolio before change:  [-0.13789011]
curr_Stock_Price:  97.44495967498067
curr_Factors:  [97.44495967]
mat_Sqrt:  [[0.15]]
grads:  [0.01229291]
Stock Position:  0.012292913477970267
Bond Position:  [-1.33577257]


portfolio before change:  [-0.13430221]
curr_Stock_Price:  97.74361926569249
curr_Factors:  [97.74361927]
mat_Sqrt:  [[0.15]]
grads:  [-0.0810975]
Stock Position:  -0.08109749820988123
Bond Position:  [7.79246078]


portfolio before change:  [-0.16694941]
curr_Stock_Price:  98.15219230876987
curr_Factors:  [98.15219231]
mat_Sqrt:  [[0.15]]
grads:  [-0.0521163]
Stock Position:  -0.05211629943219331
Bond Position:  [4.94837963]


portfolio before change:  [-0.1686302]
curr_Stock_Price:  98.19037749866291
curr_Factors:  [98.1903775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02157968]
Stock Position:  -0.021579677756326313
Bond Position:  [1.9502865]


portfolio before change:  [-0.1698885]
curr_Stock_Price:  98.2543355471326
curr_Factors:  [98.25433555]
mat_Sqrt:  [[0.15]]
grads:  [0.30789144]
Stock Position:  0.3078914401816479
Bond Position:  [-30.42155737]


portfolio before change:  [0.02137722]
curr_Stock_Price:  98.88172267333401
curr_Factors:  [98.88172267]
mat_Sqrt:  [[0.15]]
grads:  [-0.06535546]
Stock Position:  -0.06535545891138204
Bond Position:  [6.48383758]


portfolio before change:  [0.01122178]
curr_Stock_Price:  99.04331116922573
curr_Factors:  [99.04331117]
mat_Sqrt:  [[0.15]]
grads:  [0.02238491]
Stock Position:  0.022384910286382
Bond Position:  [-2.20585385]


portfolio before change:  [0.00564208]
curr_Stock_Price:  98.80020848949636
curr_Factors:  [98.80020849]
mat_Sqrt:  [[0.15]]
grads:  [0.0356523]
Stock Position:  0.035652301833600894
Bond Position:  [-3.51681277]


portfolio before change:  [0.02244051]
curr_Stock_Price:  99.27754746868398
curr_Factors:  [99.27754747]
mat_Sqrt:  [[0.15]]
grads:  [0.03789784]
Stock Position:  0.03789783595258736
Bond Position:  [-3.7399637]


portfolio before change:  [0.01727014]
curr_Stock_Price:  99.14728640414955
curr_Factors:  [99.1472864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02287539]
Stock Position:  -0.022875387901631895
Bond Position:  [2.28530277]


portfolio before change:  [0.0134223]
curr_Stock_Price:  99.32173928567654
curr_Factors:  [99.32173929]
mat_Sqrt:  [[0.15]]
grads:  [0.04503548]
Stock Position:  0.045035482482788707
Bond Position:  [-4.45958015]


portfolio before change:  [0.00438786]
curr_Stock_Price:  99.12732139747537
curr_Factors:  [99.1273214]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008985]
Stock Position:  -0.0008985040531461879
Bond Position:  [0.09345416]


portfolio before change:  [0.00455364]
curr_Stock_Price:  98.9493165250043
curr_Factors:  [98.94931653]
mat_Sqrt:  [[0.15]]
grads:  [0.01030136]
Stock Position:  0.010301364264225727
Bond Position:  [-1.01475931]


portfolio before change:  [0.00373005]
curr_Stock_Price:  98.87552331454302
curr_Factors:  [98.87552331]
mat_Sqrt:  [[0.15]]
grads:  [0.01045487]
Stock Position:  0.010454873920199698
Bond Position:  [-1.03000108]


portfolio before change:  [-0.00410481]
curr_Stock_Price:  98.13228339259545
curr_Factors:  [98.13228339]
mat_Sqrt:  [[0.15]]
grads:  [-0.00062416]
Stock Position:  -0.0006241626771706008
Bond Position:  [0.0571457]


portfolio before change:  [-0.00386344]
curr_Stock_Price:  97.75128875354135
curr_Factors:  [97.75128875]
mat_Sqrt:  [[0.15]]
grads:  [0.02093108]
Stock Position:  0.020931076780157574
Bond Position:  [-2.04990317]


portfolio before change:  [0.00083695]
curr_Stock_Price:  97.98197471116681
curr_Factors:  [97.98197471]
mat_Sqrt:  [[0.15]]
grads:  [0.05638358]
Stock Position:  0.056383580337782395
Bond Position:  [-5.5237376]


portfolio before change:  [-0.02022708]
curr_Stock_Price:  97.61451349375672
curr_Factors:  [97.61451349]
mat_Sqrt:  [[0.15]]
grads:  [-0.12208919]
Stock Position:  -0.12208919235066003
Bond Position:  [11.89745004]


portfolio before change:  [-0.0296202]
curr_Stock_Price:  97.6975407757687
curr_Factors:  [97.69754078]
mat_Sqrt:  [[0.15]]
grads:  [-0.06268509]
Stock Position:  -0.06268508975426758
Bond Position:  [6.09455891]


portfolio before change:  [-0.0726024]
curr_Stock_Price:  98.38930220658091
curr_Factors:  [98.38930221]
mat_Sqrt:  [[0.15]]
grads:  [-0.02166336]
Stock Position:  -0.021663358365337736
Bond Position:  [2.05884031]


portfolio before change:  [-0.06426133]
curr_Stock_Price:  98.01021078318848
curr_Factors:  [98.01021078]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204376]
Stock Position:  -0.03204375939602111
Bond Position:  [3.07635428]


portfolio before change:  [-0.06157162]
curr_Stock_Price:  97.93227256630347
curr_Factors:  [97.93227257]
mat_Sqrt:  [[0.15]]
grads:  [0.12476572]
Stock Position:  0.12476571509765894
Bond Position:  [-12.28016163]


portfolio before change:  [0.03343534]
curr_Stock_Price:  98.69990724525364
curr_Factors:  [98.69990725]
mat_Sqrt:  [[0.15]]
grads:  [-0.06215451]
Stock Position:  -0.062154514370758716
Bond Position:  [6.16808014]


portfolio before change:  [0.06594867]
curr_Stock_Price:  98.18300493565737
curr_Factors:  [98.18300494]
mat_Sqrt:  [[0.15]]
grads:  [0.04436613]
Stock Position:  0.0443661267198139
Bond Position:  [-4.29005097]


portfolio before change:  [0.05318572]
curr_Stock_Price:  97.9013754659741
curr_Factors:  [97.90137547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03334293]
Stock Position:  -0.033342928255271354
Bond Position:  [3.31750426]


portfolio before change:  [0.07867648]
curr_Stock_Price:  97.14309167257079
curr_Factors:  [97.14309167]
mat_Sqrt:  [[0.15]]
grads:  [0.0775058]
Stock Position:  0.07750579674684245
Bond Position:  [-7.45047624]


portfolio before change:  [0.11489351]
curr_Stock_Price:  97.61638144110981
curr_Factors:  [97.61638144]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824061]
Stock Position:  -0.008240607735384436
Bond Position:  [0.91931181]


portfolio before change:  [0.11413028]
curr_Stock_Price:  97.71597237125386
curr_Factors:  [97.71597237]
mat_Sqrt:  [[0.15]]
grads:  [0.04027351]
Stock Position:  0.04027351225095361
Bond Position:  [-3.82123513]


portfolio before change:  [0.13852883]
curr_Stock_Price:  98.3277240618089
curr_Factors:  [98.32772406]
mat_Sqrt:  [[0.15]]
grads:  [-0.10517721]
Stock Position:  -0.10517720849988448
Bond Position:  [10.48036436]


portfolio before change:  [0.12946207]
curr_Stock_Price:  98.42015664296173
curr_Factors:  [98.42015664]
mat_Sqrt:  [[0.15]]
grads:  [-0.04606321]
Stock Position:  -0.04606320907732029
Bond Position:  [4.66301033]


portfolio before change:  [0.12203752]
curr_Stock_Price:  98.5876654805069
curr_Factors:  [98.58766548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00491508]
Stock Position:  -0.0049150785939604145
Bond Position:  [0.60660365]


portfolio before change:  [0.11943592]
curr_Stock_Price:  99.1246905116575
curr_Factors:  [99.12469051]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682662]
Stock Position:  -0.006826618404041299
Bond Position:  [0.79612236]


portfolio before change:  [0.12063329]
curr_Stock_Price:  98.95658170562731
curr_Factors:  [98.95658171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.12063329]
Stock Price:  99.49377358397886
PL:  [0.12063329]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.79742244e-04]
 [-1.22177707e-03]
 [-4.10398954e-03]
 [-3.20932209e-04]
 [ 2.71260001e-02]
 [ 2.68430985e-02]
 [ 3.25595019e-03]
 [ 5.28349996e-03]
 [ 2.31567464e-02]
 [-4.76755387e-03]
 [ 1.55495597e-02]
 [-2.51326133e-02]
 [ 2.21153119e-02]
 [ 3.42570333e-03]
 [-6.90560991e-03]
 [ 1.06763214e-02]
 [ 7.38640657e-03]
 [-1.18778178e-02]
 [-3.81125118e-04]
 [ 1.53584999e-02]
 [ 1.16731680e-02]
 [-7.85116656e-03]
 [ 7.88315814e-03]
 [ 5.94867935e-03]
 [-8.09567494e-03]
 [-6.86865976e-03]
 [-2.46733618e-03]
 [ 8.27904831e-03]
 [-2.00950593e-02]
 [ 1.24055945e-03]
 [ 1.60334023e-03]
 [-1.01039702e-02]
 [-9.06179282e-03]
 [ 5.29932504e-03]
 [ 1.37568928e-02]
 [ 1.67358186e-02]
 [-3.43357802e-02]
 [ 8.68316181e-03]
 [-2.62162352e-02]
 [ 1.84641356e-02]
 [-4.71351086e-03]
 [ 2.45232599e-03]
 [ 2.30382835e-02]
 [ 3.91018226e-03]
 [-8.15000848e-03]
 [ 1.84491456e-04]
 [ 1.14531294e-02]
 [-1.03942880e-03]
 [-6.75612065e-03]
 [-7.57468567e-03]
 [ 3.61426952e-02]
 [-8.03698547e-03]
 [-4.77409817e-03]
 [ 5.48985657e-03]
 [-6.41559013e-03]
 [ 7.05048528e-03]
 [ 1.02266511e-02]
 [-1.19466236e-04]
 [ 1.70688625e-03]
 [ 1.65268120e-02]
 [-1.96198671e-03]
 [ 1.66539222e-02]
 [ 2.05849560e-03]
 [-1.24374348e-02]
 [ 3.20970532e-03]
 [ 1.41065758e-03]
 [-5.43063194e-03]
 [ 1.50286151e-02]
 [-8.25782222e-03]
 [ 8.12094643e-03]
 [-1.29895155e-02]
 [ 1.31298888e-02]
 [-2.06347233e-03]
 [ 2.26788252e-02]
 [-2.24826687e-02]
 [-1.42073483e-03]
 [-1.02002383e-02]
 [-1.88314154e-03]
 [ 2.43484121e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.01948019]
curr_Stock_Price:  100.84388763731837
curr_Factors:  [100.84388764]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186495]
Stock Position:  -0.0018649482930629842
Bond Position:  [15.20754882]


portfolio before change:  [15.01985662]
curr_Stock_Price:  101.15170658638789
curr_Factors:  [101.15170659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00814518]
Stock Position:  -0.008145180446505055
Bond Position:  [15.84375552]


portfolio before change:  [15.01625724]
curr_Stock_Price:  101.7151867239972
curr_Factors:  [101.71518672]
mat_Sqrt:  [[0.15]]
grads:  [-0.02735993]
Stock Position:  -0.027359930289731535
Bond Position:  [17.79917766]


portfolio before change:  [15.01155479]
curr_Stock_Price:  101.92772134980049
curr_Factors:  [101.92772135]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213955]
Stock Position:  -0.0021395480582241805
Bond Position:  [15.22963405]


portfolio before change:  [15.01269396]
curr_Stock_Price:  101.8401850519886
curr_Factors:  [101.84018505]
mat_Sqrt:  [[0.15]]
grads:  [0.18084]
Stock Position:  0.18084000051320645
Bond Position:  [-3.40408516]


portfolio before change:  [15.07569232]
curr_Stock_Price:  102.18972677461608
curr_Factors:  [102.18972677]
mat_Sqrt:  [[0.15]]
grads:  [0.17895399]
Stock Position:  0.17895398994231335
Bond Position:  [-3.21156701]


portfolio before change:  [15.03678092]
curr_Stock_Price:  101.97341044060337
curr_Factors:  [101.97341044]
mat_Sqrt:  [[0.15]]
grads:  [0.02170633]
Stock Position:  0.02170633460955068
Bond Position:  [12.82331196]


portfolio before change:  [15.02943819]
curr_Stock_Price:  101.59821034474916
curr_Factors:  [101.59821034]
mat_Sqrt:  [[0.15]]
grads:  [0.03522333]
Stock Position:  0.035223333059862
Bond Position:  [11.45081059]


portfolio before change:  [15.019575]
curr_Stock_Price:  101.29787300779952
curr_Factors:  [101.29787301]
mat_Sqrt:  [[0.15]]
grads:  [0.15437831]
Stock Position:  0.1543783095043781
Bond Position:  [-0.61861939]


portfolio before change:  [14.96125411]
curr_Stock_Price:  100.92034442586588
curr_Factors:  [100.92034443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03178369]
Stock Position:  -0.03178369243662776
Bond Position:  [18.1688753]


portfolio before change:  [14.96372644]
curr_Stock_Price:  100.87828700030938
curr_Factors:  [100.878287]
mat_Sqrt:  [[0.15]]
grads:  [0.10366373]
Stock Position:  0.10366373165437322
Bond Position:  [4.50630677]


portfolio before change:  [14.95781363]
curr_Stock_Price:  100.81853164302305
curr_Factors:  [100.81853164]
mat_Sqrt:  [[0.15]]
grads:  [-0.16755076]
Stock Position:  -0.16755075527045482
Bond Position:  [31.85003476]


portfolio before change:  [14.94793678]
curr_Stock_Price:  100.88936118697683
curr_Factors:  [100.88936119]
mat_Sqrt:  [[0.15]]
grads:  [0.14743541]
Stock Position:  0.14743541269564056
Bond Position:  [0.07327218]


portfolio before change:  [15.00099597]
curr_Stock_Price:  101.24921104883227
curr_Factors:  [101.24921105]
mat_Sqrt:  [[0.15]]
grads:  [0.02283802]
Stock Position:  0.022838022224349604
Bond Position:  [12.68866424]


portfolio before change:  [14.99913197]
curr_Stock_Price:  101.13286699994384
curr_Factors:  [101.132867]
mat_Sqrt:  [[0.15]]
grads:  [-0.0460374]
Stock Position:  -0.04603739937027652
Bond Position:  [19.65502616]


portfolio before change:  [15.06758021]
curr_Stock_Price:  99.6727550368969
curr_Factors:  [99.67275504]
mat_Sqrt:  [[0.15]]
grads:  [0.07117548]
Stock Position:  0.0711754760453732
Bond Position:  [7.97332442]


portfolio before change:  [15.07338408]
curr_Stock_Price:  99.74729658556898
curr_Factors:  [99.74729659]
mat_Sqrt:  [[0.15]]
grads:  [0.04924271]
Stock Position:  0.04924271048736644
Bond Position:  [10.16155684]


portfolio before change:  [15.06642539]
curr_Stock_Price:  99.59308465033348
curr_Factors:  [99.59308465]
mat_Sqrt:  [[0.15]]
grads:  [-0.07918545]
Stock Position:  -0.07918545222092803
Bond Position:  [22.95274883]


portfolio before change:  [15.04824846]
curr_Stock_Price:  99.84075028802395
curr_Factors:  [99.84075029]
mat_Sqrt:  [[0.15]]
grads:  [-0.00254083]
Stock Position:  -0.0025408341232129273
Bond Position:  [15.30192725]


portfolio before change:  [15.05050801]
curr_Stock_Price:  99.32786833095054
curr_Factors:  [99.32786833]
mat_Sqrt:  [[0.15]]
grads:  [0.10239]
Stock Position:  0.10238999958539957
Bond Position:  [4.88032761]


portfolio before change:  [15.02275516]
curr_Stock_Price:  99.05383880547292
curr_Factors:  [99.05383881]
mat_Sqrt:  [[0.15]]
grads:  [0.07782112]
Stock Position:  0.07782112019581895
Bond Position:  [7.31427446]


portfolio before change:  [15.04804473]
curr_Stock_Price:  99.37293488023485
curr_Factors:  [99.37293488]
mat_Sqrt:  [[0.15]]
grads:  [-0.05234111]
Stock Position:  -0.05234111042306288
Bond Position:  [20.24933449]


portfolio before change:  [15.05445613]
curr_Stock_Price:  99.27462258733725
curr_Factors:  [99.27462259]
mat_Sqrt:  [[0.15]]
grads:  [0.05255439]
Stock Position:  0.052554387591040794
Bond Position:  [9.83713913]


portfolio before change:  [15.01123699]
curr_Stock_Price:  98.44055381236194
curr_Factors:  [98.44055381]
mat_Sqrt:  [[0.15]]
grads:  [0.03965786]
Stock Position:  0.0396578623201752
Bond Position:  [11.10729506]


portfolio before change:  [15.00910327]
curr_Stock_Price:  98.36924506498742
curr_Factors:  [98.36924506]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397117]
Stock Position:  -0.0539711662563231
Bond Position:  [20.31820615]


portfolio before change:  [15.05630465]
curr_Stock_Price:  97.51820809732286
curr_Factors:  [97.5182081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04579107]
Stock Position:  -0.04579106509705683
Bond Position:  [19.52176727]


portfolio before change:  [15.05066759]
curr_Stock_Price:  97.6679582185046
curr_Factors:  [97.66795822]
mat_Sqrt:  [[0.15]]
grads:  [-0.01644891]
Stock Position:  -0.01644890787043934
Bond Position:  [16.65719883]


portfolio before change:  [15.04702176]
curr_Stock_Price:  97.95289689272009
curr_Factors:  [97.95289689]
mat_Sqrt:  [[0.15]]
grads:  [0.05519366]
Stock Position:  0.05519365537623059
Bond Position:  [9.64064333]


portfolio before change:  [15.04876644]
curr_Stock_Price:  97.97358974213415
curr_Factors:  [97.97358974]
mat_Sqrt:  [[0.15]]
grads:  [-0.13396706]
Stock Position:  -0.13396706204035153
Bond Position:  [28.17400041]


portfolio before change:  [15.07709944]
curr_Stock_Price:  97.77524193856533
curr_Factors:  [97.77524194]
mat_Sqrt:  [[0.15]]
grads:  [0.0082704]
Stock Position:  0.008270396305626093
Bond Position:  [14.26845944]


portfolio before change:  [15.07610006]
curr_Stock_Price:  97.54657329453445
curr_Factors:  [97.54657329]
mat_Sqrt:  [[0.15]]
grads:  [0.01068893]
Stock Position:  0.010688934844263823
Bond Position:  [14.0334311]


portfolio before change:  [15.07807852]
curr_Stock_Price:  97.6496084585567
curr_Factors:  [97.64960846]
mat_Sqrt:  [[0.15]]
grads:  [-0.0673598]
Stock Position:  -0.0673598010932918
Bond Position:  [21.65573672]


portfolio before change:  [15.08292972]
curr_Stock_Price:  97.59768313719721
curr_Factors:  [97.59768314]
mat_Sqrt:  [[0.15]]
grads:  [-0.06041195]
Stock Position:  -0.060411952142941164
Bond Position:  [20.97899629]


portfolio before change:  [15.07189565]
curr_Stock_Price:  97.80203504697752
curr_Factors:  [97.80203505]
mat_Sqrt:  [[0.15]]
grads:  [0.03532883]
Stock Position:  0.03532883361159441
Bond Position:  [11.61666383]


portfolio before change:  [15.05481216]
curr_Stock_Price:  97.29792671909235
curr_Factors:  [97.29792672]
mat_Sqrt:  [[0.15]]
grads:  [0.09171262]
Stock Position:  0.09171261855657918
Bond Position:  [6.13136452]


portfolio before change:  [15.11455882]
curr_Stock_Price:  97.94520339491991
curr_Factors:  [97.94520339]
mat_Sqrt:  [[0.15]]
grads:  [0.11157212]
Stock Position:  0.11157212401319248
Bond Position:  [4.18660444]


portfolio before change:  [15.07922116]
curr_Stock_Price:  97.62613329514683
curr_Factors:  [97.6261333]
mat_Sqrt:  [[0.15]]
grads:  [-0.2289052]
Stock Position:  -0.22890520137927237
Bond Position:  [37.42635086]


portfolio before change:  [15.10146493]
curr_Stock_Price:  97.53917788739035
curr_Factors:  [97.53917789]
mat_Sqrt:  [[0.15]]
grads:  [0.05788775]
Stock Position:  0.05788774540730766
Bond Position:  [9.45514183]


portfolio before change:  [15.0922735]
curr_Stock_Price:  97.37018884098094
curr_Factors:  [97.37018884]
mat_Sqrt:  [[0.15]]
grads:  [-0.1747749]
Stock Position:  -0.17477490162136647
Bond Position:  [32.11013867]


portfolio before change:  [15.04664527]
curr_Stock_Price:  97.64274041640425
curr_Factors:  [97.64274042]
mat_Sqrt:  [[0.15]]
grads:  [0.12309424]
Stock Position:  0.1230942374761108
Bond Position:  [3.02738659]


portfolio before change:  [15.1695165]
curr_Stock_Price:  98.63939161189573
curr_Factors:  [98.63939161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03142341]
Stock Position:  -0.031423405728946724
Bond Position:  [18.26910213]


portfolio before change:  [15.162621]
curr_Stock_Price:  98.89516793934737
curr_Factors:  [98.89516794]
mat_Sqrt:  [[0.15]]
grads:  [0.01634884]
Stock Position:  0.01634883995842602
Bond Position:  [13.54579972]


portfolio before change:  [15.15930882]
curr_Stock_Price:  98.64078796223151
curr_Factors:  [98.64078796]
mat_Sqrt:  [[0.15]]
grads:  [0.15358856]
Stock Position:  0.15358855639242544
Bond Position:  [0.00921259]


portfolio before change:  [15.35103269]
curr_Stock_Price:  99.88907952120886
curr_Factors:  [99.88907952]
mat_Sqrt:  [[0.15]]
grads:  [0.02606788]
Stock Position:  0.026067881743032796
Bond Position:  [12.74713598]


portfolio before change:  [15.35177724]
curr_Stock_Price:  99.88707808721534
curr_Factors:  [99.88707809]
mat_Sqrt:  [[0.15]]
grads:  [-0.05433339]
Stock Position:  -0.05433338987946564
Bond Position:  [20.7789808]


portfolio before change:  [15.32472149]
curr_Stock_Price:  100.40893908439993
curr_Factors:  [100.40893908]
mat_Sqrt:  [[0.15]]
grads:  [0.00122994]
Stock Position:  0.001229943042241379
Bond Position:  [15.20122421]


portfolio before change:  [15.32683485]
curr_Stock_Price:  101.35471900033993
curr_Factors:  [101.354719]
mat_Sqrt:  [[0.15]]
grads:  [0.0763542]
Stock Position:  0.0763541962412629
Bond Position:  [7.58797675]


portfolio before change:  [15.37919071]
curr_Stock_Price:  102.03420491502402
curr_Factors:  [102.03420492]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692953]
Stock Position:  -0.006929525300453556
Bond Position:  [16.08623932]


portfolio before change:  [15.3826986]
curr_Stock_Price:  101.67307392132993
curr_Factors:  [101.67307392]
mat_Sqrt:  [[0.15]]
grads:  [-0.0450408]
Stock Position:  -0.045040804304438686
Bond Position:  [19.96213563]


portfolio before change:  [15.39122874]
curr_Stock_Price:  101.51138795356148
curr_Factors:  [101.51138795]
mat_Sqrt:  [[0.15]]
grads:  [-0.0504979]
Stock Position:  -0.050497904450859
Bond Position:  [20.51734111]


portfolio before change:  [15.44267921]
curr_Stock_Price:  100.51791906256102
curr_Factors:  [100.51791906]
mat_Sqrt:  [[0.15]]
grads:  [0.2409513]
Stock Position:  0.24095130129198863
Bond Position:  [-8.77724419]


portfolio before change:  [15.45797574]
curr_Stock_Price:  100.58367973479267
curr_Factors:  [100.58367973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0535799]
Stock Position:  -0.05357990311047445
Bond Position:  [20.84723955]


portfolio before change:  [15.39542776]
curr_Stock_Price:  101.77537593642575
curr_Factors:  [101.77537594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182732]
Stock Position:  -0.03182732116624127
Bond Position:  [18.63466534]


portfolio before change:  [15.38742405]
curr_Stock_Price:  102.06344346239274
curr_Factors:  [102.06344346]
mat_Sqrt:  [[0.15]]
grads:  [0.03659904]
Stock Position:  0.036599043829813924
Bond Position:  [11.65199961]


portfolio before change:  [15.42629051]
curr_Stock_Price:  103.10549777649815
curr_Factors:  [103.10549778]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427706]
Stock Position:  -0.04277060083372542
Bond Position:  [19.8361746]


portfolio before change:  [15.42313018]
curr_Stock_Price:  103.20837534563496
curr_Factors:  [103.20837535]
mat_Sqrt:  [[0.15]]
grads:  [0.04700324]
Stock Position:  0.04700323518473981
Bond Position:  [10.57200264]


portfolio before change:  [15.44175183]
curr_Stock_Price:  103.59049545044545
curr_Factors:  [103.59049545]
mat_Sqrt:  [[0.15]]
grads:  [0.06817767]
Stock Position:  0.06817767375740745
Bond Position:  [8.37919283]


portfolio before change:  [15.40525325]
curr_Stock_Price:  103.04746874083985
curr_Factors:  [103.04746874]
mat_Sqrt:  [[0.15]]
grads:  [-0.00079644]
Stock Position:  -0.0007964415764554176
Bond Position:  [15.48732454]


portfolio before change:  [15.4061974]
curr_Stock_Price:  103.07739808117718
curr_Factors:  [103.07739808]
mat_Sqrt:  [[0.15]]
grads:  [0.01137924]
Stock Position:  0.011379241681005505
Bond Position:  [14.23325477]


portfolio before change:  [15.40471321]
curr_Stock_Price:  102.86879065466717
curr_Factors:  [102.86879065]
mat_Sqrt:  [[0.15]]
grads:  [0.11017875]
Stock Position:  0.11017874639401487
Bond Position:  [4.07075881]


portfolio before change:  [15.40419223]
curr_Stock_Price:  102.86175290956494
curr_Factors:  [102.86175291]
mat_Sqrt:  [[0.15]]
grads:  [-0.01307991]
Stock Position:  -0.01307991138029358
Bond Position:  [16.74961484]


portfolio before change:  [15.40099393]
curr_Stock_Price:  103.18631043358064
curr_Factors:  [103.18631043]
mat_Sqrt:  [[0.15]]
grads:  [0.11102615]
Stock Position:  0.1110261482871308
Bond Position:  [3.94461533]


portfolio before change:  [15.39138006]
curr_Stock_Price:  103.09749880700994
curr_Factors:  [103.09749881]
mat_Sqrt:  [[0.15]]
grads:  [0.0137233]
Stock Position:  0.013723304026044698
Bond Position:  [13.97654174]


portfolio before change:  [15.38990884]
curr_Stock_Price:  102.92663741472767
curr_Factors:  [102.92663741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08291623]
Stock Position:  -0.08291623198224456
Bond Position:  [23.92419779]


portfolio before change:  [15.39795152]
curr_Stock_Price:  102.84767377901673
curr_Factors:  [102.84767378]
mat_Sqrt:  [[0.15]]
grads:  [0.02139804]
Stock Position:  0.02139803544216323
Bond Position:  [13.19721335]


portfolio before change:  [15.39671362]
curr_Stock_Price:  102.75127491206183
curr_Factors:  [102.75127491]
mat_Sqrt:  [[0.15]]
grads:  [0.00940438]
Stock Position:  0.009404383853438097
Bond Position:  [14.43040119]


portfolio before change:  [15.39805254]
curr_Stock_Price:  102.79774111952382
curr_Factors:  [102.79774112]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620421]
Stock Position:  -0.03620421294937459
Bond Position:  [19.11976385]


portfolio before change:  [15.387868]
curr_Stock_Price:  103.11205716769146
curr_Factors:  [103.11205717]
mat_Sqrt:  [[0.15]]
grads:  [0.10019077]
Stock Position:  0.10019076760724527
Bond Position:  [5.05699184]


portfolio before change:  [15.32343819]
curr_Stock_Price:  102.46583120455604
curr_Factors:  [102.4658312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505215]
Stock Position:  -0.05505214810639612
Bond Position:  [20.96440231]


portfolio before change:  [15.28569413]
curr_Stock_Price:  103.17523812536955
curr_Factors:  [103.17523813]
mat_Sqrt:  [[0.15]]
grads:  [0.05413964]
Stock Position:  0.05413964284171867
Bond Position:  [9.69982359]


portfolio before change:  [15.2936646]
curr_Stock_Price:  103.31126066788359
curr_Factors:  [103.31126067]
mat_Sqrt:  [[0.15]]
grads:  [-0.08659677]
Stock Position:  -0.08659676971885111
Bond Position:  [24.24008605]


portfolio before change:  [15.25647672]
curr_Stock_Price:  103.75819349780345
curr_Factors:  [103.7581935]
mat_Sqrt:  [[0.15]]
grads:  [0.08753259]
Stock Position:  0.08753259174408057
Bond Position:  [6.17425312]


portfolio before change:  [15.27823612]
curr_Stock_Price:  104.00237110951068
curr_Factors:  [104.00237111]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375648]
Stock Position:  -0.013756482178996315
Bond Position:  [16.70894288]


portfolio before change:  [15.29115098]
curr_Stock_Price:  103.13946757074703
curr_Factors:  [103.13946757]
mat_Sqrt:  [[0.15]]
grads:  [0.15119217]
Stock Position:  0.1511921676923627
Bond Position:  [-0.3027287]


portfolio before change:  [15.17710826]
curr_Stock_Price:  102.38530283952545
curr_Factors:  [102.38530284]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988446]
Stock Position:  -0.1498844581165868
Bond Position:  [30.52307389]


portfolio before change:  [15.16386667]
curr_Stock_Price:  102.48637624854372
curr_Factors:  [102.48637625]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947157]
Stock Position:  -0.009471565555131794
Bond Position:  [16.1345731]


portfolio before change:  [15.16629501]
curr_Stock_Price:  102.33646526897773
curr_Factors:  [102.33646527]
mat_Sqrt:  [[0.15]]
grads:  [-0.06800159]
Stock Position:  -0.06800158869491499
Bond Position:  [22.12533723]


portfolio before change:  [15.19292587]
curr_Stock_Price:  101.96517996991071
curr_Factors:  [101.96517997]
mat_Sqrt:  [[0.15]]
grads:  [-0.01255428]
Stock Position:  -0.012554276961590408
Bond Position:  [16.47302498]


portfolio before change:  [15.19242346]
curr_Stock_Price:  102.08721104305886
curr_Factors:  [102.08721104]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.19242346]
Stock Price:  101.76003190342978
PL:  [13.43239156]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.61011217e-03]
 [-1.39163802e-03]
 [-3.66522561e-03]
 [ 7.13684855e-03]
 [ 2.85138716e-03]
 [ 1.76031918e-02]
 [ 2.25920264e-03]
 [-2.42679493e-02]
 [ 4.48968254e-04]
 [ 2.16323084e-02]
 [-7.85075411e-03]
 [ 2.72108870e-02]
 [-1.34600052e-02]
 [ 8.57679046e-04]
 [-7.05951057e-03]
 [ 1.10034023e-02]
 [ 1.30920402e-02]
 [ 5.43406215e-03]
 [ 2.47744379e-03]
 [ 9.96813325e-03]
 [ 1.30236565e-02]
 [-1.03806987e-02]
 [ 5.88868819e-03]
 [ 1.01977978e-02]
 [-8.07051990e-03]
 [-9.51832278e-03]
 [-3.66405114e-03]
 [ 6.82977253e-03]
 [-2.10585316e-02]
 [-1.00253102e-04]
 [ 1.98068865e-03]
 [-1.00731164e-02]
 [-8.94589282e-03]
 [ 5.39299488e-03]
 [ 1.29207090e-02]
 [ 1.65312641e-02]
 [-3.42440275e-02]
 [ 8.45754135e-03]
 [-3.29576347e-02]
 [ 1.91862150e-02]
 [-9.85858641e-03]
 [ 3.26198035e-02]
 [ 2.31603683e-02]
 [ 4.19323863e-03]
 [ 4.99076659e-03]
 [ 1.99016771e-02]
 [-2.04754369e-03]
 [-7.11345444e-03]
 [ 1.31610461e-02]
 [ 5.10563516e-03]
 [ 3.67138832e-02]
 [ 4.23501539e-03]
 [ 1.25327829e-03]
 [ 4.77322020e-03]
 [ 3.72133437e-03]
 [ 2.85969311e-03]
 [-5.90131844e-03]
 [-4.01692161e-04]
 [ 1.54773277e-03]
 [-1.62852518e-02]
 [-4.18899003e-03]
 [ 5.55772435e-03]
 [ 1.24566266e-02]
 [-1.79241869e-02]
 [-8.68496651e-03]
 [-5.77922439e-03]
 [-4.72339585e-03]
 [ 1.74264409e-02]
 [-1.00172462e-02]
 [ 7.86026074e-03]
 [-4.02861946e-03]
 [ 1.13177311e-02]
 [-2.41127804e-03]
 [ 8.19855643e-03]
 [-1.67879823e-02]
 [-7.52352498e-03]
 [-5.60829099e-04]
 [ 1.30403994e-03]
 [-9.02991871e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.50763491]
curr_Stock_Price:  99.90025549491854
curr_Factors:  [99.90025549]
mat_Sqrt:  [[0.15]]
grads:  [0.01740075]
Stock Position:  0.01740074781637613
Bond Position:  [-1.23070424]


portfolio before change:  [0.50185174]
curr_Stock_Price:  99.5723239354117
curr_Factors:  [99.57232394]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927759]
Stock Position:  -0.00927758678016726
Bond Position:  [1.42564261]


portfolio before change:  [0.50808477]
curr_Stock_Price:  98.91009065717135
curr_Factors:  [98.91009066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02443484]
Stock Position:  -0.024434837373926207
Bond Position:  [2.92493675]


portfolio before change:  [0.50785501]
curr_Stock_Price:  98.92697518917996
curr_Factors:  [98.92697519]
mat_Sqrt:  [[0.15]]
grads:  [0.04757899]
Stock Position:  0.047578990317794806
Bond Position:  [-4.19899058]


portfolio before change:  [0.52630245]
curr_Stock_Price:  99.32021356484688
curr_Factors:  [99.32021356]
mat_Sqrt:  [[0.15]]
grads:  [0.01900925]
Stock Position:  0.019009247762939833
Bond Position:  [-1.3617001]


portfolio before change:  [0.5191395]
curr_Stock_Price:  98.94787692688617
curr_Factors:  [98.94787693]
mat_Sqrt:  [[0.15]]
grads:  [0.11735461]
Stock Position:  0.1173546122532875
Bond Position:  [-11.09285023]


portfolio before change:  [0.47236321]
curr_Stock_Price:  98.55519557111647
curr_Factors:  [98.55519557]
mat_Sqrt:  [[0.15]]
grads:  [0.01506135]
Stock Position:  0.0150613509348538
Bond Position:  [-1.01201118]


portfolio before change:  [0.46665139]
curr_Stock_Price:  98.18015809620816
curr_Factors:  [98.1801581]
mat_Sqrt:  [[0.15]]
grads:  [-0.16178633]
Stock Position:  -0.16178632872558146
Bond Position:  [16.35085872]


portfolio before change:  [0.36819501]
curr_Stock_Price:  98.79503287318362
curr_Factors:  [98.79503287]
mat_Sqrt:  [[0.15]]
grads:  [0.00299312]
Stock Position:  0.00299312169251167
Bond Position:  [0.07248946]


portfolio before change:  [0.36810122]
curr_Stock_Price:  98.76218207012553
curr_Factors:  [98.76218207]
mat_Sqrt:  [[0.15]]
grads:  [0.14421539]
Stock Position:  0.14421538925047223
Bond Position:  [-13.87492531]


portfolio before change:  [0.31848034]
curr_Stock_Price:  98.42412056461295
curr_Factors:  [98.42412056]
mat_Sqrt:  [[0.15]]
grads:  [-0.05233836]
Stock Position:  -0.05233836070539673
Bond Position:  [5.46983746]


portfolio before change:  [0.34524208]
curr_Stock_Price:  97.9193308977781
curr_Factors:  [97.9193309]
mat_Sqrt:  [[0.15]]
grads:  [0.18140591]
Stock Position:  0.1814059131097148
Bond Position:  [-17.41790356]


portfolio before change:  [0.33530923]
curr_Stock_Price:  97.87057729632815
curr_Factors:  [97.8705773]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973337]
Stock Position:  -0.08973336806678171
Bond Position:  [9.11756577]


portfolio before change:  [0.40767735]
curr_Stock_Price:  97.0704484649539
curr_Factors:  [97.07044846]
mat_Sqrt:  [[0.15]]
grads:  [0.00571786]
Stock Position:  0.0057178603043090675
Bond Position:  [-0.14735791]


portfolio before change:  [0.40678454]
curr_Stock_Price:  96.91591556403581
curr_Factors:  [96.91591556]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470634]
Stock Position:  -0.04706340378267291
Bond Position:  [4.96797741]


portfolio before change:  [0.39981898]
curr_Stock_Price:  97.07051714767312
curr_Factors:  [97.07051715]
mat_Sqrt:  [[0.15]]
grads:  [0.07335602]
Stock Position:  0.07335601516687248
Bond Position:  [-6.72088735]


portfolio before change:  [0.39179312]
curr_Stock_Price:  96.96683396638448
curr_Factors:  [96.96683397]
mat_Sqrt:  [[0.15]]
grads:  [0.08728027]
Stock Position:  0.08728026803740586
Bond Position:  [-8.07149814]


portfolio before change:  [0.41364961]
curr_Stock_Price:  97.22303124556156
curr_Factors:  [97.22303125]
mat_Sqrt:  [[0.15]]
grads:  [0.03622708]
Stock Position:  0.036227081008936596
Bond Position:  [-3.10845702]


portfolio before change:  [0.42546886]
curr_Stock_Price:  97.55464894177719
curr_Factors:  [97.55464894]
mat_Sqrt:  [[0.15]]
grads:  [0.01651629]
Stock Position:  0.01651629195591846
Bond Position:  [-1.1857722]


portfolio before change:  [0.41192654]
curr_Stock_Price:  96.73919873744623
curr_Factors:  [96.73919874]
mat_Sqrt:  [[0.15]]
grads:  [0.06645422]
Stock Position:  0.06645422166602362
Bond Position:  [-6.01680162]


portfolio before change:  [0.39735984]
curr_Stock_Price:  96.52565879460445
curr_Factors:  [96.52565879]
mat_Sqrt:  [[0.15]]
grads:  [0.08682438]
Stock Position:  0.0868243764906432
Bond Position:  [-7.9834203]


portfolio before change:  [0.43156796]
curr_Stock_Price:  96.9253979185349
curr_Factors:  [96.92539792]
mat_Sqrt:  [[0.15]]
grads:  [-0.06920466]
Stock Position:  -0.06920465806680731
Bond Position:  [7.13925698]


portfolio before change:  [0.36198898]
curr_Stock_Price:  97.9372547032879
curr_Factors:  [97.9372547]
mat_Sqrt:  [[0.15]]
grads:  [0.03925792]
Stock Position:  0.03925792124914919
Bond Position:  [-3.48282405]


portfolio before change:  [0.38906354]
curr_Stock_Price:  98.63245812445524
curr_Factors:  [98.63245812]
mat_Sqrt:  [[0.15]]
grads:  [0.06798532]
Stock Position:  0.06798531869760302
Bond Position:  [-6.31649556]


portfolio before change:  [0.40197806]
curr_Stock_Price:  98.82822566221395
curr_Factors:  [98.82822566]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380347]
Stock Position:  -0.05380346602974794
Bond Position:  [5.71927914]


portfolio before change:  [0.43185123]
curr_Stock_Price:  98.2796420433356
curr_Factors:  [98.27964204]
mat_Sqrt:  [[0.15]]
grads:  [-0.06345549]
Stock Position:  -0.06345548520892043
Bond Position:  [6.6682336]


portfolio before change:  [0.4365314]
curr_Stock_Price:  98.21245481768744
curr_Factors:  [98.21245482]
mat_Sqrt:  [[0.15]]
grads:  [-0.02442701]
Stock Position:  -0.024427007566771772
Bond Position:  [2.83556778]


portfolio before change:  [0.42628597]
curr_Stock_Price:  98.63914068819757
curr_Factors:  [98.63914069]
mat_Sqrt:  [[0.15]]
grads:  [0.04553182]
Stock Position:  0.045531816855377105
Bond Position:  [-4.06493332]


portfolio before change:  [0.39233075]
curr_Stock_Price:  97.89897346421374
curr_Factors:  [97.89897346]
mat_Sqrt:  [[0.15]]
grads:  [-0.14039021]
Stock Position:  -0.14039021042996644
Bond Position:  [14.13638823]


portfolio before change:  [0.32396793]
curr_Stock_Price:  98.39221560125794
curr_Factors:  [98.3922156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00066835]
Stock Position:  -0.0006683540115870801
Bond Position:  [0.38972876]


portfolio before change:  [0.3246018]
curr_Stock_Price:  97.48026167638545
curr_Factors:  [97.48026168]
mat_Sqrt:  [[0.15]]
grads:  [0.01320459]
Stock Position:  0.013204590993082181
Bond Position:  [-0.96258519]


portfolio before change:  [0.3235418]
curr_Stock_Price:  97.40454256737368
curr_Factors:  [97.40454257]
mat_Sqrt:  [[0.15]]
grads:  [-0.06715411]
Stock Position:  -0.06715410938695757
Bond Position:  [6.8646571]


portfolio before change:  [0.3174753]
curr_Stock_Price:  97.50126857764779
curr_Factors:  [97.50126858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05963929]
Stock Position:  -0.05963928547059471
Bond Position:  [6.13238129]


portfolio before change:  [0.31411104]
curr_Stock_Price:  97.56410542565388
curr_Factors:  [97.56410543]
mat_Sqrt:  [[0.15]]
grads:  [0.0359533]
Stock Position:  0.03595329922291765
Bond Position:  [-3.19364043]


portfolio before change:  [0.33485422]
curr_Stock_Price:  98.14660518754303
curr_Factors:  [98.14660519]
mat_Sqrt:  [[0.15]]
grads:  [0.08613806]
Stock Position:  0.08613806026079596
Bond Position:  [-8.11930397]


portfolio before change:  [0.31259652]
curr_Stock_Price:  97.89410086173157
curr_Factors:  [97.89410086]
mat_Sqrt:  [[0.15]]
grads:  [0.11020843]
Stock Position:  0.11020842701520497
Bond Position:  [-10.47615835]


portfolio before change:  [0.26198015]
curr_Stock_Price:  97.4407636361183
curr_Factors:  [97.44076364]
mat_Sqrt:  [[0.15]]
grads:  [-0.22829352]
Stock Position:  -0.22829351647317322
Bond Position:  [22.50707473]


portfolio before change:  [0.35615376]
curr_Stock_Price:  97.0344144957106
curr_Factors:  [97.0344145]
mat_Sqrt:  [[0.15]]
grads:  [0.05638361]
Stock Position:  0.05638360903222424
Bond Position:  [-5.11499673]


portfolio before change:  [0.32722412]
curr_Stock_Price:  96.52699853773856
curr_Factors:  [96.52699854]
mat_Sqrt:  [[0.15]]
grads:  [-0.21971756]
Stock Position:  -0.21971756478298254
Bond Position:  [21.53590118]


portfolio before change:  [0.05439944]
curr_Stock_Price:  97.77483105332367
curr_Factors:  [97.77483105]
mat_Sqrt:  [[0.15]]
grads:  [0.1279081]
Stock Position:  0.12790810008199188
Bond Position:  [-12.45179344]


portfolio before change:  [-0.0039874]
curr_Stock_Price:  97.32444065635192
curr_Factors:  [97.32444066]
mat_Sqrt:  [[0.15]]
grads:  [-0.06572391]
Stock Position:  -0.06572390941235007
Bond Position:  [6.39255532]


portfolio before change:  [0.02605235]
curr_Stock_Price:  96.87346013610198
curr_Factors:  [96.87346014]
mat_Sqrt:  [[0.15]]
grads:  [0.21746536]
Stock Position:  0.2174653566612866
Bond Position:  [-21.04056921]


portfolio before change:  [0.00827672]
curr_Stock_Price:  96.79776740011891
curr_Factors:  [96.7977674]
mat_Sqrt:  [[0.15]]
grads:  [0.15440246]
Stock Position:  0.1544024551364525
Bond Position:  [-14.93753622]


portfolio before change:  [0.08998931]
curr_Stock_Price:  97.33303228033661
curr_Factors:  [97.33303228]
mat_Sqrt:  [[0.15]]
grads:  [0.02795492]
Stock Position:  0.027954924180989982
Bond Position:  [-2.63094823]


portfolio before change:  [0.06344522]
curr_Stock_Price:  96.38938283031995
curr_Factors:  [96.38938283]
mat_Sqrt:  [[0.15]]
grads:  [0.03327178]
Stock Position:  0.03327177724429483
Bond Position:  [-3.14360085]


portfolio before change:  [0.0197551]
curr_Stock_Price:  95.08215956070171
curr_Factors:  [95.08215956]
mat_Sqrt:  [[0.15]]
grads:  [0.13267785]
Stock Position:  0.13267784736714042
Bond Position:  [-12.59554116]


portfolio before change:  [0.00439617]
curr_Stock_Price:  94.97233201068191
curr_Factors:  [94.97233201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365029]
Stock Position:  -0.013650291259264535
Bond Position:  [1.30079616]


portfolio before change:  [0.00140824]
curr_Stock_Price:  95.19717907603557
curr_Factors:  [95.19717908]
mat_Sqrt:  [[0.15]]
grads:  [-0.04742303]
Stock Position:  -0.04742302961667512
Bond Position:  [4.51594689]


portfolio before change:  [-0.0064347]
curr_Stock_Price:  95.36851344918246
curr_Factors:  [95.36851345]
mat_Sqrt:  [[0.15]]
grads:  [0.08774031]
Stock Position:  0.08774030745844336
Bond Position:  [-8.37409739]


portfolio before change:  [-0.01490458]
curr_Stock_Price:  95.27794522630722
curr_Factors:  [95.27794523]
mat_Sqrt:  [[0.15]]
grads:  [0.03403757]
Stock Position:  0.03403756775469502
Bond Position:  [-3.25793409]


portfolio before change:  [0.00565081]
curr_Stock_Price:  95.88783065723713
curr_Factors:  [95.88783066]
mat_Sqrt:  [[0.15]]
grads:  [0.24475922]
Stock Position:  0.2447592213741951
Bond Position:  [-23.46377996]


portfolio before change:  [-0.11944835]
curr_Stock_Price:  95.38271124486174
curr_Factors:  [95.38271124]
mat_Sqrt:  [[0.15]]
grads:  [0.02823344]
Stock Position:  0.028233435909377054
Bond Position:  [-2.81243002]


portfolio before change:  [-0.11568854]
curr_Stock_Price:  95.52210594905289
curr_Factors:  [95.52210595]
mat_Sqrt:  [[0.15]]
grads:  [0.00835519]
Stock Position:  0.008355188618669752
Bond Position:  [-0.91379376]


portfolio before change:  [-0.11398945]
curr_Stock_Price:  95.732300160626
curr_Factors:  [95.73230016]
mat_Sqrt:  [[0.15]]
grads:  [0.03182147]
Stock Position:  0.03182146801304094
Bond Position:  [-3.16033177]


portfolio before change:  [-0.10487588]
curr_Stock_Price:  96.02490417544031
curr_Factors:  [96.02490418]
mat_Sqrt:  [[0.15]]
grads:  [0.0248089]
Stock Position:  0.02480889580350428
Bond Position:  [-2.48714773]


portfolio before change:  [-0.10276492]
curr_Stock_Price:  96.11625899342921
curr_Factors:  [96.11625899]
mat_Sqrt:  [[0.15]]
grads:  [0.01906462]
Stock Position:  0.01906462075150335
Bond Position:  [-1.93518495]


portfolio before change:  [-0.10329341]
curr_Stock_Price:  96.09488274351288
curr_Factors:  [96.09488274]
mat_Sqrt:  [[0.15]]
grads:  [-0.03934212]
Stock Position:  -0.03934212292410876
Bond Position:  [3.67728328]


portfolio before change:  [-0.10886876]
curr_Stock_Price:  96.24243938245117
curr_Factors:  [96.24243938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00267795]
Stock Position:  -0.002677947743268903
Bond Position:  [0.14886346]


portfolio before change:  [-0.10996685]
curr_Stock_Price:  96.65596331424811
curr_Factors:  [96.65596331]
mat_Sqrt:  [[0.15]]
grads:  [0.01031822]
Stock Position:  0.010318218441029516
Bond Position:  [-1.10728419]


portfolio before change:  [-0.10967256]
curr_Stock_Price:  96.69119172701824
curr_Factors:  [96.69119173]
mat_Sqrt:  [[0.15]]
grads:  [-0.10856835]
Stock Position:  -0.10856834504599229
Bond Position:  [10.3879301]


portfolio before change:  [-0.14593652]
curr_Stock_Price:  97.0311915760277
curr_Factors:  [97.03119158]
mat_Sqrt:  [[0.15]]
grads:  [-0.0279266]
Stock Position:  -0.027926600192543876
Bond Position:  [2.56381477]


portfolio before change:  [-0.15358442]
curr_Stock_Price:  97.31078672314712
curr_Factors:  [97.31078672]
mat_Sqrt:  [[0.15]]
grads:  [0.0370515]
Stock Position:  0.03705149566601484
Bond Position:  [-3.75909461]


portfolio before change:  [-0.15210967]
curr_Stock_Price:  97.35693065895435
curr_Factors:  [97.35693066]
mat_Sqrt:  [[0.15]]
grads:  [0.08304418]
Stock Position:  0.08304417715989301
Bond Position:  [-8.23703586]


portfolio before change:  [-0.08648575]
curr_Stock_Price:  98.15335915112303
curr_Factors:  [98.15335915]
mat_Sqrt:  [[0.15]]
grads:  [-0.11949458]
Stock Position:  -0.11949457929215687
Bond Position:  [11.64230861]


portfolio before change:  [-0.00194313]
curr_Stock_Price:  97.45194702210523
curr_Factors:  [97.45194702]
mat_Sqrt:  [[0.15]]
grads:  [-0.05789978]
Stock Position:  -0.05789977676636952
Bond Position:  [5.64050284]


portfolio before change:  [-0.0280103]
curr_Stock_Price:  97.90824772585721
curr_Factors:  [97.90824773]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852816]
Stock Position:  -0.03852816261419967
Bond Position:  [3.74421459]


portfolio before change:  [-0.00894223]
curr_Stock_Price:  97.41940920394183
curr_Factors:  [97.4194092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148931]
Stock Position:  -0.03148930569442012
Bond Position:  [3.05872733]


portfolio before change:  [-0.00990441]
curr_Stock_Price:  97.4560360767236
curr_Factors:  [97.45603608]
mat_Sqrt:  [[0.15]]
grads:  [0.11617627]
Stock Position:  0.11617627281293712
Bond Position:  [-11.33198344]


portfolio before change:  [0.05293529]
curr_Stock_Price:  98.00303223289391
curr_Factors:  [98.00303223]
mat_Sqrt:  [[0.15]]
grads:  [-0.06678164]
Stock Position:  -0.06678164104087957
Bond Position:  [6.59773861]


portfolio before change:  [0.08455468]
curr_Stock_Price:  97.53573293546046
curr_Factors:  [97.53573294]
mat_Sqrt:  [[0.15]]
grads:  [0.05240174]
Stock Position:  0.05240173827192034
Bond Position:  [-5.02648727]


portfolio before change:  [0.09016762]
curr_Stock_Price:  97.64884185048125
curr_Factors:  [97.64884185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685746]
Stock Position:  -0.026857463039282166
Bond Position:  [2.71276778]


portfolio before change:  [0.08566484]
curr_Stock_Price:  97.8228095075283
curr_Factors:  [97.82280951]
mat_Sqrt:  [[0.15]]
grads:  [0.07545154]
Stock Position:  0.07545154074204011
Bond Position:  [-7.29521685]


portfolio before change:  [0.1071757]
curr_Stock_Price:  98.11394764052525
curr_Factors:  [98.11394764]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607519]
Stock Position:  -0.016075186926607622
Bond Position:  [1.68437575]


portfolio before change:  [0.09884234]
curr_Stock_Price:  98.63889554140123
curr_Factors:  [98.63889554]
mat_Sqrt:  [[0.15]]
grads:  [0.05465704]
Stock Position:  0.05465704286476422
Bond Position:  [-5.292468]


portfolio before change:  [0.09018507]
curr_Stock_Price:  98.48655508719708
curr_Factors:  [98.48655509]
mat_Sqrt:  [[0.15]]
grads:  [-0.11191988]
Stock Position:  -0.11191988177668927
Bond Position:  [11.11278867]


portfolio before change:  [0.12080055]
curr_Stock_Price:  98.21921285976893
curr_Factors:  [98.21921286]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015683]
Stock Position:  -0.050156833226561705
Bond Position:  [5.04716523]


portfolio before change:  [0.10515688]
curr_Stock_Price:  98.53739746650889
curr_Factors:  [98.53739747]
mat_Sqrt:  [[0.15]]
grads:  [-0.00373886]
Stock Position:  -0.003738860659859948
Bond Position:  [0.47357448]


portfolio before change:  [0.10535559]
curr_Stock_Price:  98.49216704808366
curr_Factors:  [98.49216705]
mat_Sqrt:  [[0.15]]
grads:  [0.0086936]
Stock Position:  0.008693599618927668
Bond Position:  [-0.75089588]


portfolio before change:  [0.0988412]
curr_Stock_Price:  97.74823453366162
curr_Factors:  [97.74823453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.0988412]
Stock Price:  96.99976240404504
PL:  [0.0988412]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.83494303e-03]
 [ 2.44872454e-03]
 [ 3.15911398e-04]
 [ 5.81544341e-03]
 [ 4.48271481e-03]
 [ 2.75146024e-02]
 [ 7.54669527e-04]
 [-1.66228976e-02]
 [ 2.34821753e-02]
 [-4.86347895e-03]
 [ 1.59199944e-02]
 [-4.47238579e-02]
 [ 4.51399293e-02]
 [ 6.29731459e-03]
 [-6.89933411e-03]
 [ 2.80824183e-02]
 [ 1.22949642e-02]
 [-8.52598481e-03]
 [ 2.57394744e-03]
 [-6.32080854e-03]
 [ 1.24437309e-02]
 [-6.35881380e-03]
 [ 1.09967672e-02]
 [ 6.90309775e-03]
 [ 1.29381466e-03]
 [ 1.18318965e-02]
 [-6.51616428e-03]
 [ 7.74085277e-03]
 [ 1.45369075e-02]
 [-1.79023019e-03]
 [ 1.31323536e-02]
 [-1.20458505e-02]
 [ 9.73559083e-04]
 [ 8.56110468e-03]
 [ 1.06671042e-02]
 [ 8.39905204e-03]
 [-3.34971220e-02]
 [ 9.57436335e-03]
 [ 4.76974324e-03]
 [ 1.94196048e-02]
 [-3.97667848e-03]
 [-2.02175201e-02]
 [ 2.08386084e-02]
 [-1.59446431e-03]
 [ 1.89226760e-04]
 [-1.06758922e-02]
 [ 1.34430001e-02]
 [-7.58066830e-03]
 [-1.25680812e-02]
 [-6.87160027e-03]
 [ 4.77058709e-02]
 [-8.77091978e-03]
 [ 2.66034329e-03]
 [ 5.29847957e-03]
 [ 5.58946761e-03]
 [-3.44953770e-03]
 [ 6.71336903e-03]
 [-2.03032191e-04]
 [ 1.53735004e-03]
 [ 1.05933527e-04]
 [-4.02003107e-04]
 [ 4.82773461e-03]
 [ 1.11986755e-02]
 [-1.83585982e-02]
 [-9.62685773e-03]
 [-5.57438559e-03]
 [-4.78760528e-03]
 [ 1.89172071e-02]
 [-9.98547255e-03]
 [ 7.66901585e-03]
 [-3.99674038e-03]
 [ 1.17550971e-02]
 [-4.91055993e-04]
 [ 3.06830181e-03]
 [-2.28530122e-03]
 [-1.26666426e-02]
 [ 3.56494223e-03]
 [ 4.73418472e-03]
 [-5.07356234e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.16514787]
curr_Stock_Price:  99.85650782213598
curr_Factors:  [99.85650782]
mat_Sqrt:  [[0.15]]
grads:  [0.01889962]
Stock Position:  0.018899620184186613
Bond Position:  [-2.05239794]


portfolio before change:  [-0.16246672]
curr_Stock_Price:  100.00515798247636
curr_Factors:  [100.00515798]
mat_Sqrt:  [[0.15]]
grads:  [0.01632483]
Stock Position:  0.016324830250541364
Bond Position:  [-1.79503395]


portfolio before change:  [-0.16202518]
curr_Stock_Price:  100.03907745486846
curr_Factors:  [100.03907745]
mat_Sqrt:  [[0.15]]
grads:  [0.00210608]
Stock Position:  0.0021060759881486673
Bond Position:  [-0.37271508]


portfolio before change:  [-0.16075944]
curr_Stock_Price:  100.65113416370946
curr_Factors:  [100.65113416]
mat_Sqrt:  [[0.15]]
grads:  [0.03876962]
Stock Position:  0.03876962274919696
Bond Position:  [-4.06296594]


portfolio before change:  [-0.16584516]
curr_Stock_Price:  100.5265061159299
curr_Factors:  [100.52650612]
mat_Sqrt:  [[0.15]]
grads:  [0.02988477]
Stock Position:  0.02988476538900774
Bond Position:  [-3.17005622]


portfolio before change:  [-0.1661331]
curr_Stock_Price:  100.52350108437953
curr_Factors:  [100.52350108]
mat_Sqrt:  [[0.15]]
grads:  [0.18343068]
Stock Position:  0.1834306826670747
Bond Position:  [-18.60522753]


portfolio before change:  [-0.35605126]
curr_Stock_Price:  99.49447319214669
curr_Factors:  [99.49447319]
mat_Sqrt:  [[0.15]]
grads:  [0.00503113]
Stock Position:  0.005031130180462622
Bond Position:  [-0.8566209]


portfolio before change:  [-0.35306081]
curr_Stock_Price:  100.09950316685642
curr_Factors:  [100.09950317]
mat_Sqrt:  [[0.15]]
grads:  [-0.11081932]
Stock Position:  -0.11081931729478348
Bond Position:  [10.73989779]


portfolio before change:  [-0.38002026]
curr_Stock_Price:  100.34883433056359
curr_Factors:  [100.34883433]
mat_Sqrt:  [[0.15]]
grads:  [0.15654784]
Stock Position:  0.15654783505854283
Bond Position:  [-16.08941302]


portfolio before change:  [-0.27574379]
curr_Stock_Price:  101.02135775728071
curr_Factors:  [101.02135776]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242319]
Stock Position:  -0.03242319302962648
Bond Position:  [2.99969119]


portfolio before change:  [-0.26517989]
curr_Stock_Price:  100.70132710286991
curr_Factors:  [100.7013271]
mat_Sqrt:  [[0.15]]
grads:  [0.1061333]
Stock Position:  0.10613329614642251
Bond Position:  [-10.95294366]


portfolio before change:  [-0.20755921]
curr_Stock_Price:  101.25068584328268
curr_Factors:  [101.25068584]
mat_Sqrt:  [[0.15]]
grads:  [-0.29815905]
Stock Position:  -0.2981590528201407
Bond Position:  [29.98124937]


portfolio before change:  [-0.28509577]
curr_Stock_Price:  101.51702168633538
curr_Factors:  [101.51702169]
mat_Sqrt:  [[0.15]]
grads:  [0.30093286]
Stock Position:  0.3009328619825173
Bond Position:  [-30.83490365]


portfolio before change:  [-0.21364736]
curr_Stock_Price:  101.76084899049954
curr_Factors:  [101.76084899]
mat_Sqrt:  [[0.15]]
grads:  [0.0419821]
Stock Position:  0.04198209723346614
Bond Position:  [-4.48578122]


portfolio before change:  [-0.18067774]
curr_Stock_Price:  102.55285305494694
curr_Factors:  [102.55285305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599556]
Stock Position:  -0.04599556073965431
Bond Position:  [4.53629824]


portfolio before change:  [-0.18947303]
curr_Stock_Price:  102.75023776848094
curr_Factors:  [102.75023777]
mat_Sqrt:  [[0.15]]
grads:  [0.18721612]
Stock Position:  0.187216121680827
Bond Position:  [-19.42597405]


portfolio before change:  [-0.14709585]
curr_Stock_Price:  102.98307746968065
curr_Factors:  [102.98307747]
mat_Sqrt:  [[0.15]]
grads:  [0.08196643]
Stock Position:  0.08196642830681554
Bond Position:  [-8.58825089]


portfolio before change:  [-0.15731763]
curr_Stock_Price:  102.8649194030093
curr_Factors:  [102.8649194]
mat_Sqrt:  [[0.15]]
grads:  [-0.0568399]
Stock Position:  -0.05683989870130541
Bond Position:  [5.68951397]


portfolio before change:  [-0.10396841]
curr_Stock_Price:  101.93258816956586
curr_Factors:  [101.93258817]
mat_Sqrt:  [[0.15]]
grads:  [0.01715965]
Stock Position:  0.017159649605885115
Bond Position:  [-1.8530959]


portfolio before change:  [-0.09123031]
curr_Stock_Price:  102.68166631616452
curr_Factors:  [102.68166632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04213872]
Stock Position:  -0.042138723583776544
Bond Position:  [4.23564404]


portfolio before change:  [-0.02666299]
curr_Stock_Price:  101.15569257588562
curr_Factors:  [101.15569258]
mat_Sqrt:  [[0.15]]
grads:  [0.08295821]
Stock Position:  0.08295820623608118
Bond Position:  [-8.4183578]


portfolio before change:  [-0.06650099]
curr_Stock_Price:  100.6818174141983
curr_Factors:  [100.68181741]
mat_Sqrt:  [[0.15]]
grads:  [-0.04239209]
Stock Position:  -0.04239209201667173
Bond Position:  [4.20161188]


portfolio before change:  [-0.11852865]
curr_Stock_Price:  101.91530846967228
curr_Factors:  [101.91530847]
mat_Sqrt:  [[0.15]]
grads:  [0.07331178]
Stock Position:  0.07331178124543569
Bond Position:  [-7.59012145]


portfolio before change:  [-0.13348918]
curr_Stock_Price:  101.71771214765137
curr_Factors:  [101.71771215]
mat_Sqrt:  [[0.15]]
grads:  [0.04602065]
Stock Position:  0.04602065168627545
Bond Position:  [-4.81460458]


portfolio before change:  [-0.15650987]
curr_Stock_Price:  101.22402586591583
curr_Factors:  [101.22402587]
mat_Sqrt:  [[0.15]]
grads:  [0.00862543]
Stock Position:  0.008625431076769916
Bond Position:  [-1.02961073]


portfolio before change:  [-0.15460407]
curr_Stock_Price:  101.45243726689608
curr_Factors:  [101.45243727]
mat_Sqrt:  [[0.15]]
grads:  [0.07887931]
Stock Position:  0.07887930975106602
Bond Position:  [-8.1571023]


portfolio before change:  [-0.22171137]
curr_Stock_Price:  100.60814150914884
curr_Factors:  [100.60814151]
mat_Sqrt:  [[0.15]]
grads:  [-0.0434411]
Stock Position:  -0.043441095186792344
Bond Position:  [4.14881648]


portfolio before change:  [-0.24646529]
curr_Stock_Price:  101.18393791215037
curr_Factors:  [101.18393791]
mat_Sqrt:  [[0.15]]
grads:  [0.05160569]
Stock Position:  0.051605685133217276
Bond Position:  [-5.46813173]


portfolio before change:  [-0.24490487]
curr_Stock_Price:  101.22079808488596
curr_Factors:  [101.22079808]
mat_Sqrt:  [[0.15]]
grads:  [0.09691272]
Stock Position:  0.096912716339094
Bond Position:  [-10.05448736]


portfolio before change:  [-0.21424504]
curr_Stock_Price:  101.54364790374511
curr_Factors:  [101.5436479]
mat_Sqrt:  [[0.15]]
grads:  [-0.01193487]
Stock Position:  -0.011934867956697797
Bond Position:  [0.99766499]


portfolio before change:  [-0.22060545]
curr_Stock_Price:  102.0817995836591
curr_Factors:  [102.08179958]
mat_Sqrt:  [[0.15]]
grads:  [0.08754902]
Stock Position:  0.08754902401618744
Bond Position:  [-9.15776738]


portfolio before change:  [-0.23516919]
curr_Stock_Price:  101.92198782720695
curr_Factors:  [101.92198783]
mat_Sqrt:  [[0.15]]
grads:  [-0.08030567]
Stock Position:  -0.08030567000433703
Bond Position:  [7.94974433]


portfolio before change:  [-0.34660801]
curr_Stock_Price:  103.31585818808723
curr_Factors:  [103.31585819]
mat_Sqrt:  [[0.15]]
grads:  [0.00649039]
Stock Position:  0.006490393886376044
Bond Position:  [-1.01716863]


portfolio before change:  [-0.34596737]
curr_Stock_Price:  103.42435900221255
curr_Factors:  [103.424359]
mat_Sqrt:  [[0.15]]
grads:  [0.05707403]
Stock Position:  0.05707403123296623
Bond Position:  [-6.24881247]


portfolio before change:  [-0.38568804]
curr_Stock_Price:  102.73525224952891
curr_Factors:  [102.73525225]
mat_Sqrt:  [[0.15]]
grads:  [0.07111403]
Stock Position:  0.07111402784342599
Bond Position:  [-7.69160563]


portfolio before change:  [-0.39298933]
curr_Stock_Price:  102.63934210830081
curr_Factors:  [102.63934211]
mat_Sqrt:  [[0.15]]
grads:  [0.05599368]
Stock Position:  0.05599368028663408
Bond Position:  [-6.14014384]


portfolio before change:  [-0.42100508]
curr_Stock_Price:  102.14585826006163
curr_Factors:  [102.14585826]
mat_Sqrt:  [[0.15]]
grads:  [-0.22331415]
Stock Position:  -0.22331414673063193
Bond Position:  [22.3896101]


portfolio before change:  [-0.32299344]
curr_Stock_Price:  101.71322891865536
curr_Factors:  [101.71322892]
mat_Sqrt:  [[0.15]]
grads:  [0.06382909]
Stock Position:  0.06382908896964723
Bond Position:  [-6.81525617]


portfolio before change:  [-0.3150112]
curr_Stock_Price:  101.84495891913033
curr_Factors:  [101.84495892]
mat_Sqrt:  [[0.15]]
grads:  [0.03179829]
Stock Position:  0.03179828825435972
Bond Position:  [-3.55350656]


portfolio before change:  [-0.29967107]
curr_Stock_Price:  102.33436360152075
curr_Factors:  [102.3343636]
mat_Sqrt:  [[0.15]]
grads:  [0.12946403]
Stock Position:  0.12946403205590065
Bond Position:  [-13.5482904]


portfolio before change:  [-0.13921725]
curr_Stock_Price:  103.5802741763028
curr_Factors:  [103.58027418]
mat_Sqrt:  [[0.15]]
grads:  [-0.02651119]
Stock Position:  -0.02651118988731365
Bond Position:  [2.60681906]


portfolio before change:  [-0.1152533]
curr_Stock_Price:  102.68250145396428
curr_Factors:  [102.68250145]
mat_Sqrt:  [[0.15]]
grads:  [-0.13478347]
Stock Position:  -0.13478346707780756
Bond Position:  [13.72465025]


portfolio before change:  [-0.17424736]
curr_Stock_Price:  103.12656094469698
curr_Factors:  [103.12656094]
mat_Sqrt:  [[0.15]]
grads:  [0.13892406]
Stock Position:  0.1389240560817363
Bond Position:  [-14.5010075]


portfolio before change:  [-0.14365307]
curr_Stock_Price:  103.35330808539416
curr_Factors:  [103.35330809]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062976]
Stock Position:  -0.01062976203631388
Bond Position:  [0.954968]


portfolio before change:  [-0.13803288]
curr_Stock_Price:  102.83020105866464
curr_Factors:  [102.83020106]
mat_Sqrt:  [[0.15]]
grads:  [0.00126151]
Stock Position:  0.001261511732640443
Bond Position:  [-0.26775438]


portfolio before change:  [-0.13897206]
curr_Stock_Price:  102.09897529154843
curr_Factors:  [102.09897529]
mat_Sqrt:  [[0.15]]
grads:  [-0.07117261]
Stock Position:  -0.0711726146883253
Bond Position:  [7.12767896]


portfolio before change:  [-0.142689]
curr_Stock_Price:  102.15745884095264
curr_Factors:  [102.15745884]
mat_Sqrt:  [[0.15]]
grads:  [0.08962]
Stock Position:  0.08962000063675499
Bond Position:  [-9.29804052]


portfolio before change:  [-0.25315192]
curr_Stock_Price:  100.93137339186994
curr_Factors:  [100.93137339]
mat_Sqrt:  [[0.15]]
grads:  [-0.05053779]
Stock Position:  -0.05053778868451654
Bond Position:  [4.8476965]


portfolio before change:  [-0.17847095]
curr_Stock_Price:  99.45964342075143
curr_Factors:  [99.45964342]
mat_Sqrt:  [[0.15]]
grads:  [-0.08378721]
Stock Position:  -0.08378720824954751
Bond Position:  [8.1549749]


portfolio before change:  [-0.22740869]
curr_Stock_Price:  100.0497983607783
curr_Factors:  [100.04979836]
mat_Sqrt:  [[0.15]]
grads:  [-0.04581067]
Stock Position:  -0.04581066849162249
Bond Position:  [4.35593946]


portfolio before change:  [-0.20151405]
curr_Stock_Price:  99.49048792630363
curr_Factors:  [99.49048793]
mat_Sqrt:  [[0.15]]
grads:  [0.31803914]
Stock Position:  0.31803913950351004
Bond Position:  [-31.84338321]


portfolio before change:  [-0.19276091]
curr_Stock_Price:  99.52426807873992
curr_Factors:  [99.52426808]
mat_Sqrt:  [[0.15]]
grads:  [-0.0584728]
Stock Position:  -0.05847279856224201
Bond Position:  [5.62670157]


portfolio before change:  [-0.21358564]
curr_Stock_Price:  99.88642636234509
curr_Factors:  [99.88642636]
mat_Sqrt:  [[0.15]]
grads:  [0.01773562]
Stock Position:  0.017735621914365236
Bond Position:  [-1.98513353]


portfolio before change:  [-0.2376489]
curr_Stock_Price:  98.53664628883959
curr_Factors:  [98.53664629]
mat_Sqrt:  [[0.15]]
grads:  [0.0353232]
Stock Position:  0.03532319715253993
Bond Position:  [-3.71827828]


portfolio before change:  [-0.23634043]
curr_Stock_Price:  98.58026825257582
curr_Factors:  [98.58026825]
mat_Sqrt:  [[0.15]]
grads:  [0.03726312]
Stock Position:  0.037263117383923204
Bond Position:  [-3.90974854]


portfolio before change:  [-0.21010684]
curr_Stock_Price:  99.29083579598311
curr_Factors:  [99.2908358]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299692]
Stock Position:  -0.022996917985395143
Bond Position:  [2.07327637]


portfolio before change:  [-0.21228267]
curr_Stock_Price:  99.39108463222313
curr_Factors:  [99.39108463]
mat_Sqrt:  [[0.15]]
grads:  [0.04475579]
Stock Position:  0.04475579355451957
Bond Position:  [-4.66060953]


portfolio before change:  [-0.23189016]
curr_Stock_Price:  98.95949367132562
curr_Factors:  [98.95949367]
mat_Sqrt:  [[0.15]]
grads:  [-0.00135355]
Stock Position:  -0.0013535479429042027
Bond Position:  [-0.09794374]


portfolio before change:  [-0.23113876]
curr_Stock_Price:  98.39983457046037
curr_Factors:  [98.39983457]
mat_Sqrt:  [[0.15]]
grads:  [0.010249]
Stock Position:  0.010249000254246184
Bond Position:  [-1.23963869]


portfolio before change:  [-0.23533542]
curr_Stock_Price:  97.99792416805279
curr_Factors:  [97.99792417]
mat_Sqrt:  [[0.15]]
grads:  [0.00070622]
Stock Position:  0.0007062235111458121
Bond Position:  [-0.30454386]


portfolio before change:  [-0.23535552]
curr_Stock_Price:  97.9964134795896
curr_Factors:  [97.99641348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00268002]
Stock Position:  -0.0026800207103172663
Bond Position:  [0.0272769]


portfolio before change:  [-0.23387272]
curr_Stock_Price:  97.44377001802913
curr_Factors:  [97.44377002]
mat_Sqrt:  [[0.15]]
grads:  [0.0321849]
Stock Position:  0.032184897397668305
Bond Position:  [-3.37009046]


portfolio before change:  [-0.22927634]
curr_Stock_Price:  97.59312633078802
curr_Factors:  [97.59312633]
mat_Sqrt:  [[0.15]]
grads:  [0.07465784]
Stock Position:  0.07465783674540967
Bond Position:  [-7.51536803]


portfolio before change:  [-0.23282347]
curr_Stock_Price:  97.55190617489727
curr_Factors:  [97.55190617]
mat_Sqrt:  [[0.15]]
grads:  [-0.12239065]
Stock Position:  -0.1223906548656676
Bond Position:  [11.70661821]


portfolio before change:  [-0.25694893]
curr_Stock_Price:  97.75500296066167
curr_Factors:  [97.75500296]
mat_Sqrt:  [[0.15]]
grads:  [-0.06417905]
Stock Position:  -0.06417905150804276
Bond Position:  [6.01687444]


portfolio before change:  [-0.2689079]
curr_Stock_Price:  97.94720009938595
curr_Factors:  [97.9472001]
mat_Sqrt:  [[0.15]]
grads:  [-0.03716257]
Stock Position:  -0.03716257060557193
Bond Position:  [3.37106184]


portfolio before change:  [-0.26603391]
curr_Stock_Price:  97.87553418686579
curr_Factors:  [97.87553419]
mat_Sqrt:  [[0.15]]
grads:  [-0.03191737]
Stock Position:  -0.031917368506129855
Bond Position:  [2.85789558]


portfolio before change:  [-0.26952408]
curr_Stock_Price:  97.99048090065916
curr_Factors:  [97.9904809]
mat_Sqrt:  [[0.15]]
grads:  [0.12611471]
Stock Position:  0.1261147140095478
Bond Position:  [-12.62756556]


portfolio before change:  [-0.26444585]
curr_Stock_Price:  98.03700587475383
curr_Factors:  [98.03700587]
mat_Sqrt:  [[0.15]]
grads:  [-0.06656982]
Stock Position:  -0.06656981697332964
Bond Position:  [6.26185969]


portfolio before change:  [-0.23752148]
curr_Stock_Price:  97.63843199302057
curr_Factors:  [97.63843199]
mat_Sqrt:  [[0.15]]
grads:  [0.05112677]
Stock Position:  0.05112677236412656
Bond Position:  [-5.22945936]


portfolio before change:  [-0.2377392]
curr_Stock_Price:  97.64056638226006
curr_Factors:  [97.64056638]
mat_Sqrt:  [[0.15]]
grads:  [-0.02664494]
Stock Position:  -0.02664493584289394
Bond Position:  [2.36388742]


portfolio before change:  [-0.21234213]
curr_Stock_Price:  96.69294423881801
curr_Factors:  [96.69294424]
mat_Sqrt:  [[0.15]]
grads:  [0.07836731]
Stock Position:  0.07836731383838365
Bond Position:  [-7.78990843]


portfolio before change:  [-0.16518213]
curr_Stock_Price:  97.30093857536514
curr_Factors:  [97.30093858]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327371]
Stock Position:  -0.0032737066177318157
Bond Position:  [0.1533526]


portfolio before change:  [-0.16329523]
curr_Stock_Price:  96.72748636761436
curr_Factors:  [96.72748637]
mat_Sqrt:  [[0.15]]
grads:  [0.02045535]
Stock Position:  0.02045534542586169
Bond Position:  [-2.14188937]


portfolio before change:  [-0.17278115]
curr_Stock_Price:  96.27029309392181
curr_Factors:  [96.27029309]
mat_Sqrt:  [[0.15]]
grads:  [-0.01523534]
Stock Position:  -0.01523534144187759
Bond Position:  [1.29392964]


portfolio before change:  [-0.17675061]
curr_Stock_Price:  96.53614429577172
curr_Factors:  [96.5361443]
mat_Sqrt:  [[0.15]]
grads:  [-0.08444428]
Stock Position:  -0.08444428421874854
Bond Position:  [7.975175]


portfolio before change:  [-0.21368601]
curr_Stock_Price:  96.97944090080114
curr_Factors:  [96.9794409]
mat_Sqrt:  [[0.15]]
grads:  [0.02376628]
Stock Position:  0.023766281516096582
Bond Position:  [-2.5185267]


portfolio before change:  [-0.22387184]
curr_Stock_Price:  96.55748079395492
curr_Factors:  [96.55748079]
mat_Sqrt:  [[0.15]]
grads:  [0.03156123]
Stock Position:  0.03156123144889759
Bond Position:  [-3.27134484]


portfolio before change:  [-0.22985184]
curr_Stock_Price:  96.37448616481215
curr_Factors:  [96.37448616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.22985184]
Stock Price:  96.58805522355233
PL:  [-0.22985184]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.82800241e-03]
 [-3.06852840e-03]
 [-8.72984675e-04]
 [ 6.71421253e-03]
 [-2.93154797e-03]
 [ 1.46654132e-02]
 [ 1.65283691e-03]
 [-2.04460569e-02]
 [-8.24167061e-04]
 [ 2.26456220e-02]
 [ 2.38277531e-03]
 [ 9.28984425e-03]
 [-2.10472157e-03]
 [ 8.59219415e-03]
 [-6.95543665e-03]
 [ 7.44448233e-03]
 [ 7.33935956e-03]
 [-1.18189922e-02]
 [-4.88592396e-04]
 [ 1.57017554e-02]
 [ 1.14466197e-02]
 [-7.92751942e-03]
 [ 6.84926016e-03]
 [ 2.49489284e-02]
 [ 2.56194360e-04]
 [ 1.20858542e-02]
 [-6.90975660e-03]
 [ 6.08817414e-03]
 [-8.29776354e-03]
 [-1.85384646e-03]
 [-6.36787057e-03]
 [-1.06252087e-02]
 [ 1.60621675e-03]
 [ 4.62757433e-03]
 [ 1.19686624e-02]
 [ 1.30195446e-02]
 [-3.51262406e-02]
 [ 9.40175263e-03]
 [-1.75530708e-02]
 [ 2.44580299e-02]
 [-5.33031839e-03]
 [ 2.62040601e-03]
 [ 2.30420118e-02]
 [ 4.14143131e-03]
 [ 4.74918488e-03]
 [ 1.03694318e-02]
 [-2.86681826e-04]
 [-1.10180335e-02]
 [ 4.93527141e-03]
 [ 1.99679041e-03]
 [ 3.82043619e-02]
 [-1.76861543e-03]
 [ 2.00130792e-03]
 [ 5.02730978e-03]
 [ 3.94788573e-03]
 [ 9.68961319e-04]
 [-3.35928465e-03]
 [-6.44700560e-04]
 [ 1.53408748e-03]
 [ 2.40745805e-04]
 [ 4.38600900e-04]
 [ 2.01700335e-03]
 [ 1.16979582e-02]
 [-1.81157330e-02]
 [-1.28649119e-02]
 [-3.77041442e-03]
 [-4.97663779e-03]
 [ 2.30443594e-02]
 [-8.76318364e-03]
 [ 6.04750456e-03]
 [-6.39301738e-03]
 [ 1.07672894e-02]
 [-4.87626255e-03]
 [ 7.41361812e-03]
 [-1.63581160e-02]
 [-4.81312279e-03]
 [-3.50274189e-03]
 [ 1.39130314e-03]
 [-7.76197210e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.95986966]
curr_Stock_Price:  99.54473123470238
curr_Factors:  [99.54473123]
mat_Sqrt:  [[0.15]]
grads:  [0.02552002]
Stock Position:  0.02552001609205733
Bond Position:  [-7.50025281]


portfolio before change:  [-4.96217984]
curr_Stock_Price:  99.47257635946592
curr_Factors:  [99.47257636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02045686]
Stock Position:  -0.020456855985866176
Bond Position:  [-2.92728367]


portfolio before change:  [-4.96195876]
curr_Stock_Price:  99.45282580088428
curr_Factors:  [99.4528258]
mat_Sqrt:  [[0.15]]
grads:  [-0.0058199]
Stock Position:  -0.005819897831602055
Bond Position:  [-4.38315348]


portfolio before change:  [-4.95820936]
curr_Stock_Price:  98.76151442645245
curr_Factors:  [98.76151443]
mat_Sqrt:  [[0.15]]
grads:  [0.04476142]
Stock Position:  0.044761416886997994
Bond Position:  [-9.37891468]


portfolio before change:  [-4.96865522]
curr_Stock_Price:  98.54124291229388
curr_Factors:  [98.54124291]
mat_Sqrt:  [[0.15]]
grads:  [-0.01954365]
Stock Position:  -0.019543653100823365
Bond Position:  [-3.04279936]


portfolio before change:  [-4.96764992]
curr_Stock_Price:  98.48007298711138
curr_Factors:  [98.48007299]
mat_Sqrt:  [[0.15]]
grads:  [0.09776942]
Stock Position:  0.09776942110084594
Bond Position:  [-14.59598965]


portfolio before change:  [-4.92859623]
curr_Stock_Price:  98.88885082223133
curr_Factors:  [98.88885082]
mat_Sqrt:  [[0.15]]
grads:  [0.01101891]
Stock Position:  0.011018912734220999
Bond Position:  [-6.01824384]


portfolio before change:  [-4.9310538]
curr_Stock_Price:  98.6999552399788
curr_Factors:  [98.69995524]
mat_Sqrt:  [[0.15]]
grads:  [-0.13630705]
Stock Position:  -0.1363070460049515
Bond Position:  [8.52244554]


portfolio before change:  [-4.92710668]
curr_Stock_Price:  98.67490555084221
curr_Factors:  [98.67490555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00549445]
Stock Position:  -0.005494447074508811
Bond Position:  [-4.38494264]


portfolio before change:  [-4.92719583]
curr_Stock_Price:  98.64124886773055
curr_Factors:  [98.64124887]
mat_Sqrt:  [[0.15]]
grads:  [0.15097081]
Stock Position:  0.1509708132621299
Bond Position:  [-19.81914539]


portfolio before change:  [-4.92641879]
curr_Stock_Price:  98.65460089131918
curr_Factors:  [98.65460089]
mat_Sqrt:  [[0.15]]
grads:  [0.01588517]
Stock Position:  0.01588516875522176
Bond Position:  [-6.49356378]


portfolio before change:  [-4.91445499]
curr_Stock_Price:  99.43329374067113
curr_Factors:  [99.43329374]
mat_Sqrt:  [[0.15]]
grads:  [0.06193229]
Stock Position:  0.061932294989238135
Bond Position:  [-11.07258707]


portfolio before change:  [-4.894683]
curr_Stock_Price:  99.76371979327327
curr_Factors:  [99.76371979]
mat_Sqrt:  [[0.15]]
grads:  [-0.01403148]
Stock Position:  -0.0140314771041114
Bond Position:  [-3.49485065]


portfolio before change:  [-4.89608224]
curr_Stock_Price:  99.84787357621036
curr_Factors:  [99.84787358]
mat_Sqrt:  [[0.15]]
grads:  [0.05728129]
Stock Position:  0.057281294335449255
Bond Position:  [-10.61549767]


portfolio before change:  [-4.95293227]
curr_Stock_Price:  98.86698537339582
curr_Factors:  [98.86698537]
mat_Sqrt:  [[0.15]]
grads:  [-0.04636958]
Stock Position:  -0.04636957769189077
Bond Position:  [-0.36851192]


portfolio before change:  [-4.96411084]
curr_Stock_Price:  99.10756402556424
curr_Factors:  [99.10756403]
mat_Sqrt:  [[0.15]]
grads:  [0.04962988]
Stock Position:  0.04962988216791811
Bond Position:  [-9.88280756]


portfolio before change:  [-4.93890663]
curr_Stock_Price:  99.62785345424844
curr_Factors:  [99.62785345]
mat_Sqrt:  [[0.15]]
grads:  [0.04892906]
Stock Position:  0.04892906372060178
Bond Position:  [-9.81360422]


portfolio before change:  [-4.94643764]
curr_Stock_Price:  99.48647244388185
curr_Factors:  [99.48647244]
mat_Sqrt:  [[0.15]]
grads:  [-0.07879328]
Stock Position:  -0.07879328162650627
Bond Position:  [2.892428]


portfolio before change:  [-4.9389795]
curr_Stock_Price:  99.39411237851274
curr_Factors:  [99.39411238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325728]
Stock Position:  -0.003257282639448246
Bond Position:  [-4.61522479]


portfolio before change:  [-4.93930801]
curr_Stock_Price:  99.40640654385545
curr_Factors:  [99.40640654]
mat_Sqrt:  [[0.15]]
grads:  [0.10467837]
Stock Position:  0.10467836908378096
Bond Position:  [-15.34500852]


portfolio before change:  [-4.91783355]
curr_Stock_Price:  99.62071587528506
curr_Factors:  [99.62071588]
mat_Sqrt:  [[0.15]]
grads:  [0.0763108]
Stock Position:  0.07631079832747856
Bond Position:  [-12.51996991]


portfolio before change:  [-4.92698578]
curr_Stock_Price:  99.5110367069008
curr_Factors:  [99.51103671]
mat_Sqrt:  [[0.15]]
grads:  [-0.05285013]
Stock Position:  -0.052850129457153394
Bond Position:  [0.33218539]


portfolio before change:  [-4.98838256]
curr_Stock_Price:  100.67314441774671
curr_Factors:  [100.67314442]
mat_Sqrt:  [[0.15]]
grads:  [0.04566173]
Stock Position:  0.045661734378715894
Bond Position:  [-9.58529294]


portfolio before change:  [-4.97646497]
curr_Stock_Price:  100.94726219675802
curr_Factors:  [100.9472622]
mat_Sqrt:  [[0.15]]
grads:  [0.16632619]
Stock Position:  0.1663261892266865
Bond Position:  [-21.7666384]


portfolio before change:  [-5.02437397]
curr_Stock_Price:  100.66739921403331
curr_Factors:  [100.66739921]
mat_Sqrt:  [[0.15]]
grads:  [0.00170796]
Stock Position:  0.001707962402044382
Bond Position:  [-5.1963101]


portfolio before change:  [-5.02575303]
curr_Stock_Price:  100.05012256291968
curr_Factors:  [100.05012256]
mat_Sqrt:  [[0.15]]
grads:  [0.08057236]
Stock Position:  0.08057236145310004
Bond Position:  [-13.08702767]


portfolio before change:  [-5.07244381]
curr_Stock_Price:  99.48078570390987
curr_Factors:  [99.4807857]
mat_Sqrt:  [[0.15]]
grads:  [-0.04606504]
Stock Position:  -0.04606504403049107
Bond Position:  [-0.48985704]


portfolio before change:  [-5.06969801]
curr_Stock_Price:  99.42051396862195
curr_Factors:  [99.42051397]
mat_Sqrt:  [[0.15]]
grads:  [0.04058783]
Stock Position:  0.040587827577031214
Bond Position:  [-9.10496069]


portfolio before change:  [-5.06166389]
curr_Stock_Price:  99.63247899217622
curr_Factors:  [99.63247899]
mat_Sqrt:  [[0.15]]
grads:  [-0.05531842]
Stock Position:  -0.055318423567336544
Bond Position:  [0.44984779]


portfolio before change:  [-5.05349211]
curr_Stock_Price:  99.48526472861607
curr_Factors:  [99.48526473]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235898]
Stock Position:  -0.012358976386900792
Bond Position:  [-3.82395607]


portfolio before change:  [-5.04939126]
curr_Stock_Price:  99.13411487680912
curr_Factors:  [99.13411488]
mat_Sqrt:  [[0.15]]
grads:  [-0.04245247]
Stock Position:  -0.042452470484749365
Bond Position:  [-0.84090318]


portfolio before change:  [-5.06860532]
curr_Stock_Price:  99.58547854494913
curr_Factors:  [99.58547854]
mat_Sqrt:  [[0.15]]
grads:  [-0.07083472]
Stock Position:  -0.07083472489927589
Bond Position:  [1.98550465]


portfolio before change:  [-5.0915468]
curr_Stock_Price:  99.91110377420833
curr_Factors:  [99.91110377]
mat_Sqrt:  [[0.15]]
grads:  [0.01070811]
Stock Position:  0.01070811168761424
Bond Position:  [-6.16140606]


portfolio before change:  [-5.09577307]
curr_Stock_Price:  99.55238760751874
curr_Factors:  [99.55238761]
mat_Sqrt:  [[0.15]]
grads:  [0.0308505]
Stock Position:  0.030850495563775362
Bond Position:  [-8.16701356]


portfolio before change:  [-5.09688861]
curr_Stock_Price:  99.53277402025805
curr_Factors:  [99.53277402]
mat_Sqrt:  [[0.15]]
grads:  [0.07979108]
Stock Position:  0.07979108268641981
Bond Position:  [-13.03871642]


portfolio before change:  [-5.07319583]
curr_Stock_Price:  99.83992276062978
curr_Factors:  [99.83992276]
mat_Sqrt:  [[0.15]]
grads:  [0.08679696]
Stock Position:  0.08679696389656884
Bond Position:  [-13.738998]


portfolio before change:  [-5.09189904]
curr_Stock_Price:  99.63433378089253
curr_Factors:  [99.63433378]
mat_Sqrt:  [[0.15]]
grads:  [-0.23417494]
Stock Position:  -0.23417493756578658
Bond Position:  [18.23996485]


portfolio before change:  [-5.0028021]
curr_Stock_Price:  99.25873037432657
curr_Factors:  [99.25873037]
mat_Sqrt:  [[0.15]]
grads:  [0.06267835]
Stock Position:  0.06267835087977887
Bond Position:  [-11.22417564]


portfolio before change:  [-5.04873179]
curr_Stock_Price:  98.53713913860157
curr_Factors:  [98.53713914]
mat_Sqrt:  [[0.15]]
grads:  [-0.11702047]
Stock Position:  -0.11702047185940777
Bond Position:  [6.48213073]


portfolio before change:  [-5.12104017]
curr_Stock_Price:  99.15851358917993
curr_Factors:  [99.15851359]
mat_Sqrt:  [[0.15]]
grads:  [0.16305353]
Stock Position:  0.16305353256266486
Bond Position:  [-21.2891861]


portfolio before change:  [-5.10501031]
curr_Stock_Price:  99.26498464771471
curr_Factors:  [99.26498465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03553546]
Stock Position:  -0.03553545590382221
Bond Position:  [-1.57758382]


portfolio before change:  [-5.09111497]
curr_Stock_Price:  98.87118255347485
curr_Factors:  [98.87118255]
mat_Sqrt:  [[0.15]]
grads:  [0.01746937]
Stock Position:  0.01746937343239596
Bond Position:  [-6.81833258]


portfolio before change:  [-5.10615033]
curr_Stock_Price:  98.03490758316082
curr_Factors:  [98.03490758]
mat_Sqrt:  [[0.15]]
grads:  [0.15361341]
Stock Position:  0.15361341200548714
Bond Position:  [-20.16562698]


portfolio before change:  [-5.29429018]
curr_Stock_Price:  96.81835064231193
curr_Factors:  [96.81835064]
mat_Sqrt:  [[0.15]]
grads:  [0.02760954]
Stock Position:  0.02760954209614269
Bond Position:  [-7.96740051]


portfolio before change:  [-5.30413501]
curr_Stock_Price:  96.47981355956989
curr_Factors:  [96.47981356]
mat_Sqrt:  [[0.15]]
grads:  [0.03166123]
Stock Position:  0.031661232555821026
Bond Position:  [-8.35880483]


portfolio before change:  [-5.31356827]
curr_Stock_Price:  96.19837124181656
curr_Factors:  [96.19837124]
mat_Sqrt:  [[0.15]]
grads:  [0.06912955]
Stock Position:  0.06912954560447492
Bond Position:  [-11.96371796]


portfolio before change:  [-5.32190237]
curr_Stock_Price:  96.0886301836598
curr_Factors:  [96.08863018]
mat_Sqrt:  [[0.15]]
grads:  [-0.00191121]
Stock Position:  -0.0019112121736177684
Bond Position:  [-5.13825661]


portfolio before change:  [-5.32280354]
curr_Stock_Price:  96.39211072666977
curr_Factors:  [96.39211073]
mat_Sqrt:  [[0.15]]
grads:  [-0.07345356]
Stock Position:  -0.07345355645218161
Bond Position:  [1.75753981]


portfolio before change:  [-5.31616956]
curr_Stock_Price:  96.30329088035734
curr_Factors:  [96.30329088]
mat_Sqrt:  [[0.15]]
grads:  [0.03290181]
Stock Position:  0.03290180940471281
Bond Position:  [-8.48472208]


portfolio before change:  [-5.31469576]
curr_Stock_Price:  96.36420263349459
curr_Factors:  [96.36420263]
mat_Sqrt:  [[0.15]]
grads:  [0.01331194]
Stock Position:  0.013311936067846563
Bond Position:  [-6.59748987]


portfolio before change:  [-5.31691215]
curr_Stock_Price:  96.22868238162515
curr_Factors:  [96.22868238]
mat_Sqrt:  [[0.15]]
grads:  [0.25469575]
Stock Position:  0.25469574566974984
Bond Position:  [-29.82594817]


portfolio before change:  [-5.27649497]
curr_Stock_Price:  96.39468971505175
curr_Factors:  [96.39468972]
mat_Sqrt:  [[0.15]]
grads:  [-0.01179077]
Stock Position:  -0.011790769524022648
Bond Position:  [-4.1399274]


portfolio before change:  [-5.27626747]
curr_Stock_Price:  96.35344902589001
curr_Factors:  [96.35344903]
mat_Sqrt:  [[0.15]]
grads:  [0.01334205]
Stock Position:  0.013342052783168641
Bond Position:  [-6.56182027]


portfolio before change:  [-5.26686546]
curr_Stock_Price:  97.08887778887686
curr_Factors:  [97.08887779]
mat_Sqrt:  [[0.15]]
grads:  [0.0335154]
Stock Position:  0.033515398502949656
Bond Position:  [-8.52083789]


portfolio before change:  [-5.29263295]
curr_Stock_Price:  96.33594274104081
curr_Factors:  [96.33594274]
mat_Sqrt:  [[0.15]]
grads:  [0.02631924]
Stock Position:  0.02631923819957512
Bond Position:  [-7.82812157]


portfolio before change:  [-5.28578595]
curr_Stock_Price:  96.61468468842021
curr_Factors:  [96.61468469]
mat_Sqrt:  [[0.15]]
grads:  [0.00645974]
Stock Position:  0.006459742129967435
Bond Position:  [-5.9098919]


portfolio before change:  [-5.28698755]
curr_Stock_Price:  96.48585291123742
curr_Factors:  [96.48585291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02239523]
Stock Position:  -0.022395230981372624
Bond Position:  [-3.12616459]


portfolio before change:  [-5.31059039]
curr_Stock_Price:  97.53105082656091
curr_Factors:  [97.53105083]
mat_Sqrt:  [[0.15]]
grads:  [-0.004298]
Stock Position:  -0.004298003730061121
Bond Position:  [-4.89140157]


portfolio before change:  [-5.3101414]
curr_Stock_Price:  97.35545591146938
curr_Factors:  [97.35545591]
mat_Sqrt:  [[0.15]]
grads:  [0.01022725]
Stock Position:  0.010227249876624163
Bond Position:  [-6.30581998]


portfolio before change:  [-5.30378008]
curr_Stock_Price:  98.01598982998398
curr_Factors:  [98.01598983]
mat_Sqrt:  [[0.15]]
grads:  [0.00160497]
Stock Position:  0.00160497203390964
Bond Position:  [-5.46109301]


portfolio before change:  [-5.30355841]
curr_Stock_Price:  98.36677884990267
curr_Factors:  [98.36677885]
mat_Sqrt:  [[0.15]]
grads:  [0.00292401]
Stock Position:  0.002924006001061719
Bond Position:  [-5.59118346]


portfolio before change:  [-5.30510956]
curr_Stock_Price:  97.9558050274708
curr_Factors:  [97.95580503]
mat_Sqrt:  [[0.15]]
grads:  [0.01344669]
Stock Position:  0.01344668901975039
Bond Position:  [-6.6222908]


portfolio before change:  [-5.31156409]
curr_Stock_Price:  97.50657724456566
curr_Factors:  [97.50657724]
mat_Sqrt:  [[0.15]]
grads:  [0.07798639]
Stock Position:  0.0779863878203526
Bond Position:  [-12.91574984]


portfolio before change:  [-5.28261317]
curr_Stock_Price:  97.8881589620374
curr_Factors:  [97.88815896]
mat_Sqrt:  [[0.15]]
grads:  [-0.12077155]
Stock Position:  -0.12077155325364751
Bond Position:  [6.53949184]


portfolio before change:  [-5.36672381]
curr_Stock_Price:  98.58798742792317
curr_Factors:  [98.58798743]
mat_Sqrt:  [[0.15]]
grads:  [-0.08576608]
Stock Position:  -0.08576607956222541
Bond Position:  [3.08878137]


portfolio before change:  [-5.34099457]
curr_Stock_Price:  98.2902452569564
curr_Factors:  [98.29024526]
mat_Sqrt:  [[0.15]]
grads:  [-0.0251361]
Stock Position:  -0.02513609613589848
Bond Position:  [-2.87036152]


portfolio before change:  [-5.35337115]
curr_Stock_Price:  98.77549062298259
curr_Factors:  [98.77549062]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317759]
Stock Position:  -0.03317758525040053
Bond Position:  [-2.07623889]


portfolio before change:  [-5.37184935]
curr_Stock_Price:  99.32852767990163
curr_Factors:  [99.32852768]
mat_Sqrt:  [[0.15]]
grads:  [0.15362906]
Stock Position:  0.15362906251294353
Bond Position:  [-20.63159794]


portfolio before change:  [-5.30351941]
curr_Stock_Price:  99.7816936077726
curr_Factors:  [99.78169361]
mat_Sqrt:  [[0.15]]
grads:  [-0.05842122]
Stock Position:  -0.058421224274308646
Bond Position:  [0.52584929]


portfolio before change:  [-5.28011952]
curr_Stock_Price:  99.38171872639725
curr_Factors:  [99.38171873]
mat_Sqrt:  [[0.15]]
grads:  [0.0403167]
Stock Position:  0.0403166970485161
Bond Position:  [-9.28686217]


portfolio before change:  [-5.31103614]
curr_Stock_Price:  98.62927190280217
curr_Factors:  [98.6292719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262012]
Stock Position:  -0.04262011587320026
Bond Position:  [-1.10744514]


portfolio before change:  [-5.32844834]
curr_Stock_Price:  99.03619203437894
curr_Factors:  [99.03619203]
mat_Sqrt:  [[0.15]]
grads:  [0.07178193]
Stock Position:  0.07178192931691428
Bond Position:  [-12.43745728]


portfolio before change:  [-5.33118987]
curr_Stock_Price:  99.00882906303345
curr_Factors:  [99.00882906]
mat_Sqrt:  [[0.15]]
grads:  [-0.03250842]
Stock Position:  -0.032508416973577606
Bond Position:  [-2.11256958]


portfolio before change:  [-5.30838055]
curr_Stock_Price:  98.30312366905517
curr_Factors:  [98.30312367]
mat_Sqrt:  [[0.15]]
grads:  [0.04942412]
Stock Position:  0.04942412081733587
Bond Position:  [-10.16692601]


portfolio before change:  [-5.30328651]
curr_Stock_Price:  98.41904862791081
curr_Factors:  [98.41904863]
mat_Sqrt:  [[0.15]]
grads:  [-0.10905411]
Stock Position:  -0.10905410666802433
Bond Position:  [5.42971491]


portfolio before change:  [-5.38305683]
curr_Stock_Price:  99.1536352020936
curr_Factors:  [99.1536352]
mat_Sqrt:  [[0.15]]
grads:  [-0.03208749]
Stock Position:  -0.032087485287405584
Bond Position:  [-2.20146602]


portfolio before change:  [-5.38759374]
curr_Stock_Price:  99.29073901729379
curr_Factors:  [99.29073902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335161]
Stock Position:  -0.023351612621336372
Bond Position:  [-3.06899487]


portfolio before change:  [-5.36858396]
curr_Stock_Price:  98.46845775090878
curr_Factors:  [98.46845775]
mat_Sqrt:  [[0.15]]
grads:  [0.00927535]
Stock Position:  0.009275354261271589
Bond Position:  [-6.28191379]


portfolio before change:  [-5.36777749]
curr_Stock_Price:  98.59773678842167
curr_Factors:  [98.59773679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36777749]
Stock Price:  98.30281375147572
PL:  [-5.36777749]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.17475110e-04]
 [ 1.83926688e-03]
 [-3.13183673e-03]
 [ 6.94839074e-03]
 [ 6.24754906e-03]
 [ 2.58937173e-02]
 [ 1.44366934e-03]
 [-1.63930014e-02]
 [ 2.32195337e-02]
 [-4.52075921e-03]
 [ 3.10906977e-02]
 [-4.77104372e-02]
 [ 3.53390374e-02]
 [ 3.96362104e-03]
 [-6.89966884e-03]
 [ 2.77995432e-02]
 [ 1.32390177e-02]
 [-4.29513523e-03]
 [ 9.52030699e-03]
 [-6.65513069e-03]
 [ 1.38137470e-02]
 [-4.09971017e-03]
 [ 9.79923075e-03]
 [ 2.92990024e-02]
 [-2.24022378e-03]
 [ 1.38460614e-02]
 [-7.06760054e-03]
 [ 5.64054335e-03]
 [ 1.59231260e-03]
 [-2.15090776e-03]
 [-1.51678859e-03]
 [-1.15029178e-02]
 [ 4.71917200e-03]
 [ 7.17145566e-03]
 [ 1.14774116e-02]
 [ 8.98858523e-03]
 [-3.37723571e-02]
 [ 9.60917202e-03]
 [ 4.25878700e-03]
 [ 1.71779392e-02]
 [-5.69565747e-03]
 [-1.81418068e-02]
 [ 2.28707437e-02]
 [ 2.41633817e-03]
 [-7.62494454e-03]
 [-7.25057116e-03]
 [ 9.77019150e-03]
 [-9.98575042e-03]
 [-1.41148779e-02]
 [-7.48148919e-03]
 [ 4.33585290e-02]
 [-8.95768896e-03]
 [ 2.81493020e-03]
 [ 5.42279384e-03]
 [ 5.74132619e-03]
 [-3.44294476e-03]
 [ 8.04332492e-03]
 [-6.84009648e-04]
 [ 1.52834999e-03]
 [-3.93715877e-03]
 [-3.47220630e-04]
 [ 4.81013586e-03]
 [ 1.16695754e-02]
 [-1.82970370e-02]
 [-1.12191125e-02]
 [-8.24501333e-03]
 [-4.73041670e-03]
 [ 1.73796412e-02]
 [-9.81161496e-03]
 [ 6.41433723e-03]
 [-6.22126105e-03]
 [ 1.07699633e-02]
 [-5.90160071e-03]
 [ 9.32000411e-03]
 [-1.83854885e-02]
 [-4.28100831e-03]
 [-2.61224294e-03]
 [ 2.48024102e-04]
 [-1.02268820e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.92985885]
curr_Stock_Price:  100.64298513683745
curr_Factors:  [100.64298514]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021165]
Stock Position:  -0.0021165007335089527
Bond Position:  [12.1428698]


portfolio before change:  [11.9321431]
curr_Stock_Price:  99.9223153200104
curr_Factors:  [99.92231532]
mat_Sqrt:  [[0.15]]
grads:  [0.01226178]
Stock Position:  0.01226177920039732
Bond Position:  [10.70691773]


portfolio before change:  [11.94204028]
curr_Stock_Price:  100.67489551816259
curr_Factors:  [100.67489552]
mat_Sqrt:  [[0.15]]
grads:  [-0.02087891]
Stock Position:  -0.020878911512459682
Bond Position:  [14.04402251]


portfolio before change:  [11.94953414]
curr_Stock_Price:  100.3580166435215
curr_Factors:  [100.35801664]
mat_Sqrt:  [[0.15]]
grads:  [0.0463226]
Stock Position:  0.046322604919543965
Bond Position:  [7.30068938]


portfolio before change:  [11.96494748]
curr_Stock_Price:  100.68090507293009
curr_Factors:  [100.68090507]
mat_Sqrt:  [[0.15]]
grads:  [0.04165033]
Stock Position:  0.041650327080936224
Bond Position:  [7.77155485]


portfolio before change:  [11.94845896]
curr_Stock_Price:  100.27336302227522
curr_Factors:  [100.27336302]
mat_Sqrt:  [[0.15]]
grads:  [0.17262478]
Stock Position:  0.17262478193791883
Bond Position:  [-5.36120847]


portfolio before change:  [12.09490608]
curr_Stock_Price:  101.12365929684984
curr_Factors:  [101.1236593]
mat_Sqrt:  [[0.15]]
grads:  [0.00962446]
Stock Position:  0.00962446227855741
Bond Position:  [11.12164524]


portfolio before change:  [12.08639395]
curr_Stock_Price:  100.16700739776788
curr_Factors:  [100.1670074]
mat_Sqrt:  [[0.15]]
grads:  [-0.10928668]
Stock Position:  -0.10928667601131467
Bond Position:  [23.03331323]


portfolio before change:  [11.98009959]
curr_Stock_Price:  101.15279982704729
curr_Factors:  [101.15279983]
mat_Sqrt:  [[0.15]]
grads:  [0.15479689]
Stock Position:  0.1547968915215725
Bond Position:  [-3.67803939]


portfolio before change:  [12.0157405]
curr_Stock_Price:  101.3845279487814
curr_Factors:  [101.38452795]
mat_Sqrt:  [[0.15]]
grads:  [-0.03013839]
Stock Position:  -0.030138394710410958
Bond Position:  [15.07130742]


portfolio before change:  [12.00150711]
curr_Stock_Price:  101.88805117810843
curr_Factors:  [101.88805118]
mat_Sqrt:  [[0.15]]
grads:  [0.20727132]
Stock Position:  0.20727131812044744
Bond Position:  [-9.11696356]


portfolio before change:  [11.98589692]
curr_Stock_Price:  101.81548755946892
curr_Factors:  [101.81548756]
mat_Sqrt:  [[0.15]]
grads:  [-0.31806958]
Stock Position:  -0.3180695812993087
Bond Position:  [44.37030642]


portfolio before change:  [12.16332196]
curr_Stock_Price:  101.26638819461998
curr_Factors:  [101.26638819]
mat_Sqrt:  [[0.15]]
grads:  [0.23559358]
Stock Position:  0.23559358259236335
Bond Position:  [-11.69438923]


portfolio before change:  [12.19040691]
curr_Stock_Price:  101.38445538483849
curr_Factors:  [101.38445538]
mat_Sqrt:  [[0.15]]
grads:  [0.02642414]
Stock Position:  0.026424140289530273
Bond Position:  [9.51140984]


portfolio before change:  [12.20861459]
curr_Stock_Price:  102.05101265643589
curr_Factors:  [102.05101266]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599779]
Stock Position:  -0.04599779226897815
Bond Position:  [16.90273587]


portfolio before change:  [12.18058387]
curr_Stock_Price:  102.6833728803782
curr_Factors:  [102.68337288]
mat_Sqrt:  [[0.15]]
grads:  [0.18533029]
Stock Position:  0.1853302881546928
Bond Position:  [-6.84975521]


portfolio before change:  [12.31066659]
curr_Stock_Price:  103.38757963797104
curr_Factors:  [103.38757964]
mat_Sqrt:  [[0.15]]
grads:  [0.08826012]
Stock Position:  0.08826011811545523
Bond Position:  [3.1856666]


portfolio before change:  [12.31175806]
curr_Stock_Price:  103.39769017790256
curr_Factors:  [103.39769018]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863423]
Stock Position:  -0.02863423487609876
Bond Position:  [15.27247181]


portfolio before change:  [12.31252131]
curr_Stock_Price:  103.40437141057437
curr_Factors:  [103.40437141]
mat_Sqrt:  [[0.15]]
grads:  [0.06346871]
Stock Position:  0.06346871324501539
Bond Position:  [5.74957891]


portfolio before change:  [12.27928114]
curr_Stock_Price:  102.87498413819343
curr_Factors:  [102.87498414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04436754]
Stock Position:  -0.044367537908417
Bond Position:  [16.8435909]


portfolio before change:  [12.32696408]
curr_Stock_Price:  101.82398638476143
curr_Factors:  [101.82398638]
mat_Sqrt:  [[0.15]]
grads:  [0.09209165]
Stock Position:  0.09209164662051932
Bond Position:  [2.94982551]


portfolio before change:  [12.32901359]
curr_Stock_Price:  101.84423947869023
curr_Factors:  [101.84423948]
mat_Sqrt:  [[0.15]]
grads:  [-0.0273314]
Stock Position:  -0.027331401135169676
Bond Position:  [15.11255935]


portfolio before change:  [12.33545838]
curr_Stock_Price:  101.64299736432723
curr_Factors:  [101.64299736]
mat_Sqrt:  [[0.15]]
grads:  [0.0653282]
Stock Position:  0.06532820497304562
Bond Position:  [5.69530382]


portfolio before change:  [12.28081042]
curr_Stock_Price:  100.8010343729653
curr_Factors:  [100.80103437]
mat_Sqrt:  [[0.15]]
grads:  [0.19532668]
Stock Position:  0.19532668269658462
Bond Position:  [-7.40832124]


portfolio before change:  [12.14955827]
curr_Stock_Price:  100.13144275124337
curr_Factors:  [100.13144275]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493483]
Stock Position:  -0.014934825225554605
Bond Position:  [13.64500387]


portfolio before change:  [12.14886493]
curr_Stock_Price:  100.2349713029459
curr_Factors:  [100.2349713]
mat_Sqrt:  [[0.15]]
grads:  [0.09230708]
Stock Position:  0.09230707567780269
Bond Position:  [2.89646785]


portfolio before change:  [12.14227803]
curr_Stock_Price:  100.16165148302798
curr_Factors:  [100.16165148]
mat_Sqrt:  [[0.15]]
grads:  [-0.04711734]
Stock Position:  -0.047117336962762636
Bond Position:  [16.86162831]


portfolio before change:  [12.16126543]
curr_Stock_Price:  99.78103740990666
curr_Factors:  [99.78103741]
mat_Sqrt:  [[0.15]]
grads:  [0.03760362]
Stock Position:  0.03760362233972236
Bond Position:  [8.40913699]


portfolio before change:  [12.17932223]
curr_Stock_Price:  100.24724800915705
curr_Factors:  [100.24724801]
mat_Sqrt:  [[0.15]]
grads:  [0.01061542]
Stock Position:  0.010615417337621868
Bond Position:  [11.11515586]


portfolio before change:  [12.17394254]
curr_Stock_Price:  99.67502296917525
curr_Factors:  [99.67502297]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433939]
Stock Position:  -0.014339385043134156
Bond Position:  [13.60322107]


portfolio before change:  [12.17597877]
curr_Stock_Price:  99.59231348197723
curr_Factors:  [99.59231348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011192]
Stock Position:  -0.01011192396263229
Bond Position:  [13.18304867]


portfolio before change:  [12.17226802]
curr_Stock_Price:  100.0407662815383
curr_Factors:  [100.04076628]
mat_Sqrt:  [[0.15]]
grads:  [-0.07668612]
Stock Position:  -0.07668611897993649
Bond Position:  [19.84400612]


portfolio before change:  [12.14770357]
curr_Stock_Price:  100.37726440584373
curr_Factors:  [100.37726441]
mat_Sqrt:  [[0.15]]
grads:  [0.03146115]
Stock Position:  0.031461146699861685
Bond Position:  [8.98971973]


portfolio before change:  [12.16277422]
curr_Stock_Price:  100.83842931888015
curr_Factors:  [100.83842932]
mat_Sqrt:  [[0.15]]
grads:  [0.0478097]
Stock Position:  0.04780970440516344
Bond Position:  [7.34171873]


portfolio before change:  [12.17284618]
curr_Stock_Price:  101.03949898431338
curr_Factors:  [101.03949898]
mat_Sqrt:  [[0.15]]
grads:  [0.07651608]
Stock Position:  0.07651607725731006
Bond Position:  [4.44170007]


portfolio before change:  [12.17671269]
curr_Stock_Price:  101.08640279435636
curr_Factors:  [101.08640279]
mat_Sqrt:  [[0.15]]
grads:  [0.0599239]
Stock Position:  0.05992390151473383
Bond Position:  [6.11922104]


portfolio before change:  [12.20827008]
curr_Stock_Price:  101.60664482230393
curr_Factors:  [101.60664482]
mat_Sqrt:  [[0.15]]
grads:  [-0.22514905]
Stock Position:  -0.22514904738414745
Bond Position:  [35.08490937]


portfolio before change:  [12.22835926]
curr_Stock_Price:  101.52715835169835
curr_Factors:  [101.52715835]
mat_Sqrt:  [[0.15]]
grads:  [0.06406115]
Stock Position:  0.06406114681394738
Bond Position:  [5.72441306]


portfolio before change:  [12.23813412]
curr_Stock_Price:  101.67415967078243
curr_Factors:  [101.67415967]
mat_Sqrt:  [[0.15]]
grads:  [0.02839191]
Stock Position:  0.028391913363769682
Bond Position:  [9.35141019]


portfolio before change:  [12.23061299]
curr_Stock_Price:  101.38866947276402
curr_Factors:  [101.38866947]
mat_Sqrt:  [[0.15]]
grads:  [0.11451959]
Stock Position:  0.11451959455593061
Bond Position:  [0.61962367]


portfolio before change:  [12.21712824]
curr_Stock_Price:  101.27058068135831
curr_Factors:  [101.27058068]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797105]
Stock Position:  -0.037971049772448535
Bond Position:  [16.0624785]


portfolio before change:  [12.2176587]
curr_Stock_Price:  101.2830499033816
curr_Factors:  [101.2830499]
mat_Sqrt:  [[0.15]]
grads:  [-0.12094538]
Stock Position:  -0.12094537879678831
Bond Position:  [24.46737554]


portfolio before change:  [12.26117043]
curr_Stock_Price:  100.93593063606862
curr_Factors:  [100.93593064]
mat_Sqrt:  [[0.15]]
grads:  [0.15247162]
Stock Position:  0.1524716247611476
Bond Position:  [-3.12869491]


portfolio before change:  [12.28448133]
curr_Stock_Price:  101.09009994481364
curr_Factors:  [101.09009994]
mat_Sqrt:  [[0.15]]
grads:  [0.01610892]
Stock Position:  0.016108921142539458
Bond Position:  [10.65602888]


portfolio before change:  [12.27715182]
curr_Stock_Price:  100.5937583441748
curr_Factors:  [100.59375834]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083296]
Stock Position:  -0.050832963576421135
Bond Position:  [17.39063068]


portfolio before change:  [12.22066811]
curr_Stock_Price:  101.7263042922108
curr_Factors:  [101.72630429]
mat_Sqrt:  [[0.15]]
grads:  [-0.04833714]
Stock Position:  -0.048337141094027224
Bond Position:  [17.13782683]


portfolio before change:  [12.26766084]
curr_Stock_Price:  100.77627730447462
curr_Factors:  [100.7762773]
mat_Sqrt:  [[0.15]]
grads:  [0.06513461]
Stock Position:  0.06513461000052538
Bond Position:  [5.70363732]


portfolio before change:  [12.25180343]
curr_Stock_Price:  100.52734816177671
curr_Factors:  [100.52734816]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657167]
Stock Position:  -0.06657166944343834
Bond Position:  [18.94407682]


portfolio before change:  [12.30248616]
curr_Stock_Price:  99.78380824504495
curr_Factors:  [99.78380825]
mat_Sqrt:  [[0.15]]
grads:  [-0.09409919]
Stock Position:  -0.09409918605421648
Bond Position:  [21.6920613]


portfolio before change:  [12.23440339]
curr_Stock_Price:  100.5217377683389
curr_Factors:  [100.52173777]
mat_Sqrt:  [[0.15]]
grads:  [-0.04987659]
Stock Position:  -0.04987659458904995
Bond Position:  [17.24808535]


portfolio before change:  [12.25498411]
curr_Stock_Price:  100.13071902157148
curr_Factors:  [100.13071902]
mat_Sqrt:  [[0.15]]
grads:  [0.28905686]
Stock Position:  0.2890568598800695
Bond Position:  [-16.6884871]


portfolio before change:  [12.04326177]
curr_Stock_Price:  99.40186836918012
curr_Factors:  [99.40186837]
mat_Sqrt:  [[0.15]]
grads:  [-0.05971793]
Stock Position:  -0.059717926423934475
Bond Position:  [17.97933523]


portfolio before change:  [12.02170849]
curr_Stock_Price:  99.7816039908948
curr_Factors:  [99.78160399]
mat_Sqrt:  [[0.15]]
grads:  [0.0187662]
Stock Position:  0.018766201360690956
Bond Position:  [10.14918682]


portfolio before change:  [12.023055]
curr_Stock_Price:  99.81955361739644
curr_Factors:  [99.81955362]
mat_Sqrt:  [[0.15]]
grads:  [0.03615196]
Stock Position:  0.036151958911105404
Bond Position:  [8.4143826]


portfolio before change:  [12.01067452]
curr_Stock_Price:  99.46254933263958
curr_Factors:  [99.46254933]
mat_Sqrt:  [[0.15]]
grads:  [0.03827551]
Stock Position:  0.03827550792044751
Bond Position:  [8.20369492]


portfolio before change:  [12.00520847]
curr_Stock_Price:  99.30634516699278
curr_Factors:  [99.30634517]
mat_Sqrt:  [[0.15]]
grads:  [-0.02295297]
Stock Position:  -0.022952965083110472
Bond Position:  [14.28458354]


portfolio before change:  [12.02908595]
curr_Stock_Price:  98.3049639638946
curr_Factors:  [98.30496396]
mat_Sqrt:  [[0.15]]
grads:  [0.05362217]
Stock Position:  0.05362216610715354
Bond Position:  [6.75776084]


portfolio before change:  [12.00732067]
curr_Stock_Price:  97.8911863133307
curr_Factors:  [97.89118631]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456006]
Stock Position:  -0.004560064319700895
Bond Position:  [12.45371078]


portfolio before change:  [12.00882148]
curr_Stock_Price:  97.7327618156058
curr_Factors:  [97.73276182]
mat_Sqrt:  [[0.15]]
grads:  [0.010189]
Stock Position:  0.010188999904633917
Bond Position:  [11.01302238]


portfolio before change:  [12.00669116]
curr_Stock_Price:  97.45612530886262
curr_Factors:  [97.45612531]
mat_Sqrt:  [[0.15]]
grads:  [-0.02624773]
Stock Position:  -0.02624772515606664
Bond Position:  [14.56469276]


portfolio before change:  [11.99278661]
curr_Stock_Price:  98.0205503288061
curr_Factors:  [98.02055033]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023148]
Stock Position:  -0.002314804200946024
Bond Position:  [12.21968499]


portfolio before change:  [11.99487808]
curr_Stock_Price:  97.4469760072188
curr_Factors:  [97.44697601]
mat_Sqrt:  [[0.15]]
grads:  [0.03206757]
Stock Position:  0.03206757242498949
Bond Position:  [8.86999012]


portfolio before change:  [11.99752327]
curr_Stock_Price:  97.5121757275008
curr_Factors:  [97.51217573]
mat_Sqrt:  [[0.15]]
grads:  [0.07779717]
Stock Position:  0.07779716902066357
Bond Position:  [4.41135205]


portfolio before change:  [12.00752079]
curr_Stock_Price:  97.63713916759346
curr_Factors:  [97.63713917]
mat_Sqrt:  [[0.15]]
grads:  [-0.12198025]
Stock Position:  -0.12198024674074051
Bond Position:  [23.91732311]


portfolio before change:  [11.94483585]
curr_Stock_Price:  98.16328845618783
curr_Factors:  [98.16328846]
mat_Sqrt:  [[0.15]]
grads:  [-0.07479408]
Stock Position:  -0.07479408322105172
Bond Position:  [19.28686901]


portfolio before change:  [12.00018758]
curr_Stock_Price:  97.43935056771276
curr_Factors:  [97.43935057]
mat_Sqrt:  [[0.15]]
grads:  [-0.05496676]
Stock Position:  -0.054966755542504346
Bond Position:  [17.35611255]


portfolio before change:  [12.03156526]
curr_Stock_Price:  96.88823764171389
curr_Factors:  [96.88823764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03153611]
Stock Position:  -0.03153611134339644
Bond Position:  [15.08704351]


portfolio before change:  [12.01484117]
curr_Stock_Price:  97.44845468435622
curr_Factors:  [97.44845468]
mat_Sqrt:  [[0.15]]
grads:  [0.11586427]
Stock Position:  0.11586427435705036
Bond Position:  [0.72404668]


portfolio before change:  [12.10461714]
curr_Stock_Price:  98.22290150966316
curr_Factors:  [98.22290151]
mat_Sqrt:  [[0.15]]
grads:  [-0.06541077]
Stock Position:  -0.06541076638674148
Bond Position:  [18.52945241]


portfolio before change:  [12.09993431]
curr_Stock_Price:  98.31219804877348
curr_Factors:  [98.31219805]
mat_Sqrt:  [[0.15]]
grads:  [0.04276225]
Stock Position:  0.042762248177420255
Bond Position:  [7.8958837]


portfolio before change:  [12.10341514]
curr_Stock_Price:  98.38205691162044
curr_Factors:  [98.38205691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04147507]
Stock Position:  -0.041475073675313584
Bond Position:  [16.1838182]


portfolio before change:  [12.07181464]
curr_Stock_Price:  99.16836119559346
curr_Factors:  [99.1683612]
mat_Sqrt:  [[0.15]]
grads:  [0.07179976]
Stock Position:  0.07179975503310101
Bond Position:  [4.95155059]


portfolio before change:  [12.08574134]
curr_Stock_Price:  99.35801671112009
curr_Factors:  [99.35801671]
mat_Sqrt:  [[0.15]]
grads:  [-0.039344]
Stock Position:  -0.0393440047496082
Bond Position:  [15.99488362]


portfolio before change:  [12.09379432]
curr_Stock_Price:  99.17874481202439
curr_Factors:  [99.17874481]
mat_Sqrt:  [[0.15]]
grads:  [0.06213336]
Stock Position:  0.062133360754938124
Bond Position:  [5.93148559]


portfolio before change:  [12.07027849]
curr_Stock_Price:  98.79430463525931
curr_Factors:  [98.79430464]
mat_Sqrt:  [[0.15]]
grads:  [-0.12256992]
Stock Position:  -0.12256992304790687
Bond Position:  [24.17948881]


portfolio before change:  [11.9939463]
curr_Stock_Price:  99.42939894521228
curr_Factors:  [99.42939895]
mat_Sqrt:  [[0.15]]
grads:  [-0.02854006]
Stock Position:  -0.028540055425787105
Bond Position:  [14.83166685]


portfolio before change:  [12.0041784]
curr_Stock_Price:  99.10336267619422
curr_Factors:  [99.10336268]
mat_Sqrt:  [[0.15]]
grads:  [-0.01741495]
Stock Position:  -0.017414952935188455
Bond Position:  [13.73005879]


portfolio before change:  [12.01068383]
curr_Stock_Price:  98.77908518124369
curr_Factors:  [98.77908518]
mat_Sqrt:  [[0.15]]
grads:  [0.00165349]
Stock Position:  0.0016534940136326396
Bond Position:  [11.8473532]


portfolio before change:  [12.01043904]
curr_Stock_Price:  98.18321085498971
curr_Factors:  [98.18321085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.01043904]
Stock Price:  97.85636814411811
PL:  [12.01043904]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.31824807e-04]
 [ 1.46566540e-03]
 [-4.07254916e-04]
 [ 5.18544287e-03]
 [ 3.49293112e-03]
 [ 2.26094511e-02]
 [ 1.28700472e-03]
 [-1.84421502e-02]
 [ 5.17121191e-03]
 [ 1.89661080e-02]
 [ 1.49322909e-02]
 [ 1.30584499e-02]
 [-1.44723695e-02]
 [ 1.21767852e-02]
 [-6.96403502e-03]
 [ 1.00173861e-02]
 [ 8.51920360e-03]
 [-1.37475121e-03]
 [ 1.76973437e-03]
 [ 8.30520803e-03]
 [ 1.25594520e-02]
 [-9.48938903e-03]
 [ 6.25951963e-03]
 [ 1.03708720e-02]
 [-8.12277891e-03]
 [-7.52546366e-03]
 [-3.03802004e-03]
 [ 8.85287929e-03]
 [-1.91779173e-02]
 [ 1.22648019e-03]
 [ 2.46924498e-03]
 [-1.00630147e-02]
 [-8.98944560e-03]
 [ 4.94599448e-03]
 [ 1.27431412e-02]
 [ 1.49171404e-02]
 [-3.47001149e-02]
 [ 8.82416501e-03]
 [-1.70060842e-02]
 [ 2.45134139e-02]
 [-6.09761030e-03]
 [ 2.02744050e-05]
 [ 2.36347929e-02]
 [ 3.91902109e-03]
 [-8.12603899e-03]
 [-5.85848546e-03]
 [ 1.21109740e-03]
 [-1.23746858e-02]
 [-1.13830021e-02]
 [-6.16466078e-03]
 [ 4.76970013e-02]
 [-9.05375451e-03]
 [ 2.53931261e-03]
 [ 5.35072975e-03]
 [ 5.17848950e-03]
 [-3.11228311e-03]
 [ 6.74796037e-03]
 [-1.25448609e-04]
 [ 1.54966838e-03]
 [ 1.89851285e-03]
 [ 3.75775935e-04]
 [ 7.42517259e-04]
 [ 1.16031488e-02]
 [-1.78237814e-02]
 [-1.25326405e-02]
 [-4.35780473e-04]
 [-5.01296330e-03]
 [ 2.30077068e-02]
 [-9.70580188e-03]
 [ 6.04153327e-03]
 [-6.40203441e-03]
 [ 1.13530036e-02]
 [-1.61477535e-03]
 [ 5.64341787e-03]
 [-1.57279497e-02]
 [-6.91662442e-03]
 [-3.55659679e-03]
 [-1.94678535e-03]
 [-2.29006727e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.76693301]
curr_Stock_Price:  100.43731601436832
curr_Factors:  [100.43731601]
mat_Sqrt:  [[0.15]]
grads:  [-0.0015455]
Stock Position:  -0.0015454987159520927
Bond Position:  [8.92215876]


portfolio before change:  [8.76837063]
curr_Stock_Price:  99.86793993970674
curr_Factors:  [99.86793994]
mat_Sqrt:  [[0.15]]
grads:  [0.0097711]
Stock Position:  0.00977110266084157
Bond Position:  [7.79255074]


portfolio before change:  [8.77235532]
curr_Stock_Price:  100.2258970820478
curr_Factors:  [100.22589708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271503]
Stock Position:  -0.0027150327727424803
Bond Position:  [9.04447192]


portfolio before change:  [8.771378]
curr_Stock_Price:  100.79407495436573
curr_Factors:  [100.79407495]
mat_Sqrt:  [[0.15]]
grads:  [0.03456962]
Stock Position:  0.034569619116778964
Bond Position:  [5.28696522]


portfolio before change:  [8.75859095]
curr_Stock_Price:  100.4146235492581
curr_Factors:  [100.41462355]
mat_Sqrt:  [[0.15]]
grads:  [0.02328621]
Stock Position:  0.02328620748390127
Bond Position:  [6.42031519]


portfolio before change:  [8.74340064]
curr_Stock_Price:  99.74506013490682
curr_Factors:  [99.74506013]
mat_Sqrt:  [[0.15]]
grads:  [0.15072967]
Stock Position:  0.15072967429341902
Bond Position:  [-6.29113979]


portfolio before change:  [8.77532752]
curr_Stock_Price:  99.95948433029892
curr_Factors:  [99.95948433]
mat_Sqrt:  [[0.15]]
grads:  [0.00858003]
Stock Position:  0.008580031441488148
Bond Position:  [7.917672]


portfolio before change:  [8.77337484]
curr_Stock_Price:  99.67422296082815
curr_Factors:  [99.67422296]
mat_Sqrt:  [[0.15]]
grads:  [-0.12294767]
Stock Position:  -0.122947667680295
Bond Position:  [21.02808808]


portfolio before change:  [8.84606158]
curr_Stock_Price:  99.0937122427948
curr_Factors:  [99.09371224]
mat_Sqrt:  [[0.15]]
grads:  [0.03447475]
Stock Position:  0.03447474605336101
Bond Position:  [5.42983101]


portfolio before change:  [8.85259649]
curr_Stock_Price:  99.27342462682373
curr_Factors:  [99.27342463]
mat_Sqrt:  [[0.15]]
grads:  [0.12644072]
Stock Position:  0.12644071981391503
Bond Position:  [-3.69960678]


portfolio before change:  [8.84542358]
curr_Stock_Price:  99.2185239730494
curr_Factors:  [99.21852397]
mat_Sqrt:  [[0.15]]
grads:  [0.09954861]
Stock Position:  0.09954860568836581
Bond Position:  [-1.03164214]


portfolio before change:  [8.85558293]
curr_Stock_Price:  99.32122583114092
curr_Factors:  [99.32122583]
mat_Sqrt:  [[0.15]]
grads:  [0.08705633]
Stock Position:  0.08705633239998431
Bond Position:  [0.20904128]


portfolio before change:  [8.7832064]
curr_Stock_Price:  98.48970002369825
curr_Factors:  [98.48970002]
mat_Sqrt:  [[0.15]]
grads:  [-0.09648246]
Stock Position:  -0.09648246317156399
Bond Position:  [18.28573526]


portfolio before change:  [8.70582669]
curr_Stock_Price:  99.30355373258361
curr_Factors:  [99.30355373]
mat_Sqrt:  [[0.15]]
grads:  [0.08117857]
Stock Position:  0.0811785680398657
Bond Position:  [0.64450639]


portfolio before change:  [8.65714141]
curr_Stock_Price:  98.70332684891902
curr_Factors:  [98.70332685]
mat_Sqrt:  [[0.15]]
grads:  [-0.0464269]
Stock Position:  -0.04642690012961827
Bond Position:  [13.23963091]


portfolio before change:  [8.71039691]
curr_Stock_Price:  97.57406793295353
curr_Factors:  [97.57406793]
mat_Sqrt:  [[0.15]]
grads:  [0.06678257]
Stock Position:  0.06678257383000992
Bond Position:  [2.19414951]


portfolio before change:  [8.75630093]
curr_Stock_Price:  98.25937974053242
curr_Factors:  [98.25937974]
mat_Sqrt:  [[0.15]]
grads:  [0.05679469]
Stock Position:  0.05679469066875743
Bond Position:  [3.17568985]


portfolio before change:  [8.71908203]
curr_Stock_Price:  97.60056131295678
curr_Factors:  [97.60056131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00916501]
Stock Position:  -0.009165008096698839
Bond Position:  [9.61359196]


portfolio before change:  [8.71591626]
curr_Stock_Price:  98.01154166670878
curr_Factors:  [98.01154167]
mat_Sqrt:  [[0.15]]
grads:  [0.01179823]
Stock Position:  0.011798229149572024
Bond Position:  [7.55955363]


portfolio before change:  [8.70685255]
curr_Stock_Price:  97.2032685816956
curr_Factors:  [97.20326858]
mat_Sqrt:  [[0.15]]
grads:  [0.05536805]
Stock Position:  0.055368053522686714
Bond Position:  [3.32489678]


portfolio before change:  [8.7239403]
curr_Stock_Price:  97.50813624706993
curr_Factors:  [97.50813625]
mat_Sqrt:  [[0.15]]
grads:  [0.08372968]
Stock Position:  0.08372968005484416
Bond Position:  [0.55961525]


portfolio before change:  [8.76498054]
curr_Stock_Price:  97.99787017255963
curr_Factors:  [97.99787017]
mat_Sqrt:  [[0.15]]
grads:  [-0.06326259]
Stock Position:  -0.06326259351777072
Bond Position:  [14.96457996]


portfolio before change:  [8.75910562]
curr_Stock_Price:  98.10552044102651
curr_Factors:  [98.10552044]
mat_Sqrt:  [[0.15]]
grads:  [0.04173013]
Stock Position:  0.04173013084605346
Bond Position:  [4.66514941]


portfolio before change:  [8.78168258]
curr_Stock_Price:  98.63955609581075
curr_Factors:  [98.6395561]
mat_Sqrt:  [[0.15]]
grads:  [0.06913915]
Stock Position:  0.06913914654126932
Bond Position:  [1.96182785]


portfolio before change:  [8.76849129]
curr_Stock_Price:  98.44698935148396
curr_Factors:  [98.44698935]
mat_Sqrt:  [[0.15]]
grads:  [-0.05415186]
Stock Position:  -0.05415185941524911
Bond Position:  [14.09957882]


portfolio before change:  [8.81258166]
curr_Stock_Price:  97.64906452729392
curr_Factors:  [97.64906453]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016976]
Stock Position:  -0.050169757749410744
Bond Position:  [13.71161157]


portfolio before change:  [8.7986235]
curr_Stock_Price:  97.94436515189926
curr_Factors:  [97.94436515]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025347]
Stock Position:  -0.02025346692051225
Bond Position:  [10.78233646]


portfolio before change:  [8.80531597]
curr_Stock_Price:  97.64720377215185
curr_Factors:  [97.64720377]
mat_Sqrt:  [[0.15]]
grads:  [0.0590192]
Stock Position:  0.059019195258128376
Bond Position:  [3.04225658]


portfolio before change:  [8.82973696]
curr_Stock_Price:  98.05776255179357
curr_Factors:  [98.05776255]
mat_Sqrt:  [[0.15]]
grads:  [-0.12785278]
Stock Position:  -0.12785278189418064
Bond Position:  [21.36669469]


portfolio before change:  [8.86636517]
curr_Stock_Price:  97.78172049366238
curr_Factors:  [97.78172049]
mat_Sqrt:  [[0.15]]
grads:  [0.00817653]
Stock Position:  0.008176534622493549
Bond Position:  [8.06684954]


portfolio before change:  [8.86370248]
curr_Stock_Price:  97.39440743932212
curr_Factors:  [97.39440744]
mat_Sqrt:  [[0.15]]
grads:  [0.01646163]
Stock Position:  0.016461633203770476
Bond Position:  [7.26043147]


portfolio before change:  [8.8630023]
curr_Stock_Price:  97.3243065490372
curr_Factors:  [97.32430655]
mat_Sqrt:  [[0.15]]
grads:  [-0.06708676]
Stock Position:  -0.06708676470899601
Bond Position:  [15.39217515]


portfolio before change:  [8.84966194]
curr_Stock_Price:  97.5374991405388
curr_Factors:  [97.53749914]
mat_Sqrt:  [[0.15]]
grads:  [-0.05992964]
Stock Position:  -0.05992963734895284
Bond Position:  [14.69504889]


portfolio before change:  [8.81332042]
curr_Stock_Price:  98.15922805574667
curr_Factors:  [98.15922806]
mat_Sqrt:  [[0.15]]
grads:  [0.0329733]
Stock Position:  0.03297329652689959
Bond Position:  [5.57668708]


portfolio before change:  [8.82248264]
curr_Stock_Price:  98.42652531102769
curr_Factors:  [98.42652531]
mat_Sqrt:  [[0.15]]
grads:  [0.08495427]
Stock Position:  0.0849542748462717
Bond Position:  [0.46072856]


portfolio before change:  [8.87274734]
curr_Stock_Price:  99.01785401704002
curr_Factors:  [99.01785402]
mat_Sqrt:  [[0.15]]
grads:  [0.0994476]
Stock Position:  0.09944760243619774
Bond Position:  [-0.97434084]


portfolio before change:  [8.80748372]
curr_Stock_Price:  98.36220496204766
curr_Factors:  [98.36220496]
mat_Sqrt:  [[0.15]]
grads:  [-0.2313341]
Stock Position:  -0.23133409902525193
Bond Position:  [31.56201578]


portfolio before change:  [8.9005239]
curr_Stock_Price:  97.96854273781874
curr_Factors:  [97.96854274]
mat_Sqrt:  [[0.15]]
grads:  [0.05882777]
Stock Position:  0.058827766700730706
Bond Position:  [3.13725332]


portfolio before change:  [8.94239025]
curr_Stock_Price:  98.67688625655163
curr_Factors:  [98.67688626]
mat_Sqrt:  [[0.15]]
grads:  [-0.11337389]
Stock Position:  -0.1133738949242556
Bond Position:  [20.12977319]


portfolio before change:  [8.87329581]
curr_Stock_Price:  99.297422350578
curr_Factors:  [99.29742235]
mat_Sqrt:  [[0.15]]
grads:  [0.16342276]
Stock Position:  0.16342275924635188
Bond Position:  [-7.35416294]


portfolio before change:  [8.93799295]
curr_Stock_Price:  99.69612318049037
curr_Factors:  [99.69612318]
mat_Sqrt:  [[0.15]]
grads:  [-0.04065074]
Stock Position:  -0.04065073533200245
Bond Position:  [12.99071367]


portfolio before change:  [8.96207591]
curr_Stock_Price:  99.12366078393637
curr_Factors:  [99.12366078]
mat_Sqrt:  [[0.15]]
grads:  [0.00013516]
Stock Position:  0.00013516269985566765
Bond Position:  [8.94867809]


portfolio before change:  [8.9627415]
curr_Stock_Price:  99.90995346010837
curr_Factors:  [99.90995346]
mat_Sqrt:  [[0.15]]
grads:  [0.15756529]
Stock Position:  0.1575652861225121
Bond Position:  [-6.77959891]


portfolio before change:  [8.95638887]
curr_Stock_Price:  99.87232528073858
curr_Factors:  [99.87232528]
mat_Sqrt:  [[0.15]]
grads:  [0.02612681]
Stock Position:  0.026126807295744302
Bond Position:  [6.34704387]


portfolio before change:  [8.96523798]
curr_Stock_Price:  100.19584016391191
curr_Factors:  [100.19584016]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417359]
Stock Position:  -0.054173593294812215
Bond Position:  [14.39320667]


portfolio before change:  [9.01926794]
curr_Stock_Price:  99.21509742491138
curr_Factors:  [99.21509742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03905657]
Stock Position:  -0.039056569751872994
Bond Position:  [12.89426931]


portfolio before change:  [9.0120564]
curr_Stock_Price:  99.42037545623292
curr_Factors:  [99.42037546]
mat_Sqrt:  [[0.15]]
grads:  [0.00807398]
Stock Position:  0.008073982688856427
Bond Position:  [8.20933801]


portfolio before change:  [9.0065351]
curr_Stock_Price:  98.67298720611683
curr_Factors:  [98.67298721]
mat_Sqrt:  [[0.15]]
grads:  [-0.08249791]
Stock Position:  -0.08249790557524124
Bond Position:  [17.14684988]


portfolio before change:  [8.96773813]
curr_Stock_Price:  99.15625626340882
curr_Factors:  [99.15625626]
mat_Sqrt:  [[0.15]]
grads:  [-0.07588668]
Stock Position:  -0.0758866805842155
Bond Position:  [16.49237728]


portfolio before change:  [8.93704115]
curr_Stock_Price:  99.57435048684992
curr_Factors:  [99.57435049]
mat_Sqrt:  [[0.15]]
grads:  [-0.04109774]
Stock Position:  -0.041097738559833466
Bond Position:  [13.02932178]


portfolio before change:  [8.94191232]
curr_Stock_Price:  99.47563913786418
curr_Factors:  [99.47563914]
mat_Sqrt:  [[0.15]]
grads:  [0.31798001]
Stock Position:  0.31798000835589013
Bond Position:  [-22.68935224]


portfolio before change:  [9.1106498]
curr_Stock_Price:  100.01075330320863
curr_Factors:  [100.0107533]
mat_Sqrt:  [[0.15]]
grads:  [-0.06035836]
Stock Position:  -0.060358363387332574
Bond Position:  [15.14713519]


portfolio before change:  [9.11423717]
curr_Stock_Price:  99.96700382839617
curr_Factors:  [99.96700383]
mat_Sqrt:  [[0.15]]
grads:  [0.01692875]
Stock Position:  0.01692875070440429
Bond Position:  [7.42192069]


portfolio before change:  [9.12242041]
curr_Stock_Price:  100.42299475272465
curr_Factors:  [100.42299475]
mat_Sqrt:  [[0.15]]
grads:  [0.03567153]
Stock Position:  0.03567153168168272
Bond Position:  [5.54017838]


portfolio before change:  [9.12604459]
curr_Stock_Price:  100.51488613461001
curr_Factors:  [100.51488613]
mat_Sqrt:  [[0.15]]
grads:  [0.03452326]
Stock Position:  0.03452326330103191
Bond Position:  [5.65594271]


portfolio before change:  [9.10017993]
curr_Stock_Price:  99.75545139768643
curr_Factors:  [99.7554514]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074855]
Stock Position:  -0.02074855409505081
Bond Position:  [11.16996131]


portfolio before change:  [9.10441893]
curr_Stock_Price:  99.5847960045242
curr_Factors:  [99.584796]
mat_Sqrt:  [[0.15]]
grads:  [0.0449864]
Stock Position:  0.04498640249268475
Bond Position:  [4.62445722]


portfolio before change:  [9.08497848]
curr_Stock_Price:  99.14623045042792
curr_Factors:  [99.14623045]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083632]
Stock Position:  -0.000836324059569745
Bond Position:  [9.16789686]


portfolio before change:  [9.08545502]
curr_Stock_Price:  99.26158514206654
curr_Factors:  [99.26158514]
mat_Sqrt:  [[0.15]]
grads:  [0.01033112]
Stock Position:  0.010331122542627635
Bond Position:  [8.05997142]


portfolio before change:  [9.08152994]
curr_Stock_Price:  98.83289551563452
curr_Factors:  [98.83289552]
mat_Sqrt:  [[0.15]]
grads:  [0.01265675]
Stock Position:  0.01265675233882435
Bond Position:  [7.83062646]


portfolio before change:  [9.0757695]
curr_Stock_Price:  98.3390985255128
curr_Factors:  [98.33909853]
mat_Sqrt:  [[0.15]]
grads:  [0.00250517]
Stock Position:  0.0025051728981466347
Bond Position:  [8.82941306]


portfolio before change:  [9.07594278]
curr_Stock_Price:  98.18798001661814
curr_Factors:  [98.18798002]
mat_Sqrt:  [[0.15]]
grads:  [0.00495012]
Stock Position:  0.00495011506179574
Bond Position:  [8.58990098]


portfolio before change:  [9.07319922]
curr_Stock_Price:  97.52527829216713
curr_Factors:  [97.52527829]
mat_Sqrt:  [[0.15]]
grads:  [0.07735433]
Stock Position:  0.07735432555972371
Bond Position:  [1.52919709]


portfolio before change:  [9.13256148]
curr_Stock_Price:  98.2914498590164
curr_Factors:  [98.29144986]
mat_Sqrt:  [[0.15]]
grads:  [-0.11882521]
Stock Position:  -0.11882520906066583
Bond Position:  [20.81206356]


portfolio before change:  [9.10906903]
curr_Stock_Price:  98.50010291977046
curr_Factors:  [98.50010292]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355094]
Stock Position:  -0.08355093657858306
Bond Position:  [17.33884488]


portfolio before change:  [9.05439496]
curr_Stock_Price:  99.16745364757814
curr_Factors:  [99.16745365]
mat_Sqrt:  [[0.15]]
grads:  [-0.0029052]
Stock Position:  -0.002905203151806965
Bond Position:  [9.34249656]


portfolio before change:  [9.05546059]
curr_Stock_Price:  99.00164722650854
curr_Factors:  [99.00164723]
mat_Sqrt:  [[0.15]]
grads:  [-0.03341976]
Stock Position:  -0.03341975530335297
Bond Position:  [12.36407141]


portfolio before change:  [9.04571832]
curr_Stock_Price:  99.31628302731671
curr_Factors:  [99.31628303]
mat_Sqrt:  [[0.15]]
grads:  [0.15338471]
Stock Position:  0.1533847119872923
Bond Position:  [-6.18788115]


portfolio before change:  [8.89497745]
curr_Stock_Price:  98.33604117558154
curr_Factors:  [98.33604118]
mat_Sqrt:  [[0.15]]
grads:  [-0.06470535]
Stock Position:  -0.06470534586294564
Bond Position:  [15.257845]


portfolio before change:  [8.82667945]
curr_Stock_Price:  99.40630276357236
curr_Factors:  [99.40630276]
mat_Sqrt:  [[0.15]]
grads:  [0.04027689]
Stock Position:  0.04027688844885732
Bond Position:  [4.82290288]


portfolio before change:  [8.79580318]
curr_Stock_Price:  98.63221846553422
curr_Factors:  [98.63221847]
mat_Sqrt:  [[0.15]]
grads:  [-0.04268023]
Stock Position:  -0.04268022942952752
Bond Position:  [13.00544889]


portfolio before change:  [8.83436545]
curr_Stock_Price:  97.74774784978887
curr_Factors:  [97.74774785]
mat_Sqrt:  [[0.15]]
grads:  [0.07568669]
Stock Position:  0.07568669051535876
Bond Position:  [1.43616191]


portfolio before change:  [8.83664755]
curr_Stock_Price:  97.7767137749064
curr_Factors:  [97.77671377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01076517]
Stock Position:  -0.010765169024954937
Bond Position:  [9.8892304]


portfolio before change:  [8.83975053]
curr_Stock_Price:  97.54588778397041
curr_Factors:  [97.54588778]
mat_Sqrt:  [[0.15]]
grads:  [0.03762279]
Stock Position:  0.03762278579044183
Bond Position:  [5.16980249]


portfolio before change:  [8.86920118]
curr_Stock_Price:  98.32008693099948
curr_Factors:  [98.32008693]
mat_Sqrt:  [[0.15]]
grads:  [-0.104853]
Stock Position:  -0.10485299805237112
Bond Position:  [19.17835706]


portfolio before change:  [8.86015235]
curr_Stock_Price:  98.41781910166185
curr_Factors:  [98.4178191]
mat_Sqrt:  [[0.15]]
grads:  [-0.04611083]
Stock Position:  -0.04611082943841327
Bond Position:  [13.39827962]


portfolio before change:  [8.82021618]
curr_Stock_Price:  99.30207101689058
curr_Factors:  [99.30207102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02371065]
Stock Position:  -0.023710645276019272
Bond Position:  [11.17473236]


portfolio before change:  [8.81535051]
curr_Stock_Price:  99.53673840259364
curr_Factors:  [99.5367384]
mat_Sqrt:  [[0.15]]
grads:  [-0.01297857]
Stock Position:  -0.012978569030017609
Bond Position:  [10.10719494]


portfolio before change:  [8.81757309]
curr_Stock_Price:  99.41416282967846
curr_Factors:  [99.41416283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.81757309]
Stock Price:  99.60729683863943
PL:  [8.81757309]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.11354489e-03]
 [ 5.59319106e-04]
 [-3.83664542e-03]
 [ 6.40903585e-03]
 [ 2.56002191e-04]
 [ 2.06135638e-02]
 [ 7.70944802e-04]
 [-2.09537950e-02]
 [-2.23260410e-03]
 [ 3.43087346e-02]
 [-7.35890964e-02]
 [ 3.15996633e-02]
 [-1.33651262e-02]
 [ 7.48768958e-03]
 [-6.97959268e-03]
 [ 6.03633548e-03]
 [ 7.30865692e-03]
 [-1.19700234e-02]
 [ 6.86203566e-04]
 [ 1.24586701e-02]
 [ 1.17506442e-02]
 [-8.11870447e-03]
 [ 7.43034793e-03]
 [ 1.49150203e-02]
 [-4.96782783e-04]
 [ 5.66635905e-03]
 [-7.09483242e-03]
 [ 6.52834211e-03]
 [-8.43776420e-03]
 [-2.97077399e-03]
 [ 3.93238968e-03]
 [-1.12060532e-02]
 [ 1.91110815e-03]
 [ 7.06799052e-03]
 [ 1.14619176e-02]
 [ 8.69139661e-03]
 [-3.38899629e-02]
 [ 9.26949750e-03]
 [ 1.06413489e-02]
 [ 9.79950292e-03]
 [-4.07141173e-03]
 [-1.54341713e-02]
 [ 2.03618663e-02]
 [-2.92335172e-03]
 [ 5.73760242e-03]
 [-1.63437905e-02]
 [ 1.48633812e-02]
 [ 3.89616281e-03]
 [ 3.44747362e-03]
 [-7.46559446e-03]
 [-1.34607656e-02]
 [ 5.00366745e-03]
 [-1.06883575e-02]
 [ 5.77296518e-03]
 [-2.11161606e-02]
 [ 3.35515407e-02]
 [ 1.78983045e-02]
 [ 2.76825887e-03]
 [ 2.15253635e-03]
 [-6.67254336e-03]
 [ 2.30629156e-02]
 [ 5.24516027e-02]
 [-8.68638075e-03]
 [-1.12861040e-02]
 [ 2.25929976e-02]
 [ 1.24458293e-02]
 [-4.20465606e-03]
 [ 1.59885356e-02]
 [-2.69956176e-02]
 [-6.08101283e-02]
 [-1.31816141e-03]
 [ 1.63877746e-02]
 [-3.24252635e-02]
 [ 2.88932322e-02]
 [-3.05340261e-02]
 [ 6.70101227e-03]
 [ 1.09114592e-02]
 [-1.92852318e-02]
 [ 1.93317273e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.28650612]
curr_Stock_Price:  100.08095148103295
curr_Factors:  [100.08095148]
mat_Sqrt:  [[0.15]]
grads:  [0.00742363]
Stock Position:  0.007423632575784366
Bond Position:  [2.54354191]


portfolio before change:  [3.28404808]
curr_Stock_Price:  99.72842602035196
curr_Factors:  [99.72842602]
mat_Sqrt:  [[0.15]]
grads:  [0.00372879]
Stock Position:  0.003728794041560219
Bond Position:  [2.91218132]


portfolio before change:  [3.28107125]
curr_Stock_Price:  98.88127578960328
curr_Factors:  [98.88127579]
mat_Sqrt:  [[0.15]]
grads:  [-0.02557764]
Stock Position:  -0.025577636106662627
Bond Position:  [5.81022054]


portfolio before change:  [3.2872184]
curr_Stock_Price:  98.65514066511538
curr_Factors:  [98.65514067]
mat_Sqrt:  [[0.15]]
grads:  [0.04272691]
Stock Position:  0.04272690566367674
Bond Position:  [-0.92801049]


portfolio before change:  [3.30064086]
curr_Stock_Price:  98.97064367920501
curr_Factors:  [98.97064368]
mat_Sqrt:  [[0.15]]
grads:  [0.00170668]
Stock Position:  0.0017066812758266665
Bond Position:  [3.13172952]


portfolio before change:  [3.30161587]
curr_Stock_Price:  99.42724041906793
curr_Factors:  [99.42724042]
mat_Sqrt:  [[0.15]]
grads:  [0.13742376]
Stock Position:  0.1374237583797648
Bond Position:  [-10.3620492]


portfolio before change:  [3.30869948]
curr_Stock_Price:  99.48349898991893
curr_Factors:  [99.48349899]
mat_Sqrt:  [[0.15]]
grads:  [0.00513963]
Stock Position:  0.005139632012470445
Bond Position:  [2.79739091]


portfolio before change:  [3.30449309]
curr_Stock_Price:  98.6310575564994
curr_Factors:  [98.63105756]
mat_Sqrt:  [[0.15]]
grads:  [-0.13969197]
Stock Position:  -0.13969196695679703
Bond Position:  [17.08245952]


portfolio before change:  [3.31799976]
curr_Stock_Price:  98.54201176624224
curr_Factors:  [98.54201177]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488403]
Stock Position:  -0.014884027342485761
Bond Position:  [4.78470176]


portfolio before change:  [3.33753923]
curr_Stock_Price:  97.24932286162927
curr_Factors:  [97.24932286]
mat_Sqrt:  [[0.15]]
grads:  [0.2287249]
Stock Position:  0.22872489715176092
Bond Position:  [-18.90580214]


portfolio before change:  [3.30717958]
curr_Stock_Price:  97.12175474366923
curr_Factors:  [97.12175474]
mat_Sqrt:  [[0.15]]
grads:  [-0.49059398]
Stock Position:  -0.49059397604729393
Bond Position:  [50.9545274]


portfolio before change:  [3.34305361]
curr_Stock_Price:  97.05512270664065
curr_Factors:  [97.05512271]
mat_Sqrt:  [[0.15]]
grads:  [0.21066442]
Stock Position:  0.21066442187990014
Bond Position:  [-17.10300771]


portfolio before change:  [3.50975644]
curr_Stock_Price:  97.85151631997557
curr_Factors:  [97.85151632]
mat_Sqrt:  [[0.15]]
grads:  [-0.08910084]
Stock Position:  -0.08910084158425152
Bond Position:  [12.22840889]


portfolio before change:  [3.42801911]
curr_Stock_Price:  98.77745173792047
curr_Factors:  [98.77745174]
mat_Sqrt:  [[0.15]]
grads:  [0.04991793]
Stock Position:  0.04991793053365078
Bond Position:  [-1.50274686]


portfolio before change:  [3.40927229]
curr_Stock_Price:  98.40378049721438
curr_Factors:  [98.4037805]
mat_Sqrt:  [[0.15]]
grads:  [-0.04653062]
Stock Position:  -0.04653061788355401
Bond Position:  [7.988061]


portfolio before change:  [3.39790868]
curr_Stock_Price:  98.65872828764601
curr_Factors:  [98.65872829]
mat_Sqrt:  [[0.15]]
grads:  [0.04024224]
Stock Position:  0.04024223654260708
Bond Position:  [-0.5723392]


portfolio before change:  [3.43373587]
curr_Stock_Price:  99.54990547919179
curr_Factors:  [99.54990548]
mat_Sqrt:  [[0.15]]
grads:  [0.04872438]
Stock Position:  0.04872437944883106
Bond Position:  [-1.41677149]


portfolio before change:  [3.43903395]
curr_Stock_Price:  99.66045844886675
curr_Factors:  [99.66045845]
mat_Sqrt:  [[0.15]]
grads:  [-0.07980016]
Stock Position:  -0.07980015579109141
Bond Position:  [11.39195406]


portfolio before change:  [3.51550793]
curr_Stock_Price:  98.71106230039824
curr_Factors:  [98.7110623]
mat_Sqrt:  [[0.15]]
grads:  [0.00457469]
Stock Position:  0.004574690441275708
Bond Position:  [3.06393538]


portfolio before change:  [3.51625168]
curr_Stock_Price:  98.8317813845371
curr_Factors:  [98.83178138]
mat_Sqrt:  [[0.15]]
grads:  [0.0830578]
Stock Position:  0.08305780089168137
Bond Position:  [-4.69249874]


portfolio before change:  [3.52486146]
curr_Stock_Price:  98.93897265679239
curr_Factors:  [98.93897266]
mat_Sqrt:  [[0.15]]
grads:  [0.07833763]
Stock Position:  0.07833762805204081
Bond Position:  [-4.22578298]


portfolio before change:  [3.61099869]
curr_Stock_Price:  100.04190810985601
curr_Factors:  [100.04190811]
mat_Sqrt:  [[0.15]]
grads:  [-0.0541247]
Stock Position:  -0.054124696452514436
Bond Position:  [9.0257366]


portfolio before change:  [3.5534992]
curr_Stock_Price:  101.11468310872239
curr_Factors:  [101.11468311]
mat_Sqrt:  [[0.15]]
grads:  [0.04953565]
Stock Position:  0.049535652848202716
Bond Position:  [-1.45528264]


portfolio before change:  [3.56677494]
curr_Stock_Price:  101.3845230378883
curr_Factors:  [101.38452304]
mat_Sqrt:  [[0.15]]
grads:  [0.09943347]
Stock Position:  0.09943346858323868
Bond Position:  [-6.51423985]


portfolio before change:  [3.47464504]
curr_Stock_Price:  100.46206964282382
curr_Factors:  [100.46206964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00331189]
Stock Position:  -0.003311885222050115
Bond Position:  [3.80736389]


portfolio before change:  [3.47793046]
curr_Stock_Price:  99.54191306565194
curr_Factors:  [99.54191307]
mat_Sqrt:  [[0.15]]
grads:  [0.03777573]
Stock Position:  0.03777572702885201
Bond Position:  [-0.28233767]


portfolio before change:  [3.48271268]
curr_Stock_Price:  99.66897532154432
curr_Factors:  [99.66897532]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729888]
Stock Position:  -0.047298882828987455
Bond Position:  [8.19694387]


portfolio before change:  [3.43664386]
curr_Stock_Price:  100.65380087538992
curr_Factors:  [100.65380088]
mat_Sqrt:  [[0.15]]
grads:  [0.04352228]
Stock Position:  0.04352228071209434
Bond Position:  [-0.94403911]


portfolio before change:  [3.390899]
curr_Stock_Price:  99.60408888793378
curr_Factors:  [99.60408889]
mat_Sqrt:  [[0.15]]
grads:  [-0.05625176]
Stock Position:  -0.05625176135110555
Bond Position:  [8.99380444]


portfolio before change:  [3.35296664]
curr_Stock_Price:  100.28841385256784
curr_Factors:  [100.28841385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01980516]
Stock Position:  -0.019805159964105742
Bond Position:  [5.33919472]


portfolio before change:  [3.35576668]
curr_Stock_Price:  100.16388444835341
curr_Factors:  [100.16388445]
mat_Sqrt:  [[0.15]]
grads:  [0.02621593]
Stock Position:  0.026215931201340345
Bond Position:  [0.72987717]


portfolio before change:  [3.34854764]
curr_Stock_Price:  99.88677583775156
curr_Factors:  [99.88677584]
mat_Sqrt:  [[0.15]]
grads:  [-0.07470702]
Stock Position:  -0.07470702158978391
Bond Position:  [10.81079116]


portfolio before change:  [3.34249208]
curr_Stock_Price:  99.97687784332435
curr_Factors:  [99.97687784]
mat_Sqrt:  [[0.15]]
grads:  [0.01274072]
Stock Position:  0.012740721016178784
Bond Position:  [2.06871457]


portfolio before change:  [3.35272381]
curr_Stock_Price:  100.76980241598007
curr_Factors:  [100.76980242]
mat_Sqrt:  [[0.15]]
grads:  [0.04711994]
Stock Position:  0.04711993679632424
Bond Position:  [-1.39554291]


portfolio before change:  [3.35478593]
curr_Stock_Price:  100.81541673907797
curr_Factors:  [100.81541674]
mat_Sqrt:  [[0.15]]
grads:  [0.07641278]
Stock Position:  0.07641278379967185
Bond Position:  [-4.34880071]


portfolio before change:  [3.39563829]
curr_Stock_Price:  101.35360115834864
curr_Factors:  [101.35360116]
mat_Sqrt:  [[0.15]]
grads:  [0.05794264]
Stock Position:  0.057942644039892514
Bond Position:  [-2.47705734]


portfolio before change:  [3.39679541]
curr_Stock_Price:  101.37624314731497
curr_Factors:  [101.37624315]
mat_Sqrt:  [[0.15]]
grads:  [-0.22593309]
Stock Position:  -0.22593308604936793
Bond Position:  [26.30104287]


portfolio before change:  [3.12666172]
curr_Stock_Price:  102.5791548394475
curr_Factors:  [102.57915484]
mat_Sqrt:  [[0.15]]
grads:  [0.06179665]
Stock Position:  0.061796649988373364
Bond Position:  [-3.21238641]


portfolio before change:  [3.18570632]
curr_Stock_Price:  103.53786987098631
curr_Factors:  [103.53786987]
mat_Sqrt:  [[0.15]]
grads:  [0.07094233]
Stock Position:  0.07094232567158006
Bond Position:  [-4.15951097]


portfolio before change:  [3.19312134]
curr_Stock_Price:  103.64605637773683
curr_Factors:  [103.64605638]
mat_Sqrt:  [[0.15]]
grads:  [0.06533002]
Stock Position:  0.06533001943854626
Bond Position:  [-3.57807753]


portfolio before change:  [3.23425844]
curr_Stock_Price:  104.27916087566717
curr_Factors:  [104.27916088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02714274]
Stock Position:  -0.027142744857579573
Bond Position:  [6.06468109]


portfolio before change:  [3.22376313]
curr_Stock_Price:  104.67979686636127
curr_Factors:  [104.67979687]
mat_Sqrt:  [[0.15]]
grads:  [-0.10289448]
Stock Position:  -0.10289447525600989
Bond Position:  [13.9947359]


portfolio before change:  [3.22906309]
curr_Stock_Price:  104.63678905895323
curr_Factors:  [104.63678906]
mat_Sqrt:  [[0.15]]
grads:  [0.13574578]
Stock Position:  0.13574577515249792
Bond Position:  [-10.97493895]


portfolio before change:  [3.15588989]
curr_Stock_Price:  104.10279640698356
curr_Factors:  [104.10279641]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948901]
Stock Position:  -0.019489011458480403
Bond Position:  [5.18475048]


portfolio before change:  [3.16266185]
curr_Stock_Price:  103.77194826184609
curr_Factors:  [103.77194826]
mat_Sqrt:  [[0.15]]
grads:  [0.03825068]
Stock Position:  0.03825068280163147
Bond Position:  [-0.80668602]


portfolio before change:  [3.18069374]
curr_Stock_Price:  104.24467978961546
curr_Factors:  [104.24467979]
mat_Sqrt:  [[0.15]]
grads:  [-0.1089586]
Stock Position:  -0.10895860344867606
Bond Position:  [14.53904846]


portfolio before change:  [3.21030547]
curr_Stock_Price:  103.98124934672124
curr_Factors:  [103.98124935]
mat_Sqrt:  [[0.15]]
grads:  [0.09908921]
Stock Position:  0.09908920827619401
Bond Position:  [-7.0931142]


portfolio before change:  [3.1035712]
curr_Stock_Price:  102.9085701413731
curr_Factors:  [102.90857014]
mat_Sqrt:  [[0.15]]
grads:  [0.02597442]
Stock Position:  0.025974418744040027
Bond Position:  [0.43058091]


portfolio before change:  [3.11620327]
curr_Stock_Price:  103.39386126211384
curr_Factors:  [103.39386126]
mat_Sqrt:  [[0.15]]
grads:  [0.02298316]
Stock Position:  0.02298315746381117
Bond Position:  [0.73988587]


portfolio before change:  [3.13966811]
curr_Stock_Price:  104.41280726192184
curr_Factors:  [104.41280726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04977063]
Stock Position:  -0.04977062971766317
Bond Position:  [8.33635928]


portfolio before change:  [3.14999802]
curr_Stock_Price:  104.21572580508501
curr_Factors:  [104.21572581]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973844]
Stock Position:  -0.08973843760951351
Bond Position:  [12.50215442]


portfolio before change:  [2.99240985]
curr_Stock_Price:  105.98051662620773
curr_Factors:  [105.98051663]
mat_Sqrt:  [[0.15]]
grads:  [0.03335778]
Stock Position:  0.03335778297616309
Bond Position:  [-0.54286522]


portfolio before change:  [3.01838186]
curr_Stock_Price:  106.76012281702135
curr_Factors:  [106.76012282]
mat_Sqrt:  [[0.15]]
grads:  [-0.07125572]
Stock Position:  -0.07125571668304169
Bond Position:  [10.62565092]


portfolio before change:  [3.00905058]
curr_Stock_Price:  106.90039789776169
curr_Factors:  [106.9003979]
mat_Sqrt:  [[0.15]]
grads:  [0.03848643]
Stock Position:  0.038486434520077786
Bond Position:  [-1.10516458]


portfolio before change:  [3.0060788]
curr_Stock_Price:  106.82497628394374
curr_Factors:  [106.82497628]
mat_Sqrt:  [[0.15]]
grads:  [-0.1407744]
Stock Position:  -0.1407744037504778
Bond Position:  [18.04430114]


portfolio before change:  [2.95438159]
curr_Stock_Price:  107.20022215532094
curr_Factors:  [107.20022216]
mat_Sqrt:  [[0.15]]
grads:  [0.22367694]
Stock Position:  0.2236769381846964
Bond Position:  [-21.02383588]


portfolio before change:  [3.03674145]
curr_Stock_Price:  107.57430586071891
curr_Factors:  [107.57430586]
mat_Sqrt:  [[0.15]]
grads:  [0.11932203]
Stock Position:  0.11932203024887088
Bond Position:  [-9.79924312]


portfolio before change:  [3.15667871]
curr_Stock_Price:  108.5845947822866
curr_Factors:  [108.58459478]
mat_Sqrt:  [[0.15]]
grads:  [0.01845506]
Stock Position:  0.01845505910927931
Bond Position:  [1.15274359]


portfolio before change:  [3.16021905]
curr_Stock_Price:  108.77252671263837
curr_Factors:  [108.77252671]
mat_Sqrt:  [[0.15]]
grads:  [0.01435024]
Stock Position:  0.014350242361587605
Bond Position:  [1.59930693]


portfolio before change:  [3.16015932]
curr_Stock_Price:  108.76139844879211
curr_Factors:  [108.76139845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04448362]
Stock Position:  -0.04448362236730288
Bond Position:  [7.99826029]


portfolio before change:  [3.18888512]
curr_Stock_Price:  108.1268750827939
curr_Factors:  [108.12687508]
mat_Sqrt:  [[0.15]]
grads:  [0.15375277]
Stock Position:  0.15375277098078424
Bond Position:  [-13.43592154]


portfolio before change:  [3.19612212]
curr_Stock_Price:  108.17940593878266
curr_Factors:  [108.17940594]
mat_Sqrt:  [[0.15]]
grads:  [0.34967735]
Stock Position:  0.34967735136395106
Bond Position:  [-34.63176602]


portfolio before change:  [3.48836833]
curr_Stock_Price:  109.02135572367725
curr_Factors:  [109.02135572]
mat_Sqrt:  [[0.15]]
grads:  [-0.05790921]
Stock Position:  -0.05790920502961247
Bond Position:  [9.80170838]


portfolio before change:  [3.45287847]
curr_Stock_Price:  109.64478838887108
curr_Factors:  [109.64478839]
mat_Sqrt:  [[0.15]]
grads:  [-0.07524069]
Stock Position:  -0.07524069300588045
Bond Position:  [11.70262833]


portfolio before change:  [3.38786737]
curr_Stock_Price:  110.51855147040192
curr_Factors:  [110.51855147]
mat_Sqrt:  [[0.15]]
grads:  [0.15061998]
Stock Position:  0.15061998393541304
Bond Position:  [-13.25843508]


portfolio before change:  [3.40946362]
curr_Stock_Price:  110.66743565931026
curr_Factors:  [110.66743566]
mat_Sqrt:  [[0.15]]
grads:  [0.0829722]
Stock Position:  0.08297219553561608
Bond Position:  [-5.77285649]


portfolio before change:  [3.29528873]
curr_Stock_Price:  109.29572222757024
curr_Factors:  [109.29572223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02803104]
Stock Position:  -0.02803104041396949
Bond Position:  [6.35896154]


portfolio before change:  [3.28164262]
curr_Stock_Price:  109.79672250606048
curr_Factors:  [109.79672251]
mat_Sqrt:  [[0.15]]
grads:  [0.10659024]
Stock Position:  0.10659023735092472
Bond Position:  [-8.42161609]


portfolio before change:  [3.24246146]
curr_Stock_Price:  109.43407392886742
curr_Factors:  [109.43407393]
mat_Sqrt:  [[0.15]]
grads:  [-0.17997078]
Stock Position:  -0.17997078371870684
Bond Position:  [22.93739751]


portfolio before change:  [3.21097342]
curr_Stock_Price:  109.61700175078234
curr_Factors:  [109.61700175]
mat_Sqrt:  [[0.15]]
grads:  [-0.40540086]
Stock Position:  -0.4054008552077253
Bond Position:  [47.64979968]


portfolio before change:  [3.56841286]
curr_Stock_Price:  108.74265424301542
curr_Factors:  [108.74265424]
mat_Sqrt:  [[0.15]]
grads:  [-0.00878774]
Stock Position:  -0.008787742728824875
Bond Position:  [4.52401533]


portfolio before change:  [3.57473308]
curr_Stock_Price:  108.05562185843588
curr_Factors:  [108.05562186]
mat_Sqrt:  [[0.15]]
grads:  [0.10925183]
Stock Position:  0.10925183043829614
Bond Position:  [-8.2305414]


portfolio before change:  [3.56637152]
curr_Stock_Price:  107.98379575279128
curr_Factors:  [107.98379575]
mat_Sqrt:  [[0.15]]
grads:  [-0.21616842]
Stock Position:  -0.2161684232633231
Bond Position:  [26.90905839]


portfolio before change:  [3.45474227]
curr_Stock_Price:  108.50797556423969
curr_Factors:  [108.50797556]
mat_Sqrt:  [[0.15]]
grads:  [0.19262155]
Stock Position:  0.19262154812561394
Bond Position:  [-17.44623197]


portfolio before change:  [3.39091486]
curr_Stock_Price:  108.18227482034202
curr_Factors:  [108.18227482]
mat_Sqrt:  [[0.15]]
grads:  [-0.20356017]
Stock Position:  -0.20356017398777526
Bond Position:  [25.41251755]


portfolio before change:  [3.39794647]
curr_Stock_Price:  108.15553446012389
curr_Factors:  [108.15553446]
mat_Sqrt:  [[0.15]]
grads:  [0.04467342]
Stock Position:  0.04467341513747086
Bond Position:  [-1.43373062]


portfolio before change:  [3.42411921]
curr_Stock_Price:  108.74340873411487
curr_Factors:  [108.74340873]
mat_Sqrt:  [[0.15]]
grads:  [0.07274306]
Stock Position:  0.0727430610783367
Bond Position:  [-4.48620922]


portfolio before change:  [3.44022265]
curr_Stock_Price:  108.96863757711922
curr_Factors:  [108.96863758]
mat_Sqrt:  [[0.15]]
grads:  [-0.12856821]
Stock Position:  -0.12856821230101054
Bond Position:  [17.45012558]


portfolio before change:  [3.41580224]
curr_Stock_Price:  109.1670620131667
curr_Factors:  [109.16706201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.41580224]
Stock Price:  109.16900882226233
PL:  [-5.75320658]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.24735362e-04]
 [ 2.15289195e-03]
 [-3.10802237e-03]
 [ 3.35326643e-03]
 [ 1.61886344e-02]
 [ 2.85814119e-02]
 [ 1.45645028e-03]
 [-1.30978058e-02]
 [ 1.98557422e-02]
 [ 2.20639728e-03]
 [ 1.45428087e-02]
 [-1.68490023e-02]
 [-6.68227636e-04]
 [ 1.14084044e-02]
 [-6.91221704e-03]
 [ 7.16116147e-03]
 [ 7.26044702e-03]
 [-9.16191376e-03]
 [ 5.36137698e-04]
 [ 1.38323700e-02]
 [ 1.13606003e-02]
 [-7.84464536e-03]
 [ 7.87454352e-03]
 [ 3.13196615e-02]
 [-4.08377566e-03]
 [ 1.47196102e-02]
 [-5.50144001e-03]
 [ 8.90834006e-03]
 [ 2.66647545e-02]
 [-6.31463484e-04]
 [ 1.07104046e-02]
 [-1.17938388e-02]
 [ 7.73066147e-03]
 [ 8.42547328e-03]
 [ 1.10711296e-02]
 [ 8.73267795e-03]
 [-3.36713253e-02]
 [ 9.20537562e-03]
 [ 1.31089408e-02]
 [ 8.53962956e-04]
 [-4.74037130e-03]
 [-1.49761758e-02]
 [ 2.05149759e-02]
 [-2.03899712e-03]
 [ 4.60593866e-03]
 [-1.64866212e-02]
 [ 1.42013697e-02]
 [ 3.68810899e-03]
 [ 1.86560320e-03]
 [-7.45576279e-03]
 [-1.34602172e-02]
 [-3.09858815e-03]
 [-5.46296668e-03]
 [ 5.36228590e-03]
 [ 5.43233923e-03]
 [-3.59283772e-03]
 [ 5.16563883e-03]
 [-3.64092335e-04]
 [ 1.59809187e-03]
 [ 1.44791356e-02]
 [ 4.28690463e-04]
 [-5.49967569e-03]
 [-6.58956157e-03]
 [-1.31518377e-02]
 [-6.73015418e-03]
 [ 1.74904718e-03]
 [-5.46634204e-03]
 [ 2.08587231e-02]
 [-8.21279915e-03]
 [ 9.49040901e-03]
 [-1.10520365e-02]
 [ 1.10149494e-02]
 [-6.68113645e-03]
 [ 1.74518639e-02]
 [-2.24853524e-02]
 [-4.27246877e-03]
 [-7.06705099e-03]
 [-1.88744573e-03]
 [ 3.43445529e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.33537898]
curr_Stock_Price:  100.60432910795001
curr_Factors:  [100.60432911]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021649]
Stock Position:  -0.0021649024128374186
Bond Position:  [11.55317754]


portfolio before change:  [11.33608434]
curr_Stock_Price:  100.61205897217037
curr_Factors:  [100.61205897]
mat_Sqrt:  [[0.15]]
grads:  [0.01435261]
Stock Position:  0.014352613022058534
Bond Position:  [9.8920384]


portfolio before change:  [11.33751842]
curr_Stock_Price:  100.66889900873913
curr_Factors:  [100.66889901]
mat_Sqrt:  [[0.15]]
grads:  [-0.02072015]
Stock Position:  -0.020720149131928604
Bond Position:  [13.42339302]


portfolio before change:  [11.32666672]
curr_Stock_Price:  101.23311713461608
curr_Factors:  [101.23311713]
mat_Sqrt:  [[0.15]]
grads:  [0.02235511]
Stock Position:  0.022355109561657007
Bond Position:  [9.0635893]


portfolio before change:  [11.32772185]
curr_Stock_Price:  101.25497489385201
curr_Factors:  [101.25497489]
mat_Sqrt:  [[0.15]]
grads:  [0.10792423]
Stock Position:  0.107924229551468
Bond Position:  [0.39985669]


portfolio before change:  [11.26819038]
curr_Stock_Price:  100.70313904664636
curr_Factors:  [100.70313905]
mat_Sqrt:  [[0.15]]
grads:  [0.19054275]
Stock Position:  0.19054274632338897
Bond Position:  [-7.9200623]


portfolio before change:  [11.20579965]
curr_Stock_Price:  100.37830007592912
curr_Factors:  [100.37830008]
mat_Sqrt:  [[0.15]]
grads:  [0.00970967]
Stock Position:  0.009709668556946896
Bond Position:  [10.23115963]


portfolio before change:  [11.20790644]
curr_Stock_Price:  100.52941973648596
curr_Factors:  [100.52941974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08731871]
Stock Position:  -0.08731870546865954
Bond Position:  [19.98600523]


portfolio before change:  [11.25386141]
curr_Stock_Price:  100.01743547833905
curr_Factors:  [100.01743548]
mat_Sqrt:  [[0.15]]
grads:  [0.13237161]
Stock Position:  0.13237161476174283
Bond Position:  [-1.98560803]


portfolio before change:  [11.21664685]
curr_Stock_Price:  99.73723601668765
curr_Factors:  [99.73723602]
mat_Sqrt:  [[0.15]]
grads:  [0.01470932]
Stock Position:  0.01470931521250951
Bond Position:  [9.74958041]


portfolio before change:  [11.22665515]
curr_Stock_Price:  100.37621443262674
curr_Factors:  [100.37621443]
mat_Sqrt:  [[0.15]]
grads:  [0.09695206]
Stock Position:  0.09695205808926548
Bond Position:  [1.49497458]


portfolio before change:  [11.23130707]
curr_Stock_Price:  100.423232261446
curr_Factors:  [100.42323226]
mat_Sqrt:  [[0.15]]
grads:  [-0.11232668]
Stock Position:  -0.11232668183144605
Bond Position:  [22.51151552]


portfolio before change:  [11.29656798]
curr_Stock_Price:  99.85476627934915
curr_Factors:  [99.85476628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00445485]
Stock Position:  -0.004454850905959105
Bond Position:  [11.74140607]


portfolio before change:  [11.29812692]
curr_Stock_Price:  99.6695570608295
curr_Factors:  [99.66955706]
mat_Sqrt:  [[0.15]]
grads:  [0.07605603]
Stock Position:  0.0760560292663809
Bond Position:  [3.71765617]


portfolio before change:  [11.30939029]
curr_Stock_Price:  99.81459497104802
curr_Factors:  [99.81459497]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608145]
Stock Position:  -0.04608144690966953
Bond Position:  [15.90899124]


portfolio before change:  [11.34540523]
curr_Stock_Price:  99.05462308801918
curr_Factors:  [99.05462309]
mat_Sqrt:  [[0.15]]
grads:  [0.04774108]
Stock Position:  0.04774107649925262
Bond Position:  [6.61643089]


portfolio before change:  [11.3394022]
curr_Stock_Price:  98.9202195433005
curr_Factors:  [98.92021954]
mat_Sqrt:  [[0.15]]
grads:  [0.04840298]
Stock Position:  0.04840298013639835
Bond Position:  [6.55136878]


portfolio before change:  [11.3381361]
curr_Stock_Price:  98.88560227988545
curr_Factors:  [98.88560228]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107943]
Stock Position:  -0.061079425060771776
Bond Position:  [17.37801183]


portfolio before change:  [11.34396559]
curr_Stock_Price:  98.8079438756044
curr_Factors:  [98.80794388]
mat_Sqrt:  [[0.15]]
grads:  [0.00357425]
Stock Position:  0.0035742513192282862
Bond Position:  [10.99080116]


portfolio before change:  [11.34841226]
curr_Stock_Price:  99.85983483476906
curr_Factors:  [99.85983483]
mat_Sqrt:  [[0.15]]
grads:  [0.0922158]
Stock Position:  0.09221580027390491
Bond Position:  [2.13975767]


portfolio before change:  [11.35505949]
curr_Stock_Price:  99.93046802593663
curr_Factors:  [99.93046803]
mat_Sqrt:  [[0.15]]
grads:  [0.07573734]
Stock Position:  0.07573733551807231
Bond Position:  [3.78659211]


portfolio before change:  [11.31343231]
curr_Stock_Price:  99.37771756580644
curr_Factors:  [99.37771757]
mat_Sqrt:  [[0.15]]
grads:  [-0.05229764]
Stock Position:  -0.05229763574874865
Bond Position:  [16.51065199]


portfolio before change:  [11.31942872]
curr_Stock_Price:  99.28279056161097
curr_Factors:  [99.28279056]
mat_Sqrt:  [[0.15]]
grads:  [0.05249696]
Stock Position:  0.05249695679328736
Bond Position:  [6.10738435]


portfolio before change:  [11.32164127]
curr_Stock_Price:  99.31766547118893
curr_Factors:  [99.31766547]
mat_Sqrt:  [[0.15]]
grads:  [0.20879774]
Stock Position:  0.20879774335567888
Bond Position:  [-9.41566316]


portfolio before change:  [11.41796944]
curr_Stock_Price:  99.7818307909322
curr_Factors:  [99.78183079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02722517]
Stock Position:  -0.027225171058526804
Bond Position:  [14.13454686]


portfolio before change:  [11.40189742]
curr_Stock_Price:  100.40461704568365
curr_Factors:  [100.40461705]
mat_Sqrt:  [[0.15]]
grads:  [0.09813073]
Stock Position:  0.09813073435109823
Bond Position:  [1.54911862]


portfolio before change:  [11.51148709]
curr_Stock_Price:  101.52040255806062
curr_Factors:  [101.52040256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03667627]
Stock Position:  -0.036676266750448445
Bond Position:  [15.23487646]


portfolio before change:  [11.50066397]
curr_Stock_Price:  101.84146393937962
curr_Factors:  [101.84146394]
mat_Sqrt:  [[0.15]]
grads:  [0.05938893]
Stock Position:  0.05938893371427025
Bond Position:  [5.45240802]


portfolio before change:  [11.50523992]
curr_Stock_Price:  101.91277631617375
curr_Factors:  [101.91277632]
mat_Sqrt:  [[0.15]]
grads:  [0.17776503]
Stock Position:  0.1777650298851726
Bond Position:  [-6.61128781]


portfolio before change:  [11.54627441]
curr_Stock_Price:  102.14593640439524
curr_Factors:  [102.1459364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00420976]
Stock Position:  -0.004209756558104074
Bond Position:  [11.97628394]


portfolio before change:  [11.54966431]
curr_Stock_Price:  101.5184990708726
curr_Factors:  [101.51849907]
mat_Sqrt:  [[0.15]]
grads:  [0.0714027]
Stock Position:  0.07140269751350842
Bond Position:  [4.30096963]


portfolio before change:  [11.54971118]
curr_Stock_Price:  101.51539066108958
curr_Factors:  [101.51539066]
mat_Sqrt:  [[0.15]]
grads:  [-0.07862559]
Stock Position:  -0.07862559180574782
Bond Position:  [19.53141885]


portfolio before change:  [11.53372874]
curr_Stock_Price:  101.73418960276562
curr_Factors:  [101.7341896]
mat_Sqrt:  [[0.15]]
grads:  [0.05153774]
Stock Position:  0.051537743157761884
Bond Position:  [6.2905782]


portfolio before change:  [11.55806467]
curr_Stock_Price:  102.19875702905155
curr_Factors:  [102.19875703]
mat_Sqrt:  [[0.15]]
grads:  [0.05616982]
Stock Position:  0.056169821868206314
Bond Position:  [5.81757869]


portfolio before change:  [11.53334554]
curr_Stock_Price:  101.75220514291004
curr_Factors:  [101.75220514]
mat_Sqrt:  [[0.15]]
grads:  [0.07380753]
Stock Position:  0.07380753094811315
Bond Position:  [4.02326651]


portfolio before change:  [11.4985265]
curr_Stock_Price:  101.27704361971438
curr_Factors:  [101.27704362]
mat_Sqrt:  [[0.15]]
grads:  [0.05821785]
Stock Position:  0.058217852987971844
Bond Position:  [5.60239447]


portfolio before change:  [11.52958849]
curr_Stock_Price:  101.80457645758729
curr_Factors:  [101.80457646]
mat_Sqrt:  [[0.15]]
grads:  [-0.2244755]
Stock Position:  -0.2244755016942567
Bond Position:  [34.38222187]


portfolio before change:  [11.3215683]
curr_Stock_Price:  102.74084410049458
curr_Factors:  [102.7408441]
mat_Sqrt:  [[0.15]]
grads:  [0.06136917]
Stock Position:  0.06136917079302646
Bond Position:  [5.01644789]


portfolio before change:  [11.41230629]
curr_Stock_Price:  104.21429493909883
curr_Factors:  [104.21429494]
mat_Sqrt:  [[0.15]]
grads:  [0.08739294]
Stock Position:  0.08739293835020215
Bond Position:  [2.30471284]


portfolio before change:  [11.45193677]
curr_Stock_Price:  104.66612129174253
curr_Factors:  [104.66612129]
mat_Sqrt:  [[0.15]]
grads:  [0.00569309]
Stock Position:  0.005693086374893621
Bond Position:  [10.85606351]


portfolio before change:  [11.4530061]
curr_Stock_Price:  104.7347654735192
curr_Factors:  [104.73476547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03160248]
Stock Position:  -0.03160247535068882
Bond Position:  [14.76288394]


portfolio before change:  [11.44926274]
curr_Stock_Price:  104.88241427022224
curr_Factors:  [104.88241427]
mat_Sqrt:  [[0.15]]
grads:  [-0.09984117]
Stock Position:  -0.09984117232508016
Bond Position:  [21.92084594]


portfolio before change:  [11.52358152]
curr_Stock_Price:  104.15176695222777
curr_Factors:  [104.15176695]
mat_Sqrt:  [[0.15]]
grads:  [0.13676651]
Stock Position:  0.13676650605898338
Bond Position:  [-2.72089175]


portfolio before change:  [11.44849846]
curr_Stock_Price:  103.60402319421944
curr_Factors:  [103.60402319]
mat_Sqrt:  [[0.15]]
grads:  [-0.01359331]
Stock Position:  -0.01359331412779737
Bond Position:  [12.85682049]


portfolio before change:  [11.4496304]
curr_Stock_Price:  103.57986660717552
curr_Factors:  [103.57986661]
mat_Sqrt:  [[0.15]]
grads:  [0.03070626]
Stock Position:  0.030706257758666394
Bond Position:  [8.26908032]


portfolio before change:  [11.44798518]
curr_Stock_Price:  103.50945558847987
curr_Factors:  [103.50945559]
mat_Sqrt:  [[0.15]]
grads:  [-0.10991081]
Stock Position:  -0.10991080804414159
Bond Position:  [22.82479308]


portfolio before change:  [11.51269225]
curr_Stock_Price:  102.93371166924977
curr_Factors:  [102.93371167]
mat_Sqrt:  [[0.15]]
grads:  [0.0946758]
Stock Position:  0.09467579767474842
Bond Position:  [1.76736099]


portfolio before change:  [11.50717942]
curr_Stock_Price:  102.87431643761865
curr_Factors:  [102.87431644]
mat_Sqrt:  [[0.15]]
grads:  [0.02458739]
Stock Position:  0.024587393288980255
Bond Position:  [8.97776815]


portfolio before change:  [11.50809079]
curr_Stock_Price:  102.88856096294514
curr_Factors:  [102.88856096]
mat_Sqrt:  [[0.15]]
grads:  [0.01243735]
Stock Position:  0.012437354636821232
Bond Position:  [10.22842927]


portfolio before change:  [11.50048819]
curr_Stock_Price:  102.225888151032
curr_Factors:  [102.22588815]
mat_Sqrt:  [[0.15]]
grads:  [-0.04970509]
Stock Position:  -0.04970508528027402
Bond Position:  [16.58163468]


portfolio before change:  [11.5263679]
curr_Stock_Price:  101.72607357666152
curr_Factors:  [101.72607358]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973478]
Stock Position:  -0.08973478155425967
Bond Position:  [20.65473489]


portfolio before change:  [11.55149096]
curr_Stock_Price:  101.46048976433178
curr_Factors:  [101.46048976]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065725]
Stock Position:  -0.020657254328451648
Bond Position:  [13.64738611]


portfolio before change:  [11.54294931]
curr_Stock_Price:  101.91527637483561
curr_Factors:  [101.91527637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03641978]
Stock Position:  -0.036419777855950825
Bond Position:  [15.25468104]


portfolio before change:  [11.60160345]
curr_Stock_Price:  100.33095330712581
curr_Factors:  [100.33095331]
mat_Sqrt:  [[0.15]]
grads:  [0.03574857]
Stock Position:  0.03574857265455143
Bond Position:  [8.01491508]


portfolio before change:  [11.59814933]
curr_Stock_Price:  100.22031753904317
curr_Factors:  [100.22031754]
mat_Sqrt:  [[0.15]]
grads:  [0.03621559]
Stock Position:  0.03621559489753125
Bond Position:  [7.96861091]


portfolio before change:  [11.61325095]
curr_Stock_Price:  100.62355716613892
curr_Factors:  [100.62355717]
mat_Sqrt:  [[0.15]]
grads:  [-0.02395225]
Stock Position:  -0.023952251497395435
Bond Position:  [14.02341169]


portfolio before change:  [11.6238533]
curr_Stock_Price:  100.21750503495466
curr_Factors:  [100.21750503]
mat_Sqrt:  [[0.15]]
grads:  [0.03443759]
Stock Position:  0.03443759220624032
Bond Position:  [8.17260373]


portfolio before change:  [11.64176122]
curr_Stock_Price:  100.72268318389163
curr_Factors:  [100.72268318]
mat_Sqrt:  [[0.15]]
grads:  [-0.00242728]
Stock Position:  -0.002427282236586729
Bond Position:  [11.8862436]


portfolio before change:  [11.64077828]
curr_Stock_Price:  101.43370863835506
curr_Factors:  [101.43370864]
mat_Sqrt:  [[0.15]]
grads:  [0.01065395]
Stock Position:  0.010653945818853369
Bond Position:  [10.56010904]


portfolio before change:  [11.64240792]
curr_Stock_Price:  101.52471867287441
curr_Factors:  [101.52471867]
mat_Sqrt:  [[0.15]]
grads:  [0.09652757]
Stock Position:  0.09652757086588762
Bond Position:  [1.84247344]


portfolio before change:  [11.60523392]
curr_Stock_Price:  101.13841288051617
curr_Factors:  [101.13841288]
mat_Sqrt:  [[0.15]]
grads:  [0.00285794]
Stock Position:  0.0028579364178366678
Bond Position:  [11.31618676]


portfolio before change:  [11.60667732]
curr_Stock_Price:  101.39598378018185
curr_Factors:  [101.39598378]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366645]
Stock Position:  -0.036664504629146805
Bond Position:  [15.32431084]


portfolio before change:  [11.61657516]
curr_Stock_Price:  101.15215025512934
curr_Factors:  [101.15215026]
mat_Sqrt:  [[0.15]]
grads:  [-0.04393041]
Stock Position:  -0.04393041044670488
Bond Position:  [16.06023064]


portfolio before change:  [11.62020008]
curr_Stock_Price:  101.0924848954873
curr_Factors:  [101.0924849]
mat_Sqrt:  [[0.15]]
grads:  [-0.08767892]
Stock Position:  -0.08767891794446535
Bond Position:  [20.48387976]


portfolio before change:  [11.64484044]
curr_Stock_Price:  100.82605729756821
curr_Factors:  [100.8260573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04486769]
Stock Position:  -0.04486769450944427
Bond Position:  [16.16867318]


portfolio before change:  [11.66559162]
curr_Stock_Price:  100.3860835813241
curr_Factors:  [100.38608358]
mat_Sqrt:  [[0.15]]
grads:  [0.01166031]
Stock Position:  0.011660314508187183
Bond Position:  [10.49505832]


portfolio before change:  [11.66984179]
curr_Stock_Price:  100.69432574753154
curr_Factors:  [100.69432575]
mat_Sqrt:  [[0.15]]
grads:  [-0.03644228]
Stock Position:  -0.03644228025065341
Bond Position:  [15.33937262]


portfolio before change:  [11.66527238]
curr_Stock_Price:  100.84602172460279
curr_Factors:  [100.84602172]
mat_Sqrt:  [[0.15]]
grads:  [0.13905815]
Stock Position:  0.13905815429917315
Bond Position:  [-2.35818927]


portfolio before change:  [11.69202513]
curr_Stock_Price:  101.03946698834918
curr_Factors:  [101.03946699]
mat_Sqrt:  [[0.15]]
grads:  [-0.05475199]
Stock Position:  -0.054751994331007324
Bond Position:  [17.22413745]


portfolio before change:  [11.67512546]
curr_Stock_Price:  101.36778758853521
curr_Factors:  [101.36778759]
mat_Sqrt:  [[0.15]]
grads:  [0.06326939]
Stock Position:  0.06326939337177984
Bond Position:  [5.26164703]


portfolio before change:  [11.65616029]
curr_Stock_Price:  101.06283707470543
curr_Factors:  [101.06283707]
mat_Sqrt:  [[0.15]]
grads:  [-0.07368024]
Stock Position:  -0.0736802434197599
Bond Position:  [19.10249473]


portfolio before change:  [11.67519232]
curr_Stock_Price:  100.82073574469574
curr_Factors:  [100.82073574]
mat_Sqrt:  [[0.15]]
grads:  [0.073433]
Stock Position:  0.07343299570697076
Bond Position:  [4.27162367]


portfolio before change:  [11.70197055]
curr_Stock_Price:  101.18176206124957
curr_Factors:  [101.18176206]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454091]
Stock Position:  -0.0445409096628046
Bond Position:  [16.20869827]


portfolio before change:  [11.7155289]
curr_Stock_Price:  100.90010476824536
curr_Factors:  [100.90010477]
mat_Sqrt:  [[0.15]]
grads:  [0.11634576]
Stock Position:  0.1163457595813926
Bond Position:  [-0.02377043]


portfolio before change:  [11.75311529]
curr_Stock_Price:  101.22317527367974
curr_Factors:  [101.22317527]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990235]
Stock Position:  -0.14990234930899368
Bond Position:  [26.92670707]


portfolio before change:  [11.89581773]
curr_Stock_Price:  100.28243310465224
curr_Factors:  [100.2824331]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848313]
Stock Position:  -0.028483125148616076
Bond Position:  [14.75217482]


portfolio before change:  [11.900361]
curr_Stock_Price:  100.15529704299094
curr_Factors:  [100.15529704]
mat_Sqrt:  [[0.15]]
grads:  [-0.04711367]
Stock Position:  -0.04711367327938635
Bond Position:  [16.61904494]


portfolio before change:  [11.89764661]
curr_Stock_Price:  100.23495791699418
curr_Factors:  [100.23495792]
mat_Sqrt:  [[0.15]]
grads:  [-0.01258297]
Stock Position:  -0.012582971538557758
Bond Position:  [13.15890023]


portfolio before change:  [11.89774379]
curr_Stock_Price:  100.29259676473288
curr_Factors:  [100.29259676]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.89774379]
Stock Price:  100.90359849928936
PL:  [10.9941453]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.06193022e-03]
 [-1.90952204e-02]
 [-5.53749073e-03]
 [ 6.20618177e-03]
 [-6.86843287e-03]
 [ 1.20733571e-02]
 [ 5.53696596e-03]
 [-2.71859081e-02]
 [-2.38109358e-02]
 [ 3.61460988e-02]
 [-6.77632632e-02]
 [ 2.88535524e-02]
 [-1.25146193e-02]
 [ 2.66904543e-03]
 [-7.02029942e-03]
 [ 1.06326971e-02]
 [ 1.17145237e-02]
 [ 1.33222661e-02]
 [ 8.19440434e-04]
 [ 1.14546672e-02]
 [ 1.29185273e-02]
 [-1.09511386e-02]
 [ 1.14679263e-03]
 [-7.00308258e-02]
 [-1.27811612e-02]
 [ 3.38434659e-04]
 [ 4.16353773e-03]
 [ 1.35439018e-02]
 [-7.17738530e-02]
 [ 6.07764765e-03]
 [ 1.70379499e-02]
 [-1.19761265e-02]
 [-7.09589678e-03]
 [ 6.27221537e-03]
 [ 1.37496535e-02]
 [ 6.82118830e-03]
 [-3.08393113e-02]
 [ 7.96879080e-03]
 [-3.41160056e-02]
 [ 2.80541997e-03]
 [-1.11129425e-02]
 [ 3.39834878e-02]
 [ 2.31323563e-02]
 [ 4.13052373e-03]
 [ 4.35376138e-03]
 [ 7.50429494e-03]
 [ 2.59688566e-06]
 [-9.41149039e-03]
 [ 5.48141047e-03]
 [ 1.15012805e-03]
 [ 3.87465257e-02]
 [ 1.02276155e-03]
 [ 1.87310686e-03]
 [ 4.71346770e-03]
 [ 3.88605305e-03]
 [ 3.11715994e-03]
 [-7.27445622e-03]
 [-2.73353596e-04]
 [ 1.57024746e-03]
 [-6.27969254e-02]
 [-1.30077322e-02]
 [ 1.80202919e-02]
 [ 1.68559055e-02]
 [-1.95552893e-02]
 [-4.42056447e-03]
 [-1.96950407e-02]
 [-3.72662949e-03]
 [-6.87851048e-03]
 [-2.21341139e-02]
 [ 1.78792384e-02]
 [ 1.48087788e-02]
 [ 1.32221955e-02]
 [ 2.33508963e-03]
 [ 3.90953756e-03]
 [ 1.20914590e-02]
 [-1.86645817e-02]
 [ 4.96187896e-03]
 [ 7.67485133e-03]
 [-2.40370508e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.29393083]
curr_Stock_Price:  99.78310875670464
curr_Factors:  [99.78310876]
mat_Sqrt:  [[0.15]]
grads:  [0.02041287]
Stock Position:  0.02041286811146448
Bond Position:  [-3.33079027]


portfolio before change:  [-1.3118629]
curr_Stock_Price:  98.91483833441406
curr_Factors:  [98.91483833]
mat_Sqrt:  [[0.15]]
grads:  [-0.12730147]
Stock Position:  -0.12730146919368104
Bond Position:  [11.28014135]


portfolio before change:  [-1.27072595]
curr_Stock_Price:  98.597230729735
curr_Factors:  [98.59723073]
mat_Sqrt:  [[0.15]]
grads:  [-0.0369166]
Stock Position:  -0.03691660483749482
Bond Position:  [2.36914905]


portfolio before change:  [-1.27010543]
curr_Stock_Price:  98.58443293185549
curr_Factors:  [98.58443293]
mat_Sqrt:  [[0.15]]
grads:  [0.04137455]
Stock Position:  0.04137454512772637
Bond Position:  [-5.34899149]


portfolio before change:  [-1.29439546]
curr_Stock_Price:  98.00543643715075
curr_Factors:  [98.00543644]
mat_Sqrt:  [[0.15]]
grads:  [-0.04578955]
Stock Position:  -0.045789552498473766
Bond Position:  [3.19322961]


portfolio before change:  [-1.29702955]
curr_Stock_Price:  98.0673209800176
curr_Factors:  [98.06732098]
mat_Sqrt:  [[0.15]]
grads:  [0.08048905]
Stock Position:  0.0804890472729179
Bond Position:  [-9.19037478]


portfolio before change:  [-1.37631347]
curr_Stock_Price:  97.08943006458748
curr_Factors:  [97.08943006]
mat_Sqrt:  [[0.15]]
grads:  [0.03691311]
Stock Position:  0.03691310641324634
Bond Position:  [-4.96018593]


portfolio before change:  [-1.36368433]
curr_Stock_Price:  97.43996031978729
curr_Factors:  [97.43996032]
mat_Sqrt:  [[0.15]]
grads:  [-0.18123939]
Stock Position:  -0.1812393873382259
Bond Position:  [16.29627438]


portfolio before change:  [-1.38165023]
curr_Stock_Price:  97.5447082244859
curr_Factors:  [97.54470822]
mat_Sqrt:  [[0.15]]
grads:  [-0.15873957]
Stock Position:  -0.1587395722452389
Bond Position:  [14.10255503]


portfolio before change:  [-1.2990712]
curr_Stock_Price:  97.03004390853735
curr_Factors:  [97.03004391]
mat_Sqrt:  [[0.15]]
grads:  [0.24097399]
Stock Position:  0.24097399231860112
Bond Position:  [-24.68078825]


portfolio before change:  [-1.25113167]
curr_Stock_Price:  97.23538610861333
curr_Factors:  [97.23538611]
mat_Sqrt:  [[0.15]]
grads:  [-0.45175509]
Stock Position:  -0.45175508817655735
Bond Position:  [42.67544876]


portfolio before change:  [-1.41131404]
curr_Stock_Price:  97.59586831202695
curr_Factors:  [97.59586831]
mat_Sqrt:  [[0.15]]
grads:  [0.19235702]
Stock Position:  0.19235701609517547
Bond Position:  [-20.18456405]


portfolio before change:  [-1.396267]
curr_Stock_Price:  97.68065134582523
curr_Factors:  [97.68065135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0834308]
Stock Position:  -0.08343079514549759
Bond Position:  [6.75330741]


portfolio before change:  [-1.381161]
curr_Stock_Price:  97.50465032062866
curr_Factors:  [97.50465032]
mat_Sqrt:  [[0.15]]
grads:  [0.01779364]
Stock Position:  0.017793636174227835
Bond Position:  [-3.11612327]


portfolio before change:  [-1.37932828]
curr_Stock_Price:  97.61859437265171
curr_Factors:  [97.61859437]
mat_Sqrt:  [[0.15]]
grads:  [-0.046802]
Stock Position:  -0.046801996162955245
Bond Position:  [3.18941679]


portfolio before change:  [-1.36334716]
curr_Stock_Price:  97.28139128568984
curr_Factors:  [97.28139129]
mat_Sqrt:  [[0.15]]
grads:  [0.07088465]
Stock Position:  0.0708846476119903
Bond Position:  [-8.2591043]


portfolio before change:  [-1.35718292]
curr_Stock_Price:  97.37563527776939
curr_Factors:  [97.37563528]
mat_Sqrt:  [[0.15]]
grads:  [0.07809682]
Stock Position:  0.07809682471953738
Bond Position:  [-8.96191084]


portfolio before change:  [-1.40341098]
curr_Stock_Price:  96.79087499133934
curr_Factors:  [96.79087499]
mat_Sqrt:  [[0.15]]
grads:  [0.08881511]
Stock Position:  0.08881510758155085
Bond Position:  [-9.99990295]


portfolio before change:  [-1.4706463]
curr_Stock_Price:  96.04088651681987
curr_Factors:  [96.04088652]
mat_Sqrt:  [[0.15]]
grads:  [0.00546294]
Stock Position:  0.005462936223902077
Bond Position:  [-1.99531154]


portfolio before change:  [-1.46881972]
curr_Stock_Price:  96.39807360954273
curr_Factors:  [96.39807361]
mat_Sqrt:  [[0.15]]
grads:  [0.07636445]
Stock Position:  0.07636444780968017
Bond Position:  [-8.83020538]


portfolio before change:  [-1.44263732]
curr_Stock_Price:  96.74816202949619
curr_Factors:  [96.74816203]
mat_Sqrt:  [[0.15]]
grads:  [0.08612352]
Stock Position:  0.0861235156553687
Bond Position:  [-9.77492916]


portfolio before change:  [-1.48871382]
curr_Stock_Price:  96.22025099435149
curr_Factors:  [96.22025099]
mat_Sqrt:  [[0.15]]
grads:  [-0.07300759]
Stock Position:  -0.07300759095078198
Bond Position:  [5.5360949]


portfolio before change:  [-1.49157274]
curr_Stock_Price:  96.26414959387704
curr_Factors:  [96.26414959]
mat_Sqrt:  [[0.15]]
grads:  [0.00764528]
Stock Position:  0.00764528419679759
Bond Position:  [-2.22753952]


portfolio before change:  [-1.4926945]
curr_Stock_Price:  96.13563436125392
curr_Factors:  [96.13563436]
mat_Sqrt:  [[0.15]]
grads:  [-0.46687217]
Stock Position:  -0.4668721718209789
Bond Position:  [43.39035791]


portfolio before change:  [-1.37208116]
curr_Stock_Price:  95.88309980452937
curr_Factors:  [95.8830998]
mat_Sqrt:  [[0.15]]
grads:  [-0.08520774]
Stock Position:  -0.08520774114364064
Bond Position:  [6.79790119]


portfolio before change:  [-1.29734201]
curr_Stock_Price:  95.01094590723156
curr_Factors:  [95.01094591]
mat_Sqrt:  [[0.15]]
grads:  [0.00225623]
Stock Position:  0.002256231061218463
Bond Position:  [-1.51170866]


portfolio before change:  [-1.29812471]
curr_Stock_Price:  94.7059201298735
curr_Factors:  [94.70592013]
mat_Sqrt:  [[0.15]]
grads:  [0.02775692]
Stock Position:  0.02775691820657138
Bond Position:  [-3.92686919]


portfolio before change:  [-1.28815865]
curr_Stock_Price:  95.07381013726231
curr_Factors:  [95.07381014]
mat_Sqrt:  [[0.15]]
grads:  [0.09029268]
Stock Position:  0.0902926783942396
Bond Position:  [-9.87262761]


portfolio before change:  [-1.29310794]
curr_Stock_Price:  95.02583022998246
curr_Factors:  [95.02583023]
mat_Sqrt:  [[0.15]]
grads:  [-0.47849235]
Stock Position:  -0.4784923535034073
Bond Position:  [44.17602521]


portfolio before change:  [-1.47509371]
curr_Stock_Price:  95.41193222390984
curr_Factors:  [95.41193222]
mat_Sqrt:  [[0.15]]
grads:  [0.04051765]
Stock Position:  0.040517651008794155
Bond Position:  [-5.34096108]


portfolio before change:  [-1.49883418]
curr_Stock_Price:  94.83424198078916
curr_Factors:  [94.83424198]
mat_Sqrt:  [[0.15]]
grads:  [0.11358633]
Stock Position:  0.11358633257811701
Bond Position:  [-12.27070793]


portfolio before change:  [-1.39740371]
curr_Stock_Price:  95.73397536787806
curr_Factors:  [95.73397537]
mat_Sqrt:  [[0.15]]
grads:  [-0.07984084]
Stock Position:  -0.07984084361127353
Bond Position:  [6.24607765]


portfolio before change:  [-1.38228674]
curr_Stock_Price:  95.54952626035957
curr_Factors:  [95.54952626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04730598]
Stock Position:  -0.047305978521733835
Bond Position:  [3.13777709]


portfolio before change:  [-1.4040175]
curr_Stock_Price:  96.01303795534076
curr_Factors:  [96.01303796]
mat_Sqrt:  [[0.15]]
grads:  [0.04181477]
Stock Position:  0.041814769161494195
Bond Position:  [-5.41878052]


portfolio before change:  [-1.41653144]
curr_Stock_Price:  95.72186684182248
curr_Factors:  [95.72186684]
mat_Sqrt:  [[0.15]]
grads:  [0.09166436]
Stock Position:  0.09166435640839546
Bond Position:  [-10.19081476]


portfolio before change:  [-1.39985821]
curr_Stock_Price:  95.91070987979494
curr_Factors:  [95.91070988]
mat_Sqrt:  [[0.15]]
grads:  [0.04547459]
Stock Position:  0.045474588657808256
Bond Position:  [-5.76135829]


portfolio before change:  [-1.43125888]
curr_Stock_Price:  95.22811828086915
curr_Factors:  [95.22811828]
mat_Sqrt:  [[0.15]]
grads:  [-0.20559541]
Stock Position:  -0.20559540838565904
Bond Position:  [18.14720499]


portfolio before change:  [-1.53401072]
curr_Stock_Price:  95.73341206713705
curr_Factors:  [95.73341207]
mat_Sqrt:  [[0.15]]
grads:  [0.05312527]
Stock Position:  0.05312527202170153
Bond Position:  [-6.61987428]


portfolio before change:  [-1.50041771]
curr_Stock_Price:  96.37353613898725
curr_Factors:  [96.37353614]
mat_Sqrt:  [[0.15]]
grads:  [-0.22744004]
Stock Position:  -0.2274400373439263
Bond Position:  [20.41878295]


portfolio before change:  [-1.35682234]
curr_Stock_Price:  95.74779251077473
curr_Factors:  [95.74779251]
mat_Sqrt:  [[0.15]]
grads:  [0.0187028]
Stock Position:  0.018702799780287556
Bond Position:  [-3.14757414]


portfolio before change:  [-1.33768119]
curr_Stock_Price:  96.78174892331172
curr_Factors:  [96.78174892]
mat_Sqrt:  [[0.15]]
grads:  [-0.07408628]
Stock Position:  -0.07408628361228224
Bond Position:  [5.83251891]


portfolio before change:  [-1.33473159]
curr_Stock_Price:  96.74685643206742
curr_Factors:  [96.74685643]
mat_Sqrt:  [[0.15]]
grads:  [0.22655659]
Stock Position:  0.22655658532298212
Bond Position:  [-23.25336903]


portfolio before change:  [-1.27913469]
curr_Stock_Price:  96.99867117819485
curr_Factors:  [96.99867118]
mat_Sqrt:  [[0.15]]
grads:  [0.15421571]
Stock Position:  0.15421570887277075
Bond Position:  [-16.23785352]


portfolio before change:  [-1.32466893]
curr_Stock_Price:  96.70998889208674
curr_Factors:  [96.70998889]
mat_Sqrt:  [[0.15]]
grads:  [0.02753682]
Stock Position:  0.027536824896916164
Bond Position:  [-3.98775496]


portfolio before change:  [-1.32718052]
curr_Stock_Price:  96.62783153802268
curr_Factors:  [96.62783154]
mat_Sqrt:  [[0.15]]
grads:  [0.02902508]
Stock Position:  0.029025075897868235
Bond Position:  [-4.13181067]


portfolio before change:  [-1.33002525]
curr_Stock_Price:  96.53871960521076
curr_Factors:  [96.53871961]
mat_Sqrt:  [[0.15]]
grads:  [0.05002863]
Stock Position:  0.05002863291693226
Bond Position:  [-6.15972542]


portfolio before change:  [-1.34375294]
curr_Stock_Price:  96.27201838927049
curr_Factors:  [96.27201839]
mat_Sqrt:  [[0.15]]
grads:  [1.73125711e-05]
Stock Position:  1.7312571070823384e-05
Bond Position:  [-1.34541966]


portfolio before change:  [-1.34384739]
curr_Stock_Price:  95.67390236310578
curr_Factors:  [95.67390236]
mat_Sqrt:  [[0.15]]
grads:  [-0.06274327]
Stock Position:  -0.06274326926464527
Bond Position:  [4.65904603]


portfolio before change:  [-1.37915203]
curr_Stock_Price:  96.24122761144429
curr_Factors:  [96.24122761]
mat_Sqrt:  [[0.15]]
grads:  [0.03654274]
Stock Position:  0.03654273647247519
Bond Position:  [-4.89606985]


portfolio before change:  [-1.36415372]
curr_Stock_Price:  96.66003382924532
curr_Factors:  [96.66003383]
mat_Sqrt:  [[0.15]]
grads:  [0.00766752]
Stock Position:  0.0076675203298814595
Bond Position:  [-2.10529649]


portfolio before change:  [-1.36664204]
curr_Stock_Price:  96.35266771436197
curr_Factors:  [96.35266771]
mat_Sqrt:  [[0.15]]
grads:  [0.25831017]
Stock Position:  0.2583101714827437
Bond Position:  [-26.25551616]


portfolio before change:  [-1.47896781]
curr_Stock_Price:  95.92417220768331
curr_Factors:  [95.92417221]
mat_Sqrt:  [[0.15]]
grads:  [0.00681841]
Stock Position:  0.006818410344585693
Bond Position:  [-2.13301818]


portfolio before change:  [-1.47759071]
curr_Stock_Price:  96.14569200511895
curr_Factors:  [96.14569201]
mat_Sqrt:  [[0.15]]
grads:  [0.01248738]
Stock Position:  0.012487379057496781
Bond Position:  [-2.67819841]


portfolio before change:  [-1.48690397]
curr_Stock_Price:  95.41328308366683
curr_Factors:  [95.41328308]
mat_Sqrt:  [[0.15]]
grads:  [0.03142312]
Stock Position:  0.03142311797231425
Bond Position:  [-4.48508682]


portfolio before change:  [-1.46085902]
curr_Stock_Price:  96.25105096638627
curr_Factors:  [96.25105097]
mat_Sqrt:  [[0.15]]
grads:  [0.02590702]
Stock Position:  0.025907020357421408
Bond Position:  [-3.95443696]


portfolio before change:  [-1.47123437]
curr_Stock_Price:  95.86010702786844
curr_Factors:  [95.86010703]
mat_Sqrt:  [[0.15]]
grads:  [0.02078107]
Stock Position:  0.0207810662997423
Bond Position:  [-3.46330961]


portfolio before change:  [-1.47096073]
curr_Stock_Price:  95.88369125175299
curr_Factors:  [95.88369125]
mat_Sqrt:  [[0.15]]
grads:  [-0.04849637]
Stock Position:  -0.048496374796853495
Bond Position:  [3.1790507]


portfolio before change:  [-1.46758023]
curr_Stock_Price:  95.81808218995567
curr_Factors:  [95.81808219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00182236]
Stock Position:  -0.0018223573086624187
Bond Position:  [-1.29296545]


portfolio before change:  [-1.46732297]
curr_Stock_Price:  95.63256757804817
curr_Factors:  [95.63256758]
mat_Sqrt:  [[0.15]]
grads:  [0.01046832]
Stock Position:  0.010468316407725721
Bond Position:  [-2.46843495]


portfolio before change:  [-1.47444979]
curr_Stock_Price:  94.96650679783261
curr_Factors:  [94.9665068]
mat_Sqrt:  [[0.15]]
grads:  [-0.41864617]
Stock Position:  -0.4186461693901935
Bond Position:  [38.2829145]


portfolio before change:  [-1.23661303]
curr_Stock_Price:  94.40411302222402
curr_Factors:  [94.40411302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08671821]
Stock Position:  -0.08671821448709338
Bond Position:  [6.94994309]


portfolio before change:  [-1.24790218]
curr_Stock_Price:  94.53930418851104
curr_Factors:  [94.53930419]
mat_Sqrt:  [[0.15]]
grads:  [0.12013528]
Stock Position:  0.12013527909642277
Bond Position:  [-12.60540788]


portfolio before change:  [-1.28720682]
curr_Stock_Price:  94.21869254345522
curr_Factors:  [94.21869254]
mat_Sqrt:  [[0.15]]
grads:  [0.1123727]
Stock Position:  0.1123727031973223
Bond Position:  [-11.87481599]


portfolio before change:  [-1.29789416]
curr_Stock_Price:  94.13019114275384
curr_Factors:  [94.13019114]
mat_Sqrt:  [[0.15]]
grads:  [-0.1303686]
Stock Position:  -0.13036859552621777
Bond Position:  [10.97372666]


portfolio before change:  [-1.26028884]
curr_Stock_Price:  93.84699843271311
curr_Factors:  [93.84699843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947043]
Stock Position:  -0.029470429777576867
Bond Position:  [1.50542254]


portfolio before change:  [-1.26465819]
curr_Stock_Price:  93.99845343073497
curr_Factors:  [93.99845343]
mat_Sqrt:  [[0.15]]
grads:  [-0.13130027]
Stock Position:  -0.1313002712365855
Bond Position:  [11.07736424]


portfolio before change:  [-1.17887028]
curr_Stock_Price:  93.35035457995265
curr_Factors:  [93.35035458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248442]
Stock Position:  -0.024844196612818014
Bond Position:  [1.14034428]


portfolio before change:  [-1.17543918]
curr_Stock_Price:  93.21511877540132
curr_Factors:  [93.21511878]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585674]
Stock Position:  -0.04585673651499071
Bond Position:  [3.09910196]


portfolio before change:  [-1.14462719]
curr_Stock_Price:  92.54742425034691
curr_Factors:  [92.54742425]
mat_Sqrt:  [[0.15]]
grads:  [-0.14756076]
Stock Position:  -0.14756075908111474
Bond Position:  [12.51174098]


portfolio before change:  [-1.01828474]
curr_Stock_Price:  91.69651749318223
curr_Factors:  [91.69651749]
mat_Sqrt:  [[0.15]]
grads:  [0.11919492]
Stock Position:  0.11919492242039094
Bond Position:  [-11.94804403]


portfolio before change:  [-0.92313793]
curr_Stock_Price:  92.50102812468901
curr_Factors:  [92.50102812]
mat_Sqrt:  [[0.15]]
grads:  [0.09872519]
Stock Position:  0.0987251918735213
Bond Position:  [-10.05531968]


portfolio before change:  [-0.94275588]
curr_Stock_Price:  92.3086813906725
curr_Factors:  [92.30868139]
mat_Sqrt:  [[0.15]]
grads:  [0.08814797]
Stock Position:  0.08814797021032508
Bond Position:  [-9.07957877]


portfolio before change:  [-0.90291799]
curr_Stock_Price:  92.76706265744663
curr_Factors:  [92.76706266]
mat_Sqrt:  [[0.15]]
grads:  [0.01556726]
Stock Position:  0.015567264201883167
Bond Position:  [-2.34704736]


portfolio before change:  [-0.88664253]
curr_Stock_Price:  93.82197823229725
curr_Factors:  [93.82197823]
mat_Sqrt:  [[0.15]]
grads:  [0.02606358]
Stock Position:  0.026063583704834827
Bond Position:  [-3.33197952]


portfolio before change:  [-0.87702445]
curr_Stock_Price:  94.19899255817745
curr_Factors:  [94.19899256]
mat_Sqrt:  [[0.15]]
grads:  [0.08060973]
Stock Position:  0.0806097269009694
Bond Position:  [-8.47037951]


portfolio before change:  [-0.84737796]
curr_Stock_Price:  94.57333821226385
curr_Factors:  [94.57333821]
mat_Sqrt:  [[0.15]]
grads:  [-0.12443054]
Stock Position:  -0.12443054433616733
Bond Position:  [10.92043399]


portfolio before change:  [-0.82856323]
curr_Stock_Price:  94.42761687612321
curr_Factors:  [94.42761688]
mat_Sqrt:  [[0.15]]
grads:  [0.03307919]
Stock Position:  0.03307919306579914
Bond Position:  [-3.9521526]


portfolio before change:  [-0.83477774]
curr_Stock_Price:  94.24721656529192
curr_Factors:  [94.24721657]
mat_Sqrt:  [[0.15]]
grads:  [0.05116568]
Stock Position:  0.051165675558270535
Bond Position:  [-5.65700024]


portfolio before change:  [-0.81216781]
curr_Stock_Price:  94.69602332991819
curr_Factors:  [94.69602333]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.81216781]
Stock Price:  94.27147303918855
PL:  [-0.81216781]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.96179445e-03]
 [-2.12273769e-02]
 [-1.83685608e-03]
 [ 6.41942920e-03]
 [-8.01931491e-04]
 [ 1.72597122e-02]
 [ 1.87983526e-03]
 [-1.94208699e-02]
 [-2.08938867e-03]
 [ 2.57737156e-02]
 [ 1.58132066e-03]
 [ 2.21735961e-02]
 [-1.35780582e-02]
 [ 7.14575877e-03]
 [-6.92520110e-03]
 [ 6.72389888e-03]
 [ 7.28940485e-03]
 [-1.16579328e-02]
 [-5.19337407e-04]
 [ 1.39701570e-02]
 [ 1.14906055e-02]
 [-8.06402636e-03]
 [ 7.34073082e-03]
 [ 1.59667541e-02]
 [-8.08352028e-03]
 [ 8.95836949e-03]
 [-7.14347760e-03]
 [ 5.93216177e-03]
 [-1.24145462e-02]
 [-1.32472738e-03]
 [-8.73619896e-04]
 [-1.01691629e-02]
 [-8.79349062e-03]
 [ 5.69097309e-03]
 [ 1.37835647e-02]
 [ 1.11819190e-02]
 [-3.35043799e-02]
 [ 8.49690945e-03]
 [-2.36394289e-02]
 [ 1.98889374e-02]
 [-5.08963765e-03]
 [-2.06327931e-03]
 [ 2.33557887e-02]
 [ 4.34845789e-03]
 [-8.17869016e-03]
 [-4.83923057e-03]
 [ 7.88612374e-03]
 [-1.23135713e-02]
 [-1.52464318e-02]
 [-7.66745410e-03]
 [-2.38640051e-03]
 [-7.15742734e-03]
 [-5.62936894e-04]
 [ 5.29949875e-03]
 [ 4.42818007e-03]
 [-1.36922547e-03]
 [ 4.07450768e-03]
 [-3.66178153e-04]
 [ 1.55568934e-03]
 [-6.42542341e-03]
 [ 1.19449169e-03]
 [ 1.45049070e-03]
 [ 3.19783776e-03]
 [-1.80774177e-02]
 [-1.11540148e-02]
 [-1.11441515e-02]
 [-4.62270765e-03]
 [ 7.80472781e-03]
 [-1.51488529e-02]
 [ 1.19876443e-02]
 [ 3.72715258e-03]
 [ 1.20198892e-02]
 [ 8.70500831e-04]
 [ 8.72537666e-04]
 [-1.69672416e-03]
 [-1.58015439e-02]
 [ 3.99778082e-03]
 [ 4.13233023e-03]
 [-6.32048683e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.33576549]
curr_Stock_Price:  99.26018878829674
curr_Factors:  [99.26018879]
mat_Sqrt:  [[0.15]]
grads:  [0.0397453]
Stock Position:  0.03974529634045882
Bond Position:  [-13.28089111]


portfolio before change:  [-9.35304817]
curr_Stock_Price:  98.84623792449449
curr_Factors:  [98.84623792]
mat_Sqrt:  [[0.15]]
grads:  [-0.14151585]
Stock Position:  -0.14151584618591845
Bond Position:  [4.63526083]


portfolio before change:  [-9.40528816]
curr_Stock_Price:  99.21743101538185
curr_Factors:  [99.21743102]
mat_Sqrt:  [[0.15]]
grads:  [-0.01224571]
Stock Position:  -0.012245707194793136
Bond Position:  [-8.19030056]


portfolio before change:  [-9.39895879]
curr_Stock_Price:  98.6587634166282
curr_Factors:  [98.65876342]
mat_Sqrt:  [[0.15]]
grads:  [0.04279619]
Stock Position:  0.04279619463606502
Bond Position:  [-13.62117844]


portfolio before change:  [-9.39256097]
curr_Stock_Price:  98.82815161730676
curr_Factors:  [98.82815162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534621]
Stock Position:  -0.005346209937480983
Bond Position:  [-8.86420493]


portfolio before change:  [-9.39346267]
curr_Stock_Price:  98.89318214979846
curr_Factors:  [98.89318215]
mat_Sqrt:  [[0.15]]
grads:  [0.11506475]
Stock Position:  0.11506474768990117
Bond Position:  [-20.77258172]


portfolio before change:  [-9.41051812]
curr_Stock_Price:  98.75624080354696
curr_Factors:  [98.7562408]
mat_Sqrt:  [[0.15]]
grads:  [0.01253224]
Stock Position:  0.01253223507292022
Bond Position:  [-10.64815454]


portfolio before change:  [-9.41014564]
curr_Stock_Price:  98.83906831128101
curr_Factors:  [98.83906831]
mat_Sqrt:  [[0.15]]
grads:  [-0.12947247]
Stock Position:  -0.12947246571217316
Bond Position:  [3.38679225]


portfolio before change:  [-9.37322289]
curr_Stock_Price:  98.55552492984627
curr_Factors:  [98.55552493]
mat_Sqrt:  [[0.15]]
grads:  [-0.01392926]
Stock Position:  -0.013929257826995936
Bond Position:  [-8.00041758]


portfolio before change:  [-9.36971693]
curr_Stock_Price:  98.26792872639446
curr_Factors:  [98.26792873]
mat_Sqrt:  [[0.15]]
grads:  [0.17182477]
Stock Position:  0.17182477062760484
Bond Position:  [-26.25458125]


portfolio before change:  [-9.30801955]
curr_Stock_Price:  98.636550468773
curr_Factors:  [98.63655047]
mat_Sqrt:  [[0.15]]
grads:  [0.01054214]
Stock Position:  0.010542137738408624
Bond Position:  [-10.34785965]


portfolio before change:  [-9.30889396]
curr_Stock_Price:  98.61495605372816
curr_Factors:  [98.61495605]
mat_Sqrt:  [[0.15]]
grads:  [0.14782397]
Stock Position:  0.14782397416879728
Bond Position:  [-23.88654868]


portfolio before change:  [-9.25363769]
curr_Stock_Price:  98.9988533741844
curr_Factors:  [98.99885337]
mat_Sqrt:  [[0.15]]
grads:  [-0.09052039]
Stock Position:  -0.09052038820967936
Bond Position:  [-0.29222305]


portfolio before change:  [-9.2254126]
curr_Stock_Price:  98.68684234519577
curr_Factors:  [98.68684235]
mat_Sqrt:  [[0.15]]
grads:  [0.04763839]
Stock Position:  0.047638391785200705
Bond Position:  [-13.92669506]


portfolio before change:  [-9.19105496]
curr_Stock_Price:  99.4263317171954
curr_Factors:  [99.42633172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04616801]
Stock Position:  -0.046168007312711645
Bond Position:  [-4.60073935]


portfolio before change:  [-9.17040925]
curr_Stock_Price:  98.97291681208955
curr_Factors:  [98.97291681]
mat_Sqrt:  [[0.15]]
grads:  [0.04482599]
Stock Position:  0.0448259925529197
Bond Position:  [-13.60696848]


portfolio before change:  [-9.14758659]
curr_Stock_Price:  99.5010282640545
curr_Factors:  [99.50102826]
mat_Sqrt:  [[0.15]]
grads:  [0.04859603]
Stock Position:  0.04859603234065684
Bond Position:  [-13.98294178]


portfolio before change:  [-9.15991312]
curr_Stock_Price:  99.26535951513988
curr_Factors:  [99.26535952]
mat_Sqrt:  [[0.15]]
grads:  [-0.07771955]
Stock Position:  -0.07771955211869372
Bond Position:  [-1.44505384]


portfolio before change:  [-9.19145337]
curr_Stock_Price:  99.67001876019448
curr_Factors:  [99.67001876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00346225]
Stock Position:  -0.0034622493808282007
Bond Position:  [-8.84637091]


portfolio before change:  [-9.19259044]
curr_Stock_Price:  99.83873727921362
curr_Factors:  [99.83873728]
mat_Sqrt:  [[0.15]]
grads:  [0.09313438]
Stock Position:  0.09313438023466694
Bond Position:  [-18.49100936]


portfolio before change:  [-9.22823356]
curr_Stock_Price:  99.46844010192909
curr_Factors:  [99.4684401]
mat_Sqrt:  [[0.15]]
grads:  [0.07660404]
Stock Position:  0.0766040369564563
Bond Position:  [-16.84791762]


portfolio before change:  [-9.20304277]
curr_Stock_Price:  99.81103064672153
curr_Factors:  [99.81103065]
mat_Sqrt:  [[0.15]]
grads:  [-0.05376018]
Stock Position:  -0.0537601757048684
Bond Position:  [-3.83718422]


portfolio before change:  [-9.13796894]
curr_Stock_Price:  98.59612285606005
curr_Factors:  [98.59612286]
mat_Sqrt:  [[0.15]]
grads:  [0.04893821]
Stock Position:  0.04893820549636941
Bond Position:  [-13.96308626]


portfolio before change:  [-9.12597203]
curr_Stock_Price:  98.85910007982577
curr_Factors:  [98.85910008]
mat_Sqrt:  [[0.15]]
grads:  [0.10644503]
Stock Position:  0.10644502748288792
Bond Position:  [-19.64903165]


portfolio before change:  [-9.14003578]
curr_Stock_Price:  98.73851532230177
curr_Factors:  [98.73851532]
mat_Sqrt:  [[0.15]]
grads:  [-0.05389014]
Stock Position:  -0.053890135215583654
Bond Position:  [-3.81900384]


portfolio before change:  [-9.19628178]
curr_Stock_Price:  99.77780202852091
curr_Factors:  [99.77780203]
mat_Sqrt:  [[0.15]]
grads:  [0.05972246]
Stock Position:  0.05972246324586051
Bond Position:  [-15.15525789]


portfolio before change:  [-9.19994967]
curr_Stock_Price:  99.73224696560405
curr_Factors:  [99.73224697]
mat_Sqrt:  [[0.15]]
grads:  [-0.04762318]
Stock Position:  -0.04762318399837074
Bond Position:  [-4.45038252]


portfolio before change:  [-9.19232197]
curr_Stock_Price:  99.56623843632184
curr_Factors:  [99.56623844]
mat_Sqrt:  [[0.15]]
grads:  [0.03954775]
Stock Position:  0.039547745107328995
Bond Position:  [-13.12994219]


portfolio before change:  [-9.21275828]
curr_Stock_Price:  99.07023886348858
curr_Factors:  [99.07023886]
mat_Sqrt:  [[0.15]]
grads:  [-0.08276364]
Stock Position:  -0.08276364155010932
Bond Position:  [-1.01334455]


portfolio before change:  [-9.20333835]
curr_Stock_Price:  98.95565631590983
curr_Factors:  [98.95565632]
mat_Sqrt:  [[0.15]]
grads:  [-0.00883152]
Stock Position:  -0.008831515863334943
Bond Position:  [-8.3294099]


portfolio before change:  [-9.19529346]
curr_Stock_Price:  97.98577762528996
curr_Factors:  [97.98577763]
mat_Sqrt:  [[0.15]]
grads:  [-0.00582413]
Stock Position:  -0.0058241326412164915
Bond Position:  [-8.62461129]


portfolio before change:  [-9.19689043]
curr_Stock_Price:  98.16742242915853
curr_Factors:  [98.16742243]
mat_Sqrt:  [[0.15]]
grads:  [-0.06779442]
Stock Position:  -0.06779441905935223
Bond Position:  [-2.54168706]


portfolio before change:  [-9.14355748]
curr_Stock_Price:  97.37839265359561
curr_Factors:  [97.37839265]
mat_Sqrt:  [[0.15]]
grads:  [-0.05862327]
Stock Position:  -0.05862327078193228
Bond Position:  [-3.4349176]


portfolio before change:  [-9.10704468]
curr_Stock_Price:  96.75189255293967
curr_Factors:  [96.75189255]
mat_Sqrt:  [[0.15]]
grads:  [0.03793982]
Stock Position:  0.03793982057340652
Bond Position:  [-12.77779413]


portfolio before change:  [-9.09975308]
curr_Stock_Price:  96.96513141946492
curr_Factors:  [96.96513142]
mat_Sqrt:  [[0.15]]
grads:  [0.09189043]
Stock Position:  0.09189043110833411
Bond Position:  [-18.00992081]


portfolio before change:  [-9.11781462]
curr_Stock_Price:  96.78082623167208
curr_Factors:  [96.78082623]
mat_Sqrt:  [[0.15]]
grads:  [0.07454613]
Stock Position:  0.074546126461767
Bond Position:  [-16.33245033]


portfolio before change:  [-9.13411592]
curr_Stock_Price:  96.57584586762981
curr_Factors:  [96.57584587]
mat_Sqrt:  [[0.15]]
grads:  [-0.22336253]
Stock Position:  -0.22336253260196015
Bond Position:  [12.4373096]


portfolio before change:  [-9.25419304]
curr_Stock_Price:  97.11691458437058
curr_Factors:  [97.11691458]
mat_Sqrt:  [[0.15]]
grads:  [0.05664606]
Stock Position:  0.05664606303084934
Bond Position:  [-14.7554839]


portfolio before change:  [-9.22299563]
curr_Stock_Price:  97.68393828580366
curr_Factors:  [97.68393829]
mat_Sqrt:  [[0.15]]
grads:  [-0.15759619]
Stock Position:  -0.15759619280524723
Bond Position:  [6.17162115]


portfolio before change:  [-9.25719318]
curr_Stock_Price:  97.90338070273575
curr_Factors:  [97.9033807]
mat_Sqrt:  [[0.15]]
grads:  [0.13259292]
Stock Position:  0.1325929162410784
Bond Position:  [-22.23848793]


portfolio before change:  [-9.17701937]
curr_Stock_Price:  98.51852482016902
curr_Factors:  [98.51852482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03393092]
Stock Position:  -0.03393091763762849
Bond Position:  [-5.83419542]


portfolio before change:  [-9.2036746]
curr_Stock_Price:  99.29335149216912
curr_Factors:  [99.29335149]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137552]
Stock Position:  -0.013755195392257438
Bond Position:  [-7.83787515]


portfolio before change:  [-9.20643348]
curr_Stock_Price:  99.45830722223234
curr_Factors:  [99.45830722]
mat_Sqrt:  [[0.15]]
grads:  [0.15570526]
Stock Position:  0.15570525791061204
Bond Position:  [-24.69261486]


portfolio before change:  [-9.28400193]
curr_Stock_Price:  98.97004424154377
curr_Factors:  [98.97004424]
mat_Sqrt:  [[0.15]]
grads:  [0.02898972]
Stock Position:  0.02898971928625489
Bond Position:  [-12.15311573]


portfolio before change:  [-9.2660715]
curr_Stock_Price:  99.61475651644325
curr_Factors:  [99.61475652]
mat_Sqrt:  [[0.15]]
grads:  [-0.0545246]
Stock Position:  -0.05452460104567752
Bond Position:  [-3.83461664]


portfolio before change:  [-9.26093412]
curr_Stock_Price:  99.51613961571834
curr_Factors:  [99.51613962]
mat_Sqrt:  [[0.15]]
grads:  [-0.03226154]
Stock Position:  -0.03226153711178639
Bond Position:  [-6.05039049]


portfolio before change:  [-9.28892216]
curr_Stock_Price:  100.37195372918288
curr_Factors:  [100.37195373]
mat_Sqrt:  [[0.15]]
grads:  [0.05257416]
Stock Position:  0.052574158257965416
Bond Position:  [-14.56589314]


portfolio before change:  [-9.32345973]
curr_Stock_Price:  99.73233964116106
curr_Factors:  [99.73233964]
mat_Sqrt:  [[0.15]]
grads:  [-0.08209048]
Stock Position:  -0.0820904756526998
Bond Position:  [-1.13638453]


portfolio before change:  [-9.34620428]
curr_Stock_Price:  100.00854122089788
curr_Factors:  [100.00854122]
mat_Sqrt:  [[0.15]]
grads:  [-0.10164288]
Stock Position:  -0.101642878558269
Bond Position:  [0.81895173]


portfolio before change:  [-9.4136333]
curr_Stock_Price:  100.67243629160711
curr_Factors:  [100.67243629]
mat_Sqrt:  [[0.15]]
grads:  [-0.05111636]
Stock Position:  -0.051116360641020354
Bond Position:  [-4.26762474]


portfolio before change:  [-9.45316924]
curr_Stock_Price:  101.44066803870007
curr_Factors:  [101.44066804]
mat_Sqrt:  [[0.15]]
grads:  [-0.01590934]
Stock Position:  -0.015909336707685958
Bond Position:  [-7.8393155]


portfolio before change:  [-9.44588206]
curr_Stock_Price:  100.95182553111641
curr_Factors:  [100.95182553]
mat_Sqrt:  [[0.15]]
grads:  [-0.04771618]
Stock Position:  -0.04771618226950964
Bond Position:  [-4.62884635]


portfolio before change:  [-9.4477677]
curr_Stock_Price:  100.98528025748406
curr_Factors:  [100.98528026]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375291]
Stock Position:  -0.003752912624812799
Bond Position:  [-9.06877877]


portfolio before change:  [-9.44909004]
curr_Stock_Price:  101.1865963592374
curr_Factors:  [101.18659636]
mat_Sqrt:  [[0.15]]
grads:  [0.03532999]
Stock Position:  0.03532999168084567
Bond Position:  [-13.02401164]


portfolio before change:  [-9.45787693]
curr_Stock_Price:  100.9609279277836
curr_Factors:  [100.96092793]
mat_Sqrt:  [[0.15]]
grads:  [0.0295212]
Stock Position:  0.02952120047181917
Bond Position:  [-12.43836472]


portfolio before change:  [-9.45192611]
curr_Stock_Price:  101.18884000353907
curr_Factors:  [101.18884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912817]
Stock Position:  -0.009128169806422113
Bond Position:  [-8.5282572]


portfolio before change:  [-9.44880487]
curr_Stock_Price:  100.78851118928328
curr_Factors:  [100.78851119]
mat_Sqrt:  [[0.15]]
grads:  [0.02716338]
Stock Position:  0.02716338451756103
Bond Position:  [-12.18656196]


portfolio before change:  [-9.45115208]
curr_Stock_Price:  100.73014131154686
curr_Factors:  [100.73014131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00244119]
Stock Position:  -0.002441187687840806
Bond Position:  [-9.2052509]


portfolio before change:  [-9.45163396]
curr_Stock_Price:  100.69185212027195
curr_Factors:  [100.69185212]
mat_Sqrt:  [[0.15]]
grads:  [0.01037126]
Stock Position:  0.010371262234982245
Bond Position:  [-10.49593556]


portfolio before change:  [-9.46161376]
curr_Stock_Price:  99.79285023487685
curr_Factors:  [99.79285023]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283616]
Stock Position:  -0.042836156053285626
Bond Position:  [-5.18687165]


portfolio before change:  [-9.41511674]
curr_Stock_Price:  98.69982005625978
curr_Factors:  [98.69982006]
mat_Sqrt:  [[0.15]]
grads:  [0.00796328]
Stock Position:  0.00796327793633335
Bond Position:  [-10.20109084]


portfolio before change:  [-9.42085729]
curr_Stock_Price:  98.05900746313829
curr_Factors:  [98.05900746]
mat_Sqrt:  [[0.15]]
grads:  [0.00966994]
Stock Position:  0.009669937998848927
Bond Position:  [-10.36908182]


portfolio before change:  [-9.41548169]
curr_Stock_Price:  98.68193752960697
curr_Factors:  [98.68193753]
mat_Sqrt:  [[0.15]]
grads:  [0.02131892]
Stock Position:  0.021318918416782368
Bond Position:  [-11.51927386]


portfolio before change:  [-9.43199323]
curr_Stock_Price:  97.94120744494845
curr_Factors:  [97.94120744]
mat_Sqrt:  [[0.15]]
grads:  [-0.12051612]
Stock Position:  -0.12051611779710597
Bond Position:  [2.37150087]


portfolio before change:  [-9.45659765]
curr_Stock_Price:  98.14659612182379
curr_Factors:  [98.14659612]
mat_Sqrt:  [[0.15]]
grads:  [-0.0743601]
Stock Position:  -0.07436009852019937
Bond Position:  [-2.15840709]


portfolio before change:  [-9.36314673]
curr_Stock_Price:  96.8880472314271
curr_Factors:  [96.88804723]
mat_Sqrt:  [[0.15]]
grads:  [-0.07429434]
Stock Position:  -0.07429434362403518
Bond Position:  [-2.16491286]


portfolio before change:  [-9.3108244]
curr_Stock_Price:  96.18196865872477
curr_Factors:  [96.18196866]
mat_Sqrt:  [[0.15]]
grads:  [-0.03081805]
Stock Position:  -0.03081805100102508
Bond Position:  [-6.34668359]


portfolio before change:  [-9.3024498]
curr_Stock_Price:  95.89735352641739
curr_Factors:  [95.89735353]
mat_Sqrt:  [[0.15]]
grads:  [0.05203152]
Stock Position:  0.05203151874305299
Bond Position:  [-14.29213475]


portfolio before change:  [-9.33355136]
curr_Stock_Price:  95.3167769768245
curr_Factors:  [95.31677698]
mat_Sqrt:  [[0.15]]
grads:  [-0.10099235]
Stock Position:  -0.10099235283505002
Bond Position:  [0.29271421]


portfolio before change:  [-9.33378949]
curr_Stock_Price:  95.31931603817625
curr_Factors:  [95.31931604]
mat_Sqrt:  [[0.15]]
grads:  [0.07991763]
Stock Position:  0.07991762837481642
Bond Position:  [-16.95148317]


portfolio before change:  [-9.33653402]
curr_Stock_Price:  95.29823155748967
curr_Factors:  [95.29823156]
mat_Sqrt:  [[0.15]]
grads:  [0.02484768]
Stock Position:  0.024847683871162055
Bond Position:  [-11.70447435]


portfolio before change:  [-9.32552892]
curr_Stock_Price:  95.77057541315679
curr_Factors:  [95.77057541]
mat_Sqrt:  [[0.15]]
grads:  [0.08013259]
Stock Position:  0.08013259438521966
Bond Position:  [-16.99987359]


portfolio before change:  [-9.25015383]
curr_Stock_Price:  96.7244645981966
curr_Factors:  [96.7244646]
mat_Sqrt:  [[0.15]]
grads:  [0.00580334]
Stock Position:  0.005803338871114473
Bond Position:  [-9.81147867]


portfolio before change:  [-9.254108]
curr_Stock_Price:  96.14877315664066
curr_Factors:  [96.14877316]
mat_Sqrt:  [[0.15]]
grads:  [0.00581692]
Stock Position:  0.005816917770898502
Bond Position:  [-9.81339751]


portfolio before change:  [-9.2545308]
curr_Stock_Price:  96.18153137961377
curr_Factors:  [96.18153138]
mat_Sqrt:  [[0.15]]
grads:  [-0.01131149]
Stock Position:  -0.011311494391345208
Bond Position:  [-8.16657395]


portfolio before change:  [-9.24744813]
curr_Stock_Price:  95.51025804236876
curr_Factors:  [95.51025804]
mat_Sqrt:  [[0.15]]
grads:  [-0.10534363]
Stock Position:  -0.10534362568917155
Bond Position:  [0.81394875]


portfolio before change:  [-9.37859793]
curr_Stock_Price:  96.75571240111586
curr_Factors:  [96.7557124]
mat_Sqrt:  [[0.15]]
grads:  [0.02665187]
Stock Position:  0.02665187213164489
Bond Position:  [-11.9573188]


portfolio before change:  [-9.37393626]
curr_Stock_Price:  96.95866342625062
curr_Factors:  [96.95866343]
mat_Sqrt:  [[0.15]]
grads:  [0.02754887]
Stock Position:  0.027548868176529413
Bond Position:  [-12.0450377]


portfolio before change:  [-9.37885485]
curr_Stock_Price:  96.80745031916773
curr_Factors:  [96.80745032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.37885485]
Stock Price:  96.45980214117095
PL:  [-9.37885485]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.86149531e-04]
 [ 2.07406483e-03]
 [-9.47563330e-06]
 [ 7.02216551e-03]
 [ 6.93564928e-03]
 [ 2.74581052e-02]
 [ 2.74181601e-03]
 [-8.10427359e-04]
 [ 2.50902364e-02]
 [-4.75637285e-03]
 [ 1.59128061e-02]
 [-4.18872357e-02]
 [ 1.66686362e-02]
 [ 6.27345066e-03]
 [-6.91533619e-03]
 [ 2.09228429e-02]
 [ 1.05498850e-02]
 [-1.14564520e-02]
 [-3.72707876e-04]
 [ 9.22820772e-03]
 [ 1.18906966e-02]
 [-4.59249410e-03]
 [ 6.84085389e-03]
 [ 2.27260730e-02]
 [ 9.98200827e-05]
 [ 1.27008672e-02]
 [-6.99986965e-03]
 [ 5.64880567e-03]
 [-8.16372183e-03]
 [-3.09886109e-03]
 [ 4.27023570e-03]
 [-1.20327248e-02]
 [ 3.53369471e-03]
 [ 7.06401319e-03]
 [ 1.15198820e-02]
 [ 1.09554766e-02]
 [-3.41215704e-02]
 [ 9.73475232e-03]
 [ 1.79829584e-03]
 [ 1.60259092e-02]
 [-5.75391333e-03]
 [-2.00041278e-02]
 [ 2.16137182e-02]
 [ 2.47151213e-04]
 [-5.54538750e-03]
 [-1.55877699e-03]
 [ 1.10477914e-02]
 [-3.22399442e-03]
 [-5.22750173e-03]
 [-7.42700282e-03]
 [-3.84387977e-02]
 [ 2.15774583e-03]
 [-8.11833812e-03]
 [ 5.46656584e-03]
 [-2.20676431e-03]
 [ 4.26413407e-03]
 [ 9.46850555e-03]
 [-4.90392790e-04]
 [ 1.62404214e-03]
 [ 1.49638791e-02]
 [-2.59618702e-03]
 [ 7.44162118e-03]
 [-3.30338840e-03]
 [-1.25810416e-02]
 [ 2.77623429e-05]
 [ 2.37497215e-04]
 [-5.44011551e-03]
 [ 1.50766365e-02]
 [-8.23710287e-03]
 [ 9.37710945e-03]
 [-1.08689802e-02]
 [ 1.10599295e-02]
 [-3.11521939e-03]
 [ 1.70845222e-02]
 [-2.24870745e-02]
 [-2.07748269e-03]
 [-1.04262235e-02]
 [-1.49514562e-03]
 [ 1.57304140e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.49484229]
curr_Stock_Price:  100.80977307977983
curr_Factors:  [100.80977308]
mat_Sqrt:  [[0.15]]
grads:  [-0.00190766]
Stock Position:  -0.0019076635414201192
Bond Position:  [14.68715342]


portfolio before change:  [14.49607108]
curr_Stock_Price:  100.64684414590214
curr_Factors:  [100.64684415]
mat_Sqrt:  [[0.15]]
grads:  [0.0138271]
Stock Position:  0.013827098847311014
Bond Position:  [13.10441722]


portfolio before change:  [14.4846859]
curr_Stock_Price:  99.76421233150522
curr_Factors:  [99.76421233]
mat_Sqrt:  [[0.15]]
grads:  [-6.31708886e-05]
Stock Position:  -6.317088864866752e-05
Bond Position:  [14.49098809]


portfolio before change:  [14.4855551]
curr_Stock_Price:  100.34209582071699
curr_Factors:  [100.34209582]
mat_Sqrt:  [[0.15]]
grads:  [0.04681444]
Stock Position:  0.04681443673388815
Bond Position:  [9.78809641]


portfolio before change:  [14.50419029]
curr_Stock_Price:  100.72709261284379
curr_Factors:  [100.72709261]
mat_Sqrt:  [[0.15]]
grads:  [0.04623766]
Stock Position:  0.0462376618397333
Bond Position:  [9.84680504]


portfolio before change:  [14.52958584]
curr_Stock_Price:  101.26302169780473
curr_Factors:  [101.2630217]
mat_Sqrt:  [[0.15]]
grads:  [0.18305403]
Stock Position:  0.18305403494720546
Bond Position:  [-4.00701887]


portfolio before change:  [14.61450104]
curr_Stock_Price:  101.72827036497938
curr_Factors:  [101.72827036]
mat_Sqrt:  [[0.15]]
grads:  [0.01827877]
Stock Position:  0.018278773427155347
Bond Position:  [12.75503303]


portfolio before change:  [14.60774039]
curr_Stock_Price:  101.31479261141841
curr_Factors:  [101.31479261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00540285]
Stock Position:  -0.005402849062564885
Bond Position:  [15.15512892]


portfolio before change:  [14.61188919]
curr_Stock_Price:  100.72222023817278
curr_Factors:  [100.72222024]
mat_Sqrt:  [[0.15]]
grads:  [0.16726824]
Stock Position:  0.16726824291857245
Bond Position:  [-2.23573961]


portfolio before change:  [14.68064769]
curr_Stock_Price:  101.13412289537752
curr_Factors:  [101.1341229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03170915]
Stock Position:  -0.03170915236290401
Bond Position:  [17.887525]


portfolio before change:  [14.69207744]
curr_Stock_Price:  100.80892516893225
curr_Factors:  [100.80892517]
mat_Sqrt:  [[0.15]]
grads:  [0.10608537]
Stock Position:  0.1060853742890427
Bond Position:  [3.99772488]


portfolio before change:  [14.73018787]
curr_Stock_Price:  101.16581285742323
curr_Factors:  [101.16581286]
mat_Sqrt:  [[0.15]]
grads:  [-0.27924824]
Stock Position:  -0.2792482382448929
Bond Position:  [42.98056288]


portfolio before change:  [14.85412838]
curr_Stock_Price:  100.73159653847222
curr_Factors:  [100.73159654]
mat_Sqrt:  [[0.15]]
grads:  [0.11112424]
Stock Position:  0.11112424135745952
Bond Position:  [3.66040613]


portfolio before change:  [14.77246915]
curr_Stock_Price:  99.9946915423053
curr_Factors:  [99.99469154]
mat_Sqrt:  [[0.15]]
grads:  [0.041823]
Stock Position:  0.04182300439161668
Bond Position:  [10.59039073]


portfolio before change:  [14.79669152]
curr_Stock_Price:  100.55802867331438
curr_Factors:  [100.55802867]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610224]
Stock Position:  -0.046102241248475756
Bond Position:  [19.43264202]


portfolio before change:  [14.75996186]
curr_Stock_Price:  101.38107416706686
curr_Factors:  [101.38107417]
mat_Sqrt:  [[0.15]]
grads:  [0.13948562]
Stock Position:  0.13948561910910467
Bond Position:  [0.61875996]


portfolio before change:  [14.73969712]
curr_Stock_Price:  101.23551497727009
curr_Factors:  [101.23551498]
mat_Sqrt:  [[0.15]]
grads:  [0.07033257]
Stock Position:  0.07033256660550101
Bond Position:  [7.61954352]


portfolio before change:  [14.71004071]
curr_Stock_Price:  100.80708405157787
curr_Factors:  [100.80708405]
mat_Sqrt:  [[0.15]]
grads:  [-0.07637635]
Stock Position:  -0.0763763467572178
Bond Position:  [22.40931752]


portfolio before change:  [14.73176687]
curr_Stock_Price:  100.54096064454492
curr_Factors:  [100.54096064]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248472]
Stock Position:  -0.002484719175625174
Bond Position:  [14.98158292]


portfolio before change:  [14.73320508]
curr_Stock_Price:  100.33899278164188
curr_Factors:  [100.33899278]
mat_Sqrt:  [[0.15]]
grads:  [0.06152138]
Stock Position:  0.06152138476985182
Bond Position:  [8.5602113]


portfolio before change:  [14.74574439]
curr_Stock_Price:  100.53411642459125
curr_Factors:  [100.53411642]
mat_Sqrt:  [[0.15]]
grads:  [0.07927131]
Stock Position:  0.07927131074186296
Bond Position:  [6.7762732]


portfolio before change:  [14.79474814]
curr_Stock_Price:  101.1469513098198
curr_Factors:  [101.14695131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03061663]
Stock Position:  -0.03061662735769044
Bond Position:  [17.89152666]


portfolio before change:  [14.81175523]
curr_Stock_Price:  100.6279902660221
curr_Factors:  [100.62799027]
mat_Sqrt:  [[0.15]]
grads:  [0.04560569]
Stock Position:  0.045605692590035274
Bond Position:  [10.22254604]


portfolio before change:  [14.83208201]
curr_Stock_Price:  101.05968743195157
curr_Factors:  [101.05968743]
mat_Sqrt:  [[0.15]]
grads:  [0.15150715]
Stock Position:  0.1515071535660696
Bond Position:  [-0.47918357]


portfolio before change:  [14.76589519]
curr_Stock_Price:  100.62302903789646
curr_Factors:  [100.62302904]
mat_Sqrt:  [[0.15]]
grads:  [0.00066547]
Stock Position:  0.0006654672176915321
Bond Position:  [14.69893386]


portfolio before change:  [14.76647183]
curr_Stock_Price:  100.10899964611234
curr_Factors:  [100.10899965]
mat_Sqrt:  [[0.15]]
grads:  [0.08467245]
Stock Position:  0.084672447687677
Bond Position:  [6.2899978]


portfolio before change:  [14.71666606]
curr_Stock_Price:  99.51613959128639
curr_Factors:  [99.51613959]
mat_Sqrt:  [[0.15]]
grads:  [-0.0466658]
Stock Position:  -0.046665797666460875
Bond Position:  [19.36066609]


portfolio before change:  [14.70653294]
curr_Stock_Price:  99.75921263899887
curr_Factors:  [99.75921264]
mat_Sqrt:  [[0.15]]
grads:  [0.0376587]
Stock Position:  0.037658704476451574
Bond Position:  [10.94973023]


portfolio before change:  [14.70364676]
curr_Stock_Price:  99.66439897133286
curr_Factors:  [99.66439897]
mat_Sqrt:  [[0.15]]
grads:  [-0.05442481]
Stock Position:  -0.05442481217556997
Bond Position:  [20.12786296]


portfolio before change:  [14.66614883]
curr_Stock_Price:  100.3764998701713
curr_Factors:  [100.37649987]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065907]
Stock Position:  -0.02065907395499106
Bond Position:  [16.73983437]


portfolio before change:  [14.67014668]
curr_Stock_Price:  100.23362944264385
curr_Factors:  [100.23362944]
mat_Sqrt:  [[0.15]]
grads:  [0.02846824]
Stock Position:  0.028468237975983156
Bond Position:  [11.81667186]


portfolio before change:  [14.67208966]
curr_Stock_Price:  100.27593684446084
curr_Factors:  [100.27593684]
mat_Sqrt:  [[0.15]]
grads:  [-0.08021817]
Stock Position:  -0.08021816523427934
Bond Position:  [22.71604133]


portfolio before change:  [14.6773641]
curr_Stock_Price:  100.22788478076296
curr_Factors:  [100.22788478]
mat_Sqrt:  [[0.15]]
grads:  [0.02355796]
Stock Position:  0.02355796475648828
Bond Position:  [12.31619913]


portfolio before change:  [14.69083822]
curr_Stock_Price:  100.76716431512762
curr_Factors:  [100.76716432]
mat_Sqrt:  [[0.15]]
grads:  [0.04709342]
Stock Position:  0.04709342129817447
Bond Position:  [9.9453677]


portfolio before change:  [14.6697571]
curr_Stock_Price:  100.30632029250695
curr_Factors:  [100.30632029]
mat_Sqrt:  [[0.15]]
grads:  [0.07679921]
Stock Position:  0.07679921358987772
Bond Position:  [6.96631059]


portfolio before change:  [14.66806669]
curr_Stock_Price:  100.27864000329501
curr_Factors:  [100.27864]
mat_Sqrt:  [[0.15]]
grads:  [0.07303651]
Stock Position:  0.07303651037033397
Bond Position:  [7.34406476]


portfolio before change:  [14.71555104]
curr_Stock_Price:  100.92250060505076
curr_Factors:  [100.92250061]
mat_Sqrt:  [[0.15]]
grads:  [-0.22747714]
Stock Position:  -0.22747713600997474
Bond Position:  [37.67311243]


portfolio before change:  [14.73582043]
curr_Stock_Price:  100.84374654193478
curr_Factors:  [100.84374654]
mat_Sqrt:  [[0.15]]
grads:  [0.06489835]
Stock Position:  0.06489834877195795
Bond Position:  [8.19122779]


portfolio before change:  [14.76388986]
curr_Stock_Price:  101.26837153165035
curr_Factors:  [101.26837153]
mat_Sqrt:  [[0.15]]
grads:  [0.01198864]
Stock Position:  0.011988638933076261
Bond Position:  [13.54981991]


portfolio before change:  [14.7604344]
curr_Stock_Price:  100.90950284953836
curr_Factors:  [100.90950285]
mat_Sqrt:  [[0.15]]
grads:  [0.10683939]
Stock Position:  0.10683939475363854
Bond Position:  [3.97932419]


portfolio before change:  [14.78784592]
curr_Stock_Price:  101.16374242104604
curr_Factors:  [101.16374242]
mat_Sqrt:  [[0.15]]
grads:  [-0.03835942]
Stock Position:  -0.038359422191628106
Bond Position:  [18.66842862]


portfolio before change:  [14.7707853]
curr_Stock_Price:  101.63891707931407
curr_Factors:  [101.63891708]
mat_Sqrt:  [[0.15]]
grads:  [-0.13336085]
Stock Position:  -0.13336085181138715
Bond Position:  [28.32543786]


portfolio before change:  [14.75560278]
curr_Stock_Price:  101.76603774555544
curr_Factors:  [101.76603775]
mat_Sqrt:  [[0.15]]
grads:  [0.14409145]
Stock Position:  0.1440914548298753
Bond Position:  [0.09198635]


portfolio before change:  [14.84164819]
curr_Stock_Price:  102.36315613953543
curr_Factors:  [102.36315614]
mat_Sqrt:  [[0.15]]
grads:  [0.00164767]
Stock Position:  0.0016476747527331404
Bond Position:  [14.672987]


portfolio before change:  [14.84132292]
curr_Stock_Price:  101.60915187017234
curr_Factors:  [101.60915187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03696925]
Stock Position:  -0.036969250026917665
Bond Position:  [18.59773706]


portfolio before change:  [14.85560722]
curr_Stock_Price:  101.2542109799089
curr_Factors:  [101.25421098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039185]
Stock Position:  -0.010391846595716528
Bond Position:  [15.90782544]


portfolio before change:  [14.85717129]
curr_Stock_Price:  101.19937964541673
curr_Factors:  [101.19937965]
mat_Sqrt:  [[0.15]]
grads:  [0.07365194]
Stock Position:  0.07365194236098341
Bond Position:  [7.40364041]


portfolio before change:  [14.89047859]
curr_Stock_Price:  101.6453225508301
curr_Factors:  [101.64532255]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214933]
Stock Position:  -0.021493296161032318
Bond Position:  [17.07517161]


portfolio before change:  [14.8845415]
curr_Stock_Price:  101.97120667529221
curr_Factors:  [101.97120668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03485001]
Stock Position:  -0.03485001151365917
Bond Position:  [18.43823922]


portfolio before change:  [14.86439628]
curr_Stock_Price:  102.58232966247402
curr_Factors:  [102.58232966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04951335]
Stock Position:  -0.049513352105064634
Bond Position:  [19.94359129]


portfolio before change:  [14.85555418]
curr_Stock_Price:  102.78608505378524
curr_Factors:  [102.78608505]
mat_Sqrt:  [[0.15]]
grads:  [-0.25625865]
Stock Position:  -0.25625865105166
Bond Position:  [41.19537768]


portfolio before change:  [14.9085245]
curr_Stock_Price:  102.58942622268377
curr_Factors:  [102.58942622]
mat_Sqrt:  [[0.15]]
grads:  [0.01438497]
Stock Position:  0.014384972193934274
Bond Position:  [13.43277846]


portfolio before change:  [14.91073407]
curr_Stock_Price:  102.68466400042477
curr_Factors:  [102.684664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05412225]
Stock Position:  -0.054122254153770775
Bond Position:  [20.46825955]


portfolio before change:  [14.95237722]
curr_Stock_Price:  101.93887375428834
curr_Factors:  [101.93887375]
mat_Sqrt:  [[0.15]]
grads:  [0.03644377]
Stock Position:  0.03644377228874274
Bond Position:  [11.23734012]


portfolio before change:  [14.96999157]
curr_Stock_Price:  102.40293090627627
curr_Factors:  [102.40293091]
mat_Sqrt:  [[0.15]]
grads:  [-0.01471176]
Stock Position:  -0.014711762078714354
Bond Position:  [16.47651913]


portfolio before change:  [14.96759648]
curr_Stock_Price:  102.63573143355018
curr_Factors:  [102.63573143]
mat_Sqrt:  [[0.15]]
grads:  [0.02842756]
Stock Position:  0.02842756047276025
Bond Position:  [12.04991302]


portfolio before change:  [14.96728972]
curr_Stock_Price:  102.59844702790005
curr_Factors:  [102.59844703]
mat_Sqrt:  [[0.15]]
grads:  [0.06312337]
Stock Position:  0.06312337030304721
Bond Position:  [8.49092995]


portfolio before change:  [14.95877101]
curr_Stock_Price:  102.45508642381492
curr_Factors:  [102.45508642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00326929]
Stock Position:  -0.0032692852652246806
Bond Position:  [15.29372592]


portfolio before change:  [14.96172386]
curr_Stock_Price:  101.84426175990741
curr_Factors:  [101.84426176]
mat_Sqrt:  [[0.15]]
grads:  [0.01082695]
Stock Position:  0.010826947601198268
Bond Position:  [13.85906138]


portfolio before change:  [14.96257532]
curr_Stock_Price:  101.84289887866463
curr_Factors:  [101.84289888]
mat_Sqrt:  [[0.15]]
grads:  [0.09975919]
Stock Position:  0.0997591937980341
Bond Position:  [4.80280984]


portfolio before change:  [15.03663362]
curr_Stock_Price:  102.58226044657796
curr_Factors:  [102.58226045]
mat_Sqrt:  [[0.15]]
grads:  [-0.01730791]
Stock Position:  -0.017307913477375782
Bond Position:  [16.81211851]


portfolio before change:  [15.04358142]
curr_Stock_Price:  102.24154906247257
curr_Factors:  [102.24154906]
mat_Sqrt:  [[0.15]]
grads:  [0.04961081]
Stock Position:  0.04961080785496549
Bond Position:  [9.97129557]


portfolio before change:  [15.0255856]
curr_Stock_Price:  101.8662469340769
curr_Factors:  [101.86624693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02202259]
Stock Position:  -0.02202258934481187
Bond Position:  [17.26894412]


portfolio before change:  [15.02827465]
curr_Stock_Price:  101.79315348804928
curr_Factors:  [101.79315349]
mat_Sqrt:  [[0.15]]
grads:  [-0.08387361]
Stock Position:  -0.08387361075775193
Bond Position:  [23.56603398]


portfolio before change:  [14.9915989]
curr_Stock_Price:  102.24798876106472
curr_Factors:  [102.24798876]
mat_Sqrt:  [[0.15]]
grads:  [0.00018508]
Stock Position:  0.00018508228599961135
Bond Position:  [14.9726746]


portfolio before change:  [14.99247642]
curr_Stock_Price:  101.9329853980074
curr_Factors:  [101.9329854]
mat_Sqrt:  [[0.15]]
grads:  [0.00158331]
Stock Position:  0.0015833147688047492
Bond Position:  [14.83108441]


portfolio before change:  [14.99396179]
curr_Stock_Price:  102.2856669879696
curr_Factors:  [102.28566699]
mat_Sqrt:  [[0.15]]
grads:  [-0.03626744]
Stock Position:  -0.03626743672968061
Bond Position:  [18.70360075]


portfolio before change:  [15.00275266]
curr_Stock_Price:  102.07550991399643
curr_Factors:  [102.07550991]
mat_Sqrt:  [[0.15]]
grads:  [0.10051091]
Stock Position:  0.10051091017449285
Bond Position:  [4.74305026]


portfolio before change:  [14.91471219]
curr_Stock_Price:  101.19663093698641
curr_Factors:  [101.19663094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05491402]
Stock Position:  -0.05491401911930479
Bond Position:  [20.47182591]


portfolio before change:  [14.90896117]
curr_Stock_Price:  101.32465911860936
curr_Factors:  [101.32465912]
mat_Sqrt:  [[0.15]]
grads:  [0.06251406]
Stock Position:  0.06251406302807452
Bond Position:  [8.57474505]


portfolio before change:  [14.88172921]
curr_Stock_Price:  100.88047256301542
curr_Factors:  [100.88047256]
mat_Sqrt:  [[0.15]]
grads:  [-0.07245987]
Stock Position:  -0.07245986810331691
Bond Position:  [22.19151494]


portfolio before change:  [14.87963392]
curr_Stock_Price:  100.92853090414246
curr_Factors:  [100.9285309]
mat_Sqrt:  [[0.15]]
grads:  [0.07373286]
Stock Position:  0.07373286353474388
Bond Position:  [7.43788432]


portfolio before change:  [14.93446117]
curr_Stock_Price:  101.66581904206595
curr_Factors:  [101.66581904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02076813]
Stock Position:  -0.02076812927295778
Bond Position:  [17.04587004]


portfolio before change:  [14.95433634]
curr_Stock_Price:  100.76011506277375
curr_Factors:  [100.76011506]
mat_Sqrt:  [[0.15]]
grads:  [0.11389681]
Stock Position:  0.11389681474402016
Bond Position:  [3.47808018]


portfolio before change:  [14.9887301]
curr_Stock_Price:  101.06017936218784
curr_Factors:  [101.06017936]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991383]
Stock Position:  -0.14991383025254165
Bond Position:  [30.13904867]


portfolio before change:  [14.82838163]
curr_Stock_Price:  102.14234915095228
curr_Factors:  [102.14234915]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384988]
Stock Position:  -0.013849884595573684
Bond Position:  [16.24304138]


portfolio before change:  [14.83826616]
curr_Stock_Price:  101.5019607323387
curr_Factors:  [101.50196073]
mat_Sqrt:  [[0.15]]
grads:  [-0.06950816]
Stock Position:  -0.06950815687170524
Bond Position:  [21.89348037]


portfolio before change:  [14.86932447]
curr_Stock_Price:  101.07481762251166
curr_Factors:  [101.07481762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00996764]
Stock Position:  -0.009967637490606626
Bond Position:  [15.87680161]


portfolio before change:  [14.86710575]
curr_Stock_Price:  101.3969651776355
curr_Factors:  [101.39696518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.86710575]
Stock Price:  102.16944552577716
PL:  [12.69766023]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.04919958e-03]
 [ 1.60982280e-03]
 [-4.53666363e-03]
 [ 6.53655764e-03]
 [ 4.99936038e-03]
 [ 2.75176887e-02]
 [ 1.41979982e-03]
 [-7.09361528e-03]
 [ 2.47394212e-02]
 [-4.32511318e-03]
 [ 1.28536191e-02]
 [-2.19893636e-02]
 [ 3.89862878e-02]
 [ 6.25137646e-04]
 [-6.91526099e-03]
 [ 1.51954184e-02]
 [ 7.51609990e-03]
 [-1.23588653e-02]
 [ 1.95980663e-04]
 [ 1.45567401e-02]
 [ 1.15802708e-02]
 [-7.99846276e-03]
 [ 7.38753697e-03]
 [-3.59429564e-03]
 [-8.28571529e-03]
 [-8.38925026e-03]
 [-4.51720803e-03]
 [ 6.98257203e-03]
 [-1.91277048e-02]
 [-1.96222460e-03]
 [ 9.61138495e-04]
 [-1.20898838e-02]
 [ 7.19800678e-03]
 [ 7.53078937e-03]
 [ 1.14728321e-02]
 [ 8.49509765e-03]
 [-3.35788832e-02]
 [ 9.55164064e-03]
 [ 5.62484674e-03]
 [ 1.62256929e-02]
 [-5.53166226e-03]
 [-1.84241907e-02]
 [ 2.15199037e-02]
 [ 2.71139411e-04]
 [-6.62170251e-03]
 [-8.13400967e-03]
 [ 1.25539093e-02]
 [ 3.70441366e-03]
 [ 2.73220372e-03]
 [-7.39931103e-03]
 [-3.83669411e-02]
 [ 2.01294429e-03]
 [-6.20105321e-03]
 [ 5.54228035e-03]
 [-4.10582629e-04]
 [-4.70882410e-04]
 [ 9.42939644e-03]
 [-2.67459883e-04]
 [ 1.68671564e-03]
 [ 1.53427377e-02]
 [ 1.62820663e-03]
 [ 1.99613837e-02]
 [ 4.08096945e-03]
 [-1.25632803e-02]
 [ 3.86022526e-03]
 [ 7.67555410e-04]
 [-5.50378558e-03]
 [ 1.55291629e-02]
 [-8.35499494e-03]
 [ 1.06940463e-02]
 [-1.13175829e-02]
 [ 1.16878893e-02]
 [-5.09836644e-04]
 [ 1.85802156e-02]
 [-2.24814679e-02]
 [-3.24897886e-03]
 [-1.01307460e-02]
 [-1.58955849e-03]
 [ 1.46953509e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.18997796]
curr_Stock_Price:  99.78986828739347
curr_Factors:  [99.78986829]
mat_Sqrt:  [[0.15]]
grads:  [0.020328]
Stock Position:  0.02032799719712331
Bond Position:  [-3.21850613]


portfolio before change:  [-1.16993729]
curr_Stock_Price:  100.78562961054475
curr_Factors:  [100.78562961]
mat_Sqrt:  [[0.15]]
grads:  [0.01073215]
Stock Position:  0.010732151986523242
Bond Position:  [-2.25158399]


portfolio before change:  [-1.16540992]
curr_Stock_Price:  101.22059390766815
curr_Factors:  [101.22059391]
mat_Sqrt:  [[0.15]]
grads:  [-0.03024442]
Stock Position:  -0.030244424229722636
Bond Position:  [1.89594866]


portfolio before change:  [-1.14189123]
curr_Stock_Price:  100.44689149315477
curr_Factors:  [100.44689149]
mat_Sqrt:  [[0.15]]
grads:  [0.04357705]
Stock Position:  0.04357705093144966
Bond Position:  [-5.51907054]


portfolio before change:  [-1.15985002]
curr_Stock_Price:  100.04269179623566
curr_Factors:  [100.0426918]
mat_Sqrt:  [[0.15]]
grads:  [0.03332907]
Stock Position:  0.0333290691798557
Bond Position:  [-4.49417981]


portfolio before change:  [-1.14408875]
curr_Stock_Price:  100.52401830558873
curr_Factors:  [100.52401831]
mat_Sqrt:  [[0.15]]
grads:  [0.18345126]
Stock Position:  0.18345125816811356
Bond Position:  [-19.58534638]


portfolio before change:  [-1.16758234]
curr_Stock_Price:  100.40262654063103
curr_Factors:  [100.40262654]
mat_Sqrt:  [[0.15]]
grads:  [0.00946533]
Stock Position:  0.009465332143976348
Bond Position:  [-2.11792655]


portfolio before change:  [-1.16184672]
curr_Stock_Price:  101.02257270349551
curr_Factors:  [101.0225727]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729077]
Stock Position:  -0.047290768564128664
Bond Position:  [3.61558838]


portfolio before change:  [-1.15055847]
curr_Stock_Price:  100.78865233511708
curr_Factors:  [100.78865234]
mat_Sqrt:  [[0.15]]
grads:  [0.16492947]
Stock Position:  0.16492947480694445
Bond Position:  [-17.77357796]


portfolio before change:  [-1.16101712]
curr_Stock_Price:  100.73197496134662
curr_Factors:  [100.73197496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883409]
Stock Position:  -0.028834087852149214
Bond Position:  [1.7434975]


portfolio before change:  [-1.14300206]
curr_Stock_Price:  100.11097072666357
curr_Factors:  [100.11097073]
mat_Sqrt:  [[0.15]]
grads:  [0.08569079]
Stock Position:  0.08569079379706901
Bond Position:  [-9.72159061]


portfolio before change:  [-1.08733074]
curr_Stock_Price:  100.76773828793233
curr_Factors:  [100.76773829]
mat_Sqrt:  [[0.15]]
grads:  [-0.14659576]
Stock Position:  -0.1465957576050736
Bond Position:  [13.6847922]


portfolio before change:  [-1.17324827]
curr_Stock_Price:  101.35965757419436
curr_Factors:  [101.35965757]
mat_Sqrt:  [[0.15]]
grads:  [0.25990859]
Stock Position:  0.2599085853832766
Bond Position:  [-27.51749349]


portfolio before change:  [-1.36423263]
curr_Stock_Price:  100.63146130443054
curr_Factors:  [100.6314613]
mat_Sqrt:  [[0.15]]
grads:  [0.00416758]
Stock Position:  0.004167584307790083
Bond Position:  [-1.78362273]


portfolio before change:  [-1.36447407]
curr_Stock_Price:  100.60027717410438
curr_Factors:  [100.60027717]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610174]
Stock Position:  -0.046101739911295514
Bond Position:  [3.27337374]


portfolio before change:  [-1.35826967]
curr_Stock_Price:  100.47013424536671
curr_Factors:  [100.47013425]
mat_Sqrt:  [[0.15]]
grads:  [0.10130279]
Stock Position:  0.10130278939215992
Bond Position:  [-11.53617451]


portfolio before change:  [-1.40752967]
curr_Stock_Price:  99.99098680974772
curr_Factors:  [99.99098681]
mat_Sqrt:  [[0.15]]
grads:  [0.05010733]
Stock Position:  0.05010733266439353
Bond Position:  [-6.41781131]


portfolio before change:  [-1.40302462]
curr_Stock_Price:  100.0889002132655
curr_Factors:  [100.08890021]
mat_Sqrt:  [[0.15]]
grads:  [-0.08239244]
Stock Position:  -0.08239243503317367
Bond Position:  [6.84354359]


portfolio before change:  [-1.31206161]
curr_Stock_Price:  98.99007036207084
curr_Factors:  [98.99007036]
mat_Sqrt:  [[0.15]]
grads:  [0.00130654]
Stock Position:  0.0013065377508758697
Bond Position:  [-1.44139588]


portfolio before change:  [-1.31193773]
curr_Stock_Price:  99.15384634135151
curr_Factors:  [99.15384634]
mat_Sqrt:  [[0.15]]
grads:  [0.09704493]
Stock Position:  0.09704493399977968
Bond Position:  [-10.9343162]


portfolio before change:  [-1.30717866]
curr_Stock_Price:  99.20992846587122
curr_Factors:  [99.20992847]
mat_Sqrt:  [[0.15]]
grads:  [0.07720181]
Stock Position:  0.07720180545957621
Bond Position:  [-8.96636425]


portfolio before change:  [-1.27748559]
curr_Stock_Price:  99.60180380247061
curr_Factors:  [99.6018038]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332309]
Stock Position:  -0.053323085090184755
Bond Position:  [4.03358987]


portfolio before change:  [-1.22473997]
curr_Stock_Price:  98.61736126640142
curr_Factors:  [98.61736127]
mat_Sqrt:  [[0.15]]
grads:  [0.04925025]
Stock Position:  0.04925024645357559
Bond Position:  [-6.08166931]


portfolio before change:  [-1.25604479]
curr_Stock_Price:  97.98945148379357
curr_Factors:  [97.98945148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02396197]
Stock Position:  -0.023961970906133855
Bond Position:  [1.09197559]


portfolio before change:  [-1.26076546]
curr_Stock_Price:  98.18930620029627
curr_Factors:  [98.1893062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0552381]
Stock Position:  -0.05523810193792809
Bond Position:  [4.16302545]


portfolio before change:  [-1.2763987]
curr_Stock_Price:  98.47703232914203
curr_Factors:  [98.47703233]
mat_Sqrt:  [[0.15]]
grads:  [-0.05592834]
Stock Position:  -0.055928335090744685
Bond Position:  [4.23125776]


portfolio before change:  [-1.27965176]
curr_Stock_Price:  98.53992560886961
curr_Factors:  [98.53992561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03011472]
Stock Position:  -0.03011472018944191
Bond Position:  [1.68785053]


portfolio before change:  [-1.28035525]
curr_Stock_Price:  98.56678889098221
curr_Factors:  [98.56678889]
mat_Sqrt:  [[0.15]]
grads:  [0.04655048]
Stock Position:  0.0465504801729843
Bond Position:  [-5.8686866]


portfolio before change:  [-1.30416211]
curr_Stock_Price:  98.06324819296394
curr_Factors:  [98.06324819]
mat_Sqrt:  [[0.15]]
grads:  [-0.12751803]
Stock Position:  -0.1275180318718857
Bond Position:  [11.2006703]


portfolio before change:  [-1.49362291]
curr_Stock_Price:  99.55449503467905
curr_Factors:  [99.55449503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130815]
Stock Position:  -0.013081497300863557
Bond Position:  [-0.19130105]


portfolio before change:  [-1.49711473]
curr_Stock_Price:  99.82050911192941
curr_Factors:  [99.82050911]
mat_Sqrt:  [[0.15]]
grads:  [0.00640759]
Stock Position:  0.006407589969159803
Bond Position:  [-2.13672362]


portfolio before change:  [-1.49188147]
curr_Stock_Price:  100.65808031540585
curr_Factors:  [100.65808032]
mat_Sqrt:  [[0.15]]
grads:  [-0.08059923]
Stock Position:  -0.08059922501054642
Bond Position:  [6.6210818]


portfolio before change:  [-1.49414587]
curr_Stock_Price:  100.69130935035173
curr_Factors:  [100.69130935]
mat_Sqrt:  [[0.15]]
grads:  [0.04798671]
Stock Position:  0.04798671189920701
Bond Position:  [-6.32599072]


portfolio before change:  [-1.47604426]
curr_Stock_Price:  101.07677007300643
curr_Factors:  [101.07677007]
mat_Sqrt:  [[0.15]]
grads:  [0.05020526]
Stock Position:  0.05020526248975314
Bond Position:  [-6.55063004]


portfolio before change:  [-1.47780963]
curr_Stock_Price:  101.04976219474514
curr_Factors:  [101.04976219]
mat_Sqrt:  [[0.15]]
grads:  [0.07648555]
Stock Position:  0.07648554762457486
Bond Position:  [-9.20665603]


portfolio before change:  [-1.41544767]
curr_Stock_Price:  101.87262864263126
curr_Factors:  [101.87262864]
mat_Sqrt:  [[0.15]]
grads:  [0.05663398]
Stock Position:  0.056633984358144644
Bond Position:  [-7.18490053]


portfolio before change:  [-1.4094942]
curr_Stock_Price:  101.98567981337666
curr_Factors:  [101.98567981]
mat_Sqrt:  [[0.15]]
grads:  [-0.22385922]
Stock Position:  -0.2238592213076372
Bond Position:  [21.42094066]


portfolio before change:  [-1.37435571]
curr_Stock_Price:  101.83469366051926
curr_Factors:  [101.83469366]
mat_Sqrt:  [[0.15]]
grads:  [0.0636776]
Stock Position:  0.06367760425814029
Bond Position:  [-7.85894503]


portfolio before change:  [-1.35592761]
curr_Stock_Price:  102.13180436431138
curr_Factors:  [102.13180436]
mat_Sqrt:  [[0.15]]
grads:  [0.03749898]
Stock Position:  0.037498978272389974
Bond Position:  [-5.18576592]


portfolio before change:  [-1.40468405]
curr_Stock_Price:  100.84024059520564
curr_Factors:  [100.8402406]
mat_Sqrt:  [[0.15]]
grads:  [0.10817129]
Stock Position:  0.1081712859573369
Bond Position:  [-12.31270256]


portfolio before change:  [-1.33843947]
curr_Stock_Price:  101.45975946816085
curr_Factors:  [101.45975947]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687775]
Stock Position:  -0.03687774841575358
Bond Position:  [2.40316802]


portfolio before change:  [-1.33367947]
curr_Stock_Price:  101.33475726694536
curr_Factors:  [101.33475727]
mat_Sqrt:  [[0.15]]
grads:  [-0.12282794]
Stock Position:  -0.12282793803716319
Bond Position:  [11.11305982]


portfolio before change:  [-1.39352315]
curr_Stock_Price:  101.82762777995498
curr_Factors:  [101.82762778]
mat_Sqrt:  [[0.15]]
grads:  [0.14346602]
Stock Position:  0.14346602452572904
Bond Position:  [-16.00232809]


portfolio before change:  [-1.31935763]
curr_Stock_Price:  102.35155458884601
curr_Factors:  [102.35155459]
mat_Sqrt:  [[0.15]]
grads:  [0.0018076]
Stock Position:  0.0018075960713243775
Bond Position:  [-1.5043679]


portfolio before change:  [-1.32137738]
curr_Stock_Price:  101.28620427985325
curr_Factors:  [101.28620428]
mat_Sqrt:  [[0.15]]
grads:  [-0.04414468]
Stock Position:  -0.04414468339093607
Bond Position:  [3.14987004]


portfolio before change:  [-1.34437724]
curr_Stock_Price:  101.81167495008059
curr_Factors:  [101.81167495]
mat_Sqrt:  [[0.15]]
grads:  [-0.05422673]
Stock Position:  -0.054226731144202726
Bond Position:  [4.17653708]


portfolio before change:  [-1.3435391]
curr_Stock_Price:  101.80103257366967
curr_Factors:  [101.80103257]
mat_Sqrt:  [[0.15]]
grads:  [0.08369273]
Stock Position:  0.08369272867338198
Bond Position:  [-9.86354529]


portfolio before change:  [-1.25410487]
curr_Stock_Price:  102.87700081659067
curr_Factors:  [102.87700082]
mat_Sqrt:  [[0.15]]
grads:  [0.02469609]
Stock Position:  0.024696091080959274
Bond Position:  [-3.79476465]


portfolio before change:  [-1.2494048]
curr_Stock_Price:  103.07692102179759
curr_Factors:  [103.07692102]
mat_Sqrt:  [[0.15]]
grads:  [0.01821469]
Stock Position:  0.018214691441929012
Bond Position:  [-3.12691911]


portfolio before change:  [-1.25235774]
curr_Stock_Price:  102.92553242899355
curr_Factors:  [102.92553243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04932874]
Stock Position:  -0.04932874017280341
Bond Position:  [3.82482911]


portfolio before change:  [-1.24748799]
curr_Stock_Price:  102.83165845686887
curr_Factors:  [102.83165846]
mat_Sqrt:  [[0.15]]
grads:  [-0.25577961]
Stock Position:  -0.25577960742756867
Bond Position:  [25.05475324]


portfolio before change:  [-1.12203722]
curr_Stock_Price:  102.3473164738169
curr_Factors:  [102.34731647]
mat_Sqrt:  [[0.15]]
grads:  [0.01341963]
Stock Position:  0.013419628596858293
Bond Position:  [-2.49550019]


portfolio before change:  [-1.12597946]
curr_Stock_Price:  102.06517236955528
curr_Factors:  [102.06517237]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134035]
Stock Position:  -0.04134035474288059
Bond Position:  [3.09343097]


portfolio before change:  [-1.13730593]
curr_Stock_Price:  102.34383028871973
curr_Factors:  [102.34383029]
mat_Sqrt:  [[0.15]]
grads:  [0.03694854]
Stock Position:  0.03694853565477159
Bond Position:  [-4.9187606]


portfolio before change:  [-1.14612854]
curr_Stock_Price:  102.11336992534498
curr_Factors:  [102.11336993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273722]
Stock Position:  -0.002737217527517862
Bond Position:  [-0.86662203]


portfolio before change:  [-1.14560732]
curr_Stock_Price:  101.90316315721768
curr_Factors:  [101.90316316]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313922]
Stock Position:  -0.0031392160692396767
Bond Position:  [-0.82571128]


portfolio before change:  [-1.14772398]
curr_Stock_Price:  102.5609859548136
curr_Factors:  [102.56098595]
mat_Sqrt:  [[0.15]]
grads:  [0.06286264]
Stock Position:  0.06286264295891147
Bond Position:  [-7.59497862]


portfolio before change:  [-1.13615627]
curr_Stock_Price:  102.75255292689464
curr_Factors:  [102.75255293]
mat_Sqrt:  [[0.15]]
grads:  [-0.00178307]
Stock Position:  -0.0017830658879799247
Bond Position:  [-0.9529417]


portfolio before change:  [-1.13628262]
curr_Stock_Price:  102.79000858177423
curr_Factors:  [102.79000858]
mat_Sqrt:  [[0.15]]
grads:  [0.01124477]
Stock Position:  0.011244770943933722
Bond Position:  [-2.29213272]


portfolio before change:  [-1.12790051]
curr_Stock_Price:  103.54817185833996
curr_Factors:  [103.54817186]
mat_Sqrt:  [[0.15]]
grads:  [0.10228492]
Stock Position:  0.10228491821260229
Bond Position:  [-11.7193168]


portfolio before change:  [-1.13370746]
curr_Stock_Price:  103.49856076613767
curr_Factors:  [103.49856077]
mat_Sqrt:  [[0.15]]
grads:  [0.01085471]
Stock Position:  0.010854710855553966
Bond Position:  [-2.25715441]


portfolio before change:  [-1.13259654]
curr_Stock_Price:  103.61390212269636
curr_Factors:  [103.61390212]
mat_Sqrt:  [[0.15]]
grads:  [0.13307589]
Stock Position:  0.13307589123443672
Bond Position:  [-14.92110891]


portfolio before change:  [-1.11679653]
curr_Stock_Price:  103.7396394554871
curr_Factors:  [103.73963946]
mat_Sqrt:  [[0.15]]
grads:  [0.02720646]
Stock Position:  0.02720646300433211
Bond Position:  [-3.93918519]


portfolio before change:  [-1.12696871]
curr_Stock_Price:  103.37480076592459
curr_Factors:  [103.37480077]
mat_Sqrt:  [[0.15]]
grads:  [-0.0837552]
Stock Position:  -0.08375520223673666
Bond Position:  [7.53120864]


portfolio before change:  [-1.09474936]
curr_Stock_Price:  102.99573623426373
curr_Factors:  [102.99573623]
mat_Sqrt:  [[0.15]]
grads:  [0.02573484]
Stock Position:  0.025734835037880315
Bond Position:  [-3.74532765]


portfolio before change:  [-1.11161234]
curr_Stock_Price:  102.34957373888152
curr_Factors:  [102.34957374]
mat_Sqrt:  [[0.15]]
grads:  [0.00511704]
Stock Position:  0.005117036066040054
Bond Position:  [-1.6353388]


portfolio before change:  [-1.11472139]
curr_Stock_Price:  101.76196073911684
curr_Factors:  [101.76196074]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366919]
Stock Position:  -0.036691903880982014
Bond Position:  [2.61911869]


portfolio before change:  [-1.11994578]
curr_Stock_Price:  101.90880767873017
curr_Factors:  [101.90880768]
mat_Sqrt:  [[0.15]]
grads:  [0.10352775]
Stock Position:  0.10352775289697558
Bond Position:  [-11.67033564]


portfolio before change:  [-1.11761233]
curr_Stock_Price:  101.93839272378972
curr_Factors:  [101.93839272]
mat_Sqrt:  [[0.15]]
grads:  [-0.05569997]
Stock Position:  -0.0556999662623973
Bond Position:  [4.56035271]


portfolio before change:  [-1.1301331]
curr_Stock_Price:  102.16829951826729
curr_Factors:  [102.16829952]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-8.41408328]


portfolio before change:  [-1.15812691]
curr_Stock_Price:  101.78302090066691
curr_Factors:  [101.7830209]
mat_Sqrt:  [[0.15]]
grads:  [-0.07545055]
Stock Position:  -0.07545055278272496
Bond Position:  [6.52145828]


portfolio before change:  [-1.15603492]
curr_Stock_Price:  101.76069648229324
curr_Factors:  [101.76069648]
mat_Sqrt:  [[0.15]]
grads:  [0.07791926]
Stock Position:  0.07791926217462898
Bond Position:  [-9.0851533]


portfolio before change:  [-1.13523578]
curr_Stock_Price:  102.0349159608962
curr_Factors:  [102.03491596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339891]
Stock Position:  -0.0033989109619429227
Bond Position:  [-0.78842818]


portfolio before change:  [-1.13346809]
curr_Stock_Price:  101.50034354555692
curr_Factors:  [101.50034355]
mat_Sqrt:  [[0.15]]
grads:  [0.1238681]
Stock Position:  0.12386810398164838
Bond Position:  [-13.7061232]


portfolio before change:  [-1.12311598]
curr_Stock_Price:  101.59083314598384
curr_Factors:  [101.59083315]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987645]
Stock Position:  -0.14987645259024623
Bond Position:  [14.10295771]


portfolio before change:  [-1.11769254]
curr_Stock_Price:  101.56052839750029
curr_Factors:  [101.5605284]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165986]
Stock Position:  -0.02165985909031747
Bond Position:  [1.08209419]


portfolio before change:  [-1.11374793]
curr_Stock_Price:  101.38153436356579
curr_Factors:  [101.38153436]
mat_Sqrt:  [[0.15]]
grads:  [-0.06753831]
Stock Position:  -0.0675383067974495
Bond Position:  [5.73338925]


portfolio before change:  [-1.05857077]
curr_Stock_Price:  100.56986447433746
curr_Factors:  [100.56986447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059706]
Stock Position:  -0.010597056589704182
Bond Position:  [0.00717378]


portfolio before change:  [-1.06651294]
curr_Stock_Price:  101.31937644987914
curr_Factors:  [101.31937645]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.06651294]
Stock Price:  101.76564889072917
PL:  [-2.83216183]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.64456094e-04]
 [ 1.28093041e-03]
 [ 1.75235459e-04]
 [ 7.63624350e-03]
 [ 3.22177452e-03]
 [ 2.67335429e-02]
 [ 1.68810495e-03]
 [-1.72682343e-02]
 [ 2.45898956e-02]
 [-4.62418411e-03]
 [ 2.02765801e-02]
 [-4.59766488e-02]
 [ 5.04255237e-02]
 [ 1.08080006e-02]
 [-6.89994940e-03]
 [ 2.41287661e-02]
 [ 1.29473729e-02]
 [-9.66810946e-05]
 [ 1.07525811e-02]
 [-7.17217152e-03]
 [ 1.43636107e-02]
 [-1.06326589e-02]
 [ 1.10747739e-02]
 [-1.25691609e-02]
 [ 3.46962898e-03]
 [ 1.02123182e-02]
 [-5.37863457e-03]
 [ 9.49122608e-03]
 [ 4.20046336e-02]
 [ 2.73152063e-03]
 [ 1.80042758e-02]
 [-3.74812026e-03]
 [ 4.73249877e-04]
 [ 8.56120164e-03]
 [ 1.05516121e-02]
 [ 7.35490576e-03]
 [-3.24913212e-02]
 [ 8.87281189e-03]
 [ 1.17164401e-02]
 [ 1.14609509e-02]
 [-4.32343297e-03]
 [-2.02696936e-02]
 [ 2.13477304e-02]
 [ 1.68567520e-03]
 [-7.37516342e-03]
 [ 7.50109062e-05]
 [ 1.18701236e-02]
 [-7.12205552e-03]
 [-1.50738917e-02]
 [-6.98288603e-03]
 [ 4.57076991e-02]
 [-8.92363645e-03]
 [ 3.20831944e-03]
 [ 5.34855711e-03]
 [ 4.98414276e-03]
 [-2.39969402e-03]
 [ 7.49574001e-03]
 [-5.94871207e-04]
 [ 1.53478818e-03]
 [-5.85464037e-03]
 [-4.61318657e-03]
 [ 7.29552946e-03]
 [ 1.42784102e-02]
 [-1.87359551e-02]
 [-4.37875798e-03]
 [-1.53559692e-02]
 [-4.73483408e-03]
 [ 1.27228527e-02]
 [-1.19726558e-02]
 [ 9.84322000e-03]
 [ 2.97176327e-03]
 [ 1.21455809e-02]
 [ 3.68169913e-03]
 [-2.88753964e-04]
 [ 6.28268891e-03]
 [-1.44276322e-02]
 [ 4.73169596e-03]
 [ 3.82657196e-03]
 [-8.35969497e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.15435014]
curr_Stock_Price:  100.3324578792376
curr_Factors:  [100.33245788]
mat_Sqrt:  [[0.15]]
grads:  [0.00109637]
Stock Position:  0.0010963739581617913
Bond Position:  [7.04434824]


portfolio before change:  [7.15424826]
curr_Stock_Price:  99.83795182445276
curr_Factors:  [99.83795182]
mat_Sqrt:  [[0.15]]
grads:  [0.00853954]
Stock Position:  0.008539536047112318
Bond Position:  [6.30167847]


portfolio before change:  [7.15700031]
curr_Stock_Price:  100.11410056991821
curr_Factors:  [100.11410057]
mat_Sqrt:  [[0.15]]
grads:  [0.00116824]
Stock Position:  0.0011682363906045125
Bond Position:  [7.04004337]


portfolio before change:  [7.15733231]
curr_Stock_Price:  100.02164166856467
curr_Factors:  [100.02164167]
mat_Sqrt:  [[0.15]]
grads:  [0.05090829]
Stock Position:  0.050908289991783935
Bond Position:  [2.06540157]


portfolio before change:  [7.16952727]
curr_Stock_Price:  100.25865350463572
curr_Factors:  [100.2586535]
mat_Sqrt:  [[0.15]]
grads:  [0.0214785]
Stock Position:  0.02147849680264025
Bond Position:  [5.0161221]


portfolio before change:  [7.17271792]
curr_Stock_Price:  100.39260738155129
curr_Factors:  [100.39260738]
mat_Sqrt:  [[0.15]]
grads:  [0.17822362]
Stock Position:  0.1782236194788636
Bond Position:  [-10.71961594]


portfolio before change:  [7.13921057]
curr_Stock_Price:  100.20835938056334
curr_Factors:  [100.20835938]
mat_Sqrt:  [[0.15]]
grads:  [0.01125403]
Stock Position:  0.011254032982615911
Bond Position:  [6.01146239]


portfolio before change:  [7.13719282]
curr_Stock_Price:  99.99568193830062
curr_Factors:  [99.99568194]
mat_Sqrt:  [[0.15]]
grads:  [-0.11512156]
Stock Position:  -0.1151215618115814
Bond Position:  [18.6488519]


portfolio before change:  [7.04294624]
curr_Stock_Price:  100.82447695017309
curr_Factors:  [100.82447695]
mat_Sqrt:  [[0.15]]
grads:  [0.16393264]
Stock Position:  0.16393263725137788
Bond Position:  [-9.48547617]


portfolio before change:  [7.11592946]
curr_Stock_Price:  101.27329594502342
curr_Factors:  [101.27329595]
mat_Sqrt:  [[0.15]]
grads:  [-0.03082789]
Stock Position:  -0.030827894033990118
Bond Position:  [10.23797189]


portfolio before change:  [7.11984709]
curr_Stock_Price:  101.1669721728928
curr_Factors:  [101.16697217]
mat_Sqrt:  [[0.15]]
grads:  [0.1351772]
Stock Position:  0.13517720057344687
Bond Position:  [-6.555621]


portfolio before change:  [7.21072355]
curr_Stock_Price:  101.84227986580544
curr_Factors:  [101.84227987]
mat_Sqrt:  [[0.15]]
grads:  [-0.30651099]
Stock Position:  -0.30651099173697455
Bond Position:  [38.42650175]


portfolio before change:  [7.27139064]
curr_Stock_Price:  101.6521876482521
curr_Factors:  [101.65218765]
mat_Sqrt:  [[0.15]]
grads:  [0.33617016]
Stock Position:  0.33617015804087297
Bond Position:  [-26.90104135]


portfolio before change:  [7.52748563]
curr_Stock_Price:  102.41899087511051
curr_Factors:  [102.41899088]
mat_Sqrt:  [[0.15]]
grads:  [0.07205334]
Stock Position:  0.07205333716016442
Bond Position:  [0.14785555]


portfolio before change:  [7.46926935]
curr_Stock_Price:  101.61090168783474
curr_Factors:  [101.61090169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599966]
Stock Position:  -0.04599966268800164
Bond Position:  [12.14333655]


portfolio before change:  [7.46060819]
curr_Stock_Price:  101.8156889944436
curr_Factors:  [101.81568899]
mat_Sqrt:  [[0.15]]
grads:  [0.16085844]
Stock Position:  0.16085844039406222
Bond Position:  [-8.91730475]


portfolio before change:  [7.69280149]
curr_Stock_Price:  103.2626174665911
curr_Factors:  [103.26261747]
mat_Sqrt:  [[0.15]]
grads:  [0.08631582]
Stock Position:  0.08631581915705062
Bond Position:  [-1.22039592]


portfolio before change:  [7.74421251]
curr_Stock_Price:  103.85911639222705
curr_Factors:  [103.85911639]
mat_Sqrt:  [[0.15]]
grads:  [-0.00064454]
Stock Position:  -0.0006445406307069764
Bond Position:  [7.81115393]


portfolio before change:  [7.74482827]
curr_Stock_Price:  103.6612343004238
curr_Factors:  [103.6612343]
mat_Sqrt:  [[0.15]]
grads:  [0.07168387]
Stock Position:  0.07168387415330107
Bond Position:  [0.31398939]


portfolio before change:  [7.70991796]
curr_Stock_Price:  103.17395687339533
curr_Factors:  [103.17395687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04781448]
Stock Position:  -0.04781447677779479
Bond Position:  [12.64312672]


portfolio before change:  [7.71874856]
curr_Stock_Price:  103.00579903824688
curr_Factors:  [103.00579904]
mat_Sqrt:  [[0.15]]
grads:  [0.0957574]
Stock Position:  0.09575740470243624
Bond Position:  [-2.14481943]


portfolio before change:  [7.74928386]
curr_Stock_Price:  103.32608090481487
curr_Factors:  [103.3260809]
mat_Sqrt:  [[0.15]]
grads:  [-0.07088439]
Stock Position:  -0.07088439297832382
Bond Position:  [15.07349039]


portfolio before change:  [7.76795235]
curr_Stock_Price:  103.07600659257994
curr_Factors:  [103.07600659]
mat_Sqrt:  [[0.15]]
grads:  [0.07383183]
Stock Position:  0.07383182632449431
Bond Position:  [0.15766253]


portfolio before change:  [7.72442019]
curr_Stock_Price:  102.48626070712226
curr_Factors:  [102.48626071]
mat_Sqrt:  [[0.15]]
grads:  [-0.08379441]
Stock Position:  -0.08379440622855894
Bond Position:  [16.31219555]


portfolio before change:  [7.73858327]
curr_Stock_Price:  102.32940613336169
curr_Factors:  [102.32940613]
mat_Sqrt:  [[0.15]]
grads:  [0.02313086]
Stock Position:  0.02313085989652466
Bond Position:  [5.37161611]


portfolio before change:  [7.72990485]
curr_Stock_Price:  101.93970347020026
curr_Factors:  [101.93970347]
mat_Sqrt:  [[0.15]]
grads:  [0.06808212]
Stock Position:  0.06808212148989057
Bond Position:  [0.78963357]


portfolio before change:  [7.75033822]
curr_Stock_Price:  102.23910693373702
curr_Factors:  [102.23910693]
mat_Sqrt:  [[0.15]]
grads:  [-0.03585756]
Stock Position:  -0.03585756380033967
Bond Position:  [11.41638352]


portfolio before change:  [7.75703424]
curr_Stock_Price:  102.07226723493827
curr_Factors:  [102.07226723]
mat_Sqrt:  [[0.15]]
grads:  [0.06327484]
Stock Position:  0.06327484053087677
Bond Position:  [1.2984278]


portfolio before change:  [7.8126578]
curr_Stock_Price:  102.95006333546175
curr_Factors:  [102.95006334]
mat_Sqrt:  [[0.15]]
grads:  [0.28003089]
Stock Position:  0.280030890393404
Bond Position:  [-21.0165401]


portfolio before change:  [7.85403793]
curr_Stock_Price:  103.10252403440542
curr_Factors:  [103.10252403]
mat_Sqrt:  [[0.15]]
grads:  [0.01821014]
Stock Position:  0.01821013752723994
Bond Position:  [5.97652679]


portfolio before change:  [7.86052052]
curr_Stock_Price:  103.43799932594763
curr_Factors:  [103.43799933]
mat_Sqrt:  [[0.15]]
grads:  [0.12002851]
Stock Position:  0.12002850501439447
Bond Position:  [-4.5549879]


portfolio before change:  [7.86011234]
curr_Stock_Price:  103.43697047161498
curr_Factors:  [103.43697047]
mat_Sqrt:  [[0.15]]
grads:  [-0.02498747]
Stock Position:  -0.024987468428878654
Bond Position:  [10.44474037]


portfolio before change:  [7.86099078]
curr_Stock_Price:  103.42794070131413
curr_Factors:  [103.4279407]
mat_Sqrt:  [[0.15]]
grads:  [0.003155]
Stock Position:  0.003154999179057704
Bond Position:  [7.53467572]


portfolio before change:  [7.86145193]
curr_Stock_Price:  103.42483840776407
curr_Factors:  [103.42483841]
mat_Sqrt:  [[0.15]]
grads:  [0.05707468]
Stock Position:  0.057074677609336814
Bond Position:  [1.95851262]


portfolio before change:  [7.84021907]
curr_Stock_Price:  103.05067480218675
curr_Factors:  [103.0506748]
mat_Sqrt:  [[0.15]]
grads:  [0.07034408]
Stock Position:  0.07034408050818355
Bond Position:  [0.59121411]


portfolio before change:  [7.87485044]
curr_Stock_Price:  103.54246336547051
curr_Factors:  [103.54246337]
mat_Sqrt:  [[0.15]]
grads:  [0.04903271]
Stock Position:  0.04903270503495902
Bond Position:  [2.79788337]


portfolio before change:  [7.90316325]
curr_Stock_Price:  104.11632389692583
curr_Factors:  [104.1163239]
mat_Sqrt:  [[0.15]]
grads:  [-0.21660881]
Stock Position:  -0.21660880811769248
Bond Position:  [30.45567607]


portfolio before change:  [7.96926371]
curr_Stock_Price:  103.81995126910714
curr_Factors:  [103.81995127]
mat_Sqrt:  [[0.15]]
grads:  [0.05915208]
Stock Position:  0.059152079295616534
Bond Position:  [1.82809772]


portfolio before change:  [7.97012485]
curr_Stock_Price:  103.83257771726237
curr_Factors:  [103.83257772]
mat_Sqrt:  [[0.15]]
grads:  [0.0781096]
Stock Position:  0.07810960089685573
Bond Position:  [-0.14019636]


portfolio before change:  [7.94074866]
curr_Stock_Price:  103.45660053167389
curr_Factors:  [103.45660053]
mat_Sqrt:  [[0.15]]
grads:  [0.07640634]
Stock Position:  0.07640633963644855
Bond Position:  [0.0360085]


portfolio before change:  [7.89816387]
curr_Stock_Price:  102.89922476813885
curr_Factors:  [102.89922477]
mat_Sqrt:  [[0.15]]
grads:  [-0.02882289]
Stock Position:  -0.028822886460198646
Bond Position:  [10.86401654]


portfolio before change:  [7.90568799]
curr_Stock_Price:  102.66173630722162
curr_Factors:  [102.66173631]
mat_Sqrt:  [[0.15]]
grads:  [-0.13513129]
Stock Position:  -0.13513129039393956
Bond Position:  [21.77850089]


portfolio before change:  [8.0039001]
curr_Stock_Price:  101.94501919894394
curr_Factors:  [101.9450192]
mat_Sqrt:  [[0.15]]
grads:  [0.1423182]
Stock Position:  0.1423182023951816
Bond Position:  [-6.50473178]


portfolio before change:  [7.94254747]
curr_Stock_Price:  101.51678114561209
curr_Factors:  [101.51678115]
mat_Sqrt:  [[0.15]]
grads:  [0.01123783]
Stock Position:  0.011237834646415189
Bond Position:  [6.80171867]


portfolio before change:  [7.93482884]
curr_Stock_Price:  100.7921090654127
curr_Factors:  [100.79210907]
mat_Sqrt:  [[0.15]]
grads:  [-0.04916776]
Stock Position:  -0.049167756137057934
Bond Position:  [12.89055068]


portfolio before change:  [7.91974671]
curr_Stock_Price:  101.1152439050849
curr_Factors:  [101.11524391]
mat_Sqrt:  [[0.15]]
grads:  [0.00050007]
Stock Position:  0.0005000727082840375
Bond Position:  [7.86918174]


portfolio before change:  [7.92045215]
curr_Stock_Price:  101.54236682144374
curr_Factors:  [101.54236682]
mat_Sqrt:  [[0.15]]
grads:  [0.07913416]
Stock Position:  0.07913415755056108
Bond Position:  [-0.11501751]


portfolio before change:  [7.87799437]
curr_Stock_Price:  101.00592864421846
curr_Factors:  [101.00592864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748037]
Stock Position:  -0.047480370121222706
Bond Position:  [12.67379325]


portfolio before change:  [7.92864424]
curr_Stock_Price:  99.95585831496375
curr_Factors:  [99.95585831]
mat_Sqrt:  [[0.15]]
grads:  [-0.10049261]
Stock Position:  -0.10049261124575357
Bond Position:  [17.97346945]


portfolio before change:  [7.91089794]
curr_Stock_Price:  100.1436301040543
curr_Factors:  [100.1436301]
mat_Sqrt:  [[0.15]]
grads:  [-0.04655257]
Stock Position:  -0.046552573526480595
Bond Position:  [12.57284164]


portfolio before change:  [7.91815304]
curr_Stock_Price:  100.00466307459205
curr_Factors:  [100.00466307]
mat_Sqrt:  [[0.15]]
grads:  [0.30471799]
Stock Position:  0.3047179939215279
Bond Position:  [-22.55506728]


portfolio before change:  [7.73986112]
curr_Stock_Price:  99.42418477919718
curr_Factors:  [99.42418478]
mat_Sqrt:  [[0.15]]
grads:  [-0.05949091]
Stock Position:  -0.0594909096770394
Bond Position:  [13.65469632]


portfolio before change:  [7.74224209]
curr_Stock_Price:  99.39850817499826
curr_Factors:  [99.39850817]
mat_Sqrt:  [[0.15]]
grads:  [0.0213888]
Stock Position:  0.021388796246283905
Bond Position:  [5.61622765]


portfolio before change:  [7.72987749]
curr_Stock_Price:  98.80400894053577
curr_Factors:  [98.80400894]
mat_Sqrt:  [[0.15]]
grads:  [0.03565705]
Stock Position:  0.035657047378387256
Bond Position:  [4.20681826]


portfolio before change:  [7.69286596]
curr_Stock_Price:  97.75864840048224
curr_Factors:  [97.7586484]
mat_Sqrt:  [[0.15]]
grads:  [0.03322762]
Stock Position:  0.03322761842064453
Bond Position:  [4.44457889]


portfolio before change:  [7.70593276]
curr_Stock_Price:  98.14353932290945
curr_Factors:  [98.14353932]
mat_Sqrt:  [[0.15]]
grads:  [-0.01599796]
Stock Position:  -0.01599796013266311
Bond Position:  [9.27602919]


portfolio before change:  [7.70851016]
curr_Stock_Price:  98.01867168180587
curr_Factors:  [98.01867168]
mat_Sqrt:  [[0.15]]
grads:  [0.0499716]
Stock Position:  0.04997160006117887
Bond Position:  [2.8103603]


portfolio before change:  [7.71205913]
curr_Stock_Price:  98.08617637558089
curr_Factors:  [98.08617638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00396581]
Stock Position:  -0.003965808048004336
Bond Position:  [8.10105008]


portfolio before change:  [7.7120323]
curr_Stock_Price:  98.22061544057843
curr_Factors:  [98.22061544]
mat_Sqrt:  [[0.15]]
grads:  [0.01023192]
Stock Position:  0.010231921199642011
Bond Position:  [6.7070467]


portfolio before change:  [7.70246105]
curr_Stock_Price:  97.24421476589947
curr_Factors:  [97.24421477]
mat_Sqrt:  [[0.15]]
grads:  [-0.03903094]
Stock Position:  -0.039030935778715414
Bond Position:  [11.49799375]


portfolio before change:  [7.71425593]
curr_Stock_Price:  96.96043376571544
curr_Factors:  [96.96043377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075458]
Stock Position:  -0.030754577116940993
Bond Position:  [10.69623307]


portfolio before change:  [7.71388575]
curr_Stock_Price:  96.99420823315637
curr_Factors:  [96.99420823]
mat_Sqrt:  [[0.15]]
grads:  [0.04863686]
Stock Position:  0.04863686308040602
Bond Position:  [2.99639172]


portfolio before change:  [7.69642303]
curr_Stock_Price:  96.63131478293363
curr_Factors:  [96.63131478]
mat_Sqrt:  [[0.15]]
grads:  [0.0951894]
Stock Position:  0.0951894015221342
Bond Position:  [-1.50185399]


portfolio before change:  [7.68267031]
curr_Stock_Price:  96.48782346654606
curr_Factors:  [96.48782347]
mat_Sqrt:  [[0.15]]
grads:  [-0.12490637]
Stock Position:  -0.12490636753152355
Bond Position:  [19.73461385]


portfolio before change:  [7.76596538]
curr_Stock_Price:  95.83083840532285
curr_Factors:  [95.83083841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02919172]
Stock Position:  -0.02919171985581478
Bond Position:  [10.56343237]


portfolio before change:  [7.75977405]
curr_Stock_Price:  96.06554753138774
curr_Factors:  [96.06554753]
mat_Sqrt:  [[0.15]]
grads:  [-0.10237313]
Stock Position:  -0.10237312808199228
Bond Position:  [17.59430465]


portfolio before change:  [7.69194007]
curr_Stock_Price:  96.73890455043829
curr_Factors:  [96.73890455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03156556]
Stock Position:  -0.03156556050235601
Bond Position:  [10.74555781]


portfolio before change:  [7.69402685]
curr_Stock_Price:  96.694071876154
curr_Factors:  [96.69407188]
mat_Sqrt:  [[0.15]]
grads:  [0.08481902]
Stock Position:  0.08481901777342216
Bond Position:  [-0.50746935]


portfolio before change:  [7.67839235]
curr_Stock_Price:  96.51011803384888
curr_Factors:  [96.51011803]
mat_Sqrt:  [[0.15]]
grads:  [-0.07981771]
Stock Position:  -0.07981770507604713
Bond Position:  [15.38160849]


portfolio before change:  [7.68248577]
curr_Stock_Price:  96.47087807185142
curr_Factors:  [96.47087807]
mat_Sqrt:  [[0.15]]
grads:  [0.06562147]
Stock Position:  0.06562146667161917
Bond Position:  [1.35192526]


portfolio before change:  [7.61813179]
curr_Stock_Price:  95.48890551865296
curr_Factors:  [95.48890552]
mat_Sqrt:  [[0.15]]
grads:  [0.01981176]
Stock Position:  0.01981175515518116
Bond Position:  [5.72632898]


portfolio before change:  [7.61539588]
curr_Stock_Price:  95.3327444866469
curr_Factors:  [95.33274449]
mat_Sqrt:  [[0.15]]
grads:  [0.08097054]
Stock Position:  0.0809705394630111
Bond Position:  [-0.10374787]


portfolio before change:  [7.56580525]
curr_Stock_Price:  94.72037192315372
curr_Factors:  [94.72037192]
mat_Sqrt:  [[0.15]]
grads:  [0.02454466]
Stock Position:  0.024544660844308522
Bond Position:  [5.24092585]


portfolio before change:  [7.5648714]
curr_Stock_Price:  94.66897882881564
curr_Factors:  [94.66897883]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192503]
Stock Position:  -0.0019250264277235524
Bond Position:  [7.74711168]


portfolio before change:  [7.56475008]
curr_Stock_Price:  94.98353413020654
curr_Factors:  [94.98353413]
mat_Sqrt:  [[0.15]]
grads:  [0.04188459]
Stock Position:  0.04188459273817689
Bond Position:  [3.58640344]


portfolio before change:  [7.60586751]
curr_Stock_Price:  95.95986618110227
curr_Factors:  [95.95986618]
mat_Sqrt:  [[0.15]]
grads:  [-0.09618421]
Stock Position:  -0.09618421450873708
Bond Position:  [16.83569186]


portfolio before change:  [7.5668595]
curr_Stock_Price:  96.3763614470724
curr_Factors:  [96.37636145]
mat_Sqrt:  [[0.15]]
grads:  [0.03154464]
Stock Position:  0.03154463972507487
Bond Position:  [4.5267019]


portfolio before change:  [7.5919401]
curr_Stock_Price:  97.16247499174325
curr_Factors:  [97.16247499]
mat_Sqrt:  [[0.15]]
grads:  [0.02551048]
Stock Position:  0.025510479736863247
Bond Position:  [5.11327875]


portfolio before change:  [7.60126592]
curr_Stock_Price:  97.5155156681171
curr_Factors:  [97.51551567]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.60126592]
Stock Price:  97.23141764047264
PL:  [7.60126592]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.56255816e-03]
 [-3.40012650e-02]
 [-9.03276684e-03]
 [ 2.52750689e-03]
 [-1.16572558e-02]
 [ 1.94455970e-03]
 [ 4.63074104e-03]
 [-2.77992715e-02]
 [-2.57535397e-02]
 [ 2.42728212e-02]
 [-4.90256631e-02]
 [ 2.32379774e-02]
 [-1.22212913e-02]
 [ 7.40410341e-03]
 [-6.96680179e-03]
 [ 7.13425982e-03]
 [ 7.27880267e-03]
 [-1.00253878e-02]
 [-2.73757767e-04]
 [ 1.21340211e-02]
 [ 1.24149710e-02]
 [-7.44014009e-03]
 [ 7.70668496e-03]
 [ 1.62491014e-02]
 [ 8.14934368e-04]
 [ 1.12838938e-02]
 [-5.84109333e-03]
 [ 8.48591365e-03]
 [ 1.03101031e-02]
 [-2.82980096e-03]
 [ 8.38594100e-03]
 [-1.20818537e-02]
 [ 4.32217100e-03]
 [ 4.71065064e-03]
 [ 1.19677706e-02]
 [ 1.38119952e-02]
 [-3.45751388e-02]
 [ 9.74844452e-03]
 [-6.27604504e-04]
 [ 1.88459676e-02]
 [-6.09101755e-03]
 [-1.23424070e-02]
 [ 2.33731493e-02]
 [ 3.46387730e-03]
 [-7.55842174e-03]
 [ 1.49970899e-03]
 [ 9.10956081e-03]
 [-5.45838485e-03]
 [-1.00330405e-02]
 [-7.66701013e-03]
 [ 4.00843690e-02]
 [-7.72342482e-03]
 [ 7.33255418e-04]
 [ 5.38566866e-03]
 [ 1.15627028e-03]
 [ 5.16474770e-03]
 [ 9.44545978e-03]
 [-3.21481027e-04]
 [ 1.68265441e-03]
 [ 1.61605884e-02]
 [ 6.00807818e-03]
 [ 1.40313007e-02]
 [ 1.85878887e-04]
 [-1.29325213e-02]
 [-3.28423127e-03]
 [ 1.54081853e-04]
 [-5.53059485e-03]
 [ 1.96840651e-02]
 [-8.17872977e-03]
 [ 8.75462015e-03]
 [-1.04621331e-02]
 [ 1.08763238e-02]
 [-8.37890282e-03]
 [ 1.62419727e-02]
 [-2.17811660e-02]
 [-4.27134189e-03]
 [-7.31946232e-03]
 [-4.05042700e-04]
 [-6.68609365e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.61854803]
curr_Stock_Price:  99.0467259889914
curr_Factors:  [99.04672599]
mat_Sqrt:  [[0.15]]
grads:  [0.05041705]
Stock Position:  0.05041705438951193
Bond Position:  [-17.6121922]


portfolio before change:  [-12.65047772]
curr_Stock_Price:  98.4352484237301
curr_Factors:  [98.43524842]
mat_Sqrt:  [[0.15]]
grads:  [-0.2266751]
Stock Position:  -0.22667509976131206
Bond Position:  [9.66234204]


portfolio before change:  [-12.54876154]
curr_Stock_Price:  97.98918148071671
curr_Factors:  [97.98918148]
mat_Sqrt:  [[0.15]]
grads:  [-0.06021845]
Stock Position:  -0.06021844562366284
Bond Position:  [-6.64800534]


portfolio before change:  [-12.51233734]
curr_Stock_Price:  97.37741358464687
curr_Factors:  [97.37741358]
mat_Sqrt:  [[0.15]]
grads:  [0.01685005]
Stock Position:  0.01685004596438446
Bond Position:  [-14.15315123]


portfolio before change:  [-12.5171873]
curr_Stock_Price:  97.14208117203495
curr_Factors:  [97.14208117]
mat_Sqrt:  [[0.15]]
grads:  [-0.07771504]
Stock Position:  -0.07771503871240776
Bond Position:  [-4.9677867]


portfolio before change:  [-12.48445813]
curr_Stock_Price:  96.71694248133271
curr_Factors:  [96.71694248]
mat_Sqrt:  [[0.15]]
grads:  [0.01296373]
Stock Position:  0.012963731311984954
Bond Position:  [-13.73827058]


portfolio before change:  [-12.47532034]
curr_Stock_Price:  97.48805190859345
curr_Factors:  [97.48805191]
mat_Sqrt:  [[0.15]]
grads:  [0.03087161]
Stock Position:  0.030871606942374473
Bond Position:  [-15.48493316]


portfolio before change:  [-12.48257621]
curr_Stock_Price:  97.28436860024851
curr_Factors:  [97.2843686]
mat_Sqrt:  [[0.15]]
grads:  [-0.18532848]
Stock Position:  -0.18532847668197602
Bond Position:  [5.54698763]


portfolio before change:  [-12.5155102]
curr_Stock_Price:  97.46394535229977
curr_Factors:  [97.46394535]
mat_Sqrt:  [[0.15]]
grads:  [-0.17169026]
Stock Position:  -0.1716902647946561
Bond Position:  [4.21810039]


portfolio before change:  [-12.68403638]
curr_Stock_Price:  98.44705192299496
curr_Factors:  [98.44705192]
mat_Sqrt:  [[0.15]]
grads:  [0.16181881]
Stock Position:  0.16181880767123574
Bond Position:  [-28.61462095]


portfolio before change:  [-12.82275492]
curr_Stock_Price:  97.60085813908567
curr_Factors:  [97.60085814]
mat_Sqrt:  [[0.15]]
grads:  [-0.32683775]
Stock Position:  -0.32683775379103935
Bond Position:  [19.07689032]


portfolio before change:  [-13.1079936]
curr_Stock_Price:  98.47722881256799
curr_Factors:  [98.47722881]
mat_Sqrt:  [[0.15]]
grads:  [0.15491985]
Stock Position:  0.1549198491770911
Bond Position:  [-28.36407104]


portfolio before change:  [-12.96784311]
curr_Stock_Price:  99.39333675621289
curr_Factors:  [99.39333676]
mat_Sqrt:  [[0.15]]
grads:  [-0.08147528]
Stock Position:  -0.08147527529326895
Bond Position:  [-4.86974363]


portfolio before change:  [-12.91616342]
curr_Stock_Price:  98.75530195925025
curr_Factors:  [98.75530196]
mat_Sqrt:  [[0.15]]
grads:  [0.04936069]
Stock Position:  0.04936068942177462
Bond Position:  [-17.7907932]


portfolio before change:  [-12.92244837]
curr_Stock_Price:  98.65050215031927
curr_Factors:  [98.65050215]
mat_Sqrt:  [[0.15]]
grads:  [-0.04644535]
Stock Position:  -0.04644534523848796
Bond Position:  [-8.34059174]


portfolio before change:  [-12.94150573]
curr_Stock_Price:  99.04959628284615
curr_Factors:  [99.04959628]
mat_Sqrt:  [[0.15]]
grads:  [0.04756173]
Stock Position:  0.04756173214786071
Bond Position:  [-17.6524761]


portfolio before change:  [-12.92241837]
curr_Stock_Price:  99.47411139656872
curr_Factors:  [99.4741114]
mat_Sqrt:  [[0.15]]
grads:  [0.04852535]
Stock Position:  0.04852535110210419
Bond Position:  [-17.74943456]


portfolio before change:  [-12.94451454]
curr_Stock_Price:  99.04162007907772
curr_Factors:  [99.04162008]
mat_Sqrt:  [[0.15]]
grads:  [-0.06683592]
Stock Position:  -0.06683591847158216
Bond Position:  [-6.3249769]


portfolio before change:  [-13.00991901]
curr_Stock_Price:  100.01428793162793
curr_Factors:  [100.01428793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00182505]
Stock Position:  -0.001825051781595861
Bond Position:  [-12.82738776]


portfolio before change:  [-13.01081971]
curr_Stock_Price:  100.06850953059659
curr_Factors:  [100.06850953]
mat_Sqrt:  [[0.15]]
grads:  [0.08089347]
Stock Position:  0.08089347393266014
Bond Position:  [-21.10570908]


portfolio before change:  [-12.92695055]
curr_Stock_Price:  101.1216019223032
curr_Factors:  [101.12160192]
mat_Sqrt:  [[0.15]]
grads:  [0.08276647]
Stock Position:  0.08276647350699848
Bond Position:  [-21.29642894]


portfolio before change:  [-12.99045704]
curr_Stock_Price:  100.37038689849348
curr_Factors:  [100.3703869]
mat_Sqrt:  [[0.15]]
grads:  [-0.04960093]
Stock Position:  -0.04960093395949154
Bond Position:  [-8.01199211]


portfolio before change:  [-13.03093247]
curr_Stock_Price:  101.17631249531665
curr_Factors:  [101.1763125]
mat_Sqrt:  [[0.15]]
grads:  [0.0513779]
Stock Position:  0.051377899749335244
Bond Position:  [-18.22915891]


portfolio before change:  [-13.02422485]
curr_Stock_Price:  101.32904305795634
curr_Factors:  [101.32904306]
mat_Sqrt:  [[0.15]]
grads:  [0.10832734]
Stock Position:  0.10832734273074504
Bond Position:  [-24.00093083]


portfolio before change:  [-13.06964763]
curr_Stock_Price:  100.92358054407028
curr_Factors:  [100.92358054]
mat_Sqrt:  [[0.15]]
grads:  [0.0054329]
Stock Position:  0.0054328957889134
Bond Position:  [-13.61795493]


portfolio before change:  [-13.06672983]
curr_Stock_Price:  101.61730930798916
curr_Factors:  [101.61730931]
mat_Sqrt:  [[0.15]]
grads:  [0.07522596]
Stock Position:  0.07522595876013986
Bond Position:  [-20.71098934]


portfolio before change:  [-13.10307116]
curr_Stock_Price:  101.15142154919252
curr_Factors:  [101.15142155]
mat_Sqrt:  [[0.15]]
grads:  [-0.03894062]
Stock Position:  -0.03894062219327311
Bond Position:  [-9.16417187]


portfolio before change:  [-13.11759983]
curr_Stock_Price:  101.50981078512064
curr_Factors:  [101.50981079]
mat_Sqrt:  [[0.15]]
grads:  [0.05657276]
Stock Position:  0.056572757670019944
Bond Position:  [-18.86028976]


portfolio before change:  [-13.15292156]
curr_Stock_Price:  100.90628842381831
curr_Factors:  [100.90628842]
mat_Sqrt:  [[0.15]]
grads:  [0.06873402]
Stock Position:  0.06873402057666142
Bond Position:  [-20.08861647]


portfolio before change:  [-13.15192755]
curr_Stock_Price:  100.93901735456028
curr_Factors:  [100.93901735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01886534]
Stock Position:  -0.018865339751343083
Bond Position:  [-11.24767869]


portfolio before change:  [-13.15341307]
curr_Stock_Price:  100.98049626684065
curr_Factors:  [100.98049627]
mat_Sqrt:  [[0.15]]
grads:  [0.05590627]
Stock Position:  0.05590627330464651
Bond Position:  [-18.79885629]


portfolio before change:  [-13.17158869]
curr_Stock_Price:  100.6764041475215
curr_Factors:  [100.67640415]
mat_Sqrt:  [[0.15]]
grads:  [-0.08054569]
Stock Position:  -0.08054569108278271
Bond Position:  [-5.06253814]


portfolio before change:  [-13.14378137]
curr_Stock_Price:  100.32723910220388
curr_Factors:  [100.3272391]
mat_Sqrt:  [[0.15]]
grads:  [0.02881447]
Stock Position:  0.028814473325066408
Bond Position:  [-16.03465792]


portfolio before change:  [-13.16248764]
curr_Stock_Price:  99.71282317564503
curr_Factors:  [99.71282318]
mat_Sqrt:  [[0.15]]
grads:  [0.03140434]
Stock Position:  0.031404337575037654
Bond Position:  [-16.2939028]


portfolio before change:  [-13.16912051]
curr_Stock_Price:  99.53404311956777
curr_Factors:  [99.53404312]
mat_Sqrt:  [[0.15]]
grads:  [0.07978514]
Stock Position:  0.07978513721404505
Bond Position:  [-21.11045779]


portfolio before change:  [-13.18477241]
curr_Stock_Price:  99.3544049057022
curr_Factors:  [99.35440491]
mat_Sqrt:  [[0.15]]
grads:  [0.09207997]
Stock Position:  0.0920799678341043
Bond Position:  [-22.33332282]


portfolio before change:  [-13.11270834]
curr_Stock_Price:  100.15218909339815
curr_Factors:  [100.15218909]
mat_Sqrt:  [[0.15]]
grads:  [-0.23050093]
Stock Position:  -0.2305009253990772
Bond Position:  [9.97246392]


portfolio before change:  [-13.24963118]
curr_Stock_Price:  100.74891615126468
curr_Factors:  [100.74891615]
mat_Sqrt:  [[0.15]]
grads:  [0.06498963]
Stock Position:  0.06498963010696224
Bond Position:  [-19.79726598]


portfolio before change:  [-13.23924218]
curr_Stock_Price:  100.9278120253822
curr_Factors:  [100.92781203]
mat_Sqrt:  [[0.15]]
grads:  [-0.00418403]
Stock Position:  -0.00418403002846775
Bond Position:  [-12.81695718]


portfolio before change:  [-13.23916638]
curr_Stock_Price:  100.71823478176633
curr_Factors:  [100.71823478]
mat_Sqrt:  [[0.15]]
grads:  [0.12563978]
Stock Position:  0.12563978404081533
Bond Position:  [-25.89338365]


portfolio before change:  [-13.26919069]
curr_Stock_Price:  100.49214460836603
curr_Factors:  [100.49214461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04060678]
Stock Position:  -0.040606783667855195
Bond Position:  [-9.18852791]


portfolio before change:  [-13.25572868]
curr_Stock_Price:  100.14648049643748
curr_Factors:  [100.1464805]
mat_Sqrt:  [[0.15]]
grads:  [-0.08228271]
Stock Position:  -0.08228271348429131
Bond Position:  [-5.01540452]


portfolio before change:  [-13.27475478]
curr_Stock_Price:  100.373899178933
curr_Factors:  [100.37389918]
mat_Sqrt:  [[0.15]]
grads:  [0.155821]
Stock Position:  0.15582099531594462
Bond Position:  [-28.91511566]


portfolio before change:  [-13.27865627]
curr_Stock_Price:  100.36045914381424
curr_Factors:  [100.36045914]
mat_Sqrt:  [[0.15]]
grads:  [0.02309252]
Stock Position:  0.02309251532703333
Bond Position:  [-15.59623171]


portfolio before change:  [-13.27302373]
curr_Stock_Price:  100.64658397149255
curr_Factors:  [100.64658397]
mat_Sqrt:  [[0.15]]
grads:  [-0.05038948]
Stock Position:  -0.050389478284058375
Bond Position:  [-8.20149487]


portfolio before change:  [-13.27015943]
curr_Stock_Price:  100.57956778373446
curr_Factors:  [100.57956778]
mat_Sqrt:  [[0.15]]
grads:  [0.00999806]
Stock Position:  0.00999805990644603
Bond Position:  [-14.27575997]


portfolio before change:  [-13.27050242]
curr_Stock_Price:  100.63450503567707
curr_Factors:  [100.63450504]
mat_Sqrt:  [[0.15]]
grads:  [0.06073041]
Stock Position:  0.06073040542407936
Bond Position:  [-19.38207671]


portfolio before change:  [-13.23273212]
curr_Stock_Price:  101.27638640503282
curr_Factors:  [101.27638641]
mat_Sqrt:  [[0.15]]
grads:  [-0.03638923]
Stock Position:  -0.03638923230794892
Bond Position:  [-9.54736217]


portfolio before change:  [-13.22511519]
curr_Stock_Price:  101.05066968376164
curr_Factors:  [101.05066968]
mat_Sqrt:  [[0.15]]
grads:  [-0.06688694]
Stock Position:  -0.06688693660365969
Bond Position:  [-6.46614546]


portfolio before change:  [-13.22739257]
curr_Stock_Price:  101.07867563222428
curr_Factors:  [101.07867563]
mat_Sqrt:  [[0.15]]
grads:  [-0.0511134]
Stock Position:  -0.05111340085360358
Bond Position:  [-8.06091771]


portfolio before change:  [-13.18842326]
curr_Stock_Price:  100.30640972278623
curr_Factors:  [100.30640972]
mat_Sqrt:  [[0.15]]
grads:  [0.26722913]
Stock Position:  0.2672291263419543
Bond Position:  [-39.9932175]


portfolio before change:  [-13.07637312]
curr_Stock_Price:  100.735067331218
curr_Factors:  [100.73506733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514895]
Stock Position:  -0.05148949877695102
Bond Position:  [-7.88957499]


portfolio before change:  [-13.06829575]
curr_Stock_Price:  100.56861630951556
curr_Factors:  [100.56861631]
mat_Sqrt:  [[0.15]]
grads:  [0.00488837]
Stock Position:  0.004888369451907909
Bond Position:  [-13.5599123]


portfolio before change:  [-13.06452888]
curr_Stock_Price:  101.51256928097996
curr_Factors:  [101.51256928]
mat_Sqrt:  [[0.15]]
grads:  [0.03590446]
Stock Position:  0.03590445770341748
Bond Position:  [-16.70928263]


portfolio before change:  [-13.0526598]
curr_Stock_Price:  101.87223048019402
curr_Factors:  [101.87223048]
mat_Sqrt:  [[0.15]]
grads:  [0.00770847]
Stock Position:  0.007708468516203337
Bond Position:  [-13.83793868]


portfolio before change:  [-13.04613978]
curr_Stock_Price:  102.83025807778542
curr_Factors:  [102.83025808]
mat_Sqrt:  [[0.15]]
grads:  [0.03443165]
Stock Position:  0.03443165133312841
Bond Position:  [-16.58675537]


portfolio before change:  [-13.05591818]
curr_Stock_Price:  102.57637239621351
curr_Factors:  [102.5763724]
mat_Sqrt:  [[0.15]]
grads:  [0.06296973]
Stock Position:  0.0629697318827296
Bond Position:  [-19.51512485]


portfolio before change:  [-13.05027323]
curr_Stock_Price:  102.68538810340374
curr_Factors:  [102.6853881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00214321]
Stock Position:  -0.0021432068495675738
Bond Position:  [-12.8301972]


portfolio before change:  [-13.05116857]
curr_Stock_Price:  102.72898126846957
curr_Factors:  [102.72898127]
mat_Sqrt:  [[0.15]]
grads:  [0.0112177]
Stock Position:  0.011217696061777015
Bond Position:  [-14.20355106]


portfolio before change:  [-13.05318455]
curr_Stock_Price:  102.62840559881663
curr_Factors:  [102.6284056]
mat_Sqrt:  [[0.15]]
grads:  [0.10773726]
Stock Position:  0.10773725617905432
Bond Position:  [-24.11008737]


portfolio before change:  [-12.90248123]
curr_Stock_Price:  104.04119672207071
curr_Factors:  [104.04119672]
mat_Sqrt:  [[0.15]]
grads:  [0.04005385]
Stock Position:  0.04005385452277037
Bond Position:  [-17.06973219]


portfolio before change:  [-12.95702396]
curr_Stock_Price:  102.70609829047046
curr_Factors:  [102.70609829]
mat_Sqrt:  [[0.15]]
grads:  [0.093542]
Stock Position:  0.09354200438812621
Bond Position:  [-22.56435826]


portfolio before change:  [-12.96204587]
curr_Stock_Price:  102.66748897502634
curr_Factors:  [102.66748898]
mat_Sqrt:  [[0.15]]
grads:  [0.00123919]
Stock Position:  0.001239192577840957
Bond Position:  [-13.08927066]


portfolio before change:  [-12.96453759]
curr_Stock_Price:  101.31692358943891
curr_Factors:  [101.31692359]
mat_Sqrt:  [[0.15]]
grads:  [-0.08621681]
Stock Position:  -0.08621680885698445
Bond Position:  [-4.22931575]


portfolio before change:  [-12.99125929]
curr_Stock_Price:  101.62379374321539
curr_Factors:  [101.62379374]
mat_Sqrt:  [[0.15]]
grads:  [-0.02189488]
Stock Position:  -0.02189487515427163
Bond Position:  [-10.76621902]


portfolio before change:  [-12.97752595]
curr_Stock_Price:  100.96582008120399
curr_Factors:  [100.96582008]
mat_Sqrt:  [[0.15]]
grads:  [0.00102721]
Stock Position:  0.001027212353747383
Bond Position:  [-13.08123929]


portfolio before change:  [-12.97802407]
curr_Stock_Price:  101.27684007515492
curr_Factors:  [101.27684008]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687063]
Stock Position:  -0.03687063233810124
Bond Position:  [-9.24388294]


portfolio before change:  [-12.97069541]
curr_Stock_Price:  101.062403298408
curr_Factors:  [101.0624033]
mat_Sqrt:  [[0.15]]
grads:  [0.1312271]
Stock Position:  0.13122710053153772
Bond Position:  [-26.23282157]


portfolio before change:  [-13.00425621]
curr_Stock_Price:  100.8191517864392
curr_Factors:  [100.81915179]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452487]
Stock Position:  -0.054524865118120415
Bond Position:  [-7.50710555]


portfolio before change:  [-13.0048167]
curr_Stock_Price:  100.82082605542648
curr_Factors:  [100.82082606]
mat_Sqrt:  [[0.15]]
grads:  [0.05836413]
Stock Position:  0.05836413432767397
Bond Position:  [-18.88913694]


portfolio before change:  [-13.02905929]
curr_Stock_Price:  100.42568654618518
curr_Factors:  [100.42568655]
mat_Sqrt:  [[0.15]]
grads:  [-0.06974755]
Stock Position:  -0.06974755399942284
Bond Position:  [-6.02461329]


portfolio before change:  [-13.0189211]
curr_Stock_Price:  100.27493238686412
curr_Factors:  [100.27493239]
mat_Sqrt:  [[0.15]]
grads:  [0.07250883]
Stock Position:  0.07250882564903674
Bond Position:  [-20.28973869]


portfolio before change:  [-12.99090844]
curr_Stock_Price:  100.67875649630257
curr_Factors:  [100.6787565]
mat_Sqrt:  [[0.15]]
grads:  [-0.05585935]
Stock Position:  -0.0558593521178011
Bond Position:  [-7.36705833]


portfolio before change:  [-12.9853617]
curr_Stock_Price:  100.57121502947226
curr_Factors:  [100.57121503]
mat_Sqrt:  [[0.15]]
grads:  [0.10827982]
Stock Position:  0.10827981804965435
Bond Position:  [-23.87519456]


portfolio before change:  [-13.03043579]
curr_Stock_Price:  100.16872229828117
curr_Factors:  [100.1687223]
mat_Sqrt:  [[0.15]]
grads:  [-0.14520777]
Stock Position:  -0.14520777340624413
Bond Position:  [1.51484134]


portfolio before change:  [-13.02538113]
curr_Stock_Price:  100.13456452804637
curr_Factors:  [100.13456453]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847561]
Stock Position:  -0.0284756126284446
Bond Position:  [-10.17398806]


portfolio before change:  [-13.02935048]
curr_Stock_Price:  100.25162806698343
curr_Factors:  [100.25162807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04879642]
Stock Position:  -0.04879641544563619
Bond Position:  [-8.13743039]


portfolio before change:  [-12.96666258]
curr_Stock_Price:  98.9565225836412
curr_Factors:  [98.95652258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00270028]
Stock Position:  -0.002700284666891034
Bond Position:  [-12.6994518]


portfolio before change:  [-12.96691802]
curr_Stock_Price:  98.75717194662109
curr_Factors:  [98.75717195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.96691802]
Stock Price:  98.35822196468129
PL:  [-12.96691802]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.19379113e-04]
 [ 2.05855834e-03]
 [ 5.95359267e-04]
 [ 7.74790077e-03]
 [ 4.76381959e-03]
 [ 2.27602899e-02]
 [ 1.65953832e-03]
 [-1.79770036e-02]
 [-9.50163764e-04]
 [ 2.15238638e-02]
 [ 1.37797319e-02]
 [ 2.09169525e-02]
 [-1.47047516e-02]
 [ 3.13235196e-03]
 [-7.01307355e-03]
 [ 9.01462454e-03]
 [ 1.07308117e-02]
 [ 6.91020990e-03]
 [ 8.18894249e-04]
 [ 9.83565248e-03]
 [ 1.30010381e-02]
 [-1.13815978e-02]
 [ 1.20553290e-03]
 [-6.37828521e-02]
 [-1.35746538e-02]
 [-6.34651946e-04]
 [ 3.13995060e-03]
 [ 1.42444980e-02]
 [-7.56085257e-02]
 [ 6.37840301e-03]
 [ 1.01063908e-02]
 [-1.06900797e-02]
 [-7.53462603e-03]
 [ 5.83553690e-03]
 [ 1.37717968e-02]
 [ 1.32986372e-02]
 [-3.43314003e-02]
 [ 8.76181757e-03]
 [-2.85336475e-02]
 [ 1.88250518e-02]
 [-8.30143463e-03]
 [ 1.66861305e-02]
 [ 2.30351584e-02]
 [ 4.47692891e-03]
 [-6.39227546e-03]
 [-5.69792400e-04]
 [ 2.20261852e-06]
 [-1.24876121e-02]
 [-1.52236568e-02]
 [-7.09988184e-03]
 [ 4.71166008e-02]
 [-9.07061030e-03]
 [ 2.55092591e-03]
 [ 5.42321852e-03]
 [ 5.51522974e-03]
 [-3.12864513e-03]
 [ 5.71660683e-03]
 [-5.34075735e-05]
 [ 1.55331438e-03]
 [-7.53535846e-03]
 [ 1.06611281e-03]
 [-1.35458746e-03]
 [-4.13947036e-03]
 [-1.76478658e-02]
 [-1.18637835e-02]
 [-4.57245868e-03]
 [-4.72688132e-03]
 [ 1.72201559e-02]
 [-1.01307540e-02]
 [ 8.03027739e-03]
 [-6.06635110e-03]
 [ 1.12854324e-02]
 [-1.56635011e-03]
 [ 6.82433657e-03]
 [-1.82935860e-02]
 [-5.78694491e-03]
 [ 1.31495258e-03]
 [ 1.99202484e-03]
 [-7.11691122e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.71006458]
curr_Stock_Price:  100.23854327007236
curr_Factors:  [100.23854327]
mat_Sqrt:  [[0.15]]
grads:  [0.00346253]
Stock Position:  0.0034625274220233234
Bond Position:  [5.36298587]


portfolio before change:  [5.7094056]
curr_Stock_Price:  99.9514199432873
curr_Factors:  [99.95141994]
mat_Sqrt:  [[0.15]]
grads:  [0.01372372]
Stock Position:  0.013723722272914443
Bond Position:  [4.33770007]


portfolio before change:  [5.71002871]
curr_Stock_Price:  99.97706861325436
curr_Factors:  [99.97706861]
mat_Sqrt:  [[0.15]]
grads:  [0.00396906]
Stock Position:  0.003969061778866691
Bond Position:  [5.31321355]


portfolio before change:  [5.71045043]
curr_Stock_Price:  99.9996506490225
curr_Factors:  [99.99965065]
mat_Sqrt:  [[0.15]]
grads:  [0.05165267]
Stock Position:  0.05165267178107127
Bond Position:  [0.5452013]


portfolio before change:  [5.71377212]
curr_Stock_Price:  100.06329922380702
curr_Factors:  [100.06329922]
mat_Sqrt:  [[0.15]]
grads:  [0.0317588]
Stock Position:  0.03175879724156565
Bond Position:  [2.53588209]


portfolio before change:  [5.70458655]
curr_Stock_Price:  99.7690792894626
curr_Factors:  [99.76907929]
mat_Sqrt:  [[0.15]]
grads:  [0.15173527]
Stock Position:  0.15173526593833256
Bond Position:  [-9.43390123]


portfolio before change:  [5.75621687]
curr_Stock_Price:  100.11323103814199
curr_Factors:  [100.11323104]
mat_Sqrt:  [[0.15]]
grads:  [0.01106359]
Stock Position:  0.01106358879713125
Bond Position:  [4.64860525]


portfolio before change:  [5.74979212]
curr_Stock_Price:  99.5062579905333
curr_Factors:  [99.50625799]
mat_Sqrt:  [[0.15]]
grads:  [-0.11984669]
Stock Position:  -0.11984669061283838
Bond Position:  [17.67528783]


portfolio before change:  [5.85195649]
curr_Stock_Price:  98.66301706863486
curr_Factors:  [98.66301707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00633443]
Stock Position:  -0.00633442509369474
Bond Position:  [6.47692998]


portfolio before change:  [5.85165118]
curr_Stock_Price:  98.77512431691466
curr_Factors:  [98.77512432]
mat_Sqrt:  [[0.15]]
grads:  [0.14349243]
Stock Position:  0.14349242514307858
Bond Position:  [-8.32183096]


portfolio before change:  [5.96801043]
curr_Stock_Price:  99.58965783013859
curr_Factors:  [99.58965783]
mat_Sqrt:  [[0.15]]
grads:  [0.09186488]
Stock Position:  0.09186487965027883
Bond Position:  [-3.1807815]


portfolio before change:  [5.89320849]
curr_Stock_Price:  98.7775613796458
curr_Factors:  [98.77756138]
mat_Sqrt:  [[0.15]]
grads:  [0.13944635]
Stock Position:  0.13944634996987296
Bond Position:  [-7.88096191]


portfolio before change:  [5.80854989]
curr_Stock_Price:  98.17398857780287
curr_Factors:  [98.17398858]
mat_Sqrt:  [[0.15]]
grads:  [-0.09803168]
Stock Position:  -0.09803167726864166
Bond Position:  [15.43271065]


portfolio before change:  [5.8634978]
curr_Stock_Price:  97.62331621378749
curr_Factors:  [97.62331621]
mat_Sqrt:  [[0.15]]
grads:  [0.02088235]
Stock Position:  0.020882346372771754
Bond Position:  [3.82489389]


portfolio before change:  [5.86654881]
curr_Stock_Price:  97.75797317792488
curr_Factors:  [97.75797318]
mat_Sqrt:  [[0.15]]
grads:  [-0.04675382]
Stock Position:  -0.04675382366069523
Bond Position:  [10.43710785]


portfolio before change:  [5.85453269]
curr_Stock_Price:  98.02893414592317
curr_Factors:  [98.02893415]
mat_Sqrt:  [[0.15]]
grads:  [0.0600975]
Stock Position:  0.060097496902748924
Bond Position:  [-0.03676087]


portfolio before change:  [5.83198343]
curr_Stock_Price:  97.65376111976606
curr_Factors:  [97.65376112]
mat_Sqrt:  [[0.15]]
grads:  [0.07153874]
Stock Position:  0.07153874454515846
Bond Position:  [-1.15404404]


portfolio before change:  [5.79531202]
curr_Stock_Price:  97.14216030438698
curr_Factors:  [97.1421603]
mat_Sqrt:  [[0.15]]
grads:  [0.04606807]
Stock Position:  0.04606806598113178
Bond Position:  [1.32016057]


portfolio before change:  [5.76146753]
curr_Stock_Price:  96.40570631189237
curr_Factors:  [96.40570631]
mat_Sqrt:  [[0.15]]
grads:  [0.00545929]
Stock Position:  0.005459294995290125
Bond Position:  [5.23516034]


portfolio before change:  [5.76378134]
curr_Stock_Price:  96.7696000088486
curr_Factors:  [96.76960001]
mat_Sqrt:  [[0.15]]
grads:  [0.06557102]
Stock Position:  0.06557101650167824
Bond Position:  [-0.5814997]


portfolio before change:  [5.75088849]
curr_Stock_Price:  96.57353012027059
curr_Factors:  [96.57353012]
mat_Sqrt:  [[0.15]]
grads:  [0.08667359]
Stock Position:  0.08667358705466766
Bond Position:  [-2.61948578]


portfolio before change:  [5.68382913]
curr_Stock_Price:  95.80171906099724
curr_Factors:  [95.80171906]
mat_Sqrt:  [[0.15]]
grads:  [-0.07587732]
Stock Position:  -0.07587731875104439
Bond Position:  [12.95300671]


portfolio before change:  [5.64814696]
curr_Stock_Price:  96.28265015735805
curr_Factors:  [96.28265016]
mat_Sqrt:  [[0.15]]
grads:  [0.00803689]
Stock Position:  0.00803688596921464
Bond Position:  [4.87433428]


portfolio before change:  [5.64843083]
curr_Stock_Price:  96.28006410195356
curr_Factors:  [96.2800641]
mat_Sqrt:  [[0.15]]
grads:  [-0.42521901]
Stock Position:  -0.42521901379875987
Bond Position:  [46.58854474]


portfolio before change:  [6.17069733]
curr_Stock_Price:  95.05868262910737
curr_Factors:  [95.05868263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09049769]
Stock Position:  -0.09049769223030409
Bond Position:  [14.77328874]


portfolio before change:  [6.13773283]
curr_Stock_Price:  95.43314374041476
curr_Factors:  [95.43314374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423101]
Stock Position:  -0.004231012970969279
Bond Position:  [6.54151169]


portfolio before change:  [6.13926287]
curr_Stock_Price:  95.16815083829371
curr_Factors:  [95.16815084]
mat_Sqrt:  [[0.15]]
grads:  [0.020933]
Stock Position:  0.020933004006992145
Bond Position:  [4.14710759]


portfolio before change:  [6.13188892]
curr_Stock_Price:  94.80350424517057
curr_Factors:  [94.80350425]
mat_Sqrt:  [[0.15]]
grads:  [0.09496332]
Stock Position:  0.0949633197682862
Bond Position:  [-2.87096656]


portfolio before change:  [6.13486251]
curr_Stock_Price:  94.83670678358156
curr_Factors:  [94.83670678]
mat_Sqrt:  [[0.15]]
grads:  [-0.50405684]
Stock Position:  -0.5040568382373075
Bond Position:  [53.93795308]


portfolio before change:  [5.93373021]
curr_Stock_Price:  95.24242199293292
curr_Factors:  [95.24242199]
mat_Sqrt:  [[0.15]]
grads:  [0.04252269]
Stock Position:  0.04252268673852449
Bond Position:  [1.88376653]


portfolio before change:  [5.96828733]
curr_Stock_Price:  96.05232815766944
curr_Factors:  [96.05232816]
mat_Sqrt:  [[0.15]]
grads:  [0.06737594]
Stock Position:  0.06737593889155591
Bond Position:  [-0.50332846]


portfolio before change:  [5.99734838]
curr_Stock_Price:  96.48412188518219
curr_Factors:  [96.48412189]
mat_Sqrt:  [[0.15]]
grads:  [-0.0712672]
Stock Position:  -0.071267198066019
Bond Position:  [12.87350141]


portfolio before change:  [6.00830272]
curr_Stock_Price:  96.34170410555704
curr_Factors:  [96.34170411]
mat_Sqrt:  [[0.15]]
grads:  [-0.05023084]
Stock Position:  -0.05023084020855991
Bond Position:  [10.84762746]


portfolio before change:  [6.00246608]
curr_Stock_Price:  96.47139813735586
curr_Factors:  [96.47139814]
mat_Sqrt:  [[0.15]]
grads:  [0.03890358]
Stock Position:  0.03890357936283549
Bond Position:  [2.24938338]


portfolio before change:  [6.03180459]
curr_Stock_Price:  97.22191847114989
curr_Factors:  [97.22191847]
mat_Sqrt:  [[0.15]]
grads:  [0.09181198]
Stock Position:  0.09181197865587803
Bond Position:  [-2.89433211]


portfolio before change:  [6.0299037]
curr_Stock_Price:  97.20318461960458
curr_Factors:  [97.20318462]
mat_Sqrt:  [[0.15]]
grads:  [0.08865758]
Stock Position:  0.08865758157361558
Bond Position:  [-2.58789557]


portfolio before change:  [6.06645504]
curr_Stock_Price:  97.6172844431686
curr_Factors:  [97.61728444]
mat_Sqrt:  [[0.15]]
grads:  [-0.228876]
Stock Position:  -0.22887600183701853
Bond Position:  [28.40870881]


portfolio before change:  [6.02345783]
curr_Stock_Price:  97.81290482888849
curr_Factors:  [97.81290483]
mat_Sqrt:  [[0.15]]
grads:  [0.05841212]
Stock Position:  0.058412117135565385
Bond Position:  [0.30999897]


portfolio before change:  [5.98106353]
curr_Stock_Price:  97.08679400122838
curr_Factors:  [97.086794]
mat_Sqrt:  [[0.15]]
grads:  [-0.19022432]
Stock Position:  -0.1902243168582035
Bond Position:  [24.4493326]


portfolio before change:  [5.86427801]
curr_Stock_Price:  97.70876314192094
curr_Factors:  [97.70876314]
mat_Sqrt:  [[0.15]]
grads:  [0.12550035]
Stock Position:  0.1255003454101427
Bond Position:  [-6.39820551]


portfolio before change:  [5.86513437]
curr_Stock_Price:  97.71877317848535
curr_Factors:  [97.71877318]
mat_Sqrt:  [[0.15]]
grads:  [-0.0553429]
Stock Position:  -0.05534289754902367
Bond Position:  [11.27317443]


portfolio before change:  [5.85811048]
curr_Stock_Price:  97.85842053283285
curr_Factors:  [97.85842053]
mat_Sqrt:  [[0.15]]
grads:  [0.11124087]
Stock Position:  0.11124087028637991
Bond Position:  [-5.02774539]


portfolio before change:  [5.95109353]
curr_Stock_Price:  98.69711675842497
curr_Factors:  [98.69711676]
mat_Sqrt:  [[0.15]]
grads:  [0.15356772]
Stock Position:  0.15356772237963429
Bond Position:  [-9.20559789]


portfolio before change:  [5.97059845]
curr_Stock_Price:  98.82787526080071
curr_Factors:  [98.82787526]
mat_Sqrt:  [[0.15]]
grads:  [0.02984619]
Stock Position:  0.02984619274582222
Bond Position:  [3.02096264]


portfolio before change:  [5.96589546]
curr_Stock_Price:  98.6639746888804
curr_Factors:  [98.66397469]
mat_Sqrt:  [[0.15]]
grads:  [-0.04261517]
Stock Position:  -0.04261516970536674
Bond Position:  [10.17047748]


portfolio before change:  [6.00329509]
curr_Stock_Price:  97.80127823547303
curr_Factors:  [97.80127824]
mat_Sqrt:  [[0.15]]
grads:  [-0.00379862]
Stock Position:  -0.0037986159993402364
Bond Position:  [6.37480459]


portfolio before change:  [5.99873295]
curr_Stock_Price:  99.10716932833508
curr_Factors:  [99.10716933]
mat_Sqrt:  [[0.15]]
grads:  [1.46841235e-05]
Stock Position:  1.4684123471076876e-05
Bond Position:  [5.99727765]


portfolio before change:  [5.99911461]
curr_Stock_Price:  99.57195950947634
curr_Factors:  [99.57195951]
mat_Sqrt:  [[0.15]]
grads:  [-0.08325075]
Stock Position:  -0.08325074750114965
Bond Position:  [14.28855467]


portfolio before change:  [5.96489965]
curr_Stock_Price:  99.99367372449431
curr_Factors:  [99.99367372]
mat_Sqrt:  [[0.15]]
grads:  [-0.10149105]
Stock Position:  -0.10149104563381244
Bond Position:  [16.11336216]


portfolio before change:  [5.9418364]
curr_Stock_Price:  100.23084110189356
curr_Factors:  [100.2308411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04733255]
Stock Position:  -0.04733254562918927
Bond Position:  [10.68601726]


portfolio before change:  [5.96297173]
curr_Stock_Price:  99.79842335202166
curr_Factors:  [99.79842335]
mat_Sqrt:  [[0.15]]
grads:  [0.31411067]
Stock Position:  0.3141106717682476
Bond Position:  [-25.38477807]


portfolio before change:  [6.01044405]
curr_Stock_Price:  99.95460689376331
curr_Factors:  [99.95460689]
mat_Sqrt:  [[0.15]]
grads:  [-0.06047074]
Stock Position:  -0.06047073534827814
Bond Position:  [12.05477263]


portfolio before change:  [6.01091539]
curr_Stock_Price:  99.95927214521458
curr_Factors:  [99.95927215]
mat_Sqrt:  [[0.15]]
grads:  [0.01700617]
Stock Position:  0.017006172753886488
Bond Position:  [4.31099074]


portfolio before change:  [6.00869944]
curr_Stock_Price:  99.81312539338929
curr_Factors:  [99.81312539]
mat_Sqrt:  [[0.15]]
grads:  [0.03615479]
Stock Position:  0.03615479012895921
Bond Position:  [2.39997684]


portfolio before change:  [6.02009378]
curr_Stock_Price:  100.12413095003282
curr_Factors:  [100.12413095]
mat_Sqrt:  [[0.15]]
grads:  [0.0367682]
Stock Position:  0.03676819828496451
Bond Position:  [2.33870988]


portfolio before change:  [6.00610876]
curr_Stock_Price:  99.73979906422385
curr_Factors:  [99.73979906]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085763]
Stock Position:  -0.020857634179457657
Bond Position:  [8.08644501]


portfolio before change:  [6.00061735]
curr_Stock_Price:  100.02731174672276
curr_Factors:  [100.02731175]
mat_Sqrt:  [[0.15]]
grads:  [0.03811071]
Stock Position:  0.038110712222325
Bond Position:  [2.18850526]


portfolio before change:  [5.9849182]
curr_Stock_Price:  99.61178714118037
curr_Factors:  [99.61178714]
mat_Sqrt:  [[0.15]]
grads:  [-0.00035605]
Stock Position:  -0.00035605048989983913
Bond Position:  [6.02038502]


portfolio before change:  [5.98532836]
curr_Stock_Price:  99.51664722740631
curr_Factors:  [99.51664723]
mat_Sqrt:  [[0.15]]
grads:  [0.01035543]
Stock Position:  0.010355429207244532
Bond Position:  [4.95479076]


portfolio before change:  [5.99027882]
curr_Stock_Price:  99.96479687527416
curr_Factors:  [99.96479688]
mat_Sqrt:  [[0.15]]
grads:  [-0.05023572]
Stock Position:  -0.05023572306164415
Bond Position:  [11.01208267]


portfolio before change:  [6.02388032]
curr_Stock_Price:  99.30962131532871
curr_Factors:  [99.30962132]
mat_Sqrt:  [[0.15]]
grads:  [0.00710742]
Stock Position:  0.007107418746808535
Bond Position:  [5.31804525]


portfolio before change:  [6.01892171]
curr_Stock_Price:  98.56518884177386
curr_Factors:  [98.56518884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00903058]
Stock Position:  -0.009030583043529833
Bond Position:  [6.90902283]


portfolio before change:  [6.01073473]
curr_Stock_Price:  99.51959167367212
curr_Factors:  [99.51959167]
mat_Sqrt:  [[0.15]]
grads:  [-0.02759647]
Stock Position:  -0.027596469064617817
Bond Position:  [8.75712406]


portfolio before change:  [6.03974294]
curr_Stock_Price:  98.48826852803265
curr_Factors:  [98.48826853]
mat_Sqrt:  [[0.15]]
grads:  [-0.11765244]
Stock Position:  -0.11765243857214193
Bond Position:  [17.6271279]


portfolio before change:  [6.05963067]
curr_Stock_Price:  98.32859481221837
curr_Factors:  [98.32859481]
mat_Sqrt:  [[0.15]]
grads:  [-0.07909189]
Stock Position:  -0.07909189010092829
Bond Position:  [13.83662509]


portfolio before change:  [6.07559153]
curr_Stock_Price:  98.13772763145586
curr_Factors:  [98.13772763]
mat_Sqrt:  [[0.15]]
grads:  [-0.03048306]
Stock Position:  -0.03048305786609205
Bond Position:  [9.06712956]


portfolio before change:  [6.09730004]
curr_Stock_Price:  97.44416893579056
curr_Factors:  [97.44416894]
mat_Sqrt:  [[0.15]]
grads:  [-0.03151254]
Stock Position:  -0.03151254213361801
Bond Position:  [9.16801352]


portfolio before change:  [6.09855216]
curr_Stock_Price:  97.42261865164019
curr_Factors:  [97.42261865]
mat_Sqrt:  [[0.15]]
grads:  [0.11480104]
Stock Position:  0.11480103927792198
Bond Position:  [-5.08566571]


portfolio before change:  [6.15093329]
curr_Stock_Price:  97.88166498999516
curr_Factors:  [97.88166499]
mat_Sqrt:  [[0.15]]
grads:  [-0.06753836]
Stock Position:  -0.06753836012222332
Bond Position:  [12.76170043]


portfolio before change:  [6.18126082]
curr_Stock_Price:  97.44443350336572
curr_Factors:  [97.4444335]
mat_Sqrt:  [[0.15]]
grads:  [0.05353518]
Stock Position:  0.053535182590565306
Bond Position:  [0.96455528]


portfolio before change:  [6.22315735]
curr_Stock_Price:  98.22590548430163
curr_Factors:  [98.22590548]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044234]
Stock Position:  -0.04044234063371857
Bond Position:  [10.19564288]


portfolio before change:  [6.23731701]
curr_Stock_Price:  97.8915428743212
curr_Factors:  [97.89154287]
mat_Sqrt:  [[0.15]]
grads:  [0.07523622]
Stock Position:  0.0752362159529596
Bond Position:  [-1.12767225]


portfolio before change:  [6.22706466]
curr_Stock_Price:  97.75621085524982
curr_Factors:  [97.75621086]
mat_Sqrt:  [[0.15]]
grads:  [-0.01044233]
Stock Position:  -0.010442334097885284
Bond Position:  [7.24786767]


portfolio before change:  [6.22443888]
curr_Stock_Price:  98.05104759228843
curr_Factors:  [98.05104759]
mat_Sqrt:  [[0.15]]
grads:  [0.04549558]
Stock Position:  0.04549557715903313
Bond Position:  [1.76354988]


portfolio before change:  [6.25722935]
curr_Stock_Price:  98.76936459554294
curr_Factors:  [98.7693646]
mat_Sqrt:  [[0.15]]
grads:  [-0.12195724]
Stock Position:  -0.12195724004572385
Bond Position:  [18.30286846]


portfolio before change:  [6.2561612]
curr_Stock_Price:  98.7875030541251
curr_Factors:  [98.78750305]
mat_Sqrt:  [[0.15]]
grads:  [-0.03857963]
Stock Position:  -0.038579632745762066
Bond Position:  [10.06734679]


portfolio before change:  [6.28749367]
curr_Stock_Price:  97.99166245744266
curr_Factors:  [97.99166246]
mat_Sqrt:  [[0.15]]
grads:  [0.00876635]
Stock Position:  0.008766350524509199
Bond Position:  [5.4284644]


portfolio before change:  [6.28981997]
curr_Stock_Price:  98.2183262661373
curr_Factors:  [98.21832627]
mat_Sqrt:  [[0.15]]
grads:  [0.01328017]
Stock Position:  0.013280165591478127
Bond Position:  [4.98546433]


portfolio before change:  [6.27506739]
curr_Stock_Price:  97.0839892839121
curr_Factors:  [97.08398928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.27506739]
Stock Price:  97.00459654486103
PL:  [6.27506739]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.31182890e-04]
 [-4.87710202e-03]
 [-4.11386873e-03]
 [ 2.04815976e-04]
 [ 3.20991057e-02]
 [ 2.74062313e-02]
 [ 4.07714120e-03]
 [ 1.37139823e-02]
 [ 2.45100254e-02]
 [-3.54737704e-03]
 [ 4.81745492e-02]
 [ 6.92376186e-02]
 [ 1.39128850e-01]
 [ 2.27822065e-02]
 [-6.89206722e-03]
 [ 3.33810528e-02]
 [ 1.54846593e-02]
 [ 8.06731772e-03]
 [ 1.30621670e-02]
 [-8.92443042e-03]
 [ 1.52567771e-02]
 [-9.94156127e-03]
 [ 1.03663961e-02]
 [-7.09958576e-02]
 [ 1.21169263e-02]
 [ 5.51053947e-03]
 [-3.68709237e-03]
 [ 2.16148567e-02]
 [ 7.43573838e-02]
 [ 1.17285320e-02]
 [ 2.22638967e-02]
 [ 6.52723749e-03]
 [-2.53717748e-03]
 [ 8.53848775e-03]
 [ 1.02342210e-02]
 [ 7.41896077e-03]
 [-3.27450110e-02]
 [ 9.01189973e-03]
 [ 1.14244694e-02]
 [-1.75597054e-03]
 [-6.82052283e-03]
 [-1.16467145e-02]
 [ 1.96327900e-02]
 [-7.18177440e-03]
 [ 2.45040574e-02]
 [-1.42256940e-03]
 [ 1.54762631e-02]
 [ 2.84806959e-02]
 [ 1.29611252e-02]
 [-7.85733953e-03]
 [ 4.76971881e-02]
 [ 9.04264712e-03]
 [-1.09276244e-02]
 [ 5.68599508e-03]
 [-2.67535502e-02]
 [ 4.09754707e-02]
 [ 1.94058594e-02]
 [ 2.78134339e-03]
 [ 2.09818679e-03]
 [-4.09310030e-03]
 [ 2.62660525e-02]
 [ 5.31956036e-02]
 [-5.12884885e-03]
 [-1.17974396e-02]
 [ 1.83156146e-02]
 [ 8.10867252e-03]
 [-5.07098072e-03]
 [ 1.56041250e-02]
 [-1.66571909e-02]
 [-4.01595109e-02]
 [-5.34174371e-03]
 [ 1.59082401e-02]
 [-3.13012412e-02]
 [ 2.88467851e-02]
 [-3.15068112e-02]
 [ 8.38710955e-03]
 [ 1.29189715e-02]
 [-2.03050111e-02]
 [ 1.96608057e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.99558995]
curr_Stock_Price:  101.10243401126236
curr_Factors:  [101.10243401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00154122]
Stock Position:  -0.0015412192644129418
Bond Position:  [19.15141097]


portfolio before change:  [18.99598268]
curr_Stock_Price:  101.62427699531881
curr_Factors:  [101.624277]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251401]
Stock Position:  -0.032514013495495736
Bond Position:  [22.30019579]


portfolio before change:  [18.99466999]
curr_Stock_Price:  101.70751785394373
curr_Factors:  [101.70751785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02742579]
Stock Position:  -0.02742579153405228
Bond Position:  [21.78407917]


portfolio before change:  [18.99263722]
curr_Stock_Price:  101.83128135454253
curr_Factors:  [101.83128135]
mat_Sqrt:  [[0.15]]
grads:  [0.00136544]
Stock Position:  0.0013654398411617683
Bond Position:  [18.85359273]


portfolio before change:  [18.9941911]
curr_Stock_Price:  102.10627398506601
curr_Factors:  [102.10627399]
mat_Sqrt:  [[0.15]]
grads:  [0.21399404]
Stock Position:  0.21399403830623775
Bond Position:  [-2.85594281]


portfolio before change:  [18.83028844]
curr_Stock_Price:  101.3411865098688
curr_Factors:  [101.34118651]
mat_Sqrt:  [[0.15]]
grads:  [0.18270821]
Stock Position:  0.1827082083673357
Bond Position:  [0.31442181]


portfolio before change:  [19.03198559]
curr_Stock_Price:  102.44500938181874
curr_Factors:  [102.44500938]
mat_Sqrt:  [[0.15]]
grads:  [0.02718094]
Stock Position:  0.027180941340828966
Bond Position:  [16.2474338]


portfolio before change:  [19.03100704]
curr_Stock_Price:  102.3716477358122
curr_Factors:  [102.37164774]
mat_Sqrt:  [[0.15]]
grads:  [0.09142655]
Stock Position:  0.09142654845415459
Bond Position:  [9.67152063]


portfolio before change:  [19.06698776]
curr_Stock_Price:  102.75858376895671
curr_Factors:  [102.75858377]
mat_Sqrt:  [[0.15]]
grads:  [0.16340017]
Stock Position:  0.1634001694588176
Bond Position:  [2.27621776]


portfolio before change:  [19.08758825]
curr_Stock_Price:  102.88378695405598
curr_Factors:  [102.88378695]
mat_Sqrt:  [[0.15]]
grads:  [-0.02364918]
Stock Position:  -0.023649180277239383
Bond Position:  [21.52070547]


portfolio before change:  [19.08554191]
curr_Stock_Price:  103.02719235194863
curr_Factors:  [103.02719235]
mat_Sqrt:  [[0.15]]
grads:  [0.32116366]
Stock Position:  0.32116366153281156
Bond Position:  [-14.00304842]


portfolio before change:  [19.21896327]
curr_Stock_Price:  103.44534853079892
curr_Factors:  [103.44534853]
mat_Sqrt:  [[0.15]]
grads:  [0.46158412]
Stock Position:  0.46158412402604804
Bond Position:  [-28.52976732]


portfolio before change:  [19.43652791]
curr_Stock_Price:  103.92055511419157
curr_Factors:  [103.92055511]
mat_Sqrt:  [[0.15]]
grads:  [0.92752567]
Stock Position:  0.9275256652484003
Bond Position:  [-76.9524541]


portfolio before change:  [19.91602602]
curr_Stock_Price:  104.44270539289377
curr_Factors:  [104.44270539]
mat_Sqrt:  [[0.15]]
grads:  [0.15188138]
Stock Position:  0.1518813763356701
Bond Position:  [4.05312418]


portfolio before change:  [19.89468381]
curr_Stock_Price:  104.30051848725186
curr_Factors:  [104.30051849]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594711]
Stock Position:  -0.04594711477829794
Bond Position:  [24.6869917]


portfolio before change:  [19.90991032]
curr_Stock_Price:  104.00270818365169
curr_Factors:  [104.00270818]
mat_Sqrt:  [[0.15]]
grads:  [0.22254035]
Stock Position:  0.22254035187756327
Bond Position:  [-3.23488896]


portfolio before change:  [19.98694521]
curr_Stock_Price:  104.34977820266083
curr_Factors:  [104.3497782]
mat_Sqrt:  [[0.15]]
grads:  [0.10323106]
Stock Position:  0.10323106209350663
Bond Position:  [9.21480678]


portfolio before change:  [20.02949418]
curr_Stock_Price:  104.7563711783861
curr_Factors:  [104.75637118]
mat_Sqrt:  [[0.15]]
grads:  [0.05378212]
Stock Position:  0.05378211816147625
Bond Position:  [14.39547465]


portfolio before change:  [19.99738717]
curr_Stock_Price:  104.14265875290052
curr_Factors:  [104.14265875]
mat_Sqrt:  [[0.15]]
grads:  [0.08708111]
Stock Position:  0.08708111329749264
Bond Position:  [10.92852851]


portfolio before change:  [19.99484962]
curr_Stock_Price:  104.10567480073925
curr_Factors:  [104.1056748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0594962]
Stock Position:  -0.0594962027967778
Bond Position:  [26.18874196]


portfolio before change:  [19.95812143]
curr_Stock_Price:  104.75050654877185
curr_Factors:  [104.75050655]
mat_Sqrt:  [[0.15]]
grads:  [0.10171185]
Stock Position:  0.10171184716078775
Bond Position:  [9.30375392]


portfolio before change:  [19.79804576]
curr_Stock_Price:  103.17097396107992
curr_Factors:  [103.17097396]
mat_Sqrt:  [[0.15]]
grads:  [-0.06627708]
Stock Position:  -0.0662770751640599
Bond Position:  [26.63591615]


portfolio before change:  [19.69340347]
curr_Stock_Price:  104.77495370809697
curr_Factors:  [104.77495371]
mat_Sqrt:  [[0.15]]
grads:  [0.06910931]
Stock Position:  0.06910930718622929
Bond Position:  [12.452479]


portfolio before change:  [19.69332931]
curr_Stock_Price:  104.76261878897145
curr_Factors:  [104.76261879]
mat_Sqrt:  [[0.15]]
grads:  [-0.47330572]
Stock Position:  -0.47330571707756725
Bond Position:  [69.27807572]


portfolio before change:  [19.51490532]
curr_Stock_Price:  105.14874133273729
curr_Factors:  [105.14874133]
mat_Sqrt:  [[0.15]]
grads:  [0.08077951]
Stock Position:  0.08077950893222996
Bond Position:  [11.02104163]


portfolio before change:  [19.55802497]
curr_Stock_Price:  105.67400832898161
curr_Factors:  [105.67400833]
mat_Sqrt:  [[0.15]]
grads:  [0.03673693]
Stock Position:  0.036736929799108115
Bond Position:  [15.67588634]


portfolio before change:  [19.55047116]
curr_Stock_Price:  105.44171945157198
curr_Factors:  [105.44171945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02458062]
Stock Position:  -0.02458061580403113
Bond Position:  [22.14229356]


portfolio before change:  [19.55356616]
curr_Stock_Price:  105.37210926377284
curr_Factors:  [105.37210926]
mat_Sqrt:  [[0.15]]
grads:  [0.14409904]
Stock Position:  0.14409904472062596
Bond Position:  [4.36954587]


portfolio before change:  [19.68894872]
curr_Stock_Price:  106.30972449848097
curr_Factors:  [106.3097245]
mat_Sqrt:  [[0.15]]
grads:  [0.49571589]
Stock Position:  0.4957158920103291
Bond Position:  [-33.01047119]


portfolio before change:  [19.68825675]
curr_Stock_Price:  106.31249068690563
curr_Factors:  [106.31249069]
mat_Sqrt:  [[0.15]]
grads:  [0.07819021]
Stock Position:  0.07819021305845889
Bond Position:  [11.37566045]


portfolio before change:  [19.63901786]
curr_Stock_Price:  105.67366541891967
curr_Factors:  [105.67366542]
mat_Sqrt:  [[0.15]]
grads:  [0.14842598]
Stock Position:  0.14842597807730187
Bond Position:  [3.95430072]


portfolio before change:  [19.59579078]
curr_Stock_Price:  105.380763641683
curr_Factors:  [105.38076364]
mat_Sqrt:  [[0.15]]
grads:  [0.04351492]
Stock Position:  0.04351491657520616
Bond Position:  [15.01015564]


portfolio before change:  [19.55822383]
curr_Stock_Price:  104.49589205033082
curr_Factors:  [104.49589205]
mat_Sqrt:  [[0.15]]
grads:  [-0.01691452]
Stock Position:  -0.016914516535205024
Bond Position:  [21.32572133]


portfolio before change:  [19.57957275]
curr_Stock_Price:  103.31252855941925
curr_Factors:  [103.31252856]
mat_Sqrt:  [[0.15]]
grads:  [0.05692325]
Stock Position:  0.056923251677931594
Bond Position:  [13.69868769]


portfolio before change:  [19.6148663]
curr_Stock_Price:  103.91750720659846
curr_Factors:  [103.91750721]
mat_Sqrt:  [[0.15]]
grads:  [0.06822814]
Stock Position:  0.0682281401790766
Bond Position:  [12.52476805]


portfolio before change:  [19.5862805]
curr_Stock_Price:  103.48705978544693
curr_Factors:  [103.48705979]
mat_Sqrt:  [[0.15]]
grads:  [0.04945974]
Stock Position:  0.049459738444189986
Bond Position:  [14.46783759]


portfolio before change:  [19.59372631]
curr_Stock_Price:  103.61931984404994
curr_Factors:  [103.61931984]
mat_Sqrt:  [[0.15]]
grads:  [-0.21830007]
Stock Position:  -0.2183000735750491
Bond Position:  [42.21383146]


portfolio before change:  [19.67341705]
curr_Stock_Price:  103.26635482839787
curr_Factors:  [103.26635483]
mat_Sqrt:  [[0.15]]
grads:  [0.06007933]
Stock Position:  0.060079331547877014
Bond Position:  [13.46924348]


portfolio before change:  [19.70346868]
curr_Stock_Price:  103.75254165608284
curr_Factors:  [103.75254166]
mat_Sqrt:  [[0.15]]
grads:  [0.07616313]
Stock Position:  0.07616312921084785
Bond Position:  [11.80135045]


portfolio before change:  [19.79645445]
curr_Stock_Price:  104.96373346479159
curr_Factors:  [104.96373346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01170647]
Stock Position:  -0.01170647026053434
Bond Position:  [21.02520927]


portfolio before change:  [19.78529954]
curr_Stock_Price:  106.02887266639239
curr_Factors:  [106.02887267]
mat_Sqrt:  [[0.15]]
grads:  [-0.04547015]
Stock Position:  -0.04547015218212349
Bond Position:  [24.60644852]


portfolio before change:  [19.76546962]
curr_Stock_Price:  106.49880450573698
curr_Factors:  [106.49880451]
mat_Sqrt:  [[0.15]]
grads:  [-0.07764476]
Stock Position:  -0.07764476365789723
Bond Position:  [28.03454413]


portfolio before change:  [19.73247123]
curr_Stock_Price:  106.94636345364341
curr_Factors:  [106.94636345]
mat_Sqrt:  [[0.15]]
grads:  [0.13088527]
Stock Position:  0.13088526687298155
Bond Position:  [5.73476791]


portfolio before change:  [19.67282412]
curr_Stock_Price:  106.48790436832826
curr_Factors:  [106.48790437]
mat_Sqrt:  [[0.15]]
grads:  [-0.0478785]
Stock Position:  -0.04787849596779558
Bond Position:  [24.77130482]


portfolio before change:  [19.65240722]
curr_Stock_Price:  106.94667300049622
curr_Factors:  [106.946673]
mat_Sqrt:  [[0.15]]
grads:  [0.16336038]
Stock Position:  0.16336038297364308
Bond Position:  [2.18155777]


portfolio before change:  [19.78903848]
curr_Stock_Price:  107.78221770567777
curr_Factors:  [107.78221771]
mat_Sqrt:  [[0.15]]
grads:  [-0.0094838]
Stock Position:  -0.009483796013507786
Bond Position:  [20.81122305]


portfolio before change:  [19.79618505]
curr_Stock_Price:  107.16581553621002
curr_Factors:  [107.16581554]
mat_Sqrt:  [[0.15]]
grads:  [0.10317509]
Stock Position:  0.1031750875252598
Bond Position:  [8.73934266]


portfolio before change:  [19.76721798]
curr_Stock_Price:  106.87976485884397
curr_Factors:  [106.87976486]
mat_Sqrt:  [[0.15]]
grads:  [0.18987131]
Stock Position:  0.1898713058508582
Bond Position:  [-0.52618255]


portfolio before change:  [19.90572479]
curr_Stock_Price:  107.60941541654766
curr_Factors:  [107.60941542]
mat_Sqrt:  [[0.15]]
grads:  [0.0864075]
Stock Position:  0.08640750121001554
Bond Position:  [10.6074641]


portfolio before change:  [19.91421835]
curr_Stock_Price:  107.70003911757267
curr_Factors:  [107.70003912]
mat_Sqrt:  [[0.15]]
grads:  [-0.05238226]
Stock Position:  -0.05238226350257159
Bond Position:  [25.55579018]


portfolio before change:  [19.94536123]
curr_Stock_Price:  107.13600095749854
curr_Factors:  [107.13600096]
mat_Sqrt:  [[0.15]]
grads:  [0.31798125]
Stock Position:  0.317981253669291
Bond Position:  [-14.12187867]


portfolio before change:  [19.85850271]
curr_Stock_Price:  106.86562061858649
curr_Factors:  [106.86562062]
mat_Sqrt:  [[0.15]]
grads:  [0.06028431]
Stock Position:  0.06028431413964618
Bond Position:  [13.41618206]


portfolio before change:  [19.8775673]
curr_Stock_Price:  107.16795559461964
curr_Factors:  [107.16795559]
mat_Sqrt:  [[0.15]]
grads:  [-0.07285083]
Stock Position:  -0.07285082945183471
Bond Position:  [27.68484176]


portfolio before change:  [19.80453309]
curr_Stock_Price:  108.19422490006708
curr_Factors:  [108.1942249]
mat_Sqrt:  [[0.15]]
grads:  [0.03790663]
Stock Position:  0.0379066338776786
Bond Position:  [15.70325422]


portfolio before change:  [19.80746553]
curr_Stock_Price:  108.2456922890761
curr_Factors:  [108.24569229]
mat_Sqrt:  [[0.15]]
grads:  [-0.178357]
Stock Position:  -0.1783570015329086
Bond Position:  [39.11384263]


portfolio before change:  [19.79692682]
curr_Stock_Price:  108.31848671290233
curr_Factors:  [108.31848671]
mat_Sqrt:  [[0.15]]
grads:  [0.2731698]
Stock Position:  0.2731698044545458
Bond Position:  [-9.79241301]


portfolio before change:  [19.77385831]
curr_Stock_Price:  108.2362797253704
curr_Factors:  [108.23627973]
mat_Sqrt:  [[0.15]]
grads:  [0.1293724]
Stock Position:  0.12937239621855623
Bond Position:  [5.77107145]


portfolio before change:  [19.82336343]
curr_Stock_Price:  108.61614756370177
curr_Factors:  [108.61614756]
mat_Sqrt:  [[0.15]]
grads:  [0.01854229]
Stock Position:  0.01854228923735517
Bond Position:  [17.8093714]


portfolio before change:  [19.81514051]
curr_Stock_Price:  108.11264802903649
curr_Factors:  [108.11264803]
mat_Sqrt:  [[0.15]]
grads:  [0.01398791]
Stock Position:  0.013987911913575225
Bond Position:  [18.30287032]


portfolio before change:  [19.81681514]
curr_Stock_Price:  108.15058539279758
curr_Factors:  [108.15058539]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728734]
Stock Position:  -0.02728733533852728
Bond Position:  [22.76795643]


portfolio before change:  [19.7936326]
curr_Stock_Price:  109.05230721209278
curr_Factors:  [109.05230721]
mat_Sqrt:  [[0.15]]
grads:  [0.17510702]
Stock Position:  0.17510701691055836
Bond Position:  [0.6978084]


portfolio before change:  [19.66511398]
curr_Stock_Price:  108.31811487228401
curr_Factors:  [108.31811487]
mat_Sqrt:  [[0.15]]
grads:  [0.35463736]
Stock Position:  0.3546373570965238
Bond Position:  [-18.748536]


portfolio before change:  [19.4029297]
curr_Stock_Price:  107.58211665087676
curr_Factors:  [107.58211665]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419233]
Stock Position:  -0.03419232569191466
Bond Position:  [23.08141247]


portfolio before change:  [19.39930072]
curr_Stock_Price:  107.73044274392815
curr_Factors:  [107.73044274]
mat_Sqrt:  [[0.15]]
grads:  [-0.0786496]
Stock Position:  -0.07864959712294664
Bond Position:  [27.87225664]


portfolio before change:  [19.41563133]
curr_Stock_Price:  107.54495492029473
curr_Factors:  [107.54495492]
mat_Sqrt:  [[0.15]]
grads:  [0.1221041]
Stock Position:  0.122104097388118
Bond Position:  [6.28395168]


portfolio before change:  [19.29681448]
curr_Stock_Price:  106.56865999642706
curr_Factors:  [106.56866]
mat_Sqrt:  [[0.15]]
grads:  [0.05405782]
Stock Position:  0.054057816786252405
Bond Position:  [13.53594538]


portfolio before change:  [19.29202285]
curr_Stock_Price:  106.46437063149516
curr_Factors:  [106.46437063]
mat_Sqrt:  [[0.15]]
grads:  [-0.03380654]
Stock Position:  -0.033806538116267784
Bond Position:  [22.89121465]


portfolio before change:  [19.28654839]
curr_Stock_Price:  106.66862703080983
curr_Factors:  [106.66862703]
mat_Sqrt:  [[0.15]]
grads:  [0.1040275]
Stock Position:  0.1040274996855927
Bond Position:  [8.19007783]


portfolio before change:  [19.30465397]
curr_Stock_Price:  106.83775235394117
curr_Factors:  [106.83775235]
mat_Sqrt:  [[0.15]]
grads:  [-0.11104794]
Stock Position:  -0.1110479396049829
Bond Position:  [31.16876624]


portfolio before change:  [19.21409063]
curr_Stock_Price:  107.67082901607503
curr_Factors:  [107.67082902]
mat_Sqrt:  [[0.15]]
grads:  [-0.26773007]
Stock Position:  -0.2677300724025958
Bond Position:  [48.04080948]


portfolio before change:  [19.24809735]
curr_Stock_Price:  107.55502555412254
curr_Factors:  [107.55502555]
mat_Sqrt:  [[0.15]]
grads:  [-0.03561162]
Stock Position:  -0.03561162470661337
Bond Position:  [23.07830655]


portfolio before change:  [19.25401999]
curr_Stock_Price:  107.42921818094004
curr_Factors:  [107.42921818]
mat_Sqrt:  [[0.15]]
grads:  [0.10605493]
Stock Position:  0.10605493417661613
Bond Position:  [7.86062133]


portfolio before change:  [19.29816293]
curr_Stock_Price:  107.84081275772577
curr_Factors:  [107.84081276]
mat_Sqrt:  [[0.15]]
grads:  [-0.20867494]
Stock Position:  -0.20867494117367705
Bond Position:  [41.80183819]


portfolio before change:  [19.18295637]
curr_Stock_Price:  108.40541941697145
curr_Factors:  [108.40541942]
mat_Sqrt:  [[0.15]]
grads:  [0.1923119]
Stock Position:  0.1923119009544271
Bond Position:  [-1.66469592]


portfolio before change:  [19.27399731]
curr_Stock_Price:  108.8793629878318
curr_Factors:  [108.87936299]
mat_Sqrt:  [[0.15]]
grads:  [-0.21004541]
Stock Position:  -0.2100454080704442
Bond Position:  [42.14360754]


portfolio before change:  [19.19532019]
curr_Stock_Price:  109.26647536683576
curr_Factors:  [109.26647537]
mat_Sqrt:  [[0.15]]
grads:  [0.05591406]
Stock Position:  0.05591406365037001
Bond Position:  [13.08578753]


portfolio before change:  [19.2110306]
curr_Stock_Price:  109.53282200090511
curr_Factors:  [109.532822]
mat_Sqrt:  [[0.15]]
grads:  [0.08612648]
Stock Position:  0.08612647637277204
Bond Position:  [9.77735459]


portfolio before change:  [19.20871402]
curr_Stock_Price:  109.49882913218329
curr_Factors:  [109.49882913]
mat_Sqrt:  [[0.15]]
grads:  [-0.13536674]
Stock Position:  -0.13536674089496978
Bond Position:  [34.03121365]


portfolio before change:  [19.178261]
curr_Stock_Price:  109.73950886239794
curr_Factors:  [109.73950886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.178261]
Stock Price:  110.22910757019442
PL:  [8.94915343]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.35599164e-03]
 [-2.86653139e-03]
 [-1.17973509e-03]
 [ 4.15286674e-03]
 [ 2.27275017e-02]
 [ 2.70954225e-02]
 [ 2.53130604e-03]
 [-6.21874146e-03]
 [ 2.41507651e-02]
 [-4.55307985e-03]
 [ 1.72578094e-02]
 [-3.41457535e-02]
 [ 3.02061282e-02]
 [ 4.41264257e-03]
 [-6.89907200e-03]
 [ 2.51158814e-02]
 [ 1.07722432e-02]
 [-1.14744729e-02]
 [ 4.47543634e-03]
 [-5.63220014e-03]
 [ 1.34582906e-02]
 [-5.53102744e-03]
 [ 1.03011288e-02]
 [-1.15620030e-02]
 [ 3.93506070e-03]
 [ 1.24095145e-02]
 [-6.22792452e-03]
 [ 7.01762986e-03]
 [ 8.19231431e-03]
 [-1.52499152e-03]
 [ 1.47075794e-02]
 [-1.22006584e-02]
 [ 5.15760242e-03]
 [ 8.46753923e-03]
 [ 1.04672004e-02]
 [ 8.23130803e-03]
 [-3.30519572e-02]
 [ 8.99884672e-03]
 [ 1.23091014e-02]
 [ 5.99703305e-03]
 [-3.76569946e-03]
 [-1.50071263e-02]
 [ 1.99805228e-02]
 [-6.22488711e-03]
 [ 1.02420563e-02]
 [-1.64371856e-02]
 [ 1.52060739e-02]
 [ 1.25135388e-02]
 [ 1.12780737e-03]
 [-7.39534015e-03]
 [-3.79478042e-02]
 [ 1.96945243e-03]
 [-8.14122791e-03]
 [ 5.58115440e-03]
 [-6.05602153e-03]
 [ 1.48186689e-02]
 [ 1.08597572e-02]
 [ 4.17327243e-04]
 [ 1.79021947e-03]
 [ 1.21700921e-02]
 [ 1.00081593e-02]
 [ 3.87541043e-02]
 [-2.31011523e-03]
 [-1.23169935e-02]
 [ 1.52621083e-02]
 [ 7.09259872e-03]
 [-5.10794329e-03]
 [ 1.55789646e-02]
 [-1.64528829e-02]
 [-3.21372603e-02]
 [-1.05829781e-02]
 [ 1.54880256e-02]
 [-2.81864293e-02]
 [ 2.82238258e-02]
 [-2.96032352e-02]
 [ 5.83621524e-03]
 [ 7.43255524e-03]
 [-1.62406410e-02]
 [ 2.03945614e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.04264897]
curr_Stock_Price:  99.4743235549083
curr_Factors:  [99.47432355]
mat_Sqrt:  [[0.15]]
grads:  [0.02903994]
Stock Position:  0.029039944276278984
Bond Position:  [-8.93137778]


portfolio before change:  [-6.04283552]
curr_Stock_Price:  99.48712250605695
curr_Factors:  [99.48712251]
mat_Sqrt:  [[0.15]]
grads:  [-0.01911021]
Stock Position:  -0.019110209249597127
Bond Position:  [-4.14161579]


portfolio before change:  [-6.04010325]
curr_Stock_Price:  99.33060296469212
curr_Factors:  [99.33060296]
mat_Sqrt:  [[0.15]]
grads:  [-0.0078649]
Stock Position:  -0.007864900568389488
Bond Position:  [-5.25887794]


portfolio before change:  [-6.05388281]
curr_Stock_Price:  101.04084286088269
curr_Factors:  [101.04084286]
mat_Sqrt:  [[0.15]]
grads:  [0.02768578]
Stock Position:  0.027685778263896125
Bond Position:  [-8.85127718]


portfolio before change:  [-6.03882131]
curr_Stock_Price:  101.6048408175775
curr_Factors:  [101.60484082]
mat_Sqrt:  [[0.15]]
grads:  [0.15151668]
Stock Position:  0.15151667784887266
Bond Position:  [-21.43364924]


portfolio before change:  [-6.00914871]
curr_Stock_Price:  101.80951959532857
curr_Factors:  [101.8095196]
mat_Sqrt:  [[0.15]]
grads:  [0.18063615]
Stock Position:  0.18063615030300278
Bond Position:  [-24.39962839]


portfolio before change:  [-6.043481]
curr_Stock_Price:  101.62789884167512
curr_Factors:  [101.62789884]
mat_Sqrt:  [[0.15]]
grads:  [0.01687537]
Stock Position:  0.016875373610867068
Bond Position:  [-7.75848977]


portfolio before change:  [-6.05349439]
curr_Stock_Price:  101.06326153103576
curr_Factors:  [101.06326153]
mat_Sqrt:  [[0.15]]
grads:  [-0.04145828]
Stock Position:  -0.0414582763676395
Bond Position:  [-1.86358576]


portfolio before change:  [-6.07261166]
curr_Stock_Price:  101.52157261486444
curr_Factors:  [101.52157261]
mat_Sqrt:  [[0.15]]
grads:  [0.1610051]
Stock Position:  0.16100510086324638
Bond Position:  [-22.41810269]


portfolio before change:  [-6.06776783]
curr_Stock_Price:  101.5603602235215
curr_Factors:  [101.56036022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035387]
Stock Position:  -0.030353865660601848
Bond Position:  [-2.9850183]


portfolio before change:  [-6.0501125]
curr_Stock_Price:  100.97256359061502
curr_Factors:  [100.97256359]
mat_Sqrt:  [[0.15]]
grads:  [0.11505206]
Stock Position:  0.11505206289392297
Bond Position:  [-17.66721423]


portfolio before change:  [-6.0476467]
curr_Stock_Price:  101.00359333857392
curr_Factors:  [101.00359334]
mat_Sqrt:  [[0.15]]
grads:  [-0.22763836]
Stock Position:  -0.22763835639235638
Bond Position:  [16.94464528]


portfolio before change:  [-6.07652968]
curr_Stock_Price:  101.13512677923944
curr_Factors:  [101.13512678]
mat_Sqrt:  [[0.15]]
grads:  [0.20137419]
Stock Position:  0.20137418823291042
Bond Position:  [-26.44253374]


portfolio before change:  [-6.00524013]
curr_Stock_Price:  101.49734926717278
curr_Factors:  [101.49734927]
mat_Sqrt:  [[0.15]]
grads:  [0.02941762]
Stock Position:  0.029417617154013694
Bond Position:  [-8.99105029]


portfolio before change:  [-5.99357746]
curr_Stock_Price:  101.91290402861273
curr_Factors:  [101.91290403]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599381]
Stock Position:  -0.04599381334020535
Bond Position:  [-1.30621437]


portfolio before change:  [-5.99991957]
curr_Stock_Price:  102.04901945226979
curr_Factors:  [102.04901945]
mat_Sqrt:  [[0.15]]
grads:  [0.16743921]
Stock Position:  0.16743920965162448
Bond Position:  [-23.08692673]


portfolio before change:  [-6.06302698]
curr_Stock_Price:  101.68073990154707
curr_Factors:  [101.6807399]
mat_Sqrt:  [[0.15]]
grads:  [0.07181495]
Stock Position:  0.07181495444086063
Bond Position:  [-13.36522468]


portfolio before change:  [-6.09661073]
curr_Stock_Price:  101.22472907823794
curr_Factors:  [101.22472908]
mat_Sqrt:  [[0.15]]
grads:  [-0.07649649]
Stock Position:  -0.07649648590245806
Bond Position:  [1.64672533]


portfolio before change:  [-6.18280029]
curr_Stock_Price:  102.35278717726428
curr_Factors:  [102.35278718]
mat_Sqrt:  [[0.15]]
grads:  [0.02983624]
Stock Position:  0.029836242278409766
Bond Position:  [-9.23662284]


portfolio before change:  [-6.19493243]
curr_Stock_Price:  101.96551209117975
curr_Factors:  [101.96551209]
mat_Sqrt:  [[0.15]]
grads:  [-0.037548]
Stock Position:  -0.03754800095696983
Bond Position:  [-2.36633128]


portfolio before change:  [-6.18161778]
curr_Stock_Price:  101.60696978162164
curr_Factors:  [101.60696978]
mat_Sqrt:  [[0.15]]
grads:  [0.08972194]
Stock Position:  0.08972193763544598
Bond Position:  [-15.29799199]


portfolio before change:  [-6.24593004]
curr_Stock_Price:  100.90083142164558
curr_Factors:  [100.90083142]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687352]
Stock Position:  -0.03687351627178471
Bond Position:  [-2.52536159]


portfolio before change:  [-6.27758157]
curr_Stock_Price:  101.75493193228412
curr_Factors:  [101.75493193]
mat_Sqrt:  [[0.15]]
grads:  [0.06867419]
Stock Position:  0.06867419172293403
Bond Position:  [-13.26551927]


portfolio before change:  [-6.23088204]
curr_Stock_Price:  102.44702090390486
curr_Factors:  [102.4470209]
mat_Sqrt:  [[0.15]]
grads:  [-0.07708002]
Stock Position:  -0.07708002007352564
Bond Position:  [1.66573639]


portfolio before change:  [-6.23161634]
curr_Stock_Price:  102.45789810750539
curr_Factors:  [102.45789811]
mat_Sqrt:  [[0.15]]
grads:  [0.02623374]
Stock Position:  0.026233738009499633
Bond Position:  [-8.91947]


portfolio before change:  [-6.26310977]
curr_Stock_Price:  101.27865514579095
curr_Factors:  [101.27865515]
mat_Sqrt:  [[0.15]]
grads:  [0.0827301]
Stock Position:  0.08273009658026717
Bond Position:  [-14.6419027]


portfolio before change:  [-6.30258855]
curr_Stock_Price:  100.8125173670498
curr_Factors:  [100.81251737]
mat_Sqrt:  [[0.15]]
grads:  [-0.0415195]
Stock Position:  -0.04151949680600887
Bond Position:  [-2.11690355]


portfolio before change:  [-6.30583839]
curr_Stock_Price:  100.88760344414901
curr_Factors:  [100.88760344]
mat_Sqrt:  [[0.15]]
grads:  [0.0467842]
Stock Position:  0.04678419908097544
Bond Position:  [-11.02578412]


portfolio before change:  [-6.31574922]
curr_Stock_Price:  100.69049208675489
curr_Factors:  [100.69049209]
mat_Sqrt:  [[0.15]]
grads:  [0.05461543]
Stock Position:  0.05461542875148655
Bond Position:  [-11.81500362]


portfolio before change:  [-6.26248362]
curr_Stock_Price:  101.67929803795622
curr_Factors:  [101.67929804]
mat_Sqrt:  [[0.15]]
grads:  [-0.01016661]
Stock Position:  -0.010166610151430111
Bond Position:  [-5.22874984]


portfolio before change:  [-6.27102249]
curr_Stock_Price:  102.48704618050256
curr_Factors:  [102.48704618]
mat_Sqrt:  [[0.15]]
grads:  [0.09805053]
Stock Position:  0.09805052962129927
Bond Position:  [-16.31993165]


portfolio before change:  [-6.31021332]
curr_Stock_Price:  102.09774890631299
curr_Factors:  [102.09774891]
mat_Sqrt:  [[0.15]]
grads:  [-0.08133772]
Stock Position:  -0.08133772257961203
Bond Position:  [1.99418506]


portfolio before change:  [-6.3329261]
curr_Stock_Price:  102.37852166314623
curr_Factors:  [102.37852166]
mat_Sqrt:  [[0.15]]
grads:  [0.03438402]
Stock Position:  0.034384016131761064
Bond Position:  [-9.85311084]


portfolio before change:  [-6.32164854]
curr_Stock_Price:  102.72442062061228
curr_Factors:  [102.72442062]
mat_Sqrt:  [[0.15]]
grads:  [0.05645026]
Stock Position:  0.056450261564876446
Bond Position:  [-12.12046895]


portfolio before change:  [-6.29097502]
curr_Stock_Price:  103.28121296523982
curr_Factors:  [103.28121297]
mat_Sqrt:  [[0.15]]
grads:  [0.06978134]
Stock Position:  0.06978133620591759
Bond Position:  [-13.49807607]


portfolio before change:  [-6.32648484]
curr_Stock_Price:  102.78443019454586
curr_Factors:  [102.78443019]
mat_Sqrt:  [[0.15]]
grads:  [0.05487539]
Stock Position:  0.05487538684636006
Bond Position:  [-11.96682021]


portfolio before change:  [-6.31441659]
curr_Stock_Price:  103.01798116757874
curr_Factors:  [103.01798117]
mat_Sqrt:  [[0.15]]
grads:  [-0.22034638]
Stock Position:  -0.22034638149910535
Bond Position:  [16.38522279]


portfolio before change:  [-6.37596621]
curr_Stock_Price:  103.30196010488899
curr_Factors:  [103.3019601]
mat_Sqrt:  [[0.15]]
grads:  [0.05999231]
Stock Position:  0.0599923114949313
Bond Position:  [-12.57328958]


portfolio before change:  [-6.3351726]
curr_Stock_Price:  103.99504012055131
curr_Factors:  [103.99504012]
mat_Sqrt:  [[0.15]]
grads:  [0.08206068]
Stock Position:  0.08206067574214808
Bond Position:  [-14.86907586]


portfolio before change:  [-6.32915846]
curr_Stock_Price:  104.0796541392054
curr_Factors:  [104.07965414]
mat_Sqrt:  [[0.15]]
grads:  [0.03998022]
Stock Position:  0.03998022030105089
Bond Position:  [-10.49028596]


portfolio before change:  [-6.33281512]
curr_Stock_Price:  104.00459203938325
curr_Factors:  [104.00459204]
mat_Sqrt:  [[0.15]]
grads:  [-0.02510466]
Stock Position:  -0.02510466309089741
Bond Position:  [-3.72181488]


portfolio before change:  [-6.35474143]
curr_Stock_Price:  104.86872177043988
curr_Factors:  [104.86872177]
mat_Sqrt:  [[0.15]]
grads:  [-0.10004751]
Stock Position:  -0.10004750874495615
Bond Position:  [4.13711293]


portfolio before change:  [-6.45213829]
curr_Stock_Price:  105.84481242907569
curr_Factors:  [105.84481243]
mat_Sqrt:  [[0.15]]
grads:  [0.13320349]
Stock Position:  0.13320348528046413
Bond Position:  [-20.5510362]


portfolio before change:  [-6.43908565]
curr_Stock_Price:  105.9524456719883
curr_Factors:  [105.95244567]
mat_Sqrt:  [[0.15]]
grads:  [-0.04149925]
Stock Position:  -0.04149924740639771
Bond Position:  [-2.04213889]


portfolio before change:  [-6.37948584]
curr_Stock_Price:  104.51320401292764
curr_Factors:  [104.51320401]
mat_Sqrt:  [[0.15]]
grads:  [0.06828038]
Stock Position:  0.06828037543137361
Bond Position:  [-13.51568665]


portfolio before change:  [-6.43149156]
curr_Stock_Price:  103.763926347688
curr_Factors:  [103.76392635]
mat_Sqrt:  [[0.15]]
grads:  [-0.10958124]
Stock Position:  -0.1095812375186396
Bond Position:  [4.9390879]


portfolio before change:  [-6.51225112]
curr_Stock_Price:  104.503726970913
curr_Factors:  [104.50372697]
mat_Sqrt:  [[0.15]]
grads:  [0.10137383]
Stock Position:  0.1013738261630055
Bond Position:  [-17.10619377]


portfolio before change:  [-6.53120299]
curr_Stock_Price:  104.32732345302435
curr_Factors:  [104.32732345]
mat_Sqrt:  [[0.15]]
grads:  [0.08342359]
Stock Position:  0.08342359188504996
Bond Position:  [-15.23456305]


portfolio before change:  [-6.66342065]
curr_Stock_Price:  102.75384201540103
curr_Factors:  [102.75384202]
mat_Sqrt:  [[0.15]]
grads:  [0.00751872]
Stock Position:  0.007518715778054401
Bond Position:  [-7.43599759]


portfolio before change:  [-6.6622245]
curr_Stock_Price:  102.97474612935177
curr_Factors:  [102.97474613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04930227]
Stock Position:  -0.04930226766965607
Bond Position:  [-1.58533601]


portfolio before change:  [-6.65017132]
curr_Stock_Price:  102.7282610578807
curr_Factors:  [102.72826106]
mat_Sqrt:  [[0.15]]
grads:  [-0.25298536]
Stock Position:  -0.2529853610665624
Bond Position:  [19.3385749]


portfolio before change:  [-6.53419241]
curr_Stock_Price:  102.27459760765399
curr_Factors:  [102.27459761]
mat_Sqrt:  [[0.15]]
grads:  [0.01312968]
Stock Position:  0.013129682850495211
Bond Position:  [-7.87702544]


portfolio before change:  [-6.52899311]
curr_Stock_Price:  102.70809039535744
curr_Factors:  [102.7080904]
mat_Sqrt:  [[0.15]]
grads:  [-0.05427485]
Stock Position:  -0.054274852712735924
Bond Position:  [-0.95452663]


portfolio before change:  [-6.52056725]
curr_Stock_Price:  102.55174689117834
curr_Factors:  [102.55174689]
mat_Sqrt:  [[0.15]]
grads:  [0.0372077]
Stock Position:  0.03720769602184075
Bond Position:  [-10.33628148]


portfolio before change:  [-6.50316427]
curr_Stock_Price:  103.0368352900616
curr_Factors:  [103.03683529]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037348]
Stock Position:  -0.04037347686731909
Bond Position:  [-2.34320898]


portfolio before change:  [-6.55747818]
curr_Stock_Price:  104.37849473848351
curr_Factors:  [104.37849474]
mat_Sqrt:  [[0.15]]
grads:  [0.09879113]
Stock Position:  0.09879112583850906
Bond Position:  [-16.86914719]


portfolio before change:  [-6.54884259]
curr_Stock_Price:  104.47657986766589
curr_Factors:  [104.47657987]
mat_Sqrt:  [[0.15]]
grads:  [0.07239838]
Stock Position:  0.0723983810416542
Bond Position:  [-14.11277783]


portfolio before change:  [-6.57857689]
curr_Stock_Price:  104.07805969692161
curr_Factors:  [104.0780597]
mat_Sqrt:  [[0.15]]
grads:  [0.00278218]
Stock Position:  0.002782181617365438
Bond Position:  [-6.86814095]


portfolio before change:  [-6.57859147]
curr_Stock_Price:  104.22711147497138
curr_Factors:  [104.22711147]
mat_Sqrt:  [[0.15]]
grads:  [0.0119348]
Stock Position:  0.01193479649690365
Bond Position:  [-7.82252083]


portfolio before change:  [-6.57821698]
curr_Stock_Price:  104.29945550745477
curr_Factors:  [104.29945551]
mat_Sqrt:  [[0.15]]
grads:  [0.08113395]
Stock Position:  0.08113394715293729
Bond Position:  [-15.04044349]


portfolio before change:  [-6.55127984]
curr_Stock_Price:  104.64305022278778
curr_Factors:  [104.64305022]
mat_Sqrt:  [[0.15]]
grads:  [0.06672106]
Stock Position:  0.06672106233171239
Bond Position:  [-13.53317532]


portfolio before change:  [-6.46502333]
curr_Stock_Price:  105.94852049711692
curr_Factors:  [105.9485205]
mat_Sqrt:  [[0.15]]
grads:  [0.2583607]
Stock Position:  0.2583606951668343
Bond Position:  [-33.83795674]


portfolio before change:  [-6.33881485]
curr_Stock_Price:  106.44520369512865
curr_Factors:  [106.4452037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01540077]
Stock Position:  -0.01540076819100127
Bond Position:  [-4.69947694]


portfolio before change:  [-6.3271748]
curr_Stock_Price:  105.67032196215193
curr_Factors:  [105.67032196]
mat_Sqrt:  [[0.15]]
grads:  [-0.08211329]
Stock Position:  -0.0821132896905532
Bond Position:  [2.34976296]


portfolio before change:  [-6.33030229]
curr_Stock_Price:  105.71019793353312
curr_Factors:  [105.71019793]
mat_Sqrt:  [[0.15]]
grads:  [0.10174739]
Stock Position:  0.10174738859303636
Bond Position:  [-17.08603887]


portfolio before change:  [-6.34210007]
curr_Stock_Price:  105.60474188629698
curr_Factors:  [105.60474189]
mat_Sqrt:  [[0.15]]
grads:  [0.04728399]
Stock Position:  0.04728399145431515
Bond Position:  [-11.33551379]


portfolio before change:  [-6.31774996]
curr_Stock_Price:  106.13470159441879
curr_Factors:  [106.13470159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03405296]
Stock Position:  -0.03405295525648096
Bond Position:  [-2.70354971]


portfolio before change:  [-6.32912869]
curr_Stock_Price:  106.46388776567836
curr_Factors:  [106.46388777]
mat_Sqrt:  [[0.15]]
grads:  [0.10385976]
Stock Position:  0.10385976406803378
Bond Position:  [-17.38644296]


portfolio before change:  [-6.29669563]
curr_Stock_Price:  106.78662824252447
curr_Factors:  [106.78662824]
mat_Sqrt:  [[0.15]]
grads:  [-0.10968589]
Stock Position:  -0.10968588621272993
Bond Position:  [5.41629032]


portfolio before change:  [-6.31162262]
curr_Stock_Price:  106.92580311273544
curr_Factors:  [106.92580311]
mat_Sqrt:  [[0.15]]
grads:  [-0.2142484]
Stock Position:  -0.21424840207457369
Bond Position:  [16.59705984]


portfolio before change:  [-6.0757108]
curr_Stock_Price:  105.82953135771288
curr_Factors:  [105.82953136]
mat_Sqrt:  [[0.15]]
grads:  [-0.07055319]
Stock Position:  -0.07055318715503256
Bond Position:  [1.39089993]


portfolio before change:  [-6.14975913]
curr_Stock_Price:  106.88030262751431
curr_Factors:  [106.88030263]
mat_Sqrt:  [[0.15]]
grads:  [0.1032535]
Stock Position:  0.1032535041343471
Bond Position:  [-17.1855249]


portfolio before change:  [-6.09256879]
curr_Stock_Price:  107.44458829493888
curr_Factors:  [107.44458829]
mat_Sqrt:  [[0.15]]
grads:  [-0.18790953]
Stock Position:  -0.18790952837746974
Bond Position:  [14.09729313]


portfolio before change:  [-6.01376598]
curr_Stock_Price:  107.0299116251546
curr_Factors:  [107.02991163]
mat_Sqrt:  [[0.15]]
grads:  [0.18815884]
Stock Position:  0.18815883838307476
Bond Position:  [-26.15238982]


portfolio before change:  [-5.91289117]
curr_Stock_Price:  107.57471401784399
curr_Factors:  [107.57471402]
mat_Sqrt:  [[0.15]]
grads:  [-0.1973549]
Stock Position:  -0.19735490117046323
Bond Position:  [15.31750588]


portfolio before change:  [-5.91410871]
curr_Stock_Price:  107.58573436287057
curr_Factors:  [107.58573436]
mat_Sqrt:  [[0.15]]
grads:  [0.0389081]
Stock Position:  0.03890810162966525
Bond Position:  [-10.1000654]


portfolio before change:  [-5.92292367]
curr_Stock_Price:  107.37540071823713
curr_Factors:  [107.37540072]
mat_Sqrt:  [[0.15]]
grads:  [0.04955037]
Stock Position:  0.0495503682609854
Bond Position:  [-11.24341432]


portfolio before change:  [-5.92157122]
curr_Stock_Price:  107.41687748696958
curr_Factors:  [107.41687749]
mat_Sqrt:  [[0.15]]
grads:  [-0.10827094]
Stock Position:  -0.10827094032013901
Bond Position:  [5.70855511]


portfolio before change:  [-5.99673804]
curr_Stock_Price:  108.1144202704967
curr_Factors:  [108.11442027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.99673804]
Stock Price:  108.75064380064708
PL:  [-14.74738184]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.06495500e-04]
 [ 2.68938761e-03]
 [-3.32062150e-03]
 [ 7.80063595e-03]
 [ 2.96607812e-03]
 [ 2.21447821e-02]
 [ 5.86951745e-04]
 [-2.23541596e-02]
 [-4.29339119e-02]
 [ 4.00656251e-02]
 [-9.06813612e-02]
 [ 3.17328577e-02]
 [-8.74342209e-03]
 [-6.67723156e-04]
 [-7.06858499e-03]
 [ 1.08279065e-02]
 [ 1.31314443e-02]
 [ 1.50558652e-02]
 [ 2.24013485e-03]
 [ 1.14319013e-02]
 [ 1.23620275e-02]
 [-9.68692653e-03]
 [ 5.72680161e-03]
 [ 7.22105425e-03]
 [-8.23130230e-03]
 [-8.67880451e-03]
 [-4.55253687e-03]
 [ 5.78570419e-03]
 [-8.41285251e-03]
 [-3.36173274e-03]
 [ 9.00604372e-03]
 [-1.20877459e-02]
 [ 6.30502436e-03]
 [ 8.42673147e-03]
 [ 1.09040619e-02]
 [ 8.52567375e-03]
 [-3.30070455e-02]
 [ 9.33677676e-03]
 [ 9.25755876e-03]
 [ 1.92196632e-02]
 [-5.80429288e-03]
 [-1.91306441e-02]
 [ 2.26312046e-02]
 [ 3.20468501e-03]
 [-7.57962007e-03]
 [-4.94348848e-03]
 [ 2.91358153e-03]
 [-1.22444788e-02]
 [-1.30425873e-02]
 [-6.47474470e-03]
 [ 3.43304700e-02]
 [-7.64357503e-03]
 [-2.73312233e-03]
 [ 5.31143305e-03]
 [-4.51098336e-04]
 [-5.53224918e-05]
 [ 6.53471123e-03]
 [-5.47966640e-04]
 [ 1.61654359e-03]
 [ 1.67005235e-02]
 [ 2.49485072e-03]
 [ 2.14468772e-02]
 [ 3.06858631e-03]
 [-1.25086215e-02]
 [ 3.63546195e-03]
 [ 1.07598721e-03]
 [-5.43882061e-03]
 [ 1.55400808e-02]
 [-8.33317696e-03]
 [ 1.05396279e-02]
 [-1.11921971e-02]
 [ 1.15328613e-02]
 [-8.33403433e-03]
 [ 1.59885369e-02]
 [-2.24335501e-02]
 [-4.26745591e-03]
 [-6.75156625e-03]
 [-2.14356727e-03]
 [-4.60874193e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.82888511]
curr_Stock_Price:  100.70144428233849
curr_Factors:  [100.70144428]
mat_Sqrt:  [[0.15]]
grads:  [-0.0020433]
Stock Position:  -0.0020433033333671843
Bond Position:  [13.0346487]


portfolio before change:  [12.83036624]
curr_Stock_Price:  100.37528596662979
curr_Factors:  [100.37528597]
mat_Sqrt:  [[0.15]]
grads:  [0.01792925]
Stock Position:  0.017929250727426495
Bond Position:  [11.03071257]


portfolio before change:  [12.8058244]
curr_Stock_Price:  98.96801699465215
curr_Factors:  [98.96801699]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213748]
Stock Position:  -0.022137476648296784
Bond Position:  [14.99672657]


portfolio before change:  [12.80187903]
curr_Stock_Price:  99.18857963153818
curr_Factors:  [99.18857963]
mat_Sqrt:  [[0.15]]
grads:  [0.05200424]
Stock Position:  0.05200423968776042
Bond Position:  [7.64365236]


portfolio before change:  [12.81000563]
curr_Stock_Price:  99.33566117849558
curr_Factors:  [99.33566118]
mat_Sqrt:  [[0.15]]
grads:  [0.01977385]
Stock Position:  0.019773854135519853
Bond Position:  [10.84575676]


portfolio before change:  [12.81731579]
curr_Stock_Price:  99.67106749192175
curr_Factors:  [99.67106749]
mat_Sqrt:  [[0.15]]
grads:  [0.14763188]
Stock Position:  0.14763188068049035
Bond Position:  [-1.89731135]


portfolio before change:  [12.81334476]
curr_Stock_Price:  99.64497258360791
curr_Factors:  [99.64497258]
mat_Sqrt:  [[0.15]]
grads:  [0.00391301]
Stock Position:  0.003913011630460041
Bond Position:  [12.42343283]


portfolio before change:  [12.80942438]
curr_Stock_Price:  98.44465030347406
curr_Factors:  [98.4446503]
mat_Sqrt:  [[0.15]]
grads:  [-0.14902773]
Stock Position:  -0.1490277309096921
Bond Position:  [27.48040723]


portfolio before change:  [13.06373965]
curr_Stock_Price:  96.74967919710411
curr_Factors:  [96.7496792]
mat_Sqrt:  [[0.15]]
grads:  [-0.28622608]
Stock Position:  -0.2862260796313678
Bond Position:  [40.75602104]


portfolio before change:  [13.1184398]
curr_Stock_Price:  96.56747072117126
curr_Factors:  [96.56747072]
mat_Sqrt:  [[0.15]]
grads:  [0.26710417]
Stock Position:  0.26710416707351803
Bond Position:  [-12.67513403]


portfolio before change:  [13.17665192]
curr_Stock_Price:  96.78837455240543
curr_Factors:  [96.78837455]
mat_Sqrt:  [[0.15]]
grads:  [-0.60454241]
Stock Position:  -0.6045424080949807
Bond Position:  [71.68932894]


portfolio before change:  [13.03572785]
curr_Stock_Price:  97.02889497070703
curr_Factors:  [97.02889497]
mat_Sqrt:  [[0.15]]
grads:  [0.21155238]
Stock Position:  0.21155238435202692
Bond Position:  [-7.49096624]


portfolio before change:  [12.97248102]
curr_Stock_Price:  96.73214283314087
curr_Factors:  [96.73214283]
mat_Sqrt:  [[0.15]]
grads:  [-0.05828948]
Stock Position:  -0.05828948059000159
Bond Position:  [18.61094739]


portfolio before change:  [12.97523834]
curr_Stock_Price:  96.70479495950659
curr_Factors:  [96.70479496]
mat_Sqrt:  [[0.15]]
grads:  [-0.00445149]
Stock Position:  -0.0044514877077336985
Bond Position:  [13.40571854]


portfolio before change:  [12.97584299]
curr_Stock_Price:  96.75718918225174
curr_Factors:  [96.75718918]
mat_Sqrt:  [[0.15]]
grads:  [-0.0471239]
Stock Position:  -0.047123899964831184
Bond Position:  [17.53541909]


portfolio before change:  [12.9753935]
curr_Stock_Price:  96.78998547033589
curr_Factors:  [96.78998547]
mat_Sqrt:  [[0.15]]
grads:  [0.07218604]
Stock Position:  0.07218604341040975
Bond Position:  [5.98850741]


portfolio before change:  [12.98768965]
curr_Stock_Price:  96.9551401329233
curr_Factors:  [96.95514013]
mat_Sqrt:  [[0.15]]
grads:  [0.08754296]
Stock Position:  0.08754296204979897
Bond Position:  [4.4999495]


portfolio before change:  [12.96527622]
curr_Stock_Price:  96.69589954745489
curr_Factors:  [96.69589955]
mat_Sqrt:  [[0.15]]
grads:  [0.10037243]
Stock Position:  0.10037243463153277
Bond Position:  [3.25967336]


portfolio before change:  [13.03224243]
curr_Stock_Price:  97.36104700696652
curr_Factors:  [97.36104701]
mat_Sqrt:  [[0.15]]
grads:  [0.01493423]
Stock Position:  0.014934232337642335
Bond Position:  [11.57822993]


portfolio before change:  [13.05257653]
curr_Stock_Price:  98.67416688140426
curr_Factors:  [98.67416688]
mat_Sqrt:  [[0.15]]
grads:  [0.07621268]
Stock Position:  0.07621267543347797
Bond Position:  [5.53235427]


portfolio before change:  [12.99590102]
curr_Stock_Price:  97.92598045956971
curr_Factors:  [97.92598046]
mat_Sqrt:  [[0.15]]
grads:  [0.08241352]
Stock Position:  0.08241351652162791
Bond Position:  [4.92547661]


portfolio before change:  [12.98379549]
curr_Stock_Price:  97.77535738592837
curr_Factors:  [97.77535739]
mat_Sqrt:  [[0.15]]
grads:  [-0.06457951]
Stock Position:  -0.0645795102291074
Bond Position:  [19.29808019]


portfolio before change:  [12.97929019]
curr_Stock_Price:  97.8637982428968
curr_Factors:  [97.86379824]
mat_Sqrt:  [[0.15]]
grads:  [0.03817868]
Stock Position:  0.03817867737708057
Bond Position:  [9.24297981]


portfolio before change:  [13.00414791]
curr_Stock_Price:  98.49975566696098
curr_Factors:  [98.49975567]
mat_Sqrt:  [[0.15]]
grads:  [0.04814036]
Stock Position:  0.04814036163658483
Bond Position:  [8.26233405]


portfolio before change:  [12.99047674]
curr_Stock_Price:  98.20504285255323
curr_Factors:  [98.20504285]
mat_Sqrt:  [[0.15]]
grads:  [-0.05487535]
Stock Position:  -0.054875348640222935
Bond Position:  [18.37951271]


portfolio before change:  [12.97947785]
curr_Stock_Price:  98.4264109617583
curr_Factors:  [98.42641096]
mat_Sqrt:  [[0.15]]
grads:  [-0.0578587]
Stock Position:  -0.05785869670873456
Bond Position:  [18.67430171]


portfolio before change:  [12.97325469]
curr_Stock_Price:  98.55414170196975
curr_Factors:  [98.5541417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035025]
Stock Position:  -0.030350245818945052
Bond Position:  [15.96439712]


portfolio before change:  [12.92568431]
curr_Stock_Price:  100.15439862577934
curr_Factors:  [100.15439863]
mat_Sqrt:  [[0.15]]
grads:  [0.03857136]
Stock Position:  0.03857136128931445
Bond Position:  [9.06259281]


portfolio before change:  [12.90521939]
curr_Stock_Price:  99.60914061879059
curr_Factors:  [99.60914062]
mat_Sqrt:  [[0.15]]
grads:  [-0.05608568]
Stock Position:  -0.056085683366966024
Bond Position:  [18.49186611]


portfolio before change:  [12.85024149]
curr_Stock_Price:  100.60999646910017
curr_Factors:  [100.60999647]
mat_Sqrt:  [[0.15]]
grads:  [-0.02241155]
Stock Position:  -0.02241155162376538
Bond Position:  [15.10506762]


portfolio before change:  [12.83970863]
curr_Stock_Price:  101.12209626429248
curr_Factors:  [101.12209626]
mat_Sqrt:  [[0.15]]
grads:  [0.06004029]
Stock Position:  0.06004029148629018
Bond Position:  [6.7683085]


portfolio before change:  [12.81256492]
curr_Stock_Price:  100.66295877686406
curr_Factors:  [100.66295878]
mat_Sqrt:  [[0.15]]
grads:  [-0.08058497]
Stock Position:  -0.08058497235850011
Bond Position:  [20.92448667]


portfolio before change:  [12.69715175]
curr_Stock_Price:  102.11138005975084
curr_Factors:  [102.11138006]
mat_Sqrt:  [[0.15]]
grads:  [0.0420335]
Stock Position:  0.04203349574342384
Bond Position:  [8.40505349]


portfolio before change:  [12.7018038]
curr_Stock_Price:  102.20955687790837
curr_Factors:  [102.20955688]
mat_Sqrt:  [[0.15]]
grads:  [0.05617821]
Stock Position:  0.05617820981269758
Bond Position:  [6.95985386]


portfolio before change:  [12.69541517]
curr_Stock_Price:  102.08809288119453
curr_Factors:  [102.08809288]
mat_Sqrt:  [[0.15]]
grads:  [0.07269375]
Stock Position:  0.07269374567567234
Bond Position:  [5.27424931]


portfolio before change:  [12.71505925]
curr_Stock_Price:  102.35378871343248
curr_Factors:  [102.35378871]
mat_Sqrt:  [[0.15]]
grads:  [0.05683783]
Stock Position:  0.05683782501822714
Bond Position:  [6.89749251]


portfolio before change:  [12.75824258]
curr_Stock_Price:  103.1059677835202
curr_Factors:  [103.10596778]
mat_Sqrt:  [[0.15]]
grads:  [-0.22004697]
Stock Position:  -0.22004697000861465
Bond Position:  [35.44639838]


portfolio before change:  [12.9137128]
curr_Stock_Price:  102.40950395650003
curr_Factors:  [102.40950396]
mat_Sqrt:  [[0.15]]
grads:  [0.06224518]
Stock Position:  0.06224517837215483
Bond Position:  [6.53921496]


portfolio before change:  [12.96074542]
curr_Stock_Price:  103.1585404089191
curr_Factors:  [103.15854041]
mat_Sqrt:  [[0.15]]
grads:  [0.06171706]
Stock Position:  0.06171705837705106
Bond Position:  [6.59410376]


portfolio before change:  [12.91435346]
curr_Stock_Price:  102.40017470705523
curr_Factors:  [102.40017471]
mat_Sqrt:  [[0.15]]
grads:  [0.12813109]
Stock Position:  0.12813108819495264
Bond Position:  [-0.20629235]


portfolio before change:  [12.73283197]
curr_Stock_Price:  100.98358954798596
curr_Factors:  [100.98358955]
mat_Sqrt:  [[0.15]]
grads:  [-0.03869529]
Stock Position:  -0.03869528583711166
Bond Position:  [16.64042084]


portfolio before change:  [12.71527792]
curr_Stock_Price:  101.46411606747421
curr_Factors:  [101.46411607]
mat_Sqrt:  [[0.15]]
grads:  [-0.12753763]
Stock Position:  -0.12753762711189398
Bond Position:  [25.65577052]


portfolio before change:  [12.75794227]
curr_Stock_Price:  101.14216551634699
curr_Factors:  [101.14216552]
mat_Sqrt:  [[0.15]]
grads:  [0.1508747]
Stock Position:  0.15087469760848943
Bond Position:  [-2.50185137]


portfolio before change:  [12.67787479]
curr_Stock_Price:  100.61251336693962
curr_Factors:  [100.61251337]
mat_Sqrt:  [[0.15]]
grads:  [0.02136457]
Stock Position:  0.021364566707914482
Bond Position:  [10.52833203]


portfolio before change:  [12.67890109]
curr_Stock_Price:  100.62975041741548
curr_Factors:  [100.62975042]
mat_Sqrt:  [[0.15]]
grads:  [-0.0505308]
Stock Position:  -0.05053080047994018
Bond Position:  [17.76380293]


portfolio before change:  [12.73783901]
curr_Stock_Price:  99.48534650238904
curr_Factors:  [99.4853465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03295659]
Stock Position:  -0.0329565898869523
Bond Position:  [16.01653677]


portfolio before change:  [12.73543074]
curr_Stock_Price:  99.58879572595282
curr_Factors:  [99.58879573]
mat_Sqrt:  [[0.15]]
grads:  [0.01942388]
Stock Position:  0.01942387687879875
Bond Position:  [10.80103023]


portfolio before change:  [12.74013071]
curr_Stock_Price:  99.79600905468804
curr_Factors:  [99.79600905]
mat_Sqrt:  [[0.15]]
grads:  [-0.08162986]
Stock Position:  -0.08162985857160208
Bond Position:  [20.88646482]


portfolio before change:  [12.76003851]
curr_Stock_Price:  99.56812238789159
curr_Factors:  [99.56812239]
mat_Sqrt:  [[0.15]]
grads:  [-0.08695058]
Stock Position:  -0.08695058206004037
Bond Position:  [21.41754471]


portfolio before change:  [12.740927]
curr_Stock_Price:  99.80331517501186
curr_Factors:  [99.80331518]
mat_Sqrt:  [[0.15]]
grads:  [-0.04316496]
Stock Position:  -0.043164964668116076
Bond Position:  [17.04893358]


portfolio before change:  [12.70694923]
curr_Stock_Price:  100.61516266687113
curr_Factors:  [100.61516267]
mat_Sqrt:  [[0.15]]
grads:  [0.2288698]
Stock Position:  0.22886979971853522
Bond Position:  [-10.3208229]


portfolio before change:  [12.74200819]
curr_Stock_Price:  100.77116419474386
curr_Factors:  [100.77116419]
mat_Sqrt:  [[0.15]]
grads:  [-0.05095717]
Stock Position:  -0.05095716684332931
Bond Position:  [17.87702122]


portfolio before change:  [12.71114079]
curr_Stock_Price:  101.39884330488266
curr_Factors:  [101.3988433]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822082]
Stock Position:  -0.01822081555803807
Bond Position:  [14.55871041]


portfolio before change:  [12.71485645]
curr_Stock_Price:  101.2448596296363
curr_Factors:  [101.24485963]
mat_Sqrt:  [[0.15]]
grads:  [0.03540955]
Stock Position:  0.03540955365196322
Bond Position:  [9.12982116]


portfolio before change:  [12.74641192]
curr_Stock_Price:  102.11990142937967
curr_Factors:  [102.11990143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00300732]
Stock Position:  -0.0030073222418966947
Bond Position:  [13.05351937]


portfolio before change:  [12.74770061]
curr_Stock_Price:  101.96267944079992
curr_Factors:  [101.96267944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00036882]
Stock Position:  -0.0003688166120477283
Bond Position:  [12.78530614]


portfolio before change:  [12.74871984]
curr_Stock_Price:  101.36582073915069
curr_Factors:  [101.36582074]
mat_Sqrt:  [[0.15]]
grads:  [0.04356474]
Stock Position:  0.04356474156310554
Bond Position:  [8.33274406]


portfolio before change:  [12.74603544]
curr_Stock_Price:  101.29224705449786
curr_Factors:  [101.29224705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00365311]
Stock Position:  -0.003653110931015359
Bond Position:  [13.11606725]


portfolio before change:  [12.74536219]
curr_Stock_Price:  101.70094647349308
curr_Factors:  [101.70094647]
mat_Sqrt:  [[0.15]]
grads:  [0.01077696]
Stock Position:  0.010776957258941625
Bond Position:  [11.64933544]


portfolio before change:  [12.75990492]
curr_Stock_Price:  102.98281299417215
curr_Factors:  [102.98281299]
mat_Sqrt:  [[0.15]]
grads:  [0.11133682]
Stock Position:  0.11133682348497358
Bond Position:  [1.29412565]


portfolio before change:  [12.8293619]
curr_Stock_Price:  103.60593200773663
curr_Factors:  [103.60593201]
mat_Sqrt:  [[0.15]]
grads:  [0.01663234]
Stock Position:  0.01663233814857937
Bond Position:  [11.106153]


portfolio before change:  [12.83309211]
curr_Stock_Price:  103.78847143827336
curr_Factors:  [103.78847144]
mat_Sqrt:  [[0.15]]
grads:  [0.14297918]
Stock Position:  0.14297918114137728
Bond Position:  [-2.00649855]


portfolio before change:  [12.76733568]
curr_Stock_Price:  103.32944639678207
curr_Factors:  [103.3294464]
mat_Sqrt:  [[0.15]]
grads:  [0.02045724]
Stock Position:  0.02045724205601968
Bond Position:  [10.65350018]


portfolio before change:  [12.76494732]
curr_Stock_Price:  103.18014862264343
curr_Factors:  [103.18014862]
mat_Sqrt:  [[0.15]]
grads:  [-0.08339081]
Stock Position:  -0.08339080974960027
Bond Position:  [21.36922346]


portfolio before change:  [12.78598332]
curr_Stock_Price:  102.94390704732781
curr_Factors:  [102.94390705]
mat_Sqrt:  [[0.15]]
grads:  [0.02423641]
Stock Position:  0.02423641300554686
Bond Position:  [10.29099227]


portfolio before change:  [12.77809706]
curr_Stock_Price:  102.59197936775404
curr_Factors:  [102.59197937]
mat_Sqrt:  [[0.15]]
grads:  [0.00717325]
Stock Position:  0.007173248036637127
Bond Position:  [12.04217934]


portfolio before change:  [12.77715401]
curr_Stock_Price:  102.35558622681486
curr_Factors:  [102.35558623]
mat_Sqrt:  [[0.15]]
grads:  [-0.0362588]
Stock Position:  -0.03625880407607925
Bond Position:  [16.48844516]


portfolio before change:  [12.79453006]
curr_Stock_Price:  101.9047857247637
curr_Factors:  [101.90478572]
mat_Sqrt:  [[0.15]]
grads:  [0.10360054]
Stock Position:  0.10360053897890491
Bond Position:  [2.23713933]


portfolio before change:  [12.77890987]
curr_Stock_Price:  101.75266281561564
curr_Factors:  [101.75266282]
mat_Sqrt:  [[0.15]]
grads:  [-0.05555451]
Stock Position:  -0.05555451305144881
Bond Position:  [18.4317295]


portfolio before change:  [12.78664451]
curr_Stock_Price:  101.6341734463267
curr_Factors:  [101.63417345]
mat_Sqrt:  [[0.15]]
grads:  [0.07026419]
Stock Position:  0.07026418609442578
Bond Position:  [5.64540203]


portfolio before change:  [12.75979738]
curr_Stock_Price:  101.2470633853461
curr_Factors:  [101.24706339]
mat_Sqrt:  [[0.15]]
grads:  [-0.07461465]
Stock Position:  -0.07461464749582891
Bond Position:  [20.31431133]


portfolio before change:  [12.7389017]
curr_Stock_Price:  101.54412796244006
curr_Factors:  [101.54412796]
mat_Sqrt:  [[0.15]]
grads:  [0.07688574]
Stock Position:  0.076885742014868
Bond Position:  [4.93160607]


portfolio before change:  [12.68599143]
curr_Stock_Price:  100.85195146872775
curr_Factors:  [100.85195147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05556023]
Stock Position:  -0.05556022887681581
Bond Position:  [18.28934894]


portfolio before change:  [12.70588929]
curr_Stock_Price:  100.51439459997121
curr_Factors:  [100.5143946]
mat_Sqrt:  [[0.15]]
grads:  [0.10659025]
Stock Position:  0.10659024627403534
Bond Position:  [1.99203521]


portfolio before change:  [12.69997708]
curr_Stock_Price:  100.45775983547972
curr_Factors:  [100.45775984]
mat_Sqrt:  [[0.15]]
grads:  [-0.149557]
Stock Position:  -0.14955700041674577
Bond Position:  [27.72413831]


portfolio before change:  [12.8263077]
curr_Stock_Price:  99.62464729502403
curr_Factors:  [99.6246473]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844971]
Stock Position:  -0.028449706086386917
Bond Position:  [15.66059964]


portfolio before change:  [12.81561511]
curr_Stock_Price:  100.03489448699085
curr_Factors:  [100.03489449]
mat_Sqrt:  [[0.15]]
grads:  [-0.04501044]
Stock Position:  -0.04501044163595061
Bond Position:  [17.31822989]


portfolio before change:  [12.82835548]
curr_Stock_Price:  99.775889028249
curr_Factors:  [99.77588903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01429045]
Stock Position:  -0.0142904484757041
Bond Position:  [14.25419768]


portfolio before change:  [12.83964828]
curr_Stock_Price:  99.04799883942373
curr_Factors:  [99.04799884]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.83964828]
Stock Price:  98.95353070157994
PL:  [12.83964828]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.22370718e-04]
 [-9.54571972e-03]
 [-3.18209813e-03]
 [ 1.12053563e-03]
 [ 3.49840907e-02]
 [ 2.64100827e-02]
 [ 3.95639647e-03]
 [ 1.97173091e-02]
 [ 2.45384221e-02]
 [-2.09248719e-03]
 [ 5.00719446e-02]
 [ 6.11841403e-02]
 [ 1.26446004e-01]
 [ 1.82249697e-02]
 [-6.89353414e-03]
 [ 2.62536605e-02]
 [ 1.14131659e-02]
 [-9.70247533e-03]
 [ 4.64171067e-03]
 [-8.25630155e-03]
 [ 1.45886148e-02]
 [-1.40938555e-02]
 [ 1.09682675e-02]
 [-4.71331107e-02]
 [ 8.52514268e-03]
 [ 6.03485946e-03]
 [-4.28413103e-03]
 [ 1.45281524e-02]
 [ 4.93198391e-02]
 [ 4.70311583e-03]
 [ 1.94238710e-02]
 [-1.34528038e-03]
 [-1.59807942e-04]
 [ 8.28046570e-03]
 [ 1.05250230e-02]
 [ 8.49631615e-03]
 [-3.38832686e-02]
 [ 9.55149586e-03]
 [ 5.06025121e-03]
 [ 1.90791267e-02]
 [-4.54659788e-03]
 [-2.06785381e-02]
 [ 2.10448047e-02]
 [-1.41840789e-03]
 [ 2.45184664e-03]
 [-1.56771549e-02]
 [ 1.43086089e-02]
 [ 2.72283008e-03]
 [-1.34081930e-03]
 [-7.42805938e-03]
 [-3.12417709e-02]
 [ 2.06112881e-03]
 [-3.81681068e-03]
 [ 5.30964818e-03]
 [ 5.30991051e-03]
 [-2.90055890e-03]
 [ 6.54926469e-03]
 [-6.16215577e-05]
 [ 1.55247125e-03]
 [-2.30931483e-03]
 [ 9.00849938e-04]
 [-8.28984017e-03]
 [-6.35399012e-03]
 [-1.25125136e-02]
 [-6.14840517e-03]
 [-3.03260659e-04]
 [-5.51684640e-03]
 [ 1.84057022e-02]
 [-8.24574571e-03]
 [ 9.59197578e-03]
 [-1.13092238e-02]
 [ 1.18078448e-02]
 [ 5.71114146e-04]
 [ 2.12251054e-02]
 [-2.29560935e-02]
 [-1.55850244e-04]
 [-6.51714680e-03]
 [-8.92470326e-03]
 [ 2.82394030e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.71714324]
curr_Stock_Price:  101.14935298396838
curr_Factors:  [101.14935298]
mat_Sqrt:  [[0.15]]
grads:  [-0.00148247]
Stock Position:  -0.0014824714536135208
Bond Position:  [19.86709426]


portfolio before change:  [19.71678613]
curr_Stock_Price:  102.22784866124694
curr_Factors:  [102.22784866]
mat_Sqrt:  [[0.15]]
grads:  [-0.06363813]
Stock Position:  -0.06363813147270529
Bond Position:  [26.2223754]


portfolio before change:  [19.70550842]
curr_Stock_Price:  102.43081906711329
curr_Factors:  [102.43081907]
mat_Sqrt:  [[0.15]]
grads:  [-0.02121399]
Stock Position:  -0.0212139875021836
Bond Position:  [21.87847454]


portfolio before change:  [19.72315785]
curr_Stock_Price:  101.66330740522076
curr_Factors:  [101.66330741]
mat_Sqrt:  [[0.15]]
grads:  [0.00747024]
Stock Position:  0.007470237526085051
Bond Position:  [18.9637088]


portfolio before change:  [19.72880531]
curr_Stock_Price:  102.26063679397681
curr_Factors:  [102.26063679]
mat_Sqrt:  [[0.15]]
grads:  [0.23322727]
Stock Position:  0.2332272711253517
Bond Position:  [-4.12116395]


portfolio before change:  [19.86418507]
curr_Stock_Price:  102.8422040240376
curr_Factors:  [102.84220402]
mat_Sqrt:  [[0.15]]
grads:  [0.17606722]
Stock Position:  0.1760672181373047
Bond Position:  [1.7570443]


portfolio before change:  [19.78045016]
curr_Stock_Price:  102.3659954088178
curr_Factors:  [102.36599541]
mat_Sqrt:  [[0.15]]
grads:  [0.02637598]
Stock Position:  0.02637597645288411
Bond Position:  [17.08044708]


portfolio before change:  [19.8040878]
curr_Stock_Price:  103.22170125835166
curr_Factors:  [103.22170126]
mat_Sqrt:  [[0.15]]
grads:  [0.13144873]
Stock Position:  0.13144872762679943
Bond Position:  [6.23572651]


portfolio before change:  [19.72043557]
curr_Stock_Price:  102.5823494882501
curr_Factors:  [102.58234949]
mat_Sqrt:  [[0.15]]
grads:  [0.16358948]
Stock Position:  0.1635894804746185
Bond Position:  [2.93904231]


portfolio before change:  [19.85412157]
curr_Stock_Price:  103.39843070302466
curr_Factors:  [103.3984307]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394991]
Stock Position:  -0.013949914624878405
Bond Position:  [21.29652085]


portfolio before change:  [19.85886648]
curr_Stock_Price:  103.15370956095657
curr_Factors:  [103.15370956]
mat_Sqrt:  [[0.15]]
grads:  [0.33381296]
Stock Position:  0.33381296413623257
Bond Position:  [-14.57517907]


portfolio before change:  [19.91933027]
curr_Stock_Price:  103.33756929785744
curr_Factors:  [103.3375693]
mat_Sqrt:  [[0.15]]
grads:  [0.40789427]
Stock Position:  0.40789426847870786
Bond Position:  [-22.23147197]


portfolio before change:  [20.02344404]
curr_Stock_Price:  103.59622280913504
curr_Factors:  [103.59622281]
mat_Sqrt:  [[0.15]]
grads:  [0.84297336]
Stock Position:  0.8429733616025463
Bond Position:  [-67.30541215]


portfolio before change:  [20.08114785]
curr_Stock_Price:  103.66966585286639
curr_Factors:  [103.66966585]
mat_Sqrt:  [[0.15]]
grads:  [0.1214998]
Stock Position:  0.12149979796556326
Bond Position:  [7.48530439]


portfolio before change:  [20.02463168]
curr_Stock_Price:  103.20066078723089
curr_Factors:  [103.20066079]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595689]
Stock Position:  -0.04595689423736309
Bond Position:  [24.76741353]


portfolio before change:  [20.06674573]
curr_Stock_Price:  102.31796320607948
curr_Factors:  [102.31796321]
mat_Sqrt:  [[0.15]]
grads:  [0.1750244]
Stock Position:  0.1750244036446123
Bond Position:  [2.15860524]


portfolio before change:  [20.11716284]
curr_Stock_Price:  102.60524998433642
curr_Factors:  [102.60524998]
mat_Sqrt:  [[0.15]]
grads:  [0.07608777]
Stock Position:  0.07608777256564835
Bond Position:  [12.31015792]


portfolio before change:  [20.08626434]
curr_Stock_Price:  102.18904756451627
curr_Factors:  [102.18904756]
mat_Sqrt:  [[0.15]]
grads:  [-0.06468317]
Stock Position:  -0.06468316888189735
Bond Position:  [26.69617576]


portfolio before change:  [20.07509983]
curr_Stock_Price:  102.38744643235565
curr_Factors:  [102.38744643]
mat_Sqrt:  [[0.15]]
grads:  [0.03094474]
Stock Position:  0.030944737778494918
Bond Position:  [16.90674715]


portfolio before change:  [20.1198937]
curr_Stock_Price:  103.80084221977856
curr_Factors:  [103.80084222]
mat_Sqrt:  [[0.15]]
grads:  [-0.05504201]
Stock Position:  -0.05504201030399669
Bond Position:  [25.83330072]


portfolio before change:  [20.13818729]
curr_Stock_Price:  103.49781980264473
curr_Factors:  [103.4978198]
mat_Sqrt:  [[0.15]]
grads:  [0.09725743]
Stock Position:  0.0972574319225592
Bond Position:  [10.07225513]


portfolio before change:  [20.19766506]
curr_Stock_Price:  104.1028967485326
curr_Factors:  [104.10289675]
mat_Sqrt:  [[0.15]]
grads:  [-0.09395904]
Stock Position:  -0.09395903676267055
Bond Position:  [29.97907296]


portfolio before change:  [20.25056828]
curr_Stock_Price:  103.5597933499567
curr_Factors:  [103.55979335]
mat_Sqrt:  [[0.15]]
grads:  [0.07312178]
Stock Position:  0.07312178319878429
Bond Position:  [12.67809152]


portfolio before change:  [20.27133103]
curr_Stock_Price:  103.83290412473241
curr_Factors:  [103.83290412]
mat_Sqrt:  [[0.15]]
grads:  [-0.31422074]
Stock Position:  -0.3142207381057542
Bond Position:  [52.89778281]


portfolio before change:  [20.23235092]
curr_Stock_Price:  103.96747936282418
curr_Factors:  [103.96747936]
mat_Sqrt:  [[0.15]]
grads:  [0.05683428]
Stock Position:  0.05683428454812981
Bond Position:  [14.32343361]


portfolio before change:  [20.28566822]
curr_Stock_Price:  104.88984628450201
curr_Factors:  [104.88984628]
mat_Sqrt:  [[0.15]]
grads:  [0.0402324]
Stock Position:  0.04023239641227987
Bond Position:  [16.06569835]


portfolio before change:  [20.2722041]
curr_Stock_Price:  104.53022910483712
curr_Factors:  [104.5302291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02856087]
Stock Position:  -0.028560873535142355
Bond Position:  [23.25767875]


portfolio before change:  [20.3003666]
curr_Stock_Price:  103.5950740112022
curr_Factors:  [103.59507401]
mat_Sqrt:  [[0.15]]
grads:  [0.09685435]
Stock Position:  0.09685434919147791
Bond Position:  [10.26673312]


portfolio before change:  [20.30153437]
curr_Stock_Price:  103.60050566026415
curr_Factors:  [103.60050566]
mat_Sqrt:  [[0.15]]
grads:  [0.32879893]
Stock Position:  0.32879892759303136
Bond Position:  [-13.76220079]


portfolio before change:  [20.33604471]
curr_Stock_Price:  103.70808053595098
curr_Factors:  [103.70808054]
mat_Sqrt:  [[0.15]]
grads:  [0.03135411]
Stock Position:  0.031354105518596145
Bond Position:  [17.08437061]


portfolio before change:  [20.35121266]
curr_Stock_Price:  104.15778713454182
curr_Factors:  [104.15778713]
mat_Sqrt:  [[0.15]]
grads:  [0.12949247]
Stock Position:  0.1294924732562217
Bond Position:  [6.8635632]


portfolio before change:  [20.30781346]
curr_Stock_Price:  103.81932583252606
curr_Factors:  [103.81932583]
mat_Sqrt:  [[0.15]]
grads:  [-0.00896854]
Stock Position:  -0.008968535894172883
Bond Position:  [21.23892081]


portfolio before change:  [20.31141285]
curr_Stock_Price:  103.566004218366
curr_Factors:  [103.56600422]
mat_Sqrt:  [[0.15]]
grads:  [-0.00106539]
Stock Position:  -0.001065386280607412
Bond Position:  [20.42175065]


portfolio before change:  [20.31230859]
curr_Stock_Price:  103.92330273046159
curr_Factors:  [103.92330273]
mat_Sqrt:  [[0.15]]
grads:  [0.0552031]
Stock Position:  0.0552031046430983
Bond Position:  [14.57541964]


portfolio before change:  [20.26905655]
curr_Stock_Price:  103.1232928087351
curr_Factors:  [103.12329281]
mat_Sqrt:  [[0.15]]
grads:  [0.07016682]
Stock Position:  0.07016681975063345
Bond Position:  [13.03322305]


portfolio before change:  [20.18346146]
curr_Stock_Price:  101.89180341153983
curr_Factors:  [101.89180341]
mat_Sqrt:  [[0.15]]
grads:  [0.05664211]
Stock Position:  0.05664210763725387
Bond Position:  [14.41209496]


portfolio before change:  [20.15590267]
curr_Stock_Price:  101.38935790786843
curr_Factors:  [101.38935791]
mat_Sqrt:  [[0.15]]
grads:  [-0.22588846]
Stock Position:  -0.22588845755715067
Bond Position:  [43.05858834]


portfolio before change:  [20.05782289]
curr_Stock_Price:  101.83546757754338
curr_Factors:  [101.83546758]
mat_Sqrt:  [[0.15]]
grads:  [0.06367664]
Stock Position:  0.06367663906778688
Bond Position:  [13.57328258]


portfolio before change:  [20.06548099]
curr_Stock_Price:  101.94241014830826
curr_Factors:  [101.94241015]
mat_Sqrt:  [[0.15]]
grads:  [0.03373501]
Stock Position:  0.03373500804110278
Bond Position:  [16.62645297]


portfolio before change:  [20.08352338]
curr_Stock_Price:  102.44643255346296
curr_Factors:  [102.44643255]
mat_Sqrt:  [[0.15]]
grads:  [0.12719418]
Stock Position:  0.12719417774664665
Bond Position:  [7.05293363]


portfolio before change:  [20.10380482]
curr_Stock_Price:  102.60241940755128
curr_Factors:  [102.60241941]
mat_Sqrt:  [[0.15]]
grads:  [-0.03031065]
Stock Position:  -0.030310652510659477
Bond Position:  [23.2137511]


portfolio before change:  [20.10838997]
curr_Stock_Price:  102.49901543495903
curr_Factors:  [102.49901543]
mat_Sqrt:  [[0.15]]
grads:  [-0.13785692]
Stock Position:  -0.13785692070590927
Bond Position:  [34.23858861]


portfolio before change:  [20.11406527]
curr_Stock_Price:  102.47337057723846
curr_Factors:  [102.47337058]
mat_Sqrt:  [[0.15]]
grads:  [0.1402987]
Stock Position:  0.14029869774577258
Bond Position:  [5.73718482]


portfolio before change:  [20.22394694]
curr_Stock_Price:  103.25401281895155
curr_Factors:  [103.25401282]
mat_Sqrt:  [[0.15]]
grads:  [-0.00945605]
Stock Position:  -0.009456052578119743
Bond Position:  [21.20032232]


portfolio before change:  [20.22564806]
curr_Stock_Price:  103.21424425919527
curr_Factors:  [103.21424426]
mat_Sqrt:  [[0.15]]
grads:  [0.01634564]
Stock Position:  0.01634564428362727
Bond Position:  [18.53854474]


portfolio before change:  [20.22823779]
curr_Stock_Price:  103.30179299845013
curr_Factors:  [103.301793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10451437]
Stock Position:  -0.10451436617161507
Bond Position:  [31.02475921]


portfolio before change:  [20.25715963]
curr_Stock_Price:  103.04362057996194
curr_Factors:  [103.04362058]
mat_Sqrt:  [[0.15]]
grads:  [0.09539073]
Stock Position:  0.0953907260390923
Bond Position:  [10.42775385]


portfolio before change:  [20.22477351]
curr_Stock_Price:  102.69727793168552
curr_Factors:  [102.69727793]
mat_Sqrt:  [[0.15]]
grads:  [0.0181522]
Stock Position:  0.018152200554143006
Bond Position:  [18.36059192]


portfolio before change:  [20.22239298]
curr_Stock_Price:  102.50291612811519
curr_Factors:  [102.50291613]
mat_Sqrt:  [[0.15]]
grads:  [-0.0089388]
Stock Position:  -0.00893879535469304
Bond Position:  [21.13864558]


portfolio before change:  [20.22312138]
curr_Stock_Price:  102.5692350008308
curr_Factors:  [102.569235]
mat_Sqrt:  [[0.15]]
grads:  [-0.0495204]
Stock Position:  -0.049520395844288474
Bond Position:  [25.3023905]


portfolio before change:  [20.23268327]
curr_Stock_Price:  102.40808031246908
curr_Factors:  [102.40808031]
mat_Sqrt:  [[0.15]]
grads:  [-0.20827847]
Stock Position:  -0.20827847262568408
Bond Position:  [41.56208183]


portfolio before change:  [20.23115682]
curr_Stock_Price:  102.42788151105533
curr_Factors:  [102.42788151]
mat_Sqrt:  [[0.15]]
grads:  [0.01374086]
Stock Position:  0.013740858713408011
Bond Position:  [18.82370977]


portfolio before change:  [20.2208989]
curr_Stock_Price:  101.59573270314492
curr_Factors:  [101.5957327]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254454]
Stock Position:  -0.02544540450280873
Bond Position:  [22.80604341]


portfolio before change:  [20.2438393]
curr_Stock_Price:  100.75019786902399
curr_Factors:  [100.75019787]
mat_Sqrt:  [[0.15]]
grads:  [0.03539765]
Stock Position:  0.03539765455772659
Bond Position:  [16.6775186]


portfolio before change:  [20.23115399]
curr_Stock_Price:  100.362384482256
curr_Factors:  [100.36238448]
mat_Sqrt:  [[0.15]]
grads:  [0.0353994]
Stock Position:  0.035399403421469355
Bond Position:  [16.67838546]


portfolio before change:  [20.22266075]
curr_Stock_Price:  100.0930105254939
curr_Factors:  [100.09301053]
mat_Sqrt:  [[0.15]]
grads:  [-0.01933706]
Stock Position:  -0.01933705932766417
Bond Position:  [22.15816523]


portfolio before change:  [20.23178355]
curr_Stock_Price:  99.69285286164055
curr_Factors:  [99.69285286]
mat_Sqrt:  [[0.15]]
grads:  [0.04366176]
Stock Position:  0.04366176462415231
Bond Position:  [15.87901767]


portfolio before change:  [20.2305189]
curr_Stock_Price:  99.64115737007627
curr_Factors:  [99.64115737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041081]
Stock Position:  -0.0004108103847574895
Bond Position:  [20.27145252]


portfolio before change:  [20.23186129]
curr_Stock_Price:  99.45766452826761
curr_Factors:  [99.45766453]
mat_Sqrt:  [[0.15]]
grads:  [0.01034981]
Stock Position:  0.01034980832994223
Bond Position:  [19.20249352]


portfolio before change:  [20.24250897]
curr_Stock_Price:  100.37048239741719
curr_Factors:  [100.3704824]
mat_Sqrt:  [[0.15]]
grads:  [-0.01539543]
Stock Position:  -0.01539543218206034
Bond Position:  [21.78775592]


portfolio before change:  [20.23589011]
curr_Stock_Price:  100.88885935743087
curr_Factors:  [100.88885936]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [19.62998529]


portfolio before change:  [20.23900187]
curr_Stock_Price:  101.20270347722288
curr_Factors:  [101.20270348]
mat_Sqrt:  [[0.15]]
grads:  [-0.0552656]
Stock Position:  -0.055265601135838345
Bond Position:  [25.83203011]


portfolio before change:  [20.24024574]
curr_Stock_Price:  101.20941069670943
curr_Factors:  [101.2094107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04235993]
Stock Position:  -0.04235993412756649
Bond Position:  [24.52746971]


portfolio before change:  [20.21253094]
curr_Stock_Price:  101.89987009335832
curr_Factors:  [101.89987009]
mat_Sqrt:  [[0.15]]
grads:  [-0.08341676]
Stock Position:  -0.08341675759822997
Bond Position:  [28.7126877]


portfolio before change:  [20.28955955]
curr_Stock_Price:  100.99796482378086
curr_Factors:  [100.99796482]
mat_Sqrt:  [[0.15]]
grads:  [-0.04098937]
Stock Position:  -0.04098936777235748
Bond Position:  [24.42940228]


portfolio before change:  [20.27018091]
curr_Stock_Price:  101.50798786352306
curr_Factors:  [101.50798786]
mat_Sqrt:  [[0.15]]
grads:  [-0.00202174]
Stock Position:  -0.002021737729132611
Bond Position:  [20.47540344]


portfolio before change:  [20.27105975]
curr_Stock_Price:  101.70629281773235
curr_Factors:  [101.70629282]
mat_Sqrt:  [[0.15]]
grads:  [-0.03677898]
Stock Position:  -0.0367789759712576
Bond Position:  [24.01171305]


portfolio before change:  [20.28758123]
curr_Stock_Price:  101.29788813875452
curr_Factors:  [101.29788814]
mat_Sqrt:  [[0.15]]
grads:  [0.12270468]
Stock Position:  0.1227046814836164
Bond Position:  [7.85785613]


portfolio before change:  [20.28250564]
curr_Stock_Price:  101.25252129103647
curr_Factors:  [101.25252129]
mat_Sqrt:  [[0.15]]
grads:  [-0.05497164]
Stock Position:  -0.05497163807620521
Bond Position:  [25.84852259]


portfolio before change:  [20.2763673]
curr_Stock_Price:  101.3935743457064
curr_Factors:  [101.39357435]
mat_Sqrt:  [[0.15]]
grads:  [0.06394651]
Stock Position:  0.06394650522335144
Bond Position:  [13.79260257]


portfolio before change:  [20.29984825]
curr_Stock_Price:  101.74729005479601
curr_Factors:  [101.74729005]
mat_Sqrt:  [[0.15]]
grads:  [-0.07539483]
Stock Position:  -0.0753948252257546
Bond Position:  [27.9710674]


portfolio before change:  [20.28012495]
curr_Stock_Price:  102.032078199357
curr_Factors:  [102.0320782]
mat_Sqrt:  [[0.15]]
grads:  [0.07871897]
Stock Position:  0.0787189654772346
Bond Position:  [12.24826531]


portfolio before change:  [20.31529545]
curr_Stock_Price:  102.46913886437507
curr_Factors:  [102.46913886]
mat_Sqrt:  [[0.15]]
grads:  [0.00380743]
Stock Position:  0.003807427639285351
Bond Position:  [19.92515162]


portfolio before change:  [20.31697559]
curr_Stock_Price:  102.58333195541836
curr_Factors:  [102.58333196]
mat_Sqrt:  [[0.15]]
grads:  [0.1415007]
Stock Position:  0.14150070250211216
Bond Position:  [5.80136206]


portfolio before change:  [20.42424546]
curr_Stock_Price:  103.33885659840762
curr_Factors:  [103.3388566]
mat_Sqrt:  [[0.15]]
grads:  [-0.15304062]
Stock Position:  -0.15304062359292123
Bond Position:  [36.23928851]


portfolio before change:  [20.38078081]
curr_Stock_Price:  103.63766401222749
curr_Factors:  [103.63766401]
mat_Sqrt:  [[0.15]]
grads:  [-0.001039]
Stock Position:  -0.0010390016299741702
Bond Position:  [20.48846051]


portfolio before change:  [20.3821168]
curr_Stock_Price:  103.58432131452743
curr_Factors:  [103.58432131]
mat_Sqrt:  [[0.15]]
grads:  [-0.04344765]
Stock Position:  -0.043447645351024626
Bond Position:  [24.88261166]


portfolio before change:  [20.35792717]
curr_Stock_Price:  104.17687001584015
curr_Factors:  [104.17687002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05949802]
Stock Position:  -0.059498021742675655
Bond Position:  [26.55624485]


portfolio before change:  [20.33383624]
curr_Stock_Price:  104.60967011946254
curr_Factors:  [104.60967012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.33383624]
Stock Price:  104.57132860960503
PL:  [15.76250763]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.02637590e-03]
 [ 2.91161190e-03]
 [-4.43658150e-03]
 [ 3.34304157e-03]
 [ 9.71005649e-03]
 [ 2.77168575e-02]
 [ 1.76049763e-03]
 [-7.27493303e-03]
 [ 2.37641306e-02]
 [-4.57580779e-03]
 [ 2.90079908e-02]
 [-5.51195906e-02]
 [ 6.02948138e-02]
 [ 1.13977036e-02]
 [-6.90080205e-03]
 [ 2.83036427e-02]
 [ 1.36179879e-02]
 [-3.47052591e-03]
 [ 1.01608634e-02]
 [-8.14591977e-03]
 [ 1.48926300e-02]
 [-8.63922870e-03]
 [ 1.10883210e-02]
 [-5.21003360e-03]
 [ 3.91461762e-03]
 [ 1.03670136e-02]
 [-5.48538224e-03]
 [ 8.35678995e-03]
 [ 1.11161335e-02]
 [-2.75517081e-03]
 [ 9.70836175e-03]
 [-1.18701807e-02]
 [ 8.88368920e-03]
 [ 8.48017475e-03]
 [ 1.05139161e-02]
 [ 7.17456774e-03]
 [-3.30649828e-02]
 [ 8.97999400e-03]
 [ 1.04710195e-02]
 [ 6.39325873e-03]
 [-4.89779970e-03]
 [-1.34956565e-02]
 [ 2.01082110e-02]
 [-6.94347433e-03]
 [ 2.38914313e-02]
 [-4.78526979e-03]
 [ 1.55583223e-02]
 [ 3.22052446e-02]
 [ 1.04880501e-02]
 [-7.74857961e-03]
 [ 3.49301969e-02]
 [ 5.36042110e-03]
 [-1.00818552e-02]
 [ 5.80115096e-03]
 [-2.14198558e-02]
 [ 3.14497800e-02]
 [ 1.49858576e-02]
 [ 1.44089959e-03]
 [ 1.90989295e-03]
 [ 3.61101816e-03]
 [ 1.81809265e-02]
 [ 4.29321807e-02]
 [-1.70003535e-03]
 [-1.20365021e-02]
 [ 1.74130240e-02]
 [ 8.47417459e-03]
 [-4.99250662e-03]
 [ 1.55633608e-02]
 [-1.74159761e-02]
 [-3.73316790e-02]
 [-5.23244893e-03]
 [ 1.60991261e-02]
 [-3.69872590e-02]
 [ 2.87653876e-02]
 [-2.95028848e-02]
 [ 5.50699461e-03]
 [ 7.03207050e-03]
 [-1.73426342e-02]
 [ 2.13171067e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.64694639]
curr_Stock_Price:  100.10438909462844
curr_Factors:  [100.10438909]
mat_Sqrt:  [[0.15]]
grads:  [0.00684251]
Stock Position:  0.006842505997664491
Bond Position:  [2.96198151]


portfolio before change:  [3.64837399]
curr_Stock_Price:  100.28597013135335
curr_Factors:  [100.28597013]
mat_Sqrt:  [[0.15]]
grads:  [0.01941075]
Stock Position:  0.019410746010810595
Bond Position:  [1.70174849]


portfolio before change:  [3.66932709]
curr_Stock_Price:  101.359949233158
curr_Factors:  [101.35994923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957721]
Stock Position:  -0.029577210022590807
Bond Position:  [6.66727159]


portfolio before change:  [3.67342242]
curr_Stock_Price:  101.23557583570839
curr_Factors:  [101.23557584]
mat_Sqrt:  [[0.15]]
grads:  [0.02228694]
Stock Position:  0.022286943807048414
Bond Position:  [1.41719083]


portfolio before change:  [3.66605228]
curr_Stock_Price:  100.90090825013905
curr_Factors:  [100.90090825]
mat_Sqrt:  [[0.15]]
grads:  [0.06473371]
Stock Position:  0.0647337099127094
Bond Position:  [-2.86563784]


portfolio before change:  [3.67700981]
curr_Stock_Price:  101.0729459602849
curr_Factors:  [101.07294596]
mat_Sqrt:  [[0.15]]
grads:  [0.18477905]
Stock Position:  0.18477905005868614
Bond Position:  [-14.99915313]


portfolio before change:  [3.71263054]
curr_Stock_Price:  101.27079416778385
curr_Factors:  [101.27079417]
mat_Sqrt:  [[0.15]]
grads:  [0.01173665]
Stock Position:  0.0117366508616292
Bond Position:  [2.52405059]


portfolio before change:  [3.70977604]
curr_Stock_Price:  101.0141399373123
curr_Factors:  [101.01413994]
mat_Sqrt:  [[0.15]]
grads:  [-0.04849955]
Stock Position:  -0.04849955352874437
Bond Position:  [8.60891672]


portfolio before change:  [3.70991735]
curr_Stock_Price:  101.02232071512303
curr_Factors:  [101.02232072]
mat_Sqrt:  [[0.15]]
grads:  [0.15842754]
Stock Position:  0.1584275370645798
Bond Position:  [-12.29480011]


portfolio before change:  [3.81397804]
curr_Stock_Price:  101.68400581604978
curr_Factors:  [101.68400582]
mat_Sqrt:  [[0.15]]
grads:  [-0.03050539]
Stock Position:  -0.030505385245662205
Bond Position:  [6.91588781]


portfolio before change:  [3.81242221]
curr_Stock_Price:  101.7491775056229
curr_Factors:  [101.74917751]
mat_Sqrt:  [[0.15]]
grads:  [0.19338661]
Stock Position:  0.19338660535535987
Bond Position:  [-15.86450583]


portfolio before change:  [3.77783716]
curr_Stock_Price:  101.57546595096824
curr_Factors:  [101.57546595]
mat_Sqrt:  [[0.15]]
grads:  [-0.36746394]
Stock Position:  -0.3674639373876139
Bond Position:  [41.10315782]


portfolio before change:  [3.65947222]
curr_Stock_Price:  101.90457025480183
curr_Factors:  [101.90457025]
mat_Sqrt:  [[0.15]]
grads:  [0.40196543]
Stock Position:  0.40196542558354303
Bond Position:  [-37.30264173]


portfolio before change:  [3.90438989]
curr_Stock_Price:  102.51967081473637
curr_Factors:  [102.51967081]
mat_Sqrt:  [[0.15]]
grads:  [0.07598469]
Stock Position:  0.07598469051410331
Bond Position:  [-3.88553557]


portfolio before change:  [3.88846118]
curr_Stock_Price:  102.31323635015394
curr_Factors:  [102.31323635]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600535]
Stock Position:  -0.04600534697005867
Bond Position:  [8.59541712]


portfolio before change:  [3.86648829]
curr_Stock_Price:  102.80252992603432
curr_Factors:  [102.80252993]
mat_Sqrt:  [[0.15]]
grads:  [0.18869095]
Stock Position:  0.1886909510967759
Bond Position:  [-15.53141886]


portfolio before change:  [4.00655054]
curr_Stock_Price:  103.54995841395011
curr_Factors:  [103.54995841]
mat_Sqrt:  [[0.15]]
grads:  [0.09078659]
Stock Position:  0.09078658577776229
Bond Position:  [-5.39439664]


portfolio before change:  [4.00061725]
curr_Stock_Price:  103.48831790510397
curr_Factors:  [103.48831791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313684]
Stock Position:  -0.023136839418766063
Bond Position:  [6.39500984]


portfolio before change:  [3.99986994]
curr_Stock_Price:  103.53789296910777
curr_Factors:  [103.53789297]
mat_Sqrt:  [[0.15]]
grads:  [0.06773909]
Stock Position:  0.06773908912033173
Bond Position:  [-3.01369262]


portfolio before change:  [4.01316994]
curr_Stock_Price:  103.73701526279896
curr_Factors:  [103.73701526]
mat_Sqrt:  [[0.15]]
grads:  [-0.05430613]
Stock Position:  -0.05430613176718488
Bond Position:  [9.64672596]


portfolio before change:  [3.99580952]
curr_Stock_Price:  104.06779486376645
curr_Factors:  [104.06779486]
mat_Sqrt:  [[0.15]]
grads:  [0.0992842]
Stock Position:  0.09928420007151603
Bond Position:  [-6.33647825]


portfolio before change:  [3.87735356]
curr_Stock_Price:  102.87868412566166
curr_Factors:  [102.87868413]
mat_Sqrt:  [[0.15]]
grads:  [-0.05759486]
Stock Position:  -0.05759485802262874
Bond Position:  [9.80263677]


portfolio before change:  [3.90704201]
curr_Stock_Price:  102.37385151104769
curr_Factors:  [102.37385151]
mat_Sqrt:  [[0.15]]
grads:  [0.07392214]
Stock Position:  0.07392213993511065
Bond Position:  [-3.66065217]


portfolio before change:  [3.8939279]
curr_Stock_Price:  102.19954230707658
curr_Factors:  [102.19954231]
mat_Sqrt:  [[0.15]]
grads:  [-0.03473356]
Stock Position:  -0.03473355735033583
Bond Position:  [7.44368157]


portfolio before change:  [3.88565306]
curr_Stock_Price:  102.45117480989033
curr_Factors:  [102.45117481]
mat_Sqrt:  [[0.15]]
grads:  [0.02609745]
Stock Position:  0.02609745082334259
Bond Position:  [1.21193856]


portfolio before change:  [3.87116609]
curr_Stock_Price:  101.8931618264801
curr_Factors:  [101.89316183]
mat_Sqrt:  [[0.15]]
grads:  [0.06911342]
Stock Position:  0.06911342406294703
Bond Position:  [-3.17101921]


portfolio before change:  [3.85016137]
curr_Stock_Price:  101.5921128036316
curr_Factors:  [101.5921128]
mat_Sqrt:  [[0.15]]
grads:  [-0.03656921]
Stock Position:  -0.036569214903815914
Bond Position:  [7.56530517]


portfolio before change:  [3.85570306]
curr_Stock_Price:  101.45350299041574
curr_Factors:  [101.45350299]
mat_Sqrt:  [[0.15]]
grads:  [0.05571193]
Stock Position:  0.055711933027294824
Bond Position:  [-1.7964677]


portfolio before change:  [3.83012102]
curr_Stock_Price:  100.99633418611248
curr_Factors:  [100.99633419]
mat_Sqrt:  [[0.15]]
grads:  [0.07410756]
Stock Position:  0.07410755690752167
Bond Position:  [-3.65447056]


portfolio before change:  [3.82886172]
curr_Stock_Price:  100.98242341618565
curr_Factors:  [100.98242342]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836781]
Stock Position:  -0.018367805370692478
Bond Position:  [5.68368722]


portfolio before change:  [3.82365117]
curr_Stock_Price:  101.28544244072384
curr_Factors:  [101.28544244]
mat_Sqrt:  [[0.15]]
grads:  [0.06472241]
Stock Position:  0.06472241166505248
Bond Position:  [-2.73178694]


portfolio before change:  [3.84633512]
curr_Stock_Price:  101.63856119879404
curr_Factors:  [101.6385612]
mat_Sqrt:  [[0.15]]
grads:  [-0.07913454]
Stock Position:  -0.07913453813481806
Bond Position:  [11.88945572]


portfolio before change:  [3.86365185]
curr_Stock_Price:  101.42912525670809
curr_Factors:  [101.42912526]
mat_Sqrt:  [[0.15]]
grads:  [0.05922459]
Stock Position:  0.059224594636981265
Bond Position:  [-2.14344698]


portfolio before change:  [3.95606809]
curr_Stock_Price:  102.9918242038896
curr_Factors:  [102.9918242]
mat_Sqrt:  [[0.15]]
grads:  [0.0565345]
Stock Position:  0.05653449831953784
Bond Position:  [-1.86652302]


portfolio before change:  [3.96509887]
curr_Stock_Price:  103.15362697826225
curr_Factors:  [103.15362698]
mat_Sqrt:  [[0.15]]
grads:  [0.07009277]
Stock Position:  0.07009277395778375
Bond Position:  [-3.26522499]


portfolio before change:  [4.00308256]
curr_Stock_Price:  103.6984444774616
curr_Factors:  [103.69844448]
mat_Sqrt:  [[0.15]]
grads:  [0.04783045]
Stock Position:  0.04783045157045592
Bond Position:  [-0.95686087]


portfolio before change:  [3.96925533]
curr_Stock_Price:  102.99246280603526
curr_Factors:  [102.99246281]
mat_Sqrt:  [[0.15]]
grads:  [-0.22043322]
Stock Position:  -0.2204332184638285
Bond Position:  [26.67221538]


portfolio before change:  [3.89136304]
curr_Stock_Price:  103.35338553710253
curr_Factors:  [103.35338554]
mat_Sqrt:  [[0.15]]
grads:  [0.05986663]
Stock Position:  0.05986662664495989
Bond Position:  [-2.29605551]


portfolio before change:  [3.89946873]
curr_Stock_Price:  103.49117859484984
curr_Factors:  [103.49117859]
mat_Sqrt:  [[0.15]]
grads:  [0.0698068]
Stock Position:  0.0698067969406075
Bond Position:  [-3.32491895]


portfolio before change:  [3.93718651]
curr_Stock_Price:  104.03447230282363
curr_Factors:  [104.0344723]
mat_Sqrt:  [[0.15]]
grads:  [0.04262172]
Stock Position:  0.042621724890608004
Bond Position:  [-0.49694214]


portfolio before change:  [3.97157301]
curr_Stock_Price:  104.84198435929345
curr_Factors:  [104.84198436]
mat_Sqrt:  [[0.15]]
grads:  [-0.032652]
Stock Position:  -0.03265199797749918
Bond Position:  [7.39487327]


portfolio before change:  [3.9493286]
curr_Stock_Price:  105.53739675508518
curr_Factors:  [105.53739676]
mat_Sqrt:  [[0.15]]
grads:  [-0.08997104]
Stock Position:  -0.0899710431918899
Bond Position:  [13.44463828]


portfolio before change:  [3.95890298]
curr_Stock_Price:  105.44032041952401
curr_Factors:  [105.44032042]
mat_Sqrt:  [[0.15]]
grads:  [0.13405474]
Stock Position:  0.13405474028482517
Bond Position:  [-10.17587179]


portfolio before change:  [4.08082451]
curr_Stock_Price:  106.3545554966638
curr_Factors:  [106.3545555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04628983]
Stock Position:  -0.04628982889871248
Bond Position:  [9.00395869]


portfolio before change:  [4.0594594]
curr_Stock_Price:  106.82826374886461
curr_Factors:  [106.82826375]
mat_Sqrt:  [[0.15]]
grads:  [0.15927621]
Stock Position:  0.15927620898237818
Bond Position:  [-12.95574146]


portfolio before change:  [4.1011787]
curr_Stock_Price:  107.09527825334955
curr_Factors:  [107.09527825]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319018]
Stock Position:  -0.03190179859462669
Bond Position:  [7.5177107]


portfolio before change:  [4.08927779]
curr_Stock_Price:  107.48305519875767
curr_Factors:  [107.4830552]
mat_Sqrt:  [[0.15]]
grads:  [0.10372215]
Stock Position:  0.1037221486606469
Bond Position:  [-7.05909564]


portfolio before change:  [4.08788454]
curr_Stock_Price:  107.47387639315465
curr_Factors:  [107.47387639]
mat_Sqrt:  [[0.15]]
grads:  [0.21470163]
Stock Position:  0.21470163083844207
Bond Position:  [-18.986932]


portfolio before change:  [3.88052094]
curr_Stock_Price:  106.51358150125576
curr_Factors:  [106.5135815]
mat_Sqrt:  [[0.15]]
grads:  [0.06992033]
Stock Position:  0.06992033383271566
Bond Position:  [-3.56694424]


portfolio before change:  [3.89944398]
curr_Stock_Price:  106.78740716603785
curr_Factors:  [106.78740717]
mat_Sqrt:  [[0.15]]
grads:  [-0.0516572]
Stock Position:  -0.051657197385401296
Bond Position:  [9.41578215]


portfolio before change:  [3.91292439]
curr_Stock_Price:  106.53784055005404
curr_Factors:  [106.53784055]
mat_Sqrt:  [[0.15]]
grads:  [0.23286798]
Stock Position:  0.23286797966024403
Bond Position:  [-20.89632729]


portfolio before change:  [3.80340864]
curr_Stock_Price:  106.07315795968752
curr_Factors:  [106.07315796]
mat_Sqrt:  [[0.15]]
grads:  [0.03573614]
Stock Position:  0.03573614067708046
Bond Position:  [0.01276334]


portfolio before change:  [3.79101528]
curr_Stock_Price:  105.72633379017104
curr_Factors:  [105.72633379]
mat_Sqrt:  [[0.15]]
grads:  [-0.06721237]
Stock Position:  -0.0672123681158225
Bond Position:  [10.89713254]


portfolio before change:  [3.74017247]
curr_Stock_Price:  106.4929173957375
curr_Factors:  [106.4929174]
mat_Sqrt:  [[0.15]]
grads:  [0.03867434]
Stock Position:  0.038674339748559064
Bond Position:  [-0.3783708]


portfolio before change:  [3.75595097]
curr_Stock_Price:  106.90151254594852
curr_Factors:  [106.90151255]
mat_Sqrt:  [[0.15]]
grads:  [-0.14279904]
Stock Position:  -0.14279903889240972
Bond Position:  [19.02138422]


portfolio before change:  [3.75969281]
curr_Stock_Price:  106.88363449857081
curr_Factors:  [106.8836345]
mat_Sqrt:  [[0.15]]
grads:  [0.2096652]
Stock Position:  0.2096651996815041
Bond Position:  [-18.65008576]


portfolio before change:  [3.63520278]
curr_Stock_Price:  106.29543784898891
curr_Factors:  [106.29543785]
mat_Sqrt:  [[0.15]]
grads:  [0.09990572]
Stock Position:  0.09990571756471825
Bond Position:  [-6.98431922]


portfolio before change:  [3.60181001]
curr_Stock_Price:  105.96556449045744
curr_Factors:  [105.96556449]
mat_Sqrt:  [[0.15]]
grads:  [0.009606]
Stock Position:  0.009605997250226012
Bond Position:  [2.58390509]


portfolio before change:  [3.60063567]
curr_Stock_Price:  105.82650121220162
curr_Factors:  [105.82650121]
mat_Sqrt:  [[0.15]]
grads:  [0.01273262]
Stock Position:  0.012732619659180091
Bond Position:  [2.25318708]


portfolio before change:  [3.60713957]
curr_Stock_Price:  106.32624733057244
curr_Factors:  [106.32624733]
mat_Sqrt:  [[0.15]]
grads:  [0.02407345]
Stock Position:  0.024073454427938464
Bond Position:  [1.0474995]


portfolio before change:  [3.61659733]
curr_Stock_Price:  106.71639849460766
curr_Factors:  [106.71639849]
mat_Sqrt:  [[0.15]]
grads:  [0.12120618]
Stock Position:  0.12120617681278648
Bond Position:  [-9.31808934]


portfolio before change:  [3.58655548]
curr_Stock_Price:  106.47334611676611
curr_Factors:  [106.47334612]
mat_Sqrt:  [[0.15]]
grads:  [0.28621454]
Stock Position:  0.28621453821931925
Bond Position:  [-26.88766411]


portfolio before change:  [3.50639117]
curr_Stock_Price:  106.19913300689436
curr_Factors:  [106.19913301]
mat_Sqrt:  [[0.15]]
grads:  [-0.01133357]
Stock Position:  -0.011333568970633978
Bond Position:  [4.71000637]


portfolio before change:  [3.49998809]
curr_Stock_Price:  106.79007373798643
curr_Factors:  [106.79007374]
mat_Sqrt:  [[0.15]]
grads:  [-0.08024335]
Stock Position:  -0.08024334750460023
Bond Position:  [12.06918108]


portfolio before change:  [3.48994089]
curr_Stock_Price:  106.92468361051236
curr_Factors:  [106.92468361]
mat_Sqrt:  [[0.15]]
grads:  [0.11608683]
Stock Position:  0.11608682643897597
Bond Position:  [-8.9226063]


portfolio before change:  [3.48830557]
curr_Stock_Price:  106.91540061994971
curr_Factors:  [106.91540062]
mat_Sqrt:  [[0.15]]
grads:  [0.0564945]
Stock Position:  0.05649449724130895
Bond Position:  [-2.55182623]


portfolio before change:  [3.48565064]
curr_Stock_Price:  106.87122920937273
curr_Factors:  [106.87122921]
mat_Sqrt:  [[0.15]]
grads:  [-0.03328338]
Stock Position:  -0.033283377494453516
Bond Position:  [7.0426861]


portfolio before change:  [3.50387464]
curr_Stock_Price:  106.33691395430075
curr_Factors:  [106.33691395]
mat_Sqrt:  [[0.15]]
grads:  [0.10375574]
Stock Position:  0.10375573892829541
Bond Position:  [-7.52919045]


portfolio before change:  [3.57506914]
curr_Stock_Price:  107.02762361059455
curr_Factors:  [107.02762361]
mat_Sqrt:  [[0.15]]
grads:  [-0.11610651]
Stock Position:  -0.11610650751060769
Bond Position:  [16.00167272]


portfolio before change:  [3.5318809]
curr_Stock_Price:  107.4082084477185
curr_Factors:  [107.40820845]
mat_Sqrt:  [[0.15]]
grads:  [-0.24887786]
Stock Position:  -0.24887785988858385
Bond Position:  [30.26340595]


portfolio before change:  [3.48920404]
curr_Stock_Price:  107.5872857641258
curr_Factors:  [107.58728576]
mat_Sqrt:  [[0.15]]
grads:  [-0.03488299]
Stock Position:  -0.0348829928759757
Bond Position:  [7.24217056]


portfolio before change:  [3.4864725]
curr_Stock_Price:  107.67856769488768
curr_Factors:  [107.67856769]
mat_Sqrt:  [[0.15]]
grads:  [0.10732751]
Stock Position:  0.10732750737123355
Bond Position:  [-8.07039976]


portfolio before change:  [3.58101129]
curr_Stock_Price:  108.5641114377628
curr_Factors:  [108.56411144]
mat_Sqrt:  [[0.15]]
grads:  [-0.24658173]
Stock Position:  -0.24658172653538507
Bond Position:  [30.35093733]


portfolio before change:  [3.66635638]
curr_Stock_Price:  108.22569182230826
curr_Factors:  [108.22569182]
mat_Sqrt:  [[0.15]]
grads:  [0.19176925]
Stock Position:  0.19176925048681379
Bond Position:  [-17.08800343]


portfolio before change:  [3.52788949]
curr_Stock_Price:  107.50921171639492
curr_Factors:  [107.50921172]
mat_Sqrt:  [[0.15]]
grads:  [-0.1966859]
Stock Position:  -0.19668589874472717
Bond Position:  [24.67343542]


portfolio before change:  [3.55704539]
curr_Stock_Price:  107.36881646951052
curr_Factors:  [107.36881647]
mat_Sqrt:  [[0.15]]
grads:  [0.0367133]
Stock Position:  0.036713297404987216
Bond Position:  [-0.3848179]


portfolio before change:  [3.55148137]
curr_Stock_Price:  107.21791826074933
curr_Factors:  [107.21791826]
mat_Sqrt:  [[0.15]]
grads:  [0.04688047]
Stock Position:  0.046880469972200384
Bond Position:  [-1.47494503]


portfolio before change:  [3.58704743]
curr_Stock_Price:  107.97853885846932
curr_Factors:  [107.97853886]
mat_Sqrt:  [[0.15]]
grads:  [-0.11561756]
Stock Position:  -0.11561756154776712
Bond Position:  [16.0712628]


portfolio before change:  [3.66043257]
curr_Stock_Price:  107.35250375634936
curr_Factors:  [107.35250376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.66043257]
Stock Price:  107.70578890121925
PL:  [-4.04535633]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.18338541e-03]
 [ 3.03973850e-03]
 [-1.28321191e-03]
 [ 2.24251215e-03]
 [ 9.56373304e-03]
 [ 2.02926457e-02]
 [ 2.49412638e-03]
 [-2.46358767e-02]
 [-1.71663352e-02]
 [ 2.34990848e-02]
 [-2.77260813e-02]
 [ 2.52356991e-02]
 [-1.05615700e-02]
 [ 2.51065737e-04]
 [-7.08150686e-03]
 [ 1.09879916e-02]
 [ 1.52815203e-02]
 [ 3.39420657e-02]
 [ 8.46485640e-04]
 [ 1.63522951e-02]
 [ 1.33204087e-02]
 [-1.26009279e-02]
 [-3.16950661e-03]
 [-1.17518656e-01]
 [-1.35532247e-02]
 [-6.35968255e-04]
 [ 3.22287246e-03]
 [ 1.55314553e-02]
 [-7.70001100e-02]
 [ 8.97887393e-03]
 [ 2.46986671e-02]
 [-1.64753520e-02]
 [-5.60299758e-03]
 [ 9.20680066e-03]
 [ 1.39104100e-02]
 [-8.14995861e-03]
 [-2.69908860e-02]
 [ 7.02758021e-03]
 [-5.25752468e-02]
 [-1.85032461e-02]
 [-1.70989899e-02]
 [ 7.75751864e-02]
 [ 2.35976305e-02]
 [ 2.75680480e-03]
 [ 1.14776097e-02]
 [ 3.37148182e-02]
 [-2.79125905e-03]
 [-2.51036829e-03]
 [ 1.85342065e-02]
 [ 7.26527132e-03]
 [ 2.84493207e-02]
 [ 8.66580120e-03]
 [-7.27087232e-04]
 [ 4.38175069e-03]
 [ 4.31835109e-03]
 [ 4.47663970e-03]
 [-9.16127482e-03]
 [-5.26938612e-04]
 [ 1.54871209e-03]
 [-1.86777261e-03]
 [-1.23648646e-03]
 [ 3.90558722e-03]
 [ 9.30939382e-03]
 [-1.80638167e-02]
 [-1.01475255e-02]
 [-1.01292307e-02]
 [-4.72605399e-03]
 [ 1.12946821e-02]
 [-1.25210255e-02]
 [ 1.18122110e-02]
 [ 4.62232059e-03]
 [ 1.25006581e-02]
 [ 2.63761189e-03]
 [ 5.32190389e-03]
 [ 2.06880509e-02]
 [-2.11790730e-02]
 [ 4.82631546e-03]
 [ 8.48828303e-03]
 [ 3.78474316e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.84095563]
curr_Stock_Price:  99.09728890229975
curr_Factors:  [99.0972889]
mat_Sqrt:  [[0.15]]
grads:  [0.04788924]
Stock Position:  0.0478892360584585
Bond Position:  [-16.58664909]


portfolio before change:  [-11.78683734]
curr_Stock_Price:  100.24900889395785
curr_Factors:  [100.24900889]
mat_Sqrt:  [[0.15]]
grads:  [0.02026492]
Stock Position:  0.020264923330798212
Bond Position:  [-13.81837582]


portfolio before change:  [-11.78510874]
curr_Stock_Price:  100.37692823019151
curr_Factors:  [100.37692823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00855475]
Stock Position:  -0.008554746042088758
Bond Position:  [-10.92640961]


portfolio before change:  [-11.79503567]
curr_Stock_Price:  101.45749897232254
curr_Factors:  [101.45749897]
mat_Sqrt:  [[0.15]]
grads:  [0.01495008]
Stock Position:  0.014950080976619338
Bond Position:  [-13.3118335]


portfolio before change:  [-11.80431846]
curr_Stock_Price:  100.89223307864165
curr_Factors:  [100.89223308]
mat_Sqrt:  [[0.15]]
grads:  [0.06375822]
Stock Position:  0.06375822029557206
Bond Position:  [-18.23702768]


portfolio before change:  [-11.90212181]
curr_Stock_Price:  99.37613830192979
curr_Factors:  [99.3761383]
mat_Sqrt:  [[0.15]]
grads:  [0.1352843]
Stock Position:  0.13528430497343713
Bond Position:  [-25.34615361]


portfolio before change:  [-12.03087922]
curr_Stock_Price:  98.43609411562608
curr_Factors:  [98.43609412]
mat_Sqrt:  [[0.15]]
grads:  [0.01662751]
Stock Position:  0.01662750923315711
Bond Position:  [-13.66762628]


portfolio before change:  [-12.03754093]
curr_Stock_Price:  98.08682605365107
curr_Factors:  [98.08682605]
mat_Sqrt:  [[0.15]]
grads:  [-0.16423918]
Stock Position:  -0.16423917815601372
Bond Position:  [4.07215877]


portfolio before change:  [-11.99361988]
curr_Stock_Price:  97.82095447266089
curr_Factors:  [97.82095447]
mat_Sqrt:  [[0.15]]
grads:  [-0.11444223]
Stock Position:  -0.11444223448094536
Bond Position:  [-0.79877128]


portfolio before change:  [-12.07588951]
curr_Stock_Price:  98.53939294592278
curr_Factors:  [98.53939295]
mat_Sqrt:  [[0.15]]
grads:  [0.15666057]
Stock Position:  0.15666056534247233
Bond Position:  [-27.51312652]


portfolio before change:  [-12.15955702]
curr_Stock_Price:  98.01630095625289
curr_Factors:  [98.01630096]
mat_Sqrt:  [[0.15]]
grads:  [-0.18484054]
Stock Position:  -0.18484054201243036
Bond Position:  [5.95782917]


portfolio before change:  [-12.19660184]
curr_Stock_Price:  98.21873055216224
curr_Factors:  [98.21873055]
mat_Sqrt:  [[0.15]]
grads:  [0.16823799]
Stock Position:  0.16823799401357356
Bond Position:  [-28.72072405]


portfolio before change:  [-12.36873131]
curr_Stock_Price:  97.20626978492079
curr_Factors:  [97.20626978]
mat_Sqrt:  [[0.15]]
grads:  [-0.07041047]
Stock Position:  -0.07041046645515037
Bond Position:  [-5.52439252]


portfolio before change:  [-12.3492749]
curr_Stock_Price:  96.9250374497303
curr_Factors:  [96.92503745]
mat_Sqrt:  [[0.15]]
grads:  [0.00167377]
Stock Position:  0.0016737715794267957
Bond Position:  [-12.51150527]


portfolio before change:  [-12.35071615]
curr_Stock_Price:  96.53116493181619
curr_Factors:  [96.53116493]
mat_Sqrt:  [[0.15]]
grads:  [-0.04721005]
Stock Position:  -0.04721004572127598
Bond Position:  [-7.79347544]


portfolio before change:  [-12.37864307]
curr_Stock_Price:  97.11239321909292
curr_Factors:  [97.11239322]
mat_Sqrt:  [[0.15]]
grads:  [0.07325328]
Stock Position:  0.07325327710352568
Bond Position:  [-19.49244412]


portfolio before change:  [-12.43812151]
curr_Stock_Price:  96.31706872757255
curr_Factors:  [96.31706873]
mat_Sqrt:  [[0.15]]
grads:  [0.1018768]
Stock Position:  0.10187680203661417
Bond Position:  [-22.25059645]


portfolio before change:  [-12.51731171]
curr_Stock_Price:  95.55340620635607
curr_Factors:  [95.55340621]
mat_Sqrt:  [[0.15]]
grads:  [0.22628044]
Stock Position:  0.22628043796924302
Bond Position:  [-34.13917832]


portfolio before change:  [-12.48095439]
curr_Stock_Price:  95.72350966208398
curr_Factors:  [95.72350966]
mat_Sqrt:  [[0.15]]
grads:  [0.00564324]
Stock Position:  0.005643237597922476
Bond Position:  [-13.0211449]


portfolio before change:  [-12.4843039]
curr_Stock_Price:  95.27418135844457
curr_Factors:  [95.27418136]
mat_Sqrt:  [[0.15]]
grads:  [0.1090153]
Stock Position:  0.10901530070327874
Bond Position:  [-22.87064743]


portfolio before change:  [-12.53550529]
curr_Stock_Price:  94.81762225710274
curr_Factors:  [94.81762226]
mat_Sqrt:  [[0.15]]
grads:  [0.08880272]
Stock Position:  0.08880272436131889
Bond Position:  [-20.95556847]


portfolio before change:  [-12.53763064]
curr_Stock_Price:  94.80843805345071
curr_Factors:  [94.80843805]
mat_Sqrt:  [[0.15]]
grads:  [-0.08400619]
Stock Position:  -0.0840061861179885
Bond Position:  [-4.57313535]


portfolio before change:  [-12.54600373]
curr_Stock_Price:  94.90470787432783
curr_Factors:  [94.90470787]
mat_Sqrt:  [[0.15]]
grads:  [-0.02113004]
Stock Position:  -0.021130044047623447
Bond Position:  [-10.54066307]


portfolio before change:  [-12.54947676]
curr_Stock_Price:  95.0378936541084
curr_Factors:  [95.03789365]
mat_Sqrt:  [[0.15]]
grads:  [-0.78345771]
Stock Position:  -0.7834577096794818
Bond Position:  [61.90869373]


portfolio before change:  [-12.59843762]
curr_Stock_Price:  95.10532585076818
curr_Factors:  [95.10532585]
mat_Sqrt:  [[0.15]]
grads:  [-0.09035483]
Stock Position:  -0.09035483122540255
Bond Position:  [-4.00521196]


portfolio before change:  [-12.62835949]
curr_Stock_Price:  95.43371485393757
curr_Factors:  [95.43371485]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423979]
Stock Position:  -0.004239788366060734
Bond Position:  [-12.22374073]


portfolio before change:  [-12.6278388]
curr_Stock_Price:  95.13070504679669
curr_Factors:  [95.13070505]
mat_Sqrt:  [[0.15]]
grads:  [0.02148582]
Stock Position:  0.021485816409232528
Bond Position:  [-14.67179966]


portfolio before change:  [-12.6464545]
curr_Stock_Price:  94.30696692507651
curr_Factors:  [94.30696693]
mat_Sqrt:  [[0.15]]
grads:  [0.10354304]
Stock Position:  0.10354303563405247
Bond Position:  [-22.41128414]


portfolio before change:  [-12.60011074]
curr_Stock_Price:  94.76807479472446
curr_Factors:  [94.76807479]
mat_Sqrt:  [[0.15]]
grads:  [-0.51333407]
Stock Position:  -0.513334066760711
Bond Position:  [36.04757049]


portfolio before change:  [-12.0889808]
curr_Stock_Price:  93.77675758514096
curr_Factors:  [93.77675759]
mat_Sqrt:  [[0.15]]
grads:  [0.05985916]
Stock Position:  0.05985915951943204
Bond Position:  [-17.70237869]


portfolio before change:  [-12.1073708]
curr_Stock_Price:  93.48802049073797
curr_Factors:  [93.48802049]
mat_Sqrt:  [[0.15]]
grads:  [0.16465778]
Stock Position:  0.16465778074437412
Bond Position:  [-27.50090078]


portfolio before change:  [-12.17140065]
curr_Stock_Price:  93.10959324443006
curr_Factors:  [93.10959324]
mat_Sqrt:  [[0.15]]
grads:  [-0.10983568]
Stock Position:  -0.10983568006350165
Bond Position:  [-1.94464515]


portfolio before change:  [-12.14344006]
curr_Stock_Price:  92.85391919968377
curr_Factors:  [92.8539192]
mat_Sqrt:  [[0.15]]
grads:  [-0.03735332]
Stock Position:  -0.03735331718147112
Bond Position:  [-8.67503816]


portfolio before change:  [-12.14692672]
curr_Stock_Price:  92.93274630269164
curr_Factors:  [92.9327463]
mat_Sqrt:  [[0.15]]
grads:  [0.06137867]
Stock Position:  0.06137867106209653
Bond Position:  [-17.85101519]


portfolio before change:  [-12.12532459]
curr_Stock_Price:  93.3028723983312
curr_Factors:  [93.3028724]
mat_Sqrt:  [[0.15]]
grads:  [0.09273607]
Stock Position:  0.09273606652892062
Bond Position:  [-20.77786598]


portfolio before change:  [-12.16513816]
curr_Stock_Price:  92.88755490945617
curr_Factors:  [92.88755491]
mat_Sqrt:  [[0.15]]
grads:  [-0.05433306]
Stock Position:  -0.054333057400540466
Bond Position:  [-7.11827331]


portfolio before change:  [-12.18701264]
curr_Stock_Price:  93.28196620484627
curr_Factors:  [93.2819662]
mat_Sqrt:  [[0.15]]
grads:  [-0.17993924]
Stock Position:  -0.1799392401672578
Bond Position:  [4.59807348]


portfolio before change:  [-12.13999789]
curr_Stock_Price:  93.02228207908185
curr_Factors:  [93.02228208]
mat_Sqrt:  [[0.15]]
grads:  [0.04685053]
Stock Position:  0.04685053473184695
Bond Position:  [-16.49814154]


portfolio before change:  [-12.11877411]
curr_Stock_Price:  93.4973020106135
curr_Factors:  [93.49730201]
mat_Sqrt:  [[0.15]]
grads:  [-0.35050165]
Stock Position:  -0.35050164525830263
Bond Position:  [20.65218407]


portfolio before change:  [-11.94009894]
curr_Stock_Price:  92.99121488593296
curr_Factors:  [92.99121489]
mat_Sqrt:  [[0.15]]
grads:  [-0.12335497]
Stock Position:  -0.12335497402035134
Bond Position:  [-0.46917005]


portfolio before change:  [-11.92770525]
curr_Stock_Price:  92.8905053768191
curr_Factors:  [92.89050538]
mat_Sqrt:  [[0.15]]
grads:  [-0.11399327]
Stock Position:  -0.11399326571448233
Bond Position:  [-1.33881319]


portfolio before change:  [-11.92813974]
curr_Stock_Price:  92.89358286255091
curr_Factors:  [92.89358286]
mat_Sqrt:  [[0.15]]
grads:  [0.51716791]
Stock Position:  0.5171679095843656
Bond Position:  [-59.9697198]


portfolio before change:  [-11.68078043]
curr_Stock_Price:  93.37912639953468
curr_Factors:  [93.3791264]
mat_Sqrt:  [[0.15]]
grads:  [0.15731754]
Stock Position:  0.1573175369782255
Bond Position:  [-26.3709546]


portfolio before change:  [-11.64405411]
curr_Stock_Price:  93.62305695448852
curr_Factors:  [93.62305695]
mat_Sqrt:  [[0.15]]
grads:  [0.0183787]
Stock Position:  0.01837869868899213
Bond Position:  [-13.36472406]


portfolio before change:  [-11.63867521]
curr_Stock_Price:  93.96117761721003
curr_Factors:  [93.96117762]
mat_Sqrt:  [[0.15]]
grads:  [0.0765174]
Stock Position:  0.07651739785285734
Bond Position:  [-18.82834002]


portfolio before change:  [-11.67784415]
curr_Stock_Price:  93.46466137609175
curr_Factors:  [93.46466138]
mat_Sqrt:  [[0.15]]
grads:  [0.22476545]
Stock Position:  0.22476545447181895
Bond Position:  [-32.68547124]


portfolio before change:  [-11.44698681]
curr_Stock_Price:  94.50085374585957
curr_Factors:  [94.50085375]
mat_Sqrt:  [[0.15]]
grads:  [-0.01860839]
Stock Position:  -0.0186083936479374
Bond Position:  [-9.68847772]


portfolio before change:  [-11.44284547]
curr_Stock_Price:  94.24576004321914
curr_Factors:  [94.24576004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01673579]
Stock Position:  -0.016735788626061558
Bond Position:  [-9.86556835]


portfolio before change:  [-11.45203328]
curr_Stock_Price:  94.75790724091806
curr_Factors:  [94.75790724]
mat_Sqrt:  [[0.15]]
grads:  [0.12356138]
Stock Position:  0.12356137699519612
Bond Position:  [-23.16045078]


portfolio before change:  [-11.53301127]
curr_Stock_Price:  94.11425616465334
curr_Factors:  [94.11425616]
mat_Sqrt:  [[0.15]]
grads:  [0.04843514]
Stock Position:  0.04843514211816302
Bond Position:  [-16.09144864]


portfolio before change:  [-11.53965564]
curr_Stock_Price:  93.99784021516152
curr_Factors:  [93.99784022]
mat_Sqrt:  [[0.15]]
grads:  [0.18966214]
Stock Position:  0.18966213779696578
Bond Position:  [-29.36748696]


portfolio before change:  [-11.42048425]
curr_Stock_Price:  94.63585322108901
curr_Factors:  [94.63585322]
mat_Sqrt:  [[0.15]]
grads:  [0.05777201]
Stock Position:  0.057772007977466566
Bond Position:  [-16.88778752]


portfolio before change:  [-11.48544243]
curr_Stock_Price:  93.52973516280743
curr_Factors:  [93.52973516]
mat_Sqrt:  [[0.15]]
grads:  [-0.00484725]
Stock Position:  -0.004847248211716573
Bond Position:  [-11.03208059]


portfolio before change:  [-11.48667737]
curr_Stock_Price:  93.64225460476537
curr_Factors:  [93.6422546]
mat_Sqrt:  [[0.15]]
grads:  [0.02921167]
Stock Position:  0.02921167125785236
Bond Position:  [-14.22212412]


portfolio before change:  [-11.49119945]
curr_Stock_Price:  93.51788049045464
curr_Factors:  [93.51788049]
mat_Sqrt:  [[0.15]]
grads:  [0.02878901]
Stock Position:  0.02878900724759032
Bond Position:  [-14.18348639]


portfolio before change:  [-11.46359377]
curr_Stock_Price:  94.50757004972324
curr_Factors:  [94.50757005]
mat_Sqrt:  [[0.15]]
grads:  [0.02984426]
Stock Position:  0.02984426466280554
Bond Position:  [-14.2841027]


portfolio before change:  [-11.43207793]
curr_Stock_Price:  95.59349456414508
curr_Factors:  [95.59349456]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107517]
Stock Position:  -0.061075165489895764
Bond Position:  [-5.59368943]


portfolio before change:  [-11.50072546]
curr_Stock_Price:  96.71175438975092
curr_Factors:  [96.71175439]
mat_Sqrt:  [[0.15]]
grads:  [-0.00351292]
Stock Position:  -0.0035129240790950263
Bond Position:  [-11.1609844]


portfolio before change:  [-11.50105257]
curr_Stock_Price:  96.60629605360683
curr_Factors:  [96.60629605]
mat_Sqrt:  [[0.15]]
grads:  [0.01032475]
Stock Position:  0.010324747271444192
Bond Position:  [-12.49848816]


portfolio before change:  [-11.49019632]
curr_Stock_Price:  97.73343559069959
curr_Factors:  [97.73343559]
mat_Sqrt:  [[0.15]]
grads:  [-0.01245182]
Stock Position:  -0.012451817367157397
Bond Position:  [-10.27323743]


portfolio before change:  [-11.48953483]
curr_Stock_Price:  97.62874483331677
curr_Factors:  [97.62874483]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824324]
Stock Position:  -0.008243243084233878
Bond Position:  [-10.68475735]


portfolio before change:  [-11.49006263]
curr_Stock_Price:  97.61175895255292
curr_Factors:  [97.61175895]
mat_Sqrt:  [[0.15]]
grads:  [0.02603725]
Stock Position:  0.026037248111492318
Bond Position:  [-14.03160421]


portfolio before change:  [-11.48432722]
curr_Stock_Price:  97.86571869979015
curr_Factors:  [97.8657187]
mat_Sqrt:  [[0.15]]
grads:  [0.06206263]
Stock Position:  0.06206262545015703
Bond Position:  [-17.55813066]


portfolio before change:  [-11.47957091]
curr_Stock_Price:  97.96003829726064
curr_Factors:  [97.9600383]
mat_Sqrt:  [[0.15]]
grads:  [-0.12042544]
Stock Position:  -0.12042544475438205
Bond Position:  [0.31731027]


portfolio before change:  [-11.47093755]
curr_Stock_Price:  97.88851244161704
curr_Factors:  [97.88851244]
mat_Sqrt:  [[0.15]]
grads:  [-0.06765017]
Stock Position:  -0.06765017009995491
Bond Position:  [-4.84876303]


portfolio before change:  [-11.41661534]
curr_Stock_Price:  97.08104569906992
curr_Factors:  [97.0810457]
mat_Sqrt:  [[0.15]]
grads:  [-0.0675282]
Stock Position:  -0.06752820484443196
Bond Position:  [-4.8609066]


portfolio before change:  [-11.41385859]
curr_Stock_Price:  97.03572283491164
curr_Factors:  [97.03572283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150703]
Stock Position:  -0.03150702659827022
Bond Position:  [-8.35655149]


portfolio before change:  [-11.39632706]
curr_Stock_Price:  96.46271344375508
curr_Factors:  [96.46271344]
mat_Sqrt:  [[0.15]]
grads:  [0.07529788]
Stock Position:  0.07529788099973625
Bond Position:  [-18.65976498]


portfolio before change:  [-11.40854887]
curr_Stock_Price:  96.31588952238913
curr_Factors:  [96.31588952]
mat_Sqrt:  [[0.15]]
grads:  [-0.0834735]
Stock Position:  -0.08347350304132749
Bond Position:  [-3.36872417]


portfolio before change:  [-11.33343582]
curr_Stock_Price:  95.413524208378
curr_Factors:  [95.41352421]
mat_Sqrt:  [[0.15]]
grads:  [0.07874807]
Stock Position:  0.07874807328739433
Bond Position:  [-18.84706702]


portfolio before change:  [-11.36148653]
curr_Stock_Price:  95.07227491810221
curr_Factors:  [95.07227492]
mat_Sqrt:  [[0.15]]
grads:  [0.03081547]
Stock Position:  0.030815470567970873
Bond Position:  [-14.29118342]


portfolio before change:  [-11.38928631]
curr_Stock_Price:  94.19912396412455
curr_Factors:  [94.19912396]
mat_Sqrt:  [[0.15]]
grads:  [0.08333772]
Stock Position:  0.08333772040028495
Bond Position:  [-19.23962657]


portfolio before change:  [-11.48042905]
curr_Stock_Price:  93.1198980414489
curr_Factors:  [93.11989804]
mat_Sqrt:  [[0.15]]
grads:  [0.01758408]
Stock Position:  0.017584079251275177
Bond Position:  [-13.11785672]


portfolio before change:  [-11.48425413]
curr_Stock_Price:  92.94899414316575
curr_Factors:  [92.94899414]
mat_Sqrt:  [[0.15]]
grads:  [0.03547936]
Stock Position:  0.03547935929535771
Bond Position:  [-14.78202489]


portfolio before change:  [-11.48230621]
curr_Stock_Price:  93.02993772289196
curr_Factors:  [93.02993772]
mat_Sqrt:  [[0.15]]
grads:  [0.13792034]
Stock Position:  0.13792033923595443
Bond Position:  [-24.31302678]


portfolio before change:  [-11.38502001]
curr_Stock_Price:  93.74633539731599
curr_Factors:  [93.7463354]
mat_Sqrt:  [[0.15]]
grads:  [-0.14119382]
Stock Position:  -0.14119381995924335
Bond Position:  [1.85138319]


portfolio before change:  [-11.3706948]
curr_Stock_Price:  93.64569716637816
curr_Factors:  [93.64569717]
mat_Sqrt:  [[0.15]]
grads:  [0.03217544]
Stock Position:  0.03217543640570777
Bond Position:  [-14.38378598]


portfolio before change:  [-11.37487228]
curr_Stock_Price:  93.54380374200893
curr_Factors:  [93.54380374]
mat_Sqrt:  [[0.15]]
grads:  [0.05658855]
Stock Position:  0.056588553557765216
Bond Position:  [-16.66838083]


portfolio before change:  [-11.39071731]
curr_Stock_Price:  93.28220992114797
curr_Factors:  [93.28220992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.39071731]
Stock Price:  93.97576357573523
PL:  [-11.39071731]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.47716167e-04]
 [ 1.29287338e-04]
 [-4.26689259e-03]
 [ 1.98899374e-03]
 [ 3.72125131e-02]
 [ 2.69688597e-02]
 [ 3.45868483e-03]
 [ 1.50158044e-02]
 [ 2.45609250e-02]
 [-4.59613771e-03]
 [ 1.59128511e-02]
 [-5.47538101e-02]
 [ 6.07874462e-02]
 [ 4.57997013e-03]
 [-6.90890254e-03]
 [ 2.18038665e-02]
 [ 1.05537937e-02]
 [-1.13373281e-02]
 [-3.53128196e-04]
 [-2.22558241e-03]
 [ 1.25422202e-02]
 [-3.90989449e-03]
 [ 1.10621550e-02]
 [-4.28268664e-02]
 [ 8.84664656e-03]
 [ 6.62112823e-03]
 [-5.12960716e-03]
 [ 1.26862387e-02]
 [ 4.65757270e-02]
 [ 3.08097677e-03]
 [ 1.43003603e-02]
 [-1.22104549e-02]
 [ 7.39112763e-03]
 [ 8.38903994e-03]
 [ 1.08252683e-02]
 [ 8.52697335e-03]
 [-3.32435221e-02]
 [ 9.60749901e-03]
 [ 3.77345311e-03]
 [ 1.66280380e-02]
 [-6.55047435e-03]
 [-1.08621695e-02]
 [ 2.36311164e-02]
 [ 4.11881333e-03]
 [-7.81760107e-03]
 [-5.31062133e-03]
 [ 4.51240569e-03]
 [-1.24821886e-02]
 [-1.49039709e-02]
 [-6.86109899e-03]
 [ 2.32477126e-02]
 [-7.49289123e-03]
 [-4.38117617e-04]
 [ 5.28658223e-03]
 [ 2.07717296e-03]
 [-1.11180901e-03]
 [ 8.65816196e-03]
 [-4.95803178e-04]
 [ 1.61404334e-03]
 [-4.04886791e-03]
 [ 9.00849938e-04]
 [-2.61086015e-03]
 [-3.46366090e-03]
 [-1.26213516e-02]
 [-5.84049082e-03]
 [-1.36959196e-04]
 [-5.40649662e-03]
 [ 2.11575531e-02]
 [-8.19842822e-03]
 [ 7.89302283e-03]
 [-1.04405567e-02]
 [ 1.10481942e-02]
 [-8.32920672e-03]
 [ 1.80475508e-02]
 [-2.24812277e-02]
 [-4.32649336e-03]
 [-8.46579997e-03]
 [-1.50623979e-03]
 [ 1.99299232e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.45367764]
curr_Stock_Price:  100.48197155528804
curr_Factors:  [100.48197156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00231811]
Stock Position:  -0.0023181077781541867
Bond Position:  [9.68660568]


portfolio before change:  [9.45313545]
curr_Stock_Price:  100.9770372845194
curr_Factors:  [100.97703728]
mat_Sqrt:  [[0.15]]
grads:  [0.00086192]
Stock Position:  0.0008619155873879041
Bond Position:  [9.36610177]


portfolio before change:  [9.45424808]
curr_Stock_Price:  101.58873073484314
curr_Factors:  [101.58873073]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844595]
Stock Position:  -0.02844595062120444
Bond Position:  [12.3440361]


portfolio before change:  [9.45742977]
curr_Stock_Price:  101.50400282142088
curr_Factors:  [101.50400282]
mat_Sqrt:  [[0.15]]
grads:  [0.01325996]
Stock Position:  0.01325995824352913
Bond Position:  [8.11149093]


portfolio before change:  [9.46955072]
curr_Stock_Price:  102.37986984273522
curr_Factors:  [102.37986984]
mat_Sqrt:  [[0.15]]
grads:  [0.24808342]
Stock Position:  0.24808342075546122
Bond Position:  [-15.92919761]


portfolio before change:  [9.37437205]
curr_Stock_Price:  102.00022713438473
curr_Factors:  [102.00022713]
mat_Sqrt:  [[0.15]]
grads:  [0.1797924]
Stock Position:  0.17979239805380545
Bond Position:  [-8.96449339]


portfolio before change:  [9.38636981]
curr_Stock_Price:  102.07007467306298
curr_Factors:  [102.07007467]
mat_Sqrt:  [[0.15]]
grads:  [0.0230579]
Stock Position:  0.023057898894016035
Bond Position:  [7.03284835]


portfolio before change:  [9.39801337]
curr_Stock_Price:  102.5559819379788
curr_Factors:  [102.55598194]
mat_Sqrt:  [[0.15]]
grads:  [0.10010536]
Stock Position:  0.10010536251837786
Bond Position:  [-0.86839038]


portfolio before change:  [9.38661824]
curr_Stock_Price:  102.44269274023668
curr_Factors:  [102.44269274]
mat_Sqrt:  [[0.15]]
grads:  [0.1637395]
Stock Position:  0.16373949987336406
Bond Position:  [-7.38729703]


portfolio before change:  [9.28003906]
curr_Stock_Price:  101.79460560867345
curr_Factors:  [101.79460561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03064092]
Stock Position:  -0.03064091805636348
Bond Position:  [12.39911923]


portfolio before change:  [9.31103678]
curr_Stock_Price:  100.8082528132312
curr_Factors:  [100.80825281]
mat_Sqrt:  [[0.15]]
grads:  [0.10608567]
Stock Position:  0.10608567374177022
Bond Position:  [-1.38327464]


portfolio before change:  [9.40625697]
curr_Stock_Price:  101.70664601810681
curr_Factors:  [101.70664602]
mat_Sqrt:  [[0.15]]
grads:  [-0.3650254]
Stock Position:  -0.3650254009340718
Bond Position:  [46.53176621]


portfolio before change:  [9.33231939]
curr_Stock_Price:  101.91716810425405
curr_Factors:  [101.9171681]
mat_Sqrt:  [[0.15]]
grads:  [0.40524964]
Stock Position:  0.4052496411105251
Bond Position:  [-31.96957641]


portfolio before change:  [9.17580113]
curr_Stock_Price:  101.535872031883
curr_Factors:  [101.53587203]
mat_Sqrt:  [[0.15]]
grads:  [0.03053313]
Stock Position:  0.030533134229835356
Bond Position:  [6.07559272]


portfolio before change:  [9.1584108]
curr_Stock_Price:  100.95387908263685
curr_Factors:  [100.95387908]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605935]
Stock Position:  -0.04605935023336695
Bond Position:  [13.80828088]


portfolio before change:  [9.13460247]
curr_Stock_Price:  101.48952230897837
curr_Factors:  [101.48952231]
mat_Sqrt:  [[0.15]]
grads:  [0.14535911]
Stock Position:  0.14535911018493905
Bond Position:  [-5.61782419]


portfolio before change:  [9.07274795]
curr_Stock_Price:  101.06640890919061
curr_Factors:  [101.06640891]
mat_Sqrt:  [[0.15]]
grads:  [0.07035862]
Stock Position:  0.07035862457144422
Bond Position:  [1.96185443]


portfolio before change:  [9.08891921]
curr_Stock_Price:  101.29450655301292
curr_Factors:  [101.29450655]
mat_Sqrt:  [[0.15]]
grads:  [-0.07558219]
Stock Position:  -0.07558218700326322
Bond Position:  [16.74497955]


portfolio before change:  [9.14929782]
curr_Stock_Price:  100.50950663355128
curr_Factors:  [100.50950663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235419]
Stock Position:  -0.0023541879754307555
Bond Position:  [9.38591609]


portfolio before change:  [9.14833709]
curr_Stock_Price:  101.1667878899073
curr_Factors:  [101.16678789]
mat_Sqrt:  [[0.15]]
grads:  [-0.01483722]
Stock Position:  -0.014837216083714733
Bond Position:  [10.64937058]


portfolio before change:  [9.14824567]
curr_Stock_Price:  101.21780983261608
curr_Factors:  [101.21780983]
mat_Sqrt:  [[0.15]]
grads:  [0.0836148]
Stock Position:  0.08361480120484459
Bond Position:  [0.68493863]


portfolio before change:  [9.19565471]
curr_Stock_Price:  101.78429115549395
curr_Factors:  [101.78429116]
mat_Sqrt:  [[0.15]]
grads:  [-0.02606596]
Stock Position:  -0.026065963268595845
Bond Position:  [11.8487603]


portfolio before change:  [9.16123139]
curr_Stock_Price:  103.13332588966347
curr_Factors:  [103.13332589]
mat_Sqrt:  [[0.15]]
grads:  [0.0737477]
Stock Position:  0.07374770005968008
Bond Position:  [1.5553858]


portfolio before change:  [9.20054785]
curr_Stock_Price:  103.665128867332
curr_Factors:  [103.66512887]
mat_Sqrt:  [[0.15]]
grads:  [-0.28551244]
Stock Position:  -0.2855124426230976
Bond Position:  [38.79823201]


portfolio before change:  [9.08645908]
curr_Stock_Price:  104.07321521350666
curr_Factors:  [104.07321521]
mat_Sqrt:  [[0.15]]
grads:  [0.05897764]
Stock Position:  0.05897764371360093
Bond Position:  [2.94846608]


portfolio before change:  [9.08309408]
curr_Stock_Price:  104.01303494732738
curr_Factors:  [104.01303495]
mat_Sqrt:  [[0.15]]
grads:  [0.04414085]
Stock Position:  0.04414085484471832
Bond Position:  [4.4918698]


portfolio before change:  [9.04922825]
curr_Stock_Price:  103.23945284450461
curr_Factors:  [103.23945284]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419738]
Stock Position:  -0.03419738105025462
Bond Position:  [12.57974716]


portfolio before change:  [9.05451577]
curr_Stock_Price:  103.10782702266215
curr_Factors:  [103.10782702]
mat_Sqrt:  [[0.15]]
grads:  [0.08457492]
Stock Position:  0.0845749247537547
Bond Position:  [0.33417906]


portfolio before change:  [9.07556891]
curr_Stock_Price:  103.35650886852328
curr_Factors:  [103.35650887]
mat_Sqrt:  [[0.15]]
grads:  [0.31050485]
Stock Position:  0.31050484653085003
Bond Position:  [-23.01712802]


portfolio before change:  [9.02521293]
curr_Stock_Price:  103.19896750763364
curr_Factors:  [103.19896751]
mat_Sqrt:  [[0.15]]
grads:  [0.02053985]
Stock Position:  0.020539845145402306
Bond Position:  [6.90552212]


portfolio before change:  [9.00860908]
curr_Stock_Price:  102.36958122076179
curr_Factors:  [102.36958122]
mat_Sqrt:  [[0.15]]
grads:  [0.09533574]
Stock Position:  0.09533573551488163
Bond Position:  [-0.75087024]


portfolio before change:  [8.98381712]
curr_Stock_Price:  102.11002454143583
curr_Factors:  [102.11002454]
mat_Sqrt:  [[0.15]]
grads:  [-0.08140303]
Stock Position:  -0.08140303237048528
Bond Position:  [17.29588275]


portfolio before change:  [9.00817959]
curr_Stock_Price:  101.82402237024597
curr_Factors:  [101.82402237]
mat_Sqrt:  [[0.15]]
grads:  [0.04927418]
Stock Position:  0.049274184172542666
Bond Position:  [3.99088396]


portfolio before change:  [9.017175]
curr_Stock_Price:  102.00151842803362
curr_Factors:  [102.00151843]
mat_Sqrt:  [[0.15]]
grads:  [0.05592693]
Stock Position:  0.055926932930410934
Bond Position:  [3.31254292]


portfolio before change:  [9.03425905]
curr_Stock_Price:  102.30328732051207
curr_Factors:  [102.30328732]
mat_Sqrt:  [[0.15]]
grads:  [0.07216846]
Stock Position:  0.07216845544605685
Bond Position:  [1.65118882]


portfolio before change:  [9.03948279]
curr_Stock_Price:  102.37423984260333
curr_Factors:  [102.37423984]
mat_Sqrt:  [[0.15]]
grads:  [0.05684649]
Stock Position:  0.056846489019923334
Bond Position:  [3.21986669]


portfolio before change:  [9.05494427]
curr_Stock_Price:  102.64268617800907
curr_Factors:  [102.64268618]
mat_Sqrt:  [[0.15]]
grads:  [-0.22162348]
Stock Position:  -0.22162348064649712
Bond Position:  [31.80297364]


portfolio before change:  [9.30217717]
curr_Stock_Price:  101.53610145650138
curr_Factors:  [101.53610146]
mat_Sqrt:  [[0.15]]
grads:  [0.06404999]
Stock Position:  0.06404999342383375
Bond Position:  [2.79879054]


portfolio before change:  [9.30546671]
curr_Stock_Price:  101.58472926014575
curr_Factors:  [101.58472926]
mat_Sqrt:  [[0.15]]
grads:  [0.02515635]
Stock Position:  0.025156354040518615
Bond Position:  [6.7499653]


portfolio before change:  [9.28593495]
curr_Stock_Price:  100.79154392307088
curr_Factors:  [100.79154392]
mat_Sqrt:  [[0.15]]
grads:  [0.11085359]
Stock Position:  0.1108535864688353
Bond Position:  [-1.88716918]


portfolio before change:  [9.2046763]
curr_Stock_Price:  100.05958121603824
curr_Factors:  [100.05958122]
mat_Sqrt:  [[0.15]]
grads:  [-0.04366983]
Stock Position:  -0.043669828982149723
Bond Position:  [13.5742611]


portfolio before change:  [9.20769172]
curr_Stock_Price:  100.00995884575792
curr_Factors:  [100.00995885]
mat_Sqrt:  [[0.15]]
grads:  [-0.07241446]
Stock Position:  -0.07241446351869785
Bond Position:  [16.44985924]


portfolio before change:  [9.21332785]
curr_Stock_Price:  99.94632544599479
curr_Factors:  [99.94632545]
mat_Sqrt:  [[0.15]]
grads:  [0.15754078]
Stock Position:  0.1575407757561209
Bond Position:  [-6.5322938]


portfolio before change:  [9.13908327]
curr_Stock_Price:  99.47764487239438
curr_Factors:  [99.47764487]
mat_Sqrt:  [[0.15]]
grads:  [0.02745876]
Stock Position:  0.027458755554475047
Bond Position:  [6.40755093]


portfolio before change:  [9.1294994]
curr_Stock_Price:  99.11403220274002
curr_Factors:  [99.1140322]
mat_Sqrt:  [[0.15]]
grads:  [-0.05211734]
Stock Position:  -0.052117340465761185
Bond Position:  [14.29505916]


portfolio before change:  [9.11669228]
curr_Stock_Price:  99.37691192239576
curr_Factors:  [99.37691192]
mat_Sqrt:  [[0.15]]
grads:  [-0.03540414]
Stock Position:  -0.0354041421997805
Bond Position:  [12.6350466]


portfolio before change:  [9.10371253]
curr_Stock_Price:  99.76583418213448
curr_Factors:  [99.76583418]
mat_Sqrt:  [[0.15]]
grads:  [0.0300827]
Stock Position:  0.030082704607775845
Bond Position:  [6.10248641]


portfolio before change:  [9.09841203]
curr_Stock_Price:  99.57695738074871
curr_Factors:  [99.57695738]
mat_Sqrt:  [[0.15]]
grads:  [-0.08321459]
Stock Position:  -0.08321459034578013
Bond Position:  [17.38466774]


portfolio before change:  [9.0712975]
curr_Stock_Price:  99.91585354117693
curr_Factors:  [99.91585354]
mat_Sqrt:  [[0.15]]
grads:  [-0.09935981]
Stock Position:  -0.09935980615618573
Bond Position:  [18.99891734]


portfolio before change:  [9.06005674]
curr_Stock_Price:  100.0409365608697
curr_Factors:  [100.04093656]
mat_Sqrt:  [[0.15]]
grads:  [-0.04574066]
Stock Position:  -0.04574065991019456
Bond Position:  [13.6359952]


portfolio before change:  [9.02267669]
curr_Stock_Price:  100.876786593722
curr_Factors:  [100.87678659]
mat_Sqrt:  [[0.15]]
grads:  [0.15498475]
Stock Position:  0.15498475036228276
Bond Position:  [-6.6116869]


portfolio before change:  [9.01645084]
curr_Stock_Price:  100.83928224889246
curr_Factors:  [100.83928225]
mat_Sqrt:  [[0.15]]
grads:  [-0.04995261]
Stock Position:  -0.0499526082214017
Bond Position:  [14.053636]


portfolio before change:  [9.01315956]
curr_Stock_Price:  100.92275466145597
curr_Factors:  [100.92275466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00292078]
Stock Position:  -0.0029207841105562994
Bond Position:  [9.30793313]


portfolio before change:  [9.01370873]
curr_Stock_Price:  100.93391169966176
curr_Factors:  [100.9339117]
mat_Sqrt:  [[0.15]]
grads:  [0.03524388]
Stock Position:  0.035243881524831606
Bond Position:  [5.45640591]


portfolio before change:  [9.04293444]
curr_Stock_Price:  101.75347724268653
curr_Factors:  [101.75347724]
mat_Sqrt:  [[0.15]]
grads:  [0.01384782]
Stock Position:  0.013847819751563087
Bond Position:  [7.63387063]


portfolio before change:  [9.04065567]
curr_Stock_Price:  101.55446393486957
curr_Factors:  [101.55446393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00741206]
Stock Position:  -0.00741206003927746
Bond Position:  [9.79338345]


portfolio before change:  [9.03928292]
curr_Stock_Price:  101.82225071944912
curr_Factors:  [101.82225072]
mat_Sqrt:  [[0.15]]
grads:  [0.05772108]
Stock Position:  0.05772107972895205
Bond Position:  [3.16199267]


portfolio before change:  [8.99905636]
curr_Stock_Price:  101.12191400262387
curr_Factors:  [101.121914]
mat_Sqrt:  [[0.15]]
grads:  [-0.00330535]
Stock Position:  -0.003305354518277669
Bond Position:  [9.33330014]


portfolio before change:  [8.9978491]
curr_Stock_Price:  101.66364552942797
curr_Factors:  [101.66364553]
mat_Sqrt:  [[0.15]]
grads:  [0.01076029]
Stock Position:  0.010760288940046474
Bond Position:  [7.9039189]


portfolio before change:  [8.98338963]
curr_Stock_Price:  100.2739542784331
curr_Factors:  [100.27395428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02699245]
Stock Position:  -0.026992452751485645
Bond Position:  [11.6900296]


portfolio before change:  [8.97736637]
curr_Stock_Price:  100.52416896614545
curr_Factors:  [100.52416897]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [8.37365176]


portfolio before change:  [8.98437817]
curr_Stock_Price:  101.60455334989524
curr_Factors:  [101.60455335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01740573]
Stock Position:  -0.01740573435478475
Bond Position:  [10.75288003]


portfolio before change:  [8.98113587]
curr_Stock_Price:  101.82944348763917
curr_Factors:  [101.82944349]
mat_Sqrt:  [[0.15]]
grads:  [-0.02309107]
Stock Position:  -0.02309107265108263
Bond Position:  [11.33248694]


portfolio before change:  [8.98394331]
curr_Stock_Price:  101.7385363989503
curr_Factors:  [101.7385364]
mat_Sqrt:  [[0.15]]
grads:  [-0.08414234]
Stock Position:  -0.08414234369479714
Bond Position:  [17.54446221]


portfolio before change:  [9.03969727]
curr_Stock_Price:  101.08895387893924
curr_Factors:  [101.08895388]
mat_Sqrt:  [[0.15]]
grads:  [-0.03893661]
Stock Position:  -0.0389366054926743
Bond Position:  [12.97575799]


portfolio before change:  [9.0428077]
curr_Stock_Price:  101.02989848570033
curr_Factors:  [101.02989849]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091306]
Stock Position:  -0.0009130613091935571
Bond Position:  [9.13505419]


portfolio before change:  [9.04392259]
curr_Stock_Price:  100.43417715684205
curr_Factors:  [100.43417716]
mat_Sqrt:  [[0.15]]
grads:  [-0.03604331]
Stock Position:  -0.036043310807012986
Bond Position:  [12.66390285]


portfolio before change:  [9.03185394]
curr_Stock_Price:  100.79097482400383
curr_Factors:  [100.79097482]
mat_Sqrt:  [[0.15]]
grads:  [0.14105035]
Stock Position:  0.14105035368450705
Bond Position:  [-5.18474871]


portfolio before change:  [8.99649805]
curr_Stock_Price:  100.54261083173954
curr_Factors:  [100.54261083]
mat_Sqrt:  [[0.15]]
grads:  [-0.05465619]
Stock Position:  -0.05465618814115662
Bond Position:  [14.4917739]


portfolio before change:  [9.00989905]
curr_Stock_Price:  100.3139956108179
curr_Factors:  [100.31399561]
mat_Sqrt:  [[0.15]]
grads:  [0.05262015]
Stock Position:  0.0526201522156239
Bond Position:  [3.73136133]


portfolio before change:  [9.0131021]
curr_Stock_Price:  100.37043468542564
curr_Factors:  [100.37043469]
mat_Sqrt:  [[0.15]]
grads:  [-0.06960371]
Stock Position:  -0.06960371105044452
Bond Position:  [15.99925683]


portfolio before change:  [8.97641917]
curr_Stock_Price:  100.9118269486914
curr_Factors:  [100.91182695]
mat_Sqrt:  [[0.15]]
grads:  [0.07365463]
Stock Position:  0.07365462796477344
Bond Position:  [1.5437961]


portfolio before change:  [8.9734781]
curr_Stock_Price:  100.87058631263008
curr_Factors:  [100.87058631]
mat_Sqrt:  [[0.15]]
grads:  [-0.05552804]
Stock Position:  -0.05552804483113998
Bond Position:  [14.57462454]


portfolio before change:  [8.95511207]
curr_Stock_Price:  101.2177436758067
curr_Factors:  [101.21774368]
mat_Sqrt:  [[0.15]]
grads:  [0.12031701]
Stock Position:  0.12031700561628214
Bond Position:  [-3.22310376]


portfolio before change:  [9.0025348]
curr_Stock_Price:  101.61356613352324
curr_Factors:  [101.61356613]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987485]
Stock Position:  -0.14987485134672895
Bond Position:  [24.23185292]


portfolio before change:  [9.10812408]
curr_Stock_Price:  100.91915510370778
curr_Factors:  [100.9191551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02884329]
Stock Position:  -0.028843289087635123
Bond Position:  [12.01896445]


portfolio before change:  [9.11511107]
curr_Stock_Price:  100.70296019459977
curr_Factors:  [100.70296019]
mat_Sqrt:  [[0.15]]
grads:  [-0.05643867]
Stock Position:  -0.05643866648822306
Bond Position:  [14.79865185]


portfolio before change:  [9.08592657]
curr_Stock_Price:  101.23644977605265
curr_Factors:  [101.23644978]
mat_Sqrt:  [[0.15]]
grads:  [-0.0100416]
Stock Position:  -0.010041598577511407
Bond Position:  [10.10250236]


portfolio before change:  [9.08164734]
curr_Stock_Price:  101.72548056682585
curr_Factors:  [101.72548057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.08164734]
Stock Price:  101.61835155734555
PL:  [7.46329579]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.66379160e-03]
 [ 2.80438669e-03]
 [ 3.02759150e-04]
 [ 5.45174741e-03]
 [ 8.50149904e-03]
 [ 2.75369387e-02]
 [ 1.73952503e-03]
 [ 1.27828064e-03]
 [ 2.38655592e-02]
 [-3.76273965e-03]
 [ 1.74160027e-02]
 [-1.71082915e-02]
 [ 1.65072308e-02]
 [ 1.84272236e-03]
 [-6.89899664e-03]
 [ 1.82342284e-02]
 [ 9.24107610e-03]
 [-1.14968943e-02]
 [-5.26293626e-04]
 [ 2.52404823e-03]
 [ 1.15280318e-02]
 [-6.15001894e-03]
 [ 7.26565253e-03]
 [ 2.10360107e-02]
 [-8.10010867e-03]
 [-9.89084168e-03]
 [-2.70979965e-03]
 [ 9.21404153e-03]
 [-2.79186185e-02]
 [ 2.22950463e-03]
 [-1.67197200e-03]
 [-1.03757518e-02]
 [-6.28989272e-03]
 [ 4.71520688e-03]
 [ 1.25531620e-02]
 [ 1.74404136e-02]
 [-3.42239313e-02]
 [ 8.77763514e-03]
 [-2.44558812e-02]
 [ 1.93126467e-02]
 [-1.06278101e-02]
 [ 3.18780092e-02]
 [ 2.30900783e-02]
 [ 4.14405424e-03]
 [ 2.37986743e-03]
 [ 8.54359260e-04]
 [ 1.57836924e-03]
 [-1.22149529e-02]
 [-8.94910614e-03]
 [-4.56630861e-03]
 [ 4.21886010e-02]
 [-6.38532729e-03]
 [ 2.39454981e-03]
 [ 5.07371840e-03]
 [ 5.30301348e-03]
 [-2.25304112e-03]
 [ 7.26781958e-03]
 [-3.95177422e-04]
 [ 1.54019027e-03]
 [-1.51401590e-03]
 [ 9.24031011e-04]
 [-1.24212454e-02]
 [-8.38896686e-03]
 [-1.26177538e-02]
 [-6.41889363e-03]
 [-2.15896834e-04]
 [-5.52946085e-03]
 [ 1.97623214e-02]
 [-8.21733351e-03]
 [ 1.04948700e-02]
 [-1.14237537e-02]
 [ 1.18210875e-02]
 [-2.19600750e-03]
 [ 1.88773525e-02]
 [-2.24817371e-02]
 [-2.63928190e-03]
 [-1.01533023e-02]
 [-1.59821887e-03]
 [ 1.42460263e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.25477994]
curr_Stock_Price:  99.59057966503356
curr_Factors:  [99.59057967]
mat_Sqrt:  [[0.15]]
grads:  [0.02442528]
Stock Position:  0.024425277300660693
Bond Position:  [-6.68730746]


portfolio before change:  [-4.24372726]
curr_Stock_Price:  100.0602015412168
curr_Factors:  [100.06020154]
mat_Sqrt:  [[0.15]]
grads:  [0.01869591]
Stock Position:  0.018695911257898108
Bond Position:  [-6.11444391]


portfolio before change:  [-4.24779669]
curr_Stock_Price:  99.86297884798905
curr_Factors:  [99.86297885]
mat_Sqrt:  [[0.15]]
grads:  [0.00201839]
Stock Position:  0.0020183943302932187
Bond Position:  [-4.44935956]


portfolio before change:  [-4.24631742]
curr_Stock_Price:  100.73365313178068
curr_Factors:  [100.73365313]
mat_Sqrt:  [[0.15]]
grads:  [0.03634498]
Stock Position:  0.036344982700326024
Bond Position:  [-7.9074803]


portfolio before change:  [-4.24333697]
curr_Stock_Price:  100.82925573177602
curr_Factors:  [100.82925573]
mat_Sqrt:  [[0.15]]
grads:  [0.05667666]
Stock Position:  0.05667666023642926
Bond Position:  [-9.95800244]


portfolio before change:  [-4.22550455]
curr_Stock_Price:  101.15487160368848
curr_Factors:  [101.1548716]
mat_Sqrt:  [[0.15]]
grads:  [0.18357959]
Stock Position:  0.18357959105034502
Bond Position:  [-22.79547451]


portfolio before change:  [-4.20741816]
curr_Stock_Price:  101.26115331785682
curr_Factors:  [101.26115332]
mat_Sqrt:  [[0.15]]
grads:  [0.01159683]
Stock Position:  0.011596833538254567
Bond Position:  [-5.3817269]


portfolio before change:  [-4.20600594]
curr_Stock_Price:  101.41193470996184
curr_Factors:  [101.41193471]
mat_Sqrt:  [[0.15]]
grads:  [0.00852187]
Stock Position:  0.008521870963949796
Bond Position:  [-5.07022536]


portfolio before change:  [-4.21518598]
curr_Stock_Price:  100.37188780499042
curr_Factors:  [100.3718878]
mat_Sqrt:  [[0.15]]
grads:  [0.15910373]
Stock Position:  0.15910372814173393
Bond Position:  [-20.18472753]


portfolio before change:  [-4.20548607]
curr_Stock_Price:  100.44078308755822
curr_Factors:  [100.44078309]
mat_Sqrt:  [[0.15]]
grads:  [-0.02508493]
Stock Position:  -0.025084930973734237
Bond Position:  [-1.68593596]


portfolio before change:  [-4.21915013]
curr_Stock_Price:  100.98129411761934
curr_Factors:  [100.98129412]
mat_Sqrt:  [[0.15]]
grads:  [0.11610668]
Stock Position:  0.11610668454600978
Bond Position:  [-15.94375339]


portfolio before change:  [-4.28360176]
curr_Stock_Price:  100.43476985855483
curr_Factors:  [100.43476986]
mat_Sqrt:  [[0.15]]
grads:  [-0.11405528]
Stock Position:  -0.11405527642074624
Bond Position:  [7.17151368]


portfolio before change:  [-4.31659354]
curr_Stock_Price:  100.72796109920117
curr_Factors:  [100.7279611]
mat_Sqrt:  [[0.15]]
grads:  [0.11004821]
Stock Position:  0.1100482056373541
Bond Position:  [-15.40152491]


portfolio before change:  [-4.30139531]
curr_Stock_Price:  100.87481355893102
curr_Factors:  [100.87481356]
mat_Sqrt:  [[0.15]]
grads:  [0.01228482]
Stock Position:  0.012284815713863131
Bond Position:  [-5.54062381]


portfolio before change:  [-4.28920309]
curr_Stock_Price:  101.89546568151736
curr_Factors:  [101.89546568]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599331]
Stock Position:  -0.04599331093900058
Bond Position:  [0.39730675]


portfolio before change:  [-4.24064947]
curr_Stock_Price:  100.84033864353998
curr_Factors:  [100.84033864]
mat_Sqrt:  [[0.15]]
grads:  [0.12156152]
Stock Position:  0.12156152298919067
Bond Position:  [-16.49895462]


portfolio before change:  [-4.27593876]
curr_Stock_Price:  100.55852191929512
curr_Factors:  [100.55852192]
mat_Sqrt:  [[0.15]]
grads:  [0.06160717]
Stock Position:  0.06160717400298897
Bond Position:  [-10.47106512]


portfolio before change:  [-4.26306063]
curr_Stock_Price:  100.77818121298118
curr_Factors:  [100.77818121]
mat_Sqrt:  [[0.15]]
grads:  [-0.07664596]
Stock Position:  -0.07664596225353186
Bond Position:  [3.46118004]


portfolio before change:  [-4.28826195]
curr_Stock_Price:  101.1098052767138
curr_Factors:  [101.10980528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00350862]
Stock Position:  -0.0035086241766245133
Bond Position:  [-3.93350564]


portfolio before change:  [-4.28751915]
curr_Stock_Price:  100.82802957119655
curr_Factors:  [100.82802957]
mat_Sqrt:  [[0.15]]
grads:  [0.01682699]
Stock Position:  0.016826988233235116
Bond Position:  [-5.98415122]


portfolio before change:  [-4.29896521]
curr_Stock_Price:  100.17003713885545
curr_Factors:  [100.17003714]
mat_Sqrt:  [[0.15]]
grads:  [0.07685355]
Stock Position:  0.07685354502059112
Bond Position:  [-11.99738766]


portfolio before change:  [-4.25610353]
curr_Stock_Price:  100.73750008479722
curr_Factors:  [100.73750008]
mat_Sqrt:  [[0.15]]
grads:  [-0.04100013]
Stock Position:  -0.04100012624319828
Bond Position:  [-0.12585331]


portfolio before change:  [-4.20854745]
curr_Stock_Price:  99.57740742790766
curr_Factors:  [99.57740743]
mat_Sqrt:  [[0.15]]
grads:  [0.04843768]
Stock Position:  0.04843768351156532
Bond Position:  [-9.03184639]


portfolio before change:  [-4.23783855]
curr_Stock_Price:  98.98434457037015
curr_Factors:  [98.98434457]
mat_Sqrt:  [[0.15]]
grads:  [0.14024007]
Stock Position:  0.1402400710547631
Bond Position:  [-18.11941006]


portfolio before change:  [-4.32344913]
curr_Stock_Price:  98.38196266702394
curr_Factors:  [98.38196267]
mat_Sqrt:  [[0.15]]
grads:  [-0.05400072]
Stock Position:  -0.05400072448869626
Bond Position:  [0.98924813]


portfolio before change:  [-4.30925861]
curr_Stock_Price:  98.12032379379151
curr_Factors:  [98.12032379]
mat_Sqrt:  [[0.15]]
grads:  [-0.06593894]
Stock Position:  -0.06593894454460635
Bond Position:  [2.16069198]


portfolio before change:  [-4.28703863]
curr_Stock_Price:  97.78539378864393
curr_Factors:  [97.78539379]
mat_Sqrt:  [[0.15]]
grads:  [-0.01806533]
Stock Position:  -0.01806533100312591
Bond Position:  [-2.52051312]


portfolio before change:  [-4.28078399]
curr_Stock_Price:  97.43045022534719
curr_Factors:  [97.43045023]
mat_Sqrt:  [[0.15]]
grads:  [0.06142694]
Stock Position:  0.061426943560235855
Bond Position:  [-10.26563876]


portfolio before change:  [-4.28528061]
curr_Stock_Price:  97.36769282536847
curr_Factors:  [97.36769283]
mat_Sqrt:  [[0.15]]
grads:  [-0.18612412]
Stock Position:  -0.18612412365828157
Bond Position:  [13.83719589]


portfolio before change:  [-4.27557242]
curr_Stock_Price:  97.32017971894734
curr_Factors:  [97.32017972]
mat_Sqrt:  [[0.15]]
grads:  [0.01486336]
Stock Position:  0.014863364216459962
Bond Position:  [-5.7220777]


portfolio before change:  [-4.26384552]
curr_Stock_Price:  98.1332217740196
curr_Factors:  [98.13322177]
mat_Sqrt:  [[0.15]]
grads:  [-0.01114648]
Stock Position:  -0.011146480018056334
Bond Position:  [-3.17000553]


portfolio before change:  [-4.27690831]
curr_Stock_Price:  99.28736715559565
curr_Factors:  [99.28736716]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917168]
Stock Position:  -0.06917167899663554
Bond Position:  [2.59096557]


portfolio before change:  [-4.24178973]
curr_Stock_Price:  98.78200647965421
curr_Factors:  [98.78200648]
mat_Sqrt:  [[0.15]]
grads:  [-0.04193262]
Stock Position:  -0.04193261813514793
Bond Position:  [-0.09960157]


portfolio before change:  [-4.23053954]
curr_Stock_Price:  98.51356604226662
curr_Factors:  [98.51356604]
mat_Sqrt:  [[0.15]]
grads:  [0.03143471]
Stock Position:  0.0314347125240794
Bond Position:  [-7.32728517]


portfolio before change:  [-4.22510539]
curr_Stock_Price:  98.70100603150671
curr_Factors:  [98.70100603]
mat_Sqrt:  [[0.15]]
grads:  [0.08368775]
Stock Position:  0.08368774669169796
Bond Position:  [-12.48517018]


portfolio before change:  [-4.26141224]
curr_Stock_Price:  98.2764933783366
curr_Factors:  [98.27649338]
mat_Sqrt:  [[0.15]]
grads:  [0.11626942]
Stock Position:  0.11626942381160087
Bond Position:  [-15.6879635]


portfolio before change:  [-4.36428319]
curr_Stock_Price:  97.40016306613924
curr_Factors:  [97.40016307]
mat_Sqrt:  [[0.15]]
grads:  [-0.22815954]
Stock Position:  -0.2281595422512571
Bond Position:  [17.85849343]


portfolio before change:  [-4.46634694]
curr_Stock_Price:  97.85239022490016
curr_Factors:  [97.85239022]
mat_Sqrt:  [[0.15]]
grads:  [0.05851757]
Stock Position:  0.05851756758652196
Bond Position:  [-10.1924308]


portfolio before change:  [-4.48260402]
curr_Stock_Price:  97.58546139176015
curr_Factors:  [97.58546139]
mat_Sqrt:  [[0.15]]
grads:  [-0.16303921]
Stock Position:  -0.1630392079545903
Bond Position:  [11.42765232]


portfolio before change:  [-4.51653526]
curr_Stock_Price:  97.79795931065875
curr_Factors:  [97.79795931]
mat_Sqrt:  [[0.15]]
grads:  [0.12875098]
Stock Position:  0.12875097778870287
Bond Position:  [-17.10811815]


portfolio before change:  [-4.62141903]
curr_Stock_Price:  96.99163934975407
curr_Factors:  [96.99163935]
mat_Sqrt:  [[0.15]]
grads:  [-0.07085207]
Stock Position:  -0.07085206761075659
Bond Position:  [2.25063916]


portfolio before change:  [-4.61778455]
curr_Stock_Price:  96.94232791037543
curr_Factors:  [96.94232791]
mat_Sqrt:  [[0.15]]
grads:  [0.21252006]
Stock Position:  0.21252006151280534
Bond Position:  [-25.21997404]


portfolio before change:  [-4.5429461]
curr_Stock_Price:  97.30189275958003
curr_Factors:  [97.30189276]
mat_Sqrt:  [[0.15]]
grads:  [0.15393386]
Stock Position:  0.15393385505233165
Bond Position:  [-19.52100156]


portfolio before change:  [-4.61458857]
curr_Stock_Price:  96.84440817002039
curr_Factors:  [96.84440817]
mat_Sqrt:  [[0.15]]
grads:  [0.02762703]
Stock Position:  0.027627028251818373
Bond Position:  [-7.29011177]


portfolio before change:  [-4.60061443]
curr_Stock_Price:  97.36671477083421
curr_Factors:  [97.36671477]
mat_Sqrt:  [[0.15]]
grads:  [0.01586578]
Stock Position:  0.015865782858022037
Bond Position:  [-6.14541359]


portfolio before change:  [-4.59783371]
curr_Stock_Price:  97.56618946268327
curr_Factors:  [97.56618946]
mat_Sqrt:  [[0.15]]
grads:  [0.00569573]
Stock Position:  0.005695728402748956
Bond Position:  [-5.15354423]


portfolio before change:  [-4.59637906]
curr_Stock_Price:  97.87813496231004
curr_Factors:  [97.87813496]
mat_Sqrt:  [[0.15]]
grads:  [0.01052246]
Stock Position:  0.010522461630057604
Bond Position:  [-5.62629798]


portfolio before change:  [-4.59580316]
curr_Stock_Price:  97.96628504876932
curr_Factors:  [97.96628505]
mat_Sqrt:  [[0.15]]
grads:  [-0.08143302]
Stock Position:  -0.08143301957776056
Bond Position:  [3.38188725]


portfolio before change:  [-4.64089086]
curr_Stock_Price:  98.52255903161115
curr_Factors:  [98.52255903]
mat_Sqrt:  [[0.15]]
grads:  [-0.05966071]
Stock Position:  -0.05966070761415784
Bond Position:  [1.23703473]


portfolio before change:  [-4.64661066]
curr_Stock_Price:  98.6197272414708
curr_Factors:  [98.61972724]
mat_Sqrt:  [[0.15]]
grads:  [-0.03044206]
Stock Position:  -0.030442057380869598
Bond Position:  [-1.64442327]


portfolio before change:  [-4.60318912]
curr_Stock_Price:  97.18998411766131
curr_Factors:  [97.18998412]
mat_Sqrt:  [[0.15]]
grads:  [0.28125734]
Stock Position:  0.281257340269565
Bond Position:  [-31.93858556]


portfolio before change:  [-4.60999386]
curr_Stock_Price:  97.1728876346309
curr_Factors:  [97.17288763]
mat_Sqrt:  [[0.15]]
grads:  [-0.04256885]
Stock Position:  -0.042568848622120396
Bond Position:  [-0.47345591]


portfolio before change:  [-4.60715469]
curr_Stock_Price:  97.10549662958374
curr_Factors:  [97.10549663]
mat_Sqrt:  [[0.15]]
grads:  [0.01596367]
Stock Position:  0.015963665387122867
Bond Position:  [-6.15731435]


portfolio before change:  [-4.60384944]
curr_Stock_Price:  97.33665220611677
curr_Factors:  [97.33665221]
mat_Sqrt:  [[0.15]]
grads:  [0.03382479]
Stock Position:  0.03382478930465647
Bond Position:  [-7.8962412]


portfolio before change:  [-4.5755162]
curr_Stock_Price:  98.18889024209278
curr_Factors:  [98.18889024]
mat_Sqrt:  [[0.15]]
grads:  [0.03535342]
Stock Position:  0.03535342317062115
Bond Position:  [-8.04682959]


portfolio before change:  [-4.58169865]
curr_Stock_Price:  98.02824104582561
curr_Factors:  [98.02824105]
mat_Sqrt:  [[0.15]]
grads:  [-0.01502027]
Stock Position:  -0.015020274115065969
Bond Position:  [-3.10928759]


portfolio before change:  [-4.580896]
curr_Stock_Price:  97.96186548155663
curr_Factors:  [97.96186548]
mat_Sqrt:  [[0.15]]
grads:  [0.04845213]
Stock Position:  0.04845213053000823
Bond Position:  [-9.3273571]


portfolio before change:  [-4.55531689]
curr_Stock_Price:  98.50182287615834
curr_Factors:  [98.50182288]
mat_Sqrt:  [[0.15]]
grads:  [-0.00263452]
Stock Position:  -0.002634516148871128
Bond Position:  [-4.29581225]


portfolio before change:  [-4.55584016]
curr_Stock_Price:  98.59852812883175
curr_Factors:  [98.59852813]
mat_Sqrt:  [[0.15]]
grads:  [0.01026794]
Stock Position:  0.01026793516446005
Bond Position:  [-5.56824346]


portfolio before change:  [-4.55001372]
curr_Stock_Price:  99.19986329487224
curr_Factors:  [99.19986329]
mat_Sqrt:  [[0.15]]
grads:  [-0.01009344]
Stock Position:  -0.010093439331589626
Bond Position:  [-3.54874592]


portfolio before change:  [-4.55390887]
curr_Stock_Price:  99.56379735204554
curr_Factors:  [99.56379735]
mat_Sqrt:  [[0.15]]
grads:  [0.00616021]
Stock Position:  0.006160206742436408
Bond Position:  [-5.16724244]


portfolio before change:  [-4.55147001]
curr_Stock_Price:  100.01212929623088
curr_Factors:  [100.0121293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0828083]
Stock Position:  -0.08280830247956672
Bond Position:  [3.73036464]


portfolio before change:  [-4.59915213]
curr_Stock_Price:  100.59075817198773
curr_Factors:  [100.59075817]
mat_Sqrt:  [[0.15]]
grads:  [-0.05592645]
Stock Position:  -0.05592644575431807
Bond Position:  [1.02653145]


portfolio before change:  [-4.66355175]
curr_Stock_Price:  101.74341105751417
curr_Factors:  [101.74341106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08411836]
Stock Position:  -0.08411835887000024
Bond Position:  [3.89493701]


portfolio before change:  [-4.59387904]
curr_Stock_Price:  100.91803516081933
curr_Factors:  [100.91803516]
mat_Sqrt:  [[0.15]]
grads:  [-0.04279262]
Stock Position:  -0.042792624184567106
Bond Position:  [-0.27533149]


portfolio before change:  [-4.6220801]
curr_Stock_Price:  101.57664966614688
curr_Factors:  [101.57664967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143931]
Stock Position:  -0.0014393122255065376
Bond Position:  [-4.47587958]


portfolio before change:  [-4.62208464]
curr_Stock_Price:  101.3854404951486
curr_Factors:  [101.3854405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03686307]
Stock Position:  -0.03686307236513732
Bond Position:  [-0.88470581]


portfolio before change:  [-4.60970039]
curr_Stock_Price:  101.04798784661483
curr_Factors:  [101.04798785]
mat_Sqrt:  [[0.15]]
grads:  [0.13174881]
Stock Position:  0.13174880936326427
Bond Position:  [-17.92265248]


portfolio before change:  [-4.60808004]
curr_Stock_Price:  101.06878919278165
curr_Factors:  [101.06878919]
mat_Sqrt:  [[0.15]]
grads:  [-0.05478222]
Stock Position:  -0.054782223426208754
Bond Position:  [0.92869295]


portfolio before change:  [-4.63837248]
curr_Stock_Price:  101.62280988474942
curr_Factors:  [101.62280988]
mat_Sqrt:  [[0.15]]
grads:  [0.0699658]
Stock Position:  0.06996580029240529
Bond Position:  [-11.7484937]


portfolio before change:  [-4.6163151]
curr_Stock_Price:  101.94856451977309
curr_Factors:  [101.94856452]
mat_Sqrt:  [[0.15]]
grads:  [-0.07615836]
Stock Position:  -0.07615835797129827
Bond Position:  [3.14792017]


portfolio before change:  [-4.62489325]
curr_Stock_Price:  102.0637837162378
curr_Factors:  [102.06378372]
mat_Sqrt:  [[0.15]]
grads:  [0.07880725]
Stock Position:  0.07880725008356278
Bond Position:  [-12.66825938]


portfolio before change:  [-4.64721407]
curr_Stock_Price:  101.79059786477526
curr_Factors:  [101.79059786]
mat_Sqrt:  [[0.15]]
grads:  [-0.01464005]
Stock Position:  -0.014640050003097638
Bond Position:  [-3.15699463]


portfolio before change:  [-4.64514066]
curr_Stock_Price:  101.63549393510883
curr_Factors:  [101.63549394]
mat_Sqrt:  [[0.15]]
grads:  [0.12584902]
Stock Position:  0.1258490167405951
Bond Position:  [-17.43586764]


portfolio before change:  [-4.65505818]
curr_Stock_Price:  101.56534845478026
curr_Factors:  [101.56534845]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987825]
Stock Position:  -0.14987824765552343
Bond Position:  [10.56737827]


portfolio before change:  [-4.6996118]
curr_Stock_Price:  101.86702071308952
curr_Factors:  [101.86702071]
mat_Sqrt:  [[0.15]]
grads:  [-0.01759521]
Stock Position:  -0.017595212633455988
Bond Position:  [-2.90723991]


portfolio before change:  [-4.69141303]
curr_Stock_Price:  101.39072753534849
curr_Factors:  [101.39072754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06768868]
Stock Position:  -0.06768868225345097
Bond Position:  [2.17159171]


portfolio before change:  [-4.70420451]
curr_Stock_Price:  101.58170788022264
curr_Factors:  [101.58170788]
mat_Sqrt:  [[0.15]]
grads:  [-0.01065479]
Stock Position:  -0.010654792498350728
Bond Position:  [-3.62187249]


portfolio before change:  [-4.70127693]
curr_Stock_Price:  101.28569490132946
curr_Factors:  [101.2856949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.70127693]
Stock Price:  100.6985367268057
PL:  [-5.39981366]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.89580882e-03]
 [ 2.69650454e-03]
 [-4.54947891e-03]
 [ 3.57109968e-03]
 [ 2.48825424e-02]
 [ 2.69346803e-02]
 [ 4.12757959e-03]
 [ 1.49924570e-02]
 [ 2.46483919e-02]
 [-3.71198931e-03]
 [ 5.76841187e-02]
 [ 1.05486943e-01]
 [ 1.18170735e-01]
 [ 2.11171573e-02]
 [-6.89133061e-03]
 [ 4.22546542e-02]
 [ 2.12339264e-02]
 [ 3.34229865e-02]
 [ 3.17832113e-02]
 [-1.26831640e-02]
 [ 1.65382756e-02]
 [-3.16241256e-02]
 [ 7.83789504e-03]
 [-1.42496177e-01]
 [ 1.83442363e-02]
 [ 3.34887396e-03]
 [-1.58611195e-03]
 [ 3.34096342e-02]
 [ 9.69423766e-02]
 [ 1.83678024e-02]
 [ 2.70666259e-02]
 [ 2.01495710e-02]
 [-7.97078962e-03]
 [ 6.15816458e-03]
 [ 9.42638918e-03]
 [ 3.64045387e-03]
 [-3.09180168e-02]
 [ 8.24492135e-03]
 [ 2.38663926e-02]
 [-1.73361523e-02]
 [-8.20666550e-03]
 [-1.07416124e-02]
 [ 1.96853936e-02]
 [-7.29108883e-03]
 [ 1.86280200e-02]
 [-5.71682475e-03]
 [ 1.55073987e-02]
 [ 2.90034004e-02]
 [ 9.89838689e-03]
 [-7.75738902e-03]
 [ 5.23071677e-02]
 [ 9.67271409e-03]
 [-1.05126022e-02]
 [ 5.79340743e-03]
 [-2.57155822e-02]
 [ 3.80537465e-02]
 [ 1.82537293e-02]
 [ 2.57042569e-03]
 [ 2.19537484e-03]
 [-9.79809798e-03]
 [ 2.74914449e-02]
 [ 6.41782225e-02]
 [-9.96425760e-03]
 [-1.12619643e-02]
 [ 2.26866952e-02]
 [ 1.32903616e-02]
 [-3.29961449e-03]
 [ 1.62426810e-02]
 [-3.46379635e-02]
 [-8.35601500e-02]
 [ 6.47489416e-03]
 [ 1.84250166e-02]
 [-6.55649263e-02]
 [ 3.06777858e-02]
 [-3.12726777e-02]
 [ 1.20444048e-02]
 [ 1.87555173e-02]
 [-2.38393283e-02]
 [ 2.07541346e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.09892434]
curr_Stock_Price:  99.53568920982
curr_Factors:  [99.53568921]
mat_Sqrt:  [[0.15]]
grads:  [0.02597206]
Stock Position:  0.025972058799883055
Bond Position:  [-7.68407112]


portfolio before change:  [-5.07768545]
curr_Stock_Price:  100.37194032807996
curr_Factors:  [100.37194033]
mat_Sqrt:  [[0.15]]
grads:  [0.0179767]
Stock Position:  0.01797669691564418
Bond Position:  [-6.8820414]


portfolio before change:  [-5.06619007]
curr_Stock_Price:  101.03532789625858
curr_Factors:  [101.0353279]
mat_Sqrt:  [[0.15]]
grads:  [-0.03032986]
Stock Position:  -0.030329859390353157
Bond Position:  [-2.00180278]


portfolio before change:  [-5.07072541]
curr_Stock_Price:  101.18073630251767
curr_Factors:  [101.1807363]
mat_Sqrt:  [[0.15]]
grads:  [0.02380733]
Stock Position:  0.023807331207551345
Bond Position:  [-7.47956871]


portfolio before change:  [-5.05835095]
curr_Stock_Price:  101.72014753560735
curr_Factors:  [101.72014754]
mat_Sqrt:  [[0.15]]
grads:  [0.16588362]
Stock Position:  0.16588361616208766
Bond Position:  [-21.93205686]


portfolio before change:  [-5.00471775]
curr_Stock_Price:  102.05172938423692
curr_Factors:  [102.05172938]
mat_Sqrt:  [[0.15]]
grads:  [0.17956454]
Stock Position:  0.17956453533077593
Bond Position:  [-23.32958912]


portfolio before change:  [-4.92962999]
curr_Stock_Price:  102.47801569011112
curr_Factors:  [102.47801569]
mat_Sqrt:  [[0.15]]
grads:  [0.0275172]
Stock Position:  0.027517197299705056
Bond Position:  [-7.74953777]


portfolio before change:  [-4.92805991]
curr_Stock_Price:  102.55267601775529
curr_Factors:  [102.55267602]
mat_Sqrt:  [[0.15]]
grads:  [0.09994971]
Stock Position:  0.09994971334099367
Bond Position:  [-15.17817048]


portfolio before change:  [-4.99425748]
curr_Stock_Price:  101.89985876493084
curr_Factors:  [101.89985876]
mat_Sqrt:  [[0.15]]
grads:  [0.16432261]
Stock Position:  0.16432261259617928
Bond Position:  [-21.73870849]


portfolio before change:  [-4.84350287]
curr_Stock_Price:  102.82555802590778
curr_Factors:  [102.82555803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247466]
Stock Position:  -0.024746595419060363
Bond Position:  [-2.29892038]


portfolio before change:  [-4.86432795]
curr_Stock_Price:  103.6612848558392
curr_Factors:  [103.66128486]
mat_Sqrt:  [[0.15]]
grads:  [0.38456079]
Stock Position:  0.38456079163992596
Bond Position:  [-44.72839371]


portfolio before change:  [-4.76360507]
curr_Stock_Price:  103.93047113841874
curr_Factors:  [103.93047114]
mat_Sqrt:  [[0.15]]
grads:  [0.70324629]
Stock Position:  0.7032462885730864
Bond Position:  [-77.85232317]


portfolio before change:  [-5.1523505]
curr_Stock_Price:  103.38460333410256
curr_Factors:  [103.38460333]
mat_Sqrt:  [[0.15]]
grads:  [0.7878049]
Stock Position:  0.7878049006402528
Bond Position:  [-86.59924766]


portfolio before change:  [-4.54669324]
curr_Stock_Price:  104.16026476573788
curr_Factors:  [104.16026477]
mat_Sqrt:  [[0.15]]
grads:  [0.14078105]
Stock Position:  0.14078104885625692
Bond Position:  [-19.21048457]


portfolio before change:  [-4.4265149]
curr_Stock_Price:  105.0224478192869
curr_Factors:  [105.02244782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0459422]
Stock Position:  -0.04594220404374927
Bond Position:  [0.39844782]


portfolio before change:  [-4.47600501]
curr_Stock_Price:  106.10021523100643
curr_Factors:  [106.10021523]
mat_Sqrt:  [[0.15]]
grads:  [0.28169769]
Stock Position:  0.2816976947437696
Bond Position:  [-34.36419105]


portfolio before change:  [-4.27730992]
curr_Stock_Price:  106.81318847836604
curr_Factors:  [106.81318848]
mat_Sqrt:  [[0.15]]
grads:  [0.14155951]
Stock Position:  0.14155950965716435
Bond Position:  [-19.3977325]


portfolio before change:  [-4.17520256]
curr_Stock_Price:  107.5430564374163
curr_Factors:  [107.54305644]
mat_Sqrt:  [[0.15]]
grads:  [0.22281991]
Stock Position:  0.22281990998391613
Bond Position:  [-28.13793672]


portfolio before change:  [-4.06512051]
curr_Stock_Price:  108.04498972602227
curr_Factors:  [108.04498973]
mat_Sqrt:  [[0.15]]
grads:  [0.21188808]
Stock Position:  0.21188807502083348
Bond Position:  [-26.9585654]


portfolio before change:  [-3.96197597]
curr_Stock_Price:  108.53972972865441
curr_Factors:  [108.53972973]
mat_Sqrt:  [[0.15]]
grads:  [-0.08455443]
Stock Position:  -0.08455442696651476
Bond Position:  [5.21553869]


portfolio before change:  [-3.87676449]
curr_Stock_Price:  107.53581428398365
curr_Factors:  [107.53581428]
mat_Sqrt:  [[0.15]]
grads:  [0.11025517]
Stock Position:  0.11025517055202756
Bond Position:  [-15.73314403]


portfolio before change:  [-3.8224549]
curr_Stock_Price:  108.03731400832237
curr_Factors:  [108.03731401]
mat_Sqrt:  [[0.15]]
grads:  [-0.2108275]
Stock Position:  -0.21082750372666836
Bond Position:  [18.95478232]


portfolio before change:  [-3.87667924]
curr_Stock_Price:  108.30013097733844
curr_Factors:  [108.30013098]
mat_Sqrt:  [[0.15]]
grads:  [0.05225263]
Stock Position:  0.05225263360954766
Bond Position:  [-9.5356463]


portfolio before change:  [-3.89280789]
curr_Stock_Price:  108.00287018241266
curr_Factors:  [108.00287018]
mat_Sqrt:  [[0.15]]
grads:  [-0.94997451]
Stock Position:  -0.9499745118061191
Bond Position:  [98.70716598]


portfolio before change:  [-3.09192693]
curr_Stock_Price:  107.16630924381248
curr_Factors:  [107.16630924]
mat_Sqrt:  [[0.15]]
grads:  [0.12229491]
Stock Position:  0.1222949087414786
Bond Position:  [-16.19782094]


portfolio before change:  [-2.9398511]
curr_Stock_Price:  108.41810487983784
curr_Factors:  [108.41810488]
mat_Sqrt:  [[0.15]]
grads:  [0.02232583]
Stock Position:  0.02232582641499095
Bond Position:  [-5.36037489]


portfolio before change:  [-2.93502549]
curr_Stock_Price:  108.64925607983773
curr_Factors:  [108.64925608]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057408]
Stock Position:  -0.010574079686330711
Bond Position:  [-1.7861596]


portfolio before change:  [-2.93175836]
curr_Stock_Price:  108.32972319319687
curr_Factors:  [108.32972319]
mat_Sqrt:  [[0.15]]
grads:  [0.22273089]
Stock Position:  0.22273089481266606
Bond Position:  [-27.06013454]


portfolio before change:  [-2.7356392]
curr_Stock_Price:  109.21783740475668
curr_Factors:  [109.2178374]
mat_Sqrt:  [[0.15]]
grads:  [0.64628251]
Stock Position:  0.646282510380183
Bond Position:  [-73.32121734]


portfolio before change:  [-3.02870667]
curr_Stock_Price:  108.77146178539948
curr_Factors:  [108.77146179]
mat_Sqrt:  [[0.15]]
grads:  [0.12245202]
Stock Position:  0.12245201612083811
Bond Position:  [-16.34799147]


portfolio before change:  [-3.11085391]
curr_Stock_Price:  108.10895368484228
curr_Factors:  [108.10895368]
mat_Sqrt:  [[0.15]]
grads:  [0.18044417]
Stock Position:  0.18044417283277886
Bond Position:  [-22.61848463]


portfolio before change:  [-3.21266979]
curr_Stock_Price:  107.55253679383678
curr_Factors:  [107.55253679]
mat_Sqrt:  [[0.15]]
grads:  [0.13433047]
Stock Position:  0.1343304732996895
Bond Position:  [-17.66025297]


portfolio before change:  [-3.21862238]
curr_Stock_Price:  107.51644086499897
curr_Factors:  [107.51644086]
mat_Sqrt:  [[0.15]]
grads:  [-0.0531386]
Stock Position:  -0.05313859748519264
Bond Position:  [2.4946505]


portfolio before change:  [-3.22068239]
curr_Stock_Price:  107.55814196785302
curr_Factors:  [107.55814197]
mat_Sqrt:  [[0.15]]
grads:  [0.04105443]
Stock Position:  0.041054430500840185
Bond Position:  [-7.63642066]


portfolio before change:  [-3.27964744]
curr_Stock_Price:  106.13350273302976
curr_Factors:  [106.13350273]
mat_Sqrt:  [[0.15]]
grads:  [0.06284259]
Stock Position:  0.06284259456116152
Bond Position:  [-9.94935212]


portfolio before change:  [-3.28744084]
curr_Stock_Price:  106.01938351770423
curr_Factors:  [106.01938352]
mat_Sqrt:  [[0.15]]
grads:  [0.02426969]
Stock Position:  0.02426969245991556
Bond Position:  [-5.86049867]


portfolio before change:  [-3.2656319]
curr_Stock_Price:  106.93308400029402
curr_Factors:  [106.933084]
mat_Sqrt:  [[0.15]]
grads:  [-0.20612011]
Stock Position:  -0.206120112061175
Bond Position:  [18.77542735]


portfolio before change:  [-3.32023491]
curr_Stock_Price:  107.20368599110029
curr_Factors:  [107.20368599]
mat_Sqrt:  [[0.15]]
grads:  [0.05496614]
Stock Position:  0.054966142316825034
Bond Position:  [-9.21280798]


portfolio before change:  [-3.32611702]
curr_Stock_Price:  107.10714853115078
curr_Factors:  [107.10714853]
mat_Sqrt:  [[0.15]]
grads:  [0.15910928]
Stock Position:  0.15910928373734207
Bond Position:  [-20.36785871]


portfolio before change:  [-3.38575106]
curr_Stock_Price:  106.74035028335582
curr_Factors:  [106.74035028]
mat_Sqrt:  [[0.15]]
grads:  [-0.11557435]
Stock Position:  -0.1155743485040974
Bond Position:  [8.95069538]


portfolio before change:  [-3.39505523]
curr_Stock_Price:  106.82569453565105
curr_Factors:  [106.82569454]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547111]
Stock Position:  -0.054711103314487725
Bond Position:  [2.44949638]


portfolio before change:  [-3.41082257]
curr_Stock_Price:  107.11668552418823
curr_Factors:  [107.11668552]
mat_Sqrt:  [[0.15]]
grads:  [-0.07161075]
Stock Position:  -0.07161074963888027
Bond Position:  [4.25988358]


portfolio before change:  [-3.38642635]
curr_Stock_Price:  106.77972537546226
curr_Factors:  [106.77972538]
mat_Sqrt:  [[0.15]]
grads:  [0.13123596]
Stock Position:  0.1312359573554117
Bond Position:  [-17.39976584]


portfolio before change:  [-3.4177835]
curr_Stock_Price:  106.54907496418119
curr_Factors:  [106.54907496]
mat_Sqrt:  [[0.15]]
grads:  [-0.04860726]
Stock Position:  -0.048607258873808505
Bond Position:  [1.76127497]


portfolio before change:  [-3.38439527]
curr_Stock_Price:  105.86444172618262
curr_Factors:  [105.86444173]
mat_Sqrt:  [[0.15]]
grads:  [0.1241868]
Stock Position:  0.12418679973441038
Bond Position:  [-16.53136149]


portfolio before change:  [-3.25620761]
curr_Stock_Price:  106.90497826142342
curr_Factors:  [106.90497826]
mat_Sqrt:  [[0.15]]
grads:  [-0.03811217]
Stock Position:  -0.03811216501881139
Bond Position:  [0.81817256]


portfolio before change:  [-3.27068509]
curr_Stock_Price:  107.28618510256443
curr_Factors:  [107.2861851]
mat_Sqrt:  [[0.15]]
grads:  [0.10338266]
Stock Position:  0.1033826577612986
Bond Position:  [-14.36221605]


portfolio before change:  [-3.30497912]
curr_Stock_Price:  106.9631487450098
curr_Factors:  [106.96314875]
mat_Sqrt:  [[0.15]]
grads:  [0.193356]
Stock Position:  0.19335600297142225
Bond Position:  [-23.98694602]


portfolio before change:  [-3.44392554]
curr_Stock_Price:  106.25229832726096
curr_Factors:  [106.25229833]
mat_Sqrt:  [[0.15]]
grads:  [0.06598925]
Stock Position:  0.06598924595305601
Bond Position:  [-10.45543459]


portfolio before change:  [-3.40438954]
curr_Stock_Price:  106.86132917150088
curr_Factors:  [106.86132917]
mat_Sqrt:  [[0.15]]
grads:  [-0.05171593]
Stock Position:  -0.0517159268013333
Bond Position:  [2.12204314]


portfolio before change:  [-3.42986243]
curr_Stock_Price:  107.35644786268527
curr_Factors:  [107.35644786]
mat_Sqrt:  [[0.15]]
grads:  [0.34871445]
Stock Position:  0.34871445101414317
Bond Position:  [-40.86660721]


portfolio before change:  [-3.55629005]
curr_Stock_Price:  107.00121917845183
curr_Factors:  [107.00121918]
mat_Sqrt:  [[0.15]]
grads:  [0.06448476]
Stock Position:  0.06448476059787205
Bond Position:  [-10.45623805]


portfolio before change:  [-3.59180875]
curr_Stock_Price:  106.46054618854347
curr_Factors:  [106.46054619]
mat_Sqrt:  [[0.15]]
grads:  [-0.07008401]
Stock Position:  -0.0700840146238518
Bond Position:  [3.86937372]


portfolio before change:  [-3.6014101]
curr_Stock_Price:  106.60099461097911
curr_Factors:  [106.60099461]
mat_Sqrt:  [[0.15]]
grads:  [0.03862272]
Stock Position:  0.03862271623219427
Bond Position:  [-7.71863006]


portfolio before change:  [-3.54847297]
curr_Stock_Price:  107.98410706998921
curr_Factors:  [107.98410707]
mat_Sqrt:  [[0.15]]
grads:  [-0.17143721]
Stock Position:  -0.17143721458093747
Bond Position:  [14.96402157]


portfolio before change:  [-3.52941354]
curr_Stock_Price:  107.87838819495532
curr_Factors:  [107.87838819]
mat_Sqrt:  [[0.15]]
grads:  [0.25369164]
Stock Position:  0.25369164345352074
Bond Position:  [-30.89725913]


portfolio before change:  [-3.56889454]
curr_Stock_Price:  107.73037440834817
curr_Factors:  [107.73037441]
mat_Sqrt:  [[0.15]]
grads:  [0.12169153]
Stock Position:  0.12169152865929105
Bond Position:  [-16.67876848]


portfolio before change:  [-3.52404057]
curr_Stock_Price:  108.10752818090941
curr_Factors:  [108.10752818]
mat_Sqrt:  [[0.15]]
grads:  [0.01713617]
Stock Position:  0.017136171237200452
Bond Position:  [-5.37658969]


portfolio before change:  [-3.50406826]
curr_Stock_Price:  109.2926450208068
curr_Factors:  [109.29264502]
mat_Sqrt:  [[0.15]]
grads:  [0.01463583]
Stock Position:  0.014635832280312457
Bond Position:  [-5.10365708]


portfolio before change:  [-3.50133003]
curr_Stock_Price:  109.50153092344951
curr_Factors:  [109.50153092]
mat_Sqrt:  [[0.15]]
grads:  [-0.06532065]
Stock Position:  -0.06532065318813954
Bond Position:  [3.6513815]


portfolio before change:  [-3.49488391]
curr_Stock_Price:  109.4063406048987
curr_Factors:  [109.4063406]
mat_Sqrt:  [[0.15]]
grads:  [0.1832763]
Stock Position:  0.18327629901994105
Bond Position:  [-23.54647311]


portfolio before change:  [-3.32053214]
curr_Stock_Price:  110.36567617034447
curr_Factors:  [110.36567617]
mat_Sqrt:  [[0.15]]
grads:  [0.42785482]
Stock Position:  0.4278548169948419
Bond Position:  [-50.54101832]


portfolio before change:  [-3.61791061]
curr_Stock_Price:  109.67801404548752
curr_Factors:  [109.67801405]
mat_Sqrt:  [[0.15]]
grads:  [-0.06642838]
Stock Position:  -0.06642838400197665
Bond Position:  [3.66782263]


portfolio before change:  [-3.62147765]
curr_Stock_Price:  109.73516268708586
curr_Factors:  [109.73516269]
mat_Sqrt:  [[0.15]]
grads:  [-0.07507976]
Stock Position:  -0.07507976213215066
Bond Position:  [4.61741226]


portfolio before change:  [-3.68489622]
curr_Stock_Price:  110.5836891636346
curr_Factors:  [110.58368916]
mat_Sqrt:  [[0.15]]
grads:  [0.15124463]
Stock Position:  0.1512446346030055
Bond Position:  [-20.41008588]


portfolio before change:  [-3.56521699]
curr_Stock_Price:  111.38341933890149
curr_Factors:  [111.38341934]
mat_Sqrt:  [[0.15]]
grads:  [0.08860241]
Stock Position:  0.08860241091368164
Bond Position:  [-13.43405648]


portfolio before change:  [-3.50426233]
curr_Stock_Price:  112.08085316616072
curr_Factors:  [112.08085317]
mat_Sqrt:  [[0.15]]
grads:  [-0.02199743]
Stock Position:  -0.02199742992593532
Bond Position:  [-1.03877162]


portfolio before change:  [-3.49957464]
curr_Stock_Price:  111.86479989870192
curr_Factors:  [111.8647999]
mat_Sqrt:  [[0.15]]
grads:  [0.10828454]
Stock Position:  0.10828453980136983
Bond Position:  [-15.61280302]


portfolio before change:  [-3.55109966]
curr_Stock_Price:  111.39798170700911
curr_Factors:  [111.39798171]
mat_Sqrt:  [[0.15]]
grads:  [-0.23091976]
Stock Position:  -0.23091975637613824
Bond Position:  [22.17289513]


portfolio before change:  [-3.67237571]
curr_Stock_Price:  111.92917009159343
curr_Factors:  [111.92917009]
mat_Sqrt:  [[0.15]]
grads:  [-0.55706767]
Stock Position:  -0.5570676664746788
Bond Position:  [58.67974589]


portfolio before change:  [-3.18445587]
curr_Stock_Price:  111.05988209675236
curr_Factors:  [111.0598821]
mat_Sqrt:  [[0.15]]
grads:  [0.04316596]
Stock Position:  0.04316596106505928
Bond Position:  [-7.97846242]


portfolio before change:  [-3.19976317]
curr_Stock_Price:  110.71681949310153
curr_Factors:  [110.71681949]
mat_Sqrt:  [[0.15]]
grads:  [0.12283344]
Stock Position:  0.1228334441412436
Bond Position:  [-16.79949143]


portfolio before change:  [-3.01896207]
curr_Stock_Price:  112.19728846238098
curr_Factors:  [112.19728846]
mat_Sqrt:  [[0.15]]
grads:  [-0.43709951]
Stock Position:  -0.43709950835769007
Bond Position:  [46.02241756]


portfolio before change:  [-3.12580633]
curr_Stock_Price:  112.44830854152706
curr_Factors:  [112.44830854]
mat_Sqrt:  [[0.15]]
grads:  [0.20451857]
Stock Position:  0.204518572267529
Bond Position:  [-26.12357385]


portfolio before change:  [-3.21214921]
curr_Stock_Price:  112.03411581734775
curr_Factors:  [112.03411582]
mat_Sqrt:  [[0.15]]
grads:  [-0.20848452]
Stock Position:  -0.20848451812087995
Bond Position:  [20.14522944]


portfolio before change:  [-3.21486542]
curr_Stock_Price:  112.05318357424218
curr_Factors:  [112.05318357]
mat_Sqrt:  [[0.15]]
grads:  [0.08029603]
Stock Position:  0.08029603190453669
Bond Position:  [-12.21229143]


portfolio before change:  [-3.23371612]
curr_Stock_Price:  111.8279246095892
curr_Factors:  [111.82792461]
mat_Sqrt:  [[0.15]]
grads:  [0.12503678]
Stock Position:  0.12503678184591574
Bond Position:  [-17.21631993]


portfolio before change:  [-3.2633467]
curr_Stock_Price:  111.5995555582866
curr_Factors:  [111.59955556]
mat_Sqrt:  [[0.15]]
grads:  [-0.15892886]
Stock Position:  -0.15892885502893833
Bond Position:  [14.47304288]


portfolio before change:  [-3.0514976]
curr_Stock_Price:  110.27226663410876
curr_Factors:  [110.27226663]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.0514976]
Stock Price:  110.59426979232117
PL:  [-13.64576739]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.57032949e-03]
 [-1.33708215e-02]
 [-1.78487683e-04]
 [ 8.30803748e-03]
 [ 4.53198248e-03]
 [ 2.22065438e-02]
 [ 1.12901454e-03]
 [-1.13569502e-02]
 [ 1.82294459e-02]
 [ 7.09471897e-03]
 [ 1.35359875e-02]
 [ 8.64828837e-03]
 [-1.39562770e-02]
 [ 1.12853367e-02]
 [-6.93374622e-03]
 [ 8.12994065e-03]
 [ 1.31399604e-02]
 [ 1.62935940e-02]
 [ 8.17628059e-04]
 [ 1.35973343e-02]
 [ 1.31803285e-02]
 [-1.07125079e-02]
 [ 1.44378116e-03]
 [-1.12053427e-01]
 [-1.36126679e-02]
 [-1.16776080e-03]
 [ 1.72507862e-03]
 [ 1.26330842e-02]
 [-5.75216059e-02]
 [ 6.10836696e-03]
 [ 1.45855640e-02]
 [-1.21553558e-02]
 [-7.52212897e-03]
 [ 5.77760830e-03]
 [ 1.37702862e-02]
 [ 1.24613945e-02]
 [-3.41842943e-02]
 [ 8.89703347e-03]
 [-1.47748194e-02]
 [ 2.42017385e-02]
 [-5.63344097e-03]
 [ 2.39948565e-03]
 [ 2.30314210e-02]
 [ 4.39378663e-03]
 [-8.13676039e-03]
 [-3.14625709e-03]
 [ 5.00140135e-03]
 [-1.19970703e-02]
 [-1.36999171e-02]
 [-5.71593354e-03]
 [ 4.70249363e-02]
 [-8.69421907e-03]
 [ 3.16021527e-03]
 [ 5.43168255e-03]
 [ 5.66585221e-03]
 [-3.25162359e-03]
 [ 6.46621376e-03]
 [-2.48279728e-04]
 [ 1.54899248e-03]
 [-6.29958550e-03]
 [ 9.00849938e-04]
 [-5.33993530e-03]
 [ 3.17778356e-03]
 [-1.76154823e-02]
 [-1.31589133e-02]
 [-1.51795312e-03]
 [-5.02638028e-03]
 [ 2.39913701e-02]
 [-8.77860497e-03]
 [ 6.12962398e-03]
 [-6.22218796e-03]
 [ 1.09625904e-02]
 [-6.19538726e-03]
 [ 9.21243828e-03]
 [-1.56070238e-02]
 [-8.37794923e-03]
 [-4.18771316e-04]
 [ 2.72596988e-03]
 [-9.42874506e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.84382763]
curr_Stock_Price:  99.6173018221059
curr_Factors:  [99.61730182]
mat_Sqrt:  [[0.15]]
grads:  [0.0238022]
Stock Position:  0.02380219659909271
Bond Position:  [-6.21493823]


portfolio before change:  [-3.85645834]
curr_Stock_Price:  99.10296831978276
curr_Factors:  [99.10296832]
mat_Sqrt:  [[0.15]]
grads:  [-0.08913881]
Stock Position:  -0.08913880978241043
Bond Position:  [4.9774623]


portfolio before change:  [-3.9103242]
curr_Stock_Price:  99.71075021814136
curr_Factors:  [99.71075022]
mat_Sqrt:  [[0.15]]
grads:  [-0.00118992]
Stock Position:  -0.0011899178842012202
Bond Position:  [-3.79167659]


portfolio before change:  [-3.91075028]
curr_Stock_Price:  99.86966779197913
curr_Factors:  [99.86966779]
mat_Sqrt:  [[0.15]]
grads:  [0.05538692]
Stock Position:  0.05538691650885328
Bond Position:  [-9.44222323]


portfolio before change:  [-3.9110396]
curr_Stock_Price:  99.87509941904824
curr_Factors:  [99.87509942]
mat_Sqrt:  [[0.15]]
grads:  [0.03021322]
Stock Position:  0.03021321653221614
Bond Position:  [-6.9285876]


portfolio before change:  [-3.91733997]
curr_Stock_Price:  99.68090225412875
curr_Factors:  [99.68090225]
mat_Sqrt:  [[0.15]]
grads:  [0.14804363]
Stock Position:  0.1480436251772471
Bond Position:  [-18.6744621]


portfolio before change:  [-3.7756959]
curr_Stock_Price:  100.64555881756527
curr_Factors:  [100.64555882]
mat_Sqrt:  [[0.15]]
grads:  [0.00752676]
Stock Position:  0.007526763594764311
Bond Position:  [-4.53323123]


portfolio before change:  [-3.77547905]
curr_Stock_Price:  100.71201323189949
curr_Factors:  [100.71201323]
mat_Sqrt:  [[0.15]]
grads:  [-0.075713]
Stock Position:  -0.07571300118342174
Bond Position:  [3.84972972]


portfolio before change:  [-3.71601158]
curr_Stock_Price:  99.92975845440112
curr_Factors:  [99.92975845]
mat_Sqrt:  [[0.15]]
grads:  [0.12152964]
Stock Position:  0.12152963920798307
Bond Position:  [-15.86043907]


portfolio before change:  [-3.7543558]
curr_Stock_Price:  99.62240206707584
curr_Factors:  [99.62240207]
mat_Sqrt:  [[0.15]]
grads:  [0.04729813]
Stock Position:  0.0472981264774315
Bond Position:  [-8.46630877]


portfolio before change:  [-3.75108095]
curr_Stock_Price:  99.7028283627974
curr_Factors:  [99.70282836]
mat_Sqrt:  [[0.15]]
grads:  [0.09023992]
Stock Position:  0.09023991669756085
Bond Position:  [-12.74825587]


portfolio before change:  [-3.77443803]
curr_Stock_Price:  99.4528249058866
curr_Factors:  [99.45282491]
mat_Sqrt:  [[0.15]]
grads:  [0.05765526]
Stock Position:  0.05765525576887363
Bond Position:  [-9.50841609]


portfolio before change:  [-3.81224955]
curr_Stock_Price:  98.80731181933889
curr_Factors:  [98.80731182]
mat_Sqrt:  [[0.15]]
grads:  [-0.09304185]
Stock Position:  -0.09304184671287115
Bond Position:  [5.38096521]


portfolio before change:  [-3.84944904]
curr_Stock_Price:  99.21074123513661
curr_Factors:  [99.21074124]
mat_Sqrt:  [[0.15]]
grads:  [0.07523558]
Stock Position:  0.07523557822456484
Bond Position:  [-11.31362653]


portfolio before change:  [-3.84595339]
curr_Stock_Price:  99.26660284719063
curr_Factors:  [99.26660285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04622497]
Stock Position:  -0.04622497482354477
Bond Position:  [0.74264283]


portfolio before change:  [-3.79806164]
curr_Stock_Price:  98.2315490937853
curr_Factors:  [98.23154909]
mat_Sqrt:  [[0.15]]
grads:  [0.0541996]
Stock Position:  0.05419960430995359
Bond Position:  [-9.12217273]


portfolio before change:  [-3.86794963]
curr_Stock_Price:  96.95261282503989
curr_Factors:  [96.95261283]
mat_Sqrt:  [[0.15]]
grads:  [0.08759974]
Stock Position:  0.08759973630185687
Bond Position:  [-12.36097295]


portfolio before change:  [-3.89715029]
curr_Stock_Price:  96.62809041626235
curr_Factors:  [96.62809042]
mat_Sqrt:  [[0.15]]
grads:  [0.10862396]
Stock Position:  0.10862396022714607
Bond Position:  [-14.39327614]


portfolio before change:  [-3.93047255]
curr_Stock_Price:  96.32960518496503
curr_Factors:  [96.32960518]
mat_Sqrt:  [[0.15]]
grads:  [0.00545085]
Stock Position:  0.005450853726474533
Bond Position:  [-4.45555114]


portfolio before change:  [-3.93305796]
curr_Stock_Price:  95.90638109056101
curr_Factors:  [95.90638109]
mat_Sqrt:  [[0.15]]
grads:  [0.0906489]
Stock Position:  0.09064889553184269
Bond Position:  [-12.62686548]


portfolio before change:  [-3.9214601]
curr_Stock_Price:  96.04302995838626
curr_Factors:  [96.04302996]
mat_Sqrt:  [[0.15]]
grads:  [0.08786886]
Stock Position:  0.08786885639948205
Bond Position:  [-12.3606513]


portfolio before change:  [-3.88074068]
curr_Stock_Price:  96.51523344522528
curr_Factors:  [96.51523345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07141672]
Stock Position:  -0.0714167190003409
Bond Position:  [3.01206063]


portfolio before change:  [-3.86930102]
curr_Stock_Price:  96.35768773182588
curr_Factors:  [96.35768773]
mat_Sqrt:  [[0.15]]
grads:  [0.00962521]
Stock Position:  0.00962520770815088
Bond Position:  [-4.79676378]


portfolio before change:  [-3.88108812]
curr_Stock_Price:  95.1642292746199
curr_Factors:  [95.16422927]
mat_Sqrt:  [[0.15]]
grads:  [-0.74702285]
Stock Position:  -0.747022848413998
Bond Position:  [67.2087655]


portfolio before change:  [-3.7362312]
curr_Stock_Price:  94.97594020371136
curr_Factors:  [94.9759402]
mat_Sqrt:  [[0.15]]
grads:  [-0.09075112]
Stock Position:  -0.09075111953697708
Bond Position:  [4.8829417]


portfolio before change:  [-3.7984087]
curr_Stock_Price:  95.66444627812598
curr_Factors:  [95.66444628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00778507]
Stock Position:  -0.007785071967633314
Bond Position:  [-3.0536541]


portfolio before change:  [-3.79958822]
curr_Stock_Price:  95.79144038426702
curr_Factors:  [95.79144038]
mat_Sqrt:  [[0.15]]
grads:  [0.01150052]
Stock Position:  0.011500524113668276
Bond Position:  [-4.90123999]


portfolio before change:  [-3.80410623]
curr_Stock_Price:  95.42522419308868
curr_Factors:  [95.42522419]
mat_Sqrt:  [[0.15]]
grads:  [0.08422056]
Stock Position:  0.08422056129807533
Bond Position:  [-11.84087218]


portfolio before change:  [-3.77928393]
curr_Stock_Price:  95.7287413492453
curr_Factors:  [95.72874135]
mat_Sqrt:  [[0.15]]
grads:  [-0.38347737]
Stock Position:  -0.38347737297268686
Bond Position:  [32.93052232]


portfolio before change:  [-3.6490971]
curr_Stock_Price:  95.39461835936001
curr_Factors:  [95.39461836]
mat_Sqrt:  [[0.15]]
grads:  [0.04072245]
Stock Position:  0.04072244641755543
Bond Position:  [-7.53379933]


portfolio before change:  [-3.65483817]
curr_Stock_Price:  95.26520092621962
curr_Factors:  [95.26520093]
mat_Sqrt:  [[0.15]]
grads:  [0.09723709]
Stock Position:  0.09723709316544105
Bond Position:  [-12.91814939]


portfolio before change:  [-3.62022885]
curr_Stock_Price:  95.62943155452604
curr_Factors:  [95.62943155]
mat_Sqrt:  [[0.15]]
grads:  [-0.08103571]
Stock Position:  -0.08103570565349286
Bond Position:  [4.12916961]


portfolio before change:  [-3.67586172]
curr_Stock_Price:  96.31913917697318
curr_Factors:  [96.31913918]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014753]
Stock Position:  -0.05014752647354363
Bond Position:  [1.15430487]


portfolio before change:  [-3.68647419]
curr_Stock_Price:  96.53220297891608
curr_Factors:  [96.53220298]
mat_Sqrt:  [[0.15]]
grads:  [0.03851739]
Stock Position:  0.03851738867393022
Bond Position:  [-7.40464257]


portfolio before change:  [-3.68901278]
curr_Stock_Price:  96.47831093520408
curr_Factors:  [96.47831094]
mat_Sqrt:  [[0.15]]
grads:  [0.09180191]
Stock Position:  0.09180190787934292
Bond Position:  [-12.54590579]


portfolio before change:  [-3.63858845]
curr_Stock_Price:  97.03612578704461
curr_Factors:  [97.03612579]
mat_Sqrt:  [[0.15]]
grads:  [0.08307596]
Stock Position:  0.0830759634879705
Bond Position:  [-11.6999581]


portfolio before change:  [-3.61572965]
curr_Stock_Price:  97.32008361750576
curr_Factors:  [97.32008362]
mat_Sqrt:  [[0.15]]
grads:  [-0.2278953]
Stock Position:  -0.22789529517719687
Bond Position:  [18.56305953]


portfolio before change:  [-3.80380472]
curr_Stock_Price:  98.15044430576224
curr_Factors:  [98.15044431]
mat_Sqrt:  [[0.15]]
grads:  [0.05931356]
Stock Position:  0.05931355649409324
Bond Position:  [-9.62545664]


portfolio before change:  [-3.74761026]
curr_Stock_Price:  99.10800053210957
curr_Factors:  [99.10800053]
mat_Sqrt:  [[0.15]]
grads:  [-0.0984988]
Stock Position:  -0.09849879629918035
Bond Position:  [6.01440849]


portfolio before change:  [-3.7109525]
curr_Stock_Price:  98.73965232089624
curr_Factors:  [98.73965232]
mat_Sqrt:  [[0.15]]
grads:  [0.16134492]
Stock Position:  0.16134492345533882
Bond Position:  [-19.64209414]


portfolio before change:  [-3.77261715]
curr_Stock_Price:  98.36506981326781
curr_Factors:  [98.36506981]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755627]
Stock Position:  -0.03755627315254826
Bond Position:  [-0.07839172]


portfolio before change:  [-3.79281375]
curr_Stock_Price:  98.90270837119525
curr_Factors:  [98.90270837]
mat_Sqrt:  [[0.15]]
grads:  [0.01599657]
Stock Position:  0.015996571025225365
Bond Position:  [-5.37491795]


portfolio before change:  [-3.79536085]
curr_Stock_Price:  98.76448146338225
curr_Factors:  [98.76448146]
mat_Sqrt:  [[0.15]]
grads:  [0.15354281]
Stock Position:  0.15354280657777816
Bond Position:  [-18.95993653]


portfolio before change:  [-3.77268518]
curr_Stock_Price:  98.91988242341532
curr_Factors:  [98.91988242]
mat_Sqrt:  [[0.15]]
grads:  [0.02929191]
Stock Position:  0.02929191084510349
Bond Position:  [-6.67023756]


portfolio before change:  [-3.74565992]
curr_Stock_Price:  99.85673377897399
curr_Factors:  [99.85673378]
mat_Sqrt:  [[0.15]]
grads:  [-0.05424507]
Stock Position:  -0.05424506927847776
Bond Position:  [1.67107552]


portfolio before change:  [-3.75248987]
curr_Stock_Price:  99.98456838903577
curr_Factors:  [99.98456839]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097505]
Stock Position:  -0.020975047299292376
Bond Position:  [-1.65530882]


portfolio before change:  [-3.7505366]
curr_Stock_Price:  99.88651217789813
curr_Factors:  [99.88651218]
mat_Sqrt:  [[0.15]]
grads:  [0.03334268]
Stock Position:  0.03334267568394236
Bond Position:  [-7.08102018]


portfolio before change:  [-3.74812475]
curr_Stock_Price:  99.97212112291946
curr_Factors:  [99.97212112]
mat_Sqrt:  [[0.15]]
grads:  [-0.07998047]
Stock Position:  -0.07998046858331977
Bond Position:  [4.24769235]


portfolio before change:  [-3.72724416]
curr_Stock_Price:  99.71436950463517
curr_Factors:  [99.7143695]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133278]
Stock Position:  -0.09133278055280426
Bond Position:  [5.37994647]


portfolio before change:  [-3.67112496]
curr_Stock_Price:  99.10360361030148
curr_Factors:  [99.10360361]
mat_Sqrt:  [[0.15]]
grads:  [-0.03810622]
Stock Position:  -0.038106223574512245
Bond Position:  [0.10533912]


portfolio before change:  [-3.69891457]
curr_Stock_Price:  99.83304330585034
curr_Factors:  [99.83304331]
mat_Sqrt:  [[0.15]]
grads:  [0.31349958]
Stock Position:  0.31349957555713553
Bond Position:  [-34.99653127]


portfolio before change:  [-3.76617516]
curr_Stock_Price:  99.6254728853115
curr_Factors:  [99.62547289]
mat_Sqrt:  [[0.15]]
grads:  [-0.05796146]
Stock Position:  -0.05796146044140816
Bond Position:  [2.00826275]


portfolio before change:  [-3.76151105]
curr_Stock_Price:  99.54716940251804
curr_Factors:  [99.5471694]
mat_Sqrt:  [[0.15]]
grads:  [0.0210681]
Stock Position:  0.021068101781270502
Bond Position:  [-5.85878095]


portfolio before change:  [-3.76042065]
curr_Stock_Price:  99.6163062473656
curr_Factors:  [99.61630625]
mat_Sqrt:  [[0.15]]
grads:  [0.03621122]
Stock Position:  0.03621121698138547
Bond Position:  [-7.36764833]


portfolio before change:  [-3.77813997]
curr_Stock_Price:  99.13969095893302
curr_Factors:  [99.13969096]
mat_Sqrt:  [[0.15]]
grads:  [0.03777235]
Stock Position:  0.03777234807839175
Bond Position:  [-7.52287888]


portfolio before change:  [-3.76038638]
curr_Stock_Price:  99.62215462132613
curr_Factors:  [99.62215462]
mat_Sqrt:  [[0.15]]
grads:  [-0.02167749]
Stock Position:  -0.021677490579267978
Bond Position:  [-1.60082806]


portfolio before change:  [-3.76282076]
curr_Stock_Price:  99.72983907344769
curr_Factors:  [99.72983907]
mat_Sqrt:  [[0.15]]
grads:  [0.04310809]
Stock Position:  0.04310809172097663
Bond Position:  [-8.06198381]


portfolio before change:  [-3.73837626]
curr_Stock_Price:  100.3085792982666
curr_Factors:  [100.3085793]
mat_Sqrt:  [[0.15]]
grads:  [-0.0016552]
Stock Position:  -0.001655198187894231
Bond Position:  [-3.57234568]


portfolio before change:  [-3.73678829]
curr_Stock_Price:  99.21430113538193
curr_Factors:  [99.21430114]
mat_Sqrt:  [[0.15]]
grads:  [0.01032662]
Stock Position:  0.010326616516219618
Bond Position:  [-4.76133633]


portfolio before change:  [-3.73131274]
curr_Stock_Price:  99.77335593571388
curr_Factors:  [99.77335594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04199724]
Stock Position:  -0.04199723665012559
Bond Position:  [0.4588925]


portfolio before change:  [-3.72692169]
curr_Stock_Price:  99.66948325100944
curr_Factors:  [99.66948325]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-4.32550335]


portfolio before change:  [-3.73052464]
curr_Stock_Price:  99.1145742745152
curr_Factors:  [99.11457427]
mat_Sqrt:  [[0.15]]
grads:  [-0.03559957]
Stock Position:  -0.03559956864929867
Bond Position:  [-0.20208855]


portfolio before change:  [-3.71522591]
curr_Stock_Price:  98.68447459444131
curr_Factors:  [98.68447459]
mat_Sqrt:  [[0.15]]
grads:  [0.02118522]
Stock Position:  0.021185223720470374
Bond Position:  [-5.80587858]


portfolio before change:  [-3.71897789]
curr_Stock_Price:  98.52449999555508
curr_Factors:  [98.5245]
mat_Sqrt:  [[0.15]]
grads:  [-0.11743655]
Stock Position:  -0.1174365485039966
Bond Position:  [7.85139933]


portfolio before change:  [-3.73991541]
curr_Stock_Price:  98.70696658530866
curr_Factors:  [98.70696659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08772609]
Stock Position:  -0.08772608899712739
Bond Position:  [4.91926073]


portfolio before change:  [-3.75152537]
curr_Stock_Price:  98.84281471765337
curr_Factors:  [98.84281472]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011969]
Stock Position:  -0.010119687455161694
Bond Position:  [-2.75126698]


portfolio before change:  [-3.75464316]
curr_Stock_Price:  99.13391325308763
curr_Factors:  [99.13391325]
mat_Sqrt:  [[0.15]]
grads:  [-0.0335092]
Stock Position:  -0.03350920189698701
Bond Position:  [-0.43274484]


portfolio before change:  [-3.79288589]
curr_Stock_Price:  100.27436670484437
curr_Factors:  [100.2743667]
mat_Sqrt:  [[0.15]]
grads:  [0.15994247]
Stock Position:  0.1599424672248225
Bond Position:  [-19.8310155]


portfolio before change:  [-3.88546443]
curr_Stock_Price:  99.70329221158192
curr_Factors:  [99.70329221]
mat_Sqrt:  [[0.15]]
grads:  [-0.05852403]
Stock Position:  -0.0585240331090342
Bond Position:  [1.94957435]


portfolio before change:  [-3.84673647]
curr_Stock_Price:  99.04362980749981
curr_Factors:  [99.04362981]
mat_Sqrt:  [[0.15]]
grads:  [0.04086416]
Stock Position:  0.040864159872689196
Bond Position:  [-7.89407119]


portfolio before change:  [-3.87442275]
curr_Stock_Price:  98.37818411376342
curr_Factors:  [98.37818411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148125]
Stock Position:  -0.04148125307352615
Bond Position:  [0.20642761]


portfolio before change:  [-3.882722]
curr_Stock_Price:  98.57856750895678
curr_Factors:  [98.57856751]
mat_Sqrt:  [[0.15]]
grads:  [0.07308394]
Stock Position:  0.07308393618770727
Bond Position:  [-11.08723174]


portfolio before change:  [-3.8191376]
curr_Stock_Price:  99.45806822234259
curr_Factors:  [99.45806822]
mat_Sqrt:  [[0.15]]
grads:  [-0.04130258]
Stock Position:  -0.0413025817234314
Bond Position:  [0.28873739]


portfolio before change:  [-3.80521198]
curr_Stock_Price:  99.12134426162642
curr_Factors:  [99.12134426]
mat_Sqrt:  [[0.15]]
grads:  [0.06141626]
Stock Position:  0.061416255190911685
Bond Position:  [-9.89287376]


portfolio before change:  [-3.85620684]
curr_Stock_Price:  98.30109665111999
curr_Factors:  [98.30109665]
mat_Sqrt:  [[0.15]]
grads:  [-0.10404683]
Stock Position:  -0.10404682525112191
Bond Position:  [6.37171018]


portfolio before change:  [-3.81819657]
curr_Stock_Price:  97.93960529658393
curr_Factors:  [97.9396053]
mat_Sqrt:  [[0.15]]
grads:  [-0.05585299]
Stock Position:  -0.05585299488320965
Bond Position:  [1.6520237]


portfolio before change:  [-3.84930007]
curr_Stock_Price:  98.49833550957712
curr_Factors:  [98.49833551]
mat_Sqrt:  [[0.15]]
grads:  [-0.00279181]
Stock Position:  -0.0027918087715716675
Bond Position:  [-3.57431155]


portfolio before change:  [-3.84763831]
curr_Stock_Price:  97.82308838600989
curr_Factors:  [97.82308839]
mat_Sqrt:  [[0.15]]
grads:  [0.01817313]
Stock Position:  0.018173132535910314
Bond Position:  [-5.62539026]


portfolio before change:  [-3.8388532]
curr_Stock_Price:  98.32584740873399
curr_Factors:  [98.32584741]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.8388532]
Stock Price:  98.35267975975097
PL:  [-3.8388532]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.36884525e-04]
 [-4.08549364e-03]
 [-4.25772305e-03]
 [ 4.07493102e-03]
 [ 4.76757769e-03]
 [ 2.82917984e-02]
 [ 1.09001262e-03]
 [-6.85750948e-03]
 [ 2.30433943e-02]
 [-4.69517164e-03]
 [ 1.66216507e-02]
 [-3.00070305e-02]
 [ 4.21293123e-02]
 [ 6.12999616e-03]
 [-6.90376361e-03]
 [ 1.61293996e-02]
 [ 1.05595835e-02]
 [-1.17803210e-02]
 [-3.74543042e-04]
 [ 1.22219860e-02]
 [ 1.19745628e-02]
 [-3.53140379e-03]
 [ 9.75765398e-03]
 [ 6.37740256e-03]
 [ 4.24940279e-03]
 [ 1.01831181e-02]
 [-5.41664125e-03]
 [ 1.05691209e-02]
 [ 4.81761586e-02]
 [ 5.78843477e-03]
 [ 1.93535481e-02]
 [-4.17951016e-04]
 [-7.89752878e-04]
 [ 8.19904986e-03]
 [ 9.79840958e-03]
 [ 5.69277351e-03]
 [-3.18987660e-02]
 [ 8.63767592e-03]
 [ 1.63239654e-02]
 [-9.31484336e-03]
 [-5.57839319e-03]
 [-1.51639277e-02]
 [ 2.02989886e-02]
 [-4.61367127e-03]
 [ 1.04418236e-02]
 [-1.63005266e-02]
 [ 1.52206537e-02]
 [ 1.32088510e-02]
 [ 6.31530500e-03]
 [-7.49486480e-03]
 [-1.43302405e-02]
 [ 3.00269761e-03]
 [-9.02208042e-03]
 [ 5.90759136e-03]
 [-1.37748164e-02]
 [ 2.12573006e-02]
 [ 1.26219638e-02]
 [ 1.20682300e-03]
 [ 1.79472573e-03]
 [ 1.19295655e-02]
 [ 1.06617352e-02]
 [ 2.17503051e-02]
 [ 3.48423331e-03]
 [-1.24683190e-02]
 [ 1.38471434e-02]
 [ 3.95783448e-03]
 [-5.39729091e-03]
 [ 1.53069930e-02]
 [-8.52947560e-03]
 [ 1.43828391e-03]
 [-1.24059640e-02]
 [ 1.38811852e-02]
 [-9.09281458e-03]
 [ 2.69584492e-02]
 [-2.78953097e-02]
 [ 3.14422715e-03]
 [ 4.55422384e-03]
 [-1.37214948e-02]
 [ 2.69056853e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.52873185]
curr_Stock_Price:  101.07207658254025
curr_Factors:  [101.07207658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157923]
Stock Position:  -0.0015792301665294689
Bond Position:  [18.68834792]


portfolio before change:  [18.52918948]
curr_Stock_Price:  101.52193569793438
curr_Factors:  [101.5219357]
mat_Sqrt:  [[0.15]]
grads:  [-0.02723662]
Stock Position:  -0.027236624258153708
Bond Position:  [21.29430429]


portfolio before change:  [18.52850727]
curr_Stock_Price:  101.59584873248308
curr_Factors:  [101.59584873]
mat_Sqrt:  [[0.15]]
grads:  [-0.02838482]
Stock Position:  -0.028384820340163118
Bond Position:  [21.41228719]


portfolio before change:  [18.54506737]
curr_Stock_Price:  101.0595835174906
curr_Factors:  [101.05958352]
mat_Sqrt:  [[0.15]]
grads:  [0.02716621]
Stock Position:  0.027166206770012528
Bond Position:  [15.79966183]


portfolio before change:  [18.53244795]
curr_Stock_Price:  100.5587062731633
curr_Factors:  [100.55870627]
mat_Sqrt:  [[0.15]]
grads:  [0.03178385]
Stock Position:  0.03178385126430158
Bond Position:  [15.33630499]


portfolio before change:  [18.53646113]
curr_Stock_Price:  100.65481268523766
curr_Factors:  [100.65481269]
mat_Sqrt:  [[0.15]]
grads:  [0.18861199]
Stock Position:  0.18861198963996434
Bond Position:  [-0.44824336]


portfolio before change:  [18.58759099]
curr_Stock_Price:  100.92604609579791
curr_Factors:  [100.9260461]
mat_Sqrt:  [[0.15]]
grads:  [0.00726675]
Stock Position:  0.0072667507900750486
Bond Position:  [17.85418656]


portfolio before change:  [18.58948814]
curr_Stock_Price:  101.0335535647823
curr_Factors:  [101.03355356]
mat_Sqrt:  [[0.15]]
grads:  [-0.04571673]
Stock Position:  -0.04571672989952249
Bond Position:  [23.20841182]


portfolio before change:  [18.5800211]
curr_Stock_Price:  101.27236360562767
curr_Factors:  [101.27236361]
mat_Sqrt:  [[0.15]]
grads:  [0.15362263]
Stock Position:  0.15362262875866667
Bond Position:  [3.02229438]


portfolio before change:  [18.69307202]
curr_Stock_Price:  102.00703420710921
curr_Factors:  [102.00703421]
mat_Sqrt:  [[0.15]]
grads:  [-0.03130114]
Stock Position:  -0.03130114424661088
Bond Position:  [21.88600892]


portfolio before change:  [18.72791901]
curr_Stock_Price:  100.93745462957038
curr_Factors:  [100.93745463]
mat_Sqrt:  [[0.15]]
grads:  [0.110811]
Stock Position:  0.11081100499655379
Bond Position:  [7.54293822]


portfolio before change:  [18.72630285]
curr_Stock_Price:  100.91861528715968
curr_Factors:  [100.91861529]
mat_Sqrt:  [[0.15]]
grads:  [-0.20004687]
Stock Position:  -0.20004686998402105
Bond Position:  [38.91475596]


portfolio before change:  [18.62442719]
curr_Stock_Price:  101.44003262756291
curr_Factors:  [101.44003263]
mat_Sqrt:  [[0.15]]
grads:  [0.28086208]
Stock Position:  0.2808620821889248
Bond Position:  [-9.86623159]


portfolio before change:  [18.70775941]
curr_Stock_Price:  101.73892980576771
curr_Factors:  [101.73892981]
mat_Sqrt:  [[0.15]]
grads:  [0.04086664]
Stock Position:  0.040866641070275565
Bond Position:  [14.55003109]


portfolio before change:  [18.68828599]
curr_Stock_Price:  101.24016520735618
curr_Factors:  [101.24016521]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602509]
Stock Position:  -0.04602509071509572
Bond Position:  [23.34787377]


portfolio before change:  [18.72118584]
curr_Stock_Price:  100.55704735506357
curr_Factors:  [100.55704736]
mat_Sqrt:  [[0.15]]
grads:  [0.10752933]
Stock Position:  0.10752933047218491
Bond Position:  [7.90835386]


portfolio before change:  [18.77366652]
curr_Stock_Price:  101.0405098699954
curr_Factors:  [101.04050987]
mat_Sqrt:  [[0.15]]
grads:  [0.07039722]
Stock Position:  0.07039722323566994
Bond Position:  [11.66069519]


portfolio before change:  [18.74166875]
curr_Stock_Price:  100.57562521671097
curr_Factors:  [100.57562522]
mat_Sqrt:  [[0.15]]
grads:  [-0.07853547]
Stock Position:  -0.07853547339213707
Bond Position:  [26.64042309]


portfolio before change:  [18.80050672]
curr_Stock_Price:  99.84763713542526
curr_Factors:  [99.84763714]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249695]
Stock Position:  -0.0024969536163319565
Bond Position:  [19.04982164]


portfolio before change:  [18.80117133]
curr_Stock_Price:  100.05831116594834
curr_Factors:  [100.05831117]
mat_Sqrt:  [[0.15]]
grads:  [0.08147991]
Stock Position:  0.08147990656871704
Bond Position:  [10.64842948]


portfolio before change:  [18.8474655]
curr_Stock_Price:  100.61830970990229
curr_Factors:  [100.61830971]
mat_Sqrt:  [[0.15]]
grads:  [0.07983042]
Stock Position:  0.07983041873608697
Bond Position:  [10.81506371]


portfolio before change:  [18.93064944]
curr_Stock_Price:  101.65185030704382
curr_Factors:  [101.65185031]
mat_Sqrt:  [[0.15]]
grads:  [-0.02354269]
Stock Position:  -0.02354269193590852
Bond Position:  [21.32380764]


portfolio before change:  [18.93240895]
curr_Stock_Price:  101.63372480809113
curr_Factors:  [101.63372481]
mat_Sqrt:  [[0.15]]
grads:  [0.06505103]
Stock Position:  0.06505102652075981
Bond Position:  [12.32103082]


portfolio before change:  [18.94006464]
curr_Stock_Price:  101.7395740557345
curr_Factors:  [101.73957406]
mat_Sqrt:  [[0.15]]
grads:  [0.04251602]
Stock Position:  0.04251601705313034
Bond Position:  [14.61450317]


portfolio before change:  [18.97591368]
curr_Stock_Price:  102.56127859743336
curr_Factors:  [102.5612786]
mat_Sqrt:  [[0.15]]
grads:  [0.02832935]
Stock Position:  0.02832935193030155
Bond Position:  [16.07041912]


portfolio before change:  [18.95955817]
curr_Stock_Price:  101.94848861614558
curr_Factors:  [101.94848862]
mat_Sqrt:  [[0.15]]
grads:  [0.06788745]
Stock Position:  0.06788745402879787
Bond Position:  [12.03853483]


portfolio before change:  [18.96233263]
curr_Stock_Price:  101.97827367583967
curr_Factors:  [101.97827368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611094]
Stock Position:  -0.03611094164214811
Bond Position:  [22.64486412]


portfolio before change:  [18.94705382]
curr_Stock_Price:  102.44057564920158
curr_Factors:  [102.44057565]
mat_Sqrt:  [[0.15]]
grads:  [0.07046081]
Stock Position:  0.07046080600572313
Bond Position:  [11.72900829]


portfolio before change:  [19.0223512]
curr_Stock_Price:  103.49881361064789
curr_Factors:  [103.49881361]
mat_Sqrt:  [[0.15]]
grads:  [0.32117439]
Stock Position:  0.3211743904596291
Bond Position:  [-14.21881717]


portfolio before change:  [19.21855346]
curr_Stock_Price:  104.11247076170513
curr_Factors:  [104.11247076]
mat_Sqrt:  [[0.15]]
grads:  [0.03858957]
Stock Position:  0.038589565160571854
Bond Position:  [15.20089849]


portfolio before change:  [19.2197779]
curr_Stock_Price:  104.1195802571677
curr_Factors:  [104.11958026]
mat_Sqrt:  [[0.15]]
grads:  [0.12902365]
Stock Position:  0.1290236539900752
Bond Position:  [5.7858892]


portfolio before change:  [19.20339622]
curr_Stock_Price:  103.98981096975898
curr_Factors:  [103.98981097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00278634]
Stock Position:  -0.0027863401050790978
Bond Position:  [19.4931472]


portfolio before change:  [19.20543484]
curr_Stock_Price:  103.69542510325772
curr_Factors:  [103.6954251]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526502]
Stock Position:  -0.005265019189868685
Bond Position:  [19.75139324]


portfolio before change:  [19.20487112]
curr_Stock_Price:  104.03696668185125
curr_Factors:  [104.03696668]
mat_Sqrt:  [[0.15]]
grads:  [0.05466033]
Stock Position:  0.05466033239850933
Bond Position:  [13.51817594]


portfolio before change:  [19.25383961]
curr_Stock_Price:  104.91737810073619
curr_Factors:  [104.9173781]
mat_Sqrt:  [[0.15]]
grads:  [0.06532273]
Stock Position:  0.0653227305196479
Bond Position:  [12.40034999]


portfolio before change:  [19.25273224]
curr_Stock_Price:  104.88856095631638
curr_Factors:  [104.88856096]
mat_Sqrt:  [[0.15]]
grads:  [0.03795182]
Stock Position:  0.0379518233717216
Bond Position:  [15.2720201]


portfolio before change:  [19.26843632]
curr_Stock_Price:  105.27719966192427
curr_Factors:  [105.27719966]
mat_Sqrt:  [[0.15]]
grads:  [-0.21265844]
Stock Position:  -0.21265843976503424
Bond Position:  [41.65652134]


portfolio before change:  [19.31146384]
curr_Stock_Price:  105.08711123251715
curr_Factors:  [105.08711123]
mat_Sqrt:  [[0.15]]
grads:  [0.05758451]
Stock Position:  0.057584506130259894
Bond Position:  [13.26007444]


portfolio before change:  [19.31278196]
curr_Stock_Price:  105.09560892787836
curr_Factors:  [105.09560893]
mat_Sqrt:  [[0.15]]
grads:  [0.10882644]
Stock Position:  0.10882643595566312
Bond Position:  [7.87560141]


portfolio before change:  [19.39272479]
curr_Stock_Price:  105.82567595105515
curr_Factors:  [105.82567595]
mat_Sqrt:  [[0.15]]
grads:  [-0.06209896]
Stock Position:  -0.06209895573105334
Bond Position:  [25.96438876]


portfolio before change:  [19.42664923]
curr_Stock_Price:  105.30551240875657
curr_Factors:  [105.30551241]
mat_Sqrt:  [[0.15]]
grads:  [-0.03718929]
Stock Position:  -0.037189287957337176
Bond Position:  [23.34288626]


portfolio before change:  [19.44693192]
curr_Stock_Price:  104.79935276244566
curr_Factors:  [104.79935276]
mat_Sqrt:  [[0.15]]
grads:  [-0.10109285]
Stock Position:  -0.10109285130383018
Bond Position:  [30.04139731]


portfolio before change:  [19.44510746]
curr_Stock_Price:  104.83597360752105
curr_Factors:  [104.83597361]
mat_Sqrt:  [[0.15]]
grads:  [0.13532659]
Stock Position:  0.1353265904967919
Bond Position:  [5.25801259]


portfolio before change:  [19.4745126]
curr_Stock_Price:  105.05083526781318
curr_Factors:  [105.05083527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075781]
Stock Position:  -0.03075780849973771
Bond Position:  [22.70564607]


portfolio before change:  [19.49144797]
curr_Stock_Price:  104.54637061920167
curr_Factors:  [104.54637062]
mat_Sqrt:  [[0.15]]
grads:  [0.06961216]
Stock Position:  0.06961215719983636
Bond Position:  [12.21374958]


portfolio before change:  [19.48671276]
curr_Stock_Price:  104.46738157622507
curr_Factors:  [104.46738158]
mat_Sqrt:  [[0.15]]
grads:  [-0.10867018]
Stock Position:  -0.10867017759938975
Bond Position:  [30.83920166]


portfolio before change:  [19.48227501]
curr_Stock_Price:  104.5259556402307
curr_Factors:  [104.52595564]
mat_Sqrt:  [[0.15]]
grads:  [0.10147102]
Stock Position:  0.10147102461356464
Bond Position:  [8.87591919]


portfolio before change:  [19.47429029]
curr_Stock_Price:  104.44179873133348
curr_Factors:  [104.44179873]
mat_Sqrt:  [[0.15]]
grads:  [0.08805901]
Stock Position:  0.08805900667487858
Bond Position:  [10.27724923]


portfolio before change:  [19.49455352]
curr_Stock_Price:  104.664613970261
curr_Factors:  [104.66461397]
mat_Sqrt:  [[0.15]]
grads:  [0.04210203]
Stock Position:  0.04210203332813333
Bond Position:  [15.08796046]


portfolio before change:  [19.49523586]
curr_Stock_Price:  104.65842212247496
curr_Factors:  [104.65842212]
mat_Sqrt:  [[0.15]]
grads:  [-0.04996577]
Stock Position:  -0.04996576535033641
Bond Position:  [24.72457402]


portfolio before change:  [19.52101011]
curr_Stock_Price:  104.17351184184392
curr_Factors:  [104.17351184]
mat_Sqrt:  [[0.15]]
grads:  [-0.09553494]
Stock Position:  -0.09553493673715864
Bond Position:  [29.47321997]


portfolio before change:  [19.53921901]
curr_Stock_Price:  104.00219479181615
curr_Factors:  [104.00219479]
mat_Sqrt:  [[0.15]]
grads:  [0.02001798]
Stock Position:  0.020017984076955375
Bond Position:  [17.45730473]


portfolio before change:  [19.53866349]
curr_Stock_Price:  103.91993736443115
curr_Factors:  [103.91993736]
mat_Sqrt:  [[0.15]]
grads:  [-0.0601472]
Stock Position:  -0.060147202777302386
Bond Position:  [25.78915704]


portfolio before change:  [19.49957947]
curr_Stock_Price:  104.59654227395129
curr_Factors:  [104.59654227]
mat_Sqrt:  [[0.15]]
grads:  [0.03938394]
Stock Position:  0.03938394239643524
Bond Position:  [15.38015528]


portfolio before change:  [19.51540505]
curr_Stock_Price:  104.97396221704352
curr_Factors:  [104.97396222]
mat_Sqrt:  [[0.15]]
grads:  [-0.09183211]
Stock Position:  -0.09183210951377452
Bond Position:  [29.15538544]


portfolio before change:  [19.48284704]
curr_Stock_Price:  105.34834409155566
curr_Factors:  [105.34834409]
mat_Sqrt:  [[0.15]]
grads:  [0.14171534]
Stock Position:  0.14171533729462124
Bond Position:  [4.55337092]


portfolio before change:  [19.47024939]
curr_Stock_Price:  105.25744186012722
curr_Factors:  [105.25744186]
mat_Sqrt:  [[0.15]]
grads:  [0.08414643]
Stock Position:  0.08414642536272536
Bond Position:  [10.61321192]


portfolio before change:  [19.49417728]
curr_Stock_Price:  105.53391871749801
curr_Factors:  [105.53391872]
mat_Sqrt:  [[0.15]]
grads:  [0.00804549]
Stock Position:  0.008045486684389988
Bond Position:  [18.64510554]


portfolio before change:  [19.48541044]
curr_Stock_Price:  104.29941302824481
curr_Factors:  [104.29941303]
mat_Sqrt:  [[0.15]]
grads:  [0.01196484]
Stock Position:  0.011964838179903037
Bond Position:  [18.23748484]


portfolio before change:  [19.4872323]
curr_Stock_Price:  104.3564122914375
curr_Factors:  [104.35641229]
mat_Sqrt:  [[0.15]]
grads:  [0.07953044]
Stock Position:  0.07953043655998351
Bond Position:  [11.18772127]


portfolio before change:  [19.51954962]
curr_Stock_Price:  104.75397159986147
curr_Factors:  [104.7539716]
mat_Sqrt:  [[0.15]]
grads:  [0.07107823]
Stock Position:  0.07107823468101895
Bond Position:  [12.07382224]


portfolio before change:  [19.45421269]
curr_Stock_Price:  103.8241290917704
curr_Factors:  [103.82412909]
mat_Sqrt:  [[0.15]]
grads:  [0.14500203]
Stock Position:  0.14500203423451857
Bond Position:  [4.39950277]


portfolio before change:  [19.49566418]
curr_Stock_Price:  104.10810101070663
curr_Factors:  [104.10810101]
mat_Sqrt:  [[0.15]]
grads:  [0.02322822]
Stock Position:  0.023228222056503867
Bond Position:  [17.07741809]


portfolio before change:  [19.50300065]
curr_Stock_Price:  104.37799249187889
curr_Factors:  [104.37799249]
mat_Sqrt:  [[0.15]]
grads:  [-0.08312213]
Stock Position:  -0.08312212685058039
Bond Position:  [28.17912138]


portfolio before change:  [19.44897995]
curr_Stock_Price:  105.04907670888642
curr_Factors:  [105.04907671]
mat_Sqrt:  [[0.15]]
grads:  [0.09231429]
Stock Position:  0.09231428916761555
Bond Position:  [9.75144911]


portfolio before change:  [19.37424478]
curr_Stock_Price:  104.2329012814167
curr_Factors:  [104.23290128]
mat_Sqrt:  [[0.15]]
grads:  [0.02638556]
Stock Position:  0.026385563188443192
Bond Position:  [16.62400098]


portfolio before change:  [19.36841435]
curr_Stock_Price:  103.97255195860787
curr_Factors:  [103.97255196]
mat_Sqrt:  [[0.15]]
grads:  [-0.03598194]
Stock Position:  -0.03598193940181789
Bond Position:  [23.10954842]


portfolio before change:  [19.35984858]
curr_Stock_Price:  104.25075151419496
curr_Factors:  [104.25075151]
mat_Sqrt:  [[0.15]]
grads:  [0.10204662]
Stock Position:  0.10204662003996251
Bond Position:  [8.72141175]


portfolio before change:  [19.37583621]
curr_Stock_Price:  104.40207964256462
curr_Factors:  [104.40207964]
mat_Sqrt:  [[0.15]]
grads:  [-0.05686317]
Stock Position:  -0.05686317066713582
Bond Position:  [25.31246949]


portfolio before change:  [19.41160254]
curr_Stock_Price:  103.8009128350506
curr_Factors:  [103.80091284]
mat_Sqrt:  [[0.15]]
grads:  [0.00958856]
Stock Position:  0.00958855942321174
Bond Position:  [18.41630132]


portfolio before change:  [19.42048189]
curr_Stock_Price:  104.60690354119667
curr_Factors:  [104.60690354]
mat_Sqrt:  [[0.15]]
grads:  [-0.08270643]
Stock Position:  -0.08270642668745783
Bond Position:  [28.07214509]


portfolio before change:  [19.40946248]
curr_Stock_Price:  104.7613531242783
curr_Factors:  [104.76135312]
mat_Sqrt:  [[0.15]]
grads:  [0.09254123]
Stock Position:  0.09254123483851377
Bond Position:  [9.7147175]


portfolio before change:  [19.43361238]
curr_Stock_Price:  105.01575553934794
curr_Factors:  [105.01575554]
mat_Sqrt:  [[0.15]]
grads:  [-0.06061876]
Stock Position:  -0.06061876387481865
Bond Position:  [25.79953767]


portfolio before change:  [19.40397965]
curr_Stock_Price:  105.53119412419797
curr_Factors:  [105.53119412]
mat_Sqrt:  [[0.15]]
grads:  [0.17972299]
Stock Position:  0.17972299482345108
Bond Position:  [0.4375974]


portfolio before change:  [19.57091491]
curr_Stock_Price:  106.45988948537729
curr_Factors:  [106.45988949]
mat_Sqrt:  [[0.15]]
grads:  [-0.18596873]
Stock Position:  -0.1859687315246511
Bond Position:  [39.36912552]


portfolio before change:  [19.69385734]
curr_Stock_Price:  105.81202905123476
curr_Factors:  [105.81202905]
mat_Sqrt:  [[0.15]]
grads:  [0.02096151]
Stock Position:  0.02096151432416161
Bond Position:  [17.47587698]


portfolio before change:  [19.70399507]
curr_Stock_Price:  106.24355559892864
curr_Factors:  [106.2435556]
mat_Sqrt:  [[0.15]]
grads:  [0.03036149]
Stock Position:  0.030361492271763
Bond Position:  [16.47828218]


portfolio before change:  [19.70166608]
curr_Stock_Price:  106.13292477141596
curr_Factors:  [106.13292477]
mat_Sqrt:  [[0.15]]
grads:  [-0.09147663]
Stock Position:  -0.09147663194502362
Bond Position:  [29.41034858]


portfolio before change:  [19.79407281]
curr_Stock_Price:  105.14285192982324
curr_Factors:  [105.14285193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.79407281]
Stock Price:  105.97924950334924
PL:  [13.81482331]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.55875749e-04]
 [ 1.54633940e-03]
 [-8.81362966e-04]
 [ 6.76425852e-03]
 [-6.08315137e-03]
 [ 1.58087226e-02]
 [ 1.85069240e-03]
 [-1.78343507e-02]
 [ 5.34386141e-03]
 [ 2.21987695e-02]
 [ 1.51907128e-02]
 [ 1.96189957e-02]
 [-1.36218979e-02]
 [ 4.25075164e-03]
 [-7.01884705e-03]
 [ 1.05983275e-02]
 [ 9.57446819e-03]
 [ 5.34031208e-04]
 [ 2.33149528e-03]
 [ 8.46267417e-03]
 [ 1.25289069e-02]
 [-1.02584261e-02]
 [ 3.43370637e-03]
 [-2.26035163e-02]
 [-9.53763402e-03]
 [-9.44013584e-03]
 [-2.88556493e-03]
 [ 7.92730634e-03]
 [-1.08819995e-02]
 [-1.00835862e-03]
 [-6.68134289e-03]
 [-1.04290584e-02]
 [-5.35432295e-03]
 [ 4.57341554e-03]
 [ 1.19219405e-02]
 [ 1.35807538e-02]
 [-3.50889190e-02]
 [ 9.36766754e-03]
 [-6.39550059e-03]
 [ 2.26165652e-02]
 [-6.07709662e-03]
 [-1.41449263e-02]
 [ 2.29926584e-02]
 [ 2.50410590e-03]
 [-7.65662350e-03]
 [ 1.02447286e-03]
 [ 7.30503957e-03]
 [-8.20377027e-03]
 [-1.48819310e-02]
 [-6.13539958e-03]
 [ 4.71622125e-02]
 [-1.00405124e-02]
 [ 3.13187347e-03]
 [ 5.25962879e-03]
 [ 5.61167324e-03]
 [-3.41934170e-03]
 [ 6.71530014e-03]
 [-2.28667569e-04]
 [ 1.53404355e-03]
 [-2.52489658e-03]
 [-6.37564906e-04]
 [ 2.16988950e-03]
 [ 1.21061168e-02]
 [-1.83985268e-02]
 [-1.18121333e-02]
 [-1.84704222e-03]
 [-5.01714939e-03]
 [ 2.13598281e-02]
 [-8.87908524e-03]
 [ 6.04899852e-03]
 [-7.35839600e-03]
 [ 1.08970309e-02]
 [-4.72395743e-03]
 [ 8.34446875e-03]
 [-1.88127031e-02]
 [-4.26803625e-03]
 [-8.00122397e-03]
 [-1.53764120e-03]
 [ 6.49082042e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.18926607]
curr_Stock_Price:  100.33472828636638
curr_Factors:  [100.33472829]
mat_Sqrt:  [[0.15]]
grads:  [0.00103917]
Stock Position:  0.0010391716576893038
Bond Position:  [7.08500107]


portfolio before change:  [7.18923743]
curr_Stock_Price:  99.88103578763327
curr_Factors:  [99.88103579]
mat_Sqrt:  [[0.15]]
grads:  [0.01030893]
Stock Position:  0.010308929361458993
Bond Position:  [6.15957089]


portfolio before change:  [7.18517158]
curr_Stock_Price:  99.44928968492133
curr_Factors:  [99.44928968]
mat_Sqrt:  [[0.15]]
grads:  [-0.00587575]
Stock Position:  -0.005875753106833921
Bond Position:  [7.76951105]


portfolio before change:  [7.18959589]
curr_Stock_Price:  98.77895868010096
curr_Factors:  [98.77895868]
mat_Sqrt:  [[0.15]]
grads:  [0.04509506]
Stock Position:  0.045095056775108146
Bond Position:  [2.73515314]


portfolio before change:  [7.15970439]
curr_Stock_Price:  98.1123125397433
curr_Factors:  [98.11231254]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055434]
Stock Position:  -0.04055434246129023
Bond Position:  [11.13858472]


portfolio before change:  [7.13810307]
curr_Stock_Price:  98.66213049577344
curr_Factors:  [98.6621305]
mat_Sqrt:  [[0.15]]
grads:  [0.10539148]
Stock Position:  0.1053914841163915
Bond Position:  [-3.26004529]


portfolio before change:  [7.14952457]
curr_Stock_Price:  98.77243596115247
curr_Factors:  [98.77243596]
mat_Sqrt:  [[0.15]]
grads:  [0.01233795]
Stock Position:  0.012337949302603188
Bond Position:  [5.93087526]


portfolio before change:  [7.15818656]
curr_Stock_Price:  99.44445231547633
curr_Factors:  [99.44445232]
mat_Sqrt:  [[0.15]]
grads:  [-0.11889567]
Stock Position:  -0.11889567158864667
Bond Position:  [18.98170151]


portfolio before change:  [7.20011472]
curr_Stock_Price:  99.10178415561845
curr_Factors:  [99.10178416]
mat_Sqrt:  [[0.15]]
grads:  [0.03562574]
Stock Position:  0.035625742738219675
Bond Position:  [3.66954005]


portfolio before change:  [7.18583706]
curr_Stock_Price:  98.69457816381404
curr_Factors:  [98.69457816]
mat_Sqrt:  [[0.15]]
grads:  [0.1479918]
Stock Position:  0.14799179674596463
Bond Position:  [-7.4201509]


portfolio before change:  [7.25033526]
curr_Stock_Price:  99.1335347632281
curr_Factors:  [99.13353476]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-2.78905842]


portfolio before change:  [7.23111965]
curr_Stock_Price:  98.94551248479071
curr_Factors:  [98.94551248]
mat_Sqrt:  [[0.15]]
grads:  [0.1307933]
Stock Position:  0.13079330472207912
Bond Position:  [-5.71029091]


portfolio before change:  [7.23483554]
curr_Stock_Price:  98.97665162705869
curr_Factors:  [98.97665163]
mat_Sqrt:  [[0.15]]
grads:  [-0.09081265]
Stock Position:  -0.09081265264347839
Bond Position:  [16.22316782]


portfolio before change:  [7.33183549]
curr_Stock_Price:  97.9196846960017
curr_Factors:  [97.9196847]
mat_Sqrt:  [[0.15]]
grads:  [0.02833834]
Stock Position:  0.028338344241329427
Bond Position:  [4.55695376]


portfolio before change:  [7.3243818]
curr_Stock_Price:  97.6466090189289
curr_Factors:  [97.64660902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04679231]
Stock Position:  -0.046792313660594456
Bond Position:  [11.89349255]


portfolio before change:  [7.34144958]
curr_Stock_Price:  97.29773943865904
curr_Factors:  [97.29773944]
mat_Sqrt:  [[0.15]]
grads:  [0.07065552]
Stock Position:  0.07065551648620455
Bond Position:  [0.46682755]


portfolio before change:  [7.38900664]
curr_Stock_Price:  97.97040996874905
curr_Factors:  [97.97040997]
mat_Sqrt:  [[0.15]]
grads:  [0.06382979]
Stock Position:  0.06382978790277898
Bond Position:  [1.13557615]


portfolio before change:  [7.3586871]
curr_Stock_Price:  97.49429191203596
curr_Factors:  [97.49429191]
mat_Sqrt:  [[0.15]]
grads:  [0.00356021]
Stock Position:  0.00356020805548779
Bond Position:  [7.01158714]


portfolio before change:  [7.35885159]
curr_Stock_Price:  97.41740197748358
curr_Factors:  [97.41740198]
mat_Sqrt:  [[0.15]]
grads:  [0.0155433]
Stock Position:  0.015543301843644837
Bond Position:  [5.84466351]


portfolio before change:  [7.35698381]
curr_Stock_Price:  97.2737328955057
curr_Factors:  [97.2737329]
mat_Sqrt:  [[0.15]]
grads:  [0.05641783]
Stock Position:  0.05641782781491097
Bond Position:  [1.86901109]


portfolio before change:  [7.37397244]
curr_Stock_Price:  97.57278412464795
curr_Factors:  [97.57278412]
mat_Sqrt:  [[0.15]]
grads:  [0.08352605]
Stock Position:  0.08352604631666465
Bond Position:  [-0.77589644]


portfolio before change:  [7.33247503]
curr_Stock_Price:  97.07654468163744
curr_Factors:  [97.07654468]
mat_Sqrt:  [[0.15]]
grads:  [-0.06838951]
Stock Position:  -0.06838950738544451
Bond Position:  [13.9714921]


portfolio before change:  [7.34154432]
curr_Stock_Price:  96.95670111022206
curr_Factors:  [96.95670111]
mat_Sqrt:  [[0.15]]
grads:  [0.02289138]
Stock Position:  0.022891375817232894
Bond Position:  [5.12207203]


portfolio before change:  [7.34816588]
curr_Stock_Price:  97.2319760439149
curr_Factors:  [97.23197604]
mat_Sqrt:  [[0.15]]
grads:  [-0.15069011]
Stock Position:  -0.15069010895072787
Bond Position:  [22.00006294]


portfolio before change:  [7.27159716]
curr_Stock_Price:  97.74922145403231
curr_Factors:  [97.74922145]
mat_Sqrt:  [[0.15]]
grads:  [-0.06358423]
Stock Position:  -0.06358422682446421
Bond Position:  [13.48690583]


portfolio before change:  [7.25455341]
curr_Stock_Price:  98.03052871633584
curr_Factors:  [98.03052872]
mat_Sqrt:  [[0.15]]
grads:  [-0.06293424]
Stock Position:  -0.06293423896032996
Bond Position:  [13.42403013]


portfolio before change:  [7.26546218]
curr_Stock_Price:  97.87052453436561
curr_Factors:  [97.87052453]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192371]
Stock Position:  -0.019237099544157418
Bond Position:  [9.1482072]


portfolio before change:  [7.26124537]
curr_Stock_Price:  98.11944955847814
curr_Factors:  [98.11944956]
mat_Sqrt:  [[0.15]]
grads:  [0.05284871]
Stock Position:  0.052848708912048084
Bond Position:  [2.07575914]


portfolio before change:  [7.3219868]
curr_Stock_Price:  99.26634027108062
curr_Factors:  [99.26634027]
mat_Sqrt:  [[0.15]]
grads:  [-0.07254666]
Stock Position:  -0.07254666320551854
Bond Position:  [14.52342856]


portfolio before change:  [7.35599474]
curr_Stock_Price:  98.81007952388909
curr_Factors:  [98.81007952]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672239]
Stock Position:  -0.006722390831684003
Bond Position:  [8.02023471]


portfolio before change:  [7.35469876]
curr_Stock_Price:  99.07743389523881
curr_Factors:  [99.0774339]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454229]
Stock Position:  -0.044542285963198765
Bond Position:  [11.76783415]


portfolio before change:  [7.38017877]
curr_Stock_Price:  98.52190569967965
curr_Factors:  [98.5219057]
mat_Sqrt:  [[0.15]]
grads:  [-0.06952706]
Stock Position:  -0.06952705594804084
Bond Position:  [14.23011681]


portfolio before change:  [7.34790614]
curr_Stock_Price:  98.99887157137135
curr_Factors:  [98.99887157]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569549]
Stock Position:  -0.0356954863167932
Bond Position:  [10.88171901]


portfolio before change:  [7.35760155]
curr_Stock_Price:  98.74631087812554
curr_Factors:  [98.74631088]
mat_Sqrt:  [[0.15]]
grads:  [0.03048944]
Stock Position:  0.03048943696274739
Bond Position:  [4.34688213]


portfolio before change:  [7.38387921]
curr_Stock_Price:  99.59926128934566
curr_Factors:  [99.59926129]
mat_Sqrt:  [[0.15]]
grads:  [0.0794796]
Stock Position:  0.0794796033414983
Bond Position:  [-0.53223057]


portfolio before change:  [7.37467699]
curr_Stock_Price:  99.48389892547328
curr_Factors:  [99.48389893]
mat_Sqrt:  [[0.15]]
grads:  [0.09053836]
Stock Position:  0.090538358691297
Bond Position:  [-1.63243193]


portfolio before change:  [7.34413722]
curr_Stock_Price:  99.14771272611594
curr_Factors:  [99.14771273]
mat_Sqrt:  [[0.15]]
grads:  [-0.23392613]
Stock Position:  -0.2339261264661087
Bond Position:  [30.5373776]


portfolio before change:  [7.33619327]
curr_Stock_Price:  99.1898311019538
curr_Factors:  [99.1898311]
mat_Sqrt:  [[0.15]]
grads:  [0.06245112]
Stock Position:  0.06245111694036761
Bond Position:  [1.14167753]


portfolio before change:  [7.40230544]
curr_Stock_Price:  100.24731118790271
curr_Factors:  [100.24731119]
mat_Sqrt:  [[0.15]]
grads:  [-0.04263667]
Stock Position:  -0.042636670586849786
Bond Position:  [11.67651703]


portfolio before change:  [7.39642654]
curr_Stock_Price:  100.40231170626869
curr_Factors:  [100.40231171]
mat_Sqrt:  [[0.15]]
grads:  [0.1507771]
Stock Position:  0.15077710122200277
Bond Position:  [-7.74194297]


portfolio before change:  [7.4114635]
curr_Stock_Price:  100.50525070233577
curr_Factors:  [100.5052507]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051398]
Stock Position:  -0.04051397747936413
Bond Position:  [11.48333096]


portfolio before change:  [7.40725282]
curr_Stock_Price:  100.62689795586525
curr_Factors:  [100.62689796]
mat_Sqrt:  [[0.15]]
grads:  [-0.09429951]
Stock Position:  -0.09429950899769116
Bond Position:  [16.89631989]


portfolio before change:  [7.38906532]
curr_Stock_Price:  100.83096630257913
curr_Factors:  [100.8309663]
mat_Sqrt:  [[0.15]]
grads:  [0.15328439]
Stock Position:  0.15328438928470345
Bond Position:  [-8.06674777]


portfolio before change:  [7.42158475]
curr_Stock_Price:  101.04640644984954
curr_Factors:  [101.04640645]
mat_Sqrt:  [[0.15]]
grads:  [0.01669404]
Stock Position:  0.016694039345283216
Bond Position:  [5.73471206]


portfolio before change:  [7.4139667]
curr_Stock_Price:  100.56860213483746
curr_Factors:  [100.56860213]
mat_Sqrt:  [[0.15]]
grads:  [-0.05104416]
Stock Position:  -0.051044156692701646
Bond Position:  [12.54740618]


portfolio before change:  [7.4173383]
curr_Stock_Price:  100.51791340321437
curr_Factors:  [100.5179134]
mat_Sqrt:  [[0.15]]
grads:  [0.00682982]
Stock Position:  0.006829819067133587
Bond Position:  [6.73081913]


portfolio before change:  [7.41615417]
curr_Stock_Price:  100.2829409095233
curr_Factors:  [100.28294091]
mat_Sqrt:  [[0.15]]
grads:  [0.04870026]
Stock Position:  0.048700263781948736
Bond Position:  [2.53234849]


portfolio before change:  [7.44295815]
curr_Stock_Price:  100.83007764556827
curr_Factors:  [100.83007765]
mat_Sqrt:  [[0.15]]
grads:  [-0.0546918]
Stock Position:  -0.05469180178714453
Bond Position:  [12.95753677]


portfolio before change:  [7.47861808]
curr_Stock_Price:  100.19286955067166
curr_Factors:  [100.19286955]
mat_Sqrt:  [[0.15]]
grads:  [-0.09921287]
Stock Position:  -0.0992128730324098
Bond Position:  [17.41904052]


portfolio before change:  [7.54579309]
curr_Stock_Price:  99.52676351598619
curr_Factors:  [99.52676352]
mat_Sqrt:  [[0.15]]
grads:  [-0.04090266]
Stock Position:  -0.04090266385276859
Bond Position:  [11.61670285]


portfolio before change:  [7.5852302]
curr_Stock_Price:  98.58034505865265
curr_Factors:  [98.58034506]
mat_Sqrt:  [[0.15]]
grads:  [0.31441475]
Stock Position:  0.31441475004698843
Bond Position:  [-23.40988435]


portfolio before change:  [7.40339757]
curr_Stock_Price:  98.00667774458384
curr_Factors:  [98.00667774]
mat_Sqrt:  [[0.15]]
grads:  [-0.06693675]
Stock Position:  -0.0669367493667567
Bond Position:  [13.96364599]


portfolio before change:  [7.39717143]
curr_Stock_Price:  98.11273149474722
curr_Factors:  [98.11273149]
mat_Sqrt:  [[0.15]]
grads:  [0.02087916]
Stock Position:  0.02087915647490005
Bond Position:  [5.34866036]


portfolio before change:  [7.40202589]
curr_Stock_Price:  98.32922294608666
curr_Factors:  [98.32922295]
mat_Sqrt:  [[0.15]]
grads:  [0.03506419]
Stock Position:  0.03506419190485571
Bond Position:  [3.95419115]


portfolio before change:  [7.41677818]
curr_Stock_Price:  98.74289704393344
curr_Factors:  [98.74289704]
mat_Sqrt:  [[0.15]]
grads:  [0.03741115]
Stock Position:  0.03741115494375498
Bond Position:  [3.72269236]


portfolio before change:  [7.44016733]
curr_Stock_Price:  99.36186955036702
curr_Factors:  [99.36186955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02279561]
Stock Position:  -0.02279561132612387
Bond Position:  [9.70518189]


portfolio before change:  [7.43491453]
curr_Stock_Price:  99.61891002023783
curr_Factors:  [99.61891002]
mat_Sqrt:  [[0.15]]
grads:  [0.04476867]
Stock Position:  0.0447686675933452
Bond Position:  [2.97510866]


portfolio before change:  [7.40173333]
curr_Stock_Price:  98.87358620433282
curr_Factors:  [98.8735862]
mat_Sqrt:  [[0.15]]
grads:  [-0.00152445]
Stock Position:  -0.0015244504575832585
Bond Position:  [7.55246121]


portfolio before change:  [7.4032802]
curr_Stock_Price:  98.16852382970546
curr_Factors:  [98.16852383]
mat_Sqrt:  [[0.15]]
grads:  [0.01022696]
Stock Position:  0.010226957022731294
Bond Position:  [6.39931493]


portfolio before change:  [7.39832997]
curr_Stock_Price:  97.645376997182
curr_Factors:  [97.645377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01683264]
Stock Position:  -0.01683264388445178
Bond Position:  [9.04195983]


portfolio before change:  [7.39473326]
curr_Stock_Price:  97.8926262834214
curr_Factors:  [97.89262628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00425043]
Stock Position:  -0.004250432704111882
Bond Position:  [7.81081928]


portfolio before change:  [7.39507129]
curr_Stock_Price:  97.92795353487983
curr_Factors:  [97.92795353]
mat_Sqrt:  [[0.15]]
grads:  [0.01446593]
Stock Position:  0.0144659300133976
Bond Position:  [5.97845237]


portfolio before change:  [7.38818472]
curr_Stock_Price:  97.42606837041639
curr_Factors:  [97.42606837]
mat_Sqrt:  [[0.15]]
grads:  [0.08070745]
Stock Position:  0.0807074450616333
Bond Position:  [-0.47482434]


portfolio before change:  [7.39079452]
curr_Stock_Price:  97.45877264787268
curr_Factors:  [97.45877265]
mat_Sqrt:  [[0.15]]
grads:  [-0.12265685]
Stock Position:  -0.12265684552330089
Bond Position:  [19.34478014]


portfolio before change:  [7.28693845]
curr_Stock_Price:  98.31535068938925
curr_Factors:  [98.31535069]
mat_Sqrt:  [[0.15]]
grads:  [-0.07874756]
Stock Position:  -0.0787475555963167
Bond Position:  [15.02903199]


portfolio before change:  [7.25411594]
curr_Stock_Price:  98.74408593542258
curr_Factors:  [98.74408594]
mat_Sqrt:  [[0.15]]
grads:  [-0.01231361]
Stock Position:  -0.012313614811889131
Bond Position:  [8.47001258]


portfolio before change:  [7.25096567]
curr_Stock_Price:  99.04291417261693
curr_Factors:  [99.04291417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03344766]
Stock Position:  -0.03344766260392399
Bond Position:  [10.56371965]


portfolio before change:  [7.25988384]
curr_Stock_Price:  98.79602355681263
curr_Factors:  [98.79602356]
mat_Sqrt:  [[0.15]]
grads:  [0.14239885]
Stock Position:  0.14239885396123614
Bond Position:  [-6.80855669]


portfolio before change:  [7.34496445]
curr_Stock_Price:  99.39649293441802
curr_Factors:  [99.39649293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0591939]
Stock Position:  -0.059193901621333846
Bond Position:  [13.22863067]


portfolio before change:  [7.34702989]
curr_Stock_Price:  99.37556800992463
curr_Factors:  [99.37556801]
mat_Sqrt:  [[0.15]]
grads:  [0.04032666]
Stock Position:  0.04032665682070197
Bond Position:  [3.33954546]


portfolio before change:  [7.32959375]
curr_Stock_Price:  98.93801949066788
curr_Factors:  [98.93801949]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905597]
Stock Position:  -0.04905597332434929
Bond Position:  [12.18309459]


portfolio before change:  [7.34114448]
curr_Stock_Price:  98.71808162608193
curr_Factors:  [98.71808163]
mat_Sqrt:  [[0.15]]
grads:  [0.07264687]
Stock Position:  0.07264687265880661
Bond Position:  [0.16958458]


portfolio before change:  [7.35850887]
curr_Stock_Price:  98.95696025783123
curr_Factors:  [98.95696026]
mat_Sqrt:  [[0.15]]
grads:  [-0.03149305]
Stock Position:  -0.03149304952647474
Bond Position:  [10.47496532]


portfolio before change:  [7.36721471]
curr_Stock_Price:  98.70131223457211
curr_Factors:  [98.70131223]
mat_Sqrt:  [[0.15]]
grads:  [0.05562979]
Stock Position:  0.05562979167644812
Bond Position:  [1.87648127]


portfolio before change:  [7.39235147]
curr_Stock_Price:  99.15106179126215
curr_Factors:  [99.15106179]
mat_Sqrt:  [[0.15]]
grads:  [-0.12541802]
Stock Position:  -0.12541802072534475
Bond Position:  [19.82768139]


portfolio before change:  [7.32464375]
curr_Stock_Price:  99.70079927309851
curr_Factors:  [99.70079927]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845358]
Stock Position:  -0.028453575017058405
Bond Position:  [10.16148792]


portfolio before change:  [7.30242715]
curr_Stock_Price:  100.50392191803205
curr_Factors:  [100.50392192]
mat_Sqrt:  [[0.15]]
grads:  [-0.05334149]
Stock Position:  -0.05334149310984996
Bond Position:  [12.66345641]


portfolio before change:  [7.25007688]
curr_Stock_Price:  101.50017752487912
curr_Factors:  [101.50017752]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025094]
Stock Position:  -0.010250941351365382
Bond Position:  [8.29054925]


portfolio before change:  [7.25956012]
curr_Stock_Price:  100.6256171222728
curr_Factors:  [100.62561712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.25956012]
Stock Price:  100.31226647218458
PL:  [6.94729365]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.97602249e-03]
 [-4.79763301e-03]
 [-2.48245571e-03]
 [ 7.52699984e-03]
 [ 5.98394574e-04]
 [ 1.75817513e-02]
 [ 5.88547985e-04]
 [-1.74923980e-02]
 [ 4.94691042e-03]
 [ 2.08593973e-02]
 [-1.26198488e-02]
 [ 2.07836841e-02]
 [-1.39023893e-02]
 [ 1.12269215e-02]
 [-6.97170631e-03]
 [ 7.82090305e-03]
 [ 9.36426692e-03]
 [-5.48275100e-03]
 [ 1.51374334e-03]
 [ 1.12475739e-02]
 [ 1.17628837e-02]
 [-9.12570502e-03]
 [ 6.75286862e-03]
 [-8.35817546e-03]
 [-8.94814043e-03]
 [-7.01517604e-03]
 [-5.51853838e-03]
 [ 6.18632477e-03]
 [-8.44407805e-03]
 [-2.50769926e-03]
 [ 6.03917628e-03]
 [-1.13830173e-02]
 [-1.79440145e-03]
 [ 4.51716347e-03]
 [ 1.29868557e-02]
 [ 1.74117347e-02]
 [-3.44790038e-02]
 [ 8.24170854e-03]
 [-3.58848224e-02]
 [ 3.12547891e-05]
 [-1.43353442e-02]
 [ 4.48403697e-02]
 [ 2.33105042e-02]
 [ 3.45564682e-03]
 [ 8.74501879e-03]
 [ 2.76901956e-02]
 [-3.52638840e-03]
 [-3.75343990e-03]
 [ 2.38851553e-02]
 [ 7.70315076e-03]
 [ 2.90770393e-02]
 [ 1.07791333e-02]
 [-2.44117194e-05]
 [ 4.58674425e-03]
 [ 4.15293800e-03]
 [ 5.30141877e-03]
 [-2.58986556e-02]
 [ 1.48521233e-03]
 [ 1.65935995e-03]
 [-1.45563459e-01]
 [-1.95678483e-02]
 [ 1.67342159e-02]
 [ 1.92108902e-02]
 [-2.02195377e-02]
 [-4.84046717e-03]
 [-1.68684746e-02]
 [-3.34835429e-03]
 [-1.21097653e-02]
 [-2.37001310e-02]
 [ 1.76677170e-02]
 [ 1.83348121e-02]
 [ 1.30089808e-02]
 [ 1.59671975e-03]
 [ 1.05848873e-02]
 [ 3.14821419e-02]
 [-2.85183124e-02]
 [ 4.17788984e-03]
 [ 1.16035526e-02]
 [ 1.04472246e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.46438386]
curr_Stock_Price:  99.96246805615692
curr_Factors:  [99.96246806]
mat_Sqrt:  [[0.15]]
grads:  [0.01317348]
Stock Position:  0.013173483251760173
Bond Position:  [0.14752996]


portfolio before change:  [1.45706969]
curr_Stock_Price:  99.40654857366276
curr_Factors:  [99.40654857]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198422]
Stock Position:  -0.03198422003691222
Bond Position:  [4.63651061]


portfolio before change:  [1.46687926]
curr_Stock_Price:  99.10890873963858
curr_Factors:  [99.10890874]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165497]
Stock Position:  -0.01654970473703758
Bond Position:  [3.10710243]


portfolio before change:  [1.46752304]
curr_Stock_Price:  99.08174319527404
curr_Factors:  [99.0817432]
mat_Sqrt:  [[0.15]]
grads:  [0.05018]
Stock Position:  0.05017999890173145
Bond Position:  [-3.50439873]


portfolio before change:  [1.46404316]
curr_Stock_Price:  99.01676017727888
curr_Factors:  [99.01676018]
mat_Sqrt:  [[0.15]]
grads:  [0.0039893]
Stock Position:  0.003989297161376832
Bond Position:  [1.06903588]


portfolio before change:  [1.46382156]
curr_Stock_Price:  98.94446279660586
curr_Factors:  [98.9444628]
mat_Sqrt:  [[0.15]]
grads:  [0.11721168]
Stock Position:  0.11721167546188023
Bond Position:  [-10.1336247]


portfolio before change:  [1.54181695]
curr_Stock_Price:  99.61528981065419
curr_Factors:  [99.61528981]
mat_Sqrt:  [[0.15]]
grads:  [0.00392365]
Stock Position:  0.003923653235168096
Bond Position:  [1.15096109]


portfolio before change:  [1.54063801]
curr_Stock_Price:  99.29648535836657
curr_Factors:  [99.29648536]
mat_Sqrt:  [[0.15]]
grads:  [-0.11661599]
Stock Position:  -0.11661598635788496
Bond Position:  [13.12019559]


portfolio before change:  [1.56632756]
curr_Stock_Price:  99.08322543545924
curr_Factors:  [99.08322544]
mat_Sqrt:  [[0.15]]
grads:  [0.0329794]
Stock Position:  0.032979402788180005
Bond Position:  [-1.70137804]


portfolio before change:  [1.55867551]
curr_Stock_Price:  98.8544246062891
curr_Factors:  [98.85442461]
mat_Sqrt:  [[0.15]]
grads:  [0.13906265]
Stock Position:  0.13906264846999145
Bond Position:  [-12.18828259]


portfolio before change:  [1.48313779]
curr_Stock_Price:  98.31671065147864
curr_Factors:  [98.31671065]
mat_Sqrt:  [[0.15]]
grads:  [-0.08413233]
Stock Position:  -0.08413232541294144
Bond Position:  [9.75475128]


portfolio before change:  [1.44352422]
curr_Stock_Price:  98.79480585027076
curr_Factors:  [98.79480585]
mat_Sqrt:  [[0.15]]
grads:  [0.13855789]
Stock Position:  0.1385578938655596
Bond Position:  [-12.245276]


portfolio before change:  [1.44827297]
curr_Stock_Price:  98.83460222397929
curr_Factors:  [98.83460222]
mat_Sqrt:  [[0.15]]
grads:  [-0.0926826]
Stock Position:  -0.09268259504608994
Bond Position:  [10.60852038]


portfolio before change:  [1.41462931]
curr_Stock_Price:  99.20475487207595
curr_Factors:  [99.20475487]
mat_Sqrt:  [[0.15]]
grads:  [0.07484614]
Stock Position:  0.07484614339556761
Bond Position:  [-6.010464]


portfolio before change:  [1.36568932]
curr_Stock_Price:  98.55589946003765
curr_Factors:  [98.55589946]
mat_Sqrt:  [[0.15]]
grads:  [-0.04647804]
Stock Position:  -0.046478042091517104
Bond Position:  [5.94637456]


portfolio before change:  [1.37784656]
curr_Stock_Price:  98.30232650545135
curr_Factors:  [98.30232651]
mat_Sqrt:  [[0.15]]
grads:  [0.05213935]
Stock Position:  0.05213935368971596
Bond Position:  [-3.74757321]


portfolio before change:  [1.36330759]
curr_Stock_Price:  98.02797070954836
curr_Factors:  [98.02797071]
mat_Sqrt:  [[0.15]]
grads:  [0.06242845]
Stock Position:  0.06242844614344423
Bond Position:  [-4.7564263]


portfolio before change:  [1.35199826]
curr_Stock_Price:  97.8515759808126
curr_Factors:  [97.85157598]
mat_Sqrt:  [[0.15]]
grads:  [-0.03655167]
Stock Position:  -0.03655167336337007
Bond Position:  [4.9286371]


portfolio before change:  [1.34041854]
curr_Stock_Price:  98.17680785701096
curr_Factors:  [98.17680786]
mat_Sqrt:  [[0.15]]
grads:  [0.01009162]
Stock Position:  0.010091622274341055
Bond Position:  [0.34965528]


portfolio before change:  [1.34517401]
curr_Stock_Price:  98.64587163490343
curr_Factors:  [98.64587163]
mat_Sqrt:  [[0.15]]
grads:  [0.07498383]
Stock Position:  0.07498382587763561
Bond Position:  [-6.05167086]


portfolio before change:  [1.36541292]
curr_Stock_Price:  98.92082632970502
curr_Factors:  [98.92082633]
mat_Sqrt:  [[0.15]]
grads:  [0.07841922]
Stock Position:  0.07841922494207207
Bond Position:  [-6.39188161]


portfolio before change:  [1.32476157]
curr_Stock_Price:  98.40753587318773
curr_Factors:  [98.40753587]
mat_Sqrt:  [[0.15]]
grads:  [-0.06083803]
Stock Position:  -0.06083803349411413
Bond Position:  [7.31168254]


portfolio before change:  [1.32997349]
curr_Stock_Price:  98.32937884202128
curr_Factors:  [98.32937884]
mat_Sqrt:  [[0.15]]
grads:  [0.04501912]
Stock Position:  0.045019124165339
Bond Position:  [-3.09672903]


portfolio before change:  [1.30132491]
curr_Stock_Price:  97.69731358103266
curr_Factors:  [97.69731358]
mat_Sqrt:  [[0.15]]
grads:  [-0.05572117]
Stock Position:  -0.055721169724904096
Bond Position:  [6.7451335]


portfolio before change:  [1.28500706]
curr_Stock_Price:  97.99772780684708
curr_Factors:  [97.99772781]
mat_Sqrt:  [[0.15]]
grads:  [-0.05965427]
Stock Position:  -0.059654269548296085
Bond Position:  [7.13098993]


portfolio before change:  [1.24688468]
curr_Stock_Price:  98.64425465942398
curr_Factors:  [98.64425466]
mat_Sqrt:  [[0.15]]
grads:  [-0.04676784]
Stock Position:  -0.0467678402553548
Bond Position:  [5.86026342]


portfolio before change:  [1.23365475]
curr_Stock_Price:  98.93497158585126
curr_Factors:  [98.93497159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03679026]
Stock Position:  -0.03679025587225388
Bond Position:  [4.87349767]


portfolio before change:  [1.22697287]
curr_Stock_Price:  99.1248719668172
curr_Factors:  [99.12487197]
mat_Sqrt:  [[0.15]]
grads:  [0.04124217]
Stock Position:  0.041242165128053836
Bond Position:  [-2.86115147]


portfolio before change:  [1.24650518]
curr_Stock_Price:  99.60280853133395
curr_Factors:  [99.60280853]
mat_Sqrt:  [[0.15]]
grads:  [-0.05629385]
Stock Position:  -0.05629385366542406
Bond Position:  [6.85353111]


portfolio before change:  [1.16116714]
curr_Stock_Price:  101.12635672113333
curr_Factors:  [101.12635672]
mat_Sqrt:  [[0.15]]
grads:  [-0.016718]
Stock Position:  -0.016717995066540633
Bond Position:  [2.85179708]


portfolio before change:  [1.1707975]
curr_Stock_Price:  100.56097099971704
curr_Factors:  [100.560971]
mat_Sqrt:  [[0.15]]
grads:  [0.04026118]
Stock Position:  0.04026117521800061
Bond Position:  [-2.87790537]


portfolio before change:  [1.14716953]
curr_Stock_Price:  99.97857114629068
curr_Factors:  [99.97857115]
mat_Sqrt:  [[0.15]]
grads:  [-0.07588678]
Stock Position:  -0.07588678217161358
Bond Position:  [8.73422158]


portfolio before change:  [1.18984589]
curr_Stock_Price:  99.42339601224549
curr_Factors:  [99.42339601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01196268]
Stock Position:  -0.011962676356989574
Bond Position:  [2.37921579]


portfolio before change:  [1.19100223]
curr_Stock_Price:  99.33916398389673
curr_Factors:  [99.33916398]
mat_Sqrt:  [[0.15]]
grads:  [0.03011442]
Stock Position:  0.030114423120895958
Bond Position:  [-1.80053938]


portfolio before change:  [1.15183631]
curr_Stock_Price:  98.04233070045896
curr_Factors:  [98.0423307]
mat_Sqrt:  [[0.15]]
grads:  [0.08657904]
Stock Position:  0.08657903826330768
Bond Position:  [-7.33657439]


portfolio before change:  [1.16989192]
curr_Stock_Price:  98.25617183602407
curr_Factors:  [98.25617184]
mat_Sqrt:  [[0.15]]
grads:  [0.11607823]
Stock Position:  0.11607823140288245
Bond Position:  [-10.23551073]


portfolio before change:  [1.12970648]
curr_Stock_Price:  97.91549041799033
curr_Factors:  [97.91549042]
mat_Sqrt:  [[0.15]]
grads:  [-0.22986003]
Stock Position:  -0.22986002529945007
Bond Position:  [23.63656359]


portfolio before change:  [1.45205615]
curr_Stock_Price:  96.51954374394296
curr_Factors:  [96.51954374]
mat_Sqrt:  [[0.15]]
grads:  [0.05494472]
Stock Position:  0.054944723604223554
Bond Position:  [-3.8511835]


portfolio before change:  [1.43091762]
curr_Stock_Price:  96.13920111531185
curr_Factors:  [96.13920112]
mat_Sqrt:  [[0.15]]
grads:  [-0.23923215]
Stock Position:  -0.23923214932136183
Bond Position:  [24.43050534]


portfolio before change:  [1.59760056]
curr_Stock_Price:  95.44884249589475
curr_Factors:  [95.4488425]
mat_Sqrt:  [[0.15]]
grads:  [0.00020837]
Stock Position:  0.0002083652603470515
Bond Position:  [1.57771233]


portfolio before change:  [1.59765347]
curr_Stock_Price:  95.2295173168569
curr_Factors:  [95.22951732]
mat_Sqrt:  [[0.15]]
grads:  [-0.09556896]
Stock Position:  -0.09556896104283845
Bond Position:  [10.6986395]


portfolio before change:  [1.54964007]
curr_Stock_Price:  95.7389094571242
curr_Factors:  [95.73890946]
mat_Sqrt:  [[0.15]]
grads:  [0.2989358]
Stock Position:  0.29893579806364007
Bond Position:  [-27.07014723]


portfolio before change:  [1.54258869]
curr_Stock_Price:  95.72098103065241
curr_Factors:  [95.72098103]
mat_Sqrt:  [[0.15]]
grads:  [0.15540336]
Stock Position:  0.15540336130759125
Bond Position:  [-13.33277351]


portfolio before change:  [1.42849972]
curr_Stock_Price:  94.99219597877565
curr_Factors:  [94.99219598]
mat_Sqrt:  [[0.15]]
grads:  [0.02303765]
Stock Position:  0.023037645487256602
Bond Position:  [-0.75989682]


portfolio before change:  [1.42826484]
curr_Stock_Price:  94.9840621453878
curr_Factors:  [94.98406215]
mat_Sqrt:  [[0.15]]
grads:  [0.05830013]
Stock Position:  0.058300125279222875
Bond Position:  [-4.10931789]


portfolio before change:  [1.38055598]
curr_Stock_Price:  94.1701356836122
curr_Factors:  [94.17013568]
mat_Sqrt:  [[0.15]]
grads:  [0.1846013]
Stock Position:  0.1846013037657991
Bond Position:  [-16.00337384]


portfolio before change:  [1.35457603]
curr_Stock_Price:  94.03481858058761
curr_Factors:  [94.03481858]
mat_Sqrt:  [[0.15]]
grads:  [-0.02350926]
Stock Position:  -0.023509255975092843
Bond Position:  [3.56526465]


portfolio before change:  [1.3437995]
curr_Stock_Price:  94.50269244621907
curr_Factors:  [94.50269245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502293]
Stock Position:  -0.025022932667962947
Bond Position:  [3.70853401]


portfolio before change:  [1.35286106]
curr_Stock_Price:  94.1498251644816
curr_Factors:  [94.14982516]
mat_Sqrt:  [[0.15]]
grads:  [0.15923437]
Stock Position:  0.15923436893217127
Bond Position:  [-13.63902693]


portfolio before change:  [1.30636738]
curr_Stock_Price:  93.8631959712482
curr_Factors:  [93.86319597]
mat_Sqrt:  [[0.15]]
grads:  [0.05135434]
Stock Position:  0.05135433839777154
Bond Position:  [-3.51391495]


portfolio before change:  [1.32043426]
curr_Stock_Price:  94.14139073712802
curr_Factors:  [94.14139074]
mat_Sqrt:  [[0.15]]
grads:  [0.19384693]
Stock Position:  0.19384692885742125
Bond Position:  [-16.92858521]


portfolio before change:  [1.34617663]
curr_Stock_Price:  94.27964643554094
curr_Factors:  [94.27964644]
mat_Sqrt:  [[0.15]]
grads:  [0.07186089]
Stock Position:  0.07186088833761639
Bond Position:  [-5.42884251]


portfolio before change:  [1.34274902]
curr_Stock_Price:  94.23667039560226
curr_Factors:  [94.2366704]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016274]
Stock Position:  -0.00016274479569513013
Bond Position:  [1.35808555]


portfolio before change:  [1.34275253]
curr_Stock_Price:  94.73670989932334
curr_Factors:  [94.7367099]
mat_Sqrt:  [[0.15]]
grads:  [0.03057829]
Stock Position:  0.030578294998864684
Bond Position:  [-1.55413454]


portfolio before change:  [1.31778432]
curr_Stock_Price:  93.92335308104202
curr_Factors:  [93.92335308]
mat_Sqrt:  [[0.15]]
grads:  [0.02768625]
Stock Position:  0.027686253320303063
Bond Position:  [-1.28260142]


portfolio before change:  [1.31116051]
curr_Stock_Price:  93.68700307423025
curr_Factors:  [93.68700307]
mat_Sqrt:  [[0.15]]
grads:  [0.03534279]
Stock Position:  0.035342791793110555
Bond Position:  [-1.99999973]


portfolio before change:  [1.28743525]
curr_Stock_Price:  93.01925003493132
curr_Factors:  [93.01925003]
mat_Sqrt:  [[0.15]]
grads:  [-0.1726577]
Stock Position:  -0.17265770419013676
Bond Position:  [17.34792541]


portfolio before change:  [1.47319016]
curr_Stock_Price:  91.94967352494905
curr_Factors:  [91.94967352]
mat_Sqrt:  [[0.15]]
grads:  [0.00990142]
Stock Position:  0.00990141550878812
Bond Position:  [0.56275823]


portfolio before change:  [1.47077511]
curr_Stock_Price:  91.70221170156744
curr_Factors:  [91.7022117]
mat_Sqrt:  [[0.15]]
grads:  [0.0110624]
Stock Position:  0.011062399642641321
Bond Position:  [0.45632859]


portfolio before change:  [1.47367132]
curr_Stock_Price:  91.96144025779074
curr_Factors:  [91.96144026]
mat_Sqrt:  [[0.15]]
grads:  [-0.97042306]
Stock Position:  -0.9704230630311891
Bond Position:  [90.71517385]


portfolio before change:  [1.79124992]
curr_Stock_Price:  91.640025053262
curr_Factors:  [91.64002505]
mat_Sqrt:  [[0.15]]
grads:  [-0.13045232]
Stock Position:  -0.13045232207281443
Bond Position:  [13.74590398]


portfolio before change:  [1.80508071]
curr_Stock_Price:  91.54058915646596
curr_Factors:  [91.54058916]
mat_Sqrt:  [[0.15]]
grads:  [0.11156144]
Stock Position:  0.11156143922959975
Bond Position:  [-8.40731916]


portfolio before change:  [1.85746151]
curr_Stock_Price:  92.01482359766565
curr_Factors:  [92.0148236]
mat_Sqrt:  [[0.15]]
grads:  [0.1280726]
Stock Position:  0.12807260117884467
Bond Position:  [-9.92711629]


portfolio before change:  [1.88296715]
curr_Stock_Price:  92.21881805703752
curr_Factors:  [92.21881806]
mat_Sqrt:  [[0.15]]
grads:  [-0.13479692]
Stock Position:  -0.13479691773394503
Bond Position:  [14.31377958]


portfolio before change:  [1.76665158]
curr_Stock_Price:  93.08834985668922
curr_Factors:  [93.08834986]
mat_Sqrt:  [[0.15]]
grads:  [-0.03226978]
Stock Position:  -0.032269781152065746
Bond Position:  [4.77059226]


portfolio before change:  [1.78329177]
curr_Stock_Price:  92.58193125446398
curr_Factors:  [92.58193125]
mat_Sqrt:  [[0.15]]
grads:  [-0.1124565]
Stock Position:  -0.11245649731375248
Bond Position:  [12.19473148]


portfolio before change:  [1.82920278]
curr_Stock_Price:  92.1804532218886
curr_Factors:  [92.18045322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232236]
Stock Position:  -0.02232236193056418
Bond Position:  [3.88688822]


portfolio before change:  [1.82946884]
curr_Stock_Price:  92.17941720255429
curr_Factors:  [92.1794172]
mat_Sqrt:  [[0.15]]
grads:  [-0.08073177]
Stock Position:  -0.08073176850318955
Bond Position:  [9.27127622]


portfolio before change:  [1.85090824]
curr_Stock_Price:  91.92103164666912
curr_Factors:  [91.92103165]
mat_Sqrt:  [[0.15]]
grads:  [-0.15800087]
Stock Position:  -0.15800087317041744
Bond Position:  [16.3745115]


portfolio before change:  [1.8600345]
curr_Stock_Price:  91.86974827427296
curr_Factors:  [91.86974827]
mat_Sqrt:  [[0.15]]
grads:  [0.11778478]
Stock Position:  0.11778477984057403
Bond Position:  [-8.96082358]


portfolio before change:  [1.82880947]
curr_Stock_Price:  91.60940094123163
curr_Factors:  [91.60940094]
mat_Sqrt:  [[0.15]]
grads:  [0.12223208]
Stock Position:  0.12223208044015141
Bond Position:  [-9.36879819]


portfolio before change:  [1.97403135]
curr_Stock_Price:  92.80227474360771
curr_Factors:  [92.80227474]
mat_Sqrt:  [[0.15]]
grads:  [0.08672654]
Stock Position:  0.08672653880603191
Bond Position:  [-6.07438873]


portfolio before change:  [1.8959116]
curr_Stock_Price:  91.9058929012855
curr_Factors:  [91.9058929]
mat_Sqrt:  [[0.15]]
grads:  [0.0106448]
Stock Position:  0.010644798363548105
Bond Position:  [0.9175919]


portfolio before change:  [1.88864726]
curr_Stock_Price:  91.21807470875183
curr_Factors:  [91.21807471]
mat_Sqrt:  [[0.15]]
grads:  [0.07056592]
Stock Position:  0.07056591548039387
Bond Position:  [-4.54823969]


portfolio before change:  [1.89197553]
curr_Stock_Price:  91.26926861976791
curr_Factors:  [91.26926862]
mat_Sqrt:  [[0.15]]
grads:  [0.20988095]
Stock Position:  0.2098809461522271
Bond Position:  [-17.26370492]


portfolio before change:  [1.85030455]
curr_Stock_Price:  91.07586389050667
curr_Factors:  [91.07586389]
mat_Sqrt:  [[0.15]]
grads:  [-0.19012208]
Stock Position:  -0.19012208244234888
Bond Position:  [19.16583745]


portfolio before change:  [1.85193955]
curr_Stock_Price:  91.07356485886761
curr_Factors:  [91.07356486]
mat_Sqrt:  [[0.15]]
grads:  [0.0278526]
Stock Position:  0.027852598951378822
Bond Position:  [-0.68469593]


portfolio before change:  [1.84566663]
curr_Stock_Price:  90.84988295833294
curr_Factors:  [90.84988296]
mat_Sqrt:  [[0.15]]
grads:  [0.07735702]
Stock Position:  0.07735701734833876
Bond Position:  [-5.18220934]


portfolio before change:  [1.84553672]
curr_Stock_Price:  90.85239064391355
curr_Factors:  [90.85239064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.84553672]
Stock Price:  90.96400599955962
PL:  [1.84553672]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.54858444e-05]
 [-7.65253502e-03]
 [-5.24845625e-04]
 [ 7.23377421e-03]
 [ 2.94635618e-03]
 [ 2.54697110e-02]
 [ 1.44134192e-03]
 [-1.58417110e-02]
 [ 1.42412684e-02]
 [ 1.89503035e-02]
 [ 1.30278319e-02]
 [-1.70525801e-02]
 [-9.59394831e-03]
 [ 1.23107024e-02]
 [-6.93427997e-03]
 [ 1.20984948e-02]
 [ 7.33573566e-03]
 [-8.97032689e-03]
 [ 7.67202951e-04]
 [ 1.37723761e-02]
 [ 1.19744977e-02]
 [-8.07035205e-03]
 [ 8.17746782e-03]
 [ 2.79402171e-02]
 [-7.99781621e-03]
 [-5.97480998e-03]
 [-5.16663183e-03]
 [ 6.37548153e-03]
 [-1.38289362e-02]
 [-4.07290764e-04]
 [-6.72827211e-03]
 [-1.07641695e-02]
 [-6.32851228e-03]
 [ 4.50456430e-03]
 [ 1.24427621e-02]
 [ 1.43380379e-02]
 [-3.52210431e-02]
 [ 9.57409697e-03]
 [-1.04679062e-02]
 [ 2.46599352e-02]
 [-5.68148073e-03]
 [ 1.45993162e-03]
 [ 2.31786276e-02]
 [ 4.03396437e-03]
 [-7.77430000e-03]
 [-2.58952465e-03]
 [ 4.00799356e-03]
 [-8.45611921e-03]
 [-1.14872350e-02]
 [-7.69806475e-03]
 [ 1.59549025e-02]
 [-3.38209472e-03]
 [-7.94859365e-03]
 [ 5.56666226e-03]
 [-1.84365973e-03]
 [ 1.82696629e-03]
 [ 9.52401667e-03]
 [ 5.44571986e-05]
 [ 1.73608576e-03]
 [ 1.22645916e-02]
 [ 5.33925587e-03]
 [ 2.20578083e-02]
 [ 1.40441118e-03]
 [-1.24032939e-02]
 [ 1.19965825e-02]
 [ 4.37538576e-03]
 [-5.28032359e-03]
 [ 1.53033790e-02]
 [-1.01198428e-02]
 [-1.90268613e-02]
 [-1.20484491e-02]
 [ 1.38606569e-02]
 [-5.98650369e-03]
 [ 2.49526959e-02]
 [-2.63226340e-02]
 [ 2.57096960e-03]
 [ 4.75307213e-03]
 [-1.34989583e-02]
 [ 2.57645927e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.6791678]
curr_Stock_Price:  100.36658412602316
curr_Factors:  [100.36658413]
mat_Sqrt:  [[0.15]]
grads:  [0.00023657]
Stock Position:  0.00023657229622589884
Bond Position:  [7.65542384]


portfolio before change:  [7.67939524]
curr_Stock_Price:  99.30545527769799
curr_Factors:  [99.30545528]
mat_Sqrt:  [[0.15]]
grads:  [-0.0510169]
Stock Position:  -0.05101690013728069
Bond Position:  [12.74565174]


portfolio before change:  [7.66510441]
curr_Stock_Price:  99.60118981888
curr_Factors:  [99.60118982]
mat_Sqrt:  [[0.15]]
grads:  [-0.00349897]
Stock Position:  -0.003498970836505258
Bond Position:  [8.01360607]


portfolio before change:  [7.66366628]
curr_Stock_Price:  100.15535241033866
curr_Factors:  [100.15535241]
mat_Sqrt:  [[0.15]]
grads:  [0.04822516]
Stock Position:  0.04822516138759735
Bond Position:  [2.83365825]


portfolio before change:  [7.67086487]
curr_Stock_Price:  100.30095035301781
curr_Factors:  [100.30095035]
mat_Sqrt:  [[0.15]]
grads:  [0.01964237]
Stock Position:  0.01964237451695365
Bond Position:  [5.70071604]


portfolio before change:  [7.66951929]
curr_Stock_Price:  100.21430651414256
curr_Factors:  [100.21430651]
mat_Sqrt:  [[0.15]]
grads:  [0.16979807]
Stock Position:  0.16979807339799471
Bond Position:  [-9.34667689]


portfolio before change:  [7.63236782]
curr_Stock_Price:  99.99894904323565
curr_Factors:  [99.99894904]
mat_Sqrt:  [[0.15]]
grads:  [0.00960895]
Stock Position:  0.00960894614755908
Bond Position:  [6.6714833]


portfolio before change:  [7.63532686]
curr_Stock_Price:  100.26350003975762
curr_Factors:  [100.26350004]
mat_Sqrt:  [[0.15]]
grads:  [-0.10561141]
Stock Position:  -0.10561140687332887
Bond Position:  [18.22429615]


portfolio before change:  [7.69664703]
curr_Stock_Price:  99.69366463032055
curr_Factors:  [99.69366463]
mat_Sqrt:  [[0.15]]
grads:  [0.09494179]
Stock Position:  0.09494178957859303
Bond Position:  [-1.7684479]


portfolio before change:  [7.64724563]
curr_Stock_Price:  99.17449522698847
curr_Factors:  [99.17449523]
mat_Sqrt:  [[0.15]]
grads:  [0.12633536]
Stock Position:  0.1263353563719567
Bond Position:  [-4.88199957]


portfolio before change:  [7.74584553]
curr_Stock_Price:  99.95737220166049
curr_Factors:  [99.9573722]
mat_Sqrt:  [[0.15]]
grads:  [0.08685221]
Stock Position:  0.08685221272771747
Bond Position:  [-0.93567342]


portfolio before change:  [7.78703479]
curr_Stock_Price:  100.4322908676283
curr_Factors:  [100.43229087]
mat_Sqrt:  [[0.15]]
grads:  [-0.11368387]
Stock Position:  -0.11368386716957324
Bond Position:  [19.204566]


portfolio before change:  [7.88609303]
curr_Stock_Price:  99.57150105782712
curr_Factors:  [99.57150106]
mat_Sqrt:  [[0.15]]
grads:  [-0.06395966]
Stock Position:  -0.06395965542354018
Bond Position:  [14.25465192]


portfolio before change:  [7.88755758]
curr_Stock_Price:  99.56253277652917
curr_Factors:  [99.56253278]
mat_Sqrt:  [[0.15]]
grads:  [0.08207135]
Stock Position:  0.08207134954824001
Bond Position:  [-0.28367385]


portfolio before change:  [7.86243194]
curr_Stock_Price:  99.25660496526316
curr_Factors:  [99.25660497]
mat_Sqrt:  [[0.15]]
grads:  [-0.04622853]
Stock Position:  -0.04622853312756722
Bond Position:  [12.45091919]


portfolio before change:  [7.82928915]
curr_Stock_Price:  99.99037250999942
curr_Factors:  [99.99037251]
mat_Sqrt:  [[0.15]]
grads:  [0.08065663]
Stock Position:  0.08065663182076371
Bond Position:  [-0.23559751]


portfolio before change:  [7.72569872]
curr_Stock_Price:  98.70621640833257
curr_Factors:  [98.70621641]
mat_Sqrt:  [[0.15]]
grads:  [0.0489049]
Stock Position:  0.04890490438768416
Bond Position:  [2.89848064]


portfolio before change:  [7.71147518]
curr_Stock_Price:  98.4116714535972
curr_Factors:  [98.41167145]
mat_Sqrt:  [[0.15]]
grads:  [-0.05980218]
Stock Position:  -0.05980217928914636
Bond Position:  [13.59670761]


portfolio before change:  [7.697548]
curr_Stock_Price:  98.65876960995567
curr_Factors:  [98.65876961]
mat_Sqrt:  [[0.15]]
grads:  [0.00511469]
Stock Position:  0.005114686340439527
Bond Position:  [7.19293934]


portfolio before change:  [7.6999139]
curr_Stock_Price:  99.03344227347719
curr_Factors:  [99.03344227]
mat_Sqrt:  [[0.15]]
grads:  [0.09181584]
Stock Position:  0.09181584064925741
Bond Position:  [-1.39292485]


portfolio before change:  [7.66068073]
curr_Stock_Price:  98.60708759888502
curr_Factors:  [98.6070876]
mat_Sqrt:  [[0.15]]
grads:  [0.07982998]
Stock Position:  0.07982998451859724
Bond Position:  [-0.21112155]


portfolio before change:  [7.75024578]
curr_Stock_Price:  99.72920034797282
curr_Factors:  [99.72920035]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380235]
Stock Position:  -0.05380234701037704
Bond Position:  [13.11591082]


portfolio before change:  [7.79053647]
curr_Stock_Price:  98.99557208598975
curr_Factors:  [98.99557209]
mat_Sqrt:  [[0.15]]
grads:  [0.05451645]
Stock Position:  0.054516452157949834
Bond Position:  [2.3936491]


portfolio before change:  [7.8022739]
curr_Stock_Price:  99.2081285509594
curr_Factors:  [99.20812855]
mat_Sqrt:  [[0.15]]
grads:  [0.18626811]
Stock Position:  0.18626811421000936
Bond Position:  [-10.67703712]


portfolio before change:  [7.79762149]
curr_Stock_Price:  99.1867342428201
curr_Factors:  [99.18673424]
mat_Sqrt:  [[0.15]]
grads:  [-0.05331877]
Stock Position:  -0.05331877470262366
Bond Position:  [13.08613663]


portfolio before change:  [7.82188766]
curr_Stock_Price:  98.74695933323838
curr_Factors:  [98.74695933]
mat_Sqrt:  [[0.15]]
grads:  [-0.03983207]
Stock Position:  -0.03983206650092608
Bond Position:  [11.75518311]


portfolio before change:  [7.82063279]
curr_Stock_Price:  98.79690872734983
curr_Factors:  [98.79690873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03444421]
Stock Position:  -0.03444421218676624
Bond Position:  [11.22361448]


portfolio before change:  [7.81692708]
curr_Stock_Price:  98.92486095098926
curr_Factors:  [98.92486095]
mat_Sqrt:  [[0.15]]
grads:  [0.04250321]
Stock Position:  0.0425032101904763
Bond Position:  [3.61230292]


portfolio before change:  [7.8068466]
curr_Stock_Price:  98.68237915491767
curr_Factors:  [98.68237915]
mat_Sqrt:  [[0.15]]
grads:  [-0.09219291]
Stock Position:  -0.09219290789691213
Bond Position:  [16.90466209]


portfolio before change:  [7.82162889]
curr_Stock_Price:  98.53349869968494
curr_Factors:  [98.5334987]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271527]
Stock Position:  -0.0027152717606683313
Bond Position:  [8.08917412]


portfolio before change:  [7.82073072]
curr_Stock_Price:  99.05048696675281
curr_Factors:  [99.05048697]
mat_Sqrt:  [[0.15]]
grads:  [-0.04485515]
Stock Position:  -0.04485514743163779
Bond Position:  [12.26365492]


portfolio before change:  [7.79426684]
curr_Stock_Price:  99.65756064386544
curr_Factors:  [99.65756064]
mat_Sqrt:  [[0.15]]
grads:  [-0.07176113]
Stock Position:  -0.07176112974839471
Bond Position:  [14.94580598]


portfolio before change:  [7.85869342]
curr_Stock_Price:  98.77278589040596
curr_Factors:  [98.77278589]
mat_Sqrt:  [[0.15]]
grads:  [-0.04219008]
Stock Position:  -0.04219008183419489
Bond Position:  [12.02592534]


portfolio before change:  [7.83657607]
curr_Stock_Price:  99.31483267507394
curr_Factors:  [99.31483268]
mat_Sqrt:  [[0.15]]
grads:  [0.03003043]
Stock Position:  0.03003042864777237
Bond Position:  [4.85410907]


portfolio before change:  [7.82316387]
curr_Stock_Price:  98.85810980053655
curr_Factors:  [98.8581098]
mat_Sqrt:  [[0.15]]
grads:  [0.08295175]
Stock Position:  0.08295174745855705
Bond Position:  [-0.37728908]


portfolio before change:  [7.84777616]
curr_Stock_Price:  99.15510016950729
curr_Factors:  [99.15510017]
mat_Sqrt:  [[0.15]]
grads:  [0.09558692]
Stock Position:  0.09558691918548662
Bond Position:  [-1.63015438]


portfolio before change:  [7.88642259]
curr_Stock_Price:  99.56047277256046
curr_Factors:  [99.56047277]
mat_Sqrt:  [[0.15]]
grads:  [-0.23480695]
Stock Position:  -0.23480695415018804
Bond Position:  [31.26391396]


portfolio before change:  [7.85890498]
curr_Stock_Price:  99.6859872400151
curr_Factors:  [99.68598724]
mat_Sqrt:  [[0.15]]
grads:  [0.06382731]
Stock Position:  0.06382731314603285
Bond Position:  [1.49621625]


portfolio before change:  [7.87266228]
curr_Stock_Price:  99.90006148650627
curr_Factors:  [99.90006149]
mat_Sqrt:  [[0.15]]
grads:  [-0.06978604]
Stock Position:  -0.06978604159818896
Bond Position:  [14.84429213]


portfolio before change:  [7.89000017]
curr_Stock_Price:  99.6649128125167
curr_Factors:  [99.66491281]
mat_Sqrt:  [[0.15]]
grads:  [0.16439957]
Stock Position:  0.16439956793129593
Bond Position:  [-8.49486843]


portfolio before change:  [7.85616001]
curr_Stock_Price:  99.4623014884059
curr_Factors:  [99.46230149]
mat_Sqrt:  [[0.15]]
grads:  [-0.03787654]
Stock Position:  -0.03787653817620233
Bond Position:  [11.62344767]


portfolio before change:  [7.87415406]
curr_Stock_Price:  99.00641089016278
curr_Factors:  [99.00641089]
mat_Sqrt:  [[0.15]]
grads:  [0.00973288]
Stock Position:  0.009732877434733672
Bond Position:  [6.91053679]


portfolio before change:  [7.8767801]
curr_Stock_Price:  99.23184453957342
curr_Factors:  [99.23184454]
mat_Sqrt:  [[0.15]]
grads:  [0.15452418]
Stock Position:  0.15452418397054318
Bond Position:  [-7.4569397]


portfolio before change:  [7.94027033]
curr_Stock_Price:  99.64573644031746
curr_Factors:  [99.64573644]
mat_Sqrt:  [[0.15]]
grads:  [0.0268931]
Stock Position:  0.026893095818731224
Bond Position:  [5.26048799]


portfolio before change:  [7.96290477]
curr_Stock_Price:  100.47515544536651
curr_Factors:  [100.47515545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05182867]
Stock Position:  -0.051828666683488366
Bond Position:  [13.17039811]


portfolio before change:  [7.98551868]
curr_Stock_Price:  100.05471746302786
curr_Factors:  [100.05471746]
mat_Sqrt:  [[0.15]]
grads:  [-0.0172635]
Stock Position:  -0.01726349763428156
Bond Position:  [9.71281306]


portfolio before change:  [7.99226629]
curr_Stock_Price:  99.69902280256723
curr_Factors:  [99.6990228]
mat_Sqrt:  [[0.15]]
grads:  [0.02671996]
Stock Position:  0.026719957053491866
Bond Position:  [5.32831268]


portfolio before change:  [8.02172491]
curr_Stock_Price:  100.7890540631043
curr_Factors:  [100.78905406]
mat_Sqrt:  [[0.15]]
grads:  [-0.05637413]
Stock Position:  -0.05637412809692366
Bond Position:  [13.70361995]


portfolio before change:  [8.02433343]
curr_Stock_Price:  100.75797562242717
curr_Factors:  [100.75797562]
mat_Sqrt:  [[0.15]]
grads:  [-0.07658157]
Stock Position:  -0.076581566836258
Bond Position:  [15.74053707]


portfolio before change:  [8.02180566]
curr_Stock_Price:  100.80382976453487
curr_Factors:  [100.80382976]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132043]
Stock Position:  -0.05132043167347506
Bond Position:  [13.19510172]


portfolio before change:  [8.0108201]
curr_Stock_Price:  101.0339579215478
curr_Factors:  [101.03395792]
mat_Sqrt:  [[0.15]]
grads:  [0.10636602]
Stock Position:  0.106366016949925
Bond Position:  [-2.73575958]


portfolio before change:  [8.05141524]
curr_Stock_Price:  101.41722065869023
curr_Factors:  [101.41722066]
mat_Sqrt:  [[0.15]]
grads:  [-0.0225473]
Stock Position:  -0.02254729813012726
Bond Position:  [10.33809955]


portfolio before change:  [8.02740098]
curr_Stock_Price:  102.51094016048177
curr_Factors:  [102.51094016]
mat_Sqrt:  [[0.15]]
grads:  [-0.05299062]
Stock Position:  -0.052990624310195356
Bond Position:  [13.45951969]


portfolio before change:  [8.03018719]
curr_Stock_Price:  102.47423614002109
curr_Factors:  [102.47423614]
mat_Sqrt:  [[0.15]]
grads:  [0.03711108]
Stock Position:  0.037111081732822064
Bond Position:  [4.22725744]


portfolio before change:  [8.02563286]
curr_Stock_Price:  102.34439511281207
curr_Factors:  [102.34439511]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229106]
Stock Position:  -0.012291064841046832
Bond Position:  [9.28355446]


portfolio before change:  [8.02756565]
curr_Stock_Price:  102.23435171377842
curr_Factors:  [102.23435171]
mat_Sqrt:  [[0.15]]
grads:  [0.01217978]
Stock Position:  0.012179775288082574
Bond Position:  [6.78237422]


portfolio before change:  [8.03307179]
curr_Stock_Price:  102.65161895554195
curr_Factors:  [102.65161896]
mat_Sqrt:  [[0.15]]
grads:  [0.06349344]
Stock Position:  0.06349344447162902
Bond Position:  [1.51536692]


portfolio before change:  [8.08036002]
curr_Stock_Price:  103.39490077916498
curr_Factors:  [103.39490078]
mat_Sqrt:  [[0.15]]
grads:  [0.00036305]
Stock Position:  0.00036304799051074175
Bond Position:  [8.04282271]


portfolio before change:  [8.08088056]
curr_Stock_Price:  103.44404260048866
curr_Factors:  [103.4440426]
mat_Sqrt:  [[0.15]]
grads:  [0.01157391]
Stock Position:  0.011573905097056308
Bond Position:  [6.88362902]


portfolio before change:  [8.09095227]
curr_Stock_Price:  104.27707797415435
curr_Factors:  [104.27707797]
mat_Sqrt:  [[0.15]]
grads:  [0.08176394]
Stock Position:  0.0817639443048539
Bond Position:  [-0.43515293]


portfolio before change:  [8.06486333]
curr_Stock_Price:  103.9583342388761
curr_Factors:  [103.95833424]
mat_Sqrt:  [[0.15]]
grads:  [0.03559504]
Stock Position:  0.03559503913288093
Bond Position:  [4.36446235]


portfolio before change:  [8.06164536]
curr_Stock_Price:  103.86026564157558
curr_Factors:  [103.86026564]
mat_Sqrt:  [[0.15]]
grads:  [0.14705206]
Stock Position:  0.14705205504014784
Bond Position:  [-7.21122014]


portfolio before change:  [8.22099824]
curr_Stock_Price:  104.94698011138524
curr_Factors:  [104.94698011]
mat_Sqrt:  [[0.15]]
grads:  [0.00936274]
Stock Position:  0.00936274117072772
Bond Position:  [7.23840683]


portfolio before change:  [8.2222315]
curr_Stock_Price:  105.03037974090083
curr_Factors:  [105.03037974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08268863]
Stock Position:  -0.08268862567015328
Bond Position:  [16.90704926]


portfolio before change:  [8.25988346]
curr_Stock_Price:  104.58781301508326
curr_Factors:  [104.58781302]
mat_Sqrt:  [[0.15]]
grads:  [0.07997722]
Stock Position:  0.07997721661412635
Bond Position:  [-0.10475872]


portfolio before change:  [8.25904597]
curr_Stock_Price:  104.57742328737876
curr_Factors:  [104.57742329]
mat_Sqrt:  [[0.15]]
grads:  [0.02916924]
Stock Position:  0.02916923836940128
Bond Position:  [5.20860218]


portfolio before change:  [8.26442181]
curr_Stock_Price:  104.75056086734229
curr_Factors:  [104.75056087]
mat_Sqrt:  [[0.15]]
grads:  [-0.03520216]
Stock Position:  -0.03520215729567721
Bond Position:  [11.95186753]


portfolio before change:  [8.28379845]
curr_Stock_Price:  104.22134259814652
curr_Factors:  [104.2213426]
mat_Sqrt:  [[0.15]]
grads:  [0.10202253]
Stock Position:  0.10202252635821556
Bond Position:  [-2.34912622]


portfolio before change:  [8.38093719]
curr_Stock_Price:  105.17491206736808
curr_Factors:  [105.17491207]
mat_Sqrt:  [[0.15]]
grads:  [-0.06746562]
Stock Position:  -0.06746561848577566
Bond Position:  [15.47662768]


portfolio before change:  [8.34544877]
curr_Stock_Price:  105.7152723687861
curr_Factors:  [105.71527237]
mat_Sqrt:  [[0.15]]
grads:  [-0.12684574]
Stock Position:  -0.12684574225087966
Bond Position:  [21.75498096]


portfolio before change:  [8.44495561]
curr_Stock_Price:  104.94152065970303
curr_Factors:  [104.94152066]
mat_Sqrt:  [[0.15]]
grads:  [-0.08032299]
Stock Position:  -0.08032299421609172
Bond Position:  [16.87417276]


portfolio before change:  [8.46268354]
curr_Stock_Price:  104.73394297758878
curr_Factors:  [104.73394298]
mat_Sqrt:  [[0.15]]
grads:  [0.09240438]
Stock Position:  0.09240437960798949
Bond Position:  [-1.21519149]


portfolio before change:  [8.45217156]
curr_Stock_Price:  104.621004289625
curr_Factors:  [104.62100429]
mat_Sqrt:  [[0.15]]
grads:  [-0.03991002]
Stock Position:  -0.03991002458074055
Bond Position:  [12.62759841]


portfolio before change:  [8.46137196]
curr_Stock_Price:  104.41025138543512
curr_Factors:  [104.41025139]
mat_Sqrt:  [[0.15]]
grads:  [0.16635131]
Stock Position:  0.16635130588294664
Bond Position:  [-8.90740971]


portfolio before change:  [8.63100858]
curr_Stock_Price:  105.43334734454588
curr_Factors:  [105.43334734]
mat_Sqrt:  [[0.15]]
grads:  [-0.17548423]
Stock Position:  -0.17548422690200952
Bond Position:  [27.13289803]


portfolio before change:  [8.63253386]
curr_Stock_Price:  105.43431937146809
curr_Factors:  [105.43431937]
mat_Sqrt:  [[0.15]]
grads:  [0.0171398]
Stock Position:  0.017139797323260913
Bond Position:  [6.825411]


portfolio before change:  [8.64817082]
curr_Stock_Price:  106.32174863395046
curr_Factors:  [106.32174863]
mat_Sqrt:  [[0.15]]
grads:  [0.03168715]
Stock Position:  0.03168714754619767
Bond Position:  [5.27913788]


portfolio before change:  [8.63892347]
curr_Stock_Price:  106.01950285766289
curr_Factors:  [106.01950286]
mat_Sqrt:  [[0.15]]
grads:  [-0.08999306]
Stock Position:  -0.0899930550399009
Bond Position:  [18.17994243]


portfolio before change:  [8.67834978]
curr_Stock_Price:  105.59402521373812
curr_Factors:  [105.59402521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.67834978]
Stock Price:  105.32765384725658
PL:  [3.35069594]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.79771720e-03]
 [-2.29100360e-02]
 [-7.71172496e-03]
 [ 7.94757209e-03]
 [-1.02459260e-03]
 [ 1.45177920e-02]
 [ 2.03556925e-03]
 [-1.93324953e-02]
 [ 1.20496217e-02]
 [ 1.93082969e-02]
 [ 1.51907128e-02]
 [ 1.51969454e-02]
 [-1.24801149e-02]
 [ 7.83136807e-03]
 [-6.99563710e-03]
 [ 1.00659194e-02]
 [ 1.20595085e-02]
 [-6.09159393e-03]
 [ 1.32354628e-03]
 [ 9.98452435e-03]
 [ 1.14461017e-02]
 [-9.06677148e-03]
 [ 7.25116289e-03]
 [ 7.50153701e-03]
 [-8.00058086e-03]
 [ 9.88941648e-03]
 [-5.98846926e-03]
 [ 6.65918154e-03]
 [-1.26620494e-02]
 [-6.25678798e-04]
 [-4.65191807e-03]
 [-1.01699070e-02]
 [-7.17708839e-03]
 [ 5.25238497e-03]
 [ 1.37551005e-02]
 [ 5.18513399e-03]
 [-3.19305638e-02]
 [ 8.26158262e-03]
 [-3.16103537e-02]
 [ 4.73843023e-03]
 [-1.31974540e-02]
 [ 3.80564994e-02]
 [ 2.32218592e-02]
 [ 3.99883031e-03]
 [ 8.85004821e-03]
 [ 2.47145924e-02]
 [-2.88125932e-03]
 [-1.15402463e-03]
 [ 2.17062690e-02]
 [ 7.64470146e-03]
 [ 2.78059325e-02]
 [ 1.04423147e-02]
 [ 6.61239109e-04]
 [ 4.64889104e-03]
 [ 3.65295087e-03]
 [ 3.12790212e-03]
 [-7.45732382e-03]
 [-4.27533240e-04]
 [ 1.57072321e-03]
 [-5.88708767e-02]
 [-1.20147006e-02]
 [ 1.77877269e-02]
 [ 1.66286123e-02]
 [-1.92697944e-02]
 [-4.09725176e-03]
 [-2.02496296e-02]
 [-4.16890235e-03]
 [ 2.54668104e-03]
 [-1.64146490e-02]
 [ 1.19920847e-02]
 [ 2.00618247e-03]
 [ 1.19725315e-02]
 [ 1.93986957e-03]
 [-1.05551245e-03]
 [ 1.29044124e-03]
 [-1.67773750e-02]
 [ 5.05739658e-03]
 [ 6.56572873e-03]
 [ 2.41145784e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.15156306]
curr_Stock_Price:  98.88201679052074
curr_Factors:  [98.88201679]
mat_Sqrt:  [[0.15]]
grads:  [0.05865145]
Stock Position:  0.0586514480180629
Bond Position:  [-20.95113653]


portfolio before change:  [-15.15814631]
curr_Stock_Price:  98.79209973184878
curr_Factors:  [98.79209973]
mat_Sqrt:  [[0.15]]
grads:  [-0.15273357]
Stock Position:  -0.15273357332263202
Bond Position:  [-0.0692759]


portfolio before change:  [-15.08020605]
curr_Stock_Price:  98.28176930954359
curr_Factors:  [98.28176931]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514115]
Stock Position:  -0.05141149973456672
Bond Position:  [-10.0273929]


portfolio before change:  [-15.13035451]
curr_Stock_Price:  99.24501156601717
curr_Factors:  [99.24501157]
mat_Sqrt:  [[0.15]]
grads:  [0.05298381]
Stock Position:  0.052983813924950135
Bond Position:  [-20.38873374]


portfolio before change:  [-15.15530466]
curr_Stock_Price:  98.79816160818575
curr_Factors:  [98.79816161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00683062]
Stock Position:  -0.006830617342347678
Bond Position:  [-14.48045223]


portfolio before change:  [-15.15387641]
curr_Stock_Price:  98.45656619790104
curr_Factors:  [98.4565662]
mat_Sqrt:  [[0.15]]
grads:  [0.09678528]
Stock Position:  0.09678528026550696
Bond Position:  [-24.68302277]


portfolio before change:  [-15.13479123]
curr_Stock_Price:  98.66969692686803
curr_Factors:  [98.66969693]
mat_Sqrt:  [[0.15]]
grads:  [0.01357046]
Stock Position:  0.013570461693270534
Bond Position:  [-16.47378458]


portfolio before change:  [-15.13335969]
curr_Stock_Price:  98.85106031750013
curr_Factors:  [98.85106032]
mat_Sqrt:  [[0.15]]
grads:  [-0.1288833]
Stock Position:  -0.12888330231718176
Bond Position:  [-2.3931086]


portfolio before change:  [-15.21830055]
curr_Stock_Price:  99.5089522214671
curr_Factors:  [99.50895222]
mat_Sqrt:  [[0.15]]
grads:  [0.08033081]
Stock Position:  0.080330811103664
Bond Position:  [-23.21193539]


portfolio before change:  [-15.25341201]
curr_Stock_Price:  99.08992652100473
curr_Factors:  [99.08992652]
mat_Sqrt:  [[0.15]]
grads:  [0.12872198]
Stock Position:  0.12872197942374694
Bond Position:  [-28.0084635]


portfolio before change:  [-15.25290971]
curr_Stock_Price:  99.10742848646476
curr_Factors:  [99.10742849]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-25.28965957]


portfolio before change:  [-15.23902579]
curr_Stock_Price:  99.26013270708906
curr_Factors:  [99.26013271]
mat_Sqrt:  [[0.15]]
grads:  [0.10131297]
Stock Position:  0.10131296955965842
Bond Position:  [-25.29536459]


portfolio before change:  [-15.23113433]
curr_Stock_Price:  99.3536298279989
curr_Factors:  [99.35362983]
mat_Sqrt:  [[0.15]]
grads:  [-0.08320077]
Stock Position:  -0.08320076626988472
Bond Position:  [-6.96483619]


portfolio before change:  [-15.1887766]
curr_Stock_Price:  98.83929509670162
curr_Factors:  [98.8392951]
mat_Sqrt:  [[0.15]]
grads:  [0.05220912]
Stock Position:  0.05220912047603092
Bond Position:  [-20.34908927]


portfolio before change:  [-15.22894388]
curr_Stock_Price:  98.0943021897963
curr_Factors:  [98.09430219]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663758]
Stock Position:  -0.04663758066339924
Bond Position:  [-10.65406295]


portfolio before change:  [-15.20427068]
curr_Stock_Price:  97.5509827499857
curr_Factors:  [97.55098275]
mat_Sqrt:  [[0.15]]
grads:  [0.06710613]
Stock Position:  0.06710612927828324
Bond Position:  [-21.75053954]


portfolio before change:  [-15.22426735]
curr_Stock_Price:  97.27325521052754
curr_Factors:  [97.27325521]
mat_Sqrt:  [[0.15]]
grads:  [0.08039672]
Stock Position:  0.08039672327223481
Bond Position:  [-23.04471833]


portfolio before change:  [-15.17618805]
curr_Stock_Price:  97.8891962187181
curr_Factors:  [97.88919622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061063]
Stock Position:  -0.04061062617769976
Bond Position:  [-11.2008465]


portfolio before change:  [-15.19355479]
curr_Stock_Price:  98.29959787882447
curr_Factors:  [98.29959788]
mat_Sqrt:  [[0.15]]
grads:  [0.00882364]
Stock Position:  0.008823641841963496
Bond Position:  [-16.06091524]


portfolio before change:  [-15.19459777]
curr_Stock_Price:  98.29516275246418
curr_Factors:  [98.29516275]
mat_Sqrt:  [[0.15]]
grads:  [0.0665635]
Stock Position:  0.06656349563848091
Bond Position:  [-21.7374674]


portfolio before change:  [-15.10545941]
curr_Stock_Price:  99.65472163380976
curr_Factors:  [99.65472163]
mat_Sqrt:  [[0.15]]
grads:  [0.07630734]
Stock Position:  0.0763073447628039
Bond Position:  [-22.70984661]


portfolio before change:  [-15.19742742]
curr_Stock_Price:  98.46809146398061
curr_Factors:  [98.46809146]
mat_Sqrt:  [[0.15]]
grads:  [-0.06044514]
Stock Position:  -0.06044514319795453
Bond Position:  [-9.24550953]


portfolio before change:  [-15.20328756]
curr_Stock_Price:  98.55548117150232
curr_Factors:  [98.55548117]
mat_Sqrt:  [[0.15]]
grads:  [0.04834109]
Stock Position:  0.04834108594043179
Bond Position:  [-19.96756655]


portfolio before change:  [-15.20659853]
curr_Stock_Price:  98.51280614439446
curr_Factors:  [98.51280614]
mat_Sqrt:  [[0.15]]
grads:  [0.05001025]
Stock Position:  0.0500102467382974
Bond Position:  [-20.13324827]


portfolio before change:  [-15.17459892]
curr_Stock_Price:  99.1778295017143
curr_Factors:  [99.1778295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05333721]
Stock Position:  -0.053337205713172506
Bond Position:  [-9.88473062]


portfolio before change:  [-15.21115362]
curr_Stock_Price:  99.85159733398277
curr_Factors:  [99.85159733]
mat_Sqrt:  [[0.15]]
grads:  [0.06592944]
Stock Position:  0.06592944323016456
Bond Position:  [-21.79431384]


portfolio before change:  [-15.26079321]
curr_Stock_Price:  99.11933871420047
curr_Factors:  [99.11933871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03992313]
Stock Position:  -0.03992312840560557
Bond Position:  [-11.30363913]


portfolio before change:  [-15.24555355]
curr_Stock_Price:  98.71991689815106
curr_Factors:  [98.7199169]
mat_Sqrt:  [[0.15]]
grads:  [0.04439454]
Stock Position:  0.04439454362676584
Bond Position:  [-19.6281792]


portfolio before change:  [-15.23837252]
curr_Stock_Price:  98.90930557841334
curr_Factors:  [98.90930558]
mat_Sqrt:  [[0.15]]
grads:  [-0.08441366]
Stock Position:  -0.08441366291562431
Bond Position:  [-6.88907574]


portfolio before change:  [-15.21556268]
curr_Stock_Price:  98.63398975302415
curr_Factors:  [98.63398975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00417119]
Stock Position:  -0.004171191987461776
Bond Position:  [-14.80414138]


portfolio before change:  [-15.2166948]
curr_Stock_Price:  98.68357494273796
curr_Factors:  [98.68357494]
mat_Sqrt:  [[0.15]]
grads:  [-0.03101279]
Stock Position:  -0.03101278715266253
Bond Position:  [-12.1562421]


portfolio before change:  [-15.20163057]
curr_Stock_Price:  98.17333299750895
curr_Factors:  [98.173333]
mat_Sqrt:  [[0.15]]
grads:  [-0.06779938]
Stock Position:  -0.06779937998999631
Bond Position:  [-8.54553946]


portfolio before change:  [-15.22728274]
curr_Stock_Price:  98.54380931710494
curr_Factors:  [98.54380932]
mat_Sqrt:  [[0.15]]
grads:  [-0.04784726]
Stock Position:  -0.04784725590708265
Bond Position:  [-10.51223188]


portfolio before change:  [-15.19605907]
curr_Stock_Price:  97.87750751622478
curr_Factors:  [97.87750752]
mat_Sqrt:  [[0.15]]
grads:  [0.0350159]
Stock Position:  0.03501589980344172
Bond Position:  [-18.62332806]


portfolio before change:  [-15.21719755]
curr_Stock_Price:  97.30706696760134
curr_Factors:  [97.30706697]
mat_Sqrt:  [[0.15]]
grads:  [0.09170067]
Stock Position:  0.09170067016908104
Bond Position:  [-24.1403208]


portfolio before change:  [-15.37668887]
curr_Stock_Price:  95.58426054955306
curr_Factors:  [95.58426055]
mat_Sqrt:  [[0.15]]
grads:  [0.03456756]
Stock Position:  0.03456755993144333
Bond Position:  [-18.68080352]


portfolio before change:  [-15.37109141]
curr_Stock_Price:  95.77996566496054
curr_Factors:  [95.77996566]
mat_Sqrt:  [[0.15]]
grads:  [-0.21287043]
Stock Position:  -0.21287042532373246
Bond Position:  [5.01763062]


portfolio before change:  [-15.54039823]
curr_Stock_Price:  96.57679046080952
curr_Factors:  [96.57679046]
mat_Sqrt:  [[0.15]]
grads:  [0.05507722]
Stock Position:  0.0550772174760139
Bond Position:  [-20.85957912]


portfolio before change:  [-15.53461369]
curr_Stock_Price:  96.70548798388523
curr_Factors:  [96.70548798]
mat_Sqrt:  [[0.15]]
grads:  [-0.21073569]
Stock Position:  -0.21073569129800376
Bond Position:  [4.84468417]


portfolio before change:  [-15.37627893]
curr_Stock_Price:  95.95558197266696
curr_Factors:  [95.95558197]
mat_Sqrt:  [[0.15]]
grads:  [0.03158953]
Stock Position:  0.031589534855293686
Bond Position:  [-18.40747113]


portfolio before change:  [-15.380013]
curr_Stock_Price:  95.87379634431903
curr_Factors:  [95.87379634]
mat_Sqrt:  [[0.15]]
grads:  [-0.08798303]
Stock Position:  -0.08798302661199928
Bond Position:  [-6.94474623]


portfolio before change:  [-15.42399197]
curr_Stock_Price:  96.36872026439622
curr_Factors:  [96.36872026]
mat_Sqrt:  [[0.15]]
grads:  [0.25371]
Stock Position:  0.2537099959737288
Bond Position:  [-39.8736996]


portfolio before change:  [-15.42952111]
curr_Stock_Price:  96.35675005357683
curr_Factors:  [96.35675005]
mat_Sqrt:  [[0.15]]
grads:  [0.15481239]
Stock Position:  0.15481239437440172
Bond Position:  [-30.3467403]


portfolio before change:  [-15.4461309]
curr_Stock_Price:  96.2617120472321
curr_Factors:  [96.26171205]
mat_Sqrt:  [[0.15]]
grads:  [0.02665887]
Stock Position:  0.02665886874777028
Bond Position:  [-18.01235925]


portfolio before change:  [-15.48236552]
curr_Stock_Price:  94.94474672284717
curr_Factors:  [94.94474672]
mat_Sqrt:  [[0.15]]
grads:  [0.05900032]
Stock Position:  0.05900032139035794
Bond Position:  [-21.08413609]


portfolio before change:  [-15.50882762]
curr_Stock_Price:  94.51857437254536
curr_Factors:  [94.51857437]
mat_Sqrt:  [[0.15]]
grads:  [0.16476395]
Stock Position:  0.16476394914503728
Bond Position:  [-31.0820812]


portfolio before change:  [-15.52309075]
curr_Stock_Price:  94.44379808314096
curr_Factors:  [94.44379808]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192084]
Stock Position:  -0.019208395469270622
Bond Position:  [-13.70897693]


portfolio before change:  [-15.51475862]
curr_Stock_Price:  93.96541526343074
curr_Factors:  [93.96541526]
mat_Sqrt:  [[0.15]]
grads:  [-0.0076935]
Stock Position:  -0.007693497562827034
Bond Position:  [-14.79183593]


portfolio before change:  [-15.51900687]
curr_Stock_Price:  94.39743391630839
curr_Factors:  [94.39743392]
mat_Sqrt:  [[0.15]]
grads:  [0.14470846]
Stock Position:  0.14470845976674182
Bond Position:  [-29.17911414]


portfolio before change:  [-15.59328988]
curr_Stock_Price:  93.89670814462055
curr_Factors:  [93.89670814]
mat_Sqrt:  [[0.15]]
grads:  [0.05096468]
Stock Position:  0.05096467641869283
Bond Position:  [-20.37870523]


portfolio before change:  [-15.59690806]
curr_Stock_Price:  93.85070630182611
curr_Factors:  [93.8507063]
mat_Sqrt:  [[0.15]]
grads:  [0.18537288]
Stock Position:  0.18537288355545606
Bond Position:  [-32.99428411]


portfolio before change:  [-15.50893287]
curr_Stock_Price:  94.33641596520842
curr_Factors:  [94.33641597]
mat_Sqrt:  [[0.15]]
grads:  [0.06961543]
Stock Position:  0.06961543121930695
Bond Position:  [-22.07620314]


portfolio before change:  [-15.46923527]
curr_Stock_Price:  94.92647773783617
curr_Factors:  [94.92647774]
mat_Sqrt:  [[0.15]]
grads:  [0.00440826]
Stock Position:  0.004408260723885732
Bond Position:  [-15.88769593]


portfolio before change:  [-15.46960216]
curr_Stock_Price:  95.06850999991165
curr_Factors:  [95.06851]
mat_Sqrt:  [[0.15]]
grads:  [0.03099261]
Stock Position:  0.030992606937405173
Bond Position:  [-18.41602313]


portfolio before change:  [-15.4693346]
curr_Stock_Price:  95.1142823000392
curr_Factors:  [95.1142823]
mat_Sqrt:  [[0.15]]
grads:  [0.02435301]
Stock Position:  0.02435300581555817
Bond Position:  [-17.78565327]


portfolio before change:  [-15.45254343]
curr_Stock_Price:  95.84941971521272
curr_Factors:  [95.84941972]
mat_Sqrt:  [[0.15]]
grads:  [0.02085268]
Stock Position:  0.020852680781365936
Bond Position:  [-17.45126078]


portfolio before change:  [-15.45350601]
curr_Stock_Price:  95.85556582856276
curr_Factors:  [95.85556583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04971549]
Stock Position:  -0.04971549212854783
Bond Position:  [-10.68799938]


portfolio before change:  [-15.4771152]
curr_Stock_Price:  96.31701503363954
curr_Factors:  [96.31701503]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285022]
Stock Position:  -0.0028502216031335414
Bond Position:  [-15.20259036]


portfolio before change:  [-15.47605476]
curr_Stock_Price:  95.61158439038603
curr_Factors:  [95.61158439]
mat_Sqrt:  [[0.15]]
grads:  [0.01047149]
Stock Position:  0.010471488069630375
Bond Position:  [-16.47725032]


portfolio before change:  [-15.48234687]
curr_Stock_Price:  95.10905278770723
curr_Factors:  [95.10905279]
mat_Sqrt:  [[0.15]]
grads:  [-0.39247251]
Stock Position:  -0.39247251152073964
Bond Position:  [21.84534194]


portfolio before change:  [-15.39723282]
curr_Stock_Price:  94.8956654316984
curr_Factors:  [94.89566543]
mat_Sqrt:  [[0.15]]
grads:  [-0.080098]
Stock Position:  -0.08009800405246853
Bond Position:  [-7.79627943]


portfolio before change:  [-15.4211583]
curr_Stock_Price:  95.18828440914695
curr_Factors:  [95.18828441]
mat_Sqrt:  [[0.15]]
grads:  [0.11858485]
Stock Position:  0.11858484606334574
Bond Position:  [-26.70904636]


portfolio before change:  [-15.51258261]
curr_Stock_Price:  94.43140066221923
curr_Factors:  [94.43140066]
mat_Sqrt:  [[0.15]]
grads:  [0.11085742]
Stock Position:  0.11085741538004235
Bond Position:  [-25.98100362]


portfolio before change:  [-15.4565272]
curr_Stock_Price:  94.95170211529033
curr_Factors:  [94.95170212]
mat_Sqrt:  [[0.15]]
grads:  [-0.1284653]
Stock Position:  -0.12846529610719745
Bond Position:  [-3.25852867]


portfolio before change:  [-15.38985612]
curr_Stock_Price:  94.43113547590187
curr_Factors:  [94.43113548]
mat_Sqrt:  [[0.15]]
grads:  [-0.02731501]
Stock Position:  -0.027315011727086898
Bond Position:  [-12.81046855]


portfolio before change:  [-15.39721051]
curr_Stock_Price:  94.67106623725569
curr_Factors:  [94.67106624]
mat_Sqrt:  [[0.15]]
grads:  [-0.13499753]
Stock Position:  -0.13499753094459077
Bond Position:  [-2.61685032]


portfolio before change:  [-15.40868125]
curr_Stock_Price:  94.75482469482613
curr_Factors:  [94.75482469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02779268]
Stock Position:  -0.027792682332749178
Bond Position:  [-12.77519051]


portfolio before change:  [-15.41585394]
curr_Stock_Price:  94.98417344744803
curr_Factors:  [94.98417345]
mat_Sqrt:  [[0.15]]
grads:  [0.01697787]
Stock Position:  0.01697787357222466
Bond Position:  [-17.02848323]


portfolio before change:  [-15.41945031]
curr_Stock_Price:  94.83503495513312
curr_Factors:  [94.83503496]
mat_Sqrt:  [[0.15]]
grads:  [-0.10943099]
Stock Position:  -0.10943099352747827
Bond Position:  [-5.04155822]


portfolio before change:  [-15.47249984]
curr_Stock_Price:  95.31693150193858
curr_Factors:  [95.3169315]
mat_Sqrt:  [[0.15]]
grads:  [0.07994723]
Stock Position:  0.0799472313963158
Bond Position:  [-23.09282462]


portfolio before change:  [-15.43024908]
curr_Stock_Price:  95.86346825558134
curr_Factors:  [95.86346826]
mat_Sqrt:  [[0.15]]
grads:  [0.01337455]
Stock Position:  0.013374549768158488
Bond Position:  [-16.71237981]


portfolio before change:  [-15.43032972]
curr_Stock_Price:  95.93553973681433
curr_Factors:  [95.93553974]
mat_Sqrt:  [[0.15]]
grads:  [0.07981688]
Stock Position:  0.07981687652553822
Bond Position:  [-23.08760485]


portfolio before change:  [-15.40494139]
curr_Stock_Price:  96.27170108631721
curr_Factors:  [96.27170109]
mat_Sqrt:  [[0.15]]
grads:  [0.01293246]
Stock Position:  0.01293246378531254
Bond Position:  [-16.64997168]


portfolio before change:  [-15.4141435]
curr_Stock_Price:  95.64061836437699
curr_Factors:  [95.64061836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703675]
Stock Position:  -0.007036749681342911
Bond Position:  [-14.74114441]


portfolio before change:  [-15.41570116]
curr_Stock_Price:  95.73104504418191
curr_Factors:  [95.73104504]
mat_Sqrt:  [[0.15]]
grads:  [0.00860294]
Stock Position:  0.008602941605859959
Bond Position:  [-16.23926975]


portfolio before change:  [-15.4213628]
curr_Stock_Price:  95.1909204566073
curr_Factors:  [95.19092046]
mat_Sqrt:  [[0.15]]
grads:  [-0.11184917]
Stock Position:  -0.11184916685129466
Bond Position:  [-4.77433766]


portfolio before change:  [-15.39790832]
curr_Stock_Price:  94.97855505966676
curr_Factors:  [94.97855506]
mat_Sqrt:  [[0.15]]
grads:  [0.03371598]
Stock Position:  0.03371597718374706
Bond Position:  [-18.60020311]


portfolio before change:  [-15.3913913]
curr_Stock_Price:  95.20632728726248
curr_Factors:  [95.20632729]
mat_Sqrt:  [[0.15]]
grads:  [0.04377152]
Stock Position:  0.043771524838955085
Bond Position:  [-19.55871742]


portfolio before change:  [-15.4189714]
curr_Stock_Price:  94.60416313017163
curr_Factors:  [94.60416313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.4189714]
Stock Price:  94.41918684742438
PL:  [-15.4189714]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.16289910e-03]
 [-1.17925649e-02]
 [-4.68984974e-04]
 [ 8.47892552e-03]
 [ 4.82272150e-03]
 [ 2.04499822e-02]
 [ 9.36438260e-04]
 [-1.75354707e-02]
 [ 2.47473440e-02]
 [-4.82930828e-03]
 [ 1.45250433e-02]
 [-2.55702963e-02]
 [ 4.02613768e-02]
 [ 2.58573544e-03]
 [-6.90406929e-03]
 [ 2.04286680e-02]
 [ 1.07227983e-02]
 [-1.12296580e-02]
 [-1.62979264e-04]
 [-5.56413601e-03]
 [ 1.36845754e-02]
 [-3.43338792e-03]
 [ 6.82048758e-03]
 [ 2.63807854e-02]
 [ 1.42335266e-03]
 [ 1.02753467e-02]
 [-5.35254139e-03]
 [ 1.15714135e-02]
 [ 3.03514688e-02]
 [ 2.11590444e-03]
 [ 1.91440062e-02]
 [-8.89589509e-04]
 [-4.63592903e-05]
 [ 8.51788867e-03]
 [ 1.06663948e-02]
 [ 8.51344497e-03]
 [-3.27418173e-02]
 [ 8.68011380e-03]
 [ 1.83115008e-02]
 [-6.89560858e-03]
 [-5.63291995e-03]
 [-1.69677793e-02]
 [ 2.05930869e-02]
 [-3.53995871e-03]
 [ 7.72882993e-03]
 [-1.63228972e-02]
 [ 1.41456149e-02]
 [ 4.05185156e-03]
 [-4.11280053e-03]
 [-7.47658782e-03]
 [-2.79835026e-02]
 [ 2.79413086e-03]
 [-9.12555272e-03]
 [ 5.83823266e-03]
 [-1.24214224e-02]
 [ 1.32587752e-02]
 [ 1.05699252e-02]
 [ 5.91096504e-04]
 [ 1.78801690e-03]
 [ 8.77496727e-03]
 [ 1.12320952e-02]
 [ 2.69276148e-02]
 [ 3.64160211e-03]
 [-1.24625146e-02]
 [ 6.39370014e-03]
 [ 3.91369190e-03]
 [-5.41184480e-03]
 [ 1.50057339e-02]
 [-8.76819901e-03]
 [ 2.80026645e-03]
 [-1.32748361e-02]
 [ 1.31993406e-02]
 [ 5.65074433e-04]
 [ 2.53423671e-02]
 [-2.56478502e-02]
 [ 2.61253693e-03]
 [ 3.55939331e-03]
 [-1.15535300e-02]
 [ 2.68690426e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.0994237]
curr_Stock_Price:  100.06878645415355
curr_Factors:  [100.06878645]
mat_Sqrt:  [[0.15]]
grads:  [0.00775266]
Stock Position:  0.007752660644909151
Bond Position:  [2.32362436]


portfolio before change:  [3.09251454]
curr_Stock_Price:  99.1588550556706
curr_Factors:  [99.15885506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0786171]
Stock Position:  -0.07861709955567511
Bond Position:  [10.88809612]


portfolio before change:  [3.05703083]
curr_Stock_Price:  99.61885973362315
curr_Factors:  [99.61885973]
mat_Sqrt:  [[0.15]]
grads:  [-0.00312657]
Stock Position:  -0.003126566490777097
Bond Position:  [3.36849582]


portfolio before change:  [3.05718847]
curr_Stock_Price:  99.63577937548652
curr_Factors:  [99.63577938]
mat_Sqrt:  [[0.15]]
grads:  [0.05652617]
Stock Position:  0.05652617013050292
Bond Position:  [-2.57484055]


portfolio before change:  [3.06643695]
curr_Stock_Price:  99.80224055384834
curr_Factors:  [99.80224055]
mat_Sqrt:  [[0.15]]
grads:  [0.03215148]
Stock Position:  0.032151476646146246
Bond Position:  [-0.14235246]


portfolio before change:  [3.05353375]
curr_Stock_Price:  99.40119213261501
curr_Factors:  [99.40119213]
mat_Sqrt:  [[0.15]]
grads:  [0.13633321]
Stock Position:  0.13633321461559764
Bond Position:  [-10.49815031]


portfolio before change:  [3.04888533]
curr_Stock_Price:  99.3719089434432
curr_Factors:  [99.37190894]
mat_Sqrt:  [[0.15]]
grads:  [0.00624292]
Stock Position:  0.006242921730044529
Bond Position:  [2.42851428]


portfolio before change:  [3.05267077]
curr_Stock_Price:  99.95395301498182
curr_Factors:  [99.95395301]
mat_Sqrt:  [[0.15]]
grads:  [-0.11690314]
Stock Position:  -0.11690313775603307
Bond Position:  [14.73760151]


portfolio before change:  [2.95623484]
curr_Stock_Price:  100.78675412926434
curr_Factors:  [100.78675413]
mat_Sqrt:  [[0.15]]
grads:  [0.16498229]
Stock Position:  0.16498229331955755
Bond Position:  [-13.671795]


portfolio before change:  [3.00002119]
curr_Stock_Price:  101.05733386434672
curr_Factors:  [101.05733386]
mat_Sqrt:  [[0.15]]
grads:  [-0.03219539]
Stock Position:  -0.03219538855114075
Bond Position:  [6.25360132]


portfolio before change:  [3.0225123]
curr_Stock_Price:  100.37089239084972
curr_Factors:  [100.37089239]
mat_Sqrt:  [[0.15]]
grads:  [0.09683362]
Stock Position:  0.09683362191534568
Bond Position:  [-6.69676475]


portfolio before change:  [3.06631048]
curr_Stock_Price:  100.82751833959078
curr_Factors:  [100.82751834]
mat_Sqrt:  [[0.15]]
grads:  [-0.17046864]
Stock Position:  -0.170468641855023
Bond Position:  [20.2542406]


portfolio before change:  [2.97130485]
curr_Stock_Price:  101.39226481257356
curr_Factors:  [101.39226481]
mat_Sqrt:  [[0.15]]
grads:  [0.26840918]
Stock Position:  0.2684091789951618
Bond Position:  [-24.24330971]


portfolio before change:  [2.87470829]
curr_Stock_Price:  101.038024658589
curr_Factors:  [101.03802466]
mat_Sqrt:  [[0.15]]
grads:  [0.01723824]
Stock Position:  0.017238236299591432
Bond Position:  [1.13299094]


portfolio before change:  [2.87785769]
curr_Stock_Price:  101.21661535301233
curr_Factors:  [101.21661535]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602713]
Stock Position:  -0.04602712857289581
Bond Position:  [7.53656786]


portfolio before change:  [2.87533375]
curr_Stock_Price:  101.28168546000279
curr_Factors:  [101.28168546]
mat_Sqrt:  [[0.15]]
grads:  [0.13619112]
Stock Position:  0.1361911199294855
Bond Position:  [-10.91833242]


portfolio before change:  [2.91551569]
curr_Stock_Price:  101.58173704417663
curr_Factors:  [101.58173704]
mat_Sqrt:  [[0.15]]
grads:  [0.07148532]
Stock Position:  0.07148532188116029
Bond Position:  [-4.34608748]


portfolio before change:  [2.89862733]
curr_Stock_Price:  101.34928766565852
curr_Factors:  [101.34928767]
mat_Sqrt:  [[0.15]]
grads:  [-0.07486439]
Stock Position:  -0.07486438643581535
Bond Position:  [10.48607957]


portfolio before change:  [2.906287]
curr_Stock_Price:  101.25572835979841
curr_Factors:  [101.25572836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00108653]
Stock Position:  -0.0010865284293384444
Bond Position:  [3.01630422]


portfolio before change:  [2.90608153]
curr_Stock_Price:  101.61834200119972
curr_Factors:  [101.618342]
mat_Sqrt:  [[0.15]]
grads:  [-0.03709424]
Stock Position:  -0.03709424005885389
Bond Position:  [6.6755367]


portfolio before change:  [2.90300464]
curr_Stock_Price:  101.7125379341425
curr_Factors:  [101.71253793]
mat_Sqrt:  [[0.15]]
grads:  [0.0912305]
Stock Position:  0.09123050296529794
Bond Position:  [-6.37628136]


portfolio before change:  [2.88969348]
curr_Stock_Price:  101.57099941310106
curr_Factors:  [101.57099941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02288925]
Stock Position:  -0.022889252807216483
Bond Position:  [5.21457776]


portfolio before change:  [2.9141082]
curr_Stock_Price:  100.51859291362331
curr_Factors:  [100.51859291]
mat_Sqrt:  [[0.15]]
grads:  [0.04546992]
Stock Position:  0.04546991718354029
Bond Position:  [-1.6564639]


portfolio before change:  [2.93057681]
curr_Stock_Price:  100.88305693098945
curr_Factors:  [100.88305693]
mat_Sqrt:  [[0.15]]
grads:  [0.1758719]
Stock Position:  0.1758719028483717
Bond Position:  [-14.81191837]


portfolio before change:  [3.00391118]
curr_Stock_Price:  101.30529687461544
curr_Factors:  [101.30529687]
mat_Sqrt:  [[0.15]]
grads:  [0.00948902]
Stock Position:  0.009489017707306908
Bond Position:  [2.04262343]


portfolio before change:  [3.00987881]
curr_Stock_Price:  101.92074073313526
curr_Factors:  [101.92074073]
mat_Sqrt:  [[0.15]]
grads:  [0.06850231]
Stock Position:  0.06850231119451107
Bond Position:  [-3.97192749]


portfolio before change:  [3.04370629]
curr_Stock_Price:  102.4181799300413
curr_Factors:  [102.41817993]
mat_Sqrt:  [[0.15]]
grads:  [-0.03568361]
Stock Position:  -0.035683609260586946
Bond Position:  [6.6983566]


portfolio before change:  [3.03110502]
curr_Stock_Price:  102.78305137361902
curr_Factors:  [102.78305137]
mat_Sqrt:  [[0.15]]
grads:  [0.07714276]
Stock Position:  0.07714275688256995
Bond Position:  [-4.89786292]


portfolio before change:  [2.97989067]
curr_Stock_Price:  102.12312907214417
curr_Factors:  [102.12312907]
mat_Sqrt:  [[0.15]]
grads:  [0.20234313]
Stock Position:  0.20234312528182988
Bond Position:  [-17.68402243]


portfolio before change:  [3.14258137]
curr_Stock_Price:  102.93262528011178
curr_Factors:  [102.93262528]
mat_Sqrt:  [[0.15]]
grads:  [0.01410603]
Stock Position:  0.014106029608422471
Bond Position:  [1.69061071]


portfolio before change:  [3.15782436]
curr_Stock_Price:  104.00573482123647
curr_Factors:  [104.00573482]
mat_Sqrt:  [[0.15]]
grads:  [0.12762671]
Stock Position:  0.12762670827256084
Bond Position:  [-10.11608522]


portfolio before change:  [3.14407445]
curr_Stock_Price:  103.90295358383517
curr_Factors:  [103.90295358]
mat_Sqrt:  [[0.15]]
grads:  [-0.0059306]
Stock Position:  -0.00593059672890517
Bond Position:  [3.76028097]


portfolio before change:  [3.14644601]
curr_Stock_Price:  103.54269642738795
curr_Factors:  [103.54269643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00030906]
Stock Position:  -0.0003090619353093328
Bond Position:  [3.17844712]


portfolio before change:  [3.14674729]
curr_Stock_Price:  103.21067545553953
curr_Factors:  [103.21067546]
mat_Sqrt:  [[0.15]]
grads:  [0.05678592]
Stock Position:  0.056785924441284
Bond Position:  [-2.71416633]


portfolio before change:  [3.11969033]
curr_Stock_Price:  102.73718976843567
curr_Factors:  [102.73718977]
mat_Sqrt:  [[0.15]]
grads:  [0.0711093]
Stock Position:  0.07110929835434326
Bond Position:  [-4.18587915]


portfolio before change:  [3.07848119]
curr_Stock_Price:  102.16135077135725
curr_Factors:  [102.16135077]
mat_Sqrt:  [[0.15]]
grads:  [0.0567563]
Stock Position:  0.056756299805480206
Bond Position:  [-2.71981906]


portfolio before change:  [3.16141525]
curr_Stock_Price:  103.6255767931349
curr_Factors:  [103.62557679]
mat_Sqrt:  [[0.15]]
grads:  [-0.21827878]
Stock Position:  -0.21827878167250875
Bond Position:  [25.7806799]


portfolio before change:  [2.89392498]
curr_Stock_Price:  104.85841129695248
curr_Factors:  [104.8584113]
mat_Sqrt:  [[0.15]]
grads:  [0.05786743]
Stock Position:  0.05786742532930496
Bond Position:  [-3.17396131]


portfolio before change:  [2.93816733]
curr_Stock_Price:  105.62638610922042
curr_Factors:  [105.62638611]
mat_Sqrt:  [[0.15]]
grads:  [0.12207667]
Stock Position:  0.12207667180000627
Bond Position:  [-9.95635034]


portfolio before change:  [2.92819679]
curr_Stock_Price:  105.54980925900173
curr_Factors:  [105.54980926]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597072]
Stock Position:  -0.045970723867969125
Bond Position:  [7.78039792]


portfolio before change:  [2.9382064]
curr_Stock_Price:  105.34264864691683
curr_Factors:  [105.34264865]
mat_Sqrt:  [[0.15]]
grads:  [-0.0375528]
Stock Position:  -0.037552799683301906
Bond Position:  [6.89411778]


portfolio before change:  [2.98900764]
curr_Stock_Price:  104.00132793742287
curr_Factors:  [104.00132794]
mat_Sqrt:  [[0.15]]
grads:  [-0.11311853]
Stock Position:  -0.11311852871734865
Bond Position:  [14.75348485]


portfolio before change:  [3.00090246]
curr_Stock_Price:  103.90432622935465
curr_Factors:  [103.90432623]
mat_Sqrt:  [[0.15]]
grads:  [0.13728725]
Stock Position:  0.13728724602084794
Bond Position:  [-11.26383634]


portfolio before change:  [3.07511291]
curr_Stock_Price:  104.45000302825765
curr_Factors:  [104.45000303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359972]
Stock Position:  -0.023599724737115246
Bond Position:  [5.54010423]


portfolio before change:  [3.08348488]
curr_Stock_Price:  104.10992698858098
curr_Factors:  [104.10992699]
mat_Sqrt:  [[0.15]]
grads:  [0.05152553]
Stock Position:  0.05152553288734835
Bond Position:  [-2.28083459]


portfolio before change:  [3.09582705]
curr_Stock_Price:  104.35222875524323
curr_Factors:  [104.35222876]
mat_Sqrt:  [[0.15]]
grads:  [-0.10881931]
Stock Position:  -0.10881931448192203
Bond Position:  [14.45136505]


portfolio before change:  [3.25731057]
curr_Stock_Price:  102.87656897209318
curr_Factors:  [102.87656897]
mat_Sqrt:  [[0.15]]
grads:  [0.0943041]
Stock Position:  0.09430409955903045
Bond Position:  [-6.44437163]


portfolio before change:  [3.26234287]
curr_Stock_Price:  102.93420252905634
curr_Factors:  [102.93420253]
mat_Sqrt:  [[0.15]]
grads:  [0.02701234]
Stock Position:  0.027012343706708318
Bond Position:  [0.48184881]


portfolio before change:  [3.24223282]
curr_Stock_Price:  102.18861137632254
curr_Factors:  [102.18861138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02741867]
Stock Position:  -0.027418670171600615
Bond Position:  [6.04410865]


portfolio before change:  [3.24726277]
curr_Stock_Price:  102.01893952013026
curr_Factors:  [102.01893952]
mat_Sqrt:  [[0.15]]
grads:  [-0.04984392]
Stock Position:  -0.04984391881361512
Bond Position:  [8.3322865]


portfolio before change:  [3.17409458]
curr_Stock_Price:  103.49733397643307
curr_Factors:  [103.49733398]
mat_Sqrt:  [[0.15]]
grads:  [-0.18655668]
Stock Position:  -0.18655668425497107
Bond Position:  [22.48221403]


portfolio before change:  [3.14637174]
curr_Stock_Price:  103.6534689179535
curr_Factors:  [103.65346892]
mat_Sqrt:  [[0.15]]
grads:  [0.01862754]
Stock Position:  0.01862753907817441
Bond Position:  [1.2155627]


portfolio before change:  [3.1546967]
curr_Stock_Price:  104.09630690824775
curr_Factors:  [104.09630691]
mat_Sqrt:  [[0.15]]
grads:  [-0.06083702]
Stock Position:  -0.060837018130116355
Bond Position:  [9.48760561]


portfolio before change:  [3.16560676]
curr_Stock_Price:  103.92672149869784
curr_Factors:  [103.9267215]
mat_Sqrt:  [[0.15]]
grads:  [0.03892155]
Stock Position:  0.038921551095374256
Bond Position:  [-0.87938244]


portfolio before change:  [3.19253584]
curr_Stock_Price:  104.62001450378777
curr_Factors:  [104.6200145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08280948]
Stock Position:  -0.08280948241595208
Bond Position:  [11.85606509]


portfolio before change:  [3.23273444]
curr_Stock_Price:  104.14352837821451
curr_Factors:  [104.14352838]
mat_Sqrt:  [[0.15]]
grads:  [0.08839183]
Stock Position:  0.08839183475138136
Bond Position:  [-5.97270311]


portfolio before change:  [3.22594456]
curr_Stock_Price:  104.0709360294355
curr_Factors:  [104.07093603]
mat_Sqrt:  [[0.15]]
grads:  [0.07046617]
Stock Position:  0.07046616795951977
Bond Position:  [-4.1075355]


portfolio before change:  [3.24876977]
curr_Stock_Price:  104.3984965622109
curr_Factors:  [104.39849656]
mat_Sqrt:  [[0.15]]
grads:  [0.00394064]
Stock Position:  0.003940643359128595
Bond Position:  [2.83737252]


portfolio before change:  [3.24813248]
curr_Stock_Price:  104.19177180307591
curr_Factors:  [104.1917718]
mat_Sqrt:  [[0.15]]
grads:  [0.01192011]
Stock Position:  0.01192011267377234
Bond Position:  [2.00615482]


portfolio before change:  [3.25912484]
curr_Stock_Price:  105.10342229947858
curr_Factors:  [105.1034223]
mat_Sqrt:  [[0.15]]
grads:  [0.05849978]
Stock Position:  0.05849978178668582
Bond Position:  [-2.88940243]


portfolio before change:  [3.24416415]
curr_Stock_Price:  104.85077002441307
curr_Factors:  [104.85077002]
mat_Sqrt:  [[0.15]]
grads:  [0.07488063]
Stock Position:  0.07488063445317782
Bond Position:  [-4.60712803]


portfolio before change:  [3.21483567]
curr_Stock_Price:  104.46294579446726
curr_Factors:  [104.46294579]
mat_Sqrt:  [[0.15]]
grads:  [0.17951743]
Stock Position:  0.17951743168818693
Bond Position:  [-15.53808407]


portfolio before change:  [3.1387691]
curr_Stock_Price:  104.04462760220581
curr_Factors:  [104.0446276]
mat_Sqrt:  [[0.15]]
grads:  [0.02427735]
Stock Position:  0.024277347409145784
Bond Position:  [0.61284153]


portfolio before change:  [3.1483144]
curr_Stock_Price:  104.43622691369167
curr_Factors:  [104.43622691]
mat_Sqrt:  [[0.15]]
grads:  [-0.08308343]
Stock Position:  -0.08308343098300303
Bond Position:  [11.82523445]


portfolio before change:  [3.22016854]
curr_Stock_Price:  103.58027962372378
curr_Factors:  [103.58027962]
mat_Sqrt:  [[0.15]]
grads:  [0.04262467]
Stock Position:  0.04262466757883744
Bond Position:  [-1.19490645]


portfolio before change:  [3.24344012]
curr_Stock_Price:  104.12799699171876
curr_Factors:  [104.12799699]
mat_Sqrt:  [[0.15]]
grads:  [0.02609128]
Stock Position:  0.026091279347263317
Bond Position:  [0.52660746]


portfolio before change:  [3.23523271]
curr_Stock_Price:  103.81217030639505
curr_Factors:  [103.81217031]
mat_Sqrt:  [[0.15]]
grads:  [-0.03607897]
Stock Position:  -0.03607896536490451
Bond Position:  [6.98066841]


portfolio before change:  [3.23855914]
curr_Stock_Price:  103.73206494958295
curr_Factors:  [103.73206495]
mat_Sqrt:  [[0.15]]
grads:  [0.10003823]
Stock Position:  0.10003822619763816
Bond Position:  [-7.13861264]


portfolio before change:  [3.33195069]
curr_Stock_Price:  104.67008367014843
curr_Factors:  [104.67008367]
mat_Sqrt:  [[0.15]]
grads:  [-0.05845466]
Stock Position:  -0.05845466006688817
Bond Position:  [9.45040485]


portfolio before change:  [3.39080245]
curr_Stock_Price:  103.6733950943816
curr_Factors:  [103.67339509]
mat_Sqrt:  [[0.15]]
grads:  [0.01866844]
Stock Position:  0.018668442969695758
Bond Position:  [1.45538159]


portfolio before change:  [3.38767896]
curr_Stock_Price:  103.50120874319578
curr_Factors:  [103.50120874]
mat_Sqrt:  [[0.15]]
grads:  [-0.08849891]
Stock Position:  -0.08849890714518227
Bond Position:  [12.54742282]


portfolio before change:  [3.35751341]
curr_Stock_Price:  103.85092817773464
curr_Factors:  [103.85092818]
mat_Sqrt:  [[0.15]]
grads:  [0.0879956]
Stock Position:  0.08799560371345581
Bond Position:  [-5.78091171]


portfolio before change:  [3.33215058]
curr_Stock_Price:  103.5668058227874
curr_Factors:  [103.56680582]
mat_Sqrt:  [[0.15]]
grads:  [0.00376716]
Stock Position:  0.0037671628886146794
Bond Position:  [2.94199755]


portfolio before change:  [3.33633224]
curr_Stock_Price:  104.62802448681097
curr_Factors:  [104.62802449]
mat_Sqrt:  [[0.15]]
grads:  [0.16894911]
Stock Position:  0.16894911402292384
Bond Position:  [-14.3404798]


portfolio before change:  [3.39707991]
curr_Stock_Price:  104.9928916214796
curr_Factors:  [104.99289162]
mat_Sqrt:  [[0.15]]
grads:  [-0.17098567]
Stock Position:  -0.17098566821564404
Bond Position:  [21.34935964]


portfolio before change:  [3.31825351]
curr_Stock_Price:  105.46170738414496
curr_Factors:  [105.46170738]
mat_Sqrt:  [[0.15]]
grads:  [0.01741691]
Stock Position:  0.017416912894491852
Bond Position:  [1.48143614]


portfolio before change:  [3.32515005]
curr_Stock_Price:  105.8523587835019
curr_Factors:  [105.85235878]
mat_Sqrt:  [[0.15]]
grads:  [0.02372929]
Stock Position:  0.02372928875686124
Bond Position:  [0.81334886]


portfolio before change:  [3.30765115]
curr_Stock_Price:  105.11277769217284
curr_Factors:  [105.11277769]
mat_Sqrt:  [[0.15]]
grads:  [-0.07702353]
Stock Position:  -0.07702353347860158
Bond Position:  [11.4038087]


portfolio before change:  [3.30493157]
curr_Stock_Price:  105.15733996788289
curr_Factors:  [105.15733997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.30493157]
Stock Price:  104.12954022709759
PL:  [-0.82460866]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.27490925e-03]
 [-4.13527160e-03]
 [-6.10712899e-04]
 [ 6.65638720e-03]
 [ 3.06670843e-03]
 [ 2.15502212e-02]
 [ 1.86230130e-03]
 [-2.20312006e-02]
 [-6.92267053e-03]
 [ 2.69842026e-02]
 [ 1.22691886e-02]
 [ 1.94353696e-02]
 [-1.41291572e-02]
 [ 1.20269949e-02]
 [-7.00383238e-03]
 [ 9.71051947e-03]
 [ 1.22687382e-02]
 [-8.22050568e-03]
 [ 5.58365920e-04]
 [ 1.54783797e-02]
 [ 1.15979579e-02]
 [-8.72244599e-03]
 [ 8.00368924e-03]
 [ 3.17209536e-02]
 [-4.86352785e-03]
 [ 1.45482239e-02]
 [-6.35231515e-03]
 [ 5.94596907e-03]
 [-8.47888240e-03]
 [-2.58759162e-03]
 [ 6.74812016e-03]
 [-1.18269538e-02]
 [ 8.12394950e-03]
 [ 6.71674951e-03]
 [ 1.20627130e-02]
 [ 1.46640697e-02]
 [-3.51788873e-02]
 [ 9.58981810e-03]
 [-5.00882540e-03]
 [ 2.14268052e-02]
 [-5.79690322e-03]
 [-1.63812364e-02]
 [ 2.17602911e-02]
 [ 1.10266775e-03]
 [-1.63886919e-03]
 [-1.29565846e-02]
 [ 1.48525589e-02]
 [ 1.23368785e-02]
 [ 6.21118642e-03]
 [-7.52807908e-03]
 [ 5.45784486e-03]
 [ 4.95047338e-03]
 [-9.95391061e-03]
 [ 5.85837944e-03]
 [-1.62253910e-02]
 [ 2.29925851e-02]
 [ 1.39037573e-02]
 [ 1.17015380e-03]
 [ 1.87296762e-03]
 [ 8.16133933e-03]
 [ 8.83504747e-03]
 [ 2.37823668e-02]
 [ 3.36662439e-03]
 [-1.25429036e-02]
 [ 1.02805335e-02]
 [ 4.43967820e-03]
 [-5.41653336e-03]
 [ 1.50107030e-02]
 [-8.41186854e-03]
 [ 4.79943394e-03]
 [-1.28294449e-02]
 [ 1.22832169e-02]
 [ 4.66412571e-04]
 [ 2.30331704e-02]
 [-2.31227415e-02]
 [-1.64581756e-04]
 [-8.17161708e-03]
 [-2.03572274e-03]
 [ 2.93570652e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.07940931]
curr_Stock_Price:  98.95173354410066
curr_Factors:  [98.95173354]
mat_Sqrt:  [[0.15]]
grads:  [0.05516606]
Stock Position:  0.05516606167162865
Bond Position:  [-19.53818674]


portfolio before change:  [-14.05424624]
curr_Stock_Price:  99.43000307318134
curr_Factors:  [99.43000307]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756848]
Stock Position:  -0.027568477311431333
Bond Position:  [-11.31311245]


portfolio before change:  [-14.05863417]
curr_Stock_Price:  99.56351942339022
curr_Factors:  [99.56351942]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407142]
Stock Position:  -0.004071419326863261
Bond Position:  [-13.65326933]


portfolio before change:  [-14.05614017]
curr_Stock_Price:  98.74135856830827
curr_Factors:  [98.74135857]
mat_Sqrt:  [[0.15]]
grads:  [0.04437591]
Stock Position:  0.04437591468143005
Bond Position:  [-18.43787827]


portfolio before change:  [-14.03031838]
curr_Stock_Price:  99.34921497710052
curr_Factors:  [99.34921498]
mat_Sqrt:  [[0.15]]
grads:  [0.02044472]
Stock Position:  0.020444722854901343
Bond Position:  [-16.06148555]


portfolio before change:  [-14.0266777]
curr_Stock_Price:  99.57639121820202
curr_Factors:  [99.57639122]
mat_Sqrt:  [[0.15]]
grads:  [0.14366814]
Stock Position:  0.14366814125731617
Bond Position:  [-28.33263274]


portfolio before change:  [-14.14487815]
curr_Stock_Price:  98.76598470854171
curr_Factors:  [98.76598471]
mat_Sqrt:  [[0.15]]
grads:  [0.01241534]
Stock Position:  0.012415341978458852
Bond Position:  [-15.37109162]


portfolio before change:  [-14.14929537]
curr_Stock_Price:  98.48757938382
curr_Factors:  [98.48757938]
mat_Sqrt:  [[0.15]]
grads:  [-0.14687467]
Stock Position:  -0.14687467050848546
Bond Position:  [0.31603541]


portfolio before change:  [-14.12107398]
curr_Stock_Price:  98.29556781885664
curr_Factors:  [98.29556782]
mat_Sqrt:  [[0.15]]
grads:  [-0.04615114]
Stock Position:  -0.04615113683979125
Bond Position:  [-9.58462178]


portfolio before change:  [-14.11373025]
curr_Stock_Price:  98.12346399703753
curr_Factors:  [98.123464]
mat_Sqrt:  [[0.15]]
grads:  [0.17989468]
Stock Position:  0.17989468428412814
Bond Position:  [-31.76561983]


portfolio before change:  [-13.98011115]
curr_Stock_Price:  98.87726344217027
curr_Factors:  [98.87726344]
mat_Sqrt:  [[0.15]]
grads:  [0.08179459]
Stock Position:  0.08179459067793829
Bond Position:  [-22.06773644]


portfolio before change:  [-13.97396454]
curr_Stock_Price:  98.96927306728122
curr_Factors:  [98.96927307]
mat_Sqrt:  [[0.15]]
grads:  [0.12956913]
Stock Position:  0.12956913060767222
Bond Position:  [-26.7973272]


portfolio before change:  [-14.00796861]
curr_Stock_Price:  98.71975999283264
curr_Factors:  [98.71975999]
mat_Sqrt:  [[0.15]]
grads:  [-0.09419438]
Stock Position:  -0.0941943814596636
Bond Position:  [-4.70912188]


portfolio before change:  [-14.06166984]
curr_Stock_Price:  99.28674599852249
curr_Factors:  [99.286746]
mat_Sqrt:  [[0.15]]
grads:  [0.08017997]
Stock Position:  0.08017996628326252
Bond Position:  [-22.02247779]


portfolio before change:  [-14.17133103]
curr_Stock_Price:  97.93622476053466
curr_Factors:  [97.93622476]
mat_Sqrt:  [[0.15]]
grads:  [-0.04669222]
Stock Position:  -0.04669221583768877
Bond Position:  [-9.59847169]


portfolio before change:  [-14.16183639]
curr_Stock_Price:  97.7200309971118
curr_Factors:  [97.720031]
mat_Sqrt:  [[0.15]]
grads:  [0.0647368]
Stock Position:  0.06473679647052762
Bond Position:  [-20.48791815]


portfolio before change:  [-14.19605943]
curr_Stock_Price:  97.2111627451401
curr_Factors:  [97.21116275]
mat_Sqrt:  [[0.15]]
grads:  [0.08179159]
Stock Position:  0.08179158826036458
Bond Position:  [-22.14711482]


portfolio before change:  [-14.12688308]
curr_Stock_Price:  98.07385023891409
curr_Factors:  [98.07385024]
mat_Sqrt:  [[0.15]]
grads:  [-0.05480337]
Stock Position:  -0.05480337119032966
Bond Position:  [-8.75210547]


portfolio before change:  [-14.16687446]
curr_Stock_Price:  98.79359347631944
curr_Factors:  [98.79359348]
mat_Sqrt:  [[0.15]]
grads:  [0.00372244]
Stock Position:  0.0037224394636832673
Bond Position:  [-14.53462763]


portfolio before change:  [-14.16567912]
curr_Stock_Price:  99.35875687546486
curr_Factors:  [99.35875688]
mat_Sqrt:  [[0.15]]
grads:  [0.1031892]
Stock Position:  0.10318919795848948
Bond Position:  [-24.41842955]


portfolio before change:  [-14.1871633]
curr_Stock_Price:  99.16534535312171
curr_Factors:  [99.16534535]
mat_Sqrt:  [[0.15]]
grads:  [0.07731972]
Stock Position:  0.07731971914300773
Bond Position:  [-21.85459995]


portfolio before change:  [-14.22188589]
curr_Stock_Price:  98.73393365312947
curr_Factors:  [98.73393365]
mat_Sqrt:  [[0.15]]
grads:  [-0.05814964]
Stock Position:  -0.0581496399237327
Bond Position:  [-8.4805432]


portfolio before change:  [-14.23189481]
curr_Stock_Price:  98.89694197681793
curr_Factors:  [98.89694198]
mat_Sqrt:  [[0.15]]
grads:  [0.05335793]
Stock Position:  0.053357928294751916
Bond Position:  [-19.50883075]


portfolio before change:  [-14.20997119]
curr_Stock_Price:  99.33067243258401
curr_Factors:  [99.33067243]
mat_Sqrt:  [[0.15]]
grads:  [0.21147302]
Stock Position:  0.2114730241279434
Bond Position:  [-35.21572888]


portfolio before change:  [-14.13830418]
curr_Stock_Price:  99.67997495121446
curr_Factors:  [99.67997495]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242352]
Stock Position:  -0.03242351902035316
Bond Position:  [-10.90632862]


portfolio before change:  [-14.16590532]
curr_Stock_Price:  100.51022018400079
curr_Factors:  [100.51022018]
mat_Sqrt:  [[0.15]]
grads:  [0.09698816]
Stock Position:  0.09698815949897091
Bond Position:  [-23.91420659]


portfolio before change:  [-14.1464128]
curr_Stock_Price:  100.72660957545116
curr_Factors:  [100.72660958]
mat_Sqrt:  [[0.15]]
grads:  [-0.04234877]
Stock Position:  -0.04234876768839912
Bond Position:  [-9.88076501]


portfolio before change:  [-14.13187292]
curr_Stock_Price:  100.36869024025196
curr_Factors:  [100.36869024]
mat_Sqrt:  [[0.15]]
grads:  [0.03963979]
Stock Position:  0.03963979383242824
Bond Position:  [-18.11046711]


portfolio before change:  [-14.16364403]
curr_Stock_Price:  99.59575071426201
curr_Factors:  [99.59575071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05652588]
Stock Position:  -0.056525882660032035
Bond Position:  [-8.53390631]


portfolio before change:  [-14.18458348]
curr_Stock_Price:  99.95675460044916
curr_Factors:  [99.9567546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01725061]
Stock Position:  -0.01725061081801522
Bond Position:  [-12.4602684]


portfolio before change:  [-14.19797164]
curr_Stock_Price:  100.68770712707386
curr_Factors:  [100.68770713]
mat_Sqrt:  [[0.15]]
grads:  [0.04498747]
Stock Position:  0.04498746776579812
Bond Position:  [-18.72765662]


portfolio before change:  [-14.15950319]
curr_Stock_Price:  101.56881861363888
curr_Factors:  [101.56881861]
mat_Sqrt:  [[0.15]]
grads:  [-0.07884636]
Stock Position:  -0.07884635856398793
Bond Position:  [-6.15117169]


portfolio before change:  [-14.1647222]
curr_Stock_Price:  101.63013472748607
curr_Factors:  [101.63013473]
mat_Sqrt:  [[0.15]]
grads:  [0.05415966]
Stock Position:  0.05415966336017
Bond Position:  [-19.66897608]


portfolio before change:  [-14.22456105]
curr_Stock_Price:  100.54797325478766
curr_Factors:  [100.54797325]
mat_Sqrt:  [[0.15]]
grads:  [0.04477833]
Stock Position:  0.04477833006062636
Bond Position:  [-18.72693138]


portfolio before change:  [-14.27718349]
curr_Stock_Price:  99.39893593548375
curr_Factors:  [99.39893594]
mat_Sqrt:  [[0.15]]
grads:  [0.08041809]
Stock Position:  0.08041808691659978
Bond Position:  [-22.27065576]


portfolio before change:  [-14.30433131]
curr_Stock_Price:  99.07866148162327
curr_Factors:  [99.07866148]
mat_Sqrt:  [[0.15]]
grads:  [0.09776046]
Stock Position:  0.09776046471451119
Bond Position:  [-23.9903073]


portfolio before change:  [-14.28131087]
curr_Stock_Price:  99.32947737558926
curr_Factors:  [99.32947738]
mat_Sqrt:  [[0.15]]
grads:  [-0.23452592]
Stock Position:  -0.2345259155207356
Bond Position:  [9.01402575]


portfolio before change:  [-14.37355602]
curr_Stock_Price:  99.72520565990628
curr_Factors:  [99.72520566]
mat_Sqrt:  [[0.15]]
grads:  [0.06393212]
Stock Position:  0.06393212067834825
Bond Position:  [-20.7491999]


portfolio before change:  [-14.3343441]
curr_Stock_Price:  100.35882736467462
curr_Factors:  [100.35882736]
mat_Sqrt:  [[0.15]]
grads:  [-0.03339217]
Stock Position:  -0.03339216935815257
Bond Position:  [-10.98314514]


portfolio before change:  [-14.34321368]
curr_Stock_Price:  100.60388806691203
curr_Factors:  [100.60388807]
mat_Sqrt:  [[0.15]]
grads:  [0.14284537]
Stock Position:  0.14284536815959611
Bond Position:  [-28.71401311]


portfolio before change:  [-14.32141667]
curr_Stock_Price:  100.76904352706893
curr_Factors:  [100.76904353]
mat_Sqrt:  [[0.15]]
grads:  [-0.03864602]
Stock Position:  -0.03864602149863449
Bond Position:  [-10.42709405]


portfolio before change:  [-14.3309509]
curr_Stock_Price:  100.99888665051236
curr_Factors:  [100.99888665]
mat_Sqrt:  [[0.15]]
grads:  [-0.10920824]
Stock Position:  -0.10920824265160586
Bond Position:  [-3.30103998]


portfolio before change:  [-14.40545716]
curr_Stock_Price:  101.67923763896526
curr_Factors:  [101.67923764]
mat_Sqrt:  [[0.15]]
grads:  [0.14506861]
Stock Position:  0.1450686071489142
Bond Position:  [-29.15592254]


portfolio before change:  [-14.37867293]
curr_Stock_Price:  101.87643078029814
curr_Factors:  [101.87643078]
mat_Sqrt:  [[0.15]]
grads:  [0.00735112]
Stock Position:  0.007351118312474113
Bond Position:  [-15.12757862]


portfolio before change:  [-14.37488813]
curr_Stock_Price:  102.51991128118462
curr_Factors:  [102.51991128]
mat_Sqrt:  [[0.15]]
grads:  [-0.01092579]
Stock Position:  -0.010925794607526823
Bond Position:  [-13.25477664]


portfolio before change:  [-14.37703223]
curr_Stock_Price:  102.64032859526313
curr_Factors:  [102.6403286]
mat_Sqrt:  [[0.15]]
grads:  [-0.08637723]
Stock Position:  -0.08637723073453216
Bond Position:  [-5.51124489]


portfolio before change:  [-14.49177649]
curr_Stock_Price:  103.9647492998088
curr_Factors:  [103.9647493]
mat_Sqrt:  [[0.15]]
grads:  [0.09901706]
Stock Position:  0.09901705915331487
Bond Position:  [-24.78606022]


portfolio before change:  [-14.46030457]
curr_Stock_Price:  104.29823833155713
curr_Factors:  [104.29823833]
mat_Sqrt:  [[0.15]]
grads:  [0.08224586]
Stock Position:  0.08224585635817912
Bond Position:  [-23.03840249]


portfolio before change:  [-14.43540609]
curr_Stock_Price:  104.618478423278
curr_Factors:  [104.61847842]
mat_Sqrt:  [[0.15]]
grads:  [0.04140791]
Stock Position:  0.04140790945175217
Bond Position:  [-18.76743857]


portfolio before change:  [-14.42338433]
curr_Stock_Price:  104.93713148459055
curr_Factors:  [104.93713148]
mat_Sqrt:  [[0.15]]
grads:  [-0.05018719]
Stock Position:  -0.05018719384039565
Bond Position:  [-9.15688418]


portfolio before change:  [-14.43384924]
curr_Stock_Price:  105.13424519698007
curr_Factors:  [105.1342452]
mat_Sqrt:  [[0.15]]
grads:  [0.03638563]
Stock Position:  0.03638563236797375
Bond Position:  [-18.25922524]


portfolio before change:  [-14.4047591]
curr_Stock_Price:  105.96510556828568
curr_Factors:  [105.96510557]
mat_Sqrt:  [[0.15]]
grads:  [0.03300316]
Stock Position:  0.03300315588158384
Bond Position:  [-17.901942]


portfolio before change:  [-14.42095565]
curr_Stock_Price:  105.50825096872836
curr_Factors:  [105.50825097]
mat_Sqrt:  [[0.15]]
grads:  [-0.0663594]
Stock Position:  -0.06635940407701667
Bond Position:  [-7.41949099]


portfolio before change:  [-14.42575642]
curr_Stock_Price:  105.57360775116655
curr_Factors:  [105.57360775]
mat_Sqrt:  [[0.15]]
grads:  [0.03905586]
Stock Position:  0.03905586292311574
Bond Position:  [-18.54902477]


portfolio before change:  [-14.426181]
curr_Stock_Price:  105.59242096046148
curr_Factors:  [105.59242096]
mat_Sqrt:  [[0.15]]
grads:  [-0.10816927]
Stock Position:  -0.10816927309826689
Bond Position:  [-3.00432558]


portfolio before change:  [-14.42824103]
curr_Stock_Price:  105.60972952890094
curr_Factors:  [105.60972953]
mat_Sqrt:  [[0.15]]
grads:  [0.1532839]
Stock Position:  0.15328390075101483
Bond Position:  [-30.61651233]


portfolio before change:  [-14.39788018]
curr_Stock_Price:  105.82028289762225
curr_Factors:  [105.8202829]
mat_Sqrt:  [[0.15]]
grads:  [0.09269172]
Stock Position:  0.09269171500578484
Bond Position:  [-24.20654369]


portfolio before change:  [-14.43220448]
curr_Stock_Price:  105.46629937543372
curr_Factors:  [105.46629938]
mat_Sqrt:  [[0.15]]
grads:  [0.00780103]
Stock Position:  0.007801025359024226
Bond Position:  [-15.25494976]


portfolio before change:  [-14.4339152]
curr_Stock_Price:  105.36922787655482
curr_Factors:  [105.36922788]
mat_Sqrt:  [[0.15]]
grads:  [0.01248645]
Stock Position:  0.012486450784334194
Bond Position:  [-15.74960288]


portfolio before change:  [-14.43640418]
curr_Stock_Price:  105.24872961837347
curr_Factors:  [105.24872962]
mat_Sqrt:  [[0.15]]
grads:  [0.05440893]
Stock Position:  0.054408928884023745
Bond Position:  [-20.16287482]


portfolio before change:  [-14.48145127]
curr_Stock_Price:  104.44395598643382
curr_Factors:  [104.44395599]
mat_Sqrt:  [[0.15]]
grads:  [0.05890032]
Stock Position:  0.058900316462578595
Bond Position:  [-20.63323333]


portfolio before change:  [-14.50489317]
curr_Stock_Price:  104.06785807217584
curr_Factors:  [104.06785807]
mat_Sqrt:  [[0.15]]
grads:  [0.15854911]
Stock Position:  0.15854911193271334
Bond Position:  [-31.00475965]


portfolio before change:  [-14.49292952]
curr_Stock_Price:  104.1555375972898
curr_Factors:  [104.1555376]
mat_Sqrt:  [[0.15]]
grads:  [0.02244416]
Stock Position:  0.022444162608577345
Bond Position:  [-16.83061334]


portfolio before change:  [-14.50578351]
curr_Stock_Price:  103.6296971143722
curr_Factors:  [103.62969711]
mat_Sqrt:  [[0.15]]
grads:  [-0.08361936]
Stock Position:  -0.08361935749073109
Bond Position:  [-5.84033483]


portfolio before change:  [-14.56046174]
curr_Stock_Price:  104.2792260094375
curr_Factors:  [104.27922601]
mat_Sqrt:  [[0.15]]
grads:  [0.06853689]
Stock Position:  0.0685368898131618
Bond Position:  [-21.70743556]


portfolio before change:  [-14.53991711]
curr_Stock_Price:  104.59878211629311
curr_Factors:  [104.59878212]
mat_Sqrt:  [[0.15]]
grads:  [0.02959785]
Stock Position:  0.029597854646722724
Bond Position:  [-17.63581666]


portfolio before change:  [-14.57179449]
curr_Stock_Price:  103.55900734425185
curr_Factors:  [103.55900734]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611022]
Stock Position:  -0.03611022240077857
Bond Position:  [-10.8322557]


portfolio before change:  [-14.57385853]
curr_Stock_Price:  103.59741768306729
curr_Factors:  [103.59741768]
mat_Sqrt:  [[0.15]]
grads:  [0.10007135]
Stock Position:  0.1000713536589927
Bond Position:  [-24.94099235]


portfolio before change:  [-14.56279601]
curr_Stock_Price:  103.72354146564932
curr_Factors:  [103.72354147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05607912]
Stock Position:  -0.05607912360272929
Bond Position:  [-8.74607071]


portfolio before change:  [-14.55003388]
curr_Stock_Price:  103.48621991715919
curr_Factors:  [103.48621992]
mat_Sqrt:  [[0.15]]
grads:  [0.03199623]
Stock Position:  0.03199622624954155
Bond Position:  [-17.86120238]


portfolio before change:  [-14.56014693]
curr_Stock_Price:  103.20503991651893
curr_Factors:  [103.20503992]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552963]
Stock Position:  -0.08552963294401954
Bond Position:  [-5.73305775]


portfolio before change:  [-14.5016024]
curr_Stock_Price:  102.51635620241258
curr_Factors:  [102.5163562]
mat_Sqrt:  [[0.15]]
grads:  [0.08188811]
Stock Position:  0.08188811269018763
Bond Position:  [-22.89647333]


portfolio before change:  [-14.51218904]
curr_Stock_Price:  102.40455035380239
curr_Factors:  [102.40455035]
mat_Sqrt:  [[0.15]]
grads:  [0.00310942]
Stock Position:  0.0031094171377397677
Bond Position:  [-14.8306075]


portfolio before change:  [-14.51021506]
curr_Stock_Price:  103.33749828129135
curr_Factors:  [103.33749828]
mat_Sqrt:  [[0.15]]
grads:  [0.15355447]
Stock Position:  0.15355446950359394
Bond Position:  [-30.37814979]


portfolio before change:  [-14.49706546]
curr_Stock_Price:  103.43549798737601
curr_Factors:  [103.43549799]
mat_Sqrt:  [[0.15]]
grads:  [-0.15415161]
Stock Position:  -0.1541516097439731
Bond Position:  [1.44768306]


portfolio before change:  [-14.52725235]
curr_Stock_Price:  103.6319109676022
curr_Factors:  [103.63191097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00109721]
Stock Position:  -0.0010972117040847103
Bond Position:  [-14.41354621]


portfolio before change:  [-14.5276016]
curr_Stock_Price:  103.12915927594004
curr_Factors:  [103.12915928]
mat_Sqrt:  [[0.15]]
grads:  [-0.05447745]
Stock Position:  -0.05447744719135802
Bond Position:  [-8.90938827]


portfolio before change:  [-14.47593512]
curr_Stock_Price:  102.17053615059379
curr_Factors:  [102.17053615]
mat_Sqrt:  [[0.15]]
grads:  [-0.01357148]
Stock Position:  -0.013571484954367722
Bond Position:  [-13.08932922]


portfolio before change:  [-14.48216854]
curr_Stock_Price:  102.56955783204081
curr_Factors:  [102.56955783]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.48216854]
Stock Price:  102.57726211215856
PL:  [-17.05943065]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.02013107e-03]
 [ 3.24923914e-04]
 [ 5.43346567e-04]
 [ 8.35382115e-03]
 [ 4.32191033e-03]
 [ 2.24508831e-02]
 [ 7.66561032e-04]
 [-1.76008886e-02]
 [ 2.57377690e-02]
 [ 4.35803174e-03]
 [ 1.31974969e-02]
 [-6.91534092e-03]
 [ 8.14168966e-03]
 [ 7.89021581e-04]
 [-6.91518932e-03]
 [ 1.28524801e-02]
 [ 7.22220594e-03]
 [-9.07548575e-03]
 [-5.16855520e-04]
 [ 1.46473276e-02]
 [ 1.17058550e-02]
 [-7.92605561e-03]
 [ 6.98854259e-03]
 [ 3.60555816e-02]
 [-7.81207014e-03]
 [-9.39916599e-03]
 [-3.23763288e-03]
 [ 9.94157561e-03]
 [-5.00858099e-02]
 [ 4.16212240e-03]
 [ 4.63034579e-03]
 [-1.00721384e-02]
 [-8.43114466e-03]
 [ 5.66038544e-03]
 [ 1.31908982e-02]
 [ 1.70437622e-02]
 [-3.47778834e-02]
 [ 9.15610458e-03]
 [-1.50581693e-02]
 [ 2.43908160e-02]
 [-5.18955042e-03]
 [-1.31351364e-02]
 [ 2.25462237e-02]
 [ 3.55370111e-03]
 [-8.06112433e-03]
 [-3.83458483e-03]
 [ 8.57057370e-03]
 [-1.08116615e-02]
 [-1.49456182e-02]
 [-6.20482560e-03]
 [ 4.73134372e-02]
 [-9.64254475e-03]
 [ 2.44508457e-03]
 [ 5.36150214e-03]
 [ 5.13841170e-03]
 [-3.37801130e-03]
 [ 4.81893470e-03]
 [-4.76900401e-04]
 [ 1.61052813e-03]
 [ 1.44584628e-02]
 [-2.06557577e-03]
 [ 1.56864288e-02]
 [-1.72259550e-03]
 [-1.24941761e-02]
 [-5.54554069e-03]
 [-1.53749761e-04]
 [-5.44395837e-03]
 [ 1.50659086e-02]
 [-8.23275312e-03]
 [ 1.07944704e-02]
 [-1.20247138e-02]
 [ 1.26122424e-02]
 [ 2.17497146e-03]
 [ 2.18846167e-02]
 [-2.24826123e-02]
 [-9.37218236e-04]
 [-7.78470114e-03]
 [-7.31594207e-03]
 [ 2.96810257e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.67235841]
curr_Stock_Price:  100.10604151017391
curr_Factors:  [100.10604151]
mat_Sqrt:  [[0.15]]
grads:  [0.00680087]
Stock Position:  0.006800873829874042
Bond Position:  [2.99154985]


portfolio before change:  [3.66975106]
curr_Stock_Price:  99.69516339568406
curr_Factors:  [99.6951634]
mat_Sqrt:  [[0.15]]
grads:  [0.00216616]
Stock Position:  0.0021661594272533663
Bond Position:  [3.45379544]


portfolio before change:  [3.67060673]
curr_Stock_Price:  99.99052588519807
curr_Factors:  [99.99052589]
mat_Sqrt:  [[0.15]]
grads:  [0.00362231]
Stock Position:  0.0036223104482016487
Bond Position:  [3.30841]


portfolio before change:  [3.67012366]
curr_Stock_Price:  99.80008062471019
curr_Factors:  [99.80008062]
mat_Sqrt:  [[0.15]]
grads:  [0.05569214]
Stock Position:  0.05569214100506848
Bond Position:  [-1.8879565]


portfolio before change:  [3.67779117]
curr_Stock_Price:  99.93987614081195
curr_Factors:  [99.93987614]
mat_Sqrt:  [[0.15]]
grads:  [0.02881274]
Stock Position:  0.02881273556108498
Bond Position:  [0.79824994]


portfolio before change:  [3.67150036]
curr_Stock_Price:  99.71981018220843
curr_Factors:  [99.71981018]
mat_Sqrt:  [[0.15]]
grads:  [0.14967255]
Stock Position:  0.14967255376034708
Bond Position:  [-11.25381829]


portfolio before change:  [3.68639556]
curr_Stock_Price:  99.8240282658585
curr_Factors:  [99.82402827]
mat_Sqrt:  [[0.15]]
grads:  [0.00511041]
Stock Position:  0.005110406878511468
Bond Position:  [3.17625416]


portfolio before change:  [3.68720585]
curr_Stock_Price:  99.94373801191175
curr_Factors:  [99.94373801]
mat_Sqrt:  [[0.15]]
grads:  [-0.11733926]
Stock Position:  -0.11733925741344918
Bond Position:  [15.41452985]


portfolio before change:  [3.61080174]
curr_Stock_Price:  100.60308724827395
curr_Factors:  [100.60308725]
mat_Sqrt:  [[0.15]]
grads:  [0.17158513]
Stock Position:  0.171585126769433
Bond Position:  [-13.65119174]


portfolio before change:  [3.45286225]
curr_Stock_Price:  99.68758681130727
curr_Factors:  [99.68758681]
mat_Sqrt:  [[0.15]]
grads:  [0.02905354]
Stock Position:  0.029053544936994462
Bond Position:  [0.55658447]


portfolio before change:  [3.45822519]
curr_Stock_Price:  99.87097767468937
curr_Factors:  [99.87097767]
mat_Sqrt:  [[0.15]]
grads:  [0.08798331]
Stock Position:  0.08798331294391565
Bond Position:  [-5.32875429]


portfolio before change:  [3.46401151]
curr_Stock_Price:  99.94052920386255
curr_Factors:  [99.9405292]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610227]
Stock Position:  -0.04610227280025057
Bond Position:  [8.07149705]


portfolio before change:  [3.4369003]
curr_Stock_Price:  100.5395385007912
curr_Factors:  [100.5395385]
mat_Sqrt:  [[0.15]]
grads:  [0.05427793]
Stock Position:  0.05427793105760121
Bond Position:  [-2.02017784]


portfolio before change:  [3.43630529]
curr_Stock_Price:  100.53090249994605
curr_Factors:  [100.5309025]
mat_Sqrt:  [[0.15]]
grads:  [0.00526014]
Stock Position:  0.005260143872891065
Bond Position:  [2.90749828]


portfolio before change:  [3.43706373]
curr_Stock_Price:  100.64053968419906
curr_Factors:  [100.64053968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610126]
Stock Position:  -0.04610126214065507
Bond Position:  [8.07671963]


portfolio before change:  [3.45974629]
curr_Stock_Price:  100.15947368671485
curr_Factors:  [100.15947369]
mat_Sqrt:  [[0.15]]
grads:  [0.0856832]
Stock Position:  0.08568320090893117
Bond Position:  [-5.12223802]


portfolio before change:  [3.38839046]
curr_Stock_Price:  99.33042343714492
curr_Factors:  [99.33042344]
mat_Sqrt:  [[0.15]]
grads:  [0.04814804]
Stock Position:  0.048148039628451114
Bond Position:  [-1.39417471]


portfolio before change:  [3.36583466]
curr_Stock_Price:  98.8637655578173
curr_Factors:  [98.86376556]
mat_Sqrt:  [[0.15]]
grads:  [-0.06050324]
Stock Position:  -0.06050323834811657
Bond Position:  [9.34741263]


portfolio before change:  [3.31837605]
curr_Stock_Price:  99.65781951681663
curr_Factors:  [99.65781952]
mat_Sqrt:  [[0.15]]
grads:  [-0.0034457]
Stock Position:  -0.003445703463541694
Bond Position:  [3.66176735]


portfolio before change:  [3.32027821]
curr_Stock_Price:  99.17220322707422
curr_Factors:  [99.17220323]
mat_Sqrt:  [[0.15]]
grads:  [0.09764885]
Stock Position:  0.0976488507106684
Bond Position:  [-6.36377346]


portfolio before change:  [3.30359008]
curr_Stock_Price:  99.00537711252845
curr_Factors:  [99.00537711]
mat_Sqrt:  [[0.15]]
grads:  [0.07803903]
Stock Position:  0.0780390333531692
Bond Position:  [-4.42269384]


portfolio before change:  [3.34262869]
curr_Stock_Price:  99.5091638623996
curr_Factors:  [99.50916386]
mat_Sqrt:  [[0.15]]
grads:  [-0.05284037]
Stock Position:  -0.05284037071858089
Bond Position:  [8.6007298]


portfolio before change:  [3.33334508]
curr_Stock_Price:  99.69502883784693
curr_Factors:  [99.69502884]
mat_Sqrt:  [[0.15]]
grads:  [0.04659028]
Stock Position:  0.04659028392138283
Bond Position:  [-1.31147462]


portfolio before change:  [3.32550832]
curr_Stock_Price:  99.5285823966904
curr_Factors:  [99.5285824]
mat_Sqrt:  [[0.15]]
grads:  [0.24037054]
Stock Position:  0.24037054375752487
Bond Position:  [-20.59823115]


portfolio before change:  [3.25358254]
curr_Stock_Price:  99.23470968255606
curr_Factors:  [99.23470968]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208047]
Stock Position:  -0.05208046758555812
Bond Position:  [8.42177263]


portfolio before change:  [3.30276437]
curr_Stock_Price:  98.30047364915922
curr_Factors:  [98.30047365]
mat_Sqrt:  [[0.15]]
grads:  [-0.06266111]
Stock Position:  -0.06266110658184436
Bond Position:  [9.46238083]


portfolio before change:  [3.31961179]
curr_Stock_Price:  98.04104630288532
curr_Factors:  [98.0410463]
mat_Sqrt:  [[0.15]]
grads:  [-0.02158422]
Stock Position:  -0.02158421916843149
Bond Position:  [5.43575122]


portfolio before change:  [3.34317452]
curr_Stock_Price:  96.96512222534172
curr_Factors:  [96.96512223]
mat_Sqrt:  [[0.15]]
grads:  [0.06627717]
Stock Position:  0.06627717076627676
Bond Position:  [-3.08339944]


portfolio before change:  [3.2853437]
curr_Stock_Price:  96.09546974654181
curr_Factors:  [96.09546975]
mat_Sqrt:  [[0.15]]
grads:  [-0.3339054]
Stock Position:  -0.33390539925610446
Bond Position:  [35.37213989]


portfolio before change:  [3.15530086]
curr_Stock_Price:  96.49155098029733
curr_Factors:  [96.49155098]
mat_Sqrt:  [[0.15]]
grads:  [0.02774748]
Stock Position:  0.027747482691705905
Bond Position:  [0.47790322]


portfolio before change:  [3.16984503]
curr_Stock_Price:  97.01463616311666
curr_Factors:  [97.01463616]
mat_Sqrt:  [[0.15]]
grads:  [0.03086897]
Stock Position:  0.030868971959759826
Bond Position:  [0.17510294]


portfolio before change:  [3.18165219]
curr_Stock_Price:  97.39677438102586
curr_Factors:  [97.39677438]
mat_Sqrt:  [[0.15]]
grads:  [-0.06714759]
Stock Position:  -0.06714758929761629
Bond Position:  [9.72161079]


portfolio before change:  [3.19828684]
curr_Stock_Price:  97.15809071423492
curr_Factors:  [97.15809071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05620763]
Stock Position:  -0.056207631070640175
Bond Position:  [8.65931296]


portfolio before change:  [3.2166511]
curr_Stock_Price:  96.84099778496991
curr_Factors:  [96.84099778]
mat_Sqrt:  [[0.15]]
grads:  [0.0377359]
Stock Position:  0.03773590291791522
Bond Position:  [-0.43773139]


portfolio before change:  [3.2536284]
curr_Stock_Price:  97.82161968141885
curr_Factors:  [97.82161968]
mat_Sqrt:  [[0.15]]
grads:  [0.08793932]
Stock Position:  0.08793932120269428
Bond Position:  [-5.34873844]


portfolio before change:  [3.31270196]
curr_Stock_Price:  98.49717490107493
curr_Factors:  [98.4971749]
mat_Sqrt:  [[0.15]]
grads:  [0.11362508]
Stock Position:  0.11362508125008285
Bond Position:  [-7.87904754]


portfolio before change:  [3.31472599]
curr_Stock_Price:  98.51932219751598
curr_Factors:  [98.5193222]
mat_Sqrt:  [[0.15]]
grads:  [-0.23185256]
Stock Position:  -0.23185255626322523
Bond Position:  [26.15668268]


portfolio before change:  [3.26005368]
curr_Stock_Price:  98.76217979067638
curr_Factors:  [98.76217979]
mat_Sqrt:  [[0.15]]
grads:  [0.0610407]
Stock Position:  0.06104069722460931
Bond Position:  [-2.76845863]


portfolio before change:  [3.2772809]
curr_Stock_Price:  99.04723957932518
curr_Factors:  [99.04723958]
mat_Sqrt:  [[0.15]]
grads:  [-0.1003878]
Stock Position:  -0.10038779527194569
Bond Position:  [13.2204149]


portfolio before change:  [3.28385995]
curr_Stock_Price:  98.98993424683371
curr_Factors:  [98.98993425]
mat_Sqrt:  [[0.15]]
grads:  [0.16260544]
Stock Position:  0.1626054399377919
Bond Position:  [-12.81244185]


portfolio before change:  [3.31492224]
curr_Stock_Price:  99.18588763845585
curr_Factors:  [99.18588764]
mat_Sqrt:  [[0.15]]
grads:  [-0.034597]
Stock Position:  -0.0345970027767316
Bond Position:  [6.74645667]


portfolio before change:  [3.27795349]
curr_Stock_Price:  100.26662919634732
curr_Factors:  [100.2666292]
mat_Sqrt:  [[0.15]]
grads:  [-0.08756758]
Stock Position:  -0.08756757578162687
Bond Position:  [12.05805914]


portfolio before change:  [3.1957648]
curr_Stock_Price:  101.21381014765369
curr_Factors:  [101.21381015]
mat_Sqrt:  [[0.15]]
grads:  [0.15030816]
Stock Position:  0.1503081577709756
Bond Position:  [-12.01749655]


portfolio before change:  [3.05361863]
curr_Stock_Price:  100.27310905201068
curr_Factors:  [100.27310905]
mat_Sqrt:  [[0.15]]
grads:  [0.02369134]
Stock Position:  0.023691340725157287
Bond Position:  [0.67801424]


portfolio before change:  [3.02890817]
curr_Stock_Price:  99.22830372255095
curr_Factors:  [99.22830372]
mat_Sqrt:  [[0.15]]
grads:  [-0.05374083]
Stock Position:  -0.053740828875175735
Bond Position:  [8.36151946]


portfolio before change:  [2.99801587]
curr_Stock_Price:  99.81286691547233
curr_Factors:  [99.81286692]
mat_Sqrt:  [[0.15]]
grads:  [-0.0255639]
Stock Position:  -0.02556389887832677
Bond Position:  [5.54962191]


portfolio before change:  [2.98031537]
curr_Stock_Price:  100.51883764755256
curr_Factors:  [100.51883765]
mat_Sqrt:  [[0.15]]
grads:  [0.05713716]
Stock Position:  0.057137157996749524
Bond Position:  [-2.76304534]


portfolio before change:  [2.97135739]
curr_Stock_Price:  100.36507985279785
curr_Factors:  [100.36507985]
mat_Sqrt:  [[0.15]]
grads:  [-0.07207774]
Stock Position:  -0.072077743365281
Bond Position:  [10.20544586]


portfolio before change:  [3.00382553]
curr_Stock_Price:  99.92346949949591
curr_Factors:  [99.9234695]
mat_Sqrt:  [[0.15]]
grads:  [-0.09963745]
Stock Position:  -0.09963745437840746
Bond Position:  [12.95994566]


portfolio before change:  [3.03313448]
curr_Stock_Price:  99.63744323149898
curr_Factors:  [99.63744323]
mat_Sqrt:  [[0.15]]
grads:  [-0.0413655]
Stock Position:  -0.0413655039759813
Bond Position:  [7.15468753]


portfolio before change:  [3.0668367]
curr_Stock_Price:  98.8335115955115
curr_Factors:  [98.8335116]
mat_Sqrt:  [[0.15]]
grads:  [0.31542291]
Stock Position:  0.3154229149841079
Bond Position:  [-28.10751763]


portfolio before change:  [3.12941505]
curr_Stock_Price:  99.03747623706624
curr_Factors:  [99.03747624]
mat_Sqrt:  [[0.15]]
grads:  [-0.06428363]
Stock Position:  -0.06428363163537078
Bond Position:  [9.49590369]


portfolio before change:  [3.06622242]
curr_Stock_Price:  100.02973714795841
curr_Factors:  [100.02973715]
mat_Sqrt:  [[0.15]]
grads:  [0.01630056]
Stock Position:  0.01630056379383602
Bond Position:  [1.43568131]


portfolio before change:  [3.07132391]
curr_Stock_Price:  100.33719575613036
curr_Factors:  [100.33719576]
mat_Sqrt:  [[0.15]]
grads:  [0.03574335]
Stock Position:  0.03574334756990326
Bond Position:  [-0.51506336]


portfolio before change:  [3.07930526]
curr_Stock_Price:  100.56139261855826
curr_Factors:  [100.56139262]
mat_Sqrt:  [[0.15]]
grads:  [0.03425608]
Stock Position:  0.03425607802258678
Bond Position:  [-0.36553365]


portfolio before change:  [3.07664982]
curr_Stock_Price:  100.48454237054504
curr_Factors:  [100.48454237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02252008]
Stock Position:  -0.0225200753265542
Bond Position:  [5.33956929]


portfolio before change:  [3.08030202]
curr_Stock_Price:  100.33718675640927
curr_Factors:  [100.33718676]
mat_Sqrt:  [[0.15]]
grads:  [0.03212623]
Stock Position:  0.0321262313232083
Bond Position:  [-0.14315365]


portfolio before change:  [3.10383731]
curr_Stock_Price:  101.07005325140348
curr_Factors:  [101.07005325]
mat_Sqrt:  [[0.15]]
grads:  [-0.00317934]
Stock Position:  -0.0031793360098683614
Bond Position:  [3.42517297]


portfolio before change:  [3.10232526]
curr_Stock_Price:  101.61297457397069
curr_Factors:  [101.61297457]
mat_Sqrt:  [[0.15]]
grads:  [0.01073685]
Stock Position:  0.010736854216144539
Bond Position:  [2.01132156]


portfolio before change:  [3.10135769]
curr_Stock_Price:  101.51114924000704
curr_Factors:  [101.51114924]
mat_Sqrt:  [[0.15]]
grads:  [0.09638975]
Stock Position:  0.09638975182613495
Bond Position:  [-6.6832768]


portfolio before change:  [3.2272727]
curr_Stock_Price:  102.82179405857543
curr_Factors:  [102.82179406]
mat_Sqrt:  [[0.15]]
grads:  [-0.01377051]
Stock Position:  -0.013770505140326787
Bond Position:  [4.64318074]


portfolio before change:  [3.22683475]
curr_Stock_Price:  102.87467199508407
curr_Factors:  [102.874672]
mat_Sqrt:  [[0.15]]
grads:  [0.10457619]
Stock Position:  0.1045761917897148
Bond Position:  [-7.53140668]


portfolio before change:  [3.15886774]
curr_Stock_Price:  102.22924512995901
curr_Factors:  [102.22924513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01148397]
Stock Position:  -0.011483970002122089
Bond Position:  [4.33286532]


portfolio before change:  [3.1623829]
curr_Stock_Price:  101.94673433889882
curr_Factors:  [101.94673434]
mat_Sqrt:  [[0.15]]
grads:  [-0.08329451]
Stock Position:  -0.08329450739073539
Bond Position:  [11.65398591]


portfolio before change:  [3.2272999]
curr_Stock_Price:  101.17611199428076
curr_Factors:  [101.17611199]
mat_Sqrt:  [[0.15]]
grads:  [-0.03697027]
Stock Position:  -0.0369702712865438
Bond Position:  [6.96780821]


portfolio before change:  [3.23300429]
curr_Stock_Price:  101.03359525842691
curr_Factors:  [101.03359526]
mat_Sqrt:  [[0.15]]
grads:  [-0.001025]
Stock Position:  -0.0010249984089957809
Bond Position:  [3.33656356]


portfolio before change:  [3.23214214]
curr_Stock_Price:  102.07816814568166
curr_Factors:  [102.07816815]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629306]
Stock Position:  -0.03629305579615985
Bond Position:  [6.93687079]


portfolio before change:  [3.23172807]
curr_Stock_Price:  102.10152354345522
curr_Factors:  [102.10152354]
mat_Sqrt:  [[0.15]]
grads:  [0.10043939]
Stock Position:  0.1004393906535985
Bond Position:  [-7.02328674]


portfolio before change:  [3.28459782]
curr_Stock_Price:  102.63227866508988
curr_Factors:  [102.63227867]
mat_Sqrt:  [[0.15]]
grads:  [-0.05488502]
Stock Position:  -0.05488502081909039
Bond Position:  [8.91757257]


portfolio before change:  [3.29281587]
curr_Stock_Price:  102.49270167850091
curr_Factors:  [102.49270168]
mat_Sqrt:  [[0.15]]
grads:  [0.07196314]
Stock Position:  0.0719631359558507
Bond Position:  [-4.08288035]


portfolio before change:  [3.30539379]
curr_Stock_Price:  102.67103057493308
curr_Factors:  [102.67103057]
mat_Sqrt:  [[0.15]]
grads:  [-0.08016476]
Stock Position:  -0.0801647583861888
Bond Position:  [11.53599215]


portfolio before change:  [3.28210503]
curr_Stock_Price:  102.97053601487268
curr_Factors:  [102.97053601]
mat_Sqrt:  [[0.15]]
grads:  [0.08408162]
Stock Position:  0.0840816158429703
Bond Position:  [-5.37582402]


portfolio before change:  [3.31128289]
curr_Stock_Price:  103.32155037894051
curr_Factors:  [103.32155038]
mat_Sqrt:  [[0.15]]
grads:  [0.01449981]
Stock Position:  0.014499809736451461
Bond Position:  [1.81314007]


portfolio before change:  [3.30360061]
curr_Stock_Price:  102.7839151147761
curr_Factors:  [102.78391511]
mat_Sqrt:  [[0.15]]
grads:  [0.14589744]
Stock Position:  0.14589744447632638
Bond Position:  [-11.69230994]


portfolio before change:  [3.24367029]
curr_Stock_Price:  102.37815390728777
curr_Factors:  [102.37815391]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988408]
Stock Position:  -0.14988408181360655
Bond Position:  [18.58852589]


portfolio before change:  [3.15522926]
curr_Stock_Price:  102.97596821317123
curr_Factors:  [102.97596821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624812]
Stock Position:  -0.006248121572725801
Bond Position:  [3.79863563]


portfolio before change:  [3.15370896]
curr_Stock_Price:  103.25728904586887
curr_Factors:  [103.25728905]
mat_Sqrt:  [[0.15]]
grads:  [-0.05189801]
Stock Position:  -0.05189800757067369
Bond Position:  [8.51255652]


portfolio before change:  [3.12877509]
curr_Stock_Price:  103.74798074959959
curr_Factors:  [103.74798075]
mat_Sqrt:  [[0.15]]
grads:  [-0.04877295]
Stock Position:  -0.04877294712760232
Bond Position:  [8.18886987]


portfolio before change:  [3.13045841]
curr_Stock_Price:  103.72396114144755
curr_Factors:  [103.72396114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.13045841]
Stock Price:  103.65449241357469
PL:  [-0.524034]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.08649730e-04]
 [ 6.88047663e-04]
 [-7.23109074e-04]
 [ 7.99096080e-03]
 [ 4.17889845e-03]
 [ 2.05776132e-02]
 [ 1.31441754e-03]
 [-1.92705209e-02]
 [-1.14788379e-02]
 [ 1.90118551e-02]
 [ 1.45832060e-02]
 [ 1.88481399e-02]
 [-1.30850084e-02]
 [ 1.23672692e-02]
 [-6.93488264e-03]
 [ 6.04390439e-03]
 [ 8.49698155e-03]
 [-8.88893553e-03]
 [ 1.62644082e-03]
 [ 9.56033432e-03]
 [ 1.21808521e-02]
 [-9.55744044e-03]
 [ 5.79823746e-03]
 [ 1.44345559e-02]
 [-8.10265385e-03]
 [-4.82971731e-03]
 [-6.77036752e-03]
 [ 7.34978135e-03]
 [-1.44250937e-02]
 [-2.80256475e-04]
 [-4.69557067e-03]
 [-1.00939717e-02]
 [-9.06833135e-03]
 [ 5.55892710e-03]
 [ 1.30655358e-02]
 [ 1.59914526e-02]
 [-3.46518731e-02]
 [ 8.83812919e-03]
 [-1.93552336e-02]
 [ 1.94137761e-02]
 [-7.20398590e-03]
 [ 1.54879400e-03]
 [ 2.30314807e-02]
 [ 4.23856892e-03]
 [-1.06426596e-03]
 [-8.00494770e-04]
 [ 2.00490755e-03]
 [-1.19327864e-02]
 [ 3.34461335e-03]
 [-2.20585862e-03]
 [ 4.37667356e-02]
 [-1.03413659e-02]
 [ 3.38377351e-03]
 [ 5.38410623e-03]
 [ 5.33102586e-03]
 [-1.70774467e-03]
 [ 2.69395676e-03]
 [-5.60447104e-04]
 [ 1.52825532e-03]
 [-1.10548576e-02]
 [-3.55499656e-03]
 [ 5.44503122e-03]
 [ 4.15537127e-03]
 [-1.73015670e-02]
 [-1.22362148e-02]
 [-1.63431061e-03]
 [-4.87126393e-03]
 [ 1.91982773e-02]
 [-1.03130114e-02]
 [ 8.50230475e-03]
 [-1.59109734e-03]
 [ 1.14395475e-02]
 [-5.46521451e-04]
 [ 3.90460708e-03]
 [-8.34438077e-03]
 [-1.16505521e-02]
 [ 3.06727629e-03]
 [ 4.18480960e-03]
 [-3.98123238e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.53293784]
curr_Stock_Price:  100.16200065257492
curr_Factors:  [100.16200065]
mat_Sqrt:  [[0.15]]
grads:  [0.005391]
Stock Position:  0.005390998201323964
Bond Position:  [3.99296468]


portfolio before change:  [4.53719184]
curr_Stock_Price:  100.90479922133053
curr_Factors:  [100.90479922]
mat_Sqrt:  [[0.15]]
grads:  [0.00458698]
Stock Position:  0.004586984420229508
Bond Position:  [4.0743431]


portfolio before change:  [4.53461045]
curr_Stock_Price:  100.28651850134162
curr_Factors:  [100.2865185]
mat_Sqrt:  [[0.15]]
grads:  [-0.00482073]
Stock Position:  -0.004820727160676642
Bond Position:  [5.01806439]


portfolio before change:  [4.53986563]
curr_Stock_Price:  99.26145749018892
curr_Factors:  [99.26145749]
mat_Sqrt:  [[0.15]]
grads:  [0.05327307]
Stock Position:  0.05327307202030725
Bond Position:  [-0.74809715]


portfolio before change:  [4.58526167]
curr_Stock_Price:  100.11447388432569
curr_Factors:  [100.11447388]
mat_Sqrt:  [[0.15]]
grads:  [0.02785932]
Stock Position:  0.0278593229823062
Bond Position:  [1.79614021]


portfolio before change:  [4.56606859]
curr_Stock_Price:  99.42151574323132
curr_Factors:  [99.42151574]
mat_Sqrt:  [[0.15]]
grads:  [0.13718409]
Stock Position:  0.1371840877378302
Bond Position:  [-9.07298135]


portfolio before change:  [4.52373263]
curr_Stock_Price:  99.11704252322977
curr_Factors:  [99.11704252]
mat_Sqrt:  [[0.15]]
grads:  [0.00876278]
Stock Position:  0.00876278357845363
Bond Position:  [3.65519144]


portfolio before change:  [4.52170403]
curr_Stock_Price:  98.85946996040731
curr_Factors:  [98.85946996]
mat_Sqrt:  [[0.15]]
grads:  [-0.12847014]
Stock Position:  -0.12847013927545867
Bond Position:  [17.22219391]


portfolio before change:  [4.62349242]
curr_Stock_Price:  98.07553708576742
curr_Factors:  [98.07553709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07652559]
Stock Position:  -0.07652558606664482
Bond Position:  [12.12878037]


portfolio before change:  [4.5303378]
curr_Stock_Price:  99.30274360118635
curr_Factors:  [99.3027436]
mat_Sqrt:  [[0.15]]
grads:  [0.1267457]
Stock Position:  0.12674570080808917
Bond Position:  [-8.05585803]


portfolio before change:  [4.53552493]
curr_Stock_Price:  99.34764172136259
curr_Factors:  [99.34764172]
mat_Sqrt:  [[0.15]]
grads:  [0.09722137]
Stock Position:  0.09722137328821301
Bond Position:  [-5.12318923]


portfolio before change:  [4.5058067]
curr_Stock_Price:  99.04525943440656
curr_Factors:  [99.04525943]
mat_Sqrt:  [[0.15]]
grads:  [0.12565427]
Stock Position:  0.12565426596979115
Bond Position:  [-7.93965267]


portfolio before change:  [4.53262226]
curr_Stock_Price:  99.26261618568786
curr_Factors:  [99.26261619]
mat_Sqrt:  [[0.15]]
grads:  [-0.08723339]
Stock Position:  -0.08723338963815559
Bond Position:  [13.19163673]


portfolio before change:  [4.51287348]
curr_Stock_Price:  99.4984580561376
curr_Factors:  [99.49845806]
mat_Sqrt:  [[0.15]]
grads:  [0.08244846]
Stock Position:  0.08244846138851974
Bond Position:  [-3.6906213]


portfolio before change:  [4.49177163]
curr_Stock_Price:  99.24531599427877
curr_Factors:  [99.24531599]
mat_Sqrt:  [[0.15]]
grads:  [-0.04623255]
Stock Position:  -0.04623255093765486
Bond Position:  [9.08013576]


portfolio before change:  [4.51363747]
curr_Stock_Price:  98.78463817876246
curr_Factors:  [98.78463818]
mat_Sqrt:  [[0.15]]
grads:  [0.0402927]
Stock Position:  0.040292695950715766
Bond Position:  [0.53333808]


portfolio before change:  [4.49275192]
curr_Stock_Price:  98.26546494386254
curr_Factors:  [98.26546494]
mat_Sqrt:  [[0.15]]
grads:  [0.05664654]
Stock Position:  0.05664654369528029
Bond Position:  [-1.07364704]


portfolio before change:  [4.51813739]
curr_Stock_Price:  98.71478772490123
curr_Factors:  [98.71478772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05925957]
Stock Position:  -0.059259570187825156
Bond Position:  [10.36793328]


portfolio before change:  [4.5549774]
curr_Stock_Price:  98.10405107995281
curr_Factors:  [98.10405108]
mat_Sqrt:  [[0.15]]
grads:  [0.01084294]
Stock Position:  0.01084293877604072
Bond Position:  [3.49124118]


portfolio before change:  [4.55296868]
curr_Stock_Price:  97.89867000287474
curr_Factors:  [97.89867]
mat_Sqrt:  [[0.15]]
grads:  [0.06373556]
Stock Position:  0.06373556210497201
Bond Position:  [-1.68665809]


portfolio before change:  [4.57696069]
curr_Stock_Price:  98.27675453098747
curr_Factors:  [98.27675453]
mat_Sqrt:  [[0.15]]
grads:  [0.08120568]
Stock Position:  0.08120568096593746
Bond Position:  [-3.40367009]


portfolio before change:  [4.5478761]
curr_Stock_Price:  97.92121481184383
curr_Factors:  [97.92121481]
mat_Sqrt:  [[0.15]]
grads:  [-0.06371627]
Stock Position:  -0.06371626958317131
Bond Position:  [10.78705063]


portfolio before change:  [4.55014337]
curr_Stock_Price:  97.89621244760876
curr_Factors:  [97.89621245]
mat_Sqrt:  [[0.15]]
grads:  [0.03865492]
Stock Position:  0.03865491638474712
Bond Position:  [0.76597347]


portfolio before change:  [4.58536722]
curr_Stock_Price:  98.80621245495315
curr_Factors:  [98.80621245]
mat_Sqrt:  [[0.15]]
grads:  [0.09623037]
Stock Position:  0.096230372734139
Bond Position:  [-4.92279143]


portfolio before change:  [4.54493635]
curr_Stock_Price:  98.38926318288043
curr_Factors:  [98.38926318]
mat_Sqrt:  [[0.15]]
grads:  [-0.05401769]
Stock Position:  -0.05401769233715606
Bond Position:  [9.8596973]


portfolio before change:  [4.52012435]
curr_Stock_Price:  98.86000259097086
curr_Factors:  [98.86000259]
mat_Sqrt:  [[0.15]]
grads:  [-0.03219812]
Stock Position:  -0.032198115377018305
Bond Position:  [7.70323012]


portfolio before change:  [4.50237856]
curr_Stock_Price:  99.42609943839474
curr_Factors:  [99.42609944]
mat_Sqrt:  [[0.15]]
grads:  [-0.04513578]
Stock Position:  -0.0451357834799909
Bond Position:  [8.99005346]


portfolio before change:  [4.54957417]
curr_Stock_Price:  98.39291230554934
curr_Factors:  [98.39291231]
mat_Sqrt:  [[0.15]]
grads:  [0.04899854]
Stock Position:  0.048998542366159754
Bond Position:  [-0.27153511]


portfolio before change:  [4.5585773]
curr_Stock_Price:  98.57700144246418
curr_Factors:  [98.57700144]
mat_Sqrt:  [[0.15]]
grads:  [-0.09616729]
Stock Position:  -0.09616729156953009
Bond Position:  [14.03846054]


portfolio before change:  [4.5692597]
curr_Stock_Price:  98.47504398801748
curr_Factors:  [98.47504399]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186838]
Stock Position:  -0.0018683764974576503
Bond Position:  [4.75324816]


portfolio before change:  [4.56914789]
curr_Stock_Price:  98.69389543740095
curr_Factors:  [98.69389544]
mat_Sqrt:  [[0.15]]
grads:  [-0.0313038]
Stock Position:  -0.0313038044645791
Bond Position:  [7.6586423]


portfolio before change:  [4.60480274]
curr_Stock_Price:  97.57019280899159
curr_Factors:  [97.57019281]
mat_Sqrt:  [[0.15]]
grads:  [-0.06729314]
Stock Position:  -0.06729314497729857
Bond Position:  [11.17060787]


portfolio before change:  [4.60328499]
curr_Stock_Price:  97.60312238943814
curr_Factors:  [97.60312239]
mat_Sqrt:  [[0.15]]
grads:  [-0.06045554]
Stock Position:  -0.06045554233252137
Bond Position:  [10.50393469]


portfolio before change:  [4.63214795]
curr_Stock_Price:  97.13655724718784
curr_Factors:  [97.13655725]
mat_Sqrt:  [[0.15]]
grads:  [0.03705951]
Stock Position:  0.03705951398742809
Bond Position:  [1.03231435]


portfolio before change:  [4.66118342]
curr_Stock_Price:  97.9182984255998
curr_Factors:  [97.91829843]
mat_Sqrt:  [[0.15]]
grads:  [0.08710357]
Stock Position:  0.08710357217705678
Bond Position:  [-3.86785015]


portfolio before change:  [4.6470874]
curr_Stock_Price:  97.7592432732357
curr_Factors:  [97.75924327]
mat_Sqrt:  [[0.15]]
grads:  [0.10660968]
Stock Position:  0.10660968391748439
Bond Position:  [-5.77499462]


portfolio before change:  [4.70061745]
curr_Stock_Price:  98.26474136894498
curr_Factors:  [98.26474137]
mat_Sqrt:  [[0.15]]
grads:  [-0.23101249]
Stock Position:  -0.23101248755384113
Bond Position:  [27.40099979]


portfolio before change:  [4.76270283]
curr_Stock_Price:  98.00340152331901
curr_Factors:  [98.00340152]
mat_Sqrt:  [[0.15]]
grads:  [0.05892086]
Stock Position:  0.05892086123749858
Bond Position:  [-1.01174199]


portfolio before change:  [4.77181249]
curr_Stock_Price:  98.1590831407364
curr_Factors:  [98.15908314]
mat_Sqrt:  [[0.15]]
grads:  [-0.12903489]
Stock Position:  -0.129034890364833
Bond Position:  [17.43775902]


portfolio before change:  [4.81711285]
curr_Stock_Price:  97.81645900599217
curr_Factors:  [97.81645901]
mat_Sqrt:  [[0.15]]
grads:  [0.12942517]
Stock Position:  0.12942517388361774
Bond Position:  [-7.84279936]


portfolio before change:  [4.83808127]
curr_Stock_Price:  97.98225836085489
curr_Factors:  [97.98225836]
mat_Sqrt:  [[0.15]]
grads:  [-0.04802657]
Stock Position:  -0.04802657268715907
Bond Position:  [9.54383333]


portfolio before change:  [4.78983882]
curr_Stock_Price:  98.99917367743197
curr_Factors:  [98.99917368]
mat_Sqrt:  [[0.15]]
grads:  [0.01032529]
Stock Position:  0.010325293351119749
Bond Position:  [3.76764331]


portfolio before change:  [4.78763993]
curr_Stock_Price:  98.76340547771282
curr_Factors:  [98.76340548]
mat_Sqrt:  [[0.15]]
grads:  [0.1535432]
Stock Position:  0.15354320454650314
Bond Position:  [-10.37680984]


portfolio before change:  [4.58989554]
curr_Stock_Price:  97.47975490286345
curr_Factors:  [97.4797549]
mat_Sqrt:  [[0.15]]
grads:  [0.02825713]
Stock Position:  0.028257126154638216
Bond Position:  [1.83539781]


portfolio before change:  [4.60002905]
curr_Stock_Price:  97.83431303490336
curr_Factors:  [97.83431303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00709511]
Stock Position:  -0.007095106417462895
Bond Position:  [5.29417391]


portfolio before change:  [4.60034058]
curr_Stock_Price:  97.83704211836046
curr_Factors:  [97.83704212]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533663]
Stock Position:  -0.005336631802830514
Bond Position:  [5.12246085]


portfolio before change:  [4.60219933]
curr_Stock_Price:  97.54873542656671
curr_Factors:  [97.54873543]
mat_Sqrt:  [[0.15]]
grads:  [0.01336605]
Stock Position:  0.013366050301432873
Bond Position:  [3.29835803]


portfolio before change:  [4.59892958]
curr_Stock_Price:  97.28868037064588
curr_Factors:  [97.28868037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07955191]
Stock Position:  -0.0795519090307563
Bond Position:  [12.33842983]


portfolio before change:  [4.66371037]
curr_Stock_Price:  96.48405333822626
curr_Factors:  [96.48405334]
mat_Sqrt:  [[0.15]]
grads:  [0.02229742]
Stock Position:  0.02229742234588932
Bond Position:  [2.51236468]


portfolio before change:  [4.69393751]
curr_Stock_Price:  97.83264477371327
curr_Factors:  [97.83264477]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470572]
Stock Position:  -0.014705724157295907
Bond Position:  [6.1326374]


portfolio before change:  [4.69758879]
curr_Stock_Price:  97.61042001355514
curr_Factors:  [97.61042001]
mat_Sqrt:  [[0.15]]
grads:  [0.29177824]
Stock Position:  0.2917782371724097
Bond Position:  [-23.78300749]


portfolio before change:  [4.87714636]
curr_Stock_Price:  98.23090513217711
curr_Factors:  [98.23090513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06894244]
Stock Position:  -0.06894243907620122
Bond Position:  [11.64942455]


portfolio before change:  [4.82377696]
curr_Stock_Price:  99.01558160707548
curr_Factors:  [99.01558161]
mat_Sqrt:  [[0.15]]
grads:  [0.02255849]
Stock Position:  0.022558490097390072
Bond Position:  [2.59013494]


portfolio before change:  [4.8234476]
curr_Stock_Price:  98.99380479970762
curr_Factors:  [98.9938048]
mat_Sqrt:  [[0.15]]
grads:  [0.03589404]
Stock Position:  0.03589404155108652
Bond Position:  [1.27015985]


portfolio before change:  [4.79594596]
curr_Stock_Price:  98.22540360417781
curr_Factors:  [98.2254036]
mat_Sqrt:  [[0.15]]
grads:  [0.03554017]
Stock Position:  0.03554017243327347
Bond Position:  [1.30499818]


portfolio before change:  [4.77378386]
curr_Stock_Price:  97.5995298496616
curr_Factors:  [97.59952985]
mat_Sqrt:  [[0.15]]
grads:  [-0.01138496]
Stock Position:  -0.011384964441079662
Bond Position:  [5.88495104]


portfolio before change:  [4.77761064]
curr_Stock_Price:  97.29571208153178
curr_Factors:  [97.29571208]
mat_Sqrt:  [[0.15]]
grads:  [0.01795971]
Stock Position:  0.01795971170813978
Bond Position:  [3.0302077]


portfolio before change:  [4.7714992]
curr_Stock_Price:  96.94488053022376
curr_Factors:  [96.94488053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00373631]
Stock Position:  -0.0037363140278004066
Bond Position:  [5.13371572]


portfolio before change:  [4.76876108]
curr_Stock_Price:  97.7635984375746
curr_Factors:  [97.76359844]
mat_Sqrt:  [[0.15]]
grads:  [0.01018837]
Stock Position:  0.010188368826887614
Bond Position:  [3.77270948]


portfolio before change:  [4.76089616]
curr_Stock_Price:  96.96850322601829
curr_Factors:  [96.96850323]
mat_Sqrt:  [[0.15]]
grads:  [-0.07369905]
Stock Position:  -0.07369905055963714
Bond Position:  [11.90738278]


portfolio before change:  [4.74922644]
curr_Stock_Price:  97.13694441900748
curr_Factors:  [97.13694442]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369998]
Stock Position:  -0.023699977035093352
Bond Position:  [7.05136979]


portfolio before change:  [4.74506055]
curr_Stock_Price:  97.3313161947395
curr_Factors:  [97.33131619]
mat_Sqrt:  [[0.15]]
grads:  [0.03630021]
Stock Position:  0.03630020813783075
Bond Position:  [1.21191352]


portfolio before change:  [4.7897668]
curr_Stock_Price:  98.56079961143347
curr_Factors:  [98.56079961]
mat_Sqrt:  [[0.15]]
grads:  [0.02770248]
Stock Position:  0.027702475101201367
Bond Position:  [2.05938871]


portfolio before change:  [4.79829588]
curr_Stock_Price:  98.86403448312133
curr_Factors:  [98.86403448]
mat_Sqrt:  [[0.15]]
grads:  [-0.11534378]
Stock Position:  -0.11534377992826433
Bond Position:  [16.20164731]


portfolio before change:  [4.85005296]
curr_Stock_Price:  98.42409353283475
curr_Factors:  [98.42409353]
mat_Sqrt:  [[0.15]]
grads:  [-0.08157477]
Stock Position:  -0.08157476534142126
Bond Position:  [12.8789753]


portfolio before change:  [4.81954845]
curr_Stock_Price:  98.80790674502659
curr_Factors:  [98.80790675]
mat_Sqrt:  [[0.15]]
grads:  [-0.0108954]
Stock Position:  -0.010895404063665515
Bond Position:  [5.89610052]


portfolio before change:  [4.82360055]
curr_Stock_Price:  98.46982085807306
curr_Factors:  [98.46982086]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247509]
Stock Position:  -0.03247509288642545
Bond Position:  [8.02141713]


portfolio before change:  [4.8370428]
curr_Stock_Price:  98.071334071649
curr_Factors:  [98.07133407]
mat_Sqrt:  [[0.15]]
grads:  [0.12798852]
Stock Position:  0.12798851508795614
Bond Position:  [-7.71496162]


portfolio before change:  [4.78734312]
curr_Stock_Price:  97.686787968313
curr_Factors:  [97.68678797]
mat_Sqrt:  [[0.15]]
grads:  [-0.06875341]
Stock Position:  -0.06875340923514861
Bond Position:  [11.50364283]


portfolio before change:  [4.82215243]
curr_Stock_Price:  97.19095344567691
curr_Factors:  [97.19095345]
mat_Sqrt:  [[0.15]]
grads:  [0.05668203]
Stock Position:  0.056682031641927325
Bond Position:  [-0.68682827]


portfolio before change:  [4.81219773]
curr_Stock_Price:  97.01608716873864
curr_Factors:  [97.01608717]
mat_Sqrt:  [[0.15]]
grads:  [-0.01060732]
Stock Position:  -0.010607315625492202
Bond Position:  [5.84127798]


portfolio before change:  [4.80675541]
curr_Stock_Price:  97.56357783359813
curr_Factors:  [97.56357783]
mat_Sqrt:  [[0.15]]
grads:  [0.07626365]
Stock Position:  0.07626365002922504
Bond Position:  [-2.63379914]


portfolio before change:  [4.78835192]
curr_Stock_Price:  97.32442227622296
curr_Factors:  [97.32442228]
mat_Sqrt:  [[0.15]]
grads:  [-0.00364348]
Stock Position:  -0.0036434763373984543
Bond Position:  [5.14295115]


portfolio before change:  [4.79004521]
curr_Stock_Price:  96.94790207439934
curr_Factors:  [96.94790207]
mat_Sqrt:  [[0.15]]
grads:  [0.02603071]
Stock Position:  0.026030713875392155
Bond Position:  [2.26642211]


portfolio before change:  [4.79633387]
curr_Stock_Price:  97.184046495721
curr_Factors:  [97.1840465]
mat_Sqrt:  [[0.15]]
grads:  [-0.05562921]
Stock Position:  -0.055629205153446264
Bond Position:  [10.20260513]


portfolio before change:  [4.81451644]
curr_Stock_Price:  96.86865661913635
curr_Factors:  [96.86865662]
mat_Sqrt:  [[0.15]]
grads:  [-0.07767035]
Stock Position:  -0.07767034747276946
Bond Position:  [12.33833866]


portfolio before change:  [4.78670328]
curr_Stock_Price:  97.23667778981347
curr_Factors:  [97.23667779]
mat_Sqrt:  [[0.15]]
grads:  [0.02044851]
Stock Position:  0.020448508617467935
Bond Position:  [2.79835823]


portfolio before change:  [4.78047788]
curr_Stock_Price:  96.92368186254197
curr_Factors:  [96.92368186]
mat_Sqrt:  [[0.15]]
grads:  [0.02789873]
Stock Position:  0.0278987306335143
Bond Position:  [2.07643019]


portfolio before change:  [4.75470423]
curr_Stock_Price:  95.99520119732315
curr_Factors:  [95.9952012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.75470423]
Stock Price:  95.36676992541675
PL:  [4.75470423]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.43408661e-04]
 [ 4.28880373e-04]
 [-2.61649506e-03]
 [ 7.25066494e-03]
 [ 4.80597286e-03]
 [ 2.42971726e-02]
 [ 6.85109564e-04]
 [-1.43081495e-02]
 [ 2.52216021e-02]
 [-4.45855930e-03]
 [ 1.54595420e-02]
 [-5.00341921e-02]
 [ 5.16336287e-02]
 [ 4.56962761e-03]
 [-6.90093692e-03]
 [ 2.67127049e-02]
 [ 1.18406492e-02]
 [ 1.68949929e-03]
 [ 9.85967913e-03]
 [-8.59564565e-03]
 [ 1.50576875e-02]
 [-1.79406527e-02]
 [ 1.06459771e-02]
 [-9.37858184e-02]
 [ 1.64041406e-02]
 [ 4.38446416e-03]
 [-2.76769726e-03]
 [ 2.93582451e-02]
 [ 8.50970915e-02]
 [ 1.25415983e-02]
 [ 2.46597341e-02]
 [ 1.43460906e-02]
 [-7.62476281e-03]
 [ 6.63273857e-03]
 [ 9.34782110e-03]
 [ 1.67590711e-03]
 [-3.08328669e-02]
 [ 8.17679160e-03]
 [ 2.41200408e-02]
 [-1.40811834e-02]
 [-7.98944646e-03]
 [-1.14238688e-02]
 [ 1.94442678e-02]
 [-1.07255301e-02]
 [ 2.59272663e-02]
 [-6.37444209e-03]
 [ 1.53471030e-02]
 [ 2.21404677e-02]
 [ 8.17047873e-03]
 [-7.50107303e-03]
 [ 1.14888424e-04]
 [ 3.96733748e-03]
 [-9.54142944e-03]
 [ 5.88371136e-03]
 [-1.13244134e-02]
 [ 1.60292930e-02]
 [ 1.01863378e-02]
 [ 1.08984533e-04]
 [ 1.77372080e-03]
 [ 1.66001935e-02]
 [ 4.96541666e-03]
 [ 2.35087058e-02]
 [ 3.79723336e-03]
 [-1.24345425e-02]
 [ 7.60745994e-03]
 [ 2.12263934e-03]
 [-5.44352976e-03]
 [ 1.50652895e-02]
 [-8.32442439e-03]
 [ 1.08410043e-02]
 [-1.21935539e-02]
 [ 1.22836880e-02]
 [ 1.43895812e-03]
 [ 2.23333124e-02]
 [-2.28796853e-02]
 [-1.05001354e-04]
 [-1.12025841e-03]
 [-9.18312019e-03]
 [ 3.05788608e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.98456435]
curr_Stock_Price:  100.12634268852207
curr_Factors:  [100.12634269]
mat_Sqrt:  [[0.15]]
grads:  [0.00628939]
Stock Position:  0.006289391070206386
Bond Position:  [3.35483062]


portfolio before change:  [3.98988078]
curr_Stock_Price:  100.93830507742443
curr_Factors:  [100.93830508]
mat_Sqrt:  [[0.15]]
grads:  [0.0028592]
Stock Position:  0.0028592024899929775
Bond Position:  [3.70127773]


portfolio before change:  [3.98906902]
curr_Stock_Price:  100.57348350610143
curr_Factors:  [100.57348351]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174433]
Stock Position:  -0.017443300419156406
Bond Position:  [5.74340251]


portfolio before change:  [3.99727668]
curr_Stock_Price:  100.12352931252094
curr_Factors:  [100.12352931]
mat_Sqrt:  [[0.15]]
grads:  [0.04833777]
Stock Position:  0.04833776627222377
Bond Position:  [-0.84247108]


portfolio before change:  [3.98188346]
curr_Stock_Price:  99.80616748738346
curr_Factors:  [99.80616749]
mat_Sqrt:  [[0.15]]
grads:  [0.03203982]
Stock Position:  0.03203981909218352
Bond Position:  [0.78411191]


portfolio before change:  [3.98858524]
curr_Stock_Price:  100.01380833828794
curr_Factors:  [100.01380834]
mat_Sqrt:  [[0.15]]
grads:  [0.16198115]
Stock Position:  0.16198115057989224
Bond Position:  [-12.2117665]


portfolio before change:  [3.94392825]
curr_Stock_Price:  99.74282785334746
curr_Factors:  [99.74282785]
mat_Sqrt:  [[0.15]]
grads:  [0.0045674]
Stock Position:  0.004567397090391672
Bond Position:  [3.48836315]


portfolio before change:  [3.94718586]
curr_Stock_Price:  100.40832291422686
curr_Factors:  [100.40832291]
mat_Sqrt:  [[0.15]]
grads:  [-0.09538766]
Stock Position:  -0.09538766335148674
Bond Position:  [13.52490117]


portfolio before change:  [3.9410308]
curr_Stock_Price:  100.48171181848184
curr_Factors:  [100.48171182]
mat_Sqrt:  [[0.15]]
grads:  [0.16814401]
Stock Position:  0.16814401405069287
Bond Position:  [-12.95436756]


portfolio before change:  [3.99826029]
curr_Stock_Price:  100.82688712662853
curr_Factors:  [100.82688713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02972373]
Stock Position:  -0.029723728696715336
Bond Position:  [6.99521133]


portfolio before change:  [3.99731738]
curr_Stock_Price:  100.87331901180019
curr_Factors:  [100.87331901]
mat_Sqrt:  [[0.15]]
grads:  [0.10306361]
Stock Position:  0.10306361344312459
Bond Position:  [-6.39905138]


portfolio before change:  [4.05290885]
curr_Stock_Price:  101.41658958183336
curr_Factors:  [101.41658958]
mat_Sqrt:  [[0.15]]
grads:  [-0.33356128]
Stock Position:  -0.33356128090456144
Bond Position:  [37.88155638]


portfolio before change:  [3.96638499]
curr_Stock_Price:  101.68308193495147
curr_Factors:  [101.68308193]
mat_Sqrt:  [[0.15]]
grads:  [0.34422419]
Stock Position:  0.3442241911088174
Bond Position:  [-31.03539164]


portfolio before change:  [3.91330562]
curr_Stock_Price:  101.53451713200712
curr_Factors:  [101.53451713]
mat_Sqrt:  [[0.15]]
grads:  [0.03046418]
Stock Position:  0.030464184064237534
Bond Position:  [0.8201394]


portfolio before change:  [3.93803069]
curr_Stock_Price:  102.34444576256932
curr_Factors:  [102.34444576]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600625]
Stock Position:  -0.0460062461175703
Bond Position:  [8.64651445]


portfolio before change:  [3.93479748]
curr_Stock_Price:  102.42647029931184
curr_Factors:  [102.4264703]
mat_Sqrt:  [[0.15]]
grads:  [0.1780847]
Stock Position:  0.17808469911577965
Bond Position:  [-14.30578967]


portfolio before change:  [3.99836022]
curr_Stock_Price:  102.7884153857718
curr_Factors:  [102.78841539]
mat_Sqrt:  [[0.15]]
grads:  [0.07893766]
Stock Position:  0.07893766141836184
Bond Position:  [-4.11551691]


portfolio before change:  [4.09811773]
curr_Stock_Price:  104.05542446771842
curr_Factors:  [104.05542447]
mat_Sqrt:  [[0.15]]
grads:  [0.01126333]
Stock Position:  0.011263328580732129
Bond Position:  [2.92610729]


portfolio before change:  [4.09176437]
curr_Stock_Price:  103.47511225135152
curr_Factors:  [103.47511225]
mat_Sqrt:  [[0.15]]
grads:  [0.06573119]
Stock Position:  0.06573119417448108
Bond Position:  [-2.70977833]


portfolio before change:  [4.12590351]
curr_Stock_Price:  103.99706392657693
curr_Factors:  [103.99706393]
mat_Sqrt:  [[0.15]]
grads:  [-0.0573043]
Stock Position:  -0.05730430431459387
Bond Position:  [10.0853829]


portfolio before change:  [4.10474764]
curr_Stock_Price:  104.37724860600491
curr_Factors:  [104.37724861]
mat_Sqrt:  [[0.15]]
grads:  [0.10038458]
Stock Position:  0.10038458328321327
Bond Position:  [-6.37311896]


portfolio before change:  [4.16347648]
curr_Stock_Price:  104.96625512109372
curr_Factors:  [104.96625512]
mat_Sqrt:  [[0.15]]
grads:  [-0.11960435]
Stock Position:  -0.11960435162872554
Bond Position:  [16.71789737]


portfolio before change:  [4.23402189]
curr_Stock_Price:  104.38516834703937
curr_Factors:  [104.38516835]
mat_Sqrt:  [[0.15]]
grads:  [0.07097318]
Stock Position:  0.07097318071498698
Bond Position:  [-3.17452552]


portfolio before change:  [4.32796916]
curr_Stock_Price:  105.71166495607379
curr_Factors:  [105.71166496]
mat_Sqrt:  [[0.15]]
grads:  [-0.62523879]
Stock Position:  -0.6252387894005458
Bond Position:  [70.42300258]


portfolio before change:  [3.80276172]
curr_Stock_Price:  106.55871576150527
curr_Factors:  [106.55871576]
mat_Sqrt:  [[0.15]]
grads:  [0.10936094]
Stock Position:  0.10936093704269052
Bond Position:  [-7.85059929]


portfolio before change:  [3.87474528]
curr_Stock_Price:  107.2214226230302
curr_Factors:  [107.22142262]
mat_Sqrt:  [[0.15]]
grads:  [0.02922976]
Stock Position:  0.029229761057875427
Bond Position:  [0.74068872]


portfolio before change:  [3.86379897]
curr_Stock_Price:  106.84534676392863
curr_Factors:  [106.84534676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01845132]
Stock Position:  -0.0184513150586975
Bond Position:  [5.83523613]


portfolio before change:  [3.85551988]
curr_Stock_Price:  107.31381213839606
curr_Factors:  [107.31381214]
mat_Sqrt:  [[0.15]]
grads:  [0.19572163]
Stock Position:  0.19572163407947063
Bond Position:  [-17.14811479]


portfolio before change:  [3.9285855]
curr_Stock_Price:  107.69260218132499
curr_Factors:  [107.69260218]
mat_Sqrt:  [[0.15]]
grads:  [0.56731394]
Stock Position:  0.5673139430611096
Bond Position:  [-57.16692929]


portfolio before change:  [3.31289318]
curr_Stock_Price:  106.61362417316373
curr_Factors:  [106.61362417]
mat_Sqrt:  [[0.15]]
grads:  [0.08361066]
Stock Position:  0.08361065540217236
Bond Position:  [-5.60114181]


portfolio before change:  [3.33552623]
curr_Stock_Price:  106.88850691898679
curr_Factors:  [106.88850692]
mat_Sqrt:  [[0.15]]
grads:  [0.16439823]
Stock Position:  0.16439822756023945
Bond Position:  [-14.23675486]


portfolio before change:  [3.29986687]
curr_Stock_Price:  106.67701110878401
curr_Factors:  [106.67701111]
mat_Sqrt:  [[0.15]]
grads:  [0.0956406]
Stock Position:  0.09564060384099954
Bond Position:  [-6.90278689]


portfolio before change:  [3.36131003]
curr_Stock_Price:  107.3239602335205
curr_Factors:  [107.32396023]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083175]
Stock Position:  -0.05083175206392512
Bond Position:  [8.81677497]


portfolio before change:  [3.40203247]
curr_Stock_Price:  106.53367916329447
curr_Factors:  [106.53367916]
mat_Sqrt:  [[0.15]]
grads:  [0.04421826]
Stock Position:  0.044218257162494244
Bond Position:  [-1.30870115]


portfolio before change:  [3.42255204]
curr_Stock_Price:  106.99958101812659
curr_Factors:  [106.99958102]
mat_Sqrt:  [[0.15]]
grads:  [0.06231881]
Stock Position:  0.06231880731901739
Bond Position:  [-3.24553423]


portfolio before change:  [3.42872206]
curr_Stock_Price:  107.10184345999353
curr_Factors:  [107.10184346]
mat_Sqrt:  [[0.15]]
grads:  [0.01117271]
Stock Position:  0.01117271408073312
Bond Position:  [2.23210379]


portfolio before change:  [3.43120102]
curr_Stock_Price:  107.3112329584944
curr_Factors:  [107.31123296]
mat_Sqrt:  [[0.15]]
grads:  [-0.20555245]
Stock Position:  -0.2055524460803065
Bond Position:  [25.48928745]


portfolio before change:  [3.3831102]
curr_Stock_Price:  107.55294233090602
curr_Factors:  [107.55294233]
mat_Sqrt:  [[0.15]]
grads:  [0.05451194]
Stock Position:  0.05451194399471445
Bond Position:  [-2.47980977]


portfolio before change:  [3.36233993]
curr_Stock_Price:  107.1747633074857
curr_Factors:  [107.17476331]
mat_Sqrt:  [[0.15]]
grads:  [0.16080027]
Stock Position:  0.16080027193109706
Bond Position:  [-13.87139115]


portfolio before change:  [3.23193563]
curr_Stock_Price:  106.3691843654967
curr_Factors:  [106.36918437]
mat_Sqrt:  [[0.15]]
grads:  [-0.09387456]
Stock Position:  -0.09387455597623676
Bond Position:  [13.21729558]


portfolio before change:  [3.20162898]
curr_Stock_Price:  106.7008265246378
curr_Factors:  [106.70082652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05326298]
Stock Position:  -0.05326297640898182
Bond Position:  [8.88483258]


portfolio before change:  [3.20484176]
curr_Stock_Price:  106.65093337512523
curr_Factors:  [106.65093338]
mat_Sqrt:  [[0.15]]
grads:  [-0.07615913]
Stock Position:  -0.07615912531787068
Bond Position:  [11.32728356]


portfolio before change:  [3.13756762]
curr_Stock_Price:  107.54356585238592
curr_Factors:  [107.54356585]
mat_Sqrt:  [[0.15]]
grads:  [0.12962845]
Stock Position:  0.12962845210645643
Bond Position:  [-10.80313835]


portfolio before change:  [3.25710556]
curr_Stock_Price:  108.47093289728895
curr_Factors:  [108.4709329]
mat_Sqrt:  [[0.15]]
grads:  [-0.07150353]
Stock Position:  -0.07150353367294822
Bond Position:  [11.01316056]


portfolio before change:  [3.34711469]
curr_Stock_Price:  107.22175285388867
curr_Factors:  [107.22175285]
mat_Sqrt:  [[0.15]]
grads:  [0.17284844]
Stock Position:  0.1728484421182258
Bond Position:  [-15.18599825]


portfolio before change:  [3.26819118]
curr_Stock_Price:  106.770638820341
curr_Factors:  [106.77063882]
mat_Sqrt:  [[0.15]]
grads:  [-0.04249628]
Stock Position:  -0.042496280571826216
Bond Position:  [7.8055462]


portfolio before change:  [3.27965998]
curr_Stock_Price:  106.5122412885843
curr_Factors:  [106.51224129]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-7.61803558]


portfolio before change:  [3.2133044]
curr_Stock_Price:  105.86834675617675
curr_Factors:  [105.86834676]
mat_Sqrt:  [[0.15]]
grads:  [0.14760312]
Stock Position:  0.14760311816959384
Bond Position:  [-12.4131937]


portfolio before change:  [3.15618924]
curr_Stock_Price:  105.48665220265012
curr_Factors:  [105.4866522]
mat_Sqrt:  [[0.15]]
grads:  [0.05446986]
Stock Position:  0.05446985817714678
Bond Position:  [-2.58965374]


portfolio before change:  [3.11375141]
curr_Stock_Price:  104.71051696175685
curr_Factors:  [104.71051696]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000715]
Stock Position:  -0.050007153560314384
Bond Position:  [8.35002631]


portfolio before change:  [3.10605603]
curr_Stock_Price:  104.8748387731847
curr_Factors:  [104.87483877]
mat_Sqrt:  [[0.15]]
grads:  [0.00076592]
Stock Position:  0.0007659228266489182
Bond Position:  [3.02573]


portfolio before change:  [3.10681717]
curr_Stock_Price:  105.62168391773042
curr_Factors:  [105.62168392]
mat_Sqrt:  [[0.15]]
grads:  [0.02644892]
Stock Position:  0.026448916521903607
Bond Position:  [0.31323807]


portfolio before change:  [3.08524092]
curr_Stock_Price:  104.8051728046079
curr_Factors:  [104.8051728]
mat_Sqrt:  [[0.15]]
grads:  [-0.06360953]
Stock Position:  -0.06360952957293069
Bond Position:  [9.75184866]


portfolio before change:  [3.06896281]
curr_Stock_Price:  105.07066163504923
curr_Factors:  [105.07066164]
mat_Sqrt:  [[0.15]]
grads:  [0.03922474]
Stock Position:  0.03922474238998027
Bond Position:  [-1.05240683]


portfolio before change:  [3.03996708]
curr_Stock_Price:  104.33311815990385
curr_Factors:  [104.33311816]
mat_Sqrt:  [[0.15]]
grads:  [-0.07549609]
Stock Position:  -0.07549608942131272
Bond Position:  [10.91670949]


portfolio before change:  [3.02345647]
curr_Stock_Price:  104.56085071813742
curr_Factors:  [104.56085072]
mat_Sqrt:  [[0.15]]
grads:  [0.10686195]
Stock Position:  0.10686195313365089
Bond Position:  [-8.15012025]


portfolio before change:  [2.91322367]
curr_Stock_Price:  103.53407365363131
curr_Factors:  [103.53407365]
mat_Sqrt:  [[0.15]]
grads:  [0.06790892]
Stock Position:  0.06790891845128133
Bond Position:  [-4.11766329]


portfolio before change:  [2.91091219]
curr_Stock_Price:  103.50382539355859
curr_Factors:  [103.50382539]
mat_Sqrt:  [[0.15]]
grads:  [0.00072656]
Stock Position:  0.0007265635562714225
Bond Position:  [2.83571008]


portfolio before change:  [2.9114226]
curr_Stock_Price:  103.96239493976088
curr_Factors:  [103.96239494]
mat_Sqrt:  [[0.15]]
grads:  [0.01182481]
Stock Position:  0.011824805357357653
Bond Position:  [1.68208752]


portfolio before change:  [2.90461627]
curr_Stock_Price:  103.37790647344882
curr_Factors:  [103.37790647]
mat_Sqrt:  [[0.15]]
grads:  [0.11066796]
Stock Position:  0.11066795657104798
Bond Position:  [-8.53600539]


portfolio before change:  [2.9631918]
curr_Stock_Price:  103.91201813217192
curr_Factors:  [103.91201813]
mat_Sqrt:  [[0.15]]
grads:  [0.03310278]
Stock Position:  0.03310277772083314
Bond Position:  [-0.47658464]


portfolio before change:  [2.96718282]
curr_Stock_Price:  104.03348237939676
curr_Factors:  [104.03348238]
mat_Sqrt:  [[0.15]]
grads:  [0.15672471]
Stock Position:  0.15672470566205685
Bond Position:  [-13.33743409]


portfolio before change:  [2.88223248]
curr_Stock_Price:  103.49676595224885
curr_Factors:  [103.49676595]
mat_Sqrt:  [[0.15]]
grads:  [0.02531489]
Stock Position:  0.025314889073706257
Bond Position:  [0.26222333]


portfolio before change:  [2.86755538]
curr_Stock_Price:  102.91633736867662
curr_Factors:  [102.91633737]
mat_Sqrt:  [[0.15]]
grads:  [-0.08289695]
Stock Position:  -0.08289695010157849
Bond Position:  [11.39900587]


portfolio before change:  [2.79513569]
curr_Stock_Price:  103.7985429118841
curr_Factors:  [103.79854291]
mat_Sqrt:  [[0.15]]
grads:  [0.0507164]
Stock Position:  0.05071639956859367
Bond Position:  [-2.46915268]


portfolio before change:  [2.75847896]
curr_Stock_Price:  103.07880707276567
curr_Factors:  [103.07880707]
mat_Sqrt:  [[0.15]]
grads:  [0.01415093]
Stock Position:  0.014150928924893391
Bond Position:  [1.29981809]


portfolio before change:  [2.74472773]
curr_Stock_Price:  102.10131136886052
curr_Factors:  [102.10131137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0362902]
Stock Position:  -0.03629019839335881
Bond Position:  [6.45000457]


portfolio before change:  [2.74451436]
curr_Stock_Price:  102.1182996449703
curr_Factors:  [102.11829964]
mat_Sqrt:  [[0.15]]
grads:  [0.10043526]
Stock Position:  0.10043526320512494
Bond Position:  [-7.51176395]


portfolio before change:  [2.70283868]
curr_Stock_Price:  101.70802363232772
curr_Factors:  [101.70802363]
mat_Sqrt:  [[0.15]]
grads:  [-0.05549616]
Stock Position:  -0.05549616259106105
Bond Position:  [8.34724369]


portfolio before change:  [2.65869411]
curr_Stock_Price:  102.51287729227347
curr_Factors:  [102.51287729]
mat_Sqrt:  [[0.15]]
grads:  [0.07227336]
Stock Position:  0.07227336189485768
Bond Position:  [-4.75025617]


portfolio before change:  [2.67792499]
curr_Stock_Price:  102.78307070688095
curr_Factors:  [102.78307071]
mat_Sqrt:  [[0.15]]
grads:  [-0.08129036]
Stock Position:  -0.08129035901998681
Bond Position:  [11.03319771]


portfolio before change:  [2.70025993]
curr_Stock_Price:  102.51679882509602
curr_Factors:  [102.51679883]
mat_Sqrt:  [[0.15]]
grads:  [0.08189125]
Stock Position:  0.08189125352632806
Bond Position:  [-5.69496924]


portfolio before change:  [2.72953824]
curr_Stock_Price:  102.87867215016725
curr_Factors:  [102.87867215]
mat_Sqrt:  [[0.15]]
grads:  [0.00959305]
Stock Position:  0.009593054118214794
Bond Position:  [1.74261757]


portfolio before change:  [2.73055159]
curr_Stock_Price:  102.97295166896578
curr_Factors:  [102.97295167]
mat_Sqrt:  [[0.15]]
grads:  [0.14888875]
Stock Position:  0.14888874965465088
Bond Position:  [-12.60096244]


portfolio before change:  [2.77764584]
curr_Stock_Price:  103.29454642683342
curr_Factors:  [103.29454643]
mat_Sqrt:  [[0.15]]
grads:  [-0.15253124]
Stock Position:  -0.152531235353626
Bond Position:  [18.53329061]


portfolio before change:  [2.72135773]
curr_Stock_Price:  103.67116748421553
curr_Factors:  [103.67116748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00070001]
Stock Position:  -0.0007000090244232808
Bond Position:  [2.79392849]


portfolio before change:  [2.7208388]
curr_Stock_Price:  104.66195842334449
curr_Factors:  [104.66195842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00746839]
Stock Position:  -0.007468389427233886
Bond Position:  [3.50249506]


portfolio before change:  [2.72413775]
curr_Stock_Price:  104.24954838321439
curr_Factors:  [104.24954838]
mat_Sqrt:  [[0.15]]
grads:  [-0.0612208]
Stock Position:  -0.06122080126300796
Bond Position:  [9.10637863]


portfolio before change:  [2.78806358]
curr_Stock_Price:  103.21466047237904
curr_Factors:  [103.21466047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.78806358]
Stock Price:  103.54661972873048
PL:  [-0.75855615]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.50752141e-04]
 [-6.60899127e-03]
 [-1.94635621e-03]
 [-1.23263392e-02]
 [ 7.13644461e-02]
 [ 2.51548967e-02]
 [ 7.16003097e-03]
 [ 2.63357478e-02]
 [ 2.41005964e-02]
 [ 5.47134243e-03]
 [ 6.45386874e-02]
 [ 1.60127437e-01]
 [ 1.62247384e-01]
 [ 2.62162364e-02]
 [-6.89031203e-03]
 [ 4.21712721e-02]
 [ 1.96934244e-02]
 [ 1.86024597e-02]
 [ 2.35141739e-02]
 [-1.12845324e-02]
 [ 1.55807390e-02]
 [-1.62958486e-02]
 [ 1.08693723e-02]
 [-5.22653871e-02]
 [ 6.43199142e-03]
 [ 7.32710703e-03]
 [-5.37630700e-03]
 [ 8.65023467e-03]
 [ 1.57399770e-02]
 [-2.71655212e-03]
 [ 8.47032835e-03]
 [-1.18226865e-02]
 [ 8.92066241e-03]
 [ 8.40637187e-03]
 [ 1.07738636e-02]
 [ 8.51939372e-03]
 [-3.36700458e-02]
 [ 9.50880727e-03]
 [-7.63622157e-04]
 [ 1.88072414e-02]
 [-5.80609113e-03]
 [-1.95505686e-02]
 [ 2.27638214e-02]
 [ 2.48128571e-03]
 [-5.82191592e-03]
 [-6.09704413e-03]
 [ 1.36069962e-02]
 [ 4.59346861e-04]
 [ 2.92489677e-03]
 [-7.44867789e-03]
 [-2.15377666e-02]
 [ 7.55121062e-04]
 [-8.27715240e-03]
 [ 5.66021358e-03]
 [-2.82377515e-03]
 [-1.32126890e-03]
 [ 4.02781406e-03]
 [-3.90204158e-04]
 [ 1.56295845e-03]
 [ 1.38409625e-02]
 [ 9.00849938e-04]
 [-1.12208860e-02]
 [-8.81583408e-03]
 [-1.49536570e-02]
 [-1.07407917e-02]
 [-7.07746948e-04]
 [-4.91470264e-03]
 [ 1.99742288e-02]
 [-1.00004005e-02]
 [ 8.21397874e-03]
 [-1.87010930e-03]
 [ 1.15732819e-02]
 [ 7.40530031e-04]
 [ 4.94727850e-03]
 [-9.55007207e-03]
 [-7.69306719e-03]
 [ 9.42043309e-05]
 [-1.79141517e-03]
 [-6.66253420e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.84395387]
curr_Stock_Price:  100.44232429226756
curr_Factors:  [100.44232429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00167168]
Stock Position:  -0.001671680938341259
Bond Position:  [9.01186139]


portfolio before change:  [8.84216698]
curr_Stock_Price:  101.8481803736099
curr_Factors:  [101.84818037]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405994]
Stock Position:  -0.04405994176684925
Bond Position:  [13.32959188]


portfolio before change:  [8.78939379]
curr_Stock_Price:  103.06484842135278
curr_Factors:  [103.06484842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01297571]
Stock Position:  -0.012975708064581338
Bond Position:  [10.12673317]


portfolio before change:  [8.77620668]
curr_Stock_Price:  104.12991895463924
curr_Factors:  [104.12991895]
mat_Sqrt:  [[0.15]]
grads:  [-0.08217559]
Stock Position:  -0.08217559468358726
Bond Position:  [17.3331447]


portfolio before change:  [8.77094032]
curr_Stock_Price:  104.20718903108579
curr_Factors:  [104.20718903]
mat_Sqrt:  [[0.15]]
grads:  [0.47576297]
Stock Position:  0.4757629740906624
Bond Position:  [-40.80698185]


portfolio before change:  [9.03247201]
curr_Stock_Price:  104.76225996601222
curr_Factors:  [104.76225997]
mat_Sqrt:  [[0.15]]
grads:  [0.16769931]
Stock Position:  0.16769931103246746
Bond Position:  [-8.53608681]


portfolio before change:  [8.98165506]
curr_Stock_Price:  104.46241720448486
curr_Factors:  [104.4624172]
mat_Sqrt:  [[0.15]]
grads:  [0.04773354]
Stock Position:  0.047733539827327094
Bond Position:  [3.99529411]


portfolio before change:  [8.96741457]
curr_Stock_Price:  104.15885280329995
curr_Factors:  [104.1588528]
mat_Sqrt:  [[0.15]]
grads:  [0.17557165]
Stock Position:  0.1755716517125608
Bond Position:  [-9.31992726]


portfolio before change:  [8.96148784]
curr_Stock_Price:  104.12841383809752
curr_Factors:  [104.12841384]
mat_Sqrt:  [[0.15]]
grads:  [0.16067064]
Stock Position:  0.1606706427479828
Bond Position:  [-7.76889134]


portfolio before change:  [9.10790806]
curr_Stock_Price:  105.04274265814433
curr_Factors:  [105.04274266]
mat_Sqrt:  [[0.15]]
grads:  [0.03647562]
Stock Position:  0.03647561618428135
Bond Position:  [5.2764093]


portfolio before change:  [9.07451982]
curr_Stock_Price:  104.11834346458329
curr_Factors:  [104.11834346]
mat_Sqrt:  [[0.15]]
grads:  [0.43025792]
Stock Position:  0.4302579161246621
Bond Position:  [-35.72322167]


portfolio before change:  [9.31725176]
curr_Stock_Price:  104.68768734866781
curr_Factors:  [104.68768735]
mat_Sqrt:  [[0.15]]
grads:  [1.06751625]
Stock Position:  1.067516246116995
Bond Position:  [-102.43855525]


portfolio before change:  [9.12303772]
curr_Stock_Price:  104.51175426086176
curr_Factors:  [104.51175426]
mat_Sqrt:  [[0.15]]
grads:  [1.08164923]
Stock Position:  1.0816492261305508
Bond Position:  [-103.9220204]


portfolio before change:  [9.98673555]
curr_Stock_Price:  105.31626013990282
curr_Factors:  [105.31626014]
mat_Sqrt:  [[0.15]]
grads:  [0.17477491]
Stock Position:  0.17477490961483472
Bond Position:  [-8.41990429]


portfolio before change:  [10.1093314]
curr_Stock_Price:  106.02072111820479
curr_Factors:  [106.02072112]
mat_Sqrt:  [[0.15]]
grads:  [-0.04593541]
Stock Position:  -0.04593541355199271
Bond Position:  [14.97943707]


portfolio before change:  [10.10752141]
curr_Stock_Price:  106.08050569108286
curr_Factors:  [106.08050569]
mat_Sqrt:  [[0.15]]
grads:  [0.28114181]
Stock Position:  0.281141813888702
Bond Position:  [-19.71614437]


portfolio before change:  [10.12670508]
curr_Stock_Price:  106.1531237154492
curr_Factors:  [106.15312372]
mat_Sqrt:  [[0.15]]
grads:  [0.1312895]
Stock Position:  0.13128949580539798
Bond Position:  [-3.81008501]


portfolio before change:  [10.09510188]
curr_Stock_Price:  105.91422368955591
curr_Factors:  [105.91422369]
mat_Sqrt:  [[0.15]]
grads:  [0.1240164]
Stock Position:  0.12401639779889839
Bond Position:  [-3.03999862]


portfolio before change:  [10.14540098]
curr_Stock_Price:  106.32134011818165
curr_Factors:  [106.32134012]
mat_Sqrt:  [[0.15]]
grads:  [0.15676116]
Stock Position:  0.15676115931021578
Bond Position:  [-6.52165555]


portfolio before change:  [9.97696797]
curr_Stock_Price:  105.24948404144826
curr_Factors:  [105.24948404]
mat_Sqrt:  [[0.15]]
grads:  [-0.07523022]
Stock Position:  -0.07523021593396696
Bond Position:  [17.89490938]


portfolio before change:  [9.96979594]
curr_Stock_Price:  105.35968572278401
curr_Factors:  [105.35968572]
mat_Sqrt:  [[0.15]]
grads:  [0.10387159]
Stock Position:  0.1038715930719411
Bond Position:  [-0.97408246]


portfolio before change:  [9.89052432]
curr_Stock_Price:  104.59710246293076
curr_Factors:  [104.59710246]
mat_Sqrt:  [[0.15]]
grads:  [-0.10863899]
Stock Position:  -0.1086389907159142
Bond Position:  [21.25384796]


portfolio before change:  [9.9557428]
curr_Stock_Price:  104.00900722313065
curr_Factors:  [104.00900722]
mat_Sqrt:  [[0.15]]
grads:  [0.07246248]
Stock Position:  0.07246248193070023
Bond Position:  [2.41899199]


portfolio before change:  [9.95762259]
curr_Stock_Price:  104.03286235575072
curr_Factors:  [104.03286236]
mat_Sqrt:  [[0.15]]
grads:  [-0.34843591]
Stock Position:  -0.3484359142241458
Bond Position:  [46.2064081]


portfolio before change:  [10.22315333]
curr_Stock_Price:  103.27908601170502
curr_Factors:  [103.27908601]
mat_Sqrt:  [[0.15]]
grads:  [0.04287994]
Stock Position:  0.04287994277051043
Bond Position:  [5.79455203]


portfolio before change:  [10.20971252]
curr_Stock_Price:  102.95718777211007
curr_Factors:  [102.95718777]
mat_Sqrt:  [[0.15]]
grads:  [0.04884738]
Stock Position:  0.04884738020585473
Bond Position:  [5.18052363]


portfolio before change:  [10.17574022]
curr_Stock_Price:  102.25508066930396
curr_Factors:  [102.25508067]
mat_Sqrt:  [[0.15]]
grads:  [-0.03584205]
Stock Position:  -0.03584204664322484
Bond Position:  [13.8407716]


portfolio before change:  [10.20038746]
curr_Stock_Price:  101.5915538062292
curr_Factors:  [101.59155381]
mat_Sqrt:  [[0.15]]
grads:  [0.05766823]
Stock Position:  0.057668231115134916
Bond Position:  [4.34178226]


portfolio before change:  [10.18323655]
curr_Stock_Price:  101.28944158838019
curr_Factors:  [101.28944159]
mat_Sqrt:  [[0.15]]
grads:  [0.10493318]
Stock Position:  0.10493317972431924
Bond Position:  [-0.44538663]


portfolio before change:  [10.15334925]
curr_Stock_Price:  101.00488464518983
curr_Factors:  [101.00488465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01811035]
Stock Position:  -0.018110347466362926
Bond Position:  [11.98258281]


portfolio before change:  [10.15423195]
curr_Stock_Price:  100.99749878268267
curr_Factors:  [100.99749878]
mat_Sqrt:  [[0.15]]
grads:  [0.05646886]
Stock Position:  0.056468855682811535
Bond Position:  [4.45101876]


portfolio before change:  [10.15897219]
curr_Stock_Price:  101.07651664491053
curr_Factors:  [101.07651664]
mat_Sqrt:  [[0.15]]
grads:  [-0.07881791]
Stock Position:  -0.07881791015236661
Bond Position:  [18.125612]


portfolio before change:  [10.13308422]
curr_Stock_Price:  101.41934300358224
curr_Factors:  [101.419343]
mat_Sqrt:  [[0.15]]
grads:  [0.05947108]
Stock Position:  0.05947108272345342
Bond Position:  [4.10156608]


portfolio before change:  [10.16994233]
curr_Stock_Price:  102.03479764964615
curr_Factors:  [102.03479765]
mat_Sqrt:  [[0.15]]
grads:  [0.05604248]
Stock Position:  0.05604247914411145
Bond Position:  [4.45165931]


portfolio before change:  [10.19313533]
curr_Stock_Price:  102.44367970983066
curr_Factors:  [102.44367971]
mat_Sqrt:  [[0.15]]
grads:  [0.07182576]
Stock Position:  0.07182575723017683
Bond Position:  [2.83504046]


portfolio before change:  [10.17975782]
curr_Stock_Price:  102.25496318932677
curr_Factors:  [102.25496319]
mat_Sqrt:  [[0.15]]
grads:  [0.05679596]
Stock Position:  0.05679595816083567
Bond Position:  [4.37208921]


portfolio before change:  [10.1545933]
curr_Stock_Price:  101.80708294921608
curr_Factors:  [101.80708295]
mat_Sqrt:  [[0.15]]
grads:  [-0.22446697]
Stock Position:  -0.22446697230161633
Bond Position:  [33.00692097]


portfolio before change:  [10.1188044]
curr_Stock_Price:  101.97571306938022
curr_Factors:  [101.97571307]
mat_Sqrt:  [[0.15]]
grads:  [0.06339205]
Stock Position:  0.06339204847455941
Bond Position:  [3.65435506]


portfolio before change:  [10.05139315]
curr_Stock_Price:  100.90870761634461
curr_Factors:  [100.90870762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00509081]
Stock Position:  -0.00509081437697011
Bond Position:  [10.56510065]


portfolio before change:  [10.04844396]
curr_Stock_Price:  101.61773459399132
curr_Factors:  [101.61773459]
mat_Sqrt:  [[0.15]]
grads:  [0.12538161]
Stock Position:  0.12538160932232612
Bond Position:  [-2.69255114]


portfolio before change:  [9.96335133]
curr_Stock_Price:  100.94040767381861
curr_Factors:  [100.94040767]
mat_Sqrt:  [[0.15]]
grads:  [-0.03870727]
Stock Position:  -0.038707274179804504
Bond Position:  [13.87047937]


portfolio before change:  [9.94076243]
curr_Stock_Price:  101.5463877813443
curr_Factors:  [101.54638778]
mat_Sqrt:  [[0.15]]
grads:  [-0.13033712]
Stock Position:  -0.13033712367883873
Bond Position:  [23.17602653]


portfolio before change:  [10.00977783]
curr_Stock_Price:  101.02798710163685
curr_Factors:  [101.0279871]
mat_Sqrt:  [[0.15]]
grads:  [0.15175881]
Stock Position:  0.1517588090180238
Bond Position:  [-5.32210917]


portfolio before change:  [10.01396455]
curr_Stock_Price:  101.05776704957542
curr_Factors:  [101.05776705]
mat_Sqrt:  [[0.15]]
grads:  [0.0165419]
Stock Position:  0.01654190471519336
Bond Position:  [8.3422766]


portfolio before change:  [10.02224791]
curr_Stock_Price:  101.52699675991067
curr_Factors:  [101.52699676]
mat_Sqrt:  [[0.15]]
grads:  [-0.03881277]
Stock Position:  -0.03881277281754375
Bond Position:  [13.96279217]


portfolio before change:  [10.01918662]
curr_Stock_Price:  101.62835506184332
curr_Factors:  [101.62835506]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064696]
Stock Position:  -0.04064696085139145
Bond Position:  [14.15007039]


portfolio before change:  [9.99177316]
curr_Stock_Price:  102.3245417020281
curr_Factors:  [102.3245417]
mat_Sqrt:  [[0.15]]
grads:  [0.09071331]
Stock Position:  0.09071330832378457
Bond Position:  [0.70957545]


portfolio before change:  [9.98944194]
curr_Stock_Price:  102.29835412100637
curr_Factors:  [102.29835412]
mat_Sqrt:  [[0.15]]
grads:  [0.00306231]
Stock Position:  0.003062312404715258
Bond Position:  [9.67617242]


portfolio before change:  [9.99269241]
curr_Stock_Price:  103.16230443231241
curr_Factors:  [103.16230443]
mat_Sqrt:  [[0.15]]
grads:  [0.01949931]
Stock Position:  0.019499311821675937
Bond Position:  [7.98109847]


portfolio before change:  [9.97664396]
curr_Stock_Price:  102.31369605194998
curr_Factors:  [102.31369605]
mat_Sqrt:  [[0.15]]
grads:  [-0.04965785]
Stock Position:  -0.049657852600827224
Bond Position:  [15.0573224]


portfolio before change:  [9.99370361]
curr_Stock_Price:  101.98910420599343
curr_Factors:  [101.98910421]
mat_Sqrt:  [[0.15]]
grads:  [-0.14358511]
Stock Position:  -0.14358511046112113
Bond Position:  [24.6378204]


portfolio before change:  [9.98669401]
curr_Stock_Price:  102.04864738918407
curr_Factors:  [102.04864739]
mat_Sqrt:  [[0.15]]
grads:  [0.00503414]
Stock Position:  0.00503414041562259
Bond Position:  [9.47296679]


portfolio before change:  [9.99130612]
curr_Stock_Price:  102.8472014020931
curr_Factors:  [102.8472014]
mat_Sqrt:  [[0.15]]
grads:  [-0.05518102]
Stock Position:  -0.05518101600525548
Bond Position:  [15.66651919]


portfolio before change:  [9.98525575]
curr_Stock_Price:  102.97459228528355
curr_Factors:  [102.97459229]
mat_Sqrt:  [[0.15]]
grads:  [0.03773476]
Stock Position:  0.037734757190857456
Bond Position:  [6.09953451]


portfolio before change:  [9.96781887]
curr_Stock_Price:  102.50239871937508
curr_Factors:  [102.50239872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01882517]
Stock Position:  -0.018825167674769043
Bond Position:  [11.89744371]


portfolio before change:  [9.99266377]
curr_Stock_Price:  101.22212916066114
curr_Factors:  [101.22212916]
mat_Sqrt:  [[0.15]]
grads:  [-0.00880846]
Stock Position:  -0.008808459322718424
Bond Position:  [10.88427478]


portfolio before change:  [9.99764604]
curr_Stock_Price:  100.73373730739792
curr_Factors:  [100.73373731]
mat_Sqrt:  [[0.15]]
grads:  [0.02685209]
Stock Position:  0.026852093737971684
Bond Position:  [7.29273429]


portfolio before change:  [10.00206747]
curr_Stock_Price:  100.88142114685044
curr_Factors:  [100.88142115]
mat_Sqrt:  [[0.15]]
grads:  [-0.00260136]
Stock Position:  -0.0026013610507482376
Bond Position:  [10.26449647]


portfolio before change:  [10.00243271]
curr_Stock_Price:  100.98763861126032
curr_Factors:  [100.98763861]
mat_Sqrt:  [[0.15]]
grads:  [0.01041972]
Stock Position:  0.010419722995885505
Bond Position:  [8.95016949]


portfolio before change:  [10.0050438]
curr_Stock_Price:  101.18454230337609
curr_Factors:  [101.1845423]
mat_Sqrt:  [[0.15]]
grads:  [0.09227308]
Stock Position:  0.09227308329721848
Bond Position:  [0.6684341]


portfolio before change:  [9.98049255]
curr_Stock_Price:  100.91801792268339
curr_Factors:  [100.91801792]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [9.37441262]


portfolio before change:  [9.98162722]
curr_Stock_Price:  101.00938915425387
curr_Factors:  [101.00938915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07480591]
Stock Position:  -0.07480590658025511
Bond Position:  [17.53772614]


portfolio before change:  [10.03781436]
curr_Stock_Price:  100.27293656796333
curr_Factors:  [100.27293657]
mat_Sqrt:  [[0.15]]
grads:  [-0.05877223]
Stock Position:  -0.0587722271922198
Bond Position:  [15.93107817]


portfolio before change:  [10.05007501]
curr_Stock_Price:  100.08126574246192
curr_Factors:  [100.08126574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09969105]
Stock Position:  -0.09969104640095623
Bond Position:  [20.02728111]


portfolio before change:  [10.06400209]
curr_Stock_Price:  99.95411950785169
curr_Factors:  [99.95411951]
mat_Sqrt:  [[0.15]]
grads:  [-0.07160528]
Stock Position:  -0.07160527785294978
Bond Position:  [17.22124459]


portfolio before change:  [10.12724915]
curr_Stock_Price:  99.08587771935665
curr_Factors:  [99.08587772]
mat_Sqrt:  [[0.15]]
grads:  [-0.00471831]
Stock Position:  -0.00471831298836739
Bond Position:  [10.59476733]


portfolio before change:  [10.1299484]
curr_Stock_Price:  98.65414283995742
curr_Factors:  [98.65414284]
mat_Sqrt:  [[0.15]]
grads:  [-0.03276468]
Stock Position:  -0.03276468424946328
Bond Position:  [13.36232024]


portfolio before change:  [10.14133778]
curr_Stock_Price:  98.33202128233611
curr_Factors:  [98.33202128]
mat_Sqrt:  [[0.15]]
grads:  [0.13316153]
Stock Position:  0.13316152514973928
Bond Position:  [-2.95270414]


portfolio before change:  [10.09974307]
curr_Stock_Price:  98.02104431583186
curr_Factors:  [98.02104432]
mat_Sqrt:  [[0.15]]
grads:  [-0.06666934]
Stock Position:  -0.06666933654645132
Bond Position:  [16.63474106]


portfolio before change:  [10.14580184]
curr_Stock_Price:  97.3457853442767
curr_Factors:  [97.34578534]
mat_Sqrt:  [[0.15]]
grads:  [0.05475986]
Stock Position:  0.05475985828568029
Bond Position:  [4.81516043]


portfolio before change:  [10.13201474]
curr_Stock_Price:  97.088515688758
curr_Factors:  [97.08851569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124674]
Stock Position:  -0.01246739530761486
Bond Position:  [11.34245565]


portfolio before change:  [10.13034903]
curr_Stock_Price:  97.27898411431842
curr_Factors:  [97.27898411]
mat_Sqrt:  [[0.15]]
grads:  [0.07715521]
Stock Position:  0.07715521238731801
Bond Position:  [2.62476835]


portfolio before change:  [10.09197476]
curr_Stock_Price:  96.77949335836949
curr_Factors:  [96.77949336]
mat_Sqrt:  [[0.15]]
grads:  [0.00493687]
Stock Position:  0.004936866872261016
Bond Position:  [9.61418729]


portfolio before change:  [10.09488912]
curr_Stock_Price:  97.24810129885354
curr_Factors:  [97.2481013]
mat_Sqrt:  [[0.15]]
grads:  [0.03298186]
Stock Position:  0.0329818566604757
Bond Position:  [6.88746619]


portfolio before change:  [10.09920395]
curr_Stock_Price:  97.36587353931282
curr_Factors:  [97.36587354]
mat_Sqrt:  [[0.15]]
grads:  [-0.06366715]
Stock Position:  -0.06366714712276055
Bond Position:  [16.29821135]


portfolio before change:  [10.04942533]
curr_Stock_Price:  98.16373072211452
curr_Factors:  [98.16373072]
mat_Sqrt:  [[0.15]]
grads:  [-0.05128711]
Stock Position:  -0.05128711461643535
Bond Position:  [15.08395984]


portfolio before change:  [10.04044145]
curr_Stock_Price:  98.35728141060437
curr_Factors:  [98.35728141]
mat_Sqrt:  [[0.15]]
grads:  [0.00062803]
Stock Position:  0.0006280288729230109
Bond Position:  [9.97867024]


portfolio before change:  [10.04170063]
curr_Stock_Price:  99.36917103259628
curr_Factors:  [99.36917103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01194277]
Stock Position:  -0.011942767785022599
Bond Position:  [11.22844357]


portfolio before change:  [10.049672]
curr_Stock_Price:  98.76047024283382
curr_Factors:  [98.76047024]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.049672]
Stock Price:  99.4135228455323
PL:  [10.049672]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.07382264e-04]
 [ 3.02946947e-03]
 [ 3.12655475e-04]
 [ 8.35767376e-03]
 [ 4.55705068e-03]
 [ 1.91656958e-02]
 [ 1.37647160e-03]
 [-1.73502953e-02]
 [ 1.46525026e-02]
 [-3.75038757e-03]
 [ 2.08505956e-02]
 [-4.15418081e-02]
 [ 2.27098699e-02]
 [ 3.80892586e-03]
 [-6.89945378e-03]
 [ 2.11004510e-02]
 [ 1.08355402e-02]
 [-1.10037030e-02]
 [ 2.32587424e-03]
 [-4.05427010e-03]
 [ 1.39181161e-02]
 [-4.14361582e-03]
 [ 9.69836399e-03]
 [ 1.22905520e-02]
 [-1.86661275e-03]
 [ 1.27232758e-02]
 [-7.12063766e-03]
 [ 5.69410541e-03]
 [-8.41572349e-03]
 [-1.73459378e-03]
 [-6.56750225e-03]
 [-1.03955723e-02]
 [-1.27752229e-03]
 [ 4.62538281e-03]
 [ 1.21829689e-02]
 [ 1.16115956e-02]
 [-3.48191169e-02]
 [ 9.44475590e-03]
 [-7.64657784e-03]
 [ 2.42652650e-02]
 [-6.41208366e-03]
 [-4.33157933e-03]
 [ 2.35889026e-02]
 [ 3.27541507e-03]
 [-6.40618510e-03]
 [-6.34102441e-04]
 [ 5.73836287e-03]
 [-1.00491322e-02]
 [-1.36205659e-02]
 [-7.69759967e-03]
 [-2.97605614e-02]
 [ 9.78918308e-04]
 [-5.14227547e-03]
 [ 5.28607099e-03]
 [ 9.63487558e-05]
 [-7.25750283e-04]
 [ 7.82405313e-03]
 [-7.31047227e-04]
 [ 1.64784251e-03]
 [ 1.59994189e-02]
 [-2.63318091e-03]
 [ 2.82687479e-05]
 [-4.43791420e-03]
 [-1.23376506e-02]
 [ 2.00802638e-03]
 [ 1.38100324e-03]
 [-5.42224384e-03]
 [ 1.50356506e-02]
 [-8.31866859e-03]
 [ 1.00262932e-02]
 [-1.31789180e-02]
 [ 1.33733321e-02]
 [ 2.12924581e-03]
 [ 2.28621622e-02]
 [-2.46903172e-02]
 [ 1.27873228e-03]
 [-3.31416664e-03]
 [-9.43251301e-03]
 [ 2.76386098e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13116629]
curr_Stock_Price:  100.13587547389102
curr_Factors:  [100.13587547]
mat_Sqrt:  [[0.15]]
grads:  [0.00604922]
Stock Position:  0.0060492150920334895
Bond Position:  [3.52542284]


portfolio before change:  [4.13159736]
curr_Stock_Price:  100.17070998028598
curr_Factors:  [100.17070998]
mat_Sqrt:  [[0.15]]
grads:  [0.02019646]
Stock Position:  0.020196463135181968
Bond Position:  [2.10850331]


portfolio before change:  [4.12954985]
curr_Stock_Price:  100.0628052230573
curr_Factors:  [100.06280522]
mat_Sqrt:  [[0.15]]
grads:  [0.00208437]
Stock Position:  0.002084369834137485
Bond Position:  [3.92098196]


portfolio before change:  [4.12919188]
curr_Stock_Price:  99.77349024191099
curr_Factors:  [99.77349024]
mat_Sqrt:  [[0.15]]
grads:  [0.05571783]
Stock Position:  0.055717825033410294
Bond Position:  [-1.42996999]


portfolio before change:  [4.11687431]
curr_Stock_Price:  99.55402376678916
curr_Factors:  [99.55402377]
mat_Sqrt:  [[0.15]]
grads:  [0.03038034]
Stock Position:  0.030380337866370354
Bond Position:  [1.09238943]


portfolio before change:  [4.10608654]
curr_Stock_Price:  99.19668584348243
curr_Factors:  [99.19668584]
mat_Sqrt:  [[0.15]]
grads:  [0.12777131]
Stock Position:  0.12777130561058558
Bond Position:  [-8.56840352]


portfolio before change:  [4.09002863]
curr_Stock_Price:  99.07520028729044
curr_Factors:  [99.07520029]
mat_Sqrt:  [[0.15]]
grads:  [0.00917648]
Stock Position:  0.009176477363250335
Bond Position:  [3.1808673]


portfolio before change:  [4.09170598]
curr_Stock_Price:  99.23632321656159
curr_Factors:  [99.23632322]
mat_Sqrt:  [[0.15]]
grads:  [-0.11566864]
Stock Position:  -0.11566863558543854
Bond Position:  [15.57023609]


portfolio before change:  [4.03633124]
curr_Stock_Price:  99.72347260298757
curr_Factors:  [99.7234726]
mat_Sqrt:  [[0.15]]
grads:  [0.09768335]
Stock Position:  0.09768335064968033
Bond Position:  [-5.7049917]


portfolio before change:  [4.10531607]
curr_Stock_Price:  100.43333155409424
curr_Factors:  [100.43333155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02500258]
Stock Position:  -0.025002583789956092
Bond Position:  [6.61640886]


portfolio before change:  [4.08642973]
curr_Stock_Price:  101.2052471910293
curr_Factors:  [101.20524719]
mat_Sqrt:  [[0.15]]
grads:  [0.13900397]
Stock Position:  0.1390039707840419
Bond Position:  [-9.9815015]


portfolio before change:  [4.07911486]
curr_Stock_Price:  101.15711187637818
curr_Factors:  [101.15711188]
mat_Sqrt:  [[0.15]]
grads:  [-0.27694539]
Stock Position:  -0.27694538765529014
Bond Position:  [32.09411043]


portfolio before change:  [4.14974845]
curr_Stock_Price:  100.90930979642336
curr_Factors:  [100.9093098]
mat_Sqrt:  [[0.15]]
grads:  [0.15139913]
Stock Position:  0.15139913273663907
Bond Position:  [-11.12783354]


portfolio before change:  [4.21510109]
curr_Stock_Price:  101.345561614944
curr_Factors:  [101.34556161]
mat_Sqrt:  [[0.15]]
grads:  [0.02539284]
Stock Position:  0.02539283905385162
Bond Position:  [1.64164955]


portfolio before change:  [4.23185344]
curr_Stock_Price:  102.0012484545961
curr_Factors:  [102.00124845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599636]
Stock Position:  -0.045996358555402996
Bond Position:  [8.92353944]


portfolio before change:  [4.25948062]
curr_Stock_Price:  101.41273579620574
curr_Factors:  [101.4127358]
mat_Sqrt:  [[0.15]]
grads:  [0.14066967]
Stock Position:  0.14066967351524434
Bond Position:  [-10.00621581]


portfolio before change:  [4.31438357]
curr_Stock_Price:  101.80747873830916
curr_Factors:  [101.80747874]
mat_Sqrt:  [[0.15]]
grads:  [0.07223693]
Stock Position:  0.0722369346572396
Bond Position:  [-3.03987662]


portfolio before change:  [4.28939982]
curr_Stock_Price:  101.46425054687393
curr_Factors:  [101.46425055]
mat_Sqrt:  [[0.15]]
grads:  [-0.07335802]
Stock Position:  -0.07335802014665861
Bond Position:  [11.73261636]


portfolio before change:  [4.25933359]
curr_Stock_Price:  101.8841029228265
curr_Factors:  [101.88410292]
mat_Sqrt:  [[0.15]]
grads:  [0.01550583]
Stock Position:  0.015505828288219304
Bond Position:  [2.67953619]


portfolio before change:  [4.25066811]
curr_Stock_Price:  101.31444880033958
curr_Factors:  [101.3144488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02702847]
Stock Position:  -0.027028467334377203
Bond Position:  [6.98904238]


portfolio before change:  [4.23244926]
curr_Stock_Price:  102.00467216968825
curr_Factors:  [102.00467217]
mat_Sqrt:  [[0.15]]
grads:  [0.09278744]
Stock Position:  0.09278744043406033
Bond Position:  [-5.23230318]


portfolio before change:  [4.21826293]
curr_Stock_Price:  101.85530599793036
curr_Factors:  [101.855306]
mat_Sqrt:  [[0.15]]
grads:  [-0.02762411]
Stock Position:  -0.02762410546581051
Bond Position:  [7.03192464]


portfolio before change:  [4.22518869]
curr_Stock_Price:  101.6205018037368
curr_Factors:  [101.6205018]
mat_Sqrt:  [[0.15]]
grads:  [0.06465576]
Stock Position:  0.06465575990946272
Bond Position:  [-2.34516207]


portfolio before change:  [4.21684144]
curr_Stock_Price:  101.49366591364995
curr_Factors:  [101.49366591]
mat_Sqrt:  [[0.15]]
grads:  [0.08193701]
Stock Position:  0.08193701306339544
Bond Position:  [-4.09924639]


portfolio before change:  [4.11077412]
curr_Stock_Price:  100.20229450705989
curr_Factors:  [100.20229451]
mat_Sqrt:  [[0.15]]
grads:  [-0.01244408]
Stock Position:  -0.012444084974324646
Bond Position:  [5.35769998]


portfolio before change:  [4.11224326]
curr_Stock_Price:  100.11114489798794
curr_Factors:  [100.1111449]
mat_Sqrt:  [[0.15]]
grads:  [0.08482184]
Stock Position:  0.08482183888044513
Bond Position:  [-4.37936815]


portfolio before change:  [4.07732174]
curr_Stock_Price:  99.70266762355628
curr_Factors:  [99.70266762]
mat_Sqrt:  [[0.15]]
grads:  [-0.04747092]
Stock Position:  -0.0474709177350473
Bond Position:  [8.81029888]


portfolio before change:  [4.06674064]
curr_Stock_Price:  99.93716411998358
curr_Factors:  [99.93716412]
mat_Sqrt:  [[0.15]]
grads:  [0.0379607]
Stock Position:  0.03796070270223295
Bond Position:  [0.27305567]


portfolio before change:  [4.05428361]
curr_Stock_Price:  99.6085584238479
curr_Factors:  [99.60855842]
mat_Sqrt:  [[0.15]]
grads:  [-0.05610482]
Stock Position:  -0.056104823294487995
Bond Position:  [9.64280417]


portfolio before change:  [4.06607756]
curr_Stock_Price:  99.409087928566
curr_Factors:  [99.40908793]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156396]
Stock Position:  -0.011563958506366427
Bond Position:  [5.21564012]


portfolio before change:  [4.06994881]
curr_Stock_Price:  99.10250898839335
curr_Factors:  [99.10250899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04378335]
Stock Position:  -0.04378334831541463
Bond Position:  [8.40898848]


portfolio before change:  [4.06330585]
curr_Stock_Price:  99.26623643009644
curr_Factors:  [99.26623643]
mat_Sqrt:  [[0.15]]
grads:  [-0.06930382]
Stock Position:  -0.06930381534351922
Bond Position:  [10.94283477]


portfolio before change:  [4.04925843]
curr_Stock_Price:  99.47879856898386
curr_Factors:  [99.47879857]
mat_Sqrt:  [[0.15]]
grads:  [-0.00851682]
Stock Position:  -0.008516815240144741
Bond Position:  [4.89650098]


portfolio before change:  [4.05652944]
curr_Stock_Price:  98.66100868587795
curr_Factors:  [98.66100869]
mat_Sqrt:  [[0.15]]
grads:  [0.03083589]
Stock Position:  0.03083588536991452
Bond Position:  [1.01422989]


portfolio before change:  [4.07407055]
curr_Stock_Price:  99.22780674641083
curr_Factors:  [99.22780675]
mat_Sqrt:  [[0.15]]
grads:  [0.08121979]
Stock Position:  0.08121979239256301
Bond Position:  [-3.98519131]


portfolio before change:  [4.14798046]
curr_Stock_Price:  100.14087230173097
curr_Factors:  [100.1408723]
mat_Sqrt:  [[0.15]]
grads:  [0.07741064]
Stock Position:  0.0774106376428872
Bond Position:  [-3.60398831]


portfolio before change:  [4.12659511]
curr_Stock_Price:  99.86752363943471
curr_Factors:  [99.86752364]
mat_Sqrt:  [[0.15]]
grads:  [-0.23212745]
Stock Position:  -0.2321274460640825
Bond Position:  [27.30858832]


portfolio before change:  [4.24454456]
curr_Stock_Price:  99.36675302074426
curr_Factors:  [99.36675302]
mat_Sqrt:  [[0.15]]
grads:  [0.06296504]
Stock Position:  0.06296503930993007
Bond Position:  [-2.01208695]


portfolio before change:  [4.2934296]
curr_Stock_Price:  100.14513415908601
curr_Factors:  [100.14513416]
mat_Sqrt:  [[0.15]]
grads:  [-0.05097719]
Stock Position:  -0.050977185584523785
Bond Position:  [9.39854669]


portfolio before change:  [4.29815567]
curr_Stock_Price:  100.06394791935759
curr_Factors:  [100.06394792]
mat_Sqrt:  [[0.15]]
grads:  [0.16176843]
Stock Position:  0.16176843301835392
Bond Position:  [-11.88903238]


portfolio before change:  [4.31778304]
curr_Stock_Price:  100.18987147072976
curr_Factors:  [100.18987147]
mat_Sqrt:  [[0.15]]
grads:  [-0.04274722]
Stock Position:  -0.04274722443167348
Bond Position:  [8.60062196]


portfolio before change:  [4.34874734]
curr_Stock_Price:  99.47808848030665
curr_Factors:  [99.47808848]
mat_Sqrt:  [[0.15]]
grads:  [-0.0288772]
Stock Position:  -0.028877195558402527
Bond Position:  [7.22139556]


portfolio before change:  [4.33121821]
curr_Stock_Price:  100.10074193598616
curr_Factors:  [100.10074194]
mat_Sqrt:  [[0.15]]
grads:  [0.15725935]
Stock Position:  0.1572593507182103
Bond Position:  [-11.41055948]


portfolio before change:  [4.40016923]
curr_Stock_Price:  100.543731184324
curr_Factors:  [100.54373118]
mat_Sqrt:  [[0.15]]
grads:  [0.0218361]
Stock Position:  0.02183610047551781
Bond Position:  [2.20468621]


portfolio before change:  [4.41798733]
curr_Stock_Price:  101.35341351968238
curr_Factors:  [101.35341352]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427079]
Stock Position:  -0.042707900684969415
Bond Position:  [8.74657885]


portfolio before change:  [4.42612977]
curr_Stock_Price:  101.17555981750552
curr_Factors:  [101.17555982]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422735]
Stock Position:  -0.0042273496085816955
Bond Position:  [4.85383423]


portfolio before change:  [4.43111355]
curr_Stock_Price:  100.0683850371623
curr_Factors:  [100.06838504]
mat_Sqrt:  [[0.15]]
grads:  [0.03825575]
Stock Position:  0.038255752479667136
Bond Position:  [0.60292219]


portfolio before change:  [4.44823283]
curr_Stock_Price:  100.51489542964565
curr_Factors:  [100.51489543]
mat_Sqrt:  [[0.15]]
grads:  [-0.06699421]
Stock Position:  -0.0669942144497553
Bond Position:  [11.18214929]


portfolio before change:  [4.45826247]
curr_Stock_Price:  100.37561870954397
curr_Factors:  [100.37561871]
mat_Sqrt:  [[0.15]]
grads:  [-0.09080377]
Stock Position:  -0.09080377245636599
Bond Position:  [13.57274731]


portfolio before change:  [4.41914488]
curr_Stock_Price:  100.81575364893591
curr_Factors:  [100.81575365]
mat_Sqrt:  [[0.15]]
grads:  [-0.05131733]
Stock Position:  -0.05131733115896316
Bond Position:  [9.5927403]


portfolio before change:  [4.34165968]
curr_Stock_Price:  102.33735970474153
curr_Factors:  [102.3373597]
mat_Sqrt:  [[0.15]]
grads:  [-0.19840374]
Stock Position:  -0.1984037429129947
Bond Position:  [24.64577489]


portfolio before change:  [4.39370498]
curr_Stock_Price:  102.08280358758088
curr_Factors:  [102.08280359]
mat_Sqrt:  [[0.15]]
grads:  [0.00652612]
Stock Position:  0.006526122052670641
Bond Position:  [3.72750014]


portfolio before change:  [4.39241962]
curr_Stock_Price:  101.8501480652545
curr_Factors:  [101.85014807]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428184]
Stock Position:  -0.03428183644257938
Bond Position:  [7.88402973]


portfolio before change:  [4.41801364]
curr_Stock_Price:  101.11794529993455
curr_Factors:  [101.1179453]
mat_Sqrt:  [[0.15]]
grads:  [0.03524047]
Stock Position:  0.035240473240338084
Bond Position:  [0.85456939]


portfolio before change:  [4.45026637]
curr_Stock_Price:  102.03164793113174
curr_Factors:  [102.03164793]
mat_Sqrt:  [[0.15]]
grads:  [0.00064233]
Stock Position:  0.0006423250385131933
Bond Position:  [4.38472888]


portfolio before change:  [4.45041594]
curr_Stock_Price:  101.83785121569093
curr_Factors:  [101.83785122]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483834]
Stock Position:  -0.004838335221543089
Bond Position:  [4.9431416]


portfolio before change:  [4.45199761]
curr_Stock_Price:  101.57480326091343
curr_Factors:  [101.57480326]
mat_Sqrt:  [[0.15]]
grads:  [0.05216035]
Stock Position:  0.052160354179972904
Bond Position:  [-0.8461801]


portfolio before change:  [4.46941642]
curr_Stock_Price:  101.90976455925143
curr_Factors:  [101.90976456]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487365]
Stock Position:  -0.004873648177408473
Bond Position:  [4.96608876]


portfolio before change:  [4.4682837]
curr_Stock_Price:  102.2058699929153
curr_Factors:  [102.20586999]
mat_Sqrt:  [[0.15]]
grads:  [0.01098562]
Stock Position:  0.010985616761976036
Bond Position:  [3.34548918]


portfolio before change:  [4.47197244]
curr_Stock_Price:  102.52261569868872
curr_Factors:  [102.5226157]
mat_Sqrt:  [[0.15]]
grads:  [0.10666279]
Stock Position:  0.10666279252285513
Bond Position:  [-6.46337604]


portfolio before change:  [4.45355992]
curr_Stock_Price:  102.35377942461521
curr_Factors:  [102.35377942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755454]
Stock Position:  -0.01755453941115028
Bond Position:  [6.25033338]


portfolio before change:  [4.46411395]
curr_Stock_Price:  101.77481970895722
curr_Factors:  [101.77481971]
mat_Sqrt:  [[0.15]]
grads:  [0.00018846]
Stock Position:  0.0001884583196591396
Bond Position:  [4.44493364]


portfolio before change:  [4.4643599]
curr_Stock_Price:  101.60572525621026
curr_Factors:  [101.60572526]
mat_Sqrt:  [[0.15]]
grads:  [-0.02958609]
Stock Position:  -0.029586094686439336
Bond Position:  [7.47047651]


portfolio before change:  [4.44156208]
curr_Stock_Price:  102.39206577530538
curr_Factors:  [102.39206578]
mat_Sqrt:  [[0.15]]
grads:  [-0.082251]
Stock Position:  -0.0822510039267568
Bond Position:  [12.86341228]


portfolio before change:  [4.4235196]
curr_Stock_Price:  102.62119930650356
curr_Factors:  [102.62119931]
mat_Sqrt:  [[0.15]]
grads:  [0.01338684]
Stock Position:  0.013386842511421393
Bond Position:  [3.04974577]


portfolio before change:  [4.4252689]
curr_Stock_Price:  102.73763305937112
curr_Factors:  [102.73763306]
mat_Sqrt:  [[0.15]]
grads:  [0.00920669]
Stock Position:  0.009206688248477129
Bond Position:  [3.47939554]


portfolio before change:  [4.43020968]
curr_Stock_Price:  103.25066437899794
curr_Factors:  [103.25066438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03614829]
Stock Position:  -0.03614829229475066
Bond Position:  [8.16254488]


portfolio before change:  [4.44262157]
curr_Stock_Price:  102.92141755616522
curr_Factors:  [102.92141756]
mat_Sqrt:  [[0.15]]
grads:  [0.10023767]
Stock Position:  0.10023767094607205
Bond Position:  [-5.87398162]


portfolio before change:  [4.46875762]
curr_Stock_Price:  103.18582099562705
curr_Factors:  [103.185821]
mat_Sqrt:  [[0.15]]
grads:  [-0.05545779]
Stock Position:  -0.055457790610223434
Bond Position:  [10.19121527]


portfolio before change:  [4.49126668]
curr_Stock_Price:  102.7914293260882
curr_Factors:  [102.79142933]
mat_Sqrt:  [[0.15]]
grads:  [0.06684195]
Stock Position:  0.06684195458147343
Bond Position:  [-2.37951337]


portfolio before change:  [4.55079208]
curr_Stock_Price:  103.68419383180576
curr_Factors:  [103.68419383]
mat_Sqrt:  [[0.15]]
grads:  [-0.08785945]
Stock Position:  -0.08785945343545473
Bond Position:  [13.66042868]


portfolio before change:  [4.51658518]
curr_Stock_Price:  104.08324830990954
curr_Factors:  [104.08324831]
mat_Sqrt:  [[0.15]]
grads:  [0.08915555]
Stock Position:  0.08915554735054626
Bond Position:  [-4.7630138]


portfolio before change:  [4.44019741]
curr_Stock_Price:  103.22979529692246
curr_Factors:  [103.2297953]
mat_Sqrt:  [[0.15]]
grads:  [0.01419497]
Stock Position:  0.014194972065696063
Bond Position:  [2.97485335]


portfolio before change:  [4.44055557]
curr_Stock_Price:  103.2419279729196
curr_Factors:  [103.24192797]
mat_Sqrt:  [[0.15]]
grads:  [0.15241441]
Stock Position:  0.1524144144487696
Bond Position:  [-11.29500243]


portfolio before change:  [4.61146021]
curr_Stock_Price:  104.36787529662058
curr_Factors:  [104.3678753]
mat_Sqrt:  [[0.15]]
grads:  [-0.16460211]
Stock Position:  -0.16460211484110485
Bond Position:  [21.7906332]


portfolio before change:  [4.57743093]
curr_Stock_Price:  104.58288611382453
curr_Factors:  [104.58288611]
mat_Sqrt:  [[0.15]]
grads:  [0.00852488]
Stock Position:  0.008524881873175513
Bond Position:  [3.68587418]


portfolio before change:  [4.57460086]
curr_Stock_Price:  104.22388434251427
curr_Factors:  [104.22388434]
mat_Sqrt:  [[0.15]]
grads:  [-0.02209444]
Stock Position:  -0.02209444428263126
Bond Position:  [6.87736966]


portfolio before change:  [4.57276127]
curr_Stock_Price:  104.32659958124853
curr_Factors:  [104.32659958]
mat_Sqrt:  [[0.15]]
grads:  [-0.06288342]
Stock Position:  -0.06288342004368283
Bond Position:  [11.13317465]


portfolio before change:  [4.54035129]
curr_Stock_Price:  104.85306304886448
curr_Factors:  [104.85306305]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.54035129]
Stock Price:  105.60199392555722
PL:  [-1.06164263]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.01700317e-03]
 [ 7.88153601e-05]
 [-1.00015513e-03]
 [ 7.28176302e-03]
 [ 9.95392249e-03]
 [ 2.73859957e-02]
 [ 4.11131460e-03]
 [ 2.09359593e-02]
 [ 2.43923767e-02]
 [-1.19446234e-03]
 [ 5.19802206e-02]
 [ 8.63377338e-02]
 [ 9.20881560e-02]
 [ 1.49932265e-02]
 [-6.89554628e-03]
 [ 3.10702784e-02]
 [ 1.14045929e-02]
 [-8.82216159e-03]
 [ 7.55545238e-03]
 [-9.10433767e-03]
 [ 1.50296277e-02]
 [-1.57931671e-02]
 [ 1.02851828e-02]
 [-9.02080493e-02]
 [ 1.38779353e-02]
 [ 4.91702596e-03]
 [-2.83504636e-03]
 [ 2.65380815e-02]
 [ 7.88739229e-02]
 [ 1.47256993e-02]
 [ 2.53199815e-02]
 [ 1.60300259e-02]
 [-7.43109307e-03]
 [ 6.36675485e-03]
 [ 9.35947431e-03]
 [ 3.19839821e-03]
 [-3.10390913e-02]
 [ 8.45970614e-03]
 [ 1.61426567e-02]
 [ 1.45563010e-03]
 [-4.59088305e-03]
 [-1.43784276e-02]
 [ 2.01539360e-02]
 [-2.64616660e-03]
 [ 5.35444274e-03]
 [-1.63904303e-02]
 [ 1.50322811e-02]
 [ 1.87912204e-02]
 [ 7.15241828e-03]
 [-7.51204788e-03]
 [ 3.12769933e-02]
 [ 5.51286990e-03]
 [-1.02902617e-02]
 [ 5.88434748e-03]
 [-1.57737851e-02]
 [ 2.08366007e-02]
 [ 1.18306099e-02]
 [ 3.43654627e-04]
 [ 1.76456357e-03]
 [ 1.40440130e-02]
 [-1.60079901e-03]
 [ 1.59960087e-02]
 [-2.99206901e-03]
 [-1.27121517e-02]
 [-1.56424324e-03]
 [ 1.11528201e-03]
 [-5.43329062e-03]
 [ 1.51149018e-02]
 [-8.34588553e-03]
 [ 1.05779157e-02]
 [-1.14408995e-02]
 [ 1.13308169e-02]
 [-2.70693175e-03]
 [ 1.89134977e-02]
 [-2.24808971e-02]
 [-3.51529664e-03]
 [-1.03921806e-02]
 [-1.51580115e-03]
 [ 1.15798409e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.01200072]
curr_Stock_Price:  99.80144125053197
curr_Factors:  [99.80144125]
mat_Sqrt:  [[0.15]]
grads:  [0.02011335]
Stock Position:  0.020113354485139123
Bond Position:  [-3.01934248]


portfolio before change:  [-1.01511744]
curr_Stock_Price:  99.65586585228951
curr_Factors:  [99.65586585]
mat_Sqrt:  [[0.15]]
grads:  [0.00052544]
Stock Position:  0.0005254357337266686
Bond Position:  [-1.0674802]


portfolio before change:  [-1.01482602]
curr_Stock_Price:  100.33747106574152
curr_Factors:  [100.33747107]
mat_Sqrt:  [[0.15]]
grads:  [-0.0066677]
Stock Position:  -0.006667700854745904
Bond Position:  [-0.34580578]


portfolio before change:  [-1.01326463]
curr_Stock_Price:  100.10005661845929
curr_Factors:  [100.10005662]
mat_Sqrt:  [[0.15]]
grads:  [0.04854509]
Stock Position:  0.04854508681699614
Bond Position:  [-5.87263057]


portfolio before change:  [-0.97405239]
curr_Stock_Price:  100.91536648949476
curr_Factors:  [100.91536649]
mat_Sqrt:  [[0.15]]
grads:  [0.06635948]
Stock Position:  0.06635948323347611
Bond Position:  [-7.67074396]


portfolio before change:  [-0.94425123]
curr_Stock_Price:  101.37167793895595
curr_Factors:  [101.37167794]
mat_Sqrt:  [[0.15]]
grads:  [0.1825733]
Stock Position:  0.1825733043567195
Bond Position:  [-19.45201344]


portfolio before change:  [-0.74542253]
curr_Stock_Price:  102.46737206009607
curr_Factors:  [102.46737206]
mat_Sqrt:  [[0.15]]
grads:  [0.02740876]
Stock Position:  0.027408763966751706
Bond Position:  [-3.55392654]


portfolio before change:  [-0.72023984]
curr_Stock_Price:  103.3942585556085
curr_Factors:  [103.39425856]
mat_Sqrt:  [[0.15]]
grads:  [0.13957306]
Stock Position:  0.13957306201897926
Bond Position:  [-15.1512931]


portfolio before change:  [-0.70800101]
curr_Stock_Price:  103.48873106159755
curr_Factors:  [103.48873106]
mat_Sqrt:  [[0.15]]
grads:  [0.16261584]
Stock Position:  0.1626158446095324
Bond Position:  [-17.53690842]


portfolio before change:  [-0.67212453]
curr_Stock_Price:  103.71609246761139
curr_Factors:  [103.71609247]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796308]
Stock Position:  -0.007963082280175258
Bond Position:  [0.15377524]


portfolio before change:  [-0.66864987]
curr_Stock_Price:  103.28095228216344
curr_Factors:  [103.28095228]
mat_Sqrt:  [[0.15]]
grads:  [0.3465348]
Stock Position:  0.34653480409181564
Bond Position:  [-36.45909443]


portfolio before change:  [-0.53465517]
curr_Stock_Price:  103.67419837928642
curr_Factors:  [103.67419838]
mat_Sqrt:  [[0.15]]
grads:  [0.57558489]
Stock Position:  0.5755848918177078
Bond Position:  [-60.20795743]


portfolio before change:  [-1.08901835]
curr_Stock_Price:  102.71760609326522
curr_Factors:  [102.71760609]
mat_Sqrt:  [[0.15]]
grads:  [0.61392104]
Stock Position:  0.6139210402940042
Bond Position:  [-64.14951794]


portfolio before change:  [-0.84508822]
curr_Stock_Price:  103.12146846460482
curr_Factors:  [103.12146846]
mat_Sqrt:  [[0.15]]
grads:  [0.09995484]
Stock Position:  0.09995484321051021
Bond Position:  [-11.15257843]


portfolio before change:  [-0.86033343]
curr_Stock_Price:  102.97592119716039
curr_Factors:  [102.9759212]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597031]
Stock Position:  -0.0459703085475686
Bond Position:  [3.87350144]


portfolio before change:  [-0.88218352]
curr_Stock_Price:  103.45649640894256
curr_Factors:  [103.45649641]
mat_Sqrt:  [[0.15]]
grads:  [0.20713519]
Stock Position:  0.20713518922279292
Bond Position:  [-22.31166448]


portfolio before change:  [-1.060662]
curr_Stock_Price:  102.60157669252528
curr_Factors:  [102.60157669]
mat_Sqrt:  [[0.15]]
grads:  [0.07603062]
Stock Position:  0.07603061944992165
Bond Position:  [-8.86152343]


portfolio before change:  [-1.07274947]
curr_Stock_Price:  102.44987983549782
curr_Factors:  [102.44987984]
mat_Sqrt:  [[0.15]]
grads:  [-0.05881441]
Stock Position:  -0.05881441057237927
Bond Position:  [4.95277983]


portfolio before change:  [-1.10448935]
curr_Stock_Price:  102.99480488771414
curr_Factors:  [102.99480489]
mat_Sqrt:  [[0.15]]
grads:  [0.05036968]
Stock Position:  0.05036968251341974
Bond Position:  [-6.29230498]


portfolio before change:  [-1.04613046]
curr_Stock_Price:  104.16122429470813
curr_Factors:  [104.16122429]
mat_Sqrt:  [[0.15]]
grads:  [-0.06069558]
Stock Position:  -0.06069558448757793
Bond Position:  [5.27599593]


portfolio before change:  [-1.05571939]
curr_Stock_Price:  104.32464136532329
curr_Factors:  [104.32464137]
mat_Sqrt:  [[0.15]]
grads:  [0.10019752]
Stock Position:  0.10019751776563042
Bond Position:  [-11.5087895]


portfolio before change:  [-1.04044304]
curr_Stock_Price:  104.48428281336517
curr_Factors:  [104.48428281]
mat_Sqrt:  [[0.15]]
grads:  [-0.10528778]
Stock Position:  -0.10528778045590936
Bond Position:  [9.96047519]


portfolio before change:  [-1.08234586]
curr_Stock_Price:  104.88817938319418
curr_Factors:  [104.88817938]
mat_Sqrt:  [[0.15]]
grads:  [0.06856789]
Stock Position:  0.0685678852661841
Bond Position:  [-8.27430651]


portfolio before change:  [-1.03793756]
curr_Stock_Price:  105.54337624937156
curr_Factors:  [105.54337625]
mat_Sqrt:  [[0.15]]
grads:  [-0.601387]
Stock Position:  -0.6013869955431403
Bond Position:  [62.43447638]


portfolio before change:  [-1.14500551]
curr_Stock_Price:  105.7279000746952
curr_Factors:  [105.72790007]
mat_Sqrt:  [[0.15]]
grads:  [0.09251957]
Stock Position:  0.09251956861705629
Bond Position:  [-10.92690522]


portfolio before change:  [-1.06854984]
curr_Stock_Price:  106.56165476241702
curr_Factors:  [106.56165476]
mat_Sqrt:  [[0.15]]
grads:  [0.03278017]
Stock Position:  0.03278017303662839
Bond Position:  [-4.56165932]


portfolio before change:  [-1.06290597]
curr_Stock_Price:  106.74252585178961
curr_Factors:  [106.74252585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01890031]
Stock Position:  -0.018900309095691206
Bond Position:  [0.95456076]


portfolio before change:  [-1.06027799]
curr_Stock_Price:  106.60663854074298
curr_Factors:  [106.60663854]
mat_Sqrt:  [[0.15]]
grads:  [0.17692054]
Stock Position:  0.176920543184374
Bond Position:  [-19.92118239]


portfolio before change:  [-1.01116278]
curr_Stock_Price:  106.89128791397853
curr_Factors:  [106.89128791]
mat_Sqrt:  [[0.15]]
grads:  [0.52582615]
Stock Position:  0.5258261523960679
Bond Position:  [-57.21739743]


portfolio before change:  [-0.73539034]
curr_Stock_Price:  107.42254456614447
curr_Factors:  [107.42254457]
mat_Sqrt:  [[0.15]]
grads:  [0.09817133]
Stock Position:  0.09817132882740563
Bond Position:  [-11.28120429]


portfolio before change:  [-0.75565611]
curr_Stock_Price:  107.22329421597989
curr_Factors:  [107.22329422]
mat_Sqrt:  [[0.15]]
grads:  [0.16879988]
Stock Position:  0.16879987685440329
Bond Position:  [-18.85493497]


portfolio before change:  [-0.80616482]
curr_Stock_Price:  106.93105325432907
curr_Factors:  [106.93105325]
mat_Sqrt:  [[0.15]]
grads:  [0.10686684]
Stock Position:  0.1068668392512739
Bond Position:  [-12.2335485]


portfolio before change:  [-0.77645354]
curr_Stock_Price:  107.21622964030152
curr_Factors:  [107.21622964]
mat_Sqrt:  [[0.15]]
grads:  [-0.04954062]
Stock Position:  -0.04954062046388436
Bond Position:  [4.535105]


portfolio before change:  [-0.7708013]
curr_Stock_Price:  107.10785818059246
curr_Factors:  [107.10785818]
mat_Sqrt:  [[0.15]]
grads:  [0.04244503]
Stock Position:  0.042445032331483876
Bond Position:  [-5.3169978]


portfolio before change:  [-0.7811818]
curr_Stock_Price:  106.87112436697633
curr_Factors:  [106.87112437]
mat_Sqrt:  [[0.15]]
grads:  [0.0623965]
Stock Position:  0.06239649539433213
Bond Position:  [-7.44956542]


portfolio before change:  [-0.81959505]
curr_Stock_Price:  106.26295498609684
curr_Factors:  [106.26295499]
mat_Sqrt:  [[0.15]]
grads:  [0.02132265]
Stock Position:  0.021322654763003684
Bond Position:  [-3.08540335]


portfolio before change:  [-0.81304711]
curr_Stock_Price:  106.57908756261116
curr_Factors:  [106.57908756]
mat_Sqrt:  [[0.15]]
grads:  [-0.20692728]
Stock Position:  -0.20692727549219364
Bond Position:  [21.24107311]


portfolio before change:  [-0.70145044]
curr_Stock_Price:  106.0461996113407
curr_Factors:  [106.04619961]
mat_Sqrt:  [[0.15]]
grads:  [0.05639804]
Stock Position:  0.05639804092518555
Bond Position:  [-6.68224835]


portfolio before change:  [-0.75828259]
curr_Stock_Price:  105.04590794956462
curr_Factors:  [105.04590795]
mat_Sqrt:  [[0.15]]
grads:  [0.10761771]
Stock Position:  0.10761771146786568
Bond Position:  [-12.0630828]


portfolio before change:  [-0.80729181]
curr_Stock_Price:  104.59751285131668
curr_Factors:  [104.59751285]
mat_Sqrt:  [[0.15]]
grads:  [0.0097042]
Stock Position:  0.00970420068056102
Bond Position:  [-1.82232706]


portfolio before change:  [-0.80706178]
curr_Stock_Price:  104.63295433584855
curr_Factors:  [104.63295434]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060589]
Stock Position:  -0.030605886998971977
Bond Position:  [2.3953226]


portfolio before change:  [-0.82264055]
curr_Stock_Price:  105.1468583702064
curr_Factors:  [105.14685837]
mat_Sqrt:  [[0.15]]
grads:  [-0.09585618]
Stock Position:  -0.09585618421368026
Bond Position:  [9.25633607]


portfolio before change:  [-0.83630758]
curr_Stock_Price:  105.29547233122206
curr_Factors:  [105.29547233]
mat_Sqrt:  [[0.15]]
grads:  [0.13435957]
Stock Position:  0.13435957364896464
Bond Position:  [-14.98376235]


portfolio before change:  [-1.01849616]
curr_Stock_Price:  103.94646487430568
curr_Factors:  [103.94646487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01764111]
Stock Position:  -0.01764111069652343
Bond Position:  [0.81523493]


portfolio before change:  [-1.01421925]
curr_Stock_Price:  103.70691309160989
curr_Factors:  [103.70691309]
mat_Sqrt:  [[0.15]]
grads:  [0.03569628]
Stock Position:  0.03569628494492332
Bond Position:  [-4.71617077]


portfolio before change:  [-1.00388769]
curr_Stock_Price:  104.00460032342596
curr_Factors:  [104.00460032]
mat_Sqrt:  [[0.15]]
grads:  [-0.10926954]
Stock Position:  -0.1092695355026392
Bond Position:  [10.36064668]


portfolio before change:  [-1.02882645]
curr_Stock_Price:  104.23875817578555
curr_Factors:  [104.23875818]
mat_Sqrt:  [[0.15]]
grads:  [0.10021521]
Stock Position:  0.10021520726572422
Bond Position:  [-11.47513521]


portfolio before change:  [-0.9197776]
curr_Stock_Price:  105.33406167046265
curr_Factors:  [105.33406167]
mat_Sqrt:  [[0.15]]
grads:  [0.1252748]
Stock Position:  0.12527480288760529
Bond Position:  [-14.11548141]


portfolio before change:  [-0.95805662]
curr_Stock_Price:  105.03554371711861
curr_Factors:  [105.03554372]
mat_Sqrt:  [[0.15]]
grads:  [0.04768279]
Stock Position:  0.04768278852864339
Bond Position:  [-5.96644424]


portfolio before change:  [-0.96953649]
curr_Stock_Price:  104.8026096297012
curr_Factors:  [104.80260963]
mat_Sqrt:  [[0.15]]
grads:  [-0.05008032]
Stock Position:  -0.050080319170014945
Bond Position:  [4.27901165]


portfolio before change:  [-1.0475982]
curr_Stock_Price:  106.3666802685829
curr_Factors:  [106.36668027]
mat_Sqrt:  [[0.15]]
grads:  [0.20851329]
Stock Position:  0.20851328858572507
Bond Position:  [-23.22646449]


portfolio before change:  [-1.10341209]
curr_Stock_Price:  106.10596691276892
curr_Factors:  [106.10596691]
mat_Sqrt:  [[0.15]]
grads:  [0.03675247]
Stock Position:  0.03675246600461868
Bond Position:  [-5.00306804]


portfolio before change:  [-1.10462164]
curr_Stock_Price:  106.08156472943126
curr_Factors:  [106.08156473]
mat_Sqrt:  [[0.15]]
grads:  [-0.06860174]
Stock Position:  -0.06860174493448139
Bond Position:  [6.17275881]


portfolio before change:  [-1.03401969]
curr_Stock_Price:  105.05803191392876
curr_Factors:  [105.05803191]
mat_Sqrt:  [[0.15]]
grads:  [0.03922898]
Stock Position:  0.03922898320326252
Bond Position:  [-5.15533946]


portfolio before change:  [-1.01784311]
curr_Stock_Price:  105.47860876461796
curr_Factors:  [105.47860876]
mat_Sqrt:  [[0.15]]
grads:  [-0.10515857]
Stock Position:  -0.10515856725440371
Bond Position:  [10.07413627]


portfolio before change:  [-0.99685112]
curr_Stock_Price:  105.28497417511828
curr_Factors:  [105.28497418]
mat_Sqrt:  [[0.15]]
grads:  [0.13891067]
Stock Position:  0.13891067110136351
Bond Position:  [-15.62205754]


portfolio before change:  [-1.0499217]
curr_Stock_Price:  104.90995495237587
curr_Factors:  [104.90995495]
mat_Sqrt:  [[0.15]]
grads:  [0.07887073]
Stock Position:  0.07887073280284779
Bond Position:  [-9.32424672]


portfolio before change:  [-1.12683165]
curr_Stock_Price:  103.94220470258736
curr_Factors:  [103.9422047]
mat_Sqrt:  [[0.15]]
grads:  [0.00229103]
Stock Position:  0.002291030846614956
Bond Position:  [-1.36496645]


portfolio before change:  [-1.12718832]
curr_Stock_Price:  103.82376201629678
curr_Factors:  [103.82376202]
mat_Sqrt:  [[0.15]]
grads:  [0.01176376]
Stock Position:  0.011763757117724389
Bond Position:  [-2.34854584]


portfolio before change:  [-1.12695928]
curr_Stock_Price:  103.8557103523294
curr_Factors:  [103.85571035]
mat_Sqrt:  [[0.15]]
grads:  [0.09362675]
Stock Position:  0.09362675322555947
Bond Position:  [-10.85063224]


portfolio before change:  [-1.21044481]
curr_Stock_Price:  102.97126923538879
curr_Factors:  [102.97126924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01067199]
Stock Position:  -0.010671993371218139
Bond Position:  [-0.11153611]


portfolio before change:  [-1.20981958]
curr_Stock_Price:  102.91202948399769
curr_Factors:  [102.91202948]
mat_Sqrt:  [[0.15]]
grads:  [0.10664006]
Stock Position:  0.10664005791365122
Bond Position:  [-12.18436436]


portfolio before change:  [-1.31447991]
curr_Stock_Price:  101.9377353478638
curr_Factors:  [101.93773535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01994713]
Stock Position:  -0.01994712674235433
Bond Position:  [0.71888502]


portfolio before change:  [-1.30800748]
curr_Stock_Price:  101.61550862763103
curr_Factors:  [101.61550863]
mat_Sqrt:  [[0.15]]
grads:  [-0.08474768]
Stock Position:  -0.08474767830471837
Bond Position:  [7.30367096]


portfolio before change:  [-1.33572474]
curr_Stock_Price:  101.94795136145628
curr_Factors:  [101.94795136]
mat_Sqrt:  [[0.15]]
grads:  [-0.01042829]
Stock Position:  -0.010428288254300349
Bond Position:  [-0.27258211]


portfolio before change:  [-1.34270205]
curr_Stock_Price:  102.61539362526997
curr_Factors:  [102.61539363]
mat_Sqrt:  [[0.15]]
grads:  [0.00743521]
Stock Position:  0.007435213403919917
Bond Position:  [-2.1056694]


portfolio before change:  [-1.34254525]
curr_Stock_Price:  102.65418309806377
curr_Factors:  [102.6541831]
mat_Sqrt:  [[0.15]]
grads:  [-0.03622194]
Stock Position:  -0.036221937494026774
Bond Position:  [2.37578815]


portfolio before change:  [-1.32092551]
curr_Stock_Price:  102.06141370573505
curr_Factors:  [102.06141371]
mat_Sqrt:  [[0.15]]
grads:  [0.10076601]
Stock Position:  0.10076601199265399
Bond Position:  [-11.60524714]


portfolio before change:  [-1.32973835]
curr_Stock_Price:  101.98115361953879
curr_Factors:  [101.98115362]
mat_Sqrt:  [[0.15]]
grads:  [-0.05563924]
Stock Position:  -0.05563923686638133
Bond Position:  [4.34441522]


portfolio before change:  [-1.31070196]
curr_Stock_Price:  101.64389432865289
curr_Factors:  [101.64389433]
mat_Sqrt:  [[0.15]]
grads:  [0.07051944]
Stock Position:  0.07051943822198511
Bond Position:  [-8.47857229]


portfolio before change:  [-1.28793445]
curr_Stock_Price:  101.97426337237935
curr_Factors:  [101.97426337]
mat_Sqrt:  [[0.15]]
grads:  [-0.07627266]
Stock Position:  -0.07627266328518302
Bond Position:  [6.4899142]


portfolio before change:  [-1.23555229]
curr_Stock_Price:  101.29280653292841
curr_Factors:  [101.29280653]
mat_Sqrt:  [[0.15]]
grads:  [0.07553878]
Stock Position:  0.07553877927220293
Bond Position:  [-8.88708724]


portfolio before change:  [-1.20374424]
curr_Stock_Price:  101.72124222706694
curr_Factors:  [101.72124223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01804621]
Stock Position:  -0.01804621169351889
Bond Position:  [0.63193883]


portfolio before change:  [-1.202454]
curr_Stock_Price:  101.6519342798816
curr_Factors:  [101.65193428]
mat_Sqrt:  [[0.15]]
grads:  [0.12608998]
Stock Position:  0.12608998451604747
Bond Position:  [-14.01974482]


portfolio before change:  [-1.1391516]
curr_Stock_Price:  102.16092517991437
curr_Factors:  [102.16092518]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987265]
Stock Position:  -0.14987264740427259
Bond Position:  [14.17197671]


portfolio before change:  [-1.02235064]
curr_Stock_Price:  101.3875006441578
curr_Factors:  [101.38750064]
mat_Sqrt:  [[0.15]]
grads:  [-0.02343531]
Stock Position:  -0.02343531091133304
Bond Position:  [1.35369696]


portfolio before change:  [-1.02462329]
curr_Stock_Price:  101.48808600282567
curr_Factors:  [101.488086]
mat_Sqrt:  [[0.15]]
grads:  [-0.0692812]
Stock Position:  -0.06928120377795992
Bond Position:  [6.00659348]


portfolio before change:  [-1.01646512]
curr_Stock_Price:  101.37575040733715
curr_Factors:  [101.37575041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01010534]
Stock Position:  -0.010105341006666529
Bond Position:  [0.00797141]


portfolio before change:  [-1.01353494]
curr_Stock_Price:  101.08583660975039
curr_Factors:  [101.08583661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.01353494]
Stock Price:  100.84744818098653
PL:  [-1.86098312]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.52194550e-03]
 [-4.00298958e-02]
 [-8.90395100e-03]
 [ 5.53842381e-03]
 [-9.03085529e-03]
 [ 1.30355412e-02]
 [ 3.64422219e-03]
 [-2.63198295e-02]
 [-3.50271096e-02]
 [ 3.75185837e-02]
 [-1.01133189e-01]
 [ 3.10188271e-02]
 [-7.29475405e-03]
 [-3.25566720e-03]
 [-7.07354216e-03]
 [ 1.03613097e-02]
 [ 1.61969670e-02]
 [ 1.95055155e-02]
 [ 8.15876423e-04]
 [ 1.45281182e-02]
 [ 1.32684724e-02]
 [-1.34217223e-02]
 [-5.41446613e-03]
 [-1.61655702e-01]
 [-1.43007192e-02]
 [ 4.89083013e-03]
 [ 1.00505449e-02]
 [ 2.16883197e-02]
 [-1.41960473e-01]
 [ 1.28046975e-02]
 [ 3.66856335e-02]
 [-1.93405275e-02]
 [-5.03706446e-03]
 [ 1.09150821e-02]
 [ 1.46055355e-02]
 [-1.95711463e-02]
 [-2.09451811e-02]
 [ 5.75106633e-03]
 [-7.98758322e-02]
 [-4.71023636e-02]
 [-2.05291857e-02]
 [ 1.12974120e-01]
 [ 2.39957048e-02]
 [ 1.34894291e-03]
 [ 2.04209323e-02]
 [ 5.44414680e-02]
 [-7.05127273e-03]
 [ 6.65045290e-03]
 [ 4.78993900e-02]
 [ 1.22815149e-02]
 [ 2.70103560e-02]
 [ 3.93385481e-02]
 [-4.87290518e-03]
 [ 3.65855022e-03]
 [ 5.64229802e-03]
 [ 1.08243371e-02]
 [-4.11972700e-02]
 [ 1.98260787e-03]
 [ 1.67383223e-03]
 [-1.65119179e-01]
 [-2.12416538e-02]
 [ 1.65953816e-02]
 [ 2.01683501e-02]
 [-2.05234582e-02]
 [-7.46526384e-03]
 [-1.34627021e-02]
 [-2.98030712e-03]
 [-2.02412289e-02]
 [-2.63657829e-02]
 [ 2.01937418e-02]
 [ 2.53641257e-02]
 [ 1.45349285e-02]
 [-1.48658737e-03]
 [ 1.32835934e-02]
 [ 3.62201499e-02]
 [-2.92025528e-02]
 [ 4.23140558e-03]
 [ 1.10792818e-02]
 [ 8.72013892e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.43374077]
curr_Stock_Price:  99.31884290883931
curr_Factors:  [99.31884291]
mat_Sqrt:  [[0.15]]
grads:  [0.03681297]
Stock Position:  0.03681297002857964
Bond Position:  [-12.08996236]


portfolio before change:  [-8.47416463]
curr_Stock_Price:  98.24128211077281
curr_Factors:  [98.24128211]
mat_Sqrt:  [[0.15]]
grads:  [-0.26686597]
Stock Position:  -0.2668659717896544
Bond Position:  [17.74309059]


portfolio before change:  [-8.41370389]
curr_Stock_Price:  98.01887922852858
curr_Factors:  [98.01887923]
mat_Sqrt:  [[0.15]]
grads:  [-0.05935967]
Stock Position:  -0.05935967336048245
Bond Position:  [-2.59533523]


portfolio before change:  [-8.43362082]
curr_Stock_Price:  98.35167620698384
curr_Factors:  [98.35167621]
mat_Sqrt:  [[0.15]]
grads:  [0.03692283]
Stock Position:  0.03692282542633922
Bond Position:  [-12.06504259]


portfolio before change:  [-8.4589535]
curr_Stock_Price:  97.68600150761368
curr_Factors:  [97.68600151]
mat_Sqrt:  [[0.15]]
grads:  [-0.0602057]
Stock Position:  -0.06020570191429601
Bond Position:  [-2.57769921]


portfolio before change:  [-8.49129667]
curr_Stock_Price:  98.22053657521325
curr_Factors:  [98.22053658]
mat_Sqrt:  [[0.15]]
grads:  [0.08690361]
Stock Position:  0.0869036078704334
Bond Position:  [-17.02701567]


portfolio before change:  [-8.51830543]
curr_Stock_Price:  97.92199270353733
curr_Factors:  [97.9219927]
mat_Sqrt:  [[0.15]]
grads:  [0.02429481]
Stock Position:  0.02429481462036651
Bond Position:  [-10.89730209]


portfolio before change:  [-8.5253599]
curr_Stock_Price:  97.65965824190928
curr_Factors:  [97.65965824]
mat_Sqrt:  [[0.15]]
grads:  [-0.17546553]
Stock Position:  -0.17546552973927346
Bond Position:  [8.61054376]


portfolio before change:  [-8.4228311]
curr_Stock_Price:  97.07840090663707
curr_Factors:  [97.07840091]
mat_Sqrt:  [[0.15]]
grads:  [-0.23351406]
Stock Position:  -0.23351406383445447
Bond Position:  [14.24634081]


portfolio before change:  [-8.37239944]
curr_Stock_Price:  96.86624566243364
curr_Factors:  [96.86624566]
mat_Sqrt:  [[0.15]]
grads:  [0.25012389]
Stock Position:  0.25012389146029285
Bond Position:  [-32.60096176]


portfolio before change:  [-8.44490479]
curr_Stock_Price:  96.58451437215462
curr_Factors:  [96.58451437]
mat_Sqrt:  [[0.15]]
grads:  [-0.67422126]
Stock Position:  -0.6742212567646607
Bond Position:  [56.67442787]


portfolio before change:  [-8.83577028]
curr_Stock_Price:  97.16949703761051
curr_Factors:  [97.16949704]
mat_Sqrt:  [[0.15]]
grads:  [0.20679218]
Stock Position:  0.20679218090823845
Bond Position:  [-28.92966249]


portfolio before change:  [-9.00614098]
curr_Stock_Price:  96.3543668737724
curr_Factors:  [96.35436687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04863169]
Stock Position:  -0.04863169369029252
Bond Position:  [-4.32026493]


portfolio before change:  [-8.99328401]
curr_Stock_Price:  96.08444000709542
curr_Factors:  [96.08444001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170445]
Stock Position:  -0.021704447977720025
Bond Position:  [-6.90782428]


portfolio before change:  [-9.00643544]
curr_Stock_Price:  96.6704803569916
curr_Factors:  [96.67048036]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715695]
Stock Position:  -0.047156947734387236
Bond Position:  [-4.44775065]


portfolio before change:  [-8.97717647]
curr_Stock_Price:  96.0441259131249
curr_Factors:  [96.04412591]
mat_Sqrt:  [[0.15]]
grads:  [0.0690754]
Stock Position:  0.06907539785156354
Bond Position:  [-15.61146268]


portfolio before change:  [-8.9780646]
curr_Stock_Price:  96.04539443916856
curr_Factors:  [96.04539444]
mat_Sqrt:  [[0.15]]
grads:  [0.10797978]
Stock Position:  0.10797978008242393
Bond Position:  [-19.34902517]


portfolio before change:  [-8.93657438]
curr_Stock_Price:  96.44083479704582
curr_Factors:  [96.4408348]
mat_Sqrt:  [[0.15]]
grads:  [0.13003677]
Stock Position:  0.13003677004585443
Bond Position:  [-21.47742904]


portfolio before change:  [-8.96607067]
curr_Stock_Price:  96.22432756448231
curr_Factors:  [96.22432756]
mat_Sqrt:  [[0.15]]
grads:  [0.00543918]
Stock Position:  0.005439176150456677
Bond Position:  [-9.48945173]


portfolio before change:  [-8.96955492]
curr_Stock_Price:  95.6927877372135
curr_Factors:  [95.69278774]
mat_Sqrt:  [[0.15]]
grads:  [0.09685412]
Stock Position:  0.09685412130182729
Bond Position:  [-18.23779579]


portfolio before change:  [-9.01145416]
curr_Stock_Price:  95.2719553804249
curr_Factors:  [95.27195538]
mat_Sqrt:  [[0.15]]
grads:  [0.08845648]
Stock Position:  0.0884564827411402
Bond Position:  [-17.43887624]


portfolio before change:  [-9.11268981]
curr_Stock_Price:  94.13980901977213
curr_Factors:  [94.13980902]
mat_Sqrt:  [[0.15]]
grads:  [-0.08947815]
Stock Position:  -0.08947814892727078
Bond Position:  [-0.68923396]


portfolio before change:  [-9.11790801]
curr_Stock_Price:  94.1976457657475
curr_Factors:  [94.19764577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609644]
Stock Position:  -0.03609644089348309
Bond Position:  [-5.71770826]


portfolio before change:  [-9.11176675]
curr_Stock_Price:  94.01761053413873
curr_Factors:  [94.01761053]
mat_Sqrt:  [[0.15]]
grads:  [-1.07770468]
Stock Position:  -1.0777046827588332
Bond Position:  [92.21145238]


portfolio before change:  [-8.52479743]
curr_Stock_Price:  93.47831072734625
curr_Factors:  [93.47831073]
mat_Sqrt:  [[0.15]]
grads:  [-0.09533813]
Stock Position:  -0.09533812798848243
Bond Position:  [0.38724972]


portfolio before change:  [-8.48258278]
curr_Stock_Price:  93.03577587020429
curr_Factors:  [93.03577587]
mat_Sqrt:  [[0.15]]
grads:  [0.03260553]
Stock Position:  0.032605534227116734
Bond Position:  [-11.51606395]


portfolio before change:  [-8.51696344]
curr_Stock_Price:  92.00340851155995
curr_Factors:  [92.00340851]
mat_Sqrt:  [[0.15]]
grads:  [0.06700363]
Stock Position:  0.06700363289488594
Bond Position:  [-14.68152605]


portfolio before change:  [-8.52269859]
curr_Stock_Price:  91.93150914314587
curr_Factors:  [91.93150914]
mat_Sqrt:  [[0.15]]
grads:  [0.1445888]
Stock Position:  0.1445887979469988
Bond Position:  [-21.81496499]


portfolio before change:  [-8.57716016]
curr_Stock_Price:  91.56427393213427
curr_Factors:  [91.56427393]
mat_Sqrt:  [[0.15]]
grads:  [-0.94640315]
Stock Position:  -0.9464031536497551
Bond Position:  [78.07955745]


portfolio before change:  [-8.62546044]
curr_Stock_Price:  91.62046605825782
curr_Factors:  [91.62046606]
mat_Sqrt:  [[0.15]]
grads:  [0.08536465]
Stock Position:  0.08536464983820702
Bond Position:  [-16.44660945]


portfolio before change:  [-8.64688379]
curr_Stock_Price:  91.38154517218238
curr_Factors:  [91.38154517]
mat_Sqrt:  [[0.15]]
grads:  [0.24457089]
Stock Position:  0.24457089002107896
Bond Position:  [-30.99614962]


portfolio before change:  [-8.63492912]
curr_Stock_Price:  91.43834664779915
curr_Factors:  [91.43834665]
mat_Sqrt:  [[0.15]]
grads:  [-0.12893685]
Stock Position:  -0.1289368497786139
Bond Position:  [3.15484325]


portfolio before change:  [-8.68549605]
curr_Stock_Price:  91.83205965682139
curr_Factors:  [91.83205966]
mat_Sqrt:  [[0.15]]
grads:  [-0.03358043]
Stock Position:  -0.033580429761865115
Bond Position:  [-5.60173602]


portfolio before change:  [-8.66259463]
curr_Stock_Price:  91.1396462660085
curr_Factors:  [91.13964627]
mat_Sqrt:  [[0.15]]
grads:  [0.07276721]
Stock Position:  0.07276721382734593
Bond Position:  [-15.29457276]


portfolio before change:  [-8.6493965]
curr_Stock_Price:  91.33415785420165
curr_Factors:  [91.33415785]
mat_Sqrt:  [[0.15]]
grads:  [0.09737024]
Stock Position:  0.09737023685755672
Bond Position:  [-17.54262509]


portfolio before change:  [-8.72535861]
curr_Stock_Price:  90.5652816408108
curr_Factors:  [90.56528164]
mat_Sqrt:  [[0.15]]
grads:  [-0.13047431]
Stock Position:  -0.13047430854979222
Bond Position:  [3.09108389]


portfolio before change:  [-8.68072145]
curr_Stock_Price:  90.22464784298347
curr_Factors:  [90.22464784]
mat_Sqrt:  [[0.15]]
grads:  [-0.13963454]
Stock Position:  -0.13963454088113916
Bond Position:  [3.91775582]


portfolio before change:  [-8.58076751]
curr_Stock_Price:  89.51057611932853
curr_Factors:  [89.51057612]
mat_Sqrt:  [[0.15]]
grads:  [0.03834044]
Stock Position:  0.03834044221268808
Bond Position:  [-12.01264258]


portfolio before change:  [-8.58659912]
curr_Stock_Price:  89.3780582129465
curr_Factors:  [89.37805821]
mat_Sqrt:  [[0.15]]
grads:  [-0.53250555]
Stock Position:  -0.5325055480607277
Bond Position:  [39.00771276]


portfolio before change:  [-8.4888354]
curr_Stock_Price:  89.19904474793984
curr_Factors:  [89.19904475]
mat_Sqrt:  [[0.15]]
grads:  [-0.31401576]
Stock Position:  -0.3140157574000861
Bond Position:  [19.5210702]


portfolio before change:  [-8.81606485]
curr_Stock_Price:  90.24500995640891
curr_Factors:  [90.24500996]
mat_Sqrt:  [[0.15]]
grads:  [-0.13686124]
Stock Position:  -0.13686123784574183
Bond Position:  [3.53497892]


portfolio before change:  [-8.76407019]
curr_Stock_Price:  89.86671646763645
curr_Factors:  [89.86671647]
mat_Sqrt:  [[0.15]]
grads:  [0.7531608]
Stock Position:  0.7531607999373935
Bond Position:  [-76.44815825]


portfolio before change:  [-8.50807178]
curr_Stock_Price:  90.21295934938422
curr_Factors:  [90.21295935]
mat_Sqrt:  [[0.15]]
grads:  [0.15997137]
Stock Position:  0.15997136538929757
Bond Position:  [-22.93956207]


portfolio before change:  [-8.39632765]
curr_Stock_Price:  90.92044785598041
curr_Factors:  [90.92044786]
mat_Sqrt:  [[0.15]]
grads:  [0.00899295]
Stock Position:  0.00899295275153975
Bond Position:  [-9.21397094]


portfolio before change:  [-8.39595134]
curr_Stock_Price:  91.02633056670308
curr_Factors:  [91.02633057]
mat_Sqrt:  [[0.15]]
grads:  [0.13613955]
Stock Position:  0.13613954840629458
Bond Position:  [-20.78823488]


portfolio before change:  [-8.39571621]
curr_Stock_Price:  91.03760164590281
curr_Factors:  [91.03760165]
mat_Sqrt:  [[0.15]]
grads:  [0.36294312]
Stock Position:  0.36294311981932187
Bond Position:  [-41.43718737]


portfolio before change:  [-8.12151955]
curr_Stock_Price:  91.80021856831563
curr_Factors:  [91.80021857]
mat_Sqrt:  [[0.15]]
grads:  [-0.04700848]
Stock Position:  -0.04700848485842034
Bond Position:  [-3.80613036]


portfolio before change:  [-8.14770975]
curr_Stock_Price:  92.35229566832695
curr_Factors:  [92.35229567]
mat_Sqrt:  [[0.15]]
grads:  [0.04433635]
Stock Position:  0.04433635264428128
Bond Position:  [-12.24227369]


portfolio before change:  [-8.18977198]
curr_Stock_Price:  91.42084638675831
curr_Factors:  [91.42084639]
mat_Sqrt:  [[0.15]]
grads:  [0.31932927]
Stock Position:  0.31932926681899004
Bond Position:  [-37.38312382]


portfolio before change:  [-8.2840316]
curr_Stock_Price:  91.13298330268532
curr_Factors:  [91.1329833]
mat_Sqrt:  [[0.15]]
grads:  [0.08187677]
Stock Position:  0.0818767657539563
Bond Position:  [-15.74570553]


portfolio before change:  [-8.3414089]
curr_Stock_Price:  90.44422668497239
curr_Factors:  [90.44422668]
mat_Sqrt:  [[0.15]]
grads:  [0.18006904]
Stock Position:  0.18006903997610504
Bond Position:  [-24.62761397]


portfolio before change:  [-8.46854858]
curr_Stock_Price:  89.74671418011845
curr_Factors:  [89.74671418]
mat_Sqrt:  [[0.15]]
grads:  [0.26225699]
Stock Position:  0.2622569871851488
Bond Position:  [-32.00525146]


portfolio before change:  [-8.5722862]
curr_Stock_Price:  89.35878466553152
curr_Factors:  [89.35878467]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248603]
Stock Position:  -0.032486034547629696
Bond Position:  [-5.66937364]


portfolio before change:  [-8.5863601]
curr_Stock_Price:  89.78110608733424
curr_Factors:  [89.78110609]
mat_Sqrt:  [[0.15]]
grads:  [0.02439033]
Stock Position:  0.024390334783230147
Bond Position:  [-10.77615133]


portfolio before change:  [-8.57504774]
curr_Stock_Price:  90.27252551015228
curr_Factors:  [90.27252551]
mat_Sqrt:  [[0.15]]
grads:  [0.03761532]
Stock Position:  0.03761532013050398
Bond Position:  [-11.97067769]


portfolio before change:  [-8.58618702]
curr_Stock_Price:  89.99627945040925
curr_Factors:  [89.99627945]
mat_Sqrt:  [[0.15]]
grads:  [0.07216225]
Stock Position:  0.07216224719131649
Bond Position:  [-15.08052078]


portfolio before change:  [-8.53878005]
curr_Stock_Price:  90.66629081949897
curr_Factors:  [90.66629082]
mat_Sqrt:  [[0.15]]
grads:  [-0.27464847]
Stock Position:  -0.2746484668144844
Bond Position:  [16.36257771]


portfolio before change:  [-8.56291538]
curr_Stock_Price:  90.75789163628605
curr_Factors:  [90.75789164]
mat_Sqrt:  [[0.15]]
grads:  [0.01321739]
Stock Position:  0.013217385831917894
Bond Position:  [-9.76249746]


portfolio before change:  [-8.55998342]
curr_Stock_Price:  91.02588224164636
curr_Factors:  [91.02588224]
mat_Sqrt:  [[0.15]]
grads:  [0.01115888]
Stock Position:  0.01115888151040019
Bond Position:  [-9.57573046]


portfolio before change:  [-8.55806522]
curr_Stock_Price:  91.25141611565296
curr_Factors:  [91.25141612]
mat_Sqrt:  [[0.15]]
grads:  [-1.10079452]
Stock Position:  -1.1007945241414783
Bond Position:  [91.89099396]


portfolio before change:  [-8.36700423]
curr_Stock_Price:  91.08306714412149
curr_Factors:  [91.08306714]
mat_Sqrt:  [[0.15]]
grads:  [-0.14161103]
Stock Position:  -0.14161102541112705
Bond Position:  [4.53136231]


portfolio before change:  [-8.3856693]
curr_Stock_Price:  91.21687234506152
curr_Factors:  [91.21687235]
mat_Sqrt:  [[0.15]]
grads:  [0.11063588]
Stock Position:  0.11063587742278558
Bond Position:  [-18.47752801]


portfolio before change:  [-8.39569698]
curr_Stock_Price:  91.1366741277331
curr_Factors:  [91.13667413]
mat_Sqrt:  [[0.15]]
grads:  [0.13445567]
Stock Position:  0.13445566750074
Bond Position:  [-20.64953934]


portfolio before change:  [-8.36907284]
curr_Stock_Price:  91.34428738622232
curr_Factors:  [91.34428739]
mat_Sqrt:  [[0.15]]
grads:  [-0.13682305]
Stock Position:  -0.13682305466129346
Bond Position:  [4.12893159]


portfolio before change:  [-8.38443993]
curr_Stock_Price:  91.45848710189199
curr_Factors:  [91.4584871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04976843]
Stock Position:  -0.04976842560244443
Bond Position:  [-3.83269502]


portfolio before change:  [-8.36032109]
curr_Stock_Price:  90.96905259416802
curr_Factors:  [90.96905259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08975135]
Stock Position:  -0.08975134762155314
Bond Position:  [-0.19572603]


portfolio before change:  [-8.36844671]
curr_Stock_Price:  91.05945107473484
curr_Factors:  [91.05945107]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986871]
Stock Position:  -0.019868714113841553
Bond Position:  [-6.55921251]


portfolio before change:  [-8.35912242]
curr_Stock_Price:  90.5695224441474
curr_Factors:  [90.56952244]
mat_Sqrt:  [[0.15]]
grads:  [-0.13494153]
Stock Position:  -0.13494152609073232
Bond Position:  [3.86246715]


portfolio before change:  [-8.39737614]
curr_Stock_Price:  90.85479511260505
curr_Factors:  [90.85479511]
mat_Sqrt:  [[0.15]]
grads:  [-0.17577189]
Stock Position:  -0.17577188610456265
Bond Position:  [7.57234256]


portfolio before change:  [-8.21167468]
curr_Stock_Price:  89.80099649434817
curr_Factors:  [89.80099649]
mat_Sqrt:  [[0.15]]
grads:  [0.13462495]
Stock Position:  0.13462494504433034
Bond Position:  [-20.3011289]


portfolio before change:  [-8.20897007]
curr_Stock_Price:  89.83051160956671
curr_Factors:  [89.83051161]
mat_Sqrt:  [[0.15]]
grads:  [0.16909417]
Stock Position:  0.1690941710964828
Bond Position:  [-23.39878597]


portfolio before change:  [-8.3052631]
curr_Stock_Price:  89.26969657487213
curr_Factors:  [89.26969657]
mat_Sqrt:  [[0.15]]
grads:  [0.09689952]
Stock Position:  0.09689952334340744
Bond Position:  [-16.95545414]


portfolio before change:  [-8.23361142]
curr_Stock_Price:  90.02007618735995
curr_Factors:  [90.02007619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00991058]
Stock Position:  -0.009910582447593281
Bond Position:  [-7.34146003]


portfolio before change:  [-8.2374451]
curr_Stock_Price:  90.36060330422245
curr_Factors:  [90.3606033]
mat_Sqrt:  [[0.15]]
grads:  [0.08855729]
Stock Position:  0.08855728926199953
Bond Position:  [-16.23953518]


portfolio before change:  [-8.23072589]
curr_Stock_Price:  90.44793896829144
curr_Factors:  [90.44793897]
mat_Sqrt:  [[0.15]]
grads:  [0.24146767]
Stock Position:  0.24146766630457275
Bond Position:  [-30.07097863]


portfolio before change:  [-8.14266603]
curr_Stock_Price:  90.8204085255446
curr_Factors:  [90.82040853]
mat_Sqrt:  [[0.15]]
grads:  [-0.19468369]
Stock Position:  -0.19468368524268106
Bond Position:  [9.5385858]


portfolio before change:  [-8.21784227]
curr_Stock_Price:  91.20961638658707
curr_Factors:  [91.20961639]
mat_Sqrt:  [[0.15]]
grads:  [0.02820937]
Stock Position:  0.028209370527595094
Bond Position:  [-10.79080813]


portfolio before change:  [-8.21587552]
curr_Stock_Price:  91.3032447278427
curr_Factors:  [91.30324473]
mat_Sqrt:  [[0.15]]
grads:  [0.07386188]
Stock Position:  0.07386187838540102
Bond Position:  [-14.95970468]


portfolio before change:  [-8.20358798]
curr_Stock_Price:  91.4822619839055
curr_Factors:  [91.48226198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.20358798]
Stock Price:  91.28785569553051
PL:  [-8.20358798]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.22089052e-04]
 [ 1.31527913e-04]
 [-3.90215531e-03]
 [ 1.21805484e-03]
 [ 4.05859907e-03]
 [ 2.85436726e-02]
 [ 1.06046845e-03]
 [-2.21079036e-03]
 [ 2.57211545e-02]
 [-3.57588204e-03]
 [ 1.75271319e-02]
 [-4.76802179e-02]
 [ 2.25737840e-02]
 [ 3.68913578e-03]
 [-6.89942550e-03]
 [ 2.59773792e-02]
 [ 1.15405397e-02]
 [-8.55621724e-03]
 [ 5.82652239e-03]
 [-5.55538520e-03]
 [ 1.33633976e-02]
 [-5.66397244e-03]
 [ 7.01280727e-03]
 [-6.30095561e-03]
 [ 3.52331035e-03]
 [ 7.86198694e-03]
 [-5.32817781e-03]
 [ 1.05470155e-02]
 [ 2.25437728e-02]
 [-2.49541149e-04]
 [ 8.74903527e-03]
 [-1.16777333e-02]
 [ 8.93109718e-03]
 [ 7.67158142e-03]
 [ 1.12596059e-02]
 [ 8.56540047e-03]
 [-3.39983922e-02]
 [ 9.70470019e-03]
 [ 1.55199250e-03]
 [ 1.57441731e-02]
 [-6.50684911e-03]
 [-1.64186089e-02]
 [ 2.27052393e-02]
 [ 1.77224917e-03]
 [-6.93596975e-03]
 [-5.41602888e-04]
 [ 1.22303713e-02]
 [-4.64136959e-03]
 [-7.85001172e-03]
 [-7.43354235e-03]
 [-3.73106342e-02]
 [ 2.07811828e-03]
 [-4.42707056e-03]
 [ 5.40791715e-03]
 [-2.27198656e-03]
 [-5.74558201e-07]
 [ 6.06745358e-03]
 [-7.06245502e-04]
 [ 1.63862466e-03]
 [ 1.45861598e-02]
 [ 9.00849938e-04]
 [-6.63686673e-03]
 [ 2.31514125e-04]
 [-1.24905533e-02]
 [ 1.41730567e-03]
 [ 1.08952105e-04]
 [-5.43668633e-03]
 [ 1.50527944e-02]
 [-8.27814234e-03]
 [ 1.09226540e-02]
 [-1.26305367e-02]
 [ 1.29922207e-02]
 [-2.06499067e-03]
 [ 2.28514688e-02]
 [-2.24837876e-02]
 [-1.00397534e-03]
 [-6.58316247e-03]
 [-6.23433594e-03]
 [ 2.77731658e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.74020644]
curr_Stock_Price:  101.15085266787327
curr_Factors:  [101.15085267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00148059]
Stock Position:  -0.0014805936813344924
Bond Position:  [19.88996975]


portfolio before change:  [19.74170738]
curr_Stock_Price:  100.97674761691813
curr_Factors:  [100.97674762]
mat_Sqrt:  [[0.15]]
grads:  [0.00087685]
Stock Position:  0.0008768527507851405
Bond Position:  [19.65316564]


portfolio before change:  [19.74284114]
curr_Stock_Price:  100.86886349520107
curr_Factors:  [100.8688635]
mat_Sqrt:  [[0.15]]
grads:  [-0.02601437]
Stock Position:  -0.02601436876045889
Bond Position:  [22.36688095]


portfolio before change:  [19.72403751]
curr_Stock_Price:  101.64541908509503
curr_Factors:  [101.64541909]
mat_Sqrt:  [[0.15]]
grads:  [0.00812037]
Stock Position:  0.008120365571128326
Bond Position:  [18.89863955]


portfolio before change:  [19.71574343]
curr_Stock_Price:  100.47856517897922
curr_Factors:  [100.47856518]
mat_Sqrt:  [[0.15]]
grads:  [0.02705733]
Stock Position:  0.027057327139203974
Bond Position:  [16.99706203]


portfolio before change:  [19.72506014]
curr_Stock_Price:  100.7836342400481
curr_Factors:  [100.78363424]
mat_Sqrt:  [[0.15]]
grads:  [0.19029115]
Stock Position:  0.19029115051700407
Bond Position:  [0.54682643]


portfolio before change:  [19.7464026]
curr_Stock_Price:  100.89561152197918
curr_Factors:  [100.89561152]
mat_Sqrt:  [[0.15]]
grads:  [0.00706979]
Stock Position:  0.007069789659336319
Bond Position:  [19.03309185]


portfolio before change:  [19.75009528]
curr_Stock_Price:  101.24966421628866
curr_Factors:  [101.24966422]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147386]
Stock Position:  -0.014738602371956016
Bond Position:  [21.24237383]


portfolio before change:  [19.7610102]
curr_Stock_Price:  100.59918039055876
curr_Factors:  [100.59918039]
mat_Sqrt:  [[0.15]]
grads:  [0.17147436]
Stock Position:  0.17147436351366488
Bond Position:  [2.51082977]


portfolio before change:  [19.71281524]
curr_Stock_Price:  100.31720302566531
curr_Factors:  [100.31720303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02383921]
Stock Position:  -0.023839213573632195
Bond Position:  [22.10429847]


portfolio before change:  [19.69821918]
curr_Stock_Price:  100.987427225987
curr_Factors:  [100.98742723]
mat_Sqrt:  [[0.15]]
grads:  [0.11684755]
Stock Position:  0.11684754576502843
Bond Position:  [7.89808616]


portfolio before change:  [19.74026618]
curr_Stock_Price:  101.34304748319175
curr_Factors:  [101.34304748]
mat_Sqrt:  [[0.15]]
grads:  [-0.31786812]
Stock Position:  -0.3178681194805829
Bond Position:  [51.95399011]


portfolio before change:  [19.88283616]
curr_Stock_Price:  100.90474384304862
curr_Factors:  [100.90474384]
mat_Sqrt:  [[0.15]]
grads:  [0.15049189]
Stock Position:  0.1504918935154676
Bond Position:  [4.6974902]


portfolio before change:  [19.94493677]
curr_Stock_Price:  101.31544375727518
curr_Factors:  [101.31544376]
mat_Sqrt:  [[0.15]]
grads:  [0.02459424]
Stock Position:  0.024594238560403128
Bond Position:  [17.45316058]


portfolio before change:  [19.96273354]
curr_Stock_Price:  101.99470483329847
curr_Factors:  [101.99470483]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599617]
Stock Position:  -0.04599617003276347
Bond Position:  [24.65409933]


portfolio before change:  [19.95240966]
curr_Stock_Price:  102.25265691124308
curr_Factors:  [102.25265691]
mat_Sqrt:  [[0.15]]
grads:  [0.17318253]
Stock Position:  0.17318252812870805
Bond Position:  [2.24403603]


portfolio before change:  [20.02306455]
curr_Stock_Price:  102.65982634291107
curr_Factors:  [102.65982634]
mat_Sqrt:  [[0.15]]
grads:  [0.07693693]
Stock Position:  0.07693693160280657
Bond Position:  [12.12473251]


portfolio before change:  [20.01941585]
curr_Stock_Price:  102.60255190722654
curr_Factors:  [102.60255191]
mat_Sqrt:  [[0.15]]
grads:  [-0.05704145]
Stock Position:  -0.05704144826368238
Bond Position:  [25.87201401]


portfolio before change:  [20.01921533]
curr_Stock_Price:  102.63441596207296
curr_Factors:  [102.63441596]
mat_Sqrt:  [[0.15]]
grads:  [0.03884348]
Stock Position:  0.03884348261960802
Bond Position:  [16.03253718]


portfolio before change:  [19.97901578]
curr_Stock_Price:  101.57370733061853
curr_Factors:  [101.57370733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0370359]
Stock Position:  -0.037035901311379814
Bond Position:  [23.74088958]


portfolio before change:  [19.9808065]
curr_Stock_Price:  101.56542151667642
curr_Factors:  [101.56542152]
mat_Sqrt:  [[0.15]]
grads:  [0.08908932]
Stock Position:  0.0890893172168105
Bond Position:  [10.93241245]


portfolio before change:  [19.91927876]
curr_Stock_Price:  100.86712188739585
curr_Factors:  [100.86712189]
mat_Sqrt:  [[0.15]]
grads:  [-0.03775982]
Stock Position:  -0.037759816272922714
Bond Position:  [23.72800275]


portfolio before change:  [19.91657086]
curr_Stock_Price:  100.97811157480348
curr_Factors:  [100.97811157]
mat_Sqrt:  [[0.15]]
grads:  [0.04675205]
Stock Position:  0.046752048441497725
Bond Position:  [15.19563729]


portfolio before change:  [19.97661212]
curr_Stock_Price:  102.24204563633837
curr_Factors:  [102.24204564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04200637]
Stock Position:  -0.04200637072193064
Bond Position:  [24.27142939]


portfolio before change:  [19.97398036]
curr_Stock_Price:  102.34081098974015
curr_Factors:  [102.34081099]
mat_Sqrt:  [[0.15]]
grads:  [0.02348874]
Stock Position:  0.02348873566154745
Bond Position:  [17.5701241]


portfolio before change:  [19.98226638]
curr_Stock_Price:  102.64682398663243
curr_Factors:  [102.64682399]
mat_Sqrt:  [[0.15]]
grads:  [0.05241325]
Stock Position:  0.05241324626832765
Bond Position:  [14.60221312]


portfolio before change:  [19.97995873]
curr_Stock_Price:  102.58538298280605
curr_Factors:  [102.58538298]
mat_Sqrt:  [[0.15]]
grads:  [-0.03552119]
Stock Position:  -0.03552118538490928
Bond Position:  [23.62391314]


portfolio before change:  [19.9868473]
curr_Stock_Price:  102.43302241136782
curr_Factors:  [102.43302241]
mat_Sqrt:  [[0.15]]
grads:  [0.07031344]
Stock Position:  0.0703134368330548
Bond Position:  [12.78442945]


portfolio before change:  [19.93453321]
curr_Stock_Price:  101.67764557623748
curr_Factors:  [101.67764558]
mat_Sqrt:  [[0.15]]
grads:  [0.15029182]
Stock Position:  0.15029181837349231
Bond Position:  [4.65321497]


portfolio before change:  [20.02532379]
curr_Stock_Price:  102.27980576839207
curr_Factors:  [102.27980577]
mat_Sqrt:  [[0.15]]
grads:  [-0.00166361]
Stock Position:  -0.0016636076602344313
Bond Position:  [20.19547726]


portfolio before change:  [20.02861147]
curr_Stock_Price:  101.06232085353993
curr_Factors:  [101.06232085]
mat_Sqrt:  [[0.15]]
grads:  [0.0583269]
Stock Position:  0.058326901782332345
Bond Position:  [14.1339594]


portfolio before change:  [20.04091246]
curr_Stock_Price:  101.25807264293951
curr_Factors:  [101.25807264]
mat_Sqrt:  [[0.15]]
grads:  [-0.07785156]
Stock Position:  -0.07785155549128285
Bond Position:  [27.92401092]


portfolio before change:  [20.06464259]
curr_Stock_Price:  100.9756785226964
curr_Factors:  [100.97567852]
mat_Sqrt:  [[0.15]]
grads:  [0.05954065]
Stock Position:  0.05954064788625257
Bond Position:  [14.05248527]


portfolio before change:  [20.07710017]
curr_Stock_Price:  101.17015536264883
curr_Factors:  [101.17015536]
mat_Sqrt:  [[0.15]]
grads:  [0.05114388]
Stock Position:  0.05114387614147495
Bond Position:  [14.90286628]


portfolio before change:  [20.09372937]
curr_Stock_Price:  101.47708821004
curr_Factors:  [101.47708821]
mat_Sqrt:  [[0.15]]
grads:  [0.07506404]
Stock Position:  0.07506403901193985
Bond Position:  [12.47644926]


portfolio before change:  [20.1036204]
curr_Stock_Price:  101.59846760356972
curr_Factors:  [101.5984676]
mat_Sqrt:  [[0.15]]
grads:  [0.05710267]
Stock Position:  0.05710266980452091
Bond Position:  [14.30207665]


portfolio before change:  [20.07969472]
curr_Stock_Price:  101.16381922924529
curr_Factors:  [101.16381923]
mat_Sqrt:  [[0.15]]
grads:  [-0.22665595]
Stock Position:  -0.22665594783061238
Bond Position:  [43.00907606]


portfolio before change:  [20.1157713]
curr_Stock_Price:  101.01651039384637
curr_Factors:  [101.01651039]
mat_Sqrt:  [[0.15]]
grads:  [0.064698]
Stock Position:  0.06469800124091751
Bond Position:  [13.58020498]


portfolio before change:  [20.13068787]
curr_Stock_Price:  101.23394811887705
curr_Factors:  [101.23394812]
mat_Sqrt:  [[0.15]]
grads:  [0.01034662]
Stock Position:  0.010346616669195235
Bond Position:  [19.08325902]


portfolio before change:  [20.1295343]
curr_Stock_Price:  101.00717687842725
curr_Factors:  [101.00717688]
mat_Sqrt:  [[0.15]]
grads:  [0.10496115]
Stock Position:  0.10496115412806081
Bond Position:  [9.52770444]


portfolio before change:  [20.03498]
curr_Stock_Price:  100.10065293152243
curr_Factors:  [100.10065293]
mat_Sqrt:  [[0.15]]
grads:  [-0.04337899]
Stock Position:  -0.04337899409437316
Bond Position:  [24.37724563]


portfolio before change:  [19.99727911]
curr_Stock_Price:  101.00488130896328
curr_Factors:  [101.00488131]
mat_Sqrt:  [[0.15]]
grads:  [-0.10945739]
Stock Position:  -0.10945739289379144
Bond Position:  [31.05301009]


portfolio before change:  [19.99117017]
curr_Stock_Price:  101.0784242010547
curr_Factors:  [101.0784242]
mat_Sqrt:  [[0.15]]
grads:  [0.15136826]
Stock Position:  0.15136826221307517
Bond Position:  [4.69110475]


portfolio before change:  [20.04897057]
curr_Stock_Price:  101.45834004524892
curr_Factors:  [101.45834005]
mat_Sqrt:  [[0.15]]
grads:  [0.01181499]
Stock Position:  0.011814994452334693
Bond Position:  [18.85024085]


portfolio before change:  [20.04639787]
curr_Stock_Price:  101.14087194365565
curr_Factors:  [101.14087194]
mat_Sqrt:  [[0.15]]
grads:  [-0.0462398]
Stock Position:  -0.04623979834694068
Bond Position:  [24.72313139]


portfolio before change:  [20.04670296]
curr_Stock_Price:  101.16769197100197
curr_Factors:  [101.16769197]
mat_Sqrt:  [[0.15]]
grads:  [-0.00361069]
Stock Position:  -0.0036106859181256334
Bond Position:  [20.41198772]


portfolio before change:  [20.0461192]
curr_Stock_Price:  101.68270442507152
curr_Factors:  [101.68270443]
mat_Sqrt:  [[0.15]]
grads:  [0.08153581]
Stock Position:  0.08153580841862461
Bond Position:  [11.75533769]


portfolio before change:  [20.02455402]
curr_Stock_Price:  101.40920603080346
curr_Factors:  [101.40920603]
mat_Sqrt:  [[0.15]]
grads:  [-0.03094246]
Stock Position:  -0.030942463950132667
Bond Position:  [23.16240472]


portfolio before change:  [20.02443844]
curr_Stock_Price:  101.45972790476951
curr_Factors:  [101.4597279]
mat_Sqrt:  [[0.15]]
grads:  [-0.05233341]
Stock Position:  -0.05233341143535672
Bond Position:  [25.33417213]


portfolio before change:  [19.97151386]
curr_Stock_Price:  102.50128086186068
curr_Factors:  [102.50128086]
mat_Sqrt:  [[0.15]]
grads:  [-0.04955695]
Stock Position:  -0.049556949002142206
Bond Position:  [25.0511646]


portfolio before change:  [19.96333877]
curr_Stock_Price:  102.69783926704022
curr_Factors:  [102.69783927]
mat_Sqrt:  [[0.15]]
grads:  [-0.24873756]
Stock Position:  -0.24873756156966187
Bond Position:  [45.50814889]


portfolio before change:  [20.02626597]
curr_Stock_Price:  102.45628809122871
curr_Factors:  [102.45628809]
mat_Sqrt:  [[0.15]]
grads:  [0.01385412]
Stock Position:  0.013854121853011207
Bond Position:  [18.60682407]


portfolio before change:  [20.01704276]
curr_Stock_Price:  101.70660747901846
curr_Factors:  [101.70660748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0295138]
Stock Position:  -0.029513803751827286
Bond Position:  [23.01879162]


portfolio before change:  [20.02164194]
curr_Stock_Price:  101.59952346948909
curr_Factors:  [101.59952347]
mat_Sqrt:  [[0.15]]
grads:  [0.03605278]
Stock Position:  0.03605278098250895
Bond Position:  [16.35869657]


portfolio before change:  [20.05200854]
curr_Stock_Price:  102.41344533199025
curr_Factors:  [102.41344533]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514658]
Stock Position:  -0.015146577082922998
Bond Position:  [21.60322168]


portfolio before change:  [20.06006758]
curr_Stock_Price:  101.97052041245371
curr_Factors:  [101.97052041]
mat_Sqrt:  [[0.15]]
grads:  [-3.83038801e-06]
Stock Position:  -3.8303880083486365e-06
Bond Position:  [20.06045816]


portfolio before change:  [20.061324]
curr_Stock_Price:  101.28951070478315
curr_Factors:  [101.2895107]
mat_Sqrt:  [[0.15]]
grads:  [0.04044969]
Stock Position:  0.0404496905284167
Bond Position:  [15.96419464]


portfolio before change:  [20.09217384]
curr_Stock_Price:  102.02751494595417
curr_Factors:  [102.02751495]
mat_Sqrt:  [[0.15]]
grads:  [-0.0047083]
Stock Position:  -0.004708303344887862
Bond Position:  [20.57255033]


portfolio before change:  [20.09327208]
curr_Stock_Price:  102.06735517834083
curr_Factors:  [102.06735518]
mat_Sqrt:  [[0.15]]
grads:  [0.01092416]
Stock Position:  0.010924164404359695
Bond Position:  [18.97827152]


portfolio before change:  [20.08929783]
curr_Stock_Price:  101.59496812136528
curr_Factors:  [101.59496812]
mat_Sqrt:  [[0.15]]
grads:  [0.09724107]
Stock Position:  0.097241065057489
Bond Position:  [10.21009492]


portfolio before change:  [20.00362265]
curr_Stock_Price:  100.7073458622061
curr_Factors:  [100.70734586]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [19.39880794]


portfolio before change:  [20.00845955]
curr_Stock_Price:  101.31084858820466
curr_Factors:  [101.31084859]
mat_Sqrt:  [[0.15]]
grads:  [-0.04424578]
Stock Position:  -0.04424577818272072
Bond Position:  [24.49103688]


portfolio before change:  [19.94950101]
curr_Stock_Price:  102.67796821555875
curr_Factors:  [102.67796822]
mat_Sqrt:  [[0.15]]
grads:  [0.00154343]
Stock Position:  0.0015434274975301837
Bond Position:  [19.79102501]


portfolio before change:  [19.95141376]
curr_Stock_Price:  103.11580396540413
curr_Factors:  [103.11580397]
mat_Sqrt:  [[0.15]]
grads:  [-0.08327036]
Stock Position:  -0.0832703553364603
Bond Position:  [28.53790339]


portfolio before change:  [20.00365384]
curr_Stock_Price:  102.50986910292126
curr_Factors:  [102.5098691]
mat_Sqrt:  [[0.15]]
grads:  [0.0094487]
Stock Position:  0.009448704451006859
Bond Position:  [19.03506839]


portfolio before change:  [19.99843819]
curr_Stock_Price:  101.83195801116108
curr_Factors:  [101.83195801]
mat_Sqrt:  [[0.15]]
grads:  [0.00072635]
Stock Position:  0.0007263473660353478
Bond Position:  [19.92447282]


portfolio before change:  [20.00014755]
curr_Stock_Price:  102.4708288332106
curr_Factors:  [102.47082883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624458]
Stock Position:  -0.0362445755244308
Bond Position:  [23.71415925]


portfolio before change:  [20.00213543]
curr_Stock_Price:  102.45687644812081
curr_Factors:  [102.45687645]
mat_Sqrt:  [[0.15]]
grads:  [0.10035196]
Stock Position:  0.10035196266548452
Bond Position:  [9.72038679]


portfolio before change:  [19.99035096]
curr_Stock_Price:  102.33339090703971
curr_Factors:  [102.33339091]
mat_Sqrt:  [[0.15]]
grads:  [-0.05518762]
Stock Position:  -0.05518761560653206
Bond Position:  [25.6378868]


portfolio before change:  [19.98009427]
curr_Stock_Price:  102.54827799183538
curr_Factors:  [102.54827799]
mat_Sqrt:  [[0.15]]
grads:  [0.07281769]
Stock Position:  0.07281769305557932
Bond Position:  [12.51276524]


portfolio before change:  [20.01908881]
curr_Stock_Price:  103.07304697377903
curr_Factors:  [103.07304697]
mat_Sqrt:  [[0.15]]
grads:  [-0.08420358]
Stock Position:  -0.08420357827573302
Bond Position:  [28.69820819]


portfolio before change:  [19.97866899]
curr_Stock_Price:  103.5743738272217
curr_Factors:  [103.57437383]
mat_Sqrt:  [[0.15]]
grads:  [0.0866148]
Stock Position:  0.08661480448532148
Bond Position:  [11.00759485]


portfolio before change:  [20.01645187]
curr_Stock_Price:  104.00264807177786
curr_Factors:  [104.00264807]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137666]
Stock Position:  -0.013766604441380413
Bond Position:  [21.44821519]


portfolio before change:  [20.02834723]
curr_Stock_Price:  103.23595185053377
curr_Factors:  [103.23595185]
mat_Sqrt:  [[0.15]]
grads:  [0.15234313]
Stock Position:  0.15234312548203638
Bond Position:  [4.30105967]


portfolio before change:  [19.92061404]
curr_Stock_Price:  102.52701260902795
curr_Factors:  [102.52701261]
mat_Sqrt:  [[0.15]]
grads:  [-0.14989192]
Stock Position:  -0.14989191738558266
Bond Position:  [35.28858454]


portfolio before change:  [19.86441864]
curr_Stock_Price:  102.91663334796398
curr_Factors:  [102.91663335]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669317]
Stock Position:  -0.006693168905523454
Bond Position:  [20.55325705]


portfolio before change:  [19.86132254]
curr_Stock_Price:  103.57113947134091
curr_Factors:  [103.57113947]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388775]
Stock Position:  -0.04388774982188439
Bond Position:  [24.4068268]


portfolio before change:  [19.86774196]
curr_Stock_Price:  103.45962890290663
curr_Factors:  [103.4596289]
mat_Sqrt:  [[0.15]]
grads:  [-0.04156224]
Stock Position:  -0.04156223957531401
Bond Position:  [24.16775585]


portfolio before change:  [19.91458475]
curr_Stock_Price:  102.3689212256393
curr_Factors:  [102.36892123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.91458475]
Stock Price:  102.21751481168411
PL:  [17.69706994]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.41379190e-03]
 [ 3.04986955e-03]
 [ 5.54383459e-04]
 [ 6.97268654e-03]
 [ 3.38589386e-03]
 [ 2.70616919e-02]
 [ 1.10531585e-03]
 [ 1.06841018e-02]
 [ 2.46289927e-02]
 [-4.82621722e-03]
 [ 4.22855327e-02]
 [ 3.05113639e-02]
 [ 1.36903903e-01]
 [ 2.13368283e-02]
 [-6.89292898e-03]
 [ 3.15577642e-02]
 [ 1.35026024e-02]
 [ 3.20043400e-03]
 [ 1.40432591e-02]
 [-9.23933308e-03]
 [ 1.50190256e-02]
 [-1.80678428e-02]
 [ 1.02010210e-02]
 [-7.77497774e-02]
 [ 1.37519882e-02]
 [ 5.85792085e-03]
 [-4.01587101e-03]
 [ 1.60425979e-02]
 [ 4.71191733e-02]
 [ 4.60746365e-03]
 [ 1.75120563e-02]
 [-4.10239382e-03]
 [-1.33725908e-03]
 [ 8.52473833e-03]
 [ 1.03390371e-02]
 [ 6.38750598e-03]
 [-3.25310049e-02]
 [ 8.66496869e-03]
 [ 1.34296499e-02]
 [ 5.07252037e-03]
 [-4.08298174e-03]
 [-1.82380484e-02]
 [ 2.09732392e-02]
 [-2.03399382e-03]
 [ 1.16310453e-02]
 [-1.44365318e-02]
 [ 1.52600963e-02]
 [ 1.19823415e-02]
 [ 7.92748463e-03]
 [-7.65855338e-03]
 [ 4.43102680e-02]
 [ 8.45475366e-03]
 [-1.00803797e-02]
 [ 5.82289379e-03]
 [-2.11891457e-02]
 [ 3.24915787e-02]
 [ 1.65817609e-02]
 [ 1.96876020e-03]
 [ 1.99984694e-03]
 [ 3.89382399e-03]
 [ 1.58553310e-02]
 [ 3.88502448e-02]
 [-1.24666051e-04]
 [-1.22788753e-02]
 [ 1.55393586e-02]
 [ 7.32031382e-03]
 [-5.17329345e-03]
 [ 1.54116819e-02]
 [-1.02635942e-02]
 [-2.45716465e-02]
 [-8.80354051e-03]
 [ 1.55021754e-02]
 [-2.50342199e-02]
 [ 2.84885055e-02]
 [-2.86742687e-02]
 [ 4.65475446e-03]
 [ 7.36847777e-03]
 [-1.62831017e-02]
 [ 2.13135959e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.15553278]
curr_Stock_Price:  99.66205816646062
curr_Factors:  [99.66205817]
mat_Sqrt:  [[0.15]]
grads:  [0.02275861]
Stock Position:  0.022758612641230403
Bond Position:  [-5.42370295]


portfolio before change:  [-3.14411864]
curr_Stock_Price:  100.17848377476433
curr_Factors:  [100.17848377]
mat_Sqrt:  [[0.15]]
grads:  [0.02033246]
Stock Position:  0.020332463655423762
Bond Position:  [-5.18099402]


portfolio before change:  [-3.14830977]
curr_Stock_Price:  99.98828012470801
curr_Factors:  [99.98828012]
mat_Sqrt:  [[0.15]]
grads:  [0.00369589]
Stock Position:  0.0036958897238203946
Bond Position:  [-3.51785543]


portfolio before change:  [-3.14718252]
curr_Stock_Price:  100.35277353418404
curr_Factors:  [100.35277353]
mat_Sqrt:  [[0.15]]
grads:  [0.04648458]
Stock Position:  0.04648457694887385
Bond Position:  [-7.81203874]


portfolio before change:  [-3.14535814]
curr_Stock_Price:  100.40252433568885
curr_Factors:  [100.40252434]
mat_Sqrt:  [[0.15]]
grads:  [0.02257263]
Stock Position:  0.022572625701522842
Bond Position:  [-5.41170674]


portfolio before change:  [-3.1446789]
curr_Stock_Price:  100.4476001623055
curr_Factors:  [100.44760016]
mat_Sqrt:  [[0.15]]
grads:  [0.18041128]
Stock Position:  0.18041127922181105
Bond Position:  [-21.26655894]


portfolio before change:  [-3.05708455]
curr_Stock_Price:  100.94049370944272
curr_Factors:  [100.94049371]
mat_Sqrt:  [[0.15]]
grads:  [0.00736877]
Stock Position:  0.007368772320147166
Bond Position:  [-3.80089206]


portfolio before change:  [-3.04993763]
curr_Stock_Price:  101.94262552956239
curr_Factors:  [101.94262553]
mat_Sqrt:  [[0.15]]
grads:  [0.07122735]
Stock Position:  0.07122734551893294
Bond Position:  [-10.31104024]


portfolio before change:  [-3.04505286]
curr_Stock_Price:  102.02025339855494
curr_Factors:  [102.0202534]
mat_Sqrt:  [[0.15]]
grads:  [0.16419328]
Stock Position:  0.16419328457726656
Bond Position:  [-19.79609336]


portfolio before change:  [-3.02565987]
curr_Stock_Price:  102.14589974906488
curr_Factors:  [102.14589975]
mat_Sqrt:  [[0.15]]
grads:  [-0.03217478]
Stock Position:  -0.03217478144032584
Bond Position:  [0.26086213]


portfolio before change:  [-3.04136469]
curr_Stock_Price:  102.63451619164643
curr_Factors:  [102.63451619]
mat_Sqrt:  [[0.15]]
grads:  [0.28190355]
Stock Position:  0.2819035512620052
Bond Position:  [-31.97439929]


portfolio before change:  [-2.96088914]
curr_Stock_Price:  102.9270773130592
curr_Factors:  [102.92707731]
mat_Sqrt:  [[0.15]]
grads:  [0.20340909]
Stock Position:  0.2034090929428471
Bond Position:  [-23.89719257]


portfolio before change:  [-2.77187381]
curr_Stock_Price:  103.8636576224551
curr_Factors:  [103.86365762]
mat_Sqrt:  [[0.15]]
grads:  [0.91269269]
Stock Position:  0.9126926870868461
Bond Position:  [-97.56747457]


portfolio before change:  [-2.47325152]
curr_Stock_Price:  104.1975273315336
curr_Factors:  [104.19752733]
mat_Sqrt:  [[0.15]]
grads:  [0.14224552]
Stock Position:  0.1422455218933719
Bond Position:  [-17.29488318]


portfolio before change:  [-2.5798216]
curr_Stock_Price:  103.45592851275734
curr_Factors:  [103.45592851]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595286]
Stock Position:  -0.045952859879630104
Bond Position:  [2.17427419]


portfolio before change:  [-2.58500694]
curr_Stock_Price:  103.57172640298454
curr_Factors:  [103.5717264]
mat_Sqrt:  [[0.15]]
grads:  [0.21038509]
Stock Position:  0.21038509499765495
Bond Position:  [-24.37495444]


portfolio before change:  [-2.60151145]
curr_Stock_Price:  103.50051876429107
curr_Factors:  [103.50051876]
mat_Sqrt:  [[0.15]]
grads:  [0.09001735]
Stock Position:  0.09001734930984244
Bond Position:  [-11.9183538]


portfolio before change:  [-2.53735717]
curr_Stock_Price:  104.22148198804877
curr_Factors:  [104.22148199]
mat_Sqrt:  [[0.15]]
grads:  [0.02133623]
Stock Position:  0.02133622664526557
Bond Position:  [-4.76105034]


portfolio before change:  [-2.53497318]
curr_Stock_Price:  104.3471637001492
curr_Factors:  [104.3471637]
mat_Sqrt:  [[0.15]]
grads:  [0.09362173]
Stock Position:  0.09362172743281334
Bond Position:  [-12.30413489]


portfolio before change:  [-2.54924782]
curr_Stock_Price:  104.20290647469808
curr_Factors:  [104.20290647]
mat_Sqrt:  [[0.15]]
grads:  [-0.06159555]
Stock Position:  -0.06159555386516728
Bond Position:  [3.86918792]


portfolio before change:  [-2.55527998]
curr_Stock_Price:  104.30476439500147
curr_Factors:  [104.3047644]
mat_Sqrt:  [[0.15]]
grads:  [0.10012684]
Stock Position:  0.10012683746206288
Bond Position:  [-12.99898617]


portfolio before change:  [-2.48700125]
curr_Stock_Price:  104.99480109436115
curr_Factors:  [104.99480109]
mat_Sqrt:  [[0.15]]
grads:  [-0.12045229]
Stock Position:  -0.12045228511251135
Bond Position:  [10.15986246]


portfolio before change:  [-2.48765685]
curr_Stock_Price:  105.00551577048049
curr_Factors:  [105.00551577]
mat_Sqrt:  [[0.15]]
grads:  [0.06800681]
Stock Position:  0.06800680676485296
Bond Position:  [-9.62874667]


portfolio before change:  [-2.48688207]
curr_Stock_Price:  105.02575774728483
curr_Factors:  [105.02575775]
mat_Sqrt:  [[0.15]]
grads:  [-0.51833185]
Stock Position:  -0.5183318495675968
Bond Position:  [51.95131319]


portfolio before change:  [-2.82610774]
curr_Stock_Price:  105.68647872428826
curr_Factors:  [105.68647872]
mat_Sqrt:  [[0.15]]
grads:  [0.09167992]
Stock Position:  0.09167992122718945
Bond Position:  [-12.51543578]


portfolio before change:  [-2.87566431]
curr_Stock_Price:  105.15447197761861
curr_Factors:  [105.15447198]
mat_Sqrt:  [[0.15]]
grads:  [0.03905281]
Stock Position:  0.03905280568637266
Bond Position:  [-6.98224148]


portfolio before change:  [-2.88448513]
curr_Stock_Price:  104.93977783114768
curr_Factors:  [104.93977783]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677247]
Stock Position:  -0.02677247337270098
Bond Position:  [-0.07498772]


portfolio before change:  [-2.85865579]
curr_Stock_Price:  103.97483065065045
curr_Factors:  [103.97483065]
mat_Sqrt:  [[0.15]]
grads:  [0.10695065]
Stock Position:  0.10695065244711144
Bond Position:  [-13.97883177]


portfolio before change:  [-2.92049142]
curr_Stock_Price:  103.40483020111922
curr_Factors:  [103.4048302]
mat_Sqrt:  [[0.15]]
grads:  [0.31412782]
Stock Position:  0.3141278219365344
Bond Position:  [-35.4028255]


portfolio before change:  [-2.83870039]
curr_Stock_Price:  103.67224928330273
curr_Factors:  [103.67224928]
mat_Sqrt:  [[0.15]]
grads:  [0.03071642]
Stock Position:  0.030716424318569097
Bond Position:  [-6.02314119]


portfolio before change:  [-2.8506334]
curr_Stock_Price:  103.29601546657236
curr_Factors:  [103.29601547]
mat_Sqrt:  [[0.15]]
grads:  [0.11674704]
Stock Position:  0.11674704179771216
Bond Position:  [-14.91013764]


portfolio before change:  [-2.841037]
curr_Stock_Price:  103.38619606392473
curr_Factors:  [103.38619606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02734929]
Stock Position:  -0.02734929210165761
Bond Position:  [-0.01349772]


portfolio before change:  [-2.85320294]
curr_Stock_Price:  103.83100091053623
curr_Factors:  [103.83100091]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891506]
Stock Position:  -0.008915060553709043
Bond Position:  [-1.92754328]


portfolio before change:  [-2.85092394]
curr_Stock_Price:  103.56185219726181
curr_Factors:  [103.5618522]
mat_Sqrt:  [[0.15]]
grads:  [0.05683159]
Stock Position:  0.05683158887872332
Bond Position:  [-8.73650854]


portfolio before change:  [-2.84752644]
curr_Stock_Price:  103.6312422355056
curr_Factors:  [103.63124224]
mat_Sqrt:  [[0.15]]
grads:  [0.06892691]
Stock Position:  0.06892691377598323
Bond Position:  [-9.99050814]


portfolio before change:  [-2.79659619]
curr_Stock_Price:  104.37920369147099
curr_Factors:  [104.37920369]
mat_Sqrt:  [[0.15]]
grads:  [0.04258337]
Stock Position:  0.04258337317046384
Bond Position:  [-7.24141477]


portfolio before change:  [-2.81155372]
curr_Stock_Price:  104.0385795784463
curr_Factors:  [104.03857958]
mat_Sqrt:  [[0.15]]
grads:  [-0.21687337]
Stock Position:  -0.21687336588053036
Bond Position:  [19.75164322]


portfolio before change:  [-3.00581959]
curr_Stock_Price:  104.94002908257085
curr_Factors:  [104.94002908]
mat_Sqrt:  [[0.15]]
grads:  [0.05776646]
Stock Position:  0.057766457926415375
Bond Position:  [-9.06783336]


portfolio before change:  [-3.04323096]
curr_Stock_Price:  104.30220887526568
curr_Factors:  [104.30220888]
mat_Sqrt:  [[0.15]]
grads:  [0.089531]
Stock Position:  0.08953099943207371
Bond Position:  [-12.38151196]


portfolio before change:  [-3.05449178]
curr_Stock_Price:  104.18507683503017
curr_Factors:  [104.18507684]
mat_Sqrt:  [[0.15]]
grads:  [0.0338168]
Stock Position:  0.03381680249501839
Bond Position:  [-6.57769794]


portfolio before change:  [-3.08258527]
curr_Stock_Price:  103.36647864902906
curr_Factors:  [103.36647865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02721988]
Stock Position:  -0.027219878265128807
Bond Position:  [-0.26896231]


portfolio before change:  [-3.08542903]
curr_Stock_Price:  103.47033475144194
curr_Factors:  [103.47033475]
mat_Sqrt:  [[0.15]]
grads:  [-0.12158699]
Stock Position:  -0.12158698965898605
Bond Position:  [9.49521749]


portfolio before change:  [-2.99118217]
curr_Stock_Price:  102.70007639988872
curr_Factors:  [102.7000764]
mat_Sqrt:  [[0.15]]
grads:  [0.13982159]
Stock Position:  0.139821594461921
Bond Position:  [-17.3508706]


portfolio before change:  [-2.8662699]
curr_Stock_Price:  103.6012013495906
curr_Factors:  [103.60120135]
mat_Sqrt:  [[0.15]]
grads:  [-0.01355996]
Stock Position:  -0.013559958804335685
Bond Position:  [-1.46144188]


portfolio before change:  [-2.88185501]
curr_Stock_Price:  104.7438126158222
curr_Factors:  [104.74381262]
mat_Sqrt:  [[0.15]]
grads:  [0.0775403]
Stock Position:  0.07754030182987899
Bond Position:  [-11.00372185]


portfolio before change:  [-2.85856436]
curr_Stock_Price:  105.0530505934134
curr_Factors:  [105.05305059]
mat_Sqrt:  [[0.15]]
grads:  [-0.09624355]
Stock Position:  -0.09624354564038719
Bond Position:  [7.25211371]


portfolio before change:  [-2.81316922]
curr_Stock_Price:  104.58609076782751
curr_Factors:  [104.58609077]
mat_Sqrt:  [[0.15]]
grads:  [0.10173398]
Stock Position:  0.10173397518172717
Bond Position:  [-13.45312798]


portfolio before change:  [-2.8492327]
curr_Stock_Price:  104.23986784108195
curr_Factors:  [104.23986784]
mat_Sqrt:  [[0.15]]
grads:  [0.07988228]
Stock Position:  0.07988227673789129
Bond Position:  [-11.17615067]


portfolio before change:  [-2.75893635]
curr_Stock_Price:  105.37898011013509
curr_Factors:  [105.37898011]
mat_Sqrt:  [[0.15]]
grads:  [0.0528499]
Stock Position:  0.052849897536773445
Bond Position:  [-8.32820465]


portfolio before change:  [-2.7249462]
curr_Stock_Price:  106.03197430363265
curr_Factors:  [106.0319743]
mat_Sqrt:  [[0.15]]
grads:  [-0.05105702]
Stock Position:  -0.05105702250503926
Bond Position:  [2.6887307]


portfolio before change:  [-2.77304451]
curr_Stock_Price:  106.97731662150225
curr_Factors:  [106.97731662]
mat_Sqrt:  [[0.15]]
grads:  [0.29540179]
Stock Position:  0.2954017863516566
Bond Position:  [-34.37433494]


portfolio before change:  [-2.84556308]
curr_Stock_Price:  106.7390983423279
curr_Factors:  [106.73909834]
mat_Sqrt:  [[0.15]]
grads:  [0.05636502]
Stock Position:  0.05636502437930686
Bond Position:  [-8.86191496]


portfolio before change:  [-2.90334323]
curr_Stock_Price:  105.72381876762994
curr_Factors:  [105.72381877]
mat_Sqrt:  [[0.15]]
grads:  [-0.06720253]
Stock Position:  -0.06720253137687096
Bond Position:  [4.20156502]


portfolio before change:  [-2.93437225]
curr_Stock_Price:  106.18945046417878
curr_Factors:  [106.18945046]
mat_Sqrt:  [[0.15]]
grads:  [0.03881929]
Stock Position:  0.038819291948451226
Bond Position:  [-7.05657153]


portfolio before change:  [-2.90942862]
curr_Stock_Price:  106.84336974552289
curr_Factors:  [106.84336975]
mat_Sqrt:  [[0.15]]
grads:  [-0.14126097]
Stock Position:  -0.14126097113330338
Bond Position:  [12.18336955]


portfolio before change:  [-2.93652247]
curr_Stock_Price:  107.04056036426665
curr_Factors:  [107.04056036]
mat_Sqrt:  [[0.15]]
grads:  [0.21661052]
Stock Position:  0.21661052476804907
Bond Position:  [-26.12263442]


portfolio before change:  [-2.94776283]
curr_Stock_Price:  106.99620587582469
curr_Factors:  [106.99620588]
mat_Sqrt:  [[0.15]]
grads:  [0.11054507]
Stock Position:  0.11054507284086924
Bond Position:  [-14.77566621]


portfolio before change:  [-2.95501473]
curr_Stock_Price:  106.93895873593155
curr_Factors:  [106.93895874]
mat_Sqrt:  [[0.15]]
grads:  [0.01312507]
Stock Position:  0.013125067978920671
Bond Position:  [-4.35859583]


portfolio before change:  [-2.95555349]
curr_Stock_Price:  106.9186666458661
curr_Factors:  [106.91866665]
mat_Sqrt:  [[0.15]]
grads:  [0.01333231]
Stock Position:  0.013332312906919634
Bond Position:  [-4.38102661]


portfolio before change:  [-2.96461847]
curr_Stock_Price:  106.25927880828684
curr_Factors:  [106.25927881]
mat_Sqrt:  [[0.15]]
grads:  [0.02595883]
Stock Position:  0.025958826588561523
Bond Position:  [-5.72298467]


portfolio before change:  [-2.97055156]
curr_Stock_Price:  106.04450064300187
curr_Factors:  [106.04450064]
mat_Sqrt:  [[0.15]]
grads:  [0.10570221]
Stock Position:  0.10570220682014422
Bond Position:  [-14.1796893]


portfolio before change:  [-2.98030661]
curr_Stock_Price:  105.960597109677
curr_Factors:  [105.96059711]
mat_Sqrt:  [[0.15]]
grads:  [0.25900163]
Stock Position:  0.25900163200044213
Bond Position:  [-30.42427419]


portfolio before change:  [-3.0849998]
curr_Stock_Price:  105.56372079739006
curr_Factors:  [105.5637208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083111]
Stock Position:  -0.00083110700878074
Bond Position:  [-2.99726505]


portfolio before change:  [-3.0854022]
curr_Stock_Price:  105.82249390005833
curr_Factors:  [105.8224939]
mat_Sqrt:  [[0.15]]
grads:  [-0.08185917]
Stock Position:  -0.08185916843586943
Bond Position:  [5.57713915]


portfolio before change:  [-3.08867586]
curr_Stock_Price:  105.866743575853
curr_Factors:  [105.86674358]
mat_Sqrt:  [[0.15]]
grads:  [0.10359572]
Stock Position:  0.10359572369541648
Bond Position:  [-14.05601778]


portfolio before change:  [-3.09431724]
curr_Stock_Price:  105.82076823174457
curr_Factors:  [105.82076823]
mat_Sqrt:  [[0.15]]
grads:  [0.04880209]
Stock Position:  0.048802092126748305
Bond Position:  [-8.25859212]


portfolio before change:  [-3.10795749]
curr_Stock_Price:  105.55184373869304
curr_Factors:  [105.55184374]
mat_Sqrt:  [[0.15]]
grads:  [-0.03448862]
Stock Position:  -0.03448862300141828
Bond Position:  [0.53238025]


portfolio before change:  [-3.09243198]
curr_Stock_Price:  105.10264514465462
curr_Factors:  [105.10264514]
mat_Sqrt:  [[0.15]]
grads:  [0.10274455]
Stock Position:  0.10274454627364288
Bond Position:  [-13.89115557]


portfolio before change:  [-3.08035881]
curr_Stock_Price:  105.22860209580108
curr_Factors:  [105.2286021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06842396]
Stock Position:  -0.0684239611946706
Bond Position:  [4.11979897]


portfolio before change:  [-3.14815462]
curr_Stock_Price:  106.22318503119595
curr_Factors:  [106.22318503]
mat_Sqrt:  [[0.15]]
grads:  [-0.16381098]
Stock Position:  -0.16381097642942138
Bond Position:  [14.25236904]


portfolio before change:  [-3.19656736]
curr_Stock_Price:  106.52416324576085
curr_Factors:  [106.52416325]
mat_Sqrt:  [[0.15]]
grads:  [-0.05869027]
Stock Position:  -0.05869027009578319
Bond Position:  [3.05536456]


portfolio before change:  [-3.21836311]
curr_Stock_Price:  106.89878617798118
curr_Factors:  [106.89878618]
mat_Sqrt:  [[0.15]]
grads:  [0.10334784]
Stock Position:  0.10334783626474954
Bond Position:  [-14.26612136]


portfolio before change:  [-3.20428789]
curr_Stock_Price:  107.04360663390545
curr_Factors:  [107.04360663]
mat_Sqrt:  [[0.15]]
grads:  [-0.1668948]
Stock Position:  -0.16689479936123905
Bond Position:  [14.66073336]


portfolio before change:  [-3.29862238]
curr_Stock_Price:  107.61433032610663
curr_Factors:  [107.61433033]
mat_Sqrt:  [[0.15]]
grads:  [0.18992337]
Stock Position:  0.18992337032346884
Bond Position:  [-23.73709869]


portfolio before change:  [-3.42279388]
curr_Stock_Price:  106.96834409049082
curr_Factors:  [106.96834409]
mat_Sqrt:  [[0.15]]
grads:  [-0.19116179]
Stock Position:  -0.1911617912595381
Bond Position:  [17.02546638]


portfolio before change:  [-3.39094234]
curr_Stock_Price:  106.80728988752108
curr_Factors:  [106.80728989]
mat_Sqrt:  [[0.15]]
grads:  [0.0310317]
Stock Position:  0.031031696429941205
Bond Position:  [-6.70535374]


portfolio before change:  [-3.37451391]
curr_Stock_Price:  107.35020355975814
curr_Factors:  [107.35020356]
mat_Sqrt:  [[0.15]]
grads:  [0.04912319]
Stock Position:  0.049123185123393726
Bond Position:  [-8.64789783]


portfolio before change:  [-3.3707161]
curr_Stock_Price:  107.43851874440463
curr_Factors:  [107.43851874]
mat_Sqrt:  [[0.15]]
grads:  [-0.10855401]
Stock Position:  -0.10855401145397978
Bond Position:  [8.2921661]


portfolio before change:  [-3.38243003]
curr_Stock_Price:  107.55120191513575
curr_Factors:  [107.55120192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.38243003]
Stock Price:  107.16609071685932
PL:  [-10.54852075]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.83281820e-04]
 [ 2.75802555e-03]
 [-5.77868076e-04]
 [ 7.97775833e-03]
 [ 4.91449172e-03]
 [ 2.15775096e-02]
 [ 1.43629691e-03]
 [-2.09208585e-02]
 [-7.08443362e-03]
 [ 2.39865152e-02]
 [-1.29768741e-02]
 [ 2.65122165e-02]
 [-1.42286828e-02]
 [ 9.19287389e-03]
 [-6.97232935e-03]
 [ 9.68277940e-03]
 [ 1.11862586e-02]
 [-8.20937074e-03]
 [ 1.79996764e-03]
 [ 8.67572736e-03]
 [ 1.27406558e-02]
 [-1.05339747e-02]
 [-8.89275748e-05]
 [-8.81908328e-02]
 [-1.24226745e-02]
 [-2.69133966e-03]
 [-1.67644380e-03]
 [ 9.63778235e-03]
 [-2.67399442e-02]
 [ 1.04933438e-03]
 [-3.27083212e-03]
 [-1.02119950e-02]
 [-5.89811979e-03]
 [ 4.72231582e-03]
 [ 1.28949632e-02]
 [ 1.73756183e-02]
 [-3.43071193e-02]
 [ 8.68444789e-03]
 [-2.88807974e-02]
 [ 1.78355855e-02]
 [-1.11973144e-02]
 [ 3.84152545e-02]
 [ 2.32277954e-02]
 [ 3.75329034e-03]
 [ 7.62286517e-03]
 [ 1.80009570e-02]
 [-1.35805511e-03]
 [-9.72319035e-03]
 [ 9.64458714e-03]
 [ 4.89945240e-03]
 [ 2.75574204e-02]
 [ 1.37979815e-02]
 [-1.00628480e-03]
 [ 4.24254037e-03]
 [ 4.55405991e-03]
 [ 7.54093005e-03]
 [-3.01724901e-02]
 [ 1.37872802e-03]
 [ 1.64051356e-03]
 [-1.29447379e-01]
 [-1.40452091e-02]
 [ 1.80012322e-02]
 [ 1.63647936e-02]
 [-1.92165348e-02]
 [-4.50510930e-03]
 [-1.89076008e-02]
 [-3.65870088e-03]
 [-2.57100333e-03]
 [-1.74015983e-02]
 [ 1.32451759e-02]
 [ 8.30304472e-03]
 [ 1.24235106e-02]
 [ 3.46506562e-03]
 [ 3.88525266e-03]
 [ 1.23993253e-02]
 [-1.69079323e-02]
 [ 5.21533742e-03]
 [ 5.43679397e-03]
 [-4.02805984e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.72965465]
curr_Stock_Price:  100.8250417435888
curr_Factors:  [100.82504174]
mat_Sqrt:  [[0.15]]
grads:  [-0.00188855]
Stock Position:  -0.0018885454635749934
Bond Position:  [14.92006732]


portfolio before change:  [14.7314975]
curr_Stock_Price:  100.34301955545216
curr_Factors:  [100.34301956]
mat_Sqrt:  [[0.15]]
grads:  [0.01838684]
Stock Position:  0.018386836983393495
Bond Position:  [12.88650676]


portfolio before change:  [14.71822528]
curr_Stock_Price:  99.57738180873932
curr_Factors:  [99.57738181]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385245]
Stock Position:  -0.0038524538412410747
Bond Position:  [15.10184254]


portfolio before change:  [14.72040553]
curr_Stock_Price:  99.25645326537571
curr_Factors:  [99.25645327]
mat_Sqrt:  [[0.15]]
grads:  [0.05318506]
Stock Position:  0.05318505552922466
Bond Position:  [9.44144556]


portfolio before change:  [14.748879]
curr_Stock_Price:  99.78072383854565
curr_Factors:  [99.78072384]
mat_Sqrt:  [[0.15]]
grads:  [0.03276328]
Stock Position:  0.03276327813922712
Bond Position:  [11.47973539]


portfolio before change:  [14.74304427]
curr_Stock_Price:  99.58073655335193
curr_Factors:  [99.58073655]
mat_Sqrt:  [[0.15]]
grads:  [0.14385006]
Stock Position:  0.14385006409356468
Bond Position:  [0.41834893]


portfolio before change:  [14.66454617]
curr_Stock_Price:  99.03486087418005
curr_Factors:  [99.03486087]
mat_Sqrt:  [[0.15]]
grads:  [0.00957531]
Stock Position:  0.009575312753173092
Bond Position:  [13.7162564]


portfolio before change:  [14.66157971]
curr_Stock_Price:  98.63552689397659
curr_Factors:  [98.63552689]
mat_Sqrt:  [[0.15]]
grads:  [-0.13947239]
Stock Position:  -0.13947238984907057
Bond Position:  [28.41851237]


portfolio before change:  [14.71186039]
curr_Stock_Price:  98.2877558027035
curr_Factors:  [98.2877558]
mat_Sqrt:  [[0.15]]
grads:  [-0.04722956]
Stock Position:  -0.04722955749799508
Bond Position:  [19.3539476]


portfolio before change:  [14.70393278]
curr_Stock_Price:  98.48122091140836
curr_Factors:  [98.48122091]
mat_Sqrt:  [[0.15]]
grads:  [0.1599101]
Stock Position:  0.1599101010446824
Bond Position:  [-1.04420921]


portfolio before change:  [14.67627483]
curr_Stock_Price:  98.3086697003385
curr_Factors:  [98.3086697]
mat_Sqrt:  [[0.15]]
grads:  [-0.08651249]
Stock Position:  -0.08651249414508837
Bond Position:  [23.18120304]


portfolio before change:  [14.69979443]
curr_Stock_Price:  98.05355362824879
curr_Factors:  [98.05355363]
mat_Sqrt:  [[0.15]]
grads:  [0.17674811]
Stock Position:  0.17674811006956384
Bond Position:  [-2.63098586]


portfolio before change:  [14.80847211]
curr_Stock_Price:  98.66935721782498
curr_Factors:  [98.66935722]
mat_Sqrt:  [[0.15]]
grads:  [-0.09485789]
Stock Position:  -0.09485788503062413
Bond Position:  [24.16803865]


portfolio before change:  [14.77754072]
curr_Stock_Price:  99.0113628587981
curr_Factors:  [99.01136286]
mat_Sqrt:  [[0.15]]
grads:  [0.06128583]
Stock Position:  0.06128582594326678
Bond Position:  [8.70954757]


portfolio before change:  [14.74943513]
curr_Stock_Price:  98.54388183095469
curr_Factors:  [98.54388183]
mat_Sqrt:  [[0.15]]
grads:  [-0.0464822]
Stock Position:  -0.046482195658933786
Bond Position:  [19.32997112]


portfolio before change:  [14.78531121]
curr_Stock_Price:  97.79804948061674
curr_Factors:  [97.79804948]
mat_Sqrt:  [[0.15]]
grads:  [0.06455186]
Stock Position:  0.06455186265994552
Bond Position:  [8.47226496]


portfolio before change:  [14.76847589]
curr_Stock_Price:  97.52904320047043
curr_Factors:  [97.5290432]
mat_Sqrt:  [[0.15]]
grads:  [0.07457506]
Stock Position:  0.07457505759497945
Bond Position:  [7.49524188]


portfolio before change:  [14.80921614]
curr_Stock_Price:  98.06905998436218
curr_Factors:  [98.06905998]
mat_Sqrt:  [[0.15]]
grads:  [-0.05472914]
Stock Position:  -0.054729138272796
Bond Position:  [20.17645128]


portfolio before change:  [14.86408586]
curr_Stock_Price:  97.0895332777788
curr_Factors:  [97.08953328]
mat_Sqrt:  [[0.15]]
grads:  [0.01199978]
Stock Position:  0.011999784295314593
Bond Position:  [13.6990324]


portfolio before change:  [14.864297]
curr_Stock_Price:  97.03577597560667
curr_Factors:  [97.03577598]
mat_Sqrt:  [[0.15]]
grads:  [0.05783818]
Stock Position:  0.057838182392415144
Bond Position:  [9.25192409]


portfolio before change:  [14.87001401]
curr_Stock_Price:  97.1246228976576
curr_Factors:  [97.1246229]
mat_Sqrt:  [[0.15]]
grads:  [0.08493771]
Stock Position:  0.08493770512710339
Bond Position:  [6.62047143]


portfolio before change:  [14.83741282]
curr_Stock_Price:  96.735926509747
curr_Factors:  [96.73592651]
mat_Sqrt:  [[0.15]]
grads:  [-0.0702265]
Stock Position:  -0.07022649766695443
Bond Position:  [21.63083814]


portfolio before change:  [14.89922796]
curr_Stock_Price:  95.87495285211388
curr_Factors:  [95.87495285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059285]
Stock Position:  -0.0005928504983826119
Bond Position:  [14.95606747]


portfolio before change:  [14.90025707]
curr_Stock_Price:  95.71584304492312
curr_Factors:  [95.71584304]
mat_Sqrt:  [[0.15]]
grads:  [-0.58793889]
Stock Position:  -0.587938885302436
Bond Position:  [71.17532313]


portfolio before change:  [14.68510609]
curr_Stock_Price:  96.0893505305111
curr_Factors:  [96.08935053]
mat_Sqrt:  [[0.15]]
grads:  [-0.08281783]
Stock Position:  -0.0828178296779041
Bond Position:  [22.64301756]


portfolio before change:  [14.66696486]
curr_Stock_Price:  96.32548887542272
curr_Factors:  [96.32548888]
mat_Sqrt:  [[0.15]]
grads:  [-0.01794226]
Stock Position:  -0.017942264419340964
Bond Position:  [16.39526225]


portfolio before change:  [14.65077568]
curr_Stock_Price:  97.2848947513576
curr_Factors:  [97.28489475]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117629]
Stock Position:  -0.011176292010961712
Bond Position:  [15.73806007]


portfolio before change:  [14.65308223]
curr_Stock_Price:  97.16652855121986
curr_Factors:  [97.16652855]
mat_Sqrt:  [[0.15]]
grads:  [0.06425188]
Stock Position:  0.06425188231485672
Bond Position:  [8.40994988]


portfolio before change:  [14.67239814]
curr_Stock_Price:  97.45897546725313
curr_Factors:  [97.45897547]
mat_Sqrt:  [[0.15]]
grads:  [-0.17826629]
Stock Position:  -0.1782662946354164
Bond Position:  [32.04604857]


portfolio before change:  [14.60233541]
curr_Stock_Price:  97.86323397590279
curr_Factors:  [97.86323398]
mat_Sqrt:  [[0.15]]
grads:  [0.00699556]
Stock Position:  0.00699556254978995
Bond Position:  [13.91772704]


portfolio before change:  [14.60715971]
curr_Stock_Price:  98.42850823595488
curr_Factors:  [98.42850824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02180555]
Stock Position:  -0.021805547465888354
Bond Position:  [16.75344722]


portfolio before change:  [14.60950719]
curr_Stock_Price:  98.36887371632605
curr_Factors:  [98.36887372]
mat_Sqrt:  [[0.15]]
grads:  [-0.06807997]
Stock Position:  -0.06807996637506204
Bond Position:  [21.30645681]


portfolio before change:  [14.57634479]
curr_Stock_Price:  98.875543996128
curr_Factors:  [98.875544]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393208]
Stock Position:  -0.03932079861443903
Bond Position:  [18.46421015]


portfolio before change:  [14.59219094]
curr_Stock_Price:  98.50189700431011
curr_Factors:  [98.501897]
mat_Sqrt:  [[0.15]]
grads:  [0.03148211]
Stock Position:  0.03148210543986135
Bond Position:  [11.49114383]


portfolio before change:  [14.58300156]
curr_Stock_Price:  98.18719125328053
curr_Factors:  [98.18719125]
mat_Sqrt:  [[0.15]]
grads:  [0.08596642]
Stock Position:  0.08596642132303443
Bond Position:  [6.14220011]


portfolio before change:  [14.58711545]
curr_Stock_Price:  98.23058015334504
curr_Factors:  [98.23058015]
mat_Sqrt:  [[0.15]]
grads:  [0.11583746]
Stock Position:  0.11583745561040901
Bond Position:  [3.20833498]


portfolio before change:  [14.51059093]
curr_Stock_Price:  97.56822924561114
curr_Factors:  [97.56822925]
mat_Sqrt:  [[0.15]]
grads:  [-0.22871413]
Stock Position:  -0.22871412893900028
Bond Position:  [36.8258235]


portfolio before change:  [14.51850631]
curr_Stock_Price:  97.54368468475187
curr_Factors:  [97.54368468]
mat_Sqrt:  [[0.15]]
grads:  [0.05789632]
Stock Position:  0.05789631926788682
Bond Position:  [8.87108599]


portfolio before change:  [14.49015062]
curr_Stock_Price:  97.04434127149756
curr_Factors:  [97.04434127]
mat_Sqrt:  [[0.15]]
grads:  [-0.19253865]
Stock Position:  -0.1925386492226229
Bond Position:  [33.174937]


portfolio before change:  [14.39914749]
curr_Stock_Price:  97.5277591822928
curr_Factors:  [97.52775918]
mat_Sqrt:  [[0.15]]
grads:  [0.1189039]
Stock Position:  0.11890390365551731
Bond Position:  [2.80271621]


portfolio before change:  [14.30627877]
curr_Stock_Price:  96.74524582305499
curr_Factors:  [96.74524582]
mat_Sqrt:  [[0.15]]
grads:  [-0.07464876]
Stock Position:  -0.07464876239207584
Bond Position:  [21.52819164]


portfolio before change:  [14.33821779]
curr_Stock_Price:  96.33541363696966
curr_Factors:  [96.33541364]
mat_Sqrt:  [[0.15]]
grads:  [0.2561017]
Stock Position:  0.2561016966604805
Bond Position:  [-10.33344509]


portfolio before change:  [14.33213261]
curr_Stock_Price:  96.31417471942892
curr_Factors:  [96.31417472]
mat_Sqrt:  [[0.15]]
grads:  [0.15485197]
Stock Position:  0.15485196946180563
Bond Position:  [-0.58230704]


portfolio before change:  [14.2351073]
curr_Stock_Price:  95.6878416323896
curr_Factors:  [95.68784163]
mat_Sqrt:  [[0.15]]
grads:  [0.02502194]
Stock Position:  0.025021935630984322
Bond Position:  [11.84081228]


portfolio before change:  [14.22874799]
curr_Stock_Price:  95.40411535852631
curr_Factors:  [95.40411536]
mat_Sqrt:  [[0.15]]
grads:  [0.0508191]
Stock Position:  0.05081910110848114
Bond Position:  [9.38039661]


portfolio before change:  [14.22428366]
curr_Stock_Price:  95.30473104107283
curr_Factors:  [95.30473104]
mat_Sqrt:  [[0.15]]
grads:  [0.12000638]
Stock Position:  0.12000638026310476
Bond Position:  [2.78710787]


portfolio before change:  [14.23702279]
curr_Stock_Price:  95.40943321513637
curr_Factors:  [95.40943322]
mat_Sqrt:  [[0.15]]
grads:  [-0.0090537]
Stock Position:  -0.009053700731991484
Bond Position:  [15.10083125]


portfolio before change:  [14.2343106]
curr_Stock_Price:  95.8132484660644
curr_Factors:  [95.81324847]
mat_Sqrt:  [[0.15]]
grads:  [-0.06482127]
Stock Position:  -0.0648212689884924
Bond Position:  [20.44504695]


portfolio before change:  [14.23851348]
curr_Stock_Price:  95.76812401537848
curr_Factors:  [95.76812402]
mat_Sqrt:  [[0.15]]
grads:  [0.06429725]
Stock Position:  0.06429724761793465
Bond Position:  [8.0808867]


portfolio before change:  [14.21213351]
curr_Stock_Price:  95.34998727898645
curr_Factors:  [95.34998728]
mat_Sqrt:  [[0.15]]
grads:  [0.03266302]
Stock Position:  0.03266301597726676
Bond Position:  [11.09771535]


portfolio before change:  [14.16199982]
curr_Stock_Price:  93.7938750314896
curr_Factors:  [93.79387503]
mat_Sqrt:  [[0.15]]
grads:  [0.18371614]
Stock Position:  0.18371613589058866
Bond Position:  [-3.06944847]


portfolio before change:  [14.15757435]
curr_Stock_Price:  93.77083067265266
curr_Factors:  [93.77083067]
mat_Sqrt:  [[0.15]]
grads:  [0.09198654]
Stock Position:  0.09198654348004472
Bond Position:  [5.53191976]


portfolio before change:  [14.10990446]
curr_Stock_Price:  93.24884505424436
curr_Factors:  [93.24884505]
mat_Sqrt:  [[0.15]]
grads:  [-0.00670857]
Stock Position:  -0.00670856536221168
Bond Position:  [14.73547043]


portfolio before change:  [14.11317231]
curr_Stock_Price:  92.89901433207018
curr_Factors:  [92.89901433]
mat_Sqrt:  [[0.15]]
grads:  [0.0282836]
Stock Position:  0.02828360246692755
Bond Position:  [11.48565352]


portfolio before change:  [14.11505207]
curr_Stock_Price:  92.94009388634221
curr_Factors:  [92.94009389]
mat_Sqrt:  [[0.15]]
grads:  [0.0303604]
Stock Position:  0.03036039939988343
Bond Position:  [11.2933537]


portfolio before change:  [14.08554574]
curr_Stock_Price:  91.9449757629059
curr_Factors:  [91.94497576]
mat_Sqrt:  [[0.15]]
grads:  [0.05027287]
Stock Position:  0.05027286697226323
Bond Position:  [9.4632082]


portfolio before change:  [14.10709846]
curr_Stock_Price:  92.36192526021452
curr_Factors:  [92.36192526]
mat_Sqrt:  [[0.15]]
grads:  [-0.20114993]
Stock Position:  -0.20114993415551075
Bond Position:  [32.68569364]


portfolio before change:  [14.14074416]
curr_Stock_Price:  92.2048146767575
curr_Factors:  [92.20481468]
mat_Sqrt:  [[0.15]]
grads:  [0.00919152]
Stock Position:  0.009191520102880357
Bond Position:  [13.29324175]


portfolio before change:  [14.1445956]
curr_Stock_Price:  92.53344202961479
curr_Factors:  [92.53344203]
mat_Sqrt:  [[0.15]]
grads:  [0.01093676]
Stock Position:  0.010936757075462775
Bond Position:  [13.13257982]


portfolio before change:  [14.14556008]
curr_Stock_Price:  92.54657887740571
curr_Factors:  [92.54657888]
mat_Sqrt:  [[0.15]]
grads:  [-0.86298252]
Stock Position:  -0.862982523669279
Bond Position:  [94.01164028]


portfolio before change:  [12.99160368]
curr_Stock_Price:  93.8905601035418
curr_Factors:  [93.8905601]
mat_Sqrt:  [[0.15]]
grads:  [-0.09363473]
Stock Position:  -0.09363472700023029
Bond Position:  [21.78302065]


portfolio before change:  [12.93638141]
curr_Stock_Price:  94.49486316341124
curr_Factors:  [94.49486316]
mat_Sqrt:  [[0.15]]
grads:  [0.12000821]
Stock Position:  0.12000821459424392
Bond Position:  [1.5962216]


portfolio before change:  [12.95849397]
curr_Stock_Price:  94.67829052603953
curr_Factors:  [94.67829053]
mat_Sqrt:  [[0.15]]
grads:  [0.10909862]
Stock Position:  0.10909862401358833
Bond Position:  [2.62922275]


portfolio before change:  [13.00520697]
curr_Stock_Price:  95.10495646707759
curr_Factors:  [95.10495647]
mat_Sqrt:  [[0.15]]
grads:  [-0.12811023]
Stock Position:  -0.12811023217199718
Bond Position:  [25.18912502]


portfolio before change:  [13.18750738]
curr_Stock_Price:  93.69424919562573
curr_Factors:  [93.6942492]
mat_Sqrt:  [[0.15]]
grads:  [-0.03003406]
Stock Position:  -0.030034062005074975
Bond Position:  [16.00152627]


portfolio before change:  [13.19295965]
curr_Stock_Price:  93.54601248439559
curr_Factors:  [93.54601248]
mat_Sqrt:  [[0.15]]
grads:  [-0.12605067]
Stock Position:  -0.12605067228190067
Bond Position:  [24.98449742]


portfolio before change:  [13.24637473]
curr_Stock_Price:  93.13464225523467
curr_Factors:  [93.13464226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439134]
Stock Position:  -0.024391339195413007
Bond Position:  [15.51805338]


portfolio before change:  [13.2250747]
curr_Stock_Price:  94.04766850487114
curr_Factors:  [94.0476685]
mat_Sqrt:  [[0.15]]
grads:  [-0.01714002]
Stock Position:  -0.017140022168140544
Bond Position:  [14.83705383]


portfolio before change:  [13.21927084]
curr_Stock_Price:  94.44038745620915
curr_Factors:  [94.44038746]
mat_Sqrt:  [[0.15]]
grads:  [-0.11601066]
Stock Position:  -0.11601065500897442
Bond Position:  [24.17536204]


portfolio before change:  [13.19715854]
curr_Stock_Price:  94.64401790809072
curr_Factors:  [94.64401791]
mat_Sqrt:  [[0.15]]
grads:  [0.08830117]
Stock Position:  0.08830117262449788
Bond Position:  [4.83998078]


portfolio before change:  [13.15323766]
curr_Stock_Price:  94.14319339045399
curr_Factors:  [94.14319339]
mat_Sqrt:  [[0.15]]
grads:  [0.05535363]
Stock Position:  0.055353631499994935
Bond Position:  [7.94207002]


portfolio before change:  [13.16911439]
curr_Stock_Price:  94.42104942557346
curr_Factors:  [94.42104943]
mat_Sqrt:  [[0.15]]
grads:  [0.0828234]
Stock Position:  0.08282340423636708
Bond Position:  [5.34884165]


portfolio before change:  [13.15668224]
curr_Stock_Price:  94.26690863920454
curr_Factors:  [94.26690864]
mat_Sqrt:  [[0.15]]
grads:  [0.02310044]
Stock Position:  0.023100437448354938
Bond Position:  [10.97907541]


portfolio before change:  [13.14743712]
curr_Stock_Price:  93.83698873566289
curr_Factors:  [93.83698874]
mat_Sqrt:  [[0.15]]
grads:  [0.02590168]
Stock Position:  0.025901684383929504
Bond Position:  [10.71690105]


portfolio before change:  [13.15640644]
curr_Stock_Price:  94.1574116566527
curr_Factors:  [94.15741166]
mat_Sqrt:  [[0.15]]
grads:  [0.08266217]
Stock Position:  0.08266216879514651
Bond Position:  [5.37315058]


portfolio before change:  [13.23864265]
curr_Stock_Price:  95.1481959979349
curr_Factors:  [95.148196]
mat_Sqrt:  [[0.15]]
grads:  [-0.11271955]
Stock Position:  -0.11271954897014227
Bond Position:  [23.96370439]


portfolio before change:  [13.17497698]
curr_Stock_Price:  95.72629851267077
curr_Factors:  [95.72629851]
mat_Sqrt:  [[0.15]]
grads:  [0.03476892]
Stock Position:  0.03476891610126116
Bond Position:  [9.84667733]


portfolio before change:  [13.18820792]
curr_Stock_Price:  96.08913731112196
curr_Factors:  [96.08913731]
mat_Sqrt:  [[0.15]]
grads:  [0.03624529]
Stock Position:  0.036245293115821614
Bond Position:  [9.70542898]


portfolio before change:  [13.18599913]
curr_Stock_Price:  96.01146089124884
curr_Factors:  [96.01146089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.18599913]
Stock Price:  96.4198525476142
PL:  [13.18599913]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.43765254e-03]
 [ 2.14014496e-03]
 [ 3.97354928e-04]
 [ 8.50779498e-03]
 [ 3.06931037e-03]
 [ 2.79764160e-02]
 [ 1.24932340e-03]
 [-1.24655487e-02]
 [ 2.43429241e-02]
 [-3.71353467e-03]
 [ 1.59222387e-02]
 [-3.85145830e-02]
 [ 3.76737915e-02]
 [ 4.74731746e-03]
 [-6.89875126e-03]
 [ 2.56683091e-02]
 [ 1.11365562e-02]
 [-9.55472573e-03]
 [ 3.90185703e-03]
 [-5.57282873e-03]
 [ 1.40248268e-02]
 [-5.72251896e-03]
 [ 6.86442069e-03]
 [-6.64530728e-03]
 [ 5.73916736e-03]
 [ 7.21137762e-03]
 [-4.54766318e-03]
 [ 1.55972161e-02]
 [ 5.11613748e-02]
 [ 4.60267478e-03]
 [ 1.94400198e-02]
 [-7.27975716e-04]
 [ 1.47818946e-03]
 [ 8.43086211e-03]
 [ 1.13845569e-02]
 [ 1.11019474e-02]
 [-3.45696241e-02]
 [ 9.70418552e-03]
 [-1.51451748e-04]
 [ 1.85984245e-02]
 [-5.26898558e-03]
 [-2.00869227e-02]
 [ 2.09572481e-02]
 [-1.07133670e-03]
 [ 2.04542105e-03]
 [-1.64725658e-02]
 [ 1.48610807e-02]
 [ 1.12531050e-02]
 [ 6.20876317e-03]
 [-7.58860121e-03]
 [ 2.66759205e-02]
 [ 3.81349451e-03]
 [-9.42386750e-03]
 [ 5.89555859e-03]
 [-1.35805026e-02]
 [ 1.07376842e-02]
 [ 1.01359473e-02]
 [ 3.30776839e-04]
 [ 1.72074958e-03]
 [ 1.51938659e-02]
 [ 3.64583732e-03]
 [ 1.67323266e-02]
 [ 3.58635937e-03]
 [-1.24987236e-02]
 [ 4.23621720e-03]
 [ 3.92893246e-03]
 [-5.40432399e-03]
 [ 1.50073286e-02]
 [-8.44388068e-03]
 [-7.11063900e-03]
 [-1.24779970e-02]
 [ 1.35197498e-02]
 [-2.28575949e-03]
 [ 2.28036448e-02]
 [-2.24880002e-02]
 [-7.91185339e-04]
 [-8.82423245e-03]
 [-2.14971460e-03]
 [ 2.52687268e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.26087611]
curr_Stock_Price:  99.33008342621949
curr_Factors:  [99.33008343]
mat_Sqrt:  [[0.15]]
grads:  [0.03625102]
Stock Position:  0.03625101692847148
Bond Position:  [-11.86169264]


portfolio before change:  [-8.21494066]
curr_Stock_Price:  100.61768401853531
curr_Factors:  [100.61768402]
mat_Sqrt:  [[0.15]]
grads:  [0.01426763]
Stock Position:  0.014267633092931723
Bond Position:  [-9.65051686]


portfolio before change:  [-8.22588476]
curr_Stock_Price:  99.8929015087808
curr_Factors:  [99.89290151]
mat_Sqrt:  [[0.15]]
grads:  [0.00264903]
Stock Position:  0.0026490328521297166
Bond Position:  [-8.49050434]


portfolio before change:  [-8.22742498]
curr_Stock_Price:  99.51180220334865
curr_Factors:  [99.5118022]
mat_Sqrt:  [[0.15]]
grads:  [0.05671863]
Stock Position:  0.056718633200545564
Bond Position:  [-13.87159839]


portfolio before change:  [-8.18460357]
curr_Stock_Price:  100.28206789728885
curr_Factors:  [100.2820679]
mat_Sqrt:  [[0.15]]
grads:  [0.02046207]
Stock Position:  0.020462069106469867
Bond Position:  [-10.23658217]


portfolio before change:  [-8.17138789]
curr_Stock_Price:  100.95919811929454
curr_Factors:  [100.95919812]
mat_Sqrt:  [[0.15]]
grads:  [0.18650944]
Stock Position:  0.18650944001199155
Bond Position:  [-27.00123139]


portfolio before change:  [-8.25577738]
curr_Stock_Price:  100.51577896384507
curr_Factors:  [100.51577896]
mat_Sqrt:  [[0.15]]
grads:  [0.00832882]
Stock Position:  0.008328822686238748
Bond Position:  [-9.09295548]


portfolio before change:  [-8.25567976]
curr_Stock_Price:  100.59573542635889
curr_Factors:  [100.59573543]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310366]
Stock Position:  -0.0831036578055775
Bond Position:  [0.10419381]


portfolio before change:  [-8.23964836]
curr_Stock_Price:  100.40290530627382
curr_Factors:  [100.40290531]
mat_Sqrt:  [[0.15]]
grads:  [0.16228616]
Stock Position:  0.1622861604994994
Bond Position:  [-24.53365036]


portfolio before change:  [-8.23985194]
curr_Stock_Price:  100.41109961924208
curr_Factors:  [100.41109962]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247569]
Stock Position:  -0.0247568978202323
Bond Position:  [-5.7539846]


portfolio before change:  [-8.24656502]
curr_Stock_Price:  100.66773315707474
curr_Factors:  [100.66773316]
mat_Sqrt:  [[0.15]]
grads:  [0.10614826]
Stock Position:  0.1061482581651496
Bond Position:  [-18.93226955]


portfolio before change:  [-8.20257557]
curr_Stock_Price:  101.09329603747935
curr_Factors:  [101.09329604]
mat_Sqrt:  [[0.15]]
grads:  [-0.25676389]
Stock Position:  -0.2567638865316007
Bond Position:  [17.75453203]


portfolio before change:  [-8.26123992]
curr_Stock_Price:  101.32609373791999
curr_Factors:  [101.32609374]
mat_Sqrt:  [[0.15]]
grads:  [0.25115861]
Stock Position:  0.2511586100279238
Bond Position:  [-33.71016078]


portfolio before change:  [-8.2051531]
curr_Stock_Price:  101.55779500249103
curr_Factors:  [101.557795]
mat_Sqrt:  [[0.15]]
grads:  [0.03164878]
Stock Position:  0.031648783054340685
Bond Position:  [-11.41933372]


portfolio before change:  [-8.17231415]
curr_Stock_Price:  102.61795198805491
curr_Factors:  [102.61795199]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599168]
Stock Position:  -0.04599167509902248
Bond Position:  [-3.45274265]


portfolio before change:  [-8.15236942]
curr_Stock_Price:  102.1796001313219
curr_Factors:  [102.17960013]
mat_Sqrt:  [[0.15]]
grads:  [0.17112206]
Stock Position:  0.17112206068763414
Bond Position:  [-25.63755315]


portfolio before change:  [-8.11451122]
curr_Stock_Price:  102.41019926693987
curr_Factors:  [102.41019927]
mat_Sqrt:  [[0.15]]
grads:  [0.07424371]
Stock Position:  0.07424370815765535
Bond Position:  [-15.71782416]


portfolio before change:  [-8.12866254]
curr_Stock_Price:  102.23282498494166
curr_Factors:  [102.23282498]
mat_Sqrt:  [[0.15]]
grads:  [-0.06369817]
Stock Position:  -0.06369817151587429
Bond Position:  [-1.61661852]


portfolio before change:  [-8.12878917]
curr_Stock_Price:  102.23322673591905
curr_Factors:  [102.23322674]
mat_Sqrt:  [[0.15]]
grads:  [0.02601238]
Stock Position:  0.02601238019972459
Bond Position:  [-10.78811873]


portfolio before change:  [-8.14430472]
curr_Stock_Price:  101.66268036243706
curr_Factors:  [101.66268036]
mat_Sqrt:  [[0.15]]
grads:  [-0.03715219]
Stock Position:  -0.03715219152183086
Bond Position:  [-4.36731335]


portfolio before change:  [-8.16619263]
curr_Stock_Price:  102.24447515569736
curr_Factors:  [102.24447516]
mat_Sqrt:  [[0.15]]
grads:  [0.09349885]
Stock Position:  0.09349884507443548
Bond Position:  [-17.72593298]


portfolio before change:  [-8.16874879]
curr_Stock_Price:  102.22898565481898
curr_Factors:  [102.22898565]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815013]
Stock Position:  -0.03815012640555587
Bond Position:  [-4.26870006]


portfolio before change:  [-8.11276679]
curr_Stock_Price:  100.75457902484551
curr_Factors:  [100.75457902]
mat_Sqrt:  [[0.15]]
grads:  [0.0457628]
Stock Position:  0.045762804620720465
Bond Position:  [-12.72357891]


portfolio before change:  [-8.04487743]
curr_Stock_Price:  102.25546189558956
curr_Factors:  [102.2554619]
mat_Sqrt:  [[0.15]]
grads:  [-0.04430205]
Stock Position:  -0.044302048528198266
Bond Position:  [-3.514751]


portfolio before change:  [-8.0803513]
curr_Stock_Price:  103.05123077694593
curr_Factors:  [103.05123078]
mat_Sqrt:  [[0.15]]
grads:  [0.03826112]
Stock Position:  0.03826111573437106
Bond Position:  [-12.02320637]


portfolio before change:  [-8.07807864]
curr_Stock_Price:  103.13027026223017
curr_Factors:  [103.13027026]
mat_Sqrt:  [[0.15]]
grads:  [0.04807585]
Stock Position:  0.04807585081368576
Bond Position:  [-13.03615412]


portfolio before change:  [-8.0309316]
curr_Stock_Price:  104.12789835816207
curr_Factors:  [104.12789836]
mat_Sqrt:  [[0.15]]
grads:  [-0.03031775]
Stock Position:  -0.03031775452752321
Bond Position:  [-4.87400754]


portfolio before change:  [-8.02320961]
curr_Stock_Price:  103.86314839229351
curr_Factors:  [103.86314839]
mat_Sqrt:  [[0.15]]
grads:  [0.10398144]
Stock Position:  0.10398144050579058
Bond Position:  [-18.8230494]


portfolio before change:  [-8.03466984]
curr_Stock_Price:  103.76424852397884
curr_Factors:  [103.76424852]
mat_Sqrt:  [[0.15]]
grads:  [0.34107583]
Stock Position:  0.34107583173090106
Bond Position:  [-43.42614721]


portfolio before change:  [-8.06937464]
curr_Stock_Price:  103.67045537555452
curr_Factors:  [103.67045538]
mat_Sqrt:  [[0.15]]
grads:  [0.0306845]
Stock Position:  0.030684498523039536
Bond Position:  [-11.25045057]


portfolio before change:  [-8.05485506]
curr_Stock_Price:  104.16656090013757
curr_Factors:  [104.1665609]
mat_Sqrt:  [[0.15]]
grads:  [0.12960013]
Stock Position:  0.12960013215510663
Bond Position:  [-21.55485512]


portfolio before change:  [-8.086522]
curr_Stock_Price:  103.93261272092212
curr_Factors:  [103.93261272]
mat_Sqrt:  [[0.15]]
grads:  [-0.00485317]
Stock Position:  -0.004853171439404974
Bond Position:  [-7.58211921]


portfolio before change:  [-8.08345403]
curr_Stock_Price:  103.20280761864554
curr_Factors:  [103.20280762]
mat_Sqrt:  [[0.15]]
grads:  [0.0098546]
Stock Position:  0.009854596384332706
Bond Position:  [-9.10047604]


portfolio before change:  [-8.09346151]
curr_Stock_Price:  102.24501272914924
curr_Factors:  [102.24501273]
mat_Sqrt:  [[0.15]]
grads:  [0.05620575]
Stock Position:  0.05620574739364277
Bond Position:  [-13.84021886]


portfolio before change:  [-8.15038687]
curr_Stock_Price:  101.24759998877872
curr_Factors:  [101.24759999]
mat_Sqrt:  [[0.15]]
grads:  [0.07589705]
Stock Position:  0.07589704607984528
Bond Position:  [-15.83478064]


portfolio before change:  [-8.22748522]
curr_Stock_Price:  100.24481212376433
curr_Factors:  [100.24481212]
mat_Sqrt:  [[0.15]]
grads:  [0.07401298]
Stock Position:  0.07401298260555694
Bond Position:  [-15.64690275]


portfolio before change:  [-8.234814]
curr_Stock_Price:  100.15900529314425
curr_Factors:  [100.15900529]
mat_Sqrt:  [[0.15]]
grads:  [-0.23046416]
Stock Position:  -0.2304641607185438
Bond Position:  [14.8482471]


portfolio before change:  [-8.43214419]
curr_Stock_Price:  101.01926155137883
curr_Factors:  [101.01926155]
mat_Sqrt:  [[0.15]]
grads:  [0.06469457]
Stock Position:  0.06469457013573655
Bond Position:  [-14.96754189]


portfolio before change:  [-8.43466932]
curr_Stock_Price:  100.99469023473888
curr_Factors:  [100.99469023]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100968]
Stock Position:  -0.0010096783182840289
Bond Position:  [-8.33269717]


portfolio before change:  [-8.43578956]
curr_Stock_Price:  101.5883768361464
curr_Factors:  [101.58837684]
mat_Sqrt:  [[0.15]]
grads:  [0.1239895]
Stock Position:  0.12398949690682094
Bond Position:  [-21.0316813]


portfolio before change:  [-8.41548072]
curr_Stock_Price:  101.76277354841628
curr_Factors:  [101.76277355]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512657]
Stock Position:  -0.03512657054512531
Bond Position:  [-4.84090348]


portfolio before change:  [-8.44991598]
curr_Stock_Price:  102.73447942663927
curr_Factors:  [102.73447943]
mat_Sqrt:  [[0.15]]
grads:  [-0.13391282]
Stock Position:  -0.13391281824273332
Bond Position:  [5.30754769]


portfolio before change:  [-8.45176083]
curr_Stock_Price:  102.75073310815486
curr_Factors:  [102.75073311]
mat_Sqrt:  [[0.15]]
grads:  [0.13971499]
Stock Position:  0.13971498722272288
Bond Position:  [-22.80757819]


portfolio before change:  [-8.41021943]
curr_Stock_Price:  103.0582657628242
curr_Factors:  [103.05826576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00714224]
Stock Position:  -0.0071422446855437995
Bond Position:  [-7.67415208]


portfolio before change:  [-8.41132041]
curr_Stock_Price:  103.1452600750071
curr_Factors:  [103.14526008]
mat_Sqrt:  [[0.15]]
grads:  [0.01363614]
Stock Position:  0.013636140309130797
Bond Position:  [-9.81782365]


portfolio before change:  [-8.40598124]
curr_Stock_Price:  103.58180611862664
curr_Factors:  [103.58180612]
mat_Sqrt:  [[0.15]]
grads:  [-0.10981711]
Stock Position:  -0.10981710532436666
Bond Position:  [2.96907287]


portfolio before change:  [-8.44927619]
curr_Stock_Price:  103.97774188715339
curr_Factors:  [103.97774189]
mat_Sqrt:  [[0.15]]
grads:  [0.09907387]
Stock Position:  0.0990738713421412
Bond Position:  [-18.75075361]


portfolio before change:  [-8.43637318]
curr_Stock_Price:  104.11980730534442
curr_Factors:  [104.11980731]
mat_Sqrt:  [[0.15]]
grads:  [0.0750207]
Stock Position:  0.07502069971224226
Bond Position:  [-16.24751397]


portfolio before change:  [-8.40005857]
curr_Stock_Price:  104.61740466652205
curr_Factors:  [104.61740467]
mat_Sqrt:  [[0.15]]
grads:  [0.04139175]
Stock Position:  0.04139175444221014
Bond Position:  [-12.7303565]


portfolio before change:  [-8.36659912]
curr_Stock_Price:  105.4449880293439
curr_Factors:  [105.44498803]
mat_Sqrt:  [[0.15]]
grads:  [-0.05059067]
Stock Position:  -0.050590674753336035
Bond Position:  [-3.03206603]


portfolio before change:  [-8.40251183]
curr_Stock_Price:  106.15111032308894
curr_Factors:  [106.15111032]
mat_Sqrt:  [[0.15]]
grads:  [0.17783947]
Stock Position:  0.1778394699735409
Bond Position:  [-27.28036903]


portfolio before change:  [-8.54430511]
curr_Stock_Price:  105.36338753543924
curr_Factors:  [105.36338754]
mat_Sqrt:  [[0.15]]
grads:  [0.0254233]
Stock Position:  0.025423296741833325
Bond Position:  [-11.22298978]


portfolio before change:  [-8.56429269]
curr_Stock_Price:  104.6047873504909
curr_Factors:  [104.60478735]
mat_Sqrt:  [[0.15]]
grads:  [-0.06282578]
Stock Position:  -0.06282578335609945
Bond Position:  [-1.99241498]


portfolio before change:  [-8.57890839]
curr_Stock_Price:  104.83544371755137
curr_Factors:  [104.83544372]
mat_Sqrt:  [[0.15]]
grads:  [0.03930372]
Stock Position:  0.03930372396520483
Bond Position:  [-12.69933173]


portfolio before change:  [-8.57625517]
curr_Stock_Price:  104.92314410159564
curr_Factors:  [104.9231441]
mat_Sqrt:  [[0.15]]
grads:  [-0.09053668]
Stock Position:  -0.09053668397963938
Bond Position:  [0.92313837]


portfolio before change:  [-8.47123223]
curr_Stock_Price:  103.7637771238043
curr_Factors:  [103.76377712]
mat_Sqrt:  [[0.15]]
grads:  [0.07158456]
Stock Position:  0.07158456144301317
Bond Position:  [-15.89911671]


portfolio before change:  [-8.49371772]
curr_Stock_Price:  103.46354805765684
curr_Factors:  [103.46354806]
mat_Sqrt:  [[0.15]]
grads:  [0.06757298]
Stock Position:  0.06757298217831408
Bond Position:  [-15.48505821]


portfolio before change:  [-8.46394597]
curr_Stock_Price:  103.91845759100075
curr_Factors:  [103.91845759]
mat_Sqrt:  [[0.15]]
grads:  [0.00220518]
Stock Position:  0.002205178926219835
Bond Position:  [-8.69310476]


portfolio before change:  [-8.46596013]
curr_Stock_Price:  103.25147336882894
curr_Factors:  [103.25147337]
mat_Sqrt:  [[0.15]]
grads:  [0.01147166]
Stock Position:  0.011471663872963962
Bond Position:  [-9.65042632]


portfolio before change:  [-8.46275526]
curr_Stock_Price:  103.58342476912561
curr_Factors:  [103.58342477]
mat_Sqrt:  [[0.15]]
grads:  [0.10129244]
Stock Position:  0.10129243914470952
Bond Position:  [-18.95497301]


portfolio before change:  [-8.44721594]
curr_Stock_Price:  103.74853132932846
curr_Factors:  [103.74853133]
mat_Sqrt:  [[0.15]]
grads:  [0.02430558]
Stock Position:  0.024305582120862625
Bond Position:  [-10.96888439]


portfolio before change:  [-8.46077216]
curr_Stock_Price:  103.21899683637042
curr_Factors:  [103.21899684]
mat_Sqrt:  [[0.15]]
grads:  [0.11154884]
Stock Position:  0.11154884414638663
Bond Position:  [-19.97473195]


portfolio before change:  [-8.43643734]
curr_Stock_Price:  103.44834286102424
curr_Factors:  [103.44834286]
mat_Sqrt:  [[0.15]]
grads:  [0.02390906]
Stock Position:  0.02390906245638026
Bond Position:  [-10.90979023]


portfolio before change:  [-8.44437425]
curr_Stock_Price:  103.14490008033899
curr_Factors:  [103.14490008]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332482]
Stock Position:  -0.08332482381293539
Bond Position:  [0.15015637]


portfolio before change:  [-8.44296913]
curr_Stock_Price:  103.1281494934233
curr_Factors:  [103.12814949]
mat_Sqrt:  [[0.15]]
grads:  [0.02824145]
Stock Position:  0.028241447985119482
Bond Position:  [-11.3554574]


portfolio before change:  [-8.4148986]
curr_Stock_Price:  104.14722832215635
curr_Factors:  [104.14722832]
mat_Sqrt:  [[0.15]]
grads:  [0.02619288]
Stock Position:  0.02619288303519973
Bond Position:  [-11.14281477]


portfolio before change:  [-8.42139565]
curr_Stock_Price:  103.92577139290175
curr_Factors:  [103.92577139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03602883]
Stock Position:  -0.03602882658735422
Bond Position:  [-4.67707205]


portfolio before change:  [-8.41315216]
curr_Stock_Price:  103.68885522942442
curr_Factors:  [103.68885523]
mat_Sqrt:  [[0.15]]
grads:  [0.10004886]
Stock Position:  0.10004885714746531
Bond Position:  [-18.78710363]


portfolio before change:  [-8.39237753]
curr_Stock_Price:  103.90823665300117
curr_Factors:  [103.90823665]
mat_Sqrt:  [[0.15]]
grads:  [-0.05629254]
Stock Position:  -0.0562925378576376
Bond Position:  [-2.54311919]


portfolio before change:  [-8.43181595]
curr_Stock_Price:  104.60601066574895
curr_Factors:  [104.60601067]
mat_Sqrt:  [[0.15]]
grads:  [-0.04740426]
Stock Position:  -0.04740426000333945
Bond Position:  [-3.47304542]


portfolio before change:  [-8.4279991]
curr_Stock_Price:  104.52091450834614
curr_Factors:  [104.52091451]
mat_Sqrt:  [[0.15]]
grads:  [-0.08318665]
Stock Position:  -0.08318664682798889
Bond Position:  [0.2667453]


portfolio before change:  [-8.40783764]
curr_Stock_Price:  104.27875077824054
curr_Factors:  [104.27875078]
mat_Sqrt:  [[0.15]]
grads:  [0.09013167]
Stock Position:  0.09013166527047461
Bond Position:  [-17.8066551]


portfolio before change:  [-8.43020652]
curr_Stock_Price:  104.04291880226513
curr_Factors:  [104.0429188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0152384]
Stock Position:  -0.01523839662651961
Bond Position:  [-6.84475926]


portfolio before change:  [-8.41793017]
curr_Stock_Price:  103.20922471387229
curr_Factors:  [103.20922471]
mat_Sqrt:  [[0.15]]
grads:  [0.1520243]
Stock Position:  0.15202429835077486
Bond Position:  [-24.10824014]


portfolio before change:  [-8.44203901]
curr_Stock_Price:  103.06055091351844
curr_Factors:  [103.06055091]
mat_Sqrt:  [[0.15]]
grads:  [-0.14992]
Stock Position:  -0.14992000158716437
Bond Position:  [7.00879894]


portfolio before change:  [-8.44837941]
curr_Stock_Price:  103.1057647781688
curr_Factors:  [103.10576478]
mat_Sqrt:  [[0.15]]
grads:  [-0.00527457]
Stock Position:  -0.005274568926119649
Bond Position:  [-7.90454095]


portfolio before change:  [-8.447846]
curr_Stock_Price:  102.9109688066279
curr_Factors:  [102.91096881]
mat_Sqrt:  [[0.15]]
grads:  [-0.05882822]
Stock Position:  -0.058828216353997015
Bond Position:  [-2.39377726]


portfolio before change:  [-8.40898898]
curr_Stock_Price:  102.24790889977072
curr_Factors:  [102.2479089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433143]
Stock Position:  -0.014331430688671792
Bond Position:  [-6.94363016]


portfolio before change:  [-8.40819973]
curr_Stock_Price:  102.16255486811323
curr_Factors:  [102.16255487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.40819973]
Stock Price:  101.91293452300748
PL:  [-10.32113425]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.07212428e-03]
 [ 2.24405209e-03]
 [-4.59091073e-03]
 [ 3.96766127e-03]
 [ 6.00771941e-03]
 [ 2.80374986e-02]
 [ 1.30742840e-03]
 [-5.69185398e-03]
 [ 2.38226958e-02]
 [ 4.72129738e-03]
 [ 1.45071754e-02]
 [-1.61058074e-02]
 [ 2.60395711e-02]
 [ 1.40306947e-03]
 [-6.91486124e-03]
 [ 1.38206388e-02]
 [ 7.51827501e-03]
 [-1.18731646e-02]
 [-3.73093984e-04]
 [ 1.01295881e-02]
 [ 1.23060354e-02]
 [-9.60195245e-03]
 [ 7.23927686e-03]
 [ 1.07445404e-02]
 [-8.10608988e-03]
 [-5.24911517e-03]
 [-5.25515824e-03]
 [ 6.13040482e-03]
 [-1.24443771e-02]
 [-1.56672212e-03]
 [-2.97900244e-03]
 [-1.03127326e-02]
 [-6.86338538e-03]
 [ 4.68400881e-03]
 [ 1.14440420e-02]
 [ 8.91598669e-03]
 [-3.42055835e-02]
 [ 9.74617347e-03]
 [-2.56735761e-03]
 [ 2.19166093e-02]
 [-6.23956966e-03]
 [-1.02282138e-02]
 [ 2.34452935e-02]
 [ 3.50527566e-03]
 [-7.43042782e-03]
 [ 5.79536746e-04]
 [ 9.97916004e-03]
 [-7.79405948e-03]
 [-9.39848370e-03]
 [-7.69657432e-03]
 [-9.20711268e-03]
 [ 2.14181054e-03]
 [-6.44791830e-03]
 [ 5.46990648e-03]
 [ 6.67542950e-04]
 [-2.45170798e-04]
 [ 8.90463384e-03]
 [-4.88936551e-04]
 [ 1.64857876e-03]
 [ 1.60961075e-02]
 [-2.40885193e-03]
 [ 1.64491509e-02]
 [ 3.96821637e-03]
 [-1.23957331e-02]
 [ 1.79907580e-03]
 [ 1.43624776e-03]
 [-5.42550639e-03]
 [ 1.50342561e-02]
 [-8.26512870e-03]
 [ 1.00637342e-02]
 [-1.27436807e-02]
 [ 1.32317678e-02]
 [-6.73573181e-03]
 [ 2.34536321e-02]
 [-2.24875291e-02]
 [-1.07845076e-03]
 [-9.08283332e-03]
 [-5.60287842e-03]
 [ 2.99764814e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.37717115]
curr_Stock_Price:  99.77769605843272
curr_Factors:  [99.77769606]
mat_Sqrt:  [[0.15]]
grads:  [0.02048083]
Stock Position:  0.02048082854725954
Bond Position:  [-3.42070103]


portfolio before change:  [-1.3611204]
curr_Stock_Price:  100.57183143417045
curr_Factors:  [100.57183143]
mat_Sqrt:  [[0.15]]
grads:  [0.01496035]
Stock Position:  0.014960347271056692
Bond Position:  [-2.86570992]


portfolio before change:  [-1.35349434]
curr_Stock_Price:  101.09355528239804
curr_Factors:  [101.09355528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060607]
Stock Position:  -0.030606071551042557
Bond Position:  [1.74058225]


portfolio before change:  [-1.35313527]
curr_Stock_Price:  101.08537791984917
curr_Factors:  [101.08537792]
mat_Sqrt:  [[0.15]]
grads:  [0.02645108]
Stock Position:  0.026451075147481552
Bond Position:  [-4.0269522]


portfolio before change:  [-1.36451152]
curr_Stock_Price:  100.66480692094424
curr_Factors:  [100.66480692]
mat_Sqrt:  [[0.15]]
grads:  [0.04005146]
Stock Position:  0.04005146270549968
Bond Position:  [-5.39628428]


portfolio before change:  [-1.36694862]
curr_Stock_Price:  100.61237892990955
curr_Factors:  [100.61237893]
mat_Sqrt:  [[0.15]]
grads:  [0.18691666]
Stock Position:  0.18691665702409443
Bond Position:  [-20.17307814]


portfolio before change:  [-1.39347438]
curr_Stock_Price:  100.4772122119335
curr_Factors:  [100.47721221]
mat_Sqrt:  [[0.15]]
grads:  [0.00871619]
Stock Position:  0.008716189364359344
Bond Position:  [-2.26925279]


portfolio before change:  [-1.38829451]
curr_Stock_Price:  101.08776613148062
curr_Factors:  [101.08776613]
mat_Sqrt:  [[0.15]]
grads:  [-0.03794569]
Stock Position:  -0.03794569319646532
Bond Position:  [2.44755085]


portfolio before change:  [-1.36087923]
curr_Stock_Price:  100.36931036152039
curr_Factors:  [100.36931036]
mat_Sqrt:  [[0.15]]
grads:  [0.15881797]
Stock Position:  0.15881797208538512
Bond Position:  [-17.30132957]


portfolio before change:  [-1.47156183]
curr_Stock_Price:  99.67920441601852
curr_Factors:  [99.67920442]
mat_Sqrt:  [[0.15]]
grads:  [0.03147532]
Stock Position:  0.03147531589469891
Bond Position:  [-4.60899627]


portfolio before change:  [-1.48111448]
curr_Stock_Price:  99.38486004361746
curr_Factors:  [99.38486004]
mat_Sqrt:  [[0.15]]
grads:  [0.0967145]
Stock Position:  0.09671450254554816
Bond Position:  [-11.09307178]


portfolio before change:  [-1.38458051]
curr_Stock_Price:  100.39016230063655
curr_Factors:  [100.3901623]
mat_Sqrt:  [[0.15]]
grads:  [-0.10737205]
Stock Position:  -0.10737204918269119
Bond Position:  [9.39451693]


portfolio before change:  [-1.45173067]
curr_Stock_Price:  101.02102792805562
curr_Factors:  [101.02102793]
mat_Sqrt:  [[0.15]]
grads:  [0.17359714]
Stock Position:  0.17359714099783158
Bond Position:  [-18.9886923]


portfolio before change:  [-1.55225517]
curr_Stock_Price:  100.4487969125487
curr_Factors:  [100.44879691]
mat_Sqrt:  [[0.15]]
grads:  [0.0093538]
Stock Position:  0.009353796473863602
Bond Position:  [-2.49183277]


portfolio before change:  [-1.55389454]
curr_Stock_Price:  100.29018496754506
curr_Factors:  [100.29018497]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609907]
Stock Position:  -0.04609907495589026
Bond Position:  [3.06939022]


portfolio before change:  [-1.55579203]
curr_Stock_Price:  100.33550767198204
curr_Factors:  [100.33550767]
mat_Sqrt:  [[0.15]]
grads:  [0.09213759]
Stock Position:  0.09213759172696688
Bond Position:  [-10.80046407]


portfolio before change:  [-1.58796516]
curr_Stock_Price:  99.9936484916269
curr_Factors:  [99.99364849]
mat_Sqrt:  [[0.15]]
grads:  [0.05012183]
Stock Position:  0.050121833420294734
Bond Position:  [-6.59983015]


portfolio before change:  [-1.60862508]
curr_Stock_Price:  99.58968458475226
curr_Factors:  [99.58968458]
mat_Sqrt:  [[0.15]]
grads:  [-0.07915443]
Stock Position:  -0.07915443077791808
Bond Position:  [6.27433972]


portfolio before change:  [-1.57748855]
curr_Stock_Price:  99.20127469620068
curr_Factors:  [99.2012747]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248729]
Stock Position:  -0.0024872932234770544
Bond Position:  [-1.3307459]


portfolio before change:  [-1.57565522]
curr_Stock_Price:  98.43075466119413
curr_Factors:  [98.43075466]
mat_Sqrt:  [[0.15]]
grads:  [0.06753059]
Stock Position:  0.06753058748560033
Bond Position:  [-8.22274191]


portfolio before change:  [-1.60225409]
curr_Stock_Price:  98.04448627364377
curr_Factors:  [98.04448627]
mat_Sqrt:  [[0.15]]
grads:  [0.08204024]
Stock Position:  0.08204023617863772
Bond Position:  [-9.6458469]


portfolio before change:  [-1.61708367]
curr_Stock_Price:  97.87107500596458
curr_Factors:  [97.87107501]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401302]
Stock Position:  -0.06401301634215631
Bond Position:  [4.64793905]


portfolio before change:  [-1.66025883]
curr_Stock_Price:  98.55008785256585
curr_Factors:  [98.55008785]
mat_Sqrt:  [[0.15]]
grads:  [0.04826185]
Stock Position:  0.04826184571593284
Bond Position:  [-6.41646796]


portfolio before change:  [-1.65560238]
curr_Stock_Price:  98.65488066785173
curr_Factors:  [98.65488067]
mat_Sqrt:  [[0.15]]
grads:  [0.07163027]
Stock Position:  0.07163026928994501
Bond Position:  [-8.72227804]


portfolio before change:  [-1.66131272]
curr_Stock_Price:  98.58277166442868
curr_Factors:  [98.58277166]
mat_Sqrt:  [[0.15]]
grads:  [-0.0540406]
Stock Position:  -0.05404059920936859
Bond Position:  [3.66615933]


portfolio before change:  [-1.67382787]
curr_Stock_Price:  98.8185997404714
curr_Factors:  [98.81859974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0349941]
Stock Position:  -0.034994101121266497
Bond Position:  [1.7842402]


portfolio before change:  [-1.67417269]
curr_Stock_Price:  98.83164013467434
curr_Factors:  [98.83164013]
mat_Sqrt:  [[0.15]]
grads:  [-0.03503439]
Stock Position:  -0.035034388282829995
Bond Position:  [1.78833337]


portfolio before change:  [-1.69055039]
curr_Stock_Price:  99.30230563897192
curr_Factors:  [99.30230564]
mat_Sqrt:  [[0.15]]
grads:  [0.04086937]
Stock Position:  0.04086936549022038
Bond Position:  [-5.74897262]


portfolio before change:  [-1.70101431]
curr_Stock_Price:  99.05506431989627
curr_Factors:  [99.05506432]
mat_Sqrt:  [[0.15]]
grads:  [-0.08296251]
Stock Position:  -0.08296251417936581
Bond Position:  [6.51684287]


portfolio before change:  [-1.72108129]
curr_Stock_Price:  99.30185406811495
curr_Factors:  [99.30185407]
mat_Sqrt:  [[0.15]]
grads:  [-0.01044481]
Stock Position:  -0.010444814142186135
Bond Position:  [-0.68389188]


portfolio before change:  [-1.7228116]
curr_Stock_Price:  99.46342356528304
curr_Factors:  [99.46342357]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986002]
Stock Position:  -0.019860016270922085
Bond Position:  [0.25253361]


portfolio before change:  [-1.72063363]
curr_Stock_Price:  99.35455240575233
curr_Factors:  [99.35455241]
mat_Sqrt:  [[0.15]]
grads:  [-0.06875155]
Stock Position:  -0.0687515508036638
Bond Position:  [5.11014592]


portfolio before change:  [-1.67111724]
curr_Stock_Price:  98.63897580513051
curr_Factors:  [98.63897581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0457559]
Stock Position:  -0.045755902561628134
Bond Position:  [2.84219813]


portfolio before change:  [-1.7177203]
curr_Stock_Price:  99.66137292751426
curr_Factors:  [99.66137293]
mat_Sqrt:  [[0.15]]
grads:  [0.03122673]
Stock Position:  0.03122672540812557
Bond Position:  [-4.82981863]


portfolio before change:  [-1.6850851]
curr_Stock_Price:  100.71614476371724
curr_Factors:  [100.71614476]
mat_Sqrt:  [[0.15]]
grads:  [0.07629361]
Stock Position:  0.07629361318792147
Bond Position:  [-9.36908369]


portfolio before change:  [-1.65457383]
curr_Stock_Price:  101.12373930144378
curr_Factors:  [101.1237393]
mat_Sqrt:  [[0.15]]
grads:  [0.05943991]
Stock Position:  0.05943991126500365
Bond Position:  [-7.66535992]


portfolio before change:  [-1.67679777]
curr_Stock_Price:  100.7579103941556
curr_Factors:  [100.75791039]
mat_Sqrt:  [[0.15]]
grads:  [-0.22803722]
Stock Position:  -0.22803722347142547
Bond Position:  [21.29975636]


portfolio before change:  [-1.67700225]
curr_Stock_Price:  100.76464509015871
curr_Factors:  [100.76464509]
mat_Sqrt:  [[0.15]]
grads:  [0.06497449]
Stock Position:  0.06497448982829945
Bond Position:  [-8.22413366]


portfolio before change:  [-1.6849741]
curr_Stock_Price:  100.64986421179404
curr_Factors:  [100.64986421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01711572]
Stock Position:  -0.017115717430327762
Bond Position:  [0.03772053]


portfolio before change:  [-1.68276447]
curr_Stock_Price:  100.52090249195918
curr_Factors:  [100.52090249]
mat_Sqrt:  [[0.15]]
grads:  [0.14611073]
Stock Position:  0.146110728375722
Bond Position:  [-16.36994675]


portfolio before change:  [-1.792642]
curr_Stock_Price:  99.775889626975
curr_Factors:  [99.77588963]
mat_Sqrt:  [[0.15]]
grads:  [-0.04159713]
Stock Position:  -0.04159713105343114
Bond Position:  [2.35774876]


portfolio before change:  [-1.80008353]
curr_Stock_Price:  99.95832763616598
curr_Factors:  [99.95832764]
mat_Sqrt:  [[0.15]]
grads:  [-0.06818809]
Stock Position:  -0.06818809191927336
Bond Position:  [5.0158841]


portfolio before change:  [-1.82187882]
curr_Stock_Price:  100.2825600378606
curr_Factors:  [100.28256004]
mat_Sqrt:  [[0.15]]
grads:  [0.15630196]
Stock Position:  0.1563019569246593
Bond Position:  [-17.4962392]


portfolio before change:  [-1.81708903]
curr_Stock_Price:  100.32020088322705
curr_Factors:  [100.32020088]
mat_Sqrt:  [[0.15]]
grads:  [0.0233685]
Stock Position:  0.02336850437783042
Bond Position:  [-4.16142208]


portfolio before change:  [-1.80734687]
curr_Stock_Price:  100.7482237093697
curr_Factors:  [100.74822371]
mat_Sqrt:  [[0.15]]
grads:  [-0.04953619]
Stock Position:  -0.049536185457132086
Bond Position:  [3.18333582]


portfolio before change:  [-1.79287982]
curr_Stock_Price:  100.46018997057034
curr_Factors:  [100.46018997]
mat_Sqrt:  [[0.15]]
grads:  [0.00386358]
Stock Position:  0.0038635783045911044
Bond Position:  [-2.18101563]


portfolio before change:  [-1.79162165]
curr_Stock_Price:  100.82112224423912
curr_Factors:  [100.82112224]
mat_Sqrt:  [[0.15]]
grads:  [0.06652773]
Stock Position:  0.06652773356845904
Bond Position:  [-8.4990224]


portfolio before change:  [-1.78712596]
curr_Stock_Price:  100.89668305224933
curr_Factors:  [100.89668305]
mat_Sqrt:  [[0.15]]
grads:  [-0.0519604]
Stock Position:  -0.051960396548912664
Bond Position:  [3.4555057]


portfolio before change:  [-1.80061799]
curr_Stock_Price:  101.1604994036603
curr_Factors:  [101.1604994]
mat_Sqrt:  [[0.15]]
grads:  [-0.06265656]
Stock Position:  -0.0626565579875985
Bond Position:  [4.53775071]


portfolio before change:  [-1.78038093]
curr_Stock_Price:  100.84204212178936
curr_Factors:  [100.84204212]
mat_Sqrt:  [[0.15]]
grads:  [-0.0513105]
Stock Position:  -0.051310495484543805
Bond Position:  [3.39387421]


portfolio before change:  [-1.81975146]
curr_Stock_Price:  101.61347603599297
curr_Factors:  [101.61347604]
mat_Sqrt:  [[0.15]]
grads:  [-0.06138075]
Stock Position:  -0.06138075122954096
Bond Position:  [4.41736003]


portfolio before change:  [-1.8777445]
curr_Stock_Price:  102.56278224741409
curr_Factors:  [102.56278225]
mat_Sqrt:  [[0.15]]
grads:  [0.01427874]
Stock Position:  0.014278736938858524
Bond Position:  [-3.34221149]


portfolio before change:  [-1.88434277]
curr_Stock_Price:  102.11530753147653
curr_Factors:  [102.11530753]
mat_Sqrt:  [[0.15]]
grads:  [-0.04298612]
Stock Position:  -0.04298612199258977
Bond Position:  [2.5051983]


portfolio before change:  [-1.87737003]
curr_Stock_Price:  101.95674103599572
curr_Factors:  [101.95674104]
mat_Sqrt:  [[0.15]]
grads:  [0.03646604]
Stock Position:  0.03646604319559219
Bond Position:  [-5.59532895]


portfolio before change:  [-1.87834605]
curr_Stock_Price:  101.93956618198321
curr_Factors:  [101.93956618]
mat_Sqrt:  [[0.15]]
grads:  [0.00445029]
Stock Position:  0.004450286332141226
Bond Position:  [-2.33200631]


portfolio before change:  [-1.87850995]
curr_Stock_Price:  101.93548946140734
curr_Factors:  [101.93548946]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163447]
Stock Position:  -0.0016344719859450834
Bond Position:  [-1.71189924]


portfolio before change:  [-1.87881773]
curr_Stock_Price:  102.05833646102693
curr_Factors:  [102.05833646]
mat_Sqrt:  [[0.15]]
grads:  [0.05936423]
Stock Position:  0.05936422562196643
Bond Position:  [-7.93743184]


portfolio before change:  [-1.85564322]
curr_Stock_Price:  102.4570719238751
curr_Factors:  [102.45707192]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325958]
Stock Position:  -0.0032595770044509522
Bond Position:  [-1.5216765]


portfolio before change:  [-1.85495557]
curr_Stock_Price:  102.21693334717577
curr_Factors:  [102.21693335]
mat_Sqrt:  [[0.15]]
grads:  [0.01099053]
Stock Position:  0.010990525039870634
Bond Position:  [-2.97837334]


portfolio before change:  [-1.8510846]
curr_Stock_Price:  102.58608106316001
curr_Factors:  [102.58608106]
mat_Sqrt:  [[0.15]]
grads:  [0.10730738]
Stock Position:  0.10730738361774485
Bond Position:  [-12.85932855]


portfolio before change:  [-1.84293484]
curr_Stock_Price:  102.66951882579431
curr_Factors:  [102.66951883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605901]
Stock Position:  -0.016059012842211763
Bond Position:  [-0.19416372]


portfolio before change:  [-1.84987521]
curr_Stock_Price:  103.10094225233819
curr_Factors:  [103.10094225]
mat_Sqrt:  [[0.15]]
grads:  [0.10966101]
Stock Position:  0.10966100587195972
Bond Position:  [-13.15602825]


portfolio before change:  [-1.76165844]
curr_Stock_Price:  103.91289043372679
curr_Factors:  [103.91289043]
mat_Sqrt:  [[0.15]]
grads:  [0.02645478]
Stock Position:  0.026454775825248227
Bond Position:  [-4.51065066]


portfolio before change:  [-1.79196023]
curr_Stock_Price:  102.77812873767208
curr_Factors:  [102.77812874]
mat_Sqrt:  [[0.15]]
grads:  [-0.08263822]
Stock Position:  -0.08263822093504301
Bond Position:  [6.70144148]


portfolio before change:  [-1.77531872]
curr_Stock_Price:  102.58181942764487
curr_Factors:  [102.58181943]
mat_Sqrt:  [[0.15]]
grads:  [0.01199384]
Stock Position:  0.011993838683549661
Bond Position:  [-3.00566852]


portfolio before change:  [-1.77333297]
curr_Stock_Price:  102.76304713392422
curr_Factors:  [102.76304713]
mat_Sqrt:  [[0.15]]
grads:  [0.00957499]
Stock Position:  0.009574985059563867
Bond Position:  [-2.75728761]


portfolio before change:  [-1.77052314]
curr_Stock_Price:  103.07450027087151
curr_Factors:  [103.07450027]
mat_Sqrt:  [[0.15]]
grads:  [-0.03617004]
Stock Position:  -0.036170042584764715
Bond Position:  [1.95768592]


portfolio before change:  [-1.76623053]
curr_Stock_Price:  102.95920456145447
curr_Factors:  [102.95920456]
mat_Sqrt:  [[0.15]]
grads:  [0.10022837]
Stock Position:  0.100228374154612
Bond Position:  [-12.08566421]


portfolio before change:  [-1.77791572]
curr_Stock_Price:  102.850155539754
curr_Factors:  [102.85015554]
mat_Sqrt:  [[0.15]]
grads:  [-0.05510086]
Stock Position:  -0.055100858028607896
Bond Position:  [3.8892161]


portfolio before change:  [-1.77394498]
curr_Stock_Price:  102.78250411675404
curr_Factors:  [102.78250412]
mat_Sqrt:  [[0.15]]
grads:  [0.06709156]
Stock Position:  0.0670915611951852
Bond Position:  [-8.66978365]


portfolio before change:  [-1.74995659]
curr_Stock_Price:  103.14812788311647
curr_Factors:  [103.14812788]
mat_Sqrt:  [[0.15]]
grads:  [-0.08495787]
Stock Position:  -0.08495787156035428
Bond Position:  [7.01328881]


portfolio before change:  [-1.81290518]
curr_Stock_Price:  103.89422629854819
curr_Factors:  [103.8942263]
mat_Sqrt:  [[0.15]]
grads:  [0.08821179]
Stock Position:  0.08821178549359467
Bond Position:  [-10.97760039]


portfolio before change:  [-1.74110831]
curr_Stock_Price:  104.71591918384628
curr_Factors:  [104.71591918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490488]
Stock Position:  -0.04490487874640088
Bond Position:  [2.96114735]


portfolio before change:  [-1.68957719]
curr_Stock_Price:  103.57247903331911
curr_Factors:  [103.57247903]
mat_Sqrt:  [[0.15]]
grads:  [0.15635755]
Stock Position:  0.15635754714035985
Bond Position:  [-17.88391596]


portfolio before change:  [-1.7800689]
curr_Stock_Price:  103.00087930819485
curr_Factors:  [103.00087931]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991686]
Stock Position:  -0.14991686061419485
Bond Position:  [13.66149957]


portfolio before change:  [-1.73034466]
curr_Stock_Price:  102.67489617403358
curr_Factors:  [102.67489617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00718967]
Stock Position:  -0.007189671700783603
Bond Position:  [-0.99214586]


portfolio before change:  [-1.73150175]
curr_Stock_Price:  102.82720843092592
curr_Factors:  [102.82720843]
mat_Sqrt:  [[0.15]]
grads:  [-0.06055222]
Stock Position:  -0.060552222104732885
Bond Position:  [4.49491422]


portfolio before change:  [-1.75932166]
curr_Stock_Price:  103.29128486866941
curr_Factors:  [103.29128487]
mat_Sqrt:  [[0.15]]
grads:  [-0.03735252]
Stock Position:  -0.0373525228248275
Bond Position:  [2.09886841]


portfolio before change:  [-1.76909181]
curr_Stock_Price:  103.55636268276376
curr_Factors:  [103.55636268]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.76909181]
Stock Price:  103.07719021142704
PL:  [-4.84628202]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.95822464e-03]
 [ 3.12126569e-03]
 [-2.05855287e-03]
 [ 5.91493963e-03]
 [ 6.76381958e-03]
 [ 2.75974027e-02]
 [ 8.64882272e-04]
 [-1.45377784e-02]
 [ 2.47967238e-02]
 [-4.55620936e-03]
 [ 3.08130248e-02]
 [-1.34359515e-02]
 [ 5.91916419e-02]
 [ 6.01537367e-03]
 [-6.90086211e-03]
 [ 1.98348799e-02]
 [ 7.96017510e-03]
 [-1.23612194e-02]
 [-4.93434275e-04]
 [ 1.20470911e-02]
 [ 1.25383916e-02]
 [-7.58725720e-03]
 [ 6.81484659e-03]
 [ 2.61968807e-02]
 [ 9.17160347e-04]
 [ 1.21684925e-02]
 [-5.97183299e-03]
 [ 6.77406322e-03]
 [ 1.06122435e-02]
 [-2.76951717e-03]
 [ 8.49761008e-03]
 [-1.17415183e-02]
 [ 6.29693491e-03]
 [ 8.26108758e-03]
 [ 1.09071124e-02]
 [ 8.51706467e-03]
 [-3.32362595e-02]
 [ 9.60819117e-03]
 [ 4.32116241e-03]
 [ 2.01286307e-02]
 [-5.09817677e-03]
 [-2.12311263e-02]
 [ 2.24727532e-02]
 [ 2.69111145e-03]
 [-3.38408758e-03]
 [-1.28636801e-02]
 [ 1.38230548e-02]
 [ 3.98052244e-04]
 [-3.22193810e-03]
 [-7.55856125e-03]
 [ 2.67501959e-02]
 [-7.01261621e-03]
 [-1.57040910e-03]
 [ 5.42128041e-03]
 [ 5.67021576e-03]
 [-3.25979427e-03]
 [ 7.92594033e-03]
 [-6.74814504e-04]
 [ 1.53643419e-03]
 [ 2.11032638e-03]
 [ 1.25976400e-03]
 [-3.59293331e-03]
 [ 8.23074838e-05]
 [-1.50826313e-02]
 [-1.15252758e-02]
 [ 1.68670024e-03]
 [-5.37245295e-03]
 [ 2.42604549e-02]
 [-8.84180176e-03]
 [ 6.53963755e-03]
 [-8.83952293e-03]
 [ 1.07225428e-02]
 [-5.07376962e-03]
 [ 8.61840975e-03]
 [-1.90379332e-02]
 [-4.26693586e-03]
 [-5.36048741e-03]
 [-1.88045521e-03]
 [-2.16604912e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.72250518]
curr_Stock_Price:  99.82026568615404
curr_Factors:  [99.82026569]
mat_Sqrt:  [[0.15]]
grads:  [0.0197215]
Stock Position:  0.019721497579244927
Bond Position:  [-2.69111031]


portfolio before change:  [-0.71507222]
curr_Stock_Price:  100.20569048234165
curr_Factors:  [100.20569048]
mat_Sqrt:  [[0.15]]
grads:  [0.02080844]
Stock Position:  0.020808437955346388
Bond Position:  [-2.80019612]


portfolio before change:  [-0.70939478]
curr_Stock_Price:  100.48694450504236
curr_Factors:  [100.48694451]
mat_Sqrt:  [[0.15]]
grads:  [-0.01372369]
Stock Position:  -0.013723685816085603
Bond Position:  [0.66965647]


portfolio before change:  [-0.71122101]
curr_Stock_Price:  100.62306529890024
curr_Factors:  [100.6230653]
mat_Sqrt:  [[0.15]]
grads:  [0.03943293]
Stock Position:  0.03943293088451351
Bond Position:  [-4.67908339]


portfolio before change:  [-0.70786617]
curr_Stock_Price:  100.71555884067985
curr_Factors:  [100.71555884]
mat_Sqrt:  [[0.15]]
grads:  [0.04509213]
Stock Position:  0.04509213051144496
Bond Position:  [-5.24934529]


portfolio before change:  [-0.71621914]
curr_Stock_Price:  100.53759251596861
curr_Factors:  [100.53759252]
mat_Sqrt:  [[0.15]]
grads:  [0.18398268]
Stock Position:  0.1839826847888859
Bond Position:  [-19.21339534]


portfolio before change:  [-0.84302063]
curr_Stock_Price:  99.85491623478072
curr_Factors:  [99.85491623]
mat_Sqrt:  [[0.15]]
grads:  [0.00576588]
Stock Position:  0.005765881816026915
Bond Position:  [-1.41877228]


portfolio before change:  [-0.84004347]
curr_Stock_Price:  100.38663775961001
curr_Factors:  [100.38663776]
mat_Sqrt:  [[0.15]]
grads:  [-0.09691852]
Stock Position:  -0.09691852275368165
Bond Position:  [8.88928117]


portfolio before change:  [-0.87711993]
curr_Stock_Price:  100.77492328827853
curr_Factors:  [100.77492329]
mat_Sqrt:  [[0.15]]
grads:  [0.16531149]
Stock Position:  0.16531149229601985
Bond Position:  [-17.53637288]


portfolio before change:  [-0.74555975]
curr_Stock_Price:  101.57738553269465
curr_Factors:  [101.57738553]
mat_Sqrt:  [[0.15]]
grads:  [-0.03037473]
Stock Position:  -0.030374729063240374
Bond Position:  [2.33982581]


portfolio before change:  [-0.75428751]
curr_Stock_Price:  101.86953610796903
curr_Factors:  [101.86953611]
mat_Sqrt:  [[0.15]]
grads:  [0.20542017]
Stock Position:  0.20542016501050014
Bond Position:  [-21.68034442]


portfolio before change:  [-0.65921899]
curr_Stock_Price:  102.3389329424959
curr_Factors:  [102.33893294]
mat_Sqrt:  [[0.15]]
grads:  [-0.08957301]
Stock Position:  -0.08957300977511905
Bond Position:  [8.50758725]


portfolio before change:  [-0.61725315]
curr_Stock_Price:  101.87635936937366
curr_Factors:  [101.87635937]
mat_Sqrt:  [[0.15]]
grads:  [0.39461095]
Stock Position:  0.39461094589202894
Bond Position:  [-40.81877968]


portfolio before change:  [-0.67996104]
curr_Stock_Price:  101.7239139374084
curr_Factors:  [101.72391394]
mat_Sqrt:  [[0.15]]
grads:  [0.04010249]
Stock Position:  0.04010249116634587
Bond Position:  [-4.7593434]


portfolio before change:  [-0.68834822]
curr_Stock_Price:  101.52218785262544
curr_Factors:  [101.52218785]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600575]
Stock Position:  -0.046005747381373086
Bond Position:  [3.98225591]


portfolio before change:  [-0.67154069]
curr_Stock_Price:  101.16226248385873
curr_Factors:  [101.16226248]
mat_Sqrt:  [[0.15]]
grads:  [0.13223253]
Stock Position:  0.13223253239417646
Bond Position:  [-14.04848284]


portfolio before change:  [-0.79098195]
curr_Stock_Price:  100.26563589299273
curr_Factors:  [100.26563589]
mat_Sqrt:  [[0.15]]
grads:  [0.05306783]
Stock Position:  0.05306783400891302
Bond Position:  [-6.11186207]


portfolio before change:  [-0.80096493]
curr_Stock_Price:  100.08471687027081
curr_Factors:  [100.08471687]
mat_Sqrt:  [[0.15]]
grads:  [-0.08240813]
Stock Position:  -0.08240812949655967
Bond Position:  [7.44682937]


portfolio before change:  [-0.74103391]
curr_Stock_Price:  99.36311832565232
curr_Factors:  [99.36311833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00328956]
Stock Position:  -0.0032895618347523045
Bond Position:  [-0.41417278]


portfolio before change:  [-0.74341337]
curr_Stock_Price:  100.07858790907753
curr_Factors:  [100.07858791]
mat_Sqrt:  [[0.15]]
grads:  [0.08031394]
Stock Position:  0.08031394081498887
Bond Position:  [-8.78111916]


portfolio before change:  [-0.65259489]
curr_Stock_Price:  101.21621512269948
curr_Factors:  [101.21621512]
mat_Sqrt:  [[0.15]]
grads:  [0.08358928]
Stock Position:  0.08358927703298509
Bond Position:  [-9.11318513]


portfolio before change:  [-0.72986692]
curr_Stock_Price:  100.29860410442126
curr_Factors:  [100.2986041]
mat_Sqrt:  [[0.15]]
grads:  [-0.05058171]
Stock Position:  -0.050581714652007004
Bond Position:  [4.34340845]


portfolio before change:  [-0.7326061]
curr_Stock_Price:  100.3581245813022
curr_Factors:  [100.35812458]
mat_Sqrt:  [[0.15]]
grads:  [0.04543231]
Stock Position:  0.04543231058695723
Bond Position:  [-5.29210758]


portfolio before change:  [-0.70885313]
curr_Stock_Price:  100.88822595511162
curr_Factors:  [100.88822596]
mat_Sqrt:  [[0.15]]
grads:  [0.17464587]
Stock Position:  0.17464587151322167
Bond Position:  [-18.32856528]


portfolio before change:  [-0.69262314]
curr_Stock_Price:  100.98771623184166
curr_Factors:  [100.98771623]
mat_Sqrt:  [[0.15]]
grads:  [0.0061144]
Stock Position:  0.006114402311176252
Bond Position:  [-1.31010266]


portfolio before change:  [-0.69048273]
curr_Stock_Price:  101.35116899748219
curr_Factors:  [101.351169]
mat_Sqrt:  [[0.15]]
grads:  [0.08112328]
Stock Position:  0.08112328350161725
Bond Position:  [-8.91242234]


portfolio before change:  [-0.71929124]
curr_Stock_Price:  101.00291542385379
curr_Factors:  [101.00291542]
mat_Sqrt:  [[0.15]]
grads:  [-0.03981222]
Stock Position:  -0.03981221996584823
Bond Position:  [3.30185904]


portfolio before change:  [-0.71028323]
curr_Stock_Price:  100.78183649676615
curr_Factors:  [100.7818365]
mat_Sqrt:  [[0.15]]
grads:  [0.04516042]
Stock Position:  0.045160421492580025
Bond Position:  [-5.26163344]


portfolio before change:  [-0.70346746]
curr_Stock_Price:  100.94004206742744
curr_Factors:  [100.94004207]
mat_Sqrt:  [[0.15]]
grads:  [0.07074829]
Stock Position:  0.07074829005044313
Bond Position:  [-7.84480283]


portfolio before change:  [-0.7015497]
curr_Stock_Price:  100.97407934620672
curr_Factors:  [100.97407935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01846345]
Stock Position:  -0.018463447811715956
Bond Position:  [1.16277995]


portfolio before change:  [-0.70202658]
curr_Stock_Price:  101.00384400753309
curr_Factors:  [101.00384401]
mat_Sqrt:  [[0.15]]
grads:  [0.05665073]
Stock Position:  0.05665073386300547
Bond Position:  [-6.42396846]


portfolio before change:  [-0.69255177]
curr_Stock_Price:  101.1781810779783
curr_Factors:  [101.17818108]
mat_Sqrt:  [[0.15]]
grads:  [-0.07827679]
Stock Position:  -0.07827678840575376
Bond Position:  [7.22735131]


portfolio before change:  [-0.7653154]
curr_Stock_Price:  102.11352034013132
curr_Factors:  [102.11352034]
mat_Sqrt:  [[0.15]]
grads:  [0.04197957]
Stock Position:  0.041979566080317554
Bond Position:  [-5.05199667]


portfolio before change:  [-0.77806619]
curr_Stock_Price:  101.81730386658641
curr_Factors:  [101.81730387]
mat_Sqrt:  [[0.15]]
grads:  [0.05507392]
Stock Position:  0.05507391717289564
Bond Position:  [-6.38554395]


portfolio before change:  [-0.76401074]
curr_Stock_Price:  102.07976139846355
curr_Factors:  [102.0797614]
mat_Sqrt:  [[0.15]]
grads:  [0.07271408]
Stock Position:  0.07271408284837383
Bond Position:  [-8.18664697]


portfolio before change:  [-0.75444784]
curr_Stock_Price:  102.21831201077997
curr_Factors:  [102.21831201]
mat_Sqrt:  [[0.15]]
grads:  [0.05678043]
Stock Position:  0.05678043110262532
Bond Position:  [-6.55844766]


portfolio before change:  [-0.72995373]
curr_Stock_Price:  102.6569142891611
curr_Factors:  [102.65691429]
mat_Sqrt:  [[0.15]]
grads:  [-0.22157506]
Stock Position:  -0.22157506351030778
Bond Position:  [22.01625857]


portfolio before change:  [-0.47941368]
curr_Stock_Price:  101.53240150121994
curr_Factors:  [101.5324015]
mat_Sqrt:  [[0.15]]
grads:  [0.06405461]
Stock Position:  0.06405460782180468
Bond Position:  [-6.98303184]


portfolio before change:  [-0.47003365]
curr_Stock_Price:  101.68565332129158
curr_Factors:  [101.68565332]
mat_Sqrt:  [[0.15]]
grads:  [0.02880775]
Stock Position:  0.02880774940654698
Bond Position:  [-3.39936846]


portfolio before change:  [-0.46294319]
curr_Stock_Price:  101.9391589186698
curr_Factors:  [101.93915892]
mat_Sqrt:  [[0.15]]
grads:  [0.13419087]
Stock Position:  0.13419087147254527
Bond Position:  [-14.14224776]


portfolio before change:  [-0.46105562]
curr_Stock_Price:  101.95981225826746
curr_Factors:  [101.95981226]
mat_Sqrt:  [[0.15]]
grads:  [-0.03398785]
Stock Position:  -0.03398784514973215
Bond Position:  [3.00433869]


portfolio before change:  [-0.45846902]
curr_Stock_Price:  101.88923347223127
curr_Factors:  [101.88923347]
mat_Sqrt:  [[0.15]]
grads:  [-0.14154084]
Stock Position:  -0.14154084167307426
Bond Position:  [13.96301885]


portfolio before change:  [-0.36815462]
curr_Stock_Price:  101.25731918509035
curr_Factors:  [101.25731919]
mat_Sqrt:  [[0.15]]
grads:  [0.14981835]
Stock Position:  0.14981835472233285
Bond Position:  [-15.53835959]


portfolio before change:  [-0.41467206]
curr_Stock_Price:  100.95330929508899
curr_Factors:  [100.9533093]
mat_Sqrt:  [[0.15]]
grads:  [0.01794074]
Stock Position:  0.017940743000342485
Bond Position:  [-2.22584944]


portfolio before change:  [-0.39220064]
curr_Stock_Price:  102.21359966346954
curr_Factors:  [102.21359966]
mat_Sqrt:  [[0.15]]
grads:  [-0.02256058]
Stock Position:  -0.022560583868379867
Bond Position:  [1.91379785]


portfolio before change:  [-0.40119867]
curr_Stock_Price:  102.61774029651366
curr_Factors:  [102.6177403]
mat_Sqrt:  [[0.15]]
grads:  [-0.08575787]
Stock Position:  -0.08575786704430387
Bond Position:  [8.39907986]


portfolio before change:  [-0.39451961]
curr_Stock_Price:  102.54597890378537
curr_Factors:  [102.5459789]
mat_Sqrt:  [[0.15]]
grads:  [0.0921537]
Stock Position:  0.0921536986927851
Bond Position:  [-9.84451085]


portfolio before change:  [-0.41894996]
curr_Stock_Price:  102.28755135392836
curr_Factors:  [102.28755135]
mat_Sqrt:  [[0.15]]
grads:  [0.00265368]
Stock Position:  0.0026536816272398726
Bond Position:  [-0.69038856]


portfolio before change:  [-0.41892582]
curr_Stock_Price:  102.31290774056504
curr_Factors:  [102.31290774]
mat_Sqrt:  [[0.15]]
grads:  [-0.02147959]
Stock Position:  -0.02147958734465613
Bond Position:  [1.77871321]


portfolio before change:  [-0.40322161]
curr_Stock_Price:  101.58696094341357
curr_Factors:  [101.58696094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05039041]
Stock Position:  -0.05039040831288248
Bond Position:  [4.71578683]


portfolio before change:  [-0.36343324]
curr_Stock_Price:  100.80320798042861
curr_Factors:  [100.80320798]
mat_Sqrt:  [[0.15]]
grads:  [0.17833464]
Stock Position:  0.1783346395947538
Bond Position:  [-18.340137]


portfolio before change:  [-0.33516965]
curr_Stock_Price:  100.96812198032134
curr_Factors:  [100.96812198]
mat_Sqrt:  [[0.15]]
grads:  [-0.04675077]
Stock Position:  -0.04675077472721037
Bond Position:  [4.38516827]


portfolio before change:  [-0.34512403]
curr_Stock_Price:  101.18690903746291
curr_Factors:  [101.18690904]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046939]
Stock Position:  -0.01046939399899552
Bond Position:  [0.71424158]


portfolio before change:  [-0.33100384]
curr_Stock_Price:  99.84246166192727
curr_Factors:  [99.84246166]
mat_Sqrt:  [[0.15]]
grads:  [0.03614187]
Stock Position:  0.03614186939577441
Bond Position:  [-3.93949705]


portfolio before change:  [-0.35549451]
curr_Stock_Price:  99.1716485335555
curr_Factors:  [99.17164853]
mat_Sqrt:  [[0.15]]
grads:  [0.03780144]
Stock Position:  0.03780143838476225
Bond Position:  [-4.10432547]


portfolio before change:  [-0.36905336]
curr_Stock_Price:  98.81974875915277
curr_Factors:  [98.81974876]
mat_Sqrt:  [[0.15]]
grads:  [-0.02173196]
Stock Position:  -0.021731961780419876
Bond Position:  [1.77849365]


portfolio before change:  [-0.35386336]
curr_Stock_Price:  98.12589351126952
curr_Factors:  [98.12589351]
mat_Sqrt:  [[0.15]]
grads:  [0.0528396]
Stock Position:  0.05283960218474248
Bond Position:  [-5.53879654]


portfolio before change:  [-0.36510046]
curr_Stock_Price:  97.91978085273809
curr_Factors:  [97.91978085]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449876]
Stock Position:  -0.004498763362929202
Bond Position:  [0.07541747]


portfolio before change:  [-0.36696716]
curr_Stock_Price:  98.33576508102335
curr_Factors:  [98.33576508]
mat_Sqrt:  [[0.15]]
grads:  [0.01024289]
Stock Position:  0.01024289462082816
Bond Position:  [-1.37421004]


portfolio before change:  [-0.36776227]
curr_Stock_Price:  98.26652495211934
curr_Factors:  [98.26652495]
mat_Sqrt:  [[0.15]]
grads:  [0.01406884]
Stock Position:  0.014068842540140871
Bond Position:  [-1.75025853]


portfolio before change:  [-0.36130226]
curr_Stock_Price:  98.73347222711212
curr_Factors:  [98.73347223]
mat_Sqrt:  [[0.15]]
grads:  [0.00839843]
Stock Position:  0.008398426670359633
Bond Position:  [-1.19050808]


portfolio before change:  [-0.35987229]
curr_Stock_Price:  98.91259836409633
curr_Factors:  [98.91259836]
mat_Sqrt:  [[0.15]]
grads:  [-0.02395289]
Stock Position:  -0.023952888749221673
Bond Position:  [2.00937018]


portfolio before change:  [-0.36285183]
curr_Stock_Price:  99.04223336004637
curr_Factors:  [99.04223336]
mat_Sqrt:  [[0.15]]
grads:  [0.00054872]
Stock Position:  0.0005487165586836168
Bond Position:  [-0.41719794]


portfolio before change:  [-0.36233444]
curr_Stock_Price:  100.03265767821026
curr_Factors:  [100.03265768]
mat_Sqrt:  [[0.15]]
grads:  [-0.10055088]
Stock Position:  -0.10055087546205942
Bond Position:  [9.69603686]


portfolio before change:  [-0.33458991]
curr_Stock_Price:  99.7627593707251
curr_Factors:  [99.76275937]
mat_Sqrt:  [[0.15]]
grads:  [-0.07683517]
Stock Position:  -0.07683517216081948
Bond Position:  [7.33069888]


portfolio before change:  [-0.3633946]
curr_Stock_Price:  100.14361193773267
curr_Factors:  [100.14361194]
mat_Sqrt:  [[0.15]]
grads:  [0.01124467]
Stock Position:  0.011244668278001108
Bond Position:  [-1.4894763]


portfolio before change:  [-0.36151241]
curr_Stock_Price:  100.3192762132063
curr_Factors:  [100.31927621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03581635]
Stock Position:  -0.035816353013916065
Bond Position:  [3.2315582]


portfolio before change:  [-0.34210164]
curr_Stock_Price:  99.78296291187152
curr_Factors:  [99.78296291]
mat_Sqrt:  [[0.15]]
grads:  [0.16173637]
Stock Position:  0.1617363662757671
Bond Position:  [-16.48063548]


portfolio before change:  [-0.39054906]
curr_Stock_Price:  99.48978612265478
curr_Factors:  [99.48978612]
mat_Sqrt:  [[0.15]]
grads:  [-0.05894535]
Stock Position:  -0.05894534509672698
Bond Position:  [5.47391071]


portfolio before change:  [-0.4127623]
curr_Stock_Price:  99.8724348684739
curr_Factors:  [99.87243487]
mat_Sqrt:  [[0.15]]
grads:  [0.04359758]
Stock Position:  0.04359758369468555
Bond Position:  [-4.76695913]


portfolio before change:  [-0.43568668]
curr_Stock_Price:  99.35345107318224
curr_Factors:  [99.35345107]
mat_Sqrt:  [[0.15]]
grads:  [-0.05893015]
Stock Position:  -0.05893015286155971
Bond Position:  [5.41922738]


portfolio before change:  [-0.43377257]
curr_Stock_Price:  99.32671783429151
curr_Factors:  [99.32671783]
mat_Sqrt:  [[0.15]]
grads:  [0.07148362]
Stock Position:  0.07148361855637443
Bond Position:  [-7.53400578]


portfolio before change:  [-0.45215912]
curr_Stock_Price:  99.07609178062526
curr_Factors:  [99.07609178]
mat_Sqrt:  [[0.15]]
grads:  [-0.03382513]
Stock Position:  -0.03382513081690081
Bond Position:  [2.89910264]


portfolio before change:  [-0.4432647]
curr_Stock_Price:  98.81849556268644
curr_Factors:  [98.81849556]
mat_Sqrt:  [[0.15]]
grads:  [0.05745607]
Stock Position:  0.05745606502387227
Bond Position:  [-6.1209866]


portfolio before change:  [-0.42051038]
curr_Stock_Price:  99.22118401918264
curr_Factors:  [99.22118402]
mat_Sqrt:  [[0.15]]
grads:  [-0.12691955]
Stock Position:  -0.12691955476770855
Bond Position:  [12.17259812]


portfolio before change:  [-0.45909985]
curr_Stock_Price:  99.53122515745754
curr_Factors:  [99.53122516]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844624]
Stock Position:  -0.028446239081228484
Bond Position:  [2.37218918]


portfolio before change:  [-0.46323034]
curr_Stock_Price:  99.68164072134259
curr_Factors:  [99.68164072]
mat_Sqrt:  [[0.15]]
grads:  [-0.03573658]
Stock Position:  -0.03573658275179656
Bond Position:  [3.09905086]


portfolio before change:  [-0.48308189]
curr_Stock_Price:  100.24255735408636
curr_Factors:  [100.24255735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01253637]
Stock Position:  -0.012536368054570425
Bond Position:  [0.77359571]


portfolio before change:  [-0.47286755]
curr_Stock_Price:  99.43163764142305
curr_Factors:  [99.43163764]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.47286755]
Stock Price:  98.72503966872026
PL:  [-0.47286755]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.09204538e-03]
 [-7.06317046e-03]
 [-3.53863475e-03]
 [-2.05898985e-03]
 [ 3.12645544e-02]
 [ 2.71359114e-02]
 [ 2.33025401e-03]
 [ 7.99531189e-04]
 [ 2.44677636e-02]
 [-4.72770900e-03]
 [ 1.65616919e-02]
 [-2.67698319e-02]
 [ 1.25289262e-03]
 [ 3.99568720e-04]
 [-6.90314545e-03]
 [ 2.09442670e-02]
 [ 7.99861552e-03]
 [-8.99057636e-03]
 [ 9.64488004e-04]
 [ 9.98488563e-03]
 [ 1.23681883e-02]
 [-9.94896172e-03]
 [ 4.57153637e-03]
 [-6.61086384e-03]
 [-8.87534298e-03]
 [-6.78502953e-03]
 [-3.62028426e-03]
 [ 7.04682431e-03]
 [-2.02333298e-02]
 [ 5.18918450e-04]
 [ 1.66963661e-03]
 [-1.00509096e-02]
 [-7.66196386e-03]
 [ 5.55869558e-03]
 [ 1.37851972e-02]
 [ 1.29855836e-02]
 [-3.39882769e-02]
 [ 8.23373956e-03]
 [-3.69843832e-02]
 [ 1.04157854e-02]
 [-1.19910669e-02]
 [ 3.85929135e-02]
 [ 2.30768397e-02]
 [ 4.20967286e-03]
 [ 2.89960684e-03]
 [ 5.25223020e-03]
 [ 1.91248197e-03]
 [-1.19418138e-02]
 [ 1.31393272e-03]
 [ 1.41721468e-03]
 [ 3.99987768e-02]
 [-3.36550346e-03]
 [ 2.00635525e-03]
 [ 4.93668778e-03]
 [ 4.49929606e-03]
 [-1.71692384e-03]
 [ 3.19495893e-03]
 [-5.63843530e-04]
 [ 1.55292870e-03]
 [-3.91068363e-02]
 [-9.53020866e-03]
 [ 1.17524093e-02]
 [ 1.47164514e-02]
 [-1.86747512e-02]
 [-6.72679659e-03]
 [-1.27740079e-02]
 [-4.65560484e-03]
 [ 9.68432132e-03]
 [-1.32574508e-02]
 [ 1.17709083e-02]
 [ 5.66666516e-03]
 [ 1.23254398e-02]
 [ 3.12134366e-03]
 [ 5.20329408e-04]
 [ 5.09492331e-03]
 [-1.62612919e-02]
 [ 4.96191777e-03]
 [ 4.59697610e-03]
 [-5.77776951e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.71968487]
curr_Stock_Price:  101.53966800704622
curr_Factors:  [101.53966801]
mat_Sqrt:  [[0.15]]
grads:  [0.0072803]
Stock Position:  0.007280302508053463
Bond Position:  [24.98044537]


portfolio before change:  [25.72391974]
curr_Stock_Price:  101.90689790283803
curr_Factors:  [101.9068979]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470878]
Stock Position:  -0.047087803096649
Bond Position:  [30.52249168]


portfolio before change:  [25.71418951]
curr_Stock_Price:  102.1540520461134
curr_Factors:  [102.15405205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0235909]
Stock Position:  -0.02359089834600981
Bond Position:  [28.12409537]


portfolio before change:  [25.71376545]
curr_Stock_Price:  102.24653989299333
curr_Factors:  [102.24653989]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137266]
Stock Position:  -0.01372659898042338
Bond Position:  [27.1172627]


portfolio before change:  [25.71799864]
curr_Stock_Price:  102.06162082787064
curr_Factors:  [102.06162083]
mat_Sqrt:  [[0.15]]
grads:  [0.20843036]
Stock Position:  0.20843036286843794
Bond Position:  [4.44525798]


portfolio before change:  [25.65301471]
curr_Stock_Price:  101.74851017409567
curr_Factors:  [101.74851017]
mat_Sqrt:  [[0.15]]
grads:  [0.18090608]
Stock Position:  0.18090607584785728
Bond Position:  [7.24609101]


portfolio before change:  [25.61442701]
curr_Stock_Price:  101.53270428485888
curr_Factors:  [101.53270428]
mat_Sqrt:  [[0.15]]
grads:  [0.01553503]
Stock Position:  0.01553502671140622
Bond Position:  [24.03711374]


portfolio before change:  [25.61370732]
curr_Stock_Price:  101.3896689233162
curr_Factors:  [101.38966892]
mat_Sqrt:  [[0.15]]
grads:  [0.00533021]
Stock Position:  0.005330207927432065
Bond Position:  [25.0732793]


portfolio before change:  [25.61241783]
curr_Stock_Price:  100.8537383604346
curr_Factors:  [100.85373836]
mat_Sqrt:  [[0.15]]
grads:  [0.16311842]
Stock Position:  0.1631184241012322
Bond Position:  [9.16131496]


portfolio before change:  [25.66364895]
curr_Stock_Price:  101.16430122807904
curr_Factors:  [101.16430123]
mat_Sqrt:  [[0.15]]
grads:  [-0.03151806]
Stock Position:  -0.03151805999901868
Bond Position:  [28.85215147]


portfolio before change:  [25.67270633]
curr_Stock_Price:  100.93414556295467
curr_Factors:  [100.93414556]
mat_Sqrt:  [[0.15]]
grads:  [0.11041128]
Stock Position:  0.1104112796077673
Bond Position:  [14.52843816]


portfolio before change:  [25.6645609]
curr_Stock_Price:  100.85214772385552
curr_Factors:  [100.85214772]
mat_Sqrt:  [[0.15]]
grads:  [-0.17846555]
Stock Position:  -0.1784655458776106
Bond Position:  [43.66319449]


portfolio before change:  [25.77772211]
curr_Stock_Price:  100.23336062120853
curr_Factors:  [100.23336062]
mat_Sqrt:  [[0.15]]
grads:  [0.00835262]
Stock Position:  0.0083526174667687
Bond Position:  [24.94051119]


portfolio before change:  [25.78220115]
curr_Stock_Price:  100.58297703093832
curr_Factors:  [100.58297703]
mat_Sqrt:  [[0.15]]
grads:  [0.00266379]
Stock Position:  0.002663791468648126
Bond Position:  [25.51426908]


portfolio before change:  [25.78570651]
curr_Stock_Price:  101.30024914291256
curr_Factors:  [101.30024914]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602097]
Stock Position:  -0.04602096968568077
Bond Position:  [30.4476422]


portfolio before change:  [25.7836916]
curr_Stock_Price:  101.38538300524985
curr_Factors:  [101.38538301]
mat_Sqrt:  [[0.15]]
grads:  [0.13962845]
Stock Position:  0.13962844684354586
Bond Position:  [11.62740804]


portfolio before change:  [25.62953973]
curr_Stock_Price:  100.27616344026382
curr_Factors:  [100.27616344]
mat_Sqrt:  [[0.15]]
grads:  [0.0533241]
Stock Position:  0.05332410346131641
Bond Position:  [20.28240322]


portfolio before change:  [25.55434861]
curr_Stock_Price:  98.84231252465338
curr_Factors:  [98.84231252]
mat_Sqrt:  [[0.15]]
grads:  [-0.05993718]
Stock Position:  -0.05993717570297134
Bond Position:  [31.47867766]


portfolio before change:  [25.57495109]
curr_Stock_Price:  98.53140362771049
curr_Factors:  [98.53140363]
mat_Sqrt:  [[0.15]]
grads:  [0.00642992]
Stock Position:  0.006429920028423606
Bond Position:  [24.94140204]


portfolio before change:  [25.57499314]
curr_Stock_Price:  98.29550044566058
curr_Factors:  [98.29550045]
mat_Sqrt:  [[0.15]]
grads:  [0.0665659]
Stock Position:  0.06656590419176495
Bond Position:  [19.03186427]


portfolio before change:  [25.55071726]
curr_Stock_Price:  97.91294114743766
curr_Factors:  [97.91294115]
mat_Sqrt:  [[0.15]]
grads:  [0.08245459]
Stock Position:  0.08245458892759408
Bond Position:  [17.47734595]


portfolio before change:  [25.51438734]
curr_Stock_Price:  97.45908778774516
curr_Factors:  [97.45908779]
mat_Sqrt:  [[0.15]]
grads:  [-0.06632641]
Stock Position:  -0.06632641144350364
Bond Position:  [31.97849889]


portfolio before change:  [25.52235762]
curr_Stock_Price:  97.36905474202355
curr_Factors:  [97.36905474]
mat_Sqrt:  [[0.15]]
grads:  [0.03047691]
Stock Position:  0.030476909131349726
Bond Position:  [22.55484979]


portfolio before change:  [25.5370373]
curr_Stock_Price:  97.80446488874108
curr_Factors:  [97.80446489]
mat_Sqrt:  [[0.15]]
grads:  [-0.04407243]
Stock Position:  -0.04407242557687402
Bond Position:  [29.8475173]


portfolio before change:  [25.52945738]
curr_Stock_Price:  98.0187813835416
curr_Factors:  [98.01878138]
mat_Sqrt:  [[0.15]]
grads:  [-0.05916895]
Stock Position:  -0.05916895321482675
Bond Position:  [31.32912607]


portfolio before change:  [25.56201977]
curr_Stock_Price:  97.5015462678081
curr_Factors:  [97.50154627]
mat_Sqrt:  [[0.15]]
grads:  [-0.04523353]
Stock Position:  -0.04523353016746254
Bond Position:  [29.97235891]


portfolio before change:  [25.53249569]
curr_Stock_Price:  98.19566431785678
curr_Factors:  [98.19566432]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413523]
Stock Position:  -0.024135228403788112
Bond Position:  [27.90247048]


portfolio before change:  [25.52601677]
curr_Stock_Price:  98.53636491299396
curr_Factors:  [98.53636491]
mat_Sqrt:  [[0.15]]
grads:  [0.04697883]
Stock Position:  0.04697882876341451
Bond Position:  [20.89689375]


portfolio before change:  [25.50038128]
curr_Stock_Price:  97.96288136052677
curr_Factors:  [97.96288136]
mat_Sqrt:  [[0.15]]
grads:  [-0.13488887]
Stock Position:  -0.13488886524460977
Bond Position:  [38.71448318]


portfolio before change:  [25.48331995]
curr_Stock_Price:  98.1073043800712
curr_Factors:  [98.10730438]
mat_Sqrt:  [[0.15]]
grads:  [0.00345946]
Stock Position:  0.003459456335528832
Bond Position:  [25.14392202]


portfolio before change:  [25.48291137]
curr_Stock_Price:  97.53492300032786
curr_Factors:  [97.534923]
mat_Sqrt:  [[0.15]]
grads:  [0.01113091]
Stock Position:  0.011130910701202403
Bond Position:  [24.39725885]


portfolio before change:  [25.47899269]
curr_Stock_Price:  97.04587421782722
curr_Factors:  [97.04587422]
mat_Sqrt:  [[0.15]]
grads:  [-0.06700606]
Stock Position:  -0.06700606431607109
Bond Position:  [31.98165477]


portfolio before change:  [25.51276899]
curr_Stock_Price:  96.57162770848362
curr_Factors:  [96.57162771]
mat_Sqrt:  [[0.15]]
grads:  [-0.05107976]
Stock Position:  -0.0510797590986479
Bond Position:  [30.44562447]


portfolio before change:  [25.48578099]
curr_Stock_Price:  97.13723168966638
curr_Factors:  [97.13723169]
mat_Sqrt:  [[0.15]]
grads:  [0.03705797]
Stock Position:  0.037057970523303035
Bond Position:  [21.88607232]


portfolio before change:  [25.48775468]
curr_Stock_Price:  97.1535783033496
curr_Factors:  [97.1535783]
mat_Sqrt:  [[0.15]]
grads:  [0.09190131]
Stock Position:  0.09190131482718246
Bond Position:  [16.5592131]


portfolio before change:  [25.48760794]
curr_Stock_Price:  97.14071960854037
curr_Factors:  [97.14071961]
mat_Sqrt:  [[0.15]]
grads:  [0.08657056]
Stock Position:  0.08657055731914584
Bond Position:  [17.0780817]


portfolio before change:  [25.46991956]
curr_Stock_Price:  96.92406637925194
curr_Factors:  [96.92406638]
mat_Sqrt:  [[0.15]]
grads:  [-0.22658851]
Stock Position:  -0.22658851299685281
Bond Position:  [47.43179963]


portfolio before change:  [25.56974553]
curr_Stock_Price:  96.49658932500313
curr_Factors:  [96.49658933]
mat_Sqrt:  [[0.15]]
grads:  [0.0548916]
Stock Position:  0.05489159706690394
Bond Position:  [20.27289363]


portfolio before change:  [25.54339889]
curr_Stock_Price:  95.99352994789776
curr_Factors:  [95.99352995]
mat_Sqrt:  [[0.15]]
grads:  [-0.24656255]
Stock Position:  -0.2465625547003296
Bond Position:  [49.21180887]


portfolio before change:  [25.40734511]
curr_Stock_Price:  96.55780709259798
curr_Factors:  [96.55780709]
mat_Sqrt:  [[0.15]]
grads:  [0.06943857]
Stock Position:  0.0694385695935851
Bond Position:  [18.7025091]


portfolio before change:  [25.39760112]
curr_Stock_Price:  96.40064759719985
curr_Factors:  [96.4006476]
mat_Sqrt:  [[0.15]]
grads:  [-0.07994045]
Stock Position:  -0.079940446167781
Bond Position:  [33.1039119]


portfolio before change:  [25.40620353]
curr_Stock_Price:  96.31891987361372
curr_Factors:  [96.31891987]
mat_Sqrt:  [[0.15]]
grads:  [0.25728609]
Stock Position:  0.2572860899237275
Bond Position:  [0.62468525]


portfolio before change:  [25.68357669]
curr_Stock_Price:  97.39684100875904
curr_Factors:  [97.39684101]
mat_Sqrt:  [[0.15]]
grads:  [0.1538456]
Stock Position:  0.1538455977236387
Bond Position:  [10.69950147]


portfolio before change:  [25.68710081]
curr_Stock_Price:  97.41540103738141
curr_Factors:  [97.41540104]
mat_Sqrt:  [[0.15]]
grads:  [0.02806449]
Stock Position:  0.028064485756994086
Bond Position:  [22.95318768]


portfolio before change:  [25.68170905]
curr_Stock_Price:  97.17216189795678
curr_Factors:  [97.1721619]
mat_Sqrt:  [[0.15]]
grads:  [0.01933071]
Stock Position:  0.0193307122978149
Bond Position:  [23.80330194]


portfolio before change:  [25.67610796]
curr_Stock_Price:  96.80544799661376
curr_Factors:  [96.805448]
mat_Sqrt:  [[0.15]]
grads:  [0.03501487]
Stock Position:  0.035014868002799585
Bond Position:  [22.28647798]


portfolio before change:  [25.70144064]
curr_Stock_Price:  97.4891497726241
curr_Factors:  [97.48914977]
mat_Sqrt:  [[0.15]]
grads:  [0.01274988]
Stock Position:  0.012749879775865459
Bond Position:  [24.4584657]


portfolio before change:  [25.69734168]
curr_Stock_Price:  97.04776067848769
curr_Factors:  [97.04776068]
mat_Sqrt:  [[0.15]]
grads:  [-0.07961209]
Stock Position:  -0.079612091690744
Bond Position:  [33.4235169]


portfolio before change:  [25.72593682]
curr_Stock_Price:  96.71481998251889
curr_Factors:  [96.71481998]
mat_Sqrt:  [[0.15]]
grads:  [0.00875955]
Stock Position:  0.008759551456129373
Bond Position:  [24.87875838]


portfolio before change:  [25.72619443]
curr_Stock_Price:  96.56671143581652
curr_Factors:  [96.56671144]
mat_Sqrt:  [[0.15]]
grads:  [0.0094481]
Stock Position:  0.009448097881337587
Bond Position:  [24.81382269]


portfolio before change:  [25.72842871]
curr_Stock_Price:  96.63904011249774
curr_Factors:  [96.63904011]
mat_Sqrt:  [[0.15]]
grads:  [0.26665851]
Stock Position:  0.2666585120896789
Bond Position:  [-0.04119394]


portfolio before change:  [25.73504534]
curr_Stock_Price:  96.66386288059196
curr_Factors:  [96.66386288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243669]
Stock Position:  -0.02243668976056431
Bond Position:  [27.90386244]


portfolio before change:  [25.74353747]
curr_Stock_Price:  96.363101696349
curr_Factors:  [96.3631017]
mat_Sqrt:  [[0.15]]
grads:  [0.0133757]
Stock Position:  0.013375701667112747
Bond Position:  [24.45461337]


portfolio before change:  [25.74830215]
curr_Stock_Price:  96.60504930346936
curr_Factors:  [96.6050493]
mat_Sqrt:  [[0.15]]
grads:  [0.03291125]
Stock Position:  0.032911251857560206
Bond Position:  [22.56890904]


portfolio before change:  [25.76577146]
curr_Stock_Price:  97.0929890907336
curr_Factors:  [97.09298909]
mat_Sqrt:  [[0.15]]
grads:  [0.02999531]
Stock Position:  0.02999530709966218
Bond Position:  [22.85343743]


portfolio before change:  [25.78261015]
curr_Stock_Price:  97.60674649903133
curr_Factors:  [97.6067465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144616]
Stock Position:  -0.011446158913027936
Bond Position:  [26.89983248]


portfolio before change:  [25.78715104]
curr_Stock_Price:  97.35691597337578
curr_Factors:  [97.35691597]
mat_Sqrt:  [[0.15]]
grads:  [0.02129973]
Stock Position:  0.021299726179510387
Bond Position:  [23.71347539]


portfolio before change:  [25.78036025]
curr_Stock_Price:  96.96851023372042
curr_Factors:  [96.96851023]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375896]
Stock Position:  -0.0037589568693167526
Bond Position:  [26.1448607]


portfolio before change:  [25.78414481]
curr_Stock_Price:  96.39642140780053
curr_Factors:  [96.39642141]
mat_Sqrt:  [[0.15]]
grads:  [0.01035286]
Stock Position:  0.010352857968733606
Bond Position:  [24.78616635]


portfolio before change:  [25.77979513]
curr_Stock_Price:  95.82664060616385
curr_Factors:  [95.82664061]
mat_Sqrt:  [[0.15]]
grads:  [-0.26071224]
Stock Position:  -0.2607122419537665
Bond Position:  [50.76297344]


portfolio before change:  [25.79330381]
curr_Stock_Price:  95.78699579030811
curr_Factors:  [95.78699579]
mat_Sqrt:  [[0.15]]
grads:  [-0.06353472]
Stock Position:  -0.06353472439675721
Bond Position:  [31.87910419]


portfolio before change:  [25.75416111]
curr_Stock_Price:  96.4344402601147
curr_Factors:  [96.43444026]
mat_Sqrt:  [[0.15]]
grads:  [0.0783494]
Stock Position:  0.07834939546246068
Bond Position:  [18.19858101]


portfolio before change:  [25.73856476]
curr_Stock_Price:  96.22086109857968
curr_Factors:  [96.2208611]
mat_Sqrt:  [[0.15]]
grads:  [0.09810968]
Stock Position:  0.09810967629759693
Bond Position:  [16.29836722]


portfolio before change:  [25.78305353]
curr_Stock_Price:  96.66393757434817
curr_Factors:  [96.66393757]
mat_Sqrt:  [[0.15]]
grads:  [-0.12449834]
Stock Position:  -0.12449834147920429
Bond Position:  [37.81755343]


portfolio before change:  [25.77481736]
curr_Stock_Price:  96.74907795536411
curr_Factors:  [96.74907796]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484531]
Stock Position:  -0.04484531057063
Bond Position:  [30.11355981]


portfolio before change:  [25.78436654]
curr_Stock_Price:  96.57811193521634
curr_Factors:  [96.57811194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08516005]
Stock Position:  -0.08516005283132509
Bond Position:  [34.00896366]


portfolio before change:  [25.81194948]
curr_Stock_Price:  96.27917705382302
curr_Factors:  [96.27917705]
mat_Sqrt:  [[0.15]]
grads:  [-0.03103737]
Stock Position:  -0.03103736559709383
Bond Position:  [28.8002015]


portfolio before change:  [25.81614986]
curr_Stock_Price:  96.20184084344163
curr_Factors:  [96.20184084]
mat_Sqrt:  [[0.15]]
grads:  [0.06456214]
Stock Position:  0.0645621421622227
Bond Position:  [19.60515293]


portfolio before change:  [25.80670787]
curr_Stock_Price:  96.03661478596533
curr_Factors:  [96.03661479]
mat_Sqrt:  [[0.15]]
grads:  [-0.08838301]
Stock Position:  -0.08838300518703426
Bond Position:  [34.29471249]


portfolio before change:  [25.86196167]
curr_Stock_Price:  95.4357038645012
curr_Factors:  [95.43570386]
mat_Sqrt:  [[0.15]]
grads:  [0.07847272]
Stock Position:  0.07847272211986214
Bond Position:  [18.3728622]


portfolio before change:  [25.81390444]
curr_Stock_Price:  94.80866340763373
curr_Factors:  [94.80866341]
mat_Sqrt:  [[0.15]]
grads:  [0.03777777]
Stock Position:  0.03777776771296209
Bond Position:  [22.23224478]


portfolio before change:  [25.81142428]
curr_Stock_Price:  94.70622960894435
curr_Factors:  [94.70622961]
mat_Sqrt:  [[0.15]]
grads:  [0.0821696]
Stock Position:  0.08216959833744648
Bond Position:  [18.02945143]


portfolio before change:  [25.88213889]
curr_Stock_Price:  95.55310895395152
curr_Factors:  [95.55310895]
mat_Sqrt:  [[0.15]]
grads:  [0.02080896]
Stock Position:  0.020808957760303018
Bond Position:  [23.89377828]


portfolio before change:  [25.8940958]
curr_Stock_Price:  96.05594553124192
curr_Factors:  [96.05594553]
mat_Sqrt:  [[0.15]]
grads:  [0.00346886]
Stock Position:  0.0034688627187333646
Bond Position:  [25.56089091]


portfolio before change:  [25.89257613]
curr_Stock_Price:  95.1573013927632
curr_Factors:  [95.15730139]
mat_Sqrt:  [[0.15]]
grads:  [0.03396616]
Stock Position:  0.03396615537354798
Bond Position:  [22.66044845]


portfolio before change:  [25.90087079]
curr_Stock_Price:  95.35980698855464
curr_Factors:  [95.35980699]
mat_Sqrt:  [[0.15]]
grads:  [-0.10840861]
Stock Position:  -0.10840861260932588
Bond Position:  [36.23869517]


portfolio before change:  [25.80571568]
curr_Stock_Price:  96.25844505823616
curr_Factors:  [96.25844506]
mat_Sqrt:  [[0.15]]
grads:  [0.03307945]
Stock Position:  0.03307945183020544
Bond Position:  [22.62153908]


portfolio before change:  [25.82004696]
curr_Stock_Price:  96.64894096612072
curr_Factors:  [96.64894097]
mat_Sqrt:  [[0.15]]
grads:  [0.03064651]
Stock Position:  0.030646507315446027
Bond Position:  [22.85809448]


portfolio before change:  [25.8205582]
curr_Stock_Price:  96.61900495057341
curr_Factors:  [96.61900495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.8205582]
Stock Price:  96.9098578049102
PL:  [25.8205582]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.91804632e-03]
 [-1.22749286e-03]
 [ 4.62775400e-04]
 [ 8.40847847e-03]
 [ 4.88331935e-03]
 [ 2.63493765e-02]
 [ 1.32994583e-03]
 [ 9.11663660e-03]
 [ 2.44339814e-02]
 [-4.87758715e-03]
 [ 2.03240352e-02]
 [-4.75709292e-02]
 [ 2.95725063e-02]
 [ 3.16462447e-03]
 [-6.90677804e-03]
 [ 2.21817828e-02]
 [ 1.09446856e-02]
 [-9.13988060e-03]
 [ 1.28898222e-03]
 [-3.47248028e-03]
 [ 1.21936647e-02]
 [-7.89687078e-03]
 [ 6.82530536e-03]
 [ 3.83396264e-02]
 [-3.69856536e-04]
 [ 1.36801452e-02]
 [-7.03392532e-03]
 [ 6.17893900e-03]
 [ 3.80238330e-03]
 [-1.90175790e-03]
 [ 7.25598876e-03]
 [-1.17378924e-02]
 [ 9.31100918e-03]
 [ 7.27200970e-03]
 [ 1.10309950e-02]
 [ 9.27459561e-03]
 [-3.44000772e-02]
 [ 9.69906220e-03]
 [-3.85974005e-03]
 [ 2.13827497e-02]
 [-5.82384451e-03]
 [-1.49189134e-02]
 [ 2.34802841e-02]
 [ 4.11424784e-03]
 [-8.17835635e-03]
 [-5.74746059e-03]
 [ 1.72638521e-03]
 [-1.24149324e-02]
 [-1.24307905e-02]
 [-5.12418652e-03]
 [ 4.70190149e-02]
 [-1.04820268e-02]
 [ 3.54679893e-03]
 [ 5.26252430e-03]
 [ 5.57475184e-03]
 [-2.97922050e-03]
 [ 7.47440972e-03]
 [-5.70692421e-04]
 [ 1.52974664e-03]
 [-3.32164620e-03]
 [-4.28408563e-03]
 [ 1.26015224e-02]
 [ 1.44354127e-02]
 [-1.85666542e-02]
 [-9.65084963e-03]
 [-1.33628606e-04]
 [-5.06510042e-03]
 [ 2.36154893e-02]
 [-8.24813882e-03]
 [ 7.09657568e-03]
 [-9.99689667e-03]
 [ 1.10761839e-02]
 [-8.36435733e-03]
 [ 1.59097450e-02]
 [-2.24884355e-02]
 [-4.34145509e-03]
 [-1.01040899e-02]
 [-1.52093204e-03]
 [ 2.94156475e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.52461929]
curr_Stock_Price:  99.83313320795625
curr_Factors:  [99.83313321]
mat_Sqrt:  [[0.15]]
grads:  [0.01945364]
Stock Position:  0.019453642150207635
Bond Position:  [-2.46673734]


portfolio before change:  [-0.52967612]
curr_Stock_Price:  99.58111601430907
curr_Factors:  [99.58111601]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818329]
Stock Position:  -0.008183285731617454
Bond Position:  [0.28522461]


portfolio before change:  [-0.53237906]
curr_Stock_Price:  99.91359539841933
curr_Factors:  [99.9135954]
mat_Sqrt:  [[0.15]]
grads:  [0.00308517]
Stock Position:  0.0030851693328895306
Bond Position:  [-0.84062942]


portfolio before change:  [-0.53306359]
curr_Stock_Price:  99.70874764512776
curr_Factors:  [99.70874765]
mat_Sqrt:  [[0.15]]
grads:  [0.05605652]
Stock Position:  0.056056523121364214
Bond Position:  [-6.12238931]


portfolio before change:  [-0.51727809]
curr_Stock_Price:  99.99717375183134
curr_Factors:  [99.99717375]
mat_Sqrt:  [[0.15]]
grads:  [0.03255546]
Stock Position:  0.03255546234965838
Bond Position:  [-3.77273232]


portfolio before change:  [-0.50670241]
curr_Stock_Price:  100.3292682000636
curr_Factors:  [100.3292682]
mat_Sqrt:  [[0.15]]
grads:  [0.17566251]
Stock Position:  0.17566251032378166
Bond Position:  [-18.13079352]


portfolio before change:  [-0.37910529]
curr_Stock_Price:  101.06209577021217
curr_Factors:  [101.06209577]
mat_Sqrt:  [[0.15]]
grads:  [0.00886631]
Stock Position:  0.008866305515560906
Bond Position:  [-1.2751527]


portfolio before change:  [-0.37243367]
curr_Stock_Price:  101.82355350797727
curr_Factors:  [101.82355351]
mat_Sqrt:  [[0.15]]
grads:  [0.06077758]
Stock Position:  0.06077757730231857
Bond Position:  [-6.56102256]


portfolio before change:  [-0.38732366]
curr_Stock_Price:  101.58530920137628
curr_Factors:  [101.5853092]
mat_Sqrt:  [[0.15]]
grads:  [0.16289321]
Stock Position:  0.1628932090556668
Bond Position:  [-16.93488066]


portfolio before change:  [-0.48584279]
curr_Stock_Price:  100.98699897805794
curr_Factors:  [100.98699898]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251725]
Stock Position:  -0.03251724769896068
Bond Position:  [2.79797647]


portfolio before change:  [-0.49162304]
curr_Stock_Price:  101.17013644941109
curr_Factors:  [101.17013645]
mat_Sqrt:  [[0.15]]
grads:  [0.13549357]
Stock Position:  0.13549356774210478
Bond Position:  [-14.19952578]


portfolio before change:  [-0.46954483]
curr_Stock_Price:  101.33963312107998
curr_Factors:  [101.33963312]
mat_Sqrt:  [[0.15]]
grads:  [-0.31713953]
Stock Position:  -0.3171395281462338
Bond Position:  [31.6692586]


portfolio before change:  [-0.39756968]
curr_Stock_Price:  101.11892347070004
curr_Factors:  [101.11892347]
mat_Sqrt:  [[0.15]]
grads:  [0.19715004]
Stock Position:  0.19715004206451708
Bond Position:  [-20.3331697]


portfolio before change:  [-0.38609546]
curr_Stock_Price:  101.18357008462738
curr_Factors:  [101.18357008]
mat_Sqrt:  [[0.15]]
grads:  [0.0210975]
Stock Position:  0.02109749648773218
Bond Position:  [-2.52081548]


portfolio before change:  [-0.38866241]
curr_Stock_Price:  101.06936727480904
curr_Factors:  [101.06936727]
mat_Sqrt:  [[0.15]]
grads:  [-0.04604519]
Stock Position:  -0.04604518690026003
Bond Position:  [4.26509549]


portfolio before change:  [-0.40964151]
curr_Stock_Price:  101.53077655512845
curr_Factors:  [101.53077656]
mat_Sqrt:  [[0.15]]
grads:  [0.14787855]
Stock Position:  0.14787855230688693
Bond Position:  [-15.42386576]


portfolio before change:  [-0.33736978]
curr_Stock_Price:  102.02601914697198
curr_Factors:  [102.02601915]
mat_Sqrt:  [[0.15]]
grads:  [0.07296457]
Stock Position:  0.07296457056814998
Bond Position:  [-7.78165445]


portfolio before change:  [-0.3137981]
curr_Stock_Price:  102.3557413851174
curr_Factors:  [102.35574139]
mat_Sqrt:  [[0.15]]
grads:  [-0.06093254]
Stock Position:  -0.0609325373319107
Bond Position:  [5.92299693]


portfolio before change:  [-0.27250618]
curr_Stock_Price:  101.68415063091219
curr_Factors:  [101.68415063]
mat_Sqrt:  [[0.15]]
grads:  [0.00859321]
Stock Position:  0.008593214825833622
Bond Position:  [-1.14629993]


portfolio before change:  [-0.27612929]
curr_Stock_Price:  101.27086333274231
curr_Factors:  [101.27086333]
mat_Sqrt:  [[0.15]]
grads:  [-0.02314987]
Stock Position:  -0.023149868546996622
Bond Position:  [2.06827788]


portfolio before change:  [-0.26647182]
curr_Stock_Price:  100.85927574438891
curr_Factors:  [100.85927574]
mat_Sqrt:  [[0.15]]
grads:  [0.0812911]
Stock Position:  0.08129109803847741
Bond Position:  [-8.46543309]


portfolio before change:  [-0.32485916]
curr_Stock_Price:  100.14753446494541
curr_Factors:  [100.14753446]
mat_Sqrt:  [[0.15]]
grads:  [-0.05264581]
Stock Position:  -0.05264580518426117
Bond Position:  [4.94748843]


portfolio before change:  [-0.32997635]
curr_Stock_Price:  100.25060867575863
curr_Factors:  [100.25060868]
mat_Sqrt:  [[0.15]]
grads:  [0.04550204]
Stock Position:  0.04550203571995353
Bond Position:  [-4.89158313]


portfolio before change:  [-0.35744129]
curr_Stock_Price:  99.65372969012408
curr_Factors:  [99.65372969]
mat_Sqrt:  [[0.15]]
grads:  [0.25559751]
Stock Position:  0.2555975095662127
Bond Position:  [-25.82868642]


portfolio before change:  [-0.14536802]
curr_Stock_Price:  100.48976137654297
curr_Factors:  [100.48976138]
mat_Sqrt:  [[0.15]]
grads:  [-0.00246571]
Stock Position:  -0.002465710237239208
Bond Position:  [0.10241061]


portfolio before change:  [-0.146319]
curr_Stock_Price:  100.8780389815361
curr_Factors:  [100.87803898]
mat_Sqrt:  [[0.15]]
grads:  [0.09120097]
Stock Position:  0.09120096781418173
Bond Position:  [-9.34649379]


portfolio before change:  [-0.20953194]
curr_Stock_Price:  100.19132739160744
curr_Factors:  [100.19132739]
mat_Sqrt:  [[0.15]]
grads:  [-0.04689284]
Stock Position:  -0.0468928354472342
Bond Position:  [4.48872349]


portfolio before change:  [-0.22258857]
curr_Stock_Price:  100.47574593760632
curr_Factors:  [100.47574594]
mat_Sqrt:  [[0.15]]
grads:  [0.04119293]
Stock Position:  0.041192926653894124
Bond Position:  [-4.36147861]


portfolio before change:  [-0.22663176]
curr_Stock_Price:  100.38421106467032
curr_Factors:  [100.38421106]
mat_Sqrt:  [[0.15]]
grads:  [0.02534922]
Stock Position:  0.02534922198710883
Bond Position:  [-2.77129341]


portfolio before change:  [-0.19905846]
curr_Stock_Price:  101.47878165073243
curr_Factors:  [101.47878165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01267839]
Stock Position:  -0.012678386023283592
Bond Position:  [1.0875287]


portfolio before change:  [-0.19011202]
curr_Stock_Price:  100.77849752829322
curr_Factors:  [100.77849753]
mat_Sqrt:  [[0.15]]
grads:  [0.04837326]
Stock Position:  0.048373258428995966
Bond Position:  [-5.06509632]


portfolio before change:  [-0.17087492]
curr_Stock_Price:  101.18272250354232
curr_Factors:  [101.1827225]
mat_Sqrt:  [[0.15]]
grads:  [-0.07825262]
Stock Position:  -0.07825261609633191
Bond Position:  [7.74693782]


portfolio before change:  [-0.1634267]
curr_Stock_Price:  101.09372839656676
curr_Factors:  [101.0937284]
mat_Sqrt:  [[0.15]]
grads:  [0.06207339]
Stock Position:  0.062073394513713194
Bond Position:  [-6.43865758]


portfolio before change:  [-0.17553636]
curr_Stock_Price:  100.90512533278226
curr_Factors:  [100.90512533]
mat_Sqrt:  [[0.15]]
grads:  [0.04848006]
Stock Position:  0.04848006468785545
Bond Position:  [-5.06742336]


portfolio before change:  [-0.13194643]
curr_Stock_Price:  101.81078932214778
curr_Factors:  [101.81078932]
mat_Sqrt:  [[0.15]]
grads:  [0.07353997]
Stock Position:  0.07353996656064724
Bond Position:  [-7.61910847]


portfolio before change:  [-0.19651111]
curr_Stock_Price:  100.93931128350071
curr_Factors:  [100.93931128]
mat_Sqrt:  [[0.15]]
grads:  [0.06183064]
Stock Position:  0.061830637377988586
Bond Position:  [-6.43765306]


portfolio before change:  [-0.23168911]
curr_Stock_Price:  100.37687756824049
curr_Factors:  [100.37687757]
mat_Sqrt:  [[0.15]]
grads:  [-0.22933385]
Stock Position:  -0.229333848021789
Bond Position:  [22.78812648]


portfolio before change:  [-0.18024232]
curr_Stock_Price:  100.15875677045945
curr_Factors:  [100.15875677]
mat_Sqrt:  [[0.15]]
grads:  [0.06466041]
Stock Position:  0.06466041469085423
Bond Position:  [-6.65654907]


portfolio before change:  [-0.16103367]
curr_Stock_Price:  100.46226081240636
curr_Factors:  [100.46226081]
mat_Sqrt:  [[0.15]]
grads:  [-0.0257316]
Stock Position:  -0.02573160033876698
Bond Position:  [2.42402107]


portfolio before change:  [-0.16463744]
curr_Stock_Price:  100.60820075951034
curr_Factors:  [100.60820076]
mat_Sqrt:  [[0.15]]
grads:  [0.14255166]
Stock Position:  0.14255166434036326
Bond Position:  [-14.5065039]


portfolio before change:  [-0.14623145]
curr_Stock_Price:  100.74367919569048
curr_Factors:  [100.7436792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03882563]
Stock Position:  -0.03882563007799408
Bond Position:  [3.76520538]


portfolio before change:  [-0.14672774]
curr_Stock_Price:  100.76252314817754
curr_Factors:  [100.76252315]
mat_Sqrt:  [[0.15]]
grads:  [-0.09945942]
Stock Position:  -0.09945942237786108
Bond Position:  [9.87505461]


portfolio before change:  [-0.09396759]
curr_Stock_Price:  100.23825973561787
curr_Factors:  [100.23825974]
mat_Sqrt:  [[0.15]]
grads:  [0.15653523]
Stock Position:  0.15653522761653427
Bond Position:  [-15.7847864]


portfolio before change:  [-0.2126014]
curr_Stock_Price:  99.48668943160341
curr_Factors:  [99.48668943]
mat_Sqrt:  [[0.15]]
grads:  [0.02742832]
Stock Position:  0.027428318911903775
Bond Position:  [-2.94135405]


portfolio before change:  [-0.20921974]
curr_Stock_Price:  99.61668292168613
curr_Factors:  [99.61668292]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452238]
Stock Position:  -0.05452237566525832
Bond Position:  [5.22211847]


portfolio before change:  [-0.18878584]
curr_Stock_Price:  99.24788919477461
curr_Factors:  [99.24788919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0383164]
Stock Position:  -0.03831640391016952
Bond Position:  [3.61403637]


portfolio before change:  [-0.19729056]
curr_Stock_Price:  99.47574469401972
curr_Factors:  [99.47574469]
mat_Sqrt:  [[0.15]]
grads:  [0.01150923]
Stock Position:  0.011509234710761242
Bond Position:  [-1.34218025]


portfolio before change:  [-0.20212677]
curr_Stock_Price:  99.06283042434745
curr_Factors:  [99.06283042]
mat_Sqrt:  [[0.15]]
grads:  [-0.08276622]
Stock Position:  -0.08276621599468992
Bond Position:  [7.99692885]


portfolio before change:  [-0.2318719]
curr_Stock_Price:  99.4282567660837
curr_Factors:  [99.42825677]
mat_Sqrt:  [[0.15]]
grads:  [-0.08287194]
Stock Position:  -0.08287193661678484
Bond Position:  [8.00794029]


portfolio before change:  [-0.18014098]
curr_Stock_Price:  98.81006907300421
curr_Factors:  [98.81006907]
mat_Sqrt:  [[0.15]]
grads:  [-0.03416124]
Stock Position:  -0.034161243477916596
Bond Position:  [3.19533385]


portfolio before change:  [-0.16855878]
curr_Stock_Price:  98.47687020396104
curr_Factors:  [98.4768702]
mat_Sqrt:  [[0.15]]
grads:  [0.3134601]
Stock Position:  0.31346009929155677
Bond Position:  [-31.03712829]


portfolio before change:  [-0.21473724]
curr_Stock_Price:  98.3357403423906
curr_Factors:  [98.33574034]
mat_Sqrt:  [[0.15]]
grads:  [-0.06988018]
Stock Position:  -0.0698801786831669
Bond Position:  [6.65698187]


portfolio before change:  [-0.24969577]
curr_Stock_Price:  98.84195836657743
curr_Factors:  [98.84195837]
mat_Sqrt:  [[0.15]]
grads:  [0.02364533]
Stock Position:  0.023645326200641692
Bond Position:  [-2.58684612]


portfolio before change:  [-0.26161572]
curr_Stock_Price:  98.3446820181422
curr_Factors:  [98.34468202]
mat_Sqrt:  [[0.15]]
grads:  [0.0350835]
Stock Position:  0.03508349532911632
Bond Position:  [-3.71189091]


portfolio before change:  [-0.25488675]
curr_Stock_Price:  98.54309356299129
curr_Factors:  [98.54309356]
mat_Sqrt:  [[0.15]]
grads:  [0.03716501]
Stock Position:  0.037165012277445425
Bond Position:  [-3.91724203]


portfolio before change:  [-0.25304779]
curr_Stock_Price:  98.5991621103645
curr_Factors:  [98.59916211]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986147]
Stock Position:  -0.01986146997738909
Bond Position:  [1.7052765]


portfolio before change:  [-0.24130623]
curr_Stock_Price:  98.01335538435569
curr_Factors:  [98.01335538]
mat_Sqrt:  [[0.15]]
grads:  [0.0498294]
Stock Position:  0.049829398119159665
Bond Position:  [-5.12525273]


portfolio before change:  [-0.23549022]
curr_Stock_Price:  98.13650256872573
curr_Factors:  [98.13650257]
mat_Sqrt:  [[0.15]]
grads:  [-0.00380462]
Stock Position:  -0.003804616138160632
Bond Position:  [0.13788151]


portfolio before change:  [-0.23445977]
curr_Stock_Price:  97.8679258234928
curr_Factors:  [97.86792582]
mat_Sqrt:  [[0.15]]
grads:  [0.01019831]
Stock Position:  0.010198310919129558
Bond Position:  [-1.2325473]


portfolio before change:  [-0.23789529]
curr_Stock_Price:  97.53860772224908
curr_Factors:  [97.53860772]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214431]
Stock Position:  -0.02214430799551815
Bond Position:  [1.92202968]


portfolio before change:  [-0.22618752]
curr_Stock_Price:  97.01532921924664
curr_Factors:  [97.01532922]
mat_Sqrt:  [[0.15]]
grads:  [-0.02856057]
Stock Position:  -0.02856057089832749
Bond Position:  [2.54462567]


portfolio before change:  [-0.20617267]
curr_Stock_Price:  96.32011172510377
curr_Factors:  [96.32011173]
mat_Sqrt:  [[0.15]]
grads:  [0.08401015]
Stock Position:  0.08401014937577805
Bond Position:  [-8.29803964]


portfolio before change:  [-0.19293429]
curr_Stock_Price:  96.48386604272004
curr_Factors:  [96.48386604]
mat_Sqrt:  [[0.15]]
grads:  [0.09623608]
Stock Position:  0.09623608449463228
Bond Position:  [-9.47816377]


portfolio before change:  [-0.14626319]
curr_Stock_Price:  96.97498643404084
curr_Factors:  [96.97498643]
mat_Sqrt:  [[0.15]]
grads:  [-0.12377769]
Stock Position:  -0.12377769484911476
Bond Position:  [11.85707709]


portfolio before change:  [-0.24283222]
curr_Stock_Price:  97.76115495723228
curr_Factors:  [97.76115496]
mat_Sqrt:  [[0.15]]
grads:  [-0.064339]
Stock Position:  -0.06433899752476695
Bond Position:  [6.04702248]


portfolio before change:  [-0.33876516]
curr_Stock_Price:  99.25808363759667
curr_Factors:  [99.25808364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00089086]
Stock Position:  -0.0008908573763737512
Bond Position:  [-0.25034037]


portfolio before change:  [-0.33884143]
curr_Stock_Price:  99.32612440078563
curr_Factors:  [99.3261244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03376734]
Stock Position:  -0.03376733610609106
Bond Position:  [3.0151372]


portfolio before change:  [-0.34517691]
curr_Stock_Price:  99.51932701980087
curr_Factors:  [99.51932702]
mat_Sqrt:  [[0.15]]
grads:  [0.1574366]
Stock Position:  0.1574365955299082
Bond Position:  [-16.01316095]


portfolio before change:  [-0.20565331]
curr_Stock_Price:  100.41190508221456
curr_Factors:  [100.41190508]
mat_Sqrt:  [[0.15]]
grads:  [-0.05498759]
Stock Position:  -0.0549875921407035
Bond Position:  [5.31575557]


portfolio before change:  [-0.18564863]
curr_Stock_Price:  100.05414366632279
curr_Factors:  [100.05414367]
mat_Sqrt:  [[0.15]]
grads:  [0.0473105]
Stock Position:  0.047310504528058746
Bond Position:  [-4.91926065]


portfolio before change:  [-0.18569147]
curr_Stock_Price:  100.05973691662338
curr_Factors:  [100.05973692]
mat_Sqrt:  [[0.15]]
grads:  [-0.06664598]
Stock Position:  -0.06664597783266119
Bond Position:  [6.48288753]


portfolio before change:  [-0.24472985]
curr_Stock_Price:  100.95166726918437
curr_Factors:  [100.95166727]
mat_Sqrt:  [[0.15]]
grads:  [0.07384123]
Stock Position:  0.0738412262941752
Bond Position:  [-7.69912476]


portfolio before change:  [-0.26121721]
curr_Stock_Price:  100.73490291229881
curr_Factors:  [100.73490291]
mat_Sqrt:  [[0.15]]
grads:  [-0.05576238]
Stock Position:  -0.05576238222492627
Bond Position:  [5.35600095]


portfolio before change:  [-0.24760133]
curr_Stock_Price:  100.49672940643637
curr_Factors:  [100.49672941]
mat_Sqrt:  [[0.15]]
grads:  [0.10606497]
Stock Position:  0.10606496667531706
Bond Position:  [-10.90678358]


portfolio before change:  [-0.22504129]
curr_Stock_Price:  100.71585667354913
curr_Factors:  [100.71585667]
mat_Sqrt:  [[0.15]]
grads:  [-0.1499229]
Stock Position:  -0.14992290339835398
Bond Position:  [14.87457236]


portfolio before change:  [-0.26639862]
curr_Stock_Price:  100.99791506046228
curr_Factors:  [100.99791506]
mat_Sqrt:  [[0.15]]
grads:  [-0.02894303]
Stock Position:  -0.028943033966317342
Bond Position:  [2.65678747]


portfolio before change:  [-0.27702123]
curr_Stock_Price:  101.37067025628612
curr_Factors:  [101.37067026]
mat_Sqrt:  [[0.15]]
grads:  [-0.0673606]
Stock Position:  -0.06736059935057033
Bond Position:  [6.55136788]


portfolio before change:  [-0.28198933]
curr_Stock_Price:  101.45050285960977
curr_Factors:  [101.45050286]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013955]
Stock Position:  -0.010139546902571222
Bond Position:  [0.7466728]


portfolio before change:  [-0.29336461]
curr_Stock_Price:  102.57697859341721
curr_Factors:  [102.57697859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.29336461]
Stock Price:  103.33685467004545
PL:  [-3.63021928]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.99729482e-04]
 [ 2.21186571e-03]
 [-3.16491284e-03]
 [ 4.56968254e-03]
 [ 5.06175800e-03]
 [ 2.24120885e-02]
 [ 1.01991654e-03]
 [-1.50291137e-02]
 [ 2.46371457e-02]
 [-3.97861650e-03]
 [ 1.55064713e-02]
 [-1.22144487e-02]
 [-1.19023755e-02]
 [ 1.10279842e-03]
 [-6.91488110e-03]
 [ 1.95843667e-02]
 [ 1.05385537e-02]
 [-1.11129483e-02]
 [-5.08124420e-04]
 [-5.47034332e-03]
 [ 1.38190426e-02]
 [-5.96164728e-03]
 [ 6.86736953e-03]
 [ 3.81120225e-02]
 [-1.33045622e-04]
 [ 1.20932901e-02]
 [-5.47976780e-03]
 [ 8.86126689e-03]
 [ 9.26625848e-03]
 [-2.18632114e-03]
 [ 9.27826867e-03]
 [-1.20522203e-02]
 [ 6.87955040e-03]
 [ 4.73026615e-03]
 [ 1.21440791e-02]
 [ 1.42108597e-02]
 [-3.46280357e-02]
 [ 8.80386627e-03]
 [-1.78414241e-02]
 [ 2.29229908e-02]
 [-4.93888610e-03]
 [ 4.05624653e-03]
 [ 2.34718982e-02]
 [ 3.15529006e-03]
 [-7.86019834e-03]
 [-4.63924307e-03]
 [ 9.25196018e-05]
 [-1.23202382e-02]
 [-1.21313785e-02]
 [-6.38126332e-03]
 [ 4.72492427e-02]
 [-1.05895040e-02]
 [ 3.46960302e-03]
 [ 5.29508530e-03]
 [ 5.16296691e-03]
 [-1.86979435e-03]
 [ 3.83042872e-03]
 [-5.64444800e-04]
 [ 1.53242939e-03]
 [-4.64578797e-03]
 [-5.07109095e-03]
 [ 1.43450803e-02]
 [ 1.46256271e-02]
 [-1.87503216e-02]
 [-6.33238814e-03]
 [-1.07800204e-02]
 [-4.73421028e-03]
 [ 1.80415274e-02]
 [-1.07325238e-02]
 [ 8.95226124e-03]
 [-2.65121277e-03]
 [ 1.18132012e-02]
 [ 2.26536793e-03]
 [-2.08709575e-03]
 [ 5.20760498e-03]
 [-1.89404252e-02]
 [ 5.06115819e-03]
 [ 6.85249384e-03]
 [-4.10800536e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75537846]
curr_Stock_Price:  100.11143988531896
curr_Factors:  [100.11143989]
mat_Sqrt:  [[0.15]]
grads:  [0.00666486]
Stock Position:  0.006664863211694712
Bond Position:  [3.0881494]


portfolio before change:  [3.75873458]
curr_Stock_Price:  100.58603477833597
curr_Factors:  [100.58603478]
mat_Sqrt:  [[0.15]]
grads:  [0.01474577]
Stock Position:  0.014745771407634178
Bond Position:  [2.27551591]


portfolio before change:  [3.76030994]
curr_Stock_Price:  100.68322415816738
curr_Factors:  [100.68322416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02109942]
Stock Position:  -0.021099418914411222
Bond Position:  [5.88466746]


portfolio before change:  [3.75524696]
curr_Stock_Price:  100.94061409088684
curr_Factors:  [100.94061409]
mat_Sqrt:  [[0.15]]
grads:  [0.03046455]
Stock Position:  0.030464550259268794
Bond Position:  [0.68013655]


portfolio before change:  [3.74466787]
curr_Stock_Price:  100.59195964849059
curr_Factors:  [100.59195965]
mat_Sqrt:  [[0.15]]
grads:  [0.03374505]
Stock Position:  0.03374505334577565
Bond Position:  [0.35018683]


portfolio before change:  [3.71505057]
curr_Stock_Price:  99.7136326345862
curr_Factors:  [99.71363263]
mat_Sqrt:  [[0.15]]
grads:  [0.14941392]
Stock Position:  0.14941392308038107
Bond Position:  [-11.18355447]


portfolio before change:  [3.74195573]
curr_Stock_Price:  99.89838219607427
curr_Factors:  [99.8983822]
mat_Sqrt:  [[0.15]]
grads:  [0.00679944]
Stock Position:  0.006799443568410033
Bond Position:  [3.06270232]


portfolio before change:  [3.74515153]
curr_Stock_Price:  100.34023819162306
curr_Factors:  [100.34023819]
mat_Sqrt:  [[0.15]]
grads:  [-0.10019409]
Stock Position:  -0.10019409150869654
Bond Position:  [13.79865054]


portfolio before change:  [3.69863036]
curr_Stock_Price:  100.81315637550584
curr_Factors:  [100.81315638]
mat_Sqrt:  [[0.15]]
grads:  [0.16424764]
Stock Position:  0.16424763781624827
Bond Position:  [-12.85969243]


portfolio before change:  [3.65805518]
curr_Stock_Price:  100.57101329318427
curr_Factors:  [100.57101329]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652411]
Stock Position:  -0.02652411000018133
Bond Position:  [6.3256118]


portfolio before change:  [3.65994053]
curr_Stock_Price:  100.51483842241394
curr_Factors:  [100.51483842]
mat_Sqrt:  [[0.15]]
grads:  [0.10337648]
Stock Position:  0.10337647513557652
Bond Position:  [-6.73092916]


portfolio before change:  [3.62044738]
curr_Stock_Price:  100.13687572012499
curr_Factors:  [100.13687572]
mat_Sqrt:  [[0.15]]
grads:  [-0.08142966]
Stock Position:  -0.08142965790763115
Bond Position:  [11.77455892]


portfolio before change:  [3.67529833]
curr_Stock_Price:  99.47231424086368
curr_Factors:  [99.47231424]
mat_Sqrt:  [[0.15]]
grads:  [-0.07934917]
Stock Position:  -0.07934916982904858
Bond Position:  [11.56834389]


portfolio before change:  [3.59535243]
curr_Stock_Price:  100.48894676336126
curr_Factors:  [100.48894676]
mat_Sqrt:  [[0.15]]
grads:  [0.00735199]
Stock Position:  0.007351989454177655
Bond Position:  [2.85655875]


portfolio before change:  [3.59412249]
curr_Stock_Price:  100.29736916250552
curr_Factors:  [100.29736916]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609921]
Stock Position:  -0.04609920733225851
Bond Position:  [8.21775171]


portfolio before change:  [3.55708785]
curr_Stock_Price:  101.11187914013776
curr_Factors:  [101.11187914]
mat_Sqrt:  [[0.15]]
grads:  [0.13056244]
Stock Position:  0.13056244441880727
Bond Position:  [-9.64432625]


portfolio before change:  [3.56306775]
curr_Stock_Price:  101.16229705134707
curr_Factors:  [101.16229705]
mat_Sqrt:  [[0.15]]
grads:  [0.07025702]
Stock Position:  0.07025702477195166
Bond Position:  [-3.54429426]


portfolio before change:  [3.58015551]
curr_Stock_Price:  101.40866802165665
curr_Factors:  [101.40866802]
mat_Sqrt:  [[0.15]]
grads:  [-0.07408632]
Stock Position:  -0.07408632167640758
Bond Position:  [11.09315071]


portfolio before change:  [3.62901725]
curr_Stock_Price:  100.75850216951937
curr_Factors:  [100.75850217]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033875]
Stock Position:  -0.0033874961331583782
Bond Position:  [3.97033629]


portfolio before change:  [3.62702277]
curr_Stock_Price:  101.42053558882205
curr_Factors:  [101.42053559]
mat_Sqrt:  [[0.15]]
grads:  [-0.03646896]
Stock Position:  -0.03646895545687593
Bond Position:  [7.32572377]


portfolio before change:  [3.61249697]
curr_Stock_Price:  101.83139662815495
curr_Factors:  [101.83139663]
mat_Sqrt:  [[0.15]]
grads:  [0.09212695]
Stock Position:  0.09212695050412814
Bond Position:  [-5.76891906]


portfolio before change:  [3.51598715]
curr_Stock_Price:  100.78773617185543
curr_Factors:  [100.78773617]
mat_Sqrt:  [[0.15]]
grads:  [-0.03974432]
Stock Position:  -0.039744315179789685
Bond Position:  [7.5217267]


portfolio before change:  [3.51714554]
curr_Stock_Price:  100.77041867927791
curr_Factors:  [100.77041868]
mat_Sqrt:  [[0.15]]
grads:  [0.04578246]
Stock Position:  0.045782463556445524
Bond Position:  [-1.09637248]


portfolio before change:  [3.51027217]
curr_Stock_Price:  100.62178423874539
curr_Factors:  [100.62178424]
mat_Sqrt:  [[0.15]]
grads:  [0.25408015]
Stock Position:  0.25408015023237485
Bond Position:  [-22.05572589]


portfolio before change:  [3.4924218]
curr_Stock_Price:  100.55695492068446
curr_Factors:  [100.55695492]
mat_Sqrt:  [[0.15]]
grads:  [-0.00088697]
Stock Position:  -0.0008869708161681732
Bond Position:  [3.58161288]


portfolio before change:  [3.49192114]
curr_Stock_Price:  101.37379440496369
curr_Factors:  [101.3737944]
mat_Sqrt:  [[0.15]]
grads:  [0.08062193]
Stock Position:  0.08062193376217891
Bond Position:  [-4.6810302]


portfolio before change:  [3.51125123]
curr_Stock_Price:  101.61718552904811
curr_Factors:  [101.61718553]
mat_Sqrt:  [[0.15]]
grads:  [-0.03653179]
Stock Position:  -0.03653178536310547
Bond Position:  [7.22350844]


portfolio before change:  [3.50534657]
curr_Stock_Price:  101.79117490686079
curr_Factors:  [101.79117491]
mat_Sqrt:  [[0.15]]
grads:  [0.05907511]
Stock Position:  0.05907511258250203
Bond Position:  [-2.50797854]


portfolio before change:  [3.44602611]
curr_Stock_Price:  100.78967523202019
curr_Factors:  [100.78967523]
mat_Sqrt:  [[0.15]]
grads:  [0.06177506]
Stock Position:  0.061775056525275804
Bond Position:  [-2.78026177]


portfolio before change:  [3.47819776]
curr_Stock_Price:  101.31327524300359
curr_Factors:  [101.31327524]
mat_Sqrt:  [[0.15]]
grads:  [-0.01457547]
Stock Position:  -0.014575474240450595
Bond Position:  [4.9548868]


portfolio before change:  [3.48037114]
curr_Stock_Price:  101.18541075042374
curr_Factors:  [101.18541075]
mat_Sqrt:  [[0.15]]
grads:  [0.06185512]
Stock Position:  0.06185512449676916
Bond Position:  [-2.77846504]


portfolio before change:  [3.45264475]
curr_Stock_Price:  100.73997101875217
curr_Factors:  [100.73997102]
mat_Sqrt:  [[0.15]]
grads:  [-0.08034814]
Stock Position:  -0.08034813534389988
Bond Position:  [11.54691357]


portfolio before change:  [3.46056459]
curr_Stock_Price:  100.65038420992136
curr_Factors:  [100.65038421]
mat_Sqrt:  [[0.15]]
grads:  [0.04586367]
Stock Position:  0.04586366931660451
Bond Position:  [-1.15563135]


portfolio before change:  [3.41922974]
curr_Stock_Price:  99.75070433635604
curr_Factors:  [99.75070434]
mat_Sqrt:  [[0.15]]
grads:  [0.03153511]
Stock Position:  0.031535107693423256
Bond Position:  [0.27358053]


portfolio before change:  [3.40450241]
curr_Stock_Price:  99.28314847379842
curr_Factors:  [99.28314847]
mat_Sqrt:  [[0.15]]
grads:  [0.08096053]
Stock Position:  0.08096052764564139
Bond Position:  [-4.63351368]


portfolio before change:  [3.39826377]
curr_Stock_Price:  99.20966771569178
curr_Factors:  [99.20966772]
mat_Sqrt:  [[0.15]]
grads:  [0.09473906]
Stock Position:  0.09473906444415818
Bond Position:  [-6.00076734]


portfolio before change:  [3.30380471]
curr_Stock_Price:  98.21658217682068
curr_Factors:  [98.21658218]
mat_Sqrt:  [[0.15]]
grads:  [-0.23085357]
Stock Position:  -0.23085357130472708
Bond Position:  [25.97745347]


portfolio before change:  [3.37438689]
curr_Stock_Price:  97.91787101213787
curr_Factors:  [97.91787101]
mat_Sqrt:  [[0.15]]
grads:  [0.05869244]
Stock Position:  0.05869244182461152
Bond Position:  [-2.37265206]


portfolio before change:  [3.40626108]
curr_Stock_Price:  98.46346905764113
curr_Factors:  [98.46346906]
mat_Sqrt:  [[0.15]]
grads:  [-0.11894283]
Stock Position:  -0.1189428271965475
Bond Position:  [15.11778446]


portfolio before change:  [3.40780856]
curr_Stock_Price:  98.45840283895527
curr_Factors:  [98.45840284]
mat_Sqrt:  [[0.15]]
grads:  [0.15281994]
Stock Position:  0.1528199389074448
Bond Position:  [-11.63859855]


portfolio before change:  [3.47918019]
curr_Stock_Price:  98.93019381918637
curr_Factors:  [98.93019382]
mat_Sqrt:  [[0.15]]
grads:  [-0.03292591]
Stock Position:  -0.032925907362884886
Bond Position:  [6.73654659]


portfolio before change:  [3.48829068]
curr_Stock_Price:  98.66628497842274
curr_Factors:  [98.66628498]
mat_Sqrt:  [[0.15]]
grads:  [0.02704164]
Stock Position:  0.027041643513915012
Bond Position:  [0.82019217]


portfolio before change:  [3.53113783]
curr_Stock_Price:  100.24887685399271
curr_Factors:  [100.24887685]
mat_Sqrt:  [[0.15]]
grads:  [0.15647932]
Stock Position:  0.15647932139414666
Bond Position:  [-12.15573839]


portfolio before change:  [3.59479609]
curr_Stock_Price:  100.66054799572542
curr_Factors:  [100.660548]
mat_Sqrt:  [[0.15]]
grads:  [0.02103527]
Stock Position:  0.021035267045916652
Bond Position:  [1.47737458]


portfolio before change:  [3.5895538]
curr_Stock_Price:  100.40694373218031
curr_Factors:  [100.40694373]
mat_Sqrt:  [[0.15]]
grads:  [-0.05240132]
Stock Position:  -0.052401322288370925
Bond Position:  [8.85101042]


portfolio before change:  [3.63369111]
curr_Stock_Price:  99.57520695319708
curr_Factors:  [99.57520695]
mat_Sqrt:  [[0.15]]
grads:  [-0.03092829]
Stock Position:  -0.030928287160823797
Bond Position:  [6.7133817]


portfolio before change:  [3.64325448]
curr_Stock_Price:  99.27956272921264
curr_Factors:  [99.27956273]
mat_Sqrt:  [[0.15]]
grads:  [0.0006168]
Stock Position:  0.0006167973455666864
Bond Position:  [3.58201911]


portfolio before change:  [3.64375384]
curr_Stock_Price:  99.72619604115377
curr_Factors:  [99.72619604]
mat_Sqrt:  [[0.15]]
grads:  [-0.08213492]
Stock Position:  -0.08213492159535943
Bond Position:  [11.83475714]


portfolio before change:  [3.67513523]
curr_Stock_Price:  99.35313070279469
curr_Factors:  [99.3531307]
mat_Sqrt:  [[0.15]]
grads:  [-0.08087586]
Stock Position:  -0.08087585687989522
Bond Position:  [11.71040481]


portfolio before change:  [3.64210522]
curr_Stock_Price:  99.77058457559956
curr_Factors:  [99.77058458]
mat_Sqrt:  [[0.15]]
grads:  [-0.04254176]
Stock Position:  -0.04254175547575303
Bond Position:  [7.88652103]


portfolio before change:  [3.68703477]
curr_Stock_Price:  98.7260429896159
curr_Factors:  [98.72604299]
mat_Sqrt:  [[0.15]]
grads:  [0.31499495]
Stock Position:  0.3149949513138325
Bond Position:  [-27.41117033]


portfolio before change:  [3.62284712]
curr_Stock_Price:  98.52770839063396
curr_Factors:  [98.52770839]
mat_Sqrt:  [[0.15]]
grads:  [-0.07059669]
Stock Position:  -0.07059669318023722
Bond Position:  [10.57857752]


portfolio before change:  [3.62437146]
curr_Stock_Price:  98.51548179024903
curr_Factors:  [98.51548179]
mat_Sqrt:  [[0.15]]
grads:  [0.02313069]
Stock Position:  0.023130686820862396
Bond Position:  [1.3456407]


portfolio before change:  [3.62452594]
curr_Stock_Price:  98.5185243678266
curr_Factors:  [98.51852437]
mat_Sqrt:  [[0.15]]
grads:  [0.03530057]
Stock Position:  0.035300568683736995
Bond Position:  [0.14676601]


portfolio before change:  [3.6063778]
curr_Stock_Price:  98.00416096441052
curr_Factors:  [98.00416096]
mat_Sqrt:  [[0.15]]
grads:  [0.03441978]
Stock Position:  0.034419779377769
Bond Position:  [0.2330962]


portfolio before change:  [3.59685024]
curr_Stock_Price:  97.72693304870529
curr_Factors:  [97.72693305]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124653]
Stock Position:  -0.012465295643353988
Bond Position:  [4.81504535]


portfolio before change:  [3.60079587]
curr_Stock_Price:  97.43454682391544
curr_Factors:  [97.43454682]
mat_Sqrt:  [[0.15]]
grads:  [0.02553619]
Stock Position:  0.025536191482865307
Bond Position:  [1.11268863]


portfolio before change:  [3.58907144]
curr_Stock_Price:  96.97269340499209
curr_Factors:  [96.9726934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00376297]
Stock Position:  -0.0037629653362089986
Bond Position:  [3.95397632]


portfolio before change:  [3.58746794]
curr_Stock_Price:  97.46449453002296
curr_Factors:  [97.46449453]
mat_Sqrt:  [[0.15]]
grads:  [0.0102162]
Stock Position:  0.010216195917330641
Bond Position:  [2.59175157]


portfolio before change:  [3.58657429]
curr_Stock_Price:  97.36116470408568
curr_Factors:  [97.3611647]
mat_Sqrt:  [[0.15]]
grads:  [-0.03097192]
Stock Position:  -0.030971919796105724
Bond Position:  [6.60203648]


portfolio before change:  [3.60176399]
curr_Stock_Price:  96.88405334190385
curr_Factors:  [96.88405334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03380727]
Stock Position:  -0.03380727299689607
Bond Position:  [6.87714963]


portfolio before change:  [3.63074866]
curr_Stock_Price:  96.03941732160045
curr_Factors:  [96.03941732]
mat_Sqrt:  [[0.15]]
grads:  [0.09563387]
Stock Position:  0.09563386833954188
Bond Position:  [-5.55387233]


portfolio before change:  [3.65588223]
curr_Stock_Price:  96.30585735058249
curr_Factors:  [96.30585735]
mat_Sqrt:  [[0.15]]
grads:  [0.09750418]
Stock Position:  0.09750418090831553
Bond Position:  [-5.73434151]


portfolio before change:  [3.6692355]
curr_Stock_Price:  96.44648396371703
curr_Factors:  [96.44648396]
mat_Sqrt:  [[0.15]]
grads:  [-0.12500214]
Stock Position:  -0.12500214403889529
Bond Position:  [15.72525278]


portfolio before change:  [3.65008998]
curr_Stock_Price:  96.60750827333474
curr_Factors:  [96.60750827]
mat_Sqrt:  [[0.15]]
grads:  [-0.04221592]
Stock Position:  -0.04221592095050797
Bond Position:  [7.72846491]


portfolio before change:  [3.63580663]
curr_Stock_Price:  96.95729081012716
curr_Factors:  [96.95729081]
mat_Sqrt:  [[0.15]]
grads:  [-0.0718668]
Stock Position:  -0.07186680277978336
Bond Position:  [10.60381712]


portfolio before change:  [3.65064859]
curr_Stock_Price:  96.75999247966463
curr_Factors:  [96.75999248]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315614]
Stock Position:  -0.0315614018676247
Bond Position:  [6.70452959]


portfolio before change:  [3.621453]
curr_Stock_Price:  97.69831047035836
curr_Factors:  [97.69831047]
mat_Sqrt:  [[0.15]]
grads:  [0.12027685]
Stock Position:  0.12027684929450012
Bond Position:  [-8.12939196]


portfolio before change:  [3.56560765]
curr_Stock_Price:  97.23822815307261
curr_Factors:  [97.23822815]
mat_Sqrt:  [[0.15]]
grads:  [-0.07155016]
Stock Position:  -0.071550158697436
Bond Position:  [10.5230183]


portfolio before change:  [3.58693639]
curr_Stock_Price:  96.94932550828818
curr_Factors:  [96.94932551]
mat_Sqrt:  [[0.15]]
grads:  [0.05968174]
Stock Position:  0.05968174156974988
Bond Position:  [-2.1991682]


portfolio before change:  [3.60720748]
curr_Stock_Price:  97.29128180090662
curr_Factors:  [97.2912818]
mat_Sqrt:  [[0.15]]
grads:  [-0.01767475]
Stock Position:  -0.017674751820350085
Bond Position:  [5.32680674]


portfolio before change:  [3.62169322]
curr_Stock_Price:  96.49054607083544
curr_Factors:  [96.49054607]
mat_Sqrt:  [[0.15]]
grads:  [0.07875467]
Stock Position:  0.078754674662725
Bond Position:  [-3.97738834]


portfolio before change:  [3.59499748]
curr_Stock_Price:  96.15472919144132
curr_Factors:  [96.15472919]
mat_Sqrt:  [[0.15]]
grads:  [0.01510245]
Stock Position:  0.01510245289655081
Bond Position:  [2.14282521]


portfolio before change:  [3.58326098]
curr_Stock_Price:  95.3687353916556
curr_Factors:  [95.36873539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01391397]
Stock Position:  -0.01391397168237861
Bond Position:  [4.91021886]


portfolio before change:  [3.5867462]
curr_Stock_Price:  95.14030817490617
curr_Factors:  [95.14030817]
mat_Sqrt:  [[0.15]]
grads:  [0.03471737]
Stock Position:  0.034717366504238664
Bond Position:  [0.28372526]


portfolio before change:  [3.56394634]
curr_Stock_Price:  94.48306931831962
curr_Factors:  [94.48306932]
mat_Sqrt:  [[0.15]]
grads:  [-0.1262695]
Stock Position:  -0.1262695010747334
Bond Position:  [15.49427636]


portfolio before change:  [3.49961039]
curr_Stock_Price:  95.00025172185346
curr_Factors:  [95.00025172]
mat_Sqrt:  [[0.15]]
grads:  [0.03374105]
Stock Position:  0.033741054570476894
Bond Position:  [0.29420172]


portfolio before change:  [3.4982149]
curr_Stock_Price:  94.95834793999055
curr_Factors:  [94.95834794]
mat_Sqrt:  [[0.15]]
grads:  [0.04568329]
Stock Position:  0.045683292299169606
Bond Position:  [-0.83979506]


portfolio before change:  [3.48888271]
curr_Stock_Price:  94.75521659731983
curr_Factors:  [94.7552166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.48888271]
Stock Price:  94.85697934283417
PL:  [3.48888271]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.19970714e-03]
 [ 8.30099122e-04]
 [-4.99339751e-04]
 [ 8.50657252e-03]
 [ 5.06915034e-03]
 [ 2.85303719e-02]
 [ 1.06610961e-03]
 [ 2.91323133e-03]
 [ 2.40736655e-02]
 [-4.52260732e-03]
 [ 2.85554359e-02]
 [-8.12639975e-03]
 [ 8.24935500e-02]
 [ 9.26645278e-03]
 [-6.89895350e-03]
 [ 2.47926669e-02]
 [ 1.11130206e-02]
 [-1.07347956e-02]
 [ 2.40731926e-03]
 [-5.86658638e-03]
 [ 1.39001981e-02]
 [-4.76564702e-03]
 [ 1.04996993e-02]
 [ 7.33965761e-03]
 [ 1.99672038e-03]
 [ 1.02460593e-02]
 [-5.35696651e-03]
 [ 1.27534696e-02]
 [ 5.12623316e-02]
 [ 5.38620638e-03]
 [ 1.91899626e-02]
 [ 9.64520740e-04]
 [-2.09112052e-03]
 [ 7.67696017e-03]
 [ 1.01045755e-02]
 [ 7.10897983e-03]
 [-3.27014191e-02]
 [ 9.08295520e-03]
 [ 9.16572064e-03]
 [ 8.12303512e-03]
 [-4.29373375e-03]
 [-1.89627189e-02]
 [ 2.07754860e-02]
 [-2.87913542e-03]
 [-1.06755849e-03]
 [-1.08939737e-02]
 [ 1.33949133e-02]
 [ 3.81996572e-03]
 [ 3.17158834e-03]
 [-7.43160702e-03]
 [-1.35566826e-02]
 [ 3.42515485e-03]
 [-9.05822172e-03]
 [ 5.85293549e-03]
 [-4.78818185e-03]
 [ 2.61689322e-03]
 [ 1.01982558e-02]
 [-5.64678868e-05]
 [ 1.68957026e-03]
 [ 1.58905433e-02]
 [ 2.69430943e-03]
 [ 2.29372855e-02]
 [ 2.92572255e-03]
 [-1.24784836e-02]
 [ 1.18064197e-02]
 [ 5.94706974e-03]
 [-5.22790478e-03]
 [ 1.54604414e-02]
 [-1.15096137e-02]
 [-1.03889723e-02]
 [-1.18009557e-02]
 [ 1.44945166e-02]
 [-1.11490535e-02]
 [ 2.61677027e-02]
 [-2.45004310e-02]
 [ 8.05577007e-04]
 [ 1.22353404e-03]
 [-1.29600253e-02]
 [ 2.28069822e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.14196571]
curr_Stock_Price:  99.94150282909555
curr_Factors:  [99.94150283]
mat_Sqrt:  [[0.15]]
grads:  [0.01466471]
Stock Position:  0.014664714243335436
Bond Position:  [-0.32364787]


portfolio before change:  [1.13942213]
curr_Stock_Price:  99.76943343195072
curr_Factors:  [99.76943343]
mat_Sqrt:  [[0.15]]
grads:  [0.00553399]
Stock Position:  0.005533994148937014
Bond Position:  [0.58729867]


portfolio before change:  [1.13857243]
curr_Stock_Price:  99.60925787056533
curr_Factors:  [99.60925787]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332893]
Stock Position:  -0.003328931673733538
Bond Position:  [1.47016485]


portfolio before change:  [1.13901471]
curr_Stock_Price:  99.50400170314398
curr_Factors:  [99.5040017]
mat_Sqrt:  [[0.15]]
grads:  [0.05671048]
Stock Position:  0.056710483442863814
Bond Position:  [-4.50390533]


portfolio before change:  [1.15236983]
curr_Stock_Price:  99.74446212640018
curr_Factors:  [99.74446213]
mat_Sqrt:  [[0.15]]
grads:  [0.03379434]
Stock Position:  0.03379433559015037
Bond Position:  [-2.21842799]


portfolio before change:  [1.1874859]
curr_Stock_Price:  100.78767595519447
curr_Factors:  [100.78767596]
mat_Sqrt:  [[0.15]]
grads:  [0.19020248]
Stock Position:  0.19020247931598092
Bond Position:  [-17.98257995]


portfolio before change:  [1.18405136]
curr_Stock_Price:  100.77552790251725
curr_Factors:  [100.7755279]
mat_Sqrt:  [[0.15]]
grads:  [0.0071074]
Stock Position:  0.00710739738187971
Bond Position:  [0.46779964]


portfolio before change:  [1.18914423]
curr_Stock_Price:  101.487973361889
curr_Factors:  [101.48797336]
mat_Sqrt:  [[0.15]]
grads:  [0.01942154]
Stock Position:  0.019421542220341266
Bond Position:  [-0.78190873]


portfolio before change:  [1.17861135]
curr_Stock_Price:  100.94815971790217
curr_Factors:  [100.94815972]
mat_Sqrt:  [[0.15]]
grads:  [0.1604911]
Stock Position:  0.16049110333242242
Bond Position:  [-15.02267019]


portfolio before change:  [1.24931923]
curr_Stock_Price:  101.39458215680432
curr_Factors:  [101.39458216]
mat_Sqrt:  [[0.15]]
grads:  [-0.03015072]
Stock Position:  -0.030150715484622746
Bond Position:  [4.30643843]


portfolio before change:  [1.23980692]
curr_Stock_Price:  101.71900141020257
curr_Factors:  [101.71900141]
mat_Sqrt:  [[0.15]]
grads:  [0.19036957]
Stock Position:  0.19036957261053405
Bond Position:  [-18.12439591]


portfolio before change:  [1.37021738]
curr_Stock_Price:  102.40999036488702
curr_Factors:  [102.40999036]
mat_Sqrt:  [[0.15]]
grads:  [-0.054176]
Stock Position:  -0.05417599831358295
Bond Position:  [6.91838085]


portfolio before change:  [1.36727693]
curr_Stock_Price:  102.47224784985531
curr_Factors:  [102.47224785]
mat_Sqrt:  [[0.15]]
grads:  [0.549957]
Stock Position:  0.5499569997856381
Bond Position:  [-54.98805306]


portfolio before change:  [1.18980877]
curr_Stock_Price:  102.15580256221693
curr_Factors:  [102.15580256]
mat_Sqrt:  [[0.15]]
grads:  [0.06177635]
Stock Position:  0.06177635188924647
Bond Position:  [-5.12100404]


portfolio before change:  [1.17278935]
curr_Stock_Price:  101.8854831338224
curr_Factors:  [101.88548313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599302]
Stock Position:  -0.04599302334041333
Bond Position:  [5.85881075]


portfolio before change:  [1.16914788]
curr_Stock_Price:  101.97261926483988
curr_Factors:  [101.97261926]
mat_Sqrt:  [[0.15]]
grads:  [0.16528445]
Stock Position:  0.16528444593412758
Bond Position:  [-15.68533999]


portfolio before change:  [1.23270366]
curr_Stock_Price:  102.36307428432802
curr_Factors:  [102.36307428]
mat_Sqrt:  [[0.15]]
grads:  [0.0740868]
Stock Position:  0.07408680431612226
Bond Position:  [-6.35104939]


portfolio before change:  [1.18063954]
curr_Stock_Price:  101.66568736728583
curr_Factors:  [101.66568737]
mat_Sqrt:  [[0.15]]
grads:  [-0.0715653]
Stock Position:  -0.07156530412106135
Bond Position:  [8.45637537]


portfolio before change:  [1.16441455]
curr_Stock_Price:  101.8997886979571
curr_Factors:  [101.8997887]
mat_Sqrt:  [[0.15]]
grads:  [0.0160488]
Stock Position:  0.016048795098963713
Bond Position:  [-0.47095428]


portfolio before change:  [1.17271811]
curr_Stock_Price:  102.41901773164827
curr_Factors:  [102.41901773]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911058]
Stock Position:  -0.0391105758353044
Bond Position:  [5.17838487]


portfolio before change:  [1.19082188]
curr_Stock_Price:  101.96440641175396
curr_Factors:  [101.96440641]
mat_Sqrt:  [[0.15]]
grads:  [0.09266799]
Stock Position:  0.09266798717987272
Bond Position:  [-8.25801443]


portfolio before change:  [1.19560666]
curr_Stock_Price:  102.0216097390471
curr_Factors:  [102.02160974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03177098]
Stock Position:  -0.03177098010256853
Bond Position:  [4.43693319]


portfolio before change:  [1.20294959]
curr_Stock_Price:  101.79921764307302
curr_Factors:  [101.79921764]
mat_Sqrt:  [[0.15]]
grads:  [0.069998]
Stock Position:  0.0699979954791257
Bond Position:  [-5.92279159]


portfolio before change:  [1.19560336]
curr_Stock_Price:  101.69955708058689
curr_Factors:  [101.69955708]
mat_Sqrt:  [[0.15]]
grads:  [0.04893105]
Stock Position:  0.048931050749308064
Bond Position:  [-3.78066283]


portfolio before change:  [1.19967199]
curr_Stock_Price:  101.78753656533992
curr_Factors:  [101.78753657]
mat_Sqrt:  [[0.15]]
grads:  [0.01331147]
Stock Position:  0.013311469186533035
Bond Position:  [-0.15526967]


portfolio before change:  [1.20155272]
curr_Stock_Price:  101.92955212099179
curr_Factors:  [101.92955212]
mat_Sqrt:  [[0.15]]
grads:  [0.06830706]
Stock Position:  0.06830706224663821
Bond Position:  [-5.76095554]


portfolio before change:  [1.23249498]
curr_Stock_Price:  102.3878111110105
curr_Factors:  [102.38781111]
mat_Sqrt:  [[0.15]]
grads:  [-0.03571311]
Stock Position:  -0.03571311004544206
Bond Position:  [4.88908214]


portfolio before change:  [1.20644239]
curr_Stock_Price:  103.12586410981947
curr_Factors:  [103.12586411]
mat_Sqrt:  [[0.15]]
grads:  [0.08502313]
Stock Position:  0.08502313087677775
Bond Position:  [-7.56164146]


portfolio before change:  [1.26101044]
curr_Stock_Price:  103.77322525153258
curr_Factors:  [103.77322525]
mat_Sqrt:  [[0.15]]
grads:  [0.34174888]
Stock Position:  0.34174887739010584
Bond Position:  [-34.20337279]


portfolio before change:  [1.32389829]
curr_Stock_Price:  103.96349837188124
curr_Factors:  [103.96349837]
mat_Sqrt:  [[0.15]]
grads:  [0.03590804]
Stock Position:  0.03590804255782335
Bond Position:  [-2.40922744]


portfolio before change:  [1.3261609]
curr_Stock_Price:  104.0307032085187
curr_Factors:  [104.03070321]
mat_Sqrt:  [[0.15]]
grads:  [0.12793308]
Stock Position:  0.12793308403019946
Bond Position:  [-11.9828078]


portfolio before change:  [1.35560202]
curr_Stock_Price:  104.26668650483138
curr_Factors:  [104.2666865]
mat_Sqrt:  [[0.15]]
grads:  [0.00643014]
Stock Position:  0.006430138267363543
Bond Position:  [0.68515281]


portfolio before change:  [1.35552936]
curr_Stock_Price:  104.24872580655158
curr_Factors:  [104.24872581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0139408]
Stock Position:  -0.013940803443111972
Bond Position:  [2.80884035]


portfolio before change:  [1.34849576]
curr_Stock_Price:  104.7658516146749
curr_Factors:  [104.76585161]
mat_Sqrt:  [[0.15]]
grads:  [0.05117973]
Stock Position:  0.051179734493906545
Bond Position:  [-4.01339271]


portfolio before change:  [1.32294846]
curr_Stock_Price:  104.27158456876518
curr_Factors:  [104.27158457]
mat_Sqrt:  [[0.15]]
grads:  [0.06736384]
Stock Position:  0.06736383634546432
Bond Position:  [-5.7011855]


portfolio before change:  [1.28780473]
curr_Stock_Price:  103.75517391281332
curr_Factors:  [103.75517391]
mat_Sqrt:  [[0.15]]
grads:  [0.0473932]
Stock Position:  0.04739319888440758
Bond Position:  [-3.62948487]


portfolio before change:  [1.28518675]
curr_Stock_Price:  103.70472094036134
curr_Factors:  [103.70472094]
mat_Sqrt:  [[0.15]]
grads:  [-0.21800946]
Stock Position:  -0.21800946040323252
Bond Position:  [23.893797]


portfolio before change:  [1.42450297]
curr_Stock_Price:  103.07253364821872
curr_Factors:  [103.07253365]
mat_Sqrt:  [[0.15]]
grads:  [0.06055303]
Stock Position:  0.060553034634142786
Bond Position:  [-4.81685173]


portfolio before change:  [1.42788545]
curr_Stock_Price:  103.13336541843522
curr_Factors:  [103.13336542]
mat_Sqrt:  [[0.15]]
grads:  [0.0611048]
Stock Position:  0.061104804282456515
Bond Position:  [-4.87405866]


portfolio before change:  [1.47059001]
curr_Stock_Price:  103.83722493629355
curr_Factors:  [103.83722494]
mat_Sqrt:  [[0.15]]
grads:  [0.05415357]
Stock Position:  0.05415356745594349
Bond Position:  [-4.15256615]


portfolio before change:  [1.42188428]
curr_Stock_Price:  102.94261735283352
curr_Factors:  [102.94261735]
mat_Sqrt:  [[0.15]]
grads:  [-0.02862489]
Stock Position:  -0.028624891635847378
Bond Position:  [4.36860554]


portfolio before change:  [1.41530747]
curr_Stock_Price:  103.18191459198644
curr_Factors:  [103.18191459]
mat_Sqrt:  [[0.15]]
grads:  [-0.12641813]
Stock Position:  -0.12641812606001554
Bond Position:  [14.45937175]


portfolio before change:  [1.39793036]
curr_Stock_Price:  103.3265208038909
curr_Factors:  [103.3265208]
mat_Sqrt:  [[0.15]]
grads:  [0.13850324]
Stock Position:  0.1385032397818078
Bond Position:  [-12.91312753]


portfolio before change:  [1.50118598]
curr_Stock_Price:  104.07785855495071
curr_Factors:  [104.07785855]
mat_Sqrt:  [[0.15]]
grads:  [-0.01919424]
Stock Position:  -0.019194236149982585
Bond Position:  [3.49888097]


portfolio before change:  [1.52944699]
curr_Stock_Price:  102.61688205002972
curr_Factors:  [102.61688205]
mat_Sqrt:  [[0.15]]
grads:  [-0.00711706]
Stock Position:  -0.007117056609276992
Bond Position:  [2.25977715]


portfolio before change:  [1.53293346]
curr_Stock_Price:  102.1468519031573
curr_Factors:  [102.1468519]
mat_Sqrt:  [[0.15]]
grads:  [-0.07262649]
Stock Position:  -0.07262649100295722
Bond Position:  [8.95150088]


portfolio before change:  [1.53547399]
curr_Stock_Price:  102.11957474818028
curr_Factors:  [102.11957475]
mat_Sqrt:  [[0.15]]
grads:  [0.08929942]
Stock Position:  0.0892994221945771
Bond Position:  [-7.58374503]


portfolio before change:  [1.60433657]
curr_Stock_Price:  102.89602515369974
curr_Factors:  [102.89602515]
mat_Sqrt:  [[0.15]]
grads:  [0.02546644]
Stock Position:  0.02546643813671381
Bond Position:  [-1.01605869]


portfolio before change:  [1.61383799]
curr_Stock_Price:  103.27161489484024
curr_Factors:  [103.27161489]
mat_Sqrt:  [[0.15]]
grads:  [0.02114392]
Stock Position:  0.021143922256375732
Bond Position:  [-0.569729]


portfolio before change:  [1.63190148]
curr_Stock_Price:  104.12761004650403
curr_Factors:  [104.12761005]
mat_Sqrt:  [[0.15]]
grads:  [-0.04954405]
Stock Position:  -0.04954404677010911
Bond Position:  [6.79080466]


portfolio before change:  [1.62819103]
curr_Stock_Price:  104.21106893052017
curr_Factors:  [104.21106893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09037788]
Stock Position:  -0.09037788406940891
Bond Position:  [11.04656693]


portfolio before change:  [1.58366438]
curr_Stock_Price:  104.71138028107123
curr_Factors:  [104.71138028]
mat_Sqrt:  [[0.15]]
grads:  [0.02283437]
Stock Position:  0.022834365643001946
Bond Position:  [-0.80735357]


portfolio before change:  [1.56694849]
curr_Stock_Price:  103.98154056971218
curr_Factors:  [103.98154057]
mat_Sqrt:  [[0.15]]
grads:  [-0.06038814]
Stock Position:  -0.060388144812224195
Bond Position:  [7.84620082]


portfolio before change:  [1.56600054]
curr_Stock_Price:  104.00535906656775
curr_Factors:  [104.00535907]
mat_Sqrt:  [[0.15]]
grads:  [0.03901957]
Stock Position:  0.03901956991981439
Bond Position:  [-2.49224384]


portfolio before change:  [1.51955663]
curr_Stock_Price:  102.81907911686949
curr_Factors:  [102.81907912]
mat_Sqrt:  [[0.15]]
grads:  [-0.03192121]
Stock Position:  -0.03192121230098635
Bond Position:  [4.80166629]


portfolio before change:  [1.53468348]
curr_Stock_Price:  102.3546002005066
curr_Factors:  [102.3546002]
mat_Sqrt:  [[0.15]]
grads:  [0.01744595]
Stock Position:  0.017445954819434104
Bond Position:  [-0.25099025]


portfolio before change:  [1.55553583]
curr_Stock_Price:  103.55075386670296
curr_Factors:  [103.55075387]
mat_Sqrt:  [[0.15]]
grads:  [0.06798837]
Stock Position:  0.06798837171267047
Bond Position:  [-5.48471131]


portfolio before change:  [1.52953159]
curr_Stock_Price:  103.17331518023954
curr_Factors:  [103.17331518]
mat_Sqrt:  [[0.15]]
grads:  [-0.00037645]
Stock Position:  -0.0003764525788165873
Bond Position:  [1.56837145]


portfolio before change:  [1.52975776]
curr_Stock_Price:  102.83290436563237
curr_Factors:  [102.83290437]
mat_Sqrt:  [[0.15]]
grads:  [0.0112638]
Stock Position:  0.011263801739000538
Bond Position:  [0.37146831]


portfolio before change:  [1.5368176]
curr_Stock_Price:  103.45761523603865
curr_Factors:  [103.45761524]
mat_Sqrt:  [[0.15]]
grads:  [0.10593696]
Stock Position:  0.1059369553514327
Bond Position:  [-9.42316717]


portfolio before change:  [1.55455873]
curr_Stock_Price:  103.6306435695335
curr_Factors:  [103.63064357]
mat_Sqrt:  [[0.15]]
grads:  [0.01796206]
Stock Position:  0.01796206286596814
Bond Position:  [-0.30686141]


portfolio before change:  [1.56052046]
curr_Stock_Price:  103.9636183256571
curr_Factors:  [103.96361833]
mat_Sqrt:  [[0.15]]
grads:  [0.15291524]
Stock Position:  0.15291523660637385
Bond Position:  [-14.33710083]


portfolio before change:  [1.61616529]
curr_Stock_Price:  104.33337171747473
curr_Factors:  [104.33337172]
mat_Sqrt:  [[0.15]]
grads:  [0.01950482]
Stock Position:  0.019504817007681557
Bond Position:  [-0.41883803]


portfolio before change:  [1.61502034]
curr_Stock_Price:  104.27601279207147
curr_Factors:  [104.27601279]
mat_Sqrt:  [[0.15]]
grads:  [-0.08318989]
Stock Position:  -0.08318989077501705
Bond Position:  [10.28973045]


portfolio before change:  [1.59256959]
curr_Stock_Price:  104.55361715454035
curr_Factors:  [104.55361715]
mat_Sqrt:  [[0.15]]
grads:  [0.07870946]
Stock Position:  0.07870946452899796
Bond Position:  [-6.63678963]


portfolio before change:  [1.63512551]
curr_Stock_Price:  105.09955821643253
curr_Factors:  [105.09955822]
mat_Sqrt:  [[0.15]]
grads:  [0.03964713]
Stock Position:  0.03964713163068105
Bond Position:  [-2.53177051]


portfolio before change:  [1.63495405]
curr_Stock_Price:  105.09922497666686
curr_Factors:  [105.09922498]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348527]
Stock Position:  -0.03485269852926405
Bond Position:  [5.29794566]


portfolio before change:  [1.62133732]
curr_Stock_Price:  105.49941960839168
curr_Factors:  [105.49941961]
mat_Sqrt:  [[0.15]]
grads:  [0.10306961]
Stock Position:  0.10306960951768562
Bond Position:  [-9.25244666]


portfolio before change:  [1.63255864]
curr_Stock_Price:  105.61390160960251
curr_Factors:  [105.61390161]
mat_Sqrt:  [[0.15]]
grads:  [-0.07673076]
Stock Position:  -0.0767307581897593
Bond Position:  [9.73639339]


portfolio before change:  [1.68634354]
curr_Stock_Price:  104.92087628465043
curr_Factors:  [104.92087628]
mat_Sqrt:  [[0.15]]
grads:  [-0.06925982]
Stock Position:  -0.06925981500562724
Bond Position:  [8.95314402]


portfolio before change:  [1.67508641]
curr_Stock_Price:  105.09149074844747
curr_Factors:  [105.09149075]
mat_Sqrt:  [[0.15]]
grads:  [-0.07867304]
Stock Position:  -0.0786730379315031
Bond Position:  [9.94295324]


portfolio before change:  [1.63725202]
curr_Stock_Price:  105.58029654020746
curr_Factors:  [105.58029654]
mat_Sqrt:  [[0.15]]
grads:  [0.09663011]
Stock Position:  0.09663011080269004
Bond Position:  [-8.56498373]


portfolio before change:  [1.60744029]
curr_Stock_Price:  105.27732258475318
curr_Factors:  [105.27732258]
mat_Sqrt:  [[0.15]]
grads:  [-0.07432702]
Stock Position:  -0.07432702316179167
Bond Position:  [9.43239028]


portfolio before change:  [1.62200688]
curr_Stock_Price:  105.08927459625544
curr_Factors:  [105.0892746]
mat_Sqrt:  [[0.15]]
grads:  [0.17445135]
Stock Position:  0.1744513513576093
Bond Position:  [-16.71095909]


portfolio before change:  [1.47349085]
curr_Stock_Price:  104.2439297035573
curr_Factors:  [104.2439297]
mat_Sqrt:  [[0.15]]
grads:  [-0.16333621]
Stock Position:  -0.16333620661216894
Bond Position:  [18.50029889]


portfolio before change:  [1.47020402]
curr_Stock_Price:  104.27113212639425
curr_Factors:  [104.27113213]
mat_Sqrt:  [[0.15]]
grads:  [0.00537051]
Stock Position:  0.005370513378841705
Bond Position:  [0.91021451]


portfolio before change:  [1.47487326]
curr_Stock_Price:  105.12996100906032
curr_Factors:  [105.12996101]
mat_Sqrt:  [[0.15]]
grads:  [0.00815689]
Stock Position:  0.008156893580094585
Bond Position:  [0.61733935]


portfolio before change:  [1.47992719]
curr_Stock_Price:  105.74482075467216
curr_Factors:  [105.74482075]
mat_Sqrt:  [[0.15]]
grads:  [-0.08640017]
Stock Position:  -0.08640016887916516
Bond Position:  [10.61629756]


portfolio before change:  [1.39258304]
curr_Stock_Price:  106.76342622276078
curr_Factors:  [106.76342622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.39258304]
Stock Price:  106.81869428973957
PL:  [-5.42611125]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.02108002e-04]
 [ 2.15764065e-03]
 [-4.19552157e-03]
 [ 4.77988370e-03]
 [ 2.97621637e-03]
 [ 2.04061798e-02]
 [ 5.83415918e-04]
 [-1.71598214e-02]
 [ 2.10247909e-02]
 [-3.86706503e-03]
 [ 2.63953838e-02]
 [-5.04775110e-02]
 [ 8.13033944e-02]
 [ 1.33478042e-02]
 [-6.89475218e-03]
 [ 3.18056620e-02]
 [ 1.38876006e-02]
 [ 1.77715478e-03]
 [ 9.04109132e-03]
 [-7.23405604e-03]
 [ 1.40338457e-02]
 [-6.92231378e-03]
 [ 8.78161364e-03]
 [ 4.38445022e-02]
 [-2.79612625e-04]
 [ 1.41293477e-02]
 [-6.80014764e-03]
 [ 5.67964793e-03]
 [ 8.18812759e-03]
 [-3.36200749e-03]
 [ 2.83883403e-04]
 [-1.05287430e-02]
 [-5.08886454e-03]
 [ 4.51245764e-03]
 [ 1.22757559e-02]
 [ 1.33307812e-02]
 [-3.48923183e-02]
 [ 9.72575542e-03]
 [-5.74499982e-03]
 [ 2.22644116e-02]
 [-5.80056815e-03]
 [-1.49550144e-02]
 [ 2.18233549e-02]
 [ 1.95113537e-03]
 [-5.97159219e-03]
 [-1.09434285e-02]
 [ 1.40969129e-02]
 [ 1.58340783e-03]
 [ 3.02121414e-03]
 [-7.52116360e-03]
 [-1.58625170e-02]
 [ 1.07801032e-03]
 [-7.29070190e-03]
 [ 5.45122448e-03]
 [-1.15660519e-03]
 [-1.00903746e-04]
 [ 9.13989027e-03]
 [-6.85180024e-04]
 [ 1.64233666e-03]
 [ 1.60043893e-02]
 [-2.04825259e-03]
 [ 1.43817363e-02]
 [ 2.07666699e-03]
 [-1.24851303e-02]
 [ 5.39202074e-03]
 [ 3.73494314e-03]
 [-5.33874050e-03]
 [ 1.53218594e-02]
 [-8.45571845e-03]
 [ 7.89352874e-03]
 [-1.31024438e-02]
 [ 1.36197449e-02]
 [-8.66196231e-03]
 [ 2.55301217e-02]
 [-2.56336206e-02]
 [ 1.04137476e-03]
 [-3.68352189e-03]
 [-9.61601540e-03]
 [ 2.87179083e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.18813972]
curr_Stock_Price:  100.72480479862394
curr_Factors:  [100.7248048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00201405]
Stock Position:  -0.0020140533495817898
Bond Position:  [13.39100485]


portfolio before change:  [13.18920798]
curr_Stock_Price:  100.60996344556328
curr_Factors:  [100.60996345]
mat_Sqrt:  [[0.15]]
grads:  [0.01438427]
Stock Position:  0.014384271019344173
Bond Position:  [11.742007]


portfolio before change:  [13.19472854]
curr_Stock_Price:  100.94273378849479
curr_Factors:  [100.94273379]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797014]
Stock Position:  -0.027970143826524917
Bond Position:  [16.01811132]


portfolio before change:  [13.19720275]
curr_Stock_Price:  100.89006849216324
curr_Factors:  [100.89006849]
mat_Sqrt:  [[0.15]]
grads:  [0.03186589]
Stock Position:  0.03186589135352978
Bond Position:  [9.98225079]


portfolio before change:  [13.17890776]
curr_Stock_Price:  100.29636463013316
curr_Factors:  [100.29636463]
mat_Sqrt:  [[0.15]]
grads:  [0.01984144]
Stock Position:  0.01984144249261987
Bond Position:  [11.18888321]


portfolio before change:  [13.16170718]
curr_Stock_Price:  99.39421715448528
curr_Factors:  [99.39421715]
mat_Sqrt:  [[0.15]]
grads:  [0.1360412]
Stock Position:  0.13604119852009341
Bond Position:  [-0.36000125]


portfolio before change:  [13.19525221]
curr_Stock_Price:  99.64096246659578
curr_Factors:  [99.64096247]
mat_Sqrt:  [[0.15]]
grads:  [0.00388944]
Stock Position:  0.0038894394529042347
Bond Position:  [12.80770472]


portfolio before change:  [13.19749822]
curr_Stock_Price:  100.01261059061045
curr_Factors:  [100.01261059]
mat_Sqrt:  [[0.15]]
grads:  [-0.11439881]
Stock Position:  -0.11439880940561198
Bond Position:  [24.6388218]


portfolio before change:  [13.1817184]
curr_Stock_Price:  100.16400893981165
curr_Factors:  [100.16400894]
mat_Sqrt:  [[0.15]]
grads:  [0.14016527]
Stock Position:  0.14016527289896188
Bond Position:  [-0.85779725]


portfolio before change:  [13.22928028]
curr_Stock_Price:  100.50371858075621
curr_Factors:  [100.50371858]
mat_Sqrt:  [[0.15]]
grads:  [-0.02578043]
Stock Position:  -0.025780433537016173
Bond Position:  [15.82030972]


portfolio before change:  [13.20265175]
curr_Stock_Price:  101.57497040825167
curr_Factors:  [101.57497041]
mat_Sqrt:  [[0.15]]
grads:  [0.17596923]
Stock Position:  0.1759692254780373
Bond Position:  [-4.67141712]


portfolio before change:  [13.237159]
curr_Stock_Price:  101.77272785078027
curr_Factors:  [101.77272785]
mat_Sqrt:  [[0.15]]
grads:  [-0.33651674]
Stock Position:  -0.3365167398353962
Bond Position:  [47.48538558]


portfolio before change:  [13.01496872]
curr_Stock_Price:  102.44181257461973
curr_Factors:  [102.44181257]
mat_Sqrt:  [[0.15]]
grads:  [0.54202263]
Stock Position:  0.5420226294095041
Bond Position:  [-42.5108119]


portfolio before change:  [13.22941592]
curr_Stock_Price:  102.8423571265478
curr_Factors:  [102.84235713]
mat_Sqrt:  [[0.15]]
grads:  [0.08898536]
Stock Position:  0.08898536163539651
Bond Position:  [4.07795158]


portfolio before change:  [13.24944858]
curr_Stock_Price:  103.06461598452141
curr_Factors:  [103.06461598]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596501]
Stock Position:  -0.04596501451196545
Bond Position:  [17.98681515]


portfolio before change:  [13.22457004]
curr_Stock_Price:  103.63032349230784
curr_Factors:  [103.63032349]
mat_Sqrt:  [[0.15]]
grads:  [0.21203775]
Stock Position:  0.2120377464671373
Bond Position:  [-8.74897022]


portfolio before change:  [13.2314778]
curr_Stock_Price:  103.66548038522205
curr_Factors:  [103.66548039]
mat_Sqrt:  [[0.15]]
grads:  [0.092584]
Stock Position:  0.0925840037158196
Bond Position:  [3.63371258]


portfolio before change:  [13.26869942]
curr_Stock_Price:  104.06505814275704
curr_Factors:  [104.06505814]
mat_Sqrt:  [[0.15]]
grads:  [0.0118477]
Stock Position:  0.011847698541560665
Bond Position:  [12.03576799]


portfolio before change:  [13.26044059]
curr_Stock_Price:  103.30448071401355
curr_Factors:  [103.30448071]
mat_Sqrt:  [[0.15]]
grads:  [0.06027394]
Stock Position:  0.060273942112567605
Bond Position:  [7.0338723]


portfolio before change:  [13.25516988]
curr_Stock_Price:  103.2097408663565
curr_Factors:  [103.20974087]
mat_Sqrt:  [[0.15]]
grads:  [-0.04822704]
Stock Position:  -0.04822704027177464
Bond Position:  [18.23267021]


portfolio before change:  [13.30188392]
curr_Stock_Price:  102.26474263329274
curr_Factors:  [102.26474263]
mat_Sqrt:  [[0.15]]
grads:  [0.09355897]
Stock Position:  0.09355897100468356
Bond Position:  [3.73409983]


portfolio before change:  [13.32350532]
curr_Stock_Price:  102.49334723774678
curr_Factors:  [102.49334724]
mat_Sqrt:  [[0.15]]
grads:  [-0.04614876]
Stock Position:  -0.046148758541635075
Bond Position:  [18.05344606]


portfolio before change:  [13.37434982]
curr_Stock_Price:  101.41604581544111
curr_Factors:  [101.41604582]
mat_Sqrt:  [[0.15]]
grads:  [0.05854409]
Stock Position:  0.05854409092052093
Bond Position:  [7.43703962]


portfolio before change:  [13.31990041]
curr_Stock_Price:  100.47804780919991
curr_Factors:  [100.47804781]
mat_Sqrt:  [[0.15]]
grads:  [0.29229668]
Stock Position:  0.29229668114571034
Bond Position:  [-16.04949949]


portfolio before change:  [13.32980571]
curr_Stock_Price:  100.5153674945551
curr_Factors:  [100.51536749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186408]
Stock Position:  -0.0018640841667166032
Bond Position:  [13.51717481]


portfolio before change:  [13.33029137]
curr_Stock_Price:  100.70805556756221
curr_Factors:  [100.70805557]
mat_Sqrt:  [[0.15]]
grads:  [0.09419565]
Stock Position:  0.09419565127997764
Bond Position:  [3.84403049]


portfolio before change:  [13.30105758]
curr_Stock_Price:  100.39515311842305
curr_Factors:  [100.39515312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04533432]
Stock Position:  -0.04533431761649091
Bond Position:  [17.85240334]


portfolio before change:  [13.32449039]
curr_Stock_Price:  99.90287695573349
curr_Factors:  [99.90287696]
mat_Sqrt:  [[0.15]]
grads:  [0.03786432]
Stock Position:  0.03786431952774933
Bond Position:  [9.54173594]


portfolio before change:  [13.35489814]
curr_Stock_Price:  100.69019778113014
curr_Factors:  [100.69019778]
mat_Sqrt:  [[0.15]]
grads:  [0.05458752]
Stock Position:  0.054587517257812176
Bond Position:  [7.85847023]


portfolio before change:  [13.35102568]
curr_Stock_Price:  100.61025968068958
curr_Factors:  [100.61025968]
mat_Sqrt:  [[0.15]]
grads:  [-0.02241338]
Stock Position:  -0.02241338326912553
Bond Position:  [15.606042]


portfolio before change:  [13.3711759]
curr_Stock_Price:  99.75475250932925
curr_Factors:  [99.75475251]
mat_Sqrt:  [[0.15]]
grads:  [0.00189256]
Stock Position:  0.0018925560169326106
Bond Position:  [13.18238445]


portfolio before change:  [13.37158477]
curr_Stock_Price:  99.53543958005467
curr_Factors:  [99.53543958]
mat_Sqrt:  [[0.15]]
grads:  [-0.07019162]
Stock Position:  -0.07019162015593423
Bond Position:  [20.35813853]


portfolio before change:  [13.40678008]
curr_Stock_Price:  99.05214982753361
curr_Factors:  [99.05214983]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392576]
Stock Position:  -0.03392576360722068
Bond Position:  [16.7671999]


portfolio before change:  [13.41480927]
curr_Stock_Price:  98.84637085021964
curr_Factors:  [98.84637085]
mat_Sqrt:  [[0.15]]
grads:  [0.03008305]
Stock Position:  0.030083050948041357
Bond Position:  [10.44120886]


portfolio before change:  [13.42296446]
curr_Stock_Price:  99.09576683590551
curr_Factors:  [99.09576684]
mat_Sqrt:  [[0.15]]
grads:  [0.08183837]
Stock Position:  0.08183837254169649
Bond Position:  [5.31312818]


portfolio before change:  [13.46651666]
curr_Stock_Price:  99.62388236121821
curr_Factors:  [99.62388236]
mat_Sqrt:  [[0.15]]
grads:  [0.08887187]
Stock Position:  0.08887187444154215
Bond Position:  [4.61275549]


portfolio before change:  [13.48297128]
curr_Stock_Price:  99.8057883124075
curr_Factors:  [99.80578831]
mat_Sqrt:  [[0.15]]
grads:  [-0.23261546]
Stock Position:  -0.2326154551127877
Bond Position:  [36.69934016]


portfolio before change:  [13.38019436]
curr_Stock_Price:  100.25748101465943
curr_Factors:  [100.25748101]
mat_Sqrt:  [[0.15]]
grads:  [0.06483837]
Stock Position:  0.06483836947744333
Bond Position:  [6.87966276]


portfolio before change:  [13.38338733]
curr_Stock_Price:  100.3000942524223
curr_Factors:  [100.30009425]
mat_Sqrt:  [[0.15]]
grads:  [-0.0383]
Stock Position:  -0.038299998777740964
Bond Position:  [17.22488081]


portfolio before change:  [13.37826386]
curr_Stock_Price:  100.46197570699846
curr_Factors:  [100.46197571]
mat_Sqrt:  [[0.15]]
grads:  [0.14842941]
Stock Position:  0.14842941062121262
Bond Position:  [-1.53324799]


portfolio before change:  [13.46651209]
curr_Stock_Price:  101.05716818482044
curr_Factors:  [101.05716818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03867045]
Stock Position:  -0.03867045433317094
Bond Position:  [17.3744387]


portfolio before change:  [13.47874746]
curr_Stock_Price:  100.76884910910852
curr_Factors:  [100.76884911]
mat_Sqrt:  [[0.15]]
grads:  [-0.0997001]
Stock Position:  -0.09970009603069623
Bond Position:  [23.52541139]


portfolio before change:  [13.39317545]
curr_Stock_Price:  101.64189138870633
curr_Factors:  [101.64189139]
mat_Sqrt:  [[0.15]]
grads:  [0.14548903]
Stock Position:  0.14548903261244758
Bond Position:  [-1.39460501]


portfolio before change:  [13.3488747]
curr_Stock_Price:  101.3379951073551
curr_Factors:  [101.33799511]
mat_Sqrt:  [[0.15]]
grads:  [0.01300757]
Stock Position:  0.013007569132447997
Bond Position:  [12.03071373]


portfolio before change:  [13.35150668]
curr_Stock_Price:  101.48252874301977
curr_Factors:  [101.48252874]
mat_Sqrt:  [[0.15]]
grads:  [-0.03981061]
Stock Position:  -0.039810614611331945
Bond Position:  [17.39158852]


portfolio before change:  [13.32571435]
curr_Stock_Price:  102.15770898885535
curr_Factors:  [102.15770899]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295619]
Stock Position:  -0.07295618976842687
Bond Position:  [20.77875155]


portfolio before change:  [13.27820934]
curr_Stock_Price:  102.82665455470983
curr_Factors:  [102.82665455]
mat_Sqrt:  [[0.15]]
grads:  [0.09397942]
Stock Position:  0.09397941948945462
Bond Position:  [3.61462004]


portfolio before change:  [13.24740399]
curr_Stock_Price:  102.49646236437071
curr_Factors:  [102.49646236]
mat_Sqrt:  [[0.15]]
grads:  [0.01055605]
Stock Position:  0.010556052196176072
Bond Position:  [12.16544598]


portfolio before change:  [13.25564354]
curr_Stock_Price:  103.20498321689809
curr_Factors:  [103.20498322]
mat_Sqrt:  [[0.15]]
grads:  [0.02014143]
Stock Position:  0.02014142761596293
Bond Position:  [11.17694784]


portfolio before change:  [13.227577]
curr_Stock_Price:  101.77682660567206
curr_Factors:  [101.77682661]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014109]
Stock Position:  -0.050141090698520206
Bond Position:  [18.3307781]


portfolio before change:  [13.2280786]
curr_Stock_Price:  101.78967254015961
curr_Factors:  [101.78967254]
mat_Sqrt:  [[0.15]]
grads:  [-0.10575011]
Stock Position:  -0.10575011305207899
Bond Position:  [23.99234798]


portfolio before change:  [13.19698022]
curr_Stock_Price:  102.0979271269588
curr_Factors:  [102.09792713]
mat_Sqrt:  [[0.15]]
grads:  [0.00718674]
Stock Position:  0.007186735472726642
Bond Position:  [12.46322942]


portfolio before change:  [13.19911417]
curr_Stock_Price:  102.286466169612
curr_Factors:  [102.28646617]
mat_Sqrt:  [[0.15]]
grads:  [-0.04860468]
Stock Position:  -0.04860467931550503
Bond Position:  [18.17071506]


portfolio before change:  [13.22157336]
curr_Stock_Price:  101.84775353126732
curr_Factors:  [101.84775353]
mat_Sqrt:  [[0.15]]
grads:  [0.0363415]
Stock Position:  0.036341496541142285
Bond Position:  [9.52027358]


portfolio before change:  [13.23619193]
curr_Stock_Price:  102.23363561269281
curr_Factors:  [102.23363561]
mat_Sqrt:  [[0.15]]
grads:  [-0.0077107]
Stock Position:  -0.007710701270026933
Bond Position:  [14.02448496]


portfolio before change:  [13.23920809]
curr_Stock_Price:  101.95615131632795
curr_Factors:  [101.95615132]
mat_Sqrt:  [[0.15]]
grads:  [-0.00067269]
Stock Position:  -0.0006726916426289439
Bond Position:  [13.30779314]


portfolio before change:  [13.23981953]
curr_Stock_Price:  102.28367935777385
curr_Factors:  [102.28367936]
mat_Sqrt:  [[0.15]]
grads:  [0.0609326]
Stock Position:  0.060932601809511946
Bond Position:  [7.00740882]


portfolio before change:  [13.20714796]
curr_Stock_Price:  101.74029965052172
curr_Factors:  [101.74029965]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456787]
Stock Position:  -0.004567866827166213
Bond Position:  [13.6718841]


portfolio before change:  [13.20625374]
curr_Stock_Price:  102.1231346151895
curr_Factors:  [102.12313462]
mat_Sqrt:  [[0.15]]
grads:  [0.01094891]
Stock Position:  0.010948911056271203
Bond Position:  [12.08811663]


portfolio before change:  [13.21141888]
curr_Stock_Price:  102.52587824229425
curr_Factors:  [102.52587824]
mat_Sqrt:  [[0.15]]
grads:  [0.10669593]
Stock Position:  0.10669592881021837
Bond Position:  [2.27232507]


portfolio before change:  [13.24384689]
curr_Stock_Price:  102.82847636974145
curr_Factors:  [102.82847637]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365502]
Stock Position:  -0.013655017275196272
Bond Position:  [14.64797151]


portfolio before change:  [13.24594612]
curr_Stock_Price:  102.74178992485773
curr_Factors:  [102.74178992]
mat_Sqrt:  [[0.15]]
grads:  [0.09587824]
Stock Position:  0.0958782417236035
Bond Position:  [3.39524395]


portfolio before change:  [13.28066315]
curr_Stock_Price:  103.10167151051296
curr_Factors:  [103.10167151]
mat_Sqrt:  [[0.15]]
grads:  [0.01384445]
Stock Position:  0.013844446594650062
Bond Position:  [11.85327756]


portfolio before change:  [13.28133229]
curr_Stock_Price:  103.09649164975524
curr_Factors:  [103.09649165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0832342]
Stock Position:  -0.08323420231696083
Bond Position:  [21.86248653]


portfolio before change:  [13.25742368]
curr_Stock_Price:  103.40015350807222
curr_Factors:  [103.40015351]
mat_Sqrt:  [[0.15]]
grads:  [0.0359468]
Stock Position:  0.03594680496394907
Bond Position:  [9.54051853]


portfolio before change:  [13.27607567]
curr_Stock_Price:  103.9024424174814
curr_Factors:  [103.90244242]
mat_Sqrt:  [[0.15]]
grads:  [0.02489962]
Stock Position:  0.024899620941317424
Bond Position:  [10.68894423]


portfolio before change:  [13.28818657]
curr_Stock_Price:  104.36200044761446
curr_Factors:  [104.36200045]
mat_Sqrt:  [[0.15]]
grads:  [-0.0355916]
Stock Position:  -0.035591603302087514
Bond Position:  [17.00259749]


portfolio before change:  [13.28890315]
curr_Stock_Price:  104.37172510328163
curr_Factors:  [104.3717251]
mat_Sqrt:  [[0.15]]
grads:  [0.10214573]
Stock Position:  0.10214572941041332
Bond Position:  [2.62777716]


portfolio before change:  [13.24870042]
curr_Stock_Price:  103.97653511238813
curr_Factors:  [103.97653511]
mat_Sqrt:  [[0.15]]
grads:  [-0.05637146]
Stock Position:  -0.05637145634506787
Bond Position:  [19.11000913]


portfolio before change:  [13.29386483]
curr_Stock_Price:  103.19653046131607
curr_Factors:  [103.19653046]
mat_Sqrt:  [[0.15]]
grads:  [0.05262352]
Stock Position:  0.052623524928926205
Bond Position:  [7.86329963]


portfolio before change:  [13.3043373]
curr_Stock_Price:  103.38619847777579
curr_Factors:  [103.38619848]
mat_Sqrt:  [[0.15]]
grads:  [-0.08734963]
Stock Position:  -0.08734962536837283
Bond Position:  [22.335083]


portfolio before change:  [13.2161065]
curr_Stock_Price:  104.41226801230668
curr_Factors:  [104.41226801]
mat_Sqrt:  [[0.15]]
grads:  [0.0907983]
Stock Position:  0.09079829912887974
Bond Position:  [3.73565015]


portfolio before change:  [13.26615922]
curr_Stock_Price:  104.96094831082644
curr_Factors:  [104.96094831]
mat_Sqrt:  [[0.15]]
grads:  [-0.05774642]
Stock Position:  -0.05774641541743192
Bond Position:  [19.32727774]


portfolio before change:  [13.28053308]
curr_Stock_Price:  104.73295368978782
curr_Factors:  [104.73295369]
mat_Sqrt:  [[0.15]]
grads:  [0.17020081]
Stock Position:  0.17020081102265694
Bond Position:  [-4.54510057]


portfolio before change:  [13.3229098]
curr_Stock_Price:  104.98360343093904
curr_Factors:  [104.98360343]
mat_Sqrt:  [[0.15]]
grads:  [-0.1708908]
Stock Position:  -0.17089080403736528
Bond Position:  [31.2636422]


portfolio before change:  [13.4200685]
curr_Stock_Price:  104.42649526869532
curr_Factors:  [104.42649527]
mat_Sqrt:  [[0.15]]
grads:  [0.0069425]
Stock Position:  0.006942498408751933
Bond Position:  [12.69508772]


portfolio before change:  [13.41894332]
curr_Stock_Price:  104.15013241566109
curr_Factors:  [104.15013242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02455681]
Stock Position:  -0.02455681257842594
Bond Position:  [15.9765386]


portfolio before change:  [13.41393812]
curr_Stock_Price:  104.3946167474946
curr_Factors:  [104.39461675]
mat_Sqrt:  [[0.15]]
grads:  [-0.06410677]
Stock Position:  -0.06410676934949106
Bond Position:  [20.10633974]


portfolio before change:  [13.41757317]
curr_Stock_Price:  104.35751669376553
curr_Factors:  [104.35751669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.41757317]
Stock Price:  104.75730313292841
PL:  [8.66027004]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.65652975e-03]
 [ 4.59451070e-04]
 [-3.05913690e-03]
 [ 7.42420398e-03]
 [ 4.23459042e-03]
 [ 2.81298432e-02]
 [ 1.60296579e-03]
 [-1.83710785e-02]
 [ 1.49901843e-02]
 [ 2.24739963e-03]
 [ 1.34792804e-02]
 [-3.32053507e-03]
 [ 2.05945267e-02]
 [ 1.11155215e-03]
 [-6.91353594e-03]
 [ 1.38439348e-02]
 [ 1.05462107e-02]
 [-1.05755738e-02]
 [ 1.50871393e-03]
 [ 3.80526704e-03]
 [ 1.20799356e-02]
 [-6.17062424e-03]
 [ 6.81210840e-03]
 [ 4.21703170e-02]
 [-6.60316520e-03]
 [ 4.74333983e-03]
 [-7.12232416e-03]
 [ 5.75779152e-03]
 [ 8.59059552e-03]
 [-2.51646669e-03]
 [ 6.46678439e-03]
 [-1.20859841e-02]
 [ 3.91136621e-03]
 [ 6.83135312e-03]
 [ 1.14501082e-02]
 [ 8.60560161e-03]
 [-3.34831816e-02]
 [ 9.47779301e-03]
 [ 4.49104884e-03]
 [ 1.99425289e-02]
 [-4.41163049e-03]
 [-2.03103352e-02]
 [ 2.09053900e-02]
 [-1.10048465e-03]
 [ 9.59456644e-04]
 [-1.56596728e-02]
 [ 1.47722226e-02]
 [ 1.09079848e-02]
 [ 6.15594984e-03]
 [-7.52427001e-03]
 [-1.39810478e-02]
 [ 2.80308766e-03]
 [-8.03354598e-03]
 [ 5.62398493e-03]
 [-7.92115595e-03]
 [ 6.52938766e-03]
 [ 1.02757729e-02]
 [-1.59154878e-04]
 [ 1.72164276e-03]
 [ 1.69790897e-02]
 [ 8.92974046e-04]
 [ 2.73916276e-02]
 [ 2.42244745e-03]
 [-1.23905137e-02]
 [ 1.51301190e-02]
 [ 7.01272201e-03]
 [-5.41244871e-03]
 [ 1.50051680e-02]
 [-8.44062159e-03]
 [ 5.33330264e-04]
 [-1.26323198e-02]
 [ 1.34082804e-02]
 [-4.38344418e-03]
 [ 2.52490351e-02]
 [-2.60411484e-02]
 [ 1.17674763e-03]
 [-3.69326200e-03]
 [-1.16062006e-02]
 [ 2.54363158e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.22284967]
curr_Stock_Price:  99.59265592937813
curr_Factors:  [99.59265593]
mat_Sqrt:  [[0.15]]
grads:  [0.02437687]
Stock Position:  0.024376865032109826
Bond Position:  [-6.6506064]


portfolio before change:  [-4.22031689]
curr_Stock_Price:  99.71360899067318
curr_Factors:  [99.71360899]
mat_Sqrt:  [[0.15]]
grads:  [0.00306301]
Stock Position:  0.0030630071354495877
Bond Position:  [-4.52574039]


portfolio before change:  [-4.22274888]
curr_Stock_Price:  99.01197133074334
curr_Factors:  [99.01197133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02039425]
Stock Position:  -0.020394246023876135
Bond Position:  [-2.20347438]


portfolio before change:  [-4.22349102]
curr_Stock_Price:  99.04160834999485
curr_Factors:  [99.04160835]
mat_Sqrt:  [[0.15]]
grads:  [0.04949469]
Stock Position:  0.04949469317402772
Bond Position:  [-9.12552504]


portfolio before change:  [-4.20105093]
curr_Stock_Price:  99.50651587041021
curr_Factors:  [99.50651587]
mat_Sqrt:  [[0.15]]
grads:  [0.0282306]
Stock Position:  0.028230602808421157
Bond Position:  [-7.01017986]


portfolio before change:  [-4.16983489]
curr_Stock_Price:  100.6277880203001
curr_Factors:  [100.62778802]
mat_Sqrt:  [[0.15]]
grads:  [0.18753229]
Stock Position:  0.1875322879838802
Bond Position:  [-23.04079422]


portfolio before change:  [-4.23707527]
curr_Stock_Price:  100.27691360832154
curr_Factors:  [100.27691361]
mat_Sqrt:  [[0.15]]
grads:  [0.01068644]
Stock Position:  0.010686438606806934
Bond Position:  [-5.30867835]


portfolio before change:  [-4.24225274]
curr_Stock_Price:  99.82347296726147
curr_Factors:  [99.82347297]
mat_Sqrt:  [[0.15]]
grads:  [-0.12247386]
Stock Position:  -0.12247385695416702
Bond Position:  [7.98351301]


portfolio before change:  [-4.23250406]
curr_Stock_Price:  99.74794918649914
curr_Factors:  [99.74794919]
mat_Sqrt:  [[0.15]]
grads:  [0.09993456]
Stock Position:  0.09993456207080066
Bond Position:  [-14.20077168]


portfolio before change:  [-4.23455681]
curr_Stock_Price:  99.73628988296299
curr_Factors:  [99.73628988]
mat_Sqrt:  [[0.15]]
grads:  [0.01498266]
Stock Position:  0.014982664189449678
Bond Position:  [-5.72887215]


portfolio before change:  [-4.23502174]
curr_Stock_Price:  99.72915745823711
curr_Factors:  [99.72915746]
mat_Sqrt:  [[0.15]]
grads:  [0.08986187]
Stock Position:  0.08986186948276977
Bond Position:  [-13.19687027]


portfolio before change:  [-4.22793517]
curr_Stock_Price:  99.81719701131533
curr_Factors:  [99.81719701]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221369]
Stock Position:  -0.02213690043540887
Bond Position:  [-2.01829182]


portfolio before change:  [-4.25066616]
curr_Stock_Price:  100.83833580419335
curr_Factors:  [100.8383358]
mat_Sqrt:  [[0.15]]
grads:  [0.13729684]
Stock Position:  0.13729684474781476
Bond Position:  [-18.0954515]


portfolio before change:  [-4.29992788]
curr_Stock_Price:  100.48777628428655
curr_Factors:  [100.48777628]
mat_Sqrt:  [[0.15]]
grads:  [0.00741035]
Stock Position:  0.007410347659269588
Bond Position:  [-5.04457724]


portfolio before change:  [-4.30379585]
curr_Stock_Price:  100.00835595010945
curr_Factors:  [100.00835595]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609024]
Stock Position:  -0.0460902396188863
Bond Position:  [0.30561324]


portfolio before change:  [-4.31901073]
curr_Stock_Price:  100.33888122560248
curr_Factors:  [100.33888123]
mat_Sqrt:  [[0.15]]
grads:  [0.0922929]
Stock Position:  0.09229289862162383
Bond Position:  [-13.57957693]


portfolio before change:  [-4.24958322]
curr_Stock_Price:  101.10032945814132
curr_Factors:  [101.10032946]
mat_Sqrt:  [[0.15]]
grads:  [0.07030807]
Stock Position:  0.07030807104050302
Bond Position:  [-11.35775237]


portfolio before change:  [-4.20061363]
curr_Stock_Price:  101.80692645791788
curr_Factors:  [101.80692646]
mat_Sqrt:  [[0.15]]
grads:  [-0.07050383]
Stock Position:  -0.07050382520933422
Bond Position:  [2.97716412]


portfolio before change:  [-4.19477292]
curr_Stock_Price:  101.72672322406429
curr_Factors:  [101.72672322]
mat_Sqrt:  [[0.15]]
grads:  [0.01005809]
Stock Position:  0.01005809284631454
Bond Position:  [-5.21794974]


portfolio before change:  [-4.20515956]
curr_Stock_Price:  100.72648272634916
curr_Factors:  [100.72648273]
mat_Sqrt:  [[0.15]]
grads:  [0.02536845]
Stock Position:  0.02536844691569107
Bond Position:  [-6.76043399]


portfolio before change:  [-4.20563325]
curr_Stock_Price:  100.72446661313957
curr_Factors:  [100.72446661]
mat_Sqrt:  [[0.15]]
grads:  [0.0805329]
Stock Position:  0.08053290422511385
Bond Position:  [-12.31726707]


portfolio before change:  [-4.20579602]
curr_Stock_Price:  100.73200493949263
curr_Factors:  [100.73200494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04113749]
Stock Position:  -0.04113749490928393
Bond Position:  [-0.06193368]


portfolio before change:  [-4.17039623]
curr_Stock_Price:  99.8713871724726
curr_Factors:  [99.87138717]
mat_Sqrt:  [[0.15]]
grads:  [0.04541406]
Stock Position:  0.04541405602345978
Bond Position:  [-8.705961]


portfolio before change:  [-4.14059677]
curr_Stock_Price:  100.53954149508185
curr_Factors:  [100.5395415]
mat_Sqrt:  [[0.15]]
grads:  [0.28113545]
Stock Position:  0.28113544686234887
Bond Position:  [-32.4058257]


portfolio before change:  [-4.45357283]
curr_Stock_Price:  99.43348873861723
curr_Factors:  [99.43348874]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440211]
Stock Position:  -0.044021101330119716
Bond Position:  [-0.07640115]


portfolio before change:  [-4.45638094]
curr_Stock_Price:  99.49717018663067
curr_Factors:  [99.49717019]
mat_Sqrt:  [[0.15]]
grads:  [0.03162227]
Stock Position:  0.0316222655603985
Bond Position:  [-7.60270687]


portfolio before change:  [-4.45028876]
curr_Stock_Price:  99.7048517626336
curr_Factors:  [99.70485176]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748216]
Stock Position:  -0.04748216107830169
Bond Position:  [0.28391307]


portfolio before change:  [-4.46847328]
curr_Stock_Price:  100.08820130069127
curr_Factors:  [100.0882013]
mat_Sqrt:  [[0.15]]
grads:  [0.03838528]
Stock Position:  0.03838527683252531
Bond Position:  [-8.31038659]


portfolio before change:  [-4.44479892]
curr_Stock_Price:  100.71848925098047
curr_Factors:  [100.71848925]
mat_Sqrt:  [[0.15]]
grads:  [0.05727064]
Stock Position:  0.057270636829251514
Bond Position:  [-10.21301094]


portfolio before change:  [-4.42237046]
curr_Stock_Price:  101.12125744882528
curr_Factors:  [101.12125745]
mat_Sqrt:  [[0.15]]
grads:  [-0.01677644]
Stock Position:  -0.016776444582450565
Bond Position:  [-2.72591529]


portfolio before change:  [-4.41442365]
curr_Stock_Price:  100.63741343386573
curr_Factors:  [100.63741343]
mat_Sqrt:  [[0.15]]
grads:  [0.0431119]
Stock Position:  0.04311189595870349
Bond Position:  [-8.75309335]


portfolio before change:  [-4.42940073]
curr_Stock_Price:  100.30270319527322
curr_Factors:  [100.3027032]
mat_Sqrt:  [[0.15]]
grads:  [-0.08057323]
Stock Position:  -0.08057322705950677
Bond Position:  [3.65231175]


portfolio before change:  [-4.42697854]
curr_Stock_Price:  100.27547441152032
curr_Factors:  [100.27547441]
mat_Sqrt:  [[0.15]]
grads:  [0.02607577]
Stock Position:  0.026075774734187346
Bond Position:  [-7.04173922]


portfolio before change:  [-4.41862148]
curr_Stock_Price:  100.6128443167471
curr_Factors:  [100.61284432]
mat_Sqrt:  [[0.15]]
grads:  [0.04554235]
Stock Position:  0.045542354125086414
Bond Position:  [-9.00076727]


portfolio before change:  [-4.39696641]
curr_Stock_Price:  101.10068982952701
curr_Factors:  [101.10068983]
mat_Sqrt:  [[0.15]]
grads:  [0.07633405]
Stock Position:  0.07633405487322799
Bond Position:  [-12.11439202]


portfolio before change:  [-4.36627237]
curr_Stock_Price:  101.51271065833959
curr_Factors:  [101.51271066]
mat_Sqrt:  [[0.15]]
grads:  [0.05737068]
Stock Position:  0.05737067740011826
Bond Position:  [-10.19012534]


portfolio before change:  [-4.32901833]
curr_Stock_Price:  102.17316900406915
curr_Factors:  [102.173169]
mat_Sqrt:  [[0.15]]
grads:  [-0.22322121]
Stock Position:  -0.22322121043023876
Bond Position:  [18.47820013]


portfolio before change:  [-4.30124414]
curr_Stock_Price:  102.05391839189727
curr_Factors:  [102.05391839]
mat_Sqrt:  [[0.15]]
grads:  [0.06318529]
Stock Position:  0.06318528676308313
Bond Position:  [-10.74955024]


portfolio before change:  [-4.3215451]
curr_Stock_Price:  101.74325917490084
curr_Factors:  [101.74325917]
mat_Sqrt:  [[0.15]]
grads:  [0.02994033]
Stock Position:  0.02994032560911642
Bond Position:  [-7.36777141]


portfolio before change:  [-4.3178317]
curr_Stock_Price:  101.88266645145168
curr_Factors:  [101.88266645]
mat_Sqrt:  [[0.15]]
grads:  [0.13295019]
Stock Position:  0.13295019245830583
Bond Position:  [-17.86315181]


portfolio before change:  [-4.19939176]
curr_Stock_Price:  102.78192363360901
curr_Factors:  [102.78192363]
mat_Sqrt:  [[0.15]]
grads:  [-0.02941087]
Stock Position:  -0.02941086992952869
Bond Position:  [-1.17648598]


portfolio before change:  [-4.19545475]
curr_Stock_Price:  102.64556087128558
curr_Factors:  [102.64556087]
mat_Sqrt:  [[0.15]]
grads:  [-0.13540223]
Stock Position:  -0.13540223448294028
Bond Position:  [9.70298355]


portfolio before change:  [-4.23133228]
curr_Stock_Price:  102.91500976071838
curr_Factors:  [102.91500976]
mat_Sqrt:  [[0.15]]
grads:  [0.13936927]
Stock Position:  0.1393692663696722
Bond Position:  [-18.57452168]


portfolio before change:  [-4.2102366]
curr_Stock_Price:  103.0747051136655
curr_Factors:  [103.07470511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00733656]
Stock Position:  -0.007336564337026402
Bond Position:  [-3.45402239]


portfolio before change:  [-4.2096178]
curr_Stock_Price:  102.96093514806293
curr_Factors:  [102.96093515]
mat_Sqrt:  [[0.15]]
grads:  [0.00639638]
Stock Position:  0.006396377629735786
Bond Position:  [-4.86819482]


portfolio before change:  [-4.207769]
curr_Stock_Price:  103.29754249445614
curr_Factors:  [103.29754249]
mat_Sqrt:  [[0.15]]
grads:  [-0.10439782]
Stock Position:  -0.10439781875614824
Bond Position:  [6.57626912]


portfolio before change:  [-4.26422599]
curr_Stock_Price:  103.84226671135359
curr_Factors:  [103.84226671]
mat_Sqrt:  [[0.15]]
grads:  [0.09848148]
Stock Position:  0.09848148423210988
Bond Position:  [-14.49076654]


portfolio before change:  [-4.24339481]
curr_Stock_Price:  104.06298717871535
curr_Factors:  [104.06298718]
mat_Sqrt:  [[0.15]]
grads:  [0.0727199]
Stock Position:  0.07271989853292463
Bond Position:  [-11.81084468]


portfolio before change:  [-4.20551761]
curr_Stock_Price:  104.59400277701381
curr_Factors:  [104.59400278]
mat_Sqrt:  [[0.15]]
grads:  [0.04103967]
Stock Position:  0.0410396656230169
Bond Position:  [-8.49802051]


portfolio before change:  [-4.19327862]
curr_Stock_Price:  104.90516861168686
curr_Factors:  [104.90516861]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501618]
Stock Position:  -0.050161800037219095
Bond Position:  [1.06895348]


portfolio before change:  [-4.15736101]
curr_Stock_Price:  104.19046553071591
curr_Factors:  [104.19046553]
mat_Sqrt:  [[0.15]]
grads:  [-0.09320699]
Stock Position:  -0.09320698562307869
Bond Position:  [5.55391821]


portfolio before change:  [-4.1083579]
curr_Stock_Price:  103.66844478606866
curr_Factors:  [103.66844479]
mat_Sqrt:  [[0.15]]
grads:  [0.01868725]
Stock Position:  0.018687251082599086
Bond Position:  [-6.04563616]


portfolio before change:  [-4.1287416]
curr_Stock_Price:  102.59788405724944
curr_Factors:  [102.59788406]
mat_Sqrt:  [[0.15]]
grads:  [-0.05355697]
Stock Position:  -0.05355697322541231
Bond Position:  [1.36609053]


portfolio before change:  [-4.13845396]
curr_Stock_Price:  102.78082454928399
curr_Factors:  [102.78082455]
mat_Sqrt:  [[0.15]]
grads:  [0.03749323]
Stock Position:  0.03749323286334347
Bond Position:  [-7.99203935]


portfolio before change:  [-4.11412346]
curr_Stock_Price:  103.44307790526882
curr_Factors:  [103.44307791]
mat_Sqrt:  [[0.15]]
grads:  [-0.05280771]
Stock Position:  -0.05280770631027293
Bond Position:  [1.34846822]


portfolio before change:  [-4.09724281]
curr_Stock_Price:  103.12501137034867
curr_Factors:  [103.12501137]
mat_Sqrt:  [[0.15]]
grads:  [0.04352925]
Stock Position:  0.043529251083022955
Bond Position:  [-8.58619732]


portfolio before change:  [-4.07452465]
curr_Stock_Price:  103.6592455640402
curr_Factors:  [103.65924556]
mat_Sqrt:  [[0.15]]
grads:  [0.06850515]
Stock Position:  0.06850515283231591
Bond Position:  [-11.17571711]


portfolio before change:  [-4.12256429]
curr_Stock_Price:  102.96818612035636
curr_Factors:  [102.96818612]
mat_Sqrt:  [[0.15]]
grads:  [-0.00106103]
Stock Position:  -0.0010610325213075687
Bond Position:  [-4.01331169]


portfolio before change:  [-4.1231276]
curr_Stock_Price:  103.262688594018
curr_Factors:  [103.26268859]
mat_Sqrt:  [[0.15]]
grads:  [0.01147762]
Stock Position:  0.01147761839821141
Bond Position:  [-5.30833734]


portfolio before change:  [-4.12457303]
curr_Stock_Price:  103.16566072143596
curr_Factors:  [103.16566072]
mat_Sqrt:  [[0.15]]
grads:  [0.11319393]
Stock Position:  0.11319393117980552
Bond Position:  [-15.80229973]


portfolio before change:  [-4.09818931]
curr_Stock_Price:  103.40747050682788
curr_Factors:  [103.40747051]
mat_Sqrt:  [[0.15]]
grads:  [0.00595316]
Stock Position:  0.0059531603055228265
Bond Position:  [-4.71379056]


portfolio before change:  [-4.09185353]
curr_Stock_Price:  104.52123238911281
curr_Factors:  [104.52123239]
mat_Sqrt:  [[0.15]]
grads:  [0.18261085]
Stock Position:  0.1826108509088539
Bond Position:  [-23.17856471]


portfolio before change:  [-4.09053911]
curr_Stock_Price:  104.53636357778646
curr_Factors:  [104.53636358]
mat_Sqrt:  [[0.15]]
grads:  [0.01614965]
Stock Position:  0.01614964966969001
Bond Position:  [-5.77876476]


portfolio before change:  [-4.08085138]
curr_Stock_Price:  105.15860122997006
curr_Factors:  [105.15860123]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260342]
Stock Position:  -0.08260342448488953
Bond Position:  [4.6056092]


portfolio before change:  [-4.11997119]
curr_Stock_Price:  105.6356719556164
curr_Factors:  [105.63567196]
mat_Sqrt:  [[0.15]]
grads:  [0.10086746]
Stock Position:  0.10086746003685729
Bond Position:  [-14.77517311]


portfolio before change:  [-4.1316579]
curr_Stock_Price:  105.52896529813782
curr_Factors:  [105.5289653]
mat_Sqrt:  [[0.15]]
grads:  [0.04675148]
Stock Position:  0.046751480064555304
Bond Position:  [-9.06529322]


portfolio before change:  [-4.2140117]
curr_Stock_Price:  103.7795617370785
curr_Factors:  [103.77956174]
mat_Sqrt:  [[0.15]]
grads:  [-0.03608299]
Stock Position:  -0.03608299141678941
Bond Position:  [-0.46933467]


portfolio before change:  [-4.21288057]
curr_Stock_Price:  103.74740069122312
curr_Factors:  [103.74740069]
mat_Sqrt:  [[0.15]]
grads:  [0.10003445]
Stock Position:  0.10003445312298405
Bond Position:  [-14.59119506]


portfolio before change:  [-4.1995844]
curr_Stock_Price:  103.88943322750492
curr_Factors:  [103.88943323]
mat_Sqrt:  [[0.15]]
grads:  [-0.05627081]
Stock Position:  -0.05627081060475389
Bond Position:  [1.64635822]


portfolio before change:  [-4.19926808]
curr_Stock_Price:  103.88564053311774
curr_Factors:  [103.88564053]
mat_Sqrt:  [[0.15]]
grads:  [0.00355554]
Stock Position:  0.0035555350959680493
Bond Position:  [-4.56863712]


portfolio before change:  [-4.1979499]
curr_Stock_Price:  104.33669255654345
curr_Factors:  [104.33669256]
mat_Sqrt:  [[0.15]]
grads:  [-0.08421547]
Stock Position:  -0.08421546513947505
Bond Position:  [4.58881319]


portfolio before change:  [-4.18024903]
curr_Stock_Price:  104.12991265145997
curr_Factors:  [104.12991265]
mat_Sqrt:  [[0.15]]
grads:  [0.08938854]
Stock Position:  0.0893885362247938
Bond Position:  [-13.48826949]


portfolio before change:  [-4.15530444]
curr_Stock_Price:  104.41840187756259
curr_Factors:  [104.41840188]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922296]
Stock Position:  -0.02922296121615671
Bond Position:  [-1.10388953]


portfolio before change:  [-4.15997496]
curr_Stock_Price:  104.57586459340999
curr_Factors:  [104.57586459]
mat_Sqrt:  [[0.15]]
grads:  [0.1683269]
Stock Position:  0.1683269003757776
Bond Position:  [-21.7629061]


portfolio before change:  [-4.04792545]
curr_Stock_Price:  105.24961152278823
curr_Factors:  [105.24961152]
mat_Sqrt:  [[0.15]]
grads:  [-0.17360766]
Stock Position:  -0.1736076560376097
Bond Position:  [14.2242129]


portfolio before change:  [-3.91962204]
curr_Stock_Price:  104.51569015824947
curr_Factors:  [104.51569016]
mat_Sqrt:  [[0.15]]
grads:  [0.00784498]
Stock Position:  0.007844984217464114
Bond Position:  [-4.73954598]


portfolio before change:  [-3.92280133]
curr_Stock_Price:  104.14818753492843
curr_Factors:  [104.14818753]
mat_Sqrt:  [[0.15]]
grads:  [-0.02462175]
Stock Position:  -0.024621746646721628
Bond Position:  [-1.35849104]


portfolio before change:  [-3.94711682]
curr_Stock_Price:  105.13230061504561
curr_Factors:  [105.13230062]
mat_Sqrt:  [[0.15]]
grads:  [-0.07737467]
Stock Position:  -0.07737467063208622
Bond Position:  [4.18746031]


portfolio before change:  [-3.99262384]
curr_Stock_Price:  105.7238216522673
curr_Factors:  [105.72382165]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.99262384]
Stock Price:  105.70387709725053
PL:  [-9.69650094]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.47889876e-03]
 [ 1.82956005e-03]
 [-5.51503510e-04]
 [ 8.51832741e-03]
 [ 1.31165773e-03]
 [ 1.44999483e-02]
 [ 3.37978755e-03]
 [-2.45009709e-02]
 [-1.47537328e-02]
 [ 2.26862227e-02]
 [ 9.02604031e-03]
 [ 1.85302174e-02]
 [-1.29635364e-02]
 [ 3.69138551e-03]
 [-7.06041179e-03]
 [ 1.08667197e-02]
 [ 1.46076300e-02]
 [ 1.27633411e-02]
 [ 1.51054085e-03]
 [ 1.36692902e-02]
 [ 1.32251256e-02]
 [-1.21787061e-02]
 [-5.32556477e-03]
 [-1.79289063e-01]
 [-1.43586533e-02]
 [ 3.31519427e-03]
 [ 4.81266097e-03]
 [ 1.59746271e-02]
 [-7.39013257e-02]
 [ 5.70065078e-03]
 [ 1.90145443e-02]
 [-1.27161940e-02]
 [-6.91968801e-03]
 [ 6.76815045e-03]
 [ 1.37459586e-02]
 [ 8.16308517e-03]
 [-3.29846291e-02]
 [ 8.27879393e-03]
 [-3.28672136e-02]
 [ 1.26334690e-02]
 [-1.27593607e-02]
 [ 4.48363100e-02]
 [ 2.32809200e-02]
 [ 3.54935090e-03]
 [ 9.93970478e-03]
 [ 2.99531923e-02]
 [-3.45899591e-03]
 [-4.60776498e-03]
 [ 1.88966785e-02]
 [ 5.35902186e-03]
 [ 3.91051076e-02]
 [-3.32173404e-03]
 [ 2.00980669e-03]
 [ 4.98002251e-03]
 [ 4.20891590e-03]
 [-1.15725412e-03]
 [ 1.70085305e-03]
 [-6.84714847e-04]
 [ 1.54302769e-03]
 [-1.12532465e-02]
 [-5.92985786e-03]
 [ 1.40817637e-02]
 [ 1.45942530e-02]
 [-1.90794178e-02]
 [-4.54821925e-03]
 [-1.58977509e-02]
 [-4.36324303e-03]
 [ 4.46175321e-03]
 [-1.59388462e-02]
 [ 1.22406820e-02]
 [ 8.35708813e-03]
 [ 1.26431889e-02]
 [ 3.67924982e-03]
 [-6.05886945e-04]
 [ 7.52130756e-03]
 [-1.64907297e-02]
 [ 5.11923882e-03]
 [ 5.04369401e-03]
 [-3.66197814e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.7136509]
curr_Stock_Price:  99.91365167612432
curr_Factors:  [99.91365168]
mat_Sqrt:  [[0.15]]
grads:  [0.01652599]
Stock Position:  0.01652599176346928
Bond Position:  [-0.93752128]


portfolio before change:  [0.72749213]
curr_Stock_Price:  100.7547402648566
curr_Factors:  [100.75474026]
mat_Sqrt:  [[0.15]]
grads:  [0.01219707]
Stock Position:  0.012197067031227532
Bond Position:  [-0.50142019]


portfolio before change:  [0.713288]
curr_Stock_Price:  99.59275736199298
curr_Factors:  [99.59275736]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367669]
Stock Position:  -0.0036766900635385367
Bond Position:  [1.07945971]


portfolio before change:  [0.71340602]
curr_Stock_Price:  99.57900930322037
curr_Factors:  [99.5790093]
mat_Sqrt:  [[0.15]]
grads:  [0.05678885]
Stock Position:  0.056788849412848084
Bond Position:  [-4.94157134]


portfolio before change:  [0.68662331]
curr_Stock_Price:  99.11282889952679
curr_Factors:  [99.1128289]
mat_Sqrt:  [[0.15]]
grads:  [0.00874438]
Stock Position:  0.008744384834258538
Bond Position:  [-0.1800574]


portfolio before change:  [0.6808486]
curr_Stock_Price:  98.4537248161589
curr_Factors:  [98.45372482]
mat_Sqrt:  [[0.15]]
grads:  [0.09666632]
Stock Position:  0.09666632230080123
Bond Position:  [-8.8363109]


portfolio before change:  [0.64013967]
curr_Stock_Price:  98.03830977276418
curr_Factors:  [98.03830977]
mat_Sqrt:  [[0.15]]
grads:  [0.02253192]
Stock Position:  0.02253191696998842
Bond Position:  [-1.56885139]


portfolio before change:  [0.64190585]
curr_Stock_Price:  98.12104757234945
curr_Factors:  [98.12104757]
mat_Sqrt:  [[0.15]]
grads:  [-0.16333981]
Stock Position:  -0.16333980608241427
Bond Position:  [16.66897874]


portfolio before change:  [0.67531992]
curr_Stock_Price:  97.9228581467301
curr_Factors:  [97.92285815]
mat_Sqrt:  [[0.15]]
grads:  [-0.09835822]
Stock Position:  -0.09835821882132718
Bond Position:  [10.30683783]


portfolio before change:  [0.60578108]
curr_Stock_Price:  98.63640339920099
curr_Factors:  [98.6364034]
mat_Sqrt:  [[0.15]]
grads:  [0.15124148]
Stock Position:  0.15124148495364265
Bond Position:  [-14.31213504]


portfolio before change:  [0.63026753]
curr_Stock_Price:  98.80422101012348
curr_Factors:  [98.80422101]
mat_Sqrt:  [[0.15]]
grads:  [0.0601736]
Stock Position:  0.060173602084968976
Bond Position:  [-5.31513835]


portfolio before change:  [0.64693626]
curr_Stock_Price:  99.08675253086784
curr_Factors:  [99.08675253]
mat_Sqrt:  [[0.15]]
grads:  [0.12353478]
Stock Position:  0.1235347826247874
Bond Position:  [-11.59372418]


portfolio before change:  [0.67001853]
curr_Stock_Price:  99.27946666580553
curr_Factors:  [99.27946667]
mat_Sqrt:  [[0.15]]
grads:  [-0.08642358]
Stock Position:  -0.08642357581265497
Bond Position:  [9.25010504]


portfolio before change:  [0.80092432]
curr_Stock_Price:  97.77145638943712
curr_Factors:  [97.77145639]
mat_Sqrt:  [[0.15]]
grads:  [0.02460924]
Stock Position:  0.024609236714279115
Bond Position:  [-1.6051566]


portfolio before change:  [0.77938185]
curr_Stock_Price:  96.90015173707873
curr_Factors:  [96.90015174]
mat_Sqrt:  [[0.15]]
grads:  [-0.04706941]
Stock Position:  -0.04706941192912209
Bond Position:  [5.34041501]


portfolio before change:  [0.78198076]
curr_Stock_Price:  96.85202873070945
curr_Factors:  [96.85202873]
mat_Sqrt:  [[0.15]]
grads:  [0.0724448]
Stock Position:  0.07244479801169025
Bond Position:  [-6.2344449]


portfolio before change:  [0.75732414]
curr_Stock_Price:  96.51705708160858
curr_Factors:  [96.51705708]
mat_Sqrt:  [[0.15]]
grads:  [0.0973842]
Stock Position:  0.09738419973232634
Bond Position:  [-8.64191223]


portfolio before change:  [0.78643152]
curr_Stock_Price:  96.82149576804352
curr_Factors:  [96.82149577]
mat_Sqrt:  [[0.15]]
grads:  [0.08508894]
Stock Position:  0.08508894093867408
Bond Position:  [-7.45200702]


portfolio before change:  [0.7935818]
curr_Stock_Price:  96.91100260247639
curr_Factors:  [96.9110026]
mat_Sqrt:  [[0.15]]
grads:  [0.01007027]
Stock Position:  0.010070272324763426
Bond Position:  [-0.18233839]


portfolio before change:  [0.78328731]
curr_Stock_Price:  95.88986888067568
curr_Factors:  [95.88986888]
mat_Sqrt:  [[0.15]]
grads:  [0.0911286]
Stock Position:  0.09112860142481187
Bond Position:  [-7.95502234]


portfolio before change:  [0.76103586]
curr_Stock_Price:  95.651148614312
curr_Factors:  [95.65114861]
mat_Sqrt:  [[0.15]]
grads:  [0.0881675]
Stock Position:  0.08816750429576112
Bond Position:  [-7.6722872]


portfolio before change:  [0.71658158]
curr_Stock_Price:  95.15238500868858
curr_Factors:  [95.15238501]
mat_Sqrt:  [[0.15]]
grads:  [-0.08119137]
Stock Position:  -0.08119137423781463
Bond Position:  [8.44213448]


portfolio before change:  [0.79235247]
curr_Stock_Price:  94.22564572896489
curr_Factors:  [94.22564573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03550377]
Stock Position:  -0.03550376514959079
Bond Position:  [4.13771766]


portfolio before change:  [0.81446906]
curr_Stock_Price:  93.60999330735338
curr_Factors:  [93.60999331]
mat_Sqrt:  [[0.15]]
grads:  [-1.19526042]
Stock Position:  -1.1952604207780508
Bond Position:  [112.70278905]


portfolio before change:  [1.12963158]
curr_Stock_Price:  93.35220984439168
curr_Factors:  [93.35220984]
mat_Sqrt:  [[0.15]]
grads:  [-0.09572436]
Stock Position:  -0.09572435557346436
Bond Position:  [10.0657117]


portfolio before change:  [1.09511121]
curr_Stock_Price:  93.71940469071879
curr_Factors:  [93.71940469]
mat_Sqrt:  [[0.15]]
grads:  [0.0221013]
Stock Position:  0.022101295129825147
Bond Position:  [-0.97620901]


portfolio before change:  [1.1103749]
curr_Stock_Price:  94.41278954569535
curr_Factors:  [94.41278955]
mat_Sqrt:  [[0.15]]
grads:  [0.03208441]
Stock Position:  0.032084406448408063
Bond Position:  [-1.91880341]


portfolio before change:  [1.10137374]
curr_Stock_Price:  94.13598120329004
curr_Factors:  [94.1359812]
mat_Sqrt:  [[0.15]]
grads:  [0.10649751]
Stock Position:  0.10649751428180632
Bond Position:  [-8.92387426]


portfolio before change:  [1.18440839]
curr_Stock_Price:  94.92090472482421
curr_Factors:  [94.92090472]
mat_Sqrt:  [[0.15]]
grads:  [-0.4926755]
Stock Position:  -0.4926755049098638
Bond Position:  [47.94961305]


portfolio before change:  [0.84080388]
curr_Stock_Price:  95.62441331380265
curr_Factors:  [95.62441331]
mat_Sqrt:  [[0.15]]
grads:  [0.03800434]
Stock Position:  0.038004338539854736
Bond Position:  [-2.7933387]


portfolio before change:  [0.79739863]
curr_Stock_Price:  94.48689409424045
curr_Factors:  [94.48689409]
mat_Sqrt:  [[0.15]]
grads:  [0.12676363]
Stock Position:  0.12676362897000332
Bond Position:  [-11.18010296]


portfolio before change:  [0.90006324]
curr_Stock_Price:  95.30229669217479
curr_Factors:  [95.30229669]
mat_Sqrt:  [[0.15]]
grads:  [-0.08477463]
Stock Position:  -0.08477462637177444
Bond Position:  [8.97927983]


portfolio before change:  [0.90663806]
curr_Stock_Price:  95.23136037642898
curr_Factors:  [95.23136038]
mat_Sqrt:  [[0.15]]
grads:  [-0.04613125]
Stock Position:  -0.046131253414732204
Bond Position:  [5.29978008]


portfolio before change:  [0.89492358]
curr_Stock_Price:  95.49247898923427
curr_Factors:  [95.49247899]
mat_Sqrt:  [[0.15]]
grads:  [0.045121]
Stock Position:  0.04512100301685906
Bond Position:  [-3.41379285]


portfolio before change:  [0.89894817]
curr_Stock_Price:  95.58640319201977
curr_Factors:  [95.58640319]
mat_Sqrt:  [[0.15]]
grads:  [0.09163972]
Stock Position:  0.0916397237561568
Bond Position:  [-7.86056342]


portfolio before change:  [0.95271321]
curr_Stock_Price:  96.17846464412636
curr_Factors:  [96.17846464]
mat_Sqrt:  [[0.15]]
grads:  [0.05442057]
Stock Position:  0.05442056782100728
Bond Position:  [-4.28137345]


portfolio before change:  [0.95976751]
curr_Stock_Price:  96.31300740702133
curr_Factors:  [96.31300741]
mat_Sqrt:  [[0.15]]
grads:  [-0.21989753]
Stock Position:  -0.21989752704421495
Bond Position:  [22.13875966]


portfolio before change:  [0.8922442]
curr_Stock_Price:  96.62636713651821
curr_Factors:  [96.62636714]
mat_Sqrt:  [[0.15]]
grads:  [0.05519196]
Stock Position:  0.05519195952716856
Bond Position:  [-4.44075435]


portfolio before change:  [0.88714344]
curr_Stock_Price:  96.53897764323948
curr_Factors:  [96.53897764]
mat_Sqrt:  [[0.15]]
grads:  [-0.21911476]
Stock Position:  -0.21911475709661687
Bond Position:  [22.04025808]


portfolio before change:  [0.8304703]
curr_Stock_Price:  96.80391054796691
curr_Factors:  [96.80391055]
mat_Sqrt:  [[0.15]]
grads:  [0.08422313]
Stock Position:  0.0842231268670268
Bond Position:  [-7.32265774]


portfolio before change:  [0.76778934]
curr_Stock_Price:  96.06511968913958
curr_Factors:  [96.06511969]
mat_Sqrt:  [[0.15]]
grads:  [-0.0850624]
Stock Position:  -0.08506240455185896
Bond Position:  [8.93931941]


portfolio before change:  [0.79606423]
curr_Stock_Price:  95.7392863597298
curr_Factors:  [95.73928636]
mat_Sqrt:  [[0.15]]
grads:  [0.29890873]
Stock Position:  0.29890873323329487
Bond Position:  [-27.82124458]


portfolio before change:  [0.85227626]
curr_Stock_Price:  95.93316128270492
curr_Factors:  [95.93316128]
mat_Sqrt:  [[0.15]]
grads:  [0.15520613]
Stock Position:  0.15520613321324014
Bond Position:  [-14.03713875]


portfolio before change:  [0.73934593]
curr_Stock_Price:  95.21119900116334
curr_Factors:  [95.211199]
mat_Sqrt:  [[0.15]]
grads:  [0.02366234]
Stock Position:  0.023662339304450483
Bond Position:  [-1.51357376]


portfolio before change:  [0.72329485]
curr_Stock_Price:  94.5368580565638
curr_Factors:  [94.53685806]
mat_Sqrt:  [[0.15]]
grads:  [0.0662647]
Stock Position:  0.06626469855971233
Bond Position:  [-5.54116155]


portfolio before change:  [0.68108805]
curr_Stock_Price:  93.90514214682568
curr_Factors:  [93.90514215]
mat_Sqrt:  [[0.15]]
grads:  [0.19968795]
Stock Position:  0.1996879486430922
Bond Position:  [-18.07063715]


portfolio before change:  [0.71438478]
curr_Stock_Price:  94.07754203842083
curr_Factors:  [94.07754204]
mat_Sqrt:  [[0.15]]
grads:  [-0.02305997]
Stock Position:  -0.02305997274373306
Bond Position:  [2.88381034]


portfolio before change:  [0.7006891]
curr_Stock_Price:  94.67927422590962
curr_Factors:  [94.67927423]
mat_Sqrt:  [[0.15]]
grads:  [-0.03071843]
Stock Position:  -0.030718433221356655
Bond Position:  [3.60908806]


portfolio before change:  [0.69976452]
curr_Stock_Price:  94.71671590966149
curr_Factors:  [94.71671591]
mat_Sqrt:  [[0.15]]
grads:  [0.12597786]
Stock Position:  0.12597785675135037
Bond Position:  [-11.23244435]


portfolio before change:  [0.75861142]
curr_Stock_Price:  95.18940970819776
curr_Factors:  [95.18940971]
mat_Sqrt:  [[0.15]]
grads:  [0.03572681]
Stock Position:  0.03572681242856322
Bond Position:  [-2.64220276]


portfolio before change:  [0.80293548]
curr_Stock_Price:  96.43467041034775
curr_Factors:  [96.43467041]
mat_Sqrt:  [[0.15]]
grads:  [0.26070072]
Stock Position:  0.2607007176430328
Bond Position:  [-24.33765231]


portfolio before change:  [0.85924156]
curr_Stock_Price:  96.65648506015529
curr_Factors:  [96.65648506]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214489]
Stock Position:  -0.022144893630995147
Bond Position:  [2.99968914]


portfolio before change:  [0.86577982]
curr_Stock_Price:  96.36970233368527
curr_Factors:  [96.36970233]
mat_Sqrt:  [[0.15]]
grads:  [0.01339871]
Stock Position:  0.013398711266438344
Bond Position:  [-0.42544999]


portfolio before change:  [0.87200654]
curr_Stock_Price:  96.83641231837751
curr_Factors:  [96.83641232]
mat_Sqrt:  [[0.15]]
grads:  [0.03320015]
Stock Position:  0.033200150079842894
Bond Position:  [-2.34297688]


portfolio before change:  [0.86714256]
curr_Stock_Price:  96.69431820368875
curr_Factors:  [96.6943182]
mat_Sqrt:  [[0.15]]
grads:  [0.02805944]
Stock Position:  0.02805943930262384
Bond Position:  [-1.8460458]


portfolio before change:  [0.88028293]
curr_Stock_Price:  97.16673506233711
curr_Factors:  [97.16673506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00771503]
Stock Position:  -0.0077150274501884206
Bond Position:  [1.62992696]


portfolio before change:  [0.88032573]
curr_Stock_Price:  97.1743916256698
curr_Factors:  [97.17439163]
mat_Sqrt:  [[0.15]]
grads:  [0.01133902]
Stock Position:  0.011339020342873355
Bond Position:  [-0.22153667]


portfolio before change:  [0.888407]
curr_Stock_Price:  97.88830842372282
curr_Factors:  [97.88830842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456477]
Stock Position:  -0.004564765644885188
Bond Position:  [1.33524419]


portfolio before change:  [0.89302657]
curr_Stock_Price:  96.89458525229213
curr_Factors:  [96.89458525]
mat_Sqrt:  [[0.15]]
grads:  [0.01028685]
Stock Position:  0.01028685125575303
Bond Position:  [-0.10371362]


portfolio before change:  [0.89367227]
curr_Stock_Price:  96.95798479532831
curr_Factors:  [96.9579848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07502164]
Stock Position:  -0.07502164359521449
Bond Position:  [8.16761965]


portfolio before change:  [0.91067747]
curr_Stock_Price:  96.73811885821591
curr_Factors:  [96.73811886]
mat_Sqrt:  [[0.15]]
grads:  [-0.03953239]
Stock Position:  -0.03953238576461849
Bond Position:  [4.7349661]


portfolio before change:  [0.93705298]
curr_Stock_Price:  96.07841752399449
curr_Factors:  [96.07841752]
mat_Sqrt:  [[0.15]]
grads:  [0.09387842]
Stock Position:  0.09387842482166317
Bond Position:  [-8.08263752]


portfolio before change:  [0.96065584]
curr_Stock_Price:  96.33521824829828
curr_Factors:  [96.33521825]
mat_Sqrt:  [[0.15]]
grads:  [0.09729502]
Stock Position:  0.09729502005977032
Bond Position:  [-8.41228115]


portfolio before change:  [0.87881984]
curr_Stock_Price:  95.49951035688471
curr_Factors:  [95.49951036]
mat_Sqrt:  [[0.15]]
grads:  [-0.12719612]
Stock Position:  -0.12719611877078055
Bond Position:  [13.02598691]


portfolio before change:  [0.82748043]
curr_Stock_Price:  95.90953515966277
curr_Factors:  [95.90953516]
mat_Sqrt:  [[0.15]]
grads:  [-0.03032146]
Stock Position:  -0.030321461671428247
Bond Position:  [3.73559773]


portfolio before change:  [0.82719576]
curr_Stock_Price:  95.92662383704088
curr_Factors:  [95.92662384]
mat_Sqrt:  [[0.15]]
grads:  [-0.10598501]
Stock Position:  -0.10598500610332377
Bond Position:  [10.99397957]


portfolio before change:  [0.88666812]
curr_Stock_Price:  95.37196788742467
curr_Factors:  [95.37196789]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908829]
Stock Position:  -0.029088286896534057
Bond Position:  [3.66087528]


portfolio before change:  [0.88798332]
curr_Stock_Price:  95.33461994396912
curr_Factors:  [95.33461994]
mat_Sqrt:  [[0.15]]
grads:  [0.02974502]
Stock Position:  0.02974502138671843
Bond Position:  [-1.94774699]


portfolio before change:  [0.87838773]
curr_Stock_Price:  95.01611799949914
curr_Factors:  [95.016118]
mat_Sqrt:  [[0.15]]
grads:  [-0.10625897]
Stock Position:  -0.10625897473299793
Bond Position:  [10.97470301]


portfolio before change:  [0.86129484]
curr_Stock_Price:  95.18343404503007
curr_Factors:  [95.18343405]
mat_Sqrt:  [[0.15]]
grads:  [0.08160455]
Stock Position:  0.08160454656920224
Bond Position:  [-6.90610613]


portfolio before change:  [0.77486162]
curr_Stock_Price:  94.12955185531088
curr_Factors:  [94.12955186]
mat_Sqrt:  [[0.15]]
grads:  [0.05571392]
Stock Position:  0.05571392085538527
Bond Position:  [-4.46946478]


portfolio before change:  [0.75561514]
curr_Stock_Price:  93.78911396056974
curr_Factors:  [93.78911396]
mat_Sqrt:  [[0.15]]
grads:  [0.08428793]
Stock Position:  0.0842879258017721
Bond Position:  [-7.14967474]


portfolio before change:  [0.83322993]
curr_Stock_Price:  94.7152449623717
curr_Factors:  [94.71524496]
mat_Sqrt:  [[0.15]]
grads:  [0.02452833]
Stock Position:  0.024528332120520666
Bond Position:  [-1.48997705]


portfolio before change:  [0.83445889]
curr_Stock_Price:  94.76914522627682
curr_Factors:  [94.76914523]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403925]
Stock Position:  -0.0040392462991716924
Bond Position:  [1.21725481]


portfolio before change:  [0.83434472]
curr_Stock_Price:  94.81624435920509
curr_Factors:  [94.81624436]
mat_Sqrt:  [[0.15]]
grads:  [0.05014205]
Stock Position:  0.050142050414178005
Bond Position:  [-3.91993618]


portfolio before change:  [0.85759026]
curr_Stock_Price:  95.28472420171354
curr_Factors:  [95.2847242]
mat_Sqrt:  [[0.15]]
grads:  [-0.1099382]
Stock Position:  -0.10993819817062786
Bond Position:  [11.33302115]


portfolio before change:  [0.85274319]
curr_Stock_Price:  95.33525629742951
curr_Factors:  [95.3352563]
mat_Sqrt:  [[0.15]]
grads:  [0.03412826]
Stock Position:  0.03412825879690141
Bond Position:  [-2.40088311]


portfolio before change:  [0.88726446]
curr_Stock_Price:  96.35116887601134
curr_Factors:  [96.35116888]
mat_Sqrt:  [[0.15]]
grads:  [0.03362463]
Stock Position:  0.03362462675958611
Bond Position:  [-2.35250764]


portfolio before change:  [0.87142074]
curr_Stock_Price:  95.88434794099018
curr_Factors:  [95.88434794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87142074]
Stock Price:  95.10749331529384
PL:  [0.87142074]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.77210195e-04]
 [ 2.05265150e-03]
 [-1.89128350e-04]
 [ 7.60315706e-03]
 [ 4.66502872e-03]
 [ 2.74962542e-02]
 [ 2.65910345e-03]
 [ 1.18909164e-02]
 [ 2.32660137e-02]
 [-3.58763313e-03]
 [ 2.02263317e-02]
 [-1.44943088e-02]
 [ 2.66180423e-02]
 [ 1.09199103e-03]
 [-6.91281732e-03]
 [ 1.26026209e-02]
 [ 9.96158385e-03]
 [-1.15398108e-02]
 [ 9.79277331e-04]
 [-5.55315885e-03]
 [ 1.29663300e-02]
 [-3.71109150e-03]
 [ 9.38356278e-03]
 [ 1.47706160e-02]
 [ 1.52126676e-03]
 [ 9.44335317e-03]
 [-5.30052722e-03]
 [ 1.28514582e-02]
 [ 4.26582488e-02]
 [-2.29867962e-04]
 [ 1.47751786e-02]
 [-1.22125650e-02]
 [ 3.71995151e-03]
 [ 8.45062001e-03]
 [ 1.06505918e-02]
 [ 8.49535982e-03]
 [-3.38982149e-02]
 [ 9.55504125e-03]
 [-1.85956206e-04]
 [ 1.62798890e-02]
 [-5.99817696e-03]
 [-1.56431875e-02]
 [ 2.32101521e-02]
 [ 1.89984752e-03]
 [-7.24606977e-03]
 [-3.11586395e-04]
 [ 4.86478052e-03]
 [-1.21742959e-02]
 [-1.52165947e-02]
 [-6.72107033e-03]
 [ 3.86414872e-02]
 [-8.74162793e-03]
 [ 3.61188549e-03]
 [ 5.44118258e-03]
 [ 5.68713101e-03]
 [-3.41581430e-03]
 [ 6.81938872e-03]
 [-5.21442429e-05]
 [ 1.54472076e-03]
 [ 3.31286571e-03]
 [ 1.17226328e-03]
 [-3.30628229e-03]
 [ 7.03954671e-03]
 [-1.77015242e-02]
 [-1.30789712e-02]
 [-5.38440170e-04]
 [-4.95543254e-03]
 [ 1.93135394e-02]
 [-9.47595993e-03]
 [ 6.20218103e-03]
 [-6.04282125e-03]
 [ 1.17937768e-02]
 [ 2.50399955e-03]
 [ 1.05892033e-03]
 [-3.44883378e-03]
 [-1.47132256e-02]
 [ 5.11687962e-03]
 [ 6.66463766e-03]
 [-3.98463509e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.47473299]
curr_Stock_Price:  100.22324084350159
curr_Factors:  [100.22324084]
mat_Sqrt:  [[0.15]]
grads:  [0.00384807]
Stock Position:  0.0038480679673952474
Bond Position:  [5.08906715]


portfolio before change:  [5.47671749]
curr_Stock_Price:  100.65629351060504
curr_Factors:  [100.65629351]
mat_Sqrt:  [[0.15]]
grads:  [0.01368434]
Stock Position:  0.013684343340841227
Bond Position:  [4.09930221]


portfolio before change:  [5.47051112]
curr_Stock_Price:  100.18403237432716
curr_Factors:  [100.18403237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00126086]
Stock Position:  -0.0012608556662543325
Bond Position:  [5.59682872]


portfolio before change:  [5.47105747]
curr_Stock_Price:  100.02815807840686
curr_Factors:  [100.02815808]
mat_Sqrt:  [[0.15]]
grads:  [0.05068771]
Stock Position:  0.05068771373297234
Bond Position:  [0.40085882]


portfolio before change:  [5.47330185]
curr_Stock_Price:  100.07194242163074
curr_Factors:  [100.07194242]
mat_Sqrt:  [[0.15]]
grads:  [0.03110019]
Stock Position:  0.03110019145718505
Bond Position:  [2.36104528]


portfolio before change:  [5.50870446]
curr_Stock_Price:  101.20553811966523
curr_Factors:  [101.20553812]
mat_Sqrt:  [[0.15]]
grads:  [0.18330836]
Stock Position:  0.1833083610141631
Bond Position:  [-13.04311686]


portfolio before change:  [5.59648121]
curr_Stock_Price:  101.68883287009474
curr_Factors:  [101.68883287]
mat_Sqrt:  [[0.15]]
grads:  [0.01772736]
Stock Position:  0.017727356339380277
Bond Position:  [3.79380703]


portfolio before change:  [5.60424668]
curr_Stock_Price:  102.11350694212669
curr_Factors:  [102.11350694]
mat_Sqrt:  [[0.15]]
grads:  [0.07927278]
Stock Position:  0.07927277598840814
Bond Position:  [-2.49057448]


portfolio before change:  [5.52705031]
curr_Stock_Price:  101.14166377375284
curr_Factors:  [101.14166377]
mat_Sqrt:  [[0.15]]
grads:  [0.15510676]
Stock Position:  0.1551067576883788
Bond Position:  [-10.16070523]


portfolio before change:  [5.39073414]
curr_Stock_Price:  100.26690433072393
curr_Factors:  [100.26690433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02391755]
Stock Position:  -0.02391755423105537
Bond Position:  [7.78887326]


portfolio before change:  [5.36977368]
curr_Stock_Price:  101.16362163734092
curr_Factors:  [101.16362164]
mat_Sqrt:  [[0.15]]
grads:  [0.13484221]
Stock Position:  0.13484221106165356
Bond Position:  [-8.27135274]


portfolio before change:  [5.24830314]
curr_Stock_Price:  100.26662090945034
curr_Factors:  [100.26662091]
mat_Sqrt:  [[0.15]]
grads:  [-0.09662873]
Stock Position:  -0.09662872548295787
Bond Position:  [14.93693893]


portfolio before change:  [5.17446389]
curr_Stock_Price:  101.0404367918348
curr_Factors:  [101.04043679]
mat_Sqrt:  [[0.15]]
grads:  [0.17745362]
Stock Position:  0.1774536154323389
Bond Position:  [-12.75552693]


portfolio before change:  [5.07605917]
curr_Stock_Price:  100.49039184150233
curr_Factors:  [100.49039184]
mat_Sqrt:  [[0.15]]
grads:  [0.00727994]
Stock Position:  0.007279940181059846
Bond Position:  [4.34449513]


portfolio before change:  [5.07205296]
curr_Stock_Price:  99.90278322709725
curr_Factors:  [99.90278323]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608545]
Stock Position:  -0.04608544881808025
Bond Position:  [9.67611756]


portfolio before change:  [5.06343249]
curr_Stock_Price:  100.10296023699017
curr_Factors:  [100.10296024]
mat_Sqrt:  [[0.15]]
grads:  [0.08401747]
Stock Position:  0.08401747266988109
Bond Position:  [-3.34696524]


portfolio before change:  [5.11671424]
curr_Stock_Price:  100.73962482060938
curr_Factors:  [100.73962482]
mat_Sqrt:  [[0.15]]
grads:  [0.06641056]
Stock Position:  0.06641055901829976
Bond Position:  [-1.57346055]


portfolio before change:  [5.1377772]
curr_Stock_Price:  101.0582684441283
curr_Factors:  [101.05826844]
mat_Sqrt:  [[0.15]]
grads:  [-0.07693207]
Stock Position:  -0.07693207194782811
Bond Position:  [12.91239918]


portfolio before change:  [5.09639165]
curr_Stock_Price:  101.6067081636015
curr_Factors:  [101.60670816]
mat_Sqrt:  [[0.15]]
grads:  [0.00652852]
Stock Position:  0.006528515542398552
Bond Position:  [4.43305067]


portfolio before change:  [5.09637914]
curr_Stock_Price:  101.56235154753561
curr_Factors:  [101.56235155]
mat_Sqrt:  [[0.15]]
grads:  [-0.03702106]
Stock Position:  -0.037021058989189226
Bond Position:  [8.85632495]


portfolio before change:  [5.10314815]
curr_Stock_Price:  101.39446123051295
curr_Factors:  [101.39446123]
mat_Sqrt:  [[0.15]]
grads:  [0.0864422]
Stock Position:  0.08644219983841234
Bond Position:  [-3.66161213]


portfolio before change:  [5.10810709]
curr_Stock_Price:  101.4544757685825
curr_Factors:  [101.45447577]
mat_Sqrt:  [[0.15]]
grads:  [-0.02474061]
Stock Position:  -0.024740610015669177
Bond Position:  [7.6181527]


portfolio before change:  [5.10621263]
curr_Stock_Price:  101.55029404043064
curr_Factors:  [101.55029404]
mat_Sqrt:  [[0.15]]
grads:  [0.06255709]
Stock Position:  0.06255708521004212
Bond Position:  [-1.24647777]


portfolio before change:  [5.09614025]
curr_Stock_Price:  101.39052832988062
curr_Factors:  [101.39052833]
mat_Sqrt:  [[0.15]]
grads:  [0.09847077]
Stock Position:  0.09847077336841824
Bond Position:  [-4.88786349]


portfolio before change:  [5.09349104]
curr_Stock_Price:  101.36672733050307
curr_Factors:  [101.36672733]
mat_Sqrt:  [[0.15]]
grads:  [0.01014178]
Stock Position:  0.010141778405878151
Bond Position:  [4.06545216]


portfolio before change:  [5.10190245]
curr_Stock_Price:  102.17105424553787
curr_Factors:  [102.17105425]
mat_Sqrt:  [[0.15]]
grads:  [0.06295569]
Stock Position:  0.06295568781000391
Bond Position:  [-1.33034655]


portfolio before change:  [5.1398502]
curr_Stock_Price:  102.77514416879276
curr_Factors:  [102.77514417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533685]
Stock Position:  -0.035336848156781654
Bond Position:  [8.77159986]


portfolio before change:  [5.12707613]
curr_Stock_Price:  103.15215304452622
curr_Factors:  [103.15215304]
mat_Sqrt:  [[0.15]]
grads:  [0.08567639]
Stock Position:  0.08567638832353439
Bond Position:  [-3.71062779]


portfolio before change:  [5.11450916]
curr_Stock_Price:  103.00818050204605
curr_Factors:  [103.0081805]
mat_Sqrt:  [[0.15]]
grads:  [0.28438833]
Stock Position:  0.28438832537855985
Bond Position:  [-24.17981479]


portfolio before change:  [4.90740068]
curr_Stock_Price:  102.28523520644785
curr_Factors:  [102.28523521]
mat_Sqrt:  [[0.15]]
grads:  [-0.00153245]
Stock Position:  -0.0015324530804841714
Bond Position:  [5.064148]


portfolio before change:  [4.90737805]
curr_Stock_Price:  102.50654559646017
curr_Factors:  [102.5065456]
mat_Sqrt:  [[0.15]]
grads:  [0.09850119]
Stock Position:  0.098501190819644
Bond Position:  [-5.18963876]


portfolio before change:  [4.86825635]
curr_Stock_Price:  102.11266875326906
curr_Factors:  [102.11266875]
mat_Sqrt:  [[0.15]]
grads:  [-0.0814171]
Stock Position:  -0.0814171003123979
Bond Position:  [13.18197374]


portfolio before change:  [4.82121311]
curr_Stock_Price:  102.70059354322555
curr_Factors:  [102.70059354]
mat_Sqrt:  [[0.15]]
grads:  [0.02479968]
Stock Position:  0.024799676761908016
Bond Position:  [2.27427159]


portfolio before change:  [4.81426289]
curr_Stock_Price:  102.41460717576493
curr_Factors:  [102.41460718]
mat_Sqrt:  [[0.15]]
grads:  [0.05633747]
Stock Position:  0.05633746671889136
Bond Position:  [-0.95551663]


portfolio before change:  [4.83480816]
curr_Stock_Price:  102.78034941375135
curr_Factors:  [102.78034941]
mat_Sqrt:  [[0.15]]
grads:  [0.07100395]
Stock Position:  0.07100394553914094
Bond Position:  [-2.46300217]


portfolio before change:  [4.7704954]
curr_Stock_Price:  101.87675425059572
curr_Factors:  [101.87675425]
mat_Sqrt:  [[0.15]]
grads:  [0.05663573]
Stock Position:  0.05663573214791714
Bond Position:  [-0.99936917]


portfolio before change:  [4.74117052]
curr_Stock_Price:  101.36007667720011
curr_Factors:  [101.36007668]
mat_Sqrt:  [[0.15]]
grads:  [-0.2259881]
Stock Position:  -0.2259880992676996
Bond Position:  [27.64734159]


portfolio before change:  [4.63974876]
curr_Stock_Price:  101.81651563394662
curr_Factors:  [101.81651563]
mat_Sqrt:  [[0.15]]
grads:  [0.06370027]
Stock Position:  0.06370027497779825
Bond Position:  [-1.84599128]


portfolio before change:  [4.58697417]
curr_Stock_Price:  100.98984389851339
curr_Factors:  [100.9898439]
mat_Sqrt:  [[0.15]]
grads:  [-0.00123971]
Stock Position:  -0.001239708036985208
Bond Position:  [4.71217209]


portfolio before change:  [4.58747744]
curr_Stock_Price:  100.82145153743788
curr_Factors:  [100.82145154]
mat_Sqrt:  [[0.15]]
grads:  [0.10853259]
Stock Position:  0.10853259358452466
Bond Position:  [-6.35493618]


portfolio before change:  [4.56082615]
curr_Stock_Price:  100.5795509519271
curr_Factors:  [100.57955095]
mat_Sqrt:  [[0.15]]
grads:  [-0.03998785]
Stock Position:  -0.03998784643037056
Bond Position:  [8.58278579]


portfolio before change:  [4.54932822]
curr_Stock_Price:  100.88050156653844
curr_Factors:  [100.88050157]
mat_Sqrt:  [[0.15]]
grads:  [-0.10428792]
Stock Position:  -0.10428791690081497
Bond Position:  [15.06994559]


portfolio before change:  [4.58158129]
curr_Stock_Price:  100.5802638613736
curr_Factors:  [100.58026386]
mat_Sqrt:  [[0.15]]
grads:  [0.15473435]
Stock Position:  0.15473434737418368
Bond Position:  [-10.9816402]


portfolio before change:  [4.70343553]
curr_Stock_Price:  101.37220574968339
curr_Factors:  [101.37220575]
mat_Sqrt:  [[0.15]]
grads:  [0.01266565]
Stock Position:  0.012665650121079525
Bond Position:  [3.41949064]


portfolio before change:  [4.69760034]
curr_Stock_Price:  100.89462209413959
curr_Factors:  [100.89462209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04830713]
Stock Position:  -0.04830713179950917
Bond Position:  [9.57153015]


portfolio before change:  [4.7247695]
curr_Stock_Price:  100.34458081921481
curr_Factors:  [100.34458082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00207724]
Stock Position:  -0.002077242633564657
Bond Position:  [4.93320954]


portfolio before change:  [4.72609939]
curr_Stock_Price:  99.85279586975277
curr_Factors:  [99.85279587]
mat_Sqrt:  [[0.15]]
grads:  [0.03243187]
Stock Position:  0.032431870125286706
Bond Position:  [1.48768648]


portfolio before change:  [4.72644818]
curr_Stock_Price:  99.86068317885156
curr_Factors:  [99.86068318]
mat_Sqrt:  [[0.15]]
grads:  [-0.08116197]
Stock Position:  -0.0811619729002174
Bond Position:  [12.83133824]


portfolio before change:  [4.71660111]
curr_Stock_Price:  99.99189055632178
curr_Factors:  [99.99189056]
mat_Sqrt:  [[0.15]]
grads:  [-0.10144396]
Stock Position:  -0.10144396492133939
Bond Position:  [14.86017495]


portfolio before change:  [4.72453388]
curr_Stock_Price:  99.92284771433538
curr_Factors:  [99.92284771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04480714]
Stock Position:  -0.044807135531662275
Bond Position:  [9.20179046]


portfolio before change:  [4.70445351]
curr_Stock_Price:  100.38383443541302
curr_Factors:  [100.38383444]
mat_Sqrt:  [[0.15]]
grads:  [0.25760991]
Stock Position:  0.25760991493919944
Bond Position:  [-21.15541754]


portfolio before change:  [4.51593339]
curr_Stock_Price:  99.65716261811734
curr_Factors:  [99.65716262]
mat_Sqrt:  [[0.15]]
grads:  [-0.05827752]
Stock Position:  -0.05827751950488843
Bond Position:  [10.32370563]


portfolio before change:  [4.56812639]
curr_Stock_Price:  98.77264070817972
curr_Factors:  [98.77264071]
mat_Sqrt:  [[0.15]]
grads:  [0.02407924]
Stock Position:  0.02407923662371294
Bond Position:  [2.1897566]


portfolio before change:  [4.58202774]
curr_Stock_Price:  99.34427391543068
curr_Factors:  [99.34427392]
mat_Sqrt:  [[0.15]]
grads:  [0.03627455]
Stock Position:  0.03627455050363534
Bond Position:  [0.97835886]


portfolio before change:  [4.5803208]
curr_Stock_Price:  99.29553184554283
curr_Factors:  [99.29553185]
mat_Sqrt:  [[0.15]]
grads:  [0.03791421]
Stock Position:  0.03791420675165092
Bond Position:  [0.81560947]


portfolio before change:  [4.57071137]
curr_Stock_Price:  99.04073533327042
curr_Factors:  [99.04073533]
mat_Sqrt:  [[0.15]]
grads:  [-0.0227721]
Stock Position:  -0.022772095327227085
Bond Position:  [6.82607643]


portfolio before change:  [4.56715044]
curr_Stock_Price:  99.21584298534215
curr_Factors:  [99.21584299]
mat_Sqrt:  [[0.15]]
grads:  [0.04546259]
Stock Position:  0.04546259149908489
Bond Position:  [0.0565411]


portfolio before change:  [4.57548983]
curr_Stock_Price:  99.39919937240693
curr_Factors:  [99.39919937]
mat_Sqrt:  [[0.15]]
grads:  [-0.00034763]
Stock Position:  -0.0003476282858059971
Bond Position:  [4.61004381]


portfolio before change:  [4.57594613]
curr_Stock_Price:  98.91546613336554
curr_Factors:  [98.91546613]
mat_Sqrt:  [[0.15]]
grads:  [0.01029814]
Stock Position:  0.010298138421719115
Bond Position:  [3.55730097]


portfolio before change:  [4.57295201]
curr_Stock_Price:  98.6031321664027
curr_Factors:  [98.60313217]
mat_Sqrt:  [[0.15]]
grads:  [0.02208577]
Stock Position:  0.022085771402599368
Bond Position:  [2.39522577]


portfolio before change:  [4.58487049]
curr_Stock_Price:  99.13599883521992
curr_Factors:  [99.13599884]
mat_Sqrt:  [[0.15]]
grads:  [0.00781509]
Stock Position:  0.007815088548632151
Bond Position:  [3.81011388]


portfolio before change:  [4.58310373]
curr_Stock_Price:  98.87945781689812
curr_Factors:  [98.87945782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02204188]
Stock Position:  -0.022041881916128905
Bond Position:  [6.76259307]


portfolio before change:  [4.59904312]
curr_Stock_Price:  98.1754930437956
curr_Factors:  [98.17549304]
mat_Sqrt:  [[0.15]]
grads:  [0.04693031]
Stock Position:  0.046930311400922214
Bond Position:  [-0.00836334]


portfolio before change:  [4.61090382]
curr_Stock_Price:  98.42823417874304
curr_Factors:  [98.42823418]
mat_Sqrt:  [[0.15]]
grads:  [-0.11801016]
Stock Position:  -0.11801016131001277
Bond Position:  [16.22643561]


portfolio before change:  [4.58623941]
curr_Stock_Price:  98.64583062435588
curr_Factors:  [98.64583062]
mat_Sqrt:  [[0.15]]
grads:  [-0.08719314]
Stock Position:  -0.08719314104901235
Bond Position:  [13.18747923]


portfolio before change:  [4.54426661]
curr_Stock_Price:  99.13666102848737
curr_Factors:  [99.13666103]
mat_Sqrt:  [[0.15]]
grads:  [-0.0035896]
Stock Position:  -0.003589601132733128
Bond Position:  [4.90012768]


portfolio before change:  [4.54601847]
curr_Stock_Price:  98.73394378469571
curr_Factors:  [98.73394378]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303622]
Stock Position:  -0.03303621693952775
Bond Position:  [7.80781445]


portfolio before change:  [4.56730122]
curr_Stock_Price:  98.10449059654297
curr_Factors:  [98.1044906]
mat_Sqrt:  [[0.15]]
grads:  [0.12875693]
Stock Position:  0.12875692937946714
Bond Position:  [-8.06433174]


portfolio before change:  [4.62491257]
curr_Stock_Price:  98.55584794879059
curr_Factors:  [98.55584795]
mat_Sqrt:  [[0.15]]
grads:  [-0.06317307]
Stock Position:  -0.06317306619692444
Bond Position:  [10.85098768]


portfolio before change:  [4.61364718]
curr_Stock_Price:  98.74490958184016
curr_Factors:  [98.74490958]
mat_Sqrt:  [[0.15]]
grads:  [0.04134787]
Stock Position:  0.04134787350314651
Bond Position:  [0.53075515]


portfolio before change:  [4.59170576]
curr_Stock_Price:  98.21345321711792
curr_Factors:  [98.21345322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04028548]
Stock Position:  -0.04028547500552585
Bond Position:  [8.54828138]


portfolio before change:  [4.65892236]
curr_Stock_Price:  96.55820852449254
curr_Factors:  [96.55820852]
mat_Sqrt:  [[0.15]]
grads:  [0.07862518]
Stock Position:  0.07862517851121914
Bond Position:  [-2.93298402]


portfolio before change:  [4.62052294]
curr_Stock_Price:  96.07215420464749
curr_Factors:  [96.0721542]
mat_Sqrt:  [[0.15]]
grads:  [0.01669333]
Stock Position:  0.016693330332824018
Bond Position:  [3.01675873]


portfolio before change:  [4.62281054]
curr_Stock_Price:  96.19789596890398
curr_Factors:  [96.19789597]
mat_Sqrt:  [[0.15]]
grads:  [0.00705947]
Stock Position:  0.007059468865100669
Bond Position:  [3.94370449]


portfolio before change:  [4.62480684]
curr_Stock_Price:  96.44576229300051
curr_Factors:  [96.44576229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299223]
Stock Position:  -0.02299222519104594
Bond Position:  [6.84230952]


portfolio before change:  [4.63855517]
curr_Stock_Price:  95.86640664368251
curr_Factors:  [95.86640664]
mat_Sqrt:  [[0.15]]
grads:  [-0.09808817]
Stock Position:  -0.09808817099487234
Bond Position:  [14.04191566]


portfolio before change:  [4.69286713]
curr_Stock_Price:  95.32164863835274
curr_Factors:  [95.32164864]
mat_Sqrt:  [[0.15]]
grads:  [0.03411253]
Stock Position:  0.034112530823344034
Bond Position:  [1.44120446]


portfolio before change:  [4.68610562]
curr_Stock_Price:  95.12079606108051
curr_Factors:  [95.12079606]
mat_Sqrt:  [[0.15]]
grads:  [0.04443092]
Stock Position:  0.04443091771519982
Bond Position:  [0.45980136]


portfolio before change:  [4.66970095]
curr_Stock_Price:  94.75093173688848
curr_Factors:  [94.75093174]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.66970095]
Stock Price:  95.75287274849757
PL:  [4.66970095]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.88376591e-04]
 [-1.74844905e-03]
 [-3.72150643e-03]
 [ 3.62305347e-03]
 [ 6.46436105e-03]
 [ 2.86974543e-02]
 [ 1.08525919e-03]
 [-1.63470174e-02]
 [ 2.44230850e-02]
 [ 1.84428844e-02]
 [-2.67933231e-03]
 [ 2.90746310e-02]
 [-1.21645161e-02]
 [ 2.47756924e-03]
 [-7.02270949e-03]
 [ 9.67726564e-03]
 [ 1.47300953e-02]
 [ 2.61937963e-02]
 [ 8.19478867e-04]
 [ 1.32725995e-02]
 [ 1.32189900e-02]
 [-1.21122457e-02]
 [-1.96148052e-03]
 [-1.11844940e-01]
 [-1.36854244e-02]
 [ 1.60875325e-03]
 [ 6.11585145e-03]
 [ 1.67160744e-02]
 [-9.51590385e-02]
 [ 6.88763190e-03]
 [ 1.41317674e-02]
 [-1.40226120e-02]
 [-6.00890221e-03]
 [ 8.73950082e-03]
 [ 1.37203612e-02]
 [ 7.60856849e-04]
 [-2.82133851e-02]
 [ 7.05954224e-03]
 [-4.80199943e-02]
 [-1.51648346e-02]
 [-1.57090517e-02]
 [ 6.15111822e-02]
 [ 2.34521317e-02]
 [ 3.64935250e-03]
 [ 7.57027625e-03]
 [ 1.22261283e-02]
 [-9.00143785e-04]
 [-1.03152454e-02]
 [ 7.91444500e-03]
 [ 3.50154471e-03]
 [ 3.75104562e-02]
 [-5.22786484e-03]
 [ 2.35678564e-03]
 [ 4.96473519e-03]
 [ 4.48790473e-03]
 [-1.42539533e-03]
 [ 7.67171197e-03]
 [-3.03649823e-04]
 [ 1.54634465e-03]
 [ 1.97950776e-03]
 [ 9.00849938e-04]
 [-1.00133095e-02]
 [-6.06699357e-03]
 [-1.54480572e-02]
 [-9.49421316e-03]
 [ 6.25707497e-04]
 [-5.47714625e-03]
 [ 2.09724079e-02]
 [-8.19227676e-03]
 [ 8.49382604e-03]
 [-9.98977412e-03]
 [ 1.09942520e-02]
 [-7.87508899e-03]
 [ 1.66009896e-02]
 [-1.92702930e-02]
 [-4.97966708e-03]
 [-4.84919824e-03]
 [-1.91025316e-03]
 [-4.29245722e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.31248743]
curr_Stock_Price:  100.7979154621011
curr_Factors:  [100.79791546]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192251]
Stock Position:  -0.0019225106073242927
Bond Position:  [14.50627249]


portfolio before change:  [14.31258303]
curr_Stock_Price:  101.21979618065527
curr_Factors:  [101.21979618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01165633]
Stock Position:  -0.011656326984073725
Bond Position:  [15.49243407]


portfolio before change:  [14.31817214]
curr_Stock_Price:  100.82337569360449
curr_Factors:  [100.82337569]
mat_Sqrt:  [[0.15]]
grads:  [-0.02481004]
Stock Position:  -0.024810042850732277
Bond Position:  [16.81960441]


portfolio before change:  [14.31066722]
curr_Stock_Price:  101.16824334013768
curr_Factors:  [101.16824334]
mat_Sqrt:  [[0.15]]
grads:  [0.02415369]
Stock Position:  0.024153689783059866
Bond Position:  [11.86708085]


portfolio before change:  [14.29998943]
curr_Stock_Price:  100.69545820394387
curr_Factors:  [100.6954582]
mat_Sqrt:  [[0.15]]
grads:  [0.04309574]
Stock Position:  0.04309574036498637
Bond Position:  [9.9604441]


portfolio before change:  [14.30177747]
curr_Stock_Price:  100.72250244715455
curr_Factors:  [100.72250245]
mat_Sqrt:  [[0.15]]
grads:  [0.19131636]
Stock Position:  0.19131636167234578
Bond Position:  [-4.96808524]


portfolio before change:  [14.29953881]
curr_Stock_Price:  100.71242415599545
curr_Factors:  [100.71242416]
mat_Sqrt:  [[0.15]]
grads:  [0.00723506]
Stock Position:  0.007235061258979153
Bond Position:  [13.57087825]


portfolio before change:  [14.29665339]
curr_Stock_Price:  100.19637754615918
curr_Factors:  [100.19637755]
mat_Sqrt:  [[0.15]]
grads:  [-0.10898012]
Stock Position:  -0.10898011597241707
Bond Position:  [25.21606623]


portfolio before change:  [14.22542361]
curr_Stock_Price:  100.86444283208058
curr_Factors:  [100.86444283]
mat_Sqrt:  [[0.15]]
grads:  [0.16282057]
Stock Position:  0.1628205669063243
Bond Position:  [-2.19738216]


portfolio before change:  [13.97744807]
curr_Stock_Price:  99.3422874607025
curr_Factors:  [99.34228746]
mat_Sqrt:  [[0.15]]
grads:  [0.12295256]
Stock Position:  0.12295256285861376
Bond Position:  [1.76305922]


portfolio before change:  [13.87898772]
curr_Stock_Price:  98.54059171905597
curr_Factors:  [98.54059172]
mat_Sqrt:  [[0.15]]
grads:  [-0.01786222]
Stock Position:  -0.017862215387435057
Bond Position:  [15.63914099]


portfolio before change:  [13.89761765]
curr_Stock_Price:  97.5523350020532
curr_Factors:  [97.552335]
mat_Sqrt:  [[0.15]]
grads:  [0.19383087]
Stock Position:  0.1938308736039626
Bond Position:  [-5.01103667]


portfolio before change:  [13.90854303]
curr_Stock_Price:  97.61031638410037
curr_Factors:  [97.61031638]
mat_Sqrt:  [[0.15]]
grads:  [-0.08109677]
Stock Position:  -0.08109677378604728
Bond Position:  [21.82442478]


portfolio before change:  [13.92219851]
curr_Stock_Price:  97.45875164601678
curr_Factors:  [97.45875165]
mat_Sqrt:  [[0.15]]
grads:  [0.01651713]
Stock Position:  0.016517128254937386
Bond Position:  [12.31245981]


portfolio before change:  [13.92484037]
curr_Stock_Price:  97.57210691992708
curr_Factors:  [97.57210692]
mat_Sqrt:  [[0.15]]
grads:  [-0.04681806]
Stock Position:  -0.04681806328963961
Bond Position:  [18.49297744]


portfolio before change:  [13.91416027]
curr_Stock_Price:  97.82491417138432
curr_Factors:  [97.82491417]
mat_Sqrt:  [[0.15]]
grads:  [0.0645151]
Stock Position:  0.06451510427696107
Bond Position:  [7.60297573]


portfolio before change:  [13.82791422]
curr_Stock_Price:  96.4807134212454
curr_Factors:  [96.48071342]
mat_Sqrt:  [[0.15]]
grads:  [0.09820064]
Stock Position:  0.09820063533469396
Bond Position:  [4.35344686]


portfolio before change:  [13.78389649]
curr_Stock_Price:  96.02969975890754
curr_Factors:  [96.02969976]
mat_Sqrt:  [[0.15]]
grads:  [0.17462531]
Stock Position:  0.17462530877154042
Bond Position:  [-2.98531948]


portfolio before change:  [13.85550596]
curr_Stock_Price:  96.44084327404292
curr_Factors:  [96.44084327]
mat_Sqrt:  [[0.15]]
grads:  [0.00546319]
Stock Position:  0.005463192447993532
Bond Position:  [13.32863108]


portfolio before change:  [13.85382627]
curr_Stock_Price:  95.98090020892158
curr_Factors:  [95.98090021]
mat_Sqrt:  [[0.15]]
grads:  [0.088484]
Stock Position:  0.08848399692259065
Bond Position:  [5.36105259]


portfolio before change:  [13.82973291]
curr_Stock_Price:  95.70482271457406
curr_Factors:  [95.70482271]
mat_Sqrt:  [[0.15]]
grads:  [0.0881266]
Stock Position:  0.08812659993179912
Bond Position:  [5.39559228]


portfolio before change:  [13.78615681]
curr_Stock_Price:  95.20652447706878
curr_Factors:  [95.20652448]
mat_Sqrt:  [[0.15]]
grads:  [-0.0807483]
Stock Position:  -0.08074830469914861
Bond Position:  [21.47392226]


portfolio before change:  [13.7811475]
curr_Stock_Price:  95.28518220598878
curr_Factors:  [95.28518221]
mat_Sqrt:  [[0.15]]
grads:  [-0.01307654]
Stock Position:  -0.013076536769833723
Bond Position:  [15.02714768]


portfolio before change:  [13.78360535]
curr_Stock_Price:  95.16904871906836
curr_Factors:  [95.16904872]
mat_Sqrt:  [[0.15]]
grads:  [-0.74563293]
Stock Position:  -0.745632933288357
Bond Position:  [84.7447823]


portfolio before change:  [14.05097123]
curr_Stock_Price:  94.81757661940632
curr_Factors:  [94.81757662]
mat_Sqrt:  [[0.15]]
grads:  [-0.09123616]
Stock Position:  -0.0912361628077473
Bond Position:  [22.70176309]


portfolio before change:  [14.08503353]
curr_Stock_Price:  94.45978658182739
curr_Factors:  [94.45978658]
mat_Sqrt:  [[0.15]]
grads:  [0.01072502]
Stock Position:  0.010725021669533812
Bond Position:  [13.07195027]


portfolio before change:  [14.0790349]
curr_Stock_Price:  93.82429576718306
curr_Factors:  [93.82429577]
mat_Sqrt:  [[0.15]]
grads:  [0.04077234]
Stock Position:  0.04077234296668746
Bond Position:  [10.25359853]


portfolio before change:  [14.08072028]
curr_Stock_Price:  93.84991403289389
curr_Factors:  [93.84991403]
mat_Sqrt:  [[0.15]]
grads:  [0.1114405]
Stock Position:  0.11144049629181477
Bond Position:  [3.62203929]


portfolio before change:  [14.08346241]
curr_Stock_Price:  93.87248881000573
curr_Factors:  [93.87248881]
mat_Sqrt:  [[0.15]]
grads:  [-0.63439359]
Stock Position:  -0.6343935898919936
Bond Position:  [73.63556758]


portfolio before change:  [13.40106464]
curr_Stock_Price:  94.95541295422161
curr_Factors:  [94.95541295]
mat_Sqrt:  [[0.15]]
grads:  [0.04591755]
Stock Position:  0.04591754599896664
Bond Position:  [9.0409451]


portfolio before change:  [13.41951616]
curr_Stock_Price:  95.34494680729324
curr_Factors:  [95.34494681]
mat_Sqrt:  [[0.15]]
grads:  [0.09421178]
Stock Position:  0.0942117829458214
Bond Position:  [4.43689873]


portfolio before change:  [13.34398322]
curr_Stock_Price:  94.54026773117147
curr_Factors:  [94.54026773]
mat_Sqrt:  [[0.15]]
grads:  [-0.09348408]
Stock Position:  -0.09348407986672717
Bond Position:  [22.18199316]


portfolio before change:  [13.43450105]
curr_Stock_Price:  93.58682829665052
curr_Factors:  [93.5868283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04005935]
Stock Position:  -0.04005934809440361
Bond Position:  [17.18352838]


portfolio before change:  [13.44212796]
curr_Stock_Price:  93.42324824809664
curr_Factors:  [93.42324825]
mat_Sqrt:  [[0.15]]
grads:  [0.05826334]
Stock Position:  0.058263338806559845
Bond Position:  [7.9989776]


portfolio before change:  [13.46697469]
curr_Stock_Price:  93.84112296497368
curr_Factors:  [93.84112296]
mat_Sqrt:  [[0.15]]
grads:  [0.09146907]
Stock Position:  0.09146907492125253
Bond Position:  [4.88341398]


portfolio before change:  [13.54578513]
curr_Stock_Price:  94.69939349719252
curr_Factors:  [94.6993935]
mat_Sqrt:  [[0.15]]
grads:  [0.00507238]
Stock Position:  0.005072378993777616
Bond Position:  [13.06543391]


portfolio before change:  [13.54254785]
curr_Stock_Price:  93.90018510277079
curr_Factors:  [93.9001851]
mat_Sqrt:  [[0.15]]
grads:  [-0.18808923]
Stock Position:  -0.18808923432052038
Bond Position:  [31.20416177]


portfolio before change:  [13.69230572]
curr_Stock_Price:  93.11434777329252
curr_Factors:  [93.11434777]
mat_Sqrt:  [[0.15]]
grads:  [0.04706361]
Stock Position:  0.04706361490399851
Bond Position:  [9.31000791]


portfolio before change:  [13.74635822]
curr_Stock_Price:  94.2504826237516
curr_Factors:  [94.25048262]
mat_Sqrt:  [[0.15]]
grads:  [-0.3201333]
Stock Position:  -0.32013329537476704
Bond Position:  [43.91907582]


portfolio before change:  [14.01052502]
curr_Stock_Price:  93.4338797515501
curr_Factors:  [93.43387975]
mat_Sqrt:  [[0.15]]
grads:  [-0.1010989]
Stock Position:  -0.10109889716143938
Bond Position:  [23.45658722]


portfolio before change:  [13.9479955]
curr_Stock_Price:  94.06687970560084
curr_Factors:  [94.06687971]
mat_Sqrt:  [[0.15]]
grads:  [-0.10472701]
Stock Position:  -0.10472701158795358
Bond Position:  [23.79933871]


portfolio before change:  [13.92850698]
curr_Stock_Price:  94.26717211170605
curr_Factors:  [94.26717211]
mat_Sqrt:  [[0.15]]
grads:  [0.41007455]
Stock Position:  0.4100745480767044
Bond Position:  [-24.72806102]


portfolio before change:  [14.04302776]
curr_Stock_Price:  94.55020924345004
curr_Factors:  [94.55020924]
mat_Sqrt:  [[0.15]]
grads:  [0.15634754]
Stock Position:  0.15634754438924073
Bond Position:  [-0.73966528]


portfolio before change:  [14.18286743]
curr_Stock_Price:  95.44492047363421
curr_Factors:  [95.44492047]
mat_Sqrt:  [[0.15]]
grads:  [0.02432902]
Stock Position:  0.024329016673585436
Bond Position:  [11.86078637]


portfolio before change:  [14.18309493]
curr_Stock_Price:  95.42380084604615
curr_Factors:  [95.42380085]
mat_Sqrt:  [[0.15]]
grads:  [0.05046851]
Stock Position:  0.05046850836608007
Bond Position:  [9.36719804]


portfolio before change:  [14.21179913]
curr_Stock_Price:  95.98095485689367
curr_Factors:  [95.98095486]
mat_Sqrt:  [[0.15]]
grads:  [0.08150752]
Stock Position:  0.08150752217557414
Bond Position:  [6.38862933]


portfolio before change:  [14.18927617]
curr_Stock_Price:  95.69972604615859
curr_Factors:  [95.69972605]
mat_Sqrt:  [[0.15]]
grads:  [-0.00600096]
Stock Position:  -0.006000958566987786
Bond Position:  [14.76356626]


portfolio before change:  [14.18792935]
curr_Stock_Price:  96.07792789350363
curr_Factors:  [96.07792789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0687683]
Stock Position:  -0.06876830278024551
Bond Position:  [20.79504538]


portfolio before change:  [14.19701299]
curr_Stock_Price:  95.9647374517393
curr_Factors:  [95.96473745]
mat_Sqrt:  [[0.15]]
grads:  [0.05276297]
Stock Position:  0.05276296663549902
Bond Position:  [9.13362875]


portfolio before change:  [14.19091942]
curr_Stock_Price:  95.83842838685862
curr_Factors:  [95.83842839]
mat_Sqrt:  [[0.15]]
grads:  [0.02334363]
Stock Position:  0.023343631423022825
Bond Position:  [11.95370247]


portfolio before change:  [14.19707218]
curr_Stock_Price:  96.06999580452515
curr_Factors:  [96.0699958]
mat_Sqrt:  [[0.15]]
grads:  [0.25006971]
Stock Position:  0.25006970767166276
Bond Position:  [-9.82712359]


portfolio before change:  [14.42346842]
curr_Stock_Price:  96.9777845183313
curr_Factors:  [96.97778452]
mat_Sqrt:  [[0.15]]
grads:  [-0.03485243]
Stock Position:  -0.034852432277802756
Bond Position:  [17.80338009]


portfolio before change:  [14.42264718]
curr_Stock_Price:  97.0332753011375
curr_Factors:  [97.0332753]
mat_Sqrt:  [[0.15]]
grads:  [0.0157119]
Stock Position:  0.015711904269875808
Bond Position:  [12.89806965]


portfolio before change:  [14.41907786]
curr_Stock_Price:  96.75479370264259
curr_Factors:  [96.7547937]
mat_Sqrt:  [[0.15]]
grads:  [0.03309823]
Stock Position:  0.03309823459866561
Bond Position:  [11.216665]


portfolio before change:  [14.43045495]
curr_Stock_Price:  97.07734961437218
curr_Factors:  [97.07734961]
mat_Sqrt:  [[0.15]]
grads:  [0.02991936]
Stock Position:  0.029919364863510815
Bond Position:  [11.52596231]


portfolio before change:  [14.44015707]
curr_Stock_Price:  97.377547250668
curr_Factors:  [97.37754725]
mat_Sqrt:  [[0.15]]
grads:  [-0.00950264]
Stock Position:  -0.009502635505426507
Bond Position:  [15.36550041]


portfolio before change:  [14.4346083]
curr_Stock_Price:  98.06253040355804
curr_Factors:  [98.0625304]
mat_Sqrt:  [[0.15]]
grads:  [0.05114475]
Stock Position:  0.05114474649741541
Bond Position:  [9.41922504]


portfolio before change:  [14.46717846]
curr_Stock_Price:  98.68784284812914
curr_Factors:  [98.68784285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00202433]
Stock Position:  -0.0020243321506777565
Bond Position:  [14.66695544]


portfolio before change:  [14.46740442]
curr_Stock_Price:  99.02906811828184
curr_Factors:  [99.02906812]
mat_Sqrt:  [[0.15]]
grads:  [0.01030896]
Stock Position:  0.010308964355897045
Bond Position:  [13.44651729]


portfolio before change:  [14.46610043]
curr_Stock_Price:  98.82105260538198
curr_Factors:  [98.82105261]
mat_Sqrt:  [[0.15]]
grads:  [0.01319672]
Stock Position:  0.013196718414289096
Bond Position:  [13.16198683]


portfolio before change:  [14.4846313]
curr_Stock_Price:  100.16291783844906
curr_Factors:  [100.16291784]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [13.88308625]


portfolio before change:  [14.48244789]
curr_Stock_Price:  99.65487647592354
curr_Factors:  [99.65487648]
mat_Sqrt:  [[0.15]]
grads:  [-0.0667554]
Stock Position:  -0.06675539696594325
Bond Position:  [21.13494873]


portfolio before change:  [14.47825079]
curr_Stock_Price:  99.73753758733285
curr_Factors:  [99.73753759]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044662]
Stock Position:  -0.04044662380316121
Bond Position:  [18.51229746]


portfolio before change:  [14.47304164]
curr_Stock_Price:  99.89493537427512
curr_Factors:  [99.89493537]
mat_Sqrt:  [[0.15]]
grads:  [-0.10298705]
Stock Position:  -0.1029870481652633
Bond Position:  [24.76092616]


portfolio before change:  [14.43717781]
curr_Stock_Price:  100.25819886642603
curr_Factors:  [100.25819887]
mat_Sqrt:  [[0.15]]
grads:  [-0.06329475]
Stock Position:  -0.06329475440523438
Bond Position:  [20.78299589]


portfolio before change:  [14.39977729]
curr_Stock_Price:  100.86961600157714
curr_Factors:  [100.869616]
mat_Sqrt:  [[0.15]]
grads:  [0.00417138]
Stock Position:  0.004171383310671943
Bond Position:  [13.97901146]


portfolio before change:  [14.40484695]
curr_Stock_Price:  101.87550313372118
curr_Factors:  [101.87550313]
mat_Sqrt:  [[0.15]]
grads:  [-0.03651431]
Stock Position:  -0.03651430835761387
Bond Position:  [18.12476048]


portfolio before change:  [14.44433525]
curr_Stock_Price:  100.82508006200774
curr_Factors:  [100.82508006]
mat_Sqrt:  [[0.15]]
grads:  [0.13981605]
Stock Position:  0.13981605287104135
Bond Position:  [0.34737053]


portfolio before change:  [14.45577652]
curr_Stock_Price:  100.90675562924322
curr_Factors:  [100.90675563]
mat_Sqrt:  [[0.15]]
grads:  [-0.05461518]
Stock Position:  -0.054615178413296814
Bond Position:  [19.96681698]


portfolio before change:  [14.47741055]
curr_Stock_Price:  100.53348831257509
curr_Factors:  [100.53348831]
mat_Sqrt:  [[0.15]]
grads:  [0.05662551]
Stock Position:  0.05662550691994719
Bond Position:  [8.78465081]


portfolio before change:  [14.45085074]
curr_Stock_Price:  100.05474894881498
curr_Factors:  [100.05474895]
mat_Sqrt:  [[0.15]]
grads:  [-0.06659849]
Stock Position:  -0.06659849413770866
Bond Position:  [21.11434636]


portfolio before change:  [14.42352497]
curr_Stock_Price:  100.48487070167816
curr_Factors:  [100.4848707]
mat_Sqrt:  [[0.15]]
grads:  [0.07329501]
Stock Position:  0.0732950130972456
Bond Position:  [7.05848506]


portfolio before change:  [14.40093422]
curr_Stock_Price:  100.17063479194515
curr_Factors:  [100.17063479]
mat_Sqrt:  [[0.15]]
grads:  [-0.05250059]
Stock Position:  -0.0525005932810733
Bond Position:  [19.65995197]


portfolio before change:  [14.37690643]
curr_Stock_Price:  100.65170680085153
curr_Factors:  [100.6517068]
mat_Sqrt:  [[0.15]]
grads:  [0.11067326]
Stock Position:  0.11067326396842488
Bond Position:  [3.23745352]


portfolio before change:  [14.22730351]
curr_Stock_Price:  99.29812539732144
curr_Factors:  [99.2981254]
mat_Sqrt:  [[0.15]]
grads:  [-0.12846862]
Stock Position:  -0.12846861980061675
Bond Position:  [26.98399663]


portfolio before change:  [14.25935612]
curr_Stock_Price:  99.06175595537293
curr_Factors:  [99.06175596]
mat_Sqrt:  [[0.15]]
grads:  [-0.03319778]
Stock Position:  -0.033197780532319913
Bond Position:  [17.54798655]


portfolio before change:  [14.24344566]
curr_Stock_Price:  99.57405665911881
curr_Factors:  [99.57405666]
mat_Sqrt:  [[0.15]]
grads:  [-0.03232799]
Stock Position:  -0.032327988255138385
Bond Position:  [17.46247459]


portfolio before change:  [14.24717881]
curr_Stock_Price:  99.49234053562162
curr_Factors:  [99.49234054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01273502]
Stock Position:  -0.012735021061228927
Bond Position:  [15.51421586]


portfolio before change:  [14.25324328]
curr_Stock_Price:  99.09227834014128
curr_Factors:  [99.09227834]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.25324328]
Stock Price:  99.77578731929037
PL:  [14.25324328]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.40761819e-03]
 [ 1.42689639e-03]
 [-4.42112260e-04]
 [ 8.21496706e-03]
 [ 3.82566795e-03]
 [ 1.47122932e-02]
 [ 8.46743261e-04]
 [-1.73797204e-02]
 [ 1.90884935e-03]
 [ 1.85950233e-02]
 [ 1.51907128e-02]
 [ 9.72887537e-03]
 [-1.23448129e-02]
 [ 1.23149735e-02]
 [-6.91553574e-03]
 [ 1.89707867e-02]
 [ 1.05543562e-02]
 [-1.15412688e-02]
 [-6.27707509e-04]
 [ 1.32217055e-02]
 [ 1.14810368e-02]
 [-7.88152241e-03]
 [ 7.84949979e-03]
 [ 3.58819423e-02]
 [-4.98307301e-03]
 [ 5.18810884e-03]
 [-7.21727530e-03]
 [ 6.15459817e-03]
 [ 5.06717359e-03]
 [-3.32438120e-03]
 [ 8.38451057e-03]
 [-1.20114046e-02]
 [ 2.13154356e-03]
 [ 5.89039152e-03]
 [ 1.15501656e-02]
 [ 1.33243292e-02]
 [-3.40281657e-02]
 [ 9.62519509e-03]
 [ 3.89849892e-03]
 [ 1.58829533e-02]
 [-5.78992988e-03]
 [-1.58594998e-02]
 [ 2.22408802e-02]
 [ 1.75366344e-03]
 [-5.23980152e-03]
 [-1.43815182e-03]
 [ 8.54891843e-03]
 [-7.16850431e-03]
 [-1.51556899e-02]
 [-7.69676901e-03]
 [ 2.53043719e-02]
 [-7.43553220e-03]
 [ 1.25531308e-03]
 [ 5.40641103e-03]
 [ 5.78643237e-03]
 [-3.34965221e-03]
 [ 4.08561418e-03]
 [-5.17490431e-04]
 [ 1.55994117e-03]
 [ 1.11124981e-02]
 [-1.03104264e-04]
 [ 1.00058352e-02]
 [-4.15117945e-03]
 [-1.34239071e-02]
 [-6.08941869e-03]
 [ 1.75011145e-03]
 [-5.24896162e-03]
 [ 2.14540762e-02]
 [-8.77584485e-03]
 [ 7.06275652e-03]
 [-1.03517208e-02]
 [ 1.10149345e-02]
 [-8.31482241e-03]
 [ 1.74658277e-02]
 [-2.24889815e-02]
 [-4.31479160e-03]
 [-9.13594875e-03]
 [-1.47511343e-03]
 [ 2.78087651e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.82556735]
curr_Stock_Price:  99.92092903859105
curr_Factors:  [99.92092904]
mat_Sqrt:  [[0.15]]
grads:  [0.01605079]
Stock Position:  0.016050787914761527
Bond Position:  [-0.77824229]


portfolio before change:  [0.82456718]
curr_Stock_Price:  99.86164654903243
curr_Factors:  [99.86164655]
mat_Sqrt:  [[0.15]]
grads:  [0.00951264]
Stock Position:  0.00951264260838425
Bond Position:  [-0.12538098]


portfolio before change:  [0.82233066]
curr_Stock_Price:  99.62736014574553
curr_Factors:  [99.62736015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00294742]
Stock Position:  -0.002947415065268494
Bond Position:  [1.11597384]


portfolio before change:  [0.82322862]
curr_Stock_Price:  99.34636412845549
curr_Factors:  [99.34636413]
mat_Sqrt:  [[0.15]]
grads:  [0.05476645]
Stock Position:  0.05476644704816863
Bond Position:  [-4.61761877]


portfolio before change:  [0.82869456]
curr_Stock_Price:  99.45143849926319
curr_Factors:  [99.4514385]
mat_Sqrt:  [[0.15]]
grads:  [0.02550445]
Stock Position:  0.025504453001618826
Bond Position:  [-1.70775998]


portfolio before change:  [0.80400407]
curr_Stock_Price:  98.48753803551897
curr_Factors:  [98.48753804]
mat_Sqrt:  [[0.15]]
grads:  [0.09808195]
Stock Position:  0.0980819545953163
Bond Position:  [-8.85584617]


portfolio before change:  [0.8961234]
curr_Stock_Price:  99.43238909276789
curr_Factors:  [99.43238909]
mat_Sqrt:  [[0.15]]
grads:  [0.00564496]
Stock Position:  0.005644955074642259
Bond Position:  [0.33483203]


portfolio before change:  [0.89442]
curr_Stock_Price:  99.12692533300758
curr_Factors:  [99.12692533]
mat_Sqrt:  [[0.15]]
grads:  [-0.1158648]
Stock Position:  -0.11586480245663662
Bond Position:  [12.37974162]


portfolio before change:  [0.91768829]
curr_Stock_Price:  98.93278068732883
curr_Factors:  [98.93278069]
mat_Sqrt:  [[0.15]]
grads:  [0.01272566]
Stock Position:  0.012725662319210384
Bond Position:  [-0.34129687]


portfolio before change:  [0.92277166]
curr_Stock_Price:  99.33391555907872
curr_Factors:  [99.33391556]
mat_Sqrt:  [[0.15]]
grads:  [0.12396682]
Stock Position:  0.12396682191596893
Bond Position:  [-11.39133816]


portfolio before change:  [0.88099814]
curr_Stock_Price:  99.00268551560197
curr_Factors:  [99.00268552]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-9.14514425]


portfolio before change:  [0.92268131]
curr_Stock_Price:  99.41992812512785
curr_Factors:  [99.41992813]
mat_Sqrt:  [[0.15]]
grads:  [0.06485917]
Stock Position:  0.06485916910310273
Bond Position:  [-5.52561262]


portfolio before change:  [0.91938218]
curr_Stock_Price:  99.37438692085941
curr_Factors:  [99.37438692]
mat_Sqrt:  [[0.15]]
grads:  [-0.08229875]
Stock Position:  -0.08229875299304328
Bond Position:  [9.0977703]


portfolio before change:  [0.9048648]
curr_Stock_Price:  99.55769477299417
curr_Factors:  [99.55769477]
mat_Sqrt:  [[0.15]]
grads:  [0.08209982]
Stock Position:  0.08209982362358854
Bond Position:  [-7.26880438]


portfolio before change:  [0.97733331]
curr_Stock_Price:  100.44591622469407
curr_Factors:  [100.44591622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610357]
Stock Position:  -0.04610357161849626
Bond Position:  [5.6082488]


portfolio before change:  [0.95266991]
curr_Stock_Price:  100.9884756235732
curr_Factors:  [100.98847562]
mat_Sqrt:  [[0.15]]
grads:  [0.12647191]
Stock Position:  0.12647191143881747
Bond Position:  [-11.81953563]


portfolio before change:  [0.96146931]
curr_Stock_Price:  101.0638927364757
curr_Factors:  [101.06389274]
mat_Sqrt:  [[0.15]]
grads:  [0.07036237]
Stock Position:  0.07036237455247728
Bond Position:  [-6.14962616]


portfolio before change:  [0.95604582]
curr_Stock_Price:  100.9922759696984
curr_Factors:  [100.99227597]
mat_Sqrt:  [[0.15]]
grads:  [-0.07694179]
Stock Position:  -0.07694179227732198
Bond Position:  [8.72657254]


portfolio before change:  [0.95979727]
curr_Stock_Price:  100.95060785286631
curr_Factors:  [100.95060785]
mat_Sqrt:  [[0.15]]
grads:  [-0.00418472]
Stock Position:  -0.004184716729810871
Bond Position:  [1.38224697]


portfolio before change:  [0.9641027]
curr_Stock_Price:  99.94240693179803
curr_Factors:  [99.94240693]
mat_Sqrt:  [[0.15]]
grads:  [0.0881447]
Stock Position:  0.08814470312259541
Bond Position:  [-7.84529109]


portfolio before change:  [0.92426638]
curr_Stock_Price:  99.49602757125056
curr_Factors:  [99.49602757]
mat_Sqrt:  [[0.15]]
grads:  [0.07654025]
Stock Position:  0.07654024516552332
Bond Position:  [-6.69118397]


portfolio before change:  [0.92049258]
curr_Stock_Price:  99.45218672460781
curr_Factors:  [99.45218672]
mat_Sqrt:  [[0.15]]
grads:  [-0.05254348]
Stock Position:  -0.052543482753801586
Bond Position:  [6.14605683]


portfolio before change:  [0.92852972]
curr_Stock_Price:  99.30653584011183
curr_Factors:  [99.30653584]
mat_Sqrt:  [[0.15]]
grads:  [0.05233]
Stock Position:  0.052329998592700114
Bond Position:  [-4.26818116]


portfolio before change:  [0.93938478]
curr_Stock_Price:  99.51906835892406
curr_Factors:  [99.51906836]
mat_Sqrt:  [[0.15]]
grads:  [0.23921295]
Stock Position:  0.23921294838493748
Bond Position:  [-22.86686498]


portfolio before change:  [0.97283024]
curr_Stock_Price:  99.66485763581352
curr_Factors:  [99.66485764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322049]
Stock Position:  -0.03322048671243339
Bond Position:  [4.28374532]


portfolio before change:  [0.97795241]
curr_Stock_Price:  99.51873013418741
curr_Factors:  [99.51873013]
mat_Sqrt:  [[0.15]]
grads:  [0.03458739]
Stock Position:  0.03458739229015638
Bond Position:  [-2.46414095]


portfolio before change:  [0.98848901]
curr_Stock_Price:  99.82782022768912
curr_Factors:  [99.82782023]
mat_Sqrt:  [[0.15]]
grads:  [-0.04811517]
Stock Position:  -0.048115168690518934
Bond Position:  [5.79172142]


portfolio before change:  [0.95810736]
curr_Stock_Price:  100.46677973720469
curr_Factors:  [100.46677974]
mat_Sqrt:  [[0.15]]
grads:  [0.04103065]
Stock Position:  0.041030654469398055
Bond Position:  [-3.16411036]


portfolio before change:  [0.95807498]
curr_Stock_Price:  100.47081042622345
curr_Factors:  [100.47081043]
mat_Sqrt:  [[0.15]]
grads:  [0.03378116]
Stock Position:  0.03378115729169751
Bond Position:  [-2.43594527]


portfolio before change:  [0.96141579]
curr_Stock_Price:  100.57421312670044
curr_Factors:  [100.57421313]
mat_Sqrt:  [[0.15]]
grads:  [-0.02216254]
Stock Position:  -0.022162541338037026
Bond Position:  [3.19039595]


portfolio before change:  [0.9526166]
curr_Stock_Price:  100.98024055403232
curr_Factors:  [100.98024055]
mat_Sqrt:  [[0.15]]
grads:  [0.05589674]
Stock Position:  0.0558967371639614
Bond Position:  [-4.69184937]


portfolio before change:  [0.94375776]
curr_Stock_Price:  100.8270009748264
curr_Factors:  [100.82700097]
mat_Sqrt:  [[0.15]]
grads:  [-0.08007603]
Stock Position:  -0.08007603097165572
Bond Position:  [9.01758381]


portfolio before change:  [1.00858789]
curr_Stock_Price:  100.02443226344242
curr_Factors:  [100.02443226]
mat_Sqrt:  [[0.15]]
grads:  [0.01421029]
Stock Position:  0.014210290395807663
Bond Position:  [-0.41278834]


portfolio before change:  [1.01186744]
curr_Stock_Price:  100.25703451626993
curr_Factors:  [100.25703452]
mat_Sqrt:  [[0.15]]
grads:  [0.03926928]
Stock Position:  0.039269276830092195
Bond Position:  [-2.92515381]


portfolio before change:  [1.01049723]
curr_Stock_Price:  100.22679765988454
curr_Factors:  [100.22679766]
mat_Sqrt:  [[0.15]]
grads:  [0.0770011]
Stock Position:  0.07700110424188263
Bond Position:  [-6.70707687]


portfolio before change:  [0.96393109]
curr_Stock_Price:  99.62749542711362
curr_Factors:  [99.62749543]
mat_Sqrt:  [[0.15]]
grads:  [0.08882886]
Stock Position:  0.08882886137091722
Bond Position:  [-7.88586589]


portfolio before change:  [1.09472677]
curr_Stock_Price:  101.10548985861766
curr_Factors:  [101.10548986]
mat_Sqrt:  [[0.15]]
grads:  [-0.22685444]
Stock Position:  -0.2268544380624744
Bond Position:  [24.03095586]


portfolio before change:  [1.02000184]
curr_Stock_Price:  101.44150669076521
curr_Factors:  [101.44150669]
mat_Sqrt:  [[0.15]]
grads:  [0.06416797]
Stock Position:  0.06416796725375112
Bond Position:  [-5.48929344]


portfolio before change:  [1.03032759]
curr_Stock_Price:  101.60777092014777
curr_Factors:  [101.60777092]
mat_Sqrt:  [[0.15]]
grads:  [0.02598999]
Stock Position:  0.02598999281408554
Bond Position:  [-1.61045765]


portfolio before change:  [1.01336704]
curr_Stock_Price:  100.95906368521095
curr_Factors:  [100.95906369]
mat_Sqrt:  [[0.15]]
grads:  [0.10588636]
Stock Position:  0.1058863555879896
Bond Position:  [-9.67682028]


portfolio before change:  [1.0257233]
curr_Stock_Price:  101.08146931681242
curr_Factors:  [101.08146932]
mat_Sqrt:  [[0.15]]
grads:  [-0.03859953]
Stock Position:  -0.03859953256640003
Bond Position:  [4.92742077]


portfolio before change:  [1.03244924]
curr_Stock_Price:  100.91519865562907
curr_Factors:  [100.91519866]
mat_Sqrt:  [[0.15]]
grads:  [-0.10573]
Stock Position:  -0.10572999875098871
Bond Position:  [11.70221307]


portfolio before change:  [0.98248997]
curr_Stock_Price:  101.39463384467248
curr_Factors:  [101.39463384]
mat_Sqrt:  [[0.15]]
grads:  [0.14827253]
Stock Position:  0.1482725347536752
Bond Position:  [-14.0515494]


portfolio before change:  [0.99291785]
curr_Stock_Price:  101.4708861973112
curr_Factors:  [101.4708862]
mat_Sqrt:  [[0.15]]
grads:  [0.01169109]
Stock Position:  0.01169108962090087
Bond Position:  [-0.19338737]


portfolio before change:  [0.99558365]
curr_Stock_Price:  101.69993982791772
curr_Factors:  [101.69993983]
mat_Sqrt:  [[0.15]]
grads:  [-0.03493201]
Stock Position:  -0.034932010119565114
Bond Position:  [4.54816698]


portfolio before change:  [1.01179654]
curr_Stock_Price:  101.24395081860287
curr_Factors:  [101.24395082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958768]
Stock Position:  -0.009587678780190156
Bond Position:  [1.98249101]


portfolio before change:  [1.01891715]
curr_Stock_Price:  100.5141903961647
curr_Factors:  [100.5141904]
mat_Sqrt:  [[0.15]]
grads:  [0.05699279]
Stock Position:  0.05699278952466469
Bond Position:  [-4.70966694]


portfolio before change:  [1.04621797]
curr_Stock_Price:  100.9983776088497
curr_Factors:  [100.99837761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04779003]
Stock Position:  -0.04779002872985591
Bond Position:  [5.87293334]


portfolio before change:  [1.08795568]
curr_Stock_Price:  100.13270248291441
curr_Factors:  [100.13270248]
mat_Sqrt:  [[0.15]]
grads:  [-0.10103793]
Stock Position:  -0.10103793279982105
Bond Position:  [11.20515694]


portfolio before change:  [1.01749013]
curr_Stock_Price:  100.83705074985805
curr_Factors:  [100.83705075]
mat_Sqrt:  [[0.15]]
grads:  [-0.05131179]
Stock Position:  -0.05131179336873888
Bond Position:  [6.19162004]


portfolio before change:  [1.01805515]
curr_Stock_Price:  100.83358120887543
curr_Factors:  [100.83358121]
mat_Sqrt:  [[0.15]]
grads:  [0.16869581]
Stock Position:  0.16869581265685077
Bond Position:  [-15.99214778]


portfolio before change:  [1.02239158]
curr_Stock_Price:  100.86521195158684
curr_Factors:  [100.86521195]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957021]
Stock Position:  -0.04957021464408583
Bond Position:  [6.02230179]


portfolio before change:  [1.04445693]
curr_Stock_Price:  100.42767220294424
curr_Factors:  [100.4276722]
mat_Sqrt:  [[0.15]]
grads:  [0.00836875]
Stock Position:  0.008368753874097695
Bond Position:  [0.20400245]


portfolio before change:  [1.04106244]
curr_Stock_Price:  100.02053462534475
curr_Factors:  [100.02053463]
mat_Sqrt:  [[0.15]]
grads:  [0.03604274]
Stock Position:  0.03604274017547104
Bond Position:  [-2.5639517]


portfolio before change:  [1.03133006]
curr_Stock_Price:  99.7549573694949
curr_Factors:  [99.75495737]
mat_Sqrt:  [[0.15]]
grads:  [0.03857622]
Stock Position:  0.0385762157995248
Bond Position:  [-2.8168387]


portfolio before change:  [1.05859071]
curr_Stock_Price:  100.4661911203859
curr_Factors:  [100.46619112]
mat_Sqrt:  [[0.15]]
grads:  [-0.02233101]
Stock Position:  -0.022331014708431934
Bond Position:  [3.3021027]


portfolio before change:  [1.05130842]
curr_Stock_Price:  100.80153965411836
curr_Factors:  [100.80153965]
mat_Sqrt:  [[0.15]]
grads:  [0.02723743]
Stock Position:  0.02723742785419876
Bond Position:  [-1.69426624]


portfolio before change:  [1.06185757]
curr_Stock_Price:  101.19273092941707
curr_Factors:  [101.19273093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00344994]
Stock Position:  -0.0034499362078074846
Bond Position:  [1.41096604]


portfolio before change:  [1.06285454]
curr_Stock_Price:  100.92931054196698
curr_Factors:  [100.92931054]
mat_Sqrt:  [[0.15]]
grads:  [0.01039961]
Stock Position:  0.010399607823313135
Bond Position:  [0.01322929]


portfolio before change:  [1.0642487]
curr_Stock_Price:  101.0632895187084
curr_Factors:  [101.06328952]
mat_Sqrt:  [[0.15]]
grads:  [0.07408332]
Stock Position:  0.0740833204074969
Bond Position:  [-6.42285536]


portfolio before change:  [1.08503957]
curr_Stock_Price:  101.34935004869283
curr_Factors:  [101.34935005]
mat_Sqrt:  [[0.15]]
grads:  [-0.00068736]
Stock Position:  -0.0006873617621093569
Bond Position:  [1.15470324]


portfolio before change:  [1.08440692]
curr_Stock_Price:  102.37474471580298
curr_Factors:  [102.37474472]
mat_Sqrt:  [[0.15]]
grads:  [0.06670557]
Stock Position:  0.06670556782754133
Bond Position:  [-5.74455855]


portfolio before change:  [1.0371421]
curr_Stock_Price:  101.67156828875359
curr_Factors:  [101.67156829]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767453]
Stock Position:  -0.02767452965880518
Bond Position:  [3.85085493]


portfolio before change:  [1.05901788]
curr_Stock_Price:  100.88979900353108
curr_Factors:  [100.889799]
mat_Sqrt:  [[0.15]]
grads:  [-0.08949271]
Stock Position:  -0.08949271416435838
Bond Position:  [10.08791982]


portfolio before change:  [1.04840843]
curr_Stock_Price:  101.01539539841978
curr_Factors:  [101.0153954]
mat_Sqrt:  [[0.15]]
grads:  [-0.04059612]
Stock Position:  -0.04059612458426526
Bond Position:  [5.14924201]


portfolio before change:  [1.07493336]
curr_Stock_Price:  100.36993738443842
curr_Factors:  [100.36993738]
mat_Sqrt:  [[0.15]]
grads:  [0.01166741]
Stock Position:  0.01166740968668099
Bond Position:  [-0.09612382]


portfolio before change:  [1.06947334]
curr_Stock_Price:  99.9024800493881
curr_Factors:  [99.90248005]
mat_Sqrt:  [[0.15]]
grads:  [-0.03499308]
Stock Position:  -0.03499307746440187
Bond Position:  [4.56536856]


portfolio before change:  [1.10749475]
curr_Stock_Price:  98.82409347759568
curr_Factors:  [98.82409348]
mat_Sqrt:  [[0.15]]
grads:  [0.14302717]
Stock Position:  0.1430271748065409
Bond Position:  [-13.02703614]


portfolio before change:  [1.23443685]
curr_Stock_Price:  99.71732454244183
curr_Factors:  [99.71732454]
mat_Sqrt:  [[0.15]]
grads:  [-0.05850563]
Stock Position:  -0.05850563231958035
Bond Position:  [7.06846197]


portfolio before change:  [1.21581837]
curr_Stock_Price:  100.04310969594124
curr_Factors:  [100.0431097]
mat_Sqrt:  [[0.15]]
grads:  [0.04708504]
Stock Position:  0.04708504346624234
Bond Position:  [-3.49471579]


portfolio before change:  [1.22808279]
curr_Stock_Price:  100.30822239408263
curr_Factors:  [100.30822239]
mat_Sqrt:  [[0.15]]
grads:  [-0.06901147]
Stock Position:  -0.06901147197074671
Bond Position:  [8.15050087]


portfolio before change:  [1.19199864]
curr_Stock_Price:  100.83847591740185
curr_Factors:  [100.83847592]
mat_Sqrt:  [[0.15]]
grads:  [0.0734329]
Stock Position:  0.0734328969696402
Bond Position:  [-6.21286278]


portfolio before change:  [1.19804559]
curr_Stock_Price:  100.92611060640549
curr_Factors:  [100.92611061]
mat_Sqrt:  [[0.15]]
grads:  [-0.05543215]
Stock Position:  -0.055432149399101904
Bond Position:  [6.79259683]


portfolio before change:  [1.19950232]
curr_Stock_Price:  100.9074901024749
curr_Factors:  [100.9074901]
mat_Sqrt:  [[0.15]]
grads:  [0.11643885]
Stock Position:  0.11643885143155432
Bond Position:  [-10.55004993]


portfolio before change:  [1.195606]
curr_Stock_Price:  100.87969083706766
curr_Factors:  [100.87969084]
mat_Sqrt:  [[0.15]]
grads:  [-0.14992654]
Stock Position:  -0.14992654332337263
Bond Position:  [16.32014934]


portfolio before change:  [1.21035886]
curr_Stock_Price:  100.78809386867871
curr_Factors:  [100.78809387]
mat_Sqrt:  [[0.15]]
grads:  [-0.02876528]
Stock Position:  -0.028765277350440828
Bond Position:  [4.10955633]


portfolio before change:  [1.20520797]
curr_Stock_Price:  100.97608955707756
curr_Factors:  [100.97608956]
mat_Sqrt:  [[0.15]]
grads:  [-0.06090633]
Stock Position:  -0.06090632502879392
Bond Position:  [7.3552905]


portfolio before change:  [1.21743011]
curr_Stock_Price:  100.78296632906222
curr_Factors:  [100.78296633]
mat_Sqrt:  [[0.15]]
grads:  [-0.00983409]
Stock Position:  -0.009834089564620853
Bond Position:  [2.20853883]


portfolio before change:  [1.22353612]
curr_Stock_Price:  100.17610069255782
curr_Factors:  [100.17610069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.22353612]
Stock Price:  100.04406752408654
PL:  [1.1794686]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.69285858e-04]
 [ 1.93044734e-03]
 [-2.85643623e-03]
 [ 8.49319139e-03]
 [ 3.12657153e-03]
 [ 1.78169104e-02]
 [ 1.85078020e-03]
 [-1.80111461e-02]
 [ 6.06539550e-03]
 [ 2.86009924e-02]
 [ 1.48381979e-02]
 [-1.51349772e-02]
 [ 3.76900698e-02]
 [ 1.57302388e-03]
 [-6.89936078e-03]
 [ 1.85363808e-02]
 [ 1.05390419e-02]
 [-1.15405883e-02]
 [-6.04856533e-04]
 [-5.53442836e-03]
 [ 1.36954815e-02]
 [-3.38595567e-03]
 [ 9.02395201e-03]
 [-1.34755219e-02]
 [ 3.97023798e-03]
 [ 7.10268096e-03]
 [-5.14778750e-03]
 [ 1.47243895e-02]
 [ 4.90026140e-02]
 [ 4.25153751e-03]
 [ 1.58078355e-02]
 [-9.38935268e-03]
 [ 2.90807750e-03]
 [ 8.21428404e-03]
 [ 1.08023661e-02]
 [ 8.50153712e-03]
 [-3.37503665e-02]
 [ 9.73911678e-03]
 [ 4.04982656e-03]
 [ 2.00186796e-02]
 [-5.45724837e-03]
 [-1.84662672e-02]
 [ 2.11483110e-02]
 [-7.13826730e-05]
 [-5.66351698e-03]
 [-7.03662362e-03]
 [ 1.20834637e-02]
 [-2.69685090e-04]
 [ 1.36188590e-03]
 [-7.38619223e-03]
 [-3.83300851e-02]
 [ 2.99743784e-03]
 [-9.55590876e-03]
 [ 5.86092539e-03]
 [-1.83867767e-02]
 [ 2.83276933e-02]
 [ 1.52565055e-02]
 [ 1.04525317e-03]
 [ 1.91430408e-03]
 [ 7.35234494e-03]
 [ 1.20990324e-02]
 [ 3.55182702e-02]
 [-1.51770128e-03]
 [-1.21843740e-02]
 [ 1.61399288e-02]
 [ 7.79970048e-03]
 [-5.01963824e-03]
 [ 1.57059688e-02]
 [-1.66074396e-02]
 [-4.13786861e-02]
 [-5.22368379e-03]
 [ 1.57224678e-02]
 [-2.27614477e-02]
 [ 2.77247414e-02]
 [-2.53157788e-02]
 [ 1.22289512e-03]
 [-7.23178298e-04]
 [-1.24072865e-02]
 [ 2.60921533e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.72776717]
curr_Stock_Price:  100.30471933921778
curr_Factors:  [100.30471934]
mat_Sqrt:  [[0.15]]
grads:  [0.00179524]
Stock Position:  0.0017952390562941032
Bond Position:  [6.54769622]


portfolio before change:  [6.72890438]
curr_Stock_Price:  100.7102202896815
curr_Factors:  [100.71022029]
mat_Sqrt:  [[0.15]]
grads:  [0.01286965]
Stock Position:  0.012869648924717767
Bond Position:  [5.43279921]


portfolio before change:  [6.7280377]
curr_Stock_Price:  100.61649234176711
curr_Factors:  [100.61649234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01904291]
Stock Position:  -0.01904290818463209
Bond Position:  [8.64406832]


portfolio before change:  [6.74757647]
curr_Stock_Price:  99.61882457020148
curr_Factors:  [99.61882457]
mat_Sqrt:  [[0.15]]
grads:  [0.05662128]
Stock Position:  0.05662127595860481
Bond Position:  [1.10703151]


portfolio before change:  [6.73283655]
curr_Stock_Price:  99.35727788055702
curr_Factors:  [99.35727788]
mat_Sqrt:  [[0.15]]
grads:  [0.02084381]
Stock Position:  0.020843810215871138
Bond Position:  [4.66185231]


portfolio before change:  [6.7253038]
curr_Stock_Price:  98.98190888828219
curr_Factors:  [98.98190889]
mat_Sqrt:  [[0.15]]
grads:  [0.1187794]
Stock Position:  0.11877940245397389
Bond Position:  [-5.03170819]


portfolio before change:  [6.70010245]
curr_Stock_Price:  98.77238716870808
curr_Factors:  [98.77238717]
mat_Sqrt:  [[0.15]]
grads:  [0.01233853]
Stock Position:  0.012338534642855815
Bond Position:  [5.48139593]


portfolio before change:  [6.70968246]
curr_Stock_Price:  99.52105056355151
curr_Factors:  [99.52105056]
mat_Sqrt:  [[0.15]]
grads:  [-0.12007431]
Stock Position:  -0.12007430754840419
Bond Position:  [18.65960369]


portfolio before change:  [6.75714125]
curr_Stock_Price:  99.1355181670607
curr_Factors:  [99.13551817]
mat_Sqrt:  [[0.15]]
grads:  [0.04043597]
Stock Position:  0.04043597002700148
Bond Position:  [2.74850041]


portfolio before change:  [6.70858734]
curr_Stock_Price:  97.93050935572533
curr_Factors:  [97.93050936]
mat_Sqrt:  [[0.15]]
grads:  [0.19067328]
Stock Position:  0.1906732826447608
Bond Position:  [-11.96414435]


portfolio before change:  [6.95863998]
curr_Stock_Price:  99.24585054271655
curr_Factors:  [99.24585054]
mat_Sqrt:  [[0.15]]
grads:  [0.09892132]
Stock Position:  0.09892131924639501
Bond Position:  [-2.85889049]


portfolio before change:  [7.06544133]
curr_Stock_Price:  100.32731651149233
curr_Factors:  [100.32731651]
mat_Sqrt:  [[0.15]]
grads:  [-0.10089985]
Stock Position:  -0.10089984823178756
Bond Position:  [17.18845234]


portfolio before change:  [6.96569717]
curr_Stock_Price:  101.32651001526585
curr_Factors:  [101.32651002]
mat_Sqrt:  [[0.15]]
grads:  [0.25126713]
Stock Position:  0.2512671320838505
Bond Position:  [-18.4943244]


portfolio before change:  [6.83888489]
curr_Stock_Price:  100.82641933580632
curr_Factors:  [100.82641934]
mat_Sqrt:  [[0.15]]
grads:  [0.01048683]
Stock Position:  0.010486825835264732
Bond Position:  [5.78153579]


portfolio before change:  [6.85134079]
curr_Stock_Price:  101.979727982238
curr_Factors:  [101.97972798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599574]
Stock Position:  -0.04599573854760175
Bond Position:  [11.5419737]


portfolio before change:  [6.90167413]
curr_Stock_Price:  100.901107680364
curr_Factors:  [100.90110768]
mat_Sqrt:  [[0.15]]
grads:  [0.12357587]
Stock Position:  0.12357587198191858
Bond Position:  [-5.56726824]


portfolio before change:  [6.91006809]
curr_Stock_Price:  100.97184907851702
curr_Factors:  [100.97184908]
mat_Sqrt:  [[0.15]]
grads:  [0.07026028]
Stock Position:  0.07026027908963436
Bond Position:  [-0.1842422]


portfolio before change:  [6.91365584]
curr_Stock_Price:  101.02307660466076
curr_Factors:  [101.0230766]
mat_Sqrt:  [[0.15]]
grads:  [-0.07693726]
Stock Position:  -0.07693725551274351
Bond Position:  [14.68609409]


portfolio before change:  [6.9229736]
curr_Stock_Price:  100.91389862894995
curr_Factors:  [100.91389863]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403238]
Stock Position:  -0.004032376888098132
Bond Position:  [7.32989647]


portfolio before change:  [6.92120217]
curr_Stock_Price:  101.46681424549708
curr_Factors:  [101.46681425]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689619]
Stock Position:  -0.03689618909622431
Bond Position:  [10.66494093]


portfolio before change:  [6.91250439]
curr_Stock_Price:  101.72061708103855
curr_Factors:  [101.72061708]
mat_Sqrt:  [[0.15]]
grads:  [0.09130321]
Stock Position:  0.09130320982224605
Bond Position:  [-2.37491445]


portfolio before change:  [6.90143045]
curr_Stock_Price:  101.60095533766278
curr_Factors:  [101.60095534]
mat_Sqrt:  [[0.15]]
grads:  [-0.02257304]
Stock Position:  -0.02257303779430463
Bond Position:  [9.19487266]


portfolio before change:  [6.90495912]
curr_Stock_Price:  101.47009273417244
curr_Factors:  [101.47009273]
mat_Sqrt:  [[0.15]]
grads:  [0.06015968]
Stock Position:  0.0601596800745076
Bond Position:  [0.8005508]


portfolio before change:  [6.96826589]
curr_Stock_Price:  102.52157336663385
curr_Factors:  [102.52157337]
mat_Sqrt:  [[0.15]]
grads:  [-0.08983681]
Stock Position:  -0.08983681247632556
Bond Position:  [16.17847725]


portfolio before change:  [6.97395813]
curr_Stock_Price:  102.469467174028
curr_Factors:  [102.46946717]
mat_Sqrt:  [[0.15]]
grads:  [0.02646825]
Stock Position:  0.02646825321514736
Bond Position:  [4.26177033]


portfolio before change:  [6.9960176]
curr_Stock_Price:  103.29283472404322
curr_Factors:  [103.29283472]
mat_Sqrt:  [[0.15]]
grads:  [0.04735121]
Stock Position:  0.04735120639515498
Bond Position:  [2.10497727]


portfolio before change:  [6.99230721]
curr_Stock_Price:  103.21169717410162
curr_Factors:  [103.21169717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03431858]
Stock Position:  -0.034318583345045166
Bond Position:  [10.53438644]


portfolio before change:  [6.97811994]
curr_Stock_Price:  103.64428170071396
curr_Factors:  [103.6442817]
mat_Sqrt:  [[0.15]]
grads:  [0.0981626]
Stock Position:  0.09816259690649268
Bond Position:  [-3.19587191]


portfolio before change:  [6.97085419]
curr_Stock_Price:  103.57229911739682
curr_Factors:  [103.57229912]
mat_Sqrt:  [[0.15]]
grads:  [0.32668409]
Stock Position:  0.3266840933035432
Bond Position:  [-26.86456844]


portfolio before change:  [6.95827053]
curr_Stock_Price:  103.53891955147188
curr_Factors:  [103.53891955]
mat_Sqrt:  [[0.15]]
grads:  [0.02834358]
Stock Position:  0.0283435833736033
Bond Position:  [4.02360653]


portfolio before change:  [6.93770372]
curr_Stock_Price:  102.80442209180625
curr_Factors:  [102.80442209]
mat_Sqrt:  [[0.15]]
grads:  [0.10538557]
Stock Position:  0.10538557026173896
Bond Position:  [-3.89639892]


portfolio before change:  [6.91891741]
curr_Stock_Price:  102.62847027735933
curr_Factors:  [102.62847028]
mat_Sqrt:  [[0.15]]
grads:  [-0.06259568]
Stock Position:  -0.06259568455791602
Bond Position:  [13.34301676]


portfolio before change:  [6.90385179]
curr_Stock_Price:  102.88247482617449
curr_Factors:  [102.88247483]
mat_Sqrt:  [[0.15]]
grads:  [0.01938718]
Stock Position:  0.019387183313620163
Bond Position:  [4.90925039]


portfolio before change:  [6.88220158]
curr_Stock_Price:  101.74992024819532
curr_Factors:  [101.74992025]
mat_Sqrt:  [[0.15]]
grads:  [0.05476189]
Stock Position:  0.054761893585648085
Bond Position:  [1.31018328]


portfolio before change:  [6.91601218]
curr_Stock_Price:  102.36583605372397
curr_Factors:  [102.36583605]
mat_Sqrt:  [[0.15]]
grads:  [0.07201577]
Stock Position:  0.0720157738129476
Bond Position:  [-0.45594271]


portfolio before change:  [6.88776265]
curr_Stock_Price:  101.97396309641807
curr_Factors:  [101.9739631]
mat_Sqrt:  [[0.15]]
grads:  [0.05667691]
Stock Position:  0.056676914108974845
Bond Position:  [1.10819311]


portfolio before change:  [6.86945519]
curr_Stock_Price:  101.64972661946697
curr_Factors:  [101.64972662]
mat_Sqrt:  [[0.15]]
grads:  [-0.22500244]
Stock Position:  -0.22500244343804077
Bond Position:  [29.74089206]


portfolio before change:  [7.05946286]
curr_Stock_Price:  100.81351879970273
curr_Factors:  [100.8135188]
mat_Sqrt:  [[0.15]]
grads:  [0.06492745]
Stock Position:  0.06492744523191778
Bond Position:  [0.51389864]


portfolio before change:  [7.11287421]
curr_Stock_Price:  101.63565541960051
curr_Factors:  [101.63565542]
mat_Sqrt:  [[0.15]]
grads:  [0.02699884]
Stock Position:  0.026998843735557786
Bond Position:  [4.36882903]


portfolio before change:  [7.12668778]
curr_Stock_Price:  102.13717713246457
curr_Factors:  [102.13717713]
mat_Sqrt:  [[0.15]]
grads:  [0.13345786]
Stock Position:  0.13345786396703013
Bond Position:  [-6.50432171]


portfolio before change:  [7.0473307]
curr_Stock_Price:  101.54560058103513
curr_Factors:  [101.54560058]
mat_Sqrt:  [[0.15]]
grads:  [-0.03638166]
Stock Position:  -0.036381655768412464
Bond Position:  [10.74172779]


portfolio before change:  [7.0553926]
curr_Stock_Price:  101.34246189772936
curr_Factors:  [101.3424619]
mat_Sqrt:  [[0.15]]
grads:  [-0.12310845]
Stock Position:  -0.12310844786935021
Bond Position:  [19.53150579]


portfolio before change:  [6.95663345]
curr_Stock_Price:  102.15459068764336
curr_Factors:  [102.15459069]
mat_Sqrt:  [[0.15]]
grads:  [0.14098874]
Stock Position:  0.14098874000332912
Bond Position:  [-7.44601358]


portfolio before change:  [7.00729337]
curr_Stock_Price:  102.5172105231374
curr_Factors:  [102.51721052]
mat_Sqrt:  [[0.15]]
grads:  [-0.00047588]
Stock Position:  -0.00047588448687991305
Bond Position:  [7.05607972]


portfolio before change:  [7.00818322]
curr_Stock_Price:  101.5740562376537
curr_Factors:  [101.57405624]
mat_Sqrt:  [[0.15]]
grads:  [-0.03775678]
Stock Position:  -0.037756779837217626
Bond Position:  [10.8432925]


portfolio before change:  [7.00389316]
curr_Stock_Price:  101.70562957329221
curr_Factors:  [101.70562957]
mat_Sqrt:  [[0.15]]
grads:  [-0.04691082]
Stock Position:  -0.046910824114968386
Bond Position:  [11.77498806]


portfolio before change:  [7.00822502]
curr_Stock_Price:  101.6289756586708
curr_Factors:  [101.62897566]
mat_Sqrt:  [[0.15]]
grads:  [0.08055642]
Stock Position:  0.08055642468038668
Bond Position:  [-1.1786419]


portfolio before change:  [7.05172363]
curr_Stock_Price:  102.16986710545918
curr_Factors:  [102.16986711]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017979]
Stock Position:  -0.001797900601772986
Bond Position:  [7.2354149]


portfolio before change:  [7.05104909]
curr_Stock_Price:  102.7965839400745
curr_Factors:  [102.79658394]
mat_Sqrt:  [[0.15]]
grads:  [0.00907924]
Stock Position:  0.009079239337879408
Bond Position:  [6.1177343]


portfolio before change:  [7.05579818]
curr_Stock_Price:  103.27754053855685
curr_Factors:  [103.27754054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04924128]
Stock Position:  -0.04924128152666854
Bond Position:  [12.14131663]


portfolio before change:  [7.07736182]
curr_Stock_Price:  102.85503354413565
curr_Factors:  [102.85503354]
mat_Sqrt:  [[0.15]]
grads:  [-0.2555339]
Stock Position:  -0.2555339008145
Bond Position:  [33.36030976]


portfolio before change:  [6.78855558]
curr_Stock_Price:  103.99340039898591
curr_Factors:  [103.9934004]
mat_Sqrt:  [[0.15]]
grads:  [0.01998292]
Stock Position:  0.01998291894286401
Bond Position:  [4.71046389]


portfolio before change:  [6.80556476]
curr_Stock_Price:  104.82985294603267
curr_Factors:  [104.82985295]
mat_Sqrt:  [[0.15]]
grads:  [-0.06370606]
Stock Position:  -0.06370605837317594
Bond Position:  [13.48386149]


portfolio before change:  [6.76224605]
curr_Stock_Price:  105.52305981993673
curr_Factors:  [105.52305982]
mat_Sqrt:  [[0.15]]
grads:  [0.03907284]
Stock Position:  0.03907283592957435
Bond Position:  [2.63916084]


portfolio before change:  [6.78640431]
curr_Stock_Price:  106.1371261196971
curr_Factors:  [106.13712612]
mat_Sqrt:  [[0.15]]
grads:  [-0.12257851]
Stock Position:  -0.12257851100057351
Bond Position:  [19.79653519]


portfolio before change:  [6.75378186]
curr_Stock_Price:  106.41335542389166
curr_Factors:  [106.41335542]
mat_Sqrt:  [[0.15]]
grads:  [0.18885129]
Stock Position:  0.18885128834468665
Bond Position:  [-13.34251741]


portfolio before change:  [6.75312262]
curr_Stock_Price:  106.41428048277353
curr_Factors:  [106.41428048]
mat_Sqrt:  [[0.15]]
grads:  [0.10171004]
Stock Position:  0.10171003647535329
Bond Position:  [-4.07027773]


portfolio before change:  [6.63302304]
curr_Stock_Price:  105.23597803886216
curr_Factors:  [105.23597804]
mat_Sqrt:  [[0.15]]
grads:  [0.00696835]
Stock Position:  0.00696835444742657
Bond Position:  [5.89970144]


portfolio before change:  [6.63787996]
curr_Stock_Price:  105.88005837360886
curr_Factors:  [105.88005837]
mat_Sqrt:  [[0.15]]
grads:  [0.01276203]
Stock Position:  0.012762027171150376
Bond Position:  [5.28663578]


portfolio before change:  [6.63259817]
curr_Stock_Price:  105.44029978560009
curr_Factors:  [105.44029979]
mat_Sqrt:  [[0.15]]
grads:  [0.04901563]
Stock Position:  0.04901563293291336
Bond Position:  [1.46437514]


portfolio before change:  [6.61100529]
curr_Stock_Price:  104.99790195429946
curr_Factors:  [104.99790195]
mat_Sqrt:  [[0.15]]
grads:  [0.08066022]
Stock Position:  0.08066021629316174
Bond Position:  [-1.85814819]


portfolio before change:  [6.65478056]
curr_Stock_Price:  105.5420538748057
curr_Factors:  [105.54205387]
mat_Sqrt:  [[0.15]]
grads:  [0.23678847]
Stock Position:  0.23678846797354727
Bond Position:  [-18.33636068]


portfolio before change:  [6.79180915]
curr_Stock_Price:  106.12559006464443
curr_Factors:  [106.12559006]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011801]
Stock Position:  -0.010118008517136802
Bond Position:  [7.86558877]


portfolio before change:  [6.79155038]
curr_Stock_Price:  106.19975319257586
curr_Factors:  [106.19975319]
mat_Sqrt:  [[0.15]]
grads:  [-0.08122916]
Stock Position:  -0.08122915999886968
Bond Position:  [15.41806712]


portfolio before change:  [6.792019]
curr_Stock_Price:  106.20584752895284
curr_Factors:  [106.20584753]
mat_Sqrt:  [[0.15]]
grads:  [0.10759953]
Stock Position:  0.10759952559358482
Bond Position:  [-4.63567981]


portfolio before change:  [6.79922896]
curr_Stock_Price:  106.27554768424002
curr_Factors:  [106.27554768]
mat_Sqrt:  [[0.15]]
grads:  [0.051998]
Stock Position:  0.05199800321440462
Bond Position:  [1.27311269]


portfolio before change:  [6.82594129]
curr_Stock_Price:  106.78773569697796
curr_Factors:  [106.7877357]
mat_Sqrt:  [[0.15]]
grads:  [-0.03346425]
Stock Position:  -0.033464254926493686
Bond Position:  [10.3995133]


portfolio before change:  [6.80284394]
curr_Stock_Price:  107.4973686973188
curr_Factors:  [107.4973687]
mat_Sqrt:  [[0.15]]
grads:  [0.10470646]
Stock Position:  0.10470645833643838
Bond Position:  [-4.45282482]


portfolio before change:  [6.73219602]
curr_Stock_Price:  106.82530305395728
curr_Factors:  [106.82530305]
mat_Sqrt:  [[0.15]]
grads:  [-0.11071626]
Stock Position:  -0.11071626418208867
Bond Position:  [18.55949449]


portfolio before change:  [6.62720673]
curr_Stock_Price:  107.78405374320435
curr_Factors:  [107.78405374]
mat_Sqrt:  [[0.15]]
grads:  [-0.27585791]
Stock Position:  -0.27585790729017146
Bond Position:  [36.36029023]


portfolio before change:  [6.68304562]
curr_Stock_Price:  107.58987294468183
curr_Factors:  [107.58987294]
mat_Sqrt:  [[0.15]]
grads:  [-0.03482456]
Stock Position:  -0.03482455859719884
Bond Position:  [10.42981546]


portfolio before change:  [6.69774311]
curr_Stock_Price:  107.18654846279695
curr_Factors:  [107.18654846]
mat_Sqrt:  [[0.15]]
grads:  [0.10481645]
Stock Position:  0.10481645180075291
Bond Position:  [-4.53717059]


portfolio before change:  [6.65217323]
curr_Stock_Price:  106.75449513817736
curr_Factors:  [106.75449514]
mat_Sqrt:  [[0.15]]
grads:  [-0.15174298]
Stock Position:  -0.15174298488038526
Bond Position:  [22.85141897]


portfolio before change:  [6.77424446]
curr_Stock_Price:  105.95944700610669
curr_Factors:  [105.95944701]
mat_Sqrt:  [[0.15]]
grads:  [0.18483161]
Stock Position:  0.18483160931974435
Bond Position:  [-12.81041065]


portfolio before change:  [6.55473062]
curr_Stock_Price:  104.77613660106682
curr_Factors:  [104.7761366]
mat_Sqrt:  [[0.15]]
grads:  [-0.16877186]
Stock Position:  -0.16877185845264872
Bond Position:  [24.23799392]


portfolio before change:  [6.59506993]
curr_Stock_Price:  104.54609595595215
curr_Factors:  [104.54609596]
mat_Sqrt:  [[0.15]]
grads:  [0.00815263]
Stock Position:  0.008152634140754332
Bond Position:  [5.74274386]


portfolio before change:  [6.59701985]
curr_Stock_Price:  104.74124638291855
curr_Factors:  [104.74124638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00482119]
Stock Position:  -0.004821188652641469
Bond Position:  [7.10199716]


portfolio before change:  [6.59398354]
curr_Stock_Price:  105.46310207014564
curr_Factors:  [105.46310207]
mat_Sqrt:  [[0.15]]
grads:  [-0.08271524]
Stock Position:  -0.0827152430982886
Bond Position:  [15.31738966]


portfolio before change:  [6.59482428]
curr_Stock_Price:  105.46451197597511
curr_Factors:  [105.46451198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.59482428]
Stock Price:  106.35946786216627
PL:  [0.23535642]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.35110182e-04]
 [ 2.66104006e-03]
 [-7.70844200e-04]
 [ 8.34758369e-03]
 [ 4.94631476e-03]
 [ 2.52807095e-02]
 [ 1.67870664e-03]
 [-1.38874826e-02]
 [ 2.45673479e-02]
 [-3.96742571e-03]
 [ 1.39475277e-02]
 [-4.44494211e-03]
 [ 1.19924289e-02]
 [ 2.56956723e-03]
 [-6.91437570e-03]
 [ 1.22835259e-02]
 [ 7.19459982e-03]
 [-9.27562819e-03]
 [ 1.30347232e-03]
 [ 9.63993225e-03]
 [ 1.24010361e-02]
 [-9.90805436e-03]
 [ 3.85187550e-03]
 [-3.69008218e-03]
 [-8.07846175e-03]
 [-8.58816434e-03]
 [-4.97475845e-03]
 [ 9.70994162e-03]
 [-3.34371937e-02]
 [ 1.87299839e-03]
 [ 6.43544644e-04]
 [-1.00947740e-02]
 [-9.29113218e-03]
 [ 5.67050831e-03]
 [ 1.37576343e-02]
 [ 9.00044861e-03]
 [-3.23486393e-02]
 [ 8.01098121e-03]
 [-4.31636570e-02]
 [-6.79488150e-03]
 [-1.53284196e-02]
 [ 6.34126299e-02]
 [ 2.35664549e-02]
 [ 2.95596430e-03]
 [ 1.10781449e-02]
 [ 2.55078292e-02]
 [-2.73212224e-03]
 [-4.82608673e-03]
 [ 2.55080424e-02]
 [ 6.52972881e-03]
 [ 3.50044024e-02]
 [ 3.69270400e-03]
 [ 1.36963369e-03]
 [ 4.70214455e-03]
 [ 3.97059308e-03]
 [ 4.69284546e-03]
 [-1.68426964e-02]
 [-1.16333494e-04]
 [ 1.56826831e-03]
 [-1.02845207e-02]
 [-5.25830311e-03]
 [ 7.63923768e-03]
 [ 1.44031631e-02]
 [-1.89053253e-02]
 [-6.30464811e-03]
 [-1.72802509e-02]
 [-4.41653661e-03]
 [ 6.85483720e-03]
 [-1.29968431e-02]
 [ 1.17091217e-02]
 [ 6.23199204e-03]
 [ 1.20456669e-02]
 [ 2.13624919e-03]
 [ 2.35491215e-03]
 [-6.54126970e-03]
 [-1.07082544e-02]
 [ 1.15506424e-03]
 [ 1.95310928e-03]
 [-9.82700490e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.48587383]
curr_Stock_Price:  100.54909007058788
curr_Factors:  [100.54909007]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223407]
Stock Position:  -0.002234067876797456
Bond Position:  [10.71050733]


portfolio before change:  [10.48690355]
curr_Stock_Price:  100.38782118530709
curr_Factors:  [100.38782119]
mat_Sqrt:  [[0.15]]
grads:  [0.01774027]
Stock Position:  0.017740267096156125
Bond Position:  [8.70599679]


portfolio before change:  [10.47162539]
curr_Stock_Price:  99.4959348969053
curr_Factors:  [99.4959349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00513896]
Stock Position:  -0.0051389613327771045
Bond Position:  [10.98293115]


portfolio before change:  [10.47052761]
curr_Stock_Price:  99.84313107267445
curr_Factors:  [99.84313107]
mat_Sqrt:  [[0.15]]
grads:  [0.05565056]
Stock Position:  0.055650557966043075
Bond Position:  [4.91420166]


portfolio before change:  [10.47969778]
curr_Stock_Price:  100.0023930865427
curr_Factors:  [100.00239309]
mat_Sqrt:  [[0.15]]
grads:  [0.03297543]
Stock Position:  0.0329754317477137
Bond Position:  [7.18207569]


portfolio before change:  [10.48624961]
curr_Stock_Price:  100.18746821059511
curr_Factors:  [100.18746821]
mat_Sqrt:  [[0.15]]
grads:  [0.16853806]
Stock Position:  0.16853806333181715
Bond Position:  [-6.39915225]


portfolio before change:  [10.48377785]
curr_Stock_Price:  100.17517544605795
curr_Factors:  [100.17517545]
mat_Sqrt:  [[0.15]]
grads:  [0.01119138]
Stock Position:  0.011191377589864309
Bond Position:  [9.36267964]


portfolio before change:  [10.48741686]
curr_Stock_Price:  100.44804886188649
curr_Factors:  [100.44804886]
mat_Sqrt:  [[0.15]]
grads:  [-0.09258322]
Stock Position:  -0.09258321756539982
Bond Position:  [19.78722043]


portfolio before change:  [10.45330253]
curr_Stock_Price:  100.8298791149604
curr_Factors:  [100.82987911]
mat_Sqrt:  [[0.15]]
grads:  [0.16378232]
Stock Position:  0.16378231935590484
Bond Position:  [-6.06084893]


portfolio before change:  [10.40942038]
curr_Stock_Price:  100.5642623194379
curr_Factors:  [100.56426232]
mat_Sqrt:  [[0.15]]
grads:  [-0.0264495]
Stock Position:  -0.026449504728868718
Bond Position:  [13.06929531]


portfolio before change:  [10.41910449]
curr_Stock_Price:  100.22901034151926
curr_Factors:  [100.22901034]
mat_Sqrt:  [[0.15]]
grads:  [0.09298352]
Stock Position:  0.09298351779809577
Bond Position:  [1.09945852]


portfolio before change:  [10.38406425]
curr_Stock_Price:  99.85142782464924
curr_Factors:  [99.85142782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02963295]
Stock Position:  -0.029632947371616127
Bond Position:  [13.34295636]


portfolio before change:  [10.36193732]
curr_Stock_Price:  100.62627123961043
curr_Factors:  [100.62627124]
mat_Sqrt:  [[0.15]]
grads:  [0.07994953]
Stock Position:  0.07994952618377657
Bond Position:  [2.31691461]


portfolio before change:  [10.39467662]
curr_Stock_Price:  101.03395961291828
curr_Factors:  [101.03395961]
mat_Sqrt:  [[0.15]]
grads:  [0.01713045]
Stock Position:  0.01713044817222104
Bond Position:  [8.66391962]


portfolio before change:  [10.38029491]
curr_Stock_Price:  100.16280772968611
curr_Factors:  [100.16280773]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609584]
Stock Position:  -0.04609583797514147
Bond Position:  [14.99738347]


portfolio before change:  [10.38727599]
curr_Stock_Price:  100.03169596739103
curr_Factors:  [100.03169597]
mat_Sqrt:  [[0.15]]
grads:  [0.08189017]
Stock Position:  0.0818901726989796
Bond Position:  [2.19566313]


portfolio before change:  [10.32424649]
curr_Stock_Price:  99.26033691738849
curr_Factors:  [99.26033692]
mat_Sqrt:  [[0.15]]
grads:  [0.047964]
Stock Position:  0.04796399882114504
Bond Position:  [5.56332381]


portfolio before change:  [10.30799849]
curr_Stock_Price:  98.91433313310552
curr_Factors:  [98.91433313]
mat_Sqrt:  [[0.15]]
grads:  [-0.06183752]
Stock Position:  -0.06183752125382538
Bond Position:  [16.42461567]


portfolio before change:  [10.34623737]
curr_Stock_Price:  98.31255749558558
curr_Factors:  [98.3125575]
mat_Sqrt:  [[0.15]]
grads:  [0.00868982]
Stock Position:  0.0086898154917317
Bond Position:  [9.49191939]


portfolio before change:  [10.34388056]
curr_Stock_Price:  97.97307063057426
curr_Factors:  [97.97307063]
mat_Sqrt:  [[0.15]]
grads:  [0.06426622]
Stock Position:  0.06426621501149657
Bond Position:  [4.04752213]


portfolio before change:  [10.33580136]
curr_Stock_Price:  97.84341967305508
curr_Factors:  [97.84341967]
mat_Sqrt:  [[0.15]]
grads:  [0.08267357]
Stock Position:  0.08267357396225661
Bond Position:  [2.24673617]


portfolio before change:  [10.30834829]
curr_Stock_Price:  97.50965523925001
curr_Factors:  [97.50965524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0660537]
Stock Position:  -0.0660536957617199
Bond Position:  [16.74922139]


portfolio before change:  [10.33663022]
curr_Stock_Price:  97.09733800629517
curr_Factors:  [97.09733801]
mat_Sqrt:  [[0.15]]
grads:  [0.02567917]
Stock Position:  0.02567917001766114
Bond Position:  [7.84325117]


portfolio before change:  [10.35987834]
curr_Stock_Price:  97.98357751539528
curr_Factors:  [97.98357752]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460055]
Stock Position:  -0.02460054785371396
Bond Position:  [12.77032802]


portfolio before change:  [10.34124589]
curr_Stock_Price:  98.77342223524124
curr_Factors:  [98.77342224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385641]
Stock Position:  -0.05385641163670228
Bond Position:  [15.66082798]


portfolio before change:  [10.36006009]
curr_Stock_Price:  98.44225714383411
curr_Factors:  [98.44225714]
mat_Sqrt:  [[0.15]]
grads:  [-0.05725443]
Stock Position:  -0.05725442892120322
Bond Position:  [15.9963153]


portfolio before change:  [10.34506448]
curr_Stock_Price:  98.7216313953847
curr_Factors:  [98.7216314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03316506]
Stock Position:  -0.03316505636430936
Bond Position:  [13.61917295]


portfolio before change:  [10.39907738]
curr_Stock_Price:  97.11868899533572
curr_Factors:  [97.118689]
mat_Sqrt:  [[0.15]]
grads:  [0.06473294]
Stock Position:  0.06473294416646815
Bond Position:  [4.1122987]


portfolio before change:  [10.38778713]
curr_Stock_Price:  96.94030580283844
curr_Factors:  [96.9403058]
mat_Sqrt:  [[0.15]]
grads:  [-0.22291462]
Stock Position:  -0.22291462490029818
Bond Position:  [31.99719904]


portfolio before change:  [10.26853931]
curr_Stock_Price:  97.48422574115902
curr_Factors:  [97.48422574]
mat_Sqrt:  [[0.15]]
grads:  [0.01248666]
Stock Position:  0.012486655903364974
Bond Position:  [9.05128733]


portfolio before change:  [10.27198961]
curr_Stock_Price:  97.71523862977583
curr_Factors:  [97.71523863]
mat_Sqrt:  [[0.15]]
grads:  [0.0042903]
Stock Position:  0.004290297629005006
Bond Position:  [9.85276216]


portfolio before change:  [10.27201048]
curr_Stock_Price:  97.57656493859308
curr_Factors:  [97.57656494]
mat_Sqrt:  [[0.15]]
grads:  [-0.06729849]
Stock Position:  -0.06729849331118697
Bond Position:  [16.83876628]


portfolio before change:  [10.25880236]
curr_Stock_Price:  97.78846530461799
curr_Factors:  [97.7884653]
mat_Sqrt:  [[0.15]]
grads:  [-0.06194088]
Stock Position:  -0.06194088120856103
Bond Position:  [16.31590607]


portfolio before change:  [10.32033569]
curr_Stock_Price:  96.8115087213922
curr_Factors:  [96.81150872]
mat_Sqrt:  [[0.15]]
grads:  [0.03780339]
Stock Position:  0.03780338874978378
Bond Position:  [6.66053259]


portfolio before change:  [10.33899728]
curr_Stock_Price:  97.294145142482
curr_Factors:  [97.29414514]
mat_Sqrt:  [[0.15]]
grads:  [0.09171756]
Stock Position:  0.0917175619388789
Bond Position:  [1.41541549]


portfolio before change:  [10.25208269]
curr_Stock_Price:  96.3455475651339
curr_Factors:  [96.34554757]
mat_Sqrt:  [[0.15]]
grads:  [0.06000299]
Stock Position:  0.06000299072799827
Bond Position:  [4.47106169]


portfolio before change:  [10.23111143]
curr_Stock_Price:  95.9913868031838
curr_Factors:  [95.9913868]
mat_Sqrt:  [[0.15]]
grads:  [-0.2156576]
Stock Position:  -0.21565759512100052
Bond Position:  [30.93238306]


portfolio before change:  [10.26247049]
curr_Stock_Price:  95.85494032154593
curr_Factors:  [95.85494032]
mat_Sqrt:  [[0.15]]
grads:  [0.05340654]
Stock Position:  0.05340654140866194
Bond Position:  [5.14318965]


portfolio before change:  [10.21998688]
curr_Stock_Price:  95.05344560117008
curr_Factors:  [95.0534456]
mat_Sqrt:  [[0.15]]
grads:  [-0.28775771]
Stock Position:  -0.287757713454021
Bond Position:  [37.57234905]


portfolio before change:  [10.36901437]
curr_Stock_Price:  94.54371421041708
curr_Factors:  [94.54371421]
mat_Sqrt:  [[0.15]]
grads:  [-0.04529921]
Stock Position:  -0.04529921000357725
Bond Position:  [14.65176993]


portfolio before change:  [10.37693731]
curr_Stock_Price:  94.38902776374762
curr_Factors:  [94.38902776]
mat_Sqrt:  [[0.15]]
grads:  [-0.10218946]
Stock Position:  -0.10218946405727339
Bond Position:  [20.02250147]


portfolio before change:  [10.40725586]
curr_Stock_Price:  94.10458449927344
curr_Factors:  [94.1045845]
mat_Sqrt:  [[0.15]]
grads:  [0.42275087]
Stock Position:  0.4227508659538452
Bond Position:  [-29.37553873]


portfolio before change:  [10.20355786]
curr_Stock_Price:  93.62708820756889
curr_Factors:  [93.62708821]
mat_Sqrt:  [[0.15]]
grads:  [0.1571097]
Stock Position:  0.15710969952663217
Bond Position:  [-4.50616584]


portfolio before change:  [10.26270866]
curr_Stock_Price:  94.00537448325959
curr_Factors:  [94.00537448]
mat_Sqrt:  [[0.15]]
grads:  [0.01970643]
Stock Position:  0.019706428694215853
Bond Position:  [8.41019845]


portfolio before change:  [10.26531006]
curr_Stock_Price:  94.11070835673301
curr_Factors:  [94.11070836]
mat_Sqrt:  [[0.15]]
grads:  [0.0738543]
Stock Position:  0.07385429936521087
Bond Position:  [3.31482964]


portfolio before change:  [10.28877981]
curr_Stock_Price:  94.42568752456143
curr_Factors:  [94.42568752]
mat_Sqrt:  [[0.15]]
grads:  [0.17005219]
Stock Position:  0.1700521946860352
Bond Position:  [-5.76851558]


portfolio before change:  [10.30757667]
curr_Stock_Price:  94.53834351575946
curr_Factors:  [94.53834352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01821415]
Stock Position:  -0.018214148289115696
Bond Position:  [12.02951208]


portfolio before change:  [10.30493969]
curr_Stock_Price:  94.72439948649941
curr_Factors:  [94.72439949]
mat_Sqrt:  [[0.15]]
grads:  [-0.03217391]
Stock Position:  -0.03217391151085836
Bond Position:  [13.35259413]


portfolio before change:  [10.33019422]
curr_Stock_Price:  93.9654001969803
curr_Factors:  [93.9654002]
mat_Sqrt:  [[0.15]]
grads:  [0.17005362]
Stock Position:  0.17005361625681853
Bond Position:  [-5.64896188]


portfolio before change:  [10.4268708]
curr_Stock_Price:  94.53598284836632
curr_Factors:  [94.53598285]
mat_Sqrt:  [[0.15]]
grads:  [0.04353153]
Stock Position:  0.043531525382235654
Bond Position:  [6.31157526]


portfolio before change:  [10.46909531]
curr_Stock_Price:  95.49689617880443
curr_Factors:  [95.49689618]
mat_Sqrt:  [[0.15]]
grads:  [0.23336268]
Stock Position:  0.23336268245425687
Bond Position:  [-11.81631655]


portfolio before change:  [10.46304255]
curr_Stock_Price:  95.47412383524164
curr_Factors:  [95.47412384]
mat_Sqrt:  [[0.15]]
grads:  [0.02461803]
Stock Position:  0.02461802668443767
Bond Position:  [8.11265802]


portfolio before change:  [10.46761263]
curr_Stock_Price:  95.63916670733478
curr_Factors:  [95.63916671]
mat_Sqrt:  [[0.15]]
grads:  [0.00913089]
Stock Position:  0.009130891252538664
Bond Position:  [9.5943418]


portfolio before change:  [10.46559778]
curr_Stock_Price:  95.3528291048883
curr_Factors:  [95.3528291]
mat_Sqrt:  [[0.15]]
grads:  [0.03134763]
Stock Position:  0.03134763033654856
Bond Position:  [7.47651254]


portfolio before change:  [10.43526607]
curr_Stock_Price:  94.37033020743667
curr_Factors:  [94.37033021]
mat_Sqrt:  [[0.15]]
grads:  [0.02647062]
Stock Position:  0.026470620518033387
Bond Position:  [7.93722487]


portfolio before change:  [10.43370111]
curr_Stock_Price:  94.29246843998132
curr_Factors:  [94.29246844]
mat_Sqrt:  [[0.15]]
grads:  [0.03128564]
Stock Position:  0.03128563638779822
Bond Position:  [7.48370123]


portfolio before change:  [10.43791084]
curr_Stock_Price:  94.4120757015928
curr_Factors:  [94.4120757]
mat_Sqrt:  [[0.15]]
grads:  [-0.11228464]
Stock Position:  -0.11228464246689364
Bond Position:  [21.03893701]


portfolio before change:  [10.33226674]
curr_Stock_Price:  95.36464652842986
curr_Factors:  [95.36464653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00077556]
Stock Position:  -0.0007755566273648085
Bond Position:  [10.40622743]


portfolio before change:  [10.33264167]
curr_Stock_Price:  95.71985915761843
curr_Factors:  [95.71985916]
mat_Sqrt:  [[0.15]]
grads:  [0.01045512]
Stock Position:  0.010455122064617427
Bond Position:  [9.33187885]


portfolio before change:  [10.34670667]
curr_Stock_Price:  97.00934589713029
curr_Factors:  [97.0093459]
mat_Sqrt:  [[0.15]]
grads:  [-0.06856347]
Stock Position:  -0.06856347150233594
Bond Position:  [16.99800419]


portfolio before change:  [10.35850066]
curr_Stock_Price:  96.85282554638573
curr_Factors:  [96.85282555]
mat_Sqrt:  [[0.15]]
grads:  [-0.03505535]
Stock Position:  -0.03505535408837327
Bond Position:  [13.75371075]


portfolio before change:  [10.35659902]
curr_Stock_Price:  96.93159440637842
curr_Factors:  [96.93159441]
mat_Sqrt:  [[0.15]]
grads:  [0.05092825]
Stock Position:  0.05092825119229163
Bond Position:  [5.42004243]


portfolio before change:  [10.33567278]
curr_Stock_Price:  96.51404623474251
curr_Factors:  [96.51404623]
mat_Sqrt:  [[0.15]]
grads:  [0.09602109]
Stock Position:  0.0960210871660838
Bond Position:  [1.06828914]


portfolio before change:  [10.28642457]
curr_Stock_Price:  96.00046124841047
curr_Factors:  [96.00046125]
mat_Sqrt:  [[0.15]]
grads:  [-0.1260355]
Stock Position:  -0.12603550184334641
Bond Position:  [22.38589088]


portfolio before change:  [10.21256919]
curr_Stock_Price:  96.5975512162369
curr_Factors:  [96.59755122]
mat_Sqrt:  [[0.15]]
grads:  [-0.04203099]
Stock Position:  -0.042030987409621114
Bond Position:  [14.27265965]


portfolio before change:  [10.25656102]
curr_Stock_Price:  95.57212311707184
curr_Factors:  [95.57212312]
mat_Sqrt:  [[0.15]]
grads:  [-0.11520167]
Stock Position:  -0.11520167259799381
Bond Position:  [21.26662945]


portfolio before change:  [10.26145674]
curr_Stock_Price:  95.54116421356271
curr_Factors:  [95.54116421]
mat_Sqrt:  [[0.15]]
grads:  [-0.02944358]
Stock Position:  -0.029443577419261697
Bond Position:  [13.07453041]


portfolio before change:  [10.25631718]
curr_Stock_Price:  95.74347469971016
curr_Factors:  [95.7434747]
mat_Sqrt:  [[0.15]]
grads:  [0.04569891]
Stock Position:  0.045698914651373615
Bond Position:  [5.8809443]


portfolio before change:  [10.2746135]
curr_Stock_Price:  96.13579794206562
curr_Factors:  [96.13579794]
mat_Sqrt:  [[0.15]]
grads:  [-0.08664562]
Stock Position:  -0.0866456209037763
Bond Position:  [18.6043594]


portfolio before change:  [10.33356153]
curr_Stock_Price:  95.46888344656546
curr_Factors:  [95.46888345]
mat_Sqrt:  [[0.15]]
grads:  [0.07806081]
Stock Position:  0.07806081146584298
Bond Position:  [2.88118302]


portfolio before change:  [10.27106511]
curr_Stock_Price:  94.66596464956886
curr_Factors:  [94.66596465]
mat_Sqrt:  [[0.15]]
grads:  [0.04154661]
Stock Position:  0.04154661359569078
Bond Position:  [6.33801486]


portfolio before change:  [10.31362348]
curr_Stock_Price:  95.68078209847107
curr_Factors:  [95.6807821]
mat_Sqrt:  [[0.15]]
grads:  [0.08030445]
Stock Position:  0.0803044458043491
Bond Position:  [2.6300313]


portfolio before change:  [10.3554359]
curr_Stock_Price:  96.1994088470502
curr_Factors:  [96.19940885]
mat_Sqrt:  [[0.15]]
grads:  [0.01424166]
Stock Position:  0.01424166128484743
Bond Position:  [8.9853965]


portfolio before change:  [10.36084048]
curr_Stock_Price:  96.53946616470832
curr_Factors:  [96.53946616]
mat_Sqrt:  [[0.15]]
grads:  [0.01569941]
Stock Position:  0.015699414360661176
Bond Position:  [8.8452274]


portfolio before change:  [10.36724384]
curr_Stock_Price:  96.91212419139114
curr_Factors:  [96.91212419]
mat_Sqrt:  [[0.15]]
grads:  [-0.04360846]
Stock Position:  -0.04360846467838122
Bond Position:  [14.59343278]


portfolio before change:  [10.35660424]
curr_Stock_Price:  97.1770205063649
curr_Factors:  [97.17702051]
mat_Sqrt:  [[0.15]]
grads:  [-0.07138836]
Stock Position:  -0.07138836235506366
Bond Position:  [17.29391259]


portfolio before change:  [10.29512741]
curr_Stock_Price:  98.05332197075681
curr_Factors:  [98.05332197]
mat_Sqrt:  [[0.15]]
grads:  [0.00770043]
Stock Position:  0.00770042828889809
Bond Position:  [9.54007484]


portfolio before change:  [10.29716211]
curr_Stock_Price:  98.24011954473185
curr_Factors:  [98.24011954]
mat_Sqrt:  [[0.15]]
grads:  [0.01302073]
Stock Position:  0.013020728533940606
Bond Position:  [9.01800418]


portfolio before change:  [10.29799609]
curr_Stock_Price:  98.26088197823096
curr_Factors:  [98.26088198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.29799609]
Stock Price:  98.5191956633874
PL:  [10.29799609]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.62383172e-03]
 [-2.14122260e-02]
 [-2.75009070e-03]
 [ 6.29867486e-03]
 [-5.56101491e-03]
 [ 3.03376008e-03]
 [ 4.86008707e-03]
 [-2.94691966e-02]
 [-3.78568390e-02]
 [ 3.29601815e-02]
 [-1.33184274e-02]
 [ 2.99549165e-02]
 [-1.11526031e-02]
 [ 5.67897422e-03]
 [-7.02540353e-03]
 [ 1.06053297e-02]
 [ 1.09290056e-02]
 [ 3.56933850e-04]
 [ 1.27955909e-03]
 [ 1.25897884e-02]
 [ 1.31173948e-02]
 [-1.07571846e-02]
 [ 4.79270966e-03]
 [-9.66471811e-04]
 [-8.10350154e-03]
 [-5.73601474e-03]
 [-4.77369920e-03]
 [ 6.13691631e-03]
 [-1.48385065e-02]
 [-1.37124681e-03]
 [-4.45555352e-03]
 [-1.05853851e-02]
 [ 5.10689830e-03]
 [ 4.71534330e-03]
 [ 1.22347071e-02]
 [ 1.44016591e-02]
 [-3.46779646e-02]
 [ 8.79574914e-03]
 [-2.35291186e-02]
 [ 2.10795100e-02]
 [-6.10122816e-03]
 [ 2.94213025e-02]
 [ 2.30707277e-02]
 [ 4.17681590e-03]
 [ 2.67294370e-03]
 [ 3.96929055e-03]
 [ 1.86106085e-03]
 [-1.20964267e-02]
 [-6.45776956e-03]
 [-1.50128035e-03]
 [ 4.40560509e-02]
 [-6.09825021e-03]
 [ 2.10271950e-03]
 [ 4.89039105e-03]
 [ 4.04915005e-03]
 [ 3.03070005e-03]
 [-3.07477302e-03]
 [-6.74102647e-04]
 [ 1.53491638e-03]
 [ 3.54980850e-03]
 [ 1.22008652e-03]
 [ 2.71993596e-04]
 [ 1.01932516e-02]
 [-1.84597920e-02]
 [-8.55545683e-03]
 [-8.71611622e-03]
 [-4.73221315e-03]
 [ 1.86666390e-02]
 [-1.02476426e-02]
 [ 6.97561657e-03]
 [-3.04515995e-03]
 [ 1.14374320e-02]
 [-2.88917640e-03]
 [ 7.12725468e-03]
 [-1.42335922e-02]
 [-8.45788532e-03]
 [ 3.02178182e-03]
 [ 3.37973282e-03]
 [-8.88176796e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.84572585]
curr_Stock_Price:  98.77185392503488
curr_Factors:  [98.77185393]
mat_Sqrt:  [[0.15]]
grads:  [0.06415888]
Stock Position:  0.06415887811961347
Bond Position:  [-23.18281718]


portfolio before change:  [-16.842784]
curr_Stock_Price:  98.84029055471537
curr_Factors:  [98.84029055]
mat_Sqrt:  [[0.15]]
grads:  [-0.14274817]
Stock Position:  -0.1427481734599361
Bond Position:  [-2.73351306]


portfolio before change:  [-16.87487762]
curr_Stock_Price:  99.06392055018225
curr_Factors:  [99.06392055]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833394]
Stock Position:  -0.018333938024847955
Bond Position:  [-15.05864584]


portfolio before change:  [-16.867619]
curr_Stock_Price:  98.61667274112436
curr_Factors:  [98.61667274]
mat_Sqrt:  [[0.15]]
grads:  [0.04199117]
Stock Position:  0.04199116573952726
Bond Position:  [-21.00864805]


portfolio before change:  [-16.88712677]
curr_Stock_Price:  98.18337483958186
curr_Factors:  [98.18337484]
mat_Sqrt:  [[0.15]]
grads:  [-0.03707343]
Stock Position:  -0.037073432731652735
Bond Position:  [-13.24713203]


portfolio before change:  [-16.84275376]
curr_Stock_Price:  96.96414637161551
curr_Factors:  [96.96414637]
mat_Sqrt:  [[0.15]]
grads:  [0.02022507]
Stock Position:  0.02022506721785509
Bond Position:  [-18.80386013]


portfolio before change:  [-16.83537337]
curr_Stock_Price:  97.38716929644355
curr_Factors:  [97.3871693]
mat_Sqrt:  [[0.15]]
grads:  [0.03240058]
Stock Position:  0.03240058047227163
Bond Position:  [-19.99077418]


portfolio before change:  [-16.85367882]
curr_Stock_Price:  96.8607591858455
curr_Factors:  [96.86075919]
mat_Sqrt:  [[0.15]]
grads:  [-0.19646131]
Stock Position:  -0.19646131040527623
Bond Position:  [2.17571285]


portfolio before change:  [-16.87318838]
curr_Stock_Price:  96.96075619567523
curr_Factors:  [96.9607562]
mat_Sqrt:  [[0.15]]
grads:  [-0.25237893]
Stock Position:  -0.2523789263695597
Bond Position:  [7.59766317]


portfolio before change:  [-16.98616006]
curr_Stock_Price:  97.41026498144844
curr_Factors:  [97.41026498]
mat_Sqrt:  [[0.15]]
grads:  [0.21973454]
Stock Position:  0.21973454347567004
Bond Position:  [-38.39056016]


portfolio before change:  [-16.7928393]
curr_Stock_Price:  98.3009772116847
curr_Factors:  [98.30097721]
mat_Sqrt:  [[0.15]]
grads:  [-0.08878952]
Stock Position:  -0.08878951593605233
Bond Position:  [-8.06474311]


portfolio before change:  [-16.71148102]
curr_Stock_Price:  97.37899513835052
curr_Factors:  [97.37899514]
mat_Sqrt:  [[0.15]]
grads:  [0.19969944]
Stock Position:  0.19969944320834418
Bond Position:  [-36.15801213]


portfolio before change:  [-16.71745515]
curr_Stock_Price:  97.3603962604977
curr_Factors:  [97.36039626]
mat_Sqrt:  [[0.15]]
grads:  [-0.07435069]
Stock Position:  -0.07435068715954075
Bond Position:  [-9.47864278]


portfolio before change:  [-16.78777053]
curr_Stock_Price:  98.29815418865579
curr_Factors:  [98.29815419]
mat_Sqrt:  [[0.15]]
grads:  [0.03785983]
Stock Position:  0.03785982813685269
Bond Position:  [-20.50932175]


portfolio before change:  [-16.8185078]
curr_Stock_Price:  97.52014212360142
curr_Factors:  [97.52014212]
mat_Sqrt:  [[0.15]]
grads:  [-0.04683602]
Stock Position:  -0.046836023511522225
Bond Position:  [-12.25105213]


portfolio before change:  [-16.80870107]
curr_Stock_Price:  97.29440878364692
curr_Factors:  [97.29440878]
mat_Sqrt:  [[0.15]]
grads:  [0.0707022]
Stock Position:  0.07070219801248874
Bond Position:  [-23.68762962]


portfolio before change:  [-16.78861179]
curr_Stock_Price:  97.59948841505356
curr_Factors:  [97.59948842]
mat_Sqrt:  [[0.15]]
grads:  [0.07286004]
Stock Position:  0.07286003760792224
Bond Position:  [-23.89971419]


portfolio before change:  [-16.79705181]
curr_Stock_Price:  97.50415161629687
curr_Factors:  [97.50415162]
mat_Sqrt:  [[0.15]]
grads:  [0.00237956]
Stock Position:  0.0023795589991322877
Bond Position:  [-17.02906869]


portfolio before change:  [-16.79986663]
curr_Stock_Price:  96.76852329252247
curr_Factors:  [96.76852329]
mat_Sqrt:  [[0.15]]
grads:  [0.00853039]
Stock Position:  0.008530393905291478
Bond Position:  [-17.62534025]


portfolio before change:  [-16.80635036]
curr_Stock_Price:  96.13758956717832
curr_Factors:  [96.13758957]
mat_Sqrt:  [[0.15]]
grads:  [0.08393192]
Stock Position:  0.08393192248535346
Bond Position:  [-24.87536308]


portfolio before change:  [-16.7919854]
curr_Stock_Price:  96.3272638109552
curr_Factors:  [96.32726381]
mat_Sqrt:  [[0.15]]
grads:  [0.0874493]
Stock Position:  0.08744929897333116
Bond Position:  [-25.21573709]


portfolio before change:  [-16.78195318]
curr_Stock_Price:  96.4600064996363
curr_Factors:  [96.4600065]
mat_Sqrt:  [[0.15]]
grads:  [-0.07171456]
Stock Position:  -0.07171456383275653
Bond Position:  [-9.86436588]


portfolio before change:  [-16.85375036]
curr_Stock_Price:  97.45256141455461
curr_Factors:  [97.45256141]
mat_Sqrt:  [[0.15]]
grads:  [0.0319514]
Stock Position:  0.031951397730597075
Bond Position:  [-19.96749591]


portfolio before change:  [-16.83371107]
curr_Stock_Price:  98.1188013365154
curr_Factors:  [98.11880134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00644315]
Stock Position:  -0.006443145408482019
Bond Position:  [-16.20151737]


portfolio before change:  [-16.83782821]
curr_Stock_Price:  98.60063279153302
curr_Factors:  [98.60063279]
mat_Sqrt:  [[0.15]]
grads:  [-0.05402334]
Stock Position:  -0.05402334356920744
Bond Position:  [-11.51109235]


portfolio before change:  [-16.84772626]
curr_Stock_Price:  98.77053313841657
curr_Factors:  [98.77053314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0382401]
Stock Position:  -0.038240098256693306
Bond Position:  [-13.07073137]


portfolio before change:  [-16.84365677]
curr_Stock_Price:  98.642750181989
curr_Factors:  [98.64275018]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182466]
Stock Position:  -0.03182466131093115
Bond Position:  [-13.70438466]


portfolio before change:  [-16.86484593]
curr_Stock_Price:  99.28164473766765
curr_Factors:  [99.28164474]
mat_Sqrt:  [[0.15]]
grads:  [0.04091278]
Stock Position:  0.040912775382097304
Bond Position:  [-20.92673356]


portfolio before change:  [-16.89683061]
curr_Stock_Price:  98.53183671656166
curr_Factors:  [98.53183672]
mat_Sqrt:  [[0.15]]
grads:  [-0.09892338]
Stock Position:  -0.09892337650714361
Bond Position:  [-7.14972863]


portfolio before change:  [-16.94132069]
curr_Stock_Price:  98.97706218846469
curr_Factors:  [98.97706219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00914165]
Stock Position:  -0.009141645390185032
Bond Position:  [-16.03650749]


portfolio before change:  [-16.94556918]
curr_Stock_Price:  99.33215994422767
curr_Factors:  [99.33215994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02970369]
Stock Position:  -0.02970369013184531
Bond Position:  [-13.99503748]


portfolio before change:  [-16.9533548]
curr_Stock_Price:  99.56482113980017
curr_Factors:  [99.56482114]
mat_Sqrt:  [[0.15]]
grads:  [-0.07056923]
Stock Position:  -0.0705692342908181
Bond Position:  [-9.92714161]


portfolio before change:  [-17.01475654]
curr_Stock_Price:  100.42612102141366
curr_Factors:  [100.42612102]
mat_Sqrt:  [[0.15]]
grads:  [0.03404599]
Stock Position:  0.034045988653896256
Bond Position:  [-20.43386311]


portfolio before change:  [-17.04001008]
curr_Stock_Price:  99.72188556762424
curr_Factors:  [99.72188557]
mat_Sqrt:  [[0.15]]
grads:  [0.03143562]
Stock Position:  0.03143562199319525
Bond Position:  [-20.17482958]


portfolio before change:  [-17.0591172]
curr_Stock_Price:  99.15418106117848
curr_Factors:  [99.15418106]
mat_Sqrt:  [[0.15]]
grads:  [0.08156471]
Stock Position:  0.08156471376653844
Bond Position:  [-25.14659959]


portfolio before change:  [-17.06183057]
curr_Stock_Price:  99.14018408007223
curr_Factors:  [99.14018408]
mat_Sqrt:  [[0.15]]
grads:  [0.09601106]
Stock Position:  0.09601106042076361
Bond Position:  [-26.58038477]


portfolio before change:  [-17.14248304]
curr_Stock_Price:  98.31745443002748
curr_Factors:  [98.31745443]
mat_Sqrt:  [[0.15]]
grads:  [-0.23118643]
Stock Position:  -0.23118643071146158
Bond Position:  [5.58717833]


portfolio before change:  [-17.04507108]
curr_Stock_Price:  97.89760821317005
curr_Factors:  [97.89760821]
mat_Sqrt:  [[0.15]]
grads:  [0.05863833]
Stock Position:  0.05863832760759402
Bond Position:  [-22.7856231]


portfolio before change:  [-17.05826352]
curr_Stock_Price:  97.69691543572273
curr_Factors:  [97.69691544]
mat_Sqrt:  [[0.15]]
grads:  [-0.15686079]
Stock Position:  -0.1568607905173726
Bond Position:  [-1.73344813]


portfolio before change:  [-17.12492127]
curr_Stock_Price:  98.12117321792472
curr_Factors:  [98.12117322]
mat_Sqrt:  [[0.15]]
grads:  [0.14053007]
Stock Position:  0.140530066588448
Bond Position:  [-30.91389628]


portfolio before change:  [-17.10916845]
curr_Stock_Price:  98.2470181790933
curr_Factors:  [98.24701818]
mat_Sqrt:  [[0.15]]
grads:  [-0.04067485]
Stock Position:  -0.040674854373513376
Bond Position:  [-13.11298529]


portfolio before change:  [-17.06619704]
curr_Stock_Price:  97.17040722240476
curr_Factors:  [97.17040722]
mat_Sqrt:  [[0.15]]
grads:  [0.19614202]
Stock Position:  0.19614201637998027
Bond Position:  [-36.12539665]


portfolio before change:  [-17.01544384]
curr_Stock_Price:  97.4406762151987
curr_Factors:  [97.44067622]
mat_Sqrt:  [[0.15]]
grads:  [0.15380485]
Stock Position:  0.153804851546047
Bond Position:  [-32.00229258]


portfolio before change:  [-17.0590938]
curr_Stock_Price:  97.16988012399328
curr_Factors:  [97.16988012]
mat_Sqrt:  [[0.15]]
grads:  [0.02784544]
Stock Position:  0.02784543935048105
Bond Position:  [-19.76483181]


portfolio before change:  [-17.05790302]
curr_Stock_Price:  97.25700819835218
curr_Factors:  [97.2570082]
mat_Sqrt:  [[0.15]]
grads:  [0.01781962]
Stock Position:  0.017819624644626154
Bond Position:  [-18.7909864]


portfolio before change:  [-17.06349171]
curr_Stock_Price:  97.00929171310612
curr_Factors:  [97.00929171]
mat_Sqrt:  [[0.15]]
grads:  [0.02646194]
Stock Position:  0.026461936968685103
Bond Position:  [-19.63054547]


portfolio before change:  [-17.0470355]
curr_Stock_Price:  97.67754051398927
curr_Factors:  [97.67754051]
mat_Sqrt:  [[0.15]]
grads:  [0.01240707]
Stock Position:  0.012407072321119981
Bond Position:  [-18.25892781]


portfolio before change:  [-17.04853683]
curr_Stock_Price:  97.64851561865856
curr_Factors:  [97.64851562]
mat_Sqrt:  [[0.15]]
grads:  [-0.08064284]
Stock Position:  -0.08064284437412406
Bond Position:  [-9.17388279]


portfolio before change:  [-17.05674248]
curr_Stock_Price:  97.74315832787138
curr_Factors:  [97.74315833]
mat_Sqrt:  [[0.15]]
grads:  [-0.0430518]
Stock Position:  -0.04305179708937046
Bond Position:  [-12.84872386]


portfolio before change:  [-17.05079936]
curr_Stock_Price:  97.5864589926642
curr_Factors:  [97.58645899]
mat_Sqrt:  [[0.15]]
grads:  [-0.01000854]
Stock Position:  -0.010008535635678962
Bond Position:  [-16.07410181]


portfolio before change:  [-17.05281527]
curr_Stock_Price:  97.68749744087356
curr_Factors:  [97.68749744]
mat_Sqrt:  [[0.15]]
grads:  [0.29370701]
Stock Position:  0.29370700603889593
Bond Position:  [-45.74431767]


portfolio before change:  [-17.22103137]
curr_Stock_Price:  97.12449761269463
curr_Factors:  [97.12449761]
mat_Sqrt:  [[0.15]]
grads:  [-0.040655]
Stock Position:  -0.040655001405053716
Bond Position:  [-13.27243479]


portfolio before change:  [-17.19839868]
curr_Stock_Price:  96.54739159177728
curr_Factors:  [96.54739159]
mat_Sqrt:  [[0.15]]
grads:  [0.01401813]
Stock Position:  0.01401813003236935
Bond Position:  [-18.55181257]


portfolio before change:  [-17.20221491]
curr_Stock_Price:  96.35787227807134
curr_Factors:  [96.35787228]
mat_Sqrt:  [[0.15]]
grads:  [0.03260261]
Stock Position:  0.03260260700671855
Bond Position:  [-20.34373275]


portfolio before change:  [-17.1996687]
curr_Stock_Price:  96.47497129625017
curr_Factors:  [96.4749713]
mat_Sqrt:  [[0.15]]
grads:  [0.02699433]
Stock Position:  0.02699433365210134
Bond Position:  [-19.80394626]


portfolio before change:  [-17.21518233]
curr_Stock_Price:  95.9461253733041
curr_Factors:  [95.94612537]
mat_Sqrt:  [[0.15]]
grads:  [0.02020467]
Stock Position:  0.020204667029228504
Bond Position:  [-19.15374184]


portfolio before change:  [-17.20459033]
curr_Stock_Price:  96.52961140037726
curr_Factors:  [96.5296114]
mat_Sqrt:  [[0.15]]
grads:  [-0.02049849]
Stock Position:  -0.020498486809441583
Bond Position:  [-15.22587937]


portfolio before change:  [-17.23026308]
curr_Stock_Price:  97.73560778545153
curr_Factors:  [97.73560779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449402]
Stock Position:  -0.004494017649655124
Bond Position:  [-16.79103754]


portfolio before change:  [-17.23353249]
curr_Stock_Price:  98.22958419220463
curr_Factors:  [98.22958419]
mat_Sqrt:  [[0.15]]
grads:  [0.01023278]
Stock Position:  0.010232775895225326
Bond Position:  [-18.23869382]


portfolio before change:  [-17.23174898]
curr_Stock_Price:  98.51528080055341
curr_Factors:  [98.5152808]
mat_Sqrt:  [[0.15]]
grads:  [0.02366539]
Stock Position:  0.02366538998699901
Bond Position:  [-19.56315152]


portfolio before change:  [-17.21986151]
curr_Stock_Price:  99.06926295063506
curr_Factors:  [99.06926295]
mat_Sqrt:  [[0.15]]
grads:  [0.00813391]
Stock Position:  0.008133910116160884
Bond Position:  [-18.02568199]


portfolio before change:  [-17.22745922]
curr_Stock_Price:  98.27369599807211
curr_Factors:  [98.273696]
mat_Sqrt:  [[0.15]]
grads:  [0.00181329]
Stock Position:  0.0018132906412270805
Bond Position:  [-17.40565799]


portfolio before change:  [-17.22950561]
curr_Stock_Price:  97.74509539823933
curr_Factors:  [97.7450954]
mat_Sqrt:  [[0.15]]
grads:  [0.06795501]
Stock Position:  0.06795501039437449
Bond Position:  [-23.87177459]


portfolio before change:  [-17.26243452]
curr_Stock_Price:  97.28248233119409
curr_Factors:  [97.28248233]
mat_Sqrt:  [[0.15]]
grads:  [-0.12306528]
Stock Position:  -0.12306527982123522
Bond Position:  [-5.29033861]


portfolio before change:  [-17.27789953]
curr_Stock_Price:  97.40546058029855
curr_Factors:  [97.40546058]
mat_Sqrt:  [[0.15]]
grads:  [-0.05703638]
Stock Position:  -0.0570363788565149
Bond Position:  [-11.72224478]


portfolio before change:  [-17.27545553]
curr_Stock_Price:  97.34976511960801
curr_Factors:  [97.34976512]
mat_Sqrt:  [[0.15]]
grads:  [-0.05810744]
Stock Position:  -0.05810744148635069
Bond Position:  [-11.61870975]


portfolio before change:  [-17.28386815]
curr_Stock_Price:  97.48204471556457
curr_Factors:  [97.48204472]
mat_Sqrt:  [[0.15]]
grads:  [-0.03154809]
Stock Position:  -0.03154808768230036
Bond Position:  [-14.20849605]


portfolio before change:  [-17.29852245]
curr_Stock_Price:  97.91840200305556
curr_Factors:  [97.918402]
mat_Sqrt:  [[0.15]]
grads:  [0.12444426]
Stock Position:  0.12444425984669143
Bond Position:  [-29.48390551]


portfolio before change:  [-17.32049026]
curr_Stock_Price:  97.75668289879495
curr_Factors:  [97.7566829]
mat_Sqrt:  [[0.15]]
grads:  [-0.06831762]
Stock Position:  -0.06831761761360701
Bond Position:  [-10.64198658]


portfolio before change:  [-17.33851536]
curr_Stock_Price:  98.01078941635151
curr_Factors:  [98.01078942]
mat_Sqrt:  [[0.15]]
grads:  [0.04650411]
Stock Position:  0.04650411046693315
Bond Position:  [-21.89641994]


portfolio before change:  [-17.36858827]
curr_Stock_Price:  97.3935462760103
curr_Factors:  [97.39354628]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030107]
Stock Position:  -0.020301066320389864
Bond Position:  [-15.39139543]


portfolio before change:  [-17.37309348]
curr_Stock_Price:  97.56807964062975
curr_Factors:  [97.56807964]
mat_Sqrt:  [[0.15]]
grads:  [0.07624955]
Stock Position:  0.07624954697135386
Bond Position:  [-24.81261535]


portfolio before change:  [-17.31759387]
curr_Stock_Price:  98.31628658240855
curr_Factors:  [98.31628658]
mat_Sqrt:  [[0.15]]
grads:  [-0.01926118]
Stock Position:  -0.019261175977944526
Bond Position:  [-15.42390658]


portfolio before change:  [-17.31594492]
curr_Stock_Price:  98.18062641323205
curr_Factors:  [98.18062641]
mat_Sqrt:  [[0.15]]
grads:  [0.04751503]
Stock Position:  0.047515031213530616
Bond Position:  [-21.98100045]


portfolio before change:  [-17.32190286]
curr_Stock_Price:  98.08414987417692
curr_Factors:  [98.08414987]
mat_Sqrt:  [[0.15]]
grads:  [-0.09489061]
Stock Position:  -0.09489061474966619
Bond Position:  [-8.01463759]


portfolio before change:  [-17.30620564]
curr_Stock_Price:  97.91344647267914
curr_Factors:  [97.91344647]
mat_Sqrt:  [[0.15]]
grads:  [-0.0563859]
Stock Position:  -0.05638590210507511
Bond Position:  [-11.78526764]


portfolio before change:  [-17.27010798]
curr_Stock_Price:  97.26019327511614
curr_Factors:  [97.26019328]
mat_Sqrt:  [[0.15]]
grads:  [0.02014521]
Stock Position:  0.020145212149629197
Bond Position:  [-19.2294352]


portfolio before change:  [-17.2672781]
curr_Stock_Price:  97.460327884889
curr_Factors:  [97.46032788]
mat_Sqrt:  [[0.15]]
grads:  [0.02253155]
Stock Position:  0.02253155215421118
Bond Position:  [-19.46321056]


portfolio before change:  [-17.24698272]
curr_Stock_Price:  98.41507207581114
curr_Factors:  [98.41507208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.24698272]
Stock Price:  99.16979087505989
PL:  [-17.24698272]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.36212571e-03]
 [-7.57794743e-03]
 [-3.56890900e-03]
 [ 7.72305709e-03]
 [ 1.98219580e-03]
 [ 1.91754262e-02]
 [ 1.88063391e-03]
 [-2.42456109e-02]
 [-2.57332027e-03]
 [ 2.68216259e-02]
 [-3.71212722e-02]
 [ 2.71018968e-02]
 [-1.29781110e-02]
 [ 2.43212895e-03]
 [-6.99348949e-03]
 [ 6.04076247e-03]
 [ 9.63128873e-03]
 [-8.94254022e-03]
 [ 6.62760424e-04]
 [ 1.50091768e-02]
 [ 1.18690331e-02]
 [-9.42156445e-03]
 [ 5.83907439e-03]
 [ 1.02975128e-02]
 [-6.73602453e-03]
 [ 1.02656153e-02]
 [-5.95532662e-03]
 [ 6.14167337e-03]
 [-1.35459268e-02]
 [-4.59811222e-04]
 [ 6.66144128e-04]
 [-1.01500698e-02]
 [-9.01134802e-03]
 [ 5.11514210e-03]
 [ 1.27194752e-02]
 [ 1.61727434e-02]
 [-3.47414420e-02]
 [ 9.04360990e-03]
 [-1.78201091e-02]
 [ 2.37321698e-02]
 [-5.76764929e-03]
 [ 5.20123926e-03]
 [ 2.30400295e-02]
 [ 4.36979095e-03]
 [-8.17718246e-03]
 [-3.52334517e-03]
 [ 2.25385340e-03]
 [-1.24980131e-02]
 [-1.30401160e-02]
 [-5.43476018e-03]
 [ 4.69780081e-02]
 [-1.00352094e-02]
 [ 2.65539831e-03]
 [ 5.04630722e-03]
 [ 4.43732786e-03]
 [-2.63734146e-04]
 [-7.54385874e-03]
 [-5.03110261e-04]
 [ 1.53917465e-03]
 [-1.20513955e-02]
 [-7.10418060e-03]
 [ 1.31142304e-02]
 [ 1.48308010e-02]
 [-1.90019080e-02]
 [-3.88649614e-03]
 [-1.52098599e-02]
 [-4.54421958e-03]
 [ 1.10805160e-02]
 [-1.13415177e-02]
 [ 1.04907516e-02]
 [-1.12972433e-03]
 [ 1.15898747e-02]
 [-2.24525035e-03]
 [ 6.39892637e-03]
 [-1.65717141e-02]
 [-7.54743115e-03]
 [ 1.16300396e-03]
 [ 3.18937554e-03]
 [-6.20738116e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.20750912]
curr_Stock_Price:  99.07345377671656
curr_Factors:  [99.07345378]
mat_Sqrt:  [[0.15]]
grads:  [0.04908084]
Stock Position:  0.04908083803369885
Bond Position:  [-17.07011726]


portfolio before change:  [-12.19705958]
curr_Stock_Price:  99.30809645594844
curr_Factors:  [99.30809646]
mat_Sqrt:  [[0.15]]
grads:  [-0.05051965]
Stock Position:  -0.05051964955059229
Bond Position:  [-7.18004935]


portfolio before change:  [-12.17821916]
curr_Stock_Price:  98.926281027826
curr_Factors:  [98.92628103]
mat_Sqrt:  [[0.15]]
grads:  [-0.02379273]
Stock Position:  -0.0237927266641361
Bond Position:  [-9.8244932]


portfolio before change:  [-12.18435335]
curr_Stock_Price:  99.15829032158938
curr_Factors:  [99.15829032]
mat_Sqrt:  [[0.15]]
grads:  [0.05148705]
Stock Position:  0.051487047271750984
Bond Position:  [-17.28972093]


portfolio before change:  [-12.18312466]
curr_Stock_Price:  99.20314302214669
curr_Factors:  [99.20314302]
mat_Sqrt:  [[0.15]]
grads:  [0.01321464]
Stock Position:  0.013214638639121324
Bond Position:  [-13.49405834]


portfolio before change:  [-12.18403292]
curr_Stock_Price:  99.19823527266038
curr_Factors:  [99.19823527]
mat_Sqrt:  [[0.15]]
grads:  [0.12783617]
Stock Position:  0.12783617438155367
Bond Position:  [-24.86515582]


portfolio before change:  [-12.24214666]
curr_Stock_Price:  98.75579697898246
curr_Factors:  [98.75579698]
mat_Sqrt:  [[0.15]]
grads:  [0.01253756]
Stock Position:  0.01253755942971278
Bond Position:  [-13.48030333]


portfolio before change:  [-12.25013526]
curr_Stock_Price:  98.1858246777293
curr_Factors:  [98.18582468]
mat_Sqrt:  [[0.15]]
grads:  [-0.16163741]
Stock Position:  -0.16163740590255324
Bond Position:  [3.62036673]


portfolio before change:  [-12.30228575]
curr_Stock_Price:  98.50986332070946
curr_Factors:  [98.50986332]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715547]
Stock Position:  -0.01715546848421621
Bond Position:  [-10.61230289]


portfolio before change:  [-12.29665304]
curr_Stock_Price:  98.14286660408895
curr_Factors:  [98.1428666]
mat_Sqrt:  [[0.15]]
grads:  [0.17881084]
Stock Position:  0.1788108393600885
Bond Position:  [-29.84566139]


portfolio before change:  [-12.35391698]
curr_Stock_Price:  97.8330501955458
curr_Factors:  [97.8330502]
mat_Sqrt:  [[0.15]]
grads:  [-0.24747515]
Stock Position:  -0.24747514779078075
Bond Position:  [11.85733157]


portfolio before change:  [-12.37983942]
curr_Stock_Price:  97.94079250939328
curr_Factors:  [97.94079251]
mat_Sqrt:  [[0.15]]
grads:  [0.18067931]
Stock Position:  0.18067931186003255
Bond Position:  [-30.07571441]


portfolio before change:  [-12.41189748]
curr_Stock_Price:  97.77376580697617
curr_Factors:  [97.77376581]
mat_Sqrt:  [[0.15]]
grads:  [-0.08652074]
Stock Position:  -0.08652073983117912
Bond Position:  [-3.95243893]


portfolio before change:  [-12.38394683]
curr_Stock_Price:  97.44785917331896
curr_Factors:  [97.44785917]
mat_Sqrt:  [[0.15]]
grads:  [0.01621419]
Stock Position:  0.016214192978984698
Bond Position:  [-13.96398523]


portfolio before change:  [-12.37366638]
curr_Stock_Price:  98.13572716946459
curr_Factors:  [98.13572717]
mat_Sqrt:  [[0.15]]
grads:  [-0.04662326]
Stock Position:  -0.04662326324316608
Bond Position:  [-7.79825854]


portfolio before change:  [-12.40197131]
curr_Stock_Price:  98.73237186328363
curr_Factors:  [98.73237186]
mat_Sqrt:  [[0.15]]
grads:  [0.04027175]
Stock Position:  0.04027174980169081
Bond Position:  [-16.37809669]


portfolio before change:  [-12.43430712]
curr_Stock_Price:  97.95485044103496
curr_Factors:  [97.95485044]
mat_Sqrt:  [[0.15]]
grads:  [0.06420859]
Stock Position:  0.06420859150465272
Bond Position:  [-18.7238501]


portfolio before change:  [-12.38090079]
curr_Stock_Price:  98.8048396933653
curr_Factors:  [98.80483969]
mat_Sqrt:  [[0.15]]
grads:  [-0.05961693]
Stock Position:  -0.059616934774937014
Bond Position:  [-6.49045911]


portfolio before change:  [-12.37661802]
curr_Stock_Price:  98.72619704468131
curr_Factors:  [98.72619704]
mat_Sqrt:  [[0.15]]
grads:  [0.0044184]
Stock Position:  0.004418402826724258
Bond Position:  [-12.81283013]


portfolio before change:  [-12.37509826]
curr_Stock_Price:  99.25140667206617
curr_Factors:  [99.25140667]
mat_Sqrt:  [[0.15]]
grads:  [0.10006118]
Stock Position:  0.10006117893804528
Bond Position:  [-22.30631102]


portfolio before change:  [-12.42531804]
curr_Stock_Price:  98.76344932884116
curr_Factors:  [98.76344933]
mat_Sqrt:  [[0.15]]
grads:  [0.07912689]
Stock Position:  0.07912688736715176
Bond Position:  [-20.24016237]


portfolio before change:  [-12.4811157]
curr_Stock_Price:  98.07427001871837
curr_Factors:  [98.07427002]
mat_Sqrt:  [[0.15]]
grads:  [-0.06281043]
Stock Position:  -0.06281042968631984
Bond Position:  [-6.32102866]


portfolio before change:  [-12.47149077]
curr_Stock_Price:  97.91474231216384
curr_Factors:  [97.91474231]
mat_Sqrt:  [[0.15]]
grads:  [0.03892716]
Stock Position:  0.038927162592430724
Bond Position:  [-16.28303387]


portfolio before change:  [-12.44441066]
curr_Stock_Price:  98.63654755161247
curr_Factors:  [98.63654755]
mat_Sqrt:  [[0.15]]
grads:  [0.06865009]
Stock Position:  0.06865008538688804
Bond Position:  [-19.21581808]


portfolio before change:  [-12.39229467]
curr_Stock_Price:  99.41319655082623
curr_Factors:  [99.41319655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490683]
Stock Position:  -0.04490683019392939
Bond Position:  [-7.92796313]


portfolio before change:  [-12.41381639]
curr_Stock_Price:  99.88141506381233
curr_Factors:  [99.88141506]
mat_Sqrt:  [[0.15]]
grads:  [0.06843744]
Stock Position:  0.06843743545366875
Bond Position:  [-19.24944429]


portfolio before change:  [-12.46806395]
curr_Stock_Price:  99.1063359207635
curr_Factors:  [99.10633592]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970218]
Stock Position:  -0.039702177443358334
Bond Position:  [-8.53332661]


portfolio before change:  [-12.47495817]
curr_Stock_Price:  99.26655060535509
curr_Factors:  [99.26655061]
mat_Sqrt:  [[0.15]]
grads:  [0.04094449]
Stock Position:  0.040944489131754795
Bond Position:  [-16.53937637]


portfolio before change:  [-12.49735061]
curr_Stock_Price:  98.74490050051853
curr_Factors:  [98.7449005]
mat_Sqrt:  [[0.15]]
grads:  [-0.09030618]
Stock Position:  -0.09030617894138308
Bond Position:  [-3.58007596]


portfolio before change:  [-12.48066594]
curr_Stock_Price:  98.55766594020893
curr_Factors:  [98.55766594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00306541]
Stock Position:  -0.0030654081472967433
Bond Position:  [-12.17854646]


portfolio before change:  [-12.47883256]
curr_Stock_Price:  97.71126721169362
curr_Factors:  [97.71126721]
mat_Sqrt:  [[0.15]]
grads:  [0.00444096]
Stock Position:  0.00444096085510119
Bond Position:  [-12.91276447]


portfolio before change:  [-12.47828735]
curr_Stock_Price:  98.01577001422557
curr_Factors:  [98.01577001]
mat_Sqrt:  [[0.15]]
grads:  [-0.06766713]
Stock Position:  -0.06766713229640577
Bond Position:  [-5.84584127]


portfolio before change:  [-12.47208215]
curr_Stock_Price:  97.91866857802376
curr_Factors:  [97.91866858]
mat_Sqrt:  [[0.15]]
grads:  [-0.06007565]
Stock Position:  -0.06007565344448889
Bond Position:  [-6.58955415]


portfolio before change:  [-12.47760232]
curr_Stock_Price:  98.00369985977204
curr_Factors:  [98.00369986]
mat_Sqrt:  [[0.15]]
grads:  [0.03410095]
Stock Position:  0.03410094736567618
Bond Position:  [-15.81962133]


portfolio before change:  [-12.46290011]
curr_Stock_Price:  98.4638327333961
curr_Factors:  [98.46383273]
mat_Sqrt:  [[0.15]]
grads:  [0.0847965]
Stock Position:  0.08479650132894309
Bond Position:  [-20.81228863]


portfolio before change:  [-12.52010714]
curr_Stock_Price:  97.8045339877787
curr_Factors:  [97.80453399]
mat_Sqrt:  [[0.15]]
grads:  [0.10781829]
Stock Position:  0.10781828958936687
Bond Position:  [-23.06522471]


portfolio before change:  [-12.45241946]
curr_Stock_Price:  98.44569888166392
curr_Factors:  [98.44569888]
mat_Sqrt:  [[0.15]]
grads:  [-0.23160961]
Stock Position:  -0.23160961320943924
Bond Position:  [10.34855078]


portfolio before change:  [-12.47198925]
curr_Stock_Price:  98.53298624047102
curr_Factors:  [98.53298624]
mat_Sqrt:  [[0.15]]
grads:  [0.06029073]
Stock Position:  0.06029073266793543
Bond Position:  [-18.41261518]


portfolio before change:  [-12.47700299]
curr_Stock_Price:  98.46891471637011
curr_Factors:  [98.46891472]
mat_Sqrt:  [[0.15]]
grads:  [-0.11880073]
Stock Position:  -0.11880072756823935
Bond Position:  [-0.77882428]


portfolio before change:  [-12.49338819]
curr_Stock_Price:  98.60642668763056
curr_Factors:  [98.60642669]
mat_Sqrt:  [[0.15]]
grads:  [0.15821447]
Stock Position:  0.15821446562436464
Bond Position:  [-28.0943513]


portfolio before change:  [-12.5393222]
curr_Stock_Price:  98.32719777964162
curr_Factors:  [98.32719778]
mat_Sqrt:  [[0.15]]
grads:  [-0.038451]
Stock Position:  -0.038450995252142094
Bond Position:  [-8.75854358]


portfolio before change:  [-12.54786794]
curr_Stock_Price:  98.53521110707779
curr_Factors:  [98.53521111]
mat_Sqrt:  [[0.15]]
grads:  [0.03467493]
Stock Position:  0.034674928417548885
Bond Position:  [-15.96456934]


portfolio before change:  [-12.54629616]
curr_Stock_Price:  98.60931669105005
curr_Factors:  [98.60931669]
mat_Sqrt:  [[0.15]]
grads:  [0.1536002]
Stock Position:  0.1536001964932381
Bond Position:  [-27.69270658]


portfolio before change:  [-12.49624532]
curr_Stock_Price:  98.94643659226207
curr_Factors:  [98.94643659]
mat_Sqrt:  [[0.15]]
grads:  [0.02913194]
Stock Position:  0.02913193965631634
Bond Position:  [-15.37874694]


portfolio before change:  [-12.48666415]
curr_Stock_Price:  99.30832031421117
curr_Factors:  [99.30832031]
mat_Sqrt:  [[0.15]]
grads:  [-0.05451455]
Stock Position:  -0.054514549725307476
Bond Position:  [-7.07291578]


portfolio before change:  [-12.5191404]
curr_Stock_Price:  99.89594652465779
curr_Factors:  [99.89594652]
mat_Sqrt:  [[0.15]]
grads:  [-0.02348897]
Stock Position:  -0.023488967820026255
Bond Position:  [-10.17268772]


portfolio before change:  [-12.51108591]
curr_Stock_Price:  99.52597296860812
curr_Factors:  [99.52597297]
mat_Sqrt:  [[0.15]]
grads:  [0.01502569]
Stock Position:  0.015025689300227433
Bond Position:  [-14.00653226]


portfolio before change:  [-12.51156124]
curr_Stock_Price:  99.55260156207116
curr_Factors:  [99.55260156]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332009]
Stock Position:  -0.0833200873423395
Bond Position:  [-4.21682978]


portfolio before change:  [-12.51510786]
curr_Stock_Price:  99.59200463115333
curr_Factors:  [99.59200463]
mat_Sqrt:  [[0.15]]
grads:  [-0.08693411]
Stock Position:  -0.08693410668890253
Bond Position:  [-3.85716591]


portfolio before change:  [-12.45822132]
curr_Stock_Price:  98.93486755134383
curr_Factors:  [98.93486755]
mat_Sqrt:  [[0.15]]
grads:  [-0.03623173]
Stock Position:  -0.03623173452836702
Bond Position:  [-8.87363946]


portfolio before change:  [-12.44178608]
curr_Stock_Price:  98.46594544313956
curr_Factors:  [98.46594544]
mat_Sqrt:  [[0.15]]
grads:  [0.31318672]
Stock Position:  0.31318672044019386
Bond Position:  [-43.28001261]


portfolio before change:  [-12.58956553]
curr_Stock_Price:  98.00272539140435
curr_Factors:  [98.00272539]
mat_Sqrt:  [[0.15]]
grads:  [-0.0669014]
Stock Position:  -0.06690139599540769
Bond Position:  [-6.03304639]


portfolio before change:  [-12.55644397]
curr_Stock_Price:  97.5020088339324
curr_Factors:  [97.50200883]
mat_Sqrt:  [[0.15]]
grads:  [0.01770266]
Stock Position:  0.017702655414472003
Bond Position:  [-14.28248844]


portfolio before change:  [-12.56285465]
curr_Stock_Price:  97.19030466627821
curr_Factors:  [97.19030467]
mat_Sqrt:  [[0.15]]
grads:  [0.03364205]
Stock Position:  0.033642048151704296
Bond Position:  [-15.83253556]


portfolio before change:  [-12.5699803]
curr_Stock_Price:  97.00791124722915
curr_Factors:  [97.00791125]
mat_Sqrt:  [[0.15]]
grads:  [0.02958219]
Stock Position:  0.029582185743591793
Bond Position:  [-15.43968635]


portfolio before change:  [-12.57376492]
curr_Stock_Price:  96.91259670131879
curr_Factors:  [96.9125967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175823]
Stock Position:  -0.0017582276370181039
Bond Position:  [-12.40337052]


portfolio before change:  [-12.57265826]
curr_Stock_Price:  95.84225657430899
curr_Factors:  [95.84225657]
mat_Sqrt:  [[0.15]]
grads:  [-0.05029239]
Stock Position:  -0.05029239162701766
Bond Position:  [-7.75252195]


portfolio before change:  [-12.60853449]
curr_Stock_Price:  96.54597517734672
curr_Factors:  [96.54597518]
mat_Sqrt:  [[0.15]]
grads:  [-0.00335407]
Stock Position:  -0.0033540684068813476
Bond Position:  [-12.28471269]


portfolio before change:  [-12.61112699]
curr_Stock_Price:  97.08999509036585
curr_Factors:  [97.08999509]
mat_Sqrt:  [[0.15]]
grads:  [0.01026116]
Stock Position:  0.01026116436105278
Bond Position:  [-13.60738339]


portfolio before change:  [-12.61376628]
curr_Stock_Price:  96.91566754952484
curr_Factors:  [96.91566755]
mat_Sqrt:  [[0.15]]
grads:  [-0.08034264]
Stock Position:  -0.08034263645376415
Bond Position:  [-4.82730604]


portfolio before change:  [-12.57487883]
curr_Stock_Price:  96.42789202019951
curr_Factors:  [96.42789202]
mat_Sqrt:  [[0.15]]
grads:  [-0.0473612]
Stock Position:  -0.047361204000755885
Bond Position:  [-8.00793776]


portfolio before change:  [-12.56628993]
curr_Stock_Price:  96.23597530794989
curr_Factors:  [96.23597531]
mat_Sqrt:  [[0.15]]
grads:  [0.0874282]
Stock Position:  0.08742820247300222
Bond Position:  [-20.98002827]


portfolio before change:  [-12.5782785]
curr_Stock_Price:  96.11384916167955
curr_Factors:  [96.11384916]
mat_Sqrt:  [[0.15]]
grads:  [0.09887201]
Stock Position:  0.0988720067870513
Bond Position:  [-22.08124764]


portfolio before change:  [-12.61834769]
curr_Stock_Price:  95.72254454636182
curr_Factors:  [95.72254455]
mat_Sqrt:  [[0.15]]
grads:  [-0.12667939]
Stock Position:  -0.12667938697115194
Bond Position:  [-0.49227443]


portfolio before change:  [-12.60313773]
curr_Stock_Price:  95.60223508927155
curr_Factors:  [95.60223509]
mat_Sqrt:  [[0.15]]
grads:  [-0.02590997]
Stock Position:  -0.025909974280695337
Bond Position:  [-10.12608628]


portfolio before change:  [-12.61674577]
curr_Stock_Price:  96.10301288836266
curr_Factors:  [96.10301289]
mat_Sqrt:  [[0.15]]
grads:  [-0.10139907]
Stock Position:  -0.10139906602544208
Bond Position:  [-2.87199002]


portfolio before change:  [-12.60019497]
curr_Stock_Price:  95.93801825683514
curr_Factors:  [95.93801826]
mat_Sqrt:  [[0.15]]
grads:  [-0.0302948]
Stock Position:  -0.030294797167208336
Bond Position:  [-9.69377217]


portfolio before change:  [-12.61564534]
curr_Stock_Price:  96.42801929998164
curr_Factors:  [96.4280193]
mat_Sqrt:  [[0.15]]
grads:  [0.07387011]
Stock Position:  0.07387010642204905
Bond Position:  [-19.73879338]


portfolio before change:  [-12.59492787]
curr_Stock_Price:  96.72517843854327
curr_Factors:  [96.72517844]
mat_Sqrt:  [[0.15]]
grads:  [-0.07561012]
Stock Position:  -0.07561011787878581
Bond Position:  [-5.28152573]


portfolio before change:  [-12.54973867]
curr_Stock_Price:  96.12315174777818
curr_Factors:  [96.12315175]
mat_Sqrt:  [[0.15]]
grads:  [0.06993834]
Stock Position:  0.06993834375860003
Bond Position:  [-19.2724327]


portfolio before change:  [-12.49686915]
curr_Stock_Price:  96.89631966682676
curr_Factors:  [96.89631967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0075315]
Stock Position:  -0.00753149553659215
Bond Position:  [-11.76709495]


portfolio before change:  [-12.50022071]
curr_Stock_Price:  97.24367378268003
curr_Factors:  [97.24367378]
mat_Sqrt:  [[0.15]]
grads:  [0.07726583]
Stock Position:  0.07726583100047728
Bond Position:  [-20.01383398]


portfolio before change:  [-12.43966058]
curr_Stock_Price:  98.0436526356472
curr_Factors:  [98.04365264]
mat_Sqrt:  [[0.15]]
grads:  [-0.01496834]
Stock Position:  -0.014968335651115699
Bond Position:  [-10.97211028]


portfolio before change:  [-12.43773316]
curr_Stock_Price:  97.86907051186799
curr_Factors:  [97.86907051]
mat_Sqrt:  [[0.15]]
grads:  [0.04265951]
Stock Position:  0.04265950911793981
Bond Position:  [-16.61277966]


portfolio before change:  [-12.41387874]
curr_Stock_Price:  98.4525922095606
curr_Factors:  [98.45259221]
mat_Sqrt:  [[0.15]]
grads:  [-0.11047809]
Stock Position:  -0.11047809427400741
Bond Position:  [-1.53702398]


portfolio before change:  [-12.38732721]
curr_Stock_Price:  98.21138964419187
curr_Factors:  [98.21138964]
mat_Sqrt:  [[0.15]]
grads:  [-0.05031621]
Stock Position:  -0.05031620767299682
Bond Position:  [-7.44570253]


portfolio before change:  [-12.37968515]
curr_Stock_Price:  98.05026008855762
curr_Factors:  [98.05026009]
mat_Sqrt:  [[0.15]]
grads:  [0.00775336]
Stock Position:  0.0077533597530552705
Bond Position:  [-13.13990409]


portfolio before change:  [-12.38409657]
curr_Stock_Price:  97.5872157587819
curr_Factors:  [97.58721576]
mat_Sqrt:  [[0.15]]
grads:  [0.0212625]
Stock Position:  0.02126250358647201
Bond Position:  [-14.45904509]


portfolio before change:  [-12.4024151]
curr_Stock_Price:  96.768177130213
curr_Factors:  [96.76817713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.4024151]
Stock Price:  96.01436893576172
PL:  [-12.4024151]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.34430930e-03]
 [-1.19699702e-02]
 [-4.40743866e-03]
 [ 7.78399798e-03]
 [ 2.50620329e-04]
 [ 1.64562547e-02]
 [ 2.13304525e-03]
 [-2.08089639e-02]
 [ 1.95642663e-04]
 [ 2.76705902e-02]
 [-3.18857662e-02]
 [ 2.68540162e-02]
 [-1.35185911e-02]
 [ 3.05207862e-03]
 [-6.97761721e-03]
 [ 9.01607851e-03]
 [ 8.36678962e-03]
 [-8.90216915e-03]
 [-1.14714713e-04]
 [ 1.31761462e-02]
 [ 1.20270638e-02]
 [-9.20028513e-03]
 [ 6.90302295e-03]
 [ 1.63942054e-02]
 [-3.27456429e-03]
 [ 7.87998253e-03]
 [-6.69481595e-03]
 [ 5.98642333e-03]
 [ 1.09130287e-02]
 [-2.59033683e-03]
 [ 7.77856133e-03]
 [-1.17611353e-02]
 [ 9.32121162e-03]
 [ 8.06794731e-03]
 [ 1.11594729e-02]
 [ 8.49517259e-03]
 [-3.38900569e-02]
 [ 9.65509482e-03]
 [-1.79981484e-03]
 [ 2.04835619e-02]
 [-5.80358053e-03]
 [-1.76845621e-02]
 [ 2.27718584e-02]
 [ 2.73428126e-03]
 [-7.78405766e-03]
 [-4.94351342e-03]
 [ 4.86825119e-03]
 [-1.20143676e-02]
 [-1.23442740e-02]
 [-6.21824426e-03]
 [ 4.75420873e-02]
 [-8.77758971e-03]
 [ 2.69807012e-03]
 [ 5.42608911e-03]
 [ 5.68868621e-03]
 [-3.43929342e-03]
 [ 6.94990455e-03]
 [-1.21607145e-04]
 [ 1.53467896e-03]
 [ 2.94086277e-03]
 [ 1.18586754e-03]
 [-7.21312014e-03]
 [ 3.67566411e-03]
 [-1.80838507e-02]
 [-1.19345019e-02]
 [-5.22609507e-03]
 [-4.79678784e-03]
 [ 2.02854493e-02]
 [-8.85228898e-03]
 [ 6.05248728e-03]
 [-9.18650535e-03]
 [ 1.07717170e-02]
 [-4.04030927e-03]
 [ 7.10167907e-03]
 [-1.24332924e-02]
 [-1.00948349e-02]
 [ 2.62190667e-03]
 [ 2.61331921e-03]
 [-8.46291373e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.92496758]
curr_Stock_Price:  99.92739253460392
curr_Factors:  [99.92739253]
mat_Sqrt:  [[0.15]]
grads:  [0.01562873]
Stock Position:  0.015628728659713306
Bond Position:  [-0.63677052]


portfolio before change:  [0.91281834]
curr_Stock_Price:  99.15257305841614
curr_Factors:  [99.15257306]
mat_Sqrt:  [[0.15]]
grads:  [-0.0797998]
Stock Position:  -0.07979980156370095
Bond Position:  [8.82517399]


portfolio before change:  [0.942676]
curr_Stock_Price:  98.78532811674829
curr_Factors:  [98.78532812]
mat_Sqrt:  [[0.15]]
grads:  [-0.02938292]
Stock Position:  -0.029382924424877447
Bond Position:  [3.84527783]


portfolio before change:  [0.9312585]
curr_Stock_Price:  99.18208362560983
curr_Factors:  [99.18208363]
mat_Sqrt:  [[0.15]]
grads:  [0.05189332]
Stock Position:  0.051893319861386865
Bond Position:  [-4.21562909]


portfolio before change:  [0.91998508]
curr_Stock_Price:  98.96991880136318
curr_Factors:  [98.9699188]
mat_Sqrt:  [[0.15]]
grads:  [0.0016708]
Stock Position:  0.001670802192505841
Bond Position:  [0.75462592]


portfolio before change:  [0.91969027]
curr_Stock_Price:  98.76524174875219
curr_Factors:  [98.76524175]
mat_Sqrt:  [[0.15]]
grads:  [0.10970836]
Stock Position:  0.1097083643900568
Bond Position:  [-9.91568286]


portfolio before change:  [0.90304356]
curr_Stock_Price:  98.61915474443026
curr_Factors:  [98.61915474]
mat_Sqrt:  [[0.15]]
grads:  [0.0142203]
Stock Position:  0.014220301682974175
Bond Position:  [-0.49935058]


portfolio before change:  [0.90346108]
curr_Stock_Price:  98.65071045685427
curr_Factors:  [98.65071046]
mat_Sqrt:  [[0.15]]
grads:  [-0.13872643]
Stock Position:  -0.13872642630555534
Bond Position:  [14.58892159]


portfolio before change:  [0.88766751]
curr_Stock_Price:  98.77113020977592
curr_Factors:  [98.77113021]
mat_Sqrt:  [[0.15]]
grads:  [0.00130428]
Stock Position:  0.0013042844202464563
Bond Position:  [0.75884187]


portfolio before change:  [0.88676336]
curr_Stock_Price:  98.04154755784158
curr_Factors:  [98.04154756]
mat_Sqrt:  [[0.15]]
grads:  [0.1844706]
Stock Position:  0.18447060114843744
Bond Position:  [-17.19901986]


portfolio before change:  [0.86606437]
curr_Stock_Price:  97.9351673809651
curr_Factors:  [97.93516738]
mat_Sqrt:  [[0.15]]
grads:  [-0.21257177]
Stock Position:  -0.21257177479929543
Bond Position:  [21.68431672]


portfolio before change:  [0.85584811]
curr_Stock_Price:  97.98960346914636
curr_Factors:  [97.98960347]
mat_Sqrt:  [[0.15]]
grads:  [0.17902677]
Stock Position:  0.1790267749960417
Bond Position:  [-16.68691459]


portfolio before change:  [0.83560338]
curr_Stock_Price:  97.88234708083438
curr_Factors:  [97.88234708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09012394]
Stock Position:  -0.09012394094490543
Bond Position:  [9.65714624]


portfolio before change:  [0.86146896]
curr_Stock_Price:  97.60204431348079
curr_Factors:  [97.60204431]
mat_Sqrt:  [[0.15]]
grads:  [0.02034719]
Stock Position:  0.02034719080507373
Bond Position:  [-1.12445846]


portfolio before change:  [0.87848707]
curr_Stock_Price:  98.44188500352041
curr_Factors:  [98.441885]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651745]
Stock Position:  -0.046517448094843705
Bond Position:  [5.45775235]


portfolio before change:  [0.89805311]
curr_Stock_Price:  98.02860114808759
curr_Factors:  [98.02860115]
mat_Sqrt:  [[0.15]]
grads:  [0.06010719]
Stock Position:  0.06010719009413799
Bond Position:  [-4.99417066]


portfolio before change:  [0.91412108]
curr_Stock_Price:  98.30111622517609
curr_Factors:  [98.30111623]
mat_Sqrt:  [[0.15]]
grads:  [0.0557786]
Stock Position:  0.055778597442596334
Bond Position:  [-4.56897731]


portfolio before change:  [0.93814956]
curr_Stock_Price:  98.73701923785637
curr_Factors:  [98.73701924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05934779]
Stock Position:  -0.05934779430533883
Bond Position:  [6.79797387]


portfolio before change:  [0.91671301]
curr_Stock_Price:  99.10538073545149
curr_Factors:  [99.10538074]
mat_Sqrt:  [[0.15]]
grads:  [-0.00076476]
Stock Position:  -0.0007647647533935594
Bond Position:  [0.99250531]


portfolio before change:  [0.91690005]
curr_Stock_Price:  98.94191779797795
curr_Factors:  [98.9419178]
mat_Sqrt:  [[0.15]]
grads:  [0.08784097]
Stock Position:  0.08784097472742876
Bond Position:  [-7.77425445]


portfolio before change:  [0.88015649]
curr_Stock_Price:  98.52915310993747
curr_Factors:  [98.52915311]
mat_Sqrt:  [[0.15]]
grads:  [0.08018043]
Stock Position:  0.08018042523829093
Bond Position:  [-7.0199529]


portfolio before change:  [0.86323049]
curr_Stock_Price:  98.32352637262811
curr_Factors:  [98.32352637]
mat_Sqrt:  [[0.15]]
grads:  [-0.06133523]
Stock Position:  -0.06133523420276978
Bond Position:  [6.89392701]


portfolio before change:  [0.85912347]
curr_Stock_Price:  98.397511758766
curr_Factors:  [98.39751176]
mat_Sqrt:  [[0.15]]
grads:  [0.04602015]
Stock Position:  0.046020152971946414
Bond Position:  [-3.66914508]


portfolio before change:  [0.88059517]
curr_Stock_Price:  98.86906671661262
curr_Factors:  [98.86906672]
mat_Sqrt:  [[0.15]]
grads:  [0.1092947]
Stock Position:  0.1092947025808629
Bond Position:  [-9.92527007]


portfolio before change:  [0.99650737]
curr_Stock_Price:  99.93528997934676
curr_Factors:  [99.93528998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02183043]
Stock Position:  -0.021830428569786973
Bond Position:  [3.17813758]


portfolio before change:  [1.00200997]
curr_Stock_Price:  99.6923284756797
curr_Factors:  [99.69232848]
mat_Sqrt:  [[0.15]]
grads:  [0.05253322]
Stock Position:  0.05253321687913979
Bond Position:  [-4.23514874]


portfolio before change:  [1.04307011]
curr_Stock_Price:  100.478970738922
curr_Factors:  [100.47897074]
mat_Sqrt:  [[0.15]]
grads:  [-0.04463211]
Stock Position:  -0.04463210630659356
Bond Position:  [5.52765822]


portfolio before change:  [1.04730197]
curr_Stock_Price:  100.39189509889431
curr_Factors:  [100.3918951]
mat_Sqrt:  [[0.15]]
grads:  [0.03990949]
Stock Position:  0.039909488899578856
Bond Position:  [-2.95928725]


portfolio before change:  [1.07033432]
curr_Stock_Price:  100.97364431011395
curr_Factors:  [100.97364431]
mat_Sqrt:  [[0.15]]
grads:  [0.07275352]
Stock Position:  0.07275352458090845
Bond Position:  [-6.27585419]


portfolio before change:  [1.07755566]
curr_Stock_Price:  101.07829342237991
curr_Factors:  [101.07829342]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726891]
Stock Position:  -0.017268912212254173
Bond Position:  [2.82306784]


portfolio before change:  [1.08129601]
curr_Stock_Price:  100.87191652113964
curr_Factors:  [100.87191652]
mat_Sqrt:  [[0.15]]
grads:  [0.05185708]
Stock Position:  0.05185707554508742
Bond Position:  [-4.14962658]


portfolio before change:  [1.11166915]
curr_Stock_Price:  101.46262664483834
curr_Factors:  [101.46262664]
mat_Sqrt:  [[0.15]]
grads:  [-0.07840757]
Stock Position:  -0.0784075684628402
Bond Position:  [9.067107]


portfolio before change:  [1.12393895]
curr_Stock_Price:  101.31336698771821
curr_Factors:  [101.31336699]
mat_Sqrt:  [[0.15]]
grads:  [0.06214141]
Stock Position:  0.06214141081925911
Bond Position:  [-5.17181661]


portfolio before change:  [1.13765162]
curr_Stock_Price:  101.53923749710842
curr_Factors:  [101.5392375]
mat_Sqrt:  [[0.15]]
grads:  [0.05378632]
Stock Position:  0.05378631540604106
Bond Position:  [-4.32376984]


portfolio before change:  [1.14190016]
curr_Stock_Price:  101.62325125931811
curr_Factors:  [101.62325126]
mat_Sqrt:  [[0.15]]
grads:  [0.07439649]
Stock Position:  0.07439648631667117
Bond Position:  [-6.41851266]


portfolio before change:  [1.16013952]
curr_Stock_Price:  101.87380779711229
curr_Factors:  [101.8738078]
mat_Sqrt:  [[0.15]]
grads:  [0.05663448]
Stock Position:  0.05663448390006917
Bond Position:  [-4.60943101]


portfolio before change:  [1.13166168]
curr_Stock_Price:  101.37605909304109
curr_Factors:  [101.37605909]
mat_Sqrt:  [[0.15]]
grads:  [-0.22593371]
Stock Position:  -0.2259337123714953
Bond Position:  [24.03593106]


portfolio before change:  [1.15448807]
curr_Stock_Price:  101.28167700973485
curr_Factors:  [101.28167701]
mat_Sqrt:  [[0.15]]
grads:  [0.0643673]
Stock Position:  0.06436729878609201
Bond Position:  [-5.3647399]


portfolio before change:  [1.1206563]
curr_Stock_Price:  100.76128141225833
curr_Factors:  [100.76128141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199877]
Stock Position:  -0.011998765624978472
Bond Position:  [2.3296673]


portfolio before change:  [1.12199484]
curr_Stock_Price:  100.6618600689928
curr_Factors:  [100.66186007]
mat_Sqrt:  [[0.15]]
grads:  [0.13655708]
Stock Position:  0.13655707958792226
Bond Position:  [-12.62409479]


portfolio before change:  [1.16747614]
curr_Stock_Price:  101.00069517644853
curr_Factors:  [101.00069518]
mat_Sqrt:  [[0.15]]
grads:  [-0.03869054]
Stock Position:  -0.0386905368969618
Bond Position:  [5.07524727]


portfolio before change:  [1.1597748]
curr_Stock_Price:  101.20794370930858
curr_Factors:  [101.20794371]
mat_Sqrt:  [[0.15]]
grads:  [-0.11789708]
Stock Position:  -0.11789708076575929
Bond Position:  [13.09189591]


portfolio before change:  [1.18262523]
curr_Stock_Price:  101.02106752068829
curr_Factors:  [101.02106752]
mat_Sqrt:  [[0.15]]
grads:  [0.15181239]
Stock Position:  0.15181238902683164
Bond Position:  [-14.15362438]


portfolio before change:  [1.16819142]
curr_Stock_Price:  100.931818026477
curr_Factors:  [100.93181803]
mat_Sqrt:  [[0.15]]
grads:  [0.01822854]
Stock Position:  0.018228541732745494
Bond Position:  [-0.67164844]


portfolio before change:  [1.1596839]
curr_Stock_Price:  100.46740691158918
curr_Factors:  [100.46740691]
mat_Sqrt:  [[0.15]]
grads:  [-0.05189372]
Stock Position:  -0.05189371770024121
Bond Position:  [6.37331115]


portfolio before change:  [1.21104539]
curr_Stock_Price:  99.48533913737475
curr_Factors:  [99.48533914]
mat_Sqrt:  [[0.15]]
grads:  [-0.03295676]
Stock Position:  -0.03295675612781171
Bond Position:  [4.48975945]


portfolio before change:  [1.1991876]
curr_Stock_Price:  99.85365238898459
curr_Factors:  [99.85365239]
mat_Sqrt:  [[0.15]]
grads:  [0.03245501]
Stock Position:  0.03245500796333459
Bond Position:  [-2.04156348]


portfolio before change:  [1.20260004]
curr_Stock_Price:  99.96272765532788
curr_Factors:  [99.96272766]
mat_Sqrt:  [[0.15]]
grads:  [-0.08009578]
Stock Position:  -0.08009578423667228
Bond Position:  [9.20919311]


portfolio before change:  [1.24756871]
curr_Stock_Price:  99.40847784878957
curr_Factors:  [99.40847785]
mat_Sqrt:  [[0.15]]
grads:  [-0.08229516]
Stock Position:  -0.08229516020917603
Bond Position:  [9.42840532]


portfolio before change:  [1.2271228]
curr_Stock_Price:  99.66408460921448
curr_Factors:  [99.66408461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04145496]
Stock Position:  -0.04145496170642744
Bond Position:  [5.35869361]


portfolio before change:  [1.24602077]
curr_Stock_Price:  99.21629642795098
curr_Factors:  [99.21629643]
mat_Sqrt:  [[0.15]]
grads:  [0.31694725]
Stock Position:  0.31694724853669687
Bond Position:  [-30.20031139]


portfolio before change:  [1.34035853]
curr_Stock_Price:  99.51989692175026
curr_Factors:  [99.51989692]
mat_Sqrt:  [[0.15]]
grads:  [-0.05851726]
Stock Position:  -0.05851726475726217
Bond Position:  [7.16399069]


portfolio before change:  [1.32084896]
curr_Stock_Price:  99.86094725889743
curr_Factors:  [99.86094726]
mat_Sqrt:  [[0.15]]
grads:  [0.01798713]
Stock Position:  0.017987134145183114
Bond Position:  [-0.47536329]


portfolio before change:  [1.31908006]
curr_Stock_Price:  99.7642562185767
curr_Factors:  [99.76425622]
mat_Sqrt:  [[0.15]]
grads:  [0.03617393]
Stock Position:  0.03617392738929778
Bond Position:  [-2.2897849]


portfolio before change:  [1.32467394]
curr_Stock_Price:  99.92285113412929
curr_Factors:  [99.92285113]
mat_Sqrt:  [[0.15]]
grads:  [0.03792457]
Stock Position:  0.03792457475318787
Bond Position:  [-2.46485769]


portfolio before change:  [1.30146491]
curr_Stock_Price:  99.31493466269018
curr_Factors:  [99.31493466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02292862]
Stock Position:  -0.022928622815147015
Bond Position:  [3.57861959]


portfolio before change:  [1.30890705]
curr_Stock_Price:  99.00011127882799
curr_Factors:  [99.00011128]
mat_Sqrt:  [[0.15]]
grads:  [0.0463327]
Stock Position:  0.04633269703310415
Bond Position:  [-3.27803511]


portfolio before change:  [1.3158331]
curr_Stock_Price:  99.1540184262487
curr_Factors:  [99.15401843]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081071]
Stock Position:  -0.0008107143007031904
Bond Position:  [1.39621868]


portfolio before change:  [1.31668328]
curr_Stock_Price:  98.21297457515783
curr_Factors:  [98.21297458]
mat_Sqrt:  [[0.15]]
grads:  [0.01023119]
Stock Position:  0.01023119304769848
Bond Position:  [0.31184738]


portfolio before change:  [1.32148596]
curr_Stock_Price:  98.68048524270844
curr_Factors:  [98.68048524]
mat_Sqrt:  [[0.15]]
grads:  [0.01960575]
Stock Position:  0.019605751797347415
Bond Position:  [-0.61321914]


portfolio before change:  [1.33000612]
curr_Stock_Price:  99.1170144985723
curr_Factors:  [99.1170145]
mat_Sqrt:  [[0.15]]
grads:  [0.00790578]
Stock Position:  0.00790578362229662
Bond Position:  [0.54640845]


portfolio before change:  [1.33173309]
curr_Stock_Price:  99.331138546475
curr_Factors:  [99.33113855]
mat_Sqrt:  [[0.15]]
grads:  [-0.04808747]
Stock Position:  -0.04808746756792608
Bond Position:  [6.108316]


portfolio before change:  [1.36624019]
curr_Stock_Price:  98.62148754136001
curr_Factors:  [98.62148754]
mat_Sqrt:  [[0.15]]
grads:  [0.02450443]
Stock Position:  0.024504427399974753
Bond Position:  [-1.05042289]


portfolio before change:  [1.34928641]
curr_Stock_Price:  97.93230076041044
curr_Factors:  [97.93230076]
mat_Sqrt:  [[0.15]]
grads:  [-0.120559]
Stock Position:  -0.12055900466033727
Bond Position:  [13.15590712]


portfolio before change:  [1.3001457]
curr_Stock_Price:  98.3467284075201
curr_Factors:  [98.34672841]
mat_Sqrt:  [[0.15]]
grads:  [-0.07956335]
Stock Position:  -0.07956334620531572
Bond Position:  [9.1249405]


portfolio before change:  [1.32723425]
curr_Stock_Price:  98.0134314105892
curr_Factors:  [98.01343141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03484063]
Stock Position:  -0.0348406338118266
Bond Position:  [4.74208432]


portfolio before change:  [1.3300624]
curr_Stock_Price:  97.94076441863027
curr_Factors:  [97.94076442]
mat_Sqrt:  [[0.15]]
grads:  [-0.03197859]
Stock Position:  -0.031978585579219315
Bond Position:  [4.46206952]


portfolio before change:  [1.31371405]
curr_Stock_Price:  98.46071364846303
curr_Factors:  [98.46071365]
mat_Sqrt:  [[0.15]]
grads:  [0.13523633]
Stock Position:  0.13523632890465995
Bond Position:  [-12.00175141]


portfolio before change:  [1.44858305]
curr_Stock_Price:  99.46354432121122
curr_Factors:  [99.46354432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05901526]
Stock Position:  -0.05901525985780993
Bond Position:  [7.31844997]


portfolio before change:  [1.45508007]
curr_Stock_Price:  99.3612046644409
curr_Factors:  [99.36120466]
mat_Sqrt:  [[0.15]]
grads:  [0.04034992]
Stock Position:  0.040349915192223154
Bond Position:  [-2.55413611]


portfolio before change:  [1.46254638]
curr_Stock_Price:  99.55019995407582
curr_Factors:  [99.55019995]
mat_Sqrt:  [[0.15]]
grads:  [-0.06124337]
Stock Position:  -0.06124336899742236
Bond Position:  [7.55933601]


portfolio before change:  [1.48885157]
curr_Stock_Price:  99.12839557372477
curr_Factors:  [99.12839557]
mat_Sqrt:  [[0.15]]
grads:  [0.07181145]
Stock Position:  0.07181144655791179
Bond Position:  [-5.62970191]


portfolio before change:  [1.45946939]
curr_Stock_Price:  98.72413805354269
curr_Factors:  [98.72413805]
mat_Sqrt:  [[0.15]]
grads:  [-0.0269354]
Stock Position:  -0.02693539514682002
Bond Position:  [4.11864306]


portfolio before change:  [1.4746612]
curr_Stock_Price:  98.16968597151444
curr_Factors:  [98.16968597]
mat_Sqrt:  [[0.15]]
grads:  [0.04734453]
Stock Position:  0.047344527120162794
Bond Position:  [-3.17313616]


portfolio before change:  [1.45680578]
curr_Stock_Price:  97.79673700914404
curr_Factors:  [97.79673701]
mat_Sqrt:  [[0.15]]
grads:  [-0.08288862]
Stock Position:  -0.08288861589052478
Bond Position:  [9.56304195]


portfolio before change:  [1.49213191]
curr_Stock_Price:  97.37776003312199
curr_Factors:  [97.37776003]
mat_Sqrt:  [[0.15]]
grads:  [-0.0672989]
Stock Position:  -0.06729889931528579
Bond Position:  [8.04554798]


portfolio before change:  [1.48663687]
curr_Stock_Price:  97.46688341369395
curr_Factors:  [97.46688341]
mat_Sqrt:  [[0.15]]
grads:  [0.01747938]
Stock Position:  0.017479377778749396
Bond Position:  [-0.21702361]


portfolio before change:  [1.49376669]
curr_Stock_Price:  97.87555834126873
curr_Factors:  [97.87555834]
mat_Sqrt:  [[0.15]]
grads:  [0.01742213]
Stock Position:  0.017422128042851842
Bond Position:  [-0.21143382]


portfolio before change:  [1.48810517]
curr_Stock_Price:  97.55135586633534
curr_Factors:  [97.55135587]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.48810517]
Stock Price:  96.82625367387948
PL:  [1.48810517]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.97617845e-04]
 [ 6.30423835e-04]
 [-2.75479845e-03]
 [ 8.02546649e-03]
 [ 3.83639176e-03]
 [ 2.35884662e-02]
 [ 1.20452442e-03]
 [-1.99731561e-02]
 [ 4.29612709e-03]
 [ 2.19342409e-02]
 [ 1.51907128e-02]
 [ 2.39706127e-02]
 [-1.45208604e-02]
 [ 3.26064900e-03]
 [-7.02926243e-03]
 [ 1.04105849e-02]
 [ 1.08212482e-02]
 [-8.81305704e-03]
 [ 2.13653823e-03]
 [ 8.66944204e-03]
 [ 1.29987805e-02]
 [-1.02268346e-02]
 [ 3.99936001e-03]
 [-4.31051892e-02]
 [-1.06386043e-02]
 [-5.60883765e-03]
 [-1.63749065e-03]
 [ 9.61461503e-03]
 [-4.22949358e-02]
 [ 2.57148645e-03]
 [-1.38507629e-03]
 [-1.04416334e-02]
 [-7.83247528e-03]
 [ 5.28080618e-03]
 [ 1.35553860e-02]
 [ 1.29765736e-02]
 [-3.39429832e-02]
 [ 8.03436499e-03]
 [-3.39728986e-02]
 [ 8.56184939e-03]
 [-1.31267104e-02]
 [ 4.24457541e-02]
 [ 2.31977679e-02]
 [ 3.97332819e-03]
 [ 5.01127791e-03]
 [ 9.30148449e-03]
 [ 2.83198488e-04]
 [-1.19407798e-02]
 [-8.59045404e-03]
 [-3.63964473e-03]
 [ 4.33116851e-02]
 [-8.24931637e-03]
 [ 1.94511478e-03]
 [ 4.72613434e-03]
 [ 3.78811997e-03]
 [ 4.71304525e-03]
 [-1.82230995e-02]
 [ 3.30105238e-05]
 [ 1.58162474e-03]
 [-6.62447969e-02]
 [-1.27283280e-02]
 [ 1.79413425e-02]
 [ 1.65233655e-02]
 [-1.92346432e-02]
 [-4.58077705e-03]
 [-1.62576378e-02]
 [-4.59051279e-03]
 [ 8.48584020e-03]
 [-1.36488473e-02]
 [ 1.16093082e-02]
 [ 4.01007959e-03]
 [ 1.22979858e-02]
 [ 3.67518787e-03]
 [-5.90006885e-04]
 [ 8.27150914e-03]
 [-1.97320194e-02]
 [ 4.84521413e-03]
 [ 7.84819635e-03]
 [ 2.53589482e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.55580028]
curr_Stock_Price:  100.74871191187206
curr_Factors:  [100.74871191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198412]
Stock Position:  -0.001984118965155186
Bond Position:  [13.75569771]


portfolio before change:  [13.55633557]
curr_Stock_Price:  100.91224898740829
curr_Factors:  [100.91224899]
mat_Sqrt:  [[0.15]]
grads:  [0.00420283]
Stock Position:  0.004202825568190719
Bond Position:  [13.13221899]


portfolio before change:  [13.55583677]
curr_Stock_Price:  100.59827403265155
curr_Factors:  [100.59827403]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836532]
Stock Position:  -0.018365323026046876
Bond Position:  [15.40335657]


portfolio before change:  [13.58111038]
curr_Stock_Price:  99.27453641860278
curr_Factors:  [99.27453642]
mat_Sqrt:  [[0.15]]
grads:  [0.05350311]
Stock Position:  0.05350310992409446
Bond Position:  [8.26961395]


portfolio before change:  [13.62816978]
curr_Stock_Price:  100.14443974153082
curr_Factors:  [100.14443974]
mat_Sqrt:  [[0.15]]
grads:  [0.02557595]
Stock Position:  0.025575945083093698
Bond Position:  [11.06688109]


portfolio before change:  [13.62263415]
curr_Stock_Price:  99.900955848857
curr_Factors:  [99.90095585]
mat_Sqrt:  [[0.15]]
grads:  [0.15725644]
Stock Position:  0.15725644138099512
Bond Position:  [-2.08743465]


portfolio before change:  [13.51088088]
curr_Stock_Price:  99.19114199890245
curr_Factors:  [99.191142]
mat_Sqrt:  [[0.15]]
grads:  [0.00803016]
Stock Position:  0.008030162774275627
Bond Position:  [12.71435987]


portfolio before change:  [13.50824655]
curr_Stock_Price:  98.7641256539687
curr_Factors:  [98.76412565]
mat_Sqrt:  [[0.15]]
grads:  [-0.13315437]
Stock Position:  -0.13315437427734633
Bond Position:  [26.6591219]


portfolio before change:  [13.47149565]
curr_Stock_Price:  99.05264148735378
curr_Factors:  [99.05264149]
mat_Sqrt:  [[0.15]]
grads:  [0.02864085]
Stock Position:  0.02864084727578201
Bond Position:  [10.63454407]


portfolio before change:  [13.46280928]
curr_Stock_Price:  98.72614814242213
curr_Factors:  [98.72614814]
mat_Sqrt:  [[0.15]]
grads:  [0.14622827]
Stock Position:  0.14622827285580986
Bond Position:  [-0.97374485]


portfolio before change:  [13.4992438]
curr_Stock_Price:  98.9757262507194
curr_Factors:  [98.97572625]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [3.47583161]


portfolio before change:  [13.43937692]
curr_Stock_Price:  98.38242833978234
curr_Factors:  [98.38242834]
mat_Sqrt:  [[0.15]]
grads:  [0.15980408]
Stock Position:  0.15980408485877198
Bond Position:  [-2.28253701]


portfolio before change:  [13.44584896]
curr_Stock_Price:  98.42382090801256
curr_Factors:  [98.42382091]
mat_Sqrt:  [[0.15]]
grads:  [-0.09680574]
Stock Position:  -0.096805735754963
Bond Position:  [22.97383936]


portfolio before change:  [13.52148713]
curr_Stock_Price:  97.65731407810682
curr_Factors:  [97.65731408]
mat_Sqrt:  [[0.15]]
grads:  [0.02173766]
Stock Position:  0.02173766000803579
Bond Position:  [11.39864564]


portfolio before change:  [13.51759975]
curr_Stock_Price:  97.44570826153489
curr_Factors:  [97.44570826]
mat_Sqrt:  [[0.15]]
grads:  [-0.04686175]
Stock Position:  -0.04686174955632218
Bond Position:  [18.08407613]


portfolio before change:  [13.52147932]
curr_Stock_Price:  97.38704038363481
curr_Factors:  [97.38704038]
mat_Sqrt:  [[0.15]]
grads:  [0.0694039]
Stock Position:  0.0694038994934721
Bond Position:  [6.76243896]


portfolio before change:  [13.53869467]
curr_Stock_Price:  97.62899632508707
curr_Factors:  [97.62899633]
mat_Sqrt:  [[0.15]]
grads:  [0.07214165]
Stock Position:  0.07214165445325041
Bond Position:  [6.49557735]


portfolio before change:  [13.60823552]
curr_Stock_Price:  98.5873173971928
curr_Factors:  [98.5873174]
mat_Sqrt:  [[0.15]]
grads:  [-0.05875371]
Stock Position:  -0.05875371360514879
Bond Position:  [19.40060654]


portfolio before change:  [13.65719031]
curr_Stock_Price:  97.7747354174102
curr_Factors:  [97.77473542]
mat_Sqrt:  [[0.15]]
grads:  [0.01424359]
Stock Position:  0.014243588193740022
Bond Position:  [12.26452724]


portfolio before change:  [13.6521387]
curr_Stock_Price:  97.36625917373625
curr_Factors:  [97.36625917]
mat_Sqrt:  [[0.15]]
grads:  [0.05779628]
Stock Position:  0.05779628029659393
Bond Position:  [8.02473109]


portfolio before change:  [13.60709963]
curr_Stock_Price:  96.5783082444651
curr_Factors:  [96.57830824]
mat_Sqrt:  [[0.15]]
grads:  [0.08665854]
Stock Position:  0.0866585364864561
Bond Position:  [5.23776478]


portfolio before change:  [13.6539876]
curr_Stock_Price:  97.11559638298739
curr_Factors:  [97.11559638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0681789]
Stock Position:  -0.06817889737759283
Bond Position:  [20.27522188]


portfolio before change:  [13.65270317]
curr_Stock_Price:  97.15302257936402
curr_Factors:  [97.15302258]
mat_Sqrt:  [[0.15]]
grads:  [0.0266624]
Stock Position:  0.026662400047733677
Bond Position:  [11.06237041]


portfolio before change:  [13.64286378]
curr_Stock_Price:  96.7580541884354
curr_Factors:  [96.75805419]
mat_Sqrt:  [[0.15]]
grads:  [-0.28736793]
Stock Position:  -0.2873679278047107
Bond Position:  [41.44802531]


portfolio before change:  [13.54265188]
curr_Stock_Price:  97.11579238674459
curr_Factors:  [97.11579239]
mat_Sqrt:  [[0.15]]
grads:  [-0.07092403]
Stock Position:  -0.07092402833757865
Bond Position:  [20.43049509]


portfolio before change:  [13.5331896]
curr_Stock_Price:  97.26721107152834
curr_Factors:  [97.26721107]
mat_Sqrt:  [[0.15]]
grads:  [-0.03739225]
Stock Position:  -0.03739225097036915
Bond Position:  [17.17022957]


portfolio before change:  [13.53430701]
curr_Stock_Price:  97.26602804941486
curr_Factors:  [97.26602805]
mat_Sqrt:  [[0.15]]
grads:  [-0.0109166]
Stock Position:  -0.010916604307980747
Bond Position:  [14.59612175]


portfolio before change:  [13.53613782]
curr_Stock_Price:  97.18188782696117
curr_Factors:  [97.18188783]
mat_Sqrt:  [[0.15]]
grads:  [0.06409743]
Stock Position:  0.06409743352261804
Bond Position:  [7.30702823]


portfolio before change:  [13.49158675]
curr_Stock_Price:  96.47971034941851
curr_Factors:  [96.47971035]
mat_Sqrt:  [[0.15]]
grads:  [-0.28196624]
Stock Position:  -0.28196623881185084
Bond Position:  [40.6956078]


portfolio before change:  [13.30151726]
curr_Stock_Price:  97.1628170990972
curr_Factors:  [97.1628171]
mat_Sqrt:  [[0.15]]
grads:  [0.01714324]
Stock Position:  0.017143243007337706
Bond Position:  [11.63583148]


portfolio before change:  [13.31797207]
curr_Stock_Price:  98.0802362628794
curr_Factors:  [98.08023626]
mat_Sqrt:  [[0.15]]
grads:  [-0.00923384]
Stock Position:  -0.00923384191978377
Bond Position:  [14.22362946]


portfolio before change:  [13.31470253]
curr_Stock_Price:  98.53059451574727
curr_Factors:  [98.53059452]
mat_Sqrt:  [[0.15]]
grads:  [-0.06961089]
Stock Position:  -0.06961088947221891
Bond Position:  [20.17350486]


portfolio before change:  [13.33583869]
curr_Stock_Price:  98.24507495754025
curr_Factors:  [98.24507496]
mat_Sqrt:  [[0.15]]
grads:  [-0.0522165]
Stock Position:  -0.052216501854129065
Bond Position:  [18.46585283]


portfolio before change:  [13.35767059]
curr_Stock_Price:  97.84907458650191
curr_Factors:  [97.84907459]
mat_Sqrt:  [[0.15]]
grads:  [0.03520537]
Stock Position:  0.03520537452044785
Bond Position:  [9.91285728]


portfolio before change:  [13.34835674]
curr_Stock_Price:  97.56691805837528
curr_Factors:  [97.56691806]
mat_Sqrt:  [[0.15]]
grads:  [0.09036924]
Stock Position:  0.09036924021179579
Bond Position:  [4.53130849]


portfolio before change:  [13.30996226]
curr_Stock_Price:  97.13892181190593
curr_Factors:  [97.13892181]
mat_Sqrt:  [[0.15]]
grads:  [0.08651049]
Stock Position:  0.08651049096973286
Bond Position:  [4.90642644]


portfolio before change:  [13.28376529]
curr_Stock_Price:  96.83255863610289
curr_Factors:  [96.83255864]
mat_Sqrt:  [[0.15]]
grads:  [-0.22628655]
Stock Position:  -0.2262865547067595
Bond Position:  [35.19567137]


portfolio before change:  [13.49194515]
curr_Stock_Price:  95.9222966243531
curr_Factors:  [95.92229662]
mat_Sqrt:  [[0.15]]
grads:  [0.05356243]
Stock Position:  0.05356243327175703
Bond Position:  [8.35411353]


portfolio before change:  [13.51765227]
curr_Stock_Price:  96.39249512444313
curr_Factors:  [96.39249512]
mat_Sqrt:  [[0.15]]
grads:  [-0.22648599]
Stock Position:  -0.22648599097062758
Bond Position:  [35.34920205]


portfolio before change:  [13.52573075]
curr_Stock_Price:  96.36658145160875
curr_Factors:  [96.36658145]
mat_Sqrt:  [[0.15]]
grads:  [0.057079]
Stock Position:  0.05707899593217614
Bond Position:  [8.02522304]


portfolio before change:  [13.49986812]
curr_Stock_Price:  95.90469138290153
curr_Factors:  [95.90469138]
mat_Sqrt:  [[0.15]]
grads:  [-0.0875114]
Stock Position:  -0.08751140235037264
Bond Position:  [21.89262215]


portfolio before change:  [13.49628918]
curr_Stock_Price:  95.9612242612731
curr_Factors:  [95.96122426]
mat_Sqrt:  [[0.15]]
grads:  [0.28297169]
Stock Position:  0.2829716938945711
Bond Position:  [-13.658021]


portfolio before change:  [13.65625127]
curr_Stock_Price:  96.52953460943685
curr_Factors:  [96.52953461]
mat_Sqrt:  [[0.15]]
grads:  [0.15465179]
Stock Position:  0.15465178579581854
Bond Position:  [-1.27221364]


portfolio before change:  [13.60553481]
curr_Stock_Price:  96.20210906667928
curr_Factors:  [96.20210907]
mat_Sqrt:  [[0.15]]
grads:  [0.02648885]
Stock Position:  0.026488854594395903
Bond Position:  [11.05725113]


portfolio before change:  [13.61098319]
curr_Stock_Price:  96.38170487309166
curr_Factors:  [96.38170487]
mat_Sqrt:  [[0.15]]
grads:  [0.03340852]
Stock Position:  0.03340851940412162
Bond Position:  [10.39101314]


portfolio before change:  [13.60971971]
curr_Stock_Price:  96.32444582824826
curr_Factors:  [96.32444583]
mat_Sqrt:  [[0.15]]
grads:  [0.0620099]
Stock Position:  0.06200989658693319
Bond Position:  [7.63665079]


portfolio before change:  [13.61797677]
curr_Stock_Price:  96.44990574259364
curr_Factors:  [96.44990574]
mat_Sqrt:  [[0.15]]
grads:  [0.00188799]
Stock Position:  0.001887989921931614
Bond Position:  [13.43588032]


portfolio before change:  [13.61999738]
curr_Stock_Price:  97.07535448335214
curr_Factors:  [97.07535448]
mat_Sqrt:  [[0.15]]
grads:  [-0.0796052]
Stock Position:  -0.07960519865281483
Bond Position:  [21.34770026]


portfolio before change:  [13.5154706]
curr_Stock_Price:  98.40518043832972
curr_Factors:  [98.40518044]
mat_Sqrt:  [[0.15]]
grads:  [-0.05726969]
Stock Position:  -0.057269693613908476
Bond Position:  [19.15110513]


portfolio before change:  [13.52152078]
curr_Stock_Price:  98.3204374996967
curr_Factors:  [98.3204375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242643]
Stock Position:  -0.02426429821421178
Bond Position:  [15.9071972]


portfolio before change:  [13.54268469]
curr_Stock_Price:  97.48918854426427
curr_Factors:  [97.48918854]
mat_Sqrt:  [[0.15]]
grads:  [0.28874457]
Stock Position:  0.28874456711177326
Bond Position:  [-14.60678886]


portfolio before change:  [13.54116395]
curr_Stock_Price:  97.4870836383831
curr_Factors:  [97.48708364]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499544]
Stock Position:  -0.05499544243905212
Bond Position:  [18.90250925]


portfolio before change:  [13.61060024]
curr_Stock_Price:  96.24598358438236
curr_Factors:  [96.24598358]
mat_Sqrt:  [[0.15]]
grads:  [0.01296743]
Stock Position:  0.012967431875446559
Bond Position:  [12.36253701]


portfolio before change:  [13.60145188]
curr_Stock_Price:  95.48090994407336
curr_Factors:  [95.48090994]
mat_Sqrt:  [[0.15]]
grads:  [0.03150756]
Stock Position:  0.03150756223734837
Bond Position:  [10.59308117]


portfolio before change:  [13.58121537]
curr_Stock_Price:  94.81762156245188
curr_Factors:  [94.81762156]
mat_Sqrt:  [[0.15]]
grads:  [0.02525413]
Stock Position:  0.025254133115838982
Bond Position:  [11.18667854]


portfolio before change:  [13.56814475]
curr_Stock_Price:  94.27237180229366
curr_Factors:  [94.2723718]
mat_Sqrt:  [[0.15]]
grads:  [0.0314203]
Stock Position:  0.031420301699532145
Bond Position:  [10.60607839]


portfolio before change:  [13.56652638]
curr_Stock_Price:  94.19976677769962
curr_Factors:  [94.19976678]
mat_Sqrt:  [[0.15]]
grads:  [-0.12148733]
Stock Position:  -0.12148733026437063
Bond Position:  [25.01060456]


portfolio before change:  [13.46476613]
curr_Stock_Price:  95.05025434714881
curr_Factors:  [95.05025435]
mat_Sqrt:  [[0.15]]
grads:  [0.00022007]
Stock Position:  0.00022007015894858812
Bond Position:  [13.4438484]


portfolio before change:  [13.46562411]
curr_Stock_Price:  95.13076622499081
curr_Factors:  [95.13076622]
mat_Sqrt:  [[0.15]]
grads:  [0.01054416]
Stock Position:  0.010544164951846942
Bond Position:  [12.46254962]


portfolio before change:  [13.4633511]
curr_Stock_Price:  94.84132234664455
curr_Factors:  [94.84132235]
mat_Sqrt:  [[0.15]]
grads:  [-0.44163198]
Stock Position:  -0.44163197908468976
Bond Position:  [55.34831199]


portfolio before change:  [13.59881595]
curr_Stock_Price:  94.54241857165927
curr_Factors:  [94.54241857]
mat_Sqrt:  [[0.15]]
grads:  [-0.08485552]
Stock Position:  -0.08485552024759854
Bond Position:  [21.62126206]


portfolio before change:  [13.55626324]
curr_Stock_Price:  95.05981660890686
curr_Factors:  [95.05981661]
mat_Sqrt:  [[0.15]]
grads:  [0.11960895]
Stock Position:  0.1196089497949284
Bond Position:  [2.18625841]


portfolio before change:  [13.49301639]
curr_Stock_Price:  94.52989397895695
curr_Factors:  [94.52989398]
mat_Sqrt:  [[0.15]]
grads:  [0.11015577]
Stock Position:  0.1101557697456238
Bond Position:  [3.08000316]


portfolio before change:  [13.55081548]
curr_Stock_Price:  95.05284963946309
curr_Factors:  [95.05284964]
mat_Sqrt:  [[0.15]]
grads:  [-0.12823095]
Stock Position:  -0.12823095471623716
Bond Position:  [25.73953314]


portfolio before change:  [13.44063185]
curr_Stock_Price:  95.92465479609709
curr_Factors:  [95.9246548]
mat_Sqrt:  [[0.15]]
grads:  [-0.03053851]
Stock Position:  -0.030538513640852468
Bond Position:  [16.37002823]


portfolio before change:  [13.44441304]
curr_Stock_Price:  95.83434162329283
curr_Factors:  [95.83434162]
mat_Sqrt:  [[0.15]]
grads:  [-0.10838425]
Stock Position:  -0.10838425197108977
Bond Position:  [23.83134647]


portfolio before change:  [13.41907077]
curr_Stock_Price:  96.08190313787469
curr_Factors:  [96.08190314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060342]
Stock Position:  -0.030603418571596444
Bond Position:  [16.35950547]


portfolio before change:  [13.42236441]
curr_Stock_Price:  96.0076912583816
curr_Factors:  [96.00769126]
mat_Sqrt:  [[0.15]]
grads:  [0.05657227]
Stock Position:  0.05657226803166328
Bond Position:  [7.99099157]


portfolio before change:  [13.41607317]
curr_Stock_Price:  95.88765545093823
curr_Factors:  [95.88765545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09099232]
Stock Position:  -0.09099231525233334
Bond Position:  [22.14111294]


portfolio before change:  [13.45068486]
curr_Stock_Price:  95.52248361115832
curr_Factors:  [95.52248361]
mat_Sqrt:  [[0.15]]
grads:  [0.07739539]
Stock Position:  0.07739538780829833
Bond Position:  [6.0576852]


portfolio before change:  [13.42818014]
curr_Stock_Price:  95.22681564846101
curr_Factors:  [95.22681565]
mat_Sqrt:  [[0.15]]
grads:  [0.02673386]
Stock Position:  0.026733863949769655
Bond Position:  [10.88239941]


portfolio before change:  [13.41749966]
curr_Stock_Price:  94.80186198762304
curr_Factors:  [94.80186199]
mat_Sqrt:  [[0.15]]
grads:  [0.08198657]
Stock Position:  0.08198657179423248
Bond Position:  [5.64501999]


portfolio before change:  [13.41005395]
curr_Stock_Price:  94.7067423760794
curr_Factors:  [94.70674238]
mat_Sqrt:  [[0.15]]
grads:  [0.02450125]
Stock Position:  0.0245012524550129
Bond Position:  [11.08962015]


portfolio before change:  [13.41215313]
curr_Stock_Price:  94.76412951194173
curr_Factors:  [94.76412951]
mat_Sqrt:  [[0.15]]
grads:  [-0.00393338]
Stock Position:  -0.003933379230119172
Bond Position:  [13.78489639]


portfolio before change:  [13.41320827]
curr_Stock_Price:  94.71492096164324
curr_Factors:  [94.71492096]
mat_Sqrt:  [[0.15]]
grads:  [0.05514339]
Stock Position:  0.05514339426172514
Bond Position:  [8.19030604]


portfolio before change:  [13.38665038]
curr_Stock_Price:  94.22402268756642
curr_Factors:  [94.22402269]
mat_Sqrt:  [[0.15]]
grads:  [-0.1315468]
Stock Position:  -0.13154679568211838
Bond Position:  [25.78151864]


portfolio before change:  [13.44999925]
curr_Stock_Price:  93.75470322136069
curr_Factors:  [93.75470322]
mat_Sqrt:  [[0.15]]
grads:  [0.03230143]
Stock Position:  0.032301427536194624
Bond Position:  [10.4215885]


portfolio before change:  [13.46171753]
curr_Stock_Price:  94.09731693550243
curr_Factors:  [94.09731694]
mat_Sqrt:  [[0.15]]
grads:  [0.05232131]
Stock Position:  0.0523213090321158
Bond Position:  [8.53842273]


portfolio before change:  [13.44312577]
curr_Stock_Price:  93.73177883802317
curr_Factors:  [93.73177884]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.44312577]
Stock Price:  92.63421986442643
PL:  [13.44312577]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.17944272e-03]
 [-5.91412587e-03]
 [ 5.48342214e-04]
 [ 8.36143579e-03]
 [ 5.13410630e-03]
 [ 2.68648235e-02]
 [ 1.19092158e-03]
 [-1.30056203e-02]
 [ 2.40411258e-02]
 [-3.69051221e-03]
 [ 1.40491979e-02]
 [ 1.08477456e-02]
 [-1.45666139e-02]
 [ 5.61937330e-03]
 [-6.94320237e-03]
 [ 9.38077064e-03]
 [ 7.46703804e-03]
 [-1.20562050e-02]
 [ 8.50988176e-04]
 [ 1.31796075e-02]
 [ 1.17022609e-02]
 [-9.20979649e-03]
 [ 6.57459873e-03]
 [ 5.51191311e-03]
 [-7.56736425e-03]
 [ 8.03648815e-03]
 [-7.00986937e-03]
 [ 6.06767365e-03]
 [-1.31995733e-02]
 [ 1.78851184e-04]
 [-4.12006210e-03]
 [-1.06830081e-02]
 [-9.18081926e-03]
 [ 5.54595659e-03]
 [ 1.37810274e-02]
 [ 1.02570188e-02]
 [-3.37944639e-02]
 [ 8.22718379e-03]
 [-3.46777006e-02]
 [ 8.72479194e-03]
 [-1.29314665e-02]
 [ 3.69505824e-02]
 [ 2.31567962e-02]
 [ 4.04470639e-03]
 [ 4.17043812e-03]
 [ 3.97260383e-03]
 [ 1.28376285e-03]
 [-9.80413157e-03]
 [ 1.58381934e-02]
 [ 5.80923725e-03]
 [ 2.90943988e-02]
 [ 8.02514155e-03]
 [ 7.36074519e-04]
 [ 4.75118871e-03]
 [ 3.86507645e-03]
 [ 2.27590227e-03]
 [-6.15667705e-03]
 [-2.45897232e-04]
 [ 1.58010592e-03]
 [-5.02037480e-02]
 [-1.14043144e-02]
 [ 1.50428543e-02]
 [ 1.57250795e-02]
 [-1.93090938e-02]
 [-3.81047598e-03]
 [-2.01847744e-02]
 [-4.00299078e-03]
 [-3.08946829e-03]
 [-1.88305057e-02]
 [ 1.50805747e-02]
 [ 9.04213816e-03]
 [ 1.21393960e-02]
 [ 3.14562464e-03]
 [ 1.63549678e-03]
 [-5.59048080e-03]
 [-1.03900783e-02]
 [ 1.31313934e-03]
 [ 3.09736446e-03]
 [-1.01365199e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.17117475]
curr_Stock_Price:  99.9434021458065
curr_Factors:  [99.94340215]
mat_Sqrt:  [[0.15]]
grads:  [0.01452962]
Stock Position:  0.014529618165725672
Bond Position:  [-0.28096472]


portfolio before change:  [1.16278248]
curr_Stock_Price:  99.36701308589679
curr_Factors:  [99.36701309]
mat_Sqrt:  [[0.15]]
grads:  [-0.03942751]
Stock Position:  -0.0394275058065667
Bond Position:  [5.08057596]


portfolio before change:  [1.13855655]
curr_Stock_Price:  99.9895093829108
curr_Factors:  [99.98950938]
mat_Sqrt:  [[0.15]]
grads:  [0.00365561]
Stock Position:  0.0036556147574965995
Bond Position:  [0.77303342]


portfolio before change:  [1.13772026]
curr_Stock_Price:  99.74752494460667
curr_Factors:  [99.74752494]
mat_Sqrt:  [[0.15]]
grads:  [0.05574291]
Stock Position:  0.05574290528279632
Bond Position:  [-4.42249657]


portfolio before change:  [1.15323614]
curr_Stock_Price:  100.03083078500424
curr_Factors:  [100.03083079]
mat_Sqrt:  [[0.15]]
grads:  [0.03422738]
Stock Position:  0.03422737535245197
Bond Position:  [-2.27055665]


portfolio before change:  [1.16622991]
curr_Stock_Price:  100.41460800439872
curr_Factors:  [100.414608]
mat_Sqrt:  [[0.15]]
grads:  [0.17909882]
Stock Position:  0.17909882302854763
Bond Position:  [-16.8179082]


portfolio before change:  [1.19043387]
curr_Stock_Price:  100.55562014283576
curr_Factors:  [100.55562014]
mat_Sqrt:  [[0.15]]
grads:  [0.00793948]
Stock Position:  0.007939477168184345
Bond Position:  [0.39207482]


portfolio before change:  [1.19032712]
curr_Stock_Price:  100.53908881566001
curr_Factors:  [100.53908882]
mat_Sqrt:  [[0.15]]
grads:  [-0.08670414]
Stock Position:  -0.08670413552819985
Bond Position:  [9.90748191]


portfolio before change:  [1.20452804]
curr_Stock_Price:  100.38244489714775
curr_Factors:  [100.3824449]
mat_Sqrt:  [[0.15]]
grads:  [0.16027417]
Stock Position:  0.16027417205504185
Bond Position:  [-14.88418521]


portfolio before change:  [1.20596438]
curr_Stock_Price:  100.39721105219675
curr_Factors:  [100.39721105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460341]
Stock Position:  -0.024603414730015233
Bond Position:  [3.6760786]


portfolio before change:  [1.22782013]
curr_Stock_Price:  99.51822777361127
curr_Factors:  [99.51822777]
mat_Sqrt:  [[0.15]]
grads:  [0.09366132]
Stock Position:  0.09366131920639834
Bond Position:  [-8.09318837]


portfolio before change:  [1.2149171]
curr_Stock_Price:  99.3858658702418
curr_Factors:  [99.38586587]
mat_Sqrt:  [[0.15]]
grads:  [0.0723183]
Stock Position:  0.07231830420714645
Bond Position:  [-5.97250018]


portfolio before change:  [1.14047503]
curr_Stock_Price:  98.36166071898376
curr_Factors:  [98.36166072]
mat_Sqrt:  [[0.15]]
grads:  [-0.09711076]
Stock Position:  -0.0971107593528482
Bond Position:  [10.69245059]


portfolio before change:  [1.14884425]
curr_Stock_Price:  98.28236034073478
curr_Factors:  [98.28236034]
mat_Sqrt:  [[0.15]]
grads:  [0.03746249]
Stock Position:  0.03746248866419476
Bond Position:  [-2.53305756]


portfolio before change:  [1.17931108]
curr_Stock_Price:  99.09984875953991
curr_Factors:  [99.09984876]
mat_Sqrt:  [[0.15]]
grads:  [-0.04628802]
Stock Position:  -0.04628801581178748
Bond Position:  [5.76644644]


portfolio before change:  [1.16369628]
curr_Stock_Price:  99.44497500460207
curr_Factors:  [99.444975]
mat_Sqrt:  [[0.15]]
grads:  [0.06253847]
Stock Position:  0.06253847092216007
Bond Position:  [-5.0554404]


portfolio before change:  [1.20092464]
curr_Stock_Price:  100.04531476265748
curr_Factors:  [100.04531476]
mat_Sqrt:  [[0.15]]
grads:  [0.04978025]
Stock Position:  0.04978025358903431
Bond Position:  [-3.7793565]


portfolio before change:  [1.18466495]
curr_Stock_Price:  99.72343066253048
curr_Factors:  [99.72343066]
mat_Sqrt:  [[0.15]]
grads:  [-0.0803747]
Stock Position:  -0.08037470027875415
Bond Position:  [9.1999058]


portfolio before change:  [1.27515934]
curr_Stock_Price:  98.60467839882591
curr_Factors:  [98.6046784]
mat_Sqrt:  [[0.15]]
grads:  [0.00567325]
Stock Position:  0.005673254506347418
Bond Position:  [0.7157499]


portfolio before change:  [1.27712033]
curr_Stock_Price:  98.94244911927294
curr_Factors:  [98.94244912]
mat_Sqrt:  [[0.15]]
grads:  [0.08786405]
Stock Position:  0.08786404976716497
Bond Position:  [-7.41636394]


portfolio before change:  [1.2826541]
curr_Stock_Price:  99.01070572177272
curr_Factors:  [99.01070572]
mat_Sqrt:  [[0.15]]
grads:  [0.07801507]
Stock Position:  0.07801507269488105
Bond Position:  [-6.44167331]


portfolio before change:  [1.22780529]
curr_Stock_Price:  98.31281246718609
curr_Factors:  [98.31281247]
mat_Sqrt:  [[0.15]]
grads:  [-0.06139864]
Stock Position:  -0.06139864323797116
Bond Position:  [7.26407858]


portfolio before change:  [1.23220872]
curr_Stock_Price:  98.24848840782919
curr_Factors:  [98.24848841]
mat_Sqrt:  [[0.15]]
grads:  [0.04383066]
Stock Position:  0.04383065816866581
Bond Position:  [-3.0740872]


portfolio before change:  [1.2395442]
curr_Stock_Price:  98.42023167999074
curr_Factors:  [98.42023168]
mat_Sqrt:  [[0.15]]
grads:  [0.03674609]
Stock Position:  0.03674608742538259
Bond Position:  [-2.37701424]


portfolio before change:  [1.27093029]
curr_Stock_Price:  99.2784090516269
curr_Factors:  [99.27840905]
mat_Sqrt:  [[0.15]]
grads:  [-0.05044909]
Stock Position:  -0.050449094999338605
Bond Position:  [6.27943618]


portfolio before change:  [1.2498151]
curr_Stock_Price:  99.70473319818251
curr_Factors:  [99.7047332]
mat_Sqrt:  [[0.15]]
grads:  [0.05357659]
Stock Position:  0.05357658764376849
Bond Position:  [-4.09202427]


portfolio before change:  [1.24009128]
curr_Stock_Price:  99.52801312010699
curr_Factors:  [99.52801312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04673246]
Stock Position:  -0.04673246249960667
Bond Position:  [5.89128042]


portfolio before change:  [1.24307009]
curr_Stock_Price:  99.47215072171527
curr_Factors:  [99.47215072]
mat_Sqrt:  [[0.15]]
grads:  [0.04045116]
Stock Position:  0.04045115765032478
Bond Position:  [-2.78069356]


portfolio before change:  [1.21616231]
curr_Stock_Price:  98.81125538466956
curr_Factors:  [98.81125538]
mat_Sqrt:  [[0.15]]
grads:  [-0.08799716]
Stock Position:  -0.08799715535237083
Bond Position:  [9.9112717]


portfolio before change:  [1.26495753]
curr_Stock_Price:  98.26378602062788
curr_Factors:  [98.26378602]
mat_Sqrt:  [[0.15]]
grads:  [0.00119234]
Stock Position:  0.0011923412239055998
Bond Position:  [1.14779357]


portfolio before change:  [1.26541268]
curr_Stock_Price:  98.58534879546042
curr_Factors:  [98.5853488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02746708]
Stock Position:  -0.027467080647493286
Bond Position:  [3.97326441]


portfolio before change:  [1.262584]
curr_Stock_Price:  98.69737425642276
curr_Factors:  [98.69737426]
mat_Sqrt:  [[0.15]]
grads:  [-0.07122005]
Stock Position:  -0.07122005386395412
Bond Position:  [8.29181632]


portfolio before change:  [1.33437044]
curr_Stock_Price:  97.6966985126437
curr_Factors:  [97.69669851]
mat_Sqrt:  [[0.15]]
grads:  [-0.06120546]
Stock Position:  -0.06120546176446412
Bond Position:  [7.31394198]


portfolio before change:  [1.36679866]
curr_Stock_Price:  97.17434178806332
curr_Factors:  [97.17434179]
mat_Sqrt:  [[0.15]]
grads:  [0.03697304]
Stock Position:  0.03697304392485609
Bond Position:  [-2.22603255]


portfolio before change:  [1.35548508]
curr_Stock_Price:  96.87210953496364
curr_Factors:  [96.87210953]
mat_Sqrt:  [[0.15]]
grads:  [0.09187352]
Stock Position:  0.09187351604857572
Bond Position:  [-7.54449623]


portfolio before change:  [1.32967181]
curr_Stock_Price:  96.59627671892564
curr_Factors:  [96.59627672]
mat_Sqrt:  [[0.15]]
grads:  [0.06838013]
Stock Position:  0.0683801256448241
Bond Position:  [-5.27559373]


portfolio before change:  [1.3388586]
curr_Stock_Price:  96.73544775898694
curr_Factors:  [96.73544776]
mat_Sqrt:  [[0.15]]
grads:  [-0.22529643]
Stock Position:  -0.22529642620024457
Bond Position:  [23.13300927]


portfolio before change:  [1.39837285]
curr_Stock_Price:  96.477705615455
curr_Factors:  [96.47770562]
mat_Sqrt:  [[0.15]]
grads:  [0.05484789]
Stock Position:  0.05484789192661392
Bond Position:  [-3.89322593]


portfolio before change:  [1.38833458]
curr_Stock_Price:  96.29912209843827
curr_Factors:  [96.2991221]
mat_Sqrt:  [[0.15]]
grads:  [-0.23118467]
Stock Position:  -0.23118467049813363
Bond Position:  [23.65121539]


portfolio before change:  [1.37016793]
curr_Stock_Price:  96.38409700483498
curr_Factors:  [96.384097]
mat_Sqrt:  [[0.15]]
grads:  [0.05816528]
Stock Position:  0.0581652795774731
Bond Position:  [-4.23604002]


portfolio before change:  [1.34697796]
curr_Stock_Price:  95.98995794839668
curr_Factors:  [95.98995795]
mat_Sqrt:  [[0.15]]
grads:  [-0.08620978]
Stock Position:  -0.08620977649592654
Bond Position:  [9.62225079]


portfolio before change:  [1.30607497]
curr_Stock_Price:  96.47139299117224
curr_Factors:  [96.47139299]
mat_Sqrt:  [[0.15]]
grads:  [0.24633722]
Stock Position:  0.2463372161363729
Bond Position:  [-22.45841942]


portfolio before change:  [1.39138042]
curr_Stock_Price:  96.82338669232993
curr_Factors:  [96.82338669]
mat_Sqrt:  [[0.15]]
grads:  [0.15437864]
Stock Position:  0.15437864121346706
Bond Position:  [-13.55608246]


portfolio before change:  [1.32037513]
curr_Stock_Price:  96.36893258063586
curr_Factors:  [96.36893258]
mat_Sqrt:  [[0.15]]
grads:  [0.02696471]
Stock Position:  0.02696470929537239
Bond Position:  [-1.27818512]


portfolio before change:  [1.32912677]
curr_Stock_Price:  96.69645452021523
curr_Factors:  [96.69645452]
mat_Sqrt:  [[0.15]]
grads:  [0.02780292]
Stock Position:  0.027802920769914117
Bond Position:  [-1.35931709]


portfolio before change:  [1.33772313]
curr_Stock_Price:  97.00869935362522
curr_Factors:  [97.00869935]
mat_Sqrt:  [[0.15]]
grads:  [0.02648403]
Stock Position:  0.026484025512831452
Bond Position:  [-1.23145774]


portfolio before change:  [1.33918029]
curr_Stock_Price:  97.06662567471366
curr_Factors:  [97.06662567]
mat_Sqrt:  [[0.15]]
grads:  [0.00855842]
Stock Position:  0.008558419016078945
Bond Position:  [0.50844343]


portfolio before change:  [1.32879482]
curr_Stock_Price:  95.84943340263362
curr_Factors:  [95.8494334]
mat_Sqrt:  [[0.15]]
grads:  [-0.06536088]
Stock Position:  -0.06536087710527375
Bond Position:  [7.59359786]


portfolio before change:  [1.3805876]
curr_Stock_Price:  95.06428230195701
curr_Factors:  [95.0642823]
mat_Sqrt:  [[0.15]]
grads:  [0.10558796]
Stock Position:  0.10558795612710835
Bond Position:  [-8.65705567]


portfolio before change:  [1.36788254]
curr_Stock_Price:  94.94907999879321
curr_Factors:  [94.94908]
mat_Sqrt:  [[0.15]]
grads:  [0.03872825]
Stock Position:  0.03872824833426056
Bond Position:  [-2.309329]


portfolio before change:  [1.33661156]
curr_Stock_Price:  94.14536060128805
curr_Factors:  [94.1453606]
mat_Sqrt:  [[0.15]]
grads:  [0.19396266]
Stock Position:  0.193962658510093
Bond Position:  [-16.92407287]


portfolio before change:  [1.45163711]
curr_Stock_Price:  94.74384350083373
curr_Factors:  [94.7438435]
mat_Sqrt:  [[0.15]]
grads:  [0.05350094]
Stock Position:  0.05350094365284599
Bond Position:  [-3.61724792]


portfolio before change:  [1.46521016]
curr_Stock_Price:  95.00176681097409
curr_Factors:  [95.00176681]
mat_Sqrt:  [[0.15]]
grads:  [0.00490716]
Stock Position:  0.004907163457746374
Bond Position:  [0.99902097]


portfolio before change:  [1.46828024]
curr_Stock_Price:  95.61467457588074
curr_Factors:  [95.61467458]
mat_Sqrt:  [[0.15]]
grads:  [0.03167459]
Stock Position:  0.03167459137270431
Bond Position:  [-1.5602755]


portfolio before change:  [1.48742748]
curr_Stock_Price:  96.2222516139701
curr_Factors:  [96.22225161]
mat_Sqrt:  [[0.15]]
grads:  [0.02576718]
Stock Position:  0.025767176338884465
Bond Position:  [-0.99194825]


portfolio before change:  [1.48933867]
curr_Stock_Price:  96.29882937725928
curr_Factors:  [96.29882938]
mat_Sqrt:  [[0.15]]
grads:  [0.01517268]
Stock Position:  0.015172681808388577
Bond Position:  [0.02822718]


portfolio before change:  [1.48565012]
curr_Stock_Price:  96.05560804992535
curr_Factors:  [96.05560805]
mat_Sqrt:  [[0.15]]
grads:  [-0.04104451]
Stock Position:  -0.04104451365173174
Bond Position:  [5.42820583]


portfolio before change:  [1.49947586]
curr_Stock_Price:  95.72702654876078
curr_Factors:  [95.72702655]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163931]
Stock Position:  -0.0016393148773885182
Bond Position:  [1.6564026]


portfolio before change:  [1.50044703]
curr_Stock_Price:  95.1977547510575
curr_Factors:  [95.19775475]
mat_Sqrt:  [[0.15]]
grads:  [0.01053404]
Stock Position:  0.010534039466644425
Bond Position:  [0.49763012]


portfolio before change:  [1.50285864]
curr_Stock_Price:  95.42373672332604
curr_Factors:  [95.42373672]
mat_Sqrt:  [[0.15]]
grads:  [-0.33469165]
Stock Position:  -0.3346916530402965
Bond Position:  [33.44038682]


portfolio before change:  [1.58056528]
curr_Stock_Price:  95.19780770557821
curr_Factors:  [95.19780771]
mat_Sqrt:  [[0.15]]
grads:  [-0.07602876]
Stock Position:  -0.07602876261304742
Bond Position:  [8.8183368]


portfolio before change:  [1.52498735]
curr_Stock_Price:  95.93606897406862
curr_Factors:  [95.93606897]
mat_Sqrt:  [[0.15]]
grads:  [0.1002857]
Stock Position:  0.10028569514098393
Bond Position:  [-8.09602801]


portfolio before change:  [1.45838165]
curr_Stock_Price:  95.27695514411005
curr_Factors:  [95.27695514]
mat_Sqrt:  [[0.15]]
grads:  [0.10483386]
Stock Position:  0.10483386342207922
Bond Position:  [-8.52986966]


portfolio before change:  [1.41189597]
curr_Stock_Price:  94.8386182702518
curr_Factors:  [94.83861827]
mat_Sqrt:  [[0.15]]
grads:  [-0.12872729]
Stock Position:  -0.12872729189758586
Bond Position:  [13.62021446]


portfolio before change:  [1.3985046]
curr_Stock_Price:  94.94926034025254
curr_Factors:  [94.94926034]
mat_Sqrt:  [[0.15]]
grads:  [-0.02540317]
Stock Position:  -0.02540317323293374
Bond Position:  [3.81051711]


portfolio before change:  [1.40446703]
curr_Stock_Price:  94.72392371723099
curr_Factors:  [94.72392372]
mat_Sqrt:  [[0.15]]
grads:  [-0.13456516]
Stock Position:  -0.13456516281436415
Bond Position:  [14.15100725]


portfolio before change:  [1.4720909]
curr_Stock_Price:  94.22796025871891
curr_Factors:  [94.22796026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02668661]
Stock Position:  -0.026686605208180655
Bond Position:  [3.98671528]


portfolio before change:  [1.47968337]
curr_Stock_Price:  93.95279258614292
curr_Factors:  [93.95279259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02059646]
Stock Position:  -0.020596455291209913
Bond Position:  [3.41477786]


portfolio before change:  [1.48162598]
curr_Stock_Price:  93.86883748710476
curr_Factors:  [93.86883749]
mat_Sqrt:  [[0.15]]
grads:  [-0.1255367]
Stock Position:  -0.1255367044069915
Bond Position:  [13.26561048]


portfolio before change:  [1.5088723]
curr_Stock_Price:  93.65840341726651
curr_Factors:  [93.65840342]
mat_Sqrt:  [[0.15]]
grads:  [0.10053716]
Stock Position:  0.10053716489047111
Bond Position:  [-7.90727804]


portfolio before change:  [1.53836122]
curr_Stock_Price:  93.95663280195083
curr_Factors:  [93.9566328]
mat_Sqrt:  [[0.15]]
grads:  [0.06028092]
Stock Position:  0.0602809210951849
Bond Position:  [-4.12543115]


portfolio before change:  [1.62235536]
curr_Stock_Price:  95.35428874549217
curr_Factors:  [95.35428875]
mat_Sqrt:  [[0.15]]
grads:  [0.08092931]
Stock Position:  0.08092930686713679
Bond Position:  [-6.09460113]


portfolio before change:  [1.63582141]
curr_Stock_Price:  95.52538841640138
curr_Factors:  [95.52538842]
mat_Sqrt:  [[0.15]]
grads:  [0.02097083]
Stock Position:  0.02097083093656695
Bond Position:  [-0.36742536]


portfolio before change:  [1.65308826]
curr_Stock_Price:  96.3498578306208
curr_Factors:  [96.34985783]
mat_Sqrt:  [[0.15]]
grads:  [0.01090331]
Stock Position:  0.010903311854813576
Bond Position:  [0.60255571]


portfolio before change:  [1.6576931]
curr_Stock_Price:  96.76873828827502
curr_Factors:  [96.76873829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03726987]
Stock Position:  -0.03726987199327757
Bond Position:  [5.26425159]


portfolio before change:  [1.63892489]
curr_Stock_Price:  97.2811425755681
curr_Factors:  [97.28114258]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926719]
Stock Position:  -0.06926718890950213
Bond Position:  [8.37731617]


portfolio before change:  [1.59018433]
curr_Stock_Price:  97.99236171702569
curr_Factors:  [97.99236172]
mat_Sqrt:  [[0.15]]
grads:  [0.00875426]
Stock Position:  0.008754262262731627
Bond Position:  [0.7323335]


portfolio before change:  [1.58722027]
curr_Stock_Price:  97.64854826678882
curr_Factors:  [97.64854827]
mat_Sqrt:  [[0.15]]
grads:  [0.0206491]
Stock Position:  0.020649096417968537
Bond Position:  [-0.42913401]


portfolio before change:  [1.59748526]
curr_Stock_Price:  98.14696260964408
curr_Factors:  [98.14696261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.59748526]
Stock Price:  98.20399497030452
PL:  [1.59748526]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.25546267e-04]
 [-6.76805088e-05]
 [-4.39029342e-03]
 [ 4.43163098e-03]
 [ 1.17174435e-02]
 [ 2.82923927e-02]
 [ 1.65127164e-03]
 [-1.67669611e-02]
 [ 2.51559654e-02]
 [-3.93787901e-03]
 [ 1.59173611e-02]
 [-2.10634016e-02]
 [ 2.68765711e-03]
 [ 3.51002011e-03]
 [-6.90734841e-03]
 [ 2.09551557e-02]
 [ 1.05790063e-02]
 [-1.10151834e-02]
 [-5.85238179e-04]
 [-4.91445367e-03]
 [ 1.25659300e-02]
 [-5.64873828e-03]
 [ 8.19899670e-03]
 [ 5.39503200e-03]
 [ 4.15352388e-03]
 [ 1.28004615e-02]
 [-5.48166450e-03]
 [ 8.97633042e-03]
 [ 2.45188108e-02]
 [-1.51150853e-03]
 [ 1.16822678e-02]
 [-1.18127292e-02]
 [ 7.59271656e-03]
 [ 8.41750689e-03]
 [ 1.09737074e-02]
 [ 8.66763981e-03]
 [-3.45526357e-02]
 [ 9.76142310e-03]
 [-1.12539490e-02]
 [ 2.43912302e-02]
 [-4.92234325e-03]
 [ 7.67610404e-04]
 [ 2.30113665e-02]
 [ 4.51033478e-03]
 [ 1.15072165e-03]
 [ 7.03327351e-03]
 [-8.96691171e-04]
 [-7.94129856e-03]
 [ 1.28403493e-02]
 [ 5.62288848e-03]
 [ 3.37599437e-02]
 [ 3.52098586e-03]
 [ 1.72531245e-03]
 [ 4.65468427e-03]
 [ 3.72464895e-03]
 [ 3.86735154e-03]
 [-1.07476382e-02]
 [ 4.54482471e-05]
 [ 1.58114001e-03]
 [-7.05581283e-02]
 [-1.20351609e-02]
 [ 1.81277053e-02]
 [ 1.58908881e-02]
 [-1.94568464e-02]
 [-3.71284530e-03]
 [-2.01054709e-02]
 [-3.80138620e-03]
 [-8.17282173e-03]
 [-2.02986152e-02]
 [ 1.64167260e-02]
 [ 1.07232068e-02]
 [ 1.26101546e-02]
 [ 3.24018203e-03]
 [ 3.66723912e-03]
 [ 1.33310352e-02]
 [-2.19239986e-02]
 [ 4.77908809e-03]
 [ 8.73199841e-03]
 [ 4.84489669e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.26898092]
curr_Stock_Price:  100.60001157647163
curr_Factors:  [100.60001158]
mat_Sqrt:  [[0.15]]
grads:  [-0.00217031]
Stock Position:  -0.0021703084460005543
Bond Position:  [11.48731397]


portfolio before change:  [11.26882537]
curr_Stock_Price:  101.00250182653558
curr_Factors:  [101.00250183]
mat_Sqrt:  [[0.15]]
grads:  [-0.0004512]
Stock Position:  -0.00045120339199394903
Bond Position:  [11.31439804]


portfolio before change:  [11.26934218]
curr_Stock_Price:  101.4244012106081
curr_Factors:  [101.42440121]
mat_Sqrt:  [[0.15]]
grads:  [-0.02926862]
Stock Position:  -0.029268622784311388
Bond Position:  [14.23789472]


portfolio before change:  [11.28342025]
curr_Stock_Price:  100.97381037937103
curr_Factors:  [100.97381038]
mat_Sqrt:  [[0.15]]
grads:  [0.02954421]
Stock Position:  0.02954420656160554
Bond Position:  [8.30022914]


portfolio before change:  [11.28517784]
curr_Stock_Price:  101.01574120165664
curr_Factors:  [101.0157412]
mat_Sqrt:  [[0.15]]
grads:  [0.07811629]
Stock Position:  0.07811628984995457
Bond Position:  [3.39420292]


portfolio before change:  [11.27330717]
curr_Stock_Price:  100.86106397141162
curr_Factors:  [100.86106397]
mat_Sqrt:  [[0.15]]
grads:  [0.18861595]
Stock Position:  0.1886159513023315
Bond Position:  [-7.75069836]


portfolio before change:  [11.12673071]
curr_Stock_Price:  100.08651640379477
curr_Factors:  [100.0865164]
mat_Sqrt:  [[0.15]]
grads:  [0.01100848]
Stock Position:  0.01100847759361176
Bond Position:  [10.02493054]


portfolio before change:  [11.12721902]
curr_Stock_Price:  100.07395567482232
curr_Factors:  [100.07395567]
mat_Sqrt:  [[0.15]]
grads:  [-0.11177974]
Stock Position:  -0.11177974048050937
Bond Position:  [22.31345981]


portfolio before change:  [11.08476002]
curr_Stock_Price:  100.46627749964813
curr_Factors:  [100.4662775]
mat_Sqrt:  [[0.15]]
grads:  [0.16770644]
Stock Position:  0.167706435943371
Bond Position:  [-5.76408131]


portfolio before change:  [11.09784317]
curr_Stock_Price:  100.5464379338193
curr_Factors:  [100.54643793]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625253]
Stock Position:  -0.02625252675576152
Bond Position:  [13.73744123]


portfolio before change:  [11.09360077]
curr_Stock_Price:  100.7407439136943
curr_Factors:  [100.74074391]
mat_Sqrt:  [[0.15]]
grads:  [0.10611574]
Stock Position:  0.10611574074923356
Bond Position:  [0.4034221]


portfolio before change:  [11.09408232]
curr_Stock_Price:  100.74504425633134
curr_Factors:  [100.74504426]
mat_Sqrt:  [[0.15]]
grads:  [-0.14042268]
Stock Position:  -0.1404226774709947
Bond Position:  [25.24097117]


portfolio before change:  [11.15564097]
curr_Stock_Price:  100.31789782465012
curr_Factors:  [100.31789782]
mat_Sqrt:  [[0.15]]
grads:  [0.01791771]
Stock Position:  0.017917714095436167
Bond Position:  [9.35817356]


portfolio before change:  [11.17329272]
curr_Stock_Price:  101.27041014060057
curr_Factors:  [101.27041014]
mat_Sqrt:  [[0.15]]
grads:  [0.02340013]
Stock Position:  0.023400134089444403
Bond Position:  [8.80355154]


portfolio before change:  [11.16841299]
curr_Stock_Price:  101.03836167261166
curr_Factors:  [101.03836167]
mat_Sqrt:  [[0.15]]
grads:  [-0.04604899]
Stock Position:  -0.046048989390054376
Bond Position:  [15.82112744]


portfolio before change:  [11.15332102]
curr_Stock_Price:  101.38757293085428
curr_Factors:  [101.38757293]
mat_Sqrt:  [[0.15]]
grads:  [0.13970104]
Stock Position:  0.1397010376671951
Bond Position:  [-3.01062813]


portfolio before change:  [11.14003605]
curr_Stock_Price:  101.29382415712128
curr_Factors:  [101.29382416]
mat_Sqrt:  [[0.15]]
grads:  [0.07052671]
Stock Position:  0.07052670851936983
Bond Position:  [3.99611604]


portfolio before change:  [11.15189347]
curr_Stock_Price:  101.45840948222644
curr_Factors:  [101.45840948]
mat_Sqrt:  [[0.15]]
grads:  [-0.07343456]
Stock Position:  -0.07343455600575306
Bond Position:  [18.60244673]


portfolio before change:  [11.19535645]
curr_Stock_Price:  100.88238248902752
curr_Factors:  [100.88238249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00390159]
Stock Position:  -0.003901587858666806
Bond Position:  [11.58895793]


portfolio before change:  [11.19414361]
curr_Stock_Price:  101.37889046262488
curr_Factors:  [101.37889046]
mat_Sqrt:  [[0.15]]
grads:  [-0.03276302]
Stock Position:  -0.03276302444653857
Bond Position:  [14.51562268]


portfolio before change:  [11.2000048]
curr_Stock_Price:  101.22768552749807
curr_Factors:  [101.22768553]
mat_Sqrt:  [[0.15]]
grads:  [0.08377287]
Stock Position:  0.08377286690116659
Bond Position:  [2.71987137]


portfolio before change:  [11.17030969]
curr_Stock_Price:  100.87118462528551
curr_Factors:  [100.87118463]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765826]
Stock Position:  -0.03765825519425735
Bond Position:  [14.96894251]


portfolio before change:  [11.15561995]
curr_Stock_Price:  101.2861091072371
curr_Factors:  [101.28610911]
mat_Sqrt:  [[0.15]]
grads:  [0.05465998]
Stock Position:  0.054659977979269796
Bond Position:  [5.61932346]


portfolio before change:  [11.1829906]
curr_Stock_Price:  101.78042756745575
curr_Factors:  [101.78042757]
mat_Sqrt:  [[0.15]]
grads:  [0.03596688]
Stock Position:  0.035966880009856844
Bond Position:  [7.52226618]


portfolio before change:  [11.21041141]
curr_Stock_Price:  102.52974604388244
curr_Factors:  [102.52974604]
mat_Sqrt:  [[0.15]]
grads:  [0.02769016]
Stock Position:  0.027690159194556307
Bond Position:  [8.37134642]


portfolio before change:  [11.1731284]
curr_Stock_Price:  101.16441494077324
curr_Factors:  [101.16441494]
mat_Sqrt:  [[0.15]]
grads:  [0.08533641]
Stock Position:  0.08533640998508984
Bond Position:  [2.54012041]


portfolio before change:  [11.21120216]
curr_Stock_Price:  101.6087153520304
curr_Factors:  [101.60871535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03654443]
Stock Position:  -0.03654442997314456
Bond Position:  [14.92443475]


portfolio before change:  [11.20097489]
curr_Stock_Price:  101.91409915418643
curr_Factors:  [101.91409915]
mat_Sqrt:  [[0.15]]
grads:  [0.0598422]
Stock Position:  0.05984220283032193
Bond Position:  [5.1022107]


portfolio before change:  [11.19388749]
curr_Stock_Price:  101.79033526860769
curr_Factors:  [101.79033527]
mat_Sqrt:  [[0.15]]
grads:  [0.16345874]
Stock Position:  0.16345873884723364
Bond Position:  [-5.44463234]


portfolio before change:  [11.17644791]
curr_Stock_Price:  101.68572614289661
curr_Factors:  [101.68572614]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007672]
Stock Position:  -0.010076723526321165
Bond Position:  [12.20110686]


portfolio before change:  [11.17661789]
curr_Stock_Price:  101.74453645206833
curr_Factors:  [101.74453645]
mat_Sqrt:  [[0.15]]
grads:  [0.07788179]
Stock Position:  0.07788178509775852
Bond Position:  [3.25257177]


portfolio before change:  [11.16134858]
curr_Stock_Price:  101.5458686520928
curr_Factors:  [101.54586865]
mat_Sqrt:  [[0.15]]
grads:  [-0.07875153]
Stock Position:  -0.07875152826691469
Bond Position:  [19.15824092]


portfolio before change:  [11.14484125]
curr_Stock_Price:  101.77068662145331
curr_Factors:  [101.77068662]
mat_Sqrt:  [[0.15]]
grads:  [0.05061811]
Stock Position:  0.05061811041236878
Bond Position:  [5.99340139]


portfolio before change:  [11.16342267]
curr_Stock_Price:  102.13037654433082
curr_Factors:  [102.13037654]
mat_Sqrt:  [[0.15]]
grads:  [0.05611671]
Stock Position:  0.05611671263327983
Bond Position:  [5.43220168]


portfolio before change:  [11.1507154]
curr_Stock_Price:  101.8978826063137
curr_Factors:  [101.89788261]
mat_Sqrt:  [[0.15]]
grads:  [0.07315805]
Stock Position:  0.07315804948986122
Bond Position:  [3.69606506]


portfolio before change:  [11.11435102]
curr_Stock_Price:  101.39765887469889
curr_Factors:  [101.39765887]
mat_Sqrt:  [[0.15]]
grads:  [0.05778427]
Stock Position:  0.057784265413987415
Bond Position:  [5.25516178]


portfolio before change:  [11.04431813]
curr_Stock_Price:  100.18000307735196
curr_Factors:  [100.18000308]
mat_Sqrt:  [[0.15]]
grads:  [-0.2303509]
Stock Position:  -0.23035090452637463
Bond Position:  [34.12087245]


portfolio before change:  [10.99143543]
curr_Stock_Price:  100.41883575733844
curr_Factors:  [100.41883576]
mat_Sqrt:  [[0.15]]
grads:  [0.06507615]
Stock Position:  0.0650761539841155
Bond Position:  [4.45656381]


portfolio before change:  [10.95327558]
curr_Stock_Price:  99.82816788420159
curr_Factors:  [99.82816788]
mat_Sqrt:  [[0.15]]
grads:  [-0.07502633]
Stock Position:  -0.0750263263718802
Bond Position:  [18.44301628]


portfolio before change:  [11.01723994]
curr_Stock_Price:  98.99097322818263
curr_Factors:  [98.99097323]
mat_Sqrt:  [[0.15]]
grads:  [0.1626082]
Stock Position:  0.16260820160404002
Bond Position:  [-5.07950419]


portfolio before change:  [10.99692978]
curr_Stock_Price:  98.86802318469682
curr_Factors:  [98.86802318]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281562]
Stock Position:  -0.032815621678656724
Bond Position:  [14.24134542]


portfolio before change:  [10.99142831]
curr_Stock_Price:  99.0627955544412
curr_Factors:  [99.06279555]
mat_Sqrt:  [[0.15]]
grads:  [0.0051174]
Stock Position:  0.005117402693144401
Bond Position:  [10.4844841]


portfolio before change:  [10.99167536]
curr_Stock_Price:  98.98301766931198
curr_Factors:  [98.98301767]
mat_Sqrt:  [[0.15]]
grads:  [0.15340911]
Stock Position:  0.1534091098611117
Bond Position:  [-4.19322127]


portfolio before change:  [10.85325222]
curr_Stock_Price:  98.08241240719843
curr_Factors:  [98.08241241]
mat_Sqrt:  [[0.15]]
grads:  [0.0300689]
Stock Position:  0.030068898518911612
Bond Position:  [7.90402212]


portfolio before change:  [10.83703285]
curr_Stock_Price:  97.52657598447549
curr_Factors:  [97.52657598]
mat_Sqrt:  [[0.15]]
grads:  [0.00767148]
Stock Position:  0.007671477656718082
Bond Position:  [10.0888599]


portfolio before change:  [10.83051579]
curr_Stock_Price:  96.5948610305854
curr_Factors:  [96.59486103]
mat_Sqrt:  [[0.15]]
grads:  [0.04688849]
Stock Position:  0.046888490063416194
Bond Position:  [6.30132861]


portfolio before change:  [10.78904074]
curr_Stock_Price:  95.70191483044692
curr_Factors:  [95.70191483]
mat_Sqrt:  [[0.15]]
grads:  [-0.00597794]
Stock Position:  -0.005977941139848597
Bond Position:  [11.36114115]


portfolio before change:  [10.79174524]
curr_Stock_Price:  95.36828746400023
curr_Factors:  [95.36828746]
mat_Sqrt:  [[0.15]]
grads:  [-0.05294199]
Stock Position:  -0.05294199040668902
Bond Position:  [15.8407322]


portfolio before change:  [10.79079393]
curr_Stock_Price:  95.40495745396592
curr_Factors:  [95.40495745]
mat_Sqrt:  [[0.15]]
grads:  [0.08560233]
Stock Position:  0.08560232849282325
Bond Position:  [2.62390742]


portfolio before change:  [10.76107985]
curr_Stock_Price:  95.0559239230979
curr_Factors:  [95.05592392]
mat_Sqrt:  [[0.15]]
grads:  [0.03748592]
Stock Position:  0.03748592320856572
Bond Position:  [7.19782078]


portfolio before change:  [10.76739184]
curr_Stock_Price:  95.21230580131518
curr_Factors:  [95.2123058]
mat_Sqrt:  [[0.15]]
grads:  [0.22506629]
Stock Position:  0.2250662913907231
Bond Position:  [-10.66168872]


portfolio before change:  [10.83216642]
curr_Stock_Price:  95.50306882970257
curr_Factors:  [95.50306883]
mat_Sqrt:  [[0.15]]
grads:  [0.02347324]
Stock Position:  0.023473239084011076
Bond Position:  [8.59040006]


portfolio before change:  [10.84429754]
curr_Stock_Price:  95.99700164664883
curr_Factors:  [95.99700165]
mat_Sqrt:  [[0.15]]
grads:  [0.01150208]
Stock Position:  0.011502083007915241
Bond Position:  [9.74013206]


portfolio before change:  [10.83458249]
curr_Stock_Price:  95.09943988289595
curr_Factors:  [95.09943988]
mat_Sqrt:  [[0.15]]
grads:  [0.03103123]
Stock Position:  0.031031228444015117
Bond Position:  [7.88353005]


portfolio before change:  [10.83098592]
curr_Stock_Price:  94.96765957126355
curr_Factors:  [94.96765957]
mat_Sqrt:  [[0.15]]
grads:  [0.02483099]
Stock Position:  0.024830992990115295
Bond Position:  [8.47284463]


portfolio before change:  [10.83514298]
curr_Stock_Price:  95.11374661103112
curr_Factors:  [95.11374661]
mat_Sqrt:  [[0.15]]
grads:  [0.02578234]
Stock Position:  0.02578234361595419
Bond Position:  [8.38288768]


portfolio before change:  [10.84174542]
curr_Stock_Price:  95.34950852972617
curr_Factors:  [95.34950853]
mat_Sqrt:  [[0.15]]
grads:  [-0.07165092]
Stock Position:  -0.07165092114127712
Bond Position:  [17.67362554]


portfolio before change:  [10.86616795]
curr_Stock_Price:  95.02407102234366
curr_Factors:  [95.02407102]
mat_Sqrt:  [[0.15]]
grads:  [0.00030299]
Stock Position:  0.0003029883136702463
Bond Position:  [10.83737677]


portfolio before change:  [10.86688412]
curr_Stock_Price:  95.1521457449285
curr_Factors:  [95.15214574]
mat_Sqrt:  [[0.15]]
grads:  [0.01054093]
Stock Position:  0.010540933383316077
Bond Position:  [9.86389169]


portfolio before change:  [10.86257347]
curr_Stock_Price:  94.68471499105544
curr_Factors:  [94.68471499]
mat_Sqrt:  [[0.15]]
grads:  [-0.47038752]
Stock Position:  -0.4703875221107299
Bond Position:  [55.40108194]


portfolio before change:  [10.77157173]
curr_Stock_Price:  94.88553754128685
curr_Factors:  [94.88553754]
mat_Sqrt:  [[0.15]]
grads:  [-0.08023441]
Stock Position:  -0.08023440612169036
Bond Position:  [18.38465648]


portfolio before change:  [10.78040564]
curr_Stock_Price:  94.78975771080142
curr_Factors:  [94.78975771]
mat_Sqrt:  [[0.15]]
grads:  [0.12085137]
Stock Position:  0.12085136861184921
Bond Position:  [-0.67506631]


portfolio before change:  [10.82048955]
curr_Stock_Price:  95.12178623145454
curr_Factors:  [95.12178623]
mat_Sqrt:  [[0.15]]
grads:  [0.10593925]
Stock Position:  0.10593925405941701
Bond Position:  [0.74335847]


portfolio before change:  [10.7454965]
curr_Stock_Price:  94.4134603999188
curr_Factors:  [94.4134604]
mat_Sqrt:  [[0.15]]
grads:  [-0.12971231]
Stock Position:  -0.12971230945017947
Bond Position:  [22.99208449]


portfolio before change:  [10.65455352]
curr_Stock_Price:  95.12565210451366
curr_Factors:  [95.1256521]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247523]
Stock Position:  -0.024752302008313697
Bond Position:  [13.00913239]


portfolio before change:  [10.67291678]
curr_Stock_Price:  94.41662047291761
curr_Factors:  [94.41662047]
mat_Sqrt:  [[0.15]]
grads:  [-0.13403647]
Stock Position:  -0.13403647264285873
Bond Position:  [23.32818755]


portfolio before change:  [10.78547371]
curr_Stock_Price:  93.5877500233023
curr_Factors:  [93.58775002]
mat_Sqrt:  [[0.15]]
grads:  [-0.02534257]
Stock Position:  -0.025342574661080197
Bond Position:  [13.15722825]


portfolio before change:  [10.80223359]
curr_Stock_Price:  92.95886664260722
curr_Factors:  [92.95886664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05448548]
Stock Position:  -0.05448547819361151
Bond Position:  [15.86714189]


portfolio before change:  [10.78564065]
curr_Stock_Price:  93.2816070125592
curr_Factors:  [93.28160701]
mat_Sqrt:  [[0.15]]
grads:  [-0.1353241]
Stock Position:  -0.13532410150423474
Bond Position:  [23.40889031]


portfolio before change:  [10.83951857]
curr_Stock_Price:  92.89427896373083
curr_Factors:  [92.89427896]
mat_Sqrt:  [[0.15]]
grads:  [0.10944484]
Stock Position:  0.10944483967268419
Bond Position:  [0.6727191]


portfolio before change:  [10.90938879]
curr_Stock_Price:  93.53230059627177
curr_Factors:  [93.5323006]
mat_Sqrt:  [[0.15]]
grads:  [0.07148805]
Stock Position:  0.0714880451652873
Bond Position:  [4.22294746]


portfolio before change:  [10.93480518]
curr_Stock_Price:  93.8841418245732
curr_Factors:  [93.88414182]
mat_Sqrt:  [[0.15]]
grads:  [0.0840677]
Stock Position:  0.08406769705397324
Bond Position:  [3.04218158]


portfolio before change:  [10.92982861]
curr_Stock_Price:  93.82268291995156
curr_Factors:  [93.82268292]
mat_Sqrt:  [[0.15]]
grads:  [0.02160121]
Stock Position:  0.02160121354027889
Bond Position:  [8.9031448]


portfolio before change:  [10.93360495]
curr_Stock_Price:  93.97174297253213
curr_Factors:  [93.97174297]
mat_Sqrt:  [[0.15]]
grads:  [0.02444826]
Stock Position:  0.024448260810660028
Bond Position:  [8.63615927]


portfolio before change:  [10.93560748]
curr_Stock_Price:  94.03157346018905
curr_Factors:  [94.03157346]
mat_Sqrt:  [[0.15]]
grads:  [0.08887357]
Stock Position:  0.08887356818377969
Bond Position:  [2.57868603]


portfolio before change:  [10.88771143]
curr_Stock_Price:  93.49083643921774
curr_Factors:  [93.49083644]
mat_Sqrt:  [[0.15]]
grads:  [-0.14615999]
Stock Position:  -0.1461599908262632
Bond Position:  [24.55233122]


portfolio before change:  [10.90642609]
curr_Stock_Price:  93.37329336279109
curr_Factors:  [93.37329336]
mat_Sqrt:  [[0.15]]
grads:  [0.03186059]
Stock Position:  0.03186058726115009
Bond Position:  [7.93149813]


portfolio before change:  [10.90563969]
curr_Stock_Price:  93.33305154012915
curr_Factors:  [93.33305154]
mat_Sqrt:  [[0.15]]
grads:  [0.05821332]
Stock Position:  0.0582133227417911
Bond Position:  [5.47241264]


portfolio before change:  [10.88051448]
curr_Stock_Price:  92.89556997402306
curr_Factors:  [92.89556997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.88051448]
Stock Price:  93.19133230681801
PL:  [10.88051448]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.25378279e-03]
 [-3.33792411e-02]
 [-9.98749253e-03]
 [ 4.85452052e-03]
 [-6.53312841e-03]
 [ 1.30641078e-02]
 [ 1.18264960e-03]
 [-2.39760393e-02]
 [-1.62961055e-02]
 [ 2.90943620e-02]
 [-4.66090207e-02]
 [ 3.17014669e-02]
 [-9.77880042e-03]
 [-2.13987077e-03]
 [-7.08995678e-03]
 [ 1.07448911e-02]
 [ 1.33207246e-02]
 [ 2.23246840e-02]
 [ 8.62765997e-04]
 [ 1.53447353e-02]
 [ 1.33266064e-02]
 [-1.22418228e-02]
 [-6.24325843e-04]
 [-8.56032647e-02]
 [-1.35578389e-02]
 [ 1.46502639e-04]
 [ 2.12276910e-03]
 [ 1.09952095e-02]
 [-4.81086436e-02]
 [ 4.90808050e-03]
 [ 1.48767097e-02]
 [-1.44186383e-02]
 [-5.93187112e-03]
 [ 8.80166271e-03]
 [ 1.38088544e-02]
 [-3.67303251e-03]
 [-2.88065264e-02]
 [ 7.24155779e-03]
 [-5.02491636e-02]
 [-1.33549950e-02]
 [-1.62597925e-02]
 [ 6.10025242e-02]
 [ 2.33975272e-02]
 [ 3.27985496e-03]
 [ 9.84370595e-03]
 [ 2.86942094e-02]
 [-2.58712785e-03]
 [-2.41257352e-03]
 [ 2.71769686e-02]
 [ 8.83490653e-03]
 [ 2.42974931e-02]
 [ 1.81479568e-02]
 [-2.27863417e-03]
 [ 4.11117532e-03]
 [ 4.76742564e-03]
 [ 6.95545091e-03]
 [-2.43015084e-02]
 [ 9.29187970e-04]
 [ 1.62901144e-03]
 [-1.15042759e-01]
 [-1.75823305e-02]
 [ 1.74880938e-02]
 [ 1.73002186e-02]
 [-1.97382192e-02]
 [-4.20085297e-03]
 [-1.96569370e-02]
 [-3.80227212e-03]
 [-5.64089379e-03]
 [-2.01219426e-02]
 [ 1.60828541e-02]
 [ 1.02339450e-02]
 [ 1.30133307e-02]
 [ 1.51874398e-03]
 [ 9.84002018e-03]
 [ 2.60969864e-02]
 [-2.55255861e-02]
 [ 4.70922473e-03]
 [ 8.82662628e-03]
 [ 5.22180317e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.4519737]
curr_Stock_Price:  99.70780706642842
curr_Factors:  [99.70780707]
mat_Sqrt:  [[0.15]]
grads:  [0.02169189]
Stock Position:  0.021691885258005025
Bond Position:  [-4.61482401]


portfolio before change:  [-2.47943221]
curr_Stock_Price:  98.45526153638006
curr_Factors:  [98.45526154]
mat_Sqrt:  [[0.15]]
grads:  [-0.22252827]
Stock Position:  -0.2225282742783706
Bond Position:  [19.42964723]


portfolio before change:  [-2.31709216]
curr_Stock_Price:  97.73119329168432
curr_Factors:  [97.73119329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06658328]
Stock Position:  -0.0665832835302089
Bond Position:  [4.19017159]


portfolio before change:  [-2.34227164]
curr_Stock_Price:  98.11329179036281
curr_Factors:  [98.11329179]
mat_Sqrt:  [[0.15]]
grads:  [0.03236347]
Stock Position:  0.03236347013999574
Bond Position:  [-5.51755823]


portfolio before change:  [-2.34463018]
curr_Stock_Price:  98.05107107151849
curr_Factors:  [98.05107107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04355419]
Stock Position:  -0.04355418939961514
Bond Position:  [1.92590474]


portfolio before change:  [-2.35208886]
curr_Stock_Price:  98.22508544181592
curr_Factors:  [98.22508544]
mat_Sqrt:  [[0.15]]
grads:  [0.08709405]
Stock Position:  0.08709405180295615
Bond Position:  [-10.90690954]


portfolio before change:  [-2.26734816]
curr_Stock_Price:  99.205891896322
curr_Factors:  [99.2058919]
mat_Sqrt:  [[0.15]]
grads:  [0.00788433]
Stock Position:  0.007884330680175784
Bond Position:  [-3.04952021]


portfolio before change:  [-2.2752404]
curr_Stock_Price:  98.22906322468435
curr_Factors:  [98.22906322]
mat_Sqrt:  [[0.15]]
grads:  [-0.15984026]
Stock Position:  -0.15984026168401635
Bond Position:  [13.42571877]


portfolio before change:  [-2.21495198]
curr_Stock_Price:  97.85713387616099
curr_Factors:  [97.85713388]
mat_Sqrt:  [[0.15]]
grads:  [-0.1086407]
Stock Position:  -0.10864070317493628
Bond Position:  [8.41631586]


portfolio before change:  [-2.21600065]
curr_Stock_Price:  97.87162851002238
curr_Factors:  [97.87162851]
mat_Sqrt:  [[0.15]]
grads:  [0.19396241]
Stock Position:  0.19396241309868803
Bond Position:  [-21.19941789]


portfolio before change:  [-2.26070232]
curr_Stock_Price:  97.64799412200699
curr_Factors:  [97.64799412]
mat_Sqrt:  [[0.15]]
grads:  [-0.3107268]
Stock Position:  -0.31072680452752466
Bond Position:  [28.08114686]


portfolio before change:  [-2.06849718]
curr_Stock_Price:  97.03507623373143
curr_Factors:  [97.03507623]
mat_Sqrt:  [[0.15]]
grads:  [0.21134311]
Stock Position:  0.21134311239618964
Bond Position:  [-22.5761922]


portfolio before change:  [-2.07686838]
curr_Stock_Price:  97.00214329768451
curr_Factors:  [97.0021433]
mat_Sqrt:  [[0.15]]
grads:  [-0.065192]
Stock Position:  -0.06519200279851686
Bond Position:  [4.24689561]


portfolio before change:  [-2.03421274]
curr_Stock_Price:  96.35190708737287
curr_Factors:  [96.35190709]
mat_Sqrt:  [[0.15]]
grads:  [-0.01426581]
Stock Position:  -0.014265805162634981
Bond Position:  [-0.65967521]


portfolio before change:  [-2.0347027]
curr_Stock_Price:  96.38336208998618
curr_Factors:  [96.38336209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04726638]
Stock Position:  -0.047266378559852384
Bond Position:  [2.52098977]


portfolio before change:  [-2.07446932]
curr_Stock_Price:  97.22802551561496
curr_Factors:  [97.22802552]
mat_Sqrt:  [[0.15]]
grads:  [0.07163261]
Stock Position:  0.07163260727438892
Bond Position:  [-9.03916629]


portfolio before change:  [-2.09860553]
curr_Stock_Price:  96.89896801316577
curr_Factors:  [96.89896801]
mat_Sqrt:  [[0.15]]
grads:  [0.08880483]
Stock Position:  0.08880483050146841
Bond Position:  [-10.70370196]


portfolio before change:  [-2.15534859]
curr_Stock_Price:  96.26753780346242
curr_Factors:  [96.2675378]
mat_Sqrt:  [[0.15]]
grads:  [0.14883123]
Stock Position:  0.1488312268365686
Bond Position:  [-16.48296434]


portfolio before change:  [-2.24785423]
curr_Stock_Price:  95.65291258399057
curr_Factors:  [95.65291258]
mat_Sqrt:  [[0.15]]
grads:  [0.00575177]
Stock Position:  0.0057517733165027085
Bond Position:  [-2.7980281]


portfolio before change:  [-2.24887761]
curr_Stock_Price:  95.50539300470498
curr_Factors:  [95.505393]
mat_Sqrt:  [[0.15]]
grads:  [0.10229824]
Stock Position:  0.10229823557362815
Bond Position:  [-12.0189108]


portfolio before change:  [-2.32553284]
curr_Stock_Price:  94.7634054099399
curr_Factors:  [94.76340541]
mat_Sqrt:  [[0.15]]
grads:  [0.08884404]
Stock Position:  0.08884404234594077
Bond Position:  [-10.74469684]


portfolio before change:  [-2.29621385]
curr_Stock_Price:  95.10096944795899
curr_Factors:  [95.10096945]
mat_Sqrt:  [[0.15]]
grads:  [-0.08161215]
Stock Position:  -0.08161215171225797
Bond Position:  [5.4651809]


portfolio before change:  [-2.34527674]
curr_Stock_Price:  95.70632628038463
curr_Factors:  [95.70632628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00416217]
Stock Position:  -0.004162172288690464
Bond Position:  [-1.94693052]


portfolio before change:  [-2.345687]
curr_Stock_Price:  95.77565792246776
curr_Factors:  [95.77565792]
mat_Sqrt:  [[0.15]]
grads:  [-0.57068843]
Stock Position:  -0.5706884316605629
Bond Position:  [52.31237302]


portfolio before change:  [-1.9541349]
curr_Stock_Price:  95.09528234365087
curr_Factors:  [95.09528234]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038559]
Stock Position:  -0.09038559294100516
Bond Position:  [6.64110858]


portfolio before change:  [-1.95362383]
curr_Stock_Price:  95.09422038919088
curr_Factors:  [95.09422039]
mat_Sqrt:  [[0.15]]
grads:  [0.00097668]
Stock Position:  0.0009766842619117824
Bond Position:  [-2.04650086]


portfolio before change:  [-1.95323091]
curr_Stock_Price:  95.62748889763469
curr_Factors:  [95.6274889]
mat_Sqrt:  [[0.15]]
grads:  [0.01415179]
Stock Position:  0.014151793999857479
Bond Position:  [-3.30653143]


portfolio before change:  [-1.94403316]
curr_Stock_Price:  96.29202756959982
curr_Factors:  [96.29202757]
mat_Sqrt:  [[0.15]]
grads:  [0.0733014]
Stock Position:  0.07330139641610867
Bond Position:  [-9.00237324]


portfolio before change:  [-1.95185598]
curr_Stock_Price:  96.19298224074527
curr_Factors:  [96.19298224]
mat_Sqrt:  [[0.15]]
grads:  [-0.32072429]
Stock Position:  -0.32072429074275455
Bond Position:  [28.89957002]


portfolio before change:  [-1.91096482]
curr_Stock_Price:  96.07111780799234
curr_Factors:  [96.07111781]
mat_Sqrt:  [[0.15]]
grads:  [0.03272054]
Stock Position:  0.0327205366930899
Bond Position:  [-5.05446335]


portfolio before change:  [-1.93932485]
curr_Stock_Price:  95.21403775106712
curr_Factors:  [95.21403775]
mat_Sqrt:  [[0.15]]
grads:  [0.09917806]
Stock Position:  0.09917806459334635
Bond Position:  [-11.38246884]


portfolio before change:  [-2.02976969]
curr_Stock_Price:  94.30926702376975
curr_Factors:  [94.30926702]
mat_Sqrt:  [[0.15]]
grads:  [-0.09612426]
Stock Position:  -0.09612425500622251
Bond Position:  [7.03563834]


portfolio before change:  [-1.94651626]
curr_Stock_Price:  93.44773950103513
curr_Factors:  [93.4477395]
mat_Sqrt:  [[0.15]]
grads:  [-0.03954581]
Stock Position:  -0.03954580749007011
Bond Position:  [1.74895006]


portfolio before change:  [-1.94285812]
curr_Stock_Price:  93.3579999356899
curr_Factors:  [93.35799994]
mat_Sqrt:  [[0.15]]
grads:  [0.05867775]
Stock Position:  0.05867775137752771
Bond Position:  [-7.42089563]


portfolio before change:  [-1.92967964]
curr_Stock_Price:  93.59049519380363
curr_Factors:  [93.59049519]
mat_Sqrt:  [[0.15]]
grads:  [0.09205903]
Stock Position:  0.09205902930755591
Bond Position:  [-10.54552978]


portfolio before change:  [-1.91124992]
curr_Stock_Price:  93.79784954041929
curr_Factors:  [93.79784954]
mat_Sqrt:  [[0.15]]
grads:  [-0.02448688]
Stock Position:  -0.024486883372791847
Bond Position:  [0.38556708]


portfolio before change:  [-1.92107659]
curr_Stock_Price:  94.20013715542993
curr_Factors:  [94.20013716]
mat_Sqrt:  [[0.15]]
grads:  [-0.19204351]
Stock Position:  -0.19204350922806196
Bond Position:  [16.16944832]


portfolio before change:  [-1.81223376]
curr_Stock_Price:  93.63863832012255
curr_Factors:  [93.63863832]
mat_Sqrt:  [[0.15]]
grads:  [0.04827705]
Stock Position:  0.04827705190606291
Bond Position:  [-6.33283116]


portfolio before change:  [-1.80088541]
curr_Stock_Price:  93.88190435072649
curr_Factors:  [93.88190435]
mat_Sqrt:  [[0.15]]
grads:  [-0.33499442]
Stock Position:  -0.3349944239798438
Bond Position:  [29.64902906]


portfolio before change:  [-1.72933855]
curr_Stock_Price:  93.67385987533083
curr_Factors:  [93.67385988]
mat_Sqrt:  [[0.15]]
grads:  [-0.0890333]
Stock Position:  -0.08903329969860671
Bond Position:  [6.61075429]


portfolio before change:  [-1.72241705]
curr_Stock_Price:  93.60076015546686
curr_Factors:  [93.60076016]
mat_Sqrt:  [[0.15]]
grads:  [-0.10839862]
Stock Position:  -0.10839861687481646
Bond Position:  [8.42377589]


portfolio before change:  [-1.79884337]
curr_Stock_Price:  94.3106660692348
curr_Factors:  [94.31066607]
mat_Sqrt:  [[0.15]]
grads:  [0.40668349]
Stock Position:  0.406683494950823
Bond Position:  [-40.15343466]


portfolio before change:  [-1.51502161]
curr_Stock_Price:  95.014730602993
curr_Factors:  [95.0147306]
mat_Sqrt:  [[0.15]]
grads:  [0.15598351]
Stock Position:  0.15598351441311092
Bond Position:  [-16.33575321]


portfolio before change:  [-1.5765015]
curr_Stock_Price:  94.62713279272498
curr_Factors:  [94.62713279]
mat_Sqrt:  [[0.15]]
grads:  [0.0218657]
Stock Position:  0.02186569972248387
Bond Position:  [-3.64558997]


portfolio before change:  [-1.57791753]
curr_Stock_Price:  94.57279308092092
curr_Factors:  [94.57279308]
mat_Sqrt:  [[0.15]]
grads:  [0.06562471]
Stock Position:  0.0656247063459088
Bond Position:  [-7.7842293]


portfolio before change:  [-1.61254373]
curr_Stock_Price:  94.05256716800095
curr_Factors:  [94.05256717]
mat_Sqrt:  [[0.15]]
grads:  [0.19129473]
Stock Position:  0.19129472906698416
Bond Position:  [-19.60430409]


portfolio before change:  [-1.50325893]
curr_Stock_Price:  94.63026269761961
curr_Factors:  [94.6302627]
mat_Sqrt:  [[0.15]]
grads:  [-0.01724752]
Stock Position:  -0.01724751896778861
Bond Position:  [0.12887832]


portfolio before change:  [-1.49627053]
curr_Stock_Price:  94.22554668839156
curr_Factors:  [94.22554669]
mat_Sqrt:  [[0.15]]
grads:  [-0.01608382]
Stock Position:  -0.01608382343572183
Bond Position:  [0.01923653]


portfolio before change:  [-1.48903477]
curr_Stock_Price:  93.77574335282485
curr_Factors:  [93.77574335]
mat_Sqrt:  [[0.15]]
grads:  [0.18117979]
Stock Position:  0.18117979039435933
Bond Position:  [-18.47930429]


portfolio before change:  [-1.59427859]
curr_Stock_Price:  93.20123760932493
curr_Factors:  [93.20123761]
mat_Sqrt:  [[0.15]]
grads:  [0.05889938]
Stock Position:  0.058899376883230554
Bond Position:  [-7.08377341]


portfolio before change:  [-1.60372485]
curr_Stock_Price:  93.0483750360422
curr_Factors:  [93.04837504]
mat_Sqrt:  [[0.15]]
grads:  [0.16198329]
Stock Position:  0.16198328759592742
Bond Position:  [-16.67600654]


portfolio before change:  [-1.60650306]
curr_Stock_Price:  93.03765835680582
curr_Factors:  [93.03765836]
mat_Sqrt:  [[0.15]]
grads:  [0.12098638]
Stock Position:  0.12098637851846616
Bond Position:  [-12.86279241]


portfolio before change:  [-1.73662642]
curr_Stock_Price:  91.96878252206835
curr_Factors:  [91.96878252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01519089]
Stock Position:  -0.015190894473172616
Bond Position:  [-0.33953835]


portfolio before change:  [-1.74012449]
curr_Stock_Price:  92.19765973262469
curr_Factors:  [92.19765973]
mat_Sqrt:  [[0.15]]
grads:  [0.02740784]
Stock Position:  0.027407835451832136
Bond Position:  [-4.26706278]


portfolio before change:  [-1.73437746]
curr_Stock_Price:  92.4170762841586
curr_Factors:  [92.41707628]
mat_Sqrt:  [[0.15]]
grads:  [0.03178284]
Stock Position:  0.03178283763180647
Bond Position:  [-4.67165439]


portfolio before change:  [-1.73863021]
curr_Stock_Price:  92.29245660321658
curr_Factors:  [92.2924566]
mat_Sqrt:  [[0.15]]
grads:  [0.04636967]
Stock Position:  0.04636967272715723
Bond Position:  [-6.01820122]


portfolio before change:  [-1.69391473]
curr_Stock_Price:  93.26489465407631
curr_Factors:  [93.26489465]
mat_Sqrt:  [[0.15]]
grads:  [-0.16201006]
Stock Position:  -0.16201005595346207
Bond Position:  [13.41593607]


portfolio before change:  [-1.67667561]
curr_Stock_Price:  93.16366266456691
curr_Factors:  [93.16366266]
mat_Sqrt:  [[0.15]]
grads:  [0.00619459]
Stock Position:  0.006194586466449787
Bond Position:  [-2.25378597]


portfolio before change:  [-1.67757787]
curr_Stock_Price:  93.04074959607765
curr_Factors:  [93.0407496]
mat_Sqrt:  [[0.15]]
grads:  [0.01086008]
Stock Position:  0.010860076253254056
Bond Position:  [-2.6880075]


portfolio before change:  [-1.67743279]
curr_Stock_Price:  93.0695781750604
curr_Factors:  [93.06957818]
mat_Sqrt:  [[0.15]]
grads:  [-0.76695173]
Stock Position:  -0.7669517290126298
Bond Position:  [69.70244111]


portfolio before change:  [-1.08338769]
curr_Stock_Price:  92.3007050656595
curr_Factors:  [92.30070507]
mat_Sqrt:  [[0.15]]
grads:  [-0.11721554]
Stock Position:  -0.11721553678095377
Bond Position:  [9.735689]


portfolio before change:  [-1.19972333]
curr_Stock_Price:  93.29838967630378
curr_Factors:  [93.29838968]
mat_Sqrt:  [[0.15]]
grads:  [0.11658729]
Stock Position:  0.11658729197447676
Bond Position:  [-12.07712993]


portfolio before change:  [-1.14165981]
curr_Stock_Price:  93.80289031123063
curr_Factors:  [93.80289031]
mat_Sqrt:  [[0.15]]
grads:  [0.11533479]
Stock Position:  0.11533479068391583
Bond Position:  [-11.96039653]


portfolio before change:  [-1.16536814]
curr_Stock_Price:  93.6038109635502
curr_Factors:  [93.60381096]
mat_Sqrt:  [[0.15]]
grads:  [-0.13158813]
Stock Position:  -0.13158812773303516
Bond Position:  [11.1517821]


portfolio before change:  [-1.2489067]
curr_Stock_Price:  94.24395661432422
curr_Factors:  [94.24395661]
mat_Sqrt:  [[0.15]]
grads:  [-0.02800569]
Stock Position:  -0.028005686461070926
Bond Position:  [1.39046]


portfolio before change:  [-1.24085707]
curr_Stock_Price:  93.95963142633055
curr_Factors:  [93.95963143]
mat_Sqrt:  [[0.15]]
grads:  [-0.13104625]
Stock Position:  -0.13104624637969753
Bond Position:  [11.07219994]


portfolio before change:  [-1.19180004]
curr_Stock_Price:  93.5905633213813
curr_Factors:  [93.59056332]
mat_Sqrt:  [[0.15]]
grads:  [-0.02534848]
Stock Position:  -0.025348480781206183
Bond Position:  [1.18057855]


portfolio before change:  [-1.18842038]
curr_Stock_Price:  93.46014632665134
curr_Factors:  [93.46014633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03760596]
Stock Position:  -0.03760595857676267
Bond Position:  [2.32623801]


portfolio before change:  [-1.18421836]
curr_Stock_Price:  93.35227447397288
curr_Factors:  [93.35227447]
mat_Sqrt:  [[0.15]]
grads:  [-0.13414628]
Stock Position:  -0.13414628370238255
Bond Position:  [11.33864233]


portfolio before change:  [-1.1523746]
curr_Stock_Price:  93.12017650070858
curr_Factors:  [93.1201765]
mat_Sqrt:  [[0.15]]
grads:  [0.10721903]
Stock Position:  0.10721902727140428
Bond Position:  [-11.13662934]


portfolio before change:  [-1.09564172]
curr_Stock_Price:  93.65579913622318
curr_Factors:  [93.65579914]
mat_Sqrt:  [[0.15]]
grads:  [0.0682263]
Stock Position:  0.06822630014290058
Bond Position:  [-7.48543038]


portfolio before change:  [-1.15502942]
curr_Stock_Price:  92.79220482128719
curr_Factors:  [92.79220482]
mat_Sqrt:  [[0.15]]
grads:  [0.08675554]
Stock Position:  0.08675553778614394
Bond Position:  [-9.20526705]


portfolio before change:  [-1.24038714]
curr_Stock_Price:  91.81494881365805
curr_Factors:  [91.81494881]
mat_Sqrt:  [[0.15]]
grads:  [0.01012496]
Stock Position:  0.010124959898086499
Bond Position:  [-2.17000981]


portfolio before change:  [-1.24416982]
curr_Stock_Price:  91.4547445284744
curr_Factors:  [91.45474453]
mat_Sqrt:  [[0.15]]
grads:  [0.06560013]
Stock Position:  0.06560013450278719
Bond Position:  [-7.24361336]


portfolio before change:  [-1.19555128]
curr_Stock_Price:  92.2027807437019
curr_Factors:  [92.20278074]
mat_Sqrt:  [[0.15]]
grads:  [0.17397991]
Stock Position:  0.17397990913923533
Bond Position:  [-17.2369827]


portfolio before change:  [-1.1983002]
curr_Stock_Price:  92.19317287623691
curr_Factors:  [92.19317288]
mat_Sqrt:  [[0.15]]
grads:  [-0.17017057]
Stock Position:  -0.17017057428396581
Bond Position:  [14.49026497]


portfolio before change:  [-1.32964329]
curr_Stock_Price:  92.97032696153461
curr_Factors:  [92.97032696]
mat_Sqrt:  [[0.15]]
grads:  [0.03139483]
Stock Position:  0.03139483155197723
Bond Position:  [-4.24843105]


portfolio before change:  [-1.32109016]
curr_Stock_Price:  93.2512223539561
curr_Factors:  [93.25122235]
mat_Sqrt:  [[0.15]]
grads:  [0.05884418]
Stock Position:  0.05884417517826418
Bond Position:  [-6.80838143]


portfolio before change:  [-1.3505324]
curr_Stock_Price:  92.75811148422225
curr_Factors:  [92.75811148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.3505324]
Stock Price:  92.60226428495342
PL:  [-1.3505324]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.43254207e-04]
 [-2.15734071e-04]
 [-3.03710523e-03]
 [ 4.72766821e-03]
 [ 1.26939422e-02]
 [ 2.74559183e-02]
 [ 1.08279227e-03]
 [-1.32315154e-02]
 [ 1.32571904e-02]
 [-3.63520818e-03]
 [ 1.30757357e-02]
 [-1.67766571e-02]
 [ 6.39136206e-04]
 [ 1.20751225e-02]
 [-6.91478897e-03]
 [ 1.30056915e-02]
 [ 8.91363295e-03]
 [-1.22495815e-02]
 [-4.40844324e-04]
 [ 7.99448810e-03]
 [ 1.13967144e-02]
 [-8.06988915e-03]
 [ 8.16215928e-03]
 [ 9.11484635e-03]
 [-8.12251347e-03]
 [-9.44055261e-03]
 [-3.60944793e-03]
 [ 6.19491082e-03]
 [-9.22750815e-03]
 [-2.26427242e-03]
 [ 6.08443347e-04]
 [-1.20714918e-02]
 [ 9.29798982e-03]
 [ 7.96256725e-03]
 [ 1.14394548e-02]
 [ 9.97027820e-03]
 [-3.46612688e-02]
 [ 9.47300275e-03]
 [-8.23867099e-03]
 [ 2.40002429e-02]
 [-6.38244619e-03]
 [-1.32624052e-03]
 [ 2.30317977e-02]
 [ 3.62857217e-03]
 [-8.17480860e-03]
 [-5.08389494e-03]
 [-1.30744973e-05]
 [-1.24974907e-02]
 [-1.26617357e-02]
 [-5.01933203e-03]
 [ 4.71866605e-02]
 [-1.01632537e-02]
 [ 3.33828006e-03]
 [ 5.22686319e-03]
 [ 5.55177532e-03]
 [-2.02814749e-03]
 [ 8.15813375e-03]
 [-6.64511186e-04]
 [ 1.54199321e-03]
 [-1.72598088e-03]
 [-9.30266225e-04]
 [-1.26959590e-03]
 [ 1.28148798e-02]
 [-1.85518989e-02]
 [-5.89229300e-03]
 [-1.43210443e-02]
 [-4.73003147e-03]
 [ 1.43204574e-02]
 [-1.07081207e-02]
 [ 6.93701964e-03]
 [-6.22102749e-03]
 [ 1.09934480e-02]
 [-4.44157509e-03]
 [ 9.22580381e-03]
 [-1.85520392e-02]
 [-5.24294081e-03]
 [-4.50608252e-03]
 [-1.83946760e-03]
 [ 4.73011973e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.81902929]
curr_Stock_Price:  100.50572853145468
curr_Factors:  [100.50572853]
mat_Sqrt:  [[0.15]]
grads:  [-0.00228836]
Stock Position:  -0.0022883613821755885
Bond Position:  [10.04902272]


portfolio before change:  [9.81847677]
curr_Stock_Price:  101.0216425960354
curr_Factors:  [101.0216426]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143823]
Stock Position:  -0.0014382271403186524
Bond Position:  [9.96376884]


portfolio before change:  [9.81963254]
curr_Stock_Price:  100.65104191071926
curr_Factors:  [100.65104191]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024737]
Stock Position:  -0.020247368187081456
Bond Position:  [11.85755124]


portfolio before change:  [9.81527977]
curr_Stock_Price:  100.90262438603312
curr_Factors:  [100.90262439]
mat_Sqrt:  [[0.15]]
grads:  [0.03151779]
Stock Position:  0.031517788046824945
Bond Position:  [6.63505225]


portfolio before change:  [9.82090642]
curr_Stock_Price:  101.06798933961595
curr_Factors:  [101.06798934]
mat_Sqrt:  [[0.15]]
grads:  [0.08462628]
Stock Position:  0.08462628153012153
Bond Position:  [1.2678983]


portfolio before change:  [9.77407538]
curr_Stock_Price:  100.51366652006708
curr_Factors:  [100.51366652]
mat_Sqrt:  [[0.15]]
grads:  [0.18303946]
Stock Position:  0.18303945530703397
Bond Position:  [-8.62389139]


portfolio before change:  [9.81140484]
curr_Stock_Price:  100.72055341138831
curr_Factors:  [100.72055341]
mat_Sqrt:  [[0.15]]
grads:  [0.00721862]
Stock Position:  0.007218615131473584
Bond Position:  [9.08434193]


portfolio before change:  [9.81049167]
curr_Stock_Price:  100.51539530962344
curr_Factors:  [100.51539531]
mat_Sqrt:  [[0.15]]
grads:  [-0.0882101]
Stock Position:  -0.08821010278030904
Bond Position:  [18.67696502]


portfolio before change:  [9.89079276]
curr_Stock_Price:  99.61829006364543
curr_Factors:  [99.61829006]
mat_Sqrt:  [[0.15]]
grads:  [0.08838127]
Stock Position:  0.08838126961720583
Bond Position:  [1.08640181]


portfolio before change:  [9.93018829]
curr_Stock_Price:  100.06326698293464
curr_Factors:  [100.06326698]
mat_Sqrt:  [[0.15]]
grads:  [-0.02423472]
Stock Position:  -0.024234721181811178
Bond Position:  [12.35519366]


portfolio before change:  [9.92926187]
curr_Stock_Price:  100.1333583830799
curr_Factors:  [100.13335838]
mat_Sqrt:  [[0.15]]
grads:  [0.08717157]
Stock Position:  0.08717157103855301
Bond Position:  [1.2004797]


portfolio before change:  [9.95432504]
curr_Stock_Price:  100.42001311819976
curr_Factors:  [100.42001312]
mat_Sqrt:  [[0.15]]
grads:  [-0.11184438]
Stock Position:  -0.1118443809203358
Bond Position:  [21.18573924]


portfolio before change:  [9.99155172]
curr_Stock_Price:  100.09900880385074
curr_Factors:  [100.0990088]
mat_Sqrt:  [[0.15]]
grads:  [0.00426091]
Stock Position:  0.004260908042317454
Bond Position:  [9.56503905]


portfolio before change:  [9.9900972]
curr_Stock_Price:  99.61733807230121
curr_Factors:  [99.61733807]
mat_Sqrt:  [[0.15]]
grads:  [0.08050082]
Stock Position:  0.08050081669718294
Bond Position:  [1.97082013]


portfolio before change:  [10.04228022]
curr_Stock_Price:  100.26403762887794
curr_Factors:  [100.26403763]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609859]
Stock Position:  -0.046098593163601626
Bond Position:  [14.6643113]


portfolio before change:  [10.04627904]
curr_Stock_Price:  100.19717504956033
curr_Factors:  [100.19717505]
mat_Sqrt:  [[0.15]]
grads:  [0.08670461]
Stock Position:  0.08670460992709406
Bond Position:  [1.35872206]


portfolio before change:  [10.07132593]
curr_Stock_Price:  100.48507163619176
curr_Factors:  [100.48507164]
mat_Sqrt:  [[0.15]]
grads:  [0.05942422]
Stock Position:  0.059424219652077136
Bond Position:  [4.10007896]


portfolio before change:  [10.05957999]
curr_Stock_Price:  100.28309673833971
curr_Factors:  [100.28309674]
mat_Sqrt:  [[0.15]]
grads:  [-0.08166388]
Stock Position:  -0.08166387649605623
Bond Position:  [18.24908641]


portfolio before change:  [10.03072361]
curr_Stock_Price:  100.65041925493577
curr_Factors:  [100.65041925]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293896]
Stock Position:  -0.0029389621587800367
Bond Position:  [10.32653138]


portfolio before change:  [10.03208317]
curr_Stock_Price:  100.407430793888
curr_Factors:  [100.40743079]
mat_Sqrt:  [[0.15]]
grads:  [0.05329659]
Stock Position:  0.053296587342378965
Bond Position:  [4.68070977]


portfolio before change:  [10.01182361]
curr_Stock_Price:  100.0218129187136
curr_Factors:  [100.02181292]
mat_Sqrt:  [[0.15]]
grads:  [0.0759781]
Stock Position:  0.07597809593495805
Bond Position:  [2.41235671]


portfolio before change:  [9.99019721]
curr_Stock_Price:  99.73518849043592
curr_Factors:  [99.73518849]
mat_Sqrt:  [[0.15]]
grads:  [-0.05379926]
Stock Position:  -0.05379926101669111
Bond Position:  [15.35587665]


portfolio before change:  [10.03238552]
curr_Stock_Price:  98.9688481701547
curr_Factors:  [98.96884817]
mat_Sqrt:  [[0.15]]
grads:  [0.0544144]
Stock Position:  0.054414395188328024
Bond Position:  [4.64705551]


portfolio before change:  [10.01194534]
curr_Stock_Price:  98.58787121000549
curr_Factors:  [98.58787121]
mat_Sqrt:  [[0.15]]
grads:  [0.06076564]
Stock Position:  0.060765642359667804
Bond Position:  [4.02119002]


portfolio before change:  [10.00500007]
curr_Stock_Price:  98.46943913367616
curr_Factors:  [98.46943913]
mat_Sqrt:  [[0.15]]
grads:  [-0.05415009]
Stock Position:  -0.0541500898007391
Bond Position:  [15.33712905]


portfolio before change:  [10.02972122]
curr_Stock_Price:  98.03061174917775
curr_Factors:  [98.03061175]
mat_Sqrt:  [[0.15]]
grads:  [-0.06293702]
Stock Position:  -0.06293701738929132
Bond Position:  [16.19947553]


portfolio before change:  [10.02060744]
curr_Stock_Price:  98.19150712459927
curr_Factors:  [98.19150712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02406299]
Stock Position:  -0.024062986220334915
Bond Position:  [12.38338832]


portfolio before change:  [9.99957744]
curr_Stock_Price:  99.09762848241878
curr_Factors:  [99.09762848]
mat_Sqrt:  [[0.15]]
grads:  [0.04129941]
Stock Position:  0.041299405453374925
Bond Position:  [5.9069043]


portfolio before change:  [10.0142491]
curr_Stock_Price:  99.44394027364375
curr_Factors:  [99.44394027]
mat_Sqrt:  [[0.15]]
grads:  [-0.06151672]
Stock Position:  -0.06151672098135624
Bond Position:  [16.13171423]


portfolio before change:  [9.99658715]
curr_Stock_Price:  99.74743859050731
curr_Factors:  [99.74743859]
mat_Sqrt:  [[0.15]]
grads:  [-0.01509515]
Stock Position:  -0.01509514944582819
Bond Position:  [11.50228964]


portfolio before change:  [9.99671997]
curr_Stock_Price:  99.7862649476053
curr_Factors:  [99.78626495]
mat_Sqrt:  [[0.15]]
grads:  [0.00405629]
Stock Position:  0.004056288982258906
Bond Position:  [9.59195805]


portfolio before change:  [10.00102132]
curr_Stock_Price:  100.69887901356061
curr_Factors:  [100.69887901]
mat_Sqrt:  [[0.15]]
grads:  [-0.08047661]
Stock Position:  -0.08047661196024299
Bond Position:  [18.10492593]


portfolio before change:  [9.97070234]
curr_Stock_Price:  101.0896828966983
curr_Factors:  [101.0896829]
mat_Sqrt:  [[0.15]]
grads:  [0.0619866]
Stock Position:  0.061986598773808764
Bond Position:  [3.70449672]


portfolio before change:  [9.98861758]
curr_Stock_Price:  101.37496557938536
curr_Factors:  [101.37496558]
mat_Sqrt:  [[0.15]]
grads:  [0.05308378]
Stock Position:  0.05308378168798866
Bond Position:  [4.60725104]


portfolio before change:  [9.95186117]
curr_Stock_Price:  100.67711840853725
curr_Factors:  [100.67711841]
mat_Sqrt:  [[0.15]]
grads:  [0.07626303]
Stock Position:  0.07626303227073031
Bond Position:  [2.27391884]


portfolio before change:  [9.94635485]
curr_Stock_Price:  100.60305306482338
curr_Factors:  [100.60305306]
mat_Sqrt:  [[0.15]]
grads:  [0.06646852]
Stock Position:  0.06646852131619599
Bond Position:  [3.25941867]


portfolio before change:  [9.90960319]
curr_Stock_Price:  100.04706989437707
curr_Factors:  [100.04706989]
mat_Sqrt:  [[0.15]]
grads:  [-0.23107513]
Stock Position:  -0.2310751252987217
Bond Position:  [33.0279924]


portfolio before change:  [10.0513964]
curr_Stock_Price:  99.44237956764911
curr_Factors:  [99.44237957]
mat_Sqrt:  [[0.15]]
grads:  [0.06315335]
Stock Position:  0.06315335166381103
Bond Position:  [3.77127683]


portfolio before change:  [10.09289459]
curr_Stock_Price:  100.09574923607416
curr_Factors:  [100.09574924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05492447]
Stock Position:  -0.05492447328633701
Bond Position:  [15.5906009]


portfolio before change:  [10.09255315]
curr_Stock_Price:  100.11970737949767
curr_Factors:  [100.11970738]
mat_Sqrt:  [[0.15]]
grads:  [0.16000162]
Stock Position:  0.16000161950806396
Bond Position:  [-5.92676218]


portfolio before change:  [10.10787356]
curr_Stock_Price:  100.21777417796598
curr_Factors:  [100.21777418]
mat_Sqrt:  [[0.15]]
grads:  [-0.04254964]
Stock Position:  -0.04254964123769088
Bond Position:  [14.3721039]


portfolio before change:  [10.15065981]
curr_Stock_Price:  99.23332489798362
curr_Factors:  [99.2333249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0088416]
Stock Position:  -0.008841603499277323
Bond Position:  [11.02804152]


portfolio before change:  [10.15555445]
curr_Stock_Price:  98.75769146009127
curr_Factors:  [98.75769146]
mat_Sqrt:  [[0.15]]
grads:  [0.15354532]
Stock Position:  0.15354531795783552
Bond Position:  [-5.00822669]


portfolio before change:  [10.3767472]
curr_Stock_Price:  100.20029991250598
curr_Factors:  [100.20029991]
mat_Sqrt:  [[0.15]]
grads:  [0.02419048]
Stock Position:  0.024190481150206996
Bond Position:  [7.95285373]


portfolio before change:  [10.36362157]
curr_Stock_Price:  99.63715706426143
curr_Factors:  [99.63715706]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449872]
Stock Position:  -0.054498723966763765
Bond Position:  [15.79371949]


portfolio before change:  [10.37514224]
curr_Stock_Price:  99.44387673150936
curr_Factors:  [99.44387673]
mat_Sqrt:  [[0.15]]
grads:  [-0.03389263]
Stock Position:  -0.03389263292447115
Bond Position:  [13.74555705]


portfolio before change:  [10.38855416]
curr_Stock_Price:  99.0735072298534
curr_Factors:  [99.07350723]
mat_Sqrt:  [[0.15]]
grads:  [-8.71633155e-05]
Stock Position:  -8.716331546166726e-05
Bond Position:  [10.39718973]


portfolio before change:  [10.38916215]
curr_Stock_Price:  99.55373567308638
curr_Factors:  [99.55373567]
mat_Sqrt:  [[0.15]]
grads:  [-0.0833166]
Stock Position:  -0.08331660443797329
Bond Position:  [18.68364136]


portfolio before change:  [10.39638549]
curr_Stock_Price:  99.48105418227058
curr_Factors:  [99.48105418]
mat_Sqrt:  [[0.15]]
grads:  [-0.08441157]
Stock Position:  -0.08441157114714878
Bond Position:  [18.79373757]


portfolio before change:  [10.45775563]
curr_Stock_Price:  98.76793516735519
curr_Factors:  [98.76793517]
mat_Sqrt:  [[0.15]]
grads:  [-0.03346221]
Stock Position:  -0.03346221352396613
Bond Position:  [13.76274936]


portfolio before change:  [10.46352345]
curr_Stock_Price:  98.62127360874595
curr_Factors:  [98.62127361]
mat_Sqrt:  [[0.15]]
grads:  [0.31457774]
Stock Position:  0.31457773655240545
Bond Position:  [-20.56053358]


portfolio before change:  [10.49053588]
curr_Stock_Price:  98.71122754071864
curr_Factors:  [98.71122754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06775502]
Stock Position:  -0.06775502493078797
Bond Position:  [17.17871756]


portfolio before change:  [10.51548316]
curr_Stock_Price:  98.3588761241771
curr_Factors:  [98.35887612]
mat_Sqrt:  [[0.15]]
grads:  [0.0222552]
Stock Position:  0.02225520041291006
Bond Position:  [8.32648666]


portfolio before change:  [10.51145044]
curr_Stock_Price:  98.15428825806792
curr_Factors:  [98.15428826]
mat_Sqrt:  [[0.15]]
grads:  [0.03484575]
Stock Position:  0.03484575456989855
Bond Position:  [7.0911902]


portfolio before change:  [10.52439826]
curr_Stock_Price:  98.51314430828286
curr_Factors:  [98.51314431]
mat_Sqrt:  [[0.15]]
grads:  [0.03701184]
Stock Position:  0.037011835442599055
Bond Position:  [6.87824597]


portfolio before change:  [10.5003369]
curr_Stock_Price:  97.85143003380372
curr_Factors:  [97.85143003]
mat_Sqrt:  [[0.15]]
grads:  [-0.01352098]
Stock Position:  -0.013520983244610998
Bond Position:  [11.82338445]


portfolio before change:  [10.4960309]
curr_Stock_Price:  98.22455288379525
curr_Factors:  [98.22455288]
mat_Sqrt:  [[0.15]]
grads:  [0.05438756]
Stock Position:  0.05438755836314649
Bond Position:  [5.1538373]


portfolio before change:  [10.46613122]
curr_Stock_Price:  97.66887782522788
curr_Factors:  [97.66887783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00443007]
Stock Position:  -0.004430074574197185
Bond Position:  [10.89881163]


portfolio before change:  [10.46213524]
curr_Stock_Price:  98.72465584923783
curr_Factors:  [98.72465585]
mat_Sqrt:  [[0.15]]
grads:  [0.01027995]
Stock Position:  0.010279954764294812
Bond Position:  [9.44725024]


portfolio before change:  [10.45273134]
curr_Stock_Price:  97.75243654078835
curr_Factors:  [97.75243654]
mat_Sqrt:  [[0.15]]
grads:  [-0.01150654]
Stock Position:  -0.01150653919863881
Bond Position:  [11.57752358]


portfolio before change:  [10.45332577]
curr_Stock_Price:  97.76366373762008
curr_Factors:  [97.76366374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620177]
Stock Position:  -0.006201774836415083
Bond Position:  [11.059634]


portfolio before change:  [10.449138]
curr_Stock_Price:  98.55037652690164
curr_Factors:  [98.55037653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00846397]
Stock Position:  -0.008463972646824205
Bond Position:  [11.28326569]


portfolio before change:  [10.46054263]
curr_Stock_Price:  97.2862655648634
curr_Factors:  [97.28626556]
mat_Sqrt:  [[0.15]]
grads:  [0.08543253]
Stock Position:  0.08543253208366797
Bond Position:  [2.14913063]


portfolio before change:  [10.43771091]
curr_Stock_Price:  97.01744476710331
curr_Factors:  [97.01744477]
mat_Sqrt:  [[0.15]]
grads:  [-0.12367933]
Stock Position:  -0.12367932620480938
Bond Position:  [22.43676311]


portfolio before change:  [10.50935137]
curr_Stock_Price:  96.44953972443035
curr_Factors:  [96.44953972]
mat_Sqrt:  [[0.15]]
grads:  [-0.03928195]
Stock Position:  -0.039281953332294284
Bond Position:  [14.29807769]


portfolio before change:  [10.51675066]
curr_Stock_Price:  96.28392578641703
curr_Factors:  [96.28392579]
mat_Sqrt:  [[0.15]]
grads:  [-0.09547363]
Stock Position:  -0.09547362855098843
Bond Position:  [19.70932643]


portfolio before change:  [10.45904333]
curr_Stock_Price:  96.90126075176619
curr_Factors:  [96.90126075]
mat_Sqrt:  [[0.15]]
grads:  [-0.03153354]
Stock Position:  -0.03153354312737144
Bond Position:  [13.51468341]


portfolio before change:  [10.45826035]
curr_Stock_Price:  96.95287803103895
curr_Factors:  [96.95287803]
mat_Sqrt:  [[0.15]]
grads:  [0.09546972]
Stock Position:  0.09546971579631745
Bond Position:  [1.20219663]


portfolio before change:  [10.48806885]
curr_Stock_Price:  97.26432094914747
curr_Factors:  [97.26432095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07138747]
Stock Position:  -0.07138747133465298
Bond Position:  [17.43152278]


portfolio before change:  [10.43439024]
curr_Stock_Price:  98.03151607704358
curr_Factors:  [98.03151608]
mat_Sqrt:  [[0.15]]
grads:  [0.0462468]
Stock Position:  0.046246797630840775
Bond Position:  [5.90074655]


portfolio before change:  [10.45101557]
curr_Stock_Price:  98.3830327575468
curr_Factors:  [98.38303276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04147352]
Stock Position:  -0.041473516625140816
Bond Position:  [14.53130591]


portfolio before change:  [10.44653771]
curr_Stock_Price:  98.512900954432
curr_Factors:  [98.51290095]
mat_Sqrt:  [[0.15]]
grads:  [0.07328965]
Stock Position:  0.07328965340574047
Bond Position:  [3.22656134]


portfolio before change:  [10.47223623]
curr_Stock_Price:  98.8607925478683
curr_Factors:  [98.86079255]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296105]
Stock Position:  -0.029610500626840175
Bond Position:  [13.39955379]


portfolio before change:  [10.46514747]
curr_Stock_Price:  99.12847653333463
curr_Factors:  [99.12847653]
mat_Sqrt:  [[0.15]]
grads:  [0.06150536]
Stock Position:  0.06150535872198699
Bond Position:  [4.36821496]


portfolio before change:  [10.4512732]
curr_Stock_Price:  98.89845929991553
curr_Factors:  [98.8984593]
mat_Sqrt:  [[0.15]]
grads:  [-0.12368026]
Stock Position:  -0.12368026138032832
Bond Position:  [22.6830605]


portfolio before change:  [10.44439603]
curr_Stock_Price:  98.96552663222059
curr_Factors:  [98.96552663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03495294]
Stock Position:  -0.03495293871797602
Bond Position:  [13.90353202]


portfolio before change:  [10.42651863]
curr_Stock_Price:  99.50185919257522
curr_Factors:  [99.50185919]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004055]
Stock Position:  -0.03004055011563725
Bond Position:  [13.41560922]


portfolio before change:  [10.43022735]
curr_Stock_Price:  99.40631427790592
curr_Factors:  [99.40631428]
mat_Sqrt:  [[0.15]]
grads:  [-0.01226312]
Stock Position:  -0.012263117301925315
Bond Position:  [11.64925865]


portfolio before change:  [10.41800556]
curr_Stock_Price:  100.46231785792689
curr_Factors:  [100.46231786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.41800556]
Stock Price:  100.36219555134285
PL:  [10.05581001]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.41511358e-04]
 [ 2.50417463e-03]
 [-4.66154551e-04]
 [ 5.46725391e-03]
 [ 4.25963930e-03]
 [ 2.78929433e-02]
 [ 1.03146073e-03]
 [-1.64501397e-02]
 [ 2.17807002e-02]
 [ 8.68681400e-05]
 [ 1.43162566e-02]
 [-1.06301697e-02]
 [-1.21673399e-03]
 [ 3.39694731e-03]
 [-6.91977978e-03]
 [ 1.09258518e-02]
 [ 7.33354338e-03]
 [-1.12691246e-02]
 [ 2.45712934e-04]
 [ 1.35404878e-02]
 [ 1.18417509e-02]
 [-7.95043173e-03]
 [ 7.42387152e-03]
 [ 3.74919017e-02]
 [ 6.65539231e-04]
 [ 1.24381288e-02]
 [-6.27269928e-03]
 [ 8.66038231e-03]
 [ 2.23079797e-02]
 [-1.79436748e-03]
 [ 1.00716771e-02]
 [-1.21683291e-02]
 [ 2.64198484e-03]
 [ 6.56504631e-03]
 [ 1.17950198e-02]
 [ 1.31040462e-02]
 [-3.47447558e-02]
 [ 9.36127114e-03]
 [-1.44240706e-02]
 [ 2.46354120e-02]
 [-4.95425863e-03]
 [-6.48502451e-03]
 [ 2.33648418e-02]
 [ 3.95501559e-03]
 [-8.21817570e-03]
 [-5.88920664e-03]
 [ 1.17772054e-03]
 [-1.24163003e-02]
 [-9.03301063e-03]
 [-5.43766846e-03]
 [ 4.72971428e-02]
 [-1.00635056e-02]
 [ 3.46533912e-03]
 [ 5.07133990e-03]
 [ 4.17802711e-03]
 [ 1.05471796e-03]
 [-1.73667650e-03]
 [-5.76803405e-04]
 [ 1.53283222e-03]
 [-1.08588930e-02]
 [-2.07654117e-03]
 [ 2.20505168e-03]
 [ 1.00626126e-02]
 [-1.81750518e-02]
 [-1.32092821e-02]
 [-4.09422257e-04]
 [-5.14357553e-03]
 [ 2.44204958e-02]
 [-8.43172128e-03]
 [ 8.96385617e-03]
 [-1.06065545e-02]
 [ 1.09751346e-02]
 [-8.30324945e-03]
 [ 1.39815515e-02]
 [-2.10045183e-02]
 [-4.26802503e-03]
 [-3.28545044e-03]
 [-7.14947831e-04]
 [-1.00490026e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.96173633]
curr_Stock_Price:  100.51500805117813
curr_Factors:  [100.51500805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227674]
Stock Position:  -0.0022767423837707942
Bond Position:  [10.19058311]


portfolio before change:  [9.96250524]
curr_Stock_Price:  100.45704343872839
curr_Factors:  [100.45704344]
mat_Sqrt:  [[0.15]]
grads:  [0.0166945]
Stock Position:  0.016694497549010468
Bond Position:  [8.28542537]


portfolio before change:  [9.95935294]
curr_Stock_Price:  100.23720160157144
curr_Factors:  [100.2372016]
mat_Sqrt:  [[0.15]]
grads:  [-0.0031077]
Stock Position:  -0.003107697009187086
Bond Position:  [10.27085979]


portfolio before change:  [9.958463]
curr_Stock_Price:  100.7301348606424
curr_Factors:  [100.73013486]
mat_Sqrt:  [[0.15]]
grads:  [0.03644836]
Stock Position:  0.03644835943059863
Bond Position:  [6.28701484]


portfolio before change:  [9.95051494]
curr_Stock_Price:  100.50129024183532
curr_Factors:  [100.50129024]
mat_Sqrt:  [[0.15]]
grads:  [0.0283976]
Stock Position:  0.0283975953115734
Bond Position:  [7.09651997]


portfolio before change:  [9.95342816]
curr_Stock_Price:  100.58825771652613
curr_Factors:  [100.58825772]
mat_Sqrt:  [[0.15]]
grads:  [0.18595296]
Stock Position:  0.18595295537979922
Bond Position:  [-8.75125564]


portfolio before change:  [9.71478309]
curr_Stock_Price:  99.30783654884996
curr_Factors:  [99.30783655]
mat_Sqrt:  [[0.15]]
grads:  [0.0068764]
Stock Position:  0.0068764048799099
Bond Position:  [9.03190219]


portfolio before change:  [9.72107393]
curr_Stock_Price:  100.14058781104198
curr_Factors:  [100.14058781]
mat_Sqrt:  [[0.15]]
grads:  [-0.1096676]
Stock Position:  -0.10966759775709772
Bond Position:  [20.70325163]


portfolio before change:  [9.71259075]
curr_Stock_Price:  100.22974065436706
curr_Factors:  [100.22974065]
mat_Sqrt:  [[0.15]]
grads:  [0.14520467]
Stock Position:  0.14520466772921867
Bond Position:  [-4.84123544]


portfolio before change:  [9.64786124]
curr_Stock_Price:  99.78604337024333
curr_Factors:  [99.78604337]
mat_Sqrt:  [[0.15]]
grads:  [0.00057912]
Stock Position:  0.0005791209335317035
Bond Position:  [9.59007306]


portfolio before change:  [9.64876312]
curr_Stock_Price:  100.30834555098453
curr_Factors:  [100.30834555]
mat_Sqrt:  [[0.15]]
grads:  [0.09544171]
Stock Position:  0.095441710931784
Bond Position:  [0.075163]


portfolio before change:  [9.62664545]
curr_Stock_Price:  100.07655626132987
curr_Factors:  [100.07655626]
mat_Sqrt:  [[0.15]]
grads:  [-0.0708678]
Stock Position:  -0.07086779793646711
Bond Position:  [16.71885062]


portfolio before change:  [9.64626286]
curr_Stock_Price:  99.81448451437542
curr_Factors:  [99.81448451]
mat_Sqrt:  [[0.15]]
grads:  [-0.00811156]
Stock Position:  -0.008111559902030132
Bond Position:  [10.45591403]


portfolio before change:  [9.64393934]
curr_Stock_Price:  100.18149521258667
curr_Factors:  [100.18149521]
mat_Sqrt:  [[0.15]]
grads:  [0.02264632]
Stock Position:  0.022646315400197917
Bond Position:  [7.37519761]


portfolio before change:  [9.62959324]
curr_Stock_Price:  99.52765515378547
curr_Factors:  [99.52765515]
mat_Sqrt:  [[0.15]]
grads:  [-0.04613187]
Stock Position:  -0.046131865222585014
Bond Position:  [14.22098961]


portfolio before change:  [9.6212175]
curr_Stock_Price:  99.72848326952588
curr_Factors:  [99.72848327]
mat_Sqrt:  [[0.15]]
grads:  [0.07283901]
Stock Position:  0.07283901190025313
Bond Position:  [2.35709332]


portfolio before change:  [9.6129595]
curr_Stock_Price:  99.6130873230854
curr_Factors:  [99.61308732]
mat_Sqrt:  [[0.15]]
grads:  [0.04889029]
Stock Position:  0.048890289207193655
Bond Position:  [4.74284685]


portfolio before change:  [9.59213076]
curr_Stock_Price:  99.18099374748923
curr_Factors:  [99.18099375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0751275]
Stock Position:  -0.07512749763481401
Bond Position:  [17.04335063]


portfolio before change:  [9.60892626]
curr_Stock_Price:  98.97161290430395
curr_Factors:  [98.9716129]
mat_Sqrt:  [[0.15]]
grads:  [0.00163809]
Stock Position:  0.0016380862263004267
Bond Position:  [9.44680222]


portfolio before change:  [9.60955968]
curr_Stock_Price:  98.99784617836622
curr_Factors:  [98.99784618]
mat_Sqrt:  [[0.15]]
grads:  [0.09026992]
Stock Position:  0.09026991859250703
Bond Position:  [0.67303216]


portfolio before change:  [9.59209405]
curr_Stock_Price:  98.80389794503691
curr_Factors:  [98.80389795]
mat_Sqrt:  [[0.15]]
grads:  [0.07894501]
Stock Position:  0.07894500586177887
Bond Position:  [1.79201975]


portfolio before change:  [9.63138135]
curr_Stock_Price:  99.30013325094217
curr_Factors:  [99.30013325]
mat_Sqrt:  [[0.15]]
grads:  [-0.05300288]
Stock Position:  -0.05300287818422814
Bond Position:  [14.89457422]


portfolio before change:  [9.62117549]
curr_Stock_Price:  99.51025018104966
curr_Factors:  [99.51025018]
mat_Sqrt:  [[0.15]]
grads:  [0.04949248]
Stock Position:  0.04949247677060971
Bond Position:  [4.69616675]


portfolio before change:  [9.62627132]
curr_Stock_Price:  99.60728119217754
curr_Factors:  [99.60728119]
mat_Sqrt:  [[0.15]]
grads:  [0.24994601]
Stock Position:  0.24994601147391146
Bond Position:  [-15.27017133]


portfolio before change:  [9.93089343]
curr_Stock_Price:  100.82985133687208
curr_Factors:  [100.82985134]
mat_Sqrt:  [[0.15]]
grads:  [0.00443693]
Stock Position:  0.004436928204379527
Bond Position:  [9.48351862]


portfolio before change:  [9.93343928]
curr_Stock_Price:  101.27004623645794
curr_Factors:  [101.27004624]
mat_Sqrt:  [[0.15]]
grads:  [0.08292086]
Stock Position:  0.08292085886618293
Bond Position:  [1.53604007]


portfolio before change:  [9.89323086]
curr_Stock_Price:  100.78398723546826
curr_Factors:  [100.78398724]
mat_Sqrt:  [[0.15]]
grads:  [-0.041818]
Stock Position:  -0.04181799521441514
Bond Position:  [14.10781516]


portfolio before change:  [9.86008134]
curr_Stock_Price:  101.59778242388488
curr_Factors:  [101.59778242]
mat_Sqrt:  [[0.15]]
grads:  [0.05773588]
Stock Position:  0.05773588209801469
Bond Position:  [3.99424375]


portfolio before change:  [9.8641652]
curr_Stock_Price:  101.6641919385634
curr_Factors:  [101.66419194]
mat_Sqrt:  [[0.15]]
grads:  [0.14871986]
Stock Position:  0.14871986468712328
Bond Position:  [-5.25531967]


portfolio before change:  [9.84555158]
curr_Stock_Price:  101.54124159176791
curr_Factors:  [101.54124159]
mat_Sqrt:  [[0.15]]
grads:  [-0.01196245]
Stock Position:  -0.011962449886372835
Bond Position:  [11.06023359]


portfolio before change:  [9.84829201]
curr_Stock_Price:  101.36994286881549
curr_Factors:  [101.36994287]
mat_Sqrt:  [[0.15]]
grads:  [0.06714451]
Stock Position:  0.0671445140253618
Bond Position:  [3.04185646]


portfolio before change:  [9.79037433]
curr_Stock_Price:  100.50452881252166
curr_Factors:  [100.50452881]
mat_Sqrt:  [[0.15]]
grads:  [-0.08112219]
Stock Position:  -0.081122194139372
Bond Position:  [17.94352223]


portfolio before change:  [9.8230529]
curr_Stock_Price:  100.11552220110262
curr_Factors:  [100.1155222]
mat_Sqrt:  [[0.15]]
grads:  [0.01761323]
Stock Position:  0.01761323226567864
Bond Position:  [8.05969496]


portfolio before change:  [9.83023278]
curr_Stock_Price:  100.4945625803678
curr_Factors:  [100.49456258]
mat_Sqrt:  [[0.15]]
grads:  [0.04376698]
Stock Position:  0.043766975402402326
Bond Position:  [5.43188973]


portfolio before change:  [9.79929256]
curr_Stock_Price:  99.77987491661676
curr_Factors:  [99.77987492]
mat_Sqrt:  [[0.15]]
grads:  [0.07863347]
Stock Position:  0.07863346519989156
Bond Position:  [1.95325524]


portfolio before change:  [9.79789333]
curr_Stock_Price:  99.76052792400787
curr_Factors:  [99.76052792]
mat_Sqrt:  [[0.15]]
grads:  [0.08736031]
Stock Position:  0.08736030821552065
Bond Position:  [1.08278286]


portfolio before change:  [9.81469737]
curr_Stock_Price:  99.9521065755068
curr_Factors:  [99.95210658]
mat_Sqrt:  [[0.15]]
grads:  [-0.23163171]
Stock Position:  -0.23163170539796618
Bond Position:  [32.96677428]


portfolio before change:  [9.99631994]
curr_Stock_Price:  99.17690147255747
curr_Factors:  [99.17690147]
mat_Sqrt:  [[0.15]]
grads:  [0.06240847]
Stock Position:  0.062408474245870635
Bond Position:  [3.80684084]


portfolio before change:  [9.99780392]
curr_Stock_Price:  99.19686750104401
curr_Factors:  [99.1968675]
mat_Sqrt:  [[0.15]]
grads:  [-0.09616047]
Stock Position:  -0.09616047040532741
Bond Position:  [19.53662136]


portfolio before change:  [9.95993204]
curr_Stock_Price:  99.60340624548267
curr_Factors:  [99.60340625]
mat_Sqrt:  [[0.15]]
grads:  [0.16423608]
Stock Position:  0.1642360802898937
Bond Position:  [-6.39854098]


portfolio before change:  [9.85845466]
curr_Stock_Price:  98.98796617963255
curr_Factors:  [98.98796618]
mat_Sqrt:  [[0.15]]
grads:  [-0.03302839]
Stock Position:  -0.03302839086419691
Bond Position:  [13.1278679]


portfolio before change:  [9.83729461]
curr_Stock_Price:  99.65347135365279
curr_Factors:  [99.65347135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0432335]
Stock Position:  -0.043233496733480876
Bond Position:  [14.14566264]


portfolio before change:  [9.84611605]
curr_Stock_Price:  99.46987966229362
curr_Factors:  [99.46987966]
mat_Sqrt:  [[0.15]]
grads:  [0.15576561]
Stock Position:  0.15576561181624862
Bond Position:  [-5.64787061]


portfolio before change:  [9.89751769]
curr_Stock_Price:  99.80213936425712
curr_Factors:  [99.80213936]
mat_Sqrt:  [[0.15]]
grads:  [0.02636677]
Stock Position:  0.026366770568045702
Bond Position:  [7.26605757]


portfolio before change:  [9.88702291]
curr_Stock_Price:  99.3868849060644
curr_Factors:  [99.38688491]
mat_Sqrt:  [[0.15]]
grads:  [-0.05478784]
Stock Position:  -0.054787837984874695
Bond Position:  [15.33221546]


portfolio before change:  [9.92967375]
curr_Stock_Price:  98.62590308694274
curr_Factors:  [98.62590309]
mat_Sqrt:  [[0.15]]
grads:  [-0.03926138]
Stock Position:  -0.03926137762126136
Bond Position:  [13.80186258]


portfolio before change:  [9.94873297]
curr_Stock_Price:  98.16243030388145
curr_Factors:  [98.1624303]
mat_Sqrt:  [[0.15]]
grads:  [0.00785147]
Stock Position:  0.007851470261004597
Bond Position:  [9.17801357]


portfolio before change:  [9.9547608]
curr_Stock_Price:  98.85710099779962
curr_Factors:  [98.857101]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277534]
Stock Position:  -0.08277533531939531
Bond Position:  [18.13769049]


portfolio before change:  [9.98131326]
curr_Stock_Price:  98.55001904182608
curr_Factors:  [98.55001904]
mat_Sqrt:  [[0.15]]
grads:  [-0.06022007]
Stock Position:  -0.06022007084245514
Bond Position:  [15.91600239]


portfolio before change:  [9.95906206]
curr_Stock_Price:  98.93603619275099
curr_Factors:  [98.93603619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03625112]
Stock Position:  -0.03625112307866764
Bond Position:  [13.54560448]


portfolio before change:  [9.9646142]
curr_Stock_Price:  98.80623292637938
curr_Factors:  [98.80623293]
mat_Sqrt:  [[0.15]]
grads:  [0.31531429]
Stock Position:  0.31531428531254196
Bond Position:  [-21.19040252]


portfolio before change:  [9.94818632]
curr_Stock_Price:  98.75833329079146
curr_Factors:  [98.75833329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06709004]
Stock Position:  -0.0670900372907122
Bond Position:  [16.57388658]


portfolio before change:  [9.96585628]
curr_Stock_Price:  98.51039698248393
curr_Factors:  [98.51039698]
mat_Sqrt:  [[0.15]]
grads:  [0.02310226]
Stock Position:  0.023102260773472
Bond Position:  [7.6900434]


portfolio before change:  [9.93892739]
curr_Stock_Price:  97.32395348702907
curr_Factors:  [97.32395349]
mat_Sqrt:  [[0.15]]
grads:  [0.03380893]
Stock Position:  0.033808932676183845
Bond Position:  [6.6485084]


portfolio before change:  [9.91662187]
curr_Stock_Price:  96.65191014050943
curr_Factors:  [96.65191014]
mat_Sqrt:  [[0.15]]
grads:  [0.02785351]
Stock Position:  0.027853514048206164
Bond Position:  [7.22452653]


portfolio before change:  [9.91545928]
curr_Stock_Price:  96.59395942941006
curr_Factors:  [96.59395943]
mat_Sqrt:  [[0.15]]
grads:  [0.00703145]
Stock Position:  0.0070314530532737795
Bond Position:  [9.23626339]


portfolio before change:  [9.9170312]
curr_Stock_Price:  96.7354134719163
curr_Factors:  [96.73541347]
mat_Sqrt:  [[0.15]]
grads:  [-0.01157784]
Stock Position:  -0.011577843354056648
Bond Position:  [11.03701866]


portfolio before change:  [9.91397836]
curr_Stock_Price:  97.05867500423028
curr_Factors:  [97.058675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00384536]
Stock Position:  -0.0038453560325267485
Bond Position:  [10.28720352]


portfolio before change:  [9.91067942]
curr_Stock_Price:  98.08378308327241
curr_Factors:  [98.08378308]
mat_Sqrt:  [[0.15]]
grads:  [0.01021888]
Stock Position:  0.010218881479476053
Bond Position:  [8.90837287]


portfolio before change:  [9.89994548]
curr_Stock_Price:  96.97889311638572
curr_Factors:  [96.97889312]
mat_Sqrt:  [[0.15]]
grads:  [-0.07239262]
Stock Position:  -0.07239262025217004
Bond Position:  [16.92050166]


portfolio before change:  [9.87170835]
curr_Stock_Price:  97.38355714673767
curr_Factors:  [97.38355715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384361]
Stock Position:  -0.013843607820077005
Bond Position:  [11.21984812]


portfolio before change:  [9.86496188]
curr_Stock_Price:  97.92154798901264
curr_Factors:  [97.92154799]
mat_Sqrt:  [[0.15]]
grads:  [0.01470034]
Stock Position:  0.014700344557364981
Bond Position:  [8.42548138]


portfolio before change:  [9.86315666]
curr_Stock_Price:  97.76292417892638
curr_Factors:  [97.76292418]
mat_Sqrt:  [[0.15]]
grads:  [0.06708408]
Stock Position:  0.06708408381929785
Bond Position:  [3.30482046]


portfolio before change:  [9.86625497]
curr_Stock_Price:  97.80603058159852
curr_Factors:  [97.80603058]
mat_Sqrt:  [[0.15]]
grads:  [-0.12116701]
Stock Position:  -0.1211670122602245
Bond Position:  [21.71711948]


portfolio before change:  [9.75324145]
curr_Stock_Price:  98.7499416351946
curr_Factors:  [98.74994164]
mat_Sqrt:  [[0.15]]
grads:  [-0.08806188]
Stock Position:  -0.08806188035348347
Bond Position:  [18.449347]


portfolio before change:  [9.71693145]
curr_Stock_Price:  99.1753597540601
curr_Factors:  [99.17535975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00272948]
Stock Position:  -0.00272948171358559
Bond Position:  [9.98762879]


portfolio before change:  [9.71648811]
curr_Stock_Price:  99.56649216076089
curr_Factors:  [99.56649216]
mat_Sqrt:  [[0.15]]
grads:  [-0.0342905]
Stock Position:  -0.03429050352780671
Bond Position:  [13.13067326]


portfolio before change:  [9.69794605]
curr_Stock_Price:  100.13116024921658
curr_Factors:  [100.13116025]
mat_Sqrt:  [[0.15]]
grads:  [0.16280331]
Stock Position:  0.1628033051923587
Bond Position:  [-6.60373779]


portfolio before change:  [9.70676489]
curr_Stock_Price:  100.1878641400756
curr_Factors:  [100.18786414]
mat_Sqrt:  [[0.15]]
grads:  [-0.05621148]
Stock Position:  -0.05621147522128916
Bond Position:  [15.33847253]


portfolio before change:  [9.6543603]
curr_Stock_Price:  101.13719470766804
curr_Factors:  [101.13719471]
mat_Sqrt:  [[0.15]]
grads:  [0.05975904]
Stock Position:  0.05975904110402689
Bond Position:  [3.61049852]


portfolio before change:  [9.62756756]
curr_Stock_Price:  100.68507227734392
curr_Factors:  [100.68507228]
mat_Sqrt:  [[0.15]]
grads:  [-0.07071036]
Stock Position:  -0.07071036343684273
Bond Position:  [16.74704561]


portfolio before change:  [9.64558368]
curr_Stock_Price:  100.44508761845162
curr_Factors:  [100.44508762]
mat_Sqrt:  [[0.15]]
grads:  [0.07316756]
Stock Position:  0.07316756419486273
Bond Position:  [2.29626129]


portfolio before change:  [9.68351679]
curr_Stock_Price:  100.96156761797384
curr_Factors:  [100.96156762]
mat_Sqrt:  [[0.15]]
grads:  [-0.055355]
Stock Position:  -0.055354996331341624
Bond Position:  [15.27224399]


portfolio before change:  [9.73041088]
curr_Stock_Price:  100.13165979901851
curr_Factors:  [100.1316598]
mat_Sqrt:  [[0.15]]
grads:  [0.09321034]
Stock Position:  0.09321034311992847
Bond Position:  [0.39710451]


portfolio before change:  [9.70853643]
curr_Stock_Price:  99.89671518580639
curr_Factors:  [99.89671519]
mat_Sqrt:  [[0.15]]
grads:  [-0.14003012]
Stock Position:  -0.1400301219587121
Bond Position:  [23.69708564]


portfolio before change:  [9.73765791]
curr_Stock_Price:  99.69932649255576
curr_Factors:  [99.69932649]
mat_Sqrt:  [[0.15]]
grads:  [-0.0284535]
Stock Position:  -0.028453500191873822
Bond Position:  [12.57445271]


portfolio before change:  [9.75137053]
curr_Stock_Price:  99.24501714705984
curr_Factors:  [99.24501715]
mat_Sqrt:  [[0.15]]
grads:  [-0.021903]
Stock Position:  -0.021903002929204125
Bond Position:  [11.92513443]


portfolio before change:  [9.75659052]
curr_Stock_Price:  99.04072340555763
curr_Factors:  [99.04072341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00476632]
Stock Position:  -0.0047663188760765475
Bond Position:  [10.22865019]


portfolio before change:  [9.76167155]
curr_Stock_Price:  98.1088252840151
curr_Factors:  [98.10882528]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.76167155]
Stock Price:  98.0975015670416
PL:  [9.76167155]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.18689729e-04]
 [ 3.05398850e-03]
 [-3.84258451e-03]
 [ 6.47828096e-03]
 [ 4.35968426e-03]
 [ 2.43716895e-02]
 [ 8.12653790e-04]
 [-1.77539889e-02]
 [ 9.23248063e-03]
 [ 1.89728798e-02]
 [ 1.28328990e-02]
 [-1.99973981e-02]
 [ 1.87735327e-02]
 [ 7.72268635e-03]
 [-6.91430383e-03]
 [ 1.71309142e-02]
 [ 1.05625111e-02]
 [-1.16245722e-02]
 [-6.50544193e-04]
 [-4.43948256e-03]
 [ 1.16028543e-02]
 [-7.81801895e-03]
 [ 8.17813797e-03]
 [ 6.80073841e-03]
 [-8.07336899e-03]
 [ 8.04570988e-04]
 [-7.07896100e-03]
 [ 5.65961681e-03]
 [-9.59519102e-03]
 [-2.00100758e-03]
 [-4.44866543e-03]
 [-1.03145505e-02]
 [-5.06372264e-03]
 [ 4.48229636e-03]
 [ 1.28813023e-02]
 [ 1.74105484e-02]
 [-3.44779798e-02]
 [ 8.73830147e-03]
 [-2.46771614e-02]
 [ 2.19692105e-02]
 [-5.24120284e-03]
 [ 5.21567853e-03]
 [ 2.30420100e-02]
 [ 4.33542759e-03]
 [-7.57785650e-03]
 [-5.05773835e-03]
 [ 1.85620368e-03]
 [-1.19280767e-02]
 [ 1.41984961e-03]
 [ 2.46788205e-04]
 [ 3.90023283e-02]
 [-4.05394172e-03]
 [ 2.81021444e-03]
 [ 5.22243402e-03]
 [ 5.48889601e-03]
 [-2.87828902e-03]
 [ 8.04890379e-03]
 [-5.72675431e-04]
 [ 1.53801394e-03]
 [ 2.19642272e-03]
 [ 1.26358066e-03]
 [-9.17603370e-03]
 [ 5.43332308e-03]
 [-1.78341215e-02]
 [-1.19875400e-02]
 [-3.16326905e-03]
 [-4.81173298e-03]
 [ 2.24086151e-02]
 [-8.85276571e-03]
 [ 8.43012867e-03]
 [-1.13665113e-02]
 [ 1.17039957e-02]
 [-4.33289486e-03]
 [ 1.93031323e-02]
 [-2.24828640e-02]
 [-2.74351101e-03]
 [-8.25107321e-03]
 [-1.48308396e-03]
 [ 1.05400163e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.8990114]
curr_Stock_Price:  100.18580457032033
curr_Factors:  [100.18580457]
mat_Sqrt:  [[0.15]]
grads:  [0.00479126]
Stock Position:  0.004791264859222658
Bond Position:  [4.41899467]


portfolio before change:  [4.89956993]
curr_Stock_Price:  100.24473167806494
curr_Factors:  [100.24473168]
mat_Sqrt:  [[0.15]]
grads:  [0.02035992]
Stock Position:  0.020359923355782863
Bond Position:  [2.85859487]


portfolio before change:  [4.91215047]
curr_Stock_Price:  100.85386343146777
curr_Factors:  [100.85386343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02561723]
Stock Position:  -0.025617230082231043
Bond Position:  [7.4957471]


portfolio before change:  [4.92272229]
curr_Stock_Price:  100.45946777993002
curr_Factors:  [100.45946778]
mat_Sqrt:  [[0.15]]
grads:  [0.04318854]
Stock Position:  0.04318853973335839
Bond Position:  [0.58402458]


portfolio before change:  [4.90083287]
curr_Stock_Price:  99.95178836905144
curr_Factors:  [99.95178837]
mat_Sqrt:  [[0.15]]
grads:  [0.02906456]
Stock Position:  0.029064561717332002
Bond Position:  [1.99577794]


portfolio before change:  [4.90310506]
curr_Stock_Price:  100.02567420675958
curr_Factors:  [100.02567421]
mat_Sqrt:  [[0.15]]
grads:  [0.16247793]
Stock Position:  0.16247792985524073
Bond Position:  [-11.34885941]


portfolio before change:  [4.80973473]
curr_Stock_Price:  99.45537517162523
curr_Factors:  [99.45537517]
mat_Sqrt:  [[0.15]]
grads:  [0.00541769]
Stock Position:  0.005417691933783363
Bond Position:  [4.27091615]


portfolio before change:  [4.80975387]
curr_Stock_Price:  99.40963480093404
curr_Factors:  [99.4096348]
mat_Sqrt:  [[0.15]]
grads:  [-0.11835993]
Stock Position:  -0.11835992598479665
Bond Position:  [16.57587088]


portfolio before change:  [4.82365428]
curr_Stock_Price:  99.30094608818668
curr_Factors:  [99.30094609]
mat_Sqrt:  [[0.15]]
grads:  [0.06154987]
Stock Position:  0.06154987087442061
Bond Position:  [-1.28830613]


portfolio before change:  [4.82214694]
curr_Stock_Price:  99.27776465095877
curr_Factors:  [99.27776465]
mat_Sqrt:  [[0.15]]
grads:  [0.12648587]
Stock Position:  0.12648586548848975
Bond Position:  [-7.73508704]


portfolio before change:  [4.92017936]
curr_Stock_Price:  100.05663329281276
curr_Factors:  [100.05663329]
mat_Sqrt:  [[0.15]]
grads:  [0.08555266]
Stock Position:  0.08555266001762543
Bond Position:  [-3.63993177]


portfolio before change:  [4.96858652]
curr_Stock_Price:  100.62510966848616
curr_Factors:  [100.62510967]
mat_Sqrt:  [[0.15]]
grads:  [-0.13331599]
Stock Position:  -0.1333159872412684
Bond Position:  [18.38352236]


portfolio before change:  [4.94921862]
curr_Stock_Price:  100.77900650945962
curr_Factors:  [100.77900651]
mat_Sqrt:  [[0.15]]
grads:  [0.12515688]
Stock Position:  0.12515688458655352
Bond Position:  [-7.66396787]


portfolio before change:  [4.83909247]
curr_Stock_Price:  99.90292898355638
curr_Factors:  [99.90292898]
mat_Sqrt:  [[0.15]]
grads:  [0.05148458]
Stock Position:  0.05148457563427776
Bond Position:  [-0.30436743]


portfolio before change:  [4.85168609]
curr_Stock_Price:  100.14790794468654
curr_Factors:  [100.14790794]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609536]
Stock Position:  -0.0460953588777289
Bond Position:  [9.46803984]


portfolio before change:  [4.82912245]
curr_Stock_Price:  100.65024489913267
curr_Factors:  [100.6502449]
mat_Sqrt:  [[0.15]]
grads:  [0.11420609]
Stock Position:  0.11420609464191314
Bond Position:  [-6.66574894]


portfolio before change:  [4.87178087]
curr_Stock_Price:  101.02741420689945
curr_Factors:  [101.02741421]
mat_Sqrt:  [[0.15]]
grads:  [0.07041674]
Stock Position:  0.07041674037292162
Bond Position:  [-2.24224033]


portfolio before change:  [4.84766521]
curr_Stock_Price:  100.6869339512803
curr_Factors:  [100.68693395]
mat_Sqrt:  [[0.15]]
grads:  [-0.07749715]
Stock Position:  -0.07749714770607731
Bond Position:  [12.6506154]


portfolio before change:  [4.82126773]
curr_Stock_Price:  101.03776199320515
curr_Factors:  [101.03776199]
mat_Sqrt:  [[0.15]]
grads:  [-0.00433696]
Stock Position:  -0.004336961288155822
Bond Position:  [5.25946459]


portfolio before change:  [4.82027131]
curr_Stock_Price:  101.34330744446196
curr_Factors:  [101.34330744]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959655]
Stock Position:  -0.029596550419614145
Bond Position:  [7.81968362]


portfolio before change:  [4.85326169]
curr_Stock_Price:  100.2451514731589
curr_Factors:  [100.24515147]
mat_Sqrt:  [[0.15]]
grads:  [0.07735236]
Stock Position:  0.07735236181619096
Bond Position:  [-2.90093754]


portfolio before change:  [4.84850553]
curr_Stock_Price:  100.18600860768393
curr_Factors:  [100.18600861]
mat_Sqrt:  [[0.15]]
grads:  [-0.05212013]
Stock Position:  -0.052120126338142704
Bond Position:  [10.07021296]


portfolio before change:  [4.91145891]
curr_Stock_Price:  98.99023307728099
curr_Factors:  [98.99023308]
mat_Sqrt:  [[0.15]]
grads:  [0.05452092]
Stock Position:  0.05452091979168278
Bond Position:  [-0.48557964]


portfolio before change:  [4.88362103]
curr_Stock_Price:  98.48019894916403
curr_Factors:  [98.48019895]
mat_Sqrt:  [[0.15]]
grads:  [0.04533826]
Stock Position:  0.045338256086560294
Bond Position:  [0.41870056]


portfolio before change:  [4.89853476]
curr_Stock_Price:  98.80856530145304
curr_Factors:  [98.8085653]
mat_Sqrt:  [[0.15]]
grads:  [-0.05382246]
Stock Position:  -0.05382245991007488
Bond Position:  [10.21665481]


portfolio before change:  [4.87254918]
curr_Stock_Price:  99.30323137748991
curr_Factors:  [99.30323138]
mat_Sqrt:  [[0.15]]
grads:  [0.00536381]
Stock Position:  0.005363806584641947
Bond Position:  [4.33990585]


portfolio before change:  [4.87457878]
curr_Stock_Price:  99.63104863410787
curr_Factors:  [99.63104863]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719307]
Stock Position:  -0.04719307333330987
Bond Position:  [9.57647416]


portfolio before change:  [4.86459085]
curr_Stock_Price:  99.85537140286682
curr_Factors:  [99.8553714]
mat_Sqrt:  [[0.15]]
grads:  [0.03773078]
Stock Position:  0.037730778708873376
Bond Position:  [1.09696992]


portfolio before change:  [4.84632256]
curr_Stock_Price:  99.36937952130428
curr_Factors:  [99.36937952]
mat_Sqrt:  [[0.15]]
grads:  [-0.06396794]
Stock Position:  -0.06396794013681838
Bond Position:  [11.20277708]


portfolio before change:  [4.83359655]
curr_Stock_Price:  99.57926901548392
curr_Factors:  [99.57926902]
mat_Sqrt:  [[0.15]]
grads:  [-0.01334005]
Stock Position:  -0.013340050530966884
Bond Position:  [6.16198903]


portfolio before change:  [4.83726985]
curr_Stock_Price:  99.33278100363852
curr_Factors:  [99.332781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02965777]
Stock Position:  -0.0296577695653873
Bond Position:  [7.78325858]


portfolio before change:  [4.83504109]
curr_Stock_Price:  99.42433301809315
curr_Factors:  [99.42433302]
mat_Sqrt:  [[0.15]]
grads:  [-0.06876367]
Stock Position:  -0.06876366981434442
Bond Position:  [11.6718231]


portfolio before change:  [4.8610163]
curr_Stock_Price:  99.05719587783709
curr_Factors:  [99.05719588]
mat_Sqrt:  [[0.15]]
grads:  [-0.03375815]
Stock Position:  -0.033758150955100465
Bond Position:  [8.20500407]


portfolio before change:  [4.86076461]
curr_Stock_Price:  99.07984296411993
curr_Factors:  [99.07984296]
mat_Sqrt:  [[0.15]]
grads:  [0.02988198]
Stock Position:  0.029881975703481486
Bond Position:  [1.90006315]


portfolio before change:  [4.83485268]
curr_Stock_Price:  98.20872646819504
curr_Factors:  [98.20872647]
mat_Sqrt:  [[0.15]]
grads:  [0.08587535]
Stock Position:  0.08587534865202716
Bond Position:  [-3.59885594]


portfolio before change:  [4.83862995]
curr_Stock_Price:  98.25533122345985
curr_Factors:  [98.25533122]
mat_Sqrt:  [[0.15]]
grads:  [0.11607032]
Stock Position:  0.11607032261631059
Bond Position:  [-6.56589805]


portfolio before change:  [4.798534]
curr_Stock_Price:  97.91342155919968
curr_Factors:  [97.91342156]
mat_Sqrt:  [[0.15]]
grads:  [-0.2298532]
Stock Position:  -0.2298531984557167
Bond Position:  [27.30424712]


portfolio before change:  [4.84184817]
curr_Stock_Price:  97.73240338891044
curr_Factors:  [97.73240339]
mat_Sqrt:  [[0.15]]
grads:  [0.05825534]
Stock Position:  0.05825534314412109
Bond Position:  [-0.85158652]


portfolio before change:  [4.83165839]
curr_Stock_Price:  97.55840117470862
curr_Factors:  [97.55840117]
mat_Sqrt:  [[0.15]]
grads:  [-0.16451441]
Stock Position:  -0.1645144095849134
Bond Position:  [20.88142116]


portfolio before change:  [4.71360408]
curr_Stock_Price:  98.28392693405371
curr_Factors:  [98.28392693]
mat_Sqrt:  [[0.15]]
grads:  [0.1464614]
Stock Position:  0.14646140317909132
Bond Position:  [-9.68119777]


portfolio before change:  [4.74109437]
curr_Stock_Price:  98.47575487727704
curr_Factors:  [98.47575488]
mat_Sqrt:  [[0.15]]
grads:  [-0.03494135]
Stock Position:  -0.034941352236455
Bond Position:  [8.18197041]


portfolio before change:  [4.73957536]
curr_Stock_Price:  98.53386373570903
curr_Factors:  [98.53386374]
mat_Sqrt:  [[0.15]]
grads:  [0.03477119]
Stock Position:  0.03477119020876138
Bond Position:  [1.31343564]


portfolio before change:  [4.72241155]
curr_Stock_Price:  98.0378811303516
curr_Factors:  [98.03788113]
mat_Sqrt:  [[0.15]]
grads:  [0.1536134]
Stock Position:  0.15361340005533022
Bond Position:  [-10.33752071]


portfolio before change:  [4.66916603]
curr_Stock_Price:  97.69546698974264
curr_Factors:  [97.69546699]
mat_Sqrt:  [[0.15]]
grads:  [0.02890285]
Stock Position:  0.02890285057044112
Bond Position:  [1.84548855]


portfolio before change:  [4.70736807]
curr_Stock_Price:  99.01321557179303
curr_Factors:  [99.01321557]
mat_Sqrt:  [[0.15]]
grads:  [-0.05051904]
Stock Position:  -0.05051904330655838
Bond Position:  [9.70942099]


portfolio before change:  [4.73405327]
curr_Stock_Price:  98.49700742504231
curr_Factors:  [98.49700743]
mat_Sqrt:  [[0.15]]
grads:  [-0.03371826]
Stock Position:  -0.033718255650188184
Bond Position:  [8.05520055]


portfolio before change:  [4.7697633]
curr_Stock_Price:  97.45286784221071
curr_Factors:  [97.45286784]
mat_Sqrt:  [[0.15]]
grads:  [0.01237469]
Stock Position:  0.01237469120861481
Bond Position:  [3.56381415]


portfolio before change:  [4.76950964]
curr_Stock_Price:  97.41436971347281
curr_Factors:  [97.41436971]
mat_Sqrt:  [[0.15]]
grads:  [-0.07952051]
Stock Position:  -0.07952051135248574
Bond Position:  [12.51595013]


portfolio before change:  [4.82687761]
curr_Stock_Price:  96.70278358176792
curr_Factors:  [96.70278358]
mat_Sqrt:  [[0.15]]
grads:  [0.00946566]
Stock Position:  0.009465664074110054
Bond Position:  [3.91152154]


portfolio before change:  [4.82970512]
curr_Stock_Price:  96.97566863097153
curr_Factors:  [96.97566863]
mat_Sqrt:  [[0.15]]
grads:  [0.00164525]
Stock Position:  0.0016452547003497262
Bond Position:  [4.67015545]


portfolio before change:  [4.82906827]
curr_Stock_Price:  96.41116619841382
curr_Factors:  [96.4111662]
mat_Sqrt:  [[0.15]]
grads:  [0.26001552]
Stock Position:  0.26001552183436105
Bond Position:  [-20.23933142]


portfolio before change:  [4.92368154]
curr_Stock_Price:  96.7799067732582
curr_Factors:  [96.77990677]
mat_Sqrt:  [[0.15]]
grads:  [-0.02702628]
Stock Position:  -0.0270262781126687
Bond Position:  [7.53928222]


portfolio before change:  [4.89901951]
curr_Stock_Price:  97.70986291033444
curr_Factors:  [97.70986291]
mat_Sqrt:  [[0.15]]
grads:  [0.01873476]
Stock Position:  0.018734762916286306
Bond Position:  [3.06844839]


portfolio before change:  [4.90709447]
curr_Stock_Price:  98.13064104404327
curr_Factors:  [98.13064104]
mat_Sqrt:  [[0.15]]
grads:  [0.03481623]
Stock Position:  0.03481622678173253
Bond Position:  [1.49055582]


portfolio before change:  [4.91765137]
curr_Stock_Price:  98.43118289858573
curr_Factors:  [98.4311829]
mat_Sqrt:  [[0.15]]
grads:  [0.03659264]
Stock Position:  0.036592640058968534
Bond Position:  [1.31579452]


portfolio before change:  [4.9209767]
curr_Stock_Price:  98.51980994574136
curr_Factors:  [98.51980995]
mat_Sqrt:  [[0.15]]
grads:  [-0.01918859]
Stock Position:  -0.01918859347150966
Bond Position:  [6.81143329]


portfolio before change:  [4.92558447]
curr_Stock_Price:  98.30186587144397
curr_Factors:  [98.30186587]
mat_Sqrt:  [[0.15]]
grads:  [0.05365936]
Stock Position:  0.0536593585755098
Bond Position:  [-0.3492306]


portfolio before change:  [4.91646788]
curr_Stock_Price:  98.13237509270867
curr_Factors:  [98.13237509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381784]
Stock Position:  -0.0038178362070839756
Bond Position:  [5.29112121]


portfolio before change:  [4.91560015]
curr_Stock_Price:  98.44627914784868
curr_Factors:  [98.44627915]
mat_Sqrt:  [[0.15]]
grads:  [0.01025343]
Stock Position:  0.010253426285517538
Bond Position:  [3.90618848]


portfolio before change:  [4.9141195]
curr_Stock_Price:  98.27806238316444
curr_Factors:  [98.27806238]
mat_Sqrt:  [[0.15]]
grads:  [0.01464282]
Stock Position:  0.01464281813803446
Bond Position:  [3.4750517]


portfolio before change:  [4.92503336]
curr_Stock_Price:  99.00856818466104
curr_Factors:  [99.00856818]
mat_Sqrt:  [[0.15]]
grads:  [0.00842387]
Stock Position:  0.008423871065191489
Bond Position:  [4.09099794]


portfolio before change:  [4.92991804]
curr_Stock_Price:  99.55807661398418
curr_Factors:  [99.55807661]
mat_Sqrt:  [[0.15]]
grads:  [-0.06117356]
Stock Position:  -0.06117355800286692
Bond Position:  [11.02023981]


portfolio before change:  [5.0017747]
curr_Stock_Price:  98.3947002620711
curr_Factors:  [98.39470026]
mat_Sqrt:  [[0.15]]
grads:  [0.03622215]
Stock Position:  0.03622215388886579
Bond Position:  [1.43770672]


portfolio before change:  [4.99763948]
curr_Stock_Price:  98.27805682772542
curr_Factors:  [98.27805683]
mat_Sqrt:  [[0.15]]
grads:  [-0.11889414]
Stock Position:  -0.1188941434982434
Bond Position:  [16.68232487]


portfolio before change:  [4.98890055]
curr_Stock_Price:  98.36032841357905
curr_Factors:  [98.36032841]
mat_Sqrt:  [[0.15]]
grads:  [-0.07991693]
Stock Position:  -0.07991693333293817
Bond Position:  [12.84955636]


portfolio before change:  [4.98607766]
curr_Stock_Price:  98.4057006933656
curr_Factors:  [98.40570069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02108846]
Stock Position:  -0.0210884603430065
Bond Position:  [7.06130237]


portfolio before change:  [4.99408492]
curr_Stock_Price:  98.04693032107194
curr_Factors:  [98.04693032]
mat_Sqrt:  [[0.15]]
grads:  [-0.03207822]
Stock Position:  -0.03207821983826724
Bond Position:  [8.1392559]


portfolio before change:  [4.96029522]
curr_Stock_Price:  99.11614240405868
curr_Factors:  [99.1161424]
mat_Sqrt:  [[0.15]]
grads:  [0.14939077]
Stock Position:  0.14939076718909092
Bond Position:  [-9.84674134]


portfolio before change:  [5.0114002]
curr_Stock_Price:  99.46235140390849
curr_Factors:  [99.4623514]
mat_Sqrt:  [[0.15]]
grads:  [-0.05901844]
Stock Position:  -0.05901843808962418
Bond Position:  [10.88151283]


portfolio before change:  [4.95147532]
curr_Stock_Price:  100.48923384792442
curr_Factors:  [100.48923385]
mat_Sqrt:  [[0.15]]
grads:  [0.05620086]
Stock Position:  0.05620085776790837
Bond Position:  [-0.69610582]


portfolio before change:  [5.02862556]
curr_Stock_Price:  101.86276716373031
curr_Factors:  [101.86276716]
mat_Sqrt:  [[0.15]]
grads:  [-0.07577674]
Stock Position:  -0.07577674195663754
Bond Position:  [12.74745419]


portfolio before change:  [5.03443577]
curr_Stock_Price:  101.79660613944284
curr_Factors:  [101.79660614]
mat_Sqrt:  [[0.15]]
grads:  [0.07802664]
Stock Position:  0.07802663772739275
Bond Position:  [-2.90841114]


portfolio before change:  [5.01115179]
curr_Stock_Price:  101.50052514988613
curr_Factors:  [101.50052515]
mat_Sqrt:  [[0.15]]
grads:  [-0.02888597]
Stock Position:  -0.028885965714334657
Bond Position:  [7.94309248]


portfolio before change:  [5.00215541]
curr_Stock_Price:  101.8291565456112
curr_Factors:  [101.82915655]
mat_Sqrt:  [[0.15]]
grads:  [0.12868755]
Stock Position:  0.1286875489664134
Bond Position:  [-8.10198916]


portfolio before change:  [4.9539758]
curr_Stock_Price:  101.45869944712746
curr_Factors:  [101.45869945]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988576]
Stock Position:  -0.1498857596920224
Bond Position:  [20.16119005]


portfolio before change:  [4.90171758]
curr_Stock_Price:  101.81576031885913
curr_Factors:  [101.81576032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01829007]
Stock Position:  -0.018290073399730655
Bond Position:  [6.76393531]


portfolio before change:  [4.92437523]
curr_Stock_Price:  100.60007951833045
curr_Factors:  [100.60007952]
mat_Sqrt:  [[0.15]]
grads:  [-0.05500715]
Stock Position:  -0.055007154758623944
Bond Position:  [10.45809937]


portfolio before change:  [4.90858117]
curr_Stock_Price:  100.89908990104273
curr_Factors:  [100.8990899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00988723]
Stock Position:  -0.0098872264276198
Bond Position:  [5.90619332]


portfolio before change:  [4.90787458]
curr_Stock_Price:  101.00789095699416
curr_Factors:  [101.00789096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.90787458]
Stock Price:  101.2310115266036
PL:  [3.67686305]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.32518482e-04]
 [ 2.53896822e-03]
 [-2.77307094e-03]
 [ 1.51071226e-03]
 [ 1.42919300e-02]
 [ 2.68833280e-02]
 [ 3.49318803e-03]
 [ 1.17354624e-02]
 [ 2.45055286e-02]
 [-4.34800009e-03]
 [ 1.32539023e-02]
 [-2.41087441e-02]
 [ 2.05971703e-02]
 [ 8.26760168e-04]
 [-6.91517335e-03]
 [ 1.77705875e-02]
 [ 9.84558994e-03]
 [-1.05760506e-02]
 [ 5.74584874e-04]
 [-5.66108266e-03]
 [ 1.31766173e-02]
 [-3.40194936e-03]
 [ 8.87549528e-03]
 [ 2.57151411e-03]
 [ 1.51818765e-03]
 [ 1.28925384e-02]
 [-6.67590926e-03]
 [ 6.16242225e-03]
 [-1.56489735e-02]
 [-8.87219593e-05]
 [-6.48544972e-03]
 [-1.02399064e-02]
 [-6.65151615e-03]
 [ 4.54376357e-03]
 [ 1.22457101e-02]
 [ 1.44099576e-02]
 [-3.46645110e-02]
 [ 9.14109423e-03]
 [-1.30913715e-02]
 [ 2.45944402e-02]
 [-4.95033614e-03]
 [ 3.50837875e-03]
 [ 2.30418877e-02]
 [ 4.49378672e-03]
 [-2.22329746e-03]
 [ 6.46824284e-03]
 [ 2.52991733e-04]
 [-1.00883592e-02]
 [ 6.80754344e-03]
 [ 3.53665418e-03]
 [ 3.67123859e-02]
 [-3.24306383e-05]
 [ 1.84634061e-03]
 [ 4.80626445e-03]
 [ 3.41775003e-03]
 [ 3.74062467e-03]
 [-1.13736156e-02]
 [ 4.65058652e-04]
 [ 1.60754880e-03]
 [-8.58250567e-02]
 [-1.37550526e-02]
 [ 1.78714592e-02]
 [ 1.66134572e-02]
 [-1.92036972e-02]
 [-3.84836020e-03]
 [-1.96019414e-02]
 [-3.92017091e-03]
 [-4.12644853e-03]
 [-1.70752998e-02]
 [ 1.44179123e-02]
 [ 8.28625239e-03]
 [ 1.24892325e-02]
 [ 3.60634263e-03]
 [ 1.51108936e-03]
 [ 1.13304560e-02]
 [-2.03849975e-02]
 [ 4.90417440e-03]
 [ 7.03288927e-03]
 [ 2.15116842e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.69808592]
curr_Stock_Price:  100.56288915268429
curr_Factors:  [100.56288915]
mat_Sqrt:  [[0.15]]
grads:  [-0.00221679]
Stock Position:  -0.0022167898799139245
Bond Position:  [10.92101271]


portfolio before change:  [10.69903718]
curr_Stock_Price:  100.44168957617143
curr_Factors:  [100.44168958]
mat_Sqrt:  [[0.15]]
grads:  [0.01692645]
Stock Position:  0.016926454775185232
Bond Position:  [8.99891546]


portfolio before change:  [10.70230549]
curr_Stock_Price:  100.60154932941623
curr_Factors:  [100.60154933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01848714]
Stock Position:  -0.018487139626239442
Bond Position:  [12.56214037]


portfolio before change:  [10.68478493]
curr_Stock_Price:  101.59173581641251
curr_Factors:  [101.59173582]
mat_Sqrt:  [[0.15]]
grads:  [0.01007142]
Stock Position:  0.010071415098125865
Bond Position:  [9.66161239]


portfolio before change:  [10.68097505]
curr_Stock_Price:  101.15349061301438
curr_Factors:  [101.15349061]
mat_Sqrt:  [[0.15]]
grads:  [0.09527953]
Stock Position:  0.09527953349674681
Bond Position:  [1.04311765]


portfolio before change:  [10.77399663]
curr_Stock_Price:  102.1291081269039
curr_Factors:  [102.12910813]
mat_Sqrt:  [[0.15]]
grads:  [0.17922219]
Stock Position:  0.17922218657787176
Bond Position:  [-7.52980544]


portfolio before change:  [10.76589431]
curr_Stock_Price:  102.08652585951754
curr_Factors:  [102.08652586]
mat_Sqrt:  [[0.15]]
grads:  [0.02328792]
Stock Position:  0.023287920231622686
Bond Position:  [8.38851144]


portfolio before change:  [10.76653433]
curr_Stock_Price:  102.09149510754462
curr_Factors:  [102.09149511]
mat_Sqrt:  [[0.15]]
grads:  [0.07823642]
Stock Position:  0.07823641584848447
Bond Position:  [2.77926167]


portfolio before change:  [10.6691625]
curr_Stock_Price:  100.84469030271742
curr_Factors:  [100.8446903]
mat_Sqrt:  [[0.15]]
grads:  [0.16337019]
Stock Position:  0.16337019076287804
Bond Position:  [-5.80585379]


portfolio before change:  [10.65207158]
curr_Stock_Price:  100.74229680429701
curr_Factors:  [100.7422968]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898667]
Stock Position:  -0.02898666724501865
Bond Position:  [13.57225502]


portfolio before change:  [10.67900907]
curr_Stock_Price:  99.84225568518667
curr_Factors:  [99.84225569]
mat_Sqrt:  [[0.15]]
grads:  [0.08835935]
Stock Position:  0.0883593488998395
Bond Position:  [1.85701236]


portfolio before change:  [10.76391237]
curr_Stock_Price:  100.80182860808878
curr_Factors:  [100.80182861]
mat_Sqrt:  [[0.15]]
grads:  [-0.16072496]
Stock Position:  -0.16072496049963253
Bond Position:  [26.96528229]


portfolio before change:  [10.75971588]
curr_Stock_Price:  100.83842450293403
curr_Factors:  [100.8384245]
mat_Sqrt:  [[0.15]]
grads:  [0.13731447]
Stock Position:  0.13731446888231744
Bond Position:  [-3.08685882]


portfolio before change:  [10.73714704]
curr_Stock_Price:  100.67547074075979
curr_Factors:  [100.67547074]
mat_Sqrt:  [[0.15]]
grads:  [0.00551173]
Stock Position:  0.005511734455482149
Bond Position:  [10.18225058]


portfolio before change:  [10.73764038]
curr_Stock_Price:  100.6495130527292
curr_Factors:  [100.64951305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610116]
Stock Position:  -0.04610115565916597
Bond Position:  [15.37769924]


portfolio before change:  [10.73370926]
curr_Stock_Price:  100.75563291959017
curr_Factors:  [100.75563292]
mat_Sqrt:  [[0.15]]
grads:  [0.11847058]
Stock Position:  0.11847058340451744
Bond Position:  [-1.20286935]


portfolio before change:  [10.72678922]
curr_Stock_Price:  100.69785603955545
curr_Factors:  [100.69785604]
mat_Sqrt:  [[0.15]]
grads:  [0.06563727]
Stock Position:  0.06563726629520102
Bond Position:  [4.11725723]


portfolio before change:  [10.79981514]
curr_Stock_Price:  101.80650345978465
curr_Factors:  [101.80650346]
mat_Sqrt:  [[0.15]]
grads:  [-0.070507]
Stock Position:  -0.07050700424140069
Bond Position:  [17.97788671]


portfolio before change:  [10.822985]
curr_Stock_Price:  101.49382241775419
curr_Factors:  [101.49382242]
mat_Sqrt:  [[0.15]]
grads:  [0.00383057]
Stock Position:  0.003830565825016846
Bond Position:  [10.43420623]


portfolio before change:  [10.82600831]
curr_Stock_Price:  102.11283118575915
curr_Factors:  [102.11283119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03774055]
Stock Position:  -0.03774055108324891
Bond Position:  [14.67980283]


portfolio before change:  [10.85073183]
curr_Stock_Price:  101.48205068091353
curr_Factors:  [101.48205068]
mat_Sqrt:  [[0.15]]
grads:  [0.08784412]
Stock Position:  0.0878441151095395
Bond Position:  [1.93613089]


portfolio before change:  [10.85982527]
curr_Stock_Price:  101.58419094354637
curr_Factors:  [101.58419094]
mat_Sqrt:  [[0.15]]
grads:  [-0.02267966]
Stock Position:  -0.022679662426814944
Bond Position:  [13.16372042]


portfolio before change:  [10.86398664]
curr_Stock_Price:  101.43698353775221
curr_Factors:  [101.43698354]
mat_Sqrt:  [[0.15]]
grads:  [0.05916997]
Stock Position:  0.05916996854442687
Bond Position:  [4.86196351]


portfolio before change:  [10.89147217]
curr_Stock_Price:  101.89636601867512
curr_Factors:  [101.89636602]
mat_Sqrt:  [[0.15]]
grads:  [0.01714343]
Stock Position:  0.01714342740667396
Bond Position:  [9.14461921]


portfolio before change:  [10.88293078]
curr_Stock_Price:  101.36479552223992
curr_Factors:  [101.36479552]
mat_Sqrt:  [[0.15]]
grads:  [0.01012125]
Stock Position:  0.010121250990068864
Bond Position:  [9.85699225]


portfolio before change:  [10.88128628]
curr_Stock_Price:  101.14144507015355
curr_Factors:  [101.14144507]
mat_Sqrt:  [[0.15]]
grads:  [0.08595026]
Stock Position:  0.08595025606307312
Bond Position:  [2.18815318]


portfolio before change:  [10.82565816]
curr_Stock_Price:  100.49264086347118
curr_Factors:  [100.49264086]
mat_Sqrt:  [[0.15]]
grads:  [-0.04450606]
Stock Position:  -0.04450606176634246
Bond Position:  [15.29818984]


portfolio before change:  [10.88411287]
curr_Stock_Price:  99.20071453022912
curr_Factors:  [99.20071453]
mat_Sqrt:  [[0.15]]
grads:  [0.04108281]
Stock Position:  0.041082814989892594
Bond Position:  [6.80866827]


portfolio before change:  [10.85342148]
curr_Stock_Price:  98.44329440507165
curr_Factors:  [98.44329441]
mat_Sqrt:  [[0.15]]
grads:  [-0.10432649]
Stock Position:  -0.10432648980325077
Bond Position:  [21.12366483]


portfolio before change:  [10.86062418]
curr_Stock_Price:  98.38690955667404
curr_Factors:  [98.38690956]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059148]
Stock Position:  -0.0005914797289792165
Bond Position:  [10.91881805]


portfolio before change:  [10.86094496]
curr_Stock_Price:  98.9983827344918
curr_Factors:  [98.99838273]
mat_Sqrt:  [[0.15]]
grads:  [-0.04323633]
Stock Position:  -0.04323633145916024
Bond Position:  [15.14127185]


portfolio before change:  [10.88814325]
curr_Stock_Price:  98.39120965298112
curr_Factors:  [98.39120965]
mat_Sqrt:  [[0.15]]
grads:  [-0.06826604]
Stock Position:  -0.06826604292789772
Bond Position:  [17.60492179]


portfolio before change:  [10.86864454]
curr_Stock_Price:  98.69295636895299
curr_Factors:  [98.69295637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04434344]
Stock Position:  -0.04434344099981397
Bond Position:  [15.24502983]


portfolio before change:  [10.83866441]
curr_Stock_Price:  99.39053366125681
curr_Factors:  [99.39053366]
mat_Sqrt:  [[0.15]]
grads:  [0.03029176]
Stock Position:  0.030291757148252104
Bond Position:  [7.8279505]


portfolio before change:  [10.83151983]
curr_Stock_Price:  99.13852330627775
curr_Factors:  [99.13852331]
mat_Sqrt:  [[0.15]]
grads:  [0.08163807]
Stock Position:  0.08163806716646514
Bond Position:  [2.73804241]


portfolio before change:  [10.83166771]
curr_Stock_Price:  99.13823848052111
curr_Factors:  [99.13823848]
mat_Sqrt:  [[0.15]]
grads:  [0.09606638]
Stock Position:  0.09606638383515868
Bond Position:  [1.30781564]


portfolio before change:  [10.75028855]
curr_Stock_Price:  98.2902737984223
curr_Factors:  [98.2902738]
mat_Sqrt:  [[0.15]]
grads:  [-0.23109674]
Stock Position:  -0.23109673975460132
Bond Position:  [33.46485038]


portfolio before change:  [10.65033612]
curr_Stock_Price:  98.73183801282453
curr_Factors:  [98.73183801]
mat_Sqrt:  [[0.15]]
grads:  [0.06094063]
Stock Position:  0.06094062821847061
Bond Position:  [4.63355589]


portfolio before change:  [10.69932927]
curr_Stock_Price:  99.53103467776631
curr_Factors:  [99.53103468]
mat_Sqrt:  [[0.15]]
grads:  [-0.08727581]
Stock Position:  -0.08727580989069664
Bond Position:  [19.38598093]


portfolio before change:  [10.70319325]
curr_Stock_Price:  99.50064466491222
curr_Factors:  [99.50064466]
mat_Sqrt:  [[0.15]]
grads:  [0.16396293]
Stock Position:  0.16396293468537876
Bond Position:  [-5.61122445]


portfolio before change:  [10.61636524]
curr_Stock_Price:  98.9732248653282
curr_Factors:  [98.97322487]
mat_Sqrt:  [[0.15]]
grads:  [-0.03300224]
Stock Position:  -0.03300224096323771
Bond Position:  [13.88270345]


portfolio before change:  [10.62478246]
curr_Stock_Price:  98.74446690617741
curr_Factors:  [98.74446691]
mat_Sqrt:  [[0.15]]
grads:  [0.02338919]
Stock Position:  0.023389191659513774
Bond Position:  [8.3152292]


portfolio before change:  [10.61351953]
curr_Stock_Price:  98.2407024309407
curr_Factors:  [98.24070243]
mat_Sqrt:  [[0.15]]
grads:  [0.15361258]
Stock Position:  0.1536125849526215
Bond Position:  [-4.47748871]


portfolio before change:  [10.58366053]
curr_Stock_Price:  98.04814560080462
curr_Factors:  [98.0481456]
mat_Sqrt:  [[0.15]]
grads:  [0.02995858]
Stock Position:  0.029958578107033524
Bond Position:  [7.6462775]


portfolio before change:  [10.58373719]
curr_Stock_Price:  98.03475214537139
curr_Factors:  [98.03475215]
mat_Sqrt:  [[0.15]]
grads:  [-0.01482198]
Stock Position:  -0.014821983082817045
Bond Position:  [12.03680663]


portfolio before change:  [10.60484133]
curr_Stock_Price:  96.6616691159976
curr_Factors:  [96.66166912]
mat_Sqrt:  [[0.15]]
grads:  [0.04312162]
Stock Position:  0.043121618961474754
Bond Position:  [6.43663366]


portfolio before change:  [10.59528629]
curr_Stock_Price:  96.43075617360408
curr_Factors:  [96.43075617]
mat_Sqrt:  [[0.15]]
grads:  [0.00168661]
Stock Position:  0.0016866115534399282
Bond Position:  [10.43264506]


portfolio before change:  [10.59517219]
curr_Stock_Price:  95.97649794451875
curr_Factors:  [95.97649794]
mat_Sqrt:  [[0.15]]
grads:  [-0.06725573]
Stock Position:  -0.06725572796469467
Bond Position:  [17.05014143]


portfolio before change:  [10.58856883]
curr_Stock_Price:  96.09052579772066
curr_Factors:  [96.0905258]
mat_Sqrt:  [[0.15]]
grads:  [0.04538362]
Stock Position:  0.045383622915560085
Bond Position:  [6.22763264]


portfolio before change:  [10.57696023]
curr_Stock_Price:  95.8261608352467
curr_Factors:  [95.82616084]
mat_Sqrt:  [[0.15]]
grads:  [0.02357769]
Stock Position:  0.023577694504872498
Bond Position:  [8.31760029]


portfolio before change:  [10.57892606]
curr_Stock_Price:  95.88748823829096
curr_Factors:  [95.88748824]
mat_Sqrt:  [[0.15]]
grads:  [0.24474924]
Stock Position:  0.24474923916218191
Bond Position:  [-12.88946374]


portfolio before change:  [10.63063097]
curr_Stock_Price:  96.10203653862786
curr_Factors:  [96.10203654]
mat_Sqrt:  [[0.15]]
grads:  [-0.0002162]
Stock Position:  -0.00021620425513124708
Bond Position:  [10.65140864]


portfolio before change:  [10.63129309]
curr_Stock_Price:  96.11876349962323
curr_Factors:  [96.1187635]
mat_Sqrt:  [[0.15]]
grads:  [0.01230894]
Stock Position:  0.012308937426451713
Bond Position:  [9.44817324]


portfolio before change:  [10.62929824]
curr_Stock_Price:  95.90872251631777
curr_Factors:  [95.90872252]
mat_Sqrt:  [[0.15]]
grads:  [0.03204176]
Stock Position:  0.032041762967921744
Bond Position:  [7.55621368]


portfolio before change:  [10.6197269]
curr_Stock_Price:  95.59526856402624
curr_Factors:  [95.59526856]
mat_Sqrt:  [[0.15]]
grads:  [0.022785]
Stock Position:  0.022785000177934764
Bond Position:  [8.44158869]


portfolio before change:  [10.61215576]
curr_Stock_Price:  95.23982629243149
curr_Factors:  [95.23982629]
mat_Sqrt:  [[0.15]]
grads:  [0.0249375]
Stock Position:  0.02493749783314196
Bond Position:  [8.2371128]


portfolio before change:  [10.6130049]
curr_Stock_Price:  95.25323187628864
curr_Factors:  [95.25323188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0758241]
Stock Position:  -0.07582410410280456
Bond Position:  [17.83549587]


portfolio before change:  [10.69847438]
curr_Stock_Price:  94.14072643073257
curr_Factors:  [94.14072643]
mat_Sqrt:  [[0.15]]
grads:  [0.00310039]
Stock Position:  0.0031003910142380956
Bond Position:  [10.40660132]


portfolio before change:  [10.69864935]
curr_Stock_Price:  93.98737119117571
curr_Factors:  [93.98737119]
mat_Sqrt:  [[0.15]]
grads:  [0.01071699]
Stock Position:  0.01071699200410958
Bond Position:  [9.69138745]


portfolio before change:  [10.700788]
curr_Stock_Price:  94.1304071873789
curr_Factors:  [94.13040719]
mat_Sqrt:  [[0.15]]
grads:  [-0.57216704]
Stock Position:  -0.5721670447795824
Bond Position:  [64.5591049]


portfolio before change:  [10.75987648]
curr_Stock_Price:  94.03418806277304
curr_Factors:  [94.03418806]
mat_Sqrt:  [[0.15]]
grads:  [-0.09170035]
Stock Position:  -0.0917003507341811
Bond Position:  [19.38284451]


portfolio before change:  [10.74659138]
curr_Stock_Price:  94.19227430884004
curr_Factors:  [94.19227431]
mat_Sqrt:  [[0.15]]
grads:  [0.11914306]
Stock Position:  0.11914306123460304
Bond Position:  [-0.47576452]


portfolio before change:  [10.77674166]
curr_Stock_Price:  94.44558330794874
curr_Factors:  [94.44558331]
mat_Sqrt:  [[0.15]]
grads:  [0.11075638]
Stock Position:  0.11075638120036173
Bond Position:  [0.31629063]


portfolio before change:  [10.85388259]
curr_Stock_Price:  95.14189681177368
curr_Factors:  [95.14189681]
mat_Sqrt:  [[0.15]]
grads:  [-0.12802465]
Stock Position:  -0.12802464775626943
Bond Position:  [23.03439042]


portfolio before change:  [10.88874732]
curr_Stock_Price:  94.88081399212113
curr_Factors:  [94.88081399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565573]
Stock Position:  -0.025655734675445973
Bond Position:  [13.32298431]


portfolio before change:  [10.9146512]
curr_Stock_Price:  93.90359915229857
curr_Factors:  [93.90359915]
mat_Sqrt:  [[0.15]]
grads:  [-0.13067961]
Stock Position:  -0.13067960919518212
Bond Position:  [23.18593684]


portfolio before change:  [10.9080818]
curr_Stock_Price:  93.9649596385479
curr_Factors:  [93.96495964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02613447]
Stock Position:  -0.026134472724409608
Bond Position:  [13.36380647]


portfolio before change:  [10.91427406]
curr_Stock_Price:  93.75998133601206
curr_Factors:  [93.75998134]
mat_Sqrt:  [[0.15]]
grads:  [-0.02750966]
Stock Position:  -0.027509656884477814
Bond Position:  [13.49357898]


portfolio before change:  [10.89280924]
curr_Stock_Price:  94.57090387692207
curr_Factors:  [94.57090388]
mat_Sqrt:  [[0.15]]
grads:  [-0.11383533]
Stock Position:  -0.11383533187334073
Bond Position:  [21.65831947]


portfolio before change:  [10.95752923]
curr_Stock_Price:  94.01425503993742
curr_Factors:  [94.01425504]
mat_Sqrt:  [[0.15]]
grads:  [0.09611942]
Stock Position:  0.09611941561489548
Bond Position:  [1.92093398]


portfolio before change:  [10.97045019]
curr_Stock_Price:  94.14743207982056
curr_Factors:  [94.14743208]
mat_Sqrt:  [[0.15]]
grads:  [0.05524168]
Stock Position:  0.05524168261421663
Bond Position:  [5.76958763]


portfolio before change:  [10.975482]
curr_Stock_Price:  94.23199131945553
curr_Factors:  [94.23199132]
mat_Sqrt:  [[0.15]]
grads:  [0.08326155]
Stock Position:  0.08326154972567382
Bond Position:  [3.12958037]


portfolio before change:  [11.00320739]
curr_Stock_Price:  94.5626336107334
curr_Factors:  [94.56263361]
mat_Sqrt:  [[0.15]]
grads:  [0.02404228]
Stock Position:  0.024042284203686787
Bond Position:  [8.72970568]


portfolio before change:  [10.99846476]
curr_Stock_Price:  94.3426773902337
curr_Factors:  [94.34267739]
mat_Sqrt:  [[0.15]]
grads:  [0.01007393]
Stock Position:  0.010073929091028869
Bond Position:  [10.04806332]


portfolio before change:  [10.99868074]
curr_Stock_Price:  94.30177481280423
curr_Factors:  [94.30177481]
mat_Sqrt:  [[0.15]]
grads:  [0.07553637]
Stock Position:  0.07553637356714676
Bond Position:  [3.87546665]


portfolio before change:  [10.97690886]
curr_Stock_Price:  94.01033771546487
curr_Factors:  [94.01033772]
mat_Sqrt:  [[0.15]]
grads:  [-0.13589998]
Stock Position:  -0.13589998316682678
Bond Position:  [23.75291217]


portfolio before change:  [10.96691756]
curr_Stock_Price:  94.09478147393627
curr_Factors:  [94.09478147]
mat_Sqrt:  [[0.15]]
grads:  [0.0326945]
Stock Position:  0.032694496008426485
Bond Position:  [7.8905361]


portfolio before change:  [10.99054438]
curr_Stock_Price:  94.80235149084085
curr_Factors:  [94.80235149]
mat_Sqrt:  [[0.15]]
grads:  [0.04688593]
Stock Position:  0.04688592848107058
Bond Position:  [6.54564811]


portfolio before change:  [10.9470237]
curr_Stock_Price:  93.86540090359914
curr_Factors:  [93.8654009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.9470237]
Stock Price:  93.72291722810701
PL:  [10.9470237]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.02219839e-03]
 [-3.11496250e-03]
 [-1.52524298e-03]
 [ 7.65260876e-03]
 [ 4.97608620e-03]
 [ 2.58428119e-02]
 [ 1.57666959e-03]
 [-1.46636180e-02]
 [ 2.46632891e-02]
 [-4.61101455e-03]
 [ 3.39482999e-02]
 [-5.28634690e-02]
 [ 8.06168074e-02]
 [ 1.22219199e-02]
 [-6.89907405e-03]
 [ 2.99875985e-02]
 [ 1.41997351e-02]
 [ 1.99555844e-03]
 [ 1.63588414e-02]
 [-1.13331055e-02]
 [ 1.52235339e-02]
 [-1.93137588e-02]
 [ 9.96869660e-03]
 [-8.45608986e-02]
 [ 1.10743927e-02]
 [ 6.07735659e-03]
 [-3.69034292e-03]
 [ 1.95237678e-02]
 [ 6.07119318e-02]
 [ 6.21914179e-03]
 [ 1.97242897e-02]
 [-6.13860775e-03]
 [ 3.65516570e-04]
 [ 8.47741012e-03]
 [ 1.06620367e-02]
 [ 8.49224495e-03]
 [-3.35722001e-02]
 [ 9.54851652e-03]
 [ 1.87543329e-03]
 [ 1.57452382e-02]
 [-5.53674749e-03]
 [-1.55874041e-02]
 [ 2.33280849e-02]
 [ 3.25117459e-03]
 [-8.28280943e-03]
 [-1.21522837e-03]
 [ 1.15331527e-02]
 [-5.95558337e-03]
 [-2.96174931e-03]
 [-7.38807709e-03]
 [-3.81681307e-02]
 [ 2.34158406e-03]
 [-8.42085324e-03]
 [ 5.55438412e-03]
 [ 3.29192513e-03]
 [ 4.39972975e-03]
 [ 9.20901237e-03]
 [-1.30946768e-04]
 [ 1.75042145e-03]
 [ 1.49746757e-02]
 [ 8.71804924e-04]
 [ 1.91374626e-02]
 [ 2.08468337e-03]
 [-1.25118009e-02]
 [ 6.65987022e-03]
 [ 2.49702710e-03]
 [-5.42362221e-03]
 [ 1.50156564e-02]
 [-8.49505495e-03]
 [-1.88054886e-02]
 [-1.14118201e-02]
 [ 1.41954244e-02]
 [-5.87367233e-03]
 [ 2.39325196e-02]
 [-2.36751557e-02]
 [ 4.37061924e-04]
 [ 4.55423984e-04]
 [-9.70686367e-03]
 [ 2.78273622e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03758814]
curr_Stock_Price:  99.79977742941075
curr_Factors:  [99.79977743]
mat_Sqrt:  [[0.15]]
grads:  [0.02014799]
Stock Position:  0.02014798924442801
Bond Position:  [-3.04835298]


portfolio before change:  [-1.04443848]
curr_Stock_Price:  99.4692325608972
curr_Factors:  [99.46923256]
mat_Sqrt:  [[0.15]]
grads:  [-0.02076642]
Stock Position:  -0.020766416693310526
Bond Position:  [1.02118105]


portfolio before change:  [-1.0402334]
curr_Stock_Price:  99.26981171837448
curr_Factors:  [99.26981172]
mat_Sqrt:  [[0.15]]
grads:  [-0.01016829]
Stock Position:  -0.010168286541777528
Bond Position:  [-0.03082951]


portfolio before change:  [-1.03882166]
curr_Stock_Price:  99.13078500128475
curr_Factors:  [99.130785]
mat_Sqrt:  [[0.15]]
grads:  [0.05101739]
Stock Position:  0.05101739170397791
Bond Position:  [-6.09621575]


portfolio before change:  [-1.00678128]
curr_Stock_Price:  99.7662822171647
curr_Factors:  [99.76628222]
mat_Sqrt:  [[0.15]]
grads:  [0.03317391]
Stock Position:  0.033173907986723636
Bond Position:  [-4.31641875]


portfolio before change:  [-0.99046442]
curr_Stock_Price:  100.26627281325452
curr_Factors:  [100.26627281]
mat_Sqrt:  [[0.15]]
grads:  [0.17228541]
Stock Position:  0.17228541283157717
Bond Position:  [-18.26488063]


portfolio before change:  [-1.02892459]
curr_Stock_Price:  100.04966380308659
curr_Factors:  [100.0496638]
mat_Sqrt:  [[0.15]]
grads:  [0.01051113]
Stock Position:  0.010511130579909244
Bond Position:  [-2.08055967]


portfolio before change:  [-1.02563756]
curr_Stock_Price:  100.37475401266657
curr_Factors:  [100.37475401]
mat_Sqrt:  [[0.15]]
grads:  [-0.09775745]
Stock Position:  -0.09775745362888606
Bond Position:  [8.7867428]


portfolio before change:  [-1.16514063]
curr_Stock_Price:  101.80740450077515
curr_Factors:  [101.8074045]
mat_Sqrt:  [[0.15]]
grads:  [0.16442193]
Stock Position:  0.16442192704619665
Bond Position:  [-17.90451027]


portfolio before change:  [-1.25179909]
curr_Stock_Price:  101.28716132723494
curr_Factors:  [101.28716133]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307401]
Stock Position:  -0.03074009698141025
Bond Position:  [1.86177808]


portfolio before change:  [-1.27601145]
curr_Stock_Price:  102.07859440966519
curr_Factors:  [102.07859441]
mat_Sqrt:  [[0.15]]
grads:  [0.226322]
Stock Position:  0.2263219991613281
Bond Position:  [-24.37864301]


portfolio before change:  [-1.35510406]
curr_Stock_Price:  101.73585754068166
curr_Factors:  [101.73585754]
mat_Sqrt:  [[0.15]]
grads:  [-0.35242313]
Stock Position:  -0.352423126397013
Bond Position:  [34.49896492]


portfolio before change:  [-1.59555492]
curr_Stock_Price:  102.42425481581236
curr_Factors:  [102.42425482]
mat_Sqrt:  [[0.15]]
grads:  [0.53744538]
Stock Position:  0.5374453827680957
Bond Position:  [-56.64299776]


portfolio before change:  [-1.47317951]
curr_Stock_Price:  102.65854040617175
curr_Factors:  [102.65854041]
mat_Sqrt:  [[0.15]]
grads:  [0.08147947]
Stock Position:  0.08147946605519818
Bond Position:  [-9.83774257]


portfolio before change:  [-1.480039]
curr_Stock_Price:  102.58190018598646
curr_Factors:  [102.58190019]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599383]
Stock Position:  -0.045993826967575153
Bond Position:  [3.23809517]


portfolio before change:  [-1.50829191]
curr_Stock_Price:  103.20057679247795
curr_Factors:  [103.20057679]
mat_Sqrt:  [[0.15]]
grads:  [0.19991732]
Stock Position:  0.19991732336795423
Bond Position:  [-22.139875]


portfolio before change:  [-1.38999618]
curr_Stock_Price:  103.79922184672424
curr_Factors:  [103.79922185]
mat_Sqrt:  [[0.15]]
grads:  [0.0946649]
Stock Position:  0.09466490052981294
Bond Position:  [-11.21613919]


portfolio before change:  [-1.36325957]
curr_Stock_Price:  104.08906154213462
curr_Factors:  [104.08906154]
mat_Sqrt:  [[0.15]]
grads:  [0.01330372]
Stock Position:  0.013303722903791905
Bond Position:  [-2.7480316]


portfolio before change:  [-1.35357624]
curr_Stock_Price:  104.82983808297409
curr_Factors:  [104.82983808]
mat_Sqrt:  [[0.15]]
grads:  [0.10905894]
Stock Position:  0.10905894268620667
Bond Position:  [-12.78620754]


portfolio before change:  [-1.29581256]
curr_Stock_Price:  105.3668214835634
curr_Factors:  [105.36682148]
mat_Sqrt:  [[0.15]]
grads:  [-0.07555404]
Stock Position:  -0.07555403653065237
Bond Position:  [6.66507612]


portfolio before change:  [-1.24412198]
curr_Stock_Price:  104.68818139295861
curr_Factors:  [104.68818139]
mat_Sqrt:  [[0.15]]
grads:  [0.10149023]
Stock Position:  0.10149022581400034
Bond Position:  [-11.86894915]


portfolio before change:  [-1.18536541]
curr_Stock_Price:  105.27442903724761
curr_Factors:  [105.27442904]
mat_Sqrt:  [[0.15]]
grads:  [-0.12875839]
Stock Position:  -0.12875839167101705
Bond Position:  [12.36960076]


portfolio before change:  [-1.19167245]
curr_Stock_Price:  105.3294170555954
curr_Factors:  [105.32941706]
mat_Sqrt:  [[0.15]]
grads:  [0.06645798]
Stock Position:  0.06645797735366571
Bond Position:  [-8.19165247]


portfolio before change:  [-1.19472924]
curr_Stock_Price:  105.29112532261941
curr_Factors:  [105.29112532]
mat_Sqrt:  [[0.15]]
grads:  [-0.56373932]
Stock Position:  -0.5637393243184167
Bond Position:  [58.16201861]


portfolio before change:  [-0.91753874]
curr_Stock_Price:  104.80587398803101
curr_Factors:  [104.80587399]
mat_Sqrt:  [[0.15]]
grads:  [0.07382928]
Stock Position:  0.07382928475496607
Bond Position:  [-8.65528145]


portfolio before change:  [-0.91657252]
curr_Stock_Price:  104.82628846092739
curr_Factors:  [104.82628846]
mat_Sqrt:  [[0.15]]
grads:  [0.04051571]
Stock Position:  0.04051571062249307
Bond Position:  [-5.16368409]


portfolio before change:  [-0.8921617]
curr_Stock_Price:  105.43675688543567
curr_Factors:  [105.43675689]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460229]
Stock Position:  -0.024602286129230936
Bond Position:  [1.70182356]


portfolio before change:  [-0.87756456]
curr_Stock_Price:  104.84775568961084
curr_Factors:  [104.84775569]
mat_Sqrt:  [[0.15]]
grads:  [0.13015845]
Stock Position:  0.13015845185671499
Bond Position:  [-14.52438612]


portfolio before change:  [-0.89328841]
curr_Stock_Price:  104.73392485172772
curr_Factors:  [104.73392485]
mat_Sqrt:  [[0.15]]
grads:  [0.40474621]
Stock Position:  0.4047462120206184
Bond Position:  [-43.28394776]


portfolio before change:  [-1.08295983]
curr_Stock_Price:  104.2719907122643
curr_Factors:  [104.27199071]
mat_Sqrt:  [[0.15]]
grads:  [0.04146095]
Stock Position:  0.041460945243280305
Bond Position:  [-5.40617513]


portfolio before change:  [-1.08126548]
curr_Stock_Price:  104.32100656616754
curr_Factors:  [104.32100657]
mat_Sqrt:  [[0.15]]
grads:  [0.13149526]
Stock Position:  0.1314952648847102
Bond Position:  [-14.79898388]


portfolio before change:  [-1.24348783]
curr_Stock_Price:  103.09436632871572
curr_Factors:  [103.09436633]
mat_Sqrt:  [[0.15]]
grads:  [-0.04092405]
Stock Position:  -0.04092405167821383
Bond Position:  [2.97555134]


portfolio before change:  [-1.25794078]
curr_Stock_Price:  103.45207581553275
curr_Factors:  [103.45207582]
mat_Sqrt:  [[0.15]]
grads:  [0.00243678]
Stock Position:  0.002436777130785196
Bond Position:  [-1.51003043]


portfolio before change:  [-1.25929926]
curr_Stock_Price:  102.93331676734354
curr_Factors:  [102.93331677]
mat_Sqrt:  [[0.15]]
grads:  [0.05651607]
Stock Position:  0.05651606746488074
Bond Position:  [-7.07668553]


portfolio before change:  [-1.27015322]
curr_Stock_Price:  102.7490920854208
curr_Factors:  [102.74909209]
mat_Sqrt:  [[0.15]]
grads:  [0.07108024]
Stock Position:  0.07108024476521754
Bond Position:  [-8.57358383]


portfolio before change:  [-1.33617922]
curr_Stock_Price:  101.82773717250683
curr_Factors:  [101.82773717]
mat_Sqrt:  [[0.15]]
grads:  [0.05661497]
Stock Position:  0.056614966348427005
Bond Position:  [-7.10115313]


portfolio before change:  [-1.32693988]
curr_Stock_Price:  101.99877273479296
curr_Factors:  [101.99877273]
mat_Sqrt:  [[0.15]]
grads:  [-0.22381467]
Stock Position:  -0.22381466713227577
Bond Position:  [21.50188149]


portfolio before change:  [-1.29261038]
curr_Stock_Price:  101.85139369037938
curr_Factors:  [101.85139369]
mat_Sqrt:  [[0.15]]
grads:  [0.06365678]
Stock Position:  0.06365677682157973
Bond Position:  [-7.77614182]


portfolio before change:  [-1.32958305]
curr_Stock_Price:  101.27821593601121
curr_Factors:  [101.27821594]
mat_Sqrt:  [[0.15]]
grads:  [0.01250289]
Stock Position:  0.012502888572651407
Bond Position:  [-2.5958533]


portfolio before change:  [-1.33108212]
curr_Stock_Price:  101.1712950859394
curr_Factors:  [101.17129509]
mat_Sqrt:  [[0.15]]
grads:  [0.10496825]
Stock Position:  0.10496825493100456
Bond Position:  [-11.95085641]


portfolio before change:  [-1.30216522]
curr_Stock_Price:  101.45389333671824
curr_Factors:  [101.45389334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03691165]
Stock Position:  -0.036911649941253136
Bond Position:  [2.44266537]


portfolio before change:  [-1.28051744]
curr_Stock_Price:  100.87155374869162
curr_Factors:  [100.87155375]
mat_Sqrt:  [[0.15]]
grads:  [-0.10391603]
Stock Position:  -0.10391602732581744
Bond Position:  [9.2016537]


portfolio before change:  [-1.23415689]
curr_Stock_Price:  100.43095355476473
curr_Factors:  [100.43095355]
mat_Sqrt:  [[0.15]]
grads:  [0.15552057]
Stock Position:  0.15552056590460953
Bond Position:  [-16.85323562]


portfolio before change:  [-1.21400494]
curr_Stock_Price:  100.56730408984866
curr_Factors:  [100.56730409]
mat_Sqrt:  [[0.15]]
grads:  [0.0216745]
Stock Position:  0.021674497273457268
Bond Position:  [-3.3937507]


portfolio before change:  [-1.22552603]
curr_Stock_Price:  100.04553994150302
curr_Factors:  [100.04553994]
mat_Sqrt:  [[0.15]]
grads:  [-0.05521873]
Stock Position:  -0.055218729518371805
Bond Position:  [4.29886158]


portfolio before change:  [-1.23532597]
curr_Stock_Price:  100.2278807324803
curr_Factors:  [100.22788073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810152]
Stock Position:  -0.008101522455524226
Bond Position:  [-0.42332755]


portfolio before change:  [-1.24472999]
curr_Stock_Price:  101.38538665395255
curr_Factors:  [101.38538665]
mat_Sqrt:  [[0.15]]
grads:  [0.07688768]
Stock Position:  0.07688768491201706
Bond Position:  [-9.04001766]


portfolio before change:  [-1.25989047]
curr_Stock_Price:  101.19555838977546
curr_Factors:  [101.19555839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970389]
Stock Position:  -0.03970388910941598
Bond Position:  [2.75796676]


portfolio before change:  [-1.30512467]
curr_Stock_Price:  102.339188937169
curr_Factors:  [102.33918894]
mat_Sqrt:  [[0.15]]
grads:  [-0.019745]
Stock Position:  -0.019744995392654095
Bond Position:  [0.71556215]


portfolio before change:  [-1.32072584]
curr_Stock_Price:  103.13158716381145
curr_Factors:  [103.13158716]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925385]
Stock Position:  -0.04925384726962375
Bond Position:  [3.7589016]


portfolio before change:  [-1.31192873]
curr_Stock_Price:  102.95774950238015
curr_Factors:  [102.9577495]
mat_Sqrt:  [[0.15]]
grads:  [-0.2544542]
Stock Position:  -0.2544542047294981
Bond Position:  [24.88610354]


portfolio before change:  [-1.29486591]
curr_Stock_Price:  102.896805749974
curr_Factors:  [102.89680575]
mat_Sqrt:  [[0.15]]
grads:  [0.01561056]
Stock Position:  0.015610560423779235
Bond Position:  [-2.90114271]


portfolio before change:  [-1.29352575]
curr_Stock_Price:  102.99427106084116
curr_Factors:  [102.99427106]
mat_Sqrt:  [[0.15]]
grads:  [-0.05613902]
Stock Position:  -0.0561390216248547
Bond Position:  [4.48847186]


portfolio before change:  [-1.26036435]
curr_Stock_Price:  102.40856689285147
curr_Factors:  [102.40856689]
mat_Sqrt:  [[0.15]]
grads:  [0.03702923]
Stock Position:  0.03702922744124369
Bond Position:  [-5.05247446]


portfolio before change:  [-1.29073808]
curr_Stock_Price:  101.59683120912725
curr_Factors:  [101.59683121]
mat_Sqrt:  [[0.15]]
grads:  [0.02194617]
Stock Position:  0.021946167551012478
Bond Position:  [-3.52039916]


portfolio before change:  [-1.26751548]
curr_Stock_Price:  102.665019211075
curr_Factors:  [102.66501921]
mat_Sqrt:  [[0.15]]
grads:  [0.02933153]
Stock Position:  0.029331531638502585
Bond Position:  [-4.27883774]


portfolio before change:  [-1.27702618]
curr_Stock_Price:  102.34988870622122
curr_Factors:  [102.34988871]
mat_Sqrt:  [[0.15]]
grads:  [0.06139342]
Stock Position:  0.06139341582671332
Bond Position:  [-7.56063546]


portfolio before change:  [-1.23607989]
curr_Stock_Price:  103.02453505964463
curr_Factors:  [103.02453506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00087298]
Stock Position:  -0.0008729784560309948
Bond Position:  [-1.14614169]


portfolio before change:  [-1.23667489]
curr_Stock_Price:  103.62404904696548
curr_Factors:  [103.62404905]
mat_Sqrt:  [[0.15]]
grads:  [0.01166948]
Stock Position:  0.01166947633278118
Bond Position:  [-2.44591328]


portfolio before change:  [-1.23669613]
curr_Stock_Price:  103.63532907223168
curr_Factors:  [103.63532907]
mat_Sqrt:  [[0.15]]
grads:  [0.09983117]
Stock Position:  0.09983117160060556
Bond Position:  [-11.58273245]


portfolio before change:  [-1.26042929]
curr_Stock_Price:  103.40484779829988
curr_Factors:  [103.4048478]
mat_Sqrt:  [[0.15]]
grads:  [0.00581203]
Stock Position:  0.005812032829046448
Bond Position:  [-1.86142166]


portfolio before change:  [-1.25989335]
curr_Stock_Price:  103.51707817561784
curr_Factors:  [103.51707818]
mat_Sqrt:  [[0.15]]
grads:  [0.12758308]
Stock Position:  0.12758308389493703
Bond Position:  [-14.46692141]


portfolio before change:  [-1.31356156]
curr_Stock_Price:  103.1035123168344
curr_Factors:  [103.10351232]
mat_Sqrt:  [[0.15]]
grads:  [0.01389789]
Stock Position:  0.01389788916633547
Bond Position:  [-2.74648275]


portfolio before change:  [-1.30208355]
curr_Stock_Price:  103.94174560256627
curr_Factors:  [103.9417456]
mat_Sqrt:  [[0.15]]
grads:  [-0.08341201]
Stock Position:  -0.08341200612360151
Bond Position:  [7.36790597]


portfolio before change:  [-1.27546486]
curr_Stock_Price:  103.62814342521557
curr_Factors:  [103.62814343]
mat_Sqrt:  [[0.15]]
grads:  [0.04439913]
Stock Position:  0.044399134814930054
Bond Position:  [-5.87646477]


portfolio before change:  [-1.29257538]
curr_Stock_Price:  103.25103624999252
curr_Factors:  [103.25103625]
mat_Sqrt:  [[0.15]]
grads:  [0.01664685]
Stock Position:  0.016646847342706904
Bond Position:  [-3.01137962]


portfolio before change:  [-1.29400875]
curr_Stock_Price:  103.17623832011724
curr_Factors:  [103.17623832]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615748]
Stock Position:  -0.03615748138770765
Bond Position:  [2.43658417]


portfolio before change:  [-1.30423223]
curr_Stock_Price:  103.46319898430265
curr_Factors:  [103.46319898]
mat_Sqrt:  [[0.15]]
grads:  [0.10010438]
Stock Position:  0.10010437567920435
Bond Position:  [-11.66135117]


portfolio before change:  [-1.23085487]
curr_Stock_Price:  104.20348844694432
curr_Factors:  [104.20348845]
mat_Sqrt:  [[0.15]]
grads:  [-0.0566337]
Stock Position:  -0.056633699652474716
Bond Position:  [4.6705742]


portfolio before change:  [-1.31507323]
curr_Stock_Price:  105.69571443506112
curr_Factors:  [105.69571444]
mat_Sqrt:  [[0.15]]
grads:  [-0.12536992]
Stock Position:  -0.12536992392449306
Bond Position:  [11.93599045]


portfolio before change:  [-1.26813783]
curr_Stock_Price:  105.32728974221024
curr_Factors:  [105.32728974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0760788]
Stock Position:  -0.07607880040776976
Bond Position:  [6.74503602]


portfolio before change:  [-1.25658193]
curr_Stock_Price:  105.18093726426889
curr_Factors:  [105.18093726]
mat_Sqrt:  [[0.15]]
grads:  [0.09463616]
Stock Position:  0.0946361628537913
Bond Position:  [-11.21050224]


portfolio before change:  [-1.31162205]
curr_Stock_Price:  104.60674411661749
curr_Factors:  [104.60674412]
mat_Sqrt:  [[0.15]]
grads:  [-0.03915782]
Stock Position:  -0.03915781550795707
Bond Position:  [2.78454954]


portfolio before change:  [-1.28142836]
curr_Stock_Price:  103.84011187450051
curr_Factors:  [103.84011187]
mat_Sqrt:  [[0.15]]
grads:  [0.15955013]
Stock Position:  0.15955013047114686
Bond Position:  [-17.84913176]


portfolio before change:  [-1.29598788]
curr_Stock_Price:  103.75585049206863
curr_Factors:  [103.75585049]
mat_Sqrt:  [[0.15]]
grads:  [-0.15783437]
Stock Position:  -0.15783437134298817
Bond Position:  [15.08025155]


portfolio before change:  [-1.33805099]
curr_Stock_Price:  104.02832378647192
curr_Factors:  [104.02832379]
mat_Sqrt:  [[0.15]]
grads:  [0.00291375]
Stock Position:  0.002913746156950776
Bond Position:  [-1.64116312]


portfolio before change:  [-1.33539057]
curr_Stock_Price:  104.97658672427045
curr_Factors:  [104.97658672]
mat_Sqrt:  [[0.15]]
grads:  [0.00303616]
Stock Position:  0.00303615989392701
Bond Position:  [-1.65411627]


portfolio before change:  [-1.33715867]
curr_Stock_Price:  104.42829064910123
curr_Factors:  [104.42829065]
mat_Sqrt:  [[0.15]]
grads:  [-0.06471242]
Stock Position:  -0.06471242445728131
Bond Position:  [5.4206492]


portfolio before change:  [-1.35947841]
curr_Stock_Price:  104.7784327741211
curr_Factors:  [104.77843277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.35947841]
Stock Price:  104.73215892794244
PL:  [-6.09163734]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.12641016e-04]
 [ 1.92515455e-03]
 [-3.54911354e-04]
 [ 7.41931176e-03]
 [ 3.46829933e-03]
 [ 2.46460482e-02]
 [ 1.16934006e-03]
 [-1.57050644e-02]
 [ 1.17342628e-02]
 [-3.63333800e-03]
 [ 1.38604025e-02]
 [ 1.77610309e-02]
 [-1.35239229e-02]
 [ 1.23038834e-02]
 [-6.91955294e-03]
 [ 1.10824059e-02]
 [ 7.34220541e-03]
 [-2.72795985e-03]
 [ 1.61105696e-03]
 [ 1.01724384e-02]
 [ 1.19964134e-02]
 [-9.38206619e-03]
 [ 6.56417158e-03]
 [ 1.18499360e-02]
 [-5.13438901e-03]
 [ 1.17008057e-02]
 [-6.90960129e-03]
 [ 5.80905302e-03]
 [-8.04017090e-03]
 [-2.91384333e-03]
 [ 4.13992357e-03]
 [-1.18465047e-02]
 [ 4.87235825e-03]
 [ 8.15788118e-03]
 [ 1.14151416e-02]
 [ 8.53374486e-03]
 [-3.39383137e-02]
 [ 9.57590426e-03]
 [ 5.52202533e-03]
 [ 1.86274653e-02]
 [-4.18856784e-03]
 [-2.02248821e-02]
 [ 2.08980798e-02]
 [ 2.32718656e-04]
 [-4.17897997e-03]
 [-1.15963959e-02]
 [ 1.39713833e-02]
 [ 6.81146026e-04]
 [-3.97104509e-04]
 [-7.45237312e-03]
 [-3.51469830e-02]
 [ 2.27193584e-03]
 [-6.84076805e-03]
 [ 5.40844905e-03]
 [ 3.22579244e-03]
 [ 4.36903599e-03]
 [ 9.75933325e-03]
 [ 3.19235089e-04]
 [ 1.78349562e-03]
 [ 1.07762429e-02]
 [ 1.37352208e-02]
 [ 3.37287516e-02]
 [-2.65778041e-03]
 [-1.20994979e-02]
 [ 1.50376420e-02]
 [ 6.94125617e-03]
 [-5.07134012e-03]
 [ 1.55237338e-02]
 [-1.51901771e-02]
 [-3.89787582e-02]
 [ 1.63881262e-03]
 [ 1.74738395e-02]
 [-4.57281641e-02]
 [ 2.91266085e-02]
 [-3.07996574e-02]
 [ 7.67167345e-03]
 [ 1.03996278e-02]
 [-1.71337168e-02]
 [ 2.18646356e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.0957978]
curr_Stock_Price:  100.45870043360397
curr_Factors:  [100.45870043]
mat_Sqrt:  [[0.15]]
grads:  [-0.00208427]
Stock Position:  -0.0020842734401066666
Bond Position:  [9.3051812]


portfolio before change:  [9.09585029]
curr_Stock_Price:  100.71255591602953
curr_Factors:  [100.71255592]
mat_Sqrt:  [[0.15]]
grads:  [0.01283436]
Stock Position:  0.012834363640180627
Bond Position:  [7.80326872]


portfolio before change:  [9.08276423]
curr_Stock_Price:  99.65494365081172
curr_Factors:  [99.65494365]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236608]
Stock Position:  -0.0023660756923071097
Bond Position:  [9.31855537]


portfolio before change:  [9.08237793]
curr_Stock_Price:  100.06436660919655
curr_Factors:  [100.06436661]
mat_Sqrt:  [[0.15]]
grads:  [0.04946208]
Stock Position:  0.049462078382823814
Bond Position:  [4.13298638]


portfolio before change:  [9.09982297]
curr_Stock_Price:  100.41183923606653
curr_Factors:  [100.41183924]
mat_Sqrt:  [[0.15]]
grads:  [0.023122]
Stock Position:  0.023121995557351175
Bond Position:  [6.77810087]


portfolio before change:  [9.09241847]
curr_Stock_Price:  100.07328123131447
curr_Factors:  [100.07328123]
mat_Sqrt:  [[0.15]]
grads:  [0.16430699]
Stock Position:  0.16430698804335048
Bond Position:  [-7.35032095]


portfolio before change:  [9.17636234]
curr_Stock_Price:  100.58697380826861
curr_Factors:  [100.58697381]
mat_Sqrt:  [[0.15]]
grads:  [0.0077956]
Stock Position:  0.007795600428399923
Bond Position:  [8.39222649]


portfolio before change:  [9.1744658]
curr_Stock_Price:  100.27640434943812
curr_Factors:  [100.27640435]
mat_Sqrt:  [[0.15]]
grads:  [-0.10470043]
Stock Position:  -0.10470042956409104
Bond Position:  [19.67344841]


portfolio before change:  [9.25903759]
curr_Stock_Price:  99.48039843755411
curr_Factors:  [99.48039844]
mat_Sqrt:  [[0.15]]
grads:  [0.07822842]
Stock Position:  0.078228418663714
Bond Position:  [1.47684333]


portfolio before change:  [9.305353]
curr_Stock_Price:  100.07127199609798
curr_Factors:  [100.071272]
mat_Sqrt:  [[0.15]]
grads:  [-0.02422225]
Stock Position:  -0.024222253303775143
Bond Position:  [11.7293047]


portfolio before change:  [9.31832636]
curr_Stock_Price:  99.56594116834268
curr_Factors:  [99.56594117]
mat_Sqrt:  [[0.15]]
grads:  [0.09240268]
Stock Position:  0.09240268311673089
Bond Position:  [0.11816624]


portfolio before change:  [9.28080221]
curr_Stock_Price:  99.15976761311846
curr_Factors:  [99.15976761]
mat_Sqrt:  [[0.15]]
grads:  [0.11840687]
Stock Position:  0.11840687241645848
Bond Position:  [-2.46039574]


portfolio before change:  [9.2648413]
curr_Stock_Price:  99.02626917708339
curr_Factors:  [99.02626918]
mat_Sqrt:  [[0.15]]
grads:  [-0.09015949]
Stock Position:  -0.09015948579663949
Bond Position:  [18.19299881]


portfolio before change:  [9.21693275]
curr_Stock_Price:  99.57025687346348
curr_Factors:  [99.57025687]
mat_Sqrt:  [[0.15]]
grads:  [0.08202589]
Stock Position:  0.08202588936688306
Bond Position:  [1.04959388]


portfolio before change:  [9.2138903]
curr_Stock_Price:  99.53236574550016
curr_Factors:  [99.53236575]
mat_Sqrt:  [[0.15]]
grads:  [-0.04613035]
Stock Position:  -0.046130352956018375
Bond Position:  [13.80535346]


portfolio before change:  [9.20409331]
curr_Stock_Price:  99.76344687713618
curr_Factors:  [99.76344688]
mat_Sqrt:  [[0.15]]
grads:  [0.07388271]
Stock Position:  0.07388270577195646
Bond Position:  [1.83329991]


portfolio before change:  [9.12473815]
curr_Stock_Price:  98.68782654786024
curr_Factors:  [98.68782655]
mat_Sqrt:  [[0.15]]
grads:  [0.04894804]
Stock Position:  0.04894803607802233
Bond Position:  [4.29416286]


portfolio before change:  [9.07574189]
curr_Stock_Price:  97.68135818748931
curr_Factors:  [97.68135819]
mat_Sqrt:  [[0.15]]
grads:  [-0.0181864]
Stock Position:  -0.018186398986475213
Bond Position:  [10.85221405]


portfolio before change:  [9.06855229]
curr_Stock_Price:  98.1139828018259
curr_Factors:  [98.1139828]
mat_Sqrt:  [[0.15]]
grads:  [0.01074038]
Stock Position:  0.01074037971782986
Bond Position:  [8.01477086]


portfolio before change:  [9.07288566]
curr_Stock_Price:  98.47080706411407
curr_Factors:  [98.47080706]
mat_Sqrt:  [[0.15]]
grads:  [0.06781626]
Stock Position:  0.06781625609727657
Bond Position:  [2.39496419]


portfolio before change:  [9.08007388]
curr_Stock_Price:  98.57459533344927
curr_Factors:  [98.57459533]
mat_Sqrt:  [[0.15]]
grads:  [0.07997609]
Stock Position:  0.07997608944643546
Bond Position:  [1.19646323]


portfolio before change:  [9.04369291]
curr_Stock_Price:  98.11876216729392
curr_Factors:  [98.11876217]
mat_Sqrt:  [[0.15]]
grads:  [-0.06254711]
Stock Position:  -0.06254710794706411
Bond Position:  [15.18073772]


portfolio before change:  [9.03682367]
curr_Stock_Price:  98.24375706112485
curr_Factors:  [98.24375706]
mat_Sqrt:  [[0.15]]
grads:  [0.04376114]
Stock Position:  0.04376114383445903
Bond Position:  [4.73756448]


portfolio before change:  [9.05709486]
curr_Stock_Price:  98.70021421310582
curr_Factors:  [98.70021421]
mat_Sqrt:  [[0.15]]
grads:  [0.07899957]
Stock Position:  0.07899957301722688
Bond Position:  [1.25982008]


portfolio before change:  [9.13186837]
curr_Stock_Price:  99.64572267518054
curr_Factors:  [99.64572268]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422926]
Stock Position:  -0.034229260096414756
Bond Position:  [12.54266773]


portfolio before change:  [9.12007175]
curr_Stock_Price:  100.01326067826633
curr_Factors:  [100.01326068]
mat_Sqrt:  [[0.15]]
grads:  [0.07800537]
Stock Position:  0.07800537107836955
Bond Position:  [1.31850024]


portfolio before change:  [9.14249975]
curr_Stock_Price:  100.29972284124202
curr_Factors:  [100.29972284]
mat_Sqrt:  [[0.15]]
grads:  [-0.04606401]
Stock Position:  -0.04606400856818304
Bond Position:  [13.76270704]


portfolio before change:  [9.14750343]
curr_Stock_Price:  100.20977239398064
curr_Factors:  [100.20977239]
mat_Sqrt:  [[0.15]]
grads:  [0.03872702]
Stock Position:  0.03872702011030762
Bond Position:  [5.26667755]


portfolio before change:  [9.12787885]
curr_Stock_Price:  99.69453119970785
curr_Factors:  [99.6945312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05360114]
Stock Position:  -0.053601139319989985
Bond Position:  [14.4716193]


portfolio before change:  [9.10326698]
curr_Stock_Price:  100.17057279853726
curr_Factors:  [100.1705728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01942562]
Stock Position:  -0.019425622228028887
Bond Position:  [11.04914268]


portfolio before change:  [9.10322463]
curr_Stock_Price:  100.20830327599798
curr_Factors:  [100.20830328]
mat_Sqrt:  [[0.15]]
grads:  [0.02759949]
Stock Position:  0.027599490497330813
Bond Position:  [6.33752652]


portfolio before change:  [9.10343467]
curr_Stock_Price:  100.2015613882764
curr_Factors:  [100.20156139]
mat_Sqrt:  [[0.15]]
grads:  [-0.0789767]
Stock Position:  -0.07897669796067723
Bond Position:  [17.01702312]


portfolio before change:  [9.08909736]
curr_Stock_Price:  100.39656709839876
curr_Factors:  [100.3965671]
mat_Sqrt:  [[0.15]]
grads:  [0.03248239]
Stock Position:  0.03248238832620112
Bond Position:  [5.82797708]


portfolio before change:  [9.13078407]
curr_Stock_Price:  101.6687163696913
curr_Factors:  [101.66871637]
mat_Sqrt:  [[0.15]]
grads:  [0.05438587]
Stock Position:  0.054385874516411144
Bond Position:  [3.60144202]


portfolio before change:  [9.10437851]
curr_Stock_Price:  101.17905516041898
curr_Factors:  [101.17905516]
mat_Sqrt:  [[0.15]]
grads:  [0.07610094]
Stock Position:  0.07610094411444467
Bond Position:  [1.40455689]


portfolio before change:  [9.14244733]
curr_Stock_Price:  101.67814272507266
curr_Factors:  [101.67814273]
mat_Sqrt:  [[0.15]]
grads:  [0.05689163]
Stock Position:  0.056891632398799324
Bond Position:  [3.35781181]


portfolio before change:  [9.12009264]
curr_Stock_Price:  101.28151914129471
curr_Factors:  [101.28151914]
mat_Sqrt:  [[0.15]]
grads:  [-0.22625542]
Stock Position:  -0.2262554243450767
Bond Position:  [32.03558573]


portfolio before change:  [9.02628191]
curr_Stock_Price:  101.7049919306556
curr_Factors:  [101.70499193]
mat_Sqrt:  [[0.15]]
grads:  [0.06383936]
Stock Position:  0.06383936172642986
Bond Position:  [2.53350014]


portfolio before change:  [9.05148577]
curr_Stock_Price:  102.0973128052593
curr_Factors:  [102.09731281]
mat_Sqrt:  [[0.15]]
grads:  [0.0368135]
Stock Position:  0.03681350220959089
Bond Position:  [5.29292612]


portfolio before change:  [9.07037772]
curr_Stock_Price:  102.60150619897041
curr_Factors:  [102.6015062]
mat_Sqrt:  [[0.15]]
grads:  [0.1241831]
Stock Position:  0.1241831022125222
Bond Position:  [-3.67099562]


portfolio before change:  [9.13877424]
curr_Stock_Price:  103.1541254522137
curr_Factors:  [103.15412545]
mat_Sqrt:  [[0.15]]
grads:  [-0.02792379]
Stock Position:  -0.0279237856129296
Bond Position:  [12.01922793]


portfolio before change:  [9.15277682]
curr_Stock_Price:  102.67957136455658
curr_Factors:  [102.67957136]
mat_Sqrt:  [[0.15]]
grads:  [-0.13483255]
Stock Position:  -0.1348325470783959
Bond Position:  [22.99732496]


portfolio before change:  [9.11934711]
curr_Stock_Price:  102.93816680050374
curr_Factors:  [102.9381668]
mat_Sqrt:  [[0.15]]
grads:  [0.13932053]
Stock Position:  0.139320532289547
Bond Position:  [-5.22205308]


portfolio before change:  [9.0398824]
curr_Stock_Price:  102.37013624038094
curr_Factors:  [102.37013624]
mat_Sqrt:  [[0.15]]
grads:  [0.00155146]
Stock Position:  0.0015514577071851048
Bond Position:  [8.88105947]


portfolio before change:  [9.03988667]
curr_Stock_Price:  102.01510422214682
curr_Factors:  [102.01510422]
mat_Sqrt:  [[0.15]]
grads:  [-0.02785987]
Stock Position:  -0.027859866442747242
Bond Position:  [11.88201385]


portfolio before change:  [9.03241664]
curr_Stock_Price:  102.30988941774552
curr_Factors:  [102.30988942]
mat_Sqrt:  [[0.15]]
grads:  [-0.07730931]
Stock Position:  -0.07730930575286976
Bond Position:  [16.94192317]


portfolio before change:  [9.00347099]
curr_Stock_Price:  102.69799994011913
curr_Factors:  [102.69799994]
mat_Sqrt:  [[0.15]]
grads:  [0.09314256]
Stock Position:  0.09314255528455448
Bond Position:  [-0.56208315]


portfolio before change:  [8.96985283]
curr_Stock_Price:  102.33744474357937
curr_Factors:  [102.33744474]
mat_Sqrt:  [[0.15]]
grads:  [0.00454097]
Stock Position:  0.004540973508733801
Bond Position:  [8.5051412]


portfolio before change:  [8.97156868]
curr_Stock_Price:  102.59823904263638
curr_Factors:  [102.59823904]
mat_Sqrt:  [[0.15]]
grads:  [-0.00264736]
Stock Position:  -0.002647363390555586
Bond Position:  [9.2431835]


portfolio before change:  [8.97302092]
curr_Stock_Price:  102.26789860532602
curr_Factors:  [102.26789861]
mat_Sqrt:  [[0.15]]
grads:  [-0.04968249]
Stock Position:  -0.04968248746959479
Bond Position:  [14.05394452]


portfolio before change:  [8.93088515]
curr_Stock_Price:  103.1336799489788
curr_Factors:  [103.13367995]
mat_Sqrt:  [[0.15]]
grads:  [-0.23431322]
Stock Position:  -0.23431322019567127
Bond Position:  [33.09646981]


portfolio before change:  [9.01574288]
curr_Stock_Price:  102.78035316090258
curr_Factors:  [102.78035316]
mat_Sqrt:  [[0.15]]
grads:  [0.01514624]
Stock Position:  0.015146238925990766
Bond Position:  [7.4590071]


portfolio before change:  [9.00734456]
curr_Stock_Price:  102.19509032352721
curr_Factors:  [102.19509032]
mat_Sqrt:  [[0.15]]
grads:  [-0.04560512]
Stock Position:  -0.045605120340568184
Bond Position:  [13.66796395]


portfolio before change:  [9.03524623]
curr_Stock_Price:  101.60201216812544
curr_Factors:  [101.60201217]
mat_Sqrt:  [[0.15]]
grads:  [0.03605633]
Stock Position:  0.03605632699858209
Bond Position:  [5.37185086]


portfolio before change:  [9.03570266]
curr_Stock_Price:  101.60535922294221
curr_Factors:  [101.60535922]
mat_Sqrt:  [[0.15]]
grads:  [0.02150528]
Stock Position:  0.021505282963366748
Bond Position:  [6.85065066]


portfolio before change:  [9.05877656]
curr_Stock_Price:  102.65838956126068
curr_Factors:  [102.65838956]
mat_Sqrt:  [[0.15]]
grads:  [0.02912691]
Stock Position:  0.029126906611354614
Bond Position:  [6.06865523]


portfolio before change:  [9.06725477]
curr_Stock_Price:  102.93644545777524
curr_Factors:  [102.93644546]
mat_Sqrt:  [[0.15]]
grads:  [0.06506222]
Stock Position:  0.06506222164621434
Bond Position:  [2.36998094]


portfolio before change:  [9.12991004]
curr_Stock_Price:  103.89717418167825
curr_Factors:  [103.89717418]
mat_Sqrt:  [[0.15]]
grads:  [0.00212823]
Stock Position:  0.0021282339236149226
Bond Position:  [8.90879255]


portfolio before change:  [9.13093945]
curr_Stock_Price:  104.11922914058265
curr_Factors:  [104.11922914]
mat_Sqrt:  [[0.15]]
grads:  [0.01188997]
Stock Position:  0.011889970808599503
Bond Position:  [7.89296485]


portfolio before change:  [9.13750011]
curr_Stock_Price:  104.62951949676102
curr_Factors:  [104.6295195]
mat_Sqrt:  [[0.15]]
grads:  [0.07184162]
Stock Position:  0.07184161942308497
Bond Position:  [1.62074599]


portfolio before change:  [9.19525078]
curr_Stock_Price:  105.4319704252193
curr_Factors:  [105.43197043]
mat_Sqrt:  [[0.15]]
grads:  [0.09156814]
Stock Position:  0.09156813853373587
Bond Position:  [-0.45895849]


portfolio before change:  [9.18471873]
curr_Stock_Price:  105.3172649740277
curr_Factors:  [105.31726497]
mat_Sqrt:  [[0.15]]
grads:  [0.22485834]
Stock Position:  0.22485834389462714
Bond Position:  [-14.49674705]


portfolio before change:  [9.4689705]
curr_Stock_Price:  106.58543157740826
curr_Factors:  [106.58543158]
mat_Sqrt:  [[0.15]]
grads:  [-0.01771854]
Stock Position:  -0.017718536055080482
Bond Position:  [11.35750831]


portfolio before change:  [9.47051037]
curr_Stock_Price:  106.538587971429
curr_Factors:  [106.53858797]
mat_Sqrt:  [[0.15]]
grads:  [-0.08066332]
Stock Position:  -0.08066331901453777
Bond Position:  [18.06426647]


portfolio before change:  [9.54868353]
curr_Stock_Price:  105.58345605986224
curr_Factors:  [105.58345606]
mat_Sqrt:  [[0.15]]
grads:  [0.10025095]
Stock Position:  0.10025094672103185
Bond Position:  [-1.0361579]


portfolio before change:  [9.53635926]
curr_Stock_Price:  105.46116784579095
curr_Factors:  [105.46116785]
mat_Sqrt:  [[0.15]]
grads:  [0.04627504]
Stock Position:  0.046275041147887275
Bond Position:  [4.65613938]


portfolio before change:  [9.58292519]
curr_Stock_Price:  106.46116516548929
curr_Factors:  [106.46116517]
mat_Sqrt:  [[0.15]]
grads:  [-0.03380893]
Stock Position:  -0.033808934100352996
Bond Position:  [13.18226371]


portfolio before change:  [9.59885194]
curr_Stock_Price:  106.0144539551884
curr_Factors:  [106.01445396]
mat_Sqrt:  [[0.15]]
grads:  [0.10349156]
Stock Position:  0.10349155888909058
Bond Position:  [-1.37274917]


portfolio before change:  [9.64665673]
curr_Stock_Price:  106.47720276395317
curr_Factors:  [106.47720276]
mat_Sqrt:  [[0.15]]
grads:  [-0.10126785]
Stock Position:  -0.10126784746687548
Bond Position:  [20.42937386]


portfolio before change:  [9.53816232]
curr_Stock_Price:  107.56117259202442
curr_Factors:  [107.56117259]
mat_Sqrt:  [[0.15]]
grads:  [-0.25985839]
Stock Position:  -0.25985838808378786
Bond Position:  [37.48883525]


portfolio before change:  [9.00642763]
curr_Stock_Price:  109.61643746113214
curr_Factors:  [109.61643746]
mat_Sqrt:  [[0.15]]
grads:  [0.01092542]
Stock Position:  0.010925417459138886
Bond Position:  [7.80882229]


portfolio before change:  [9.00536301]
curr_Stock_Price:  109.47432098328947
curr_Factors:  [109.47432098]
mat_Sqrt:  [[0.15]]
grads:  [0.11649226]
Stock Position:  0.11649226355137154
Bond Position:  [-3.74754844]


portfolio before change:  [9.0286242]
curr_Stock_Price:  109.67601177649395
curr_Factors:  [109.67601178]
mat_Sqrt:  [[0.15]]
grads:  [-0.30485443]
Stock Position:  -0.3048544272151846
Bond Position:  [42.46384195]


portfolio before change:  [9.23026783]
curr_Stock_Price:  109.02327546566639
curr_Factors:  [109.02327547]
mat_Sqrt:  [[0.15]]
grads:  [0.19417739]
Stock Position:  0.19417739008184898
Bond Position:  [-11.93958726]


portfolio before change:  [9.09988614]
curr_Stock_Price:  108.35566197807566
curr_Factors:  [108.35566198]
mat_Sqrt:  [[0.15]]
grads:  [-0.20533105]
Stock Position:  -0.20533104961426696
Bond Position:  [31.34866794]


portfolio before change:  [9.01161796]
curr_Stock_Price:  108.79508665000905
curr_Factors:  [108.79508665]
mat_Sqrt:  [[0.15]]
grads:  [0.05114449]
Stock Position:  0.051144489637222776
Bond Position:  [3.44734878]


portfolio before change:  [8.99889668]
curr_Stock_Price:  108.54214148335677
curr_Factors:  [108.54214148]
mat_Sqrt:  [[0.15]]
grads:  [0.06933085]
Stock Position:  0.06933085189034442
Bond Position:  [1.47357754]


portfolio before change:  [8.95253134]
curr_Stock_Price:  107.87205827774355
curr_Factors:  [107.87205828]
mat_Sqrt:  [[0.15]]
grads:  [-0.11422478]
Stock Position:  -0.11422477839694949
Bond Position:  [21.27419329]


portfolio before change:  [9.03793506]
curr_Stock_Price:  107.1360179218147
curr_Factors:  [107.13601792]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.03793506]
Stock Price:  106.08854343689401
PL:  [2.94939163]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.37845901e-03]
 [-1.03367685e-02]
 [-2.38270977e-03]
 [ 7.58059079e-03]
 [ 1.26995818e-03]
 [ 2.18175314e-02]
 [ 6.21961565e-04]
 [-1.79091918e-02]
 [ 1.34295744e-02]
 [-3.67356933e-03]
 [ 1.59225997e-02]
 [-1.78468755e-02]
 [ 2.81433662e-03]
 [ 2.47210746e-03]
 [-6.91812804e-03]
 [ 8.94289911e-03]
 [ 7.99878230e-03]
 [-8.83362113e-03]
 [ 2.27890648e-03]
 [ 8.60368891e-03]
 [ 1.28086101e-02]
 [-1.04875132e-02]
 [ 3.45115593e-03]
 [-7.26513867e-03]
 [-1.08540607e-02]
 [-6.83485424e-03]
 [-2.48557376e-03]
 [ 7.66256104e-03]
 [-1.27767744e-02]
 [-1.33700813e-03]
 [-4.55837061e-03]
 [-1.10072410e-02]
 [-6.89870553e-03]
 [ 4.78041793e-03]
 [ 1.26841460e-02]
 [ 1.59519341e-02]
 [-3.44620127e-02]
 [ 8.52740191e-03]
 [-2.57347311e-02]
 [ 1.96539861e-02]
 [-7.74841274e-03]
 [ 2.88742844e-02]
 [ 2.31237204e-02]
 [ 4.28466328e-03]
 [ 4.98516438e-03]
 [ 1.40480794e-02]
 [ 2.21284076e-04]
 [-1.01633894e-02]
 [ 8.82616912e-03]
 [ 5.25400664e-03]
 [ 3.60096672e-02]
 [ 7.05998473e-03]
 [ 4.74540973e-05]
 [ 4.43505477e-03]
 [ 4.02268270e-03]
 [ 3.86500634e-03]
 [-1.93016338e-02]
 [ 6.72275084e-04]
 [ 1.59872493e-03]
 [-6.95831001e-02]
 [-1.10838104e-02]
 [ 1.56004126e-02]
 [ 1.47226834e-02]
 [-1.89832507e-02]
 [-5.25087003e-03]
 [-1.39187252e-02]
 [-4.67623280e-03]
 [ 8.30602314e-03]
 [-1.30639787e-02]
 [ 9.60017440e-03]
 [-2.19942696e-03]
 [ 1.16247816e-02]
 [ 4.17897978e-04]
 [ 4.45446896e-03]
 [-1.05340855e-02]
 [-7.58159065e-03]
 [-4.03141135e-04]
 [ 8.07764928e-04]
 [-9.98412233e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.1902446]
curr_Stock_Price:  99.2046263195072
curr_Factors:  [99.20462632]
mat_Sqrt:  [[0.15]]
grads:  [0.04252306]
Stock Position:  0.042523060079431574
Bond Position:  [-14.40872888]


portfolio before change:  [-10.19089943]
curr_Stock_Price:  99.21040542690744
curr_Factors:  [99.21040543]
mat_Sqrt:  [[0.15]]
grads:  [-0.06891179]
Stock Position:  -0.06891179006464707
Bond Position:  [-3.3541328]


portfolio before change:  [-10.18527018]
curr_Stock_Price:  99.1256755648543
curr_Factors:  [99.12567556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588473]
Stock Position:  -0.015884731817649014
Bond Position:  [-8.61068541]


portfolio before change:  [-10.18544288]
curr_Stock_Price:  99.10266684765321
curr_Factors:  [99.10266685]
mat_Sqrt:  [[0.15]]
grads:  [0.05053727]
Stock Position:  0.05053727195760556
Bond Position:  [-15.1938213]


portfolio before change:  [-10.1861628]
curr_Stock_Price:  99.10721242841613
curr_Factors:  [99.10721243]
mat_Sqrt:  [[0.15]]
grads:  [0.00846639]
Stock Position:  0.008466387876263354
Bond Position:  [-11.0252429]


portfolio before change:  [-10.18251927]
curr_Stock_Price:  99.61895697222529
curr_Factors:  [99.61895697]
mat_Sqrt:  [[0.15]]
grads:  [0.14545021]
Stock Position:  0.14545020925249977
Bond Position:  [-24.67211741]


portfolio before change:  [-10.17520086]
curr_Stock_Price:  99.67987449423124
curr_Factors:  [99.67987449]
mat_Sqrt:  [[0.15]]
grads:  [0.00414641]
Stock Position:  0.004146410433575314
Bond Position:  [-10.58851453]


portfolio before change:  [-10.17670437]
curr_Stock_Price:  99.476877904544
curr_Factors:  [99.4768779]
mat_Sqrt:  [[0.15]]
grads:  [-0.11939461]
Stock Position:  -0.11939461205075712
Bond Position:  [1.70029888]


portfolio before change:  [-10.19534549]
curr_Stock_Price:  99.63389835768074
curr_Factors:  [99.63389836]
mat_Sqrt:  [[0.15]]
grads:  [0.0895305]
Stock Position:  0.08953049591520898
Bond Position:  [-19.11561782]


portfolio before change:  [-10.17279947]
curr_Stock_Price:  99.89906823381736
curr_Factors:  [99.89906823]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449046]
Stock Position:  -0.024490462170096684
Bond Position:  [-7.72622512]


portfolio before change:  [-10.191975]
curr_Stock_Price:  100.66232979453831
curr_Factors:  [100.66232979]
mat_Sqrt:  [[0.15]]
grads:  [0.10615066]
Stock Position:  0.10615066470625323
Bond Position:  [-20.87734822]


portfolio before change:  [-10.21137783]
curr_Stock_Price:  100.49183673530638
curr_Factors:  [100.49183674]
mat_Sqrt:  [[0.15]]
grads:  [-0.11897917]
Stock Position:  -0.11897917030117863
Bond Position:  [1.74505753]


portfolio before change:  [-10.19134976]
curr_Stock_Price:  100.32442086053449
curr_Factors:  [100.32442086]
mat_Sqrt:  [[0.15]]
grads:  [0.01876224]
Stock Position:  0.0187622441523617
Bond Position:  [-12.07366103]


portfolio before change:  [-10.19249219]
curr_Stock_Price:  100.3037515233686
curr_Factors:  [100.30375152]
mat_Sqrt:  [[0.15]]
grads:  [0.01648072]
Stock Position:  0.016480716400254426
Bond Position:  [-11.84556987]


portfolio before change:  [-10.20545789]
curr_Stock_Price:  99.56195549543473
curr_Factors:  [99.5619555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04612085]
Stock Position:  -0.04612085359962083
Bond Position:  [-5.61357551]


portfolio before change:  [-10.19691873]
curr_Stock_Price:  99.36920077889864
curr_Factors:  [99.36920078]
mat_Sqrt:  [[0.15]]
grads:  [0.05961933]
Stock Position:  0.05961932742107166
Bond Position:  [-16.12124365]


portfolio before change:  [-10.25559676]
curr_Stock_Price:  98.4018899950444
curr_Factors:  [98.40189]
mat_Sqrt:  [[0.15]]
grads:  [0.05332522]
Stock Position:  0.05332521532831126
Bond Position:  [-15.50289873]


portfolio before change:  [-10.25999332]
curr_Stock_Price:  98.33761274709664
curr_Factors:  [98.33761275]
mat_Sqrt:  [[0.15]]
grads:  [-0.05889081]
Stock Position:  -0.05889080752720262
Bond Position:  [-4.4688119]


portfolio before change:  [-10.20417032]
curr_Stock_Price:  97.38496298510498
curr_Factors:  [97.38496299]
mat_Sqrt:  [[0.15]]
grads:  [0.01519271]
Stock Position:  0.015192709857135576
Bond Position:  [-11.6837118]


portfolio before change:  [-10.20563176]
curr_Stock_Price:  97.33683539199176
curr_Factors:  [97.33683539]
mat_Sqrt:  [[0.15]]
grads:  [0.05735793]
Stock Position:  0.05735792607180659
Bond Position:  [-15.78867077]


portfolio before change:  [-10.22704008]
curr_Stock_Price:  96.98079916328399
curr_Factors:  [96.98079916]
mat_Sqrt:  [[0.15]]
grads:  [0.08539073]
Stock Position:  0.08539073414780247
Bond Position:  [-18.50830172]


portfolio before change:  [-10.24420249]
curr_Stock_Price:  96.79335964737649
curr_Factors:  [96.79335965]
mat_Sqrt:  [[0.15]]
grads:  [-0.06991675]
Stock Position:  -0.06991675460457937
Bond Position:  [-3.47672491]


portfolio before change:  [-10.25616332]
curr_Stock_Price:  96.96132415716089
curr_Factors:  [96.96132416]
mat_Sqrt:  [[0.15]]
grads:  [0.02300771]
Stock Position:  0.02300770616804899
Bond Position:  [-12.48702098]


portfolio before change:  [-10.23846818]
curr_Stock_Price:  97.76434244964113
curr_Factors:  [97.76434245]
mat_Sqrt:  [[0.15]]
grads:  [-0.04843426]
Stock Position:  -0.04843425780893584
Bond Position:  [-5.50332481]


portfolio before change:  [-10.20139619]
curr_Stock_Price:  96.99183230296812
curr_Factors:  [96.9918323]
mat_Sqrt:  [[0.15]]
grads:  [-0.0723604]
Stock Position:  -0.07236040449626112
Bond Position:  [-3.18302797]


portfolio before change:  [-10.23919654]
curr_Stock_Price:  97.51147295087729
curr_Factors:  [97.51147295]
mat_Sqrt:  [[0.15]]
grads:  [-0.04556569]
Stock Position:  -0.045565694924111826
Bond Position:  [-5.79601851]


portfolio before change:  [-10.24709166]
curr_Stock_Price:  97.67679146654254
curr_Factors:  [97.67679147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01657049]
Stock Position:  -0.016570491701031396
Bond Position:  [-8.62853919]


portfolio before change:  [-10.25704328]
curr_Stock_Price:  98.24480859513177
curr_Factors:  [98.2448086]
mat_Sqrt:  [[0.15]]
grads:  [0.05108374]
Stock Position:  0.05108374028536005
Bond Position:  [-15.27575557]


portfolio before change:  [-10.22588976]
curr_Stock_Price:  98.87335081203715
curr_Factors:  [98.87335081]
mat_Sqrt:  [[0.15]]
grads:  [-0.0851785]
Stock Position:  -0.08517849583453112
Bond Position:  [-1.80400646]


portfolio before change:  [-10.23349451]
curr_Stock_Price:  98.96130729194009
curr_Factors:  [98.96130729]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891339]
Stock Position:  -0.008913387532803801
Bond Position:  [-9.35141403]


portfolio before change:  [-10.23144946]
curr_Stock_Price:  98.66629807158427
curr_Factors:  [98.66629807]
mat_Sqrt:  [[0.15]]
grads:  [-0.03038914]
Stock Position:  -0.030389137379801246
Bond Position:  [-7.23306578]


portfolio before change:  [-10.26585683]
curr_Stock_Price:  99.78364740791876
curr_Factors:  [99.78364741]
mat_Sqrt:  [[0.15]]
grads:  [-0.07338161]
Stock Position:  -0.07338160683472787
Bond Position:  [-2.94357244]


portfolio before change:  [-10.18138261]
curr_Stock_Price:  98.62997685225083
curr_Factors:  [98.62997685]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599137]
Stock Position:  -0.04599137018439881
Bond Position:  [-5.64525483]


portfolio before change:  [-10.17145857]
curr_Stock_Price:  98.40652469827113
curr_Factors:  [98.4065247]
mat_Sqrt:  [[0.15]]
grads:  [0.03186945]
Stock Position:  0.03186945285315122
Bond Position:  [-13.30762067]


portfolio before change:  [-10.1688457]
curr_Stock_Price:  98.51461025737142
curr_Factors:  [98.51461026]
mat_Sqrt:  [[0.15]]
grads:  [0.08456097]
Stock Position:  0.0845609730163841
Bond Position:  [-18.499337]


portfolio before change:  [-10.23471135]
curr_Stock_Price:  97.74937063822992
curr_Factors:  [97.74937064]
mat_Sqrt:  [[0.15]]
grads:  [0.10634623]
Stock Position:  0.10634622764869253
Bond Position:  [-20.62998817]


portfolio before change:  [-10.22198515]
curr_Stock_Price:  97.8811629194713
curr_Factors:  [97.88116292]
mat_Sqrt:  [[0.15]]
grads:  [-0.22974675]
Stock Position:  -0.2297467510299808
Bond Position:  [12.26589401]


portfolio before change:  [-10.06031581]
curr_Stock_Price:  97.18081481183643
curr_Factors:  [97.18081481]
mat_Sqrt:  [[0.15]]
grads:  [0.05684935]
Stock Position:  0.05684934608767837
Bond Position:  [-15.58498158]


portfolio before change:  [-10.04717666]
curr_Stock_Price:  97.42907166701733
curr_Factors:  [97.42907167]
mat_Sqrt:  [[0.15]]
grads:  [-0.17156487]
Stock Position:  -0.1715648741185757
Bond Position:  [6.66822976]


portfolio before change:  [-10.12076082]
curr_Stock_Price:  97.86040084032626
curr_Factors:  [97.86040084]
mat_Sqrt:  [[0.15]]
grads:  [0.13102657]
Stock Position:  0.13102657393791295
Bond Position:  [-22.94307386]


portfolio before change:  [-10.12335482]
curr_Stock_Price:  97.85154755694062
curr_Factors:  [97.85154756]
mat_Sqrt:  [[0.15]]
grads:  [-0.05165608]
Stock Position:  -0.0516560849648212
Bond Position:  [-5.06872697]


portfolio before change:  [-10.09110993]
curr_Stock_Price:  97.22119207491035
curr_Factors:  [97.22119207]
mat_Sqrt:  [[0.15]]
grads:  [0.19249523]
Stock Position:  0.19249522965916918
Bond Position:  [-28.80572563]


portfolio before change:  [-10.12382185]
curr_Stock_Price:  97.06060884884094
curr_Factors:  [97.06060885]
mat_Sqrt:  [[0.15]]
grads:  [0.15415814]
Stock Position:  0.15415813589587063
Bond Position:  [-25.08650438]


portfolio before change:  [-10.04494979]
curr_Stock_Price:  97.58241077042123
curr_Factors:  [97.58241077]
mat_Sqrt:  [[0.15]]
grads:  [0.02856442]
Stock Position:  0.02856442187026778
Bond Position:  [-12.83233494]


portfolio before change:  [-10.07977009]
curr_Stock_Price:  96.39147989227533
curr_Factors:  [96.39147989]
mat_Sqrt:  [[0.15]]
grads:  [0.03323443]
Stock Position:  0.03323442918770336
Bond Position:  [-13.2832859]


portfolio before change:  [-10.10133438]
curr_Stock_Price:  95.76760711290252
curr_Factors:  [95.76760711]
mat_Sqrt:  [[0.15]]
grads:  [0.09365386]
Stock Position:  0.09365386237691703
Bond Position:  [-19.07034067]


portfolio before change:  [-10.04230238]
curr_Stock_Price:  96.41065510809402
curr_Factors:  [96.41065511]
mat_Sqrt:  [[0.15]]
grads:  [0.00147523]
Stock Position:  0.0014752271729575584
Bond Position:  [-10.18453]


portfolio before change:  [-10.04352993]
curr_Stock_Price:  96.01004033364975
curr_Factors:  [96.01004033]
mat_Sqrt:  [[0.15]]
grads:  [-0.06775593]
Stock Position:  -0.06775592907453186
Bond Position:  [-3.53828045]


portfolio before change:  [-10.03366146]
curr_Stock_Price:  95.86112907809547
curr_Factors:  [95.86112908]
mat_Sqrt:  [[0.15]]
grads:  [0.05884113]
Stock Position:  0.05884112749703862
Bond Position:  [-15.67423838]


portfolio before change:  [-10.07200679]
curr_Stock_Price:  95.22610294058204
curr_Factors:  [95.22610294]
mat_Sqrt:  [[0.15]]
grads:  [0.03502671]
Stock Position:  0.0350267109473077
Bond Position:  [-13.40746397]


portfolio before change:  [-10.05530749]
curr_Stock_Price:  95.72678624678109
curr_Factors:  [95.72678625]
mat_Sqrt:  [[0.15]]
grads:  [0.24006445]
Stock Position:  0.24006444771555294
Bond Position:  [-33.03590556]


portfolio before change:  [-10.25428633]
curr_Stock_Price:  94.90653137220413
curr_Factors:  [94.90653137]
mat_Sqrt:  [[0.15]]
grads:  [0.04706656]
Stock Position:  0.04706656488189363
Bond Position:  [-14.72121075]


portfolio before change:  [-10.28333151]
curr_Stock_Price:  94.3089718732035
curr_Factors:  [94.30897187]
mat_Sqrt:  [[0.15]]
grads:  [0.00031636]
Stock Position:  0.0003163606486146093
Bond Position:  [-10.31316716]


portfolio before change:  [-10.28409699]
curr_Stock_Price:  93.9268437148893
curr_Factors:  [93.92684371]
mat_Sqrt:  [[0.15]]
grads:  [0.02956703]
Stock Position:  0.029567031806851315
Bond Position:  [-13.06123497]


portfolio before change:  [-10.27557606]
curr_Stock_Price:  94.24264433111875
curr_Factors:  [94.24264433]
mat_Sqrt:  [[0.15]]
grads:  [0.02681788]
Stock Position:  0.026817884685420672
Bond Position:  [-12.80296443]


portfolio before change:  [-10.25295258]
curr_Stock_Price:  95.11607983424057
curr_Factors:  [95.11607983]
mat_Sqrt:  [[0.15]]
grads:  [0.02576671]
Stock Position:  0.025766708949313523
Bond Position:  [-12.70378092]


portfolio before change:  [-10.28163116]
curr_Stock_Price:  94.03388592847281
curr_Factors:  [94.03388593]
mat_Sqrt:  [[0.15]]
grads:  [-0.12867756]
Stock Position:  -0.12867755872496398
Bond Position:  [1.81841972]


portfolio before change:  [-10.23913343]
curr_Stock_Price:  93.70450389557936
curr_Factors:  [93.7045039]
mat_Sqrt:  [[0.15]]
grads:  [0.00448183]
Stock Position:  0.0044818338956175005
Bond Position:  [-10.65910145]


portfolio before change:  [-10.23678764]
curr_Stock_Price:  94.37655293902787
curr_Factors:  [94.37655294]
mat_Sqrt:  [[0.15]]
grads:  [0.01065817]
Stock Position:  0.010658166198253764
Bond Position:  [-11.24266862]


portfolio before change:  [-10.23382857]
curr_Stock_Price:  94.72011606932978
curr_Factors:  [94.72011607]
mat_Sqrt:  [[0.15]]
grads:  [-0.46388733]
Stock Position:  -0.46388733426414663
Bond Position:  [33.70563357]


portfolio before change:  [-10.52691275]
curr_Stock_Price:  95.3564577566034
curr_Factors:  [95.35645776]
mat_Sqrt:  [[0.15]]
grads:  [-0.07389207]
Stock Position:  -0.0738920693469646
Bond Position:  [-3.48082676]


portfolio before change:  [-10.56385692]
curr_Stock_Price:  95.85348818088463
curr_Factors:  [95.85348818]
mat_Sqrt:  [[0.15]]
grads:  [0.10400275]
Stock Position:  0.10400275067396605
Bond Position:  [-20.53288335]


portfolio before change:  [-10.52753902]
curr_Stock_Price:  96.2150290320469
curr_Factors:  [96.21502903]
mat_Sqrt:  [[0.15]]
grads:  [0.09815122]
Stock Position:  0.09815122271067236
Bond Position:  [-19.97116176]


portfolio before change:  [-10.57185581]
curr_Stock_Price:  95.77623111954846
curr_Factors:  [95.77623112]
mat_Sqrt:  [[0.15]]
grads:  [-0.126555]
Stock Position:  -0.12655500442853068
Bond Position:  [1.54910555]


portfolio before change:  [-10.62783235]
curr_Stock_Price:  96.21930619895272
curr_Factors:  [96.2193062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0350058]
Stock Position:  -0.03500580017988917
Bond Position:  [-7.25959855]


portfolio before change:  [-10.63322629]
curr_Stock_Price:  96.360431227066
curr_Factors:  [96.36043123]
mat_Sqrt:  [[0.15]]
grads:  [-0.0927915]
Stock Position:  -0.09279150140693385
Bond Position:  [-1.6917972]


portfolio before change:  [-10.63612205]
curr_Stock_Price:  96.39049886675332
curr_Factors:  [96.39049887]
mat_Sqrt:  [[0.15]]
grads:  [-0.03117489]
Stock Position:  -0.031174885325515902
Bond Position:  [-7.6311593]


portfolio before change:  [-10.62375691]
curr_Stock_Price:  95.97856154766079
curr_Factors:  [95.97856155]
mat_Sqrt:  [[0.15]]
grads:  [0.05537349]
Stock Position:  0.055373487606523955
Bond Position:  [-15.9384246]


portfolio before change:  [-10.6174612]
curr_Stock_Price:  96.11024720445688
curr_Factors:  [96.1102472]
mat_Sqrt:  [[0.15]]
grads:  [-0.08709319]
Stock Position:  -0.08709319135517617
Bond Position:  [-2.24691305]


portfolio before change:  [-10.6603772]
curr_Stock_Price:  96.60139426084227
curr_Factors:  [96.60139426]
mat_Sqrt:  [[0.15]]
grads:  [0.06400116]
Stock Position:  0.06400116269481705
Bond Position:  [-16.84297875]


portfolio before change:  [-10.62478229]
curr_Stock_Price:  97.17400303326706
curr_Factors:  [97.17400303]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466285]
Stock Position:  -0.014662846389003118
Bond Position:  [-9.19993482]


portfolio before change:  [-10.62495962]
curr_Stock_Price:  97.14688115409865
curr_Factors:  [97.14688115]
mat_Sqrt:  [[0.15]]
grads:  [0.07749854]
Stock Position:  0.07749854422720212
Bond Position:  [-18.15370149]


portfolio before change:  [-10.64397997]
curr_Stock_Price:  96.91609359364102
curr_Factors:  [96.91609359]
mat_Sqrt:  [[0.15]]
grads:  [0.00278599]
Stock Position:  0.002785986523009585
Bond Position:  [-10.9139869]


portfolio before change:  [-10.64416975]
curr_Stock_Price:  97.09282307292845
curr_Factors:  [97.09282307]
mat_Sqrt:  [[0.15]]
grads:  [0.02969646]
Stock Position:  0.029696459727442427
Bond Position:  [-13.52748286]


portfolio before change:  [-10.63253345]
curr_Stock_Price:  97.51313553463335
curr_Factors:  [97.51313553]
mat_Sqrt:  [[0.15]]
grads:  [-0.07022724]
Stock Position:  -0.07022723693782862
Bond Position:  [-3.78445537]


portfolio before change:  [-10.6810214]
curr_Stock_Price:  98.20021106013394
curr_Factors:  [98.20021106]
mat_Sqrt:  [[0.15]]
grads:  [-0.05054394]
Stock Position:  -0.05054393764267672
Bond Position:  [-5.71759606]


portfolio before change:  [-10.69622991]
curr_Stock_Price:  98.49403764269455
curr_Factors:  [98.49403764]
mat_Sqrt:  [[0.15]]
grads:  [-0.00268761]
Stock Position:  -0.0026876075674729313
Bond Position:  [-10.43151659]


portfolio before change:  [-10.69723927]
curr_Stock_Price:  98.62700432533846
curr_Factors:  [98.62700433]
mat_Sqrt:  [[0.15]]
grads:  [0.0053851]
Stock Position:  0.005385099521881613
Bond Position:  [-11.2283555]


portfolio before change:  [-10.70088911]
curr_Stock_Price:  98.07955849442497
curr_Factors:  [98.07955849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.70088911]
Stock Price:  96.94655535611211
PL:  [-10.70088911]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.27580965e-03]
 [ 9.26477156e-04]
 [ 1.67096819e-06]
 [ 8.40394769e-03]
 [ 5.10907742e-03]
 [ 2.39022611e-02]
 [ 1.45959180e-03]
 [-1.82447815e-02]
 [-8.69520508e-03]
 [ 2.38627322e-02]
 [-4.14652738e-02]
 [ 2.87945659e-02]
 [-9.83447354e-03]
 [ 2.12485934e-03]
 [-6.99752620e-03]
 [ 9.58751636e-03]
 [ 8.55228644e-03]
 [-9.13964447e-03]
 [ 8.28705697e-04]
 [ 1.00877355e-02]
 [ 1.26547275e-02]
 [-1.02096843e-02]
 [ 3.54999430e-03]
 [-1.03228354e-02]
 [-1.03073835e-02]
 [-6.92368525e-03]
 [-1.50679112e-03]
 [ 9.98391359e-03]
 [-2.76374132e-02]
 [-9.43495547e-05]
 [-3.82015551e-03]
 [-1.06979658e-02]
 [-3.45850295e-03]
 [ 4.58119209e-03]
 [ 1.27520071e-02]
 [ 1.65414393e-02]
 [-3.47117570e-02]
 [ 9.00913488e-03]
 [-1.45691357e-02]
 [ 2.44877792e-02]
 [-5.75827464e-03]
 [-5.04819691e-03]
 [ 2.35033265e-02]
 [ 4.25388905e-03]
 [-7.77746884e-03]
 [-3.98700508e-03]
 [ 1.12407547e-04]
 [-1.23922822e-02]
 [-9.09361075e-03]
 [-3.00054720e-03]
 [ 4.38633086e-02]
 [-7.23010062e-03]
 [ 2.36702343e-03]
 [ 4.93394916e-03]
 [ 4.12705911e-03]
 [ 7.93402144e-04]
 [-2.84470663e-04]
 [-6.19462918e-04]
 [ 1.53292295e-03]
 [-2.62752059e-03]
 [ 3.27744334e-04]
 [ 3.53140716e-03]
 [ 1.07883867e-02]
 [-1.77059351e-02]
 [-1.25076001e-02]
 [-5.23365141e-03]
 [-4.92230098e-03]
 [ 2.06152954e-02]
 [-9.92231715e-03]
 [ 8.71043145e-03]
 [ 2.53531103e-04]
 [ 1.19534351e-02]
 [ 2.21864345e-03]
 [ 1.86597063e-03]
 [ 5.63533585e-03]
 [-1.67800319e-02]
 [ 4.99601311e-03]
 [ 7.01110341e-03]
 [ 1.25897366e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.87821493]
curr_Stock_Price:  99.48501587159511
curr_Factors:  [99.48501587]
mat_Sqrt:  [[0.15]]
grads:  [0.0285054]
Stock Position:  0.028505397661895
Bond Position:  [-8.71407487]


portfolio before change:  [-5.87023608]
curr_Stock_Price:  99.78402909440213
curr_Factors:  [99.78402909]
mat_Sqrt:  [[0.15]]
grads:  [0.00617651]
Stock Position:  0.006176514376312701
Bond Position:  [-6.48655357]


portfolio before change:  [-5.86839706]
curr_Stock_Price:  100.14741254468413
curr_Factors:  [100.14741254]
mat_Sqrt:  [[0.15]]
grads:  [1.11397879e-05]
Stock Position:  1.1139787905734e-05
Bond Position:  [-5.86951268]


portfolio before change:  [-5.86876877]
curr_Stock_Price:  99.71202866926306
curr_Factors:  [99.71202867]
mat_Sqrt:  [[0.15]]
grads:  [0.05602632]
Stock Position:  0.056026317904441576
Bond Position:  [-11.45526659]


portfolio before change:  [-5.8524936]
curr_Stock_Price:  100.01529940529446
curr_Factors:  [100.01529941]
mat_Sqrt:  [[0.15]]
grads:  [0.03406052]
Stock Position:  0.03406051614404523
Bond Position:  [-9.25906632]


portfolio before change:  [-5.85526498]
curr_Stock_Price:  99.95092370080643
curr_Factors:  [99.9509237]
mat_Sqrt:  [[0.15]]
grads:  [0.15934841]
Stock Position:  0.15934840737080191
Bond Position:  [-21.78228549]


portfolio before change:  [-5.78885694]
curr_Stock_Price:  100.37621491795092
curr_Factors:  [100.37621492]
mat_Sqrt:  [[0.15]]
grads:  [0.00973061]
Stock Position:  0.009730612003810674
Bond Position:  [-6.76557894]


portfolio before change:  [-5.79660857]
curr_Stock_Price:  99.62304851889533
curr_Factors:  [99.62304852]
mat_Sqrt:  [[0.15]]
grads:  [-0.12163188]
Stock Position:  -0.12163187692057756
Bond Position:  [6.3207298]


portfolio before change:  [-5.62433774]
curr_Stock_Price:  98.20996690833864
curr_Factors:  [98.20996691]
mat_Sqrt:  [[0.15]]
grads:  [-0.05796803]
Stock Position:  -0.05796803384229786
Bond Position:  [0.06870094]


portfolio before change:  [-5.64091386]
curr_Stock_Price:  98.49599370259891
curr_Factors:  [98.4959937]
mat_Sqrt:  [[0.15]]
grads:  [0.15908488]
Stock Position:  0.15908488128408857
Bond Position:  [-21.31013733]


portfolio before change:  [-5.76118912]
curr_Stock_Price:  97.74832157124938
curr_Factors:  [97.74832157]
mat_Sqrt:  [[0.15]]
grads:  [-0.27643516]
Stock Position:  -0.2764351584366873
Bond Position:  [21.25988364]


portfolio before change:  [-5.72092775]
curr_Stock_Price:  97.6074835392332
curr_Factors:  [97.60748354]
mat_Sqrt:  [[0.15]]
grads:  [0.19196377]
Stock Position:  0.1919637726261046
Bond Position:  [-24.45802853]


portfolio before change:  [-5.83587287]
curr_Stock_Price:  97.01666143807755
curr_Factors:  [97.01666144]
mat_Sqrt:  [[0.15]]
grads:  [-0.06556316]
Stock Position:  -0.06556315692470882
Bond Position:  [0.52484573]


portfolio before change:  [-5.85928166]
curr_Stock_Price:  97.37420370760887
curr_Factors:  [97.37420371]
mat_Sqrt:  [[0.15]]
grads:  [0.01416573]
Stock Position:  0.014165728920424977
Bond Position:  [-7.23865823]


portfolio before change:  [-5.85004955]
curr_Stock_Price:  98.05786360312567
curr_Factors:  [98.0578636]
mat_Sqrt:  [[0.15]]
grads:  [-0.04665017]
Stock Position:  -0.046650174672189196
Bond Position:  [-1.27563309]


portfolio before change:  [-5.8426589]
curr_Stock_Price:  97.89772745255972
curr_Factors:  [97.89772745]
mat_Sqrt:  [[0.15]]
grads:  [0.06391678]
Stock Position:  0.06391677575200753
Bond Position:  [-12.09996599]


portfolio before change:  [-5.82087856]
curr_Stock_Price:  98.25032045771238
curr_Factors:  [98.25032046]
mat_Sqrt:  [[0.15]]
grads:  [0.05701524]
Stock Position:  0.05701524292623468
Bond Position:  [-11.42264445]


portfolio before change:  [-5.78569255]
curr_Stock_Price:  98.8799757663803
curr_Factors:  [98.87997577]
mat_Sqrt:  [[0.15]]
grads:  [-0.06093096]
Stock Position:  -0.06093096311166896
Bond Position:  [0.2391596]


portfolio before change:  [-5.76977999]
curr_Stock_Price:  98.61906382635118
curr_Factors:  [98.61906383]
mat_Sqrt:  [[0.15]]
grads:  [0.0055247]
Stock Position:  0.00552470464582914
Bond Position:  [-6.31462119]


portfolio before change:  [-5.77143114]
curr_Stock_Price:  98.39163478822313
curr_Factors:  [98.39163479]
mat_Sqrt:  [[0.15]]
grads:  [0.06725157]
Stock Position:  0.0672515700238287
Bond Position:  [-12.38842306]


portfolio before change:  [-5.84518327]
curr_Stock_Price:  97.30648790034901
curr_Factors:  [97.3064879]
mat_Sqrt:  [[0.15]]
grads:  [0.08436485]
Stock Position:  0.08436485027510314
Bond Position:  [-14.05443056]


portfolio before change:  [-5.86037768]
curr_Stock_Price:  97.13679671878577
curr_Factors:  [97.13679672]
mat_Sqrt:  [[0.15]]
grads:  [-0.06806456]
Stock Position:  -0.06806456169605761
Bond Position:  [0.75119582]


portfolio before change:  [-5.8501696]
curr_Stock_Price:  96.98751018356971
curr_Factors:  [96.98751018]
mat_Sqrt:  [[0.15]]
grads:  [0.02366663]
Stock Position:  0.023666628666331603
Bond Position:  [-8.14553699]


portfolio before change:  [-5.83673141]
curr_Stock_Price:  97.57683370567148
curr_Factors:  [97.57683371]
mat_Sqrt:  [[0.15]]
grads:  [-0.0688189]
Stock Position:  -0.06881890294983632
Bond Position:  [0.87839924]


portfolio before change:  [-5.81806253]
curr_Stock_Price:  97.3063559977964
curr_Factors:  [97.306356]
mat_Sqrt:  [[0.15]]
grads:  [-0.06871589]
Stock Position:  -0.068715889884552
Bond Position:  [0.86843031]


portfolio before change:  [-5.83331918]
curr_Stock_Price:  97.52917094201709
curr_Factors:  [97.52917094]
mat_Sqrt:  [[0.15]]
grads:  [-0.0461579]
Stock Position:  -0.04615790169440327
Bond Position:  [-1.3315773]


portfolio before change:  [-5.81833433]
curr_Stock_Price:  97.20272460403953
curr_Factors:  [97.2027246]
mat_Sqrt:  [[0.15]]
grads:  [-0.01004527]
Stock Position:  -0.010045274153394462
Bond Position:  [-4.84190631]


portfolio before change:  [-5.81596822]
curr_Stock_Price:  96.9370533448206
curr_Factors:  [96.93705334]
mat_Sqrt:  [[0.15]]
grads:  [0.06655942]
Stock Position:  0.06655942396421308
Bond Position:  [-12.26804265]


portfolio before change:  [-5.78662235]
curr_Stock_Price:  97.38947082395458
curr_Factors:  [97.38947082]
mat_Sqrt:  [[0.15]]
grads:  [-0.18424942]
Stock Position:  -0.1842494212415135
Bond Position:  [12.15733129]


portfolio before change:  [-5.97011712]
curr_Stock_Price:  98.38949908952752
curr_Factors:  [98.38949909]
mat_Sqrt:  [[0.15]]
grads:  [-0.000629]
Stock Position:  -0.0006289970316051385
Bond Position:  [-5.90823042]


portfolio before change:  [-5.97057474]
curr_Stock_Price:  98.52996036332357
curr_Factors:  [98.52996036]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254677]
Stock Position:  -0.0254677033983402
Bond Position:  [-3.46124294]


portfolio before change:  [-5.97531794]
curr_Stock_Price:  98.70770937977265
curr_Factors:  [98.70770938]
mat_Sqrt:  [[0.15]]
grads:  [-0.07131977]
Stock Position:  -0.07131977168586402
Bond Position:  [1.06449336]


portfolio before change:  [-6.01357274]
curr_Stock_Price:  99.24502651419333
curr_Factors:  [99.24502651]
mat_Sqrt:  [[0.15]]
grads:  [-0.02305669]
Stock Position:  -0.0230566863441409
Bond Position:  [-3.72531129]


portfolio before change:  [-6.00201253]
curr_Stock_Price:  98.73354598688627
curr_Factors:  [98.73354599]
mat_Sqrt:  [[0.15]]
grads:  [0.03054128]
Stock Position:  0.030541280603819006
Bond Position:  [-9.01746147]


portfolio before change:  [-6.0123798]
curr_Stock_Price:  98.41254909974886
curr_Factors:  [98.4125491]
mat_Sqrt:  [[0.15]]
grads:  [0.08501338]
Stock Position:  0.08501338040415812
Bond Position:  [-14.37876327]


portfolio before change:  [-5.9946266]
curr_Stock_Price:  98.63194865990454
curr_Factors:  [98.63194866]
mat_Sqrt:  [[0.15]]
grads:  [0.11027626]
Stock Position:  0.11027626195171703
Bond Position:  [-16.87138921]


portfolio before change:  [-6.02283362]
curr_Stock_Price:  98.38572587750424
curr_Factors:  [98.38572588]
mat_Sqrt:  [[0.15]]
grads:  [-0.23141171]
Stock Position:  -0.23141171360920176
Bond Position:  [16.7447758]


portfolio before change:  [-6.03354678]
curr_Stock_Price:  98.43654325707523
curr_Factors:  [98.43654326]
mat_Sqrt:  [[0.15]]
grads:  [0.0600609]
Stock Position:  0.06006089917182003
Bond Position:  [-11.94573408]


portfolio before change:  [-5.99083514]
curr_Stock_Price:  99.16011329605911
curr_Factors:  [99.1601133]
mat_Sqrt:  [[0.15]]
grads:  [-0.09712757]
Stock Position:  -0.09712757112064026
Bond Position:  [3.64034581]


portfolio before change:  [-5.99769934]
curr_Stock_Price:  99.23312786958618
curr_Factors:  [99.23312787]
mat_Sqrt:  [[0.15]]
grads:  [0.16325186]
Stock Position:  0.16325186118522828
Bond Position:  [-22.19769216]


portfolio before change:  [-5.95462937]
curr_Stock_Price:  99.50545170990245
curr_Factors:  [99.50545171]
mat_Sqrt:  [[0.15]]
grads:  [-0.0383885]
Stock Position:  -0.03838849761281702
Bond Position:  [-2.13476457]


portfolio before change:  [-5.95595285]
curr_Stock_Price:  99.53645191197118
curr_Factors:  [99.53645191]
mat_Sqrt:  [[0.15]]
grads:  [-0.03365465]
Stock Position:  -0.03365464609619624
Bond Position:  [-2.60608878]


portfolio before change:  [-5.96006273]
curr_Stock_Price:  99.65373141314457
curr_Factors:  [99.65373141]
mat_Sqrt:  [[0.15]]
grads:  [0.15668884]
Stock Position:  0.1566888431429769
Bond Position:  [-21.57469062]


portfolio before change:  [-6.03093101]
curr_Stock_Price:  99.21005067486645
curr_Factors:  [99.21005067]
mat_Sqrt:  [[0.15]]
grads:  [0.02835926]
Stock Position:  0.028359260350345826
Bond Position:  [-8.84445467]


portfolio before change:  [-6.03468542]
curr_Stock_Price:  99.09715592465436
curr_Factors:  [99.09715592]
mat_Sqrt:  [[0.15]]
grads:  [-0.05184979]
Stock Position:  -0.05184979227387181
Bond Position:  [-0.89651847]


portfolio before change:  [-6.06951674]
curr_Stock_Price:  99.76784880924826
curr_Factors:  [99.76784881]
mat_Sqrt:  [[0.15]]
grads:  [-0.02658003]
Stock Position:  -0.026580033860494463
Bond Position:  [-3.41768394]


portfolio before change:  [-6.047151]
curr_Stock_Price:  98.91836316231694
curr_Factors:  [98.91836316]
mat_Sqrt:  [[0.15]]
grads:  [0.00074938]
Stock Position:  0.0007493836446556661
Bond Position:  [-6.1212788]


portfolio before change:  [-6.04765913]
curr_Stock_Price:  98.75083844894601
curr_Factors:  [98.75083845]
mat_Sqrt:  [[0.15]]
grads:  [-0.08261521]
Stock Position:  -0.08261521482286881
Bond Position:  [2.1106626]


portfolio before change:  [-6.03257498]
curr_Stock_Price:  98.5698520687984
curr_Factors:  [98.56985207]
mat_Sqrt:  [[0.15]]
grads:  [-0.06062407]
Stock Position:  -0.060624071638788427
Bond Position:  [-0.05686921]


portfolio before change:  [-6.00471958]
curr_Stock_Price:  98.1103158776833
curr_Factors:  [98.11031588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000365]
Stock Position:  -0.02000364801299104
Bond Position:  [-4.04215535]


portfolio before change:  [-5.99548714]
curr_Stock_Price:  97.63614835045253
curr_Factors:  [97.63614835]
mat_Sqrt:  [[0.15]]
grads:  [0.29242206]
Stock Position:  0.2924220575089286
Bond Position:  [-34.54645053]


portfolio before change:  [-6.09147431]
curr_Stock_Price:  97.3152835355357
curr_Factors:  [97.31528354]
mat_Sqrt:  [[0.15]]
grads:  [-0.04820067]
Stock Position:  -0.04820067079875019
Bond Position:  [-1.40081237]


portfolio before change:  [-6.0789126]
curr_Stock_Price:  97.05285436642366
curr_Factors:  [97.05285437]
mat_Sqrt:  [[0.15]]
grads:  [0.01578016]
Stock Position:  0.01578015623168759
Bond Position:  [-7.61042181]


portfolio before change:  [-6.08668543]
curr_Stock_Price:  96.590427879913
curr_Factors:  [96.59042788]
mat_Sqrt:  [[0.15]]
grads:  [0.03289299]
Stock Position:  0.032892994387694725
Bond Position:  [-9.26383383]


portfolio before change:  [-6.0875438]
curr_Stock_Price:  96.58193477462612
curr_Factors:  [96.58193477]
mat_Sqrt:  [[0.15]]
grads:  [0.02751373]
Stock Position:  0.027513727367509292
Bond Position:  [-8.74487283]


portfolio before change:  [-6.08602194]
curr_Stock_Price:  96.6571130001379
curr_Factors:  [96.657113]
mat_Sqrt:  [[0.15]]
grads:  [0.00528935]
Stock Position:  0.005289347624664736
Bond Position:  [-6.59727501]


portfolio before change:  [-6.08498106]
curr_Stock_Price:  96.931858668706
curr_Factors:  [96.93185867]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189647]
Stock Position:  -0.0018964710880991292
Bond Position:  [-5.90115259]


portfolio before change:  [-6.08615325]
curr_Stock_Price:  97.35546686309303
curr_Factors:  [97.35546686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412975]
Stock Position:  -0.004129752788690825
Bond Position:  [-5.68409924]


portfolio before change:  [-6.08682474]
curr_Stock_Price:  97.43203745267664
curr_Factors:  [97.43203745]
mat_Sqrt:  [[0.15]]
grads:  [0.01021949]
Stock Position:  0.010219486303952668
Bond Position:  [-7.08253011]


portfolio before change:  [-6.08522773]
curr_Stock_Price:  97.63162475889104
curr_Factors:  [97.63162476]
mat_Sqrt:  [[0.15]]
grads:  [-0.0175168]
Stock Position:  -0.01751680391666066
Bond Position:  [-4.3750337]


portfolio before change:  [-6.09752316]
curr_Stock_Price:  98.3179360737494
curr_Factors:  [98.31793607]
mat_Sqrt:  [[0.15]]
grads:  [0.00218496]
Stock Position:  0.0021849622238598785
Bond Position:  [-6.31234414]


portfolio before change:  [-6.09931173]
curr_Stock_Price:  97.67992387867325
curr_Factors:  [97.67992388]
mat_Sqrt:  [[0.15]]
grads:  [0.02354271]
Stock Position:  0.023542714405485
Bond Position:  [-8.39896228]


portfolio before change:  [-6.10028491]
curr_Stock_Price:  97.66088494267868
curr_Factors:  [97.66088494]
mat_Sqrt:  [[0.15]]
grads:  [0.07192258]
Stock Position:  0.07192257815632583
Bond Position:  [-13.12430754]


portfolio before change:  [-6.04627041]
curr_Stock_Price:  98.4232991407925
curr_Factors:  [98.42329914]
mat_Sqrt:  [[0.15]]
grads:  [-0.11803957]
Stock Position:  -0.11803956739682903
Bond Position:  [5.57157325]


portfolio before change:  [-6.05423014]
curr_Stock_Price:  98.49368207151525
curr_Factors:  [98.49368207]
mat_Sqrt:  [[0.15]]
grads:  [-0.083384]
Stock Position:  -0.08338400067564199
Bond Position:  [2.15856711]


portfolio before change:  [-6.01393019]
curr_Stock_Price:  98.01199448912476
curr_Factors:  [98.01199449]
mat_Sqrt:  [[0.15]]
grads:  [-0.03489101]
Stock Position:  -0.03489100939336628
Bond Position:  [-2.59419277]


portfolio before change:  [-6.03701697]
curr_Stock_Price:  98.66903004870842
curr_Factors:  [98.66903005]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281534]
Stock Position:  -0.03281533983822819
Bond Position:  [-2.79915921]


portfolio before change:  [-6.03408264]
curr_Stock_Price:  98.57427938760874
curr_Factors:  [98.57427939]
mat_Sqrt:  [[0.15]]
grads:  [0.1374353]
Stock Position:  0.13743530294474518
Bond Position:  [-19.58166859]


portfolio before change:  [-6.09986611]
curr_Stock_Price:  98.10453420025081
curr_Factors:  [98.1045342]
mat_Sqrt:  [[0.15]]
grads:  [-0.06614878]
Stock Position:  -0.06614878102314845
Bond Position:  [0.38962924]


portfolio before change:  [-6.03201641]
curr_Stock_Price:  97.07918880168593
curr_Factors:  [97.0791888]
mat_Sqrt:  [[0.15]]
grads:  [0.05806954]
Stock Position:  0.05806954301905718
Bond Position:  [-11.66936054]


portfolio before change:  [-6.06421641]
curr_Stock_Price:  96.53724134412481
curr_Factors:  [96.53724134]
mat_Sqrt:  [[0.15]]
grads:  [0.00169021]
Stock Position:  0.0016902073529587516
Bond Position:  [-6.22738436]


portfolio before change:  [-6.0655102]
curr_Stock_Price:  96.00205953311844
curr_Factors:  [96.00205953]
mat_Sqrt:  [[0.15]]
grads:  [0.07968957]
Stock Position:  0.07968956725496423
Bond Position:  [-13.71587278]


portfolio before change:  [-6.05291284]
curr_Stock_Price:  96.17089751736823
curr_Factors:  [96.17089752]
mat_Sqrt:  [[0.15]]
grads:  [0.01479096]
Stock Position:  0.01479095632963414
Bond Position:  [-7.47537239]


portfolio before change:  [-6.04983462]
curr_Stock_Price:  96.41060126871076
curr_Factors:  [96.41060127]
mat_Sqrt:  [[0.15]]
grads:  [0.0124398]
Stock Position:  0.012439804209113505
Bond Position:  [-7.24916362]


portfolio before change:  [-6.06689233]
curr_Stock_Price:  95.0758032389476
curr_Factors:  [95.07580324]
mat_Sqrt:  [[0.15]]
grads:  [0.03756891]
Stock Position:  0.03756890564675007
Bond Position:  [-9.63878621]


portfolio before change:  [-6.06320261]
curr_Stock_Price:  95.1900509991823
curr_Factors:  [95.190051]
mat_Sqrt:  [[0.15]]
grads:  [-0.11186688]
Stock Position:  -0.11186687942669832
Bond Position:  [4.58541135]


portfolio before change:  [-5.99964959]
curr_Stock_Price:  94.62449997223153
curr_Factors:  [94.62449997]
mat_Sqrt:  [[0.15]]
grads:  [0.03330675]
Stock Position:  0.03330675403804437
Bond Position:  [-9.15128453]


portfolio before change:  [-5.99367043]
curr_Stock_Price:  94.82119075702357
curr_Factors:  [94.82119076]
mat_Sqrt:  [[0.15]]
grads:  [0.04674069]
Stock Position:  0.046740689385723774
Bond Position:  [-10.42567825]


portfolio before change:  [-6.02451258]
curr_Stock_Price:  94.17527542421969
curr_Factors:  [94.17527542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.02451258]
Stock Price:  95.00875087478164
PL:  [-6.02451258]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.09186134e-03]
 [ 2.73854692e-03]
 [ 5.39418999e-04]
 [ 8.35650987e-03]
 [ 3.65193092e-03]
 [ 2.68935545e-02]
 [ 1.28147308e-03]
 [-3.72304228e-03]
 [ 2.32552514e-02]
 [-4.87277296e-03]
 [ 1.61542922e-02]
 [-3.42319194e-02]
 [ 3.41451405e-03]
 [ 3.75403217e-03]
 [-6.91221973e-03]
 [ 9.98164232e-03]
 [ 7.32189823e-03]
 [-8.84706997e-03]
 [ 8.22160339e-04]
 [ 1.43400076e-02]
 [ 1.13802353e-02]
 [-6.28119535e-03]
 [ 8.10848393e-03]
 [-6.86237614e-03]
 [ 4.89634534e-03]
 [ 1.06100297e-02]
 [-5.49691636e-03]
 [ 5.69980405e-03]
 [-1.31163047e-02]
 [-6.19608734e-04]
 [-6.19399508e-03]
 [-1.03375804e-02]
 [-7.39714951e-03]
 [ 4.91523121e-03]
 [ 1.33615961e-02]
 [ 1.66672032e-02]
 [-3.44512078e-02]
 [ 9.19018020e-03]
 [-1.63212690e-02]
 [ 2.48768967e-02]
 [-6.59029290e-03]
 [-1.00685383e-02]
 [ 2.33620935e-02]
 [ 4.16285360e-03]
 [-7.72218744e-03]
 [-3.45473461e-03]
 [ 8.01807996e-04]
 [-1.24498141e-02]
 [-9.75632969e-03]
 [-3.88263741e-03]
 [ 4.72583321e-02]
 [-1.04833740e-02]
 [ 3.47657542e-03]
 [ 5.08340469e-03]
 [ 4.27880581e-03]
 [ 1.49126923e-03]
 [ 1.58615301e-03]
 [-6.76809966e-04]
 [ 1.54662991e-03]
 [ 2.12860969e-03]
 [-5.09680960e-03]
 [ 6.45130588e-03]
 [ 1.01016207e-02]
 [-1.83151805e-02]
 [-8.67615150e-03]
 [-7.88585131e-03]
 [-4.72517115e-03]
 [ 1.81193545e-02]
 [-9.98331323e-03]
 [ 6.40713475e-03]
 [-6.22823851e-03]
 [ 1.08905032e-02]
 [-4.14708938e-03]
 [ 8.94989465e-03]
 [-1.86100532e-02]
 [-4.98783085e-03]
 [-3.95958560e-03]
 [-3.73807970e-05]
 [-5.75389271e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.2974142]
curr_Stock_Price:  99.95161086095307
curr_Factors:  [99.95161086]
mat_Sqrt:  [[0.15]]
grads:  [0.01394574]
Stock Position:  0.01394574228440402
Bond Position:  [-0.0964852]


portfolio before change:  [1.30299436]
curr_Stock_Price:  100.35217637763496
curr_Factors:  [100.35217638]
mat_Sqrt:  [[0.15]]
grads:  [0.01825698]
Stock Position:  0.018256979468217527
Bond Position:  [-0.52913327]


portfolio before change:  [1.29637323]
curr_Stock_Price:  99.99132505748072
curr_Factors:  [99.99132506]
mat_Sqrt:  [[0.15]]
grads:  [0.00359613]
Stock Position:  0.0035961266597201585
Bond Position:  [0.93679176]


portfolio before change:  [1.29567731]
curr_Stock_Price:  99.78152327073404
curr_Factors:  [99.78152327]
mat_Sqrt:  [[0.15]]
grads:  [0.05571007]
Stock Position:  0.05571006581679737
Bond Position:  [-4.26315792]


portfolio before change:  [1.31736209]
curr_Stock_Price:  100.175549708961
curr_Factors:  [100.17554971]
mat_Sqrt:  [[0.15]]
grads:  [0.02434621]
Stock Position:  0.024346206158647788
Bond Position:  [-1.12153249]


portfolio before change:  [1.32322938]
curr_Stock_Price:  100.4194228941807
curr_Factors:  [100.41942289]
mat_Sqrt:  [[0.15]]
grads:  [0.17929036]
Stock Position:  0.1792903634525511
Bond Position:  [-16.68100545]


portfolio before change:  [1.43270718]
curr_Stock_Price:  101.03585534404716
curr_Factors:  [101.03585534]
mat_Sqrt:  [[0.15]]
grads:  [0.00854315]
Stock Position:  0.008543153843662945
Bond Position:  [0.56954233]


portfolio before change:  [1.43396852]
curr_Stock_Price:  101.17933206572155
curr_Factors:  [101.17933207]
mat_Sqrt:  [[0.15]]
grads:  [-0.02482028]
Stock Position:  -0.02482028189292852
Bond Position:  [3.94526807]


portfolio before change:  [1.43072267]
curr_Stock_Price:  101.32004113351073
curr_Factors:  [101.32004113]
mat_Sqrt:  [[0.15]]
grads:  [0.15503501]
Stock Position:  0.1550350095577795
Bond Position:  [-14.27743087]


portfolio before change:  [1.37774499]
curr_Stock_Price:  100.98408269398205
curr_Factors:  [100.98408269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248515]
Stock Position:  -0.032485153033855435
Bond Position:  [4.65822837]


portfolio before change:  [1.38038874]
curr_Stock_Price:  100.91166157864313
curr_Factors:  [100.91166158]
mat_Sqrt:  [[0.15]]
grads:  [0.10769528]
Stock Position:  0.10769528128735348
Bond Position:  [-9.48732103]


portfolio before change:  [1.38988692]
curr_Stock_Price:  101.00536253443966
curr_Factors:  [101.00536253]
mat_Sqrt:  [[0.15]]
grads:  [-0.2282128]
Stock Position:  -0.22821279582548537
Bond Position:  [24.4406031]


portfolio before change:  [1.53976128]
curr_Stock_Price:  100.35532545529091
curr_Factors:  [100.35532546]
mat_Sqrt:  [[0.15]]
grads:  [0.02276343]
Stock Position:  0.02276342698065782
Bond Position:  [-0.74466984]


portfolio before change:  [1.53506549]
curr_Stock_Price:  100.15108331237691
curr_Factors:  [100.15108331]
mat_Sqrt:  [[0.15]]
grads:  [0.02502688]
Stock Position:  0.025026881135592073
Bond Position:  [-0.97140377]


portfolio before change:  [1.52659341]
curr_Stock_Price:  99.81499002978161
curr_Factors:  [99.81499003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608146]
Stock Position:  -0.04608146483710046
Bond Position:  [6.12621436]


portfolio before change:  [1.53923552]
curr_Stock_Price:  99.5489566144965
curr_Factors:  [99.54895661]
mat_Sqrt:  [[0.15]]
grads:  [0.06654428]
Stock Position:  0.06654428210582311
Bond Position:  [-5.08517833]


portfolio before change:  [1.48545546]
curr_Stock_Price:  98.74554841005111
curr_Factors:  [98.74554841]
mat_Sqrt:  [[0.15]]
grads:  [0.04881265]
Stock Position:  0.048812654872194126
Bond Position:  [-3.33457691]


portfolio before change:  [1.48031249]
curr_Stock_Price:  98.64445663545051
curr_Factors:  [98.64445664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05898047]
Stock Position:  -0.05898046645282262
Bond Position:  [7.29840855]


portfolio before change:  [1.4820171]
curr_Stock_Price:  98.62328946799113
curr_Factors:  [98.62328947]
mat_Sqrt:  [[0.15]]
grads:  [0.00548107]
Stock Position:  0.005481068926618593
Bond Position:  [0.94145605]


portfolio before change:  [1.48480161]
curr_Stock_Price:  99.12057673767066
curr_Factors:  [99.12057674]
mat_Sqrt:  [[0.15]]
grads:  [0.09560005]
Stock Position:  0.09560005039697957
Bond Position:  [-7.99113052]


portfolio before change:  [1.56655019]
curr_Stock_Price:  99.98091146678202
curr_Factors:  [99.98091147]
mat_Sqrt:  [[0.15]]
grads:  [0.07586824]
Stock Position:  0.0758682353753589
Bond Position:  [-6.01882513]


portfolio before change:  [1.62092095]
curr_Stock_Price:  100.70251717094357
curr_Factors:  [100.70251717]
mat_Sqrt:  [[0.15]]
grads:  [-0.04187464]
Stock Position:  -0.04187463564112955
Bond Position:  [5.83780217]


portfolio before change:  [1.59769343]
curr_Stock_Price:  101.26592272138376
curr_Factors:  [101.26592272]
mat_Sqrt:  [[0.15]]
grads:  [0.05405656]
Stock Position:  0.0540565595641521
Bond Position:  [-3.87639396]


portfolio before change:  [1.6513994]
curr_Stock_Price:  102.26391909901089
curr_Factors:  [102.2639191]
mat_Sqrt:  [[0.15]]
grads:  [-0.04574917]
Stock Position:  -0.045749174275691494
Bond Position:  [6.32988925]


portfolio before change:  [1.62845722]
curr_Stock_Price:  102.77404437063
curr_Factors:  [102.77404437]
mat_Sqrt:  [[0.15]]
grads:  [0.0326423]
Stock Position:  0.032642302241250865
Bond Position:  [-1.7263242]


portfolio before change:  [1.59720868]
curr_Stock_Price:  101.82004801148182
curr_Factors:  [101.82004801]
mat_Sqrt:  [[0.15]]
grads:  [0.07073353]
Stock Position:  0.07073353155178191
Bond Position:  [-5.6048829]


portfolio before change:  [1.57709231]
curr_Stock_Price:  101.54060411322207
curr_Factors:  [101.54060411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03664611]
Stock Position:  -0.03664610908235424
Bond Position:  [5.29816036]


portfolio before change:  [1.63568803]
curr_Stock_Price:  99.95067895466464
curr_Factors:  [99.95067895]
mat_Sqrt:  [[0.15]]
grads:  [0.03799869]
Stock Position:  0.037998693673422144
Bond Position:  [-2.16230721]


portfolio before change:  [1.59272097]
curr_Stock_Price:  98.82348483761567
curr_Factors:  [98.82348484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08744203]
Stock Position:  -0.08744203132141043
Bond Position:  [10.23404723]


portfolio before change:  [1.61017469]
curr_Stock_Price:  98.6311966186676
curr_Factors:  [98.63119662]
mat_Sqrt:  [[0.15]]
grads:  [-0.00413072]
Stock Position:  -0.004130724894414877
Bond Position:  [2.01759303]


portfolio before change:  [1.60892973]
curr_Stock_Price:  98.96311505592219
curr_Factors:  [98.96311506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0412933]
Stock Position:  -0.04129330052303713
Bond Position:  [5.69544338]


portfolio before change:  [1.59421584]
curr_Stock_Price:  99.32806204554763
curr_Factors:  [99.32806205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0689172]
Stock Position:  -0.06891720244800538
Bond Position:  [8.439628]


portfolio before change:  [1.65570471]
curr_Stock_Price:  98.44350243010484
curr_Factors:  [98.44350243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04931433]
Stock Position:  -0.049314330066628984
Bond Position:  [6.51038008]


portfolio before change:  [1.6687355]
curr_Stock_Price:  98.1875143243459
curr_Factors:  [98.18751432]
mat_Sqrt:  [[0.15]]
grads:  [0.03276821]
Stock Position:  0.03276820809060744
Bond Position:  [-1.5486934]


portfolio before change:  [1.65274032]
curr_Stock_Price:  97.70233713230296
curr_Factors:  [97.70233713]
mat_Sqrt:  [[0.15]]
grads:  [0.08907731]
Stock Position:  0.08907730740822863
Bond Position:  [-7.0503208]


portfolio before change:  [1.67240659]
curr_Stock_Price:  97.92806164862152
curr_Factors:  [97.92806165]
mat_Sqrt:  [[0.15]]
grads:  [0.11111469]
Stock Position:  0.11111468782541661
Bond Position:  [-9.2088394]


portfolio before change:  [1.66419433]
curr_Stock_Price:  97.85933363058125
curr_Factors:  [97.85933363]
mat_Sqrt:  [[0.15]]
grads:  [-0.22967472]
Stock Position:  -0.22967471849458684
Bond Position:  [24.14000924]


portfolio before change:  [1.44252217]
curr_Stock_Price:  98.83105991702253
curr_Factors:  [98.83105992]
mat_Sqrt:  [[0.15]]
grads:  [0.06126787]
Stock Position:  0.0612678680192745
Bond Position:  [-4.61264617]


portfolio before change:  [1.44239276]
curr_Stock_Price:  98.83365328276007
curr_Factors:  [98.83365328]
mat_Sqrt:  [[0.15]]
grads:  [-0.10880846]
Stock Position:  -0.10880845974439064
Bond Position:  [12.19633034]


portfolio before change:  [1.33410865]
curr_Stock_Price:  99.83584010470888
curr_Factors:  [99.8358401]
mat_Sqrt:  [[0.15]]
grads:  [0.16584598]
Stock Position:  0.1658459778507588
Bond Position:  [-15.22326388]


portfolio before change:  [1.36404652]
curr_Stock_Price:  100.02209336491828
curr_Factors:  [100.02209336]
mat_Sqrt:  [[0.15]]
grads:  [-0.04393529]
Stock Position:  -0.043935285996665144
Bond Position:  [5.7585458]


portfolio before change:  [1.36777936]
curr_Stock_Price:  99.94532319535327
curr_Factors:  [99.9453232]
mat_Sqrt:  [[0.15]]
grads:  [-0.06712359]
Stock Position:  -0.06712358849679716
Bond Position:  [8.07646811]


portfolio before change:  [1.33857704]
curr_Stock_Price:  100.38789651393525
curr_Factors:  [100.38789651]
mat_Sqrt:  [[0.15]]
grads:  [0.15574729]
Stock Position:  0.15574728999442147
Bond Position:  [-14.29656579]


portfolio before change:  [1.18232581]
curr_Stock_Price:  99.39039811005465
curr_Factors:  [99.39039811]
mat_Sqrt:  [[0.15]]
grads:  [0.02775236]
Stock Position:  0.02775235731653468
Bond Position:  [-1.57599203]


portfolio before change:  [1.17344399]
curr_Stock_Price:  99.07390916630295
curr_Factors:  [99.07390917]
mat_Sqrt:  [[0.15]]
grads:  [-0.05148125]
Stock Position:  -0.05148124962882663
Bond Position:  [6.27389264]


portfolio before change:  [1.21632886]
curr_Stock_Price:  98.24850699712408
curr_Factors:  [98.248507]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303156]
Stock Position:  -0.023031564092805386
Bond Position:  [3.47914564]


portfolio before change:  [1.21238529]
curr_Stock_Price:  98.4291731722886
curr_Factors:  [98.42917317]
mat_Sqrt:  [[0.15]]
grads:  [0.00534539]
Stock Position:  0.00534538663918456
Bond Position:  [0.6862433]


portfolio before change:  [1.2155082]
curr_Stock_Price:  99.00537536229898
curr_Factors:  [99.00537536]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299876]
Stock Position:  -0.08299876083592879
Bond Position:  [9.43283167]


portfolio before change:  [1.23538547]
curr_Stock_Price:  98.77298997805822
curr_Factors:  [98.77298998]
mat_Sqrt:  [[0.15]]
grads:  [-0.0650422]
Stock Position:  -0.06504219792078321
Bond Position:  [7.65979783]


portfolio before change:  [1.26019467]
curr_Stock_Price:  98.39891818644425
curr_Factors:  [98.39891819]
mat_Sqrt:  [[0.15]]
grads:  [-0.02588425]
Stock Position:  -0.025884249433008245
Bond Position:  [3.80717682]


portfolio before change:  [1.25157138]
curr_Stock_Price:  98.74125967066229
curr_Factors:  [98.74125967]
mat_Sqrt:  [[0.15]]
grads:  [0.31505555]
Stock Position:  0.3150555474908813
Bond Position:  [-29.85741025]


portfolio before change:  [1.12226046]
curr_Stock_Price:  98.33674442106417
curr_Factors:  [98.33674442]
mat_Sqrt:  [[0.15]]
grads:  [-0.06988916]
Stock Position:  -0.06988916005821055
Bond Position:  [7.99493293]


portfolio before change:  [1.10968724]
curr_Stock_Price:  98.52379653475967
curr_Factors:  [98.52379653]
mat_Sqrt:  [[0.15]]
grads:  [0.02317717]
Stock Position:  0.023177169467290742
Bond Position:  [-1.17381549]


portfolio before change:  [1.08329784]
curr_Stock_Price:  97.38836710254806
curr_Factors:  [97.3883671]
mat_Sqrt:  [[0.15]]
grads:  [0.03388936]
Stock Position:  0.033889364628635836
Bond Position:  [-2.21713205]


portfolio before change:  [1.0628902]
curr_Stock_Price:  96.79027198192556
curr_Factors:  [96.79027198]
mat_Sqrt:  [[0.15]]
grads:  [0.02852537]
Stock Position:  0.028525372069045964
Bond Position:  [-1.69808832]


portfolio before change:  [1.05417464]
curr_Stock_Price:  96.48845578117665
curr_Factors:  [96.48845578]
mat_Sqrt:  [[0.15]]
grads:  [0.00994179]
Stock Position:  0.00994179487887868
Bond Position:  [0.09490621]


portfolio before change:  [1.0608607]
curr_Stock_Price:  97.1603795328313
curr_Factors:  [97.16037953]
mat_Sqrt:  [[0.15]]
grads:  [0.01057435]
Stock Position:  0.010574353400221165
Bond Position:  [0.03345251]


portfolio before change:  [1.06714463]
curr_Stock_Price:  97.75444320885215
curr_Factors:  [97.75444321]
mat_Sqrt:  [[0.15]]
grads:  [-0.00451207]
Stock Position:  -0.004512066437572151
Bond Position:  [1.50821918]


portfolio before change:  [1.06139767]
curr_Stock_Price:  99.04902356477407
curr_Factors:  [99.04902356]
mat_Sqrt:  [[0.15]]
grads:  [0.01031087]
Stock Position:  0.010310866051104003
Bond Position:  [0.04011645]


portfolio before change:  [1.0533572]
curr_Stock_Price:  98.26897502626582
curr_Factors:  [98.26897503]
mat_Sqrt:  [[0.15]]
grads:  [0.01419073]
Stock Position:  0.014190731266288625
Bond Position:  [-0.34115142]


portfolio before change:  [1.03362195]
curr_Stock_Price:  96.8797633601889
curr_Factors:  [96.87976336]
mat_Sqrt:  [[0.15]]
grads:  [-0.03397873]
Stock Position:  -0.03397873066697409
Bond Position:  [4.32547333]


portfolio before change:  [1.0247779]
curr_Stock_Price:  97.14800167330789
curr_Factors:  [97.14800167]
mat_Sqrt:  [[0.15]]
grads:  [0.04300871]
Stock Position:  0.04300870587322962
Bond Position:  [-3.15343193]


portfolio before change:  [1.05079887]
curr_Stock_Price:  97.75760059164406
curr_Factors:  [97.75760059]
mat_Sqrt:  [[0.15]]
grads:  [0.06734414]
Stock Position:  0.06734413826274498
Bond Position:  [-5.53260251]


portfolio before change:  [1.04064901]
curr_Stock_Price:  97.61201911488122
curr_Factors:  [97.61201911]
mat_Sqrt:  [[0.15]]
grads:  [-0.1221012]
Stock Position:  -0.12210120311462318
Bond Position:  [12.95919398]


portfolio before change:  [1.06139032]
curr_Stock_Price:  97.44878294401539
curr_Factors:  [97.44878294]
mat_Sqrt:  [[0.15]]
grads:  [-0.05784101]
Stock Position:  -0.057841009988289366
Bond Position:  [6.69792634]


portfolio before change:  [1.05840406]
curr_Stock_Price:  97.5076492155999
curr_Factors:  [97.50764922]
mat_Sqrt:  [[0.15]]
grads:  [-0.05257234]
Stock Position:  -0.05257234207535293
Bond Position:  [6.18460955]


portfolio before change:  [1.0627666]
curr_Stock_Price:  97.43202039468774
curr_Factors:  [97.43202039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150114]
Stock Position:  -0.03150114100704669
Bond Position:  [4.13198641]


portfolio before change:  [1.0536534]
curr_Stock_Price:  97.72951612227428
curr_Factors:  [97.72951612]
mat_Sqrt:  [[0.15]]
grads:  [0.1207957]
Stock Position:  0.1207956964950307
Bond Position:  [-10.75165157]


portfolio before change:  [1.09040374]
curr_Stock_Price:  98.03931470111105
curr_Factors:  [98.0393147]
mat_Sqrt:  [[0.15]]
grads:  [-0.06655542]
Stock Position:  -0.06655542154901008
Bond Position:  [7.61545166]


portfolio before change:  [1.07246043]
curr_Stock_Price:  98.31606580198459
curr_Factors:  [98.3160658]
mat_Sqrt:  [[0.15]]
grads:  [0.04271423]
Stock Position:  0.042714231636654304
Bond Position:  [-3.12703478]


portfolio before change:  [1.07964049]
curr_Stock_Price:  98.48873658006673
curr_Factors:  [98.48873658]
mat_Sqrt:  [[0.15]]
grads:  [-0.04152159]
Stock Position:  -0.04152159006636521
Bond Position:  [5.16904943]


portfolio before change:  [1.069864]
curr_Stock_Price:  98.73197287757672
curr_Factors:  [98.73197288]
mat_Sqrt:  [[0.15]]
grads:  [0.07260335]
Stock Position:  0.07260335477313115
Bond Position:  [-6.09840845]


portfolio before change:  [1.07155422]
curr_Stock_Price:  98.76050293070662
curr_Factors:  [98.76050293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764726]
Stock Position:  -0.027647262565901495
Bond Position:  [3.80201177]


portfolio before change:  [1.065689]
curr_Stock_Price:  98.98124263200934
curr_Factors:  [98.98124263]
mat_Sqrt:  [[0.15]]
grads:  [0.05966596]
Stock Position:  0.059665964341242564
Bond Position:  [-4.84012229]


portfolio before change:  [1.06685031]
curr_Stock_Price:  99.00577622471816
curr_Factors:  [99.00577622]
mat_Sqrt:  [[0.15]]
grads:  [-0.12406702]
Stock Position:  -0.12406702100974026
Bond Position:  [13.35020203]


portfolio before change:  [1.06129825]
curr_Stock_Price:  99.05725216472209
curr_Factors:  [99.05725216]
mat_Sqrt:  [[0.15]]
grads:  [-0.03325221]
Stock Position:  -0.033252205633985545
Bond Position:  [4.35517037]


portfolio before change:  [1.05061005]
curr_Stock_Price:  99.38686681310199
curr_Factors:  [99.38686681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02639724]
Stock Position:  -0.02639723730769772
Bond Position:  [3.67414875]


portfolio before change:  [1.06483649]
curr_Stock_Price:  98.85662932185043
curr_Factors:  [98.85662932]
mat_Sqrt:  [[0.15]]
grads:  [-0.00024921]
Stock Position:  -0.00024920531363120045
Bond Position:  [1.08947209]


portfolio before change:  [1.06489685]
curr_Stock_Price:  98.88767902416708
curr_Factors:  [98.88767902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.06489685]
Stock Price:  99.04263397677587
PL:  [1.06489685]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-4.03410131e-06]
 [ 2.86827420e-03]
 [ 2.07410047e-04]
 [ 7.16496241e-03]
 [ 1.55688941e-02]
 [ 2.74648096e-02]
 [ 1.23030363e-03]
 [-1.13616574e-02]
 [ 2.40408686e-02]
 [-4.70309954e-03]
 [ 2.38072640e-02]
 [-4.04075008e-02]
 [ 3.23885281e-02]
 [ 7.97348805e-03]
 [-6.91253653e-03]
 [ 1.16831740e-02]
 [ 7.34475117e-03]
 [-1.23305292e-02]
 [-2.24598100e-04]
 [ 1.32921110e-02]
 [ 1.14542710e-02]
 [-7.86345610e-03]
 [ 6.79944824e-03]
 [ 3.85328340e-02]
 [-2.87589472e-03]
 [ 9.81848646e-03]
 [-7.01984552e-03]
 [ 6.23208910e-03]
 [-9.72922176e-03]
 [-1.56785269e-03]
 [-6.68102086e-03]
 [-1.11265795e-02]
 [ 2.02403197e-03]
 [ 5.76701766e-03]
 [ 1.14747348e-02]
 [ 1.23106386e-02]
 [-3.52635008e-02]
 [ 9.49339727e-03]
 [-1.24850447e-02]
 [ 2.45870909e-02]
 [-6.54911274e-03]
 [-1.32843509e-02]
 [ 2.36105508e-02]
 [ 4.06126704e-03]
 [-7.91298294e-03]
 [-6.66478979e-03]
 [ 2.59317153e-05]
 [-1.22522991e-02]
 [-7.89661479e-03]
 [-3.71853039e-03]
 [ 4.62815426e-02]
 [-9.36707822e-03]
 [ 2.66028332e-03]
 [ 5.42841116e-03]
 [ 5.79531348e-03]
 [-3.24111455e-03]
 [ 6.68176902e-03]
 [-2.18601387e-04]
 [ 1.54166761e-03]
 [ 1.00436466e-03]
 [ 1.28976137e-03]
 [-1.85911272e-03]
 [ 2.73256473e-03]
 [-1.72447510e-02]
 [-1.36054644e-02]
 [ 1.75195966e-03]
 [-5.19447069e-03]
 [ 2.20055499e-02]
 [-8.15482102e-03]
 [ 6.94944793e-03]
 [-7.81602264e-03]
 [ 1.06925855e-02]
 [-5.36524857e-03]
 [ 9.75207825e-03]
 [-1.59798779e-02]
 [-8.46557908e-03]
 [ 1.20935216e-04]
 [ 2.55720651e-03]
 [-8.18836784e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.6101755]
curr_Stock_Price:  101.40249724666062
curr_Factors:  [101.40249725]
mat_Sqrt:  [[0.15]]
grads:  [-2.68940088e-05]
Stock Position:  -2.689400875089653e-05
Bond Position:  [23.61290262]


portfolio before change:  [23.61168105]
curr_Stock_Price:  100.29816870020663
curr_Factors:  [100.2981687]
mat_Sqrt:  [[0.15]]
grads:  [0.01912183]
Stock Position:  0.01912182802190948
Bond Position:  [21.69379672]


portfolio before change:  [23.60413859]
curr_Stock_Price:  99.832817894806
curr_Factors:  [99.83281789]
mat_Sqrt:  [[0.15]]
grads:  [0.00138273]
Stock Position:  0.001382733649415892
Bond Position:  [23.4660964]


portfolio before change:  [23.6061809]
curr_Stock_Price:  100.2491172222538
curr_Factors:  [100.24911722]
mat_Sqrt:  [[0.15]]
grads:  [0.04776642]
Stock Position:  0.0477664160523527
Bond Position:  [18.81763986]


portfolio before change:  [23.65381934]
curr_Stock_Price:  101.22181532389958
curr_Factors:  [101.22181532]
mat_Sqrt:  [[0.15]]
grads:  [0.10379263]
Stock Position:  0.10379262729845778
Bond Position:  [13.14774119]


portfolio before change:  [23.65786949]
curr_Stock_Price:  101.25291948976437
curr_Factors:  [101.25291949]
mat_Sqrt:  [[0.15]]
grads:  [0.18309873]
Stock Position:  0.18309873040496247
Bond Position:  [5.11858848]


portfolio before change:  [23.61337336]
curr_Stock_Price:  101.00815507965191
curr_Factors:  [101.00815508]
mat_Sqrt:  [[0.15]]
grads:  [0.00820202]
Stock Position:  0.008202024218135652
Bond Position:  [22.78490202]


portfolio before change:  [23.61236444]
curr_Stock_Price:  100.71151950819633
curr_Factors:  [100.71151951]
mat_Sqrt:  [[0.15]]
grads:  [-0.07574438]
Stock Position:  -0.07574438242887312
Bond Position:  [31.24069629]


portfolio before change:  [23.5957977]
curr_Stock_Price:  100.95601748492089
curr_Factors:  [100.95601748]
mat_Sqrt:  [[0.15]]
grads:  [0.16027246]
Stock Position:  0.16027245709561327
Bond Position:  [7.41532872]


portfolio before change:  [23.63379594]
curr_Stock_Price:  101.19021094962388
curr_Factors:  [101.19021095]
mat_Sqrt:  [[0.15]]
grads:  [-0.031354]
Stock Position:  -0.03135399692811996
Bond Position:  [26.8065135]


portfolio before change:  [23.62881854]
curr_Stock_Price:  101.40239609910286
curr_Factors:  [101.4023961]
mat_Sqrt:  [[0.15]]
grads:  [0.15871509]
Stock Position:  0.1587150932132239
Bond Position:  [7.53472779]


portfolio before change:  [23.58639929]
curr_Stock_Price:  101.13216224609872
curr_Factors:  [101.13216225]
mat_Sqrt:  [[0.15]]
grads:  [-0.26938334]
Stock Position:  -0.26938333883742943
Bond Position:  [50.82971882]


portfolio before change:  [23.57374351]
curr_Stock_Price:  101.19093624110067
curr_Factors:  [101.19093624]
mat_Sqrt:  [[0.15]]
grads:  [0.21592352]
Stock Position:  0.2159235207910065
Bond Position:  [1.72424028]


portfolio before change:  [23.2923113]
curr_Stock_Price:  99.88704874669571
curr_Factors:  [99.88704875]
mat_Sqrt:  [[0.15]]
grads:  [0.05315659]
Stock Position:  0.053156586984784496
Bond Position:  [17.9826567]


portfolio before change:  [23.29207887]
curr_Stock_Price:  99.8615320715064
curr_Factors:  [99.86153207]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608358]
Stock Position:  -0.04608357687555745
Bond Position:  [27.89405546]


portfolio before change:  [23.29215934]
curr_Stock_Price:  99.8976178917688
curr_Factors:  [99.89761789]
mat_Sqrt:  [[0.15]]
grads:  [0.07788783]
Stock Position:  0.0778878263903162
Bond Position:  [15.51135102]


portfolio before change:  [23.27318361]
curr_Stock_Price:  99.6415417044774
curr_Factors:  [99.6415417]
mat_Sqrt:  [[0.15]]
grads:  [0.04896501]
Stock Position:  0.048965007817005836
Bond Position:  [18.39423474]


portfolio before change:  [23.28815784]
curr_Stock_Price:  99.92387699218472
curr_Factors:  [99.92387699]
mat_Sqrt:  [[0.15]]
grads:  [-0.08220353]
Stock Position:  -0.0822035280596873
Bond Position:  [31.50225306]


portfolio before change:  [23.25906001]
curr_Stock_Price:  100.30180211551874
curr_Factors:  [100.30180212]
mat_Sqrt:  [[0.15]]
grads:  [-0.00149732]
Stock Position:  -0.0014973206681456568
Bond Position:  [23.40924397]


portfolio before change:  [23.26107349]
curr_Stock_Price:  99.93424434620803
curr_Factors:  [99.93424435]
mat_Sqrt:  [[0.15]]
grads:  [0.08861407]
Stock Position:  0.08861407313922871
Bond Position:  [14.40549305]


portfolio before change:  [23.22997983]
curr_Stock_Price:  99.57319528648567
curr_Factors:  [99.57319529]
mat_Sqrt:  [[0.15]]
grads:  [0.07636181]
Stock Position:  0.07636180666144388
Bond Position:  [15.62639074]


portfolio before change:  [23.214976]
curr_Stock_Price:  99.36392166675212
curr_Factors:  [99.36392167]
mat_Sqrt:  [[0.15]]
grads:  [-0.05242304]
Stock Position:  -0.05242304065134704
Bond Position:  [28.4239349]


portfolio before change:  [23.18609702]
curr_Stock_Price:  99.94869379173929
curr_Factors:  [99.94869379]
mat_Sqrt:  [[0.15]]
grads:  [0.04532965]
Stock Position:  0.04532965494495741
Bond Position:  [18.65545721]


portfolio before change:  [23.17437227]
curr_Stock_Price:  99.66431591174253
curr_Factors:  [99.66431591]
mat_Sqrt:  [[0.15]]
grads:  [0.25688556]
Stock Position:  0.2568855600721784
Bond Position:  [-2.42795135]


portfolio before change:  [23.26325138]
curr_Stock_Price:  100.01089384514198
curr_Factors:  [100.01089385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01917263]
Stock Position:  -0.01917263146208589
Bond Position:  [25.18072339]


portfolio before change:  [23.26798715]
curr_Stock_Price:  99.84597538025703
curr_Factors:  [99.84597538]
mat_Sqrt:  [[0.15]]
grads:  [0.06545658]
Stock Position:  0.06545657637190143
Bond Position:  [16.73241143]


portfolio before change:  [23.24906832]
curr_Stock_Price:  99.54096957369956
curr_Factors:  [99.54096957]
mat_Sqrt:  [[0.15]]
grads:  [-0.04679897]
Stock Position:  -0.046798970125803925
Bond Position:  [27.90748318]


portfolio before change:  [23.2741687]
curr_Stock_Price:  99.04189642528124
curr_Factors:  [99.04189643]
mat_Sqrt:  [[0.15]]
grads:  [0.04154726]
Stock Position:  0.04154726067074644
Bond Position:  [19.15924921]


portfolio before change:  [23.28801736]
curr_Stock_Price:  99.34639717928171
curr_Factors:  [99.34639718]
mat_Sqrt:  [[0.15]]
grads:  [-0.06486148]
Stock Position:  -0.06486147839796039
Bond Position:  [29.73177156]


portfolio before change:  [23.29271795]
curr_Stock_Price:  99.30257625833369
curr_Factors:  [99.30257626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01045235]
Stock Position:  -0.010452351268143707
Bond Position:  [24.33066336]


portfolio before change:  [23.29659]
curr_Stock_Price:  99.07761880695327
curr_Factors:  [99.07761881]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454014]
Stock Position:  -0.04454013908584512
Bond Position:  [27.70952092]


portfolio before change:  [23.26411809]
curr_Stock_Price:  99.84555101050034
curr_Factors:  [99.84555101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0741772]
Stock Position:  -0.07417719684211757
Bond Position:  [30.67038118]


portfolio before change:  [23.25448656]
curr_Stock_Price:  100.00123884279738
curr_Factors:  [100.00123884]
mat_Sqrt:  [[0.15]]
grads:  [0.01349355]
Stock Position:  0.013493546490526826
Bond Position:  [21.90511519]


portfolio before change:  [23.25872115]
curr_Stock_Price:  100.21359785065764
curr_Factors:  [100.21359785]
mat_Sqrt:  [[0.15]]
grads:  [0.03844678]
Stock Position:  0.03844678442418504
Bond Position:  [19.40583056]


portfolio before change:  [23.26852465]
curr_Stock_Price:  100.43703906078703
curr_Factors:  [100.43703906]
mat_Sqrt:  [[0.15]]
grads:  [0.07649823]
Stock Position:  0.07649823189708285
Bond Position:  [15.58526874]


portfolio before change:  [23.23577282]
curr_Stock_Price:  99.99616695063767
curr_Factors:  [99.99616695]
mat_Sqrt:  [[0.15]]
grads:  [0.08207092]
Stock Position:  0.08207092366980288
Bond Position:  [15.02899503]


portfolio before change:  [23.19602604]
curr_Stock_Price:  99.50042354682225
curr_Factors:  [99.50042355]
mat_Sqrt:  [[0.15]]
grads:  [-0.23509001]
Stock Position:  -0.23509000563799987
Bond Position:  [46.58758117]


portfolio before change:  [23.20210752]
curr_Stock_Price:  99.48694077571442
curr_Factors:  [99.48694078]
mat_Sqrt:  [[0.15]]
grads:  [0.06328932]
Stock Position:  0.06328931516289808
Bond Position:  [16.90564717]


portfolio before change:  [23.21505493]
curr_Stock_Price:  99.67482041859978
curr_Factors:  [99.67482042]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323363]
Stock Position:  -0.08323363150932807
Bond Position:  [31.5113522]


portfolio before change:  [23.19027177]
curr_Stock_Price:  99.9962371589007
curr_Factors:  [99.99623716]
mat_Sqrt:  [[0.15]]
grads:  [0.16391394]
Stock Position:  0.1639139395578142
Bond Position:  [6.7994946]


portfolio before change:  [23.18308846]
curr_Stock_Price:  99.94982075731473
curr_Factors:  [99.94982076]
mat_Sqrt:  [[0.15]]
grads:  [-0.04366075]
Stock Position:  -0.04366075159604193
Bond Position:  [27.54697275]


portfolio before change:  [23.16999069]
curr_Stock_Price:  100.28924464975442
curr_Factors:  [100.28924465]
mat_Sqrt:  [[0.15]]
grads:  [-0.08856234]
Stock Position:  -0.08856233941317615
Bond Position:  [32.05184082]


portfolio before change:  [23.19111555]
curr_Stock_Price:  100.07333399652009
curr_Factors:  [100.073334]
mat_Sqrt:  [[0.15]]
grads:  [0.15740367]
Stock Position:  0.15740367183293064
Bond Position:  [7.43920533]


portfolio before change:  [23.11576137]
curr_Stock_Price:  99.59164800178594
curr_Factors:  [99.591648]
mat_Sqrt:  [[0.15]]
grads:  [0.02707511]
Stock Position:  0.027075113585741026
Bond Position:  [20.41930619]


portfolio before change:  [23.10519209]
curr_Stock_Price:  99.1541418870762
curr_Factors:  [99.15414189]
mat_Sqrt:  [[0.15]]
grads:  [-0.05275322]
Stock Position:  -0.05275321962507115
Bond Position:  [28.33589231]


portfolio before change:  [23.11913985]
curr_Stock_Price:  98.9233178454571
curr_Factors:  [98.92331785]
mat_Sqrt:  [[0.15]]
grads:  [-0.04443193]
Stock Position:  -0.04443193190245622
Bond Position:  [27.51449397]


portfolio before change:  [23.11033851]
curr_Stock_Price:  99.1601080716778
curr_Factors:  [99.16010807]
mat_Sqrt:  [[0.15]]
grads:  [0.00017288]
Stock Position:  0.00017287810209264354
Bond Position:  [23.0931959]


portfolio before change:  [23.11160406]
curr_Stock_Price:  98.13151450496751
curr_Factors:  [98.1315145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08168199]
Stock Position:  -0.08168199367872735
Bond Position:  [31.12718181]


portfolio before change:  [23.10974414]
curr_Stock_Price:  98.17810279057554
curr_Factors:  [98.17810279]
mat_Sqrt:  [[0.15]]
grads:  [-0.0526441]
Stock Position:  -0.052644098607652914
Bond Position:  [28.27824187]


portfolio before change:  [23.10267723]
curr_Stock_Price:  98.34591563600384
curr_Factors:  [98.34591564]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247902]
Stock Position:  -0.02479020260768639
Bond Position:  [25.54069241]


portfolio before change:  [23.10589778]
curr_Stock_Price:  98.28039783764874
curr_Factors:  [98.28039784]
mat_Sqrt:  [[0.15]]
grads:  [0.30854362]
Stock Position:  0.3085436173012761
Bond Position:  [-7.21789168]


portfolio before change:  [23.40447015]
curr_Stock_Price:  99.2495428481798
curr_Factors:  [99.24954285]
mat_Sqrt:  [[0.15]]
grads:  [-0.06244719]
Stock Position:  -0.062447188108126946
Bond Position:  [29.60232502]


portfolio before change:  [23.36654628]
curr_Stock_Price:  99.88646628375993
curr_Factors:  [99.88646628]
mat_Sqrt:  [[0.15]]
grads:  [0.01773522]
Stock Position:  0.017735222156940803
Bond Position:  [21.59503761]


portfolio before change:  [23.36463929]
curr_Stock_Price:  99.70283646782991
curr_Factors:  [99.70283647]
mat_Sqrt:  [[0.15]]
grads:  [0.03618941]
Stock Position:  0.03618940774007262
Bond Position:  [19.75645269]


portfolio before change:  [23.36260407]
curr_Stock_Price:  99.61247748536434
curr_Factors:  [99.61247749]
mat_Sqrt:  [[0.15]]
grads:  [0.03863542]
Stock Position:  0.03863542319846943
Bond Position:  [19.51403385]


portfolio before change:  [23.36458603]
curr_Stock_Price:  99.63220783981872
curr_Factors:  [99.63220784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02160743]
Stock Position:  -0.021607430359534645
Bond Position:  [25.51738202]


portfolio before change:  [23.37026236]
curr_Stock_Price:  99.44331679615924
curr_Factors:  [99.4433168]
mat_Sqrt:  [[0.15]]
grads:  [0.04454513]
Stock Position:  0.04454512681651891
Bond Position:  [18.94054721]


portfolio before change:  [23.34780812]
curr_Stock_Price:  98.91266245759473
curr_Factors:  [98.91266246]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145734]
Stock Position:  -0.001457342581540618
Bond Position:  [23.49195776]


portfolio before change:  [23.3495836]
curr_Stock_Price:  98.70187790224584
curr_Factors:  [98.7018779]
mat_Sqrt:  [[0.15]]
grads:  [0.01027778]
Stock Position:  0.010277784093113095
Bond Position:  [22.33514701]


portfolio before change:  [23.35337411]
curr_Stock_Price:  98.93485808805978
curr_Factors:  [98.93485809]
mat_Sqrt:  [[0.15]]
grads:  [0.00669576]
Stock Position:  0.006695764384246674
Bond Position:  [22.69092961]


portfolio before change:  [23.35368607]
curr_Stock_Price:  98.76963956657379
curr_Factors:  [98.76963957]
mat_Sqrt:  [[0.15]]
grads:  [0.00859841]
Stock Position:  0.008598409129057655
Bond Position:  [22.5044243]


portfolio before change:  [23.35409074]
curr_Stock_Price:  98.65311742074718
curr_Factors:  [98.65311742]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239408]
Stock Position:  -0.01239408479485273
Bond Position:  [24.57680584]


portfolio before change:  [23.3545401]
curr_Stock_Price:  98.74079939373799
curr_Factors:  [98.74079939]
mat_Sqrt:  [[0.15]]
grads:  [0.0182171]
Stock Position:  0.018217098178360033
Bond Position:  [21.55576926]


portfolio before change:  [23.3591202]
curr_Stock_Price:  98.91826053132054
curr_Factors:  [98.91826053]
mat_Sqrt:  [[0.15]]
grads:  [-0.11496501]
Stock Position:  -0.11496500633788945
Bond Position:  [34.73125865]


portfolio before change:  [23.34097091]
curr_Stock_Price:  99.09501052927372
curr_Factors:  [99.09501053]
mat_Sqrt:  [[0.15]]
grads:  [-0.0907031]
Stock Position:  -0.09070309623312496
Bond Position:  [32.32919519]


portfolio before change:  [23.22989498]
curr_Stock_Price:  100.34189812850073
curr_Factors:  [100.34189813]
mat_Sqrt:  [[0.15]]
grads:  [0.01167973]
Stock Position:  0.011679731072771645
Bond Position:  [22.0579286]


portfolio before change:  [23.22403788]
curr_Stock_Price:  99.72238307252088
curr_Factors:  [99.72238307]
mat_Sqrt:  [[0.15]]
grads:  [-0.0346298]
Stock Position:  -0.03462980463200957
Bond Position:  [26.67740452]


portfolio before change:  [23.19410959]
curr_Stock_Price:  100.63476690622194
curr_Factors:  [100.63476691]
mat_Sqrt:  [[0.15]]
grads:  [0.14670367]
Stock Position:  0.14670366594011358
Bond Position:  [8.43062037]


portfolio before change:  [23.19900463]
curr_Stock_Price:  100.66454194680585
curr_Factors:  [100.66454195]
mat_Sqrt:  [[0.15]]
grads:  [-0.05436547]
Stock Position:  -0.05436547343349734
Bond Position:  [28.67168011]


portfolio before change:  [23.23659094]
curr_Stock_Price:  100.0061411941444
curr_Factors:  [100.00614119]
mat_Sqrt:  [[0.15]]
grads:  [0.04632965]
Stock Position:  0.046329652851561064
Bond Position:  [18.60334113]


portfolio before change:  [23.19500497]
curr_Stock_Price:  99.08343392119318
curr_Factors:  [99.08343392]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210682]
Stock Position:  -0.052106817624238945
Bond Position:  [28.35792739]


portfolio before change:  [23.17888789]
curr_Stock_Price:  99.42675765358193
curr_Factors:  [99.42675765]
mat_Sqrt:  [[0.15]]
grads:  [0.0712839]
Stock Position:  0.07128390330437841
Bond Position:  [16.09136051]


portfolio before change:  [23.16197284]
curr_Stock_Price:  99.17535742007249
curr_Factors:  [99.17535742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03576832]
Stock Position:  -0.03576832381156563
Bond Position:  [26.70930914]


portfolio before change:  [23.15668861]
curr_Stock_Price:  99.36976446702884
curr_Factors:  [99.36976447]
mat_Sqrt:  [[0.15]]
grads:  [0.06501386]
Stock Position:  0.065013855024285
Bond Position:  [16.69627715]


portfolio before change:  [23.09206072]
curr_Stock_Price:  98.3596498840517
curr_Factors:  [98.35964988]
mat_Sqrt:  [[0.15]]
grads:  [-0.10653252]
Stock Position:  -0.10653251920162254
Bond Position:  [33.57056201]


portfolio before change:  [23.14196234]
curr_Stock_Price:  97.91092871489626
curr_Factors:  [97.91092871]
mat_Sqrt:  [[0.15]]
grads:  [-0.05643719]
Stock Position:  -0.05643719383402607
Bond Position:  [28.6677804]


portfolio before change:  [23.11897807]
curr_Stock_Price:  98.34993115736958
curr_Factors:  [98.34993116]
mat_Sqrt:  [[0.15]]
grads:  [0.00080623]
Stock Position:  0.0008062347732970543
Bond Position:  [23.03968493]


portfolio before change:  [23.12005681]
curr_Stock_Price:  97.90181631121054
curr_Factors:  [97.90181631]
mat_Sqrt:  [[0.15]]
grads:  [0.01704804]
Stock Position:  0.0170480434273528
Bond Position:  [21.45102239]


portfolio before change:  [23.11379769]
curr_Stock_Price:  97.45602649469218
curr_Factors:  [97.45602649]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.11379769]
Stock Price:  97.7489606836821
PL:  [23.11379769]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.19951275e-03]
 [-8.27311901e-03]
 [-2.92243580e-03]
 [ 5.48780148e-03]
 [ 8.94912184e-04]
 [ 2.21383814e-02]
 [ 1.29960906e-03]
 [-1.86669191e-02]
 [-1.13720218e-02]
 [ 3.04662744e-02]
 [-2.72790711e-03]
 [ 2.40206223e-02]
 [-1.42823710e-02]
 [ 4.62279919e-03]
 [-6.98863771e-03]
 [ 9.67811393e-03]
 [ 1.15733792e-02]
 [ 1.72778559e-02]
 [ 8.18613420e-04]
 [ 1.00218157e-02]
 [ 1.32188202e-02]
 [-1.29279947e-02]
 [-6.00401040e-03]
 [-1.70006866e-01]
 [-1.40986767e-02]
 [ 3.09024317e-03]
 [ 5.95550518e-03]
 [ 1.84733945e-02]
 [-1.07308620e-01]
 [ 9.97006479e-03]
 [ 2.67015875e-02]
 [-1.74519329e-02]
 [-5.31508952e-03]
 [ 9.54896522e-03]
 [ 1.43789756e-02]
 [-1.51913301e-02]
 [-2.37270065e-02]
 [ 6.82174268e-03]
 [-5.62341145e-02]
 [-2.09415515e-02]
 [-1.69820441e-02]
 [ 8.22034251e-02]
 [ 2.37152441e-02]
 [ 1.88256795e-03]
 [ 1.59326668e-02]
 [ 4.36490345e-02]
 [-7.38926570e-03]
 [ 1.08670751e-02]
 [ 5.24970088e-02]
 [ 1.16332087e-02]
 [ 2.30896038e-02]
 [ 2.12735062e-02]
 [-2.19824243e-03]
 [ 4.05107144e-03]
 [ 5.05144760e-03]
 [ 8.26512973e-03]
 [-3.64833300e-02]
 [ 1.77498971e-03]
 [ 1.65710297e-03]
 [-1.38723175e-01]
 [-1.80576170e-02]
 [ 1.69821749e-02]
 [ 1.91190449e-02]
 [-2.02554764e-02]
 [-5.33206927e-03]
 [-1.74991707e-02]
 [-3.51801912e-03]
 [-1.43285704e-02]
 [-2.28863686e-02]
 [ 1.83825306e-02]
 [ 1.81954905e-02]
 [ 1.36320228e-02]
 [ 1.33376198e-03]
 [ 8.43861621e-03]
 [ 2.72351771e-02]
 [-2.63120741e-02]
 [ 4.58989962e-03]
 [ 1.06907811e-02]
 [ 8.84678098e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.21334867]
curr_Stock_Price:  99.72332364912376
curr_Factors:  [99.72332365]
mat_Sqrt:  [[0.15]]
grads:  [0.02133009]
Stock Position:  0.021330085003422865
Bond Position:  [-4.34045564]


portfolio before change:  [-2.22300186]
curr_Stock_Price:  99.28348013442218
curr_Factors:  [99.28348013]
mat_Sqrt:  [[0.15]]
grads:  [-0.05515413]
Stock Position:  -0.05515412672720364
Bond Position:  [3.25289179]


portfolio before change:  [-2.20909109]
curr_Stock_Price:  99.03495014695103
curr_Factors:  [99.03495015]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948291]
Stock Position:  -0.01948290530784121
Bond Position:  [-0.27960254]


portfolio before change:  [-2.19545263]
curr_Stock_Price:  98.33403105741817
curr_Factors:  [98.33403106]
mat_Sqrt:  [[0.15]]
grads:  [0.03658534]
Stock Position:  0.036585343190331805
Bond Position:  [-5.7930369]


portfolio before change:  [-2.16937569]
curr_Stock_Price:  99.05669784666513
curr_Factors:  [99.05669785]
mat_Sqrt:  [[0.15]]
grads:  [0.00596608]
Stock Position:  0.005966081227392688
Bond Position:  [-2.760356]


portfolio before change:  [-2.16588892]
curr_Stock_Price:  99.67004825893578
curr_Factors:  [99.67004826]
mat_Sqrt:  [[0.15]]
grads:  [0.14758921]
Stock Position:  0.14758920922956545
Bond Position:  [-16.87611253]


portfolio before change:  [-2.24708769]
curr_Stock_Price:  99.12702768029584
curr_Factors:  [99.12702768]
mat_Sqrt:  [[0.15]]
grads:  [0.00866406]
Stock Position:  0.008664060426458503
Bond Position:  [-3.10593025]


portfolio before change:  [-2.24889031]
curr_Stock_Price:  98.94137589381756
curr_Factors:  [98.94137589]
mat_Sqrt:  [[0.15]]
grads:  [-0.12444613]
Stock Position:  -0.12444612720306832
Bond Position:  [10.06398074]


portfolio before change:  [-2.14115296]
curr_Stock_Price:  98.08069555114099
curr_Factors:  [98.08069555]
mat_Sqrt:  [[0.15]]
grads:  [-0.07581348]
Stock Position:  -0.0758134785243117
Bond Position:  [5.29468575]


portfolio before change:  [-2.112559]
curr_Stock_Price:  97.70789858002759
curr_Factors:  [97.70789858]
mat_Sqrt:  [[0.15]]
grads:  [0.2031085]
Stock Position:  0.20310849604868425
Bond Position:  [-21.95786333]


portfolio before change:  [-1.94502656]
curr_Stock_Price:  98.53949771373895
curr_Factors:  [98.53949771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818605]
Stock Position:  -0.018186047382302725
Bond Position:  [-0.15298258]


portfolio before change:  [-1.94206196]
curr_Stock_Price:  98.3759572773829
curr_Factors:  [98.37595728]
mat_Sqrt:  [[0.15]]
grads:  [0.16013748]
Stock Position:  0.16013748186557053
Bond Position:  [-17.69574004]


portfolio before change:  [-1.90053769]
curr_Stock_Price:  98.64216784444068
curr_Factors:  [98.64216784]
mat_Sqrt:  [[0.15]]
grads:  [-0.09521581]
Stock Position:  -0.09521580671906187
Bond Position:  [7.49175589]


portfolio before change:  [-1.84066497]
curr_Stock_Price:  98.01827482428227
curr_Factors:  [98.01827482]
mat_Sqrt:  [[0.15]]
grads:  [0.03081866]
Stock Position:  0.030818661246798402
Bond Position:  [-4.86145697]


portfolio before change:  [-1.83446492]
curr_Stock_Price:  98.22931243130591
curr_Factors:  [98.22931243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04659092]
Stock Position:  -0.04659091803667131
Bond Position:  [2.74212892]


portfolio before change:  [-1.81526439]
curr_Stock_Price:  97.82088222757179
curr_Factors:  [97.82088223]
mat_Sqrt:  [[0.15]]
grads:  [0.06452076]
Stock Position:  0.06452075952674795
Bond Position:  [-8.12674201]


portfolio before change:  [-1.84179742]
curr_Stock_Price:  97.41752230386672
curr_Factors:  [97.4175223]
mat_Sqrt:  [[0.15]]
grads:  [0.07715586]
Stock Position:  0.07715586117757678
Bond Position:  [-9.35813025]


portfolio before change:  [-1.90745209]
curr_Stock_Price:  96.57416750527004
curr_Factors:  [96.57416751]
mat_Sqrt:  [[0.15]]
grads:  [0.11518571]
Stock Position:  0.11518570600412101
Bond Position:  [-13.03141575]


portfolio before change:  [-1.92961506]
curr_Stock_Price:  96.38882780134834
curr_Factors:  [96.3888278]
mat_Sqrt:  [[0.15]]
grads:  [0.00545742]
Stock Position:  0.005457422801664903
Bond Position:  [-2.45564965]


portfolio before change:  [-1.92792365]
curr_Stock_Price:  96.72687985781347
curr_Factors:  [96.72687986]
mat_Sqrt:  [[0.15]]
grads:  [0.0668121]
Stock Position:  0.06681210466264537
Bond Position:  [-8.39045007]


portfolio before change:  [-1.9966346]
curr_Stock_Price:  95.70630837949922
curr_Factors:  [95.70630838]
mat_Sqrt:  [[0.15]]
grads:  [0.08812547]
Stock Position:  0.08812546772504525
Bond Position:  [-10.43079779]


portfolio before change:  [-2.09989128]
curr_Stock_Price:  94.54200549176348
curr_Factors:  [94.54200549]
mat_Sqrt:  [[0.15]]
grads:  [-0.08618663]
Stock Position:  -0.08618663147004468
Bond Position:  [6.04836571]


portfolio before change:  [-2.05383089]
curr_Stock_Price:  94.01196561881213
curr_Factors:  [94.01196562]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002674]
Stock Position:  -0.04002673602839284
Bond Position:  [1.70916124]


portfolio before change:  [-2.04622295]
curr_Stock_Price:  93.82456292866894
curr_Factors:  [93.82456293]
mat_Sqrt:  [[0.15]]
grads:  [-1.13337911]
Stock Position:  -1.1333791053361528
Bond Position:  [104.29257624]


portfolio before change:  [-2.14569642]
curr_Stock_Price:  93.91808146834852
curr_Factors:  [93.91808147]
mat_Sqrt:  [[0.15]]
grads:  [-0.09399118]
Stock Position:  -0.09399117793338752
Bond Position:  [6.68177469]


portfolio before change:  [-2.13577853]
curr_Stock_Price:  93.81700532095365
curr_Factors:  [93.81700532]
mat_Sqrt:  [[0.15]]
grads:  [0.02060162]
Stock Position:  0.020601621147003556
Bond Position:  [-4.06856093]


portfolio before change:  [-2.13439088]
curr_Stock_Price:  93.89670481464366
curr_Factors:  [93.89670481]
mat_Sqrt:  [[0.15]]
grads:  [0.03970337]
Stock Position:  0.0397033678463777
Bond Position:  [-5.86240629]


portfolio before change:  [-2.16353448]
curr_Stock_Price:  93.17190015276283
curr_Factors:  [93.17190015]
mat_Sqrt:  [[0.15]]
grads:  [0.12315596]
Stock Position:  0.12315596300329641
Bond Position:  [-13.63820957]


portfolio before change:  [-2.1519014]
curr_Stock_Price:  93.27327971749902
curr_Factors:  [93.27327972]
mat_Sqrt:  [[0.15]]
grads:  [-0.7153908]
Stock Position:  -0.7153908009164334
Bond Position:  [64.57494488]


portfolio before change:  [-2.10839568]
curr_Stock_Price:  93.21810755066359
curr_Factors:  [93.21810755]
mat_Sqrt:  [[0.15]]
grads:  [0.0664671]
Stock Position:  0.06646709859831043
Bond Position:  [-8.30433282]


portfolio before change:  [-2.11436909]
curr_Stock_Price:  93.13604633127326
curr_Factors:  [93.13604633]
mat_Sqrt:  [[0.15]]
grads:  [0.17801058]
Stock Position:  0.17801058351405682
Bond Position:  [-18.69357104]


portfolio before change:  [-2.22164767]
curr_Stock_Price:  92.53995708622443
curr_Factors:  [92.53995709]
mat_Sqrt:  [[0.15]]
grads:  [-0.11634622]
Stock Position:  -0.11634621953486679
Bond Position:  [8.5450265]


portfolio before change:  [-2.19715905]
curr_Stock_Price:  92.33406696941731
curr_Factors:  [92.33406697]
mat_Sqrt:  [[0.15]]
grads:  [-0.03543393]
Stock Position:  -0.0354339301646092
Bond Position:  [1.07459983]


portfolio before change:  [-2.20557922]
curr_Stock_Price:  92.57359277864613
curr_Factors:  [92.57359278]
mat_Sqrt:  [[0.15]]
grads:  [0.06365977]
Stock Position:  0.06365976814770496
Bond Position:  [-8.09879268]


portfolio before change:  [-2.24413984]
curr_Stock_Price:  91.9758144796299
curr_Factors:  [91.97581448]
mat_Sqrt:  [[0.15]]
grads:  [0.09585984]
Stock Position:  0.09585983703671978
Bond Position:  [-11.06092643]


portfolio before change:  [-2.29467671]
curr_Stock_Price:  91.45583089389979
curr_Factors:  [91.45583089]
mat_Sqrt:  [[0.15]]
grads:  [-0.10127553]
Stock Position:  -0.10127553368735732
Bond Position:  [6.96756137]


portfolio before change:  [-2.31202405]
curr_Stock_Price:  91.63141939278344
curr_Factors:  [91.63141939]
mat_Sqrt:  [[0.15]]
grads:  [-0.15818004]
Stock Position:  -0.15818004303957595
Bond Position:  [12.18223782]


portfolio before change:  [-2.43748297]
curr_Stock_Price:  92.42937299801946
curr_Factors:  [92.429373]
mat_Sqrt:  [[0.15]]
grads:  [0.04547828]
Stock Position:  0.04547828451262956
Bond Position:  [-6.64101229]


portfolio before change:  [-2.41621888]
curr_Stock_Price:  92.90606573144117
curr_Factors:  [92.90606573]
mat_Sqrt:  [[0.15]]
grads:  [-0.3748941]
Stock Position:  -0.3748940968240681
Bond Position:  [32.41371673]


portfolio before change:  [-2.3249067]
curr_Stock_Price:  92.66790179998118
curr_Factors:  [92.6679018]
mat_Sqrt:  [[0.15]]
grads:  [-0.13961034]
Stock Position:  -0.13961034337387704
Bond Position:  [10.61249089]


portfolio before change:  [-2.36913939]
curr_Stock_Price:  92.98948245007814
curr_Factors:  [92.98948245]
mat_Sqrt:  [[0.15]]
grads:  [-0.11321363]
Stock Position:  -0.11321362721755246
Bond Position:  [8.15853721]


portfolio before change:  [-2.31296825]
curr_Stock_Price:  92.49783477682156
curr_Factors:  [92.49783478]
mat_Sqrt:  [[0.15]]
grads:  [0.54802283]
Stock Position:  0.5480228342549298
Bond Position:  [-53.00389382]


portfolio before change:  [-2.34596864]
curr_Stock_Price:  92.44366267280529
curr_Factors:  [92.44366267]
mat_Sqrt:  [[0.15]]
grads:  [0.15810163]
Stock Position:  0.1581016270708199
Bond Position:  [-16.96146212]


portfolio before change:  [-2.425896]
curr_Stock_Price:  91.94482381827748
curr_Factors:  [91.94482382]
mat_Sqrt:  [[0.15]]
grads:  [0.01255045]
Stock Position:  0.012550452995234248
Bond Position:  [-3.57984519]


portfolio before change:  [-2.42174338]
curr_Stock_Price:  92.29352620887127
curr_Factors:  [92.29352621]
mat_Sqrt:  [[0.15]]
grads:  [0.10621778]
Stock Position:  0.10621777890919613
Bond Position:  [-12.22495674]


portfolio before change:  [-2.4216733]
curr_Stock_Price:  92.30137948176976
curr_Factors:  [92.30137948]
mat_Sqrt:  [[0.15]]
grads:  [0.29099356]
Stock Position:  0.29099356344626176
Bond Position:  [-29.28078063]


portfolio before change:  [-2.63168938]
curr_Stock_Price:  91.58594796308073
curr_Factors:  [91.58594796]
mat_Sqrt:  [[0.15]]
grads:  [-0.04926177]
Stock Position:  -0.04926177133820725
Bond Position:  [1.87999665]


portfolio before change:  [-2.6263899]
curr_Stock_Price:  91.48075547672316
curr_Factors:  [91.48075548]
mat_Sqrt:  [[0.15]]
grads:  [0.07244717]
Stock Position:  0.07244716709118004
Bond Position:  [-9.25391148]


portfolio before change:  [-2.66916027]
curr_Stock_Price:  90.89837276590535
curr_Factors:  [90.89837277]
mat_Sqrt:  [[0.15]]
grads:  [0.34998006]
Stock Position:  0.3499800588521901
Bond Position:  [-34.48177812]


portfolio before change:  [-2.45305086]
curr_Stock_Price:  91.52202141966536
curr_Factors:  [91.52202142]
mat_Sqrt:  [[0.15]]
grads:  [0.07755472]
Stock Position:  0.07755472466322158
Bond Position:  [-9.55101603]


portfolio before change:  [-2.40662231]
curr_Stock_Price:  92.12837394439762
curr_Factors:  [92.12837394]
mat_Sqrt:  [[0.15]]
grads:  [0.15393069]
Stock Position:  0.15393069176176
Bond Position:  [-16.58800664]


portfolio before change:  [-2.34878298]
curr_Stock_Price:  92.51085850738923
curr_Factors:  [92.51085851]
mat_Sqrt:  [[0.15]]
grads:  [0.14182337]
Stock Position:  0.14182337468041323
Bond Position:  [-15.46898513]


portfolio before change:  [-2.41515832]
curr_Stock_Price:  92.04966160715554
curr_Factors:  [92.04966161]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465495]
Stock Position:  -0.014654949548094058
Bond Position:  [-1.06617517]


portfolio before change:  [-2.41269119]
curr_Stock_Price:  91.87676668020025
curr_Factors:  [91.87676668]
mat_Sqrt:  [[0.15]]
grads:  [0.02700714]
Stock Position:  0.027007142919254802
Bond Position:  [-4.89402016]


portfolio before change:  [-2.41720765]
curr_Stock_Price:  91.72086102778349
curr_Factors:  [91.72086103]
mat_Sqrt:  [[0.15]]
grads:  [0.03367632]
Stock Position:  0.03367631730473027
Bond Position:  [-5.50602846]


portfolio before change:  [-2.42447888]
curr_Stock_Price:  91.51516451854351
curr_Factors:  [91.51516452]
mat_Sqrt:  [[0.15]]
grads:  [0.05510086]
Stock Position:  0.055100864895766856
Bond Position:  [-7.4670436]


portfolio before change:  [-2.43177037]
curr_Stock_Price:  91.39130474761177
curr_Factors:  [91.39130475]
mat_Sqrt:  [[0.15]]
grads:  [-0.2432222]
Stock Position:  -0.2432222002831661
Bond Position:  [19.79662386]


portfolio before change:  [-2.3974668]
curr_Stock_Price:  91.25535401241328
curr_Factors:  [91.25535401]
mat_Sqrt:  [[0.15]]
grads:  [0.01183326]
Stock Position:  0.011833264717305147
Bond Position:  [-3.47731557]


portfolio before change:  [-2.39121841]
curr_Stock_Price:  91.80175677708529
curr_Factors:  [91.80175678]
mat_Sqrt:  [[0.15]]
grads:  [0.01104735]
Stock Position:  0.011047353152618003
Bond Position:  [-3.40538484]


portfolio before change:  [-2.38692351]
curr_Stock_Price:  92.20979559332815
curr_Factors:  [92.20979559]
mat_Sqrt:  [[0.15]]
grads:  [-0.92482117]
Stock Position:  -0.9248211657899743
Bond Position:  [82.89064715]


portfolio before change:  [-2.319556]
curr_Stock_Price:  92.1425537482584
curr_Factors:  [92.14255375]
mat_Sqrt:  [[0.15]]
grads:  [-0.12038411]
Stock Position:  -0.12038411308533849
Bond Position:  [8.77294361]


portfolio before change:  [-2.31614205]
curr_Stock_Price:  92.11874975081827
curr_Factors:  [92.11874975]
mat_Sqrt:  [[0.15]]
grads:  [0.1132145]
Stock Position:  0.11321449939047247
Bond Position:  [-12.74532019]


portfolio before change:  [-2.31897363]
curr_Stock_Price:  92.10077526938223
curr_Factors:  [92.10077527]
mat_Sqrt:  [[0.15]]
grads:  [0.1274603]
Stock Position:  0.12746029958084387
Bond Position:  [-14.05816604]


portfolio before change:  [-2.31798766]
curr_Stock_Price:  92.11540441806197
curr_Factors:  [92.11540442]
mat_Sqrt:  [[0.15]]
grads:  [-0.13503651]
Stock Position:  -0.1350365093225677
Bond Position:  [10.12095501]


portfolio before change:  [-2.38362274]
curr_Stock_Price:  92.60614327831343
curr_Factors:  [92.60614328]
mat_Sqrt:  [[0.15]]
grads:  [-0.03554713]
Stock Position:  -0.035547128473744014
Bond Position:  [0.90825973]


portfolio before change:  [-2.39332252]
curr_Stock_Price:  92.88061131843767
curr_Factors:  [92.88061132]
mat_Sqrt:  [[0.15]]
grads:  [-0.11666114]
Stock Position:  -0.11666113820183628
Bond Position:  [8.44223531]


portfolio before change:  [-2.37140025]
curr_Stock_Price:  92.69722022915269
curr_Factors:  [92.69722023]
mat_Sqrt:  [[0.15]]
grads:  [-0.02345346]
Stock Position:  -0.023453460780238335
Bond Position:  [-0.19732964]


portfolio before change:  [-2.34896552]
curr_Stock_Price:  91.7401306455623
curr_Factors:  [91.74013065]
mat_Sqrt:  [[0.15]]
grads:  [-0.0955238]
Stock Position:  -0.09552380235611502
Bond Position:  [6.41440058]


portfolio before change:  [-2.39693773]
curr_Stock_Price:  92.24652918887529
curr_Factors:  [92.24652919]
mat_Sqrt:  [[0.15]]
grads:  [-0.15257579]
Stock Position:  -0.1525757907916223
Bond Position:  [11.67764941]


portfolio before change:  [-2.2494001]
curr_Stock_Price:  91.28433359001133
curr_Factors:  [91.28433359]
mat_Sqrt:  [[0.15]]
grads:  [0.1225502]
Stock Position:  0.12255020413716576
Bond Position:  [-13.43631381]


portfolio before change:  [-2.20608198]
curr_Stock_Price:  91.6446586829925
curr_Factors:  [91.64465868]
mat_Sqrt:  [[0.15]]
grads:  [0.12130327]
Stock Position:  0.12130326971464613
Bond Position:  [-13.32287873]


portfolio before change:  [-2.24145334]
curr_Stock_Price:  91.35992885638913
curr_Factors:  [91.35992886]
mat_Sqrt:  [[0.15]]
grads:  [0.09088015]
Stock Position:  0.09088015175027817
Bond Position:  [-10.54425754]


portfolio before change:  [-2.2203672]
curr_Stock_Price:  91.59920205087921
curr_Factors:  [91.59920205]
mat_Sqrt:  [[0.15]]
grads:  [0.00889175]
Stock Position:  0.008891746513719215
Bond Position:  [-3.03484408]


portfolio before change:  [-2.21788209]
curr_Stock_Price:  91.90001859458582
curr_Factors:  [91.90001859]
mat_Sqrt:  [[0.15]]
grads:  [0.05625744]
Stock Position:  0.056257441421304344
Bond Position:  [-7.38794201]


portfolio before change:  [-2.21241107]
curr_Stock_Price:  92.00547635402776
curr_Factors:  [92.00547635]
mat_Sqrt:  [[0.15]]
grads:  [0.18156785]
Stock Position:  0.1815678472226378
Bond Position:  [-18.91764735]


portfolio before change:  [-2.23282732]
curr_Stock_Price:  91.89954427634679
curr_Factors:  [91.89954428]
mat_Sqrt:  [[0.15]]
grads:  [-0.17541383]
Stock Position:  -0.17541382702878625
Bond Position:  [13.88762344]


portfolio before change:  [-2.29905945]
curr_Stock_Price:  92.28206901770338
curr_Factors:  [92.28206902]
mat_Sqrt:  [[0.15]]
grads:  [0.03059933]
Stock Position:  0.030599330821088854
Bond Position:  [-5.12282901]


portfolio before change:  [-2.31905101]
curr_Stock_Price:  91.6391995702986
curr_Factors:  [91.63919957]
mat_Sqrt:  [[0.15]]
grads:  [0.07127187]
Stock Position:  0.07127187424604677
Bond Position:  [-8.85034852]


portfolio before change:  [-2.33408121]
curr_Stock_Price:  91.43607538912687
curr_Factors:  [91.43607539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.33408121]
Stock Price:  90.92139746009572
PL:  [-2.33408121]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.45185235e-03]
 [ 1.77620952e-04]
 [-4.86430024e-04]
 [ 8.36170829e-03]
 [ 1.68138550e-03]
 [ 1.68725378e-02]
 [ 3.71275107e-03]
 [-2.48522209e-02]
 [-2.25573034e-02]
 [ 3.71698890e-02]
 [-1.31052565e-01]
 [ 3.84376473e-02]
 [-2.69084132e-03]
 [-2.57264785e-03]
 [-7.16561760e-03]
 [ 9.29876699e-03]
 [ 1.85203579e-02]
 [ 2.45606685e-02]
 [ 8.30481137e-04]
 [ 1.07924497e-02]
 [ 1.31343487e-02]
 [-1.10714501e-02]
 [-6.13387369e-05]
 [-8.98769004e-02]
 [-1.21995305e-02]
 [-2.43192761e-03]
 [ 2.47170439e-03]
 [ 1.41331116e-02]
 [-8.11928733e-02]
 [ 7.36088513e-03]
 [ 1.61550804e-02]
 [-1.20925443e-02]
 [-6.76953675e-03]
 [ 7.67242059e-03]
 [ 1.37415031e-02]
 [ 7.82710114e-03]
 [-3.08563433e-02]
 [ 7.42703271e-03]
 [-5.22043694e-02]
 [-1.36918613e-02]
 [-1.56768910e-02]
 [ 5.89332369e-02]
 [ 2.33566764e-02]
 [ 3.62138403e-03]
 [ 5.85949739e-03]
 [ 1.37449521e-02]
 [ 5.55429838e-04]
 [-1.19499743e-02]
 [ 9.53019885e-04]
 [ 2.04869681e-03]
 [ 3.92087297e-02]
 [-1.81745939e-03]
 [ 2.17026679e-03]
 [ 4.81793331e-03]
 [ 3.53979393e-03]
 [ 3.49201330e-03]
 [-1.38678533e-02]
 [-8.55253793e-06]
 [ 1.59626946e-03]
 [-5.57941283e-02]
 [-1.17981896e-02]
 [ 1.75576452e-02]
 [ 1.62741111e-02]
 [-1.90309064e-02]
 [-5.05600044e-03]
 [-1.17866075e-02]
 [-4.81398416e-03]
 [ 1.88877895e-02]
 [-1.03434234e-02]
 [ 6.64669961e-03]
 [-4.55166952e-03]
 [ 1.11174379e-02]
 [-7.01527628e-04]
 [ 5.97996547e-03]
 [-1.76872954e-02]
 [-6.05611937e-03]
 [ 2.66321493e-04]
 [ 1.61522873e-03]
 [-9.07002613e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.33352878]
curr_Stock_Price:  100.01898416879283
curr_Factors:  [100.01898417]
mat_Sqrt:  [[0.15]]
grads:  [0.00967902]
Stock Position:  0.009679015696785207
Bond Position:  [1.36544347]


portfolio before change:  [2.33025338]
curr_Stock_Price:  99.67176438324942
curr_Factors:  [99.67176438]
mat_Sqrt:  [[0.15]]
grads:  [0.00118414]
Stock Position:  0.0011841396789127388
Bond Position:  [2.21222809]


portfolio before change:  [2.33106581]
curr_Stock_Price:  100.24109304286871
curr_Factors:  [100.24109304]
mat_Sqrt:  [[0.15]]
grads:  [-0.00324287]
Stock Position:  -0.0032428668253367716
Bond Position:  [2.65613433]


portfolio before change:  [2.3328385]
curr_Stock_Price:  99.74564419903797
curr_Factors:  [99.7456442]
mat_Sqrt:  [[0.15]]
grads:  [0.05574472]
Stock Position:  0.05574472192164846
Bond Position:  [-3.2274547]


portfolio before change:  [2.30013666]
curr_Stock_Price:  99.16262717498972
curr_Factors:  [99.16262717]
mat_Sqrt:  [[0.15]]
grads:  [0.01120924]
Stock Position:  0.011209236663697185
Bond Position:  [1.1885993]


portfolio before change:  [2.2964996]
curr_Stock_Price:  98.83152954760003
curr_Factors:  [98.83152955]
mat_Sqrt:  [[0.15]]
grads:  [0.11248359]
Stock Position:  0.11248358516338831
Bond Position:  [-8.82042518]


portfolio before change:  [2.19024965]
curr_Stock_Price:  97.89184885488856
curr_Factors:  [97.89184885]
mat_Sqrt:  [[0.15]]
grads:  [0.02475167]
Stock Position:  0.02475167379253693
Bond Position:  [-0.23273746]


portfolio before change:  [2.19370274]
curr_Stock_Price:  98.0319460875295
curr_Factors:  [98.03194609]
mat_Sqrt:  [[0.15]]
grads:  [-0.16568147]
Stock Position:  -0.1656814726773303
Bond Position:  [18.43577994]


portfolio before change:  [2.26694612]
curr_Stock_Price:  97.59682742359898
curr_Factors:  [97.59682742]
mat_Sqrt:  [[0.15]]
grads:  [-0.15038202]
Stock Position:  -0.1503820224780703
Bond Position:  [16.94375441]


portfolio before change:  [2.37161339]
curr_Stock_Price:  96.90786038877124
curr_Factors:  [96.90786039]
mat_Sqrt:  [[0.15]]
grads:  [0.24779926]
Stock Position:  0.24779926004417124
Bond Position:  [-21.64208271]


portfolio before change:  [2.14552768]
curr_Stock_Price:  96.00094469712762
curr_Factors:  [96.0009447]
mat_Sqrt:  [[0.15]]
grads:  [-0.87368377]
Stock Position:  -0.8736837659432225
Bond Position:  [86.01999458]


portfolio before change:  [2.40629202]
curr_Stock_Price:  95.70863307080005
curr_Factors:  [95.70863307]
mat_Sqrt:  [[0.15]]
grads:  [0.25625098]
Stock Position:  0.256250982182406
Bond Position:  [-22.11913921]


portfolio before change:  [2.30092316]
curr_Stock_Price:  95.30283414616994
curr_Factors:  [95.30283415]
mat_Sqrt:  [[0.15]]
grads:  [-0.01793894]
Stock Position:  -0.017938942161622173
Bond Position:  [4.01055519]


portfolio before change:  [2.28421557]
curr_Stock_Price:  96.2481662814032
curr_Factors:  [96.24816628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715099]
Stock Position:  -0.017150985649732973
Bond Position:  [3.93496649]


portfolio before change:  [2.3048409]
curr_Stock_Price:  95.05993221647489
curr_Factors:  [95.05993222]
mat_Sqrt:  [[0.15]]
grads:  [-0.04777078]
Stock Position:  -0.04777078402667989
Bond Position:  [6.84592839]


portfolio before change:  [2.3142008]
curr_Stock_Price:  94.87295557963874
curr_Factors:  [94.87295558]
mat_Sqrt:  [[0.15]]
grads:  [0.06199178]
Stock Position:  0.06199177990532246
Bond Position:  [-3.56714258]


portfolio before change:  [2.34391574]
curr_Stock_Price:  95.35588891555061
curr_Factors:  [95.35588892]
mat_Sqrt:  [[0.15]]
grads:  [0.12346905]
Stock Position:  0.12346905254109503
Bond Position:  [-9.42958552]


portfolio before change:  [2.43891621]
curr_Stock_Price:  96.13008969374462
curr_Factors:  [96.13008969]
mat_Sqrt:  [[0.15]]
grads:  [0.16373779]
Stock Position:  0.16373778987404727
Bond Position:  [-13.30121221]


portfolio before change:  [2.40226454]
curr_Stock_Price:  95.91132330223941
curr_Factors:  [95.9113233]
mat_Sqrt:  [[0.15]]
grads:  [0.00553654]
Stock Position:  0.005536540915809431
Bond Position:  [1.87124757]


portfolio before change:  [2.40591776]
curr_Stock_Price:  96.55003718517898
curr_Factors:  [96.55003719]
mat_Sqrt:  [[0.15]]
grads:  [0.07194966]
Stock Position:  0.07194966485478799
Bond Position:  [-4.54082506]


portfolio before change:  [2.38702376]
curr_Stock_Price:  96.2913814699853
curr_Factors:  [96.29138147]
mat_Sqrt:  [[0.15]]
grads:  [0.08756232]
Stock Position:  0.0875623244197972
Bond Position:  [-6.04447343]


portfolio before change:  [2.36739512]
curr_Stock_Price:  96.07152847657662
curr_Factors:  [96.07152848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07380967]
Stock Position:  -0.07380966741745396
Bond Position:  [9.45840269]


portfolio before change:  [2.38185412]
curr_Stock_Price:  95.883642105362
curr_Factors:  [95.88364211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00040892]
Stock Position:  -0.00040892491274112375
Bond Position:  [2.42106333]


portfolio before change:  [2.38209]
curr_Stock_Price:  95.67686747958409
curr_Factors:  [95.67686748]
mat_Sqrt:  [[0.15]]
grads:  [-0.59917934]
Stock Position:  -0.5991793360171452
Bond Position:  [59.70969193]


portfolio before change:  [2.0617462]
curr_Stock_Price:  96.21773354674191
curr_Factors:  [96.21773355]
mat_Sqrt:  [[0.15]]
grads:  [-0.0813302]
Stock Position:  -0.08133020319302553
Bond Position:  [9.88715402]


portfolio before change:  [2.06275431]
curr_Stock_Price:  96.2129365037541
curr_Factors:  [96.2129365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01621285]
Stock Position:  -0.01621285075581999
Bond Position:  [3.62264029]


portfolio before change:  [2.0750272]
curr_Stock_Price:  95.46991696098102
curr_Factors:  [95.46991696]
mat_Sqrt:  [[0.15]]
grads:  [0.01647803]
Stock Position:  0.016478029268087842
Bond Position:  [0.50187111]


portfolio before change:  [2.06478555]
curr_Stock_Price:  94.84647964241232
curr_Factors:  [94.84647964]
mat_Sqrt:  [[0.15]]
grads:  [0.09422074]
Stock Position:  0.09422074376718576
Bond Position:  [-6.87172031]


portfolio before change:  [2.03748533]
curr_Stock_Price:  94.56129056572676
curr_Factors:  [94.56129057]
mat_Sqrt:  [[0.15]]
grads:  [-0.54128582]
Stock Position:  -0.5412858219027861
Bond Position:  [53.22217121]


portfolio before change:  [1.97185754]
curr_Stock_Price:  94.68868033598304
curr_Factors:  [94.68868034]
mat_Sqrt:  [[0.15]]
grads:  [0.04907257]
Stock Position:  0.04907256753820122
Bond Position:  [-2.67475912]


portfolio before change:  [1.98644691]
curr_Stock_Price:  94.9893890596149
curr_Factors:  [94.98938906]
mat_Sqrt:  [[0.15]]
grads:  [0.10770054]
Stock Position:  0.10770053588496392
Bond Position:  [-8.24396119]


portfolio before change:  [2.05881048]
curr_Stock_Price:  95.66606933089017
curr_Factors:  [95.66606933]
mat_Sqrt:  [[0.15]]
grads:  [-0.08061696]
Stock Position:  -0.08061696171365373
Bond Position:  [9.77111832]


portfolio before change:  [2.11632265]
curr_Stock_Price:  94.96024441508088
curr_Factors:  [94.96024442]
mat_Sqrt:  [[0.15]]
grads:  [-0.04513025]
Stock Position:  -0.045130245001227975
Bond Position:  [6.40190175]


portfolio before change:  [2.13553911]
curr_Stock_Price:  94.54331054231716
curr_Factors:  [94.54331054]
mat_Sqrt:  [[0.15]]
grads:  [0.05114947]
Stock Position:  0.05114947060260312
Bond Position:  [-2.70030117]


portfolio before change:  [2.18036875]
curr_Stock_Price:  95.4230540218668
curr_Factors:  [95.42305402]
mat_Sqrt:  [[0.15]]
grads:  [0.09161002]
Stock Position:  0.0916100204128044
Bond Position:  [-6.56133918]


portfolio before change:  [2.24302026]
curr_Stock_Price:  96.11142422697064
curr_Factors:  [96.11142423]
mat_Sqrt:  [[0.15]]
grads:  [0.05218067]
Stock Position:  0.0521806742509906
Bond Position:  [-2.77213866]


portfolio before change:  [2.19720493]
curr_Stock_Price:  95.23673139540237
curr_Factors:  [95.2367314]
mat_Sqrt:  [[0.15]]
grads:  [-0.20570896]
Stock Position:  -0.2057089552754787
Bond Position:  [21.78825345]


portfolio before change:  [2.41740773]
curr_Stock_Price:  94.17289348870239
curr_Factors:  [94.17289349]
mat_Sqrt:  [[0.15]]
grads:  [0.04951355]
Stock Position:  0.049513551389066386
Bond Position:  [-2.24542667]


portfolio before change:  [2.38685272]
curr_Stock_Price:  93.55862410987578
curr_Factors:  [93.55862411]
mat_Sqrt:  [[0.15]]
grads:  [-0.34802913]
Stock Position:  -0.3480291294586315
Bond Position:  [34.94797923]


portfolio before change:  [2.36447727]
curr_Stock_Price:  93.62919225591752
curr_Factors:  [93.62919226]
mat_Sqrt:  [[0.15]]
grads:  [-0.09127908]
Stock Position:  -0.09127907533607779
Bond Position:  [10.91086336]


portfolio before change:  [2.32272297]
curr_Stock_Price:  94.09409895639062
curr_Factors:  [94.09409896]
mat_Sqrt:  [[0.15]]
grads:  [-0.10451261]
Stock Position:  -0.10451260662451563
Bond Position:  [12.15674252]


portfolio before change:  [2.28235643]
curr_Stock_Price:  94.48760519246719
curr_Factors:  [94.48760519]
mat_Sqrt:  [[0.15]]
grads:  [0.39288825]
Stock Position:  0.3928882461158239
Bond Position:  [-34.84071306]


portfolio before change:  [2.62381587]
curr_Stock_Price:  95.36224845698567
curr_Factors:  [95.36224846]
mat_Sqrt:  [[0.15]]
grads:  [0.15571118]
Stock Position:  0.15571117620197222
Bond Position:  [-12.225152]


portfolio before change:  [2.62574632]
curr_Stock_Price:  95.3795532044629
curr_Factors:  [95.3795532]
mat_Sqrt:  [[0.15]]
grads:  [0.02414256]
Stock Position:  0.02414256021077969
Bond Position:  [0.32303971]


portfolio before change:  [2.64229546]
curr_Stock_Price:  96.06419280587713
curr_Factors:  [96.06419281]
mat_Sqrt:  [[0.15]]
grads:  [0.03906332]
Stock Position:  0.03906331592760615
Bond Position:  [-1.11029045]


portfolio before change:  [2.63202703]
curr_Stock_Price:  95.80310285781296
curr_Factors:  [95.80310286]
mat_Sqrt:  [[0.15]]
grads:  [0.09163301]
Stock Position:  0.09163301422864659
Bond Position:  [-6.14670006]


portfolio before change:  [2.70672546]
curr_Stock_Price:  96.62248677503739
curr_Factors:  [96.62248678]
mat_Sqrt:  [[0.15]]
grads:  [0.00370287]
Stock Position:  0.003702865586500022
Bond Position:  [2.34894538]


portfolio before change:  [2.70764058]
curr_Stock_Price:  96.82997404345043
curr_Factors:  [96.82997404]
mat_Sqrt:  [[0.15]]
grads:  [-0.0796665]
Stock Position:  -0.07966649562463952
Bond Position:  [10.42174528]


portfolio before change:  [2.71419842]
curr_Stock_Price:  96.75583413417412
curr_Factors:  [96.75583413]
mat_Sqrt:  [[0.15]]
grads:  [0.00635347]
Stock Position:  0.006353465899597947
Bond Position:  [2.09946353]


portfolio before change:  [2.71172619]
curr_Stock_Price:  96.34606608497123
curr_Factors:  [96.34606608]
mat_Sqrt:  [[0.15]]
grads:  [0.01365798]
Stock Position:  0.013657978748226874
Bond Position:  [1.39583367]


portfolio before change:  [2.71334724]
curr_Stock_Price:  96.45836732927881
curr_Factors:  [96.45836733]
mat_Sqrt:  [[0.15]]
grads:  [0.26139153]
Stock Position:  0.2613915312544683
Bond Position:  [-22.50005309]


portfolio before change:  [2.69744825]
curr_Stock_Price:  96.40292290649967
curr_Factors:  [96.40292291]
mat_Sqrt:  [[0.15]]
grads:  [-0.0121164]
Stock Position:  -0.012116395963310557
Bond Position:  [3.86550423]


portfolio before change:  [2.69437422]
curr_Stock_Price:  96.67657105602198
curr_Factors:  [96.67657106]
mat_Sqrt:  [[0.15]]
grads:  [0.01446845]
Stock Position:  0.014468445291633207
Bond Position:  [1.29561454]


portfolio before change:  [2.684247]
curr_Stock_Price:  95.971022285974
curr_Factors:  [95.97102229]
mat_Sqrt:  [[0.15]]
grads:  [0.03211956]
Stock Position:  0.03211955540466644
Bond Position:  [-0.39829957]


portfolio before change:  [2.66413666]
curr_Stock_Price:  95.34568849848571
curr_Factors:  [95.3456885]
mat_Sqrt:  [[0.15]]
grads:  [0.02359863]
Stock Position:  0.02359862621906532
Bond Position:  [0.4141094]


portfolio before change:  [2.66750127]
curr_Stock_Price:  95.487168029881
curr_Factors:  [95.48716803]
mat_Sqrt:  [[0.15]]
grads:  [0.02328009]
Stock Position:  0.02328008863384306
Bond Position:  [0.44455153]


portfolio before change:  [2.65315232]
curr_Stock_Price:  94.86961285529983
curr_Factors:  [94.86961286]
mat_Sqrt:  [[0.15]]
grads:  [-0.09245236]
Stock Position:  -0.09245235513717878
Bond Position:  [11.42407146]


portfolio before change:  [2.62907634]
curr_Stock_Price:  95.13775099971161
curr_Factors:  [95.137751]
mat_Sqrt:  [[0.15]]
grads:  [-5.70169195e-05]
Stock Position:  -5.7016919519225096e-05
Bond Position:  [2.6345008]


portfolio before change:  [2.62927823]
curr_Stock_Price:  94.48485281921381
curr_Factors:  [94.48485282]
mat_Sqrt:  [[0.15]]
grads:  [0.0106418]
Stock Position:  0.01064179639735435
Bond Position:  [1.62378966]


portfolio before change:  [2.63721112]
curr_Stock_Price:  95.22076259580247
curr_Factors:  [95.2207626]
mat_Sqrt:  [[0.15]]
grads:  [-0.37196086]
Stock Position:  -0.37196085559608716
Bond Position:  [38.05560744]


portfolio before change:  [2.7206488]
curr_Stock_Price:  95.00283877935007
curr_Factors:  [95.00283878]
mat_Sqrt:  [[0.15]]
grads:  [-0.0786546]
Stock Position:  -0.07865459720355097
Bond Position:  [10.19305882]


portfolio before change:  [2.69156533]
curr_Stock_Price:  95.38070041641082
curr_Factors:  [95.38070042]
mat_Sqrt:  [[0.15]]
grads:  [0.11705097]
Stock Position:  0.11705096791888556
Bond Position:  [-8.47283798]


portfolio before change:  [2.61875137]
curr_Stock_Price:  94.76315410926114
curr_Factors:  [94.76315411]
mat_Sqrt:  [[0.15]]
grads:  [0.10849407]
Stock Position:  0.10849407372874909
Bond Position:  [-7.66248926]


portfolio before change:  [2.7133076]
curr_Stock_Price:  95.63910197157509
curr_Factors:  [95.63910197]
mat_Sqrt:  [[0.15]]
grads:  [-0.12687271]
Stock Position:  -0.12687270904404252
Bond Position:  [14.84729956]


portfolio before change:  [2.65000709]
curr_Stock_Price:  96.1453455679576
curr_Factors:  [96.14534557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03370667]
Stock Position:  -0.0337066696262209
Bond Position:  [5.89074649]


portfolio before change:  [2.62945922]
curr_Stock_Price:  96.76587708787214
curr_Factors:  [96.76587709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07857738]
Stock Position:  -0.0785773835678896
Bond Position:  [10.23306866]


portfolio before change:  [2.5281804]
curr_Stock_Price:  98.06292211091969
curr_Factors:  [98.06292211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209323]
Stock Position:  -0.03209322776544242
Bond Position:  [5.6753361]


portfolio before change:  [2.53113158]
curr_Stock_Price:  97.98201859220578
curr_Factors:  [97.98201859]
mat_Sqrt:  [[0.15]]
grads:  [0.1259186]
Stock Position:  0.12591859699259395
Bond Position:  [-9.80662673]


portfolio before change:  [2.48924903]
curr_Stock_Price:  97.6542702061133
curr_Factors:  [97.65427021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06895616]
Stock Position:  -0.06895615596113
Bond Position:  [9.22311211]


portfolio before change:  [2.45306161]
curr_Stock_Price:  98.18741877450229
curr_Factors:  [98.18741877]
mat_Sqrt:  [[0.15]]
grads:  [0.04431133]
Stock Position:  0.044311330753975496
Bond Position:  [-1.89775358]


portfolio before change:  [2.43509445]
curr_Stock_Price:  97.78462005543614
curr_Factors:  [97.78462006]
mat_Sqrt:  [[0.15]]
grads:  [-0.03034446]
Stock Position:  -0.030344463467346986
Bond Position:  [5.40231628]


portfolio before change:  [2.42133941]
curr_Stock_Price:  98.2490440667796
curr_Factors:  [98.24904407]
mat_Sqrt:  [[0.15]]
grads:  [0.07411625]
Stock Position:  0.0741162523537068
Bond Position:  [-4.86051153]


portfolio before change:  [2.35737026]
curr_Stock_Price:  97.39005084631003
curr_Factors:  [97.39005085]
mat_Sqrt:  [[0.15]]
grads:  [-0.00467685]
Stock Position:  -0.0046768508514993265
Bond Position:  [2.812849]


portfolio before change:  [2.35614394]
curr_Stock_Price:  97.68985224396161
curr_Factors:  [97.68985224]
mat_Sqrt:  [[0.15]]
grads:  [0.03986644]
Stock Position:  0.03986643649134881
Bond Position:  [-1.53840235]


portfolio before change:  [2.39343978]
curr_Stock_Price:  98.62778376297915
curr_Factors:  [98.62778376]
mat_Sqrt:  [[0.15]]
grads:  [-0.1179153]
Stock Position:  -0.11791530248109505
Bond Position:  [14.02316473]


portfolio before change:  [2.38586965]
curr_Stock_Price:  98.69941658481666
curr_Factors:  [98.69941658]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037413]
Stock Position:  -0.040374129157907016
Bond Position:  [6.37077264]


portfolio before change:  [2.40199205]
curr_Stock_Price:  98.30995395678057
curr_Factors:  [98.30995396]
mat_Sqrt:  [[0.15]]
grads:  [0.00177548]
Stock Position:  0.0017754766208682993
Bond Position:  [2.22744502]


portfolio before change:  [2.4022858]
curr_Stock_Price:  98.396992002981
curr_Factors:  [98.396992]
mat_Sqrt:  [[0.15]]
grads:  [0.01076819]
Stock Position:  0.010768191548893549
Bond Position:  [1.34272814]


portfolio before change:  [2.39553374]
curr_Stock_Price:  97.76216085899769
curr_Factors:  [97.76216086]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.39553374]
Stock Price:  97.46142325405086
PL:  [2.39553374]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.12745910e-03]
 [ 9.48154469e-04]
 [ 5.21401229e-04]
 [ 7.97029198e-03]
 [-5.46477417e-04]
 [ 1.97342883e-02]
 [ 1.48239215e-03]
 [-1.94385032e-02]
 [ 9.23022342e-03]
 [ 2.04339172e-02]
 [-3.60914422e-03]
 [ 1.92555570e-02]
 [-1.32724732e-02]
 [ 5.34389417e-03]
 [-6.91426837e-03]
 [ 1.03551732e-02]
 [ 7.30222412e-03]
 [-1.07673496e-02]
 [ 9.41688175e-04]
 [ 1.35904969e-02]
 [ 1.16616591e-02]
 [-8.88988608e-03]
 [ 4.92389992e-03]
 [-1.04999445e-02]
 [-1.14949748e-02]
 [-3.15043328e-03]
 [-3.78646415e-04]
 [ 1.06713990e-02]
 [-5.47764097e-02]
 [ 4.13334710e-03]
 [ 1.06554286e-02]
 [-1.00481315e-02]
 [-8.56006759e-03]
 [ 5.67154846e-03]
 [ 1.37863331e-02]
 [ 1.09473687e-02]
 [-3.34060581e-02]
 [ 8.61296876e-03]
 [-2.61449567e-02]
 [ 1.60895997e-02]
 [-7.55956326e-03]
 [ 8.42307207e-03]
 [ 2.30418327e-02]
 [ 4.28375621e-03]
 [ 4.88514132e-03]
 [ 4.33435641e-03]
 [ 4.88314377e-04]
 [-1.19446342e-02]
 [-3.57543072e-03]
 [-1.04284923e-03]
 [ 4.53921184e-02]
 [-1.05059610e-02]
 [ 2.89554658e-03]
 [ 5.08893026e-03]
 [ 4.18669511e-03]
 [ 3.64203932e-04]
 [-5.45289467e-03]
 [-4.42543063e-04]
 [ 1.54113372e-03]
 [-7.29465929e-04]
 [-6.45013749e-04]
 [ 6.59465612e-03]
 [ 1.40723754e-02]
 [-1.87783061e-02]
 [-7.00436993e-03]
 [-8.50994511e-03]
 [-4.72678400e-03]
 [ 1.58249413e-02]
 [-1.04884646e-02]
 [ 7.76617476e-03]
 [-3.36577412e-03]
 [ 1.18550397e-02]
 [ 9.65227259e-04]
 [ 1.64731099e-03]
 [ 2.21948248e-03]
 [-1.40785462e-02]
 [ 5.24150562e-03]
 [ 6.14349529e-03]
 [-2.95917671e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.82901126]
curr_Stock_Price:  99.74831517348926
curr_Factors:  [99.74831517]
mat_Sqrt:  [[0.15]]
grads:  [0.02084973]
Stock Position:  0.020849727319093486
Bond Position:  [-3.90873643]


portfolio before change:  [-1.82844249]
curr_Stock_Price:  99.78731194549856
curr_Factors:  [99.78731195]
mat_Sqrt:  [[0.15]]
grads:  [0.00632103]
Stock Position:  0.006321029792446977
Bond Position:  [-2.45920107]


portfolio before change:  [-1.82768074]
curr_Stock_Price:  99.93213999758042
curr_Factors:  [99.93214]
mat_Sqrt:  [[0.15]]
grads:  [0.00347601]
Stock Position:  0.0034760081919198507
Bond Position:  [-2.17504567]


portfolio before change:  [-1.82773426]
curr_Stock_Price:  99.95585045919795
curr_Factors:  [99.95585046]
mat_Sqrt:  [[0.15]]
grads:  [0.05313528]
Stock Position:  0.05313527987980874
Bond Position:  [-7.13891635]


portfolio before change:  [-1.88627283]
curr_Stock_Price:  98.86255847877734
curr_Factors:  [98.86255848]
mat_Sqrt:  [[0.15]]
grads:  [-0.00364318]
Stock Position:  -0.00364318278136681
Bond Position:  [-1.52609846]


portfolio before change:  [-1.88791536]
curr_Stock_Price:  99.28722697516619
curr_Factors:  [99.28722698]
mat_Sqrt:  [[0.15]]
grads:  [0.13156192]
Stock Position:  0.1315619221924783
Bond Position:  [-14.95033379]


portfolio before change:  [-1.92614069]
curr_Stock_Price:  99.00377946939153
curr_Factors:  [99.00377947]
mat_Sqrt:  [[0.15]]
grads:  [0.00988261]
Stock Position:  0.009882614303750011
Bond Position:  [-2.90455685]


portfolio before change:  [-1.92797365]
curr_Stock_Price:  98.83667555411918
curr_Factors:  [98.83667555]
mat_Sqrt:  [[0.15]]
grads:  [-0.12959002]
Stock Position:  -0.12959002109924417
Bond Position:  [10.88027322]


portfolio before change:  [-1.98743252]
curr_Stock_Price:  99.30074605895807
curr_Factors:  [99.30074606]
mat_Sqrt:  [[0.15]]
grads:  [0.06153482]
Stock Position:  0.06153482278890605
Bond Position:  [-8.09788633]


portfolio before change:  [-2.01227831]
curr_Stock_Price:  98.90520322704141
curr_Factors:  [98.90520323]
mat_Sqrt:  [[0.15]]
grads:  [0.13622611]
Stock Position:  0.13622611468840234
Bond Position:  [-15.48574987]


portfolio before change:  [-2.06576856]
curr_Stock_Price:  98.5196504245579
curr_Factors:  [98.51965042]
mat_Sqrt:  [[0.15]]
grads:  [-0.02406096]
Stock Position:  -0.024060961469367627
Bond Position:  [0.30470895]


portfolio before change:  [-2.0771277]
curr_Stock_Price:  98.99254019778313
curr_Factors:  [98.9925402]
mat_Sqrt:  [[0.15]]
grads:  [0.12837038]
Stock Position:  0.12837037973999868
Bond Position:  [-14.78483768]


portfolio before change:  [-2.05737506]
curr_Stock_Price:  99.1536109804398
curr_Factors:  [99.15361098]
mat_Sqrt:  [[0.15]]
grads:  [-0.08848315]
Stock Position:  -0.08848315465719746
Bond Position:  [6.71604923]


portfolio before change:  [-2.13630912]
curr_Stock_Price:  100.05043505226024
curr_Factors:  [100.05043505]
mat_Sqrt:  [[0.15]]
grads:  [0.03562596]
Stock Position:  0.035625961164239675
Bond Position:  [-5.70070203]


portfolio before change:  [-2.13345476]
curr_Stock_Price:  100.1405564811481
curr_Factors:  [100.14055648]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609512]
Stock Position:  -0.046095122493971685
Bond Position:  [2.48253646]


portfolio before change:  [-2.10900932]
curr_Stock_Price:  99.61359661122891
curr_Factors:  [99.61359661]
mat_Sqrt:  [[0.15]]
grads:  [0.06903449]
Stock Position:  0.0690344880382514
Bond Position:  [-8.98578296]


portfolio before change:  [-2.16563564]
curr_Stock_Price:  98.80147080908588
curr_Factors:  [98.80147081]
mat_Sqrt:  [[0.15]]
grads:  [0.04868149]
Stock Position:  0.04868149413817102
Bond Position:  [-6.97543886]


portfolio before change:  [-2.15033319]
curr_Stock_Price:  99.12476462515684
curr_Factors:  [99.12476463]
mat_Sqrt:  [[0.15]]
grads:  [-0.07178233]
Stock Position:  -0.07178233047080276
Bond Position:  [4.96507342]


portfolio before change:  [-2.10848662]
curr_Stock_Price:  98.54612305340183
curr_Factors:  [98.54612305]
mat_Sqrt:  [[0.15]]
grads:  [0.00627792]
Stock Position:  0.006277921165024093
Bond Position:  [-2.72715141]


portfolio before change:  [-2.10017719]
curr_Stock_Price:  99.89686977173102
curr_Factors:  [99.89686977]
mat_Sqrt:  [[0.15]]
grads:  [0.09060331]
Stock Position:  0.09060331247398352
Bond Position:  [-11.1511645]


portfolio before change:  [-2.17570959]
curr_Stock_Price:  99.07090189892392
curr_Factors:  [99.0709019]
mat_Sqrt:  [[0.15]]
grads:  [0.07774439]
Stock Position:  0.07774439418106059
Bond Position:  [-9.87791684]


portfolio before change:  [-2.21167425]
curr_Stock_Price:  98.61624176211558
curr_Factors:  [98.61624176]
mat_Sqrt:  [[0.15]]
grads:  [-0.05926591]
Stock Position:  -0.05926590722037606
Bond Position:  [3.63290678]


portfolio before change:  [-2.14541621]
curr_Stock_Price:  97.50209389641286
curr_Factors:  [97.5020939]
mat_Sqrt:  [[0.15]]
grads:  [0.032826]
Stock Position:  0.03282599945497139
Bond Position:  [-5.34601989]


portfolio before change:  [-2.14387095]
curr_Stock_Price:  97.55934710708298
curr_Factors:  [97.55934711]
mat_Sqrt:  [[0.15]]
grads:  [-0.06999963]
Stock Position:  -0.06999962977098753
Bond Position:  [4.68524723]


portfolio before change:  [-2.0780405]
curr_Stock_Price:  96.62309059886869
curr_Factors:  [96.6230906]
mat_Sqrt:  [[0.15]]
grads:  [-0.07663317]
Stock Position:  -0.07663316534269038
Bond Position:  [5.32649278]


portfolio before change:  [-2.07016592]
curr_Stock_Price:  96.5246780630432
curr_Factors:  [96.52467806]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100289]
Stock Position:  -0.021002888532271776
Bond Position:  [-0.04286887]


portfolio before change:  [-2.07293336]
curr_Stock_Price:  96.65631521274095
curr_Factors:  [96.65631521]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252431]
Stock Position:  -0.002524309432363151
Bond Position:  [-1.82894291]


portfolio before change:  [-2.07264529]
curr_Stock_Price:  96.49691062422009
curr_Factors:  [96.49691062]
mat_Sqrt:  [[0.15]]
grads:  [0.07114266]
Stock Position:  0.07114265993088033
Bond Position:  [-8.93769219]


portfolio before change:  [-2.11822143]
curr_Stock_Price:  95.8641325566465
curr_Factors:  [95.86413256]
mat_Sqrt:  [[0.15]]
grads:  [-0.36517606]
Stock Position:  -0.36517606490866256
Bond Position:  [32.88906527]


portfolio before change:  [-2.35120648]
curr_Stock_Price:  96.50776917098106
curr_Factors:  [96.50776917]
mat_Sqrt:  [[0.15]]
grads:  [0.02755565]
Stock Position:  0.027555647357608116
Bond Position:  [-5.01054054]


portfolio before change:  [-2.36672826]
curr_Stock_Price:  95.9558454879938
curr_Factors:  [95.95584549]
mat_Sqrt:  [[0.15]]
grads:  [0.07103619]
Stock Position:  0.071036190714674
Bond Position:  [-9.183066]


portfolio before change:  [-2.27848947]
curr_Stock_Price:  97.20609212938155
curr_Factors:  [97.20609213]
mat_Sqrt:  [[0.15]]
grads:  [-0.06698754]
Stock Position:  -0.06698754353392795
Bond Position:  [4.23310786]


portfolio before change:  [-2.28026011]
curr_Stock_Price:  97.23647428671649
curr_Factors:  [97.23647429]
mat_Sqrt:  [[0.15]]
grads:  [-0.05706712]
Stock Position:  -0.05706711724197788
Bond Position:  [3.26874516]


portfolio before change:  [-2.25563133]
curr_Stock_Price:  96.80847866574469
curr_Factors:  [96.80847867]
mat_Sqrt:  [[0.15]]
grads:  [0.03781032]
Stock Position:  0.03781032304342252
Bond Position:  [-5.91599119]


portfolio before change:  [-2.24624036]
curr_Stock_Price:  97.06662855122389
curr_Factors:  [97.06662855]
mat_Sqrt:  [[0.15]]
grads:  [0.09190889]
Stock Position:  0.09190888730343506
Bond Position:  [-11.16752619]


portfolio before change:  [-2.27750755]
curr_Stock_Price:  96.73402534824757
curr_Factors:  [96.73402535]
mat_Sqrt:  [[0.15]]
grads:  [0.07298246]
Stock Position:  0.07298245782274121
Bond Position:  [-9.33739447]


portfolio before change:  [-2.29326427]
curr_Stock_Price:  96.52612445251468
curr_Factors:  [96.52612445]
mat_Sqrt:  [[0.15]]
grads:  [-0.22270705]
Stock Position:  -0.22270705402658691
Bond Position:  [19.20378454]


portfolio before change:  [-2.47780277]
curr_Stock_Price:  97.36012934937781
curr_Factors:  [97.36012935]
mat_Sqrt:  [[0.15]]
grads:  [0.05741979]
Stock Position:  0.05741979174602568
Bond Position:  [-8.06820112]


portfolio before change:  [-2.47722893]
curr_Stock_Price:  97.3789054531058
curr_Factors:  [97.37890545]
mat_Sqrt:  [[0.15]]
grads:  [-0.17429971]
Stock Position:  -0.17429971103464648
Bond Position:  [14.49588615]


portfolio before change:  [-2.44659765]
curr_Stock_Price:  97.20836440441123
curr_Factors:  [97.2083644]
mat_Sqrt:  [[0.15]]
grads:  [0.107264]
Stock Position:  0.1072639978028712
Bond Position:  [-12.87355544]


portfolio before change:  [-2.37354846]
curr_Stock_Price:  97.89688820997813
curr_Factors:  [97.89688821]
mat_Sqrt:  [[0.15]]
grads:  [-0.05039709]
Stock Position:  -0.05039708837120509
Bond Position:  [2.56016967]


portfolio before change:  [-2.39531473]
curr_Stock_Price:  98.3319586598328
curr_Factors:  [98.33195866]
mat_Sqrt:  [[0.15]]
grads:  [0.05615381]
Stock Position:  0.05615381378682166
Bond Position:  [-7.91702922]


portfolio before change:  [-2.39580814]
curr_Stock_Price:  98.33198391799473
curr_Factors:  [98.33198392]
mat_Sqrt:  [[0.15]]
grads:  [0.15361222]
Stock Position:  0.15361221810857142
Bond Position:  [-17.5008023]


portfolio before change:  [-2.51235588]
curr_Stock_Price:  97.58039064511563
curr_Factors:  [97.58039065]
mat_Sqrt:  [[0.15]]
grads:  [0.02855837]
Stock Position:  0.028558374716157506
Bond Position:  [-5.29909324]


portfolio before change:  [-2.54557118]
curr_Stock_Price:  96.42892129715808
curr_Factors:  [96.4289213]
mat_Sqrt:  [[0.15]]
grads:  [0.03256761]
Stock Position:  0.032567608779828054
Bond Position:  [-5.68603056]


portfolio before change:  [-2.5291509]
curr_Stock_Price:  96.94402402728657
curr_Factors:  [96.94402403]
mat_Sqrt:  [[0.15]]
grads:  [0.02889571]
Stock Position:  0.028895709375512
Bond Position:  [-5.33041725]


portfolio before change:  [-2.54000456]
curr_Stock_Price:  96.57993893615816
curr_Factors:  [96.57993894]
mat_Sqrt:  [[0.15]]
grads:  [0.00325543]
Stock Position:  0.0032554291778258415
Bond Position:  [-2.85441371]


portfolio before change:  [-2.53890505]
curr_Stock_Price:  96.97248978924856
curr_Factors:  [96.97248979]
mat_Sqrt:  [[0.15]]
grads:  [-0.07963089]
Stock Position:  -0.0796308946465899
Bond Position:  [5.18310107]


portfolio before change:  [-2.56588732]
curr_Stock_Price:  97.31539978406627
curr_Factors:  [97.31539978]
mat_Sqrt:  [[0.15]]
grads:  [-0.0238362]
Stock Position:  -0.023836204820550374
Bond Position:  [-0.24625752]


portfolio before change:  [-2.56854566]
curr_Stock_Price:  97.42627917143359
curr_Factors:  [97.42627917]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695233]
Stock Position:  -0.006952328187494738
Bond Position:  [-1.89120619]


portfolio before change:  [-2.57295459]
curr_Stock_Price:  98.04344347929349
curr_Factors:  [98.04344348]
mat_Sqrt:  [[0.15]]
grads:  [0.30261412]
Stock Position:  0.3026141226998808
Bond Position:  [-32.24228523]


portfolio before change:  [-2.48111852]
curr_Stock_Price:  98.35357862102221
curr_Factors:  [98.35357862]
mat_Sqrt:  [[0.15]]
grads:  [-0.07003974]
Stock Position:  -0.07003974015453596
Bond Position:  [4.40754057]


portfolio before change:  [-2.44378152]
curr_Stock_Price:  97.82442870941173
curr_Factors:  [97.82442871]
mat_Sqrt:  [[0.15]]
grads:  [0.01930364]
Stock Position:  0.01930364384816788
Bond Position:  [-4.33214945]


portfolio before change:  [-2.45190039]
curr_Stock_Price:  97.41786793529774
curr_Factors:  [97.41786794]
mat_Sqrt:  [[0.15]]
grads:  [0.0339262]
Stock Position:  0.03392620170970783
Bond Position:  [-5.75691863]


portfolio before change:  [-2.47784251]
curr_Stock_Price:  96.66381067896901
curr_Factors:  [96.66381068]
mat_Sqrt:  [[0.15]]
grads:  [0.0279113]
Stock Position:  0.027911300733715477
Bond Position:  [-5.1758552]


portfolio before change:  [-2.47545781]
curr_Stock_Price:  96.76083959503525
curr_Factors:  [96.7608396]
mat_Sqrt:  [[0.15]]
grads:  [0.00242803]
Stock Position:  0.0024280262143428397
Bond Position:  [-2.71039566]


portfolio before change:  [-2.47707672]
curr_Stock_Price:  96.16385126605276
curr_Factors:  [96.16385127]
mat_Sqrt:  [[0.15]]
grads:  [-0.03635263]
Stock Position:  -0.03635263115358246
Bond Position:  [1.0187323]


portfolio before change:  [-2.48415565]
curr_Stock_Price:  96.36033239278366
curr_Factors:  [96.36033239]
mat_Sqrt:  [[0.15]]
grads:  [-0.00295029]
Stock Position:  -0.002950287087510642
Bond Position:  [-2.199865]


portfolio before change:  [-2.48615273]
curr_Stock_Price:  96.99063953282048
curr_Factors:  [96.99063953]
mat_Sqrt:  [[0.15]]
grads:  [0.01027422]
Stock Position:  0.010274224787128102
Bond Position:  [-3.48265636]


portfolio before change:  [-2.47717152]
curr_Stock_Price:  97.88597558059259
curr_Factors:  [97.88597558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00486311]
Stock Position:  -0.0048631061922790875
Bond Position:  [-2.00114163]


portfolio before change:  [-2.47731298]
curr_Stock_Price:  97.8893443651477
curr_Factors:  [97.88934437]
mat_Sqrt:  [[0.15]]
grads:  [-0.00430009]
Stock Position:  -0.004300091660225265
Bond Position:  [-2.05637983]


portfolio before change:  [-2.47414137]
curr_Stock_Price:  97.12188735106422
curr_Factors:  [97.12188735]
mat_Sqrt:  [[0.15]]
grads:  [0.04396437]
Stock Position:  0.043964374143614884
Bond Position:  [-6.74404436]


portfolio before change:  [-2.4873009]
curr_Stock_Price:  96.83215247915182
curr_Factors:  [96.83215248]
mat_Sqrt:  [[0.15]]
grads:  [0.09381584]
Stock Position:  0.09381583601108362
Bond Position:  [-11.57169024]


portfolio before change:  [-2.53176052]
curr_Stock_Price:  96.36595864403573
curr_Factors:  [96.36595864]
mat_Sqrt:  [[0.15]]
grads:  [-0.12518871]
Stock Position:  -0.12518870733420054
Bond Position:  [9.53216928]


portfolio before change:  [-2.59159984]
curr_Stock_Price:  96.8487106339302
curr_Factors:  [96.84871063]
mat_Sqrt:  [[0.15]]
grads:  [-0.0466958]
Stock Position:  -0.04669579951071444
Bond Position:  [1.93082814]


portfolio before change:  [-2.61670704]
curr_Stock_Price:  97.38897084662136
curr_Factors:  [97.38897085]
mat_Sqrt:  [[0.15]]
grads:  [-0.05673297]
Stock Position:  -0.056732967413227225
Bond Position:  [2.90845827]


portfolio before change:  [-2.59508436]
curr_Stock_Price:  97.01104430082347
curr_Factors:  [97.0110443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03151189]
Stock Position:  -0.031511893316470745
Bond Position:  [0.46191732]


portfolio before change:  [-2.60090267]
curr_Stock_Price:  97.1965989547901
curr_Factors:  [97.19659895]
mat_Sqrt:  [[0.15]]
grads:  [0.10549961]
Stock Position:  0.10549960848526219
Bond Position:  [-12.8551058]


portfolio before change:  [-2.5697833]
curr_Stock_Price:  97.49918617320476
curr_Factors:  [97.49918617]
mat_Sqrt:  [[0.15]]
grads:  [-0.0699231]
Stock Position:  -0.06992309765075483
Bond Position:  [4.24766181]


portfolio before change:  [-2.5756061]
curr_Stock_Price:  97.58625737989381
curr_Factors:  [97.58625738]
mat_Sqrt:  [[0.15]]
grads:  [0.0517745]
Stock Position:  0.05177449839559533
Bond Position:  [-7.62808563]


portfolio before change:  [-2.58175131]
curr_Stock_Price:  97.47677428755627
curr_Factors:  [97.47677429]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243849]
Stock Position:  -0.022438494134995244
Bond Position:  [-0.39451928]


portfolio before change:  [-2.55637633]
curr_Stock_Price:  96.34480711781323
curr_Factors:  [96.34480712]
mat_Sqrt:  [[0.15]]
grads:  [0.0790336]
Stock Position:  0.07903359794322715
Bond Position:  [-10.17085308]


portfolio before change:  [-2.53017609]
curr_Stock_Price:  96.68435806720647
curr_Factors:  [96.68435807]
mat_Sqrt:  [[0.15]]
grads:  [0.00643485]
Stock Position:  0.006434848393860653
Bond Position:  [-3.15232528]


portfolio before change:  [-2.53250554]
curr_Stock_Price:  96.35297157160674
curr_Factors:  [96.35297157]
mat_Sqrt:  [[0.15]]
grads:  [0.01098207]
Stock Position:  0.010982073271166813
Bond Position:  [-3.59066093]


portfolio before change:  [-2.54109866]
curr_Stock_Price:  95.59093884811136
curr_Factors:  [95.59093885]
mat_Sqrt:  [[0.15]]
grads:  [0.01479655]
Stock Position:  0.014796549835472059
Bond Position:  [-3.95551475]


portfolio before change:  [-2.53419672]
curr_Stock_Price:  96.0741034505257
curr_Factors:  [96.07410345]
mat_Sqrt:  [[0.15]]
grads:  [-0.09385697]
Stock Position:  -0.09385697433526836
Bond Position:  [6.48302794]


portfolio before change:  [-2.51039058]
curr_Stock_Price:  95.82477795112638
curr_Factors:  [95.82477795]
mat_Sqrt:  [[0.15]]
grads:  [0.03494337]
Stock Position:  0.03494337080772741
Bond Position:  [-5.85883133]


portfolio before change:  [-2.51960882]
curr_Stock_Price:  95.57145248512045
curr_Factors:  [95.57145249]
mat_Sqrt:  [[0.15]]
grads:  [0.04095664]
Stock Position:  0.04095663529331979
Bond Position:  [-6.43389394]


portfolio before change:  [-2.51719072]
curr_Stock_Price:  95.64031128461782
curr_Factors:  [95.64031128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.51719072]
Stock Price:  95.90577282365203
PL:  [-2.51719072]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-1.34683472e-04]
 [ 2.65066256e-03]
 [-3.03798984e-03]
 [ 7.55213314e-03]
 [ 3.72115571e-03]
 [ 2.28827343e-02]
 [ 9.13325896e-04]
 [-1.67408880e-02]
 [ 1.51053480e-02]
 [ 1.89837918e-02]
 [ 1.41184882e-02]
 [-1.81870694e-02]
 [ 1.55566084e-02]
 [ 5.53654077e-03]
 [-6.91347218e-03]
 [ 1.29825471e-02]
 [ 1.05515672e-02]
 [-1.21763270e-02]
 [-6.15688986e-04]
 [ 2.40046738e-03]
 [ 1.15640056e-02]
 [-3.60625687e-03]
 [ 1.10936240e-02]
 [-2.85084015e-02]
 [ 7.98458197e-03]
 [ 6.62247395e-03]
 [-4.82062196e-03]
 [ 1.13280318e-02]
 [ 4.55644002e-02]
 [ 3.82219695e-03]
 [ 1.97631102e-02]
 [-4.11070352e-03]
 [ 4.12189147e-03]
 [ 8.42362812e-03]
 [ 1.11357053e-02]
 [ 8.30197199e-03]
 [-3.34556559e-02]
 [ 9.33128703e-03]
 [ 7.60440437e-03]
 [ 1.93498990e-02]
 [-4.96670268e-03]
 [-2.04376036e-02]
 [ 2.08078542e-02]
 [-1.87083106e-03]
 [ 9.72169345e-04]
 [-1.64862695e-02]
 [ 1.46206821e-02]
 [ 6.83493513e-03]
 [-3.28500573e-03]
 [-7.67751193e-03]
 [ 3.16899725e-02]
 [-8.49516530e-03]
 [-2.67263953e-03]
 [ 5.32059550e-03]
 [ 5.73008359e-03]
 [-3.42251311e-03]
 [ 4.73237157e-03]
 [-3.17390516e-04]
 [ 1.55524868e-03]
 [-7.21143197e-03]
 [ 9.00849938e-04]
 [-1.16925371e-02]
 [-7.65380465e-03]
 [-1.41156764e-02]
 [-6.27073317e-03]
 [ 1.35640080e-03]
 [-5.42209852e-03]
 [ 2.44189723e-02]
 [-8.17396823e-03]
 [ 6.14921386e-03]
 [-7.87555242e-03]
 [ 1.08763509e-02]
 [-2.67253512e-03]
 [ 6.04789255e-03]
 [-1.31823981e-02]
 [-1.08090626e-02]
 [ 4.56411432e-03]
 [ 5.05655883e-03]
 [-6.32822306e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.37163651]
curr_Stock_Price:  100.4116118756462
curr_Factors:  [100.41161188]
mat_Sqrt:  [[0.15]]
grads:  [-0.00089789]
Stock Position:  -0.000897889814487739
Bond Position:  [8.46179508]


portfolio before change:  [8.37250396]
curr_Stock_Price:  100.03454400925796
curr_Factors:  [100.03454401]
mat_Sqrt:  [[0.15]]
grads:  [0.01767108]
Stock Position:  0.01767108373399053
Bond Position:  [6.60478515]


portfolio before change:  [8.38381489]
curr_Stock_Price:  100.65126465826609
curr_Factors:  [100.65126466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025327]
Stock Position:  -0.020253265606445695
Bond Position:  [10.42233169]


portfolio before change:  [8.39688272]
curr_Stock_Price:  100.03820729375975
curr_Factors:  [100.03820729]
mat_Sqrt:  [[0.15]]
grads:  [0.05034755]
Stock Position:  0.05034755429238938
Bond Position:  [3.36020365]


portfolio before change:  [8.41734324]
curr_Stock_Price:  100.44042146199462
curr_Factors:  [100.44042146]
mat_Sqrt:  [[0.15]]
grads:  [0.0248077]
Stock Position:  0.024807704765262544
Bond Position:  [5.92564692]


portfolio before change:  [8.40154284]
curr_Stock_Price:  99.78857700426417
curr_Factors:  [99.788577]
mat_Sqrt:  [[0.15]]
grads:  [0.15255156]
Stock Position:  0.15255156190969188
Bond Position:  [-6.82136044]


portfolio before change:  [8.33993054]
curr_Stock_Price:  99.38749330403853
curr_Factors:  [99.3874933]
mat_Sqrt:  [[0.15]]
grads:  [0.00608884]
Stock Position:  0.006088839306541368
Bond Position:  [7.73477607]


portfolio before change:  [8.34461853]
curr_Stock_Price:  100.07802697373687
curr_Factors:  [100.07802697]
mat_Sqrt:  [[0.15]]
grads:  [-0.11160592]
Stock Position:  -0.11160592031857051
Bond Position:  [19.51391884]


portfolio before change:  [8.38174519]
curr_Stock_Price:  99.75629673488811
curr_Factors:  [99.75629673]
mat_Sqrt:  [[0.15]]
grads:  [0.10070232]
Stock Position:  0.10070232021248123
Bond Position:  [-1.66394535]


portfolio before change:  [8.32225578]
curr_Stock_Price:  99.16658428634918
curr_Factors:  [99.16658429]
mat_Sqrt:  [[0.15]]
grads:  [0.12655861]
Stock Position:  0.12655861192579088
Bond Position:  [-4.22812948]


portfolio before change:  [8.3642788]
curr_Stock_Price:  99.50071635726648
curr_Factors:  [99.50071636]
mat_Sqrt:  [[0.15]]
grads:  [0.09412325]
Stock Position:  0.09412325449138118
Bond Position:  [-1.00105245]


portfolio before change:  [8.46016651]
curr_Stock_Price:  100.5201273306317
curr_Factors:  [100.52012733]
mat_Sqrt:  [[0.15]]
grads:  [-0.12124713]
Stock Position:  -0.12124712919987261
Bond Position:  [20.64794338]


portfolio before change:  [8.43885388]
curr_Stock_Price:  100.70654960346182
curr_Factors:  [100.7065496]
mat_Sqrt:  [[0.15]]
grads:  [0.10371072]
Stock Position:  0.10371072273125499
Bond Position:  [-2.00549516]


portfolio before change:  [8.36974032]
curr_Stock_Price:  100.04135112790357
curr_Factors:  [100.04135113]
mat_Sqrt:  [[0.15]]
grads:  [0.03691027]
Stock Position:  0.03691027182882901
Bond Position:  [4.67718686]


portfolio before change:  [8.35757878]
curr_Stock_Price:  99.70394161038267
curr_Factors:  [99.70394161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608981]
Stock Position:  -0.0460898145280371
Bond Position:  [12.95291496]


portfolio before change:  [8.33591782]
curr_Stock_Price:  100.19147982205475
curr_Factors:  [100.19147982]
mat_Sqrt:  [[0.15]]
grads:  [0.08655031]
Stock Position:  0.08655031426519622
Bond Position:  [-0.33568625]


portfolio before change:  [8.41248423]
curr_Stock_Price:  101.07636849005496
curr_Factors:  [101.07636849]
mat_Sqrt:  [[0.15]]
grads:  [0.07034378]
Stock Position:  0.07034378129811987
Bond Position:  [1.30239027]


portfolio before change:  [8.36179189]
curr_Stock_Price:  100.35457427339364
curr_Factors:  [100.35457427]
mat_Sqrt:  [[0.15]]
grads:  [-0.08117551]
Stock Position:  -0.08117551359764819
Bond Position:  [16.508126]


portfolio before change:  [8.31600763]
curr_Stock_Price:  100.93130055267747
curr_Factors:  [100.93130055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00410459]
Stock Position:  -0.004104593242009065
Bond Position:  [8.73028957]


portfolio before change:  [8.31694232]
curr_Stock_Price:  100.83652100879047
curr_Factors:  [100.83652101]
mat_Sqrt:  [[0.15]]
grads:  [0.01600312]
Stock Position:  0.016003115879996775
Bond Position:  [6.70324379]


portfolio before change:  [8.30727341]
curr_Stock_Price:  100.20615126976097
curr_Factors:  [100.20615127]
mat_Sqrt:  [[0.15]]
grads:  [0.07709337]
Stock Position:  0.07709337055084738
Bond Position:  [0.58204346]


portfolio before change:  [8.42078287]
curr_Stock_Price:  101.67804277625869
curr_Factors:  [101.67804278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02404171]
Stock Position:  -0.02404171249848858
Bond Position:  [10.86529714]


portfolio before change:  [8.39528549]
curr_Stock_Price:  102.76683712409596
curr_Factors:  [102.76683712]
mat_Sqrt:  [[0.15]]
grads:  [0.07395749]
Stock Position:  0.07395749309639743
Bond Position:  [0.79490784]


portfolio before change:  [8.4205126]
curr_Stock_Price:  103.10726824528145
curr_Factors:  [103.10726825]
mat_Sqrt:  [[0.15]]
grads:  [-0.19005601]
Stock Position:  -0.19005600986826643
Bond Position:  [28.01666859]


portfolio before change:  [8.29256338]
curr_Stock_Price:  103.78970033347939
curr_Factors:  [103.78970033]
mat_Sqrt:  [[0.15]]
grads:  [0.05323055]
Stock Position:  0.05323054646388291
Bond Position:  [2.76778091]


portfolio before change:  [8.30451746]
curr_Stock_Price:  104.01102231031331
curr_Factors:  [104.01102231]
mat_Sqrt:  [[0.15]]
grads:  [0.04414983]
Stock Position:  0.044149826339241104
Bond Position:  [3.71244889]


portfolio before change:  [8.29151134]
curr_Stock_Price:  103.71117610803705
curr_Factors:  [103.71117611]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213748]
Stock Position:  -0.03213747973221443
Bond Position:  [11.62452716]


portfolio before change:  [8.32473809]
curr_Stock_Price:  102.69988969456662
curr_Factors:  [102.69988969]
mat_Sqrt:  [[0.15]]
grads:  [0.07552021]
Stock Position:  0.07552021194099948
Bond Position:  [0.56882066]


portfolio before change:  [8.36757061]
curr_Stock_Price:  103.26658525263926
curr_Factors:  [103.26658525]
mat_Sqrt:  [[0.15]]
grads:  [0.30376267]
Stock Position:  0.30376266805116836
Bond Position:  [-23.00096284]


portfolio before change:  [8.40958111]
curr_Stock_Price:  103.40961829179751
curr_Factors:  [103.40961829]
mat_Sqrt:  [[0.15]]
grads:  [0.02548131]
Stock Position:  0.02548131301038754
Bond Position:  [5.77456825]


portfolio before change:  [8.43370283]
curr_Stock_Price:  104.34209796276075
curr_Factors:  [104.34209796]
mat_Sqrt:  [[0.15]]
grads:  [0.13175407]
Stock Position:  0.1317540678477476
Bond Position:  [-5.31379302]


portfolio before change:  [8.30726984]
curr_Stock_Price:  103.38500511943086
curr_Factors:  [103.38500512]
mat_Sqrt:  [[0.15]]
grads:  [-0.02740469]
Stock Position:  -0.02740469010680495
Bond Position:  [11.14050386]


portfolio before change:  [8.32918989]
curr_Stock_Price:  102.61054834840066
curr_Factors:  [102.61054835]
mat_Sqrt:  [[0.15]]
grads:  [0.02747928]
Stock Position:  0.02747927643889255
Bond Position:  [5.50952626]


portfolio before change:  [8.31778329]
curr_Stock_Price:  102.18291884121109
curr_Factors:  [102.18291884]
mat_Sqrt:  [[0.15]]
grads:  [0.05615752]
Stock Position:  0.05615752078490378
Bond Position:  [2.5794439]


portfolio before change:  [8.28846327]
curr_Stock_Price:  101.65794471261435
curr_Factors:  [101.65794471]
mat_Sqrt:  [[0.15]]
grads:  [0.07423804]
Stock Position:  0.07423803513239123
Bond Position:  [0.7415772]


portfolio before change:  [8.36760026]
curr_Stock_Price:  102.72331028058576
curr_Factors:  [102.72331028]
mat_Sqrt:  [[0.15]]
grads:  [0.05534648]
Stock Position:  0.05534647996379399
Bond Position:  [2.68222663]


portfolio before change:  [8.34030412]
curr_Stock_Price:  102.22709462375097
curr_Factors:  [102.22709462]
mat_Sqrt:  [[0.15]]
grads:  [-0.22303771]
Stock Position:  -0.22303770581431723
Bond Position:  [31.14080078]


portfolio before change:  [8.29847884]
curr_Stock_Price:  102.4233468063574
curr_Factors:  [102.42334681]
mat_Sqrt:  [[0.15]]
grads:  [0.06220858]
Stock Position:  0.06220858020676022
Bond Position:  [1.92686786]


portfolio before change:  [8.31614365]
curr_Stock_Price:  102.70537185017676
curr_Factors:  [102.70537185]
mat_Sqrt:  [[0.15]]
grads:  [0.05069603]
Stock Position:  0.050696029161203804
Bond Position:  [3.10938913]


portfolio before change:  [8.29869251]
curr_Stock_Price:  102.3573073808023
curr_Factors:  [102.35730738]
mat_Sqrt:  [[0.15]]
grads:  [0.12899933]
Stock Position:  0.1289993267528687
Bond Position:  [-4.90533123]


portfolio before change:  [8.26667382]
curr_Stock_Price:  102.1114759009286
curr_Factors:  [102.1114759]
mat_Sqrt:  [[0.15]]
grads:  [-0.03311135]
Stock Position:  -0.03311135117762634
Bond Position:  [11.64772276]


portfolio before change:  [8.25139474]
curr_Stock_Price:  102.59490778628475
curr_Factors:  [102.59490779]
mat_Sqrt:  [[0.15]]
grads:  [-0.13625069]
Stock Position:  -0.13625069099594528
Bond Position:  [22.23002182]


portfolio before change:  [8.16707204]
curr_Stock_Price:  103.22398438846743
curr_Factors:  [103.22398439]
mat_Sqrt:  [[0.15]]
grads:  [0.13871903]
Stock Position:  0.13871902806611836
Bond Position:  [-6.15205874]


portfolio before change:  [8.20624932]
curr_Stock_Price:  103.50917806800905
curr_Factors:  [103.50917807]
mat_Sqrt:  [[0.15]]
grads:  [-0.01247221]
Stock Position:  -0.012472207093343861
Bond Position:  [9.49723722]


portfolio before change:  [8.2136538]
curr_Stock_Price:  102.96309292382551
curr_Factors:  [102.96309292]
mat_Sqrt:  [[0.15]]
grads:  [0.00648113]
Stock Position:  0.00648112896909921
Bond Position:  [7.54633672]


portfolio before change:  [8.21767824]
curr_Stock_Price:  103.51126612904908
curr_Factors:  [103.51126613]
mat_Sqrt:  [[0.15]]
grads:  [-0.10990846]
Stock Position:  -0.10990846317430754
Bond Position:  [19.59444242]


portfolio before change:  [8.21340841]
curr_Stock_Price:  103.56125793903486
curr_Factors:  [103.56125794]
mat_Sqrt:  [[0.15]]
grads:  [0.09747121]
Stock Position:  0.09747121389740505
Bond Position:  [-1.88083311]


portfolio before change:  [8.19683262]
curr_Stock_Price:  103.3924057049149
curr_Factors:  [103.3924057]
mat_Sqrt:  [[0.15]]
grads:  [0.04556623]
Stock Position:  0.045566234201612564
Bond Position:  [3.48563005]


portfolio before change:  [8.14757155]
curr_Stock_Price:  102.3065373941357
curr_Factors:  [102.30653739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02190004]
Stock Position:  -0.021900038202139097
Bond Position:  [10.38808863]


portfolio before change:  [8.17618898]
curr_Stock_Price:  101.02945510384261
curr_Factors:  [101.0294551]
mat_Sqrt:  [[0.15]]
grads:  [-0.05118341]
Stock Position:  -0.05118341286081077
Bond Position:  [13.34722129]


portfolio before change:  [8.19391474]
curr_Stock_Price:  100.6994353511478
curr_Factors:  [100.69943535]
mat_Sqrt:  [[0.15]]
grads:  [0.21126648]
Stock Position:  0.21126648338212511
Bond Position:  [-13.08050084]


portfolio before change:  [8.12134102]
curr_Stock_Price:  100.35978769858093
curr_Factors:  [100.3597877]
mat_Sqrt:  [[0.15]]
grads:  [-0.05663444]
Stock Position:  -0.05663443536303453
Bond Position:  [13.80516093]


portfolio before change:  [8.06397989]
curr_Stock_Price:  101.38785451501543
curr_Factors:  [101.38785452]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178176]
Stock Position:  -0.017817596844933982
Bond Position:  [9.8704678]


portfolio before change:  [8.07751188]
curr_Stock_Price:  100.6630055776302
curr_Factors:  [100.66300558]
mat_Sqrt:  [[0.15]]
grads:  [0.03547064]
Stock Position:  0.03547063666825218
Bond Position:  [4.50693098]


portfolio before change:  [8.03410516]
curr_Stock_Price:  99.43132751346647
curr_Factors:  [99.43132751]
mat_Sqrt:  [[0.15]]
grads:  [0.03820056]
Stock Position:  0.03820055728893629
Bond Position:  [4.23577304]


portfolio before change:  [8.03143158]
curr_Stock_Price:  99.35440905825087
curr_Factors:  [99.35440906]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281675]
Stock Position:  -0.022816754045630248
Bond Position:  [10.29837669]


portfolio before change:  [8.00905637]
curr_Stock_Price:  100.36326778298779
curr_Factors:  [100.36326778]
mat_Sqrt:  [[0.15]]
grads:  [0.03154914]
Stock Position:  0.03154914377886956
Bond Position:  [4.8426812]


portfolio before change:  [8.01542994]
curr_Stock_Price:  100.5556944129681
curr_Factors:  [100.55569441]
mat_Sqrt:  [[0.15]]
grads:  [-0.00211594]
Stock Position:  -0.002115936772763728
Bond Position:  [8.22819943]


portfolio before change:  [8.0165157]
curr_Stock_Price:  100.28560722373523
curr_Factors:  [100.28560722]
mat_Sqrt:  [[0.15]]
grads:  [0.01036832]
Stock Position:  0.010368324527400559
Bond Position:  [6.97672198]


portfolio before change:  [8.0131052]
curr_Stock_Price:  99.91461549655445
curr_Factors:  [99.9146155]
mat_Sqrt:  [[0.15]]
grads:  [-0.04807621]
Stock Position:  -0.04807621314885773
Bond Position:  [12.81662155]


portfolio before change:  [7.99368099]
curr_Stock_Price:  100.3353074746316
curr_Factors:  [100.33530747]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [7.39110062]


portfolio before change:  [7.99135679]
curr_Stock_Price:  99.87138629259421
curr_Factors:  [99.87138629]
mat_Sqrt:  [[0.15]]
grads:  [-0.07795025]
Stock Position:  -0.07795024755868718
Bond Position:  [15.77635608]


portfolio before change:  [7.9172486]
curr_Stock_Price:  100.83474742408178
curr_Factors:  [100.83474742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05102536]
Stock Position:  -0.05102536433052526
Bond Position:  [13.06237833]


portfolio before change:  [7.93543034]
curr_Stock_Price:  100.49442043244096
curr_Factors:  [100.49442043]
mat_Sqrt:  [[0.15]]
grads:  [-0.09410451]
Stock Position:  -0.09410450919168506
Bond Position:  [17.39240845]


portfolio before change:  [7.8925333]
curr_Stock_Price:  100.96181675382033
curr_Factors:  [100.96181675]
mat_Sqrt:  [[0.15]]
grads:  [-0.04180489]
Stock Position:  -0.04180488777494646
Bond Position:  [12.11323071]


portfolio before change:  [7.90268895]
curr_Stock_Price:  100.73699724457875
curr_Factors:  [100.73699724]
mat_Sqrt:  [[0.15]]
grads:  [0.00904267]
Stock Position:  0.009042672001959065
Bond Position:  [6.99175733]


portfolio before change:  [7.9009376]
curr_Stock_Price:  100.49499499939407
curr_Factors:  [100.494995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03614732]
Stock Position:  -0.03614732344271418
Bond Position:  [11.53356269]


portfolio before change:  [7.91492994]
curr_Stock_Price:  100.12784568643883
curr_Factors:  [100.12784569]
mat_Sqrt:  [[0.15]]
grads:  [0.16279315]
Stock Position:  0.1627931487791993
Bond Position:  [-8.38519734]


portfolio before change:  [7.99239656]
curr_Stock_Price:  100.60692431563656
curr_Factors:  [100.60692432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449312]
Stock Position:  -0.054493121513516145
Bond Position:  [13.47478192]


portfolio before change:  [8.04020478]
curr_Stock_Price:  99.74505371721962
curr_Factors:  [99.74505372]
mat_Sqrt:  [[0.15]]
grads:  [0.04099476]
Stock Position:  0.040994759088116714
Bond Position:  [3.95118034]


portfolio before change:  [8.01404601]
curr_Stock_Price:  99.10092924938547
curr_Factors:  [99.10092925]
mat_Sqrt:  [[0.15]]
grads:  [-0.05250368]
Stock Position:  -0.052503682773279915
Bond Position:  [13.21720976]


portfolio before change:  [8.03266243]
curr_Stock_Price:  98.7620897925869
curr_Factors:  [98.76208979]
mat_Sqrt:  [[0.15]]
grads:  [0.07250901]
Stock Position:  0.07250900586117019
Bond Position:  [0.87152149]


portfolio before change:  [7.99374131]
curr_Stock_Price:  98.22456212636614
curr_Factors:  [98.22456213]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178169]
Stock Position:  -0.017816900793094316
Bond Position:  [9.74379859]


portfolio before change:  [8.00335948]
curr_Stock_Price:  97.71890930869985
curr_Factors:  [97.71890931]
mat_Sqrt:  [[0.15]]
grads:  [0.04031928]
Stock Position:  0.040319283698709726
Bond Position:  [4.06340305]


portfolio before change:  [8.01126157]
curr_Stock_Price:  97.9085981777848
curr_Factors:  [97.90859818]
mat_Sqrt:  [[0.15]]
grads:  [-0.08788265]
Stock Position:  -0.08788265426319501
Bond Position:  [16.61572905]


portfolio before change:  [8.07949225]
curr_Stock_Price:  97.14403133625042
curr_Factors:  [97.14403134]
mat_Sqrt:  [[0.15]]
grads:  [-0.07206042]
Stock Position:  -0.07206041730146868
Bond Position:  [15.07973169]


portfolio before change:  [8.12951145]
curr_Stock_Price:  96.46298216441056
curr_Factors:  [96.46298216]
mat_Sqrt:  [[0.15]]
grads:  [0.03042743]
Stock Position:  0.03042742877781209
Bond Position:  [5.19439093]


portfolio before change:  [8.12617299]
curr_Stock_Price:  96.34259347818029
curr_Factors:  [96.34259348]
mat_Sqrt:  [[0.15]]
grads:  [0.03371039]
Stock Position:  0.03371039221534968
Bond Position:  [4.87842638]


portfolio before change:  [8.14223896]
curr_Stock_Price:  96.8101365336698
curr_Factors:  [96.81013653]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.14223896]
Stock Price:  97.0980545979266
PL:  [8.14223896]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.61725589e-03]
 [-1.91354820e-02]
 [-8.43342084e-03]
 [ 6.52947005e-03]
 [-3.37716708e-03]
 [ 1.84098958e-02]
 [ 1.10197862e-03]
 [-1.73749259e-02]
 [ 9.18567582e-03]
 [ 1.94199414e-02]
 [ 1.51907128e-02]
 [ 2.53168735e-02]
 [-1.43006663e-02]
 [ 4.88980247e-03]
 [-6.98014531e-03]
 [ 1.00159343e-02]
 [ 1.03517819e-02]
 [-8.15317661e-03]
 [ 1.54302386e-03]
 [ 9.39748427e-03]
 [ 1.26995073e-02]
 [-1.03725375e-02]
 [ 2.83644743e-03]
 [-5.42375188e-02]
 [-1.17997551e-02]
 [-1.61283567e-03]
 [ 3.45262644e-04]
 [ 1.01994290e-02]
 [-3.33955364e-02]
 [ 2.53730271e-03]
 [-8.32196679e-04]
 [-1.00521996e-02]
 [-8.75381903e-03]
 [ 5.63144852e-03]
 [ 1.37668304e-02]
 [ 1.12094280e-02]
 [-3.35621060e-02]
 [ 8.73297936e-03]
 [-1.79496027e-02]
 [ 1.94639543e-02]
 [-7.58883498e-03]
 [ 2.28287601e-02]
 [ 2.30615287e-02]
 [ 4.38047041e-03]
 [ 3.04744338e-03]
 [ 8.37360474e-03]
 [ 8.46469121e-04]
 [-1.13850010e-02]
 [ 4.52269280e-03]
 [ 3.50417365e-03]
 [ 3.75662253e-02]
 [-4.13458934e-03]
 [ 1.81972345e-03]
 [ 4.92373155e-03]
 [ 4.38321092e-03]
 [-1.19962790e-03]
 [ 7.64030536e-03]
 [-2.99368223e-04]
 [ 1.53571525e-03]
 [ 2.85716971e-03]
 [-3.79203886e-04]
 [ 4.99821354e-03]
 [ 1.29358979e-02]
 [-1.83762381e-02]
 [-8.95800603e-03]
 [-7.20251319e-03]
 [-4.76760815e-03]
 [ 1.81567360e-02]
 [-9.67484311e-03]
 [ 6.86101427e-03]
 [-6.22172961e-03]
 [ 1.09932309e-02]
 [-4.07098282e-03]
 [ 8.49428042e-03]
 [-1.86544855e-02]
 [-4.59809716e-03]
 [-6.18643172e-03]
 [-1.83587191e-03]
 [ 1.83062615e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.05016273]
curr_Stock_Price:  99.60388489082858
curr_Factors:  [99.60388489]
mat_Sqrt:  [[0.15]]
grads:  [0.02411504]
Stock Position:  0.024115039268587393
Bond Position:  [-6.45211432]


portfolio before change:  [-4.06721362]
curr_Stock_Price:  98.91354294792653
curr_Factors:  [98.91354295]
mat_Sqrt:  [[0.15]]
grads:  [-0.12756988]
Stock Position:  -0.12756988029947433
Bond Position:  [8.55117521]


portfolio before change:  [-3.96638554]
curr_Stock_Price:  98.12735724083467
curr_Factors:  [98.12735724]
mat_Sqrt:  [[0.15]]
grads:  [-0.05622281]
Stock Position:  -0.05622280558439648
Bond Position:  [1.55060979]


portfolio before change:  [-3.99832227]
curr_Stock_Price:  98.6971197529211
curr_Factors:  [98.69711975]
mat_Sqrt:  [[0.15]]
grads:  [0.0435298]
Stock Position:  0.04352980032690947
Bond Position:  [-8.29458818]


portfolio before change:  [-4.00826599]
curr_Stock_Price:  98.48059455319914
curr_Factors:  [98.48059455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02251445]
Stock Position:  -0.0225144472313121
Bond Position:  [-1.79102985]


portfolio before change:  [-4.02179069]
curr_Stock_Price:  99.07633428224257
curr_Factors:  [99.07633428]
mat_Sqrt:  [[0.15]]
grads:  [0.12273264]
Stock Position:  0.12273263848539646
Bond Position:  [-16.18169061]


portfolio before change:  [-4.00022504]
curr_Stock_Price:  99.26028727113217
curr_Factors:  [99.26028727]
mat_Sqrt:  [[0.15]]
grads:  [0.00734652]
Stock Position:  0.007346524131948279
Bond Position:  [-4.72944314]


portfolio before change:  [-4.00136943]
curr_Stock_Price:  99.14475034203949
curr_Factors:  [99.14475034]
mat_Sqrt:  [[0.15]]
grads:  [-0.11583284]
Stock Position:  -0.11583283953251626
Bond Position:  [7.48284852]


portfolio before change:  [-4.01851389]
curr_Stock_Price:  99.29679834855457
curr_Factors:  [99.29679835]
mat_Sqrt:  [[0.15]]
grads:  [0.06123784]
Stock Position:  0.06123783877234182
Bond Position:  [-10.09923522]


portfolio before change:  [-4.03342857]
curr_Stock_Price:  99.06355277322754
curr_Factors:  [99.06355277]
mat_Sqrt:  [[0.15]]
grads:  [0.12946628]
Stock Position:  0.12946627595371227
Bond Position:  [-16.85881783]


portfolio before change:  [-4.04825229]
curr_Stock_Price:  98.95719297431256
curr_Factors:  [98.95719297]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-14.06978758]


portfolio before change:  [-4.12498054]
curr_Stock_Price:  98.20822686857107
curr_Factors:  [98.20822687]
mat_Sqrt:  [[0.15]]
grads:  [0.16877916]
Stock Position:  0.16877915656981157
Bond Position:  [-20.70048224]


portfolio before change:  [-4.05459795]
curr_Stock_Price:  98.63290256468284
curr_Factors:  [98.63290256]
mat_Sqrt:  [[0.15]]
grads:  [-0.09533778]
Stock Position:  -0.09533777512664192
Bond Position:  [5.34884353]


portfolio before change:  [-4.00241193]
curr_Stock_Price:  98.08902891910988
curr_Factors:  [98.08902892]
mat_Sqrt:  [[0.15]]
grads:  [0.03259868]
Stock Position:  0.03259868311783213
Bond Position:  [-7.19998511]


portfolio before change:  [-3.99294895]
curr_Stock_Price:  98.39312087452322
curr_Factors:  [98.39312087]
mat_Sqrt:  [[0.15]]
grads:  [-0.0465343]
Stock Position:  -0.04653430209290833
Bond Position:  [0.58570626]


portfolio before change:  [-3.95483042]
curr_Stock_Price:  97.57475846644316
curr_Factors:  [97.57475847]
mat_Sqrt:  [[0.15]]
grads:  [0.0667729]
Stock Position:  0.06677289550633808
Bond Position:  [-10.47017957]


portfolio before change:  [-3.94327909]
curr_Stock_Price:  97.75755323478174
curr_Factors:  [97.75755323]
mat_Sqrt:  [[0.15]]
grads:  [0.06901188]
Stock Position:  0.0690118794798136
Bond Position:  [-10.68971157]


portfolio before change:  [-3.9241179]
curr_Stock_Price:  98.04488524565764
curr_Factors:  [98.04488525]
mat_Sqrt:  [[0.15]]
grads:  [-0.05435451]
Stock Position:  -0.05435451071069085
Bond Position:  [1.40506387]


portfolio before change:  [-3.93017318]
curr_Stock_Price:  98.15790453972704
curr_Factors:  [98.15790454]
mat_Sqrt:  [[0.15]]
grads:  [0.01028683]
Stock Position:  0.010286825728734373
Bond Position:  [-4.93990644]


portfolio before change:  [-3.93471447]
curr_Stock_Price:  97.74645317427569
curr_Factors:  [97.74645317]
mat_Sqrt:  [[0.15]]
grads:  [0.0626499]
Stock Position:  0.06264989515543669
Bond Position:  [-10.05851951]


portfolio before change:  [-3.96884459]
curr_Stock_Price:  97.21171258678739
curr_Factors:  [97.21171259]
mat_Sqrt:  [[0.15]]
grads:  [0.08466338]
Stock Position:  0.08466338213895903
Bond Position:  [-12.19911696]


portfolio before change:  [-3.9929933]
curr_Stock_Price:  96.93548640466061
curr_Factors:  [96.9354864]
mat_Sqrt:  [[0.15]]
grads:  [-0.06915025]
Stock Position:  -0.06915024978064592
Bond Position:  [2.7101198]


portfolio before change:  [-3.98320021]
curr_Stock_Price:  96.79631548347297
curr_Factors:  [96.79631548]
mat_Sqrt:  [[0.15]]
grads:  [0.01890965]
Stock Position:  0.018909649511910445
Bond Position:  [-5.81358461]


portfolio before change:  [-3.98915324]
curr_Stock_Price:  96.50071643977938
curr_Factors:  [96.50071644]
mat_Sqrt:  [[0.15]]
grads:  [-0.36158346]
Stock Position:  -0.3615834588852802
Bond Position:  [30.9039096]


portfolio before change:  [-3.96806597]
curr_Stock_Price:  96.44773914863207
curr_Factors:  [96.44773915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07866503]
Stock Position:  -0.07866503427047011
Bond Position:  [3.61899873]


portfolio before change:  [-3.92141277]
curr_Stock_Price:  95.85755308435596
curr_Factors:  [95.85755308]
mat_Sqrt:  [[0.15]]
grads:  [-0.01075224]
Stock Position:  -0.010752237779087076
Bond Position:  [-2.89072957]


portfolio before change:  [-3.92695691]
curr_Stock_Price:  96.35637576143777
curr_Factors:  [96.35637576]
mat_Sqrt:  [[0.15]]
grads:  [0.00230175]
Stock Position:  0.0023017509582174264
Bond Position:  [-4.14874529]


portfolio before change:  [-3.92620537]
curr_Stock_Price:  96.79553796374906
curr_Factors:  [96.79553796]
mat_Sqrt:  [[0.15]]
grads:  [0.06799619]
Stock Position:  0.06799619311095405
Bond Position:  [-10.50793346]


portfolio before change:  [-3.91679911]
curr_Stock_Price:  96.94353196622842
curr_Factors:  [96.94353197]
mat_Sqrt:  [[0.15]]
grads:  [-0.22263691]
Stock Position:  -0.22263690900826075
Bond Position:  [17.6664092]


portfolio before change:  [-3.96801788]
curr_Stock_Price:  97.17854671484488
curr_Factors:  [97.17854671]
mat_Sqrt:  [[0.15]]
grads:  [0.01691535]
Stock Position:  0.016915351419322933
Bond Position:  [-5.61182715]


portfolio before change:  [-3.95484344]
curr_Stock_Price:  97.97812735295642
curr_Factors:  [97.97812735]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554798]
Stock Position:  -0.005547977858288318
Bond Position:  [-3.41126296]


portfolio before change:  [-3.94954575]
curr_Stock_Price:  96.98481016813597
curr_Factors:  [96.98481017]
mat_Sqrt:  [[0.15]]
grads:  [-0.06701466]
Stock Position:  -0.06701466370529102
Bond Position:  [2.54985869]


portfolio before change:  [-3.9741458]
curr_Stock_Price:  97.3542728086633
curr_Factors:  [97.35427281]
mat_Sqrt:  [[0.15]]
grads:  [-0.05835879]
Stock Position:  -0.05835879351306329
Bond Position:  [1.70733211]


portfolio before change:  [-3.94900441]
curr_Stock_Price:  96.9252942409987
curr_Factors:  [96.92529424]
mat_Sqrt:  [[0.15]]
grads:  [0.03754299]
Stock Position:  0.037542990164219914
Bond Position:  [-7.58786978]


portfolio before change:  [-3.97101628]
curr_Stock_Price:  96.35161565323065
curr_Factors:  [96.35161565]
mat_Sqrt:  [[0.15]]
grads:  [0.09177887]
Stock Position:  0.09177886966336637
Bond Position:  [-12.81405865]


portfolio before change:  [-3.93192095]
curr_Stock_Price:  96.78631523946471
curr_Factors:  [96.78631524]
mat_Sqrt:  [[0.15]]
grads:  [0.07472952]
Stock Position:  0.0747295202081388
Bond Position:  [-11.16471585]


portfolio before change:  [-3.94616552]
curr_Stock_Price:  96.60503799977232
curr_Factors:  [96.605038]
mat_Sqrt:  [[0.15]]
grads:  [-0.22374737]
Stock Position:  -0.2237473731609943
Bond Position:  [17.66895796]


portfolio before change:  [-4.19313328]
curr_Stock_Price:  97.71375314308654
curr_Factors:  [97.71375314]
mat_Sqrt:  [[0.15]]
grads:  [0.05821986]
Stock Position:  0.058219862381478776
Bond Position:  [-9.88201454]


portfolio before change:  [-4.15171165]
curr_Stock_Price:  98.43583099629979
curr_Factors:  [98.435831]
mat_Sqrt:  [[0.15]]
grads:  [-0.11966402]
Stock Position:  -0.11966401786221655
Bond Position:  [7.62751539]


portfolio before change:  [-4.07821679]
curr_Stock_Price:  97.82563814895349
curr_Factors:  [97.82563815]
mat_Sqrt:  [[0.15]]
grads:  [0.1297597]
Stock Position:  0.12975969519478692
Bond Position:  [-16.77204178]


portfolio before change:  [-4.07093162]
curr_Stock_Price:  97.88986039677896
curr_Factors:  [97.8898604]
mat_Sqrt:  [[0.15]]
grads:  [-0.05059223]
Stock Position:  -0.05059223317582461
Bond Position:  [0.88153503]


portfolio before change:  [-4.05451092]
curr_Stock_Price:  97.56638001718879
curr_Factors:  [97.56638002]
mat_Sqrt:  [[0.15]]
grads:  [0.15219173]
Stock Position:  0.15219173397041277
Bond Position:  [-18.90330747]


portfolio before change:  [-4.0647825]
curr_Stock_Price:  97.50665214944134
curr_Factors:  [97.50665215]
mat_Sqrt:  [[0.15]]
grads:  [0.15374352]
Stock Position:  0.15374352487847148
Bond Position:  [-19.0557989]


portfolio before change:  [-4.02152184]
curr_Stock_Price:  97.795781002785
curr_Factors:  [97.795781]
mat_Sqrt:  [[0.15]]
grads:  [0.02920314]
Stock Position:  0.029203136050062403
Bond Position:  [-6.87746534]


portfolio before change:  [-4.04177941]
curr_Stock_Price:  97.11682258511684
curr_Factors:  [97.11682259]
mat_Sqrt:  [[0.15]]
grads:  [0.02031629]
Stock Position:  0.02031628918188297
Bond Position:  [-6.01483286]


portfolio before change:  [-4.05600594]
curr_Stock_Price:  96.4350742797989
curr_Factors:  [96.43507428]
mat_Sqrt:  [[0.15]]
grads:  [0.05582403]
Stock Position:  0.05582403163312618
Bond Position:  [-9.43940058]


portfolio before change:  [-4.03583403]
curr_Stock_Price:  96.80699109478634
curr_Factors:  [96.80699109]
mat_Sqrt:  [[0.15]]
grads:  [0.00564313]
Stock Position:  0.005643127474950771
Bond Position:  [-4.58212822]


portfolio before change:  [-4.03753587]
curr_Stock_Price:  96.55616429961151
curr_Factors:  [96.5561643]
mat_Sqrt:  [[0.15]]
grads:  [-0.07590001]
Stock Position:  -0.07590000649298599
Bond Position:  [3.29107763]


portfolio before change:  [-4.02169568]
curr_Stock_Price:  96.35017633307359
curr_Factors:  [96.35017633]
mat_Sqrt:  [[0.15]]
grads:  [0.03015129]
Stock Position:  0.030151285352911124
Bond Position:  [-6.92677734]


portfolio before change:  [-4.03758617]
curr_Stock_Price:  95.83750981359789
curr_Factors:  [95.83750981]
mat_Sqrt:  [[0.15]]
grads:  [0.02336116]
Stock Position:  0.023361157665839224
Bond Position:  [-6.27646135]


portfolio before change:  [-4.03224938]
curr_Stock_Price:  96.08274943553475
curr_Factors:  [96.08274944]
mat_Sqrt:  [[0.15]]
grads:  [0.2504415]
Stock Position:  0.2504415020776055
Bond Position:  [-28.09535748]


portfolio before change:  [-3.85600375]
curr_Stock_Price:  96.79350082291978
curr_Factors:  [96.79350082]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756393]
Stock Position:  -0.02756392891488885
Bond Position:  [-1.18799458]


portfolio before change:  [-3.83674147]
curr_Stock_Price:  96.09198497907221
curr_Factors:  [96.09198498]
mat_Sqrt:  [[0.15]]
grads:  [0.01213149]
Stock Position:  0.01213148967002672
Bond Position:  [-5.0024804]


portfolio before change:  [-3.83166907]
curr_Stock_Price:  96.53587635075884
curr_Factors:  [96.53587635]
mat_Sqrt:  [[0.15]]
grads:  [0.03282488]
Stock Position:  0.03282487701897142
Bond Position:  [-7.00044734]


portfolio before change:  [-3.81905097]
curr_Stock_Price:  96.93361261879609
curr_Factors:  [96.93361262]
mat_Sqrt:  [[0.15]]
grads:  [0.02922141]
Stock Position:  0.029221406146130287
Bond Position:  [-6.65158743]


portfolio before change:  [-3.81168105]
curr_Stock_Price:  97.20004926411853
curr_Factors:  [97.20004926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00799752]
Stock Position:  -0.007997519349398838
Bond Position:  [-3.03432178]


portfolio before change:  [-3.81870581]
curr_Stock_Price:  98.05470271359094
curr_Factors:  [98.05470271]
mat_Sqrt:  [[0.15]]
grads:  [0.05093537]
Stock Position:  0.05093536906410188
Bond Position:  [-8.81315828]


portfolio before change:  [-3.78658443]
curr_Stock_Price:  98.69614736657954
curr_Factors:  [98.69614737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00199579]
Stock Position:  -0.001995788154910772
Bond Position:  [-3.58960783]


portfolio before change:  [-3.78598917]
curr_Stock_Price:  98.28547004196335
curr_Factors:  [98.28547004]
mat_Sqrt:  [[0.15]]
grads:  [0.0102381]
Stock Position:  0.010238101651913566
Bond Position:  [-4.7922458]


portfolio before change:  [-3.78557364]
curr_Stock_Price:  98.35531244955565
curr_Factors:  [98.35531245]
mat_Sqrt:  [[0.15]]
grads:  [0.0190478]
Stock Position:  0.019047798041118433
Bond Position:  [-5.65902576]


portfolio before change:  [-3.79257223]
curr_Stock_Price:  98.00645868728738
curr_Factors:  [98.00645869]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252803]
Stock Position:  -0.0025280259052628574
Bond Position:  [-3.54480937]


portfolio before change:  [-3.79129279]
curr_Stock_Price:  97.41271362222014
curr_Factors:  [97.41271362]
mat_Sqrt:  [[0.15]]
grads:  [0.03332142]
Stock Position:  0.0333214236222535
Bond Position:  [-7.03722308]


portfolio before change:  [-3.79674146]
curr_Stock_Price:  97.2623948644691
curr_Factors:  [97.26239486]
mat_Sqrt:  [[0.15]]
grads:  [0.08623932]
Stock Position:  0.08623931944529366
Bond Position:  [-12.1845842]


portfolio before change:  [-3.7750365]
curr_Stock_Price:  97.52290853856493
curr_Factors:  [97.52290854]
mat_Sqrt:  [[0.15]]
grads:  [-0.12250825]
Stock Position:  -0.12250825371190244
Bond Position:  [8.17232472]


portfolio before change:  [-3.7778388]
curr_Stock_Price:  97.54995231992007
curr_Factors:  [97.54995232]
mat_Sqrt:  [[0.15]]
grads:  [-0.05972004]
Stock Position:  -0.05972004018080503
Bond Position:  [2.04784827]


portfolio before change:  [-3.78294474]
curr_Stock_Price:  97.63759354965188
curr_Factors:  [97.63759355]
mat_Sqrt:  [[0.15]]
grads:  [-0.04801675]
Stock Position:  -0.04801675462143526
Bond Position:  [0.90529563]


portfolio before change:  [-3.78749234]
curr_Stock_Price:  97.73348047112893
curr_Factors:  [97.73348047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03178405]
Stock Position:  -0.03178405435924333
Bond Position:  [-0.68112608]


portfolio before change:  [-3.78788531]
curr_Stock_Price:  97.74450468798973
curr_Factors:  [97.74450469]
mat_Sqrt:  [[0.15]]
grads:  [0.12104491]
Stock Position:  0.1210449069708246
Bond Position:  [-15.61935978]


portfolio before change:  [-3.71335182]
curr_Stock_Price:  98.36832045693822
curr_Factors:  [98.36832046]
mat_Sqrt:  [[0.15]]
grads:  [-0.06449895]
Stock Position:  -0.06449895403597476
Bond Position:  [2.63130195]


portfolio before change:  [-3.69409636]
curr_Stock_Price:  98.07233118358711
curr_Factors:  [98.07233118]
mat_Sqrt:  [[0.15]]
grads:  [0.0457401]
Stock Position:  0.04574009512935519
Bond Position:  [-8.17993412]


portfolio before change:  [-3.67617066]
curr_Stock_Price:  98.47541219682948
curr_Factors:  [98.4754122]
mat_Sqrt:  [[0.15]]
grads:  [-0.0414782]
Stock Position:  -0.04147819739002837
Bond Position:  [0.40841192]


portfolio before change:  [-3.67771927]
curr_Stock_Price:  98.51336297621599
curr_Factors:  [98.51336298]
mat_Sqrt:  [[0.15]]
grads:  [0.07328821]
Stock Position:  0.0732882060047498
Bond Position:  [-10.89758691]


portfolio before change:  [-3.66218748]
curr_Stock_Price:  98.73458419298542
curr_Factors:  [98.73458419]
mat_Sqrt:  [[0.15]]
grads:  [-0.02713989]
Stock Position:  -0.02713988549312171
Bond Position:  [-0.98254217]


portfolio before change:  [-3.66308515]
curr_Stock_Price:  98.76539694638785
curr_Factors:  [98.76539695]
mat_Sqrt:  [[0.15]]
grads:  [0.05662854]
Stock Position:  0.056628536148462666
Bond Position:  [-9.256025]


portfolio before change:  [-3.64539687]
curr_Stock_Price:  99.08796930518392
curr_Factors:  [99.08796931]
mat_Sqrt:  [[0.15]]
grads:  [-0.12436324]
Stock Position:  -0.12436323677812541
Bond Position:  [8.67750372]


portfolio before change:  [-3.66777357]
curr_Stock_Price:  99.2722606655063
curr_Factors:  [99.27226067]
mat_Sqrt:  [[0.15]]
grads:  [-0.03065398]
Stock Position:  -0.03065398106687874
Bond Position:  [-0.62468358]


portfolio before change:  [-3.68568919]
curr_Stock_Price:  99.8554336510403
curr_Factors:  [99.85543365]
mat_Sqrt:  [[0.15]]
grads:  [-0.04124288]
Stock Position:  -0.0412428781219562
Bond Position:  [0.43263629]


portfolio before change:  [-3.70362716]
curr_Stock_Price:  100.29102411640677
curr_Factors:  [100.29102412]
mat_Sqrt:  [[0.15]]
grads:  [-0.01223915]
Stock Position:  -0.01223914604268656
Bond Position:  [-2.47615066]


portfolio before change:  [-3.70030234]
curr_Stock_Price:  100.00672488729552
curr_Factors:  [100.00672489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.70030234]
Stock Price:  100.41240308580484
PL:  [-4.11270543]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.22293010e-03]
 [ 5.48809114e-04]
 [ 5.28327608e-04]
 [ 8.35575002e-03]
 [ 5.05599023e-03]
 [ 2.34397929e-02]
 [ 1.64559743e-03]
 [-1.31310236e-02]
 [ 2.18763900e-02]
 [-4.47634356e-03]
 [ 1.57315450e-02]
 [-5.68302807e-02]
 [ 6.84027783e-02]
 [ 5.14725658e-03]
 [-6.90031588e-03]
 [ 1.75095918e-02]
 [ 1.03021892e-02]
 [-1.14662716e-02]
 [-4.50366779e-04]
 [ 6.60827707e-03]
 [ 1.14848129e-02]
 [-8.04419470e-03]
 [ 7.84112720e-03]
 [ 1.82669505e-02]
 [-8.10737868e-03]
 [-1.61415435e-03]
 [-6.15247792e-03]
 [ 6.13397471e-03]
 [-8.83752631e-03]
 [-2.64699337e-03]
 [-1.56335231e-05]
 [-1.06502290e-02]
 [-5.58989572e-03]
 [ 4.78532097e-03]
 [ 1.37395137e-02]
 [ 1.56310287e-02]
 [-3.45221917e-02]
 [ 8.67069676e-03]
 [-2.80649495e-02]
 [ 1.62366289e-02]
 [-1.13786064e-02]
 [ 3.12271280e-02]
 [ 2.31608623e-02]
 [ 3.76622635e-03]
 [ 6.86097206e-03]
 [ 1.46179451e-02]
 [-8.32056844e-04]
 [-7.95516002e-03]
 [ 1.63902464e-02]
 [ 4.46199702e-03]
 [ 3.39986573e-02]
 [ 8.49407122e-03]
 [ 7.15402675e-04]
 [ 4.53871157e-03]
 [ 4.08205362e-03]
 [ 5.13742019e-03]
 [-2.13827882e-02]
 [ 4.22716293e-04]
 [ 1.62809784e-03]
 [-1.08251143e-01]
 [-1.52403679e-02]
 [ 1.76584965e-02]
 [ 1.76736916e-02]
 [-2.00214077e-02]
 [-4.76193858e-03]
 [-1.97145641e-02]
 [-3.75718219e-03]
 [-5.82738056e-03]
 [-2.03109121e-02]
 [ 1.69768790e-02]
 [ 1.84665979e-02]
 [ 1.37573908e-02]
 [ 8.26407250e-04]
 [ 9.11265882e-03]
 [ 2.87377709e-02]
 [-2.89050853e-02]
 [ 4.30529988e-03]
 [ 1.12390852e-02]
 [ 9.47383218e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.76977165]
curr_Stock_Price:  99.4920673912609
curr_Factors:  [99.49206739]
mat_Sqrt:  [[0.15]]
grads:  [0.02815287]
Stock Position:  0.02815286732875794
Bond Position:  [-8.57075862]


portfolio before change:  [-5.76369798]
curr_Stock_Price:  99.72683436822635
curr_Factors:  [99.72683437]
mat_Sqrt:  [[0.15]]
grads:  [0.00365873]
Stock Position:  0.0036587274249159805
Bond Position:  [-6.12857128]


portfolio before change:  [-5.76310507]
curr_Stock_Price:  99.99358190746878
curr_Factors:  [99.99358191]
mat_Sqrt:  [[0.15]]
grads:  [0.00352218]
Stock Position:  0.003522184051843556
Bond Position:  [-6.11530087]


portfolio before change:  [-5.76421572]
curr_Stock_Price:  99.78676773820806
curr_Factors:  [99.78676774]
mat_Sqrt:  [[0.15]]
grads:  [0.055705]
Stock Position:  0.05570500011119042
Bond Position:  [-11.32283763]


portfolio before change:  [-5.76710818]
curr_Stock_Price:  99.74754768410617
curr_Factors:  [99.74754768]
mat_Sqrt:  [[0.15]]
grads:  [0.0337066]
Stock Position:  0.033706601529213766
Bond Position:  [-9.12925902]


portfolio before change:  [-5.76330589]
curr_Stock_Price:  99.87728150653967
curr_Factors:  [99.87728151]
mat_Sqrt:  [[0.15]]
grads:  [0.15626529]
Stock Position:  0.15626528572737705
Bond Position:  [-21.37065782]


portfolio before change:  [-5.7075571]
curr_Stock_Price:  100.24258652007227
curr_Factors:  [100.24258652]
mat_Sqrt:  [[0.15]]
grads:  [0.01097065]
Stock Position:  0.01097064955725202
Bond Position:  [-6.80728339]


portfolio before change:  [-5.70487405]
curr_Stock_Price:  100.5259356166811
curr_Factors:  [100.52593562]
mat_Sqrt:  [[0.15]]
grads:  [-0.08754016]
Stock Position:  -0.08754015730109198
Bond Position:  [3.09518217]


portfolio before change:  [-5.67948005]
curr_Stock_Price:  100.23806156903753
curr_Factors:  [100.23806157]
mat_Sqrt:  [[0.15]]
grads:  [0.1458426]
Stock Position:  0.14584259988505827
Bond Position:  [-20.29845956]


portfolio before change:  [-5.5941494]
curr_Stock_Price:  100.83184790696096
curr_Factors:  [100.83184791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02984229]
Stock Position:  -0.029842290393813052
Bond Position:  [-2.58509612]


portfolio before change:  [-5.59599655]
curr_Stock_Price:  100.88833058576414
curr_Factors:  [100.88833059]
mat_Sqrt:  [[0.15]]
grads:  [0.10487697]
Stock Position:  0.10487696685539781
Bond Position:  [-16.17685865]


portfolio before change:  [-5.51933783]
curr_Stock_Price:  101.62891077442576
curr_Factors:  [101.62891077]
mat_Sqrt:  [[0.15]]
grads:  [-0.37886854]
Stock Position:  -0.3788685377088837
Bond Position:  [32.98465899]


portfolio before change:  [-5.70026994]
curr_Stock_Price:  102.1119113286497
curr_Factors:  [102.11191133]
mat_Sqrt:  [[0.15]]
grads:  [0.45601852]
Stock Position:  0.4560185222406471
Bond Position:  [-52.26519284]


portfolio before change:  [-5.93233167]
curr_Stock_Price:  101.61018815348591
curr_Factors:  [101.61018815]
mat_Sqrt:  [[0.15]]
grads:  [0.03431504]
Stock Position:  0.03431504386199072
Bond Position:  [-9.41908974]


portfolio before change:  [-5.93411824]
curr_Stock_Price:  101.5752805760432
curr_Factors:  [101.57528058]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600211]
Stock Position:  -0.04600210586433699
Bond Position:  [-1.26144143]


portfolio before change:  [-5.89446401]
curr_Stock_Price:  100.71155753945075
curr_Factors:  [100.71155754]
mat_Sqrt:  [[0.15]]
grads:  [0.11673061]
Stock Position:  0.11673061168839062
Bond Position:  [-17.65058572]


portfolio before change:  [-5.87630181]
curr_Stock_Price:  100.87659897331018
curr_Factors:  [100.87659897]
mat_Sqrt:  [[0.15]]
grads:  [0.06868126]
Stock Position:  0.06868126126817423
Bond Position:  [-12.80463386]


portfolio before change:  [-5.88235849]
curr_Stock_Price:  100.80006628509724
curr_Factors:  [100.80006629]
mat_Sqrt:  [[0.15]]
grads:  [-0.07644181]
Stock Position:  -0.07644181086678477
Bond Position:  [1.82298111]


portfolio before change:  [-5.87197463]
curr_Stock_Price:  100.6657167169091
curr_Factors:  [100.66571672]
mat_Sqrt:  [[0.15]]
grads:  [-0.00300245]
Stock Position:  -0.003002445193478557
Bond Position:  [-5.56973133]


portfolio before change:  [-5.87177813]
curr_Stock_Price:  100.48432794828949
curr_Factors:  [100.48432795]
mat_Sqrt:  [[0.15]]
grads:  [0.04405518]
Stock Position:  0.044055180455413866
Bond Position:  [-10.29863334]


portfolio before change:  [-5.8881794]
curr_Stock_Price:  100.12664975464848
curr_Factors:  [100.12664975]
mat_Sqrt:  [[0.15]]
grads:  [0.07656542]
Stock Position:  0.0765654195095249
Bond Position:  [-13.55441834]


portfolio before change:  [-5.92473172]
curr_Stock_Price:  99.660314643073
curr_Factors:  [99.66031464]
mat_Sqrt:  [[0.15]]
grads:  [-0.05362796]
Stock Position:  -0.053627964644638274
Bond Position:  [-0.58015189]


portfolio before change:  [-5.90622127]
curr_Stock_Price:  99.31447433303715
curr_Factors:  [99.31447433]
mat_Sqrt:  [[0.15]]
grads:  [0.05227418]
Stock Position:  0.05227418132805361
Bond Position:  [-11.09780411]


portfolio before change:  [-5.92791563]
curr_Stock_Price:  98.91273244296806
curr_Factors:  [98.91273244]
mat_Sqrt:  [[0.15]]
grads:  [0.12177967]
Stock Position:  0.12177966974593535
Bond Position:  [-17.97347552]


portfolio before change:  [-5.97030457]
curr_Stock_Price:  98.57387815643406
curr_Factors:  [98.57387816]
mat_Sqrt:  [[0.15]]
grads:  [-0.05404919]
Stock Position:  -0.05404919123006375
Bond Position:  [-0.64246618]


portfolio before change:  [-6.00137093]
curr_Stock_Price:  99.14791458809236
curr_Factors:  [99.14791459]
mat_Sqrt:  [[0.15]]
grads:  [-0.01076103]
Stock Position:  -0.010761028990967208
Bond Position:  [-4.93443735]


portfolio before change:  [-6.00206426]
curr_Stock_Price:  99.1836839327516
curr_Factors:  [99.18368393]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101652]
Stock Position:  -0.04101651945452179
Bond Position:  [-1.93389476]


portfolio before change:  [-6.00658598]
curr_Stock_Price:  99.29097842282847
curr_Factors:  [99.29097842]
mat_Sqrt:  [[0.15]]
grads:  [0.04089316]
Stock Position:  0.0408931647050179
Bond Position:  [-10.06690831]


portfolio before change:  [-5.99772614]
curr_Stock_Price:  99.52302293258926
curr_Factors:  [99.52302293]
mat_Sqrt:  [[0.15]]
grads:  [-0.05891684]
Stock Position:  -0.05891684205860104
Bond Position:  [-0.13414392]


portfolio before change:  [-6.02553961]
curr_Stock_Price:  99.99496073417623
curr_Factors:  [99.99496073]
mat_Sqrt:  [[0.15]]
grads:  [-0.01764662]
Stock Position:  -0.017646622490334614
Bond Position:  [-4.26096629]


portfolio before change:  [-6.02105389]
curr_Stock_Price:  99.72567156825276
curr_Factors:  [99.72567157]
mat_Sqrt:  [[0.15]]
grads:  [-0.00010422]
Stock Position:  -0.00010422348704215481
Bond Position:  [-6.01066013]


portfolio before change:  [-6.02141631]
curr_Stock_Price:  99.59845712551204
curr_Factors:  [99.59845713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07100153]
Stock Position:  -0.0710015266454643
Bond Position:  [1.0502262]


portfolio before change:  [-5.97524772]
curr_Stock_Price:  98.94913385341009
curr_Factors:  [98.94913385]
mat_Sqrt:  [[0.15]]
grads:  [-0.03726597]
Stock Position:  -0.03726597149243112
Bond Position:  [-2.28781212]


portfolio before change:  [-5.95486993]
curr_Stock_Price:  98.3984765465256
curr_Factors:  [98.39847655]
mat_Sqrt:  [[0.15]]
grads:  [0.03190214]
Stock Position:  0.031902139813232915
Bond Position:  [-9.09399189]


portfolio before change:  [-5.9877207]
curr_Stock_Price:  97.38655768296042
curr_Factors:  [97.38655768]
mat_Sqrt:  [[0.15]]
grads:  [0.09159676]
Stock Position:  0.09159675769135371
Bond Position:  [-14.90801363]


portfolio before change:  [-5.96276328]
curr_Stock_Price:  97.66920090602878
curr_Factors:  [97.66920091]
mat_Sqrt:  [[0.15]]
grads:  [0.10420686]
Stock Position:  0.1042068577131713
Bond Position:  [-16.1405638]


portfolio before change:  [-5.92901465]
curr_Stock_Price:  98.0027436798563
curr_Factors:  [98.00274368]
mat_Sqrt:  [[0.15]]
grads:  [-0.23014794]
Stock Position:  -0.23014794460388766
Bond Position:  [16.62611537]


portfolio before change:  [-5.81123364]
curr_Stock_Price:  97.49549670504153
curr_Factors:  [97.49549671]
mat_Sqrt:  [[0.15]]
grads:  [0.05780465]
Stock Position:  0.05780464507300166
Bond Position:  [-11.44692622]


portfolio before change:  [-5.83226083]
curr_Stock_Price:  97.14411077622472
curr_Factors:  [97.14411078]
mat_Sqrt:  [[0.15]]
grads:  [-0.18709966]
Stock Position:  -0.18709966343216408
Bond Position:  [12.3433696]


portfolio before change:  [-5.84854345]
curr_Stock_Price:  97.23526058999104
curr_Factors:  [97.23526059]
mat_Sqrt:  [[0.15]]
grads:  [0.10824419]
Stock Position:  0.10824419250116991
Bond Position:  [-16.37369571]


portfolio before change:  [-5.91109824]
curr_Stock_Price:  96.66681062541134
curr_Factors:  [96.66681063]
mat_Sqrt:  [[0.15]]
grads:  [-0.07585738]
Stock Position:  -0.07585737574143933
Bond Position:  [1.42179233]


portfolio before change:  [-5.93649327]
curr_Stock_Price:  97.0027553646966
curr_Factors:  [97.00275536]
mat_Sqrt:  [[0.15]]
grads:  [0.20818085]
Stock Position:  0.2081808535183225
Bond Position:  [-26.13060967]


portfolio before change:  [-5.98153864]
curr_Stock_Price:  96.79422436925418
curr_Factors:  [96.79422437]
mat_Sqrt:  [[0.15]]
grads:  [0.15440575]
Stock Position:  0.1544057484930157
Bond Position:  [-20.9271233]


portfolio before change:  [-6.14901022]
curr_Stock_Price:  95.71807537877743
curr_Factors:  [95.71807538]
mat_Sqrt:  [[0.15]]
grads:  [0.02510818]
Stock Position:  0.025108175693944013
Bond Position:  [-8.55231647]


portfolio before change:  [-6.15026692]
curr_Stock_Price:  95.6893130702177
curr_Factors:  [95.68931307]
mat_Sqrt:  [[0.15]]
grads:  [0.04573981]
Stock Position:  0.045739813751857934
Bond Position:  [-10.52707828]


portfolio before change:  [-6.15039597]
curr_Stock_Price:  95.70087668509592
curr_Factors:  [95.70087669]
mat_Sqrt:  [[0.15]]
grads:  [0.09745297]
Stock Position:  0.0974529673627835
Bond Position:  [-15.47673038]


portfolio before change:  [-6.147269]
curr_Stock_Price:  95.74288975452801
curr_Factors:  [95.74288975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554705]
Stock Position:  -0.005547045626481488
Bond Position:  [-5.61617882]


portfolio before change:  [-6.14555797]
curr_Stock_Price:  95.37115250967373
curr_Factors:  [95.37115251]
mat_Sqrt:  [[0.15]]
grads:  [-0.0530344]
Stock Position:  -0.05303440010630561
Bond Position:  [-1.08760611]


portfolio before change:  [-6.12602414]
curr_Stock_Price:  95.00154697391477
curr_Factors:  [95.00154697]
mat_Sqrt:  [[0.15]]
grads:  [0.10926831]
Stock Position:  0.1092683093855514
Bond Position:  [-16.50668257]


portfolio before change:  [-6.07228062]
curr_Stock_Price:  95.5028379938289
curr_Factors:  [95.50283799]
mat_Sqrt:  [[0.15]]
grads:  [0.02974665]
Stock Position:  0.029746646801843565
Bond Position:  [-8.91316981]


portfolio before change:  [-6.07985619]
curr_Stock_Price:  95.26689627811588
curr_Factors:  [95.26689628]
mat_Sqrt:  [[0.15]]
grads:  [0.22665772]
Stock Position:  0.2266577153449653
Bond Position:  [-27.67283325]


portfolio before change:  [-6.21805551]
curr_Stock_Price:  94.66480021017465
curr_Factors:  [94.66480021]
mat_Sqrt:  [[0.15]]
grads:  [0.05662714]
Stock Position:  0.056627141488731124
Bond Position:  [-11.57865255]


portfolio before change:  [-6.20087543]
curr_Stock_Price:  94.98096965179802
curr_Factors:  [94.98096965]
mat_Sqrt:  [[0.15]]
grads:  [0.00476935]
Stock Position:  0.004769351167900881
Bond Position:  [-6.65387303]


portfolio before change:  [-6.20367935]
curr_Stock_Price:  94.48026466566338
curr_Factors:  [94.48026467]
mat_Sqrt:  [[0.15]]
grads:  [0.03025808]
Stock Position:  0.03025807712762609
Bond Position:  [-9.06247048]


portfolio before change:  [-6.21583929]
curr_Stock_Price:  94.09711001490079
curr_Factors:  [94.09711001]
mat_Sqrt:  [[0.15]]
grads:  [0.02721369]
Stock Position:  0.02721369082001524
Bond Position:  [-8.77656895]


portfolio before change:  [-6.22310815]
curr_Stock_Price:  93.85016412461071
curr_Factors:  [93.85016412]
mat_Sqrt:  [[0.15]]
grads:  [0.03424947]
Stock Position:  0.03424946792203104
Bond Position:  [-9.43742634]


portfolio before change:  [-6.22836841]
curr_Stock_Price:  93.71379998075786
curr_Factors:  [93.71379998]
mat_Sqrt:  [[0.15]]
grads:  [-0.14255192]
Stock Position:  -0.14255192156928
Bond Position:  [7.13071385]


portfolio before change:  [-6.30148859]
curr_Stock_Price:  94.22986362513268
curr_Factors:  [94.22986363]
mat_Sqrt:  [[0.15]]
grads:  [0.00281811]
Stock Position:  0.002818108617646832
Bond Position:  [-6.56703858]


portfolio before change:  [-6.30513654]
curr_Stock_Price:  93.08104413225207
curr_Factors:  [93.08104413]
mat_Sqrt:  [[0.15]]
grads:  [0.01085399]
Stock Position:  0.010853985632162166
Bond Position:  [-7.31543686]


portfolio before change:  [-6.30304176]
curr_Stock_Price:  93.31616647453491
curr_Factors:  [93.31616647]
mat_Sqrt:  [[0.15]]
grads:  [-0.72167429]
Stock Position:  -0.7216742870394603
Bond Position:  [61.04083615]


portfolio before change:  [-6.29417052]
curr_Stock_Price:  93.30916045781989
curr_Factors:  [93.30916046]
mat_Sqrt:  [[0.15]]
grads:  [-0.10160245]
Stock Position:  -0.1016024527403584
Bond Position:  [3.18626904]


portfolio before change:  [-6.33324616]
curr_Stock_Price:  93.69571392281954
curr_Factors:  [93.69571392]
mat_Sqrt:  [[0.15]]
grads:  [0.11772331]
Stock Position:  0.11772331004502645
Bond Position:  [-17.36341574]


portfolio before change:  [-6.36285945]
curr_Stock_Price:  93.4533825451465
curr_Factors:  [93.45338255]
mat_Sqrt:  [[0.15]]
grads:  [0.11782461]
Stock Position:  0.11782461036296432
Bond Position:  [-17.37396784]


portfolio before change:  [-6.44223343]
curr_Stock_Price:  92.78893670888519
curr_Factors:  [92.78893671]
mat_Sqrt:  [[0.15]]
grads:  [-0.13347605]
Stock Position:  -0.1334760510199145
Bond Position:  [5.94286742]


portfolio before change:  [-6.500764]
curr_Stock_Price:  93.23022940770235
curr_Factors:  [93.23022941]
mat_Sqrt:  [[0.15]]
grads:  [-0.03174626]
Stock Position:  -0.031746257179711995
Bond Position:  [-3.54105316]


portfolio before change:  [-6.52600504]
curr_Stock_Price:  94.01834484239724
curr_Factors:  [94.01834484]
mat_Sqrt:  [[0.15]]
grads:  [-0.13143043]
Stock Position:  -0.13143042713858827
Bond Position:  [5.83086618]


portfolio before change:  [-6.45059804]
curr_Stock_Price:  93.44737693354385
curr_Factors:  [93.44737693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02504788]
Stock Position:  -0.025047881277267814
Bond Position:  [-4.10993924]


portfolio before change:  [-6.45024997]
curr_Stock_Price:  93.42322504231522
curr_Factors:  [93.42322504]
mat_Sqrt:  [[0.15]]
grads:  [-0.0388492]
Stock Position:  -0.038849203741224
Bond Position:  [-2.82083206]


portfolio before change:  [-6.44473344]
curr_Stock_Price:  93.27668835664932
curr_Factors:  [93.27668836]
mat_Sqrt:  [[0.15]]
grads:  [-0.13540608]
Stock Position:  -0.13540608096657808
Bond Position:  [6.18549738]


portfolio before change:  [-6.33044854]
curr_Stock_Price:  92.43552747840755
curr_Factors:  [92.43552748]
mat_Sqrt:  [[0.15]]
grads:  [0.11317919]
Stock Position:  0.11317919334202245
Bond Position:  [-16.79222697]


portfolio before change:  [-6.42877302]
curr_Stock_Price:  91.5760502573166
curr_Factors:  [91.57605026]
mat_Sqrt:  [[0.15]]
grads:  [0.12311065]
Stock Position:  0.12311065267354267
Bond Position:  [-17.70276034]


portfolio before change:  [-6.49221646]
curr_Stock_Price:  91.06970109082536
curr_Factors:  [91.06970109]
mat_Sqrt:  [[0.15]]
grads:  [0.09171594]
Stock Position:  0.09171593865445134
Bond Position:  [-14.84475957]


portfolio before change:  [-6.48002791]
curr_Stock_Price:  91.2127118871579
curr_Factors:  [91.21271189]
mat_Sqrt:  [[0.15]]
grads:  [0.00550938]
Stock Position:  0.005509381669801356
Bond Position:  [-6.98255356]


portfolio before change:  [-6.47785763]
curr_Stock_Price:  91.68585215820484
curr_Factors:  [91.68585216]
mat_Sqrt:  [[0.15]]
grads:  [0.06075106]
Stock Position:  0.06075105880382136
Bond Position:  [-12.04787022]


portfolio before change:  [-6.47501716]
curr_Stock_Price:  91.74500299092638
curr_Factors:  [91.74500299]
mat_Sqrt:  [[0.15]]
grads:  [0.19158514]
Stock Position:  0.19158513956394518
Bond Position:  [-24.05199637]


portfolio before change:  [-6.63238215]
curr_Stock_Price:  90.93146550549419
curr_Factors:  [90.93146551]
mat_Sqrt:  [[0.15]]
grads:  [-0.19270057]
Stock Position:  -0.19270056842378078
Bond Position:  [10.89016294]


portfolio before change:  [-6.72150194]
curr_Stock_Price:  91.39747576671964
curr_Factors:  [91.39747577]
mat_Sqrt:  [[0.15]]
grads:  [0.028702]
Stock Position:  0.02870199922703258
Bond Position:  [-9.34479222]


portfolio before change:  [-6.72875694]
curr_Stock_Price:  91.16505518083639
curr_Factors:  [91.16505518]
mat_Sqrt:  [[0.15]]
grads:  [0.07492723]
Stock Position:  0.07492723436046429
Bond Position:  [-13.5595024]


portfolio before change:  [-6.72643251]
curr_Stock_Price:  91.20738866154541
curr_Factors:  [91.20738866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.72643251]
Stock Price:  91.47787630268364
PL:  [-6.72643251]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.42025727e-04]
 [ 3.86890854e-04]
 [-6.25204276e-04]
 [ 8.51912226e-03]
 [-2.28974188e-03]
 [ 1.86543875e-02]
 [ 2.77683039e-03]
 [-2.48622421e-02]
 [-1.89026718e-03]
 [ 2.35004553e-02]
 [-4.25905248e-02]
 [ 2.68914014e-02]
 [-1.33589953e-02]
 [ 3.36314450e-03]
 [-7.01441552e-03]
 [ 1.08305498e-02]
 [ 1.62963696e-02]
 [ 1.14769516e-02]
 [ 9.80287101e-04]
 [ 1.24651413e-02]
 [ 1.26570199e-02]
 [-1.04593488e-02]
 [ 2.74129321e-03]
 [-3.76222291e-02]
 [-1.15490866e-02]
 [-3.20903012e-03]
 [-1.40863388e-03]
 [ 9.98426043e-03]
 [-4.38664789e-02]
 [ 2.84270243e-03]
 [ 3.50518710e-03]
 [-1.00637238e-02]
 [-7.75921816e-03]
 [ 5.88125873e-03]
 [ 1.37649856e-02]
 [ 9.81376875e-03]
 [-3.21138920e-02]
 [ 8.06182076e-03]
 [-4.01130248e-02]
 [-4.77823625e-03]
 [-1.55089002e-02]
 [ 7.14447231e-02]
 [ 2.35140083e-02]
 [ 2.94036871e-03]
 [ 1.42397733e-02]
 [ 3.36650823e-02]
 [-3.68333208e-03]
 [-1.30395812e-03]
 [ 3.21842473e-02]
 [ 9.88035876e-03]
 [ 2.25065498e-02]
 [ 2.30137686e-02]
 [-1.71619879e-03]
 [ 4.40962359e-03]
 [ 4.59008573e-03]
 [ 5.51098778e-03]
 [-2.31708080e-02]
 [ 9.06530950e-04]
 [ 1.60812036e-03]
 [-9.90235017e-02]
 [-1.36537019e-02]
 [ 1.73746263e-02]
 [ 1.84622517e-02]
 [-1.97911220e-02]
 [-4.78671275e-03]
 [-1.71910037e-02]
 [-3.38391852e-03]
 [-1.15754087e-02]
 [-2.16269604e-02]
 [ 1.60520616e-02]
 [ 1.24938882e-02]
 [ 1.31829775e-02]
 [ 1.88367466e-03]
 [ 9.43254536e-03]
 [ 3.17306332e-02]
 [-2.71024350e-02]
 [ 3.90851332e-03]
 [ 1.28287493e-02]
 [ 1.31102531e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.919619]
curr_Stock_Price:  100.51226937352402
curr_Factors:  [100.51226937]
mat_Sqrt:  [[0.15]]
grads:  [-0.00228017]
Stock Position:  -0.002280171515045389
Bond Position:  [10.14880422]


portfolio before change:  [9.92209709]
curr_Stock_Price:  99.70365994834955
curr_Factors:  [99.70365995]
mat_Sqrt:  [[0.15]]
grads:  [0.00257927]
Stock Position:  0.0025792723569319858
Bond Position:  [9.6649342]


portfolio before change:  [9.92232393]
curr_Stock_Price:  99.55740323727049
curr_Factors:  [99.55740324]
mat_Sqrt:  [[0.15]]
grads:  [-0.00416803]
Stock Position:  -0.004168028505596583
Bond Position:  [10.33728203]


portfolio before change:  [9.92285884]
curr_Stock_Price:  99.58408118936623
curr_Factors:  [99.58408119]
mat_Sqrt:  [[0.15]]
grads:  [0.05679415]
Stock Position:  0.05679414838624618
Bond Position:  [4.26706575]


portfolio before change:  [9.86881208]
curr_Stock_Price:  98.62775987891327
curr_Factors:  [98.62775988]
mat_Sqrt:  [[0.15]]
grads:  [-0.01526495]
Stock Position:  -0.015264945845338428
Bond Position:  [11.3743595]


portfolio before change:  [9.86208124]
curr_Stock_Price:  99.11526648706561
curr_Factors:  [99.11526649]
mat_Sqrt:  [[0.15]]
grads:  [0.12436258]
Stock Position:  0.12436258344441514
Bond Position:  [-2.46414936]


portfolio before change:  [9.76097795]
curr_Stock_Price:  98.30353299279979
curr_Factors:  [98.30353299]
mat_Sqrt:  [[0.15]]
grads:  [0.0185122]
Stock Position:  0.018512202627680593
Bond Position:  [7.94116303]


portfolio before change:  [9.75639956]
curr_Stock_Price:  98.02940400525742
curr_Factors:  [98.02940401]
mat_Sqrt:  [[0.15]]
grads:  [-0.16574828]
Stock Position:  -0.16574828086969798
Bond Position:  [26.00460475]


portfolio before change:  [9.66770715]
curr_Stock_Price:  98.57431313837705
curr_Factors:  [98.57431314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01260178]
Stock Position:  -0.012601781206306197
Bond Position:  [10.90991907]


portfolio before change:  [9.66883116]
curr_Stock_Price:  98.53922938644517
curr_Factors:  [98.53922939]
mat_Sqrt:  [[0.15]]
grads:  [0.1566697]
Stock Position:  0.15666970190381307
Bond Position:  [-5.76928054]


portfolio before change:  [9.54112073]
curr_Stock_Price:  97.72637384176574
curr_Factors:  [97.72637384]
mat_Sqrt:  [[0.15]]
grads:  [-0.28393683]
Stock Position:  -0.2839368319829973
Bond Position:  [37.28923772]


portfolio before change:  [9.47080103]
curr_Stock_Price:  97.98224183881926
curr_Factors:  [97.98224184]
mat_Sqrt:  [[0.15]]
grads:  [0.17927601]
Stock Position:  0.17927600929825993
Bond Position:  [-8.09506427]


portfolio before change:  [9.44663831]
curr_Stock_Price:  97.8502846327592
curr_Factors:  [97.85028463]
mat_Sqrt:  [[0.15]]
grads:  [-0.08905997]
Stock Position:  -0.08905996882053845
Bond Position:  [18.16118161]


portfolio before change:  [9.46254045]
curr_Stock_Price:  97.68447470465505
curr_Factors:  [97.6844747]
mat_Sqrt:  [[0.15]]
grads:  [0.02242096]
Stock Position:  0.022420963347645657
Bond Position:  [7.27236042]


portfolio before change:  [9.46406252]
curr_Stock_Price:  97.7320881590378
curr_Factors:  [97.73208816]
mat_Sqrt:  [[0.15]]
grads:  [-0.04676277]
Stock Position:  -0.04676277011513207
Bond Position:  [14.0342857]


portfolio before change:  [9.50879743]
curr_Stock_Price:  96.79421086044569
curr_Factors:  [96.79421086]
mat_Sqrt:  [[0.15]]
grads:  [0.07220367]
Stock Position:  0.07220366561669812
Bond Position:  [2.5199006]


portfolio before change:  [9.45275768]
curr_Stock_Price:  96.01589504409553
curr_Factors:  [96.01589504]
mat_Sqrt:  [[0.15]]
grads:  [0.10864246]
Stock Position:  0.10864246392178546
Bond Position:  [-0.97864573]


portfolio before change:  [9.54787554]
curr_Stock_Price:  96.89197078084057
curr_Factors:  [96.89197078]
mat_Sqrt:  [[0.15]]
grads:  [0.07651301]
Stock Position:  0.07651301079889972
Bond Position:  [2.13437913]


portfolio before change:  [9.52443902]
curr_Stock_Price:  96.58391968873039
curr_Factors:  [96.58391969]
mat_Sqrt:  [[0.15]]
grads:  [0.00653525]
Stock Position:  0.006535247341709002
Bond Position:  [8.89323922]


portfolio before change:  [9.52226492]
curr_Stock_Price:  96.16619318258817
curr_Factors:  [96.16619318]
mat_Sqrt:  [[0.15]]
grads:  [0.08310094]
Stock Position:  0.08310094207948276
Bond Position:  [1.53076367]


portfolio before change:  [9.61671699]
curr_Stock_Price:  97.30163622699156
curr_Factors:  [97.30163623]
mat_Sqrt:  [[0.15]]
grads:  [0.08438013]
Stock Position:  0.08438013251512735
Bond Position:  [1.40639203]


portfolio before change:  [9.57685416]
curr_Stock_Price:  96.82817496942968
curr_Factors:  [96.82817497]
mat_Sqrt:  [[0.15]]
grads:  [-0.06972899]
Stock Position:  -0.06972899184399495
Bond Position:  [16.32858519]


portfolio before change:  [9.58218599]
curr_Stock_Price:  96.76634615135549
curr_Factors:  [96.76634615]
mat_Sqrt:  [[0.15]]
grads:  [0.01827529]
Stock Position:  0.018275288099762213
Bond Position:  [7.81375314]


portfolio before change:  [9.58483914]
curr_Stock_Price:  96.88479968024319
curr_Factors:  [96.88479968]
mat_Sqrt:  [[0.15]]
grads:  [-0.25081486]
Stock Position:  -0.25081486073347836
Bond Position:  [33.88498668]


portfolio before change:  [9.66040604]
curr_Stock_Price:  96.59195808430604
curr_Factors:  [96.59195808]
mat_Sqrt:  [[0.15]]
grads:  [-0.07699391]
Stock Position:  -0.07699391051416286
Bond Position:  [17.09739862]


portfolio before change:  [9.66469735]
curr_Stock_Price:  96.55010175817472
curr_Factors:  [96.55010176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02139353]
Stock Position:  -0.021393534105402397
Bond Position:  [11.73024524]


portfolio before change:  [9.65248569]
curr_Stock_Price:  97.1551827944426
curr_Factors:  [97.15518279]
mat_Sqrt:  [[0.15]]
grads:  [-0.00939089]
Stock Position:  -0.009390892514925971
Bond Position:  [10.56485957]


portfolio before change:  [9.6551966]
curr_Stock_Price:  96.93682340118733
curr_Factors:  [96.9368234]
mat_Sqrt:  [[0.15]]
grads:  [0.06656174]
Stock Position:  0.06656173621623845
Bond Position:  [3.20291333]


portfolio before change:  [9.61981152]
curr_Stock_Price:  96.4022029151692
curr_Factors:  [96.40220292]
mat_Sqrt:  [[0.15]]
grads:  [-0.29244319]
Stock Position:  -0.2924431926604519
Bond Position:  [37.81197952]


portfolio before change:  [9.43488555]
curr_Stock_Price:  97.04263257251314
curr_Factors:  [97.04263257]
mat_Sqrt:  [[0.15]]
grads:  [0.01895135]
Stock Position:  0.01895134955844019
Bond Position:  [7.5957967]


portfolio before change:  [9.43857688]
curr_Stock_Price:  97.21236083718469
curr_Factors:  [97.21236084]
mat_Sqrt:  [[0.15]]
grads:  [0.02336791]
Stock Position:  0.023367913985658316
Bond Position:  [7.1669268]


portfolio before change:  [9.44177239]
curr_Stock_Price:  97.32993901171696
curr_Factors:  [97.32993901]
mat_Sqrt:  [[0.15]]
grads:  [-0.06709149]
Stock Position:  -0.06709149221658128
Bond Position:  [15.97178323]


portfolio before change:  [9.48186534]
curr_Stock_Price:  96.74723190055988
curr_Factors:  [96.7472319]
mat_Sqrt:  [[0.15]]
grads:  [-0.05172812]
Stock Position:  -0.05172812104989873
Bond Position:  [14.48641787]


portfolio before change:  [9.49952167]
curr_Stock_Price:  96.42340616056347
curr_Factors:  [96.42340616]
mat_Sqrt:  [[0.15]]
grads:  [0.03920839]
Stock Position:  0.03920839151436499
Bond Position:  [5.71891501]


portfolio before change:  [9.49441237]
curr_Stock_Price:  96.283978159414
curr_Factors:  [96.28397816]
mat_Sqrt:  [[0.15]]
grads:  [0.09176657]
Stock Position:  0.09176657049037117
Bond Position:  [0.6587619]


portfolio before change:  [9.51499593]
curr_Stock_Price:  96.50783301887262
curr_Factors:  [96.50783302]
mat_Sqrt:  [[0.15]]
grads:  [0.06542513]
Stock Position:  0.06542512501293558
Bond Position:  [3.20095889]


portfolio before change:  [9.4736407]
curr_Stock_Price:  95.87267491315855
curr_Factors:  [95.87267491]
mat_Sqrt:  [[0.15]]
grads:  [-0.21409261]
Stock Position:  -0.21409261350546493
Bond Position:  [29.99927224]


portfolio before change:  [9.44796044]
curr_Stock_Price:  96.0013821717217
curr_Factors:  [96.00138217]
mat_Sqrt:  [[0.15]]
grads:  [0.05374547]
Stock Position:  0.05374547172264236
Bond Position:  [4.28832087]


portfolio before change:  [9.42337366]
curr_Stock_Price:  95.53892818078623
curr_Factors:  [95.53892818]
mat_Sqrt:  [[0.15]]
grads:  [-0.26742017]
Stock Position:  -0.26742016521725887
Bond Position:  [34.97240962]


portfolio before change:  [9.6201911]
curr_Stock_Price:  94.81111623368336
curr_Factors:  [94.81111623]
mat_Sqrt:  [[0.15]]
grads:  [-0.03185491]
Stock Position:  -0.03185490835622166
Bond Position:  [12.64039051]


portfolio before change:  [9.63929256]
curr_Stock_Price:  94.23627797666303
curr_Factors:  [94.23627798]
mat_Sqrt:  [[0.15]]
grads:  [-0.10339267]
Stock Position:  -0.10339266809723627
Bond Position:  [19.38263278]


portfolio before change:  [9.72513049]
curr_Stock_Price:  93.41778208781999
curr_Factors:  [93.41778209]
mat_Sqrt:  [[0.15]]
grads:  [0.47629815]
Stock Position:  0.47629815381981877
Bond Position:  [-34.76958665]


portfolio before change:  [10.02133512]
curr_Stock_Price:  94.04423380189144
curr_Factors:  [94.0442338]
mat_Sqrt:  [[0.15]]
grads:  [0.15676006]
Stock Position:  0.15676005504728793
Bond Position:  [-4.72104415]


portfolio before change:  [10.01025535]
curr_Stock_Price:  93.97543631729086
curr_Factors:  [93.97543632]
mat_Sqrt:  [[0.15]]
grads:  [0.01960246]
Stock Position:  0.019602458046085177
Bond Position:  [8.1681058]


portfolio before change:  [9.99021832]
curr_Stock_Price:  92.92722319967577
curr_Factors:  [92.9272232]
mat_Sqrt:  [[0.15]]
grads:  [0.09493182]
Stock Position:  0.094931821899813
Bond Position:  [1.16846771]


portfolio before change:  [10.04186421]
curr_Stock_Price:  93.47048536886773
curr_Factors:  [93.47048537]
mat_Sqrt:  [[0.15]]
grads:  [0.22443388]
Stock Position:  0.22443388219332336
Bond Position:  [-10.93607969]


portfolio before change:  [10.14550626]
curr_Stock_Price:  93.93532414924236
curr_Factors:  [93.93532415]
mat_Sqrt:  [[0.15]]
grads:  [-0.02455555]
Stock Position:  -0.024555547213774797
Bond Position:  [12.45213955]


portfolio before change:  [10.14478466]
curr_Stock_Price:  93.99640524954721
curr_Factors:  [93.99640525]
mat_Sqrt:  [[0.15]]
grads:  [-0.00869305]
Stock Position:  -0.008693054161391742
Bond Position:  [10.96190051]


portfolio before change:  [10.15233462]
curr_Stock_Price:  93.20671595235646
curr_Factors:  [93.20671595]
mat_Sqrt:  [[0.15]]
grads:  [0.21456165]
Stock Position:  0.21456164895494165
Bond Position:  [-9.84625205]


portfolio before change:  [10.01593656]
curr_Stock_Price:  92.57387851596816
curr_Factors:  [92.57387852]
mat_Sqrt:  [[0.15]]
grads:  [0.06586906]
Stock Position:  0.06586905841773455
Bond Position:  [3.91818235]


portfolio before change:  [10.00588637]
curr_Stock_Price:  92.41758225370654
curr_Factors:  [92.41758225]
mat_Sqrt:  [[0.15]]
grads:  [0.15004367]
Stock Position:  0.15004366501485503
Bond Position:  [-3.86078639]


portfolio before change:  [9.97563054]
curr_Stock_Price:  92.21754369248605
curr_Factors:  [92.21754369]
mat_Sqrt:  [[0.15]]
grads:  [0.15342512]
Stock Position:  0.1534251237681331
Bond Position:  [-4.17285751]


portfolio before change:  [10.02401835]
curr_Stock_Price:  92.53462746802721
curr_Factors:  [92.53462747]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144133]
Stock Position:  -0.01144132526327004
Bond Position:  [11.08273712]


portfolio before change:  [10.0103357]
curr_Stock_Price:  93.79106729687712
curr_Factors:  [93.7910673]
mat_Sqrt:  [[0.15]]
grads:  [0.02939749]
Stock Position:  0.029397490595576895
Bond Position:  [7.25311369]


portfolio before change:  [9.98317649]
curr_Stock_Price:  92.85178477785526
curr_Factors:  [92.85178478]
mat_Sqrt:  [[0.15]]
grads:  [0.03060057]
Stock Position:  0.030600571531020974
Bond Position:  [7.14185881]


portfolio before change:  [10.00280085]
curr_Stock_Price:  93.47850432263775
curr_Factors:  [93.47850432]
mat_Sqrt:  [[0.15]]
grads:  [0.03673992]
Stock Position:  0.03673991850732812
Bond Position:  [6.56840821]


portfolio before change:  [10.0017526]
curr_Stock_Price:  93.43879876989325
curr_Factors:  [93.43879877]
mat_Sqrt:  [[0.15]]
grads:  [-0.15447205]
Stock Position:  -0.15447205305083891
Bond Position:  [24.43543569]


portfolio before change:  [10.03841293]
curr_Stock_Price:  93.21135918522796
curr_Factors:  [93.21135919]
mat_Sqrt:  [[0.15]]
grads:  [0.00604354]
Stock Position:  0.006043539664361431
Bond Position:  [9.47508638]


portfolio before change:  [10.04354265]
curr_Stock_Price:  93.96216219684827
curr_Factors:  [93.9621622]
mat_Sqrt:  [[0.15]]
grads:  [0.0107208]
Stock Position:  0.0107208024073834
Bond Position:  [9.03619287]


portfolio before change:  [10.04077368]
curr_Stock_Price:  93.6512013601243
curr_Factors:  [93.65120136]
mat_Sqrt:  [[0.15]]
grads:  [-0.66015668]
Stock Position:  -0.6601566780385931
Bond Position:  [71.86523966]


portfolio before change:  [9.75931489]
curr_Stock_Price:  94.0843568663706
curr_Factors:  [94.08435687]
mat_Sqrt:  [[0.15]]
grads:  [-0.09102468]
Stock Position:  -0.09102467906485823
Bond Position:  [18.32331328]


portfolio before change:  [9.85608491]
curr_Stock_Price:  93.03382005032701
curr_Factors:  [93.03382005]
mat_Sqrt:  [[0.15]]
grads:  [0.11583084]
Stock Position:  0.11583084210094434
Bond Position:  [-0.92010081]


portfolio before change:  [9.81914722]
curr_Stock_Price:  92.71542309185584
curr_Factors:  [92.71542309]
mat_Sqrt:  [[0.15]]
grads:  [0.12308168]
Stock Position:  0.12308167800906818
Bond Position:  [-1.59242263]


portfolio before change:  [9.90965551]
curr_Stock_Price:  93.45158322634066
curr_Factors:  [93.45158323]
mat_Sqrt:  [[0.15]]
grads:  [-0.13194081]
Stock Position:  -0.1319408131790921
Bond Position:  [22.2397334]


portfolio before change:  [9.94615683]
curr_Stock_Price:  93.18546930547849
curr_Factors:  [93.18546931]
mat_Sqrt:  [[0.15]]
grads:  [-0.03191142]
Stock Position:  -0.031911418306540124
Bond Position:  [12.91983732]


portfolio before change:  [9.96134992]
curr_Stock_Price:  92.73467203229713
curr_Factors:  [92.73467203]
mat_Sqrt:  [[0.15]]
grads:  [-0.11460669]
Stock Position:  -0.11460669144191335
Bond Position:  [20.58936387]


portfolio before change:  [10.01373956]
curr_Stock_Price:  92.28877514156447
curr_Factors:  [92.28877514]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255946]
Stock Position:  -0.022559456785726392
Bond Position:  [12.0957242]


portfolio before change:  [10.01457598]
curr_Stock_Price:  92.2852109253505
curr_Factors:  [92.28521093]
mat_Sqrt:  [[0.15]]
grads:  [-0.07716939]
Stock Position:  -0.07716939149865715
Bond Position:  [17.13616955]


portfolio before change:  [9.97975784]
curr_Stock_Price:  92.75028103899454
curr_Factors:  [92.75028104]
mat_Sqrt:  [[0.15]]
grads:  [-0.14417974]
Stock Position:  -0.1441797357343575
Bond Position:  [23.35246885]


portfolio before change:  [9.92550188]
curr_Stock_Price:  93.13671215752521
curr_Factors:  [93.13671216]
mat_Sqrt:  [[0.15]]
grads:  [0.10701374]
Stock Position:  0.10701374399807095
Bond Position:  [-0.04140639]


portfolio before change:  [9.92000268]
curr_Stock_Price:  93.08534848567228
curr_Factors:  [93.08534849]
mat_Sqrt:  [[0.15]]
grads:  [0.08329259]
Stock Position:  0.0832925881385613
Bond Position:  [2.16668308]


portfolio before change:  [9.86300962]
curr_Stock_Price:  92.39947137065751
curr_Factors:  [92.39947137]
mat_Sqrt:  [[0.15]]
grads:  [0.08788652]
Stock Position:  0.08788651667174234
Bond Position:  [1.74234194]


portfolio before change:  [9.8491534]
curr_Stock_Price:  92.24057189130383
curr_Factors:  [92.24057189]
mat_Sqrt:  [[0.15]]
grads:  [0.01255783]
Stock Position:  0.01255783105354586
Bond Position:  [8.69081188]


portfolio before change:  [9.84145415]
curr_Stock_Price:  91.58421324100125
curr_Factors:  [91.58421324]
mat_Sqrt:  [[0.15]]
grads:  [0.06288364]
Stock Position:  0.06288363575100386
Bond Position:  [4.08230584]


portfolio before change:  [9.81919568]
curr_Stock_Price:  91.22619287635942
curr_Factors:  [91.22619288]
mat_Sqrt:  [[0.15]]
grads:  [0.21153755]
Stock Position:  0.21153755437275398
Bond Position:  [-9.47857006]


portfolio before change:  [9.89862301]
curr_Stock_Price:  91.60446972587698
curr_Factors:  [91.60446973]
mat_Sqrt:  [[0.15]]
grads:  [-0.1806829]
Stock Position:  -0.1806828997528201
Bond Position:  [26.44998423]


portfolio before change:  [10.11993836]
curr_Stock_Price:  90.38873662721394
curr_Factors:  [90.38873663]
mat_Sqrt:  [[0.15]]
grads:  [0.02605676]
Stock Position:  0.0260567554813347
Bond Position:  [7.76470116]


portfolio before change:  [10.1048329]
curr_Stock_Price:  89.79039748112899
curr_Factors:  [89.79039748]
mat_Sqrt:  [[0.15]]
grads:  [0.085525]
Stock Position:  0.08552499537623143
Bond Position:  [2.42550957]


portfolio before change:  [10.11274861]
curr_Stock_Price:  89.88117923933417
curr_Factors:  [89.88117924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.11274861]
Stock Price:  90.05411148131985
PL:  [10.11274861]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.96870143e-04]
 [ 2.18447633e-03]
 [-2.01646024e-03]
 [ 3.47285992e-03]
 [ 1.15911709e-02]
 [ 2.59001986e-02]
 [ 1.27237860e-03]
 [-7.76716012e-03]
 [ 2.33839461e-02]
 [-4.52800982e-03]
 [ 3.11432246e-02]
 [ 2.66753427e-02]
 [ 1.17362055e-01]
 [ 1.44480713e-02]
 [-6.89253789e-03]
 [ 3.33638230e-02]
 [ 1.49384364e-02]
 [ 5.90606564e-03]
 [ 1.54233794e-02]
 [-1.12054376e-02]
 [ 1.52768697e-02]
 [-1.59233476e-02]
 [ 1.05187694e-02]
 [-6.81519231e-02]
 [ 1.16178397e-02]
 [ 5.87787861e-03]
 [-3.93075865e-03]
 [ 1.93236078e-02]
 [ 6.72764307e-02]
 [ 1.13189667e-02]
 [ 2.47256376e-02]
 [ 2.50361916e-02]
 [-9.37885833e-03]
 [ 5.98641307e-03]
 [ 9.24153685e-03]
 [ 9.34026641e-05]
 [-3.06907319e-02]
 [ 8.18445340e-03]
 [ 2.30535055e-02]
 [-2.11598326e-02]
 [-9.15763500e-03]
 [-1.14420069e-02]
 [ 1.96092203e-02]
 [-9.67446189e-03]
 [ 2.97215063e-02]
 [ 1.94149481e-03]
 [ 1.57913116e-02]
 [ 3.45589152e-02]
 [ 1.35856600e-02]
 [-7.93632478e-03]
 [ 8.24110394e-02]
 [ 1.68719184e-02]
 [-1.18010122e-02]
 [ 5.62935765e-03]
 [-2.72206621e-02]
 [ 3.76931772e-02]
 [ 1.94892502e-02]
 [ 2.94664225e-03]
 [ 2.13450994e-03]
 [-5.29734399e-03]
 [ 2.07839072e-02]
 [ 5.02960672e-02]
 [-4.01143040e-03]
 [-1.21449925e-02]
 [ 1.62866693e-02]
 [ 7.08536991e-03]
 [-5.28824752e-03]
 [ 1.54465934e-02]
 [-9.96472834e-03]
 [-1.69876103e-02]
 [-1.06670757e-02]
 [ 1.48952861e-02]
 [-1.70509115e-02]
 [ 2.69158897e-02]
 [-2.56196510e-02]
 [ 3.17891319e-03]
 [ 4.60586667e-03]
 [-1.31955922e-02]
 [ 2.40639185e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.17394318]
curr_Stock_Price:  100.13865703963442
curr_Factors:  [100.13865704]
mat_Sqrt:  [[0.15]]
grads:  [0.00597913]
Stock Position:  0.005979134286957031
Bond Position:  [3.57520071]


portfolio before change:  [4.17691384]
curr_Stock_Price:  100.59812128352459
curr_Factors:  [100.59812128]
mat_Sqrt:  [[0.15]]
grads:  [0.01456318]
Stock Position:  0.014563175516385824
Bond Position:  [2.71188574]


portfolio before change:  [4.1753693]
curr_Stock_Price:  100.48042459726055
curr_Factors:  [100.4804246]
mat_Sqrt:  [[0.15]]
grads:  [-0.01344307]
Stock Position:  -0.013443068272509946
Bond Position:  [5.52613451]


portfolio before change:  [4.16598279]
curr_Stock_Price:  101.2043593272596
curr_Factors:  [101.20435933]
mat_Sqrt:  [[0.15]]
grads:  [0.0231524]
Stock Position:  0.023152399498805473
Bond Position:  [1.82285903]


portfolio before change:  [4.16157334]
curr_Stock_Price:  101.00898491178647
curr_Factors:  [101.00898491]
mat_Sqrt:  [[0.15]]
grads:  [0.07727447]
Stock Position:  0.07727447246542118
Bond Position:  [-3.64384269]


portfolio before change:  [4.10457055]
curr_Stock_Price:  100.27426575545009
curr_Factors:  [100.27426576]
mat_Sqrt:  [[0.15]]
grads:  [0.17266799]
Stock Position:  0.17266799078407985
Bond Position:  [-13.20958544]


portfolio before change:  [4.14280424]
curr_Stock_Price:  100.50047624978838
curr_Factors:  [100.50047625]
mat_Sqrt:  [[0.15]]
grads:  [0.00848252]
Stock Position:  0.00848252402784936
Bond Position:  [3.29030654]


portfolio before change:  [4.14717287]
curr_Stock_Price:  100.99124732995054
curr_Factors:  [100.99124733]
mat_Sqrt:  [[0.15]]
grads:  [-0.05178107]
Stock Position:  -0.05178106744463716
Bond Position:  [9.37660746]


portfolio before change:  [4.12923394]
curr_Stock_Price:  101.34900330130995
curr_Factors:  [101.3490033]
mat_Sqrt:  [[0.15]]
grads:  [0.15589297]
Stock Position:  0.15589297370811542
Bond Position:  [-11.67036357]


portfolio before change:  [4.14019178]
curr_Stock_Price:  101.42397309167062
curr_Factors:  [101.42397309]
mat_Sqrt:  [[0.15]]
grads:  [-0.03018673]
Stock Position:  -0.030186732152620695
Bond Position:  [7.20185009]


portfolio before change:  [4.12652718]
curr_Stock_Price:  101.89155363698238
curr_Factors:  [101.89155364]
mat_Sqrt:  [[0.15]]
grads:  [0.2076215]
Stock Position:  0.20762149706053606
Bond Position:  [-17.02834972]


portfolio before change:  [4.32980114]
curr_Stock_Price:  102.87574006378759
curr_Factors:  [102.87574006]
mat_Sqrt:  [[0.15]]
grads:  [0.17783562]
Stock Position:  0.17783561814286752
Bond Position:  [-13.96516969]


portfolio before change:  [4.41574466]
curr_Stock_Price:  103.36392333453068
curr_Factors:  [103.36392333]
mat_Sqrt:  [[0.15]]
grads:  [0.7824137]
Stock Position:  0.7824136966931348
Bond Position:  [-76.4576047]


portfolio before change:  [4.14891287]
curr_Stock_Price:  103.02899432762409
curr_Factors:  [103.02899433]
mat_Sqrt:  [[0.15]]
grads:  [0.09632048]
Stock Position:  0.09632047511623602
Bond Position:  [-5.77488882]


portfolio before change:  [4.22659402]
curr_Stock_Price:  103.83922801687969
curr_Factors:  [103.83922802]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595025]
Stock Position:  -0.045950252585489446
Bond Position:  [8.99803278]


portfolio before change:  [4.2198316]
curr_Stock_Price:  103.99863546424578
curr_Factors:  [103.99863546]
mat_Sqrt:  [[0.15]]
grads:  [0.22242549]
Stock Position:  0.22242548634774428
Bond Position:  [-18.91211547]


portfolio before change:  [4.2446957]
curr_Stock_Price:  104.11573598356017
curr_Factors:  [104.11573598]
mat_Sqrt:  [[0.15]]
grads:  [0.09958958]
Stock Position:  0.09958957573171333
Bond Position:  [-6.12414627]


portfolio before change:  [4.28445801]
curr_Stock_Price:  104.51884128355454
curr_Factors:  [104.51884128]
mat_Sqrt:  [[0.15]]
grads:  [0.03937377]
Stock Position:  0.03937377090229714
Bond Position:  [0.1691571]


portfolio before change:  [4.28903607]
curr_Stock_Price:  104.63484456597307
curr_Factors:  [104.63484457]
mat_Sqrt:  [[0.15]]
grads:  [0.10282253]
Stock Position:  0.10282252948079927
Bond Position:  [-6.46978332]


portfolio before change:  [4.33218435]
curr_Stock_Price:  105.05841569193068
curr_Factors:  [105.05841569]
mat_Sqrt:  [[0.15]]
grads:  [-0.07470292]
Stock Position:  -0.07470291735106642
Bond Position:  [12.1803545]


portfolio before change:  [4.35313329]
curr_Stock_Price:  104.7881766895802
curr_Factors:  [104.78817669]
mat_Sqrt:  [[0.15]]
grads:  [0.1018458]
Stock Position:  0.101845798006649
Bond Position:  [-6.31910219]


portfolio before change:  [4.32476366]
curr_Stock_Price:  104.51349995615013
curr_Factors:  [104.51349996]
mat_Sqrt:  [[0.15]]
grads:  [-0.10615565]
Stock Position:  -0.10615565045059533
Bond Position:  [15.41946223]


portfolio before change:  [4.32052382]
curr_Stock_Price:  104.56251842426855
curr_Factors:  [104.56251842]
mat_Sqrt:  [[0.15]]
grads:  [0.07012513]
Stock Position:  0.07012512907607055
Bond Position:  [-3.01193628]


portfolio before change:  [4.32659761]
curr_Stock_Price:  104.65181647330782
curr_Factors:  [104.65181647]
mat_Sqrt:  [[0.15]]
grads:  [-0.45434615]
Stock Position:  -0.45434615374551746
Bond Position:  [51.87474791]


portfolio before change:  [4.17863994]
curr_Stock_Price:  104.98460226330494
curr_Factors:  [104.98460226]
mat_Sqrt:  [[0.15]]
grads:  [0.07745226]
Stock Position:  0.07745226489334472
Bond Position:  [-3.95265529]


portfolio before change:  [4.18923786]
curr_Stock_Price:  105.12462357931872
curr_Factors:  [105.12462358]
mat_Sqrt:  [[0.15]]
grads:  [0.03918586]
Stock Position:  0.039185857369310614
Bond Position:  [0.06983935]


portfolio before change:  [4.18709069]
curr_Stock_Price:  105.06971764478766
curr_Factors:  [105.06971764]
mat_Sqrt:  [[0.15]]
grads:  [-0.02620506]
Stock Position:  -0.02620505765659125
Bond Position:  [6.94044869]


portfolio before change:  [4.19465627]
curr_Stock_Price:  104.7975643321005
curr_Factors:  [104.79756433]
mat_Sqrt:  [[0.15]]
grads:  [0.12882405]
Stock Position:  0.1288240521027767
Bond Position:  [-9.30579062]


portfolio before change:  [4.27270973]
curr_Stock_Price:  105.4079712187485
curr_Factors:  [105.40797122]
mat_Sqrt:  [[0.15]]
grads:  [0.44850954]
Stock Position:  0.4485095383276422
Bond Position:  [-43.00377078]


portfolio before change:  [4.60767323]
curr_Stock_Price:  106.1608009637264
curr_Factors:  [106.16080096]
mat_Sqrt:  [[0.15]]
grads:  [0.07545978]
Stock Position:  0.07545977809805682
Bond Position:  [-3.40319725]


portfolio before change:  [4.66489471]
curr_Stock_Price:  106.92192417518079
curr_Factors:  [106.92192418]
mat_Sqrt:  [[0.15]]
grads:  [0.16483758]
Stock Position:  0.16483758426062867
Bond Position:  [-12.95985697]


portfolio before change:  [4.88955265]
curr_Stock_Price:  108.28974300643455
curr_Factors:  [108.28974301]
mat_Sqrt:  [[0.15]]
grads:  [0.16690794]
Stock Position:  0.16690794374571563
Bond Position:  [-13.18486569]


portfolio before change:  [4.89038916]
curr_Stock_Price:  108.29969217099148
curr_Factors:  [108.29969217]
mat_Sqrt:  [[0.15]]
grads:  [-0.06252572]
Stock Position:  -0.06252572217951684
Bond Position:  [11.66190563]


portfolio before change:  [4.91430198]
curr_Stock_Price:  107.92890191207175
curr_Factors:  [107.92890191]
mat_Sqrt:  [[0.15]]
grads:  [0.03990942]
Stock Position:  0.03990942046106812
Bond Position:  [0.60692206]


portfolio before change:  [4.93775493]
curr_Stock_Price:  108.51560573247448
curr_Factors:  [108.51560573]
mat_Sqrt:  [[0.15]]
grads:  [0.06161025]
Stock Position:  0.061610245691404955
Bond Position:  [-1.7479182]


portfolio before change:  [4.90426484]
curr_Stock_Price:  107.97379912482448
curr_Factors:  [107.97379912]
mat_Sqrt:  [[0.15]]
grads:  [0.00062268]
Stock Position:  0.0006226844272162515
Bond Position:  [4.83703124]


portfolio before change:  [4.90455148]
curr_Stock_Price:  107.94860521303094
curr_Factors:  [107.94860521]
mat_Sqrt:  [[0.15]]
grads:  [-0.20460488]
Stock Position:  -0.20460487908870872
Bond Position:  [26.99136279]


portfolio before change:  [4.99514237]
curr_Stock_Price:  107.51409026349454
curr_Factors:  [107.51409026]
mat_Sqrt:  [[0.15]]
grads:  [0.05456302]
Stock Position:  0.0545630226788885
Bond Position:  [-0.87115138]


portfolio before change:  [4.96106066]
curr_Stock_Price:  106.8904579824205
curr_Factors:  [106.89045798]
mat_Sqrt:  [[0.15]]
grads:  [0.15369004]
Stock Position:  0.15369003694746453
Bond Position:  [-11.46693778]


portfolio before change:  [5.00428527]
curr_Stock_Price:  107.17636668353593
curr_Factors:  [107.17636668]
mat_Sqrt:  [[0.15]]
grads:  [-0.14106555]
Stock Position:  -0.14106555059837042
Bond Position:  [20.12317845]


portfolio before change:  [4.97789541]
curr_Stock_Price:  107.37235781179079
curr_Factors:  [107.37235781]
mat_Sqrt:  [[0.15]]
grads:  [-0.0610509]
Stock Position:  -0.061050899968619926
Bond Position:  [11.53307449]


portfolio before change:  [5.02341581]
curr_Stock_Price:  106.63855115927569
curr_Factors:  [106.63855116]
mat_Sqrt:  [[0.15]]
grads:  [-0.07628005]
Stock Position:  -0.0762800457892744
Bond Position:  [13.15780937]


portfolio before change:  [4.99506286]
curr_Stock_Price:  107.0210278063863
curr_Factors:  [107.02102781]
mat_Sqrt:  [[0.15]]
grads:  [0.13072814]
Stock Position:  0.13072813545278317
Bond Position:  [-8.99559656]


portfolio before change:  [5.10715484]
curr_Stock_Price:  107.88277210157895
curr_Factors:  [107.8827721]
mat_Sqrt:  [[0.15]]
grads:  [-0.06449641]
Stock Position:  -0.06449641260917623
Bond Position:  [12.06520663]


portfolio before change:  [5.10324347]
curr_Stock_Price:  107.95510899730058
curr_Factors:  [107.955109]
mat_Sqrt:  [[0.15]]
grads:  [0.19814338]
Stock Position:  0.1981433751237624
Bond Position:  [-16.28734619]


portfolio before change:  [5.20413592]
curr_Stock_Price:  108.4694357621377
curr_Factors:  [108.46943576]
mat_Sqrt:  [[0.15]]
grads:  [0.0129433]
Stock Position:  0.01294329870538696
Bond Position:  [3.80018361]


portfolio before change:  [5.20326488]
curr_Stock_Price:  108.38378863291096
curr_Factors:  [108.38378863]
mat_Sqrt:  [[0.15]]
grads:  [0.10527541]
Stock Position:  0.10527541047920981
Bond Position:  [-6.20688295]


portfolio before change:  [5.14659939]
curr_Stock_Price:  107.84921406708993
curr_Factors:  [107.84921407]
mat_Sqrt:  [[0.15]]
grads:  [0.23039277]
Stock Position:  0.23039276804571515
Bond Position:  [-19.70107957]


portfolio before change:  [5.15876438]
curr_Stock_Price:  107.90735976651156
curr_Factors:  [107.90735977]
mat_Sqrt:  [[0.15]]
grads:  [0.09057107]
Stock Position:  0.09057106695206273
Bond Position:  [-4.61452033]


portfolio before change:  [5.19972788]
curr_Stock_Price:  108.36282436541842
curr_Factors:  [108.36282437]
mat_Sqrt:  [[0.15]]
grads:  [-0.05290883]
Stock Position:  -0.05290883188028956
Bond Position:  [10.93307833]


portfolio before change:  [5.17742334]
curr_Stock_Price:  108.79730532257219
curr_Factors:  [108.79730532]
mat_Sqrt:  [[0.15]]
grads:  [0.54940693]
Stock Position:  0.549406929178463
Bond Position:  [-54.59657008]


portfolio before change:  [4.99783587]
curr_Stock_Price:  108.47664122704113
curr_Factors:  [108.47664123]
mat_Sqrt:  [[0.15]]
grads:  [0.11247946]
Stock Position:  0.1124794558257182
Bond Position:  [-7.20355771]


portfolio before change:  [5.01763331]
curr_Stock_Price:  108.65665348529282
curr_Factors:  [108.65665349]
mat_Sqrt:  [[0.15]]
grads:  [-0.07867341]
Stock Position:  -0.07867341445412959
Bond Position:  [13.56602324]


portfolio before change:  [4.98857361]
curr_Stock_Price:  109.03680230735695
curr_Factors:  [109.03680231]
mat_Sqrt:  [[0.15]]
grads:  [0.03752905]
Stock Position:  0.037529051000565014
Bond Position:  [0.89652589]


portfolio before change:  [4.96335795]
curr_Stock_Price:  108.36341224992164
curr_Factors:  [108.36341225]
mat_Sqrt:  [[0.15]]
grads:  [-0.18147108]
Stock Position:  -0.18147108057716413
Bond Position:  [24.62818347]


portfolio before change:  [5.06277124]
curr_Stock_Price:  107.82407574135361
curr_Factors:  [107.82407574]
mat_Sqrt:  [[0.15]]
grads:  [0.25128785]
Stock Position:  0.251287848229329
Bond Position:  [-22.03210874]


portfolio before change:  [5.17417752]
curr_Stock_Price:  108.27289698253928
curr_Factors:  [108.27289698]
mat_Sqrt:  [[0.15]]
grads:  [0.12992833]
Stock Position:  0.12992833483638547
Bond Position:  [-8.8935397]


portfolio before change:  [5.27001055]
curr_Stock_Price:  109.01475898771493
curr_Factors:  [109.01475899]
mat_Sqrt:  [[0.15]]
grads:  [0.01964428]
Stock Position:  0.019644281645302804
Bond Position:  [3.12849392]


portfolio before change:  [5.26114815]
curr_Stock_Price:  108.55366118922674
curr_Factors:  [108.55366119]
mat_Sqrt:  [[0.15]]
grads:  [0.01423007]
Stock Position:  0.014230066266916174
Bond Position:  [3.71642236]


portfolio before change:  [5.25970256]
curr_Stock_Price:  108.43575073759047
curr_Factors:  [108.43575074]
mat_Sqrt:  [[0.15]]
grads:  [-0.03531563]
Stock Position:  -0.03531562659980811
Bond Position:  [9.08917904]


portfolio before change:  [5.29443195]
curr_Stock_Price:  107.46843690483747
curr_Factors:  [107.4684369]
mat_Sqrt:  [[0.15]]
grads:  [0.13855938]
Stock Position:  0.1385593814965808
Bond Position:  [-9.5963282]


portfolio before change:  [5.33666065]
curr_Stock_Price:  107.77753540071073
curr_Factors:  [107.7775354]
mat_Sqrt:  [[0.15]]
grads:  [0.33530711]
Stock Position:  0.3353071149107286
Bond Position:  [-30.8019138]


portfolio before change:  [5.11808675]
curr_Stock_Price:  107.13141513522585
curr_Factors:  [107.13141514]
mat_Sqrt:  [[0.15]]
grads:  [-0.02674287]
Stock Position:  -0.02674286933355191
Bond Position:  [7.98308819]


portfolio before change:  [5.13929664]
curr_Stock_Price:  106.35696831717387
curr_Factors:  [106.35696832]
mat_Sqrt:  [[0.15]]
grads:  [-0.08096662]
Stock Position:  -0.0809666168173359
Bond Position:  [13.75066054]


portfolio before change:  [5.14568333]
curr_Stock_Price:  106.28870255784759
curr_Factors:  [106.28870256]
mat_Sqrt:  [[0.15]]
grads:  [0.1085778]
Stock Position:  0.10857779529209181
Bond Position:  [-6.39490966]


portfolio before change:  [5.07027609]
curr_Stock_Price:  105.59788413702165
curr_Factors:  [105.59788414]
mat_Sqrt:  [[0.15]]
grads:  [0.0472358]
Stock Position:  0.047235799398089307
Bond Position:  [0.08227562]


portfolio before change:  [5.02776763]
curr_Stock_Price:  104.69785481238436
curr_Factors:  [104.69785481]
mat_Sqrt:  [[0.15]]
grads:  [-0.03525498]
Stock Position:  -0.03525498347553201
Bond Position:  [8.71888877]


portfolio before change:  [5.00402619]
curr_Stock_Price:  105.38673300488304
curr_Factors:  [105.386733]
mat_Sqrt:  [[0.15]]
grads:  [0.10297729]
Stock Position:  0.10297728938056912
Bond Position:  [-5.84841391]


portfolio before change:  [4.97588202]
curr_Stock_Price:  105.11697803600423
curr_Factors:  [105.11697804]
mat_Sqrt:  [[0.15]]
grads:  [-0.06643152]
Stock Position:  -0.06643152224528401
Bond Position:  [11.95896288]


portfolio before change:  [4.94885248]
curr_Stock_Price:  105.53510774939328
curr_Factors:  [105.53510775]
mat_Sqrt:  [[0.15]]
grads:  [-0.11325074]
Stock Position:  -0.11325073519107434
Bond Position:  [16.90078102]


portfolio before change:  [4.92233632]
curr_Stock_Price:  105.77857191103584
curr_Factors:  [105.77857191]
mat_Sqrt:  [[0.15]]
grads:  [-0.07111384]
Stock Position:  -0.07111383801553293
Bond Position:  [12.44465655]


portfolio before change:  [4.8998279]
curr_Stock_Price:  106.10602202356661
curr_Factors:  [106.10602202]
mat_Sqrt:  [[0.15]]
grads:  [0.09930191]
Stock Position:  0.09930190733314831
Bond Position:  [-5.63670247]


portfolio before change:  [4.89173556]
curr_Stock_Price:  106.02807755538186
curr_Factors:  [106.02807756]
mat_Sqrt:  [[0.15]]
grads:  [-0.11367274]
Stock Position:  -0.11367274342413111
Bond Position:  [16.94423802]


portfolio before change:  [4.95198041]
curr_Stock_Price:  105.50740916521522
curr_Factors:  [105.50740917]
mat_Sqrt:  [[0.15]]
grads:  [0.17943926]
Stock Position:  0.17943926483263042
Bond Position:  [-13.98019152]


portfolio before change:  [4.8554791]
curr_Stock_Price:  104.97448499548183
curr_Factors:  [104.974485]
mat_Sqrt:  [[0.15]]
grads:  [-0.17079767]
Stock Position:  -0.17079767363881682
Bond Position:  [22.78487693]


portfolio before change:  [4.70994921]
curr_Stock_Price:  105.83488309454255
curr_Factors:  [105.83488309]
mat_Sqrt:  [[0.15]]
grads:  [0.02119275]
Stock Position:  0.021192754587589867
Bond Position:  [2.4670165]


portfolio before change:  [4.71919467]
curr_Stock_Price:  106.26386308895212
curr_Factors:  [106.26386309]
mat_Sqrt:  [[0.15]]
grads:  [0.03070578]
Stock Position:  0.030705777811423213
Bond Position:  [1.4562801]


portfolio before change:  [4.70703472]
curr_Stock_Price:  105.86488392005835
curr_Factors:  [105.86488392]
mat_Sqrt:  [[0.15]]
grads:  [-0.08797061]
Stock Position:  -0.08797061442561092
Bond Position:  [14.02003361]


portfolio before change:  [4.672585]
curr_Stock_Price:  106.26644983126947
curr_Factors:  [106.26644983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.672585]
Stock Price:  106.599956991376
PL:  [-1.92737199]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.94184041e-04]
 [ 2.36268450e-03]
 [-2.87150868e-03]
 [ 8.37048291e-03]
 [ 3.42674342e-03]
 [ 1.84397294e-02]
 [ 6.90602124e-04]
 [-1.82627879e-02]
 [ 1.89396609e-02]
 [-4.04887263e-03]
 [ 1.42191587e-02]
 [-4.95626957e-02]
 [ 4.62454796e-03]
 [ 1.78364839e-03]
 [-6.91091814e-03]
 [ 1.97163301e-02]
 [ 1.02365519e-02]
 [-1.15767019e-02]
 [ 4.41994678e-03]
 [-5.64638301e-03]
 [ 1.44434497e-02]
 [-6.35065221e-03]
 [ 1.10856659e-02]
 [ 1.41179634e-02]
 [ 2.34405124e-03]
 [ 9.47081915e-03]
 [-5.37837275e-03]
 [ 1.02466519e-02]
 [ 3.37753961e-02]
 [-8.90889736e-04]
 [ 1.49961238e-02]
 [-4.97098210e-03]
 [ 3.92935873e-03]
 [ 8.15780497e-03]
 [ 1.05573149e-02]
 [ 8.53590155e-03]
 [-3.33543921e-02]
 [ 9.21222260e-03]
 [ 6.69376354e-03]
 [ 1.77254912e-02]
 [-3.91027580e-03]
 [-1.92855759e-02]
 [ 2.09296812e-02]
 [-9.09823960e-04]
 [-1.48886347e-04]
 [-1.39387591e-02]
 [ 1.28198508e-02]
 [-1.38024646e-03]
 [-4.91276196e-03]
 [-7.45334900e-03]
 [-2.64402745e-02]
 [ 2.39434954e-03]
 [-5.63857016e-03]
 [ 5.52201766e-03]
 [-7.93144437e-04]
 [ 1.40102329e-04]
 [ 7.14661173e-03]
 [-6.60028247e-04]
 [ 1.62471856e-03]
 [ 1.36728709e-02]
 [ 9.00849938e-04]
 [-1.18016085e-02]
 [-6.62125844e-03]
 [-1.26813284e-02]
 [-2.92399951e-03]
 [-3.53058324e-04]
 [-5.53004809e-03]
 [ 1.81865456e-02]
 [-8.21115720e-03]
 [ 8.73517893e-03]
 [-1.07048268e-02]
 [ 1.10224389e-02]
 [-8.34432624e-03]
 [ 1.64389430e-02]
 [-2.24840334e-02]
 [-4.15149908e-03]
 [-8.73424639e-03]
 [-1.75845987e-03]
 [ 6.78881597e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.83696508]
curr_Stock_Price:  100.7669946411994
curr_Factors:  [100.76699464]
mat_Sqrt:  [[0.15]]
grads:  [-0.00196123]
Stock Position:  -0.0019612269395742534
Bond Position:  [14.03459203]


portfolio before change:  [13.8383277]
curr_Stock_Price:  100.5194808131898
curr_Factors:  [100.51948081]
mat_Sqrt:  [[0.15]]
grads:  [0.01575123]
Stock Position:  0.015751230007313533
Bond Position:  [12.25502224]


portfolio before change:  [13.84066427]
curr_Stock_Price:  100.61919403978273
curr_Factors:  [100.61919404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01914339]
Stock Position:  -0.01914339119141111
Bond Position:  [15.76685686]


portfolio before change:  [13.85853507]
curr_Stock_Price:  99.73714853808676
curr_Factors:  [99.73714854]
mat_Sqrt:  [[0.15]]
grads:  [0.05580322]
Stock Position:  0.0558032194241002
Bond Position:  [8.29288109]


portfolio before change:  [13.8401115]
curr_Stock_Price:  99.39770774130838
curr_Factors:  [99.39770774]
mat_Sqrt:  [[0.15]]
grads:  [0.02284496]
Stock Position:  0.02284495614533422
Bond Position:  [11.56937523]


portfolio before change:  [13.83360138]
curr_Stock_Price:  99.08108490296407
curr_Factors:  [99.0810849]
mat_Sqrt:  [[0.15]]
grads:  [0.12293153]
Stock Position:  0.12293152910390587
Bond Position:  [1.6534121]


portfolio before change:  [13.91572692]
curr_Stock_Price:  99.7483034845519
curr_Factors:  [99.74830348]
mat_Sqrt:  [[0.15]]
grads:  [0.00460401]
Stock Position:  0.0046040141622536645
Bond Position:  [13.45648432]


portfolio before change:  [13.91602374]
curr_Stock_Price:  99.63009520975704
curr_Factors:  [99.63009521]
mat_Sqrt:  [[0.15]]
grads:  [-0.12175192]
Stock Position:  -0.12175191912085016
Bond Position:  [26.04617904]


portfolio before change:  [13.87759664]
curr_Stock_Price:  99.9590841576275
curr_Factors:  [99.95908416]
mat_Sqrt:  [[0.15]]
grads:  [0.12626441]
Stock Position:  0.12626440578407802
Bond Position:  [1.25632228]


portfolio before change:  [13.96029148]
curr_Stock_Price:  100.61339611441429
curr_Factors:  [100.61339611]
mat_Sqrt:  [[0.15]]
grads:  [-0.02699248]
Stock Position:  -0.026992484192656218
Bond Position:  [16.67609698]


portfolio before change:  [13.97035299]
curr_Stock_Price:  100.27925763791667
curr_Factors:  [100.27925764]
mat_Sqrt:  [[0.15]]
grads:  [0.09479439]
Stock Position:  0.09479439148646376
Bond Position:  [4.46444179]


portfolio before change:  [14.07704837]
curr_Stock_Price:  101.40185924245664
curr_Factors:  [101.40185924]
mat_Sqrt:  [[0.15]]
grads:  [-0.33041797]
Stock Position:  -0.33041797118212096
Bond Position:  [47.58204497]


portfolio before change:  [14.40181773]
curr_Stock_Price:  100.4279552202031
curr_Factors:  [100.42795522]
mat_Sqrt:  [[0.15]]
grads:  [0.03083032]
Stock Position:  0.030830319756558502
Bond Position:  [11.30559176]


portfolio before change:  [14.41597433]
curr_Stock_Price:  100.86421342984062
curr_Factors:  [100.86421343]
mat_Sqrt:  [[0.15]]
grads:  [0.01189099]
Stock Position:  0.011890989269594358
Bond Position:  [13.21659905]


portfolio before change:  [14.41656372]
curr_Stock_Price:  100.84431028616387
curr_Factors:  [100.84431029]
mat_Sqrt:  [[0.15]]
grads:  [-0.04607279]
Stock Position:  -0.046072787618898596
Bond Position:  [19.06274221]


portfolio before change:  [14.40420474]
curr_Stock_Price:  101.1384196958739
curr_Factors:  [101.1384197]
mat_Sqrt:  [[0.15]]
grads:  [0.1314422]
Stock Position:  0.13144220069778778
Bond Position:  [1.11034828]


portfolio before change:  [14.3663903]
curr_Stock_Price:  100.85020298240703
curr_Factors:  [100.85020298]
mat_Sqrt:  [[0.15]]
grads:  [0.06824368]
Stock Position:  0.06824367917878274
Bond Position:  [7.48400141]


portfolio before change:  [14.3580507]
curr_Stock_Price:  100.72114531244945
curr_Factors:  [100.72114531]
mat_Sqrt:  [[0.15]]
grads:  [-0.07717801]
Stock Position:  -0.07717801250797773
Bond Position:  [22.13150851]


portfolio before change:  [14.23439977]
curr_Stock_Price:  102.34122058813912
curr_Factors:  [102.34122059]
mat_Sqrt:  [[0.15]]
grads:  [0.02946631]
Stock Position:  0.029466311881384506
Bond Position:  [11.21878145]


portfolio before change:  [14.22616186]
curr_Stock_Price:  102.03785366741177
curr_Factors:  [102.03785367]
mat_Sqrt:  [[0.15]]
grads:  [-0.03764255]
Stock Position:  -0.03764255339552758
Bond Position:  [18.06712722]


portfolio before change:  [14.18410147]
curr_Stock_Price:  103.18521525039051
curr_Factors:  [103.18521525]
mat_Sqrt:  [[0.15]]
grads:  [0.09628966]
Stock Position:  0.09628966465466503
Bond Position:  [4.2484317]


portfolio before change:  [14.10539319]
curr_Stock_Price:  102.36504601169861
curr_Factors:  [102.36504601]
mat_Sqrt:  [[0.15]]
grads:  [-0.04233768]
Stock Position:  -0.04233768142200788
Bond Position:  [18.43929189]


portfolio before change:  [14.11450331]
curr_Stock_Price:  102.17708985274821
curr_Factors:  [102.17708985]
mat_Sqrt:  [[0.15]]
grads:  [0.07390444]
Stock Position:  0.0739044391684417
Bond Position:  [6.56316278]


portfolio before change:  [14.05878902]
curr_Stock_Price:  101.41766997447675
curr_Factors:  [101.41766997]
mat_Sqrt:  [[0.15]]
grads:  [0.09411976]
Stock Position:  0.09411975573124001
Bond Position:  [4.51338269]


portfolio before change:  [14.1193736]
curr_Stock_Price:  102.05836953440175
curr_Factors:  [102.05836953]
mat_Sqrt:  [[0.15]]
grads:  [0.01562701]
Stock Position:  0.015627008285215932
Bond Position:  [12.52450661]


portfolio before change:  [14.1217882]
curr_Stock_Price:  102.16279083363801
curr_Factors:  [102.16279083]
mat_Sqrt:  [[0.15]]
grads:  [0.06313879]
Stock Position:  0.0631387943200743
Bond Position:  [7.67135276]


portfolio before change:  [14.12719963]
curr_Stock_Price:  102.24090372993663
curr_Factors:  [102.24090373]
mat_Sqrt:  [[0.15]]
grads:  [-0.03585582]
Stock Position:  -0.03585581836209729
Bond Position:  [17.7931309]


portfolio before change:  [14.12510311]
curr_Stock_Price:  102.33039044824892
curr_Factors:  [102.33039045]
mat_Sqrt:  [[0.15]]
grads:  [0.06831101]
Stock Position:  0.06831101246525094
Bond Position:  [7.13481053]


portfolio before change:  [14.12473598]
curr_Stock_Price:  102.31848799631719
curr_Factors:  [102.318488]
mat_Sqrt:  [[0.15]]
grads:  [0.22516931]
Stock Position:  0.22516930720068326
Bond Position:  [-8.91424707]


portfolio before change:  [14.05043749]
curr_Stock_Price:  101.9909951678603
curr_Factors:  [101.99099517]
mat_Sqrt:  [[0.15]]
grads:  [-0.00593926]
Stock Position:  -0.005939264904378195
Bond Position:  [14.65618903]


portfolio before change:  [14.04791301]
curr_Stock_Price:  102.57027866096716
curr_Factors:  [102.57027866]
mat_Sqrt:  [[0.15]]
grads:  [0.09997416]
Stock Position:  0.09997415899917075
Bond Position:  [3.79353567]


portfolio before change:  [14.1172754]
curr_Stock_Price:  103.2617101813507
curr_Factors:  [103.26171018]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313988]
Stock Position:  -0.03313988066319533
Bond Position:  [17.53935615]


portfolio before change:  [14.13852167]
curr_Stock_Price:  102.65368078003497
curr_Factors:  [102.65368078]
mat_Sqrt:  [[0.15]]
grads:  [0.02619572]
Stock Position:  0.026195724883480466
Bond Position:  [11.44943409]


portfolio before change:  [14.17698185]
curr_Stock_Price:  104.09454831959094
curr_Factors:  [104.09454832]
mat_Sqrt:  [[0.15]]
grads:  [0.05438537]
Stock Position:  0.054385366462687365
Bond Position:  [8.51576169]


portfolio before change:  [14.11989559]
curr_Stock_Price:  103.03509958303414
curr_Factors:  [103.03509958]
mat_Sqrt:  [[0.15]]
grads:  [0.0703821]
Stock Position:  0.07038209966179612
Bond Position:  [6.86806895]


portfolio before change:  [14.08413975]
curr_Stock_Price:  102.5209758413804
curr_Factors:  [102.52097584]
mat_Sqrt:  [[0.15]]
grads:  [0.05690601]
Stock Position:  0.05690601032883461
Bond Position:  [8.25008004]


portfolio before change:  [14.07922115]
curr_Stock_Price:  102.42548069813803
curr_Factors:  [102.4254807]
mat_Sqrt:  [[0.15]]
grads:  [-0.22236261]
Stock Position:  -0.22236261370412264
Bond Position:  [36.85481875]


portfolio before change:  [14.01523877]
curr_Stock_Price:  102.72357880555522
curr_Factors:  [102.72357881]
mat_Sqrt:  [[0.15]]
grads:  [0.06141482]
Stock Position:  0.061414817327250855
Bond Position:  [7.70648895]


portfolio before change:  [13.9992714]
curr_Stock_Price:  102.45574374720645
curr_Factors:  [102.45574375]
mat_Sqrt:  [[0.15]]
grads:  [0.04462509]
Stock Position:  0.044625090295613776
Bond Position:  [9.42717459]


portfolio before change:  [14.01264606]
curr_Stock_Price:  102.74225151190058
curr_Factors:  [102.74225151]
mat_Sqrt:  [[0.15]]
grads:  [0.11816994]
Stock Position:  0.11816994123805087
Bond Position:  [1.87160023]


portfolio before change:  [14.12757349]
curr_Stock_Price:  103.71382227168762
curr_Factors:  [103.71382227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02606851]
Stock Position:  -0.026068505307867893
Bond Position:  [16.83123782]


portfolio before change:  [14.14584126]
curr_Stock_Price:  103.0534169172672
curr_Factors:  [103.05341692]
mat_Sqrt:  [[0.15]]
grads:  [-0.12857051]
Stock Position:  -0.1285705060980675
Bond Position:  [27.39547123]


portfolio before change:  [14.17524213]
curr_Stock_Price:  102.83805963023195
curr_Factors:  [102.83805963]
mat_Sqrt:  [[0.15]]
grads:  [0.13953121]
Stock Position:  0.1395312082180054
Bond Position:  [-0.17387659]


portfolio before change:  [14.19324661]
curr_Stock_Price:  102.96717308385536
curr_Factors:  [102.96717308]
mat_Sqrt:  [[0.15]]
grads:  [-0.00606549]
Stock Position:  -0.006065493066776754
Bond Position:  [14.81779329]


portfolio before change:  [14.19535165]
curr_Stock_Price:  102.77281181678295
curr_Factors:  [102.77281182]
mat_Sqrt:  [[0.15]]
grads:  [-0.00099258]
Stock Position:  -0.0009925756469778783
Bond Position:  [14.29736144]


portfolio before change:  [14.19613974]
curr_Stock_Price:  102.8791290593328
curr_Factors:  [102.87912906]
mat_Sqrt:  [[0.15]]
grads:  [-0.09292506]
Stock Position:  -0.09292506057753162
Bond Position:  [23.75618904]


portfolio before change:  [14.28876853]
curr_Stock_Price:  101.89829581887729
curr_Factors:  [101.89829582]
mat_Sqrt:  [[0.15]]
grads:  [0.08546567]
Stock Position:  0.08546567168074833
Bond Position:  [5.57996224]


portfolio before change:  [14.2955992]
curr_Stock_Price:  101.97413807551166
curr_Factors:  [101.97413808]
mat_Sqrt:  [[0.15]]
grads:  [-0.00920164]
Stock Position:  -0.009201643097052157
Bond Position:  [15.23392883]


portfolio before change:  [14.29601348]
curr_Stock_Price:  102.03259164984496
curr_Factors:  [102.03259165]
mat_Sqrt:  [[0.15]]
grads:  [-0.03275175]
Stock Position:  -0.03275174640249479
Bond Position:  [17.63775905]


portfolio before change:  [14.28980529]
curr_Stock_Price:  102.25580393203504
curr_Factors:  [102.25580393]
mat_Sqrt:  [[0.15]]
grads:  [-0.04968899]
Stock Position:  -0.04968899330586464
Bond Position:  [19.37079324]


portfolio before change:  [14.29513642]
curr_Stock_Price:  102.17287971124928
curr_Factors:  [102.17287971]
mat_Sqrt:  [[0.15]]
grads:  [-0.1762685]
Stock Position:  -0.17626849699897987
Bond Position:  [32.30499636]


portfolio before change:  [14.153999]
curr_Stock_Price:  102.98503019768481
curr_Factors:  [102.9850302]
mat_Sqrt:  [[0.15]]
grads:  [0.01596233]
Stock Position:  0.01596233025585661
Bond Position:  [12.51011794]


portfolio before change:  [14.1382744]
curr_Stock_Price:  101.95093920990749
curr_Factors:  [101.95093921]
mat_Sqrt:  [[0.15]]
grads:  [-0.03759047]
Stock Position:  -0.03759046772198234
Bond Position:  [17.97065789]


portfolio before change:  [14.12870249]
curr_Stock_Price:  102.23545594593018
curr_Factors:  [102.23545595]
mat_Sqrt:  [[0.15]]
grads:  [0.03681345]
Stock Position:  0.03681345103850676
Bond Position:  [10.36506254]


portfolio before change:  [14.12712629]
curr_Stock_Price:  102.1750424016862
curr_Factors:  [102.1750424]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528763]
Stock Position:  -0.005287629579429362
Bond Position:  [14.66739007]


portfolio before change:  [14.12901794]
curr_Stock_Price:  101.9906680858651
curr_Factors:  [101.99066809]
mat_Sqrt:  [[0.15]]
grads:  [0.00093402]
Stock Position:  0.0009340155278149525
Bond Position:  [14.03375707]


portfolio before change:  [14.1294048]
curr_Stock_Price:  101.4657530733105
curr_Factors:  [101.46575307]
mat_Sqrt:  [[0.15]]
grads:  [0.04764408]
Stock Position:  0.04764407822575274
Bond Position:  [9.29516252]


portfolio before change:  [14.13915328]
curr_Stock_Price:  101.65816976810166
curr_Factors:  [101.65816977]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440019]
Stock Position:  -0.004400188311606536
Bond Position:  [14.58646837]


portfolio before change:  [14.1391818]
curr_Stock_Price:  101.85888031646749
curr_Factors:  [101.85888032]
mat_Sqrt:  [[0.15]]
grads:  [0.01083146]
Stock Position:  0.010831457064927916
Bond Position:  [13.03590171]


portfolio before change:  [14.1325027]
curr_Stock_Price:  101.16701897318502
curr_Factors:  [101.16701897]
mat_Sqrt:  [[0.15]]
grads:  [0.09115247]
Stock Position:  0.09115247234039273
Bond Position:  [4.9108788]


portfolio before change:  [14.06903626]
curr_Stock_Price:  100.4673848497617
curr_Factors:  [100.46738485]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [13.46566268]


portfolio before change:  [14.07016938]
curr_Stock_Price:  100.51592134838121
curr_Factors:  [100.51592135]
mat_Sqrt:  [[0.15]]
grads:  [-0.07867739]
Stock Position:  -0.0786773900832935
Bond Position:  [21.97849974]


portfolio before change:  [14.02213697]
curr_Stock_Price:  101.14387959304996
curr_Factors:  [101.14387959]
mat_Sqrt:  [[0.15]]
grads:  [-0.04414172]
Stock Position:  -0.044141722938840305
Bond Position:  [18.48680208]


portfolio before change:  [14.0006304]
curr_Stock_Price:  101.65727209421294
curr_Factors:  [101.65727209]
mat_Sqrt:  [[0.15]]
grads:  [-0.08454219]
Stock Position:  -0.08454218915798978
Bond Position:  [22.59495872]


portfolio before change:  [13.9991333]
curr_Stock_Price:  101.69168483846147
curr_Factors:  [101.69168484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01949333]
Stock Position:  -0.019493330042982815
Bond Position:  [15.98144287]


portfolio before change:  [14.00447595]
curr_Stock_Price:  101.4688504125219
curr_Factors:  [101.46885041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235372]
Stock Position:  -0.0023537221620911764
Bond Position:  [14.24330544]


portfolio before change:  [14.00564474]
curr_Stock_Price:  101.35050421700195
curr_Factors:  [101.35050422]
mat_Sqrt:  [[0.15]]
grads:  [-0.03686699]
Stock Position:  -0.03686698724383069
Bond Position:  [17.74213249]


portfolio before change:  [14.00720512]
curr_Stock_Price:  101.33825857168985
curr_Factors:  [101.33825857]
mat_Sqrt:  [[0.15]]
grads:  [0.12124364]
Stock Position:  0.12124363734117966
Bond Position:  [1.72058605]


portfolio before change:  [13.96979873]
curr_Stock_Price:  101.02884907539757
curr_Factors:  [101.02884908]
mat_Sqrt:  [[0.15]]
grads:  [-0.05474105]
Stock Position:  -0.05474104802230827
Bond Position:  [19.50022381]


portfolio before change:  [13.98401407]
curr_Stock_Price:  100.79143057987446
curr_Factors:  [100.79143058]
mat_Sqrt:  [[0.15]]
grads:  [0.05823453]
Stock Position:  0.058234526201991696
Bond Position:  [8.11447286]


portfolio before change:  [13.98237262]
curr_Stock_Price:  100.75453465121254
curr_Factors:  [100.75453465]
mat_Sqrt:  [[0.15]]
grads:  [-0.07136551]
Stock Position:  -0.07136551205928561
Bond Position:  [21.17277158]


portfolio before change:  [13.97556265]
curr_Stock_Price:  100.86850167255504
curr_Factors:  [100.86850167]
mat_Sqrt:  [[0.15]]
grads:  [0.07348293]
Stock Position:  0.07348292622773372
Bond Position:  [6.56344998]


portfolio before change:  [13.95469718]
curr_Stock_Price:  100.57896919148625
curr_Factors:  [100.57896919]
mat_Sqrt:  [[0.15]]
grads:  [-0.05562884]
Stock Position:  -0.0556288415783151
Bond Position:  [19.54978872]


portfolio before change:  [13.95389382]
curr_Stock_Price:  100.6153758750822
curr_Factors:  [100.61537588]
mat_Sqrt:  [[0.15]]
grads:  [0.10959295]
Stock Position:  0.10959295346565259
Bond Position:  [2.92715761]


portfolio before change:  [14.03436909]
curr_Stock_Price:  101.34801711671196
curr_Factors:  [101.34801712]
mat_Sqrt:  [[0.15]]
grads:  [-0.14989356]
Stock Position:  -0.1498935558236899
Bond Position:  [29.22578375]


portfolio before change:  [14.07284426]
curr_Stock_Price:  101.10352028556562
curr_Factors:  [101.10352029]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767666]
Stock Position:  -0.027676660508006486
Bond Position:  [16.87105206]


portfolio before change:  [14.08195681]
curr_Stock_Price:  100.81236962818689
curr_Factors:  [100.81236963]
mat_Sqrt:  [[0.15]]
grads:  [-0.05822831]
Stock Position:  -0.05822830926390313
Bond Position:  [19.95209064]


portfolio before change:  [14.10866071]
curr_Stock_Price:  100.37517918920149
curr_Factors:  [100.37517919]
mat_Sqrt:  [[0.15]]
grads:  [-0.01172307]
Stock Position:  -0.011723065767281889
Bond Position:  [15.28536554]


portfolio before change:  [14.1159779]
curr_Stock_Price:  99.83250340715698
curr_Factors:  [99.83250341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.1159779]
Stock Price:  99.16037549824316
PL:  [14.1159779]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.58599244e-04]
 [-1.68411318e-02]
 [-4.03847388e-04]
 [ 8.50660742e-03]
 [ 4.06893032e-03]
 [ 2.58192341e-02]
 [ 1.58634283e-03]
 [-1.80198562e-02]
 [ 2.49136437e-02]
 [-4.53414064e-03]
 [ 2.95326437e-02]
 [-1.82562694e-02]
 [ 3.74540546e-02]
 [ 4.19799864e-03]
 [-6.90111742e-03]
 [ 2.12215712e-02]
 [ 1.08031389e-02]
 [-9.83384476e-03]
 [ 3.73199414e-03]
 [-5.52707362e-03]
 [ 1.13712290e-02]
 [-8.79115285e-03]
 [ 7.91682686e-03]
 [ 1.17948151e-02]
 [-1.01068653e-02]
 [-9.00675091e-03]
 [-1.78750984e-03]
 [ 9.94335232e-03]
 [-4.05415943e-02]
 [ 4.88433471e-03]
 [ 1.43365895e-02]
 [-1.36688761e-02]
 [-6.75908131e-03]
 [ 7.16605047e-03]
 [ 1.37262896e-02]
 [-1.74184470e-03]
 [-2.90225086e-02]
 [ 7.42155154e-03]
 [-4.86695222e-02]
 [-1.05444522e-02]
 [-1.62946518e-02]
 [ 6.36092135e-02]
 [ 2.35238358e-02]
 [ 2.53117209e-03]
 [ 1.37219767e-02]
 [ 3.30592138e-02]
 [-4.55009861e-03]
 [-4.43864297e-04]
 [ 2.54256404e-02]
 [ 7.02165917e-03]
 [ 3.34484845e-02]
 [ 5.94051832e-03]
 [ 1.15284133e-03]
 [ 4.75771353e-03]
 [ 3.41471461e-03]
 [ 1.36197791e-03]
 [-4.69767121e-03]
 [-5.01239204e-04]
 [ 1.55584918e-03]
 [-5.49301101e-02]
 [-1.00069411e-02]
 [ 1.07827611e-02]
 [ 1.44537785e-02]
 [-1.88015108e-02]
 [-4.85057963e-03]
 [-1.35215418e-02]
 [-4.72371115e-03]
 [ 1.10530228e-02]
 [-1.39526701e-02]
 [ 1.02436307e-02]
 [ 1.78921026e-03]
 [ 1.18974668e-02]
 [ 2.74480815e-03]
 [ 7.01241621e-04]
 [ 1.18138362e-03]
 [-1.41209145e-02]
 [ 5.25709368e-03]
 [ 5.48942590e-03]
 [-3.35711700e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.5504664]
curr_Stock_Price:  100.22816540481013
curr_Factors:  [100.2281654]
mat_Sqrt:  [[0.15]]
grads:  [0.00372399]
Stock Position:  0.0037239949621210248
Bond Position:  [5.17721721]


portfolio before change:  [5.54616924]
curr_Stock_Price:  98.98736180837035
curr_Factors:  [98.98736181]
mat_Sqrt:  [[0.15]]
grads:  [-0.11227421]
Stock Position:  -0.112274212056147
Bond Position:  [16.65989729]


portfolio before change:  [5.47399624]
curr_Stock_Price:  99.63946414009858
curr_Factors:  [99.63946414]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269232]
Stock Position:  -0.002692315922841234
Bond Position:  [5.74225715]


portfolio before change:  [5.47471925]
curr_Stock_Price:  99.50422442274757
curr_Factors:  [99.50422442]
mat_Sqrt:  [[0.15]]
grads:  [0.05671072]
Stock Position:  0.05671071613445467
Bond Position:  [-0.16823658]


portfolio before change:  [5.47357332]
curr_Stock_Price:  99.48420327220413
curr_Factors:  [99.48420327]
mat_Sqrt:  [[0.15]]
grads:  [0.0271262]
Stock Position:  0.027126202144010098
Bond Position:  [2.77494471]


portfolio before change:  [5.49487225]
curr_Stock_Price:  100.26298884667048
curr_Factors:  [100.26298885]
mat_Sqrt:  [[0.15]]
grads:  [0.17212823]
Stock Position:  0.1721282275071919
Bond Position:  [-11.7632183]


portfolio before change:  [5.49883778]
curr_Stock_Price:  100.2902984545689
curr_Factors:  [100.29029845]
mat_Sqrt:  [[0.15]]
grads:  [0.01057562]
Stock Position:  0.010575618841206724
Bond Position:  [4.43820581]


portfolio before change:  [5.49475821]
curr_Stock_Price:  99.87831628888202
curr_Factors:  [99.87831629]
mat_Sqrt:  [[0.15]]
grads:  [-0.12013237]
Stock Position:  -0.12013237448248794
Bond Position:  [17.49337751]


portfolio before change:  [5.39138166]
curr_Stock_Price:  100.74793966761044
curr_Factors:  [100.74793967]
mat_Sqrt:  [[0.15]]
grads:  [0.16609096]
Stock Position:  0.16609095825524856
Bond Position:  [-11.34194018]


portfolio before change:  [5.50849546]
curr_Stock_Price:  101.45732623687297
curr_Factors:  [101.45732624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0302276]
Stock Position:  -0.03022760425018752
Bond Position:  [8.57530737]


portfolio before change:  [5.499152]
curr_Stock_Price:  101.78416105093089
curr_Factors:  [101.78416105]
mat_Sqrt:  [[0.15]]
grads:  [0.19688429]
Stock Position:  0.19688429119755696
Bond Position:  [-14.5405504]


portfolio before change:  [5.59402405]
curr_Stock_Price:  102.27064406614821
curr_Factors:  [102.27064407]
mat_Sqrt:  [[0.15]]
grads:  [-0.12170846]
Stock Position:  -0.12170846250444947
Bond Position:  [18.0412269]


portfolio before change:  [5.71079534]
curr_Stock_Price:  101.32047451229744
curr_Factors:  [101.32047451]
mat_Sqrt:  [[0.15]]
grads:  [0.2496937]
Stock Position:  0.24969369745620126
Bond Position:  [-19.58828857]


portfolio before change:  [5.74026053]
curr_Stock_Price:  101.44338306455306
curr_Factors:  [101.44338306]
mat_Sqrt:  [[0.15]]
grads:  [0.02798666]
Stock Position:  0.027986657604515457
Bond Position:  [2.9011993]


portfolio before change:  [5.74195282]
curr_Stock_Price:  101.49737165746173
curr_Factors:  [101.49737166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600745]
Stock Position:  -0.04600744947144574
Bond Position:  [10.41158801]


portfolio before change:  [5.74588914]
curr_Stock_Price:  101.4259575592319
curr_Factors:  [101.42595756]
mat_Sqrt:  [[0.15]]
grads:  [0.14147714]
Stock Position:  0.1414771411047219
Bond Position:  [-8.60356537]


portfolio before change:  [5.79014936]
curr_Stock_Price:  101.74260204867053
curr_Factors:  [101.74260205]
mat_Sqrt:  [[0.15]]
grads:  [0.07202093]
Stock Position:  0.07202092605063505
Bond Position:  [-1.53744706]


portfolio before change:  [5.81940334]
curr_Stock_Price:  102.15012350382246
curr_Factors:  [102.1501235]
mat_Sqrt:  [[0.15]]
grads:  [-0.06555897]
Stock Position:  -0.06555896505457749
Bond Position:  [12.51625972]


portfolio before change:  [5.81705873]
curr_Stock_Price:  102.1978194581756
curr_Factors:  [102.19781946]
mat_Sqrt:  [[0.15]]
grads:  [0.02487996]
Stock Position:  0.024879960938393314
Bond Position:  [3.27438098]


portfolio before change:  [5.79814266]
curr_Stock_Price:  101.42930039132398
curr_Factors:  [101.42930039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684716]
Stock Position:  -0.03684715745250554
Bond Position:  [9.53552406]


portfolio before change:  [5.85828506]
curr_Stock_Price:  99.8132622321806
curr_Factors:  [99.81326223]
mat_Sqrt:  [[0.15]]
grads:  [0.07580819]
Stock Position:  0.0758081934097765
Bond Position:  [-1.70837802]


portfolio before change:  [5.77253636]
curr_Stock_Price:  98.68354365666316
curr_Factors:  [98.68354366]
mat_Sqrt:  [[0.15]]
grads:  [-0.05860769]
Stock Position:  -0.0586076856497778
Bond Position:  [11.55615047]


portfolio before change:  [5.74048781]
curr_Stock_Price:  99.24269949853866
curr_Factors:  [99.2426995]
mat_Sqrt:  [[0.15]]
grads:  [0.05277885]
Stock Position:  0.05277884574859858
Bond Position:  [0.50257269]


portfolio before change:  [5.71176817]
curr_Stock_Price:  98.69795364462458
curr_Factors:  [98.69795364]
mat_Sqrt:  [[0.15]]
grads:  [0.0786321]
Stock Position:  0.07863210085856004
Bond Position:  [-2.04905928]


portfolio before change:  [5.61128729]
curr_Stock_Price:  97.42172155011832
curr_Factors:  [97.42172155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0673791]
Stock Position:  -0.06737910207479929
Bond Position:  [12.17547541]


portfolio before change:  [5.57684519]
curr_Stock_Price:  97.94418451873027
curr_Factors:  [97.94418452]
mat_Sqrt:  [[0.15]]
grads:  [-0.06004501]
Stock Position:  -0.06004500605284136
Bond Position:  [11.45790435]


portfolio before change:  [5.61391833]
curr_Stock_Price:  97.33868885124778
curr_Factors:  [97.33868885]
mat_Sqrt:  [[0.15]]
grads:  [-0.01191673]
Stock Position:  -0.011916732299720564
Bond Position:  [6.77387742]


portfolio before change:  [5.61880744]
curr_Stock_Price:  96.96394431873652
curr_Factors:  [96.96394432]
mat_Sqrt:  [[0.15]]
grads:  [0.06628902]
Stock Position:  0.06628901548184833
Bond Position:  [-0.80883697]


portfolio before change:  [5.59238974]
curr_Stock_Price:  96.56618395701993
curr_Factors:  [96.56618396]
mat_Sqrt:  [[0.15]]
grads:  [-0.2702773]
Stock Position:  -0.2702772956190226
Bond Position:  [31.69203679]


portfolio before change:  [5.72455844]
curr_Stock_Price:  96.08450129248678
curr_Factors:  [96.08450129]
mat_Sqrt:  [[0.15]]
grads:  [0.03256223]
Stock Position:  0.0325622314129605
Bond Position:  [2.59583268]


portfolio before change:  [5.69946711]
curr_Stock_Price:  95.30895332539461
curr_Factors:  [95.30895333]
mat_Sqrt:  [[0.15]]
grads:  [0.09557726]
Stock Position:  0.09557726348427152
Bond Position:  [-3.40990183]


portfolio before change:  [5.64550585]
curr_Stock_Price:  94.74660058119615
curr_Factors:  [94.74660058]
mat_Sqrt:  [[0.15]]
grads:  [-0.09112584]
Stock Position:  -0.09112584093653618
Bond Position:  [14.27936951]


portfolio before change:  [5.62865019]
curr_Stock_Price:  94.94136587293643
curr_Factors:  [94.94136587]
mat_Sqrt:  [[0.15]]
grads:  [-0.04506054]
Stock Position:  -0.04506054206147006
Bond Position:  [9.9067596]


portfolio before change:  [5.62325575]
curr_Stock_Price:  95.07482266474511
curr_Factors:  [95.07482266]
mat_Sqrt:  [[0.15]]
grads:  [0.04777367]
Stock Position:  0.04777366980360468
Bond Position:  [1.08118256]


portfolio before change:  [5.61331339]
curr_Stock_Price:  94.865294356632
curr_Factors:  [94.86529436]
mat_Sqrt:  [[0.15]]
grads:  [0.0915086]
Stock Position:  0.09150859763343515
Bond Position:  [-3.06767666]


portfolio before change:  [5.55137386]
curr_Stock_Price:  94.1905184943318
curr_Factors:  [94.19051849]
mat_Sqrt:  [[0.15]]
grads:  [-0.0116123]
Stock Position:  -0.011612298007648177
Bond Position:  [6.64514223]


portfolio before change:  [5.55040917]
curr_Stock_Price:  94.30935957528837
curr_Factors:  [94.30935958]
mat_Sqrt:  [[0.15]]
grads:  [-0.19348339]
Stock Position:  -0.19348339093701655
Bond Position:  [23.79770386]


portfolio before change:  [5.58135528]
curr_Stock_Price:  94.15710514263391
curr_Factors:  [94.15710514]
mat_Sqrt:  [[0.15]]
grads:  [0.04947701]
Stock Position:  0.0494770102699546
Bond Position:  [0.92274322]


portfolio before change:  [5.5807194]
curr_Stock_Price:  94.14308752297389
curr_Factors:  [94.14308752]
mat_Sqrt:  [[0.15]]
grads:  [-0.32446348]
Stock Position:  -0.32446348117523055
Bond Position:  [36.12671331]


portfolio before change:  [5.61430656]
curr_Stock_Price:  94.04653068648254
curr_Factors:  [94.04653069]
mat_Sqrt:  [[0.15]]
grads:  [-0.07029635]
Stock Position:  -0.07029634797666967
Bond Position:  [12.22543421]


portfolio before change:  [5.64848068]
curr_Stock_Price:  93.57125697815509
curr_Factors:  [93.57125698]
mat_Sqrt:  [[0.15]]
grads:  [-0.10863101]
Stock Position:  -0.10863101223726353
Bond Position:  [15.81322104]


portfolio before change:  [5.59335914]
curr_Stock_Price:  94.08777516988644
curr_Factors:  [94.08777517]
mat_Sqrt:  [[0.15]]
grads:  [0.42406142]
Stock Position:  0.424061423378381
Bond Position:  [-34.30563672]


portfolio before change:  [5.53960379]
curr_Stock_Price:  93.96606832017217
curr_Factors:  [93.96606832]
mat_Sqrt:  [[0.15]]
grads:  [0.15682557]
Stock Position:  0.15682557205029696
Bond Position:  [-9.19667862]


portfolio before change:  [5.41730908]
curr_Stock_Price:  93.18991998838645
curr_Factors:  [93.18991999]
mat_Sqrt:  [[0.15]]
grads:  [0.01687448]
Stock Position:  0.016874480590193797
Bond Position:  [3.84477758]


portfolio before change:  [5.41638722]
curr_Stock_Price:  93.12104882002242
curr_Factors:  [93.12104882]
mat_Sqrt:  [[0.15]]
grads:  [0.09147984]
Stock Position:  0.09147984461367764
Bond Position:  [-3.10231186]


portfolio before change:  [5.45464988]
curr_Stock_Price:  93.54143166650938
curr_Factors:  [93.54143167]
mat_Sqrt:  [[0.15]]
grads:  [0.22039476]
Stock Position:  0.22039475878352982
Bond Position:  [-15.16139139]


portfolio before change:  [5.41941015]
curr_Stock_Price:  93.38583761168137
curr_Factors:  [93.38583761]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033399]
Stock Position:  -0.030333990713076582
Bond Position:  [8.25217528]


portfolio before change:  [5.40679757]
curr_Stock_Price:  93.81863111915278
curr_Factors:  [93.81863112]
mat_Sqrt:  [[0.15]]
grads:  [-0.0029591]
Stock Position:  -0.002959095313457948
Bond Position:  [5.68441584]


portfolio before change:  [5.40669084]
curr_Stock_Price:  93.97476436498144
curr_Factors:  [93.97476436]
mat_Sqrt:  [[0.15]]
grads:  [0.16950427]
Stock Position:  0.16950426954434925
Bond Position:  [-10.52243295]


portfolio before change:  [5.45335333]
curr_Stock_Price:  94.25393230939893
curr_Factors:  [94.25393231]
mat_Sqrt:  [[0.15]]
grads:  [0.04681106]
Stock Position:  0.046811061149526885
Bond Position:  [1.04122674]


portfolio before change:  [5.4949467]
curr_Stock_Price:  95.14107941606333
curr_Factors:  [95.14107942]
mat_Sqrt:  [[0.15]]
grads:  [0.2229899]
Stock Position:  0.22298989670969213
Bond Position:  [-15.72055277]


portfolio before change:  [5.48374015]
curr_Stock_Price:  95.09522983476168
curr_Factors:  [95.09522983]
mat_Sqrt:  [[0.15]]
grads:  [0.03960346]
Stock Position:  0.03960345548495975
Bond Position:  [1.71764044]


portfolio before change:  [5.49675151]
curr_Stock_Price:  95.4210601267558
curr_Factors:  [95.42106013]
mat_Sqrt:  [[0.15]]
grads:  [0.00768561]
Stock Position:  0.007685608892314828
Bond Position:  [4.76338256]


portfolio before change:  [5.49880501]
curr_Stock_Price:  95.64951045575717
curr_Factors:  [95.64951046]
mat_Sqrt:  [[0.15]]
grads:  [0.03171809]
Stock Position:  0.031718090217028885
Bond Position:  [2.46498521]


portfolio before change:  [5.49751359]
curr_Stock_Price:  95.60393751231216
curr_Factors:  [95.60393751]
mat_Sqrt:  [[0.15]]
grads:  [0.02276476]
Stock Position:  0.022764764081679295
Bond Position:  [3.3211125]


portfolio before change:  [5.51856833]
curr_Stock_Price:  96.51970229784507
curr_Factors:  [96.5197023]
mat_Sqrt:  [[0.15]]
grads:  [0.00907985]
Stock Position:  0.00907985270069563
Bond Position:  [4.64218365]


portfolio before change:  [5.51668207]
curr_Stock_Price:  96.28000623005039
curr_Factors:  [96.28000623]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131781]
Stock Position:  -0.031317808075042405
Bond Position:  [8.53196083]


portfolio before change:  [5.50929345]
curr_Stock_Price:  96.5329578088821
curr_Factors:  [96.53295781]
mat_Sqrt:  [[0.15]]
grads:  [-0.00334159]
Stock Position:  -0.003341594690859233
Bond Position:  [5.83186747]


portfolio before change:  [5.51054463]
curr_Stock_Price:  96.26761162218106
curr_Factors:  [96.26761162]
mat_Sqrt:  [[0.15]]
grads:  [0.01037233]
Stock Position:  0.010372327893731369
Bond Position:  [4.5120254]


portfolio before change:  [5.50029377]
curr_Stock_Price:  95.25213315440573
curr_Factors:  [95.25213315]
mat_Sqrt:  [[0.15]]
grads:  [-0.36620073]
Stock Position:  -0.3662007337660917
Bond Position:  [40.38169482]


portfolio before change:  [5.35307024]
curr_Stock_Price:  95.66105493675445
curr_Factors:  [95.66105494]
mat_Sqrt:  [[0.15]]
grads:  [-0.06671294]
Stock Position:  -0.06671294088273198
Bond Position:  [11.73490055]


portfolio before change:  [5.29465864]
curr_Stock_Price:  96.5476154359119
curr_Factors:  [96.54761544]
mat_Sqrt:  [[0.15]]
grads:  [0.07188507]
Stock Position:  0.07188507420234201
Bond Position:  [-1.64567386]


portfolio before change:  [5.28873764]
curr_Stock_Price:  96.46667873932608
curr_Factors:  [96.46667874]
mat_Sqrt:  [[0.15]]
grads:  [0.09635852]
Stock Position:  0.09635852322238794
Bond Position:  [-4.00664906]


portfolio before change:  [5.27234797]
curr_Stock_Price:  96.29918709687267
curr_Factors:  [96.2991871]
mat_Sqrt:  [[0.15]]
grads:  [-0.12534341]
Stock Position:  -0.12534340550765302
Bond Position:  [17.34281603]


portfolio before change:  [5.30467223]
curr_Stock_Price:  96.04994942858512
curr_Factors:  [96.04994943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0323372]
Stock Position:  -0.032337197548226615
Bond Position:  [8.41065842]


portfolio before change:  [5.29271541]
curr_Stock_Price:  96.43596006561846
curr_Factors:  [96.43596007]
mat_Sqrt:  [[0.15]]
grads:  [-0.09014361]
Stock Position:  -0.0901436119715942
Bond Position:  [13.98580117]


portfolio before change:  [5.27416351]
curr_Stock_Price:  96.65146103783388
curr_Factors:  [96.65146104]
mat_Sqrt:  [[0.15]]
grads:  [-0.03149141]
Stock Position:  -0.031491407667802514
Bond Position:  [8.31785407]


portfolio before change:  [5.28186015]
curr_Stock_Price:  96.423565512555
curr_Factors:  [96.42356551]
mat_Sqrt:  [[0.15]]
grads:  [0.07368682]
Stock Position:  0.0736868188763548
Bond Position:  [-1.82328566]


portfolio before change:  [5.23373626]
curr_Stock_Price:  95.77202526827641
curr_Factors:  [95.77202527]
mat_Sqrt:  [[0.15]]
grads:  [-0.0930178]
Stock Position:  -0.09301780092878928
Bond Position:  [14.14223944]


portfolio before change:  [5.18961527]
curr_Stock_Price:  96.25585638819656
curr_Factors:  [96.25585639]
mat_Sqrt:  [[0.15]]
grads:  [0.06829087]
Stock Position:  0.06829087107132249
Bond Position:  [-1.38378101]


portfolio before change:  [5.17056657]
curr_Stock_Price:  95.97818804595114
curr_Factors:  [95.97818805]
mat_Sqrt:  [[0.15]]
grads:  [0.01192807]
Stock Position:  0.011928068378626346
Bond Position:  [4.02573218]


portfolio before change:  [5.1734284]
curr_Stock_Price:  96.197017738975
curr_Factors:  [96.19701774]
mat_Sqrt:  [[0.15]]
grads:  [0.07931645]
Stock Position:  0.07931644544222521
Bond Position:  [-2.45657711]


portfolio before change:  [5.1562984]
curr_Stock_Price:  95.98298321545342
curr_Factors:  [95.98298322]
mat_Sqrt:  [[0.15]]
grads:  [0.01829872]
Stock Position:  0.018298721009750628
Bond Position:  [3.39993257]


portfolio before change:  [5.15871852]
curr_Stock_Price:  96.10362655730638
curr_Factors:  [96.10362656]
mat_Sqrt:  [[0.15]]
grads:  [0.00467494]
Stock Position:  0.0046749441375148505
Bond Position:  [4.70943944]


portfolio before change:  [5.15734796]
curr_Stock_Price:  95.74749172867621
curr_Factors:  [95.74749173]
mat_Sqrt:  [[0.15]]
grads:  [0.00787589]
Stock Position:  0.00787589081659675
Bond Position:  [4.40325117]


portfolio before change:  [5.16008633]
curr_Stock_Price:  96.060238537841
curr_Factors:  [96.06023854]
mat_Sqrt:  [[0.15]]
grads:  [-0.09413943]
Stock Position:  -0.0941394301569483
Bond Position:  [14.20314245]


portfolio before change:  [5.17761769]
curr_Stock_Price:  95.8834408501793
curr_Factors:  [95.88344085]
mat_Sqrt:  [[0.15]]
grads:  [0.03504729]
Stock Position:  0.03504729116912697
Bond Position:  [1.81716282]


portfolio before change:  [5.1837108]
curr_Stock_Price:  96.05405405065672
curr_Factors:  [96.05405405]
mat_Sqrt:  [[0.15]]
grads:  [0.03659617]
Stock Position:  0.036596172676484885
Bond Position:  [1.66850005]


portfolio before change:  [5.17373058]
curr_Stock_Price:  95.77849233498497
curr_Factors:  [95.77849233]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.17373058]
Stock Price:  95.6106091432418
PL:  [5.17373058]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.04324584e-03]
 [ 3.01167641e-03]
 [ 3.10335643e-04]
 [ 6.87276682e-03]
 [-2.69959029e-03]
 [ 1.41046705e-02]
 [ 3.37287092e-03]
 [-2.51529075e-02]
 [-3.62166280e-02]
 [ 3.03767731e-02]
 [-9.14299672e-02]
 [ 3.55666049e-02]
 [-4.33006929e-03]
 [-4.55053996e-03]
 [-7.07790351e-03]
 [ 1.04124305e-02]
 [ 1.58954675e-02]
 [ 7.04111084e-03]
 [ 1.65492821e-03]
 [ 8.35797288e-03]
 [ 1.31751438e-02]
 [-1.17141159e-02]
 [ 9.71538933e-04]
 [-6.45837141e-02]
 [-1.26525801e-02]
 [-3.09200425e-03]
 [-8.44245541e-04]
 [ 9.84918439e-03]
 [-3.37370642e-02]
 [ 3.18407809e-03]
 [ 3.95226636e-03]
 [-1.06066478e-02]
 [-7.52869679e-03]
 [ 6.12694555e-03]
 [ 1.37558255e-02]
 [ 4.02460242e-03]
 [-3.17402425e-02]
 [ 8.03337041e-03]
 [-3.50406161e-02]
 [ 7.36529879e-04]
 [-1.35361917e-02]
 [ 3.99033308e-02]
 [ 2.33160175e-02]
 [ 3.59438511e-03]
 [ 8.15762605e-03]
 [ 1.36380362e-02]
 [ 5.74176690e-04]
 [-1.19351317e-02]
 [-3.92774531e-03]
 [-2.47592938e-03]
 [ 4.72636721e-02]
 [-1.02938521e-02]
 [ 3.09969682e-03]
 [ 5.20349519e-03]
 [ 4.42788019e-03]
 [ 4.19307840e-05]
 [ 4.33704736e-03]
 [-5.78155084e-04]
 [ 1.54830026e-03]
 [-1.28359877e-02]
 [-4.30114501e-04]
 [ 6.59004329e-03]
 [ 1.32610698e-02]
 [-1.87737156e-02]
 [-7.30428006e-03]
 [-9.71270279e-03]
 [-4.73190246e-03]
 [ 9.45469097e-03]
 [-1.42118412e-02]
 [ 1.09414897e-02]
 [ 1.60139736e-03]
 [ 1.21582108e-02]
 [ 3.47844352e-03]
 [-1.68582613e-03]
 [ 8.12790875e-03]
 [-1.83431519e-02]
 [ 5.00623757e-03]
 [ 7.35124671e-03]
 [ 3.94827228e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.40128231]
curr_Stock_Price:  99.51602839529994
curr_Factors:  [99.5160284]
mat_Sqrt:  [[0.15]]
grads:  [0.02695497]
Stock Position:  0.026954972245637476
Bond Position:  [-8.0837341]


portfolio before change:  [-5.38505346]
curr_Stock_Price:  100.1368452476676
curr_Factors:  [100.13684525]
mat_Sqrt:  [[0.15]]
grads:  [0.02007784]
Stock Position:  0.020077842723721546
Bond Position:  [-7.39558529]


portfolio before change:  [-5.39096623]
curr_Stock_Price:  99.86537545440721
curr_Factors:  [99.86537545]
mat_Sqrt:  [[0.15]]
grads:  [0.0020689]
Stock Position:  0.0020689042879300816
Bond Position:  [-5.59757813]


portfolio before change:  [-5.39348553]
curr_Stock_Price:  98.8167808250208
curr_Factors:  [98.81678083]
mat_Sqrt:  [[0.15]]
grads:  [0.04581845]
Stock Position:  0.045818445488286036
Bond Position:  [-9.92111681]


portfolio before change:  [-5.40529554]
curr_Stock_Price:  98.57255779412972
curr_Factors:  [98.57255779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01799727]
Stock Position:  -0.01799726856942166
Bond Position:  [-3.63125874]


portfolio before change:  [-5.40225103]
curr_Stock_Price:  98.39078183319995
curr_Factors:  [98.39078183]
mat_Sqrt:  [[0.15]]
grads:  [0.09403114]
Stock Position:  0.0940311363860586
Bond Position:  [-14.65404805]


portfolio before change:  [-5.4360242]
curr_Stock_Price:  98.04135219616238
curr_Factors:  [98.0413522]
mat_Sqrt:  [[0.15]]
grads:  [0.02248581]
Stock Position:  0.022485806101688682
Bond Position:  [-7.64056303]


portfolio before change:  [-5.43842836]
curr_Stock_Price:  97.95567101070365
curr_Factors:  [97.95567101]
mat_Sqrt:  [[0.15]]
grads:  [-0.16768605]
Stock Position:  -0.16768604981528382
Bond Position:  [10.98737117]


portfolio before change:  [-5.28234298]
curr_Stock_Price:  97.02894721856829
curr_Factors:  [97.02894722]
mat_Sqrt:  [[0.15]]
grads:  [-0.24144419]
Stock Position:  -0.2414441868263317
Bond Position:  [18.14473228]


portfolio before change:  [-5.44771673]
curr_Stock_Price:  97.7185800508411
curr_Factors:  [97.71858005]
mat_Sqrt:  [[0.15]]
grads:  [0.20251182]
Stock Position:  0.20251182066935033
Bond Position:  [-25.23688429]


portfolio before change:  [-5.64062865]
curr_Stock_Price:  96.77377318598543
curr_Factors:  [96.77377319]
mat_Sqrt:  [[0.15]]
grads:  [-0.60953311]
Stock Position:  -0.6095331149603335
Bond Position:  [53.34619077]


portfolio before change:  [-5.33265351]
curr_Stock_Price:  96.2739793457043
curr_Factors:  [96.27397935]
mat_Sqrt:  [[0.15]]
grads:  [0.2371107]
Stock Position:  0.23711069965313752
Bond Position:  [-28.16024411]


portfolio before change:  [-5.49361173]
curr_Stock_Price:  95.60257079951155
curr_Factors:  [95.6025708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02886713]
Stock Position:  -0.02886712860834202
Bond Position:  [-2.73384002]


portfolio before change:  [-5.49873261]
curr_Stock_Price:  95.77404661395556
curr_Factors:  [95.77404661]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033693]
Stock Position:  -0.03033693307209065
Bond Position:  [-2.59324177]


portfolio before change:  [-5.52377543]
curr_Stock_Price:  96.5941933870868
curr_Factors:  [96.59419339]
mat_Sqrt:  [[0.15]]
grads:  [-0.04718602]
Stock Position:  -0.04718602336992929
Bond Position:  [-0.96587957]


portfolio before change:  [-5.50173621]
curr_Stock_Price:  96.12584300464111
curr_Factors:  [96.125843]
mat_Sqrt:  [[0.15]]
grads:  [0.0694162]
Stock Position:  0.06941620317523228
Bond Position:  [-12.17442726]


portfolio before change:  [-5.50187055]
curr_Stock_Price:  96.13486952766688
curr_Factors:  [96.13486953]
mat_Sqrt:  [[0.15]]
grads:  [0.10596978]
Stock Position:  0.10596978309684221
Bond Position:  [-15.68926182]


portfolio before change:  [-5.39686873]
curr_Stock_Price:  97.13498887957492
curr_Factors:  [97.13498888]
mat_Sqrt:  [[0.15]]
grads:  [0.04694074]
Stock Position:  0.04694073894350566
Bond Position:  [-9.95645688]


portfolio before change:  [-5.40382437]
curr_Stock_Price:  97.00006682598027
curr_Factors:  [97.00006683]
mat_Sqrt:  [[0.15]]
grads:  [0.01103285]
Stock Position:  0.011032854721920065
Bond Position:  [-6.47401201]


portfolio before change:  [-5.40303055]
curr_Stock_Price:  97.10869327303001
curr_Factors:  [97.10869327]
mat_Sqrt:  [[0.15]]
grads:  [0.05571982]
Stock Position:  0.055719819222598624
Bond Position:  [-10.81390938]


portfolio before change:  [-5.46055782]
curr_Stock_Price:  96.08838511809236
curr_Factors:  [96.08838512]
mat_Sqrt:  [[0.15]]
grads:  [0.08783429]
Stock Position:  0.0878342917966082
Bond Position:  [-13.90041308]


portfolio before change:  [-5.5103977]
curr_Stock_Price:  95.53084581273635
curr_Factors:  [95.53084581]
mat_Sqrt:  [[0.15]]
grads:  [-0.07809411]
Stock Position:  -0.07809410603645218
Bond Position:  [1.94999831]


portfolio before change:  [-5.56323195]
curr_Stock_Price:  96.20895249714232
curr_Factors:  [96.2089525]
mat_Sqrt:  [[0.15]]
grads:  [0.00647693]
Stock Position:  0.006476926220254897
Bond Position:  [-6.18637024]


portfolio before change:  [-5.56327793]
curr_Stock_Price:  96.26155117254378
curr_Factors:  [96.26155117]
mat_Sqrt:  [[0.15]]
grads:  [-0.43055809]
Stock Position:  -0.4305580940354478
Bond Position:  [35.88291207]


portfolio before change:  [-5.42994148]
curr_Stock_Price:  95.95707727469392
curr_Factors:  [95.95707727]
mat_Sqrt:  [[0.15]]
grads:  [-0.08435053]
Stock Position:  -0.08435053395898319
Bond Position:  [2.66408922]


portfolio before change:  [-5.47551404]
curr_Stock_Price:  96.49932717353683
curr_Factors:  [96.49932717]
mat_Sqrt:  [[0.15]]
grads:  [-0.02061336]
Stock Position:  -0.020613361647632555
Bond Position:  [-3.48633851]


portfolio before change:  [-5.48361651]
curr_Stock_Price:  96.88182505501368
curr_Factors:  [96.88182506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0056283]
Stock Position:  -0.005628303607770289
Bond Position:  [-4.93833618]


portfolio before change:  [-5.48473874]
curr_Stock_Price:  97.02637498734555
curr_Factors:  [97.02637499]
mat_Sqrt:  [[0.15]]
grads:  [0.06566123]
Stock Position:  0.0656612292810077
Bond Position:  [-11.85560979]


portfolio before change:  [-5.49265603]
curr_Stock_Price:  96.91708228017909
curr_Factors:  [96.91708228]
mat_Sqrt:  [[0.15]]
grads:  [-0.22491376]
Stock Position:  -0.22491376150062053
Bond Position:  [16.3053295]


portfolio before change:  [-5.49472469]
curr_Stock_Price:  96.93081101526228
curr_Factors:  [96.93081102]
mat_Sqrt:  [[0.15]]
grads:  [0.02122719]
Stock Position:  0.021227187271350135
Bond Position:  [-7.55229317]


portfolio before change:  [-5.49088794]
curr_Stock_Price:  97.1337953855892
curr_Factors:  [97.13379539]
mat_Sqrt:  [[0.15]]
grads:  [0.02634844]
Stock Position:  0.026348442389394582
Bond Position:  [-8.05021215]


portfolio before change:  [-5.50722672]
curr_Stock_Price:  96.53278742165962
curr_Factors:  [96.53278742]
mat_Sqrt:  [[0.15]]
grads:  [-0.07071099]
Stock Position:  -0.07071098531237366
Bond Position:  [1.3187018]


portfolio before change:  [-5.49287558]
curr_Stock_Price:  96.33099815386761
curr_Factors:  [96.33099815]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019131]
Stock Position:  -0.05019131192825359
Bond Position:  [-0.6578964]


portfolio before change:  [-5.48461116]
curr_Stock_Price:  96.16552062968451
curr_Factors:  [96.16552063]
mat_Sqrt:  [[0.15]]
grads:  [0.0408463]
Stock Position:  0.04084630369821994
Bond Position:  [-9.41261723]


portfolio before change:  [-5.49407827]
curr_Stock_Price:  95.94814982477287
curr_Factors:  [95.94814982]
mat_Sqrt:  [[0.15]]
grads:  [0.0917055]
Stock Position:  0.0917055036093949
Bond Position:  [-14.29305167]


portfolio before change:  [-5.54957815]
curr_Stock_Price:  95.352694425751
curr_Factors:  [95.35269443]
mat_Sqrt:  [[0.15]]
grads:  [0.02683068]
Stock Position:  0.026830682779663773
Bond Position:  [-8.10795604]


portfolio before change:  [-5.54120327]
curr_Stock_Price:  95.68371999300365
curr_Factors:  [95.68371999]
mat_Sqrt:  [[0.15]]
grads:  [-0.21160162]
Stock Position:  -0.2116016163850881
Bond Position:  [14.70562654]


portfolio before change:  [-5.59016113]
curr_Stock_Price:  95.91943175876848
curr_Factors:  [95.91943176]
mat_Sqrt:  [[0.15]]
grads:  [0.0535558]
Stock Position:  0.05355580272324281
Bond Position:  [-10.72720329]


portfolio before change:  [-5.57307191]
curr_Stock_Price:  96.25104259999394
curr_Factors:  [96.2510426]
mat_Sqrt:  [[0.15]]
grads:  [-0.23360411]
Stock Position:  -0.2336041075100758
Bond Position:  [16.91156699]


portfolio before change:  [-5.40250102]
curr_Stock_Price:  95.52539661003465
curr_Factors:  [95.52539661]
mat_Sqrt:  [[0.15]]
grads:  [0.0049102]
Stock Position:  0.00491019919070033
Bond Position:  [-5.87154975]


portfolio before change:  [-5.40188368]
curr_Stock_Price:  95.72586339386878
curr_Factors:  [95.72586339]
mat_Sqrt:  [[0.15]]
grads:  [-0.09024128]
Stock Position:  -0.09024127815423415
Bond Position:  [3.23654059]


portfolio before change:  [-5.44422095]
curr_Stock_Price:  96.19726144653828
curr_Factors:  [96.19726145]
mat_Sqrt:  [[0.15]]
grads:  [0.26602221]
Stock Position:  0.2660222054078612
Bond Position:  [-31.03482859]


portfolio before change:  [-5.58338081]
curr_Stock_Price:  95.68143936946876
curr_Factors:  [95.68143937]
mat_Sqrt:  [[0.15]]
grads:  [0.15544012]
Stock Position:  0.15544011650232448
Bond Position:  [-20.4561149]


portfolio before change:  [-5.64139305]
curr_Stock_Price:  95.31645194524108
curr_Factors:  [95.31645195]
mat_Sqrt:  [[0.15]]
grads:  [0.02396257]
Stock Position:  0.023962567414044535
Bond Position:  [-7.92541995]


portfolio before change:  [-5.64458449]
curr_Stock_Price:  95.20393953487702
curr_Factors:  [95.20393953]
mat_Sqrt:  [[0.15]]
grads:  [0.05438417]
Stock Position:  0.05438417364757554
Bond Position:  [-10.82217207]


portfolio before change:  [-5.61199502]
curr_Stock_Price:  95.81562254987924
curr_Factors:  [95.81562255]
mat_Sqrt:  [[0.15]]
grads:  [0.09092024]
Stock Position:  0.09092024156834916
Bond Position:  [-14.32357457]


portfolio before change:  [-5.53844943]
curr_Stock_Price:  96.6343713396408
curr_Factors:  [96.63437134]
mat_Sqrt:  [[0.15]]
grads:  [0.00382784]
Stock Position:  0.0038278445994151373
Bond Position:  [-5.90835079]


portfolio before change:  [-5.53655372]
curr_Stock_Price:  97.22608819064143
curr_Factors:  [97.22608819]
mat_Sqrt:  [[0.15]]
grads:  [-0.07956754]
Stock Position:  -0.0795675447965725
Bond Position:  [2.19948741]


portfolio before change:  [-5.54665352]
curr_Stock_Price:  97.35474963876345
curr_Factors:  [97.35474964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02618497]
Stock Position:  -0.02618496870887557
Bond Position:  [-2.99742245]


portfolio before change:  [-5.56182548]
curr_Stock_Price:  97.9270098459523
curr_Factors:  [97.92700985]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165062]
Stock Position:  -0.016506195867213143
Bond Position:  [-3.94542307]


portfolio before change:  [-5.5756598]
curr_Stock_Price:  98.75019941916042
curr_Factors:  [98.75019942]
mat_Sqrt:  [[0.15]]
grads:  [0.31509115]
Stock Position:  0.3150911475393482
Bond Position:  [-36.69097346]


portfolio before change:  [-5.6096659]
curr_Stock_Price:  98.64955287427813
curr_Factors:  [98.64955287]
mat_Sqrt:  [[0.15]]
grads:  [-0.06862568]
Stock Position:  -0.06862568065382246
Bond Position:  [1.16022681]


portfolio before change:  [-5.57012038]
curr_Stock_Price:  98.07436008976836
curr_Factors:  [98.07436009]
mat_Sqrt:  [[0.15]]
grads:  [0.02066465]
Stock Position:  0.020664645439918528
Bond Position:  [-7.59679226]


portfolio before change:  [-5.57152166]
curr_Stock_Price:  98.02952714295219
curr_Factors:  [98.02952714]
mat_Sqrt:  [[0.15]]
grads:  [0.03468997]
Stock Position:  0.03468996794003793
Bond Position:  [-8.97216281]


portfolio before change:  [-5.60797222]
curr_Stock_Price:  96.99494027835114
curr_Factors:  [96.99494028]
mat_Sqrt:  [[0.15]]
grads:  [0.0295192]
Stock Position:  0.029519201257482322
Bond Position:  [-8.47118538]


portfolio before change:  [-5.61311303]
curr_Stock_Price:  96.83872504606404
curr_Factors:  [96.83872505]
mat_Sqrt:  [[0.15]]
grads:  [0.00027954]
Stock Position:  0.0002795385598337516
Bond Position:  [-5.64018319]


portfolio before change:  [-5.6132817]
curr_Stock_Price:  97.49643684025764
curr_Factors:  [97.49643684]
mat_Sqrt:  [[0.15]]
grads:  [0.02891365]
Stock Position:  0.02891364909198629
Bond Position:  [-8.43225946]


portfolio before change:  [-5.62619412]
curr_Stock_Price:  97.06807894148852
curr_Factors:  [97.06807894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385437]
Stock Position:  -0.003854367227313776
Bond Position:  [-5.2520581]


portfolio before change:  [-5.62482301]
curr_Stock_Price:  96.6271826071667
curr_Factors:  [96.62718261]
mat_Sqrt:  [[0.15]]
grads:  [0.010322]
Stock Position:  0.010322001704960783
Bond Position:  [-6.62220895]


portfolio before change:  [-5.62268855]
curr_Stock_Price:  96.87406906836573
curr_Factors:  [96.87406907]
mat_Sqrt:  [[0.15]]
grads:  [-0.08557325]
Stock Position:  -0.08557325146595243
Bond Position:  [2.66714052]


portfolio before change:  [-5.71750462]
curr_Stock_Price:  97.98402775828042
curr_Factors:  [97.98402776]
mat_Sqrt:  [[0.15]]
grads:  [-0.00286743]
Stock Position:  -0.0028674300056239117
Bond Position:  [-5.43654228]


portfolio before change:  [-5.7153747]
curr_Stock_Price:  97.12272767758148
curr_Factors:  [97.12272768]
mat_Sqrt:  [[0.15]]
grads:  [0.04393362]
Stock Position:  0.04393362192336573
Bond Position:  [-9.9823279]


portfolio before change:  [-5.71268042]
curr_Stock_Price:  97.19825502615629
curr_Factors:  [97.19825503]
mat_Sqrt:  [[0.15]]
grads:  [0.08840713]
Stock Position:  0.0884071322900247
Bond Position:  [-14.30569941]


portfolio before change:  [-5.78598771]
curr_Stock_Price:  96.37916779523077
curr_Factors:  [96.3791678]
mat_Sqrt:  [[0.15]]
grads:  [-0.1251581]
Stock Position:  -0.12515810400614316
Bond Position:  [6.2766462]


portfolio before change:  [-5.85783581]
curr_Stock_Price:  96.95636092168981
curr_Factors:  [96.95636092]
mat_Sqrt:  [[0.15]]
grads:  [-0.0486952]
Stock Position:  -0.0486952004077196
Bond Position:  [-1.13652638]


portfolio before change:  [-5.86783541]
curr_Stock_Price:  97.160253112517
curr_Factors:  [97.16025311]
mat_Sqrt:  [[0.15]]
grads:  [-0.06475135]
Stock Position:  -0.06475135195900822
Bond Position:  [0.42342233]


portfolio before change:  [-5.8469433]
curr_Stock_Price:  96.8380104159088
curr_Factors:  [96.83801042]
mat_Sqrt:  [[0.15]]
grads:  [-0.03154602]
Stock Position:  -0.03154601637880552
Bond Position:  [-2.79208983]


portfolio before change:  [-5.8258757]
curr_Stock_Price:  96.16464155992404
curr_Factors:  [96.16464156]
mat_Sqrt:  [[0.15]]
grads:  [0.06303127]
Stock Position:  0.06303127310081996
Bond Position:  [-11.88725549]


portfolio before change:  [-5.85758296]
curr_Stock_Price:  95.67338884245083
curr_Factors:  [95.67338884]
mat_Sqrt:  [[0.15]]
grads:  [-0.09474561]
Stock Position:  -0.09474560817675379
Bond Position:  [3.20705045]


portfolio before change:  [-5.87706262]
curr_Stock_Price:  95.88110404296327
curr_Factors:  [95.88110404]
mat_Sqrt:  [[0.15]]
grads:  [0.07294326]
Stock Position:  0.07294326492370487
Bond Position:  [-12.87094339]


portfolio before change:  [-5.86354201]
curr_Stock_Price:  96.07749042526754
curr_Factors:  [96.07749043]
mat_Sqrt:  [[0.15]]
grads:  [0.01067598]
Stock Position:  0.010675982377122823
Bond Position:  [-6.88926361]


portfolio before change:  [-5.87239319]
curr_Stock_Price:  95.28874989911681
curr_Factors:  [95.2887499]
mat_Sqrt:  [[0.15]]
grads:  [0.08105474]
Stock Position:  0.08105473874140416
Bond Position:  [-13.59599792]


portfolio before change:  [-5.88414202]
curr_Stock_Price:  95.15428449399434
curr_Factors:  [95.15428449]
mat_Sqrt:  [[0.15]]
grads:  [0.02318962]
Stock Position:  0.02318962348054189
Bond Position:  [-8.09073405]


portfolio before change:  [-5.885669]
curr_Stock_Price:  95.11024383386912
curr_Factors:  [95.11024383]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123884]
Stock Position:  -0.011238840899490963
Bond Position:  [-4.8167401]


portfolio before change:  [-5.88174506]
curr_Stock_Price:  94.7343158540954
curr_Factors:  [94.73431585]
mat_Sqrt:  [[0.15]]
grads:  [0.05418606]
Stock Position:  0.0541860583612958
Bond Position:  [-11.01502422]


portfolio before change:  [-5.8854566]
curr_Stock_Price:  94.67852504541074
curr_Factors:  [94.67852505]
mat_Sqrt:  [[0.15]]
grads:  [-0.12228768]
Stock Position:  -0.12228767953333247
Bond Position:  [5.69256053]


portfolio before change:  [-5.88570598]
curr_Stock_Price:  94.68347387096141
curr_Factors:  [94.68347387]
mat_Sqrt:  [[0.15]]
grads:  [0.03337492]
Stock Position:  0.033374917115511826
Bond Position:  [-9.04575908]


portfolio before change:  [-5.8914919]
curr_Stock_Price:  94.52705276922057
curr_Factors:  [94.52705277]
mat_Sqrt:  [[0.15]]
grads:  [0.04900831]
Stock Position:  0.04900831142796614
Bond Position:  [-10.52410314]


portfolio before change:  [-5.88863222]
curr_Stock_Price:  94.59882551045197
curr_Factors:  [94.59882551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.88863222]
Stock Price:  94.4524349511494
PL:  [-5.88863222]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.03302692e-02]
 [-2.23000825e-02]
 [-3.50569789e-03]
 [ 3.92588227e-03]
 [-7.57419333e-03]
 [ 4.69107804e-03]
 [ 6.32082894e-03]
 [-3.03940494e-02]
 [-4.85359838e-02]
 [ 4.37165514e-02]
 [-1.55379741e-01]
 [ 4.08691114e-02]
 [-9.82948154e-04]
 [-7.74230834e-03]
 [-7.18398913e-03]
 [ 8.88735094e-03]
 [ 2.07957229e-02]
 [ 4.93785596e-02]
 [ 3.58176984e-03]
 [ 1.86205483e-02]
 [ 1.33640738e-02]
 [-1.40862213e-02]
 [-8.48827111e-03]
 [-2.04684951e-01]
 [-1.43677884e-02]
 [ 4.80370346e-03]
 [ 9.08273760e-03]
 [ 1.98970212e-02]
 [-1.17146930e-01]
 [ 1.20087886e-02]
 [ 3.02794135e-02]
 [-1.69922607e-02]
 [-5.86838545e-03]
 [ 8.44729119e-03]
 [ 1.37239355e-02]
 [ 7.34154287e-04]
 [-3.00653660e-02]
 [ 7.68511529e-03]
 [-4.75044122e-02]
 [-4.91281466e-04]
 [-1.49577062e-02]
 [ 6.23670445e-02]
 [ 2.35809264e-02]
 [ 3.28955713e-03]
 [ 9.79081353e-03]
 [ 1.75273634e-02]
 [-7.26666568e-04]
 [-7.80826511e-03]
 [ 5.15475702e-03]
 [ 2.90695455e-03]
 [ 3.87682228e-02]
 [-5.99981010e-04]
 [ 1.57259953e-03]
 [ 4.88137364e-03]
 [ 3.50785460e-03]
 [ 1.28561024e-03]
 [ 2.36760203e-03]
 [-4.75103123e-04]
 [ 1.55237820e-03]
 [-3.82350435e-03]
 [ 9.06716985e-04]
 [-7.62961771e-03]
 [ 4.44755211e-03]
 [-1.72389023e-02]
 [-1.29287308e-02]
 [-3.76963882e-03]
 [-4.83699987e-03]
 [ 1.89019927e-02]
 [-9.94193224e-03]
 [ 6.77067273e-03]
 [-4.69744190e-03]
 [ 1.14834134e-02]
 [ 2.15014268e-04]
 [ 3.27094971e-03]
 [-1.54977654e-03]
 [-1.45484136e-02]
 [ 5.18544981e-03]
 [ 5.47785405e-03]
 [-4.14624840e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.29445977]
curr_Stock_Price:  98.67765006125336
curr_Factors:  [98.67765006]
mat_Sqrt:  [[0.15]]
grads:  [0.06886846]
Stock Position:  0.06886846145138754
Bond Position:  [-25.09023771]


portfolio before change:  [-18.28679446]
curr_Stock_Price:  98.81172449030035
curr_Factors:  [98.81172449]
mat_Sqrt:  [[0.15]]
grads:  [-0.14866722]
Stock Position:  -0.14866721693585153
Bond Position:  [-3.59673038]


portfolio before change:  [-18.30562972]
curr_Stock_Price:  98.93690651957415
curr_Factors:  [98.93690652]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337132]
Stock Position:  -0.023371319261314267
Bond Position:  [-15.99334369]


portfolio before change:  [-18.27981531]
curr_Stock_Price:  97.78960145206634
curr_Factors:  [97.78960145]
mat_Sqrt:  [[0.15]]
grads:  [0.02617255]
Stock Position:  0.026172548451534484
Bond Position:  [-20.83921839]


portfolio before change:  [-18.27798281]
curr_Stock_Price:  97.90938307779894
curr_Factors:  [97.90938308]
mat_Sqrt:  [[0.15]]
grads:  [-0.05049462]
Stock Position:  -0.05049462218931748
Bond Position:  [-13.3340855]


portfolio before change:  [-18.24275328]
curr_Stock_Price:  97.19518956246878
curr_Factors:  [97.19518956]
mat_Sqrt:  [[0.15]]
grads:  [0.03127385]
Stock Position:  0.03127385357422159
Bond Position:  [-21.28242141]


portfolio before change:  [-18.25817416]
curr_Stock_Price:  96.74463166243241
curr_Factors:  [96.74463166]
mat_Sqrt:  [[0.15]]
grads:  [0.04213886]
Stock Position:  0.0421388595813195
Bond Position:  [-22.33488261]


portfolio before change:  [-18.26456273]
curr_Stock_Price:  96.62615202033541
curr_Factors:  [96.62615202]
mat_Sqrt:  [[0.15]]
grads:  [-0.202627]
Stock Position:  -0.20262699623546304
Bond Position:  [1.31450421]


portfolio before change:  [-18.24231795]
curr_Stock_Price:  96.51677560808503
curr_Factors:  [96.51677561]
mat_Sqrt:  [[0.15]]
grads:  [-0.32357323]
Stock Position:  -0.32357322558340973
Bond Position:  [12.98792645]


portfolio before change:  [-18.15205169]
curr_Stock_Price:  96.24031733084321
curr_Factors:  [96.24031733]
mat_Sqrt:  [[0.15]]
grads:  [0.29144368]
Stock Position:  0.29144367628985307
Bond Position:  [-46.20068358]


portfolio before change:  [-18.36299161]
curr_Stock_Price:  95.52644942813342
curr_Factors:  [95.52644943]
mat_Sqrt:  [[0.15]]
grads:  [-1.03586494]
Stock Position:  -1.0358649432680387
Bond Position:  [80.58950851]


portfolio before change:  [-18.05071309]
curr_Stock_Price:  95.2298455888626
curr_Factors:  [95.22984559]
mat_Sqrt:  [[0.15]]
grads:  [0.27246074]
Stock Position:  0.2724607426116402
Bond Position:  [-43.99710753]


portfolio before change:  [-18.11866385]
curr_Stock_Price:  94.99054190046655
curr_Factors:  [94.9905419]
mat_Sqrt:  [[0.15]]
grads:  [-0.00655299]
Stock Position:  -0.006552987695052198
Bond Position:  [-17.496192]


portfolio before change:  [-18.11987802]
curr_Stock_Price:  95.00894918913886
curr_Factors:  [95.00894919]
mat_Sqrt:  [[0.15]]
grads:  [-0.05161539]
Stock Position:  -0.051615388933086793
Bond Position:  [-13.21595416]


portfolio before change:  [-18.1065798]
curr_Stock_Price:  94.73530509833617
curr_Factors:  [94.7353051]
mat_Sqrt:  [[0.15]]
grads:  [-0.04789326]
Stock Position:  -0.04789326083959851
Bond Position:  [-13.56939712]


portfolio before change:  [-18.09361787]
curr_Stock_Price:  94.44695470474234
curr_Factors:  [94.4469547]
mat_Sqrt:  [[0.15]]
grads:  [0.05924901]
Stock Position:  0.0592490062583483
Bond Position:  [-23.68950608]


portfolio before change:  [-18.08125313]
curr_Stock_Price:  94.6806358730583
curr_Factors:  [94.68063587]
mat_Sqrt:  [[0.15]]
grads:  [0.13863815]
Stock Position:  0.13863815270845678
Bond Position:  [-31.20760159]


portfolio before change:  [-18.0937576]
curr_Stock_Price:  94.60451011761577
curr_Factors:  [94.60451012]
mat_Sqrt:  [[0.15]]
grads:  [0.3291904]
Stock Position:  0.32919039716668164
Bond Position:  [-49.23665386]


portfolio before change:  [-18.2043824]
curr_Stock_Price:  94.2778073526042
curr_Factors:  [94.27780735]
mat_Sqrt:  [[0.15]]
grads:  [0.02387847]
Stock Position:  0.023878465594031707
Bond Position:  [-20.45559178]


portfolio before change:  [-18.19429805]
curr_Stock_Price:  94.75366974379243
curr_Factors:  [94.75366974]
mat_Sqrt:  [[0.15]]
grads:  [0.12413699]
Stock Position:  0.12413698887472902
Bond Position:  [-29.9567333]


portfolio before change:  [-18.23564918]
curr_Stock_Price:  94.43564388301846
curr_Factors:  [94.43564388]
mat_Sqrt:  [[0.15]]
grads:  [0.08909383]
Stock Position:  0.08909382532738773
Bond Position:  [-26.64928194]


portfolio before change:  [-18.31189915]
curr_Stock_Price:  93.59850014378122
curr_Factors:  [93.59850014]
mat_Sqrt:  [[0.15]]
grads:  [-0.09390814]
Stock Position:  -0.09390814207528081
Bond Position:  [-9.5222379]


portfolio before change:  [-18.27784541]
curr_Stock_Price:  93.22953431270295
curr_Factors:  [93.22953431]
mat_Sqrt:  [[0.15]]
grads:  [-0.05658847]
Stock Position:  -0.05658847408470958
Bond Position:  [-13.00212833]


portfolio before change:  [-18.26696696]
curr_Stock_Price:  93.02293552747987
curr_Factors:  [93.02293553]
mat_Sqrt:  [[0.15]]
grads:  [-1.36456634]
Stock Position:  -1.3645663431925996
Bond Position:  [108.669]


portfolio before change:  [-18.68235898]
curr_Stock_Price:  93.33232615530898
curr_Factors:  [93.33232616]
mat_Sqrt:  [[0.15]]
grads:  [-0.09578526]
Stock Position:  -0.09578525625104149
Bond Position:  [-9.7424982]


portfolio before change:  [-18.65818364]
curr_Stock_Price:  93.07357794581347
curr_Factors:  [93.07357795]
mat_Sqrt:  [[0.15]]
grads:  [0.03202469]
Stock Position:  0.03202468972691866
Bond Position:  [-21.63883609]


portfolio before change:  [-18.67925178]
curr_Stock_Price:  92.45793808018773
curr_Factors:  [92.45793808]
mat_Sqrt:  [[0.15]]
grads:  [0.06055158]
Stock Position:  0.06055158399583175
Bond Position:  [-24.27772639]


portfolio before change:  [-18.67079667]
curr_Stock_Price:  92.62263268054498
curr_Factors:  [92.62263268]
mat_Sqrt:  [[0.15]]
grads:  [0.13264681]
Stock Position:  0.13264680821316693
Bond Position:  [-30.95689326]


portfolio before change:  [-18.650788]
curr_Stock_Price:  92.78806097708897
curr_Factors:  [92.78806098]
mat_Sqrt:  [[0.15]]
grads:  [-0.78097953]
Stock Position:  -0.7809795331327484
Bond Position:  [53.81478854]


portfolio before change:  [-18.08589338]
curr_Stock_Price:  92.06905226191017
curr_Factors:  [92.06905226]
mat_Sqrt:  [[0.15]]
grads:  [0.08005859]
Stock Position:  0.08005859036909187
Bond Position:  [-25.45681192]


portfolio before change:  [-18.05239792]
curr_Stock_Price:  92.50731326537742
curr_Factors:  [92.50731327]
mat_Sqrt:  [[0.15]]
grads:  [0.20186276]
Stock Position:  0.2018627567430624
Bond Position:  [-36.7261792]


portfolio before change:  [-17.99397933]
curr_Stock_Price:  92.80808223670986
curr_Factors:  [92.80808224]
mat_Sqrt:  [[0.15]]
grads:  [-0.11328174]
Stock Position:  -0.11328173819821867
Bond Position:  [-7.48051845]


portfolio before change:  [-18.05392277]
curr_Stock_Price:  93.33310855900179
curr_Factors:  [93.33310856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03912257]
Stock Position:  -0.03912256963696587
Bond Position:  [-14.40249173]


portfolio before change:  [-18.07034905]
curr_Stock_Price:  93.72996650895632
curr_Factors:  [93.72996651]
mat_Sqrt:  [[0.15]]
grads:  [0.05631527]
Stock Position:  0.05631527458302389
Bond Position:  [-23.34877785]


portfolio before change:  [-18.01273257]
curr_Stock_Price:  94.7789862044589
curr_Factors:  [94.7789862]
mat_Sqrt:  [[0.15]]
grads:  [0.0914929]
Stock Position:  0.09149290339589658
Bond Position:  [-26.6843372]


portfolio before change:  [-18.02217931]
curr_Stock_Price:  94.69396405778441
curr_Factors:  [94.69396406]
mat_Sqrt:  [[0.15]]
grads:  [0.00489436]
Stock Position:  0.004894361912345958
Bond Position:  [-18.48564584]


portfolio before change:  [-18.02263594]
curr_Stock_Price:  94.83673344871224
curr_Factors:  [94.83673345]
mat_Sqrt:  [[0.15]]
grads:  [-0.20043577]
Stock Position:  -0.2004357730130373
Bond Position:  [0.98603804]


portfolio before change:  [-18.03852087]
curr_Stock_Price:  94.91629292763118
curr_Factors:  [94.91629293]
mat_Sqrt:  [[0.15]]
grads:  [0.0512341]
Stock Position:  0.05123410193487388
Bond Position:  [-22.9014719]


portfolio before change:  [-18.06969684]
curr_Stock_Price:  94.33573069345967
curr_Factors:  [94.33573069]
mat_Sqrt:  [[0.15]]
grads:  [-0.31669608]
Stock Position:  -0.3166960810298513
Bond Position:  [11.80605937]


portfolio before change:  [-18.39953417]
curr_Stock_Price:  95.37955551934323
curr_Factors:  [95.37955552]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327521]
Stock Position:  -0.003275209776272247
Bond Position:  [-18.08714612]


portfolio before change:  [-18.39844808]
curr_Stock_Price:  94.70278114822898
curr_Factors:  [94.70278115]
mat_Sqrt:  [[0.15]]
grads:  [-0.09971804]
Stock Position:  -0.09971804103950525
Bond Position:  [-8.95487226]


portfolio before change:  [-18.34827208]
curr_Stock_Price:  94.1939896611976
curr_Factors:  [94.19398966]
mat_Sqrt:  [[0.15]]
grads:  [0.4157803]
Stock Position:  0.4157802964531849
Bond Position:  [-57.51227703]


portfolio before change:  [-18.63543033]
curr_Stock_Price:  93.51198615862508
curr_Factors:  [93.51198616]
mat_Sqrt:  [[0.15]]
grads:  [0.15720618]
Stock Position:  0.15720617614420207
Bond Position:  [-33.3360921]


portfolio before change:  [-18.45927803]
curr_Stock_Price:  94.64575760589624
curr_Factors:  [94.64575761]
mat_Sqrt:  [[0.15]]
grads:  [0.02193038]
Stock Position:  0.021930380835506972
Bond Position:  [-20.53489554]


portfolio before change:  [-18.46172744]
curr_Stock_Price:  94.59259218141575
curr_Factors:  [94.59259218]
mat_Sqrt:  [[0.15]]
grads:  [0.06527209]
Stock Position:  0.06527209018984094
Bond Position:  [-24.63598365]


portfolio before change:  [-18.41316464]
curr_Stock_Price:  95.36018814417817
curr_Factors:  [95.36018814]
mat_Sqrt:  [[0.15]]
grads:  [0.11684909]
Stock Position:  0.11684908959624758
Bond Position:  [-29.55591581]


portfolio before change:  [-18.36248667]
curr_Stock_Price:  95.80970190773633
curr_Factors:  [95.80970191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00484444]
Stock Position:  -0.004844443786417042
Bond Position:  [-17.89834196]


portfolio before change:  [-18.36133374]
curr_Stock_Price:  95.3407905726575
curr_Factors:  [95.34079057]
mat_Sqrt:  [[0.15]]
grads:  [-0.0520551]
Stock Position:  -0.05205510071663318
Bond Position:  [-13.39835928]


portfolio before change:  [-18.41097584]
curr_Stock_Price:  96.27834852473839
curr_Factors:  [96.27834852]
mat_Sqrt:  [[0.15]]
grads:  [0.03436505]
Stock Position:  0.03436504682835038
Bond Position:  [-21.71958579]


portfolio before change:  [-18.42031172]
curr_Stock_Price:  96.04618336339459
curr_Factors:  [96.04618336]
mat_Sqrt:  [[0.15]]
grads:  [0.0193797]
Stock Position:  0.019379697003515953
Bond Position:  [-20.28165765]


portfolio before change:  [-18.41554363]
curr_Stock_Price:  96.35762953374734
curr_Factors:  [96.35762953]
mat_Sqrt:  [[0.15]]
grads:  [0.25845482]
Stock Position:  0.2584548186572933
Bond Position:  [-43.3196373]


portfolio before change:  [-18.45958486]
curr_Stock_Price:  96.19770343993467
curr_Factors:  [96.19770344]
mat_Sqrt:  [[0.15]]
grads:  [-0.00399987]
Stock Position:  -0.003999873398173512
Bond Position:  [-18.07480623]


portfolio before change:  [-18.45929725]
curr_Stock_Price:  95.84336296135523
curr_Factors:  [95.84336296]
mat_Sqrt:  [[0.15]]
grads:  [0.010484]
Stock Position:  0.010483996890965828
Bond Position:  [-19.46411877]


portfolio before change:  [-18.45562442]
curr_Stock_Price:  96.30972857111246
curr_Factors:  [96.30972857]
mat_Sqrt:  [[0.15]]
grads:  [0.03254249]
Stock Position:  0.032542490953337916
Bond Position:  [-21.5897829]


portfolio before change:  [-18.47578067]
curr_Stock_Price:  95.73181194768978
curr_Factors:  [95.73181195]
mat_Sqrt:  [[0.15]]
grads:  [0.0233857]
Stock Position:  0.023385697311459175
Bond Position:  [-20.71453585]


portfolio before change:  [-18.4582184]
curr_Stock_Price:  96.53815847322103
curr_Factors:  [96.53815847]
mat_Sqrt:  [[0.15]]
grads:  [0.00857073]
Stock Position:  0.00857073495892327
Bond Position:  [-19.28562137]


portfolio before change:  [-18.4532727]
curr_Stock_Price:  97.25584363253395
curr_Factors:  [97.25584363]
mat_Sqrt:  [[0.15]]
grads:  [0.01578401]
Stock Position:  0.015784013519809476
Bond Position:  [-19.98836025]


portfolio before change:  [-18.43748127]
curr_Stock_Price:  98.3354639782059
curr_Factors:  [98.33546398]
mat_Sqrt:  [[0.15]]
grads:  [-0.00316735]
Stock Position:  -0.0031673541563729964
Bond Position:  [-18.12601803]


portfolio before change:  [-18.44214797]
curr_Stock_Price:  99.45115526793013
curr_Factors:  [99.45115527]
mat_Sqrt:  [[0.15]]
grads:  [0.01034919]
Stock Position:  0.010349188016626295
Bond Position:  [-19.47138667]


portfolio before change:  [-18.44345054]
curr_Stock_Price:  99.4428871152284
curr_Factors:  [99.44288712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02549003]
Stock Position:  -0.025490028994252283
Bond Position:  [-15.90864846]


portfolio before change:  [-18.44831639]
curr_Stock_Price:  99.59477113246744
curr_Factors:  [99.59477113]
mat_Sqrt:  [[0.15]]
grads:  [0.00604478]
Stock Position:  0.006044779902772928
Bond Position:  [-19.05034486]


portfolio before change:  [-18.4508096]
curr_Stock_Price:  99.37929102623241
curr_Factors:  [99.37929103]
mat_Sqrt:  [[0.15]]
grads:  [-0.05086412]
Stock Position:  -0.05086411809504118
Bond Position:  [-13.3959696]


portfolio before change:  [-18.40813489]
curr_Stock_Price:  98.52383570507405
curr_Factors:  [98.52383571]
mat_Sqrt:  [[0.15]]
grads:  [0.02965035]
Stock Position:  0.029650347370105204
Bond Position:  [-21.32940085]


portfolio before change:  [-18.39760768]
curr_Stock_Price:  98.92384260162709
curr_Factors:  [98.9238426]
mat_Sqrt:  [[0.15]]
grads:  [-0.11492602]
Stock Position:  -0.11492601509877197
Bond Position:  [-7.02868465]


portfolio before change:  [-18.36143041]
curr_Stock_Price:  98.60523259067386
curr_Factors:  [98.60523259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08619154]
Stock Position:  -0.08619153854638599
Bond Position:  [-9.8624937]


portfolio before change:  [-18.3349103]
curr_Stock_Price:  98.29039274653142
curr_Factors:  [98.29039275]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513093]
Stock Position:  -0.02513092544752282
Bond Position:  [-15.86478177]


portfolio before change:  [-18.33429416]
curr_Stock_Price:  98.22641899327226
curr_Factors:  [98.22641899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224667]
Stock Position:  -0.03224666583129219
Bond Position:  [-15.16681965]


portfolio before change:  [-18.32749277]
curr_Stock_Price:  97.986104285547
curr_Factors:  [97.98610429]
mat_Sqrt:  [[0.15]]
grads:  [0.12601328]
Stock Position:  0.12601328439316345
Bond Position:  [-30.67504359]


portfolio before change:  [-18.31712919]
curr_Stock_Price:  98.0835609454253
curr_Factors:  [98.08356095]
mat_Sqrt:  [[0.15]]
grads:  [-0.06627955]
Stock Position:  -0.06627954828575804
Bond Position:  [-11.81619507]


portfolio before change:  [-18.32033888]
curr_Stock_Price:  98.1208448509544
curr_Factors:  [98.12084485]
mat_Sqrt:  [[0.15]]
grads:  [0.04513782]
Stock Position:  0.04513781821051214
Bond Position:  [-22.74929974]


portfolio before change:  [-18.33522915]
curr_Stock_Price:  97.82246100601337
curr_Factors:  [97.82246101]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131628]
Stock Position:  -0.03131627931146614
Bond Position:  [-15.27179364]


portfolio before change:  [-18.32515307]
curr_Stock_Price:  97.47022899352334
curr_Factors:  [97.47022899]
mat_Sqrt:  [[0.15]]
grads:  [0.07655609]
Stock Position:  0.07655608906193795
Bond Position:  [-25.78709261]


portfolio before change:  [-18.36261112]
curr_Stock_Price:  97.00199318830985
curr_Factors:  [97.00199319]
mat_Sqrt:  [[0.15]]
grads:  [0.00143343]
Stock Position:  0.0014334284559273148
Bond Position:  [-18.50165654]


portfolio before change:  [-18.36408444]
curr_Stock_Price:  96.78089602648157
curr_Factors:  [96.78089603]
mat_Sqrt:  [[0.15]]
grads:  [0.02180633]
Stock Position:  0.021806331393657855
Bond Position:  [-20.47452073]


portfolio before change:  [-18.37891732]
curr_Stock_Price:  96.15937060709953
curr_Factors:  [96.15937061]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033184]
Stock Position:  -0.010331843620228464
Bond Position:  [-17.38541374]


portfolio before change:  [-18.37753433]
curr_Stock_Price:  95.92034084816619
curr_Factors:  [95.92034085]
mat_Sqrt:  [[0.15]]
grads:  [-0.09698942]
Stock Position:  -0.09698942407950903
Bond Position:  [-9.07427571]


portfolio before change:  [-18.34837238]
curr_Stock_Price:  95.61382177991871
curr_Factors:  [95.61382178]
mat_Sqrt:  [[0.15]]
grads:  [0.03456967]
Stock Position:  0.03456966541802954
Bond Position:  [-21.65371021]


portfolio before change:  [-18.33424044]
curr_Stock_Price:  96.0617675845709
curr_Factors:  [96.06176758]
mat_Sqrt:  [[0.15]]
grads:  [0.03651903]
Stock Position:  0.03651902701342267
Bond Position:  [-21.84232273]


portfolio before change:  [-18.33594411]
curr_Stock_Price:  96.05249899030714
curr_Factors:  [96.05249899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.33594411]
Stock Price:  96.08963730351626
PL:  [-18.33594411]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.45781202e-04]
 [ 2.33784985e-04]
 [-4.59839700e-03]
 [ 3.90845113e-03]
 [ 1.49035694e-02]
 [ 2.71374445e-02]
 [ 3.12203947e-03]
 [ 1.52294830e-02]
 [ 2.44737550e-02]
 [-4.21124881e-03]
 [ 5.15913313e-02]
 [ 3.13914464e-03]
 [ 1.00844613e-01]
 [ 1.50235386e-02]
 [-6.89493483e-03]
 [ 3.06583461e-02]
 [ 1.24936092e-02]
 [-4.67593805e-03]
 [ 1.30396226e-02]
 [-7.35886003e-03]
 [ 1.48412533e-02]
 [-1.42055833e-02]
 [ 1.09377209e-02]
 [-5.17809527e-02]
 [ 7.92009395e-03]
 [ 7.25586697e-03]
 [-5.14530817e-03]
 [ 1.53325328e-02]
 [ 5.38550847e-02]
 [ 4.06033158e-03]
 [ 1.88953190e-02]
 [-1.85386272e-03]
 [ 1.67230157e-03]
 [ 8.47028812e-03]
 [ 1.05477023e-02]
 [ 7.75115544e-03]
 [-3.30244971e-02]
 [ 9.12906689e-03]
 [ 9.99940236e-03]
 [ 1.15230475e-02]
 [-4.20651553e-03]
 [-1.89808758e-02]
 [ 2.08003160e-02]
 [-8.14665783e-04]
 [ 2.65257433e-03]
 [-1.25026467e-02]
 [ 1.39530131e-02]
 [ 1.84836100e-03]
 [ 2.61707773e-03]
 [-7.41418219e-03]
 [-3.84554425e-02]
 [ 2.73166710e-03]
 [-9.44182570e-03]
 [ 5.89581646e-03]
 [-1.19858946e-02]
 [ 1.76731282e-02]
 [ 1.07316069e-02]
 [ 5.34159281e-04]
 [ 1.83084369e-03]
 [ 1.00865220e-02]
 [ 1.03320264e-02]
 [ 3.80884644e-02]
 [-2.17981283e-03]
 [-1.20336059e-02]
 [ 1.84645295e-02]
 [ 9.70460638e-03]
 [-4.58143729e-03]
 [ 1.58801656e-02]
 [-2.56486590e-02]
 [-5.47881609e-02]
 [-4.19345106e-05]
 [ 1.77627957e-02]
 [-5.59137947e-02]
 [ 3.01256415e-02]
 [-3.12883348e-02]
 [ 1.27529655e-02]
 [ 2.01466551e-02]
 [-2.47751662e-02]
 [ 2.46745285e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.30885081]
curr_Stock_Price:  100.47255419706602
curr_Factors:  [100.4725542]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230521]
Stock Position:  -0.002305208013924229
Bond Position:  [9.54046095]


portfolio before change:  [9.30831531]
curr_Stock_Price:  100.96352754289101
curr_Factors:  [100.96352754]
mat_Sqrt:  [[0.15]]
grads:  [0.00155857]
Stock Position:  0.001558566566914419
Bond Position:  [9.15095694]


portfolio before change:  [9.30901913]
curr_Stock_Price:  101.04813010028784
curr_Factors:  [101.0481301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03065598]
Stock Position:  -0.030655979977898574
Bond Position:  [12.40674858]


portfolio before change:  [9.30821623]
curr_Stock_Price:  101.09961576600092
curr_Factors:  [101.09961577]
mat_Sqrt:  [[0.15]]
grads:  [0.02605634]
Stock Position:  0.026056340899395354
Bond Position:  [6.67393018]


portfolio before change:  [9.31088987]
curr_Stock_Price:  101.18621673548165
curr_Factors:  [101.18621674]
mat_Sqrt:  [[0.15]]
grads:  [0.09935713]
Stock Position:  0.09935712924096037
Bond Position:  [-0.74268215]


portfolio before change:  [9.36648178]
curr_Stock_Price:  101.74620005113668
curr_Factors:  [101.74620005]
mat_Sqrt:  [[0.15]]
grads:  [0.1809163]
Stock Position:  0.1809162965840283
Bond Position:  [-9.04106392]


portfolio before change:  [9.39547146]
curr_Stock_Price:  101.90956157570427
curr_Factors:  [101.90956158]
mat_Sqrt:  [[0.15]]
grads:  [0.0208136]
Stock Position:  0.020813596487025857
Bond Position:  [7.27436697]


portfolio before change:  [9.4100102]
curr_Stock_Price:  102.58623821218374
curr_Factors:  [102.58623821]
mat_Sqrt:  [[0.15]]
grads:  [0.10152989]
Stock Position:  0.1015298869691553
Bond Position:  [-1.00555897]


portfolio before change:  [9.45029998]
curr_Stock_Price:  102.98368405462061
curr_Factors:  [102.98368405]
mat_Sqrt:  [[0.15]]
grads:  [0.16315837]
Stock Position:  0.1631583665384932
Bond Position:  [-7.35234969]


portfolio before change:  [9.39522628]
curr_Stock_Price:  102.64895305422789
curr_Factors:  [102.64895305]
mat_Sqrt:  [[0.15]]
grads:  [-0.02807499]
Stock Position:  -0.02807499208040881
Bond Position:  [12.27709482]


portfolio before change:  [9.37897826]
curr_Stock_Price:  103.25502137319707
curr_Factors:  [103.25502137]
mat_Sqrt:  [[0.15]]
grads:  [0.34394221]
Stock Position:  0.34394220884829974
Bond Position:  [-26.13478187]


portfolio before change:  [9.13855779]
curr_Stock_Price:  102.56075649140136
curr_Factors:  [102.56075649]
mat_Sqrt:  [[0.15]]
grads:  [0.02092763]
Stock Position:  0.02092763095776463
Bond Position:  [6.99220412]


portfolio before change:  [9.14696352]
curr_Stock_Price:  102.94153074525704
curr_Factors:  [102.94153075]
mat_Sqrt:  [[0.15]]
grads:  [0.67229742]
Stock Position:  0.6722974180825354
Bond Position:  [-60.06036182]


portfolio before change:  [9.26763812]
curr_Stock_Price:  103.12661028097337
curr_Factors:  [103.12661028]
mat_Sqrt:  [[0.15]]
grads:  [0.10015692]
Stock Position:  0.10015692407297187
Bond Position:  [-1.06120596]


portfolio before change:  [9.25931937]
curr_Stock_Price:  103.0442153142407
curr_Factors:  [103.04421531]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596623]
Stock Position:  -0.045966232192034454
Bond Position:  [13.99587369]


portfolio before change:  [9.2457189]
curr_Stock_Price:  103.35912547379208
curr_Factors:  [103.35912547]
mat_Sqrt:  [[0.15]]
grads:  [0.20438897]
Stock Position:  0.20438897399402192
Bond Position:  [-11.87974671]


portfolio before change:  [9.18551272]
curr_Stock_Price:  103.0681916044728
curr_Factors:  [103.0681916]
mat_Sqrt:  [[0.15]]
grads:  [0.08329073]
Stock Position:  0.08329072766712926
Bond Position:  [0.60088804]


portfolio before change:  [9.20950859]
curr_Stock_Price:  103.35583848708791
curr_Factors:  [103.35583849]
mat_Sqrt:  [[0.15]]
grads:  [-0.03117292]
Stock Position:  -0.031172920354274738
Bond Position:  [12.43141192]


portfolio before change:  [9.18590459]
curr_Stock_Price:  104.13795946896079
curr_Factors:  [104.13795947]
mat_Sqrt:  [[0.15]]
grads:  [0.08693082]
Stock Position:  0.08693081765244594
Bond Position:  [0.13310662]


portfolio before change:  [9.11149559]
curr_Stock_Price:  103.28190729610925
curr_Factors:  [103.2819073]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905907]
Stock Position:  -0.04905906688320147
Bond Position:  [14.17840959]


portfolio before change:  [9.07855234]
curr_Stock_Price:  103.97147263281181
curr_Factors:  [103.97147263]
mat_Sqrt:  [[0.15]]
grads:  [0.09894169]
Stock Position:  0.09894168889330564
Bond Position:  [-1.20856076]


portfolio before change:  [9.09396116]
curr_Stock_Price:  104.12797244418694
curr_Factors:  [104.12797244]
mat_Sqrt:  [[0.15]]
grads:  [-0.09470389]
Stock Position:  -0.09470388864686918
Bond Position:  [18.95528506]


portfolio before change:  [9.13581427]
curr_Stock_Price:  103.69854584307208
curr_Factors:  [103.69854584]
mat_Sqrt:  [[0.15]]
grads:  [0.07291814]
Stock Position:  0.07291813923290576
Bond Position:  [1.57430926]


portfolio before change:  [9.15891414]
curr_Stock_Price:  104.01398834080405
curr_Factors:  [104.01398834]
mat_Sqrt:  [[0.15]]
grads:  [-0.34520635]
Stock Position:  -0.34520635101900476
Bond Position:  [45.06520351]


portfolio before change:  [9.24647785]
curr_Stock_Price:  103.76849158113741
curr_Factors:  [103.76849158]
mat_Sqrt:  [[0.15]]
grads:  [0.05280063]
Stock Position:  0.052800626305044125
Bond Position:  [3.7674365]


portfolio before change:  [9.20950162]
curr_Stock_Price:  103.06373292207154
curr_Factors:  [103.06373292]
mat_Sqrt:  [[0.15]]
grads:  [0.04837245]
Stock Position:  0.048372446463387224
Bond Position:  [4.22405672]


portfolio before change:  [9.21710612]
curr_Stock_Price:  103.21548233160964
curr_Factors:  [103.21548233]
mat_Sqrt:  [[0.15]]
grads:  [-0.03430205]
Stock Position:  -0.034302054478350344
Bond Position:  [12.75760922]


portfolio before change:  [9.19796388]
curr_Stock_Price:  103.79677742015942
curr_Factors:  [103.79677742]
mat_Sqrt:  [[0.15]]
grads:  [0.10221689]
Stock Position:  0.10221688554498584
Bond Position:  [-1.41181943]


portfolio before change:  [9.22170062]
curr_Stock_Price:  104.0298600099755
curr_Factors:  [104.02986001]
mat_Sqrt:  [[0.15]]
grads:  [0.3590339]
Stock Position:  0.3590338976777748
Bond Position:  [-28.1285455]


portfolio before change:  [9.02208618]
curr_Stock_Price:  103.4787801517883
curr_Factors:  [103.47878015]
mat_Sqrt:  [[0.15]]
grads:  [0.02706888]
Stock Position:  0.027068877194219347
Bond Position:  [6.22103179]


portfolio before change:  [9.03308171]
curr_Stock_Price:  103.87062144115428
curr_Factors:  [103.87062144]
mat_Sqrt:  [[0.15]]
grads:  [0.12596879]
Stock Position:  0.12596879325698881
Bond Position:  [-4.05137513]


portfolio before change:  [9.01460963]
curr_Stock_Price:  103.72599151342978
curr_Factors:  [103.72599151]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235908]
Stock Position:  -0.012359084832863916
Bond Position:  [10.29656796]


portfolio before change:  [9.02225671]
curr_Stock_Price:  103.15932136510189
curr_Factors:  [103.15932137]
mat_Sqrt:  [[0.15]]
grads:  [0.01114868]
Stock Position:  0.011148677108744565
Bond Position:  [7.87216675]


portfolio before change:  [9.01854874]
curr_Stock_Price:  102.7825949636709
curr_Factors:  [102.78259496]
mat_Sqrt:  [[0.15]]
grads:  [0.05646859]
Stock Position:  0.05646858748932278
Bond Position:  [3.21456078]


portfolio before change:  [9.03449071]
curr_Stock_Price:  103.06135274480113
curr_Factors:  [103.06135274]
mat_Sqrt:  [[0.15]]
grads:  [0.07031802]
Stock Position:  0.07031801562032906
Bond Position:  [1.7874209]


portfolio before change:  [9.044333]
curr_Stock_Price:  103.19973216296543
curr_Factors:  [103.19973216]
mat_Sqrt:  [[0.15]]
grads:  [0.05167437]
Stock Position:  0.05167436959514357
Bond Position:  [3.71155189]


portfolio before change:  [9.03795304]
curr_Stock_Price:  103.07177831148921
curr_Factors:  [103.07177831]
mat_Sqrt:  [[0.15]]
grads:  [-0.22016331]
Stock Position:  -0.2201633140760657
Bond Position:  [31.73057734]


portfolio before change:  [9.06746231]
curr_Stock_Price:  102.9467527146246
curr_Factors:  [102.94675271]
mat_Sqrt:  [[0.15]]
grads:  [0.06086045]
Stock Position:  0.0608604459107734
Bond Position:  [2.80207704]


portfolio before change:  [9.09290333]
curr_Stock_Price:  103.36189721526308
curr_Factors:  [103.36189722]
mat_Sqrt:  [[0.15]]
grads:  [0.06666268]
Stock Position:  0.06666268238542972
Bond Position:  [2.202522]


portfolio before change:  [9.09888214]
curr_Stock_Price:  103.44951962859065
curr_Factors:  [103.44951963]
mat_Sqrt:  [[0.15]]
grads:  [0.07682032]
Stock Position:  0.07682031656811925
Bond Position:  [1.15185729]


portfolio before change:  [9.07348894]
curr_Stock_Price:  103.11802931924079
curr_Factors:  [103.11802932]
mat_Sqrt:  [[0.15]]
grads:  [-0.02804344]
Stock Position:  -0.028043436899596666
Bond Position:  [11.96527289]


portfolio before change:  [9.07264788]
curr_Stock_Price:  103.17468812823341
curr_Factors:  [103.17468813]
mat_Sqrt:  [[0.15]]
grads:  [-0.12653917]
Stock Position:  -0.12653917180159566
Bond Position:  [22.12828747]


portfolio before change:  [9.06477133]
curr_Stock_Price:  103.24786401852491
curr_Factors:  [103.24786402]
mat_Sqrt:  [[0.15]]
grads:  [0.13866877]
Stock Position:  0.1386687732919604
Bond Position:  [-5.25248332]


portfolio before change:  [9.01807777]
curr_Stock_Price:  102.91350417156464
curr_Factors:  [102.91350417]
mat_Sqrt:  [[0.15]]
grads:  [-0.00543111]
Stock Position:  -0.005431105223092208
Bond Position:  [9.57701184]


portfolio before change:  [9.01685796]
curr_Stock_Price:  103.24831454332116
curr_Factors:  [103.24831454]
mat_Sqrt:  [[0.15]]
grads:  [0.01768383]
Stock Position:  0.0176838288448813
Bond Position:  [7.19103244]


portfolio before change:  [9.00460417]
curr_Stock_Price:  102.52996064862883
curr_Factors:  [102.52996065]
mat_Sqrt:  [[0.15]]
grads:  [-0.08335098]
Stock Position:  -0.08335097809512426
Bond Position:  [17.55057667]


portfolio before change:  [8.99326416]
curr_Stock_Price:  102.6791724312707
curr_Factors:  [102.67917243]
mat_Sqrt:  [[0.15]]
grads:  [0.09302009]
Stock Position:  0.09302008732432766
Bond Position:  [-0.55796142]


portfolio before change:  [8.98057727]
curr_Stock_Price:  102.54315859244534
curr_Factors:  [102.54315859]
mat_Sqrt:  [[0.15]]
grads:  [0.01232241]
Stock Position:  0.012322406672352123
Bond Position:  [7.71699877]


portfolio before change:  [8.98700823]
curr_Stock_Price:  103.02590803000403
curr_Factors:  [103.02590803]
mat_Sqrt:  [[0.15]]
grads:  [0.01744718]
Stock Position:  0.01744718486782092
Bond Position:  [7.18949617]


portfolio before change:  [8.98249066]
curr_Stock_Price:  102.74122418961723
curr_Factors:  [102.74122419]
mat_Sqrt:  [[0.15]]
grads:  [-0.04942788]
Stock Position:  -0.04942788127398969
Bond Position:  [14.06077169]


portfolio before change:  [8.9816739]
curr_Stock_Price:  102.77552841184495
curr_Factors:  [102.77552841]
mat_Sqrt:  [[0.15]]
grads:  [-0.25636962]
Stock Position:  -0.25636961691488686
Bond Position:  [35.33019675]


portfolio before change:  [8.7855801]
curr_Stock_Price:  103.54902882352901
curr_Factors:  [103.54902882]
mat_Sqrt:  [[0.15]]
grads:  [0.01821111]
Stock Position:  0.018211113977976645
Bond Position:  [6.89983694]


portfolio before change:  [8.80579533]
curr_Stock_Price:  104.63539726449268
curr_Factors:  [104.63539726]
mat_Sqrt:  [[0.15]]
grads:  [-0.0629455]
Stock Position:  -0.06294550464226836
Bond Position:  [15.39212322]


portfolio before change:  [8.79448761]
curr_Stock_Price:  104.83032396355323
curr_Factors:  [104.83032396]
mat_Sqrt:  [[0.15]]
grads:  [0.03930544]
Stock Position:  0.0393054430784418
Bond Position:  [4.67408528]


portfolio before change:  [8.78203648]
curr_Stock_Price:  104.50611267740163
curr_Factors:  [104.50611268]
mat_Sqrt:  [[0.15]]
grads:  [-0.07990596]
Stock Position:  -0.07990596399570284
Bond Position:  [17.13269816]


portfolio before change:  [8.75894786]
curr_Stock_Price:  104.80846117143683
curr_Factors:  [104.80846117]
mat_Sqrt:  [[0.15]]
grads:  [0.11782085]
Stock Position:  0.11782085455736252
Bond Position:  [-3.5896746]


portfolio before change:  [8.69848897]
curr_Stock_Price:  104.29722291193437
curr_Factors:  [104.29722291]
mat_Sqrt:  [[0.15]]
grads:  [0.07154405]
Stock Position:  0.07154404572684188
Bond Position:  [1.23664369]


portfolio before change:  [8.69830007]
curr_Stock_Price:  104.29350224271701
curr_Factors:  [104.29350224]
mat_Sqrt:  [[0.15]]
grads:  [0.00356106]
Stock Position:  0.0035610618708179016
Bond Position:  [8.32690446]


portfolio before change:  [8.70087829]
curr_Stock_Price:  104.87135377754338
curr_Factors:  [104.87135378]
mat_Sqrt:  [[0.15]]
grads:  [0.01220562]
Stock Position:  0.012205624617865765
Bond Position:  [7.42085791]


portfolio before change:  [8.70038386]
curr_Stock_Price:  104.79284566780501
curr_Factors:  [104.79284567]
mat_Sqrt:  [[0.15]]
grads:  [0.06724348]
Stock Position:  0.0672434797975176
Bond Position:  [1.65374826]


portfolio before change:  [8.6941105]
curr_Stock_Price:  104.6980152005029
curr_Factors:  [104.6980152]
mat_Sqrt:  [[0.15]]
grads:  [0.06888018]
Stock Position:  0.06888017617792265
Bond Position:  [1.48249276]


portfolio before change:  [8.77457885]
curr_Stock_Price:  105.86490669873092
curr_Factors:  [105.8649067]
mat_Sqrt:  [[0.15]]
grads:  [0.2539231]
Stock Position:  0.2539230962195447
Bond Position:  [-18.10696604]


portfolio before change:  [8.90745265]
curr_Stock_Price:  106.39264729867085
curr_Factors:  [106.3926473]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453209]
Stock Position:  -0.014532085552559719
Bond Position:  [10.45355971]


portfolio before change:  [8.90216256]
curr_Stock_Price:  106.80163582114146
curr_Factors:  [106.80163582]
mat_Sqrt:  [[0.15]]
grads:  [-0.08022404]
Stock Position:  -0.08022403927261905
Bond Position:  [17.47022119]


portfolio before change:  [8.83531729]
curr_Stock_Price:  107.64847915830312
curr_Factors:  [107.64847916]
mat_Sqrt:  [[0.15]]
grads:  [0.12309686]
Stock Position:  0.12309686334550238
Bond Position:  [-4.41587283]


portfolio before change:  [8.88848927]
curr_Stock_Price:  108.08267359959294
curr_Factors:  [108.0826736]
mat_Sqrt:  [[0.15]]
grads:  [0.06469738]
Stock Position:  0.0646973758838988
Bond Position:  [1.89582391]


portfolio before change:  [8.89207298]
curr_Stock_Price:  108.13623399220329
curr_Factors:  [108.13623399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054292]
Stock Position:  -0.030542915270812983
Bond Position:  [12.19486881]


portfolio before change:  [8.86905323]
curr_Stock_Price:  108.91487458542862
curr_Factors:  [108.91487459]
mat_Sqrt:  [[0.15]]
grads:  [0.10586777]
Stock Position:  0.10586777062982283
Bond Position:  [-2.66152173]


portfolio before change:  [8.88720855]
curr_Stock_Price:  109.08793645584525
curr_Factors:  [109.08793646]
mat_Sqrt:  [[0.15]]
grads:  [-0.17099106]
Stock Position:  -0.17099106030959357
Bond Position:  [27.54027047]


portfolio before change:  [8.89894065]
curr_Stock_Price:  109.0293908263401
curr_Factors:  [109.02939083]
mat_Sqrt:  [[0.15]]
grads:  [-0.36525441]
Stock Position:  -0.3652544061621977
Bond Position:  [48.72240605]


portfolio before change:  [8.86912634]
curr_Stock_Price:  109.1193542995095
curr_Factors:  [109.1193543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027956]
Stock Position:  -0.0002795634039871644
Bond Position:  [8.89963212]


portfolio before change:  [8.86947783]
curr_Stock_Price:  109.85177705609928
curr_Factors:  [109.85177706]
mat_Sqrt:  [[0.15]]
grads:  [0.11841864]
Stock Position:  0.11841863779128353
Bond Position:  [-4.13901997]


portfolio before change:  [9.00183777]
curr_Stock_Price:  110.97169065474087
curr_Factors:  [110.97169065]
mat_Sqrt:  [[0.15]]
grads:  [-0.37275863]
Stock Position:  -0.37275863123348835
Bond Position:  [50.36749329]


portfolio before change:  [8.90901118]
curr_Stock_Price:  111.22916198549144
curr_Factors:  [111.22916199]
mat_Sqrt:  [[0.15]]
grads:  [0.20083761]
Stock Position:  0.2008376102540922
Bond Position:  [-13.4299879]


portfolio before change:  [9.0379819]
curr_Stock_Price:  111.87550568396625
curr_Factors:  [111.87550568]
mat_Sqrt:  [[0.15]]
grads:  [-0.2085889]
Stock Position:  -0.20858889871322178
Bond Position:  [32.37397043]


portfolio before change:  [8.87114233]
curr_Stock_Price:  112.68505505072484
curr_Factors:  [112.68505505]
mat_Sqrt:  [[0.15]]
grads:  [0.08501977]
Stock Position:  0.085019769910292
Bond Position:  [-0.70931512]


portfolio before change:  [8.8490914]
curr_Stock_Price:  112.42621410793994
curr_Factors:  [112.42621411]
mat_Sqrt:  [[0.15]]
grads:  [0.13431103]
Stock Position:  0.13431103396736865
Bond Position:  [-6.25098966]


portfolio before change:  [8.8130997]
curr_Stock_Price:  112.16115028670649
curr_Factors:  [112.16115029]
mat_Sqrt:  [[0.15]]
grads:  [-0.16516777]
Stock Position:  -0.16516777443314715
Bond Position:  [27.33850727]


portfolio before change:  [8.80762528]
curr_Stock_Price:  112.20464022295013
curr_Factors:  [112.20464022]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.80762528]
Stock Price:  111.74190135184223
PL:  [-2.93427608]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.68312996e-04]
 [-3.81855870e-03]
 [-4.49975510e-03]
 [ 3.94358268e-03]
 [ 1.95549394e-02]
 [ 2.80509833e-02]
 [ 2.85495288e-03]
 [ 7.24995407e-03]
 [ 2.46252554e-02]
 [-4.97163531e-03]
 [ 3.85709956e-02]
 [-4.81158612e-02]
 [ 6.02523465e-02]
 [ 4.45861761e-03]
 [-6.90084566e-03]
 [ 1.79932234e-02]
 [ 1.03269493e-02]
 [-1.14389082e-02]
 [-5.63084051e-04]
 [-5.55096832e-03]
 [ 1.19960155e-02]
 [-4.94411905e-03]
 [ 6.86722943e-03]
 [ 2.89218999e-02]
 [-4.28447972e-04]
 [ 1.45346663e-02]
 [-7.07444656e-03]
 [ 5.72090504e-03]
 [-9.96110897e-04]
 [-3.28789088e-03]
 [ 8.19928124e-03]
 [-1.17019770e-02]
 [ 9.45372765e-03]
 [ 7.47196759e-03]
 [ 1.09314211e-02]
 [ 8.49989000e-03]
 [-3.36574226e-02]
 [ 9.56657372e-03]
 [ 3.08150111e-03]
 [ 1.98324954e-02]
 [-4.83818723e-03]
 [-2.11285599e-02]
 [ 2.23900108e-02]
 [ 3.25233110e-03]
 [-7.22072718e-03]
 [-1.78920968e-04]
 [ 9.29791301e-03]
 [-1.19463475e-02]
 [-1.53124665e-02]
 [-7.08794464e-03]
 [ 4.76539930e-02]
 [-6.18122059e-03]
 [-2.77414113e-04]
 [ 5.45434794e-03]
 [ 3.95052714e-03]
 [-1.10776466e-03]
 [ 3.91726930e-03]
 [-1.11490466e-04]
 [ 1.55620321e-03]
 [-1.56862495e-03]
 [ 1.28267793e-03]
 [-1.83421144e-03]
 [ 1.75224343e-03]
 [-1.56622238e-02]
 [-1.12917428e-02]
 [ 1.74822251e-03]
 [-5.51968312e-03]
 [ 2.42152052e-02]
 [-8.20673256e-03]
 [ 8.15412972e-03]
 [-9.85543862e-03]
 [ 1.06604706e-02]
 [-7.83190570e-03]
 [ 1.74337164e-02]
 [-2.24787851e-02]
 [-1.67306123e-03]
 [-1.02976748e-02]
 [-3.60005943e-03]
 [ 2.99524380e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.95532342]
curr_Stock_Price:  100.90474080503805
curr_Factors:  [100.90474081]
mat_Sqrt:  [[0.15]]
grads:  [-0.00178875]
Stock Position:  -0.0017887533088697025
Bond Position:  [16.13581711]


portfolio before change:  [15.95528966]
curr_Stock_Price:  101.4874256189299
curr_Factors:  [101.48742562]
mat_Sqrt:  [[0.15]]
grads:  [-0.02545706]
Stock Position:  -0.025457058001202633
Bond Position:  [18.53886094]


portfolio before change:  [15.96193284]
curr_Stock_Price:  101.27198570710878
curr_Factors:  [101.27198571]
mat_Sqrt:  [[0.15]]
grads:  [-0.02999837]
Stock Position:  -0.029998367334542465
Bond Position:  [18.99992707]


portfolio before change:  [15.96854461]
curr_Stock_Price:  101.09116793053528
curr_Factors:  [101.09116793]
mat_Sqrt:  [[0.15]]
grads:  [0.02629055]
Stock Position:  0.02629055118267463
Bond Position:  [13.31080209]


portfolio before change:  [15.97841849]
curr_Stock_Price:  101.43509101614745
curr_Factors:  [101.43509102]
mat_Sqrt:  [[0.15]]
grads:  [0.13036626]
Stock Position:  0.13036626295982398
Bond Position:  [2.75470474]


portfolio before change:  [15.91353118]
curr_Stock_Price:  100.93603945586327
curr_Factors:  [100.93603946]
mat_Sqrt:  [[0.15]]
grads:  [0.18700656]
Stock Position:  0.18700655530814125
Bond Position:  [-2.96216987]


portfolio before change:  [16.07158626]
curr_Stock_Price:  101.78221421898758
curr_Factors:  [101.78221422]
mat_Sqrt:  [[0.15]]
grads:  [0.01903302]
Stock Position:  0.01903301917647512
Bond Position:  [14.13436343]


portfolio before change:  [16.07078171]
curr_Stock_Price:  101.69352721678734
curr_Factors:  [101.69352722]
mat_Sqrt:  [[0.15]]
grads:  [0.04833303]
Stock Position:  0.04833302716648722
Bond Position:  [11.15562569]


portfolio before change:  [16.08839167]
curr_Stock_Price:  102.04344770233322
curr_Factors:  [102.0434477]
mat_Sqrt:  [[0.15]]
grads:  [0.16416837]
Stock Position:  0.16416836923621364
Bond Position:  [-0.66391473]


portfolio before change:  [16.1304672]
curr_Stock_Price:  102.29999546840155
curr_Factors:  [102.29999547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03314424]
Stock Position:  -0.03314423541651594
Bond Position:  [19.52112234]


portfolio before change:  [16.12880915]
curr_Stock_Price:  102.38683304554013
curr_Factors:  [102.38683305]
mat_Sqrt:  [[0.15]]
grads:  [0.25713997]
Stock Position:  0.2571399709599295
Bond Position:  [-10.19893813]


portfolio before change:  [15.97964494]
curr_Stock_Price:  101.80922252527087
curr_Factors:  [101.80922253]
mat_Sqrt:  [[0.15]]
grads:  [-0.32077241]
Stock Position:  -0.32077240792347794
Bond Position:  [48.6372344]


portfolio before change:  [15.9524483]
curr_Stock_Price:  101.90348425785164
curr_Factors:  [101.90348426]
mat_Sqrt:  [[0.15]]
grads:  [0.40168231]
Stock Position:  0.4016823099565812
Bond Position:  [-24.98037865]


portfolio before change:  [15.79239284]
curr_Stock_Price:  101.50890840150667
curr_Factors:  [101.5089084]
mat_Sqrt:  [[0.15]]
grads:  [0.02972412]
Stock Position:  0.0297241173866791
Bond Position:  [12.77513013]


portfolio before change:  [15.79363354]
curr_Stock_Price:  101.5237863669021
curr_Factors:  [101.52378637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600564]
Stock Position:  -0.04600563774267693
Bond Position:  [20.46430008]


portfolio before change:  [15.8285223]
curr_Stock_Price:  100.79323031303147
curr_Factors:  [100.79323031]
mat_Sqrt:  [[0.15]]
grads:  [0.11995482]
Stock Position:  0.11995482247360865
Bond Position:  [3.73788825]


portfolio before change:  [15.83995082]
curr_Stock_Price:  100.8865562438508
curr_Factors:  [100.88655624]
mat_Sqrt:  [[0.15]]
grads:  [0.06884633]
Stock Position:  0.06884632888256274
Bond Position:  [8.89428179]


portfolio before change:  [15.83589856]
curr_Stock_Price:  100.81962206794282
curr_Factors:  [100.81962207]
mat_Sqrt:  [[0.15]]
grads:  [-0.07625939]
Stock Position:  -0.07625938788157946
Bond Position:  [23.52434122]


portfolio before change:  [15.81686644]
curr_Stock_Price:  101.08847335793789
curr_Factors:  [101.08847336]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375389]
Stock Position:  -0.0037538936746495228
Bond Position:  [16.19634182]


portfolio before change:  [15.8161418]
curr_Stock_Price:  101.55117848248054
curr_Factors:  [101.55117848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03700646]
Stock Position:  -0.037006455484507414
Bond Position:  [19.57419096]


portfolio before change:  [15.8510904]
curr_Stock_Price:  100.63984609838162
curr_Factors:  [100.6398461]
mat_Sqrt:  [[0.15]]
grads:  [0.07997344]
Stock Position:  0.07997343687489733
Bond Position:  [7.80257602]


portfolio before change:  [15.88459802]
curr_Stock_Price:  101.05273245646849
curr_Factors:  [101.05273246]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296079]
Stock Position:  -0.032960793649893176
Bond Position:  [19.21537628]


portfolio before change:  [15.89512911]
curr_Stock_Price:  100.76966610691215
curr_Factors:  [100.76966611]
mat_Sqrt:  [[0.15]]
grads:  [0.04578153]
Stock Position:  0.0457815295226994
Bond Position:  [11.28173967]


portfolio before change:  [15.89775558]
curr_Stock_Price:  100.81163362306863
curr_Factors:  [100.81163362]
mat_Sqrt:  [[0.15]]
grads:  [0.19281267]
Stock Position:  0.19281266603722078
Bond Position:  [-3.54000427]


portfolio before change:  [15.83263263]
curr_Stock_Price:  100.47502868552569
curr_Factors:  [100.47502869]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285632]
Stock Position:  -0.0028563198108196713
Bond Position:  [16.11962144]


portfolio before change:  [15.83351575]
curr_Stock_Price:  100.51857397605617
curr_Factors:  [100.51857398]
mat_Sqrt:  [[0.15]]
grads:  [0.09689778]
Stock Position:  0.09689777551157684
Bond Position:  [6.09348954]


portfolio before change:  [15.79841773]
curr_Stock_Price:  100.15242649255232
curr_Factors:  [100.15242649]
mat_Sqrt:  [[0.15]]
grads:  [-0.04716298]
Stock Position:  -0.0471629770485196
Bond Position:  [20.52190432]


portfolio before change:  [15.80685524]
curr_Stock_Price:  100.00072178014614
curr_Factors:  [100.00072178]
mat_Sqrt:  [[0.15]]
grads:  [0.03813937]
Stock Position:  0.03813936691034719
Bond Position:  [11.99289102]


portfolio before change:  [15.81216977]
curr_Stock_Price:  100.12041309666705
curr_Factors:  [100.1204131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00664074]
Stock Position:  -0.006640739314803246
Bond Position:  [16.47704333]


portfolio before change:  [15.80930069]
curr_Stock_Price:  100.70753474493137
curr_Factors:  [100.70753474]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191927]
Stock Position:  -0.021919272521898032
Bond Position:  [18.01673659]


portfolio before change:  [15.80517507]
curr_Stock_Price:  100.94712756861907
curr_Factors:  [100.94712757]
mat_Sqrt:  [[0.15]]
grads:  [0.05466187]
Stock Position:  0.05466187493913292
Bond Position:  [10.28721581]


portfolio before change:  [15.82115505]
curr_Stock_Price:  101.22770704179212
curr_Factors:  [101.22770704]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801318]
Stock Position:  -0.07801318022703355
Bond Position:  [23.7182504]


portfolio before change:  [15.81869007]
curr_Stock_Price:  101.27830632488202
curr_Factors:  [101.27830632]
mat_Sqrt:  [[0.15]]
grads:  [0.06302485]
Stock Position:  0.06302485102283527
Bond Position:  [9.4356399]


portfolio before change:  [15.80411907]
curr_Stock_Price:  101.03775445410476
curr_Factors:  [101.03775445]
mat_Sqrt:  [[0.15]]
grads:  [0.04981312]
Stock Position:  0.049813117295668355
Bond Position:  [10.77111356]


portfolio before change:  [15.85339082]
curr_Stock_Price:  102.01337153947217
curr_Factors:  [102.01337154]
mat_Sqrt:  [[0.15]]
grads:  [0.07287614]
Stock Position:  0.07287614068027837
Bond Position:  [8.41905]


portfolio before change:  [15.84915615]
curr_Stock_Price:  101.94804327984308
curr_Factors:  [101.94804328]
mat_Sqrt:  [[0.15]]
grads:  [0.05666593]
Stock Position:  0.05666593332972837
Bond Position:  [10.07217513]


portfolio before change:  [15.84319939]
curr_Stock_Price:  101.83181309185245
curr_Factors:  [101.83181309]
mat_Sqrt:  [[0.15]]
grads:  [-0.22438282]
Stock Position:  -0.2243828175834517
Bond Position:  [38.69250853]


portfolio before change:  [15.86288278]
curr_Stock_Price:  101.75486853307103
curr_Factors:  [101.75486853]
mat_Sqrt:  [[0.15]]
grads:  [0.06377716]
Stock Position:  0.06377715813868982
Bond Position:  [9.37324644]


portfolio before change:  [15.84545223]
curr_Stock_Price:  101.47237861220385
curr_Factors:  [101.47237861]
mat_Sqrt:  [[0.15]]
grads:  [0.02054334]
Stock Position:  0.020543340732954326
Bond Position:  [13.76087058]


portfolio before change:  [15.86122844]
curr_Stock_Price:  102.1984599597595
curr_Factors:  [102.19845996]
mat_Sqrt:  [[0.15]]
grads:  [0.13221664]
Stock Position:  0.13221663624777402
Bond Position:  [2.34889184]


portfolio before change:  [15.86947572]
curr_Stock_Price:  102.25972655341772
curr_Factors:  [102.25972655]
mat_Sqrt:  [[0.15]]
grads:  [-0.03225458]
Stock Position:  -0.03225458154591047
Bond Position:  [19.16782041]


portfolio before change:  [15.86873268]
curr_Stock_Price:  102.31990593152655
curr_Factors:  [102.31990593]
mat_Sqrt:  [[0.15]]
grads:  [-0.14085707]
Stock Position:  -0.1408570662000263
Bond Position:  [30.28121445]


portfolio before change:  [16.01339619]
curr_Stock_Price:  101.30631903223954
curr_Factors:  [101.30631903]
mat_Sqrt:  [[0.15]]
grads:  [0.14926674]
Stock Position:  0.14926673887581732
Bond Position:  [0.89173232]


portfolio before change:  [15.9029737]
curr_Stock_Price:  100.56617942730368
curr_Factors:  [100.56617943]
mat_Sqrt:  [[0.15]]
grads:  [0.02168221]
Stock Position:  0.021682207356896695
Bond Position:  [13.72247695]


portfolio before change:  [15.91138909]
curr_Stock_Price:  100.9147465981625
curr_Factors:  [100.9147466]
mat_Sqrt:  [[0.15]]
grads:  [-0.04813818]
Stock Position:  -0.048138181197246256
Bond Position:  [20.76924145]


portfolio before change:  [15.9019959]
curr_Stock_Price:  101.13684289590165
curr_Factors:  [101.1368429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119281]
Stock Position:  -0.0011928064526385332
Bond Position:  [16.02263258]


portfolio before change:  [15.90354832]
curr_Stock_Price:  100.67492567997317
curr_Factors:  [100.67492568]
mat_Sqrt:  [[0.15]]
grads:  [0.06198609]
Stock Position:  0.061986086722698036
Bond Position:  [9.66310365]


portfolio before change:  [15.86229561]
curr_Stock_Price:  99.99966657280001
curr_Factors:  [99.99966657]
mat_Sqrt:  [[0.15]]
grads:  [-0.07964232]
Stock Position:  -0.07964231640267994
Bond Position:  [23.8265007]


portfolio before change:  [15.8574732]
curr_Stock_Price:  100.0789161284363
curr_Factors:  [100.07891613]
mat_Sqrt:  [[0.15]]
grads:  [-0.10208311]
Stock Position:  -0.10208310999772473
Bond Position:  [26.0738402]


portfolio before change:  [15.84450225]
curr_Stock_Price:  100.2219428718743
curr_Factors:  [100.22194287]
mat_Sqrt:  [[0.15]]
grads:  [-0.04725296]
Stock Position:  -0.047252964253555074
Bond Position:  [20.58028613]


portfolio before change:  [15.88445586]
curr_Stock_Price:  99.40363865833443
curr_Factors:  [99.40363866]
mat_Sqrt:  [[0.15]]
grads:  [0.31769329]
Stock Position:  0.3176932865804991
Bond Position:  [-15.69541281]


portfolio before change:  [16.41022468]
curr_Stock_Price:  101.06168382433833
curr_Factors:  [101.06168382]
mat_Sqrt:  [[0.15]]
grads:  [-0.04120814]
Stock Position:  -0.04120813726369551
Bond Position:  [20.57478842]


portfolio before change:  [16.42013858]
curr_Stock_Price:  100.85230924950082
curr_Factors:  [100.85230925]
mat_Sqrt:  [[0.15]]
grads:  [-0.00184943]
Stock Position:  -0.0018494274222712974
Bond Position:  [16.60665761]


portfolio before change:  [16.41929507]
curr_Stock_Price:  101.86962902062218
curr_Factors:  [101.86962902]
mat_Sqrt:  [[0.15]]
grads:  [0.03636232]
Stock Position:  0.03636231961770476
Bond Position:  [12.71507906]


portfolio before change:  [16.397996]
curr_Stock_Price:  101.26202782067087
curr_Factors:  [101.26202782]
mat_Sqrt:  [[0.15]]
grads:  [0.02633685]
Stock Position:  0.02633684758304132
Bond Position:  [13.73107341]


portfolio before change:  [16.40684644]
curr_Stock_Price:  101.56548954730567
curr_Factors:  [101.56548955]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073851]
Stock Position:  -0.007385097723261678
Bond Position:  [17.15691751]


portfolio before change:  [16.41501902]
curr_Stock_Price:  100.604062936356
curr_Factors:  [100.60406294]
mat_Sqrt:  [[0.15]]
grads:  [0.02611513]
Stock Position:  0.026115128697974246
Bond Position:  [13.78773096]


portfolio before change:  [16.39539104]
curr_Stock_Price:  99.81947050210115
curr_Factors:  [99.8194705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074327]
Stock Position:  -0.0007432697740264218
Bond Position:  [16.46958384]


portfolio before change:  [16.39642554]
curr_Stock_Price:  99.81258153968228
curr_Factors:  [99.81258154]
mat_Sqrt:  [[0.15]]
grads:  [0.01037469]
Stock Position:  0.010374688096352423
Bond Position:  [15.36090114]


portfolio before change:  [16.39108849]
curr_Stock_Price:  99.2056097191473
curr_Factors:  [99.20560972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0104575]
Stock Position:  -0.010457499679506002
Bond Position:  [17.42853112]


portfolio before change:  [16.39682627]
curr_Stock_Price:  98.7610991846686
curr_Factors:  [98.76109918]
mat_Sqrt:  [[0.15]]
grads:  [0.00855119]
Stock Position:  0.008551186231353671
Bond Position:  [15.55230172]


portfolio before change:  [16.39683784]
curr_Stock_Price:  98.64877763062763
curr_Factors:  [98.64877763]
mat_Sqrt:  [[0.15]]
grads:  [-0.01222808]
Stock Position:  -0.012228076292976158
Bond Position:  [17.60312262]


portfolio before change:  [16.39543577]
curr_Stock_Price:  98.8534129542742
curr_Factors:  [98.85341295]
mat_Sqrt:  [[0.15]]
grads:  [0.01168162]
Stock Position:  0.011681622843607206
Bond Position:  [15.24066749]


portfolio before change:  [16.40761213]
curr_Stock_Price:  99.81421993629509
curr_Factors:  [99.81421994]
mat_Sqrt:  [[0.15]]
grads:  [-0.10441483]
Stock Position:  -0.10441482522907652
Bond Position:  [26.82969646]


portfolio before change:  [16.40871419]
curr_Stock_Price:  99.81972535092707
curr_Factors:  [99.81972535]
mat_Sqrt:  [[0.15]]
grads:  [-0.07527829]
Stock Position:  -0.07527828544410795
Bond Position:  [23.92297197]


portfolio before change:  [16.36663314]
curr_Stock_Price:  100.39859461724873
curr_Factors:  [100.39859462]
mat_Sqrt:  [[0.15]]
grads:  [0.01165482]
Stock Position:  0.01165481674090127
Bond Position:  [15.19650592]


portfolio before change:  [16.37386127]
curr_Stock_Price:  100.9372831469204
curr_Factors:  [100.93728315]
mat_Sqrt:  [[0.15]]
grads:  [-0.03679789]
Stock Position:  -0.03679788748333549
Bond Position:  [20.08814005]


portfolio before change:  [16.40164492]
curr_Stock_Price:  100.2163691622636
curr_Factors:  [100.21636916]
mat_Sqrt:  [[0.15]]
grads:  [0.1614347]
Stock Position:  0.1614347013674023
Bond Position:  [0.2232453]


portfolio before change:  [16.4508007]
curr_Stock_Price:  100.52077595061775
curr_Factors:  [100.52077595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05471155]
Stock Position:  -0.054711550410679544
Bond Position:  [21.9504482]


portfolio before change:  [16.45882505]
curr_Stock_Price:  100.3991853592029
curr_Factors:  [100.39918536]
mat_Sqrt:  [[0.15]]
grads:  [0.05436086]
Stock Position:  0.05436086480253744
Bond Position:  [11.00103851]


portfolio before change:  [16.43567473]
curr_Stock_Price:  99.96067298779892
curr_Factors:  [99.96067299]
mat_Sqrt:  [[0.15]]
grads:  [-0.06570292]
Stock Position:  -0.06570292415674361
Bond Position:  [23.00338324]


portfolio before change:  [16.44919344]
curr_Stock_Price:  99.77680053967428
curr_Factors:  [99.77680054]
mat_Sqrt:  [[0.15]]
grads:  [0.0710698]
Stock Position:  0.07106980402933037
Bond Position:  [9.35807578]


portfolio before change:  [16.47454643]
curr_Stock_Price:  100.12530419085934
curr_Factors:  [100.12530419]
mat_Sqrt:  [[0.15]]
grads:  [-0.0522127]
Stock Position:  -0.052212704672733465
Bond Position:  [21.70235936]


portfolio before change:  [16.43594957]
curr_Stock_Price:  100.89050669153835
curr_Factors:  [100.89050669]
mat_Sqrt:  [[0.15]]
grads:  [0.11622478]
Stock Position:  0.11622477619853215
Bond Position:  [4.70997301]


portfolio before change:  [16.54715069]
curr_Stock_Price:  101.84475019913147
curr_Factors:  [101.8447502]
mat_Sqrt:  [[0.15]]
grads:  [-0.14985857]
Stock Position:  -0.14985856743394768
Bond Position:  [31.80945906]


portfolio before change:  [16.47381212]
curr_Stock_Price:  102.34740234781721
curr_Factors:  [102.34740235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01115374]
Stock Position:  -0.01115374153286266
Bond Position:  [17.61536859]


portfolio before change:  [16.47625719]
curr_Stock_Price:  102.2268973921544
curr_Factors:  [102.22689739]
mat_Sqrt:  [[0.15]]
grads:  [-0.06865117]
Stock Position:  -0.06865116506852245
Bond Position:  [23.4942528]


portfolio before change:  [16.44131003]
curr_Stock_Price:  102.75734137738645
curr_Factors:  [102.75734138]
mat_Sqrt:  [[0.15]]
grads:  [-0.0240004]
Stock Position:  -0.024000396215460344
Bond Position:  [18.90752694]


portfolio before change:  [16.42298763]
curr_Stock_Price:  103.57000137608746
curr_Factors:  [103.57000138]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.42298763]
Stock Price:  103.78099546500059
PL:  [12.64199216]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.37349680e-03]
 [-1.79062597e-02]
 [-3.61852919e-04]
 [ 8.36947627e-03]
 [ 4.03932996e-03]
 [ 1.67409647e-02]
 [ 8.68050758e-04]
 [-1.82688201e-02]
 [ 1.33014737e-02]
 [-3.63693552e-03]
 [ 1.39360254e-02]
 [ 2.08727257e-02]
 [-1.41638212e-02]
 [ 5.42972491e-03]
 [-6.98646207e-03]
 [ 9.42249030e-03]
 [ 9.76247333e-03]
 [-1.11237714e-02]
 [ 1.18051061e-03]
 [ 1.00431343e-02]
 [ 1.23982266e-02]
 [-1.02961489e-02]
 [ 2.88188686e-03]
 [-2.78634531e-02]
 [-1.11044924e-02]
 [-5.79170537e-03]
 [-5.05106735e-04]
 [ 9.25084312e-03]
 [-2.03782541e-02]
 [ 1.88564205e-03]
 [-1.91515762e-03]
 [-1.05988533e-02]
 [-5.49550589e-03]
 [ 4.59992049e-03]
 [ 1.21994434e-02]
 [ 1.46405705e-02]
 [-3.51554252e-02]
 [ 9.33974096e-03]
 [-1.67219150e-02]
 [ 2.43769613e-02]
 [-5.13461648e-03]
 [ 2.05081818e-03]
 [ 2.36307369e-02]
 [ 4.34854128e-03]
 [-6.86035439e-03]
 [-4.26299495e-03]
 [ 8.85569642e-04]
 [-1.24156022e-02]
 [-1.34206174e-02]
 [-7.69563109e-03]
 [-2.49702444e-02]
 [ 6.94540932e-04]
 [-7.98159344e-03]
 [ 5.60137698e-03]
 [-5.77819378e-04]
 [ 3.60263444e-03]
 [ 1.01051170e-02]
 [-1.11628509e-04]
 [ 1.62926443e-03]
 [ 8.86732126e-03]
 [-1.43803325e-03]
 [ 7.53330882e-03]
 [-1.40008457e-03]
 [-1.26372045e-02]
 [-6.34986073e-05]
 [ 3.34470069e-03]
 [-5.22321036e-03]
 [ 1.54362479e-02]
 [-9.34250374e-03]
 [-6.00519878e-03]
 [-1.19611369e-02]
 [ 1.41644852e-02]
 [-8.82352565e-03]
 [ 2.70668736e-02]
 [-2.62864223e-02]
 [ 3.25783562e-03]
 [ 4.42089616e-03]
 [-1.40810022e-02]
 [ 2.44312906e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.18006828]
curr_Stock_Price:  99.20528803400275
curr_Factors:  [99.20528803]
mat_Sqrt:  [[0.15]]
grads:  [0.04248998]
Stock Position:  0.0424899786384633
Bond Position:  [-14.39529885]


portfolio before change:  [-10.19168381]
curr_Stock_Price:  98.95309218214138
curr_Factors:  [98.95309218]
mat_Sqrt:  [[0.15]]
grads:  [-0.11937506]
Stock Position:  -0.1193750644733987
Bond Position:  [1.62084795]


portfolio before change:  [-10.27510395]
curr_Stock_Price:  99.65274788567277
curr_Factors:  [99.65274789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241235]
Stock Position:  -0.0024123527961770453
Bond Position:  [-10.03470637]


portfolio before change:  [-10.27593661]
curr_Stock_Price:  99.73792291456378
curr_Factors:  [99.73792291]
mat_Sqrt:  [[0.15]]
grads:  [0.05579651]
Stock Position:  0.05579650844598146
Bond Position:  [-15.84096447]


portfolio before change:  [-10.29130583]
curr_Stock_Price:  99.48021642837838
curr_Factors:  [99.48021643]
mat_Sqrt:  [[0.15]]
grads:  [0.02692887]
Stock Position:  0.026928866408862027
Bond Position:  [-12.97019528]


portfolio before change:  [-10.31014909]
curr_Stock_Price:  98.81057820114944
curr_Factors:  [98.8105782]
mat_Sqrt:  [[0.15]]
grads:  [0.11160643]
Stock Position:  0.11160643110322079
Bond Position:  [-21.33804508]


portfolio before change:  [-10.24368815]
curr_Stock_Price:  99.41802172999617
curr_Factors:  [99.41802173]
mat_Sqrt:  [[0.15]]
grads:  [0.00578701]
Stock Position:  0.005787005052353679
Bond Position:  [-10.81902075]


portfolio before change:  [-10.24312343]
curr_Stock_Price:  99.63245587522253
curr_Factors:  [99.63245588]
mat_Sqrt:  [[0.15]]
grads:  [-0.12179213]
Stock Position:  -0.1217921336672447
Bond Position:  [1.89132595]


portfolio before change:  [-10.24176827]
curr_Stock_Price:  99.62229963907743
curr_Factors:  [99.62229964]
mat_Sqrt:  [[0.15]]
grads:  [0.08867649]
Stock Position:  0.08867649147296014
Bond Position:  [-19.07592427]


portfolio before change:  [-10.20451275]
curr_Stock_Price:  100.05587337203724
curr_Factors:  [100.05587337]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424624]
Stock Position:  -0.024246236795468532
Bond Position:  [-7.77853436]


portfolio before change:  [-10.19265653]
curr_Stock_Price:  99.54682932425926
curr_Factors:  [99.54682932]
mat_Sqrt:  [[0.15]]
grads:  [0.09290684]
Stock Position:  0.09290683623429656
Bond Position:  [-19.4412375]


portfolio before change:  [-10.26481021]
curr_Stock_Price:  98.78328417012412
curr_Factors:  [98.78328417]
mat_Sqrt:  [[0.15]]
grads:  [0.1391515]
Stock Position:  0.13915150484271666
Bond Position:  [-24.01065285]


portfolio before change:  [-10.27759319]
curr_Stock_Price:  98.70220510322225
curr_Factors:  [98.7022051]
mat_Sqrt:  [[0.15]]
grads:  [-0.09442547]
Stock Position:  -0.09442547452830023
Bond Position:  [-0.95759064]


portfolio before change:  [-10.2332636]
curr_Stock_Price:  98.23210477915754
curr_Factors:  [98.23210478]
mat_Sqrt:  [[0.15]]
grads:  [0.03619817]
Stock Position:  0.03619816609789632
Bond Position:  [-13.78908564]


portfolio before change:  [-10.23270744]
curr_Stock_Price:  98.27127800918798
curr_Factors:  [98.27127801]
mat_Sqrt:  [[0.15]]
grads:  [-0.04657641]
Stock Position:  -0.04657641377333367
Bond Position:  [-5.65558374]


portfolio before change:  [-10.21742265]
curr_Stock_Price:  97.93552258743009
curr_Factors:  [97.93552259]
mat_Sqrt:  [[0.15]]
grads:  [0.0628166]
Stock Position:  0.06281660200694256
Bond Position:  [-16.36939939]


portfolio before change:  [-10.21948822]
curr_Stock_Price:  97.91892733219105
curr_Factors:  [97.91892733]
mat_Sqrt:  [[0.15]]
grads:  [0.06508316]
Stock Position:  0.06508315551910163
Bond Position:  [-16.592361]


portfolio before change:  [-10.13944611]
curr_Stock_Price:  99.16470540591766
curr_Factors:  [99.16470541]
mat_Sqrt:  [[0.15]]
grads:  [-0.07415848]
Stock Position:  -0.0741584761896756
Bond Position:  [-2.78554266]


portfolio before change:  [-10.08231317]
curr_Stock_Price:  98.3919408008222
curr_Factors:  [98.3919408]
mat_Sqrt:  [[0.15]]
grads:  [0.00787007]
Stock Position:  0.007870070725741347
Bond Position:  [-10.8566647]


portfolio before change:  [-10.08332223]
curr_Stock_Price:  98.34994583507067
curr_Factors:  [98.34994584]
mat_Sqrt:  [[0.15]]
grads:  [0.06695423]
Stock Position:  0.06695422892813704
Bond Position:  [-16.66826702]


portfolio before change:  [-10.11787998]
curr_Stock_Price:  97.84936580636786
curr_Factors:  [97.84936581]
mat_Sqrt:  [[0.15]]
grads:  [0.08265484]
Stock Position:  0.08265484429316994
Bond Position:  [-18.20560408]


portfolio before change:  [-10.18674954]
curr_Stock_Price:  97.02991381864678
curr_Factors:  [97.02991382]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864099]
Stock Position:  -0.06864099262375964
Bond Position:  [-3.52651994]


portfolio before change:  [-10.1719094]
curr_Stock_Price:  96.8105032360744
curr_Factors:  [96.81050324]
mat_Sqrt:  [[0.15]]
grads:  [0.01921258]
Stock Position:  0.019212579081407246
Bond Position:  [-12.03188885]


portfolio before change:  [-10.16689989]
curr_Stock_Price:  97.11038601461273
curr_Factors:  [97.11038601]
mat_Sqrt:  [[0.15]]
grads:  [-0.18575635]
Stock Position:  -0.18575635417083589
Bond Position:  [7.87197137]


portfolio before change:  [-10.1176215]
curr_Stock_Price:  96.8477496374092
curr_Factors:  [96.84774964]
mat_Sqrt:  [[0.15]]
grads:  [-0.07402995]
Stock Position:  -0.07402994923504523
Bond Position:  [-2.94798751]


portfolio before change:  [-10.15155561]
curr_Stock_Price:  97.30364419533346
curr_Factors:  [97.3036442]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861137]
Stock Position:  -0.03861136914089472
Bond Position:  [-6.39452868]


portfolio before change:  [-10.12932598]
curr_Stock_Price:  96.7175654280793
curr_Factors:  [96.71756543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00336738]
Stock Position:  -0.0033673782303216457
Bond Position:  [-9.80364135]


portfolio before change:  [-10.1322649]
curr_Stock_Price:  97.40836354598326
curr_Factors:  [97.40836355]
mat_Sqrt:  [[0.15]]
grads:  [0.06167229]
Stock Position:  0.0616722874797317
Bond Position:  [-16.1396615]


portfolio before change:  [-10.09976747]
curr_Stock_Price:  97.95165767422374
curr_Factors:  [97.95165767]
mat_Sqrt:  [[0.15]]
grads:  [-0.13585503]
Stock Position:  -0.1358550271145396
Bond Position:  [3.20745764]


portfolio before change:  [-10.03527362]
curr_Stock_Price:  97.47840777088345
curr_Factors:  [97.47840777]
mat_Sqrt:  [[0.15]]
grads:  [0.01257095]
Stock Position:  0.012570946995174762
Bond Position:  [-11.26066952]


portfolio before change:  [-10.0271812]
curr_Stock_Price:  98.17813465896204
curr_Factors:  [98.17813466]
mat_Sqrt:  [[0.15]]
grads:  [-0.01276772]
Stock Position:  -0.012767717465721246
Bond Position:  [-8.77367052]


portfolio before change:  [-10.03361667]
curr_Stock_Price:  98.63922681141574
curr_Factors:  [98.63922681]
mat_Sqrt:  [[0.15]]
grads:  [-0.07065902]
Stock Position:  -0.07065902170503185
Bond Position:  [-3.0638654]


portfolio before change:  [-10.05721813]
curr_Stock_Price:  98.97053575417964
curr_Factors:  [98.97053575]
mat_Sqrt:  [[0.15]]
grads:  [-0.03663671]
Stock Position:  -0.0366367059210116
Bond Position:  [-6.43126372]


portfolio before change:  [-10.07698066]
curr_Stock_Price:  99.49898297212137
curr_Factors:  [99.49898297]
mat_Sqrt:  [[0.15]]
grads:  [0.03066614]
Stock Position:  0.03066613662750797
Bond Position:  [-13.12823007]


portfolio before change:  [-10.08683607]
curr_Stock_Price:  99.2043628320072
curr_Factors:  [99.20436283]
mat_Sqrt:  [[0.15]]
grads:  [0.08132962]
Stock Position:  0.0813296223675499
Bond Position:  [-18.15508943]


portfolio before change:  [-10.09774596]
curr_Stock_Price:  99.08417089907144
curr_Factors:  [99.0841709]
mat_Sqrt:  [[0.15]]
grads:  [0.0976038]
Stock Position:  0.09760380360488909
Bond Position:  [-19.76873791]


portfolio before change:  [-10.07966522]
curr_Stock_Price:  99.28207635329568
curr_Factors:  [99.28207635]
mat_Sqrt:  [[0.15]]
grads:  [-0.2343695]
Stock Position:  -0.23436950108903945
Bond Position:  [13.18902548]


portfolio before change:  [-10.04399112]
curr_Stock_Price:  99.13338057250755
curr_Factors:  [99.13338057]
mat_Sqrt:  [[0.15]]
grads:  [0.06226494]
Stock Position:  0.06226493970298662
Bond Position:  [-16.21652509]


portfolio before change:  [-10.0689039]
curr_Stock_Price:  98.74954950734373
curr_Factors:  [98.74954951]
mat_Sqrt:  [[0.15]]
grads:  [-0.11147943]
Stock Position:  -0.11147943362732708
Bond Position:  [0.93963995]


portfolio before change:  [-10.09176932]
curr_Stock_Price:  98.95518518467607
curr_Factors:  [98.95518518]
mat_Sqrt:  [[0.15]]
grads:  [0.16251308]
Stock Position:  0.16251307513047025
Bond Position:  [-26.17328077]


portfolio before change:  [-10.06162621]
curr_Stock_Price:  99.15073251931817
curr_Factors:  [99.15073252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423078]
Stock Position:  -0.034230776538246244
Bond Position:  [-6.66761964]


portfolio before change:  [-10.05525606]
curr_Stock_Price:  98.95246398055038
curr_Factors:  [98.95246398]
mat_Sqrt:  [[0.15]]
grads:  [0.01367212]
Stock Position:  0.013672121208302876
Bond Position:  [-11.40814614]


portfolio before change:  [-10.04345932]
curr_Stock_Price:  99.86744783964951
curr_Factors:  [99.86744784]
mat_Sqrt:  [[0.15]]
grads:  [0.15753825]
Stock Position:  0.15753824629739238
Bond Position:  [-25.77640192]


portfolio before change:  [-10.18646032]
curr_Stock_Price:  98.96995196231886
curr_Factors:  [98.96995196]
mat_Sqrt:  [[0.15]]
grads:  [0.02899028]
Stock Position:  0.028990275207149797
Bond Position:  [-13.05562647]


portfolio before change:  [-10.19354759]
curr_Stock_Price:  98.7536290527139
curr_Factors:  [98.75362905]
mat_Sqrt:  [[0.15]]
grads:  [-0.0457357]
Stock Position:  -0.0457356959036491
Bond Position:  [-5.67698164]


portfolio before change:  [-10.17653089]
curr_Stock_Price:  98.37380492028106
curr_Factors:  [98.37380492]
mat_Sqrt:  [[0.15]]
grads:  [-0.02841997]
Stock Position:  -0.0284199663131826
Bond Position:  [-7.38075067]


portfolio before change:  [-10.17687659]
curr_Stock_Price:  98.36973694900153
curr_Factors:  [98.36973695]
mat_Sqrt:  [[0.15]]
grads:  [0.0059038]
Stock Position:  0.005903797616062708
Bond Position:  [-10.75763161]


portfolio before change:  [-10.17346061]
curr_Stock_Price:  99.06223127410894
curr_Factors:  [99.06223127]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277068]
Stock Position:  -0.08277068118600889
Bond Position:  [-1.97401225]


portfolio before change:  [-10.28470815]
curr_Stock_Price:  100.40478581113116
curr_Factors:  [100.40478581]
mat_Sqrt:  [[0.15]]
grads:  [-0.08947078]
Stock Position:  -0.08947078244786133
Bond Position:  [-1.3014134]


portfolio before change:  [-10.32607483]
curr_Stock_Price:  100.86622515397129
curr_Factors:  [100.86622515]
mat_Sqrt:  [[0.15]]
grads:  [-0.05130421]
Stock Position:  -0.05130420727847758
Bond Position:  [-5.1512131]


portfolio before change:  [-10.39034186]
curr_Stock_Price:  102.11261551458216
curr_Factors:  [102.11261551]
mat_Sqrt:  [[0.15]]
grads:  [-0.1664683]
Stock Position:  -0.16646829600112129
Bond Position:  [6.60817125]


portfolio before change:  [-10.37774103]
curr_Stock_Price:  102.03940157860205
curr_Factors:  [102.03940158]
mat_Sqrt:  [[0.15]]
grads:  [0.00463027]
Stock Position:  0.004630272881896008
Bond Position:  [-10.85021131]


portfolio before change:  [-10.37607946]
curr_Stock_Price:  102.54471357287869
curr_Factors:  [102.54471357]
mat_Sqrt:  [[0.15]]
grads:  [-0.05321062]
Stock Position:  -0.053210622909122714
Bond Position:  [-4.91961138]


portfolio before change:  [-10.38251644]
curr_Stock_Price:  102.6599067012542
curr_Factors:  [102.6599067]
mat_Sqrt:  [[0.15]]
grads:  [0.03734251]
Stock Position:  0.03734251323100022
Bond Position:  [-14.21609537]


portfolio before change:  [-10.40280728]
curr_Stock_Price:  102.14033002499048
curr_Factors:  [102.14033002]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385213]
Stock Position:  -0.003852129188859184
Bond Position:  [-10.00934953]


portfolio before change:  [-10.40483678]
curr_Stock_Price:  102.50477716054898
curr_Factors:  [102.50477716]
mat_Sqrt:  [[0.15]]
grads:  [0.02401756]
Stock Position:  0.024017562930204163
Bond Position:  [-12.86675171]


portfolio before change:  [-10.38364998]
curr_Stock_Price:  103.42039845301753
curr_Factors:  [103.42039845]
mat_Sqrt:  [[0.15]]
grads:  [0.06736745]
Stock Position:  0.06736744662540949
Bond Position:  [-17.35081816]


portfolio before change:  [-10.40880301]
curr_Stock_Price:  103.0631255010268
curr_Factors:  [103.0631255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074419]
Stock Position:  -0.0007441900622405135
Bond Position:  [-10.33210446]


portfolio before change:  [-10.40861123]
curr_Stock_Price:  101.9376584968469
curr_Factors:  [101.9376585]
mat_Sqrt:  [[0.15]]
grads:  [0.01086176]
Stock Position:  0.010861762875784386
Bond Position:  [-11.5158339]


portfolio before change:  [-10.41981616]
curr_Stock_Price:  100.97232973121672
curr_Factors:  [100.97232973]
mat_Sqrt:  [[0.15]]
grads:  [0.05911548]
Stock Position:  0.05911547506102973
Bond Position:  [-16.3888434]


portfolio before change:  [-10.36669355]
curr_Stock_Price:  101.88828183947078
curr_Factors:  [101.88828184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958689]
Stock Position:  -0.00958688831285435
Bond Position:  [-9.38990197]


portfolio before change:  [-10.37071283]
curr_Stock_Price:  102.24631168948257
curr_Factors:  [102.24631169]
mat_Sqrt:  [[0.15]]
grads:  [0.05022206]
Stock Position:  0.050222058774488966
Bond Position:  [-15.50573311]


portfolio before change:  [-10.36881972]
curr_Stock_Price:  102.30330346261691
curr_Factors:  [102.30330346]
mat_Sqrt:  [[0.15]]
grads:  [-0.0093339]
Stock Position:  -0.00933389712052225
Bond Position:  [-9.41393121]


portfolio before change:  [-10.36393615]
curr_Stock_Price:  101.71705682460085
curr_Factors:  [101.71705682]
mat_Sqrt:  [[0.15]]
grads:  [-0.08424803]
Stock Position:  -0.08424802983070519
Bond Position:  [-1.79447451]


portfolio before change:  [-10.40732925]
curr_Stock_Price:  102.23078926220798
curr_Factors:  [102.23078926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00042332]
Stock Position:  -0.00042332404838511345
Bond Position:  [-10.3640525]


portfolio before change:  [-10.40853991]
curr_Stock_Price:  103.56047599050781
curr_Factors:  [103.56047599]
mat_Sqrt:  [[0.15]]
grads:  [0.022298]
Stock Position:  0.02229800461208041
Bond Position:  [-12.71773188]


portfolio before change:  [-10.37432751]
curr_Stock_Price:  105.13044994307573
curr_Factors:  [105.13044994]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348214]
Stock Position:  -0.034821402396537145
Bond Position:  [-6.71353781]


portfolio before change:  [-10.38073979]
curr_Stock_Price:  105.3025474029394
curr_Factors:  [105.3025474]
mat_Sqrt:  [[0.15]]
grads:  [0.10290832]
Stock Position:  0.10290831910306725
Bond Position:  [-21.21724794]


portfolio before change:  [-10.42507803]
curr_Stock_Price:  104.88458200616519
curr_Factors:  [104.88458201]
mat_Sqrt:  [[0.15]]
grads:  [-0.06228336]
Stock Position:  -0.062283358288724826
Bond Position:  [-3.89251403]


portfolio before change:  [-10.40135825]
curr_Stock_Price:  104.49983929934568
curr_Factors:  [104.4998393]
mat_Sqrt:  [[0.15]]
grads:  [-0.04003466]
Stock Position:  -0.04003465850098971
Bond Position:  [-6.21774287]


portfolio before change:  [-10.42154756]
curr_Stock_Price:  104.99442803203898
curr_Factors:  [104.99442803]
mat_Sqrt:  [[0.15]]
grads:  [-0.07974091]
Stock Position:  -0.07974091246754049
Bond Position:  [-2.04919607]


portfolio before change:  [-10.43325386]
curr_Stock_Price:  105.13962599888038
curr_Factors:  [105.139626]
mat_Sqrt:  [[0.15]]
grads:  [0.0944299]
Stock Position:  0.09442990117952756
Bond Position:  [-20.36157835]


portfolio before change:  [-10.4494583]
curr_Stock_Price:  104.98150022540246
curr_Factors:  [104.98150023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0588235]
Stock Position:  -0.05882350436575524
Bond Position:  [-4.27407856]


portfolio before change:  [-10.48562474]
curr_Stock_Price:  105.59178859873758
curr_Factors:  [105.5917886]
mat_Sqrt:  [[0.15]]
grads:  [0.18044582]
Stock Position:  0.1804458243106665
Bond Position:  [-29.53922207]


portfolio before change:  [-10.52032621]
curr_Stock_Price:  105.40971064687247
curr_Factors:  [105.40971065]
mat_Sqrt:  [[0.15]]
grads:  [-0.17524282]
Stock Position:  -0.17524281541370923
Bond Position:  [7.95196826]


portfolio before change:  [-10.60345035]
curr_Stock_Price:  105.88688374354716
curr_Factors:  [105.88688374]
mat_Sqrt:  [[0.15]]
grads:  [0.0217189]
Stock Position:  0.02171890410136881
Bond Position:  [-12.90319742]


portfolio before change:  [-10.59764899]
curr_Stock_Price:  106.19112720779705
curr_Factors:  [106.19112721]
mat_Sqrt:  [[0.15]]
grads:  [0.02947264]
Stock Position:  0.02947264106891215
Bond Position:  [-13.72738197]


portfolio before change:  [-10.594822]
curr_Stock_Price:  106.31615766357211
curr_Factors:  [106.31615766]
mat_Sqrt:  [[0.15]]
grads:  [-0.09387335]
Stock Position:  -0.09387334769479933
Bond Position:  [-0.61456837]


portfolio before change:  [-10.57655867]
curr_Stock_Price:  106.1211956449214
curr_Factors:  [106.12119564]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.57655867]
Stock Price:  106.48180342897066
PL:  [-17.0583621]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.80315116e-03]
 [-2.88075335e-03]
 [-9.46874472e-04]
 [ 6.07601177e-03]
 [-1.89299502e-03]
 [ 1.58456297e-02]
 [ 1.44926947e-03]
 [-2.03506226e-02]
 [-1.13929531e-02]
 [ 2.64878877e-02]
 [ 1.42487198e-02]
 [-2.11089301e-02]
 [ 1.76420590e-02]
 [ 1.97405596e-03]
 [-6.91532003e-03]
 [ 1.48185400e-02]
 [ 7.45386702e-03]
 [-1.23409156e-02]
 [-5.21866036e-04]
 [ 1.35405379e-02]
 [ 1.18851341e-02]
 [-6.81945810e-03]
 [ 6.82887080e-03]
 [ 3.68218463e-02]
 [-8.04262442e-03]
 [-7.84675326e-03]
 [-2.80573411e-03]
 [ 1.05442918e-02]
 [-3.79649120e-02]
 [ 2.57821502e-03]
 [ 2.09162712e-03]
 [-1.01023271e-02]
 [-8.86287176e-03]
 [ 5.51042030e-03]
 [ 1.37690748e-02]
 [ 6.67878176e-03]
 [-3.30570991e-02]
 [ 8.14758876e-03]
 [-3.51257403e-02]
 [ 7.11650142e-03]
 [-1.41407200e-02]
 [ 3.99110877e-02]
 [ 2.32683372e-02]
 [ 3.45628502e-03]
 [ 9.61394790e-03]
 [ 2.21751938e-02]
 [-2.35375193e-03]
 [-2.70326312e-03]
 [ 2.70773483e-02]
 [ 7.73484732e-03]
 [ 2.53925179e-02]
 [ 1.57963083e-02]
 [-1.41990458e-03]
 [ 4.31556394e-03]
 [ 4.22460051e-03]
 [ 4.77716657e-03]
 [-1.37584304e-02]
 [ 4.05449625e-05]
 [ 1.59630002e-03]
 [-6.79173913e-02]
 [-1.39698658e-02]
 [ 1.80585898e-02]
 [ 1.56853286e-02]
 [-1.91197324e-02]
 [-3.74864569e-03]
 [-1.94726394e-02]
 [-4.25176109e-03]
 [ 5.36295578e-03]
 [-1.48161471e-02]
 [ 1.18891221e-02]
 [ 2.33588472e-03]
 [ 1.21446479e-02]
 [ 3.44173497e-03]
 [ 1.67878699e-03]
 [ 1.47905462e-02]
 [-1.96040441e-02]
 [ 4.87052411e-03]
 [ 7.70355903e-03]
 [ 1.34932874e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86754311]
curr_Stock_Price:  99.55073476484155
curr_Factors:  [99.55073476]
mat_Sqrt:  [[0.15]]
grads:  [0.02535434]
Stock Position:  0.02535434108463403
Bond Position:  [-7.3915864]


portfolio before change:  [-4.86964391]
curr_Stock_Price:  99.48609835868034
curr_Factors:  [99.48609836]
mat_Sqrt:  [[0.15]]
grads:  [-0.01920502]
Stock Position:  -0.019205022313217582
Bond Position:  [-2.95901118]


portfolio before change:  [-4.86859094]
curr_Stock_Price:  99.42164009913255
curr_Factors:  [99.4216401]
mat_Sqrt:  [[0.15]]
grads:  [-0.0063125]
Stock Position:  -0.00631249648302969
Bond Position:  [-4.24099218]


portfolio before change:  [-4.86328472]
curr_Stock_Price:  98.53906028972591
curr_Factors:  [98.53906029]
mat_Sqrt:  [[0.15]]
grads:  [0.04050675]
Stock Position:  0.040506745131899634
Bond Position:  [-8.85478132]


portfolio before change:  [-4.85808066]
curr_Stock_Price:  98.68119732878648
curr_Factors:  [98.68119733]
mat_Sqrt:  [[0.15]]
grads:  [-0.01261997]
Stock Position:  -0.012619966780178557
Bond Position:  [-3.61272722]


portfolio before change:  [-4.85814]
curr_Stock_Price:  98.66800748471799
curr_Factors:  [98.66800748]
mat_Sqrt:  [[0.15]]
grads:  [0.10563753]
Stock Position:  0.10563753153517755
Bond Position:  [-15.28118476]


portfolio before change:  [-4.82126566]
curr_Stock_Price:  99.02611365138343
curr_Factors:  [99.02611365]
mat_Sqrt:  [[0.15]]
grads:  [0.0096618]
Stock Position:  0.009661796460937587
Bond Position:  [-5.77803581]


portfolio before change:  [-4.82465295]
curr_Stock_Price:  98.71290522271465
curr_Factors:  [98.71290522]
mat_Sqrt:  [[0.15]]
grads:  [-0.13567082]
Stock Position:  -0.13567081753289045
Bond Position:  [8.5678076]


portfolio before change:  [-4.7382079]
curr_Stock_Price:  98.0796847150904
curr_Factors:  [98.07968472]
mat_Sqrt:  [[0.15]]
grads:  [-0.07595302]
Stock Position:  -0.07595302079581569
Bond Position:  [2.71124043]


portfolio before change:  [-4.74586249]
curr_Stock_Price:  98.18269635966229
curr_Factors:  [98.18269636]
mat_Sqrt:  [[0.15]]
grads:  [0.17658592]
Stock Position:  0.1765859178178674
Bond Position:  [-22.08354404]


portfolio before change:  [-4.52031093]
curr_Stock_Price:  99.46780351873657
curr_Factors:  [99.46780352]
mat_Sqrt:  [[0.15]]
grads:  [0.09499147]
Stock Position:  0.09499146532861734
Bond Position:  [-13.96890334]


portfolio before change:  [-4.39937046]
curr_Stock_Price:  100.75016660308296
curr_Factors:  [100.7501666]
mat_Sqrt:  [[0.15]]
grads:  [-0.1407262]
Stock Position:  -0.14072620068533132
Bond Position:  [9.7788177]


portfolio before change:  [-4.3992314]
curr_Stock_Price:  100.7535215814688
curr_Factors:  [100.75352158]
mat_Sqrt:  [[0.15]]
grads:  [0.11761373]
Stock Position:  0.11761372658063009
Bond Position:  [-16.24922854]


portfolio before change:  [-4.38320969]
curr_Stock_Price:  100.89837982977626
curr_Factors:  [100.89837983]
mat_Sqrt:  [[0.15]]
grads:  [0.01316037]
Stock Position:  0.013160373037037026
Bond Position:  [-5.71107001]


portfolio before change:  [-4.38792636]
curr_Stock_Price:  100.56710351509238
curr_Factors:  [100.56710352]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610213]
Stock Position:  -0.04610213356286555
Bond Position:  [0.24843167]


portfolio before change:  [-4.3818235]
curr_Stock_Price:  100.4350632185056
curr_Factors:  [100.43506322]
mat_Sqrt:  [[0.15]]
grads:  [0.09879027]
Stock Position:  0.0987902663650713
Bond Position:  [-14.30383014]


portfolio before change:  [-4.42021513]
curr_Stock_Price:  100.05549528617348
curr_Factors:  [100.05549529]
mat_Sqrt:  [[0.15]]
grads:  [0.04969245]
Stock Position:  0.04969244680400615
Bond Position:  [-9.39221751]


portfolio before change:  [-4.41755718]
curr_Stock_Price:  100.12079653783749
curr_Factors:  [100.12079654]
mat_Sqrt:  [[0.15]]
grads:  [-0.08227277]
Stock Position:  -0.08227277099922302
Bond Position:  [3.81965818]


portfolio before change:  [-4.38125428]
curr_Stock_Price:  99.68244775197576
curr_Factors:  [99.68244775]
mat_Sqrt:  [[0.15]]
grads:  [-0.00347911]
Stock Position:  -0.003479106907447165
Bond Position:  [-4.03444839]


portfolio before change:  [-4.38227905]
curr_Stock_Price:  99.90451934597525
curr_Factors:  [99.90451935]
mat_Sqrt:  [[0.15]]
grads:  [0.09027025]
Stock Position:  0.09027025276995028
Bond Position:  [-13.40068526]


portfolio before change:  [-4.32678682]
curr_Stock_Price:  100.52853226465145
curr_Factors:  [100.52853226]
mat_Sqrt:  [[0.15]]
grads:  [0.07923423]
Stock Position:  0.0792342276365792
Bond Position:  [-12.29208743]


portfolio before change:  [-4.32514338]
curr_Stock_Price:  100.5589700218866
curr_Factors:  [100.55897002]
mat_Sqrt:  [[0.15]]
grads:  [-0.04546305]
Stock Position:  -0.04546305401650262
Bond Position:  [0.2465745]


portfolio before change:  [-4.30944258]
curr_Stock_Price:  100.21395602799159
curr_Factors:  [100.21395603]
mat_Sqrt:  [[0.15]]
grads:  [0.04552581]
Stock Position:  0.045525805326202026
Bond Position:  [-8.87176363]


portfolio before change:  [-4.33928786]
curr_Stock_Price:  99.57056754099831
curr_Factors:  [99.57056754]
mat_Sqrt:  [[0.15]]
grads:  [0.24547898]
Stock Position:  0.24547897510516795
Bond Position:  [-28.78176873]


portfolio before change:  [-4.47606252]
curr_Stock_Price:  99.02072109019761
curr_Factors:  [99.02072109]
mat_Sqrt:  [[0.15]]
grads:  [-0.0536175]
Stock Position:  -0.053617496140024826
Bond Position:  [0.83318061]


portfolio before change:  [-4.45142363]
curr_Stock_Price:  98.56216156732961
curr_Factors:  [98.56216157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05231169]
Stock Position:  -0.05231168838243143
Bond Position:  [0.70452945]


portfolio before change:  [-4.41317624]
curr_Stock_Price:  97.83185900802701
curr_Factors:  [97.83185901]
mat_Sqrt:  [[0.15]]
grads:  [-0.01870489]
Stock Position:  -0.018704894087692592
Bond Position:  [-2.58324168]


portfolio before change:  [-4.38987195]
curr_Stock_Price:  96.57733454771653
curr_Factors:  [96.57733455]
mat_Sqrt:  [[0.15]]
grads:  [0.07029528]
Stock Position:  0.07029527868571704
Bond Position:  [-11.1788026]


portfolio before change:  [-4.38242134]
curr_Stock_Price:  96.69326417729211
curr_Factors:  [96.69326418]
mat_Sqrt:  [[0.15]]
grads:  [-0.25309941]
Stock Position:  -0.2530994130616064
Bond Position:  [20.09058707]


portfolio before change:  [-4.49922558]
curr_Stock_Price:  97.15972095538473
curr_Factors:  [97.15972096]
mat_Sqrt:  [[0.15]]
grads:  [0.0171881]
Stock Position:  0.017188100117560397
Bond Position:  [-6.16921659]


portfolio before change:  [-4.49443677]
curr_Stock_Price:  97.46076640628185
curr_Factors:  [97.46076641]
mat_Sqrt:  [[0.15]]
grads:  [0.01394418]
Stock Position:  0.013944180788625343
Bond Position:  [-5.85344731]


portfolio before change:  [-4.49235135]
curr_Stock_Price:  97.63655816400686
curr_Factors:  [97.63655816]
mat_Sqrt:  [[0.15]]
grads:  [-0.06734885]
Stock Position:  -0.06734884756017805
Bond Position:  [2.08335833]


portfolio before change:  [-4.4784582]
curr_Stock_Price:  97.43220525551969
curr_Factors:  [97.43220526]
mat_Sqrt:  [[0.15]]
grads:  [-0.05908581]
Stock Position:  -0.05908581172618003
Bond Position:  [1.27840274]


portfolio before change:  [-4.46854815]
curr_Stock_Price:  97.26583455035914
curr_Factors:  [97.26583455]
mat_Sqrt:  [[0.15]]
grads:  [0.03673614]
Stock Position:  0.036736135355067215
Bond Position:  [-8.04171901]


portfolio before change:  [-4.4996129]
curr_Stock_Price:  96.4338980709389
curr_Factors:  [96.43389807]
mat_Sqrt:  [[0.15]]
grads:  [0.09179383]
Stock Position:  0.09179383186306875
Bond Position:  [-13.35164993]


portfolio before change:  [-4.55108118]
curr_Stock_Price:  95.88229485753716
curr_Factors:  [95.88229486]
mat_Sqrt:  [[0.15]]
grads:  [0.04452521]
Stock Position:  0.04452521172449873
Bond Position:  [-8.82026066]


portfolio before change:  [-4.53082313]
curr_Stock_Price:  96.34965555629338
curr_Factors:  [96.34965556]
mat_Sqrt:  [[0.15]]
grads:  [-0.22038066]
Stock Position:  -0.2203806604510032
Bond Position:  [16.7027776]


portfolio before change:  [-4.50747199]
curr_Stock_Price:  96.2484344147547
curr_Factors:  [96.24843441]
mat_Sqrt:  [[0.15]]
grads:  [0.05431726]
Stock Position:  0.05431725836833298
Bond Position:  [-9.73542307]


portfolio before change:  [-4.50855136]
curr_Stock_Price:  96.23976523906491
curr_Factors:  [96.23976524]
mat_Sqrt:  [[0.15]]
grads:  [-0.2341716]
Stock Position:  -0.23417160229083536
Bond Position:  [18.02806867]


portfolio before change:  [-4.50073854]
curr_Stock_Price:  96.21121338033564
curr_Factors:  [96.21121338]
mat_Sqrt:  [[0.15]]
grads:  [0.04744334]
Stock Position:  0.04744334282745048
Bond Position:  [-9.06532012]


portfolio before change:  [-4.5400652]
curr_Stock_Price:  95.39423748626646
curr_Factors:  [95.39423749]
mat_Sqrt:  [[0.15]]
grads:  [-0.09427147]
Stock Position:  -0.09427146677407591
Bond Position:  [4.45288949]


portfolio before change:  [-4.61542125]
curr_Stock_Price:  96.19654130279613
curr_Factors:  [96.1965413]
mat_Sqrt:  [[0.15]]
grads:  [0.26607392]
Stock Position:  0.2660739178872001
Bond Position:  [-30.21081188]


portfolio before change:  [-4.66337637]
curr_Stock_Price:  96.02340562346069
curr_Factors:  [96.02340562]
mat_Sqrt:  [[0.15]]
grads:  [0.15512225]
Stock Position:  0.15512224831263768
Bond Position:  [-19.55874294]


portfolio before change:  [-4.82433101]
curr_Stock_Price:  94.99368756662209
curr_Factors:  [94.99368757]
mat_Sqrt:  [[0.15]]
grads:  [0.0230419]
Stock Position:  0.02304190015778721
Bond Position:  [-7.01316607]


portfolio before change:  [-4.83248584]
curr_Stock_Price:  94.65879788829834
curr_Factors:  [94.65879789]
mat_Sqrt:  [[0.15]]
grads:  [0.06409299]
Stock Position:  0.06409298602413548
Bond Position:  [-10.89945085]


portfolio before change:  [-4.82309575]
curr_Stock_Price:  94.81593415508809
curr_Factors:  [94.81593416]
mat_Sqrt:  [[0.15]]
grads:  [0.14783463]
Stock Position:  0.14783462515316473
Bond Position:  [-18.84017383]


portfolio before change:  [-4.82985003]
curr_Stock_Price:  94.77821132891965
curr_Factors:  [94.77821133]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569168]
Stock Position:  -0.015691679564404856
Bond Position:  [-3.34262071]


portfolio before change:  [-4.82232952]
curr_Stock_Price:  94.28562977444719
curr_Factors:  [94.28562977]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802175]
Stock Position:  -0.018021754124149386
Bond Position:  [-3.12313708]


portfolio before change:  [-4.8135397]
curr_Stock_Price:  93.78706420357393
curr_Factors:  [93.7870642]
mat_Sqrt:  [[0.15]]
grads:  [0.18051566]
Stock Position:  0.18051565534887432
Bond Position:  [-21.74357306]


portfolio before change:  [-4.80443631]
curr_Stock_Price:  93.84502260301528
curr_Factors:  [93.8450226]
mat_Sqrt:  [[0.15]]
grads:  [0.05156565]
Stock Position:  0.05156564879395159
Bond Position:  [-9.64361579]


portfolio before change:  [-4.8332058]
curr_Stock_Price:  93.29879197009613
curr_Factors:  [93.29879197]
mat_Sqrt:  [[0.15]]
grads:  [0.16928345]
Stock Position:  0.1692834529499749
Bond Position:  [-20.62714746]


portfolio before change:  [-4.81160316]
curr_Stock_Price:  93.43402005814659
curr_Factors:  [93.43402006]
mat_Sqrt:  [[0.15]]
grads:  [0.10530872]
Stock Position:  0.10530872170302318
Bond Position:  [-14.65102037]


portfolio before change:  [-4.87584124]
curr_Stock_Price:  92.83271785565
curr_Factors:  [92.83271786]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946603]
Stock Position:  -0.009466030534244678
Bond Position:  [-3.9970839]


portfolio before change:  [-4.88040916]
curr_Stock_Price:  93.28888527400025
curr_Factors:  [93.28888527]
mat_Sqrt:  [[0.15]]
grads:  [0.02877043]
Stock Position:  0.02877042626669511
Bond Position:  [-7.56437015]


portfolio before change:  [-4.86768198]
curr_Stock_Price:  93.74768872151382
curr_Factors:  [93.74768872]
mat_Sqrt:  [[0.15]]
grads:  [0.028164]
Stock Position:  0.02816400339971903
Bond Position:  [-7.5079922]


portfolio before change:  [-4.85517076]
curr_Stock_Price:  94.20857795445211
curr_Factors:  [94.20857795]
mat_Sqrt:  [[0.15]]
grads:  [0.03184778]
Stock Position:  0.03184777710809666
Bond Position:  [-7.85550455]


portfolio before change:  [-4.83407327]
curr_Stock_Price:  94.88644232922424
curr_Factors:  [94.88644233]
mat_Sqrt:  [[0.15]]
grads:  [-0.09172287]
Stock Position:  -0.09172286910577773
Bond Position:  [3.86918346]


portfolio before change:  [-4.84740191]
curr_Stock_Price:  95.03439319213669
curr_Factors:  [95.03439319]
mat_Sqrt:  [[0.15]]
grads:  [0.0002703]
Stock Position:  0.0002702997503066648
Bond Position:  [-4.87308968]


portfolio before change:  [-4.84785539]
curr_Stock_Price:  94.48350485558879
curr_Factors:  [94.48350486]
mat_Sqrt:  [[0.15]]
grads:  [0.010642]
Stock Position:  0.010642000145466752
Bond Position:  [-5.85334887]


portfolio before change:  [-4.84505962]
curr_Stock_Price:  94.78059420812608
curr_Factors:  [94.78059421]
mat_Sqrt:  [[0.15]]
grads:  [-0.45278261]
Stock Position:  -0.4527826085905031
Bond Position:  [38.06994507]


portfolio before change:  [-4.45657476]
curr_Stock_Price:  93.92785516814538
curr_Factors:  [93.92785517]
mat_Sqrt:  [[0.15]]
grads:  [-0.09313244]
Stock Position:  -0.09313243839154925
Bond Position:  [4.29115542]


portfolio before change:  [-4.52156888]
curr_Stock_Price:  94.62860264890092
curr_Factors:  [94.62860265]
mat_Sqrt:  [[0.15]]
grads:  [0.1203906]
Stock Position:  0.12039059868883313
Bond Position:  [-15.913963]


portfolio before change:  [-4.44002944]
curr_Stock_Price:  95.31415529794178
curr_Factors:  [95.3141553]
mat_Sqrt:  [[0.15]]
grads:  [0.10456886]
Stock Position:  0.10456885736481297
Bond Position:  [-14.40692175]


portfolio before change:  [-4.43367806]
curr_Stock_Price:  95.38350517440617
curr_Factors:  [95.38350517]
mat_Sqrt:  [[0.15]]
grads:  [-0.12746488]
Stock Position:  -0.1274648827968203
Bond Position:  [7.72436925]


portfolio before change:  [-4.45393211]
curr_Stock_Price:  95.54619180137941
curr_Factors:  [95.5461918]
mat_Sqrt:  [[0.15]]
grads:  [-0.02499097]
Stock Position:  -0.024990971277644207
Bond Position:  [-2.06613997]


portfolio before change:  [-4.44066006]
curr_Stock_Price:  95.00995074267529
curr_Factors:  [95.00995074]
mat_Sqrt:  [[0.15]]
grads:  [-0.1298176]
Stock Position:  -0.12981759576955285
Bond Position:  [7.89330332]


portfolio before change:  [-4.44120499]
curr_Stock_Price:  95.01794873025138
curr_Factors:  [95.01794873]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834507]
Stock Position:  -0.02834507390933459
Bond Position:  [-1.74791421]


portfolio before change:  [-4.45496482]
curr_Stock_Price:  95.49953450428191
curr_Factors:  [95.4995345]
mat_Sqrt:  [[0.15]]
grads:  [0.03575304]
Stock Position:  0.03575303855674856
Bond Position:  [-7.86936336]


portfolio before change:  [-4.45746367]
curr_Stock_Price:  95.44339957939289
curr_Factors:  [95.44339958]
mat_Sqrt:  [[0.15]]
grads:  [-0.09877431]
Stock Position:  -0.0987743137217847
Bond Position:  [4.96989262]


portfolio before change:  [-4.45012259]
curr_Stock_Price:  95.37222270267202
curr_Factors:  [95.3722227]
mat_Sqrt:  [[0.15]]
grads:  [0.07926081]
Stock Position:  0.07926081423133972
Bond Position:  [-12.00940262]


portfolio before change:  [-4.42575371]
curr_Stock_Price:  95.6891446716724
curr_Factors:  [95.68914467]
mat_Sqrt:  [[0.15]]
grads:  [0.01557256]
Stock Position:  0.015572564766861523
Bond Position:  [-5.91587911]


portfolio before change:  [-4.43162292]
curr_Stock_Price:  95.33599447817788
curr_Factors:  [95.33599448]
mat_Sqrt:  [[0.15]]
grads:  [0.08096432]
Stock Position:  0.08096431944920815
Bond Position:  [-12.15043683]


portfolio before change:  [-4.44384199]
curr_Stock_Price:  95.19445499855804
curr_Factors:  [95.194455]
mat_Sqrt:  [[0.15]]
grads:  [0.0229449]
Stock Position:  0.022944899789655013
Bond Position:  [-6.62806922]


portfolio before change:  [-4.46443241]
curr_Stock_Price:  94.31512453514748
curr_Factors:  [94.31512454]
mat_Sqrt:  [[0.15]]
grads:  [0.01119191]
Stock Position:  0.011191913284253887
Bond Position:  [-5.5199991]


portfolio before change:  [-4.47015709]
curr_Stock_Price:  93.83444962371112
curr_Factors:  [93.83444962]
mat_Sqrt:  [[0.15]]
grads:  [0.09860364]
Stock Position:  0.09860364149850413
Bond Position:  [-13.72257552]


portfolio before change:  [-4.42847199]
curr_Stock_Price:  94.26590216473558
curr_Factors:  [94.26590216]
mat_Sqrt:  [[0.15]]
grads:  [-0.13069363]
Stock Position:  -0.1306936275155132
Bond Position:  [7.89148072]


portfolio before change:  [-4.38024775]
curr_Stock_Price:  93.90068919854701
curr_Factors:  [93.9006892]
mat_Sqrt:  [[0.15]]
grads:  [0.03247016]
Stock Position:  0.03247016071623575
Bond Position:  [-7.42921822]


portfolio before change:  [-4.37026636]
curr_Stock_Price:  94.22239166297096
curr_Factors:  [94.22239166]
mat_Sqrt:  [[0.15]]
grads:  [0.05135706]
Stock Position:  0.05135706020776779
Bond Position:  [-9.2092514]


portfolio before change:  [-4.37487339]
curr_Stock_Price:  94.14389355834386
curr_Factors:  [94.14389356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.37487339]
Stock Price:  94.06098535632525
PL:  [-4.37487339]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.25306951e-04]
 [ 2.73155069e-03]
 [-2.02215246e-03]
 [ 3.36708164e-03]
 [ 1.91583365e-02]
 [ 2.72186890e-02]
 [ 3.33225223e-03]
 [ 1.27522665e-02]
 [ 2.45688450e-02]
 [-3.49660056e-03]
 [ 3.47590280e-02]
 [-5.32870062e-02]
 [ 1.05929901e-01]
 [ 1.47460713e-02]
 [-6.89383339e-03]
 [ 2.41846365e-02]
 [ 1.07692724e-02]
 [-1.04449512e-02]
 [ 8.86261511e-03]
 [-8.95220492e-03]
 [ 1.49522729e-02]
 [-1.06135034e-02]
 [ 1.10058688e-02]
 [-3.53244748e-02]
 [ 7.45756277e-03]
 [ 6.77546622e-03]
 [-4.85394293e-03]
 [ 1.43678524e-02]
 [ 4.42213587e-02]
 [ 4.57662669e-03]
 [ 2.07516051e-02]
 [ 5.64047136e-03]
 [-4.62397271e-03]
 [ 6.98842940e-03]
 [ 9.44183606e-03]
 [ 4.73092519e-03]
 [-3.21574294e-02]
 [ 8.58803451e-03]
 [ 1.37191351e-02]
 [ 5.62099634e-03]
 [-3.76778906e-03]
 [-1.74674783e-02]
 [ 2.07279691e-02]
 [-1.27107277e-03]
 [-1.04168850e-04]
 [-1.07647562e-02]
 [ 1.33961776e-02]
 [-8.09600129e-03]
 [-1.34902373e-02]
 [-7.60999612e-03]
 [ 1.38959617e-02]
 [-7.88805273e-03]
 [-5.22088091e-03]
 [ 5.57322426e-03]
 [-2.78327335e-03]
 [ 5.67090052e-03]
 [ 9.76662041e-03]
 [-3.70815192e-04]
 [ 1.63363358e-03]
 [ 1.58478837e-02]
 [-1.92993429e-03]
 [ 2.03268854e-02]
 [ 2.70841724e-03]
 [-1.24667574e-02]
 [ 4.26676384e-03]
 [ 3.19594122e-03]
 [-5.34522680e-03]
 [ 1.53737381e-02]
 [-8.98165299e-03]
 [-7.00830054e-03]
 [-1.19293516e-02]
 [ 1.34412040e-02]
 [-2.24180247e-03]
 [ 2.50157653e-02]
 [-2.50475759e-02]
 [ 2.73096111e-03]
 [ 1.90419693e-03]
 [-1.25812029e-02]
 [ 2.39692496e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0582255]
curr_Stock_Price:  100.13113250180778
curr_Factors:  [100.1311325]
mat_Sqrt:  [[0.15]]
grads:  [0.00616871]
Stock Position:  0.006168713005334873
Bond Position:  [3.44054528]


portfolio before change:  [4.05982438]
curr_Stock_Price:  100.355465274994
curr_Factors:  [100.35546527]
mat_Sqrt:  [[0.15]]
grads:  [0.01821034]
Stock Position:  0.01821033795545365
Bond Position:  [2.23231745]


portfolio before change:  [4.06225552]
curr_Stock_Price:  100.48130628999577
curr_Factors:  [100.48130629]
mat_Sqrt:  [[0.15]]
grads:  [-0.01348102]
Stock Position:  -0.01348101642420489
Bond Position:  [5.41684566]


portfolio before change:  [4.05250369]
curr_Stock_Price:  101.22979509018795
curr_Factors:  [101.22979509]
mat_Sqrt:  [[0.15]]
grads:  [0.02244721]
Stock Position:  0.02244721090166794
Bond Position:  [1.78017713]


portfolio before change:  [4.05674693]
curr_Stock_Price:  101.41387054525515
curr_Factors:  [101.41387055]
mat_Sqrt:  [[0.15]]
grads:  [0.12772224]
Stock Position:  0.12772224358700707
Bond Position:  [-8.89606014]


portfolio before change:  [4.08300091]
curr_Stock_Price:  101.62377915889564
curr_Factors:  [101.62377916]
mat_Sqrt:  [[0.15]]
grads:  [0.18145793]
Stock Position:  0.1814579264728544
Bond Position:  [-14.35743933]


portfolio before change:  [4.15214852]
curr_Stock_Price:  102.00979138383984
curr_Factors:  [102.00979138]
mat_Sqrt:  [[0.15]]
grads:  [0.02221501]
Stock Position:  0.02221501483451512
Bond Position:  [1.88599949]


portfolio before change:  [4.15727989]
curr_Stock_Price:  102.23547160141308
curr_Factors:  [102.2354716]
mat_Sqrt:  [[0.15]]
grads:  [0.08501511]
Stock Position:  0.08501511022650231
Bond Position:  [-4.53428]


portfolio before change:  [4.17043465]
curr_Stock_Price:  102.39353952934059
curr_Factors:  [102.39353953]
mat_Sqrt:  [[0.15]]
grads:  [0.1637923]
Stock Position:  0.1637923002947533
Bond Position:  [-12.60083872]


portfolio before change:  [4.25288776]
curr_Stock_Price:  102.90174831330694
curr_Factors:  [102.90174831]
mat_Sqrt:  [[0.15]]
grads:  [-0.02331067]
Stock Position:  -0.023310670395012396
Bond Position:  [6.6515965]


portfolio before change:  [4.27123162]
curr_Stock_Price:  102.13265328140835
curr_Factors:  [102.13265328]
mat_Sqrt:  [[0.15]]
grads:  [0.23172685]
Stock Position:  0.23172685303410065
Bond Position:  [-19.39564672]


portfolio before change:  [4.17655449]
curr_Stock_Price:  101.72931260102686
curr_Factors:  [101.7293126]
mat_Sqrt:  [[0.15]]
grads:  [-0.35524671]
Stock Position:  -0.35524670829511423
Bond Position:  [40.31555792]


portfolio before change:  [3.70224021]
curr_Stock_Price:  103.07157437315553
curr_Factors:  [103.07157437]
mat_Sqrt:  [[0.15]]
grads:  [0.70619934]
Stock Position:  0.7061993394818387
Bond Position:  [-69.08683753]


portfolio before change:  [3.70355013]
curr_Stock_Price:  103.07954377201428
curr_Factors:  [103.07954377]
mat_Sqrt:  [[0.15]]
grads:  [0.09830714]
Stock Position:  0.09830714180892704
Bond Position:  [-6.42990519]


portfolio before change:  [3.71176911]
curr_Stock_Price:  103.1672368982502
curr_Factors:  [103.1672369]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595889]
Stock Position:  -0.04595888925041318
Bond Position:  [8.45322073]


portfolio before change:  [3.77380614]
curr_Stock_Price:  101.82889542277837
curr_Factors:  [101.82889542]
mat_Sqrt:  [[0.15]]
grads:  [0.16123091]
Stock Position:  0.1612309098024597
Bond Position:  [-12.64415931]


portfolio before change:  [3.74816954]
curr_Stock_Price:  101.67479148017135
curr_Factors:  [101.67479148]
mat_Sqrt:  [[0.15]]
grads:  [0.07179515]
Stock Position:  0.07179514901891287
Bond Position:  [-3.55158727]


portfolio before change:  [3.7657531]
curr_Stock_Price:  101.92279634292635
curr_Factors:  [101.92279634]
mat_Sqrt:  [[0.15]]
grads:  [-0.06963301]
Stock Position:  -0.06963300793849019
Bond Position:  [10.86294399]


portfolio before change:  [3.67281175]
curr_Stock_Price:  103.26727802186257
curr_Factors:  [103.26727802]
mat_Sqrt:  [[0.15]]
grads:  [0.0590841]
Stock Position:  0.059084100705656305
Bond Position:  [-2.4286425]


portfolio before change:  [3.72270258]
curr_Stock_Price:  104.11425065939562
curr_Factors:  [104.11425066]
mat_Sqrt:  [[0.15]]
grads:  [-0.05968137]
Stock Position:  -0.05968136610107581
Bond Position:  [9.93638329]


portfolio before change:  [3.7194226]
curr_Stock_Price:  104.17961485846307
curr_Factors:  [104.17961486]
mat_Sqrt:  [[0.15]]
grads:  [0.09968182]
Stock Position:  0.09968181958002861
Bond Position:  [-6.66539098]


portfolio before change:  [3.63349563]
curr_Stock_Price:  103.32178172053422
curr_Factors:  [103.32178172]
mat_Sqrt:  [[0.15]]
grads:  [-0.07075669]
Stock Position:  -0.0707566894220149
Bond Position:  [10.94420285]


portfolio before change:  [3.6294238]
curr_Stock_Price:  103.38899607777154
curr_Factors:  [103.38899608]
mat_Sqrt:  [[0.15]]
grads:  [0.07337246]
Stock Position:  0.07337245857828972
Bond Position:  [-3.95648104]


portfolio before change:  [3.62799027]
curr_Stock_Price:  103.37282875963379
curr_Factors:  [103.37282876]
mat_Sqrt:  [[0.15]]
grads:  [-0.2354965]
Stock Position:  -0.23549649872627912
Bond Position:  [27.97192951]


portfolio before change:  [3.57238433]
curr_Stock_Price:  103.61637482175337
curr_Factors:  [103.61637482]
mat_Sqrt:  [[0.15]]
grads:  [0.04971709]
Stock Position:  0.049717085118747055
Bond Position:  [-1.5791198]


portfolio before change:  [3.58053048]
curr_Stock_Price:  103.7822102699161
curr_Factors:  [103.78221027]
mat_Sqrt:  [[0.15]]
grads:  [0.04516977]
Stock Position:  0.04516977477149533
Bond Position:  [-1.10728858]


portfolio before change:  [3.57495486]
curr_Stock_Price:  103.66030545445379
curr_Factors:  [103.66030545]
mat_Sqrt:  [[0.15]]
grads:  [-0.03235962]
Stock Position:  -0.03235961956390522
Bond Position:  [6.92936291]


portfolio before change:  [3.57879956]
curr_Stock_Price:  103.55487779402404
curr_Factors:  [103.55487779]
mat_Sqrt:  [[0.15]]
grads:  [0.09578568]
Stock Position:  0.09578568269245437
Bond Position:  [-6.3402751]


portfolio before change:  [3.5393504]
curr_Stock_Price:  103.14716672962606
curr_Factors:  [103.14716673]
mat_Sqrt:  [[0.15]]
grads:  [0.29480906]
Stock Position:  0.2948090579453056
Bond Position:  [-26.86936865]


portfolio before change:  [3.68906462]
curr_Stock_Price:  103.66069777595962
curr_Factors:  [103.66069778]
mat_Sqrt:  [[0.15]]
grads:  [0.03051084]
Stock Position:  0.03051084459360129
Bond Position:  [0.52628918]


portfolio before change:  [3.72627363]
curr_Stock_Price:  104.87915359443006
curr_Factors:  [104.87915359]
mat_Sqrt:  [[0.15]]
grads:  [0.13834403]
Stock Position:  0.1383440339591754
Bond Position:  [-10.78313156]


portfolio before change:  [3.77042483]
curr_Stock_Price:  105.20316591185305
curr_Factors:  [105.20316591]
mat_Sqrt:  [[0.15]]
grads:  [0.03760314]
Stock Position:  0.037603142407276746
Bond Position:  [-0.1855448]


portfolio before change:  [3.78739394]
curr_Stock_Price:  105.65474284442804
curr_Factors:  [105.65474284]
mat_Sqrt:  [[0.15]]
grads:  [-0.03082648]
Stock Position:  -0.03082648472065563
Bond Position:  [7.04435826]


portfolio before change:  [3.78440921]
curr_Stock_Price:  105.76584943845424
curr_Factors:  [105.76584944]
mat_Sqrt:  [[0.15]]
grads:  [0.04658953]
Stock Position:  0.046589529349488686
Bond Position:  [-1.14317194]


portfolio before change:  [3.79353351]
curr_Stock_Price:  105.96322749397483
curr_Factors:  [105.96322749]
mat_Sqrt:  [[0.15]]
grads:  [0.06294557]
Stock Position:  0.06294557370219847
Bond Position:  [-2.87638264]


portfolio before change:  [3.75906786]
curr_Stock_Price:  105.41853677078792
curr_Factors:  [105.41853677]
mat_Sqrt:  [[0.15]]
grads:  [0.0315395]
Stock Position:  0.03153950129637174
Bond Position:  [0.43421978]


portfolio before change:  [3.73865472]
curr_Stock_Price:  104.7704517738458
curr_Factors:  [104.77045177]
mat_Sqrt:  [[0.15]]
grads:  [-0.21438286]
Stock Position:  -0.21438286272242477
Bond Position:  [26.1996441]


portfolio before change:  [3.61505416]
curr_Stock_Price:  105.35463135491423
curr_Factors:  [105.35463135]
mat_Sqrt:  [[0.15]]
grads:  [0.05725356]
Stock Position:  0.057253563410183665
Bond Position:  [-2.41687391]


portfolio before change:  [3.5591915]
curr_Stock_Price:  104.38156358603486
curr_Factors:  [104.38156359]
mat_Sqrt:  [[0.15]]
grads:  [0.0914609]
Stock Position:  0.09146090072140761
Bond Position:  [-5.98764033]


portfolio before change:  [3.53512616]
curr_Stock_Price:  104.1225338141991
curr_Factors:  [104.12253381]
mat_Sqrt:  [[0.15]]
grads:  [0.03747331]
Stock Position:  0.03747330895425387
Bond Position:  [-0.36668972]


portfolio before change:  [3.53052609]
curr_Stock_Price:  104.00038947387992
curr_Factors:  [104.00038947]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511859]
Stock Position:  -0.025118593734663408
Bond Position:  [6.14286962]


portfolio before change:  [3.53643935]
curr_Stock_Price:  103.78026087303539
curr_Factors:  [103.78026087]
mat_Sqrt:  [[0.15]]
grads:  [-0.11644986]
Stock Position:  -0.11644985516198875
Bond Position:  [15.6216357]


portfolio before change:  [3.57272517]
curr_Stock_Price:  103.47704511685174
curr_Factors:  [103.47704512]
mat_Sqrt:  [[0.15]]
grads:  [0.13818646]
Stock Position:  0.13818646078083832
Bond Position:  [-10.72640147]


portfolio before change:  [3.52975189]
curr_Stock_Price:  103.17091627495535
curr_Factors:  [103.17091627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847382]
Stock Position:  -0.008473818448278572
Bond Position:  [4.4040035]


portfolio before change:  [3.53333629]
curr_Stock_Price:  102.78040189013174
curr_Factors:  [102.78040189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069446]
Stock Position:  -0.0006944589968021937
Bond Position:  [3.60471307]


portfolio before change:  [3.53402127]
curr_Stock_Price:  102.11848408575426
curr_Factors:  [102.11848409]
mat_Sqrt:  [[0.15]]
grads:  [-0.07176504]
Stock Position:  -0.07176504119617019
Bond Position:  [10.86255849]


portfolio before change:  [3.5345703]
curr_Stock_Price:  102.12029412342807
curr_Factors:  [102.12029412]
mat_Sqrt:  [[0.15]]
grads:  [0.08930785]
Stock Position:  0.08930785060499538
Bond Position:  [-5.58557367]


portfolio before change:  [3.42055938]
curr_Stock_Price:  100.84759731349025
curr_Factors:  [100.84759731]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397334]
Stock Position:  -0.053973341903499436
Bond Position:  [8.86364123]


portfolio before change:  [3.44556152]
curr_Stock_Price:  100.3946301435783
curr_Factors:  [100.39463014]
mat_Sqrt:  [[0.15]]
grads:  [-0.08993492]
Stock Position:  -0.08993491507129675
Bond Position:  [12.47454406]


portfolio before change:  [3.3607895]
curr_Stock_Price:  101.34589260807954
curr_Factors:  [101.34589261]
mat_Sqrt:  [[0.15]]
grads:  [-0.05073331]
Stock Position:  -0.050733307476823974
Bond Position:  [8.50240183]


portfolio before change:  [3.37483011]
curr_Stock_Price:  101.07961400562806
curr_Factors:  [101.07961401]
mat_Sqrt:  [[0.15]]
grads:  [0.09263974]
Stock Position:  0.09263974461958471
Bond Position:  [-5.98915952]


portfolio before change:  [3.33525457]
curr_Stock_Price:  100.6564565167764
curr_Factors:  [100.65645652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258702]
Stock Position:  -0.052587018184470605
Bond Position:  [8.62847748]


portfolio before change:  [3.2721817]
curr_Stock_Price:  101.86611183158907
curr_Factors:  [101.86611183]
mat_Sqrt:  [[0.15]]
grads:  [-0.03480587]
Stock Position:  -0.03480587272387659
Bond Position:  [6.81772063]


portfolio before change:  [3.25021996]
curr_Stock_Price:  102.50933278127731
curr_Factors:  [102.50933278]
mat_Sqrt:  [[0.15]]
grads:  [0.03715483]
Stock Position:  0.0371548284001074
Bond Position:  [-0.55849671]


portfolio before change:  [3.24968482]
curr_Stock_Price:  102.49586945687676
curr_Factors:  [102.49586946]
mat_Sqrt:  [[0.15]]
grads:  [-0.01855516]
Stock Position:  -0.018555155657192644
Bond Position:  [5.15151164]


portfolio before change:  [3.24177361]
curr_Stock_Price:  102.93958377076767
curr_Factors:  [102.93958377]
mat_Sqrt:  [[0.15]]
grads:  [0.037806]
Stock Position:  0.03780600345141388
Bond Position:  [-0.64996064]


portfolio before change:  [3.24199993]
curr_Stock_Price:  102.9466444518513
curr_Factors:  [102.94664445]
mat_Sqrt:  [[0.15]]
grads:  [0.0651108]
Stock Position:  0.0651108027607812
Bond Position:  [-3.46093873]


portfolio before change:  [3.22039337]
curr_Stock_Price:  102.61812374715133
curr_Factors:  [102.61812375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024721]
Stock Position:  -0.002472101279925704
Bond Position:  [3.47407576]


portfolio before change:  [3.22215372]
curr_Stock_Price:  101.99386897869356
curr_Factors:  [101.99386898]
mat_Sqrt:  [[0.15]]
grads:  [0.01089089]
Stock Position:  0.010890890530252939
Bond Position:  [2.11134966]


portfolio before change:  [3.22696094]
curr_Stock_Price:  102.42314971138435
curr_Factors:  [102.42314971]
mat_Sqrt:  [[0.15]]
grads:  [0.10565256]
Stock Position:  0.1056525581974882
Bond Position:  [-7.59430685]


portfolio before change:  [3.27413212]
curr_Stock_Price:  102.87411693558771
curr_Factors:  [102.87411694]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286623]
Stock Position:  -0.012866228578892434
Bond Position:  [4.59773402]


portfolio before change:  [3.26434861]
curr_Stock_Price:  103.65685443538705
curr_Factors:  [103.65685444]
mat_Sqrt:  [[0.15]]
grads:  [0.13551257]
Stock Position:  0.13551256920011162
Bond Position:  [-10.78245805]


portfolio before change:  [3.36722872]
curr_Stock_Price:  104.42102002163666
curr_Factors:  [104.42102002]
mat_Sqrt:  [[0.15]]
grads:  [0.01805611]
Stock Position:  0.01805611494197865
Bond Position:  [1.48179078]


portfolio before change:  [3.36682732]
curr_Stock_Price:  104.39365973835041
curr_Factors:  [104.39365974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08311172]
Stock Position:  -0.083111716208972
Bond Position:  [12.04316354]


portfolio before change:  [3.47180289]
curr_Stock_Price:  103.1396505998288
curr_Factors:  [103.1396506]
mat_Sqrt:  [[0.15]]
grads:  [0.02844509]
Stock Position:  0.028445092253061324
Bond Position:  [0.53798601]


portfolio before change:  [3.48264679]
curr_Stock_Price:  103.51969080893716
curr_Factors:  [103.51969081]
mat_Sqrt:  [[0.15]]
grads:  [0.02130627]
Stock Position:  0.021306274777351832
Bond Position:  [1.27702782]


portfolio before change:  [3.49975386]
curr_Stock_Price:  104.31885671704913
curr_Factors:  [104.31885672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563485]
Stock Position:  -0.035634845363597754
Bond Position:  [7.21714019]


portfolio before change:  [3.4832775]
curr_Stock_Price:  104.79388181418787
curr_Factors:  [104.79388181]
mat_Sqrt:  [[0.15]]
grads:  [0.10249159]
Stock Position:  0.10249158742922114
Bond Position:  [-7.2572138]


portfolio before change:  [3.47830662]
curr_Stock_Price:  104.74980706548743
curr_Factors:  [104.74980707]
mat_Sqrt:  [[0.15]]
grads:  [-0.05987769]
Stock Position:  -0.05987768659306761
Bond Position:  [9.75048274]


portfolio before change:  [3.48811478]
curr_Stock_Price:  104.59618162757242
curr_Factors:  [104.59618163]
mat_Sqrt:  [[0.15]]
grads:  [-0.046722]
Stock Position:  -0.04672200360063622
Bond Position:  [8.37505795]


portfolio before change:  [3.46913148]
curr_Stock_Price:  105.013688493895
curr_Factors:  [105.01368849]
mat_Sqrt:  [[0.15]]
grads:  [-0.07952901]
Stock Position:  -0.07952901074534048
Bond Position:  [11.82076624]


portfolio before change:  [3.53665996]
curr_Stock_Price:  104.17387347152336
curr_Factors:  [104.17387347]
mat_Sqrt:  [[0.15]]
grads:  [0.08960803]
Stock Position:  0.08960802677447804
Bond Position:  [-5.79815529]


portfolio before change:  [3.52384447]
curr_Stock_Price:  104.0349005446671
curr_Factors:  [104.03490054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494535]
Stock Position:  -0.014945349822341398
Bond Position:  [5.07868245]


portfolio before change:  [3.51802537]
curr_Stock_Price:  104.44549860872117
curr_Factors:  [104.44549861]
mat_Sqrt:  [[0.15]]
grads:  [0.16677177]
Stock Position:  0.16677176884639613
Bond Position:  [-13.90053518]


portfolio before change:  [3.54310163]
curr_Stock_Price:  104.60107093497054
curr_Factors:  [104.60107093]
mat_Sqrt:  [[0.15]]
grads:  [-0.16698384]
Stock Position:  -0.16698383951758028
Bond Position:  [21.00979007]


portfolio before change:  [3.38767304]
curr_Stock_Price:  105.53973506672659
curr_Factors:  [105.53973507]
mat_Sqrt:  [[0.15]]
grads:  [0.01820641]
Stock Position:  0.0182064074111466
Bond Position:  [1.46617363]


portfolio before change:  [3.38277865]
curr_Stock_Price:  105.26587406524763
curr_Factors:  [105.26587407]
mat_Sqrt:  [[0.15]]
grads:  [0.01269465]
Stock Position:  0.012694646216801058
Bond Position:  [2.04646562]


portfolio before change:  [3.38653557]
curr_Stock_Price:  105.55174340351103
curr_Factors:  [105.5517434]
mat_Sqrt:  [[0.15]]
grads:  [-0.08387469]
Stock Position:  -0.08387468601957844
Bond Position:  [12.23965491]


portfolio before change:  [3.32421529]
curr_Stock_Price:  106.30388071412932
curr_Factors:  [106.30388071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.32421529]
Stock Price:  105.47599072141865
PL:  [-2.15177543]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.01021707e-03]
 [ 2.41496461e-03]
 [-3.63449333e-03]
 [ 4.09280830e-03]
 [ 2.35729071e-02]
 [ 2.65811107e-02]
 [ 5.91193579e-03]
 [ 2.16442067e-02]
 [ 2.41036292e-02]
 [ 1.35208846e-03]
 [ 6.44619003e-02]
 [ 1.02385927e-01]
 [ 1.29145225e-01]
 [ 1.61216151e-02]
 [-6.89264010e-03]
 [ 3.13680332e-02]
 [ 1.44717388e-02]
 [ 2.95208421e-03]
 [ 1.51446794e-02]
 [-1.06921996e-02]
 [ 1.56093196e-02]
 [-2.00412895e-02]
 [ 9.89820924e-03]
 [-9.65679399e-02]
 [ 1.34056583e-02]
 [ 5.38080860e-03]
 [-3.28904685e-03]
 [ 2.50536836e-02]
 [ 6.97039880e-02]
 [ 1.16457349e-02]
 [ 2.30603688e-02]
 [ 7.88969729e-03]
 [-4.21143572e-03]
 [ 7.13218937e-03]
 [ 9.70444307e-03]
 [ 4.09580636e-03]
 [-3.09489105e-02]
 [ 8.24060194e-03]
 [ 2.61296289e-02]
 [-3.10130238e-02]
 [-1.03052947e-02]
 [-9.12067416e-03]
 [ 1.92661298e-02]
 [-9.12548153e-03]
 [ 2.82457576e-02]
 [-1.77156720e-03]
 [ 1.56735194e-02]
 [ 3.15617485e-02]
 [ 1.25433416e-02]
 [-7.89244867e-03]
 [ 7.53576515e-02]
 [ 1.91352907e-02]
 [-1.21492979e-02]
 [ 5.58903106e-03]
 [-3.10803347e-02]
 [ 4.79447011e-02]
 [ 2.33941575e-02]
 [ 3.27588481e-03]
 [ 2.22921572e-03]
 [-1.03887906e-02]
 [ 2.86027977e-02]
 [ 5.97572770e-02]
 [-1.12672791e-02]
 [-1.11564377e-02]
 [ 2.22240128e-02]
 [ 1.21812548e-02]
 [-3.92058102e-03]
 [ 1.60862618e-02]
 [-3.06601666e-02]
 [-7.13107405e-02]
 [ 6.25101829e-03]
 [ 1.86278405e-02]
 [-5.49066486e-02]
 [ 2.97411460e-02]
 [-3.14199951e-02]
 [ 1.13448688e-02]
 [ 1.86072520e-02]
 [-2.30493404e-02]
 [ 2.13965937e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.71270137]
curr_Stock_Price:  100.10866480989684
curr_Factors:  [100.10866481]
mat_Sqrt:  [[0.15]]
grads:  [0.00673478]
Stock Position:  0.006734780494861672
Bond Position:  [3.03849149]


portfolio before change:  [3.71550267]
curr_Stock_Price:  100.49641042213501
curr_Factors:  [100.49641042]
mat_Sqrt:  [[0.15]]
grads:  [0.01609976]
Stock Position:  0.01609976405833582
Bond Position:  [2.09753417]


portfolio before change:  [3.72054508]
curr_Stock_Price:  100.80146559720392
curr_Factors:  [100.8014656]
mat_Sqrt:  [[0.15]]
grads:  [-0.02422996]
Stock Position:  -0.02422995553383251
Bond Position:  [6.16296011]


portfolio before change:  [3.71478026]
curr_Stock_Price:  101.05528469157267
curr_Factors:  [101.05528469]
mat_Sqrt:  [[0.15]]
grads:  [0.02728539]
Stock Position:  0.02728538868827999
Bond Position:  [0.95744753]


portfolio before change:  [3.73106918]
curr_Stock_Price:  101.65007472917175
curr_Factors:  [101.65007473]
mat_Sqrt:  [[0.15]]
grads:  [0.15715271]
Stock Position:  0.1571527138808045
Bond Position:  [-12.24351593]


portfolio before change:  [3.87715069]
curr_Stock_Price:  102.58449550961083
curr_Factors:  [102.58449551]
mat_Sqrt:  [[0.15]]
grads:  [0.1772074]
Stock Position:  0.17720740451777647
Bond Position:  [-14.3015815]


portfolio before change:  [4.06430621]
curr_Stock_Price:  103.64567798535307
curr_Factors:  [103.64567799]
mat_Sqrt:  [[0.15]]
grads:  [0.03941291]
Stock Position:  0.039412905273224906
Bond Position:  [-0.02067108]


portfolio before change:  [4.0583483]
curr_Stock_Price:  103.4945443215139
curr_Factors:  [103.49454432]
mat_Sqrt:  [[0.15]]
grads:  [0.14429471]
Stock Position:  0.14429471163880808
Bond Position:  [-10.87536713]


portfolio before change:  [4.14858741]
curr_Stock_Price:  104.1246356158851
curr_Factors:  [104.12463562]
mat_Sqrt:  [[0.15]]
grads:  [0.16069086]
Stock Position:  0.16069086138003189
Bond Position:  [-12.58328998]


portfolio before change:  [4.1817216]
curr_Stock_Price:  104.33572831062524
curr_Factors:  [104.33572831]
mat_Sqrt:  [[0.15]]
grads:  [0.00901392]
Stock Position:  0.009013923045761967
Bond Position:  [3.24124737]


portfolio before change:  [4.17991854]
curr_Stock_Price:  104.11322334474484
curr_Factors:  [104.11322334]
mat_Sqrt:  [[0.15]]
grads:  [0.429746]
Stock Position:  0.429746002008704
Bond Position:  [-40.56232295]


portfolio before change:  [4.08101151]
curr_Stock_Price:  103.8889704145666
curr_Factors:  [103.88897041]
mat_Sqrt:  [[0.15]]
grads:  [0.68257285]
Stock Position:  0.6825728452025785
Bond Position:  [-66.83077861]


portfolio before change:  [3.92412808]
curr_Stock_Price:  103.6652486832288
curr_Factors:  [103.66524868]
mat_Sqrt:  [[0.15]]
grads:  [0.86096817]
Stock Position:  0.8609681668526078
Bond Position:  [-85.32835104]


portfolio before change:  [3.61541315]
curr_Stock_Price:  103.3128759020987
curr_Factors:  [103.3128759]
mat_Sqrt:  [[0.15]]
grads:  [0.10747743]
Stock Position:  0.10747743392124627
Bond Position:  [-7.48838965]


portfolio before change:  [3.66074938]
curr_Stock_Price:  103.73905166429437
curr_Factors:  [103.73905166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595093]
Stock Position:  -0.045950934008800244
Bond Position:  [8.4276557]


portfolio before change:  [3.67102568]
curr_Stock_Price:  103.52687852479274
curr_Factors:  [103.52687852]
mat_Sqrt:  [[0.15]]
grads:  [0.20912022]
Stock Position:  0.2091202213895496
Bond Position:  [-17.97853807]


portfolio before change:  [3.7512267]
curr_Stock_Price:  103.91576829827217
curr_Factors:  [103.9157683]
mat_Sqrt:  [[0.15]]
grads:  [0.09647826]
Stock Position:  0.09647825845924145
Bond Position:  [-6.27438565]


portfolio before change:  [3.77769593]
curr_Stock_Price:  104.19418739371658
curr_Factors:  [104.19418739]
mat_Sqrt:  [[0.15]]
grads:  [0.01968056]
Stock Position:  0.019680561392202145
Bond Position:  [1.72709583]


portfolio before change:  [3.78533294]
curr_Stock_Price:  104.57675059744747
curr_Factors:  [104.5767506]
mat_Sqrt:  [[0.15]]
grads:  [0.10096453]
Stock Position:  0.10096452928653836
Bond Position:  [-6.77320946]


portfolio before change:  [3.79245707]
curr_Stock_Price:  104.65150429757233
curr_Factors:  [104.6515043]
mat_Sqrt:  [[0.15]]
grads:  [-0.07128133]
Stock Position:  -0.07128133094154498
Bond Position:  [11.25215558]


portfolio before change:  [3.73837727]
curr_Stock_Price:  105.42005170283684
curr_Factors:  [105.4200517]
mat_Sqrt:  [[0.15]]
grads:  [0.10406213]
Stock Position:  0.10406213069499515
Bond Position:  [-7.23185793]


portfolio before change:  [3.73976312]
curr_Stock_Price:  105.437712869787
curr_Factors:  [105.43771287]
mat_Sqrt:  [[0.15]]
grads:  [-0.1336086]
Stock Position:  -0.13360859690570637
Bond Position:  [17.827148]


portfolio before change:  [3.74221665]
curr_Stock_Price:  105.42768889153625
curr_Factors:  [105.42768889]
mat_Sqrt:  [[0.15]]
grads:  [0.06598806]
Stock Position:  0.06598806162072085
Bond Position:  [-3.21475219]


portfolio before change:  [3.76939018]
curr_Stock_Price:  105.84252852563719
curr_Factors:  [105.84252853]
mat_Sqrt:  [[0.15]]
grads:  [-0.64378627]
Stock Position:  -0.6437862662089184
Bond Position:  [71.90935643]


portfolio before change:  [3.94767502]
curr_Stock_Price:  105.57257811200056
curr_Factors:  [105.57257811]
mat_Sqrt:  [[0.15]]
grads:  [0.08937106]
Stock Position:  0.08937105512620387
Bond Position:  [-5.48745767]


portfolio before change:  [3.97373699]
curr_Stock_Price:  105.86803111711583
curr_Factors:  [105.86803112]
mat_Sqrt:  [[0.15]]
grads:  [0.03587206]
Stock Position:  0.035872057311473485
Bond Position:  [0.17603291]


portfolio before change:  [3.98025442]
curr_Stock_Price:  106.04940983565112
curr_Factors:  [106.04940984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02192698]
Stock Position:  -0.021926978979442284
Bond Position:  [6.30559761]


portfolio before change:  [3.9765919]
curr_Stock_Price:  106.2344165199231
curr_Factors:  [106.23441652]
mat_Sqrt:  [[0.15]]
grads:  [0.16702456]
Stock Position:  0.16702455714952197
Bond Position:  [-13.76716447]


portfolio before change:  [3.88823101]
curr_Stock_Price:  105.71053899126764
curr_Factors:  [105.71053899]
mat_Sqrt:  [[0.15]]
grads:  [0.46469325]
Stock Position:  0.46469325344542023
Bond Position:  [-45.23474327]


portfolio before change:  [4.15087666]
curr_Stock_Price:  106.28182533851636
curr_Factors:  [106.28182534]
mat_Sqrt:  [[0.15]]
grads:  [0.07763823]
Stock Position:  0.07763823275577181
Bond Position:  [-4.10065643]


portfolio before change:  [4.13475902]
curr_Stock_Price:  106.0775272734553
curr_Factors:  [106.07752727]
mat_Sqrt:  [[0.15]]
grads:  [0.15373579]
Stock Position:  0.15373579198876955
Bond Position:  [-12.17315364]


portfolio before change:  [4.06883019]
curr_Stock_Price:  105.6536312688356
curr_Factors:  [105.65363127]
mat_Sqrt:  [[0.15]]
grads:  [0.05259798]
Stock Position:  0.052597981944394065
Bond Position:  [-1.4883376]


portfolio before change:  [4.05672558]
curr_Stock_Price:  105.42526530917159
curr_Factors:  [105.42526531]
mat_Sqrt:  [[0.15]]
grads:  [-0.02807624]
Stock Position:  -0.028076238124808882
Bond Position:  [7.01667043]


portfolio before change:  [4.05432461]
curr_Stock_Price:  105.52640146935147
curr_Factors:  [105.52640147]
mat_Sqrt:  [[0.15]]
grads:  [0.04754793]
Stock Position:  0.04754792910004498
Bond Position:  [-0.96323724]


portfolio before change:  [4.03548705]
curr_Stock_Price:  105.13148719850241
curr_Factors:  [105.1314872]
mat_Sqrt:  [[0.15]]
grads:  [0.06469629]
Stock Position:  0.06469628716293646
Bond Position:  [-2.76612984]


portfolio before change:  [4.07652559]
curr_Stock_Price:  105.76848552946798
curr_Factors:  [105.76848553]
mat_Sqrt:  [[0.15]]
grads:  [0.02730538]
Stock Position:  0.027305375720730805
Bond Position:  [1.18847735]


portfolio before change:  [4.10593326]
curr_Stock_Price:  106.84275720048598
curr_Factors:  [106.8427572]
mat_Sqrt:  [[0.15]]
grads:  [-0.20632607]
Stock Position:  -0.20632607031918251
Bond Position:  [26.1503795]


portfolio before change:  [4.02829594]
curr_Stock_Price:  107.22696348247658
curr_Factors:  [107.22696348]
mat_Sqrt:  [[0.15]]
grads:  [0.05493735]
Stock Position:  0.05493734629115192
Bond Position:  [-1.86246888]


portfolio before change:  [4.0547414]
curr_Stock_Price:  107.71045738319046
curr_Factors:  [107.71045738]
mat_Sqrt:  [[0.15]]
grads:  [0.17419753]
Stock Position:  0.17419752629742724
Bond Position:  [-14.70815383]


portfolio before change:  [4.15650706]
curr_Stock_Price:  108.29993157215175
curr_Factors:  [108.29993157]
mat_Sqrt:  [[0.15]]
grads:  [-0.20675349]
Stock Position:  -0.2067534917627471
Bond Position:  [26.54789607]


portfolio before change:  [4.21354392]
curr_Stock_Price:  108.03208813891612
curr_Factors:  [108.03208814]
mat_Sqrt:  [[0.15]]
grads:  [-0.06870196]
Stock Position:  -0.0687019647155951
Bond Position:  [11.63556063]


portfolio before change:  [4.20113849]
curr_Stock_Price:  108.22324244827821
curr_Factors:  [108.22324245]
mat_Sqrt:  [[0.15]]
grads:  [-0.06080449]
Stock Position:  -0.0608044943997482
Bond Position:  [10.78159803]


portfolio before change:  [4.20882734]
curr_Stock_Price:  108.1078730114939
curr_Factors:  [108.10787301]
mat_Sqrt:  [[0.15]]
grads:  [0.12844087]
Stock Position:  0.1284408654994432
Bond Position:  [-9.67664144]


portfolio before change:  [4.13985327]
curr_Stock_Price:  107.57557154168711
curr_Factors:  [107.57557154]
mat_Sqrt:  [[0.15]]
grads:  [-0.06083654]
Stock Position:  -0.06083654352282846
Bond Position:  [10.68437921]


portfolio before change:  [4.13478402]
curr_Stock_Price:  107.66987417256958
curr_Factors:  [107.66987417]
mat_Sqrt:  [[0.15]]
grads:  [0.18830505]
Stock Position:  0.1883050505290448
Bond Position:  [-16.13999708]


portfolio before change:  [4.14150507]
curr_Stock_Price:  107.71092370803412
curr_Factors:  [107.71092371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01181045]
Stock Position:  -0.011810447973555535
Bond Position:  [5.41361933]


portfolio before change:  [4.13927487]
curr_Stock_Price:  107.92840584103668
curr_Factors:  [107.92840584]
mat_Sqrt:  [[0.15]]
grads:  [0.10449013]
Stock Position:  0.10449012964402703
Bond Position:  [-7.13817825]


portfolio before change:  [4.08061234]
curr_Stock_Price:  107.3712586681699
curr_Factors:  [107.37125867]
mat_Sqrt:  [[0.15]]
grads:  [0.21041166]
Stock Position:  0.2104116569976825
Bond Position:  [-18.51155211]


portfolio before change:  [4.0906144]
curr_Stock_Price:  107.42429309091095
curr_Factors:  [107.42429309]
mat_Sqrt:  [[0.15]]
grads:  [0.08362228]
Stock Position:  0.0836222773494876
Bond Position:  [-4.89244964]


portfolio before change:  [4.13800306]
curr_Stock_Price:  107.9946488549144
curr_Factors:  [107.99464885]
mat_Sqrt:  [[0.15]]
grads:  [-0.05261632]
Stock Position:  -0.052616324492848886
Bond Position:  [9.82028454]


portfolio before change:  [4.11414704]
curr_Stock_Price:  108.45970999057464
curr_Factors:  [108.45970999]
mat_Sqrt:  [[0.15]]
grads:  [0.50238434]
Stock Position:  0.5023843431964942
Bond Position:  [-50.37431313]


portfolio before change:  [4.33151213]
curr_Stock_Price:  108.89864403086692
curr_Factors:  [108.89864403]
mat_Sqrt:  [[0.15]]
grads:  [0.1275686]
Stock Position:  0.1275686048224027
Bond Position:  [-9.56053595]


portfolio before change:  [4.37577611]
curr_Stock_Price:  109.25030995465801
curr_Factors:  [109.25030995]
mat_Sqrt:  [[0.15]]
grads:  [-0.08099532]
Stock Position:  -0.08099531957450162
Bond Position:  [13.22453988]


portfolio before change:  [4.34530458]
curr_Stock_Price:  109.63672845227836
curr_Factors:  [109.63672845]
mat_Sqrt:  [[0.15]]
grads:  [0.03726021]
Stock Position:  0.037260207048786506
Bond Position:  [0.26021738]


portfolio before change:  [4.33411989]
curr_Stock_Price:  109.33611398711399
curr_Factors:  [109.33611399]
mat_Sqrt:  [[0.15]]
grads:  [-0.20720223]
Stock Position:  -0.20720223164402762
Bond Position:  [26.9888067]


portfolio before change:  [4.31479297]
curr_Stock_Price:  109.4375307222184
curr_Factors:  [109.43753072]
mat_Sqrt:  [[0.15]]
grads:  [0.31963134]
Stock Position:  0.3196313404988819
Bond Position:  [-30.66487168]


portfolio before change:  [4.48868251]
curr_Stock_Price:  109.98755862900713
curr_Factors:  [109.98755863]
mat_Sqrt:  [[0.15]]
grads:  [0.15596105]
Stock Position:  0.155961049995401
Bond Position:  [-12.66509262]


portfolio before change:  [4.45999811]
curr_Stock_Price:  109.80871391620084
curr_Factors:  [109.80871392]
mat_Sqrt:  [[0.15]]
grads:  [0.02183923]
Stock Position:  0.021839232042447452
Bond Position:  [2.06186012]


portfolio before change:  [4.45782962]
curr_Stock_Price:  109.70351990218681
curr_Factors:  [109.7035199]
mat_Sqrt:  [[0.15]]
grads:  [0.01486144]
Stock Position:  0.014861438112940445
Bond Position:  [2.82747755]


portfolio before change:  [4.45708326]
curr_Stock_Price:  109.6414071547728
curr_Factors:  [109.64140715]
mat_Sqrt:  [[0.15]]
grads:  [-0.0692586]
Stock Position:  -0.06925860408610124
Bond Position:  [12.05069407]


portfolio before change:  [4.45187888]
curr_Stock_Price:  109.72742635213427
curr_Factors:  [109.72742635]
mat_Sqrt:  [[0.15]]
grads:  [0.19068532]
Stock Position:  0.19068531778418976
Bond Position:  [-16.47153028]


portfolio before change:  [4.4153865]
curr_Stock_Price:  109.54145044508502
curr_Factors:  [109.54145045]
mat_Sqrt:  [[0.15]]
grads:  [0.39838185]
Stock Position:  0.3983818463719317
Bond Position:  [-39.22393878]


portfolio before change:  [4.73408764]
curr_Stock_Price:  110.34759336345037
curr_Factors:  [110.34759336]
mat_Sqrt:  [[0.15]]
grads:  [-0.07511519]
Stock Position:  -0.07511519395542936
Bond Position:  [13.02286851]


portfolio before change:  [4.75122851]
curr_Stock_Price:  110.1302348982505
curr_Factors:  [110.1302349]
mat_Sqrt:  [[0.15]]
grads:  [-0.07437625]
Stock Position:  -0.07437625109654682
Bond Position:  [12.94230252]


portfolio before change:  [4.74223451]
curr_Stock_Price:  110.2620367219478
curr_Factors:  [110.26203672]
mat_Sqrt:  [[0.15]]
grads:  [0.14816009]
Stock Position:  0.14816008551228552
Bond Position:  [-11.59419828]


portfolio before change:  [4.76672038]
curr_Stock_Price:  110.43219409199001
curr_Factors:  [110.43219409]
mat_Sqrt:  [[0.15]]
grads:  [0.08120837]
Stock Position:  0.08120836500428784
Bond Position:  [-4.20129755]


portfolio before change:  [4.74515902]
curr_Stock_Price:  110.16992095008551
curr_Factors:  [110.16992095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02613721]
Stock Position:  -0.02613720680359581
Bond Position:  [7.62469302]


portfolio before change:  [4.73460472]
curr_Stock_Price:  110.59195751565382
curr_Factors:  [110.59195752]
mat_Sqrt:  [[0.15]]
grads:  [0.10724175]
Stock Position:  0.10724174518628354
Bond Position:  [-7.12546981]


portfolio before change:  [4.71097601]
curr_Stock_Price:  110.37577906340736
curr_Factors:  [110.37577906]
mat_Sqrt:  [[0.15]]
grads:  [-0.20440111]
Stock Position:  -0.20440111068468986
Bond Position:  [27.27190784]


portfolio before change:  [4.64963538]
curr_Stock_Price:  110.68421757381876
curr_Factors:  [110.68421757]
mat_Sqrt:  [[0.15]]
grads:  [-0.47540494]
Stock Position:  -0.4754049366392651
Bond Position:  [57.26945882]


portfolio before change:  [4.50638916]
curr_Stock_Price:  110.9930609674488
curr_Factors:  [110.99306097]
mat_Sqrt:  [[0.15]]
grads:  [0.04167346]
Stock Position:  0.04167345523563943
Bond Position:  [-0.1190752]


portfolio before change:  [4.5059109]
curr_Stock_Price:  110.98176312370356
curr_Factors:  [110.98176312]
mat_Sqrt:  [[0.15]]
grads:  [0.1241856]
Stock Position:  0.12418560303279674
Bond Position:  [-9.27642628]


portfolio before change:  [4.48817014]
curr_Stock_Price:  110.84357508410888
curr_Factors:  [110.84357508]
mat_Sqrt:  [[0.15]]
grads:  [-0.36604432]
Stock Position:  -0.3660443241685415
Bond Position:  [45.06183167]


portfolio before change:  [4.66060695]
curr_Stock_Price:  110.38018758002629
curr_Factors:  [110.38018758]
mat_Sqrt:  [[0.15]]
grads:  [0.19827431]
Stock Position:  0.1982743068338214
Bond Position:  [-17.22494823]


portfolio before change:  [4.69156491]
curr_Stock_Price:  110.54175437148784
curr_Factors:  [110.54175437]
mat_Sqrt:  [[0.15]]
grads:  [-0.20946663]
Stock Position:  -0.20946663425928017
Bond Position:  [27.84637414]


portfolio before change:  [4.50738158]
curr_Stock_Price:  111.42936009054021
curr_Factors:  [111.42936009]
mat_Sqrt:  [[0.15]]
grads:  [0.07563246]
Stock Position:  0.07563245899688034
Bond Position:  [-3.92029493]


portfolio before change:  [4.53287142]
curr_Stock_Price:  111.76962229530393
curr_Factors:  [111.7696223]
mat_Sqrt:  [[0.15]]
grads:  [0.12404835]
Stock Position:  0.12404834636157283
Bond Position:  [-9.3319654]


portfolio before change:  [4.45294441]
curr_Stock_Price:  111.13000277154686
curr_Factors:  [111.13000277]
mat_Sqrt:  [[0.15]]
grads:  [-0.15366227]
Stock Position:  -0.15366226904439062
Bond Position:  [21.52943279]


portfolio before change:  [4.53798656]
curr_Stock_Price:  110.5853243484031
curr_Factors:  [110.58532435]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.53798656]
Stock Price:  111.19230827023304
PL:  [-6.65432171]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.76907245e-04]
 [ 2.75994355e-03]
 [-1.50316204e-03]
 [ 5.55790203e-03]
 [-6.02805571e-03]
 [ 4.96012824e-03]
 [ 4.98046828e-03]
 [-2.68794563e-02]
 [-2.11254929e-02]
 [ 2.98141755e-02]
 [-2.23421219e-02]
 [ 2.52644604e-02]
 [-1.41243929e-02]
 [ 6.76777789e-03]
 [-6.95123414e-03]
 [ 6.15264204e-03]
 [ 7.29315696e-03]
 [-6.24311778e-03]
 [ 2.19497275e-03]
 [ 8.93118788e-03]
 [ 1.24208950e-02]
 [-9.32676746e-03]
 [ 8.04252655e-03]
 [ 2.67471204e-02]
 [-7.99201252e-03]
 [ 7.87222859e-03]
 [-7.12301447e-03]
 [ 5.80298684e-03]
 [ 2.92767646e-03]
 [-3.41297602e-03]
 [ 2.44639724e-03]
 [-1.21153313e-02]
 [ 8.53346160e-03]
 [ 8.46597297e-03]
 [ 1.04302629e-02]
 [ 8.51584060e-03]
 [-3.35400373e-02]
 [ 9.48207539e-03]
 [ 5.34036121e-03]
 [ 1.92857549e-02]
 [-5.54601380e-03]
 [-1.99699191e-02]
 [ 2.11414249e-02]
 [-2.59045975e-04]
 [-2.22806483e-03]
 [-1.14683728e-02]
 [ 1.20584081e-02]
 [ 6.11112983e-04]
 [-4.26460042e-03]
 [-7.43878067e-03]
 [-3.42911417e-02]
 [ 2.66115354e-03]
 [-8.37634753e-03]
 [ 5.57683522e-03]
 [-3.71397666e-03]
 [ 9.21992411e-03]
 [ 1.02070520e-02]
 [-2.70248463e-05]
 [ 1.77389282e-03]
 [ 8.34214661e-03]
 [ 1.53997482e-02]
 [ 4.42076429e-02]
 [-6.00012830e-04]
 [-1.24319177e-02]
 [ 1.51735671e-02]
 [ 8.32074420e-03]
 [-4.95291908e-03]
 [ 1.57316221e-02]
 [-1.68729231e-02]
 [-3.51068487e-02]
 [-5.78663011e-03]
 [ 1.63597892e-02]
 [-3.41171221e-02]
 [ 2.87601447e-02]
 [-2.97618153e-02]
 [ 5.25831050e-03]
 [ 7.24769479e-03]
 [-1.38460650e-02]
 [ 2.42013284e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.84824881]
curr_Stock_Price:  100.11747877630069
curr_Factors:  [100.11747878]
mat_Sqrt:  [[0.15]]
grads:  [0.00651271]
Stock Position:  0.006512714968292116
Bond Position:  [3.19621221]


portfolio before change:  [3.84991159]
curr_Stock_Price:  100.34211790920197
curr_Factors:  [100.34211791]
mat_Sqrt:  [[0.15]]
grads:  [0.01839962]
Stock Position:  0.01839962368376656
Bond Position:  [2.00365438]


portfolio before change:  [3.83037509]
curr_Stock_Price:  99.27352342039595
curr_Factors:  [99.27352342]
mat_Sqrt:  [[0.15]]
grads:  [-0.01002108]
Stock Position:  -0.010021080299847045
Bond Position:  [4.82520304]


portfolio before change:  [3.83984654]
curr_Stock_Price:  98.35846562146784
curr_Factors:  [98.35846562]
mat_Sqrt:  [[0.15]]
grads:  [0.03705268]
Stock Position:  0.03705268019309621
Bond Position:  [0.19540177]


portfolio before change:  [3.83101596]
curr_Stock_Price:  98.11981100895069
curr_Factors:  [98.11981101]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018704]
Stock Position:  -0.040187038075129446
Bond Position:  [7.77416054]


portfolio before change:  [3.86753263]
curr_Stock_Price:  97.2232341546247
curr_Factors:  [97.22323415]
mat_Sqrt:  [[0.15]]
grads:  [0.03306752]
Stock Position:  0.03306752160145481
Bond Position:  [0.65260123]


portfolio before change:  [3.87124335]
curr_Stock_Price:  97.33421712391427
curr_Factors:  [97.33421712]
mat_Sqrt:  [[0.15]]
grads:  [0.03320312]
Stock Position:  0.03320312184607626
Bond Position:  [0.63944348]


portfolio before change:  [3.87737545]
curr_Stock_Price:  97.51769785650919
curr_Factors:  [97.51769786]
mat_Sqrt:  [[0.15]]
grads:  [-0.17919638]
Stock Position:  -0.17919637544812558
Bond Position:  [21.35219344]


portfolio before change:  [3.85386327]
curr_Stock_Price:  97.6563542902878
curr_Factors:  [97.65635429]
mat_Sqrt:  [[0.15]]
grads:  [-0.14083662]
Stock Position:  -0.14083661964568794
Bond Position:  [17.6074541]


portfolio before change:  [3.83674394]
curr_Stock_Price:  97.78572286672693
curr_Factors:  [97.78572287]
mat_Sqrt:  [[0.15]]
grads:  [0.19876117]
Stock Position:  0.19876117004848703
Bond Position:  [-15.59926075]


portfolio before change:  [3.90247138]
curr_Stock_Price:  98.1213136885029
curr_Factors:  [98.12131369]
mat_Sqrt:  [[0.15]]
grads:  [-0.14894748]
Stock Position:  -0.14894747908157221
Bond Position:  [18.5173937]


portfolio before change:  [3.88967308]
curr_Stock_Price:  98.21500894562087
curr_Factors:  [98.21500895]
mat_Sqrt:  [[0.15]]
grads:  [0.16842974]
Stock Position:  0.16842973570988085
Bond Position:  [-12.65265492]


portfolio before change:  [3.97430373]
curr_Stock_Price:  98.72217277375937
curr_Factors:  [98.72217277]
mat_Sqrt:  [[0.15]]
grads:  [-0.09416262]
Stock Position:  -0.094162619542574
Bond Position:  [13.27024213]


portfolio before change:  [3.98789151]
curr_Stock_Price:  98.58667992356114
curr_Factors:  [98.58667992]
mat_Sqrt:  [[0.15]]
grads:  [0.04511852]
Stock Position:  0.045118519237897226
Bond Position:  [-0.4601935]


portfolio before change:  [4.00411871]
curr_Stock_Price:  98.94697461885985
curr_Factors:  [98.94697462]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634156]
Stock Position:  -0.0463415609505897
Bond Position:  [8.58947597]


portfolio before change:  [4.00840006]
curr_Stock_Price:  98.86617255796423
curr_Factors:  [98.86617256]
mat_Sqrt:  [[0.15]]
grads:  [0.04101761]
Stock Position:  0.04101761360009666
Bond Position:  [-0.0468544]


portfolio before change:  [4.00680036]
curr_Stock_Price:  98.82724364202386
curr_Factors:  [98.82724364]
mat_Sqrt:  [[0.15]]
grads:  [0.04862105]
Stock Position:  0.04862104637941338
Bond Position:  [-0.79828363]


portfolio before change:  [3.96159684]
curr_Stock_Price:  97.89855883595824
curr_Factors:  [97.89855884]
mat_Sqrt:  [[0.15]]
grads:  [-0.04162079]
Stock Position:  -0.0416207851695657
Bond Position:  [8.03621173]


portfolio before change:  [3.98563025]
curr_Stock_Price:  97.33318911668765
curr_Factors:  [97.33318912]
mat_Sqrt:  [[0.15]]
grads:  [0.01463315]
Stock Position:  0.014633151682027903
Bond Position:  [2.56133893]


portfolio before change:  [3.98798822]
curr_Stock_Price:  97.4833874653167
curr_Factors:  [97.48338747]
mat_Sqrt:  [[0.15]]
grads:  [0.05954125]
Stock Position:  0.05954125250656475
Bond Position:  [-1.81629477]


portfolio before change:  [4.00680889]
curr_Stock_Price:  97.80138883527682
curr_Factors:  [97.80138884]
mat_Sqrt:  [[0.15]]
grads:  [0.08280597]
Stock Position:  0.0828059665006702
Bond Position:  [-4.09172963]


portfolio before change:  [4.03799157]
curr_Stock_Price:  98.18105248488114
curr_Factors:  [98.18105248]
mat_Sqrt:  [[0.15]]
grads:  [-0.06217845]
Stock Position:  -0.062178449761496266
Bond Position:  [10.14273721]


portfolio before change:  [3.98002453]
curr_Stock_Price:  99.12351701288459
curr_Factors:  [99.12351701]
mat_Sqrt:  [[0.15]]
grads:  [0.05361684]
Stock Position:  0.05361684364134099
Bond Position:  [-1.33466559]


portfolio before change:  [3.98240427]
curr_Stock_Price:  99.16945706402598
curr_Factors:  [99.16945706]
mat_Sqrt:  [[0.15]]
grads:  [0.17831414]
Stock Position:  0.1783141361604521
Bond Position:  [-13.7009118]


portfolio before change:  [3.98745346]
curr_Stock_Price:  99.20257572607429
curr_Factors:  [99.20257573]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328008]
Stock Position:  -0.053280083433698416
Bond Position:  [9.27297497]


portfolio before change:  [3.96197172]
curr_Stock_Price:  99.6917138939363
curr_Factors:  [99.69171389]
mat_Sqrt:  [[0.15]]
grads:  [0.05248152]
Stock Position:  0.05248152393531095
Bond Position:  [-1.27000135]


portfolio before change:  [3.98263658]
curr_Stock_Price:  100.08698131432372
curr_Factors:  [100.08698131]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748676]
Stock Position:  -0.04748676313313526
Bond Position:  [8.73544335]


portfolio before change:  [3.97803477]
curr_Stock_Price:  100.19538592362564
curr_Factors:  [100.19538592]
mat_Sqrt:  [[0.15]]
grads:  [0.03868658]
Stock Position:  0.038686578921519825
Bond Position:  [0.10181807]


portfolio before change:  [3.98310032]
curr_Stock_Price:  100.32615946954233
curr_Factors:  [100.32615947]
mat_Sqrt:  [[0.15]]
grads:  [0.01951784]
Stock Position:  0.019517843043412055
Bond Position:  [2.02495008]


portfolio before change:  [3.98938436]
curr_Stock_Price:  100.64163894223448
curr_Factors:  [100.64163894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02275317]
Stock Position:  -0.02275317344422397
Bond Position:  [6.27930103]


portfolio before change:  [4.00517895]
curr_Stock_Price:  99.96471706287439
curr_Factors:  [99.96471706]
mat_Sqrt:  [[0.15]]
grads:  [0.01630931]
Stock Position:  0.01630931495116233
Bond Position:  [2.3748229]


portfolio before change:  [4.0157697]
curr_Stock_Price:  100.60498395768244
curr_Factors:  [100.60498396]
mat_Sqrt:  [[0.15]]
grads:  [-0.08076888]
Stock Position:  -0.08076887542355546
Bond Position:  [12.14152111]


portfolio before change:  [3.94247939]
curr_Stock_Price:  101.52178734056322
curr_Factors:  [101.52178734]
mat_Sqrt:  [[0.15]]
grads:  [0.05688974]
Stock Position:  0.05688974402085893
Bond Position:  [-1.83306911]


portfolio before change:  [4.00889661]
curr_Stock_Price:  102.6912739027294
curr_Factors:  [102.6912739]
mat_Sqrt:  [[0.15]]
grads:  [0.05643982]
Stock Position:  0.05643981977532403
Bond Position:  [-1.78698038]


portfolio before change:  [4.04777466]
curr_Stock_Price:  103.38209364280293
curr_Factors:  [103.38209364]
mat_Sqrt:  [[0.15]]
grads:  [0.06953509]
Stock Position:  0.06953508618919337
Bond Position:  [-3.14090813]


portfolio before change:  [3.96531527]
curr_Stock_Price:  102.19904951997555
curr_Factors:  [102.19904952]
mat_Sqrt:  [[0.15]]
grads:  [0.05677227]
Stock Position:  0.056772270660646135
Bond Position:  [-1.83675683]


portfolio before change:  [3.95740753]
curr_Stock_Price:  102.0617828088813
curr_Factors:  [102.06178281]
mat_Sqrt:  [[0.15]]
grads:  [-0.22360025]
Stock Position:  -0.22360024883698326
Bond Position:  [26.77844756]


portfolio before change:  [3.96325424]
curr_Stock_Price:  102.04311999447512
curr_Factors:  [102.04311999]
mat_Sqrt:  [[0.15]]
grads:  [0.06321384]
Stock Position:  0.06321383590859324
Bond Position:  [-2.4872828]


portfolio before change:  [3.9626723]
curr_Stock_Price:  102.03637337013113
curr_Factors:  [102.03637337]
mat_Sqrt:  [[0.15]]
grads:  [0.03560241]
Stock Position:  0.03560240809819452
Bond Position:  [0.3299317]


portfolio before change:  [3.95018351]
curr_Stock_Price:  101.68500924982901
curr_Factors:  [101.68500925]
mat_Sqrt:  [[0.15]]
grads:  [0.1285717]
Stock Position:  0.128571699115124
Bond Position:  [-9.1236309]


portfolio before change:  [3.91852397]
curr_Stock_Price:  101.44320407140559
curr_Factors:  [101.44320407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03697343]
Stock Position:  -0.03697342530447395
Bond Position:  [7.6692267]


portfolio before change:  [3.91202516]
curr_Stock_Price:  101.63193827236718
curr_Factors:  [101.63193827]
mat_Sqrt:  [[0.15]]
grads:  [-0.13313279]
Stock Position:  -0.13313279415440746
Bond Position:  [17.44256908]


portfolio before change:  [3.84079842]
curr_Stock_Price:  102.17513226104381
curr_Factors:  [102.17513226]
mat_Sqrt:  [[0.15]]
grads:  [0.14094283]
Stock Position:  0.1409428329990945
Bond Position:  [-10.56005418]


portfolio before change:  [3.90114394]
curr_Stock_Price:  102.60797121028088
curr_Factors:  [102.60797121]
mat_Sqrt:  [[0.15]]
grads:  [-0.00172697]
Stock Position:  -0.0017269731691416219
Bond Position:  [4.07834516]


portfolio before change:  [3.90172363]
curr_Stock_Price:  102.41990483330018
curr_Factors:  [102.41990483]
mat_Sqrt:  [[0.15]]
grads:  [-0.01485377]
Stock Position:  -0.014853765507045522
Bond Position:  [5.42304488]


portfolio before change:  [3.90415182]
curr_Stock_Price:  102.27925154819746
curr_Factors:  [102.27925155]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645582]
Stock Position:  -0.07645581842169767
Bond Position:  [11.7239957]


portfolio before change:  [3.95530258]
curr_Stock_Price:  101.6198120154681
curr_Factors:  [101.61981202]
mat_Sqrt:  [[0.15]]
grads:  [0.08038939]
Stock Position:  0.08038938710001853
Bond Position:  [-4.21385183]


portfolio before change:  [4.01173702]
curr_Stock_Price:  102.32510188718013
curr_Factors:  [102.32510189]
mat_Sqrt:  [[0.15]]
grads:  [0.00407409]
Stock Position:  0.0040740865555788435
Bond Position:  [3.5948557]


portfolio before change:  [4.01128502]
curr_Stock_Price:  102.15900522608369
curr_Factors:  [102.15900523]
mat_Sqrt:  [[0.15]]
grads:  [-0.02843067]
Stock Position:  -0.028430669485352708
Bond Position:  [6.91573393]


portfolio before change:  [4.00383192]
curr_Stock_Price:  102.4363588560738
curr_Factors:  [102.43635886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04959187]
Stock Position:  -0.049591871147601996
Bond Position:  [9.08384262]


portfolio before change:  [3.96766361]
curr_Stock_Price:  103.1771267265665
curr_Factors:  [103.17712673]
mat_Sqrt:  [[0.15]]
grads:  [-0.22860761]
Stock Position:  -0.22860761146118455
Bond Position:  [27.55474011]


portfolio before change:  [3.91131889]
curr_Stock_Price:  103.43112938906927
curr_Factors:  [103.43112939]
mat_Sqrt:  [[0.15]]
grads:  [0.01774102]
Stock Position:  0.01774102359670432
Bond Position:  [2.07634478]


portfolio before change:  [3.90289027]
curr_Stock_Price:  102.94872198393601
curr_Factors:  [102.94872198]
mat_Sqrt:  [[0.15]]
grads:  [-0.05584232]
Stock Position:  -0.055842316838740774
Bond Position:  [9.65178542]


portfolio before change:  [3.92695154]
curr_Stock_Price:  102.52864587908621
curr_Factors:  [102.52864588]
mat_Sqrt:  [[0.15]]
grads:  [0.0371789]
Stock Position:  0.03717890146333668
Bond Position:  [0.11504912]


portfolio before change:  [3.93131839]
curr_Stock_Price:  102.64590737703543
curr_Factors:  [102.64590738]
mat_Sqrt:  [[0.15]]
grads:  [-0.02475984]
Stock Position:  -0.024759844401962647
Bond Position:  [6.47281508]


portfolio before change:  [3.90970526]
curr_Stock_Price:  103.53515732978374
curr_Factors:  [103.53515733]
mat_Sqrt:  [[0.15]]
grads:  [0.06146616]
Stock Position:  0.06146616073417481
Bond Position:  [-2.45420336]


portfolio before change:  [3.91126724]
curr_Stock_Price:  103.56306487574507
curr_Factors:  [103.56306488]
mat_Sqrt:  [[0.15]]
grads:  [0.06804701]
Stock Position:  0.0680470130390843
Bond Position:  [-3.13588999]


portfolio before change:  [3.88855218]
curr_Stock_Price:  103.2321310354235
curr_Factors:  [103.23213104]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018017]
Stock Position:  -0.00018016564227865136
Bond Position:  [3.90715106]


portfolio before change:  [3.88866432]
curr_Stock_Price:  103.96515487992296
curr_Factors:  [103.96515488]
mat_Sqrt:  [[0.15]]
grads:  [0.01182595]
Stock Position:  0.011825952127291256
Bond Position:  [2.65917737]


portfolio before change:  [3.90350369]
curr_Stock_Price:  105.20591439012473
curr_Factors:  [105.20591439]
mat_Sqrt:  [[0.15]]
grads:  [0.05561431]
Stock Position:  0.05561431070574773
Bond Position:  [-1.94745073]


portfolio before change:  [3.94269916]
curr_Stock_Price:  105.9128762480537
curr_Factors:  [105.91287625]
mat_Sqrt:  [[0.15]]
grads:  [0.10266499]
Stock Position:  0.10266498819427916
Bond Position:  [-6.93084503]


portfolio before change:  [4.01716567]
curr_Stock_Price:  106.64243073450798
curr_Factors:  [106.64243073]
mat_Sqrt:  [[0.15]]
grads:  [0.29471762]
Stock Position:  0.2947176192717854
Bond Position:  [-27.41223763]


portfolio before change:  [3.75404292]
curr_Stock_Price:  105.75544799956657
curr_Factors:  [105.755448]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400009]
Stock Position:  -0.004000085536093346
Bond Position:  [4.17707375]


portfolio before change:  [3.75835306]
curr_Stock_Price:  104.74320156026951
curr_Factors:  [104.74320156]
mat_Sqrt:  [[0.15]]
grads:  [-0.08287945]
Stock Position:  -0.08287945110471413
Bond Position:  [12.43941212]


portfolio before change:  [3.68312986]
curr_Stock_Price:  105.66020434648387
curr_Factors:  [105.66020435]
mat_Sqrt:  [[0.15]]
grads:  [0.10115711]
Stock Position:  0.10115711408607701
Bond Position:  [-7.00515148]


portfolio before change:  [3.79494017]
curr_Stock_Price:  106.76984591360292
curr_Factors:  [106.76984591]
mat_Sqrt:  [[0.15]]
grads:  [0.05547163]
Stock Position:  0.055471628030042436
Bond Position:  [-2.12775701]


portfolio before change:  [3.80718889]
curr_Stock_Price:  106.99305400481568
curr_Factors:  [106.993054]
mat_Sqrt:  [[0.15]]
grads:  [-0.03301946]
Stock Position:  -0.03301946050825284
Bond Position:  [7.34004181]


portfolio before change:  [3.78410262]
curr_Stock_Price:  107.7061196745629
curr_Factors:  [107.70611967]
mat_Sqrt:  [[0.15]]
grads:  [0.10487748]
Stock Position:  0.10487748060743074
Bond Position:  [-7.51184386]


portfolio before change:  [3.69822251]
curr_Stock_Price:  106.89173512812083
curr_Factors:  [106.89173513]
mat_Sqrt:  [[0.15]]
grads:  [-0.11248615]
Stock Position:  -0.11248615375985253
Bond Position:  [15.72206267]


portfolio before change:  [3.66435095]
curr_Stock_Price:  107.20158859697189
curr_Factors:  [107.2015886]
mat_Sqrt:  [[0.15]]
grads:  [-0.23404566]
Stock Position:  -0.23404565782510947
Bond Position:  [28.75441727]


portfolio before change:  [3.61416166]
curr_Stock_Price:  107.42370977219375
curr_Factors:  [107.42370977]
mat_Sqrt:  [[0.15]]
grads:  [-0.03857753]
Stock Position:  -0.03857753405961397
Bond Position:  [7.75830348]


portfolio before change:  [3.59167922]
curr_Stock_Price:  108.01906524391458
curr_Factors:  [108.01906524]
mat_Sqrt:  [[0.15]]
grads:  [0.10906526]
Stock Position:  0.10906526112444734
Bond Position:  [-8.18944834]


portfolio before change:  [3.61079322]
curr_Stock_Price:  108.19901123630599
curr_Factors:  [108.19901124]
mat_Sqrt:  [[0.15]]
grads:  [-0.22744748]
Stock Position:  -0.22744748040150364
Bond Position:  [28.22038571]


portfolio before change:  [3.60912166]
curr_Stock_Price:  108.21411534040934
curr_Factors:  [108.21411534]
mat_Sqrt:  [[0.15]]
grads:  [0.1917343]
Stock Position:  0.19173429768322509
Bond Position:  [-17.13923574]


portfolio before change:  [3.50530186]
curr_Stock_Price:  107.67822498683364
curr_Factors:  [107.67822499]
mat_Sqrt:  [[0.15]]
grads:  [-0.1984121]
Stock Position:  -0.1984121020292482
Bond Position:  [24.86996483]


portfolio before change:  [3.60075725]
curr_Stock_Price:  107.20496272254253
curr_Factors:  [107.20496272]
mat_Sqrt:  [[0.15]]
grads:  [0.0350554]
Stock Position:  0.03505540330273456
Bond Position:  [-0.15735596]


portfolio before change:  [3.60417391]
curr_Stock_Price:  107.30270811515138
curr_Factors:  [107.30270812]
mat_Sqrt:  [[0.15]]
grads:  [0.04831797]
Stock Position:  0.04831796523856617
Bond Position:  [-1.58047461]


portfolio before change:  [3.55062132]
curr_Stock_Price:  106.1964154415782
curr_Factors:  [106.19641544]
mat_Sqrt:  [[0.15]]
grads:  [-0.0923071]
Stock Position:  -0.09230710013963131
Bond Position:  [13.35330448]


portfolio before change:  [3.55000631]
curr_Stock_Price:  106.21211971698472
curr_Factors:  [106.21211972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.55000631]
Stock Price:  106.16806260510597
PL:  [-2.61805629]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.72789957e-04]
 [ 2.06215979e-03]
 [ 6.37569813e-05]
 [ 8.50289120e-03]
 [ 5.15238132e-03]
 [ 2.61909327e-02]
 [ 8.59446526e-04]
 [-1.79721035e-02]
 [ 1.13104654e-02]
 [ 2.28009410e-02]
 [-4.94392085e-03]
 [ 2.04860100e-02]
 [-1.40952339e-02]
 [ 8.17735926e-03]
 [-6.95283034e-03]
 [ 9.28917647e-03]
 [ 7.37035234e-03]
 [-1.18208077e-02]
 [-3.37856435e-04]
 [ 9.48793219e-03]
 [ 1.24022119e-02]
 [-4.53823598e-03]
 [ 6.84878271e-03]
 [-1.68537181e-03]
 [ 3.53472425e-03]
 [ 7.39475051e-03]
 [-5.03885598e-03]
 [ 1.42968395e-02]
 [ 4.95070948e-02]
 [ 4.72211518e-03]
 [ 1.89923934e-02]
 [-1.90855576e-03]
 [-3.06186188e-03]
 [ 7.50810969e-03]
 [ 9.51513619e-03]
 [ 3.79761334e-03]
 [-3.18908945e-02]
 [ 8.51391049e-03]
 [ 1.99705887e-02]
 [-5.84329186e-03]
 [-5.65281131e-03]
 [-1.34320728e-02]
 [ 1.99713056e-02]
 [-6.74188488e-03]
 [ 2.25287525e-02]
 [-9.33759740e-03]
 [ 1.53471030e-02]
 [ 1.69220089e-02]
 [ 8.97093993e-03]
 [-7.67306543e-03]
 [ 1.97944958e-02]
 [ 3.58268059e-03]
 [-9.42669151e-03]
 [ 5.87551225e-03]
 [-1.15162921e-02]
 [ 8.52827125e-03]
 [ 1.07763185e-02]
 [ 2.93046672e-04]
 [ 1.81300731e-03]
 [ 1.33211370e-02]
 [ 8.18033218e-03]
 [ 2.60467443e-02]
 [ 3.67688212e-03]
 [-1.25002145e-02]
 [ 9.95787730e-03]
 [ 4.51908129e-03]
 [-5.33405761e-03]
 [ 1.50221551e-02]
 [-8.33517011e-03]
 [ 1.01971455e-02]
 [-1.27693660e-02]
 [ 1.25913344e-02]
 [ 1.57305120e-03]
 [ 2.09799559e-02]
 [-2.24877874e-02]
 [-1.01697533e-03]
 [-1.01409827e-02]
 [-3.35168005e-03]
 [ 3.06024254e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.89964948]
curr_Stock_Price:  100.25087102043109
curr_Factors:  [100.25087102]
mat_Sqrt:  [[0.15]]
grads:  [0.00315193]
Stock Position:  0.0031519330483445115
Bond Position:  [5.58366544]


portfolio before change:  [5.89905614]
curr_Stock_Price:  99.95190136495916
curr_Factors:  [99.95190136]
mat_Sqrt:  [[0.15]]
grads:  [0.01374773]
Stock Position:  0.013747731933880734
Bond Position:  [4.52494419]


portfolio before change:  [5.90186297]
curr_Stock_Price:  100.13549646843055
curr_Factors:  [100.13549647]
mat_Sqrt:  [[0.15]]
grads:  [0.00042505]
Stock Position:  0.0004250465420813319
Bond Position:  [5.85930072]


portfolio before change:  [5.9019547]
curr_Stock_Price:  99.48970640666859
curr_Factors:  [99.48970641]
mat_Sqrt:  [[0.15]]
grads:  [0.05668594]
Stock Position:  0.05668594131275411
Bond Position:  [0.26228704]


portfolio before change:  [5.91098217]
curr_Stock_Price:  99.64867133353867
curr_Factors:  [99.64867133]
mat_Sqrt:  [[0.15]]
grads:  [0.03434921]
Stock Position:  0.03434920879277993
Bond Position:  [2.48812915]


portfolio before change:  [5.93385019]
curr_Stock_Price:  100.30989498096423
curr_Factors:  [100.30989498]
mat_Sqrt:  [[0.15]]
grads:  [0.17460622]
Stock Position:  0.17460621798025583
Bond Position:  [-11.5808812]


portfolio before change:  [5.85339995]
curr_Stock_Price:  99.85328806524748
curr_Factors:  [99.85328807]
mat_Sqrt:  [[0.15]]
grads:  [0.00572964]
Stock Position:  0.005729643507190275
Bond Position:  [5.28127621]


portfolio before change:  [5.85391617]
curr_Stock_Price:  99.88577286158083
curr_Factors:  [99.88577286]
mat_Sqrt:  [[0.15]]
grads:  [-0.11981402]
Stock Position:  -0.11981402333676643
Bond Position:  [17.82163249]


portfolio before change:  [5.90758553]
curr_Stock_Price:  99.4471308110069
curr_Factors:  [99.44713081]
mat_Sqrt:  [[0.15]]
grads:  [0.0754031]
Stock Position:  0.07540310299108245
Bond Position:  [-1.59103672]


portfolio before change:  [5.84532238]
curr_Stock_Price:  98.62271242467723
curr_Factors:  [98.62271242]
mat_Sqrt:  [[0.15]]
grads:  [0.15200627]
Stock Position:  0.1520062735824812
Bond Position:  [-9.14594863]


portfolio before change:  [5.82451507]
curr_Stock_Price:  98.48958848403606
curr_Factors:  [98.48958848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03295947]
Stock Position:  -0.03295947230603835
Bond Position:  [9.07067993]


portfolio before change:  [5.81375266]
curr_Stock_Price:  98.8333238407273
curr_Factors:  [98.83332384]
mat_Sqrt:  [[0.15]]
grads:  [0.1365734]
Stock Position:  0.13657340014051533
Bond Position:  [-7.68425042]


portfolio before change:  [5.80010889]
curr_Stock_Price:  98.73693979551119
curr_Factors:  [98.7369398]
mat_Sqrt:  [[0.15]]
grads:  [-0.09396823]
Stock Position:  -0.09396822604611957
Bond Position:  [15.07824397]


portfolio before change:  [5.78732426]
curr_Stock_Price:  98.88302162957308
curr_Factors:  [98.88302163]
mat_Sqrt:  [[0.15]]
grads:  [0.05451573]
Stock Position:  0.054515728379463405
Bond Position:  [0.39664431]


portfolio before change:  [5.78917922]
curr_Stock_Price:  98.91659306714458
curr_Factors:  [98.91659307]
mat_Sqrt:  [[0.15]]
grads:  [-0.0463522]
Stock Position:  -0.046352202282056124
Bond Position:  [10.37418115]


portfolio before change:  [5.76607066]
curr_Stock_Price:  99.42912451733417
curr_Factors:  [99.42912452]
mat_Sqrt:  [[0.15]]
grads:  [0.06192784]
Stock Position:  0.06192784314645372
Bond Position:  [-0.39136056]


portfolio before change:  [5.78322582]
curr_Stock_Price:  99.70653804959224
curr_Factors:  [99.70653805]
mat_Sqrt:  [[0.15]]
grads:  [0.04913568]
Stock Position:  0.04913568229004922
Bond Position:  [0.88407705]


portfolio before change:  [5.77267278]
curr_Stock_Price:  99.49063992542216
curr_Factors:  [99.49063993]
mat_Sqrt:  [[0.15]]
grads:  [-0.07880538]
Stock Position:  -0.07880538447157487
Bond Position:  [13.61307091]


portfolio before change:  [5.69516481]
curr_Stock_Price:  100.48497312970329
curr_Factors:  [100.48497313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00225238]
Stock Position:  -0.002252376231837618
Bond Position:  [5.92149478]


portfolio before change:  [5.69589617]
curr_Stock_Price:  100.32458511006035
curr_Factors:  [100.32458511]
mat_Sqrt:  [[0.15]]
grads:  [0.06325288]
Stock Position:  0.06325288129159927
Bond Position:  [-0.6499229]


portfolio before change:  [5.74531252]
curr_Stock_Price:  101.10647785677939
curr_Factors:  [101.10647786]
mat_Sqrt:  [[0.15]]
grads:  [0.08268141]
Stock Position:  0.08268141270431546
Bond Position:  [-2.6143139]


portfolio before change:  [5.74969759]
curr_Stock_Price:  101.16148991984468
curr_Factors:  [101.16148992]
mat_Sqrt:  [[0.15]]
grads:  [-0.03025491]
Stock Position:  -0.030254906551889997
Bond Position:  [8.81032902]


portfolio before change:  [5.7651007]
curr_Stock_Price:  100.67057979620698
curr_Factors:  [100.6705798]
mat_Sqrt:  [[0.15]]
grads:  [0.04565855]
Stock Position:  0.04565855137177446
Bond Position:  [1.16862786]


portfolio before change:  [5.82871393]
curr_Stock_Price:  102.06221822717775
curr_Factors:  [102.06221823]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123581]
Stock Position:  -0.011235812070705259
Bond Position:  [6.97546584]


portfolio before change:  [5.82599245]
curr_Stock_Price:  102.34323592726439
curr_Factors:  [102.34323593]
mat_Sqrt:  [[0.15]]
grads:  [0.02356483]
Stock Position:  0.023564828366516716
Bond Position:  [3.41429166]


portfolio before change:  [5.83828956]
curr_Stock_Price:  102.85602159803132
curr_Factors:  [102.8560216]
mat_Sqrt:  [[0.15]]
grads:  [0.04929834]
Stock Position:  0.04929833672225858
Bond Position:  [0.76765877]


portfolio before change:  [5.86407027]
curr_Stock_Price:  103.37800136436924
curr_Factors:  [103.37800136]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359237]
Stock Position:  -0.03359237319767486
Bond Position:  [9.33678268]


portfolio before change:  [5.85931032]
curr_Stock_Price:  103.53707087067025
curr_Factors:  [103.53707087]
mat_Sqrt:  [[0.15]]
grads:  [0.09531226]
Stock Position:  0.09531226345614859
Bond Position:  [-4.00904226]


portfolio before change:  [5.86669282]
curr_Stock_Price:  103.61715577132851
curr_Factors:  [103.61715577]
mat_Sqrt:  [[0.15]]
grads:  [0.3300473]
Stock Position:  0.33004729843976605
Bond Position:  [-28.33186952]


portfolio before change:  [5.89728049]
curr_Stock_Price:  103.71519768135099
curr_Factors:  [103.71519768]
mat_Sqrt:  [[0.15]]
grads:  [0.03148077]
Stock Position:  0.03148076784502924
Bond Position:  [2.63224643]


portfolio before change:  [5.9039982]
curr_Stock_Price:  103.9233626124682
curr_Factors:  [103.92336261]
mat_Sqrt:  [[0.15]]
grads:  [0.12661596]
Stock Position:  0.12661595625303693
Bond Position:  [-7.25435773]


portfolio before change:  [5.87728359]
curr_Stock_Price:  103.71595432357319
curr_Factors:  [103.71595432]
mat_Sqrt:  [[0.15]]
grads:  [-0.01272371]
Stock Position:  -0.012723705089862711
Bond Position:  [7.19693481]


portfolio before change:  [5.86411049]
curr_Stock_Price:  104.78662682577458
curr_Factors:  [104.78662683]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041241]
Stock Position:  -0.020412412505319572
Bond Position:  [8.00305834]


portfolio before change:  [5.86022294]
curr_Stock_Price:  105.00158233200942
curr_Factors:  [105.00158233]
mat_Sqrt:  [[0.15]]
grads:  [0.05005406]
Stock Position:  0.050054064578318375
Bond Position:  [0.60446696]


portfolio before change:  [5.88835374]
curr_Stock_Price:  105.56283587024264
curr_Factors:  [105.56283587]
mat_Sqrt:  [[0.15]]
grads:  [0.06343424]
Stock Position:  0.06343424125896935
Bond Position:  [-0.80794466]


portfolio before change:  [5.91177094]
curr_Stock_Price:  105.93278907565717
curr_Factors:  [105.93278908]
mat_Sqrt:  [[0.15]]
grads:  [0.02531742]
Stock Position:  0.025317422256594207
Bond Position:  [3.22982579]


portfolio before change:  [5.8957654]
curr_Stock_Price:  105.29262072306666
curr_Factors:  [105.29262072]
mat_Sqrt:  [[0.15]]
grads:  [-0.21260596]
Stock Position:  -0.21260596311444152
Bond Position:  [28.28160444]


portfolio before change:  [5.79942203]
curr_Stock_Price:  105.75408954671737
curr_Factors:  [105.75408955]
mat_Sqrt:  [[0.15]]
grads:  [0.0567594]
Stock Position:  0.05675940327236853
Bond Position:  [-0.20311698]


portfolio before change:  [5.81726347]
curr_Stock_Price:  106.06864766613106
curr_Factors:  [106.06864767]
mat_Sqrt:  [[0.15]]
grads:  [0.13313726]
Stock Position:  0.13313725813668684
Bond Position:  [-8.30442546]


portfolio before change:  [5.73169173]
curr_Stock_Price:  105.42981299555673
curr_Factors:  [105.429813]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895528]
Stock Position:  -0.03895527903431004
Bond Position:  [9.83873951]


portfolio before change:  [5.73517444]
curr_Stock_Price:  105.35619594067732
curr_Factors:  [105.35619594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03768541]
Stock Position:  -0.03768540870298171
Bond Position:  [9.70556575]


portfolio before change:  [5.72789236]
curr_Stock_Price:  105.56552619706753
curr_Factors:  [105.5655262]
mat_Sqrt:  [[0.15]]
grads:  [-0.08954715]
Stock Position:  -0.08954715212422491
Bond Position:  [15.1809846]


portfolio before change:  [5.70121729]
curr_Stock_Price:  105.87401070137996
curr_Factors:  [105.8740107]
mat_Sqrt:  [[0.15]]
grads:  [0.13314204]
Stock Position:  0.13314203740305056
Bond Position:  [-8.3950642]


portfolio before change:  [5.74965405]
curr_Stock_Price:  106.24174928723713
curr_Factors:  [106.24174929]
mat_Sqrt:  [[0.15]]
grads:  [-0.0449459]
Stock Position:  -0.044945899191116426
Bond Position:  [10.524785]


portfolio before change:  [5.73578833]
curr_Stock_Price:  106.56488322328386
curr_Factors:  [106.56488322]
mat_Sqrt:  [[0.15]]
grads:  [0.15019168]
Stock Position:  0.15019168325858395
Bond Position:  [-10.26937086]


portfolio before change:  [5.67513529]
curr_Stock_Price:  106.16531926902641
curr_Factors:  [106.16531927]
mat_Sqrt:  [[0.15]]
grads:  [-0.06225065]
Stock Position:  -0.06225064934156275
Bond Position:  [12.28399535]


portfolio before change:  [5.70500352]
curr_Stock_Price:  105.69784682643348
curr_Factors:  [105.69784683]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-5.10936806]


portfolio before change:  [5.63695546]
curr_Stock_Price:  105.03587769973498
curr_Factors:  [105.0358777]
mat_Sqrt:  [[0.15]]
grads:  [0.11281339]
Stock Position:  0.11281339251238628
Bond Position:  [-6.21249824]


portfolio before change:  [5.72743423]
curr_Stock_Price:  105.84134120133511
curr_Factors:  [105.8413412]
mat_Sqrt:  [[0.15]]
grads:  [0.05980627]
Stock Position:  0.05980626619172112
Bond Position:  [-0.60254119]


portfolio before change:  [5.74608049]
curr_Stock_Price:  106.15374857949384
curr_Factors:  [106.15374858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05115377]
Stock Position:  -0.05115376950279822
Bond Position:  [11.17624488]


portfolio before change:  [5.76340643]
curr_Stock_Price:  105.8287010919127
curr_Factors:  [105.82870109]
mat_Sqrt:  [[0.15]]
grads:  [0.13196331]
Stock Position:  0.13196330549554078
Bond Position:  [-8.20209878]


portfolio before change:  [5.65035004]
curr_Stock_Price:  104.9758599090129
curr_Factors:  [104.97585991]
mat_Sqrt:  [[0.15]]
grads:  [0.02388454]
Stock Position:  0.023884537292471177
Bond Position:  [3.1430502]


portfolio before change:  [5.64179856]
curr_Stock_Price:  104.60960089830793
curr_Factors:  [104.6096009]
mat_Sqrt:  [[0.15]]
grads:  [-0.06284461]
Stock Position:  -0.06284461007138055
Bond Position:  [12.21594814]


portfolio before change:  [5.67294687]
curr_Stock_Price:  104.12611011498569
curr_Factors:  [104.12611011]
mat_Sqrt:  [[0.15]]
grads:  [0.03917008]
Stock Position:  0.03917008164260102
Bond Position:  [1.59431864]


portfolio before change:  [5.68312065]
curr_Stock_Price:  104.38329942017997
curr_Factors:  [104.38329942]
mat_Sqrt:  [[0.15]]
grads:  [-0.07677528]
Stock Position:  -0.07677528061767737
Bond Position:  [13.69717775]


portfolio before change:  [5.75709181]
curr_Stock_Price:  103.43097384623599
curr_Factors:  [103.43097385]
mat_Sqrt:  [[0.15]]
grads:  [0.05685514]
Stock Position:  0.05685514164768208
Bond Position:  [-0.12349086]


portfolio before change:  [5.80989267]
curr_Stock_Price:  104.35980050509039
curr_Factors:  [104.35980051]
mat_Sqrt:  [[0.15]]
grads:  [0.07184212]
Stock Position:  0.07184212308621214
Bond Position:  [-1.68753697]


portfolio before change:  [5.77308171]
curr_Stock_Price:  103.84888178558465
curr_Factors:  [103.84888179]
mat_Sqrt:  [[0.15]]
grads:  [0.00195364]
Stock Position:  0.0019536444822845864
Bond Position:  [5.57019791]


portfolio before change:  [5.77488308]
curr_Stock_Price:  104.59273591212596
curr_Factors:  [104.59273591]
mat_Sqrt:  [[0.15]]
grads:  [0.01208672]
Stock Position:  0.012086715410682548
Bond Position:  [4.51070045]


portfolio before change:  [5.76832576]
curr_Stock_Price:  104.02688764363965
curr_Factors:  [104.02688764]
mat_Sqrt:  [[0.15]]
grads:  [0.08880758]
Stock Position:  0.08880758014913044
Bond Position:  [-3.4700504]


portfolio before change:  [5.79527987]
curr_Stock_Price:  104.3328412298111
curr_Factors:  [104.33284123]
mat_Sqrt:  [[0.15]]
grads:  [0.05453555]
Stock Position:  0.0545355478496285
Bond Position:  [0.10543122]


portfolio before change:  [5.79634744]
curr_Stock_Price:  104.35229598080994
curr_Factors:  [104.35229598]
mat_Sqrt:  [[0.15]]
grads:  [0.17364496]
Stock Position:  0.17364496199919252
Bond Position:  [-12.32390303]


portfolio before change:  [5.73968116]
curr_Stock_Price:  104.0303977027459
curr_Factors:  [104.0303977]
mat_Sqrt:  [[0.15]]
grads:  [0.02451255]
Stock Position:  0.024512547450258222
Bond Position:  [3.1896311]


portfolio before change:  [5.74055687]
curr_Stock_Price:  104.05798998916073
curr_Factors:  [104.05798999]
mat_Sqrt:  [[0.15]]
grads:  [-0.08333476]
Stock Position:  -0.08333476353665283
Bond Position:  [14.41220486]


portfolio before change:  [5.72785621]
curr_Stock_Price:  104.2212046467101
curr_Factors:  [104.22120465]
mat_Sqrt:  [[0.15]]
grads:  [0.06638585]
Stock Position:  0.06638584865169317
Bond Position:  [-1.19095691]


portfolio before change:  [5.75459875]
curr_Stock_Price:  104.62516091070668
curr_Factors:  [104.62516091]
mat_Sqrt:  [[0.15]]
grads:  [0.03012721]
Stock Position:  0.030127208606488244
Bond Position:  [2.6025347]


portfolio before change:  [5.74777153]
curr_Stock_Price:  104.39314868562963
curr_Factors:  [104.39314869]
mat_Sqrt:  [[0.15]]
grads:  [-0.03556038]
Stock Position:  -0.03556038407262967
Bond Position:  [9.46003199]


portfolio before change:  [5.78769418]
curr_Stock_Price:  103.28710395898662
curr_Factors:  [103.28710396]
mat_Sqrt:  [[0.15]]
grads:  [0.1001477]
Stock Position:  0.10014770059248974
Bond Position:  [-4.55627178]


portfolio before change:  [5.78680082]
curr_Stock_Price:  103.28102708531401
curr_Factors:  [103.28102709]
mat_Sqrt:  [[0.15]]
grads:  [-0.0555678]
Stock Position:  -0.0555678007138141
Bond Position:  [11.52590035]


portfolio before change:  [5.81699024]
curr_Stock_Price:  102.75070144330769
curr_Factors:  [102.75070144]
mat_Sqrt:  [[0.15]]
grads:  [0.06798097]
Stock Position:  0.06798096976014878
Bond Position:  [-1.16810209]


portfolio before change:  [5.84509336]
curr_Stock_Price:  103.16517228187664
curr_Factors:  [103.16517228]
mat_Sqrt:  [[0.15]]
grads:  [-0.08512911]
Stock Position:  -0.0851291065072756
Bond Position:  [14.6274523]


portfolio before change:  [5.87522385]
curr_Stock_Price:  102.82197308048916
curr_Factors:  [102.82197308]
mat_Sqrt:  [[0.15]]
grads:  [0.08394223]
Stock Position:  0.08394222957912278
Bond Position:  [-2.75588183]


portfolio before change:  [5.88317021]
curr_Stock_Price:  102.91868971746145
curr_Factors:  [102.91868972]
mat_Sqrt:  [[0.15]]
grads:  [0.01048701]
Stock Position:  0.010487007978161362
Bond Position:  [4.80386109]


portfolio before change:  [5.87928138]
curr_Stock_Price:  102.51923549529158
curr_Factors:  [102.5192355]
mat_Sqrt:  [[0.15]]
grads:  [0.13986637]
Stock Position:  0.13986637279106304
Bond Position:  [-8.45971223]


portfolio before change:  [5.95069504]
curr_Stock_Price:  103.03360081265919
curr_Factors:  [103.03360081]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991858]
Stock Position:  -0.14991858299723596
Bond Position:  [21.39734648]


portfolio before change:  [5.97130027]
curr_Stock_Price:  102.90507872506042
curr_Factors:  [102.90507873]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677984]
Stock Position:  -0.006779835557360724
Bond Position:  [6.66897978]


portfolio before change:  [5.97512043]
curr_Stock_Price:  102.4030985043042
curr_Factors:  [102.4030985]
mat_Sqrt:  [[0.15]]
grads:  [-0.06760655]
Stock Position:  -0.06760655160357054
Bond Position:  [12.8982408]


portfolio before change:  [5.95645416]
curr_Stock_Price:  102.69112443177477
curr_Factors:  [102.69112443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02234453]
Stock Position:  -0.02234453364586818
Bond Position:  [8.25103944]


portfolio before change:  [5.95407002]
curr_Stock_Price:  102.82090317666614
curr_Factors:  [102.82090318]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.95407002]
Stock Price:  103.23440255773751
PL:  [2.71966746]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.29587758e-03]
 [ 2.31590335e-03]
 [-4.30470005e-03]
 [-2.01274782e-03]
 [ 1.77077591e-02]
 [ 2.68079943e-02]
 [ 3.77137802e-03]
 [ 9.74703435e-03]
 [ 2.45958254e-02]
 [-4.81142214e-03]
 [ 4.66731508e-02]
 [ 9.88656131e-03]
 [ 1.04438369e-01]
 [ 1.76739899e-02]
 [-6.89656449e-03]
 [ 2.79848889e-02]
 [ 1.10824017e-02]
 [-9.77772881e-03]
 [-4.29586167e-04]
 [-1.40381235e-04]
 [ 1.27501917e-02]
 [-6.13086060e-03]
 [ 6.87464003e-03]
 [ 4.10591410e-02]
 [-7.80588369e-03]
 [-2.57537790e-03]
 [-6.77299850e-03]
 [ 6.78387608e-03]
 [-1.24710985e-02]
 [-6.19417542e-04]
 [ 2.96044700e-03]
 [-1.12693931e-02]
 [ 1.69921362e-03]
 [ 5.57657960e-03]
 [ 1.14982220e-02]
 [ 9.33008863e-03]
 [-3.47831535e-02]
 [ 9.73024735e-03]
 [-4.32795609e-03]
 [ 2.44534545e-02]
 [-6.43556065e-03]
 [-4.02931247e-03]
 [ 2.32216380e-02]
 [ 4.22401846e-03]
 [-6.93152928e-03]
 [-4.39943002e-03]
 [ 4.98099322e-04]
 [-1.23872111e-02]
 [-1.20606857e-02]
 [-6.21559845e-03]
 [ 4.74561699e-02]
 [-1.04641026e-02]
 [ 3.54341949e-03]
 [ 5.27545329e-03]
 [ 5.42928974e-03]
 [-2.58947311e-03]
 [ 7.71423110e-03]
 [-6.84615439e-04]
 [ 1.54646649e-03]
 [-2.06250671e-02]
 [-4.91008972e-03]
 [ 8.79564595e-03]
 [ 1.32590089e-02]
 [-1.81226552e-02]
 [-9.43960339e-03]
 [-4.31931308e-03]
 [-4.79563623e-03]
 [ 1.77137137e-02]
 [-9.82316956e-03]
 [ 6.17441389e-03]
 [-6.56983088e-03]
 [ 1.08516565e-02]
 [-4.31304512e-03]
 [ 6.49719172e-03]
 [-9.42339116e-03]
 [-1.06509095e-02]
 [ 1.90473556e-03]
 [ 2.30518677e-03]
 [-1.02369665e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.63706426]
curr_Stock_Price:  99.69577156019827
curr_Factors:  [99.69577156]
mat_Sqrt:  [[0.15]]
grads:  [0.02197252]
Stock Position:  0.021972517231139164
Bond Position:  [-4.82763132]


portfolio before change:  [-2.61881344]
curr_Stock_Price:  100.54012460213819
curr_Factors:  [100.5401246]
mat_Sqrt:  [[0.15]]
grads:  [0.01543936]
Stock Position:  0.015439355649677033
Bond Position:  [-4.17108818]


portfolio before change:  [-2.6035814]
curr_Stock_Price:  101.54358223642437
curr_Factors:  [101.54358224]
mat_Sqrt:  [[0.15]]
grads:  [-0.028698]
Stock Position:  -0.028698000360190545
Bond Position:  [0.31051636]


portfolio before change:  [-2.62349205]
curr_Stock_Price:  102.23805754066754
curr_Factors:  [102.23805754]
mat_Sqrt:  [[0.15]]
grads:  [-0.01341832]
Stock Position:  -0.01341831876762707
Bond Position:  [-1.2516292]


portfolio before change:  [-2.61146962]
curr_Stock_Price:  101.33625654695705
curr_Factors:  [101.33625655]
mat_Sqrt:  [[0.15]]
grads:  [0.11805173]
Stock Position:  0.11805172703044205
Bond Position:  [-14.57438972]


portfolio before change:  [-2.50538248]
curr_Stock_Price:  102.24262255820092
curr_Factors:  [102.24262256]
mat_Sqrt:  [[0.15]]
grads:  [0.17871996]
Stock Position:  0.17871996177230076
Bond Position:  [-20.77818007]


portfolio before change:  [-2.5062703]
curr_Stock_Price:  102.24492145191864
curr_Factors:  [102.24492145]
mat_Sqrt:  [[0.15]]
grads:  [0.02514252]
Stock Position:  0.025142520135642773
Bond Position:  [-5.07696529]


portfolio before change:  [-2.51607783]
curr_Stock_Price:  101.86746471435147
curr_Factors:  [101.86746471]
mat_Sqrt:  [[0.15]]
grads:  [0.06498023]
Stock Position:  0.064980228967977
Bond Position:  [-9.13544901]


portfolio before change:  [-2.49334492]
curr_Stock_Price:  102.2260952486648
curr_Factors:  [102.22609525]
mat_Sqrt:  [[0.15]]
grads:  [0.16397217]
Stock Position:  0.16397216908496584
Bond Position:  [-19.25557949]


portfolio before change:  [-2.51026901]
curr_Stock_Price:  102.13022179618879
curr_Factors:  [102.1302218]
mat_Sqrt:  [[0.15]]
grads:  [-0.03207615]
Stock Position:  -0.032076147592353235
Bond Position:  [0.76567506]


portfolio before change:  [-2.53578129]
curr_Stock_Price:  102.92707998847808
curr_Factors:  [102.92707999]
mat_Sqrt:  [[0.15]]
grads:  [0.31115434]
Stock Position:  0.3111543387710289
Bond Position:  [-34.56198881]


portfolio before change:  [-2.6238273]
curr_Stock_Price:  102.65105677692848
curr_Factors:  [102.65105678]
mat_Sqrt:  [[0.15]]
grads:  [0.06591041]
Stock Position:  0.06591040874823959
Bond Position:  [-9.38960042]


portfolio before change:  [-2.59921166]
curr_Stock_Price:  103.03343214258929
curr_Factors:  [103.03343214]
mat_Sqrt:  [[0.15]]
grads:  [0.69625579]
Stock Position:  0.6962557926618419
Bond Position:  [-74.33683562]


portfolio before change:  [-2.22595001]
curr_Stock_Price:  103.57620369668028
curr_Factors:  [103.5762037]
mat_Sqrt:  [[0.15]]
grads:  [0.1178266]
Stock Position:  0.11782659927936506
Bond Position:  [-14.42998186]


portfolio before change:  [-2.31098095]
curr_Stock_Price:  102.86219656998895
curr_Factors:  [102.86219657]
mat_Sqrt:  [[0.15]]
grads:  [-0.0459771]
Stock Position:  -0.04597709657021475
Bond Position:  [2.4183242]


portfolio before change:  [-2.30462232]
curr_Stock_Price:  102.7271841728203
curr_Factors:  [102.72718417]
mat_Sqrt:  [[0.15]]
grads:  [0.18656593]
Stock Position:  0.18656592626693513
Bond Position:  [-21.47001459]


portfolio before change:  [-2.38533271]
curr_Stock_Price:  102.30176634767952
curr_Factors:  [102.30176635]
mat_Sqrt:  [[0.15]]
grads:  [0.07388268]
Stock Position:  0.07388267796437695
Bond Position:  [-9.94366117]


portfolio before change:  [-2.39592955]
curr_Stock_Price:  102.16675035908825
curr_Factors:  [102.16675036]
mat_Sqrt:  [[0.15]]
grads:  [-0.06518486]
Stock Position:  -0.06518485875770282
Bond Position:  [4.26379564]


portfolio before change:  [-2.33042136]
curr_Stock_Price:  101.1658784450938
curr_Factors:  [101.16587845]
mat_Sqrt:  [[0.15]]
grads:  [-0.00286391]
Stock Position:  -0.0028639077774234487
Bond Position:  [-2.04069161]


portfolio before change:  [-2.33010952]
curr_Stock_Price:  101.01245616853349
curr_Factors:  [101.01245617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093587]
Stock Position:  -0.0009358749028139391
Bond Position:  [-2.2355745]


portfolio before change:  [-2.3305225]
curr_Stock_Price:  101.30443472462801
curr_Factors:  [101.30443472]
mat_Sqrt:  [[0.15]]
grads:  [0.08500128]
Stock Position:  0.08500127821110325
Bond Position:  [-10.94152894]


portfolio before change:  [-2.37896225]
curr_Stock_Price:  100.74260934441577
curr_Factors:  [100.74260934]
mat_Sqrt:  [[0.15]]
grads:  [-0.0408724]
Stock Position:  -0.040872404019383995
Bond Position:  [1.73863039]


portfolio before change:  [-2.38158642]
curr_Stock_Price:  100.80947207037391
curr_Factors:  [100.80947207]
mat_Sqrt:  [[0.15]]
grads:  [0.04583093]
Stock Position:  0.04583093355992185
Bond Position:  [-7.00177863]


portfolio before change:  [-2.42816364]
curr_Stock_Price:  99.8027372219352
curr_Factors:  [99.80273722]
mat_Sqrt:  [[0.15]]
grads:  [0.27372761]
Stock Position:  0.273727606749076
Bond Position:  [-29.74692805]


portfolio before change:  [-2.5852053]
curr_Stock_Price:  99.23581445249201
curr_Factors:  [99.23581445]
mat_Sqrt:  [[0.15]]
grads:  [-0.05203922]
Stock Position:  -0.05203922462425403
Bond Position:  [2.57894954]


portfolio before change:  [-2.5762308]
curr_Stock_Price:  99.06645554314653
curr_Factors:  [99.06645554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716919]
Stock Position:  -0.01716918597390392
Bond Position:  [-0.8753404]


portfolio before change:  [-2.58247802]
curr_Stock_Price:  99.42713164649962
curr_Factors:  [99.42713165]
mat_Sqrt:  [[0.15]]
grads:  [-0.04515332]
Stock Position:  -0.045153323355181435
Bond Position:  [1.9069874]


portfolio before change:  [-2.54775971]
curr_Stock_Price:  98.66087302794475
curr_Factors:  [98.66087303]
mat_Sqrt:  [[0.15]]
grads:  [0.04522584]
Stock Position:  0.04522584052640891
Bond Position:  [-7.00978062]


portfolio before change:  [-2.53098495]
curr_Stock_Price:  99.04147154712135
curr_Factors:  [99.04147155]
mat_Sqrt:  [[0.15]]
grads:  [-0.08314066]
Stock Position:  -0.08314065663512979
Bond Position:  [5.70338803]


portfolio before change:  [-2.49651063]
curr_Stock_Price:  98.63110864159265
curr_Factors:  [98.63110864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412945]
Stock Position:  -0.004129450277435081
Bond Position:  [-2.08921838]


portfolio before change:  [-2.50235314]
curr_Stock_Price:  100.01432540035142
curr_Factors:  [100.0143254]
mat_Sqrt:  [[0.15]]
grads:  [0.01973631]
Stock Position:  0.01973631330303149
Bond Position:  [-4.4762672]


portfolio before change:  [-2.50450182]
curr_Stock_Price:  99.91963164825432
curr_Factors:  [99.91963165]
mat_Sqrt:  [[0.15]]
grads:  [-0.07512929]
Stock Position:  -0.0751292870707993
Bond Position:  [5.00238887]


portfolio before change:  [-2.50505572]
curr_Stock_Price:  99.93116594087982
curr_Factors:  [99.93116594]
mat_Sqrt:  [[0.15]]
grads:  [0.01132809]
Stock Position:  0.011328090771708568
Bond Position:  [-3.63708504]


portfolio before change:  [-2.50284316]
curr_Stock_Price:  100.1465496576361
curr_Factors:  [100.14654966]
mat_Sqrt:  [[0.15]]
grads:  [0.0371772]
Stock Position:  0.03717719734118398
Bond Position:  [-6.2260112]


portfolio before change:  [-2.47390926]
curr_Stock_Price:  100.93528703570614
curr_Factors:  [100.93528704]
mat_Sqrt:  [[0.15]]
grads:  [0.07665481]
Stock Position:  0.07665481354844433
Bond Position:  [-10.21108486]


portfolio before change:  [-2.47642667]
curr_Stock_Price:  100.9107719232912
curr_Factors:  [100.91077192]
mat_Sqrt:  [[0.15]]
grads:  [0.06220059]
Stock Position:  0.06220059089406388
Bond Position:  [-8.75313631]


portfolio before change:  [-2.53931998]
curr_Stock_Price:  99.90843065260411
curr_Factors:  [99.90843065]
mat_Sqrt:  [[0.15]]
grads:  [-0.23188769]
Stock Position:  -0.2318876900222713
Bond Position:  [20.62821522]


portfolio before change:  [-2.62282357]
curr_Stock_Price:  100.27409430909847
curr_Factors:  [100.27409431]
mat_Sqrt:  [[0.15]]
grads:  [0.06486832]
Stock Position:  0.06486831567040127
Bond Position:  [-9.12743518]


portfolio before change:  [-2.61440215]
curr_Stock_Price:  100.41271216814391
curr_Factors:  [100.41271217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02885304]
Stock Position:  -0.028853040580556384
Bond Position:  [0.28280991]


portfolio before change:  [-2.60317915]
curr_Stock_Price:  100.02435367851787
curr_Factors:  [100.02435368]
mat_Sqrt:  [[0.15]]
grads:  [0.16302303]
Stock Position:  0.16302302980730485
Bond Position:  [-18.90945234]


portfolio before change:  [-2.62691321]
curr_Stock_Price:  99.88601625452038
curr_Factors:  [99.88601625]
mat_Sqrt:  [[0.15]]
grads:  [-0.04290374]
Stock Position:  -0.042903737699678104
Bond Position:  [1.65857023]


portfolio before change:  [-2.60825174]
curr_Stock_Price:  99.45347098293064
curr_Factors:  [99.45347098]
mat_Sqrt:  [[0.15]]
grads:  [-0.02686208]
Stock Position:  -0.026862083137424466
Bond Position:  [0.06327566]


portfolio before change:  [-2.60377131]
curr_Stock_Price:  99.28682420749327
curr_Factors:  [99.28682421]
mat_Sqrt:  [[0.15]]
grads:  [0.15481092]
Stock Position:  0.15481092018796921
Bond Position:  [-17.97445592]


portfolio before change:  [-2.60761909]
curr_Stock_Price:  99.26922634303098
curr_Factors:  [99.26922634]
mat_Sqrt:  [[0.15]]
grads:  [0.02816012]
Stock Position:  0.028160123098965532
Bond Position:  [-5.40305272]


portfolio before change:  [-2.62204139]
curr_Stock_Price:  98.76906507059007
curr_Factors:  [98.76906507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0462102]
Stock Position:  -0.046210195211214534
Bond Position:  [1.94209639]


portfolio before change:  [-2.60463232]
curr_Stock_Price:  98.39495532245616
curr_Factors:  [98.39495532]
mat_Sqrt:  [[0.15]]
grads:  [-0.02932953]
Stock Position:  -0.029329533456601047
Bond Position:  [0.28124581]


portfolio before change:  [-2.61193908]
curr_Stock_Price:  98.64468107206024
curr_Factors:  [98.64468107]
mat_Sqrt:  [[0.15]]
grads:  [0.00332066]
Stock Position:  0.0033206621499574005
Bond Position:  [-2.93950474]


portfolio before change:  [-2.61065193]
curr_Stock_Price:  99.08762850580408
curr_Factors:  [99.08762851]
mat_Sqrt:  [[0.15]]
grads:  [-0.08258141]
Stock Position:  -0.08258140729242536
Bond Position:  [5.57214388]


portfolio before change:  [-2.63069343]
curr_Stock_Price:  99.33453362992472
curr_Factors:  [99.33453363]
mat_Sqrt:  [[0.15]]
grads:  [-0.08040457]
Stock Position:  -0.08040457134673357
Bond Position:  [5.35625716]


portfolio before change:  [-2.65607462]
curr_Stock_Price:  99.65436573322496
curr_Factors:  [99.65436573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143732]
Stock Position:  -0.04143732302177042
Bond Position:  [1.47333552]


portfolio before change:  [-2.63186998]
curr_Stock_Price:  99.07246142324892
curr_Factors:  [99.07246142]
mat_Sqrt:  [[0.15]]
grads:  [0.31637447]
Stock Position:  0.3163744658527364
Bond Position:  [-33.97586704]


portfolio before change:  [-2.79053596]
curr_Stock_Price:  98.57766035204467
curr_Factors:  [98.57766035]
mat_Sqrt:  [[0.15]]
grads:  [-0.06976068]
Stock Position:  -0.06976068377563517
Bond Position:  [4.08630903]


portfolio before change:  [-2.79208382]
curr_Stock_Price:  98.6035096276565
curr_Factors:  [98.60350963]
mat_Sqrt:  [[0.15]]
grads:  [0.0236228]
Stock Position:  0.023622796570814543
Bond Position:  [-5.12137447]


portfolio before change:  [-2.79688752]
curr_Stock_Price:  98.41370956336497
curr_Factors:  [98.41370956]
mat_Sqrt:  [[0.15]]
grads:  [0.03516969]
Stock Position:  0.03516968860037585
Bond Position:  [-6.25806704]


portfolio before change:  [-2.79939665]
curr_Stock_Price:  98.3534877994731
curr_Factors:  [98.3534878]
mat_Sqrt:  [[0.15]]
grads:  [0.03619526]
Stock Position:  0.03619526491621418
Bond Position:  [-6.35932719]


portfolio before change:  [-2.80199278]
curr_Stock_Price:  98.29274334185982
curr_Factors:  [98.29274334]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726315]
Stock Position:  -0.017263154086870694
Bond Position:  [-1.10515]


portfolio before change:  [-2.80542774]
curr_Stock_Price:  98.48771836148995
curr_Factors:  [98.48771836]
mat_Sqrt:  [[0.15]]
grads:  [0.05142821]
Stock Position:  0.05142820732193363
Bond Position:  [-7.87047453]


portfolio before change:  [-2.8408379]
curr_Stock_Price:  97.80874764742975
curr_Factors:  [97.80874765]
mat_Sqrt:  [[0.15]]
grads:  [-0.0045641]
Stock Position:  -0.00456410292616035
Bond Position:  [-2.39442871]


portfolio before change:  [-2.83601924]
curr_Stock_Price:  96.72018357532501
curr_Factors:  [96.72018358]
mat_Sqrt:  [[0.15]]
grads:  [0.01030978]
Stock Position:  0.010309776598488904
Bond Position:  [-3.83318272]


portfolio before change:  [-2.83855287]
curr_Stock_Price:  96.49767204208044
curr_Factors:  [96.49767204]
mat_Sqrt:  [[0.15]]
grads:  [-0.13750045]
Stock Position:  -0.13750044736889191
Bond Position:  [10.42992021]


portfolio before change:  [-2.89472125]
curr_Stock_Price:  96.910909040479
curr_Factors:  [96.91090904]
mat_Sqrt:  [[0.15]]
grads:  [-0.03273393]
Stock Position:  -0.03273393147425793
Bond Position:  [0.27755381]


portfolio before change:  [-2.89040391]
curr_Stock_Price:  96.77954709158213
curr_Factors:  [96.77954709]
mat_Sqrt:  [[0.15]]
grads:  [0.05863764]
Stock Position:  0.058637639664838204
Bond Position:  [-8.56532812]


portfolio before change:  [-2.86636337]
curr_Stock_Price:  97.19866154584382
curr_Factors:  [97.19866155]
mat_Sqrt:  [[0.15]]
grads:  [0.08839339]
Stock Position:  0.08839339264515768
Bond Position:  [-11.45808283]


portfolio before change:  [-2.80697967]
curr_Stock_Price:  97.87857497467775
curr_Factors:  [97.87857497]
mat_Sqrt:  [[0.15]]
grads:  [-0.1208177]
Stock Position:  -0.12081770141948299
Bond Position:  [9.01848477]


portfolio before change:  [-2.78568517]
curr_Stock_Price:  97.70698725950447
curr_Factors:  [97.70698726]
mat_Sqrt:  [[0.15]]
grads:  [-0.06293069]
Stock Position:  -0.06293068928089877
Bond Position:  [3.36308289]


portfolio before change:  [-2.81561114]
curr_Stock_Price:  98.1858660801296
curr_Factors:  [98.18586608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02879542]
Stock Position:  -0.028795420506379163
Bond Position:  [0.01169216]


portfolio before change:  [-2.80831704]
curr_Stock_Price:  97.93258375612696
curr_Factors:  [97.93258376]
mat_Sqrt:  [[0.15]]
grads:  [-0.03197091]
Stock Position:  -0.03197090821550559
Bond Position:  [0.32267661]


portfolio before change:  [-2.79660467]
curr_Stock_Price:  97.56686986206343
curr_Factors:  [97.56686986]
mat_Sqrt:  [[0.15]]
grads:  [0.11809142]
Stock Position:  0.11809142494144963
Bond Position:  [-14.31841535]


portfolio before change:  [-2.72148686]
curr_Stock_Price:  98.2105468543609
curr_Factors:  [98.21054685]
mat_Sqrt:  [[0.15]]
grads:  [-0.0654878]
Stock Position:  -0.06548779708454222
Bond Position:  [3.7101055]


portfolio before change:  [-2.76373567]
curr_Stock_Price:  98.85922799577973
curr_Factors:  [98.859228]
mat_Sqrt:  [[0.15]]
grads:  [0.04116276]
Stock Position:  0.041162759238075525
Bond Position:  [-6.83305427]


portfolio before change:  [-2.77125005]
curr_Stock_Price:  98.68705055742134
curr_Factors:  [98.68705056]
mat_Sqrt:  [[0.15]]
grads:  [-0.04379887]
Stock Position:  -0.04379887252113381
Bond Position:  [1.5511315]


portfolio before change:  [-2.77674141]
curr_Stock_Price:  98.8146408239608
curr_Factors:  [98.81464082]
mat_Sqrt:  [[0.15]]
grads:  [0.07234438]
Stock Position:  0.07234437636207056
Bond Position:  [-9.92542498]


portfolio before change:  [-2.77718961]
curr_Stock_Price:  98.8170205687482
curr_Factors:  [98.81702057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02875363]
Stock Position:  -0.028753634105227837
Bond Position:  [0.06415885]


portfolio before change:  [-2.75113724]
curr_Stock_Price:  97.91110533133912
curr_Factors:  [97.91110533]
mat_Sqrt:  [[0.15]]
grads:  [0.04331461]
Stock Position:  0.043314611440934556
Bond Position:  [-6.99211873]


portfolio before change:  [-2.77601827]
curr_Stock_Price:  97.34676913440713
curr_Factors:  [97.34676913]
mat_Sqrt:  [[0.15]]
grads:  [-0.06282261]
Stock Position:  -0.06282260774645673
Bond Position:  [3.33955963]


portfolio before change:  [-2.76632441]
curr_Stock_Price:  97.19578641945861
curr_Factors:  [97.19578642]
mat_Sqrt:  [[0.15]]
grads:  [-0.07100606]
Stock Position:  -0.07100606341651271
Bond Position:  [4.13516577]


portfolio before change:  [-2.80655524]
curr_Stock_Price:  97.76600930954419
curr_Factors:  [97.76600931]
mat_Sqrt:  [[0.15]]
grads:  [0.01269824]
Stock Position:  0.012698237091200923
Bond Position:  [-4.0480112]


portfolio before change:  [-2.80329157]
curr_Stock_Price:  98.0429510299763
curr_Factors:  [98.04295103]
mat_Sqrt:  [[0.15]]
grads:  [0.01536791]
Stock Position:  0.01536791182190932
Bond Position:  [-4.310007]


portfolio before change:  [-2.80134329]
curr_Stock_Price:  98.18725618935586
curr_Factors:  [98.18725619]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.80134329]
Stock Price:  98.2113441390316
PL:  [-2.80134329]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.19646319e-03]
 [ 2.82652795e-03]
 [-1.64909996e-04]
 [ 5.27207783e-03]
 [ 1.69793392e-02]
 [ 2.72599419e-02]
 [ 3.48180930e-03]
 [ 4.95863600e-03]
 [ 2.38217038e-02]
 [-4.59256845e-03]
 [ 2.86221687e-02]
 [-4.33514291e-02]
 [ 5.28347639e-02]
 [ 1.02928370e-02]
 [-6.89626905e-03]
 [ 2.90124228e-02]
 [ 1.16407404e-02]
 [-9.53342056e-03]
 [ 4.38487933e-03]
 [ 4.29273364e-04]
 [ 1.19803866e-02]
 [-6.75799045e-03]
 [ 6.84100295e-03]
 [ 3.93588566e-02]
 [-1.63686423e-03]
 [ 1.43168300e-02]
 [-5.58104561e-03]
 [ 8.15497490e-03]
 [ 2.16147578e-02]
 [-1.44521652e-03]
 [ 1.38622446e-02]
 [-7.39445451e-03]
 [ 2.27722893e-03]
 [ 8.51302322e-03]
 [ 1.02765398e-02]
 [ 6.93480748e-03]
 [-3.30452759e-02]
 [ 9.05972532e-03]
 [ 5.90736975e-03]
 [ 2.01094884e-02]
 [-5.61790388e-03]
 [-1.48015546e-02]
 [ 2.32159533e-02]
 [ 3.11397611e-03]
 [-6.12890878e-03]
 [ 1.73967860e-03]
 [ 9.49090911e-03]
 [-1.22278789e-02]
 [-1.51252064e-02]
 [-7.56602764e-03]
 [ 1.90997785e-02]
 [-6.39562374e-03]
 [-1.11511972e-03]
 [ 5.34890577e-03]
 [ 4.08347003e-03]
 [-1.90398747e-03]
 [ 7.43468809e-03]
 [-5.99039555e-04]
 [ 1.57675015e-03]
 [ 5.93839531e-04]
 [ 9.00849938e-04]
 [-5.54131385e-03]
 [-5.84075401e-03]
 [-1.27656785e-02]
 [-4.05112380e-03]
 [ 8.53797634e-04]
 [-5.49661498e-03]
 [ 2.19061845e-02]
 [-8.52283790e-03]
 [ 6.56541504e-03]
 [-8.74428722e-03]
 [ 1.07671957e-02]
 [-2.87518297e-03]
 [ 9.11278857e-03]
 [-1.90883091e-02]
 [-4.26889311e-03]
 [-7.89402172e-04]
 [ 3.14803725e-03]
 [-9.50875593e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.14664153]
curr_Stock_Price:  99.94180687379468
curr_Factors:  [99.94180687]
mat_Sqrt:  [[0.15]]
grads:  [0.01464309]
Stock Position:  0.014643087915281667
Bond Position:  [-0.31681514]


portfolio before change:  [1.1484095]
curr_Stock_Price:  100.06389705752315
curr_Factors:  [100.06389706]
mat_Sqrt:  [[0.15]]
grads:  [0.01884352]
Stock Position:  0.018843519641738964
Bond Position:  [-0.73714651]


portfolio before change:  [1.14178983]
curr_Stock_Price:  99.71504512989529
curr_Factors:  [99.71504513]
mat_Sqrt:  [[0.15]]
grads:  [-0.0010994]
Stock Position:  -0.001099399971413497
Bond Position:  [1.25141655]


portfolio before change:  [1.14070337]
curr_Stock_Price:  100.7744183525531
curr_Factors:  [100.77441835]
mat_Sqrt:  [[0.15]]
grads:  [0.03514719]
Stock Position:  0.03514718552476512
Bond Position:  [-2.40123381]


portfolio before change:  [1.15893048]
curr_Stock_Price:  101.29728201387749
curr_Factors:  [101.29728201]
mat_Sqrt:  [[0.15]]
grads:  [0.11319559]
Stock Position:  0.11319559442943244
Bond Position:  [-10.30747557]


portfolio before change:  [1.18820795]
curr_Stock_Price:  101.56161833888132
curr_Factors:  [101.56161834]
mat_Sqrt:  [[0.15]]
grads:  [0.18173295]
Stock Position:  0.18173294618082383
Bond Position:  [-17.26888417]


portfolio before change:  [1.28153562]
curr_Stock_Price:  102.08110046061763
curr_Factors:  [102.08110046]
mat_Sqrt:  [[0.15]]
grads:  [0.02321206]
Stock Position:  0.02321206202434676
Bond Position:  [-1.08797721]


portfolio before change:  [1.26990804]
curr_Stock_Price:  101.58310149909654
curr_Factors:  [101.5831015]
mat_Sqrt:  [[0.15]]
grads:  [0.03305757]
Stock Position:  0.033057573324472636
Bond Position:  [-2.08818279]


portfolio before change:  [1.26529549]
curr_Stock_Price:  101.44751878203084
curr_Factors:  [101.44751878]
mat_Sqrt:  [[0.15]]
grads:  [0.15881136]
Stock Position:  0.15881135852300943
Bond Position:  [-14.84572279]


portfolio before change:  [1.31640519]
curr_Stock_Price:  101.77518796746077
curr_Factors:  [101.77518797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03061712]
Stock Position:  -0.030617123007310836
Bond Position:  [4.43246864]


portfolio before change:  [1.31826626]
curr_Stock_Price:  101.72345111235563
curr_Factors:  [101.72345111]
mat_Sqrt:  [[0.15]]
grads:  [0.19081446]
Stock Position:  0.19081445777256276
Bond Position:  [-18.0920389]


portfolio before change:  [1.21874348]
curr_Stock_Price:  101.20780886639794
curr_Factors:  [101.20780887]
mat_Sqrt:  [[0.15]]
grads:  [-0.28900953]
Stock Position:  -0.289009527146364
Bond Position:  [30.46876446]


portfolio before change:  [1.07441216]
curr_Stock_Price:  101.7137979879914
curr_Factors:  [101.71379799]
mat_Sqrt:  [[0.15]]
grads:  [0.35223176]
Stock Position:  0.3522317592817818
Bond Position:  [-34.75241785]


portfolio before change:  [1.28965126]
curr_Stock_Price:  102.33103703806539
curr_Factors:  [102.33103704]
mat_Sqrt:  [[0.15]]
grads:  [0.06861891]
Stock Position:  0.0686189130480309
Bond Position:  [-5.73219327]


portfolio before change:  [1.32800486]
curr_Stock_Price:  102.89519448409894
curr_Factors:  [102.89519448]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597513]
Stock Position:  -0.045975126982854254
Bond Position:  [6.05862449]


portfolio before change:  [1.32494119]
curr_Stock_Price:  102.97006859371423
curr_Factors:  [102.97006859]
mat_Sqrt:  [[0.15]]
grads:  [0.19341615]
Stock Position:  0.19341615210136218
Bond Position:  [-18.59113326]


portfolio before change:  [1.27207735]
curr_Stock_Price:  102.70275970455488
curr_Factors:  [102.7027597]
mat_Sqrt:  [[0.15]]
grads:  [0.07760494]
Stock Position:  0.07760493608290708
Bond Position:  [-6.69816375]


portfolio before change:  [1.23567934]
curr_Stock_Price:  102.23913759159579
curr_Factors:  [102.23913759]
mat_Sqrt:  [[0.15]]
grads:  [-0.06355614]
Stock Position:  -0.0635561370865577
Bond Position:  [7.73360398]


portfolio before change:  [1.23013928]
curr_Stock_Price:  102.33391090913595
curr_Factors:  [102.33391091]
mat_Sqrt:  [[0.15]]
grads:  [0.02923253]
Stock Position:  0.029232528833805276
Bond Position:  [-1.76133972]


portfolio before change:  [1.19016723]
curr_Stock_Price:  100.97029439734638
curr_Factors:  [100.9702944]
mat_Sqrt:  [[0.15]]
grads:  [0.00286182]
Stock Position:  0.002861822426327611
Bond Position:  [0.90120818]


portfolio before change:  [1.18923297]
curr_Stock_Price:  100.62415622309744
curr_Factors:  [100.62415622]
mat_Sqrt:  [[0.15]]
grads:  [0.07986924]
Stock Position:  0.07986924406822214
Bond Position:  [-6.84754232]


portfolio before change:  [1.18490788]
curr_Stock_Price:  100.57536258612124
curr_Factors:  [100.57536259]
mat_Sqrt:  [[0.15]]
grads:  [-0.04505327]
Stock Position:  -0.04505326964178292
Bond Position:  [5.71615681]


portfolio before change:  [1.18285803]
curr_Stock_Price:  100.62879095919597
curr_Factors:  [100.62879096]
mat_Sqrt:  [[0.15]]
grads:  [0.04560669]
Stock Position:  0.04560668634755116
Bond Position:  [-3.40648768]


portfolio before change:  [1.14072273]
curr_Stock_Price:  99.70957530654715
curr_Factors:  [99.70957531]
mat_Sqrt:  [[0.15]]
grads:  [0.26239238]
Stock Position:  0.2623923771858617
Bond Position:  [-25.02230976]


portfolio before change:  [1.27987688]
curr_Stock_Price:  100.24586411266996
curr_Factors:  [100.24586411]
mat_Sqrt:  [[0.15]]
grads:  [-0.01091243]
Stock Position:  -0.010912428218996968
Bond Position:  [2.37380268]


portfolio before change:  [1.27575581]
curr_Stock_Price:  100.63711009485235
curr_Factors:  [100.63711009]
mat_Sqrt:  [[0.15]]
grads:  [0.09544553]
Stock Position:  0.09544553342512563
Bond Position:  [-8.32960685]


portfolio before change:  [1.34446054]
curr_Stock_Price:  101.36239651111377
curr_Factors:  [101.36239651]
mat_Sqrt:  [[0.15]]
grads:  [-0.03720697]
Stock Position:  -0.03720697075365874
Bond Position:  [5.11584826]


portfolio before change:  [1.34467678]
curr_Stock_Price:  101.36517857483102
curr_Factors:  [101.36517857]
mat_Sqrt:  [[0.15]]
grads:  [0.0543665]
Stock Position:  0.05436649930930631
Bond Position:  [-4.16619313]


portfolio before change:  [1.35852233]
curr_Stock_Price:  101.62463879459452
curr_Factors:  [101.62463879]
mat_Sqrt:  [[0.15]]
grads:  [0.14409839]
Stock Position:  0.14409838520509616
Bond Position:  [-13.28542402]


portfolio before change:  [1.3710488]
curr_Stock_Price:  101.71733129055707
curr_Factors:  [101.71733129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963478]
Stock Position:  -0.00963477678064592
Bond Position:  [2.35107258]


portfolio before change:  [1.36604859]
curr_Stock_Price:  102.25155873385314
curr_Factors:  [102.25155873]
mat_Sqrt:  [[0.15]]
grads:  [0.09241496]
Stock Position:  0.09241496431560446
Bond Position:  [-8.08352557]


portfolio before change:  [1.42679783]
curr_Stock_Price:  102.91437864633895
curr_Factors:  [102.91437865]
mat_Sqrt:  [[0.15]]
grads:  [-0.04929636]
Stock Position:  -0.049296363407368496
Bond Position:  [6.50010244]


portfolio before change:  [1.42180994]
curr_Stock_Price:  103.02380161329239
curr_Factors:  [103.02380161]
mat_Sqrt:  [[0.15]]
grads:  [0.01518153]
Stock Position:  0.015181526211685446
Bond Position:  [-0.1422486]


portfolio before change:  [1.42427285]
curr_Stock_Price:  103.18661803493985
curr_Factors:  [103.18661803]
mat_Sqrt:  [[0.15]]
grads:  [0.05675349]
Stock Position:  0.05675348812892857
Bond Position:  [-4.43192765]


portfolio before change:  [1.45891693]
curr_Stock_Price:  103.80192968684172
curr_Factors:  [103.80192969]
mat_Sqrt:  [[0.15]]
grads:  [0.06851027]
Stock Position:  0.06851026522879408
Bond Position:  [-5.6525808]


portfolio before change:  [1.46568133]
curr_Stock_Price:  103.9058221107166
curr_Factors:  [103.90582211]
mat_Sqrt:  [[0.15]]
grads:  [0.04623205]
Stock Position:  0.04623204984823001
Bond Position:  [-3.33809781]


portfolio before change:  [1.42503114]
curr_Stock_Price:  103.03107062808792
curr_Factors:  [103.03107063]
mat_Sqrt:  [[0.15]]
grads:  [-0.22030184]
Stock Position:  -0.22030183910093676
Bond Position:  [24.12296548]


portfolio before change:  [1.40344503]
curr_Stock_Price:  103.13589881597014
curr_Factors:  [103.13589882]
mat_Sqrt:  [[0.15]]
grads:  [0.06039817]
Stock Position:  0.06039816881659977
Bond Position:  [-4.8257744]


portfolio before change:  [1.34822204]
curr_Stock_Price:  102.2265770311152
curr_Factors:  [102.22657703]
mat_Sqrt:  [[0.15]]
grads:  [0.03938247]
Stock Position:  0.039382465023555246
Bond Position:  [-2.67771255]


portfolio before change:  [1.3365066]
curr_Stock_Price:  101.93334813560695
curr_Factors:  [101.93334814]
mat_Sqrt:  [[0.15]]
grads:  [0.13406326]
Stock Position:  0.13406325593444968
Bond Position:  [-12.32900994]


portfolio before change:  [1.25890787]
curr_Stock_Price:  101.3602743391877
curr_Factors:  [101.36027434]
mat_Sqrt:  [[0.15]]
grads:  [-0.03745269]
Stock Position:  -0.03745269251131357
Bond Position:  [5.05512306]


portfolio before change:  [1.28238142]
curr_Stock_Price:  100.74195845675598
curr_Factors:  [100.74195846]
mat_Sqrt:  [[0.15]]
grads:  [-0.09867703]
Stock Position:  -0.09867703066570188
Bond Position:  [11.22329875]


portfolio before change:  [1.29976319]
curr_Stock_Price:  100.57291923899963
curr_Factors:  [100.57291924]
mat_Sqrt:  [[0.15]]
grads:  [0.15477302]
Stock Position:  0.15477302171851087
Bond Position:  [-14.26621142]


portfolio before change:  [1.31865228]
curr_Stock_Price:  100.70072417360517
curr_Factors:  [100.70072417]
mat_Sqrt:  [[0.15]]
grads:  [0.02075984]
Stock Position:  0.02075984071015456
Bond Position:  [-0.77187871]


portfolio before change:  [1.3338639]
curr_Stock_Price:  101.43579082707532
curr_Factors:  [101.43579083]
mat_Sqrt:  [[0.15]]
grads:  [-0.04085939]
Stock Position:  -0.04085939189317737
Bond Position:  [5.47846863]


portfolio before change:  [1.35753731]
curr_Stock_Price:  100.86478402139686
curr_Factors:  [100.86478402]
mat_Sqrt:  [[0.15]]
grads:  [0.01159786]
Stock Position:  0.011597857344965226
Bond Position:  [0.18772193]


portfolio before change:  [1.35582744]
curr_Stock_Price:  100.71634291293304
curr_Factors:  [100.71634291]
mat_Sqrt:  [[0.15]]
grads:  [0.06327273]
Stock Position:  0.06327272739292736
Bond Position:  [-5.01677027]


portfolio before change:  [1.29824973]
curr_Stock_Price:  99.8113060256956
curr_Factors:  [99.81130603]
mat_Sqrt:  [[0.15]]
grads:  [-0.08151919]
Stock Position:  -0.08151919246452156
Bond Position:  [9.4347868]


portfolio before change:  [1.27196872]
curr_Stock_Price:  100.14093028798507
curr_Factors:  [100.14093029]
mat_Sqrt:  [[0.15]]
grads:  [-0.10083471]
Stock Position:  -0.10083470907343657
Bond Position:  [11.36965029]


portfolio before change:  [1.22737289]
curr_Stock_Price:  100.59024434557212
curr_Factors:  [100.59024435]
mat_Sqrt:  [[0.15]]
grads:  [-0.05044018]
Stock Position:  -0.05044018424439956
Bond Position:  [6.30116335]


portfolio before change:  [1.20890324]
curr_Stock_Price:  100.96422171633483
curr_Factors:  [100.96422172]
mat_Sqrt:  [[0.15]]
grads:  [0.12733186]
Stock Position:  0.12733185673492498
Bond Position:  [-11.64705857]


portfolio before change:  [1.21751304]
curr_Stock_Price:  101.03755577497057
curr_Factors:  [101.03755577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04263749]
Stock Position:  -0.042637491630876594
Bond Position:  [5.52550098]


portfolio before change:  [1.2151298]
curr_Stock_Price:  101.10155106602274
curr_Factors:  [101.10155107]
mat_Sqrt:  [[0.15]]
grads:  [-0.00743413]
Stock Position:  -0.007434131458273459
Bond Position:  [1.96673202]


portfolio before change:  [1.21317087]
curr_Stock_Price:  101.38159037842831
curr_Factors:  [101.38159038]
mat_Sqrt:  [[0.15]]
grads:  [0.03565937]
Stock Position:  0.03565937182668517
Bond Position:  [-2.40203296]


portfolio before change:  [1.2056555]
curr_Stock_Price:  101.17504594640404
curr_Factors:  [101.17504595]
mat_Sqrt:  [[0.15]]
grads:  [0.02722313]
Stock Position:  0.027223133544648694
Bond Position:  [-1.54864629]


portfolio before change:  [1.20183628]
curr_Stock_Price:  101.03830857701932
curr_Factors:  [101.03830858]
mat_Sqrt:  [[0.15]]
grads:  [-0.01269325]
Stock Position:  -0.012693249809201957
Bond Position:  [2.48434077]


portfolio before change:  [1.19598722]
curr_Stock_Price:  101.51134233739168
curr_Factors:  [101.51134234]
mat_Sqrt:  [[0.15]]
grads:  [0.04956459]
Stock Position:  0.04956458725445802
Bond Position:  [-3.83538056]


portfolio before change:  [1.19315412]
curr_Stock_Price:  101.45901906651359
curr_Factors:  [101.45901907]
mat_Sqrt:  [[0.15]]
grads:  [-0.0039936]
Stock Position:  -0.003993597031661075
Bond Position:  [1.59834056]


portfolio before change:  [1.19447989]
curr_Stock_Price:  101.15205960631981
curr_Factors:  [101.15205961]
mat_Sqrt:  [[0.15]]
grads:  [0.01051167]
Stock Position:  0.010511667657536973
Bond Position:  [0.13120306]


portfolio before change:  [1.18796581]
curr_Stock_Price:  100.5315789639097
curr_Factors:  [100.53157896]
mat_Sqrt:  [[0.15]]
grads:  [0.00395893]
Stock Position:  0.003958930204148564
Bond Position:  [0.7899683]


portfolio before change:  [1.18965473]
curr_Stock_Price:  100.94571668423158
curr_Factors:  [100.94571668]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [0.58340844]


portfolio before change:  [1.19237604]
curr_Stock_Price:  101.39276927152589
curr_Factors:  [101.39276927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694209]
Stock Position:  -0.036942092321736175
Bond Position:  [4.93803708]


portfolio before change:  [1.19557886]
curr_Stock_Price:  101.31442543101879
curr_Factors:  [101.31442543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03893836]
Stock Position:  -0.038938360040332104
Bond Position:  [5.14059644]


portfolio before change:  [1.18700047]
curr_Stock_Price:  101.54298371049708
curr_Factors:  [101.54298371]
mat_Sqrt:  [[0.15]]
grads:  [-0.08510452]
Stock Position:  -0.085104523283312
Bond Position:  [9.82876769]


portfolio before change:  [1.19303785]
curr_Stock_Price:  101.47926131041726
curr_Factors:  [101.47926131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700749]
Stock Position:  -0.027007492002635927
Bond Position:  [3.93373819]


portfolio before change:  [1.16794819]
curr_Stock_Price:  102.41735404213948
curr_Factors:  [102.41735404]
mat_Sqrt:  [[0.15]]
grads:  [0.00569198]
Stock Position:  0.005691984228663113
Bond Position:  [0.58499023]


portfolio before change:  [1.15895363]
curr_Stock_Price:  100.83071472180724
curr_Factors:  [100.83071472]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366441]
Stock Position:  -0.03664409987389954
Bond Position:  [4.85380441]


portfolio before change:  [1.1657666]
curr_Stock_Price:  100.65307082631028
curr_Factors:  [100.65307083]
mat_Sqrt:  [[0.15]]
grads:  [0.14604123]
Stock Position:  0.14604122976382705
Bond Position:  [-13.53373164]


portfolio before change:  [1.08145427]
curr_Stock_Price:  100.08154422836233
curr_Factors:  [100.08154423]
mat_Sqrt:  [[0.15]]
grads:  [-0.05681892]
Stock Position:  -0.05681891934372929
Bond Position:  [6.76797946]


portfolio before change:  [1.09328078]
curr_Stock_Price:  99.88084513144724
curr_Factors:  [99.88084513]
mat_Sqrt:  [[0.15]]
grads:  [0.04376943]
Stock Position:  0.04376943360496782
Bond Position:  [-3.27844723]


portfolio before change:  [1.06859711]
curr_Stock_Price:  99.32157895358193
curr_Factors:  [99.32157895]
mat_Sqrt:  [[0.15]]
grads:  [-0.05829525]
Stock Position:  -0.058295248130125765
Bond Position:  [6.8585732]


portfolio before change:  [1.08577627]
curr_Stock_Price:  99.03424011433398
curr_Factors:  [99.03424011]
mat_Sqrt:  [[0.15]]
grads:  [0.0717813]
Stock Position:  0.07178130444616868
Bond Position:  [-6.02303067]


portfolio before change:  [1.0334389]
curr_Stock_Price:  98.31036185847196
curr_Factors:  [98.31036186]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916789]
Stock Position:  -0.019167886443965505
Bond Position:  [2.91784075]


portfolio before change:  [1.01909573]
curr_Stock_Price:  99.06816800934361
curr_Factors:  [99.06816801]
mat_Sqrt:  [[0.15]]
grads:  [0.06075192]
Stock Position:  0.06075192381914438
Bond Position:  [-4.99948607]


portfolio before change:  [1.02906878]
curr_Stock_Price:  99.23747179635971
curr_Factors:  [99.2374718]
mat_Sqrt:  [[0.15]]
grads:  [-0.12725539]
Stock Position:  -0.12725539418027065
Bond Position:  [13.65757237]


portfolio before change:  [0.95665333]
curr_Stock_Price:  99.8132358328914
curr_Factors:  [99.81323583]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845929]
Stock Position:  -0.02845928739992459
Bond Position:  [3.79726689]


portfolio before change:  [0.99133639]
curr_Stock_Price:  98.60288494048605
curr_Factors:  [98.60288494]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526268]
Stock Position:  -0.005262681143933344
Bond Position:  [1.51025193]


portfolio before change:  [0.99663091]
curr_Stock_Price:  97.61477092776794
curr_Factors:  [97.61477093]
mat_Sqrt:  [[0.15]]
grads:  [0.02098692]
Stock Position:  0.020986915016321717
Bond Position:  [-1.05200199]


portfolio before change:  [1.00285553]
curr_Stock_Price:  97.9144990941748
curr_Factors:  [97.91449909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.00285553]
Stock Price:  98.01708888628875
PL:  [1.00285553]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.14119635e-02]
 [-4.22880815e-02]
 [-1.02461836e-02]
 [ 5.18660499e-03]
 [-3.22437500e-03]
 [ 8.34390846e-03]
 [ 5.21198596e-03]
 [-2.84705840e-02]
 [-4.38726352e-02]
 [ 3.58121496e-02]
 [-9.36672376e-02]
 [ 3.06392182e-02]
 [-1.06669070e-02]
 [ 1.64542371e-03]
 [-7.03503546e-03]
 [ 1.08267025e-02]
 [ 1.53184839e-02]
 [ 1.70001186e-02]
 [ 8.27695783e-04]
 [ 8.73824491e-03]
 [ 1.25310424e-02]
 [-9.67140267e-03]
 [ 6.82429008e-03]
 [-9.46955576e-05]
 [-8.90873976e-03]
 [-1.01097994e-02]
 [-4.15480215e-03]
 [ 7.73329093e-03]
 [-1.72980531e-02]
 [-1.17524696e-03]
 [-1.68557466e-03]
 [-1.03644672e-02]
 [-5.22982604e-03]
 [ 4.63190496e-03]
 [ 1.24001289e-02]
 [ 1.38839402e-02]
 [-3.46764976e-02]
 [ 8.77418186e-03]
 [-2.44882446e-02]
 [ 2.01319827e-02]
 [-4.85251927e-03]
 [ 4.18576732e-03]
 [ 2.30347021e-02]
 [ 4.25902796e-03]
 [ 3.05111426e-03]
 [ 7.60493343e-03]
 [ 5.65488486e-04]
 [-1.15326171e-02]
 [-3.71155006e-03]
 [ 3.81265348e-04]
 [ 3.86284128e-02]
 [ 1.80642185e-04]
 [ 1.93097030e-03]
 [ 4.82908972e-03]
 [ 3.49083715e-03]
 [ 2.64834683e-03]
 [-6.54501270e-04]
 [-6.79060564e-04]
 [ 1.53813906e-03]
 [ 1.21403304e-04]
 [-2.14037352e-05]
 [-1.18003907e-05]
 [ 4.95154779e-03]
 [-1.79228677e-02]
 [-8.96238362e-03]
 [-5.20582474e-03]
 [-4.78885439e-03]
 [ 1.98592856e-02]
 [-1.02657167e-02]
 [ 6.33310929e-03]
 [-6.25383203e-03]
 [ 1.07781350e-02]
 [-5.15650223e-03]
 [ 1.16848437e-02]
 [-2.14599464e-02]
 [-4.26739969e-03]
 [-4.23393526e-03]
 [-1.96525533e-03]
 [ 1.85550375e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.51275545]
curr_Stock_Price:  98.53340547546992
curr_Factors:  [98.53340548]
mat_Sqrt:  [[0.15]]
grads:  [0.07607976]
Stock Position:  0.07607975692945775
Bond Position:  [-28.00915299]


portfolio before change:  [-20.54225835]
curr_Stock_Price:  98.16862681288444
curr_Factors:  [98.16862681]
mat_Sqrt:  [[0.15]]
grads:  [-0.28192054]
Stock Position:  -0.2819205435608654
Bond Position:  [7.13349428]


portfolio before change:  [-20.392092]
curr_Stock_Price:  97.63755344870806
curr_Factors:  [97.63755345]
mat_Sqrt:  [[0.15]]
grads:  [-0.06830789]
Stock Position:  -0.06830789057886984
Bond Position:  [-13.72267669]


portfolio before change:  [-20.43335321]
curr_Stock_Price:  98.2290446492353
curr_Factors:  [98.22904465]
mat_Sqrt:  [[0.15]]
grads:  [0.03457737]
Stock Position:  0.03457736657035131
Bond Position:  [-23.8298549]


portfolio before change:  [-20.42542566]
curr_Stock_Price:  98.50138941749542
curr_Factors:  [98.50138942]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149583]
Stock Position:  -0.021495833344344663
Bond Position:  [-18.30805621]


portfolio before change:  [-20.40667674]
curr_Stock_Price:  97.57594429889281
curr_Factors:  [97.5759443]
mat_Sqrt:  [[0.15]]
grads:  [0.05562606]
Stock Position:  0.05562605642117418
Bond Position:  [-25.83444172]


portfolio before change:  [-20.42740261]
curr_Stock_Price:  97.2323792650442
curr_Factors:  [97.23237927]
mat_Sqrt:  [[0.15]]
grads:  [0.03474657]
Stock Position:  0.034746573063639166
Bond Position:  [-23.80589458]


portfolio before change:  [-20.43300112]
curr_Stock_Price:  97.11407695890284
curr_Factors:  [97.11407696]
mat_Sqrt:  [[0.15]]
grads:  [-0.18980389]
Stock Position:  -0.1898038930988677
Bond Position:  [-2.00037124]


portfolio before change:  [-20.35655456]
curr_Stock_Price:  96.7106522060803
curr_Factors:  [96.71065221]
mat_Sqrt:  [[0.15]]
grads:  [-0.29248423]
Stock Position:  -0.2924842345012634
Bond Position:  [7.92978652]


portfolio before change:  [-20.46113291]
curr_Stock_Price:  97.0698988479299
curr_Factors:  [97.06989885]
mat_Sqrt:  [[0.15]]
grads:  [0.23874766]
Stock Position:  0.23874766398838593
Bond Position:  [-43.63634451]


portfolio before change:  [-20.5449779]
curr_Stock_Price:  96.730135808684
curr_Factors:  [96.73013581]
mat_Sqrt:  [[0.15]]
grads:  [-0.62444825]
Stock Position:  -0.6244482504497033
Bond Position:  [39.85798617]


portfolio before change:  [-20.86352257]
curr_Stock_Price:  97.24424705850893
curr_Factors:  [97.24424706]
mat_Sqrt:  [[0.15]]
grads:  [0.20426145]
Stock Position:  0.20426145490441727
Bond Position:  [-40.72677396]


portfolio before change:  [-20.86821446]
curr_Stock_Price:  97.23373901266704
curr_Factors:  [97.23373901]
mat_Sqrt:  [[0.15]]
grads:  [-0.07111271]
Stock Position:  -0.07111271322679666
Bond Position:  [-13.95365946]


portfolio before change:  [-20.87090277]
curr_Stock_Price:  97.25927839852112
curr_Factors:  [97.2592784]
mat_Sqrt:  [[0.15]]
grads:  [0.01096949]
Stock Position:  0.01096949137287237
Bond Position:  [-21.93778758]


portfolio before change:  [-20.8713443]
curr_Stock_Price:  97.3440247800229
curr_Factors:  [97.34402478]
mat_Sqrt:  [[0.15]]
grads:  [-0.04690024]
Stock Position:  -0.04690023636952528
Bond Position:  [-16.30588653]


portfolio before change:  [-20.84628861]
curr_Stock_Price:  96.78806082914004
curr_Factors:  [96.78806083]
mat_Sqrt:  [[0.15]]
grads:  [0.07217802]
Stock Position:  0.0721780165955351
Bond Position:  [-27.83225887]


portfolio before change:  [-20.88281522]
curr_Stock_Price:  96.30609914123542
curr_Factors:  [96.30609914]
mat_Sqrt:  [[0.15]]
grads:  [0.10212323]
Stock Position:  0.10212322633013277
Bond Position:  [-30.71790478]


portfolio before change:  [-20.85580524]
curr_Stock_Price:  96.58938337606524
curr_Factors:  [96.58938338]
mat_Sqrt:  [[0.15]]
grads:  [0.11333412]
Stock Position:  0.1133341242905957
Bond Position:  [-31.80267843]


portfolio before change:  [-20.86907975]
curr_Stock_Price:  96.4897949168503
curr_Factors:  [96.48979492]
mat_Sqrt:  [[0.15]]
grads:  [0.00551797]
Stock Position:  0.0055179718860461574
Bond Position:  [-21.40150772]


portfolio before change:  [-20.86541119]
curr_Stock_Price:  97.39704767501637
curr_Factors:  [97.39704768]
mat_Sqrt:  [[0.15]]
grads:  [0.05825497]
Stock Position:  0.058254966053856674
Bond Position:  [-26.53927289]


portfolio before change:  [-20.85709571]
curr_Stock_Price:  97.56826459118224
curr_Factors:  [97.56826459]
mat_Sqrt:  [[0.15]]
grads:  [0.08354028]
Stock Position:  0.08354028235238511
Bond Position:  [-29.00797608]


portfolio before change:  [-20.84014734]
curr_Stock_Price:  97.79284398374953
curr_Factors:  [97.79284398]
mat_Sqrt:  [[0.15]]
grads:  [-0.06447602]
Stock Position:  -0.06447601778157774
Bond Position:  [-14.53485419]


portfolio before change:  [-20.87773894]
curr_Stock_Price:  98.36178651421307
curr_Factors:  [98.36178651]
mat_Sqrt:  [[0.15]]
grads:  [0.04549527]
Stock Position:  0.04549526719530231
Bond Position:  [-25.3527347]


portfolio before change:  [-20.88853281]
curr_Stock_Price:  98.15936388700084
curr_Factors:  [98.15936389]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006313]
Stock Position:  -0.000631303717118457
Bond Position:  [-20.82656444]


portfolio before change:  [-20.88973966]
curr_Stock_Price:  98.00912277974662
curr_Factors:  [98.00912278]
mat_Sqrt:  [[0.15]]
grads:  [-0.0593916]
Stock Position:  -0.05939159843317736
Bond Position:  [-15.0688212]


portfolio before change:  [-20.90060668]
curr_Stock_Price:  98.17623704711085
curr_Factors:  [98.17623705]
mat_Sqrt:  [[0.15]]
grads:  [-0.06739866]
Stock Position:  -0.06739866268785917
Bond Position:  [-14.28365959]


portfolio before change:  [-20.91662955]
curr_Stock_Price:  98.40072402572208
curr_Factors:  [98.40072403]
mat_Sqrt:  [[0.15]]
grads:  [-0.02769868]
Stock Position:  -0.027698680982686866
Bond Position:  [-18.19105929]


portfolio before change:  [-20.91252022]
curr_Stock_Price:  98.21131742361563
curr_Factors:  [98.21131742]
mat_Sqrt:  [[0.15]]
grads:  [0.05155527]
Stock Position:  0.05155527284156785
Bond Position:  [-25.97583148]


portfolio before change:  [-20.91147229]
curr_Stock_Price:  98.2631349099762
curr_Factors:  [98.26313491]
mat_Sqrt:  [[0.15]]
grads:  [-0.11532035]
Stock Position:  -0.11532035417147528
Bond Position:  [-9.57973277]


portfolio before change:  [-20.98400075]
curr_Stock_Price:  98.88687303853352
curr_Factors:  [98.88687304]
mat_Sqrt:  [[0.15]]
grads:  [-0.00783498]
Stock Position:  -0.007834979739275607
Bond Position:  [-20.2092241]


portfolio before change:  [-20.9793787]
curr_Stock_Price:  98.13573399002811
curr_Factors:  [98.13573399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123716]
Stock Position:  -0.011237164432447337
Bond Position:  [-19.87661133]


portfolio before change:  [-20.99369731]
curr_Stock_Price:  99.29939782136474
curr_Factors:  [99.29939782]
mat_Sqrt:  [[0.15]]
grads:  [-0.06909645]
Stock Position:  -0.06909644787286912
Bond Position:  [-14.13246165]


portfolio before change:  [-20.97554183]
curr_Stock_Price:  99.02385845363683
curr_Factors:  [99.02385845]
mat_Sqrt:  [[0.15]]
grads:  [-0.03486551]
Stock Position:  -0.03486550695613306
Bond Position:  [-17.5230248]


portfolio before change:  [-20.96361285]
curr_Stock_Price:  98.65030282335782
curr_Factors:  [98.65030282]
mat_Sqrt:  [[0.15]]
grads:  [0.03087937]
Stock Position:  0.030879366421452833
Bond Position:  [-24.00987169]


portfolio before change:  [-20.95682314]
curr_Stock_Price:  98.91877875077058
curr_Factors:  [98.91877875]
mat_Sqrt:  [[0.15]]
grads:  [0.08266753]
Stock Position:  0.08266752575513492
Bond Position:  [-29.13419383]


portfolio before change:  [-20.92480959]
curr_Stock_Price:  99.32806271852819
curr_Factors:  [99.32806272]
mat_Sqrt:  [[0.15]]
grads:  [0.0925596]
Stock Position:  0.09255960103603202
Bond Position:  [-30.11857545]


portfolio before change:  [-21.0205079]
curr_Stock_Price:  98.31449055398949
curr_Factors:  [98.31449055]
mat_Sqrt:  [[0.15]]
grads:  [-0.23117665]
Stock Position:  -0.2311766504796507
Bond Position:  [1.70750672]


portfolio before change:  [-20.91158153]
curr_Stock_Price:  97.84376979598024
curr_Factors:  [97.8437698]
mat_Sqrt:  [[0.15]]
grads:  [0.05849455]
Stock Position:  0.05849454570479189
Bond Position:  [-26.63490839]


portfolio before change:  [-20.9285874]
curr_Stock_Price:  97.581503692282
curr_Factors:  [97.58150369]
mat_Sqrt:  [[0.15]]
grads:  [-0.16325496]
Stock Position:  -0.16325496397426245
Bond Position:  [-4.99792253]


portfolio before change:  [-20.98870619]
curr_Stock_Price:  97.94784119430817
curr_Factors:  [97.94784119]
mat_Sqrt:  [[0.15]]
grads:  [0.13421322]
Stock Position:  0.13421321804907216
Bond Position:  [-34.13460116]


portfolio before change:  [-20.87789832]
curr_Stock_Price:  98.78934812483443
curr_Factors:  [98.78934812]
mat_Sqrt:  [[0.15]]
grads:  [-0.03235013]
Stock Position:  -0.03235012844401908
Bond Position:  [-17.68205022]


portfolio before change:  [-20.87442445]
curr_Stock_Price:  98.64780207837818
curr_Factors:  [98.64780208]
mat_Sqrt:  [[0.15]]
grads:  [0.02790512]
Stock Position:  0.027905115475801573
Bond Position:  [-23.62720276]


portfolio before change:  [-20.89932806]
curr_Stock_Price:  97.8082834663678
curr_Factors:  [97.80828347]
mat_Sqrt:  [[0.15]]
grads:  [0.15356468]
Stock Position:  0.15356468090363248
Bond Position:  [-35.9192259]


portfolio before change:  [-20.94502646]
curr_Stock_Price:  97.52531883357925
curr_Factors:  [97.52531883]
mat_Sqrt:  [[0.15]]
grads:  [0.02839352]
Stock Position:  0.028393519728910292
Bond Position:  [-23.71411352]


portfolio before change:  [-20.9581463]
curr_Stock_Price:  97.11544847065628
curr_Factors:  [97.11544847]
mat_Sqrt:  [[0.15]]
grads:  [0.02034076]
Stock Position:  0.020340761756241027
Bond Position:  [-22.9335485]


portfolio before change:  [-20.97155486]
curr_Stock_Price:  96.52672076468721
curr_Factors:  [96.52672076]
mat_Sqrt:  [[0.15]]
grads:  [0.05069956]
Stock Position:  0.05069955622861745
Bond Position:  [-25.86541676]


portfolio before change:  [-20.96799291]
curr_Stock_Price:  96.62886345402481
curr_Factors:  [96.62886345]
mat_Sqrt:  [[0.15]]
grads:  [0.00376992]
Stock Position:  0.003769923242554011
Bond Position:  [-21.33227631]


portfolio before change:  [-20.9693515]
curr_Stock_Price:  96.62215639049671
curr_Factors:  [96.62215639]
mat_Sqrt:  [[0.15]]
grads:  [-0.07688411]
Stock Position:  -0.07688411400459914
Bond Position:  [-13.54064261]


portfolio before change:  [-21.0246661]
curr_Stock_Price:  97.330602890215
curr_Factors:  [97.33060289]
mat_Sqrt:  [[0.15]]
grads:  [-0.02474367]
Stock Position:  -0.024743667045945324
Bond Position:  [-18.61635007]


portfolio before change:  [-21.01588464]
curr_Stock_Price:  96.92868114727646
curr_Factors:  [96.92868115]
mat_Sqrt:  [[0.15]]
grads:  [0.00254177]
Stock Position:  0.002541768983715676
Bond Position:  [-21.26225496]


portfolio before change:  [-21.01874632]
curr_Stock_Price:  96.32565693823435
curr_Factors:  [96.32565694]
mat_Sqrt:  [[0.15]]
grads:  [0.25752275]
Stock Position:  0.2575227521621706
Bond Position:  [-45.8247946]


portfolio before change:  [-21.08844693]
curr_Stock_Price:  96.0661207543267
curr_Factors:  [96.06612075]
mat_Sqrt:  [[0.15]]
grads:  [0.00120428]
Stock Position:  0.0012042812309884937
Bond Position:  [-21.20413756]


portfolio before change:  [-21.0895882]
curr_Stock_Price:  96.21893324540373
curr_Factors:  [96.21893325]
mat_Sqrt:  [[0.15]]
grads:  [0.01287314]
Stock Position:  0.012873135305310191
Bond Position:  [-22.32822755]


portfolio before change:  [-21.09340838]
curr_Stock_Price:  96.03058608517632
curr_Factors:  [96.03058609]
mat_Sqrt:  [[0.15]]
grads:  [0.03219393]
Stock Position:  0.03219393149156517
Bond Position:  [-24.18501049]


portfolio before change:  [-21.10529087]
curr_Stock_Price:  95.70844822543222
curr_Factors:  [95.70844823]
mat_Sqrt:  [[0.15]]
grads:  [0.02327225]
Stock Position:  0.02327224764907585
Bond Position:  [-23.33264158]


portfolio before change:  [-21.09510446]
curr_Stock_Price:  96.20881873760702
curr_Factors:  [96.20881874]
mat_Sqrt:  [[0.15]]
grads:  [0.01765565]
Stock Position:  0.017655645513585255
Bond Position:  [-22.79373326]


portfolio before change:  [-21.08456149]
curr_Stock_Price:  96.88665464655396
curr_Factors:  [96.88665465]
mat_Sqrt:  [[0.15]]
grads:  [-0.00436334]
Stock Position:  -0.004363341798490874
Bond Position:  [-20.6618119]


portfolio before change:  [-21.08970767]
curr_Stock_Price:  97.77010113151064
curr_Factors:  [97.77010113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00452707]
Stock Position:  -0.004527070428683649
Bond Position:  [-20.64709553]


portfolio before change:  [-21.09409888]
curr_Stock_Price:  98.45503211431333
curr_Factors:  [98.45503211]
mat_Sqrt:  [[0.15]]
grads:  [0.01025426]
Stock Position:  0.010254260417411254
Bond Position:  [-22.10368242]


portfolio before change:  [-21.0896074]
curr_Stock_Price:  99.02777071619296
curr_Factors:  [99.02777072]
mat_Sqrt:  [[0.15]]
grads:  [0.00080936]
Stock Position:  0.0008093553575530312
Bond Position:  [-21.16975605]


portfolio before change:  [-21.09162956]
curr_Stock_Price:  98.16410340966509
curr_Factors:  [98.16410341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014269]
Stock Position:  -0.0001426915680761802
Bond Position:  [-21.07762237]


portfolio before change:  [-21.09296997]
curr_Stock_Price:  98.32539516226866
curr_Factors:  [98.32539516]
mat_Sqrt:  [[0.15]]
grads:  [-7.86692713e-05]
Stock Position:  -7.866927131131018e-05
Bond Position:  [-21.08523478]


portfolio before change:  [-21.09429843]
curr_Stock_Price:  98.46007502439018
curr_Factors:  [98.46007502]
mat_Sqrt:  [[0.15]]
grads:  [0.03301032]
Stock Position:  0.03301031859562762
Bond Position:  [-24.34449688]


portfolio before change:  [-21.10588451]
curr_Stock_Price:  98.15518555239032
curr_Factors:  [98.15518555]
mat_Sqrt:  [[0.15]]
grads:  [-0.11948578]
Stock Position:  -0.11948578492866263
Bond Position:  [-9.37773512]


portfolio before change:  [-21.03434162]
curr_Stock_Price:  97.55152362183475
curr_Factors:  [97.55152362]
mat_Sqrt:  [[0.15]]
grads:  [-0.05974922]
Stock Position:  -0.05974922414791755
Bond Position:  [-15.20571376]


portfolio before change:  [-21.06312095]
curr_Stock_Price:  98.01728603848814
curr_Factors:  [98.01728604]
mat_Sqrt:  [[0.15]]
grads:  [-0.0347055]
Stock Position:  -0.034705498296884754
Bond Position:  [-17.66138219]


portfolio before change:  [-21.0596132]
curr_Stock_Price:  97.8844075076482
curr_Factors:  [97.88440751]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319257]
Stock Position:  -0.031925695913716634
Bond Position:  [-17.93458537]


portfolio before change:  [-21.0735071]
curr_Stock_Price:  98.2844912931165
curr_Factors:  [98.28449129]
mat_Sqrt:  [[0.15]]
grads:  [0.13239524]
Stock Position:  0.13239523727212776
Bond Position:  [-34.08590565]


portfolio before change:  [-21.14807546]
curr_Stock_Price:  97.73735739507823
curr_Factors:  [97.7373574]
mat_Sqrt:  [[0.15]]
grads:  [-0.06843811]
Stock Position:  -0.0684381112251428
Bond Position:  [-14.45911532]


portfolio before change:  [-21.19585314]
curr_Stock_Price:  98.42226754091985
curr_Factors:  [98.42226754]
mat_Sqrt:  [[0.15]]
grads:  [0.04222073]
Stock Position:  0.04222072858466625
Bond Position:  [-25.35131298]


portfolio before change:  [-21.19241922]
curr_Stock_Price:  98.5411291187604
curr_Factors:  [98.54112912]
mat_Sqrt:  [[0.15]]
grads:  [-0.04169221]
Stock Position:  -0.041692213534147905
Bond Position:  [-17.08402143]


portfolio before change:  [-21.21141337]
curr_Stock_Price:  98.97109826321243
curr_Factors:  [98.97109826]
mat_Sqrt:  [[0.15]]
grads:  [0.07185423]
Stock Position:  0.07185423355838043
Bond Position:  [-28.32290578]


portfolio before change:  [-21.20361487]
curr_Stock_Price:  99.10426707514881
curr_Factors:  [99.10426708]
mat_Sqrt:  [[0.15]]
grads:  [-0.03437668]
Stock Position:  -0.03437668153722756
Bond Position:  [-17.79673904]


portfolio before change:  [-21.22707542]
curr_Stock_Price:  99.75436539758024
curr_Factors:  [99.7543654]
mat_Sqrt:  [[0.15]]
grads:  [0.07789896]
Stock Position:  0.07789895794624435
Bond Position:  [-28.99783654]


portfolio before change:  [-21.20537362]
curr_Stock_Price:  100.05622082119024
curr_Factors:  [100.05622082]
mat_Sqrt:  [[0.15]]
grads:  [-0.14306631]
Stock Position:  -0.1430663094187414
Bond Position:  [-6.89069937]


portfolio before change:  [-21.14300521]
curr_Stock_Price:  99.61726988472765
curr_Factors:  [99.61726988]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844933]
Stock Position:  -0.028449331274206128
Bond Position:  [-18.3089605]


portfolio before change:  [-21.13923706]
curr_Stock_Price:  99.44459471443247
curr_Factors:  [99.44459471]
mat_Sqrt:  [[0.15]]
grads:  [-0.02822624]
Stock Position:  -0.028226235048732663
Bond Position:  [-18.33229056]


portfolio before change:  [-21.14361732]
curr_Stock_Price:  99.55918510815148
curr_Factors:  [99.55918511]
mat_Sqrt:  [[0.15]]
grads:  [-0.0131017]
Stock Position:  -0.013101702187474449
Bond Position:  [-19.83922253]


portfolio before change:  [-21.15077894]
curr_Stock_Price:  100.01115915287494
curr_Factors:  [100.01115915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.15077894]
Stock Price:  99.71372498083355
PL:  [-21.15077894]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.79760390e-03]
 [-6.15375362e-04]
 [-1.19747009e-03]
 [ 7.97194028e-03]
 [ 4.76803239e-03]
 [ 2.47125153e-02]
 [ 1.13354802e-03]
 [-1.83750132e-02]
 [ 1.99751129e-02]
 [ 9.30026741e-03]
 [ 1.51053745e-02]
 [-6.86075204e-04]
 [-1.45903205e-02]
 [ 5.19410044e-03]
 [-6.99761049e-03]
 [ 1.06506020e-02]
 [ 1.04035401e-02]
 [ 4.92438794e-03]
 [ 2.05578186e-03]
 [ 8.51578783e-03]
 [ 1.25368114e-02]
 [-1.05213483e-02]
 [ 1.76955004e-03]
 [-6.94408095e-02]
 [-1.18193814e-02]
 [-3.39594368e-03]
 [-7.76201390e-04]
 [ 9.07644288e-03]
 [-1.85563825e-02]
 [ 3.89856061e-04]
 [ 3.17182229e-03]
 [-1.00675910e-02]
 [-8.26895705e-03]
 [ 5.49380123e-03]
 [ 1.37744004e-02]
 [ 6.90127004e-03]
 [-3.21826996e-02]
 [ 7.84556580e-03]
 [-3.95751131e-02]
 [-4.86994436e-03]
 [-1.64443557e-02]
 [ 8.03904206e-02]
 [ 2.36317840e-02]
 [ 2.37296876e-03]
 [ 1.23412258e-02]
 [ 2.94857810e-02]
 [-3.39973838e-03]
 [-1.90071689e-03]
 [ 2.11992857e-02]
 [ 7.13028602e-03]
 [ 3.05686431e-02]
 [ 7.70610922e-03]
 [ 4.76237306e-04]
 [ 4.47504750e-03]
 [ 4.22202122e-03]
 [ 4.78860508e-03]
 [-1.88052229e-02]
 [ 1.86019273e-04]
 [ 1.60103461e-03]
 [-7.65590846e-02]
 [-1.24592462e-02]
 [ 1.77955972e-02]
 [ 1.74976043e-02]
 [-1.98615349e-02]
 [-4.86060048e-03]
 [-1.85586158e-02]
 [-3.82060206e-03]
 [-3.76724513e-03]
 [-1.87451991e-02]
 [ 1.51942438e-02]
 [ 1.14300082e-02]
 [ 1.27491458e-02]
 [ 3.29798016e-03]
 [ 3.74095712e-03]
 [ 1.43546433e-02]
 [-2.05059580e-02]
 [ 4.82599659e-03]
 [ 9.32423200e-03]
 [ 5.54420782e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.72127166]
curr_Stock_Price:  99.97917217470315
curr_Factors:  [99.97917217]
mat_Sqrt:  [[0.15]]
grads:  [0.01198403]
Stock Position:  0.011984026029914678
Bond Position:  [0.52311866]


portfolio before change:  [1.71692696]
curr_Stock_Price:  99.61390275884203
curr_Factors:  [99.61390276]
mat_Sqrt:  [[0.15]]
grads:  [-0.0041025]
Stock Position:  -0.004102502410659294
Bond Position:  [2.12559324]


portfolio before change:  [1.7182362]
curr_Stock_Price:  99.32715437448066
curr_Factors:  [99.32715437]
mat_Sqrt:  [[0.15]]
grads:  [-0.00798313]
Stock Position:  -0.007983133916944699
Bond Position:  [2.51117817]


portfolio before change:  [1.71337678]
curr_Stock_Price:  99.95552582538716
curr_Factors:  [99.95552583]
mat_Sqrt:  [[0.15]]
grads:  [0.05314627]
Stock Position:  0.0531462685243538
Bond Position:  [-3.59888644]


portfolio before change:  [1.69359617]
curr_Stock_Price:  99.58756631361842
curr_Factors:  [99.58756631]
mat_Sqrt:  [[0.15]]
grads:  [0.03178688]
Stock Position:  0.031786882624786975
Bond Position:  [-1.47198211]


portfolio before change:  [1.70937601]
curr_Stock_Price:  100.08688678084457
curr_Factors:  [100.08688678]
mat_Sqrt:  [[0.15]]
grads:  [0.1647501]
Stock Position:  0.16475010209810068
Bond Position:  [-14.77994881]


portfolio before change:  [1.85160199]
curr_Stock_Price:  100.9557770243284
curr_Factors:  [100.95577702]
mat_Sqrt:  [[0.15]]
grads:  [0.00755699]
Stock Position:  0.007556986822701177
Bond Position:  [1.08868051]


portfolio before change:  [1.84188009]
curr_Stock_Price:  99.6602944625248
curr_Factors:  [99.66029446]
mat_Sqrt:  [[0.15]]
grads:  [-0.12250009]
Stock Position:  -0.1225000880259848
Bond Position:  [14.05027493]


portfolio before change:  [1.79529676]
curr_Stock_Price:  100.0477349387913
curr_Factors:  [100.04773494]
mat_Sqrt:  [[0.15]]
grads:  [0.13316742]
Stock Position:  0.13316741944974547
Bond Position:  [-11.52780192]


portfolio before change:  [1.7308868]
curr_Stock_Price:  99.56946887800189
curr_Factors:  [99.56946888]
mat_Sqrt:  [[0.15]]
grads:  [0.06200178]
Stock Position:  0.062001782712848424
Bond Position:  [-4.44259778]


portfolio before change:  [1.7868205]
curr_Stock_Price:  100.476077878871
curr_Factors:  [100.47607788]
mat_Sqrt:  [[0.15]]
grads:  [0.1007025]
Stock Position:  0.10070249677307878
Bond Position:  [-8.33137141]


portfolio before change:  [1.71187228]
curr_Stock_Price:  99.73699500216732
curr_Factors:  [99.736995]
mat_Sqrt:  [[0.15]]
grads:  [-0.00457383]
Stock Position:  -0.004573834694397856
Bond Position:  [2.16805281]


portfolio before change:  [1.71844565]
curr_Stock_Price:  98.32945316718396
curr_Factors:  [98.32945317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0972688]
Stock Position:  -0.09726880364908592
Bond Position:  [11.28283393]


portfolio before change:  [1.73469317]
curr_Stock_Price:  98.16966585874349
curr_Factors:  [98.16966586]
mat_Sqrt:  [[0.15]]
grads:  [0.03462734]
Stock Position:  0.03462733625106473
Bond Position:  [-1.66466086]


portfolio before change:  [1.73066141]
curr_Stock_Price:  98.0562376931662
curr_Factors:  [98.05623769]
mat_Sqrt:  [[0.15]]
grads:  [-0.04665074]
Stock Position:  -0.04665073662385067
Bond Position:  [6.30505713]


portfolio before change:  [1.76759995]
curr_Stock_Price:  97.27287472690996
curr_Factors:  [97.27287473]
mat_Sqrt:  [[0.15]]
grads:  [0.07100401]
Stock Position:  0.07100401331065526
Bond Position:  [-5.13916454]


portfolio before change:  [1.8006865]
curr_Stock_Price:  97.74337996501401
curr_Factors:  [97.74337997]
mat_Sqrt:  [[0.15]]
grads:  [0.06935693]
Stock Position:  0.0693569340172647
Bond Position:  [-4.97849465]


portfolio before change:  [1.76622217]
curr_Stock_Price:  97.25095381188675
curr_Factors:  [97.25095381]
mat_Sqrt:  [[0.15]]
grads:  [0.03282925]
Stock Position:  0.032829252918890814
Bond Position:  [-1.42645399]


portfolio before change:  [1.76601406]
curr_Stock_Price:  97.24733029327545
curr_Factors:  [97.24733029]
mat_Sqrt:  [[0.15]]
grads:  [0.01370521]
Stock Position:  0.01370521239500827
Bond Position:  [0.43321874]


portfolio before change:  [1.76672873]
curr_Stock_Price:  97.29750065697581
curr_Factors:  [97.29750066]
mat_Sqrt:  [[0.15]]
grads:  [0.05677192]
Stock Position:  0.05677191889486217
Bond Position:  [-3.75703709]


portfolio before change:  [1.7811725]
curr_Stock_Price:  97.55605445862334
curr_Factors:  [97.55605446]
mat_Sqrt:  [[0.15]]
grads:  [0.08357874]
Stock Position:  0.08357874293345578
Bond Position:  [-6.3724399]


portfolio before change:  [1.71353345]
curr_Stock_Price:  96.75153451159079
curr_Factors:  [96.75153451]
mat_Sqrt:  [[0.15]]
grads:  [-0.07014232]
Stock Position:  -0.07014232204138023
Bond Position:  [8.49991074]


portfolio before change:  [1.73449325]
curr_Stock_Price:  96.46029039908376
curr_Factors:  [96.4602904]
mat_Sqrt:  [[0.15]]
grads:  [0.011797]
Stock Position:  0.011797000280529529
Bond Position:  [0.59655117]


portfolio before change:  [1.73086146]
curr_Stock_Price:  96.14927332615254
curr_Factors:  [96.14927333]
mat_Sqrt:  [[0.15]]
grads:  [-0.46293873]
Stock Position:  -0.46293873015287673
Bond Position:  [46.24208396]


portfolio before change:  [1.60080768]
curr_Stock_Price:  96.43644741426141
curr_Factors:  [96.43644741]
mat_Sqrt:  [[0.15]]
grads:  [-0.07879588]
Stock Position:  -0.07879587621205342
Bond Position:  [9.19960205]


portfolio before change:  [1.58603706]
curr_Stock_Price:  96.63119886003253
curr_Factors:  [96.63119886]
mat_Sqrt:  [[0.15]]
grads:  [-0.02263962]
Stock Position:  -0.02263962456040894
Bond Position:  [3.77373112]


portfolio before change:  [1.58134497]
curr_Stock_Price:  96.84886832246565
curr_Factors:  [96.84886832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00517468]
Stock Position:  -0.005174675930864631
Bond Position:  [2.08250648]


portfolio before change:  [1.5780383]
curr_Stock_Price:  97.51303082969315
curr_Factors:  [97.51303083]
mat_Sqrt:  [[0.15]]
grads:  [0.06050962]
Stock Position:  0.060509619194235253
Bond Position:  [-4.32243806]


portfolio before change:  [1.61483836]
curr_Stock_Price:  98.12566429837105
curr_Factors:  [98.1256643]
mat_Sqrt:  [[0.15]]
grads:  [-0.12370922]
Stock Position:  -0.12370921681678644
Bond Position:  [13.75388744]


portfolio before change:  [1.61062246]
curr_Stock_Price:  98.16669231985885
curr_Factors:  [98.16669232]
mat_Sqrt:  [[0.15]]
grads:  [0.00259904]
Stock Position:  0.002599040409022741
Bond Position:  [1.35548326]


portfolio before change:  [1.60837909]
curr_Stock_Price:  97.27094319462176
curr_Factors:  [97.27094319]
mat_Sqrt:  [[0.15]]
grads:  [0.02114548]
Stock Position:  0.02114548190192242
Bond Position:  [-0.44846188]


portfolio before change:  [1.61024806]
curr_Stock_Price:  97.36065486729164
curr_Factors:  [97.36065487]
mat_Sqrt:  [[0.15]]
grads:  [-0.06711727]
Stock Position:  -0.06711727302481282
Bond Position:  [8.14482971]


portfolio before change:  [1.63097099]
curr_Stock_Price:  97.0594826197175
curr_Factors:  [97.05948262]
mat_Sqrt:  [[0.15]]
grads:  [-0.05512638]
Stock Position:  -0.055126380357812074
Bond Position:  [6.98150894]


portfolio before change:  [1.61770481]
curr_Stock_Price:  97.30804845977794
curr_Factors:  [97.30804846]
mat_Sqrt:  [[0.15]]
grads:  [0.03662534]
Stock Position:  0.036625341521979514
Bond Position:  [-1.9462357]


portfolio before change:  [1.59271817]
curr_Stock_Price:  96.62914691607772
curr_Factors:  [96.62914692]
mat_Sqrt:  [[0.15]]
grads:  [0.09182934]
Stock Position:  0.09182933582969975
Bond Position:  [-7.28067222]


portfolio before change:  [1.52775686]
curr_Stock_Price:  95.92668895259156
curr_Factors:  [95.92668895]
mat_Sqrt:  [[0.15]]
grads:  [0.04600847]
Stock Position:  0.04600846693498014
Bond Position:  [-2.88568304]


portfolio before change:  [1.52669231]
curr_Stock_Price:  95.90747095312793
curr_Factors:  [95.90747095]
mat_Sqrt:  [[0.15]]
grads:  [-0.21455133]
Stock Position:  -0.2145513305121096
Bond Position:  [22.10376781]


portfolio before change:  [1.64157256]
curr_Stock_Price:  95.3784659865272
curr_Factors:  [95.37846599]
mat_Sqrt:  [[0.15]]
grads:  [0.05230377]
Stock Position:  0.052303771976442544
Bond Position:  [-3.34708098]


portfolio before change:  [1.65397888]
curr_Stock_Price:  95.6196631060336
curr_Factors:  [95.61966311]
mat_Sqrt:  [[0.15]]
grads:  [-0.26383409]
Stock Position:  -0.26383408748663956
Bond Position:  [26.88170544]


portfolio before change:  [1.87218956]
curr_Stock_Price:  94.79895597263445
curr_Factors:  [94.79895597]
mat_Sqrt:  [[0.15]]
grads:  [-0.0324663]
Stock Position:  -0.03246629571842338
Bond Position:  [4.94996049]


portfolio before change:  [1.91647132]
curr_Stock_Price:  93.4445550872162
curr_Factors:  [93.44455509]
mat_Sqrt:  [[0.15]]
grads:  [-0.10962904]
Stock Position:  -0.10962903802805682
Bond Position:  [12.160708]


portfolio before change:  [2.00402417]
curr_Stock_Price:  92.65285985471228
curr_Factors:  [92.65285985]
mat_Sqrt:  [[0.15]]
grads:  [0.53593614]
Stock Position:  0.5359361375080561
Bond Position:  [-47.65199167]


portfolio before change:  [2.24469317]
curr_Stock_Price:  93.10747995646739
curr_Factors:  [93.10747996]
mat_Sqrt:  [[0.15]]
grads:  [0.15754523]
Stock Position:  0.15754522649585356
Bond Position:  [-12.42394585]


portfolio before change:  [2.20905886]
curr_Stock_Price:  92.88622418377784
curr_Factors:  [92.88622418]
mat_Sqrt:  [[0.15]]
grads:  [0.01581979]
Stock Position:  0.015819791746772047
Bond Position:  [0.73961814]


portfolio before change:  [2.22099648]
curr_Stock_Price:  93.6379021676897
curr_Factors:  [93.63790217]
mat_Sqrt:  [[0.15]]
grads:  [0.08227484]
Stock Position:  0.08227483851995561
Bond Position:  [-5.4830468]


portfolio before change:  [2.24714406]
curr_Stock_Price:  93.95987531236564
curr_Factors:  [93.95987531]
mat_Sqrt:  [[0.15]]
grads:  [0.19657187]
Stock Position:  0.19657187327942496
Bond Position:  [-16.22272464]


portfolio before change:  [2.27664456]
curr_Stock_Price:  94.11510834536045
curr_Factors:  [94.11510835]
mat_Sqrt:  [[0.15]]
grads:  [-0.02266492]
Stock Position:  -0.022664922515402582
Bond Position:  [4.4097562]


portfolio before change:  [2.27681497]
curr_Stock_Price:  94.11975024731416
curr_Factors:  [94.11975025]
mat_Sqrt:  [[0.15]]
grads:  [-0.01267145]
Stock Position:  -0.012671445953971485
Bond Position:  [3.4694483]


portfolio before change:  [2.27278312]
curr_Stock_Price:  94.45504751441051
curr_Factors:  [94.45504751]
mat_Sqrt:  [[0.15]]
grads:  [0.14132857]
Stock Position:  0.14132857159012965
Bond Position:  [-11.07641383]


portfolio before change:  [2.23486531]
curr_Stock_Price:  94.19165060512287
curr_Factors:  [94.19165061]
mat_Sqrt:  [[0.15]]
grads:  [0.04753524]
Stock Position:  0.04753524014797505
Bond Position:  [-2.24255742]


portfolio before change:  [2.24855073]
curr_Stock_Price:  94.48249975993468
curr_Factors:  [94.48249976]
mat_Sqrt:  [[0.15]]
grads:  [0.20379095]
Stock Position:  0.20379095392766705
Bond Position:  [-17.00612803]


portfolio before change:  [2.31170645]
curr_Stock_Price:  94.79761993289489
curr_Factors:  [94.79761993]
mat_Sqrt:  [[0.15]]
grads:  [0.05137406]
Stock Position:  0.051374061483221295
Bond Position:  [-2.5584323]


portfolio before change:  [2.30860458]
curr_Stock_Price:  94.74035442766933
curr_Factors:  [94.74035443]
mat_Sqrt:  [[0.15]]
grads:  [0.00317492]
Stock Position:  0.00317491537366072
Bond Position:  [2.00781198]


portfolio before change:  [2.30682516]
curr_Stock_Price:  94.14036384473096
curr_Factors:  [94.14036384]
mat_Sqrt:  [[0.15]]
grads:  [0.02983365]
Stock Position:  0.029833649986759237
Bond Position:  [-0.50172551]


portfolio before change:  [2.29526749]
curr_Stock_Price:  93.75401125259064
curr_Factors:  [93.75401125]
mat_Sqrt:  [[0.15]]
grads:  [0.02814681]
Stock Position:  0.028146808165966597
Bond Position:  [-0.34360868]


portfolio before change:  [2.3077203]
curr_Stock_Price:  94.19719785808549
curr_Factors:  [94.19719786]
mat_Sqrt:  [[0.15]]
grads:  [0.03192403]
Stock Position:  0.03192403385554834
Bond Position:  [-0.69943423]


portfolio before change:  [2.30490038]
curr_Stock_Price:  94.1102349736442
curr_Factors:  [94.11023497]
mat_Sqrt:  [[0.15]]
grads:  [-0.12536815]
Stock Position:  -0.12536815272608468
Bond Position:  [14.10332669]


portfolio before change:  [2.22831533]
curr_Stock_Price:  94.72814734184074
curr_Factors:  [94.72814734]
mat_Sqrt:  [[0.15]]
grads:  [0.00124013]
Stock Position:  0.0012401284862172167
Bond Position:  [2.11084026]


portfolio before change:  [2.22788491]
curr_Stock_Price:  94.27468311594588
curr_Factors:  [94.27468312]
mat_Sqrt:  [[0.15]]
grads:  [0.01067356]
Stock Position:  0.010673564079753244
Bond Position:  [1.22163804]


portfolio before change:  [2.2300122]
curr_Stock_Price:  94.46683377830169
curr_Factors:  [94.46683378]
mat_Sqrt:  [[0.15]]
grads:  [-0.5103939]
Stock Position:  -0.5103938970625226
Bond Position:  [50.44530763]


portfolio before change:  [2.12660469]
curr_Stock_Price:  94.67561457435264
curr_Factors:  [94.67561457]
mat_Sqrt:  [[0.15]]
grads:  [-0.08306164]
Stock Position:  -0.0830616412025872
Bond Position:  [9.99051661]


portfolio before change:  [2.18206857]
curr_Stock_Price:  94.01538858775834
curr_Factors:  [94.01538859]
mat_Sqrt:  [[0.15]]
grads:  [0.11863731]
Stock Position:  0.11863731466279641
Bond Position:  [-8.97166467]


portfolio before change:  [2.13438294]
curr_Stock_Price:  93.61817058358972
curr_Factors:  [93.61817058]
mat_Sqrt:  [[0.15]]
grads:  [0.1166507]
Stock Position:  0.11665069510040908
Bond Position:  [-8.78624173]


portfolio before change:  [2.0907663]
curr_Stock_Price:  93.24897019888455
curr_Factors:  [93.2489702]
mat_Sqrt:  [[0.15]]
grads:  [-0.13241023]
Stock Position:  -0.13241023266384042
Bond Position:  [14.43788414]


portfolio before change:  [2.11775294]
curr_Stock_Price:  93.05197451450594
curr_Factors:  [93.05197451]
mat_Sqrt:  [[0.15]]
grads:  [-0.032404]
Stock Position:  -0.03240400319815713
Bond Position:  [5.13300942]


portfolio before change:  [2.10740547]
curr_Stock_Price:  93.38120212417302
curr_Factors:  [93.38120212]
mat_Sqrt:  [[0.15]]
grads:  [-0.12372411]
Stock Position:  -0.12372410549708493
Bond Position:  [13.66091118]


portfolio before change:  [2.07515454]
curr_Stock_Price:  93.64877141154598
curr_Factors:  [93.64877141]
mat_Sqrt:  [[0.15]]
grads:  [-0.02547068]
Stock Position:  -0.02547068040711314
Bond Position:  [4.46045246]


portfolio before change:  [2.0708488]
curr_Stock_Price:  93.82876357067332
curr_Factors:  [93.82876357]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511497]
Stock Position:  -0.02511496750207796
Bond Position:  [4.42735515]


portfolio before change:  [2.0692621]
curr_Stock_Price:  93.90295932383906
curr_Factors:  [93.90295932]
mat_Sqrt:  [[0.15]]
grads:  [-0.12496799]
Stock Position:  -0.12496799419816858
Bond Position:  [13.80412657]


portfolio before change:  [2.10831467]
curr_Stock_Price:  93.59736277514831
curr_Factors:  [93.59736278]
mat_Sqrt:  [[0.15]]
grads:  [0.10129496]
Stock Position:  0.10129495896900902
Bond Position:  [-7.37262635]


portfolio before change:  [2.08319141]
curr_Stock_Price:  93.35389109926226
curr_Factors:  [93.3538911]
mat_Sqrt:  [[0.15]]
grads:  [0.07620005]
Stock Position:  0.07620005462747391
Bond Position:  [-5.03038019]


portfolio before change:  [2.09281522]
curr_Stock_Price:  93.48431381847118
curr_Factors:  [93.48431382]
mat_Sqrt:  [[0.15]]
grads:  [0.08499431]
Stock Position:  0.08499430549710889
Bond Position:  [-5.85281911]


portfolio before change:  [2.12923893]
curr_Stock_Price:  93.9171607232815
curr_Factors:  [93.91716072]
mat_Sqrt:  [[0.15]]
grads:  [0.02198653]
Stock Position:  0.02198653442524117
Bond Position:  [0.06432604]


portfolio before change:  [2.12944121]
curr_Stock_Price:  93.92617785155339
curr_Factors:  [93.92617785]
mat_Sqrt:  [[0.15]]
grads:  [0.02493971]
Stock Position:  0.024939714159274363
Bond Position:  [-0.21305082]


portfolio before change:  [2.12860851]
curr_Stock_Price:  93.89332335377027
curr_Factors:  [93.89332335]
mat_Sqrt:  [[0.15]]
grads:  [0.09569762]
Stock Position:  0.0956976220133824
Bond Position:  [-6.85675926]


portfolio before change:  [2.13558986]
curr_Stock_Price:  93.9707537809524
curr_Factors:  [93.97075378]
mat_Sqrt:  [[0.15]]
grads:  [-0.13670639]
Stock Position:  -0.13670638656815387
Bond Position:  [14.98199205]


portfolio before change:  [2.18121501]
curr_Stock_Price:  93.64385791987719
curr_Factors:  [93.64385792]
mat_Sqrt:  [[0.15]]
grads:  [0.03217331]
Stock Position:  0.0321733105720013
Bond Position:  [-0.83161791]


portfolio before change:  [2.15468637]
curr_Stock_Price:  92.82091917523024
curr_Factors:  [92.82091918]
mat_Sqrt:  [[0.15]]
grads:  [0.06216155]
Stock Position:  0.062161546661675685
Bond Position:  [-3.61520553]


portfolio before change:  [2.14324714]
curr_Stock_Price:  92.64052991448155
curr_Factors:  [92.64052991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.14324714]
Stock Price:  92.0491317375463
PL:  [2.14324714]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.34828394e-03]
 [ 2.95925471e-03]
 [-3.24602677e-03]
 [ 7.51612116e-03]
 [ 5.82253089e-03]
 [ 2.72702115e-02]
 [ 1.11607536e-03]
 [-5.89846131e-03]
 [ 2.46547371e-02]
 [-4.90078414e-03]
 [ 4.45224576e-02]
 [ 3.68719101e-02]
 [ 1.05750092e-01]
 [ 1.20697536e-02]
 [-6.89997260e-03]
 [ 2.51234062e-02]
 [ 1.06615453e-02]
 [-1.10331389e-02]
 [ 7.72202032e-04]
 [ 6.24150988e-03]
 [ 1.17412538e-02]
 [-7.86991022e-03]
 [ 8.03890502e-03]
 [ 9.10397732e-03]
 [-9.93523114e-03]
 [-6.44494396e-03]
 [-5.15979018e-04]
 [ 1.08798992e-02]
 [-4.61503496e-02]
 [ 4.74284973e-03]
 [ 7.86875014e-03]
 [-1.00740399e-02]
 [-9.04507287e-03]
 [ 5.39583030e-03]
 [ 1.26752845e-02]
 [ 1.73005638e-02]
 [-3.46509223e-02]
 [ 8.86588673e-03]
 [-2.11894177e-02]
 [ 2.07115308e-02]
 [-8.15276509e-03]
 [ 1.76133666e-02]
 [ 2.31196645e-02]
 [ 4.19138870e-03]
 [ 6.66542840e-04]
 [-6.15869085e-03]
 [ 7.00052432e-04]
 [-1.23542850e-02]
 [-9.55820838e-03]
 [-6.21198866e-03]
 [ 4.60583608e-02]
 [-9.06918044e-03]
 [ 2.31321395e-03]
 [ 5.29252045e-03]
 [ 4.54042597e-03]
 [-3.55401449e-03]
 [ 4.55617069e-03]
 [-3.69423126e-04]
 [ 1.55558878e-03]
 [ 5.98875167e-04]
 [ 6.61703009e-04]
 [-1.19665778e-02]
 [-7.41365802e-03]
 [-1.66674449e-02]
 [-1.32791952e-02]
 [ 1.25823439e-03]
 [-5.16064334e-03]
 [ 1.82288367e-02]
 [-8.33116454e-03]
 [ 8.82323823e-03]
 [-1.10000949e-02]
 [ 1.12154752e-02]
 [-3.83291379e-03]
 [ 1.85383153e-02]
 [-2.24881724e-02]
 [-3.94537296e-03]
 [-8.50058475e-03]
 [-2.01198509e-03]
 [ 2.92743467e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.86749468]
curr_Stock_Price:  99.68078783184569
curr_Factors:  [99.68078783]
mat_Sqrt:  [[0.15]]
grads:  [0.02232189]
Stock Position:  0.022321892917718345
Bond Position:  [-5.09255855]


portfolio before change:  [-2.85876676]
curr_Stock_Price:  100.08604999546255
curr_Factors:  [100.08605]
mat_Sqrt:  [[0.15]]
grads:  [0.01972836]
Stock Position:  0.01972836470681058
Bond Position:  [-4.83330085]


portfolio before change:  [-2.84688463]
curr_Stock_Price:  100.70364883146826
curr_Factors:  [100.70364883]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164018]
Stock Position:  -0.02164017846731529
Bond Position:  [-0.6676397]


portfolio before change:  [-2.83267957]
curr_Stock_Price:  100.04529989292887
curr_Factors:  [100.04529989]
mat_Sqrt:  [[0.15]]
grads:  [0.05010747]
Stock Position:  0.0501074743974997
Bond Position:  [-7.84569688]


portfolio before change:  [-2.80275087]
curr_Stock_Price:  100.65237646131722
curr_Factors:  [100.65237646]
mat_Sqrt:  [[0.15]]
grads:  [0.03881687]
Stock Position:  0.0388168726056291
Bond Position:  [-6.70976135]


portfolio before change:  [-2.76847699]
curr_Stock_Price:  101.54614392581952
curr_Factors:  [101.54614393]
mat_Sqrt:  [[0.15]]
grads:  [0.18180141]
Stock Position:  0.1818014100228443
Bond Position:  [-21.22970913]


portfolio before change:  [-2.93011401]
curr_Stock_Price:  100.66435688605992
curr_Factors:  [100.66435689]
mat_Sqrt:  [[0.15]]
grads:  [0.0074405]
Stock Position:  0.00744050239461707
Bond Position:  [-3.6791074]


portfolio before change:  [-2.92726508]
curr_Stock_Price:  101.07815719155951
curr_Factors:  [101.07815719]
mat_Sqrt:  [[0.15]]
grads:  [-0.03932308]
Stock Position:  -0.039323075404173
Bond Position:  [1.04743892]


portfolio before change:  [-2.95796292]
curr_Stock_Price:  101.86047917063277
curr_Factors:  [101.86047917]
mat_Sqrt:  [[0.15]]
grads:  [0.16436491]
Stock Position:  0.16436491419021954
Bond Position:  [-19.70025184]


portfolio before change:  [-2.86968735]
curr_Stock_Price:  102.40504108450034
curr_Factors:  [102.40504108]
mat_Sqrt:  [[0.15]]
grads:  [-0.03267189]
Stock Position:  -0.03267189429659043
Bond Position:  [0.47607933]


portfolio before change:  [-2.88202822]
curr_Stock_Price:  102.78367302883993
curr_Factors:  [102.78367303]
mat_Sqrt:  [[0.15]]
grads:  [0.29681638]
Stock Position:  0.2968163839416265
Bond Position:  [-33.38990638]


portfolio before change:  [-2.81628457]
curr_Stock_Price:  103.0122001332921
curr_Factors:  [103.01220013]
mat_Sqrt:  [[0.15]]
grads:  [0.24581273]
Stock Position:  0.24581273413936933
Bond Position:  [-28.13799513]


portfolio before change:  [-2.80457859]
curr_Stock_Price:  103.06697620788897
curr_Factors:  [103.06697621]
mat_Sqrt:  [[0.15]]
grads:  [0.70500061]
Stock Position:  0.7050006137928727
Bond Position:  [-75.46686008]


portfolio before change:  [-3.11425496]
curr_Stock_Price:  102.63440985382908
curr_Factors:  [102.63440985]
mat_Sqrt:  [[0.15]]
grads:  [0.08046502]
Stock Position:  0.08046502401292395
Bond Position:  [-11.37273521]


portfolio before change:  [-3.12726655]
curr_Stock_Price:  102.48153886296741
curr_Factors:  [102.48153886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599982]
Stock Position:  -0.0459998173581387
Bond Position:  [1.58686552]


portfolio before change:  [-3.10735337]
curr_Stock_Price:  102.05079813044777
curr_Factors:  [102.05079813]
mat_Sqrt:  [[0.15]]
grads:  [0.16748937]
Stock Position:  0.1674893748584379
Bond Position:  [-20.19977775]


portfolio before change:  [-3.20772055]
curr_Stock_Price:  101.45909103521016
curr_Factors:  [101.45909104]
mat_Sqrt:  [[0.15]]
grads:  [0.07107697]
Stock Position:  0.07107696884018326
Bond Position:  [-10.4191252]


portfolio before change:  [-3.20906953]
curr_Stock_Price:  101.44927397962529
curr_Factors:  [101.44927398]
mat_Sqrt:  [[0.15]]
grads:  [-0.07355426]
Stock Position:  -0.07355425910476518
Bond Position:  [4.25295666]


portfolio before change:  [-3.21613502]
curr_Stock_Price:  101.54894615406747
curr_Factors:  [101.54894615]
mat_Sqrt:  [[0.15]]
grads:  [0.00514801]
Stock Position:  0.0051480135478553166
Bond Position:  [-3.73891037]


portfolio before change:  [-3.22170801]
curr_Stock_Price:  100.51178826661203
curr_Factors:  [100.51178827]
mat_Sqrt:  [[0.15]]
grads:  [0.04161007]
Stock Position:  0.04161006588996654
Bond Position:  [-7.40401015]


portfolio before change:  [-3.22748428]
curr_Stock_Price:  100.38409080582741
curr_Factors:  [100.38409081]
mat_Sqrt:  [[0.15]]
grads:  [0.07827503]
Stock Position:  0.07827502555736872
Bond Position:  [-11.08505155]


portfolio before change:  [-3.3084014]
curr_Stock_Price:  99.35918817861018
curr_Factors:  [99.35918818]
mat_Sqrt:  [[0.15]]
grads:  [-0.05246607]
Stock Position:  -0.05246606812038315
Bond Position:  [1.90458454]


portfolio before change:  [-3.29609777]
curr_Stock_Price:  99.12695076969983
curr_Factors:  [99.12695077]
mat_Sqrt:  [[0.15]]
grads:  [0.0535927]
Stock Position:  0.053592700152811014
Bond Position:  [-8.60857872]


portfolio before change:  [-3.32555366]
curr_Stock_Price:  98.58736548889048
curr_Factors:  [98.58736549]
mat_Sqrt:  [[0.15]]
grads:  [0.06069318]
Stock Position:  0.060693182146364565
Bond Position:  [-9.30913459]


portfolio before change:  [-3.39088884]
curr_Stock_Price:  97.52046906247513
curr_Factors:  [97.52046906]
mat_Sqrt:  [[0.15]]
grads:  [-0.06623487]
Stock Position:  -0.06623487428664797
Bond Position:  [3.06836717]


portfolio before change:  [-3.3849559]
curr_Stock_Price:  97.43379030196718
curr_Factors:  [97.4337903]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296629]
Stock Position:  -0.042966293090565454
Bond Position:  [0.80141289]


portfolio before change:  [-3.35435854]
curr_Stock_Price:  96.72283134653226
curr_Factors:  [96.72283135]
mat_Sqrt:  [[0.15]]
grads:  [-0.00343986]
Stock Position:  -0.003439860123091576
Bond Position:  [-3.02164553]


portfolio before change:  [-3.35331646]
curr_Stock_Price:  96.36498727813147
curr_Factors:  [96.36498728]
mat_Sqrt:  [[0.15]]
grads:  [0.07253266]
Stock Position:  0.07253266136844568
Bond Position:  [-10.34292545]


portfolio before change:  [-3.35943357]
curr_Stock_Price:  96.28956396726868
curr_Factors:  [96.28956397]
mat_Sqrt:  [[0.15]]
grads:  [-0.307669]
Stock Position:  -0.30766899738664794
Bond Position:  [26.26588003]


portfolio before change:  [-3.31923494]
curr_Stock_Price:  96.16424434780204
curr_Factors:  [96.16424435]
mat_Sqrt:  [[0.15]]
grads:  [0.031619]
Stock Position:  0.03161899822766245
Bond Position:  [-6.35985201]


portfolio before change:  [-3.31073785]
curr_Stock_Price:  96.44554982419965
curr_Factors:  [96.44554982]
mat_Sqrt:  [[0.15]]
grads:  [0.05245833]
Stock Position:  0.05245833424146008
Bond Position:  [-8.37011073]


portfolio before change:  [-3.26056906]
curr_Stock_Price:  97.41187741165325
curr_Factors:  [97.41187741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06716027]
Stock Position:  -0.06716026575832494
Bond Position:  [3.28163852]


portfolio before change:  [-3.27190858]
curr_Stock_Price:  97.58377419073064
curr_Factors:  [97.58377419]
mat_Sqrt:  [[0.15]]
grads:  [-0.06030049]
Stock Position:  -0.060300485789390436
Bond Position:  [2.61244041]


portfolio before change:  [-3.27012497]
curr_Stock_Price:  97.55690320982369
curr_Factors:  [97.55690321]
mat_Sqrt:  [[0.15]]
grads:  [0.0359722]
Stock Position:  0.03597220202319212
Bond Position:  [-6.7794616]


portfolio before change:  [-3.23564425]
curr_Stock_Price:  98.52722054089334
curr_Factors:  [98.52722054]
mat_Sqrt:  [[0.15]]
grads:  [0.0845019]
Stock Position:  0.08450189640059612
Bond Position:  [-11.56138123]


portfolio before change:  [-3.26592758]
curr_Stock_Price:  98.177397286762
curr_Factors:  [98.17739729]
mat_Sqrt:  [[0.15]]
grads:  [0.11533709]
Stock Position:  0.11533709199586538
Bond Position:  [-14.58942309]


portfolio before change:  [-3.256987]
curr_Stock_Price:  98.26282037443315
curr_Factors:  [98.26282037]
mat_Sqrt:  [[0.15]]
grads:  [-0.23100615]
Stock Position:  -0.23100614863433427
Bond Position:  [19.44232869]


portfolio before change:  [-3.21185115]
curr_Stock_Price:  98.07269267632655
curr_Factors:  [98.07269268]
mat_Sqrt:  [[0.15]]
grads:  [0.05910591]
Stock Position:  0.05910591151101703
Bond Position:  [-9.00852704]


portfolio before change:  [-3.21887801]
curr_Stock_Price:  97.96333296544334
curr_Factors:  [97.96333297]
mat_Sqrt:  [[0.15]]
grads:  [-0.14126278]
Stock Position:  -0.1412627843395427
Bond Position:  [10.61969517]


portfolio before change:  [-3.23100214]
curr_Stock_Price:  98.05385845891206
curr_Factors:  [98.05385846]
mat_Sqrt:  [[0.15]]
grads:  [0.13807687]
Stock Position:  0.1380768722607316
Bond Position:  [-16.76997223]


portfolio before change:  [-3.27338932]
curr_Stock_Price:  97.75446707491993
curr_Factors:  [97.75446707]
mat_Sqrt:  [[0.15]]
grads:  [-0.05435177]
Stock Position:  -0.05435176727159162
Bond Position:  [2.03973873]


portfolio before change:  [-3.27603315]
curr_Stock_Price:  97.80545556208689
curr_Factors:  [97.80545556]
mat_Sqrt:  [[0.15]]
grads:  [0.11742244]
Stock Position:  0.11742244406175477
Bond Position:  [-14.76058878]


portfolio before change:  [-3.36100173]
curr_Stock_Price:  97.0896978560656
curr_Factors:  [97.08969786]
mat_Sqrt:  [[0.15]]
grads:  [0.1541311]
Stock Position:  0.1541310967656689
Bond Position:  [-18.32554335]


portfolio before change:  [-3.32747436]
curr_Stock_Price:  97.31465408935728
curr_Factors:  [97.31465409]
mat_Sqrt:  [[0.15]]
grads:  [0.02794259]
Stock Position:  0.027942591318406183
Bond Position:  [-6.04669797]


portfolio before change:  [-3.32023734]
curr_Stock_Price:  97.58717530199814
curr_Factors:  [97.5871753]
mat_Sqrt:  [[0.15]]
grads:  [0.00444362]
Stock Position:  0.0044436189319483396
Bond Position:  [-3.75387756]


portfolio before change:  [-3.31567062]
curr_Stock_Price:  98.66767899767235
curr_Factors:  [98.667679]
mat_Sqrt:  [[0.15]]
grads:  [-0.04105794]
Stock Position:  -0.04105793900441939
Bond Position:  [0.73542092]


portfolio before change:  [-3.30879667]
curr_Stock_Price:  98.50137765571205
curr_Factors:  [98.50137766]
mat_Sqrt:  [[0.15]]
grads:  [0.00466702]
Stock Position:  0.004667016212975816
Bond Position:  [-3.76850419]


portfolio before change:  [-3.30865254]
curr_Stock_Price:  98.5827284123032
curr_Factors:  [98.58272841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0823619]
Stock Position:  -0.08236190015247244
Bond Position:  [4.8108083]


portfolio before change:  [-3.31981464]
curr_Stock_Price:  98.72190420124468
curr_Factors:  [98.7219042]
mat_Sqrt:  [[0.15]]
grads:  [-0.06372139]
Stock Position:  -0.0637213891928934
Bond Position:  [2.97088224]


portfolio before change:  [-3.37868537]
curr_Stock_Price:  99.6486953030517
curr_Factors:  [99.6486953]
mat_Sqrt:  [[0.15]]
grads:  [-0.04141326]
Stock Position:  -0.04141325773338391
Bond Position:  [0.74809173]


portfolio before change:  [-3.39260115]
curr_Stock_Price:  99.98584664406047
curr_Factors:  [99.98584664]
mat_Sqrt:  [[0.15]]
grads:  [0.30705574]
Stock Position:  0.3070557387705266
Bond Position:  [-34.09382915]


portfolio before change:  [-3.40286196]
curr_Stock_Price:  99.95936972874937
curr_Factors:  [99.95936973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0604612]
Stock Position:  -0.060461202964777055
Bond Position:  [2.64080178]


portfolio before change:  [-3.41222482]
curr_Stock_Price:  100.1169569317098
curr_Factors:  [100.11695693]
mat_Sqrt:  [[0.15]]
grads:  [0.01542143]
Stock Position:  0.015421426348662868
Bond Position:  [-4.9561711]


portfolio before change:  [-3.40066536]
curr_Stock_Price:  100.88661542378787
curr_Factors:  [100.88661542]
mat_Sqrt:  [[0.15]]
grads:  [0.03528347]
Stock Position:  0.03528346968082681
Bond Position:  [-6.9602952]


portfolio before change:  [-3.40076409]
curr_Stock_Price:  100.89614692394481
curr_Factors:  [100.89614692]
mat_Sqrt:  [[0.15]]
grads:  [0.03026951]
Stock Position:  0.030269506469723866
Bond Position:  [-6.45484066]


portfolio before change:  [-3.41017913]
curr_Stock_Price:  100.59843454107329
curr_Factors:  [100.59843454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369343]
Stock Position:  -0.023693429946679986
Bond Position:  [-1.02665717]


portfolio before change:  [-3.40588844]
curr_Stock_Price:  100.4146340130342
curr_Factors:  [100.41463401]
mat_Sqrt:  [[0.15]]
grads:  [0.03037447]
Stock Position:  0.030374471259313612
Bond Position:  [-6.45592985]


portfolio before change:  [-3.39635615]
curr_Stock_Price:  100.74174415814936
curr_Factors:  [100.74174416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00246282]
Stock Position:  -0.002462820840999232
Bond Position:  [-3.14824728]


portfolio before change:  [-3.39501446]
curr_Stock_Price:  100.11706851634784
curr_Factors:  [100.11706852]
mat_Sqrt:  [[0.15]]
grads:  [0.01037059]
Stock Position:  0.010370591862392453
Bond Position:  [-4.43328771]


portfolio before change:  [-3.39098993]
curr_Stock_Price:  100.53185839227783
curr_Factors:  [100.53185839]
mat_Sqrt:  [[0.15]]
grads:  [0.0039925]
Stock Position:  0.003992501111434085
Bond Position:  [-3.79236348]


portfolio before change:  [-3.3891743]
curr_Stock_Price:  101.0459881079519
curr_Factors:  [101.04598811]
mat_Sqrt:  [[0.15]]
grads:  [0.00441135]
Stock Position:  0.0044113533940220535
Bond Position:  [-3.83492386]


portfolio before change:  [-3.39099227]
curr_Stock_Price:  100.68821101845923
curr_Factors:  [100.68821102]
mat_Sqrt:  [[0.15]]
grads:  [-0.07977719]
Stock Position:  -0.07977718521414187
Bond Position:  [4.64162979]


portfolio before change:  [-3.33302811]
curr_Stock_Price:  99.96527187797652
curr_Factors:  [99.96527188]
mat_Sqrt:  [[0.15]]
grads:  [-0.04942439]
Stock Position:  -0.049424386832830486
Bond Position:  [1.60769416]


portfolio before change:  [-3.3066081]
curr_Stock_Price:  99.43275088195564
curr_Factors:  [99.43275088]
mat_Sqrt:  [[0.15]]
grads:  [-0.1111163]
Stock Position:  -0.11111629953981884
Bond Position:  [7.74199123]


portfolio before change:  [-3.29525402]
curr_Stock_Price:  99.33492376376834
curr_Factors:  [99.33492376]
mat_Sqrt:  [[0.15]]
grads:  [-0.08852797]
Stock Position:  -0.0885279679495627
Bond Position:  [5.49866493]


portfolio before change:  [-3.32506714]
curr_Stock_Price:  99.67557081506473
curr_Factors:  [99.67557082]
mat_Sqrt:  [[0.15]]
grads:  [0.00838823]
Stock Position:  0.008388229293041621
Bond Position:  [-4.16116868]


portfolio before change:  [-3.32580367]
curr_Stock_Price:  99.61877052184339
curr_Factors:  [99.61877052]
mat_Sqrt:  [[0.15]]
grads:  [-0.03440429]
Stock Position:  -0.0344042889014436
Bond Position:  [0.10150929]


portfolio before change:  [-3.38468707]
curr_Stock_Price:  101.3304682110634
curr_Factors:  [101.33046821]
mat_Sqrt:  [[0.15]]
grads:  [0.12152558]
Stock Position:  0.12152557785885895
Bond Position:  [-15.69893077]


portfolio before change:  [-3.33560812]
curr_Stock_Price:  101.74239925553782
curr_Factors:  [101.74239926]
mat_Sqrt:  [[0.15]]
grads:  [-0.0555411]
Stock Position:  -0.055541096957971124
Bond Position:  [2.31527634]


portfolio before change:  [-3.29004072]
curr_Stock_Price:  100.92457784538237
curr_Factors:  [100.92457785]
mat_Sqrt:  [[0.15]]
grads:  [0.05882159]
Stock Position:  0.05882158823103243
Bond Position:  [-9.22658468]


portfolio before change:  [-3.28552851]
curr_Stock_Price:  101.01109179224603
curr_Factors:  [101.01109179]
mat_Sqrt:  [[0.15]]
grads:  [-0.07333397]
Stock Position:  -0.07333396625831767
Bond Position:  [4.12201549]


portfolio before change:  [-3.29540872]
curr_Stock_Price:  101.14933393469981
curr_Factors:  [101.14933393]
mat_Sqrt:  [[0.15]]
grads:  [0.07476983]
Stock Position:  0.07476983471867735
Bond Position:  [-10.8583277]


portfolio before change:  [-3.26475424]
curr_Stock_Price:  101.56839530017217
curr_Factors:  [101.5683953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02555276]
Stock Position:  -0.025552758588481772
Bond Position:  [-0.66940155]


portfolio before change:  [-3.26257018]
curr_Stock_Price:  101.48128553846101
curr_Factors:  [101.48128554]
mat_Sqrt:  [[0.15]]
grads:  [0.12358877]
Stock Position:  0.1235887688680648
Bond Position:  [-15.80451732]


portfolio before change:  [-3.3284436]
curr_Stock_Price:  100.95627335433466
curr_Factors:  [100.95627335]
mat_Sqrt:  [[0.15]]
grads:  [-0.14992115]
Stock Position:  -0.14992114908035478
Bond Position:  [11.80703691]


portfolio before change:  [-3.36049612]
curr_Stock_Price:  101.17499155936169
curr_Factors:  [101.17499156]
mat_Sqrt:  [[0.15]]
grads:  [-0.02630249]
Stock Position:  -0.026302486369192548
Bond Position:  [-0.69934229]


portfolio before change:  [-3.34849713]
curr_Stock_Price:  100.71713726015771
curr_Factors:  [100.71713726]
mat_Sqrt:  [[0.15]]
grads:  [-0.05667056]
Stock Position:  -0.056670564982934775
Bond Position:  [2.35919994]


portfolio before change:  [-3.31138477]
curr_Stock_Price:  100.0648603330241
curr_Factors:  [100.06486033]
mat_Sqrt:  [[0.15]]
grads:  [-0.01341323]
Stock Position:  -0.01341323392851623
Bond Position:  [-1.96919139]


portfolio before change:  [-3.31335034]
curr_Stock_Price:  100.20222371009044
curr_Factors:  [100.20222371]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.31335034]
Stock Price:  100.69199827246707
PL:  [-4.00534861]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.74066880e-03]
 [-4.12855627e-02]
 [-7.13837417e-03]
 [ 5.23331457e-03]
 [-1.11922779e-04]
 [ 1.60553829e-02]
 [ 2.00072635e-03]
 [-2.11201957e-02]
 [-3.83121915e-03]
 [ 1.66120181e-03]
 [ 1.59208670e-02]
 [-2.88887385e-02]
 [ 3.28964853e-03]
 [ 2.57536297e-03]
 [-6.91541291e-03]
 [ 1.33374283e-02]
 [ 7.83616391e-03]
 [-1.23000453e-02]
 [-4.96400341e-04]
 [ 9.28793245e-03]
 [ 1.18889531e-02]
 [-7.77438898e-03]
 [ 6.83269252e-03]
 [ 4.39507337e-02]
 [-2.34390087e-04]
 [ 1.38612960e-02]
 [-7.21391485e-03]
 [ 5.91972074e-03]
 [ 6.64707980e-03]
 [-2.96107005e-03]
 [ 8.68992796e-03]
 [-1.18602429e-02]
 [ 9.59165575e-03]
 [ 7.74288005e-03]
 [ 1.14984320e-02]
 [ 1.37106795e-02]
 [-3.49730039e-02]
 [ 9.67617277e-03]
 [-1.26089068e-02]
 [ 2.48668413e-02]
 [-6.58380880e-03]
 [-1.44514637e-02]
 [ 2.35043207e-02]
 [ 3.62121487e-03]
 [-8.07010705e-03]
 [-4.48784252e-03]
 [ 2.75894872e-04]
 [-1.24149713e-02]
 [-1.52346700e-02]
 [-6.15670117e-03]
 [ 4.69573204e-02]
 [-9.56095886e-03]
 [ 2.91092960e-03]
 [ 5.39986280e-03]
 [ 5.19557298e-03]
 [-1.34557141e-03]
 [ 3.97920988e-03]
 [-3.19939646e-04]
 [ 1.55566510e-03]
 [-1.74861404e-03]
 [ 1.04307359e-03]
 [-1.12645121e-02]
 [-4.38468956e-03]
 [-1.64134003e-02]
 [-1.20625605e-02]
 [-4.27700917e-03]
 [-4.83996908e-03]
 [ 2.27529413e-02]
 [-8.45772022e-03]
 [ 6.63948181e-03]
 [-9.52541947e-03]
 [ 1.06976613e-02]
 [-5.33451504e-03]
 [ 1.61695053e-02]
 [-2.18360392e-02]
 [-4.27209491e-03]
 [-1.06822904e-02]
 [-1.48974050e-03]
 [ 1.38182923e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.98381024]
curr_Stock_Price:  99.02297482875375
curr_Factors:  [99.02297483]
mat_Sqrt:  [[0.15]]
grads:  [0.05160446]
Stock Position:  0.05160445864105073
Bond Position:  [-18.09383725]


portfolio before change:  [-13.02736479]
curr_Stock_Price:  98.20088204418983
curr_Factors:  [98.20088204]
mat_Sqrt:  [[0.15]]
grads:  [-0.27523708]
Stock Position:  -0.27523708469693026
Bond Position:  [14.0011597]


portfolio before change:  [-13.07164927]
curr_Stock_Price:  98.36495724431548
curr_Factors:  [98.36495724]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758916]
Stock Position:  -0.0475891611091615
Bond Position:  [-8.39054347]


portfolio before change:  [-13.06648054]
curr_Stock_Price:  98.24532595353264
curr_Factors:  [98.24532595]
mat_Sqrt:  [[0.15]]
grads:  [0.03488876]
Stock Position:  0.03488876381631572
Bond Position:  [-16.49413852]


portfolio before change:  [-13.04393495]
curr_Stock_Price:  98.92108822173293
curr_Factors:  [98.92108822]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074615]
Stock Position:  -0.0007461518569119227
Bond Position:  [-12.97012479]


portfolio before change:  [-13.04458169]
curr_Stock_Price:  98.7014080105896
curr_Factors:  [98.70140801]
mat_Sqrt:  [[0.15]]
grads:  [0.10703589]
Stock Position:  0.10703588590581944
Bond Position:  [-23.60917434]


portfolio before change:  [-13.04737902]
curr_Stock_Price:  98.6890596852228
curr_Factors:  [98.68905969]
mat_Sqrt:  [[0.15]]
grads:  [0.01333818]
Stock Position:  0.013338175690623415
Bond Position:  [-14.36371104]


portfolio before change:  [-13.04934898]
curr_Stock_Price:  98.60867399681752
curr_Factors:  [98.608674]
mat_Sqrt:  [[0.15]]
grads:  [-0.1408013]
Stock Position:  -0.14080130453038003
Bond Position:  [0.83488095]


portfolio before change:  [-13.02623201]
curr_Stock_Price:  98.4448631049199
curr_Factors:  [98.4448631]
mat_Sqrt:  [[0.15]]
grads:  [-0.02554146]
Stock Position:  -0.02554146098828839
Bond Position:  [-10.51180638]


portfolio before change:  [-13.06021944]
curr_Stock_Price:  99.74981646299565
curr_Factors:  [99.74981646]
mat_Sqrt:  [[0.15]]
grads:  [0.01107468]
Stock Position:  0.011074678756681177
Bond Position:  [-14.16491661]


portfolio before change:  [-13.05071175]
curr_Stock_Price:  100.68826595786588
curr_Factors:  [100.68826596]
mat_Sqrt:  [[0.15]]
grads:  [0.10613911]
Stock Position:  0.10613911329863893
Bond Position:  [-23.73767501]


portfolio before change:  [-13.03018341]
curr_Stock_Price:  100.89565403154675
curr_Factors:  [100.89565403]
mat_Sqrt:  [[0.15]]
grads:  [-0.19259159]
Stock Position:  -0.19259158992500647
Bond Position:  [6.40147102]


portfolio before change:  [-12.92448227]
curr_Stock_Price:  100.34889582607904
curr_Factors:  [100.34889583]
mat_Sqrt:  [[0.15]]
grads:  [0.02193099]
Stock Position:  0.021930990179672243
Bond Position:  [-15.12523292]


portfolio before change:  [-12.91037155]
curr_Stock_Price:  101.03541679151112
curr_Factors:  [101.03541679]
mat_Sqrt:  [[0.15]]
grads:  [0.01716909]
Stock Position:  0.01716908649623676
Bond Position:  [-14.64505736]


portfolio before change:  [-12.92022326]
curr_Stock_Price:  100.51492497577983
curr_Factors:  [100.51492498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610275]
Stock Position:  -0.046102752733753964
Bond Position:  [-8.28620853]


portfolio before change:  [-12.90913592]
curr_Stock_Price:  100.26319944003968
curr_Factors:  [100.26319944]
mat_Sqrt:  [[0.15]]
grads:  [0.08891619]
Stock Position:  0.08891618885311185
Bond Position:  [-21.8241575]


portfolio before change:  [-12.91330315]
curr_Stock_Price:  100.231673368036
curr_Factors:  [100.23167337]
mat_Sqrt:  [[0.15]]
grads:  [0.05224109]
Stock Position:  0.05224109275107011
Bond Position:  [-18.1495153]


portfolio before change:  [-12.91643579]
curr_Stock_Price:  100.19342281235099
curr_Factors:  [100.19342281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0820003]
Stock Position:  -0.08200030220867369
Bond Position:  [-4.70054484]


portfolio before change:  [-12.84708746]
curr_Stock_Price:  99.34413181551491
curr_Factors:  [99.34413182]
mat_Sqrt:  [[0.15]]
grads:  [-0.00330934]
Stock Position:  -0.0033093356046312874
Bond Position:  [-12.51832439]


portfolio before change:  [-12.85115124]
curr_Stock_Price:  100.33567967682237
curr_Factors:  [100.33567968]
mat_Sqrt:  [[0.15]]
grads:  [0.06191955]
Stock Position:  0.06191954969460754
Bond Position:  [-19.06389135]


portfolio before change:  [-12.84016404]
curr_Stock_Price:  100.53236612149875
curr_Factors:  [100.53236612]
mat_Sqrt:  [[0.15]]
grads:  [0.07925969]
Stock Position:  0.0792596873867733
Bond Position:  [-20.80832795]


portfolio before change:  [-12.86722948]
curr_Stock_Price:  100.20729696487565
curr_Factors:  [100.20729696]
mat_Sqrt:  [[0.15]]
grads:  [-0.05182926]
Stock Position:  -0.051829259843199575
Bond Position:  [-7.67355945]


portfolio before change:  [-12.866018]
curr_Stock_Price:  100.17466883321268
curr_Factors:  [100.17466883]
mat_Sqrt:  [[0.15]]
grads:  [0.04555128]
Stock Position:  0.04555128346236395
Bond Position:  [-17.42910274]


portfolio before change:  [-12.85346579]
curr_Stock_Price:  100.47414587108933
curr_Factors:  [100.47414587]
mat_Sqrt:  [[0.15]]
grads:  [0.29300489]
Stock Position:  0.2930048911803947
Bond Position:  [-42.29288197]


portfolio before change:  [-12.84027132]
curr_Stock_Price:  100.52819909323416
curr_Factors:  [100.52819909]
mat_Sqrt:  [[0.15]]
grads:  [-0.0015626]
Stock Position:  -0.0015626005803268696
Bond Position:  [-12.6831859]


portfolio before change:  [-12.84060907]
curr_Stock_Price:  100.23703212771521
curr_Factors:  [100.23703213]
mat_Sqrt:  [[0.15]]
grads:  [0.09240864]
Stock Position:  0.09240864031928286
Bond Position:  [-22.10337691]


portfolio before change:  [-12.86730137]
curr_Stock_Price:  99.96313136404724
curr_Factors:  [99.96313136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04809277]
Stock Position:  -0.04809276566552332
Bond Position:  [-8.05979791]


portfolio before change:  [-12.88658547]
curr_Stock_Price:  100.35363400235524
curr_Factors:  [100.353634]
mat_Sqrt:  [[0.15]]
grads:  [0.0394648]
Stock Position:  0.03946480491509938
Bond Position:  [-16.84702206]


portfolio before change:  [-12.87863116]
curr_Stock_Price:  100.58186987941744
curr_Factors:  [100.58186988]
mat_Sqrt:  [[0.15]]
grads:  [0.04431387]
Stock Position:  0.04431386534944726
Bond Position:  [-17.3358026]


portfolio before change:  [-12.86727138]
curr_Stock_Price:  100.86266921193618
curr_Factors:  [100.86266921]
mat_Sqrt:  [[0.15]]
grads:  [-0.01974047]
Stock Position:  -0.019740466967034357
Bond Position:  [-10.87619519]


portfolio before change:  [-12.871621]
curr_Stock_Price:  101.04857358676153
curr_Factors:  [101.04857359]
mat_Sqrt:  [[0.15]]
grads:  [0.05793285]
Stock Position:  0.05793285304123473
Bond Position:  [-18.72565316]


portfolio before change:  [-12.83954061]
curr_Stock_Price:  101.62252743120335
curr_Factors:  [101.62252743]
mat_Sqrt:  [[0.15]]
grads:  [-0.07906829]
Stock Position:  -0.07906828586939375
Bond Position:  [-4.80442156]


portfolio before change:  [-12.80492482]
curr_Stock_Price:  101.18093357438073
curr_Factors:  [101.18093357]
mat_Sqrt:  [[0.15]]
grads:  [0.06394437]
Stock Position:  0.06394437169279905
Bond Position:  [-19.27487605]


portfolio before change:  [-12.80379473]
curr_Stock_Price:  101.21744669388528
curr_Factors:  [101.21744669]
mat_Sqrt:  [[0.15]]
grads:  [0.0516192]
Stock Position:  0.05161920035235017
Bond Position:  [-18.02855839]


portfolio before change:  [-12.84874729]
curr_Stock_Price:  100.36842658168499
curr_Factors:  [100.36842658]
mat_Sqrt:  [[0.15]]
grads:  [0.07665621]
Stock Position:  0.0766562130376544
Bond Position:  [-20.54261078]


portfolio before change:  [-12.92341312]
curr_Stock_Price:  99.41114117036696
curr_Factors:  [99.41114117]
mat_Sqrt:  [[0.15]]
grads:  [0.09140453]
Stock Position:  0.09140453012284526
Bond Position:  [-22.01004177]


portfolio before change:  [-12.89388698]
curr_Stock_Price:  99.7492186331127
curr_Factors:  [99.74921863]
mat_Sqrt:  [[0.15]]
grads:  [-0.23315336]
Stock Position:  -0.23315335949290553
Bond Position:  [10.36297845]


portfolio before change:  [-12.96593778]
curr_Stock_Price:  100.06102415791833
curr_Factors:  [100.06102416]
mat_Sqrt:  [[0.15]]
grads:  [0.06450782]
Stock Position:  0.06450781843446994
Bond Position:  [-19.42065616]


portfolio before change:  [-12.99395955]
curr_Stock_Price:  99.64544747936068
curr_Factors:  [99.64544748]
mat_Sqrt:  [[0.15]]
grads:  [-0.08405938]
Stock Position:  -0.08405937861958651
Bond Position:  [-4.61782515]


portfolio before change:  [-13.00962874]
curr_Stock_Price:  99.82842014982938
curr_Factors:  [99.82842015]
mat_Sqrt:  [[0.15]]
grads:  [0.16577894]
Stock Position:  0.16577894175715405
Bond Position:  [-29.55907859]


portfolio before change:  [-12.98255541]
curr_Stock_Price:  100.00287434629854
curr_Factors:  [100.00287435]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389206]
Stock Position:  -0.04389205865218711
Bond Position:  [-8.59322338]


portfolio before change:  [-13.01283982]
curr_Stock_Price:  100.68061227586848
curr_Factors:  [100.68061228]
mat_Sqrt:  [[0.15]]
grads:  [-0.09634309]
Stock Position:  -0.09634309126855208
Bond Position:  [-3.3129584]


portfolio before change:  [-12.96749738]
curr_Stock_Price:  100.20782790461406
curr_Factors:  [100.2078279]
mat_Sqrt:  [[0.15]]
grads:  [0.15669547]
Stock Position:  0.15669547154070385
Bond Position:  [-28.66961022]


portfolio before change:  [-12.96934778]
curr_Stock_Price:  100.20745460040295
curr_Factors:  [100.2074546]
mat_Sqrt:  [[0.15]]
grads:  [0.02414143]
Stock Position:  0.024141432445850868
Bond Position:  [-15.38849927]


portfolio before change:  [-12.96951772]
curr_Stock_Price:  100.24025561469537
curr_Factors:  [100.24025561]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380071]
Stock Position:  -0.053800713687389104
Bond Position:  [-7.57652043]


portfolio before change:  [-12.93661698]
curr_Stock_Price:  99.61992388911567
curr_Factors:  [99.61992389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02991895]
Stock Position:  -0.029918950103061174
Bond Position:  [-9.95609345]


portfolio before change:  [-12.91277844]
curr_Stock_Price:  98.80235458803259
curr_Factors:  [98.80235459]
mat_Sqrt:  [[0.15]]
grads:  [0.0018393]
Stock Position:  0.0018392991492043507
Bond Position:  [-13.09450553]


portfolio before change:  [-12.91350699]
curr_Stock_Price:  98.85122132432049
curr_Factors:  [98.85122132]
mat_Sqrt:  [[0.15]]
grads:  [-0.08276648]
Stock Position:  -0.08276647560120629
Bond Position:  [-4.7319398]


portfolio before change:  [-13.00858967]
curr_Stock_Price:  99.99645451952767
curr_Factors:  [99.99645452]
mat_Sqrt:  [[0.15]]
grads:  [-0.10156447]
Stock Position:  -0.10156446653343787
Bond Position:  [-2.85250311]


portfolio before change:  [-12.96462729]
curr_Stock_Price:  99.5618471592622
curr_Factors:  [99.56184716]
mat_Sqrt:  [[0.15]]
grads:  [-0.04104467]
Stock Position:  -0.04104467447562874
Bond Position:  [-8.87814368]


portfolio before change:  [-12.97730996]
curr_Stock_Price:  99.85732455829933
curr_Factors:  [99.85732456]
mat_Sqrt:  [[0.15]]
grads:  [0.3130488]
Stock Position:  0.31304880257832685
Bond Position:  [-44.23752584]


portfolio before change:  [-13.21198462]
curr_Stock_Price:  99.1165144235371
curr_Factors:  [99.11651442]
mat_Sqrt:  [[0.15]]
grads:  [-0.06373973]
Stock Position:  -0.06373972572351908
Bond Position:  [-6.89432518]


portfolio before change:  [-13.25065362]
curr_Stock_Price:  99.7164242832807
curr_Factors:  [99.71642428]
mat_Sqrt:  [[0.15]]
grads:  [0.0194062]
Stock Position:  0.019406197350229044
Bond Position:  [-15.18577023]


portfolio before change:  [-13.24458969]
curr_Stock_Price:  100.077807201581
curr_Factors:  [100.0778072]
mat_Sqrt:  [[0.15]]
grads:  [0.03599909]
Stock Position:  0.03599908534856902
Bond Position:  [-16.84729921]


portfolio before change:  [-13.23062188]
curr_Stock_Price:  100.49506236610408
curr_Factors:  [100.49506237]
mat_Sqrt:  [[0.15]]
grads:  [0.03463715]
Stock Position:  0.03463715320752291
Bond Position:  [-16.71148475]


portfolio before change:  [-13.20706717]
curr_Stock_Price:  101.20525952278582
curr_Factors:  [101.20525952]
mat_Sqrt:  [[0.15]]
grads:  [-0.00897048]
Stock Position:  -0.00897047604381625
Bond Position:  [-12.29920781]


portfolio before change:  [-13.2022524]
curr_Stock_Price:  100.58283011928856
curr_Factors:  [100.58283012]
mat_Sqrt:  [[0.15]]
grads:  [0.02652807]
Stock Position:  0.02652806587323169
Bond Position:  [-15.87052035]


portfolio before change:  [-13.2037224]
curr_Stock_Price:  100.56480917637262
curr_Factors:  [100.56480918]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213293]
Stock Position:  -0.0021329309707814846
Bond Position:  [-12.98922461]


portfolio before change:  [-13.20349859]
curr_Stock_Price:  100.07924969829234
curr_Factors:  [100.0792497]
mat_Sqrt:  [[0.15]]
grads:  [0.0103711]
Stock Position:  0.010371100635307936
Bond Position:  [-14.24143056]


portfolio before change:  [-13.21325289]
curr_Stock_Price:  99.22454968624346
curr_Factors:  [99.22454969]
mat_Sqrt:  [[0.15]]
grads:  [-0.01165743]
Stock Position:  -0.011657426917817265
Bond Position:  [-12.05654995]


portfolio before change:  [-13.21547863]
curr_Stock_Price:  99.35083714371518
curr_Factors:  [99.35083714]
mat_Sqrt:  [[0.15]]
grads:  [0.00695382]
Stock Position:  0.006953823907884712
Bond Position:  [-13.90634686]


portfolio before change:  [-13.21322166]
curr_Stock_Price:  99.80039466775183
curr_Factors:  [99.80039467]
mat_Sqrt:  [[0.15]]
grads:  [-0.07509675]
Stock Position:  -0.07509674723973142
Bond Position:  [-5.71853665]


portfolio before change:  [-13.1945739]
curr_Stock_Price:  99.5473187189979
curr_Factors:  [99.54731872]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923126]
Stock Position:  -0.029231263756999568
Bond Position:  [-10.28467997]


portfolio before change:  [-13.19488099]
curr_Stock_Price:  99.53583346566452
curr_Factors:  [99.53583347]
mat_Sqrt:  [[0.15]]
grads:  [-0.10942267]
Stock Position:  -0.10942266842339929
Bond Position:  [-2.30340448]


portfolio before change:  [-13.06850299]
curr_Stock_Price:  98.37956515494776
curr_Factors:  [98.37956515]
mat_Sqrt:  [[0.15]]
grads:  [-0.08041707]
Stock Position:  -0.0804170701781627
Bond Position:  [-5.15710659]


portfolio before change:  [-13.05389553]
curr_Stock_Price:  98.19391063751927
curr_Factors:  [98.19391064]
mat_Sqrt:  [[0.15]]
grads:  [-0.02851339]
Stock Position:  -0.028513394475894648
Bond Position:  [-10.25405382]


portfolio before change:  [-13.05606476]
curr_Stock_Price:  98.24751139532822
curr_Factors:  [98.2475114]
mat_Sqrt:  [[0.15]]
grads:  [-0.03226646]
Stock Position:  -0.032266460565779025
Bond Position:  [-9.88596531]


portfolio before change:  [-13.08842192]
curr_Stock_Price:  99.23117264838756
curr_Factors:  [99.23117265]
mat_Sqrt:  [[0.15]]
grads:  [0.15168628]
Stock Position:  0.1516862754097325
Bond Position:  [-28.14042891]


portfolio before change:  [-12.94966549]
curr_Stock_Price:  100.15752713937138
curr_Factors:  [100.15752714]
mat_Sqrt:  [[0.15]]
grads:  [-0.0563848]
Stock Position:  -0.056384801482318544
Bond Position:  [-7.30230321]


portfolio before change:  [-12.9358838]
curr_Stock_Price:  99.90501044219116
curr_Factors:  [99.90501044]
mat_Sqrt:  [[0.15]]
grads:  [0.04426321]
Stock Position:  0.044263212039298935
Bond Position:  [-17.35800046]


portfolio before change:  [-12.94416752]
curr_Stock_Price:  99.74237387869653
curr_Factors:  [99.74237388]
mat_Sqrt:  [[0.15]]
grads:  [-0.0635028]
Stock Position:  -0.06350279645289533
Bond Position:  [-6.61024786]


portfolio before change:  [-12.92346177]
curr_Stock_Price:  99.4098073067418
curr_Factors:  [99.40980731]
mat_Sqrt:  [[0.15]]
grads:  [0.07131774]
Stock Position:  0.07131774225785317
Bond Position:  [-20.01314478]


portfolio before change:  [-12.94217952]
curr_Stock_Price:  99.16489085530004
curr_Factors:  [99.16489086]
mat_Sqrt:  [[0.15]]
grads:  [-0.03556343]
Stock Position:  -0.03556343362542189
Bond Position:  [-9.4155355]


portfolio before change:  [-12.99220392]
curr_Stock_Price:  100.55496778925618
curr_Factors:  [100.55496779]
mat_Sqrt:  [[0.15]]
grads:  [0.1077967]
Stock Position:  0.10779670169974584
Bond Position:  [-23.83169778]


portfolio before change:  [-13.03325776]
curr_Stock_Price:  100.1879406690046
curr_Factors:  [100.18794067]
mat_Sqrt:  [[0.15]]
grads:  [-0.14557359]
Stock Position:  -0.14557359481469956
Bond Position:  [1.55146092]


portfolio before change:  [-13.03977483]
curr_Stock_Price:  100.2333750257231
curr_Factors:  [100.23337503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848063]
Stock Position:  -0.028480632733959833
Bond Position:  [-10.18506489]


portfolio before change:  [-13.07951389]
curr_Stock_Price:  101.60632469424736
curr_Factors:  [101.60632469]
mat_Sqrt:  [[0.15]]
grads:  [-0.07121527]
Stock Position:  -0.07121526936052419
Bond Position:  [-5.84359211]


portfolio before change:  [-13.03641965]
curr_Stock_Price:  100.99606970854607
curr_Factors:  [100.99606971]
mat_Sqrt:  [[0.15]]
grads:  [-0.0099316]
Stock Position:  -0.009931603315594138
Bond Position:  [-12.03336675]


portfolio before change:  [-13.0265994]
curr_Stock_Price:  99.93155244233716
curr_Factors:  [99.93155244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.0265994]
Stock Price:  99.8499797503674
PL:  [-13.0265994]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.14625829e-04]
 [ 1.34605081e-03]
 [-3.86146948e-03]
 [ 3.92037468e-03]
 [ 4.17353640e-03]
 [ 2.79980706e-02]
 [ 1.55415448e-03]
 [-1.73477497e-02]
 [ 9.44121270e-03]
 [ 8.26009266e-03]
 [ 1.39545233e-02]
 [-1.10286647e-02]
 [ 1.17578996e-03]
 [ 3.22707963e-03]
 [-6.90653119e-03]
 [ 1.73224468e-02]
 [ 1.05344083e-02]
 [-1.15391174e-02]
 [-8.07662742e-05]
 [-6.47845321e-04]
 [ 1.23603503e-02]
 [-4.81131348e-03]
 [ 1.10935276e-02]
 [-1.61709087e-02]
 [ 7.18234133e-03]
 [ 7.32417095e-03]
 [-5.30475048e-03]
 [ 1.29884435e-02]
 [ 4.92660457e-02]
 [ 6.40909805e-03]
 [ 2.21061284e-02]
 [ 9.08692333e-03]
 [-6.52941380e-03]
 [ 6.53625694e-03]
 [ 9.30382454e-03]
 [ 5.37875562e-04]
 [-3.05026899e-02]
 [ 7.85123882e-03]
 [ 3.55902896e-02]
 [-5.04775839e-02]
 [-1.34025034e-02]
 [-7.67062266e-03]
 [ 1.89053627e-02]
 [-1.39150923e-02]
 [ 4.11135354e-02]
 [ 1.38889443e-02]
 [ 1.55467219e-02]
 [ 5.41319330e-02]
 [ 1.97915005e-02]
 [-8.27963090e-03]
 [ 1.07840437e-01]
 [ 2.26165386e-02]
 [-1.24551703e-02]
 [ 5.55110724e-03]
 [-3.31682624e-02]
 [ 4.97937579e-02]
 [ 2.38379216e-02]
 [ 3.77882125e-03]
 [ 2.27478121e-03]
 [-1.11741484e-02]
 [ 3.07360855e-02]
 [ 6.15492653e-02]
 [-9.62644629e-03]
 [-1.13932229e-02]
 [ 2.05443463e-02]
 [ 1.08490111e-02]
 [-4.13431002e-03]
 [ 1.58574741e-02]
 [-2.53647105e-02]
 [-5.11596678e-02]
 [-3.06007826e-03]
 [ 1.57797708e-02]
 [-2.94543306e-02]
 [ 2.88603483e-02]
 [-3.06179280e-02]
 [ 6.03124224e-03]
 [ 7.50198718e-03]
 [-1.48000428e-02]
 [ 2.50273178e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.16316208]
curr_Stock_Price:  100.65815566962311
curr_Factors:  [100.65815567]
mat_Sqrt:  [[0.15]]
grads:  [-0.00209751]
Stock Position:  -0.0020975055267002827
Bond Position:  [12.37429311]


portfolio before change:  [12.16359659]
curr_Stock_Price:  100.8197307745155
curr_Factors:  [100.81973077]
mat_Sqrt:  [[0.15]]
grads:  [0.00897367]
Stock Position:  0.008973672073530132
Bond Position:  [11.25887339]


portfolio before change:  [12.16464926]
curr_Stock_Price:  100.858618709232
curr_Factors:  [100.85861871]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574313]
Stock Position:  -0.0257431298623567
Bond Position:  [14.76106578]


portfolio before change:  [12.15944165]
curr_Stock_Price:  101.0967485956173
curr_Factors:  [101.0967486]
mat_Sqrt:  [[0.15]]
grads:  [0.02613583]
Stock Position:  0.02613583117717054
Bond Position:  [9.51719409]


portfolio before change:  [12.14421931]
curr_Stock_Price:  100.49155739502818
curr_Factors:  [100.4915574]
mat_Sqrt:  [[0.15]]
grads:  [0.02782358]
Stock Position:  0.027823576005894295
Bond Position:  [9.34818483]


portfolio before change:  [12.14798222]
curr_Stock_Price:  100.60579977681459
curr_Factors:  [100.60579978]
mat_Sqrt:  [[0.15]]
grads:  [0.1866538]
Stock Position:  0.18665380371920862
Bond Position:  [-6.63047298]


portfolio before change:  [11.83951275]
curr_Stock_Price:  98.95539107768897
curr_Factors:  [98.95539108]
mat_Sqrt:  [[0.15]]
grads:  [0.01036103]
Stock Position:  0.010361029867695373
Bond Position:  [10.81423298]


portfolio before change:  [11.84319746]
curr_Stock_Price:  99.24578763096213
curr_Factors:  [99.24578763]
mat_Sqrt:  [[0.15]]
grads:  [-0.11565166]
Stock Position:  -0.11565166446588764
Bond Position:  [23.32113799]


portfolio before change:  [11.83617153]
curr_Stock_Price:  99.31914197600572
curr_Factors:  [99.31914198]
mat_Sqrt:  [[0.15]]
grads:  [0.06294142]
Stock Position:  0.06294141799785508
Bond Position:  [5.5848839]


portfolio before change:  [11.85384781]
curr_Stock_Price:  99.59443308447861
curr_Factors:  [99.59443308]
mat_Sqrt:  [[0.15]]
grads:  [0.05506728]
Stock Position:  0.055067284401949086
Bond Position:  [6.36945284]


portfolio before change:  [11.85136707]
curr_Stock_Price:  99.54215444289345
curr_Factors:  [99.54215444]
mat_Sqrt:  [[0.15]]
grads:  [0.09303016]
Stock Position:  0.09303015536585396
Bond Position:  [2.59094497]


portfolio before change:  [11.90260197]
curr_Stock_Price:  100.09114807837707
curr_Factors:  [100.09114808]
mat_Sqrt:  [[0.15]]
grads:  [-0.07352443]
Stock Position:  -0.0735244312459974
Bond Position:  [19.26174671]


portfolio before change:  [11.8945907]
curr_Stock_Price:  100.21648278192744
curr_Factors:  [100.21648278]
mat_Sqrt:  [[0.15]]
grads:  [0.0078386]
Stock Position:  0.007838599752617095
Bond Position:  [11.10903381]


portfolio before change:  [11.895155]
curr_Stock_Price:  100.19989363334885
curr_Factors:  [100.19989363]
mat_Sqrt:  [[0.15]]
grads:  [0.02151386]
Stock Position:  0.021513864224403975
Bond Position:  [9.7394681]


portfolio before change:  [11.91475816]
curr_Stock_Price:  101.08278587993976
curr_Factors:  [101.08278588]
mat_Sqrt:  [[0.15]]
grads:  [-0.04604354]
Stock Position:  -0.04604354125865181
Bond Position:  [16.56896759]


portfolio before change:  [11.93434158]
curr_Stock_Price:  100.67995363995583
curr_Factors:  [100.67995364]
mat_Sqrt:  [[0.15]]
grads:  [0.11548298]
Stock Position:  0.11548297885875722
Bond Position:  [0.30752062]


portfolio before change:  [11.99538956]
curr_Stock_Price:  101.20841906849537
curr_Factors:  [101.20841907]
mat_Sqrt:  [[0.15]]
grads:  [0.07022939]
Stock Position:  0.07022938850270197
Bond Position:  [4.88758418]


portfolio before change:  [11.98735405]
curr_Stock_Price:  101.08965123632885
curr_Factors:  [101.08965124]
mat_Sqrt:  [[0.15]]
grads:  [-0.07692745]
Stock Position:  -0.07692744943468141
Bond Position:  [19.76392309]


portfolio before change:  [11.97372543]
curr_Stock_Price:  101.28287100747924
curr_Factors:  [101.28287101]
mat_Sqrt:  [[0.15]]
grads:  [-0.00053844]
Stock Position:  -0.0005384418282451675
Bond Position:  [12.02826037]


portfolio before change:  [11.9746026]
curr_Stock_Price:  101.05001504138832
curr_Factors:  [101.05001504]
mat_Sqrt:  [[0.15]]
grads:  [-0.00431897]
Stock Position:  -0.00431896880779728
Bond Position:  [12.41103447]


portfolio before change:  [11.97534877]
curr_Stock_Price:  101.05685709153842
curr_Factors:  [101.05685709]
mat_Sqrt:  [[0.15]]
grads:  [0.08240234]
Stock Position:  0.0824023354869831
Bond Position:  [3.64802772]


portfolio before change:  [12.05608426]
curr_Stock_Price:  102.03386195911607
curr_Factors:  [102.03386196]
mat_Sqrt:  [[0.15]]
grads:  [-0.03207542]
Stock Position:  -0.03207542317887201
Bond Position:  [15.32886356]


portfolio before change:  [12.03376087]
curr_Stock_Price:  102.7596971588001
curr_Factors:  [102.75969716]
mat_Sqrt:  [[0.15]]
grads:  [0.07395685]
Stock Position:  0.07395685078193015
Bond Position:  [4.43397728]


portfolio before change:  [12.02419368]
curr_Stock_Price:  102.62658812838922
curr_Factors:  [102.62658813]
mat_Sqrt:  [[0.15]]
grads:  [-0.10780606]
Stock Position:  -0.10780605810423782
Bond Position:  [23.0879616]


portfolio before change:  [11.92868973]
curr_Stock_Price:  103.52586028966138
curr_Factors:  [103.52586029]
mat_Sqrt:  [[0.15]]
grads:  [0.04788228]
Stock Position:  0.04788227553698778
Bond Position:  [6.97163597]


portfolio before change:  [11.9021064]
curr_Stock_Price:  102.96157891248968
curr_Factors:  [102.96157891]
mat_Sqrt:  [[0.15]]
grads:  [0.04882781]
Stock Position:  0.04882780633754681
Bond Position:  [6.87471836]


portfolio before change:  [11.89201768]
curr_Stock_Price:  102.74616067763652
curr_Factors:  [102.74616068]
mat_Sqrt:  [[0.15]]
grads:  [-0.035365]
Stock Position:  -0.03536500321069015
Bond Position:  [15.52563598]


portfolio before change:  [11.87733044]
curr_Stock_Price:  103.18890420137205
curr_Factors:  [103.1889042]
mat_Sqrt:  [[0.15]]
grads:  [0.08658962]
Stock Position:  0.08658962300399108
Bond Position:  [2.94224213]


portfolio before change:  [11.91274058]
curr_Stock_Price:  103.59572253764075
curr_Factors:  [103.59572254]
mat_Sqrt:  [[0.15]]
grads:  [0.3284403]
Stock Position:  0.3284403047095979
Bond Position:  [-22.1122701]


portfolio before change:  [12.15657922]
curr_Stock_Price:  104.34234436902956
curr_Factors:  [104.34234437]
mat_Sqrt:  [[0.15]]
grads:  [0.04272732]
Stock Position:  0.042727320314695144
Bond Position:  [7.69831045]


portfolio before change:  [12.21052604]
curr_Stock_Price:  105.59366690283737
curr_Factors:  [105.5936669]
mat_Sqrt:  [[0.15]]
grads:  [0.14737419]
Stock Position:  0.14737418962830587
Bond Position:  [-3.35125505]


portfolio before change:  [12.25304549]
curr_Stock_Price:  105.88360169352669
curr_Factors:  [105.88360169]
mat_Sqrt:  [[0.15]]
grads:  [0.06057949]
Stock Position:  0.06057948887011081
Bond Position:  [5.83867101]


portfolio before change:  [12.30375563]
curr_Stock_Price:  106.71466216263424
curr_Factors:  [106.71466216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352943]
Stock Position:  -0.043529425309202556
Bond Position:  [16.94898355]


portfolio before change:  [12.30362698]
curr_Stock_Price:  106.7419540569936
curr_Factors:  [106.74195406]
mat_Sqrt:  [[0.15]]
grads:  [0.04357505]
Stock Position:  0.04357504624384845
Bond Position:  [7.65234139]


portfolio before change:  [12.33646468]
curr_Stock_Price:  107.48456757130394
curr_Factors:  [107.48456757]
mat_Sqrt:  [[0.15]]
grads:  [0.0620255]
Stock Position:  0.06202549691794049
Bond Position:  [5.66968097]


portfolio before change:  [12.35197362]
curr_Stock_Price:  107.72889576173864
curr_Factors:  [107.72889576]
mat_Sqrt:  [[0.15]]
grads:  [0.00358584]
Stock Position:  0.0035858370816604463
Bond Position:  [11.96567535]


portfolio before change:  [12.35653304]
curr_Stock_Price:  108.79183675522401
curr_Factors:  [108.79183676]
mat_Sqrt:  [[0.15]]
grads:  [-0.20335127]
Stock Position:  -0.20335126572545204
Bond Position:  [34.47949074]


portfolio before change:  [12.27491872]
curr_Stock_Price:  109.20378082529366
curr_Factors:  [109.20378083]
mat_Sqrt:  [[0.15]]
grads:  [0.05234159]
Stock Position:  0.052341592101104346
Bond Position:  [6.55901897]


portfolio before change:  [12.32916704]
curr_Stock_Price:  110.23237703627072
curr_Factors:  [110.23237704]
mat_Sqrt:  [[0.15]]
grads:  [0.2372686]
Stock Position:  0.23726859729875077
Bond Position:  [-13.82551444]


portfolio before change:  [12.39642491]
curr_Stock_Price:  110.51948622262462
curr_Factors:  [110.51948622]
mat_Sqrt:  [[0.15]]
grads:  [-0.33651723]
Stock Position:  -0.33651722572118176
Bond Position:  [49.5881358]


portfolio before change:  [12.63743275]
curr_Stock_Price:  109.81251355644675
curr_Factors:  [109.81251356]
mat_Sqrt:  [[0.15]]
grads:  [-0.08935002]
Stock Position:  -0.0893500228487471
Bond Position:  [22.44918334]


portfolio before change:  [12.69238981]
curr_Stock_Price:  109.21314104042672
curr_Factors:  [109.21314104]
mat_Sqrt:  [[0.15]]
grads:  [-0.05113748]
Stock Position:  -0.051137484402579036
Bond Position:  [18.27727511]


portfolio before change:  [12.69161077]
curr_Stock_Price:  109.25071441961279
curr_Factors:  [109.25071442]
mat_Sqrt:  [[0.15]]
grads:  [0.12603575]
Stock Position:  0.1260357513194857
Bond Position:  [-1.07788511]


portfolio before change:  [12.81821514]
curr_Stock_Price:  110.25576052689509
curr_Factors:  [110.25576053]
mat_Sqrt:  [[0.15]]
grads:  [-0.09276728]
Stock Position:  -0.09276728224278984
Bond Position:  [23.0463424]


portfolio before change:  [12.82881948]
curr_Stock_Price:  110.15697674700556
curr_Factors:  [110.15697675]
mat_Sqrt:  [[0.15]]
grads:  [0.27409024]
Stock Position:  0.27409023629917423
Bond Position:  [-17.3641323]


portfolio before change:  [13.034154]
curr_Stock_Price:  110.91008567899006
curr_Factors:  [110.91008568]
mat_Sqrt:  [[0.15]]
grads:  [0.09259296]
Stock Position:  0.09259296207842868
Bond Position:  [2.76466064]


portfolio before change:  [13.01542645]
curr_Stock_Price:  110.70596273361438
curr_Factors:  [110.70596273]
mat_Sqrt:  [[0.15]]
grads:  [0.10364481]
Stock Position:  0.1036448127174806
Bond Position:  [1.54132767]


portfolio before change:  [13.04272387]
curr_Stock_Price:  110.96840799206207
curr_Factors:  [110.96840799]
mat_Sqrt:  [[0.15]]
grads:  [0.36087955]
Stock Position:  0.360879553494654
Bond Position:  [-27.00350566]


portfolio before change:  [13.0680265]
curr_Stock_Price:  111.04319860090963
curr_Factors:  [111.0431986]
mat_Sqrt:  [[0.15]]
grads:  [0.13194334]
Stock Position:  0.13194333654910612
Bond Position:  [-1.58338362]


portfolio before change:  [12.97235262]
curr_Stock_Price:  110.31883523456216
curr_Factors:  [110.31883523]
mat_Sqrt:  [[0.15]]
grads:  [-0.05519754]
Stock Position:  -0.05519753935420991
Bond Position:  [19.06168087]


portfolio before change:  [12.99034648]
curr_Stock_Price:  110.01442906848465
curr_Factors:  [110.01442907]
mat_Sqrt:  [[0.15]]
grads:  [0.71893625]
Stock Position:  0.7189362459916526
Bond Position:  [-66.10301416]


portfolio before change:  [12.65067951]
curr_Stock_Price:  109.54771813503945
curr_Factors:  [109.54771814]
mat_Sqrt:  [[0.15]]
grads:  [0.15077692]
Stock Position:  0.15077692424340775
Bond Position:  [-3.86658849]


portfolio before change:  [12.68420497]
curr_Stock_Price:  109.7716723499031
curr_Factors:  [109.77167235]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303447]
Stock Position:  -0.08303446860690997
Bond Position:  [21.79903745]


portfolio before change:  [12.64992599]
curr_Stock_Price:  110.2009092571212
curr_Factors:  [110.20090926]
mat_Sqrt:  [[0.15]]
grads:  [0.03700738]
Stock Position:  0.03700738159956161
Bond Position:  [8.57167889]


portfolio before change:  [12.63793093]
curr_Stock_Price:  109.86230649446024
curr_Factors:  [109.86230649]
mat_Sqrt:  [[0.15]]
grads:  [-0.22112175]
Stock Position:  -0.22112174918890162
Bond Position:  [36.93087632]


portfolio before change:  [12.6645888]
curr_Stock_Price:  109.75218791124617
curr_Factors:  [109.75218791]
mat_Sqrt:  [[0.15]]
grads:  [0.33195839]
Stock Position:  0.3319583856952179
Bond Position:  [-23.76857033]


portfolio before change:  [12.80592149]
curr_Stock_Price:  110.18241734275979
curr_Factors:  [110.18241734]
mat_Sqrt:  [[0.15]]
grads:  [0.15891948]
Stock Position:  0.1589194770424077
Bond Position:  [-4.70421066]


portfolio before change:  [12.93897794]
curr_Stock_Price:  111.02152453010805
curr_Factors:  [111.02152453]
mat_Sqrt:  [[0.15]]
grads:  [0.02519214]
Stock Position:  0.025192141689010652
Bond Position:  [10.14210796]


portfolio before change:  [12.92034548]
curr_Stock_Price:  110.25674785823034
curr_Factors:  [110.25674786]
mat_Sqrt:  [[0.15]]
grads:  [0.01516521]
Stock Position:  0.01516520809088864
Bond Position:  [11.24827895]


portfolio before change:  [12.91453707]
curr_Stock_Price:  109.82738016906556
curr_Factors:  [109.82738017]
mat_Sqrt:  [[0.15]]
grads:  [-0.07449432]
Stock Position:  -0.07449432277612844
Bond Position:  [21.09605337]


portfolio before change:  [12.87738797]
curr_Stock_Price:  110.34376375802186
curr_Factors:  [110.34376376]
mat_Sqrt:  [[0.15]]
grads:  [0.20490724]
Stock Position:  0.20490723652285864
Bond Position:  [-9.73284773]


portfolio before change:  [12.78083772]
curr_Stock_Price:  109.87554252689286
curr_Factors:  [109.87554253]
mat_Sqrt:  [[0.15]]
grads:  [0.41032844]
Stock Position:  0.4103284355291311
Bond Position:  [-32.30422174]


portfolio before change:  [12.62653819]
curr_Stock_Price:  109.50442407277822
curr_Factors:  [109.50442407]
mat_Sqrt:  [[0.15]]
grads:  [-0.06417631]
Stock Position:  -0.0641763086133005
Bond Position:  [19.65412791]


portfolio before change:  [12.6444954]
curr_Stock_Price:  109.24375495920975
curr_Factors:  [109.24375496]
mat_Sqrt:  [[0.15]]
grads:  [-0.07595482]
Stock Position:  -0.07595481927302818
Bond Position:  [20.94208506]


portfolio before change:  [12.65715247]
curr_Stock_Price:  109.09434830568864
curr_Factors:  [109.09434831]
mat_Sqrt:  [[0.15]]
grads:  [0.13696231]
Stock Position:  0.13696230873270318
Bond Position:  [-2.28466134]


portfolio before change:  [12.66714311]
curr_Stock_Price:  109.16833529707831
curr_Factors:  [109.1683353]
mat_Sqrt:  [[0.15]]
grads:  [0.07232674]
Stock Position:  0.0723267404855738
Bond Position:  [4.77135325]


portfolio before change:  [12.69231206]
curr_Stock_Price:  109.51220171811237
curr_Factors:  [109.51220172]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756207]
Stock Position:  -0.02756206679894784
Bond Position:  [15.71069468]


portfolio before change:  [12.71484689]
curr_Stock_Price:  108.7302255170947
curr_Factors:  [108.73022552]
mat_Sqrt:  [[0.15]]
grads:  [0.10571649]
Stock Position:  0.10571649419787495
Bond Position:  [1.22026864]


portfolio before change:  [12.7452019]
curr_Stock_Price:  109.01664002387501
curr_Factors:  [109.01664002]
mat_Sqrt:  [[0.15]]
grads:  [-0.16909807]
Stock Position:  -0.1690980701585011
Bond Position:  [31.17970534]


portfolio before change:  [12.80197687]
curr_Stock_Price:  108.69241289692593
curr_Factors:  [108.6924129]
mat_Sqrt:  [[0.15]]
grads:  [-0.34106445]
Stock Position:  -0.3410644518962262
Bond Position:  [49.8730951]


portfolio before change:  [12.96331896]
curr_Stock_Price:  108.2284978848081
curr_Factors:  [108.22849788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02040052]
Stock Position:  -0.02040052170567806
Bond Position:  [15.17123678]


portfolio before change:  [12.98399645]
curr_Stock_Price:  107.26140201620426
curr_Factors:  [107.26140202]
mat_Sqrt:  [[0.15]]
grads:  [0.10519847]
Stock Position:  0.1051984722991285
Bond Position:  [1.70026082]


portfolio before change:  [13.02034061]
curr_Stock_Price:  107.60587364871992
curr_Factors:  [107.60587365]
mat_Sqrt:  [[0.15]]
grads:  [-0.1963622]
Stock Position:  -0.19636220423117348
Bond Position:  [34.15006715]


portfolio before change:  [12.8595939]
curr_Stock_Price:  108.43536706160116
curr_Factors:  [108.43536706]
mat_Sqrt:  [[0.15]]
grads:  [0.19240232]
Stock Position:  0.19240232170140667
Bond Position:  [-8.00362248]


portfolio before change:  [12.82093519]
curr_Stock_Price:  108.23704061802366
curr_Factors:  [108.23704062]
mat_Sqrt:  [[0.15]]
grads:  [-0.20411952]
Stock Position:  -0.20411952000594327
Bond Position:  [34.91422797]


portfolio before change:  [12.92983236]
curr_Stock_Price:  107.71423434123015
curr_Factors:  [107.71423434]
mat_Sqrt:  [[0.15]]
grads:  [0.04020828]
Stock Position:  0.04020828157796715
Bond Position:  [8.5988281]


portfolio before change:  [12.91784368]
curr_Stock_Price:  107.40270341186205
curr_Factors:  [107.40270341]
mat_Sqrt:  [[0.15]]
grads:  [0.05001325]
Stock Position:  0.05001324784866306
Bond Position:  [7.54628566]


portfolio before change:  [12.88230246]
curr_Stock_Price:  106.68263665524702
curr_Factors:  [106.68263666]
mat_Sqrt:  [[0.15]]
grads:  [-0.09866695]
Stock Position:  -0.09866695194878133
Bond Position:  [23.40835305]


portfolio before change:  [12.9624132]
curr_Stock_Price:  105.88553418236684
curr_Factors:  [105.88553418]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.9624132]
Stock Price:  107.22307482294195
PL:  [5.73933838]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.31737455e-04]
 [ 2.69777074e-03]
 [-4.37712128e-03]
 [-1.83024231e-03]
 [ 2.31675604e-02]
 [ 2.72154277e-02]
 [ 2.53203164e-03]
 [ 1.26561939e-02]
 [ 2.46227452e-02]
 [-2.74795387e-03]
 [ 5.34534186e-02]
 [ 5.95214435e-02]
 [ 1.24869776e-01]
 [ 1.92789317e-02]
 [-6.89171352e-03]
 [ 3.86406926e-02]
 [ 1.76311737e-02]
 [ 1.48893838e-02]
 [ 1.76749146e-02]
 [-1.12843563e-02]
 [ 1.53711504e-02]
 [-1.57336838e-02]
 [ 1.05301604e-02]
 [-6.63301500e-02]
 [ 9.27573453e-03]
 [ 6.41113279e-03]
 [-3.58050721e-03]
 [ 1.95504807e-02]
 [ 6.47407123e-02]
 [ 8.56278736e-03]
 [ 2.19798279e-02]
 [ 5.40978218e-03]
 [-5.08810078e-03]
 [ 6.81439363e-03]
 [ 9.67665611e-03]
 [ 5.08892844e-03]
 [-3.21900548e-02]
 [ 8.61349188e-03]
 [ 1.34324797e-02]
 [ 3.57668704e-03]
 [-4.93446840e-03]
 [-1.64648156e-02]
 [ 2.04179470e-02]
 [-9.67471410e-04]
 [ 5.81353467e-04]
 [-1.48386099e-02]
 [ 1.39244732e-02]
 [-2.94419858e-03]
 [-4.15068126e-03]
 [-7.52294858e-03]
 [-2.00575980e-02]
 [-1.71349468e-03]
 [-2.26920683e-03]
 [ 5.45440207e-03]
 [ 8.83450326e-05]
 [ 7.29609756e-03]
 [ 1.02092691e-02]
 [ 5.59808673e-04]
 [ 1.77597361e-03]
 [ 1.68298786e-02]
 [ 2.05372867e-03]
 [ 1.62993387e-02]
 [ 6.18341666e-04]
 [-1.24658954e-02]
 [ 3.13596897e-03]
 [ 9.98355278e-04]
 [-5.42278984e-03]
 [ 1.50463565e-02]
 [-8.30870863e-03]
 [ 8.51479300e-03]
 [-1.23876876e-02]
 [ 1.24512431e-02]
 [ 2.14356103e-03]
 [ 2.11703549e-02]
 [-2.24845451e-02]
 [-1.28610414e-03]
 [-8.35109185e-03]
 [-4.63428036e-03]
 [ 2.68199549e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.47363336]
curr_Stock_Price:  100.28819429861929
curr_Factors:  [100.2881943]
mat_Sqrt:  [[0.15]]
grads:  [0.00221158]
Stock Position:  0.0022115830351502152
Bond Position:  [6.25183769]


portfolio before change:  [6.47420801]
curr_Stock_Price:  100.37134509107143
curr_Factors:  [100.37134509]
mat_Sqrt:  [[0.15]]
grads:  [0.01798514]
Stock Position:  0.017985138271971055
Bond Position:  [4.66901549]


portfolio before change:  [6.49376905]
curr_Stock_Price:  101.44274222680887
curr_Factors:  [101.44274223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918081]
Stock Position:  -0.029180808511413126
Bond Position:  [9.45395029]


portfolio before change:  [6.47212891]
curr_Stock_Price:  102.20457985980946
curr_Factors:  [102.20457986]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220162]
Stock Position:  -0.01220161540722972
Bond Position:  [7.71918988]


portfolio before change:  [6.47964186]
curr_Stock_Price:  101.6283864186572
curr_Factors:  [101.62838642]
mat_Sqrt:  [[0.15]]
grads:  [0.1544504]
Stock Position:  0.15445040282205155
Bond Position:  [-9.21690336]


portfolio before change:  [6.47911318]
curr_Stock_Price:  101.62869326927415
curr_Factors:  [101.62869327]
mat_Sqrt:  [[0.15]]
grads:  [0.18143618]
Stock Position:  0.18143618484845245
Bond Position:  [-11.9600092]


portfolio before change:  [6.47828429]
curr_Stock_Price:  101.62824481057153
curr_Factors:  [101.62824481]
mat_Sqrt:  [[0.15]]
grads:  [0.01688021]
Stock Position:  0.016880210965823022
Bond Position:  [4.76277808]


portfolio before change:  [6.48860246]
curr_Stock_Price:  102.22186799984635
curr_Factors:  [102.221868]
mat_Sqrt:  [[0.15]]
grads:  [0.08437463]
Stock Position:  0.08437462611007814
Bond Position:  [-2.13632944]


portfolio before change:  [6.47472922]
curr_Stock_Price:  102.05902620812917
curr_Factors:  [102.05902621]
mat_Sqrt:  [[0.15]]
grads:  [0.16415163]
Stock Position:  0.16415163479189843
Bond Position:  [-10.27842678]


portfolio before change:  [6.65589191]
curr_Stock_Price:  103.16656996985245
curr_Factors:  [103.16656997]
mat_Sqrt:  [[0.15]]
grads:  [-0.01831969]
Stock Position:  -0.018319692456426787
Bond Position:  [8.54587175]


portfolio before change:  [6.65253102]
curr_Stock_Price:  103.37918425747431
curr_Factors:  [103.37918426]
mat_Sqrt:  [[0.15]]
grads:  [0.35635612]
Stock Position:  0.3563561239800827
Bond Position:  [-30.18727438]


portfolio before change:  [6.62788495]
curr_Stock_Price:  103.31531752388643
curr_Factors:  [103.31531752]
mat_Sqrt:  [[0.15]]
grads:  [0.39680962]
Stock Position:  0.39680962352837457
Bond Position:  [-34.3686273]


portfolio before change:  [6.72120811]
curr_Stock_Price:  103.55591468036819
curr_Factors:  [103.55591468]
mat_Sqrt:  [[0.15]]
grads:  [0.83246517]
Stock Position:  0.832465172656344
Bond Position:  [-79.48548428]


portfolio before change:  [6.95976423]
curr_Stock_Price:  103.84844837735596
curr_Factors:  [103.84844838]
mat_Sqrt:  [[0.15]]
grads:  [0.12852621]
Stock Position:  0.1285262112312975
Bond Position:  [-6.38748338]


portfolio before change:  [7.06202151]
curr_Stock_Price:  104.64716881643062
curr_Factors:  [104.64716882]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594476]
Stock Position:  -0.04594475678053795
Bond Position:  [11.87001023]


portfolio before change:  [7.03525204]
curr_Stock_Price:  105.24596118111823
curr_Factors:  [105.24596118]
mat_Sqrt:  [[0.15]]
grads:  [0.25760462]
Stock Position:  0.2576046173031888
Bond Position:  [-20.07659351]


portfolio before change:  [7.04006179]
curr_Stock_Price:  105.26950336970444
curr_Factors:  [105.26950337]
mat_Sqrt:  [[0.15]]
grads:  [0.11754116]
Stock Position:  0.11754115821743202
Bond Position:  [-5.33343756]


portfolio before change:  [7.06754327]
curr_Stock_Price:  105.50614240477661
curr_Factors:  [105.5061424]
mat_Sqrt:  [[0.15]]
grads:  [0.09926256]
Stock Position:  0.09926255843378802
Bond Position:  [-3.40526636]


portfolio before change:  [7.02742948]
curr_Stock_Price:  105.10416857302202
curr_Factors:  [105.10416857]
mat_Sqrt:  [[0.15]]
grads:  [0.11783276]
Stock Position:  0.11783276407828841
Bond Position:  [-5.35728522]


portfolio before change:  [7.04416745]
curr_Stock_Price:  105.24905872976447
curr_Factors:  [105.24905873]
mat_Sqrt:  [[0.15]]
grads:  [-0.07522904]
Stock Position:  -0.07522904218515546
Bond Position:  [14.96195333]


portfolio before change:  [7.06647684]
curr_Stock_Price:  104.96493649781044
curr_Factors:  [104.9649365]
mat_Sqrt:  [[0.15]]
grads:  [0.10247434]
Stock Position:  0.10247433629502908
Bond Position:  [-3.68973536]


portfolio before change:  [7.01562351]
curr_Stock_Price:  104.47093264473537
curr_Factors:  [104.47093264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10489123]
Stock Position:  -0.10489122522588322
Bond Position:  [17.97370764]


portfolio before change:  [7.00880615]
curr_Stock_Price:  104.54663725439497
curr_Factors:  [104.54663725]
mat_Sqrt:  [[0.15]]
grads:  [0.07020107]
Stock Position:  0.07020106956817293
Bond Position:  [-0.3304796]


portfolio before change:  [7.01118646]
curr_Stock_Price:  104.58083851345064
curr_Factors:  [104.58083851]
mat_Sqrt:  [[0.15]]
grads:  [-0.442201]
Stock Position:  -0.4422010003068717
Bond Position:  [53.25693787]


portfolio before change:  [7.17658414]
curr_Stock_Price:  104.2143332070334
curr_Factors:  [104.21433321]
mat_Sqrt:  [[0.15]]
grads:  [0.06183823]
Stock Position:  0.06183823019288995
Bond Position:  [0.73215421]


portfolio before change:  [7.18360318]
curr_Stock_Price:  104.32709974681276
curr_Factors:  [104.32709975]
mat_Sqrt:  [[0.15]]
grads:  [0.04274089]
Stock Position:  0.04274088524825282
Bond Position:  [2.72457058]


portfolio before change:  [7.23836819]
curr_Stock_Price:  105.60444148983157
curr_Factors:  [105.60444149]
mat_Sqrt:  [[0.15]]
grads:  [-0.02387005]
Stock Position:  -0.023870048047471757
Bond Position:  [9.75915128]


portfolio before change:  [7.25688039]
curr_Stock_Price:  104.85445412500334
curr_Factors:  [104.85445413]
mat_Sqrt:  [[0.15]]
grads:  [0.13033654]
Stock Position:  0.13033653810468485
Bond Position:  [-6.40948616]


portfolio before change:  [7.2946877]
curr_Stock_Price:  105.14760225262197
curr_Factors:  [105.14760225]
mat_Sqrt:  [[0.15]]
grads:  [0.43160475]
Stock Position:  0.43160474871327037
Bond Position:  [-38.08751675]


portfolio before change:  [7.28902653]
curr_Stock_Price:  105.14000125251314
curr_Factors:  [105.14000125]
mat_Sqrt:  [[0.15]]
grads:  [0.05708525]
Stock Position:  0.05708524908812673
Bond Position:  [1.28708336]


portfolio before change:  [7.31134871]
curr_Stock_Price:  105.5296244988743
curr_Factors:  [105.5296245]
mat_Sqrt:  [[0.15]]
grads:  [0.14653219]
Stock Position:  0.14653218575082183
Bond Position:  [-8.15213783]


portfolio before change:  [7.2562325]
curr_Stock_Price:  105.15696446770417
curr_Factors:  [105.15696447]
mat_Sqrt:  [[0.15]]
grads:  [0.03606521]
Stock Position:  0.036065214505259964
Bond Position:  [3.46372402]


portfolio before change:  [7.28371263]
curr_Stock_Price:  105.91291839975132
curr_Factors:  [105.9129184]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392067]
Stock Position:  -0.03392067187655838
Bond Position:  [10.87634998]


portfolio before change:  [7.27663741]
curr_Stock_Price:  106.14154041947715
curr_Factors:  [106.14154042]
mat_Sqrt:  [[0.15]]
grads:  [0.04542929]
Stock Position:  0.045429290893768993
Bond Position:  [2.45470249]


portfolio before change:  [7.23378116]
curr_Stock_Price:  105.19480168582923
curr_Factors:  [105.19480169]
mat_Sqrt:  [[0.15]]
grads:  [0.06451104]
Stock Position:  0.06451104076106337
Bond Position:  [0.44755502]


portfolio before change:  [7.23551715]
curr_Stock_Price:  105.2212779536491
curr_Factors:  [105.22127795]
mat_Sqrt:  [[0.15]]
grads:  [0.03392619]
Stock Position:  0.03392618958130421
Bond Position:  [3.66576012]


portfolio before change:  [7.21828301]
curr_Stock_Price:  104.70653539922745
curr_Factors:  [104.7065354]
mat_Sqrt:  [[0.15]]
grads:  [-0.21460037]
Stock Position:  -0.2146003650866929
Bond Position:  [29.68834373]


portfolio before change:  [7.11049822]
curr_Stock_Price:  105.2174402856142
curr_Factors:  [105.21744029]
mat_Sqrt:  [[0.15]]
grads:  [0.05742328]
Stock Position:  0.05742327918796327
Bond Position:  [1.06856777]


portfolio before change:  [7.05805396]
curr_Stock_Price:  104.30298457564075
curr_Factors:  [104.30298458]
mat_Sqrt:  [[0.15]]
grads:  [0.08954986]
Stock Position:  0.08954986441361638
Bond Position:  [-2.28226417]


portfolio before change:  [7.06262727]
curr_Stock_Price:  104.35564754459297
curr_Factors:  [104.35564754]
mat_Sqrt:  [[0.15]]
grads:  [0.02384458]
Stock Position:  0.0238445802872467
Bond Position:  [4.57431066]


portfolio before change:  [7.07510516]
curr_Stock_Price:  104.8669581104681
curr_Factors:  [104.86695811]
mat_Sqrt:  [[0.15]]
grads:  [-0.03289646]
Stock Position:  -0.032896456001333965
Bond Position:  [10.52485644]


portfolio before change:  [7.09691931]
curr_Stock_Price:  104.2238393329959
curr_Factors:  [104.22383933]
mat_Sqrt:  [[0.15]]
grads:  [-0.10976544]
Stock Position:  -0.10976543720930383
Bond Position:  [18.53709461]


portfolio before change:  [7.07225047]
curr_Stock_Price:  104.45913603103293
curr_Factors:  [104.45913603]
mat_Sqrt:  [[0.15]]
grads:  [0.13611965]
Stock Position:  0.1361196466394148
Bond Position:  [-7.14669021]


portfolio before change:  [6.87314398]
curr_Stock_Price:  102.9996860642835
curr_Factors:  [102.99968606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00644981]
Stock Position:  -0.0064498093993649195
Bond Position:  [7.53747232]


portfolio before change:  [6.87427895]
curr_Stock_Price:  102.89675823724542
curr_Factors:  [102.89675824]
mat_Sqrt:  [[0.15]]
grads:  [0.00387569]
Stock Position:  0.0038756897796541397
Bond Position:  [6.47548304]


portfolio before change:  [6.8754633]
curr_Stock_Price:  103.09791381024624
curr_Factors:  [103.09791381]
mat_Sqrt:  [[0.15]]
grads:  [-0.09892407]
Stock Position:  -0.0989240661774813
Bond Position:  [17.07432815]


portfolio before change:  [6.92084764]
curr_Stock_Price:  102.6499220343874
curr_Factors:  [102.64992203]
mat_Sqrt:  [[0.15]]
grads:  [0.09282982]
Stock Position:  0.09282982123703164
Bond Position:  [-2.60812627]


portfolio before change:  [6.83203174]
curr_Stock_Price:  101.69491763599044
curr_Factors:  [101.69491764]
mat_Sqrt:  [[0.15]]
grads:  [-0.01962799]
Stock Position:  -0.019627990535876216
Bond Position:  [8.82809862]


portfolio before change:  [6.82303831]
curr_Stock_Price:  102.18122334294232
curr_Factors:  [102.18122334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767121]
Stock Position:  -0.02767120839931499
Bond Position:  [9.65051624]


portfolio before change:  [6.83509991]
curr_Stock_Price:  101.76713152279119
curr_Factors:  [101.76713152]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015299]
Stock Position:  -0.05015299054310499
Bond Position:  [11.9390259]


portfolio before change:  [6.82760547]
curr_Stock_Price:  101.93144177611386
curr_Factors:  [101.93144178]
mat_Sqrt:  [[0.15]]
grads:  [-0.13371732]
Stock Position:  -0.1337173200218118
Bond Position:  [20.45760469]


portfolio before change:  [6.86359144]
curr_Stock_Price:  101.67188435585663
curr_Factors:  [101.67188436]
mat_Sqrt:  [[0.15]]
grads:  [-0.0114233]
Stock Position:  -0.011423297871640618
Bond Position:  [8.02501966]


portfolio before change:  [6.86817487]
curr_Stock_Price:  101.31455703921587
curr_Factors:  [101.31455704]
mat_Sqrt:  [[0.15]]
grads:  [-0.01512805]
Stock Position:  -0.0151280455637836
Bond Position:  [8.40086611]


portfolio before change:  [6.86029705]
curr_Stock_Price:  101.87000809915247
curr_Factors:  [101.8700081]
mat_Sqrt:  [[0.15]]
grads:  [0.03636268]
Stock Position:  0.036362680459061526
Bond Position:  [3.1560305]


portfolio before change:  [6.86641889]
curr_Stock_Price:  102.03293820479826
curr_Factors:  [102.0329382]
mat_Sqrt:  [[0.15]]
grads:  [0.00058897]
Stock Position:  0.0005889668842026855
Bond Position:  [6.80632486]


portfolio before change:  [6.86755838]
curr_Stock_Price:  103.24537185798718
curr_Factors:  [103.24537186]
mat_Sqrt:  [[0.15]]
grads:  [0.04864065]
Stock Position:  0.04864065043311317
Bond Position:  [1.84563634]


portfolio before change:  [6.88327746]
curr_Stock_Price:  103.56616795097506
curr_Factors:  [103.56616795]
mat_Sqrt:  [[0.15]]
grads:  [0.06806179]
Stock Position:  0.0680617939921992
Bond Position:  [-0.16562172]


portfolio before change:  [6.93599]
curr_Stock_Price:  104.34080065889759
curr_Factors:  [104.34080066]
mat_Sqrt:  [[0.15]]
grads:  [0.00373206]
Stock Position:  0.0037320578189330316
Bond Position:  [6.5465841]


portfolio before change:  [6.93512184]
curr_Stock_Price:  103.9985405157514
curr_Factors:  [103.99854052]
mat_Sqrt:  [[0.15]]
grads:  [0.01183982]
Stock Position:  0.011839824037960972
Bond Position:  [5.70379742]


portfolio before change:  [6.92782469]
curr_Stock_Price:  103.3521079647592
curr_Factors:  [103.35210796]
mat_Sqrt:  [[0.15]]
grads:  [0.11219919]
Stock Position:  0.11219919068018817
Bond Position:  [-4.66819817]


portfolio before change:  [6.94987987]
curr_Stock_Price:  103.55128001935046
curr_Factors:  [103.55128002]
mat_Sqrt:  [[0.15]]
grads:  [0.01369152]
Stock Position:  0.013691524435188186
Bond Position:  [5.53210499]


portfolio before change:  [6.94320471]
curr_Stock_Price:  103.03848629004003
curr_Factors:  [103.03848629]
mat_Sqrt:  [[0.15]]
grads:  [0.10866226]
Stock Position:  0.10866225807187091
Bond Position:  [-4.25318988]


portfolio before change:  [6.91341635]
curr_Stock_Price:  102.76679560045365
curr_Factors:  [102.7667956]
mat_Sqrt:  [[0.15]]
grads:  [0.00412228]
Stock Position:  0.004122277770708654
Bond Position:  [6.48978307]


portfolio before change:  [6.9148987]
curr_Stock_Price:  103.02799181882864
curr_Factors:  [103.02799182]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310597]
Stock Position:  -0.08310596934023111
Bond Position:  [15.47713983]


portfolio before change:  [6.93200645]
curr_Stock_Price:  102.8337770561484
curr_Factors:  [102.83377706]
mat_Sqrt:  [[0.15]]
grads:  [0.02090646]
Stock Position:  0.020906459827623586
Bond Position:  [4.78211623]


portfolio before change:  [6.92597464]
curr_Stock_Price:  102.530966150254
curr_Factors:  [102.53096615]
mat_Sqrt:  [[0.15]]
grads:  [0.0066557]
Stock Position:  0.006655701852698546
Bond Position:  [6.2435591]


portfolio before change:  [6.93095875]
curr_Stock_Price:  103.2211827911965
curr_Factors:  [103.22118279]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615193]
Stock Position:  -0.036151932270518584
Bond Position:  [10.66260396]


portfolio before change:  [6.95294972]
curr_Stock_Price:  102.63132417001502
curr_Factors:  [102.63132417]
mat_Sqrt:  [[0.15]]
grads:  [0.10030904]
Stock Position:  0.10030904304063833
Bond Position:  [-3.3419002]


portfolio before change:  [7.00259769]
curr_Stock_Price:  103.1283566264824
curr_Factors:  [103.12835663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05539139]
Stock Position:  -0.055391390853409966
Bond Position:  [12.7150208]


portfolio before change:  [7.0028381]
curr_Stock_Price:  103.1383636250664
curr_Factors:  [103.13836363]
mat_Sqrt:  [[0.15]]
grads:  [0.05676529]
Stock Position:  0.05676528666845849
Bond Position:  [1.14815932]


portfolio before change:  [6.99005433]
curr_Stock_Price:  102.91189536916276
curr_Factors:  [102.91189537]
mat_Sqrt:  [[0.15]]
grads:  [-0.08258458]
Stock Position:  -0.08258458385703626
Bond Position:  [15.48899038]


portfolio before change:  [7.01000513]
curr_Stock_Price:  102.68203758988142
curr_Factors:  [102.68203759]
mat_Sqrt:  [[0.15]]
grads:  [0.08300829]
Stock Position:  0.08300828715915011
Bond Position:  [-1.51345493]


portfolio before change:  [7.05776342]
curr_Stock_Price:  103.25852083120003
curr_Factors:  [103.25852083]
mat_Sqrt:  [[0.15]]
grads:  [0.01429041]
Stock Position:  0.014290406833643143
Bond Position:  [5.58215715]


portfolio before change:  [7.04825903]
curr_Stock_Price:  102.56901695748654
curr_Factors:  [102.56901696]
mat_Sqrt:  [[0.15]]
grads:  [0.1411357]
Stock Position:  0.14113569909338536
Bond Position:  [-7.42789089]


portfolio before change:  [7.05540633]
curr_Stock_Price:  102.62294777217721
curr_Factors:  [102.62294777]
mat_Sqrt:  [[0.15]]
grads:  [-0.14989697]
Stock Position:  -0.1498969671869521
Bond Position:  [22.43827497]


portfolio before change:  [7.06616548]
curr_Stock_Price:  102.56052684257459
curr_Factors:  [102.56052684]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857403]
Stock Position:  -0.008574027619151449
Bond Position:  [7.94552227]


portfolio before change:  [7.06230809]
curr_Stock_Price:  103.06833948227792
curr_Factors:  [103.06833948]
mat_Sqrt:  [[0.15]]
grads:  [-0.05567395]
Stock Position:  -0.055673945683877735
Bond Position:  [12.80052922]


portfolio before change:  [7.06507227]
curr_Stock_Price:  103.03306051914605
curr_Factors:  [103.03306052]
mat_Sqrt:  [[0.15]]
grads:  [-0.0308952]
Stock Position:  -0.030895202406569598
Bond Position:  [10.24829953]


portfolio before change:  [7.08868371]
curr_Stock_Price:  102.28954997355012
curr_Factors:  [102.28954997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.08868371]
Stock Price:  102.6852049246229
PL:  [4.40347879]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.43804089e-03]
 [-5.93188310e-03]
 [-4.38860324e-03]
 [ 8.02079142e-03]
 [ 4.32422219e-03]
 [ 2.58028139e-02]
 [ 1.45258077e-03]
 [ 8.64232417e-04]
 [ 2.32090027e-02]
 [-4.58258345e-03]
 [ 1.71922030e-02]
 [-1.33086394e-02]
 [ 1.12838439e-02]
 [ 2.94390735e-03]
 [-6.91320874e-03]
 [ 9.41970665e-03]
 [ 7.24699891e-03]
 [-9.83271339e-03]
 [-4.56853863e-04]
 [ 1.51412567e-02]
 [ 1.14750637e-02]
 [-7.49131406e-03]
 [ 6.83330986e-03]
 [ 2.28043561e-02]
 [ 1.97356855e-03]
 [ 1.00358236e-02]
 [-6.03481088e-03]
 [ 7.73985121e-03]
 [ 1.73685077e-02]
 [-1.55124394e-03]
 [ 1.48255265e-02]
 [-8.63717603e-03]
 [-2.75047651e-03]
 [ 7.45507826e-03]
 [ 1.00785615e-02]
 [ 7.06546463e-03]
 [-3.21384239e-02]
 [ 8.72964897e-03]
 [ 1.27385693e-02]
 [ 7.27421095e-03]
 [-5.51690172e-03]
 [-1.47189910e-02]
 [ 2.04810989e-02]
 [-3.51563156e-03]
 [ 1.17800032e-02]
 [-1.46912897e-02]
 [ 1.53471030e-02]
 [ 1.63525949e-02]
 [ 6.59872160e-03]
 [-7.50626861e-03]
 [-1.41573342e-02]
 [ 2.90637280e-03]
 [-8.93633915e-03]
 [ 5.91378543e-03]
 [-1.05885789e-02]
 [ 1.14176090e-02]
 [ 1.09988500e-02]
 [ 8.02045614e-04]
 [ 1.83232370e-03]
 [ 1.30491280e-02]
 [ 8.41165216e-03]
 [ 3.95628699e-02]
 [-3.01606368e-03]
 [-1.22379369e-02]
 [ 1.54338213e-02]
 [ 8.08582839e-03]
 [-4.86762289e-03]
 [ 1.57498262e-02]
 [-2.36901400e-02]
 [-4.71806337e-02]
 [-4.57546800e-03]
 [ 1.66361019e-02]
 [-3.45209043e-02]
 [ 2.81340360e-02]
 [-2.74948351e-02]
 [ 2.37014900e-03]
 [ 2.76046394e-03]
 [-1.24556462e-02]
 [ 2.60577293e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.26215544]
curr_Stock_Price:  99.6551250322129
curr_Factors:  [99.65512503]
mat_Sqrt:  [[0.15]]
grads:  [0.02292027]
Stock Position:  0.02292027257532332
Bond Position:  [-5.54627807]


portfolio before change:  [-3.26912011]
curr_Stock_Price:  99.36638429493273
curr_Factors:  [99.36638429]
mat_Sqrt:  [[0.15]]
grads:  [-0.03954589]
Stock Position:  -0.03954588731895806
Bond Position:  [0.66041173]


portfolio before change:  [-3.24622566]
curr_Stock_Price:  98.78849426253318
curr_Factors:  [98.78849426]
mat_Sqrt:  [[0.15]]
grads:  [-0.02925735]
Stock Position:  -0.029257354963831986
Bond Position:  [-0.35593562]


portfolio before change:  [-3.26041637]
curr_Stock_Price:  99.27276439523834
curr_Factors:  [99.2727644]
mat_Sqrt:  [[0.15]]
grads:  [0.05347194]
Stock Position:  0.0534719428034161
Bond Position:  [-8.56872395]


portfolio before change:  [-3.22550812]
curr_Stock_Price:  99.93561314339854
curr_Factors:  [99.93561314]
mat_Sqrt:  [[0.15]]
grads:  [0.02882815]
Stock Position:  0.028828147918047872
Bond Position:  [-6.10646676]


portfolio before change:  [-3.21651808]
curr_Stock_Price:  100.2607017971707
curr_Factors:  [100.2607018]
mat_Sqrt:  [[0.15]]
grads:  [0.17201876]
Stock Position:  0.17201875909199615
Bond Position:  [-20.46323959]


portfolio before change:  [-3.06852235]
curr_Stock_Price:  101.12848344600148
curr_Factors:  [101.12848345]
mat_Sqrt:  [[0.15]]
grads:  [0.00968387]
Stock Position:  0.009683871826787812
Bond Position:  [-4.04783762]


portfolio before change:  [-3.06621692]
curr_Stock_Price:  101.39267806246004
curr_Factors:  [101.39267806]
mat_Sqrt:  [[0.15]]
grads:  [0.00576155]
Stock Position:  0.005761549443903484
Bond Position:  [-3.65039585]


portfolio before change:  [-3.06692355]
curr_Stock_Price:  101.30963306020195
curr_Factors:  [101.30963306]
mat_Sqrt:  [[0.15]]
grads:  [0.15472668]
Stock Position:  0.1547266847861353
Bond Position:  [-18.74222721]


portfolio before change:  [-3.00446609]
curr_Stock_Price:  101.72086711569146
curr_Factors:  [101.72086712]
mat_Sqrt:  [[0.15]]
grads:  [-0.03055056]
Stock Position:  -0.030550556357000352
Bond Position:  [0.10316299]


portfolio before change:  [-2.98148794]
curr_Stock_Price:  100.96894283537613
curr_Factors:  [100.96894284]
mat_Sqrt:  [[0.15]]
grads:  [0.11461469]
Stock Position:  0.11461468644803545
Bond Position:  [-14.55401166]


portfolio before change:  [-3.07077053]
curr_Stock_Price:  100.19789905096528
curr_Factors:  [100.19789905]
mat_Sqrt:  [[0.15]]
grads:  [-0.08872426]
Stock Position:  -0.08872426274644463
Bond Position:  [5.81921419]


portfolio before change:  [-3.1069978]
curr_Stock_Price:  100.61031131240787
curr_Factors:  [100.61031131]
mat_Sqrt:  [[0.15]]
grads:  [0.07522563]
Stock Position:  0.07522562613213639
Bond Position:  [-10.67547146]


portfolio before change:  [-3.135598]
curr_Stock_Price:  100.23898882439991
curr_Factors:  [100.23898882]
mat_Sqrt:  [[0.15]]
grads:  [0.01962605]
Stock Position:  0.0196260490306643
Bond Position:  [-5.10289331]


portfolio before change:  [-3.14138676]
curr_Stock_Price:  99.96028697940898
curr_Factors:  [99.96028698]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608806]
Stock Position:  -0.0460880582896849
Bond Position:  [1.46558878]


portfolio before change:  [-3.11785597]
curr_Stock_Price:  99.45171293033265
curr_Factors:  [99.45171293]
mat_Sqrt:  [[0.15]]
grads:  [0.06279804]
Stock Position:  0.06279804430512326
Bond Position:  [-9.36322904]


portfolio before change:  [-3.12210514]
curr_Stock_Price:  99.39336792049264
curr_Factors:  [99.39336792]
mat_Sqrt:  [[0.15]]
grads:  [0.04831333]
Stock Position:  0.04831332609967327
Bond Position:  [-7.92412933]


portfolio before change:  [-3.14063766]
curr_Stock_Price:  99.02002890827018
curr_Factors:  [99.02002891]
mat_Sqrt:  [[0.15]]
grads:  [-0.06555142]
Stock Position:  -0.06555142259787841
Bond Position:  [3.3502661]


portfolio before change:  [-3.18903373]
curr_Stock_Price:  99.76151505804917
curr_Factors:  [99.76151506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00304569]
Stock Position:  -0.003045692420706482
Bond Position:  [-2.88519084]


portfolio before change:  [-3.18774848]
curr_Stock_Price:  99.28031700968967
curr_Factors:  [99.28031701]
mat_Sqrt:  [[0.15]]
grads:  [0.10094171]
Stock Position:  0.10094171164112728
Bond Position:  [-13.20927361]


portfolio before change:  [-3.16506161]
curr_Stock_Price:  99.5132482707927
curr_Factors:  [99.51324827]
mat_Sqrt:  [[0.15]]
grads:  [0.07650042]
Stock Position:  0.07650042493945934
Bond Position:  [-10.77786739]


portfolio before change:  [-3.10207394]
curr_Stock_Price:  100.34541760635616
curr_Factors:  [100.34541761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04994209]
Stock Position:  -0.04994209370327937
Bond Position:  [1.90938631]


portfolio before change:  [-3.11404308]
curr_Stock_Price:  100.5874676082998
curr_Factors:  [100.58746761]
mat_Sqrt:  [[0.15]]
grads:  [0.0455554]
Stock Position:  0.04555539904815462
Bond Position:  [-7.69634531]


portfolio before change:  [-3.09316026]
curr_Stock_Price:  101.05643190144256
curr_Factors:  [101.0564319]
mat_Sqrt:  [[0.15]]
grads:  [0.15202904]
Stock Position:  0.15202904053621685
Bond Position:  [-18.45667265]


portfolio before change:  [-2.99200288]
curr_Stock_Price:  101.72940174236763
curr_Factors:  [101.72940174]
mat_Sqrt:  [[0.15]]
grads:  [0.01315712]
Stock Position:  0.01315712365155324
Bond Position:  [-4.3304692]


portfolio before change:  [-2.98880793]
curr_Stock_Price:  101.99280361819007
curr_Factors:  [101.99280362]
mat_Sqrt:  [[0.15]]
grads:  [0.06690549]
Stock Position:  0.06690549095271332
Bond Position:  [-9.81268653]


portfolio before change:  [-3.05886617]
curr_Stock_Price:  100.95484806147574
curr_Factors:  [100.95484806]
mat_Sqrt:  [[0.15]]
grads:  [-0.04023207]
Stock Position:  -0.04023207252859481
Bond Position:  [1.0027566]


portfolio before change:  [-3.06800262]
curr_Stock_Price:  101.18349958037116
curr_Factors:  [101.18349958]
mat_Sqrt:  [[0.15]]
grads:  [0.05159901]
Stock Position:  0.05159900808529668
Bond Position:  [-8.28897084]


portfolio before change:  [-3.05825967]
curr_Stock_Price:  101.38236062011002
curr_Factors:  [101.38236062]
mat_Sqrt:  [[0.15]]
grads:  [0.11579005]
Stock Position:  0.11579005115196118
Bond Position:  [-14.79732839]


portfolio before change:  [-3.02625136]
curr_Stock_Price:  101.66678202906546
curr_Factors:  [101.66678203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034163]
Stock Position:  -0.010341626242401479
Bond Position:  [-1.9748515]


portfolio before change:  [-3.03520951]
curr_Stock_Price:  102.52106875957557
curr_Factors:  [102.52106876]
mat_Sqrt:  [[0.15]]
grads:  [0.09883684]
Stock Position:  0.09883684323649464
Bond Position:  [-13.16806831]


portfolio before change:  [-3.01476252]
curr_Stock_Price:  102.73627207123775
curr_Factors:  [102.73627207]
mat_Sqrt:  [[0.15]]
grads:  [-0.05758117]
Stock Position:  -0.05758117350141541
Bond Position:  [2.90091259]


portfolio before change:  [-3.12270782]
curr_Stock_Price:  104.61408394776973
curr_Factors:  [104.61408395]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833651]
Stock Position:  -0.018336510038117534
Bond Position:  [-1.20445062]


portfolio before change:  [-3.13124604]
curr_Stock_Price:  105.07561905066926
curr_Factors:  [105.07561905]
mat_Sqrt:  [[0.15]]
grads:  [0.04970052]
Stock Position:  0.04970052174017399
Bond Position:  [-8.35355913]


portfolio before change:  [-3.16819801]
curr_Stock_Price:  104.34263169542925
curr_Factors:  [104.3426317]
mat_Sqrt:  [[0.15]]
grads:  [0.06719041]
Stock Position:  0.06719041011011526
Bond Position:  [-10.17902222]


portfolio before change:  [-3.20577684]
curr_Stock_Price:  103.79281184403752
curr_Factors:  [103.79281184]
mat_Sqrt:  [[0.15]]
grads:  [0.0471031]
Stock Position:  0.04710309752127841
Bond Position:  [-8.09473978]


portfolio before change:  [-3.15847908]
curr_Stock_Price:  104.80768555868669
curr_Factors:  [104.80768556]
mat_Sqrt:  [[0.15]]
grads:  [-0.21425616]
Stock Position:  -0.21425615909941864
Bond Position:  [19.29721307]


portfolio before change:  [-3.11094611]
curr_Stock_Price:  104.59146371677066
curr_Factors:  [104.59146372]
mat_Sqrt:  [[0.15]]
grads:  [0.05819766]
Stock Position:  0.05819765977115382
Bond Position:  [-9.19792453]


portfolio before change:  [-3.13938]
curr_Stock_Price:  104.11276739157191
curr_Factors:  [104.11276739]
mat_Sqrt:  [[0.15]]
grads:  [0.0849238]
Stock Position:  0.08492379514526976
Bond Position:  [-11.98103133]


portfolio before change:  [-3.15530901]
curr_Stock_Price:  103.93401683034664
curr_Factors:  [103.93401683]
mat_Sqrt:  [[0.15]]
grads:  [0.04849474]
Stock Position:  0.04849473964264231
Bond Position:  [-8.1955621]


portfolio before change:  [-3.09134187]
curr_Stock_Price:  105.26363274935962
curr_Factors:  [105.26363275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03677934]
Stock Position:  -0.03677934478526606
Bond Position:  [0.78018557]


portfolio before change:  [-3.08145685]
curr_Stock_Price:  104.99619295591613
curr_Factors:  [104.99619296]
mat_Sqrt:  [[0.15]]
grads:  [-0.09812661]
Stock Position:  -0.0981266069033217
Bond Position:  [7.2214633]


portfolio before change:  [-3.00867537]
curr_Stock_Price:  104.25908271461493
curr_Factors:  [104.25908271]
mat_Sqrt:  [[0.15]]
grads:  [0.13654066]
Stock Position:  0.13654065962043405
Bond Position:  [-17.24427929]


portfolio before change:  [-2.98554352]
curr_Stock_Price:  104.43638994768135
curr_Factors:  [104.43638995]
mat_Sqrt:  [[0.15]]
grads:  [-0.02343754]
Stock Position:  -0.023437543741127824
Bond Position:  [-0.53781107]


portfolio before change:  [-2.993362]
curr_Stock_Price:  104.76854353152294
curr_Factors:  [104.76854353]
mat_Sqrt:  [[0.15]]
grads:  [0.07853335]
Stock Position:  0.0785333543712072
Bond Position:  [-11.22118716]


portfolio before change:  [-2.97620146]
curr_Stock_Price:  104.99598688560867
curr_Factors:  [104.99598689]
mat_Sqrt:  [[0.15]]
grads:  [-0.09794193]
Stock Position:  -0.09794193164612364
Bond Position:  [7.30730831]


portfolio before change:  [-2.96807452]
curr_Stock_Price:  104.91767290655551
curr_Factors:  [104.91767291]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-13.70262337]


portfolio before change:  [-2.96613066]
curr_Stock_Price:  104.94504255124637
curr_Factors:  [104.94504255]
mat_Sqrt:  [[0.15]]
grads:  [0.1090173]
Stock Position:  0.10901729958677345
Bond Position:  [-14.4069558]


portfolio before change:  [-2.98391191]
curr_Stock_Price:  104.79019750857798
curr_Factors:  [104.79019751]
mat_Sqrt:  [[0.15]]
grads:  [0.04399148]
Stock Position:  0.04399147732796902
Bond Position:  [-7.59378751]


portfolio before change:  [-2.98597389]
curr_Stock_Price:  104.7541143399383
curr_Factors:  [104.75411434]
mat_Sqrt:  [[0.15]]
grads:  [-0.05004179]
Stock Position:  -0.05004179072337193
Bond Position:  [2.25610958]


portfolio before change:  [-2.95719858]
curr_Stock_Price:  104.18190663227296
curr_Factors:  [104.18190663]
mat_Sqrt:  [[0.15]]
grads:  [-0.09438223]
Stock Position:  -0.0943822282098709
Bond Position:  [6.87572191]


portfolio before change:  [-2.92460639]
curr_Stock_Price:  103.84113865202403
curr_Factors:  [103.84113865]
mat_Sqrt:  [[0.15]]
grads:  [0.01937582]
Stock Position:  0.01937581863733235
Bond Position:  [-4.93661346]


portfolio before change:  [-2.92621986]
curr_Stock_Price:  103.7737905455172
curr_Factors:  [103.77379055]
mat_Sqrt:  [[0.15]]
grads:  [-0.05957559]
Stock Position:  -0.05957559433930245
Bond Position:  [3.25616539]


portfolio before change:  [-2.95920129]
curr_Stock_Price:  104.33081300012684
curr_Factors:  [104.330813]
mat_Sqrt:  [[0.15]]
grads:  [0.03942524]
Stock Position:  0.03942523622970938
Bond Position:  [-7.07246824]


portfolio before change:  [-2.96713944]
curr_Stock_Price:  104.14067831913432
curr_Factors:  [104.14067832]
mat_Sqrt:  [[0.15]]
grads:  [-0.07059053]
Stock Position:  -0.07059052609373384
Bond Position:  [4.38420583]


portfolio before change:  [-2.94748942]
curr_Stock_Price:  103.86619401507136
curr_Factors:  [103.86619402]
mat_Sqrt:  [[0.15]]
grads:  [0.07611739]
Stock Position:  0.07611739356121718
Bond Position:  [-10.85351339]


portfolio before change:  [-2.89651974]
curr_Stock_Price:  104.54472558243938
curr_Factors:  [104.54472558]
mat_Sqrt:  [[0.15]]
grads:  [0.07332567]
Stock Position:  0.07332566671074184
Bond Position:  [-10.56233144]


portfolio before change:  [-2.87937872]
curr_Stock_Price:  104.78749442743408
curr_Factors:  [104.78749443]
mat_Sqrt:  [[0.15]]
grads:  [0.00534697]
Stock Position:  0.005346970761819197
Bond Position:  [-3.43967438]


portfolio before change:  [-2.87905272]
curr_Stock_Price:  104.88867015942341
curr_Factors:  [104.88867016]
mat_Sqrt:  [[0.15]]
grads:  [0.01221549]
Stock Position:  0.012215491355282392
Bond Position:  [-4.16031936]


portfolio before change:  [-2.88905302]
curr_Stock_Price:  104.0912994840974
curr_Factors:  [104.09129948]
mat_Sqrt:  [[0.15]]
grads:  [0.08699419]
Stock Position:  0.08699418653271662
Bond Position:  [-11.94439094]


portfolio before change:  [-2.86537159]
curr_Stock_Price:  104.37209961206783
curr_Factors:  [104.37209961]
mat_Sqrt:  [[0.15]]
grads:  [0.05607768]
Stock Position:  0.05607768104487254
Bond Position:  [-8.7183169]


portfolio before change:  [-2.77181741]
curr_Stock_Price:  106.05011292223753
curr_Factors:  [106.05011292]
mat_Sqrt:  [[0.15]]
grads:  [0.26375247]
Stock Position:  0.26375246599258534
Bond Position:  [-30.74279621]


portfolio before change:  [-2.59443225]
curr_Stock_Price:  106.72994217981257
curr_Factors:  [106.72994218]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010709]
Stock Position:  -0.02010709120421745
Bond Position:  [-0.44840357]


portfolio before change:  [-2.57950024]
curr_Stock_Price:  105.9859241460776
curr_Factors:  [105.98592415]
mat_Sqrt:  [[0.15]]
grads:  [-0.08158625]
Stock Position:  -0.08158624624178379
Bond Position:  [6.06749347]


portfolio before change:  [-2.56453577]
curr_Stock_Price:  105.8071533605365
curr_Factors:  [105.80715336]
mat_Sqrt:  [[0.15]]
grads:  [0.10289214]
Stock Position:  0.10289214175537885
Bond Position:  [-13.45126039]


portfolio before change:  [-2.48925328]
curr_Stock_Price:  106.54698847028355
curr_Factors:  [106.54698847]
mat_Sqrt:  [[0.15]]
grads:  [0.05390552]
Stock Position:  0.05390552259110247
Bond Position:  [-8.23272437]


portfolio before change:  [-2.45157298]
curr_Stock_Price:  107.25554033990917
curr_Factors:  [107.25554034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03245082]
Stock Position:  -0.03245081927044184
Bond Position:  [1.02895717]


portfolio before change:  [-2.47093741]
curr_Stock_Price:  107.85425374563286
curr_Factors:  [107.85425375]
mat_Sqrt:  [[0.15]]
grads:  [0.10499884]
Stock Position:  0.10499884159735379
Bond Position:  [-13.79550912]


portfolio before change:  [-2.39374798]
curr_Stock_Price:  108.59761127130423
curr_Factors:  [108.59761127]
mat_Sqrt:  [[0.15]]
grads:  [-0.15793427]
Stock Position:  -0.1579342666600167
Bond Position:  [14.75753612]


portfolio before change:  [-2.34943616]
curr_Stock_Price:  108.32288025198078
curr_Factors:  [108.32288025]
mat_Sqrt:  [[0.15]]
grads:  [-0.31453756]
Stock Position:  -0.31453755799386685
Bond Position:  [31.72217807]


portfolio before change:  [-2.1770762]
curr_Stock_Price:  107.78120484887462
curr_Factors:  [107.78120485]
mat_Sqrt:  [[0.15]]
grads:  [-0.03050312]
Stock Position:  -0.03050312003255992
Bond Position:  [1.11058682]


portfolio before change:  [-2.19527208]
curr_Stock_Price:  108.38000560843379
curr_Factors:  [108.38000561]
mat_Sqrt:  [[0.15]]
grads:  [0.11090735]
Stock Position:  0.11090734625816455
Bond Position:  [-14.21541089]


portfolio before change:  [-2.21053756]
curr_Stock_Price:  108.25037497825683
curr_Factors:  [108.25037498]
mat_Sqrt:  [[0.15]]
grads:  [-0.23013936]
Stock Position:  -0.23013936190943737
Bond Position:  [22.70213466]


portfolio before change:  [-1.88261507]
curr_Stock_Price:  106.83165388680337
curr_Factors:  [106.83165389]
mat_Sqrt:  [[0.15]]
grads:  [0.18756024]
Stock Position:  0.1875602399618039
Bond Position:  [-21.91998571]


portfolio before change:  [-2.00274237]
curr_Stock_Price:  106.19848526216785
curr_Factors:  [106.19848526]
mat_Sqrt:  [[0.15]]
grads:  [-0.1832989]
Stock Position:  -0.18329890076212868
Bond Position:  [17.46332324]


portfolio before change:  [-1.8373265]
curr_Stock_Price:  105.30200208223944
curr_Factors:  [105.30200208]
mat_Sqrt:  [[0.15]]
grads:  [0.01580099]
Stock Position:  0.01580099331360288
Bond Position:  [-3.50120273]


portfolio before change:  [-1.83381323]
curr_Stock_Price:  105.53819610301976
curr_Factors:  [105.5381961]
mat_Sqrt:  [[0.15]]
grads:  [0.01840309]
Stock Position:  0.018403092960834835
Bond Position:  [-3.77604246]


portfolio before change:  [-1.8349776]
curr_Stock_Price:  105.48774992884685
curr_Factors:  [105.48774993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303764]
Stock Position:  -0.08303764106107939
Bond Position:  [6.92447631]


portfolio before change:  [-1.83374539]
curr_Stock_Price:  105.47812275946283
curr_Factors:  [105.47812276]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.83374539]
Stock Price:  106.10721012465017
PL:  [-7.94095552]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.28026301e-03]
 [-3.36810998e-03]
 [-1.66856981e-04]
 [ 8.28545607e-03]
 [ 1.23453266e-02]
 [ 2.73704097e-02]
 [ 2.73509902e-03]
 [ 1.61500417e-02]
 [ 2.46002895e-02]
 [-2.74657820e-03]
 [ 4.03209425e-02]
 [-2.35165509e-02]
 [ 6.64946583e-02]
 [ 1.21660908e-02]
 [-6.89312054e-03]
 [ 2.92105173e-02]
 [ 1.32633572e-02]
 [-8.00881850e-03]
 [ 2.58244033e-03]
 [-5.56575951e-03]
 [ 1.30520836e-02]
 [-3.54356010e-03]
 [ 1.10864916e-02]
 [-2.59154346e-02]
 [ 3.06032629e-03]
 [ 7.39291727e-03]
 [-5.23547722e-03]
 [ 1.05764002e-02]
 [ 2.59964923e-02]
 [ 1.37927550e-03]
 [ 1.19804522e-02]
 [-1.18616736e-02]
 [ 8.67885474e-03]
 [ 7.81543744e-03]
 [ 1.14329777e-02]
 [ 8.63441728e-03]
 [-3.36906810e-02]
 [ 9.60744864e-03]
 [ 7.62317907e-03]
 [ 1.90679561e-02]
 [-4.76663078e-03]
 [-2.17772311e-02]
 [ 2.09613311e-02]
 [ 3.88796199e-04]
 [-4.78996497e-03]
 [-1.12882324e-02]
 [ 1.47490874e-02]
 [ 1.25340865e-02]
 [ 5.52086675e-03]
 [-7.47872678e-03]
 [ 1.47808373e-02]
 [ 3.79175595e-03]
 [-1.00267989e-02]
 [ 5.86766537e-03]
 [-1.24800560e-02]
 [ 1.61243132e-02]
 [ 1.15540835e-02]
 [ 8.70018217e-04]
 [ 1.76053539e-03]
 [ 1.48105533e-02]
 [-8.04609230e-04]
 [ 2.00382031e-02]
 [ 1.96128214e-03]
 [-1.24499326e-02]
 [ 1.12130363e-03]
 [-3.59603962e-04]
 [-5.49395054e-03]
 [ 2.06930013e-02]
 [-8.26176437e-03]
 [ 8.75568603e-03]
 [-1.07661656e-02]
 [ 1.11326510e-02]
 [-5.23638206e-03]
 [ 1.77408469e-02]
 [-2.24825910e-02]
 [-3.34763288e-03]
 [-7.85913446e-03]
 [-1.78123354e-03]
 [-4.24990556e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.56840707]
curr_Stock_Price:  99.70023599162383
curr_Factors:  [99.70023599]
mat_Sqrt:  [[0.15]]
grads:  [0.02186842]
Stock Position:  0.021868420056004464
Bond Position:  [-4.74869371]


portfolio before change:  [-2.57401937]
curr_Stock_Price:  99.4571685928283
curr_Factors:  [99.45716859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245407]
Stock Position:  -0.022454066506377688
Bond Position:  [-0.34080149]


portfolio before change:  [-2.57981722]
curr_Stock_Price:  99.71442925704457
curr_Factors:  [99.71442926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00111238]
Stock Position:  -0.0011123798713934727
Bond Position:  [-2.4688969]


portfolio before change:  [-2.57959682]
curr_Stock_Price:  99.37757756320549
curr_Factors:  [99.37757756]
mat_Sqrt:  [[0.15]]
grads:  [0.05523637]
Stock Position:  0.05523637381563839
Bond Position:  [-8.06885385]


portfolio before change:  [-2.48775924]
curr_Stock_Price:  101.04933645502696
curr_Factors:  [101.04933646]
mat_Sqrt:  [[0.15]]
grads:  [0.08230218]
Stock Position:  0.08230217720357065
Bond Position:  [-10.80433964]


portfolio before change:  [-2.45997224]
curr_Stock_Price:  101.39516322475411
curr_Factors:  [101.39516322]
mat_Sqrt:  [[0.15]]
grads:  [0.1824694]
Stock Position:  0.1824693978052874
Bond Position:  [-20.96148661]


portfolio before change:  [-2.4010849]
curr_Stock_Price:  101.7250676921846
curr_Factors:  [101.72506769]
mat_Sqrt:  [[0.15]]
grads:  [0.01823399]
Stock Position:  0.018233993490935917
Bond Position:  [-4.25593913]


portfolio before change:  [-2.38327156]
curr_Stock_Price:  102.71658661819092
curr_Factors:  [102.71658662]
mat_Sqrt:  [[0.15]]
grads:  [0.10766694]
Stock Position:  0.10766694436820413
Bond Position:  [-13.44245258]


portfolio before change:  [-2.43990439]
curr_Stock_Price:  102.19838993214168
curr_Factors:  [102.19838993]
mat_Sqrt:  [[0.15]]
grads:  [0.16400193]
Stock Position:  0.16400193015978684
Bond Position:  [-19.2006376]


portfolio before change:  [-2.28224127]
curr_Stock_Price:  103.16705658945608
curr_Factors:  [103.16705659]
mat_Sqrt:  [[0.15]]
grads:  [-0.01831052]
Stock Position:  -0.018310521349585388
Bond Position:  [-0.39319868]


portfolio before change:  [-2.27011611]
curr_Stock_Price:  102.50351847288589
curr_Factors:  [102.50351847]
mat_Sqrt:  [[0.15]]
grads:  [0.26880628]
Stock Position:  0.26880628332548295
Bond Position:  [-29.82370594]


portfolio before change:  [-2.35642881]
curr_Stock_Price:  102.18935671163098
curr_Factors:  [102.18935671]
mat_Sqrt:  [[0.15]]
grads:  [-0.15677701]
Stock Position:  -0.1567770062748781
Bond Position:  [13.66451261]


portfolio before change:  [-2.33578309]
curr_Stock_Price:  102.06311589429409
curr_Factors:  [102.06311589]
mat_Sqrt:  [[0.15]]
grads:  [0.44329772]
Stock Position:  0.44329772225297187
Bond Position:  [-47.5801299]


portfolio before change:  [-2.07870978]
curr_Stock_Price:  102.64973555778319
curr_Factors:  [102.64973556]
mat_Sqrt:  [[0.15]]
grads:  [0.08110727]
Stock Position:  0.08110727189936702
Bond Position:  [-10.4043498]


portfolio before change:  [-2.02919878]
curr_Stock_Price:  103.26819178113372
curr_Factors:  [103.26819178]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595414]
Stock Position:  -0.04595413690940729
Bond Position:  [2.71640184]


portfolio before change:  [-2.0174808]
curr_Stock_Price:  103.0168933931481
curr_Factors:  [103.01689339]
mat_Sqrt:  [[0.15]]
grads:  [0.19473678]
Stock Position:  0.19473678209316334
Bond Position:  [-22.07865912]


portfolio before change:  [-1.94464364]
curr_Stock_Price:  103.39800845661664
curr_Factors:  [103.39800846]
mat_Sqrt:  [[0.15]]
grads:  [0.08842238]
Stock Position:  0.08842238115078924
Bond Position:  [-11.08734175]


portfolio before change:  [-1.98494477]
curr_Stock_Price:  102.9500658123099
curr_Factors:  [102.95006581]
mat_Sqrt:  [[0.15]]
grads:  [-0.05339212]
Stock Position:  -0.053392123347570736
Bond Position:  [3.51177784]


portfolio before change:  [-1.93050526]
curr_Stock_Price:  101.93455982345675
curr_Factors:  [101.93455982]
mat_Sqrt:  [[0.15]]
grads:  [0.01721627]
Stock Position:  0.017216268899964204
Bond Position:  [-3.68543805]


portfolio before change:  [-1.93603713]
curr_Stock_Price:  101.62662290090755
curr_Factors:  [101.6266229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03710506]
Stock Position:  -0.03710506342353082
Bond Position:  [1.83482516]


portfolio before change:  [-1.92863341]
curr_Stock_Price:  101.43017958784976
curr_Factors:  [101.43017959]
mat_Sqrt:  [[0.15]]
grads:  [0.08701389]
Stock Position:  0.08701389095396372
Bond Position:  [-10.75446799]


portfolio before change:  [-1.90964702]
curr_Stock_Price:  101.6561040216132
curr_Factors:  [101.65610402]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362373]
Stock Position:  -0.023623733972077447
Bond Position:  [0.49184974]


portfolio before change:  [-1.92336941]
curr_Stock_Price:  102.23827845886883
curr_Factors:  [102.23827846]
mat_Sqrt:  [[0.15]]
grads:  [0.07390994]
Stock Position:  0.07390994372277974
Bond Position:  [-9.47979482]


portfolio before change:  [-1.86720164]
curr_Stock_Price:  103.00624386066862
curr_Factors:  [103.00624386]
mat_Sqrt:  [[0.15]]
grads:  [-0.17276956]
Stock Position:  -0.17276956412318495
Bond Position:  [15.92914222]


portfolio before change:  [-1.73424533]
curr_Stock_Price:  102.24244786539865
curr_Factors:  [102.24244787]
mat_Sqrt:  [[0.15]]
grads:  [0.02040218]
Stock Position:  0.02040217523451638
Bond Position:  [-3.82021367]


portfolio before change:  [-1.72190993]
curr_Stock_Price:  102.85876335173342
curr_Factors:  [102.85876335]
mat_Sqrt:  [[0.15]]
grads:  [0.04928612]
Stock Position:  0.04928611513031254
Bond Position:  [-6.79141878]


portfolio before change:  [-1.71153783]
curr_Stock_Price:  103.07782253331492
curr_Factors:  [103.07782253]
mat_Sqrt:  [[0.15]]
grads:  [-0.03490318]
Stock Position:  -0.034903181498936536
Bond Position:  [1.88620612]


portfolio before change:  [-1.68926481]
curr_Stock_Price:  102.44306294011136
curr_Factors:  [102.44306294]
mat_Sqrt:  [[0.15]]
grads:  [0.07050933]
Stock Position:  0.07050933486336337
Bond Position:  [-8.91245704]


portfolio before change:  [-1.72990046]
curr_Stock_Price:  101.87464729657512
curr_Factors:  [101.8746473]
mat_Sqrt:  [[0.15]]
grads:  [0.17330995]
Stock Position:  0.17330994834011254
Bond Position:  [-19.38579032]


portfolio before change:  [-1.58298723]
curr_Stock_Price:  102.72932922971955
curr_Factors:  [102.72932923]
mat_Sqrt:  [[0.15]]
grads:  [0.00919517]
Stock Position:  0.009195169998251181
Bond Position:  [-2.52760088]


portfolio before change:  [-1.59156284]
curr_Stock_Price:  101.81388863528628
curr_Factors:  [101.81388864]
mat_Sqrt:  [[0.15]]
grads:  [0.07986968]
Stock Position:  0.07986968137779436
Bond Position:  [-9.72340569]


portfolio before change:  [-1.60727017]
curr_Stock_Price:  101.62483573207389
curr_Factors:  [101.62483573]
mat_Sqrt:  [[0.15]]
grads:  [-0.07907782]
Stock Position:  -0.07907782387479949
Bond Position:  [6.42900069]


portfolio before change:  [-1.59567757]
curr_Stock_Price:  101.48331969391718
curr_Factors:  [101.48331969]
mat_Sqrt:  [[0.15]]
grads:  [0.05785903]
Stock Position:  0.057859031616556665
Bond Position:  [-7.46740417]


portfolio before change:  [-1.60874291]
curr_Stock_Price:  101.26557293838488
curr_Factors:  [101.26557294]
mat_Sqrt:  [[0.15]]
grads:  [0.05210292]
Stock Position:  0.05210291625949591
Bond Position:  [-6.88497458]


portfolio before change:  [-1.61576378]
curr_Stock_Price:  101.1390819602196
curr_Factors:  [101.13908196]
mat_Sqrt:  [[0.15]]
grads:  [0.07621985]
Stock Position:  0.07621985107142955
Bond Position:  [-9.32456955]


portfolio before change:  [-1.59194182]
curr_Stock_Price:  101.45927110258226
curr_Factors:  [101.4592711]
mat_Sqrt:  [[0.15]]
grads:  [0.05756278]
Stock Position:  0.057562781851073455
Bond Position:  [-7.43221971]


portfolio before change:  [-1.57471238]
curr_Stock_Price:  101.76665666962843
curr_Factors:  [101.76665667]
mat_Sqrt:  [[0.15]]
grads:  [-0.22460454]
Stock Position:  -0.22460453973158073
Bond Position:  [21.2825407]


portfolio before change:  [-1.52165891]
curr_Stock_Price:  101.53637073756893
curr_Factors:  [101.53637074]
mat_Sqrt:  [[0.15]]
grads:  [0.06404966]
Stock Position:  0.0640496575900419
Bond Position:  [-8.02502869]


portfolio before change:  [-1.44695673]
curr_Stock_Price:  102.7105184354416
curr_Factors:  [102.71051844]
mat_Sqrt:  [[0.15]]
grads:  [0.05082119]
Stock Position:  0.050821193772630086
Bond Position:  [-6.66682789]


portfolio before change:  [-1.5010472]
curr_Stock_Price:  101.65438871067487
curr_Factors:  [101.65438871]
mat_Sqrt:  [[0.15]]
grads:  [0.12711971]
Stock Position:  0.12711970700621972
Bond Position:  [-14.4233233]


portfolio before change:  [-1.41450523]
curr_Stock_Price:  102.34227142740176
curr_Factors:  [102.34227143]
mat_Sqrt:  [[0.15]]
grads:  [-0.03177754]
Stock Position:  -0.03177753851037627
Bond Position:  [1.83768024]


portfolio before change:  [-1.40353426]
curr_Stock_Price:  102.00064274485983
curr_Factors:  [102.00064274]
mat_Sqrt:  [[0.15]]
grads:  [-0.14518154]
Stock Position:  -0.14518154098956332
Bond Position:  [13.40507624]


portfolio before change:  [-1.50971787]
curr_Stock_Price:  102.73779886940262
curr_Factors:  [102.73779887]
mat_Sqrt:  [[0.15]]
grads:  [0.13974221]
Stock Position:  0.13974220737838833
Bond Position:  [-15.86652467]


portfolio before change:  [-1.57263595]
curr_Stock_Price:  102.2946515565327
curr_Factors:  [102.29465156]
mat_Sqrt:  [[0.15]]
grads:  [0.00259197]
Stock Position:  0.0025919746602722817
Bond Position:  [-1.83778109]


portfolio before change:  [-1.57394589]
curr_Stock_Price:  101.83358385331957
curr_Factors:  [101.83358385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319331]
Stock Position:  -0.03193309981593759
Bond Position:  [1.67791611]


portfolio before change:  [-1.58669592]
curr_Stock_Price:  102.2361412185951
curr_Factors:  [102.23614122]
mat_Sqrt:  [[0.15]]
grads:  [-0.07525488]
Stock Position:  -0.07525488243296727
Bond Position:  [6.10707287]


portfolio before change:  [-1.70452555]
curr_Stock_Price:  103.80695405185291
curr_Factors:  [103.80695405]
mat_Sqrt:  [[0.15]]
grads:  [0.09832725]
Stock Position:  0.09832724929889546
Bond Position:  [-11.9115778]


portfolio before change:  [-1.65377092]
curr_Stock_Price:  104.3307064086578
curr_Factors:  [104.33070641]
mat_Sqrt:  [[0.15]]
grads:  [0.08356058]
Stock Position:  0.08356057694250757
Bond Position:  [-10.37170494]


portfolio before change:  [-1.65593267]
curr_Stock_Price:  104.31259377539372
curr_Factors:  [104.31259378]
mat_Sqrt:  [[0.15]]
grads:  [0.03680578]
Stock Position:  0.03680577830994421
Bond Position:  [-5.49523887]


portfolio before change:  [-1.64853183]
curr_Stock_Price:  104.52300390917932
curr_Factors:  [104.52300391]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985818]
Stock Position:  -0.04985817854281418
Bond Position:  [3.56279476]


portfolio before change:  [-1.70135241]
curr_Stock_Price:  105.586886756208
curr_Factors:  [105.58688676]
mat_Sqrt:  [[0.15]]
grads:  [0.09853892]
Stock Position:  0.09853891535201524
Bond Position:  [-12.1057697]


portfolio before change:  [-1.7277289]
curr_Stock_Price:  105.32688934057356
curr_Factors:  [105.32688934]
mat_Sqrt:  [[0.15]]
grads:  [0.02527837]
Stock Position:  0.02527837302954967
Bond Position:  [-4.3902213]


portfolio before change:  [-1.72027822]
curr_Stock_Price:  105.63248970531343
curr_Factors:  [105.63248971]
mat_Sqrt:  [[0.15]]
grads:  [-0.06684533]
Stock Position:  -0.06684532577333695
Bond Position:  [5.34075997]


portfolio before change:  [-1.70368448]
curr_Stock_Price:  105.38924254392825
curr_Factors:  [105.38924254]
mat_Sqrt:  [[0.15]]
grads:  [0.03911777]
Stock Position:  0.03911776915304573
Bond Position:  [-5.82627654]


portfolio before change:  [-1.73353927]
curr_Stock_Price:  104.63534872819523
curr_Factors:  [104.63534873]
mat_Sqrt:  [[0.15]]
grads:  [-0.08320037]
Stock Position:  -0.08320037345290814
Bond Position:  [6.97216082]


portfolio before change:  [-1.72809608]
curr_Stock_Price:  104.57516359135893
curr_Factors:  [104.57516359]
mat_Sqrt:  [[0.15]]
grads:  [0.10749542]
Stock Position:  0.10749542140865552
Bond Position:  [-12.96944735]


portfolio before change:  [-1.70597067]
curr_Stock_Price:  104.78853099239855
curr_Factors:  [104.78853099]
mat_Sqrt:  [[0.15]]
grads:  [0.07702722]
Stock Position:  0.07702722311096136
Bond Position:  [-9.77754023]


portfolio before change:  [-1.69700673]
curr_Stock_Price:  104.91283838994507
curr_Factors:  [104.91283839]
mat_Sqrt:  [[0.15]]
grads:  [0.00580012]
Stock Position:  0.005800121447208971
Bond Position:  [-2.30551394]


portfolio before change:  [-1.70381022]
curr_Stock_Price:  103.76469285260808
curr_Factors:  [103.76469285]
mat_Sqrt:  [[0.15]]
grads:  [0.0117369]
Stock Position:  0.011736902573095951
Bond Position:  [-2.92168631]


portfolio before change:  [-1.70505501]
curr_Stock_Price:  103.67419332357474
curr_Factors:  [103.67419332]
mat_Sqrt:  [[0.15]]
grads:  [0.09873702]
Stock Position:  0.09873702206549606
Bond Position:  [-11.94153613]


portfolio before change:  [-1.75671258]
curr_Stock_Price:  103.15856909268084
curr_Factors:  [103.15856909]
mat_Sqrt:  [[0.15]]
grads:  [-0.00536406]
Stock Position:  -0.005364061532413678
Bond Position:  [-1.20336367]


portfolio before change:  [-1.75927865]
curr_Stock_Price:  103.6229296361864
curr_Factors:  [103.62292964]
mat_Sqrt:  [[0.15]]
grads:  [0.13358802]
Stock Position:  0.13358802065956013
Bond Position:  [-15.60206072]


portfolio before change:  [-1.83342719]
curr_Stock_Price:  103.07517563544884
curr_Factors:  [103.07517564]
mat_Sqrt:  [[0.15]]
grads:  [0.01307521]
Stock Position:  0.013075214282699393
Bond Position:  [-3.18115719]


portfolio before change:  [-1.83498624]
curr_Stock_Price:  102.97114471719406
curr_Factors:  [102.97114472]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299955]
Stock Position:  -0.0829995504927324
Bond Position:  [6.71157248]


portfolio before change:  [-1.79165087]
curr_Stock_Price:  102.45408306571265
curr_Factors:  [102.45408307]
mat_Sqrt:  [[0.15]]
grads:  [0.00747536]
Stock Position:  0.007475357512783214
Bond Position:  [-2.55753177]


portfolio before change:  [-1.79921414]
curr_Stock_Price:  101.46370600320728
curr_Factors:  [101.463706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00239736]
Stock Position:  -0.0023973597461836075
Bond Position:  [-1.55596914]


portfolio before change:  [-1.79776511]
curr_Stock_Price:  100.81871057635556
curr_Factors:  [100.81871058]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662634]
Stock Position:  -0.03662633691230152
Bond Position:  [1.89485495]


portfolio before change:  [-1.79976509]
curr_Stock_Price:  100.87654903585056
curr_Factors:  [100.87654904]
mat_Sqrt:  [[0.15]]
grads:  [0.13795334]
Stock Position:  0.13795334203832108
Bond Position:  [-15.71602216]


portfolio before change:  [-1.73459053]
curr_Stock_Price:  101.35610858195481
curr_Factors:  [101.35610858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05507843]
Stock Position:  -0.05507842916300905
Bond Position:  [3.84794472]


portfolio before change:  [-1.70495627]
curr_Stock_Price:  100.8224376810494
curr_Factors:  [100.82243768]
mat_Sqrt:  [[0.15]]
grads:  [0.05837124]
Stock Position:  0.05837124017550789
Bond Position:  [-7.59008699]


portfolio before change:  [-1.70686348]
curr_Stock_Price:  100.79789107676496
curr_Factors:  [100.79789108]
mat_Sqrt:  [[0.15]]
grads:  [-0.07177444]
Stock Position:  -0.07177443707714398
Bond Position:  [5.52784841]


portfolio before change:  [-1.72332402]
curr_Stock_Price:  101.0320418893507
curr_Factors:  [101.03204189]
mat_Sqrt:  [[0.15]]
grads:  [0.07421767]
Stock Position:  0.07421767331226484
Bond Position:  [-9.2216871]


portfolio before change:  [-1.69823303]
curr_Stock_Price:  101.37788088207489
curr_Factors:  [101.37788088]
mat_Sqrt:  [[0.15]]
grads:  [-0.03490921]
Stock Position:  -0.0349092137208665
Bond Position:  [1.84078908]


portfolio before change:  [-1.68677474]
curr_Stock_Price:  101.05294563203202
curr_Factors:  [101.05294563]
mat_Sqrt:  [[0.15]]
grads:  [0.11827231]
Stock Position:  0.11827231271331255
Bond Position:  [-13.63854033]


portfolio before change:  [-1.63658178]
curr_Stock_Price:  101.48453776378301
curr_Factors:  [101.48453776]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988394]
Stock Position:  -0.14988393971842806
Bond Position:  [13.57432056]


portfolio before change:  [-1.63751618]
curr_Stock_Price:  101.49643247845465
curr_Factors:  [101.49643248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231755]
Stock Position:  -0.022317552518053514
Bond Position:  [0.62763578]


portfolio before change:  [-1.61422384]
curr_Stock_Price:  100.45451210887583
curr_Factors:  [100.45451211]
mat_Sqrt:  [[0.15]]
grads:  [-0.05239423]
Stock Position:  -0.05239422973504264
Bond Position:  [3.64901294]


portfolio before change:  [-1.60854204]
curr_Stock_Price:  100.35042179722731
curr_Factors:  [100.3504218]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187489]
Stock Position:  -0.011874890265129086
Bond Position:  [-0.41689179]


portfolio before change:  [-1.60057083]
curr_Stock_Price:  99.67696198998273
curr_Factors:  [99.67696199]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.60057083]
Stock Price:  99.5533531831298
PL:  [-1.60057083]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.40198464e-03]
 [-2.75249753e-03]
 [-4.63479689e-04]
 [ 8.24573454e-03]
 [ 4.59463456e-03]
 [ 2.73061793e-02]
 [ 3.25909780e-03]
 [ 1.57768312e-02]
 [ 2.45162838e-02]
 [-4.87821749e-03]
 [ 3.18989933e-02]
 [ 1.49340649e-02]
 [ 1.41122639e-01]
 [ 1.91594398e-02]
 [-6.89527025e-03]
 [ 3.25931833e-02]
 [ 1.49632202e-02]
 [ 3.25176965e-03]
 [ 1.49260705e-02]
 [-1.11758292e-02]
 [ 1.55455167e-02]
 [-1.63552839e-02]
 [ 1.08711872e-02]
 [-4.76705737e-02]
 [ 8.21605463e-03]
 [ 6.85389891e-03]
 [-5.27711055e-03]
 [ 1.40040808e-02]
 [ 4.97125575e-02]
 [ 3.47310331e-03]
 [ 1.91526952e-02]
 [-8.29252642e-04]
 [-3.48222832e-03]
 [ 6.73738255e-03]
 [ 9.34606532e-03]
 [ 2.72188615e-03]
 [-3.10067125e-02]
 [ 8.24381055e-03]
 [ 2.68612427e-02]
 [-3.26700120e-02]
 [-9.29124518e-03]
 [-1.06407374e-02]
 [ 1.95420512e-02]
 [-8.86779586e-03]
 [ 2.80987671e-02]
 [-3.46982413e-03]
 [ 1.54418188e-02]
 [ 3.00636848e-02]
 [ 1.05393112e-02]
 [-7.74670472e-03]
 [ 4.21045845e-02]
 [ 1.02086777e-02]
 [-1.03027068e-02]
 [ 5.77257723e-03]
 [-2.52897180e-02]
 [ 3.52921819e-02]
 [ 2.01790249e-02]
 [ 2.91449438e-03]
 [ 2.22569276e-03]
 [-1.05709497e-02]
 [ 2.87852557e-02]
 [ 6.16951349e-02]
 [-1.07455212e-02]
 [-1.13073562e-02]
 [ 2.23498341e-02]
 [ 1.11393512e-02]
 [-4.42602440e-03]
 [ 1.58914489e-02]
 [-2.85298603e-02]
 [-6.28787588e-02]
 [ 3.60940795e-03]
 [ 1.79694318e-02]
 [-5.41836342e-02]
 [ 2.98166242e-02]
 [-3.15263965e-02]
 [ 8.68847513e-03]
 [ 1.25156322e-02]
 [-1.94892853e-02]
 [ 1.94156458e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.34001046]
curr_Stock_Price:  98.93478796492343
curr_Factors:  [98.93478796]
mat_Sqrt:  [[0.15]]
grads:  [0.05601323]
Stock Position:  0.05601323092814065
Bond Position:  [-19.88166759]


portfolio before change:  [-14.30985509]
curr_Stock_Price:  99.49533427720249
curr_Factors:  [99.49533428]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834998]
Stock Position:  -0.01834998352638456
Bond Position:  [-12.48411735]


portfolio before change:  [-14.32423921]
curr_Stock_Price:  100.23668821925074
curr_Factors:  [100.23668822]
mat_Sqrt:  [[0.15]]
grads:  [-0.00308986]
Stock Position:  -0.003089864594766912
Bond Position:  [-14.01452141]


portfolio before change:  [-14.32407977]
curr_Stock_Price:  99.90160174915239
curr_Factors:  [99.90160175]
mat_Sqrt:  [[0.15]]
grads:  [0.05497156]
Stock Position:  0.054971563630673445
Bond Position:  [-19.81582703]


portfolio before change:  [-14.29027088]
curr_Stock_Price:  100.53915723319889
curr_Factors:  [100.53915723]
mat_Sqrt:  [[0.15]]
grads:  [0.0306309]
Stock Position:  0.030630897090728436
Bond Position:  [-17.36987546]


portfolio before change:  [-14.26217172]
curr_Stock_Price:  101.49194693382762
curr_Factors:  [101.49194693]
mat_Sqrt:  [[0.15]]
grads:  [0.1820412]
Stock Position:  0.1820411951625368
Bond Position:  [-32.73788704]


portfolio before change:  [-14.17629851]
curr_Stock_Price:  101.97491122646505
curr_Factors:  [101.97491123]
mat_Sqrt:  [[0.15]]
grads:  [0.02172732]
Stock Position:  0.021727318674883454
Bond Position:  [-16.3919399]


portfolio before change:  [-14.16235661]
curr_Stock_Price:  102.66374111461354
curr_Factors:  [102.66374111]
mat_Sqrt:  [[0.15]]
grads:  [0.10517887]
Stock Position:  0.10517887490367812
Bond Position:  [-24.9604134]


portfolio before change:  [-14.15802645]
curr_Stock_Price:  102.71974321316505
curr_Factors:  [102.71974321]
mat_Sqrt:  [[0.15]]
grads:  [0.16344189]
Stock Position:  0.16344189201723155
Bond Position:  [-30.94673563]


portfolio before change:  [-14.24474455]
curr_Stock_Price:  102.20100306394657
curr_Factors:  [102.20100306]
mat_Sqrt:  [[0.15]]
grads:  [-0.03252145]
Stock Position:  -0.032521449913293476
Bond Position:  [-10.92101975]


portfolio before change:  [-14.23700228]
curr_Stock_Price:  101.94194784966137
curr_Factors:  [101.94194785]
mat_Sqrt:  [[0.15]]
grads:  [0.21265996]
Stock Position:  0.21265995507455052
Bond Position:  [-35.91597233]


portfolio before change:  [-14.07408276]
curr_Stock_Price:  102.71860722438589
curr_Factors:  [102.71860722]
mat_Sqrt:  [[0.15]]
grads:  [0.09956043]
Stock Position:  0.09956043266440236
Bond Position:  [-24.30079173]


portfolio before change:  [-13.95085894]
curr_Stock_Price:  103.97154132420307
curr_Factors:  [103.97154132]
mat_Sqrt:  [[0.15]]
grads:  [0.94081759]
Stock Position:  0.9408175928283347
Bond Position:  [-111.76911417]


portfolio before change:  [-14.09272244]
curr_Stock_Price:  103.82817908993374
curr_Factors:  [103.82817909]
mat_Sqrt:  [[0.15]]
grads:  [0.1277296]
Stock Position:  0.12772959875232495
Bond Position:  [-27.3546541]


portfolio before change:  [-14.19935283]
curr_Stock_Price:  103.00675110888645
curr_Factors:  [103.00675111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596847]
Stock Position:  -0.045968468364451016
Bond Position:  [-9.46429025]


portfolio before change:  [-14.23716612]
curr_Stock_Price:  103.81647469065554
curr_Factors:  [103.81647469]
mat_Sqrt:  [[0.15]]
grads:  [0.21728789]
Stock Position:  0.21728788866785004
Bond Position:  [-36.79522871]


portfolio before change:  [-14.17213261]
curr_Stock_Price:  104.1263551958037
curr_Factors:  [104.1263552]
mat_Sqrt:  [[0.15]]
grads:  [0.0997548]
Stock Position:  0.09975480112013431
Bond Position:  [-24.55923646]


portfolio before change:  [-14.16361544]
curr_Stock_Price:  104.22712397325084
curr_Factors:  [104.22712397]
mat_Sqrt:  [[0.15]]
grads:  [0.02167846]
Stock Position:  0.02167846433320183
Bond Position:  [-16.42309943]


portfolio before change:  [-14.1580504]
curr_Stock_Price:  104.53118238966125
curr_Factors:  [104.53118239]
mat_Sqrt:  [[0.15]]
grads:  [0.09950714]
Stock Position:  0.09950713635801771
Bond Position:  [-24.55964902]


portfolio before change:  [-14.11423917]
curr_Stock_Price:  104.98689097511198
curr_Factors:  [104.98689098]
mat_Sqrt:  [[0.15]]
grads:  [-0.07450553]
Stock Position:  -0.0745055278728191
Bond Position:  [-6.29213543]


portfolio before change:  [-14.13735301]
curr_Stock_Price:  105.29184253139744
curr_Factors:  [105.29184253]
mat_Sqrt:  [[0.15]]
grads:  [0.10363678]
Stock Position:  0.10363677792058376
Bond Position:  [-25.04946032]


portfolio before change:  [-14.20953683]
curr_Stock_Price:  104.61044185020936
curr_Factors:  [104.61044185]
mat_Sqrt:  [[0.15]]
grads:  [-0.10903523]
Stock Position:  -0.10903522569521351
Bond Position:  [-2.80331369]


portfolio before change:  [-14.14323562]
curr_Stock_Price:  104.00076352963788
curr_Factors:  [104.00076353]
mat_Sqrt:  [[0.15]]
grads:  [0.07247458]
Stock Position:  0.07247458101734477
Bond Position:  [-21.68064739]


portfolio before change:  [-14.15523863]
curr_Stock_Price:  103.85384417736815
curr_Factors:  [103.85384418]
mat_Sqrt:  [[0.15]]
grads:  [-0.31780382]
Stock Position:  -0.317803824359375
Bond Position:  [18.84991023]


portfolio before change:  [-14.1578686]
curr_Stock_Price:  103.86582681529282
curr_Factors:  [103.86582682]
mat_Sqrt:  [[0.15]]
grads:  [0.0547737]
Stock Position:  0.054773697547235274
Bond Position:  [-19.84698398]


portfolio before change:  [-14.17011414]
curr_Stock_Price:  103.66490797119826
curr_Factors:  [103.66490797]
mat_Sqrt:  [[0.15]]
grads:  [0.04569266]
Stock Position:  0.04569265938661168
Bond Position:  [-18.90683947]


portfolio before change:  [-14.20460851]
curr_Stock_Price:  102.93584872806119
curr_Factors:  [102.93584873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03518074]
Stock Position:  -0.03518073702768535
Bond Position:  [-10.58324949]


portfolio before change:  [-14.22375874]
curr_Stock_Price:  103.46138506483034
curr_Factors:  [103.46138506]
mat_Sqrt:  [[0.15]]
grads:  [0.09336054]
Stock Position:  0.09336053841529901
Bond Position:  [-23.88296936]


portfolio before change:  [-14.20900303]
curr_Stock_Price:  103.6354247968522
curr_Factors:  [103.6354248]
mat_Sqrt:  [[0.15]]
grads:  [0.33141705]
Stock Position:  0.33141705019540446
Bond Position:  [-48.55554981]


portfolio before change:  [-14.32047564]
curr_Stock_Price:  103.30823041055704
curr_Factors:  [103.30823041]
mat_Sqrt:  [[0.15]]
grads:  [0.02315402]
Stock Position:  0.02315402208800063
Bond Position:  [-16.71247669]


portfolio before change:  [-14.30526087]
curr_Stock_Price:  104.01045556991467
curr_Factors:  [104.01045557]
mat_Sqrt:  [[0.15]]
grads:  [0.12768463]
Stock Position:  0.1276846344388187
Bond Position:  [-27.58579787]


portfolio before change:  [-14.31929754]
curr_Stock_Price:  103.91402652132737
curr_Factors:  [103.91402652]
mat_Sqrt:  [[0.15]]
grads:  [-0.00552835]
Stock Position:  -0.0055283509437973185
Bond Position:  [-13.74482434]


portfolio before change:  [-14.32626883]
curr_Stock_Price:  105.01963691670923
curr_Factors:  [105.01963692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321486]
Stock Position:  -0.02321485548749875
Bond Position:  [-11.88825313]


portfolio before change:  [-14.35691602]
curr_Stock_Price:  106.30778422165956
curr_Factors:  [106.30778422]
mat_Sqrt:  [[0.15]]
grads:  [0.04491588]
Stock Position:  0.044915883699931276
Bond Position:  [-19.13182409]


portfolio before change:  [-14.32616981]
curr_Stock_Price:  107.01893547601631
curr_Factors:  [107.01893548]
mat_Sqrt:  [[0.15]]
grads:  [0.0623071]
Stock Position:  0.06230710212065868
Bond Position:  [-20.99420955]


portfolio before change:  [-14.35822578]
curr_Stock_Price:  106.52551184493419
curr_Factors:  [106.52551184]
mat_Sqrt:  [[0.15]]
grads:  [0.01814591]
Stock Position:  0.018145907643635658
Bond Position:  [-16.29122788]


portfolio before change:  [-14.35655399]
curr_Stock_Price:  106.67375635521974
curr_Factors:  [106.67375636]
mat_Sqrt:  [[0.15]]
grads:  [-0.20671142]
Stock Position:  -0.20671141685826927
Bond Position:  [7.69412933]


portfolio before change:  [-14.466853]
curr_Stock_Price:  107.20967215940378
curr_Factors:  [107.20967216]
mat_Sqrt:  [[0.15]]
grads:  [0.05495874]
Stock Position:  0.0549587369717488
Bond Position:  [-20.35896118]


portfolio before change:  [-14.42988459]
curr_Stock_Price:  107.90548299079364
curr_Factors:  [107.90548299]
mat_Sqrt:  [[0.15]]
grads:  [0.17907495]
Stock Position:  0.1790749512896126
Bond Position:  [-33.7530537]


portfolio before change:  [-14.32752264]
curr_Stock_Price:  108.48887886350441
curr_Factors:  [108.48887886]
mat_Sqrt:  [[0.15]]
grads:  [-0.21780008]
Stock Position:  -0.21780007988889666
Bond Position:  [9.30136385]


portfolio before change:  [-14.10049117]
curr_Stock_Price:  107.44916340921736
curr_Factors:  [107.44916341]
mat_Sqrt:  [[0.15]]
grads:  [-0.06194163]
Stock Position:  -0.06194163452284504
Bond Position:  [-7.44491436]


portfolio before change:  [-14.08462781]
curr_Stock_Price:  107.18554933139862
curr_Factors:  [107.18554933]
mat_Sqrt:  [[0.15]]
grads:  [-0.07093825]
Stock Position:  -0.07093824932619576
Bond Position:  [-6.48107259]


portfolio before change:  [-14.08845619]
curr_Stock_Price:  107.23380688076122
curr_Factors:  [107.23380688]
mat_Sqrt:  [[0.15]]
grads:  [0.13028034]
Stock Position:  0.1302803410647414
Bond Position:  [-28.05891313]


portfolio before change:  [-14.06447072]
curr_Stock_Price:  107.431374797632
curr_Factors:  [107.4313748]
mat_Sqrt:  [[0.15]]
grads:  [-0.05911864]
Stock Position:  -0.05911863908246842
Bond Position:  [-7.71327404]


portfolio before change:  [-14.07737298]
curr_Stock_Price:  107.64146365074562
curr_Factors:  [107.64146365]
mat_Sqrt:  [[0.15]]
grads:  [0.18732511]
Stock Position:  0.1873251143102712
Bond Position:  [-34.24132246]


portfolio before change:  [-14.13148899]
curr_Stock_Price:  107.36400023853352
curr_Factors:  [107.36400024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313216]
Stock Position:  -0.023132160838286016
Bond Position:  [-11.64792767]


portfolio before change:  [-14.12455227]
curr_Stock_Price:  107.03265439342664
curr_Factors:  [107.03265439]
mat_Sqrt:  [[0.15]]
grads:  [0.10294546]
Stock Position:  0.10294545896817624
Bond Position:  [-25.143078]


portfolio before change:  [-14.11586678]
curr_Stock_Price:  107.13228946904877
curr_Factors:  [107.13228947]
mat_Sqrt:  [[0.15]]
grads:  [0.20042457]
Stock Position:  0.20042456526961552
Bond Position:  [-35.58780932]


portfolio before change:  [-14.2375429]
curr_Stock_Price:  106.53629558235362
curr_Factors:  [106.53629558]
mat_Sqrt:  [[0.15]]
grads:  [0.07026207]
Stock Position:  0.07026207435712901
Bond Position:  [-21.72300402]


portfolio before change:  [-14.22236242]
curr_Stock_Price:  106.77167451704535
curr_Factors:  [106.77167452]
mat_Sqrt:  [[0.15]]
grads:  [-0.0516447]
Stock Position:  -0.05164469814000604
Bond Position:  [-8.70817152]


portfolio before change:  [-14.22819001]
curr_Stock_Price:  106.8739757110564
curr_Factors:  [106.87397571]
mat_Sqrt:  [[0.15]]
grads:  [0.28069723]
Stock Position:  0.28069723032010596
Bond Position:  [-44.22741899]


portfolio before change:  [-14.16286004]
curr_Stock_Price:  107.11656547498858
curr_Factors:  [107.11656547]
mat_Sqrt:  [[0.15]]
grads:  [0.06805785]
Stock Position:  0.06805785122094672
Bond Position:  [-21.45298331]


portfolio before change:  [-14.23319713]
curr_Stock_Price:  106.102777432721
curr_Factors:  [106.10277743]
mat_Sqrt:  [[0.15]]
grads:  [-0.06868471]
Stock Position:  -0.06868471191442187
Bond Position:  [-6.94555842]


portfolio before change:  [-14.28881198]
curr_Stock_Price:  106.90616932750586
curr_Factors:  [106.90616933]
mat_Sqrt:  [[0.15]]
grads:  [0.03848385]
Stock Position:  0.03848384817842062
Bond Position:  [-18.40297277]


portfolio before change:  [-14.25260928]
curr_Stock_Price:  107.87678220310558
curr_Factors:  [107.8767822]
mat_Sqrt:  [[0.15]]
grads:  [-0.16859812]
Stock Position:  -0.1685981198642099
Bond Position:  [3.93521338]


portfolio before change:  [-14.1825017]
curr_Stock_Price:  107.46241446796418
curr_Factors:  [107.46241447]
mat_Sqrt:  [[0.15]]
grads:  [0.23528121]
Stock Position:  0.23528121284283338
Bond Position:  [-39.46638891]


portfolio before change:  [-13.92301443]
curr_Stock_Price:  108.57578001875137
curr_Factors:  [108.57578002]
mat_Sqrt:  [[0.15]]
grads:  [0.13452683]
Stock Position:  0.13452683263590737
Bond Position:  [-28.52937022]


portfolio before change:  [-13.87617208]
curr_Stock_Price:  108.93723572984321
curr_Factors:  [108.93723573]
mat_Sqrt:  [[0.15]]
grads:  [0.01942996]
Stock Position:  0.019429962545378602
Bond Position:  [-15.99281849]


portfolio before change:  [-13.86311388]
curr_Stock_Price:  109.66074631877224
curr_Factors:  [109.66074632]
mat_Sqrt:  [[0.15]]
grads:  [0.01483795]
Stock Position:  0.01483795171759712
Bond Position:  [-15.49025474]


portfolio before change:  [-13.86372896]
curr_Stock_Price:  109.68454248863372
curr_Factors:  [109.68454249]
mat_Sqrt:  [[0.15]]
grads:  [-0.070473]
Stock Position:  -0.07047299787627057
Bond Position:  [-6.13393043]


portfolio before change:  [-13.87084947]
curr_Stock_Price:  109.7801410827647
curr_Factors:  [109.78014108]
mat_Sqrt:  [[0.15]]
grads:  [0.1919017]
Stock Position:  0.1919017044714081
Bond Position:  [-34.93784566]


portfolio before change:  [-13.8495066]
curr_Stock_Price:  109.90273795140466
curr_Factors:  [109.90273795]
mat_Sqrt:  [[0.15]]
grads:  [0.4113009]
Stock Position:  0.4113008996529142
Bond Position:  [-59.0526016]


portfolio before change:  [-13.7805036]
curr_Stock_Price:  110.07947937170977
curr_Factors:  [110.07947937]
mat_Sqrt:  [[0.15]]
grads:  [-0.07163681]
Stock Position:  -0.07163680800528058
Bond Position:  [-5.89476107]


portfolio before change:  [-13.74403242]
curr_Stock_Price:  109.56522395406823
curr_Factors:  [109.56522395]
mat_Sqrt:  [[0.15]]
grads:  [-0.07538237]
Stock Position:  -0.07538237459305251
Bond Position:  [-5.48474566]


portfolio before change:  [-13.80349631]
curr_Stock_Price:  110.34950650884691
curr_Factors:  [110.34950651]
mat_Sqrt:  [[0.15]]
grads:  [0.14899889]
Stock Position:  0.1489988941662173
Bond Position:  [-30.24545075]


portfolio before change:  [-13.94034013]
curr_Stock_Price:  109.44377206992166
curr_Factors:  [109.44377207]
mat_Sqrt:  [[0.15]]
grads:  [0.07426234]
Stock Position:  0.0742623412068652
Bond Position:  [-22.06789088]


portfolio before change:  [-14.00330355]
curr_Stock_Price:  108.61449406665498
curr_Factors:  [108.61449407]
mat_Sqrt:  [[0.15]]
grads:  [-0.02950683]
Stock Position:  -0.02950682933272052
Bond Position:  [-10.79843421]


portfolio before change:  [-14.01555097]
curr_Stock_Price:  109.00669138481467
curr_Factors:  [109.00669138]
mat_Sqrt:  [[0.15]]
grads:  [0.10594299]
Stock Position:  0.10594299287670086
Bond Position:  [-25.5640461]


portfolio before change:  [-13.93010095]
curr_Stock_Price:  109.82833915849851
curr_Factors:  [109.82833916]
mat_Sqrt:  [[0.15]]
grads:  [-0.19019907]
Stock Position:  -0.19019906868596625
Bond Position:  [6.95914687]


portfolio before change:  [-13.92945774]
curr_Stock_Price:  109.82724427545494
curr_Factors:  [109.82724428]
mat_Sqrt:  [[0.15]]
grads:  [-0.41919173]
Stock Position:  -0.4191917253390156
Bond Position:  [32.10921427]


portfolio before change:  [-14.085639]
curr_Stock_Price:  110.20460894487054
curr_Factors:  [110.20460894]
mat_Sqrt:  [[0.15]]
grads:  [0.02406272]
Stock Position:  0.024062719646748162
Bond Position:  [-16.73746161]


portfolio before change:  [-14.08868013]
curr_Stock_Price:  110.12170053375775
curr_Factors:  [110.12170053]
mat_Sqrt:  [[0.15]]
grads:  [0.11979621]
Stock Position:  0.11979621169077861
Bond Position:  [-27.28084268]


portfolio before change:  [-14.01492531]
curr_Stock_Price:  110.75160291564083
curr_Factors:  [110.75160292]
mat_Sqrt:  [[0.15]]
grads:  [-0.36122423]
Stock Position:  -0.3612242279267083
Bond Position:  [25.99123694]


portfolio before change:  [-13.93933732]
curr_Stock_Price:  110.5468450709701
curr_Factors:  [110.54684507]
mat_Sqrt:  [[0.15]]
grads:  [0.19877749]
Stock Position:  0.19877749481428303
Bond Position:  [-35.91356224]


portfolio before change:  [-14.15685058]
curr_Stock_Price:  109.4638824351962
curr_Factors:  [109.46388244]
mat_Sqrt:  [[0.15]]
grads:  [-0.21017598]
Stock Position:  -0.2101759767759314
Bond Position:  [8.84982783]


portfolio before change:  [-14.15654075]
curr_Stock_Price:  109.46504003605433
curr_Factors:  [109.46504004]
mat_Sqrt:  [[0.15]]
grads:  [0.05792317]
Stock Position:  0.057923167501242254
Bond Position:  [-20.4971026]


portfolio before change:  [-14.16308261]
curr_Stock_Price:  109.37421707228236
curr_Factors:  [109.37421707]
mat_Sqrt:  [[0.15]]
grads:  [0.08343755]
Stock Position:  0.08343754813099939
Bond Position:  [-23.28899912]


portfolio before change:  [-14.18970115]
curr_Stock_Price:  109.07263906843501
curr_Factors:  [109.07263907]
mat_Sqrt:  [[0.15]]
grads:  [-0.12992857]
Stock Position:  -0.12992856856294338
Bond Position:  [-0.01804929]


portfolio before change:  [-14.12794337]
curr_Stock_Price:  108.5973093387634
curr_Factors:  [108.59730934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.12794337]
Stock Price:  108.11584538709651
PL:  [-22.24378876]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.83072119e-03]
 [-1.40539034e-02]
 [-7.85096708e-03]
 [ 6.57503389e-03]
 [-7.89936824e-03]
 [ 8.10715611e-03]
 [ 4.78905922e-03]
 [-2.73279390e-02]
 [-1.66527262e-02]
 [ 3.13538139e-02]
 [ 1.55200060e-03]
 [ 2.60395038e-02]
 [-1.44490592e-02]
 [ 4.13424263e-03]
 [-6.95166642e-03]
 [ 9.68539040e-03]
 [ 9.82411268e-03]
 [-8.88734416e-03]
 [ 1.13892057e-03]
 [ 9.24090829e-03]
 [ 1.28820117e-02]
 [-1.02460172e-02]
 [ 4.37101455e-03]
 [-6.27700600e-03]
 [-8.09056549e-03]
 [-8.17451315e-03]
 [-6.11244009e-03]
 [ 5.78398559e-03]
 [-4.81691078e-03]
 [-1.48189642e-03]
 [ 5.57805406e-03]
 [-1.21546608e-02]
 [ 4.23077655e-03]
 [ 5.56152955e-03]
 [ 1.14955888e-02]
 [ 9.60246620e-03]
 [-3.46063723e-02]
 [ 9.24599012e-03]
 [-1.77634082e-02]
 [ 2.09523936e-02]
 [-6.86378153e-03]
 [ 1.90513838e-02]
 [ 2.30532803e-02]
 [ 4.24543702e-03]
 [ 5.49580529e-05]
 [ 9.25670133e-04]
 [ 1.88325097e-03]
 [-1.21719782e-02]
 [-6.82730491e-03]
 [-2.03958042e-03]
 [ 4.42300424e-02]
 [-7.30106252e-03]
 [ 2.43216513e-03]
 [ 4.93726599e-03]
 [ 4.41205906e-03]
 [ 1.32460728e-03]
 [-8.25888242e-03]
 [-2.43075641e-04]
 [ 1.57609573e-03]
 [-3.64342669e-02]
 [-6.05973623e-03]
 [ 8.03467698e-03]
 [ 1.39573525e-02]
 [-1.86894772e-02]
 [-4.38062511e-03]
 [-1.62252766e-02]
 [-4.32242352e-03]
 [ 5.98927543e-03]
 [-1.60570267e-02]
 [ 1.31370863e-02]
 [ 2.02053625e-03]
 [ 1.22284057e-02]
 [ 3.68929557e-03]
 [ 2.29909371e-03]
 [ 1.62716844e-02]
 [-2.48715495e-02]
 [ 4.71491487e-03]
 [ 8.78528876e-03]
 [ 3.33582808e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96544522]
curr_Stock_Price:  99.54436868438424
curr_Factors:  [99.54436868]
mat_Sqrt:  [[0.15]]
grads:  [0.02553814]
Stock Position:  0.025538141260884974
Bond Position:  [-7.50762337]


portfolio before change:  [-4.97780473]
curr_Stock_Price:  99.07878009780396
curr_Factors:  [99.0787801]
mat_Sqrt:  [[0.15]]
grads:  [-0.09369269]
Stock Position:  -0.09369268931246004
Bond Position:  [4.30515263]


portfolio before change:  [-4.90029565]
curr_Stock_Price:  98.25438287833832
curr_Factors:  [98.25438288]
mat_Sqrt:  [[0.15]]
grads:  [-0.05233978]
Stock Position:  -0.05233978051153016
Bond Position:  [0.24231718]


portfolio before change:  [-4.92428452]
curr_Stock_Price:  98.71300169066363
curr_Factors:  [98.71300169]
mat_Sqrt:  [[0.15]]
grads:  [0.04383356]
Stock Position:  0.04383355926312761
Bond Position:  [-9.25122673]


portfolio before change:  [-4.9620281]
curr_Stock_Price:  97.86512706696644
curr_Factors:  [97.86512707]
mat_Sqrt:  [[0.15]]
grads:  [-0.05266245]
Stock Position:  -0.05266245490866057
Bond Position:  [0.19178974]


portfolio before change:  [-4.94548743]
curr_Stock_Price:  97.55126629055788
curr_Factors:  [97.55126629]
mat_Sqrt:  [[0.15]]
grads:  [0.05404771]
Stock Position:  0.054047707401867484
Bond Position:  [-10.21790973]


portfolio before change:  [-4.95330652]
curr_Stock_Price:  97.41841237253408
curr_Factors:  [97.41841237]
mat_Sqrt:  [[0.15]]
grads:  [0.03192706]
Stock Position:  0.0319270614453848
Bond Position:  [-8.06359016]


portfolio before change:  [-4.95427285]
curr_Stock_Price:  97.40393139196735
curr_Factors:  [97.40393139]
mat_Sqrt:  [[0.15]]
grads:  [-0.18218626]
Stock Position:  -0.18218625973768288
Bond Position:  [12.7913851]


portfolio before change:  [-5.03333947]
curr_Stock_Price:  97.84230753160602
curr_Factors:  [97.84230753]
mat_Sqrt:  [[0.15]]
grads:  [-0.11101817]
Stock Position:  -0.11101817471310031
Bond Position:  [5.82893492]


portfolio before change:  [-5.00629396]
curr_Stock_Price:  97.60197580337561
curr_Factors:  [97.6019758]
mat_Sqrt:  [[0.15]]
grads:  [0.20902543]
Stock Position:  0.2090254258463315
Bond Position:  [-25.40758852]


portfolio before change:  [-4.7917676]
curr_Stock_Price:  98.63589012023377
curr_Factors:  [98.63589012]
mat_Sqrt:  [[0.15]]
grads:  [0.01034667]
Stock Position:  0.010346670695020611
Bond Position:  [-5.81232068]


portfolio before change:  [-4.79752325]
curr_Stock_Price:  98.11472101305635
curr_Factors:  [98.11472101]
mat_Sqrt:  [[0.15]]
grads:  [0.17359669]
Stock Position:  0.17359669199480451
Bond Position:  [-21.82991425]


portfolio before change:  [-4.72829491]
curr_Stock_Price:  98.52136902662754
curr_Factors:  [98.52136903]
mat_Sqrt:  [[0.15]]
grads:  [-0.09632706]
Stock Position:  -0.09632706156539449
Bond Position:  [4.76197907]


portfolio before change:  [-4.66706478]
curr_Stock_Price:  97.88881058473693
curr_Factors:  [97.88881058]
mat_Sqrt:  [[0.15]]
grads:  [0.02756162]
Stock Position:  0.02756161755951794
Bond Position:  [-7.36503874]


portfolio before change:  [-4.63858717]
curr_Stock_Price:  98.93874671530578
curr_Factors:  [98.93874672]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634444]
Stock Position:  -0.046344442826071676
Bond Position:  [-0.05332608]


portfolio before change:  [-4.58354829]
curr_Stock_Price:  97.75106992224936
curr_Factors:  [97.75106992]
mat_Sqrt:  [[0.15]]
grads:  [0.06456927]
Stock Position:  0.06456926930359386
Bond Position:  [-10.89526345]


portfolio before change:  [-4.5744807]
curr_Stock_Price:  97.90204823877009
curr_Factors:  [97.90204824]
mat_Sqrt:  [[0.15]]
grads:  [0.06549408]
Stock Position:  0.06549408453325314
Bond Position:  [-10.98648573]


portfolio before change:  [-4.52211284]
curr_Stock_Price:  98.71211434870888
curr_Factors:  [98.71211435]
mat_Sqrt:  [[0.15]]
grads:  [-0.05924896]
Stock Position:  -0.059248961091816724
Bond Position:  [1.32647738]


portfolio before change:  [-4.50465084]
curr_Stock_Price:  98.41879106851471
curr_Factors:  [98.41879107]
mat_Sqrt:  [[0.15]]
grads:  [0.0075928]
Stock Position:  0.007592803782260453
Bond Position:  [-5.2519254]


portfolio before change:  [-4.51102909]
curr_Stock_Price:  97.62198383992104
curr_Factors:  [97.62198384]
mat_Sqrt:  [[0.15]]
grads:  [0.06160606]
Stock Position:  0.061606055286695986
Bond Position:  [-10.52513443]


portfolio before change:  [-4.56075845]
curr_Stock_Price:  96.82544658382857
curr_Factors:  [96.82544658]
mat_Sqrt:  [[0.15]]
grads:  [0.08588008]
Stock Position:  0.08588007776859126
Bond Position:  [-12.87613533]


portfolio before change:  [-4.53868157]
curr_Stock_Price:  97.09188393866378
curr_Factors:  [97.09188394]
mat_Sqrt:  [[0.15]]
grads:  [-0.06830678]
Stock Position:  -0.06830678112945403
Bond Position:  [2.09335249]


portfolio before change:  [-4.55231191]
curr_Stock_Price:  97.29334528348608
curr_Factors:  [97.29334528]
mat_Sqrt:  [[0.15]]
grads:  [0.0291401]
Stock Position:  0.029140096993047877
Bond Position:  [-7.38744943]


portfolio before change:  [-4.53728297]
curr_Stock_Price:  97.82493822783798
curr_Factors:  [97.82493823]
mat_Sqrt:  [[0.15]]
grads:  [-0.04184671]
Stock Position:  -0.041846706693027445
Bond Position:  [-0.44363147]


portfolio before change:  [-4.55947485]
curr_Stock_Price:  98.35458927514547
curr_Factors:  [98.35458928]
mat_Sqrt:  [[0.15]]
grads:  [-0.0539371]
Stock Position:  -0.053937103290638465
Bond Position:  [0.74548679]


portfolio before change:  [-4.56805736]
curr_Stock_Price:  98.51457378062688
curr_Factors:  [98.51457378]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449675]
Stock Position:  -0.05449675430232855
Bond Position:  [0.80066716]


portfolio before change:  [-4.60361561]
curr_Stock_Price:  99.16797596470037
curr_Factors:  [99.16797596]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407496]
Stock Position:  -0.04074960060568399
Bond Position:  [-0.5625602]


portfolio before change:  [-4.62364507]
curr_Stock_Price:  99.65863839299688
curr_Factors:  [99.65863839]
mat_Sqrt:  [[0.15]]
grads:  [0.0385599]
Stock Position:  0.03855990393329409
Bond Position:  [-8.4664726]


portfolio before change:  [-4.61352665]
curr_Stock_Price:  99.93476957793766
curr_Factors:  [99.93476958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03211274]
Stock Position:  -0.03211273854552247
Bond Position:  [-1.40434752]


portfolio before change:  [-4.58879886]
curr_Stock_Price:  99.16200561591656
curr_Factors:  [99.16200562]
mat_Sqrt:  [[0.15]]
grads:  [-0.00987931]
Stock Position:  -0.009879309444295437
Bond Position:  [-3.60914672]


portfolio before change:  [-4.60203086]
curr_Stock_Price:  100.47853733221588
curr_Factors:  [100.47853733]
mat_Sqrt:  [[0.15]]
grads:  [0.03718703]
Stock Position:  0.037187027092095856
Bond Position:  [-8.33852895]


portfolio before change:  [-4.60017847]
curr_Stock_Price:  100.54236507679714
curr_Factors:  [100.54236508]
mat_Sqrt:  [[0.15]]
grads:  [-0.08103107]
Stock Position:  -0.0810310720418035
Bond Position:  [3.54687716]


portfolio before change:  [-4.58159171]
curr_Stock_Price:  100.31572266993153
curr_Factors:  [100.31572267]
mat_Sqrt:  [[0.15]]
grads:  [0.02820518]
Stock Position:  0.028205176980014256
Bond Position:  [-7.41101442]


portfolio before change:  [-4.58697592]
curr_Stock_Price:  100.14125093515744
curr_Factors:  [100.14125094]
mat_Sqrt:  [[0.15]]
grads:  [0.03707686]
Stock Position:  0.03707686369590366
Bond Position:  [-8.29989943]


portfolio before change:  [-4.55699048]
curr_Stock_Price:  100.96397967034628
curr_Factors:  [100.96397967]
mat_Sqrt:  [[0.15]]
grads:  [0.07663726]
Stock Position:  0.0766372584940571
Bond Position:  [-12.29459308]


portfolio before change:  [-4.57257198]
curr_Stock_Price:  100.77069159477176
curr_Factors:  [100.77069159]
mat_Sqrt:  [[0.15]]
grads:  [0.06401644]
Stock Position:  0.06401644134369686
Bond Position:  [-11.02355305]


portfolio before change:  [-4.61532664]
curr_Stock_Price:  100.11358430897855
curr_Factors:  [100.11358431]
mat_Sqrt:  [[0.15]]
grads:  [-0.23070915]
Stock Position:  -0.23070914884016175
Bond Position:  [18.48179318]


portfolio before change:  [-4.34430852]
curr_Stock_Price:  98.94387354935513
curr_Factors:  [98.94387355]
mat_Sqrt:  [[0.15]]
grads:  [0.06163993]
Stock Position:  0.06163993415598982
Bond Position:  [-10.44320237]


portfolio before change:  [-4.37334474]
curr_Stock_Price:  98.48340097806395
curr_Factors:  [98.48340098]
mat_Sqrt:  [[0.15]]
grads:  [-0.11842272]
Stock Position:  -0.11842272143441522
Bond Position:  [7.28932762]


portfolio before change:  [-4.3272394]
curr_Stock_Price:  98.09791970025108
curr_Factors:  [98.0979197]
mat_Sqrt:  [[0.15]]
grads:  [0.13968262]
Stock Position:  0.13968262394001293
Bond Position:  [-18.02981423]


portfolio before change:  [-4.33311301]
curr_Stock_Price:  98.0639376309592
curr_Factors:  [98.06393763]
mat_Sqrt:  [[0.15]]
grads:  [-0.04575854]
Stock Position:  -0.04575854353580819
Bond Position:  [0.15414995]


portfolio before change:  [-4.31751693]
curr_Stock_Price:  97.72331408939485
curr_Factors:  [97.72331409]
mat_Sqrt:  [[0.15]]
grads:  [0.12700923]
Stock Position:  0.1270092250287285
Bond Position:  [-16.72927932]


portfolio before change:  [-4.33856696]
curr_Stock_Price:  97.5658104329674
curr_Factors:  [97.56581043]
mat_Sqrt:  [[0.15]]
grads:  [0.15368854]
Stock Position:  0.15368853542769995
Bond Position:  [-19.33331348]


portfolio before change:  [-4.35065029]
curr_Stock_Price:  97.49505072115363
curr_Factors:  [97.49505072]
mat_Sqrt:  [[0.15]]
grads:  [0.02830291]
Stock Position:  0.02830291349772383
Bond Position:  [-7.11004428]


portfolio before change:  [-4.34632083]
curr_Stock_Price:  97.66372061961076
curr_Factors:  [97.66372062]
mat_Sqrt:  [[0.15]]
grads:  [0.00036639]
Stock Position:  0.00036638701916736835
Bond Position:  [-4.38210355]


portfolio before change:  [-4.34663513]
curr_Stock_Price:  97.55344026832977
curr_Factors:  [97.55344027]
mat_Sqrt:  [[0.15]]
grads:  [0.00617113]
Stock Position:  0.0061711342186167775
Bond Position:  [-4.9486505]


portfolio before change:  [-4.34745747]
curr_Stock_Price:  97.4703048997575
curr_Factors:  [97.4703049]
mat_Sqrt:  [[0.15]]
grads:  [0.01255501]
Stock Position:  0.012555006438910039
Bond Position:  [-5.57119777]


portfolio before change:  [-4.34396575]
curr_Stock_Price:  97.77615313684534
curr_Factors:  [97.77615314]
mat_Sqrt:  [[0.15]]
grads:  [-0.08114652]
Stock Position:  -0.08114652149851034
Bond Position:  [3.59022896]


portfolio before change:  [-4.3485744]
curr_Stock_Price:  97.83571259179278
curr_Factors:  [97.83571259]
mat_Sqrt:  [[0.15]]
grads:  [-0.04551537]
Stock Position:  -0.04551536604818556
Bond Position:  [0.10445387]


portfolio before change:  [-4.34578384]
curr_Stock_Price:  97.7745457216463
curr_Factors:  [97.77454572]
mat_Sqrt:  [[0.15]]
grads:  [-0.0135972]
Stock Position:  -0.013597202782410275
Bond Position:  [-3.01632351]


portfolio before change:  [-4.34541903]
curr_Stock_Price:  97.73385106155818
curr_Factors:  [97.73385106]
mat_Sqrt:  [[0.15]]
grads:  [0.29486695]
Stock Position:  0.29486694901488664
Bond Position:  [-33.16390151]


portfolio before change:  [-4.46738654]
curr_Stock_Price:  97.32724495015565
curr_Factors:  [97.32724495]
mat_Sqrt:  [[0.15]]
grads:  [-0.04867375]
Stock Position:  -0.04867375014789182
Bond Position:  [0.26989546]


portfolio before change:  [-4.46007778]
curr_Stock_Price:  97.17743329531956
curr_Factors:  [97.1774333]
mat_Sqrt:  [[0.15]]
grads:  [0.01621443]
Stock Position:  0.01621443417975425
Bond Position:  [-6.03575487]


portfolio before change:  [-4.46968585]
curr_Stock_Price:  96.60813634426835
curr_Factors:  [96.60813634]
mat_Sqrt:  [[0.15]]
grads:  [0.03291511]
Stock Position:  0.032915106581701374
Bond Position:  [-7.64955296]


portfolio before change:  [-4.45814723]
curr_Stock_Price:  96.97321901196088
curr_Factors:  [96.97321901]
mat_Sqrt:  [[0.15]]
grads:  [0.02941373]
Stock Position:  0.0294137270393184
Bond Position:  [-7.31049102]


portfolio before change:  [-4.47167811]
curr_Stock_Price:  96.52873385296522
curr_Factors:  [96.52873385]
mat_Sqrt:  [[0.15]]
grads:  [0.00883072]
Stock Position:  0.008830715224821008
Bond Position:  [-5.32409587]


portfolio before change:  [-4.4790441]
curr_Stock_Price:  95.7322844229052
curr_Factors:  [95.73228442]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505922]
Stock Position:  -0.0550592161072516
Bond Position:  [0.79190044]


portfolio before change:  [-4.47818989]
curr_Stock_Price:  95.71766909339726
curr_Factors:  [95.71766909]
mat_Sqrt:  [[0.15]]
grads:  [-0.0016205]
Stock Position:  -0.0016205042758947652
Bond Position:  [-4.323079]


portfolio before change:  [-4.47790419]
curr_Stock_Price:  95.37462647149998
curr_Factors:  [95.37462647]
mat_Sqrt:  [[0.15]]
grads:  [0.0105073]
Stock Position:  0.010507304858596758
Bond Position:  [-5.48003447]


portfolio before change:  [-4.47247768]
curr_Stock_Price:  95.92367558385585
curr_Factors:  [95.92367558]
mat_Sqrt:  [[0.15]]
grads:  [-0.24289511]
Stock Position:  -0.24289511283133772
Bond Position:  [18.82691432]


portfolio before change:  [-4.66079137]
curr_Stock_Price:  96.7038082265925
curr_Factors:  [96.70380823]
mat_Sqrt:  [[0.15]]
grads:  [-0.04039824]
Stock Position:  -0.04039824153733077
Bond Position:  [-0.75412756]


portfolio before change:  [-4.66748633]
curr_Stock_Price:  96.8683656945143
curr_Factors:  [96.86836569]
mat_Sqrt:  [[0.15]]
grads:  [0.05356451]
Stock Position:  0.05356451316704936
Bond Position:  [-9.85619318]


portfolio before change:  [-4.66403638]
curr_Stock_Price:  96.94427395875157
curr_Factors:  [96.94427396]
mat_Sqrt:  [[0.15]]
grads:  [0.09304902]
Stock Position:  0.0930490168315863
Bond Position:  [-13.68460576]


portfolio before change:  [-4.69491957]
curr_Stock_Price:  96.62156359415576
curr_Factors:  [96.62156359]
mat_Sqrt:  [[0.15]]
grads:  [-0.12459651]
Stock Position:  -0.12459651469243938
Bond Position:  [7.3437905]


portfolio before change:  [-4.596047]
curr_Stock_Price:  95.83170548792548
curr_Factors:  [95.83170549]
mat_Sqrt:  [[0.15]]
grads:  [-0.02920417]
Stock Position:  -0.029204167376452247
Bond Position:  [-1.79736184]


portfolio before change:  [-4.59647867]
curr_Stock_Price:  95.84263968817199
curr_Factors:  [95.84263969]
mat_Sqrt:  [[0.15]]
grads:  [-0.10816851]
Stock Position:  -0.1081685105290158
Bond Position:  [5.77067691]


portfolio before change:  [-4.53118474]
curr_Stock_Price:  95.24234251170265
curr_Factors:  [95.24234251]
mat_Sqrt:  [[0.15]]
grads:  [-0.02881616]
Stock Position:  -0.028816156813302244
Bond Position:  [-1.78666646]


portfolio before change:  [-4.54169657]
curr_Stock_Price:  95.60325684027363
curr_Factors:  [95.60325684]
mat_Sqrt:  [[0.15]]
grads:  [0.0399285]
Stock Position:  0.039928502896911466
Bond Position:  [-8.35899149]


portfolio before change:  [-4.56745849]
curr_Stock_Price:  94.97114035444174
curr_Factors:  [94.97114035]
mat_Sqrt:  [[0.15]]
grads:  [-0.10704684]
Stock Position:  -0.10704684493891933
Bond Position:  [5.59890245]


portfolio before change:  [-4.53830459]
curr_Stock_Price:  94.70206230720717
curr_Factors:  [94.70206231]
mat_Sqrt:  [[0.15]]
grads:  [0.08758058]
Stock Position:  0.08758057565145873
Bond Position:  [-12.83236572]


portfolio before change:  [-4.43805471]
curr_Stock_Price:  95.85587897509936
curr_Factors:  [95.85587898]
mat_Sqrt:  [[0.15]]
grads:  [0.01347024]
Stock Position:  0.013470241653070099
Bond Position:  [-5.72925656]


portfolio before change:  [-4.44934584]
curr_Stock_Price:  95.04423522718088
curr_Factors:  [95.04423523]
mat_Sqrt:  [[0.15]]
grads:  [0.0815227]
Stock Position:  0.0815227044637659
Bond Position:  [-12.19760894]


portfolio before change:  [-4.47521413]
curr_Stock_Price:  94.73627301534549
curr_Factors:  [94.73627302]
mat_Sqrt:  [[0.15]]
grads:  [0.0245953]
Stock Position:  0.02459530381845307
Bond Position:  [-6.80528154]


portfolio before change:  [-4.48850442]
curr_Stock_Price:  94.21320764347449
curr_Factors:  [94.21320764]
mat_Sqrt:  [[0.15]]
grads:  [0.01532729]
Stock Position:  0.015327291398661465
Bond Position:  [-5.93253771]


portfolio before change:  [-4.4977467]
curr_Stock_Price:  93.63440479067812
curr_Factors:  [93.63440479]
mat_Sqrt:  [[0.15]]
grads:  [0.1084779]
Stock Position:  0.10847789580696712
Bond Position:  [-14.6550099]


portfolio before change:  [-4.62851644]
curr_Stock_Price:  92.43735191283675
curr_Factors:  [92.43735191]
mat_Sqrt:  [[0.15]]
grads:  [-0.16581033]
Stock Position:  -0.16581033006947607
Bond Position:  [10.69855139]


portfolio before change:  [-4.72166246]
curr_Stock_Price:  93.00314720232393
curr_Factors:  [93.0031472]
mat_Sqrt:  [[0.15]]
grads:  [0.03143277]
Stock Position:  0.031432765768022085
Bond Position:  [-7.6450086]


portfolio before change:  [-4.71321899]
curr_Stock_Price:  93.28696885546081
curr_Factors:  [93.28696886]
mat_Sqrt:  [[0.15]]
grads:  [0.05856859]
Stock Position:  0.05856859175107545
Bond Position:  [-10.17690539]


portfolio before change:  [-4.70454493]
curr_Stock_Price:  93.44593007939521
curr_Factors:  [93.44593008]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.70454493]
Stock Price:  93.52157238225662
PL:  [-4.70454493]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.31651707e-03]
 [-2.41858359e-03]
 [-1.66482395e-03]
 [ 7.28502591e-03]
 [ 1.03225416e-02]
 [ 2.75241447e-02]
 [ 2.07260287e-03]
 [-9.49961220e-03]
 [ 2.37574134e-02]
 [-4.66743931e-03]
 [ 3.32188817e-02]
 [ 3.80104612e-02]
 [ 6.21636008e-02]
 [ 8.89597266e-03]
 [-6.89871299e-03]
 [ 1.80539722e-02]
 [ 1.02104742e-02]
 [-1.14614289e-02]
 [-4.27670831e-04]
 [ 1.02965391e-02]
 [ 1.14175586e-02]
 [-8.05897806e-03]
 [ 7.57240802e-03]
 [ 2.08899778e-02]
 [-8.05094279e-03]
 [-2.94040005e-03]
 [-5.43241736e-03]
 [ 6.31647142e-03]
 [-1.70907725e-02]
 [-6.09393182e-04]
 [-3.07475806e-03]
 [-1.02288649e-02]
 [-5.83990519e-03]
 [ 5.45817463e-03]
 [ 1.18716842e-02]
 [ 1.54408506e-02]
 [-3.46772901e-02]
 [ 8.77667203e-03]
 [-2.87794423e-02]
 [ 1.58065571e-02]
 [-1.11671268e-02]
 [ 3.65939038e-02]
 [ 2.31570695e-02]
 [ 4.13357528e-03]
 [ 4.12026662e-03]
 [ 3.58441228e-03]
 [ 1.87436878e-03]
 [-1.19460607e-02]
 [-8.00523689e-04]
 [ 2.57062719e-04]
 [ 4.22270197e-02]
 [-6.55367176e-03]
 [ 2.31486028e-03]
 [ 4.92038238e-03]
 [ 3.59688878e-03]
 [ 2.51319515e-03]
 [-7.20373378e-03]
 [-5.01755090e-04]
 [ 1.53543487e-03]
 [-7.09430693e-03]
 [-8.57188740e-03]
 [ 1.53478385e-02]
 [ 1.57814016e-02]
 [-1.91893801e-02]
 [-3.68783230e-03]
 [-1.71609714e-02]
 [-4.25129020e-03]
 [ 2.30384050e-03]
 [-1.69452999e-02]
 [ 1.22218418e-02]
 [ 5.83742512e-03]
 [ 1.23670435e-02]
 [ 3.36543765e-03]
 [ 3.93603756e-03]
 [ 1.28298299e-02]
 [-1.90044314e-02]
 [ 4.88879733e-03]
 [ 7.80612469e-03]
 [ 2.60126158e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.72781595]
curr_Stock_Price:  99.6898704353041
curr_Factors:  [99.68987044]
mat_Sqrt:  [[0.15]]
grads:  [0.02211011]
Stock Position:  0.022110113796758635
Bond Position:  [-4.93197033]


portfolio before change:  [-2.73193937]
curr_Stock_Price:  99.51731782584788
curr_Factors:  [99.51731783]
mat_Sqrt:  [[0.15]]
grads:  [-0.01612389]
Stock Position:  -0.01612389060375127
Bond Position:  [-1.12733302]


portfolio before change:  [-2.72764076]
curr_Stock_Price:  99.24634881094113
curr_Factors:  [99.24634881]
mat_Sqrt:  [[0.15]]
grads:  [-0.01109883]
Stock Position:  -0.011098826334049924
Bond Position:  [-1.62612277]


portfolio before change:  [-2.73719021]
curr_Stock_Price:  100.09759380221293
curr_Factors:  [100.0975938]
mat_Sqrt:  [[0.15]]
grads:  [0.04856684]
Stock Position:  0.0485668394289687
Bond Position:  [-7.59861398]


portfolio before change:  [-2.6968871]
curr_Stock_Price:  100.9372210444583
curr_Factors:  [100.93722104]
mat_Sqrt:  [[0.15]]
grads:  [0.06881694]
Stock Position:  0.06881694375289747
Bond Position:  [-9.64307816]


portfolio before change:  [-2.68191715]
curr_Stock_Price:  101.16351211952606
curr_Factors:  [101.16351212]
mat_Sqrt:  [[0.15]]
grads:  [0.1834943]
Stock Position:  0.18349429772289313
Bond Position:  [-21.24484476]


portfolio before change:  [-2.63723324]
curr_Stock_Price:  101.41426517434257
curr_Factors:  [101.41426517]
mat_Sqrt:  [[0.15]]
grads:  [0.01381735]
Stock Position:  0.013817352487598654
Bond Position:  [-4.03850989]


portfolio before change:  [-2.64449714]
curr_Stock_Price:  100.9068242342603
curr_Factors:  [100.90682423]
mat_Sqrt:  [[0.15]]
grads:  [-0.06333075]
Stock Position:  -0.06333074802708683
Bond Position:  [3.74600752]


portfolio before change:  [-2.65167941]
curr_Stock_Price:  101.0239300581446
curr_Factors:  [101.02393006]
mat_Sqrt:  [[0.15]]
grads:  [0.15838276]
Stock Position:  0.15838275630249357
Bond Position:  [-18.65212791]


portfolio before change:  [-2.6205628]
curr_Stock_Price:  101.22775531099148
curr_Factors:  [101.22775531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03111626]
Stock Position:  -0.031116262099120263
Bond Position:  [0.52926657]


portfolio before change:  [-2.64549124]
curr_Stock_Price:  102.02995723685768
curr_Factors:  [102.02995724]
mat_Sqrt:  [[0.15]]
grads:  [0.22145921]
Stock Position:  0.22145921154974585
Bond Position:  [-25.24096513]


portfolio before change:  [-2.42616771]
curr_Stock_Price:  103.02743729669245
curr_Factors:  [103.0274373]
mat_Sqrt:  [[0.15]]
grads:  [0.25340307]
Stock Position:  0.2534030748718963
Bond Position:  [-28.53363711]


portfolio before change:  [-2.70037905]
curr_Stock_Price:  101.95235984499685
curr_Factors:  [101.95235984]
mat_Sqrt:  [[0.15]]
grads:  [0.41442401]
Stock Position:  0.4144240054976704
Bond Position:  [-44.95188438]


portfolio before change:  [-2.64509024]
curr_Stock_Price:  102.09255052465195
curr_Factors:  [102.09255052]
mat_Sqrt:  [[0.15]]
grads:  [0.05930648]
Stock Position:  0.05930648439678797
Bond Position:  [-8.6998405]


portfolio before change:  [-2.66121504]
curr_Stock_Price:  101.82982979738426
curr_Factors:  [101.8298298]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599142]
Stock Position:  -0.04599141996005147
Bond Position:  [2.02208342]


portfolio before change:  [-2.61392363]
curr_Stock_Price:  100.80431177450423
curr_Factors:  [100.80431177]
mat_Sqrt:  [[0.15]]
grads:  [0.12035981]
Stock Position:  0.12035981435628995
Bond Position:  [-14.74671188]


portfolio before change:  [-2.6105841]
curr_Stock_Price:  100.83971587816905
curr_Factors:  [100.83971588]
mat_Sqrt:  [[0.15]]
grads:  [0.06806983]
Stock Position:  0.06806982819508746
Bond Position:  [-9.47472623]


portfolio before change:  [-2.60975527]
curr_Stock_Price:  100.86059168458883
curr_Factors:  [100.86059168]
mat_Sqrt:  [[0.15]]
grads:  [-0.07640953]
Stock Position:  -0.07640952616078714
Bond Position:  [5.09695475]


portfolio before change:  [-2.63284838]
curr_Stock_Price:  101.1669889998169
curr_Factors:  [101.166989]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285114]
Stock Position:  -0.0028511388745264326
Bond Position:  [-2.34440724]


portfolio before change:  [-2.63046312]
curr_Stock_Price:  100.2789983704666
curr_Factors:  [100.27899837]
mat_Sqrt:  [[0.15]]
grads:  [0.06864359]
Stock Position:  0.06864359386029198
Bond Position:  [-9.51397396]


portfolio before change:  [-2.64635003]
curr_Stock_Price:  100.05622060821135
curr_Factors:  [100.05622061]
mat_Sqrt:  [[0.15]]
grads:  [0.07611706]
Stock Position:  0.07611705720028612
Bond Position:  [-10.2623351]


portfolio before change:  [-2.66068372]
curr_Stock_Price:  99.8763362305715
curr_Factors:  [99.87633623]
mat_Sqrt:  [[0.15]]
grads:  [-0.05372652]
Stock Position:  -0.053726520423510865
Bond Position:  [2.7053243]


portfolio before change:  [-2.63744685]
curr_Stock_Price:  99.44698068621138
curr_Factors:  [99.44698069]
mat_Sqrt:  [[0.15]]
grads:  [0.05048272]
Stock Position:  0.050482720156638565
Bond Position:  [-7.65780095]


portfolio before change:  [-2.66151956]
curr_Stock_Price:  98.97961125149371
curr_Factors:  [98.97961125]
mat_Sqrt:  [[0.15]]
grads:  [0.13926652]
Stock Position:  0.13926651877037483
Bond Position:  [-16.44606544]


portfolio before change:  [-2.66481638]
curr_Stock_Price:  98.96331938437015
curr_Factors:  [98.96331938]
mat_Sqrt:  [[0.15]]
grads:  [-0.05367295]
Stock Position:  -0.053672951944946555
Bond Position:  [2.64683711]


portfolio before change:  [-2.66848]
curr_Stock_Price:  99.03465981087305
curr_Factors:  [99.03465981]
mat_Sqrt:  [[0.15]]
grads:  [-0.01960267]
Stock Position:  -0.01960266701274425
Bond Position:  [-0.72713654]


portfolio before change:  [-2.66590896]
curr_Stock_Price:  98.90118388370882
curr_Factors:  [98.90118388]
mat_Sqrt:  [[0.15]]
grads:  [-0.03621612]
Stock Position:  -0.03621611575869425
Bond Position:  [0.91590776]


portfolio before change:  [-2.6684535]
curr_Stock_Price:  98.97302441478392
curr_Factors:  [98.97302441]
mat_Sqrt:  [[0.15]]
grads:  [0.04210981]
Stock Position:  0.04210980946850222
Bond Position:  [-6.8361887]


portfolio before change:  [-2.69782051]
curr_Stock_Price:  98.28578000492621
curr_Factors:  [98.28578]
mat_Sqrt:  [[0.15]]
grads:  [-0.11393848]
Stock Position:  -0.11393848361087064
Bond Position:  [8.50071223]


portfolio before change:  [-2.73610985]
curr_Stock_Price:  98.62649594185967
curr_Factors:  [98.62649594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00406262]
Stock Position:  -0.0040626212153621
Bond Position:  [-2.33542776]


portfolio before change:  [-2.73530436]
curr_Stock_Price:  98.39229617858052
curr_Factors:  [98.39229618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02049839]
Stock Position:  -0.02049838709203186
Bond Position:  [-0.71842098]


portfolio before change:  [-2.7351526]
curr_Stock_Price:  98.38270205696554
curr_Factors:  [98.38270206]
mat_Sqrt:  [[0.15]]
grads:  [-0.06819243]
Stock Position:  -0.0681924328331887
Bond Position:  [3.97380321]


portfolio before change:  [-2.76946012]
curr_Stock_Price:  98.88944298910677
curr_Factors:  [98.88944299]
mat_Sqrt:  [[0.15]]
grads:  [-0.0389327]
Stock Position:  -0.038932701276080256
Bond Position:  [1.08057302]


portfolio before change:  [-2.81671215]
curr_Stock_Price:  100.10486240712116
curr_Factors:  [100.10486241]
mat_Sqrt:  [[0.15]]
grads:  [0.03638783]
Stock Position:  0.036387830881112374
Bond Position:  [-6.45931095]


portfolio before change:  [-2.83291125]
curr_Stock_Price:  99.67077811874536
curr_Factors:  [99.67077812]
mat_Sqrt:  [[0.15]]
grads:  [0.07914456]
Stock Position:  0.07914456152856225
Bond Position:  [-10.72131128]


portfolio before change:  [-2.89606487]
curr_Stock_Price:  98.88129215993558
curr_Factors:  [98.88129216]
mat_Sqrt:  [[0.15]]
grads:  [0.102939]
Stock Position:  0.10293900404779936
Bond Position:  [-13.07480661]


portfolio before change:  [-2.95506325]
curr_Stock_Price:  98.31609164949603
curr_Factors:  [98.31609165]
mat_Sqrt:  [[0.15]]
grads:  [-0.23118193]
Stock Position:  -0.2311819337927868
Bond Position:  [19.77384094]


portfolio before change:  [-2.84607215]
curr_Stock_Price:  97.84998600999725
curr_Factors:  [97.84998601]
mat_Sqrt:  [[0.15]]
grads:  [0.05851115]
Stock Position:  0.058511146844391515
Bond Position:  [-8.57138705]


portfolio before change:  [-2.89302185]
curr_Stock_Price:  97.05673592301004
curr_Factors:  [97.05673592]
mat_Sqrt:  [[0.15]]
grads:  [-0.19186295]
Stock Position:  -0.1918629484296959
Bond Position:  [15.72856967]


portfolio before change:  [-2.91119654]
curr_Stock_Price:  97.15658717461329
curr_Factors:  [97.15658717]
mat_Sqrt:  [[0.15]]
grads:  [0.10537705]
Stock Position:  0.10537704747714566
Bond Position:  [-13.14927083]


portfolio before change:  [-2.95398805]
curr_Stock_Price:  96.75830632461359
curr_Factors:  [96.75830632]
mat_Sqrt:  [[0.15]]
grads:  [-0.07444751]
Stock Position:  -0.07444751222624044
Bond Position:  [4.24942714]


portfolio before change:  [-2.93482771]
curr_Stock_Price:  96.50450683970057
curr_Factors:  [96.50450684]
mat_Sqrt:  [[0.15]]
grads:  [0.24395936]
Stock Position:  0.24395935862315482
Bond Position:  [-26.47800531]


portfolio before change:  [-2.85916715]
curr_Stock_Price:  96.82142636851611
curr_Factors:  [96.82142637]
mat_Sqrt:  [[0.15]]
grads:  [0.15438046]
Stock Position:  0.1543804633949678
Bond Position:  [-17.80650382]


portfolio before change:  [-2.87280372]
curr_Stock_Price:  96.74030456660424
curr_Factors:  [96.74030457]
mat_Sqrt:  [[0.15]]
grads:  [0.02755717]
Stock Position:  0.02755716852314031
Bond Position:  [-5.53869259]


portfolio before change:  [-2.87384074]
curr_Stock_Price:  96.71523510085335
curr_Factors:  [96.7152351]
mat_Sqrt:  [[0.15]]
grads:  [0.02746844]
Stock Position:  0.02746844415290522
Bond Position:  [-5.53045777]


portfolio before change:  [-2.86421903]
curr_Stock_Price:  97.07810152703412
curr_Factors:  [97.07810153]
mat_Sqrt:  [[0.15]]
grads:  [0.02389608]
Stock Position:  0.023896081839090838
Bond Position:  [-5.18400529]


portfolio before change:  [-2.85044445]
curr_Stock_Price:  97.6680973698622
curr_Factors:  [97.66809737]
mat_Sqrt:  [[0.15]]
grads:  [0.01249579]
Stock Position:  0.012495791877060458
Bond Position:  [-4.07088467]


portfolio before change:  [-2.86145914]
curr_Stock_Price:  96.80698718451433
curr_Factors:  [96.80698718]
mat_Sqrt:  [[0.15]]
grads:  [-0.0796404]
Stock Position:  -0.07964040449835663
Bond Position:  [4.84828848]


portfolio before change:  [-2.8769635]
curr_Stock_Price:  97.00547168633021
curr_Factors:  [97.00547169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533682]
Stock Position:  -0.005336824593057694
Bond Position:  [-2.35926231]


portfolio before change:  [-2.87693275]
curr_Stock_Price:  96.97207862650106
curr_Factors:  [96.97207863]
mat_Sqrt:  [[0.15]]
grads:  [0.00171375]
Stock Position:  0.0017137514580397098
Bond Position:  [-3.04311879]


portfolio before change:  [-2.87673197]
curr_Stock_Price:  97.20021936105002
curr_Factors:  [97.20021936]
mat_Sqrt:  [[0.15]]
grads:  [0.28151346]
Stock Position:  0.2815134647858581
Bond Position:  [-30.2399025]


portfolio before change:  [-2.87832795]
curr_Stock_Price:  97.20126395942971
curr_Factors:  [97.20126396]
mat_Sqrt:  [[0.15]]
grads:  [-0.04369115]
Stock Position:  -0.04369114508064019
Bond Position:  [1.36850657]


portfolio before change:  [-2.86739968]
curr_Stock_Price:  96.95309598868229
curr_Factors:  [96.95309599]
mat_Sqrt:  [[0.15]]
grads:  [0.0154324]
Stock Position:  0.01543240188854183
Bond Position:  [-4.36361882]


portfolio before change:  [-2.87438706]
curr_Stock_Price:  96.5179951982389
curr_Factors:  [96.5179952]
mat_Sqrt:  [[0.15]]
grads:  [0.03280255]
Stock Position:  0.03280254919281722
Bond Position:  [-6.04042335]


portfolio before change:  [-2.89654371]
curr_Stock_Price:  95.85404941310651
curr_Factors:  [95.85404941]
mat_Sqrt:  [[0.15]]
grads:  [0.02397926]
Stock Position:  0.023979258518413513
Bond Position:  [-5.19505275]


portfolio before change:  [-2.88757808]
curr_Stock_Price:  96.24148155564953
curr_Factors:  [96.24148156]
mat_Sqrt:  [[0.15]]
grads:  [0.01675463]
Stock Position:  0.01675463434399101
Bond Position:  [-4.50006891]


portfolio before change:  [-2.89367174]
curr_Stock_Price:  95.89456851284518
curr_Factors:  [95.89456851]
mat_Sqrt:  [[0.15]]
grads:  [-0.04802489]
Stock Position:  -0.0480248918460313
Bond Position:  [1.71165454]


portfolio before change:  [-2.92439571]
curr_Stock_Price:  96.53654694681724
curr_Factors:  [96.53654695]
mat_Sqrt:  [[0.15]]
grads:  [-0.00334503]
Stock Position:  -0.003345033933398061
Bond Position:  [-2.60147768]


portfolio before change:  [-2.92704405]
curr_Stock_Price:  97.27966131506423
curr_Factors:  [97.27966132]
mat_Sqrt:  [[0.15]]
grads:  [0.01023623]
Stock Position:  0.010236232472310394
Bond Position:  [-3.92282128]


portfolio before change:  [-2.92832486]
curr_Stock_Price:  97.17848859296238
curr_Factors:  [97.17848859]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729538]
Stock Position:  -0.04729537951029007
Bond Position:  [1.66776864]


portfolio before change:  [-2.87438296]
curr_Stock_Price:  96.0401604146526
curr_Factors:  [96.04016041]
mat_Sqrt:  [[0.15]]
grads:  [-0.05714592]
Stock Position:  -0.05714591599937349
Bond Position:  [2.61391998]


portfolio before change:  [-2.8656898]
curr_Stock_Price:  95.89089730059804
curr_Factors:  [95.8908973]
mat_Sqrt:  [[0.15]]
grads:  [0.10231892]
Stock Position:  0.10231892359925052
Bond Position:  [-12.6771432]


portfolio before change:  [-2.93469308]
curr_Stock_Price:  95.22424712234421
curr_Factors:  [95.22424712]
mat_Sqrt:  [[0.15]]
grads:  [0.10520934]
Stock Position:  0.10520934426276735
Bond Position:  [-12.95317368]


portfolio before change:  [-2.93983237]
curr_Stock_Price:  95.1830940404056
curr_Factors:  [95.18309404]
mat_Sqrt:  [[0.15]]
grads:  [-0.1279292]
Stock Position:  -0.1279292008737058
Bond Position:  [9.23686479]


portfolio before change:  [-2.93768787]
curr_Stock_Price:  95.17084371230811
curr_Factors:  [95.17084371]
mat_Sqrt:  [[0.15]]
grads:  [-0.02458555]
Stock Position:  -0.024585548661121212
Bond Position:  [-0.59786046]


portfolio before change:  [-2.94834288]
curr_Stock_Price:  95.60270875770843
curr_Factors:  [95.60270876]
mat_Sqrt:  [[0.15]]
grads:  [-0.11440648]
Stock Position:  -0.11440647633069785
Bond Position:  [7.98922616]


portfolio before change:  [-2.88077212]
curr_Stock_Price:  95.0164533997178
curr_Factors:  [95.0164534]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834193]
Stock Position:  -0.028341934675058172
Bond Position:  [-0.18782201]


portfolio before change:  [-2.87860952]
curr_Stock_Price:  94.93973511524403
curr_Factors:  [94.93973512]
mat_Sqrt:  [[0.15]]
grads:  [0.01535894]
Stock Position:  0.015358936697380497
Bond Position:  [-4.3367829]


portfolio before change:  [-2.88374679]
curr_Stock_Price:  94.62290264328342
curr_Factors:  [94.62290264]
mat_Sqrt:  [[0.15]]
grads:  [-0.11296867]
Stock Position:  -0.11296866606322724
Bond Position:  [7.8056763]


portfolio before change:  [-2.94772433]
curr_Stock_Price:  95.19355126608616
curr_Factors:  [95.19355127]
mat_Sqrt:  [[0.15]]
grads:  [0.08147895]
Stock Position:  0.08147894549520386
Bond Position:  [-10.70399451]


portfolio before change:  [-2.98326559]
curr_Stock_Price:  94.76556049709394
curr_Factors:  [94.7655605]
mat_Sqrt:  [[0.15]]
grads:  [0.03891617]
Stock Position:  0.038916167437840675
Bond Position:  [-6.67117801]


portfolio before change:  [-2.99076822]
curr_Stock_Price:  94.58348518544423
curr_Factors:  [94.58348519]
mat_Sqrt:  [[0.15]]
grads:  [0.08244696]
Stock Position:  0.08244695650317602
Bond Position:  [-10.78888871]


portfolio before change:  [-3.03473714]
curr_Stock_Price:  94.05836461057015
curr_Factors:  [94.05836461]
mat_Sqrt:  [[0.15]]
grads:  [0.02243625]
Stock Position:  0.022436251006142452
Bond Position:  [-5.14505422]


portfolio before change:  [-3.04072984]
curr_Stock_Price:  93.80559857216655
curr_Factors:  [93.80559857]
mat_Sqrt:  [[0.15]]
grads:  [0.02624025]
Stock Position:  0.02624025038863795
Bond Position:  [-5.50221223]


portfolio before change:  [-3.03336781]
curr_Stock_Price:  94.09926703126904
curr_Factors:  [94.09926703]
mat_Sqrt:  [[0.15]]
grads:  [0.0855322]
Stock Position:  0.08553219952277802
Bond Position:  [-11.08188509]


portfolio before change:  [-3.00302453]
curr_Stock_Price:  94.46212349849264
curr_Factors:  [94.4621235]
mat_Sqrt:  [[0.15]]
grads:  [-0.12669621]
Stock Position:  -0.12669620904502707
Bond Position:  [8.96496841]


portfolio before change:  [-2.9446862]
curr_Stock_Price:  94.00608772669935
curr_Factors:  [94.00608773]
mat_Sqrt:  [[0.15]]
grads:  [0.03259198]
Stock Position:  0.03259198220326867
Bond Position:  [-6.00853094]


portfolio before change:  [-2.94090267]
curr_Stock_Price:  94.13369829287416
curr_Factors:  [94.13369829]
mat_Sqrt:  [[0.15]]
grads:  [0.05204083]
Stock Position:  0.05204083125867672
Bond Position:  [-7.83969857]


portfolio before change:  [-2.96349037]
curr_Stock_Price:  93.70907584168037
curr_Factors:  [93.70907584]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96349037]
Stock Price:  94.0288726337365
PL:  [-2.96349037]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.43067147e-03]
 [ 3.00979332e-04]
 [-4.80559254e-04]
 [ 7.23228299e-03]
 [ 4.64684944e-03]
 [ 2.31450995e-02]
 [ 8.29078012e-04]
 [-1.66586601e-02]
 [ 2.55380743e-02]
 [ 1.15135897e-03]
 [ 1.37266536e-02]
 [-2.07861062e-02]
 [ 2.46725237e-02]
 [ 3.71817048e-03]
 [-6.89717210e-03]
 [ 3.05467389e-02]
 [ 1.16858430e-02]
 [-6.76459382e-03]
 [ 1.17668198e-02]
 [-8.84125491e-03]
 [ 1.46458432e-02]
 [-1.14818845e-02]
 [ 1.05454102e-02]
 [-5.81100077e-02]
 [ 6.42935484e-03]
 [ 7.10122473e-03]
 [-4.95037286e-03]
 [ 1.36246382e-02]
 [ 4.96328067e-02]
 [ 5.64728961e-03]
 [ 1.91162995e-02]
 [-4.39004592e-03]
 [ 3.03716333e-03]
 [ 8.42960932e-03]
 [ 1.10532825e-02]
 [ 8.49590904e-03]
 [-3.32867865e-02]
 [ 9.32380988e-03]
 [ 8.54417364e-03]
 [ 1.88555769e-02]
 [-3.93405308e-03]
 [-1.83007395e-02]
 [ 2.08107751e-02]
 [-2.88090317e-03]
 [ 1.23876936e-02]
 [-1.32096120e-02]
 [ 1.53471030e-02]
 [ 1.23814335e-02]
 [ 6.35036040e-03]
 [-7.46333956e-03]
 [-1.70031511e-02]
 [ 3.22951828e-03]
 [-9.08190519e-03]
 [ 5.90572652e-03]
 [-1.26949869e-02]
 [ 2.53249189e-02]
 [ 1.14869363e-02]
 [ 4.84107014e-04]
 [ 1.75392941e-03]
 [ 1.40989202e-02]
 [ 4.84320907e-03]
 [ 2.80850496e-02]
 [ 3.94330982e-03]
 [-1.25183838e-02]
 [ 9.21773560e-03]
 [ 5.29397779e-03]
 [-5.23774523e-03]
 [ 1.54196632e-02]
 [-1.12879095e-02]
 [-1.41424897e-02]
 [-1.21913808e-02]
 [ 1.42953335e-02]
 [-1.83026609e-02]
 [ 2.79021586e-02]
 [-2.74933766e-02]
 [ 3.72649400e-03]
 [ 7.23949814e-03]
 [-1.85671220e-02]
 [ 1.94417087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.22975218]
curr_Stock_Price:  99.65723205274544
curr_Factors:  [99.65723205]
mat_Sqrt:  [[0.15]]
grads:  [0.02287114]
Stock Position:  0.022871143164546793
Bond Position:  [-5.509027]


portfolio before change:  [-3.22931016]
curr_Stock_Price:  99.69161363460739
curr_Factors:  [99.69161363]
mat_Sqrt:  [[0.15]]
grads:  [0.00200653]
Stock Position:  0.002006528880244855
Bond Position:  [-3.42934426]


portfolio before change:  [-3.22842422]
curr_Stock_Price:  100.23996627474136
curr_Factors:  [100.23996627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320373]
Stock Position:  -0.003203728359924384
Bond Position:  [-2.90728259]


portfolio before change:  [-3.22835357]
curr_Stock_Price:  100.16119496534606
curr_Factors:  [100.16119497]
mat_Sqrt:  [[0.15]]
grads:  [0.04821522]
Stock Position:  0.04821521990073634
Bond Position:  [-8.05764761]


portfolio before change:  [-3.24406998]
curr_Stock_Price:  99.84567636334002
curr_Factors:  [99.84567636]
mat_Sqrt:  [[0.15]]
grads:  [0.030979]
Stock Position:  0.03097899627095651
Bond Position:  [-6.33718882]


portfolio before change:  [-3.2449407]
curr_Stock_Price:  99.83035533125054
curr_Factors:  [99.83035533]
mat_Sqrt:  [[0.15]]
grads:  [0.15430066]
Stock Position:  0.15430066329702
Bond Position:  [-18.64883074]


portfolio before change:  [-3.3056748]
curr_Stock_Price:  99.44430053650963
curr_Factors:  [99.44430054]
mat_Sqrt:  [[0.15]]
grads:  [0.00552719]
Stock Position:  0.005527186744788831
Bond Position:  [-3.85532202]


portfolio before change:  [-3.30234134]
curr_Stock_Price:  100.09099826188147
curr_Factors:  [100.09099826]
mat_Sqrt:  [[0.15]]
grads:  [-0.11105773]
Stock Position:  -0.11105773399328496
Bond Position:  [7.81353812]


portfolio before change:  [-3.35350941]
curr_Stock_Price:  100.55612951659222
curr_Factors:  [100.55612952]
mat_Sqrt:  [[0.15]]
grads:  [0.17025383]
Stock Position:  0.17025382892760538
Bond Position:  [-20.47357548]


portfolio before change:  [-3.49006395]
curr_Stock_Price:  99.76158114353169
curr_Factors:  [99.76158114]
mat_Sqrt:  [[0.15]]
grads:  [0.00767573]
Stock Position:  0.007675726468301554
Bond Position:  [-4.25580656]


portfolio before change:  [-3.49146042]
curr_Stock_Price:  99.61430212087234
curr_Factors:  [99.61430212]
mat_Sqrt:  [[0.15]]
grads:  [0.09151102]
Stock Position:  0.09151102376131613
Bond Position:  [-12.60726719]


portfolio before change:  [-3.391628]
curr_Stock_Price:  100.7138461302663
curr_Factors:  [100.71384613]
mat_Sqrt:  [[0.15]]
grads:  [-0.13857404]
Stock Position:  -0.1385740412962625
Bond Position:  [10.56469667]


portfolio before change:  [-3.42717911]
curr_Stock_Price:  100.97516075337155
curr_Factors:  [100.97516075]
mat_Sqrt:  [[0.15]]
grads:  [0.16448349]
Stock Position:  0.16448349124663758
Bond Position:  [-20.03592608]


portfolio before change:  [-3.37125973]
curr_Stock_Price:  101.32274371699216
curr_Factors:  [101.32274372]
mat_Sqrt:  [[0.15]]
grads:  [0.0247878]
Stock Position:  0.02478780317234398
Bond Position:  [-5.88282796]


portfolio before change:  [-3.33515]
curr_Stock_Price:  102.79433115221507
curr_Factors:  [102.79433115]
mat_Sqrt:  [[0.15]]
grads:  [-0.04598115]
Stock Position:  -0.04598114733744255
Bond Position:  [1.39145128]


portfolio before change:  [-3.35981988]
curr_Stock_Price:  103.33274420863195
curr_Factors:  [103.33274421]
mat_Sqrt:  [[0.15]]
grads:  [0.20364493]
Stock Position:  0.20364492617292396
Bond Position:  [-24.40300895]


portfolio before change:  [-3.48570277]
curr_Stock_Price:  102.7220849990771
curr_Factors:  [102.722085]
mat_Sqrt:  [[0.15]]
grads:  [0.07790562]
Stock Position:  0.07790562027873588
Bond Position:  [-11.48833052]


portfolio before change:  [-3.45517965]
curr_Stock_Price:  103.1230978962452
curr_Factors:  [103.1230979]
mat_Sqrt:  [[0.15]]
grads:  [-0.04509729]
Stock Position:  -0.045097292101759986
Bond Position:  [1.19539282]


portfolio before change:  [-3.48890764]
curr_Stock_Price:  103.87264853177442
curr_Factors:  [103.87264853]
mat_Sqrt:  [[0.15]]
grads:  [0.07844547]
Stock Position:  0.07844546563841227
Bond Position:  [-11.63724592]


portfolio before change:  [-3.47336977]
curr_Stock_Price:  104.07999291589573
curr_Factors:  [104.07999292]
mat_Sqrt:  [[0.15]]
grads:  [-0.0589417]
Stock Position:  -0.058941699411314045
Bond Position:  [2.66128189]


portfolio before change:  [-3.44521321]
curr_Stock_Price:  103.60511309434642
curr_Factors:  [103.60511309]
mat_Sqrt:  [[0.15]]
grads:  [0.09763895]
Stock Position:  0.09763895497690081
Bond Position:  [-13.56110818]


portfolio before change:  [-3.45469557]
curr_Stock_Price:  103.51667738827472
curr_Factors:  [103.51667739]
mat_Sqrt:  [[0.15]]
grads:  [-0.0765459]
Stock Position:  -0.07654589692157106
Bond Position:  [4.46908134]


portfolio before change:  [-3.53162801]
curr_Stock_Price:  104.52537636708178
curr_Factors:  [104.52537637]
mat_Sqrt:  [[0.15]]
grads:  [0.07030273]
Stock Position:  0.07030273476399616
Bond Position:  [-10.88004783]


portfolio before change:  [-3.55092436]
curr_Stock_Price:  104.26057417198253
curr_Factors:  [104.26057417]
mat_Sqrt:  [[0.15]]
grads:  [-0.38740005]
Stock Position:  -0.38740005116880716
Bond Position:  [36.83962741]


portfolio before change:  [-3.16805733]
curr_Stock_Price:  103.27821889851145
curr_Factors:  [103.2782189]
mat_Sqrt:  [[0.15]]
grads:  [0.04286237]
Stock Position:  0.042862365619535964
Bond Position:  [-7.5948061]


portfolio before change:  [-3.1678122]
curr_Stock_Price:  103.29501262487133
curr_Factors:  [103.29501262]
mat_Sqrt:  [[0.15]]
grads:  [0.0473415]
Stock Position:  0.04734149822362974
Bond Position:  [-8.05795285]


portfolio before change:  [-3.15799185]
curr_Stock_Price:  103.5130872663484
curr_Factors:  [103.51308727]
mat_Sqrt:  [[0.15]]
grads:  [-0.03300249]
Stock Position:  -0.03300248575932432
Bond Position:  [0.25819733]


portfolio before change:  [-3.1529098]
curr_Stock_Price:  103.35958610204972
curr_Factors:  [103.3595861]
mat_Sqrt:  [[0.15]]
grads:  [0.09083092]
Stock Position:  0.09083092162974474
Bond Position:  [-12.54115626]


portfolio before change:  [-3.12928306]
curr_Stock_Price:  103.62833363622933
curr_Factors:  [103.62833364]
mat_Sqrt:  [[0.15]]
grads:  [0.33088538]
Stock Position:  0.33088537817490676
Bond Position:  [-37.41838342]


portfolio before change:  [-2.98872512]
curr_Stock_Price:  104.0601951564962
curr_Factors:  [104.06019516]
mat_Sqrt:  [[0.15]]
grads:  [0.0376486]
Stock Position:  0.03764859739395564
Bond Position:  [-6.90644551]


portfolio before change:  [-2.99177387]
curr_Stock_Price:  103.99068158395181
curr_Factors:  [103.99068158]
mat_Sqrt:  [[0.15]]
grads:  [0.127442]
Stock Position:  0.12744199682420498
Bond Position:  [-16.24455398]


portfolio before change:  [-3.07507998]
curr_Stock_Price:  103.34496982660545
curr_Factors:  [103.34496983]
mat_Sqrt:  [[0.15]]
grads:  [-0.02926697]
Stock Position:  -0.029266972832356405
Bond Position:  [-0.05048556]


portfolio before change:  [-3.06070095]
curr_Stock_Price:  102.85355617968061
curr_Factors:  [102.85355618]
mat_Sqrt:  [[0.15]]
grads:  [0.02024776]
Stock Position:  0.020247755562417712
Bond Position:  [-5.14325461]


portfolio before change:  [-3.07356178]
curr_Stock_Price:  102.23425929619786
curr_Factors:  [102.2342593]
mat_Sqrt:  [[0.15]]
grads:  [0.0561974]
Stock Position:  0.05619739549910424
Bond Position:  [-8.81886089]


portfolio before change:  [-3.09973916]
curr_Stock_Price:  101.7782563898435
curr_Factors:  [101.77825639]
mat_Sqrt:  [[0.15]]
grads:  [0.07368855]
Stock Position:  0.07368855026050827
Bond Position:  [-10.59963132]


portfolio before change:  [-3.04312277]
curr_Stock_Price:  102.55556686473402
curr_Factors:  [102.55556686]
mat_Sqrt:  [[0.15]]
grads:  [0.05663939]
Stock Position:  0.05663939357545513
Bond Position:  [-8.85180789]


portfolio before change:  [-3.04354236]
curr_Stock_Price:  102.55792675365703
curr_Factors:  [102.55792675]
mat_Sqrt:  [[0.15]]
grads:  [-0.22191191]
Stock Position:  -0.2219119102594197
Bond Position:  [19.71528307]


portfolio before change:  [-3.01662923]
curr_Stock_Price:  102.44220112315003
curr_Factors:  [102.44220112]
mat_Sqrt:  [[0.15]]
grads:  [0.06215873]
Stock Position:  0.06215873256617399
Bond Position:  [-9.38430661]


portfolio before change:  [-2.98484451]
curr_Stock_Price:  102.96298474266234
curr_Factors:  [102.96298474]
mat_Sqrt:  [[0.15]]
grads:  [0.05696116]
Stock Position:  0.056961157576869106
Bond Position:  [-8.84973531]


portfolio before change:  [-3.01062975]
curr_Stock_Price:  102.52001434527354
curr_Factors:  [102.52001435]
mat_Sqrt:  [[0.15]]
grads:  [0.12570385]
Stock Position:  0.12570384572935464
Bond Position:  [-15.89778981]


portfolio before change:  [-2.86756837]
curr_Stock_Price:  103.6660017448145
curr_Factors:  [103.66600174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02622702]
Stock Position:  -0.026227020558622253
Bond Position:  [-0.14871801]


portfolio before change:  [-2.8617915]
curr_Stock_Price:  103.44538360229564
curr_Factors:  [103.4453836]
mat_Sqrt:  [[0.15]]
grads:  [-0.12200493]
Stock Position:  -0.12200492994830488
Bond Position:  [9.75905528]


portfolio before change:  [-2.83304087]
curr_Stock_Price:  103.21473168530443
curr_Factors:  [103.21473169]
mat_Sqrt:  [[0.15]]
grads:  [0.1387385]
Stock Position:  0.13873850041584432
Bond Position:  [-17.15289797]


portfolio before change:  [-2.71422571]
curr_Stock_Price:  104.07885556031154
curr_Factors:  [104.07885556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01920602]
Stock Position:  -0.01920602114904437
Bond Position:  [-0.71528501]


portfolio before change:  [-2.72945432]
curr_Stock_Price:  104.86943609252292
curr_Factors:  [104.86943609]
mat_Sqrt:  [[0.15]]
grads:  [0.08258462]
Stock Position:  0.08258462426005737
Bond Position:  [-11.3900573]


portfolio before change:  [-2.69230657]
curr_Stock_Price:  105.32787071312798
curr_Factors:  [105.32787071]
mat_Sqrt:  [[0.15]]
grads:  [-0.08806408]
Stock Position:  -0.08806407985777048
Bond Position:  [6.58329544]


portfolio before change:  [-2.65502436]
curr_Stock_Price:  104.90918979763782
curr_Factors:  [104.9091898]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-13.38870527]


portfolio before change:  [-2.71761955]
curr_Stock_Price:  104.30557381238025
curr_Factors:  [104.30557381]
mat_Sqrt:  [[0.15]]
grads:  [0.08254289]
Stock Position:  0.08254288989066029
Bond Position:  [-11.32730305]


portfolio before change:  [-2.68740916]
curr_Stock_Price:  104.68014722129737
curr_Factors:  [104.68014722]
mat_Sqrt:  [[0.15]]
grads:  [0.04233574]
Stock Position:  0.0423357359961891
Bond Position:  [-7.11912024]


portfolio before change:  [-2.69997321]
curr_Stock_Price:  104.3938858619573
curr_Factors:  [104.39388586]
mat_Sqrt:  [[0.15]]
grads:  [-0.0497556]
Stock Position:  -0.04975559707939025
Bond Position:  [2.49420692]


portfolio before change:  [-2.68239555]
curr_Stock_Price:  104.04373908819464
curr_Factors:  [104.04373909]
mat_Sqrt:  [[0.15]]
grads:  [-0.11335434]
Stock Position:  -0.11335434045020024
Bond Position:  [9.11141387]


portfolio before change:  [-2.72027302]
curr_Stock_Price:  104.3829140564192
curr_Factors:  [104.38291406]
mat_Sqrt:  [[0.15]]
grads:  [0.02153012]
Stock Position:  0.021530121835559073
Bond Position:  [-4.96764988]


portfolio before change:  [-2.72835599]
curr_Stock_Price:  104.02190927389289
curr_Factors:  [104.02190927]
mat_Sqrt:  [[0.15]]
grads:  [-0.06054603]
Stock Position:  -0.06054603461175791
Bond Position:  [3.56975813]


portfolio before change:  [-2.76516634]
curr_Stock_Price:  104.63356734844737
curr_Factors:  [104.63356735]
mat_Sqrt:  [[0.15]]
grads:  [0.03937151]
Stock Position:  0.03937151010072572
Bond Position:  [-6.8847479]


portfolio before change:  [-2.76331345]
curr_Stock_Price:  104.69155873340249
curr_Factors:  [104.69155873]
mat_Sqrt:  [[0.15]]
grads:  [-0.08463325]
Stock Position:  -0.08463324587207603
Bond Position:  [6.09707299]


portfolio before change:  [-2.87037339]
curr_Stock_Price:  105.96104833054437
curr_Factors:  [105.96104833]
mat_Sqrt:  [[0.15]]
grads:  [0.16883279]
Stock Position:  0.1688327924242237
Bond Position:  [-20.76007307]


portfolio before change:  [-3.07460828]
curr_Stock_Price:  104.7590464033976
curr_Factors:  [104.7590464]
mat_Sqrt:  [[0.15]]
grads:  [0.07657958]
Stock Position:  0.07657957566481739
Bond Position:  [-11.0970116]


portfolio before change:  [-3.1180212]
curr_Stock_Price:  104.20120403495396
curr_Factors:  [104.20120403]
mat_Sqrt:  [[0.15]]
grads:  [0.00322738]
Stock Position:  0.0032273800941275466
Bond Position:  [-3.45431809]


portfolio before change:  [-3.11995764]
curr_Stock_Price:  103.6680968785989
curr_Factors:  [103.66809688]
mat_Sqrt:  [[0.15]]
grads:  [0.01169286]
Stock Position:  0.011692862749115709
Bond Position:  [-4.33213446]


portfolio before change:  [-3.1181867]
curr_Stock_Price:  103.84270830245462
curr_Factors:  [103.8427083]
mat_Sqrt:  [[0.15]]
grads:  [0.0939928]
Stock Position:  0.09399280136322641
Bond Position:  [-12.87865375]


portfolio before change:  [-3.11390013]
curr_Stock_Price:  103.8968774526228
curr_Factors:  [103.89687745]
mat_Sqrt:  [[0.15]]
grads:  [0.03228806]
Stock Position:  0.032288060464189625
Bond Position:  [-6.46852879]


portfolio before change:  [-3.09133281]
curr_Stock_Price:  104.60833602021701
curr_Factors:  [104.60833602]
mat_Sqrt:  [[0.15]]
grads:  [0.18723366]
Stock Position:  0.1872336642381641
Bond Position:  [-22.67753487]


portfolio before change:  [-3.2210801]
curr_Stock_Price:  103.92293628701609
curr_Factors:  [103.92293629]
mat_Sqrt:  [[0.15]]
grads:  [0.02628873]
Stock Position:  0.026288732128783333
Bond Position:  [-5.95308233]


portfolio before change:  [-3.22269396]
curr_Stock_Price:  103.87570015822966
curr_Factors:  [103.87570016]
mat_Sqrt:  [[0.15]]
grads:  [-0.08345589]
Stock Position:  -0.08345589229416142
Bond Position:  [5.44634529]


portfolio before change:  [-3.24008034]
curr_Stock_Price:  104.08810931744988
curr_Factors:  [104.08810932]
mat_Sqrt:  [[0.15]]
grads:  [0.06145157]
Stock Position:  0.06145157068612346
Bond Position:  [-9.63645815]


portfolio before change:  [-3.19186043]
curr_Stock_Price:  104.88259213247247
curr_Factors:  [104.88259213]
mat_Sqrt:  [[0.15]]
grads:  [0.03529319]
Stock Position:  0.035293185279741915
Bond Position:  [-6.89350118]


portfolio before change:  [-3.18695569]
curr_Stock_Price:  105.03377113783084
curr_Factors:  [105.03377114]
mat_Sqrt:  [[0.15]]
grads:  [-0.0349183]
Stock Position:  -0.034918301547082385
Bond Position:  [0.4806452]


portfolio before change:  [-3.19159845]
curr_Stock_Price:  105.16759194142222
curr_Factors:  [105.16759194]
mat_Sqrt:  [[0.15]]
grads:  [0.10279775]
Stock Position:  0.10279775488048867
Bond Position:  [-14.00259079]


portfolio before change:  [-3.15273641]
curr_Stock_Price:  105.5541492799704
curr_Factors:  [105.55414928]
mat_Sqrt:  [[0.15]]
grads:  [-0.07525273]
Stock Position:  -0.07525272992082999
Bond Position:  [4.79050148]


portfolio before change:  [-3.13191041]
curr_Stock_Price:  105.28138069369315
curr_Factors:  [105.28138069]
mat_Sqrt:  [[0.15]]
grads:  [-0.09428326]
Stock Position:  -0.09428326458989478
Bond Position:  [6.79436186]


portfolio before change:  [-3.09127674]
curr_Stock_Price:  104.85491037220552
curr_Factors:  [104.85491037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08127587]
Stock Position:  -0.08127587214903768
Bond Position:  [5.43089755]


portfolio before change:  [-3.12827782]
curr_Stock_Price:  105.31433967944034
curr_Factors:  [105.31433968]
mat_Sqrt:  [[0.15]]
grads:  [0.09530222]
Stock Position:  0.09530222343666898
Bond Position:  [-13.16496855]


portfolio before change:  [-3.0459048]
curr_Stock_Price:  106.18730827316443
curr_Factors:  [106.18730827]
mat_Sqrt:  [[0.15]]
grads:  [-0.12201774]
Stock Position:  -0.12201773949361931
Bond Position:  [9.91083052]


portfolio before change:  [-3.06143506]
curr_Stock_Price:  106.31966367217878
curr_Factors:  [106.31966367]
mat_Sqrt:  [[0.15]]
grads:  [0.18601439]
Stock Position:  0.1860143909234301
Bond Position:  [-22.83842254]


portfolio before change:  [-3.08558053]
curr_Stock_Price:  106.19753325065976
curr_Factors:  [106.19753325]
mat_Sqrt:  [[0.15]]
grads:  [-0.18328918]
Stock Position:  -0.18328917747005857
Bond Position:  [16.37927799]


portfolio before change:  [-3.08421616]
curr_Stock_Price:  106.19567480805742
curr_Factors:  [106.19567481]
mat_Sqrt:  [[0.15]]
grads:  [0.02484329]
Stock Position:  0.024843293345759056
Bond Position:  [-5.72246646]


portfolio before change:  [-3.05715154]
curr_Stock_Price:  107.29948494986797
curr_Factors:  [107.29948495]
mat_Sqrt:  [[0.15]]
grads:  [0.04826332]
Stock Position:  0.0482633209079413
Bond Position:  [-8.23578102]


portfolio before change:  [-2.99477204]
curr_Stock_Price:  108.60263296470782
curr_Factors:  [108.60263296]
mat_Sqrt:  [[0.15]]
grads:  [-0.12378081]
Stock Position:  -0.1237808130042215
Bond Position:  [10.44815016]


portfolio before change:  [-3.11404386]
curr_Stock_Price:  109.57148138647422
curr_Factors:  [109.57148139]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.11404386]
Stock Price:  109.6626833167969
PL:  [-12.77672718]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.76501073e-03]
 [-2.54936888e-02]
 [-4.61107517e-03]
 [ 8.14517610e-03]
 [ 4.77579528e-03]
 [ 1.66436325e-02]
 [ 1.83821982e-03]
 [-1.76273033e-02]
 [-1.42209410e-03]
 [ 2.26839122e-02]
 [-4.86816108e-02]
 [ 3.11168326e-02]
 [-1.06280427e-02]
 [ 2.66508604e-03]
 [-7.04340093e-03]
 [ 1.10135730e-02]
 [ 1.29631674e-02]
 [-6.71651013e-03]
 [ 2.28325214e-03]
 [ 1.15035558e-02]
 [ 1.27429121e-02]
 [-1.02215264e-02]
 [ 4.95892570e-03]
 [-7.68540667e-03]
 [-1.07280670e-02]
 [-4.01617339e-03]
 [-8.46196665e-04]
 [ 9.64277234e-03]
 [-2.42934933e-02]
 [ 1.99523399e-03]
 [ 5.88614353e-04]
 [-1.00860747e-02]
 [-9.08154861e-03]
 [ 5.37611665e-03]
 [ 1.29884031e-02]
 [ 1.69106844e-02]
 [-3.43221491e-02]
 [ 8.65342307e-03]
 [-2.56479118e-02]
 [ 1.50579836e-02]
 [-8.89000831e-03]
 [ 8.90708187e-03]
 [ 2.30184138e-02]
 [ 4.59929593e-03]
 [ 2.94846741e-03]
 [ 4.05333800e-03]
 [ 1.61145703e-03]
 [-1.19438783e-02]
 [-6.83354769e-03]
 [-5.61293473e-04]
 [ 4.33139316e-02]
 [-9.19499944e-03]
 [ 2.33608578e-03]
 [ 4.99709040e-03]
 [ 4.54890450e-03]
 [-7.50068162e-04]
 [-3.10744447e-03]
 [-5.34132860e-04]
 [ 1.54272217e-03]
 [-1.73705392e-02]
 [-1.91335175e-03]
 [ 6.28810630e-03]
 [ 1.33119975e-02]
 [-1.84028506e-02]
 [-1.00150433e-02]
 [-9.38621581e-03]
 [-4.72193513e-03]
 [ 1.67430635e-02]
 [-1.01094952e-02]
 [ 6.08720385e-03]
 [-8.30028808e-03]
 [ 1.08622478e-02]
 [-5.51861377e-03]
 [ 8.37163569e-03]
 [-1.83662879e-02]
 [-7.04343943e-03]
 [-3.47428667e-03]
 [-2.07823005e-03]
 [-2.83300666e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.98296949]
curr_Stock_Price:  99.153079416122
curr_Factors:  [99.15307942]
mat_Sqrt:  [[0.15]]
grads:  [0.04510007]
Stock Position:  0.045100071544169056
Bond Position:  [-15.45478046]


portfolio before change:  [-11.00396468]
curr_Stock_Price:  98.70897279638787
curr_Factors:  [98.7089728]
mat_Sqrt:  [[0.15]]
grads:  [-0.16995793]
Stock Position:  -0.1699579251921943
Bond Position:  [5.77240753]


portfolio before change:  [-11.01076337]
curr_Stock_Price:  98.75109777411367
curr_Factors:  [98.75109777]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307405]
Stock Position:  -0.030740501102665917
Bond Position:  [-7.97510514]


portfolio before change:  [-11.02874743]
curr_Stock_Price:  99.31991078005728
curr_Factors:  [99.31991078]
mat_Sqrt:  [[0.15]]
grads:  [0.05430117]
Stock Position:  0.054301174005828096
Bond Position:  [-16.42193518]


portfolio before change:  [-11.0151728]
curr_Stock_Price:  99.58880048178285
curr_Factors:  [99.58880048]
mat_Sqrt:  [[0.15]]
grads:  [0.03183864]
Stock Position:  0.031838635187629444
Bond Position:  [-14.18594429]


portfolio before change:  [-11.04133045]
curr_Stock_Price:  98.79507929391004
curr_Factors:  [98.79507929]
mat_Sqrt:  [[0.15]]
grads:  [0.11095755]
Stock Position:  0.11095755016159443
Bond Position:  [-22.00339042]


portfolio before change:  [-11.04444908]
curr_Stock_Price:  98.77936717157344
curr_Factors:  [98.77936717]
mat_Sqrt:  [[0.15]]
grads:  [0.0122548]
Stock Position:  0.012254798796218862
Bond Position:  [-12.25497035]


portfolio before change:  [-11.04165764]
curr_Stock_Price:  99.06965415592238
curr_Factors:  [99.06965416]
mat_Sqrt:  [[0.15]]
grads:  [-0.11751536]
Stock Position:  -0.1175153555253032
Bond Position:  [0.60054799]


portfolio before change:  [-10.98860113]
curr_Stock_Price:  98.61848784447784
curr_Factors:  [98.61848784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00948063]
Stock Position:  -0.009480627346506015
Bond Position:  [-10.053636]


portfolio before change:  [-10.98940197]
curr_Stock_Price:  98.6366791506927
curr_Factors:  [98.63667915]
mat_Sqrt:  [[0.15]]
grads:  [0.15122608]
Stock Position:  0.15122608125795167
Bond Position:  [-25.90584042]


portfolio before change:  [-11.14664946]
curr_Stock_Price:  97.60756878926416
curr_Factors:  [97.60756879]
mat_Sqrt:  [[0.15]]
grads:  [-0.32454407]
Stock Position:  -0.32454407202499963
Bond Position:  [20.53130837]


portfolio before change:  [-10.99692939]
curr_Stock_Price:  97.15019846631138
curr_Factors:  [97.15019847]
mat_Sqrt:  [[0.15]]
grads:  [0.20744555]
Stock Position:  0.20744555057471484
Bond Position:  [-31.1503058]


portfolio before change:  [-10.98364865]
curr_Stock_Price:  97.22360417981051
curr_Factors:  [97.22360418]
mat_Sqrt:  [[0.15]]
grads:  [-0.07085362]
Stock Position:  -0.07085361771379663
Bond Position:  [-4.09500457]


portfolio before change:  [-11.00375049]
curr_Stock_Price:  97.50370121735459
curr_Factors:  [97.50370122]
mat_Sqrt:  [[0.15]]
grads:  [0.01776724]
Stock Position:  0.017767240251996268
Bond Position:  [-12.73612217]


portfolio before change:  [-11.00998333]
curr_Stock_Price:  97.19769906405872
curr_Factors:  [97.19769906]
mat_Sqrt:  [[0.15]]
grads:  [-0.04695601]
Stock Position:  -0.04695600622371027
Bond Position:  [-6.44596757]


portfolio before change:  [-11.00517768]
curr_Stock_Price:  97.08677520747814
curr_Factors:  [97.08677521]
mat_Sqrt:  [[0.15]]
grads:  [0.07342382]
Stock Position:  0.07342382023960897
Bond Position:  [-18.13365961]


portfolio before change:  [-11.0123095]
curr_Stock_Price:  97.00507915575082
curr_Factors:  [97.00507916]
mat_Sqrt:  [[0.15]]
grads:  [0.08642112]
Stock Position:  0.08642111587975478
Bond Position:  [-19.39559669]


portfolio before change:  [-10.93377837]
curr_Stock_Price:  97.927809619972
curr_Factors:  [97.92780962]
mat_Sqrt:  [[0.15]]
grads:  [-0.04477673]
Stock Position:  -0.044776734166809884
Bond Position:  [-6.54889087]


portfolio before change:  [-10.92309238]
curr_Stock_Price:  97.68001784458495
curr_Factors:  [97.68001784]
mat_Sqrt:  [[0.15]]
grads:  [0.01522168]
Stock Position:  0.015221680934264977
Bond Position:  [-12.40994645]


portfolio before change:  [-10.94355214]
curr_Stock_Price:  96.38685479129263
curr_Factors:  [96.38685479]
mat_Sqrt:  [[0.15]]
grads:  [0.07669037]
Stock Position:  0.07669037227794362
Bond Position:  [-18.33549592]


portfolio before change:  [-10.88848468]
curr_Stock_Price:  97.1198473252544
curr_Factors:  [97.11984733]
mat_Sqrt:  [[0.15]]
grads:  [0.08495275]
Stock Position:  0.08495274765745156
Bond Position:  [-19.13908256]


portfolio before change:  [-10.8894846]
curr_Stock_Price:  97.12215815482848
curr_Factors:  [97.12215815]
mat_Sqrt:  [[0.15]]
grads:  [-0.06814351]
Stock Position:  -0.0681435090392824
Bond Position:  [-4.27123993]


portfolio before change:  [-10.91654656]
curr_Stock_Price:  97.51537253626711
curr_Factors:  [97.51537254]
mat_Sqrt:  [[0.15]]
grads:  [0.0330595]
Stock Position:  0.03305950464878429
Bond Position:  [-14.14035648]


portfolio before change:  [-10.91005156]
curr_Stock_Price:  97.73857013468911
curr_Factors:  [97.73857013]
mat_Sqrt:  [[0.15]]
grads:  [-0.05123604]
Stock Position:  -0.05123604445436738
Bond Position:  [-5.90231384]


portfolio before change:  [-10.87587462]
curr_Stock_Price:  97.06432115275958
curr_Factors:  [97.06432115]
mat_Sqrt:  [[0.15]]
grads:  [-0.07152045]
Stock Position:  -0.07152044656433114
Bond Position:  [-3.93379102]


portfolio before change:  [-10.86438969]
curr_Stock_Price:  96.90030095055003
curr_Factors:  [96.90030095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677449]
Stock Position:  -0.026774489293365074
Bond Position:  [-8.26993362]


portfolio before change:  [-10.8644372]
curr_Stock_Price:  96.88277006888036
curr_Factors:  [96.88277007]
mat_Sqrt:  [[0.15]]
grads:  [-0.00564131]
Stock Position:  -0.005641311100074385
Bond Position:  [-10.31789135]


portfolio before change:  [-10.86666419]
curr_Stock_Price:  97.16322032765375
curr_Factors:  [97.16322033]
mat_Sqrt:  [[0.15]]
grads:  [0.06428515]
Stock Position:  0.06428514893125474
Bond Position:  [-17.11281628]


portfolio before change:  [-10.83654127]
curr_Stock_Price:  97.64844128699056
curr_Factors:  [97.64844129]
mat_Sqrt:  [[0.15]]
grads:  [-0.16195662]
Stock Position:  -0.16195662188235568
Bond Position:  [4.97827041]


portfolio before change:  [-10.80052482]
curr_Stock_Price:  97.42797914014326
curr_Factors:  [97.42797914]
mat_Sqrt:  [[0.15]]
grads:  [0.01330156]
Stock Position:  0.013301559930997959
Bond Position:  [-12.09646892]


portfolio before change:  [-10.79733147]
curr_Stock_Price:  97.724891556122
curr_Factors:  [97.72489156]
mat_Sqrt:  [[0.15]]
grads:  [0.0039241]
Stock Position:  0.003924095684387525
Bond Position:  [-11.1808133]


portfolio before change:  [-10.79888349]
curr_Stock_Price:  97.50746776247888
curr_Factors:  [97.50746776]
mat_Sqrt:  [[0.15]]
grads:  [-0.0672405]
Stock Position:  -0.06724049782275233
Bond Position:  [-4.24243281]


portfolio before change:  [-10.80631983]
curr_Stock_Price:  97.61411752943987
curr_Factors:  [97.61411753]
mat_Sqrt:  [[0.15]]
grads:  [-0.06054366]
Stock Position:  -0.060543657429211986
Bond Position:  [-4.89640414]


portfolio before change:  [-10.80619359]
curr_Stock_Price:  97.60697762519777
curr_Factors:  [97.60697763]
mat_Sqrt:  [[0.15]]
grads:  [0.03584078]
Stock Position:  0.03584077765394268
Bond Position:  [-14.30450357]


portfolio before change:  [-10.79157168]
curr_Stock_Price:  98.03989139458396
curr_Factors:  [98.03989139]
mat_Sqrt:  [[0.15]]
grads:  [0.08658935]
Stock Position:  0.08658935411584606
Bond Position:  [-19.28078256]


portfolio before change:  [-10.79719304]
curr_Stock_Price:  97.98888897488474
curr_Factors:  [97.98888897]
mat_Sqrt:  [[0.15]]
grads:  [0.1127379]
Stock Position:  0.11273789585534003
Bond Position:  [-21.8442542]


portfolio before change:  [-10.84255937]
curr_Stock_Price:  97.59859407999197
curr_Factors:  [97.59859408]
mat_Sqrt:  [[0.15]]
grads:  [-0.22881433]
Stock Position:  -0.22881432716434244
Bond Position:  [11.48939727]


portfolio before change:  [-10.80667516]
curr_Stock_Price:  97.44490570614815
curr_Factors:  [97.44490571]
mat_Sqrt:  [[0.15]]
grads:  [0.05768949]
Stock Position:  0.057689487138899063
Bond Position:  [-16.42822179]


portfolio before change:  [-10.80800292]
curr_Stock_Price:  97.439688748623
curr_Factors:  [97.43968875]
mat_Sqrt:  [[0.15]]
grads:  [-0.17098608]
Stock Position:  -0.17098607846205482
Bond Position:  [5.85282735]


portfolio before change:  [-10.74493336]
curr_Stock_Price:  97.07297032892724
curr_Factors:  [97.07297033]
mat_Sqrt:  [[0.15]]
grads:  [0.10038656]
Stock Position:  0.10038655754456619
Bond Position:  [-20.48975468]


portfolio before change:  [-10.69556971]
curr_Stock_Price:  97.57746321326032
curr_Factors:  [97.57746321]
mat_Sqrt:  [[0.15]]
grads:  [-0.05926672]
Stock Position:  -0.05926672204081282
Bond Position:  [-4.91247332]


portfolio before change:  [-10.73886332]
curr_Stock_Price:  98.30277025157498
curr_Factors:  [98.30277025]
mat_Sqrt:  [[0.15]]
grads:  [0.05938055]
Stock Position:  0.059380545815596646
Bond Position:  [-16.57613547]


portfolio before change:  [-10.7029586]
curr_Stock_Price:  98.92487220761811
curr_Factors:  [98.92487221]
mat_Sqrt:  [[0.15]]
grads:  [0.15345609]
Stock Position:  0.15345609205390412
Bond Position:  [-25.8835829]


portfolio before change:  [-10.8003757]
curr_Stock_Price:  98.30059379314783
curr_Factors:  [98.30059379]
mat_Sqrt:  [[0.15]]
grads:  [0.03066197]
Stock Position:  0.030661972878990307
Bond Position:  [-13.81446584]


portfolio before change:  [-10.83639989]
curr_Stock_Price:  97.15387203550024
curr_Factors:  [97.15387204]
mat_Sqrt:  [[0.15]]
grads:  [0.01965645]
Stock Position:  0.019656449368350582
Bond Position:  [-12.74610005]


portfolio before change:  [-10.84033384]
curr_Stock_Price:  96.99426542973144
curr_Factors:  [96.99426543]
mat_Sqrt:  [[0.15]]
grads:  [0.02702225]
Stock Position:  0.02702225335489176
Bond Position:  [-13.46133745]


portfolio before change:  [-10.8333017]
curr_Stock_Price:  97.28563648574729
curr_Factors:  [97.28563649]
mat_Sqrt:  [[0.15]]
grads:  [0.01074305]
Stock Position:  0.010743046895332377
Bond Position:  [-11.87844585]


portfolio before change:  [-10.83719156]
curr_Stock_Price:  96.99266183925057
curr_Factors:  [96.99266184]
mat_Sqrt:  [[0.15]]
grads:  [-0.07962586]
Stock Position:  -0.07962585559139419
Bond Position:  [-3.11406788]


portfolio before change:  [-10.90467277]
curr_Stock_Price:  97.83769598884118
curr_Factors:  [97.83769599]
mat_Sqrt:  [[0.15]]
grads:  [-0.04555698]
Stock Position:  -0.045556984619331775
Bond Position:  [-6.44748236]


portfolio before change:  [-10.87866743]
curr_Stock_Price:  97.25801940053717
curr_Factors:  [97.2580194]
mat_Sqrt:  [[0.15]]
grads:  [-0.00374196]
Stock Position:  -0.0037419564871606545
Bond Position:  [-10.51473215]


portfolio before change:  [-10.88019189]
curr_Stock_Price:  97.48978706191829
curr_Factors:  [97.48978706]
mat_Sqrt:  [[0.15]]
grads:  [0.28875954]
Stock Position:  0.28875954428806583
Bond Position:  [-39.03129837]


portfolio before change:  [-10.83738224]
curr_Stock_Price:  97.64648899414752
curr_Factors:  [97.64648899]
mat_Sqrt:  [[0.15]]
grads:  [-0.0613]
Stock Position:  -0.06129999623563763
Bond Position:  [-4.85165283]


portfolio before change:  [-10.7976688]
curr_Stock_Price:  96.993688272483
curr_Factors:  [96.99368827]
mat_Sqrt:  [[0.15]]
grads:  [0.01557391]
Stock Position:  0.015573905221990848
Bond Position:  [-12.3082393]


portfolio before change:  [-10.79946831]
curr_Stock_Price:  96.92753733661966
curr_Factors:  [96.92753734]
mat_Sqrt:  [[0.15]]
grads:  [0.03331394]
Stock Position:  0.033313936009655785
Bond Position:  [-14.02850609]


portfolio before change:  [-10.7925643]
curr_Stock_Price:  97.1610978694361
curr_Factors:  [97.16109787]
mat_Sqrt:  [[0.15]]
grads:  [0.03032603]
Stock Position:  0.030326029998349567
Bond Position:  [-13.73907467]


portfolio before change:  [-10.79739471]
curr_Stock_Price:  97.0301316074486
curr_Factors:  [97.03013161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500045]
Stock Position:  -0.005000454413112941
Bond Position:  [-10.31219996]


portfolio before change:  [-10.79551128]
curr_Stock_Price:  96.52458646304038
curr_Factors:  [96.52458646]
mat_Sqrt:  [[0.15]]
grads:  [-0.0207163]
Stock Position:  -0.020716296445821514
Bond Position:  [-8.79587934]


portfolio before change:  [-10.80097536]
curr_Stock_Price:  96.76180639887885
curr_Factors:  [96.7618064]
mat_Sqrt:  [[0.15]]
grads:  [-0.00356089]
Stock Position:  -0.003560885735085259
Bond Position:  [-10.45641763]


portfolio before change:  [-10.80215689]
curr_Stock_Price:  96.91007979582545
curr_Factors:  [96.9100798]
mat_Sqrt:  [[0.15]]
grads:  [0.01028481]
Stock Position:  0.0102848144764788
Bond Position:  [-11.79885908]


portfolio before change:  [-10.80573737]
curr_Stock_Price:  96.63365061659364
curr_Factors:  [96.63365062]
mat_Sqrt:  [[0.15]]
grads:  [-0.11580359]
Stock Position:  -0.11580359469017185
Bond Position:  [0.38478674]


portfolio before change:  [-10.89570744]
curr_Stock_Price:  97.4107778462303
curr_Factors:  [97.41077785]
mat_Sqrt:  [[0.15]]
grads:  [-0.01275568]
Stock Position:  -0.012755678308248038
Bond Position:  [-9.6531669]


portfolio before change:  [-10.89333813]
curr_Stock_Price:  97.17773197925149
curr_Factors:  [97.17773198]
mat_Sqrt:  [[0.15]]
grads:  [0.04192071]
Stock Position:  0.04192070865109039
Bond Position:  [-14.96709752]


portfolio before change:  [-10.89383437]
curr_Stock_Price:  97.18820958913574
curr_Factors:  [97.18820959]
mat_Sqrt:  [[0.15]]
grads:  [0.08874665]
Stock Position:  0.08874665025541022
Bond Position:  [-19.51896242]


portfolio before change:  [-10.87214693]
curr_Stock_Price:  97.44633101201318
curr_Factors:  [97.44633101]
mat_Sqrt:  [[0.15]]
grads:  [-0.12268567]
Stock Position:  -0.12268567065052953
Bond Position:  [1.08312154]


portfolio before change:  [-10.9221608]
curr_Stock_Price:  97.85454139198792
curr_Factors:  [97.85454139]
mat_Sqrt:  [[0.15]]
grads:  [-0.06676696]
Stock Position:  -0.06676695535662294
Bond Position:  [-4.388711]


portfolio before change:  [-10.88022482]
curr_Stock_Price:  97.2223382384157
curr_Factors:  [97.22233824]
mat_Sqrt:  [[0.15]]
grads:  [-0.06257477]
Stock Position:  -0.06257477209746631
Bond Position:  [-4.79655917]


portfolio before change:  [-10.87756021]
curr_Stock_Price:  97.1749644504398
curr_Factors:  [97.17496445]
mat_Sqrt:  [[0.15]]
grads:  [-0.03147957]
Stock Position:  -0.03147956752383166
Bond Position:  [-7.81853436]


portfolio before change:  [-10.88341197]
curr_Stock_Price:  97.34533142243428
curr_Factors:  [97.34533142]
mat_Sqrt:  [[0.15]]
grads:  [0.11162042]
Stock Position:  0.11162042350135941
Bond Position:  [-21.74913909]


portfolio before change:  [-10.82236833]
curr_Stock_Price:  97.90439580775157
curr_Factors:  [97.90439581]
mat_Sqrt:  [[0.15]]
grads:  [-0.06739663]
Stock Position:  -0.06739663453696657
Bond Position:  [-4.22394154]


portfolio before change:  [-10.91118338]
curr_Stock_Price:  99.21827517371446
curr_Factors:  [99.21827517]
mat_Sqrt:  [[0.15]]
grads:  [0.04058136]
Stock Position:  0.04058135898785532
Bond Position:  [-14.93759582]


portfolio before change:  [-10.91250121]
curr_Stock_Price:  99.20880773822397
curr_Factors:  [99.20880774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05533525]
Stock Position:  -0.05533525384191639
Bond Position:  [-5.42275665]


portfolio before change:  [-10.88978162]
curr_Stock_Price:  98.79210191624551
curr_Factors:  [98.79210192]
mat_Sqrt:  [[0.15]]
grads:  [0.07241499]
Stock Position:  0.07241498523482551
Bond Position:  [-18.04381022]


portfolio before change:  [-10.85937373]
curr_Stock_Price:  99.22758724657228
curr_Factors:  [99.22758725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03679076]
Stock Position:  -0.03679075849825222
Bond Position:  [-7.20871553]


portfolio before change:  [-10.84088978]
curr_Stock_Price:  98.71293339367651
curr_Factors:  [98.71293339]
mat_Sqrt:  [[0.15]]
grads:  [0.0558109]
Stock Position:  0.055810904582866555
Bond Position:  [-16.35014789]


portfolio before change:  [-10.8376611]
curr_Stock_Price:  98.78909408722551
curr_Factors:  [98.78909409]
mat_Sqrt:  [[0.15]]
grads:  [-0.12244192]
Stock Position:  -0.12244191947418893
Bond Position:  [1.2582652]


portfolio before change:  [-10.78704152]
curr_Stock_Price:  98.37631930070636
curr_Factors:  [98.3763193]
mat_Sqrt:  [[0.15]]
grads:  [-0.04695626]
Stock Position:  -0.04695626284610971
Bond Position:  [-6.16765721]


portfolio before change:  [-10.83008359]
curr_Stock_Price:  99.28475154688397
curr_Factors:  [99.28475155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02316191]
Stock Position:  -0.023161911114756604
Bond Position:  [-8.530459]


portfolio before change:  [-10.84015328]
curr_Stock_Price:  99.69648418074988
curr_Factors:  [99.69648418]
mat_Sqrt:  [[0.15]]
grads:  [-0.01385487]
Stock Position:  -0.013854866979580011
Bond Position:  [-9.45887175]


portfolio before change:  [-10.83577301]
curr_Stock_Price:  99.33765980058965
curr_Factors:  [99.3376598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.83577301]
Stock Price:  99.23404543439646
PL:  [-10.83577301]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.16586531e-03]
 [ 3.08364682e-03]
 [ 6.06127124e-04]
 [ 8.35665138e-03]
 [ 4.52671234e-03]
 [ 2.15193259e-02]
 [ 2.28133696e-03]
 [-1.83922244e-02]
 [ 1.61152658e-02]
 [-3.65911029e-03]
 [ 1.40044150e-02]
 [-3.87802920e-03]
 [-1.41479768e-02]
 [ 7.55227273e-03]
 [-6.93647647e-03]
 [ 1.07089949e-02]
 [ 7.21161236e-03]
 [-1.16308034e-02]
 [-2.16753443e-04]
 [ 1.38373970e-02]
 [ 1.13747658e-02]
 [-8.16175542e-03]
 [ 7.91405760e-03]
 [ 4.15963627e-02]
 [-4.13721282e-03]
 [ 1.36663901e-02]
 [-7.05547951e-03]
 [ 5.94056287e-03]
 [-4.14525159e-03]
 [-1.81200617e-03]
 [ 3.91039503e-03]
 [-1.20870651e-02]
 [ 3.69167996e-03]
 [ 5.65694361e-03]
 [ 1.21391597e-02]
 [ 1.66309845e-02]
 [-3.48769845e-02]
 [ 9.05934054e-03]
 [-1.36451472e-02]
 [ 2.49171007e-02]
 [-5.86493400e-03]
 [-8.01446432e-04]
 [ 2.30074448e-02]
 [ 4.42712274e-03]
 [-8.04656071e-03]
 [-6.06420315e-03]
 [ 1.95410973e-04]
 [-1.23198221e-02]
 [-9.54521237e-03]
 [-1.57643803e-03]
 [ 4.18128214e-02]
 [-6.78157112e-03]
 [ 2.12027537e-03]
 [ 4.97809088e-03]
 [ 4.64846841e-03]
 [-1.71642141e-03]
 [-2.08086737e-03]
 [-6.00169921e-04]
 [ 1.52839165e-03]
 [-3.92794211e-03]
 [-4.40554734e-03]
 [ 6.24284785e-03]
 [ 1.27865282e-02]
 [-1.83820808e-02]
 [-9.07391697e-03]
 [-5.13233145e-03]
 [-4.89632815e-03]
 [ 2.02856575e-02]
 [-8.79651819e-03]
 [ 6.14515371e-03]
 [-8.03281247e-03]
 [ 1.06814812e-02]
 [-8.03750893e-03]
 [ 1.36007903e-02]
 [-2.24860573e-02]
 [-4.26811067e-03]
 [-3.40144053e-03]
 [-2.12462428e-03]
 [ 3.57867871e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.06540108]
curr_Stock_Price:  99.7329439351838
curr_Factors:  [99.73294394]
mat_Sqrt:  [[0.15]]
grads:  [0.02110577]
Stock Position:  0.02110576873391862
Bond Position:  [-4.17034153]


portfolio before change:  [-2.05504795]
curr_Stock_Price:  100.23582957230134
curr_Factors:  [100.23582957]
mat_Sqrt:  [[0.15]]
grads:  [0.02055765]
Stock Position:  0.02055764549353255
Bond Position:  [-4.1156606]


portfolio before change:  [-2.06099737]
curr_Stock_Price:  99.95894060415958
curr_Factors:  [99.9589406]
mat_Sqrt:  [[0.15]]
grads:  [0.00404085]
Stock Position:  0.0040408474966537045
Bond Position:  [-2.46491621]


portfolio before change:  [-2.0618723]
curr_Stock_Price:  99.78054658051917
curr_Factors:  [99.78054658]
mat_Sqrt:  [[0.15]]
grads:  [0.05571101]
Stock Position:  0.05571100921574551
Bond Position:  [-7.62074725]


portfolio before change:  [-2.07523713]
curr_Stock_Price:  99.54920048088047
curr_Factors:  [99.54920048]
mat_Sqrt:  [[0.15]]
grads:  [0.03017808]
Stock Position:  0.030178082278930197
Bond Position:  [-5.07944109]


portfolio before change:  [-2.07488251]
curr_Stock_Price:  99.57147153925642
curr_Factors:  [99.57147154]
mat_Sqrt:  [[0.15]]
grads:  [0.14346217]
Stock Position:  0.14346217280693338
Bond Position:  [-16.35962217]


portfolio before change:  [-2.22331206]
curr_Stock_Price:  98.54397393129338
curr_Factors:  [98.54397393]
mat_Sqrt:  [[0.15]]
grads:  [0.01520891]
Stock Position:  0.01520891306377294
Bond Position:  [-3.72205879]


portfolio before change:  [-2.20413512]
curr_Stock_Price:  99.82017105092459
curr_Factors:  [99.82017105]
mat_Sqrt:  [[0.15]]
grads:  [-0.12261483]
Stock Position:  -0.12261482907250876
Bond Position:  [10.03529809]


portfolio before change:  [-2.206241]
curr_Stock_Price:  99.84246120231066
curr_Factors:  [99.8424612]
mat_Sqrt:  [[0.15]]
grads:  [0.10743511]
Stock Position:  0.10743510554267958
Bond Position:  [-12.93282636]


portfolio before change:  [-2.19431863]
curr_Stock_Price:  99.96095782030866
curr_Factors:  [99.96095782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439407]
Stock Position:  -0.024394068597678776
Bond Position:  [0.24413583]


portfolio before change:  [-2.168821]
curr_Stock_Price:  98.9163443421531
curr_Factors:  [98.91634434]
mat_Sqrt:  [[0.15]]
grads:  [0.09336277]
Stock Position:  0.09336276644993957
Bond Position:  [-11.40392455]


portfolio before change:  [-2.08384311]
curr_Stock_Price:  99.83416904806785
curr_Factors:  [99.83416905]
mat_Sqrt:  [[0.15]]
grads:  [-0.02585353]
Stock Position:  -0.025853527991376662
Bond Position:  [0.49722237]


portfolio before change:  [-2.05475422]
curr_Stock_Price:  98.71022918590701
curr_Factors:  [98.71022919]
mat_Sqrt:  [[0.15]]
grads:  [-0.09431985]
Stock Position:  -0.09431984527446954
Bond Position:  [7.25557932]


portfolio before change:  [-2.06225536]
curr_Stock_Price:  98.79456584443312
curr_Factors:  [98.79456584]
mat_Sqrt:  [[0.15]]
grads:  [0.05034848]
Stock Position:  0.05034848489195291
Bond Position:  [-7.03641206]


portfolio before change:  [-2.04150371]
curr_Stock_Price:  99.21546110923836
curr_Factors:  [99.21546111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624318]
Stock Position:  -0.046243176463971324
Bond Position:  [2.54653437]


portfolio before change:  [-2.06282871]
curr_Stock_Price:  99.680052088831
curr_Factors:  [99.68005209]
mat_Sqrt:  [[0.15]]
grads:  [0.0713933]
Stock Position:  0.07139329934524527
Bond Position:  [-9.1793165]


portfolio before change:  [-2.0902837]
curr_Stock_Price:  99.30352839575593
curr_Factors:  [99.3035284]
mat_Sqrt:  [[0.15]]
grads:  [0.04807742]
Stock Position:  0.04807741570323757
Bond Position:  [-6.86454072]


portfolio before change:  [-2.02441628]
curr_Stock_Price:  100.68248071563548
curr_Factors:  [100.68248072]
mat_Sqrt:  [[0.15]]
grads:  [-0.07753869]
Stock Position:  -0.07753868900087293
Bond Position:  [5.78237128]


portfolio before change:  [-1.99332411]
curr_Stock_Price:  100.2861525721699
curr_Factors:  [100.28615257]
mat_Sqrt:  [[0.15]]
grads:  [-0.00144502]
Stock Position:  -0.0014450229563632857
Bond Position:  [-1.84840832]


portfolio before change:  [-1.99282249]
curr_Stock_Price:  99.85906511749202
curr_Factors:  [99.85906512]
mat_Sqrt:  [[0.15]]
grads:  [0.09224931]
Stock Position:  0.09224931348657421
Bond Position:  [-11.20475269]


portfolio before change:  [-1.99843895]
curr_Stock_Price:  99.80577322381416
curr_Factors:  [99.80577322]
mat_Sqrt:  [[0.15]]
grads:  [0.07583177]
Stock Position:  0.07583177190447986
Bond Position:  [-9.56688758]


portfolio before change:  [-2.04913333]
curr_Stock_Price:  99.14514726505764
curr_Factors:  [99.14514727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0544117]
Stock Position:  -0.05441170282026017
Bond Position:  [3.34552296]


portfolio before change:  [-2.05437508]
curr_Stock_Price:  99.24532518445484
curr_Factors:  [99.24532518]
mat_Sqrt:  [[0.15]]
grads:  [0.05276038]
Stock Position:  0.05276038398173142
Bond Position:  [-7.29059655]


portfolio before change:  [-2.02386846]
curr_Stock_Price:  99.83217264897404
curr_Factors:  [99.83217265]
mat_Sqrt:  [[0.15]]
grads:  [0.27730908]
Stock Position:  0.2773090844525652
Bond Position:  [-29.70823686]


portfolio before change:  [-2.04246092]
curr_Stock_Price:  99.77182253409742
curr_Factors:  [99.77182253]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758142]
Stock Position:  -0.027581418805332977
Bond Position:  [0.7093875]


portfolio before change:  [-2.05452053]
curr_Stock_Price:  100.21066684841853
curr_Factors:  [100.21066685]
mat_Sqrt:  [[0.15]]
grads:  [0.09110927]
Stock Position:  0.09110926728225195
Bond Position:  [-11.18464096]


portfolio before change:  [-2.11201874]
curr_Stock_Price:  99.58724899580477
curr_Factors:  [99.587249]
mat_Sqrt:  [[0.15]]
grads:  [-0.04703653]
Stock Position:  -0.04703653007876554
Bond Position:  [2.5722199]


portfolio before change:  [-2.11062329]
curr_Stock_Price:  99.56099966163718
curr_Factors:  [99.56099966]
mat_Sqrt:  [[0.15]]
grads:  [0.03960375]
Stock Position:  0.03960375246405533
Bond Position:  [-6.05361247]


portfolio before change:  [-2.09490652]
curr_Stock_Price:  99.96740388976197
curr_Factors:  [99.96740389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02763501]
Stock Position:  -0.02763501063251436
Bond Position:  [0.66769375]


portfolio before change:  [-2.08080227]
curr_Stock_Price:  99.45853779064207
curr_Factors:  [99.45853779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01208004]
Stock Position:  -0.012080041152455456
Bond Position:  [-0.87933904]


portfolio before change:  [-2.08932098]
curr_Stock_Price:  100.15917689721167
curr_Factors:  [100.1591769]
mat_Sqrt:  [[0.15]]
grads:  [0.0260693]
Stock Position:  0.026069300223241547
Bond Position:  [-4.70040063]


portfolio before change:  [-2.08580406]
curr_Stock_Price:  100.30535276854667
curr_Factors:  [100.30535277]
mat_Sqrt:  [[0.15]]
grads:  [-0.08058043]
Stock Position:  -0.08058043391720238
Bond Position:  [5.99684479]


portfolio before change:  [-2.08079099]
curr_Stock_Price:  100.24779218556233
curr_Factors:  [100.24779219]
mat_Sqrt:  [[0.15]]
grads:  [0.0246112]
Stock Position:  0.02461119970780563
Bond Position:  [-4.54800942]


portfolio before change:  [-2.0828706]
curr_Stock_Price:  100.17484369561751
curr_Factors:  [100.1748437]
mat_Sqrt:  [[0.15]]
grads:  [0.03771296]
Stock Position:  0.03771295741954444
Bond Position:  [-5.86076021]


portfolio before change:  [-2.11660136]
curr_Stock_Price:  99.29014906128022
curr_Factors:  [99.29014906]
mat_Sqrt:  [[0.15]]
grads:  [0.08092773]
Stock Position:  0.0809277313158655
Bond Position:  [-10.15192786]


portfolio before change:  [-2.17214431]
curr_Stock_Price:  98.61166178024102
curr_Factors:  [98.61166178]
mat_Sqrt:  [[0.15]]
grads:  [0.11087323]
Stock Position:  0.11087322986200285
Bond Position:  [-13.10553775]


portfolio before change:  [-2.16100288]
curr_Stock_Price:  98.71953770477579
curr_Factors:  [98.7195377]
mat_Sqrt:  [[0.15]]
grads:  [-0.23251323]
Stock Position:  -0.2325132296679217
Bond Position:  [20.79259567]


portfolio before change:  [-2.12535846]
curr_Stock_Price:  98.57182636950445
curr_Factors:  [98.57182637]
mat_Sqrt:  [[0.15]]
grads:  [0.0603956]
Stock Position:  0.060395603611166165
Bond Position:  [-8.07866341]


portfolio before change:  [-2.07619454]
curr_Stock_Price:  99.39421826451643
curr_Factors:  [99.39421826]
mat_Sqrt:  [[0.15]]
grads:  [-0.09096765]
Stock Position:  -0.09096764785345593
Bond Position:  [6.96546371]


portfolio before change:  [-2.12420731]
curr_Stock_Price:  99.92680457668075
curr_Factors:  [99.92680458]
mat_Sqrt:  [[0.15]]
grads:  [0.166114]
Stock Position:  0.16611400433628098
Bond Position:  [-18.72344895]


portfolio before change:  [-2.18541471]
curr_Stock_Price:  99.56538321385449
curr_Factors:  [99.56538321]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909956]
Stock Position:  -0.0390995599882725
Bond Position:  [1.70754797]


portfolio before change:  [-2.1706535]
curr_Stock_Price:  99.19058413216977
curr_Factors:  [99.19058413]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534298]
Stock Position:  -0.005342976211617778
Bond Position:  [-1.64068057]


portfolio before change:  [-2.16981332]
curr_Stock_Price:  99.01414207959078
curr_Factors:  [99.01414208]
mat_Sqrt:  [[0.15]]
grads:  [0.15338297]
Stock Position:  0.1533829650591806
Bond Position:  [-17.35689602]


portfolio before change:  [-2.19101436]
curr_Stock_Price:  98.88299191785218
curr_Factors:  [98.88299192]
mat_Sqrt:  [[0.15]]
grads:  [0.02951415]
Stock Position:  0.02951415158116077
Bond Position:  [-5.10946198]


portfolio before change:  [-2.18143848]
curr_Stock_Price:  99.21826279474989
curr_Factors:  [99.21826279]
mat_Sqrt:  [[0.15]]
grads:  [-0.05364374]
Stock Position:  -0.05364373807146698
Bond Position:  [3.14100002]


portfolio before change:  [-2.17781298]
curr_Stock_Price:  99.1543376458531
curr_Factors:  [99.15433765]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042802]
Stock Position:  -0.040428020978688285
Bond Position:  [1.83080066]


portfolio before change:  [-2.16577743]
curr_Stock_Price:  98.85946496251782
curr_Factors:  [98.85946496]
mat_Sqrt:  [[0.15]]
grads:  [0.00130274]
Stock Position:  0.0013027398215338197
Bond Position:  [-2.29456559]


portfolio before change:  [-2.16647999]
curr_Stock_Price:  98.43025477971614
curr_Factors:  [98.43025478]
mat_Sqrt:  [[0.15]]
grads:  [-0.08213215]
Stock Position:  -0.08213214701723875
Bond Position:  [5.91780816]


portfolio before change:  [-2.18971458]
curr_Stock_Price:  98.71765090636775
curr_Factors:  [98.71765091]
mat_Sqrt:  [[0.15]]
grads:  [-0.06363475]
Stock Position:  -0.0636347491394255
Bond Position:  [4.09215837]


portfolio before change:  [-2.1191468]
curr_Stock_Price:  97.61271974130719
curr_Factors:  [97.61271974]
mat_Sqrt:  [[0.15]]
grads:  [-0.01050959]
Stock Position:  -0.010509586860364649
Bond Position:  [-1.09327744]


portfolio before change:  [-2.11372021]
curr_Stock_Price:  97.08987145681787
curr_Factors:  [97.08987146]
mat_Sqrt:  [[0.15]]
grads:  [0.27875214]
Stock Position:  0.2787521427027301
Bond Position:  [-29.17772991]


portfolio before change:  [-2.07378472]
curr_Stock_Price:  97.23967892056592
curr_Factors:  [97.23967892]
mat_Sqrt:  [[0.15]]
grads:  [-0.04521047]
Stock Position:  -0.045210474139037435
Bond Position:  [2.32246727]


portfolio before change:  [-2.04385884]
curr_Stock_Price:  96.58096594779302
curr_Factors:  [96.58096595]
mat_Sqrt:  [[0.15]]
grads:  [0.01413517]
Stock Position:  0.014135169106050666
Bond Position:  [-3.40904712]


portfolio before change:  [-2.04060691]
curr_Stock_Price:  96.82609938145985
curr_Factors:  [96.82609938]
mat_Sqrt:  [[0.15]]
grads:  [0.03318727]
Stock Position:  0.03318727252833275
Bond Position:  [-5.25400105]


portfolio before change:  [-2.0252811]
curr_Stock_Price:  97.29779188403135
curr_Factors:  [97.29779188]
mat_Sqrt:  [[0.15]]
grads:  [0.03098979]
Stock Position:  0.03098978937858517
Bond Position:  [-5.04051918]


portfolio before change:  [-2.01603395]
curr_Stock_Price:  97.60635148884401
curr_Factors:  [97.60635149]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144281]
Stock Position:  -0.011442809375231655
Bond Position:  [-0.89914308]


portfolio before change:  [-2.00551842]
curr_Stock_Price:  96.68247618993524
curr_Factors:  [96.68247619]
mat_Sqrt:  [[0.15]]
grads:  [-0.01387245]
Stock Position:  -0.013872449110542103
Bond Position:  [-0.66429569]


portfolio before change:  [-2.01303393]
curr_Stock_Price:  97.22124112767202
curr_Factors:  [97.22124113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400113]
Stock Position:  -0.004001132806007516
Bond Position:  [-1.62403883]


portfolio before change:  [-2.01534363]
curr_Stock_Price:  97.77313520796588
curr_Factors:  [97.77313521]
mat_Sqrt:  [[0.15]]
grads:  [0.01018928]
Stock Position:  0.010189277652984288
Bond Position:  [-3.01158126]


portfolio before change:  [-2.01874938]
curr_Stock_Price:  97.45736039722618
curr_Factors:  [97.4573604]
mat_Sqrt:  [[0.15]]
grads:  [-0.02618628]
Stock Position:  -0.02618628075140232
Bond Position:  [0.53329642]


portfolio before change:  [-2.00661035]
curr_Stock_Price:  96.99506888285757
curr_Factors:  [96.99506888]
mat_Sqrt:  [[0.15]]
grads:  [-0.02937032]
Stock Position:  -0.029370315625248614
Bond Position:  [0.84216543]


portfolio before change:  [-2.01216474]
curr_Stock_Price:  97.18597677579353
curr_Factors:  [97.18597678]
mat_Sqrt:  [[0.15]]
grads:  [0.04161899]
Stock Position:  0.04161898569701585
Bond Position:  [-6.05694652]


portfolio before change:  [-2.00813665]
curr_Stock_Price:  97.29185788583045
curr_Factors:  [97.29185789]
mat_Sqrt:  [[0.15]]
grads:  [0.08524352]
Stock Position:  0.08524352154757782
Bond Position:  [-10.30163723]


portfolio before change:  [-1.99051809]
curr_Stock_Price:  97.5060961994468
curr_Factors:  [97.5060962]
mat_Sqrt:  [[0.15]]
grads:  [-0.12254721]
Stock Position:  -0.12254720500573253
Bond Position:  [9.95858147]


portfolio before change:  [-2.00036872]
curr_Stock_Price:  97.59155760369146
curr_Factors:  [97.5915576]
mat_Sqrt:  [[0.15]]
grads:  [-0.06049278]
Stock Position:  -0.06049277979371215
Bond Position:  [3.90321589]


portfolio before change:  [-2.02672368]
curr_Stock_Price:  98.03126160455496
curr_Factors:  [98.0312616]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421554]
Stock Position:  -0.034215543010262764
Bond Position:  [1.32746917]


portfolio before change:  [-2.04672115]
curr_Stock_Price:  98.61814222135989
curr_Factors:  [98.61814222]
mat_Sqrt:  [[0.15]]
grads:  [-0.03264219]
Stock Position:  -0.03264218764439393
Bond Position:  [1.17239076]


portfolio before change:  [-2.04151187]
curr_Stock_Price:  98.46079971228173
curr_Factors:  [98.46079971]
mat_Sqrt:  [[0.15]]
grads:  [0.13523772]
Stock Position:  0.1352377164425503
Bond Position:  [-15.35712558]


portfolio before change:  [-1.88675598]
curr_Stock_Price:  99.61222211168406
curr_Factors:  [99.61222211]
mat_Sqrt:  [[0.15]]
grads:  [-0.05864345]
Stock Position:  -0.05864345459007611
Bond Position:  [3.95484884]


portfolio before change:  [-1.84941512]
curr_Stock_Price:  98.97969327914204
curr_Factors:  [98.97969328]
mat_Sqrt:  [[0.15]]
grads:  [0.04096769]
Stock Position:  0.040967691430294405
Bond Position:  [-5.90438465]


portfolio before change:  [-1.84318105]
curr_Stock_Price:  99.14087168462332
curr_Factors:  [99.14087168]
mat_Sqrt:  [[0.15]]
grads:  [-0.05355208]
Stock Position:  -0.05355208311006679
Bond Position:  [3.46601915]


portfolio before change:  [-1.88241368]
curr_Stock_Price:  99.87752401633409
curr_Factors:  [99.87752402]
mat_Sqrt:  [[0.15]]
grads:  [0.07120987]
Stock Position:  0.07120987481964348
Bond Position:  [-8.99467966]


portfolio before change:  [-1.84996246]
curr_Stock_Price:  100.34113113921968
curr_Factors:  [100.34113114]
mat_Sqrt:  [[0.15]]
grads:  [-0.05358339]
Stock Position:  -0.053583392868287276
Bond Position:  [3.52665579]


portfolio before change:  [-1.83536742]
curr_Stock_Price:  100.07286492522722
curr_Factors:  [100.07286493]
mat_Sqrt:  [[0.15]]
grads:  [0.09067194]
Stock Position:  0.0906719351268526
Bond Position:  [-10.90916774]


portfolio before change:  [-1.79617266]
curr_Stock_Price:  100.51265493273128
curr_Factors:  [100.51265493]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990705]
Stock Position:  -0.14990704871510718
Bond Position:  [13.2713828]


portfolio before change:  [-1.67510408]
curr_Stock_Price:  99.71056397393698
curr_Factors:  [99.71056397]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845407]
Stock Position:  -0.028454071116457605
Bond Position:  [1.1620674]


portfolio before change:  [-1.66247921]
curr_Stock_Price:  99.26942346275999
curr_Factors:  [99.26942346]
mat_Sqrt:  [[0.15]]
grads:  [-0.02267627]
Stock Position:  -0.022676270192585248
Bond Position:  [0.58858106]


portfolio before change:  [-1.67600816]
curr_Stock_Price:  99.86765866593957
curr_Factors:  [99.86765867]
mat_Sqrt:  [[0.15]]
grads:  [-0.01416416]
Stock Position:  -0.014164161895958878
Bond Position:  [-0.26146648]


portfolio before change:  [-1.68240751]
curr_Stock_Price:  100.31830362914832
curr_Factors:  [100.31830363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68240751]
Stock Price:  101.03086114605166
PL:  [-2.71326866]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.36424866e-03]
 [-2.38395034e-03]
 [-3.49542575e-03]
 [ 5.83012961e-03]
 [-3.75083847e-03]
 [ 1.32901920e-02]
 [ 3.61749823e-03]
 [-2.54044849e-02]
 [-1.11290214e-02]
 [ 3.35413663e-02]
 [-1.38688484e-02]
 [ 2.70184701e-02]
 [-1.32016308e-02]
 [ 7.47609213e-03]
 [-6.97553317e-03]
 [ 6.04510596e-03]
 [ 7.17981106e-03]
 [-1.20638952e-02]
 [-5.02570661e-04]
 [ 1.35056865e-02]
 [ 1.16443313e-02]
 [-8.06749879e-03]
 [ 6.83640255e-03]
 [ 3.85910929e-02]
 [-6.59194097e-03]
 [ 1.23402931e-02]
 [-6.57087335e-03]
 [ 6.37821517e-03]
 [-1.36511929e-02]
 [-9.17845181e-05]
 [-1.45714915e-03]
 [-1.07623796e-02]
 [-7.95225319e-03]
 [ 5.35575139e-03]
 [ 1.28784118e-02]
 [ 1.65211636e-02]
 [-3.51788187e-02]
 [ 9.59920742e-03]
 [-6.59499031e-03]
 [ 2.24914198e-02]
 [-5.79524776e-03]
 [-1.48633120e-02]
 [ 2.30320530e-02]
 [ 2.78198970e-03]
 [-7.72748835e-03]
 [-4.53571678e-03]
 [ 1.23490920e-02]
 [-6.17512382e-03]
 [-1.52579750e-02]
 [-6.80303753e-03]
 [ 4.74742647e-02]
 [-8.75579491e-03]
 [ 2.87022707e-03]
 [ 5.40706579e-03]
 [ 5.68255966e-03]
 [-3.42187501e-03]
 [ 7.65559784e-03]
 [-3.48581784e-04]
 [ 1.54611066e-03]
 [ 1.78869248e-03]
 [ 9.00849938e-04]
 [-1.21811639e-02]
 [-8.09103711e-03]
 [-1.40278567e-02]
 [-7.01128981e-03]
 [ 1.73916574e-03]
 [-5.53007842e-03]
 [ 1.96367766e-02]
 [-8.24883316e-03]
 [ 7.27404149e-03]
 [-1.09258416e-02]
 [ 1.14130037e-02]
 [-6.60614022e-03]
 [ 1.89984248e-02]
 [-2.24789421e-02]
 [-3.10794401e-03]
 [-1.00776856e-02]
 [-1.59337132e-03]
 [ 2.92052528e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.93769149]
curr_Stock_Price:  99.67622328735757
curr_Factors:  [99.67622329]
mat_Sqrt:  [[0.15]]
grads:  [0.02242832]
Stock Position:  0.022428324429752167
Bond Position:  [-5.17326216]


portfolio before change:  [-2.9415372]
curr_Stock_Price:  99.5191728808461
curr_Factors:  [99.51917288]
mat_Sqrt:  [[0.15]]
grads:  [-0.015893]
Stock Position:  -0.015893002249203668
Bond Position:  [-1.35987877]


portfolio before change:  [-2.93239568]
curr_Stock_Price:  98.93863321761442
curr_Factors:  [98.93863322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02330284]
Stock Position:  -0.02330283835202069
Bond Position:  [-0.6268447]


portfolio before change:  [-2.92112649]
curr_Stock_Price:  98.45335449483778
curr_Factors:  [98.45335449]
mat_Sqrt:  [[0.15]]
grads:  [0.03886753]
Stock Position:  0.03886753072966502
Bond Position:  [-6.74776527]


portfolio before change:  [-2.92246614]
curr_Stock_Price:  98.42973821606476
curr_Factors:  [98.42973822]
mat_Sqrt:  [[0.15]]
grads:  [-0.02500559]
Stock Position:  -0.025005589780131045
Bond Position:  [-0.46117249]


portfolio before change:  [-2.91827773]
curr_Stock_Price:  98.26108649155564
curr_Factors:  [98.26108649]
mat_Sqrt:  [[0.15]]
grads:  [0.08860128]
Stock Position:  0.08860128032518816
Bond Position:  [-11.6243358]


portfolio before change:  [-2.9480069]
curr_Stock_Price:  97.93374779198815
curr_Factors:  [97.93374779]
mat_Sqrt:  [[0.15]]
grads:  [0.02411665]
Stock Position:  0.024116654888973084
Bond Position:  [-5.3098413]


portfolio before change:  [-2.94934913]
curr_Stock_Price:  97.89185343125418
curr_Factors:  [97.89185343]
mat_Sqrt:  [[0.15]]
grads:  [-0.16936323]
Stock Position:  -0.1693632327967711
Bond Position:  [13.62993163]


portfolio before change:  [-2.98246766]
curr_Stock_Price:  98.09243075323957
curr_Factors:  [98.09243075]
mat_Sqrt:  [[0.15]]
grads:  [-0.07419348]
Stock Position:  -0.07419347619415625
Bond Position:  [4.29535077]


portfolio before change:  [-2.9264408]
curr_Stock_Price:  97.34090389684064
curr_Factors:  [97.3409039]
mat_Sqrt:  [[0.15]]
grads:  [0.22360911]
Stock Position:  0.22360910833589195
Bond Position:  [-24.69275352]


portfolio before change:  [-2.71607501]
curr_Stock_Price:  98.28858058824162
curr_Factors:  [98.28858059]
mat_Sqrt:  [[0.15]]
grads:  [-0.09245899]
Stock Position:  -0.09245898923456611
Bond Position:  [6.37158781]


portfolio before change:  [-2.68503953]
curr_Stock_Price:  97.95722033190505
curr_Factors:  [97.95722033]
mat_Sqrt:  [[0.15]]
grads:  [0.18012313]
Stock Position:  0.18012313385343162
Bond Position:  [-20.32940104]


portfolio before change:  [-2.7112662]
curr_Stock_Price:  97.81867045106381
curr_Factors:  [97.81867045]
mat_Sqrt:  [[0.15]]
grads:  [-0.08801087]
Stock Position:  -0.088010872133359
Bond Position:  [5.8978403]


portfolio before change:  [-2.79501027]
curr_Stock_Price:  98.77437849079934
curr_Factors:  [98.77437849]
mat_Sqrt:  [[0.15]]
grads:  [0.04984061]
Stock Position:  0.04984061420158504
Bond Position:  [-7.71798596]


portfolio before change:  [-2.81006081]
curr_Stock_Price:  98.48208374170679
curr_Factors:  [98.48208374]
mat_Sqrt:  [[0.15]]
grads:  [-0.04650355]
Stock Position:  -0.046503554491707
Bond Position:  [1.76970614]


portfolio before change:  [-2.82674547]
curr_Stock_Price:  98.84324476330542
curr_Factors:  [98.84324476]
mat_Sqrt:  [[0.15]]
grads:  [0.04030071]
Stock Position:  0.04030070641736915
Bond Position:  [-6.81019806]


portfolio before change:  [-2.81439392]
curr_Stock_Price:  99.16029144263824
curr_Factors:  [99.16029144]
mat_Sqrt:  [[0.15]]
grads:  [0.04786541]
Stock Position:  0.04786540705574972
Bond Position:  [-7.56074163]


portfolio before change:  [-2.78764263]
curr_Stock_Price:  99.72904982692546
curr_Factors:  [99.72904983]
mat_Sqrt:  [[0.15]]
grads:  [-0.08042597]
Stock Position:  -0.08042596828634954
Bond Position:  [5.23316277]


portfolio before change:  [-2.77593971]
curr_Stock_Price:  99.58760503109
curr_Factors:  [99.58760503]
mat_Sqrt:  [[0.15]]
grads:  [-0.00335047]
Stock Position:  -0.0033504710759937827
Bond Position:  [-2.44227432]


portfolio before change:  [-2.77409849]
curr_Stock_Price:  98.99250399502816
curr_Factors:  [98.992504]
mat_Sqrt:  [[0.15]]
grads:  [0.09003791]
Stock Position:  0.09003791002449543
Bond Position:  [-11.68717666]


portfolio before change:  [-2.76545708]
curr_Stock_Price:  99.09659215190258
curr_Factors:  [99.09659215]
mat_Sqrt:  [[0.15]]
grads:  [0.07762888]
Stock Position:  0.07762887522578758
Bond Position:  [-10.45821407]


portfolio before change:  [-2.70219084]
curr_Stock_Price:  99.91999582401833
curr_Factors:  [99.91999582]
mat_Sqrt:  [[0.15]]
grads:  [-0.05378333]
Stock Position:  -0.05378332529598118
Bond Position:  [2.6718388]


portfolio before change:  [-2.71072632]
curr_Stock_Price:  100.08180201909012
curr_Factors:  [100.08180202]
mat_Sqrt:  [[0.15]]
grads:  [0.04557602]
Stock Position:  0.045576017006578734
Bond Position:  [-7.27205623]


portfolio before change:  [-2.7300627]
curr_Stock_Price:  99.6675080309302
curr_Factors:  [99.66750803]
mat_Sqrt:  [[0.15]]
grads:  [0.25727395]
Stock Position:  0.25727395272849585
Bond Position:  [-28.37191645]


portfolio before change:  [-2.79160202]
curr_Stock_Price:  99.43520306443112
curr_Factors:  [99.43520306]
mat_Sqrt:  [[0.15]]
grads:  [-0.04394627]
Stock Position:  -0.043946273131653314
Bond Position:  [1.57820457]


portfolio before change:  [-2.81959725]
curr_Stock_Price:  100.07448077768048
curr_Factors:  [100.07448078]
mat_Sqrt:  [[0.15]]
grads:  [0.08226862]
Stock Position:  0.0822686204323845
Bond Position:  [-11.05258673]


portfolio before change:  [-2.88006843]
curr_Stock_Price:  99.34783225269847
curr_Factors:  [99.34783225]
mat_Sqrt:  [[0.15]]
grads:  [-0.04380582]
Stock Position:  -0.043805822339270696
Bond Position:  [1.47194506]


portfolio before change:  [-2.86135009]
curr_Stock_Price:  98.92262978227438
curr_Factors:  [98.92262978]
mat_Sqrt:  [[0.15]]
grads:  [0.04252143]
Stock Position:  0.04252143444832902
Bond Position:  [-7.06768221]


portfolio before change:  [-2.87033797]
curr_Stock_Price:  98.72164552641897
curr_Factors:  [98.72164553]
mat_Sqrt:  [[0.15]]
grads:  [-0.09100795]
Stock Position:  -0.09100795259279813
Bond Position:  [6.11411686]


portfolio before change:  [-2.83962044]
curr_Stock_Price:  98.3883187902651
curr_Factors:  [98.38831879]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006119]
Stock Position:  -0.0006118967872279626
Bond Position:  [-2.77941695]


portfolio before change:  [-2.83961379]
curr_Stock_Price:  98.09354708336613
curr_Factors:  [98.09354708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971433]
Stock Position:  -0.009714327657004551
Bond Position:  [-1.88670094]


portfolio before change:  [-2.84732476]
curr_Stock_Price:  98.87518053325404
curr_Factors:  [98.87518053]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717492]
Stock Position:  -0.07174919743122991
Bond Position:  [4.24689009]


portfolio before change:  [-2.7979325]
curr_Stock_Price:  98.19047853844934
curr_Factors:  [98.19047854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05301502]
Stock Position:  -0.0530150212584045
Bond Position:  [2.4076378]


portfolio before change:  [-2.76959015]
curr_Stock_Price:  97.65870718086758
curr_Factors:  [97.65870718]
mat_Sqrt:  [[0.15]]
grads:  [0.03570501]
Stock Position:  0.035705009234587755
Bond Position:  [-6.25649519]


portfolio before change:  [-2.75018006]
curr_Stock_Price:  98.21328306899736
curr_Factors:  [98.21328307]
mat_Sqrt:  [[0.15]]
grads:  [0.08585608]
Stock Position:  0.08585607873494353
Bond Position:  [-11.18238742]


portfolio before change:  [-2.71453961]
curr_Stock_Price:  98.63654221911212
curr_Factors:  [98.63654222]
mat_Sqrt:  [[0.15]]
grads:  [0.11014109]
Stock Position:  0.1101410904770296
Bond Position:  [-13.57847593]


portfolio before change:  [-2.63908292]
curr_Stock_Price:  99.32933879692477
curr_Factors:  [99.3293388]
mat_Sqrt:  [[0.15]]
grads:  [-0.23452546]
Stock Position:  -0.23452545823728463
Bond Position:  [20.65617578]


portfolio before change:  [-2.73612599]
curr_Stock_Price:  99.74862855514235
curr_Factors:  [99.74862856]
mat_Sqrt:  [[0.15]]
grads:  [0.06399472]
Stock Position:  0.06399471615915002
Bond Position:  [-9.11951116]


portfolio before change:  [-2.70581881]
curr_Stock_Price:  100.23112415249823
curr_Factors:  [100.23112415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0439666]
Stock Position:  -0.04396660208572192
Bond Position:  [1.70100315]


portfolio before change:  [-2.71417124]
curr_Stock_Price:  100.4235145911514
curr_Factors:  [100.42351459]
mat_Sqrt:  [[0.15]]
grads:  [0.1499428]
Stock Position:  0.14994279891340975
Bond Position:  [-17.7719541]


portfolio before change:  [-2.66323876]
curr_Stock_Price:  100.77060209203077
curr_Factors:  [100.77060209]
mat_Sqrt:  [[0.15]]
grads:  [-0.03863499]
Stock Position:  -0.038634985069782524
Bond Position:  [1.23003195]


portfolio before change:  [-2.66247333]
curr_Stock_Price:  100.75278016003642
curr_Factors:  [100.75278016]
mat_Sqrt:  [[0.15]]
grads:  [-0.09908875]
Stock Position:  -0.0990887465910474
Bond Position:  [7.32099338]


portfolio before change:  [-2.66640229]
curr_Stock_Price:  100.79704894676121
curr_Factors:  [100.79704895]
mat_Sqrt:  [[0.15]]
grads:  [0.15354702]
Stock Position:  0.1535470196718567
Bond Position:  [-18.14348875]


portfolio before change:  [-2.65048976]
curr_Stock_Price:  100.90806728634517
curr_Factors:  [100.90806729]
mat_Sqrt:  [[0.15]]
grads:  [0.0185466]
Stock Position:  0.018546598010715176
Bond Position:  [-4.52199112]


portfolio before change:  [-2.658112]
curr_Stock_Price:  100.51232849043546
curr_Factors:  [100.51232849]
mat_Sqrt:  [[0.15]]
grads:  [-0.05151659]
Stock Position:  -0.05151658901214804
Bond Position:  [2.51994032]


portfolio before change:  [-2.70892862]
curr_Stock_Price:  101.50179849866045
curr_Factors:  [101.5017985]
mat_Sqrt:  [[0.15]]
grads:  [-0.03023811]
Stock Position:  -0.030238111879215986
Bond Position:  [0.36029412]


portfolio before change:  [-2.71568929]
curr_Stock_Price:  101.72612436092646
curr_Factors:  [101.72612436]
mat_Sqrt:  [[0.15]]
grads:  [0.08232728]
Stock Position:  0.08232727976517513
Bond Position:  [-11.09052439]


portfolio before change:  [-2.76300078]
curr_Stock_Price:  101.15986838248487
curr_Factors:  [101.15986838]
mat_Sqrt:  [[0.15]]
grads:  [-0.04116749]
Stock Position:  -0.041167492106884945
Bond Position:  [1.4014973]


portfolio before change:  [-2.71602237]
curr_Stock_Price:  100.02084307276274
curr_Factors:  [100.02084307]
mat_Sqrt:  [[0.15]]
grads:  [-0.10171983]
Stock Position:  -0.10171983300331014
Bond Position:  [7.45808108]


portfolio before change:  [-2.71261619]
curr_Stock_Price:  99.99193980358827
curr_Factors:  [99.9919398]
mat_Sqrt:  [[0.15]]
grads:  [-0.04535358]
Stock Position:  -0.045353583525349274
Bond Position:  [1.8223766]


portfolio before change:  [-2.69669238]
curr_Stock_Price:  99.6433476231146
curr_Factors:  [99.64334762]
mat_Sqrt:  [[0.15]]
grads:  [0.3164951]
Stock Position:  0.31649509791745434
Bond Position:  [-34.23332345]


portfolio before change:  [-2.73338298]
curr_Stock_Price:  99.53418020750534
curr_Factors:  [99.53418021]
mat_Sqrt:  [[0.15]]
grads:  [-0.05837197]
Stock Position:  -0.05837196607057273
Bond Position:  [3.07662281]


portfolio before change:  [-2.74544177]
curr_Stock_Price:  99.74405965728162
curr_Factors:  [99.74405966]
mat_Sqrt:  [[0.15]]
grads:  [0.01913485]
Stock Position:  0.01913484712210739
Bond Position:  [-4.6540291]


portfolio before change:  [-2.7577431]
curr_Stock_Price:  99.11638528551762
curr_Factors:  [99.11638529]
mat_Sqrt:  [[0.15]]
grads:  [0.03604711]
Stock Position:  0.03604710527413281
Bond Position:  [-6.33060188]


portfolio before change:  [-2.7528879]
curr_Stock_Price:  99.26205233584142
curr_Factors:  [99.26205234]
mat_Sqrt:  [[0.15]]
grads:  [0.03788373]
Stock Position:  0.03788373105986731
Bond Position:  [-6.5133048]


portfolio before change:  [-2.76010034]
curr_Stock_Price:  99.08241470815301
curr_Factors:  [99.08241471]
mat_Sqrt:  [[0.15]]
grads:  [-0.0228125]
Stock Position:  -0.022812500082389893
Bond Position:  [-0.49978275]


portfolio before change:  [-2.73677385]
curr_Stock_Price:  98.05851416522148
curr_Factors:  [98.05851417]
mat_Sqrt:  [[0.15]]
grads:  [0.05103732]
Stock Position:  0.05103731893219227
Bond Position:  [-7.74141751]


portfolio before change:  [-2.70968256]
curr_Stock_Price:  98.59880793795354
curr_Factors:  [98.59880794]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232388]
Stock Position:  -0.002323878559175351
Bond Position:  [-2.4805509]


portfolio before change:  [-2.71079943]
curr_Stock_Price:  99.01269893372269
curr_Factors:  [99.01269893]
mat_Sqrt:  [[0.15]]
grads:  [0.0103074]
Stock Position:  0.010307404420877297
Bond Position:  [-3.73136336]


portfolio before change:  [-2.71272044]
curr_Stock_Price:  98.84895322550835
curr_Factors:  [98.84895323]
mat_Sqrt:  [[0.15]]
grads:  [0.01192462]
Stock Position:  0.011924616538027677
Bond Position:  [-3.8914563]


portfolio before change:  [-2.6981515]
curr_Stock_Price:  100.0911029607578
curr_Factors:  [100.09110296]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-3.29926526]


portfolio before change:  [-2.69844514]
curr_Stock_Price:  100.07654523845035
curr_Factors:  [100.07654524]
mat_Sqrt:  [[0.15]]
grads:  [-0.08120776]
Stock Position:  -0.08120775947382113
Bond Position:  [5.42854687]


portfolio before change:  [-2.74789362]
curr_Stock_Price:  100.68963656468942
curr_Factors:  [100.68963656]
mat_Sqrt:  [[0.15]]
grads:  [-0.05394025]
Stock Position:  -0.05394024738891619
Bond Position:  [2.68333029]


portfolio before change:  [-2.73986596]
curr_Stock_Price:  100.54392077888733
curr_Factors:  [100.54392078]
mat_Sqrt:  [[0.15]]
grads:  [-0.09351904]
Stock Position:  -0.09351904452415416
Bond Position:  [6.66290544]


portfolio before change:  [-2.75806547]
curr_Stock_Price:  100.74298138369544
curr_Factors:  [100.74298138]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674193]
Stock Position:  -0.04674193204330407
Bond Position:  [1.95085611]


portfolio before change:  [-2.74826861]
curr_Stock_Price:  100.53599529710785
curr_Factors:  [100.5359953]
mat_Sqrt:  [[0.15]]
grads:  [0.01159444]
Stock Position:  0.011594438290438807
Bond Position:  [-3.91392701]


portfolio before change:  [-2.74044891]
curr_Stock_Price:  101.23152963995577
curr_Factors:  [101.23152964]
mat_Sqrt:  [[0.15]]
grads:  [-0.03686719]
Stock Position:  -0.036867189479706554
Bond Position:  [0.99167307]


portfolio before change:  [-2.73447286]
curr_Stock_Price:  101.0711142172647
curr_Factors:  [101.07111422]
mat_Sqrt:  [[0.15]]
grads:  [0.13091184]
Stock Position:  0.13091184414102036
Bond Position:  [-15.96587882]


portfolio before change:  [-2.82200804]
curr_Stock_Price:  100.41007943992764
curr_Factors:  [100.41007944]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499222]
Stock Position:  -0.05499222105073864
Bond Position:  [2.69976524]


portfolio before change:  [-2.80544969]
curr_Stock_Price:  100.11204435106168
curr_Factors:  [100.11204435]
mat_Sqrt:  [[0.15]]
grads:  [0.04849361]
Stock Position:  0.048493609920745646
Bond Position:  [-7.66024412]


portfolio before change:  [-2.76591762]
curr_Stock_Price:  100.93711907767236
curr_Factors:  [100.93711908]
mat_Sqrt:  [[0.15]]
grads:  [-0.07283894]
Stock Position:  -0.07283894409573019
Bond Position:  [4.58623555]


portfolio before change:  [-2.7989853]
curr_Stock_Price:  101.39503798772243
curr_Factors:  [101.39503799]
mat_Sqrt:  [[0.15]]
grads:  [0.07608669]
Stock Position:  0.07608669100819618
Bond Position:  [-10.51379823]


portfolio before change:  [-2.8150953]
curr_Stock_Price:  101.19194245734757
curr_Factors:  [101.19194246]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404093]
Stock Position:  -0.04404093480383091
Bond Position:  [1.64149244]


portfolio before change:  [-2.83695241]
curr_Stock_Price:  101.690562696575
curr_Factors:  [101.6905627]
mat_Sqrt:  [[0.15]]
grads:  [0.12665617]
Stock Position:  0.12665616507786098
Bond Position:  [-15.7166891]


portfolio before change:  [-2.80972126]
curr_Stock_Price:  101.91331909054863
curr_Factors:  [101.91331909]
mat_Sqrt:  [[0.15]]
grads:  [-0.14985961]
Stock Position:  -0.14985961400204434
Bond Position:  [12.4629694]


portfolio before change:  [-2.76746285]
curr_Stock_Price:  101.63653036499562
curr_Factors:  [101.63653036]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071963]
Stock Position:  -0.02071962676058132
Bond Position:  [-0.66159187]


portfolio before change:  [-2.7617727]
curr_Stock_Price:  101.35990877427533
curr_Factors:  [101.35990877]
mat_Sqrt:  [[0.15]]
grads:  [-0.06718457]
Stock Position:  -0.06718457057585878
Bond Position:  [4.04804924]


portfolio before change:  [-2.77598284]
curr_Stock_Price:  101.5751836518379
curr_Factors:  [101.57518365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062248]
Stock Position:  -0.010622475490712657
Bond Position:  [-1.69700294]


portfolio before change:  [-2.78644735]
curr_Stock_Price:  102.55032736109291
curr_Factors:  [102.55032736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.78644735]
Stock Price:  102.17007583474606
PL:  [-4.95652318]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.28272822e-04]
 [ 1.58147270e-04]
 [-2.38940781e-03]
 [ 6.15525946e-03]
 [ 4.44867512e-03]
 [ 1.64717140e-02]
 [ 3.30873055e-03]
 [-2.75766356e-02]
 [-9.47853042e-03]
 [ 2.75380079e-02]
 [ 1.51907128e-02]
 [ 7.54416979e-03]
 [-1.23283604e-02]
 [ 9.58272560e-03]
 [-6.91330173e-03]
 [ 1.62595618e-02]
 [ 8.96589330e-03]
 [-1.15287839e-02]
 [ 9.53765035e-04]
 [-3.09825188e-03]
 [ 1.33020492e-02]
 [-4.42631609e-03]
 [ 7.28981530e-03]
 [ 4.47333037e-02]
 [-1.32887266e-03]
 [ 8.45222615e-03]
 [-7.07746776e-03]
 [ 6.25487851e-03]
 [ 8.73839072e-03]
 [-2.18507291e-03]
 [ 4.91023495e-03]
 [-1.13706897e-02]
 [-1.25736719e-04]
 [ 7.08171400e-03]
 [ 1.14944361e-02]
 [ 8.49324712e-03]
 [-3.35180739e-02]
 [ 9.65015900e-03]
 [-4.77576913e-04]
 [ 1.98710345e-02]
 [-4.22811933e-03]
 [-1.78871755e-02]
 [ 2.06327097e-02]
 [-1.85470694e-03]
 [ 5.26745236e-06]
 [-7.76015238e-03]
 [ 1.22319112e-02]
 [-2.24371618e-03]
 [-1.10647204e-02]
 [-7.63715000e-03]
 [ 1.34816902e-02]
 [-5.90463214e-03]
 [-2.34533859e-03]
 [ 5.57817513e-03]
 [-3.54319120e-03]
 [ 7.10954437e-03]
 [ 1.07025474e-02]
 [ 1.01046648e-03]
 [ 1.93539300e-03]
 [ 5.92209237e-03]
 [ 1.07179055e-02]
 [ 3.05265419e-02]
 [ 2.59365134e-03]
 [-1.25217075e-02]
 [ 9.52713784e-03]
 [ 4.00597298e-03]
 [-5.21945162e-03]
 [ 1.53123261e-02]
 [-8.42697558e-03]
 [-6.09861507e-03]
 [-1.24165897e-02]
 [ 1.36330038e-02]
 [-5.67040594e-03]
 [ 2.34261073e-02]
 [-2.40753265e-02]
 [ 6.12545709e-04]
 [-5.52187462e-03]
 [-6.40949732e-03]
 [ 3.05377655e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.45308575]
curr_Stock_Price:  100.15680827321765
curr_Factors:  [100.15680827]
mat_Sqrt:  [[0.15]]
grads:  [0.00552182]
Stock Position:  0.005521818810716809
Bond Position:  [3.900038]


portfolio before change:  [4.45783806]
curr_Stock_Price:  100.97330619363028
curr_Factors:  [100.97330619]
mat_Sqrt:  [[0.15]]
grads:  [0.00105432]
Stock Position:  0.0010543151309256311
Bond Position:  [4.35138038]


portfolio before change:  [4.45765128]
curr_Stock_Price:  100.53819204104366
curr_Factors:  [100.53819204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592939]
Stock Position:  -0.015929385367100795
Bond Position:  [6.05916289]


portfolio before change:  [4.45796648]
curr_Stock_Price:  100.54217926703154
curr_Factors:  [100.54217927]
mat_Sqrt:  [[0.15]]
grads:  [0.04103506]
Stock Position:  0.04103506307528335
Bond Position:  [0.33221181]


portfolio before change:  [4.43148923]
curr_Stock_Price:  99.89643851432564
curr_Factors:  [99.89643851]
mat_Sqrt:  [[0.15]]
grads:  [0.02965783]
Stock Position:  0.02965783414880383
Bond Position:  [1.46877722]


portfolio before change:  [4.39810519]
curr_Stock_Price:  98.76770345681629
curr_Factors:  [98.76770346]
mat_Sqrt:  [[0.15]]
grads:  [0.10981143]
Stock Position:  0.10981142684613648
Bond Position:  [-6.44771725]


portfolio before change:  [4.32103869]
curr_Stock_Price:  98.06956566568151
curr_Factors:  [98.06956567]
mat_Sqrt:  [[0.15]]
grads:  [0.0220582]
Stock Position:  0.022058203691699436
Bond Position:  [2.15780024]


portfolio before change:  [4.30509928]
curr_Stock_Price:  97.3408445949349
curr_Factors:  [97.34084459]
mat_Sqrt:  [[0.15]]
grads:  [-0.18384424]
Stock Position:  -0.1838442371046106
Bond Position:  [22.20065259]


portfolio before change:  [4.1536584]
curr_Stock_Price:  98.17213782183124
curr_Factors:  [98.17213782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0631902]
Stock Position:  -0.06319020281517408
Bond Position:  [10.3571757]


portfolio before change:  [4.16155791]
curr_Stock_Price:  98.05737049298338
curr_Factors:  [98.05737049]
mat_Sqrt:  [[0.15]]
grads:  [0.18358672]
Stock Position:  0.18358671951895206
Bond Position:  [-13.84047306]


portfolio before change:  [4.34479947]
curr_Stock_Price:  99.06020238139328
curr_Factors:  [99.06020238]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-5.68716773]


portfolio before change:  [4.3876095]
curr_Stock_Price:  99.48643806849081
curr_Factors:  [99.48643807]
mat_Sqrt:  [[0.15]]
grads:  [0.05029447]
Stock Position:  0.05029446529925088
Bond Position:  [-0.6160077]


portfolio before change:  [4.38206239]
curr_Stock_Price:  99.37691095878421
curr_Factors:  [99.37691096]
mat_Sqrt:  [[0.15]]
grads:  [-0.08218907]
Stock Position:  -0.08218906924615811
Bond Position:  [12.54975821]


portfolio before change:  [4.34929356]
curr_Stock_Price:  99.78515520566368
curr_Factors:  [99.78515521]
mat_Sqrt:  [[0.15]]
grads:  [0.06388484]
Stock Position:  0.06388483736565372
Bond Position:  [-2.02546485]


portfolio before change:  [4.34448364]
curr_Stock_Price:  99.71184629469002
curr_Factors:  [99.71184629]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608868]
Stock Position:  -0.04608867822076718
Bond Position:  [8.94007084]


portfolio before change:  [4.30552997]
curr_Stock_Price:  100.56915980930978
curr_Factors:  [100.56915981]
mat_Sqrt:  [[0.15]]
grads:  [0.10839708]
Stock Position:  0.10839707866583513
Bond Position:  [-6.59587316]


portfolio before change:  [4.29727351]
curr_Stock_Price:  100.49679439560597
curr_Factors:  [100.4967944]
mat_Sqrt:  [[0.15]]
grads:  [0.05977262]
Stock Position:  0.059772621967041015
Bond Position:  [-1.70968339]


portfolio before change:  [4.33428962]
curr_Stock_Price:  101.11786414620421
curr_Factors:  [101.11786415]
mat_Sqrt:  [[0.15]]
grads:  [-0.07685856]
Stock Position:  -0.0768585595257907
Bond Position:  [12.106063]


portfolio before change:  [4.29802139]
curr_Stock_Price:  101.59959171127129
curr_Factors:  [101.59959171]
mat_Sqrt:  [[0.15]]
grads:  [0.00635843]
Stock Position:  0.006358433567841641
Bond Position:  [3.65200713]


portfolio before change:  [4.29592097]
curr_Stock_Price:  101.23335796453021
curr_Factors:  [101.23335796]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065501]
Stock Position:  -0.020655012500663962
Bond Position:  [6.38689725]


portfolio before change:  [4.29004904]
curr_Stock_Price:  101.53697050657914
curr_Factors:  [101.53697051]
mat_Sqrt:  [[0.15]]
grads:  [0.08868033]
Stock Position:  0.08868032803762448
Bond Position:  [-4.71428281]


portfolio before change:  [4.25911611]
curr_Stock_Price:  101.19147915642587
curr_Factors:  [101.19147916]
mat_Sqrt:  [[0.15]]
grads:  [-0.02950877]
Stock Position:  -0.029508773957170675
Bond Position:  [7.24515259]


portfolio before change:  [4.26275996]
curr_Stock_Price:  101.0833411660369
curr_Factors:  [101.08334117]
mat_Sqrt:  [[0.15]]
grads:  [0.04859877]
Stock Position:  0.0485987686768911
Bond Position:  [-0.64976595]


portfolio before change:  [4.23171628]
curr_Stock_Price:  100.44540166958915
curr_Factors:  [100.44540167]
mat_Sqrt:  [[0.15]]
grads:  [0.29822202]
Stock Position:  0.2982220246572797
Bond Position:  [-25.72331478]


portfolio before change:  [4.18802047]
curr_Stock_Price:  100.30427176603709
curr_Factors:  [100.30427177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00885915]
Stock Position:  -0.008859151041250186
Bond Position:  [5.07663117]


portfolio before change:  [4.19335725]
curr_Stock_Price:  99.7376848246145
curr_Factors:  [99.73768482]
mat_Sqrt:  [[0.15]]
grads:  [0.05634817]
Stock Position:  0.05634817432443293
Bond Position:  [-1.4266792]


portfolio before change:  [4.21640862]
curr_Stock_Price:  100.14835543268703
curr_Factors:  [100.14835543]
mat_Sqrt:  [[0.15]]
grads:  [-0.04718312]
Stock Position:  -0.04718311837244454
Bond Position:  [8.94172033]


portfolio before change:  [4.19984218]
curr_Stock_Price:  100.51130973642437
curr_Factors:  [100.51130974]
mat_Sqrt:  [[0.15]]
grads:  [0.04169919]
Stock Position:  0.04169919005116463
Bond Position:  [0.00860197]


portfolio before change:  [4.2089913]
curr_Stock_Price:  100.73070443924422
curr_Factors:  [100.73070444]
mat_Sqrt:  [[0.15]]
grads:  [0.05825594]
Stock Position:  0.058255938141824226
Bond Position:  [-1.65917039]


portfolio before change:  [4.2428681]
curr_Stock_Price:  101.31400123181348
curr_Factors:  [101.31400123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01456715]
Stock Position:  -0.014567152720843645
Bond Position:  [5.71872463]


portfolio before change:  [4.25721202]
curr_Stock_Price:  100.3538624013998
curr_Factors:  [100.3538624]
mat_Sqrt:  [[0.15]]
grads:  [0.0327349]
Stock Position:  0.03273489964275494
Bond Position:  [0.9721384]


portfolio before change:  [4.24477833]
curr_Stock_Price:  99.97217653339754
curr_Factors:  [99.97217653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0758046]
Stock Position:  -0.07580459809981895
Bond Position:  [11.82312899]


portfolio before change:  [4.27235005]
curr_Stock_Price:  99.61820391376091
curr_Factors:  [99.61820391]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083824]
Stock Position:  -0.0008382447962445357
Bond Position:  [4.35585449]


portfolio before change:  [4.27164935]
curr_Stock_Price:  100.77890500158956
curr_Factors:  [100.778905]
mat_Sqrt:  [[0.15]]
grads:  [0.04721143]
Stock Position:  0.04721142669962444
Bond Position:  [-0.48626654]


portfolio before change:  [4.28094956]
curr_Stock_Price:  100.97653943504467
curr_Factors:  [100.97653944]
mat_Sqrt:  [[0.15]]
grads:  [0.07662957]
Stock Position:  0.07662957403582808
Bond Position:  [-3.45683964]


portfolio before change:  [4.34716891]
curr_Stock_Price:  101.84350769514889
curr_Factors:  [101.8435077]
mat_Sqrt:  [[0.15]]
grads:  [0.05662165]
Stock Position:  0.05662164743844334
Bond Position:  [-1.41937828]


portfolio before change:  [4.36187564]
curr_Stock_Price:  102.10481138318097
curr_Factors:  [102.10481138]
mat_Sqrt:  [[0.15]]
grads:  [-0.22345383]
Stock Position:  -0.22345382600406824
Bond Position:  [27.1775864]


portfolio before change:  [4.5416111]
curr_Stock_Price:  101.30806153034636
curr_Factors:  [101.30806153]
mat_Sqrt:  [[0.15]]
grads:  [0.06433439]
Stock Position:  0.06433439334018441
Bond Position:  [-1.97598158]


portfolio before change:  [4.51838014]
curr_Stock_Price:  100.94888420546947
curr_Factors:  [100.94888421]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318385]
Stock Position:  -0.003183846089023744
Bond Position:  [4.83978585]


portfolio before change:  [4.51474457]
curr_Stock_Price:  102.18577476704404
curr_Factors:  [102.18577477]
mat_Sqrt:  [[0.15]]
grads:  [0.13247356]
Stock Position:  0.13247356324539414
Bond Position:  [-9.02216913]


portfolio before change:  [4.63192387]
curr_Stock_Price:  103.07458009798525
curr_Factors:  [103.0745801]
mat_Sqrt:  [[0.15]]
grads:  [-0.02818746]
Stock Position:  -0.028187462167672137
Bond Position:  [7.5373347]


portfolio before change:  [4.61730332]
curr_Stock_Price:  103.60998283882817
curr_Factors:  [103.60998284]
mat_Sqrt:  [[0.15]]
grads:  [-0.11924784]
Stock Position:  -0.11924783639182389
Bond Position:  [16.97256961]


portfolio before change:  [4.59823201]
curr_Stock_Price:  103.77880883350609
curr_Factors:  [103.77880883]
mat_Sqrt:  [[0.15]]
grads:  [0.1375514]
Stock Position:  0.13755139786767642
Bond Position:  [-9.67668822]


portfolio before change:  [4.55928822]
curr_Stock_Price:  103.50008411455958
curr_Factors:  [103.50008411]
mat_Sqrt:  [[0.15]]
grads:  [-0.01236471]
Stock Position:  -0.012364712954313732
Bond Position:  [5.83903705]


portfolio before change:  [4.56832216]
curr_Stock_Price:  102.79897693579117
curr_Factors:  [102.79897694]
mat_Sqrt:  [[0.15]]
grads:  [3.51163491e-05]
Stock Position:  3.511634909715393e-05
Bond Position:  [4.56471224]


portfolio before change:  [4.56857153]
curr_Stock_Price:  101.77554742946454
curr_Factors:  [101.77554743]
mat_Sqrt:  [[0.15]]
grads:  [-0.05173435]
Stock Position:  -0.05173434920329855
Bond Position:  [9.83386324]


portfolio before change:  [4.5739602]
curr_Stock_Price:  101.68326764246494
curr_Factors:  [101.68326764]
mat_Sqrt:  [[0.15]]
grads:  [0.08154607]
Stock Position:  0.08154607491073239
Bond Position:  [-3.71791116]


portfolio before change:  [4.58500556]
curr_Stock_Price:  101.82156665891276
curr_Factors:  [101.82156666]
mat_Sqrt:  [[0.15]]
grads:  [-0.01495811]
Stock Position:  -0.014958107844070534
Bond Position:  [6.10806354]


portfolio before change:  [4.60001001]
curr_Stock_Price:  100.84399077346262
curr_Factors:  [100.84399077]
mat_Sqrt:  [[0.15]]
grads:  [-0.0737648]
Stock Position:  -0.07376480257419787
Bond Position:  [12.03874708]


portfolio before change:  [4.6152286]
curr_Stock_Price:  100.6478790680833
curr_Factors:  [100.64787907]
mat_Sqrt:  [[0.15]]
grads:  [-0.05091433]
Stock Position:  -0.050914333365668196
Bond Position:  [9.73964827]


portfolio before change:  [4.59338814]
curr_Stock_Price:  101.08880028878745
curr_Factors:  [101.08880029]
mat_Sqrt:  [[0.15]]
grads:  [0.08987793]
Stock Position:  0.08987793473401201
Bond Position:  [-4.49226446]


portfolio before change:  [4.59346774]
curr_Stock_Price:  101.09280995131547
curr_Factors:  [101.09280995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03936421]
Stock Position:  -0.03936421424902828
Bond Position:  [8.57290677]


portfolio before change:  [4.58473018]
curr_Stock_Price:  101.32838900022873
curr_Factors:  [101.328389]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563559]
Stock Position:  -0.015635590578903336
Bond Position:  [6.16905939]


portfolio before change:  [4.56623698]
curr_Stock_Price:  102.53581233447242
curr_Factors:  [102.53581233]
mat_Sqrt:  [[0.15]]
grads:  [0.03718783]
Stock Position:  0.037187834185334376
Bond Position:  [0.7531522]


portfolio before change:  [4.56935439]
curr_Stock_Price:  102.61837519285721
curr_Factors:  [102.61837519]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362127]
Stock Position:  -0.02362127467832991
Bond Position:  [6.99333122]


portfolio before change:  [4.5556448]
curr_Stock_Price:  103.21727140014379
curr_Factors:  [103.2172714]
mat_Sqrt:  [[0.15]]
grads:  [0.04739696]
Stock Position:  0.047396962441093794
Bond Position:  [-0.33654034]


portfolio before change:  [4.6048825]
curr_Stock_Price:  104.25655185548392
curr_Factors:  [104.25655186]
mat_Sqrt:  [[0.15]]
grads:  [0.07135032]
Stock Position:  0.07135031630232855
Bond Position:  [-2.83385545]


portfolio before change:  [4.67001077]
curr_Stock_Price:  105.17183011671831
curr_Factors:  [105.17183012]
mat_Sqrt:  [[0.15]]
grads:  [0.00673644]
Stock Position:  0.006736443198543994
Bond Position:  [3.96152671]


portfolio before change:  [4.67675417]
curr_Stock_Price:  106.13610700768763
curr_Factors:  [106.13610701]
mat_Sqrt:  [[0.15]]
grads:  [0.01290262]
Stock Position:  0.012902620008294802
Bond Position:  [3.30732031]


portfolio before change:  [4.67235306]
curr_Stock_Price:  105.77898411488178
curr_Factors:  [105.77898411]
mat_Sqrt:  [[0.15]]
grads:  [0.03948062]
Stock Position:  0.03948061582527638
Bond Position:  [0.49613363]


portfolio before change:  [4.63229231]
curr_Stock_Price:  104.76350452085723
curr_Factors:  [104.76350452]
mat_Sqrt:  [[0.15]]
grads:  [0.0714527]
Stock Position:  0.07145270334401806
Bond Position:  [-2.8533433]


portfolio before change:  [4.64294031]
curr_Stock_Price:  104.91502204922108
curr_Factors:  [104.91502205]
mat_Sqrt:  [[0.15]]
grads:  [0.20351028]
Stock Position:  0.20351027917167142
Bond Position:  [-16.70834512]


portfolio before change:  [4.55078198]
curr_Stock_Price:  104.46730990174929
curr_Factors:  [104.4673099]
mat_Sqrt:  [[0.15]]
grads:  [0.01729101]
Stock Position:  0.01729100892445218
Bond Position:  [2.74443679]


portfolio before change:  [4.54014741]
curr_Stock_Price:  103.84235479893022
curr_Factors:  [103.8423548]
mat_Sqrt:  [[0.15]]
grads:  [-0.08347805]
Stock Position:  -0.0834780497667972
Bond Position:  [13.20870467]


portfolio before change:  [4.51581332]
curr_Stock_Price:  104.1437473021325
curr_Factors:  [104.1437473]
mat_Sqrt:  [[0.15]]
grads:  [0.06351425]
Stock Position:  0.06351425224973681
Bond Position:  [-2.09879892]


portfolio before change:  [4.52835973]
curr_Stock_Price:  104.34334962188368
curr_Factors:  [104.34334962]
mat_Sqrt:  [[0.15]]
grads:  [0.02670649]
Stock Position:  0.02670648655454943
Bond Position:  [1.74171547]


portfolio before change:  [4.55015698]
curr_Stock_Price:  105.15545123821384
curr_Factors:  [105.15545124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03479634]
Stock Position:  -0.03479634411974856
Bond Position:  [8.20918224]


portfolio before change:  [4.58064025]
curr_Stock_Price:  104.29414867662481
curr_Factors:  [104.29414868]
mat_Sqrt:  [[0.15]]
grads:  [0.10208217]
Stock Position:  0.10208217379578831
Bond Position:  [-6.06593317]


portfolio before change:  [4.53090983]
curr_Stock_Price:  103.81070207964243
curr_Factors:  [103.81070208]
mat_Sqrt:  [[0.15]]
grads:  [-0.05617984]
Stock Position:  -0.056179837204200944
Bond Position:  [10.36297818]


portfolio before change:  [4.49233787]
curr_Stock_Price:  104.5088114137314
curr_Factors:  [104.50881141]
mat_Sqrt:  [[0.15]]
grads:  [-0.04065743]
Stock Position:  -0.04065743383012205
Bond Position:  [8.74139796]


portfolio before change:  [4.48941177]
curr_Stock_Price:  104.59421911466463
curr_Factors:  [104.59421911]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277726]
Stock Position:  -0.08277726498962085
Bond Position:  [13.14743516]


portfolio before change:  [4.50382945]
curr_Stock_Price:  104.42997178685111
curr_Factors:  [104.42997179]
mat_Sqrt:  [[0.15]]
grads:  [0.09088669]
Stock Position:  0.09088669172939631
Bond Position:  [-4.9874652]


portfolio before change:  [4.51724912]
curr_Stock_Price:  104.58105432717315
curr_Factors:  [104.58105433]
mat_Sqrt:  [[0.15]]
grads:  [-0.03780271]
Stock Position:  -0.03780270623349352
Bond Position:  [8.47069599]


portfolio before change:  [4.55648693]
curr_Stock_Price:  103.55709643762356
curr_Factors:  [103.55709644]
mat_Sqrt:  [[0.15]]
grads:  [0.15617405]
Stock Position:  0.15617404866391993
Bond Position:  [-11.61644409]


portfolio before change:  [4.62304356]
curr_Stock_Price:  103.98791496718367
curr_Factors:  [103.98791497]
mat_Sqrt:  [[0.15]]
grads:  [-0.16050218]
Stock Position:  -0.1605021767290243
Bond Position:  [21.31333026]


portfolio before change:  [4.59933219]
curr_Stock_Price:  104.14394707749514
curr_Factors:  [104.14394708]
mat_Sqrt:  [[0.15]]
grads:  [0.00408364]
Stock Position:  0.004083638062491799
Bond Position:  [4.174046]


portfolio before change:  [4.59811932]
curr_Stock_Price:  103.78305476198595
curr_Factors:  [103.78305476]
mat_Sqrt:  [[0.15]]
grads:  [-0.0368125]
Stock Position:  -0.036812497481463646
Bond Position:  [8.41863276]


portfolio before change:  [4.60883257]
curr_Stock_Price:  103.50632622448634
curr_Factors:  [103.50632622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04272998]
Stock Position:  -0.04272998215524993
Bond Position:  [9.03165604]


portfolio before change:  [4.64061327]
curr_Stock_Price:  102.7757805875864
curr_Factors:  [102.77578059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.64061327]
Stock Price:  103.86139177863767
PL:  [0.77922149]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.71331575e-03]
 [-1.16932161e-02]
 [ 1.67512264e-04]
 [ 8.50931735e-03]
 [ 4.38976077e-03]
 [ 2.56421020e-02]
 [ 6.89395712e-04]
 [-1.75710888e-02]
 [ 7.92341497e-03]
 [-2.40285168e-03]
 [ 1.30467016e-02]
 [-7.09148884e-03]
 [ 7.38990661e-04]
 [ 1.11307183e-03]
 [-6.90319399e-03]
 [ 1.94326992e-02]
 [ 1.05360982e-02]
 [-1.09928529e-02]
 [-6.46764244e-04]
 [-5.53779016e-03]
 [ 1.21112306e-02]
 [-8.01052933e-03]
 [ 7.91043419e-03]
 [ 2.90076457e-02]
 [-5.94976155e-03]
 [ 2.06972705e-03]
 [-7.23373312e-03]
 [ 6.42426894e-03]
 [-6.20415612e-03]
 [-3.20475272e-03]
 [ 4.79054596e-03]
 [-1.21270241e-02]
 [ 4.68306163e-03]
 [ 6.41958207e-03]
 [ 1.14669926e-02]
 [ 1.18670238e-02]
 [-3.44714090e-02]
 [ 9.69398125e-03]
 [-1.09054997e-04]
 [ 1.68340199e-02]
 [-5.39111300e-03]
 [-1.65837750e-02]
 [ 2.25238417e-02]
 [ 2.39055068e-03]
 [-6.89341319e-03]
 [-9.68514395e-03]
 [ 1.24863607e-02]
 [ 2.93114878e-04]
 [-6.50020758e-03]
 [-7.60188207e-03]
 [ 2.13925608e-02]
 [-7.81606396e-03]
 [ 1.03337347e-03]
 [ 5.41649793e-03]
 [ 5.79820334e-03]
 [-3.43559964e-03]
 [ 6.67557859e-03]
 [-3.16589230e-04]
 [ 1.59399729e-03]
 [ 1.53889892e-02]
 [-2.61969735e-03]
 [ 1.16323310e-02]
 [-1.67215486e-03]
 [-1.23494663e-02]
 [ 5.70222647e-04]
 [ 2.37564680e-04]
 [-5.50000744e-03]
 [ 1.72378194e-02]
 [-8.34563075e-03]
 [ 8.73433310e-03]
 [-1.07078091e-02]
 [ 1.14795824e-02]
 [-1.60760015e-03]
 [ 2.10050521e-02]
 [-2.31079642e-02]
 [ 1.38904063e-04]
 [-2.15440149e-03]
 [-1.37786405e-02]
 [ 2.55830393e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.47253735]
curr_Stock_Price:  99.57641999801811
curr_Factors:  [99.57642]
mat_Sqrt:  [[0.15]]
grads:  [0.02475544]
Stock Position:  0.024755438343951004
Bond Position:  [-6.93759528]


portfolio before change:  [-4.48322088]
curr_Stock_Price:  99.16237303871551
curr_Factors:  [99.16237304]
mat_Sqrt:  [[0.15]]
grads:  [-0.07795477]
Stock Position:  -0.07795477427234727
Bond Position:  [3.24695953]


portfolio before change:  [-4.53429849]
curr_Stock_Price:  99.82019737550033
curr_Factors:  [99.82019738]
mat_Sqrt:  [[0.15]]
grads:  [0.00111675]
Stock Position:  0.0011167484252032462
Bond Position:  [-4.64577254]


portfolio before change:  [-4.53492241]
curr_Stock_Price:  99.52151638345788
curr_Factors:  [99.52151638]
mat_Sqrt:  [[0.15]]
grads:  [0.05672878]
Stock Position:  0.05672878232071581
Bond Position:  [-10.18065685]


portfolio before change:  [-4.51343376]
curr_Stock_Price:  99.91152936673102
curr_Factors:  [99.91152937]
mat_Sqrt:  [[0.15]]
grads:  [0.02926507]
Stock Position:  0.029265071781531597
Bond Position:  [-7.43735184]


portfolio before change:  [-4.50433513]
curr_Stock_Price:  100.23831750657492
curr_Factors:  [100.23831751]
mat_Sqrt:  [[0.15]]
grads:  [0.17094735]
Stock Position:  0.17094734685669916
Bond Position:  [-21.63980956]


portfolio before change:  [-4.58965985]
curr_Stock_Price:  99.74710079056614
curr_Factors:  [99.74710079]
mat_Sqrt:  [[0.15]]
grads:  [0.00459597]
Stock Position:  0.004595971412393363
Bond Position:  [-5.04809468]


portfolio before change:  [-4.59189055]
curr_Stock_Price:  99.33039162575757
curr_Factors:  [99.33039163]
mat_Sqrt:  [[0.15]]
grads:  [-0.11714059]
Stock Position:  -0.11714059188544915
Bond Position:  [7.04373031]


portfolio before change:  [-4.57879852]
curr_Stock_Price:  99.22238648065712
curr_Factors:  [99.22238648]
mat_Sqrt:  [[0.15]]
grads:  [0.05282277]
Stock Position:  0.052822766459655036
Bond Position:  [-9.81999947]


portfolio before change:  [-4.54671712]
curr_Stock_Price:  99.84134627286967
curr_Factors:  [99.84134627]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601901]
Stock Position:  -0.016019011210529985
Bond Position:  [-2.94735747]


portfolio before change:  [-4.54860604]
curr_Stock_Price:  99.94776360988932
curr_Factors:  [99.94776361]
mat_Sqrt:  [[0.15]]
grads:  [0.08697801]
Stock Position:  0.08697801097687466
Bond Position:  [-13.24186372]


portfolio before change:  [-4.5495019]
curr_Stock_Price:  99.94697926786304
curr_Factors:  [99.94697927]
mat_Sqrt:  [[0.15]]
grads:  [-0.04727659]
Stock Position:  -0.047276592271015425
Bond Position:  [0.17565069]


portfolio before change:  [-4.55771174]
curr_Stock_Price:  100.12086703165497
curr_Factors:  [100.12086703]
mat_Sqrt:  [[0.15]]
grads:  [0.0049266]
Stock Position:  0.004926604409271201
Bond Position:  [-5.05096765]


portfolio before change:  [-4.55498575]
curr_Stock_Price:  100.73826723166209
curr_Factors:  [100.73826723]
mat_Sqrt:  [[0.15]]
grads:  [0.00742048]
Stock Position:  0.007420478849136896
Bond Position:  [-5.30251193]


portfolio before change:  [-4.551182]
curr_Stock_Price:  101.29553097165207
curr_Factors:  [101.29553097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602129]
Stock Position:  -0.04602129329501776
Bond Position:  [0.11056934]


portfolio before change:  [-4.54131939]
curr_Stock_Price:  101.0813756963516
curr_Factors:  [101.0813757]
mat_Sqrt:  [[0.15]]
grads:  [0.12955133]
Stock Position:  0.12955132782923046
Bond Position:  [-17.63654583]


portfolio before change:  [-4.52839893]
curr_Stock_Price:  101.18961677771118
curr_Factors:  [101.18961678]
mat_Sqrt:  [[0.15]]
grads:  [0.07024065]
Stock Position:  0.07024065481763679
Bond Position:  [-11.63602388]


portfolio before change:  [-4.509448]
curr_Stock_Price:  101.46977093784554
curr_Factors:  [101.46977094]
mat_Sqrt:  [[0.15]]
grads:  [-0.07328569]
Stock Position:  -0.07328568609609665
Bond Position:  [2.92683379]


portfolio before change:  [-4.47776561]
curr_Stock_Price:  101.03995369314129
curr_Factors:  [101.03995369]
mat_Sqrt:  [[0.15]]
grads:  [-0.00431176]
Stock Position:  -0.004311761626146609
Bond Position:  [-4.04210542]


portfolio before change:  [-4.47993271]
curr_Stock_Price:  101.48396154804406
curr_Factors:  [101.48396155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0369186]
Stock Position:  -0.036918601094343466
Bond Position:  [-0.73328681]


portfolio before change:  [-4.45330857]
curr_Stock_Price:  100.76156220726138
curr_Factors:  [100.76156221]
mat_Sqrt:  [[0.15]]
grads:  [0.08074154]
Stock Position:  0.08074153734740719
Bond Position:  [-12.588952]


portfolio before change:  [-4.54648956]
curr_Stock_Price:  99.61724214235657
curr_Factors:  [99.61724214]
mat_Sqrt:  [[0.15]]
grads:  [-0.05340353]
Stock Position:  -0.05340352888722237
Bond Position:  [0.77342271]


portfolio before change:  [-4.52676301]
curr_Stock_Price:  99.24876072774804
curr_Factors:  [99.24876073]
mat_Sqrt:  [[0.15]]
grads:  [0.05273623]
Stock Position:  0.05273622793208757
Bond Position:  [-9.76076828]


portfolio before change:  [-4.52769129]
curr_Stock_Price:  99.24272679252616
curr_Factors:  [99.24272679]
mat_Sqrt:  [[0.15]]
grads:  [0.1933843]
Stock Position:  0.19338430434898524
Bond Position:  [-23.71967697]


portfolio before change:  [-4.47298423]
curr_Stock_Price:  99.53328594208153
curr_Factors:  [99.53328594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03966508]
Stock Position:  -0.03966507700458959
Bond Position:  [-0.52498878]


portfolio before change:  [-4.46644384]
curr_Stock_Price:  99.367568190678
curr_Factors:  [99.36756819]
mat_Sqrt:  [[0.15]]
grads:  [0.01379818]
Stock Position:  0.013798180347861337
Bond Position:  [-5.83753547]


portfolio before change:  [-4.45943506]
curr_Stock_Price:  99.9019599255496
curr_Factors:  [99.90195993]
mat_Sqrt:  [[0.15]]
grads:  [-0.04822489]
Stock Position:  -0.048224887479929895
Bond Position:  [0.35832571]


portfolio before change:  [-4.49305495]
curr_Stock_Price:  100.5995724356167
curr_Factors:  [100.59957244]
mat_Sqrt:  [[0.15]]
grads:  [0.04282846]
Stock Position:  0.04282845958872425
Bond Position:  [-8.80157967]


portfolio before change:  [-4.52496431]
curr_Stock_Price:  99.86736664822187
curr_Factors:  [99.86736665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136104]
Stock Position:  -0.041361040805788535
Bond Position:  [-0.39434609]


portfolio before change:  [-4.54948465]
curr_Stock_Price:  100.45960723791329
curr_Factors:  [100.45960724]
mat_Sqrt:  [[0.15]]
grads:  [-0.02136502]
Stock Position:  -0.021365018155483907
Bond Position:  [-2.40316332]


portfolio before change:  [-4.54689521]
curr_Stock_Price:  100.33137712395138
curr_Factors:  [100.33137712]
mat_Sqrt:  [[0.15]]
grads:  [0.03193697]
Stock Position:  0.03193697308128195
Bond Position:  [-7.7511757]


portfolio before change:  [-4.53923606]
curr_Stock_Price:  100.58636721167144
curr_Factors:  [100.58636721]
mat_Sqrt:  [[0.15]]
grads:  [-0.08084683]
Stock Position:  -0.08084682711764292
Bond Position:  [3.59285258]


portfolio before change:  [-4.52173834]
curr_Stock_Price:  100.37271420952497
curr_Factors:  [100.37271421]
mat_Sqrt:  [[0.15]]
grads:  [0.03122041]
Stock Position:  0.031220410860782467
Bond Position:  [-7.65541571]


portfolio before change:  [-4.52001158]
curr_Stock_Price:  100.44334847766574
curr_Factors:  [100.44334848]
mat_Sqrt:  [[0.15]]
grads:  [0.04279721]
Stock Position:  0.04279721379768387
Bond Position:  [-8.81870704]


portfolio before change:  [-4.51987343]
curr_Stock_Price:  100.45945566219233
curr_Factors:  [100.45945566]
mat_Sqrt:  [[0.15]]
grads:  [0.07644662]
Stock Position:  0.07644661737587487
Bond Position:  [-12.199659]


portfolio before change:  [-4.54897289]
curr_Stock_Price:  100.08877920416934
curr_Factors:  [100.0887792]
mat_Sqrt:  [[0.15]]
grads:  [0.07911349]
Stock Position:  0.0791134919664553
Bond Position:  [-12.46734572]


portfolio before change:  [-4.53459236]
curr_Stock_Price:  100.28039964029685
curr_Factors:  [100.28039964]
mat_Sqrt:  [[0.15]]
grads:  [-0.22980939]
Stock Position:  -0.2298093934643723
Bond Position:  [18.51078545]


portfolio before change:  [-4.5011622]
curr_Stock_Price:  100.13996499287059
curr_Factors:  [100.13996499]
mat_Sqrt:  [[0.15]]
grads:  [0.06462654]
Stock Position:  0.06462654168632985
Bond Position:  [-10.97286182]


portfolio before change:  [-4.44622525]
curr_Stock_Price:  101.0006450857952
curr_Factors:  [101.00064509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00072703]
Stock Position:  -0.0007270333160284508
Bond Position:  [-4.37279442]


portfolio before change:  [-4.44674551]
curr_Stock_Price:  101.3403175360762
curr_Factors:  [101.34031754]
mat_Sqrt:  [[0.15]]
grads:  [0.1122268]
Stock Position:  0.11222679918196454
Bond Position:  [-15.81984498]


portfolio before change:  [-4.41613409]
curr_Stock_Price:  101.62189188924143
curr_Factors:  [101.62189189]
mat_Sqrt:  [[0.15]]
grads:  [-0.03594075]
Stock Position:  -0.035940753317478445
Bond Position:  [-0.76376675]


portfolio before change:  [-4.39495819]
curr_Stock_Price:  101.03137440822685
curr_Factors:  [101.03137441]
mat_Sqrt:  [[0.15]]
grads:  [-0.1105585]
Stock Position:  -0.11055850017985441
Bond Position:  [6.77491904]


portfolio before change:  [-4.41616997]
curr_Stock_Price:  101.22706470293392
curr_Factors:  [101.2270647]
mat_Sqrt:  [[0.15]]
grads:  [0.15015894]
Stock Position:  0.15015894459672163
Bond Position:  [-19.61631917]


portfolio before change:  [-4.4360348]
curr_Stock_Price:  101.10293775697636
curr_Factors:  [101.10293776]
mat_Sqrt:  [[0.15]]
grads:  [0.015937]
Stock Position:  0.015937004531474445
Bond Position:  [-6.04731277]


portfolio before change:  [-4.43526963]
curr_Stock_Price:  101.17466602959216
curr_Factors:  [101.17466603]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595609]
Stock Position:  -0.04595608794267919
Bond Position:  [0.21432222]


portfolio before change:  [-4.47141918]
curr_Stock_Price:  101.96156806910878
curr_Factors:  [101.96156807]
mat_Sqrt:  [[0.15]]
grads:  [-0.06456763]
Stock Position:  -0.06456762630006245
Bond Position:  [2.11199725]


portfolio before change:  [-4.45932665]
curr_Stock_Price:  101.77632788842726
curr_Factors:  [101.77632789]
mat_Sqrt:  [[0.15]]
grads:  [0.0832424]
Stock Position:  0.08324240441311063
Bond Position:  [-12.9314329]


portfolio before change:  [-4.41911895]
curr_Stock_Price:  102.269056843492
curr_Factors:  [102.26905684]
mat_Sqrt:  [[0.15]]
grads:  [0.0019541]
Stock Position:  0.0019540991846973546
Bond Position:  [-4.61896283]


portfolio before change:  [-4.42047472]
curr_Stock_Price:  101.72298568603155
curr_Factors:  [101.72298569]
mat_Sqrt:  [[0.15]]
grads:  [-0.04333472]
Stock Position:  -0.04333471718339494
Bond Position:  [-0.0123379]


portfolio before change:  [-4.40578227]
curr_Stock_Price:  101.38392207772453
curr_Factors:  [101.38392208]
mat_Sqrt:  [[0.15]]
grads:  [-0.05067921]
Stock Position:  -0.05067921379700351
Bond Position:  [0.7322752]


portfolio before change:  [-4.38201035]
curr_Stock_Price:  100.91575879680367
curr_Factors:  [100.9157588]
mat_Sqrt:  [[0.15]]
grads:  [0.14261707]
Stock Position:  0.14261707197897372
Bond Position:  [-18.77432039]


portfolio before change:  [-4.41514777]
curr_Stock_Price:  100.69163421617567
curr_Factors:  [100.69163422]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210709]
Stock Position:  -0.05210709304195945
Bond Position:  [0.83160058]


portfolio before change:  [-4.4044637]
curr_Stock_Price:  100.48759102624796
curr_Factors:  [100.48759103]
mat_Sqrt:  [[0.15]]
grads:  [0.00688916]
Stock Position:  0.006889156434408585
Bond Position:  [-5.09673843]


portfolio before change:  [-4.4087913]
curr_Stock_Price:  99.9056560933621
curr_Factors:  [99.90565609]
mat_Sqrt:  [[0.15]]
grads:  [0.03610999]
Stock Position:  0.036109986206532246
Bond Position:  [-8.01638316]


portfolio before change:  [-4.41958921]
curr_Stock_Price:  99.62050290508735
curr_Factors:  [99.62050291]
mat_Sqrt:  [[0.15]]
grads:  [0.03865469]
Stock Position:  0.03865468890086326
Bond Position:  [-8.27038876]


portfolio before change:  [-4.43158189]
curr_Stock_Price:  99.3236239914407
curr_Factors:  [99.32362399]
mat_Sqrt:  [[0.15]]
grads:  [-0.022904]
Stock Position:  -0.022903997624528032
Bond Position:  [-2.15667384]


portfolio before change:  [-4.43469249]
curr_Stock_Price:  99.45354906542447
curr_Factors:  [99.45354907]
mat_Sqrt:  [[0.15]]
grads:  [0.04450386]
Stock Position:  0.04450385724953165
Bond Position:  [-8.86075904]


portfolio before change:  [-4.3863241]
curr_Stock_Price:  100.55282930583839
curr_Factors:  [100.55282931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00211059]
Stock Position:  -0.0021105948680160856
Bond Position:  [-4.17409781]


portfolio before change:  [-4.38831959]
curr_Stock_Price:  101.37468619999979
curr_Factors:  [101.3746862]
mat_Sqrt:  [[0.15]]
grads:  [0.01062665]
Stock Position:  0.010626648631847662
Bond Position:  [-5.46559276]


portfolio before change:  [-4.38072044]
curr_Stock_Price:  102.12193642402787
curr_Factors:  [102.12193642]
mat_Sqrt:  [[0.15]]
grads:  [0.10259326]
Stock Position:  0.10259326114137081
Bond Position:  [-14.85774293]


portfolio before change:  [-4.33664358]
curr_Stock_Price:  102.56061528062268
curr_Factors:  [102.56061528]
mat_Sqrt:  [[0.15]]
grads:  [-0.01746465]
Stock Position:  -0.01746464898474499
Bond Position:  [-2.54545843]


portfolio before change:  [-4.33507629]
curr_Stock_Price:  102.46176481085847
curr_Factors:  [102.46176481]
mat_Sqrt:  [[0.15]]
grads:  [0.07754887]
Stock Position:  0.07754887302341874
Bond Position:  [-12.28087068]


portfolio before change:  [-4.35297728]
curr_Stock_Price:  102.24082783624802
curr_Factors:  [102.24082784]
mat_Sqrt:  [[0.15]]
grads:  [-0.0111477]
Stock Position:  -0.011147699095206664
Bond Position:  [-3.21322729]


portfolio before change:  [-4.35402237]
curr_Stock_Price:  102.31656145025028
curr_Factors:  [102.31656145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08232978]
Stock Position:  -0.08232977531026811
Bond Position:  [4.06967715]


portfolio before change:  [-4.3565394]
curr_Stock_Price:  102.35022356540625
curr_Factors:  [102.35022357]
mat_Sqrt:  [[0.15]]
grads:  [0.00380148]
Stock Position:  0.0038014843145725797
Bond Position:  [-4.74562217]


portfolio before change:  [-4.35842193]
curr_Stock_Price:  101.93303842042515
curr_Factors:  [101.93303842]
mat_Sqrt:  [[0.15]]
grads:  [0.00158376]
Stock Position:  0.0015837645328246424
Bond Position:  [-4.51985986]


portfolio before change:  [-4.35894988]
curr_Stock_Price:  101.77806398964923
curr_Factors:  [101.77806399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03666672]
Stock Position:  -0.03666671623881369
Bond Position:  [-0.62708248]


portfolio before change:  [-4.34927084]
curr_Stock_Price:  101.5130216538433
curr_Factors:  [101.51302165]
mat_Sqrt:  [[0.15]]
grads:  [0.1149188]
Stock Position:  0.11491879614109966
Bond Position:  [-16.01502508]


portfolio before change:  [-4.31543337]
curr_Stock_Price:  101.81617867712978
curr_Factors:  [101.81617868]
mat_Sqrt:  [[0.15]]
grads:  [-0.05563754]
Stock Position:  -0.05563753831061117
Bond Position:  [1.34936817]


portfolio before change:  [-4.25826341]
curr_Stock_Price:  100.7901516751049
curr_Factors:  [100.79015168]
mat_Sqrt:  [[0.15]]
grads:  [0.05822889]
Stock Position:  0.058228887359720975
Bond Position:  [-10.1271618]


portfolio before change:  [-4.26084757]
curr_Stock_Price:  100.75664262883214
curr_Factors:  [100.75664263]
mat_Sqrt:  [[0.15]]
grads:  [-0.07138539]
Stock Position:  -0.07138539388244691
Bond Position:  [2.93170505]


portfolio before change:  [-4.31214835]
curr_Stock_Price:  101.47785478622286
curr_Factors:  [101.47785479]
mat_Sqrt:  [[0.15]]
grads:  [0.07653055]
Stock Position:  0.07653054946572448
Bond Position:  [-12.07830434]


portfolio before change:  [-4.2828561]
curr_Stock_Price:  101.87047147984686
curr_Factors:  [101.87047148]
mat_Sqrt:  [[0.15]]
grads:  [-0.01071733]
Stock Position:  -0.010717334320249614
Bond Position:  [-3.1910762]


portfolio before change:  [-4.29007889]
curr_Stock_Price:  102.52579711302793
curr_Factors:  [102.52579711]
mat_Sqrt:  [[0.15]]
grads:  [0.14003368]
Stock Position:  0.14003368073284087
Bond Position:  [-18.64714363]


portfolio before change:  [-4.16505563]
curr_Stock_Price:  103.42692846159524
curr_Factors:  [103.42692846]
mat_Sqrt:  [[0.15]]
grads:  [-0.15405309]
Stock Position:  -0.15405309476436507
Bond Position:  [11.76818278]


portfolio before change:  [-4.226703]
curr_Stock_Price:  103.83187262781888
curr_Factors:  [103.83187263]
mat_Sqrt:  [[0.15]]
grads:  [0.00092603]
Stock Position:  0.0009260270883404479
Bond Position:  [-4.32285413]


portfolio before change:  [-4.22639573]
curr_Stock_Price:  104.45546333401816
curr_Factors:  [104.45546333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01436268]
Stock Position:  -0.014362676571849486
Bond Position:  [-2.72613569]


portfolio before change:  [-4.25107728]
curr_Stock_Price:  106.1620506722823
curr_Factors:  [106.16205067]
mat_Sqrt:  [[0.15]]
grads:  [-0.0918576]
Stock Position:  -0.09185760342078511
Bond Position:  [5.50071427]


portfolio before change:  [-4.20514991]
curr_Stock_Price:  105.66580907350968
curr_Factors:  [105.66580907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.20514991]
Stock Price:  105.83380736184257
PL:  [-10.03895727]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.26913839e-03]
 [ 1.17890382e-03]
 [ 3.94664117e-04]
 [ 8.45902749e-03]
 [ 4.67394953e-03]
 [ 2.13168740e-02]
 [ 1.66947062e-03]
 [-1.66540145e-02]
 [ 2.18926519e-02]
 [-3.87579337e-03]
 [ 1.51921382e-02]
 [-3.37440159e-02]
 [ 3.32114843e-02]
 [ 4.36294740e-03]
 [-6.89852403e-03]
 [ 1.95032100e-02]
 [ 8.79687427e-03]
 [-1.22351954e-02]
 [-6.32392418e-04]
 [-6.57982198e-04]
 [ 1.15699640e-02]
 [-6.73678927e-03]
 [ 6.87958164e-03]
 [ 1.38585335e-02]
 [ 2.21743763e-03]
 [ 7.21238995e-03]
 [-4.97301434e-03]
 [ 1.47990369e-02]
 [ 4.93619046e-02]
 [ 3.18309214e-03]
 [ 1.78511922e-02]
 [-2.74200204e-03]
 [ 1.77003353e-03]
 [ 8.46848830e-03]
 [ 1.08587062e-02]
 [ 8.52995183e-03]
 [-3.37354809e-02]
 [ 9.51285640e-03]
 [ 4.66552941e-03]
 [ 1.55023629e-02]
 [-5.17852018e-03]
 [-2.17462398e-02]
 [ 2.24484958e-02]
 [ 2.03874084e-04]
 [-5.15649034e-03]
 [-1.70286381e-03]
 [ 1.15271335e-02]
 [-5.81581095e-03]
 [-1.27179589e-02]
 [-7.60667967e-03]
 [ 2.16517880e-02]
 [-7.27621145e-03]
 [ 2.86038918e-03]
 [ 5.42533651e-03]
 [ 5.50792113e-03]
 [-2.87833314e-03]
 [ 6.59411764e-03]
 [-8.61895658e-05]
 [ 1.55535432e-03]
 [-7.25809745e-03]
 [ 9.00849938e-04]
 [-1.14980659e-02]
 [-4.99617449e-03]
 [-1.39192045e-02]
 [-1.12006488e-02]
 [ 1.74804220e-03]
 [-5.16385137e-03]
 [ 2.44109387e-02]
 [-8.32382431e-03]
 [ 6.33798934e-03]
 [-5.97081597e-03]
 [ 1.13682213e-02]
 [ 7.00474345e-04]
 [ 3.90127155e-03]
 [-9.42921592e-03]
 [-9.93509289e-03]
 [ 1.42720031e-03]
 [ 2.47852984e-03]
 [-7.04124965e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.51949217]
curr_Stock_Price:  99.70341668094788
curr_Factors:  [99.70341668]
mat_Sqrt:  [[0.15]]
grads:  [0.02179426]
Stock Position:  0.021794255903382055
Bond Position:  [-4.69245395]


portfolio before change:  [-2.51719542]
curr_Stock_Price:  99.82225704148524
curr_Factors:  [99.82225704]
mat_Sqrt:  [[0.15]]
grads:  [0.00785936]
Stock Position:  0.007859358805862611
Bond Position:  [-3.30173435]


portfolio before change:  [-2.51685325]
curr_Stock_Price:  99.89205034784273
curr_Factors:  [99.89205035]
mat_Sqrt:  [[0.15]]
grads:  [0.00263109]
Stock Position:  0.002631094110666354
Bond Position:  [-2.77967864]


portfolio before change:  [-2.51763904]
curr_Stock_Price:  99.65942792945513
curr_Factors:  [99.65942793]
mat_Sqrt:  [[0.15]]
grads:  [0.05639352]
Stock Position:  0.05639351656882598
Bond Position:  [-8.13778464]


portfolio before change:  [-2.49492854]
curr_Stock_Price:  100.07116194079282
curr_Factors:  [100.07116194]
mat_Sqrt:  [[0.15]]
grads:  [0.03115966]
Stock Position:  0.031159663565186343
Bond Position:  [-5.61311228]


portfolio before change:  [-2.51185408]
curr_Stock_Price:  99.53923364486396
curr_Factors:  [99.53923364]
mat_Sqrt:  [[0.15]]
grads:  [0.14211249]
Stock Position:  0.14211249344268426
Bond Position:  [-16.65762276]


portfolio before change:  [-2.42676159]
curr_Stock_Price:  100.14532830255968
curr_Factors:  [100.1453283]
mat_Sqrt:  [[0.15]]
grads:  [0.0111298]
Stock Position:  0.011129804147442399
Bond Position:  [-3.54135948]


portfolio before change:  [-2.42757531]
curr_Stock_Price:  100.09210307084702
curr_Factors:  [100.09210307]
mat_Sqrt:  [[0.15]]
grads:  [-0.11102676]
Stock Position:  -0.1110267630527725
Bond Position:  [8.6853269]


portfolio before change:  [-2.44339477]
curr_Stock_Price:  100.23947565893789
curr_Factors:  [100.23947566]
mat_Sqrt:  [[0.15]]
grads:  [0.14595101]
Stock Position:  0.14595101265629856
Bond Position:  [-17.07344775]


portfolio before change:  [-2.40512687]
curr_Stock_Price:  100.50898405285777
curr_Factors:  [100.50898405]
mat_Sqrt:  [[0.15]]
grads:  [-0.02583862]
Stock Position:  -0.02583862247234402
Bond Position:  [0.19188683]


portfolio before change:  [-2.40448127]
curr_Stock_Price:  100.48446241089482
curr_Factors:  [100.48446241]
mat_Sqrt:  [[0.15]]
grads:  [0.10128092]
Stock Position:  0.10128092151024808
Bond Position:  [-12.58164022]


portfolio before change:  [-2.35352502]
curr_Stock_Price:  100.99534468839926
curr_Factors:  [100.99534469]
mat_Sqrt:  [[0.15]]
grads:  [-0.22496011]
Stock Position:  -0.22496010576888492
Bond Position:  [20.36639841]


portfolio before change:  [-2.40098667]
curr_Stock_Price:  101.21198130227441
curr_Factors:  [101.2119813]
mat_Sqrt:  [[0.15]]
grads:  [0.2214099]
Stock Position:  0.22140989502775854
Bond Position:  [-24.81032083]


portfolio before change:  [-2.34212047]
curr_Stock_Price:  101.4848548073686
curr_Factors:  [101.48485481]
mat_Sqrt:  [[0.15]]
grads:  [0.02908632]
Stock Position:  0.02908631597467028
Bond Position:  [-5.29394103]


portfolio before change:  [-2.33368917]
curr_Stock_Price:  101.78610248459982
curr_Factors:  [101.78610248]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599016]
Stock Position:  -0.04599016017008947
Bond Position:  [2.34746999]


portfolio before change:  [-2.30178414]
curr_Stock_Price:  101.095556866614
curr_Factors:  [101.09555687]
mat_Sqrt:  [[0.15]]
grads:  [0.1300214]
Stock Position:  0.13002139988445274
Bond Position:  [-15.44636997]


portfolio before change:  [-2.38553107]
curr_Stock_Price:  100.45888095814675
curr_Factors:  [100.45888096]
mat_Sqrt:  [[0.15]]
grads:  [0.05864583]
Stock Position:  0.05864582844409153
Bond Position:  [-8.27702536]


portfolio before change:  [-2.39485819]
curr_Stock_Price:  100.3086606565217
curr_Factors:  [100.30866066]
mat_Sqrt:  [[0.15]]
grads:  [-0.08156797]
Stock Position:  -0.08156796947183671
Bond Position:  [5.78711558]


portfolio before change:  [-2.4474727]
curr_Stock_Price:  100.95813398066878
curr_Factors:  [100.95813398]
mat_Sqrt:  [[0.15]]
grads:  [-0.00421595]
Stock Position:  -0.004215949455426664
Bond Position:  [-2.02183831]


portfolio before change:  [-2.4479896]
curr_Stock_Price:  101.05076530068924
curr_Factors:  [101.0507653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438655]
Stock Position:  -0.004386547983504698
Bond Position:  [-2.00472557]


portfolio before change:  [-2.4444362]
curr_Stock_Price:  100.2121329386186
curr_Factors:  [100.21213294]
mat_Sqrt:  [[0.15]]
grads:  [0.07713309]
Stock Position:  0.0771330934202513
Bond Position:  [-10.17410801]


portfolio before change:  [-2.41661896]
curr_Stock_Price:  100.5810166443048
curr_Factors:  [100.58101664]
mat_Sqrt:  [[0.15]]
grads:  [-0.04491193]
Stock Position:  -0.04491192844194309
Bond Position:  [2.10066846]


portfolio before change:  [-2.42771002]
curr_Stock_Price:  100.83089143151237
curr_Factors:  [100.83089143]
mat_Sqrt:  [[0.15]]
grads:  [0.04586388]
Stock Position:  0.04586387759053267
Bond Position:  [-7.05220568]


portfolio before change:  [-2.40074404]
curr_Stock_Price:  101.42845879559933
curr_Factors:  [101.4284588]
mat_Sqrt:  [[0.15]]
grads:  [0.09239022]
Stock Position:  0.09239022343180622
Bond Position:  [-11.77174201]


portfolio before change:  [-2.34705477]
curr_Stock_Price:  102.01753659056402
curr_Factors:  [102.01753659]
mat_Sqrt:  [[0.15]]
grads:  [0.01478292]
Stock Position:  0.014782917566193144
Bond Position:  [-3.8551716]


portfolio before change:  [-2.33086866]
curr_Stock_Price:  103.12875623960174
curr_Factors:  [103.12875624]
mat_Sqrt:  [[0.15]]
grads:  [0.0480826]
Stock Position:  0.04808259969369905
Bond Position:  [-7.28956736]


portfolio before change:  [-2.31450668]
curr_Stock_Price:  103.47852084381846
curr_Factors:  [103.47852084]
mat_Sqrt:  [[0.15]]
grads:  [-0.03315343]
Stock Position:  -0.033153428960209015
Bond Position:  [1.11616111]


portfolio before change:  [-2.32055303]
curr_Stock_Price:  103.6630000028343
curr_Factors:  [103.663]
mat_Sqrt:  [[0.15]]
grads:  [0.09866025]
Stock Position:  0.09866024628245115
Bond Position:  [-12.54797014]


portfolio before change:  [-2.32713399]
curr_Stock_Price:  103.60424597426376
curr_Factors:  [103.60424597]
mat_Sqrt:  [[0.15]]
grads:  [0.32907936]
Stock Position:  0.32907936409803135
Bond Position:  [-36.42115338]


portfolio before change:  [-2.45350506]
curr_Stock_Price:  103.22714947265294
curr_Factors:  [103.22714947]
mat_Sqrt:  [[0.15]]
grads:  [0.02122061]
Stock Position:  0.02122061426748568
Bond Position:  [-4.64404858]


portfolio before change:  [-2.45025802]
curr_Stock_Price:  103.39384139034081
curr_Factors:  [103.39384139]
mat_Sqrt:  [[0.15]]
grads:  [0.11900795]
Stock Position:  0.11900794787461838
Bond Position:  [-14.75494691]


portfolio before change:  [-2.42888698]
curr_Stock_Price:  103.58116711451756
curr_Factors:  [103.58116711]
mat_Sqrt:  [[0.15]]
grads:  [-0.01828001]
Stock Position:  -0.01828001362566289
Bond Position:  [-0.53542184]


portfolio before change:  [-2.42080887]
curr_Stock_Price:  103.13742681654546
curr_Factors:  [103.13742682]
mat_Sqrt:  [[0.15]]
grads:  [0.01180022]
Stock Position:  0.011800223538885851
Bond Position:  [-3.63785356]


portfolio before change:  [-2.4256728]
curr_Stock_Price:  102.74450557574501
curr_Factors:  [102.74450558]
mat_Sqrt:  [[0.15]]
grads:  [0.05645659]
Stock Position:  0.05645658867320142
Bond Position:  [-8.22627709]


portfolio before change:  [-2.45625241]
curr_Stock_Price:  102.21196447385626
curr_Factors:  [102.21196447]
mat_Sqrt:  [[0.15]]
grads:  [0.07239137]
Stock Position:  0.07239137477074342
Bond Position:  [-9.85551704]


portfolio before change:  [-2.44172803]
curr_Stock_Price:  102.42111057099966
curr_Factors:  [102.42111057]
mat_Sqrt:  [[0.15]]
grads:  [0.05686635]
Stock Position:  0.05686634553087417
Bond Position:  [-8.26604229]


portfolio before change:  [-2.4844521]
curr_Stock_Price:  101.67888895115439
curr_Factors:  [101.67888895]
mat_Sqrt:  [[0.15]]
grads:  [-0.22490321]
Stock Position:  -0.22490320633131408
Bond Position:  [20.38345604]


portfolio before change:  [-2.54763848]
curr_Stock_Price:  101.96550281745218
curr_Factors:  [101.96550282]
mat_Sqrt:  [[0.15]]
grads:  [0.06341904]
Stock Position:  0.06341904266236277
Bond Position:  [-9.01419305]


portfolio before change:  [-2.55819638]
curr_Stock_Price:  101.80790817897949
curr_Factors:  [101.80790818]
mat_Sqrt:  [[0.15]]
grads:  [0.03110353]
Stock Position:  0.031103529399113816
Bond Position:  [-5.72478165]


portfolio before change:  [-2.58085228]
curr_Stock_Price:  101.09100915006059
curr_Factors:  [101.09100915]
mat_Sqrt:  [[0.15]]
grads:  [0.10334909]
Stock Position:  0.10334908610847118
Bond Position:  [-13.02851569]


portfolio before change:  [-2.5014551]
curr_Stock_Price:  101.86713108180281
curr_Factors:  [101.86713108]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452347]
Stock Position:  -0.034523467867699144
Bond Position:  [1.01535153]


portfolio before change:  [-2.50839755]
curr_Stock_Price:  102.07006314114957
curr_Factors:  [102.07006314]
mat_Sqrt:  [[0.15]]
grads:  [-0.14497493]
Stock Position:  -0.14497493194867167
Bond Position:  [12.2892029]


portfolio before change:  [-2.39188455]
curr_Stock_Price:  101.27168437721491
curr_Factors:  [101.27168438]
mat_Sqrt:  [[0.15]]
grads:  [0.14965664]
Stock Position:  0.14965663855227987
Bond Position:  [-17.54786441]


portfolio before change:  [-2.22650296]
curr_Stock_Price:  102.38408650722022
curr_Factors:  [102.38408651]
mat_Sqrt:  [[0.15]]
grads:  [0.00135916]
Stock Position:  0.0013591605628328167
Bond Position:  [-2.36565937]


portfolio before change:  [-2.22754704]
curr_Stock_Price:  101.72469113318171
curr_Factors:  [101.72469113]
mat_Sqrt:  [[0.15]]
grads:  [-0.0343766]
Stock Position:  -0.034376602242847505
Bond Position:  [1.2694022]


portfolio before change:  [-2.2117155]
curr_Stock_Price:  101.26646674716412
curr_Factors:  [101.26646675]
mat_Sqrt:  [[0.15]]
grads:  [-0.01135243]
Stock Position:  -0.011352425409953936
Bond Position:  [-1.06209549]


portfolio before change:  [-2.21310573]
curr_Stock_Price:  101.3830798964373
curr_Factors:  [101.3830799]
mat_Sqrt:  [[0.15]]
grads:  [0.07684756]
Stock Position:  0.07684755699691463
Bond Position:  [-10.00414774]


portfolio before change:  [-2.22639542]
curr_Stock_Price:  101.21828075661722
curr_Factors:  [101.21828076]
mat_Sqrt:  [[0.15]]
grads:  [-0.03877207]
Stock Position:  -0.038772072986532596
Bond Position:  [1.69804715]


portfolio before change:  [-2.19872797]
curr_Stock_Price:  100.50742596107754
curr_Factors:  [100.50742596]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478639]
Stock Position:  -0.08478639265432719
Bond Position:  [6.32293411]


portfolio before change:  [-2.27074124]
curr_Stock_Price:  101.36143637485233
curr_Factors:  [101.36143637]
mat_Sqrt:  [[0.15]]
grads:  [-0.0507112]
Stock Position:  -0.050711197793179695
Bond Position:  [2.86941861]


portfolio before change:  [-2.24768489]
curr_Stock_Price:  100.91031306614444
curr_Factors:  [100.91031307]
mat_Sqrt:  [[0.15]]
grads:  [0.14434525]
Stock Position:  0.14434525360664122
Bond Position:  [-16.81360962]


portfolio before change:  [-2.24632468]
curr_Stock_Price:  100.92701672401103
curr_Factors:  [100.92701672]
mat_Sqrt:  [[0.15]]
grads:  [-0.04850808]
Stock Position:  -0.048508076313468165
Bond Position:  [2.64945075]


portfolio before change:  [-2.18910013]
curr_Stock_Price:  99.7507391864011
curr_Factors:  [99.75073919]
mat_Sqrt:  [[0.15]]
grads:  [0.01906926]
Stock Position:  0.019069261190458674
Bond Position:  [-4.09127303]


portfolio before change:  [-2.18877752]
curr_Stock_Price:  99.78106638131588
curr_Factors:  [99.78106638]
mat_Sqrt:  [[0.15]]
grads:  [0.03616891]
Stock Position:  0.0361689100549693
Bond Position:  [-5.79774994]


portfolio before change:  [-2.17642487]
curr_Stock_Price:  100.13261190394712
curr_Factors:  [100.1326119]
mat_Sqrt:  [[0.15]]
grads:  [0.03671947]
Stock Position:  0.0367194741966074
Bond Position:  [-5.85324173]


portfolio before change:  [-2.17983304]
curr_Stock_Price:  100.04975874521064
curr_Factors:  [100.04975875]
mat_Sqrt:  [[0.15]]
grads:  [-0.01918889]
Stock Position:  -0.019188887619652255
Bond Position:  [-0.25998946]


portfolio before change:  [-2.17261736]
curr_Stock_Price:  99.67287788345352
curr_Factors:  [99.67287788]
mat_Sqrt:  [[0.15]]
grads:  [0.04396078]
Stock Position:  0.043960784275620314
Bond Position:  [-6.55431525]


portfolio before change:  [-2.17055969]
curr_Stock_Price:  99.72900365770958
curr_Factors:  [99.72900366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0005746]
Stock Position:  -0.0005745971053678885
Bond Position:  [-2.11325569]


portfolio before change:  [-2.17065175]
curr_Stock_Price:  99.65935436711067
curr_Factors:  [99.65935437]
mat_Sqrt:  [[0.15]]
grads:  [0.01036903]
Stock Position:  0.01036902877684975
Bond Position:  [-3.20402246]


portfolio before change:  [-2.16638574]
curr_Stock_Price:  100.09008566746003
curr_Factors:  [100.09008567]
mat_Sqrt:  [[0.15]]
grads:  [-0.04838732]
Stock Position:  -0.048387316343801196
Bond Position:  [2.6767049]


portfolio before change:  [-2.15694493]
curr_Stock_Price:  99.89843395818383
curr_Factors:  [99.89843396]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-2.75690158]


portfolio before change:  [-2.15747339]
curr_Stock_Price:  99.83913157598924
curr_Factors:  [99.83913158]
mat_Sqrt:  [[0.15]]
grads:  [-0.07665377]
Stock Position:  -0.07665377287840731
Bond Position:  [5.49557272]


portfolio before change:  [-2.14006126]
curr_Stock_Price:  99.61645959391888
curr_Factors:  [99.61645959]
mat_Sqrt:  [[0.15]]
grads:  [-0.03330783]
Stock Position:  -0.03330782994064404
Bond Position:  [1.17794683]


portfolio before change:  [-2.17291922]
curr_Stock_Price:  100.60516354676177
curr_Factors:  [100.60516355]
mat_Sqrt:  [[0.15]]
grads:  [-0.0927947]
Stock Position:  -0.09279469652850657
Bond Position:  [7.1627064]


portfolio before change:  [-2.101649]
curr_Stock_Price:  99.84194602916475
curr_Factors:  [99.84194603]
mat_Sqrt:  [[0.15]]
grads:  [-0.07467099]
Stock Position:  -0.07467099178108456
Bond Position:  [5.35364813]


portfolio before change:  [-2.13608881]
curr_Stock_Price:  100.30764794706536
curr_Factors:  [100.30764795]
mat_Sqrt:  [[0.15]]
grads:  [0.01165361]
Stock Position:  0.011653614640513704
Bond Position:  [-3.30503549]


portfolio before change:  [-2.14420878]
curr_Stock_Price:  99.6285966614135
curr_Factors:  [99.62859666]
mat_Sqrt:  [[0.15]]
grads:  [-0.03442568]
Stock Position:  -0.03442567578005345
Bond Position:  [1.28557298]


portfolio before change:  [-2.16071371]
curr_Stock_Price:  100.11036721744368
curr_Factors:  [100.11036722]
mat_Sqrt:  [[0.15]]
grads:  [0.16273959]
Stock Position:  0.16273959162418036
Bond Position:  [-18.45263399]


portfolio before change:  [-2.12876628]
curr_Stock_Price:  100.31376430368097
curr_Factors:  [100.3137643]
mat_Sqrt:  [[0.15]]
grads:  [-0.05549216]
Stock Position:  -0.05549216203560306
Bond Position:  [3.43786139]


portfolio before change:  [-2.02295278]
curr_Stock_Price:  98.41081760181952
curr_Factors:  [98.4108176]
mat_Sqrt:  [[0.15]]
grads:  [0.04225326]
Stock Position:  0.042253262255740394
Bond Position:  [-6.18113086]


portfolio before change:  [-2.0332885]
curr_Stock_Price:  98.1753471870014
curr_Factors:  [98.17534719]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980544]
Stock Position:  -0.039805439822857176
Bond Position:  [1.87462437]


portfolio before change:  [-2.01486149]
curr_Stock_Price:  97.71536375620009
curr_Factors:  [97.71536376]
mat_Sqrt:  [[0.15]]
grads:  [0.07578814]
Stock Position:  0.07578814194203742
Bond Position:  [-9.42052735]


portfolio before change:  [-2.08509286]
curr_Stock_Price:  96.79645266553707
curr_Factors:  [96.79645267]
mat_Sqrt:  [[0.15]]
grads:  [0.00466983]
Stock Position:  0.004669828968181538
Bond Position:  [-2.53711574]


portfolio before change:  [-2.0845483]
curr_Stock_Price:  96.94702296493315
curr_Factors:  [96.94702296]
mat_Sqrt:  [[0.15]]
grads:  [0.02600848]
Stock Position:  0.026008476988316966
Bond Position:  [-4.60599271]


portfolio before change:  [-2.07441654]
curr_Stock_Price:  97.34764755075169
curr_Factors:  [97.34764755]
mat_Sqrt:  [[0.15]]
grads:  [-0.06286144]
Stock Position:  -0.06286143948162076
Bond Position:  [4.04499671]


portfolio before change:  [-2.07934272]
curr_Stock_Price:  97.4300350876544
curr_Factors:  [97.43003509]
mat_Sqrt:  [[0.15]]
grads:  [-0.06623395]
Stock Position:  -0.06623395258124581
Bond Position:  [4.3738336]


portfolio before change:  [-2.11340106]
curr_Stock_Price:  97.9483751187565
curr_Factors:  [97.94837512]
mat_Sqrt:  [[0.15]]
grads:  [0.00951467]
Stock Position:  0.009514668737643691
Bond Position:  [-3.0453474]


portfolio before change:  [-2.11361517]
curr_Stock_Price:  97.94587639117911
curr_Factors:  [97.94587639]
mat_Sqrt:  [[0.15]]
grads:  [0.01652353]
Stock Position:  0.01652353228267521
Bond Position:  [-3.73202702]


portfolio before change:  [-2.12852395]
curr_Stock_Price:  97.05771764855042
curr_Factors:  [97.05771765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.12852395]
Stock Price:  97.15511692949175
PL:  [-2.12852395]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.39207464e-03]
 [ 5.82919302e-04]
 [-3.20097517e-03]
 [ 8.32183362e-03]
 [ 5.13330868e-03]
 [ 2.70065158e-02]
 [ 1.62231846e-03]
 [-1.55318312e-02]
 [ 2.34307483e-02]
 [-4.44864534e-03]
 [ 1.45373456e-02]
 [-1.38007676e-02]
 [ 5.70465110e-04]
 [ 3.37516304e-03]
 [-6.91527377e-03]
 [ 2.47119542e-02]
 [ 1.08756452e-02]
 [-1.03477342e-02]
 [ 7.68675092e-03]
 [-6.46186383e-03]
 [ 1.40769031e-02]
 [-1.26799947e-02]
 [ 1.10134749e-02]
 [-3.51807729e-02]
 [ 5.76555238e-03]
 [ 6.95527484e-03]
 [-5.20238121e-03]
 [ 1.43198159e-02]
 [ 5.08946206e-02]
 [ 4.67189882e-03]
 [ 1.87783081e-02]
 [-2.69409834e-03]
 [-2.64183501e-03]
 [ 8.04433588e-03]
 [ 9.73911048e-03]
 [ 4.47184794e-03]
 [-3.11302665e-02]
 [ 8.29483489e-03]
 [ 2.47716342e-02]
 [-2.43397343e-02]
 [-8.46293848e-03]
 [-1.14283850e-02]
 [ 1.97736689e-02]
 [-7.06404075e-03]
 [ 2.27476541e-02]
 [-4.00735862e-03]
 [ 1.54014150e-02]
 [ 3.01537865e-02]
 [ 1.24520222e-02]
 [-7.77597162e-03]
 [ 3.89379621e-02]
 [ 1.04355392e-02]
 [-1.10136389e-02]
 [ 5.68682237e-03]
 [-2.64842103e-02]
 [ 3.61894075e-02]
 [ 1.98780700e-02]
 [ 2.44323690e-03]
 [ 2.03948263e-03]
 [ 2.16148410e-03]
 [ 2.05418615e-02]
 [ 4.85444458e-02]
 [-6.00495272e-03]
 [-1.15959011e-02]
 [ 1.98010198e-02]
 [ 9.38611548e-03]
 [-4.47299890e-03]
 [ 1.58806706e-02]
 [-2.65923039e-02]
 [-6.00539522e-02]
 [ 5.05416846e-03]
 [ 1.88091036e-02]
 [-6.76385087e-02]
 [ 3.12455800e-02]
 [-3.11784301e-02]
 [ 1.31647901e-02]
 [ 2.18476712e-02]
 [-2.78425396e-02]
 [ 2.83057314e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.84997202]
curr_Stock_Price:  99.92251595108603
curr_Factors:  [99.92251595]
mat_Sqrt:  [[0.15]]
grads:  [0.01594716]
Stock Position:  0.015947164255967452
Bond Position:  [-0.74350876]


portfolio before change:  [0.84688736]
curr_Stock_Price:  99.73200007634395
curr_Factors:  [99.73200008]
mat_Sqrt:  [[0.15]]
grads:  [0.00388613]
Stock Position:  0.0038861286795916924
Bond Position:  [0.45931597]


portfolio before change:  [0.84402529]
curr_Stock_Price:  98.98812898225061
curr_Factors:  [98.98812898]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133983]
Stock Position:  -0.021339834462850673
Bond Position:  [2.95641557]


portfolio before change:  [0.83550957]
curr_Stock_Price:  99.39584058385543
curr_Factors:  [99.39584058]
mat_Sqrt:  [[0.15]]
grads:  [0.05547889]
Stock Position:  0.05547889078947651
Bond Position:  [-4.67886141]


portfolio before change:  [0.86998909]
curr_Stock_Price:  100.02260066690553
curr_Factors:  [100.02260067]
mat_Sqrt:  [[0.15]]
grads:  [0.03422206]
Stock Position:  0.03422205787065667
Bond Position:  [-2.55299014]


portfolio before change:  [0.88405744]
curr_Stock_Price:  100.438353488608
curr_Factors:  [100.43835349]
mat_Sqrt:  [[0.15]]
grads:  [0.18004344]
Stock Position:  0.18004343865207126
Bond Position:  [-17.1992091]


portfolio before change:  [1.0214217]
curr_Stock_Price:  101.20727487483681
curr_Factors:  [101.20727487]
mat_Sqrt:  [[0.15]]
grads:  [0.01081546]
Stock Position:  0.01081545640370082
Bond Position:  [-0.07318117]


portfolio before change:  [1.01152627]
curr_Stock_Price:  100.29276374204069
curr_Factors:  [100.29276374]
mat_Sqrt:  [[0.15]]
grads:  [-0.10354554]
Stock Position:  -0.10354554132730782
Bond Position:  [11.39639479]


portfolio before change:  [0.92842555]
curr_Stock_Price:  101.10219524631528
curr_Factors:  [101.10219525]
mat_Sqrt:  [[0.15]]
grads:  [0.15620499]
Stock Position:  0.15620498890038537
Bond Position:  [-14.86424174]


portfolio before change:  [0.8829193]
curr_Stock_Price:  100.81681889860538
curr_Factors:  [100.8168189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02965764]
Stock Position:  -0.029657635613887103
Bond Position:  [3.87290777]


portfolio before change:  [0.89627718]
curr_Stock_Price:  100.37457781871156
curr_Factors:  [100.37457782]
mat_Sqrt:  [[0.15]]
grads:  [0.09691564]
Stock Position:  0.09691563705042097
Bond Position:  [-8.83158897]


portfolio before change:  [0.88136667]
curr_Stock_Price:  100.22642299294678
curr_Factors:  [100.22642299]
mat_Sqrt:  [[0.15]]
grads:  [-0.09200512]
Stock Position:  -0.09200511750593077
Bond Position:  [10.1027105]


portfolio before change:  [0.89789034]
curr_Stock_Price:  100.05369098057572
curr_Factors:  [100.05369098]
mat_Sqrt:  [[0.15]]
grads:  [0.0038031]
Stock Position:  0.0038031007332158667
Bond Position:  [0.51737608]


portfolio before change:  [0.89841579]
curr_Stock_Price:  100.18335051701169
curr_Factors:  [100.18335052]
mat_Sqrt:  [[0.15]]
grads:  [0.02250109]
Stock Position:  0.022501086916857906
Bond Position:  [-1.35581849]


portfolio before change:  [0.90755079]
curr_Stock_Price:  100.59309726075762
curr_Factors:  [100.59309726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610183]
Stock Position:  -0.04610182511094625
Bond Position:  [5.54507617]


portfolio before change:  [0.84517844]
curr_Stock_Price:  101.95354071589179
curr_Factors:  [101.95354072]
mat_Sqrt:  [[0.15]]
grads:  [0.16474636]
Stock Position:  0.1647463613241452
Bond Position:  [-15.95129641]


portfolio before change:  [0.8333477]
curr_Stock_Price:  101.88778046366687
curr_Factors:  [101.88778046]
mat_Sqrt:  [[0.15]]
grads:  [0.0725043]
Stock Position:  0.0725043013169611
Bond Position:  [-6.55395464]


portfolio before change:  [0.84091936]
curr_Stock_Price:  101.99786079011955
curr_Factors:  [101.99786079]
mat_Sqrt:  [[0.15]]
grads:  [-0.06898489]
Stock Position:  -0.0689848949171321
Bond Position:  [7.87723107]


portfolio before change:  [0.77074959]
curr_Stock_Price:  103.02217357267112
curr_Factors:  [103.02217357]
mat_Sqrt:  [[0.15]]
grads:  [0.05124501]
Stock Position:  0.05124500611856019
Bond Position:  [-4.50862233]


portfolio before change:  [0.75719822]
curr_Stock_Price:  102.76322986650817
curr_Factors:  [102.76322987]
mat_Sqrt:  [[0.15]]
grads:  [-0.04307909]
Stock Position:  -0.04307909218231812
Bond Position:  [5.18414487]


portfolio before change:  [0.7748283]
curr_Stock_Price:  102.36150232904303
curr_Factors:  [102.36150233]
mat_Sqrt:  [[0.15]]
grads:  [0.09384602]
Stock Position:  0.09384602037676866
Bond Position:  [-8.83139134]


portfolio before change:  [0.90791996]
curr_Stock_Price:  103.78557599205377
curr_Factors:  [103.78557599]
mat_Sqrt:  [[0.15]]
grads:  [-0.0845333]
Stock Position:  -0.08453329772768063
Bond Position:  [9.68125696]


portfolio before change:  [0.94496985]
curr_Stock_Price:  103.35444659783029
curr_Factors:  [103.3544466]
mat_Sqrt:  [[0.15]]
grads:  [0.07342317]
Stock Position:  0.07342316608599851
Bond Position:  [-6.64364085]


portfolio before change:  [0.94549321]
curr_Stock_Price:  103.36723000015354
curr_Factors:  [103.36723]
mat_Sqrt:  [[0.15]]
grads:  [-0.23453849]
Stock Position:  -0.23453848594188023
Bond Position:  [25.18908683]


portfolio before change:  [1.01914635]
curr_Stock_Price:  103.05990825358835
curr_Factors:  [103.05990825]
mat_Sqrt:  [[0.15]]
grads:  [0.03843702]
Stock Position:  0.038437015856937345
Bond Position:  [-2.94216898]


portfolio before change:  [1.03638919]
curr_Stock_Price:  103.51329224466754
curr_Factors:  [103.51329224]
mat_Sqrt:  [[0.15]]
grads:  [0.0463685]
Stock Position:  0.0463684989198444
Bond Position:  [-3.76336679]


portfolio before change:  [1.01830477]
curr_Stock_Price:  103.12834974192725
curr_Factors:  [103.12834974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03468254]
Stock Position:  -0.034682541408307864
Bond Position:  [4.59505803]


portfolio before change:  [1.00421666]
curr_Stock_Price:  103.54283233480221
curr_Factors:  [103.54283233]
mat_Sqrt:  [[0.15]]
grads:  [0.09546544]
Stock Position:  0.09546543915613741
Bond Position:  [-8.8805453]


portfolio before change:  [1.02253487]
curr_Stock_Price:  103.74052968627002
curr_Factors:  [103.74052969]
mat_Sqrt:  [[0.15]]
grads:  [0.33929747]
Stock Position:  0.33929747088996653
Bond Position:  [-34.17636448]


portfolio before change:  [1.00542116]
curr_Stock_Price:  103.69638666182311
curr_Factors:  [103.69638666]
mat_Sqrt:  [[0.15]]
grads:  [0.03114599]
Stock Position:  0.031145992122170018
Bond Position:  [-2.22430568]


portfolio before change:  [1.00872882]
curr_Stock_Price:  103.80704865475039
curr_Factors:  [103.80704865]
mat_Sqrt:  [[0.15]]
grads:  [0.12518872]
Stock Position:  0.12518872042410822
Bond Position:  [-11.98674278]


portfolio before change:  [0.98056129]
curr_Stock_Price:  103.58803266305222
curr_Factors:  [103.58803266]
mat_Sqrt:  [[0.15]]
grads:  [-0.01796066]
Stock Position:  -0.017960655590908075
Bond Position:  [2.84107027]


portfolio before change:  [0.96339154]
curr_Stock_Price:  104.55388421581998
curr_Factors:  [104.55388422]
mat_Sqrt:  [[0.15]]
grads:  [-0.01761223]
Stock Position:  -0.017612233420476464
Bond Position:  [2.80481895]


portfolio before change:  [0.96886676]
curr_Stock_Price:  104.25296154463365
curr_Factors:  [104.25296154]
mat_Sqrt:  [[0.15]]
grads:  [0.05362891]
Stock Position:  0.053628905855100106
Bond Position:  [-4.6221055]


portfolio before change:  [1.01145598]
curr_Stock_Price:  105.05249515228716
curr_Factors:  [105.05249515]
mat_Sqrt:  [[0.15]]
grads:  [0.0649274]
Stock Position:  0.06492740318323094
Bond Position:  [-5.80932972]


portfolio before change:  [1.04412746]
curr_Stock_Price:  105.56128763804026
curr_Factors:  [105.56128764]
mat_Sqrt:  [[0.15]]
grads:  [0.02981232]
Stock Position:  0.029812319579088874
Bond Position:  [-2.10289938]


portfolio before change:  [1.06685538]
curr_Stock_Price:  106.32806307129486
curr_Factors:  [106.32806307]
mat_Sqrt:  [[0.15]]
grads:  [-0.20753511]
Stock Position:  -0.207535109924966
Bond Position:  [23.13366164]


portfolio before change:  [0.94240296]
curr_Stock_Price:  106.9346993103702
curr_Factors:  [106.93469931]
mat_Sqrt:  [[0.15]]
grads:  [0.0552989]
Stock Position:  0.05529889928100197
Bond Position:  [-4.9709682]


portfolio before change:  [0.96497267]
curr_Stock_Price:  107.34845797133264
curr_Factors:  [107.34845797]
mat_Sqrt:  [[0.15]]
grads:  [0.16514423]
Stock Position:  0.16514422811648186
Bond Position:  [-16.76300556]


portfolio before change:  [0.99538735]
curr_Stock_Price:  107.53897264859648
curr_Factors:  [107.53897265]
mat_Sqrt:  [[0.15]]
grads:  [-0.1622649]
Stock Position:  -0.16226489523799612
Bond Position:  [18.44518748]


portfolio before change:  [1.08837565]
curr_Stock_Price:  106.97301264466091
curr_Factors:  [106.97301264]
mat_Sqrt:  [[0.15]]
grads:  [-0.05641959]
Stock Position:  -0.0564195898643598
Bond Position:  [7.12374915]


portfolio before change:  [1.10716642]
curr_Stock_Price:  106.64785033302333
curr_Factors:  [106.64785033]
mat_Sqrt:  [[0.15]]
grads:  [-0.07618923]
Stock Position:  -0.07618923324918525
Bond Position:  [9.23258436]


portfolio before change:  [1.11900152]
curr_Stock_Price:  106.50008609081004
curr_Factors:  [106.50008609]
mat_Sqrt:  [[0.15]]
grads:  [0.13182446]
Stock Position:  0.13182445931553688
Bond Position:  [-12.92031475]


portfolio before change:  [1.10790329]
curr_Stock_Price:  106.42202251738489
curr_Factors:  [106.42202252]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470936]
Stock Position:  -0.047093604984185695
Bond Position:  [6.11969998]


portfolio before change:  [1.09956544]
curr_Stock_Price:  106.60719284389431
curr_Factors:  [106.60719284]
mat_Sqrt:  [[0.15]]
grads:  [0.15165103]
Stock Position:  0.15165102743732337
Bond Position:  [-15.06752489]


portfolio before change:  [1.19674171]
curr_Stock_Price:  107.25419157099422
curr_Factors:  [107.25419157]
mat_Sqrt:  [[0.15]]
grads:  [-0.02671572]
Stock Position:  -0.026715724111558266
Bond Position:  [4.0621151]


portfolio before change:  [1.20708714]
curr_Stock_Price:  106.87645373778365
curr_Factors:  [106.87645374]
mat_Sqrt:  [[0.15]]
grads:  [0.1026761]
Stock Position:  0.102676100126542
Bond Position:  [-9.76657032]


portfolio before change:  [1.23422073]
curr_Stock_Price:  107.14666285277315
curr_Factors:  [107.14666285]
mat_Sqrt:  [[0.15]]
grads:  [0.20102524]
Stock Position:  0.20102524354428236
Bond Position:  [-20.30496326]


portfolio before change:  [1.280628]
curr_Stock_Price:  107.38382891335051
curr_Factors:  [107.38382891]
mat_Sqrt:  [[0.15]]
grads:  [0.08301348]
Stock Position:  0.08301348101738384
Bond Position:  [-7.63367745]


portfolio before change:  [1.24972075]
curr_Stock_Price:  107.01726043423052
curr_Factors:  [107.01726043]
mat_Sqrt:  [[0.15]]
grads:  [-0.05183981]
Stock Position:  -0.05183981077780674
Bond Position:  [6.79747528]


portfolio before change:  [1.26526456]
curr_Stock_Price:  106.72561278325999
curr_Factors:  [106.72561278]
mat_Sqrt:  [[0.15]]
grads:  [0.25958641]
Stock Position:  0.2595864139418238
Bond Position:  [-26.43925453]


portfolio before change:  [1.37777199]
curr_Stock_Price:  107.16538901450136
curr_Factors:  [107.16538901]
mat_Sqrt:  [[0.15]]
grads:  [0.06957026]
Stock Position:  0.06957026155796085
Bond Position:  [-6.07775215]


portfolio before change:  [1.38777056]
curr_Stock_Price:  107.31456819363581
curr_Factors:  [107.31456819]
mat_Sqrt:  [[0.15]]
grads:  [-0.07342426]
Stock Position:  -0.07342425964578295
Bond Position:  [9.26726328]


portfolio before change:  [1.32466529]
curr_Stock_Price:  108.18191766353232
curr_Factors:  [108.18191766]
mat_Sqrt:  [[0.15]]
grads:  [0.03791215]
Stock Position:  0.03791214910006635
Bond Position:  [-2.77674371]


portfolio before change:  [1.32433616]
curr_Stock_Price:  108.17781414053464
curr_Factors:  [108.17781414]
mat_Sqrt:  [[0.15]]
grads:  [-0.1765614]
Stock Position:  -0.17656140188763486
Bond Position:  [20.42436268]


portfolio before change:  [1.42806262]
curr_Stock_Price:  107.59756331169092
curr_Factors:  [107.59756331]
mat_Sqrt:  [[0.15]]
grads:  [0.24126272]
Stock Position:  0.24126271659679205
Bond Position:  [-24.5312178]


portfolio before change:  [1.63065358]
curr_Stock_Price:  108.44362941030055
curr_Factors:  [108.44362941]
mat_Sqrt:  [[0.15]]
grads:  [0.13252047]
Stock Position:  0.13252046644991533
Bond Position:  [-12.74034677]


portfolio before change:  [1.54640672]
curr_Stock_Price:  107.81391111600833
curr_Factors:  [107.81391112]
mat_Sqrt:  [[0.15]]
grads:  [0.01628825]
Stock Position:  0.01628824602732821
Bond Position:  [-0.20969279]


portfolio before change:  [1.53965008]
curr_Stock_Price:  107.3998985695795
curr_Factors:  [107.39989857]
mat_Sqrt:  [[0.15]]
grads:  [0.01359655]
Stock Position:  0.013596550838603066
Bond Position:  [0.0793819]


portfolio before change:  [1.5297241]
curr_Stock_Price:  106.66949752629685
curr_Factors:  [106.66949753]
mat_Sqrt:  [[0.15]]
grads:  [0.01440989]
Stock Position:  0.014409893981034937
Bond Position:  [-0.00737205]


portfolio before change:  [1.54022858]
curr_Stock_Price:  107.39850642319315
curr_Factors:  [107.39850642]
mat_Sqrt:  [[0.15]]
grads:  [0.13694574]
Stock Position:  0.1369457432234515
Bond Position:  [-13.1675397]


portfolio before change:  [1.54659014]
curr_Stock_Price:  107.45096918585831
curr_Factors:  [107.45096919]
mat_Sqrt:  [[0.15]]
grads:  [0.32362964]
Stock Position:  0.3236296385085566
Bond Position:  [-33.22772818]


portfolio before change:  [1.70131732]
curr_Stock_Price:  107.9354859186077
curr_Factors:  [107.93548592]
mat_Sqrt:  [[0.15]]
grads:  [-0.04003302]
Stock Position:  -0.040033018138991364
Bond Position:  [6.02230058]


portfolio before change:  [1.6796964]
curr_Stock_Price:  108.48496548741328
curr_Factors:  [108.48496549]
mat_Sqrt:  [[0.15]]
grads:  [-0.07730601]
Stock Position:  -0.07730600711166455
Bond Position:  [10.06623591]


portfolio before change:  [1.67316476]
curr_Stock_Price:  108.57759465513382
curr_Factors:  [108.57759466]
mat_Sqrt:  [[0.15]]
grads:  [0.1320068]
Stock Position:  0.132006798385615
Bond Position:  [-12.65981588]


portfolio before change:  [1.56715568]
curr_Stock_Price:  107.78053102518876
curr_Factors:  [107.78053103]
mat_Sqrt:  [[0.15]]
grads:  [0.0625741]
Stock Position:  0.06257410316721625
Bond Position:  [-5.17711438]


portfolio before change:  [1.60997107]
curr_Stock_Price:  108.4699370225562
curr_Factors:  [108.46993702]
mat_Sqrt:  [[0.15]]
grads:  [-0.02981999]
Stock Position:  -0.02981999266924758
Bond Position:  [4.84454379]


portfolio before change:  [1.59688329]
curr_Stock_Price:  108.91898363314981
curr_Factors:  [108.91898363]
mat_Sqrt:  [[0.15]]
grads:  [0.10587114]
Stock Position:  0.10587113702686786
Bond Position:  [-9.93449335]


portfolio before change:  [1.63982283]
curr_Stock_Price:  109.33043155848529
curr_Factors:  [109.33043156]
mat_Sqrt:  [[0.15]]
grads:  [-0.17728203]
Stock Position:  -0.1772820259503829
Bond Position:  [21.02214323]


portfolio before change:  [1.60395766]
curr_Stock_Price:  109.54014879201624
curr_Factors:  [109.54014879]
mat_Sqrt:  [[0.15]]
grads:  [-0.40035968]
Stock Position:  -0.4003596810913123
Bond Position:  [45.45941669]


portfolio before change:  [1.16813142]
curr_Stock_Price:  110.6358324036888
curr_Factors:  [110.6358324]
mat_Sqrt:  [[0.15]]
grads:  [0.03369446]
Stock Position:  0.03369445638596334
Bond Position:  [-2.55968281]


portfolio before change:  [1.18760554]
curr_Stock_Price:  111.21854262945985
curr_Factors:  [111.21854263]
mat_Sqrt:  [[0.15]]
grads:  [0.12539402]
Stock Position:  0.1253940242857191
Bond Position:  [-12.7585351]


portfolio before change:  [1.3425508]
curr_Stock_Price:  112.46056910772289
curr_Factors:  [112.46056911]
mat_Sqrt:  [[0.15]]
grads:  [-0.45092339]
Stock Position:  -0.4509233911319204
Bond Position:  [52.05365199]


portfolio before change:  [0.78600937]
curr_Stock_Price:  113.7020103404443
curr_Factors:  [113.70201034]
mat_Sqrt:  [[0.15]]
grads:  [0.20830387]
Stock Position:  0.20830386672219942
Bond Position:  [-22.89855904]


portfolio before change:  [0.63602772]
curr_Stock_Price:  112.9888673516393
curr_Factors:  [112.98886735]
mat_Sqrt:  [[0.15]]
grads:  [-0.2078562]
Stock Position:  -0.20785620056912893
Bond Position:  [24.12146439]


portfolio before change:  [0.62434906]
curr_Stock_Price:  113.05230689279792
curr_Factors:  [113.05230689]
mat_Sqrt:  [[0.15]]
grads:  [0.08776527]
Stock Position:  0.08776526729172278
Bond Position:  [-9.29771688]


portfolio before change:  [0.64067529]
curr_Stock_Price:  113.24494979221261
curr_Factors:  [113.24494979]
mat_Sqrt:  [[0.15]]
grads:  [0.14565114]
Stock Position:  0.1456511410992701
Bond Position:  [-15.85358088]


portfolio before change:  [0.75006821]
curr_Stock_Price:  114.00281412545084
curr_Factors:  [114.00281413]
mat_Sqrt:  [[0.15]]
grads:  [-0.18561693]
Stock Position:  -0.18561693068518528
Bond Position:  [21.91092066]


portfolio before change:  [0.73149283]
curr_Stock_Price:  114.11026583146598
curr_Factors:  [114.11026583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73149283]
Stock Price:  114.1734851094988
PL:  [-13.44199228]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.30841402e-04]
 [ 1.82673134e-03]
 [-4.05826930e-03]
 [ 4.36889507e-03]
 [ 1.21612270e-02]
 [ 2.81542073e-02]
 [ 2.38458829e-03]
 [ 1.92175272e-03]
 [ 2.46835088e-02]
 [-4.61043573e-03]
 [ 3.68130841e-02]
 [ 6.88870016e-03]
 [ 7.49476732e-02]
 [ 6.31746267e-03]
 [-6.90470268e-03]
 [ 1.86437622e-02]
 [ 8.43765138e-03]
 [-1.09157175e-02]
 [ 2.62997899e-04]
 [-1.95432620e-03]
 [ 1.16284462e-02]
 [-6.29215789e-03]
 [ 6.82385084e-03]
 [ 2.36699979e-02]
 [ 2.00365028e-03]
 [ 1.32990898e-02]
 [-5.70583437e-03]
 [ 7.12018432e-03]
 [ 1.67272032e-02]
 [-2.06584452e-03]
 [ 1.15531962e-02]
 [-1.17489320e-02]
 [ 9.32653289e-03]
 [ 7.18518056e-03]
 [ 1.14340260e-02]
 [ 9.07686788e-03]
 [-3.38093765e-02]
 [ 9.24254986e-03]
 [ 2.27726933e-03]
 [ 2.03030642e-02]
 [-5.03013676e-03]
 [-2.05459954e-02]
 [ 2.07910361e-02]
 [-2.30913796e-03]
 [ 5.33057882e-03]
 [-1.64572987e-02]
 [ 1.52019817e-02]
 [ 1.46643548e-02]
 [ 7.01267056e-03]
 [-7.59748863e-03]
 [ 2.03369448e-02]
 [ 4.81936101e-03]
 [-1.06313713e-02]
 [ 5.84221730e-03]
 [-2.04673687e-02]
 [ 3.07116732e-02]
 [ 1.61399328e-02]
 [ 1.69319943e-03]
 [ 2.00251535e-03]
 [ 1.28232458e-03]
 [ 2.20522594e-02]
 [ 4.88198301e-02]
 [-2.45927073e-03]
 [-1.20684552e-02]
 [ 1.68162418e-02]
 [ 7.68616521e-03]
 [-4.95596758e-03]
 [ 1.57146765e-02]
 [-1.83970881e-02]
 [-3.46294959e-02]
 [-6.42083914e-03]
 [ 1.55166879e-02]
 [-2.38559493e-02]
 [ 2.73843579e-02]
 [-2.78798275e-02]
 [ 4.16481486e-03]
 [ 6.51201754e-03]
 [-1.58947065e-02]
 [ 2.31047345e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.8842089]
curr_Stock_Price:  100.31489195663193
curr_Factors:  [100.31489196]
mat_Sqrt:  [[0.15]]
grads:  [0.00153894]
Stock Position:  0.0015389426808426014
Bond Position:  [6.72983004]


portfolio before change:  [6.88530835]
curr_Stock_Price:  100.75598853438188
curr_Factors:  [100.75598853]
mat_Sqrt:  [[0.15]]
grads:  [0.01217821]
Stock Position:  0.012178208901194804
Bond Position:  [5.65828088]


portfolio before change:  [6.88751535]
curr_Stock_Price:  100.90817335292279
curr_Factors:  [100.90817335]
mat_Sqrt:  [[0.15]]
grads:  [-0.02705513]
Stock Position:  -0.027055128667517112
Bond Position:  [9.61759896]


portfolio before change:  [6.8859325]
curr_Stock_Price:  100.98889604490985
curr_Factors:  [100.98889604]
mat_Sqrt:  [[0.15]]
grads:  [0.02912597]
Stock Position:  0.029125967118653884
Bond Position:  [3.94453324]


portfolio before change:  [6.88765253]
curr_Stock_Price:  101.03948610042116
curr_Factors:  [101.0394861]
mat_Sqrt:  [[0.15]]
grads:  [0.08107485]
Stock Position:  0.08107484683286058
Bond Position:  [-1.30410833]


portfolio before change:  [6.87658494]
curr_Stock_Price:  100.90398074934147
curr_Factors:  [100.90398075]
mat_Sqrt:  [[0.15]]
grads:  [0.18769472]
Stock Position:  0.18769471563457818
Bond Position:  [-12.06255903]


portfolio before change:  [6.99857637]
curr_Stock_Price:  101.55794356064825
curr_Factors:  [101.55794356]
mat_Sqrt:  [[0.15]]
grads:  [0.01589726]
Stock Position:  0.015897255263057686
Bond Position:  [5.38408382]


portfolio before change:  [6.9970675]
curr_Stock_Price:  101.4418614528674
curr_Factors:  [101.44186145]
mat_Sqrt:  [[0.15]]
grads:  [0.01281168]
Stock Position:  0.012811684778079915
Bond Position:  [5.69742635]


portfolio before change:  [7.00049912]
curr_Stock_Price:  101.68191724286959
curr_Factors:  [101.68191724]
mat_Sqrt:  [[0.15]]
grads:  [0.16455673]
Stock Position:  0.16455672556648965
Bond Position:  [-9.73194423]


portfolio before change:  [7.03123449]
curr_Stock_Price:  101.87239037867717
curr_Factors:  [101.87239038]
mat_Sqrt:  [[0.15]]
grads:  [-0.03073624]
Stock Position:  -0.0307362382035199
Bond Position:  [10.16240855]


portfolio before change:  [7.01966042]
curr_Stock_Price:  102.26961653520709
curr_Factors:  [102.26961654]
mat_Sqrt:  [[0.15]]
grads:  [0.24542056]
Stock Position:  0.2454205604469689
Bond Position:  [-18.07940618]


portfolio before change:  [7.10229738]
curr_Stock_Price:  102.6109365752391
curr_Factors:  [102.61093658]
mat_Sqrt:  [[0.15]]
grads:  [0.04592467]
Stock Position:  0.045924667762288374
Bond Position:  [2.38992421]


portfolio before change:  [7.08721557]
curr_Stock_Price:  102.27928077412157
curr_Factors:  [102.27928077]
mat_Sqrt:  [[0.15]]
grads:  [0.49965115]
Stock Position:  0.49965115443283964
Bond Position:  [-44.01674514]


portfolio before change:  [6.82674821]
curr_Stock_Price:  101.76348844680422
curr_Factors:  [101.76348845]
mat_Sqrt:  [[0.15]]
grads:  [0.04211642]
Stock Position:  0.042116417822416534
Bond Position:  [2.54083461]


portfolio before change:  [6.80242455]
curr_Stock_Price:  101.1821839190613
curr_Factors:  [101.18218392]
mat_Sqrt:  [[0.15]]
grads:  [-0.04603135]
Stock Position:  -0.04603135120257964
Bond Position:  [11.4599772]


portfolio before change:  [6.81508502]
curr_Stock_Price:  100.9227042890323
curr_Factors:  [100.92270429]
mat_Sqrt:  [[0.15]]
grads:  [0.12429175]
Stock Position:  0.12429174817793716
Bond Position:  [-5.72877433]


portfolio before change:  [6.74706225]
curr_Stock_Price:  100.37830201745392
curr_Factors:  [100.37830202]
mat_Sqrt:  [[0.15]]
grads:  [0.05625101]
Stock Position:  0.056251009231077106
Bond Position:  [1.10068146]


portfolio before change:  [6.81073487]
curr_Stock_Price:  101.50901641391364
curr_Factors:  [101.50901641]
mat_Sqrt:  [[0.15]]
grads:  [-0.07277145]
Stock Position:  -0.07277145000940578
Bond Position:  [14.19769319]


portfolio before change:  [6.81982007]
curr_Stock_Price:  101.39636487048388
curr_Factors:  [101.39636487]
mat_Sqrt:  [[0.15]]
grads:  [0.00175332]
Stock Position:  0.001753319327507137
Bond Position:  [6.64203987]


portfolio before change:  [6.81979749]
curr_Stock_Price:  101.1467114391669
curr_Factors:  [101.14671144]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302884]
Stock Position:  -0.013028841311766907
Bond Position:  [8.13762194]


portfolio before change:  [6.83171766]
curr_Stock_Price:  100.27084316696936
curr_Factors:  [100.27084317]
mat_Sqrt:  [[0.15]]
grads:  [0.07752297]
Stock Position:  0.07752297436969237
Bond Position:  [-0.94157635]


portfolio before change:  [6.86489682]
curr_Stock_Price:  100.69959361369331
curr_Factors:  [100.69959361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04194772]
Stock Position:  -0.04194771926993856
Bond Position:  [11.0890151]


portfolio before change:  [6.87242465]
curr_Stock_Price:  100.53665865010655
curr_Factors:  [100.53665865]
mat_Sqrt:  [[0.15]]
grads:  [0.04549234]
Stock Position:  0.04549233895756732
Bond Position:  [2.2987769]


portfolio before change:  [6.89442133]
curr_Stock_Price:  101.0170253179199
curr_Factors:  [101.01702532]
mat_Sqrt:  [[0.15]]
grads:  [0.15779999]
Stock Position:  0.15779998585700908
Bond Position:  [-9.04606383]


portfolio before change:  [7.0181885]
curr_Stock_Price:  101.80493772825362
curr_Factors:  [101.80493773]
mat_Sqrt:  [[0.15]]
grads:  [0.01335767]
Stock Position:  0.013357668549700738
Bond Position:  [5.65831189]


portfolio before change:  [7.00808707]
curr_Stock_Price:  101.02223471197745
curr_Factors:  [101.02223471]
mat_Sqrt:  [[0.15]]
grads:  [0.0886606]
Stock Position:  0.08866059896468037
Bond Position:  [-1.94860477]


portfolio before change:  [7.02844118]
curr_Stock_Price:  101.25318168686151
curr_Factors:  [101.25318169]
mat_Sqrt:  [[0.15]]
grads:  [-0.0380389]
Stock Position:  -0.038038895785343675
Bond Position:  [10.8800004]


portfolio before change:  [7.04149862]
curr_Stock_Price:  100.9277932160136
curr_Factors:  [100.92779322]
mat_Sqrt:  [[0.15]]
grads:  [0.0474679]
Stock Position:  0.04746789544604813
Bond Position:  [2.25066868]


portfolio before change:  [7.06147975]
curr_Stock_Price:  101.34576972725147
curr_Factors:  [101.34576973]
mat_Sqrt:  [[0.15]]
grads:  [0.11151469]
Stock Position:  0.11151468784056802
Bond Position:  [-4.24006212]


portfolio before change:  [7.06540508]
curr_Stock_Price:  101.38334631705142
curr_Factors:  [101.38334632]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137723]
Stock Position:  -0.013772296824153055
Bond Position:  [8.46168662]


portfolio before change:  [7.06137298]
curr_Stock_Price:  101.7145167968157
curr_Factors:  [101.7145168]
mat_Sqrt:  [[0.15]]
grads:  [0.07702131]
Stock Position:  0.07702130806249186
Bond Position:  [-0.77281216]


portfolio before change:  [7.01930019]
curr_Stock_Price:  101.16889525815893
curr_Factors:  [101.16889526]
mat_Sqrt:  [[0.15]]
grads:  [-0.07832621]
Stock Position:  -0.07832621335101506
Bond Position:  [14.94347666]


portfolio before change:  [7.0257439]
curr_Stock_Price:  101.09855207100212
curr_Factors:  [101.09855207]
mat_Sqrt:  [[0.15]]
grads:  [0.06217689]
Stock Position:  0.062176885900510535
Bond Position:  [0.73975076]


portfolio before change:  [7.01018254]
curr_Stock_Price:  100.84753284174607
curr_Factors:  [100.84753284]
mat_Sqrt:  [[0.15]]
grads:  [0.0479012]
Stock Position:  0.047901203728808996
Bond Position:  [2.17946433]


portfolio before change:  [6.99994327]
curr_Stock_Price:  100.63093096984015
curr_Factors:  [100.63093097]
mat_Sqrt:  [[0.15]]
grads:  [0.07622684]
Stock Position:  0.07622683995321683
Bond Position:  [-0.6708346]


portfolio before change:  [7.03115962]
curr_Stock_Price:  101.04100014676422
curr_Factors:  [101.04100015]
mat_Sqrt:  [[0.15]]
grads:  [0.06051245]
Stock Position:  0.060512452519119284
Bond Position:  [0.9169209]


portfolio before change:  [7.06105682]
curr_Stock_Price:  101.53412002328803
curr_Factors:  [101.53412002]
mat_Sqrt:  [[0.15]]
grads:  [-0.22539584]
Stock Position:  -0.22539584353534112
Bond Position:  [29.94642545]


portfolio before change:  [6.81206617]
curr_Stock_Price:  102.64710579541416
curr_Factors:  [102.6471058]
mat_Sqrt:  [[0.15]]
grads:  [0.061617]
Stock Position:  0.06161699909633778
Bond Position:  [0.48725954]


portfolio before change:  [6.73218856]
curr_Stock_Price:  101.35025483507127
curr_Factors:  [101.35025484]
mat_Sqrt:  [[0.15]]
grads:  [0.0151818]
Stock Position:  0.015181795557145846
Bond Position:  [5.19350971]


portfolio before change:  [6.74241934]
curr_Stock_Price:  102.00275879821737
curr_Factors:  [102.0027588]
mat_Sqrt:  [[0.15]]
grads:  [0.13535376]
Stock Position:  0.13535376159979517
Bond Position:  [-7.06403775]


portfolio before change:  [6.74678856]
curr_Stock_Price:  102.03830069122886
curr_Factors:  [102.03830069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03353425]
Stock Position:  -0.0335342450834038
Bond Position:  [10.16856594]


portfolio before change:  [6.73020538]
curr_Stock_Price:  102.5517676842601
curr_Factors:  [102.55176768]
mat_Sqrt:  [[0.15]]
grads:  [-0.1369733]
Stock Position:  -0.13697330247230288
Bond Position:  [20.77705968]


portfolio before change:  [6.63213078]
curr_Stock_Price:  103.27726094763537
curr_Factors:  [103.27726095]
mat_Sqrt:  [[0.15]]
grads:  [0.13860691]
Stock Position:  0.13860690734052694
Bond Position:  [-7.68281096]


portfolio before change:  [6.69806005]
curr_Stock_Price:  103.75638178140944
curr_Factors:  [103.75638178]
mat_Sqrt:  [[0.15]]
grads:  [-0.01539425]
Stock Position:  -0.01539425309728364
Bond Position:  [8.29531205]


portfolio before change:  [6.69940241]
curr_Stock_Price:  103.70286257688916
curr_Factors:  [103.70286258]
mat_Sqrt:  [[0.15]]
grads:  [0.03553719]
Stock Position:  0.035537192163530754
Bond Position:  [3.01409386]


portfolio before change:  [6.69808158]
curr_Stock_Price:  103.66039399896853
curr_Factors:  [103.660394]
mat_Sqrt:  [[0.15]]
grads:  [-0.10971532]
Stock Position:  -0.10971532447888649
Bond Position:  [18.07121535]


portfolio before change:  [6.60736905]
curr_Stock_Price:  104.49748784895584
curr_Factors:  [104.49748785]
mat_Sqrt:  [[0.15]]
grads:  [0.10134654]
Stock Position:  0.10134654459349668
Bond Position:  [-3.98309027]


portfolio before change:  [6.6251841]
curr_Stock_Price:  104.67572784915721
curr_Factors:  [104.67572785]
mat_Sqrt:  [[0.15]]
grads:  [0.09776237]
Stock Position:  0.09776236520977413
Bond Position:  [-3.60816263]


portfolio before change:  [6.65408129]
curr_Stock_Price:  104.97362069129625
curr_Factors:  [104.97362069]
mat_Sqrt:  [[0.15]]
grads:  [0.04675114]
Stock Position:  0.046751137046611414
Bond Position:  [1.74644517]


portfolio before change:  [6.67971395]
curr_Stock_Price:  105.51956458794511
curr_Factors:  [105.51956459]
mat_Sqrt:  [[0.15]]
grads:  [-0.05064992]
Stock Position:  -0.05064992419741472
Bond Position:  [12.0242719]


portfolio before change:  [6.66352049]
curr_Stock_Price:  105.85411596762259
curr_Factors:  [105.85411597]
mat_Sqrt:  [[0.15]]
grads:  [0.13557963]
Stock Position:  0.13557963190778755
Bond Position:  [-7.68814159]


portfolio before change:  [6.67293789]
curr_Stock_Price:  105.9271204953413
curr_Factors:  [105.9271205]
mat_Sqrt:  [[0.15]]
grads:  [0.03212907]
Stock Position:  0.03212907338031863
Bond Position:  [3.26959766]


portfolio before change:  [6.69678503]
curr_Stock_Price:  106.66298930138674
curr_Factors:  [106.6629893]
mat_Sqrt:  [[0.15]]
grads:  [-0.07087581]
Stock Position:  -0.07087580874141189
Bond Position:  [14.25661066]


portfolio before change:  [6.75214377]
curr_Stock_Price:  105.8944947382204
curr_Factors:  [105.89449474]
mat_Sqrt:  [[0.15]]
grads:  [0.03894812]
Stock Position:  0.038948115350242965
Bond Position:  [2.62775277]


portfolio before change:  [6.78218025]
curr_Stock_Price:  106.66146993628091
curr_Factors:  [106.66146994]
mat_Sqrt:  [[0.15]]
grads:  [-0.13644912]
Stock Position:  -0.13644912461172795
Bond Position:  [21.33604445]


portfolio before change:  [6.76837016]
curr_Stock_Price:  106.77245368322608
curr_Factors:  [106.77245368]
mat_Sqrt:  [[0.15]]
grads:  [0.20474449]
Stock Position:  0.20474448821986985
Bond Position:  [-15.09270123]


portfolio before change:  [6.77351666]
curr_Stock_Price:  106.80219721914523
curr_Factors:  [106.80219722]
mat_Sqrt:  [[0.15]]
grads:  [0.10759955]
Stock Position:  0.10759955171830621
Bond Position:  [-4.71835188]


portfolio before change:  [6.73326115]
curr_Stock_Price:  106.43081461484222
curr_Factors:  [106.43081461]
mat_Sqrt:  [[0.15]]
grads:  [0.011288]
Stock Position:  0.011287996195521413
Bond Position:  [5.53187052]


portfolio before change:  [6.73947949]
curr_Stock_Price:  106.95106486054759
curr_Factors:  [106.95106486]
mat_Sqrt:  [[0.15]]
grads:  [0.0133501]
Stock Position:  0.013350102327811773
Bond Position:  [5.31167183]


portfolio before change:  [6.73883182]
curr_Stock_Price:  106.87768282098543
curr_Factors:  [106.87768282]
mat_Sqrt:  [[0.15]]
grads:  [0.00854883]
Stock Position:  0.008548830522257361
Bond Position:  [5.82515262]


portfolio before change:  [6.74737884]
curr_Stock_Price:  107.83488202364353
curr_Factors:  [107.83488202]
mat_Sqrt:  [[0.15]]
grads:  [0.14701506]
Stock Position:  0.14701506283614948
Bond Position:  [-9.10597312]


portfolio before change:  [6.69791673]
curr_Stock_Price:  107.50231087714977
curr_Factors:  [107.50231088]
mat_Sqrt:  [[0.15]]
grads:  [0.32546553]
Stock Position:  0.32546553383769866
Bond Position:  [-28.29038027]


portfolio before change:  [6.37167678]
curr_Stock_Price:  106.50536433537312
curr_Factors:  [106.50536434]
mat_Sqrt:  [[0.15]]
grads:  [-0.01639514]
Stock Position:  -0.016395138186285168
Bond Position:  [8.11784695]


portfolio before change:  [6.36960768]
curr_Stock_Price:  106.6625135621438
curr_Factors:  [106.66251356]
mat_Sqrt:  [[0.15]]
grads:  [-0.08045637]
Stock Position:  -0.08045636806791036
Bond Position:  [14.95128613]


portfolio before change:  [6.3765599]
curr_Stock_Price:  106.58771857159161
curr_Factors:  [106.58771857]
mat_Sqrt:  [[0.15]]
grads:  [0.11210828]
Stock Position:  0.11210827871013243
Bond Position:  [-5.57280576]


portfolio before change:  [6.32913975]
curr_Stock_Price:  106.16784024797087
curr_Factors:  [106.16784025]
mat_Sqrt:  [[0.15]]
grads:  [0.0512411]
Stock Position:  0.05124110140649186
Bond Position:  [0.88898268]


portfolio before change:  [6.37099947]
curr_Stock_Price:  106.98367268544666
curr_Factors:  [106.98367269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303978]
Stock Position:  -0.03303978387120575
Bond Position:  [9.90571689]


portfolio before change:  [6.35230504]
curr_Stock_Price:  107.56822710629922
curr_Factors:  [107.56822711]
mat_Sqrt:  [[0.15]]
grads:  [0.10476451]
Stock Position:  0.10476451011747812
Bond Position:  [-4.91702757]


portfolio before change:  [6.32108179]
curr_Stock_Price:  107.2731278233196
curr_Factors:  [107.27312782]
mat_Sqrt:  [[0.15]]
grads:  [-0.12264725]
Stock Position:  -0.12264725387251672
Bond Position:  [19.47783633]


portfolio before change:  [6.33651044]
curr_Stock_Price:  107.15725687627027
curr_Factors:  [107.15725688]
mat_Sqrt:  [[0.15]]
grads:  [-0.23086331]
Stock Position:  -0.2308633060961155
Bond Position:  [31.07518904]


portfolio before change:  [6.32015556]
curr_Stock_Price:  107.23651219846802
curr_Factors:  [107.2365122]
mat_Sqrt:  [[0.15]]
grads:  [-0.04280559]
Stock Position:  -0.04280559428677789
Bond Position:  [10.91047819]


portfolio before change:  [6.33448257]
curr_Stock_Price:  106.91774346354629
curr_Factors:  [106.91774346]
mat_Sqrt:  [[0.15]]
grads:  [0.10344459]
Stock Position:  0.10344458613632904
Bond Position:  [-4.72557915]


portfolio before change:  [6.33170241]
curr_Stock_Price:  106.89372290423408
curr_Factors:  [106.8937229]
mat_Sqrt:  [[0.15]]
grads:  [-0.15903966]
Stock Position:  -0.1590396621590331
Bond Position:  [23.33204399]


portfolio before change:  [6.51200143]
curr_Stock_Price:  105.76921901523765
curr_Factors:  [105.76921902]
mat_Sqrt:  [[0.15]]
grads:  [0.18256239]
Stock Position:  0.18256238589403662
Bond Position:  [-12.79747955]


portfolio before change:  [6.63544707]
curr_Stock_Price:  106.44978366090635
curr_Factors:  [106.44978366]
mat_Sqrt:  [[0.15]]
grads:  [-0.18586552]
Stock Position:  -0.18586551650875763
Bond Position:  [26.42079109]


portfolio before change:  [6.63065013]
curr_Stock_Price:  106.48447698910623
curr_Factors:  [106.48447699]
mat_Sqrt:  [[0.15]]
grads:  [0.02776543]
Stock Position:  0.02776543239682387
Bond Position:  [3.67406258]


portfolio before change:  [6.64556604]
curr_Stock_Price:  107.01341804049993
curr_Factors:  [107.01341804]
mat_Sqrt:  [[0.15]]
grads:  [0.04341345]
Stock Position:  0.04341345023673351
Bond Position:  [1.99974434]


portfolio before change:  [6.65555215]
curr_Stock_Price:  107.24056235619554
curr_Factors:  [107.24056236]
mat_Sqrt:  [[0.15]]
grads:  [-0.10596471]
Stock Position:  -0.10596471000375127
Bond Position:  [18.01926724]


portfolio before change:  [6.71971293]
curr_Stock_Price:  106.64569881421728
curr_Factors:  [106.64569881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.71971293]
Stock Price:  106.61670684608588
PL:  [0.10300608]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-1.10151317e-04]
 [-1.05407264e-03]
 [-3.04155005e-03]
 [-2.07131472e-03]
 [ 4.41716671e-02]
 [ 2.65950395e-02]
 [ 5.14283795e-03]
 [ 1.99107441e-02]
 [ 2.43406856e-02]
 [ 1.99193035e-03]
 [ 7.75881213e-02]
 [ 8.37386636e-02]
 [ 1.22896065e-01]
 [ 1.98845280e-02]
 [-6.89153666e-03]
 [ 3.62010220e-02]
 [ 1.57069612e-02]
 [ 6.61743324e-03]
 [ 1.12070737e-02]
 [-7.56992125e-03]
 [ 1.47970689e-02]
 [-1.35786963e-02]
 [ 1.07922623e-02]
 [-4.19109684e-02]
 [ 8.62921181e-03]
 [ 6.81375882e-03]
 [-4.06760387e-03]
 [ 1.62784766e-02]
 [ 4.96283733e-02]
 [ 5.57396707e-03]
 [ 1.84344695e-02]
 [-4.42900125e-03]
 [-1.53130723e-03]
 [ 8.32206084e-03]
 [ 1.01424450e-02]
 [ 7.42878918e-03]
 [-3.28334350e-02]
 [ 8.85640712e-03]
 [ 9.38008580e-03]
 [ 1.34196148e-02]
 [-3.75842341e-03]
 [-1.61821969e-02]
 [ 2.05972840e-02]
 [-2.15562190e-03]
 [ 1.30160527e-03]
 [-1.57299587e-02]
 [ 1.46932301e-02]
 [ 8.37523856e-03]
 [ 4.91513148e-03]
 [-7.41133168e-03]
 [-6.79169486e-03]
 [ 2.94011917e-03]
 [-9.05119090e-03]
 [ 5.79765602e-03]
 [-7.89788736e-03]
 [ 8.16272456e-03]
 [ 1.01820159e-02]
 [ 1.34018325e-04]
 [ 1.70623828e-03]
 [ 1.45705575e-02]
 [ 2.84163122e-05]
 [-6.53416040e-03]
 [-4.20586687e-03]
 [-1.27994045e-02]
 [-5.88832677e-03]
 [-6.58077279e-04]
 [-5.53036079e-03]
 [ 1.67016817e-02]
 [-8.25667260e-03]
 [ 1.06940463e-02]
 [-1.19304166e-02]
 [ 1.20367013e-02]
 [-6.35299196e-04]
 [ 1.86981239e-02]
 [-2.24811105e-02]
 [-3.25628369e-03]
 [-7.68692110e-03]
 [-1.98969682e-03]
 [ 7.94643521e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.89093688]
curr_Stock_Price:  101.29070382646795
curr_Factors:  [101.29070383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00073434]
Stock Position:  -0.0007343421149585191
Bond Position:  [21.96531891]


portfolio before change:  [21.89242775]
curr_Stock_Price:  101.13002529933426
curr_Factors:  [101.1300253]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702715]
Stock Position:  -0.007027150932781959
Bond Position:  [22.6030837]


portfolio before change:  [21.88393293]
curr_Stock_Price:  102.539921664154
curr_Factors:  [102.53992166]
mat_Sqrt:  [[0.15]]
grads:  [-0.020277]
Stock Position:  -0.02027700033854407
Bond Position:  [23.96313496]


portfolio before change:  [21.89133374]
curr_Stock_Price:  102.24880069225537
curr_Factors:  [102.24880069]
mat_Sqrt:  [[0.15]]
grads:  [-0.01380876]
Stock Position:  -0.013808764829096692
Bond Position:  [23.30326338]


portfolio before change:  [21.88583859]
curr_Stock_Price:  102.75222345727113
curr_Factors:  [102.75222346]
mat_Sqrt:  [[0.15]]
grads:  [0.29447778]
Stock Position:  0.29447778096398564
Bond Position:  [-8.37240816]


portfolio before change:  [21.82974257]
curr_Stock_Price:  102.56350726486637
curr_Factors:  [102.56350726]
mat_Sqrt:  [[0.15]]
grads:  [0.17730026]
Stock Position:  0.17730026334652302
Bond Position:  [3.64520572]


portfolio before change:  [21.93260631]
curr_Stock_Price:  103.14238915269392
curr_Factors:  [103.14238915]
mat_Sqrt:  [[0.15]]
grads:  [0.03428559]
Stock Position:  0.03428558635229818
Bond Position:  [18.39630902]


portfolio before change:  [21.93741446]
curr_Stock_Price:  103.24909107794153
curr_Factors:  [103.24909108]
mat_Sqrt:  [[0.15]]
grads:  [0.13273829]
Stock Position:  0.13273829379888907
Bond Position:  [8.23230627]


portfolio before change:  [22.01232126]
curr_Stock_Price:  103.80953423128356
curr_Factors:  [103.80953423]
mat_Sqrt:  [[0.15]]
grads:  [0.16227124]
Stock Position:  0.16227123756893916
Bond Position:  [5.16701967]


portfolio before change:  [22.11437933]
curr_Stock_Price:  104.43647907493711
curr_Factors:  [104.43647907]
mat_Sqrt:  [[0.15]]
grads:  [0.01327954]
Stock Position:  0.013279535682514122
Bond Position:  [20.72751137]


portfolio before change:  [22.12300505]
curr_Stock_Price:  104.98847203982935
curr_Factors:  [104.98847204]
mat_Sqrt:  [[0.15]]
grads:  [0.51725414]
Stock Position:  0.5172541416853225
Bond Position:  [-32.18271695]


portfolio before change:  [21.42318831]
curr_Stock_Price:  103.63941517398297
curr_Factors:  [103.63941517]
mat_Sqrt:  [[0.15]]
grads:  [0.55825776]
Stock Position:  0.558257757292358
Bond Position:  [-36.43431917]


portfolio before change:  [21.34611949]
curr_Stock_Price:  103.50544193082712
curr_Factors:  [103.50544193]
mat_Sqrt:  [[0.15]]
grads:  [0.8193071]
Stock Position:  0.8193071024348354
Bond Position:  [-63.45662422]


portfolio before change:  [21.70734567]
curr_Stock_Price:  103.95117508596113
curr_Factors:  [103.95117509]
mat_Sqrt:  [[0.15]]
grads:  [0.13256352]
Stock Position:  0.13256352030358728
Bond Position:  [7.92721196]


portfolio before change:  [21.8230818]
curr_Stock_Price:  104.82049917613354
curr_Factors:  [104.82049918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594358]
Stock Position:  -0.04594357774631956
Bond Position:  [26.63891055]


portfolio before change:  [21.83169427]
curr_Stock_Price:  104.66928142161186
curr_Factors:  [104.66928142]
mat_Sqrt:  [[0.15]]
grads:  [0.24134015]
Stock Position:  0.24134014643995905
Bond Position:  [-3.42920544]


portfolio before change:  [21.77735875]
curr_Stock_Price:  104.4450287196581
curr_Factors:  [104.44502872]
mat_Sqrt:  [[0.15]]
grads:  [0.10471307]
Stock Position:  0.10471307444124506
Bond Position:  [10.84059869]


portfolio before change:  [21.79395213]
curr_Stock_Price:  104.59702331216474
curr_Factors:  [104.59702331]
mat_Sqrt:  [[0.15]]
grads:  [0.04411622]
Stock Position:  0.04411622160915068
Bond Position:  [17.17952667]


portfolio before change:  [21.75792186]
curr_Stock_Price:  103.75597155635593
curr_Factors:  [103.75597156]
mat_Sqrt:  [[0.15]]
grads:  [0.07471382]
Stock Position:  0.0747138244974254
Bond Position:  [14.00591641]


portfolio before change:  [21.73249645]
curr_Stock_Price:  103.40395094486315
curr_Factors:  [103.40395094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05046614]
Stock Position:  -0.05046614166668086
Bond Position:  [26.95089489]


portfolio before change:  [21.70972083]
curr_Stock_Price:  103.88863452858455
curr_Factors:  [103.88863453]
mat_Sqrt:  [[0.15]]
grads:  [0.09864713]
Stock Position:  0.09864712577533813
Bond Position:  [11.46140563]


portfolio before change:  [21.72016795]
curr_Stock_Price:  103.98727667316751
curr_Factors:  [103.98727667]
mat_Sqrt:  [[0.15]]
grads:  [-0.09052464]
Stock Position:  -0.09052464227272246
Bond Position:  [31.13357897]


portfolio before change:  [21.70455713]
curr_Stock_Price:  104.18122093331237
curr_Factors:  [104.18122093]
mat_Sqrt:  [[0.15]]
grads:  [0.07194842]
Stock Position:  0.07194841535354009
Bond Position:  [14.20888337]


portfolio before change:  [21.66574578]
curr_Stock_Price:  103.62944463354714
curr_Factors:  [103.62944463]
mat_Sqrt:  [[0.15]]
grads:  [-0.27940646]
Stock Position:  -0.2794064557008219
Bond Position:  [50.62048161]


portfolio before change:  [21.56489757]
curr_Stock_Price:  104.00170550501268
curr_Factors:  [104.00170551]
mat_Sqrt:  [[0.15]]
grads:  [0.05752808]
Stock Position:  0.05752807870673294
Bond Position:  [15.58187927]


portfolio before change:  [21.54994971]
curr_Stock_Price:  103.72494065562859
curr_Factors:  [103.72494066]
mat_Sqrt:  [[0.15]]
grads:  [0.04542506]
Stock Position:  0.04542505877318924
Bond Position:  [16.83823819]


portfolio before change:  [21.60259852]
curr_Stock_Price:  104.86079801580262
curr_Factors:  [104.86079802]
mat_Sqrt:  [[0.15]]
grads:  [-0.02711736]
Stock Position:  -0.02711735911038878
Bond Position:  [24.44614644]


portfolio before change:  [21.62654761]
curr_Stock_Price:  104.03397870868392
curr_Factors:  [104.03397871]
mat_Sqrt:  [[0.15]]
grads:  [0.10852318]
Stock Position:  0.10852317724024076
Bond Position:  [10.3364497]


portfolio before change:  [21.58312899]
curr_Stock_Price:  103.62793942923298
curr_Factors:  [103.62793943]
mat_Sqrt:  [[0.15]]
grads:  [0.33085582]
Stock Position:  0.33085582182420703
Bond Position:  [-12.70277808]


portfolio before change:  [21.71636454]
curr_Stock_Price:  104.03303885762335
curr_Factors:  [104.03303886]
mat_Sqrt:  [[0.15]]
grads:  [0.03715978]
Stock Position:  0.037159780443910974
Bond Position:  [17.85051966]


portfolio before change:  [21.70214068]
curr_Stock_Price:  103.62023896945776
curr_Factors:  [103.62023897]
mat_Sqrt:  [[0.15]]
grads:  [0.12289646]
Stock Position:  0.12289646349061614
Bond Position:  [8.96757977]


portfolio before change:  [21.66818543]
curr_Stock_Price:  103.3393867577267
curr_Factors:  [103.33938676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02952668]
Stock Position:  -0.029526675009976987
Bond Position:  [24.71945392]


portfolio before change:  [21.65203987]
curr_Stock_Price:  103.93852563633305
curr_Factors:  [103.93852564]
mat_Sqrt:  [[0.15]]
grads:  [-0.01020871]
Stock Position:  -0.010208714897185283
Bond Position:  [22.71311864]


portfolio before change:  [21.65420771]
curr_Stock_Price:  103.86523210843507
curr_Factors:  [103.86523211]
mat_Sqrt:  [[0.15]]
grads:  [0.05548041]
Stock Position:  0.0554804055945139
Bond Position:  [15.89172251]


portfolio before change:  [21.67200745]
curr_Stock_Price:  104.16815840880113
curr_Factors:  [104.16815841]
mat_Sqrt:  [[0.15]]
grads:  [0.0676163]
Stock Position:  0.06761629989186477
Bond Position:  [14.62854201]


portfolio before change:  [21.62629359]
curr_Stock_Price:  103.47855882544091
curr_Factors:  [103.47855883]
mat_Sqrt:  [[0.15]]
grads:  [0.04952526]
Stock Position:  0.04952526117632355
Bond Position:  [16.50149094]


portfolio before change:  [21.62571686]
curr_Stock_Price:  103.44608830852555
curr_Factors:  [103.44608831]
mat_Sqrt:  [[0.15]]
grads:  [-0.21888957]
Stock Position:  -0.21888956678030916
Bond Position:  [44.26898631]


portfolio before change:  [21.52729786]
curr_Stock_Price:  103.90835743651454
curr_Factors:  [103.90835744]
mat_Sqrt:  [[0.15]]
grads:  [0.05904271]
Stock Position:  0.05904271414860941
Bond Position:  [15.39226642]


portfolio before change:  [21.48597178]
curr_Stock_Price:  103.19212795768755
curr_Factors:  [103.19212796]
mat_Sqrt:  [[0.15]]
grads:  [0.06253391]
Stock Position:  0.06253390532974572
Bond Position:  [15.03296502]


portfolio before change:  [21.48948308]
curr_Stock_Price:  103.23325300091064
curr_Factors:  [103.233253]
mat_Sqrt:  [[0.15]]
grads:  [0.0894641]
Stock Position:  0.08946409856843175
Bond Position:  [12.25381316]


portfolio before change:  [21.56474954]
curr_Stock_Price:  104.0659956515842
curr_Factors:  [104.06599565]
mat_Sqrt:  [[0.15]]
grads:  [-0.02505616]
Stock Position:  -0.02505615606019872
Bond Position:  [24.17224336]


portfolio before change:  [21.55917261]
curr_Stock_Price:  104.34886996176799
curr_Factors:  [104.34886996]
mat_Sqrt:  [[0.15]]
grads:  [-0.10788131]
Stock Position:  -0.10788131285467654
Bond Position:  [32.81646569]


portfolio before change:  [21.61061602]
curr_Stock_Price:  103.89103050682675
curr_Factors:  [103.89103051]
mat_Sqrt:  [[0.15]]
grads:  [0.13731523]
Stock Position:  0.1373152269205226
Bond Position:  [7.34479559]


portfolio before change:  [21.58069666]
curr_Stock_Price:  103.66979920145585
curr_Factors:  [103.6697992]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437081]
Stock Position:  -0.014370812638869312
Bond Position:  [23.07051592]


portfolio before change:  [21.59149099]
curr_Stock_Price:  103.01900935342987
curr_Factors:  [103.01900935]
mat_Sqrt:  [[0.15]]
grads:  [0.00867737]
Stock Position:  0.00867736844102426
Bond Position:  [20.69755709]


portfolio before change:  [21.59534985]
curr_Stock_Price:  103.31463141207765
curr_Factors:  [103.31463141]
mat_Sqrt:  [[0.15]]
grads:  [-0.10486639]
Stock Position:  -0.10486639123243163
Bond Position:  [32.42958241]


portfolio before change:  [21.55695675]
curr_Stock_Price:  103.7000743140415
curr_Factors:  [103.70007431]
mat_Sqrt:  [[0.15]]
grads:  [0.09795487]
Stock Position:  0.09795486717929586
Bond Position:  [11.39902975]


portfolio before change:  [21.5523723]
curr_Stock_Price:  103.64599921196408
curr_Factors:  [103.64599921]
mat_Sqrt:  [[0.15]]
grads:  [0.05583492]
Stock Position:  0.05583492374352327
Bond Position:  [15.76530583]


portfolio before change:  [21.57559055]
curr_Stock_Price:  104.0441889670241
curr_Factors:  [104.04418897]
mat_Sqrt:  [[0.15]]
grads:  [0.03276754]
Stock Position:  0.032767543191729205
Bond Position:  [18.1663181]


portfolio before change:  [21.57388457]
curr_Stock_Price:  103.95747457600984
curr_Factors:  [103.95747458]
mat_Sqrt:  [[0.15]]
grads:  [-0.04940888]
Stock Position:  -0.04940887786135381
Bond Position:  [26.71030673]


portfolio before change:  [21.54679597]
curr_Stock_Price:  104.5395165420829
curr_Factors:  [104.53951654]
mat_Sqrt:  [[0.15]]
grads:  [-0.04527797]
Stock Position:  -0.045277965754991836
Bond Position:  [26.28013262]


portfolio before change:  [21.57750488]
curr_Stock_Price:  103.89756296404187
curr_Factors:  [103.89756296]
mat_Sqrt:  [[0.15]]
grads:  [0.01960079]
Stock Position:  0.019600794494689634
Bond Position:  [19.5410301]


portfolio before change:  [21.58013737]
curr_Stock_Price:  103.96955646160272
curr_Factors:  [103.96955646]
mat_Sqrt:  [[0.15]]
grads:  [-0.06034127]
Stock Position:  -0.06034127265059816
Bond Position:  [27.85379272]


portfolio before change:  [21.59755843]
curr_Stock_Price:  103.7096986450751
curr_Factors:  [103.70969865]
mat_Sqrt:  [[0.15]]
grads:  [0.03865104]
Stock Position:  0.03865104012250246
Bond Position:  [17.58907071]


portfolio before change:  [21.58811741]
curr_Stock_Price:  103.4369925640371
curr_Factors:  [103.43699256]
mat_Sqrt:  [[0.15]]
grads:  [-0.05265258]
Stock Position:  -0.052652582367836015
Bond Position:  [27.03434218]


portfolio before change:  [21.59302318]
curr_Stock_Price:  103.37591164733823
curr_Factors:  [103.37591165]
mat_Sqrt:  [[0.15]]
grads:  [0.05441816]
Stock Position:  0.054418163717821835
Bond Position:  [15.96749589]


portfolio before change:  [21.6022989]
curr_Stock_Price:  103.52802477881345
curr_Factors:  [103.52802478]
mat_Sqrt:  [[0.15]]
grads:  [0.06788011]
Stock Position:  0.0678801056999123
Bond Position:  [14.57480563]


portfolio before change:  [21.60496173]
curr_Stock_Price:  103.55383326724525
curr_Factors:  [103.55383327]
mat_Sqrt:  [[0.15]]
grads:  [0.00089346]
Stock Position:  0.0008934554988953937
Bond Position:  [21.51244099]


portfolio before change:  [21.60587336]
curr_Stock_Price:  103.06926180631187
curr_Factors:  [103.06926181]
mat_Sqrt:  [[0.15]]
grads:  [0.01137492]
Stock Position:  0.011374921869919325
Bond Position:  [20.43346856]


portfolio before change:  [21.59026402]
curr_Stock_Price:  101.58472694833475
curr_Factors:  [101.58472695]
mat_Sqrt:  [[0.15]]
grads:  [0.09713705]
Stock Position:  0.09713704975730422
Bond Position:  [11.72262335]


portfolio before change:  [21.56306546]
curr_Stock_Price:  101.29718221669023
curr_Factors:  [101.29718222]
mat_Sqrt:  [[0.15]]
grads:  [0.00018944]
Stock Position:  0.00018944208165718943
Bond Position:  [21.54387551]


portfolio before change:  [21.56441581]
curr_Stock_Price:  101.31731460615832
curr_Factors:  [101.31731461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04356107]
Stock Position:  -0.043561069340068245
Bond Position:  [25.97790638]


portfolio before change:  [21.55115485]
curr_Stock_Price:  101.6590103909291
curr_Factors:  [101.65901039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02803911]
Stock Position:  -0.028039112476070174
Bond Position:  [24.40158327]


portfolio before change:  [21.55721456]
curr_Stock_Price:  101.49728740590866
curr_Factors:  [101.49728741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08532936]
Stock Position:  -0.0853293632069833
Bond Position:  [30.21791346]


portfolio before change:  [21.59515226]
curr_Stock_Price:  101.07481830130226
curr_Factors:  [101.0748183]
mat_Sqrt:  [[0.15]]
grads:  [-0.03925551]
Stock Position:  -0.039255511766887165
Bond Position:  [25.56289598]


portfolio before change:  [21.59069252]
curr_Stock_Price:  101.22912703574589
curr_Factors:  [101.22912704]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438718]
Stock Position:  -0.004387181860413744
Bond Position:  [22.03480311]


portfolio before change:  [21.59195051]
curr_Stock_Price:  101.25630404902138
curr_Factors:  [101.25630405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03686907]
Stock Position:  -0.03686907193309395
Bond Position:  [25.32517647]


portfolio before change:  [21.58022301]
curr_Stock_Price:  101.61732131373928
curr_Factors:  [101.61732131]
mat_Sqrt:  [[0.15]]
grads:  [0.11134454]
Stock Position:  0.11134454452651803
Bond Position:  [10.26568865]


portfolio before change:  [21.54811381]
curr_Stock_Price:  101.32318177989634
curr_Factors:  [101.32318178]
mat_Sqrt:  [[0.15]]
grads:  [-0.05504448]
Stock Position:  -0.05504448398551067
Bond Position:  [27.12539606]


portfolio before change:  [21.5133947]
curr_Stock_Price:  101.98472850200983
curr_Factors:  [101.9847285]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [14.24253196]


portfolio before change:  [21.5587527]
curr_Stock_Price:  102.60845616618658
curr_Factors:  [102.60845617]
mat_Sqrt:  [[0.15]]
grads:  [-0.07953611]
Stock Position:  -0.07953611048190601
Bond Position:  [29.71983021]


portfolio before change:  [21.58635621]
curr_Stock_Price:  102.28475462118651
curr_Factors:  [102.28475462]
mat_Sqrt:  [[0.15]]
grads:  [0.08024468]
Stock Position:  0.08024467541568805
Bond Position:  [13.37854928]


portfolio before change:  [21.56498604]
curr_Stock_Price:  102.00802149745579
curr_Factors:  [102.0080215]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423533]
Stock Position:  -0.004235327970617335
Bond Position:  [21.99702346]


portfolio before change:  [21.56828394]
curr_Stock_Price:  101.55397319598393
curr_Factors:  [101.5539732]
mat_Sqrt:  [[0.15]]
grads:  [0.12465416]
Stock Position:  0.1246541591246708
Bond Position:  [8.9091588]


portfolio before change:  [21.57765178]
curr_Stock_Price:  101.62465675413112
curr_Factors:  [101.62465675]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987407]
Stock Position:  -0.14987407015664914
Bond Position:  [36.80855271]


portfolio before change:  [21.59027486]
curr_Stock_Price:  101.55578242475482
curr_Factors:  [101.55578242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170856]
Stock Position:  -0.021708557901870224
Bond Position:  [23.79490444]


portfolio before change:  [21.61702903]
curr_Stock_Price:  100.39186615299514
curr_Factors:  [100.39186615]
mat_Sqrt:  [[0.15]]
grads:  [-0.05124614]
Stock Position:  -0.051246140683317176
Bond Position:  [26.76172473]


portfolio before change:  [21.6334598]
curr_Stock_Price:  100.10388124998713
curr_Factors:  [100.10388125]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326465]
Stock Position:  -0.013264645438895524
Bond Position:  [22.9613023]


portfolio before change:  [21.62618352]
curr_Stock_Price:  100.76062066115087
curr_Factors:  [100.76062066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.62618352]
Stock Price:  100.36479825175525
PL:  [21.26138526]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-1.51009908e-04]
 [-3.32057663e-03]
 [-4.59366025e-03]
 [ 5.26900043e-03]
 [ 4.36236419e-03]
 [ 2.51683322e-02]
 [ 1.50428608e-03]
 [-1.64323240e-02]
 [ 1.86343624e-02]
 [-3.61476888e-03]
 [ 1.59051367e-02]
 [-8.32527434e-03]
 [-2.36350444e-04]
 [ 6.40566375e-04]
 [-6.90217108e-03]
 [ 2.49643648e-02]
 [ 1.09467794e-02]
 [-8.44110318e-03]
 [ 7.23541596e-03]
 [-7.42570601e-03]
 [ 1.45414641e-02]
 [-1.68623360e-02]
 [ 1.00439331e-02]
 [-9.53781026e-02]
 [ 1.40808516e-02]
 [ 4.84280877e-03]
 [-2.97946735e-03]
 [ 2.48779856e-02]
 [ 7.86018285e-02]
 [ 1.27147138e-02]
 [ 2.20526199e-02]
 [ 4.35248467e-03]
 [-3.12644835e-03]
 [ 7.39283087e-03]
 [ 9.67592233e-03]
 [ 5.64522987e-03]
 [-3.23841328e-02]
 [ 8.66017382e-03]
 [ 1.73964071e-02]
 [-5.32122834e-04]
 [-3.81840303e-03]
 [-1.80586121e-02]
 [ 2.08157758e-02]
 [-1.44870167e-03]
 [-1.25421133e-03]
 [-1.36723860e-02]
 [ 1.46047079e-02]
 [ 3.11306050e-03]
 [ 4.83213317e-03]
 [-7.44440012e-03]
 [-1.77306043e-02]
 [ 3.60361430e-03]
 [-9.77914270e-03]
 [ 5.91439622e-03]
 [-1.13320430e-02]
 [ 1.56770170e-02]
 [ 1.08086652e-02]
 [ 5.30093483e-04]
 [ 1.77824678e-03]
 [ 1.02174077e-02]
 [ 2.84254761e-03]
 [ 2.25302249e-02]
 [ 4.07536164e-03]
 [-1.25559758e-02]
 [ 7.54149911e-03]
 [ 4.11865854e-03]
 [-5.31318085e-03]
 [ 1.53685382e-02]
 [-8.49231460e-03]
 [-1.68685164e-03]
 [-1.27790419e-02]
 [ 1.26207198e-02]
 [ 4.42213052e-04]
 [ 2.13757392e-02]
 [-2.24807735e-02]
 [-1.08831638e-03]
 [-1.03275486e-02]
 [-1.78864982e-03]
 [ 7.84550493e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.43807355]
curr_Stock_Price:  100.4159319415936
curr_Factors:  [100.41593194]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100673]
Stock Position:  -0.0010067327207869052
Bond Position:  [8.53916556]


portfolio before change:  [8.43759337]
curr_Stock_Price:  101.42304513453792
curr_Factors:  [101.42304513]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213718]
Stock Position:  -0.022137177521782344
Bond Position:  [10.68281333]


portfolio before change:  [8.44577889]
curr_Stock_Price:  101.08344373902929
curr_Factors:  [101.08344374]
mat_Sqrt:  [[0.15]]
grads:  [-0.0306244]
Stock Position:  -0.03062440163817414
Bond Position:  [11.54139887]


portfolio before change:  [8.45594258]
curr_Stock_Price:  100.7751165832712
curr_Factors:  [100.77511658]
mat_Sqrt:  [[0.15]]
grads:  [0.03512667]
Stock Position:  0.03512666953671943
Bond Position:  [4.91604836]


portfolio before change:  [8.42616141]
curr_Stock_Price:  99.91854697345305
curr_Factors:  [99.91854697]
mat_Sqrt:  [[0.15]]
grads:  [0.02908243]
Stock Position:  0.029082427902001075
Bond Position:  [5.52028747]


portfolio before change:  [8.43379769]
curr_Stock_Price:  100.16925682977052
curr_Factors:  [100.16925683]
mat_Sqrt:  [[0.15]]
grads:  [0.16778888]
Stock Position:  0.16778888151778523
Bond Position:  [-8.37348988]


portfolio before change:  [8.40827003]
curr_Stock_Price:  100.02023444839172
curr_Factors:  [100.02023445]
mat_Sqrt:  [[0.15]]
grads:  [0.01002857]
Stock Position:  0.0100285738540102
Bond Position:  [7.40520972]


portfolio before change:  [8.40998233]
curr_Stock_Price:  100.14482465693409
curr_Factors:  [100.14482466]
mat_Sqrt:  [[0.15]]
grads:  [-0.10954883]
Stock Position:  -0.10954882690514436
Bond Position:  [19.38073039]


portfolio before change:  [8.43292231]
curr_Stock_Price:  99.94647798413095
curr_Factors:  [99.94647798]
mat_Sqrt:  [[0.15]]
grads:  [0.12422908]
Stock Position:  0.12422908242070671
Bond Position:  [-3.98333694]


portfolio before change:  [8.45805038]
curr_Stock_Price:  100.1507541124668
curr_Factors:  [100.15075411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02409846]
Stock Position:  -0.02409845921216079
Bond Position:  [10.87152924]


portfolio before change:  [8.44902759]
curr_Stock_Price:  100.55336401161338
curr_Factors:  [100.55336401]
mat_Sqrt:  [[0.15]]
grads:  [0.10603424]
Stock Position:  0.10603424467401586
Bond Position:  [-2.21307241]


portfolio before change:  [8.38938213]
curr_Stock_Price:  99.99215718069884
curr_Factors:  [99.99215718]
mat_Sqrt:  [[0.15]]
grads:  [-0.05550183]
Stock Position:  -0.05550182890237667
Bond Position:  [13.93912973]


portfolio before change:  [8.39611847]
curr_Stock_Price:  99.88648291406626
curr_Factors:  [99.88648291]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157567]
Stock Position:  -0.001575669629497109
Bond Position:  [8.55350657]


portfolio before change:  [8.39560641]
curr_Stock_Price:  100.55075274627202
curr_Factors:  [100.55075275]
mat_Sqrt:  [[0.15]]
grads:  [0.00427044]
Stock Position:  0.004270442500814807
Bond Position:  [7.9662102]


portfolio before change:  [8.39970944]
curr_Stock_Price:  101.39495701849806
curr_Factors:  [101.39495702]
mat_Sqrt:  [[0.15]]
grads:  [-0.04601447]
Stock Position:  -0.0460144738738219
Bond Position:  [13.06534504]


portfolio before change:  [8.37207771]
curr_Stock_Price:  102.0132045375099
curr_Factors:  [102.01320454]
mat_Sqrt:  [[0.15]]
grads:  [0.1664291]
Stock Position:  0.1664290985319281
Bond Position:  [-8.60588796]


portfolio before change:  [8.37437028]
curr_Stock_Price:  102.0302114864981
curr_Factors:  [102.03021149]
mat_Sqrt:  [[0.15]]
grads:  [0.07297853]
Stock Position:  0.07297852907041784
Bond Position:  [0.92835552]


portfolio before change:  [8.42361714]
curr_Stock_Price:  102.70422938609232
curr_Factors:  [102.70422939]
mat_Sqrt:  [[0.15]]
grads:  [-0.05627402]
Stock Position:  -0.05627402122642961
Bond Position:  [14.20319712]


portfolio before change:  [8.41190708]
curr_Stock_Price:  102.92809450619194
curr_Factors:  [102.92809451]
mat_Sqrt:  [[0.15]]
grads:  [0.04823611]
Stock Position:  0.04823610643016666
Bond Position:  [3.44705655]


portfolio before change:  [8.43105354]
curr_Stock_Price:  103.32056018814036
curr_Factors:  [103.32056019]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950471]
Stock Position:  -0.049504706703387344
Bond Position:  [13.54590757]


portfolio before change:  [8.42769647]
curr_Stock_Price:  103.4054755936687
curr_Factors:  [103.40547559]
mat_Sqrt:  [[0.15]]
grads:  [0.09694309]
Stock Position:  0.09694309367532272
Bond Position:  [-1.59675023]


portfolio before change:  [8.55544201]
curr_Stock_Price:  104.7242424089848
curr_Factors:  [104.72424241]
mat_Sqrt:  [[0.15]]
grads:  [-0.11241557]
Stock Position:  -0.1124155730161892
Bond Position:  [20.32807773]


portfolio before change:  [8.50047311]
curr_Stock_Price:  105.22452401954712
curr_Factors:  [105.22452402]
mat_Sqrt:  [[0.15]]
grads:  [0.06695955]
Stock Position:  0.06695955430542953
Bond Position:  [1.45468588]


portfolio before change:  [8.53819783]
curr_Stock_Price:  105.78656175311608
curr_Factors:  [105.78656175]
mat_Sqrt:  [[0.15]]
grads:  [-0.63585402]
Stock Position:  -0.6358540172351355
Bond Position:  [75.80300809]


portfolio before change:  [8.53780228]
curr_Stock_Price:  105.79463496706494
curr_Factors:  [105.79463497]
mat_Sqrt:  [[0.15]]
grads:  [0.09387234]
Stock Position:  0.0938723438800746
Bond Position:  [-1.39338808]


portfolio before change:  [8.62013674]
curr_Stock_Price:  106.67265243700359
curr_Factors:  [106.67265244]
mat_Sqrt:  [[0.15]]
grads:  [0.03228539]
Stock Position:  0.03228539180054546
Bond Position:  [5.17616837]


portfolio before change:  [8.6155977]
curr_Stock_Price:  106.52204040571948
curr_Factors:  [106.52204041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986312]
Stock Position:  -0.01986311567336019
Bond Position:  [10.73145731]


portfolio before change:  [8.62285666]
curr_Stock_Price:  106.19035916995821
curr_Factors:  [106.19035917]
mat_Sqrt:  [[0.15]]
grads:  [0.16585324]
Stock Position:  0.1658532376262311
Bond Position:  [-8.98915822]


portfolio before change:  [8.73273533]
curr_Stock_Price:  106.85625220767807
curr_Factors:  [106.85625221]
mat_Sqrt:  [[0.15]]
grads:  [0.52401219]
Stock Position:  0.5240121898747103
Bond Position:  [-47.26124339]


portfolio before change:  [8.63623913]
curr_Stock_Price:  106.67774056229933
curr_Factors:  [106.67774056]
mat_Sqrt:  [[0.15]]
grads:  [0.08476476]
Stock Position:  0.08476475883621808
Bond Position:  [-0.40627382]


portfolio before change:  [8.54202264]
curr_Stock_Price:  105.56653469211501
curr_Factors:  [105.56653469]
mat_Sqrt:  [[0.15]]
grads:  [0.14701747]
Stock Position:  0.1470174661885344
Bond Position:  [-6.9781018]


portfolio before change:  [8.45024142]
curr_Stock_Price:  104.94521344175055
curr_Factors:  [104.94521344]
mat_Sqrt:  [[0.15]]
grads:  [0.02901656]
Stock Position:  0.029016564466412487
Bond Position:  [5.40509187]


portfolio before change:  [8.44701607]
curr_Stock_Price:  104.82241506994218
curr_Factors:  [104.82241507]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084299]
Stock Position:  -0.020842988981285573
Bond Position:  [10.63182851]


portfolio before change:  [8.44059173]
curr_Stock_Price:  105.16252209465782
curr_Factors:  [105.16252209]
mat_Sqrt:  [[0.15]]
grads:  [0.04928554]
Stock Position:  0.04928553915624478
Bond Position:  [3.25760013]


portfolio before change:  [8.44246866]
curr_Stock_Price:  105.19647365957562
curr_Factors:  [105.19647366]
mat_Sqrt:  [[0.15]]
grads:  [0.06450615]
Stock Position:  0.06450614887717358
Bond Position:  [1.65664926]


portfolio before change:  [8.42439977]
curr_Stock_Price:  104.9147573732066
curr_Factors:  [104.91475737]
mat_Sqrt:  [[0.15]]
grads:  [0.03763487]
Stock Position:  0.03763486577151934
Bond Position:  [4.47594696]


portfolio before change:  [8.40253364]
curr_Stock_Price:  104.32631684986725
curr_Factors:  [104.32631685]
mat_Sqrt:  [[0.15]]
grads:  [-0.21589422]
Stock Position:  -0.21589421871838493
Bond Position:  [30.92598231]


portfolio before change:  [8.26639099]
curr_Stock_Price:  104.96586886113825
curr_Factors:  [104.96586886]
mat_Sqrt:  [[0.15]]
grads:  [0.05773449]
Stock Position:  0.05773449215678039
Bond Position:  [2.20623986]


portfolio before change:  [8.29058001]
curr_Stock_Price:  105.38245042739578
curr_Factors:  [105.38245043]
mat_Sqrt:  [[0.15]]
grads:  [0.11597605]
Stock Position:  0.1159760473454057
Bond Position:  [-3.93126005]


portfolio before change:  [8.22558801]
curr_Stock_Price:  104.82417742800327
curr_Factors:  [104.82417743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354749]
Stock Position:  -0.003547485562304965
Bond Position:  [8.59745026]


portfolio before change:  [8.22940885]
curr_Stock_Price:  103.89859541357647
curr_Factors:  [103.89859541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02545602]
Stock Position:  -0.025456020192492438
Bond Position:  [10.8742536]


portfolio before change:  [8.23917236]
curr_Stock_Price:  103.54175075893289
curr_Factors:  [103.54175076]
mat_Sqrt:  [[0.15]]
grads:  [-0.12039075]
Stock Position:  -0.12039074708684024
Bond Position:  [20.70464109]


portfolio before change:  [8.28174366]
curr_Stock_Price:  103.19889035596957
curr_Factors:  [103.19889036]
mat_Sqrt:  [[0.15]]
grads:  [0.13877184]
Stock Position:  0.13877183855492647
Bond Position:  [-6.03935609]


portfolio before change:  [8.29138663]
curr_Stock_Price:  103.27109841787303
curr_Factors:  [103.27109842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965801]
Stock Position:  -0.009658011138396542
Bond Position:  [9.28878005]


portfolio before change:  [8.29859161]
curr_Stock_Price:  102.58520074325898
curr_Factors:  [102.58520074]
mat_Sqrt:  [[0.15]]
grads:  [-0.00836141]
Stock Position:  -0.008361408885422006
Bond Position:  [9.15634842]


portfolio before change:  [8.29724777]
curr_Stock_Price:  102.81436457095108
curr_Factors:  [102.81436457]
mat_Sqrt:  [[0.15]]
grads:  [-0.09114924]
Stock Position:  -0.0911492396994426
Bond Position:  [17.66869893]


portfolio before change:  [8.23305937]
curr_Stock_Price:  103.53069230223751
curr_Factors:  [103.5306923]
mat_Sqrt:  [[0.15]]
grads:  [0.09736472]
Stock Position:  0.09736471946870834
Bond Position:  [-1.84717745]


portfolio before change:  [8.15849507]
curr_Stock_Price:  102.76605343786959
curr_Factors:  [102.76605344]
mat_Sqrt:  [[0.15]]
grads:  [0.02075374]
Stock Position:  0.02075373665691619
Bond Position:  [6.02571546]


portfolio before change:  [8.18463451]
curr_Stock_Price:  104.0074119345938
curr_Factors:  [104.00741193]
mat_Sqrt:  [[0.15]]
grads:  [0.03221422]
Stock Position:  0.03221422112270298
Bond Position:  [4.83411675]


portfolio before change:  [8.19226695]
curr_Stock_Price:  104.23496024552425
curr_Factors:  [104.23496025]
mat_Sqrt:  [[0.15]]
grads:  [-0.04962933]
Stock Position:  -0.04962933415441571
Bond Position:  [13.36537862]


portfolio before change:  [8.20434533]
curr_Stock_Price:  104.00842043234171
curr_Factors:  [104.00842043]
mat_Sqrt:  [[0.15]]
grads:  [-0.11820403]
Stock Position:  -0.11820402861314024
Bond Position:  [20.49855963]


portfolio before change:  [8.08711678]
curr_Stock_Price:  105.01100679032727
curr_Factors:  [105.01100679]
mat_Sqrt:  [[0.15]]
grads:  [0.0240241]
Stock Position:  0.02402409533182141
Bond Position:  [5.56432234]


portfolio before change:  [8.09225378]
curr_Stock_Price:  105.21035736241404
curr_Factors:  [105.21035736]
mat_Sqrt:  [[0.15]]
grads:  [-0.06519428]
Stock Position:  -0.06519428464259541
Bond Position:  [14.95136776]


portfolio before change:  [8.14302739]
curr_Stock_Price:  104.44588659004641
curr_Factors:  [104.44588659]
mat_Sqrt:  [[0.15]]
grads:  [0.03942931]
Stock Position:  0.0394293081202462
Bond Position:  [4.02479835]


portfolio before change:  [8.13891125]
curr_Stock_Price:  104.33511350573464
curr_Factors:  [104.33511351]
mat_Sqrt:  [[0.15]]
grads:  [-0.07554695]
Stock Position:  -0.07554695360460346
Bond Position:  [16.02111123]


portfolio before change:  [8.1268676]
curr_Stock_Price:  104.50778748706432
curr_Factors:  [104.50778749]
mat_Sqrt:  [[0.15]]
grads:  [0.10451345]
Stock Position:  0.10451344679716582
Bond Position:  [-2.79560148]


portfolio before change:  [8.11595777]
curr_Stock_Price:  104.40507243581943
curr_Factors:  [104.40507244]
mat_Sqrt:  [[0.15]]
grads:  [0.07205777]
Stock Position:  0.07205776796618812
Bond Position:  [0.59276128]


portfolio before change:  [8.10741507]
curr_Stock_Price:  104.28600476310379
curr_Factors:  [104.28600476]
mat_Sqrt:  [[0.15]]
grads:  [0.00353396]
Stock Position:  0.0035339565523217088
Bond Position:  [7.73887286]


portfolio before change:  [8.10701177]
curr_Stock_Price:  104.03501291511748
curr_Factors:  [104.03501292]
mat_Sqrt:  [[0.15]]
grads:  [0.01185498]
Stock Position:  0.011854978515428962
Bond Position:  [6.87367892]


portfolio before change:  [8.11605805]
curr_Stock_Price:  104.76185187696075
curr_Factors:  [104.76185188]
mat_Sqrt:  [[0.15]]
grads:  [0.06811605]
Stock Position:  0.06811605139407478
Bond Position:  [0.98009436]


portfolio before change:  [8.04031686]
curr_Stock_Price:  103.64900926076885
curr_Factors:  [103.64900926]
mat_Sqrt:  [[0.15]]
grads:  [0.01895032]
Stock Position:  0.018950317424231967
Bond Position:  [6.07613523]


portfolio before change:  [8.04575206]
curr_Stock_Price:  103.91578217578271
curr_Factors:  [103.91578218]
mat_Sqrt:  [[0.15]]
grads:  [0.1502015]
Stock Position:  0.15020149932286506
Bond Position:  [-7.56255423]


portfolio before change:  [8.00616017]
curr_Stock_Price:  103.65533726028028
curr_Factors:  [103.65533726]
mat_Sqrt:  [[0.15]]
grads:  [0.02716908]
Stock Position:  0.027169077632328287
Bond Position:  [5.18994026]


portfolio before change:  [8.00222469]
curr_Stock_Price:  103.49854649562717
curr_Factors:  [103.4985465]
mat_Sqrt:  [[0.15]]
grads:  [-0.08370651]
Stock Position:  -0.08370650503710783
Bond Position:  [16.66572629]


portfolio before change:  [7.97914755]
curr_Stock_Price:  103.78668156380564
curr_Factors:  [103.78668156]
mat_Sqrt:  [[0.15]]
grads:  [0.05027666]
Stock Position:  0.050276660707803414
Bond Position:  [2.76109978]


portfolio before change:  [8.01471681]
curr_Stock_Price:  104.49071964343383
curr_Factors:  [104.49071964]
mat_Sqrt:  [[0.15]]
grads:  [0.02745772]
Stock Position:  0.0274577236254057
Bond Position:  [5.14563951]


portfolio before change:  [8.01617218]
curr_Stock_Price:  104.53201058536501
curr_Factors:  [104.53201059]
mat_Sqrt:  [[0.15]]
grads:  [-0.03542121]
Stock Position:  -0.03542120568608073
Bond Position:  [11.71882202]


portfolio before change:  [8.00912762]
curr_Stock_Price:  104.75156841155804
curr_Factors:  [104.75156841]
mat_Sqrt:  [[0.15]]
grads:  [0.10245692]
Stock Position:  0.10245692155935684
Bond Position:  [-2.72339561]


portfolio before change:  [7.95118292]
curr_Stock_Price:  104.18767791951947
curr_Factors:  [104.18767792]
mat_Sqrt:  [[0.15]]
grads:  [-0.05661543]
Stock Position:  -0.056615430676555695
Bond Position:  [13.84981318]


portfolio before change:  [7.95738]
curr_Stock_Price:  104.09350852995868
curr_Factors:  [104.09350853]
mat_Sqrt:  [[0.15]]
grads:  [-0.01124568]
Stock Position:  -0.011245677617295672
Bond Position:  [9.12798204]


portfolio before change:  [7.95718542]
curr_Stock_Price:  104.16154385167722
curr_Factors:  [104.16154385]
mat_Sqrt:  [[0.15]]
grads:  [-0.08519361]
Stock Position:  -0.0851936123854258
Bond Position:  [16.83108361]


portfolio before change:  [8.05457184]
curr_Stock_Price:  103.03077306914324
curr_Factors:  [103.03077307]
mat_Sqrt:  [[0.15]]
grads:  [0.08413813]
Stock Position:  0.0841381320795054
Bond Position:  [-0.61424495]


portfolio before change:  [8.0005882]
curr_Stock_Price:  102.38962210810699
curr_Factors:  [102.38962211]
mat_Sqrt:  [[0.15]]
grads:  [0.00294809]
Stock Position:  0.0029480870161336754
Bond Position:  [7.69873469]


portfolio before change:  [8.00175657]
curr_Stock_Price:  102.62271647064837
curr_Factors:  [102.62271647]
mat_Sqrt:  [[0.15]]
grads:  [0.14250493]
Stock Position:  0.14250492774744308
Bond Position:  [-6.62248622]


portfolio before change:  [7.9333044]
curr_Stock_Price:  102.14527155951573
curr_Factors:  [102.14527156]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987182]
Stock Position:  -0.14987182343450875
Bond Position:  [23.2420025]


portfolio before change:  [7.8519364]
curr_Stock_Price:  102.69788161332995
curr_Factors:  [102.69788161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00725544]
Stock Position:  -0.007255442524822907
Bond Position:  [8.59705497]


portfolio before change:  [7.85613466]
curr_Stock_Price:  102.19330404743488
curr_Factors:  [102.19330405]
mat_Sqrt:  [[0.15]]
grads:  [-0.06885032]
Stock Position:  -0.06885032419866977
Bond Position:  [14.89217678]


portfolio before change:  [7.88152788]
curr_Stock_Price:  101.83800532735167
curr_Factors:  [101.83800533]
mat_Sqrt:  [[0.15]]
grads:  [-0.01192433]
Stock Position:  -0.011924332138603406
Bond Position:  [9.09587808]


portfolio before change:  [7.89505511]
curr_Stock_Price:  100.75125970607546
curr_Factors:  [100.75125971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.89505511]
Stock Price:  101.02228287643443
PL:  [6.87277223]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.07537940e-03]
 [ 1.71694857e-03]
 [-9.01335374e-04]
 [ 7.00177632e-03]
 [ 3.30164292e-03]
 [ 1.79375332e-02]
 [ 1.21931392e-03]
 [-1.76282726e-02]
 [ 7.80733272e-03]
 [ 1.90202053e-02]
 [ 1.35014938e-02]
 [-9.95390203e-03]
 [-2.00138755e-03]
 [ 1.23973594e-02]
 [-6.96005930e-03]
 [ 6.04104665e-03]
 [ 7.18189217e-03]
 [-1.17917407e-02]
 [-2.49619239e-04]
 [ 1.38921806e-02]
 [ 1.13431416e-02]
 [-8.06171768e-03]
 [ 6.80492913e-03]
 [ 3.71554516e-02]
 [-5.86374094e-03]
 [ 2.33284636e-03]
 [-3.96982220e-03]
 [ 6.31247633e-03]
 [-1.22468408e-02]
 [-1.84817124e-03]
 [-3.92262063e-03]
 [-1.13230343e-02]
 [ 2.70946256e-03]
 [ 7.07941292e-03]
 [ 1.14845539e-02]
 [ 9.48233247e-03]
 [-3.44054643e-02]
 [ 9.58945091e-03]
 [-1.45243589e-02]
 [ 2.42244018e-02]
 [-4.78545644e-03]
 [ 3.01618549e-02]
 [ 2.32078434e-02]
 [ 3.94934090e-03]
 [ 6.19161875e-03]
 [ 5.68607554e-03]
 [ 4.53329103e-04]
 [-1.08707383e-02]
 [ 8.32915867e-03]
 [ 4.56324776e-03]
 [ 3.58799888e-02]
 [-6.37321654e-04]
 [ 1.62585227e-03]
 [ 4.90665075e-03]
 [ 4.53256870e-03]
 [-1.12713146e-03]
 [ 4.67415641e-03]
 [-6.38742066e-04]
 [ 1.53632982e-03]
 [ 1.01330313e-04]
 [ 1.25228176e-03]
 [-2.60661857e-03]
 [ 3.41082462e-03]
 [-1.60113198e-02]
 [-1.14235046e-02]
 [-7.70766871e-04]
 [-5.00146761e-03]
 [ 2.12294748e-02]
 [-9.94316065e-03]
 [ 8.95145492e-03]
 [ 1.21165062e-03]
 [ 1.19441842e-02]
 [ 1.68583842e-03]
 [ 3.29512933e-03]
 [-9.12346797e-03]
 [-1.15832743e-02]
 [ 4.75877263e-03]
 [ 5.69491181e-03]
 [-3.26383912e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.40375105]
curr_Stock_Price:  99.7759677010772
curr_Factors:  [99.7759677]
mat_Sqrt:  [[0.15]]
grads:  [0.02050253]
Stock Position:  0.020502529353990485
Bond Position:  [-3.44941076]


portfolio before change:  [-1.40129195]
curr_Stock_Price:  99.90642473159022
curr_Factors:  [99.90642473]
mat_Sqrt:  [[0.15]]
grads:  [0.01144632]
Stock Position:  0.01144632379586852
Bond Position:  [-2.54485324]


portfolio before change:  [-1.40678001]
curr_Stock_Price:  99.44086019139495
curr_Factors:  [99.44086019]
mat_Sqrt:  [[0.15]]
grads:  [-0.0060089]
Stock Position:  -0.006008902496139624
Bond Position:  [-0.80924958]


portfolio before change:  [-1.40339143]
curr_Stock_Price:  98.86851555846421
curr_Factors:  [98.86851556]
mat_Sqrt:  [[0.15]]
grads:  [0.04667851]
Stock Position:  0.046678508778335334
Bond Position:  [-6.0184263]


portfolio before change:  [-1.37985221]
curr_Stock_Price:  99.38085807630098
curr_Factors:  [99.38085808]
mat_Sqrt:  [[0.15]]
grads:  [0.02201095]
Stock Position:  0.022010952814238233
Bond Position:  [-3.56731958]


portfolio before change:  [-1.38843364]
curr_Stock_Price:  99.00111654582632
curr_Factors:  [99.00111655]
mat_Sqrt:  [[0.15]]
grads:  [0.11958355]
Stock Position:  0.1195835548191151
Bond Position:  [-13.22733909]


portfolio before change:  [-1.36772899]
curr_Stock_Price:  99.18116963182236
curr_Factors:  [99.18116963]
mat_Sqrt:  [[0.15]]
grads:  [0.00812876]
Stock Position:  0.008128759471802284
Bond Position:  [-2.17394886]


portfolio before change:  [-1.36877249]
curr_Stock_Price:  99.06951303331147
curr_Factors:  [99.06951303]
mat_Sqrt:  [[0.15]]
grads:  [-0.11752182]
Stock Position:  -0.11752181739747541
Bond Position:  [10.27405673]


portfolio before change:  [-1.3854585]
curr_Stock_Price:  99.21695926679402
curr_Factors:  [99.21695927]
mat_Sqrt:  [[0.15]]
grads:  [0.05204888]
Stock Position:  0.05204888481587139
Bond Position:  [-6.54959058]


portfolio before change:  [-1.38893754]
curr_Stock_Price:  99.1579823297956
curr_Factors:  [99.15798233]
mat_Sqrt:  [[0.15]]
grads:  [0.12680137]
Stock Position:  0.12680136871818207
Bond Position:  [-13.96230542]


portfolio before change:  [-1.31869221]
curr_Stock_Price:  99.7188437981954
curr_Factors:  [99.7188438]
mat_Sqrt:  [[0.15]]
grads:  [0.09000996]
Stock Position:  0.09000995852221294
Bond Position:  [-10.29438121]


portfolio before change:  [-1.28936687]
curr_Stock_Price:  100.05179315491898
curr_Factors:  [100.05179315]
mat_Sqrt:  [[0.15]]
grads:  [-0.06635935]
Stock Position:  -0.06635934685556988
Bond Position:  [5.35000477]


portfolio before change:  [-1.27030447]
curr_Stock_Price:  99.76957191364231
curr_Factors:  [99.76957191]
mat_Sqrt:  [[0.15]]
grads:  [-0.01334258]
Stock Position:  -0.013342583652807076
Bond Position:  [0.06087939]


portfolio before change:  [-1.26622854]
curr_Stock_Price:  99.46437411832136
curr_Factors:  [99.46437412]
mat_Sqrt:  [[0.15]]
grads:  [0.08264906]
Stock Position:  0.08264906244359
Bond Position:  [-9.4868658]


portfolio before change:  [-1.32346705]
curr_Stock_Price:  98.77899950360002
curr_Factors:  [98.7789995]
mat_Sqrt:  [[0.15]]
grads:  [-0.0464004]
Stock Position:  -0.046400395301657155
Bond Position:  [3.25991757]


portfolio before change:  [-1.32131911]
curr_Stock_Price:  98.73709920804059
curr_Factors:  [98.73709921]
mat_Sqrt:  [[0.15]]
grads:  [0.04027364]
Stock Position:  0.04027364432337015
Bond Position:  [-5.29782193]


portfolio before change:  [-1.30528273]
curr_Stock_Price:  99.14350667854838
curr_Factors:  [99.14350668]
mat_Sqrt:  [[0.15]]
grads:  [0.04787928]
Stock Position:  0.0478792811345224
Bond Position:  [-6.05220256]


portfolio before change:  [-1.29108368]
curr_Stock_Price:  99.44796647622991
curr_Factors:  [99.44796648]
mat_Sqrt:  [[0.15]]
grads:  [-0.0786116]
Stock Position:  -0.0786116049021987
Bond Position:  [6.52668056]


portfolio before change:  [-1.26768046]
curr_Stock_Price:  99.15544871985838
curr_Factors:  [99.15544872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00166413]
Stock Position:  -0.001664128257692788
Bond Position:  [-1.10267308]


portfolio before change:  [-1.26890633]
curr_Stock_Price:  99.85067681304888
curr_Factors:  [99.85067681]
mat_Sqrt:  [[0.15]]
grads:  [0.09261454]
Stock Position:  0.0926145372370703
Bond Position:  [-10.51653056]


portfolio before change:  [-1.26632781]
curr_Stock_Price:  99.88561547210924
curr_Factors:  [99.88561547]
mat_Sqrt:  [[0.15]]
grads:  [0.07562094]
Stock Position:  0.07562094391598205
Bond Position:  [-8.81977233]


portfolio before change:  [-1.27026079]
curr_Stock_Price:  99.84089605983377
curr_Factors:  [99.84089606]
mat_Sqrt:  [[0.15]]
grads:  [-0.05374478]
Stock Position:  -0.05374478454193981
Bond Position:  [4.09566666]


portfolio before change:  [-1.27399964]
curr_Stock_Price:  99.91522589133594
curr_Factors:  [99.91522589]
mat_Sqrt:  [[0.15]]
grads:  [0.04536619]
Stock Position:  0.045366194207908606
Bond Position:  [-5.80677318]


portfolio before change:  [-1.28916917]
curr_Stock_Price:  99.5888464282174
curr_Factors:  [99.58884643]
mat_Sqrt:  [[0.15]]
grads:  [0.24770301]
Stock Position:  0.24770301034451928
Bond Position:  [-25.95762622]


portfolio before change:  [-1.30129967]
curr_Stock_Price:  99.54642424685464
curr_Factors:  [99.54642425]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909161]
Stock Position:  -0.039091606273935306
Bond Position:  [2.59012995]


portfolio before change:  [-1.29464461]
curr_Stock_Price:  99.38032276291737
curr_Factors:  [99.38032276]
mat_Sqrt:  [[0.15]]
grads:  [0.01555231]
Stock Position:  0.015552309061488806
Bond Position:  [-2.8402381]


portfolio before change:  [-1.31116082]
curr_Stock_Price:  98.3297592635557
curr_Factors:  [98.32975926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02646548]
Stock Position:  -0.026465481309356383
Bond Position:  [1.29118359]


portfolio before change:  [-1.32819074]
curr_Stock_Price:  98.97628516805885
curr_Factors:  [98.97628517]
mat_Sqrt:  [[0.15]]
grads:  [0.04208318]
Stock Position:  0.04208317553083516
Bond Position:  [-5.49342712]


portfolio before change:  [-1.32099013]
curr_Stock_Price:  99.15554819545015
curr_Factors:  [99.1555482]
mat_Sqrt:  [[0.15]]
grads:  [-0.08164561]
Stock Position:  -0.08164560521220658
Bond Position:  [6.77462461]


portfolio before change:  [-1.34719062]
curr_Stock_Price:  99.48163948596448
curr_Factors:  [99.48163949]
mat_Sqrt:  [[0.15]]
grads:  [-0.01232114]
Stock Position:  -0.012321141603510296
Bond Position:  [-0.12146326]


portfolio before change:  [-1.3357056]
curr_Stock_Price:  98.54888419698605
curr_Factors:  [98.5488842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261508]
Stock Position:  -0.026150804201736027
Bond Position:  [1.24142697]


portfolio before change:  [-1.37220181]
curr_Stock_Price:  99.94745659193698
curr_Factors:  [99.94745659]
mat_Sqrt:  [[0.15]]
grads:  [-0.0754869]
Stock Position:  -0.07548689545265282
Bond Position:  [6.1725214]


portfolio before change:  [-1.38514461]
curr_Stock_Price:  100.12402493357041
curr_Factors:  [100.12402493]
mat_Sqrt:  [[0.15]]
grads:  [0.01806308]
Stock Position:  0.018063083720804767
Bond Position:  [-3.19369325]


portfolio before change:  [-1.37354263]
curr_Stock_Price:  100.77737872788288
curr_Factors:  [100.77737873]
mat_Sqrt:  [[0.15]]
grads:  [0.04719609]
Stock Position:  0.047196086153561474
Bond Position:  [-6.12984048]


portfolio before change:  [-1.36889074]
curr_Stock_Price:  100.88406171561633
curr_Factors:  [100.88406172]
mat_Sqrt:  [[0.15]]
grads:  [0.07656369]
Stock Position:  0.076563692717604
Bond Position:  [-9.09294704]


portfolio before change:  [-1.37340875]
curr_Stock_Price:  100.83247484824683
curr_Factors:  [100.83247485]
mat_Sqrt:  [[0.15]]
grads:  [0.06321555]
Stock Position:  0.06321554981389875
Bond Position:  [-7.74758909]


portfolio before change:  [-1.40336099]
curr_Stock_Price:  100.36632378716418
curr_Factors:  [100.36632379]
mat_Sqrt:  [[0.15]]
grads:  [-0.22936976]
Stock Position:  -0.2293697617035298
Bond Position:  [21.61763878]


portfolio before change:  [-1.25474663]
curr_Stock_Price:  99.72428965946128
curr_Factors:  [99.72428966]
mat_Sqrt:  [[0.15]]
grads:  [0.06392967]
Stock Position:  0.06392967275345718
Bond Position:  [-7.63008783]


portfolio before change:  [-1.29056586]
curr_Stock_Price:  99.1714580849648
curr_Factors:  [99.17145808]
mat_Sqrt:  [[0.15]]
grads:  [-0.09682906]
Stock Position:  -0.09682905960419554
Bond Position:  [8.31211316]


portfolio before change:  [-1.24912814]
curr_Stock_Price:  98.74887626678941
curr_Factors:  [98.74887627]
mat_Sqrt:  [[0.15]]
grads:  [0.16149601]
Stock Position:  0.16149601192404853
Bond Position:  [-17.19667784]


portfolio before change:  [-1.25535029]
curr_Stock_Price:  98.71700352779351
curr_Factors:  [98.71700353]
mat_Sqrt:  [[0.15]]
grads:  [-0.03190304]
Stock Position:  -0.031903042951853804
Bond Position:  [1.89402252]


portfolio before change:  [-1.20369736]
curr_Stock_Price:  97.10165473606537
curr_Factors:  [97.10165474]
mat_Sqrt:  [[0.15]]
grads:  [0.20107903]
Stock Position:  0.2010790328688573
Bond Position:  [-20.72880419]


portfolio before change:  [-1.33456481]
curr_Stock_Price:  96.45727202550344
curr_Factors:  [96.45727203]
mat_Sqrt:  [[0.15]]
grads:  [0.15471896]
Stock Position:  0.15471895609835237
Bond Position:  [-16.25833324]


portfolio before change:  [-1.38373347]
curr_Stock_Price:  96.14604652697508
curr_Factors:  [96.14604653]
mat_Sqrt:  [[0.15]]
grads:  [0.02632894]
Stock Position:  0.026328939349630882
Bond Position:  [-3.9151569]


portfolio before change:  [-1.38940657]
curr_Stock_Price:  95.93987057128135
curr_Factors:  [95.93987057]
mat_Sqrt:  [[0.15]]
grads:  [0.04127746]
Stock Position:  0.041277458357377034
Bond Position:  [-5.34956058]


portfolio before change:  [-1.3561295]
curr_Stock_Price:  96.75415099971072
curr_Factors:  [96.754151]
mat_Sqrt:  [[0.15]]
grads:  [0.03790717]
Stock Position:  0.03790717024523491
Bond Position:  [-5.02380557]


portfolio before change:  [-1.36388812]
curr_Stock_Price:  96.55776002586386
curr_Factors:  [96.55776003]
mat_Sqrt:  [[0.15]]
grads:  [0.00302219]
Stock Position:  0.003022194018725046
Bond Position:  [-1.65570441]


portfolio before change:  [-1.36469124]
curr_Stock_Price:  96.32626210957062
curr_Factors:  [96.32626211]
mat_Sqrt:  [[0.15]]
grads:  [-0.07247159]
Stock Position:  -0.07247158849439525
Bond Position:  [5.61622599]


portfolio before change:  [-1.3347245]
curr_Stock_Price:  95.91760937045672
curr_Factors:  [95.91760937]
mat_Sqrt:  [[0.15]]
grads:  [0.05552772]
Stock Position:  0.05552772443505583
Bond Position:  [-6.66081108]


portfolio before change:  [-1.36013658]
curr_Stock_Price:  95.46746010374639
curr_Factors:  [95.4674601]
mat_Sqrt:  [[0.15]]
grads:  [0.03042165]
Stock Position:  0.030421651745291257
Bond Position:  [-4.2644144]


portfolio before change:  [-1.35341616]
curr_Stock_Price:  95.69713061245952
curr_Factors:  [95.69713061]
mat_Sqrt:  [[0.15]]
grads:  [0.23919993]
Stock Position:  0.23919992537386522
Bond Position:  [-24.24416266]


portfolio before change:  [-1.23368891]
curr_Stock_Price:  96.20399761904807
curr_Factors:  [96.20399762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00424881]
Stock Position:  -0.0042488110241114055
Bond Position:  [-0.82493631]


portfolio before change:  [-1.23243584]
curr_Stock_Price:  95.89693852325448
curr_Factors:  [95.89693852]
mat_Sqrt:  [[0.15]]
grads:  [0.01083902]
Stock Position:  0.010839015131802425
Bond Position:  [-2.27186421]


portfolio before change:  [-1.22664083]
curr_Stock_Price:  96.44468239595702
curr_Factors:  [96.4446824]
mat_Sqrt:  [[0.15]]
grads:  [0.03271101]
Stock Position:  0.03271100500949908
Bond Position:  [-4.38144332]


portfolio before change:  [-1.20421365]
curr_Stock_Price:  97.1386699990514
curr_Factors:  [97.13867]
mat_Sqrt:  [[0.15]]
grads:  [0.03021712]
Stock Position:  0.03021712464948984
Bond Position:  [-4.13946495]


portfolio before change:  [-1.20433994]
curr_Stock_Price:  97.14305267508145
curr_Factors:  [97.14305268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00751421]
Stock Position:  -0.007514209714929998
Bond Position:  [-0.47438667]


portfolio before change:  [-1.20733444]
curr_Stock_Price:  97.53761906865776
curr_Factors:  [97.53761907]
mat_Sqrt:  [[0.15]]
grads:  [0.03116104]
Stock Position:  0.03116104275724966
Bond Position:  [-4.24670836]


portfolio before change:  [-1.19335168]
curr_Stock_Price:  97.99486272241772
curr_Factors:  [97.99486272]
mat_Sqrt:  [[0.15]]
grads:  [-0.00425828]
Stock Position:  -0.004258280441173755
Bond Position:  [-0.77606208]


portfolio before change:  [-1.19482076]
curr_Stock_Price:  98.32846378326589
curr_Factors:  [98.32846378]
mat_Sqrt:  [[0.15]]
grads:  [0.0102422]
Stock Position:  0.010242198828681623
Bond Position:  [-2.20192043]


portfolio before change:  [-1.1877743]
curr_Stock_Price:  99.02988296529618
curr_Factors:  [99.02988297]
mat_Sqrt:  [[0.15]]
grads:  [0.00067554]
Stock Position:  0.0006755354189975221
Bond Position:  [-1.2546725]


portfolio before change:  [-1.18785647]
curr_Stock_Price:  99.02433546583563
curr_Factors:  [99.02433547]
mat_Sqrt:  [[0.15]]
grads:  [0.00834855]
Stock Position:  0.008348545034360874
Bond Position:  [-2.0145656]


portfolio before change:  [-1.18999391]
curr_Stock_Price:  98.78339261683894
curr_Factors:  [98.78339262]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737746]
Stock Position:  -0.017377457155976682
Bond Position:  [0.52661026]


portfolio before change:  [-1.18772973]
curr_Stock_Price:  98.65499248361209
curr_Factors:  [98.65499248]
mat_Sqrt:  [[0.15]]
grads:  [0.02273883]
Stock Position:  0.02273883078663344
Bond Position:  [-3.43102891]


portfolio before change:  [-1.1645764]
curr_Stock_Price:  99.68265206070517
curr_Factors:  [99.68265206]
mat_Sqrt:  [[0.15]]
grads:  [-0.10674213]
Stock Position:  -0.10674213212107915
Bond Position:  [9.47576242]


portfolio before change:  [-1.17518486]
curr_Stock_Price:  99.78758455150766
curr_Factors:  [99.78758455]
mat_Sqrt:  [[0.15]]
grads:  [-0.0761567]
Stock Position:  -0.07615669714707798
Bond Position:  [6.424308]


portfolio before change:  [-1.11990408]
curr_Stock_Price:  99.06697498989945
curr_Factors:  [99.06697499]
mat_Sqrt:  [[0.15]]
grads:  [-0.00513845]
Stock Position:  -0.005138445807740788
Bond Position:  [-0.6108538]


portfolio before change:  [-1.11902426]
curr_Stock_Price:  98.88832157042441
curr_Factors:  [98.88832157]
mat_Sqrt:  [[0.15]]
grads:  [-0.03334312]
Stock Position:  -0.033343117377725086
Bond Position:  [2.17822065]


portfolio before change:  [-1.11451613]
curr_Stock_Price:  98.75720042274946
curr_Factors:  [98.75720042]
mat_Sqrt:  [[0.15]]
grads:  [0.14152983]
Stock Position:  0.14152983175770126
Bond Position:  [-15.09160609]


portfolio before change:  [-1.21098536]
curr_Stock_Price:  98.08224748160119
curr_Factors:  [98.08224748]
mat_Sqrt:  [[0.15]]
grads:  [-0.06628774]
Stock Position:  -0.06628773767125136
Bond Position:  [5.29066493]


portfolio before change:  [-1.13558455]
curr_Stock_Price:  96.9497585023264
curr_Factors:  [96.9497585]
mat_Sqrt:  [[0.15]]
grads:  [0.05967637]
Stock Position:  0.05967636612960349
Bond Position:  [-6.92119384]


portfolio before change:  [-1.17577337]
curr_Stock_Price:  96.28356135077364
curr_Factors:  [96.28356135]
mat_Sqrt:  [[0.15]]
grads:  [0.00807767]
Stock Position:  0.008077670806752268
Bond Position:  [-1.95352028]


portfolio before change:  [-1.17790905]
curr_Stock_Price:  96.03428366103539
curr_Factors:  [96.03428366]
mat_Sqrt:  [[0.15]]
grads:  [0.07962789]
Stock Position:  0.07962789493412253
Bond Position:  [-8.8249169]


portfolio before change:  [-1.15099119]
curr_Stock_Price:  96.3792561620876
curr_Factors:  [96.37925616]
mat_Sqrt:  [[0.15]]
grads:  [0.01123892]
Stock Position:  0.011238922786082418
Bond Position:  [-2.23419021]


portfolio before change:  [-1.14654521]
curr_Stock_Price:  96.78726878157474
curr_Factors:  [96.78726878]
mat_Sqrt:  [[0.15]]
grads:  [0.02196753]
Stock Position:  0.021967528879088517
Bond Position:  [-3.27272233]


portfolio before change:  [-1.13545252]
curr_Stock_Price:  97.30153852896275
curr_Factors:  [97.30153853]
mat_Sqrt:  [[0.15]]
grads:  [-0.06082312]
Stock Position:  -0.06082311980111566
Bond Position:  [4.78273061]


portfolio before change:  [-1.11016347]
curr_Stock_Price:  96.89067305151345
curr_Factors:  [96.89067305]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722183]
Stock Position:  -0.07722182899746764
Bond Position:  [6.37191151]


portfolio before change:  [-1.06896837]
curr_Stock_Price:  96.36236587742158
curr_Factors:  [96.36236588]
mat_Sqrt:  [[0.15]]
grads:  [0.03172515]
Stock Position:  0.03172515085575562
Bond Position:  [-4.12607896]


portfolio before change:  [-1.08335296]
curr_Stock_Price:  95.91708177574671
curr_Factors:  [95.91708178]
mat_Sqrt:  [[0.15]]
grads:  [0.03796608]
Stock Position:  0.03796607875152291
Bond Position:  [-4.72494844]


portfolio before change:  [-1.09013964]
curr_Stock_Price:  95.74610386456432
curr_Factors:  [95.74610386]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09013964]
Stock Price:  95.21925946599657
PL:  [-1.09013964]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.98910740e-03]
 [ 2.58435111e-03]
 [-3.48221397e-03]
 [ 3.40032950e-03]
 [ 1.65976105e-02]
 [ 2.85782273e-02]
 [ 1.61692557e-03]
 [-1.68101491e-02]
 [ 2.04765861e-02]
 [-4.42899264e-03]
 [ 1.30270980e-02]
 [-4.24560316e-02]
 [ 2.38543074e-02]
 [ 5.31204718e-03]
 [-6.90798481e-03]
 [ 1.90277279e-02]
 [ 1.05884514e-02]
 [-1.10243906e-02]
 [ 7.61227924e-04]
 [-5.94766695e-03]
 [ 1.47489508e-02]
 [-1.47055699e-02]
 [ 1.08233672e-02]
 [-6.89473257e-02]
 [ 9.64170874e-03]
 [ 5.64369604e-03]
 [-3.40571481e-03]
 [ 2.67115667e-02]
 [ 7.65414417e-02]
 [ 1.41397692e-02]
 [ 2.48802531e-02]
 [ 1.89942089e-02]
 [-1.00559502e-02]
 [ 5.44257436e-03]
 [ 9.21150948e-03]
 [-1.34034974e-03]
 [-3.06518680e-02]
 [ 8.09761902e-03]
 [ 2.55166930e-02]
 [-2.54924450e-02]
 [-9.68050834e-03]
 [-1.03333473e-02]
 [ 1.96535336e-02]
 [-6.17675991e-03]
 [ 1.45047514e-02]
 [-1.62949786e-02]
 [ 1.48593729e-02]
 [ 1.17341019e-02]
 [ 4.32522395e-03]
 [-7.41535314e-03]
 [-3.84361114e-02]
 [ 2.40938851e-03]
 [-8.66326466e-03]
 [ 5.74710347e-03]
 [-1.04058662e-02]
 [ 9.98955785e-03]
 [ 1.05482517e-02]
 [ 1.91469488e-04]
 [ 1.76566708e-03]
 [ 1.22170838e-02]
 [ 1.12799605e-02]
 [ 2.97576222e-02]
 [ 2.95686896e-03]
 [-1.25037452e-02]
 [ 1.05333712e-02]
 [ 3.70671360e-03]
 [-5.39262931e-03]
 [ 1.50052666e-02]
 [-8.39173653e-03]
 [ 9.82405181e-03]
 [-1.17891742e-02]
 [ 1.22206974e-02]
 [ 3.44890268e-04]
 [ 1.96257218e-02]
 [-2.27206207e-02]
 [-3.94241801e-04]
 [-7.24657195e-03]
 [-6.55430044e-03]
 [ 3.05732514e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.44552332]
curr_Stock_Price:  99.96124165022633
curr_Factors:  [99.96124165]
mat_Sqrt:  [[0.15]]
grads:  [0.01326072]
Stock Position:  0.013260716007532604
Bond Position:  [0.11996568]


portfolio before change:  [1.45163633]
curr_Stock_Price:  100.42166281686562
curr_Factors:  [100.42166282]
mat_Sqrt:  [[0.15]]
grads:  [0.01722901]
Stock Position:  0.01722900740782676
Bond Position:  [-0.27852924]


portfolio before change:  [1.45750192]
curr_Stock_Price:  100.76312130682865
curr_Factors:  [100.76312131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321476]
Stock Position:  -0.023214759794136272
Bond Position:  [3.79669357]


portfolio before change:  [1.4470911]
curr_Stock_Price:  101.22180020841495
curr_Factors:  [101.22180021]
mat_Sqrt:  [[0.15]]
grads:  [0.02266886]
Stock Position:  0.022668863363112555
Bond Position:  [-0.84749206]


portfolio before change:  [1.44828621]
curr_Stock_Price:  101.27685739941602
curr_Factors:  [101.2768574]
mat_Sqrt:  [[0.15]]
grads:  [0.11065074]
Stock Position:  0.11065073684391724
Bond Position:  [-9.75807269]


portfolio before change:  [1.39193895]
curr_Stock_Price:  100.7731340007521
curr_Factors:  [100.773134]
mat_Sqrt:  [[0.15]]
grads:  [0.19052152]
Stock Position:  0.1905215152992034
Bond Position:  [-17.80751124]


portfolio before change:  [1.29414374]
curr_Stock_Price:  100.26567316682629
curr_Factors:  [100.26567317]
mat_Sqrt:  [[0.15]]
grads:  [0.0107795]
Stock Position:  0.010779503784301384
Bond Position:  [0.21332953]


portfolio before change:  [1.29201776]
curr_Stock_Price:  100.0672118670159
curr_Factors:  [100.06721187]
mat_Sqrt:  [[0.15]]
grads:  [-0.11206766]
Stock Position:  -0.11206766081984175
Bond Position:  [12.50631611]


portfolio before change:  [1.28779948]
curr_Stock_Price:  100.11182728720603
curr_Factors:  [100.11182729]
mat_Sqrt:  [[0.15]]
grads:  [0.13651057]
Stock Position:  0.13651057391670793
Bond Position:  [-12.37852352]


portfolio before change:  [1.38000619]
curr_Stock_Price:  100.79294954401276
curr_Factors:  [100.79294954]
mat_Sqrt:  [[0.15]]
grads:  [-0.02952662]
Stock Position:  -0.02952661761815204
Bond Position:  [4.35608107]


portfolio before change:  [1.40493919]
curr_Stock_Price:  99.9577459305178
curr_Factors:  [99.95774593]
mat_Sqrt:  [[0.15]]
grads:  [0.08684732]
Stock Position:  0.08684731976972414
Bond Position:  [-7.27612314]


portfolio before change:  [1.51064609]
curr_Stock_Price:  101.18014026651566
curr_Factors:  [101.18014027]
mat_Sqrt:  [[0.15]]
grads:  [-0.28304021]
Stock Position:  -0.2830402109322433
Bond Position:  [30.14869433]


portfolio before change:  [1.57831813]
curr_Stock_Price:  100.94770796268382
curr_Factors:  [100.94770796]
mat_Sqrt:  [[0.15]]
grads:  [0.15902872]
Stock Position:  0.15902871621974005
Bond Position:  [-14.47526627]


portfolio before change:  [1.68619989]
curr_Stock_Price:  101.63177618594219
curr_Factors:  [101.63177619]
mat_Sqrt:  [[0.15]]
grads:  [0.03541365]
Stock Position:  0.035413647854299596
Bond Position:  [-1.91295204]


portfolio before change:  [1.66384023]
curr_Stock_Price:  101.00376691146208
curr_Factors:  [101.00376691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605323]
Stock Position:  -0.04605323204998956
Bond Position:  [6.31539014]


portfolio before change:  [1.66441176]
curr_Stock_Price:  100.99992765803206
curr_Factors:  [100.99992766]
mat_Sqrt:  [[0.15]]
grads:  [0.12685152]
Stock Position:  0.12685151913514658
Bond Position:  [-11.1475825]


portfolio before change:  [1.70339523]
curr_Stock_Price:  101.31273602293096
curr_Factors:  [101.31273602]
mat_Sqrt:  [[0.15]]
grads:  [0.07058968]
Stock Position:  0.07058967606294513
Bond Position:  [-5.44823799]


portfolio before change:  [1.71300707]
curr_Stock_Price:  101.45372495978853
curr_Factors:  [101.45372496]
mat_Sqrt:  [[0.15]]
grads:  [-0.07349594]
Stock Position:  -0.07349593761524882
Bond Position:  [9.16944371]


portfolio before change:  [1.70680679]
curr_Stock_Price:  101.54588501373165
curr_Factors:  [101.54588501]
mat_Sqrt:  [[0.15]]
grads:  [0.00507485]
Stock Position:  0.005074852825552402
Bond Position:  [1.19147636]


portfolio before change:  [1.7115502]
curr_Stock_Price:  102.46590161453699
curr_Factors:  [102.46590161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03965111]
Stock Position:  -0.03965111301227272
Bond Position:  [5.77443725]


portfolio before change:  [1.65907522]
curr_Stock_Price:  103.79842157359614
curr_Factors:  [103.79842157]
mat_Sqrt:  [[0.15]]
grads:  [0.09832634]
Stock Position:  0.09832633850539342
Bond Position:  [-8.54704352]


portfolio before change:  [1.70197821]
curr_Stock_Price:  104.24018726076064
curr_Factors:  [104.24018726]
mat_Sqrt:  [[0.15]]
grads:  [-0.09803713]
Stock Position:  -0.09803713286517944
Bond Position:  [11.9213873]


portfolio before change:  [1.71275567]
curr_Stock_Price:  104.13785519609888
curr_Factors:  [104.1378552]
mat_Sqrt:  [[0.15]]
grads:  [0.07215578]
Stock Position:  0.07215578140091541
Bond Position:  [-5.80139265]


portfolio before change:  [1.75171443]
curr_Stock_Price:  104.68280609451188
curr_Factors:  [104.68280609]
mat_Sqrt:  [[0.15]]
grads:  [-0.45964884]
Stock Position:  -0.4596488379208024
Bond Position:  [49.8690446]


portfolio before change:  [1.91484047]
curr_Stock_Price:  104.33469441518857
curr_Factors:  [104.33469442]
mat_Sqrt:  [[0.15]]
grads:  [0.06427806]
Stock Position:  0.06427805828337539
Bond Position:  [-4.7915911]


portfolio before change:  [1.98782875]
curr_Stock_Price:  105.47486213278988
curr_Factors:  [105.47486213]
mat_Sqrt:  [[0.15]]
grads:  [0.03762464]
Stock Position:  0.03762464029826941
Bond Position:  [-1.980625]


portfolio before change:  [2.00262058]
curr_Stock_Price:  105.87129452544883
curr_Factors:  [105.87129453]
mat_Sqrt:  [[0.15]]
grads:  [-0.02270477]
Stock Position:  -0.022704765428856116
Bond Position:  [4.40640349]


portfolio before change:  [1.98521247]
curr_Stock_Price:  106.65014104980098
curr_Factors:  [106.65014105]
mat_Sqrt:  [[0.15]]
grads:  [0.17807711]
Stock Position:  0.17807711157108794
Bond Position:  [-17.0067366]


portfolio before change:  [1.97360903]
curr_Stock_Price:  106.59095049466256
curr_Factors:  [106.59095049]
mat_Sqrt:  [[0.15]]
grads:  [0.51027628]
Stock Position:  0.5102762782839765
Bond Position:  [-52.41722449]


portfolio before change:  [2.28394074]
curr_Stock_Price:  107.20553499626814
curr_Factors:  [107.205535]
mat_Sqrt:  [[0.15]]
grads:  [0.09426513]
Stock Position:  0.09426512803862817
Bond Position:  [-7.82180274]


portfolio before change:  [2.26410762]
curr_Stock_Price:  107.00032401149348
curr_Factors:  [107.00032401]
mat_Sqrt:  [[0.15]]
grads:  [0.16586835]
Stock Position:  0.16586835390830568
Bond Position:  [-15.48385999]


portfolio before change:  [2.32582355]
curr_Stock_Price:  107.37823635249198
curr_Factors:  [107.37823635]
mat_Sqrt:  [[0.15]]
grads:  [0.12662806]
Stock Position:  0.12662805926735227
Bond Position:  [-11.27127413]


portfolio before change:  [2.48949425]
curr_Stock_Price:  108.67633080305967
curr_Factors:  [108.6763308]
mat_Sqrt:  [[0.15]]
grads:  [-0.06703967]
Stock Position:  -0.06703966780191652
Bond Position:  [9.77511937]


portfolio before change:  [2.46150907]
curr_Stock_Price:  109.10288643702562
curr_Factors:  [109.10288644]
mat_Sqrt:  [[0.15]]
grads:  [0.03628383]
Stock Position:  0.03628382905463461
Bond Position:  [-1.49716141]


portfolio before change:  [2.4630343]
curr_Stock_Price:  109.14750147154963
curr_Factors:  [109.14750147]
mat_Sqrt:  [[0.15]]
grads:  [0.06141006]
Stock Position:  0.061410063203890045
Bond Position:  [-4.23972066]


portfolio before change:  [2.43920574]
curr_Stock_Price:  108.76379281601236
curr_Factors:  [108.76379282]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893566]
Stock Position:  -0.008935664929616421
Bond Position:  [3.41108254]


portfolio before change:  [2.4451459]
curr_Stock_Price:  108.12288144830269
curr_Factors:  [108.12288145]
mat_Sqrt:  [[0.15]]
grads:  [-0.20434579]
Stock Position:  -0.20434578653049365
Bond Position:  [24.53960116]


portfolio before change:  [2.48110471]
curr_Stock_Price:  107.95441683935681
curr_Factors:  [107.95441684]
mat_Sqrt:  [[0.15]]
grads:  [0.05398413]
Stock Position:  0.05398412678993358
Bond Position:  [-3.34672022]


portfolio before change:  [2.45890514]
curr_Stock_Price:  107.54706759952751
curr_Factors:  [107.5470676]
mat_Sqrt:  [[0.15]]
grads:  [0.17011129]
Stock Position:  0.1701112864230883
Bond Position:  [-15.83606488]


portfolio before change:  [2.47889846]
curr_Stock_Price:  107.67041688985766
curr_Factors:  [107.67041689]
mat_Sqrt:  [[0.15]]
grads:  [-0.16994963]
Stock Position:  -0.16994963305229127
Bond Position:  [20.7774463]


portfolio before change:  [2.47976987]
curr_Stock_Price:  107.67293070748535
curr_Factors:  [107.67293071]
mat_Sqrt:  [[0.15]]
grads:  [-0.06453672]
Stock Position:  -0.06453672226841539
Bond Position:  [9.4286279]


portfolio before change:  [2.49827051]
curr_Stock_Price:  107.3953936307802
curr_Factors:  [107.39539363]
mat_Sqrt:  [[0.15]]
grads:  [-0.06888898]
Stock Position:  -0.06888898190015795
Bond Position:  [9.89662984]


portfolio before change:  [2.53434911]
curr_Stock_Price:  106.88065187159214
curr_Factors:  [106.88065187]
mat_Sqrt:  [[0.15]]
grads:  [0.13102356]
Stock Position:  0.13102355715250436
Bond Position:  [-11.46953409]


portfolio before change:  [2.40848674]
curr_Stock_Price:  105.92551446904383
curr_Factors:  [105.92551447]
mat_Sqrt:  [[0.15]]
grads:  [-0.0411784]
Stock Position:  -0.04117839943284811
Bond Position:  [6.77032988]


portfolio before change:  [2.43792384]
curr_Stock_Price:  105.22092321970932
curr_Factors:  [105.22092322]
mat_Sqrt:  [[0.15]]
grads:  [0.09669834]
Stock Position:  0.09669834285908388
Bond Position:  [-7.73676507]


portfolio before change:  [2.36733564]
curr_Stock_Price:  104.49594043773247
curr_Factors:  [104.49594044]
mat_Sqrt:  [[0.15]]
grads:  [-0.10863319]
Stock Position:  -0.10863319040673929
Bond Position:  [13.71906303]


portfolio before change:  [2.42476952]
curr_Stock_Price:  103.97513820250262
curr_Factors:  [103.9751382]
mat_Sqrt:  [[0.15]]
grads:  [0.09906249]
Stock Position:  0.09906248631003817
Bond Position:  [-7.87526619]


portfolio before change:  [2.44645341]
curr_Stock_Price:  104.19899800666455
curr_Factors:  [104.19899801]
mat_Sqrt:  [[0.15]]
grads:  [0.07822735]
Stock Position:  0.07822734619118708
Bond Position:  [-5.70475768]


portfolio before change:  [2.41353859]
curr_Stock_Price:  103.78279752171282
curr_Factors:  [103.78279752]
mat_Sqrt:  [[0.15]]
grads:  [0.02883483]
Stock Position:  0.028834826335915192
Bond Position:  [-0.57902036]


portfolio before change:  [2.41951221]
curr_Stock_Price:  103.99121967409636
curr_Factors:  [103.99121967]
mat_Sqrt:  [[0.15]]
grads:  [-0.04943569]
Stock Position:  -0.049435687603443135
Bond Position:  [7.56038966]


portfolio before change:  [2.47947719]
curr_Stock_Price:  102.78778875822593
curr_Factors:  [102.78778876]
mat_Sqrt:  [[0.15]]
grads:  [-0.25624074]
Stock Position:  -0.25624074260738466
Bond Position:  [28.81789651]


portfolio before change:  [2.42429381]
curr_Stock_Price:  103.01017552042812
curr_Factors:  [103.01017552]
mat_Sqrt:  [[0.15]]
grads:  [0.01606259]
Stock Position:  0.016062590061255978
Bond Position:  [0.76968359]


portfolio before change:  [2.42913109]
curr_Stock_Price:  103.30833242697692
curr_Factors:  [103.30833243]
mat_Sqrt:  [[0.15]]
grads:  [-0.0577551]
Stock Position:  -0.05775509773136849
Bond Position:  [8.39571393]


portfolio before change:  [2.42209064]
curr_Stock_Price:  103.43932000530226
curr_Factors:  [103.43932001]
mat_Sqrt:  [[0.15]]
grads:  [0.03831402]
Stock Position:  0.03831402313250459
Bond Position:  [-1.54108586]


portfolio before change:  [2.44703538]
curr_Stock_Price:  104.09289419974631
curr_Factors:  [104.0928942]
mat_Sqrt:  [[0.15]]
grads:  [-0.06937244]
Stock Position:  -0.06937244140413358
Bond Position:  [9.66821358]


portfolio before change:  [2.4782889]
curr_Stock_Price:  103.65108705123454
curr_Factors:  [103.65108705]
mat_Sqrt:  [[0.15]]
grads:  [0.06659705]
Stock Position:  0.06659705231217039
Bond Position:  [-4.42456797]


portfolio before change:  [2.50395292]
curr_Stock_Price:  104.04060223192818
curr_Factors:  [104.04060223]
mat_Sqrt:  [[0.15]]
grads:  [0.07032168]
Stock Position:  0.0703216782499505
Bond Position:  [-4.81235684]


portfolio before change:  [2.47699794]
curr_Stock_Price:  103.66156974677062
curr_Factors:  [103.66156975]
mat_Sqrt:  [[0.15]]
grads:  [0.00127646]
Stock Position:  0.0012764632517734665
Bond Position:  [2.34467775]


portfolio before change:  [2.47737217]
curr_Stock_Price:  103.83994395747024
curr_Factors:  [103.83994396]
mat_Sqrt:  [[0.15]]
grads:  [0.01177111]
Stock Position:  0.01177111389466655
Bond Position:  [1.25506036]


portfolio before change:  [2.48272859]
curr_Stock_Price:  104.28832785165513
curr_Factors:  [104.28832785]
mat_Sqrt:  [[0.15]]
grads:  [0.08144723]
Stock Position:  0.08144722526841001
Bond Position:  [-6.01126634]


portfolio before change:  [2.52882386]
curr_Stock_Price:  104.85889347930753
curr_Factors:  [104.85889348]
mat_Sqrt:  [[0.15]]
grads:  [0.07519974]
Stock Position:  0.07519973699211857
Bond Position:  [-5.35653735]


portfolio before change:  [2.52544659]
curr_Stock_Price:  104.81843483409286
curr_Factors:  [104.81843483]
mat_Sqrt:  [[0.15]]
grads:  [0.19838415]
Stock Position:  0.19838414769040735
Bond Position:  [-18.26886927]


portfolio before change:  [2.42558369]
curr_Stock_Price:  104.32080907099149
curr_Factors:  [104.32080907]
mat_Sqrt:  [[0.15]]
grads:  [0.01971246]
Stock Position:  0.019712459723476024
Bond Position:  [0.36916394]


portfolio before change:  [2.41972769]
curr_Stock_Price:  104.02256750227941
curr_Factors:  [104.0225675]
mat_Sqrt:  [[0.15]]
grads:  [-0.0833583]
Stock Position:  -0.08335830122826124
Bond Position:  [11.0908722]


portfolio before change:  [2.39523628]
curr_Stock_Price:  104.32469233472345
curr_Factors:  [104.32469233]
mat_Sqrt:  [[0.15]]
grads:  [0.07022247]
Stock Position:  0.07022247478658572
Bond Position:  [-4.9307018]


portfolio before change:  [2.36277523]
curr_Stock_Price:  103.86682090208109
curr_Factors:  [103.8668209]
mat_Sqrt:  [[0.15]]
grads:  [0.02471142]
Stock Position:  0.02471142401202523
Bond Position:  [-0.20392182]


portfolio before change:  [2.36614147]
curr_Stock_Price:  104.00355862333247
curr_Factors:  [104.00355862]
mat_Sqrt:  [[0.15]]
grads:  [-0.03595086]
Stock Position:  -0.03595086206831706
Bond Position:  [6.10515906]


portfolio before change:  [2.37582825]
curr_Stock_Price:  103.74472756661582
curr_Factors:  [103.74472757]
mat_Sqrt:  [[0.15]]
grads:  [0.10003511]
Stock Position:  0.1000351107956902
Bond Position:  [-8.00228706]


portfolio before change:  [2.36158943]
curr_Stock_Price:  103.6073891052611
curr_Factors:  [103.60738911]
mat_Sqrt:  [[0.15]]
grads:  [-0.05594491]
Stock Position:  -0.055944910200617905
Bond Position:  [8.15789551]


portfolio before change:  [2.40505098]
curr_Stock_Price:  102.83963976341646
curr_Factors:  [102.83963976]
mat_Sqrt:  [[0.15]]
grads:  [0.06549368]
Stock Position:  0.06549367875325669
Bond Position:  [-4.33029535]


portfolio before change:  [2.38229193]
curr_Stock_Price:  102.49627232896485
curr_Factors:  [102.49627233]
mat_Sqrt:  [[0.15]]
grads:  [-0.07859449]
Stock Position:  -0.07859449447925904
Bond Position:  [10.43793464]


portfolio before change:  [2.38598226]
curr_Stock_Price:  102.45761904765111
curr_Factors:  [102.45761905]
mat_Sqrt:  [[0.15]]
grads:  [0.08147132]
Stock Position:  0.08147131575373315
Bond Position:  [-5.96137478]


portfolio before change:  [2.37517859]
curr_Stock_Price:  102.32958544059296
curr_Factors:  [102.32958544]
mat_Sqrt:  [[0.15]]
grads:  [0.00229927]
Stock Position:  0.0022992684564399806
Bond Position:  [2.13989541]


portfolio before change:  [2.37449909]
curr_Stock_Price:  101.97588384110712
curr_Factors:  [101.97588384]
mat_Sqrt:  [[0.15]]
grads:  [0.13083815]
Stock Position:  0.13083814559212226
Bond Position:  [-10.96783645]


portfolio before change:  [2.53427594]
curr_Stock_Price:  103.20230268278426
curr_Factors:  [103.20230268]
mat_Sqrt:  [[0.15]]
grads:  [-0.1514708]
Stock Position:  -0.15147080438037838
Bond Position:  [18.16641174]


portfolio before change:  [2.49659359]
curr_Stock_Price:  103.45857506161971
curr_Factors:  [103.45857506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262828]
Stock Position:  -0.002628278670212218
Bond Position:  [2.76851156]


portfolio before change:  [2.4968273]
curr_Stock_Price:  103.43549407984217
curr_Factors:  [103.43549408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04831048]
Stock Position:  -0.04831047966446238
Bond Position:  [7.49384563]


portfolio before change:  [2.49200877]
curr_Stock_Price:  103.54493015391843
curr_Factors:  [103.54493015]
mat_Sqrt:  [[0.15]]
grads:  [-0.04369534]
Stock Position:  -0.04369533628318875
Bond Position:  [7.01643931]


portfolio before change:  [2.5249735]
curr_Stock_Price:  102.80054426027387
curr_Factors:  [102.80054426]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.5249735]
Stock Price:  102.19590624073275
PL:  [0.32906726]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.82985761e-03]
 [ 1.04369029e-03]
 [-3.36110050e-03]
 [ 1.11731112e-03]
 [ 3.88836139e-02]
 [ 2.64179507e-02]
 [ 3.19286146e-03]
 [-1.06165656e-02]
 [ 2.38362758e-02]
 [-4.45447197e-03]
 [ 1.63241533e-02]
 [-4.21480337e-02]
 [ 9.21069702e-03]
 [ 3.20780976e-03]
 [-6.89901761e-03]
 [ 2.45254968e-02]
 [ 1.06146534e-02]
 [-1.03672635e-02]
 [ 2.87413254e-03]
 [ 2.45098180e-03]
 [ 1.16599950e-02]
 [-5.66642947e-03]
 [ 7.05942989e-03]
 [ 4.19320495e-02]
 [-3.60962624e-03]
 [ 1.13123821e-02]
 [-7.16823194e-03]
 [ 6.63733281e-03]
 [ 1.17818618e-02]
 [-3.41296694e-03]
 [ 5.41561597e-03]
 [-1.18383072e-02]
 [ 7.56977749e-03]
 [ 6.93901948e-03]
 [ 1.15749711e-02]
 [ 9.09752018e-03]
 [-3.40065122e-02]
 [ 9.68480409e-03]
 [-4.35215698e-03]
 [ 2.13984755e-02]
 [-6.50365533e-03]
 [-9.54079844e-03]
 [ 2.31332419e-02]
 [ 4.16508527e-03]
 [-8.10233997e-03]
 [ 2.34094643e-03]
 [ 1.11737730e-02]
 [ 1.91748739e-03]
 [-3.75781757e-03]
 [-7.50692517e-03]
 [-7.68200071e-03]
 [-5.82199337e-03]
 [ 2.35113183e-03]
 [ 5.34757483e-03]
 [ 5.29558992e-03]
 [-3.03360636e-03]
 [ 4.25765295e-03]
 [-3.55965422e-04]
 [ 1.55956738e-03]
 [ 1.38560889e-02]
 [ 4.69972082e-04]
 [ 9.55211940e-03]
 [ 2.14728572e-03]
 [-1.24749349e-02]
 [ 6.62480780e-05]
 [-2.78277218e-04]
 [-5.44926002e-03]
 [ 1.50611633e-02]
 [-8.27152434e-03]
 [ 1.00490439e-02]
 [-1.27703290e-02]
 [ 1.26570052e-02]
 [ 1.37844949e-03]
 [ 2.12906545e-02]
 [-2.24809840e-02]
 [-2.07756793e-03]
 [-6.77689286e-03]
 [-6.80804181e-03]
 [ 2.95378368e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.67506533]
curr_Stock_Price:  99.97616760971087
curr_Factors:  [99.97616761]
mat_Sqrt:  [[0.15]]
grads:  [0.01219905]
Stock Position:  0.012199050741652341
Bond Position:  [0.45545099]


portfolio before change:  [1.67296643]
curr_Stock_Price:  99.80178006196775
curr_Factors:  [99.80178006]
mat_Sqrt:  [[0.15]]
grads:  [0.00695794]
Stock Position:  0.006957935278198415
Bond Position:  [0.97855211]


portfolio before change:  [1.67950435]
curr_Stock_Price:  100.73262465949684
curr_Factors:  [100.73262466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02240734]
Stock Position:  -0.022407336677335955
Bond Position:  [3.93665419]


portfolio before change:  [1.65888302]
curr_Stock_Price:  101.66389888915928
curr_Factors:  [101.66389889]
mat_Sqrt:  [[0.15]]
grads:  [0.00744874]
Stock Position:  0.00744874080118785
Bond Position:  [0.90161499]


portfolio before change:  [1.66493847]
curr_Stock_Price:  102.46928307043589
curr_Factors:  [102.46928307]
mat_Sqrt:  [[0.15]]
grads:  [0.25922409]
Stock Position:  0.259224092771019
Bond Position:  [-24.89756847]


portfolio before change:  [1.75697916]
curr_Stock_Price:  102.83034841266327
curr_Factors:  [102.83034841]
mat_Sqrt:  [[0.15]]
grads:  [0.17611967]
Stock Position:  0.1761196712223392
Bond Position:  [-16.35346799]


portfolio before change:  [1.59973558]
curr_Stock_Price:  101.94332962462576
curr_Factors:  [101.94332962]
mat_Sqrt:  [[0.15]]
grads:  [0.02128574]
Stock Position:  0.021285743088897652
Bond Position:  [-0.57020394]


portfolio before change:  [1.57514344]
curr_Stock_Price:  100.78967010704632
curr_Factors:  [100.78967011]
mat_Sqrt:  [[0.15]]
grads:  [-0.0707771]
Stock Position:  -0.0707771039510003
Bond Position:  [8.7087444]


portfolio before change:  [1.60538181]
curr_Stock_Price:  100.37012694687239
curr_Factors:  [100.37012695]
mat_Sqrt:  [[0.15]]
grads:  [0.15890851]
Stock Position:  0.1589085052872059
Bond Position:  [-14.34428504]


portfolio before change:  [1.67659297]
curr_Stock_Price:  100.82389567493358
curr_Factors:  [100.82389567]
mat_Sqrt:  [[0.15]]
grads:  [-0.02969648]
Stock Position:  -0.02969647977480386
Bond Position:  [4.67070775]


portfolio before change:  [1.67400017]
curr_Stock_Price:  100.92103604454849
curr_Factors:  [100.92103604]
mat_Sqrt:  [[0.15]]
grads:  [0.10882769]
Stock Position:  0.10882768884025391
Bond Position:  [-9.30900294]


portfolio before change:  [1.70077175]
curr_Stock_Price:  101.17238210136092
curr_Factors:  [101.1723821]
mat_Sqrt:  [[0.15]]
grads:  [-0.28098689]
Stock Position:  -0.2809868912998522
Bond Position:  [30.12888488]


portfolio before change:  [1.87371003]
curr_Stock_Price:  100.56361645823738
curr_Factors:  [100.56361646]
mat_Sqrt:  [[0.15]]
grads:  [0.06140465]
Stock Position:  0.06140464679883821
Bond Position:  [-4.30136332]


portfolio before change:  [1.91217594]
curr_Stock_Price:  101.19442781409717
curr_Factors:  [101.19442781]
mat_Sqrt:  [[0.15]]
grads:  [0.0213854]
Stock Position:  0.021385398376626015
Bond Position:  [-0.25190722]


portfolio before change:  [1.92725591]
curr_Stock_Price:  101.90031689984171
curr_Factors:  [101.9003169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599345]
Stock Position:  -0.04599345070327511
Bond Position:  [6.61400311]


portfolio before change:  [1.92724847]
curr_Stock_Price:  101.90946664668809
curr_Factors:  [101.90946665]
mat_Sqrt:  [[0.15]]
grads:  [0.16350331]
Stock Position:  0.16350331194956474
Bond Position:  [-14.73528684]


portfolio before change:  [1.83733808]
curr_Stock_Price:  101.36519995415559
curr_Factors:  [101.36519995]
mat_Sqrt:  [[0.15]]
grads:  [0.07076436]
Stock Position:  0.07076435607118771
Bond Position:  [-5.33570502]


portfolio before change:  [1.88133916]
curr_Stock_Price:  101.99170990524885
curr_Factors:  [101.99170991]
mat_Sqrt:  [[0.15]]
grads:  [-0.06911509]
Stock Position:  -0.06911508975585383
Bond Position:  [8.93050535]


portfolio before change:  [1.88116698]
curr_Stock_Price:  102.00227714789125
curr_Factors:  [102.00227715]
mat_Sqrt:  [[0.15]]
grads:  [0.01916088]
Stock Position:  0.019160883583149088
Bond Position:  [-0.07328678]


portfolio before change:  [1.85875897]
curr_Stock_Price:  100.83305008258696
curr_Factors:  [100.83305008]
mat_Sqrt:  [[0.15]]
grads:  [0.01633988]
Stock Position:  0.01633987866104116
Bond Position:  [0.21115917]


portfolio before change:  [1.85010329]
curr_Stock_Price:  100.30251503737645
curr_Factors:  [100.30251504]
mat_Sqrt:  [[0.15]]
grads:  [0.0777333]
Stock Position:  0.07773329988284017
Bond Position:  [-5.94674219]


portfolio before change:  [1.89356943]
curr_Stock_Price:  100.86646663286061
curr_Factors:  [100.86646663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0377762]
Stock Position:  -0.037776196447870815
Bond Position:  [5.70392089]


portfolio before change:  [1.88846608]
curr_Stock_Price:  101.01099823596236
curr_Factors:  [101.01099824]
mat_Sqrt:  [[0.15]]
grads:  [0.04706287]
Stock Position:  0.04706286592254228
Bond Position:  [-2.86540098]


portfolio before change:  [1.8336737]
curr_Stock_Price:  99.85056558660249
curr_Factors:  [99.85056559]
mat_Sqrt:  [[0.15]]
grads:  [0.279547]
Stock Position:  0.27954699647371395
Bond Position:  [-26.079252]


portfolio before change:  [1.83796537]
curr_Stock_Price:  99.87174868794416
curr_Factors:  [99.87174869]
mat_Sqrt:  [[0.15]]
grads:  [-0.02406417]
Stock Position:  -0.024064174936234608
Bond Position:  [4.2412966]


portfolio before change:  [1.83571992]
curr_Stock_Price:  99.9760756961795
curr_Factors:  [99.9760757]
mat_Sqrt:  [[0.15]]
grads:  [0.07541588]
Stock Position:  0.0754158808230805
Bond Position:  [-5.70406389]


portfolio before change:  [1.83913232]
curr_Stock_Price:  100.02605084681521
curr_Factors:  [100.02605085]
mat_Sqrt:  [[0.15]]
grads:  [-0.04778821]
Stock Position:  -0.04778821295789506
Bond Position:  [6.61919854]


portfolio before change:  [1.80683305]
curr_Stock_Price:  100.71059164728415
curr_Factors:  [100.71059165]
mat_Sqrt:  [[0.15]]
grads:  [0.04424889]
Stock Position:  0.04424888537410348
Bond Position:  [-2.64949837]


portfolio before change:  [1.82260212]
curr_Stock_Price:  101.07070607467345
curr_Factors:  [101.07070607]
mat_Sqrt:  [[0.15]]
grads:  [0.07854575]
Stock Position:  0.07854574516863572
Bond Position:  [-6.11607181]


portfolio before change:  [1.78841294]
curr_Stock_Price:  100.6402955753275
curr_Factors:  [100.64029558]
mat_Sqrt:  [[0.15]]
grads:  [-0.02275311]
Stock Position:  -0.022753112921008713
Bond Position:  [4.07829295]


portfolio before change:  [1.79302483]
curr_Stock_Price:  100.44880541185753
curr_Factors:  [100.44880541]
mat_Sqrt:  [[0.15]]
grads:  [0.03610411]
Stock Position:  0.03610410645126545
Bond Position:  [-1.83358953]


portfolio before change:  [1.8148668]
curr_Stock_Price:  101.05695145985337
curr_Factors:  [101.05695146]
mat_Sqrt:  [[0.15]]
grads:  [-0.07892205]
Stock Position:  -0.07892204831348604
Bond Position:  [9.79048841]


portfolio before change:  [1.84056532]
curr_Stock_Price:  100.73908596558394
curr_Factors:  [100.73908597]
mat_Sqrt:  [[0.15]]
grads:  [0.05046518]
Stock Position:  0.05046518326238167
Bond Position:  [-3.24325111]


portfolio before change:  [1.8375957]
curr_Stock_Price:  100.68425782826775
curr_Factors:  [100.68425783]
mat_Sqrt:  [[0.15]]
grads:  [0.04626013]
Stock Position:  0.04626012988064013
Bond Position:  [-2.82007114]


portfolio before change:  [1.8135844]
curr_Stock_Price:  100.1690183471554
curr_Factors:  [100.16901835]
mat_Sqrt:  [[0.15]]
grads:  [0.07716647]
Stock Position:  0.07716647377535651
Bond Position:  [-5.91610553]


portfolio before change:  [1.87968279]
curr_Stock_Price:  101.03037893186941
curr_Factors:  [101.03037893]
mat_Sqrt:  [[0.15]]
grads:  [0.06065013]
Stock Position:  0.06065013450520726
Bond Position:  [-4.24782329]


portfolio before change:  [1.88654564]
curr_Stock_Price:  101.14791128635561
curr_Factors:  [101.14791129]
mat_Sqrt:  [[0.15]]
grads:  [-0.22671008]
Stock Position:  -0.22671008130125755
Bond Position:  [24.81779683]


portfolio before change:  [1.89377496]
curr_Stock_Price:  101.12286540054916
curr_Factors:  [101.1228654]
mat_Sqrt:  [[0.15]]
grads:  [0.06456536]
Stock Position:  0.06456536063047813
Bond Position:  [-4.63525931]


portfolio before change:  [1.84751028]
curr_Stock_Price:  100.41079688055784
curr_Factors:  [100.41079688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02901438]
Stock Position:  -0.02901437989033539
Bond Position:  [4.76086729]


portfolio before change:  [1.84211353]
curr_Stock_Price:  100.6070552301225
curr_Factors:  [100.60705523]
mat_Sqrt:  [[0.15]]
grads:  [0.1426565]
Stock Position:  0.1426565031184895
Bond Position:  [-12.51013715]


portfolio before change:  [1.76951899]
curr_Stock_Price:  100.10365977742033
curr_Factors:  [100.10365978]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433577]
Stock Position:  -0.04335770217415593
Bond Position:  [6.10978366]


portfolio before change:  [1.77862952]
curr_Stock_Price:  99.90234251954168
curr_Factors:  [99.90234252]
mat_Sqrt:  [[0.15]]
grads:  [-0.06360532]
Stock Position:  -0.06360532291654455
Bond Position:  [8.13295027]


portfolio before change:  [1.8254752]
curr_Stock_Price:  99.17382866198189
curr_Factors:  [99.17382866]
mat_Sqrt:  [[0.15]]
grads:  [0.15422161]
Stock Position:  0.15422161296710415
Bond Position:  [-13.46927262]


portfolio before change:  [1.85735121]
curr_Stock_Price:  99.3859770172753
curr_Factors:  [99.38597702]
mat_Sqrt:  [[0.15]]
grads:  [0.02776724]
Stock Position:  0.027767235125125342
Bond Position:  [-0.90232258]


portfolio before change:  [1.88030503]
curr_Stock_Price:  100.21465951787259
curr_Factors:  [100.21465952]
mat_Sqrt:  [[0.15]]
grads:  [-0.0540156]
Stock Position:  -0.05401559977694789
Bond Position:  [7.29345997]


portfolio before change:  [1.85382732]
curr_Stock_Price:  100.71328523034347
curr_Factors:  [100.71328523]
mat_Sqrt:  [[0.15]]
grads:  [0.01560631]
Stock Position:  0.015606309527871945
Bond Position:  [0.28206462]


portfolio before change:  [1.86218457]
curr_Stock_Price:  101.24766011954674
curr_Factors:  [101.24766012]
mat_Sqrt:  [[0.15]]
grads:  [0.07449182]
Stock Position:  0.0744918203083588
Bond Position:  [-5.67993793]


portfolio before change:  [1.95924114]
curr_Stock_Price:  102.55534165674274
curr_Factors:  [102.55534166]
mat_Sqrt:  [[0.15]]
grads:  [0.01278325]
Stock Position:  0.012783249250918819
Bond Position:  [0.64825065]


portfolio before change:  [1.95547869]
curr_Stock_Price:  102.25784514434115
curr_Factors:  [102.25784514]
mat_Sqrt:  [[0.15]]
grads:  [-0.02505212]
Stock Position:  -0.025052117102118923
Bond Position:  [4.5172542]


portfolio before change:  [1.96587413]
curr_Stock_Price:  101.85416249641791
curr_Factors:  [101.8541625]
mat_Sqrt:  [[0.15]]
grads:  [-0.05004617]
Stock Position:  -0.050046167829679515
Bond Position:  [7.06328464]


portfolio before change:  [1.9803817]
curr_Stock_Price:  101.57309991652893
curr_Factors:  [101.57309992]
mat_Sqrt:  [[0.15]]
grads:  [-0.05121334]
Stock Position:  -0.05121333807929954
Bond Position:  [7.18227921]


portfolio before change:  [2.00495159]
curr_Stock_Price:  101.10210977809345
curr_Factors:  [101.10210978]
mat_Sqrt:  [[0.15]]
grads:  [-0.03881329]
Stock Position:  -0.03881328914868038
Bond Position:  [5.92905701]


portfolio before change:  [2.0445167]
curr_Stock_Price:  100.0922871870319
curr_Factors:  [100.09228719]
mat_Sqrt:  [[0.15]]
grads:  [0.01567421]
Stock Position:  0.015674212182353073
Bond Position:  [0.47564895]


portfolio before change:  [2.05012387]
curr_Stock_Price:  100.44812279847353
curr_Factors:  [100.4481228]
mat_Sqrt:  [[0.15]]
grads:  [0.0356505]
Stock Position:  0.035650498884140375
Bond Position:  [-1.53090182]


portfolio before change:  [2.047564]
curr_Stock_Price:  100.37900217881814
curr_Factors:  [100.37900218]
mat_Sqrt:  [[0.15]]
grads:  [0.03530393]
Stock Position:  0.03530393277939695
Bond Position:  [-1.49620954]


portfolio before change:  [2.04311462]
curr_Stock_Price:  100.25562027256407
curr_Factors:  [100.25562027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02022404]
Stock Position:  -0.020224042414056544
Bond Position:  [4.07068854]


portfolio before change:  [2.03839317]
curr_Stock_Price:  100.50165815990421
curr_Factors:  [100.50165816]
mat_Sqrt:  [[0.15]]
grads:  [0.02838435]
Stock Position:  0.02838435297004839
Bond Position:  [-0.81428137]


portfolio before change:  [2.04379111]
curr_Stock_Price:  100.69362429013638
curr_Factors:  [100.69362429]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023731]
Stock Position:  -0.00237310281659118
Bond Position:  [2.28274743]


portfolio before change:  [2.04342401]
curr_Stock_Price:  100.90843491877874
curr_Factors:  [100.90843492]
mat_Sqrt:  [[0.15]]
grads:  [0.01039712]
Stock Position:  0.01039711588465364
Bond Position:  [0.99426732]


portfolio before change:  [2.04638603]
curr_Stock_Price:  101.18734624466298
curr_Factors:  [101.18734624]
mat_Sqrt:  [[0.15]]
grads:  [0.09237393]
Stock Position:  0.09237392610409657
Bond Position:  [-7.30068641]


portfolio before change:  [2.03989699]
curr_Stock_Price:  101.12203846497303
curr_Factors:  [101.12203846]
mat_Sqrt:  [[0.15]]
grads:  [0.00313315]
Stock Position:  0.0031331472122387606
Bond Position:  [1.72306676]


portfolio before change:  [2.04385576]
curr_Stock_Price:  102.3511768819363
curr_Factors:  [102.35117688]
mat_Sqrt:  [[0.15]]
grads:  [0.0636808]
Stock Position:  0.06368079597537833
Bond Position:  [-4.47394866]


portfolio before change:  [2.09240088]
curr_Stock_Price:  103.117887721369
curr_Factors:  [103.11788772]
mat_Sqrt:  [[0.15]]
grads:  [0.01431524]
Stock Position:  0.014315238117394014
Bond Position:  [0.61624376]


portfolio before change:  [2.09161335]
curr_Stock_Price:  103.06018344909184
curr_Factors:  [103.06018345]
mat_Sqrt:  [[0.15]]
grads:  [-0.08316623]
Stock Position:  -0.08316623267984222
Bond Position:  [10.66274054]


portfolio before change:  [2.15922374]
curr_Stock_Price:  102.25524197677301
curr_Factors:  [102.25524198]
mat_Sqrt:  [[0.15]]
grads:  [0.00044165]
Stock Position:  0.00044165385348160735
Bond Position:  [2.11406232]


portfolio before change:  [2.15903452]
curr_Stock_Price:  101.52762308592105
curr_Factors:  [101.52762309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00185518]
Stock Position:  -0.00185518145101371
Bond Position:  [2.34738668]


portfolio before change:  [2.15831535]
curr_Stock_Price:  101.99436007806275
curr_Factors:  [101.99436008]
mat_Sqrt:  [[0.15]]
grads:  [-0.0363284]
Stock Position:  -0.03632840016614196
Bond Position:  [5.86360728]


portfolio before change:  [2.15011752]
curr_Stock_Price:  102.23010719156375
curr_Factors:  [102.23010719]
mat_Sqrt:  [[0.15]]
grads:  [0.10040776]
Stock Position:  0.10040775503303381
Bond Position:  [-8.11457804]


portfolio before change:  [2.16431183]
curr_Stock_Price:  102.37652500601979
curr_Factors:  [102.37652501]
mat_Sqrt:  [[0.15]]
grads:  [-0.0551435]
Stock Position:  -0.05514349558665121
Bond Position:  [7.80971128]


portfolio before change:  [2.14221974]
curr_Stock_Price:  102.78600599065643
curr_Factors:  [102.78600599]
mat_Sqrt:  [[0.15]]
grads:  [0.06699363]
Stock Position:  0.06699362613801249
Bond Position:  [-4.74378752]


portfolio before change:  [2.16736778]
curr_Stock_Price:  103.16581134825984
curr_Factors:  [103.16581135]
mat_Sqrt:  [[0.15]]
grads:  [-0.08513553]
Stock Position:  -0.08513552682750786
Bond Position:  [10.95044348]


portfolio before change:  [2.17244316]
curr_Stock_Price:  103.11423525421482
curr_Factors:  [103.11423525]
mat_Sqrt:  [[0.15]]
grads:  [0.08438003]
Stock Position:  0.08438003437030087
Bond Position:  [-6.52833955]


portfolio before change:  [2.1506346]
curr_Stock_Price:  102.86061448323375
curr_Factors:  [102.86061448]
mat_Sqrt:  [[0.15]]
grads:  [0.00918966]
Stock Position:  0.009189663253943088
Bond Position:  [1.20538019]


portfolio before change:  [2.1483193]
curr_Stock_Price:  102.60047033571628
curr_Factors:  [102.60047034]
mat_Sqrt:  [[0.15]]
grads:  [0.1419377]
Stock Position:  0.14193769643383214
Bond Position:  [-12.41455511]


portfolio before change:  [2.08671659]
curr_Stock_Price:  102.17192475424518
curr_Factors:  [102.17192475]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987323]
Stock Position:  -0.14987322639599673
Bond Position:  [17.3995526]


portfolio before change:  [2.09224294]
curr_Stock_Price:  102.14230746440984
curr_Factors:  [102.14230746]
mat_Sqrt:  [[0.15]]
grads:  [-0.01385045]
Stock Position:  -0.013850452842271453
Bond Position:  [3.50696015]


portfolio before change:  [2.07320795]
curr_Stock_Price:  103.53245587388513
curr_Factors:  [103.53245587]
mat_Sqrt:  [[0.15]]
grads:  [-0.04517929]
Stock Position:  -0.045179285758729044
Bond Position:  [6.75073036]


portfolio before change:  [2.07001008]
curr_Stock_Price:  103.61257658194505
curr_Factors:  [103.61257658]
mat_Sqrt:  [[0.15]]
grads:  [-0.04538695]
Stock Position:  -0.045386945388700424
Bond Position:  [6.77266844]


portfolio before change:  [2.06111904]
curr_Stock_Price:  103.81779747418553
curr_Factors:  [103.81779747]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.06111904]
Stock Price:  103.59782304880001
PL:  [-1.53670401]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.74058695e-04]
 [ 2.40128251e-03]
 [-5.74500371e-04]
 [ 6.59143883e-03]
 [ 4.84059312e-03]
 [ 2.76338086e-02]
 [ 1.23623394e-03]
 [-1.30430216e-02]
 [ 2.47585581e-02]
 [-4.02652954e-03]
 [ 1.59208903e-02]
 [-4.01866624e-02]
 [ 6.53383785e-03]
 [ 9.11315415e-03]
 [-6.91473962e-03]
 [ 1.51108879e-02]
 [ 7.20856565e-03]
 [-8.92669351e-03]
 [ 1.29997179e-03]
 [ 1.03881278e-02]
 [ 1.23504317e-02]
 [-1.01820065e-02]
 [ 2.95680477e-03]
 [-7.26582511e-02]
 [-1.37005687e-02]
 [-3.52298500e-04]
 [ 2.97631127e-03]
 [ 1.30599928e-02]
 [-8.21895925e-02]
 [ 7.20962435e-03]
 [ 1.53519817e-02]
 [-1.40678047e-02]
 [-6.46139959e-03]
 [ 8.22417736e-03]
 [ 1.38305997e-02]
 [-4.03751067e-03]
 [-2.81637096e-02]
 [ 7.23854131e-03]
 [-5.16853446e-02]
 [-1.39489624e-02]
 [-1.50486205e-02]
 [ 6.19995543e-02]
 [ 2.34776885e-02]
 [ 3.45695018e-03]
 [ 7.35382100e-03]
 [ 2.71779641e-02]
 [-3.39839723e-03]
 [-4.28331794e-03]
 [ 2.07279267e-02]
 [ 7.80104462e-03]
 [ 3.11346901e-02]
 [ 1.45595500e-02]
 [-6.93017367e-04]
 [ 4.32863853e-03]
 [ 4.01106143e-03]
 [ 4.68182172e-03]
 [-1.66832026e-02]
 [-3.91281564e-05]
 [ 1.56280756e-03]
 [-3.19207109e-02]
 [-8.28851697e-03]
 [ 1.26464479e-02]
 [ 1.53468026e-02]
 [-1.89857162e-02]
 [-3.54658557e-03]
 [-1.96914918e-02]
 [-4.29732063e-03]
 [ 7.28690604e-04]
 [-1.75369293e-02]
 [ 1.34785546e-02]
 [ 5.53686227e-03]
 [ 1.22686372e-02]
 [ 3.19952316e-03]
 [-1.43250822e-03]
 [-2.52541863e-03]
 [-1.27265825e-02]
 [ 4.72608823e-03]
 [ 4.32663523e-03]
 [-3.76495264e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.08062813]
curr_Stock_Price:  100.19761419071631
curr_Factors:  [100.19761419]
mat_Sqrt:  [[0.15]]
grads:  [0.00449372]
Stock Position:  0.0044937246314011164
Bond Position:  [4.63036764]


portfolio before change:  [5.08002282]
curr_Stock_Price:  99.99851052851552
curr_Factors:  [99.99851053]
mat_Sqrt:  [[0.15]]
grads:  [0.01600855]
Stock Position:  0.016008550091509064
Bond Position:  [3.47919165]


portfolio before change:  [5.08439426]
curr_Stock_Price:  100.25799625366686
curr_Factors:  [100.25799625]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383]
Stock Position:  -0.0038300024703005293
Bond Position:  [5.46838264]


portfolio before change:  [5.08405794]
curr_Stock_Price:  100.43504796414106
curr_Factors:  [100.43504796]
mat_Sqrt:  [[0.15]]
grads:  [0.04394293]
Stock Position:  0.04394292551183866
Bond Position:  [0.67064811]


portfolio before change:  [5.06746897]
curr_Stock_Price:  100.0565823194251
curr_Factors:  [100.05658232]
mat_Sqrt:  [[0.15]]
grads:  [0.03227062]
Stock Position:  0.032270620778324904
Bond Position:  [1.83858094]


portfolio before change:  [5.10160292]
curr_Stock_Price:  101.1107620944843
curr_Factors:  [101.11076209]
mat_Sqrt:  [[0.15]]
grads:  [0.18422539]
Stock Position:  0.1842253906555771
Bond Position:  [-13.52556673]


portfolio before change:  [4.88652319]
curr_Stock_Price:  99.94786943016197
curr_Factors:  [99.94786943]
mat_Sqrt:  [[0.15]]
grads:  [0.00824156]
Stock Position:  0.00824155962551489
Bond Position:  [4.06279686]


portfolio before change:  [4.89161736]
curr_Stock_Price:  100.53516589795127
curr_Factors:  [100.5351659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08695348]
Stock Position:  -0.08695347750371663
Bond Position:  [13.63349965]


portfolio before change:  [4.90117467]
curr_Stock_Price:  100.43505276415324
curr_Factors:  [100.43505276]
mat_Sqrt:  [[0.15]]
grads:  [0.16505705]
Stock Position:  0.16505705392517706
Bond Position:  [-11.67633925]


portfolio before change:  [4.92765694]
curr_Stock_Price:  100.59991739052752
curr_Factors:  [100.59991739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684353]
Stock Position:  -0.026843530294996303
Bond Position:  [7.62811387]


portfolio before change:  [4.92577148]
curr_Stock_Price:  100.68791764591958
curr_Factors:  [100.68791765]
mat_Sqrt:  [[0.15]]
grads:  [0.10613927]
Stock Position:  0.10613926842926377
Bond Position:  [-5.76117044]


portfolio before change:  [4.97208192]
curr_Stock_Price:  101.12762789651474
curr_Factors:  [101.1276279]
mat_Sqrt:  [[0.15]]
grads:  [-0.26791108]
Stock Position:  -0.26791108285091764
Bond Position:  [32.06529421]


portfolio before change:  [5.14152665]
curr_Stock_Price:  100.50264221622703
curr_Factors:  [100.50264222]
mat_Sqrt:  [[0.15]]
grads:  [0.04355892]
Stock Position:  0.043558919015098285
Bond Position:  [0.7637402]


portfolio before change:  [5.11161653]
curr_Stock_Price:  99.8148874834647
curr_Factors:  [99.81488748]
mat_Sqrt:  [[0.15]]
grads:  [0.06075436]
Stock Position:  0.06075436101345262
Bond Position:  [-0.95257318]


portfolio before change:  [5.13775992]
curr_Stock_Price:  100.24618045604015
curr_Factors:  [100.24618046]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609826]
Stock Position:  -0.04609826412636079
Bond Position:  [9.75893483]


portfolio before change:  [5.12840861]
curr_Stock_Price:  100.4622681236079
curr_Factors:  [100.46226812]
mat_Sqrt:  [[0.15]]
grads:  [0.10073925]
Stock Position:  0.10073925265480828
Bond Position:  [-4.9920852]


portfolio before change:  [4.98760774]
curr_Stock_Price:  99.06768902972378
curr_Factors:  [99.06768903]
mat_Sqrt:  [[0.15]]
grads:  [0.0480571]
Stock Position:  0.04805710430812325
Bond Position:  [0.22670147]


portfolio before change:  [4.97371079]
curr_Stock_Price:  98.77821838384963
curr_Factors:  [98.77821838]
mat_Sqrt:  [[0.15]]
grads:  [-0.05951129]
Stock Position:  -0.05951129007393033
Bond Position:  [10.85213]


portfolio before change:  [5.00196666]
curr_Stock_Price:  98.31481741944305
curr_Factors:  [98.31481742]
mat_Sqrt:  [[0.15]]
grads:  [0.00866648]
Stock Position:  0.0086664785854618
Bond Position:  [4.1499234]


portfolio before change:  [5.00395174]
curr_Stock_Price:  98.51394206931369
curr_Factors:  [98.51394207]
mat_Sqrt:  [[0.15]]
grads:  [0.06925419]
Stock Position:  0.06925418545649337
Bond Position:  [-1.81855107]


portfolio before change:  [4.96481893]
curr_Stock_Price:  97.95052268410535
curr_Factors:  [97.95052268]
mat_Sqrt:  [[0.15]]
grads:  [0.08233621]
Stock Position:  0.08233621120066972
Bond Position:  [-3.10005599]


portfolio before change:  [4.90044309]
curr_Stock_Price:  97.17101049102516
curr_Factors:  [97.17101049]
mat_Sqrt:  [[0.15]]
grads:  [-0.06788004]
Stock Position:  -0.06788004315804591
Bond Position:  [11.49641548]


portfolio before change:  [4.92428556]
curr_Stock_Price:  96.83035182542247
curr_Factors:  [96.83035183]
mat_Sqrt:  [[0.15]]
grads:  [0.01971203]
Stock Position:  0.019712031800060786
Bond Position:  [3.01556259]


portfolio before change:  [4.90958252]
curr_Stock_Price:  96.07489813333719
curr_Factors:  [96.07489813]
mat_Sqrt:  [[0.15]]
grads:  [-0.48438834]
Stock Position:  -0.48438834049119356
Bond Position:  [51.44714298]


portfolio before change:  [5.53779703]
curr_Stock_Price:  94.78461321880904
curr_Factors:  [94.78461322]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133712]
Stock Position:  -0.0913371246274203
Bond Position:  [14.19515106]


portfolio before change:  [5.49063869]
curr_Stock_Price:  95.31063767315979
curr_Factors:  [95.31063767]
mat_Sqrt:  [[0.15]]
grads:  [-0.00234866]
Stock Position:  -0.002348656664886567
Bond Position:  [5.71449066]


portfolio before change:  [5.49115696]
curr_Stock_Price:  95.24204696593226
curr_Factors:  [95.24204697]
mat_Sqrt:  [[0.15]]
grads:  [0.01984208]
Stock Position:  0.019842075114772994
Bond Position:  [3.60135711]


portfolio before change:  [5.49174846]
curr_Stock_Price:  95.26051317546235
curr_Factors:  [95.26051318]
mat_Sqrt:  [[0.15]]
grads:  [0.08706662]
Stock Position:  0.08706661873224229
Bond Position:  [-2.80226232]


portfolio before change:  [5.42641438]
curr_Stock_Price:  94.51213305061485
curr_Factors:  [94.51213305]
mat_Sqrt:  [[0.15]]
grads:  [-0.54793062]
Stock Position:  -0.5479306169747361
Bond Position:  [57.21250576]


portfolio before change:  [5.28654197]
curr_Stock_Price:  94.77393318296457
curr_Factors:  [94.77393318]
mat_Sqrt:  [[0.15]]
grads:  [0.04806416]
Stock Position:  0.048064162303460646
Bond Position:  [0.73131226]


portfolio before change:  [5.30372663]
curr_Stock_Price:  95.13051796727692
curr_Factors:  [95.13051797]
mat_Sqrt:  [[0.15]]
grads:  [0.10234654]
Stock Position:  0.10234654492159967
Bond Position:  [-4.4325532]


portfolio before change:  [5.24034158]
curr_Stock_Price:  94.51390698827416
curr_Factors:  [94.51390699]
mat_Sqrt:  [[0.15]]
grads:  [-0.09378536]
Stock Position:  -0.09378536456338
Bond Position:  [14.1043628]


portfolio before change:  [5.25154335]
curr_Stock_Price:  94.4038661201944
curr_Factors:  [94.40386612]
mat_Sqrt:  [[0.15]]
grads:  [-0.043076]
Stock Position:  -0.04307599724870528
Bond Position:  [9.31808403]


portfolio before change:  [5.27106661]
curr_Stock_Price:  93.96415825660259
curr_Factors:  [93.96415826]
mat_Sqrt:  [[0.15]]
grads:  [0.05482785]
Stock Position:  0.054827849074812154
Bond Position:  [0.11921392]


portfolio before change:  [5.24721026]
curr_Stock_Price:  93.52890866956649
curr_Factors:  [93.52890867]
mat_Sqrt:  [[0.15]]
grads:  [0.092204]
Stock Position:  0.09220399823873722
Bond Position:  [-3.37652907]


portfolio before change:  [5.26496345]
curr_Stock_Price:  93.72374009440696
curr_Factors:  [93.72374009]
mat_Sqrt:  [[0.15]]
grads:  [-0.02691674]
Stock Position:  -0.026916737782065547
Bond Position:  [7.78770079]


portfolio before change:  [5.26137705]
curr_Stock_Price:  93.87506411236461
curr_Factors:  [93.87506411]
mat_Sqrt:  [[0.15]]
grads:  [-0.18775806]
Stock Position:  -0.18775806371796874
Bond Position:  [22.88717732]


portfolio before change:  [5.3088298]
curr_Stock_Price:  93.62994946173747
curr_Factors:  [93.62994946]
mat_Sqrt:  [[0.15]]
grads:  [0.04825694]
Stock Position:  0.048256942097991966
Bond Position:  [0.79053475]


portfolio before change:  [5.30957854]
curr_Stock_Price:  93.64444139412556
curr_Factors:  [93.64444139]
mat_Sqrt:  [[0.15]]
grads:  [-0.34456896]
Stock Position:  -0.34456896430210404
Bond Position:  [37.57654673]


portfolio before change:  [5.32892821]
curr_Stock_Price:  93.595101306468
curr_Factors:  [93.59510131]
mat_Sqrt:  [[0.15]]
grads:  [-0.09299308]
Stock Position:  -0.09299308259094304
Bond Position:  [14.0326252]


portfolio before change:  [5.2339541]
curr_Stock_Price:  94.6258357954599
curr_Factors:  [94.6258358]
mat_Sqrt:  [[0.15]]
grads:  [-0.10032414]
Stock Position:  -0.10032413654428589
Bond Position:  [14.72720937]


portfolio before change:  [5.27504668]
curr_Stock_Price:  94.22541274528646
curr_Factors:  [94.22541275]
mat_Sqrt:  [[0.15]]
grads:  [0.41333036]
Stock Position:  0.4133303619432254
Bond Position:  [-33.67117727]


portfolio before change:  [5.317457]
curr_Stock_Price:  94.33311070425022
curr_Factors:  [94.3331107]
mat_Sqrt:  [[0.15]]
grads:  [0.15651792]
Stock Position:  0.15651792324607872
Bond Position:  [-9.44736558]


portfolio before change:  [5.42050196]
curr_Stock_Price:  94.99524215882411
curr_Factors:  [94.99524216]
mat_Sqrt:  [[0.15]]
grads:  [0.02304633]
Stock Position:  0.0230463345447024
Bond Position:  [3.23120983]


portfolio before change:  [5.43244796]
curr_Stock_Price:  95.5048260488807
curr_Factors:  [95.50482605]
mat_Sqrt:  [[0.15]]
grads:  [0.04902547]
Stock Position:  0.049025473336504505
Bond Position:  [0.75027866]


portfolio before change:  [5.37000165]
curr_Stock_Price:  94.23011722374574
curr_Factors:  [94.23011722]
mat_Sqrt:  [[0.15]]
grads:  [0.18118643]
Stock Position:  0.18118642728933332
Bond Position:  [-11.70321663]


portfolio before change:  [5.34858618]
curr_Stock_Price:  94.11595856689803
curr_Factors:  [94.11595857]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265598]
Stock Position:  -0.02265598151907071
Bond Position:  [7.4808756]


portfolio before change:  [5.3378106]
curr_Stock_Price:  94.61221376243672
curr_Factors:  [94.61221376]
mat_Sqrt:  [[0.15]]
grads:  [-0.02855545]
Stock Position:  -0.02855545294394592
Bond Position:  [8.03950522]


portfolio before change:  [5.34127146]
curr_Stock_Price:  94.50861277657326
curr_Factors:  [94.50861278]
mat_Sqrt:  [[0.15]]
grads:  [0.13818618]
Stock Position:  0.13818617808885883
Bond Position:  [-7.71851254]


portfolio before change:  [5.24384525]
curr_Stock_Price:  93.8070680752372
curr_Factors:  [93.80706808]
mat_Sqrt:  [[0.15]]
grads:  [0.05200696]
Stock Position:  0.05200696414060741
Bond Position:  [0.36522443]


portfolio before change:  [5.28572738]
curr_Stock_Price:  94.61194683074436
curr_Factors:  [94.61194683]
mat_Sqrt:  [[0.15]]
grads:  [0.2075646]
Stock Position:  0.20756460056653386
Bond Position:  [-14.35236357]


portfolio before change:  [5.08360149]
curr_Stock_Price:  93.64247111324934
curr_Factors:  [93.64247111]
mat_Sqrt:  [[0.15]]
grads:  [0.09706367]
Stock Position:  0.09706366650807491
Bond Position:  [-4.0056801]


portfolio before change:  [5.07573556]
curr_Stock_Price:  93.56401156363013
curr_Factors:  [93.56401156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462012]
Stock Position:  -0.004620115782472528
Bond Position:  [5.50801212]


portfolio before change:  [5.07702843]
curr_Stock_Price:  93.35869016863873
curr_Factors:  [93.35869017]
mat_Sqrt:  [[0.15]]
grads:  [0.02885759]
Stock Position:  0.02885759019812855
Bond Position:  [2.3829216]


portfolio before change:  [5.10350821]
curr_Stock_Price:  94.27113123217612
curr_Factors:  [94.27113123]
mat_Sqrt:  [[0.15]]
grads:  [0.02674041]
Stock Position:  0.02674040955455737
Bond Position:  [2.58265956]


portfolio before change:  [5.10453347]
curr_Stock_Price:  94.30343588095351
curr_Factors:  [94.30343588]
mat_Sqrt:  [[0.15]]
grads:  [0.03121214]
Stock Position:  0.031212144797791802
Bond Position:  [2.16112098]


portfolio before change:  [5.10882508]
curr_Stock_Price:  94.43660618054567
curr_Factors:  [94.43660618]
mat_Sqrt:  [[0.15]]
grads:  [-0.11122135]
Stock Position:  -0.11122135065990718
Bond Position:  [15.61219197]


portfolio before change:  [5.02465968]
curr_Stock_Price:  95.2021173903478
curr_Factors:  [95.20211739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026085]
Stock Position:  -0.00026085437627329684
Bond Position:  [5.04949357]


portfolio before change:  [5.0247774]
curr_Stock_Price:  95.96070844135215
curr_Factors:  [95.96070844]
mat_Sqrt:  [[0.15]]
grads:  [0.01041872]
Stock Position:  0.010418717086008783
Bond Position:  [4.02498993]


portfolio before change:  [5.02635053]
curr_Stock_Price:  96.08755264428297
curr_Factors:  [96.08755264]
mat_Sqrt:  [[0.15]]
grads:  [-0.21280474]
Stock Position:  -0.2128047390786717
Bond Position:  [25.4742371]


portfolio before change:  [5.02209757]
curr_Stock_Price:  96.11501982858428
curr_Factors:  [96.11501983]
mat_Sqrt:  [[0.15]]
grads:  [-0.05525678]
Stock Position:  -0.05525677981540532
Bond Position:  [10.33310406]


portfolio before change:  [5.01181806]
curr_Stock_Price:  96.31273936580702
curr_Factors:  [96.31273937]
mat_Sqrt:  [[0.15]]
grads:  [0.08430965]
Stock Position:  0.08430965244924433
Bond Position:  [-3.10827552]


portfolio before change:  [4.95414309]
curr_Stock_Price:  95.63095862085424
curr_Factors:  [95.63095862]
mat_Sqrt:  [[0.15]]
grads:  [0.10231202]
Stock Position:  0.10231201724760221
Bond Position:  [-4.8300532]


portfolio before change:  [4.96797846]
curr_Stock_Price:  95.76913652700043
curr_Factors:  [95.76913653]
mat_Sqrt:  [[0.15]]
grads:  [-0.12657144]
Stock Position:  -0.12657144137742884
Bond Position:  [17.08961611]


portfolio before change:  [5.00765074]
curr_Stock_Price:  95.46413771126683
curr_Factors:  [95.46413771]
mat_Sqrt:  [[0.15]]
grads:  [-0.0236439]
Stock Position:  -0.023643903809772347
Bond Position:  [7.26479563]


portfolio before change:  [5.02046372]
curr_Stock_Price:  94.94142719577339
curr_Factors:  [94.9414272]
mat_Sqrt:  [[0.15]]
grads:  [-0.13127661]
Stock Position:  -0.13127661204196295
Bond Position:  [17.48405262]


portfolio before change:  [4.99251822]
curr_Stock_Price:  95.16262642122653
curr_Factors:  [95.16262642]
mat_Sqrt:  [[0.15]]
grads:  [-0.0286488]
Stock Position:  -0.0286488041926032
Bond Position:  [7.71881367]


portfolio before change:  [5.00764404]
curr_Stock_Price:  94.65149231565768
curr_Factors:  [94.65149232]
mat_Sqrt:  [[0.15]]
grads:  [0.00485794]
Stock Position:  0.004857937357068942
Bond Position:  [4.54783302]


portfolio before change:  [5.00663979]
curr_Stock_Price:  94.38625628485067
curr_Factors:  [94.38625628]
mat_Sqrt:  [[0.15]]
grads:  [-0.11691286]
Stock Position:  -0.11691286171041404
Bond Position:  [16.04160712]


portfolio before change:  [4.99215889]
curr_Stock_Price:  94.51869285926023
curr_Factors:  [94.51869286]
mat_Sqrt:  [[0.15]]
grads:  [0.08985703]
Stock Position:  0.08985703076426654
Bond Position:  [-3.50101021]


portfolio before change:  [5.02094009]
curr_Stock_Price:  94.8414280099014
curr_Factors:  [94.84142801]
mat_Sqrt:  [[0.15]]
grads:  [0.03691242]
Stock Position:  0.036912415147667965
Bond Position:  [1.52011392]


portfolio before change:  [5.02334825]
curr_Stock_Price:  94.90409393433505
curr_Factors:  [94.90409393]
mat_Sqrt:  [[0.15]]
grads:  [0.08179091]
Stock Position:  0.08179091463217858
Bond Position:  [-2.7389444]


portfolio before change:  [5.06896041]
curr_Stock_Price:  95.46385481529066
curr_Factors:  [95.46385482]
mat_Sqrt:  [[0.15]]
grads:  [0.02133015]
Stock Position:  0.02133015439632081
Bond Position:  [3.03270165]


portfolio before change:  [5.07080098]
curr_Stock_Price:  95.541257768645
curr_Factors:  [95.54125777]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955005]
Stock Position:  -0.009550054829378898
Bond Position:  [5.98322523]


portfolio before change:  [5.0638668]
curr_Stock_Price:  96.30650455121433
curr_Factors:  [96.30650455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01683612]
Stock Position:  -0.016836124177998353
Bond Position:  [6.68529506]


portfolio before change:  [5.06074864]
curr_Stock_Price:  96.51652917671746
curr_Factors:  [96.51652918]
mat_Sqrt:  [[0.15]]
grads:  [-0.08484388]
Stock Position:  -0.08484388317013138
Bond Position:  [13.24958576]


portfolio before change:  [5.07322321]
curr_Stock_Price:  96.37926000734325
curr_Factors:  [96.37926001]
mat_Sqrt:  [[0.15]]
grads:  [0.03150725]
Stock Position:  0.03150725486651659
Bond Position:  [2.0365773]


portfolio before change:  [5.08752512]
curr_Stock_Price:  96.8291440955688
curr_Factors:  [96.8291441]
mat_Sqrt:  [[0.15]]
grads:  [0.02884423]
Stock Position:  0.028844234834142935
Bond Position:  [2.29456254]


portfolio before change:  [5.06144794]
curr_Stock_Price:  95.92010332520724
curr_Factors:  [95.92010333]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.06144794]
Stock Price:  97.31335967268942
PL:  [5.06144794]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.43774987e-03]
 [ 2.72610950e-03]
 [-4.21674009e-03]
 [ 2.20329100e-03]
 [ 2.39494630e-02]
 [ 2.73232589e-02]
 [ 2.86518945e-03]
 [-1.00473583e-02]
 [ 2.40265630e-02]
 [-4.84731157e-03]
 [ 3.59883234e-02]
 [-2.72155910e-02]
 [ 8.33365921e-02]
 [ 1.63580189e-02]
 [-6.89446709e-03]
 [ 2.68806797e-02]
 [ 1.05474171e-02]
 [-1.15311974e-02]
 [-2.76253812e-04]
 [-5.20943077e-03]
 [ 1.22622269e-02]
 [-4.67123785e-03]
 [ 7.57732176e-03]
 [ 4.34208521e-02]
 [ 9.90908405e-04]
 [ 1.43747315e-02]
 [-6.35797660e-03]
 [ 6.12059181e-03]
 [ 1.02010616e-02]
 [-2.89940648e-03]
 [ 1.27486998e-02]
 [-1.18440095e-02]
 [ 7.22576775e-03]
 [ 8.18225594e-03]
 [ 1.07963769e-02]
 [ 7.75809736e-03]
 [-3.29584339e-02]
 [ 8.93629645e-03]
 [ 1.15477076e-02]
 [ 1.43080450e-02]
 [-4.28975802e-03]
 [-1.88787082e-02]
 [ 2.09347872e-02]
 [-1.51174108e-03]
 [ 3.97424571e-03]
 [-1.64784374e-02]
 [ 1.45831607e-02]
 [ 1.30044435e-02]
 [ 6.73966551e-03]
 [-7.53360947e-03]
 [-6.43035179e-04]
 [ 3.00566860e-03]
 [-9.19194015e-03]
 [ 5.91211075e-03]
 [-1.22373414e-02]
 [ 1.79064420e-02]
 [ 1.36117609e-02]
 [ 1.72038837e-03]
 [ 1.97073539e-03]
 [-1.94227137e-04]
 [ 2.03718349e-02]
 [ 4.99664536e-02]
 [-5.75398381e-03]
 [-1.16850564e-02]
 [ 2.00344522e-02]
 [ 1.09325307e-02]
 [-4.50629859e-03]
 [ 1.58546035e-02]
 [-2.58262675e-02]
 [-3.79299404e-02]
 [-6.24984692e-03]
 [ 1.63271797e-02]
 [-2.77427779e-02]
 [ 2.84743012e-02]
 [-2.86852480e-02]
 [ 4.42860689e-03]
 [ 5.90368659e-03]
 [-1.38053386e-02]
 [ 2.45123717e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.26087584]
curr_Stock_Price:  99.65520823821772
curr_Factors:  [99.65520824]
mat_Sqrt:  [[0.15]]
grads:  [0.02291833]
Stock Position:  0.02291833246039454
Bond Position:  [-5.54480703]


portfolio before change:  [-3.24511505]
curr_Stock_Price:  100.35802315725411
curr_Factors:  [100.35802316]
mat_Sqrt:  [[0.15]]
grads:  [0.01817406]
Stock Position:  0.018174063336619396
Bond Position:  [-5.06902812]


portfolio before change:  [-3.22235738]
curr_Stock_Price:  101.62766238087602
curr_Factors:  [101.62766238]
mat_Sqrt:  [[0.15]]
grads:  [-0.0281116]
Stock Position:  -0.028111600627880644
Bond Position:  [-0.36544112]


portfolio before change:  [-3.2177989]
curr_Stock_Price:  101.46469345667879
curr_Factors:  [101.46469346]
mat_Sqrt:  [[0.15]]
grads:  [0.01468861]
Stock Position:  0.014688606672897519
Bond Position:  [-4.70817387]


portfolio before change:  [-3.21507423]
curr_Stock_Price:  101.67022257446554
curr_Factors:  [101.67022257]
mat_Sqrt:  [[0.15]]
grads:  [0.15966309]
Stock Position:  0.15966308669711407
Bond Position:  [-19.44805579]


portfolio before change:  [-3.2488629]
curr_Stock_Price:  101.46621092156147
curr_Factors:  [101.46621092]
mat_Sqrt:  [[0.15]]
grads:  [0.18215506]
Stock Position:  0.18215505966072304
Bond Position:  [-21.73144661]


portfolio before change:  [-3.1917705]
curr_Stock_Price:  101.78709503430902
curr_Factors:  [101.78709503]
mat_Sqrt:  [[0.15]]
grads:  [0.01910126]
Stock Position:  0.01910126298806592
Bond Position:  [-5.13603257]


portfolio before change:  [-3.21000319]
curr_Stock_Price:  100.84937267407355
curr_Factors:  [100.84937267]
mat_Sqrt:  [[0.15]]
grads:  [-0.06698239]
Stock Position:  -0.06698238861123136
Bond Position:  [3.54512868]


portfolio before change:  [-3.25293494]
curr_Stock_Price:  101.49362146847989
curr_Factors:  [101.49362147]
mat_Sqrt:  [[0.15]]
grads:  [0.16017709]
Stock Position:  0.1601770868235175
Bond Position:  [-19.50988755]


portfolio before change:  [-3.14609385]
curr_Stock_Price:  102.16825288021094
curr_Factors:  [102.16825288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231541]
Stock Position:  -0.032315410472482556
Bond Position:  [0.15551518]


portfolio before change:  [-3.14758256]
curr_Stock_Price:  102.21462197813847
curr_Factors:  [102.21462198]
mat_Sqrt:  [[0.15]]
grads:  [0.23992216]
Stock Position:  0.2399221559266974
Bond Position:  [-27.67113504]


portfolio before change:  [-3.16908805]
curr_Stock_Price:  102.13219528773449
curr_Factors:  [102.13219529]
mat_Sqrt:  [[0.15]]
grads:  [-0.18143727]
Stock Position:  -0.18143727364117532
Bond Position:  [15.36149901]


portfolio before change:  [-3.23373769]
curr_Stock_Price:  102.49380655957312
curr_Factors:  [102.49380656]
mat_Sqrt:  [[0.15]]
grads:  [0.55557728]
Stock Position:  0.5555772804109509
Bond Position:  [-60.176968]


portfolio before change:  [-2.76016338]
curr_Stock_Price:  103.35297683871676
curr_Factors:  [103.35297684]
mat_Sqrt:  [[0.15]]
grads:  [0.10905346]
Stock Position:  0.10905345906031351
Bond Position:  [-14.03116301]


portfolio before change:  [-2.78901471]
curr_Stock_Price:  103.09645725693261
curr_Factors:  [103.09645726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596311]
Stock Position:  -0.04596311396251028
Bond Position:  [1.94961951]


portfolio before change:  [-2.75992314]
curr_Stock_Price:  102.466175536084
curr_Factors:  [102.46617554]
mat_Sqrt:  [[0.15]]
grads:  [0.17920453]
Stock Position:  0.17920453149406743
Bond Position:  [-21.12232612]


portfolio before change:  [-3.00697622]
curr_Stock_Price:  101.09493292921853
curr_Factors:  [101.09493293]
mat_Sqrt:  [[0.15]]
grads:  [0.07031611]
Stock Position:  0.07031611376387611
Bond Position:  [-10.11557902]


portfolio before change:  [-3.01854506]
curr_Stock_Price:  100.93939820677876
curr_Factors:  [100.93939821]
mat_Sqrt:  [[0.15]]
grads:  [-0.07687465]
Stock Position:  -0.07687464940077784
Bond Position:  [4.74113579]


portfolio before change:  [-3.03969157]
curr_Stock_Price:  101.21833072798951
curr_Factors:  [101.21833073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00184169]
Stock Position:  -0.0018416920798461876
Bond Position:  [-2.85327857]


portfolio before change:  [-3.0402063]
curr_Stock_Price:  101.40098901867403
curr_Factors:  [101.40098902]
mat_Sqrt:  [[0.15]]
grads:  [-0.03472954]
Stock Position:  -0.03472953845728949
Bond Position:  [0.48140324]


portfolio before change:  [-3.02418525]
curr_Stock_Price:  100.94054613516941
curr_Factors:  [100.94054614]
mat_Sqrt:  [[0.15]]
grads:  [0.08174818]
Stock Position:  0.0817481791495888
Bond Position:  [-11.27589109]


portfolio before change:  [-3.00974162]
curr_Stock_Price:  101.12585170972392
curr_Factors:  [101.12585171]
mat_Sqrt:  [[0.15]]
grads:  [-0.03114159]
Stock Position:  -0.031141585681469935
Bond Position:  [0.13947776]


portfolio before change:  [-3.01040587]
curr_Stock_Price:  101.1474615859628
curr_Factors:  [101.14746159]
mat_Sqrt:  [[0.15]]
grads:  [0.05051548]
Stock Position:  0.05051547840638221
Bond Position:  [-8.11991828]


portfolio before change:  [-3.04394307]
curr_Stock_Price:  100.49360869449015
curr_Factors:  [100.49360869]
mat_Sqrt:  [[0.15]]
grads:  [0.28947235]
Stock Position:  0.289472347494378
Bond Position:  [-32.13406389]


portfolio before change:  [-2.88952748]
curr_Stock_Price:  101.03398512074561
curr_Factors:  [101.03398512]
mat_Sqrt:  [[0.15]]
grads:  [0.00660606]
Stock Position:  0.0066060560325536515
Bond Position:  [-3.55696364]


portfolio before change:  [-2.89251632]
curr_Stock_Price:  100.61519950541353
curr_Factors:  [100.61519951]
mat_Sqrt:  [[0.15]]
grads:  [0.09583154]
Stock Position:  0.0958315433209404
Bond Position:  [-12.53462617]


portfolio before change:  [-2.88301543]
curr_Stock_Price:  100.72251617263218
curr_Factors:  [100.72251617]
mat_Sqrt:  [[0.15]]
grads:  [-0.04238651]
Stock Position:  -0.04238651065661598
Bond Position:  [1.38626057]


portfolio before change:  [-2.87153733]
curr_Stock_Price:  100.45376412305104
curr_Factors:  [100.45376412]
mat_Sqrt:  [[0.15]]
grads:  [0.04080395]
Stock Position:  0.04080394542796471
Bond Position:  [-6.97044724]


portfolio before change:  [-2.85400527]
curr_Stock_Price:  100.89410684256718
curr_Factors:  [100.89410684]
mat_Sqrt:  [[0.15]]
grads:  [0.06800708]
Stock Position:  0.06800707721194867
Bond Position:  [-9.71551859]


portfolio before change:  [-2.85431145]
curr_Stock_Price:  100.89853370019081
curr_Factors:  [100.8985337]
mat_Sqrt:  [[0.15]]
grads:  [-0.01932938]
Stock Position:  -0.019329376550558806
Bond Position:  [-0.9040057]


portfolio before change:  [-2.87551497]
curr_Stock_Price:  101.99256881568255
curr_Factors:  [101.99256882]
mat_Sqrt:  [[0.15]]
grads:  [0.08499133]
Stock Position:  0.08499133219604804
Bond Position:  [-11.54399927]


portfolio before change:  [-2.90991281]
curr_Stock_Price:  101.59633647817336
curr_Factors:  [101.59633648]
mat_Sqrt:  [[0.15]]
grads:  [-0.07896006]
Stock Position:  -0.07896006364638579
Bond Position:  [5.11214038]


portfolio before change:  [-2.93102592]
curr_Stock_Price:  101.86777275158973
curr_Factors:  [101.86777275]
mat_Sqrt:  [[0.15]]
grads:  [0.04817178]
Stock Position:  0.048171784997106566
Bond Position:  [-7.83817836]


portfolio before change:  [-2.93941424]
curr_Stock_Price:  101.70380901323838
curr_Factors:  [101.70380901]
mat_Sqrt:  [[0.15]]
grads:  [0.05454837]
Stock Position:  0.05454837295129784
Bond Position:  [-8.48719155]


portfolio before change:  [-2.90293996]
curr_Stock_Price:  102.38219308750878
curr_Factors:  [102.38219309]
mat_Sqrt:  [[0.15]]
grads:  [0.07197585]
Stock Position:  0.0719758462476262
Bond Position:  [-10.27198495]


portfolio before change:  [-2.84517108]
curr_Stock_Price:  103.19372783741498
curr_Factors:  [103.19372784]
mat_Sqrt:  [[0.15]]
grads:  [0.05172065]
Stock Position:  0.05172064905233489
Bond Position:  [-8.18241766]


portfolio before change:  [-2.84529588]
curr_Stock_Price:  103.20120289475403
curr_Factors:  [103.20120289]
mat_Sqrt:  [[0.15]]
grads:  [-0.21972289]
Stock Position:  -0.2197228924623145
Bond Position:  [19.83037092]


portfolio before change:  [-2.90483769]
curr_Stock_Price:  103.47782970857193
curr_Factors:  [103.47782971]
mat_Sqrt:  [[0.15]]
grads:  [0.05957531]
Stock Position:  0.05957530966358185
Bond Position:  [-9.06956144]


portfolio before change:  [-2.8870259]
curr_Stock_Price:  103.7863241535427
curr_Factors:  [103.78632415]
mat_Sqrt:  [[0.15]]
grads:  [0.07698472]
Stock Position:  0.0769847173027547
Bond Position:  [-10.87698673]


portfolio before change:  [-2.93808294]
curr_Stock_Price:  103.13194481275602
curr_Factors:  [103.13194481]
mat_Sqrt:  [[0.15]]
grads:  [0.09538697]
Stock Position:  0.09538696637108106
Bond Position:  [-12.7755263]


portfolio before change:  [-2.95617811]
curr_Stock_Price:  102.95061326575022
curr_Factors:  [102.95061327]
mat_Sqrt:  [[0.15]]
grads:  [-0.02859839]
Stock Position:  -0.028598386822457075
Bond Position:  [-0.01195664]


portfolio before change:  [-2.96374993]
curr_Stock_Price:  103.21535101939425
curr_Factors:  [103.21535102]
mat_Sqrt:  [[0.15]]
grads:  [-0.12585805]
Stock Position:  -0.12585805445518997
Bond Position:  [10.02673334]


portfolio before change:  [-2.91360234]
curr_Stock_Price:  102.82188476136115
curr_Factors:  [102.82188476]
mat_Sqrt:  [[0.15]]
grads:  [0.13956525]
Stock Position:  0.13956524829233571
Bond Position:  [-17.26396421]


portfolio before change:  [-2.84702465]
curr_Stock_Price:  103.30665244643882
curr_Factors:  [103.30665245]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007827]
Stock Position:  -0.010078273866919302
Bond Position:  [-1.80587191]


portfolio before change:  [-2.84881046]
curr_Stock_Price:  103.47264692616862
curr_Factors:  [103.47264693]
mat_Sqrt:  [[0.15]]
grads:  [0.02649497]
Stock Position:  0.02649497142903444
Bond Position:  [-5.59031528]


portfolio before change:  [-2.84706848]
curr_Stock_Price:  103.55158181941418
curr_Factors:  [103.55158182]
mat_Sqrt:  [[0.15]]
grads:  [-0.10985625]
Stock Position:  -0.10985624946102661
Bond Position:  [8.52871992]


portfolio before change:  [-2.83971128]
curr_Stock_Price:  103.48946296748312
curr_Factors:  [103.48946297]
mat_Sqrt:  [[0.15]]
grads:  [0.09722107]
Stock Position:  0.09722107140800094
Bond Position:  [-12.90106775]


portfolio before change:  [-2.75120233]
curr_Stock_Price:  104.4081453520317
curr_Factors:  [104.40814535]
mat_Sqrt:  [[0.15]]
grads:  [0.08669629]
Stock Position:  0.08669628998663498
Bond Position:  [-11.80300118]


portfolio before change:  [-2.71340309]
curr_Stock_Price:  104.85265057173444
curr_Factors:  [104.85265057]
mat_Sqrt:  [[0.15]]
grads:  [0.0449311]
Stock Position:  0.044931103389106074
Bond Position:  [-7.42454837]


portfolio before change:  [-2.7079862]
curr_Stock_Price:  104.98353843355996
curr_Factors:  [104.98353843]
mat_Sqrt:  [[0.15]]
grads:  [-0.05022406]
Stock Position:  -0.050224063145970985
Bond Position:  [2.56471366]


portfolio before change:  [-2.70051842]
curr_Stock_Price:  104.83804074685668
curr_Factors:  [104.83804075]
mat_Sqrt:  [[0.15]]
grads:  [-0.0042869]
Stock Position:  -0.004286901194904119
Bond Position:  [-2.2510881]


portfolio before change:  [-2.69709722]
curr_Stock_Price:  104.00716231900073
curr_Factors:  [104.00716232]
mat_Sqrt:  [[0.15]]
grads:  [0.02003779]
Stock Position:  0.020037790675340464
Bond Position:  [-4.78117097]


portfolio before change:  [-2.69334236]
curr_Stock_Price:  104.20946492641632
curr_Factors:  [104.20946493]
mat_Sqrt:  [[0.15]]
grads:  [-0.0612796]
Stock Position:  -0.06127960099639539
Bond Position:  [3.69257207]


portfolio before change:  [-2.71133294]
curr_Stock_Price:  104.50681310005659
curr_Factors:  [104.5068131]
mat_Sqrt:  [[0.15]]
grads:  [0.03941407]
Stock Position:  0.0394140716976942
Bond Position:  [-6.83037197]


portfolio before change:  [-2.7091956]
curr_Stock_Price:  104.5718725495265
curr_Factors:  [104.57187255]
mat_Sqrt:  [[0.15]]
grads:  [-0.08158228]
Stock Position:  -0.08158227601005566
Bond Position:  [5.82201577]


portfolio before change:  [-2.73100027]
curr_Stock_Price:  104.84360516553764
curr_Factors:  [104.84360517]
mat_Sqrt:  [[0.15]]
grads:  [0.11937628]
Stock Position:  0.11937627987101243
Bond Position:  [-15.24683983]


portfolio before change:  [-2.63066713]
curr_Stock_Price:  105.69206602886078
curr_Factors:  [105.69206603]
mat_Sqrt:  [[0.15]]
grads:  [0.09074507]
Stock Position:  0.09074507251225039
Bond Position:  [-12.22170133]


portfolio before change:  [-2.55984349]
curr_Stock_Price:  106.48095201895498
curr_Factors:  [106.48095202]
mat_Sqrt:  [[0.15]]
grads:  [0.01146926]
Stock Position:  0.011469255815707409
Bond Position:  [-3.78110077]


portfolio before change:  [-2.55911342]
curr_Stock_Price:  106.56521231445909
curr_Factors:  [106.56521231]
mat_Sqrt:  [[0.15]]
grads:  [0.01313824]
Stock Position:  0.013138235920599083
Bond Position:  [-3.95919232]


portfolio before change:  [-2.55066181]
curr_Stock_Price:  107.22733080576526
curr_Factors:  [107.22733081]
mat_Sqrt:  [[0.15]]
grads:  [-0.00129485]
Stock Position:  -0.0012948475823606107
Bond Position:  [-2.41181876]


portfolio before change:  [-2.55097059]
curr_Stock_Price:  107.34938329372179
curr_Factors:  [107.34938329]
mat_Sqrt:  [[0.15]]
grads:  [0.13581223]
Stock Position:  0.1358122323431168
Bond Position:  [-17.13032997]


portfolio before change:  [-2.50223891]
curr_Stock_Price:  107.71608337446447
curr_Factors:  [107.71608337]
mat_Sqrt:  [[0.15]]
grads:  [0.33310969]
Stock Position:  0.3331096904567606
Bond Position:  [-38.3835101]


portfolio before change:  [-2.46527228]
curr_Stock_Price:  107.83425967811026
curr_Factors:  [107.83425968]
mat_Sqrt:  [[0.15]]
grads:  [-0.03835989]
Stock Position:  -0.03835989205727015
Bond Position:  [1.67123828]


portfolio before change:  [-2.47732503]
curr_Stock_Price:  108.15118461001681
curr_Factors:  [108.15118461]
mat_Sqrt:  [[0.15]]
grads:  [-0.07790038]
Stock Position:  -0.07790037574627383
Bond Position:  [5.94769288]


portfolio before change:  [-2.52281247]
curr_Stock_Price:  108.73987466835628
curr_Factors:  [108.73987467]
mat_Sqrt:  [[0.15]]
grads:  [0.13356301]
Stock Position:  0.133563014357744
Bond Position:  [-17.04643791]


portfolio before change:  [-2.45606888]
curr_Stock_Price:  109.24756780182366
curr_Factors:  [109.2475678]
mat_Sqrt:  [[0.15]]
grads:  [0.07288354]
Stock Position:  0.0728835379376773
Bond Position:  [-10.41841813]


portfolio before change:  [-2.52086526]
curr_Stock_Price:  108.367462180606
curr_Factors:  [108.36746218]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004199]
Stock Position:  -0.030041990591350015
Bond Position:  [0.73470902]


portfolio before change:  [-2.5310157]
curr_Stock_Price:  108.70686586743943
curr_Factors:  [108.70686587]
mat_Sqrt:  [[0.15]]
grads:  [0.10569736]
Stock Position:  0.10569735646550937
Bond Position:  [-14.02104406]


portfolio before change:  [-2.48678973]
curr_Stock_Price:  109.13357775855638
curr_Factors:  [109.13357776]
mat_Sqrt:  [[0.15]]
grads:  [-0.17217512]
Stock Position:  -0.17217511666384844
Bond Position:  [16.30329676]


portfolio before change:  [-2.19827121]
curr_Stock_Price:  107.46376894544795
curr_Factors:  [107.46376895]
mat_Sqrt:  [[0.15]]
grads:  [-0.25286627]
Stock Position:  -0.25286626916335925
Bond Position:  [24.97569111]


portfolio before change:  [-2.1520071]
curr_Stock_Price:  107.28698345946165
curr_Factors:  [107.28698346]
mat_Sqrt:  [[0.15]]
grads:  [-0.04166565]
Stock Position:  -0.04166564611878176
Bond Position:  [2.31817439]


portfolio before change:  [-2.18059004]
curr_Stock_Price:  107.9764682951779
curr_Factors:  [107.9764683]
mat_Sqrt:  [[0.15]]
grads:  [0.10884786]
Stock Position:  0.10884786453009825
Bond Position:  [-13.93359803]


portfolio before change:  [-2.24549778]
curr_Stock_Price:  107.38815294124639
curr_Factors:  [107.38815294]
mat_Sqrt:  [[0.15]]
grads:  [-0.18495185]
Stock Position:  -0.18495185280266532
Bond Position:  [17.61614007]


portfolio before change:  [-2.28042794]
curr_Stock_Price:  107.58296687610262
curr_Factors:  [107.58296688]
mat_Sqrt:  [[0.15]]
grads:  [0.18982867]
Stock Position:  0.18982867484366517
Bond Position:  [-22.70275998]


portfolio before change:  [-2.39715951]
curr_Stock_Price:  106.97551066690556
curr_Factors:  [106.97551067]
mat_Sqrt:  [[0.15]]
grads:  [-0.19123499]
Stock Position:  -0.1912349865045848
Bond Position:  [18.06030083]


portfolio before change:  [-2.33536608]
curr_Stock_Price:  106.65828508535931
curr_Factors:  [106.65828509]
mat_Sqrt:  [[0.15]]
grads:  [0.02952405]
Stock Position:  0.02952404593501801
Bond Position:  [-5.48435019]


portfolio before change:  [-2.33228646]
curr_Stock_Price:  106.77420430268053
curr_Factors:  [106.7742043]
mat_Sqrt:  [[0.15]]
grads:  [0.03935791]
Stock Position:  0.039357910594755664
Bond Position:  [-6.53469604]


portfolio before change:  [-2.35625242]
curr_Stock_Price:  106.17565811202996
curr_Factors:  [106.17565811]
mat_Sqrt:  [[0.15]]
grads:  [-0.09203559]
Stock Position:  -0.09203559092495829
Bond Position:  [7.41568702]


portfolio before change:  [-2.34782592]
curr_Stock_Price:  106.08913721806971
curr_Factors:  [106.08913722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.34782592]
Stock Price:  106.08603338875525
PL:  [-8.43385931]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.82659995e-03]
 [-3.00071977e-02]
 [-1.07296192e-02]
 [ 6.25604411e-04]
 [-1.20966956e-02]
 [-4.77843164e-04]
 [ 7.43034433e-03]
 [-2.99424567e-02]
 [-6.10335883e-02]
 [ 4.98028400e-02]
 [-1.11607013e-01]
 [ 3.36459422e-02]
 [-7.07634530e-03]
 [-6.98008072e-03]
 [-7.11955711e-03]
 [ 9.71327540e-03]
 [ 1.42864968e-02]
 [ 1.27394965e-02]
 [ 2.28462517e-03]
 [ 1.06682010e-02]
 [ 1.24603405e-02]
 [-9.80428833e-03]
 [ 5.31654693e-03]
 [-9.50113291e-03]
 [-9.68138780e-03]
 [-7.52674664e-03]
 [-2.29640608e-03]
 [ 8.30975800e-03]
 [-2.22148118e-02]
 [ 1.62800600e-03]
 [ 7.35208606e-04]
 [-1.01072477e-02]
 [-9.24002338e-03]
 [ 5.44316675e-03]
 [ 1.28287260e-02]
 [ 1.71025132e-02]
 [-3.45355555e-02]
 [ 8.62503685e-03]
 [-2.37309960e-02]
 [ 2.44113732e-02]
 [-5.00818882e-03]
 [-1.17281671e-02]
 [ 2.35320975e-02]
 [ 4.04470910e-03]
 [-8.16462616e-03]
 [-3.42159665e-03]
 [ 4.65892320e-03]
 [-8.97803862e-03]
 [-9.04402071e-03]
 [-7.50237821e-03]
 [-1.36359243e-02]
 [-1.48031214e-04]
 [ 2.61253502e-04]
 [ 5.38613699e-03]
 [ 5.48879703e-03]
 [-3.32131426e-03]
 [ 7.25312141e-03]
 [-3.39508877e-04]
 [ 1.54235873e-03]
 [ 3.64204789e-03]
 [ 1.13454312e-03]
 [-2.82956950e-03]
 [-4.39610114e-03]
 [-1.70870194e-02]
 [-1.31253082e-02]
 [-1.00138611e-03]
 [-5.00196022e-03]
 [ 2.06723532e-02]
 [-9.48563121e-03]
 [ 6.07162107e-03]
 [-7.69897103e-03]
 [ 1.09782468e-02]
 [-5.15801752e-03]
 [ 8.87486199e-03]
 [-1.43574142e-02]
 [-8.12663976e-03]
 [ 1.18303594e-03]
 [ 4.41223682e-03]
 [-4.13539740e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.16003443]
curr_Stock_Price:  99.01151585753345
curr_Factors:  [99.01151586]
mat_Sqrt:  [[0.15]]
grads:  [0.05217733]
Stock Position:  0.05217733301893788
Bond Position:  [-18.32619127]


portfolio before change:  [-13.18454286]
curr_Stock_Price:  98.56375430375628
curr_Factors:  [98.5637543]
mat_Sqrt:  [[0.15]]
grads:  [-0.20004798]
Stock Position:  -0.20004798446341499
Bond Position:  [6.53293753]


portfolio before change:  [-12.96384315]
curr_Stock_Price:  97.46256155016722
curr_Factors:  [97.46256155]
mat_Sqrt:  [[0.15]]
grads:  [-0.07153079]
Stock Position:  -0.0715307949760782
Bond Position:  [-5.99226864]


portfolio before change:  [-12.92315129]
curr_Stock_Price:  96.8884537780356
curr_Factors:  [96.88845378]
mat_Sqrt:  [[0.15]]
grads:  [0.0041707]
Stock Position:  0.004170696075757932
Bond Position:  [-13.32724359]


portfolio before change:  [-12.92332224]
curr_Stock_Price:  97.04718634135263
curr_Factors:  [97.04718634]
mat_Sqrt:  [[0.15]]
grads:  [-0.08064464]
Stock Position:  -0.08064463707701171
Bond Position:  [-5.09698712]


portfolio before change:  [-12.8524828]
curr_Stock_Price:  96.16482119325967
curr_Factors:  [96.16482119]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318562]
Stock Position:  -0.0031856210922777814
Bond Position:  [-12.54613812]


portfolio before change:  [-12.85355929]
curr_Stock_Price:  96.25658828220567
curr_Factors:  [96.25658828]
mat_Sqrt:  [[0.15]]
grads:  [0.04953563]
Stock Position:  0.04953562889473991
Bond Position:  [-17.62168993]


portfolio before change:  [-12.83067954]
curr_Stock_Price:  96.74070742576251
curr_Factors:  [96.74070743]
mat_Sqrt:  [[0.15]]
grads:  [-0.19961638]
Stock Position:  -0.19961637787486194
Bond Position:  [6.48035007]


portfolio before change:  [-12.67340715]
curr_Stock_Price:  95.95486332591904
curr_Factors:  [95.95486333]
mat_Sqrt:  [[0.15]]
grads:  [-0.40689059]
Stock Position:  -0.40689058881980406
Bond Position:  [26.36972369]


portfolio before change:  [-12.58136755]
curr_Stock_Price:  95.73271160449696
curr_Factors:  [95.7327116]
mat_Sqrt:  [[0.15]]
grads:  [0.33201893]
Stock Position:  0.33201893332158683
Bond Position:  [-44.36644034]


portfolio before change:  [-12.36915378]
curr_Stock_Price:  96.38022515147853
curr_Factors:  [96.38022515]
mat_Sqrt:  [[0.15]]
grads:  [-0.74404675]
Stock Position:  -0.7440467502711563
Bond Position:  [59.34223954]


portfolio before change:  [-12.56779433]
curr_Stock_Price:  96.65218328050808
curr_Factors:  [96.65218328]
mat_Sqrt:  [[0.15]]
grads:  [0.22430628]
Stock Position:  0.2243062813927511
Bond Position:  [-34.24748615]


portfolio before change:  [-12.64951243]
curr_Stock_Price:  96.29741139932908
curr_Factors:  [96.2974114]
mat_Sqrt:  [[0.15]]
grads:  [-0.04717564]
Stock Position:  -0.047175635353856216
Bond Position:  [-8.10662086]


portfolio before change:  [-12.5978547]
curr_Stock_Price:  95.19166244503617
curr_Factors:  [95.19166245]
mat_Sqrt:  [[0.15]]
grads:  [-0.04653387]
Stock Position:  -0.04653387143646073
Bond Position:  [-8.16821812]


portfolio before change:  [-12.62972637]
curr_Stock_Price:  95.8656046198186
curr_Factors:  [95.86560462]
mat_Sqrt:  [[0.15]]
grads:  [-0.04746371]
Stock Position:  -0.04746371406184646
Bond Position:  [-8.07958872]


portfolio before change:  [-12.60348811]
curr_Stock_Price:  95.30215844593579
curr_Factors:  [95.30215845]
mat_Sqrt:  [[0.15]]
grads:  [0.06475517]
Stock Position:  0.06475516932599351
Bond Position:  [-18.77479552]


portfolio before change:  [-12.51981933]
curr_Stock_Price:  96.61235876833672
curr_Factors:  [96.61235877]
mat_Sqrt:  [[0.15]]
grads:  [0.09524331]
Stock Position:  0.09524331218184327
Bond Position:  [-21.72150037]


portfolio before change:  [-12.50113364]
curr_Stock_Price:  96.82280209950832
curr_Factors:  [96.8228021]
mat_Sqrt:  [[0.15]]
grads:  [0.08492998]
Stock Position:  0.08492997669110612
Bond Position:  [-20.72429197]


portfolio before change:  [-12.45438505]
curr_Stock_Price:  97.38849051251641
curr_Factors:  [97.38849051]
mat_Sqrt:  [[0.15]]
grads:  [0.01523083]
Stock Position:  0.015230834433516026
Bond Position:  [-13.93769302]


portfolio before change:  [-12.46759226]
curr_Stock_Price:  96.57854940273185
curr_Factors:  [96.5785494]
mat_Sqrt:  [[0.15]]
grads:  [0.07112134]
Stock Position:  0.07112133970166071
Bond Position:  [-19.33638808]


portfolio before change:  [-12.38776844]
curr_Stock_Price:  97.71790342269365
curr_Factors:  [97.71790342]
mat_Sqrt:  [[0.15]]
grads:  [0.08306894]
Stock Position:  0.08306893641220763
Bond Position:  [-20.50509074]


portfolio before change:  [-12.39569375]
curr_Stock_Price:  97.63792518748977
curr_Factors:  [97.63792519]
mat_Sqrt:  [[0.15]]
grads:  [-0.06536192]
Stock Position:  -0.06536192219303863
Bond Position:  [-6.01389128]


portfolio before change:  [-12.39866574]
curr_Stock_Price:  97.67764410734557
curr_Factors:  [97.67764411]
mat_Sqrt:  [[0.15]]
grads:  [0.03544365]
Stock Position:  0.03544364619011322
Bond Position:  [-15.8607176]


portfolio before change:  [-12.40144416]
curr_Stock_Price:  97.62722340147863
curr_Factors:  [97.6272234]
mat_Sqrt:  [[0.15]]
grads:  [-0.06334089]
Stock Position:  -0.0633408860529162
Bond Position:  [-6.21764932]


portfolio before change:  [-12.40432151]
curr_Stock_Price:  97.66651456597123
curr_Factors:  [97.66651457]
mat_Sqrt:  [[0.15]]
grads:  [-0.06454259]
Stock Position:  -0.06454258534238691
Bond Position:  [-6.10067216]


portfolio before change:  [-12.40359304]
curr_Stock_Price:  97.64932013747666
curr_Factors:  [97.64932014]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017831]
Stock Position:  -0.05017831092810535
Bond Position:  [-7.50371509]


portfolio before change:  [-12.40084306]
curr_Stock_Price:  97.58516936232603
curr_Factors:  [97.58516936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01530937]
Stock Position:  -0.015309373893664687
Bond Position:  [-10.90687522]


portfolio before change:  [-12.40693182]
curr_Stock_Price:  97.93835560562762
curr_Factors:  [97.93835561]
mat_Sqrt:  [[0.15]]
grads:  [0.05539839]
Stock Position:  0.0553983866520521
Bond Position:  [-17.83255871]


portfolio before change:  [-12.41518893]
curr_Stock_Price:  97.80942513570082
curr_Factors:  [97.80942514]
mat_Sqrt:  [[0.15]]
grads:  [-0.14809875]
Stock Position:  -0.14809874559294775
Bond Position:  [2.07026424]


portfolio before change:  [-12.38359353]
curr_Stock_Price:  97.59695876252736
curr_Factors:  [97.59695876]
mat_Sqrt:  [[0.15]]
grads:  [0.01085337]
Stock Position:  0.010853373331595372
Bond Position:  [-13.44284976]


portfolio before change:  [-12.38332483]
curr_Stock_Price:  97.69913047818139
curr_Factors:  [97.69913048]
mat_Sqrt:  [[0.15]]
grads:  [0.00490139]
Stock Position:  0.004901390703426773
Bond Position:  [-12.86218644]


portfolio before change:  [-12.38424387]
curr_Stock_Price:  97.67564148691207
curr_Factors:  [97.67564149]
mat_Sqrt:  [[0.15]]
grads:  [-0.06738165]
Stock Position:  -0.06738165145360761
Bond Position:  [-5.80269784]


portfolio before change:  [-12.38934399]
curr_Stock_Price:  97.7459490631122
curr_Factors:  [97.74594906]
mat_Sqrt:  [[0.15]]
grads:  [-0.06160016]
Stock Position:  -0.06160015587622015
Bond Position:  [-6.36817829]


portfolio before change:  [-12.37069004]
curr_Stock_Price:  97.43666449058924
curr_Factors:  [97.43666449]
mat_Sqrt:  [[0.15]]
grads:  [0.03628778]
Stock Position:  0.036287778305345415
Bond Position:  [-15.90645012]


portfolio before change:  [-12.34066021]
curr_Stock_Price:  98.29160835166131
curr_Factors:  [98.29160835]
mat_Sqrt:  [[0.15]]
grads:  [0.08552484]
Stock Position:  0.08552484021571229
Bond Position:  [-20.74703431]


portfolio before change:  [-12.36372708]
curr_Stock_Price:  98.03706071686693
curr_Factors:  [98.03706072]
mat_Sqrt:  [[0.15]]
grads:  [0.11401675]
Stock Position:  0.11401675486707043
Bond Position:  [-23.5415946]


portfolio before change:  [-12.36603285]
curr_Stock_Price:  98.02974274312018
curr_Factors:  [98.02974274]
mat_Sqrt:  [[0.15]]
grads:  [-0.23023704]
Stock Position:  -0.23023703641947332
Bond Position:  [10.2040446]


portfolio before change:  [-12.21704796]
curr_Stock_Price:  97.38541931993386
curr_Factors:  [97.38541932]
mat_Sqrt:  [[0.15]]
grads:  [0.05750025]
Stock Position:  0.05750024564620148
Bond Position:  [-17.8167335]


portfolio before change:  [-12.20161603]
curr_Stock_Price:  97.67316613551209
curr_Factors:  [97.67316614]
mat_Sqrt:  [[0.15]]
grads:  [-0.15820664]
Stock Position:  -0.15820663993879686
Bond Position:  [3.2509274]


portfolio before change:  [-12.41789137]
curr_Stock_Price:  99.04149386024098
curr_Factors:  [99.04149386]
mat_Sqrt:  [[0.15]]
grads:  [0.16274249]
Stock Position:  0.16274248806117092
Bond Position:  [-28.5361505]


portfolio before change:  [-12.41630521]
curr_Stock_Price:  99.0621997205455
curr_Factors:  [99.06219972]
mat_Sqrt:  [[0.15]]
grads:  [-0.03338793]
Stock Position:  -0.0333879254651927
Bond Position:  [-9.10882387]


portfolio before change:  [-12.45087307]
curr_Stock_Price:  100.08048822460175
curr_Factors:  [100.08048822]
mat_Sqrt:  [[0.15]]
grads:  [-0.07818778]
Stock Position:  -0.07818778097584154
Bond Position:  [-4.62580178]


portfolio before change:  [-12.42223857]
curr_Stock_Price:  99.71056304292566
curr_Factors:  [99.71056304]
mat_Sqrt:  [[0.15]]
grads:  [0.15688065]
Stock Position:  0.15688064978527452
Bond Position:  [-28.06489649]


portfolio before change:  [-12.43750209]
curr_Stock_Price:  99.6244503979503
curr_Factors:  [99.6244504]
mat_Sqrt:  [[0.15]]
grads:  [0.02696473]
Stock Position:  0.02696472735414509
Bond Position:  [-15.12384823]


portfolio before change:  [-12.4365202]
curr_Stock_Price:  99.6959200470676
curr_Factors:  [99.69592005]
mat_Sqrt:  [[0.15]]
grads:  [-0.05443084]
Stock Position:  -0.054430841058022636
Bond Position:  [-7.00998742]


portfolio before change:  [-12.44927882]
curr_Stock_Price:  99.92227126661982
curr_Factors:  [99.92227127]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281064]
Stock Position:  -0.022810644363497844
Bond Position:  [-10.16998743]


portfolio before change:  [-12.44717084]
curr_Stock_Price:  99.80199286475363
curr_Factors:  [99.80199286]
mat_Sqrt:  [[0.15]]
grads:  [0.03105949]
Stock Position:  0.031059487978636453
Bond Position:  [-15.54696964]


portfolio before change:  [-12.42012024]
curr_Stock_Price:  100.70420725032882
curr_Factors:  [100.70420725]
mat_Sqrt:  [[0.15]]
grads:  [-0.05985359]
Stock Position:  -0.059853590807390146
Bond Position:  [-6.39261182]


portfolio before change:  [-12.45180216]
curr_Stock_Price:  101.22685548190346
curr_Factors:  [101.22685548]
mat_Sqrt:  [[0.15]]
grads:  [-0.06029347]
Stock Position:  -0.060293471430693385
Bond Position:  [-6.34848364]


portfolio before change:  [-12.49151053]
curr_Stock_Price:  101.8788592905304
curr_Factors:  [101.87885929]
mat_Sqrt:  [[0.15]]
grads:  [-0.05001585]
Stock Position:  -0.05001585473021541
Bond Position:  [-7.3959523]


portfolio before change:  [-12.48456374]
curr_Stock_Price:  101.73072528149237
curr_Factors:  [101.73072528]
mat_Sqrt:  [[0.15]]
grads:  [-0.09090616]
Stock Position:  -0.09090616219945523
Bond Position:  [-3.23661393]


portfolio before change:  [-12.50113659]
curr_Stock_Price:  101.91080722836143
curr_Factors:  [101.91080723]
mat_Sqrt:  [[0.15]]
grads:  [-0.00098687]
Stock Position:  -0.0009868747572573898
Bond Position:  [-12.40056339]


portfolio before change:  [-12.50070779]
curr_Stock_Price:  100.6909378326608
curr_Factors:  [100.69093783]
mat_Sqrt:  [[0.15]]
grads:  [0.00174169]
Stock Position:  0.0017416900153546337
Bond Position:  [-12.67608019]


portfolio before change:  [-12.50240589]
curr_Stock_Price:  100.17085605129456
curr_Factors:  [100.17085605]
mat_Sqrt:  [[0.15]]
grads:  [0.03590758]
Stock Position:  0.03590757990692642
Bond Position:  [-16.09929891]


portfolio before change:  [-12.50398854]
curr_Stock_Price:  100.15480360612551
curr_Factors:  [100.15480361]
mat_Sqrt:  [[0.15]]
grads:  [0.03659198]
Stock Position:  0.036591980229695106
Bond Position:  [-16.16885113]


portfolio before change:  [-12.52692931]
curr_Stock_Price:  99.55548668635417
curr_Factors:  [99.55548669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221421]
Stock Position:  -0.022142095041685676
Bond Position:  [-10.32256227]


portfolio before change:  [-12.50960171]
curr_Stock_Price:  98.74378462257077
curr_Factors:  [98.74378462]
mat_Sqrt:  [[0.15]]
grads:  [0.04835414]
Stock Position:  0.04835414272765411
Bond Position:  [-17.28427277]


portfolio before change:  [-12.51677909]
curr_Stock_Price:  98.6176924617927
curr_Factors:  [98.61769246]
mat_Sqrt:  [[0.15]]
grads:  [-0.00226339]
Stock Position:  -0.002263392512568071
Bond Position:  [-12.29356854]


portfolio before change:  [-12.51784744]
curr_Stock_Price:  98.75022625726169
curr_Factors:  [98.75022626]
mat_Sqrt:  [[0.15]]
grads:  [0.01028239]
Stock Position:  0.01028239154877858
Bond Position:  [-13.53323593]


portfolio before change:  [-12.52156827]
curr_Stock_Price:  98.47062384874877
curr_Factors:  [98.47062385]
mat_Sqrt:  [[0.15]]
grads:  [0.02428032]
Stock Position:  0.024280319261836155
Bond Position:  [-14.91246646]


portfolio before change:  [-12.51757669]
curr_Stock_Price:  98.6734070566387
curr_Factors:  [98.67340706]
mat_Sqrt:  [[0.15]]
grads:  [0.00756362]
Stock Position:  0.00756362082130893
Bond Position:  [-13.26390493]


portfolio before change:  [-12.51727993]
curr_Stock_Price:  98.82224846790193
curr_Factors:  [98.82224847]
mat_Sqrt:  [[0.15]]
grads:  [-0.0188638]
Stock Position:  -0.0188637966900111
Bond Position:  [-10.65311713]


portfolio before change:  [-12.53164769]
curr_Stock_Price:  99.54860903068496
curr_Factors:  [99.54860903]
mat_Sqrt:  [[0.15]]
grads:  [-0.02930734]
Stock Position:  -0.029307340911010178
Bond Position:  [-9.61414267]


portfolio before change:  [-12.51818672]
curr_Stock_Price:  99.06880177539297
curr_Factors:  [99.06880178]
mat_Sqrt:  [[0.15]]
grads:  [-0.11391346]
Stock Position:  -0.11391346285628937
Bond Position:  [-1.23291644]


portfolio before change:  [-12.47377972]
curr_Stock_Price:  98.67829436253383
curr_Factors:  [98.67829436]
mat_Sqrt:  [[0.15]]
grads:  [-0.08750205]
Stock Position:  -0.08750205471209752
Bond Position:  [-3.83922621]


portfolio before change:  [-12.50197604]
curr_Stock_Price:  98.99778803852239
curr_Factors:  [98.99778804]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667591]
Stock Position:  -0.006675907429366917
Bond Position:  [-11.84107597]


portfolio before change:  [-12.50201776]
curr_Stock_Price:  98.8931778161889
curr_Factors:  [98.89317782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0333464]
Stock Position:  -0.03334640147608893
Bond Position:  [-9.20428615]


portfolio before change:  [-12.4925256]
curr_Stock_Price:  98.59127290294424
curr_Factors:  [98.5912729]
mat_Sqrt:  [[0.15]]
grads:  [0.13781569]
Stock Position:  0.13781568805529926
Bond Position:  [-26.07994971]


portfolio before change:  [-12.50029452]
curr_Stock_Price:  98.54672887359992
curr_Factors:  [98.54672887]
mat_Sqrt:  [[0.15]]
grads:  [-0.06323754]
Stock Position:  -0.06323754138815782
Bond Position:  [-6.26844167]


portfolio before change:  [-12.54721024]
curr_Stock_Price:  99.28243009447714
curr_Factors:  [99.28243009]
mat_Sqrt:  [[0.15]]
grads:  [0.04047747]
Stock Position:  0.04047747379037556
Bond Position:  [-16.5659122]


portfolio before change:  [-12.55780603]
curr_Stock_Price:  99.04623985840462
curr_Factors:  [99.04623986]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132647]
Stock Position:  -0.05132647351369661
Bond Position:  [-7.47411182]


portfolio before change:  [-12.53255913]
curr_Stock_Price:  98.54524991339919
curr_Factors:  [98.54524991]
mat_Sqrt:  [[0.15]]
grads:  [0.07318831]
Stock Position:  0.07318831204721847
Bond Position:  [-19.74491963]


portfolio before change:  [-12.49284193]
curr_Stock_Price:  99.10478311955849
curr_Factors:  [99.10478312]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438678]
Stock Position:  -0.0343867834605858
Bond Position:  [-9.08494722]


portfolio before change:  [-12.48778476]
curr_Stock_Price:  98.94120281545119
curr_Factors:  [98.94120282]
mat_Sqrt:  [[0.15]]
grads:  [0.05916575]
Stock Position:  0.059165746572643216
Bond Position:  [-18.34171489]


portfolio before change:  [-12.53841416]
curr_Stock_Price:  98.10485720125557
curr_Factors:  [98.1048572]
mat_Sqrt:  [[0.15]]
grads:  [-0.09571609]
Stock Position:  -0.09571609458170852
Bond Position:  [-3.14820037]


portfolio before change:  [-12.53066538]
curr_Stock_Price:  98.02184550643246
curr_Factors:  [98.02184551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0541776]
Stock Position:  -0.05417759839307992
Bond Position:  [-7.2200772]


portfolio before change:  [-12.53223755]
curr_Stock_Price:  98.04253493596654
curr_Factors:  [98.04253494]
mat_Sqrt:  [[0.15]]
grads:  [0.00788691]
Stock Position:  0.007886906248603746
Bond Position:  [-13.30548983]


portfolio before change:  [-12.5430891]
curr_Stock_Price:  96.77208400199936
curr_Factors:  [96.772084]
mat_Sqrt:  [[0.15]]
grads:  [0.02941491]
Stock Position:  0.029414912140001873
Bond Position:  [-15.38963145]


portfolio before change:  [-12.56532834]
curr_Stock_Price:  96.04873124323494
curr_Factors:  [96.04873124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.56532834]
Stock Price:  95.76794885354785
PL:  [-12.56532834]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.91611640e-04]
 [ 1.91593362e-03]
 [-2.48652021e-03]
 [ 7.27537663e-03]
 [ 4.47411009e-03]
 [ 2.15033774e-02]
 [ 1.07160089e-03]
 [-1.67090092e-02]
 [ 2.42429916e-02]
 [-3.66192318e-03]
 [ 1.30768726e-02]
 [-1.80463438e-02]
 [ 1.10985114e-02]
 [ 8.37322715e-04]
 [-6.90843692e-03]
 [ 1.86430238e-02]
 [ 9.36575980e-03]
 [-1.22649874e-02]
 [ 5.13410980e-04]
 [ 8.45171498e-03]
 [ 1.24619907e-02]
 [-8.87812052e-03]
 [ 7.84574255e-03]
 [ 3.47973007e-02]
 [-8.09794395e-03]
 [-8.96358030e-03]
 [-2.62851475e-03]
 [ 9.04381398e-03]
 [-2.75217470e-02]
 [ 1.63390587e-03]
 [-1.15712152e-03]
 [-1.04165671e-02]
 [-6.12908639e-03]
 [ 4.54893121e-03]
 [ 1.16040056e-02]
 [ 1.30786202e-02]
 [-3.52080820e-02]
 [ 9.65022645e-03]
 [-1.02041671e-02]
 [ 2.30177536e-02]
 [-6.58321621e-03]
 [-1.31564101e-02]
 [ 2.36264597e-02]
 [ 3.97111288e-03]
 [-8.21933845e-03]
 [ 1.51900160e-03]
 [ 1.11509680e-02]
 [-1.10911020e-02]
 [-1.52894998e-02]
 [-6.35718630e-03]
 [ 3.08912366e-02]
 [-9.80469642e-04]
 [-2.81020940e-03]
 [ 5.34465837e-03]
 [ 1.36997745e-03]
 [-1.88698634e-03]
 [ 4.19510128e-03]
 [-3.00447877e-04]
 [ 1.55584623e-03]
 [ 1.32889187e-02]
 [-1.33757170e-03]
 [ 9.60990186e-04]
 [-1.47551368e-03]
 [-1.24714758e-02]
 [-3.60211604e-03]
 [ 1.05072355e-03]
 [-5.41975222e-03]
 [ 1.50305392e-02]
 [-8.25831390e-03]
 [ 1.09358045e-02]
 [-1.30054114e-02]
 [ 1.27249598e-02]
 [ 1.65278360e-03]
 [ 2.41146051e-02]
 [-2.24878328e-02]
 [-1.10885211e-03]
 [-8.97323774e-03]
 [-3.59460504e-03]
 [ 3.05815326e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.60227082]
curr_Stock_Price:  100.16650902630751
curr_Factors:  [100.16650903]
mat_Sqrt:  [[0.15]]
grads:  [0.00527741]
Stock Position:  0.005277410930732392
Bond Position:  [4.07365099]


portfolio before change:  [4.60542862]
curr_Stock_Price:  100.71662496543082
curr_Factors:  [100.71662497]
mat_Sqrt:  [[0.15]]
grads:  [0.01277289]
Stock Position:  0.012772890808260265
Bond Position:  [3.31898616]


portfolio before change:  [4.60354909]
curr_Stock_Price:  100.55323419722986
curr_Factors:  [100.5532342]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165768]
Stock Position:  -0.016576801413510586
Bond Position:  [6.27040008]


portfolio before change:  [4.61137333]
curr_Stock_Price:  100.10487704097795
curr_Factors:  [100.10487704]
mat_Sqrt:  [[0.15]]
grads:  [0.04850251]
Stock Position:  0.04850251085106817
Bond Position:  [-0.24396456]


portfolio before change:  [4.58400075]
curr_Stock_Price:  99.54083760748499
curr_Factors:  [99.54083761]
mat_Sqrt:  [[0.15]]
grads:  [0.0298274]
Stock Position:  0.029827400626770407
Bond Position:  [1.61495631]


portfolio before change:  [4.58493967]
curr_Stock_Price:  99.5689319429268
curr_Factors:  [99.56893194]
mat_Sqrt:  [[0.15]]
grads:  [0.14335585]
Stock Position:  0.14335584946218047
Bond Position:  [-9.68884915]


portfolio before change:  [4.63325774]
curr_Stock_Price:  99.91020609664102
curr_Factors:  [99.9102061]
mat_Sqrt:  [[0.15]]
grads:  [0.00714401]
Stock Position:  0.007144005902096025
Bond Position:  [3.91949864]


portfolio before change:  [4.63473719]
curr_Stock_Price:  100.08300485041339
curr_Factors:  [100.08300485]
mat_Sqrt:  [[0.15]]
grads:  [-0.11139339]
Stock Position:  -0.11139339469758543
Bond Position:  [15.78332286]


portfolio before change:  [4.60094988]
curr_Stock_Price:  100.3951759665918
curr_Factors:  [100.39517597]
mat_Sqrt:  [[0.15]]
grads:  [0.16161994]
Stock Position:  0.16161994369971175
Bond Position:  [-11.6249128]


portfolio before change:  [4.52809906]
curr_Stock_Price:  99.94891768719165
curr_Factors:  [99.94891769]
mat_Sqrt:  [[0.15]]
grads:  [-0.02441282]
Stock Position:  -0.024412821210345072
Bond Position:  [6.96813412]


portfolio before change:  [4.52893782]
curr_Stock_Price:  99.9324003631729
curr_Factors:  [99.93240036]
mat_Sqrt:  [[0.15]]
grads:  [0.08717915]
Stock Position:  0.08717915070518464
Bond Position:  [-4.18308397]


portfolio before change:  [4.57889367]
curr_Stock_Price:  100.50842455801005
curr_Factors:  [100.50842456]
mat_Sqrt:  [[0.15]]
grads:  [-0.12030896]
Stock Position:  -0.12030895851094209
Bond Position:  [16.67095755]


portfolio before change:  [4.56817996]
curr_Stock_Price:  100.60613694569466
curr_Factors:  [100.60613695]
mat_Sqrt:  [[0.15]]
grads:  [0.07399008]
Stock Position:  0.07399007593933707
Bond Position:  [-2.87567575]


portfolio before change:  [4.57330165]
curr_Stock_Price:  100.6777874149653
curr_Factors:  [100.67778741]
mat_Sqrt:  [[0.15]]
grads:  [0.00558215]
Stock Position:  0.005582151430031062
Bond Position:  [4.011303]


portfolio before change:  [4.57523484]
curr_Stock_Price:  100.97919002889219
curr_Factors:  [100.97919003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605625]
Stock Position:  -0.046056246129334115
Bond Position:  [9.22595727]


portfolio before change:  [4.57841984]
curr_Stock_Price:  100.92255577447769
curr_Factors:  [100.92255577]
mat_Sqrt:  [[0.15]]
grads:  [0.12428683]
Stock Position:  0.1242868252737888
Bond Position:  [-7.96492421]


portfolio before change:  [4.53615351]
curr_Stock_Price:  100.58649029403793
curr_Factors:  [100.58649029]
mat_Sqrt:  [[0.15]]
grads:  [0.0624384]
Stock Position:  0.06243839864574293
Bond Position:  [-1.74430587]


portfolio before change:  [4.49168174]
curr_Stock_Price:  99.87598613189174
curr_Factors:  [99.87598613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08176658]
Stock Position:  -0.08176658248973011
Bond Position:  [12.6581998]


portfolio before change:  [4.57860337]
curr_Stock_Price:  98.82261610063367
curr_Factors:  [98.8226161]
mat_Sqrt:  [[0.15]]
grads:  [0.00342274]
Stock Position:  0.0034227398693417676
Bond Position:  [4.24035926]


portfolio before change:  [4.57355019]
curr_Stock_Price:  97.26882878203712
curr_Factors:  [97.26882878]
mat_Sqrt:  [[0.15]]
grads:  [0.05634477]
Stock Position:  0.05634476654506962
Bond Position:  [-0.90703926]


portfolio before change:  [4.59859971]
curr_Stock_Price:  97.71441062961489
curr_Factors:  [97.71441063]
mat_Sqrt:  [[0.15]]
grads:  [0.08307994]
Stock Position:  0.08307993832809353
Bond Position:  [-3.5195075]


portfolio before change:  [4.67391349]
curr_Stock_Price:  98.62358027305666
curr_Factors:  [98.62358027]
mat_Sqrt:  [[0.15]]
grads:  [-0.05918747]
Stock Position:  -0.05918747014576241
Bond Position:  [10.5111937]


portfolio before change:  [4.66263276]
curr_Stock_Price:  98.82527324899519
curr_Factors:  [98.82527325]
mat_Sqrt:  [[0.15]]
grads:  [0.05230495]
Stock Position:  0.05230495031419238
Bond Position:  [-0.50641825]


portfolio before change:  [4.69559025]
curr_Stock_Price:  99.45598112239838
curr_Factors:  [99.45598112]
mat_Sqrt:  [[0.15]]
grads:  [0.231982]
Stock Position:  0.23198200452464413
Bond Position:  [-18.37640761]


portfolio before change:  [4.50491294]
curr_Stock_Price:  98.63898346791588
curr_Factors:  [98.63898347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05398629]
Stock Position:  -0.053986292969448034
Bond Position:  [9.830066]


portfolio before change:  [4.54350129]
curr_Stock_Price:  97.93558354770676
curr_Factors:  [97.93558355]
mat_Sqrt:  [[0.15]]
grads:  [-0.0597572]
Stock Position:  -0.05975720201728698
Bond Position:  [10.39585774]


portfolio before change:  [4.5554786]
curr_Stock_Price:  97.7460239885774
curr_Factors:  [97.74602399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752343]
Stock Position:  -0.01752343168351374
Bond Position:  [6.26832437]


portfolio before change:  [4.55961007]
curr_Stock_Price:  97.53261324406681
curr_Factors:  [97.53261324]
mat_Sqrt:  [[0.15]]
grads:  [0.06029209]
Stock Position:  0.06029209322682003
Bond Position:  [-1.32083534]


portfolio before change:  [4.55143724]
curr_Stock_Price:  97.3984286124526
curr_Factors:  [97.39842861]
mat_Sqrt:  [[0.15]]
grads:  [-0.18347831]
Stock Position:  -0.18347831329604916
Bond Position:  [22.42193664]


portfolio before change:  [4.51691079]
curr_Stock_Price:  97.59424394255366
curr_Factors:  [97.59424394]
mat_Sqrt:  [[0.15]]
grads:  [0.01089271]
Stock Position:  0.010892705801307722
Bond Position:  [3.45384541]


portfolio before change:  [4.52196185]
curr_Stock_Price:  98.03813629721195
curr_Factors:  [98.0381363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00771414]
Stock Position:  -0.007714143486405783
Bond Position:  [5.2782421]


portfolio before change:  [4.51299068]
curr_Stock_Price:  99.24385368149736
curr_Factors:  [99.24385368]
mat_Sqrt:  [[0.15]]
grads:  [-0.06944378]
Stock Position:  -0.06944378094163442
Bond Position:  [11.40485911]


portfolio before change:  [4.54310975]
curr_Stock_Price:  98.82039970107233
curr_Factors:  [98.8203997]
mat_Sqrt:  [[0.15]]
grads:  [-0.04086058]
Stock Position:  -0.04086057593279922
Bond Position:  [8.58096819]


portfolio before change:  [4.5199423]
curr_Stock_Price:  99.40051332313186
curr_Factors:  [99.40051332]
mat_Sqrt:  [[0.15]]
grads:  [0.03032621]
Stock Position:  0.03032620808746184
Bond Position:  [1.50550165]


portfolio before change:  [4.54129127]
curr_Stock_Price:  100.10138810363966
curr_Factors:  [100.1013881]
mat_Sqrt:  [[0.15]]
grads:  [0.07736004]
Stock Position:  0.07736003754914776
Bond Position:  [-3.20255587]


portfolio before change:  [4.51676412]
curr_Stock_Price:  99.78692358930392
curr_Factors:  [99.78692359]
mat_Sqrt:  [[0.15]]
grads:  [0.0871908]
Stock Position:  0.0871908012211237
Bond Position:  [-4.1837377]


portfolio before change:  [4.48176025]
curr_Stock_Price:  99.38845978588228
curr_Factors:  [99.38845979]
mat_Sqrt:  [[0.15]]
grads:  [-0.23472055]
Stock Position:  -0.23472054634808168
Bond Position:  [27.81027383]


portfolio before change:  [4.35309412]
curr_Stock_Price:  99.94403246868389
curr_Factors:  [99.94403247]
mat_Sqrt:  [[0.15]]
grads:  [0.06433484]
Stock Position:  0.0643348430071934
Bond Position:  [-2.07678952]


portfolio before change:  [4.35168736]
curr_Stock_Price:  99.9241837853626
curr_Factors:  [99.92418379]
mat_Sqrt:  [[0.15]]
grads:  [-0.06802778]
Stock Position:  -0.06802778062153746
Bond Position:  [11.14930781]


portfolio before change:  [4.32502105]
curr_Stock_Price:  100.32641878485734
curr_Factors:  [100.32641878]
mat_Sqrt:  [[0.15]]
grads:  [0.15345169]
Stock Position:  0.1534516905309353
Bond Position:  [-11.07023751]


portfolio before change:  [4.27865226]
curr_Stock_Price:  100.02875583633468
curr_Factors:  [100.02875584]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388811]
Stock Position:  -0.043888108051846925
Bond Position:  [8.6687251]


portfolio before change:  [4.26861275]
curr_Stock_Price:  100.26985351477782
curr_Factors:  [100.26985351]
mat_Sqrt:  [[0.15]]
grads:  [-0.0877094]
Stock Position:  -0.08770940069459478
Bond Position:  [13.06322151]


portfolio before change:  [4.3053078]
curr_Stock_Price:  99.86079168519393
curr_Factors:  [99.86079169]
mat_Sqrt:  [[0.15]]
grads:  [0.15750973]
Stock Position:  0.15750973118385878
Bond Position:  [-11.42373866]


portfolio before change:  [4.29033252]
curr_Stock_Price:  99.77024951924206
curr_Factors:  [99.77024952]
mat_Sqrt:  [[0.15]]
grads:  [0.02647409]
Stock Position:  0.026474085893418847
Bond Position:  [1.64900636]


portfolio before change:  [4.29450619]
curr_Stock_Price:  99.92400751609851
curr_Factors:  [99.92400752]
mat_Sqrt:  [[0.15]]
grads:  [-0.05479559]
Stock Position:  -0.05479558969106495
Bond Position:  [9.7699011]


portfolio before change:  [4.25905786]
curr_Stock_Price:  100.58207069509383
curr_Factors:  [100.5820707]
mat_Sqrt:  [[0.15]]
grads:  [0.01012668]
Stock Position:  0.010126677304253956
Bond Position:  [3.24049569]


portfolio before change:  [4.26591211]
curr_Stock_Price:  101.2389204617025
curr_Factors:  [101.23892046]
mat_Sqrt:  [[0.15]]
grads:  [0.07433979]
Stock Position:  0.07433978688235711
Bond Position:  [-3.26016766]


portfolio before change:  [4.1966658]
curr_Stock_Price:  100.31017766126381
curr_Factors:  [100.31017766]
mat_Sqrt:  [[0.15]]
grads:  [-0.07394068]
Stock Position:  -0.07394067967712135
Bond Position:  [11.61366851]


portfolio before change:  [4.2163011]
curr_Stock_Price:  100.0544399271218
curr_Factors:  [100.05443993]
mat_Sqrt:  [[0.15]]
grads:  [-0.10193]
Stock Position:  -0.10192999870118477
Bond Position:  [14.41485003]


portfolio before change:  [4.24699471]
curr_Stock_Price:  99.76215449589988
curr_Factors:  [99.7621545]
mat_Sqrt:  [[0.15]]
grads:  [-0.04238124]
Stock Position:  -0.04238124197292921
Bond Position:  [8.47503872]


portfolio before change:  [4.20709015]
curr_Stock_Price:  100.71621483886834
curr_Factors:  [100.71621484]
mat_Sqrt:  [[0.15]]
grads:  [0.20594158]
Stock Position:  0.2059415776504817
Bond Position:  [-16.53456603]


portfolio before change:  [4.42590854]
curr_Stock_Price:  101.78375949795377
curr_Factors:  [101.7837595]
mat_Sqrt:  [[0.15]]
grads:  [-0.00653646]
Stock Position:  -0.006536464281089657
Bond Position:  [5.09121445]


portfolio before change:  [4.4286512]
curr_Stock_Price:  101.41284883106756
curr_Factors:  [101.41284883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01873473]
Stock Position:  -0.01873472931131363
Bond Position:  [6.32859347]


portfolio before change:  [4.42991587]
curr_Stock_Price:  101.36645770884618
curr_Factors:  [101.36645771]
mat_Sqrt:  [[0.15]]
grads:  [0.03563106]
Stock Position:  0.035631055788608944
Bond Position:  [0.81812196]


portfolio before change:  [4.44700629]
curr_Stock_Price:  101.84467228231443
curr_Factors:  [101.84467228]
mat_Sqrt:  [[0.15]]
grads:  [0.00913318]
Stock Position:  0.009133182989234968
Bond Position:  [3.51684027]


portfolio before change:  [4.43989453]
curr_Stock_Price:  101.04193228712548
curr_Factors:  [101.04193229]
mat_Sqrt:  [[0.15]]
grads:  [-0.01257991]
Stock Position:  -0.012579908914567204
Bond Position:  [5.71099284]


portfolio before change:  [4.44165991]
curr_Stock_Price:  100.92997334525775
curr_Factors:  [100.92997335]
mat_Sqrt:  [[0.15]]
grads:  [0.02796734]
Stock Position:  0.027967341865479754
Bond Position:  [1.61891685]


portfolio before change:  [4.42959923]
curr_Stock_Price:  100.49511368057712
curr_Factors:  [100.49511368]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200299]
Stock Position:  -0.002002985847257254
Bond Position:  [4.63088952]


portfolio before change:  [4.43090143]
curr_Stock_Price:  99.98948859797677
curr_Factors:  [99.9894886]
mat_Sqrt:  [[0.15]]
grads:  [0.01037231]
Stock Position:  0.010372308182742061
Bond Position:  [3.39377964]


portfolio before change:  [4.44316591]
curr_Stock_Price:  101.15146376052827
curr_Factors:  [101.15146376]
mat_Sqrt:  [[0.15]]
grads:  [0.08859279]
Stock Position:  0.088592791586974
Bond Position:  [-4.51812463]


portfolio before change:  [4.50448551]
curr_Stock_Price:  101.84680232981223
curr_Factors:  [101.84680233]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891714]
Stock Position:  -0.00891714464122715
Bond Position:  [5.41266817]


portfolio before change:  [4.50492909]
curr_Stock_Price:  101.83499527796647
curr_Factors:  [101.83499528]
mat_Sqrt:  [[0.15]]
grads:  [0.0064066]
Stock Position:  0.00640660124158266
Bond Position:  [3.85251289]


portfolio before change:  [4.50805918]
curr_Stock_Price:  102.28598264101025
curr_Factors:  [102.28598264]
mat_Sqrt:  [[0.15]]
grads:  [-0.00983676]
Stock Position:  -0.009836757872134344
Bond Position:  [5.51422162]


portfolio before change:  [4.51117026]
curr_Stock_Price:  102.00474840024944
curr_Factors:  [102.0047484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08314317]
Stock Position:  -0.08314317174122439
Bond Position:  [12.99216858]


portfolio before change:  [4.5486372]
curr_Stock_Price:  101.56388357745097
curr_Factors:  [101.56388358]
mat_Sqrt:  [[0.15]]
grads:  [-0.02401411]
Stock Position:  -0.024014106920772632
Bond Position:  [6.98760316]


portfolio before change:  [4.52486195]
curr_Stock_Price:  102.57212391888345
curr_Factors:  [102.57212392]
mat_Sqrt:  [[0.15]]
grads:  [0.00700482]
Stock Position:  0.007004823681810157
Bond Position:  [3.8063623]


portfolio before change:  [4.53079532]
curr_Stock_Price:  103.3852018495907
curr_Factors:  [103.38520185]
mat_Sqrt:  [[0.15]]
grads:  [-0.03613168]
Stock Position:  -0.0361316814820586
Bond Position:  [8.2662765]


portfolio before change:  [4.54306492]
curr_Stock_Price:  103.05992108014205
curr_Factors:  [103.05992108]
mat_Sqrt:  [[0.15]]
grads:  [0.10020359]
Stock Position:  0.10020359472412767
Bond Position:  [-5.78390965]


portfolio before change:  [4.48285235]
curr_Stock_Price:  102.4626265454665
curr_Factors:  [102.46262655]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505543]
Stock Position:  -0.055055426014735134
Bond Position:  [10.12397591]


portfolio before change:  [4.47845564]
curr_Stock_Price:  102.55397965236274
curr_Factors:  [102.55397965]
mat_Sqrt:  [[0.15]]
grads:  [0.07290536]
Stock Position:  0.07290536339914051
Bond Position:  [-2.99827952]


portfolio before change:  [4.53424712]
curr_Stock_Price:  103.32180899506824
curr_Factors:  [103.321809]
mat_Sqrt:  [[0.15]]
grads:  [-0.08670274]
Stock Position:  -0.08670274249448193
Bond Position:  [13.49253131]


portfolio before change:  [4.54458779]
curr_Stock_Price:  103.21226965039786
curr_Factors:  [103.21226965]
mat_Sqrt:  [[0.15]]
grads:  [0.08483307]
Stock Position:  0.08483306512583212
Bond Position:  [-4.21122541]


portfolio before change:  [4.56190247]
curr_Stock_Price:  103.41947529172205
curr_Factors:  [103.41947529]
mat_Sqrt:  [[0.15]]
grads:  [0.01101856]
Stock Position:  0.011018557347587324
Bond Position:  [3.42236905]


portfolio before change:  [4.56787244]
curr_Stock_Price:  103.94187288141713
curr_Factors:  [103.94187288]
mat_Sqrt:  [[0.15]]
grads:  [0.16076403]
Stock Position:  0.16076403416462443
Bond Position:  [-12.14224236]


portfolio before change:  [4.42202031]
curr_Stock_Price:  103.03935003231231
curr_Factors:  [103.03935003]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991889]
Stock Position:  -0.14991888562263755
Bond Position:  [19.86956484]


portfolio before change:  [4.45791811]
curr_Stock_Price:  102.80818560355506
curr_Factors:  [102.8081856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00739235]
Stock Position:  -0.007392347427977742
Bond Position:  [5.21791194]


portfolio before change:  [4.45784121]
curr_Stock_Price:  102.86270625140236
curr_Factors:  [102.86270625]
mat_Sqrt:  [[0.15]]
grads:  [-0.05982158]
Stock Position:  -0.05982158490155563
Bond Position:  [10.61125132]


portfolio before change:  [4.46489451]
curr_Stock_Price:  102.75588725835354
curr_Factors:  [102.75588726]
mat_Sqrt:  [[0.15]]
grads:  [-0.02396403]
Stock Position:  -0.023964033600783974
Bond Position:  [6.92734005]


portfolio before change:  [4.46411883]
curr_Stock_Price:  102.80632322292495
curr_Factors:  [102.80632322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.46411883]
Stock Price:  102.46387590444748
PL:  [2.00024293]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.20931980e-04]
 [ 6.56862306e-04]
 [-1.30830595e-03]
 [ 8.51137199e-03]
 [ 4.19718406e-03]
 [ 2.10551276e-02]
 [ 8.67256893e-04]
 [-1.82459847e-02]
 [ 1.47858876e-02]
 [ 2.02591419e-02]
 [-1.98771091e-02]
 [ 2.75677049e-02]
 [-1.38965832e-02]
 [ 4.42022240e-03]
 [-7.03644850e-03]
 [ 9.67782020e-03]
 [ 8.71427974e-03]
 [-8.80059028e-03]
 [ 5.29696731e-04]
 [ 1.30576249e-02]
 [ 1.17043187e-02]
 [-7.85680668e-03]
 [ 6.82847911e-03]
 [ 4.87735512e-02]
 [ 9.15044205e-04]
 [ 1.37558493e-02]
 [-5.97606610e-03]
 [ 8.34774522e-03]
 [ 1.42743361e-02]
 [-2.95978908e-03]
 [ 1.02710296e-02]
 [-1.20746784e-02]
 [ 8.98540665e-03]
 [ 7.94637399e-03]
 [ 1.14699357e-02]
 [ 9.94746798e-03]
 [-3.40377692e-02]
 [ 9.59891458e-03]
 [ 4.45298444e-03]
 [ 1.54727229e-02]
 [-5.80755928e-03]
 [-1.38158798e-02]
 [ 2.23781523e-02]
 [ 1.91663199e-03]
 [-6.87447749e-03]
 [-1.18490096e-02]
 [ 1.38280869e-02]
 [-5.51017702e-03]
 [-8.07210122e-03]
 [-7.48418371e-03]
 [-6.01680687e-03]
 [ 1.92955371e-03]
 [-7.19069829e-03]
 [ 5.73915172e-03]
 [-7.44431628e-03]
 [ 4.54901218e-03]
 [ 9.32423271e-03]
 [-5.64102601e-05]
 [ 1.69576608e-03]
 [ 1.59285895e-02]
 [-2.50839327e-03]
 [-6.01972176e-04]
 [-2.54304100e-04]
 [-1.24075964e-02]
 [-1.83954462e-03]
 [ 1.20886162e-04]
 [-5.43797385e-03]
 [ 1.50624027e-02]
 [-8.33305750e-03]
 [ 1.06940463e-02]
 [-1.18752322e-02]
 [ 1.23487553e-02]
 [ 3.24314315e-04]
 [ 2.08789652e-02]
 [-2.24823907e-02]
 [-1.06830845e-03]
 [-7.66332473e-03]
 [-5.03411328e-03]
 [ 3.04508459e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.70374551]
curr_Stock_Price:  100.23813237288994
curr_Factors:  [100.23813237]
mat_Sqrt:  [[0.15]]
grads:  [0.00347288]
Stock Position:  0.003472879866654897
Bond Position:  [5.35563052]


portfolio before change:  [5.7023614]
curr_Stock_Price:  99.74319813764033
curr_Factors:  [99.74319814]
mat_Sqrt:  [[0.15]]
grads:  [0.00437908]
Stock Position:  0.004379082042570403
Bond Position:  [5.26557775]


portfolio before change:  [5.7007772]
curr_Stock_Price:  99.30627781853163
curr_Factors:  [99.30627782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00872204]
Stock Position:  -0.008722039636461117
Bond Position:  [6.56693049]


portfolio before change:  [5.69919597]
curr_Stock_Price:  99.53462699781201
curr_Factors:  [99.534627]
mat_Sqrt:  [[0.15]]
grads:  [0.05674248]
Stock Position:  0.0567424799461551
Bond Position:  [0.0513544]


portfolio before change:  [5.69731821]
curr_Stock_Price:  99.50147764325226
curr_Factors:  [99.50147764]
mat_Sqrt:  [[0.15]]
grads:  [0.02798123]
Stock Position:  0.02798122703562675
Bond Position:  [2.91314477]


portfolio before change:  [5.69739049]
curr_Stock_Price:  99.49755385340907
curr_Factors:  [99.49755385]
mat_Sqrt:  [[0.15]]
grads:  [0.14036752]
Stock Position:  0.14036751736738481
Bond Position:  [-8.26883413]


portfolio before change:  [5.68578508]
curr_Stock_Price:  99.41855702268163
curr_Factors:  [99.41855702]
mat_Sqrt:  [[0.15]]
grads:  [0.00578171]
Stock Position:  0.005781712618714716
Bond Position:  [5.11097556]


portfolio before change:  [5.68728956]
curr_Stock_Price:  99.62351935482104
curr_Factors:  [99.62351935]
mat_Sqrt:  [[0.15]]
grads:  [-0.1216399]
Stock Position:  -0.12163989773227474
Bond Position:  [17.80548427]


portfolio before change:  [5.67506809]
curr_Stock_Price:  99.73314090837685
curr_Factors:  [99.73314091]
mat_Sqrt:  [[0.15]]
grads:  [0.09857258]
Stock Position:  0.09857258421060183
Bond Position:  [-4.15588534]


portfolio before change:  [5.59525245]
curr_Stock_Price:  98.92606166236042
curr_Factors:  [98.92606166]
mat_Sqrt:  [[0.15]]
grads:  [0.13506095]
Stock Position:  0.1350609460497725
Bond Position:  [-7.76579503]


portfolio before change:  [5.4925707]
curr_Stock_Price:  98.16939312350632
curr_Factors:  [98.16939312]
mat_Sqrt:  [[0.15]]
grads:  [-0.13251406]
Stock Position:  -0.13251406049239098
Bond Position:  [18.5013956]


portfolio before change:  [5.53617456]
curr_Stock_Price:  97.84906872777302
curr_Factors:  [97.84906873]
mat_Sqrt:  [[0.15]]
grads:  [0.1837847]
Stock Position:  0.18378469907632267
Bond Position:  [-12.44698709]


portfolio before change:  [5.55546885]
curr_Stock_Price:  97.9582848531178
curr_Factors:  [97.95828485]
mat_Sqrt:  [[0.15]]
grads:  [-0.09264389]
Stock Position:  -0.09264388804022716
Bond Position:  [14.63070523]


portfolio before change:  [5.55579886]
curr_Stock_Price:  97.96459332233623
curr_Factors:  [97.96459332]
mat_Sqrt:  [[0.15]]
grads:  [0.02946815]
Stock Position:  0.029468149339795947
Bond Position:  [2.66896359]


portfolio before change:  [5.53695032]
curr_Stock_Price:  97.3193084026689
curr_Factors:  [97.3193084]
mat_Sqrt:  [[0.15]]
grads:  [-0.04690966]
Stock Position:  -0.046909656646418725
Bond Position:  [10.10216567]


portfolio before change:  [5.51398758]
curr_Stock_Price:  97.82227831456146
curr_Factors:  [97.82227831]
mat_Sqrt:  [[0.15]]
grads:  [0.0645188]
Stock Position:  0.06451880135941784
Bond Position:  [-0.79738856]


portfolio before change:  [5.53869248]
curr_Stock_Price:  98.20596080737987
curr_Factors:  [98.20596081]
mat_Sqrt:  [[0.15]]
grads:  [0.0580952]
Stock Position:  0.058095198284300625
Bond Position:  [-0.16660229]


portfolio before change:  [5.55962035]
curr_Stock_Price:  98.56637415556747
curr_Factors:  [98.56637416]
mat_Sqrt:  [[0.15]]
grads:  [-0.0586706]
Stock Position:  -0.05867060189727744
Bond Position:  [11.34256885]


portfolio before change:  [5.54591228]
curr_Stock_Price:  98.81210212319839
curr_Factors:  [98.81210212]
mat_Sqrt:  [[0.15]]
grads:  [0.00353131]
Stock Position:  0.0035313115387454637
Bond Position:  [5.19697596]


portfolio before change:  [5.54663127]
curr_Stock_Price:  98.92372413788812
curr_Factors:  [98.92372414]
mat_Sqrt:  [[0.15]]
grads:  [0.08705083]
Stock Position:  0.08705083242844308
Bond Position:  [-3.06476126]


portfolio before change:  [5.55374595]
curr_Stock_Price:  99.0076548302644
curr_Factors:  [99.00765483]
mat_Sqrt:  [[0.15]]
grads:  [0.07802879]
Stock Position:  0.07802879135308137
Bond Position:  [-2.17170169]


portfolio before change:  [5.58582907]
curr_Stock_Price:  99.42056465770789
curr_Factors:  [99.42056466]
mat_Sqrt:  [[0.15]]
grads:  [-0.05237871]
Stock Position:  -0.052378711207740965
Bond Position:  [10.79335012]


portfolio before change:  [5.54473596]
curr_Stock_Price:  100.21798253109124
curr_Factors:  [100.21798253]
mat_Sqrt:  [[0.15]]
grads:  [0.04552319]
Stock Position:  0.04552319409893561
Bond Position:  [0.98249329]


portfolio before change:  [5.54696696]
curr_Stock_Price:  100.26564174506723
curr_Factors:  [100.26564175]
mat_Sqrt:  [[0.15]]
grads:  [0.32515701]
Stock Position:  0.3251570079866154
Bond Position:  [-27.05510911]


portfolio before change:  [5.77963185]
curr_Stock_Price:  100.98638858320476
curr_Factors:  [100.98638858]
mat_Sqrt:  [[0.15]]
grads:  [0.00610029]
Stock Position:  0.006100294702187289
Bond Position:  [5.16358512]


portfolio before change:  [5.77911886]
curr_Stock_Price:  100.84939167145399
curr_Factors:  [100.84939167]
mat_Sqrt:  [[0.15]]
grads:  [0.09170566]
Stock Position:  0.09170566191248708
Bond Position:  [-3.46934135]


portfolio before change:  [5.79268473]
curr_Stock_Price:  100.99968454359632
curr_Factors:  [100.99968454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984044]
Stock Position:  -0.03984044063968848
Bond Position:  [9.81655667]


portfolio before change:  [5.77537566]
curr_Stock_Price:  101.44954456179364
curr_Factors:  [101.44954456]
mat_Sqrt:  [[0.15]]
grads:  [0.05565163]
Stock Position:  0.055651634826586
Bond Position:  [0.12954266]


portfolio before change:  [5.7618199]
curr_Stock_Price:  101.20581655619445
curr_Factors:  [101.20581656]
mat_Sqrt:  [[0.15]]
grads:  [0.09516224]
Stock Position:  0.09516224038422136
Bond Position:  [-3.86915234]


portfolio before change:  [5.7289943]
curr_Stock_Price:  100.8634142408477
curr_Factors:  [100.86341424]
mat_Sqrt:  [[0.15]]
grads:  [-0.01973193]
Stock Position:  -0.019731927203596213
Bond Position:  [7.71922385]


portfolio before change:  [5.71856709]
curr_Stock_Price:  101.41630856403056
curr_Factors:  [101.41630856]
mat_Sqrt:  [[0.15]]
grads:  [0.06847353]
Stock Position:  0.0684735304854449
Bond Position:  [-1.2257656]


portfolio before change:  [5.66890029]
curr_Stock_Price:  100.69208430510822
curr_Factors:  [100.69208431]
mat_Sqrt:  [[0.15]]
grads:  [-0.08049786]
Stock Position:  -0.08049785602333835
Bond Position:  [13.77439719]


portfolio before change:  [5.61259736]
curr_Stock_Price:  101.40221318060323
curr_Factors:  [101.40221318]
mat_Sqrt:  [[0.15]]
grads:  [0.05990271]
Stock Position:  0.05990271102353696
Bond Position:  [-0.46167011]


portfolio before change:  [5.60958584]
curr_Stock_Price:  101.35242122442739
curr_Factors:  [101.35242122]
mat_Sqrt:  [[0.15]]
grads:  [0.05297583]
Stock Position:  0.052975826620649064
Bond Position:  [0.24035754]


portfolio before change:  [5.58244071]
curr_Stock_Price:  100.8397318072286
curr_Factors:  [100.83973181]
mat_Sqrt:  [[0.15]]
grads:  [0.07646624]
Stock Position:  0.07646623797518622
Bond Position:  [-2.12839422]


portfolio before change:  [5.56492845]
curr_Stock_Price:  100.61245191861471
curr_Factors:  [100.61245192]
mat_Sqrt:  [[0.15]]
grads:  [0.06631645]
Stock Position:  0.06631645321642002
Bond Position:  [-1.10733251]


portfolio before change:  [5.59630807]
curr_Stock_Price:  101.08667561861225
curr_Factors:  [101.08667562]
mat_Sqrt:  [[0.15]]
grads:  [-0.22691846]
Stock Position:  -0.2269184614321906
Bond Position:  [28.53474097]


portfolio before change:  [5.48569563]
curr_Stock_Price:  101.58198975269934
curr_Factors:  [101.58198975]
mat_Sqrt:  [[0.15]]
grads:  [0.06399276]
Stock Position:  0.06399276385083649
Bond Position:  [-1.01481666]


portfolio before change:  [5.49504974]
curr_Stock_Price:  101.72915545337871
curr_Factors:  [101.72915545]
mat_Sqrt:  [[0.15]]
grads:  [0.02968656]
Stock Position:  0.02968656296325011
Bond Position:  [2.47506076]


portfolio before change:  [5.47656512]
curr_Stock_Price:  101.1012849532937
curr_Factors:  [101.10128495]
mat_Sqrt:  [[0.15]]
grads:  [0.10315149]
Stock Position:  0.10315148566839076
Bond Position:  [-4.95218263]


portfolio before change:  [5.45602425]
curr_Stock_Price:  100.90515257906014
curr_Factors:  [100.90515258]
mat_Sqrt:  [[0.15]]
grads:  [-0.03871706]
Stock Position:  -0.03871706185497568
Bond Position:  [9.36277528]


portfolio before change:  [5.47300308]
curr_Stock_Price:  100.4817308793738
curr_Factors:  [100.48173088]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210587]
Stock Position:  -0.09210586531227669
Bond Position:  [14.72795986]


portfolio before change:  [5.39732738]
curr_Stock_Price:  101.31334165358682
curr_Factors:  [101.31334165]
mat_Sqrt:  [[0.15]]
grads:  [0.14918768]
Stock Position:  0.1491876817063644
Bond Position:  [-9.71737519]


portfolio before change:  [5.40381517]
curr_Stock_Price:  101.36090019056225
curr_Factors:  [101.36090019]
mat_Sqrt:  [[0.15]]
grads:  [0.01277755]
Stock Position:  0.012777546605570324
Bond Position:  [4.10867155]


portfolio before change:  [5.40188449]
curr_Stock_Price:  101.18970283273242
curr_Factors:  [101.18970283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04582985]
Stock Position:  -0.04582984995222916
Bond Position:  [10.03939339]


portfolio before change:  [5.34837152]
curr_Stock_Price:  102.37103894701347
curr_Factors:  [102.37103895]
mat_Sqrt:  [[0.15]]
grads:  [-0.0789934]
Stock Position:  -0.07899339753266033
Bond Position:  [13.43500769]


portfolio before change:  [5.33498473]
curr_Stock_Price:  102.55113629290797
curr_Factors:  [102.55113629]
mat_Sqrt:  [[0.15]]
grads:  [0.09218725]
Stock Position:  0.09218724614354067
Bond Position:  [-4.11892211]


portfolio before change:  [5.21643542]
curr_Stock_Price:  101.26796671294093
curr_Factors:  [101.26796671]
mat_Sqrt:  [[0.15]]
grads:  [-0.03673451]
Stock Position:  -0.03673451345298021
Bond Position:  [8.9364649]


portfolio before change:  [5.21154087]
curr_Stock_Price:  101.41641288723385
curr_Factors:  [101.41641289]
mat_Sqrt:  [[0.15]]
grads:  [-0.05381401]
Stock Position:  -0.05381400812447685
Bond Position:  [10.66916453]


portfolio before change:  [5.18200354]
curr_Stock_Price:  101.97768251590385
curr_Factors:  [101.97768252]
mat_Sqrt:  [[0.15]]
grads:  [-0.04989456]
Stock Position:  -0.0498945580855389
Bond Position:  [10.27013495]


portfolio before change:  [5.2050315]
curr_Stock_Price:  101.52901524154346
curr_Factors:  [101.52901524]
mat_Sqrt:  [[0.15]]
grads:  [-0.04011205]
Stock Position:  -0.04011204577778378
Bond Position:  [9.27756801]


portfolio before change:  [5.17757804]
curr_Stock_Price:  102.2278906787814
curr_Factors:  [102.22789068]
mat_Sqrt:  [[0.15]]
grads:  [0.01286369]
Stock Position:  0.012863691395987923
Bond Position:  [3.86255001]


portfolio before change:  [5.1783117]
curr_Stock_Price:  102.26615670744803
curr_Factors:  [102.26615671]
mat_Sqrt:  [[0.15]]
grads:  [-0.04793799]
Stock Position:  -0.0479379885857304
Bond Position:  [10.08074556]


portfolio before change:  [5.12474147]
curr_Stock_Price:  103.39679035572982
curr_Factors:  [103.39679036]
mat_Sqrt:  [[0.15]]
grads:  [0.03826101]
Stock Position:  0.038261011494837474
Bond Position:  [1.16867568]


portfolio before change:  [5.12181414]
curr_Stock_Price:  103.31837194200642
curr_Factors:  [103.31837194]
mat_Sqrt:  [[0.15]]
grads:  [-0.04962878]
Stock Position:  -0.04962877518216498
Bond Position:  [10.2493784]


portfolio before change:  [5.15327961]
curr_Stock_Price:  102.69726323909617
curr_Factors:  [102.69726324]
mat_Sqrt:  [[0.15]]
grads:  [0.03032675]
Stock Position:  0.030326747870728504
Bond Position:  [2.0388056]


portfolio before change:  [5.14621932]
curr_Stock_Price:  102.46025374030391
curr_Factors:  [102.46025374]
mat_Sqrt:  [[0.15]]
grads:  [0.06216155]
Stock Position:  0.06216155138319977
Bond Position:  [-1.22286901]


portfolio before change:  [5.19047505]
curr_Stock_Price:  103.17343029616097
curr_Factors:  [103.1734303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00037607]
Stock Position:  -0.00037606840091952237
Bond Position:  [5.22927531]


portfolio before change:  [5.19089493]
curr_Stock_Price:  102.9260077260411
curr_Factors:  [102.92600773]
mat_Sqrt:  [[0.15]]
grads:  [0.01130511]
Stock Position:  0.011305107219693696
Bond Position:  [4.02730538]


portfolio before change:  [5.18606066]
curr_Stock_Price:  102.47612407607747
curr_Factors:  [102.47612408]
mat_Sqrt:  [[0.15]]
grads:  [0.1061906]
Stock Position:  0.1061905966066754
Bond Position:  [-5.69594009]


portfolio before change:  [5.20149723]
curr_Stock_Price:  102.62484319757995
curr_Factors:  [102.6248432]
mat_Sqrt:  [[0.15]]
grads:  [-0.01672262]
Stock Position:  -0.016722621803610498
Bond Position:  [6.91765367]


portfolio before change:  [5.21682417]
curr_Stock_Price:  101.73415900934143
curr_Factors:  [101.73415901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00401315]
Stock Position:  -0.004013147841765731
Bond Position:  [5.62509839]


portfolio before change:  [5.21383581]
curr_Stock_Price:  102.56640955483643
curr_Factors:  [102.56640955]
mat_Sqrt:  [[0.15]]
grads:  [-0.00169536]
Stock Position:  -0.0016953606646967954
Bond Position:  [5.38772286]


portfolio before change:  [5.21374198]
curr_Stock_Price:  102.82037653533658
curr_Factors:  [102.82037654]
mat_Sqrt:  [[0.15]]
grads:  [-0.08271731]
Stock Position:  -0.08271730960988377
Bond Position:  [13.7187669]


portfolio before change:  [5.29105586]
curr_Stock_Price:  101.89606667523438
curr_Factors:  [101.89606668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01226363]
Stock Position:  -0.012263630784794232
Bond Position:  [6.5406716]


portfolio before change:  [5.29213584]
curr_Stock_Price:  101.841337337773
curr_Factors:  [101.84133734]
mat_Sqrt:  [[0.15]]
grads:  [0.00080591]
Stock Position:  0.0008059077448323062
Bond Position:  [5.21006112]


portfolio before change:  [5.29291277]
curr_Stock_Price:  102.40130803162783
curr_Factors:  [102.40130803]
mat_Sqrt:  [[0.15]]
grads:  [-0.03625316]
Stock Position:  -0.03625315898454944
Bond Position:  [9.00528367]


portfolio before change:  [5.3008997]
curr_Stock_Price:  102.19652343242515
curr_Factors:  [102.19652343]
mat_Sqrt:  [[0.15]]
grads:  [0.10041602]
Stock Position:  0.1004160176937754
Bond Position:  [-4.9612682]


portfolio before change:  [5.28500975]
curr_Stock_Price:  102.04137025443725
curr_Factors:  [102.04137025]
mat_Sqrt:  [[0.15]]
grads:  [-0.05555372]
Stock Position:  -0.0555537166778203
Bond Position:  [10.95378712]


portfolio before change:  [5.2950282]
curr_Stock_Price:  101.8733560219108
curr_Factors:  [101.87335602]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-1.96789439]


portfolio before change:  [5.34470242]
curr_Stock_Price:  102.57183650252031
curr_Factors:  [102.5718365]
mat_Sqrt:  [[0.15]]
grads:  [-0.07916821]
Stock Position:  -0.07916821447968235
Bond Position:  [13.46513157]


portfolio before change:  [5.3449127]
curr_Stock_Price:  102.57981087924954
curr_Factors:  [102.57981088]
mat_Sqrt:  [[0.15]]
grads:  [0.08232504]
Stock Position:  0.08232503537769238
Bond Position:  [-3.09997386]


portfolio before change:  [5.32307418]
curr_Stock_Price:  102.31689250640748
curr_Factors:  [102.31689251]
mat_Sqrt:  [[0.15]]
grads:  [0.0021621]
Stock Position:  0.0021620954317278568
Bond Position:  [5.10185529]


portfolio before change:  [5.32377345]
curr_Stock_Price:  102.49283059605416
curr_Factors:  [102.4928306]
mat_Sqrt:  [[0.15]]
grads:  [0.1391931]
Stock Position:  0.13919310142388236
Bond Position:  [-8.94252151]


portfolio before change:  [5.30334623]
curr_Stock_Price:  102.35009154458251
curr_Factors:  [102.35009154]
mat_Sqrt:  [[0.15]]
grads:  [-0.1498826]
Stock Position:  -0.14988260467683034
Bond Position:  [20.64384454]


portfolio before change:  [5.2282921]
curr_Stock_Price:  102.85945296398657
curr_Factors:  [102.85945296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712206]
Stock Position:  -0.0071220563275919335
Bond Position:  [5.96086292]


portfolio before change:  [5.22554499]
curr_Stock_Price:  103.2974836446732
curr_Factors:  [103.29748364]
mat_Sqrt:  [[0.15]]
grads:  [-0.05108883]
Stock Position:  -0.051088831523990935
Bond Position:  [10.50289272]


portfolio before change:  [5.23426475]
curr_Stock_Price:  103.13965436878324
curr_Factors:  [103.13965437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03356076]
Stock Position:  -0.033560755221373834
Bond Position:  [8.69570944]


portfolio before change:  [5.24905581]
curr_Stock_Price:  102.71512408775077
curr_Factors:  [102.71512409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.24905581]
Stock Price:  102.70918459425657
PL:  [2.53987121]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.47742856e-04]
 [-1.23679082e-03]
 [-4.34534450e-03]
 [ 3.65073892e-03]
 [ 1.01535272e-02]
 [ 2.85579401e-02]
 [ 2.41382196e-03]
 [ 1.06485150e-02]
 [ 2.46225137e-02]
 [-4.60085312e-03]
 [ 1.98002509e-02]
 [-1.58370839e-02]
 [ 4.17253903e-03]
 [ 3.10995534e-03]
 [-6.89918891e-03]
 [ 2.38880487e-02]
 [ 1.13028992e-02]
 [-8.56850994e-03]
 [ 4.86508524e-03]
 [-5.57326458e-03]
 [ 1.38176718e-02]
 [-3.62991728e-03]
 [ 7.92761141e-03]
 [ 3.01388603e-02]
 [ 2.55599147e-04]
 [ 1.47092003e-02]
 [-6.40189330e-03]
 [ 6.45958807e-03]
 [ 2.88465248e-03]
 [-2.85218844e-03]
 [ 7.42832084e-03]
 [-1.21145738e-02]
 [ 9.54958469e-03]
 [ 8.41606410e-03]
 [ 1.14953421e-02]
 [ 1.32404839e-02]
 [-3.49231735e-02]
 [ 9.65416596e-03]
 [-1.11470877e-02]
 [ 2.40029044e-02]
 [-6.02973943e-03]
 [-1.18365299e-02]
 [ 2.36156180e-02]
 [ 4.16509286e-03]
 [-8.21425458e-03]
 [-6.20232487e-03]
 [ 8.16232796e-04]
 [-1.24483892e-02]
 [-9.63945713e-03]
 [-3.45185666e-03]
 [ 4.43258462e-02]
 [-1.05397161e-02]
 [ 3.48217169e-03]
 [ 5.32700022e-03]
 [ 5.13780385e-03]
 [-2.79838236e-03]
 [ 6.93160577e-03]
 [-1.26545554e-04]
 [ 1.55650430e-03]
 [ 1.15955235e-02]
 [-1.25590643e-05]
 [ 1.65921774e-03]
 [ 4.89899418e-06]
 [-1.25282131e-02]
 [ 5.91072520e-03]
 [ 2.76631049e-03]
 [-5.31848654e-03]
 [ 1.53142262e-02]
 [-8.92261604e-03]
 [-1.95478489e-02]
 [-1.01441807e-02]
 [ 1.47333429e-02]
 [-1.48268845e-02]
 [ 2.80085603e-02]
 [-2.95831582e-02]
 [ 6.39931453e-03]
 [ 1.22014643e-02]
 [-2.07034071e-02]
 [ 1.93589767e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.45149229]
curr_Stock_Price:  100.48182945303866
curr_Factors:  [100.48182945]
mat_Sqrt:  [[0.15]]
grads:  [-0.00231829]
Stock Position:  -0.002318285706091958
Bond Position:  [9.68443788]


portfolio before change:  [9.45054012]
curr_Stock_Price:  101.15364760510917
curr_Factors:  [101.15364761]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824527]
Stock Position:  -0.008245272115957589
Bond Position:  [10.28457947]


portfolio before change:  [9.44843444]
curr_Stock_Price:  101.48698851088727
curr_Factors:  [101.48698851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02896896]
Stock Position:  -0.028968963364870422
Bond Position:  [12.38840729]


portfolio before change:  [9.45863531]
curr_Stock_Price:  101.16158601246772
curr_Factors:  [101.16158601]
mat_Sqrt:  [[0.15]]
grads:  [0.02433826]
Stock Position:  0.024338259499858742
Bond Position:  [6.99653838]


portfolio before change:  [9.45336807]
curr_Stock_Price:  100.92720057995221
curr_Factors:  [100.92720058]
mat_Sqrt:  [[0.15]]
grads:  [0.06769018]
Stock Position:  0.06769018111915551
Bond Position:  [2.62158759]


portfolio before change:  [9.44352042]
curr_Stock_Price:  100.77929872410321
curr_Factors:  [100.77929872]
mat_Sqrt:  [[0.15]]
grads:  [0.19038627]
Stock Position:  0.19038626741464884
Bond Position:  [-9.74347409]


portfolio before change:  [9.59380845]
curr_Stock_Price:  101.57188222539388
curr_Factors:  [101.57188223]
mat_Sqrt:  [[0.15]]
grads:  [0.01609215]
Stock Position:  0.016092146392526967
Bond Position:  [7.95929885]


portfolio before change:  [9.60019089]
curr_Stock_Price:  101.93758653978345
curr_Factors:  [101.93758654]
mat_Sqrt:  [[0.15]]
grads:  [0.0709901]
Stock Position:  0.07099010004387278
Bond Position:  [2.36363142]


portfolio before change:  [9.60906165]
curr_Stock_Price:  102.06046314947152
curr_Factors:  [102.06046315]
mat_Sqrt:  [[0.15]]
grads:  [0.16415009]
Stock Position:  0.16415009122827276
Bond Position:  [-7.14417269]


portfolio before change:  [9.56918553]
curr_Stock_Price:  101.82025862506119
curr_Factors:  [101.82025863]
mat_Sqrt:  [[0.15]]
grads:  [-0.03067235]
Stock Position:  -0.0306723541497918
Bond Position:  [12.69225256]


portfolio before change:  [9.59099085]
curr_Stock_Price:  101.13521082019845
curr_Factors:  [101.13521082]
mat_Sqrt:  [[0.15]]
grads:  [0.13200167]
Stock Position:  0.13200167240241734
Bond Position:  [-3.75902612]


portfolio before change:  [9.49082985]
curr_Stock_Price:  100.37820490682226
curr_Factors:  [100.37820491]
mat_Sqrt:  [[0.15]]
grads:  [-0.10558056]
Stock Position:  -0.10558055949427775
Bond Position:  [20.08881689]


portfolio before change:  [9.48981524]
curr_Stock_Price:  100.39970704476242
curr_Factors:  [100.39970704]
mat_Sqrt:  [[0.15]]
grads:  [0.02781693]
Stock Position:  0.027816926838694335
Bond Position:  [6.69700393]


portfolio before change:  [9.51165613]
curr_Stock_Price:  101.16982506163949
curr_Factors:  [101.16982506]
mat_Sqrt:  [[0.15]]
grads:  [0.02073304]
Stock Position:  0.020733035566861607
Bond Position:  [7.41409855]


portfolio before change:  [9.52279695]
curr_Stock_Price:  101.68482100908173
curr_Factors:  [101.68482101]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599459]
Stock Position:  -0.04599459271889307
Bond Position:  [14.19974888]


portfolio before change:  [9.52028233]
curr_Stock_Price:  101.75878917574603
curr_Factors:  [101.75878918]
mat_Sqrt:  [[0.15]]
grads:  [0.15925366]
Stock Position:  0.15925365814173884
Bond Position:  [-6.6851771]


portfolio before change:  [9.64714231]
curr_Stock_Price:  102.55800359289566
curr_Factors:  [102.55800359]
mat_Sqrt:  [[0.15]]
grads:  [0.07535266]
Stock Position:  0.07535266122233347
Bond Position:  [1.91912381]


portfolio before change:  [9.64980093]
curr_Stock_Price:  102.59169406300389
curr_Factors:  [102.59169406]
mat_Sqrt:  [[0.15]]
grads:  [-0.0571234]
Stock Position:  -0.05712339957990019
Bond Position:  [15.51018726]


portfolio before change:  [9.65977791]
curr_Stock_Price:  102.43400801857015
curr_Factors:  [102.43400802]
mat_Sqrt:  [[0.15]]
grads:  [0.0324339]
Stock Position:  0.03243390160095859
Bond Position:  [6.33744337]


portfolio before change:  [9.63522895]
curr_Stock_Price:  101.66490348806396
curr_Factors:  [101.66490349]
mat_Sqrt:  [[0.15]]
grads:  [-0.0371551]
Stock Position:  -0.03715509720843812
Bond Position:  [13.41259832]


portfolio before change:  [9.62995246]
curr_Stock_Price:  101.82947846435215
curr_Factors:  [101.82947846]
mat_Sqrt:  [[0.15]]
grads:  [0.09211781]
Stock Position:  0.09211781198761247
Bond Position:  [0.24964371]


portfolio before change:  [9.61678081]
curr_Stock_Price:  101.68632198788954
curr_Factors:  [101.68632199]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419945]
Stock Position:  -0.02419944855658419
Bond Position:  [12.07753372]


portfolio before change:  [9.62868528]
curr_Stock_Price:  101.22558407128699
curr_Factors:  [101.22558407]
mat_Sqrt:  [[0.15]]
grads:  [0.05285074]
Stock Position:  0.052850742708861004
Bond Position:  [4.27883798]


portfolio before change:  [9.60526736]
curr_Stock_Price:  100.77742841925205
curr_Factors:  [100.77742842]
mat_Sqrt:  [[0.15]]
grads:  [0.20092574]
Stock Position:  0.20092573548963735
Bond Position:  [-10.64351157]


portfolio before change:  [9.58246048]
curr_Stock_Price:  100.66723032620462
curr_Factors:  [100.66723033]
mat_Sqrt:  [[0.15]]
grads:  [0.00170399]
Stock Position:  0.0017039943143912911
Bond Position:  [9.41092409]


portfolio before change:  [9.58261212]
curr_Stock_Price:  100.41103129638577
curr_Factors:  [100.4110313]
mat_Sqrt:  [[0.15]]
grads:  [0.09806134]
Stock Position:  0.09806133526254582
Bond Position:  [-0.26382768]


portfolio before change:  [9.6100265]
curr_Stock_Price:  100.69076301737212
curr_Factors:  [100.69076302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04267929]
Stock Position:  -0.042679288666200535
Bond Position:  [13.90743664]


portfolio before change:  [9.61400224]
curr_Stock_Price:  100.61797584669769
curr_Factors:  [100.61797585]
mat_Sqrt:  [[0.15]]
grads:  [0.04306392]
Stock Position:  0.043063920453972275
Bond Position:  [5.28099774]


portfolio before change:  [9.6016426]
curr_Stock_Price:  100.32330410064624
curr_Factors:  [100.3233041]
mat_Sqrt:  [[0.15]]
grads:  [0.01923102]
Stock Position:  0.019231016505391076
Bond Position:  [7.67232348]


portfolio before change:  [9.59834582]
curr_Stock_Price:  100.12693849735079
curr_Factors:  [100.1269385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901459]
Stock Position:  -0.019014589609883965
Bond Position:  [11.50221847]


portfolio before change:  [9.58608982]
curr_Stock_Price:  100.80930490257397
curr_Factors:  [100.8093049]
mat_Sqrt:  [[0.15]]
grads:  [0.04952214]
Stock Position:  0.04952213891411932
Bond Position:  [4.59379741]


portfolio before change:  [9.57631825]
curr_Stock_Price:  100.60619003245213
curr_Factors:  [100.60619003]
mat_Sqrt:  [[0.15]]
grads:  [-0.08076383]
Stock Position:  -0.08076382536961817
Bond Position:  [17.70165902]


portfolio before change:  [9.53206196]
curr_Stock_Price:  101.1678608537768
curr_Factors:  [101.16786085]
mat_Sqrt:  [[0.15]]
grads:  [0.0636639]
Stock Position:  0.06366389795796318
Bond Position:  [3.09132159]


portfolio before change:  [9.59274423]
curr_Stock_Price:  102.11799213614394
curr_Factors:  [102.11799214]
mat_Sqrt:  [[0.15]]
grads:  [0.05610709]
Stock Position:  0.05610709400529663
Bond Position:  [3.86320045]


portfolio before change:  [9.52838819]
curr_Stock_Price:  100.96666712172937
curr_Factors:  [100.96666712]
mat_Sqrt:  [[0.15]]
grads:  [0.07663561]
Stock Position:  0.07663561422695561
Bond Position:  [1.79074564]


portfolio before change:  [9.42947014]
curr_Stock_Price:  99.67444837466323
curr_Factors:  [99.67444837]
mat_Sqrt:  [[0.15]]
grads:  [0.08826989]
Stock Position:  0.08826989275327614
Bond Position:  [0.63121727]


portfolio before change:  [9.43919341]
curr_Stock_Price:  99.78415533750609
curr_Factors:  [99.78415534]
mat_Sqrt:  [[0.15]]
grads:  [-0.23282116]
Stock Position:  -0.23282115668471637
Bond Position:  [32.67105588]


portfolio before change:  [9.39987698]
curr_Stock_Price:  99.96179569613787
curr_Factors:  [99.9617957]
mat_Sqrt:  [[0.15]]
grads:  [0.06436111]
Stock Position:  0.06436110642708903
Bond Position:  [2.96622521]


portfolio before change:  [9.392091]
curr_Stock_Price:  99.8379417008358
curr_Factors:  [99.8379417]
mat_Sqrt:  [[0.15]]
grads:  [-0.07431392]
Stock Position:  -0.07431391830152075
Bond Position:  [16.81143964]


portfolio before change:  [9.37224425]
curr_Stock_Price:  100.11914741783177
curr_Factors:  [100.11914742]
mat_Sqrt:  [[0.15]]
grads:  [0.16001936]
Stock Position:  0.1600193626467899
Bond Position:  [-6.64875791]


portfolio before change:  [9.44074719]
curr_Stock_Price:  100.54983593598212
curr_Factors:  [100.54983594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019826]
Stock Position:  -0.04019826285018046
Bond Position:  [13.48267592]


portfolio before change:  [9.46010208]
curr_Stock_Price:  100.0893136019524
curr_Factors:  [100.0893136]
mat_Sqrt:  [[0.15]]
grads:  [-0.0789102]
Stock Position:  -0.07891019915050333
Bond Position:  [17.35816975]


portfolio before change:  [9.48055105]
curr_Stock_Price:  99.84392013912905
curr_Factors:  [99.84392014]
mat_Sqrt:  [[0.15]]
grads:  [0.15743745]
Stock Position:  0.15743745310576773
Bond Position:  [-6.23862145]


portfolio before change:  [9.40806135]
curr_Stock_Price:  99.38596197854243
curr_Factors:  [99.38596198]
mat_Sqrt:  [[0.15]]
grads:  [0.02776729]
Stock Position:  0.02776728573328945
Bond Position:  [6.64838295]


portfolio before change:  [9.40913086]
curr_Stock_Price:  99.40951374661904
curr_Factors:  [99.40951375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547617]
Stock Position:  -0.05476169718253744
Bond Position:  [14.85296455]


portfolio before change:  [9.45031291]
curr_Stock_Price:  98.67444321876447
curr_Factors:  [98.67444322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134883]
Stock Position:  -0.04134883244489702
Bond Position:  [13.53038593]


portfolio before change:  [9.46172345]
curr_Stock_Price:  98.41893751309293
curr_Factors:  [98.41893751]
mat_Sqrt:  [[0.15]]
grads:  [0.00544155]
Stock Position:  0.005441551976319604
Bond Position:  [8.92617168]


portfolio before change:  [9.46543818]
curr_Stock_Price:  98.99907111643722
curr_Factors:  [98.99907112]
mat_Sqrt:  [[0.15]]
grads:  [-0.08298926]
Stock Position:  -0.08298926135574028
Bond Position:  [17.68129796]


portfolio before change:  [9.48756164]
curr_Stock_Price:  98.7458052676596
curr_Factors:  [98.74580527]
mat_Sqrt:  [[0.15]]
grads:  [-0.06426305]
Stock Position:  -0.06426304750292827
Bond Position:  [15.83326801]


portfolio before change:  [9.51978429]
curr_Stock_Price:  98.2597865494326
curr_Factors:  [98.25978655]
mat_Sqrt:  [[0.15]]
grads:  [-0.02301238]
Stock Position:  -0.023012377711559628
Bond Position:  [11.78097561]


portfolio before change:  [9.5320363]
curr_Stock_Price:  97.75937448589447
curr_Factors:  [97.75937449]
mat_Sqrt:  [[0.15]]
grads:  [0.29550564]
Stock Position:  0.29550564166380755
Bond Position:  [-19.35641039]


portfolio before change:  [9.71385143]
curr_Stock_Price:  98.37873642190753
curr_Factors:  [98.37873642]
mat_Sqrt:  [[0.15]]
grads:  [-0.07026477]
Stock Position:  -0.07026477396012755
Bond Position:  [16.62641111]


portfolio before change:  [9.70422907]
curr_Stock_Price:  98.53047021083555
curr_Factors:  [98.53047021]
mat_Sqrt:  [[0.15]]
grads:  [0.02321448]
Stock Position:  0.02321447790473137
Bond Position:  [7.41689565]


portfolio before change:  [9.70837091]
curr_Stock_Price:  98.68891727457735
curr_Factors:  [98.68891727]
mat_Sqrt:  [[0.15]]
grads:  [0.03551333]
Stock Position:  0.035513334790149544
Bond Position:  [6.20359835]


portfolio before change:  [9.68321379]
curr_Stock_Price:  97.96961391359254
curr_Factors:  [97.96961391]
mat_Sqrt:  [[0.15]]
grads:  [0.03425203]
Stock Position:  0.03425202566076974
Bond Position:  [6.32755606]


portfolio before change:  [9.7003028]
curr_Stock_Price:  98.45698745469979
curr_Factors:  [98.45698745]
mat_Sqrt:  [[0.15]]
grads:  [-0.01865588]
Stock Position:  -0.018655882379588325
Bond Position:  [11.53710478]


portfolio before change:  [9.69032717]
curr_Stock_Price:  99.03035762572432
curr_Factors:  [99.03035763]
mat_Sqrt:  [[0.15]]
grads:  [0.04621071]
Stock Position:  0.04621070516531802
Bond Position:  [5.11406451]


portfolio before change:  [9.72959986]
curr_Stock_Price:  99.87330203564562
curr_Factors:  [99.87330204]
mat_Sqrt:  [[0.15]]
grads:  [-0.00084364]
Stock Position:  -0.0008436370243931511
Bond Position:  [9.81385668]


portfolio before change:  [9.72948429]
curr_Stock_Price:  100.73736675471791
curr_Factors:  [100.73736675]
mat_Sqrt:  [[0.15]]
grads:  [0.0103767]
Stock Position:  0.0103766953507329
Bond Position:  [8.68416332]


portfolio before change:  [9.73361213]
curr_Stock_Price:  101.08285853232842
curr_Factors:  [101.08285853]
mat_Sqrt:  [[0.15]]
grads:  [0.07730349]
Stock Position:  0.077303490303718
Bond Position:  [1.91955435]


portfolio before change:  [9.75155648]
curr_Stock_Price:  101.31343516064321
curr_Factors:  [101.31343516]
mat_Sqrt:  [[0.15]]
grads:  [-8.37270953e-05]
Stock Position:  -8.372709527493596e-05
Bond Position:  [9.76003916]


portfolio before change:  [9.75211906]
curr_Stock_Price:  101.88004221117056
curr_Factors:  [101.88004221]
mat_Sqrt:  [[0.15]]
grads:  [0.01106145]
Stock Position:  0.011061451598117222
Bond Position:  [8.62517791]


portfolio before change:  [9.76090876]
curr_Stock_Price:  102.62593047966132
curr_Factors:  [102.62593048]
mat_Sqrt:  [[0.15]]
grads:  [3.26599612e-05]
Stock Position:  3.265996121814066e-05
Bond Position:  [9.757557]


portfolio before change:  [9.76155622]
curr_Stock_Price:  103.7770851657933
curr_Factors:  [103.77708517]
mat_Sqrt:  [[0.15]]
grads:  [-0.08352142]
Stock Position:  -0.08352142042288112
Bond Position:  [18.42916579]


portfolio before change:  [9.78639944]
curr_Stock_Price:  103.49342908006395
curr_Factors:  [103.49342908]
mat_Sqrt:  [[0.15]]
grads:  [0.03940483]
Stock Position:  0.03940483464960963
Bond Position:  [5.70825798]


portfolio before change:  [9.78208617]
curr_Stock_Price:  103.37491438328234
curr_Factors:  [103.37491438]
mat_Sqrt:  [[0.15]]
grads:  [0.01844207]
Stock Position:  0.01844206996073727
Bond Position:  [7.87563876]


portfolio before change:  [9.80326682]
curr_Stock_Price:  104.49671975765425
curr_Factors:  [104.49671976]
mat_Sqrt:  [[0.15]]
grads:  [-0.03545658]
Stock Position:  -0.035456576946808996
Bond Position:  [13.50836281]


portfolio before change:  [9.81074537]
curr_Stock_Price:  104.30961064842724
curr_Factors:  [104.30961065]
mat_Sqrt:  [[0.15]]
grads:  [0.10209484]
Stock Position:  0.10209484124083017
Bond Position:  [-0.83872777]


portfolio before change:  [9.85338356]
curr_Stock_Price:  104.72775722513974
curr_Factors:  [104.72775723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05948411]
Stock Position:  -0.059484106922014224
Bond Position:  [16.08302067]


portfolio before change:  [9.79290936]
curr_Stock_Price:  105.76130080030886
curr_Factors:  [105.7613008]
mat_Sqrt:  [[0.15]]
grads:  [-0.13031899]
Stock Position:  -0.13031899273486663
Bond Position:  [23.57561555]


portfolio before change:  [9.75961819]
curr_Stock_Price:  106.0280669607552
curr_Factors:  [106.02806696]
mat_Sqrt:  [[0.15]]
grads:  [-0.06762787]
Stock Position:  -0.06762787121701083
Bond Position:  [16.93007064]


portfolio before change:  [9.76971057]
curr_Stock_Price:  105.89447970009492
curr_Factors:  [105.8944797]
mat_Sqrt:  [[0.15]]
grads:  [0.09822229]
Stock Position:  0.098222285856791
Bond Position:  [-0.63148728]


portfolio before change:  [9.75500524]
curr_Stock_Price:  105.74516675850458
curr_Factors:  [105.74516676]
mat_Sqrt:  [[0.15]]
grads:  [-0.0988459]
Stock Position:  -0.09884589643861273
Bond Position:  [20.20748105]


portfolio before change:  [9.67625902]
curr_Stock_Price:  106.55460075028552
curr_Factors:  [106.55460075]
mat_Sqrt:  [[0.15]]
grads:  [0.18672374]
Stock Position:  0.18672373505911002
Bond Position:  [-10.22001402]


portfolio before change:  [9.8636526]
curr_Stock_Price:  107.56160902601565
curr_Factors:  [107.56160903]
mat_Sqrt:  [[0.15]]
grads:  [-0.19722105]
Stock Position:  -0.19722105440281593
Bond Position:  [31.07706654]


portfolio before change:  [9.78766467]
curr_Stock_Price:  107.95675093682864
curr_Factors:  [107.95675094]
mat_Sqrt:  [[0.15]]
grads:  [0.0426621]
Stock Position:  0.04266209689181291
Bond Position:  [5.1820033]


portfolio before change:  [9.84319015]
curr_Stock_Price:  109.25067693457902
curr_Factors:  [109.25067693]
mat_Sqrt:  [[0.15]]
grads:  [0.0813431]
Stock Position:  0.08134309515184134
Bond Position:  [0.95640194]


portfolio before change:  [9.88269732]
curr_Stock_Price:  109.73562761829957
curr_Factors:  [109.73562762]
mat_Sqrt:  [[0.15]]
grads:  [-0.13802271]
Stock Position:  -0.13802271403230598
Bond Position:  [25.02870647]


portfolio before change:  [9.94890668]
curr_Stock_Price:  109.2672625294819
curr_Factors:  [109.26726253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.94890668]
Stock Price:  109.60768153092222
PL:  [0.34122515]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.16199267e-03]
 [ 1.60381088e-03]
 [ 4.36353508e-04]
 [ 7.22550374e-03]
 [ 3.03622646e-03]
 [ 2.32566229e-02]
 [ 1.52561684e-03]
 [-1.79601055e-02]
 [ 1.83134670e-02]
 [ 9.35064207e-03]
 [ 1.51907128e-02]
 [-1.59089317e-02]
 [ 1.00221623e-02]
 [ 2.55321386e-03]
 [-6.91323175e-03]
 [ 1.93196814e-02]
 [ 1.04266922e-02]
 [-1.15055499e-02]
 [-5.23654965e-04]
 [ 6.06702132e-03]
 [ 1.31926730e-02]
 [-6.85254098e-03]
 [ 1.05225777e-02]
 [-1.63317954e-02]
 [ 6.97041444e-03]
 [ 8.06970511e-03]
 [-5.36890604e-03]
 [ 9.74478358e-03]
 [ 3.76386299e-02]
 [-8.34286642e-05]
 [ 9.05953015e-03]
 [-1.19065023e-02]
 [ 6.70640018e-03]
 [ 8.05580180e-03]
 [ 1.08171295e-02]
 [ 8.50870987e-03]
 [-3.34429402e-02]
 [ 9.37796745e-03]
 [ 6.92076651e-03]
 [ 2.03030603e-02]
 [-4.75371518e-03]
 [-2.15570802e-02]
 [ 2.12306141e-02]
 [ 6.75703946e-04]
 [-3.89499611e-03]
 [-1.29169567e-03]
 [ 1.11802886e-02]
 [ 2.53253200e-03]
 [-5.91296134e-03]
 [-7.59245952e-03]
 [-1.37779617e-03]
 [-5.36901378e-03]
 [ 6.00083196e-04]
 [ 5.35562192e-03]
 [ 5.59789903e-03]
 [-3.39130415e-03]
 [ 6.41197359e-03]
 [-7.26241136e-05]
 [ 1.55105322e-03]
 [-1.97639227e-03]
 [ 9.00849938e-04]
 [-1.12864120e-02]
 [-1.94950589e-03]
 [-1.64130369e-02]
 [-1.27171445e-02]
 [ 2.06549062e-04]
 [-5.27653345e-03]
 [ 2.36500890e-02]
 [-8.16995708e-03]
 [ 8.73826687e-03]
 [-1.11940759e-02]
 [ 1.18311898e-02]
 [-1.94586285e-03]
 [ 1.78903644e-02]
 [-2.24789243e-02]
 [-2.28881227e-03]
 [-1.05498062e-02]
 [-1.47318708e-03]
 [ 1.22896245e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.69556382]
curr_Stock_Price:  99.36684283477766
curr_Factors:  [99.36684283]
mat_Sqrt:  [[0.15]]
grads:  [0.03441328]
Stock Position:  0.03441328447375038
Bond Position:  [-11.11510325]


portfolio before change:  [-7.67824241]
curr_Stock_Price:  99.89036515917785
curr_Factors:  [99.89036516]
mat_Sqrt:  [[0.15]]
grads:  [0.01069207]
Stock Position:  0.010692072564160115
Bond Position:  [-8.74627744]


portfolio before change:  [-7.67863005]
curr_Stock_Price:  99.90523759087246
curr_Factors:  [99.90523759]
mat_Sqrt:  [[0.15]]
grads:  [0.00290902]
Stock Position:  0.002909023386717252
Bond Position:  [-7.96925672]


portfolio before change:  [-7.67830629]
curr_Stock_Price:  100.18775579555313
curr_Factors:  [100.1877558]
mat_Sqrt:  [[0.15]]
grads:  [0.04817002]
Stock Position:  0.04817002492282087
Bond Position:  [-12.50435299]


portfolio before change:  [-7.67430008]
curr_Stock_Price:  100.28714869571742
curr_Factors:  [100.2871487]
mat_Sqrt:  [[0.15]]
grads:  [0.02024151]
Stock Position:  0.020241509713026566
Bond Position:  [-9.70426338]


portfolio before change:  [-7.68379334]
curr_Stock_Price:  99.8481140161163
curr_Factors:  [99.84811402]
mat_Sqrt:  [[0.15]]
grads:  [0.15504415]
Stock Position:  0.15504415262692825
Bond Position:  [-23.16465957]


portfolio before change:  [-7.61015682]
curr_Stock_Price:  100.332391302667
curr_Factors:  [100.3323913]
mat_Sqrt:  [[0.15]]
grads:  [0.01017078]
Stock Position:  0.01017077892050336
Bond Position:  [-8.63061539]


portfolio before change:  [-7.61917313]
curr_Stock_Price:  99.49893671814311
curr_Factors:  [99.49893672]
mat_Sqrt:  [[0.15]]
grads:  [-0.11973404]
Stock Position:  -0.11973403640563254
Bond Position:  [4.29423618]


portfolio before change:  [-7.67090416]
curr_Stock_Price:  99.93322779720026
curr_Factors:  [99.9332278]
mat_Sqrt:  [[0.15]]
grads:  [0.12208978]
Stock Position:  0.12208978019418867
Bond Position:  [-19.87172997]


portfolio before change:  [-7.71670503]
curr_Stock_Price:  99.56825988539592
curr_Factors:  [99.56825989]
mat_Sqrt:  [[0.15]]
grads:  [0.06233761]
Stock Position:  0.062337613823352025
Bond Position:  [-13.92355276]


portfolio before change:  [-7.74900117]
curr_Stock_Price:  99.06413580175236
curr_Factors:  [99.0641358]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-17.78136672]


portfolio before change:  [-7.61671113]
curr_Stock_Price:  100.38140191973254
curr_Factors:  [100.38140192]
mat_Sqrt:  [[0.15]]
grads:  [-0.10605954]
Stock Position:  -0.10605954477747952
Bond Position:  [3.02969466]


portfolio before change:  [-7.63778583]
curr_Stock_Price:  100.58189362553028
curr_Factors:  [100.58189363]
mat_Sqrt:  [[0.15]]
grads:  [0.06681442]
Stock Position:  0.06681441530361028
Bond Position:  [-14.35810624]


portfolio before change:  [-7.65800747]
curr_Stock_Price:  100.29267119290307
curr_Factors:  [100.29267119]
mat_Sqrt:  [[0.15]]
grads:  [0.01702143]
Stock Position:  0.01702142573898609
Bond Position:  [-9.36513172]


portfolio before change:  [-7.65069892]
curr_Stock_Price:  100.75643318208537
curr_Factors:  [100.75643318]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608821]
Stock Position:  -0.046088211641127357
Bond Position:  [-3.0070151]


portfolio before change:  [-7.66481529]
curr_Stock_Price:  101.05864550884804
curr_Factors:  [101.05864551]
mat_Sqrt:  [[0.15]]
grads:  [0.12879788]
Stock Position:  0.12879787619176422
Bond Position:  [-20.6809542]


portfolio before change:  [-7.68310634]
curr_Stock_Price:  100.92666776767561
curr_Factors:  [100.92666777]
mat_Sqrt:  [[0.15]]
grads:  [0.06951128]
Stock Position:  0.06951128154406097
Bond Position:  [-14.69864836]


portfolio before change:  [-7.66692993]
curr_Stock_Price:  101.17260054175473
curr_Factors:  [101.17260054]
mat_Sqrt:  [[0.15]]
grads:  [-0.07670367]
Stock Position:  -0.07670366581192195
Bond Position:  [0.09337941]


portfolio before change:  [-7.63707493]
curr_Stock_Price:  100.78345139942704
curr_Factors:  [100.7834514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00349103]
Stock Position:  -0.0034910331009693012
Bond Position:  [-7.28523656]


portfolio before change:  [-7.63663557]
curr_Stock_Price:  100.52716511127466
curr_Factors:  [100.52716511]
mat_Sqrt:  [[0.15]]
grads:  [0.04044681]
Stock Position:  0.04044680880199754
Bond Position:  [-11.70263859]


portfolio before change:  [-7.59847444]
curr_Stock_Price:  101.48873824992569
curr_Factors:  [101.48873825]
mat_Sqrt:  [[0.15]]
grads:  [0.08795115]
Stock Position:  0.08795115317270759
Bond Position:  [-16.524526]


portfolio before change:  [-7.68205741]
curr_Stock_Price:  100.55014728245507
curr_Factors:  [100.55014728]
mat_Sqrt:  [[0.15]]
grads:  [-0.04568361]
Stock Position:  -0.045683606500513674
Bond Position:  [-3.08856405]


portfolio before change:  [-7.73954559]
curr_Stock_Price:  101.80432002802175
curr_Factors:  [101.80432003]
mat_Sqrt:  [[0.15]]
grads:  [0.07015052]
Stock Position:  0.07015051773157112
Bond Position:  [-14.88117135]


portfolio before change:  [-7.68235343]
curr_Stock_Price:  102.6328564214825
curr_Factors:  [102.63285642]
mat_Sqrt:  [[0.15]]
grads:  [-0.10887864]
Stock Position:  -0.10887863586738683
Bond Position:  [3.49217197]


portfolio before change:  [-7.77177555]
curr_Stock_Price:  103.45616199884758
curr_Factors:  [103.456162]
mat_Sqrt:  [[0.15]]
grads:  [0.04646943]
Stock Position:  0.046469429567818334
Bond Position:  [-12.57932439]


portfolio before change:  [-7.81307533]
curr_Stock_Price:  102.58432991231948
curr_Factors:  [102.58432991]
mat_Sqrt:  [[0.15]]
grads:  [0.05379803]
Stock Position:  0.05379803405165714
Bond Position:  [-13.3319106]


portfolio before change:  [-7.82888908]
curr_Stock_Price:  102.30587217448439
curr_Factors:  [102.30587217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03579271]
Stock Position:  -0.03579270691535213
Bond Position:  [-4.16708498]


portfolio before change:  [-7.82388921]
curr_Stock_Price:  102.15890589210389
curr_Factors:  [102.15890589]
mat_Sqrt:  [[0.15]]
grads:  [0.06496522]
Stock Position:  0.06496522384841365
Bond Position:  [-14.46066539]


portfolio before change:  [-7.79770508]
curr_Stock_Price:  102.5758665171086
curr_Factors:  [102.57586652]
mat_Sqrt:  [[0.15]]
grads:  [0.2509242]
Stock Position:  0.2509241991411584
Bond Position:  [-33.53647224]


portfolio before change:  [-7.86258662]
curr_Stock_Price:  102.3256497614611
curr_Factors:  [102.32564976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00055619]
Stock Position:  -0.000556191094603493
Bond Position:  [-7.805674]


portfolio before change:  [-7.862412]
curr_Stock_Price:  101.13453621713069
curr_Factors:  [101.13453622]
mat_Sqrt:  [[0.15]]
grads:  [0.06039687]
Stock Position:  0.06039686765770141
Bond Position:  [-13.9706212]


portfolio before change:  [-7.82930432]
curr_Stock_Price:  101.69716263469557
curr_Factors:  [101.69716263]
mat_Sqrt:  [[0.15]]
grads:  [-0.07937668]
Stock Position:  -0.0793766819643098
Bond Position:  [0.24307902]


portfolio before change:  [-7.85373895]
curr_Stock_Price:  102.0051853435016
curr_Factors:  [102.00518534]
mat_Sqrt:  [[0.15]]
grads:  [0.04470933]
Stock Position:  0.04470933453689497
Bond Position:  [-12.4143229]


portfolio before change:  [-7.87612887]
curr_Stock_Price:  101.52175145406788
curr_Factors:  [101.52175145]
mat_Sqrt:  [[0.15]]
grads:  [0.05370535]
Stock Position:  0.053705345312618426
Bond Position:  [-13.32838959]


portfolio before change:  [-7.83379551]
curr_Stock_Price:  102.32551531548668
curr_Factors:  [102.32551532]
mat_Sqrt:  [[0.15]]
grads:  [0.0721142]
Stock Position:  0.07211419684801347
Bond Position:  [-15.21291786]


portfolio before change:  [-7.85195844]
curr_Stock_Price:  102.08683701453266
curr_Factors:  [102.08683701]
mat_Sqrt:  [[0.15]]
grads:  [0.05672473]
Stock Position:  0.056724732486622645
Bond Position:  [-13.64280696]


portfolio before change:  [-7.84344198]
curr_Stock_Price:  102.25200600222699
curr_Factors:  [102.252006]
mat_Sqrt:  [[0.15]]
grads:  [-0.22295293]
Stock Position:  -0.22295293436493419
Bond Position:  [14.95394281]


portfolio before change:  [-7.85446469]
curr_Stock_Price:  102.30563779540365
curr_Factors:  [102.3056378]
mat_Sqrt:  [[0.15]]
grads:  [0.06251978]
Stock Position:  0.06251978302234443
Bond Position:  [-14.25059097]


portfolio before change:  [-7.84208038]
curr_Stock_Price:  102.51797060744806
curr_Factors:  [102.51797061]
mat_Sqrt:  [[0.15]]
grads:  [0.04613844]
Stock Position:  0.04613844339900762
Bond Position:  [-12.57209996]


portfolio before change:  [-7.86659056]
curr_Stock_Price:  102.00377026728471
curr_Factors:  [102.00377027]
mat_Sqrt:  [[0.15]]
grads:  [0.13535374]
Stock Position:  0.1353537353014243
Bond Position:  [-21.67318188]


portfolio before change:  [-7.82011115]
curr_Stock_Price:  102.35717037827129
curr_Factors:  [102.35717038]
mat_Sqrt:  [[0.15]]
grads:  [-0.03169143]
Stock Position:  -0.031691434547694665
Bond Position:  [-4.57626559]


portfolio before change:  [-7.80767497]
curr_Stock_Price:  101.9557303810175
curr_Factors:  [101.95573038]
mat_Sqrt:  [[0.15]]
grads:  [-0.14371387]
Stock Position:  -0.14371386771170414
Bond Position:  [6.84477738]


portfolio before change:  [-7.82003034]
curr_Stock_Price:  102.04467922738654
curr_Factors:  [102.04467923]
mat_Sqrt:  [[0.15]]
grads:  [0.14153743]
Stock Position:  0.14153742761743424
Bond Position:  [-22.26317174]


portfolio before change:  [-7.80856142]
curr_Stock_Price:  102.1355414866077
curr_Factors:  [102.13554149]
mat_Sqrt:  [[0.15]]
grads:  [0.00450469]
Stock Position:  0.004504692972831393
Bond Position:  [-8.26865068]


portfolio before change:  [-7.8092407]
curr_Stock_Price:  102.09947430310307
curr_Factors:  [102.0994743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596664]
Stock Position:  -0.025966640731109547
Bond Position:  [-5.15806033]


portfolio before change:  [-7.78702454]
curr_Stock_Price:  101.23149352076926
curr_Factors:  [101.23149352]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086113]
Stock Position:  -0.008611304463313926
Bond Position:  [-6.91528933]


portfolio before change:  [-7.78761748]
curr_Stock_Price:  101.25015711933692
curr_Factors:  [101.25015712]
mat_Sqrt:  [[0.15]]
grads:  [0.07453526]
Stock Position:  0.07453525764190136
Bond Position:  [-15.33432403]


portfolio before change:  [-7.68321421]
curr_Stock_Price:  102.66373916418846
curr_Factors:  [102.66373916]
mat_Sqrt:  [[0.15]]
grads:  [0.01688355]
Stock Position:  0.01688354664918107
Bond Position:  [-9.41654223]


portfolio before change:  [-7.69775229]
curr_Stock_Price:  101.83751870329125
curr_Factors:  [101.8375187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03941974]
Stock Position:  -0.03941974229021637
Bond Position:  [-3.68334355]


portfolio before change:  [-7.68184271]
curr_Stock_Price:  101.42808430777714
curr_Factors:  [101.42808431]
mat_Sqrt:  [[0.15]]
grads:  [-0.0506164]
Stock Position:  -0.050616396788117454
Bond Position:  [-2.54791855]


portfolio before change:  [-7.68150685]
curr_Stock_Price:  101.41830269269175
curr_Factors:  [101.41830269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00918531]
Stock Position:  -0.009185307780180734
Bond Position:  [-6.74994852]


portfolio before change:  [-7.67949276]
curr_Stock_Price:  101.15309993427559
curr_Factors:  [101.15309993]
mat_Sqrt:  [[0.15]]
grads:  [-0.03579343]
Stock Position:  -0.035793425210681004
Bond Position:  [-4.05887685]


portfolio before change:  [-7.66008881]
curr_Stock_Price:  100.60390285710089
curr_Factors:  [100.60390286]
mat_Sqrt:  [[0.15]]
grads:  [0.00400055]
Stock Position:  0.004000554642977177
Bond Position:  [-8.06256022]


portfolio before change:  [-7.66147235]
curr_Stock_Price:  100.3840299828552
curr_Factors:  [100.38402998]
mat_Sqrt:  [[0.15]]
grads:  [0.03570415]
Stock Position:  0.035704146160506024
Bond Position:  [-11.24559842]


portfolio before change:  [-7.67487978]
curr_Stock_Price:  100.02820106346972
curr_Factors:  [100.02820106]
mat_Sqrt:  [[0.15]]
grads:  [0.03731933]
Stock Position:  0.037319326886324444
Bond Position:  [-11.40786492]


portfolio before change:  [-7.6979984]
curr_Stock_Price:  99.42782571597051
curr_Factors:  [99.42782572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02260869]
Stock Position:  -0.022608694338965285
Bond Position:  [-5.45006508]


portfolio before change:  [-7.70571329]
curr_Stock_Price:  99.75399458953797
curr_Factors:  [99.75399459]
mat_Sqrt:  [[0.15]]
grads:  [0.04274649]
Stock Position:  0.04274649062511049
Bond Position:  [-11.96984649]


portfolio before change:  [-7.70960313]
curr_Stock_Price:  99.6804985201052
curr_Factors:  [99.68049852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00048416]
Stock Position:  -0.0004841607575720692
Bond Position:  [-7.66134175]


portfolio before change:  [-7.70992606]
curr_Stock_Price:  99.35846370265195
curr_Factors:  [99.3584637]
mat_Sqrt:  [[0.15]]
grads:  [0.01034035]
Stock Position:  0.010340354783780141
Bond Position:  [-8.73732783]


portfolio before change:  [-7.71160904]
curr_Stock_Price:  99.24851842994626
curr_Factors:  [99.24851843]
mat_Sqrt:  [[0.15]]
grads:  [-0.01317595]
Stock Position:  -0.013175948480767207
Bond Position:  [-6.40391567]


portfolio before change:  [-7.72015862]
curr_Stock_Price:  99.86701834787588
curr_Factors:  [99.86701835]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-8.3199266]


portfolio before change:  [-7.72105693]
curr_Stock_Price:  99.80402695520974
curr_Factors:  [99.80402696]
mat_Sqrt:  [[0.15]]
grads:  [-0.07524275]
Stock Position:  -0.07524274662265625
Bond Position:  [-0.21152782]


portfolio before change:  [-7.68103684]
curr_Stock_Price:  99.27197140928705
curr_Factors:  [99.27197141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01299671]
Stock Position:  -0.012996705938521046
Bond Position:  [-6.39082821]


portfolio before change:  [-7.6848673]
curr_Stock_Price:  99.53596333108314
curr_Factors:  [99.53596333]
mat_Sqrt:  [[0.15]]
grads:  [-0.10942025]
Stock Position:  -0.1094202458870542
Bond Position:  [3.20638228]


portfolio before change:  [-7.6776708]
curr_Stock_Price:  99.4720254436621
curr_Factors:  [99.47202544]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478096]
Stock Position:  -0.08478096344777668
Bond Position:  [0.75566336]


portfolio before change:  [-7.66813606]
curr_Stock_Price:  99.3601194086456
curr_Factors:  [99.36011941]
mat_Sqrt:  [[0.15]]
grads:  [0.00137699]
Stock Position:  0.0013769937434749322
Bond Position:  [-7.80495433]


portfolio before change:  [-7.66774892]
curr_Stock_Price:  99.99553785851762
curr_Factors:  [99.99553786]
mat_Sqrt:  [[0.15]]
grads:  [-0.03517689]
Stock Position:  -0.03517688966230183
Bond Position:  [-4.15021692]


portfolio before change:  [-7.68077111]
curr_Stock_Price:  100.35835542292764
curr_Factors:  [100.35835542]
mat_Sqrt:  [[0.15]]
grads:  [0.15766726]
Stock Position:  0.1576672597726164
Bond Position:  [-23.50399801]


portfolio before change:  [-7.64138612]
curr_Stock_Price:  100.61747094776322
curr_Factors:  [100.61747095]
mat_Sqrt:  [[0.15]]
grads:  [-0.05446638]
Stock Position:  -0.05446638056232444
Bond Position:  [-2.16111666]


portfolio before change:  [-7.65125045]
curr_Stock_Price:  100.79609959412046
curr_Factors:  [100.79609959]
mat_Sqrt:  [[0.15]]
grads:  [0.05825511]
Stock Position:  0.05825511243758896
Bond Position:  [-13.52313857]


portfolio before change:  [-7.62535689]
curr_Stock_Price:  101.25509422070671
curr_Factors:  [101.25509422]
mat_Sqrt:  [[0.15]]
grads:  [-0.07462717]
Stock Position:  -0.07462717277543443
Bond Position:  [-0.06897548]


portfolio before change:  [-7.6875164]
curr_Stock_Price:  102.08797045786284
curr_Factors:  [102.08797046]
mat_Sqrt:  [[0.15]]
grads:  [0.0788746]
Stock Position:  0.0788745985191916
Bond Position:  [-15.73966408]


portfolio before change:  [-7.70927704]
curr_Stock_Price:  101.82455386077919
curr_Factors:  [101.82455386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01297242]
Stock Position:  -0.012972418984619967
Bond Position:  [-6.38836626]


portfolio before change:  [-7.70070661]
curr_Stock_Price:  101.13310880026792
curr_Factors:  [101.1331088]
mat_Sqrt:  [[0.15]]
grads:  [0.1192691]
Stock Position:  0.11926909594413351
Bond Position:  [-19.76276107]


portfolio before change:  [-7.61863567]
curr_Stock_Price:  101.83158103649386
curr_Factors:  [101.83158104]
mat_Sqrt:  [[0.15]]
grads:  [-0.1498595]
Stock Position:  -0.14985949503029922
Bond Position:  [7.64179364]


portfolio before change:  [-7.64924099]
curr_Stock_Price:  102.03899498621567
curr_Factors:  [102.03899499]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525875]
Stock Position:  -0.015258748448781782
Bond Position:  [-6.09225363]


portfolio before change:  [-7.64816271]
curr_Stock_Price:  101.9433740568266
curr_Factors:  [101.94337406]
mat_Sqrt:  [[0.15]]
grads:  [-0.07033204]
Stock Position:  -0.0703320414835348
Bond Position:  [-0.4782771]


portfolio before change:  [-7.56460488]
curr_Stock_Price:  100.75490108784248
curr_Factors:  [100.75490109]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982125]
Stock Position:  -0.009821247220449837
Bond Position:  [-6.57506608]


portfolio before change:  [-7.56878858]
curr_Stock_Price:  101.13904226589291
curr_Factors:  [101.13904227]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.56878858]
Stock Price:  100.30297928803711
PL:  [-7.87176786]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.82968157e-04]
 [-2.33174221e-03]
 [-3.59656650e-03]
 [-5.80580803e-03]
 [ 3.76945096e-02]
 [ 2.64164237e-02]
 [ 4.40728328e-03]
 [ 1.43867933e-02]
 [ 2.45914246e-02]
 [-4.93307153e-03]
 [ 3.05784928e-02]
 [-4.95668296e-02]
 [ 3.32367664e-02]
 [ 2.75755242e-03]
 [-6.90184632e-03]
 [ 2.33030022e-02]
 [ 1.05642400e-02]
 [-1.15744505e-02]
 [-5.76016162e-04]
 [ 7.94269284e-03]
 [ 1.14286344e-02]
 [-8.51148783e-03]
 [ 7.57194080e-03]
 [ 1.93095643e-02]
 [-8.06595707e-03]
 [ 7.35467733e-03]
 [-6.46882957e-03]
 [ 6.09442575e-03]
 [-8.89446957e-03]
 [-2.46224471e-03]
 [ 3.41471718e-03]
 [-1.16646788e-02]
 [ 4.41033146e-03]
 [ 6.56355551e-03]
 [ 1.15367154e-02]
 [ 1.19691200e-02]
 [-3.43662816e-02]
 [ 9.76132779e-03]
 [-5.55937895e-03]
 [ 1.75634111e-02]
 [-5.52319738e-03]
 [-1.78427959e-02]
 [ 2.13137286e-02]
 [ 1.69277567e-03]
 [-5.01808254e-03]
 [-4.50627742e-03]
 [ 1.17918839e-02]
 [-2.57544222e-03]
 [-9.79420689e-03]
 [-7.28630379e-03]
 [ 4.22415948e-02]
 [-4.84408744e-03]
 [-6.72496575e-03]
 [ 5.59219278e-03]
 [-2.30175156e-03]
 [-1.34143929e-03]
 [ 7.55522040e-03]
 [-4.92388002e-04]
 [ 1.62880242e-03]
 [ 1.48801342e-02]
 [-9.86649687e-04]
 [-7.17710512e-03]
 [-6.06235332e-03]
 [-1.26766569e-02]
 [-4.98018595e-03]
 [-7.25654006e-04]
 [-5.52704766e-03]
 [ 1.55258169e-02]
 [-8.24879192e-03]
 [ 1.06940463e-02]
 [-1.15694396e-02]
 [ 1.24919459e-02]
 [ 1.96329754e-04]
 [ 2.12564020e-02]
 [-2.27953355e-02]
 [-1.08700686e-03]
 [-7.15979661e-03]
 [-5.02966016e-03]
 [ 3.05076300e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.75533778]
curr_Stock_Price:  100.82671178824314
curr_Factors:  [100.82671179]
mat_Sqrt:  [[0.15]]
grads:  [-0.00188645]
Stock Position:  -0.0018864543805497628
Bond Position:  [14.94554277]


portfolio before change:  [14.75538811]
curr_Stock_Price:  101.29520591602783
curr_Factors:  [101.29520592]
mat_Sqrt:  [[0.15]]
grads:  [-0.01554495]
Stock Position:  -0.015544948059015287
Bond Position:  [16.33001683]


portfolio before change:  [14.74375712]
curr_Stock_Price:  102.10908163535323
curr_Factors:  [102.10908164]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397711]
Stock Position:  -0.023977110029038396
Bond Position:  [17.1920378]


portfolio before change:  [14.7250565]
curr_Stock_Price:  102.93383304541585
curr_Factors:  [102.93383305]
mat_Sqrt:  [[0.15]]
grads:  [-0.03870539]
Stock Position:  -0.03870538683838718
Bond Position:  [18.70915032]


portfolio before change:  [14.74666902]
curr_Stock_Price:  102.40565934751884
curr_Factors:  [102.40565935]
mat_Sqrt:  [[0.15]]
grads:  [0.25129673]
Stock Position:  0.2512967307055254
Bond Position:  [-10.98753838]


portfolio before change:  [14.85328346]
curr_Stock_Price:  102.83264930825551
curr_Factors:  [102.83264931]
mat_Sqrt:  [[0.15]]
grads:  [0.17610949]
Stock Position:  0.17610949131104306
Bond Position:  [-3.2565221]


portfolio before change:  [14.82285976]
curr_Stock_Price:  102.6610505826734
curr_Factors:  [102.66105058]
mat_Sqrt:  [[0.15]]
grads:  [0.02938189]
Stock Position:  0.02938188852058091
Bond Position:  [11.80648421]


portfolio before change:  [14.81789364]
curr_Stock_Price:  102.46691581546082
curr_Factors:  [102.46691582]
mat_Sqrt:  [[0.15]]
grads:  [0.09591196]
Stock Position:  0.09591195561033015
Bond Position:  [4.99009136]


portfolio before change:  [14.79772748]
curr_Stock_Price:  102.25340694590287
curr_Factors:  [102.25340695]
mat_Sqrt:  [[0.15]]
grads:  [0.16394283]
Stock Position:  0.1639428308363201
Bond Position:  [-1.96598552]


portfolio before change:  [14.79854293]
curr_Stock_Price:  102.25913044443796
curr_Factors:  [102.25913044]
mat_Sqrt:  [[0.15]]
grads:  [-0.03288714]
Stock Position:  -0.03288714352493629
Bond Position:  [18.16155363]


portfolio before change:  [14.81300501]
curr_Stock_Price:  101.85389765606003
curr_Factors:  [101.85389766]
mat_Sqrt:  [[0.15]]
grads:  [0.20385662]
Stock Position:  0.20385661873883995
Bond Position:  [-5.95058617]


portfolio before change:  [14.72050839]
curr_Stock_Price:  101.40198839311799
curr_Factors:  [101.40198839]
mat_Sqrt:  [[0.15]]
grads:  [-0.33044553]
Stock Position:  -0.3304455306645653
Bond Position:  [48.22834225]


portfolio before change:  [14.78609611]
curr_Stock_Price:  101.21262782998434
curr_Factors:  [101.21262783]
mat_Sqrt:  [[0.15]]
grads:  [0.22157844]
Stock Position:  0.2215784425526048
Bond Position:  [-7.64044033]


portfolio before change:  [14.75650214]
curr_Stock_Price:  101.08122322263257
curr_Factors:  [101.08122322]
mat_Sqrt:  [[0.15]]
grads:  [0.01838368]
Stock Position:  0.018383682796510325
Bond Position:  [12.89825699]


portfolio before change:  [14.76365619]
curr_Stock_Price:  101.42652352864827
curr_Factors:  [101.42652353]
mat_Sqrt:  [[0.15]]
grads:  [-0.04601231]
Stock Position:  -0.046012308793993956
Bond Position:  [19.43052471]


portfolio before change:  [14.75455616]
curr_Stock_Price:  101.65069138507981
curr_Factors:  [101.65069139]
mat_Sqrt:  [[0.15]]
grads:  [0.15535335]
Stock Position:  0.1553533479145892
Bond Position:  [-1.03721907]


portfolio before change:  [14.69445759]
curr_Stock_Price:  101.2642578438586
curr_Factors:  [101.26425784]
mat_Sqrt:  [[0.15]]
grads:  [0.07042827]
Stock Position:  0.07042826671899621
Bond Position:  [7.56259143]


portfolio before change:  [14.6567931]
curr_Stock_Price:  100.72275426879972
curr_Factors:  [100.72275427]
mat_Sqrt:  [[0.15]]
grads:  [-0.077163]
Stock Position:  -0.07716300361660243
Bond Position:  [22.42886336]


portfolio before change:  [14.64702072]
curr_Stock_Price:  100.86756767050042
curr_Factors:  [100.86756767]
mat_Sqrt:  [[0.15]]
grads:  [-0.00384011]
Stock Position:  -0.0038401077490744784
Bond Position:  [15.03436304]


portfolio before change:  [14.64971633]
curr_Stock_Price:  100.41030402734948
curr_Factors:  [100.41030403]
mat_Sqrt:  [[0.15]]
grads:  [0.05295129]
Stock Position:  0.05295128562470708
Bond Position:  [9.33286165]


portfolio before change:  [14.61224908]
curr_Stock_Price:  99.69170822371612
curr_Factors:  [99.69170822]
mat_Sqrt:  [[0.15]]
grads:  [0.0761909]
Stock Position:  0.07619089568549918
Bond Position:  [7.01664854]


portfolio before change:  [14.55150203]
curr_Stock_Price:  98.88865154961333
curr_Factors:  [98.88865155]
mat_Sqrt:  [[0.15]]
grads:  [-0.05674325]
Stock Position:  -0.05674325222385478
Bond Position:  [20.16276573]


portfolio before change:  [14.56340822]
curr_Stock_Price:  98.70103498637731
curr_Factors:  [98.70103499]
mat_Sqrt:  [[0.15]]
grads:  [0.05047961]
Stock Position:  0.05047960530174712
Bond Position:  [9.58101893]


portfolio before change:  [14.57592061]
curr_Stock_Price:  98.9370424728561
curr_Factors:  [98.93704247]
mat_Sqrt:  [[0.15]]
grads:  [0.12873043]
Stock Position:  0.12873042839045332
Bond Position:  [1.83971275]


portfolio before change:  [14.56608081]
curr_Stock_Price:  98.85971192116627
curr_Factors:  [98.85971192]
mat_Sqrt:  [[0.15]]
grads:  [-0.05377305]
Stock Position:  -0.053773047145691824
Bond Position:  [19.88206876]


portfolio before change:  [14.52479004]
curr_Stock_Price:  99.6506924920464
curr_Factors:  [99.65069249]
mat_Sqrt:  [[0.15]]
grads:  [0.04903118]
Stock Position:  0.04903118222502082
Bond Position:  [9.63879878]


portfolio before change:  [14.50857994]
curr_Stock_Price:  99.30779760256986
curr_Factors:  [99.3077976]
mat_Sqrt:  [[0.15]]
grads:  [-0.04312553]
Stock Position:  -0.04312553048413755
Bond Position:  [18.79128139]


portfolio before change:  [14.50557256]
curr_Stock_Price:  99.40476737842668
curr_Factors:  [99.40476738]
mat_Sqrt:  [[0.15]]
grads:  [0.0406295]
Stock Position:  0.04062950497150208
Bond Position:  [10.46680607]


portfolio before change:  [14.51056226]
curr_Stock_Price:  99.51147566515978
curr_Factors:  [99.51147567]
mat_Sqrt:  [[0.15]]
grads:  [-0.05929646]
Stock Position:  -0.059296463806347455
Bond Position:  [20.41124087]


portfolio before change:  [14.49032187]
curr_Stock_Price:  99.87433251993484
curr_Factors:  [99.87433252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01641496]
Stock Position:  -0.01641496474497782
Bond Position:  [16.12975552]


portfolio before change:  [14.4882813]
curr_Stock_Price:  100.06006009195148
curr_Factors:  [100.06006009]
mat_Sqrt:  [[0.15]]
grads:  [0.02276478]
Stock Position:  0.022764781221578257
Bond Position:  [12.21043593]


portfolio before change:  [14.49051543]
curr_Stock_Price:  100.12467538821579
curr_Factors:  [100.12467539]
mat_Sqrt:  [[0.15]]
grads:  [-0.07776453]
Stock Position:  -0.07776452547031204
Bond Position:  [22.2766633]


portfolio before change:  [14.47529162]
curr_Stock_Price:  100.33834802602179
curr_Factors:  [100.33834803]
mat_Sqrt:  [[0.15]]
grads:  [0.02940221]
Stock Position:  0.029402209745482175
Bond Position:  [11.52512246]


portfolio before change:  [14.48058958]
curr_Stock_Price:  100.49403770744635
curr_Factors:  [100.49403771]
mat_Sqrt:  [[0.15]]
grads:  [0.04375704]
Stock Position:  0.04375703670232331
Bond Position:  [10.08326828]


portfolio before change:  [14.47089707]
curr_Stock_Price:  100.25812737091348
curr_Factors:  [100.25812737]
mat_Sqrt:  [[0.15]]
grads:  [0.07691144]
Stock Position:  0.07691143582161233
Bond Position:  [6.75990054]


portfolio before change:  [14.45669332]
curr_Stock_Price:  100.06795727507172
curr_Factors:  [100.06795728]
mat_Sqrt:  [[0.15]]
grads:  [0.07979413]
Stock Position:  0.07979413323465706
Bond Position:  [6.4718574]


portfolio before change:  [14.48703094]
curr_Stock_Price:  100.44308660190163
curr_Factors:  [100.4430866]
mat_Sqrt:  [[0.15]]
grads:  [-0.22910854]
Stock Position:  -0.22910854392024682
Bond Position:  [37.49940026]


portfolio before change:  [14.4952835]
curr_Stock_Price:  100.41729630377233
curr_Factors:  [100.4172963]
mat_Sqrt:  [[0.15]]
grads:  [0.06507552]
Stock Position:  0.0650755185868075
Bond Position:  [7.96057587]


portfolio before change:  [14.48913422]
curr_Stock_Price:  100.31515593796794
curr_Factors:  [100.31515594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03706253]
Stock Position:  -0.037062526347939294
Bond Position:  [18.20706733]


portfolio before change:  [14.44847651]
curr_Stock_Price:  101.44286332700179
curr_Factors:  [101.44286333]
mat_Sqrt:  [[0.15]]
grads:  [0.11708941]
Stock Position:  0.11708940720058218
Bond Position:  [2.57059178]


portfolio before change:  [14.45175889]
curr_Stock_Price:  101.46952424416703
curr_Factors:  [101.46952424]
mat_Sqrt:  [[0.15]]
grads:  [-0.03682132]
Stock Position:  -0.03682131585777066
Bond Position:  [18.18800029]


portfolio before change:  [14.46159285]
curr_Stock_Price:  101.23332484940583
curr_Factors:  [101.23332485]
mat_Sqrt:  [[0.15]]
grads:  [-0.11895197]
Stock Position:  -0.11895197275901485
Bond Position:  [26.50349655]


portfolio before change:  [14.37583424]
curr_Stock_Price:  101.96820235157824
curr_Factors:  [101.96820235]
mat_Sqrt:  [[0.15]]
grads:  [0.14209152]
Stock Position:  0.14209152368323924
Bond Position:  [-0.112983]


portfolio before change:  [14.31100299]
curr_Stock_Price:  101.5119880241193
curr_Factors:  [101.51198802]
mat_Sqrt:  [[0.15]]
grads:  [0.01128517]
Stock Position:  0.011285171145100756
Bond Position:  [13.16542283]


portfolio before change:  [14.31469029]
curr_Stock_Price:  101.76581134702487
curr_Factors:  [101.76581135]
mat_Sqrt:  [[0.15]]
grads:  [-0.03345388]
Stock Position:  -0.03345388360570095
Bond Position:  [17.7191519]


portfolio before change:  [14.32471064]
curr_Stock_Price:  101.49938892441578
curr_Factors:  [101.49938892]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004185]
Stock Position:  -0.030041849434139813
Bond Position:  [17.37394]


portfolio before change:  [14.32560063]
curr_Stock_Price:  101.50591033595266
curr_Factors:  [101.50591034]
mat_Sqrt:  [[0.15]]
grads:  [0.07861256]
Stock Position:  0.07861255939406046
Bond Position:  [6.34596122]


portfolio before change:  [14.34603209]
curr_Stock_Price:  101.76076558998298
curr_Factors:  [101.76076559]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716961]
Stock Position:  -0.01716961482641434
Bond Position:  [16.09322524]


portfolio before change:  [14.35852027]
curr_Stock_Price:  101.09200724061489
curr_Factors:  [101.09200724]
mat_Sqrt:  [[0.15]]
grads:  [-0.06529471]
Stock Position:  -0.06529471259804845
Bond Position:  [20.95929383]


portfolio before change:  [14.40698634]
curr_Stock_Price:  100.36980371133339
curr_Factors:  [100.36980371]
mat_Sqrt:  [[0.15]]
grads:  [-0.04857536]
Stock Position:  -0.048575358592784355
Bond Position:  [19.28248554]


portfolio before change:  [14.41689382]
curr_Stock_Price:  100.19065346203996
curr_Factors:  [100.19065346]
mat_Sqrt:  [[0.15]]
grads:  [0.28161063]
Stock Position:  0.28161063200769687
Bond Position:  [-13.79785942]


portfolio before change:  [14.70492651]
curr_Stock_Price:  101.21652057348156
curr_Factors:  [101.21652057]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229392]
Stock Position:  -0.03229391627808688
Bond Position:  [17.97360435]


portfolio before change:  [14.67520753]
curr_Stock_Price:  102.17157234771895
curr_Factors:  [102.17157235]
mat_Sqrt:  [[0.15]]
grads:  [-0.0448331]
Stock Position:  -0.04483310499482195
Bond Position:  [19.25587636]


portfolio before change:  [14.65671978]
curr_Stock_Price:  102.61078528529497
curr_Factors:  [102.61078529]
mat_Sqrt:  [[0.15]]
grads:  [0.03728129]
Stock Position:  0.037281285199951164
Bond Position:  [10.83125783]


portfolio before change:  [14.65021856]
curr_Stock_Price:  102.41824372340187
curr_Factors:  [102.41824372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534501]
Stock Position:  -0.015345010419996854
Bond Position:  [16.22182758]


portfolio before change:  [14.6698017]
curr_Stock_Price:  101.20812783913836
curr_Factors:  [101.20812784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00894293]
Stock Position:  -0.008942928611325857
Bond Position:  [15.57489876]


portfolio before change:  [14.66789387]
curr_Stock_Price:  101.53031378485092
curr_Factors:  [101.53031378]
mat_Sqrt:  [[0.15]]
grads:  [0.05036814]
Stock Position:  0.050368136001791616
Bond Position:  [9.55400122]


portfolio before change:  [14.64735899]
curr_Stock_Price:  101.11076218624835
curr_Factors:  [101.11076219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00328259]
Stock Position:  -0.0032825866783570195
Bond Position:  [14.97926383]


portfolio before change:  [14.64560037]
curr_Stock_Price:  101.9317145387472
curr_Factors:  [101.93171454]
mat_Sqrt:  [[0.15]]
grads:  [0.01085868]
Stock Position:  0.01085868278196531
Bond Position:  [13.53875622]


portfolio before change:  [14.64488526]
curr_Stock_Price:  101.78792965994617
curr_Factors:  [101.78792966]
mat_Sqrt:  [[0.15]]
grads:  [0.09920089]
Stock Position:  0.09920089449298614
Bond Position:  [4.54743159]


portfolio before change:  [14.63663629]
curr_Stock_Price:  101.70191035101836
curr_Factors:  [101.70191035]
mat_Sqrt:  [[0.15]]
grads:  [-0.00657766]
Stock Position:  -0.006577664578285408
Bond Position:  [15.30559734]


portfolio before change:  [14.6403938]
curr_Stock_Price:  101.27609285297238
curr_Factors:  [101.27609285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04784737]
Stock Position:  -0.047847367471125966
Bond Position:  [19.48618823]


portfolio before change:  [14.64194711]
curr_Stock_Price:  101.26908335033234
curr_Factors:  [101.26908335]
mat_Sqrt:  [[0.15]]
grads:  [-0.04041569]
Stock Position:  -0.04041568881098805
Bond Position:  [18.73480687]


portfolio before change:  [14.62717335]
curr_Stock_Price:  101.66360155610398
curr_Factors:  [101.66360156]
mat_Sqrt:  [[0.15]]
grads:  [-0.08451105]
Stock Position:  -0.08451104625176833
Bond Position:  [23.21887068]


portfolio before change:  [14.65873868]
curr_Stock_Price:  101.30726819468772
curr_Factors:  [101.30726819]
mat_Sqrt:  [[0.15]]
grads:  [-0.03320124]
Stock Position:  -0.033201239635491125
Bond Position:  [18.02226557]


portfolio before change:  [14.66422283]
curr_Stock_Price:  101.17601649686284
curr_Factors:  [101.1760165]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483769]
Stock Position:  -0.004837693370085041
Bond Position:  [15.15368137]


portfolio before change:  [14.66346229]
curr_Stock_Price:  101.52900915920418
curr_Factors:  [101.52900916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684698]
Stock Position:  -0.036846984392011235
Bond Position:  [18.40450011]


portfolio before change:  [14.65057276]
curr_Stock_Price:  101.91004029012994
curr_Factors:  [101.91004029]
mat_Sqrt:  [[0.15]]
grads:  [0.10350545]
Stock Position:  0.10350544608912068
Bond Position:  [4.10232858]


portfolio before change:  [14.73675671]
curr_Stock_Price:  102.74021443582771
curr_Factors:  [102.74021444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499195]
Stock Position:  -0.05499194614376786
Bond Position:  [20.38664105]


portfolio before change:  [14.76648546]
curr_Stock_Price:  102.22278330173422
curr_Factors:  [102.2227833]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [7.47865093]


portfolio before change:  [14.76297053]
curr_Stock_Price:  102.16692474671054
curr_Factors:  [102.16692475]
mat_Sqrt:  [[0.15]]
grads:  [-0.0771296]
Stock Position:  -0.0771295972193088
Bond Position:  [22.64306428]


portfolio before change:  [14.72152392]
curr_Stock_Price:  102.72263674620987
curr_Factors:  [102.72263675]
mat_Sqrt:  [[0.15]]
grads:  [0.08327964]
Stock Position:  0.08327963938906767
Bond Position:  [6.16681978]


portfolio before change:  [14.68154408]
curr_Stock_Price:  102.23794114291712
curr_Factors:  [102.23794114]
mat_Sqrt:  [[0.15]]
grads:  [0.00130887]
Stock Position:  0.0013088650299282927
Bond Position:  [14.54772842]


portfolio before change:  [14.68291613]
curr_Stock_Price:  102.59151471843553
curr_Factors:  [102.59151472]
mat_Sqrt:  [[0.15]]
grads:  [0.14170935]
Stock Position:  0.1417093463599938
Bond Position:  [0.14473963]


portfolio before change:  [14.77561954]
curr_Stock_Price:  103.24563082373952
curr_Factors:  [103.24563082]
mat_Sqrt:  [[0.15]]
grads:  [-0.1519689]
Stock Position:  -0.15196890322876977
Bond Position:  [30.46574482]


portfolio before change:  [14.86113995]
curr_Stock_Price:  102.69541137500289
curr_Factors:  [102.69541138]
mat_Sqrt:  [[0.15]]
grads:  [-0.00724671]
Stock Position:  -0.007246712421549411
Bond Position:  [15.60534407]


portfolio before change:  [14.85660356]
curr_Stock_Price:  103.45599861524536
curr_Factors:  [103.45599862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04773198]
Stock Position:  -0.04773197743324967
Bond Position:  [19.79476295]


portfolio before change:  [14.87299718]
curr_Stock_Price:  103.13846718336855
curr_Factors:  [103.13846718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03353107]
Stock Position:  -0.033531067716563535
Bond Position:  [18.3313401]


portfolio before change:  [14.87023322]
curr_Stock_Price:  103.25506647792616
curr_Factors:  [103.25506648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.87023322]
Stock Price:  103.38664642496946
PL:  [11.4835868]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-7.67162379e-06]
 [ 3.11164694e-03]
 [-1.40365599e-04]
 [ 5.06199570e-03]
 [ 3.61672977e-03]
 [ 2.53942142e-02]
 [ 2.93356088e-03]
 [ 1.60457463e-02]
 [ 2.41389798e-02]
 [-1.49062804e-03]
 [ 5.85062783e-02]
 [ 4.42729419e-03]
 [ 1.16444784e-01]
 [ 1.67147780e-02]
 [-6.89306581e-03]
 [ 2.86423216e-02]
 [ 1.30996553e-02]
 [-2.97613275e-03]
 [ 1.08167943e-02]
 [-1.01818867e-02]
 [ 1.51638661e-02]
 [-2.00150663e-02]
 [ 1.04013394e-02]
 [-5.66644423e-02]
 [ 9.70361831e-03]
 [ 6.40127823e-03]
 [-4.41440053e-03]
 [ 1.85777054e-02]
 [ 5.39216244e-02]
 [ 4.76083956e-03]
 [ 1.97540382e-02]
 [ 6.49689080e-04]
 [-2.08121531e-03]
 [ 8.53215759e-03]
 [ 1.04422736e-02]
 [ 7.75468751e-03]
 [-3.28941473e-02]
 [ 8.76983475e-03]
 [ 1.38898775e-02]
 [ 9.90842137e-03]
 [-4.56770126e-03]
 [-2.11134417e-02]
 [ 2.09413624e-02]
 [-4.39165659e-04]
 [-6.05830388e-04]
 [-1.35712746e-02]
 [ 1.38654748e-02]
 [ 5.35247985e-03]
 [ 4.18681682e-03]
 [-7.44720445e-03]
 [-2.21738019e-02]
 [ 2.69697638e-03]
 [-8.87833657e-03]
 [ 5.88798957e-03]
 [-1.32900343e-02]
 [ 1.75123199e-02]
 [ 1.25962601e-02]
 [ 9.10164137e-04]
 [ 1.81920028e-03]
 [ 1.25051954e-02]
 [ 1.35232341e-02]
 [ 3.27109954e-02]
 [ 2.85978437e-03]
 [-1.24819436e-02]
 [ 1.08752669e-02]
 [ 4.62739221e-03]
 [-5.25833047e-03]
 [ 1.53814081e-02]
 [-1.00010125e-02]
 [-7.85337606e-03]
 [-1.22011581e-02]
 [ 1.36285455e-02]
 [-2.57931775e-03]
 [ 2.58254639e-02]
 [-2.44991872e-02]
 [ 3.91793782e-04]
 [-8.08844131e-03]
 [-5.30751837e-03]
 [ 3.05639910e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.85478816]
curr_Stock_Price:  100.37800383265554
curr_Factors:  [100.37800383]
mat_Sqrt:  [[0.15]]
grads:  [-5.11441586e-05]
Stock Position:  -5.114415858947901e-05
Bond Position:  [7.85992191]


portfolio before change:  [7.85528712]
curr_Stock_Price:  100.22742518687322
curr_Factors:  [100.22742519]
mat_Sqrt:  [[0.15]]
grads:  [0.02074431]
Stock Position:  0.020744312906551682
Bond Position:  [5.77613805]


portfolio before change:  [7.84518022]
curr_Stock_Price:  99.72280904554675
curr_Factors:  [99.72280905]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093577]
Stock Position:  -0.0009357706630382333
Bond Position:  [7.9384979]


portfolio before change:  [7.84464697]
curr_Stock_Price:  100.82289582930396
curr_Factors:  [100.82289583]
mat_Sqrt:  [[0.15]]
grads:  [0.03374664]
Stock Position:  0.033746638033137245
Bond Position:  [4.4422132]


portfolio before change:  [7.82330034]
curr_Stock_Price:  100.18211287115136
curr_Factors:  [100.18211287]
mat_Sqrt:  [[0.15]]
grads:  [0.02411153]
Stock Position:  0.024111531818154848
Bond Position:  [5.40775614]


portfolio before change:  [7.82416104]
curr_Stock_Price:  100.20379116143113
curr_Factors:  [100.20379116]
mat_Sqrt:  [[0.15]]
grads:  [0.16929476]
Stock Position:  0.1692947615996916
Bond Position:  [-9.1398159]


portfolio before change:  [8.09715377]
curr_Stock_Price:  101.81969465181817
curr_Factors:  [101.81969465]
mat_Sqrt:  [[0.15]]
grads:  [0.01955707]
Stock Position:  0.019557072521659537
Bond Position:  [6.10585862]


portfolio before change:  [8.11478717]
curr_Stock_Price:  102.70181869790329
curr_Factors:  [102.7018187]
mat_Sqrt:  [[0.15]]
grads:  [0.10697164]
Stock Position:  0.10697164185361238
Bond Position:  [-2.871395]


portfolio before change:  [8.2620978]
curr_Stock_Price:  104.08059626555553
curr_Factors:  [104.08059627]
mat_Sqrt:  [[0.15]]
grads:  [0.16092653]
Stock Position:  0.16092653185412253
Bond Position:  [-8.48723159]


portfolio before change:  [8.18604972]
curr_Stock_Price:  103.61132864324797
curr_Factors:  [103.61132864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00993752]
Stock Position:  -0.009937520258474842
Bond Position:  [9.2156894]


portfolio before change:  [8.18558449]
curr_Stock_Price:  103.71610597027143
curr_Factors:  [103.71610597]
mat_Sqrt:  [[0.15]]
grads:  [0.39004186]
Stock Position:  0.39004185521181045
Bond Position:  [-32.2680379]


portfolio before change:  [7.73965704]
curr_Stock_Price:  102.57799572197594
curr_Factors:  [102.57799572]
mat_Sqrt:  [[0.15]]
grads:  [0.02951529]
Stock Position:  0.02951529459235792
Bond Position:  [4.71203728]


portfolio before change:  [7.7624561]
curr_Stock_Price:  103.34046642636508
curr_Factors:  [103.34046643]
mat_Sqrt:  [[0.15]]
grads:  [0.77629856]
Stock Position:  0.7762985623359043
Bond Position:  [-72.46059942]


portfolio before change:  [7.81461801]
curr_Stock_Price:  103.41349352897385
curr_Factors:  [103.41349353]
mat_Sqrt:  [[0.15]]
grads:  [0.11143185]
Stock Position:  0.11143185301372045
Bond Position:  [-3.7089392]


portfolio before change:  [7.80417114]
curr_Stock_Price:  103.32182268668079
curr_Factors:  [103.32182269]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595377]
Stock Position:  -0.045953772099267216
Bond Position:  [12.55219863]


portfolio before change:  [7.82514028]
curr_Stock_Price:  102.88258551641863
curr_Factors:  [102.88258552]
mat_Sqrt:  [[0.15]]
grads:  [0.19094881]
Stock Position:  0.19094881049929543
Bond Position:  [-11.82016704]


portfolio before change:  [7.90942737]
curr_Stock_Price:  103.32786649827104
curr_Factors:  [103.3278665]
mat_Sqrt:  [[0.15]]
grads:  [0.08733104]
Stock Position:  0.0873310353855402
Bond Position:  [-1.11430219]


portfolio before change:  [7.92811531]
curr_Stock_Price:  103.5426536097536
curr_Factors:  [103.54265361]
mat_Sqrt:  [[0.15]]
grads:  [-0.01984089]
Stock Position:  -0.019840885022291314
Bond Position:  [9.98249319]


portfolio before change:  [7.92612092]
curr_Stock_Price:  103.67461928781928
curr_Factors:  [103.67461929]
mat_Sqrt:  [[0.15]]
grads:  [0.07211196]
Stock Position:  0.07211196178119372
Bond Position:  [0.44994073]


portfolio before change:  [7.9852316]
curr_Stock_Price:  104.49393631110195
curr_Factors:  [104.49393631]
mat_Sqrt:  [[0.15]]
grads:  [-0.06787924]
Stock Position:  -0.06787924490031669
Bond Position:  [15.07820109]


portfolio before change:  [7.98058222]
curr_Stock_Price:  104.57631489892748
curr_Factors:  [104.5763149]
mat_Sqrt:  [[0.15]]
grads:  [0.10109244]
Stock Position:  0.10109244095900763
Bond Position:  [-2.59129272]


portfolio before change:  [8.06690611]
curr_Stock_Price:  105.43182744351056
curr_Factors:  [105.43182744]
mat_Sqrt:  [[0.15]]
grads:  [-0.13343378]
Stock Position:  -0.13343377540078163
Bond Position:  [22.13507289]


portfolio before change:  [8.16243926]
curr_Stock_Price:  104.7262364912308
curr_Factors:  [104.72623649]
mat_Sqrt:  [[0.15]]
grads:  [0.06934226]
Stock Position:  0.06934226291002887
Bond Position:  [0.90048503]


portfolio before change:  [8.12630007]
curr_Stock_Price:  104.20425360978307
curr_Factors:  [104.20425361]
mat_Sqrt:  [[0.15]]
grads:  [-0.37776295]
Stock Position:  -0.3777629487353256
Bond Position:  [47.49080618]


portfolio before change:  [8.07230109]
curr_Stock_Price:  104.35505516763779
curr_Factors:  [104.35505517]
mat_Sqrt:  [[0.15]]
grads:  [0.06469079]
Stock Position:  0.06469078873474306
Bond Position:  [1.32149027]


portfolio before change:  [8.07152866]
curr_Stock_Price:  104.34183802260674
curr_Factors:  [104.34183802]
mat_Sqrt:  [[0.15]]
grads:  [0.04267519]
Stock Position:  0.04267518817538867
Bond Position:  [3.61872109]


portfolio before change:  [8.0713072]
curr_Stock_Price:  104.3313485244676
curr_Factors:  [104.33134852]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942934]
Stock Position:  -0.0294293368934427
Bond Position:  [11.1417096]


portfolio before change:  [8.06378761]
curr_Stock_Price:  104.61052465544668
curr_Factors:  [104.61052466]
mat_Sqrt:  [[0.15]]
grads:  [0.12385137]
Stock Position:  0.12385136933658082
Bond Position:  [-4.89236912]


portfolio before change:  [7.99241191]
curr_Stock_Price:  104.03669235261839
curr_Factors:  [104.03669235]
mat_Sqrt:  [[0.15]]
grads:  [0.3594775]
Stock Position:  0.35947749630118075
Bond Position:  [-29.40643778]


portfolio before change:  [7.88021848]
curr_Stock_Price:  103.72970381506049
curr_Factors:  [103.72970382]
mat_Sqrt:  [[0.15]]
grads:  [0.03173893]
Stock Position:  0.03173893042847102
Bond Position:  [4.58794862]


portfolio before change:  [7.89978553]
curr_Stock_Price:  104.33716909029623
curr_Factors:  [104.33716909]
mat_Sqrt:  [[0.15]]
grads:  [0.13169359]
Stock Position:  0.1316935878888879
Bond Position:  [-5.84075062]


portfolio before change:  [7.88183467]
curr_Stock_Price:  104.20363336537393
curr_Factors:  [104.20363337]
mat_Sqrt:  [[0.15]]
grads:  [0.00433126]
Stock Position:  0.004331260531661158
Bond Position:  [7.43050159]


portfolio before change:  [7.88247063]
curr_Stock_Price:  104.24323719695379
curr_Factors:  [104.2432372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01387477]
Stock Position:  -0.013874768737204205
Bond Position:  [9.32882144]


portfolio before change:  [7.89267714]
curr_Stock_Price:  103.54964461019605
curr_Factors:  [103.54964461]
mat_Sqrt:  [[0.15]]
grads:  [0.05688105]
Stock Position:  0.05688105062214921
Bond Position:  [2.00266456]


portfolio before change:  [7.88140599]
curr_Stock_Price:  103.34929118349598
curr_Factors:  [103.34929118]
mat_Sqrt:  [[0.15]]
grads:  [0.06961516]
Stock Position:  0.06961515708431477
Bond Position:  [0.68672885]


portfolio before change:  [7.87082466]
curr_Stock_Price:  103.19667713986593
curr_Factors:  [103.19667714]
mat_Sqrt:  [[0.15]]
grads:  [0.05169792]
Stock Position:  0.05169791675453124
Bond Position:  [2.53577144]


portfolio before change:  [7.87772816]
curr_Stock_Price:  103.32714673527535
curr_Factors:  [103.32714674]
mat_Sqrt:  [[0.15]]
grads:  [-0.21929432]
Stock Position:  -0.2192943155406416
Bond Position:  [30.53678408]


portfolio before change:  [7.64987034]
curr_Stock_Price:  104.3749004433
curr_Factors:  [104.37490044]
mat_Sqrt:  [[0.15]]
grads:  [0.05846556]
Stock Position:  0.05846556499693196
Bond Position:  [1.54753281]


portfolio before change:  [7.65309308]
curr_Stock_Price:  104.42836808475418
curr_Factors:  [104.42836808]
mat_Sqrt:  [[0.15]]
grads:  [0.09259918]
Stock Position:  0.09259918301806605
Bond Position:  [-2.01688849]


portfolio before change:  [7.57937551]
curr_Stock_Price:  103.63363634555944
curr_Factors:  [103.63363635]
mat_Sqrt:  [[0.15]]
grads:  [0.06605614]
Stock Position:  0.06605614246997472
Bond Position:  [0.73373726]


portfolio before change:  [7.50944915]
curr_Stock_Price:  102.57435228783056
curr_Factors:  [102.57435229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03045134]
Stock Position:  -0.03045134170768746
Bond Position:  [10.6329758]


portfolio before change:  [7.51767874]
curr_Stock_Price:  102.3259230102072
curr_Factors:  [102.32592301]
mat_Sqrt:  [[0.15]]
grads:  [-0.14075628]
Stock Position:  -0.14075627807239766
Bond Position:  [21.92069481]


portfolio before change:  [7.4521709]
curr_Stock_Price:  102.80105582272842
curr_Factors:  [102.80105582]
mat_Sqrt:  [[0.15]]
grads:  [0.13960908]
Stock Position:  0.13960908287454732
Bond Position:  [-6.89979023]


portfolio before change:  [7.43787192]
curr_Stock_Price:  102.70172328223055
curr_Factors:  [102.70172328]
mat_Sqrt:  [[0.15]]
grads:  [-0.00292777]
Stock Position:  -0.002927771058418184
Bond Position:  [7.73855905]


portfolio before change:  [7.43837454]
curr_Stock_Price:  102.69525294215222
curr_Factors:  [102.69525294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403887]
Stock Position:  -0.0040388692509754605
Bond Position:  [7.85314724]


portfolio before change:  [7.43848359]
curr_Stock_Price:  102.78978091884787
curr_Factors:  [102.78978092]
mat_Sqrt:  [[0.15]]
grads:  [-0.09047516]
Stock Position:  -0.09047516407937004
Bond Position:  [16.73840588]


portfolio before change:  [7.4576543]
curr_Stock_Price:  102.58945489728524
curr_Factors:  [102.5894549]
mat_Sqrt:  [[0.15]]
grads:  [0.0924365]
Stock Position:  0.09243649851965698
Bond Position:  [-2.02535569]


portfolio before change:  [7.50918875]
curr_Stock_Price:  103.14833624064595
curr_Factors:  [103.14833624]
mat_Sqrt:  [[0.15]]
grads:  [0.0356832]
Stock Position:  0.0356831990072124
Bond Position:  [3.82852614]


portfolio before change:  [7.52987923]
curr_Stock_Price:  103.72146852185651
curr_Factors:  [103.72146852]
mat_Sqrt:  [[0.15]]
grads:  [0.02791211]
Stock Position:  0.027912112162167508
Bond Position:  [4.63479397]


portfolio before change:  [7.54515838]
curr_Stock_Price:  104.2584920731664
curr_Factors:  [104.25849207]
mat_Sqrt:  [[0.15]]
grads:  [-0.04964803]
Stock Position:  -0.04964802967660264
Bond Position:  [12.72138709]


portfolio before change:  [7.56910082]
curr_Stock_Price:  103.79226339075552
curr_Factors:  [103.79226339]
mat_Sqrt:  [[0.15]]
grads:  [-0.14782535]
Stock Position:  -0.14782534591765312
Bond Position:  [22.91222806]


portfolio before change:  [7.61506347]
curr_Stock_Price:  103.49102556570715
curr_Factors:  [103.49102557]
mat_Sqrt:  [[0.15]]
grads:  [0.01797984]
Stock Position:  0.017979842524390235
Bond Position:  [5.75431113]


portfolio before change:  [7.6187296]
curr_Stock_Price:  103.67492457869415
curr_Factors:  [103.67492458]
mat_Sqrt:  [[0.15]]
grads:  [-0.05918891]
Stock Position:  -0.05918891044644023
Bond Position:  [13.75513543]


portfolio before change:  [7.5889342]
curr_Stock_Price:  104.19284464246105
curr_Factors:  [104.19284464]
mat_Sqrt:  [[0.15]]
grads:  [0.03925326]
Stock Position:  0.03925326376674208
Bond Position:  [3.49902499]


portfolio before change:  [7.61483766]
curr_Stock_Price:  104.84717909688334
curr_Factors:  [104.8471791]
mat_Sqrt:  [[0.15]]
grads:  [-0.08860023]
Stock Position:  -0.08860022872273411
Bond Position:  [16.90432171]


portfolio before change:  [7.62147075]
curr_Stock_Price:  104.78423866461681
curr_Factors:  [104.78423866]
mat_Sqrt:  [[0.15]]
grads:  [0.1167488]
Stock Position:  0.11674879939596412
Bond Position:  [-4.61196331]


portfolio before change:  [7.6751107]
curr_Stock_Price:  105.24615524814459
curr_Factors:  [105.24615525]
mat_Sqrt:  [[0.15]]
grads:  [0.08397507]
Stock Position:  0.0839750672668238
Bond Position:  [-1.16294227]


portfolio before change:  [7.65326443]
curr_Stock_Price:  104.98686893364663
curr_Factors:  [104.98686893]
mat_Sqrt:  [[0.15]]
grads:  [0.00606776]
Stock Position:  0.006067760916602636
Bond Position:  [7.01622921]


portfolio before change:  [7.65191437]
curr_Stock_Price:  104.6921002821177
curr_Factors:  [104.69210028]
mat_Sqrt:  [[0.15]]
grads:  [0.012128]
Stock Position:  0.012128001839114276
Bond Position:  [6.38220838]


portfolio before change:  [7.64658888]
curr_Stock_Price:  104.2201029167144
curr_Factors:  [104.22010292]
mat_Sqrt:  [[0.15]]
grads:  [0.08336797]
Stock Position:  0.0833679693524593
Bond Position:  [-1.04202946]


portfolio before change:  [7.74244873]
curr_Stock_Price:  105.3707244405405
curr_Factors:  [105.37072444]
mat_Sqrt:  [[0.15]]
grads:  [0.09015489]
Stock Position:  0.09015489408540119
Bond Position:  [-1.75723777]


portfolio before change:  [7.72599345]
curr_Stock_Price:  105.18942037323025
curr_Factors:  [105.18942037]
mat_Sqrt:  [[0.15]]
grads:  [0.2180733]
Stock Position:  0.21807330270685138
Bond Position:  [-15.21301086]


portfolio before change:  [7.54416105]
curr_Stock_Price:  104.35996734078127
curr_Factors:  [104.35996734]
mat_Sqrt:  [[0.15]]
grads:  [0.01906523]
Stock Position:  0.01906522910245921
Bond Position:  [5.55451436]


portfolio before change:  [7.54224578]
curr_Stock_Price:  104.24129896421289
curr_Factors:  [104.24129896]
mat_Sqrt:  [[0.15]]
grads:  [-0.08321296]
Stock Position:  -0.08321295757372653
Bond Position:  [16.21647257]


portfolio before change:  [7.53120391]
curr_Stock_Price:  104.38617342370418
curr_Factors:  [104.38617342]
mat_Sqrt:  [[0.15]]
grads:  [0.07250178]
Stock Position:  0.07250177928466972
Bond Position:  [-0.0369794]


portfolio before change:  [7.5511374]
curr_Stock_Price:  104.6611432805795
curr_Factors:  [104.66114328]
mat_Sqrt:  [[0.15]]
grads:  [0.03084928]
Stock Position:  0.030849281407667763
Bond Position:  [4.32241634]


portfolio before change:  [7.55867889]
curr_Stock_Price:  104.89684830920788
curr_Factors:  [104.89684831]
mat_Sqrt:  [[0.15]]
grads:  [-0.03505554]
Stock Position:  -0.035055536443088973
Bond Position:  [11.23589418]


portfolio before change:  [7.56080276]
curr_Stock_Price:  104.85629525139338
curr_Factors:  [104.85629525]
mat_Sqrt:  [[0.15]]
grads:  [0.10254272]
Stock Position:  0.10254272054443929
Bond Position:  [-3.19144702]


portfolio before change:  [7.58872406]
curr_Stock_Price:  105.13052987667025
curr_Factors:  [105.13052988]
mat_Sqrt:  [[0.15]]
grads:  [-0.06667342]
Stock Position:  -0.06667341646798117
Bond Position:  [14.59813566]


portfolio before change:  [7.61985176]
curr_Stock_Price:  104.67734641627013
curr_Factors:  [104.67734642]
mat_Sqrt:  [[0.15]]
grads:  [-0.05235584]
Stock Position:  -0.052355840377800215
Bond Position:  [13.1003222]


portfolio before change:  [7.61168423]
curr_Stock_Price:  104.84898577454335
curr_Factors:  [104.84898577]
mat_Sqrt:  [[0.15]]
grads:  [-0.08134105]
Stock Position:  -0.08134105399448568
Bond Position:  [16.14021124]


portfolio before change:  [7.64726027]
curr_Stock_Price:  104.42401897003307
curr_Factors:  [104.42401897]
mat_Sqrt:  [[0.15]]
grads:  [0.09085697]
Stock Position:  0.09085697010378345
Bond Position:  [-1.8403897]


portfolio before change:  [7.61738488]
curr_Stock_Price:  104.09646714840633
curr_Factors:  [104.09646715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01719545]
Stock Position:  -0.017195451699127125
Bond Position:  [9.40737065]


portfolio before change:  [7.60418997]
curr_Stock_Price:  104.89800973603373
curr_Factors:  [104.89800974]
mat_Sqrt:  [[0.15]]
grads:  [0.17216976]
Stock Position:  0.17216975915160887
Bond Position:  [-10.4560751]


portfolio before change:  [7.49078386]
curr_Stock_Price:  104.24311781094103
curr_Factors:  [104.24311781]
mat_Sqrt:  [[0.15]]
grads:  [-0.16332791]
Stock Position:  -0.16332791441299868
Bond Position:  [24.51659489]


portfolio before change:  [7.53226954]
curr_Stock_Price:  103.9984973755601
curr_Factors:  [103.99849738]
mat_Sqrt:  [[0.15]]
grads:  [0.00261196]
Stock Position:  0.00261195854661492
Bond Position:  [7.26062978]


portfolio before change:  [7.53052462]
curr_Stock_Price:  103.15670348258065
curr_Factors:  [103.15670348]
mat_Sqrt:  [[0.15]]
grads:  [-0.05392294]
Stock Position:  -0.05392294203640034
Bond Position:  [13.09303756]


portfolio before change:  [7.52833192]
curr_Stock_Price:  103.21254306654268
curr_Factors:  [103.21254307]
mat_Sqrt:  [[0.15]]
grads:  [-0.03538346]
Stock Position:  -0.03538345581940416
Bond Position:  [11.18034838]


portfolio before change:  [7.52865733]
curr_Stock_Price:  103.22309546453859
curr_Factors:  [103.22309546]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.52865733]
Stock Price:  103.65659490660833
PL:  [3.87206243]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.26930739e-04]
 [ 2.62491898e-03]
 [-1.38887031e-03]
 [ 8.37788774e-03]
 [ 4.85392566e-03]
 [ 1.93737107e-02]
 [ 1.01060565e-03]
 [-1.87655782e-02]
 [ 1.14072259e-02]
 [ 1.62309199e-02]
 [ 3.31675960e-03]
 [ 3.03279336e-02]
 [-1.32617669e-02]
 [ 3.19850863e-03]
 [-6.99956187e-03]
 [ 7.03032130e-03]
 [ 7.22056257e-03]
 [-1.17358426e-02]
 [-4.18635247e-04]
 [ 1.13220493e-02]
 [ 1.22095769e-02]
 [-8.48092819e-03]
 [ 7.99390768e-03]
 [ 1.72011721e-02]
 [-3.64971506e-03]
 [ 1.23432785e-02]
 [-7.01442475e-03]
 [ 6.12378060e-03]
 [-8.27471667e-03]
 [-5.44558735e-04]
 [-4.97628185e-03]
 [-1.01105475e-02]
 [-9.33761588e-03]
 [ 5.24531658e-03]
 [ 1.32347533e-02]
 [ 1.68859359e-02]
 [-3.49456434e-02]
 [ 9.11999811e-03]
 [-1.80409718e-02]
 [ 2.42605254e-02]
 [-4.94100514e-03]
 [ 3.51689386e-03]
 [ 2.30411826e-02]
 [ 4.42551119e-03]
 [-2.50978372e-03]
 [-5.34266279e-03]
 [ 4.84949443e-04]
 [-1.22295397e-02]
 [-9.12768099e-03]
 [-2.97645851e-03]
 [ 4.46037415e-02]
 [-1.03957114e-02]
 [ 3.39690749e-03]
 [ 5.14008742e-03]
 [ 4.23072521e-03]
 [-8.86285616e-04]
 [-2.37224813e-03]
 [-2.88243741e-04]
 [ 1.55186193e-03]
 [-3.04865230e-02]
 [-9.24912381e-03]
 [ 1.27668274e-02]
 [ 1.44585706e-02]
 [-1.88213266e-02]
 [-5.19468771e-03]
 [-1.66200261e-02]
 [-3.99507599e-03]
 [-3.85375469e-03]
 [-1.85243955e-02]
 [ 1.52280889e-02]
 [ 9.74338498e-03]
 [ 1.25886181e-02]
 [ 2.89935964e-03]
 [ 1.96932790e-03]
 [ 1.36729810e-02]
 [-2.00154153e-02]
 [ 4.95425583e-03]
 [ 7.15841981e-03]
 [-4.92938489e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.08626405]
curr_Stock_Price:  100.26300562525728
curr_Factors:  [100.26300563]
mat_Sqrt:  [[0.15]]
grads:  [0.0028462]
Stock Position:  0.0028462049247086722
Bond Position:  [5.80089499]


portfolio before change:  [6.08596414]
curr_Stock_Price:  100.03024724206884
curr_Factors:  [100.03024724]
mat_Sqrt:  [[0.15]]
grads:  [0.01749946]
Stock Position:  0.01749945985035718
Bond Position:  [4.33548884]


portfolio before change:  [6.07332906]
curr_Stock_Price:  99.29273532599032
curr_Factors:  [99.29273533]
mat_Sqrt:  [[0.15]]
grads:  [-0.00925914]
Stock Position:  -0.009259135400574808
Bond Position:  [6.99269394]


portfolio before change:  [6.07255088]
curr_Stock_Price:  99.42398205082768
curr_Factors:  [99.42398205]
mat_Sqrt:  [[0.15]]
grads:  [0.05585258]
Stock Position:  0.0558525849083355
Bond Position:  [0.51946448]


portfolio before change:  [6.08248265]
curr_Stock_Price:  99.60122189900135
curr_Factors:  [99.6012219]
mat_Sqrt:  [[0.15]]
grads:  [0.0323595]
Stock Position:  0.03235950438011222
Bond Position:  [2.85943648]


portfolio before change:  [6.07064265]
curr_Stock_Price:  99.22980956123804
curr_Factors:  [99.22980956]
mat_Sqrt:  [[0.15]]
grads:  [0.12915807]
Stock Position:  0.1291580710667198
Bond Position:  [-6.74568814]


portfolio before change:  [6.08211511]
curr_Stock_Price:  99.32189885457161
curr_Factors:  [99.32189885]
mat_Sqrt:  [[0.15]]
grads:  [0.00673737]
Stock Position:  0.006737370998321928
Bond Position:  [5.41294663]


portfolio before change:  [6.08527924]
curr_Stock_Price:  99.74132264032674
curr_Factors:  [99.74132264]
mat_Sqrt:  [[0.15]]
grads:  [-0.12510385]
Stock Position:  -0.12510385499498242
Bond Position:  [18.56330321]


portfolio before change:  [6.12241518]
curr_Stock_Price:  99.45375605274228
curr_Factors:  [99.45375605]
mat_Sqrt:  [[0.15]]
grads:  [0.07604817]
Stock Position:  0.07604817234818056
Bond Position:  [-1.44086121]


portfolio before change:  [6.11847534]
curr_Stock_Price:  99.4031331345175
curr_Factors:  [99.40313313]
mat_Sqrt:  [[0.15]]
grads:  [0.10820613]
Stock Position:  0.10820613266122367
Bond Position:  [-4.63755327]


portfolio before change:  [6.03946585]
curr_Stock_Price:  98.6756361563098
curr_Factors:  [98.67563616]
mat_Sqrt:  [[0.15]]
grads:  [0.02211173]
Stock Position:  0.022111730654491325
Bond Position:  [3.85757676]


portfolio before change:  [6.00941183]
curr_Stock_Price:  97.30554311807187
curr_Factors:  [97.30554312]
mat_Sqrt:  [[0.15]]
grads:  [0.20218622]
Stock Position:  0.2021862242890489
Bond Position:  [-13.66442854]


portfolio before change:  [6.1147477]
curr_Stock_Price:  97.83075165446596
curr_Factors:  [97.83075165]
mat_Sqrt:  [[0.15]]
grads:  [-0.08841178]
Stock Position:  -0.08841177925119885
Bond Position:  [14.76413852]


portfolio before change:  [6.13246027]
curr_Stock_Price:  97.64084729157648
curr_Factors:  [97.64084729]
mat_Sqrt:  [[0.15]]
grads:  [0.02132339]
Stock Position:  0.021323390837592687
Bond Position:  [4.05042632]


portfolio before change:  [6.14076836]
curr_Stock_Price:  98.01859790471065
curr_Factors:  [98.0185979]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666375]
Stock Position:  -0.04666374579544521
Bond Position:  [10.71468329]


portfolio before change:  [6.09423409]
curr_Stock_Price:  99.03017447563116
curr_Factors:  [99.03017448]
mat_Sqrt:  [[0.15]]
grads:  [0.04686881]
Stock Position:  0.04686880865114019
Bond Position:  [1.45280779]


portfolio before change:  [6.09448491]
curr_Stock_Price:  99.03358853845364
curr_Factors:  [99.03358854]
mat_Sqrt:  [[0.15]]
grads:  [0.04813708]
Stock Position:  0.04813708380726379
Bond Position:  [1.32729676]


portfolio before change:  [6.11084273]
curr_Stock_Price:  99.37168254484814
curr_Factors:  [99.37168254]
mat_Sqrt:  [[0.15]]
grads:  [-0.07823895]
Stock Position:  -0.07823895047040916
Bond Position:  [13.88557888]


portfolio before change:  [6.12372074]
curr_Stock_Price:  99.21817671831799
curr_Factors:  [99.21817672]
mat_Sqrt:  [[0.15]]
grads:  [-0.0027909]
Stock Position:  -0.0027909016475275404
Bond Position:  [6.40062891]


portfolio before change:  [6.12568613]
curr_Stock_Price:  98.65730401696892
curr_Factors:  [98.65730402]
mat_Sqrt:  [[0.15]]
grads:  [0.07548033]
Stock Position:  0.0754803289783593
Bond Position:  [-1.32099963]


portfolio before change:  [6.09410518]
curr_Stock_Price:  98.23999813895733
curr_Factors:  [98.23999814]
mat_Sqrt:  [[0.15]]
grads:  [0.08139718]
Stock Position:  0.08139717924853987
Bond Position:  [-1.90235356]


portfolio before change:  [6.14860916]
curr_Stock_Price:  98.91106416600026
curr_Factors:  [98.91106417]
mat_Sqrt:  [[0.15]]
grads:  [-0.05653952]
Stock Position:  -0.056539521248156054
Bond Position:  [11.74099338]


portfolio before change:  [6.13472465]
curr_Stock_Price:  99.16961511931963
curr_Factors:  [99.16961512]
mat_Sqrt:  [[0.15]]
grads:  [0.05329272]
Stock Position:  0.05329271786195348
Bond Position:  [0.84970633]


portfolio before change:  [6.11976345]
curr_Stock_Price:  98.88788229861507
curr_Factors:  [98.8878823]
mat_Sqrt:  [[0.15]]
grads:  [0.11467448]
Stock Position:  0.11467448079822386
Bond Position:  [-5.22015311]


portfolio before change:  [6.23138974]
curr_Stock_Price:  99.86414622787538
curr_Factors:  [99.86414623]
mat_Sqrt:  [[0.15]]
grads:  [-0.02433143]
Stock Position:  -0.024331433708913802
Bond Position:  [8.66122759]


portfolio before change:  [6.22680639]
curr_Stock_Price:  100.07476658703202
curr_Factors:  [100.07476659]
mat_Sqrt:  [[0.15]]
grads:  [0.08228852]
Stock Position:  0.08228852364301259
Bond Position:  [-2.00819841]


portfolio before change:  [6.18217618]
curr_Stock_Price:  99.53392938952818
curr_Factors:  [99.53392939]
mat_Sqrt:  [[0.15]]
grads:  [-0.04676283]
Stock Position:  -0.046762831692251504
Bond Position:  [10.83666456]


portfolio before change:  [6.19270198]
curr_Stock_Price:  99.32332427805592
curr_Factors:  [99.32332428]
mat_Sqrt:  [[0.15]]
grads:  [0.0408252]
Stock Position:  0.04082520396809716
Bond Position:  [2.13780701]


portfolio before change:  [6.2056549]
curr_Stock_Price:  99.63732898354563
curr_Factors:  [99.63732898]
mat_Sqrt:  [[0.15]]
grads:  [-0.05516478]
Stock Position:  -0.05516477783173469
Bond Position:  [11.70212602]


portfolio before change:  [6.26379445]
curr_Stock_Price:  98.5966624303299
curr_Factors:  [98.59666243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363039]
Stock Position:  -0.0036303915647698448
Bond Position:  [6.62173894]


portfolio before change:  [6.26358091]
curr_Stock_Price:  98.7694839199227
curr_Factors:  [98.76948392]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317521]
Stock Position:  -0.03317521236237544
Bond Position:  [9.54027951]


portfolio before change:  [6.29959615]
curr_Stock_Price:  97.70185073418858
curr_Factors:  [97.70185073]
mat_Sqrt:  [[0.15]]
grads:  [-0.06740365]
Stock Position:  -0.06740364972014731
Bond Position:  [12.88505748]


portfolio before change:  [6.29195694]
curr_Stock_Price:  97.82713403214092
curr_Factors:  [97.82713403]
mat_Sqrt:  [[0.15]]
grads:  [-0.06225077]
Stock Position:  -0.06225077254819543
Bond Position:  [12.38177161]


portfolio before change:  [6.28919046]
curr_Stock_Price:  97.88400677584053
curr_Factors:  [97.88400678]
mat_Sqrt:  [[0.15]]
grads:  [0.03496878]
Stock Position:  0.03496877718679198
Bond Position:  [2.86630643]


portfolio before change:  [6.28611637]
curr_Stock_Price:  97.79097404880984
curr_Factors:  [97.79097405]
mat_Sqrt:  [[0.15]]
grads:  [0.08823169]
Stock Position:  0.08823168842176703
Bond Position:  [-2.34214639]


portfolio before change:  [6.35328434]
curr_Stock_Price:  98.55390134597846
curr_Factors:  [98.55390135]
mat_Sqrt:  [[0.15]]
grads:  [0.11257291]
Stock Position:  0.11257290602269646
Bond Position:  [-4.74121473]


portfolio before change:  [6.38724948]
curr_Stock_Price:  98.85825058278256
curr_Factors:  [98.85825058]
mat_Sqrt:  [[0.15]]
grads:  [-0.23297096]
Stock Position:  -0.23297095599812578
Bond Position:  [29.41835063]


portfolio before change:  [6.42847334]
curr_Stock_Price:  98.68919451295704
curr_Factors:  [98.68919451]
mat_Sqrt:  [[0.15]]
grads:  [0.06079999]
Stock Position:  0.06079998739409812
Bond Position:  [0.42817156]


portfolio before change:  [6.41167632]
curr_Stock_Price:  98.4124875097261
curr_Factors:  [98.41248751]
mat_Sqrt:  [[0.15]]
grads:  [-0.12027315]
Stock Position:  -0.12027314541328375
Bond Position:  [18.24805574]


portfolio before change:  [6.37059003]
curr_Stock_Price:  98.76357857097004
curr_Factors:  [98.76357857]
mat_Sqrt:  [[0.15]]
grads:  [0.16173684]
Stock Position:  0.16173683604106479
Bond Position:  [-9.60311868]


portfolio before change:  [6.39822566]
curr_Stock_Price:  98.93815747199127
curr_Factors:  [98.93815747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03294003]
Stock Position:  -0.0329400342397576
Bond Position:  [9.65725195]


portfolio before change:  [6.40524946]
curr_Stock_Price:  98.74325178093122
curr_Factors:  [98.74325178]
mat_Sqrt:  [[0.15]]
grads:  [0.02344596]
Stock Position:  0.023445959081169664
Bond Position:  [4.09011922]


portfolio before change:  [6.40187753]
curr_Stock_Price:  98.58853150293345
curr_Factors:  [98.5885315]
mat_Sqrt:  [[0.15]]
grads:  [0.15360788]
Stock Position:  0.15360788419303556
Bond Position:  [-8.7420982]


portfolio before change:  [6.29496673]
curr_Stock_Price:  97.89609046764933
curr_Factors:  [97.89609047]
mat_Sqrt:  [[0.15]]
grads:  [0.02950341]
Stock Position:  0.029503407914917568
Bond Position:  [3.40669844]


portfolio before change:  [6.30073237]
curr_Stock_Price:  98.08429614088602
curr_Factors:  [98.08429614]
mat_Sqrt:  [[0.15]]
grads:  [-0.01673189]
Stock Position:  -0.016731891493189738
Bond Position:  [7.94186817]


portfolio before change:  [6.29358427]
curr_Stock_Price:  98.54117690735478
curr_Factors:  [98.54117691]
mat_Sqrt:  [[0.15]]
grads:  [-0.03561775]
Stock Position:  -0.03561775191132938
Bond Position:  [9.80339946]


portfolio before change:  [6.29017807]
curr_Stock_Price:  98.65401206303657
curr_Factors:  [98.65401206]
mat_Sqrt:  [[0.15]]
grads:  [0.003233]
Stock Position:  0.0032329962873207017
Bond Position:  [5.97123001]


portfolio before change:  [6.2885365]
curr_Stock_Price:  98.03082093389968
curr_Factors:  [98.03082093]
mat_Sqrt:  [[0.15]]
grads:  [-0.08153026]
Stock Position:  -0.08153026473216653
Bond Position:  [14.28101529]


portfolio before change:  [6.24457265]
curr_Stock_Price:  98.58100247678563
curr_Factors:  [98.58100248]
mat_Sqrt:  [[0.15]]
grads:  [-0.06085121]
Stock Position:  -0.06085120659466564
Bond Position:  [12.2433456]


portfolio before change:  [6.2744919]
curr_Stock_Price:  98.10189907780513
curr_Factors:  [98.10189908]
mat_Sqrt:  [[0.15]]
grads:  [-0.01984306]
Stock Position:  -0.019843056708294105
Bond Position:  [8.22113345]


portfolio before change:  [6.28033339]
curr_Stock_Price:  97.83340945880828
curr_Factors:  [97.83340946]
mat_Sqrt:  [[0.15]]
grads:  [0.29735828]
Stock Position:  0.29735827680946986
Bond Position:  [-22.81124066]


portfolio before change:  [6.50831765]
curr_Stock_Price:  98.6049030405849
curr_Factors:  [98.60490304]
mat_Sqrt:  [[0.15]]
grads:  [-0.06930474]
Stock Position:  -0.06930474284392713
Bond Position:  [13.3421051]


portfolio before change:  [6.52135698]
curr_Stock_Price:  98.4287906874607
curr_Factors:  [98.42879069]
mat_Sqrt:  [[0.15]]
grads:  [0.02264605]
Stock Position:  0.022646049935842634
Bond Position:  [4.29233367]


portfolio before change:  [6.50491709]
curr_Stock_Price:  97.69099469420648
curr_Factors:  [97.69099469]
mat_Sqrt:  [[0.15]]
grads:  [0.03426725]
Stock Position:  0.03426724945728275
Bond Position:  [3.15731541]


portfolio before change:  [6.47198712]
curr_Stock_Price:  96.72426081103178
curr_Factors:  [96.72426081]
mat_Sqrt:  [[0.15]]
grads:  [0.02820483]
Stock Position:  0.028204834743320268
Bond Position:  [3.74389533]


portfolio before change:  [6.48177667]
curr_Stock_Price:  97.0630519978437
curr_Factors:  [97.063052]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590857]
Stock Position:  -0.005908570773887184
Bond Position:  [7.05528058]


portfolio before change:  [6.48473109]
curr_Stock_Price:  96.63766121304226
curr_Factors:  [96.63766121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01581499]
Stock Position:  -0.01581498752783837
Bond Position:  [8.0130545]


portfolio before change:  [6.49741259]
curr_Stock_Price:  95.86746351660278
curr_Factors:  [95.86746352]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192162]
Stock Position:  -0.0019216249429396476
Bond Position:  [6.6816339]


portfolio before change:  [6.49671742]
curr_Stock_Price:  96.4465494023759
curr_Factors:  [96.4465494]
mat_Sqrt:  [[0.15]]
grads:  [0.01034575]
Stock Position:  0.010345746190686624
Bond Position:  [5.4989059]


portfolio before change:  [6.49388575]
curr_Stock_Price:  96.13962477550305
curr_Factors:  [96.13962478]
mat_Sqrt:  [[0.15]]
grads:  [-0.20324349]
Stock Position:  -0.2032434869642713
Bond Position:  [26.03363832]


portfolio before change:  [6.55209047]
curr_Stock_Price:  95.86125141176103
curr_Factors:  [95.86125141]
mat_Sqrt:  [[0.15]]
grads:  [-0.06166083]
Stock Position:  -0.06166082539084454
Bond Position:  [12.46297436]


portfolio before change:  [6.52624839]
curr_Stock_Price:  96.29298483507375
curr_Factors:  [96.29298484]
mat_Sqrt:  [[0.15]]
grads:  [0.08511218]
Stock Position:  0.08511218287829268
Bond Position:  [-1.66945774]


portfolio before change:  [6.54054582]
curr_Stock_Price:  96.46219412115256
curr_Factors:  [96.46219412]
mat_Sqrt:  [[0.15]]
grads:  [0.09639047]
Stock Position:  0.09639047069727955
Bond Position:  [-2.75749048]


portfolio before change:  [6.51916497]
curr_Stock_Price:  96.24216717484433
curr_Factors:  [96.24216717]
mat_Sqrt:  [[0.15]]
grads:  [-0.12547551]
Stock Position:  -0.1254755108453748
Bond Position:  [18.59520006]


portfolio before change:  [6.52572606]
curr_Stock_Price:  96.19914001471825
curr_Factors:  [96.19914001]
mat_Sqrt:  [[0.15]]
grads:  [-0.03463125]
Stock Position:  -0.03463125137294444
Bond Position:  [9.85722266]


portfolio before change:  [6.54219364]
curr_Stock_Price:  95.74141799278857
curr_Factors:  [95.74141799]
mat_Sqrt:  [[0.15]]
grads:  [-0.11080017]
Stock Position:  -0.1108001740372182
Bond Position:  [17.15035942]


portfolio before change:  [6.71374181]
curr_Stock_Price:  94.2028262563025
curr_Factors:  [94.20282626]
mat_Sqrt:  [[0.15]]
grads:  [-0.02663384]
Stock Position:  -0.02663383993647802
Bond Position:  [9.2227248]


portfolio before change:  [6.7247026]
curr_Stock_Price:  93.81293284893967
curr_Factors:  [93.81293285]
mat_Sqrt:  [[0.15]]
grads:  [-0.0256917]
Stock Position:  -0.02569169794849451
Bond Position:  [9.13491614]


portfolio before change:  [6.72069155]
curr_Stock_Price:  93.99127875416465
curr_Factors:  [93.99127875]
mat_Sqrt:  [[0.15]]
grads:  [-0.12349597]
Stock Position:  -0.12349597022552324
Bond Position:  [18.32823571]


portfolio before change:  [6.77272866]
curr_Stock_Price:  93.57918787848686
curr_Factors:  [93.57918788]
mat_Sqrt:  [[0.15]]
grads:  [0.10152059]
Stock Position:  0.10152059272039461
Bond Position:  [-2.72748596]


portfolio before change:  [6.79290672]
curr_Stock_Price:  93.77962538859504
curr_Factors:  [93.77962539]
mat_Sqrt:  [[0.15]]
grads:  [0.0649559]
Stock Position:  0.06495589984121686
Bond Position:  [0.70136677]


portfolio before change:  [6.80376371]
curr_Stock_Price:  93.94609460145362
curr_Factors:  [93.9460946]
mat_Sqrt:  [[0.15]]
grads:  [0.08392412]
Stock Position:  0.0839241204028708
Bond Position:  [-1.08057964]


portfolio before change:  [6.75997868]
curr_Stock_Price:  93.42517762043907
curr_Factors:  [93.42517762]
mat_Sqrt:  [[0.15]]
grads:  [0.01932906]
Stock Position:  0.019329064241713288
Bond Position:  [4.95415742]


portfolio before change:  [6.77656747]
curr_Stock_Price:  94.26738843067056
curr_Factors:  [94.26738843]
mat_Sqrt:  [[0.15]]
grads:  [0.01312885]
Stock Position:  0.013128852671635388
Bond Position:  [5.53894481]


portfolio before change:  [6.77321134]
curr_Stock_Price:  93.98538973266558
curr_Factors:  [93.98538973]
mat_Sqrt:  [[0.15]]
grads:  [0.09115321]
Stock Position:  0.09115320652067298
Bond Position:  [-1.7938583]


portfolio before change:  [6.7863978]
curr_Stock_Price:  94.1312822888176
curr_Factors:  [94.13128229]
mat_Sqrt:  [[0.15]]
grads:  [-0.1334361]
Stock Position:  -0.13343610188456106
Bond Position:  [19.34690917]


portfolio before change:  [6.75393242]
curr_Stock_Price:  94.38364722819719
curr_Factors:  [94.38364723]
mat_Sqrt:  [[0.15]]
grads:  [0.03302837]
Stock Position:  0.03302837216736188
Bond Position:  [3.6365942]


portfolio before change:  [6.76440354]
curr_Stock_Price:  94.69379930213714
curr_Factors:  [94.6937993]
mat_Sqrt:  [[0.15]]
grads:  [0.0477228]
Stock Position:  0.047722798746202895
Bond Position:  [2.24535041]


portfolio before change:  [6.76883631]
curr_Stock_Price:  94.78374451505798
curr_Factors:  [94.78374452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.76883631]
Stock Price:  94.71187824270754
PL:  [6.76883631]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.04776943e-04]
 [ 3.10763654e-03]
 [-4.58761176e-03]
 [-3.57707031e-04]
 [ 4.53677507e-02]
 [ 2.62942039e-02]
 [ 5.32937392e-03]
 [ 2.38200594e-02]
 [ 2.42258740e-02]
 [-2.45333970e-03]
 [ 5.57302731e-02]
 [ 2.26947908e-02]
 [ 1.22197966e-01]
 [ 1.87673004e-02]
 [-6.89212155e-03]
 [ 3.32623681e-02]
 [ 1.61420978e-02]
 [-1.66157658e-03]
 [ 1.17965372e-02]
 [-7.88955081e-03]
 [ 1.45304096e-02]
 [-9.87642713e-03]
 [ 1.10266014e-02]
 [-1.29092825e-02]
 [ 4.49103008e-03]
 [ 8.44478812e-03]
 [-5.44799107e-03]
 [ 1.09767283e-02]
 [ 3.94830062e-02]
 [-1.93740450e-03]
 [ 1.10845147e-02]
 [-1.19751268e-02]
 [ 5.46120566e-03]
 [ 8.44691891e-03]
 [ 1.05724111e-02]
 [ 8.60408037e-03]
 [-3.38504008e-02]
 [ 9.58724337e-03]
 [-2.07473476e-03]
 [ 2.35168270e-02]
 [-5.72427276e-03]
 [-3.22819658e-03]
 [ 2.30170971e-02]
 [ 4.54787504e-03]
 [-7.75790488e-03]
 [-4.57256567e-03]
 [ 4.68852538e-03]
 [-1.03590552e-02]
 [-9.14540128e-03]
 [-7.61714130e-03]
 [ 3.59908307e-02]
 [-8.25610670e-03]
 [ 3.20336912e-03]
 [ 5.43858780e-03]
 [ 5.72958953e-03]
 [-2.84390399e-03]
 [ 6.70863018e-03]
 [-6.65701954e-05]
 [ 1.55634725e-03]
 [-2.00261920e-03]
 [ 9.00849938e-04]
 [-1.18449775e-02]
 [-6.35798536e-03]
 [-1.30029398e-02]
 [-3.02710204e-03]
 [-1.45301685e-04]
 [-5.52717895e-03]
 [ 1.88513887e-02]
 [-8.21435408e-03]
 [ 9.18735109e-03]
 [-1.04437991e-02]
 [ 1.06669754e-02]
 [-6.32737170e-03]
 [ 1.03111684e-02]
 [-2.08207604e-02]
 [-4.35174352e-03]
 [-2.77851425e-03]
 [-9.37118804e-04]
 [-6.39289755e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.95562659]
curr_Stock_Price:  100.18948597102148
curr_Factors:  [100.18948597]
mat_Sqrt:  [[0.15]]
grads:  [0.00469851]
Stock Position:  0.00469851295301517
Bond Position:  [4.48488499]


portfolio before change:  [4.95609082]
curr_Stock_Price:  100.22862892900544
curr_Factors:  [100.22862893]
mat_Sqrt:  [[0.15]]
grads:  [0.02071758]
Stock Position:  0.020717576932614598
Bond Position:  [2.87959649]


portfolio before change:  [4.97444133]
curr_Stock_Price:  101.10568750899542
curr_Factors:  [101.10568751]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058408]
Stock Position:  -0.030584078393072617
Bond Position:  [8.0666656]


portfolio before change:  [4.94959805]
curr_Stock_Price:  101.93446709568454
curr_Factors:  [101.9344671]
mat_Sqrt:  [[0.15]]
grads:  [-0.00238471]
Stock Position:  -0.002384713537885106
Bond Position:  [5.19268255]


portfolio before change:  [4.94781987]
curr_Stock_Price:  102.81622060644679
curr_Factors:  [102.81622061]
mat_Sqrt:  [[0.15]]
grads:  [0.30245167]
Stock Position:  0.30245167103854564
Bond Position:  [-26.14911786]


portfolio before change:  [5.0068549]
curr_Stock_Price:  103.01681264830744
curr_Factors:  [103.01681265]
mat_Sqrt:  [[0.15]]
grads:  [0.17529469]
Stock Position:  0.17529469272910123
Bond Position:  [-13.05144562]


portfolio before change:  [5.04944975]
curr_Stock_Price:  103.26445615417319
curr_Factors:  [103.26445615]
mat_Sqrt:  [[0.15]]
grads:  [0.03552916]
Stock Position:  0.035529159437356655
Bond Position:  [1.38055043]


portfolio before change:  [5.06865721]
curr_Stock_Price:  103.80263868745728
curr_Factors:  [103.80263869]
mat_Sqrt:  [[0.15]]
grads:  [0.1588004]
Stock Position:  0.15880039579741492
Bond Position:  [-11.4152429]


portfolio before change:  [5.09489307]
curr_Stock_Price:  103.97234437575628
curr_Factors:  [103.97234438]
mat_Sqrt:  [[0.15]]
grads:  [0.16150583]
Stock Position:  0.16150582682553338
Bond Position:  [-11.69724638]


portfolio before change:  [4.98085604]
curr_Stock_Price:  103.27078496649462
curr_Factors:  [103.27078497]
mat_Sqrt:  [[0.15]]
grads:  [-0.0163556]
Stock Position:  -0.016355597994154675
Bond Position:  [6.66991148]


portfolio before change:  [4.97701689]
curr_Stock_Price:  103.53100357906453
curr_Factors:  [103.53100358]
mat_Sqrt:  [[0.15]]
grads:  [0.37153515]
Stock Position:  0.3715351542076453
Bond Position:  [-33.48839049]


portfolio before change:  [4.71167813]
curr_Stock_Price:  102.82246856856162
curr_Factors:  [102.82246857]
mat_Sqrt:  [[0.15]]
grads:  [0.15129861]
Stock Position:  0.1512986053490711
Bond Position:  [-10.84521796]


portfolio before change:  [4.8116322]
curr_Stock_Price:  103.48758976769784
curr_Factors:  [103.48758977]
mat_Sqrt:  [[0.15]]
grads:  [0.81465311]
Stock Position:  0.8146531056108706
Bond Position:  [-79.4948542]


portfolio before change:  [5.02993649]
curr_Stock_Price:  103.76166087509628
curr_Factors:  [103.76166088]
mat_Sqrt:  [[0.15]]
grads:  [0.12511534]
Stock Position:  0.1251153361532193
Bond Position:  [-7.95223859]


portfolio before change:  [5.09019578]
curr_Stock_Price:  104.24726340530427
curr_Factors:  [104.24726341]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594748]
Stock Position:  -0.045947477031996746
Bond Position:  [9.88009452]


portfolio before change:  [5.10333902]
curr_Stock_Price:  103.97465397079785
curr_Factors:  [103.97465397]
mat_Sqrt:  [[0.15]]
grads:  [0.22174912]
Stock Position:  0.221749120834631
Bond Position:  [-17.95294908]


portfolio before change:  [5.24786605]
curr_Stock_Price:  104.63147335417598
curr_Factors:  [104.63147335]
mat_Sqrt:  [[0.15]]
grads:  [0.10761399]
Stock Position:  0.10761398521040177
Bond Position:  [-6.01194378]


portfolio before change:  [5.14586557]
curr_Stock_Price:  103.68712837528764
curr_Factors:  [103.68712838]
mat_Sqrt:  [[0.15]]
grads:  [-0.01107718]
Stock Position:  -0.011077177222568249
Bond Position:  [6.29442626]


portfolio before change:  [5.14413532]
curr_Stock_Price:  103.87884299576417
curr_Factors:  [103.878843]
mat_Sqrt:  [[0.15]]
grads:  [0.07864358]
Stock Position:  0.07864358113281611
Bond Position:  [-3.02526889]


portfolio before change:  [5.12113409]
curr_Stock_Price:  103.58877294964911
curr_Factors:  [103.58877295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05259701]
Stock Position:  -0.05259700537832618
Bond Position:  [10.56959334]


portfolio before change:  [5.13274221]
curr_Stock_Price:  103.38063375821302
curr_Factors:  [103.38063376]
mat_Sqrt:  [[0.15]]
grads:  [0.0968694]
Stock Position:  0.09686939735772167
Bond Position:  [-4.88167748]


portfolio before change:  [5.1107114]
curr_Stock_Price:  103.1563555374241
curr_Factors:  [103.15635554]
mat_Sqrt:  [[0.15]]
grads:  [-0.06584285]
Stock Position:  -0.06584284751374281
Bond Position:  [11.90281959]


portfolio before change:  [5.10233834]
curr_Stock_Price:  103.29482168808615
curr_Factors:  [103.29482169]
mat_Sqrt:  [[0.15]]
grads:  [0.07351068]
Stock Position:  0.07351067624753016
Bond Position:  [-2.49093385]


portfolio before change:  [5.04371891]
curr_Stock_Price:  102.49951215884298
curr_Factors:  [102.49951216]
mat_Sqrt:  [[0.15]]
grads:  [-0.08606188]
Stock Position:  -0.08606188355189587
Bond Position:  [13.86501999]


portfolio before change:  [5.03243076]
curr_Stock_Price:  102.64074472199833
curr_Factors:  [102.64074472]
mat_Sqrt:  [[0.15]]
grads:  [0.0299402]
Stock Position:  0.02994020052452334
Bond Position:  [1.95934628]


portfolio before change:  [5.02748548]
curr_Stock_Price:  102.47148246133241
curr_Factors:  [102.47148246]
mat_Sqrt:  [[0.15]]
grads:  [0.05629859]
Stock Position:  0.05629858747571714
Bond Position:  [-0.74151424]


portfolio before change:  [4.98755963]
curr_Stock_Price:  101.76312528184437
curr_Factors:  [101.76312528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03631994]
Stock Position:  -0.03631994043386099
Bond Position:  [8.68359027]


portfolio before change:  [4.9584389]
curr_Stock_Price:  102.57985198835436
curr_Factors:  [102.57985199]
mat_Sqrt:  [[0.15]]
grads:  [0.07317819]
Stock Position:  0.07317818884536527
Bond Position:  [-2.54816888]


portfolio before change:  [4.96896344]
curr_Stock_Price:  102.72584910546055
curr_Factors:  [102.72584911]
mat_Sqrt:  [[0.15]]
grads:  [0.26322004]
Stock Position:  0.26322004107989005
Bond Position:  [-22.07053878]


portfolio before change:  [4.6338736]
curr_Stock_Price:  101.45804903342996
curr_Factors:  [101.45804903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291603]
Stock Position:  -0.012916030018674914
Bond Position:  [5.94430881]


portfolio before change:  [4.63234052]
curr_Stock_Price:  101.60551015530532
curr_Factors:  [101.60551016]
mat_Sqrt:  [[0.15]]
grads:  [0.07389676]
Stock Position:  0.07389676479502656
Bond Position:  [-2.87597797]


portfolio before change:  [4.64711537]
curr_Stock_Price:  101.80788176995614
curr_Factors:  [101.80788177]
mat_Sqrt:  [[0.15]]
grads:  [-0.07983418]
Stock Position:  -0.07983417852557283
Bond Position:  [12.77486398]


portfolio before change:  [4.6077872]
curr_Stock_Price:  102.31050649581667
curr_Factors:  [102.3105065]
mat_Sqrt:  [[0.15]]
grads:  [0.03640804]
Stock Position:  0.03640803774402795
Bond Position:  [0.88286241]


portfolio before change:  [4.61047584]
curr_Stock_Price:  102.38283836913125
curr_Factors:  [102.38283837]
mat_Sqrt:  [[0.15]]
grads:  [0.05631279]
Stock Position:  0.05631279276371621
Bond Position:  [-1.15498772]


portfolio before change:  [4.64481256]
curr_Stock_Price:  102.99387030792987
curr_Factors:  [102.99387031]
mat_Sqrt:  [[0.15]]
grads:  [0.07048274]
Stock Position:  0.07048274043790118
Bond Position:  [-2.61447766]


portfolio before change:  [4.54045181]
curr_Stock_Price:  101.51553184213076
curr_Factors:  [101.51553184]
mat_Sqrt:  [[0.15]]
grads:  [0.05736054]
Stock Position:  0.05736053581200868
Bond Position:  [-1.28253349]


portfolio before change:  [4.53682777]
curr_Stock_Price:  101.45374939954992
curr_Factors:  [101.4537494]
mat_Sqrt:  [[0.15]]
grads:  [-0.22566934]
Stock Position:  -0.225669338407119
Bond Position:  [27.43182828]


portfolio before change:  [4.49552319]
curr_Stock_Price:  101.64437844156035
curr_Factors:  [101.64437844]
mat_Sqrt:  [[0.15]]
grads:  [0.06391496]
Stock Position:  0.06391495581874108
Bond Position:  [-2.00107277]


portfolio before change:  [4.43640431]
curr_Stock_Price:  100.72137378922754
curr_Factors:  [100.72137379]
mat_Sqrt:  [[0.15]]
grads:  [-0.01383157]
Stock Position:  -0.013831565074826
Bond Position:  [5.82953855]


portfolio before change:  [4.44368387]
curr_Stock_Price:  100.22141594642987
curr_Factors:  [100.22141595]
mat_Sqrt:  [[0.15]]
grads:  [0.15677885]
Stock Position:  0.1567788467316303
Bond Position:  [-11.26891414]


portfolio before change:  [4.32773615]
curr_Stock_Price:  99.48634617373746
curr_Factors:  [99.48634617]
mat_Sqrt:  [[0.15]]
grads:  [-0.03816182]
Stock Position:  -0.038161818370115404
Bond Position:  [8.12431602]


portfolio before change:  [4.33198839]
curr_Stock_Price:  99.38822576187934
curr_Factors:  [99.38822576]
mat_Sqrt:  [[0.15]]
grads:  [-0.02152131]
Stock Position:  -0.021521310542152613
Bond Position:  [6.47095326]


portfolio before change:  [4.34210067]
curr_Stock_Price:  98.93714559783523
curr_Factors:  [98.9371456]
mat_Sqrt:  [[0.15]]
grads:  [0.15344731]
Stock Position:  0.15344731421050525
Bond Position:  [-10.8395386]


portfolio before change:  [4.31220538]
curr_Stock_Price:  98.74673628775153
curr_Factors:  [98.74673629]
mat_Sqrt:  [[0.15]]
grads:  [0.03031917]
Stock Position:  0.030319166940876177
Bond Position:  [1.3182866]


portfolio before change:  [4.32266277]
curr_Stock_Price:  99.08892895159534
curr_Factors:  [99.08892895]
mat_Sqrt:  [[0.15]]
grads:  [-0.05171937]
Stock Position:  -0.051719365899318706
Bond Position:  [9.44747935]


portfolio before change:  [4.29708473]
curr_Stock_Price:  99.59490046844613
curr_Factors:  [99.59490047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03048377]
Stock Position:  -0.030483771132832408
Bond Position:  [7.33311289]


portfolio before change:  [4.29100741]
curr_Stock_Price:  99.80929831170187
curr_Factors:  [99.80929831]
mat_Sqrt:  [[0.15]]
grads:  [0.03125684]
Stock Position:  0.0312568358513712
Bond Position:  [1.17128456]


portfolio before change:  [4.31123209]
curr_Stock_Price:  100.45400427153824
curr_Factors:  [100.45400427]
mat_Sqrt:  [[0.15]]
grads:  [-0.06906037]
Stock Position:  -0.06906036784616305
Bond Position:  [11.24862258]


portfolio before change:  [4.25992727]
curr_Stock_Price:  101.20708281806372
curr_Factors:  [101.20708282]
mat_Sqrt:  [[0.15]]
grads:  [-0.06096934]
Stock Position:  -0.060969341885832445
Bond Position:  [10.4304565]


portfolio before change:  [4.25415782]
curr_Stock_Price:  101.31240413876726
curr_Factors:  [101.31240414]
mat_Sqrt:  [[0.15]]
grads:  [-0.05078094]
Stock Position:  -0.05078094197064061
Bond Position:  [9.39889714]


portfolio before change:  [4.29467616]
curr_Stock_Price:  100.52606807690104
curr_Factors:  [100.52606808]
mat_Sqrt:  [[0.15]]
grads:  [0.23993887]
Stock Position:  0.23993887142300585
Bond Position:  [-19.82543517]


portfolio before change:  [4.28156891]
curr_Stock_Price:  100.47660496866543
curr_Factors:  [100.47660497]
mat_Sqrt:  [[0.15]]
grads:  [-0.05504071]
Stock Position:  -0.05504071132904698
Bond Position:  [9.81187272]


portfolio before change:  [4.34320433]
curr_Stock_Price:  99.36793174829822
curr_Factors:  [99.36793175]
mat_Sqrt:  [[0.15]]
grads:  [0.02135579]
Stock Position:  0.021355794127710475
Bond Position:  [2.22112324]


portfolio before change:  [4.34419991]
curr_Stock_Price:  99.4080498367683
curr_Factors:  [99.40804984]
mat_Sqrt:  [[0.15]]
grads:  [0.03625725]
Stock Position:  0.03625725199031064
Bond Position:  [0.7399372]


portfolio before change:  [4.34504039]
curr_Stock_Price:  99.4299554524812
curr_Factors:  [99.42995545]
mat_Sqrt:  [[0.15]]
grads:  [0.03819726]
Stock Position:  0.03819726353988374
Bond Position:  [0.54708818]


portfolio before change:  [4.36619017]
curr_Stock_Price:  99.98275889386174
curr_Factors:  [99.98275889]
mat_Sqrt:  [[0.15]]
grads:  [-0.01895936]
Stock Position:  -0.018959359902044247
Bond Position:  [6.26179928]


portfolio before change:  [4.3776508]
curr_Stock_Price:  99.39891756265288
curr_Factors:  [99.39891756]
mat_Sqrt:  [[0.15]]
grads:  [0.0447242]
Stock Position:  0.044724201183492164
Bond Position:  [-0.06788639]


portfolio before change:  [4.37371583]
curr_Stock_Price:  99.31102934914455
curr_Factors:  [99.31102935]
mat_Sqrt:  [[0.15]]
grads:  [-0.0004438]
Stock Position:  -0.00044380130286271035
Bond Position:  [4.41779019]


portfolio before change:  [4.37380103]
curr_Stock_Price:  99.74120467818707
curr_Factors:  [99.74120468]
mat_Sqrt:  [[0.15]]
grads:  [0.01037565]
Stock Position:  0.010375648322393008
Bond Position:  [3.33892137]


portfolio before change:  [4.38071547]
curr_Stock_Price:  100.38750099402057
curr_Factors:  [100.38750099]
mat_Sqrt:  [[0.15]]
grads:  [-0.01335079]
Stock Position:  -0.013350794651056399
Bond Position:  [5.72096838]


portfolio before change:  [4.38208873]
curr_Stock_Price:  100.3114237261389
curr_Factors:  [100.31142373]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [3.7796518]


portfolio before change:  [4.38382513]
curr_Stock_Price:  100.56121484697879
curr_Factors:  [100.56121485]
mat_Sqrt:  [[0.15]]
grads:  [-0.07896652]
Stock Position:  -0.0789665169310846
Bond Position:  [12.324794]


portfolio before change:  [4.33347424]
curr_Stock_Price:  101.20859321787263
curr_Factors:  [101.20859322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04238657]
Stock Position:  -0.04238656909858467
Bond Position:  [8.62335927]


portfolio before change:  [4.33346565]
curr_Stock_Price:  101.22151155777622
curr_Factors:  [101.22151156]
mat_Sqrt:  [[0.15]]
grads:  [-0.08668627]
Stock Position:  -0.08668626550363416
Bond Position:  [13.10798047]


portfolio before change:  [4.29521178]
curr_Stock_Price:  101.67225361425568
curr_Factors:  [101.67225361]
mat_Sqrt:  [[0.15]]
grads:  [-0.02018068]
Stock Position:  -0.020180680296040556
Bond Position:  [6.34702702]


portfolio before change:  [4.29641815]
curr_Stock_Price:  101.63213247204968
curr_Factors:  [101.63213247]
mat_Sqrt:  [[0.15]]
grads:  [-0.00096868]
Stock Position:  -0.0009686778999329118
Bond Position:  [4.39486695]


portfolio before change:  [4.2968003]
curr_Stock_Price:  101.5211980460292
curr_Factors:  [101.52119805]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684786]
Stock Position:  -0.03684785968732496
Bond Position:  [8.03763916]


portfolio before change:  [4.30855633]
curr_Stock_Price:  101.21578905714522
curr_Factors:  [101.21578906]
mat_Sqrt:  [[0.15]]
grads:  [0.12567592]
Stock Position:  0.12567592488040727
Bond Position:  [-8.41183157]


portfolio before change:  [4.28713484]
curr_Stock_Price:  101.04952220467075
curr_Factors:  [101.0495222]
mat_Sqrt:  [[0.15]]
grads:  [-0.05476236]
Stock Position:  -0.054762360539733386
Bond Position:  [9.82084521]


portfolio before change:  [4.27976796]
curr_Stock_Price:  101.19525549248746
curr_Factors:  [101.19525549]
mat_Sqrt:  [[0.15]]
grads:  [0.06124901]
Stock Position:  0.061249007237386854
Bond Position:  [-1.91834098]


portfolio before change:  [4.23794247]
curr_Stock_Price:  100.5143367725013
curr_Factors:  [100.51433677]
mat_Sqrt:  [[0.15]]
grads:  [-0.06962533]
Stock Position:  -0.06962532742446277
Bond Position:  [11.23628607]


portfolio before change:  [4.28523301]
curr_Stock_Price:  99.84520880281322
curr_Factors:  [99.8452088]
mat_Sqrt:  [[0.15]]
grads:  [0.07111317]
Stock Position:  0.07111316942019573
Bond Position:  [-2.81507624]


portfolio before change:  [4.26072269]
curr_Stock_Price:  99.50301664925027
curr_Factors:  [99.50301665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04218248]
Stock Position:  -0.042182478017603005
Bond Position:  [8.45800651]


portfolio before change:  [4.25889328]
curr_Stock_Price:  99.55891793833625
curr_Factors:  [99.55891794]
mat_Sqrt:  [[0.15]]
grads:  [0.06874112]
Stock Position:  0.06874112241788584
Bond Position:  [-2.58489849]


portfolio before change:  [4.27752824]
curr_Stock_Price:  99.83235724358552
curr_Factors:  [99.83235724]
mat_Sqrt:  [[0.15]]
grads:  [-0.13880507]
Stock Position:  -0.13880506946038457
Bond Position:  [18.13476552]


portfolio before change:  [4.33969691]
curr_Stock_Price:  99.39263837278672
curr_Factors:  [99.39263837]
mat_Sqrt:  [[0.15]]
grads:  [-0.02901162]
Stock Position:  -0.02901162348210915
Bond Position:  [7.22323871]


portfolio before change:  [4.34752572]
curr_Stock_Price:  99.13834902873951
curr_Factors:  [99.13834903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01852343]
Stock Position:  -0.018523428356910076
Bond Position:  [6.18390783]


portfolio before change:  [4.34860245]
curr_Stock_Price:  99.10108697044924
curr_Factors:  [99.10108697]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624746]
Stock Position:  -0.006247458694145006
Bond Position:  [4.9677324]


portfolio before change:  [4.3508051]
curr_Stock_Price:  98.79821906905549
curr_Factors:  [98.79821907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.3508051]
Stock Price:  98.449421014178
PL:  [4.3508051]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.95061670e-04]
 [ 2.50020766e-03]
 [ 5.71098778e-04]
 [ 6.15169346e-03]
 [ 4.99605454e-03]
 [ 2.73006117e-02]
 [ 1.29418435e-03]
 [-1.48605093e-02]
 [ 2.10950960e-02]
 [ 1.88067930e-03]
 [ 1.41249823e-02]
 [-1.49593311e-02]
 [ 8.79399413e-03]
 [ 6.67422107e-03]
 [-6.90024512e-03]
 [ 2.57433306e-02]
 [ 1.33433294e-02]
 [-5.49584337e-03]
 [ 5.48535259e-03]
 [-6.51339106e-03]
 [ 1.46479029e-02]
 [-8.90657252e-03]
 [ 1.10906344e-02]
 [-2.10245320e-02]
 [ 2.84794507e-03]
 [ 9.71339537e-03]
 [-5.43608549e-03]
 [ 8.73093717e-03]
 [ 1.07557028e-02]
 [-2.31787958e-03]
 [ 9.07983682e-03]
 [-1.18489914e-02]
 [ 8.16845962e-03]
 [ 7.81642271e-03]
 [ 1.11393377e-02]
 [ 8.59460137e-03]
 [-3.38092285e-02]
 [ 9.75532365e-03]
 [-7.82885007e-03]
 [ 2.48966201e-02]
 [-5.96829794e-03]
 [-1.99507014e-02]
 [ 2.14895304e-02]
 [ 1.92834996e-03]
 [-7.50301328e-03]
 [ 1.50689179e-03]
 [ 1.05265395e-02]
 [-2.73118388e-03]
 [-7.09219102e-03]
 [-7.60732103e-03]
 [-1.35887062e-02]
 [-4.66179133e-03]
 [ 1.35322916e-04]
 [ 5.36937997e-03]
 [ 5.02493343e-03]
 [-3.49769668e-03]
 [ 4.05433928e-03]
 [-3.68844310e-04]
 [ 1.55559560e-03]
 [-9.06850350e-04]
 [ 9.00849938e-04]
 [-1.15353272e-02]
 [-8.50035395e-03]
 [-1.27597936e-02]
 [-1.69872489e-03]
 [ 1.19220174e-05]
 [-5.50554440e-03]
 [ 1.55836257e-02]
 [-8.20052902e-03]
 [ 8.94488870e-03]
 [-1.03336213e-02]
 [ 1.06698868e-02]
 [-5.58184018e-03]
 [ 1.13753457e-02]
 [-2.06046097e-02]
 [-4.26735477e-03]
 [-2.17557763e-04]
 [-1.82279416e-03]
 [-1.10986907e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.77437315]
curr_Stock_Price:  100.11267501427245
curr_Factors:  [100.11267501]
mat_Sqrt:  [[0.15]]
grads:  [0.00663374]
Stock Position:  0.006633744468001023
Bond Position:  [3.11025124]


portfolio before change:  [3.77390216]
curr_Stock_Price:  100.01237166494587
curr_Factors:  [100.01237166]
mat_Sqrt:  [[0.15]]
grads:  [0.01666805]
Stock Position:  0.016668051076455352
Bond Position:  [2.10689084]


portfolio before change:  [3.77295856]
curr_Stock_Price:  99.94786039152712
curr_Factors:  [99.94786039]
mat_Sqrt:  [[0.15]]
grads:  [0.00380733]
Stock Position:  0.003807325185091852
Bond Position:  [3.39242456]


portfolio before change:  [3.77543793]
curr_Stock_Price:  100.54337949945914
curr_Factors:  [100.5433795]
mat_Sqrt:  [[0.15]]
grads:  [0.04101129]
Stock Position:  0.04101128973686823
Bond Position:  [-0.34797574]


portfolio before change:  [3.74335441]
curr_Stock_Price:  99.76160038131879
curr_Factors:  [99.76160038]
mat_Sqrt:  [[0.15]]
grads:  [0.03330703]
Stock Position:  0.03330703026494227
Bond Position:  [0.42059177]


portfolio before change:  [3.76756291]
curr_Stock_Price:  100.4876394906253
curr_Factors:  [100.48763949]
mat_Sqrt:  [[0.15]]
grads:  [0.18200408]
Stock Position:  0.18200407786735207
Bond Position:  [-14.52159726]


portfolio before change:  [3.7663574]
curr_Stock_Price:  100.48600285549873
curr_Factors:  [100.48600286]
mat_Sqrt:  [[0.15]]
grads:  [0.0086279]
Stock Position:  0.008627895633940718
Bond Position:  [2.89937466]


portfolio before change:  [3.76541835]
curr_Stock_Price:  100.35616046174125
curr_Factors:  [100.35616046]
mat_Sqrt:  [[0.15]]
grads:  [-0.09907006]
Stock Position:  -0.09907006185129254
Bond Position:  [13.70770938]


portfolio before change:  [3.78470591]
curr_Stock_Price:  100.17012247233565
curr_Factors:  [100.17012247]
mat_Sqrt:  [[0.15]]
grads:  [0.14063397]
Stock Position:  0.1406339736533019
Bond Position:  [-10.30261646]


portfolio before change:  [3.72424043]
curr_Stock_Price:  99.74475199558752
curr_Factors:  [99.744752]
mat_Sqrt:  [[0.15]]
grads:  [0.01253786]
Stock Position:  0.01253786197135848
Bond Position:  [2.4736545]


portfolio before change:  [3.73074654]
curr_Stock_Price:  100.25133750751583
curr_Factors:  [100.25133751]
mat_Sqrt:  [[0.15]]
grads:  [0.09416655]
Stock Position:  0.09416654875392727
Bond Position:  [-5.70957592]


portfolio before change:  [3.73436693]
curr_Stock_Price:  100.29357377964544
curr_Factors:  [100.29357378]
mat_Sqrt:  [[0.15]]
grads:  [-0.09972887]
Stock Position:  -0.09972887386071976
Bond Position:  [13.73653209]


portfolio before change:  [3.70923046]
curr_Stock_Price:  100.554230784423
curr_Factors:  [100.55423078]
mat_Sqrt:  [[0.15]]
grads:  [0.05862663]
Stock Position:  0.0586266275476374
Bond Position:  [-2.18592498]


portfolio before change:  [3.78272853]
curr_Stock_Price:  101.81022480188366
curr_Factors:  [101.8102248]
mat_Sqrt:  [[0.15]]
grads:  [0.04449481]
Stock Position:  0.04449480716290632
Bond Position:  [-0.74729779]


portfolio before change:  [3.79932905]
curr_Stock_Price:  102.18436360910451
curr_Factors:  [102.18436361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600163]
Stock Position:  -0.04600163412846815
Bond Position:  [8.49997676]


portfolio before change:  [3.79926368]
curr_Stock_Price:  102.19733341411833
curr_Factors:  [102.19733341]
mat_Sqrt:  [[0.15]]
grads:  [0.1716222]
Stock Position:  0.17162220388946725
Bond Position:  [-13.74006791]


portfolio before change:  [4.0103482]
curr_Stock_Price:  103.43227444282313
curr_Factors:  [103.43227444]
mat_Sqrt:  [[0.15]]
grads:  [0.08895553]
Stock Position:  0.0889555290671088
Bond Position:  [-5.19052449]


portfolio before change:  [3.99520854]
curr_Stock_Price:  103.26572774723792
curr_Factors:  [103.26572775]
mat_Sqrt:  [[0.15]]
grads:  [-0.03663896]
Stock Position:  -0.03663895582934975
Bond Position:  [7.77875697]


portfolio before change:  [4.02143093]
curr_Stock_Price:  102.56330040560903
curr_Factors:  [102.56330041]
mat_Sqrt:  [[0.15]]
grads:  [0.03656902]
Stock Position:  0.036569017282182224
Bond Position:  [0.27079182]


portfolio before change:  [4.02984865]
curr_Stock_Price:  102.79302487752645
curr_Factors:  [102.79302488]
mat_Sqrt:  [[0.15]]
grads:  [-0.04342261]
Stock Position:  -0.04342260705675372
Bond Position:  [8.49338978]


portfolio before change:  [3.99494884]
curr_Stock_Price:  103.60897456717574
curr_Factors:  [103.60897457]
mat_Sqrt:  [[0.15]]
grads:  [0.09765269]
Stock Position:  0.09765268594632805
Bond Position:  [-6.12274581]


portfolio before change:  [3.92911064]
curr_Stock_Price:  102.93868560466237
curr_Factors:  [102.9386856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05937715]
Stock Position:  -0.05937715013944319
Bond Position:  [10.04131643]


portfolio before change:  [3.95309693]
curr_Stock_Price:  102.54529035506982
curr_Factors:  [102.54529036]
mat_Sqrt:  [[0.15]]
grads:  [0.07393756]
Stock Position:  0.0739375626500964
Bond Position:  [-3.6288519]


portfolio before change:  [3.9728628]
curr_Stock_Price:  102.8156897758272
curr_Factors:  [102.81568978]
mat_Sqrt:  [[0.15]]
grads:  [-0.14016355]
Stock Position:  -0.14016354665781355
Bond Position:  [18.38387453]


portfolio before change:  [4.06068382]
curr_Stock_Price:  102.1973264860485
curr_Factors:  [102.19732649]
mat_Sqrt:  [[0.15]]
grads:  [0.0189863]
Stock Position:  0.01898630048625483
Bond Position:  [2.12033467]


portfolio before change:  [4.05877499]
curr_Stock_Price:  102.08980936752572
curr_Factors:  [102.08980937]
mat_Sqrt:  [[0.15]]
grads:  [0.06475597]
Stock Position:  0.06475596912893164
Bond Position:  [-2.55214955]


portfolio before change:  [4.04275167]
curr_Stock_Price:  101.84483117744318
curr_Factors:  [101.84483118]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624057]
Stock Position:  -0.036240569943852344
Bond Position:  [7.7336664]


portfolio before change:  [4.05022547]
curr_Stock_Price:  101.6519415562208
curr_Factors:  [101.65194156]
mat_Sqrt:  [[0.15]]
grads:  [0.05820625]
Stock Position:  0.05820624783229294
Bond Position:  [-1.86655263]


portfolio before change:  [4.00960466]
curr_Stock_Price:  100.95606863272157
curr_Factors:  [100.95606863]
mat_Sqrt:  [[0.15]]
grads:  [0.07170469]
Stock Position:  0.07170468520633687
Bond Position:  [-3.22941846]


portfolio before change:  [4.02952961]
curr_Stock_Price:  101.23675880313309
curr_Factors:  [101.2367588]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545253]
Stock Position:  -0.015452530533858623
Bond Position:  [5.59389372]


portfolio before change:  [4.03138586]
curr_Stock_Price:  101.13925917205682
curr_Factors:  [101.13925917]
mat_Sqrt:  [[0.15]]
grads:  [0.06053225]
Stock Position:  0.06053224543663835
Bond Position:  [-2.0908006]


portfolio before change:  [4.02546286]
curr_Stock_Price:  101.04356935625624
curr_Factors:  [101.04356936]
mat_Sqrt:  [[0.15]]
grads:  [-0.07899328]
Stock Position:  -0.07899327624495948
Bond Position:  [12.00722545]


portfolio before change:  [3.98080887]
curr_Stock_Price:  101.61835838449363
curr_Factors:  [101.61835838]
mat_Sqrt:  [[0.15]]
grads:  [0.0544564]
Stock Position:  0.05445639747781145
Bond Position:  [-1.55296085]


portfolio before change:  [3.96153597]
curr_Stock_Price:  101.26622645205032
curr_Factors:  [101.26622645]
mat_Sqrt:  [[0.15]]
grads:  [0.05210948]
Stock Position:  0.0521094847120895
Bond Position:  [-1.31539491]


portfolio before change:  [3.98158969]
curr_Stock_Price:  101.65264246515814
curr_Factors:  [101.65264247]
mat_Sqrt:  [[0.15]]
grads:  [0.07426225]
Stock Position:  0.07426225144149165
Bond Position:  [-3.5673644]


portfolio before change:  [3.97249005]
curr_Stock_Price:  101.53311095238377
curr_Factors:  [101.53311095]
mat_Sqrt:  [[0.15]]
grads:  [0.05729734]
Stock Position:  0.057297342447550983
Bond Position:  [-1.84508738]


portfolio before change:  [3.97244915]
curr_Stock_Price:  101.53440993206382
curr_Factors:  [101.53440993]
mat_Sqrt:  [[0.15]]
grads:  [-0.22539486]
Stock Position:  -0.22539485699872144
Bond Position:  [26.85778296]


portfolio before change:  [4.23729243]
curr_Stock_Price:  100.36683841920126
curr_Factors:  [100.36683842]
mat_Sqrt:  [[0.15]]
grads:  [0.06503549]
Stock Position:  0.06503549100260538
Bond Position:  [-2.29011419]


portfolio before change:  [4.22174192]
curr_Stock_Price:  100.12993131467128
curr_Factors:  [100.12993131]
mat_Sqrt:  [[0.15]]
grads:  [-0.05219233]
Stock Position:  -0.05219233379436104
Bond Position:  [9.44775672]


portfolio before change:  [4.23270919]
curr_Stock_Price:  99.93111358935757
curr_Factors:  [99.93111359]
mat_Sqrt:  [[0.15]]
grads:  [0.16597747]
Stock Position:  0.16597746747250566
Bond Position:  [-12.35360397]


portfolio before change:  [4.34423202]
curr_Stock_Price:  100.6076810697906
curr_Factors:  [100.60768107]
mat_Sqrt:  [[0.15]]
grads:  [-0.03978865]
Stock Position:  -0.039788652908124875
Bond Position:  [8.34727612]


portfolio before change:  [4.30415592]
curr_Stock_Price:  101.62801771283392
curr_Factors:  [101.62801771]
mat_Sqrt:  [[0.15]]
grads:  [-0.13300468]
Stock Position:  -0.13300467574849584
Bond Position:  [17.82115746]


portfolio before change:  [4.27596629]
curr_Stock_Price:  101.84833693045755
curr_Factors:  [101.84833693]
mat_Sqrt:  [[0.15]]
grads:  [0.14326354]
Stock Position:  0.14326353594984836
Bond Position:  [-10.31518659]


portfolio before change:  [4.20437522]
curr_Stock_Price:  101.35312121297123
curr_Factors:  [101.35312121]
mat_Sqrt:  [[0.15]]
grads:  [0.01285567]
Stock Position:  0.012855666386486539
Bond Position:  [2.9014133]


portfolio before change:  [4.1960392]
curr_Stock_Price:  100.69058372605063
curr_Factors:  [100.69058373]
mat_Sqrt:  [[0.15]]
grads:  [-0.05002009]
Stock Position:  -0.05002008855780479
Bond Position:  [9.23259112]


portfolio before change:  [4.18496885]
curr_Stock_Price:  100.92343828386439
curr_Factors:  [100.92343828]
mat_Sqrt:  [[0.15]]
grads:  [0.01004595]
Stock Position:  0.01004594524857308
Bond Position:  [3.17109752]


portfolio before change:  [4.18593235]
curr_Stock_Price:  100.99961817907226
curr_Factors:  [100.99961818]
mat_Sqrt:  [[0.15]]
grads:  [0.07017693]
Stock Position:  0.07017692987733685
Bond Position:  [-2.90191077]


portfolio before change:  [4.23716273]
curr_Stock_Price:  101.73222017124874
curr_Factors:  [101.73222017]
mat_Sqrt:  [[0.15]]
grads:  [-0.01820789]
Stock Position:  -0.01820789250731476
Bond Position:  [6.08949206]


portfolio before change:  [4.23981371]
curr_Stock_Price:  101.60752875129404
curr_Factors:  [101.60752875]
mat_Sqrt:  [[0.15]]
grads:  [-0.04728127]
Stock Position:  -0.04728127348266495
Bond Position:  [9.04394706]


portfolio before change:  [4.25215666]
curr_Stock_Price:  101.358430418542
curr_Factors:  [101.35843042]
mat_Sqrt:  [[0.15]]
grads:  [-0.05071547]
Stock Position:  -0.050715473509873175
Bond Position:  [9.39259745]


portfolio before change:  [4.233926]
curr_Stock_Price:  101.72947521950182
curr_Factors:  [101.72947522]
mat_Sqrt:  [[0.15]]
grads:  [-0.09059137]
Stock Position:  -0.09059137472383556
Bond Position:  [13.44973901]


portfolio before change:  [4.27909458]
curr_Stock_Price:  101.24015769128583
curr_Factors:  [101.24015769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107861]
Stock Position:  -0.031078608864791336
Bond Position:  [7.42549784]


portfolio before change:  [4.29562236]
curr_Stock_Price:  100.72328554505357
curr_Factors:  [100.72328555]
mat_Sqrt:  [[0.15]]
grads:  [0.00090215]
Stock Position:  0.0009021527737055966
Bond Position:  [4.20475457]


portfolio before change:  [4.29548793]
curr_Stock_Price:  100.28296742940206
curr_Factors:  [100.28296743]
mat_Sqrt:  [[0.15]]
grads:  [0.03579587]
Stock Position:  0.035795866437500413
Bond Position:  [0.70577222]


portfolio before change:  [4.30775768]
curr_Stock_Price:  100.62450505900372
curr_Factors:  [100.62450506]
mat_Sqrt:  [[0.15]]
grads:  [0.03349956]
Stock Position:  0.033499556171161356
Bond Position:  [0.93688142]


portfolio before change:  [4.31029895]
curr_Stock_Price:  100.69861711383933
curr_Factors:  [100.69861711]
mat_Sqrt:  [[0.15]]
grads:  [-0.02331798]
Stock Position:  -0.023317977838994444
Bond Position:  [6.65838708]


portfolio before change:  [4.30917064]
curr_Stock_Price:  100.76485267611056
curr_Factors:  [100.76485268]
mat_Sqrt:  [[0.15]]
grads:  [0.02702893]
Stock Position:  0.0270289285185346
Bond Position:  [1.58560464]


portfolio before change:  [4.3085892]
curr_Stock_Price:  100.73967452059935
curr_Factors:  [100.73967452]
mat_Sqrt:  [[0.15]]
grads:  [-0.00245896]
Stock Position:  -0.002458962064990647
Bond Position:  [4.55630424]


portfolio before change:  [4.31041325]
curr_Stock_Price:  100.11368965076048
curr_Factors:  [100.11368965]
mat_Sqrt:  [[0.15]]
grads:  [0.01037064]
Stock Position:  0.01037063731794565
Bond Position:  [3.27217049]


portfolio before change:  [4.31408795]
curr_Stock_Price:  100.4483054078707
curr_Factors:  [100.44830541]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604567]
Stock Position:  -0.006045668999037843
Bond Position:  [4.92136515]


portfolio before change:  [4.31426856]
curr_Stock_Price:  100.46930996024889
curr_Factors:  [100.46930996]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [3.71088341]


portfolio before change:  [4.31318236]
curr_Stock_Price:  100.24982885579196
curr_Factors:  [100.24982886]
mat_Sqrt:  [[0.15]]
grads:  [-0.07690218]
Stock Position:  -0.07690218119318945
Bond Position:  [12.02261287]


portfolio before change:  [4.29055849]
curr_Stock_Price:  100.55379047655563
curr_Factors:  [100.55379048]
mat_Sqrt:  [[0.15]]
grads:  [-0.05666903]
Stock Position:  -0.05666902635492892
Bond Position:  [9.98884389]


portfolio before change:  [4.23467433]
curr_Stock_Price:  101.55095737607937
curr_Factors:  [101.55095738]
mat_Sqrt:  [[0.15]]
grads:  [-0.08506529]
Stock Position:  -0.08506529038741277
Bond Position:  [12.87313601]


portfolio before change:  [4.20386451]
curr_Stock_Price:  101.9226062718911
curr_Factors:  [101.92260627]
mat_Sqrt:  [[0.15]]
grads:  [-0.01132483]
Stock Position:  -0.011324832576052856
Bond Position:  [5.35812096]


portfolio before change:  [4.2060896]
curr_Stock_Price:  101.75569920869542
curr_Factors:  [101.75569921]
mat_Sqrt:  [[0.15]]
grads:  [7.94801162e-05]
Stock Position:  7.94801162005282e-05
Bond Position:  [4.19800204]


portfolio before change:  [4.20635188]
curr_Stock_Price:  101.75446428410714
curr_Factors:  [101.75446428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03670363]
Stock Position:  -0.036703629341374944
Bond Position:  [7.94111002]


portfolio before change:  [4.20191964]
curr_Stock_Price:  101.88874459987551
curr_Factors:  [101.8887446]
mat_Sqrt:  [[0.15]]
grads:  [0.10389084]
Stock Position:  0.1038908383309328
Bond Position:  [-6.38338745]


portfolio before change:  [4.1050451]
curr_Stock_Price:  100.96012019946423
curr_Factors:  [100.9601202]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467019]
Stock Position:  -0.054670193467751815
Bond Position:  [9.6245544]


portfolio before change:  [4.09753385]
curr_Stock_Price:  101.10851555480846
curr_Factors:  [101.10851555]
mat_Sqrt:  [[0.15]]
grads:  [0.05963259]
Stock Position:  0.0596325913297514
Bond Position:  [-1.93182894]


portfolio before change:  [4.0489337]
curr_Stock_Price:  100.29554721253723
curr_Factors:  [100.29554721]
mat_Sqrt:  [[0.15]]
grads:  [-0.06889081]
Stock Position:  -0.06889080871126226
Bond Position:  [10.95837506]


portfolio before change:  [4.09538105]
curr_Stock_Price:  99.63127242297882
curr_Factors:  [99.63127242]
mat_Sqrt:  [[0.15]]
grads:  [0.07113258]
Stock Position:  0.07113257847421504
Bond Position:  [-2.99164826]


portfolio before change:  [4.06801054]
curr_Stock_Price:  99.24911953771365
curr_Factors:  [99.24911954]
mat_Sqrt:  [[0.15]]
grads:  [-0.03721227]
Stock Position:  -0.03721226786985321
Bond Position:  [7.76129536]


portfolio before change:  [4.05133296]
curr_Stock_Price:  99.71032980689992
curr_Factors:  [99.71032981]
mat_Sqrt:  [[0.15]]
grads:  [0.07583564]
Stock Position:  0.07583563771478936
Bond Position:  [-3.51026349]


portfolio before change:  [4.05462661]
curr_Stock_Price:  99.75665429446771
curr_Factors:  [99.75665429]
mat_Sqrt:  [[0.15]]
grads:  [-0.13736406]
Stock Position:  -0.13736406492003958
Bond Position:  [17.75760614]


portfolio before change:  [4.07569255]
curr_Stock_Price:  99.61137573476317
curr_Factors:  [99.61137573]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844903]
Stock Position:  -0.028449031819639682
Bond Position:  [6.90953974]


portfolio before change:  [4.10936335]
curr_Stock_Price:  98.44300735404055
curr_Factors:  [98.44300735]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145039]
Stock Position:  -0.0014503850874504158
Bond Position:  [4.25214362]


portfolio before change:  [4.10826135]
curr_Stock_Price:  99.38605091502578
curr_Factors:  [99.38605092]
mat_Sqrt:  [[0.15]]
grads:  [-0.01215196]
Stock Position:  -0.012151961041346356
Bond Position:  [5.31599676]


portfolio before change:  [4.10623117]
curr_Stock_Price:  99.58045898951654
curr_Factors:  [99.58045899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.10623117]
Stock Price:  99.69330983228714
PL:  [4.10623117]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.71138756e-04]
 [-1.75961582e-02]
 [-1.44214233e-04]
 [ 8.49263287e-03]
 [ 2.23920654e-03]
 [ 1.76222962e-02]
 [ 1.65834536e-03]
 [-2.11384180e-02]
 [-2.65817857e-03]
 [ 2.08863379e-02]
 [ 1.51907128e-02]
 [ 2.30732865e-02]
 [-1.46030445e-02]
 [ 1.09180730e-02]
 [-6.92625020e-03]
 [ 6.04071028e-03]
 [ 7.28278600e-03]
 [-8.83982470e-03]
 [ 5.94856585e-04]
 [ 1.21482674e-02]
 [ 1.19600151e-02]
 [-8.83190730e-03]
 [ 6.08822296e-03]
 [-1.06386424e-02]
 [-9.62914428e-03]
 [-9.29157473e-03]
 [-2.94253436e-03]
 [ 8.54992628e-03]
 [-1.97792894e-02]
 [ 9.71830844e-04]
 [ 1.94916343e-03]
 [-1.00979876e-02]
 [-8.40603279e-03]
 [ 5.45369138e-03]
 [ 1.37808314e-02]
 [ 1.48169353e-02]
 [-3.45163863e-02]
 [ 8.72176596e-03]
 [-1.91139857e-02]
 [ 2.14857953e-02]
 [-7.63195490e-03]
 [ 2.49200394e-02]
 [ 2.30854012e-02]
 [ 4.17129306e-03]
 [ 2.75250707e-03]
 [ 1.16204271e-02]
 [-7.92152506e-04]
 [-1.04610692e-02]
 [ 4.27389236e-03]
 [ 2.69946491e-03]
 [ 4.01265461e-02]
 [-1.03761694e-02]
 [ 2.85923254e-03]
 [ 5.09838819e-03]
 [ 4.21206062e-03]
 [ 2.37498223e-03]
 [-5.81935932e-03]
 [-4.86724103e-04]
 [ 1.53327594e-03]
 [-4.94485916e-03]
 [-2.80415242e-03]
 [-1.26528556e-04]
 [-5.23708368e-03]
 [-1.74251667e-02]
 [-1.25568588e-02]
 [ 1.09014803e-03]
 [-5.10386084e-03]
 [ 2.24198856e-02]
 [-8.20699179e-03]
 [ 8.82349532e-03]
 [-1.03189474e-02]
 [ 1.07129204e-02]
 [-7.55152985e-03]
 [ 1.10860883e-02]
 [-2.01335373e-02]
 [-4.27555626e-03]
 [-3.64998407e-03]
 [-6.93268480e-05]
 [-1.01785426e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.68558097]
curr_Stock_Price:  100.1719262655274
curr_Factors:  [100.17192627]
mat_Sqrt:  [[0.15]]
grads:  [0.00514093]
Stock Position:  0.005140925037231802
Bond Position:  [4.17060461]


portfolio before change:  [4.679627]
curr_Stock_Price:  98.96306944720999
curr_Factors:  [98.96306945]
mat_Sqrt:  [[0.15]]
grads:  [-0.11730772]
Stock Position:  -0.11730772103910851
Bond Position:  [16.28875914]


portfolio before change:  [4.59166457]
curr_Stock_Price:  99.72159164077762
curr_Factors:  [99.72159164]
mat_Sqrt:  [[0.15]]
grads:  [-0.00096143]
Stock Position:  -0.0009614282190100373
Bond Position:  [4.68753972]


portfolio before change:  [4.5921852]
curr_Stock_Price:  99.48480881099235
curr_Factors:  [99.48480881]
mat_Sqrt:  [[0.15]]
grads:  [0.05661755]
Stock Position:  0.056617552477120595
Bond Position:  [-1.04040119]


portfolio before change:  [4.57813285]
curr_Stock_Price:  99.23775955010383
curr_Factors:  [99.23775955]
mat_Sqrt:  [[0.15]]
grads:  [0.01492804]
Stock Position:  0.014928043600855354
Bond Position:  [3.09670724]


portfolio before change:  [4.57404443]
curr_Stock_Price:  98.95091905480975
curr_Factors:  [98.95091905]
mat_Sqrt:  [[0.15]]
grads:  [0.11748197]
Stock Position:  0.1174819747054346
Bond Position:  [-7.05090494]


portfolio before change:  [4.56587547]
curr_Stock_Price:  98.88513654920115
curr_Factors:  [98.88513655]
mat_Sqrt:  [[0.15]]
grads:  [0.01105564]
Stock Position:  0.011055635715991179
Bond Position:  [3.47263743]


portfolio before change:  [4.56300927]
curr_Stock_Price:  98.6062518089506
curr_Factors:  [98.60625181]
mat_Sqrt:  [[0.15]]
grads:  [-0.14092279]
Stock Position:  -0.1409227866757824
Bond Position:  [18.45887706]


portfolio before change:  [4.57887467]
curr_Stock_Price:  98.50185647322184
curr_Factors:  [98.50185647]
mat_Sqrt:  [[0.15]]
grads:  [-0.01772119]
Stock Position:  -0.01772119048096127
Bond Position:  [6.32444483]


portfolio before change:  [4.57307901]
curr_Stock_Price:  98.85120939858717
curr_Factors:  [98.8512094]
mat_Sqrt:  [[0.15]]
grads:  [0.13924225]
Stock Position:  0.13924225250660976
Bond Position:  [-9.19118605]


portfolio before change:  [4.60529017]
curr_Stock_Price:  99.08666684685588
curr_Factors:  [99.08666685]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-5.42935713]


portfolio before change:  [4.54539031]
curr_Stock_Price:  98.49853924399576
curr_Factors:  [98.49853924]
mat_Sqrt:  [[0.15]]
grads:  [0.15382191]
Stock Position:  0.1538219098260183
Bond Position:  [-10.60584311]


portfolio before change:  [4.51605922]
curr_Stock_Price:  98.31216655457666
curr_Factors:  [98.31216655]
mat_Sqrt:  [[0.15]]
grads:  [-0.09735363]
Stock Position:  -0.09735363004448604
Bond Position:  [14.08710551]


portfolio before change:  [4.43312428]
curr_Stock_Price:  99.17310423274904
curr_Factors:  [99.17310423]
mat_Sqrt:  [[0.15]]
grads:  [0.07278715]
Stock Position:  0.07278715345642967
Bond Position:  [-2.78540367]


portfolio before change:  [4.44995775]
curr_Stock_Price:  99.40676583116326
curr_Factors:  [99.40676583]
mat_Sqrt:  [[0.15]]
grads:  [-0.046175]
Stock Position:  -0.046175001336748345
Bond Position:  [9.0400653]


portfolio before change:  [4.481703]
curr_Stock_Price:  98.7315037319573
curr_Factors:  [98.73150373]
mat_Sqrt:  [[0.15]]
grads:  [0.0402714]
Stock Position:  0.04027140189103388
Bond Position:  [0.50564694]


portfolio before change:  [4.48677734]
curr_Stock_Price:  98.8567224185344
curr_Factors:  [98.85672242]
mat_Sqrt:  [[0.15]]
grads:  [0.04855191]
Stock Position:  0.04855190667811379
Bond Position:  [-0.31290502]


portfolio before change:  [4.47586092]
curr_Stock_Price:  98.63228511769269
curr_Factors:  [98.63228512]
mat_Sqrt:  [[0.15]]
grads:  [-0.05893216]
Stock Position:  -0.05893216468338617
Bond Position:  [10.28847499]


portfolio before change:  [4.46838605]
curr_Stock_Price:  98.77003533368982
curr_Factors:  [98.77003533]
mat_Sqrt:  [[0.15]]
grads:  [0.00396571]
Stock Position:  0.003965710565327748
Bond Position:  [4.07669268]


portfolio before change:  [4.46869676]
curr_Stock_Price:  98.78413290471975
curr_Factors:  [98.7841329]
mat_Sqrt:  [[0.15]]
grads:  [0.08098845]
Stock Position:  0.08098844930436266
Bond Position:  [-3.53167698]


portfolio before change:  [4.45587638]
curr_Stock_Price:  98.62855951333258
curr_Factors:  [98.62855951]
mat_Sqrt:  [[0.15]]
grads:  [0.07973343]
Stock Position:  0.07973343377124747
Bond Position:  [-3.40811734]


portfolio before change:  [4.45766424]
curr_Stock_Price:  98.6536541120948
curr_Factors:  [98.65365411]
mat_Sqrt:  [[0.15]]
grads:  [-0.05887938]
Stock Position:  -0.05887938200030503
Bond Position:  [10.26633043]


portfolio before change:  [4.49515616]
curr_Stock_Price:  98.02779412789758
curr_Factors:  [98.02779413]
mat_Sqrt:  [[0.15]]
grads:  [0.04058815]
Stock Position:  0.04058815304456058
Bond Position:  [0.51638905]


portfolio before change:  [4.47512113]
curr_Stock_Price:  97.53338148084403
curr_Factors:  [97.53338148]
mat_Sqrt:  [[0.15]]
grads:  [-0.07092428]
Stock Position:  -0.07092428240901487
Bond Position:  [11.39260623]


portfolio before change:  [4.46425901]
curr_Stock_Price:  97.69657220662914
curr_Factors:  [97.69657221]
mat_Sqrt:  [[0.15]]
grads:  [-0.0641943]
Stock Position:  -0.06419429517419899
Bond Position:  [10.7358216]


portfolio before change:  [4.44539195]
curr_Stock_Price:  98.00093057202321
curr_Factors:  [98.00093057]
mat_Sqrt:  [[0.15]]
grads:  [-0.06194383]
Stock Position:  -0.061943831556935
Bond Position:  [10.51594508]


portfolio before change:  [4.45241786]
curr_Stock_Price:  97.8981172975626
curr_Factors:  [97.8981173]
mat_Sqrt:  [[0.15]]
grads:  [-0.0196169]
Stock Position:  -0.01961689572238048
Bond Position:  [6.37287502]


portfolio before change:  [4.4542577]
curr_Stock_Price:  97.82463398046237
curr_Factors:  [97.82463398]
mat_Sqrt:  [[0.15]]
grads:  [0.05699951]
Stock Position:  0.056999508565163476
Bond Position:  [-1.12169837]


portfolio before change:  [4.46407191]
curr_Stock_Price:  97.99804460154989
curr_Factors:  [97.9980446]
mat_Sqrt:  [[0.15]]
grads:  [-0.13186193]
Stock Position:  -0.13186192901506155
Bond Position:  [17.38628311]


portfolio before change:  [4.47823236]
curr_Stock_Price:  97.89889715803747
curr_Factors:  [97.89889716]
mat_Sqrt:  [[0.15]]
grads:  [0.00647887]
Stock Position:  0.006478872292335477
Bond Position:  [3.84395791]


portfolio before change:  [4.47579622]
curr_Stock_Price:  97.48580161823934
curr_Factors:  [97.48580162]
mat_Sqrt:  [[0.15]]
grads:  [0.01299442]
Stock Position:  0.012994422863003627
Bond Position:  [3.20902449]


portfolio before change:  [4.47750789]
curr_Stock_Price:  97.60208990745855
curr_Factors:  [97.60208991]
mat_Sqrt:  [[0.15]]
grads:  [-0.06731992]
Stock Position:  -0.06731991724078698
Bond Position:  [11.0480725]


portfolio before change:  [4.44708521]
curr_Stock_Price:  98.0642592417579
curr_Factors:  [98.06425924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05604022]
Stock Position:  -0.056040218568853446
Bond Position:  [9.94262774]


portfolio before change:  [4.48437534]
curr_Stock_Price:  97.40993100793506
curr_Factors:  [97.40993101]
mat_Sqrt:  [[0.15]]
grads:  [0.03635794]
Stock Position:  0.036357942501360915
Bond Position:  [0.94275067]


portfolio before change:  [4.47592333]
curr_Stock_Price:  97.17584341889169
curr_Factors:  [97.17584342]
mat_Sqrt:  [[0.15]]
grads:  [0.09187221]
Stock Position:  0.09187220924784013
Bond Position:  [-4.4518361]


portfolio before change:  [4.50598992]
curr_Stock_Price:  97.50613751425519
curr_Factors:  [97.50613751]
mat_Sqrt:  [[0.15]]
grads:  [0.09877957]
Stock Position:  0.09877956872010858
Bond Position:  [-5.12562429]


portfolio before change:  [4.55356555]
curr_Stock_Price:  97.99101501318196
curr_Factors:  [97.99101501]
mat_Sqrt:  [[0.15]]
grads:  [-0.23010924]
Stock Position:  -0.23010924221639367
Bond Position:  [27.10220376]


portfolio before change:  [4.62810216]
curr_Stock_Price:  97.67445810886903
curr_Factors:  [97.67445811]
mat_Sqrt:  [[0.15]]
grads:  [0.05814511]
Stock Position:  0.058145106381195584
Bond Position:  [-1.05118959]


portfolio before change:  [4.65771208]
curr_Stock_Price:  98.18482990898325
curr_Factors:  [98.18482991]
mat_Sqrt:  [[0.15]]
grads:  [-0.12742657]
Stock Position:  -0.12742657123131307
Bond Position:  [17.16906831]


portfolio before change:  [4.65742612]
curr_Stock_Price:  98.1954953583644
curr_Factors:  [98.19549536]
mat_Sqrt:  [[0.15]]
grads:  [0.14323864]
Stock Position:  0.1432386353484717
Bond Position:  [-9.40796263]


portfolio before change:  [4.61157648]
curr_Stock_Price:  97.87950778511315
curr_Factors:  [97.87950779]
mat_Sqrt:  [[0.15]]
grads:  [-0.0508797]
Stock Position:  -0.050879699322628896
Bond Position:  [9.5916564]


portfolio before change:  [4.63233983]
curr_Stock_Price:  97.4832032941568
curr_Factors:  [97.48320329]
mat_Sqrt:  [[0.15]]
grads:  [0.1661336]
Stock Position:  0.16613359627053542
Bond Position:  [-11.56289531]


portfolio before change:  [4.60706821]
curr_Stock_Price:  97.335437159799
curr_Factors:  [97.33543716]
mat_Sqrt:  [[0.15]]
grads:  [0.15390267]
Stock Position:  0.15390267449680234
Bond Position:  [-10.3731159]


portfolio before change:  [4.57249604]
curr_Stock_Price:  97.11501328063783
curr_Factors:  [97.11501328]
mat_Sqrt:  [[0.15]]
grads:  [0.02780862]
Stock Position:  0.027808620425252194
Bond Position:  [1.8718615]


portfolio before change:  [4.5757335]
curr_Stock_Price:  97.22722542178695
curr_Factors:  [97.22722542]
mat_Sqrt:  [[0.15]]
grads:  [0.01835005]
Stock Position:  0.018350047134889504
Bond Position:  [2.79160933]


portfolio before change:  [4.55434037]
curr_Stock_Price:  96.05188156138172
curr_Factors:  [96.05188156]
mat_Sqrt:  [[0.15]]
grads:  [0.07746951]
Stock Position:  0.07746951424563105
Bond Position:  [-2.88675224]


portfolio before change:  [4.53218227]
curr_Stock_Price:  95.76818710513979
curr_Factors:  [95.76818711]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528102]
Stock Position:  -0.005281016704569985
Bond Position:  [5.03793566]


portfolio before change:  [4.53051713]
curr_Stock_Price:  96.143118729463
curr_Factors:  [96.14311873]
mat_Sqrt:  [[0.15]]
grads:  [-0.06974046]
Stock Position:  -0.06974046157223728
Bond Position:  [11.23558261]


portfolio before change:  [4.51480726]
curr_Stock_Price:  96.37845002740313
curr_Factors:  [96.37845003]
mat_Sqrt:  [[0.15]]
grads:  [0.02849262]
Stock Position:  0.028492615727658516
Bond Position:  [1.76873312]


portfolio before change:  [4.50751634]
curr_Stock_Price:  96.11868204989158
curr_Factors:  [96.11868205]
mat_Sqrt:  [[0.15]]
grads:  [0.01799643]
Stock Position:  0.01799643271995409
Bond Position:  [2.77772295]


portfolio before change:  [4.51758038]
curr_Stock_Price:  96.66825917763619
curr_Factors:  [96.66825918]
mat_Sqrt:  [[0.15]]
grads:  [0.26751031]
Stock Position:  0.26751030754755123
Bond Position:  [-21.34217536]


portfolio before change:  [4.94120937]
curr_Stock_Price:  98.2568443763289
curr_Factors:  [98.25684438]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917446]
Stock Position:  -0.06917446280721987
Bond Position:  [11.7380738]


portfolio before change:  [4.97522773]
curr_Stock_Price:  97.77567396569944
curr_Factors:  [97.77567397]
mat_Sqrt:  [[0.15]]
grads:  [0.01906155]
Stock Position:  0.01906155027172478
Bond Position:  [3.1114718]


portfolio before change:  [4.96956439]
curr_Stock_Price:  97.46836361932026
curr_Factors:  [97.46836362]
mat_Sqrt:  [[0.15]]
grads:  [0.03398925]
Stock Position:  0.03398925462831216
Bond Position:  [1.65668736]


portfolio before change:  [4.94350546]
curr_Stock_Price:  96.69863567871225
curr_Factors:  [96.69863568]
mat_Sqrt:  [[0.15]]
grads:  [0.0280804]
Stock Position:  0.02808040411629383
Bond Position:  [2.22816869]


portfolio before change:  [4.93174561]
curr_Stock_Price:  96.27488420237934
curr_Factors:  [96.2748842]
mat_Sqrt:  [[0.15]]
grads:  [0.01583321]
Stock Position:  0.015833214833941428
Bond Position:  [3.40740468]


portfolio before change:  [4.92930816]
curr_Stock_Price:  96.10748822834435
curr_Factors:  [96.10748823]
mat_Sqrt:  [[0.15]]
grads:  [-0.03879573]
Stock Position:  -0.03879572883330568
Bond Position:  [8.65786821]


portfolio before change:  [4.91509343]
curr_Stock_Price:  96.48783596357455
curr_Factors:  [96.48783596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00324483]
Stock Position:  -0.003244827355502247
Bond Position:  [5.2281798]


portfolio before change:  [4.91243175]
curr_Stock_Price:  97.40882418663828
curr_Factors:  [97.40882419]
mat_Sqrt:  [[0.15]]
grads:  [0.01022184]
Stock Position:  0.010221839584847651
Bond Position:  [3.91673438]


portfolio before change:  [4.91177972]
curr_Stock_Price:  97.32108735282299
curr_Factors:  [97.32108735]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296573]
Stock Position:  -0.03296572773853454
Bond Position:  [8.12004019]


portfolio before change:  [4.91422889]
curr_Stock_Price:  97.26218845615371
curr_Factors:  [97.26218846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01869435]
Stock Position:  -0.018694349452712384
Bond Position:  [6.73248223]


portfolio before change:  [4.89438301]
curr_Stock_Price:  98.34629535926956
curr_Factors:  [98.34629536]
mat_Sqrt:  [[0.15]]
grads:  [-0.00084352]
Stock Position:  -0.0008435237037626488
Bond Position:  [4.97734044]


portfolio before change:  [4.89359971]
curr_Stock_Price:  99.64369930371416
curr_Factors:  [99.6436993]
mat_Sqrt:  [[0.15]]
grads:  [-0.03491389]
Stock Position:  -0.03491389118778075
Bond Position:  [8.37254898]


portfolio before change:  [4.9257644]
curr_Stock_Price:  98.73742979565417
curr_Factors:  [98.7374298]
mat_Sqrt:  [[0.15]]
grads:  [-0.11616778]
Stock Position:  -0.11616777767584476
Bond Position:  [16.3958722]


portfolio before change:  [4.83691083]
curr_Stock_Price:  99.51112412156819
curr_Factors:  [99.51112412]
mat_Sqrt:  [[0.15]]
grads:  [-0.08371239]
Stock Position:  -0.08371239213456212
Bond Position:  [13.16722507]


portfolio before change:  [4.82818813]
curr_Stock_Price:  99.62515356672337
curr_Factors:  [99.62515357]
mat_Sqrt:  [[0.15]]
grads:  [0.00726765]
Stock Position:  0.007267653519121449
Bond Position:  [4.10414703]


portfolio before change:  [4.82713424]
curr_Stock_Price:  99.44484682043942
curr_Factors:  [99.44484682]
mat_Sqrt:  [[0.15]]
grads:  [-0.03402574]
Stock Position:  -0.034025738906019426
Bond Position:  [8.21081863]


portfolio before change:  [4.7897565]
curr_Stock_Price:  100.55844290513826
curr_Factors:  [100.55844291]
mat_Sqrt:  [[0.15]]
grads:  [0.1494659]
Stock Position:  0.14946590371173335
Bond Position:  [-10.24030204]


portfolio before change:  [4.85540008]
curr_Stock_Price:  101.00191274230015
curr_Factors:  [101.00191274]
mat_Sqrt:  [[0.15]]
grads:  [-0.05471328]
Stock Position:  -0.054713278589779576
Bond Position:  [10.38154587]


portfolio before change:  [4.86025893]
curr_Stock_Price:  100.92496656597085
curr_Factors:  [100.92496657]
mat_Sqrt:  [[0.15]]
grads:  [0.0588233]
Stock Position:  0.0588233021460462
Bond Position:  [-1.07648088]


portfolio before change:  [4.82256264]
curr_Stock_Price:  100.2852709681149
curr_Factors:  [100.28527097]
mat_Sqrt:  [[0.15]]
grads:  [-0.06879298]
Stock Position:  -0.06879298248740756
Bond Position:  [11.72148553]


portfolio before change:  [4.88702645]
curr_Stock_Price:  99.35885087921389
curr_Factors:  [99.35885088]
mat_Sqrt:  [[0.15]]
grads:  [0.07141947]
Stock Position:  0.07141946950842949
Bond Position:  [-2.20912997]


portfolio before change:  [4.92060805]
curr_Stock_Price:  99.83098651874697
curr_Factors:  [99.83098652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034353]
Stock Position:  -0.05034353234753486
Bond Position:  [9.94645255]


portfolio before change:  [4.92937594]
curr_Stock_Price:  99.66917407499369
curr_Factors:  [99.66917407]
mat_Sqrt:  [[0.15]]
grads:  [0.07390726]
Stock Position:  0.07390725540015469
Bond Position:  [-2.43689917]


portfolio before change:  [4.92349548]
curr_Stock_Price:  99.59166949851341
curr_Factors:  [99.5916695]
mat_Sqrt:  [[0.15]]
grads:  [-0.13422358]
Stock Position:  -0.1342235817178854
Bond Position:  [18.29104607]


portfolio before change:  [4.94111564]
curr_Stock_Price:  99.46891208040638
curr_Factors:  [99.46891208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02850371]
Stock Position:  -0.028503708397063923
Bond Position:  [7.77634851]


portfolio before change:  [4.94579716]
curr_Stock_Price:  99.32172131226989
curr_Factors:  [99.32172131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02433323]
Stock Position:  -0.024333227165038124
Bond Position:  [7.36261517]


portfolio before change:  [4.95736332]
curr_Stock_Price:  98.86530902242488
curr_Factors:  [98.86530902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00046218]
Stock Position:  -0.0004621789866211627
Bond Position:  [5.00305679]


portfolio before change:  [4.95800024]
curr_Stock_Price:  98.16381976446667
curr_Factors:  [98.16381976]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.95800024]
Stock Price:  97.75282182163096
PL:  [4.95800024]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.30298670e-04]
 [ 2.01224017e-03]
 [-9.26608286e-04]
 [ 6.13613688e-03]
 [ 3.16169123e-03]
 [ 2.26196997e-02]
 [ 1.67790879e-03]
 [-9.95426392e-03]
 [ 1.59760013e-02]
 [ 1.83626519e-02]
 [-1.54647584e-02]
 [ 1.97884976e-02]
 [-1.42504660e-02]
 [ 7.40130068e-03]
 [-6.99196703e-03]
 [ 6.37898743e-03]
 [ 7.30814063e-03]
 [-1.17689860e-02]
 [-5.19688128e-04]
 [ 1.52856214e-02]
 [ 1.13866229e-02]
 [-7.69586214e-03]
 [ 6.82002236e-03]
 [ 4.89184782e-02]
 [-1.63105821e-03]
 [ 1.45952053e-02]
 [-5.63964295e-03]
 [ 7.22096309e-03]
 [-8.87023510e-04]
 [-2.47586994e-03]
 [ 4.08252280e-03]
 [-1.12954751e-02]
 [ 2.84256083e-03]
 [ 6.80986964e-03]
 [ 1.14398803e-02]
 [ 8.69623933e-03]
 [-3.37396646e-02]
 [ 9.54747058e-03]
 [ 4.40812834e-03]
 [ 2.02909964e-02]
 [-4.79322606e-03]
 [-2.16652028e-02]
 [ 2.17146082e-02]
 [ 3.09907110e-03]
 [-6.80633923e-03]
 [ 2.06311266e-03]
 [ 1.03899787e-02]
 [-8.70105235e-03]
 [-1.45570708e-02]
 [-7.69939150e-03]
 [ 3.17335560e-02]
 [-8.22015969e-03]
 [ 4.15163038e-04]
 [ 5.32364624e-03]
 [ 5.38818076e-03]
 [-3.56417536e-03]
 [ 4.27163128e-03]
 [-1.24695682e-04]
 [ 1.55521875e-03]
 [-3.65628934e-03]
 [ 1.01902356e-03]
 [-1.16113321e-02]
 [-9.89549379e-04]
 [-1.76576650e-02]
 [-1.26839740e-02]
 [ 1.69284296e-03]
 [-5.35011113e-03]
 [ 2.41646274e-02]
 [-8.82965385e-03]
 [ 6.05355390e-03]
 [-8.39754615e-03]
 [ 1.07022042e-02]
 [-7.38835734e-03]
 [ 9.02956192e-03]
 [-2.11997119e-02]
 [-4.26798927e-03]
 [-6.50257768e-03]
 [-2.06570267e-03]
 [ 1.93208927e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85177122]
curr_Stock_Price:  100.18273277970613
curr_Factors:  [100.18273278]
mat_Sqrt:  [[0.15]]
grads:  [0.00486866]
Stock Position:  0.004868657802308575
Bond Position:  [4.36401578]


portfolio before change:  [4.85088765]
curr_Stock_Price:  99.94522838831215
curr_Factors:  [99.94522839]
mat_Sqrt:  [[0.15]]
grads:  [0.01341493]
Stock Position:  0.01341493447938915
Bond Position:  [3.51012896]


portfolio before change:  [4.84419788]
curr_Stock_Price:  99.43019358389546
curr_Factors:  [99.43019358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617739]
Stock Position:  -0.006177388570667899
Bond Position:  [5.45841682]


portfolio before change:  [4.83763012]
curr_Stock_Price:  100.54861547958185
curr_Factors:  [100.54861548]
mat_Sqrt:  [[0.15]]
grads:  [0.04090758]
Stock Position:  0.04090757921836425
Bond Position:  [0.72442966]


portfolio before change:  [4.82619122]
curr_Stock_Price:  100.26788068099121
curr_Factors:  [100.26788068]
mat_Sqrt:  [[0.15]]
grads:  [0.02107794]
Stock Position:  0.021077941565349968
Bond Position:  [2.71275069]


portfolio before change:  [4.81537518]
curr_Stock_Price:  99.74669209446579
curr_Factors:  [99.74669209]
mat_Sqrt:  [[0.15]]
grads:  [0.150798]
Stock Position:  0.15079799830097376
Bond Position:  [-10.22622632]


portfolio before change:  [4.87896165]
curr_Stock_Price:  100.17259712068117
curr_Factors:  [100.17259712]
mat_Sqrt:  [[0.15]]
grads:  [0.01118606]
Stock Position:  0.011186058609535567
Bond Position:  [3.75842511]


portfolio before change:  [4.88687624]
curr_Stock_Price:  100.85913708368645
curr_Factors:  [100.85913708]
mat_Sqrt:  [[0.15]]
grads:  [-0.06636176]
Stock Position:  -0.06636175943585745
Bond Position:  [11.58006603]


portfolio before change:  [4.95581254]
curr_Stock_Price:  99.83124803966287
curr_Factors:  [99.83124804]
mat_Sqrt:  [[0.15]]
grads:  [0.10650668]
Stock Position:  0.10650667565863836
Bond Position:  [-5.67688182]


portfolio before change:  [4.90384628]
curr_Stock_Price:  99.34666390329903
curr_Factors:  [99.3466639]
mat_Sqrt:  [[0.15]]
grads:  [0.12241768]
Stock Position:  0.12241767915294105
Bond Position:  [-7.25794175]


portfolio before change:  [4.76980937]
curr_Stock_Price:  98.25545487792725
curr_Factors:  [98.25545488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10309839]
Stock Position:  -0.1030983896381564
Bond Position:  [14.89978854]


portfolio before change:  [4.70185806]
curr_Stock_Price:  98.92357953157827
curr_Factors:  [98.92357953]
mat_Sqrt:  [[0.15]]
grads:  [0.13192332]
Stock Position:  0.13192331715278932
Bond Position:  [-8.3484687]


portfolio before change:  [4.66634307]
curr_Stock_Price:  98.65832553522792
curr_Factors:  [98.65832554]
mat_Sqrt:  [[0.15]]
grads:  [-0.09500311]
Stock Position:  -0.09500310641567178
Bond Position:  [14.03919047]


portfolio before change:  [4.65807805]
curr_Stock_Price:  98.7545592533767
curr_Factors:  [98.75455925]
mat_Sqrt:  [[0.15]]
grads:  [0.049342]
Stock Position:  0.04934200452866854
Bond Position:  [-0.21466986]


portfolio before change:  [4.62897922]
curr_Stock_Price:  98.16509368647378
curr_Factors:  [98.16509369]
mat_Sqrt:  [[0.15]]
grads:  [-0.04661311]
Stock Position:  -0.046613113503367255
Bond Position:  [9.20475987]


portfolio before change:  [4.6102634]
curr_Stock_Price:  98.57894999830772
curr_Factors:  [98.57895]
mat_Sqrt:  [[0.15]]
grads:  [0.04252658]
Stock Position:  0.04252658285148206
Bond Position:  [0.41803752]


portfolio before change:  [4.6190374]
curr_Stock_Price:  98.78465351071823
curr_Factors:  [98.78465351]
mat_Sqrt:  [[0.15]]
grads:  [0.04872094]
Stock Position:  0.04872093753180674
Bond Position:  [-0.19384354]


portfolio before change:  [4.64982956]
curr_Stock_Price:  99.41691315559328
curr_Factors:  [99.41691316]
mat_Sqrt:  [[0.15]]
grads:  [-0.07845991]
Stock Position:  -0.07845990640754306
Bond Position:  [12.45007127]


portfolio before change:  [4.63061382]
curr_Stock_Price:  99.67174266177986
curr_Factors:  [99.67174266]
mat_Sqrt:  [[0.15]]
grads:  [-0.00346459]
Stock Position:  -0.0034645875203469815
Bond Position:  [4.97593529]


portfolio before change:  [4.63217147]
curr_Stock_Price:  99.31191629119404
curr_Factors:  [99.31191629]
mat_Sqrt:  [[0.15]]
grads:  [0.10190414]
Stock Position:  0.10190414248924992
Bond Position:  [-5.48812419]


portfolio before change:  [4.679596]
curr_Stock_Price:  99.78066609900534
curr_Factors:  [99.7806661]
mat_Sqrt:  [[0.15]]
grads:  [0.07591082]
Stock Position:  0.07591081951403678
Bond Position:  [-2.89483613]


portfolio before change:  [4.71470953]
curr_Stock_Price:  100.24561253448952
curr_Factors:  [100.24561253]
mat_Sqrt:  [[0.15]]
grads:  [-0.05130575]
Stock Position:  -0.051305747609025294
Bond Position:  [9.85788563]


portfolio before change:  [4.70144842]
curr_Stock_Price:  100.51609400002775
curr_Factors:  [100.516094]
mat_Sqrt:  [[0.15]]
grads:  [0.04546682]
Stock Position:  0.045466815728141284
Bond Position:  [0.13130169]


portfolio before change:  [4.68609553]
curr_Stock_Price:  100.17824119078848
curr_Factors:  [100.17824119]
mat_Sqrt:  [[0.15]]
grads:  [0.32612319]
Stock Position:  0.3261231881298355
Bond Position:  [-27.98435186]


portfolio before change:  [4.70675894]
curr_Stock_Price:  100.2469651685788
curr_Factors:  [100.24696517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01087372]
Stock Position:  -0.010873721425645409
Bond Position:  [5.79681651]


portfolio before change:  [4.70579048]
curr_Stock_Price:  100.36934937257561
curr_Factors:  [100.36934937]
mat_Sqrt:  [[0.15]]
grads:  [0.09730137]
Stock Position:  0.09730136882957324
Bond Position:  [-5.0602846]


portfolio before change:  [4.79710902]
curr_Stock_Price:  101.31111225913233
curr_Factors:  [101.31111226]
mat_Sqrt:  [[0.15]]
grads:  [-0.03759762]
Stock Position:  -0.03759761967194162
Bond Position:  [8.60616569]


portfolio before change:  [4.81057393]
curr_Stock_Price:  100.96728712196816
curr_Factors:  [100.96728712]
mat_Sqrt:  [[0.15]]
grads:  [0.04813975]
Stock Position:  0.04813975394862033
Bond Position:  [-0.04996643]


portfolio before change:  [4.77005765]
curr_Stock_Price:  100.12571339161784
curr_Factors:  [100.12571339]
mat_Sqrt:  [[0.15]]
grads:  [-0.00591349]
Stock Position:  -0.0059134900694046005
Bond Position:  [5.36215007]


portfolio before change:  [4.77182382]
curr_Stock_Price:  99.88372115655861
curr_Factors:  [99.88372116]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165058]
Stock Position:  -0.016505799602152968
Bond Position:  [6.4204845]


portfolio before change:  [4.76707041]
curr_Stock_Price:  100.19601769194014
curr_Factors:  [100.19601769]
mat_Sqrt:  [[0.15]]
grads:  [0.02721682]
Stock Position:  0.027216818668035377
Bond Position:  [2.04005356]


portfolio before change:  [4.76004379]
curr_Stock_Price:  99.93316101805149
curr_Factors:  [99.93316102]
mat_Sqrt:  [[0.15]]
grads:  [-0.07530317]
Stock Position:  -0.07530316760388663
Bond Position:  [12.28532736]


portfolio before change:  [4.74517605]
curr_Stock_Price:  100.14079638041386
curr_Factors:  [100.14079638]
mat_Sqrt:  [[0.15]]
grads:  [0.01895041]
Stock Position:  0.01895040550773349
Bond Position:  [2.84746735]


portfolio before change:  [4.75402948]
curr_Stock_Price:  100.59859463983044
curr_Factors:  [100.59859464]
mat_Sqrt:  [[0.15]]
grads:  [0.04539913]
Stock Position:  0.04539913091147513
Bond Position:  [0.18694072]


portfolio before change:  [4.75128824]
curr_Stock_Price:  100.5379562454691
curr_Factors:  [100.53795625]
mat_Sqrt:  [[0.15]]
grads:  [0.07626587]
Stock Position:  0.0762658687446653
Bond Position:  [-2.91632634]


portfolio before change:  [4.81262689]
curr_Stock_Price:  101.3446201797546
curr_Factors:  [101.34462018]
mat_Sqrt:  [[0.15]]
grads:  [0.05797493]
Stock Position:  0.05797492885097276
Bond Position:  [-1.06282026]


portfolio before change:  [4.8314645]
curr_Stock_Price:  101.67069281148245
curr_Factors:  [101.67069281]
mat_Sqrt:  [[0.15]]
grads:  [-0.2249311]
Stock Position:  -0.22493109714594747
Bond Position:  [27.70036498]


portfolio before change:  [4.79129297]
curr_Stock_Price:  101.85698477998429
curr_Factors:  [101.85698478]
mat_Sqrt:  [[0.15]]
grads:  [0.0636498]
Stock Position:  0.06364980389608044
Bond Position:  [-1.69188414]


portfolio before change:  [4.78199304]
curr_Stock_Price:  101.71253524992646
curr_Factors:  [101.71253525]
mat_Sqrt:  [[0.15]]
grads:  [0.02938752]
Stock Position:  0.029387522259967797
Bond Position:  [1.79291364]


portfolio before change:  [4.79197864]
curr_Stock_Price:  102.04851272771802
curr_Factors:  [102.04851273]
mat_Sqrt:  [[0.15]]
grads:  [0.13527331]
Stock Position:  0.13527330927740427
Bond Position:  [-9.01246138]


portfolio before change:  [4.82700296]
curr_Stock_Price:  102.31159209049255
curr_Factors:  [102.31159209]
mat_Sqrt:  [[0.15]]
grads:  [-0.03195484]
Stock Position:  -0.03195484042266914
Bond Position:  [8.09635356]


portfolio before change:  [4.83817565]
curr_Stock_Price:  101.9777881583259
curr_Factors:  [101.97778816]
mat_Sqrt:  [[0.15]]
grads:  [-0.14443469]
Stock Position:  -0.14443468504472565
Bond Position:  [19.56730536]


portfolio before change:  [4.87861226]
curr_Stock_Price:  101.70629090742791
curr_Factors:  [101.70629091]
mat_Sqrt:  [[0.15]]
grads:  [0.14476405]
Stock Position:  0.14476405494207567
Bond Position:  [-9.84480282]


portfolio before change:  [4.73452531]
curr_Stock_Price:  100.71521870302101
curr_Factors:  [100.7152187]
mat_Sqrt:  [[0.15]]
grads:  [0.02066047]
Stock Position:  0.0206604739874775
Bond Position:  [2.65370116]


portfolio before change:  [4.74503301]
curr_Stock_Price:  101.21578000275385
curr_Factors:  [101.21578]
mat_Sqrt:  [[0.15]]
grads:  [-0.04537559]
Stock Position:  -0.04537559488760338
Bond Position:  [9.33775924]


portfolio before change:  [4.76524114]
curr_Stock_Price:  100.78328977369763
curr_Factors:  [100.78328977]
mat_Sqrt:  [[0.15]]
grads:  [0.01375408]
Stock Position:  0.013754084419867729
Bond Position:  [3.37905926]


portfolio before change:  [4.76777354]
curr_Stock_Price:  100.95205420944394
curr_Factors:  [100.95205421]
mat_Sqrt:  [[0.15]]
grads:  [0.06926652]
Stock Position:  0.06926652453133254
Bond Position:  [-2.2248244]


portfolio before change:  [4.75358597]
curr_Stock_Price:  100.74923604651401
curr_Factors:  [100.74923605]
mat_Sqrt:  [[0.15]]
grads:  [-0.05800702]
Stock Position:  -0.058007015643298035
Bond Position:  [10.59774848]


portfolio before change:  [4.7837947]
curr_Stock_Price:  100.23987787030214
curr_Factors:  [100.23987787]
mat_Sqrt:  [[0.15]]
grads:  [-0.09704714]
Stock Position:  -0.09704713849929694
Bond Position:  [14.51178801]


portfolio before change:  [4.73327294]
curr_Stock_Price:  100.76981394244149
curr_Factors:  [100.76981394]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132928]
Stock Position:  -0.05132927665607388
Bond Position:  [9.90571459]


portfolio before change:  [4.73755154]
curr_Stock_Price:  100.69851976789492
curr_Factors:  [100.69851977]
mat_Sqrt:  [[0.15]]
grads:  [0.21155704]
Stock Position:  0.21155704019722277
Bond Position:  [-16.56592925]


portfolio before change:  [4.69328465]
curr_Stock_Price:  100.49417066958948
curr_Factors:  [100.49417067]
mat_Sqrt:  [[0.15]]
grads:  [-0.05480106]
Stock Position:  -0.05480106457376543
Bond Position:  [10.20047218]


portfolio before change:  [4.68530569]
curr_Stock_Price:  100.65140318466818
curr_Factors:  [100.65140318]
mat_Sqrt:  [[0.15]]
grads:  [0.00276775]
Stock Position:  0.0027677535874017466
Bond Position:  [4.40672741]


portfolio before change:  [4.68554598]
curr_Stock_Price:  100.63870729512323
curr_Factors:  [100.6387073]
mat_Sqrt:  [[0.15]]
grads:  [0.03549097]
Stock Position:  0.03549097493338042
Bond Position:  [1.11378014]


portfolio before change:  [4.67258515]
curr_Stock_Price:  100.27155926927846
curr_Factors:  [100.27155927]
mat_Sqrt:  [[0.15]]
grads:  [0.03592121]
Stock Position:  0.035921205066294745
Bond Position:  [1.07070991]


portfolio before change:  [4.68463001]
curr_Stock_Price:  100.60500966783796
curr_Factors:  [100.60500967]
mat_Sqrt:  [[0.15]]
grads:  [-0.02376117]
Stock Position:  -0.0237611690663354
Bond Position:  [7.07512265]


portfolio before change:  [4.6876248]
curr_Stock_Price:  100.49758318335752
curr_Factors:  [100.49758318]
mat_Sqrt:  [[0.15]]
grads:  [0.02847754]
Stock Position:  0.028477541879627866
Bond Position:  [1.82570067]


portfolio before change:  [4.66977255]
curr_Stock_Price:  99.86668756536241
curr_Factors:  [99.86668757]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008313]
Stock Position:  -0.0008313045465451729
Bond Position:  [4.75279218]


portfolio before change:  [4.67024985]
curr_Stock_Price:  99.64987024508929
curr_Factors:  [99.64987025]
mat_Sqrt:  [[0.15]]
grads:  [0.01036812]
Stock Position:  0.010368124967987476
Bond Position:  [3.63706754]


portfolio before change:  [4.66814871]
curr_Stock_Price:  99.42529134450596
curr_Factors:  [99.42529134]
mat_Sqrt:  [[0.15]]
grads:  [-0.02437526]
Stock Position:  -0.024375262296836543
Bond Position:  [7.09166627]


portfolio before change:  [4.66935807]
curr_Stock_Price:  99.393861234475
curr_Factors:  [99.39386123]
mat_Sqrt:  [[0.15]]
grads:  [0.00679349]
Stock Position:  0.006793490401346142
Bond Position:  [3.99412683]


portfolio before change:  [4.67276028]
curr_Stock_Price:  99.85791773563054
curr_Factors:  [99.85791774]
mat_Sqrt:  [[0.15]]
grads:  [-0.07740888]
Stock Position:  -0.07740888043718619
Bond Position:  [12.40264989]


portfolio before change:  [4.72729509]
curr_Stock_Price:  99.16342869605634
curr_Factors:  [99.1634287]
mat_Sqrt:  [[0.15]]
grads:  [-0.006597]
Stock Position:  -0.00659699585757337
Bond Position:  [5.38147582]


portfolio before change:  [4.7321578]
curr_Stock_Price:  98.47730492266716
curr_Factors:  [98.47730492]
mat_Sqrt:  [[0.15]]
grads:  [-0.11771777]
Stock Position:  -0.11771776668804043
Bond Position:  [16.3246862]


portfolio before change:  [4.72590442]
curr_Stock_Price:  98.53909427487893
curr_Factors:  [98.53909427]
mat_Sqrt:  [[0.15]]
grads:  [-0.08455983]
Stock Position:  -0.08455982645070972
Bond Position:  [13.05835313]


portfolio before change:  [4.60551556]
curr_Stock_Price:  99.97245845871387
curr_Factors:  [99.97245846]
mat_Sqrt:  [[0.15]]
grads:  [0.01128562]
Stock Position:  0.011285619748140793
Bond Position:  [3.47726441]


portfolio before change:  [4.60879595]
curr_Stock_Price:  100.24387021847225
curr_Factors:  [100.24387022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566741]
Stock Position:  -0.035667407516955074
Bond Position:  [8.18423492]


portfolio before change:  [4.62802761]
curr_Stock_Price:  99.71901751736132
curr_Factors:  [99.71901752]
mat_Sqrt:  [[0.15]]
grads:  [0.16109752]
Stock Position:  0.16109751623331464
Bond Position:  [-11.43645843]


portfolio before change:  [4.59528114]
curr_Stock_Price:  99.52018343331329
curr_Factors:  [99.52018343]
mat_Sqrt:  [[0.15]]
grads:  [-0.05886436]
Stock Position:  -0.058864359013632676
Bond Position:  [10.45347294]


portfolio before change:  [4.60555117]
curr_Stock_Price:  99.35681334185907
curr_Factors:  [99.35681334]
mat_Sqrt:  [[0.15]]
grads:  [0.04035703]
Stock Position:  0.04035702600162352
Bond Position:  [0.59580567]


portfolio before change:  [4.60061227]
curr_Stock_Price:  99.23351028898914
curr_Factors:  [99.23351029]
mat_Sqrt:  [[0.15]]
grads:  [-0.05598364]
Stock Position:  -0.05598364101178931
Bond Position:  [10.15606548]


portfolio before change:  [4.5626083]
curr_Stock_Price:  99.9236894117376
curr_Factors:  [99.92368941]
mat_Sqrt:  [[0.15]]
grads:  [0.07134803]
Stock Position:  0.07134802779827915
Bond Position:  [-2.56674987]


portfolio before change:  [4.54992569]
curr_Stock_Price:  99.74818095117645
curr_Factors:  [99.74818095]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925572]
Stock Position:  -0.04925571558374357
Bond Position:  [9.46309372]


portfolio before change:  [4.58619924]
curr_Stock_Price:  99.02375561964615
curr_Factors:  [99.02375562]
mat_Sqrt:  [[0.15]]
grads:  [0.06019708]
Stock Position:  0.06019707945714925
Bond Position:  [-1.37474164]


portfolio before change:  [4.64277819]
curr_Stock_Price:  99.96507828227159
curr_Factors:  [99.96507828]
mat_Sqrt:  [[0.15]]
grads:  [-0.14133141]
Stock Position:  -0.14133141251008943
Bond Position:  [18.77098391]


portfolio before change:  [4.6821737]
curr_Stock_Price:  99.69463393432153
curr_Factors:  [99.69463393]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845326]
Stock Position:  -0.02845326178463953
Bond Position:  [7.51881122]


portfolio before change:  [4.67566588]
curr_Stock_Price:  99.93986973643808
curr_Factors:  [99.93986974]
mat_Sqrt:  [[0.15]]
grads:  [-0.04335052]
Stock Position:  -0.04335051788589288
Bond Position:  [9.00811099]


portfolio before change:  [4.67488741]
curr_Stock_Price:  99.97081494519468
curr_Factors:  [99.97081495]
mat_Sqrt:  [[0.15]]
grads:  [-0.01377135]
Stock Position:  -0.013771351144126951
Bond Position:  [6.05162061]


portfolio before change:  [4.67452207]
curr_Stock_Price:  100.0248100122979
curr_Factors:  [100.02481001]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.67452207]
Stock Price:  100.40968237624504
PL:  [4.26483969]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.76856270e-04]
 [-4.77034541e-04]
 [-4.43817700e-03]
 [-8.95476368e-04]
 [ 3.48803950e-02]
 [ 2.64866823e-02]
 [ 5.22584156e-03]
 [ 2.13288054e-02]
 [ 2.44259243e-02]
 [-1.01042853e-03]
 [ 4.96060713e-02]
 [ 1.35940844e-01]
 [ 1.37590876e-01]
 [ 1.72045419e-02]
 [-6.89265984e-03]
 [ 3.27765589e-02]
 [ 1.23028831e-02]
 [-8.48452396e-03]
 [ 4.48817701e-03]
 [-5.61854972e-03]
 [ 1.40028359e-02]
 [-8.31198844e-03]
 [ 1.09644879e-02]
 [-2.75209914e-02]
 [ 2.83299441e-03]
 [ 7.20514042e-03]
 [-5.07683281e-03]
 [ 1.35332299e-02]
 [ 4.57637577e-02]
 [ 6.00477872e-03]
 [ 1.92413704e-02]
 [ 4.05851601e-04]
 [-1.44800827e-03]
 [ 8.32646904e-03]
 [ 1.03223426e-02]
 [ 7.26056418e-03]
 [-3.24921897e-02]
 [ 8.64788847e-03]
 [ 1.62753101e-02]
 [-1.45504324e-03]
 [-5.25217536e-03]
 [-1.57548750e-02]
 [ 2.03941467e-02]
 [-2.97840971e-03]
 [ 6.03889987e-03]
 [-1.64024718e-02]
 [ 1.41272135e-02]
 [ 3.44702498e-03]
 [ 3.17072687e-03]
 [-7.38875761e-03]
 [-3.15795293e-02]
 [-1.65200854e-03]
 [-1.30868427e-03]
 [ 5.41032327e-03]
 [ 3.54017878e-03]
 [ 6.06576230e-04]
 [ 9.61221755e-03]
 [-5.51762478e-04]
 [ 1.60870444e-03]
 [ 1.46404398e-02]
 [-9.86969334e-04]
 [ 8.00644420e-03]
 [-6.69500096e-03]
 [-1.28725966e-02]
 [ 2.74465928e-03]
 [ 7.40773620e-04]
 [-5.45022483e-03]
 [ 1.50309434e-02]
 [-8.34105268e-03]
 [ 1.06940463e-02]
 [-1.17022283e-02]
 [ 1.18701371e-02]
 [ 1.95850004e-03]
 [ 2.03940299e-02]
 [-2.24870084e-02]
 [-1.41061238e-03]
 [-1.04719090e-02]
 [-2.06081290e-03]
 [ 3.05803760e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.69696095]
curr_Stock_Price:  100.30271616624064
curr_Factors:  [100.30271617]
mat_Sqrt:  [[0.15]]
grads:  [0.00184571]
Stock Position:  0.001845708463776664
Bond Position:  [6.51183138]


portfolio before change:  [6.69875723]
curr_Stock_Price:  101.05542423550428
curr_Factors:  [101.05542424]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318023]
Stock Position:  -0.0031802302720855403
Bond Position:  [7.02013675]


portfolio before change:  [6.69823461]
curr_Stock_Price:  101.35772764933576
curr_Factors:  [101.35772765]
mat_Sqrt:  [[0.15]]
grads:  [-0.02958785]
Stock Position:  -0.02958784666158053
Bond Position:  [9.69719152]


portfolio before change:  [6.67885753]
curr_Stock_Price:  102.03311217685523
curr_Factors:  [102.03311218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00596984]
Stock Position:  -0.005969842455740583
Bond Position:  [7.28797914]


portfolio before change:  [6.67798788]
curr_Stock_Price:  102.25508849401949
curr_Factors:  [102.25508849]
mat_Sqrt:  [[0.15]]
grads:  [0.23253597]
Stock Position:  0.2325359663636512
Bond Position:  [-17.09999794]


portfolio before change:  [6.78660486]
curr_Stock_Price:  102.72678224138744
curr_Factors:  [102.72678224]
mat_Sqrt:  [[0.15]]
grads:  [0.17657788]
Stock Position:  0.17657788168631544
Bond Position:  [-11.35267274]


portfolio before change:  [6.86887339]
curr_Stock_Price:  103.19670576186861
curr_Factors:  [103.19670576]
mat_Sqrt:  [[0.15]]
grads:  [0.03483894]
Stock Position:  0.034838943708690374
Bond Position:  [3.27360917]


portfolio before change:  [6.87789848]
curr_Stock_Price:  103.44988440911828
curr_Factors:  [103.44988441]
mat_Sqrt:  [[0.15]]
grads:  [0.14219204]
Stock Position:  0.14219203578565304
Bond Position:  [-7.83185119]


portfolio before change:  [6.85332798]
curr_Stock_Price:  103.28052896842826
curr_Factors:  [103.28052897]
mat_Sqrt:  [[0.15]]
grads:  [0.1628395]
Stock Position:  0.16283949547695606
Bond Position:  [-9.96482125]


portfolio before change:  [6.93423278]
curr_Stock_Price:  103.78119145307875
curr_Factors:  [103.78119145]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673619]
Stock Position:  -0.006736190172746895
Bond Position:  [7.63332262]


portfolio before change:  [6.93914597]
curr_Stock_Price:  103.12264540464052
curr_Factors:  [103.1226454]
mat_Sqrt:  [[0.15]]
grads:  [0.33070714]
Stock Position:  0.3307071422765561
Bond Position:  [-27.16424939]


portfolio before change:  [7.33938581]
curr_Stock_Price:  104.33803391762657
curr_Factors:  [104.33803392]
mat_Sqrt:  [[0.15]]
grads:  [0.90627229]
Stock Position:  0.9062722903820009
Bond Position:  [-87.21928316]


portfolio before change:  [6.9199414]
curr_Stock_Price:  103.88122524680708
curr_Factors:  [103.88122525]
mat_Sqrt:  [[0.15]]
grads:  [0.91727251]
Stock Position:  0.9172725056414177
Bond Position:  [-88.36745037]


portfolio before change:  [6.56158613]
curr_Stock_Price:  103.49657169410001
curr_Factors:  [103.49657169]
mat_Sqrt:  [[0.15]]
grads:  [0.11469695]
Stock Position:  0.11469694574692761
Bond Position:  [-5.30915454]


portfolio before change:  [6.58684671]
curr_Stock_Price:  103.7197024091448
curr_Factors:  [103.71970241]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595107]
Stock Position:  -0.04595106562702316
Bond Position:  [11.35287756]


portfolio before change:  [6.58111772]
curr_Stock_Price:  103.85982029010972
curr_Factors:  [103.85982029]
mat_Sqrt:  [[0.15]]
grads:  [0.21851039]
Stock Position:  0.21851039254066748
Bond Position:  [-16.11333238]


portfolio before change:  [6.3892746]
curr_Stock_Price:  102.9864704788476
curr_Factors:  [102.98647048]
mat_Sqrt:  [[0.15]]
grads:  [0.08201922]
Stock Position:  0.08201922047676836
Bond Position:  [-2.05759543]


portfolio before change:  [6.37352817]
curr_Stock_Price:  102.79605380355946
curr_Factors:  [102.7960538]
mat_Sqrt:  [[0.15]]
grads:  [-0.05656349]
Stock Position:  -0.05656349308480503
Bond Position:  [12.18803205]


portfolio before change:  [6.39921243]
curr_Stock_Price:  102.35544292116212
curr_Factors:  [102.35544292]
mat_Sqrt:  [[0.15]]
grads:  [0.02992118]
Stock Position:  0.02992118005772388
Bond Position:  [3.3366168]


portfolio before change:  [6.3856705]
curr_Stock_Price:  101.89588632077448
curr_Factors:  [101.89588632]
mat_Sqrt:  [[0.15]]
grads:  [-0.037457]
Stock Position:  -0.0374569981516502
Bond Position:  [10.20238453]


portfolio before change:  [6.37510215]
curr_Stock_Price:  102.19505669912482
curr_Factors:  [102.1950567]
mat_Sqrt:  [[0.15]]
grads:  [0.09335224]
Stock Position:  0.09335223922973371
Bond Position:  [-3.16503523]


portfolio before change:  [6.43186628]
curr_Stock_Price:  102.8052397489162
curr_Factors:  [102.80523975]
mat_Sqrt:  [[0.15]]
grads:  [-0.05541326]
Stock Position:  -0.05541325623750665
Bond Position:  [12.12863937]


portfolio before change:  [6.38986073]
curr_Stock_Price:  103.57696153913714
curr_Factors:  [103.57696154]
mat_Sqrt:  [[0.15]]
grads:  [0.07309659]
Stock Position:  0.07309658582716842
Bond Position:  [-1.18126153]


portfolio before change:  [6.35264186]
curr_Stock_Price:  103.06879783476356
curr_Factors:  [103.06879783]
mat_Sqrt:  [[0.15]]
grads:  [-0.18347328]
Stock Position:  -0.18347327574167618
Bond Position:  [25.26301183]


portfolio before change:  [6.51469533]
curr_Stock_Price:  102.1941501478765
curr_Factors:  [102.19415015]
mat_Sqrt:  [[0.15]]
grads:  [0.01888663]
Stock Position:  0.018886629397417306
Bond Position:  [4.58459229]


portfolio before change:  [6.53283821]
curr_Stock_Price:  103.13959849158151
curr_Factors:  [103.13959849]
mat_Sqrt:  [[0.15]]
grads:  [0.04803427]
Stock Position:  0.048034269466453734
Bond Position:  [1.57860294]


portfolio before change:  [6.54160342]
curr_Stock_Price:  103.32002268243158
curr_Factors:  [103.32002268]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384555]
Stock Position:  -0.03384555206879371
Bond Position:  [10.03852662]


portfolio before change:  [6.54172181]
curr_Stock_Price:  103.33506256490074
curr_Factors:  [103.33506256]
mat_Sqrt:  [[0.15]]
grads:  [0.09022153]
Stock Position:  0.09022153279592202
Bond Position:  [-2.78132593]


portfolio before change:  [6.53696913]
curr_Stock_Price:  103.28431141628752
curr_Factors:  [103.28431142]
mat_Sqrt:  [[0.15]]
grads:  [0.30509172]
Stock Position:  0.3050917177996892
Bond Position:  [-24.97421887]


portfolio before change:  [6.81251877]
curr_Stock_Price:  104.19259756322795
curr_Factors:  [104.19259756]
mat_Sqrt:  [[0.15]]
grads:  [0.04003186]
Stock Position:  0.04003185812253222
Bond Position:  [2.64149549]


portfolio before change:  [6.80732103]
curr_Stock_Price:  104.05863341506078
curr_Factors:  [104.05863342]
mat_Sqrt:  [[0.15]]
grads:  [0.1282758]
Stock Position:  0.1282758029288457
Bond Position:  [-6.54088372]


portfolio before change:  [6.81924789]
curr_Stock_Price:  104.15479863716969
curr_Factors:  [104.15479864]
mat_Sqrt:  [[0.15]]
grads:  [0.00270568]
Stock Position:  0.0027056773388348053
Bond Position:  [6.53743861]


portfolio before change:  [6.81894644]
curr_Stock_Price:  103.89236854308636
curr_Factors:  [103.89236854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965339]
Stock Position:  -0.009653388448144623
Bond Position:  [7.82185983]


portfolio before change:  [6.81975669]
curr_Stock_Price:  103.85907785444643
curr_Factors:  [103.85907785]
mat_Sqrt:  [[0.15]]
grads:  [0.05550979]
Stock Position:  0.055509793612529744
Bond Position:  [1.05456071]


portfolio before change:  [6.80970643]
curr_Stock_Price:  103.67683672964773
curr_Factors:  [103.67683673]
mat_Sqrt:  [[0.15]]
grads:  [0.06881562]
Stock Position:  0.06881561748797003
Bond Position:  [-0.32487911]


portfolio before change:  [6.80605447]
curr_Stock_Price:  103.62406293353568
curr_Factors:  [103.62406293]
mat_Sqrt:  [[0.15]]
grads:  [0.04840376]
Stock Position:  0.0484037611701794
Bond Position:  [1.79026007]


portfolio before change:  [6.82991128]
curr_Stock_Price:  104.11462236433627
curr_Factors:  [104.11462236]
mat_Sqrt:  [[0.15]]
grads:  [-0.2166146]
Stock Position:  -0.2166145982984299
Bond Position:  [29.38265838]


portfolio before change:  [6.63301406]
curr_Stock_Price:  105.03207527029548
curr_Factors:  [105.03207527]
mat_Sqrt:  [[0.15]]
grads:  [0.05765259]
Stock Position:  0.05765258979767318
Bond Position:  [0.57764291]


portfolio before change:  [6.6359441]
curr_Stock_Price:  105.082271361412
curr_Factors:  [105.08227136]
mat_Sqrt:  [[0.15]]
grads:  [0.10850207]
Stock Position:  0.10850206722606316
Bond Position:  [-4.76569957]


portfolio before change:  [6.61906139]
curr_Stock_Price:  104.92941855701018
curr_Factors:  [104.92941856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00970029]
Stock Position:  -0.009700288271185797
Bond Position:  [7.636907]


portfolio before change:  [6.61804566]
curr_Stock_Price:  105.083337031739
curr_Factors:  [105.08333703]
mat_Sqrt:  [[0.15]]
grads:  [-0.0350145]
Stock Position:  -0.03501450239025854
Bond Position:  [10.29748641]


portfolio before change:  [6.63778687]
curr_Stock_Price:  104.53791739882541
curr_Factors:  [104.5379174]
mat_Sqrt:  [[0.15]]
grads:  [-0.1050325]
Stock Position:  -0.10503249985711063
Bond Position:  [17.61766566]


portfolio before change:  [6.63924371]
curr_Stock_Price:  104.53453077359399
curr_Factors:  [104.53453077]
mat_Sqrt:  [[0.15]]
grads:  [0.13596098]
Stock Position:  0.13596097811100863
Bond Position:  [-7.57337334]


portfolio before change:  [6.58429327]
curr_Stock_Price:  104.13384894258577
curr_Factors:  [104.13384894]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985606]
Stock Position:  -0.01985606475359695
Bond Position:  [8.65198172]


portfolio before change:  [6.59100451]
curr_Stock_Price:  103.82308863972038
curr_Factors:  [103.82308864]
mat_Sqrt:  [[0.15]]
grads:  [0.04025933]
Stock Position:  0.04025933244702937
Bond Position:  [2.41115627]


portfolio before change:  [6.59596733]
curr_Stock_Price:  103.94261669763543
curr_Factors:  [103.9426167]
mat_Sqrt:  [[0.15]]
grads:  [-0.10934981]
Stock Position:  -0.10934981182274622
Bond Position:  [17.96207291]


portfolio before change:  [6.7157244]
curr_Stock_Price:  102.85770946772297
curr_Factors:  [102.85770947]
mat_Sqrt:  [[0.15]]
grads:  [0.09418142]
Stock Position:  0.09418142347640573
Bond Position:  [-2.97156109]


portfolio before change:  [6.71336451]
curr_Stock_Price:  102.83462468682092
curr_Factors:  [102.83462469]
mat_Sqrt:  [[0.15]]
grads:  [0.02298017]
Stock Position:  0.0229801665462317
Bond Position:  [4.35020771]


portfolio before change:  [6.72366975]
curr_Stock_Price:  103.27123317307505
curr_Factors:  [103.27123317]
mat_Sqrt:  [[0.15]]
grads:  [0.02113818]
Stock Position:  0.021138179131850364
Bond Position:  [4.54070392]


portfolio before change:  [6.71988779]
curr_Stock_Price:  103.07889127151788
curr_Factors:  [103.07889127]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925838]
Stock Position:  -0.04925838408172905
Bond Position:  [11.79738741]


portfolio before change:  [6.75287386]
curr_Stock_Price:  102.42420664968046
curr_Factors:  [102.42420665]
mat_Sqrt:  [[0.15]]
grads:  [-0.2105302]
Stock Position:  -0.2105301956571309
Bond Position:  [28.31626212]


portfolio before change:  [6.9110546]
curr_Stock_Price:  101.68126844233167
curr_Factors:  [101.68126844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01101339]
Stock Position:  -0.011013390289462712
Bond Position:  [8.0309101]


portfolio before change:  [6.91754153]
curr_Stock_Price:  101.13784068344934
curr_Factors:  [101.13784068]
mat_Sqrt:  [[0.15]]
grads:  [-0.00872456]
Stock Position:  -0.008724561801610667
Bond Position:  [7.79992488]


portfolio before change:  [6.91390284]
curr_Stock_Price:  101.6107813827973
curr_Factors:  [101.61078138]
mat_Sqrt:  [[0.15]]
grads:  [0.03606882]
Stock Position:  0.03606882179233511
Bond Position:  [3.24892168]


portfolio before change:  [6.91083511]
curr_Stock_Price:  101.52009933262734
curr_Factors:  [101.52009933]
mat_Sqrt:  [[0.15]]
grads:  [0.02360119]
Stock Position:  0.023601191854232345
Bond Position:  [4.51483977]


portfolio before change:  [6.92380004]
curr_Stock_Price:  102.05747624452066
curr_Factors:  [102.05747624]
mat_Sqrt:  [[0.15]]
grads:  [0.00404384]
Stock Position:  0.004043841533996328
Bond Position:  [6.51109577]


portfolio before change:  [6.92695125]
curr_Stock_Price:  102.73610311552508
curr_Factors:  [102.73610312]
mat_Sqrt:  [[0.15]]
grads:  [0.06408145]
Stock Position:  0.06408145033582613
Bond Position:  [0.34347276]


portfolio before change:  [6.90338145]
curr_Stock_Price:  102.36795801207255
curr_Factors:  [102.36795801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367842]
Stock Position:  -0.003678416521825968
Bond Position:  [7.27993344]


portfolio before change:  [6.9067103]
curr_Stock_Price:  101.5866864059795
curr_Factors:  [101.58668641]
mat_Sqrt:  [[0.15]]
grads:  [0.0107247]
Stock Position:  0.010724696246096385
Bond Position:  [5.81722395]


portfolio before change:  [6.90754481]
curr_Stock_Price:  101.63059691919484
curr_Factors:  [101.63059692]
mat_Sqrt:  [[0.15]]
grads:  [0.09760293]
Stock Position:  0.09760293181731719
Bond Position:  [-3.01189941]


portfolio before change:  [6.91432985]
curr_Stock_Price:  101.7020423300296
curr_Factors:  [101.70204233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0065798]
Stock Position:  -0.006579795560746315
Bond Position:  [7.58350849]


portfolio before change:  [6.91106094]
curr_Stock_Price:  102.27088825653092
curr_Factors:  [102.27088826]
mat_Sqrt:  [[0.15]]
grads:  [0.05337629]
Stock Position:  0.05337629469838494
Bond Position:  [1.45221987]


portfolio before change:  [6.84996911]
curr_Stock_Price:  101.12463796418214
curr_Factors:  [101.12463796]
mat_Sqrt:  [[0.15]]
grads:  [-0.04463334]
Stock Position:  -0.04463333975376739
Bond Position:  [11.36349944]


portfolio before change:  [6.83847306]
curr_Stock_Price:  101.39811727273896
curr_Factors:  [101.39811727]
mat_Sqrt:  [[0.15]]
grads:  [-0.08581731]
Stock Position:  -0.08581731087306226
Bond Position:  [15.54018681]


portfolio before change:  [6.72256876]
curr_Stock_Price:  102.76002885770494
curr_Factors:  [102.76002886]
mat_Sqrt:  [[0.15]]
grads:  [0.01829773]
Stock Position:  0.018297728523521198
Bond Position:  [4.84229365]


portfolio before change:  [6.71497588]
curr_Stock_Price:  102.32852514161925
curr_Factors:  [102.32852514]
mat_Sqrt:  [[0.15]]
grads:  [0.00493849]
Stock Position:  0.004938490799346977
Bond Position:  [6.2096274]


portfolio before change:  [6.71369341]
curr_Stock_Price:  101.99024789451715
curr_Factors:  [101.99024789]
mat_Sqrt:  [[0.15]]
grads:  [-0.03633483]
Stock Position:  -0.03633483217236759
Bond Position:  [10.41949195]


portfolio before change:  [6.67587619]
curr_Stock_Price:  103.04896918709896
curr_Factors:  [103.04896919]
mat_Sqrt:  [[0.15]]
grads:  [0.10020629]
Stock Position:  0.10020628923418289
Bond Position:  [-3.65027862]


portfolio before change:  [6.70230267]
curr_Stock_Price:  103.31496678061829
curr_Factors:  [103.31496678]
mat_Sqrt:  [[0.15]]
grads:  [-0.05560702]
Stock Position:  -0.05560701784171565
Bond Position:  [12.44733987]


portfolio before change:  [6.76554887]
curr_Stock_Price:  102.19157957513472
curr_Factors:  [102.19157958]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-0.52006103]


portfolio before change:  [6.77794817]
curr_Stock_Price:  102.36595420672039
curr_Factors:  [102.36595421]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801486]
Stock Position:  -0.07801485560991891
Bond Position:  [14.7640133]


portfolio before change:  [6.79741404]
curr_Stock_Price:  102.12826743318828
curr_Factors:  [102.12826743]
mat_Sqrt:  [[0.15]]
grads:  [0.07913425]
Stock Position:  0.07913424742820867
Bond Position:  [-1.28442954]


portfolio before change:  [6.86905811]
curr_Stock_Price:  103.03463031359553
curr_Factors:  [103.03463031]
mat_Sqrt:  [[0.15]]
grads:  [0.01305667]
Stock Position:  0.01305666694327084
Bond Position:  [5.52376926]


portfolio before change:  [6.86013038]
curr_Stock_Price:  102.32442005757903
curr_Factors:  [102.32442006]
mat_Sqrt:  [[0.15]]
grads:  [0.1359602]
Stock Position:  0.13596019936173323
Bond Position:  [-7.05191817]


portfolio before change:  [6.94269441]
curr_Stock_Price:  102.9349280886565
curr_Factors:  [102.93492809]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991339]
Stock Position:  -0.14991338909710136
Bond Position:  [22.37401834]


portfolio before change:  [7.01050097]
curr_Stock_Price:  102.49195139650978
curr_Factors:  [102.4919514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00940408]
Stock Position:  -0.009404082524636405
Bond Position:  [7.97434374]


portfolio before change:  [7.01533449]
curr_Stock_Price:  102.03096998134656
curr_Factors:  [102.03096998]
mat_Sqrt:  [[0.15]]
grads:  [-0.06981273]
Stock Position:  -0.06981272647404314
Bond Position:  [14.13839469]


portfolio before change:  [7.0045522]
curr_Stock_Price:  102.19807363647416
curr_Factors:  [102.19807364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01373875]
Stock Position:  -0.013738752664016824
Bond Position:  [8.40862626]


portfolio before change:  [6.99673226]
curr_Stock_Price:  102.80551614153441
curr_Factors:  [102.80551614]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.99673226]
Stock Price:  102.55470594935433
PL:  [4.44202631]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.93503821e-04]
 [ 2.14653579e-03]
 [-1.57902493e-03]
 [ 6.37118638e-03]
 [ 2.85638022e-03]
 [ 2.35252707e-02]
 [ 9.01405480e-04]
 [-1.84092386e-02]
 [ 1.99573668e-02]
 [-3.64383396e-03]
 [ 1.59186463e-02]
 [-4.32024801e-02]
 [ 4.31220381e-02]
 [ 2.97187819e-03]
 [-6.91124727e-03]
 [ 1.55016716e-02]
 [ 7.97726466e-03]
 [-1.21523581e-02]
 [-3.48284842e-04]
 [ 1.49288610e-02]
 [ 1.19597214e-02]
 [-9.19979354e-03]
 [ 5.59662266e-03]
 [-1.35419772e-02]
 [-9.78004128e-03]
 [-4.51535843e-03]
 [-2.60650620e-04]
 [ 1.09650484e-02]
 [-2.91338803e-02]
 [ 1.71207993e-03]
 [ 2.57737116e-03]
 [-1.02560679e-02]
 [-8.77946377e-03]
 [ 5.50840208e-03]
 [ 1.35902056e-02]
 [ 1.39312258e-02]
 [-3.43203860e-02]
 [ 8.55233037e-03]
 [-3.28422600e-02]
 [ 6.00553386e-03]
 [-1.30345658e-02]
 [ 4.36559193e-02]
 [ 2.33066096e-02]
 [ 3.90289104e-03]
 [ 7.28737535e-03]
 [ 2.02985829e-02]
 [-2.99414402e-03]
 [-1.04567338e-03]
 [ 2.49855622e-02]
 [ 5.53932633e-03]
 [ 3.05623831e-02]
 [ 1.15184289e-02]
 [ 1.78072837e-04]
 [ 4.61315474e-03]
 [ 3.75998536e-03]
 [ 4.25613338e-03]
 [-1.59244448e-02]
 [ 6.73475080e-04]
 [ 1.60216417e-03]
 [-8.80291314e-02]
 [-1.55708889e-02]
 [ 1.76809120e-02]
 [ 1.70348228e-02]
 [-1.95489054e-02]
 [-3.69481057e-03]
 [-1.81152948e-02]
 [-4.48897205e-03]
 [-7.38259451e-04]
 [-2.06957353e-02]
 [ 1.58266111e-02]
 [ 1.24039946e-02]
 [ 1.29769676e-02]
 [ 2.36746428e-03]
 [ 4.67846378e-03]
 [ 2.37461663e-02]
 [-2.25823496e-02]
 [ 4.58759958e-03]
 [ 9.61484161e-03]
 [ 5.24720820e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.40842947]
curr_Stock_Price:  100.21892945937594
curr_Factors:  [100.21892946]
mat_Sqrt:  [[0.15]]
grads:  [0.00395669]
Stock Position:  0.003956692137516823
Bond Position:  [5.01189402]


portfolio before change:  [5.41030931]
curr_Stock_Price:  100.6148638483079
curr_Factors:  [100.61486385]
mat_Sqrt:  [[0.15]]
grads:  [0.01431024]
Stock Position:  0.014310238584602512
Bond Position:  [3.9704866]


portfolio before change:  [5.40774265]
curr_Stock_Price:  100.41816357276528
curr_Factors:  [100.41816357]
mat_Sqrt:  [[0.15]]
grads:  [-0.01052683]
Stock Position:  -0.010526832882005698
Bond Position:  [6.46482787]


portfolio before change:  [5.40746862]
curr_Stock_Price:  100.48257911906018
curr_Factors:  [100.48257912]
mat_Sqrt:  [[0.15]]
grads:  [0.04247458]
Stock Position:  0.042474575888909454
Bond Position:  [1.13951369]


portfolio before change:  [5.40159724]
curr_Stock_Price:  100.34266949501384
curr_Factors:  [100.3426695]
mat_Sqrt:  [[0.15]]
grads:  [0.01904253]
Stock Position:  0.019042534787058626
Bond Position:  [3.49081846]


portfolio before change:  [5.39321245]
curr_Stock_Price:  99.89089276726409
curr_Factors:  [99.89089277]
mat_Sqrt:  [[0.15]]
grads:  [0.15683514]
Stock Position:  0.15683513801045476
Bond Position:  [-10.27318951]


portfolio before change:  [5.38864123]
curr_Stock_Price:  99.86584022691125
curr_Factors:  [99.86584023]
mat_Sqrt:  [[0.15]]
grads:  [0.00600937]
Stock Position:  0.006009369868601797
Bond Position:  [4.78851046]


portfolio before change:  [5.38774799]
curr_Stock_Price:  99.66739500142354
curr_Factors:  [99.667395]
mat_Sqrt:  [[0.15]]
grads:  [-0.12272826]
Stock Position:  -0.12272825740049334
Bond Position:  [17.6197537]


portfolio before change:  [5.34244917]
curr_Stock_Price:  100.04546684686335
curr_Factors:  [100.04546685]
mat_Sqrt:  [[0.15]]
grads:  [0.13304911]
Stock Position:  0.13304911232185798
Bond Position:  [-7.96851139]


portfolio before change:  [5.33940707]
curr_Stock_Price:  100.02634571936056
curr_Factors:  [100.02634572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02429223]
Stock Position:  -0.024292226372842823
Bond Position:  [7.7692697]


portfolio before change:  [5.32300566]
curr_Stock_Price:  100.72150647988066
curr_Factors:  [100.72150648]
mat_Sqrt:  [[0.15]]
grads:  [0.10612431]
Stock Position:  0.1061243086872387
Bond Position:  [-5.36599458]


portfolio before change:  [5.37378494]
curr_Stock_Price:  101.20315545188281
curr_Factors:  [101.20315545]
mat_Sqrt:  [[0.15]]
grads:  [-0.28801653]
Stock Position:  -0.2880165342007272
Bond Position:  [34.52196702]


portfolio before change:  [5.30040636]
curr_Stock_Price:  101.465419127162
curr_Factors:  [101.46541913]
mat_Sqrt:  [[0.15]]
grads:  [0.28748025]
Stock Position:  0.2874802543202277
Bond Position:  [-23.86889814]


portfolio before change:  [5.20395699]
curr_Stock_Price:  101.13510943232838
curr_Factors:  [101.13510943]
mat_Sqrt:  [[0.15]]
grads:  [0.01981252]
Stock Position:  0.019812521265908035
Bond Position:  [3.20021548]


portfolio before change:  [5.19807071]
curr_Stock_Price:  100.82791493437045
curr_Factors:  [100.82791493]
mat_Sqrt:  [[0.15]]
grads:  [-0.04607498]
Stock Position:  -0.04607498179872534
Bond Position:  [9.84371505]


portfolio before change:  [5.21385761]
curr_Stock_Price:  100.49863312917381
curr_Factors:  [100.49863313]
mat_Sqrt:  [[0.15]]
grads:  [0.10334448]
Stock Position:  0.10334447759522597
Bond Position:  [-5.17212113]


portfolio before change:  [5.18993905]
curr_Stock_Price:  100.27031615248318
curr_Factors:  [100.27031615]
mat_Sqrt:  [[0.15]]
grads:  [0.05318176]
Stock Position:  0.05318176439609972
Bond Position:  [-0.14261328]


portfolio before change:  [5.19477982]
curr_Stock_Price:  100.36150692870825
curr_Factors:  [100.36150693]
mat_Sqrt:  [[0.15]]
grads:  [-0.08101572]
Stock Position:  -0.08101572074418542
Bond Position:  [13.32563964]


portfolio before change:  [5.29035571]
curr_Stock_Price:  99.19206712007347
curr_Factors:  [99.19206712]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023219]
Stock Position:  -0.0023218989494716916
Bond Position:  [5.52066966]


portfolio before change:  [5.2906038]
curr_Stock_Price:  99.23382672128335
curr_Factors:  [99.23382672]
mat_Sqrt:  [[0.15]]
grads:  [0.09952574]
Stock Position:  0.0995257399617028
Bond Position:  [-4.58571623]


portfolio before change:  [5.23012084]
curr_Stock_Price:  98.62899486648301
curr_Factors:  [98.62899487]
mat_Sqrt:  [[0.15]]
grads:  [0.07973148]
Stock Position:  0.0797314761594966
Bond Position:  [-2.63371451]


portfolio before change:  [5.20564493]
curr_Stock_Price:  98.32408012094851
curr_Factors:  [98.32408012]
mat_Sqrt:  [[0.15]]
grads:  [-0.06133196]
Stock Position:  -0.06133195690608907
Bond Position:  [11.23605317]


portfolio before change:  [5.23820001]
curr_Stock_Price:  97.80472920690356
curr_Factors:  [97.80472921]
mat_Sqrt:  [[0.15]]
grads:  [0.03731082]
Stock Position:  0.03731081776629497
Bond Position:  [1.58902558]


portfolio before change:  [5.22474489]
curr_Stock_Price:  97.44144487590295
curr_Factors:  [97.44144488]
mat_Sqrt:  [[0.15]]
grads:  [-0.09027985]
Stock Position:  -0.0902798477589296
Bond Position:  [14.0217437]


portfolio before change:  [5.21042622]
curr_Stock_Price:  97.6097555552856
curr_Factors:  [97.60975556]
mat_Sqrt:  [[0.15]]
grads:  [-0.06520028]
Stock Position:  -0.0652002751991173
Bond Position:  [11.57460914]


portfolio before change:  [5.24768793]
curr_Stock_Price:  97.04935489344838
curr_Factors:  [97.04935489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03010239]
Stock Position:  -0.030102389505866772
Bond Position:  [8.16910541]


portfolio before change:  [5.26159111]
curr_Stock_Price:  96.60445365349895
curr_Factors:  [96.60445365]
mat_Sqrt:  [[0.15]]
grads:  [-0.00173767]
Stock Position:  -0.0017376707989782854
Bond Position:  [5.42945785]


portfolio before change:  [5.26244019]
curr_Stock_Price:  96.3111112331618
curr_Factors:  [96.31111123]
mat_Sqrt:  [[0.15]]
grads:  [0.07310032]
Stock Position:  0.07310032268221983
Bond Position:  [-1.77793312]


portfolio before change:  [5.3326856]
curr_Stock_Price:  97.27357666928366
curr_Factors:  [97.27357667]
mat_Sqrt:  [[0.15]]
grads:  [-0.19422587]
Stock Position:  -0.19422586838799794
Bond Position:  [24.2257305]


portfolio before change:  [5.27890452]
curr_Stock_Price:  97.55827221980581
curr_Factors:  [97.55827222]
mat_Sqrt:  [[0.15]]
grads:  [0.01141387]
Stock Position:  0.011413866213114769
Bond Position:  [4.16538745]


portfolio before change:  [5.27707765]
curr_Stock_Price:  97.37540637408445
curr_Factors:  [97.37540637]
mat_Sqrt:  [[0.15]]
grads:  [0.01718247]
Stock Position:  0.017182474406768265
Bond Position:  [3.60392723]


portfolio before change:  [5.26633831]
curr_Stock_Price:  96.73727943963212
curr_Factors:  [96.73727944]
mat_Sqrt:  [[0.15]]
grads:  [-0.06837379]
Stock Position:  -0.06837378579403058
Bond Position:  [11.88063233]


portfolio before change:  [5.22382863]
curr_Stock_Price:  97.36986450115096
curr_Factors:  [97.3698645]
mat_Sqrt:  [[0.15]]
grads:  [-0.05852976]
Stock Position:  -0.05852975846983483
Bond Position:  [10.92286329]


portfolio before change:  [5.23030013]
curr_Stock_Price:  97.27096101228393
curr_Factors:  [97.27096101]
mat_Sqrt:  [[0.15]]
grads:  [0.03672268]
Stock Position:  0.03672268053947099
Bond Position:  [1.65824971]


portfolio before change:  [5.24037859]
curr_Stock_Price:  97.54258640248194
curr_Factors:  [97.5425864]
mat_Sqrt:  [[0.15]]
grads:  [0.09060137]
Stock Position:  0.09060137046864944
Bond Position:  [-3.59711342]


portfolio before change:  [5.2208395]
curr_Stock_Price:  97.32940787502623
curr_Factors:  [97.32940788]
mat_Sqrt:  [[0.15]]
grads:  [0.09287484]
Stock Position:  0.09287483841956852
Bond Position:  [-3.81861353]


portfolio before change:  [5.24527064]
curr_Stock_Price:  97.5950321896182
curr_Factors:  [97.59503219]
mat_Sqrt:  [[0.15]]
grads:  [-0.22880257]
Stock Position:  -0.22880257359803477
Bond Position:  [27.57526517]


portfolio before change:  [5.32981544]
curr_Stock_Price:  97.23305508369351
curr_Factors:  [97.23305508]
mat_Sqrt:  [[0.15]]
grads:  [0.05701554]
Stock Position:  0.0570155358271181
Bond Position:  [-0.21397929]


portfolio before change:  [5.29041736]
curr_Stock_Price:  96.54228352642146
curr_Factors:  [96.54228353]
mat_Sqrt:  [[0.15]]
grads:  [-0.2189484]
Stock Position:  -0.2189483997845308
Bond Position:  [26.42819585]


portfolio before change:  [5.39070409]
curr_Stock_Price:  96.09178962084988
curr_Factors:  [96.09178962]
mat_Sqrt:  [[0.15]]
grads:  [0.04003689]
Stock Position:  0.04003689239373045
Bond Position:  [1.54348745]


portfolio before change:  [5.38492086]
curr_Stock_Price:  95.94493260014013
curr_Factors:  [95.9449326]
mat_Sqrt:  [[0.15]]
grads:  [-0.08689711]
Stock Position:  -0.08689710519335742
Bond Position:  [13.72225776]


portfolio before change:  [5.39412582]
curr_Stock_Price:  95.8488731842929
curr_Factors:  [95.84887318]
mat_Sqrt:  [[0.15]]
grads:  [0.29103946]
Stock Position:  0.2910394620456192
Bond Position:  [-22.50167867]


portfolio before change:  [5.36362706]
curr_Stock_Price:  95.74891301838494
curr_Factors:  [95.74891302]
mat_Sqrt:  [[0.15]]
grads:  [0.1553774]
Stock Position:  0.15537739766272501
Bond Position:  [-9.51358987]


portfolio before change:  [5.40787]
curr_Stock_Price:  96.03748496921354
curr_Factors:  [96.03748497]
mat_Sqrt:  [[0.15]]
grads:  [0.02601927]
Stock Position:  0.02601927360539047
Bond Position:  [2.90904441]


portfolio before change:  [5.39483959]
curr_Stock_Price:  95.52969849878768
curr_Factors:  [95.5296985]
mat_Sqrt:  [[0.15]]
grads:  [0.0485825]
Stock Position:  0.04858250231969117
Bond Position:  [0.75376779]


portfolio before change:  [5.37088617]
curr_Stock_Price:  95.03568249016604
curr_Factors:  [95.03568249]
mat_Sqrt:  [[0.15]]
grads:  [0.13532389]
Stock Position:  0.13532388570683562
Bond Position:  [-7.48971167]


portfolio before change:  [5.28063773]
curr_Stock_Price:  94.37223484193069
curr_Factors:  [94.37223484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996096]
Stock Position:  -0.019960960123167247
Bond Position:  [7.16439815]


portfolio before change:  [5.28965306]
curr_Stock_Price:  93.94301997481718
curr_Factors:  [93.94301997]
mat_Sqrt:  [[0.15]]
grads:  [-0.00697116]
Stock Position:  -0.006971155886831513
Bond Position:  [5.9445445]


portfolio before change:  [5.28945468]
curr_Stock_Price:  94.02477487556668
curr_Factors:  [94.02477488]
mat_Sqrt:  [[0.15]]
grads:  [0.16657041]
Stock Position:  0.16657041470796535
Bond Position:  [-10.37229106]


portfolio before change:  [5.46854583]
curr_Stock_Price:  95.10383466737736
curr_Factors:  [95.10383467]
mat_Sqrt:  [[0.15]]
grads:  [0.03692884]
Stock Position:  0.03692884219720762
Bond Position:  [1.95647133]


portfolio before change:  [5.44567007]
curr_Stock_Price:  94.48106819762954
curr_Factors:  [94.4810682]
mat_Sqrt:  [[0.15]]
grads:  [0.20374922]
Stock Position:  0.20374922096107811
Bond Position:  [-13.80477397]


portfolio before change:  [5.37837943]
curr_Stock_Price:  94.15504087998491
curr_Factors:  [94.15504088]
mat_Sqrt:  [[0.15]]
grads:  [0.07678953]
Stock Position:  0.07678952581872787
Bond Position:  [-1.85174151]


portfolio before change:  [5.40017494]
curr_Stock_Price:  94.44038244304733
curr_Factors:  [94.44038244]
mat_Sqrt:  [[0.15]]
grads:  [0.00118715]
Stock Position:  0.0011871522498496396
Bond Position:  [5.28805983]


portfolio before change:  [5.40102463]
curr_Stock_Price:  94.87771481737214
curr_Factors:  [94.87771482]
mat_Sqrt:  [[0.15]]
grads:  [0.03075436]
Stock Position:  0.030754364930238913
Bond Position:  [2.48312077]


portfolio before change:  [5.40145269]
curr_Stock_Price:  94.88658714851762
curr_Factors:  [94.88658715]
mat_Sqrt:  [[0.15]]
grads:  [0.02506657]
Stock Position:  0.02506656909142122
Bond Position:  [3.0229715]


portfolio before change:  [5.39764009]
curr_Stock_Price:  94.72695026025372
curr_Factors:  [94.72695026]
mat_Sqrt:  [[0.15]]
grads:  [0.02837422]
Stock Position:  0.028374222514534846
Bond Position:  [2.70983652]


portfolio before change:  [5.3928824]
curr_Stock_Price:  94.55330473326596
curr_Factors:  [94.55330473]
mat_Sqrt:  [[0.15]]
grads:  [-0.10616297]
Stock Position:  -0.10616296532494829
Bond Position:  [15.43094161]


portfolio before change:  [5.48422626]
curr_Stock_Price:  93.70197772065251
curr_Factors:  [93.70197772]
mat_Sqrt:  [[0.15]]
grads:  [0.00448983]
Stock Position:  0.004489833863726897
Bond Position:  [5.06351995]


portfolio before change:  [5.48689041]
curr_Stock_Price:  94.22486346017709
curr_Factors:  [94.22486346]
mat_Sqrt:  [[0.15]]
grads:  [0.01068109]
Stock Position:  0.010681094446771308
Bond Position:  [4.48046575]


portfolio before change:  [5.4853068]
curr_Stock_Price:  94.05038219791007
curr_Factors:  [94.0503822]
mat_Sqrt:  [[0.15]]
grads:  [-0.58686088]
Stock Position:  -0.5868608758526724
Bond Position:  [60.67979647]


portfolio before change:  [6.01208157]
curr_Stock_Price:  93.15923033457891
curr_Factors:  [93.15923033]
mat_Sqrt:  [[0.15]]
grads:  [-0.10380593]
Stock Position:  -0.10380592616550793
Bond Position:  [15.68256176]


portfolio before change:  [5.95194609]
curr_Stock_Price:  93.74797972669326
curr_Factors:  [93.74797973]
mat_Sqrt:  [[0.15]]
grads:  [0.11787275]
Stock Position:  0.11787274692987046
Bond Position:  [-5.0983858]


portfolio before change:  [5.98737544]
curr_Stock_Price:  94.05125606163185
curr_Factors:  [94.05125606]
mat_Sqrt:  [[0.15]]
grads:  [0.11356549]
Stock Position:  0.11356548541245094
Bond Position:  [-4.69360111]


portfolio before change:  [5.99813254]
curr_Stock_Price:  94.1485607477956
curr_Factors:  [94.14856075]
mat_Sqrt:  [[0.15]]
grads:  [-0.13032604]
Stock Position:  -0.13032603631547995
Bond Position:  [18.26814128]


portfolio before change:  [5.86768737]
curr_Stock_Price:  95.1582359011239
curr_Factors:  [95.1582359]
mat_Sqrt:  [[0.15]]
grads:  [-0.02463207]
Stock Position:  -0.024632070456170076
Bond Position:  [8.21163174]


portfolio before change:  [5.86327998]
curr_Stock_Price:  95.35800109936233
curr_Factors:  [95.3580011]
mat_Sqrt:  [[0.15]]
grads:  [-0.12076863]
Stock Position:  -0.12076863231126815
Bond Position:  [17.37953535]


portfolio before change:  [5.81505626]
curr_Stock_Price:  95.76630229148473
curr_Factors:  [95.76630229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02992648]
Stock Position:  -0.029926480343373838
Bond Position:  [8.68100462]


portfolio before change:  [5.85699473]
curr_Stock_Price:  94.38304942625942
curr_Factors:  [94.38304943]
mat_Sqrt:  [[0.15]]
grads:  [-0.00492173]
Stock Position:  -0.0049217296754734685
Bond Position:  [6.32152258]


portfolio before change:  [5.86359263]
curr_Stock_Price:  93.12276261315829
curr_Factors:  [93.12276261]
mat_Sqrt:  [[0.15]]
grads:  [-0.13797157]
Stock Position:  -0.13797156835243093
Bond Position:  [18.71188624]


portfolio before change:  [5.84613363]
curr_Stock_Price:  93.25777972884073
curr_Factors:  [93.25777973]
mat_Sqrt:  [[0.15]]
grads:  [0.10551074]
Stock Position:  0.10551074066353408
Bond Position:  [-3.99356378]


portfolio before change:  [5.8300848]
curr_Stock_Price:  93.10803925568442
curr_Factors:  [93.10803926]
mat_Sqrt:  [[0.15]]
grads:  [0.0826933]
Stock Position:  0.0826932976030597
Bond Position:  [-1.869326]


portfolio before change:  [5.81081175]
curr_Stock_Price:  92.87638545362107
curr_Factors:  [92.87638545]
mat_Sqrt:  [[0.15]]
grads:  [0.08651312]
Stock Position:  0.08651311759608044
Bond Position:  [-2.22421391]


portfolio before change:  [5.80448152]
curr_Stock_Price:  92.80482160404972
curr_Factors:  [92.8048216]
mat_Sqrt:  [[0.15]]
grads:  [0.0157831]
Stock Position:  0.01578309519619696
Bond Position:  [4.33973418]


portfolio before change:  [5.81330535]
curr_Stock_Price:  93.3467046838202
curr_Factors:  [93.34670468]
mat_Sqrt:  [[0.15]]
grads:  [0.03118976]
Stock Position:  0.031189758548437647
Bond Position:  [2.90184417]


portfolio before change:  [5.79034613]
curr_Stock_Price:  92.60477535270107
curr_Factors:  [92.60477535]
mat_Sqrt:  [[0.15]]
grads:  [0.15830778]
Stock Position:  0.15830777527191334
Bond Position:  [-8.86970984]


portfolio before change:  [5.89431541]
curr_Stock_Price:  93.2650313666188
curr_Factors:  [93.26503137]
mat_Sqrt:  [[0.15]]
grads:  [-0.150549]
Stock Position:  -0.1505489972688456
Bond Position:  [19.93527237]


portfolio before change:  [6.04554265]
curr_Stock_Price:  92.26880257177729
curr_Factors:  [92.26880257]
mat_Sqrt:  [[0.15]]
grads:  [0.030584]
Stock Position:  0.030583997227739055
Bond Position:  [3.22359385]


portfolio before change:  [6.05494419]
curr_Stock_Price:  92.56961531053688
curr_Factors:  [92.56961531]
mat_Sqrt:  [[0.15]]
grads:  [0.06409894]
Stock Position:  0.06409894409590666
Bond Position:  [0.12132959]


portfolio before change:  [6.06644028]
curr_Stock_Price:  92.74884622417476
curr_Factors:  [92.74884622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.06644028]
Stock Price:  92.69535692709209
PL:  [6.06644028]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.42415401e-04]
 [ 1.00643699e-03]
 [-2.86613831e-03]
 [ 8.38741796e-03]
 [ 2.02065260e-03]
 [ 2.20787296e-02]
 [ 1.37751468e-03]
 [-1.63619784e-02]
 [ 2.33072320e-02]
 [-8.04294831e-04]
 [ 1.30235534e-02]
 [ 6.25494111e-03]
 [-4.12113092e-03]
 [ 1.23815188e-02]
 [-6.91553058e-03]
 [ 2.07655317e-02]
 [ 1.02021311e-02]
 [-1.07825941e-02]
 [-4.87115772e-04]
 [ 4.85127383e-03]
 [ 1.22130560e-02]
 [-4.91045744e-03]
 [ 7.22175244e-03]
 [ 1.66089846e-02]
 [ 1.58665463e-03]
 [ 1.13084348e-02]
 [-6.01839321e-03]
 [ 8.73742125e-03]
 [ 1.18856583e-02]
 [-2.32001380e-03]
 [-6.41709011e-03]
 [-1.03218356e-02]
 [-8.82375402e-03]
 [ 5.10843623e-03]
 [ 1.34545843e-02]
 [ 1.38179549e-02]
 [-3.43230430e-02]
 [ 8.68129575e-03]
 [-2.41919553e-02]
 [ 2.16495651e-02]
 [-4.88587679e-03]
 [ 3.09077254e-03]
 [ 2.30418805e-02]
 [ 4.46719085e-03]
 [ 3.76503150e-03]
 [ 6.15428303e-03]
 [ 1.11057247e-03]
 [-1.20129274e-02]
 [ 1.47621759e-03]
 [ 3.24019328e-03]
 [ 3.43626543e-02]
 [ 1.51758539e-03]
 [ 1.34296159e-03]
 [ 4.74033942e-03]
 [ 3.44783020e-03]
 [ 3.42256747e-03]
 [-1.19281101e-02]
 [ 1.29268336e-04]
 [ 1.59212368e-03]
 [-4.83500097e-02]
 [-1.08811965e-02]
 [ 1.78463481e-02]
 [ 1.75666988e-02]
 [-1.96712000e-02]
 [-4.18176809e-03]
 [-1.99860279e-02]
 [-4.23984007e-03]
 [ 5.38566059e-03]
 [-1.49716181e-02]
 [ 1.11090891e-02]
 [ 3.81984387e-03]
 [ 1.17808990e-02]
 [ 3.63277513e-04]
 [ 3.50431241e-03]
 [-7.03539767e-03]
 [-8.09339263e-03]
 [ 1.94841576e-03]
 [ 2.94512681e-03]
 [-8.82415668e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.88771193]
curr_Stock_Price:  100.51019461711248
curr_Factors:  [100.51019462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00228277]
Stock Position:  -0.0022827693425361987
Bond Position:  [10.11715352]


portfolio before change:  [9.88753744]
curr_Stock_Price:  100.86363697782625
curr_Factors:  [100.86363698]
mat_Sqrt:  [[0.15]]
grads:  [0.00670958]
Stock Position:  0.006709579955035214
Bond Position:  [9.2107848]


portfolio before change:  [9.88646656]
curr_Stock_Price:  100.61823141424068
curr_Factors:  [100.61823141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910759]
Stock Position:  -0.019107588704120573
Bond Position:  [11.80903835]


portfolio before change:  [9.90428895]
curr_Stock_Price:  99.72412102542903
curr_Factors:  [99.72412103]
mat_Sqrt:  [[0.15]]
grads:  [0.05591612]
Stock Position:  0.05591611974452823
Bond Position:  [4.32810305]


portfolio before change:  [9.87571802]
curr_Stock_Price:  99.2083227312
curr_Factors:  [99.20832273]
mat_Sqrt:  [[0.15]]
grads:  [0.01347102]
Stock Position:  0.013471017303187949
Bond Position:  [8.53928099]


portfolio before change:  [9.8823437]
curr_Stock_Price:  99.66054946813644
curr_Factors:  [99.66054947]
mat_Sqrt:  [[0.15]]
grads:  [0.14719153]
Stock Position:  0.14719153059177564
Bond Position:  [-4.78684512]


portfolio before change:  [9.99540311]
curr_Stock_Price:  100.43069298311042
curr_Factors:  [100.43069298]
mat_Sqrt:  [[0.15]]
grads:  [0.00918343]
Stock Position:  0.009183431178740016
Bond Position:  [9.07310476]


portfolio before change:  [9.99373063]
curr_Stock_Price:  100.18682187959573
curr_Factors:  [100.18682188]
mat_Sqrt:  [[0.15]]
grads:  [-0.10907986]
Stock Position:  -0.10907985620778725
Bond Position:  [20.92209475]


portfolio before change:  [9.97851348]
curr_Stock_Price:  100.33831472111693
curr_Factors:  [100.33831472]
mat_Sqrt:  [[0.15]]
grads:  [0.15538155]
Stock Position:  0.15538154677918217
Bond Position:  [-5.61220906]


portfolio before change:  [9.8954257]
curr_Stock_Price:  99.80583832811685
curr_Factors:  [99.80583833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00536197]
Stock Position:  -0.0053619655369293966
Bond Position:  [10.43058117]


portfolio before change:  [9.89525343]
curr_Stock_Price:  99.95955085421268
curr_Factors:  [99.95955085]
mat_Sqrt:  [[0.15]]
grads:  [0.08682369]
Stock Position:  0.08682368922675983
Bond Position:  [1.21639645]


portfolio before change:  [9.85765976]
curr_Stock_Price:  99.52568661889778
curr_Factors:  [99.52568662]
mat_Sqrt:  [[0.15]]
grads:  [0.04169961]
Stock Position:  0.04169960741028353
Bond Position:  [5.70747771]


portfolio before change:  [9.86564172]
curr_Stock_Price:  99.70854743122902
curr_Factors:  [99.70854743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02747421]
Stock Position:  -0.02747420613657351
Bond Position:  [12.6050549]


portfolio before change:  [9.87687806]
curr_Stock_Price:  99.32824523361802
curr_Factors:  [99.32824523]
mat_Sqrt:  [[0.15]]
grads:  [0.08254346]
Stock Position:  0.08254345842875442
Bond Position:  [1.67798118]


portfolio before change:  [9.96947886]
curr_Stock_Price:  100.44881761262941
curr_Factors:  [100.44881761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610354]
Stock Position:  -0.046103537189495954
Bond Position:  [14.60052465]


portfolio before change:  [9.92886974]
curr_Stock_Price:  101.34943565623922
curr_Factors:  [101.34943566]
mat_Sqrt:  [[0.15]]
grads:  [0.13843688]
Stock Position:  0.13843687774758553
Bond Position:  [-4.10162969]


portfolio before change:  [9.85758489]
curr_Stock_Price:  100.83636071087535
curr_Factors:  [100.83636071]
mat_Sqrt:  [[0.15]]
grads:  [0.06801421]
Stock Position:  0.06801420758512366
Bond Position:  [2.99927972]


portfolio before change:  [9.91129453]
curr_Stock_Price:  101.62328728980093
curr_Factors:  [101.62328729]
mat_Sqrt:  [[0.15]]
grads:  [-0.07188396]
Stock Position:  -0.07188396086052626
Bond Position:  [17.21637894]


portfolio before change:  [9.97696083]
curr_Stock_Price:  100.72475257519478
curr_Factors:  [100.72475258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00324744]
Stock Position:  -0.003247438477104314
Bond Position:  [10.30405826]


portfolio before change:  [9.97789858]
curr_Stock_Price:  100.63430313807719
curr_Factors:  [100.63430314]
mat_Sqrt:  [[0.15]]
grads:  [0.03234183]
Stock Position:  0.032341825510333724
Bond Position:  [6.72320151]


portfolio before change:  [9.98633821]
curr_Stock_Price:  100.88226132856946
curr_Factors:  [100.88226133]
mat_Sqrt:  [[0.15]]
grads:  [0.08142037]
Stock Position:  0.08142037361173217
Bond Position:  [1.7724668]


portfolio before change:  [10.00106321]
curr_Stock_Price:  101.06175217447064
curr_Factors:  [101.06175217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03273638]
Stock Position:  -0.032736382949128506
Bond Position:  [13.30945943]


portfolio before change:  [10.00181736]
curr_Stock_Price:  101.06412616833441
curr_Factors:  [101.06412617]
mat_Sqrt:  [[0.15]]
grads:  [0.04814502]
Stock Position:  0.048145016251508944
Bond Position:  [5.13608336]


portfolio before change:  [10.01417225]
curr_Stock_Price:  101.31407671793804
curr_Factors:  [101.31407672]
mat_Sqrt:  [[0.15]]
grads:  [0.11072656]
Stock Position:  0.1107265639405391
Bond Position:  [-1.20398735]


portfolio before change:  [10.02446924]
curr_Stock_Price:  101.40775111204206
curr_Factors:  [101.40775111]
mat_Sqrt:  [[0.15]]
grads:  [0.0105777]
Stock Position:  0.010577697558820943
Bond Position:  [8.95180872]


portfolio before change:  [10.02716729]
curr_Stock_Price:  101.60992591173242
curr_Factors:  [101.60992591]
mat_Sqrt:  [[0.15]]
grads:  [0.07538957]
Stock Position:  0.07538956526280782
Bond Position:  [2.36683915]


portfolio before change:  [9.97887387]
curr_Stock_Price:  100.96737871393637
curr_Factors:  [100.96737871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012262]
Stock Position:  -0.040122621410659524
Bond Position:  [14.02994978]


portfolio before change:  [9.95200638]
curr_Stock_Price:  101.65886859493324
curr_Factors:  [101.65886859]
mat_Sqrt:  [[0.15]]
grads:  [0.05824947]
Stock Position:  0.05824947497387154
Bond Position:  [4.03043066]


portfolio before change:  [9.91867357]
curr_Stock_Price:  101.08230170817512
curr_Factors:  [101.08230171]
mat_Sqrt:  [[0.15]]
grads:  [0.07923772]
Stock Position:  0.07923772174047079
Bond Position:  [1.90914227]


portfolio before change:  [9.81584278]
curr_Stock_Price:  99.78304533692076
curr_Factors:  [99.78304534]
mat_Sqrt:  [[0.15]]
grads:  [-0.01546676]
Stock Position:  -0.015466758650307036
Bond Position:  [11.35916306]


portfolio before change:  [9.8267096]
curr_Stock_Price:  99.12635623487296
curr_Factors:  [99.12635623]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427806]
Stock Position:  -0.04278060072770813
Bond Position:  [14.06739467]


portfolio before change:  [9.85661706]
curr_Stock_Price:  98.44781925322764
curr_Factors:  [98.44781925]
mat_Sqrt:  [[0.15]]
grads:  [-0.06881224]
Stock Position:  -0.06881223728326814
Bond Position:  [16.63103176]


portfolio before change:  [9.89096375]
curr_Stock_Price:  97.9637887629306
curr_Factors:  [97.96378876]
mat_Sqrt:  [[0.15]]
grads:  [-0.05882503]
Stock Position:  -0.058825026768999776
Bond Position:  [15.65368625]


portfolio before change:  [9.88923166]
curr_Stock_Price:  98.00986578652184
curr_Factors:  [98.00986579]
mat_Sqrt:  [[0.15]]
grads:  [0.03405624]
Stock Position:  0.03405624156536984
Bond Position:  [6.55138399]


portfolio before change:  [9.87695491]
curr_Stock_Price:  97.63735764903574
curr_Factors:  [97.63735765]
mat_Sqrt:  [[0.15]]
grads:  [0.08969723]
Stock Position:  0.08969722839540513
Bond Position:  [1.11915454]


portfolio before change:  [9.84737533]
curr_Stock_Price:  97.30680642505085
curr_Factors:  [97.30680643]
mat_Sqrt:  [[0.15]]
grads:  [0.0921197]
Stock Position:  0.09211969928677737
Bond Position:  [0.88350158]


portfolio before change:  [9.87447631]
curr_Stock_Price:  97.60040010573812
curr_Factors:  [97.60040011]
mat_Sqrt:  [[0.15]]
grads:  [-0.22882029]
Stock Position:  -0.22882028670861057
Bond Position:  [32.20742784]


portfolio before change:  [9.89199453]
curr_Stock_Price:  97.53263867735494
curr_Factors:  [97.53263868]
mat_Sqrt:  [[0.15]]
grads:  [0.05787531]
Stock Position:  0.05787530502655742
Bond Position:  [4.24726331]


portfolio before change:  [9.89718506]
curr_Stock_Price:  97.61773672281568
curr_Factors:  [97.61773672]
mat_Sqrt:  [[0.15]]
grads:  [-0.1612797]
Stock Position:  -0.16127970170592792
Bond Position:  [25.64094452]


portfolio before change:  [9.80077522]
curr_Stock_Price:  98.22545391529374
curr_Factors:  [98.22545392]
mat_Sqrt:  [[0.15]]
grads:  [0.14433043]
Stock Position:  0.1443304339822862
Bond Position:  [-4.37614717]


portfolio before change:  [9.85109961]
curr_Stock_Price:  98.57602377735256
curr_Factors:  [98.57602378]
mat_Sqrt:  [[0.15]]
grads:  [-0.03257251]
Stock Position:  -0.03257251190205191
Bond Position:  [13.06196831]


portfolio before change:  [9.84448829]
curr_Stock_Price:  98.8040602234267
curr_Factors:  [98.80406022]
mat_Sqrt:  [[0.15]]
grads:  [0.02060515]
Stock Position:  0.020605150278746806
Bond Position:  [7.80861578]


portfolio before change:  [9.83361641]
curr_Stock_Price:  98.25274525603152
curr_Factors:  [98.25274526]
mat_Sqrt:  [[0.15]]
grads:  [0.15361254]
Stock Position:  0.15361253655465087
Bond Position:  [-5.25923701]


portfolio before change:  [9.79275998]
curr_Stock_Price:  97.98891445124718
curr_Factors:  [97.98891445]
mat_Sqrt:  [[0.15]]
grads:  [0.02978127]
Stock Position:  0.02978127232876838
Bond Position:  [6.87452543]


portfolio before change:  [9.759218]
curr_Stock_Price:  96.84820945426151
curr_Factors:  [96.84820945]
mat_Sqrt:  [[0.15]]
grads:  [0.02510021]
Stock Position:  0.025100210032036527
Bond Position:  [7.32830761]


portfolio before change:  [9.75592561]
curr_Stock_Price:  96.69879109119947
curr_Factors:  [96.69879109]
mat_Sqrt:  [[0.15]]
grads:  [0.04102855]
Stock Position:  0.0410285535073137
Bond Position:  [5.78851408]


portfolio before change:  [9.76739685]
curr_Stock_Price:  96.96956468904355
curr_Factors:  [96.96956469]
mat_Sqrt:  [[0.15]]
grads:  [0.00740382]
Stock Position:  0.007403816468745719
Bond Position:  [9.04945199]


portfolio before change:  [9.77242195]
curr_Stock_Price:  97.57188765188585
curr_Factors:  [97.57188765]
mat_Sqrt:  [[0.15]]
grads:  [-0.08008618]
Stock Position:  -0.08008618284327466
Bond Position:  [17.58658198]


portfolio before change:  [9.84363737]
curr_Stock_Price:  96.69637792216655
curr_Factors:  [96.69637792]
mat_Sqrt:  [[0.15]]
grads:  [0.00984145]
Stock Position:  0.00984145058742062
Bond Position:  [8.89200475]


portfolio before change:  [9.83664838]
curr_Stock_Price:  95.92974685023405
curr_Factors:  [95.92974685]
mat_Sqrt:  [[0.15]]
grads:  [0.02160129]
Stock Position:  0.021601288562476742
Bond Position:  [7.76444224]


portfolio before change:  [9.82461336]
curr_Stock_Price:  95.35013732316496
curr_Factors:  [95.35013732]
mat_Sqrt:  [[0.15]]
grads:  [0.22908436]
Stock Position:  0.22908436191101242
Bond Position:  [-12.01861201]


portfolio before change:  [9.93625711]
curr_Stock_Price:  95.84076416822931
curr_Factors:  [95.84076417]
mat_Sqrt:  [[0.15]]
grads:  [0.01011724]
Stock Position:  0.010117235966121003
Bond Position:  [8.96661348]


portfolio before change:  [9.93450645]
curr_Stock_Price:  95.61233291438572
curr_Factors:  [95.61233291]
mat_Sqrt:  [[0.15]]
grads:  [0.00895308]
Stock Position:  0.008953077233795065
Bond Position:  [9.07848185]


portfolio before change:  [9.93457624]
curr_Stock_Price:  95.55675053953225
curr_Factors:  [95.55675054]
mat_Sqrt:  [[0.15]]
grads:  [0.03160226]
Stock Position:  0.03160226282384288
Bond Position:  [6.91476669]


portfolio before change:  [9.9342817]
curr_Stock_Price:  95.53375454159357
curr_Factors:  [95.53375454]
mat_Sqrt:  [[0.15]]
grads:  [0.02298553]
Stock Position:  0.022985534665484957
Bond Position:  [7.73838727]


portfolio before change:  [9.93528265]
curr_Stock_Price:  95.55625920154564
curr_Factors:  [95.5562592]
mat_Sqrt:  [[0.15]]
grads:  [0.02281712]
Stock Position:  0.022817116453376838
Bond Position:  [7.75496435]


portfolio before change:  [9.92690724]
curr_Stock_Price:  95.16794946067462
curr_Factors:  [95.16794946]
mat_Sqrt:  [[0.15]]
grads:  [-0.07952073]
Stock Position:  -0.07952073367031856
Bond Position:  [17.4947324]


portfolio before change:  [9.95347378]
curr_Stock_Price:  94.84761681357378
curr_Factors:  [94.84761681]
mat_Sqrt:  [[0.15]]
grads:  [0.00086179]
Stock Position:  0.0008617889049990976
Bond Position:  [9.87173516]


portfolio before change:  [9.95393574]
curr_Stock_Price:  94.66770462653658
curr_Factors:  [94.66770463]
mat_Sqrt:  [[0.15]]
grads:  [0.01061416]
Stock Position:  0.010614157884044522
Bond Position:  [8.94911777]


portfolio before change:  [9.9632341]
curr_Stock_Price:  95.49104178665591
curr_Factors:  [95.49104179]
mat_Sqrt:  [[0.15]]
grads:  [-0.3223334]
Stock Position:  -0.3223333979815095
Bond Position:  [40.74318608]


portfolio before change:  [9.98710735]
curr_Stock_Price:  95.42487825318891
curr_Factors:  [95.42487825]
mat_Sqrt:  [[0.15]]
grads:  [-0.07254131]
Stock Position:  -0.07254131024066517
Bond Position:  [16.90935305]


portfolio before change:  [10.08182629]
curr_Stock_Price:  94.13372324351126
curr_Factors:  [94.13372324]
mat_Sqrt:  [[0.15]]
grads:  [0.11897565]
Stock Position:  0.11897565371078167
Bond Position:  [-1.11779497]


portfolio before change:  [10.01272514]
curr_Stock_Price:  93.55350971421404
curr_Factors:  [93.55350971]
mat_Sqrt:  [[0.15]]
grads:  [0.11711133]
Stock Position:  0.11711132550882519
Bond Position:  [-0.94345038]


portfolio before change:  [10.04114164]
curr_Stock_Price:  93.79665838782434
curr_Factors:  [93.79665839]
mat_Sqrt:  [[0.15]]
grads:  [-0.13114133]
Stock Position:  -0.13114133346874526
Bond Position:  [22.3417605]


portfolio before change:  [9.97935686]
curr_Stock_Price:  94.27843773523952
curr_Factors:  [94.27843774]
mat_Sqrt:  [[0.15]]
grads:  [-0.02787845]
Stock Position:  -0.027878453936976504
Bond Position:  [12.60769394]


portfolio before change:  [9.9796852]
curr_Stock_Price:  94.29492590117832
curr_Factors:  [94.2949259]
mat_Sqrt:  [[0.15]]
grads:  [-0.13324019]
Stock Position:  -0.1332401859326703
Bond Position:  [22.54355866]


portfolio before change:  [9.88980247]
curr_Stock_Price:  94.98009265054672
curr_Factors:  [94.98009265]
mat_Sqrt:  [[0.15]]
grads:  [-0.0282656]
Stock Position:  -0.028265600441555017
Bond Position:  [12.57447182]


portfolio before change:  [9.87578862]
curr_Stock_Price:  95.50368934489848
curr_Factors:  [95.50368934]
mat_Sqrt:  [[0.15]]
grads:  [0.0359044]
Stock Position:  0.035904403928706856
Bond Position:  [6.44678559]


portfolio before change:  [9.87190244]
curr_Stock_Price:  95.3842297648316
curr_Factors:  [95.38422976]
mat_Sqrt:  [[0.15]]
grads:  [-0.09981079]
Stock Position:  -0.09981078715037894
Bond Position:  [19.39227749]


portfolio before change:  [9.83250418]
curr_Stock_Price:  95.79110268441416
curr_Factors:  [95.79110268]
mat_Sqrt:  [[0.15]]
grads:  [0.07406059]
Stock Position:  0.07406059420141578
Bond Position:  [2.7381582]


portfolio before change:  [9.7944402]
curr_Stock_Price:  95.27483459404938
curr_Factors:  [95.27483459]
mat_Sqrt:  [[0.15]]
grads:  [0.02546563]
Stock Position:  0.02546562582472975
Bond Position:  [7.36820691]


portfolio before change:  [9.82872499]
curr_Stock_Price:  96.60306662857842
curr_Factors:  [96.60306663]
mat_Sqrt:  [[0.15]]
grads:  [0.07853933]
Stock Position:  0.07853932658701306
Bond Position:  [2.24158519]


portfolio before change:  [9.85526632]
curr_Stock_Price:  96.93921953051802
curr_Factors:  [96.93921953]
mat_Sqrt:  [[0.15]]
grads:  [0.00242185]
Stock Position:  0.0024218500843873
Bond Position:  [9.62049406]


portfolio before change:  [9.85563314]
curr_Stock_Price:  96.84240084714675
curr_Factors:  [96.84240085]
mat_Sqrt:  [[0.15]]
grads:  [0.02336208]
Stock Position:  0.023362082758351964
Bond Position:  [7.59319295]


portfolio before change:  [9.85947751]
curr_Stock_Price:  96.9866422934644
curr_Factors:  [96.98664229]
mat_Sqrt:  [[0.15]]
grads:  [-0.04690265]
Stock Position:  -0.046902651111247085
Bond Position:  [14.40840815]


portfolio before change:  [9.81131398]
curr_Stock_Price:  98.03272552001548
curr_Factors:  [98.03272552]
mat_Sqrt:  [[0.15]]
grads:  [-0.05395595]
Stock Position:  -0.05395595089724865
Bond Position:  [15.10076291]


portfolio before change:  [9.82751868]
curr_Stock_Price:  97.74988616155274
curr_Factors:  [97.74988616]
mat_Sqrt:  [[0.15]]
grads:  [0.01298944]
Stock Position:  0.01298943841055848
Bond Position:  [8.55780255]


portfolio before change:  [9.82767848]
curr_Stock_Price:  97.72101039494189
curr_Factors:  [97.72101039]
mat_Sqrt:  [[0.15]]
grads:  [0.01963418]
Stock Position:  0.019634178758577717
Bond Position:  [7.90900669]


portfolio before change:  [9.82730455]
curr_Stock_Price:  97.67678867961344
curr_Factors:  [97.67678868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.82730455]
Stock Price:  97.07241235074733
PL:  [9.82730455]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.00293586e-04]
 [ 2.52625745e-03]
 [-2.55074756e-03]
 [ 6.41669792e-03]
 [ 4.27435131e-03]
 [ 2.40354485e-02]
 [ 1.08211954e-03]
 [ 3.89842192e-04]
 [ 2.32235672e-02]
 [-4.70871856e-03]
 [ 1.59244096e-02]
 [-5.72653122e-03]
 [-1.10386862e-03]
 [ 1.19580048e-02]
 [-6.93099942e-03]
 [ 1.25100942e-02]
 [ 7.38510970e-03]
 [-1.23817033e-02]
 [-2.97439235e-04]
 [ 1.58985970e-02]
 [ 1.18305544e-02]
 [-8.85242508e-03]
 [ 7.54664476e-03]
 [ 4.33671388e-03]
 [-8.04117172e-03]
 [-3.29956333e-04]
 [-6.30214642e-03]
 [ 5.65699420e-03]
 [ 4.98445296e-03]
 [-3.17852603e-03]
 [ 7.25596142e-03]
 [-1.20069138e-02]
 [ 9.03801332e-03]
 [ 8.05926422e-03]
 [ 1.10494888e-02]
 [ 8.68837585e-03]
 [-3.35949316e-02]
 [ 9.55684175e-03]
 [ 9.79839058e-04]
 [ 1.76423748e-02]
 [-4.95518907e-03]
 [-1.96003290e-02]
 [ 2.11178499e-02]
 [-9.90631820e-04]
 [ 3.51025023e-03]
 [-1.64322920e-02]
 [ 1.45245652e-02]
 [ 7.77938226e-03]
 [ 4.93463555e-03]
 [-7.38763470e-03]
 [-3.73414974e-02]
 [ 2.03402729e-03]
 [-7.91463309e-03]
 [ 5.69722086e-03]
 [-8.11056434e-03]
 [ 1.11996803e-02]
 [ 1.05524357e-02]
 [ 3.51472597e-04]
 [ 1.77907221e-03]
 [ 9.24053624e-03]
 [ 8.55666662e-03]
 [ 3.09494100e-02]
 [ 2.12921234e-03]
 [-1.23770425e-02]
 [ 1.55225427e-02]
 [ 7.35479004e-03]
 [-5.07183129e-03]
 [ 1.55276964e-02]
 [-1.65505007e-02]
 [-2.81496440e-02]
 [-1.05898373e-02]
 [ 1.46558305e-02]
 [-1.48918932e-02]
 [ 2.77372368e-02]
 [-2.60662645e-02]
 [ 1.50616834e-03]
 [ 1.95322898e-03]
 [-1.17024410e-02]
 [ 2.70293488e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.0085169]
curr_Stock_Price:  100.32297507901329
curr_Factors:  [100.32297508]
mat_Sqrt:  [[0.15]]
grads:  [0.00133529]
Stock Position:  0.0013352905739814325
Bond Position:  [6.87455658]


portfolio before change:  [7.00911258]
curr_Stock_Price:  100.447298639731
curr_Factors:  [100.44729864]
mat_Sqrt:  [[0.15]]
grads:  [0.01684172]
Stock Position:  0.01684171630498662
Bond Position:  [5.31740768]


portfolio before change:  [7.01139662]
curr_Stock_Price:  100.56318264647997
curr_Factors:  [100.56318265]
mat_Sqrt:  [[0.15]]
grads:  [-0.01700498]
Stock Position:  -0.017004983756633386
Bond Position:  [8.7214719]


portfolio before change:  [7.0134794]
curr_Stock_Price:  100.47275758946444
curr_Factors:  [100.47275759]
mat_Sqrt:  [[0.15]]
grads:  [0.04277799]
Stock Position:  0.04277798613221306
Bond Position:  [2.71545717]


portfolio before change:  [7.01494083]
curr_Stock_Price:  100.5029532498837
curr_Factors:  [100.50295325]
mat_Sqrt:  [[0.15]]
grads:  [0.02849568]
Stock Position:  0.02849567542566364
Bond Position:  [4.1510413]


portfolio before change:  [7.00007417]
curr_Stock_Price:  99.97213209578004
curr_Factors:  [99.9721321]
mat_Sqrt:  [[0.15]]
grads:  [0.16023632]
Stock Position:  0.16023632308565203
Bond Position:  [-9.01909268]


portfolio before change:  [7.11978996]
curr_Stock_Price:  100.7227702548095
curr_Factors:  [100.72277025]
mat_Sqrt:  [[0.15]]
grads:  [0.00721413]
Stock Position:  0.007214130281656049
Bond Position:  [6.39316277]


portfolio before change:  [7.12486318]
curr_Stock_Price:  101.37061501590047
curr_Factors:  [101.37061502]
mat_Sqrt:  [[0.15]]
grads:  [0.00259895]
Stock Position:  0.002598947946915962
Bond Position:  [6.86140623]


portfolio before change:  [7.12472343]
curr_Stock_Price:  101.15183346364327
curr_Factors:  [101.15183346]
mat_Sqrt:  [[0.15]]
grads:  [0.15482378]
Stock Position:  0.15482378105917027
Bond Position:  [-8.53598589]


portfolio before change:  [7.0846841]
curr_Stock_Price:  100.89666711825737
curr_Factors:  [100.89666712]
mat_Sqrt:  [[0.15]]
grads:  [-0.03139146]
Stock Position:  -0.03139145709357779
Bond Position:  [10.2519775]


portfolio before change:  [7.09353151]
curr_Stock_Price:  100.63523794188103
curr_Factors:  [100.63523794]
mat_Sqrt:  [[0.15]]
grads:  [0.10616273]
Stock Position:  0.1061627308329684
Bond Position:  [-3.59018017]


portfolio before change:  [7.01493357]
curr_Stock_Price:  99.8969981838443
curr_Factors:  [99.89699818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03817687]
Stock Position:  -0.03817687479091485
Bond Position:  [10.82868876]


portfolio before change:  [7.01844406]
curr_Stock_Price:  99.8227732350784
curr_Factors:  [99.82277324]
mat_Sqrt:  [[0.15]]
grads:  [-0.00735912]
Stock Position:  -0.0073591241639180596
Bond Position:  [7.75305224]


portfolio before change:  [7.02292536]
curr_Stock_Price:  99.27967592095438
curr_Factors:  [99.27967592]
mat_Sqrt:  [[0.15]]
grads:  [0.07972003]
Stock Position:  0.07972003185883227
Bond Position:  [-0.89165357]


portfolio before change:  [7.02592918]
curr_Stock_Price:  99.31805465660514
curr_Factors:  [99.31805466]
mat_Sqrt:  [[0.15]]
grads:  [-0.04620666]
Stock Position:  -0.04620666282689082
Bond Position:  [11.61508505]


portfolio before change:  [6.99134211]
curr_Stock_Price:  100.08229602602916
curr_Factors:  [100.08229603]
mat_Sqrt:  [[0.15]]
grads:  [0.08340063]
Stock Position:  0.08340062813301426
Bond Position:  [-1.35558425]


portfolio before change:  [6.96304362]
curr_Stock_Price:  99.74400408359284
curr_Factors:  [99.74400408]
mat_Sqrt:  [[0.15]]
grads:  [0.04923406]
Stock Position:  0.04923406467753248
Bond Position:  [2.05224087]


portfolio before change:  [6.97815446]
curr_Stock_Price:  100.04831714870915
curr_Factors:  [100.04831715]
mat_Sqrt:  [[0.15]]
grads:  [-0.08254469]
Stock Position:  -0.08254468872635193
Bond Position:  [15.23661165]


portfolio before change:  [6.9856396]
curr_Stock_Price:  99.96917426811115
curr_Factors:  [99.96917427]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198293]
Stock Position:  -0.0019829282324280244
Bond Position:  [7.1838713]


portfolio before change:  [6.98710836]
curr_Stock_Price:  99.45490904896785
curr_Factors:  [99.45490905]
mat_Sqrt:  [[0.15]]
grads:  [0.10599065]
Stock Position:  0.10599064694228352
Bond Position:  [-3.55418179]


portfolio before change:  [6.91964456]
curr_Stock_Price:  98.82049784675945
curr_Factors:  [98.82049785]
mat_Sqrt:  [[0.15]]
grads:  [0.07887036]
Stock Position:  0.07887036263789872
Bond Position:  [-0.87436394]


portfolio before change:  [6.905323]
curr_Stock_Price:  98.63960724398109
curr_Factors:  [98.63960724]
mat_Sqrt:  [[0.15]]
grads:  [-0.05901617]
Stock Position:  -0.05901616717649367
Bond Position:  [12.72665455]


portfolio before change:  [6.90317061]
curr_Stock_Price:  98.68955684557838
curr_Factors:  [98.68955685]
mat_Sqrt:  [[0.15]]
grads:  [0.05031097]
Stock Position:  0.05031096508883682
Bond Position:  [1.93800376]


portfolio before change:  [6.88699071]
curr_Stock_Price:  98.36555127554412
curr_Factors:  [98.36555128]
mat_Sqrt:  [[0.15]]
grads:  [0.02891143]
Stock Position:  0.028911425885117203
Bond Position:  [4.04310236]


portfolio before change:  [6.90647512]
curr_Stock_Price:  99.0307455830058
curr_Factors:  [99.03074558]
mat_Sqrt:  [[0.15]]
grads:  [-0.05360781]
Stock Position:  -0.05360781147456729
Bond Position:  [12.21529666]


portfolio before change:  [6.89625016]
curr_Stock_Price:  99.23572390763256
curr_Factors:  [99.23572391]
mat_Sqrt:  [[0.15]]
grads:  [-0.00219971]
Stock Position:  -0.0021997088893814755
Bond Position:  [7.11453987]


portfolio before change:  [6.89668014]
curr_Stock_Price:  99.24240310434737
curr_Factors:  [99.2424031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04201431]
Stock Position:  -0.04201430947013181
Bond Position:  [11.06628118]


portfolio before change:  [6.87187969]
curr_Stock_Price:  99.84915166232243
curr_Factors:  [99.84915166]
mat_Sqrt:  [[0.15]]
grads:  [0.03771329]
Stock Position:  0.0377132946634224
Bond Position:  [3.10623921]


portfolio before change:  [6.89529934]
curr_Stock_Price:  100.46499558211701
curr_Factors:  [100.46499558]
mat_Sqrt:  [[0.15]]
grads:  [0.03322969]
Stock Position:  0.033229686402790226
Bond Position:  [3.55687904]


portfolio before change:  [6.9051421]
curr_Stock_Price:  100.75450933918991
curr_Factors:  [100.75450934]
mat_Sqrt:  [[0.15]]
grads:  [-0.02119017]
Stock Position:  -0.021190173560910852
Bond Position:  [9.04014764]


portfolio before change:  [6.90519892]
curr_Stock_Price:  100.7784926393329
curr_Factors:  [100.77849264]
mat_Sqrt:  [[0.15]]
grads:  [0.04837308]
Stock Position:  0.04837307610800192
Bond Position:  [2.03023322]


portfolio before change:  [6.90813551]
curr_Stock_Price:  100.83657670138685
curr_Factors:  [100.8365767]
mat_Sqrt:  [[0.15]]
grads:  [-0.08004609]
Stock Position:  -0.08004609188881517
Bond Position:  [14.9797094]


portfolio before change:  [6.89527793]
curr_Stock_Price:  101.00890052462788
curr_Factors:  [101.00890052]
mat_Sqrt:  [[0.15]]
grads:  [0.06025342]
Stock Position:  0.060253422161995314
Bond Position:  [0.809146]


portfolio before change:  [6.92652988]
curr_Stock_Price:  101.52673633948035
curr_Factors:  [101.52673634]
mat_Sqrt:  [[0.15]]
grads:  [0.05372843]
Stock Position:  0.05372842810136669
Bond Position:  [1.47165793]


portfolio before change:  [6.94043317]
curr_Stock_Price:  101.78379411879993
curr_Factors:  [101.78379412]
mat_Sqrt:  [[0.15]]
grads:  [0.07366326]
Stock Position:  0.0736632584654288
Bond Position:  [-0.55729276]


portfolio before change:  [6.90912159]
curr_Stock_Price:  101.35920325152046
curr_Factors:  [101.35920325]
mat_Sqrt:  [[0.15]]
grads:  [0.05792251]
Stock Position:  0.057922505642075954
Bond Position:  [1.03814257]


portfolio before change:  [6.94365247]
curr_Stock_Price:  101.95423945389905
curr_Factors:  [101.95423945]
mat_Sqrt:  [[0.15]]
grads:  [-0.22396621]
Stock Position:  -0.22396621036264341
Bond Position:  [29.77795711]


portfolio before change:  [6.97851472]
curr_Stock_Price:  101.80689099680167
curr_Factors:  [101.806891]
mat_Sqrt:  [[0.15]]
grads:  [0.06371228]
Stock Position:  0.06371227834074035
Bond Position:  [0.49216575]


portfolio before change:  [6.93692194]
curr_Stock_Price:  101.15358609817311
curr_Factors:  [101.1535861]
mat_Sqrt:  [[0.15]]
grads:  [0.00653226]
Stock Position:  0.006532260389187083
Bond Position:  [6.27616038]


portfolio before change:  [6.93927637]
curr_Stock_Price:  101.45396490391762
curr_Factors:  [101.4539649]
mat_Sqrt:  [[0.15]]
grads:  [0.11761583]
Stock Position:  0.11761583170268027
Bond Position:  [-4.9933161]


portfolio before change:  [7.01786011]
curr_Stock_Price:  102.12475757185076
curr_Factors:  [102.12475757]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303459]
Stock Position:  -0.03303459379333497
Bond Position:  [10.39150999]


portfolio before change:  [6.99197004]
curr_Stock_Price:  102.92814463002901
curr_Factors:  [102.92814463]
mat_Sqrt:  [[0.15]]
grads:  [-0.13066886]
Stock Position:  -0.1306688597917176
Bond Position:  [20.44147333]


portfolio before change:  [7.08245353]
curr_Stock_Price:  102.24545818141637
curr_Factors:  [102.24545818]
mat_Sqrt:  [[0.15]]
grads:  [0.14078567]
Stock Position:  0.14078566624943006
Bond Position:  [-7.31224142]


portfolio before change:  [7.19001997]
curr_Stock_Price:  103.0127484628019
curr_Factors:  [103.01274846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00660421]
Stock Position:  -0.006604212134127772
Bond Position:  [7.87033801]


portfolio before change:  [7.18799474]
curr_Stock_Price:  103.39389118216967
curr_Factors:  [103.39389118]
mat_Sqrt:  [[0.15]]
grads:  [0.02340167]
Stock Position:  0.023401668175675495
Bond Position:  [4.7684052]


portfolio before change:  [7.1975417]
curr_Stock_Price:  103.78911629465446
curr_Factors:  [103.78911629]
mat_Sqrt:  [[0.15]]
grads:  [-0.10954861]
Stock Position:  -0.10954861347930045
Bond Position:  [18.56749548]


portfolio before change:  [7.24381131]
curr_Stock_Price:  103.37734380483712
curr_Factors:  [103.3773438]
mat_Sqrt:  [[0.15]]
grads:  [0.09683043]
Stock Position:  0.09683043448945326
Bond Position:  [-2.76626181]


portfolio before change:  [7.26015327]
curr_Stock_Price:  103.54789822281758
curr_Factors:  [103.54789822]
mat_Sqrt:  [[0.15]]
grads:  [0.05186255]
Stock Position:  0.05186254837389505
Bond Position:  [1.88989539]


portfolio before change:  [7.28645851]
curr_Stock_Price:  104.05283133555542
curr_Factors:  [104.05283134]
mat_Sqrt:  [[0.15]]
grads:  [0.03289757]
Stock Position:  0.032897570355995914
Bond Position:  [3.86337317]


portfolio before change:  [7.26796528]
curr_Stock_Price:  103.48334573495467
curr_Factors:  [103.48334573]
mat_Sqrt:  [[0.15]]
grads:  [-0.0492509]
Stock Position:  -0.049250898023062914
Bond Position:  [12.36461299]


portfolio before change:  [7.29144622]
curr_Stock_Price:  103.02227544425368
curr_Factors:  [103.02227544]
mat_Sqrt:  [[0.15]]
grads:  [-0.24894332]
Stock Position:  -0.24894331592458585
Bond Position:  [32.93815309]


portfolio before change:  [7.45275594]
curr_Stock_Price:  102.38256747574009
curr_Factors:  [102.38256748]
mat_Sqrt:  [[0.15]]
grads:  [0.01356018]
Stock Position:  0.013560181916814941
Bond Position:  [6.0644297]


portfolio before change:  [7.45440443]
curr_Stock_Price:  102.47618345302156
curr_Factors:  [102.47618345]
mat_Sqrt:  [[0.15]]
grads:  [-0.05276422]
Stock Position:  -0.05276422056826046
Bond Position:  [12.86148038]


portfolio before change:  [7.41846641]
curr_Stock_Price:  103.17252451666978
curr_Factors:  [103.17252452]
mat_Sqrt:  [[0.15]]
grads:  [0.03798147]
Stock Position:  0.03798147240808541
Bond Position:  [3.49982201]


portfolio before change:  [7.43084259]
curr_Stock_Price:  103.49261312283441
curr_Factors:  [103.49261312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05407043]
Stock Position:  -0.0540704289655284
Bond Position:  [13.02673258]


portfolio before change:  [7.41323205]
curr_Stock_Price:  103.83336746170168
curr_Factors:  [103.83336746]
mat_Sqrt:  [[0.15]]
grads:  [0.07466454]
Stock Position:  0.07466453501802997
Bond Position:  [-0.33943805]


portfolio before change:  [7.42912114]
curr_Stock_Price:  104.04645797989959
curr_Factors:  [104.04645798]
mat_Sqrt:  [[0.15]]
grads:  [0.07034957]
Stock Position:  0.07034957107555191
Bond Position:  [0.10949745]


portfolio before change:  [7.42280802]
curr_Stock_Price:  103.95662132489916
curr_Factors:  [103.95662132]
mat_Sqrt:  [[0.15]]
grads:  [0.00234315]
Stock Position:  0.002343150646808988
Bond Position:  [7.17922199]


portfolio before change:  [7.42347145]
curr_Stock_Price:  104.04825669334346
curr_Factors:  [104.04825669]
mat_Sqrt:  [[0.15]]
grads:  [0.01186048]
Stock Position:  0.011860481376282785
Bond Position:  [6.18940904]


portfolio before change:  [7.43506549]
curr_Stock_Price:  104.99317539771084
curr_Factors:  [104.9931754]
mat_Sqrt:  [[0.15]]
grads:  [0.06160357]
Stock Position:  0.06160357491655438
Bond Position:  [0.96711054]


portfolio before change:  [7.39838157]
curr_Stock_Price:  104.39671068703838
curr_Factors:  [104.39671069]
mat_Sqrt:  [[0.15]]
grads:  [0.05704444]
Stock Position:  0.057044444153819186
Bond Position:  [1.44312924]


portfolio before change:  [7.43106866]
curr_Stock_Price:  104.96814027993736
curr_Factors:  [104.96814028]
mat_Sqrt:  [[0.15]]
grads:  [0.2063294]
Stock Position:  0.20632940004954745
Bond Position:  [-14.22694475]


portfolio before change:  [7.36549461]
curr_Stock_Price:  104.65463754044497
curr_Factors:  [104.65463754]
mat_Sqrt:  [[0.15]]
grads:  [0.01419475]
Stock Position:  0.014194748937034029
Bond Position:  [5.87994831]


portfolio before change:  [7.37493424]
curr_Stock_Price:  105.29375542680265
curr_Factors:  [105.29375543]
mat_Sqrt:  [[0.15]]
grads:  [-0.08251362]
Stock Position:  -0.08251361662314108
Bond Position:  [16.06310281]


portfolio before change:  [7.32944234]
curr_Stock_Price:  105.85724874345739
curr_Factors:  [105.85724874]
mat_Sqrt:  [[0.15]]
grads:  [0.10348362]
Stock Position:  0.1034836181666522
Bond Position:  [-3.62504877]


portfolio before change:  [7.32882523]
curr_Stock_Price:  105.85347476807362
curr_Factors:  [105.85347477]
mat_Sqrt:  [[0.15]]
grads:  [0.04903193]
Stock Position:  0.04903193360599578
Bond Position:  [2.13862468]


portfolio before change:  [7.35854033]
curr_Stock_Price:  106.45678435997016
curr_Factors:  [106.45678436]
mat_Sqrt:  [[0.15]]
grads:  [-0.03381221]
Stock Position:  -0.03381220861341444
Bond Position:  [10.95807933]


portfolio before change:  [7.37309113]
curr_Stock_Price:  106.04669890520591
curr_Factors:  [106.04669891]
mat_Sqrt:  [[0.15]]
grads:  [0.10351798]
Stock Position:  0.1035179760328704
Bond Position:  [-3.60464851]


portfolio before change:  [7.45199044]
curr_Stock_Price:  106.81105518151087
curr_Factors:  [106.81105518]
mat_Sqrt:  [[0.15]]
grads:  [-0.11033667]
Stock Position:  -0.1103366710222223
Bond Position:  [19.2371667]


portfolio before change:  [7.48139284]
curr_Stock_Price:  106.55547343944266
curr_Factors:  [106.55547344]
mat_Sqrt:  [[0.15]]
grads:  [-0.18766429]
Stock Position:  -0.18766429350741035
Bond Position:  [27.47805048]


portfolio before change:  [7.62012368]
curr_Stock_Price:  105.82537498518197
curr_Factors:  [105.82537499]
mat_Sqrt:  [[0.15]]
grads:  [-0.07059892]
Stock Position:  -0.07059891516010268
Bond Position:  [15.09128035]


portfolio before change:  [7.62333652]
curr_Stock_Price:  105.79322720810299
curr_Factors:  [105.79322721]
mat_Sqrt:  [[0.15]]
grads:  [0.09770554]
Stock Position:  0.0977055364749405
Bond Position:  [-2.7132475]


portfolio before change:  [7.61927914]
curr_Stock_Price:  105.75343629353088
curr_Factors:  [105.75343629]
mat_Sqrt:  [[0.15]]
grads:  [-0.09927929]
Stock Position:  -0.09927928792394898
Bond Position:  [18.11840499]


portfolio before change:  [7.59926569]
curr_Stock_Price:  105.96643025261407
curr_Factors:  [105.96643025]
mat_Sqrt:  [[0.15]]
grads:  [0.18491491]
Stock Position:  0.18491491223688966
Bond Position:  [-11.99550746]


portfolio before change:  [7.46899701]
curr_Stock_Price:  105.26600572320487
curr_Factors:  [105.26600572]
mat_Sqrt:  [[0.15]]
grads:  [-0.1737751]
Stock Position:  -0.1737750968695208
Bond Position:  [25.76160735]


portfolio before change:  [7.56327548]
curr_Stock_Price:  104.7327398764389
curr_Factors:  [104.73273988]
mat_Sqrt:  [[0.15]]
grads:  [0.01004112]
Stock Position:  0.010041122263377007
Bond Position:  [6.51164123]


portfolio before change:  [7.56913404]
curr_Stock_Price:  105.27566466089573
curr_Factors:  [105.27566466]
mat_Sqrt:  [[0.15]]
grads:  [0.01302153]
Stock Position:  0.01302152652148533
Bond Position:  [6.19828419]


portfolio before change:  [7.56811914]
curr_Stock_Price:  105.16797317969227
curr_Factors:  [105.16797318]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801627]
Stock Position:  -0.07801627347450726
Bond Position:  [15.7729325]


portfolio before change:  [7.57487945]
curr_Stock_Price:  105.09395697031258
curr_Factors:  [105.09395697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.57487945]
Stock Price:  105.5589881577174
PL:  [2.01589129]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.70007790e-04]
 [-3.17510975e-03]
 [ 4.96946884e-04]
 [ 3.87570053e-03]
 [ 2.15158015e-02]
 [ 2.74468836e-02]
 [ 3.28314409e-03]
 [ 1.14180322e-02]
 [ 2.44884679e-02]
 [-3.52750489e-03]
 [ 3.96500217e-02]
 [ 2.19238061e-02]
 [ 8.81598862e-02]
 [ 1.30416630e-02]
 [-6.89285796e-03]
 [ 3.38061881e-02]
 [ 1.63819752e-02]
 [ 3.95298849e-03]
 [ 1.38290803e-02]
 [-1.02537566e-02]
 [ 1.48985052e-02]
 [-1.61610402e-02]
 [ 1.10450825e-02]
 [-3.03365048e-02]
 [ 7.81758363e-03]
 [ 6.49569035e-03]
 [-4.87193779e-03]
 [ 1.72110388e-02]
 [ 5.06446207e-02]
 [ 5.73190469e-03]
 [ 1.94340440e-02]
 [-4.50126802e-03]
 [-1.41049883e-04]
 [ 8.18101685e-03]
 [ 1.01923729e-02]
 [ 6.76864609e-03]
 [-3.24834603e-02]
 [ 8.85008307e-03]
 [ 1.74428633e-02]
 [-7.73446379e-03]
 [-3.92392117e-03]
 [-1.63384766e-02]
 [ 2.07703389e-02]
 [-2.34483748e-03]
 [ 3.52767370e-03]
 [-1.64201216e-02]
 [ 1.45747236e-02]
 [ 1.10834177e-02]
 [ 4.20381857e-03]
 [-7.38899809e-03]
 [-3.00748999e-02]
 [ 3.22024328e-03]
 [-9.76866385e-03]
 [ 5.88045008e-03]
 [-1.15423200e-02]
 [ 8.95852720e-03]
 [ 9.94907049e-03]
 [-5.86129842e-04]
 [ 1.62648312e-03]
 [ 1.54912637e-02]
 [ 4.51155309e-04]
 [-1.19489453e-02]
 [-6.30043652e-03]
 [-1.28195596e-02]
 [-7.48223823e-03]
 [-4.79037669e-04]
 [-5.52823061e-03]
 [ 2.04144754e-02]
 [-8.63891457e-03]
 [ 5.97428724e-03]
 [-1.00777929e-02]
 [ 1.06678081e-02]
 [-6.91408992e-03]
 [ 8.93665976e-03]
 [-1.03590650e-02]
 [-9.71556188e-03]
 [ 4.48789907e-03]
 [ 5.28149752e-03]
 [-4.51075426e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.31790017]
curr_Stock_Price:  100.27806775462041
curr_Factors:  [100.27806775]
mat_Sqrt:  [[0.15]]
grads:  [0.00246672]
Stock Position:  0.002466718603225289
Bond Position:  [6.0705424]


portfolio before change:  [6.31627374]
curr_Stock_Price:  99.46490125582366
curr_Factors:  [99.46490126]
mat_Sqrt:  [[0.15]]
grads:  [-0.0211674]
Stock Position:  -0.021167398341925193
Bond Position:  [8.42168693]


portfolio before change:  [6.30547416]
curr_Stock_Price:  99.99996718281733
curr_Factors:  [99.99996718]
mat_Sqrt:  [[0.15]]
grads:  [0.00331298]
Stock Position:  0.003312979224858621
Bond Position:  [5.97417634]


portfolio before change:  [6.30951676]
curr_Stock_Price:  101.10749107347169
curr_Factors:  [101.10749107]
mat_Sqrt:  [[0.15]]
grads:  [0.025838]
Stock Position:  0.025838003551190473
Bond Position:  [3.69710105]


portfolio before change:  [6.32092321]
curr_Stock_Price:  101.54000809133106
curr_Factors:  [101.54000809]
mat_Sqrt:  [[0.15]]
grads:  [0.14343868]
Stock Position:  0.14343867689129575
Bond Position:  [-8.2438412]


portfolio before change:  [6.2831028]
curr_Stock_Price:  101.27993071546378
curr_Factors:  [101.27993072]
mat_Sqrt:  [[0.15]]
grads:  [0.18297922]
Stock Position:  0.18297922394732394
Bond Position:  [-12.24902032]


portfolio before change:  [6.41160212]
curr_Stock_Price:  101.98637654118897
curr_Factors:  [101.98637654]
mat_Sqrt:  [[0.15]]
grads:  [0.02188763]
Stock Position:  0.021887627296766767
Bond Position:  [4.17936232]


portfolio before change:  [6.41318035]
curr_Stock_Price:  102.04654792762862
curr_Factors:  [102.04654793]
mat_Sqrt:  [[0.15]]
grads:  [0.07612021]
Stock Position:  0.07612021487971603
Bond Position:  [-1.35462481]


portfolio before change:  [6.47748007]
curr_Stock_Price:  102.89237298149597
curr_Factors:  [102.89237298]
mat_Sqrt:  [[0.15]]
grads:  [0.16325645]
Stock Position:  0.16325645297172195
Bond Position:  [-10.32036378]


portfolio before change:  [6.4765809]
curr_Stock_Price:  102.89081640572407
curr_Factors:  [102.89081641]
mat_Sqrt:  [[0.15]]
grads:  [-0.0235167]
Stock Position:  -0.023516699276050275
Bond Position:  [8.89623329]


portfolio before change:  [6.48729696]
curr_Stock_Price:  102.45878186969148
curr_Factors:  [102.45878187]
mat_Sqrt:  [[0.15]]
grads:  [0.26433348]
Stock Position:  0.2643334781182519
Bond Position:  [-20.59598921]


portfolio before change:  [6.57941684]
curr_Stock_Price:  102.81215052533311
curr_Factors:  [102.81215053]
mat_Sqrt:  [[0.15]]
grads:  [0.14615871]
Stock Position:  0.1461587074731011
Bond Position:  [-8.44747419]


portfolio before change:  [6.55038788]
curr_Stock_Price:  102.6171503396234
curr_Factors:  [102.61715034]
mat_Sqrt:  [[0.15]]
grads:  [0.58773257]
Stock Position:  0.587732574783557
Bond Position:  [-53.76105411]


portfolio before change:  [6.64886786]
curr_Stock_Price:  102.79042668962742
curr_Factors:  [102.79042669]
mat_Sqrt:  [[0.15]]
grads:  [0.08694442]
Stock Position:  0.086944419927506
Bond Position:  [-2.28818616]


portfolio before change:  [6.7126381]
curr_Stock_Price:  103.52553140540012
curr_Factors:  [103.52553141]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595239]
Stock Position:  -0.04595238642424545
Bond Position:  [11.46988333]


portfolio before change:  [6.68680974]
curr_Stock_Price:  104.10319999194297
curr_Factors:  [104.10319999]
mat_Sqrt:  [[0.15]]
grads:  [0.22537459]
Stock Position:  0.22537458710257938
Bond Position:  [-16.77540597]


portfolio before change:  [6.8279849]
curr_Stock_Price:  104.7342545437873
curr_Factors:  [104.73425454]
mat_Sqrt:  [[0.15]]
grads:  [0.10921317]
Stock Position:  0.10921316804868067
Bond Position:  [-4.61037484]


portfolio before change:  [6.7807281]
curr_Stock_Price:  104.30419061398443
curr_Factors:  [104.30419061]
mat_Sqrt:  [[0.15]]
grads:  [0.02635326]
Stock Position:  0.02635325662650573
Bond Position:  [4.031973]


portfolio before change:  [6.78093605]
curr_Stock_Price:  104.30251893674867
curr_Factors:  [104.30251894]
mat_Sqrt:  [[0.15]]
grads:  [0.09219387]
Stock Position:  0.09219386872086567
Bond Position:  [-2.83511668]


portfolio before change:  [6.80045224]
curr_Stock_Price:  104.51612739253898
curr_Factors:  [104.51612739]
mat_Sqrt:  [[0.15]]
grads:  [-0.06835838]
Stock Position:  -0.06835837755973465
Bond Position:  [13.94500514]


portfolio before change:  [6.83121816]
curr_Stock_Price:  104.07880980074151
curr_Factors:  [104.0788098]
mat_Sqrt:  [[0.15]]
grads:  [0.09932337]
Stock Position:  0.09932336796665146
Bond Position:  [-3.50623977]


portfolio before change:  [6.87947247]
curr_Stock_Price:  104.56684664336774
curr_Factors:  [104.56684664]
mat_Sqrt:  [[0.15]]
grads:  [-0.10774027]
Stock Position:  -0.10774026772452996
Bond Position:  [18.14553252]


portfolio before change:  [7.0266994]
curr_Stock_Price:  103.21087455310368
curr_Factors:  [103.21087455]
mat_Sqrt:  [[0.15]]
grads:  [0.07363388]
Stock Position:  0.073633883601201
Bond Position:  [-0.57311812]


portfolio before change:  [7.02427919]
curr_Stock_Price:  103.17849284113508
curr_Factors:  [103.17849284]
mat_Sqrt:  [[0.15]]
grads:  [-0.20224337]
Stock Position:  -0.20224336559092237
Bond Position:  [27.89144484]


portfolio before change:  [6.91351745]
curr_Stock_Price:  103.73477809716822
curr_Factors:  [103.7347781]
mat_Sqrt:  [[0.15]]
grads:  [0.05211722]
Stock Position:  0.05211722418174372
Bond Position:  [1.50714877]


portfolio before change:  [6.93789094]
curr_Stock_Price:  104.20063721959963
curr_Factors:  [104.20063722]
mat_Sqrt:  [[0.15]]
grads:  [0.0433046]
Stock Position:  0.04330460233300944
Bond Position:  [2.42552378]


portfolio before change:  [6.913454]
curr_Stock_Price:  103.63283297332309
curr_Factors:  [103.63283297]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247959]
Stock Position:  -0.03247958523968554
Bond Position:  [10.27940543]


portfolio before change:  [6.89347222]
curr_Stock_Price:  104.2678244858513
curr_Factors:  [104.26782449]
mat_Sqrt:  [[0.15]]
grads:  [0.11474026]
Stock Position:  0.11474025848669758
Bond Position:  [-5.07024491]


portfolio before change:  [6.83010281]
curr_Stock_Price:  103.7183005752251
curr_Factors:  [103.71830058]
mat_Sqrt:  [[0.15]]
grads:  [0.3376308]
Stock Position:  0.33763080487975133
Bond Position:  [-28.1883905]


portfolio before change:  [6.95435603]
curr_Stock_Price:  104.09153384474403
curr_Factors:  [104.09153384]
mat_Sqrt:  [[0.15]]
grads:  [0.0382127]
Stock Position:  0.03821269790262285
Bond Position:  [2.97673769]


portfolio before change:  [6.957285]
curr_Stock_Price:  104.16331418299349
curr_Factors:  [104.16331418]
mat_Sqrt:  [[0.15]]
grads:  [0.12956029]
Stock Position:  0.12956029316135798
Bond Position:  [-6.53814452]


portfolio before change:  [6.84878618]
curr_Stock_Price:  103.32902949979545
curr_Factors:  [103.3290295]
mat_Sqrt:  [[0.15]]
grads:  [-0.03000845]
Stock Position:  -0.03000845349011847
Bond Position:  [9.94953056]


portfolio before change:  [6.84241245]
curr_Stock_Price:  103.56215041382563
curr_Factors:  [103.56215041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094033]
Stock Position:  -0.0009403325507771794
Bond Position:  [6.93979531]


portfolio before change:  [6.84237604]
curr_Stock_Price:  104.06214240693724
curr_Factors:  [104.06214241]
mat_Sqrt:  [[0.15]]
grads:  [0.05454011]
Stock Position:  0.05454011235823258
Bond Position:  [1.1668151]


portfolio before change:  [6.84079405]
curr_Stock_Price:  104.03179926978515
curr_Factors:  [104.03179927]
mat_Sqrt:  [[0.15]]
grads:  [0.06794915]
Stock Position:  0.06794915293244995
Bond Position:  [-0.22807858]


portfolio before change:  [6.84198536]
curr_Stock_Price:  104.04954132540085
curr_Factors:  [104.04954133]
mat_Sqrt:  [[0.15]]
grads:  [0.04512431]
Stock Position:  0.045124307240396344
Bond Position:  [2.14682188]


portfolio before change:  [6.84582799]
curr_Stock_Price:  104.13172431152965
curr_Factors:  [104.13172431]
mat_Sqrt:  [[0.15]]
grads:  [-0.2165564]
Stock Position:  -0.21655640172563662
Bond Position:  [29.39621951]


portfolio before change:  [6.88865645]
curr_Stock_Price:  103.94243808971194
curr_Factors:  [103.94243809]
mat_Sqrt:  [[0.15]]
grads:  [0.05900055]
Stock Position:  0.05900055379083871
Bond Position:  [0.75599504]


portfolio before change:  [6.97439588]
curr_Stock_Price:  105.3948342067188
curr_Factors:  [105.39483421]
mat_Sqrt:  [[0.15]]
grads:  [0.11628576]
Stock Position:  0.11628575516024138
Bond Position:  [-5.28152201]


portfolio before change:  [7.00321049]
curr_Stock_Price:  105.64546438640261
curr_Factors:  [105.64546439]
mat_Sqrt:  [[0.15]]
grads:  [-0.05156309]
Stock Position:  -0.051563091914037656
Bond Position:  [12.45061728]


portfolio before change:  [7.07961906]
curr_Stock_Price:  104.17871029407101
curr_Factors:  [104.17871029]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615947]
Stock Position:  -0.026159474443042577
Bond Position:  [9.80487937]


portfolio before change:  [7.07758921]
curr_Stock_Price:  104.27973177384317
curr_Factors:  [104.27973177]
mat_Sqrt:  [[0.15]]
grads:  [-0.10892318]
Stock Position:  -0.10892317711612391
Bond Position:  [18.4360689]


portfolio before change:  [7.18079229]
curr_Stock_Price:  103.34282568280244
curr_Factors:  [103.34282568]
mat_Sqrt:  [[0.15]]
grads:  [0.13846893]
Stock Position:  0.13846892610084208
Bond Position:  [-7.1289778]


portfolio before change:  [7.24039937]
curr_Stock_Price:  103.77651619507427
curr_Factors:  [103.7765162]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563225]
Stock Position:  -0.015632249857856963
Bond Position:  [8.8626598]


portfolio before change:  [7.24688837]
curr_Stock_Price:  103.39684853551046
curr_Factors:  [103.39684854]
mat_Sqrt:  [[0.15]]
grads:  [0.02351782]
Stock Position:  0.023517824664661364
Bond Position:  [4.81521941]


portfolio before change:  [7.25788795]
curr_Stock_Price:  103.85176400775634
curr_Factors:  [103.85176401]
mat_Sqrt:  [[0.15]]
grads:  [-0.10946748]
Stock Position:  -0.10946747708550554
Bond Position:  [18.62627855]


portfolio before change:  [7.30047955]
curr_Stock_Price:  103.47331900314606
curr_Factors:  [103.473319]
mat_Sqrt:  [[0.15]]
grads:  [0.09716482]
Stock Position:  0.0971648238555491
Bond Position:  [-2.75348727]


portfolio before change:  [7.36040887]
curr_Stock_Price:  104.09187021382478
curr_Factors:  [104.09187021]
mat_Sqrt:  [[0.15]]
grads:  [0.07388945]
Stock Position:  0.0738894510345557
Bond Position:  [-0.33088228]


portfolio before change:  [7.33357606]
curr_Stock_Price:  103.72900209334709
curr_Factors:  [103.72900209]
mat_Sqrt:  [[0.15]]
grads:  [0.02802546]
Stock Position:  0.02802545712473951
Bond Position:  [4.42652336]


portfolio before change:  [7.31511121]
curr_Stock_Price:  103.0602702785433
curr_Factors:  [103.06027028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925999]
Stock Position:  -0.04925998724172239
Bond Position:  [12.39185881]


portfolio before change:  [7.2995859]
curr_Stock_Price:  103.39116421217726
curr_Factors:  [103.39116421]
mat_Sqrt:  [[0.15]]
grads:  [-0.20049933]
Stock Position:  -0.2004993324307448
Bond Position:  [28.0294453]


portfolio before change:  [7.10561486]
curr_Stock_Price:  104.36734170074446
curr_Factors:  [104.3673417]
mat_Sqrt:  [[0.15]]
grads:  [0.02146829]
Stock Position:  0.021468288542112607
Bond Position:  [4.86502665]


portfolio before change:  [7.12363358]
curr_Stock_Price:  105.19249606954482
curr_Factors:  [105.19249607]
mat_Sqrt:  [[0.15]]
grads:  [-0.06512443]
Stock Position:  -0.06512442567615667
Bond Position:  [13.97423448]


portfolio before change:  [7.12822458]
curr_Stock_Price:  105.1354117953827
curr_Factors:  [105.1354118]
mat_Sqrt:  [[0.15]]
grads:  [0.039203]
Stock Position:  0.03920300055282098
Bond Position:  [3.00660098]


portfolio before change:  [7.09919429]
curr_Stock_Price:  104.390106390371
curr_Factors:  [104.39010639]
mat_Sqrt:  [[0.15]]
grads:  [-0.0769488]
Stock Position:  -0.07694879990145749
Bond Position:  [15.1318877]


portfolio before change:  [7.16895716]
curr_Stock_Price:  103.49578318432923
curr_Factors:  [103.49578318]
mat_Sqrt:  [[0.15]]
grads:  [0.05972351]
Stock Position:  0.05972351468297174
Bond Position:  [0.98782524]


portfolio before change:  [7.15147305]
curr_Stock_Price:  103.20199843986003
curr_Factors:  [103.20199844]
mat_Sqrt:  [[0.15]]
grads:  [0.06632714]
Stock Position:  0.0663271365731179
Bond Position:  [0.30638]


portfolio before change:  [7.09181093]
curr_Stock_Price:  102.30219681967644
curr_Factors:  [102.30219682]
mat_Sqrt:  [[0.15]]
grads:  [-0.00390753]
Stock Position:  -0.003907532279281932
Bond Position:  [7.49156007]


portfolio before change:  [7.09386243]
curr_Stock_Price:  101.89701540289752
curr_Factors:  [101.8970154]
mat_Sqrt:  [[0.15]]
grads:  [0.01084322]
Stock Position:  0.010843220797439834
Bond Position:  [5.98897059]


portfolio before change:  [7.09740354]
curr_Stock_Price:  102.18906825963533
curr_Factors:  [102.18906826]
mat_Sqrt:  [[0.15]]
grads:  [0.10327509]
Stock Position:  0.1032750910461813
Bond Position:  [-3.45618179]


portfolio before change:  [6.98776074]
curr_Stock_Price:  101.12950216593126
curr_Factors:  [101.12950217]
mat_Sqrt:  [[0.15]]
grads:  [0.0030077]
Stock Position:  0.0030077020588237073
Bond Position:  [6.68359333]


portfolio before change:  [6.98679582]
curr_Stock_Price:  100.66979613556899
curr_Factors:  [100.66979614]
mat_Sqrt:  [[0.15]]
grads:  [-0.07965964]
Stock Position:  -0.07965963551700121
Bond Position:  [15.00611509]


portfolio before change:  [6.94387534]
curr_Stock_Price:  101.22036845361922
curr_Factors:  [101.22036845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04200291]
Stock Position:  -0.04200291015999329
Bond Position:  [11.19542538]


portfolio before change:  [6.93409072]
curr_Stock_Price:  101.46997866993111
curr_Factors:  [101.46997867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08546373]
Stock Position:  -0.08546373061739117
Bond Position:  [15.60609364]


portfolio before change:  [7.00909166]
curr_Stock_Price:  100.60381556421368
curr_Factors:  [100.60381556]
mat_Sqrt:  [[0.15]]
grads:  [-0.04988159]
Stock Position:  -0.049881588173990694
Bond Position:  [12.02736976]


portfolio before change:  [6.9716329]
curr_Stock_Price:  101.3698395361494
curr_Factors:  [101.36983954]
mat_Sqrt:  [[0.15]]
grads:  [-0.00319358]
Stock Position:  -0.0031935844629932034
Bond Position:  [7.29536605]


portfolio before change:  [6.97304834]
curr_Stock_Price:  101.06940658298733
curr_Factors:  [101.06940658]
mat_Sqrt:  [[0.15]]
grads:  [-0.03685487]
Stock Position:  -0.036854870756101284
Bond Position:  [10.69794825]


portfolio before change:  [6.97893382]
curr_Stock_Price:  100.92785577117589
curr_Factors:  [100.92785577]
mat_Sqrt:  [[0.15]]
grads:  [0.1360965]
Stock Position:  0.1360965027709611
Bond Position:  [-6.75699439]


portfolio before change:  [6.8448979]
curr_Stock_Price:  99.94609954344445
curr_Factors:  [99.94609954]
mat_Sqrt:  [[0.15]]
grads:  [-0.05759276]
Stock Position:  -0.057592763832906534
Bond Position:  [12.60107001]


portfolio before change:  [6.86082906]
curr_Stock_Price:  99.68315733621863
curr_Factors:  [99.68315734]
mat_Sqrt:  [[0.15]]
grads:  [0.03982858]
Stock Position:  0.03982858157526732
Bond Position:  [2.8905903]


portfolio before change:  [6.87826473]
curr_Stock_Price:  100.11638904038884
curr_Factors:  [100.11638904]
mat_Sqrt:  [[0.15]]
grads:  [-0.06718529]
Stock Position:  -0.06718528607734203
Bond Position:  [13.60461297]


portfolio before change:  [6.90954936]
curr_Stock_Price:  99.66339827908256
curr_Factors:  [99.66339828]
mat_Sqrt:  [[0.15]]
grads:  [0.07111872]
Stock Position:  0.07111872078932813
Bond Position:  [-0.17838403]


portfolio before change:  [6.90784785]
curr_Stock_Price:  99.63963004833899
curr_Factors:  [99.63963005]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609393]
Stock Position:  -0.04609393278313015
Bond Position:  [11.50063026]


portfolio before change:  [6.93923986]
curr_Stock_Price:  98.97418007452974
curr_Factors:  [98.97418007]
mat_Sqrt:  [[0.15]]
grads:  [0.05957773]
Stock Position:  0.05957773175061827
Bond Position:  [1.04258271]


portfolio before change:  [6.85070223]
curr_Stock_Price:  97.48700036337804
curr_Factors:  [97.48700036]
mat_Sqrt:  [[0.15]]
grads:  [-0.06906043]
Stock Position:  -0.06906043303517574
Bond Position:  [13.58319669]


portfolio before change:  [6.8505239]
curr_Stock_Price:  97.50187589786556
curr_Factors:  [97.5018759]
mat_Sqrt:  [[0.15]]
grads:  [-0.06477041]
Stock Position:  -0.06477041252586992
Bond Position:  [13.16576062]


portfolio before change:  [6.91608475]
curr_Stock_Price:  96.50237680991032
curr_Factors:  [96.50237681]
mat_Sqrt:  [[0.15]]
grads:  [0.02991933]
Stock Position:  0.029919327129981056
Bond Position:  [4.02879857]


portfolio before change:  [6.90706988]
curr_Stock_Price:  96.19265442128318
curr_Factors:  [96.19265442]
mat_Sqrt:  [[0.15]]
grads:  [0.03520998]
Stock Position:  0.035209983465212376
Bond Position:  [3.5201281]


portfolio before change:  [6.9068114]
curr_Stock_Price:  96.17906477010989
curr_Factors:  [96.17906477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.9068114]
Stock Price:  95.95097501515245
PL:  [6.9068114]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.23778276e-03]
 [-2.54371087e-03]
 [-6.44226612e-03]
 [ 5.82273820e-03]
 [-4.97359106e-03]
 [ 1.22772464e-02]
 [ 4.38212743e-03]
 [-2.53613435e-02]
 [-2.34398756e-02]
 [ 3.66198982e-02]
 [-3.81619917e-02]
 [ 2.97642773e-02]
 [-1.45283220e-02]
 [ 1.67908108e-03]
 [-7.00526395e-03]
 [ 1.02230891e-02]
 [ 9.34707372e-03]
 [ 3.54301251e-03]
 [ 2.48351561e-03]
 [ 8.26466904e-03]
 [ 1.25526410e-02]
 [-1.01476878e-02]
 [ 5.61001587e-03]
 [-3.87396665e-03]
 [-9.17473416e-03]
 [-5.61549796e-03]
 [-4.01843581e-03]
 [ 7.41789725e-03]
 [-1.35812411e-02]
 [-4.16798217e-05]
 [-5.20047219e-03]
 [-1.01507750e-02]
 [-5.89798505e-03]
 [ 5.14608739e-03]
 [ 1.29951320e-02]
 [ 1.69254293e-02]
 [-3.44707901e-02]
 [ 8.77716083e-03]
 [-1.97494606e-02]
 [ 1.85572545e-02]
 [-4.91181598e-03]
 [ 2.89011109e-03]
 [ 2.30547587e-02]
 [ 4.50862837e-03]
 [-6.32541573e-03]
 [-6.06748478e-03]
 [ 5.70318255e-04]
 [-1.21692430e-02]
 [-5.53767212e-03]
 [-2.38809692e-03]
 [ 4.64305168e-02]
 [-9.98841009e-03]
 [ 3.18316646e-03]
 [ 5.27516797e-03]
 [ 5.42332804e-03]
 [-2.96590120e-03]
 [ 4.16374100e-03]
 [-6.73186192e-04]
 [ 1.53023855e-03]
 [-4.38561073e-03]
 [-2.50736784e-03]
 [ 7.39680225e-03]
 [ 1.40878747e-02]
 [-1.86677229e-02]
 [-6.44994645e-03]
 [-1.40206440e-02]
 [-4.62969246e-03]
 [ 1.09469200e-02]
 [-1.05883555e-02]
 [ 6.86799628e-03]
 [-6.48515264e-03]
 [ 1.09478985e-02]
 [-3.33588122e-03]
 [ 8.74199095e-03]
 [-2.09660506e-02]
 [-4.51844755e-03]
 [-3.42363888e-03]
 [-2.19560995e-05]
 [-2.26864367e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.38162166]
curr_Stock_Price:  99.71238170504802
curr_Factors:  [99.71238171]
mat_Sqrt:  [[0.15]]
grads:  [0.02158522]
Stock Position:  0.021585218381045438
Bond Position:  [-4.53393519]


portfolio before change:  [-2.38626552]
curr_Stock_Price:  99.51036935777957
curr_Factors:  [99.51036936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01695807]
Stock Position:  -0.016958072475443245
Bond Position:  [-0.69876147]


portfolio before change:  [-2.36859796]
curr_Stock_Price:  98.4659561295563
curr_Factors:  [98.46595613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04294844]
Stock Position:  -0.04294844077829214
Bond Position:  [1.86036133]


portfolio before change:  [-2.36782981]
curr_Stock_Price:  98.45077811099405
curr_Factors:  [98.45077811]
mat_Sqrt:  [[0.15]]
grads:  [0.03881825]
Stock Position:  0.03881825465086762
Bond Position:  [-6.18951719]


portfolio before change:  [-2.37549336]
curr_Stock_Price:  98.26332269485268
curr_Factors:  [98.26332269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03315727]
Stock Position:  -0.03315727370066102
Bond Position:  [0.88265053]


portfolio before change:  [-2.37001582]
curr_Stock_Price:  98.09978775568595
curr_Factors:  [98.09978776]
mat_Sqrt:  [[0.15]]
grads:  [0.08184831]
Stock Position:  0.08184830903517264
Bond Position:  [-10.39931756]


portfolio before change:  [-2.41178459]
curr_Stock_Price:  97.59740976822508
curr_Factors:  [97.59740977]
mat_Sqrt:  [[0.15]]
grads:  [0.02921418]
Stock Position:  0.02921418284222858
Bond Position:  [-5.26301316]


portfolio before change:  [-2.40319189]
curr_Stock_Price:  97.90279710894282
curr_Factors:  [97.90279711]
mat_Sqrt:  [[0.15]]
grads:  [-0.16907562]
Stock Position:  -0.1690756231736451
Bond Position:  [14.14978454]


portfolio before change:  [-2.34437168]
curr_Stock_Price:  97.56013488363396
curr_Factors:  [97.56013488]
mat_Sqrt:  [[0.15]]
grads:  [-0.15626584]
Stock Position:  -0.15626583754161702
Bond Position:  [12.90094451]


portfolio before change:  [-2.25189414]
curr_Stock_Price:  96.97349865077987
curr_Factors:  [96.97349865]
mat_Sqrt:  [[0.15]]
grads:  [0.24413265]
Stock Position:  0.2441326549888626
Bond Position:  [-25.92629183]


portfolio before change:  [-2.04862562]
curr_Stock_Price:  97.81275123112401
curr_Factors:  [97.81275123]
mat_Sqrt:  [[0.15]]
grads:  [-0.25441328]
Stock Position:  -0.25441327797567814
Bond Position:  [22.83623705]


portfolio before change:  [-1.94639552]
curr_Stock_Price:  97.41653451845924
curr_Factors:  [97.41653452]
mat_Sqrt:  [[0.15]]
grads:  [0.19842852]
Stock Position:  0.198428515330778
Bond Position:  [-21.27661383]


portfolio before change:  [-1.81504309]
curr_Stock_Price:  98.08519977993511
curr_Factors:  [98.08519978]
mat_Sqrt:  [[0.15]]
grads:  [-0.09685548]
Stock Position:  -0.09685547986824238
Bond Position:  [7.685046]


portfolio before change:  [-1.73534918]
curr_Stock_Price:  97.26734639319325
curr_Factors:  [97.26734639]
mat_Sqrt:  [[0.15]]
grads:  [0.01119387]
Stock Position:  0.011193873867113126
Bond Position:  [-2.82414759]


portfolio before change:  [-1.72834746]
curr_Stock_Price:  97.9086112801551
curr_Factors:  [97.90861128]
mat_Sqrt:  [[0.15]]
grads:  [-0.04670176]
Stock Position:  -0.04670175968794192
Bond Position:  [2.84415698]


portfolio before change:  [-1.70797644]
curr_Stock_Price:  97.47622395347396
curr_Factors:  [97.47622395]
mat_Sqrt:  [[0.15]]
grads:  [0.06815393]
Stock Position:  0.06815392759772651
Bond Position:  [-8.35136395]


portfolio before change:  [-1.67057384]
curr_Stock_Price:  98.0326788319646
curr_Factors:  [98.03267883]
mat_Sqrt:  [[0.15]]
grads:  [0.06231382]
Stock Position:  0.062313824815464
Bond Position:  [-7.77936501]


portfolio before change:  [-1.71504793]
curr_Stock_Price:  97.32677012595532
curr_Factors:  [97.32677013]
mat_Sqrt:  [[0.15]]
grads:  [0.02362008]
Stock Position:  0.023620083425117434
Bond Position:  [-4.01391436]


portfolio before change:  [-1.71000888]
curr_Stock_Price:  97.55072901450227
curr_Factors:  [97.55072901]
mat_Sqrt:  [[0.15]]
grads:  [0.01655677]
Stock Position:  0.01655677074244814
Bond Position:  [-3.32513394]


portfolio before change:  [-1.7171809]
curr_Stock_Price:  97.13010434532495
curr_Factors:  [97.13010435]
mat_Sqrt:  [[0.15]]
grads:  [0.05509779]
Stock Position:  0.05509779360482863
Bond Position:  [-7.06883534]


portfolio before change:  [-1.69599973]
curr_Stock_Price:  97.52255164452981
curr_Factors:  [97.52255164]
mat_Sqrt:  [[0.15]]
grads:  [0.08368427]
Stock Position:  0.08368427313071808
Bond Position:  [-9.85710358]


portfolio before change:  [-1.72248416]
curr_Stock_Price:  97.21343331838013
curr_Factors:  [97.21343332]
mat_Sqrt:  [[0.15]]
grads:  [-0.06765125]
Stock Position:  -0.06765125230659842
Bond Position:  [4.85412634]


portfolio before change:  [-1.76259381]
curr_Stock_Price:  97.81080640863424
curr_Factors:  [97.81080641]
mat_Sqrt:  [[0.15]]
grads:  [0.03740011]
Stock Position:  0.03740010579749377
Bond Position:  [-5.42072831]


portfolio before change:  [-1.7568927]
curr_Stock_Price:  97.97230107151802
curr_Factors:  [97.97230107]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582644]
Stock Position:  -0.02582644432137719
Bond Position:  [0.77338348]


portfolio before change:  [-1.75580857]
curr_Stock_Price:  97.93219517670106
curr_Factors:  [97.93219518]
mat_Sqrt:  [[0.15]]
grads:  [-0.06116489]
Stock Position:  -0.061164894381621475
Bond Position:  [4.23420381]


portfolio before change:  [-1.80754847]
curr_Stock_Price:  98.78243052438813
curr_Factors:  [98.78243052]
mat_Sqrt:  [[0.15]]
grads:  [-0.03743665]
Stock Position:  -0.03743665305499677
Bond Position:  [1.89053511]


portfolio before change:  [-1.791182]
curr_Stock_Price:  98.34840914322001
curr_Factors:  [98.34840914]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678957]
Stock Position:  -0.026789572094805154
Bond Position:  [0.84352979]


portfolio before change:  [-1.79145745]
curr_Stock_Price:  98.36065887985704
curr_Factors:  [98.36065888]
mat_Sqrt:  [[0.15]]
grads:  [0.04945265]
Stock Position:  0.04945264831631487
Bond Position:  [-6.65565252]


portfolio before change:  [-1.77325748]
curr_Stock_Price:  98.73709901815973
curr_Factors:  [98.73709902]
mat_Sqrt:  [[0.15]]
grads:  [-0.09054161]
Stock Position:  -0.09054160705830712
Bond Position:  [7.16655814]


portfolio before change:  [-1.73914294]
curr_Stock_Price:  98.36526316023121
curr_Factors:  [98.36526316]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027787]
Stock Position:  -0.00027786547804751636
Bond Position:  [-1.71181063]


portfolio before change:  [-1.73937338]
curr_Stock_Price:  98.80955794004737
curr_Factors:  [98.80955794]
mat_Sqrt:  [[0.15]]
grads:  [-0.03466981]
Stock Position:  -0.03466981458933253
Bond Position:  [1.68633567]


portfolio before change:  [-1.7119417]
curr_Stock_Price:  98.02137126822184
curr_Factors:  [98.02137127]
mat_Sqrt:  [[0.15]]
grads:  [-0.06767183]
Stock Position:  -0.06767183360953641
Bond Position:  [4.92134423]


portfolio before change:  [-1.76943972]
curr_Stock_Price:  98.87557616584601
curr_Factors:  [98.87557617]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393199]
Stock Position:  -0.03931990034922234
Bond Position:  [2.11833809]


portfolio before change:  [-1.73390643]
curr_Stock_Price:  97.97524622762936
curr_Factors:  [97.97524623]
mat_Sqrt:  [[0.15]]
grads:  [0.03430725]
Stock Position:  0.034307249264511126
Bond Position:  [-5.09516763]


portfolio before change:  [-1.73237101]
curr_Stock_Price:  98.02928385584322
curr_Factors:  [98.02928386]
mat_Sqrt:  [[0.15]]
grads:  [0.08663421]
Stock Position:  0.0866342135189107
Bond Position:  [-10.22506092]


portfolio before change:  [-1.73619054]
curr_Stock_Price:  97.99257261085008
curr_Factors:  [97.99257261]
mat_Sqrt:  [[0.15]]
grads:  [0.1128362]
Stock Position:  0.11283619554801991
Bond Position:  [-12.79329963]


portfolio before change:  [-1.74756025]
curr_Stock_Price:  97.89889613268662
curr_Factors:  [97.89889613]
mat_Sqrt:  [[0.15]]
grads:  [-0.22980527]
Stock Position:  -0.2298052672883441
Bond Position:  [20.75012175]


portfolio before change:  [-1.73530393]
curr_Stock_Price:  97.85120621018186
curr_Factors:  [97.85120621]
mat_Sqrt:  [[0.15]]
grads:  [0.05851441]
Stock Position:  0.05851440553425464
Bond Position:  [-7.46100909]


portfolio before change:  [-1.72021691]
curr_Stock_Price:  98.11700993535958
curr_Factors:  [98.11700994]
mat_Sqrt:  [[0.15]]
grads:  [-0.13166307]
Stock Position:  -0.13166307035881647
Bond Position:  [11.19816987]


portfolio before change:  [-1.65931601]
curr_Stock_Price:  97.65977473701138
curr_Factors:  [97.65977474]
mat_Sqrt:  [[0.15]]
grads:  [0.12371503]
Stock Position:  0.12371502999327585
Bond Position:  [-13.74129797]


portfolio before change:  [-1.54772665]
curr_Stock_Price:  98.56870403785835
curr_Factors:  [98.56870404]
mat_Sqrt:  [[0.15]]
grads:  [-0.03274544]
Stock Position:  -0.03274543984020784
Bond Position:  [1.67994891]


portfolio before change:  [-1.55626616]
curr_Stock_Price:  98.83269505005958
curr_Factors:  [98.83269505]
mat_Sqrt:  [[0.15]]
grads:  [0.01926741]
Stock Position:  0.019267407290829524
Bond Position:  [-3.46051594]


portfolio before change:  [-1.58109633]
curr_Stock_Price:  97.55520709355348
curr_Factors:  [97.55520709]
mat_Sqrt:  [[0.15]]
grads:  [0.15369839]
Stock Position:  0.15369839155901352
Bond Position:  [-16.57517474]


portfolio before change:  [-1.50164218]
curr_Stock_Price:  98.07889590461079
curr_Factors:  [98.0788959]
mat_Sqrt:  [[0.15]]
grads:  [0.03005752]
Stock Position:  0.030057522476131453
Bond Position:  [-4.4496508]


portfolio before change:  [-1.48466627]
curr_Stock_Price:  98.65292931913098
curr_Factors:  [98.65292932]
mat_Sqrt:  [[0.15]]
grads:  [-0.04216944]
Stock Position:  -0.04216943820134647
Bond Position:  [2.67547234]


portfolio before change:  [-1.50560228]
curr_Stock_Price:  99.15336839720055
curr_Factors:  [99.1533684]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404499]
Stock Position:  -0.040449898564062045
Bond Position:  [2.50514141]


portfolio before change:  [-1.48279647]
curr_Stock_Price:  98.59343541495744
curr_Factors:  [98.59343541]
mat_Sqrt:  [[0.15]]
grads:  [0.00380212]
Stock Position:  0.0038021217020784218
Bond Position:  [-1.85766071]


portfolio before change:  [-1.486066]
curr_Stock_Price:  97.76405160890762
curr_Factors:  [97.76405161]
mat_Sqrt:  [[0.15]]
grads:  [-0.08112829]
Stock Position:  -0.08112828645066876
Bond Position:  [6.44536399]


portfolio before change:  [-1.46950534]
curr_Stock_Price:  97.56488794828286
curr_Factors:  [97.56488795]
mat_Sqrt:  [[0.15]]
grads:  [-0.03691781]
Stock Position:  -0.03691781412899003
Bond Position:  [2.13237706]


portfolio before change:  [-1.48160783]
curr_Stock_Price:  97.89632042126455
curr_Factors:  [97.89632042]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592065]
Stock Position:  -0.015920646154455438
Bond Position:  [0.07696485]


portfolio before change:  [-1.48834965]
curr_Stock_Price:  98.32008652694024
curr_Factors:  [98.32008653]
mat_Sqrt:  [[0.15]]
grads:  [0.30953678]
Stock Position:  0.30953677847595906
Bond Position:  [-31.92203249]


portfolio before change:  [-1.34371405]
curr_Stock_Price:  98.79379690815261
curr_Factors:  [98.79379691]
mat_Sqrt:  [[0.15]]
grads:  [-0.0665894]
Stock Position:  -0.06658940059177222
Bond Position:  [5.23490567]


portfolio before change:  [-1.3733088]
curr_Stock_Price:  99.24314680606504
curr_Factors:  [99.24314681]
mat_Sqrt:  [[0.15]]
grads:  [0.02122111]
Stock Position:  0.021221109735052954
Bond Position:  [-3.47935851]


portfolio before change:  [-1.39116017]
curr_Stock_Price:  98.41218623390127
curr_Factors:  [98.41218623]
mat_Sqrt:  [[0.15]]
grads:  [0.03516779]
Stock Position:  0.03516778645031008
Bond Position:  [-4.85209892]


portfolio before change:  [-1.39380102]
curr_Stock_Price:  98.34571689977004
curr_Factors:  [98.3457169]
mat_Sqrt:  [[0.15]]
grads:  [0.03615552]
Stock Position:  0.036155520293784965
Bond Position:  [-4.94954158]


portfolio before change:  [-1.38532554]
curr_Stock_Price:  98.58869050210949
curr_Factors:  [98.5886905]
mat_Sqrt:  [[0.15]]
grads:  [-0.01977267]
Stock Position:  -0.01977267467852064
Bond Position:  [0.56403657]


portfolio before change:  [-1.36327489]
curr_Stock_Price:  97.47526522768747
curr_Factors:  [97.47526523]
mat_Sqrt:  [[0.15]]
grads:  [0.02775827]
Stock Position:  0.027758273343220306
Bond Position:  [-4.06901994]


portfolio before change:  [-1.35647954]
curr_Stock_Price:  97.7292317967702
curr_Factors:  [97.7292318]
mat_Sqrt:  [[0.15]]
grads:  [-0.00448791]
Stock Position:  -0.004487907945348342
Bond Position:  [-0.91787974]


portfolio before change:  [-1.35731379]
curr_Stock_Price:  97.90233818756113
curr_Factors:  [97.90233819]
mat_Sqrt:  [[0.15]]
grads:  [0.01020159]
Stock Position:  0.010201590315951588
Bond Position:  [-2.35607334]


portfolio before change:  [-1.3626262]
curr_Stock_Price:  97.39603002974287
curr_Factors:  [97.39603003]
mat_Sqrt:  [[0.15]]
grads:  [-0.0292374]
Stock Position:  -0.029237404888793943
Bond Position:  [1.48498097]


portfolio before change:  [-1.3600676]
curr_Stock_Price:  97.31169340303539
curr_Factors:  [97.3116934]
mat_Sqrt:  [[0.15]]
grads:  [-0.01671579]
Stock Position:  -0.016715785576765712
Bond Position:  [0.2665738]


portfolio before change:  [-1.35443553]
curr_Stock_Price:  96.97575922222461
curr_Factors:  [96.97575922]
mat_Sqrt:  [[0.15]]
grads:  [0.04931201]
Stock Position:  0.04931201498375498
Bond Position:  [-6.13650563]


portfolio before change:  [-1.36264564]
curr_Stock_Price:  96.81704412800703
curr_Factors:  [96.81704413]
mat_Sqrt:  [[0.15]]
grads:  [0.09391916]
Stock Position:  0.09391916477083383
Bond Position:  [-10.45562156]


portfolio before change:  [-1.37577937]
curr_Stock_Price:  96.68416145319705
curr_Factors:  [96.68416145]
mat_Sqrt:  [[0.15]]
grads:  [-0.12445149]
Stock Position:  -0.12445148623545196
Bond Position:  [10.65670822]


portfolio before change:  [-1.37082513]
curr_Stock_Price:  96.6497048666773
curr_Factors:  [96.64970487]
mat_Sqrt:  [[0.15]]
grads:  [-0.04299964]
Stock Position:  -0.04299964302255775
Bond Position:  [2.78507768]


portfolio before change:  [-1.35737902]
curr_Stock_Price:  96.34105023624264
curr_Factors:  [96.34105024]
mat_Sqrt:  [[0.15]]
grads:  [-0.09347096]
Stock Position:  -0.09347096003268725
Bond Position:  [7.64771144]


portfolio before change:  [-1.34406073]
curr_Stock_Price:  96.20367830298078
curr_Factors:  [96.2036783]
mat_Sqrt:  [[0.15]]
grads:  [-0.03086462]
Stock Position:  -0.0308646164278486
Bond Position:  [1.6252289]


portfolio before change:  [-1.35021538]
curr_Stock_Price:  96.4063772382165
curr_Factors:  [96.40637724]
mat_Sqrt:  [[0.15]]
grads:  [0.07297947]
Stock Position:  0.07297946661266784
Bond Position:  [-8.38590137]


portfolio before change:  [-1.27878165]
curr_Stock_Price:  97.3923787453794
curr_Factors:  [97.39237875]
mat_Sqrt:  [[0.15]]
grads:  [-0.07058904]
Stock Position:  -0.07058903696629247
Bond Position:  [5.59605258]


portfolio before change:  [-1.32616441]
curr_Stock_Price:  98.06858182566413
curr_Factors:  [98.06858183]
mat_Sqrt:  [[0.15]]
grads:  [0.04578664]
Stock Position:  0.04578664184206541
Bond Position:  [-5.81639544]


portfolio before change:  [-1.2994773]
curr_Stock_Price:  98.65937962405494
curr_Factors:  [98.65937962]
mat_Sqrt:  [[0.15]]
grads:  [-0.04323435]
Stock Position:  -0.04323435095386712
Bond Position:  [2.96599695]


portfolio before change:  [-1.29714979]
curr_Stock_Price:  98.60983271391694
curr_Factors:  [98.60983271]
mat_Sqrt:  [[0.15]]
grads:  [0.07298599]
Stock Position:  0.07298598996482118
Bond Position:  [-8.49428605]


portfolio before change:  [-1.30684727]
curr_Stock_Price:  98.4842390791875
curr_Factors:  [98.48423908]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223921]
Stock Position:  -0.02223920813800094
Bond Position:  [0.88336422]


portfolio before change:  [-1.31540132]
curr_Stock_Price:  98.87135970596944
curr_Factors:  [98.87135971]
mat_Sqrt:  [[0.15]]
grads:  [0.05827994]
Stock Position:  0.058279939695002836
Bond Position:  [-7.0776182]


portfolio before change:  [-1.25687121]
curr_Stock_Price:  99.88324255929436
curr_Factors:  [99.88324256]
mat_Sqrt:  [[0.15]]
grads:  [-0.13977367]
Stock Position:  -0.1397736707081275
Bond Position:  [12.70417624]


portfolio before change:  [-1.17681981]
curr_Stock_Price:  99.31620180982725
curr_Factors:  [99.31620181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03012298]
Stock Position:  -0.030122983639962766
Bond Position:  [1.81488051]


portfolio before change:  [-1.17543797]
curr_Stock_Price:  99.27409437907932
curr_Factors:  [99.27409438]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282426]
Stock Position:  -0.022824259210022634
Bond Position:  [1.09041969]


portfolio before change:  [-1.16574584]
curr_Stock_Price:  98.85243845154477
curr_Factors:  [98.85243845]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014637]
Stock Position:  -0.00014637399654054658
Bond Position:  [-1.15127641]


portfolio before change:  [-1.16590046]
curr_Stock_Price:  99.41718152755288
curr_Factors:  [99.41718153]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.16590046]
Stock Price:  100.26775555264032
PL:  [-1.43365601]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.43857558e-03]
 [-2.37306413e-04]
 [-2.31609720e-03]
 [ 6.86204473e-03]
 [-3.91418835e-03]
 [ 1.12453159e-02]
 [ 3.32089349e-03]
 [-2.58401674e-02]
 [ 1.09504937e-03]
 [ 2.44304669e-02]
 [-5.23377118e-03]
 [ 2.42010085e-02]
 [-1.18231801e-02]
 [ 3.45462756e-03]
 [-7.01430721e-03]
 [ 1.07700904e-02]
 [ 1.41549546e-02]
 [ 3.36333241e-02]
 [ 8.25001935e-04]
 [ 1.13329036e-02]
 [ 1.29654841e-02]
 [-1.07993365e-02]
 [ 2.73702771e-03]
 [-5.10073626e-02]
 [-1.25998208e-02]
 [-3.45480125e-03]
 [-1.19077409e-03]
 [ 8.93850786e-03]
 [-1.60063706e-02]
 [-3.99636032e-04]
 [-5.01876184e-03]
 [-1.07160897e-02]
 [-1.48474979e-03]
 [ 5.86793333e-03]
 [ 1.15131984e-02]
 [ 8.76373208e-03]
 [-3.33005438e-02]
 [ 9.27687923e-03]
 [ 4.45585932e-04]
 [ 1.91602790e-02]
 [-4.84432340e-03]
 [-2.13413466e-02]
 [ 2.19687552e-02]
 [ 2.57758526e-03]
 [-5.71003841e-03]
 [-3.33784171e-03]
 [ 9.82547734e-03]
 [-1.20056079e-02]
 [-1.43837802e-02]
 [-7.09702276e-03]
 [ 3.36905096e-02]
 [-5.48402595e-03]
 [-4.43522071e-03]
 [ 5.45351588e-03]
 [-9.14919507e-04]
 [-1.09501528e-03]
 [ 7.41446883e-03]
 [-7.25330774e-04]
 [ 1.65410884e-03]
 [ 1.46795033e-02]
 [-1.23463864e-03]
 [-3.73755478e-04]
 [-3.08367834e-03]
 [-1.25608251e-02]
 [ 6.47721459e-03]
 [ 2.63816878e-03]
 [-5.41529575e-03]
 [ 1.50234143e-02]
 [-8.26130738e-03]
 [ 1.06940463e-02]
 [-1.12131207e-02]
 [ 1.10248342e-02]
 [-3.73059043e-03]
 [ 1.83024809e-02]
 [-2.24788060e-02]
 [-1.69791061e-03]
 [-1.03430021e-02]
 [-1.95042150e-03]
 [ 2.03489320e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.26450648]
curr_Stock_Price:  99.65497215594252
curr_Factors:  [99.65497216]
mat_Sqrt:  [[0.15]]
grads:  [0.02292384]
Stock Position:  0.022923837192264766
Bond Position:  [-5.54898084]


portfolio before change:  [-3.26533055]
curr_Stock_Price:  99.63415320109088
curr_Factors:  [99.6341532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158204]
Stock Position:  -0.0015820427508689602
Bond Position:  [-3.10770506]


portfolio before change:  [-3.26473807]
curr_Stock_Price:  99.13687282606979
curr_Factors:  [99.13687283]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544065]
Stock Position:  -0.01544064801622402
Bond Position:  [-1.73400051]


portfolio before change:  [-3.25984631]
curr_Stock_Price:  98.8130434843093
curr_Factors:  [98.81304348]
mat_Sqrt:  [[0.15]]
grads:  [0.04574696]
Stock Position:  0.04574696487570485
Bond Position:  [-7.78024314]


portfolio before change:  [-3.27888468]
curr_Stock_Price:  98.40750644470585
curr_Factors:  [98.40750644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609459]
Stock Position:  -0.02609458900202732
Bond Position:  [-0.71098125]


portfolio before change:  [-3.26661142]
curr_Stock_Price:  97.9354659454919
curr_Factors:  [97.93546595]
mat_Sqrt:  [[0.15]]
grads:  [0.07496877]
Stock Position:  0.07496877299553414
Bond Position:  [-10.60871313]


portfolio before change:  [-3.25762228]
curr_Stock_Price:  98.06421554451796
curr_Factors:  [98.06421554]
mat_Sqrt:  [[0.15]]
grads:  [0.02213929]
Stock Position:  0.02213928995093192
Bond Position:  [-5.42869439]


portfolio before change:  [-3.26422439]
curr_Stock_Price:  97.78133398287697
curr_Factors:  [97.78133398]
mat_Sqrt:  [[0.15]]
grads:  [-0.17226778]
Stock Position:  -0.17226778260170933
Bond Position:  [13.5803492]


portfolio before change:  [-3.44850492]
curr_Stock_Price:  98.85599418107964
curr_Factors:  [98.85599418]
mat_Sqrt:  [[0.15]]
grads:  [0.00730033]
Stock Position:  0.007300329102199361
Bond Position:  [-4.17018621]


portfolio before change:  [-3.45188832]
curr_Stock_Price:  98.42823780627376
curr_Factors:  [98.42823781]
mat_Sqrt:  [[0.15]]
grads:  [0.16286978]
Stock Position:  0.16286977906155414
Bond Position:  [-19.48287367]


portfolio before change:  [-3.44417709]
curr_Stock_Price:  98.48306045274488
curr_Factors:  [98.48306045]
mat_Sqrt:  [[0.15]]
grads:  [-0.03489181]
Stock Position:  -0.0348918078831297
Bond Position:  [-0.00792506]


portfolio before change:  [-3.43962614]
curr_Stock_Price:  98.35261592524284
curr_Factors:  [98.35261593]
mat_Sqrt:  [[0.15]]
grads:  [0.16134006]
Stock Position:  0.16134005672233148
Bond Position:  [-19.30784277]


portfolio before change:  [-3.57270424]
curr_Stock_Price:  97.53526577778709
curr_Factors:  [97.53526578]
mat_Sqrt:  [[0.15]]
grads:  [-0.0788212]
Stock Position:  -0.07882120067781438
Bond Position:  [4.11514252]


portfolio before change:  [-3.58611867]
curr_Stock_Price:  97.70871710688199
curr_Factors:  [97.70871711]
mat_Sqrt:  [[0.15]]
grads:  [0.02303085]
Stock Position:  0.023030850397654085
Bond Position:  [-5.83643352]


portfolio before change:  [-3.58589709]
curr_Stock_Price:  97.7341773300751
curr_Factors:  [97.73417733]
mat_Sqrt:  [[0.15]]
grads:  [-0.04676205]
Stock Position:  -0.04676204804984877
Bond Position:  [0.9843532]


portfolio before change:  [-3.56160637]
curr_Stock_Price:  97.2160392852456
curr_Factors:  [97.21603929]
mat_Sqrt:  [[0.15]]
grads:  [0.0718006]
Stock Position:  0.07180060291668776
Bond Position:  [-10.54177661]


portfolio before change:  [-3.60280697]
curr_Stock_Price:  96.65139613742461
curr_Factors:  [96.65139614]
mat_Sqrt:  [[0.15]]
grads:  [0.09436636]
Stock Position:  0.09436636424573477
Bond Position:  [-12.72344782]


portfolio before change:  [-3.70542458]
curr_Stock_Price:  95.5723848464608
curr_Factors:  [95.57238485]
mat_Sqrt:  [[0.15]]
grads:  [0.22422216]
Stock Position:  0.22422216088076413
Bond Position:  [-25.13487124]


portfolio before change:  [-3.61658085]
curr_Stock_Price:  95.97562202030467
curr_Factors:  [95.97562202]
mat_Sqrt:  [[0.15]]
grads:  [0.00550001]
Stock Position:  0.005500012898589845
Bond Position:  [-4.14444801]


portfolio before change:  [-3.61436272]
curr_Stock_Price:  96.42601553989851
curr_Factors:  [96.42601554]
mat_Sqrt:  [[0.15]]
grads:  [0.07555269]
Stock Position:  0.0755526904043613
Bond Position:  [-10.89960762]


portfolio before change:  [-3.59821357]
curr_Stock_Price:  96.64877919435065
curr_Factors:  [96.64877919]
mat_Sqrt:  [[0.15]]
grads:  [0.08643656]
Stock Position:  0.08643656070788644
Bond Position:  [-11.95220164]


portfolio before change:  [-3.61978132]
curr_Stock_Price:  96.40790063156028
curr_Factors:  [96.40790063]
mat_Sqrt:  [[0.15]]
grads:  [-0.07199558]
Stock Position:  -0.07199557635987441
Bond Position:  [3.32116105]


portfolio before change:  [-3.64528351]
curr_Stock_Price:  96.76500270778564
curr_Factors:  [96.76500271]
mat_Sqrt:  [[0.15]]
grads:  [0.01824685]
Stock Position:  0.018246851404650946
Bond Position:  [-5.41094014]


portfolio before change:  [-3.64908162]
curr_Stock_Price:  96.57538554811535
curr_Factors:  [96.57538555]
mat_Sqrt:  [[0.15]]
grads:  [-0.34004908]
Stock Position:  -0.3400490840824779
Bond Position:  [29.19128978]


portfolio before change:  [-3.44732394]
curr_Stock_Price:  95.98743167610378
curr_Factors:  [95.98743168]
mat_Sqrt:  [[0.15]]
grads:  [-0.08399881]
Stock Position:  -0.08399880510266061
Bond Position:  [4.61550563]


portfolio before change:  [-3.50325619]
curr_Stock_Price:  96.65673568133018
curr_Factors:  [96.65673568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303201]
Stock Position:  -0.023032008363793578
Bond Position:  [-1.27705745]


portfolio before change:  [-3.51238594]
curr_Stock_Price:  97.0496638555874
curr_Factors:  [97.04966386]
mat_Sqrt:  [[0.15]]
grads:  [-0.00793849]
Stock Position:  -0.007938493948633924
Bond Position:  [-2.74195777]


portfolio before change:  [-3.51689292]
curr_Stock_Price:  97.59581330599704
curr_Factors:  [97.59581331]
mat_Sqrt:  [[0.15]]
grads:  [0.05959005]
Stock Position:  0.05959005238804799
Bond Position:  [-9.33263255]


portfolio before change:  [-3.46930148]
curr_Stock_Price:  98.4042493024052
curr_Factors:  [98.4042493]
mat_Sqrt:  [[0.15]]
grads:  [-0.10670914]
Stock Position:  -0.10670913726088742
Bond Position:  [7.03133106]


portfolio before change:  [-3.48227824]
curr_Stock_Price:  98.52997638190384
curr_Factors:  [98.52997638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00266424]
Stock Position:  -0.0026642402157467946
Bond Position:  [-3.21977071]


portfolio before change:  [-3.4844814]
curr_Stock_Price:  99.28137865629299
curr_Factors:  [99.28137866]
mat_Sqrt:  [[0.15]]
grads:  [-0.03345841]
Stock Position:  -0.033458412251277
Bond Position:  [-0.1626841]


portfolio before change:  [-3.4657165]
curr_Stock_Price:  98.72023228831462
curr_Factors:  [98.72023229]
mat_Sqrt:  [[0.15]]
grads:  [-0.0714406]
Stock Position:  -0.07144059822285859
Bond Position:  [3.58691595]


portfolio before change:  [-3.5180979]
curr_Stock_Price:  99.45658654275638
curr_Factors:  [99.45658654]
mat_Sqrt:  [[0.15]]
grads:  [-0.00989833]
Stock Position:  -0.00989833194279561
Bond Position:  [-2.53364359]


portfolio before change:  [-3.52610109]
curr_Stock_Price:  100.24912757983088
curr_Factors:  [100.24912758]
mat_Sqrt:  [[0.15]]
grads:  [0.03911956]
Stock Position:  0.03911955550403193
Bond Position:  [-7.4478024]


portfolio before change:  [-3.52357221]
curr_Stock_Price:  100.32567188846079
curr_Factors:  [100.32567189]
mat_Sqrt:  [[0.15]]
grads:  [0.07675466]
Stock Position:  0.07675465628425819
Bond Position:  [-11.22403468]


portfolio before change:  [-3.45567189]
curr_Stock_Price:  101.21945276877707
curr_Factors:  [101.21945277]
mat_Sqrt:  [[0.15]]
grads:  [0.05842488]
Stock Position:  0.05842488050986208
Bond Position:  [-9.36940633]


portfolio before change:  [-3.37963198]
curr_Stock_Price:  102.5309748509225
curr_Factors:  [102.53097485]
mat_Sqrt:  [[0.15]]
grads:  [-0.22200363]
Stock Position:  -0.22200362545136101
Bond Position:  [19.38261616]


portfolio before change:  [-3.38498435]
curr_Stock_Price:  102.56054111888618
curr_Factors:  [102.56054112]
mat_Sqrt:  [[0.15]]
grads:  [0.06184586]
Stock Position:  0.061845861533014225
Bond Position:  [-9.72792937]


portfolio before change:  [-3.47724754]
curr_Stock_Price:  101.07854738007559
curr_Factors:  [101.07854738]
mat_Sqrt:  [[0.15]]
grads:  [0.00297057]
Stock Position:  0.002970572876705632
Bond Position:  [-3.77750873]


portfolio before change:  [-3.47573451]
curr_Stock_Price:  101.66736847773629
curr_Factors:  [101.66736848]
mat_Sqrt:  [[0.15]]
grads:  [0.12773519]
Stock Position:  0.12773519320826623
Bond Position:  [-16.46223546]


portfolio before change:  [-3.40200262]
curr_Stock_Price:  102.25264809470698
curr_Factors:  [102.25264809]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229549]
Stock Position:  -0.03229548934874901
Bond Position:  [-0.09970332]


portfolio before change:  [-3.40144589]
curr_Stock_Price:  102.23521645343868
curr_Factors:  [102.23521645]
mat_Sqrt:  [[0.15]]
grads:  [-0.14227564]
Stock Position:  -0.14227564394836031
Bond Position:  [11.14413536]


portfolio before change:  [-3.30408291]
curr_Stock_Price:  101.5557856508188
curr_Factors:  [101.55578565]
mat_Sqrt:  [[0.15]]
grads:  [0.14645837]
Stock Position:  0.14645836807486362
Bond Position:  [-18.17777754]


portfolio before change:  [-3.38517939]
curr_Stock_Price:  101.00982614962483
curr_Factors:  [101.00982615]
mat_Sqrt:  [[0.15]]
grads:  [0.0171839]
Stock Position:  0.0171839017273357
Bond Position:  [-5.12092232]


portfolio before change:  [-3.37604129]
curr_Stock_Price:  101.5602349698807
curr_Factors:  [101.56023497]
mat_Sqrt:  [[0.15]]
grads:  [-0.03806692]
Stock Position:  -0.03806692271273339
Bond Position:  [0.49004433]


portfolio before change:  [-3.37005391]
curr_Stock_Price:  101.40375396742277
curr_Factors:  [101.40375397]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225228]
Stock Position:  -0.02225227808734904
Bond Position:  [-1.11358938]


portfolio before change:  [-3.35642473]
curr_Stock_Price:  100.78814172228115
curr_Factors:  [100.78814172]
mat_Sqrt:  [[0.15]]
grads:  [0.06550318]
Stock Position:  0.06550318224419191
Bond Position:  [-9.95836875]


portfolio before change:  [-3.4108028]
curr_Stock_Price:  99.96748470566921
curr_Factors:  [99.96748471]
mat_Sqrt:  [[0.15]]
grads:  [-0.08003739]
Stock Position:  -0.08003738595480332
Bond Position:  [4.59033336]


portfolio before change:  [-3.3994164]
curr_Stock_Price:  99.82880583483436
curr_Factors:  [99.82880583]
mat_Sqrt:  [[0.15]]
grads:  [-0.09589187]
Stock Position:  -0.09589186805289736
Bond Position:  [6.17335428]


portfolio before change:  [-3.4373781]
curr_Stock_Price:  100.2287098827925
curr_Factors:  [100.22870988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04731349]
Stock Position:  -0.047313485057876595
Bond Position:  [1.30479147]


portfolio before change:  [-3.45720573]
curr_Stock_Price:  100.6495027987996
curr_Factors:  [100.6495028]
mat_Sqrt:  [[0.15]]
grads:  [0.2246034]
Stock Position:  0.22460339720425443
Bond Position:  [-26.06342598]


portfolio before change:  [-3.34863347]
curr_Stock_Price:  101.14015108010526
curr_Factors:  [101.14015108]
mat_Sqrt:  [[0.15]]
grads:  [-0.03656017]
Stock Position:  -0.036560173031944504
Bond Position:  [0.34906795]


portfolio before change:  [-3.36937553]
curr_Stock_Price:  101.70808823521435
curr_Factors:  [101.70808824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956814]
Stock Position:  -0.029568138088450973
Bond Position:  [-0.36205674]


portfolio before change:  [-3.37400232]
curr_Stock_Price:  101.86380158325981
curr_Factors:  [101.86380158]
mat_Sqrt:  [[0.15]]
grads:  [0.03635677]
Stock Position:  0.036356772533825125
Bond Position:  [-7.07744138]


portfolio before change:  [-3.36241523]
curr_Stock_Price:  102.19467366120999
curr_Factors:  [102.19467366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00609946]
Stock Position:  -0.006099463380405667
Bond Position:  [-2.73908256]


portfolio before change:  [-3.35896074]
curr_Stock_Price:  101.60024663461596
curr_Factors:  [101.60024663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073001]
Stock Position:  -0.007300101848675203
Bond Position:  [-2.61726859]


portfolio before change:  [-3.35845208]
curr_Stock_Price:  101.50815988310487
curr_Factors:  [101.50815988]
mat_Sqrt:  [[0.15]]
grads:  [0.04942979]
Stock Position:  0.04942979220726371
Bond Position:  [-8.37597933]


portfolio before change:  [-3.34102038]
curr_Stock_Price:  101.87140674061722
curr_Factors:  [101.87140674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483554]
Stock Position:  -0.004835538490618941
Bond Position:  [-2.84841727]


portfolio before change:  [-3.34327105]
curr_Stock_Price:  102.3000328380198
curr_Factors:  [102.30003284]
mat_Sqrt:  [[0.15]]
grads:  [0.01102739]
Stock Position:  0.011027392285044173
Bond Position:  [-4.47137364]


portfolio before change:  [-3.3506499]
curr_Stock_Price:  101.65623775238954
curr_Factors:  [101.65623775]
mat_Sqrt:  [[0.15]]
grads:  [0.09786336]
Stock Position:  0.09786335500846392
Bond Position:  [-13.29907039]


portfolio before change:  [-3.33699102]
curr_Stock_Price:  101.80430236360512
curr_Factors:  [101.80430236]
mat_Sqrt:  [[0.15]]
grads:  [-0.00823092]
Stock Position:  -0.008230924296630191
Bond Position:  [-2.49904751]


portfolio before change:  [-3.33669106]
curr_Stock_Price:  101.74888266539901
curr_Factors:  [101.74888267]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024917]
Stock Position:  -0.0024917031889483644
Bond Position:  [-3.08316304]


portfolio before change:  [-3.33730191]
curr_Stock_Price:  101.91669905511274
curr_Factors:  [101.91669906]
mat_Sqrt:  [[0.15]]
grads:  [-0.02055786]
Stock Position:  -0.020557855622551868
Bond Position:  [-1.24211313]


portfolio before change:  [-3.36717524]
curr_Stock_Price:  103.36605706066148
curr_Factors:  [103.36605706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373883]
Stock Position:  -0.08373883385540827
Bond Position:  [5.28857784]


portfolio before change:  [-3.38604102]
curr_Stock_Price:  103.595297535943
curr_Factors:  [103.59529754]
mat_Sqrt:  [[0.15]]
grads:  [0.04318143]
Stock Position:  0.04318143056792195
Bond Position:  [-7.85943417]


portfolio before change:  [-3.39859421]
curr_Stock_Price:  103.31596549822741
curr_Factors:  [103.3159655]
mat_Sqrt:  [[0.15]]
grads:  [0.01758779]
Stock Position:  0.017587791897709697
Bond Position:  [-5.21569391]


portfolio before change:  [-3.39347031]
curr_Stock_Price:  103.62583310461434
curr_Factors:  [103.6258331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03610197]
Stock Position:  -0.03610197168680649
Bond Position:  [0.34762658]


portfolio before change:  [-3.37998795]
curr_Stock_Price:  103.25298252572843
curr_Factors:  [103.25298253]
mat_Sqrt:  [[0.15]]
grads:  [0.1001561]
Stock Position:  0.10015609553797118
Bond Position:  [-13.72140353]


portfolio before change:  [-3.42376678]
curr_Stock_Price:  102.82443929411184
curr_Factors:  [102.82443929]
mat_Sqrt:  [[0.15]]
grads:  [-0.05507538]
Stock Position:  -0.05507538252687224
Bond Position:  [2.23932855]


portfolio before change:  [-3.38109193]
curr_Stock_Price:  102.05213636067627
curr_Factors:  [102.05213636]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-10.65676042]


portfolio before change:  [-3.43277828]
curr_Stock_Price:  101.33650068064316
curr_Factors:  [101.33650068]
mat_Sqrt:  [[0.15]]
grads:  [-0.07475414]
Stock Position:  -0.07475413823128335
Bond Position:  [4.1425445]


portfolio before change:  [-3.38746656]
curr_Stock_Price:  100.73382098457135
curr_Factors:  [100.73382098]
mat_Sqrt:  [[0.15]]
grads:  [0.07349889]
Stock Position:  0.073498894516964
Bond Position:  [-10.79129104]


portfolio before change:  [-3.32577985]
curr_Stock_Price:  101.58228522891487
curr_Factors:  [101.58228523]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248706]
Stock Position:  -0.024870602894592517
Bond Position:  [-0.79936717]


portfolio before change:  [-3.32017727]
curr_Stock_Price:  101.35500722644007
curr_Factors:  [101.35500723]
mat_Sqrt:  [[0.15]]
grads:  [0.12201654]
Stock Position:  0.12201653907015084
Bond Position:  [-15.68716447]


portfolio before change:  [-3.26164226]
curr_Stock_Price:  101.84277295897346
curr_Factors:  [101.84277296]
mat_Sqrt:  [[0.15]]
grads:  [-0.14985871]
Stock Position:  -0.14985870670481913
Bond Position:  [12.00038398]


portfolio before change:  [-3.33446431]
curr_Stock_Price:  102.33371604586753
curr_Factors:  [102.33371605]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113194]
Stock Position:  -0.011319404065491694
Bond Position:  [-2.17610763]


portfolio before change:  [-3.33281424]
curr_Stock_Price:  102.17592648812891
curr_Factors:  [102.17592649]
mat_Sqrt:  [[0.15]]
grads:  [-0.06895335]
Stock Position:  -0.06895334756905395
Bond Position:  [3.71255793]


portfolio before change:  [-3.3242943]
curr_Stock_Price:  102.05573079698416
curr_Factors:  [102.0557308]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300281]
Stock Position:  -0.0130028099677328
Bond Position:  [-1.99728303]


portfolio before change:  [-3.32057099]
curr_Stock_Price:  101.75978375404783
curr_Factors:  [101.75978375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.32057099]
Stock Price:  101.51327948954827
PL:  [-4.83385048]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.79381688e-03]
 [-1.32006234e-02]
 [-7.84840568e-04]
 [ 7.21602742e-03]
 [ 3.48445185e-03]
 [ 2.36936813e-02]
 [ 9.01592454e-04]
 [-1.73760155e-02]
 [ 5.98972864e-03]
 [ 2.08253558e-02]
 [-8.47575143e-03]
 [ 1.46883121e-02]
 [ 5.17239373e-03]
 [ 2.20242470e-03]
 [-6.91512072e-03]
 [ 1.32326880e-02]
 [ 9.06562319e-03]
 [-1.18113049e-02]
 [-5.60922804e-04]
 [-1.88056970e-04]
 [ 1.23773628e-02]
 [-7.15201500e-03]
 [ 6.81666515e-03]
 [ 3.63049056e-02]
 [-8.06157315e-03]
 [-6.14405074e-03]
 [-5.63268178e-03]
 [ 7.76270962e-03]
 [-1.24833205e-02]
 [-2.48474662e-03]
 [ 6.06859341e-03]
 [-1.16670798e-02]
 [ 8.04441962e-03]
 [ 8.46745735e-03]
 [ 1.04687185e-02]
 [ 5.51812463e-03]
 [-3.17943272e-02]
 [ 8.59784943e-03]
 [ 1.60218064e-02]
 [ 5.34308236e-04]
 [-5.76062836e-03]
 [-1.23433237e-02]
 [ 1.98981270e-02]
 [-6.08007863e-03]
 [ 2.56771911e-02]
 [-5.83036272e-03]
 [ 1.53471030e-02]
 [ 3.07180834e-02]
 [ 1.16806498e-02]
 [-7.72503563e-03]
 [ 3.94421734e-02]
 [ 6.05775247e-03]
 [-1.02873762e-02]
 [ 5.79280951e-03]
 [-2.63146207e-02]
 [ 4.13533841e-02]
 [ 2.21483049e-02]
 [ 3.42429129e-03]
 [ 2.34938632e-03]
 [-1.92603932e-02]
 [ 3.68222061e-02]
 [ 7.12299250e-02]
 [-1.12148826e-02]
 [-1.11162716e-02]
 [ 2.08526211e-02]
 [ 1.01325513e-02]
 [-4.84123413e-03]
 [ 1.56582145e-02]
 [-1.81792848e-02]
 [-4.09428170e-02]
 [-3.74053058e-03]
 [ 1.62932607e-02]
 [-3.71614700e-02]
 [ 2.85788480e-02]
 [-2.97040371e-02]
 [ 5.71197058e-03]
 [ 8.54978658e-03]
 [-1.76005547e-02]
 [ 2.07782841e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.94052354]
curr_Stock_Price:  99.41593929741602
curr_Factors:  [99.4159393]
mat_Sqrt:  [[0.15]]
grads:  [0.03195878]
Stock Position:  0.0319587791826831
Bond Position:  [-10.1177356]


portfolio before change:  [-6.95096548]
curr_Stock_Price:  99.10899510528839
curr_Factors:  [99.10899511]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800416]
Stock Position:  -0.088004156099716
Bond Position:  [1.77103799]


portfolio before change:  [-6.98438724]
curr_Stock_Price:  99.49002763261038
curr_Factors:  [99.49002763]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523227]
Stock Position:  -0.005232270454003946
Bond Position:  [-6.46382851]


portfolio before change:  [-6.98858273]
curr_Stock_Price:  100.21466347718585
curr_Factors:  [100.21466348]
mat_Sqrt:  [[0.15]]
grads:  [0.04810685]
Stock Position:  0.048106849469267576
Bond Position:  [-11.80959446]


portfolio before change:  [-6.98969989]
curr_Stock_Price:  100.20678441972152
curr_Factors:  [100.20678442]
mat_Sqrt:  [[0.15]]
grads:  [0.02322968]
Stock Position:  0.023229679007198686
Bond Position:  [-9.31747133]


portfolio before change:  [-6.99699736]
curr_Stock_Price:  99.91771001844931
curr_Factors:  [99.91771002]
mat_Sqrt:  [[0.15]]
grads:  [0.15795788]
Stock Position:  0.15795787543523648
Bond Position:  [-22.77978655]


portfolio before change:  [-7.08092333]
curr_Stock_Price:  99.39540500873824
curr_Factors:  [99.39540501]
mat_Sqrt:  [[0.15]]
grads:  [0.00601062]
Stock Position:  0.0060106163581750615
Bond Position:  [-7.67835097]


portfolio before change:  [-7.08215686]
curr_Stock_Price:  99.270022403495
curr_Factors:  [99.2700224]
mat_Sqrt:  [[0.15]]
grads:  [-0.1158401]
Stock Position:  -0.11584010361470087
Bond Position:  [4.41729282]


portfolio before change:  [-7.06588999]
curr_Stock_Price:  99.13198050088369
curr_Factors:  [99.1319805]
mat_Sqrt:  [[0.15]]
grads:  [0.03993152]
Stock Position:  0.03993152428646427
Bond Position:  [-11.02438107]


portfolio before change:  [-7.07750003]
curr_Stock_Price:  98.85848726641169
curr_Factors:  [98.85848727]
mat_Sqrt:  [[0.15]]
grads:  [0.13883571]
Stock Position:  0.13883570507314444
Bond Position:  [-20.80258782]


portfolio before change:  [-7.14106013]
curr_Stock_Price:  98.41004432731172
curr_Factors:  [98.41004433]
mat_Sqrt:  [[0.15]]
grads:  [-0.05650501]
Stock Position:  -0.056505009564061494
Bond Position:  [-1.58039963]


portfolio before change:  [-7.19001422]
curr_Stock_Price:  99.274663483904
curr_Factors:  [99.27466348]
mat_Sqrt:  [[0.15]]
grads:  [0.09792208]
Stock Position:  0.09792208038981998
Bond Position:  [-16.9111958]


portfolio before change:  [-7.07478256]
curr_Stock_Price:  100.46222650641789
curr_Factors:  [100.46222651]
mat_Sqrt:  [[0.15]]
grads:  [0.03448262]
Stock Position:  0.034482624869328724
Bond Position:  [-10.53898383]


portfolio before change:  [-7.07963547]
curr_Stock_Price:  100.34059416523267
curr_Factors:  [100.34059417]
mat_Sqrt:  [[0.15]]
grads:  [0.01468283]
Stock Position:  0.014682831347870495
Bond Position:  [-8.55291949]


portfolio before change:  [-7.08003235]
curr_Stock_Price:  100.34997177803167
curr_Factors:  [100.34997178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0461008]
Stock Position:  -0.046100804816028386
Bond Position:  [-2.45381789]


portfolio before change:  [-7.07531871]
curr_Stock_Price:  100.24439848419446
curr_Factors:  [100.24439848]
mat_Sqrt:  [[0.15]]
grads:  [0.08821792]
Stock Position:  0.08821791988677036
Bond Position:  [-15.91867102]


portfolio before change:  [-7.0520743]
curr_Stock_Price:  100.51916526787682
curr_Factors:  [100.51916527]
mat_Sqrt:  [[0.15]]
grads:  [0.06043749]
Stock Position:  0.06043748792662634
Bond Position:  [-13.12720014]


portfolio before change:  [-7.05082076]
curr_Stock_Price:  100.55348204150894
curr_Factors:  [100.55348204]
mat_Sqrt:  [[0.15]]
grads:  [-0.07874203]
Stock Position:  -0.07874203245214373
Bond Position:  [0.86696479]


portfolio before change:  [-7.07358906]
curr_Stock_Price:  100.84332076456354
curr_Factors:  [100.84332076]
mat_Sqrt:  [[0.15]]
grads:  [-0.00373949]
Stock Position:  -0.0037394853599748957
Bond Position:  [-6.69648694]


portfolio before change:  [-7.07465328]
curr_Stock_Price:  101.01598478646062
curr_Factors:  [101.01598479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00125371]
Stock Position:  -0.001253713136363423
Bond Position:  [-6.94800821]


portfolio before change:  [-7.07516407]
curr_Stock_Price:  101.07702284593701
curr_Factors:  [101.07702285]
mat_Sqrt:  [[0.15]]
grads:  [0.08251575]
Stock Position:  0.0825157517673576
Bond Position:  [-15.4156106]


portfolio before change:  [-7.12619327]
curr_Stock_Price:  100.47028174833132
curr_Factors:  [100.47028175]
mat_Sqrt:  [[0.15]]
grads:  [-0.0476801]
Stock Position:  -0.04768010000171797
Bond Position:  [-2.33576019]


portfolio before change:  [-7.12010023]
curr_Stock_Price:  100.33942984497435
curr_Factors:  [100.33942984]
mat_Sqrt:  [[0.15]]
grads:  [0.04544443]
Stock Position:  0.045444434309212134
Bond Position:  [-11.67996886]


portfolio before change:  [-7.15705794]
curr_Stock_Price:  99.54224335008543
curr_Factors:  [99.54224335]
mat_Sqrt:  [[0.15]]
grads:  [0.2420327]
Stock Position:  0.2420327041171518
Bond Position:  [-31.24953627]


portfolio before change:  [-7.31688414]
curr_Stock_Price:  98.88996355810669
curr_Factors:  [98.88996356]
mat_Sqrt:  [[0.15]]
grads:  [-0.05374382]
Stock Position:  -0.05374382103032515
Bond Position:  [-2.00215964]


portfolio before change:  [-7.30842576]
curr_Stock_Price:  98.73025192771942
curr_Factors:  [98.73025193]
mat_Sqrt:  [[0.15]]
grads:  [-0.04096034]
Stock Position:  -0.04096033827668257
Bond Position:  [-3.26440125]


portfolio before change:  [-7.31884946]
curr_Stock_Price:  98.9797532563674
curr_Factors:  [98.97975326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755121]
Stock Position:  -0.037551211834489735
Bond Position:  [-3.60203977]


portfolio before change:  [-7.2896958]
curr_Stock_Price:  98.19738743666296
curr_Factors:  [98.19738744]
mat_Sqrt:  [[0.15]]
grads:  [0.0517514]
Stock Position:  0.0517513974337626
Bond Position:  [-12.37154783]


portfolio before change:  [-7.24710827]
curr_Stock_Price:  99.03525439013296
curr_Factors:  [99.03525439]
mat_Sqrt:  [[0.15]]
grads:  [-0.08322214]
Stock Position:  -0.08322213667103805
Bond Position:  [0.99481721]


portfolio before change:  [-7.31816634]
curr_Stock_Price:  99.88983774193743
curr_Factors:  [99.88983774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01656498]
Stock Position:  -0.016564977433988295
Bond Position:  [-5.66349343]


portfolio before change:  [-7.32972474]
curr_Stock_Price:  100.56622982630077
curr_Factors:  [100.56622983]
mat_Sqrt:  [[0.15]]
grads:  [0.04045729]
Stock Position:  0.04045728940746832
Bond Position:  [-11.3983618]


portfolio before change:  [-7.30031075]
curr_Stock_Price:  101.31087701247822
curr_Factors:  [101.31087701]
mat_Sqrt:  [[0.15]]
grads:  [-0.07778053]
Stock Position:  -0.07778053199968249
Bond Position:  [0.57970316]


portfolio before change:  [-7.32674319]
curr_Stock_Price:  101.65117648592752
curr_Factors:  [101.65117649]
mat_Sqrt:  [[0.15]]
grads:  [0.05362946]
Stock Position:  0.05362946416091479
Bond Position:  [-12.77824132]


portfolio before change:  [-7.27007729]
curr_Stock_Price:  102.7226876151636
curr_Factors:  [102.72268762]
mat_Sqrt:  [[0.15]]
grads:  [0.05644972]
Stock Position:  0.05644971563818006
Bond Position:  [-13.0687438]


portfolio before change:  [-7.23959956]
curr_Stock_Price:  103.27706689731555
curr_Factors:  [103.2770669]
mat_Sqrt:  [[0.15]]
grads:  [0.06979146]
Stock Position:  0.0697914567693431
Bond Position:  [-14.44745651]


portfolio before change:  [-7.12131793]
curr_Stock_Price:  104.98479201305925
curr_Factors:  [104.98479201]
mat_Sqrt:  [[0.15]]
grads:  [0.0367875]
Stock Position:  0.03678749754281241
Bond Position:  [-10.98344571]


portfolio before change:  [-7.10372052]
curr_Stock_Price:  105.48180583336585
curr_Factors:  [105.48180583]
mat_Sqrt:  [[0.15]]
grads:  [-0.21196218]
Stock Position:  -0.2119621811568423
Bond Position:  [15.25443311]


portfolio before change:  [-7.06459958]
curr_Stock_Price:  105.30173826864404
curr_Factors:  [105.30173827]
mat_Sqrt:  [[0.15]]
grads:  [0.057319]
Stock Position:  0.057318996177209314
Bond Position:  [-13.10038951]


portfolio before change:  [-7.08198117]
curr_Stock_Price:  105.01278003214784
curr_Factors:  [105.01278003]
mat_Sqrt:  [[0.15]]
grads:  [0.10681204]
Stock Position:  0.10681204271908075
Bond Position:  [-18.29861072]


portfolio before change:  [-7.11625886]
curr_Stock_Price:  104.70257169792326
curr_Factors:  [104.7025717]
mat_Sqrt:  [[0.15]]
grads:  [0.00356205]
Stock Position:  0.0035620549045453876
Bond Position:  [-7.48921517]


portfolio before change:  [-7.11413714]
curr_Stock_Price:  105.42962630300663
curr_Factors:  [105.4296263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840419]
Stock Position:  -0.03840418903914162
Bond Position:  [-3.06519784]


portfolio before change:  [-7.13804573]
curr_Stock_Price:  106.04718932557539
curr_Factors:  [106.04718933]
mat_Sqrt:  [[0.15]]
grads:  [-0.08228882]
Stock Position:  -0.08228882478427502
Bond Position:  [1.58845285]


portfolio before change:  [-7.14277164]
curr_Stock_Price:  106.10582666869675
curr_Factors:  [106.10582667]
mat_Sqrt:  [[0.15]]
grads:  [0.13265418]
Stock Position:  0.1326541797999104
Bond Position:  [-21.21815305]


portfolio before change:  [-7.17519375]
curr_Stock_Price:  105.8714131825118
curr_Factors:  [105.87141318]
mat_Sqrt:  [[0.15]]
grads:  [-0.04053386]
Stock Position:  -0.04053385755382312
Bond Position:  [-2.88381697]


portfolio before change:  [-7.22814927]
curr_Stock_Price:  107.17341795849276
curr_Factors:  [107.17341796]
mat_Sqrt:  [[0.15]]
grads:  [0.17118127]
Stock Position:  0.17118127405554187
Bond Position:  [-25.5742315]


portfolio before change:  [-7.2796699]
curr_Stock_Price:  106.8817844883356
curr_Factors:  [106.88178449]
mat_Sqrt:  [[0.15]]
grads:  [-0.03886908]
Stock Position:  -0.03886908480728247
Bond Position:  [-3.12527275]


portfolio before change:  [-7.25645849]
curr_Stock_Price:  106.27959010261368
curr_Factors:  [106.2795901]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-18.13035056]


portfolio before change:  [-7.15966778]
curr_Stock_Price:  107.23668170068522
curr_Factors:  [107.2366817]
mat_Sqrt:  [[0.15]]
grads:  [0.20478722]
Stock Position:  0.2047872224414025
Bond Position:  [-29.12036997]


portfolio before change:  [-7.20135017]
curr_Stock_Price:  107.04202936464979
curr_Factors:  [107.04202936]
mat_Sqrt:  [[0.15]]
grads:  [0.077871]
Stock Position:  0.07787099884898604
Bond Position:  [-15.53681992]


portfolio before change:  [-7.2375334]
curr_Stock_Price:  106.5898437200152
curr_Factors:  [106.58984372]
mat_Sqrt:  [[0.15]]
grads:  [-0.05150024]
Stock Position:  -0.05150023755021087
Bond Position:  [-1.74813113]


portfolio before change:  [-7.24585141]
curr_Stock_Price:  106.74923614592275
curr_Factors:  [106.74923615]
mat_Sqrt:  [[0.15]]
grads:  [0.26294782]
Stock Position:  0.26294782287880014
Bond Position:  [-35.31533065]


portfolio before change:  [-7.38637015]
curr_Stock_Price:  106.22323268747705
curr_Factors:  [106.22323269]
mat_Sqrt:  [[0.15]]
grads:  [0.04038502]
Stock Position:  0.0403850164427137
Bond Position:  [-11.67619715]


portfolio before change:  [-7.39301983]
curr_Stock_Price:  106.07664630451946
curr_Factors:  [106.0766463]
mat_Sqrt:  [[0.15]]
grads:  [-0.06858251]
Stock Position:  -0.06858250802462494
Bond Position:  [-0.11801739]


portfolio before change:  [-7.42956067]
curr_Stock_Price:  106.60933994339214
curr_Factors:  [106.60933994]
mat_Sqrt:  [[0.15]]
grads:  [0.03861873]
Stock Position:  0.0386187300506163
Bond Position:  [-11.54667799]


portfolio before change:  [-7.37136042]
curr_Stock_Price:  108.13507474619631
curr_Factors:  [108.13507475]
mat_Sqrt:  [[0.15]]
grads:  [-0.1754308]
Stock Position:  -0.17543080473726932
Bond Position:  [11.59886276]


portfolio before change:  [-7.41279798]
curr_Stock_Price:  108.37541170745548
curr_Factors:  [108.37541171]
mat_Sqrt:  [[0.15]]
grads:  [0.27568923]
Stock Position:  0.275689227183032
Bond Position:  [-37.29073148]


portfolio before change:  [-7.12149552]
curr_Stock_Price:  109.44049938640396
curr_Factors:  [109.44049939]
mat_Sqrt:  [[0.15]]
grads:  [0.14765537]
Stock Position:  0.14765536620808828
Bond Position:  [-23.28097254]


portfolio before change:  [-7.01573945]
curr_Stock_Price:  110.16659005533283
curr_Factors:  [110.16659006]
mat_Sqrt:  [[0.15]]
grads:  [0.02282861]
Stock Position:  0.022828608574455806
Bond Position:  [-9.53068941]


portfolio before change:  [-6.9935986]
curr_Stock_Price:  111.16255676037053
curr_Factors:  [111.16255676]
mat_Sqrt:  [[0.15]]
grads:  [0.01566258]
Stock Position:  0.01566257549111229
Bond Position:  [-8.73469054]


portfolio before change:  [-6.98505225]
curr_Stock_Price:  111.7430667957422
curr_Factors:  [111.7430668]
mat_Sqrt:  [[0.15]]
grads:  [-0.12840262]
Stock Position:  -0.12840262115470533
Bond Position:  [7.36305042]


portfolio before change:  [-7.03069686]
curr_Stock_Price:  112.10213119796579
curr_Factors:  [112.1021312]
mat_Sqrt:  [[0.15]]
grads:  [0.24548137]
Stock Position:  0.2454813743323121
Bond Position:  [-34.54968209]


portfolio before change:  [-7.13639054]
curr_Stock_Price:  111.6803710490552
curr_Factors:  [111.68037105]
mat_Sqrt:  [[0.15]]
grads:  [0.47486617]
Stock Position:  0.4748661663750575
Bond Position:  [-60.1696202]


portfolio before change:  [-7.78582797]
curr_Stock_Price:  110.32066856199411
curr_Factors:  [110.32066856]
mat_Sqrt:  [[0.15]]
grads:  [-0.07476588]
Stock Position:  -0.07476588413206665
Bond Position:  [0.46239436]


portfolio before change:  [-7.78280398]
curr_Stock_Price:  110.2806090398674
curr_Factors:  [110.28060904]
mat_Sqrt:  [[0.15]]
grads:  [-0.07410848]
Stock Position:  -0.07410847759816508
Bond Position:  [0.38992406]


portfolio before change:  [-7.7107498]
curr_Stock_Price:  109.30865802211845
curr_Factors:  [109.30865802]
mat_Sqrt:  [[0.15]]
grads:  [0.13901747]
Stock Position:  0.13901747373465165
Bond Position:  [-22.9065633]


portfolio before change:  [-7.8261767]
curr_Stock_Price:  108.48865181526094
curr_Factors:  [108.48865182]
mat_Sqrt:  [[0.15]]
grads:  [0.06755034]
Stock Position:  0.06755034180766974
Bond Position:  [-15.15462221]


portfolio before change:  [-7.9049354]
curr_Stock_Price:  107.33674782981463
curr_Factors:  [107.33674783]
mat_Sqrt:  [[0.15]]
grads:  [-0.03227489]
Stock Position:  -0.03227489419775981
Bond Position:  [-4.44065322]


portfolio before change:  [-7.89785512]
curr_Stock_Price:  107.10877401464671
curr_Factors:  [107.10877401]
mat_Sqrt:  [[0.15]]
grads:  [0.1043881]
Stock Position:  0.10438809649687478
Bond Position:  [-19.07873615]


portfolio before change:  [-7.88758025]
curr_Stock_Price:  107.21862678056553
curr_Factors:  [107.21862678]
mat_Sqrt:  [[0.15]]
grads:  [-0.12119523]
Stock Position:  -0.12119523195746648
Bond Position:  [5.10680609]


portfolio before change:  [-7.95088224]
curr_Stock_Price:  107.74357461253594
curr_Factors:  [107.74357461]
mat_Sqrt:  [[0.15]]
grads:  [-0.27295211]
Stock Position:  -0.27295211366357575
Bond Position:  [21.45795418]


portfolio before change:  [-8.02708028]
curr_Stock_Price:  108.02765081932299
curr_Factors:  [108.02765082]
mat_Sqrt:  [[0.15]]
grads:  [-0.02493687]
Stock Position:  -0.024936870507743757
Bond Position:  [-5.33320874]


portfolio before change:  [-8.02503239]
curr_Stock_Price:  107.93216077200131
curr_Factors:  [107.93216077]
mat_Sqrt:  [[0.15]]
grads:  [0.10862174]
Stock Position:  0.1086217378959544
Bond Position:  [-19.74881127]


portfolio before change:  [-7.95521601]
curr_Stock_Price:  108.58627221482315
curr_Factors:  [108.58627221]
mat_Sqrt:  [[0.15]]
grads:  [-0.24774313]
Stock Position:  -0.2477431330782982
Bond Position:  [18.94628728]


portfolio before change:  [-7.7626592]
curr_Stock_Price:  107.81380830782082
curr_Factors:  [107.81380831]
mat_Sqrt:  [[0.15]]
grads:  [0.19052565]
Stock Position:  0.1905256530183361
Bond Position:  [-28.30395543]


portfolio before change:  [-7.79744582]
curr_Stock_Price:  107.64051109465993
curr_Factors:  [107.64051109]
mat_Sqrt:  [[0.15]]
grads:  [-0.19802691]
Stock Position:  -0.19802691426042196
Bond Position:  [13.51827244]


portfolio before change:  [-7.76954261]
curr_Stock_Price:  107.50387165865818
curr_Factors:  [107.50387166]
mat_Sqrt:  [[0.15]]
grads:  [0.0380798]
Stock Position:  0.03807980385180203
Bond Position:  [-11.86326896]


portfolio before change:  [-7.7584467]
curr_Stock_Price:  107.81472915893463
curr_Factors:  [107.81472916]
mat_Sqrt:  [[0.15]]
grads:  [0.05699858]
Stock Position:  0.05699857722815707
Bond Position:  [-13.90373287]


portfolio before change:  [-7.74248597]
curr_Stock_Price:  108.10999518063393
curr_Factors:  [108.10999518]
mat_Sqrt:  [[0.15]]
grads:  [-0.11733703]
Stock Position:  -0.11733703142040897
Bond Position:  [4.94281994]


portfolio before change:  [-7.72048594]
curr_Stock_Price:  107.9251337642054
curr_Factors:  [107.92513376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.72048594]
Stock Price:  107.58646150054047
PL:  [-15.30694744]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.01797533e-03]
 [-2.71207288e-02]
 [-5.73081490e-03]
 [ 5.99593589e-03]
 [-1.90660123e-03]
 [ 1.36880124e-02]
 [ 2.76107304e-03]
 [-2.16585109e-02]
 [-2.01779425e-03]
 [ 2.37797419e-02]
 [ 6.91420864e-04]
 [ 1.89955587e-02]
 [-1.38688146e-02]
 [ 7.50183810e-03]
 [-6.97205391e-03]
 [ 7.94659781e-03]
 [ 7.40464203e-03]
 [-8.79165214e-03]
 [ 8.20584173e-04]
 [ 1.20775246e-02]
 [ 1.17150264e-02]
 [-8.41447214e-03]
 [ 7.44964899e-03]
 [ 7.06628512e-03]
 [-8.07548343e-03]
 [-1.86345753e-03]
 [-4.72200408e-03]
 [ 8.87893817e-03]
 [-2.34298815e-02]
 [ 8.75808628e-04]
 [ 3.09369631e-03]
 [-1.00513362e-02]
 [-8.43547690e-03]
 [ 5.52214397e-03]
 [ 1.32267090e-02]
 [ 1.58208743e-02]
 [-3.43916335e-02]
 [ 8.97915209e-03]
 [-1.72583111e-02]
 [ 2.29998772e-02]
 [-5.40583250e-03]
 [ 1.75923578e-03]
 [ 2.32926079e-02]
 [ 4.08228613e-03]
 [-5.15603754e-03]
 [-6.62262230e-03]
 [ 5.66538002e-04]
 [-1.22847139e-02]
 [-8.09469515e-03]
 [-4.45236723e-03]
 [ 4.72244659e-02]
 [-1.01399641e-02]
 [ 3.45200910e-03]
 [ 5.24942503e-03]
 [ 5.46993375e-03]
 [-3.41231395e-03]
 [ 7.84023457e-03]
 [-5.77062458e-04]
 [ 1.54669214e-03]
 [-6.96406223e-03]
 [ 9.82848720e-04]
 [-4.07309552e-03]
 [ 4.94441485e-03]
 [-1.83341308e-02]
 [-5.83742546e-03]
 [-1.00679986e-02]
 [-4.76161660e-03]
 [ 1.68293454e-02]
 [-1.00733898e-02]
 [ 7.03082731e-03]
 [-5.78224309e-03]
 [ 1.09657837e-02]
 [-6.08958482e-03]
 [ 8.93237434e-03]
 [-1.85566681e-02]
 [-5.87067536e-03]
 [-9.54583630e-04]
 [ 5.93533551e-04]
 [-4.00829545e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.50173923]
curr_Stock_Price:  99.1193464347778
curr_Factors:  [99.11934643]
mat_Sqrt:  [[0.15]]
grads:  [0.0467865]
Stock Position:  0.04678650223068687
Bond Position:  [-16.13918676]


portfolio before change:  [-11.52439712]
curr_Stock_Price:  98.6566241017894
curr_Factors:  [98.6566241]
mat_Sqrt:  [[0.15]]
grads:  [-0.18080486]
Stock Position:  -0.18080485862810833
Bond Position:  [6.31319985]


portfolio before change:  [-11.50819243]
curr_Stock_Price:  98.56918116813077
curr_Factors:  [98.56918117]
mat_Sqrt:  [[0.15]]
grads:  [-0.03820543]
Stock Position:  -0.03820543263493375
Bond Position:  [-7.74231422]


portfolio before change:  [-11.50645918]
curr_Stock_Price:  98.51114868139038
curr_Factors:  [98.51114868]
mat_Sqrt:  [[0.15]]
grads:  [0.03997291]
Stock Position:  0.03997290596229795
Bond Position:  [-15.44423606]


portfolio before change:  [-11.50070039]
curr_Stock_Price:  98.67936472051066
curr_Factors:  [98.67936472]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271067]
Stock Position:  -0.012710674898467524
Bond Position:  [-10.24641907]


portfolio before change:  [-11.49682941]
curr_Stock_Price:  98.32443432882313
curr_Factors:  [98.32443433]
mat_Sqrt:  [[0.15]]
grads:  [0.09125342]
Stock Position:  0.09125341596683052
Bond Position:  [-20.46926992]


portfolio before change:  [-11.4993836]
curr_Stock_Price:  98.3104641923797
curr_Factors:  [98.31046419]
mat_Sqrt:  [[0.15]]
grads:  [0.01840715]
Stock Position:  0.01840715359631349
Bond Position:  [-13.30899942]


portfolio before change:  [-11.49604337]
curr_Stock_Price:  98.53711886343002
curr_Factors:  [98.53711886]
mat_Sqrt:  [[0.15]]
grads:  [-0.14439007]
Stock Position:  -0.14439007286546174
Bond Position:  [2.7317384]


portfolio before change:  [-11.49950569]
curr_Stock_Price:  98.56228025746532
curr_Factors:  [98.56228026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01345196]
Stock Position:  -0.01345196168326325
Bond Position:  [-10.17364967]


portfolio before change:  [-11.49938311]
curr_Stock_Price:  98.50589812447822
curr_Factors:  [98.50589812]
mat_Sqrt:  [[0.15]]
grads:  [0.15853161]
Stock Position:  0.1585316124707296
Bond Position:  [-27.11568198]


portfolio before change:  [-11.48354272]
curr_Stock_Price:  98.61650807797943
curr_Factors:  [98.61650808]
mat_Sqrt:  [[0.15]]
grads:  [0.00460947]
Stock Position:  0.0046094724289366795
Bond Position:  [-11.9381128]


portfolio before change:  [-11.48240049]
curr_Stock_Price:  99.0261830741341
curr_Factors:  [99.02618307]
mat_Sqrt:  [[0.15]]
grads:  [0.12663706]
Stock Position:  0.12663705782419368
Bond Position:  [-24.02278496]


portfolio before change:  [-11.50600996]
curr_Stock_Price:  98.8516054599921
curr_Factors:  [98.85160546]
mat_Sqrt:  [[0.15]]
grads:  [-0.09245876]
Stock Position:  -0.0924587639611809
Bond Position:  [-2.3663127]


portfolio before change:  [-11.49964835]
curr_Stock_Price:  98.78120100162648
curr_Factors:  [98.781201]
mat_Sqrt:  [[0.15]]
grads:  [0.05001225]
Stock Position:  0.05001225399879131
Bond Position:  [-16.43991886]


portfolio before change:  [-11.51227903]
curr_Stock_Price:  98.5491947078233
curr_Factors:  [98.54919471]
mat_Sqrt:  [[0.15]]
grads:  [-0.04648036]
Stock Position:  -0.04648035940719911
Bond Position:  [-6.93167704]


portfolio before change:  [-11.54281272]
curr_Stock_Price:  99.19678956760038
curr_Factors:  [99.19678957]
mat_Sqrt:  [[0.15]]
grads:  [0.05297732]
Stock Position:  0.05297731871291081
Bond Position:  [-16.79799265]


portfolio before change:  [-11.57711549]
curr_Stock_Price:  98.56910845774796
curr_Factors:  [98.56910846]
mat_Sqrt:  [[0.15]]
grads:  [0.04936428]
Stock Position:  0.049364280200828274
Bond Position:  [-16.44290858]


portfolio before change:  [-11.5790194]
curr_Stock_Price:  98.55135873103694
curr_Factors:  [98.55135873]
mat_Sqrt:  [[0.15]]
grads:  [-0.05861101]
Stock Position:  -0.05861101429381686
Bond Position:  [-5.80282431]


portfolio before change:  [-11.58365766]
curr_Stock_Price:  98.62430703047742
curr_Factors:  [98.62430703]
mat_Sqrt:  [[0.15]]
grads:  [0.00547056]
Stock Position:  0.005470561156505882
Bond Position:  [-12.12318797]


portfolio before change:  [-11.58360046]
curr_Stock_Price:  98.77327350282074
curr_Factors:  [98.7732735]
mat_Sqrt:  [[0.15]]
grads:  [0.08051683]
Stock Position:  0.0805168304690253
Bond Position:  [-19.53651137]


portfolio before change:  [-11.56722811]
curr_Stock_Price:  98.99177964923093
curr_Factors:  [98.99177965]
mat_Sqrt:  [[0.15]]
grads:  [0.07810018]
Stock Position:  0.07810017579329212
Bond Position:  [-19.2985035]


portfolio before change:  [-11.57093165]
curr_Stock_Price:  98.95980340530687
curr_Factors:  [98.95980341]
mat_Sqrt:  [[0.15]]
grads:  [-0.05609648]
Stock Position:  -0.05609648092625409
Bond Position:  [-6.01963493]


portfolio before change:  [-11.55367908]
curr_Stock_Price:  98.64554476111645
curr_Factors:  [98.64554476]
mat_Sqrt:  [[0.15]]
grads:  [0.04966433]
Stock Position:  0.0496643266284537
Bond Position:  [-16.45284364]


portfolio before change:  [-11.56230558]
curr_Stock_Price:  98.49255447211385
curr_Factors:  [98.49255447]
mat_Sqrt:  [[0.15]]
grads:  [0.04710857]
Stock Position:  0.04710856743382438
Bond Position:  [-16.20214872]


portfolio before change:  [-11.57528718]
curr_Stock_Price:  98.23848319571815
curr_Factors:  [98.2384832]
mat_Sqrt:  [[0.15]]
grads:  [-0.05383656]
Stock Position:  -0.053836556197812996
Bond Position:  [-6.28646556]


portfolio before change:  [-11.62358736]
curr_Stock_Price:  99.12834821724363
curr_Factors:  [99.12834822]
mat_Sqrt:  [[0.15]]
grads:  [-0.01242305]
Stock Position:  -0.012423050221043175
Bond Position:  [-10.39211092]


portfolio before change:  [-11.61795065]
curr_Stock_Price:  98.6223341850631
curr_Factors:  [98.62233419]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148003]
Stock Position:  -0.03148002721491609
Bond Position:  [-8.51331689]


portfolio before change:  [-11.58729329]
curr_Stock_Price:  97.6315643891976
curr_Factors:  [97.63156439]
mat_Sqrt:  [[0.15]]
grads:  [0.05919292]
Stock Position:  0.05919292112471379
Bond Position:  [-17.36639078]


portfolio before change:  [-11.58342076]
curr_Stock_Price:  97.71532384933936
curr_Factors:  [97.71532385]
mat_Sqrt:  [[0.15]]
grads:  [-0.15619921]
Stock Position:  -0.1561992103011711
Bond Position:  [3.67963566]


portfolio before change:  [-11.61876637]
curr_Stock_Price:  97.94308169235387
curr_Factors:  [97.94308169]
mat_Sqrt:  [[0.15]]
grads:  [0.00583872]
Stock Position:  0.0058387241887472635
Bond Position:  [-12.19062901]


portfolio before change:  [-11.62337258]
curr_Stock_Price:  97.28467230865209
curr_Factors:  [97.28467231]
mat_Sqrt:  [[0.15]]
grads:  [0.02062464]
Stock Position:  0.02062464209899955
Bond Position:  [-13.62983413]


portfolio before change:  [-11.62956602]
curr_Stock_Price:  97.02568357799079
curr_Factors:  [97.02568358]
mat_Sqrt:  [[0.15]]
grads:  [-0.06700891]
Stock Position:  -0.06700890767761405
Bond Position:  [-5.12798095]


portfolio before change:  [-11.63893548]
curr_Stock_Price:  97.16072466589152
curr_Factors:  [97.16072467]
mat_Sqrt:  [[0.15]]
grads:  [-0.05623651]
Stock Position:  -0.05623651269663838
Bond Position:  [-6.17495516]


portfolio before change:  [-11.64355777]
curr_Stock_Price:  97.2360554101003
curr_Factors:  [97.23605541]
mat_Sqrt:  [[0.15]]
grads:  [0.03681429]
Stock Position:  0.03681429312677699
Bond Position:  [-15.22323441]


portfolio before change:  [-11.62387337]
curr_Stock_Price:  97.79659534361437
curr_Factors:  [97.79659534]
mat_Sqrt:  [[0.15]]
grads:  [0.08817806]
Stock Position:  0.08817805982318154
Bond Position:  [-20.2473874]


portfolio before change:  [-11.63219016]
curr_Stock_Price:  97.71662881415111
curr_Factors:  [97.71662881]
mat_Sqrt:  [[0.15]]
grads:  [0.1054725]
Stock Position:  0.10547249547889329
Bond Position:  [-21.93860685]


portfolio before change:  [-11.63120449]
curr_Stock_Price:  97.73897469514947
curr_Factors:  [97.7389747]
mat_Sqrt:  [[0.15]]
grads:  [-0.22927756]
Stock Position:  -0.22927755671253686
Bond Position:  [10.77814882]


portfolio before change:  [-11.77187181]
curr_Stock_Price:  98.3554370113419
curr_Factors:  [98.35543701]
mat_Sqrt:  [[0.15]]
grads:  [0.05986101]
Stock Position:  0.05986101391961314
Bond Position:  [-17.659528]


portfolio before change:  [-11.75759075]
curr_Stock_Price:  98.61244594424159
curr_Factors:  [98.61244594]
mat_Sqrt:  [[0.15]]
grads:  [-0.11505541]
Stock Position:  -0.11505540764531079
Bond Position:  [-0.41169558]


portfolio before change:  [-11.74151123]
curr_Stock_Price:  98.4724677240727
curr_Factors:  [98.47246772]
mat_Sqrt:  [[0.15]]
grads:  [0.15333251]
Stock Position:  0.15333251440940274
Bond Position:  [-26.84054231]


portfolio before change:  [-11.61516414]
curr_Stock_Price:  99.3074157538208
curr_Factors:  [99.30741575]
mat_Sqrt:  [[0.15]]
grads:  [-0.03603888]
Stock Position:  -0.03603888333533032
Bond Position:  [-8.03623577]


portfolio before change:  [-11.60394005]
curr_Stock_Price:  98.98203468348557
curr_Factors:  [98.98203468]
mat_Sqrt:  [[0.15]]
grads:  [0.01172824]
Stock Position:  0.01172823854319038
Bond Position:  [-12.76482496]


portfolio before change:  [-11.60009925]
curr_Stock_Price:  99.37754410376823
curr_Factors:  [99.3775441]
mat_Sqrt:  [[0.15]]
grads:  [0.15528405]
Stock Position:  0.15528405290934336
Bond Position:  [-27.03184706]


portfolio before change:  [-11.57500794]
curr_Stock_Price:  99.55000774191745
curr_Factors:  [99.55000774]
mat_Sqrt:  [[0.15]]
grads:  [0.02721524]
Stock Position:  0.027215240890665026
Bond Position:  [-14.28428538]


portfolio before change:  [-11.60535916]
curr_Stock_Price:  98.4675838952591
curr_Factors:  [98.4675839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03437358]
Stock Position:  -0.03437358360015954
Bond Position:  [-8.22067543]


portfolio before change:  [-11.62258754]
curr_Stock_Price:  98.9538461250848
curr_Factors:  [98.95384613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04415082]
Stock Position:  -0.04415081530304421
Bond Position:  [-7.25369456]


portfolio before change:  [-11.60724692]
curr_Stock_Price:  98.59611783543134
curr_Factors:  [98.59611784]
mat_Sqrt:  [[0.15]]
grads:  [0.00377692]
Stock Position:  0.0037769200160628
Bond Position:  [-11.97963657]


portfolio before change:  [-11.60920878]
curr_Stock_Price:  98.27492649330563
curr_Factors:  [98.27492649]
mat_Sqrt:  [[0.15]]
grads:  [-0.08189809]
Stock Position:  -0.08189809237980572
Bond Position:  [-3.56067977]


portfolio before change:  [-11.60681087]
curr_Stock_Price:  98.24292994106727
curr_Factors:  [98.24292994]
mat_Sqrt:  [[0.15]]
grads:  [-0.05396463]
Stock Position:  -0.05396463432109713
Bond Position:  [-6.30516708]


portfolio before change:  [-11.62555277]
curr_Stock_Price:  98.58292696609972
curr_Factors:  [98.58292697]
mat_Sqrt:  [[0.15]]
grads:  [-0.02968245]
Stock Position:  -0.029682448190251783
Bond Position:  [-8.69937015]


portfolio before change:  [-11.62911334]
curr_Stock_Price:  98.6845639948582
curr_Factors:  [98.68456399]
mat_Sqrt:  [[0.15]]
grads:  [0.31482977]
Stock Position:  0.31482977281646574
Bond Position:  [-42.6979522]


portfolio before change:  [-11.61992492]
curr_Stock_Price:  98.72222601265807
curr_Factors:  [98.72222601]
mat_Sqrt:  [[0.15]]
grads:  [-0.06759976]
Stock Position:  -0.0675997604909237
Bond Position:  [-4.94632608]


portfolio before change:  [-11.60483989]
curr_Stock_Price:  98.49450063156948
curr_Factors:  [98.49450063]
mat_Sqrt:  [[0.15]]
grads:  [0.02301339]
Stock Position:  0.023013394006957726
Bond Position:  [-13.87153264]


portfolio before change:  [-11.6107642]
curr_Stock_Price:  98.27474537674372
curr_Factors:  [98.27474538]
mat_Sqrt:  [[0.15]]
grads:  [0.03499617]
Stock Position:  0.03499616688822244
Bond Position:  [-15.05000359]


portfolio before change:  [-11.60709514]
curr_Stock_Price:  98.40646613363778
curr_Factors:  [98.40646613]
mat_Sqrt:  [[0.15]]
grads:  [0.03646623]
Stock Position:  0.03646622503264383
Bond Position:  [-15.19560748]


portfolio before change:  [-11.5857933]
curr_Stock_Price:  99.01666351895993
curr_Factors:  [99.01666352]
mat_Sqrt:  [[0.15]]
grads:  [-0.02274876]
Stock Position:  -0.022748759666213227
Bond Position:  [-9.33328702]


portfolio before change:  [-11.572752]
curr_Stock_Price:  98.41774534042987
curr_Factors:  [98.41774534]
mat_Sqrt:  [[0.15]]
grads:  [0.05226823]
Stock Position:  0.052268230469409684
Bond Position:  [-16.7168734]


portfolio before change:  [-11.58918991]
curr_Stock_Price:  98.12324385112726
curr_Factors:  [98.12324385]
mat_Sqrt:  [[0.15]]
grads:  [-0.00384708]
Stock Position:  -0.0038470830500851117
Bond Position:  [-11.21170164]


portfolio before change:  [-11.59346896]
curr_Stock_Price:  99.0533770878493
curr_Factors:  [99.05337709]
mat_Sqrt:  [[0.15]]
grads:  [0.01031128]
Stock Position:  0.010311280929015591
Bond Position:  [-12.61483616]


portfolio before change:  [-11.58577209]
curr_Stock_Price:  99.87629397846946
curr_Factors:  [99.87629398]
mat_Sqrt:  [[0.15]]
grads:  [-0.04642708]
Stock Position:  -0.046427081532927975
Bond Position:  [-6.94880724]


portfolio before change:  [-11.56681297]
curr_Stock_Price:  99.45857590937611
curr_Factors:  [99.45857591]
mat_Sqrt:  [[0.15]]
grads:  [0.00655232]
Stock Position:  0.006552324799280913
Bond Position:  [-12.21849786]


portfolio before change:  [-11.57079033]
curr_Stock_Price:  98.9681112937897
curr_Factors:  [98.96811129]
mat_Sqrt:  [[0.15]]
grads:  [-0.02715397]
Stock Position:  -0.027153970111415637
Bond Position:  [-8.8834132]


portfolio before change:  [-11.55757487]
curr_Stock_Price:  98.46097741529664
curr_Factors:  [98.46097742]
mat_Sqrt:  [[0.15]]
grads:  [0.03296277]
Stock Position:  0.03296276566100823
Bond Position:  [-14.80312099]


portfolio before change:  [-11.58734896]
curr_Stock_Price:  97.58578185471364
curr_Factors:  [97.58578185]
mat_Sqrt:  [[0.15]]
grads:  [-0.12222754]
Stock Position:  -0.12222753899006264
Bond Position:  [0.340321]


portfolio before change:  [-11.44604043]
curr_Stock_Price:  96.42984546965997
curr_Factors:  [96.42984547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03891617]
Stock Position:  -0.038916169724342684
Bond Position:  [-7.69336019]


portfolio before change:  [-11.47231663]
curr_Stock_Price:  97.09268967313574
curr_Factors:  [97.09268967]
mat_Sqrt:  [[0.15]]
grads:  [-0.06711999]
Stock Position:  -0.06711999049207097
Bond Position:  [-4.95545623]


portfolio before change:  [-11.51277946]
curr_Stock_Price:  97.69091825731704
curr_Factors:  [97.69091826]
mat_Sqrt:  [[0.15]]
grads:  [-0.03174411]
Stock Position:  -0.031744110699941624
Bond Position:  [-8.41166813]


portfolio before change:  [-11.50277855]
curr_Stock_Price:  97.35930876932576
curr_Factors:  [97.35930877]
mat_Sqrt:  [[0.15]]
grads:  [0.11219564]
Stock Position:  0.11219563586819267
Bond Position:  [-22.42606811]


portfolio before change:  [-11.43869249]
curr_Stock_Price:  97.94300117476443
curr_Factors:  [97.94300117]
mat_Sqrt:  [[0.15]]
grads:  [-0.06715593]
Stock Position:  -0.0671559318797819
Bond Position:  [-4.86123897]


portfolio before change:  [-11.44155764]
curr_Stock_Price:  97.98114109098265
curr_Factors:  [97.98114109]
mat_Sqrt:  [[0.15]]
grads:  [0.04687218]
Stock Position:  0.046872182043893436
Bond Position:  [-16.03414753]


portfolio before change:  [-11.43679815]
curr_Stock_Price:  98.10406379909348
curr_Factors:  [98.1040638]
mat_Sqrt:  [[0.15]]
grads:  [-0.03854829]
Stock Position:  -0.0385482872787309
Bond Position:  [-7.65505452]


portfolio before change:  [-11.45530596]
curr_Stock_Price:  98.57177212171294
curr_Factors:  [98.57177212]
mat_Sqrt:  [[0.15]]
grads:  [0.07310522]
Stock Position:  0.07310522447014231
Bond Position:  [-18.66141749]


portfolio before change:  [-11.39431359]
curr_Stock_Price:  99.42203629960639
curr_Factors:  [99.4220363]
mat_Sqrt:  [[0.15]]
grads:  [-0.04059723]
Stock Position:  -0.0405972321157004
Bond Position:  [-7.3580541]


portfolio before change:  [-11.37649892]
curr_Stock_Price:  98.97189323904182
curr_Factors:  [98.97189324]
mat_Sqrt:  [[0.15]]
grads:  [0.05954916]
Stock Position:  0.05954916229542976
Bond Position:  [-17.27019225]


portfolio before change:  [-11.38144137]
curr_Stock_Price:  98.90702196154925
curr_Factors:  [98.90702196]
mat_Sqrt:  [[0.15]]
grads:  [-0.12371112]
Stock Position:  -0.12371112036968462
Bond Position:  [0.85445713]


portfolio before change:  [-11.3632124]
curr_Stock_Price:  98.76010253810942
curr_Factors:  [98.76010254]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913784]
Stock Position:  -0.039137835703232045
Bond Position:  [-7.49795573]


portfolio before change:  [-11.35941492]
curr_Stock_Price:  98.65110040168965
curr_Factors:  [98.6511004]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636389]
Stock Position:  -0.006363890863954411
Bond Position:  [-10.73161009]


portfolio before change:  [-11.36030275]
curr_Stock_Price:  98.68521071255802
curr_Factors:  [98.68521071]
mat_Sqrt:  [[0.15]]
grads:  [0.00395689]
Stock Position:  0.0039568903375570555
Bond Position:  [-11.7507893]


portfolio before change:  [-11.3592559]
curr_Stock_Price:  99.13538679988898
curr_Factors:  [99.1353868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.3592559]
Stock Price:  99.91893360102155
PL:  [-11.3592559]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.74852605e-03]
 [ 2.55346192e-03]
 [-7.35121134e-04]
 [ 7.13816779e-03]
 [ 4.26089253e-03]
 [ 2.71345731e-02]
 [ 1.18809367e-03]
 [ 2.35361903e-03]
 [ 2.44252645e-02]
 [-4.88967866e-03]
 [ 4.55733172e-02]
 [ 1.56699258e-02]
 [ 9.93820763e-02]
 [ 1.14540237e-02]
 [-6.89758154e-03]
 [ 3.04045200e-02]
 [ 1.58139756e-02]
 [ 8.95775077e-04]
 [ 9.49178562e-03]
 [-8.91585228e-03]
 [ 1.44268854e-02]
 [-1.06728686e-02]
 [ 1.08774873e-02]
 [-6.00841905e-02]
 [ 1.07408517e-02]
 [ 5.75059516e-03]
 [-3.13848681e-03]
 [ 2.68403641e-02]
 [ 7.46078858e-02]
 [ 1.23628303e-02]
 [ 2.44869929e-02]
 [ 1.68147399e-02]
 [-6.80898257e-03]
 [ 6.48731760e-03]
 [ 9.37134912e-03]
 [ 2.80166862e-03]
 [-3.14103311e-02]
 [ 8.57772242e-03]
 [ 1.73293612e-02]
 [-1.35793323e-04]
 [-4.50352460e-03]
 [-1.53737881e-02]
 [ 2.05430459e-02]
 [-4.73782562e-03]
 [ 1.59626798e-02]
 [-1.10533208e-02]
 [ 1.53598698e-02]
 [ 3.19623930e-02]
 [ 1.44115675e-02]
 [-7.96670897e-03]
 [ 7.90990845e-02]
 [ 1.47245951e-02]
 [-1.13403363e-02]
 [ 5.70805163e-03]
 [-2.70988806e-02]
 [ 3.85230351e-02]
 [ 1.80112895e-02]
 [ 2.05433130e-03]
 [ 1.95754839e-03]
 [ 1.21006167e-03]
 [ 1.77648632e-02]
 [ 5.03137026e-02]
 [-6.44071990e-03]
 [-1.16358969e-02]
 [ 1.87899006e-02]
 [ 8.51085494e-03]
 [-5.11254090e-03]
 [ 1.55719789e-02]
 [-1.28843231e-02]
 [-2.15321029e-02]
 [-1.09825914e-02]
 [ 1.46383880e-02]
 [-1.35014917e-02]
 [ 2.62007683e-02]
 [-2.69674324e-02]
 [ 2.93740095e-03]
 [ 3.02719537e-03]
 [-1.46315707e-02]
 [ 2.39094274e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.79123163]
curr_Stock_Price:  99.98372131899674
curr_Factors:  [99.98372132]
mat_Sqrt:  [[0.15]]
grads:  [0.01165684]
Stock Position:  0.011656840366035865
Bond Position:  [0.62573736]


portfolio before change:  [1.7916917]
curr_Stock_Price:  100.01983351461642
curr_Factors:  [100.01983351]
mat_Sqrt:  [[0.15]]
grads:  [0.01702308]
Stock Position:  0.01702307948498321
Bond Position:  [0.08904612]


portfolio before change:  [1.79627631]
curr_Stock_Price:  100.28882395820705
curr_Factors:  [100.28882396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00490081]
Stock Position:  -0.004900807561955869
Bond Position:  [2.28777254]


portfolio before change:  [1.7965253]
curr_Stock_Price:  100.26719564415826
curr_Factors:  [100.26719564]
mat_Sqrt:  [[0.15]]
grads:  [0.04758779]
Stock Position:  0.0475877852843697
Bond Position:  [-2.97496848]


portfolio before change:  [1.78873029]
curr_Stock_Price:  100.10730023432653
curr_Factors:  [100.10730023]
mat_Sqrt:  [[0.15]]
grads:  [0.02840595]
Stock Position:  0.0284059502238577
Bond Position:  [-1.0549127]


portfolio before change:  [1.79867784]
curr_Stock_Price:  100.45981394435123
curr_Factors:  [100.45981394]
mat_Sqrt:  [[0.15]]
grads:  [0.18089715]
Stock Position:  0.18089715389343458
Bond Position:  [-16.37421658]


portfolio before change:  [1.89271425]
curr_Stock_Price:  100.9853049767501
curr_Factors:  [100.98530498]
mat_Sqrt:  [[0.15]]
grads:  [0.00792062]
Stock Position:  0.007920624483644324
Bond Position:  [1.09284757]


portfolio before change:  [1.89655786]
curr_Stock_Price:  101.46194678795491
curr_Factors:  [101.46194679]
mat_Sqrt:  [[0.15]]
grads:  [0.01569079]
Stock Position:  0.015690793546844103
Bond Position:  [0.3045394]


portfolio before change:  [1.89848176]
curr_Stock_Price:  101.58334750782792
curr_Factors:  [101.58334751]
mat_Sqrt:  [[0.15]]
grads:  [0.1628351]
Stock Position:  0.16283509659840492
Bond Position:  [-14.64285244]


portfolio before change:  [2.00012021]
curr_Stock_Price:  102.21314816750312
curr_Factors:  [102.21314817]
mat_Sqrt:  [[0.15]]
grads:  [-0.03259786]
Stock Position:  -0.032597857739447594
Bond Position:  [5.33204987]


portfolio before change:  [1.97957143]
curr_Stock_Price:  102.85374373059103
curr_Factors:  [102.85374373]
mat_Sqrt:  [[0.15]]
grads:  [0.30382211]
Stock Position:  0.3038221147590649
Bond Position:  [-29.2696705]


portfolio before change:  [1.93967659]
curr_Stock_Price:  102.72845520779406
curr_Factors:  [102.72845521]
mat_Sqrt:  [[0.15]]
grads:  [0.10446617]
Stock Position:  0.10446617185169434
Bond Position:  [-8.79197186]


portfolio before change:  [1.95747915]
curr_Stock_Price:  102.90413000584623
curr_Factors:  [102.90413001]
mat_Sqrt:  [[0.15]]
grads:  [0.66254718]
Stock Position:  0.6625471754272725
Bond Position:  [-66.22136152]


portfolio before change:  [1.70498858]
curr_Stock_Price:  102.52928634962659
curr_Factors:  [102.52928635]
mat_Sqrt:  [[0.15]]
grads:  [0.07636016]
Stock Position:  0.07636015821383642
Bond Position:  [-6.12416395]


portfolio before change:  [1.72135261]
curr_Stock_Price:  102.74859973054541
curr_Factors:  [102.74859973]
mat_Sqrt:  [[0.15]]
grads:  [-0.04598388]
Stock Position:  -0.04598387696543654
Bond Position:  [6.44613158]


portfolio before change:  [1.69644013]
curr_Stock_Price:  103.29912705720209
curr_Factors:  [103.29912706]
mat_Sqrt:  [[0.15]]
grads:  [0.2026968]
Stock Position:  0.2026967999886374
Bond Position:  [-19.24196237]


portfolio before change:  [1.9368023]
curr_Stock_Price:  104.490881598433
curr_Factors:  [104.4908816]
mat_Sqrt:  [[0.15]]
grads:  [0.1054265]
Stock Position:  0.10542650398122048
Bond Position:  [-9.07930604]


portfolio before change:  [1.8811294]
curr_Stock_Price:  103.96819113245678
curr_Factors:  [103.96819113]
mat_Sqrt:  [[0.15]]
grads:  [0.00597183]
Stock Position:  0.005971833849437759
Bond Position:  [1.26024863]


portfolio before change:  [1.87780562]
curr_Stock_Price:  103.39842624029423
curr_Factors:  [103.39842624]
mat_Sqrt:  [[0.15]]
grads:  [0.06327857]
Stock Position:  0.06327857082893004
Bond Position:  [-4.66509901]


portfolio before change:  [1.92210012]
curr_Stock_Price:  104.10302615090528
curr_Factors:  [104.10302615]
mat_Sqrt:  [[0.15]]
grads:  [-0.05943902]
Stock Position:  -0.059439015199030054
Bond Position:  [8.10988148]


portfolio before change:  [1.97937333]
curr_Stock_Price:  103.14799146940044
curr_Factors:  [103.14799147]
mat_Sqrt:  [[0.15]]
grads:  [0.09617924]
Stock Position:  0.09617923579400166
Bond Position:  [-7.94132167]


portfolio before change:  [1.99687345]
curr_Stock_Price:  103.33510538597481
curr_Factors:  [103.33510539]
mat_Sqrt:  [[0.15]]
grads:  [-0.07115246]
Stock Position:  -0.07115245739769442
Bond Position:  [9.34942014]


portfolio before change:  [1.95213079]
curr_Stock_Price:  103.97214624750501
curr_Factors:  [103.97214625]
mat_Sqrt:  [[0.15]]
grads:  [0.07251658]
Stock Position:  0.0725165819695105
Bond Position:  [-5.58757388]


portfolio before change:  [1.97827504]
curr_Stock_Price:  104.337490159204
curr_Factors:  [104.33749016]
mat_Sqrt:  [[0.15]]
grads:  [-0.40056127]
Stock Position:  -0.4005612700678754
Bond Position:  [43.77183262]


portfolio before change:  [1.83733386]
curr_Stock_Price:  104.69617938155977
curr_Factors:  [104.69617938]
mat_Sqrt:  [[0.15]]
grads:  [0.07160568]
Stock Position:  0.07160567811005492
Bond Position:  [-5.65950706]


portfolio before change:  [1.8812902]
curr_Stock_Price:  105.3149860469632
curr_Factors:  [105.31498605]
mat_Sqrt:  [[0.15]]
grads:  [0.0383373]
Stock Position:  0.03833730106039878
Bond Position:  [-2.15620213]


portfolio before change:  [1.91812339]
curr_Stock_Price:  106.27926768451015
curr_Factors:  [106.27926768]
mat_Sqrt:  [[0.15]]
grads:  [-0.02092325]
Stock Position:  -0.020923245387248924
Bond Position:  [4.14183058]


portfolio before change:  [1.90994663]
curr_Stock_Price:  106.68243779872935
curr_Factors:  [106.6824378]
mat_Sqrt:  [[0.15]]
grads:  [0.17893576]
Stock Position:  0.17893576086771526
Bond Position:  [-17.17935655]


portfolio before change:  [1.8479528]
curr_Stock_Price:  106.34197990271932
curr_Factors:  [106.3419799]
mat_Sqrt:  [[0.15]]
grads:  [0.49738591]
Stock Position:  0.49738590527901555
Bond Position:  [-51.04504915]


portfolio before change:  [1.94694254]
curr_Stock_Price:  106.54741427406242
curr_Factors:  [106.54741427]
mat_Sqrt:  [[0.15]]
grads:  [0.08241887]
Stock Position:  0.08241886851350275
Bond Position:  [-6.83457479]


portfolio before change:  [1.96740871]
curr_Stock_Price:  106.8009161430438
curr_Factors:  [106.80091614]
mat_Sqrt:  [[0.15]]
grads:  [0.16324662]
Stock Position:  0.16324661911939428
Bond Position:  [-15.46747977]


portfolio before change:  [2.00701213]
curr_Stock_Price:  107.04943691879102
curr_Factors:  [107.04943692]
mat_Sqrt:  [[0.15]]
grads:  [0.11209827]
Stock Position:  0.11209826604122337
Bond Position:  [-9.99304413]


portfolio before change:  [1.98629259]
curr_Stock_Price:  106.87017488999798
curr_Factors:  [106.87017489]
mat_Sqrt:  [[0.15]]
grads:  [-0.04539322]
Stock Position:  -0.04539321711158971
Bond Position:  [6.83747364]


portfolio before change:  [1.98774472]
curr_Stock_Price:  106.84759938769626
curr_Factors:  [106.84759939]
mat_Sqrt:  [[0.15]]
grads:  [0.04324878]
Stock Position:  0.04324878401893501
Bond Position:  [-2.63328403]


portfolio before change:  [1.98293632]
curr_Stock_Price:  106.74022499040554
curr_Factors:  [106.74022499]
mat_Sqrt:  [[0.15]]
grads:  [0.06247566]
Stock Position:  0.062475660782302496
Bond Position:  [-4.68572977]


portfolio before change:  [1.96648268]
curr_Stock_Price:  106.48155191797548
curr_Factors:  [106.48155192]
mat_Sqrt:  [[0.15]]
grads:  [0.01867779]
Stock Position:  0.018677790802019274
Bond Position:  [-0.02235747]


portfolio before change:  [1.95726955]
curr_Stock_Price:  105.9883601704118
curr_Factors:  [105.98836017]
mat_Sqrt:  [[0.15]]
grads:  [-0.20940221]
Stock Position:  -0.20940220748938385
Bond Position:  [24.15146614]


portfolio before change:  [2.0798463]
curr_Stock_Price:  105.4102037377011
curr_Factors:  [105.41020374]
mat_Sqrt:  [[0.15]]
grads:  [0.05718482]
Stock Position:  0.05718481614976896
Bond Position:  [-3.94801682]


portfolio before change:  [2.07699044]
curr_Stock_Price:  105.36457805493056
curr_Factors:  [105.36457805]
mat_Sqrt:  [[0.15]]
grads:  [0.11552907]
Stock Position:  0.11552907447244405
Bond Position:  [-10.09568174]


portfolio before change:  [2.00870628]
curr_Stock_Price:  104.77898375264176
curr_Factors:  [104.77898375]
mat_Sqrt:  [[0.15]]
grads:  [-0.00090529]
Stock Position:  -0.000905288820285168
Bond Position:  [2.10356152]


portfolio before change:  [2.00902381]
curr_Stock_Price:  104.57345759882901
curr_Factors:  [104.5734576]
mat_Sqrt:  [[0.15]]
grads:  [-0.0300235]
Stock Position:  -0.030023497326924095
Bond Position:  [5.14868474]


portfolio before change:  [2.00535091]
curr_Stock_Price:  104.70651040284463
curr_Factors:  [104.7065104]
mat_Sqrt:  [[0.15]]
grads:  [-0.10249192]
Stock Position:  -0.10249192089648365
Bond Position:  [12.73692229]


portfolio before change:  [2.07211733]
curr_Stock_Price:  104.06284658484361
curr_Factors:  [104.06284658]
mat_Sqrt:  [[0.15]]
grads:  [0.13695364]
Stock Position:  0.13695363931733698
Bond Position:  [-12.17966823]


portfolio before change:  [2.21617954]
curr_Stock_Price:  105.12031003757664
curr_Factors:  [105.12031004]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315855]
Stock Position:  -0.03158550413358661
Bond Position:  [5.53645753]


portfolio before change:  [2.20599362]
curr_Stock_Price:  105.45375295443982
curr_Factors:  [105.45375295]
mat_Sqrt:  [[0.15]]
grads:  [0.10641787]
Stock Position:  0.10641786501169787
Bond Position:  [-9.01616963]


portfolio before change:  [2.24343293]
curr_Stock_Price:  105.81086248131031
curr_Factors:  [105.81086248]
mat_Sqrt:  [[0.15]]
grads:  [-0.07368881]
Stock Position:  -0.07368880542285654
Bond Position:  [10.04050898]


portfolio before change:  [2.17737373]
curr_Stock_Price:  106.71584050982717
curr_Factors:  [106.71584051]
mat_Sqrt:  [[0.15]]
grads:  [0.10239913]
Stock Position:  0.1023991320635374
Bond Position:  [-8.75023572]


portfolio before change:  [2.25048339]
curr_Stock_Price:  107.43514906935066
curr_Factors:  [107.43514907]
mat_Sqrt:  [[0.15]]
grads:  [0.21308262]
Stock Position:  0.21308262002850215
Bond Position:  [-20.64207965]


portfolio before change:  [2.43873989]
curr_Stock_Price:  108.32469446229887
curr_Factors:  [108.32469446]
mat_Sqrt:  [[0.15]]
grads:  [0.09607712]
Stock Position:  0.09607711635642449
Bond Position:  [-7.96878439]


portfolio before change:  [2.46184783]
curr_Stock_Price:  108.5703929768902
curr_Factors:  [108.57039298]
mat_Sqrt:  [[0.15]]
grads:  [-0.05311139]
Stock Position:  -0.0531113931277493
Bond Position:  [8.22817265]


portfolio before change:  [2.45872967]
curr_Stock_Price:  108.6387856853723
curr_Factors:  [108.63878569]
mat_Sqrt:  [[0.15]]
grads:  [0.52732723]
Stock Position:  0.5273272303095337
Bond Position:  [-54.82946029]


portfolio before change:  [2.15867585]
curr_Stock_Price:  108.07627562112965
curr_Factors:  [108.07627562]
mat_Sqrt:  [[0.15]]
grads:  [0.09816397]
Stock Position:  0.09816396733612043
Bond Position:  [-8.45052014]


portfolio before change:  [2.13803892]
curr_Stock_Price:  107.87142694482543
curr_Factors:  [107.87142694]
mat_Sqrt:  [[0.15]]
grads:  [-0.07560224]
Stock Position:  -0.07560224178264698
Bond Position:  [10.29336062]


portfolio before change:  [2.13908526]
curr_Stock_Price:  107.86609657277297
curr_Factors:  [107.86609657]
mat_Sqrt:  [[0.15]]
grads:  [0.03805368]
Stock Position:  0.038053677504543304
Bond Position:  [-1.96561639]


portfolio before change:  [2.15671919]
curr_Stock_Price:  108.332721277398
curr_Factors:  [108.33272128]
mat_Sqrt:  [[0.15]]
grads:  [-0.1806592]
Stock Position:  -0.1806592036983644
Bond Position:  [21.72802235]


portfolio before change:  [2.2273861]
curr_Stock_Price:  107.94907700292237
curr_Factors:  [107.949077]
mat_Sqrt:  [[0.15]]
grads:  [0.25682023]
Stock Position:  0.25682023381773167
Bond Position:  [-25.49612109]


portfolio before change:  [2.14228515]
curr_Stock_Price:  107.62391806737038
curr_Factors:  [107.62391807]
mat_Sqrt:  [[0.15]]
grads:  [0.12007526]
Stock Position:  0.12007526366190541
Bond Position:  [-10.78068519]


portfolio before change:  [2.07831209]
curr_Stock_Price:  107.09675497661235
curr_Factors:  [107.09675498]
mat_Sqrt:  [[0.15]]
grads:  [0.01369554]
Stock Position:  0.013695542002431447
Bond Position:  [0.61156398]


portfolio before change:  [2.06887778]
curr_Stock_Price:  106.40510399603305
curr_Factors:  [106.405104]
mat_Sqrt:  [[0.15]]
grads:  [0.01305032]
Stock Position:  0.013050322611399337
Bond Position:  [0.68025684]


portfolio before change:  [2.07531092]
curr_Stock_Price:  106.89479470290809
curr_Factors:  [106.8947947]
mat_Sqrt:  [[0.15]]
grads:  [0.00806708]
Stock Position:  0.008067077831712238
Bond Position:  [1.21298229]


portfolio before change:  [2.07297788]
curr_Stock_Price:  106.59619185206087
curr_Factors:  [106.59619185]
mat_Sqrt:  [[0.15]]
grads:  [0.11843242]
Stock Position:  0.11843242158420876
Bond Position:  [-10.55146725]


portfolio before change:  [2.21261716]
curr_Stock_Price:  107.78082327590357
curr_Factors:  [107.78082328]
mat_Sqrt:  [[0.15]]
grads:  [0.33542468]
Stock Position:  0.3354246839770662
Bond Position:  [-33.93973143]


portfolio before change:  [2.32132881]
curr_Stock_Price:  108.11124901725755
curr_Factors:  [108.11124902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293813]
Stock Position:  -0.04293813269338071
Bond Position:  [6.96342397]


portfolio before change:  [2.31214678]
curr_Stock_Price:  108.3352283922764
curr_Factors:  [108.33522839]
mat_Sqrt:  [[0.15]]
grads:  [-0.07757265]
Stock Position:  -0.07757264621178639
Bond Position:  [10.71599713]


portfolio before change:  [2.34854297]
curr_Stock_Price:  107.87467412291899
curr_Factors:  [107.87467412]
mat_Sqrt:  [[0.15]]
grads:  [0.125266]
Stock Position:  0.12526600426286155
Bond Position:  [-11.16448642]


portfolio before change:  [2.23203975]
curr_Stock_Price:  106.95019814825126
curr_Factors:  [106.95019815]
mat_Sqrt:  [[0.15]]
grads:  [0.05673903]
Stock Position:  0.05673903292978772
Bond Position:  [-3.83621106]


portfolio before change:  [2.18320285]
curr_Stock_Price:  106.09369553737639
curr_Factors:  [106.09369554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03408361]
Stock Position:  -0.03408360598242541
Bond Position:  [5.79925857]


portfolio before change:  [2.17288534]
curr_Stock_Price:  106.40704213037334
curr_Factors:  [106.40704213]
mat_Sqrt:  [[0.15]]
grads:  [0.10381319]
Stock Position:  0.10381319245541558
Bond Position:  [-8.87356941]


portfolio before change:  [2.12457232]
curr_Stock_Price:  105.94700039207997
curr_Factors:  [105.94700039]
mat_Sqrt:  [[0.15]]
grads:  [-0.08589549]
Stock Position:  -0.08589548728178088
Bond Position:  [11.22494154]


portfolio before change:  [2.12579765]
curr_Stock_Price:  105.94090281238981
curr_Factors:  [105.94090281]
mat_Sqrt:  [[0.15]]
grads:  [-0.14354735]
Stock Position:  -0.14354735271113117
Bond Position:  [17.3333338]


portfolio before change:  [2.17762781]
curr_Stock_Price:  105.58738332211412
curr_Factors:  [105.58738332]
mat_Sqrt:  [[0.15]]
grads:  [-0.07321728]
Stock Position:  -0.07321727621760359
Bond Position:  [9.90844842]


portfolio before change:  [2.164844]
curr_Stock_Price:  105.77044259426567
curr_Factors:  [105.77044259]
mat_Sqrt:  [[0.15]]
grads:  [0.09758925]
Stock Position:  0.09758925355800177
Bond Position:  [-8.15721454]


portfolio before change:  [2.1454141]
curr_Stock_Price:  105.57656812553421
curr_Factors:  [105.57656813]
mat_Sqrt:  [[0.15]]
grads:  [-0.09000994]
Stock Position:  -0.09000994475132645
Bond Position:  [11.64835516]


portfolio before change:  [2.1883401]
curr_Stock_Price:  105.10775377373122
curr_Factors:  [105.10775377]
mat_Sqrt:  [[0.15]]
grads:  [0.17467179]
Stock Position:  0.17467178885592005
Bond Position:  [-16.17101928]


portfolio before change:  [2.3177178]
curr_Stock_Price:  105.85423049539729
curr_Factors:  [105.8542305]
mat_Sqrt:  [[0.15]]
grads:  [-0.17978288]
Stock Position:  -0.17978288271473603
Bond Position:  [21.34849651]


portfolio before change:  [2.351139]
curr_Stock_Price:  105.67575477478395
curr_Factors:  [105.67575477]
mat_Sqrt:  [[0.15]]
grads:  [0.01958267]
Stock Position:  0.01958267298914671
Bond Position:  [0.28172525]


portfolio before change:  [2.35051681]
curr_Stock_Price:  105.64308279503533
curr_Factors:  [105.6430828]
mat_Sqrt:  [[0.15]]
grads:  [0.0201813]
Stock Position:  0.0201813024452178
Bond Position:  [0.2185018]


portfolio before change:  [2.36977712]
curr_Stock_Price:  106.59677018348327
curr_Factors:  [106.59677018]
mat_Sqrt:  [[0.15]]
grads:  [-0.0975438]
Stock Position:  -0.09754380466429462
Bond Position:  [12.76763165]


portfolio before change:  [2.39683748]
curr_Stock_Price:  106.32753361545672
curr_Factors:  [106.32753362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.39683748]
Stock Price:  106.8475708591979
PL:  [-4.45073338]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.68724182e-03]
 [-2.65244185e-02]
 [-3.48768929e-04]
 [ 7.15681023e-03]
 [ 5.59532134e-03]
 [ 2.60236046e-02]
 [ 1.55490863e-03]
 [-1.53594590e-02]
 [ 2.41850358e-02]
 [-4.81230245e-03]
 [ 1.54775898e-02]
 [-3.38487616e-02]
 [ 2.40923366e-02]
 [ 1.55688023e-03]
 [-6.90620444e-03]
 [ 1.92244964e-02]
 [ 1.05417146e-02]
 [-1.09861940e-02]
 [ 4.89773640e-03]
 [-5.56124905e-03]
 [ 1.35414362e-02]
 [-4.90775779e-03]
 [ 1.10895450e-02]
 [-2.16532795e-02]
 [ 4.95051710e-03]
 [ 8.09093884e-03]
 [-5.34470557e-03]
 [ 1.04904857e-02]
 [ 4.11433329e-02]
 [-5.50945435e-04]
 [ 1.37436808e-02]
 [-1.20443925e-02]
 [ 8.63001233e-03]
 [ 7.70974917e-03]
 [ 1.09635959e-02]
 [ 8.52880899e-03]
 [-3.33583252e-02]
 [ 9.35059490e-03]
 [ 5.27101668e-03]
 [ 1.79277833e-02]
 [-5.58255762e-03]
 [-1.40051675e-02]
 [ 2.32936326e-02]
 [ 3.80522816e-03]
 [-8.16736169e-03]
 [-6.33337493e-03]
 [ 3.22663878e-03]
 [-1.24186801e-02]
 [-1.42914207e-02]
 [-7.06307539e-03]
 [ 2.55826659e-02]
 [-7.99264063e-03]
 [ 2.24226224e-03]
 [ 5.39325029e-03]
 [ 5.70491972e-03]
 [-3.41174001e-03]
 [ 7.15338681e-03]
 [-6.33507903e-04]
 [ 1.52886246e-03]
 [ 5.87970260e-04]
 [-4.54401454e-05]
 [-9.08252932e-04]
 [ 7.48839018e-03]
 [-1.81148329e-02]
 [-8.56758941e-03]
 [-7.69557747e-03]
 [-4.78400698e-03]
 [ 1.68198173e-02]
 [-1.09238136e-02]
 [ 7.36754779e-03]
 [-2.11004035e-03]
 [ 1.16804107e-02]
 [ 9.35565360e-04]
 [ 3.85011210e-03]
 [-1.31299338e-02]
 [-8.93142075e-03]
 [ 2.01217132e-03]
 [ 1.08536942e-03]
 [-8.97199390e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.72196365]
curr_Stock_Price:  99.43015114551741
curr_Factors:  [99.43015115]
mat_Sqrt:  [[0.15]]
grads:  [0.03124828]
Stock Position:  0.03124827878232509
Bond Position:  [-9.82898473]


portfolio before change:  [-6.74614985]
curr_Stock_Price:  98.67580990143871
curr_Factors:  [98.6758099]
mat_Sqrt:  [[0.15]]
grads:  [-0.17682946]
Stock Position:  -0.17682945688586685
Bond Position:  [10.70264003]


portfolio before change:  [-6.91896418]
curr_Stock_Price:  99.65688663078613
curr_Factors:  [99.65688663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232513]
Stock Position:  -0.002325126191607523
Bond Position:  [-6.68724934]


portfolio before change:  [-6.92077194]
curr_Stock_Price:  100.25461752872796
curr_Factors:  [100.25461753]
mat_Sqrt:  [[0.15]]
grads:  [0.04771207]
Stock Position:  0.04771206816873686
Bond Position:  [-11.70412709]


portfolio before change:  [-6.90325323]
curr_Stock_Price:  100.63712541200489
curr_Factors:  [100.63712541]
mat_Sqrt:  [[0.15]]
grads:  [0.03730214]
Stock Position:  0.03730214225304173
Bond Position:  [-10.6572336]


portfolio before change:  [-6.91688891]
curr_Stock_Price:  100.28943546484241
curr_Factors:  [100.28943546]
mat_Sqrt:  [[0.15]]
grads:  [0.1734907]
Stock Position:  0.1734906971098783
Bond Position:  [-24.31617298]


portfolio before change:  [-6.91432932]
curr_Stock_Price:  100.31294909683072
curr_Factors:  [100.3129491]
mat_Sqrt:  [[0.15]]
grads:  [0.01036606]
Stock Position:  0.010366057556034095
Bond Position:  [-7.95417913]


portfolio before change:  [-6.91486698]
curr_Stock_Price:  100.3090418229481
curr_Factors:  [100.30904182]
mat_Sqrt:  [[0.15]]
grads:  [-0.10239639]
Stock Position:  -0.10239639327431534
Bond Position:  [3.35641712]


portfolio before change:  [-6.97736831]
curr_Stock_Price:  100.92147668387652
curr_Factors:  [100.92147668]
mat_Sqrt:  [[0.15]]
grads:  [0.16123357]
Stock Position:  0.16123357189409887
Bond Position:  [-23.24929848]


portfolio before change:  [-6.9746334]
curr_Stock_Price:  100.94745164686205
curr_Factors:  [100.94745165]
mat_Sqrt:  [[0.15]]
grads:  [-0.03208202]
Stock Position:  -0.03208201631631834
Bond Position:  [-3.73603561]


portfolio before change:  [-6.96089827]
curr_Stock_Price:  100.51204741756436
curr_Factors:  [100.51204742]
mat_Sqrt:  [[0.15]]
grads:  [0.10318393]
Stock Position:  0.10318393174234183
Bond Position:  [-17.33212651]


portfolio before change:  [-6.91189113]
curr_Stock_Price:  100.99749537353983
curr_Factors:  [100.99749537]
mat_Sqrt:  [[0.15]]
grads:  [-0.22565841]
Stock Position:  -0.2256584107880901
Bond Position:  [15.87904317]


portfolio before change:  [-6.9014659]
curr_Stock_Price:  100.95569431690205
curr_Factors:  [100.95569432]
mat_Sqrt:  [[0.15]]
grads:  [0.16061558]
Stock Position:  0.16061557731670664
Bond Position:  [-23.11652303]


portfolio before change:  [-6.92413957]
curr_Stock_Price:  100.82352254899129
curr_Factors:  [100.82352255]
mat_Sqrt:  [[0.15]]
grads:  [0.0103792]
Stock Position:  0.010379201556215845
Bond Position:  [-7.97060724]


portfolio before change:  [-6.92176245]
curr_Stock_Price:  101.10054806612492
curr_Factors:  [101.10054807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04604136]
Stock Position:  -0.046041362925482714
Bond Position:  [-2.26695542]


portfolio before change:  [-6.91909349]
curr_Stock_Price:  101.03950185505465
curr_Factors:  [101.03950186]
mat_Sqrt:  [[0.15]]
grads:  [0.12816331]
Stock Position:  0.12816330961392755
Bond Position:  [-19.86865045]


portfolio before change:  [-6.90910467]
curr_Stock_Price:  101.12712948524847
curr_Factors:  [101.12712949]
mat_Sqrt:  [[0.15]]
grads:  [0.0702781]
Stock Position:  0.07027809714444616
Bond Position:  [-14.0161269]


portfolio before change:  [-6.88566242]
curr_Stock_Price:  101.47315888281574
curr_Factors:  [101.47315888]
mat_Sqrt:  [[0.15]]
grads:  [-0.07324129]
Stock Position:  -0.0732412936275131
Bond Position:  [0.54636301]


portfolio before change:  [-6.95650058]
curr_Stock_Price:  102.4408140286345
curr_Factors:  [102.44081403]
mat_Sqrt:  [[0.15]]
grads:  [0.03265158]
Stock Position:  0.032651575971339074
Bond Position:  [-10.3013546]


portfolio before change:  [-6.98448025]
curr_Stock_Price:  101.60361671226727
curr_Factors:  [101.60361671]
mat_Sqrt:  [[0.15]]
grads:  [-0.03707499]
Stock Position:  -0.03707499369943654
Bond Position:  [-3.2175268]


portfolio before change:  [-6.98615537]
curr_Stock_Price:  101.64337449509576
curr_Factors:  [101.6433745]
mat_Sqrt:  [[0.15]]
grads:  [0.09027624]
Stock Position:  0.09027624153017322
Bond Position:  [-16.1621372]


portfolio before change:  [-6.94959049]
curr_Stock_Price:  102.05959748876012
curr_Factors:  [102.05959749]
mat_Sqrt:  [[0.15]]
grads:  [-0.03271839]
Stock Position:  -0.03271838524516633
Bond Position:  [-3.61036526]


portfolio before change:  [-6.96306586]
curr_Stock_Price:  102.46455980000471
curr_Factors:  [102.4645598]
mat_Sqrt:  [[0.15]]
grads:  [0.0739303]
Stock Position:  0.07393030009330248
Bond Position:  [-14.53830151]


portfolio before change:  [-6.93620434]
curr_Stock_Price:  102.84018636062413
curr_Factors:  [102.84018636]
mat_Sqrt:  [[0.15]]
grads:  [-0.1443552]
Stock Position:  -0.14435519687825138
Bond Position:  [7.90931101]


portfolio before change:  [-6.92873388]
curr_Stock_Price:  102.79186032336125
curr_Factors:  [102.79186032]
mat_Sqrt:  [[0.15]]
grads:  [0.03300345]
Stock Position:  0.033003447352692616
Bond Position:  [-10.32121963]


portfolio before change:  [-6.93643904]
curr_Stock_Price:  102.57794153443915
curr_Factors:  [102.57794153]
mat_Sqrt:  [[0.15]]
grads:  [0.05393959]
Stock Position:  0.05393959223523248
Bond Position:  [-12.46945137]


portfolio before change:  [-6.94293523]
curr_Stock_Price:  102.47195578015257
curr_Factors:  [102.47195578]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563137]
Stock Position:  -0.03563137048953277
Bond Position:  [-3.29171901]


portfolio before change:  [-6.94106547]
curr_Stock_Price:  102.41370661893234
curr_Factors:  [102.41370662]
mat_Sqrt:  [[0.15]]
grads:  [0.06993657]
Stock Position:  0.06993657165108967
Bond Position:  [-14.103529]


portfolio before change:  [-6.90979203]
curr_Stock_Price:  102.87347951007898
curr_Factors:  [102.87347951]
mat_Sqrt:  [[0.15]]
grads:  [0.27428889]
Stock Position:  0.27428888575634136
Bond Position:  [-35.1268441]


portfolio before change:  [-7.09859983]
curr_Stock_Price:  102.19313002105528
curr_Factors:  [102.19313002]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367297]
Stock Position:  -0.0036729695691908597
Bond Position:  [-6.72324757]


portfolio before change:  [-7.09913337]
curr_Stock_Price:  102.22398296649067
curr_Factors:  [102.22398297]
mat_Sqrt:  [[0.15]]
grads:  [0.09162454]
Stock Position:  0.09162453836482057
Bond Position:  [-16.46535862]


portfolio before change:  [-7.12804818]
curr_Stock_Price:  101.91963549815344
curr_Factors:  [101.9196355]
mat_Sqrt:  [[0.15]]
grads:  [-0.08029595]
Stock Position:  -0.08029595007245333
Bond Position:  [1.05568578]


portfolio before change:  [-7.09398543]
curr_Stock_Price:  101.49624226181251
curr_Factors:  [101.49624226]
mat_Sqrt:  [[0.15]]
grads:  [0.05753342]
Stock Position:  0.05753341552465585
Bond Position:  [-12.93341092]


portfolio before change:  [-7.11209817]
curr_Stock_Price:  101.19547146499654
curr_Factors:  [101.19547146]
mat_Sqrt:  [[0.15]]
grads:  [0.05139833]
Stock Position:  0.05139832777259321
Bond Position:  [-12.31337618]


portfolio before change:  [-7.07534562]
curr_Stock_Price:  101.92549827724083
curr_Factors:  [101.92549828]
mat_Sqrt:  [[0.15]]
grads:  [0.07309064]
Stock Position:  0.07309063955971479
Bond Position:  [-14.52514548]


portfolio before change:  [-7.04134333]
curr_Stock_Price:  102.40312635708284
curr_Factors:  [102.40312636]
mat_Sqrt:  [[0.15]]
grads:  [0.05685873]
Stock Position:  0.05685872662344944
Bond Position:  [-12.8638547]


portfolio before change:  [-7.04131443]
curr_Stock_Price:  102.41777531089484
curr_Factors:  [102.41777531]
mat_Sqrt:  [[0.15]]
grads:  [-0.22238883]
Stock Position:  -0.22238883452708086
Bond Position:  [15.73525526]


portfolio before change:  [-7.03074263]
curr_Stock_Price:  102.37466022695564
curr_Factors:  [102.37466023]
mat_Sqrt:  [[0.15]]
grads:  [0.0623373]
Stock Position:  0.06233729932918107
Bond Position:  [-13.41250247]


portfolio before change:  [-7.0541189]
curr_Stock_Price:  102.01311166798611
curr_Factors:  [102.01311167]
mat_Sqrt:  [[0.15]]
grads:  [0.03514011]
Stock Position:  0.03514011122213027
Bond Position:  [-10.63887099]


portfolio before change:  [-7.0730223]
curr_Stock_Price:  101.49409076411672
curr_Factors:  [101.49409076]
mat_Sqrt:  [[0.15]]
grads:  [0.11951856]
Stock Position:  0.11951855562529964
Bond Position:  [-19.20344943]


portfolio before change:  [-7.08534283]
curr_Stock_Price:  101.40104846970425
curr_Factors:  [101.40104847]
mat_Sqrt:  [[0.15]]
grads:  [-0.03721705]
Stock Position:  -0.037217050804517315
Bond Position:  [-3.31149486]


portfolio before change:  [-7.05435148]
curr_Stock_Price:  100.56276809466348
curr_Factors:  [100.56276809]
mat_Sqrt:  [[0.15]]
grads:  [-0.09336778]
Stock Position:  -0.09336778342400309
Bond Position:  [2.33497127]


portfolio before change:  [-7.0459709]
curr_Stock_Price:  100.47457233716386
curr_Factors:  [100.47457234]
mat_Sqrt:  [[0.15]]
grads:  [0.15529088]
Stock Position:  0.15529088387008894
Bond Position:  [-22.64875605]


portfolio before change:  [-7.11940296]
curr_Stock_Price:  100.01082026839322
curr_Factors:  [100.01082027]
mat_Sqrt:  [[0.15]]
grads:  [0.02536819]
Stock Position:  0.02536818771005529
Bond Position:  [-9.65649622]


portfolio before change:  [-7.12839544]
curr_Stock_Price:  99.68013326631831
curr_Factors:  [99.68013327]
mat_Sqrt:  [[0.15]]
grads:  [-0.05444908]
Stock Position:  -0.054449077923235216
Bond Position:  [-1.7009041]


portfolio before change:  [-7.07484902]
curr_Stock_Price:  98.69475882825513
curr_Factors:  [98.69475883]
mat_Sqrt:  [[0.15]]
grads:  [-0.0422225]
Stock Position:  -0.04222249956187465
Bond Position:  [-2.90770961]


portfolio before change:  [-7.1139689]
curr_Stock_Price:  99.61697187459812
curr_Factors:  [99.61697187]
mat_Sqrt:  [[0.15]]
grads:  [0.02151093]
Stock Position:  0.02151092516846759
Bond Position:  [-9.25682213]


portfolio before change:  [-7.11414932]
curr_Stock_Price:  99.63548102312072
curr_Factors:  [99.63548102]
mat_Sqrt:  [[0.15]]
grads:  [-0.0827912]
Stock Position:  -0.08279120040339953
Bond Position:  [1.13479176]


portfolio before change:  [-7.12880443]
curr_Stock_Price:  99.81335057017856
curr_Factors:  [99.81335057]
mat_Sqrt:  [[0.15]]
grads:  [-0.09527614]
Stock Position:  -0.09527613785794793
Bond Position:  [2.38102612]


portfolio before change:  [-7.16581847]
curr_Stock_Price:  100.20340484075797
curr_Factors:  [100.20340484]
mat_Sqrt:  [[0.15]]
grads:  [-0.04708717]
Stock Position:  -0.04708716925672963
Bond Position:  [-2.44752379]


portfolio before change:  [-7.19536938]
curr_Stock_Price:  100.82773493174562
curr_Factors:  [100.82773493]
mat_Sqrt:  [[0.15]]
grads:  [0.17055111]
Stock Position:  0.17055110616257702
Bond Position:  [-24.39165111]


portfolio before change:  [-7.23482206]
curr_Stock_Price:  100.60534907871919
curr_Factors:  [100.60534908]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328427]
Stock Position:  -0.05328427084487313
Bond Position:  [-1.87413939]


portfolio before change:  [-7.21068446]
curr_Stock_Price:  100.15015386258025
curr_Factors:  [100.15015386]
mat_Sqrt:  [[0.15]]
grads:  [0.01494841]
Stock Position:  0.01494841492585578
Bond Position:  [-8.70777051]


portfolio before change:  [-7.21163065]
curr_Stock_Price:  100.1232651244261
curr_Factors:  [100.12326512]
mat_Sqrt:  [[0.15]]
grads:  [0.035955]
Stock Position:  0.03595500192281296
Bond Position:  [-10.81156284]


portfolio before change:  [-7.23969764]
curr_Stock_Price:  99.36144490551762
curr_Factors:  [99.36144491]
mat_Sqrt:  [[0.15]]
grads:  [0.0380328]
Stock Position:  0.0380327981468959
Bond Position:  [-11.01869142]


portfolio before change:  [-7.25364945]
curr_Stock_Price:  99.01271654384507
curr_Factors:  [99.01271654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02274493]
Stock Position:  -0.022744933395699222
Bond Position:  [-5.0016118]


portfolio before change:  [-7.22941182]
curr_Stock_Price:  97.93334460390761
curr_Factors:  [97.9333446]
mat_Sqrt:  [[0.15]]
grads:  [0.04768925]
Stock Position:  0.047689245415359474
Bond Position:  [-11.89977912]


portfolio before change:  [-7.22670227]
curr_Stock_Price:  98.00575721051273
curr_Factors:  [98.00575721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422339]
Stock Position:  -0.004223386020732488
Bond Position:  [-6.81278613]


portfolio before change:  [-7.22628474]
curr_Stock_Price:  97.8060715245568
curr_Factors:  [97.80607152]
mat_Sqrt:  [[0.15]]
grads:  [0.01019242]
Stock Position:  0.010192416386834224
Bond Position:  [-8.22316494]


portfolio before change:  [-7.22418487]
curr_Stock_Price:  98.06252001020731
curr_Factors:  [98.06252001]
mat_Sqrt:  [[0.15]]
grads:  [0.0039198]
Stock Position:  0.00391980173120835
Bond Position:  [-7.60857051]


portfolio before change:  [-7.22430374]
curr_Stock_Price:  98.15351310331066
curr_Factors:  [98.1535131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00030293]
Stock Position:  -0.00030293430254605774
Bond Position:  [-7.19456968]


portfolio before change:  [-7.22485457]
curr_Stock_Price:  98.48740173506015
curr_Factors:  [98.48740174]
mat_Sqrt:  [[0.15]]
grads:  [-0.00605502]
Stock Position:  -0.006055019549649164
Bond Position:  [-6.62851142]


portfolio before change:  [-7.22300935]
curr_Stock_Price:  98.11423773247633
curr_Factors:  [98.11423773]
mat_Sqrt:  [[0.15]]
grads:  [0.0499226]
Stock Position:  0.0499226011951036
Bond Position:  [-12.12112731]


portfolio before change:  [-7.23499117]
curr_Stock_Price:  97.88940509826203
curr_Factors:  [97.8894051]
mat_Sqrt:  [[0.15]]
grads:  [-0.12076555]
Stock Position:  -0.1207655529430262
Bond Position:  [4.58667696]


portfolio before change:  [-7.17678659]
curr_Stock_Price:  97.40981546994067
curr_Factors:  [97.40981547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05711726]
Stock Position:  -0.05711726271143125
Bond Position:  [-1.61300457]


portfolio before change:  [-7.18454205]
curr_Stock_Price:  97.54383190027929
curr_Factors:  [97.5438319]
mat_Sqrt:  [[0.15]]
grads:  [-0.05130385]
Stock Position:  -0.05130384979689345
Bond Position:  [-2.18016795]


portfolio before change:  [-7.20038453]
curr_Stock_Price:  97.84997296843392
curr_Factors:  [97.84997297]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189338]
Stock Position:  -0.03189337989019715
Bond Position:  [-4.07961817]


portfolio before change:  [-7.18494135]
curr_Stock_Price:  97.35776525178152
curr_Factors:  [97.35776525]
mat_Sqrt:  [[0.15]]
grads:  [0.11213212]
Stock Position:  0.11213211520244916
Bond Position:  [-18.1018735]


portfolio before change:  [-7.22241163]
curr_Stock_Price:  97.03369329180185
curr_Factors:  [97.03369329]
mat_Sqrt:  [[0.15]]
grads:  [-0.07282542]
Stock Position:  -0.07282542398835719
Bond Position:  [-0.15589177]


portfolio before change:  [-7.27825138]
curr_Stock_Price:  97.80032121917976
curr_Factors:  [97.80032122]
mat_Sqrt:  [[0.15]]
grads:  [0.04911699]
Stock Position:  0.04911698523369229
Bond Position:  [-12.08190831]


portfolio before change:  [-7.31090908]
curr_Stock_Price:  97.15079922662956
curr_Factors:  [97.15079923]
mat_Sqrt:  [[0.15]]
grads:  [-0.01406694]
Stock Position:  -0.014066935699916424
Bond Position:  [-5.94429503]


portfolio before change:  [-7.30849965]
curr_Stock_Price:  96.95310439849689
curr_Factors:  [96.9531044]
mat_Sqrt:  [[0.15]]
grads:  [0.0778694]
Stock Position:  0.07786940491500512
Bond Position:  [-14.85818019]


portfolio before change:  [-7.3293775]
curr_Stock_Price:  96.69691671526117
curr_Factors:  [96.69691672]
mat_Sqrt:  [[0.15]]
grads:  [0.0062371]
Stock Position:  0.006237102399790083
Bond Position:  [-7.93248607]


portfolio before change:  [-7.32839745]
curr_Stock_Price:  96.93353943759533
curr_Factors:  [96.93353944]
mat_Sqrt:  [[0.15]]
grads:  [0.02566741]
Stock Position:  0.025667414030489003
Bond Position:  [-9.81643074]


portfolio before change:  [-7.30418485]
curr_Stock_Price:  97.900763876141
curr_Factors:  [97.90076388]
mat_Sqrt:  [[0.15]]
grads:  [-0.08753289]
Stock Position:  -0.0875328921115239
Bond Position:  [1.26535215]


portfolio before change:  [-7.29165155]
curr_Stock_Price:  97.75848353973016
curr_Factors:  [97.75848354]
mat_Sqrt:  [[0.15]]
grads:  [-0.0595428]
Stock Position:  -0.059542804968541675
Bond Position:  [-1.47083723]


portfolio before change:  [-7.28983033]
curr_Stock_Price:  97.72635283498978
curr_Factors:  [97.72635283]
mat_Sqrt:  [[0.15]]
grads:  [0.01341448]
Stock Position:  0.013414475490639942
Bond Position:  [-8.6007781]


portfolio before change:  [-7.27929791]
curr_Stock_Price:  98.5515795440773
curr_Factors:  [98.55157954]
mat_Sqrt:  [[0.15]]
grads:  [0.0072358]
Stock Position:  0.007235796163068202
Bond Position:  [-7.99239705]


portfolio before change:  [-7.28575583]
curr_Stock_Price:  97.72812155537146
curr_Factors:  [97.72812156]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.28575583]
Stock Price:  97.979247559362
PL:  [-7.28575583]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.86692768e-03]
 [ 2.38089545e-03]
 [-6.28432412e-05]
 [ 8.40648347e-03]
 [ 1.56266858e-03]
 [ 1.48195701e-02]
 [ 2.28919595e-03]
 [-1.83292766e-02]
 [-1.59428774e-03]
 [ 2.87181996e-02]
 [-1.70225515e-02]
 [ 3.06092542e-02]
 [-8.10333995e-03]
 [ 3.68387441e-04]
 [-7.07078164e-03]
 [ 1.09393906e-02]
 [ 1.10526877e-02]
 [ 3.39089395e-03]
 [ 8.14263625e-04]
 [ 1.49358703e-02]
 [ 1.32983540e-02]
 [-1.19470298e-02]
 [-2.08820061e-04]
 [-7.96594879e-02]
 [-1.25784275e-02]
 [-3.45590405e-03]
 [ 6.07503490e-04]
 [ 1.08500771e-02]
 [-5.31549164e-02]
 [ 5.48721113e-03]
 [ 1.43297900e-02]
 [-1.27897271e-02]
 [-6.27148024e-03]
 [ 7.34995536e-03]
 [ 1.37151883e-02]
 [ 1.97539953e-03]
 [-2.98808981e-02]
 [ 7.51041360e-03]
 [-4.45507263e-02]
 [-5.01393339e-04]
 [-1.40377472e-02]
 [ 5.18255580e-02]
 [ 2.33255842e-02]
 [ 3.12264932e-03]
 [ 1.03722105e-02]
 [ 2.31103514e-02]
 [-3.61969959e-03]
 [-5.31997218e-03]
 [ 1.51040771e-02]
 [ 5.73853581e-03]
 [ 3.39475230e-02]
 [ 2.13864719e-03]
 [ 1.62340284e-03]
 [ 4.61916377e-03]
 [ 3.60610410e-03]
 [ 3.07053920e-03]
 [-7.22954299e-03]
 [-5.11559440e-05]
 [ 1.56514716e-03]
 [-1.23990401e-02]
 [-1.06968804e-02]
 [ 1.43189218e-02]
 [ 1.46654123e-02]
 [-1.88055326e-02]
 [-3.54707190e-03]
 [-1.44380047e-02]
 [-4.62113636e-03]
 [ 1.17067044e-02]
 [-1.24083298e-02]
 [ 1.06778092e-02]
 [ 1.42821685e-03]
 [ 1.18294223e-02]
 [ 2.76267751e-03]
 [-7.52829605e-04]
 [ 2.70014852e-03]
 [-1.72440338e-02]
 [ 5.06728447e-03]
 [ 7.04707438e-03]
 [-1.44246800e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.62163267]
curr_Stock_Price:  99.97269315353601
curr_Factors:  [99.97269315]
mat_Sqrt:  [[0.15]]
grads:  [0.01244618]
Stock Position:  0.012446184565275673
Bond Position:  [0.37735408]


portfolio before change:  [1.62836166]
curr_Stock_Price:  100.51144460620299
curr_Factors:  [100.51144461]
mat_Sqrt:  [[0.15]]
grads:  [0.01587264]
Stock Position:  0.015872636348858493
Bond Position:  [0.03298005]


portfolio before change:  [1.61623522]
curr_Stock_Price:  99.74733101970224
curr_Factors:  [99.74733102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041895]
Stock Position:  -0.0004189549412828876
Bond Position:  [1.65802486]


portfolio before change:  [1.6164673]
curr_Stock_Price:  99.44074019104488
curr_Factors:  [99.44074019]
mat_Sqrt:  [[0.15]]
grads:  [0.05604322]
Stock Position:  0.05604322311236715
Bond Position:  [-3.95651229]


portfolio before change:  [1.59973754]
curr_Stock_Price:  99.14663730760337
curr_Factors:  [99.14663731]
mat_Sqrt:  [[0.15]]
grads:  [0.01041779]
Stock Position:  0.010417790503898797
Bond Position:  [0.56684864]


portfolio before change:  [1.59308457]
curr_Stock_Price:  98.50462051912257
curr_Factors:  [98.50462052]
mat_Sqrt:  [[0.15]]
grads:  [0.09879713]
Stock Position:  0.09879713392214279
Bond Position:  [-8.13888962]


portfolio before change:  [1.59607024]
curr_Stock_Price:  98.53998958589898
curr_Factors:  [98.53998959]
mat_Sqrt:  [[0.15]]
grads:  [0.01526131]
Stock Position:  0.015261306341227365
Bond Position:  [0.09222127]


portfolio before change:  [1.6029009]
curr_Stock_Price:  98.98719239253664
curr_Factors:  [98.98719239]
mat_Sqrt:  [[0.15]]
grads:  [-0.12219518]
Stock Position:  -0.12219517740878691
Bond Position:  [13.69865843]


portfolio before change:  [1.65079637]
curr_Stock_Price:  98.60224042715946
curr_Factors:  [98.60224043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062858]
Stock Position:  -0.01062858493923853
Bond Position:  [2.69879865]


portfolio before change:  [1.65825327]
curr_Stock_Price:  97.91652134232477
curr_Factors:  [97.91652134]
mat_Sqrt:  [[0.15]]
grads:  [0.19145466]
Stock Position:  0.1914546640993962
Bond Position:  [-17.08832143]


portfolio before change:  [1.7162584]
curr_Stock_Price:  98.22507052880802
curr_Factors:  [98.22507053]
mat_Sqrt:  [[0.15]]
grads:  [-0.11348368]
Stock Position:  -0.11348367656177745
Bond Position:  [12.86320053]


portfolio before change:  [1.82770024]
curr_Stock_Price:  97.25014737595278
curr_Factors:  [97.25014738]
mat_Sqrt:  [[0.15]]
grads:  [0.20406169]
Stock Position:  0.20406169460192564
Bond Position:  [-18.01732964]


portfolio before change:  [1.68680782]
curr_Stock_Price:  96.56522561069671
curr_Factors:  [96.56522561]
mat_Sqrt:  [[0.15]]
grads:  [-0.05402227]
Stock Position:  -0.05402226632112251
Bond Position:  [6.90348016]


portfolio before change:  [1.66628218]
curr_Stock_Price:  96.95316058489995
curr_Factors:  [96.95316058]
mat_Sqrt:  [[0.15]]
grads:  [0.00245592]
Stock Position:  0.0024559162723374398
Bond Position:  [1.42817333]


portfolio before change:  [1.66579579]
curr_Stock_Price:  96.7187663817414
curr_Factors:  [96.71876638]
mat_Sqrt:  [[0.15]]
grads:  [-0.04713854]
Stock Position:  -0.04713854423954202
Bond Position:  [6.22497763]


portfolio before change:  [1.65442721]
curr_Stock_Price:  96.96819392510959
curr_Factors:  [96.96819393]
mat_Sqrt:  [[0.15]]
grads:  [0.07292927]
Stock Position:  0.07292927091621997
Bond Position:  [-5.41739248]


portfolio before change:  [1.69765844]
curr_Stock_Price:  97.56561978352453
curr_Factors:  [97.56561978]
mat_Sqrt:  [[0.15]]
grads:  [0.07368458]
Stock Position:  0.07368458446110865
Bond Position:  [-5.49142371]


portfolio before change:  [1.68033972]
curr_Stock_Price:  97.33523916259784
curr_Factors:  [97.33523916]
mat_Sqrt:  [[0.15]]
grads:  [0.02260596]
Stock Position:  0.022605959689187168
Bond Position:  [-0.52001677]


portfolio before change:  [1.65300273]
curr_Stock_Price:  96.12739451602125
curr_Factors:  [96.12739452]
mat_Sqrt:  [[0.15]]
grads:  [0.00542842]
Stock Position:  0.005428424168821087
Bond Position:  [1.13118246]


portfolio before change:  [1.65020626]
curr_Stock_Price:  95.59921806178495
curr_Factors:  [95.59921806]
mat_Sqrt:  [[0.15]]
grads:  [0.09957247]
Stock Position:  0.09957246881666555
Bond Position:  [-7.8688439]


portfolio before change:  [1.59109969]
curr_Stock_Price:  95.01055377606845
curr_Factors:  [95.01055378]
mat_Sqrt:  [[0.15]]
grads:  [0.08865569]
Stock Position:  0.08865569365129325
Bond Position:  [-6.83212686]


portfolio before change:  [1.61997848]
curr_Stock_Price:  95.34111138621243
curr_Factors:  [95.34111139]
mat_Sqrt:  [[0.15]]
grads:  [-0.07964687]
Stock Position:  -0.0796468650003687
Bond Position:  [9.21359911]


portfolio before change:  [1.58104308]
curr_Stock_Price:  95.83719206722482
curr_Factors:  [95.83719207]
mat_Sqrt:  [[0.15]]
grads:  [-0.00139213]
Stock Position:  -0.0013921337367328937
Bond Position:  [1.71446127]


portfolio before change:  [1.58104462]
curr_Stock_Price:  95.91305577245748
curr_Factors:  [95.91305577]
mat_Sqrt:  [[0.15]]
grads:  [-0.53106325]
Stock Position:  -0.5310632524570795
Bond Position:  [52.51694398]


portfolio before change:  [1.53829221]
curr_Stock_Price:  95.99974003920785
curr_Factors:  [95.99974004]
mat_Sqrt:  [[0.15]]
grads:  [-0.08385618]
Stock Position:  -0.08385618306840226
Bond Position:  [9.58846398]


portfolio before change:  [1.48375824]
curr_Stock_Price:  96.6572141545517
curr_Factors:  [96.65721415]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303936]
Stock Position:  -0.023039360302402938
Bond Position:  [3.71067862]


portfolio before change:  [1.49339499]
curr_Stock_Price:  96.2490070006785
curr_Factors:  [96.249007]
mat_Sqrt:  [[0.15]]
grads:  [0.00405002]
Stock Position:  0.004050023263543322
Bond Position:  [1.10358427]


portfolio before change:  [1.49401011]
curr_Stock_Price:  96.38385649525152
curr_Factors:  [96.3838565]
mat_Sqrt:  [[0.15]]
grads:  [0.07233385]
Stock Position:  0.07233384713502707
Bond Position:  [-5.47780503]


portfolio before change:  [1.46185871]
curr_Stock_Price:  95.94410350237034
curr_Factors:  [95.9441035]
mat_Sqrt:  [[0.15]]
grads:  [-0.35436611]
Stock Position:  -0.35436610950641806
Bond Position:  [35.4611974]


portfolio before change:  [1.53473301]
curr_Stock_Price:  95.74471110374094
curr_Factors:  [95.7447111]
mat_Sqrt:  [[0.15]]
grads:  [0.03658141]
Stock Position:  0.036581407512956146
Bond Position:  [-1.96774328]


portfolio before change:  [1.5187131]
curr_Stock_Price:  95.3101482121369
curr_Factors:  [95.31014821]
mat_Sqrt:  [[0.15]]
grads:  [0.09553193]
Stock Position:  0.09553193320483834
Bond Position:  [-7.58644961]


portfolio before change:  [1.51339134]
curr_Stock_Price:  95.25940504779079
curr_Factors:  [95.25940505]
mat_Sqrt:  [[0.15]]
grads:  [-0.08526485]
Stock Position:  -0.08526484761165042
Bond Position:  [9.63567]


portfolio before change:  [1.61618018]
curr_Stock_Price:  94.06094414831877
curr_Factors:  [94.06094415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04180987]
Stock Position:  -0.0418098682560928
Bond Position:  [5.54885586]


portfolio before change:  [1.58220768]
curr_Stock_Price:  94.8817866312717
curr_Factors:  [94.88178663]
mat_Sqrt:  [[0.15]]
grads:  [0.0489997]
Stock Position:  0.04899970241610329
Bond Position:  [-3.06697163]


portfolio before change:  [1.56126494]
curr_Stock_Price:  94.45829335172111
curr_Factors:  [94.45829335]
mat_Sqrt:  [[0.15]]
grads:  [0.09143459]
Stock Position:  0.09143458874448693
Bond Position:  [-7.07549027]


portfolio before change:  [1.60521551]
curr_Stock_Price:  94.94380768746176
curr_Factors:  [94.94380769]
mat_Sqrt:  [[0.15]]
grads:  [0.01316933]
Stock Position:  0.013169330198403764
Bond Position:  [0.35486916]


portfolio before change:  [1.60259909]
curr_Stock_Price:  94.7434478971132
curr_Factors:  [94.7434479]
mat_Sqrt:  [[0.15]]
grads:  [-0.19920599]
Stock Position:  -0.1992059874101249
Bond Position:  [20.47606118]


portfolio before change:  [1.66969219]
curr_Stock_Price:  94.41306973090042
curr_Factors:  [94.41306973]
mat_Sqrt:  [[0.15]]
grads:  [0.05006942]
Stock Position:  0.05006942396976037
Bond Position:  [-3.05751583]


portfolio before change:  [1.69008129]
curr_Stock_Price:  94.82410294389078
curr_Factors:  [94.82410294]
mat_Sqrt:  [[0.15]]
grads:  [-0.29700484]
Stock Position:  -0.2970048421479729
Bond Position:  [29.85329901]


portfolio before change:  [1.5273733]
curr_Stock_Price:  95.37821471082394
curr_Factors:  [95.37821471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00334262]
Stock Position:  -0.0033426222586623268
Bond Position:  [1.84618664]


portfolio before change:  [1.52714382]
curr_Stock_Price:  95.4813885083833
curr_Factors:  [95.48138851]
mat_Sqrt:  [[0.15]]
grads:  [-0.09358498]
Stock Position:  -0.09358498161491911
Bond Position:  [10.4627678]


portfolio before change:  [1.56392391]
curr_Stock_Price:  95.09536345510715
curr_Factors:  [95.09536346]
mat_Sqrt:  [[0.15]]
grads:  [0.34550372]
Stock Position:  0.3455037202321195
Bond Position:  [-31.29187794]


portfolio before change:  [1.74075334]
curr_Stock_Price:  95.6128260015853
curr_Factors:  [95.612826]
mat_Sqrt:  [[0.15]]
grads:  [0.15550389]
Stock Position:  0.1555038947458875
Bond Position:  [-13.12741349]


portfolio before change:  [1.53972566]
curr_Stock_Price:  94.32535221161109
curr_Factors:  [94.32535221]
mat_Sqrt:  [[0.15]]
grads:  [0.02081766]
Stock Position:  0.020817662155839366
Bond Position:  [-0.42390765]


portfolio before change:  [1.54073187]
curr_Stock_Price:  94.37495919234111
curr_Factors:  [94.37495919]
mat_Sqrt:  [[0.15]]
grads:  [0.06914807]
Stock Position:  0.06914806971027657
Bond Position:  [-4.98511439]


portfolio before change:  [1.56334076]
curr_Stock_Price:  94.70642859230989
curr_Factors:  [94.70642859]
mat_Sqrt:  [[0.15]]
grads:  [0.15406901]
Stock Position:  0.15406900942440707
Bond Position:  [-13.02798488]


portfolio before change:  [1.4499383]
curr_Stock_Price:  93.9756639622491
curr_Factors:  [93.97566396]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413133]
Stock Position:  -0.024131330578247037
Bond Position:  [3.71769611]


portfolio before change:  [1.42963931]
curr_Stock_Price:  94.82648143948518
curr_Factors:  [94.82648144]
mat_Sqrt:  [[0.15]]
grads:  [-0.03546648]
Stock Position:  -0.0354664812241145
Bond Position:  [4.79280093]


portfolio before change:  [1.41854611]
curr_Stock_Price:  95.1477073108927
curr_Factors:  [95.14770731]
mat_Sqrt:  [[0.15]]
grads:  [0.10069385]
Stock Position:  0.10069384760717669
Bond Position:  [-8.16224263]


portfolio before change:  [1.40211724]
curr_Stock_Price:  94.98961699409551
curr_Factors:  [94.98961699]
mat_Sqrt:  [[0.15]]
grads:  [0.03825691]
Stock Position:  0.03825690540941051
Bond Position:  [-2.23189156]


portfolio before change:  [1.41213822]
curr_Stock_Price:  95.25520256790888
curr_Factors:  [95.25520257]
mat_Sqrt:  [[0.15]]
grads:  [0.22631682]
Stock Position:  0.2263168197963637
Bond Position:  [-20.14571629]


portfolio before change:  [1.51970912]
curr_Stock_Price:  95.736077324471
curr_Factors:  [95.73607732]
mat_Sqrt:  [[0.15]]
grads:  [0.01425765]
Stock Position:  0.01425764790588283
Bond Position:  [0.15473784]


portfolio before change:  [1.52197716]
curr_Stock_Price:  95.89447424369419
curr_Factors:  [95.89447424]
mat_Sqrt:  [[0.15]]
grads:  [0.01082269]
Stock Position:  0.010822685593419775
Bond Position:  [0.48414141]


portfolio before change:  [1.51135056]
curr_Stock_Price:  94.90979688805315
curr_Factors:  [94.90979689]
mat_Sqrt:  [[0.15]]
grads:  [0.03079443]
Stock Position:  0.030794425149849036
Bond Position:  [-1.41134207]


portfolio before change:  [1.54072968]
curr_Stock_Price:  95.8667013781428
curr_Factors:  [95.86670138]
mat_Sqrt:  [[0.15]]
grads:  [0.02404069]
Stock Position:  0.024040693984305122
Bond Position:  [-0.76397235]


portfolio before change:  [1.54163847]
curr_Stock_Price:  95.90648968607141
curr_Factors:  [95.90648969]
mat_Sqrt:  [[0.15]]
grads:  [0.02047026]
Stock Position:  0.020470261317185382
Bond Position:  [-0.42159244]


portfolio before change:  [1.54128683]
curr_Stock_Price:  95.89059900196932
curr_Factors:  [95.890599]
mat_Sqrt:  [[0.15]]
grads:  [-0.04819695]
Stock Position:  -0.04819695323953875
Bond Position:  [6.16292154]


portfolio before change:  [1.57363438]
curr_Stock_Price:  95.22743773735228
curr_Factors:  [95.22743774]
mat_Sqrt:  [[0.15]]
grads:  [-0.00034104]
Stock Position:  -0.00034103962647161955
Bond Position:  [1.60611071]


portfolio before change:  [1.57351988]
curr_Stock_Price:  95.85751902079849
curr_Factors:  [95.85751902]
mat_Sqrt:  [[0.15]]
grads:  [0.01043431]
Stock Position:  0.010434314428004816
Bond Position:  [0.57331238]


portfolio before change:  [1.58440444]
curr_Stock_Price:  96.89723569691986
curr_Factors:  [96.8972357]
mat_Sqrt:  [[0.15]]
grads:  [-0.08266027]
Stock Position:  -0.08266026734440254
Bond Position:  [9.59395585]


portfolio before change:  [1.70225317]
curr_Stock_Price:  95.47879015813108
curr_Factors:  [95.47879016]
mat_Sqrt:  [[0.15]]
grads:  [-0.07131254]
Stock Position:  -0.0713125359139547
Bond Position:  [8.51108782]


portfolio before change:  [1.66252909]
curr_Stock_Price:  96.04329168545631
curr_Factors:  [96.04329169]
mat_Sqrt:  [[0.15]]
grads:  [0.09545948]
Stock Position:  0.09545947881079135
Bond Position:  [-7.50571347]


portfolio before change:  [1.68357018]
curr_Stock_Price:  96.26862511526566
curr_Factors:  [96.26862512]
mat_Sqrt:  [[0.15]]
grads:  [0.09776942]
Stock Position:  0.09776941550732154
Bond Position:  [-7.72855702]


portfolio before change:  [1.68494371]
curr_Stock_Price:  96.28761439450314
curr_Factors:  [96.28761439]
mat_Sqrt:  [[0.15]]
grads:  [-0.12537022]
Stock Position:  -0.12537021746565816
Bond Position:  [13.75654286]


portfolio before change:  [1.79392974]
curr_Stock_Price:  95.42515899009294
curr_Factors:  [95.42515899]
mat_Sqrt:  [[0.15]]
grads:  [-0.02364715]
Stock Position:  -0.023647146026595005
Bond Position:  [4.05046241]


portfolio before change:  [1.77440146]
curr_Stock_Price:  96.26168445867013
curr_Factors:  [96.26168446]
mat_Sqrt:  [[0.15]]
grads:  [-0.09625336]
Stock Position:  -0.09625336484639038
Bond Position:  [11.03991249]


portfolio before change:  [1.78323447]
curr_Stock_Price:  96.17708489537969
curr_Factors:  [96.1770849]
mat_Sqrt:  [[0.15]]
grads:  [-0.03080758]
Stock Position:  -0.030807575724600175
Bond Position:  [4.74621729]


portfolio before change:  [1.77267531]
curr_Stock_Price:  96.5294595578341
curr_Factors:  [96.52945956]
mat_Sqrt:  [[0.15]]
grads:  [0.0780447]
Stock Position:  0.07804469629697461
Bond Position:  [-5.76093705]


portfolio before change:  [1.75876246]
curr_Stock_Price:  96.35580548124072
curr_Factors:  [96.35580548]
mat_Sqrt:  [[0.15]]
grads:  [-0.0827222]
Stock Position:  -0.08272219891993364
Bond Position:  [9.72952657]


portfolio before change:  [1.78692568]
curr_Stock_Price:  96.02270127597521
curr_Factors:  [96.02270128]
mat_Sqrt:  [[0.15]]
grads:  [0.07118539]
Stock Position:  0.07118539441333095
Bond Position:  [-5.04848818]


portfolio before change:  [1.79702848]
curr_Stock_Price:  96.1690562150065
curr_Factors:  [96.16905622]
mat_Sqrt:  [[0.15]]
grads:  [0.00952145]
Stock Position:  0.009521445654658995
Bond Position:  [0.88136004]


portfolio before change:  [1.79960661]
curr_Stock_Price:  96.4340418757754
curr_Factors:  [96.43404188]
mat_Sqrt:  [[0.15]]
grads:  [0.07886282]
Stock Position:  0.07886281552089264
Bond Position:  [-5.80545344]


portfolio before change:  [1.76206315]
curr_Stock_Price:  95.96258254145742
curr_Factors:  [95.96258254]
mat_Sqrt:  [[0.15]]
grads:  [0.01841785]
Stock Position:  0.018417850081172336
Bond Position:  [-0.00536131]


portfolio before change:  [1.75760221]
curr_Stock_Price:  95.72039312628357
curr_Factors:  [95.72039313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501886]
Stock Position:  -0.005018864036575464
Bond Position:  [2.23800984]


portfolio before change:  [1.75875561]
curr_Stock_Price:  95.51845090113443
curr_Factors:  [95.5184509]
mat_Sqrt:  [[0.15]]
grads:  [0.01800099]
Stock Position:  0.018000990163850202
Bond Position:  [0.03932891]


portfolio before change:  [1.75011321]
curr_Stock_Price:  95.03820788984343
curr_Factors:  [95.03820789]
mat_Sqrt:  [[0.15]]
grads:  [-0.11496023]
Stock Position:  -0.11496022528397792
Bond Position:  [12.675727]


portfolio before change:  [1.75120669]
curr_Stock_Price:  95.0355876734031
curr_Factors:  [95.03558767]
mat_Sqrt:  [[0.15]]
grads:  [0.0337819]
Stock Position:  0.03378189648960964
Bond Position:  [-1.45927569]


portfolio before change:  [1.74282194]
curr_Stock_Price:  94.79008495909802
curr_Factors:  [94.79008496]
mat_Sqrt:  [[0.15]]
grads:  [0.0469805]
Stock Position:  0.046980495857320274
Bond Position:  [-2.71046326]


portfolio before change:  [1.75784825]
curr_Stock_Price:  95.11353237689657
curr_Factors:  [95.11353238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.75784825]
Stock Price:  94.41927748466347
PL:  [1.75784825]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.90842207e-03]
 [-1.03367227e-02]
 [ 3.04332942e-04]
 [ 4.98289268e-03]
 [ 1.48173195e-02]
 [ 2.78613445e-02]
 [ 1.07912779e-03]
 [-1.09240409e-02]
 [ 2.38029659e-02]
 [-4.81018486e-03]
 [ 2.35931050e-02]
 [-3.69371067e-02]
 [ 1.91556093e-02]
 [ 9.91862497e-03]
 [-6.91522941e-03]
 [ 1.66344782e-02]
 [ 7.39502143e-03]
 [-1.18378920e-02]
 [-5.18434528e-04]
 [ 1.14511723e-02]
 [ 1.15532268e-02]
 [-8.17871995e-03]
 [ 7.22252346e-03]
 [ 4.83425084e-02]
 [ 3.10255668e-05]
 [ 1.44885572e-02]
 [-6.67100088e-03]
 [ 6.41680880e-03]
 [ 3.22799532e-03]
 [-2.81117577e-03]
 [ 4.95103057e-03]
 [-1.17203215e-02]
 [ 9.03567096e-03]
 [ 7.02129902e-03]
 [ 1.14580352e-02]
 [ 9.33584490e-03]
 [-3.37304051e-02]
 [ 9.29377926e-03]
 [ 5.37480191e-03]
 [ 1.89901626e-02]
 [-5.53763601e-03]
 [-1.36636904e-02]
 [ 2.34592728e-02]
 [ 3.32388511e-03]
 [-6.30329867e-03]
 [ 7.93123746e-04]
 [ 1.02211156e-02]
 [-1.16573145e-02]
 [-7.30058824e-03]
 [-7.49130149e-03]
 [-7.45426445e-03]
 [-1.41950193e-03]
 [-1.12827327e-03]
 [ 5.29094039e-03]
 [ 4.06900573e-03]
 [-1.30083825e-03]
 [ 8.20891543e-03]
 [-6.74842122e-04]
 [ 1.55834282e-03]
 [ 1.26034637e-03]
 [ 9.00849938e-04]
 [-8.28070350e-03]
 [-5.83043929e-03]
 [-1.67981543e-02]
 [-1.26713003e-02]
 [ 1.14225314e-04]
 [-5.02272976e-03]
 [ 2.40882504e-02]
 [-8.49183757e-03]
 [ 7.29623480e-03]
 [-9.47367940e-03]
 [ 1.07724050e-02]
 [-3.92263477e-03]
 [ 9.03848487e-03]
 [-1.98277322e-02]
 [-5.56621231e-03]
 [-1.55211488e-03]
 [-4.81604516e-04]
 [-2.48635059e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.47721799]
curr_Stock_Price:  99.83621547564326
curr_Factors:  [99.83621548]
mat_Sqrt:  [[0.15]]
grads:  [0.01938948]
Stock Position:  0.019389480445537503
Bond Position:  [-2.41299033]


portfolio before change:  [-0.4895029]
curr_Stock_Price:  99.21040704736667
curr_Factors:  [99.21040705]
mat_Sqrt:  [[0.15]]
grads:  [-0.06891148]
Stock Position:  -0.06891148498326917
Bond Position:  [6.34723357]


portfolio before change:  [-0.5496736]
curr_Stock_Price:  100.08932308173101
curr_Factors:  [100.08932308]
mat_Sqrt:  [[0.15]]
grads:  [0.00202889]
Stock Position:  0.0020288862802088996
Bond Position:  [-0.75274345]


portfolio before change:  [-0.54819425]
curr_Stock_Price:  100.8416562691797
curr_Factors:  [100.84165627]
mat_Sqrt:  [[0.15]]
grads:  [0.03321928]
Stock Position:  0.033219284543251924
Bond Position:  [-3.89808192]


portfolio before change:  [-0.53714514]
curr_Stock_Price:  101.18160188471602
curr_Factors:  [101.18160188]
mat_Sqrt:  [[0.15]]
grads:  [0.09878213]
Stock Position:  0.09878212999193721
Bond Position:  [-10.53207929]


portfolio before change:  [-0.55503573]
curr_Stock_Price:  101.00715412438285
curr_Factors:  [101.00715412]
mat_Sqrt:  [[0.15]]
grads:  [0.1857423]
Stock Position:  0.18574229681476442
Bond Position:  [-19.31633653]


portfolio before change:  [-0.57339094]
curr_Stock_Price:  100.91483321724925
curr_Factors:  [100.91483322]
mat_Sqrt:  [[0.15]]
grads:  [0.00719419]
Stock Position:  0.007194185251587999
Bond Position:  [-1.29939094]


portfolio before change:  [-0.57460461]
curr_Stock_Price:  100.75741987859448
curr_Factors:  [100.75741988]
mat_Sqrt:  [[0.15]]
grads:  [-0.07282694]
Stock Position:  -0.07282693937200299
Bond Position:  [6.7632499]


portfolio before change:  [-0.62413259]
curr_Stock_Price:  101.4433019090627
curr_Factors:  [101.44330191]
mat_Sqrt:  [[0.15]]
grads:  [0.15868644]
Stock Position:  0.15868643949559835
Bond Position:  [-16.72180898]


portfolio before change:  [-0.704066]
curr_Stock_Price:  100.94616888206627
curr_Factors:  [100.94616888]
mat_Sqrt:  [[0.15]]
grads:  [-0.0320679]
Stock Position:  -0.032067899067978266
Bond Position:  [2.53306555]


portfolio before change:  [-0.71808]
curr_Stock_Price:  101.38811610473618
curr_Factors:  [101.3881161]
mat_Sqrt:  [[0.15]]
grads:  [0.15728737]
Stock Position:  0.15728736672972501
Bond Position:  [-16.6651498]


portfolio before change:  [-0.77058752]
curr_Stock_Price:  101.06090661163637
curr_Factors:  [101.06090661]
mat_Sqrt:  [[0.15]]
grads:  [-0.24624738]
Stock Position:  -0.24624737799736665
Bond Position:  [24.11539575]


portfolio before change:  [-0.70238432]
curr_Stock_Price:  100.79005724859428
curr_Factors:  [100.79005725]
mat_Sqrt:  [[0.15]]
grads:  [0.12770406]
Stock Position:  0.1277040619079221
Bond Position:  [-13.57368403]


portfolio before change:  [-0.83427884]
curr_Stock_Price:  99.7638867637833
curr_Factors:  [99.76388676]
mat_Sqrt:  [[0.15]]
grads:  [0.06612417]
Stock Position:  0.06612416644768064
Bond Position:  [-7.43108269]


portfolio before change:  [-0.77826478]
curr_Stock_Price:  100.6180150397234
curr_Factors:  [100.61801504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610153]
Stock Position:  -0.046101529426867266
Bond Position:  [3.8603796]


portfolio before change:  [-0.7773796]
curr_Stock_Price:  100.60404824983283
curr_Factors:  [100.60404825]
mat_Sqrt:  [[0.15]]
grads:  [0.11089652]
Stock Position:  0.11089652102720507
Bond Position:  [-11.93401856]


portfolio before change:  [-0.86733568]
curr_Stock_Price:  99.79960298937716
curr_Factors:  [99.79960299]
mat_Sqrt:  [[0.15]]
grads:  [0.04930014]
Stock Position:  0.04930014288740482
Bond Position:  [-5.78747037]


portfolio before change:  [-0.88099585]
curr_Stock_Price:  99.52985851117539
curr_Factors:  [99.52985851]
mat_Sqrt:  [[0.15]]
grads:  [-0.07891928]
Stock Position:  -0.07891927974923556
Bond Position:  [6.97382889]


portfolio before change:  [-0.89127108]
curr_Stock_Price:  99.66558083237757
curr_Factors:  [99.66558083]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345623]
Stock Position:  -0.003456230188956678
Bond Position:  [-0.54680389]


portfolio before change:  [-0.8929715]
curr_Stock_Price:  100.14767680995448
curr_Factors:  [100.14767681]
mat_Sqrt:  [[0.15]]
grads:  [0.07634115]
Stock Position:  0.07634114834669345
Bond Position:  [-8.53836015]


portfolio before change:  [-0.88986722]
curr_Stock_Price:  100.19533049392223
curr_Factors:  [100.19533049]
mat_Sqrt:  [[0.15]]
grads:  [0.07702151]
Stock Position:  0.07702151229929201
Bond Position:  [-8.6070631]


portfolio before change:  [-0.90428196]
curr_Stock_Price:  100.01516289399575
curr_Factors:  [100.01516289]
mat_Sqrt:  [[0.15]]
grads:  [-0.0545248]
Stock Position:  -0.054524799650980386
Bond Position:  [4.54902476]


portfolio before change:  [-0.88112727]
curr_Stock_Price:  99.59571388456537
curr_Factors:  [99.59571388]
mat_Sqrt:  [[0.15]]
grads:  [0.04815016]
Stock Position:  0.048150156431719736
Bond Position:  [-5.67667647]


portfolio before change:  [-0.8545161]
curr_Stock_Price:  100.15575304634338
curr_Factors:  [100.15575305]
mat_Sqrt:  [[0.15]]
grads:  [0.32228339]
Stock Position:  0.3222833891207313
Bond Position:  [-33.13305163]


portfolio before change:  [-0.71228266]
curr_Stock_Price:  100.60350904500953
curr_Factors:  [100.60350905]
mat_Sqrt:  [[0.15]]
grads:  [0.00020684]
Stock Position:  0.0002068371117286185
Bond Position:  [-0.73309119]


portfolio before change:  [-0.71234017]
curr_Stock_Price:  100.54698504392212
curr_Factors:  [100.54698504]
mat_Sqrt:  [[0.15]]
grads:  [0.09659038]
Stock Position:  0.09659038150621851
Bond Position:  [-10.42421181]


portfolio before change:  [-0.71789803]
curr_Stock_Price:  100.4961897815659
curr_Factors:  [100.49618978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04447334]
Stock Position:  -0.04447333918594236
Bond Position:  [3.7515031]


portfolio before change:  [-0.72208845]
curr_Stock_Price:  100.5956852519032
curr_Factors:  [100.59568525]
mat_Sqrt:  [[0.15]]
grads:  [0.04277873]
Stock Position:  0.04277872534997208
Bond Position:  [-5.02544364]


portfolio before change:  [-0.73307989]
curr_Stock_Price:  100.34609070651103
curr_Factors:  [100.34609071]
mat_Sqrt:  [[0.15]]
grads:  [0.02151997]
Stock Position:  0.021519968830393255
Bond Position:  [-2.89252463]


portfolio before change:  [-0.73854449]
curr_Stock_Price:  100.10055988686418
curr_Factors:  [100.10055989]
mat_Sqrt:  [[0.15]]
grads:  [-0.01874117]
Stock Position:  -0.018741171793601154
Bond Position:  [1.1374573]


portfolio before change:  [-0.74336422]
curr_Stock_Price:  100.36152643915942
curr_Factors:  [100.36152644]
mat_Sqrt:  [[0.15]]
grads:  [0.03300687]
Stock Position:  0.033006870460573934
Bond Position:  [-4.05598412]


portfolio before change:  [-0.7157862]
curr_Stock_Price:  101.20473034491734
curr_Factors:  [101.20473034]
mat_Sqrt:  [[0.15]]
grads:  [-0.07813548]
Stock Position:  -0.0781354765893807
Bond Position:  [7.19189363]


portfolio before change:  [-0.69997857]
curr_Stock_Price:  101.00817268389531
curr_Factors:  [101.00817268]
mat_Sqrt:  [[0.15]]
grads:  [0.06023781]
Stock Position:  0.060237806421797616
Bond Position:  [-6.78448932]


portfolio before change:  [-0.71662707]
curr_Stock_Price:  100.73883263030775
curr_Factors:  [100.73883263]
mat_Sqrt:  [[0.15]]
grads:  [0.04680866]
Stock Position:  0.04680866010880474
Bond Position:  [-5.43207684]


portfolio before change:  [-0.71393288]
curr_Stock_Price:  100.80364346686743
curr_Factors:  [100.80364347]
mat_Sqrt:  [[0.15]]
grads:  [0.0763869]
Stock Position:  0.07638690147208713
Bond Position:  [-8.41401086]


portfolio before change:  [-0.70650169]
curr_Stock_Price:  100.90781154618193
curr_Factors:  [100.90781155]
mat_Sqrt:  [[0.15]]
grads:  [0.06223897]
Stock Position:  0.06223896603325495
Bond Position:  [-6.98689955]


portfolio before change:  [-0.65832841]
curr_Stock_Price:  101.68883306214434
curr_Factors:  [101.68883306]
mat_Sqrt:  [[0.15]]
grads:  [-0.22486937]
Stock Position:  -0.22486936730862575
Bond Position:  [22.20837514]


portfolio before change:  [-0.84337798]
curr_Stock_Price:  102.51792613059395
curr_Factors:  [102.51792613]
mat_Sqrt:  [[0.15]]
grads:  [0.06195853]
Stock Position:  0.061958528390336144
Bond Position:  [-7.19523782]


portfolio before change:  [-0.87294818]
curr_Stock_Price:  102.04792654182303
curr_Factors:  [102.04792654]
mat_Sqrt:  [[0.15]]
grads:  [0.03583201]
Stock Position:  0.035832012756895584
Bond Position:  [-4.52953079]


portfolio before change:  [-0.88772443]
curr_Stock_Price:  101.64345165193069
curr_Factors:  [101.64345165]
mat_Sqrt:  [[0.15]]
grads:  [0.12660108]
Stock Position:  0.1266010837739105
Bond Position:  [-13.75589557]


portfolio before change:  [-0.91271225]
curr_Stock_Price:  101.45286837153388
curr_Factors:  [101.45286837]
mat_Sqrt:  [[0.15]]
grads:  [-0.03691757]
Stock Position:  -0.036917573416319065
Bond Position:  [2.83268146]


portfolio before change:  [-0.87427781]
curr_Stock_Price:  100.41657606401748
curr_Factors:  [100.41657606]
mat_Sqrt:  [[0.15]]
grads:  [-0.09109127]
Stock Position:  -0.09109126922490592
Bond Position:  [8.27279556]


portfolio before change:  [-0.85994086]
curr_Stock_Price:  100.264861421709
curr_Factors:  [100.26486142]
mat_Sqrt:  [[0.15]]
grads:  [0.15639515]
Stock Position:  0.15639515196455533
Bond Position:  [-16.5408791]


portfolio before change:  [-0.82473254]
curr_Stock_Price:  100.49659599783863
curr_Factors:  [100.496596]
mat_Sqrt:  [[0.15]]
grads:  [0.02215923]
Stock Position:  0.02215923404332482
Bond Position:  [-3.05166013]


portfolio before change:  [-0.80525951]
curr_Stock_Price:  101.38398052711419
curr_Factors:  [101.38398053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04202199]
Stock Position:  -0.04202199113336245
Bond Position:  [3.45509722]


portfolio before change:  [-0.79102644]
curr_Stock_Price:  101.05041412600544
curr_Factors:  [101.05041413]
mat_Sqrt:  [[0.15]]
grads:  [0.00528749]
Stock Position:  0.0052874916413526065
Bond Position:  [-1.32532966]


portfolio before change:  [-0.79193164]
curr_Stock_Price:  100.8948834128353
curr_Factors:  [100.89488341]
mat_Sqrt:  [[0.15]]
grads:  [0.06814077]
Stock Position:  0.06814077072202725
Bond Position:  [-7.66698676]


portfolio before change:  [-0.84271611]
curr_Stock_Price:  100.15662830826574
curr_Factors:  [100.15662831]
mat_Sqrt:  [[0.15]]
grads:  [-0.07771543]
Stock Position:  -0.07771542998931888
Bond Position:  [6.94099932]


portfolio before change:  [-0.95188093]
curr_Stock_Price:  101.56688419503385
curr_Factors:  [101.5668842]
mat_Sqrt:  [[0.15]]
grads:  [-0.04867059]
Stock Position:  -0.04867058829432457
Bond Position:  [3.99143908]


portfolio before change:  [-0.96974364]
curr_Stock_Price:  101.93902235641231
curr_Factors:  [101.93902236]
mat_Sqrt:  [[0.15]]
grads:  [-0.04994201]
Stock Position:  -0.04994200996348825
Bond Position:  [4.12129603]


portfolio before change:  [-0.95091004]
curr_Stock_Price:  101.56707078114349
curr_Factors:  [101.56707078]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496951]
Stock Position:  -0.04969509632609966
Bond Position:  [4.09647533]


portfolio before change:  [-0.95809252]
curr_Stock_Price:  101.71675387474173
curr_Factors:  [101.71675387]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946335]
Stock Position:  -0.009463346197218215
Bond Position:  [0.00448834]


portfolio before change:  [-0.9522937]
curr_Stock_Price:  101.10401710282757
curr_Factors:  [101.1040171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00752182]
Stock Position:  -0.007521821793592164
Bond Position:  [-0.1918073]


portfolio before change:  [-0.95076509]
curr_Stock_Price:  100.89920013998649
curr_Factors:  [100.89920014]
mat_Sqrt:  [[0.15]]
grads:  [0.03527294]
Stock Position:  0.035272935961230066
Bond Position:  [-4.50977611]


portfolio before change:  [-0.94098326]
curr_Stock_Price:  101.18450964980336
curr_Factors:  [101.18450965]
mat_Sqrt:  [[0.15]]
grads:  [0.0271267]
Stock Position:  0.027126704862945446
Bond Position:  [-3.68578558]


portfolio before change:  [-0.93980842]
curr_Stock_Price:  101.23631114211268
curr_Factors:  [101.23631114]
mat_Sqrt:  [[0.15]]
grads:  [-0.00867225]
Stock Position:  -0.008672254968456541
Bond Position:  [-0.06186132]


portfolio before change:  [-0.94345227]
curr_Stock_Price:  101.65603827537812
curr_Factors:  [101.65603828]
mat_Sqrt:  [[0.15]]
grads:  [0.0547261]
Stock Position:  0.054726102852532335
Bond Position:  [-6.50669107]


portfolio before change:  [-0.94109505]
curr_Stock_Price:  101.70654256585065
curr_Factors:  [101.70654257]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449895]
Stock Position:  -0.004498947480389148
Bond Position:  [-0.48352265]


portfolio before change:  [-0.93722694]
curr_Stock_Price:  100.84004517037332
curr_Factors:  [100.84004517]
mat_Sqrt:  [[0.15]]
grads:  [0.01038895]
Stock Position:  0.010388952149543653
Bond Position:  [-1.98484934]


portfolio before change:  [-0.94017141]
curr_Stock_Price:  100.56856355050493
curr_Factors:  [100.56856355]
mat_Sqrt:  [[0.15]]
grads:  [0.00840231]
Stock Position:  0.008402309149171071
Bond Position:  [-1.78517957]


portfolio before change:  [-0.94399607]
curr_Stock_Price:  100.12665134478509
curr_Factors:  [100.12665134]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-1.54532332]


portfolio before change:  [-0.94812898]
curr_Stock_Price:  99.45456492085873
curr_Factors:  [99.45456492]
mat_Sqrt:  [[0.15]]
grads:  [-0.05520469]
Stock Position:  -0.05520468996683949
Bond Position:  [4.54222944]


portfolio before change:  [-0.96198992]
curr_Stock_Price:  99.71079028830049
curr_Factors:  [99.71079029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0388696]
Stock Position:  -0.038869595238455075
Bond Position:  [2.91372814]


portfolio before change:  [-0.94717967]
curr_Stock_Price:  99.33445152719739
curr_Factors:  [99.33445153]
mat_Sqrt:  [[0.15]]
grads:  [-0.1119877]
Stock Position:  -0.11198769537758722
Bond Position:  [10.17705662]


portfolio before change:  [-0.85708984]
curr_Stock_Price:  98.53566958935106
curr_Factors:  [98.53566959]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447534]
Stock Position:  -0.08447533532430876
Bond Position:  [7.46674389]


portfolio before change:  [-0.92392951]
curr_Stock_Price:  99.33242704197133
curr_Factors:  [99.33242704]
mat_Sqrt:  [[0.15]]
grads:  [0.0007615]
Stock Position:  0.0007615020964978533
Bond Position:  [-0.99957136]


portfolio before change:  [-0.92417055]
curr_Stock_Price:  99.09792602259147
curr_Factors:  [99.09792602]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348487]
Stock Position:  -0.03348486507168532
Bond Position:  [2.39411013]


portfolio before change:  [-0.94388237]
curr_Stock_Price:  99.69107320860488
curr_Factors:  [99.69107321]
mat_Sqrt:  [[0.15]]
grads:  [0.16058834]
Stock Position:  0.1605883358454088
Bond Position:  [-16.95310592]


portfolio before change:  [-0.87642794]
curr_Stock_Price:  100.11771713450962
curr_Factors:  [100.11771713]
mat_Sqrt:  [[0.15]]
grads:  [-0.05661225]
Stock Position:  -0.05661225044345774
Bond Position:  [4.79146134]


portfolio before change:  [-0.87621723]
curr_Stock_Price:  100.11928522890027
curr_Factors:  [100.11928523]
mat_Sqrt:  [[0.15]]
grads:  [0.04864157]
Stock Position:  0.04864156536647581
Bond Position:  [-5.74617599]


portfolio before change:  [-0.89633699]
curr_Stock_Price:  99.71303579259612
curr_Factors:  [99.71303579]
mat_Sqrt:  [[0.15]]
grads:  [-0.06315786]
Stock Position:  -0.0631578626781538
Bond Position:  [5.40132523]


portfolio before change:  [-0.85997974]
curr_Stock_Price:  99.14272435554993
curr_Factors:  [99.14272436]
mat_Sqrt:  [[0.15]]
grads:  [0.07181603]
Stock Position:  0.07181603364978852
Bond Position:  [-7.98001697]


portfolio before change:  [-0.89341775]
curr_Stock_Price:  98.68406299966193
curr_Factors:  [98.684063]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261509]
Stock Position:  -0.02615089847309118
Bond Position:  [1.68725916]


portfolio before change:  [-0.90232008]
curr_Stock_Price:  99.02851719043412
curr_Factors:  [99.02851719]
mat_Sqrt:  [[0.15]]
grads:  [0.06025657]
Stock Position:  0.06025656580147706
Bond Position:  [-6.86943844]


portfolio before change:  [-0.87526946]
curr_Stock_Price:  99.48456670554599
curr_Factors:  [99.48456671]
mat_Sqrt:  [[0.15]]
grads:  [-0.13218488]
Stock Position:  -0.13218488160450523
Bond Position:  [12.27508622]


portfolio before change:  [-0.79190921]
curr_Stock_Price:  98.85973708334457
curr_Factors:  [98.85973708]
mat_Sqrt:  [[0.15]]
grads:  [-0.03710808]
Stock Position:  -0.03710808203784013
Bond Position:  [2.87658602]


portfolio before change:  [-0.79045954]
curr_Stock_Price:  98.82551613263549
curr_Factors:  [98.82551613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034743]
Stock Position:  -0.010347432521495333
Bond Position:  [0.23213082]


portfolio before change:  [-0.79201586]
curr_Stock_Price:  98.97732432967692
curr_Factors:  [98.97732433]
mat_Sqrt:  [[0.15]]
grads:  [-0.0032107]
Stock Position:  -0.00321069677383269
Bond Position:  [-0.47422968]


portfolio before change:  [-0.79335926]
curr_Stock_Price:  99.38650547235353
curr_Factors:  [99.38650547]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79335926]
Stock Price:  98.78372880182992
PL:  [-0.79335926]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.32625308e-04]
 [ 2.07301964e-03]
 [-3.54192844e-04]
 [ 7.12861768e-03]
 [ 5.05306426e-03]
 [ 2.83113417e-02]
 [ 1.10564259e-03]
 [-8.65426614e-03]
 [ 2.35019317e-02]
 [-3.62987236e-03]
 [ 1.40449281e-02]
 [-1.77607094e-02]
 [ 4.51867081e-04]
 [ 1.11684826e-03]
 [-6.91388290e-03]
 [ 1.49024224e-02]
 [ 1.05610281e-02]
 [-1.15392010e-02]
 [-2.23578506e-05]
 [-4.50524839e-03]
 [ 1.23361449e-02]
 [-4.61707704e-03]
 [ 1.10889141e-02]
 [-2.49720673e-02]
 [ 5.88989328e-03]
 [ 7.04907097e-03]
 [-5.07994549e-03]
 [ 1.34607272e-02]
 [ 4.67107539e-02]
 [ 5.12829213e-03]
 [ 1.88167852e-02]
 [ 4.94871268e-03]
 [-4.33027611e-03]
 [ 7.23852057e-03]
 [ 9.71381442e-03]
 [ 5.53619703e-03]
 [-3.19460769e-02]
 [ 8.72121536e-03]
 [ 1.56182228e-02]
 [ 9.58753510e-04]
 [-6.75437136e-03]
 [-1.15544246e-02]
 [ 1.95397599e-02]
 [-7.46206501e-03]
 [ 2.86516470e-02]
 [ 1.95417021e-03]
 [ 1.56750201e-02]
 [ 3.83546501e-02]
 [ 1.52322960e-02]
 [-7.97428725e-03]
 [ 9.56639437e-02]
 [ 2.24511347e-02]
 [-1.22570171e-02]
 [ 5.57373546e-03]
 [-3.55069679e-02]
 [ 4.88489725e-02]
 [ 2.21108647e-02]
 [ 3.17721068e-03]
 [ 2.17256252e-03]
 [-1.01696092e-02]
 [ 2.93576879e-02]
 [ 6.27864436e-02]
 [-1.11670336e-02]
 [-1.10919093e-02]
 [ 2.10324224e-02]
 [ 1.13091299e-02]
 [-4.05830740e-03]
 [ 1.58966853e-02]
 [-2.56480446e-02]
 [-6.10639209e-02]
 [ 1.05893511e-04]
 [ 1.68911927e-02]
 [-3.34235431e-02]
 [ 2.87118311e-02]
 [-2.90180769e-02]
 [ 5.95041288e-03]
 [ 8.75509856e-03]
 [-1.73218323e-02]
 [ 2.00978692e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.68933882]
curr_Stock_Price:  100.56232037318414
curr_Factors:  [100.56232037]
mat_Sqrt:  [[0.15]]
grads:  [-0.0022175]
Stock Position:  -0.0022175020555752906
Bond Position:  [10.91233598]


portfolio before change:  [10.68983241]
curr_Stock_Price:  100.6473053717647
curr_Factors:  [100.64730537]
mat_Sqrt:  [[0.15]]
grads:  [0.01382013]
Stock Position:  0.013820130915214592
Bond Position:  [9.29887347]


portfolio before change:  [10.68444895]
curr_Stock_Price:  100.21571295734483
curr_Factors:  [100.21571296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236129]
Stock Position:  -0.0023612856239144226
Bond Position:  [10.92108687]


portfolio before change:  [10.68499475]
curr_Stock_Price:  100.27363913916034
curr_Factors:  [100.27363914]
mat_Sqrt:  [[0.15]]
grads:  [0.04752412]
Stock Position:  0.04752411786545483
Bond Position:  [5.91957851]


portfolio before change:  [10.67416588]
curr_Stock_Price:  100.03799325167316
curr_Factors:  [100.03799325]
mat_Sqrt:  [[0.15]]
grads:  [0.0336871]
Stock Position:  0.03368709507375982
Bond Position:  [7.30417649]


portfolio before change:  [10.70215101]
curr_Stock_Price:  100.85517888815734
curr_Factors:  [100.85517889]
mat_Sqrt:  [[0.15]]
grads:  [0.18874228]
Stock Position:  0.18874227832087948
Bond Position:  [-8.33348523]


portfolio before change:  [10.71776605]
curr_Stock_Price:  100.94067059170835
curr_Factors:  [100.94067059]
mat_Sqrt:  [[0.15]]
grads:  [0.00737095]
Stock Position:  0.007370950630800666
Bond Position:  [9.97373735]


portfolio before change:  [10.71847644]
curr_Stock_Price:  100.95247521201513
curr_Factors:  [100.95247521]
mat_Sqrt:  [[0.15]]
grads:  [-0.05769511]
Stock Position:  -0.057695107595087856
Bond Position:  [16.54294036]


portfolio before change:  [10.69510075]
curr_Stock_Price:  101.37555546635063
curr_Factors:  [101.37555547]
mat_Sqrt:  [[0.15]]
grads:  [0.15667954]
Stock Position:  0.1566795448610978
Bond Position:  [-5.18837514]


portfolio before change:  [10.49274612]
curr_Stock_Price:  100.08610609306366
curr_Factors:  [100.08610609]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419915]
Stock Position:  -0.02419914906797144
Bond Position:  [12.91474472]


portfolio before change:  [10.4897986]
curr_Stock_Price:  100.24126516876028
curr_Factors:  [100.24126517]
mat_Sqrt:  [[0.15]]
grads:  [0.09363285]
Stock Position:  0.09363285412617038
Bond Position:  [1.10392284]


portfolio before change:  [10.51265839]
curr_Stock_Price:  100.48467113839637
curr_Factors:  [100.48467114]
mat_Sqrt:  [[0.15]]
grads:  [-0.11840473]
Stock Position:  -0.11840472925143668
Bond Position:  [22.41051867]


portfolio before change:  [10.57601926]
curr_Stock_Price:  99.96137986602635
curr_Factors:  [99.96137987]
mat_Sqrt:  [[0.15]]
grads:  [0.00301245]
Stock Position:  0.0030124472077643536
Bond Position:  [10.27489088]


portfolio before change:  [10.57824507]
curr_Stock_Price:  100.48706813030485
curr_Factors:  [100.48706813]
mat_Sqrt:  [[0.15]]
grads:  [0.00744566]
Stock Position:  0.007445655078423246
Bond Position:  [9.83005302]


portfolio before change:  [10.57288675]
curr_Stock_Price:  99.68489400924814
curr_Factors:  [99.68489401]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609255]
Stock Position:  -0.04609255264214792
Bond Position:  [15.16761798]


portfolio before change:  [10.53889775]
curr_Stock_Price:  100.4428690332272
curr_Factors:  [100.44286903]
mat_Sqrt:  [[0.15]]
grads:  [0.09934948]
Stock Position:  0.0993494826466723
Bond Position:  [0.55995068]


portfolio before change:  [10.59766607]
curr_Stock_Price:  101.03404791934541
curr_Factors:  [101.03404792]
mat_Sqrt:  [[0.15]]
grads:  [0.07040685]
Stock Position:  0.07040685381159607
Bond Position:  [3.48417663]


portfolio before change:  [10.60153236]
curr_Stock_Price:  101.08586844597706
curr_Factors:  [101.08586845]
mat_Sqrt:  [[0.15]]
grads:  [-0.07692801]
Stock Position:  -0.07692800661895069
Bond Position:  [18.37786671]


portfolio before change:  [10.58604255]
curr_Stock_Price:  101.30215456914478
curr_Factors:  [101.30215457]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014905]
Stock Position:  -0.00014905233704592957
Bond Position:  [10.60114187]


portfolio before change:  [10.58669827]
curr_Stock_Price:  101.34823436857278
curr_Factors:  [101.34823437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03003499]
Stock Position:  -0.030034989260244692
Bond Position:  [13.6306914]


portfolio before change:  [10.59716349]
curr_Stock_Price:  101.0281650696155
curr_Factors:  [101.02816507]
mat_Sqrt:  [[0.15]]
grads:  [0.08224097]
Stock Position:  0.08224096575398915
Bond Position:  [2.28850963]


portfolio before change:  [10.67573017]
curr_Stock_Price:  101.98174871186941
curr_Factors:  [101.98174871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03078051]
Stock Position:  -0.030780513585458292
Bond Position:  [13.81478077]


portfolio before change:  [10.66317158]
curr_Stock_Price:  102.41780529452708
curr_Factors:  [102.41780529]
mat_Sqrt:  [[0.15]]
grads:  [0.07392609]
Stock Position:  0.07392609403710566
Bond Position:  [3.09182327]


portfolio before change:  [10.70414867]
curr_Stock_Price:  102.96948939919363
curr_Factors:  [102.9694894]
mat_Sqrt:  [[0.15]]
grads:  [-0.16648045]
Stock Position:  -0.16648044881095855
Bond Position:  [27.84655548]


portfolio before change:  [10.68402826]
curr_Stock_Price:  103.10080135497073
curr_Factors:  [103.10080135]
mat_Sqrt:  [[0.15]]
grads:  [0.03926596]
Stock Position:  0.03926595517209623
Bond Position:  [6.63567682]


portfolio before change:  [10.69513164]
curr_Stock_Price:  103.37301270864471
curr_Factors:  [103.37301271]
mat_Sqrt:  [[0.15]]
grads:  [0.04699381]
Stock Position:  0.04699380645434058
Bond Position:  [5.83724029]


portfolio before change:  [10.69278296]
curr_Stock_Price:  103.31527059913196
curr_Factors:  [103.3152706]
mat_Sqrt:  [[0.15]]
grads:  [-0.0338663]
Stock Position:  -0.03386630326638992
Bond Position:  [14.19168925]


portfolio before change:  [10.69365844]
curr_Stock_Price:  103.31561114262978
curr_Factors:  [103.31561114]
mat_Sqrt:  [[0.15]]
grads:  [0.08973818]
Stock Position:  0.08973818166015837
Bond Position:  [1.42230336]


portfolio before change:  [10.69849483]
curr_Stock_Price:  103.36851498558639
curr_Factors:  [103.36851499]
mat_Sqrt:  [[0.15]]
grads:  [0.31140503]
Stock Position:  0.31140502590299435
Bond Position:  [-21.49098026]


portfolio before change:  [10.85249175]
curr_Stock_Price:  103.8673513382518
curr_Factors:  [103.86735134]
mat_Sqrt:  [[0.15]]
grads:  [0.03418861]
Stock Position:  0.03418861419004792
Bond Position:  [7.30141095]


portfolio before change:  [10.85160114]
curr_Stock_Price:  103.82795351087584
curr_Factors:  [103.82795351]
mat_Sqrt:  [[0.15]]
grads:  [0.12544523]
Stock Position:  0.12544523443365832
Bond Position:  [-2.17312083]


portfolio before change:  [11.00659967]
curr_Stock_Price:  105.06462343948417
curr_Factors:  [105.06462344]
mat_Sqrt:  [[0.15]]
grads:  [0.03299142]
Stock Position:  0.03299141786498918
Bond Position:  [7.54036877]


portfolio before change:  [11.02114998]
curr_Stock_Price:  105.49137138034453
curr_Factors:  [105.49137138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02886851]
Stock Position:  -0.028868507385523153
Bond Position:  [14.06652841]


portfolio before change:  [11.02530337]
curr_Stock_Price:  105.37795339034189
curr_Factors:  [105.37795339]
mat_Sqrt:  [[0.15]]
grads:  [0.0482568]
Stock Position:  0.04825680377898989
Bond Position:  [5.94010015]


portfolio before change:  [11.01275053]
curr_Stock_Price:  105.1101339380754
curr_Factors:  [105.11013394]
mat_Sqrt:  [[0.15]]
grads:  [0.06475876]
Stock Position:  0.06475876282734384
Bond Position:  [4.20594829]


portfolio before change:  [11.00425156]
curr_Stock_Price:  104.97483417024833
curr_Factors:  [104.97483417]
mat_Sqrt:  [[0.15]]
grads:  [0.03690798]
Stock Position:  0.036907980201710544
Bond Position:  [7.12984246]


portfolio before change:  [11.012436]
curr_Stock_Price:  105.18451276449171
curr_Factors:  [105.18451276]
mat_Sqrt:  [[0.15]]
grads:  [-0.21297385]
Stock Position:  -0.21297384594144275
Bond Position:  [33.41398622]


portfolio before change:  [11.1311489]
curr_Stock_Price:  104.63691286059611
curr_Factors:  [104.63691286]
mat_Sqrt:  [[0.15]]
grads:  [0.05814144]
Stock Position:  0.05814143572659238
Bond Position:  [5.04740856]


portfolio before change:  [11.14688554]
curr_Stock_Price:  104.90214824587784
curr_Factors:  [104.90214825]
mat_Sqrt:  [[0.15]]
grads:  [0.10412149]
Stock Position:  0.10412148503328922
Bond Position:  [0.22431808]


portfolio before change:  [11.1210799]
curr_Stock_Price:  104.65417196640807
curr_Factors:  [104.65417197]
mat_Sqrt:  [[0.15]]
grads:  [0.00639169]
Stock Position:  0.006391690067013729
Bond Position:  [10.45216287]


portfolio before change:  [11.13027694]
curr_Stock_Price:  105.9908701280382
curr_Factors:  [105.99087013]
mat_Sqrt:  [[0.15]]
grads:  [-0.04502914]
Stock Position:  -0.04502914242727537
Bond Position:  [15.90295493]


portfolio before change:  [11.10556208]
curr_Stock_Price:  106.56180760051085
curr_Factors:  [106.5618076]
mat_Sqrt:  [[0.15]]
grads:  [-0.0770295]
Stock Position:  -0.07702949705194188
Bond Position:  [19.31396453]


portfolio before change:  [11.05444638]
curr_Stock_Price:  107.24106503762565
curr_Factors:  [107.24106504]
mat_Sqrt:  [[0.15]]
grads:  [0.13026507]
Stock Position:  0.13026506624544365
Bond Position:  [-2.91531806]


portfolio before change:  [10.97658522]
curr_Stock_Price:  106.64475047552631
curr_Factors:  [106.64475048]
mat_Sqrt:  [[0.15]]
grads:  [-0.0497471]
Stock Position:  -0.04974710004602454
Bond Position:  [16.28185229]


portfolio before change:  [10.92270323]
curr_Stock_Price:  107.74832506044471
curr_Factors:  [107.74832506]
mat_Sqrt:  [[0.15]]
grads:  [0.19101098]
Stock Position:  0.19101097993435942
Bond Position:  [-9.65840993]


portfolio before change:  [11.06033422]
curr_Stock_Price:  108.4720251204419
curr_Factors:  [108.47202512]
mat_Sqrt:  [[0.15]]
grads:  [0.0130278]
Stock Position:  0.013027801409300765
Bond Position:  [9.64718221]


portfolio before change:  [11.0539306]
curr_Stock_Price:  107.93420727768425
curr_Factors:  [107.93420728]
mat_Sqrt:  [[0.15]]
grads:  [0.10450013]
Stock Position:  0.10450013388023717
Bond Position:  [-0.22520851]


portfolio before change:  [11.1082889]
curr_Stock_Price:  108.45451640384613
curr_Factors:  [108.4545164]
mat_Sqrt:  [[0.15]]
grads:  [0.25569767]
Stock Position:  0.2556976672804299
Bond Position:  [-16.62327795]


portfolio before change:  [11.18009711]
curr_Stock_Price:  108.73941225252686
curr_Factors:  [108.73941225]
mat_Sqrt:  [[0.15]]
grads:  [0.10154864]
Stock Position:  0.10154863996784047
Bond Position:  [0.13775769]


portfolio before change:  [11.16724196]
curr_Stock_Price:  108.61273638976914
curr_Factors:  [108.61273639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05316191]
Stock Position:  -0.05316191498548024
Bond Position:  [16.94130302]


portfolio before change:  [11.12476702]
curr_Stock_Price:  109.43162725328354
curr_Factors:  [109.43162725]
mat_Sqrt:  [[0.15]]
grads:  [0.63775962]
Stock Position:  0.6377596245508637
Bond Position:  [-58.66630649]


portfolio before change:  [11.17547025]
curr_Stock_Price:  109.51687879068392
curr_Factors:  [109.51687879]
mat_Sqrt:  [[0.15]]
grads:  [0.14967423]
Stock Position:  0.14967423142307165
Bond Position:  [-5.21638441]


portfolio before change:  [11.16272717]
curr_Stock_Price:  109.43391834838445
curr_Factors:  [109.43391835]
mat_Sqrt:  [[0.15]]
grads:  [-0.08171345]
Stock Position:  -0.08171344746754483
Bond Position:  [20.10494991]


portfolio before change:  [11.12881774]
curr_Stock_Price:  109.86427631083609
curr_Factors:  [109.86427631]
mat_Sqrt:  [[0.15]]
grads:  [0.03715824]
Stock Position:  0.03715823638784559
Bond Position:  [7.04645499]


portfolio before change:  [11.15108576]
curr_Stock_Price:  110.45169920800451
curr_Factors:  [110.45169921]
mat_Sqrt:  [[0.15]]
grads:  [-0.23671312]
Stock Position:  -0.2367131194620662
Bond Position:  [37.29645203]


portfolio before change:  [11.35705809]
curr_Stock_Price:  109.59141215066808
curr_Factors:  [109.59141215]
mat_Sqrt:  [[0.15]]
grads:  [0.32565982]
Stock Position:  0.3256598165341408
Bond Position:  [-24.33246108]


portfolio before change:  [11.30103714]
curr_Stock_Price:  109.42405920845843
curr_Factors:  [109.42405921]
mat_Sqrt:  [[0.15]]
grads:  [0.14740576]
Stock Position:  0.14740576450357648
Bond Position:  [-4.82869997]


portfolio before change:  [11.32236066]
curr_Stock_Price:  109.5707653050447
curr_Factors:  [109.57076531]
mat_Sqrt:  [[0.15]]
grads:  [0.0211814]
Stock Position:  0.021181404526277002
Bond Position:  [9.00149795]


portfolio before change:  [11.31116561]
curr_Stock_Price:  109.01567202151368
curr_Factors:  [109.01567202]
mat_Sqrt:  [[0.15]]
grads:  [0.01448375]
Stock Position:  0.0144837501576207
Bond Position:  [9.73220986]


portfolio before change:  [11.32008515]
curr_Stock_Price:  109.58950491357061
curr_Factors:  [109.58950491]
mat_Sqrt:  [[0.15]]
grads:  [-0.06779739]
Stock Position:  -0.06779739459099952
Bond Position:  [18.74996806]


portfolio before change:  [11.29711983]
curr_Stock_Price:  109.94552496331127
curr_Factors:  [109.94552496]
mat_Sqrt:  [[0.15]]
grads:  [0.19571792]
Stock Position:  0.19571791956293266
Bond Position:  [-10.22118959]


portfolio before change:  [11.32792752]
curr_Stock_Price:  110.1061977427404
curr_Factors:  [110.10619774]
mat_Sqrt:  [[0.15]]
grads:  [0.41857629]
Stock Position:  0.4185762906886578
Bond Position:  [-34.75991631]


portfolio before change:  [11.4052354]
curr_Stock_Price:  110.29608055584099
curr_Factors:  [110.29608056]
mat_Sqrt:  [[0.15]]
grads:  [-0.07444689]
Stock Position:  -0.07444689080169263
Bond Position:  [19.61643567]


portfolio before change:  [11.40082312]
curr_Stock_Price:  110.37181713080116
curr_Factors:  [110.37181713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07394606]
Stock Position:  -0.07394606197718502
Bond Position:  [19.56238435]


portfolio before change:  [11.47141926]
curr_Stock_Price:  109.43365422363543
curr_Factors:  [109.43365422]
mat_Sqrt:  [[0.15]]
grads:  [0.14021615]
Stock Position:  0.14021614929175527
Bond Position:  [-3.87294634]


portfolio before change:  [11.49517963]
curr_Stock_Price:  109.60483595352257
curr_Factors:  [109.60483595]
mat_Sqrt:  [[0.15]]
grads:  [0.0753942]
Stock Position:  0.07539419940449632
Bond Position:  [3.23161078]


portfolio before change:  [11.50603124]
curr_Stock_Price:  109.74608849553051
curr_Factors:  [109.7460885]
mat_Sqrt:  [[0.15]]
grads:  [-0.02705538]
Stock Position:  -0.02705538264500401
Bond Position:  [14.47525366]


portfolio before change:  [11.52578779]
curr_Stock_Price:  109.04930197835645
curr_Factors:  [109.04930198]
mat_Sqrt:  [[0.15]]
grads:  [0.1059779]
Stock Position:  0.10597790222453746
Bond Position:  [-0.03102847]


portfolio before change:  [11.52986352]
curr_Stock_Price:  109.08777855002272
curr_Factors:  [109.08777855]
mat_Sqrt:  [[0.15]]
grads:  [-0.17098696]
Stock Position:  -0.17098696381406345
Bond Position:  [30.18245157]


portfolio before change:  [11.4368493]
curr_Stock_Price:  109.64279563089056
curr_Factors:  [109.64279563]
mat_Sqrt:  [[0.15]]
grads:  [-0.40709281]
Stock Position:  -0.40709280621196836
Bond Position:  [56.07164265]


portfolio before change:  [11.63568002]
curr_Stock_Price:  109.16298825211526
curr_Factors:  [109.16298825]
mat_Sqrt:  [[0.15]]
grads:  [0.00070596]
Stock Position:  0.0007059567386868855
Bond Position:  [11.55861567]


portfolio before change:  [11.63608494]
curr_Stock_Price:  108.71322426319036
curr_Factors:  [108.71322426]
mat_Sqrt:  [[0.15]]
grads:  [0.11260795]
Stock Position:  0.11260795165047621
Bond Position:  [-0.60588856]


portfolio before change:  [11.56820745]
curr_Stock_Price:  108.1107834552825
curr_Factors:  [108.11078346]
mat_Sqrt:  [[0.15]]
grads:  [-0.22282362]
Stock Position:  -0.22282362078375123
Bond Position:  [35.65784366]


portfolio before change:  [11.57118159]
curr_Stock_Price:  108.10743794866264
curr_Factors:  [108.10743795]
mat_Sqrt:  [[0.15]]
grads:  [0.19141221]
Stock Position:  0.19141220726286662
Bond Position:  [-9.12190173]


portfolio before change:  [11.39553094]
curr_Stock_Price:  107.19276008474473
curr_Factors:  [107.19276008]
mat_Sqrt:  [[0.15]]
grads:  [-0.19345385]
Stock Position:  -0.19345384575546407
Bond Position:  [32.13238262]


portfolio before change:  [11.30696087]
curr_Stock_Price:  107.66097724559
curr_Factors:  [107.66097725]
mat_Sqrt:  [[0.15]]
grads:  [0.03966942]
Stock Position:  0.039669419169272004
Bond Position:  [7.03611243]


portfolio before change:  [11.31670259]
curr_Stock_Price:  107.89546390671605
curr_Factors:  [107.89546391]
mat_Sqrt:  [[0.15]]
grads:  [0.05836732]
Stock Position:  0.058367323743709704
Bond Position:  [5.01913312]


portfolio before change:  [11.32124633]
curr_Stock_Price:  107.96793656068324
curr_Factors:  [107.96793656]
mat_Sqrt:  [[0.15]]
grads:  [-0.11547888]
Stock Position:  -0.11547888178460516
Bond Position:  [23.78926291]


portfolio before change:  [11.28891649]
curr_Stock_Price:  108.26077547681614
curr_Factors:  [108.26077548]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.28891649]
Stock Price:  107.93873541282231
PL:  [3.35018108]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.38198106e-04]
 [ 1.94474818e-03]
 [-4.57236955e-03]
 [ 2.54727825e-03]
 [ 3.60961737e-02]
 [ 2.71966069e-02]
 [ 3.36237016e-03]
 [ 6.81267296e-04]
 [ 2.31857307e-02]
 [-4.80318749e-03]
 [ 1.58612512e-02]
 [-3.26540709e-02]
 [ 5.26060430e-04]
 [ 5.80935213e-03]
 [-6.95163292e-03]
 [ 6.75258488e-03]
 [ 7.33475279e-03]
 [-8.89837183e-03]
 [ 9.77504542e-04]
 [ 1.50228733e-02]
 [ 1.15158283e-02]
 [-8.11080115e-03]
 [ 8.04593264e-03]
 [ 4.46562926e-02]
 [-9.15483965e-04]
 [ 1.40182517e-02]
 [-7.06263563e-03]
 [ 7.46657090e-03]
 [ 1.10877037e-02]
 [-2.44518678e-03]
 [ 7.19229171e-03]
 [-1.20287162e-02]
 [ 7.77911192e-03]
 [ 7.49588896e-03]
 [ 1.14921276e-02]
 [ 1.34083793e-02]
 [-3.51953044e-02]
 [ 9.53788353e-03]
 [-1.41507087e-02]
 [ 2.45041049e-02]
 [-4.92946044e-03]
 [ 1.41346351e-03]
 [ 2.32382757e-02]
 [ 4.01470680e-03]
 [-8.17779332e-03]
 [-4.79032403e-03]
 [ 5.21087858e-03]
 [-1.01602752e-02]
 [-1.46940425e-02]
 [-7.29077764e-03]
 [ 1.51658453e-02]
 [-3.02988741e-03]
 [-4.40095153e-03]
 [ 5.40912555e-03]
 [ 1.19442076e-03]
 [ 4.90297523e-03]
 [ 9.12196624e-03]
 [-9.44888094e-05]
 [ 1.69088314e-03]
 [ 1.59985529e-02]
 [-2.57125945e-03]
 [ 5.04638900e-03]
 [-2.35420275e-03]
 [-1.23432901e-02]
 [ 8.11801765e-04]
 [ 1.23646640e-03]
 [-5.43064948e-03]
 [ 1.50381530e-02]
 [-8.27944219e-03]
 [ 1.06992291e-02]
 [-1.16759108e-02]
 [ 1.16410718e-02]
 [-5.59584216e-04]
 [ 1.82619251e-02]
 [-2.24832138e-02]
 [-1.09307051e-03]
 [-9.51121744e-03]
 [-5.29014216e-03]
 [ 3.05335058e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.19979707]
curr_Stock_Price:  100.46546298209944
curr_Factors:  [100.46546298]
mat_Sqrt:  [[0.15]]
grads:  [-0.00225465]
Stock Position:  -0.002254654041051304
Bond Position:  [9.42631193]


portfolio before change:  [9.19984862]
curr_Stock_Price:  100.7039095550259
curr_Factors:  [100.70390956]
mat_Sqrt:  [[0.15]]
grads:  [0.01296499]
Stock Position:  0.012964987833764513
Bond Position:  [7.89422366]


portfolio before change:  [9.20627782]
curr_Stock_Price:  101.16174190644537
curr_Factors:  [101.16174191]
mat_Sqrt:  [[0.15]]
grads:  [-0.03048246]
Stock Position:  -0.030482463639330805
Bond Position:  [12.28993694]


portfolio before change:  [9.19973466]
curr_Stock_Price:  101.40159456373055
curr_Factors:  [101.40159456]
mat_Sqrt:  [[0.15]]
grads:  [0.01698185]
Stock Position:  0.016981854984001832
Bond Position:  [7.47774749]


portfolio before change:  [9.21580063]
curr_Stock_Price:  102.3201394469888
curr_Factors:  [102.32013945]
mat_Sqrt:  [[0.15]]
grads:  [0.24064116]
Stock Position:  0.24064115784333495
Bond Position:  [-15.4066362]


portfolio before change:  [9.05527176]
curr_Stock_Price:  101.65705285981137
curr_Factors:  [101.65705286]
mat_Sqrt:  [[0.15]]
grads:  [0.18131071]
Stock Position:  0.18131071278572955
Bond Position:  [-9.37624095]


portfolio before change:  [9.12124468]
curr_Stock_Price:  102.02415166992999
curr_Factors:  [102.02415167]
mat_Sqrt:  [[0.15]]
grads:  [0.0224158]
Stock Position:  0.022415801095371904
Bond Position:  [6.83429159]


portfolio before change:  [9.1073261]
curr_Stock_Price:  101.3841686797448
curr_Factors:  [101.38416868]
mat_Sqrt:  [[0.15]]
grads:  [0.00454178]
Stock Position:  0.004541781972489714
Bond Position:  [8.64686131]


portfolio before change:  [9.10750424]
curr_Stock_Price:  101.30439580453447
curr_Factors:  [101.3043958]
mat_Sqrt:  [[0.15]]
grads:  [0.15457154]
Stock Position:  0.1545715383330103
Bond Position:  [-6.55127206]


portfolio before change:  [9.05106789]
curr_Stock_Price:  100.94193010310045
curr_Factors:  [100.9419301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03202125]
Stock Position:  -0.03202124991178429
Bond Position:  [12.28335466]


portfolio before change:  [9.05332273]
curr_Stock_Price:  100.89548894126652
curr_Factors:  [100.89548894]
mat_Sqrt:  [[0.15]]
grads:  [0.10574167]
Stock Position:  0.10574167487386786
Bond Position:  [-1.61553526]


portfolio before change:  [9.06141425]
curr_Stock_Price:  100.97296546712037
curr_Factors:  [100.97296547]
mat_Sqrt:  [[0.15]]
grads:  [-0.21769381]
Stock Position:  -0.2176938061836503
Bond Position:  [31.04260342]


portfolio before change:  [9.27099888]
curr_Stock_Price:  100.01912847107447
curr_Factors:  [100.01912847]
mat_Sqrt:  [[0.15]]
grads:  [0.00350707]
Stock Position:  0.003507069533517093
Bond Position:  [8.92022484]


portfolio before change:  [9.265642]
curr_Stock_Price:  98.33270346903574
curr_Factors:  [98.33270347]
mat_Sqrt:  [[0.15]]
grads:  [0.03872901]
Stock Position:  0.03872901422218988
Bond Position:  [5.45731333]


portfolio before change:  [9.28947925]
curr_Stock_Price:  98.93938449243358
curr_Factors:  [98.93938449]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634422]
Stock Position:  -0.04634421944058162
Bond Position:  [13.8747478]


portfolio before change:  [9.28854401]
curr_Stock_Price:  98.9782770367685
curr_Factors:  [98.97827704]
mat_Sqrt:  [[0.15]]
grads:  [0.04501723]
Stock Position:  0.045017232512550694
Bond Position:  [4.83281589]


portfolio before change:  [9.27672442]
curr_Stock_Price:  98.70901015647999
curr_Factors:  [98.70901016]
mat_Sqrt:  [[0.15]]
grads:  [0.04889835]
Stock Position:  0.04889835191382725
Bond Position:  [4.4500165]


portfolio before change:  [9.27806022]
curr_Stock_Price:  98.73064001805501
curr_Factors:  [98.73064002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05932248]
Stock Position:  -0.05932247884262017
Bond Position:  [15.13500652]


portfolio before change:  [9.29132389]
curr_Stock_Price:  98.52300023311923
curr_Factors:  [98.52300023]
mat_Sqrt:  [[0.15]]
grads:  [0.0065167]
Stock Position:  0.006516696948485147
Bond Position:  [8.64927935]


portfolio before change:  [9.29663083]
curr_Stock_Price:  99.25440461748013
curr_Factors:  [99.25440462]
mat_Sqrt:  [[0.15]]
grads:  [0.10015249]
Stock Position:  0.10015248845554152
Bond Position:  [-0.64394479]


portfolio before change:  [9.31074378]
curr_Stock_Price:  99.39572113406992
curr_Factors:  [99.39572113]
mat_Sqrt:  [[0.15]]
grads:  [0.07677219]
Stock Position:  0.07677218841465946
Bond Position:  [1.67991675]


portfolio before change:  [9.29448066]
curr_Stock_Price:  99.18251741328429
curr_Factors:  [99.18251741]
mat_Sqrt:  [[0.15]]
grads:  [-0.05407201]
Stock Position:  -0.05407200768477143
Bond Position:  [14.65747851]


portfolio before change:  [9.29876168]
curr_Stock_Price:  99.12028751803568
curr_Factors:  [99.12028752]
mat_Sqrt:  [[0.15]]
grads:  [0.05363955]
Stock Position:  0.05363955091970613
Bond Position:  [3.98199397]


portfolio before change:  [9.34592805]
curr_Stock_Price:  99.99496846199145
curr_Factors:  [99.99496846]
mat_Sqrt:  [[0.15]]
grads:  [0.29770862]
Stock Position:  0.2977086171976181
Bond Position:  [-20.42343573]


portfolio before change:  [9.46007274]
curr_Stock_Price:  100.3826669728957
curr_Factors:  [100.38266697]
mat_Sqrt:  [[0.15]]
grads:  [-0.00610323]
Stock Position:  -0.006103226435346237
Bond Position:  [10.07273088]


portfolio before change:  [9.4584598]
curr_Stock_Price:  100.75009556357416
curr_Factors:  [100.75009556]
mat_Sqrt:  [[0.15]]
grads:  [0.09345501]
Stock Position:  0.0934550114845065
Bond Position:  [0.04285846]


portfolio before change:  [9.40390344]
curr_Stock_Price:  100.16629549113128
curr_Factors:  [100.16629549]
mat_Sqrt:  [[0.15]]
grads:  [-0.04708424]
Stock Position:  -0.04708423750348574
Bond Position:  [14.12015708]


portfolio before change:  [9.36252303]
curr_Stock_Price:  101.0638983750022
curr_Factors:  [101.06389838]
mat_Sqrt:  [[0.15]]
grads:  [0.04977714]
Stock Position:  0.04977713931492149
Bond Position:  [4.33185128]


portfolio before change:  [9.35927253]
curr_Stock_Price:  100.99315814555622
curr_Factors:  [100.99315815]
mat_Sqrt:  [[0.15]]
grads:  [0.07391802]
Stock Position:  0.07391802473096487
Bond Position:  [1.89405777]


portfolio before change:  [9.37192422]
curr_Stock_Price:  101.16271495090028
curr_Factors:  [101.16271495]
mat_Sqrt:  [[0.15]]
grads:  [-0.01630125]
Stock Position:  -0.016301245224438137
Bond Position:  [11.02100244]


portfolio before change:  [9.3790619]
curr_Stock_Price:  100.76711056431162
curr_Factors:  [100.76711056]
mat_Sqrt:  [[0.15]]
grads:  [0.04794861]
Stock Position:  0.04794861137585768
Bond Position:  [4.54741887]


portfolio before change:  [9.38044786]
curr_Stock_Price:  100.79008805503867
curr_Factors:  [100.79008806]
mat_Sqrt:  [[0.15]]
grads:  [-0.08019144]
Stock Position:  -0.08019144142708516
Bond Position:  [17.4629503]


portfolio before change:  [9.30685842]
curr_Stock_Price:  101.72137073978529
curr_Factors:  [101.72137074]
mat_Sqrt:  [[0.15]]
grads:  [0.05186075]
Stock Position:  0.05186074614757663
Bond Position:  [4.03151224]


portfolio before change:  [9.27248041]
curr_Stock_Price:  101.05362114527824
curr_Factors:  [101.05362115]
mat_Sqrt:  [[0.15]]
grads:  [0.04997259]
Stock Position:  0.04997259308677111
Bond Position:  [4.22256892]


portfolio before change:  [9.23941556]
curr_Stock_Price:  100.38668020096284
curr_Factors:  [100.3866802]
mat_Sqrt:  [[0.15]]
grads:  [0.07661418]
Stock Position:  0.0766141838378526
Bond Position:  [1.54837199]


portfolio before change:  [9.17774197]
curr_Stock_Price:  99.58042780791395
curr_Factors:  [99.58042781]
mat_Sqrt:  [[0.15]]
grads:  [0.0893892]
Stock Position:  0.08938919513935425
Bond Position:  [0.27632767]


portfolio before change:  [9.15829181]
curr_Stock_Price:  99.36264502961215
curr_Factors:  [99.36264503]
mat_Sqrt:  [[0.15]]
grads:  [-0.23463536]
Stock Position:  -0.23463536252216421
Bond Position:  [32.47228205]


portfolio before change:  [9.10584293]
curr_Stock_Price:  99.59482853505969
curr_Factors:  [99.59482854]
mat_Sqrt:  [[0.15]]
grads:  [0.06358589]
Stock Position:  0.06358589017630017
Bond Position:  [2.7730171]


portfolio before change:  [9.0851155]
curr_Stock_Price:  99.26612742035266
curr_Factors:  [99.26612742]
mat_Sqrt:  [[0.15]]
grads:  [-0.09433806]
Stock Position:  -0.09433805804370977
Bond Position:  [18.44968919]


portfolio before change:  [9.08551893]
curr_Stock_Price:  99.27407446248472
curr_Factors:  [99.27407446]
mat_Sqrt:  [[0.15]]
grads:  [0.1633607]
Stock Position:  0.16336069935031014
Bond Position:  [-7.1319633]


portfolio before change:  [9.02310984]
curr_Stock_Price:  98.89477071276731
curr_Factors:  [98.89477071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286307]
Stock Position:  -0.03286306963312748
Bond Position:  [12.27309558]


portfolio before change:  [9.02008373]
curr_Stock_Price:  99.0101953882786
curr_Factors:  [99.01019539]
mat_Sqrt:  [[0.15]]
grads:  [0.00942309]
Stock Position:  0.009423090089421387
Bond Position:  [8.08710174]


portfolio before change:  [9.02339629]
curr_Stock_Price:  99.30809197815175
curr_Factors:  [99.30809198]
mat_Sqrt:  [[0.15]]
grads:  [0.15492184]
Stock Position:  0.15492183828446604
Bond Position:  [-6.36159587]


portfolio before change:  [9.08121754]
curr_Stock_Price:  99.68388700116283
curr_Factors:  [99.683887]
mat_Sqrt:  [[0.15]]
grads:  [0.02676471]
Stock Position:  0.026764712007259345
Bond Position:  [6.41320701]


portfolio before change:  [9.07990664]
curr_Stock_Price:  99.61993215837282
curr_Factors:  [99.61993216]
mat_Sqrt:  [[0.15]]
grads:  [-0.05451862]
Stock Position:  -0.054518622151958934
Bond Position:  [14.51104808]


portfolio before change:  [9.08568473]
curr_Stock_Price:  99.53058441252297
curr_Factors:  [99.53058441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03193549]
Stock Position:  -0.031935493557878454
Bond Position:  [12.26424306]


portfolio before change:  [9.07343359]
curr_Stock_Price:  99.93820852971223
curr_Factors:  [99.93820853]
mat_Sqrt:  [[0.15]]
grads:  [0.03473919]
Stock Position:  0.03473919052155461
Bond Position:  [5.60166112]


portfolio before change:  [9.09305876]
curr_Stock_Price:  100.49305895138285
curr_Factors:  [100.49305895]
mat_Sqrt:  [[0.15]]
grads:  [-0.06773517]
Stock Position:  -0.06773516790064332
Bond Position:  [15.89997298]


portfolio before change:  [9.13552911]
curr_Stock_Price:  99.88072452507991
curr_Factors:  [99.88072453]
mat_Sqrt:  [[0.15]]
grads:  [-0.09796028]
Stock Position:  -0.09796028331322418
Bond Position:  [18.91987318]


portfolio before change:  [9.08847462]
curr_Stock_Price:  100.37313860586714
curr_Factors:  [100.37313861]
mat_Sqrt:  [[0.15]]
grads:  [-0.04860518]
Stock Position:  -0.04860518424283127
Bond Position:  [13.96712951]


portfolio before change:  [9.0563779]
curr_Stock_Price:  101.05145491064545
curr_Factors:  [101.05145491]
mat_Sqrt:  [[0.15]]
grads:  [0.10110564]
Stock Position:  0.10110563507194394
Bond Position:  [-1.16049362]


portfolio before change:  [9.09872121]
curr_Stock_Price:  101.47097495193803
curr_Factors:  [101.47097495]
mat_Sqrt:  [[0.15]]
grads:  [-0.02019925]
Stock Position:  -0.02019924939512229
Bond Position:  [11.14835874]


portfolio before change:  [9.09475426]
curr_Stock_Price:  101.7018620548995
curr_Factors:  [101.70186205]
mat_Sqrt:  [[0.15]]
grads:  [-0.02933968]
Stock Position:  -0.029339676861651013
Bond Position:  [12.07865403]


portfolio before change:  [9.09834589]
curr_Stock_Price:  101.60517741973473
curr_Factors:  [101.60517742]
mat_Sqrt:  [[0.15]]
grads:  [0.03606084]
Stock Position:  0.03606083699947888
Bond Position:  [5.43437815]


portfolio before change:  [9.1081383]
curr_Stock_Price:  101.86731085825348
curr_Factors:  [101.86731086]
mat_Sqrt:  [[0.15]]
grads:  [0.00796281]
Stock Position:  0.007962805051965774
Bond Position:  [8.29698876]


portfolio before change:  [9.11587442]
curr_Stock_Price:  102.77371693956225
curr_Factors:  [102.77371694]
mat_Sqrt:  [[0.15]]
grads:  [0.0326865]
Stock Position:  0.03268650154876234
Bond Position:  [5.75656116]


portfolio before change:  [9.09965541]
curr_Stock_Price:  102.26651062900187
curr_Factors:  [102.26651063]
mat_Sqrt:  [[0.15]]
grads:  [0.06081311]
Stock Position:  0.06081310824763306
Bond Position:  [2.88051103]


portfolio before change:  [9.15036223]
curr_Stock_Price:  103.09736402031142
curr_Factors:  [103.09736402]
mat_Sqrt:  [[0.15]]
grads:  [-0.00062993]
Stock Position:  -0.0006299253960045713
Bond Position:  [9.21530587]


portfolio before change:  [9.15109236]
curr_Stock_Price:  102.85263277284344
curr_Factors:  [102.85263277]
mat_Sqrt:  [[0.15]]
grads:  [0.01127255]
Stock Position:  0.011272554283909612
Bond Position:  [7.99168048]


portfolio before change:  [9.14786532]
curr_Stock_Price:  102.5220472687901
curr_Factors:  [102.52204727]
mat_Sqrt:  [[0.15]]
grads:  [0.10665702]
Stock Position:  0.10665701921872758
Bond Position:  [-1.78683065]


portfolio before change:  [9.12756373]
curr_Stock_Price:  102.33274980551164
curr_Factors:  [102.33274981]
mat_Sqrt:  [[0.15]]
grads:  [-0.01714173]
Stock Position:  -0.01714172966481605
Bond Position:  [10.88172407]


portfolio before change:  [9.13225812]
curr_Stock_Price:  102.09856936142158
curr_Factors:  [102.09856936]
mat_Sqrt:  [[0.15]]
grads:  [0.03364259]
Stock Position:  0.03364259332978434
Bond Position:  [5.69739747]


portfolio before change:  [9.13213109]
curr_Stock_Price:  102.08420886772674
curr_Factors:  [102.08420887]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569469]
Stock Position:  -0.015694685030162744
Bond Position:  [10.7343106]


portfolio before change:  [9.12495979]
curr_Stock_Price:  102.58388236705277
curr_Factors:  [102.58388237]
mat_Sqrt:  [[0.15]]
grads:  [-0.0822886]
Stock Position:  -0.08228860065183768
Bond Position:  [17.56644392]


portfolio before change:  [9.14153865]
curr_Stock_Price:  102.39575278419183
curr_Factors:  [102.39575278]
mat_Sqrt:  [[0.15]]
grads:  [0.00541201]
Stock Position:  0.0054120117688575995
Bond Position:  [8.58737163]


portfolio before change:  [9.14356579]
curr_Stock_Price:  102.67114194175294
curr_Factors:  [102.67114194]
mat_Sqrt:  [[0.15]]
grads:  [0.00824311]
Stock Position:  0.00824310932557695
Bond Position:  [8.29723634]


portfolio before change:  [9.14512014]
curr_Stock_Price:  102.79679410822192
curr_Factors:  [102.79679411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620433]
Stock Position:  -0.036204329873137785
Bond Position:  [12.86680919]


portfolio before change:  [9.14386731]
curr_Stock_Price:  102.85361143862924
curr_Factors:  [102.85361144]
mat_Sqrt:  [[0.15]]
grads:  [0.10025435]
Stock Position:  0.10025435338305273
Bond Position:  [-1.167655]


portfolio before change:  [9.15310486]
curr_Stock_Price:  102.94648053881582
curr_Factors:  [102.94648054]
mat_Sqrt:  [[0.15]]
grads:  [-0.05519628]
Stock Position:  -0.0551962812764231
Bond Position:  [14.83536776]


portfolio before change:  [9.18135826]
curr_Stock_Price:  102.45140809279147
curr_Factors:  [102.45140809]
mat_Sqrt:  [[0.15]]
grads:  [0.07132819]
Stock Position:  0.07132819411239137
Bond Position:  [1.87368434]


portfolio before change:  [9.1725665]
curr_Stock_Price:  102.3265084182137
curr_Factors:  [102.32650842]
mat_Sqrt:  [[0.15]]
grads:  [-0.07783941]
Stock Position:  -0.07783940562754928
Bond Position:  [17.13760109]


portfolio before change:  [9.22406031]
curr_Stock_Price:  101.67873016534065
curr_Factors:  [101.67873017]
mat_Sqrt:  [[0.15]]
grads:  [0.07760715]
Stock Position:  0.07760714548905653
Bond Position:  [1.3330643]


portfolio before change:  [9.25095859]
curr_Stock_Price:  102.02425194804935
curr_Factors:  [102.02425195]
mat_Sqrt:  [[0.15]]
grads:  [-0.00373056]
Stock Position:  -0.003730561442555097
Bond Position:  [9.63156633]


portfolio before change:  [9.2541387]
curr_Stock_Price:  101.3331705290078
curr_Factors:  [101.33317053]
mat_Sqrt:  [[0.15]]
grads:  [0.12174617]
Stock Position:  0.12174616723700976
Bond Position:  [-3.08278643]


portfolio before change:  [9.39044454]
curr_Stock_Price:  102.45434359907573
curr_Factors:  [102.4543436]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988809]
Stock Position:  -0.14988809225980057
Bond Position:  [24.74713065]


portfolio before change:  [9.35414363]
curr_Stock_Price:  102.70684968537857
curr_Factors:  [102.70684969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00728714]
Stock Position:  -0.0072871367116921605
Bond Position:  [10.10258249]


portfolio before change:  [9.3549091]
curr_Stock_Price:  102.68845554793468
curr_Factors:  [102.68845555]
mat_Sqrt:  [[0.15]]
grads:  [-0.06340812]
Stock Position:  -0.0634081162695245
Bond Position:  [15.86619063]


portfolio before change:  [9.3229631]
curr_Stock_Price:  103.207910637655
curr_Factors:  [103.20791064]
mat_Sqrt:  [[0.15]]
grads:  [-0.03526761]
Stock Position:  -0.035267614390438524
Bond Position:  [12.9628599]


portfolio before change:  [9.3226279]
curr_Stock_Price:  103.24038827540149
curr_Factors:  [103.24038828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.3226279]
Stock Price:  103.84002508050432
PL:  [5.48260282]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.58488460e-04]
 [ 3.00517109e-03]
 [-1.11129645e-03]
 [ 8.44131190e-03]
 [ 2.63039657e-03]
 [ 2.23293994e-02]
 [ 1.10772051e-03]
 [-2.46706419e-02]
 [-2.61416031e-02]
 [ 2.68249154e-02]
 [-2.04103873e-02]
 [ 2.71888337e-02]
 [-1.36234581e-02]
 [ 5.85618362e-04]
 [-7.05790779e-03]
 [ 1.03410894e-02]
 [ 1.64509323e-02]
 [ 2.04794445e-02]
 [ 1.83356120e-03]
 [ 9.39245762e-03]
 [ 1.23844917e-02]
 [-9.95741331e-03]
 [ 4.15611828e-03]
 [-1.58877531e-02]
 [-1.06623234e-02]
 [-4.20643150e-03]
 [ 7.64987862e-04]
 [ 1.00576288e-02]
 [-4.57643046e-02]
 [ 2.55818786e-03]
 [ 3.25941521e-03]
 [-1.00930547e-02]
 [-7.32654427e-03]
 [ 4.83637728e-03]
 [ 1.23234324e-02]
 [ 1.14433504e-02]
 [-3.45304859e-02]
 [ 9.68368006e-03]
 [-1.26267816e-02]
 [ 2.43898400e-02]
 [-6.19930256e-03]
 [ 7.90701681e-03]
 [ 2.30419642e-02]
 [ 4.58715857e-03]
 [-8.22209446e-03]
 [-4.16905938e-03]
 [ 4.31338538e-03]
 [-1.22259116e-02]
 [-1.09472892e-02]
 [-4.38415755e-03]
 [ 4.41185600e-02]
 [-6.56690159e-03]
 [ 2.36510819e-03]
 [ 5.25333566e-03]
 [ 5.51000476e-03]
 [-2.62117337e-03]
 [ 6.60082588e-03]
 [-6.72694435e-04]
 [ 1.52958728e-03]
 [-3.71098968e-03]
 [-1.25891202e-03]
 [ 4.01158253e-03]
 [ 1.18787033e-02]
 [-1.78457643e-02]
 [-1.35538495e-02]
 [-6.36889210e-04]
 [-5.14226425e-03]
 [ 2.32056037e-02]
 [-9.01692575e-03]
 [ 6.21172060e-03]
 [-8.72834559e-03]
 [ 1.08387711e-02]
 [-2.21774649e-03]
 [ 5.77843566e-03]
 [-1.02110832e-02]
 [-1.14869034e-02]
 [ 1.84310588e-03]
 [ 2.81731588e-03]
 [-9.66182710e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.3647757]
curr_Stock_Price:  100.2811158337374
curr_Factors:  [100.28111583]
mat_Sqrt:  [[0.15]]
grads:  [0.00238992]
Stock Position:  0.0023899230649708533
Bond Position:  [6.12511155]


portfolio before change:  [6.36477417]
curr_Stock_Price:  100.12029112041613
curr_Factors:  [100.12029112]
mat_Sqrt:  [[0.15]]
grads:  [0.02003447]
Stock Position:  0.020034473935432607
Bond Position:  [4.35891681]


portfolio before change:  [6.36970809]
curr_Stock_Price:  100.35296379295492
curr_Factors:  [100.35296379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00740864]
Stock Position:  -0.007408643006427465
Bond Position:  [7.11318737]


portfolio before change:  [6.37676605]
curr_Stock_Price:  99.46030682474489
curr_Factors:  [99.46030682]
mat_Sqrt:  [[0.15]]
grads:  [0.05627541]
Stock Position:  0.05627541269651308
Bond Position:  [0.77959624]


portfolio before change:  [6.36725593]
curr_Stock_Price:  99.2904485556098
curr_Factors:  [99.29044856]
mat_Sqrt:  [[0.15]]
grads:  [0.01753598]
Stock Position:  0.01753597711673284
Bond Position:  [4.6261009]


portfolio before change:  [6.37473512]
curr_Stock_Price:  99.7004654449219
curr_Factors:  [99.70046544]
mat_Sqrt:  [[0.15]]
grads:  [0.14886266]
Stock Position:  0.14886266238206367
Bond Position:  [-8.46694161]


portfolio before change:  [6.30810348]
curr_Stock_Price:  99.25641559307381
curr_Factors:  [99.25641559]
mat_Sqrt:  [[0.15]]
grads:  [0.0073848]
Stock Position:  0.007384803375720054
Bond Position:  [5.57511436]


portfolio before change:  [6.29974962]
curr_Stock_Price:  98.07800716958846
curr_Factors:  [98.07800717]
mat_Sqrt:  [[0.15]]
grads:  [-0.16447095]
Stock Position:  -0.16447094630505835
Bond Position:  [22.43073227]


portfolio before change:  [6.40480041]
curr_Stock_Price:  97.44781179283059
curr_Factors:  [97.44781179]
mat_Sqrt:  [[0.15]]
grads:  [-0.17427735]
Stock Position:  -0.17427735416824316
Bond Position:  [23.38774722]


portfolio before change:  [6.2851983]
curr_Stock_Price:  98.14247402196555
curr_Factors:  [98.14247402]
mat_Sqrt:  [[0.15]]
grads:  [0.17883277]
Stock Position:  0.1788327693069573
Bond Position:  [-11.26589212]


portfolio before change:  [6.28744805]
curr_Stock_Price:  98.15899167045143
curr_Factors:  [98.15899167]
mat_Sqrt:  [[0.15]]
grads:  [-0.13606925]
Stock Position:  -0.13606924852599914
Bond Position:  [19.64386829]


portfolio before change:  [6.3206954]
curr_Stock_Price:  97.92367348501706
curr_Factors:  [97.92367349]
mat_Sqrt:  [[0.15]]
grads:  [0.18125889]
Stock Position:  0.18125889109798066
Bond Position:  [-11.42884107]


portfolio before change:  [6.31630898]
curr_Stock_Price:  97.90341463110178
curr_Factors:  [97.90341463]
mat_Sqrt:  [[0.15]]
grads:  [-0.09082305]
Stock Position:  -0.09082305431767987
Bond Position:  [15.20819612]


portfolio before change:  [6.39883513]
curr_Stock_Price:  97.00523291553701
curr_Factors:  [97.00523292]
mat_Sqrt:  [[0.15]]
grads:  [0.00390412]
Stock Position:  0.003904122413281129
Bond Position:  [6.02011482]


portfolio before change:  [6.39897214]
curr_Stock_Price:  96.94395080113684
curr_Factors:  [96.9439508]
mat_Sqrt:  [[0.15]]
grads:  [-0.04705272]
Stock Position:  -0.04705271857211465
Bond Position:  [10.96044858]


portfolio before change:  [6.44351726]
curr_Stock_Price:  96.01180354538032
curr_Factors:  [96.01180355]
mat_Sqrt:  [[0.15]]
grads:  [0.0689406]
Stock Position:  0.06894059575818824
Bond Position:  [-0.17559368]


portfolio before change:  [6.44062611]
curr_Stock_Price:  95.97002593314635
curr_Factors:  [95.97002593]
mat_Sqrt:  [[0.15]]
grads:  [0.10967288]
Stock Position:  0.10967288229059118
Bond Position:  [-4.08468325]


portfolio before change:  [6.48543984]
curr_Stock_Price:  96.38096644704417
curr_Factors:  [96.38096645]
mat_Sqrt:  [[0.15]]
grads:  [0.13652963]
Stock Position:  0.13652963004285046
Bond Position:  [-6.67341785]


portfolio before change:  [6.58459226]
curr_Stock_Price:  97.11025520368338
curr_Factors:  [97.1102552]
mat_Sqrt:  [[0.15]]
grads:  [0.01222374]
Stock Position:  0.012223741349294444
Bond Position:  [5.39754162]


portfolio before change:  [6.58200873]
curr_Stock_Price:  96.8713029688653
curr_Factors:  [96.87130297]
mat_Sqrt:  [[0.15]]
grads:  [0.06261638]
Stock Position:  0.06261638416650228
Bond Position:  [0.51627801]


portfolio before change:  [6.64510399]
curr_Stock_Price:  97.87843539949864
curr_Factors:  [97.8784354]
mat_Sqrt:  [[0.15]]
grads:  [0.08256328]
Stock Position:  0.08256327825669121
Bond Position:  [-1.43606051]


portfolio before change:  [6.60952895]
curr_Stock_Price:  97.4486403891872
curr_Factors:  [97.44864039]
mat_Sqrt:  [[0.15]]
grads:  [-0.06638276]
Stock Position:  -0.06638275538285235
Bond Position:  [13.0784382]


portfolio before change:  [6.62604137]
curr_Stock_Price:  97.2122085758233
curr_Factors:  [97.21220858]
mat_Sqrt:  [[0.15]]
grads:  [0.02770746]
Stock Position:  0.027707455183679366
Bond Position:  [3.93253846]


portfolio before change:  [6.63113626]
curr_Stock_Price:  97.38721932505052
curr_Factors:  [97.38721933]
mat_Sqrt:  [[0.15]]
grads:  [-0.10591835]
Stock Position:  -0.10591835425736366
Bond Position:  [16.94623026]


portfolio before change:  [6.66238994]
curr_Stock_Price:  97.10214588542927
curr_Factors:  [97.10214589]
mat_Sqrt:  [[0.15]]
grads:  [-0.07108216]
Stock Position:  -0.07108215592624736
Bond Position:  [13.56461982]


portfolio before change:  [6.67171763]
curr_Stock_Price:  96.982849161945
curr_Factors:  [96.98284916]
mat_Sqrt:  [[0.15]]
grads:  [-0.02804288]
Stock Position:  -0.02804287664557458
Bond Position:  [9.3913957]


portfolio before change:  [6.69469182]
curr_Stock_Price:  96.18452847969408
curr_Factors:  [96.18452848]
mat_Sqrt:  [[0.15]]
grads:  [0.00509992]
Stock Position:  0.005099919078008011
Bond Position:  [6.2041585]


portfolio before change:  [6.69866817]
curr_Stock_Price:  96.88818222141424
curr_Factors:  [96.88818222]
mat_Sqrt:  [[0.15]]
grads:  [0.06705086]
Stock Position:  0.06705085898449493
Bond Position:  [0.20223232]


portfolio before change:  [6.65981955]
curr_Stock_Price:  96.30860344224267
curr_Factors:  [96.30860344]
mat_Sqrt:  [[0.15]]
grads:  [-0.30509536]
Stock Position:  -0.3050953642566648
Bond Position:  [36.043128]


portfolio before change:  [6.39958871]
curr_Stock_Price:  97.1689364329337
curr_Factors:  [97.16893643]
mat_Sqrt:  [[0.15]]
grads:  [0.01705459]
Stock Position:  0.017054585742725097
Bond Position:  [4.74241275]


portfolio before change:  [6.40136229]
curr_Stock_Price:  97.25555044888755
curr_Factors:  [97.25555045]
mat_Sqrt:  [[0.15]]
grads:  [0.02172943]
Stock Position:  0.021729434707394125
Bond Position:  [4.28805415]


portfolio before change:  [6.40830902]
curr_Stock_Price:  97.5629088802389
curr_Factors:  [97.56290888]
mat_Sqrt:  [[0.15]]
grads:  [-0.06728703]
Stock Position:  -0.06728703134097519
Bond Position:  [12.97302753]


portfolio before change:  [6.34770185]
curr_Stock_Price:  98.47568527149241
curr_Factors:  [98.47568527]
mat_Sqrt:  [[0.15]]
grads:  [-0.04884363]
Stock Position:  -0.04884362843892889
Bond Position:  [11.15761163]


portfolio before change:  [6.35626381]
curr_Stock_Price:  98.3146696538727
curr_Factors:  [98.31466965]
mat_Sqrt:  [[0.15]]
grads:  [0.03224252]
Stock Position:  0.03224251517410229
Bond Position:  [3.18635158]


portfolio before change:  [6.37945998]
curr_Stock_Price:  99.02792105687398
curr_Factors:  [99.02792106]
mat_Sqrt:  [[0.15]]
grads:  [0.08215622]
Stock Position:  0.08215621622964496
Bond Position:  [-1.75629931]


portfolio before change:  [6.47360507]
curr_Stock_Price:  100.17518493987801
curr_Factors:  [100.17518494]
mat_Sqrt:  [[0.15]]
grads:  [0.076289]
Stock Position:  0.07628900297425215
Bond Position:  [-1.16865991]


portfolio before change:  [6.47598818]
curr_Stock_Price:  100.2073803374149
curr_Factors:  [100.20738034]
mat_Sqrt:  [[0.15]]
grads:  [-0.23020324]
Stock Position:  -0.23020323922054592
Bond Position:  [29.54405173]


portfolio before change:  [6.50327439]
curr_Stock_Price:  100.09687079463863
curr_Factors:  [100.09687079]
mat_Sqrt:  [[0.15]]
grads:  [0.06455787]
Stock Position:  0.06455786704013851
Bond Position:  [0.04123392]


portfolio before change:  [6.47386039]
curr_Stock_Price:  99.64120861466752
curr_Factors:  [99.64120861]
mat_Sqrt:  [[0.15]]
grads:  [-0.08417854]
Stock Position:  -0.0841785437546334
Bond Position:  [14.86151223]


portfolio before change:  [6.52981866]
curr_Stock_Price:  98.98748624685312
curr_Factors:  [98.98748625]
mat_Sqrt:  [[0.15]]
grads:  [0.16259893]
Stock Position:  0.162598933027029
Bond Position:  [-9.56544098]


portfolio before change:  [6.40499284]
curr_Stock_Price:  98.22347160958026
curr_Factors:  [98.22347161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132868]
Stock Position:  -0.0413286837478659
Bond Position:  [10.46443964]


portfolio before change:  [6.39982575]
curr_Stock_Price:  98.36432133677518
curr_Factors:  [98.36432134]
mat_Sqrt:  [[0.15]]
grads:  [0.05271345]
Stock Position:  0.052713445371570695
Bond Position:  [1.21470348]


portfolio before change:  [6.38669868]
curr_Stock_Price:  98.11385402460077
curr_Factors:  [98.11385402]
mat_Sqrt:  [[0.15]]
grads:  [0.15361309]
Stock Position:  0.15361309473378995
Bond Position:  [-8.68487407]


portfolio before change:  [6.46163793]
curr_Stock_Price:  98.60523184186965
curr_Factors:  [98.60523184]
mat_Sqrt:  [[0.15]]
grads:  [0.03058106]
Stock Position:  0.03058105711081278
Bond Position:  [3.4461857]


portfolio before change:  [6.4850655]
curr_Stock_Price:  99.36426965884085
curr_Factors:  [99.36426966]
mat_Sqrt:  [[0.15]]
grads:  [-0.05481396]
Stock Position:  -0.05481396308421633
Bond Position:  [11.93161491]


portfolio before change:  [6.46663686]
curr_Stock_Price:  99.71407813113818
curr_Factors:  [99.71407813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02779373]
Stock Position:  -0.027793729229433375
Bond Position:  [9.23806295]


portfolio before change:  [6.46670271]
curr_Stock_Price:  99.73248304913938
curr_Factors:  [99.73248305]
mat_Sqrt:  [[0.15]]
grads:  [0.0287559]
Stock Position:  0.028755902512125203
Bond Position:  [3.59880515]


portfolio before change:  [6.4692464]
curr_Stock_Price:  99.81311887181126
curr_Factors:  [99.81311887]
mat_Sqrt:  [[0.15]]
grads:  [-0.08150608]
Stock Position:  -0.08150607740911248
Bond Position:  [14.6046222]


portfolio before change:  [6.53235734]
curr_Stock_Price:  99.05000870170079
curr_Factors:  [99.0500087]
mat_Sqrt:  [[0.15]]
grads:  [-0.07298193]
Stock Position:  -0.07298192768486102
Bond Position:  [13.76121791]


portfolio before change:  [6.56891376]
curr_Stock_Price:  98.56089690986178
curr_Factors:  [98.56089691]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922772]
Stock Position:  -0.029227716995460045
Bond Position:  [9.44962376]


portfolio before change:  [6.59454512]
curr_Stock_Price:  97.70415069420636
curr_Factors:  [97.70415069]
mat_Sqrt:  [[0.15]]
grads:  [0.29412373]
Stock Position:  0.2941237334475752
Bond Position:  [-22.14256446]


portfolio before change:  [6.44590615]
curr_Stock_Price:  97.20349399403428
curr_Factors:  [97.20349399]
mat_Sqrt:  [[0.15]]
grads:  [-0.04377934]
Stock Position:  -0.04377934395617538
Bond Position:  [10.70141134]


portfolio before change:  [6.45333026]
curr_Stock_Price:  97.04919159907497
curr_Factors:  [97.0491916]
mat_Sqrt:  [[0.15]]
grads:  [0.01576739]
Stock Position:  0.01576738794813792
Bond Position:  [4.92311801]


portfolio before change:  [6.47329095]
curr_Stock_Price:  98.29562411293493
curr_Factors:  [98.29562411]
mat_Sqrt:  [[0.15]]
grads:  [0.03502224]
Stock Position:  0.03502223773524844
Bond Position:  [3.03075824]


portfolio before change:  [6.47919158]
curr_Stock_Price:  98.45869755906264
curr_Factors:  [98.45869756]
mat_Sqrt:  [[0.15]]
grads:  [0.03673337]
Stock Position:  0.03673336505011629
Bond Position:  [2.8624723]


portfolio before change:  [6.47418992]
curr_Stock_Price:  98.31766602959755
curr_Factors:  [98.31766603]
mat_Sqrt:  [[0.15]]
grads:  [-0.01747449]
Stock Position:  -0.017474489103649835
Bond Position:  [8.19224091]


portfolio before change:  [6.48377104]
curr_Stock_Price:  97.79867624366811
curr_Factors:  [97.79867624]
mat_Sqrt:  [[0.15]]
grads:  [0.04400551]
Stock Position:  0.044005505834158576
Bond Position:  [2.18009082]


portfolio before change:  [6.48943075]
curr_Stock_Price:  97.92419360721745
curr_Factors:  [97.92419361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00448463]
Stock Position:  -0.004484629563455157
Bond Position:  [6.92858449]


portfolio before change:  [6.49016614]
curr_Stock_Price:  97.85677741052034
curr_Factors:  [97.85677741]
mat_Sqrt:  [[0.15]]
grads:  [0.01019725]
Stock Position:  0.010197248508247237
Bond Position:  [5.49229626]


portfolio before change:  [6.48673293]
curr_Stock_Price:  97.4864333378567
curr_Factors:  [97.48643334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02473993]
Stock Position:  -0.024739931177076523
Bond Position:  [8.89854058]


portfolio before change:  [6.48401277]
curr_Stock_Price:  97.61886425873877
curr_Factors:  [97.61886426]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839275]
Stock Position:  -0.008392746812976252
Bond Position:  [7.30330318]


portfolio before change:  [6.48469093]
curr_Stock_Price:  97.59244963220122
curr_Factors:  [97.59244963]
mat_Sqrt:  [[0.15]]
grads:  [0.02674388]
Stock Position:  0.02674388352062356
Bond Position:  [3.87468983]


portfolio before change:  [6.48168308]
curr_Stock_Price:  97.47092544696075
curr_Factors:  [97.47092545]
mat_Sqrt:  [[0.15]]
grads:  [0.07919136]
Stock Position:  0.07919135538526557
Bond Position:  [-1.23717162]


portfolio before change:  [6.54424704]
curr_Stock_Price:  98.26193713758286
curr_Factors:  [98.26193714]
mat_Sqrt:  [[0.15]]
grads:  [-0.11897176]
Stock Position:  -0.11897176193679095
Bond Position:  [18.23464284]


portfolio before change:  [6.43300332]
curr_Stock_Price:  99.20655977952414
curr_Factors:  [99.20655978]
mat_Sqrt:  [[0.15]]
grads:  [-0.090359]
Stock Position:  -0.09035899647576826
Bond Position:  [15.39720851]


portfolio before change:  [6.44294993]
curr_Stock_Price:  99.10713138945432
curr_Factors:  [99.10713139]
mat_Sqrt:  [[0.15]]
grads:  [-0.00424593]
Stock Position:  -0.004245928068486634
Bond Position:  [6.86375168]


portfolio before change:  [6.44144557]
curr_Stock_Price:  99.56247573397394
curr_Factors:  [99.56247573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428176]
Stock Position:  -0.03428176165806987
Bond Position:  [9.85462263]


portfolio before change:  [6.44823498]
curr_Stock_Price:  99.38239512396984
curr_Factors:  [99.38239512]
mat_Sqrt:  [[0.15]]
grads:  [0.15470402]
Stock Position:  0.15470402467967626
Bond Position:  [-8.92662153]


portfolio before change:  [6.39649851]
curr_Stock_Price:  99.05157929792155
curr_Factors:  [99.0515793]
mat_Sqrt:  [[0.15]]
grads:  [-0.06011284]
Stock Position:  -0.0601128383239741
Bond Position:  [12.35077008]


portfolio before change:  [6.41806616]
curr_Stock_Price:  98.70563477352442
curr_Factors:  [98.70563477]
mat_Sqrt:  [[0.15]]
grads:  [0.04141147]
Stock Position:  0.04141147067027535
Bond Position:  [2.33052067]


portfolio before change:  [6.44355131]
curr_Stock_Price:  99.3175299431968
curr_Factors:  [99.31752994]
mat_Sqrt:  [[0.15]]
grads:  [-0.05818897]
Stock Position:  -0.058188970587803986
Bond Position:  [12.22273613]


portfolio before change:  [6.47198227]
curr_Stock_Price:  98.84206149974158
curr_Factors:  [98.8420615]
mat_Sqrt:  [[0.15]]
grads:  [0.07225847]
Stock Position:  0.07225847410666773
Bond Position:  [-0.67019427]


portfolio before change:  [6.41340713]
curr_Stock_Price:  98.03200768575259
curr_Factors:  [98.03200769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478498]
Stock Position:  -0.014784976567974128
Bond Position:  [7.86280807]


portfolio before change:  [6.42023191]
curr_Stock_Price:  97.60364413898957
curr_Factors:  [97.60364414]
mat_Sqrt:  [[0.15]]
grads:  [0.0385229]
Stock Position:  0.03852290437824092
Bond Position:  [2.66025606]


portfolio before change:  [6.41505347]
curr_Stock_Price:  97.46490280663427
curr_Factors:  [97.46490281]
mat_Sqrt:  [[0.15]]
grads:  [-0.06807389]
Stock Position:  -0.06807388830601202
Bond Position:  [13.04986837]


portfolio before change:  [6.45281231]
curr_Stock_Price:  96.92221014770612
curr_Factors:  [96.92221015]
mat_Sqrt:  [[0.15]]
grads:  [-0.07657936]
Stock Position:  -0.07657935568219496
Bond Position:  [13.87505271]


portfolio before change:  [6.38731986]
curr_Stock_Price:  97.7887579351828
curr_Factors:  [97.78875794]
mat_Sqrt:  [[0.15]]
grads:  [0.01228737]
Stock Position:  0.012287372550166363
Bond Position:  [5.18575296]


portfolio before change:  [6.38754302]
curr_Stock_Price:  97.78054163239797
curr_Factors:  [97.78054163]
mat_Sqrt:  [[0.15]]
grads:  [0.01878211]
Stock Position:  0.018782105861120387
Bond Position:  [4.55101853]


portfolio before change:  [6.39735534]
curr_Stock_Price:  98.28782631394404
curr_Factors:  [98.28782631]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.39735534]
Stock Price:  99.10028550359628
PL:  [6.39735534]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.56204540e-03]
 [ 1.82094830e-03]
 [-1.09888300e-03]
 [ 8.26689953e-03]
 [ 3.56208057e-03]
 [ 2.84810637e-02]
 [ 1.17618025e-03]
 [-1.11134458e-02]
 [ 2.43944989e-02]
 [-4.05051033e-03]
 [ 1.42810375e-02]
 [-1.10739840e-02]
 [-6.18128723e-04]
 [ 2.78797213e-03]
 [-6.91052479e-03]
 [ 2.28156148e-02]
 [ 1.03015549e-02]
 [-1.18483772e-02]
 [-3.97433929e-04]
 [-4.34636274e-03]
 [ 1.23876379e-02]
 [-6.17158798e-03]
 [ 6.89339150e-03]
 [ 2.52846992e-02]
 [ 3.30697040e-04]
 [ 1.41318522e-02]
 [-6.96272709e-03]
 [ 5.86221620e-03]
 [-7.24280111e-03]
 [-1.44323864e-03]
 [-2.00864618e-04]
 [-1.04340694e-02]
 [-2.20188179e-04]
 [ 4.74307714e-03]
 [ 1.22492525e-02]
 [ 1.71591271e-02]
 [-3.46914428e-02]
 [ 8.78617396e-03]
 [-1.87949758e-02]
 [ 2.43790140e-02]
 [-6.37553188e-03]
 [-1.39065069e-02]
 [ 2.33323100e-02]
 [ 3.24738078e-03]
 [-7.52581208e-03]
 [ 1.96654585e-03]
 [ 1.08676355e-02]
 [-2.87186455e-03]
 [-5.21093668e-03]
 [-7.52434620e-03]
 [-2.59442528e-02]
 [-5.11265966e-03]
 [-3.15513008e-03]
 [ 5.29964544e-03]
 [ 5.04378686e-03]
 [-3.56326548e-03]
 [ 4.12426753e-03]
 [-2.27778548e-04]
 [ 1.55595298e-03]
 [-4.13184957e-03]
 [ 9.00849938e-04]
 [-2.95880432e-03]
 [-3.47789721e-04]
 [-1.70879987e-02]
 [-1.32081638e-02]
 [ 5.76190982e-04]
 [-5.43648866e-03]
 [ 2.25301134e-02]
 [-8.25182555e-03]
 [ 8.62037267e-03]
 [-1.09401134e-02]
 [ 1.11674943e-02]
 [-6.73485278e-03]
 [ 1.74198369e-02]
 [-2.24818534e-02]
 [-1.09093774e-03]
 [-8.39689066e-03]
 [-2.79358893e-03]
 [ 2.82707022e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.58310376]
curr_Stock_Price:  99.9051628533952
curr_Factors:  [99.90516285]
mat_Sqrt:  [[0.15]]
grads:  [0.0170803]
Stock Position:  0.017080302648808887
Bond Position:  [-1.12330666]


portfolio before change:  [0.58328587]
curr_Stock_Price:  99.91993552030547
curr_Factors:  [99.91993552]
mat_Sqrt:  [[0.15]]
grads:  [0.01213966]
Stock Position:  0.012139655306695708
Bond Position:  [-0.62970771]


portfolio before change:  [0.57641854]
curr_Stock_Price:  99.35748384548904
curr_Factors:  [99.35748385]
mat_Sqrt:  [[0.15]]
grads:  [-0.00732589]
Stock Position:  -0.00732588666668013
Bond Position:  [1.30430021]


portfolio before change:  [0.57256824]
curr_Stock_Price:  99.89418609925814
curr_Factors:  [99.8941861]
mat_Sqrt:  [[0.15]]
grads:  [0.05511266]
Stock Position:  0.055112663522199394
Bond Position:  [-4.93286642]


portfolio before change:  [0.58868989]
curr_Stock_Price:  100.19230207089743
curr_Factors:  [100.19230207]
mat_Sqrt:  [[0.15]]
grads:  [0.0237472]
Stock Position:  0.02374720382180093
Bond Position:  [-1.79059712]


portfolio before change:  [0.60307226]
curr_Stock_Price:  100.80265937298729
curr_Factors:  [100.80265937]
mat_Sqrt:  [[0.15]]
grads:  [0.18987376]
Stock Position:  0.18987375806695586
Bond Position:  [-18.5367075]


portfolio before change:  [0.63536874]
curr_Stock_Price:  100.97885571936212
curr_Factors:  [100.97885572]
mat_Sqrt:  [[0.15]]
grads:  [0.0078412]
Stock Position:  0.00784120167647193
Bond Position:  [-0.15642683]


portfolio before change:  [0.63346687]
curr_Stock_Price:  100.73755372267422
curr_Factors:  [100.73755372]
mat_Sqrt:  [[0.15]]
grads:  [-0.07408964]
Stock Position:  -0.07408963895707205
Bond Position:  [8.09707585]


portfolio before change:  [0.62406435]
curr_Stock_Price:  100.87129173382534
curr_Factors:  [100.87129173]
mat_Sqrt:  [[0.15]]
grads:  [0.16262999]
Stock Position:  0.16262999284257318
Bond Position:  [-15.78063311]


portfolio before change:  [0.58129714]
curr_Stock_Price:  100.61438407758
curr_Factors:  [100.61438408]
mat_Sqrt:  [[0.15]]
grads:  [-0.0270034]
Stock Position:  -0.02700340221171479
Bond Position:  [3.29822782]


portfolio before change:  [0.59005227]
curr_Stock_Price:  100.29779483952832
curr_Factors:  [100.29779484]
mat_Sqrt:  [[0.15]]
grads:  [0.09520692]
Stock Position:  0.09520691647706926
Bond Position:  [-8.95899151]


portfolio before change:  [0.56997611]
curr_Stock_Price:  100.09280754845273
curr_Factors:  [100.09280755]
mat_Sqrt:  [[0.15]]
grads:  [-0.07382656]
Stock Position:  -0.0738265597242365
Bond Position:  [7.95948374]


portfolio before change:  [0.58777573]
curr_Stock_Price:  99.85844549408183
curr_Factors:  [99.85844549]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412086]
Stock Position:  -0.004120858152160609
Bond Position:  [0.99927822]


portfolio before change:  [0.58618131]
curr_Stock_Price:  100.26051747580016
curr_Factors:  [100.26051748]
mat_Sqrt:  [[0.15]]
grads:  [0.01858648]
Stock Position:  0.01858648088631195
Bond Position:  [-1.27730888]


portfolio before change:  [0.59734956]
curr_Stock_Price:  100.86569326784583
curr_Factors:  [100.86569327]
mat_Sqrt:  [[0.15]]
grads:  [-0.04607017]
Stock Position:  -0.04607016523572085
Bond Position:  [5.24424872]


portfolio before change:  [0.56390971]
curr_Stock_Price:  101.59865422529337
curr_Factors:  [101.59865423]
mat_Sqrt:  [[0.15]]
grads:  [0.1521041]
Stock Position:  0.15210409863194393
Bond Position:  [-14.88966202]


portfolio before change:  [0.45311271]
curr_Stock_Price:  100.87634388120335
curr_Factors:  [100.87634388]
mat_Sqrt:  [[0.15]]
grads:  [0.06867703]
Stock Position:  0.06867703245412829
Bond Position:  [-6.47477523]


portfolio before change:  [0.42873405]
curr_Stock_Price:  100.5272609686928
curr_Factors:  [100.52726097]
mat_Sqrt:  [[0.15]]
grads:  [-0.07898918]
Stock Position:  -0.07898918102410554
Bond Position:  [8.36930006]


portfolio before change:  [0.37783028]
curr_Stock_Price:  101.17832306977196
curr_Factors:  [101.17832307]
mat_Sqrt:  [[0.15]]
grads:  [-0.00264956]
Stock Position:  -0.002649559524025089
Bond Position:  [0.64590827]


portfolio before change:  [0.377452]
curr_Stock_Price:  101.33633126344348
curr_Factors:  [101.33633126]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897575]
Stock Position:  -0.028975751590773494
Bond Position:  [3.31374836]


portfolio before change:  [0.38481986]
curr_Stock_Price:  101.08920249826431
curr_Factors:  [101.0892025]
mat_Sqrt:  [[0.15]]
grads:  [0.08258425]
Stock Position:  0.08258425259484539
Bond Position:  [-7.96355638]


portfolio before change:  [0.354802]
curr_Stock_Price:  100.73174792251287
curr_Factors:  [100.73174792]
mat_Sqrt:  [[0.15]]
grads:  [-0.04114392]
Stock Position:  -0.04114391986762705
Bond Position:  [4.49930096]


portfolio before change:  [0.34949285]
curr_Stock_Price:  100.86762125971761
curr_Factors:  [100.86762126]
mat_Sqrt:  [[0.15]]
grads:  [0.04595594]
Stock Position:  0.045955943319846176
Bond Position:  [-4.28597383]


portfolio before change:  [0.35204323]
curr_Stock_Price:  100.92894656559005
curr_Factors:  [100.92894657]
mat_Sqrt:  [[0.15]]
grads:  [0.16856466]
Stock Position:  0.16856466126723235
Bond Position:  [-16.66101046]


portfolio before change:  [0.31047764]
curr_Stock_Price:  100.68853886107645
curr_Factors:  [100.68853886]
mat_Sqrt:  [[0.15]]
grads:  [0.00220465]
Stock Position:  0.0022046469356697246
Bond Position:  [0.08849497]


portfolio before change:  [0.30956845]
curr_Stock_Price:  100.27363074071354
curr_Factors:  [100.27363074]
mat_Sqrt:  [[0.15]]
grads:  [0.09421235]
Stock Position:  0.09421234777815805
Bond Position:  [-9.13744572]


portfolio before change:  [0.30709169]
curr_Stock_Price:  100.25340359394853
curr_Factors:  [100.25340359]
mat_Sqrt:  [[0.15]]
grads:  [-0.04641818]
Stock Position:  -0.04641818060495843
Bond Position:  [4.96067229]


portfolio before change:  [0.33727409]
curr_Stock_Price:  99.60985521297722
curr_Factors:  [99.60985521]
mat_Sqrt:  [[0.15]]
grads:  [0.03908144]
Stock Position:  0.039081441340430005
Bond Position:  [-3.55562262]


portfolio before change:  [0.34415501]
curr_Stock_Price:  99.79160785583333
curr_Factors:  [99.79160786]
mat_Sqrt:  [[0.15]]
grads:  [-0.04828534]
Stock Position:  -0.048285340728210065
Bond Position:  [5.1626268]


portfolio before change:  [0.37918511]
curr_Stock_Price:  99.07280942645787
curr_Factors:  [99.07280943]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962159]
Stock Position:  -0.009621590940587788
Bond Position:  [1.33242316]


portfolio before change:  [0.37315388]
curr_Stock_Price:  99.70830837021873
curr_Factors:  [99.70830837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0013391]
Stock Position:  -0.0013390974540170599
Bond Position:  [0.50667302]


portfolio before change:  [0.37383249]
curr_Stock_Price:  99.22519439278113
curr_Factors:  [99.22519439]
mat_Sqrt:  [[0.15]]
grads:  [-0.06956046]
Stock Position:  -0.0695604627018751
Bond Position:  [7.27598292]


portfolio before change:  [0.34777967]
curr_Stock_Price:  99.60626685602716
curr_Factors:  [99.60626686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00146792]
Stock Position:  -0.00146792119458342
Bond Position:  [0.49399382]


portfolio before change:  [0.34756221]
curr_Stock_Price:  99.77544469694949
curr_Factors:  [99.7754447]
mat_Sqrt:  [[0.15]]
grads:  [0.03162051]
Stock Position:  0.031620514260249206
Bond Position:  [-2.80738866]


portfolio before change:  [0.32708756]
curr_Stock_Price:  99.13348228646475
curr_Factors:  [99.13348229]
mat_Sqrt:  [[0.15]]
grads:  [0.08166168]
Stock Position:  0.08166168331991279
Bond Position:  [-7.76831948]


portfolio before change:  [0.26987326]
curr_Stock_Price:  98.43880192634848
curr_Factors:  [98.43880193]
mat_Sqrt:  [[0.15]]
grads:  [0.11439418]
Stock Position:  0.11439418071228856
Bond Position:  [-10.99095284]


portfolio before change:  [0.25841984]
curr_Stock_Price:  98.34468468493023
curr_Factors:  [98.34468468]
mat_Sqrt:  [[0.15]]
grads:  [-0.23127629]
Stock Position:  -0.23127628541584272
Bond Position:  [23.0032132]


portfolio before change:  [0.36878385]
curr_Stock_Price:  97.87370569745335
curr_Factors:  [97.8737057]
mat_Sqrt:  [[0.15]]
grads:  [0.05857449]
Stock Position:  0.05857449309367456
Bond Position:  [-5.36411884]


portfolio before change:  [0.38928911]
curr_Stock_Price:  98.22950091481059
curr_Factors:  [98.22950091]
mat_Sqrt:  [[0.15]]
grads:  [-0.12529984]
Stock Position:  -0.1252998388331668
Bond Position:  [12.69742974]


portfolio before change:  [0.29850949]
curr_Stock_Price:  98.96033376599595
curr_Factors:  [98.96033377]
mat_Sqrt:  [[0.15]]
grads:  [0.16252676]
Stock Position:  0.16252676032633123
Bond Position:  [-15.78519296]


portfolio before change:  [0.44248904]
curr_Stock_Price:  99.8522863049656
curr_Factors:  [99.8522863]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250355]
Stock Position:  -0.042503545872795055
Bond Position:  [4.68656527]


portfolio before change:  [0.41437924]
curr_Stock_Price:  100.52052986641972
curr_Factors:  [100.52052987]
mat_Sqrt:  [[0.15]]
grads:  [-0.09271005]
Stock Position:  -0.09271004629622172
Bond Position:  [9.73364221]


portfolio before change:  [0.42378816]
curr_Stock_Price:  100.42560431984249
curr_Factors:  [100.42560432]
mat_Sqrt:  [[0.15]]
grads:  [0.15554873]
Stock Position:  0.15554873320072582
Bond Position:  [-15.19728737]


portfolio before change:  [0.44545339]
curr_Stock_Price:  100.57099341867709
curr_Factors:  [100.57099342]
mat_Sqrt:  [[0.15]]
grads:  [0.02164921]
Stock Position:  0.021649205212981082
Bond Position:  [-1.73182869]


portfolio before change:  [0.44754223]
curr_Stock_Price:  100.6724792445957
curr_Factors:  [100.67247924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017208]
Stock Position:  -0.05017208052948206
Bond Position:  [5.49848997]


portfolio before change:  [0.44110554]
curr_Stock_Price:  100.80762128696593
curr_Factors:  [100.80762129]
mat_Sqrt:  [[0.15]]
grads:  [0.01311031]
Stock Position:  0.013110305635921915
Bond Position:  [-0.88051318]


portfolio before change:  [0.44528142]
curr_Stock_Price:  101.13033778500092
curr_Factors:  [101.13033779]
mat_Sqrt:  [[0.15]]
grads:  [0.0724509]
Stock Position:  0.07245090328558229
Bond Position:  [-6.8817029]


portfolio before change:  [0.48667363]
curr_Stock_Price:  101.70758842127688
curr_Factors:  [101.70758842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01914576]
Stock Position:  -0.01914576368078832
Bond Position:  [2.43394308]


portfolio before change:  [0.48171673]
curr_Stock_Price:  101.97443742340255
curr_Factors:  [101.97443742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03473958]
Stock Position:  -0.03473957787591139
Bond Position:  [4.02426564]


portfolio before change:  [0.48943369]
curr_Stock_Price:  101.75954035795804
curr_Factors:  [101.75954036]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016231]
Stock Position:  -0.05016230801700819
Bond Position:  [5.59392709]


portfolio before change:  [0.47031417]
curr_Stock_Price:  102.1476633877823
curr_Factors:  [102.14766339]
mat_Sqrt:  [[0.15]]
grads:  [-0.17296169]
Stock Position:  -0.17296168510358534
Bond Position:  [18.13794616]


portfolio before change:  [0.63847716]
curr_Stock_Price:  101.18196202828756
curr_Factors:  [101.18196203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0340844]
Stock Position:  -0.034084397723795894
Bond Position:  [4.0872034]


portfolio before change:  [0.62872703]
curr_Stock_Price:  101.47551558074744
curr_Factors:  [101.47551558]
mat_Sqrt:  [[0.15]]
grads:  [-0.0210342]
Stock Position:  -0.021034200542054515
Bond Position:  [2.76318337]


portfolio before change:  [0.64248043]
curr_Stock_Price:  100.82986688155313
curr_Factors:  [100.82986688]
mat_Sqrt:  [[0.15]]
grads:  [0.03533097]
Stock Position:  0.03533096961821047
Bond Position:  [-2.91993653]


portfolio before change:  [0.63473586]
curr_Stock_Price:  100.61583160222902
curr_Factors:  [100.6158316]
mat_Sqrt:  [[0.15]]
grads:  [0.03362525]
Stock Position:  0.03362524575782519
Bond Position:  [-2.74849621]


portfolio before change:  [0.63418038]
curr_Stock_Price:  100.6044208829597
curr_Factors:  [100.60442088]
mat_Sqrt:  [[0.15]]
grads:  [-0.0237551]
Stock Position:  -0.02375510321076392
Bond Position:  [3.02404879]


portfolio before change:  [0.62860971]
curr_Stock_Price:  100.8468819134659
curr_Factors:  [100.84688191]
mat_Sqrt:  [[0.15]]
grads:  [0.02749512]
Stock Position:  0.02749511686171085
Bond Position:  [-2.1441871]


portfolio before change:  [0.61165947]
curr_Stock_Price:  100.2352745140644
curr_Factors:  [100.23527451]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151852]
Stock Position:  -0.0015185236563574687
Bond Position:  [0.76386911]


portfolio before change:  [0.61216078]
curr_Stock_Price:  99.93658780941497
curr_Factors:  [99.93658781]
mat_Sqrt:  [[0.15]]
grads:  [0.01037302]
Stock Position:  0.010373019851953628
Bond Position:  [-0.42448343]


portfolio before change:  [0.60734965]
curr_Stock_Price:  99.4753337952491
curr_Factors:  [99.4753338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754566]
Stock Position:  -0.027545663777140083
Bond Position:  [3.34746375]


portfolio before change:  [0.60042838]
curr_Stock_Price:  99.73419481568027
curr_Factors:  [99.73419482]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [0.00145809]


portfolio before change:  [0.59505394]
curr_Stock_Price:  98.83928489260163
curr_Factors:  [98.83928489]
mat_Sqrt:  [[0.15]]
grads:  [-0.01972536]
Stock Position:  -0.01972536214423749
Bond Position:  [2.54469462]


portfolio before change:  [0.59025048]
curr_Stock_Price:  99.0908646437773
curr_Factors:  [99.09086464]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023186]
Stock Position:  -0.0023185981368748984
Bond Position:  [0.82000238]


portfolio before change:  [0.59035506]
curr_Stock_Price:  99.06786712476821
curr_Factors:  [99.06786712]
mat_Sqrt:  [[0.15]]
grads:  [-0.11391999]
Stock Position:  -0.11391999147094309
Bond Position:  [11.87616563]


portfolio before change:  [0.6274241]
curr_Stock_Price:  98.74898755897811
curr_Factors:  [98.74898756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08805443]
Stock Position:  -0.0880544255501118
Bond Position:  [9.32270947]


portfolio before change:  [0.56443102]
curr_Stock_Price:  99.4709929370877
curr_Factors:  [99.47099294]
mat_Sqrt:  [[0.15]]
grads:  [0.00384127]
Stock Position:  0.0038412732118833087
Bond Position:  [0.18233576]


portfolio before change:  [0.56862492]
curr_Stock_Price:  100.55982705302857
curr_Factors:  [100.55982705]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624326]
Stock Position:  -0.03624325774171651
Bond Position:  [4.21324065]


portfolio before change:  [0.56967434]
curr_Stock_Price:  100.53813803617436
curr_Factors:  [100.53813804]
mat_Sqrt:  [[0.15]]
grads:  [0.15020076]
Stock Position:  0.1502007561199343
Bond Position:  [-14.53123001]


portfolio before change:  [0.68197234]
curr_Stock_Price:  101.29183752896262
curr_Factors:  [101.29183753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05501217]
Stock Position:  -0.05501217030501389
Bond Position:  [6.25425616]


portfolio before change:  [0.7188135]
curr_Stock_Price:  100.62925219285741
curr_Factors:  [100.62925219]
mat_Sqrt:  [[0.15]]
grads:  [0.05746915]
Stock Position:  0.05746915114615829
Bond Position:  [-5.0642642]


portfolio before change:  [0.73700691]
curr_Stock_Price:  100.95133688579148
curr_Factors:  [100.95133689]
mat_Sqrt:  [[0.15]]
grads:  [-0.07293409]
Stock Position:  -0.07293408904428242
Bond Position:  [8.0998007]


portfolio before change:  [0.72800981]
curr_Stock_Price:  101.08163747940365
curr_Factors:  [101.08163748]
mat_Sqrt:  [[0.15]]
grads:  [0.07444996]
Stock Position:  0.07444996196193077
Bond Position:  [-6.79751426]


portfolio before change:  [0.73449635]
curr_Stock_Price:  101.17447031447823
curr_Factors:  [101.17447031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04489902]
Stock Position:  -0.044899018525032565
Bond Position:  [5.27713077]


portfolio before change:  [0.74790546]
curr_Stock_Price:  100.88316590074702
curr_Factors:  [100.8831659]
mat_Sqrt:  [[0.15]]
grads:  [0.11613225]
Stock Position:  0.1161322458166734
Bond Position:  [-10.96788316]


portfolio before change:  [0.90967515]
curr_Stock_Price:  102.28204695851436
curr_Factors:  [102.28204696]
mat_Sqrt:  [[0.15]]
grads:  [-0.14987902]
Stock Position:  -0.14987902296984587
Bond Position:  [16.23960841]


portfolio before change:  [0.84762413]
curr_Stock_Price:  102.70282648047717
curr_Factors:  [102.70282648]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727292]
Stock Position:  -0.00727291824787203
Bond Position:  [1.59457339]


portfolio before change:  [0.84518667]
curr_Stock_Price:  103.05167230133243
curr_Factors:  [103.0516723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05597927]
Stock Position:  -0.055979271092130675
Bond Position:  [6.61394417]


portfolio before change:  [0.87416053]
curr_Stock_Price:  102.54147489559688
curr_Factors:  [102.5414749]
mat_Sqrt:  [[0.15]]
grads:  [-0.01862393]
Stock Position:  -0.01862392623323438
Bond Position:  [2.7838854]


portfolio before change:  [0.8763744]
curr_Stock_Price:  102.43194543773943
curr_Factors:  [102.43194544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.8763744]
Stock Price:  102.29273974216503
PL:  [-1.41636534]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.59527907e-04]
 [-7.21263160e-03]
 [-3.76719467e-03]
 [-2.88927030e-03]
 [ 5.22015816e-02]
 [ 2.61625786e-02]
 [ 5.53976624e-03]
 [ 2.08711637e-02]
 [ 2.43505846e-02]
 [ 3.64486814e-03]
 [ 6.29875178e-02]
 [ 7.89714527e-02]
 [ 1.60962681e-01]
 [ 2.71452406e-02]
 [-6.89005394e-03]
 [ 4.19844352e-02]
 [ 2.04788346e-02]
 [ 1.42992741e-02]
 [ 1.73944013e-02]
 [-1.14677183e-02]
 [ 1.58717243e-02]
 [-2.45125834e-02]
 [ 9.70926613e-03]
 [-1.13177653e-01]
 [ 1.62497242e-02]
 [ 4.74144768e-03]
 [-2.04179826e-03]
 [ 3.14680159e-02]
 [ 8.54045743e-02]
 [ 1.87218081e-02]
 [ 2.82949699e-02]
 [ 3.18418771e-02]
 [-1.14594176e-02]
 [ 5.22310686e-03]
 [ 9.19145298e-03]
 [-5.54908279e-04]
 [-3.05119833e-02]
 [ 7.78923770e-03]
 [ 3.30468539e-02]
 [-4.71559714e-02]
 [-1.49956743e-02]
 [-7.12724710e-03]
 [ 1.89054150e-02]
 [-9.56983080e-03]
 [ 2.53515702e-02]
 [-4.38097300e-03]
 [ 1.53623360e-02]
 [ 2.56839139e-02]
 [ 9.92150379e-03]
 [-7.72323587e-03]
 [ 1.91493002e-02]
 [ 4.91414608e-03]
 [-9.87521374e-03]
 [ 5.82852071e-03]
 [-1.89594889e-02]
 [ 2.35542850e-02]
 [ 1.40329778e-02]
 [ 1.10366178e-03]
 [ 1.83651160e-03]
 [ 8.40383368e-03]
 [ 1.24518364e-02]
 [ 2.41487733e-02]
 [ 4.08348407e-03]
 [-1.25381187e-02]
 [ 4.54632340e-03]
 [ 1.67787972e-03]
 [-5.41662739e-03]
 [ 1.50197917e-02]
 [-8.25082270e-03]
 [ 1.06940463e-02]
 [-1.12091230e-02]
 [ 1.14594787e-02]
 [-8.33183630e-03]
 [ 1.76107784e-02]
 [-2.24489408e-02]
 [-4.27073277e-03]
 [-5.33632347e-03]
 [-1.47860996e-03]
 [ 1.15107619e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.67465917]
curr_Stock_Price:  100.95151558279451
curr_Factors:  [100.95151558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00173019]
Stock Position:  -0.0017301860463024218
Bond Position:  [16.84932408]


portfolio before change:  [16.67402587]
curr_Stock_Price:  101.92622064769485
curr_Factors:  [101.92622065]
mat_Sqrt:  [[0.15]]
grads:  [-0.04808421]
Stock Position:  -0.0480842106891796
Bond Position:  [21.57506773]


portfolio before change:  [16.67295051]
curr_Stock_Price:  101.9766289059106
curr_Factors:  [101.97662891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511463]
Stock Position:  -0.02511463113892054
Bond Position:  [19.23405593]


portfolio before change:  [16.66354896]
curr_Stock_Price:  102.39884140364495
curr_Factors:  [102.3988414]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192618]
Stock Position:  -0.01926180198892844
Bond Position:  [18.63593517]


portfolio before change:  [16.64963123]
curr_Stock_Price:  103.18186873604247
curr_Factors:  [103.18186874]
mat_Sqrt:  [[0.15]]
grads:  [0.34801054]
Stock Position:  0.34801054403398707
Bond Position:  [-19.25874704]


portfolio before change:  [16.66000921]
curr_Stock_Price:  103.21514845134705
curr_Factors:  [103.21514845]
mat_Sqrt:  [[0.15]]
grads:  [0.17441719]
Stock Position:  0.174417190556196
Bond Position:  [-1.342487]


portfolio before change:  [16.69253888]
curr_Stock_Price:  103.40213448905695
curr_Factors:  [103.40213449]
mat_Sqrt:  [[0.15]]
grads:  [0.03693177]
Stock Position:  0.036931774964749496
Bond Position:  [12.87371452]


portfolio before change:  [16.6927138]
curr_Stock_Price:  103.38508368255431
curr_Factors:  [103.38508368]
mat_Sqrt:  [[0.15]]
grads:  [0.13914109]
Stock Position:  0.13914109108594408
Bond Position:  [2.30760045]


portfolio before change:  [16.74336844]
curr_Stock_Price:  103.74809943864153
curr_Factors:  [103.74809944]
mat_Sqrt:  [[0.15]]
grads:  [0.16233723]
Stock Position:  0.1623372308759961
Bond Position:  [-0.09881074]


portfolio before change:  [16.8973642]
curr_Stock_Price:  104.69675391282397
curr_Factors:  [104.69675391]
mat_Sqrt:  [[0.15]]
grads:  [0.02429912]
Stock Position:  0.024299120944238778
Bond Position:  [14.35332511]


portfolio before change:  [16.88169316]
curr_Stock_Price:  104.01491238537861
curr_Factors:  [104.01491239]
mat_Sqrt:  [[0.15]]
grads:  [0.41991679]
Stock Position:  0.4199167852246305
Bond Position:  [-26.79591446]


portfolio before change:  [16.69555038]
curr_Stock_Price:  103.57561586748929
curr_Factors:  [103.57561587]
mat_Sqrt:  [[0.15]]
grads:  [0.52647635]
Stock Position:  0.5264763513927095
Bond Position:  [-37.83456195]


portfolio before change:  [17.168744]
curr_Stock_Price:  104.47890117623659
curr_Factors:  [104.47890118]
mat_Sqrt:  [[0.15]]
grads:  [1.07308454]
Stock Position:  1.0730845412575862
Bond Position:  [-94.94594974]


portfolio before change:  [18.42297552]
curr_Stock_Price:  105.65324091923442
curr_Factors:  [105.65324092]
mat_Sqrt:  [[0.15]]
grads:  [0.18096827]
Stock Position:  0.1809682706107242
Bond Position:  [-0.69690877]


portfolio before change:  [18.53521038]
curr_Stock_Price:  106.27367242838399
curr_Factors:  [106.27367243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04593369]
Stock Position:  -0.04593369291718413
Bond Position:  [23.41675261]


portfolio before change:  [18.54757544]
curr_Stock_Price:  106.03634192790324
curr_Factors:  [106.03634193]
mat_Sqrt:  [[0.15]]
grads:  [0.27989623]
Stock Position:  0.27989623481712084
Bond Position:  [-11.13159742]


portfolio before change:  [18.67375931]
curr_Stock_Price:  106.48965141314702
curr_Factors:  [106.48965141]
mat_Sqrt:  [[0.15]]
grads:  [0.13652556]
Stock Position:  0.1365255640081406
Bond Position:  [4.13519959]


portfolio before change:  [18.53088924]
curr_Stock_Price:  105.44128708374728
curr_Factors:  [105.44128708]
mat_Sqrt:  [[0.15]]
grads:  [0.09532849]
Stock Position:  0.09532849368097579
Bond Position:  [8.47933017]


portfolio before change:  [18.49370817]
curr_Stock_Price:  105.04569663711271
curr_Factors:  [105.04569664]
mat_Sqrt:  [[0.15]]
grads:  [0.11596268]
Stock Position:  0.11596267547811852
Bond Position:  [6.31232814]


portfolio before change:  [18.56905024]
curr_Stock_Price:  105.69200403231537
curr_Factors:  [105.69200403]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645146]
Stock Position:  -0.07645145516421369
Bond Position:  [26.64935774]


portfolio before change:  [18.54727426]
curr_Stock_Price:  105.998624926021
curr_Factors:  [105.99862493]
mat_Sqrt:  [[0.15]]
grads:  [0.1058115]
Stock Position:  0.10581149527179784
Bond Position:  [7.33140126]


portfolio before change:  [18.59456525]
curr_Stock_Price:  106.44123054328887
curr_Factors:  [106.44123054]
mat_Sqrt:  [[0.15]]
grads:  [-0.16341722]
Stock Position:  -0.16341722276551332
Bond Position:  [35.98889553]


portfolio before change:  [18.71939741]
curr_Stock_Price:  105.69110898332121
curr_Factors:  [105.69110898]
mat_Sqrt:  [[0.15]]
grads:  [0.06472844]
Stock Position:  0.06472844085228383
Bond Position:  [11.87817671]


portfolio before change:  [18.78051178]
curr_Stock_Price:  106.62380510050833
curr_Factors:  [106.6238051]
mat_Sqrt:  [[0.15]]
grads:  [-0.75451769]
Stock Position:  -0.7545176882669661
Bond Position:  [99.23005872]


portfolio before change:  [18.87414255]
curr_Stock_Price:  106.50793147850666
curr_Factors:  [106.50793148]
mat_Sqrt:  [[0.15]]
grads:  [0.10833149]
Stock Position:  0.10833149473221305
Bond Position:  [7.33597913]


portfolio before change:  [18.90886789]
curr_Stock_Price:  106.8242459751276
curr_Factors:  [106.82424598]
mat_Sqrt:  [[0.15]]
grads:  [0.03160965]
Stock Position:  0.0316096511739549
Bond Position:  [15.53219074]


portfolio before change:  [18.9455361]
curr_Stock_Price:  107.95356634666457
curr_Factors:  [107.95356635]
mat_Sqrt:  [[0.15]]
grads:  [-0.01361199]
Stock Position:  -0.013611988369441113
Bond Position:  [20.41499879]


portfolio before change:  [18.94831915]
curr_Stock_Price:  107.84285031200073
curr_Factors:  [107.84285031]
mat_Sqrt:  [[0.15]]
grads:  [0.20978677]
Stock Position:  0.20978677285434508
Bond Position:  [-3.6756844]


portfolio before change:  [18.92487531]
curr_Stock_Price:  107.73219461354813
curr_Factors:  [107.73219461]
mat_Sqrt:  [[0.15]]
grads:  [0.56936383]
Stock Position:  0.5693638286140442
Bond Position:  [-42.41393948]


portfolio before change:  [19.58859607]
curr_Stock_Price:  108.90257404521768
curr_Factors:  [108.90257405]
mat_Sqrt:  [[0.15]]
grads:  [0.12481205]
Stock Position:  0.12481205403535096
Bond Position:  [5.99624211]


portfolio before change:  [19.56765643]
curr_Stock_Price:  108.73180198358477
curr_Factors:  [108.73180198]
mat_Sqrt:  [[0.15]]
grads:  [0.18863313]
Stock Position:  0.18863313280573715
Bond Position:  [-0.94276401]


portfolio before change:  [19.67788405]
curr_Stock_Price:  109.31646354153138
curr_Factors:  [109.31646354]
mat_Sqrt:  [[0.15]]
grads:  [0.21227918]
Stock Position:  0.21227918087973377
Bond Position:  [-3.52772529]


portfolio before change:  [19.70750132]
curr_Stock_Price:  109.45702260778313
curr_Factors:  [109.45702261]
mat_Sqrt:  [[0.15]]
grads:  [-0.07639612]
Stock Position:  -0.07639611733823705
Bond Position:  [28.06959286]


portfolio before change:  [19.70011659]
curr_Stock_Price:  109.57665087654793
curr_Factors:  [109.57665088]
mat_Sqrt:  [[0.15]]
grads:  [0.03482071]
Stock Position:  0.034820712425671
Bond Position:  [15.88457954]


portfolio before change:  [19.70086286]
curr_Stock_Price:  109.56957030424165
curr_Factors:  [109.5695703]
mat_Sqrt:  [[0.15]]
grads:  [0.06127635]
Stock Position:  0.06127635318876256
Bond Position:  [12.98683917]


portfolio before change:  [19.62578051]
curr_Stock_Price:  108.33101669836418
curr_Factors:  [108.3310167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369939]
Stock Position:  -0.0036993885239725833
Bond Position:  [20.02653903]


portfolio before change:  [19.62548163]
curr_Stock_Price:  108.75016229662242
curr_Factors:  [108.7501623]
mat_Sqrt:  [[0.15]]
grads:  [-0.20341322]
Stock Position:  -0.2034132222054879
Bond Position:  [41.74670256]


portfolio before change:  [19.47186573]
curr_Stock_Price:  109.51818093920976
curr_Factors:  [109.51818094]
mat_Sqrt:  [[0.15]]
grads:  [0.05192825]
Stock Position:  0.051928251314038366
Bond Position:  [13.78477811]


portfolio before change:  [19.47460684]
curr_Stock_Price:  109.55437570376938
curr_Factors:  [109.5543757]
mat_Sqrt:  [[0.15]]
grads:  [0.22031236]
Stock Position:  0.22031235916921563
Bond Position:  [-4.66157613]


portfolio before change:  [19.60349457]
curr_Stock_Price:  110.1407209029554
curr_Factors:  [110.1407209]
mat_Sqrt:  [[0.15]]
grads:  [-0.31437314]
Stock Position:  -0.3143731428242964
Bond Position:  [54.22877916]


portfolio before change:  [19.42215066]
curr_Stock_Price:  110.7283452693795
curr_Factors:  [110.72834527]
mat_Sqrt:  [[0.15]]
grads:  [-0.09997116]
Stock Position:  -0.09997116219141455
Bond Position:  [30.49179202]


portfolio before change:  [19.53844956]
curr_Stock_Price:  109.58408421233392
curr_Factors:  [109.58408421]
mat_Sqrt:  [[0.15]]
grads:  [-0.04751498]
Stock Position:  -0.047514980663660215
Bond Position:  [24.74533521]


portfolio before change:  [19.55584413]
curr_Stock_Price:  109.25054859810054
curr_Factors:  [109.2505486]
mat_Sqrt:  [[0.15]]
grads:  [0.1260361]
Stock Position:  0.12603610029150197
Bond Position:  [5.78633103]


portfolio before change:  [19.37643718]
curr_Stock_Price:  107.82422222877341
curr_Factors:  [107.82422223]
mat_Sqrt:  [[0.15]]
grads:  [-0.06379887]
Stock Position:  -0.063798871987616
Bond Position:  [26.25550093]


portfolio before change:  [19.42361405]
curr_Stock_Price:  107.11048148451539
curr_Factors:  [107.11048148]
mat_Sqrt:  [[0.15]]
grads:  [0.16901047]
Stock Position:  0.16901046808744072
Bond Position:  [1.32082144]


portfolio before change:  [19.43508578]
curr_Stock_Price:  107.17786884440933
curr_Factors:  [107.17786884]
mat_Sqrt:  [[0.15]]
grads:  [-0.02920649]
Stock Position:  -0.029206486690092952
Bond Position:  [22.56537478]


portfolio before change:  [19.44971191]
curr_Stock_Price:  106.725374871077
curr_Factors:  [106.72537487]
mat_Sqrt:  [[0.15]]
grads:  [0.10241557]
Stock Position:  0.1024155735086221
Bond Position:  [8.51937144]


portfolio before change:  [19.42036325]
curr_Stock_Price:  106.43361120411032
curr_Factors:  [106.4336112]
mat_Sqrt:  [[0.15]]
grads:  [0.17122609]
Stock Position:  0.1712260923993362
Bond Position:  [1.1961519]


portfolio before change:  [19.39114642]
curr_Stock_Price:  106.26254155791715
curr_Factors:  [106.26254156]
mat_Sqrt:  [[0.15]]
grads:  [0.06614336]
Stock Position:  0.06614335859362701
Bond Position:  [12.36258503]


portfolio before change:  [19.41256906]
curr_Stock_Price:  106.57474147216024
curr_Factors:  [106.57474147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05148824]
Stock Position:  -0.05148823914472624
Bond Position:  [24.89991484]


portfolio before change:  [19.45409409]
curr_Stock_Price:  105.79847231721045
curr_Factors:  [105.79847232]
mat_Sqrt:  [[0.15]]
grads:  [0.127662]
Stock Position:  0.12766200110934572
Bond Position:  [5.9476494]


portfolio before change:  [19.47439498]
curr_Stock_Price:  105.95458104464609
curr_Factors:  [105.95458104]
mat_Sqrt:  [[0.15]]
grads:  [0.03276097]
Stock Position:  0.03276097385495012
Bond Position:  [16.00321972]


portfolio before change:  [19.45637846]
curr_Stock_Price:  105.37411138886112
curr_Factors:  [105.37411139]
mat_Sqrt:  [[0.15]]
grads:  [-0.06583476]
Stock Position:  -0.06583475827020634
Bond Position:  [26.39365761]


portfolio before change:  [19.40952083]
curr_Stock_Price:  106.11091496057841
curr_Factors:  [106.11091496]
mat_Sqrt:  [[0.15]]
grads:  [0.0388568]
Stock Position:  0.038856804747483556
Bond Position:  [15.28638973]


portfolio before change:  [19.41710306]
curr_Stock_Price:  106.28145914760215
curr_Factors:  [106.28145915]
mat_Sqrt:  [[0.15]]
grads:  [-0.12639659]
Stock Position:  -0.12639659295001346
Bond Position:  [32.85071739]


portfolio before change:  [19.49336638]
curr_Stock_Price:  105.69433822863196
curr_Factors:  [105.69433823]
mat_Sqrt:  [[0.15]]
grads:  [0.15702857]
Stock Position:  0.15702856656615083
Bond Position:  [2.89633595]


portfolio before change:  [19.52223432]
curr_Stock_Price:  105.87702422068915
curr_Factors:  [105.87702422]
mat_Sqrt:  [[0.15]]
grads:  [0.09355319]
Stock Position:  0.09355318566630215
Bond Position:  [9.61710142]


portfolio before change:  [19.47293989]
curr_Stock_Price:  105.34368564617073
curr_Factors:  [105.34368565]
mat_Sqrt:  [[0.15]]
grads:  [0.00735775]
Stock Position:  0.0073577451695308795
Bond Position:  [18.6978479]


portfolio before change:  [19.47112118]
curr_Stock_Price:  104.93766926644348
curr_Factors:  [104.93766927]
mat_Sqrt:  [[0.15]]
grads:  [0.01224341]
Stock Position:  0.012243410658862421
Bond Position:  [18.1863262]


portfolio before change:  [19.47536325]
curr_Stock_Price:  105.19130686834005
curr_Factors:  [105.19130687]
mat_Sqrt:  [[0.15]]
grads:  [0.05602556]
Stock Position:  0.056025557870364444
Bond Position:  [13.5819616]


portfolio before change:  [19.46948043]
curr_Stock_Price:  105.07115243165374
curr_Factors:  [105.07115243]
mat_Sqrt:  [[0.15]]
grads:  [0.08301224]
Stock Position:  0.083012242908582
Bond Position:  [10.7472884]


portfolio before change:  [19.39068715]
curr_Stock_Price:  104.11388392775808
curr_Factors:  [104.11388393]
mat_Sqrt:  [[0.15]]
grads:  [0.16099182]
Stock Position:  0.16099182225352657
Bond Position:  [2.62920325]


portfolio before change:  [19.34861167]
curr_Stock_Price:  103.85151155437734
curr_Factors:  [103.85151155]
mat_Sqrt:  [[0.15]]
grads:  [0.02722323]
Stock Position:  0.027223227127813138
Bond Position:  [16.52143838]


portfolio before change:  [19.34491267]
curr_Stock_Price:  103.67770323365511
curr_Factors:  [103.67770323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08358746]
Stock Position:  -0.08358745817110444
Bond Position:  [28.01106835]


portfolio before change:  [19.38283971]
curr_Stock_Price:  103.2449074870696
curr_Factors:  [103.24490749]
mat_Sqrt:  [[0.15]]
grads:  [0.03030882]
Stock Position:  0.03030882266231472
Bond Position:  [16.25360812]


portfolio before change:  [19.37262003]
curr_Stock_Price:  102.87420481132301
curr_Factors:  [102.87420481]
mat_Sqrt:  [[0.15]]
grads:  [0.01118586]
Stock Position:  0.011185864811579077
Bond Position:  [18.22188309]


portfolio before change:  [19.38136225]
curr_Stock_Price:  103.55392994469538
curr_Factors:  [103.55392994]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611085]
Stock Position:  -0.03611084928734499
Bond Position:  [23.12078261]


portfolio before change:  [19.39013008]
curr_Stock_Price:  103.3511449819444
curr_Factors:  [103.35114498]
mat_Sqrt:  [[0.15]]
grads:  [0.10013194]
Stock Position:  0.10013194448716302
Bond Position:  [9.04137897]


portfolio before change:  [19.30661508]
curr_Stock_Price:  102.51145186984485
curr_Factors:  [102.51145187]
mat_Sqrt:  [[0.15]]
grads:  [-0.05500548]
Stock Position:  -0.05500548468448369
Bond Position:  [24.94530718]


portfolio before change:  [19.3237294]
curr_Stock_Price:  102.22865842234732
curr_Factors:  [102.22865842]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [12.03547602]


portfolio before change:  [19.25965818]
curr_Stock_Price:  101.31941233883819
curr_Factors:  [101.31941234]
mat_Sqrt:  [[0.15]]
grads:  [-0.07472749]
Stock Position:  -0.07472748642614817
Bond Position:  [26.83100319]


portfolio before change:  [19.25136386]
curr_Stock_Price:  101.45284794850684
curr_Factors:  [101.45284795]
mat_Sqrt:  [[0.15]]
grads:  [0.07639652]
Stock Position:  0.07639652476762848
Bond Position:  [11.50071885]


portfolio before change:  [19.20682447]
curr_Stock_Price:  100.86043601691556
curr_Factors:  [100.86043602]
mat_Sqrt:  [[0.15]]
grads:  [-0.05554558]
Stock Position:  -0.05554557530161827
Bond Position:  [24.80917541]


portfolio before change:  [19.20150313]
curr_Stock_Price:  100.98415340942601
curr_Factors:  [100.98415341]
mat_Sqrt:  [[0.15]]
grads:  [0.11740519]
Stock Position:  0.11740518942815309
Bond Position:  [7.34543947]


portfolio before change:  [19.14179679]
curr_Stock_Price:  100.4716935318717
curr_Factors:  [100.47169353]
mat_Sqrt:  [[0.15]]
grads:  [-0.14965961]
Stock Position:  -0.1496596056507785
Bond Position:  [34.17835082]


portfolio before change:  [19.20634976]
curr_Stock_Price:  100.05463539845817
curr_Factors:  [100.0546354]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847155]
Stock Position:  -0.028471551798130955
Bond Position:  [22.05506049]


portfolio before change:  [19.21849274]
curr_Stock_Price:  99.67655621121817
curr_Factors:  [99.67655621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03557549]
Stock Position:  -0.035575489808566355
Bond Position:  [22.76453505]


portfolio before change:  [19.17874223]
curr_Stock_Price:  100.83390758466507
curr_Factors:  [100.83390758]
mat_Sqrt:  [[0.15]]
grads:  [-0.0098574]
Stock Position:  -0.009857399720119718
Bond Position:  [20.17270236]


portfolio before change:  [19.17757074]
curr_Stock_Price:  101.08065842324473
curr_Factors:  [101.08065842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.17757074]
Stock Price:  100.62633348320212
PL:  [18.55123726]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.67977882e-03]
 [ 2.42471113e-03]
 [-2.55323501e-03]
 [ 7.23070971e-03]
 [ 4.58295583e-03]
 [ 1.91666828e-02]
 [ 1.00426871e-03]
 [-1.87673516e-02]
 [ 1.16095364e-03]
 [ 2.01607075e-02]
 [ 4.73095226e-03]
 [ 2.11430519e-02]
 [-1.38299655e-02]
 [ 7.66047936e-03]
 [-6.97530551e-03]
 [ 6.54007094e-03]
 [ 7.27638720e-03]
 [-1.06644486e-02]
 [ 2.44752307e-04]
 [ 1.58018535e-02]
 [ 1.13511085e-02]
 [-8.03340311e-03]
 [ 6.82947214e-03]
 [ 4.27630885e-02]
 [-4.78329056e-03]
 [ 1.09202799e-02]
 [-7.21409355e-03]
 [ 5.74060810e-03]
 [-4.99587151e-03]
 [-2.67129549e-03]
 [ 3.26152424e-03]
 [-1.20416579e-02]
 [ 9.55660137e-03]
 [ 7.78143945e-03]
 [ 1.12529376e-02]
 [ 9.13557169e-03]
 [-3.39943339e-02]
 [ 9.76880349e-03]
 [ 2.90598687e-03]
 [ 1.57724556e-02]
 [-5.78674455e-03]
 [-1.81125638e-02]
 [ 2.20476729e-02]
 [ 1.11691373e-03]
 [-5.15506766e-03]
 [-2.02965201e-03]
 [ 1.13182117e-02]
 [-6.55319235e-03]
 [-8.68223695e-03]
 [-7.56668077e-03]
 [ 1.73480622e-02]
 [-3.93881538e-03]
 [-2.91369333e-03]
 [ 5.53266839e-03]
 [-6.55277718e-03]
 [ 6.39646250e-03]
 [ 1.00302285e-02]
 [ 8.75836085e-06]
 [ 1.67765130e-03]
 [ 1.54746970e-02]
 [-2.39404017e-03]
 [ 1.80104070e-02]
 [-8.27053883e-04]
 [-1.23973852e-02]
 [ 2.21012659e-03]
 [ 9.94553641e-04]
 [-5.41334781e-03]
 [ 1.53008206e-02]
 [-8.54337504e-03]
 [-8.08540995e-03]
 [-1.22295439e-02]
 [ 1.35593109e-02]
 [-2.98609236e-03]
 [ 2.46238526e-02]
 [-2.47598200e-02]
 [ 1.60128361e-03]
 [-4.06267656e-03]
 [-1.09928577e-02]
 [ 2.90821000e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.70665883]
curr_Stock_Price:  99.4311463411502
curr_Factors:  [99.43114634]
mat_Sqrt:  [[0.15]]
grads:  [0.03119853]
Stock Position:  0.03119852544338665
Bond Position:  [-9.80876398]


portfolio before change:  [-6.67417141]
curr_Stock_Price:  100.49210943422761
curr_Factors:  [100.49210943]
mat_Sqrt:  [[0.15]]
grads:  [0.01616474]
Stock Position:  0.01616474088231816
Bond Position:  [-8.29860032]


portfolio before change:  [-6.67353498]
curr_Stock_Price:  100.5635679379497
curr_Factors:  [100.56356794]
mat_Sqrt:  [[0.15]]
grads:  [-0.01702157]
Stock Position:  -0.017021566743603972
Bond Position:  [-4.9617855]


portfolio before change:  [-6.667101]
curr_Stock_Price:  100.1673590058212
curr_Factors:  [100.16735901]
mat_Sqrt:  [[0.15]]
grads:  [0.04820473]
Stock Position:  0.048204731385468796
Bond Position:  [-11.49564164]


portfolio before change:  [-6.6720729]
curr_Stock_Price:  100.07912296625273
curr_Factors:  [100.07912297]
mat_Sqrt:  [[0.15]]
grads:  [0.03055304]
Stock Position:  0.030553038850072486
Bond Position:  [-9.72979423]


portfolio before change:  [-6.69963736]
curr_Stock_Price:  99.19684300666215
curr_Factors:  [99.19684301]
mat_Sqrt:  [[0.15]]
grads:  [0.12777789]
Stock Position:  0.12777788544169674
Bond Position:  [-19.37480021]


portfolio before change:  [-6.68432297]
curr_Stock_Price:  99.32617177176071
curr_Factors:  [99.32617177]
mat_Sqrt:  [[0.15]]
grads:  [0.00669512]
Stock Position:  0.006695124707118983
Bond Position:  [-7.34932408]


portfolio before change:  [-6.68744982]
curr_Stock_Price:  98.9277476754093
curr_Factors:  [98.92774768]
mat_Sqrt:  [[0.15]]
grads:  [-0.12511568]
Stock Position:  -0.12511567717480712
Bond Position:  [5.68996233]


portfolio before change:  [-6.67889472]
curr_Stock_Price:  98.86221261184548
curr_Factors:  [98.86221261]
mat_Sqrt:  [[0.15]]
grads:  [0.00773969]
Stock Position:  0.007739690920305643
Bond Position:  [-7.44405769]


portfolio before change:  [-6.67877489]
curr_Stock_Price:  98.93780924422445
curr_Factors:  [98.93780924]
mat_Sqrt:  [[0.15]]
grads:  [0.13440472]
Stock Position:  0.13440471686679084
Bond Position:  [-19.97648313]


portfolio before change:  [-6.7109799]
curr_Stock_Price:  98.70748671084084
curr_Factors:  [98.70748671]
mat_Sqrt:  [[0.15]]
grads:  [0.03153968]
Stock Position:  0.03153968173577709
Bond Position:  [-9.82418261]


portfolio before change:  [-6.71030653]
curr_Stock_Price:  98.74830490707357
curr_Factors:  [98.74830491]
mat_Sqrt:  [[0.15]]
grads:  [0.14095368]
Stock Position:  0.1409536790269805
Bond Position:  [-20.62924341]


portfolio before change:  [-6.69426214]
curr_Stock_Price:  98.87127981012401
curr_Factors:  [98.87127981]
mat_Sqrt:  [[0.15]]
grads:  [-0.09219977]
Stock Position:  -0.09219977025365497
Bond Position:  [2.42164715]


portfolio before change:  [-6.68917056]
curr_Stock_Price:  98.81769809890464
curr_Factors:  [98.8176981]
mat_Sqrt:  [[0.15]]
grads:  [0.05106986]
Stock Position:  0.05106986239775239
Bond Position:  [-11.7357768]


portfolio before change:  [-6.70681958]
curr_Stock_Price:  98.48647504478531
curr_Factors:  [98.48647504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04650204]
Stock Position:  -0.04650203675694769
Bond Position:  [-2.1269979]


portfolio before change:  [-6.72797572]
curr_Stock_Price:  98.93856697931287
curr_Factors:  [98.93856698]
mat_Sqrt:  [[0.15]]
grads:  [0.04360047]
Stock Position:  0.043600472910185185
Bond Position:  [-11.04174403]


portfolio before change:  [-6.7314413]
curr_Stock_Price:  98.87491059850139
curr_Factors:  [98.8749106]
mat_Sqrt:  [[0.15]]
grads:  [0.04850925]
Stock Position:  0.048509248010456626
Bond Position:  [-11.52778886]


portfolio before change:  [-6.72060094]
curr_Stock_Price:  99.11323349509752
curr_Factors:  [99.1132335]
mat_Sqrt:  [[0.15]]
grads:  [-0.07109632]
Stock Position:  -0.07109632371774709
Bond Position:  [0.32598559]


portfolio before change:  [-6.71053721]
curr_Stock_Price:  98.97196942814428
curr_Factors:  [98.97196943]
mat_Sqrt:  [[0.15]]
grads:  [0.00163168]
Stock Position:  0.0016316820433839574
Bond Position:  [-6.872028]


portfolio before change:  [-6.71021798]
curr_Stock_Price:  99.43084811235454
curr_Factors:  [99.43084811]
mat_Sqrt:  [[0.15]]
grads:  [0.10534569]
Stock Position:  0.10534568989851302
Bond Position:  [-17.18482928]


portfolio before change:  [-6.66651817]
curr_Stock_Price:  99.85586688404807
curr_Factors:  [99.85586688]
mat_Sqrt:  [[0.15]]
grads:  [0.07567406]
Stock Position:  0.07567405635060405
Bond Position:  [-14.22301667]


portfolio before change:  [-6.68325021]
curr_Stock_Price:  99.64650755737513
curr_Factors:  [99.64650756]
mat_Sqrt:  [[0.15]]
grads:  [-0.05355602]
Stock Position:  -0.053556020743430355
Bond Position:  [-1.34657978]


portfolio before change:  [-6.71339358]
curr_Stock_Price:  100.20777424633023
curr_Factors:  [100.20777425]
mat_Sqrt:  [[0.15]]
grads:  [0.04552981]
Stock Position:  0.0455298142730301
Bond Position:  [-11.27583493]


portfolio before change:  [-6.72828882]
curr_Stock_Price:  99.8960998450108
curr_Factors:  [99.89609985]
mat_Sqrt:  [[0.15]]
grads:  [0.28508726]
Stock Position:  0.28508725688913267
Bond Position:  [-35.2073939]


portfolio before change:  [-6.78921115]
curr_Stock_Price:  99.69012151415325
curr_Factors:  [99.69012151]
mat_Sqrt:  [[0.15]]
grads:  [-0.0318886]
Stock Position:  -0.0318886037504516
Bond Position:  [-3.61023237]


portfolio before change:  [-6.79735847]
curr_Stock_Price:  99.9385385385731
curr_Factors:  [99.93853854]
mat_Sqrt:  [[0.15]]
grads:  [0.07280187]
Stock Position:  0.0728018657455412
Bond Position:  [-14.07307054]


portfolio before change:  [-6.79648782]
curr_Stock_Price:  99.96257977849986
curr_Factors:  [99.96257978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04809396]
Stock Position:  -0.04809395701372615
Bond Position:  [-1.9888918]


portfolio before change:  [-6.80069384]
curr_Stock_Price:  100.04744931784126
curr_Factors:  [100.04744932]
mat_Sqrt:  [[0.15]]
grads:  [0.03827072]
Stock Position:  0.038270720684197075
Bond Position:  [-10.62958183]


portfolio before change:  [-6.80600332]
curr_Stock_Price:  99.92607430455396
curr_Factors:  [99.9260743]
mat_Sqrt:  [[0.15]]
grads:  [-0.03330581]
Stock Position:  -0.03330581007560597
Bond Position:  [-3.47788447]


portfolio before change:  [-6.8090356]
curr_Stock_Price:  100.01059141662647
curr_Factors:  [100.01059142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01780864]
Stock Position:  -0.017808636598876288
Bond Position:  [-5.02798332]


portfolio before change:  [-6.80992835]
curr_Stock_Price:  100.04307505983375
curr_Factors:  [100.04307506]
mat_Sqrt:  [[0.15]]
grads:  [0.02174349]
Stock Position:  0.021743494931490387
Bond Position:  [-8.98521445]


portfolio before change:  [-6.79484729]
curr_Stock_Price:  100.76249296403923
curr_Factors:  [100.76249296]
mat_Sqrt:  [[0.15]]
grads:  [-0.08027772]
Stock Position:  -0.08027771913251139
Bond Position:  [1.29413582]


portfolio before change:  [-6.83398972]
curr_Stock_Price:  101.25108832954862
curr_Factors:  [101.25108833]
mat_Sqrt:  [[0.15]]
grads:  [0.06371068]
Stock Position:  0.06371067580175088
Bond Position:  [-13.28476498]


portfolio before change:  [-6.83533392]
curr_Stock_Price:  101.24302257216495
curr_Factors:  [101.24302257]
mat_Sqrt:  [[0.15]]
grads:  [0.05187626]
Stock Position:  0.05187626298609048
Bond Position:  [-12.08744358]


portfolio before change:  [-6.82344202]
curr_Stock_Price:  101.486821743956
curr_Factors:  [101.48682174]
mat_Sqrt:  [[0.15]]
grads:  [0.07501958]
Stock Position:  0.07501958422783252
Bond Position:  [-14.43694119]


portfolio before change:  [-6.86005459]
curr_Stock_Price:  101.01080951990066
curr_Factors:  [101.01080952]
mat_Sqrt:  [[0.15]]
grads:  [0.06090381]
Stock Position:  0.060903811276942964
Bond Position:  [-13.01199787]


portfolio before change:  [-6.85106478]
curr_Stock_Price:  101.17176972121327
curr_Factors:  [101.17176972]
mat_Sqrt:  [[0.15]]
grads:  [-0.22662889]
Stock Position:  -0.22662889293567404
Bond Position:  [16.07738139]


portfolio before change:  [-6.70643954]
curr_Stock_Price:  100.53804484257195
curr_Factors:  [100.53804484]
mat_Sqrt:  [[0.15]]
grads:  [0.06512536]
Stock Position:  0.06512535659308953
Bond Position:  [-13.25401557]


portfolio before change:  [-6.64815485]
curr_Stock_Price:  101.44572651619856
curr_Factors:  [101.44572652]
mat_Sqrt:  [[0.15]]
grads:  [0.01937325]
Stock Position:  0.01937324576768623
Bond Position:  [-8.61348785]


portfolio before change:  [-6.6573793]
curr_Stock_Price:  100.9973717175393
curr_Factors:  [100.99737172]
mat_Sqrt:  [[0.15]]
grads:  [0.1051497]
Stock Position:  0.10514970426497605
Bond Position:  [-17.27722307]


portfolio before change:  [-6.68146215]
curr_Stock_Price:  100.77860757913766
curr_Factors:  [100.77860758]
mat_Sqrt:  [[0.15]]
grads:  [-0.0385783]
Stock Position:  -0.038578297032361084
Bond Position:  [-2.79359509]


portfolio before change:  [-6.7008907]
curr_Stock_Price:  101.27769521609186
curr_Factors:  [101.27769522]
mat_Sqrt:  [[0.15]]
grads:  [-0.12075043]
Stock Position:  -0.12075042559589334
Bond Position:  [5.5284341]


portfolio before change:  [-6.72848145]
curr_Stock_Price:  101.509050781029
curr_Factors:  [101.50905078]
mat_Sqrt:  [[0.15]]
grads:  [0.14698449]
Stock Position:  0.14698448593564806
Bond Position:  [-21.64873709]


portfolio before change:  [-6.67710612]
curr_Stock_Price:  101.86778534915327
curr_Factors:  [101.86778535]
mat_Sqrt:  [[0.15]]
grads:  [0.00744609]
Stock Position:  0.007446091517685818
Bond Position:  [-7.43562297]


portfolio before change:  [-6.67863321]
curr_Stock_Price:  101.72511380229908
curr_Factors:  [101.7251138]
mat_Sqrt:  [[0.15]]
grads:  [-0.03436712]
Stock Position:  -0.03436711774275635
Bond Position:  [-3.18263424]


portfolio before change:  [-6.66402502]
curr_Stock_Price:  101.29426276695271
curr_Factors:  [101.29426277]
mat_Sqrt:  [[0.15]]
grads:  [-0.01353101]
Stock Position:  -0.013531013430844013
Bond Position:  [-5.29341099]


portfolio before change:  [-6.66447428]
curr_Stock_Price:  101.30301391254127
curr_Factors:  [101.30301391]
mat_Sqrt:  [[0.15]]
grads:  [0.07545474]
Stock Position:  0.07545474436570211
Bond Position:  [-14.3082673]


portfolio before change:  [-6.68080714]
curr_Stock_Price:  101.0984069582441
curr_Factors:  [101.09840696]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368795]
Stock Position:  -0.04368794899598237
Bond Position:  [-2.26402509]


portfolio before change:  [-6.68964293]
curr_Stock_Price:  101.29741563862824
curr_Factors:  [101.29741564]
mat_Sqrt:  [[0.15]]
grads:  [-0.05788158]
Stock Position:  -0.057881579657948726
Bond Position:  [-0.82638849]


portfolio before change:  [-6.64879302]
curr_Stock_Price:  100.59077362118623
curr_Factors:  [100.59077362]
mat_Sqrt:  [[0.15]]
grads:  [-0.05044454]
Stock Position:  -0.05044453848705746
Bond Position:  [-1.57453787]


portfolio before change:  [-6.66968929]
curr_Stock_Price:  101.00306523407532
curr_Factors:  [101.00306523]
mat_Sqrt:  [[0.15]]
grads:  [0.11565375]
Stock Position:  0.11565374825245243
Bond Position:  [-18.35107237]


portfolio before change:  [-6.63257386]
curr_Stock_Price:  101.33390114868844
curr_Factors:  [101.33390115]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625877]
Stock Position:  -0.026258769167217002
Bond Position:  [-3.97167034]


portfolio before change:  [-6.63538887]
curr_Stock_Price:  101.43165025981187
curr_Factors:  [101.43165026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01942462]
Stock Position:  -0.019424622192549985
Bond Position:  [-4.66511738]


portfolio before change:  [-6.65240059]
curr_Stock_Price:  102.2924210511992
curr_Factors:  [102.29242105]
mat_Sqrt:  [[0.15]]
grads:  [0.03688446]
Stock Position:  0.03688445593863054
Bond Position:  [-10.42540089]


portfolio before change:  [-6.62209605]
curr_Stock_Price:  103.131694736283
curr_Factors:  [103.13169474]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368518]
Stock Position:  -0.04368518117309768
Bond Position:  [-2.11676928]


portfolio before change:  [-6.62068214]
curr_Stock_Price:  103.09630040590636
curr_Factors:  [103.09630041]
mat_Sqrt:  [[0.15]]
grads:  [0.04264308]
Stock Position:  0.042643083330126695
Bond Position:  [-11.01702627]


portfolio before change:  [-6.61201972]
curr_Stock_Price:  103.31558581354071
curr_Factors:  [103.31558581]
mat_Sqrt:  [[0.15]]
grads:  [0.06686819]
Stock Position:  0.06686819005084002
Bond Position:  [-13.52054595]


portfolio before change:  [-6.61366544]
curr_Stock_Price:  103.30361210184257
curr_Factors:  [103.3036121]
mat_Sqrt:  [[0.15]]
grads:  [5.83890723e-05]
Stock Position:  5.838907232986561e-05
Bond Position:  [-6.61969724]


portfolio before change:  [-6.61411713]
curr_Stock_Price:  102.6538005443323
curr_Factors:  [102.65380054]
mat_Sqrt:  [[0.15]]
grads:  [0.01118434]
Stock Position:  0.011184341992324346
Bond Position:  [-7.76223234]


portfolio before change:  [-6.61992163]
curr_Stock_Price:  102.17819405737785
curr_Factors:  [102.17819406]
mat_Sqrt:  [[0.15]]
grads:  [0.10316465]
Stock Position:  0.10316464633358076
Bond Position:  [-17.16109888]


portfolio before change:  [-6.56962107]
curr_Stock_Price:  102.67616656106361
curr_Factors:  [102.67616656]
mat_Sqrt:  [[0.15]]
grads:  [-0.01596027]
Stock Position:  -0.015960267802152324
Bond Position:  [-4.93088196]


portfolio before change:  [-6.58123655]
curr_Stock_Price:  103.38463106611162
curr_Factors:  [103.38463107]
mat_Sqrt:  [[0.15]]
grads:  [0.12006938]
Stock Position:  0.12006938013525306
Bond Position:  [-18.99456511]


portfolio before change:  [-6.69645871]
curr_Stock_Price:  102.4348887606417
curr_Factors:  [102.43488876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551369]
Stock Position:  -0.005513692550062124
Bond Position:  [-6.13166423]


portfolio before change:  [-6.69876691]
curr_Stock_Price:  102.78401194079763
curr_Factors:  [102.78401194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08264923]
Stock Position:  -0.08264923440236538
Bond Position:  [1.79625298]


portfolio before change:  [-6.68834632]
curr_Stock_Price:  102.65928813092138
curr_Factors:  [102.65928813]
mat_Sqrt:  [[0.15]]
grads:  [0.01473418]
Stock Position:  0.014734177235420712
Bond Position:  [-8.20094646]


portfolio before change:  [-6.69079363]
curr_Stock_Price:  102.52797833170895
curr_Factors:  [102.52797833]
mat_Sqrt:  [[0.15]]
grads:  [0.00663036]
Stock Position:  0.006630357605178841
Bond Position:  [-7.37059079]


portfolio before change:  [-6.68327775]
curr_Stock_Price:  103.7310140461073
curr_Factors:  [103.73101405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03608899]
Stock Position:  -0.036088985409376044
Bond Position:  [-2.9397307]


portfolio before change:  [-6.70040563]
curr_Stock_Price:  104.20052397115603
curr_Factors:  [104.20052397]
mat_Sqrt:  [[0.15]]
grads:  [0.10200547]
Stock Position:  0.10200547039558554
Bond Position:  [-17.32942909]


portfolio before change:  [-6.67274881]
curr_Stock_Price:  104.48227297066663
curr_Factors:  [104.48227297]
mat_Sqrt:  [[0.15]]
grads:  [-0.05695583]
Stock Position:  -0.056955833608769
Bond Position:  [-0.72187386]


portfolio before change:  [-6.68517379]
curr_Stock_Price:  104.69963197724054
curr_Factors:  [104.69963198]
mat_Sqrt:  [[0.15]]
grads:  [-0.05390273]
Stock Position:  -0.053902733002168225
Bond Position:  [-1.04157749]


portfolio before change:  [-6.69159252]
curr_Stock_Price:  104.81750403648208
curr_Factors:  [104.81750404]
mat_Sqrt:  [[0.15]]
grads:  [-0.08153029]
Stock Position:  -0.08153029298657431
Bond Position:  [1.85420929]


portfolio before change:  [-6.65185863]
curr_Stock_Price:  104.33157421155495
curr_Factors:  [104.33157421]
mat_Sqrt:  [[0.15]]
grads:  [0.09039541]
Stock Position:  0.09039540567380823
Bond Position:  [-16.0829536]


portfolio before change:  [-6.66740908]
curr_Stock_Price:  104.17066743569764
curr_Factors:  [104.17066744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990728]
Stock Position:  -0.019907282392262953
Bond Position:  [-4.59365418]


portfolio before change:  [-6.66880712]
curr_Stock_Price:  104.22647279765667
curr_Factors:  [104.2264728]
mat_Sqrt:  [[0.15]]
grads:  [0.16415902]
Stock Position:  0.16415901717388082
Bond Position:  [-23.77852246]


portfolio before change:  [-6.63963344]
curr_Stock_Price:  104.41324224752002
curr_Factors:  [104.41324225]
mat_Sqrt:  [[0.15]]
grads:  [-0.16506547]
Stock Position:  -0.16506546650247456
Bond Position:  [10.5953871]


portfolio before change:  [-6.70205386]
curr_Stock_Price:  104.79540971242162
curr_Factors:  [104.79540971]
mat_Sqrt:  [[0.15]]
grads:  [0.01067522]
Stock Position:  0.01067522403637572
Bond Position:  [-7.82076833]


portfolio before change:  [-6.71023936]
curr_Stock_Price:  104.07442376359008
curr_Factors:  [104.07442376]
mat_Sqrt:  [[0.15]]
grads:  [-0.02708451]
Stock Position:  -0.027084510396384893
Bond Position:  [-3.89143454]


portfolio before change:  [-6.7329772]
curr_Stock_Price:  104.90495835870075
curr_Factors:  [104.90495836]
mat_Sqrt:  [[0.15]]
grads:  [-0.07328572]
Stock Position:  -0.07328571769814224
Bond Position:  [0.95505796]


portfolio before change:  [-6.67522909]
curr_Stock_Price:  104.11778697290298
curr_Factors:  [104.11778697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.67522909]
Stock Price:  104.40041094479359
PL:  [-11.07564003]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.10918645e-03]
 [ 2.52859093e-03]
 [ 4.85463378e-04]
 [ 5.49575443e-03]
 [ 2.12547015e-02]
 [ 2.80735337e-02]
 [ 2.45872413e-03]
 [ 7.32870828e-03]
 [ 2.46225945e-02]
 [-4.55522475e-03]
 [ 2.97188762e-02]
 [-5.21700755e-02]
 [ 5.76065419e-02]
 [ 4.23893299e-03]
 [-6.91527099e-03]
 [ 1.80771510e-02]
 [ 1.07163357e-02]
 [-1.15396391e-02]
 [ 7.03237233e-06]
 [-1.03790058e-03]
 [ 1.36307646e-02]
 [-4.36410404e-03]
 [ 1.10926017e-02]
 [-1.22094118e-02]
 [ 2.05670064e-03]
 [ 1.14955993e-02]
 [-6.08441238e-03]
 [ 7.32810931e-03]
 [ 7.43457216e-03]
 [-2.76632974e-03]
 [ 4.36326081e-03]
 [-1.19446374e-02]
 [ 7.98299897e-03]
 [ 6.97665905e-03]
 [ 1.13385948e-02]
 [ 8.55047395e-03]
 [-3.33358802e-02]
 [ 8.95075347e-03]
 [ 1.43876003e-02]
 [ 1.32614724e-03]
 [-4.33991526e-03]
 [-1.66529361e-02]
 [ 2.05517146e-02]
 [-1.92865737e-03]
 [ 2.81452656e-03]
 [-1.39951217e-02]
 [ 1.44052478e-02]
 [ 1.28361485e-02]
 [ 6.18593202e-03]
 [-7.47798430e-03]
 [-2.25085006e-03]
 [ 3.93695605e-03]
 [-1.05484932e-02]
 [ 5.84956053e-03]
 [-1.46452398e-02]
 [ 2.04441420e-02]
 [ 1.26259779e-02]
 [ 1.19236205e-03]
 [ 1.82277430e-03]
 [ 1.25962858e-02]
 [ 7.19090673e-03]
 [ 1.70395616e-02]
 [ 6.96557579e-04]
 [-1.24238401e-02]
 [ 6.71634499e-04]
 [ 1.50645691e-03]
 [-5.43013691e-03]
 [ 1.50396283e-02]
 [-8.32996065e-03]
 [ 1.06940463e-02]
 [-1.12742618e-02]
 [ 1.18103925e-02]
 [-6.98553597e-03]
 [ 1.69537016e-02]
 [-2.23763045e-02]
 [-4.27116735e-03]
 [-6.88264833e-03]
 [-1.74735097e-03]
 [ 1.24275424e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.30624005]
curr_Stock_Price:  100.082234679067
curr_Factors:  [100.08223468]
mat_Sqrt:  [[0.15]]
grads:  [0.00739458]
Stock Position:  0.007394576312588878
Bond Position:  [2.56617433]


portfolio before change:  [3.30909232]
curr_Stock_Price:  100.4462689086176
curr_Factors:  [100.44626891]
mat_Sqrt:  [[0.15]]
grads:  [0.01685727]
Stock Position:  0.016857272883787633
Bond Position:  [1.61584216]


portfolio before change:  [3.30033487]
curr_Stock_Price:  99.92077208956803
curr_Factors:  [99.92077209]
mat_Sqrt:  [[0.15]]
grads:  [0.00323642]
Stock Position:  0.0032364225228780712
Bond Position:  [2.97694903]


portfolio before change:  [3.30311945]
curr_Stock_Price:  100.72366837982796
curr_Factors:  [100.72366838]
mat_Sqrt:  [[0.15]]
grads:  [0.03663836]
Stock Position:  0.03663836287737434
Bond Position:  [-0.38723086]


portfolio before change:  [3.33249275]
curr_Stock_Price:  101.52603778294457
curr_Factors:  [101.52603778]
mat_Sqrt:  [[0.15]]
grads:  [0.14169801]
Stock Position:  0.14169801023947812
Bond Position:  [-11.05354479]


portfolio before change:  [3.2472079]
curr_Stock_Price:  100.92903588058395
curr_Factors:  [100.92903588]
mat_Sqrt:  [[0.15]]
grads:  [0.18715689]
Stock Position:  0.18715689146244494
Bond Position:  [-15.64235672]


portfolio before change:  [3.37055027]
curr_Stock_Price:  101.59329165906296
curr_Factors:  [101.59329166]
mat_Sqrt:  [[0.15]]
grads:  [0.01639149]
Stock Position:  0.016391494198447376
Bond Position:  [1.70528442]


portfolio before change:  [3.37238978]
curr_Stock_Price:  101.69901294703021
curr_Factors:  [101.69901295]
mat_Sqrt:  [[0.15]]
grads:  [0.04885806]
Stock Position:  0.04885805517747081
Bond Position:  [-1.59642621]


portfolio before change:  [3.38992526]
curr_Stock_Price:  102.05996184059947
curr_Factors:  [102.05996184]
mat_Sqrt:  [[0.15]]
grads:  [0.16415063]
Stock Position:  0.16415062973469452
Bond Position:  [-13.36328175]


portfolio before change:  [3.30899554]
curr_Stock_Price:  101.57202898826415
curr_Factors:  [101.57202899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03036816]
Stock Position:  -0.030368164968452984
Bond Position:  [6.39355168]


portfolio before change:  [3.30257598]
curr_Stock_Price:  101.79657892576431
curr_Factors:  [101.79657893]
mat_Sqrt:  [[0.15]]
grads:  [0.19812584]
Stock Position:  0.19812584132097885
Bond Position:  [-16.86595686]


portfolio before change:  [3.29161428]
curr_Stock_Price:  101.74657257907593
curr_Factors:  [101.74657258]
mat_Sqrt:  [[0.15]]
grads:  [-0.3478005]
Stock Position:  -0.3478005034175526
Bond Position:  [38.67912344]


portfolio before change:  [3.26298998]
curr_Stock_Price:  101.83582437129377
curr_Factors:  [101.83582437]
mat_Sqrt:  [[0.15]]
grads:  [0.38404361]
Stock Position:  0.3840436129051438
Bond Position:  [-35.84640793]


portfolio before change:  [3.11398743]
curr_Stock_Price:  101.45367486003235
curr_Factors:  [101.45367486]
mat_Sqrt:  [[0.15]]
grads:  [0.02825955]
Stock Position:  0.02825955327453928
Bond Position:  [0.2469519]


portfolio before change:  [3.08972749]
curr_Stock_Price:  100.5946599867806
curr_Factors:  [100.59465999]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610181]
Stock Position:  -0.046101806567030064
Bond Position:  [7.72732305]


portfolio before change:  [3.08033207]
curr_Stock_Price:  100.8089335344252
curr_Factors:  [100.80893353]
mat_Sqrt:  [[0.15]]
grads:  [0.12051434]
Stock Position:  0.12051434004231856
Bond Position:  [-9.06859003]


portfolio before change:  [3.17133971]
curr_Stock_Price:  101.56879701497732
curr_Factors:  [101.56879701]
mat_Sqrt:  [[0.15]]
grads:  [0.07144224]
Stock Position:  0.07144223772115868
Bond Position:  [-4.08496243]


portfolio before change:  [3.1351661]
curr_Stock_Price:  101.06603712557451
curr_Factors:  [101.06603713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07693093]
Stock Position:  -0.07693092766366444
Bond Position:  [10.91027009]


portfolio before change:  [3.1169368]
curr_Stock_Price:  101.31185776158982
curr_Factors:  [101.31185776]
mat_Sqrt:  [[0.15]]
grads:  [4.68824822e-05]
Stock Position:  4.6882482191389074e-05
Bond Position:  [3.11218705]


portfolio before change:  [3.1171204]
curr_Stock_Price:  101.07888415049506
curr_Factors:  [101.07888415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691934]
Stock Position:  -0.006919337233087751
Bond Position:  [3.81651928]


portfolio before change:  [3.11318241]
curr_Stock_Price:  101.68248627739679
curr_Factors:  [101.68248628]
mat_Sqrt:  [[0.15]]
grads:  [0.09087176]
Stock Position:  0.0908717636807487
Bond Position:  [-6.12688445]


portfolio before change:  [3.13382631]
curr_Stock_Price:  101.91387656378546
curr_Factors:  [101.91387656]
mat_Sqrt:  [[0.15]]
grads:  [-0.02909403]
Stock Position:  -0.029094026937187864
Bond Position:  [6.09891138]


portfolio before change:  [3.11159556]
curr_Stock_Price:  102.69107895250748
curr_Factors:  [102.69107895]
mat_Sqrt:  [[0.15]]
grads:  [0.07395068]
Stock Position:  0.07395067785744198
Bond Position:  [-4.48247934]


portfolio before change:  [3.09513244]
curr_Stock_Price:  102.47224454809239
curr_Factors:  [102.47224455]
mat_Sqrt:  [[0.15]]
grads:  [-0.08139608]
Stock Position:  -0.08139607860149344
Bond Position:  [11.43597131]


portfolio before change:  [3.13932054]
curr_Stock_Price:  101.93814849116323
curr_Factors:  [101.93814849]
mat_Sqrt:  [[0.15]]
grads:  [0.01371134]
Stock Position:  0.013711337579984766
Bond Position:  [1.74161217]


portfolio before change:  [3.13415693]
curr_Stock_Price:  101.55361559939904
curr_Factors:  [101.5536156]
mat_Sqrt:  [[0.15]]
grads:  [0.07663733]
Stock Position:  0.07663732888603099
Bond Position:  [-4.64864091]


portfolio before change:  [3.08464558]
curr_Stock_Price:  100.91135938975108
curr_Factors:  [100.91135939]
mat_Sqrt:  [[0.15]]
grads:  [-0.04056275]
Stock Position:  -0.04056274922562209
Bond Position:  [7.17788775]


portfolio before change:  [3.08112243]
curr_Stock_Price:  101.00927634750158
curr_Factors:  [101.00927635]
mat_Sqrt:  [[0.15]]
grads:  [0.04885406]
Stock Position:  0.048854062080703274
Bond Position:  [-1.85359103]


portfolio before change:  [3.06283044]
curr_Stock_Price:  100.6372266280751
curr_Factors:  [100.63722663]
mat_Sqrt:  [[0.15]]
grads:  [0.04956381]
Stock Position:  0.04956381441608704
Bond Position:  [-1.92513438]


portfolio before change:  [3.03468124]
curr_Stock_Price:  100.0717157299614
curr_Factors:  [100.07171573]
mat_Sqrt:  [[0.15]]
grads:  [-0.0184422]
Stock Position:  -0.018442198259840233
Bond Position:  [4.88022366]


portfolio before change:  [3.03167792]
curr_Stock_Price:  100.2511055335942
curr_Factors:  [100.25110553]
mat_Sqrt:  [[0.15]]
grads:  [0.02908841]
Stock Position:  0.0290884054251953
Bond Position:  [0.11553312]


portfolio before change:  [3.03138406]
curr_Stock_Price:  100.24075514416543
curr_Factors:  [100.24075514]
mat_Sqrt:  [[0.15]]
grads:  [-0.07963092]
Stock Position:  -0.07963091600197719
Bond Position:  [11.01364722]


portfolio before change:  [2.98816122]
curr_Stock_Price:  100.79218945998271
curr_Factors:  [100.79218946]
mat_Sqrt:  [[0.15]]
grads:  [0.05321999]
Stock Position:  0.053219993110509026
Bond Position:  [-2.37599841]


portfolio before change:  [2.98359727]
curr_Stock_Price:  100.70922359890467
curr_Factors:  [100.7092236]
mat_Sqrt:  [[0.15]]
grads:  [0.04651106]
Stock Position:  0.046511060334840315
Bond Position:  [-1.7004955]


portfolio before change:  [3.01315154]
curr_Stock_Price:  101.34693324192988
curr_Factors:  [101.34693324]
mat_Sqrt:  [[0.15]]
grads:  [0.07559063]
Stock Position:  0.07559063171856376
Bond Position:  [-4.64772717]


portfolio before change:  [3.03471456]
curr_Stock_Price:  101.63603667805224
curr_Factors:  [101.63603668]
mat_Sqrt:  [[0.15]]
grads:  [0.05700316]
Stock Position:  0.05700315969566154
Bond Position:  [-2.75886067]


portfolio before change:  [3.08161024]
curr_Stock_Price:  102.46174730183446
curr_Factors:  [102.4617473]
mat_Sqrt:  [[0.15]]
grads:  [-0.2222392]
Stock Position:  -0.22223920132200523
Bond Position:  [25.85262712]


portfolio before change:  [2.86734315]
curr_Stock_Price:  103.43314623719232
curr_Factors:  [103.43314624]
mat_Sqrt:  [[0.15]]
grads:  [0.05967169]
Stock Position:  0.05967168979770549
Bond Position:  [-3.30468746]


portfolio before change:  [2.93466463]
curr_Stock_Price:  104.56480564421445
curr_Factors:  [104.56480564]
mat_Sqrt:  [[0.15]]
grads:  [0.09591734]
Stock Position:  0.09591733539192826
Bond Position:  [-7.0949129]


portfolio before change:  [2.9387746]
curr_Stock_Price:  104.61227785378287
curr_Factors:  [104.61227785]
mat_Sqrt:  [[0.15]]
grads:  [0.00884098]
Stock Position:  0.008840981632762465
Bond Position:  [2.01389937]


portfolio before change:  [2.93757212]
curr_Stock_Price:  104.46202909320446
curr_Factors:  [104.46202909]
mat_Sqrt:  [[0.15]]
grads:  [-0.02893277]
Stock Position:  -0.028932768421469218
Bond Position:  [5.95994782]


portfolio before change:  [2.94724404]
curr_Stock_Price:  104.14061471940238
curr_Factors:  [104.14061472]
mat_Sqrt:  [[0.15]]
grads:  [-0.11101957]
Stock Position:  -0.11101957407893297
Bond Position:  [14.50889073]


portfolio before change:  [2.95983335]
curr_Stock_Price:  104.03538574876553
curr_Factors:  [104.03538575]
mat_Sqrt:  [[0.15]]
grads:  [0.13701143]
Stock Position:  0.13701143075346767
Bond Position:  [-11.2942037]


portfolio before change:  [2.89149944]
curr_Stock_Price:  103.54179192325333
curr_Factors:  [103.54179192]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285772]
Stock Position:  -0.012857715806294488
Bond Position:  [4.22281038]


portfolio before change:  [2.89518338]
curr_Stock_Price:  103.27580332122739
curr_Factors:  [103.27580332]
mat_Sqrt:  [[0.15]]
grads:  [0.01876351]
Stock Position:  0.01876351042505042
Bond Position:  [0.95736677]


portfolio before change:  [2.88805735]
curr_Stock_Price:  102.89283275808512
curr_Factors:  [102.89283276]
mat_Sqrt:  [[0.15]]
grads:  [-0.09330081]
Stock Position:  -0.09330081147064453
Bond Position:  [12.48804214]


portfolio before change:  [2.86493382]
curr_Stock_Price:  103.14903685848581
curr_Factors:  [103.14903686]
mat_Sqrt:  [[0.15]]
grads:  [0.09603499]
Stock Position:  0.09603498507740857
Bond Position:  [-7.04098239]


portfolio before change:  [2.98275129]
curr_Stock_Price:  104.38043747987139
curr_Factors:  [104.38043748]
mat_Sqrt:  [[0.15]]
grads:  [0.08557432]
Stock Position:  0.08557432302308036
Bond Position:  [-5.94953399]


portfolio before change:  [3.00179201]
curr_Stock_Price:  104.60728805308527
curr_Factors:  [104.60728805]
mat_Sqrt:  [[0.15]]
grads:  [0.04123955]
Stock Position:  0.04123954679769732
Bond Position:  [-1.31216514]


portfolio before change:  [2.99797722]
curr_Stock_Price:  104.5167735618599
curr_Factors:  [104.51677356]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985323]
Stock Position:  -0.049853228668188476
Bond Position:  [8.20847584]


portfolio before change:  [2.98636567]
curr_Stock_Price:  104.75997956241005
curr_Factors:  [104.75997956]
mat_Sqrt:  [[0.15]]
grads:  [-0.01500567]
Stock Position:  -0.015005667044102689
Bond Position:  [4.55835904]


portfolio before change:  [2.97448555]
curr_Stock_Price:  105.57067468019083
curr_Factors:  [105.57067468]
mat_Sqrt:  [[0.15]]
grads:  [0.02624637]
Stock Position:  0.026246373681300072
Bond Position:  [0.20363817]


portfolio before change:  [2.99945984]
curr_Stock_Price:  106.5217228183452
curr_Factors:  [106.52172282]
mat_Sqrt:  [[0.15]]
grads:  [-0.07032329]
Stock Position:  -0.07032328823967822
Bond Position:  [10.49041766]


portfolio before change:  [3.05447699]
curr_Stock_Price:  105.74870048274668
curr_Factors:  [105.74870048]
mat_Sqrt:  [[0.15]]
grads:  [0.03899707]
Stock Position:  0.038997070209118065
Bond Position:  [-1.06941251]


portfolio before change:  [3.03278612]
curr_Stock_Price:  105.1941965680714
curr_Factors:  [105.19419657]
mat_Sqrt:  [[0.15]]
grads:  [-0.09763493]
Stock Position:  -0.09763493188420051
Bond Position:  [13.30341434]


portfolio before change:  [3.03052633]
curr_Stock_Price:  105.22585822777904
curr_Factors:  [105.22585823]
mat_Sqrt:  [[0.15]]
grads:  [0.13629428]
Stock Position:  0.1362942797865889
Bond Position:  [-11.31115624]


portfolio before change:  [3.03436426]
curr_Stock_Price:  105.25920446890323
curr_Factors:  [105.25920447]
mat_Sqrt:  [[0.15]]
grads:  [0.08417319]
Stock Position:  0.08417318603139576
Bond Position:  [-5.82563834]


portfolio before change:  [3.05487911]
curr_Stock_Price:  105.50725218554314
curr_Factors:  [105.50725219]
mat_Sqrt:  [[0.15]]
grads:  [0.00794908]
Stock Position:  0.007949080307965997
Bond Position:  [2.21619349]


portfolio before change:  [3.04902095]
curr_Stock_Price:  104.7528657916884
curr_Factors:  [104.75286579]
mat_Sqrt:  [[0.15]]
grads:  [0.01215183]
Stock Position:  0.012151828634823664
Bond Position:  [1.77608208]


portfolio before change:  [3.0423958]
curr_Stock_Price:  104.19853268923221
curr_Factors:  [104.19853269]
mat_Sqrt:  [[0.15]]
grads:  [0.08397524]
Stock Position:  0.0839752383350395
Bond Position:  [-5.70770082]


portfolio before change:  [3.04113282]
curr_Stock_Price:  104.18774104340262
curr_Factors:  [104.18774104]
mat_Sqrt:  [[0.15]]
grads:  [0.04793938]
Stock Position:  0.0479393782249873
Bond Position:  [-1.9535627]


portfolio before change:  [2.9966565]
curr_Stock_Price:  103.2625263426532
curr_Factors:  [103.26252634]
mat_Sqrt:  [[0.15]]
grads:  [0.11359708]
Stock Position:  0.11359707765015245
Bond Position:  [-8.73366472]


portfolio before change:  [2.94183736]
curr_Stock_Price:  102.78475635627595
curr_Factors:  [102.78475636]
mat_Sqrt:  [[0.15]]
grads:  [0.00464372]
Stock Position:  0.004643717190698909
Bond Position:  [2.46453402]


portfolio before change:  [2.94242543]
curr_Stock_Price:  102.87822379056286
curr_Factors:  [102.87822379]
mat_Sqrt:  [[0.15]]
grads:  [-0.0828256]
Stock Position:  -0.08282560076378834
Bond Position:  [11.46337612]


portfolio before change:  [2.98529084]
curr_Stock_Price:  102.36933615433745
curr_Factors:  [102.36933615]
mat_Sqrt:  [[0.15]]
grads:  [0.00447756]
Stock Position:  0.004477563325309119
Bond Position:  [2.52692566]


portfolio before change:  [2.98735626]
curr_Stock_Price:  102.79534536908061
curr_Factors:  [102.79534537]
mat_Sqrt:  [[0.15]]
grads:  [0.01004305]
Stock Position:  0.010043046054150698
Bond Position:  [1.95497787]


portfolio before change:  [2.98777096]
curr_Stock_Price:  102.82447090164278
curr_Factors:  [102.8244709]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620091]
Stock Position:  -0.03620091272823827
Bond Position:  [6.71011066]


portfolio before change:  [2.98858259]
curr_Stock_Price:  102.8136361014589
curr_Factors:  [102.8136361]
mat_Sqrt:  [[0.15]]
grads:  [0.10026419]
Stock Position:  0.10026418857296392
Bond Position:  [-7.31994321]


portfolio before change:  [2.88010276]
curr_Stock_Price:  101.7362592715718
curr_Factors:  [101.73625927]
mat_Sqrt:  [[0.15]]
grads:  [-0.05553307]
Stock Position:  -0.055533071029519904
Bond Position:  [8.52982967]


portfolio before change:  [2.88407487]
curr_Stock_Price:  101.67433259589227
curr_Factors:  [101.6743326]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-4.36465861]


portfolio before change:  [2.87834908]
curr_Stock_Price:  101.59784617219746
curr_Factors:  [101.59784617]
mat_Sqrt:  [[0.15]]
grads:  [-0.07516175]
Stock Position:  -0.07516174531179222
Bond Position:  [10.51462051]


portfolio before change:  [2.84591016]
curr_Stock_Price:  102.03817790474449
curr_Factors:  [102.0381779]
mat_Sqrt:  [[0.15]]
grads:  [0.07873595]
Stock Position:  0.0787359502212737
Bond Position:  [-5.18816274]


portfolio before change:  [2.77490174]
curr_Stock_Price:  101.14044121447564
curr_Factors:  [101.14044121]
mat_Sqrt:  [[0.15]]
grads:  [-0.04657024]
Stock Position:  -0.04657023979295202
Bond Position:  [7.48503634]


portfolio before change:  [2.79444735]
curr_Stock_Price:  100.73078502008592
curr_Factors:  [100.73078502]
mat_Sqrt:  [[0.15]]
grads:  [0.11302468]
Stock Position:  0.11302467750855266
Bond Position:  [-8.59061714]


portfolio before change:  [2.75719423]
curr_Stock_Price:  100.40593387707015
curr_Factors:  [100.40593388]
mat_Sqrt:  [[0.15]]
grads:  [-0.14917536]
Stock Position:  -0.14917536338074366
Bond Position:  [17.7352859]


portfolio before change:  [2.80220099]
curr_Stock_Price:  100.11166094563387
curr_Factors:  [100.11166095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847445]
Stock Position:  -0.028474449003090107
Bond Position:  [5.65282537]


portfolio before change:  [2.80331571]
curr_Stock_Price:  100.08492105136654
curr_Factors:  [100.08492105]
mat_Sqrt:  [[0.15]]
grads:  [-0.04588432]
Stock Position:  -0.04588432219715106
Bond Position:  [7.39564447]


portfolio before change:  [2.78990553]
curr_Stock_Price:  100.38725573076678
curr_Factors:  [100.38725573]
mat_Sqrt:  [[0.15]]
grads:  [-0.01164901]
Stock Position:  -0.011649006477806463
Bond Position:  [3.95931732]


portfolio before change:  [2.78127499]
curr_Stock_Price:  101.14938064324434
curr_Factors:  [101.14938064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.78127499]
Stock Price:  100.55424814326052
PL:  [2.22702685]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.73487658e-03]
 [ 9.06534067e-04]
 [-1.70768168e-03]
 [ 1.85299673e-03]
 [ 1.96151654e-02]
 [ 2.87112137e-02]
 [ 5.82921908e-04]
 [-1.80738359e-02]
 [ 9.08927998e-03]
 [ 1.42917856e-02]
 [ 4.91154588e-03]
 [ 2.05911111e-02]
 [-1.25013897e-02]
 [ 1.13822464e-02]
 [-6.95346085e-03]
 [ 9.62107762e-03]
 [ 7.23854934e-03]
 [-1.16797667e-02]
 [-2.74354545e-04]
 [ 1.36726996e-02]
 [ 1.13879589e-02]
 [-7.94570293e-03]
 [ 7.38501222e-03]
 [ 1.41828975e-02]
 [-8.01175587e-03]
 [-5.92583314e-03]
 [-7.19436277e-03]
 [ 6.70088949e-03]
 [-1.40139514e-02]
 [-1.79949174e-03]
 [-6.63152330e-03]
 [-1.08249840e-02]
 [ 6.50376980e-04]
 [ 4.76769791e-03]
 [ 1.15274688e-02]
 [ 1.21943539e-02]
 [-3.42108421e-02]
 [ 9.76706260e-03]
 [-1.14087900e-02]
 [ 2.45123862e-02]
 [-5.72807927e-03]
 [-1.26706503e-02]
 [ 2.34592229e-02]
 [ 3.93282326e-03]
 [-8.22409107e-03]
 [-5.06475120e-03]
 [ 2.13466710e-03]
 [-1.23603567e-02]
 [-1.14095722e-02]
 [-6.72471734e-03]
 [ 4.76334129e-02]
 [-8.94725135e-03]
 [-4.06120202e-03]
 [ 5.30797459e-03]
 [ 4.40184700e-03]
 [-2.72232899e-03]
 [ 5.10577015e-03]
 [-2.93036736e-04]
 [ 1.55479696e-03]
 [-1.44667422e-03]
 [ 9.00849938e-04]
 [-1.08079074e-02]
 [-1.93140891e-03]
 [-1.48330463e-02]
 [-6.28301857e-03]
 [-1.26572248e-04]
 [-5.49839538e-03]
 [ 1.93679816e-02]
 [-8.16681479e-03]
 [ 8.37971931e-03]
 [-1.06989272e-02]
 [ 1.10766542e-02]
 [-7.89088430e-03]
 [ 9.07037948e-03]
 [-1.85578147e-02]
 [-6.66802772e-03]
 [ 1.04790106e-03]
 [ 7.39545753e-04]
 [-6.30059338e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.81068882]
curr_Stock_Price:  99.98498652180989
curr_Factors:  [99.98498652]
mat_Sqrt:  [[0.15]]
grads:  [0.01156584]
Stock Position:  0.011565843863035824
Bond Position:  [0.65427808]


portfolio before change:  [1.80837054]
curr_Stock_Price:  99.78100887720247
curr_Factors:  [99.78100888]
mat_Sqrt:  [[0.15]]
grads:  [0.00604356]
Stock Position:  0.006043560449191417
Bond Position:  [1.20533798]


portfolio before change:  [1.81240495]
curr_Stock_Price:  100.43609789125293
curr_Factors:  [100.43609789]
mat_Sqrt:  [[0.15]]
grads:  [-0.01138454]
Stock Position:  -0.011384544526066857
Bond Position:  [2.95582418]


portfolio before change:  [1.80014808]
curr_Stock_Price:  101.52894927051668
curr_Factors:  [101.52894927]
mat_Sqrt:  [[0.15]]
grads:  [0.01235331]
Stock Position:  0.012353311556338141
Bond Position:  [0.54592933]


portfolio before change:  [1.79906255]
curr_Stock_Price:  101.43831344144432
curr_Factors:  [101.43831344]
mat_Sqrt:  [[0.15]]
grads:  [0.13076777]
Stock Position:  0.13076776936162116
Bond Position:  [-11.46579943]


portfolio before change:  [1.70607743]
curr_Stock_Price:  100.73272304940235
curr_Factors:  [100.73272305]
mat_Sqrt:  [[0.15]]
grads:  [0.19140809]
Stock Position:  0.19140809128511416
Bond Position:  [-17.57498082]


portfolio before change:  [1.49586286]
curr_Stock_Price:  99.64020863027174
curr_Factors:  [99.64020863]
mat_Sqrt:  [[0.15]]
grads:  [0.00388615]
Stock Position:  0.003886146055582502
Bond Position:  [1.10864646]


portfolio before change:  [1.49557464]
curr_Stock_Price:  99.54821150656531
curr_Factors:  [99.54821151]
mat_Sqrt:  [[0.15]]
grads:  [-0.12049224]
Stock Position:  -0.120492239615278
Bond Position:  [13.49036159]


portfolio before change:  [1.52774044]
curr_Stock_Price:  99.28825596231782
curr_Factors:  [99.28825596]
mat_Sqrt:  [[0.15]]
grads:  [0.0605952]
Stock Position:  0.06059519989655466
Bond Position:  [-4.48865128]


portfolio before change:  [1.53724095]
curr_Stock_Price:  99.44967238040654
curr_Factors:  [99.44967238]
mat_Sqrt:  [[0.15]]
grads:  [0.09527857]
Stock Position:  0.09527857086154103
Bond Position:  [-7.93818171]


portfolio before change:  [1.46641794]
curr_Stock_Price:  98.71155405410398
curr_Factors:  [98.71155405]
mat_Sqrt:  [[0.15]]
grads:  [0.03274364]
Stock Position:  0.03274363921407919
Bond Position:  [-1.76575758]


portfolio before change:  [1.46984946]
curr_Stock_Price:  98.81972412767813
curr_Factors:  [98.81972413]
mat_Sqrt:  [[0.15]]
grads:  [0.13727407]
Stock Position:  0.13727407390071542
Bond Position:  [-12.09553666]


portfolio before change:  [1.54193683]
curr_Stock_Price:  99.3503659984433
curr_Factors:  [99.350366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0833426]
Stock Position:  -0.08334259815416264
Bond Position:  [9.82205446]


portfolio before change:  [1.55335972]
curr_Stock_Price:  99.22067248883864
curr_Factors:  [99.22067249]
mat_Sqrt:  [[0.15]]
grads:  [0.07588164]
Stock Position:  0.07588164262927821
Bond Position:  [-5.97566789]


portfolio before change:  [1.52900153]
curr_Stock_Price:  98.90459210793645
curr_Factors:  [98.90459211]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635641]
Stock Position:  -0.0463564056942467
Bond Position:  [6.11386293]


portfolio before change:  [1.5024057]
curr_Stock_Price:  99.48656043394742
curr_Factors:  [99.48656043]
mat_Sqrt:  [[0.15]]
grads:  [0.06414052]
Stock Position:  0.0641405174582557
Bond Position:  [-4.87871376]


portfolio before change:  [1.46976766]
curr_Stock_Price:  98.98246230109785
curr_Factors:  [98.9824623]
mat_Sqrt:  [[0.15]]
grads:  [0.048257]
Stock Position:  0.04825699559458276
Bond Position:  [-3.30682859]


portfolio before change:  [1.48465064]
curr_Stock_Price:  99.2951561477255
curr_Factors:  [99.29515615]
mat_Sqrt:  [[0.15]]
grads:  [-0.07786511]
Stock Position:  -0.07786511156986906
Bond Position:  [9.21627905]


portfolio before change:  [1.42931992]
curr_Stock_Price:  100.01315105811474
curr_Factors:  [100.01315106]
mat_Sqrt:  [[0.15]]
grads:  [-0.00182903]
Stock Position:  -0.0018290303003263542
Bond Position:  [1.61224701]


portfolio before change:  [1.42965639]
curr_Stock_Price:  99.88428312110454
curr_Factors:  [99.88428312]
mat_Sqrt:  [[0.15]]
grads:  [0.09115133]
Stock Position:  0.09115133070330846
Bond Position:  [-7.67492893]


portfolio before change:  [1.41947402]
curr_Stock_Price:  99.77783728789171
curr_Factors:  [99.77783729]
mat_Sqrt:  [[0.15]]
grads:  [0.07591973]
Stock Position:  0.07591972578100777
Bond Position:  [-6.15563203]


portfolio before change:  [1.40060009]
curr_Stock_Price:  99.53430124710904
curr_Factors:  [99.53430125]
mat_Sqrt:  [[0.15]]
grads:  [-0.05297135]
Stock Position:  -0.05297135285063449
Bond Position:  [6.67306668]


portfolio before change:  [1.40141747]
curr_Stock_Price:  99.52674430512457
curr_Factors:  [99.52674431]
mat_Sqrt:  [[0.15]]
grads:  [0.04923341]
Stock Position:  0.04923341476759419
Bond Position:  [-3.49862401]


portfolio before change:  [1.36521643]
curr_Stock_Price:  98.79589165546045
curr_Factors:  [98.79589166]
mat_Sqrt:  [[0.15]]
grads:  [0.09455265]
Stock Position:  0.09455265029386022
Bond Position:  [-7.97619697]


portfolio before change:  [1.39742782]
curr_Stock_Price:  99.14183560065571
curr_Factors:  [99.1418356]
mat_Sqrt:  [[0.15]]
grads:  [-0.05341171]
Stock Position:  -0.05341170579826429
Bond Position:  [6.69276237]


portfolio before change:  [1.4186789]
curr_Stock_Price:  98.7517943144464
curr_Factors:  [98.75179431]
mat_Sqrt:  [[0.15]]
grads:  [-0.03950555]
Stock Position:  -0.03950555423502524
Bond Position:  [5.31992326]


portfolio before change:  [1.37767467]
curr_Stock_Price:  99.79814687416349
curr_Factors:  [99.79814687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04796242]
Stock Position:  -0.04796241848213623
Bond Position:  [6.16423515]


portfolio before change:  [1.43072167]
curr_Stock_Price:  98.70016784910995
curr_Factors:  [98.70016785]
mat_Sqrt:  [[0.15]]
grads:  [0.0446726]
Stock Position:  0.04467259659283
Bond Position:  [-2.97847111]


portfolio before change:  [1.42791495]
curr_Stock_Price:  98.64150629611038
curr_Factors:  [98.6415063]
mat_Sqrt:  [[0.15]]
grads:  [-0.09342634]
Stock Position:  -0.09342634274169849
Bond Position:  [10.64363012]


portfolio before change:  [1.35299478]
curr_Stock_Price:  99.45054376210126
curr_Factors:  [99.45054376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199661]
Stock Position:  -0.011996611609297112
Bond Position:  [2.54606433]


portfolio before change:  [1.35745866]
curr_Stock_Price:  99.09171395466961
curr_Factors:  [99.09171395]
mat_Sqrt:  [[0.15]]
grads:  [-0.04421016]
Stock Position:  -0.044210155317710546
Bond Position:  [5.73831872]


portfolio before change:  [1.37034101]
curr_Stock_Price:  98.80843754121484
curr_Factors:  [98.80843754]
mat_Sqrt:  [[0.15]]
grads:  [-0.07216656]
Stock Position:  -0.0721665600602832
Bond Position:  [8.50100605]


portfolio before change:  [1.30475226]
curr_Stock_Price:  99.72465245331303
curr_Factors:  [99.72465245]
mat_Sqrt:  [[0.15]]
grads:  [0.00433585]
Stock Position:  0.0043358465351266305
Bond Position:  [0.87236147]


portfolio before change:  [1.30521092]
curr_Stock_Price:  99.81786001098948
curr_Factors:  [99.81786001]
mat_Sqrt:  [[0.15]]
grads:  [0.03178465]
Stock Position:  0.031784652714933574
Bond Position:  [-1.8674651]


portfolio before change:  [1.31992154]
curr_Stock_Price:  100.28435359807676
curr_Factors:  [100.2843536]
mat_Sqrt:  [[0.15]]
grads:  [0.07684979]
Stock Position:  0.07684979219432528
Bond Position:  [-6.3869102]


portfolio before change:  [1.29934487]
curr_Stock_Price:  100.02179631138559
curr_Factors:  [100.02179631]
mat_Sqrt:  [[0.15]]
grads:  [0.08129569]
Stock Position:  0.0812956923484028
Bond Position:  [-6.83199631]


portfolio before change:  [1.35792324]
curr_Stock_Price:  100.7476082829355
curr_Factors:  [100.74760828]
mat_Sqrt:  [[0.15]]
grads:  [-0.22807228]
Stock Position:  -0.22807228074056363
Bond Position:  [24.33566004]


portfolio before change:  [1.41365306]
curr_Stock_Price:  100.50992578818176
curr_Factors:  [100.50992579]
mat_Sqrt:  [[0.15]]
grads:  [0.06511375]
Stock Position:  0.06511375067534284
Bond Position:  [-5.13092519]


portfolio before change:  [1.3680184]
curr_Stock_Price:  99.81400570412453
curr_Factors:  [99.8140057]
mat_Sqrt:  [[0.15]]
grads:  [-0.0760586]
Stock Position:  -0.07605859981820995
Bond Position:  [8.95973191]


portfolio before change:  [1.40806506]
curr_Stock_Price:  99.29484468547028
curr_Factors:  [99.29484469]
mat_Sqrt:  [[0.15]]
grads:  [0.16341591]
Stock Position:  0.1634159076789645
Bond Position:  [-14.81829211]


portfolio before change:  [1.4387828]
curr_Stock_Price:  99.48848504202735
curr_Factors:  [99.48848504]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381872]
Stock Position:  -0.03818719515305431
Bond Position:  [5.23796899]


portfolio before change:  [1.41208338]
curr_Stock_Price:  100.19623014842728
curr_Factors:  [100.19623015]
mat_Sqrt:  [[0.15]]
grads:  [-0.084471]
Stock Position:  -0.08447100233222425
Bond Position:  [9.87575937]


portfolio before change:  [1.40689795]
curr_Stock_Price:  100.26492457405779
curr_Factors:  [100.26492457]
mat_Sqrt:  [[0.15]]
grads:  [0.15639482]
Stock Position:  0.1563948194252418
Bond Position:  [-14.27401682]


portfolio before change:  [1.34050441]
curr_Stock_Price:  99.84610387844236
curr_Factors:  [99.84610388]
mat_Sqrt:  [[0.15]]
grads:  [0.02621882]
Stock Position:  0.026218821710269093
Bond Position:  [-1.27734279]


portfolio before change:  [1.32717247]
curr_Stock_Price:  99.340661583022
curr_Factors:  [99.34066158]
mat_Sqrt:  [[0.15]]
grads:  [-0.05482727]
Stock Position:  -0.0548272737926471
Bond Position:  [6.77375012]


portfolio before change:  [1.32162683]
curr_Stock_Price:  99.44953093324123
curr_Factors:  [99.44953093]
mat_Sqrt:  [[0.15]]
grads:  [-0.03376501]
Stock Position:  -0.03376500800512469
Bond Position:  [4.67954104]


portfolio before change:  [1.31972147]
curr_Stock_Price:  99.51462342784454
curr_Factors:  [99.51462343]
mat_Sqrt:  [[0.15]]
grads:  [0.01423111]
Stock Position:  0.014231114032941493
Bond Position:  [-0.09648249]


portfolio before change:  [1.3153251]
curr_Stock_Price:  99.20612049183956
curr_Factors:  [99.20612049]
mat_Sqrt:  [[0.15]]
grads:  [-0.08240238]
Stock Position:  -0.0824023781234205
Bond Position:  [9.49014535]


portfolio before change:  [1.31945121]
curr_Stock_Price:  99.16324601829832
curr_Factors:  [99.16324602]
mat_Sqrt:  [[0.15]]
grads:  [-0.07606381]
Stock Position:  -0.07606381439354103
Bond Position:  [8.86218595]


portfolio before change:  [1.26199876]
curr_Stock_Price:  99.9258471574954
curr_Factors:  [99.92584716]
mat_Sqrt:  [[0.15]]
grads:  [-0.04483145]
Stock Position:  -0.04483144892024569
Bond Position:  [5.74181927]


portfolio before change:  [1.28731359]
curr_Stock_Price:  99.36918537031217
curr_Factors:  [99.36918537]
mat_Sqrt:  [[0.15]]
grads:  [0.31755609]
Stock Position:  0.31755608599552665
Bond Position:  [-30.26797599]


portfolio before change:  [1.52984091]
curr_Stock_Price:  100.13887342522625
curr_Factors:  [100.13887343]
mat_Sqrt:  [[0.15]]
grads:  [-0.05964834]
Stock Position:  -0.05964834235334245
Bond Position:  [7.50295871]


portfolio before change:  [1.4407621]
curr_Stock_Price:  101.64013482755017
curr_Factors:  [101.64013483]
mat_Sqrt:  [[0.15]]
grads:  [-0.02707468]
Stock Position:  -0.027074680126249383
Bond Position:  [4.19263624]


portfolio before change:  [1.46475801]
curr_Stock_Price:  100.76352754426537
curr_Factors:  [100.76352754]
mat_Sqrt:  [[0.15]]
grads:  [0.0353865]
Stock Position:  0.035386497288933824
Bond Position:  [-2.10091028]


portfolio before change:  [1.4721498]
curr_Stock_Price:  100.97612565588501
curr_Factors:  [100.97612566]
mat_Sqrt:  [[0.15]]
grads:  [0.02934565]
Stock Position:  0.029345646676433152
Bond Position:  [-1.4910599]


portfolio before change:  [1.46876278]
curr_Stock_Price:  100.86388301258671
curr_Factors:  [100.86388301]
mat_Sqrt:  [[0.15]]
grads:  [-0.01814886]
Stock Position:  -0.01814885992725076
Bond Position:  [3.29932726]


portfolio before change:  [1.48032494]
curr_Stock_Price:  100.23817161096646
curr_Factors:  [100.23817161]
mat_Sqrt:  [[0.15]]
grads:  [0.03403847]
Stock Position:  0.03403846763818295
Bond Position:  [-1.93162882]


portfolio before change:  [1.48804812]
curr_Stock_Price:  100.46861412768601
curr_Factors:  [100.46861413]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195358]
Stock Position:  -0.0019535782401448047
Bond Position:  [1.68432142]


portfolio before change:  [1.4880736]
curr_Stock_Price:  100.50945874411892
curr_Factors:  [100.50945874]
mat_Sqrt:  [[0.15]]
grads:  [0.01036531]
Stock Position:  0.010365313074464777
Bond Position:  [0.44626159]


portfolio before change:  [1.48715713]
curr_Stock_Price:  100.4183504825117
curr_Factors:  [100.41835048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00964449]
Stock Position:  -0.00964449480441001
Bond Position:  [2.45564139]


portfolio before change:  [1.48749948]
curr_Stock_Price:  100.39876682325381
curr_Factors:  [100.39876682]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [0.884538]


portfolio before change:  [1.48363893]
curr_Stock_Price:  99.746742210602
curr_Factors:  [99.74674221]
mat_Sqrt:  [[0.15]]
grads:  [-0.07205272]
Stock Position:  -0.07205271585593476
Bond Position:  [8.6706626]


portfolio before change:  [1.51853682]
curr_Stock_Price:  99.26992517500224
curr_Factors:  [99.26992518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01287606]
Stock Position:  -0.012876059367317474
Bond Position:  [2.79674227]


portfolio before change:  [1.50767946]
curr_Stock_Price:  100.12672167146569
curr_Factors:  [100.12672167]
mat_Sqrt:  [[0.15]]
grads:  [-0.09888698]
Stock Position:  -0.09888697552591556
Bond Position:  [11.40890814]


portfolio before change:  [1.42617151]
curr_Stock_Price:  100.95818640248274
curr_Factors:  [100.9581864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04188679]
Stock Position:  -0.041886790463954646
Bond Position:  [5.65498591]


portfolio before change:  [1.42361696]
curr_Stock_Price:  101.0276115950252
curr_Factors:  [101.0276116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00084381]
Stock Position:  -0.0008438149885050632
Bond Position:  [1.50886557]


portfolio before change:  [1.42387064]
curr_Stock_Price:  100.83873599120348
curr_Factors:  [100.83873599]
mat_Sqrt:  [[0.15]]
grads:  [-0.03665597]
Stock Position:  -0.03665596923193306
Bond Position:  [5.12021224]


portfolio before change:  [1.41385762]
curr_Stock_Price:  101.12062845309686
curr_Factors:  [101.12062845]
mat_Sqrt:  [[0.15]]
grads:  [0.12911988]
Stock Position:  0.1291198771253164
Bond Position:  [-11.6428255]


portfolio before change:  [1.34922909]
curr_Stock_Price:  100.62573309752166
curr_Factors:  [100.6257331]
mat_Sqrt:  [[0.15]]
grads:  [-0.05444543]
Stock Position:  -0.05444543190869021
Bond Position:  [6.82784059]


portfolio before change:  [1.35798306]
curr_Stock_Price:  100.47278709540306
curr_Factors:  [100.4727871]
mat_Sqrt:  [[0.15]]
grads:  [0.0558648]
Stock Position:  0.05586479539337947
Bond Position:  [-4.25490863]


portfolio before change:  [1.37322393]
curr_Stock_Price:  100.75036457458405
curr_Factors:  [100.75036457]
mat_Sqrt:  [[0.15]]
grads:  [-0.07132618]
Stock Position:  -0.0713261811264874
Bond Position:  [8.55936268]


portfolio before change:  [1.35935301]
curr_Stock_Price:  100.9523365668941
curr_Factors:  [100.95233657]
mat_Sqrt:  [[0.15]]
grads:  [0.07384436]
Stock Position:  0.07384436105396028
Bond Position:  [-6.09540778]


portfolio before change:  [1.30247217]
curr_Stock_Price:  100.18721552651687
curr_Factors:  [100.18721553]
mat_Sqrt:  [[0.15]]
grads:  [-0.0526059]
Stock Position:  -0.05260589531737455
Bond Position:  [6.57291034]


portfolio before change:  [1.362942]
curr_Stock_Price:  99.04553716688557
curr_Factors:  [99.04553717]
mat_Sqrt:  [[0.15]]
grads:  [0.0604692]
Stock Position:  0.06046919651195459
Bond Position:  [-4.62626205]


portfolio before change:  [1.35440521]
curr_Stock_Price:  98.90914314825756
curr_Factors:  [98.90914315]
mat_Sqrt:  [[0.15]]
grads:  [-0.12371876]
Stock Position:  -0.12371876491770661
Bond Position:  [13.59132224]


portfolio before change:  [1.40597587]
curr_Stock_Price:  98.49917156402321
curr_Factors:  [98.49917156]
mat_Sqrt:  [[0.15]]
grads:  [-0.04445352]
Stock Position:  -0.04445351812859689
Bond Position:  [5.78461058]


portfolio before change:  [1.42462107]
curr_Stock_Price:  98.08787354059105
curr_Factors:  [98.08787354]
mat_Sqrt:  [[0.15]]
grads:  [0.00698601]
Stock Position:  0.006986007055875202
Bond Position:  [0.73937849]


portfolio before change:  [1.42856314]
curr_Stock_Price:  98.6455393866224
curr_Factors:  [98.64553939]
mat_Sqrt:  [[0.15]]
grads:  [0.00493031]
Stock Position:  0.004930305022131865
Bond Position:  [0.94221054]


portfolio before change:  [1.4294385]
curr_Stock_Price:  98.81114154793488
curr_Factors:  [98.81114155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.4294385]
Stock Price:  98.25556287454293
PL:  [1.4294385]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.17363022e-04]
 [-1.91119335e-03]
 [-3.66973500e-03]
 [-5.09105176e-04]
 [ 3.22473904e-02]
 [ 2.60175268e-02]
 [ 5.22446532e-03]
 [ 1.51922618e-02]
 [ 2.44711573e-02]
 [-1.46995930e-03]
 [ 5.20349723e-02]
 [ 8.81773084e-02]
 [ 1.03137824e-01]
 [ 1.19640159e-02]
 [-6.89409701e-03]
 [ 2.83187271e-02]
 [ 1.35708904e-02]
 [-2.29964302e-03]
 [ 1.08970733e-02]
 [-8.00305551e-03]
 [ 1.45812793e-02]
 [-1.05580956e-02]
 [ 1.06492020e-02]
 [-4.89012012e-02]
 [ 6.67360005e-03]
 [ 7.86227262e-03]
 [-5.43275902e-03]
 [ 1.02939288e-02]
 [ 3.70019148e-02]
 [ 1.52462411e-03]
 [ 9.54485212e-03]
 [-1.18164207e-02]
 [ 8.90427579e-03]
 [ 7.81569416e-03]
 [ 1.14422185e-02]
 [ 8.75255558e-03]
 [-3.42036576e-02]
 [ 9.76299699e-03]
 [-1.35302049e-02]
 [ 2.30461416e-02]
 [-5.99348420e-03]
 [-1.16948919e-02]
 [ 2.36345207e-02]
 [ 3.72866096e-03]
 [-6.97648043e-03]
 [ 1.68729495e-03]
 [ 1.11604087e-02]
 [-5.53961762e-03]
 [-5.03851317e-03]
 [-7.43372917e-03]
 [-2.68044197e-02]
 [ 2.87813145e-03]
 [-9.70587042e-03]
 [ 5.86336240e-03]
 [-1.65193250e-02]
 [ 2.40335773e-02]
 [ 1.33501312e-02]
 [ 1.14484806e-03]
 [ 1.93181387e-03]
 [ 8.75057442e-03]
 [ 1.37937422e-02]
 [ 3.70990409e-02]
 [ 8.02965673e-04]
 [-1.21832527e-02]
 [ 1.72740060e-02]
 [ 8.25546279e-03]
 [-5.02892753e-03]
 [ 1.55534594e-02]
 [-1.41620348e-02]
 [-3.57961092e-02]
 [-6.89689060e-03]
 [ 1.48918025e-02]
 [-1.83473406e-02]
 [ 2.85230038e-02]
 [-2.85825998e-02]
 [ 4.93495843e-03]
 [ 7.01317359e-03]
 [-1.55441588e-02]
 [ 2.38022942e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.93903676]
curr_Stock_Price:  100.64358193030871
curr_Factors:  [100.64358193]
mat_Sqrt:  [[0.15]]
grads:  [-0.00211575]
Stock Position:  -0.002115753481216785
Bond Position:  [12.15197377]


portfolio before change:  [11.93853264]
curr_Stock_Price:  101.24083620868915
curr_Factors:  [101.24083621]
mat_Sqrt:  [[0.15]]
grads:  [-0.01274129]
Stock Position:  -0.012741288972412971
Bond Position:  [13.22847139]


portfolio before change:  [11.92902056]
curr_Stock_Price:  102.05228346911815
curr_Factors:  [102.05228347]
mat_Sqrt:  [[0.15]]
grads:  [-0.0244649]
Stock Position:  -0.024464900000350284
Bond Position:  [14.42571947]


portfolio before change:  [11.93212514]
curr_Stock_Price:  101.96223863512165
curr_Factors:  [101.96223864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339403]
Stock Position:  -0.003394034509065063
Bond Position:  [12.27818849]


portfolio before change:  [11.93237676]
curr_Stock_Price:  102.11420804075152
curr_Factors:  [102.11420804]
mat_Sqrt:  [[0.15]]
grads:  [0.2149826]
Stock Position:  0.21498260246412101
Bond Position:  [-10.02040144]


portfolio before change:  [12.21542161]
curr_Stock_Price:  103.43371547950721
curr_Factors:  [103.43371548]
mat_Sqrt:  [[0.15]]
grads:  [0.17345018]
Stock Position:  0.1734501788558543
Bond Position:  [-5.72517484]


portfolio before change:  [12.17379819]
curr_Stock_Price:  103.19580517030548
curr_Factors:  [103.19580517]
mat_Sqrt:  [[0.15]]
grads:  [0.03482977]
Stock Position:  0.034829768817728944
Bond Position:  [8.57951215]


portfolio before change:  [12.15291978]
curr_Stock_Price:  102.58096779300743
curr_Factors:  [102.58096779]
mat_Sqrt:  [[0.15]]
grads:  [0.10128175]
Stock Position:  0.10128174534630842
Bond Position:  [1.76334032]


portfolio before change:  [12.19545061]
curr_Stock_Price:  102.99980550972155
curr_Factors:  [102.99980551]
mat_Sqrt:  [[0.15]]
grads:  [0.16314105]
Stock Position:  0.16314104885756844
Bond Position:  [-4.6080457]


portfolio before change:  [12.29611988]
curr_Stock_Price:  103.61863987439925
curr_Factors:  [103.61863987]
mat_Sqrt:  [[0.15]]
grads:  [-0.00979973]
Stock Position:  -0.009799728682605154
Bond Position:  [13.31155444]


portfolio before change:  [12.30022535]
curr_Stock_Price:  103.2846030934732
curr_Factors:  [103.28460309]
mat_Sqrt:  [[0.15]]
grads:  [0.34689982]
Stock Position:  0.3468998154398133
Bond Position:  [-23.5291844]


portfolio before change:  [12.44244556]
curr_Stock_Price:  103.69881729946785
curr_Factors:  [103.6988173]
mat_Sqrt:  [[0.15]]
grads:  [0.58784872]
Stock Position:  0.5878487225409179
Bond Position:  [-48.51677172]


portfolio before change:  [12.02871655]
curr_Stock_Price:  103.00017392564368
curr_Factors:  [103.00017393]
mat_Sqrt:  [[0.15]]
grads:  [0.68758549]
Stock Position:  0.687585491202312
Bond Position:  [-58.79270863]


portfolio before change:  [11.76113513]
curr_Stock_Price:  102.61635726703497
curr_Factors:  [102.61635727]
mat_Sqrt:  [[0.15]]
grads:  [0.07976011]
Stock Position:  0.07976010605305936
Bond Position:  [3.57644359]


portfolio before change:  [11.80294838]
curr_Stock_Price:  103.13779238936958
curr_Factors:  [103.13779239]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596065]
Stock Position:  -0.0459606467412756
Bond Position:  [16.54322803]


portfolio before change:  [11.81922737]
curr_Stock_Price:  102.8060955239712
curr_Factors:  [102.80609552]
mat_Sqrt:  [[0.15]]
grads:  [0.18879151]
Stock Position:  0.18879151395302024
Bond Position:  [-7.58969105]


portfolio before change:  [11.95537818]
curr_Stock_Price:  103.52977839142277
curr_Factors:  [103.52977839]
mat_Sqrt:  [[0.15]]
grads:  [0.0904726]
Stock Position:  0.0904726027831711
Bond Position:  [2.58876967]


portfolio before change:  [11.96343137]
curr_Stock_Price:  103.61700242650201
curr_Factors:  [103.61700243]
mat_Sqrt:  [[0.15]]
grads:  [-0.01533095]
Stock Position:  -0.015330953458603918
Bond Position:  [13.55197881]


portfolio before change:  [11.96313853]
curr_Stock_Price:  103.69135315555496
curr_Factors:  [103.69135316]
mat_Sqrt:  [[0.15]]
grads:  [0.07264716]
Stock Position:  0.07264715554214232
Bond Position:  [4.43025667]


portfolio before change:  [11.9607313]
curr_Stock_Price:  103.6544057003957
curr_Factors:  [103.6544057]
mat_Sqrt:  [[0.15]]
grads:  [-0.0533537]
Stock Position:  -0.053353703407997395
Bond Position:  [17.49107772]


portfolio before change:  [11.97091272]
curr_Stock_Price:  103.48406708423353
curr_Factors:  [103.48406708]
mat_Sqrt:  [[0.15]]
grads:  [0.09720853]
Stock Position:  0.09720852878005583
Bond Position:  [1.91137881]


portfolio before change:  [11.95404783]
curr_Stock_Price:  103.3093462421877
curr_Factors:  [103.30934624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0703873]
Stock Position:  -0.07038730427693253
Bond Position:  [19.22571422]


portfolio before change:  [11.87984173]
curr_Stock_Price:  104.38067221336092
curr_Factors:  [104.38067221]
mat_Sqrt:  [[0.15]]
grads:  [0.07099468]
Stock Position:  0.07099468030266337
Bond Position:  [4.46936928]


portfolio before change:  [11.84612303]
curr_Stock_Price:  103.90179056187856
curr_Factors:  [103.90179056]
mat_Sqrt:  [[0.15]]
grads:  [-0.32600801]
Stock Position:  -0.3260080077126168
Bond Position:  [45.71893876]


portfolio before change:  [12.02608263]
curr_Stock_Price:  103.3585460015471
curr_Factors:  [103.358546]
mat_Sqrt:  [[0.15]]
grads:  [0.04449067]
Stock Position:  0.04449066700847701
Bond Position:  [7.42759197]


portfolio before change:  [11.99487805]
curr_Stock_Price:  102.64673803562951
curr_Factors:  [102.64673804]
mat_Sqrt:  [[0.15]]
grads:  [0.05241515]
Stock Position:  0.05241515083128209
Bond Position:  [6.6146338]


portfolio before change:  [11.954456]
curr_Stock_Price:  101.86766016376507
curr_Factors:  [101.86766016]
mat_Sqrt:  [[0.15]]
grads:  [-0.03621839]
Stock Position:  -0.036218393480116386
Bond Position:  [15.643939]


portfolio before change:  [11.93808935]
curr_Stock_Price:  102.34654462011149
curr_Factors:  [102.34654462]
mat_Sqrt:  [[0.15]]
grads:  [0.06862619]
Stock Position:  0.06862619212659883
Bond Position:  [4.91443571]


portfolio before change:  [11.95088151]
curr_Stock_Price:  102.5284722816603
curr_Factors:  [102.52847228]
mat_Sqrt:  [[0.15]]
grads:  [0.24667943]
Stock Position:  0.24667943210959647
Bond Position:  [-13.34078381]


portfolio before change:  [12.00949015]
curr_Stock_Price:  102.7694427752292
curr_Factors:  [102.76944278]
mat_Sqrt:  [[0.15]]
grads:  [0.01016416]
Stock Position:  0.010164160739015783
Bond Position:  [10.96492502]


portfolio before change:  [11.99470533]
curr_Stock_Price:  101.24741312774003
curr_Factors:  [101.24741313]
mat_Sqrt:  [[0.15]]
grads:  [0.06363235]
Stock Position:  0.06363234749828707
Bond Position:  [5.55209475]


portfolio before change:  [11.98467719]
curr_Stock_Price:  101.08436471757165
curr_Factors:  [101.08436472]
mat_Sqrt:  [[0.15]]
grads:  [-0.07877614]
Stock Position:  -0.07877613779739659
Bond Position:  [19.94771303]


portfolio before change:  [11.95919413]
curr_Stock_Price:  101.42367852295644
curr_Factors:  [101.42367852]
mat_Sqrt:  [[0.15]]
grads:  [0.05936184]
Stock Position:  0.059361838578912814
Bond Position:  [5.9384981]


portfolio before change:  [11.95018997]
curr_Stock_Price:  101.26574321533093
curr_Factors:  [101.26574322]
mat_Sqrt:  [[0.15]]
grads:  [0.05210463]
Stock Position:  0.05210462770962615
Bond Position:  [6.67377612]


portfolio before change:  [11.92116213]
curr_Stock_Price:  100.700631078993
curr_Factors:  [100.70063108]
mat_Sqrt:  [[0.15]]
grads:  [0.07628146]
Stock Position:  0.07628145671812837
Bond Position:  [4.2395713]


portfolio before change:  [11.96258469]
curr_Stock_Price:  101.24017992731427
curr_Factors:  [101.24017993]
mat_Sqrt:  [[0.15]]
grads:  [0.05835037]
Stock Position:  0.05835037054520705
Bond Position:  [6.05518268]


portfolio before change:  [11.93504271]
curr_Stock_Price:  100.76168350341904
curr_Factors:  [100.7616835]
mat_Sqrt:  [[0.15]]
grads:  [-0.22802438]
Stock Position:  -0.2280243838792187
Bond Position:  [34.9111635]


portfolio before change:  [12.00960561]
curr_Stock_Price:  100.44425741867848
curr_Factors:  [100.44425742]
mat_Sqrt:  [[0.15]]
grads:  [0.06508665]
Stock Position:  0.06508664657417214
Bond Position:  [5.47202573]


portfolio before change:  [11.94349956]
curr_Stock_Price:  99.42334044986302
curr_Factors:  [99.42334045]
mat_Sqrt:  [[0.15]]
grads:  [-0.09020137]
Stock Position:  -0.09020136583778612
Bond Position:  [20.91162066]


portfolio before change:  [11.86388642]
curr_Stock_Price:  100.32044606435944
curr_Factors:  [100.32044606]
mat_Sqrt:  [[0.15]]
grads:  [0.15364094]
Stock Position:  0.15364094421528335
Bond Position:  [-3.54944163]


portfolio before change:  [11.9041525]
curr_Stock_Price:  100.58396903824035
curr_Factors:  [100.58396904]
mat_Sqrt:  [[0.15]]
grads:  [-0.03995656]
Stock Position:  -0.03995656130818975
Bond Position:  [15.92314202]


portfolio before change:  [11.92537337]
curr_Stock_Price:  100.07777819286143
curr_Factors:  [100.07777819]
mat_Sqrt:  [[0.15]]
grads:  [-0.07796595]
Stock Position:  -0.07796594613464151
Bond Position:  [19.72803203]


portfolio before change:  [11.93948107]
curr_Stock_Price:  99.91264639944961
curr_Factors:  [99.9126464]
mat_Sqrt:  [[0.15]]
grads:  [0.15756347]
Stock Position:  0.15756347140362018
Bond Position:  [-3.80310234]


portfolio before change:  [11.96745813]
curr_Stock_Price:  100.09171558576367
curr_Factors:  [100.09171559]
mat_Sqrt:  [[0.15]]
grads:  [0.02485774]
Stock Position:  0.024857739716438784
Bond Position:  [9.47940431]


portfolio before change:  [11.9933306]
curr_Stock_Price:  101.10870248871927
curr_Factors:  [101.10870249]
mat_Sqrt:  [[0.15]]
grads:  [-0.04650987]
Stock Position:  -0.04650986953874669
Bond Position:  [16.69588317]


portfolio before change:  [12.01785224]
curr_Stock_Price:  100.60390409948046
curr_Factors:  [100.6039041]
mat_Sqrt:  [[0.15]]
grads:  [0.01124863]
Stock Position:  0.011248633000757804
Bond Position:  [10.88619584]


portfolio before change:  [12.02571641]
curr_Stock_Price:  101.24253846541987
curr_Factors:  [101.24253847]
mat_Sqrt:  [[0.15]]
grads:  [0.07440272]
Stock Position:  0.07440272498705672
Bond Position:  [4.49299566]


portfolio before change:  [12.02753306]
curr_Stock_Price:  101.2631806455836
curr_Factors:  [101.26318065]
mat_Sqrt:  [[0.15]]
grads:  [-0.03693078]
Stock Position:  -0.03693078414783416
Bond Position:  [15.76726173]


portfolio before change:  [12.00100935]
curr_Stock_Price:  102.00806588110915
curr_Factors:  [102.00806588]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359009]
Stock Position:  -0.03359008779202487
Bond Position:  [15.42746924]


portfolio before change:  [11.98548424]
curr_Stock_Price:  102.49896549630655
curr_Factors:  [102.4989655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04955819]
Stock Position:  -0.049558194458620246
Bond Position:  [17.0651479]


portfolio before change:  [11.93410714]
curr_Stock_Price:  103.5571901110597
curr_Factors:  [103.55719011]
mat_Sqrt:  [[0.15]]
grads:  [-0.17869613]
Stock Position:  -0.17869613156268266
Bond Position:  [30.43937641]


portfolio before change:  [11.89370716]
curr_Stock_Price:  103.79391881258611
curr_Factors:  [103.79391881]
mat_Sqrt:  [[0.15]]
grads:  [0.01918754]
Stock Position:  0.019187542990152923
Bond Position:  [9.90215688]


portfolio before change:  [11.91910764]
curr_Stock_Price:  105.08546405206238
curr_Factors:  [105.08546405]
mat_Sqrt:  [[0.15]]
grads:  [-0.0647058]
Stock Position:  -0.06470580278183874
Bond Position:  [18.71874696]


portfolio before change:  [11.89509341]
curr_Stock_Price:  105.47467473699876
curr_Factors:  [105.47467474]
mat_Sqrt:  [[0.15]]
grads:  [0.03908908]
Stock Position:  0.03908908269388743
Bond Position:  [7.77218513]


portfolio before change:  [11.90307735]
curr_Stock_Price:  105.66649721884855
curr_Factors:  [105.66649722]
mat_Sqrt:  [[0.15]]
grads:  [-0.11012883]
Stock Position:  -0.11012883307656751
Bond Position:  [23.54000539]


portfolio before change:  [11.89353173]
curr_Stock_Price:  105.76653390769204
curr_Factors:  [105.76653391]
mat_Sqrt:  [[0.15]]
grads:  [0.16022385]
Stock Position:  0.16022384899261843
Bond Position:  [-5.05278943]


portfolio before change:  [11.86287744]
curr_Stock_Price:  105.57718331878125
curr_Factors:  [105.57718332]
mat_Sqrt:  [[0.15]]
grads:  [0.08900087]
Stock Position:  0.08900087483082626
Bond Position:  [2.46641576]


portfolio before change:  [11.84900963]
curr_Stock_Price:  105.41963466705107
curr_Factors:  [105.41963467]
mat_Sqrt:  [[0.15]]
grads:  [0.00763232]
Stock Position:  0.00763232042770166
Bond Position:  [11.04441319]


portfolio before change:  [11.8548366]
curr_Stock_Price:  106.09265138478239
curr_Factors:  [106.09265138]
mat_Sqrt:  [[0.15]]
grads:  [0.01287876]
Stock Position:  0.012878759114304464
Bond Position:  [10.4884949]


portfolio before change:  [11.8428265]
curr_Stock_Price:  105.10919853517842
curr_Factors:  [105.10919854]
mat_Sqrt:  [[0.15]]
grads:  [0.05833716]
Stock Position:  0.05833716278883304
Bond Position:  [5.71105408]


portfolio before change:  [11.8629994]
curr_Stock_Price:  105.44887810431517
curr_Factors:  [105.4488781]
mat_Sqrt:  [[0.15]]
grads:  [0.09195828]
Stock Position:  0.09195828139357841
Bond Position:  [2.16610179]


portfolio before change:  [11.88996296]
curr_Stock_Price:  105.74062107590115
curr_Factors:  [105.74062108]
mat_Sqrt:  [[0.15]]
grads:  [0.24732694]
Stock Position:  0.2473269391297015
Bond Position:  [-14.26254119]


portfolio before change:  [11.7527813]
curr_Stock_Price:  105.18956819341926
curr_Factors:  [105.18956819]
mat_Sqrt:  [[0.15]]
grads:  [0.0053531]
Stock Position:  0.005353104487874662
Bond Position:  [11.18969055]


portfolio before change:  [11.75891227]
curr_Stock_Price:  106.20422935217044
curr_Factors:  [106.20422935]
mat_Sqrt:  [[0.15]]
grads:  [-0.08122168]
Stock Position:  -0.08122168498535538
Bond Position:  [20.38499873]


portfolio before change:  [11.70804533]
curr_Stock_Price:  106.8461889758378
curr_Factors:  [106.84618898]
mat_Sqrt:  [[0.15]]
grads:  [0.11516004]
Stock Position:  0.11516003993462211
Bond Position:  [-0.59636606]


portfolio before change:  [11.69208447]
curr_Stock_Price:  106.70791543835163
curr_Factors:  [106.70791544]
mat_Sqrt:  [[0.15]]
grads:  [0.05503642]
Stock Position:  0.05503641863033544
Bond Position:  [5.81926296]


portfolio before change:  [11.69526791]
curr_Stock_Price:  106.75914926929569
curr_Factors:  [106.75914927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352618]
Stock Position:  -0.03352618356600194
Bond Position:  [15.27449475]


portfolio before change:  [11.71307979]
curr_Stock_Price:  106.25634246151624
curr_Factors:  [106.25634246]
mat_Sqrt:  [[0.15]]
grads:  [0.10368973]
Stock Position:  0.10368972956223062
Bond Position:  [0.69538838]


portfolio before change:  [11.71151106]
curr_Stock_Price:  106.24079425893159
curr_Factors:  [106.24079426]
mat_Sqrt:  [[0.15]]
grads:  [-0.09441357]
Stock Position:  -0.0944135652478576
Bond Position:  [21.74208322]


portfolio before change:  [11.61611441]
curr_Stock_Price:  107.26560017652345
curr_Factors:  [107.26560018]
mat_Sqrt:  [[0.15]]
grads:  [-0.23864073]
Stock Position:  -0.2386407278480535
Bond Position:  [37.2140553]


portfolio before change:  [11.65891446]
curr_Stock_Price:  107.0959975225373
curr_Factors:  [107.09599752]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597927]
Stock Position:  -0.04597927063744507
Bond Position:  [16.58311031]


portfolio before change:  [11.70567851]
curr_Stock_Price:  106.10147153201927
curr_Factors:  [106.10147153]
mat_Sqrt:  [[0.15]]
grads:  [0.09927868]
Stock Position:  0.09927868357195545
Bond Position:  [1.1720641]


portfolio before change:  [11.71483778]
curr_Stock_Price:  106.19299181766544
curr_Factors:  [106.19299182]
mat_Sqrt:  [[0.15]]
grads:  [-0.1223156]
Stock Position:  -0.12231560385787042
Bond Position:  [24.7038977]


portfolio before change:  [11.53321282]
curr_Stock_Price:  107.6905031503341
curr_Factors:  [107.69050315]
mat_Sqrt:  [[0.15]]
grads:  [0.19015336]
Stock Position:  0.19015335848284967
Bond Position:  [-8.94449803]


portfolio before change:  [11.38395486]
curr_Stock_Price:  106.90850848345491
curr_Factors:  [106.90850848]
mat_Sqrt:  [[0.15]]
grads:  [-0.19055067]
Stock Position:  -0.19055066515607533
Bond Position:  [31.75544226]


portfolio before change:  [11.37004713]
curr_Stock_Price:  106.99191152897133
curr_Factors:  [106.99191153]
mat_Sqrt:  [[0.15]]
grads:  [0.03289972]
Stock Position:  0.03289972286310111
Bond Position:  [7.8500429]


portfolio before change:  [11.37772886]
curr_Stock_Price:  107.21048743894548
curr_Factors:  [107.21048744]
mat_Sqrt:  [[0.15]]
grads:  [0.04675449]
Stock Position:  0.04675449061719936
Bond Position:  [6.36515713]


portfolio before change:  [11.37117938]
curr_Stock_Price:  107.0618960023966
curr_Factors:  [107.061896]
mat_Sqrt:  [[0.15]]
grads:  [-0.10362773]
Stock Position:  -0.10362772531139604
Bond Position:  [22.46576013]


portfolio before change:  [11.44429426]
curr_Stock_Price:  106.3698927192361
curr_Factors:  [106.36989272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.44429426]
Stock Price:  105.49302737609527
PL:  [5.95126688]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.69891937e-04]
 [ 2.52051328e-03]
 [-1.43842304e-03]
 [ 6.98799461e-03]
 [ 5.15132447e-03]
 [ 2.35621233e-02]
 [ 8.28318704e-04]
 [-1.84009553e-02]
 [ 1.31472381e-02]
 [ 1.97261805e-02]
 [ 1.31923702e-02]
 [-1.09182722e-02]
 [ 1.79125244e-03]
 [ 7.68171451e-03]
 [-6.95779669e-03]
 [ 8.61700477e-03]
 [ 7.21912874e-03]
 [-8.73583937e-03]
 [ 1.86811748e-03]
 [ 9.07269753e-03]
 [ 1.24970050e-02]
 [-1.02603063e-02]
 [ 3.65180688e-03]
 [-2.10622407e-02]
 [-1.09847138e-02]
 [-3.83735027e-03]
 [-1.76036254e-03]
 [ 7.52123932e-03]
 [-1.93948980e-02]
 [-1.44063322e-03]
 [-4.84309752e-03]
 [-1.05694191e-02]
 [ 5.21635682e-04]
 [ 5.84813300e-03]
 [ 1.14648891e-02]
 [ 9.76576611e-03]
 [-3.41979117e-02]
 [ 9.67951367e-03]
 [ 4.48452717e-03]
 [ 1.86496740e-02]
 [-4.53440125e-03]
 [-1.86939230e-02]
 [ 2.07129502e-02]
 [-2.88164190e-04]
 [ 2.99836990e-03]
 [-1.64670012e-02]
 [ 1.41852210e-02]
 [ 8.74848899e-03]
 [ 2.88523155e-03]
 [-7.40127194e-03]
 [-3.62890660e-02]
 [ 2.22110966e-03]
 [-7.78962230e-03]
 [ 5.50059311e-03]
 [ 2.34986922e-05]
 [-1.13612101e-03]
 [ 6.13369741e-03]
 [-3.96426475e-04]
 [ 1.56462215e-03]
 [ 1.48674938e-02]
 [ 9.00849938e-04]
 [-1.19550844e-02]
 [-8.36506428e-03]
 [-1.38957069e-02]
 [-1.16295728e-02]
 [ 1.70190590e-03]
 [-5.34792109e-03]
 [ 2.43266675e-02]
 [-8.66067130e-03]
 [ 8.07159290e-03]
 [-1.04358568e-02]
 [ 1.10286686e-02]
 [-7.35091686e-03]
 [ 9.55947913e-03]
 [-2.03875154e-02]
 [-4.26778715e-03]
 [-6.94267020e-03]
 [-1.51125160e-03]
 [ 1.77945478e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.09758388]
curr_Stock_Price:  100.19871673792602
curr_Factors:  [100.19871674]
mat_Sqrt:  [[0.15]]
grads:  [0.00446595]
Stock Position:  0.004465946249288918
Bond Position:  [4.6501018]


portfolio before change:  [5.09705502]
curr_Stock_Price:  100.01521683642036
curr_Factors:  [100.01521684]
mat_Sqrt:  [[0.15]]
grads:  [0.01680342]
Stock Position:  0.016803421895377566
Bond Position:  [3.41645714]


portfolio before change:  [5.1037101]
curr_Stock_Price:  100.39856414095948
curr_Factors:  [100.39856414]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958949]
Stock Position:  -0.009589486927745264
Bond Position:  [6.06648082]


portfolio before change:  [5.10456006]
curr_Stock_Price:  100.3494700061533
curr_Factors:  [100.34947001]
mat_Sqrt:  [[0.15]]
grads:  [0.04658663]
Stock Position:  0.04658663073120975
Bond Position:  [0.42961635]


portfolio before change:  [5.07550406]
curr_Stock_Price:  99.72519533899333
curr_Factors:  [99.72519534]
mat_Sqrt:  [[0.15]]
grads:  [0.03434216]
Stock Position:  0.03434216313429658
Bond Position:  [1.65072513]


portfolio before change:  [5.08149917]
curr_Stock_Price:  99.89676108299744
curr_Factors:  [99.89676108]
mat_Sqrt:  [[0.15]]
grads:  [0.15708082]
Stock Position:  0.15708082231451478
Bond Position:  [-10.61036621]


portfolio before change:  [5.00984355]
curr_Stock_Price:  99.44481252760374
curr_Factors:  [99.44481253]
mat_Sqrt:  [[0.15]]
grads:  [0.00552212]
Stock Position:  0.005522124693759168
Bond Position:  [4.46069689]


portfolio before change:  [5.01134199]
curr_Stock_Price:  99.66567650670967
curr_Factors:  [99.66567651]
mat_Sqrt:  [[0.15]]
grads:  [-0.12267304]
Stock Position:  -0.1226730351322188
Bond Position:  [17.23763302]


portfolio before change:  [5.01945368]
curr_Stock_Price:  99.60833456373742
curr_Factors:  [99.60833456]
mat_Sqrt:  [[0.15]]
grads:  [0.08764825]
Stock Position:  0.08764825406289675
Bond Position:  [-3.71104293]


portfolio before change:  [4.96513185]
curr_Stock_Price:  98.9912099846703
curr_Factors:  [98.99120998]
mat_Sqrt:  [[0.15]]
grads:  [0.13150787]
Stock Position:  0.1315078700019166
Bond Position:  [-8.05299133]


portfolio before change:  [5.0806682]
curr_Stock_Price:  99.87358825423313
curr_Factors:  [99.87358825]
mat_Sqrt:  [[0.15]]
grads:  [0.08794913]
Stock Position:  0.08794913453945126
Bond Position:  [-3.70312745]


portfolio before change:  [5.09921544]
curr_Stock_Price:  100.08710580157882
curr_Factors:  [100.0871058]
mat_Sqrt:  [[0.15]]
grads:  [-0.07278848]
Stock Position:  -0.07278848128487915
Bond Position:  [12.38440386]


portfolio before change:  [5.08655026]
curr_Stock_Price:  100.27173976849274
curr_Factors:  [100.27173977]
mat_Sqrt:  [[0.15]]
grads:  [0.01194168]
Stock Position:  0.011941682921432727
Bond Position:  [3.88913694]


portfolio before change:  [5.06946168]
curr_Stock_Price:  98.82038180798574
curr_Factors:  [98.82038181]
mat_Sqrt:  [[0.15]]
grads:  [0.05121143]
Stock Position:  0.05121143009522299
Bond Position:  [0.00872861]


portfolio before change:  [5.06954844]
curr_Stock_Price:  98.82206524171484
curr_Factors:  [98.82206524]
mat_Sqrt:  [[0.15]]
grads:  [-0.04638531]
Stock Position:  -0.04638531125333663
Bond Position:  [9.65344069]


portfolio before change:  [5.04738871]
curr_Stock_Price:  99.31280434694479
curr_Factors:  [99.31280435]
mat_Sqrt:  [[0.15]]
grads:  [0.0574467]
Stock Position:  0.057446698452652836
Bond Position:  [-0.65780401]


portfolio before change:  [5.04791096]
curr_Stock_Price:  99.32261101055407
curr_Factors:  [99.32261101]
mat_Sqrt:  [[0.15]]
grads:  [0.04812752]
Stock Position:  0.04812752490890453
Bond Position:  [0.26775952]


portfolio before change:  [4.99849764]
curr_Stock_Price:  98.2955469937131
curr_Factors:  [98.29554699]
mat_Sqrt:  [[0.15]]
grads:  [-0.05823893]
Stock Position:  -0.058238929100270405
Bond Position:  [10.72312504]


portfolio before change:  [5.0194071]
curr_Stock_Price:  97.94802615705682
curr_Factors:  [97.94802616]
mat_Sqrt:  [[0.15]]
grads:  [0.01245412]
Stock Position:  0.01245411651078985
Bond Position:  [3.79955097]


portfolio before change:  [5.01464656]
curr_Stock_Price:  97.54671142931589
curr_Factors:  [97.54671143]
mat_Sqrt:  [[0.15]]
grads:  [0.06048465]
Stock Position:  0.060484650176869915
Bond Position:  [-0.88543216]


portfolio before change:  [5.02025212]
curr_Stock_Price:  97.64030371809544
curr_Factors:  [97.64030372]
mat_Sqrt:  [[0.15]]
grads:  [0.08331337]
Stock Position:  0.08331336698782695
Bond Position:  [-3.11449034]


portfolio before change:  [4.97289515]
curr_Stock_Price:  97.07422046514232
curr_Factors:  [97.07422047]
mat_Sqrt:  [[0.15]]
grads:  [-0.06840204]
Stock Position:  -0.06840204213392853
Bond Position:  [11.61297007]


portfolio before change:  [4.97720668]
curr_Stock_Price:  97.0217996575238
curr_Factors:  [97.02179966]
mat_Sqrt:  [[0.15]]
grads:  [0.02434538]
Stock Position:  0.02434537918761782
Bond Position:  [2.61517417]


portfolio before change:  [4.98335434]
curr_Stock_Price:  97.26760456128346
curr_Factors:  [97.26760456]
mat_Sqrt:  [[0.15]]
grads:  [-0.14041494]
Stock Position:  -0.14041493808313793
Bond Position:  [18.64117901]


portfolio before change:  [5.03379693]
curr_Stock_Price:  96.91666271812542
curr_Factors:  [96.91666272]
mat_Sqrt:  [[0.15]]
grads:  [-0.07323143]
Stock Position:  -0.07323142520096519
Bond Position:  [12.13114227]


portfolio before change:  [5.04143514]
curr_Stock_Price:  96.82271408793629
curr_Factors:  [96.82271409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02558234]
Stock Position:  -0.025582335113717783
Bond Position:  [7.51838626]


portfolio before change:  [5.02904159]
curr_Stock_Price:  97.32554023398961
curr_Factors:  [97.32554023]
mat_Sqrt:  [[0.15]]
grads:  [-0.01173575]
Stock Position:  -0.011735750259324072
Bond Position:  [6.17122982]


portfolio before change:  [5.01785368]
curr_Stock_Price:  98.31172557082749
curr_Factors:  [98.31172557]
mat_Sqrt:  [[0.15]]
grads:  [0.0501416]
Stock Position:  0.0501415954998817
Bond Position:  [0.0883469]


portfolio before change:  [5.00393649]
curr_Stock_Price:  98.03405773590596
curr_Factors:  [98.03405774]
mat_Sqrt:  [[0.15]]
grads:  [-0.12929932]
Stock Position:  -0.12929931975555686
Bond Position:  [17.67967347]


portfolio before change:  [4.87131328]
curr_Stock_Price:  99.06831087910042
curr_Factors:  [99.06831088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00960422]
Stock Position:  -0.009604221482700228
Bond Position:  [5.82278728]


portfolio before change:  [4.86947875]
curr_Stock_Price:  99.2972173080054
curr_Factors:  [99.29721731]
mat_Sqrt:  [[0.15]]
grads:  [-0.03228732]
Stock Position:  -0.03228731678786355
Bond Position:  [8.07551946]


portfolio before change:  [4.86161067]
curr_Stock_Price:  99.55653918172311
curr_Factors:  [99.55653918]
mat_Sqrt:  [[0.15]]
grads:  [-0.07046279]
Stock Position:  -0.07046279390911253
Bond Position:  [11.87664258]


portfolio before change:  [4.85186887]
curr_Stock_Price:  99.70532863135625
curr_Factors:  [99.70532863]
mat_Sqrt:  [[0.15]]
grads:  [0.00347757]
Stock Position:  0.0034775712104948443
Bond Position:  [4.50513649]


portfolio before change:  [4.8540173]
curr_Stock_Price:  100.2421564101276
curr_Factors:  [100.24215641]
mat_Sqrt:  [[0.15]]
grads:  [0.03898755]
Stock Position:  0.03898755333350604
Bond Position:  [0.94582088]


portfolio before change:  [4.88625703]
curr_Stock_Price:  101.06756364620593
curr_Factors:  [101.06756365]
mat_Sqrt:  [[0.15]]
grads:  [0.07643259]
Stock Position:  0.07643259423549033
Bond Position:  [-2.83859905]


portfolio before change:  [4.85701671]
curr_Stock_Price:  100.68732141567311
curr_Factors:  [100.68732142]
mat_Sqrt:  [[0.15]]
grads:  [0.06510511]
Stock Position:  0.06510510740748908
Bond Position:  [-1.69824217]


portfolio before change:  [4.86248479]
curr_Stock_Price:  100.77294031639413
curr_Factors:  [100.77294032]
mat_Sqrt:  [[0.15]]
grads:  [-0.22798608]
Stock Position:  -0.22798607783556646
Bond Position:  [27.83731221]


portfolio before change:  [4.77799917]
curr_Stock_Price:  101.1511454891842
curr_Factors:  [101.15114549]
mat_Sqrt:  [[0.15]]
grads:  [0.06453009]
Stock Position:  0.06453009112755466
Bond Position:  [-1.74929347]


portfolio before change:  [4.81594305]
curr_Stock_Price:  101.74084274876331
curr_Factors:  [101.74084275]
mat_Sqrt:  [[0.15]]
grads:  [0.02989685]
Stock Position:  0.02989684781573863
Bond Position:  [1.77421256]


portfolio before change:  [4.84153276]
curr_Stock_Price:  102.59306714144248
curr_Factors:  [102.59306714]
mat_Sqrt:  [[0.15]]
grads:  [0.12433116]
Stock Position:  0.12433116000798453
Bond Position:  [-7.91398228]


portfolio before change:  [4.84421772]
curr_Stock_Price:  102.61864069772008
curr_Factors:  [102.6186407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03022934]
Stock Position:  -0.030229341698886886
Bond Position:  [7.94631167]


portfolio before change:  [4.824453]
curr_Stock_Price:  103.28889583265074
curr_Factors:  [103.28889583]
mat_Sqrt:  [[0.15]]
grads:  [-0.12462615]
Stock Position:  -0.12462615365775238
Bond Position:  [17.69695081]


portfolio before change:  [4.79618144]
curr_Stock_Price:  103.52462211201254
curr_Factors:  [103.52462211]
mat_Sqrt:  [[0.15]]
grads:  [0.13808633]
Stock Position:  0.13808633480982596
Bond Position:  [-9.49915419]


portfolio before change:  [4.67095538]
curr_Stock_Price:  102.62205382058796
curr_Factors:  [102.62205382]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192109]
Stock Position:  -0.0019210945990954208
Bond Position:  [4.86810205]


portfolio before change:  [4.66994378]
curr_Stock_Price:  103.30700776020994
curr_Factors:  [103.30700776]
mat_Sqrt:  [[0.15]]
grads:  [0.01998913]
Stock Position:  0.01998913268093672
Bond Position:  [2.60492629]


portfolio before change:  [4.67617214]
curr_Stock_Price:  103.61044976316228
curr_Factors:  [103.61044976]
mat_Sqrt:  [[0.15]]
grads:  [-0.10978001]
Stock Position:  -0.10978000832740287
Bond Position:  [16.05052817]


portfolio before change:  [4.75328457]
curr_Stock_Price:  102.91716100851684
curr_Factors:  [102.91716101]
mat_Sqrt:  [[0.15]]
grads:  [0.09456814]
Stock Position:  0.09456814000868735
Bond Position:  [-4.97939992]


portfolio before change:  [4.82770957]
curr_Stock_Price:  103.70745066599804
curr_Factors:  [103.70745067]
mat_Sqrt:  [[0.15]]
grads:  [0.05832326]
Stock Position:  0.0583232599423329
Bond Position:  [-1.22084703]


portfolio before change:  [4.79481348]
curr_Stock_Price:  103.1447285437125
curr_Factors:  [103.14472854]
mat_Sqrt:  [[0.15]]
grads:  [0.01923488]
Stock Position:  0.01923487702630526
Bond Position:  [2.81083731]


portfolio before change:  [4.79030549]
curr_Stock_Price:  102.9012295197456
curr_Factors:  [102.90122952]
mat_Sqrt:  [[0.15]]
grads:  [-0.04934181]
Stock Position:  -0.04934181293174801
Bond Position:  [9.8676387]


portfolio before change:  [4.78231344]
curr_Stock_Price:  103.07570211335778
curr_Factors:  [103.07570211]
mat_Sqrt:  [[0.15]]
grads:  [-0.24192711]
Stock Position:  -0.24192710697146677
Bond Position:  [29.71911985]


portfolio before change:  [4.87618329]
curr_Stock_Price:  102.69537123539331
curr_Factors:  [102.69537124]
mat_Sqrt:  [[0.15]]
grads:  [0.0148074]
Stock Position:  0.014807397726735172
Bond Position:  [3.35553208]


portfolio before change:  [4.87211766]
curr_Stock_Price:  102.40663971335204
curr_Factors:  [102.40663971]
mat_Sqrt:  [[0.15]]
grads:  [-0.05193082]
Stock Position:  -0.051930815301519134
Bond Position:  [10.19017795]


portfolio before change:  [4.88759495]
curr_Stock_Price:  102.12086746529863
curr_Factors:  [102.12086747]
mat_Sqrt:  [[0.15]]
grads:  [0.03667062]
Stock Position:  0.03667062072889604
Bond Position:  [1.14275935]


portfolio before change:  [4.8848253]
curr_Stock_Price:  102.04339203033267
curr_Factors:  [102.04339203]
mat_Sqrt:  [[0.15]]
grads:  [0.00015666]
Stock Position:  0.00015665794813734282
Bond Position:  [4.86883939]


portfolio before change:  [4.88504263]
curr_Stock_Price:  101.48818508620724
curr_Factors:  [101.48818509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00757414]
Stock Position:  -0.007574140039202556
Bond Position:  [5.65372836]


portfolio before change:  [4.88681885]
curr_Stock_Price:  101.30032929412602
curr_Factors:  [101.30032929]
mat_Sqrt:  [[0.15]]
grads:  [0.04089132]
Stock Position:  0.04089131603947413
Bond Position:  [0.74451507]


portfolio before change:  [4.87117357]
curr_Stock_Price:  100.91658483390299
curr_Factors:  [100.91658483]
mat_Sqrt:  [[0.15]]
grads:  [-0.00264284]
Stock Position:  -0.002642843168659208
Bond Position:  [5.13788027]


portfolio before change:  [4.87125449]
curr_Stock_Price:  101.00747281667964
curr_Factors:  [101.00747282]
mat_Sqrt:  [[0.15]]
grads:  [0.01043081]
Stock Position:  0.010430814336779915
Bond Position:  [3.8176643]


portfolio before change:  [4.87954736]
curr_Stock_Price:  101.77963268626615
curr_Factors:  [101.77963269]
mat_Sqrt:  [[0.15]]
grads:  [0.09911663]
Stock Position:  0.09911662561037404
Bond Position:  [-5.20850639]


portfolio before change:  [4.75659524]
curr_Stock_Price:  100.54243789112166
curr_Factors:  [100.54243789]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [4.15277092]


portfolio before change:  [4.7544211]
curr_Stock_Price:  100.13720434711377
curr_Factors:  [100.13720435]
mat_Sqrt:  [[0.15]]
grads:  [-0.07970056]
Stock Position:  -0.07970056251665719
Bond Position:  [12.73541262]


portfolio before change:  [4.71843634]
curr_Stock_Price:  100.59869108011607
curr_Factors:  [100.59869108]
mat_Sqrt:  [[0.15]]
grads:  [-0.0557671]
Stock Position:  -0.055767095175016476
Bond Position:  [10.32853312]


portfolio before change:  [4.71798233]
curr_Stock_Price:  100.61840815366344
curr_Factors:  [100.61840815]
mat_Sqrt:  [[0.15]]
grads:  [-0.09263805]
Stock Position:  -0.09263804612233893
Bond Position:  [14.03907506]


portfolio before change:  [4.80048226]
curr_Stock_Price:  99.73731807700133
curr_Factors:  [99.73731808]
mat_Sqrt:  [[0.15]]
grads:  [-0.07753049]
Stock Position:  -0.07753048561130421
Bond Position:  [12.53316497]


portfolio before change:  [4.76661292]
curr_Stock_Price:  100.18427374906629
curr_Factors:  [100.18427375]
mat_Sqrt:  [[0.15]]
grads:  [0.01134604]
Stock Position:  0.011346039311749939
Bond Position:  [3.62991821]


portfolio before change:  [4.76743211]
curr_Stock_Price:  100.23647862649234
curr_Factors:  [100.23647863]
mat_Sqrt:  [[0.15]]
grads:  [-0.03565281]
Stock Position:  -0.035652807293926884
Bond Position:  [8.34114397]


portfolio before change:  [4.77898651]
curr_Stock_Price:  99.92702020604266
curr_Factors:  [99.92702021]
mat_Sqrt:  [[0.15]]
grads:  [0.16217778]
Stock Position:  0.16217778358970172
Bond Position:  [-11.42695614]


portfolio before change:  [4.77724935]
curr_Stock_Price:  99.92071258757785
curr_Factors:  [99.92071259]
mat_Sqrt:  [[0.15]]
grads:  [-0.05773781]
Stock Position:  -0.05773780869683942
Bond Position:  [10.54645234]


portfolio before change:  [4.75183736]
curr_Stock_Price:  100.3722565763508
curr_Factors:  [100.37225658]
mat_Sqrt:  [[0.15]]
grads:  [0.05381062]
Stock Position:  0.05381061935458658
Bond Position:  [-0.64925593]


portfolio before change:  [4.76150872]
curr_Stock_Price:  100.55274020975577
curr_Factors:  [100.55274021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06957238]
Stock Position:  -0.06957237865267335
Bond Position:  [11.75720204]


portfolio before change:  [4.75199101]
curr_Stock_Price:  100.70010552355332
curr_Factors:  [100.70010552]
mat_Sqrt:  [[0.15]]
grads:  [0.07352446]
Stock Position:  0.07352445759458494
Bond Position:  [-2.65192963]


portfolio before change:  [4.68120546]
curr_Stock_Price:  99.73961152975421
curr_Factors:  [99.73961153]
mat_Sqrt:  [[0.15]]
grads:  [-0.04900611]
Stock Position:  -0.049006112415499
Bond Position:  [9.56905608]


portfolio before change:  [4.70350656]
curr_Stock_Price:  99.29674819925836
curr_Factors:  [99.2967482]
mat_Sqrt:  [[0.15]]
grads:  [0.06372986]
Stock Position:  0.06372986089697126
Bond Position:  [-1.62466139]


portfolio before change:  [4.72786916]
curr_Stock_Price:  99.68062083849706
curr_Factors:  [99.68062084]
mat_Sqrt:  [[0.15]]
grads:  [-0.13591677]
Stock Position:  -0.13591676918653645
Bond Position:  [18.2761371]


portfolio before change:  [4.73071156]
curr_Stock_Price:  99.66811238941295
curr_Factors:  [99.66811239]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845191]
Stock Position:  -0.028451914347302414
Bond Position:  [7.56646016]


portfolio before change:  [4.71867373]
curr_Stock_Price:  100.10782797859099
curr_Factors:  [100.10782798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04628447]
Stock Position:  -0.04628446797306235
Bond Position:  [9.35211129]


portfolio before change:  [4.66364102]
curr_Stock_Price:  101.30946740340413
curr_Factors:  [101.3094674]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007501]
Stock Position:  -0.010075010636707436
Bond Position:  [5.68433498]


portfolio before change:  [4.66155587]
curr_Stock_Price:  101.5516934454287
curr_Factors:  [101.55169345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.66155587]
Stock Price:  101.306360046574
PL:  [3.35519582]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.45304748e-04]
 [ 1.92662658e-03]
 [-4.49115491e-03]
 [ 3.72474456e-03]
 [ 6.73671654e-03]
 [ 2.71117009e-02]
 [ 3.68900737e-03]
 [ 1.13383385e-02]
 [ 2.38046623e-02]
 [-4.57520409e-03]
 [ 4.73713409e-02]
 [ 7.95070547e-02]
 [ 1.42969427e-01]
 [ 2.17657820e-02]
 [-6.89139793e-03]
 [ 3.76308354e-02]
 [ 1.85660088e-02]
 [ 2.18901192e-02]
 [ 2.07374711e-02]
 [-1.14055500e-02]
 [ 1.52356420e-02]
 [-1.97758380e-02]
 [ 9.54629350e-03]
 [-8.74159378e-02]
 [ 1.14916561e-02]
 [ 6.03139122e-03]
 [-3.78257584e-03]
 [ 2.17500976e-02]
 [ 5.92203043e-02]
 [ 7.23021866e-03]
 [ 1.96302615e-02]
 [ 3.92351067e-03]
 [-2.67618811e-03]
 [ 7.91952424e-03]
 [ 1.00518218e-02]
 [ 6.04813891e-03]
 [-3.24480168e-02]
 [ 9.07033356e-03]
 [-1.32525369e-03]
 [ 1.91172576e-02]
 [-5.79600991e-03]
 [-1.50640027e-02]
 [ 2.21114170e-02]
 [ 3.28151848e-03]
 [-8.28082430e-03]
 [-4.84717249e-03]
 [ 4.78138087e-05]
 [-1.23546902e-02]
 [-1.00080688e-02]
 [-3.91122025e-03]
 [ 4.55028417e-02]
 [-8.40615217e-03]
 [ 2.42287738e-03]
 [ 5.01567530e-03]
 [ 4.13856328e-03]
 [ 1.00230600e-03]
 [-7.44163274e-04]
 [-3.71406842e-04]
 [ 1.54500460e-03]
 [-3.79860527e-02]
 [-1.15490083e-02]
 [ 1.80311268e-02]
 [ 1.61540811e-02]
 [-1.90509147e-02]
 [-3.60709025e-03]
 [-1.84506226e-02]
 [-4.21561952e-03]
 [ 1.81267460e-03]
 [-1.71536716e-02]
 [ 1.28096494e-02]
 [ 4.15426453e-03]
 [ 1.22719739e-02]
 [ 3.39556296e-03]
 [ 3.07636226e-04]
 [ 1.42824199e-02]
 [-1.82597954e-02]
 [ 4.96340785e-03]
 [ 7.44248033e-03]
 [-2.89841537e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.65112806]
curr_Stock_Price:  100.49481076103956
curr_Factors:  [100.49481076]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230203]
Stock Position:  -0.002302031654001788
Bond Position:  [9.8824703]


portfolio before change:  [9.65124597]
curr_Stock_Price:  100.71190633039595
curr_Factors:  [100.71190633]
mat_Sqrt:  [[0.15]]
grads:  [0.01284418]
Stock Position:  0.012844177202153646
Bond Position:  [8.3576844]


portfolio before change:  [9.65911591]
curr_Stock_Price:  101.28396069570775
curr_Factors:  [101.2839607]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994103]
Stock Position:  -0.029941032729672613
Bond Position:  [12.6916623]


portfolio before change:  [9.66410601]
curr_Stock_Price:  101.14379039572397
curr_Factors:  [101.1437904]
mat_Sqrt:  [[0.15]]
grads:  [0.02483163]
Stock Position:  0.024831630429683147
Bond Position:  [7.15254079]


portfolio before change:  [9.6538742]
curr_Stock_Price:  100.71373959594713
curr_Factors:  [100.7137396]
mat_Sqrt:  [[0.15]]
grads:  [0.04491144]
Stock Position:  0.0449114435856487
Bond Position:  [5.13067476]


portfolio before change:  [9.70230632]
curr_Stock_Price:  101.78499102021225
curr_Factors:  [101.78499102]
mat_Sqrt:  [[0.15]]
grads:  [0.18074467]
Stock Position:  0.18074467270608288
Bond Position:  [-8.69478857]


portfolio before change:  [9.77515028]
curr_Stock_Price:  102.19101904126651
curr_Factors:  [102.19101904]
mat_Sqrt:  [[0.15]]
grads:  [0.02459338]
Stock Position:  0.02459338247931922
Bond Position:  [7.26192746]


portfolio before change:  [9.77177361]
curr_Stock_Price:  102.03526352878012
curr_Factors:  [102.03526353]
mat_Sqrt:  [[0.15]]
grads:  [0.07558892]
Stock Position:  0.07558892335442198
Bond Position:  [2.0590379]


portfolio before change:  [9.69460101]
curr_Stock_Price:  101.01260978717201
curr_Factors:  [101.01260979]
mat_Sqrt:  [[0.15]]
grads:  [0.15869775]
Stock Position:  0.15869774841691114
Bond Position:  [-6.33587273]


portfolio before change:  [9.80023284]
curr_Stock_Price:  101.68072154392115
curr_Factors:  [101.68072154]
mat_Sqrt:  [[0.15]]
grads:  [-0.03050136]
Stock Position:  -0.03050136058501824
Bond Position:  [12.90163319]


portfolio before change:  [9.7616036]
curr_Stock_Price:  102.97363489447491
curr_Factors:  [102.97363489]
mat_Sqrt:  [[0.15]]
grads:  [0.31580894]
Stock Position:  0.31580893950277655
Bond Position:  [-22.75839084]


portfolio before change:  [9.95255582]
curr_Stock_Price:  103.58278379838089
curr_Factors:  [103.5827838]
mat_Sqrt:  [[0.15]]
grads:  [0.53004703]
Stock Position:  0.5300470316029873
Bond Position:  [-44.95119125]


portfolio before change:  [10.1808386]
curr_Stock_Price:  104.01876835234074
curr_Factors:  [104.01876835]
mat_Sqrt:  [[0.15]]
grads:  [0.95312951]
Stock Position:  0.9531295147711379
Bond Position:  [-88.9625196]


portfolio before change:  [10.41501129]
curr_Stock_Price:  104.27029032643271
curr_Factors:  [104.27029033]
mat_Sqrt:  [[0.15]]
grads:  [0.14510521]
Stock Position:  0.145105213432427
Bond Position:  [-4.71515144]


portfolio before change:  [10.51428455]
curr_Stock_Price:  104.95646803127372
curr_Factors:  [104.95646803]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594265]
Stock Position:  -0.045942652853916875
Bond Position:  [15.33626312]


portfolio before change:  [10.5129098]
curr_Stock_Price:  105.00725510616222
curr_Factors:  [105.00725511]
mat_Sqrt:  [[0.15]]
grads:  [0.25087224]
Stock Position:  0.2508722360517276
Bond Position:  [-15.83049509]


portfolio before change:  [10.67819863]
curr_Stock_Price:  105.67005571432
curr_Factors:  [105.67005571]
mat_Sqrt:  [[0.15]]
grads:  [0.12377339]
Stock Position:  0.12377339232334153
Bond Position:  [-2.40094263]


portfolio before change:  [10.75299266]
curr_Stock_Price:  106.27555008493245
curr_Factors:  [106.27555008]
mat_Sqrt:  [[0.15]]
grads:  [0.14593413]
Stock Position:  0.14593412812157963
Bond Position:  [-4.75623708]


portfolio before change:  [10.67491203]
curr_Stock_Price:  105.74254691033573
curr_Factors:  [105.74254691]
mat_Sqrt:  [[0.15]]
grads:  [0.13824981]
Stock Position:  0.13824980744516197
Bond Position:  [-3.94397471]


portfolio before change:  [10.64691575]
curr_Stock_Price:  105.54182493009566
curr_Factors:  [105.54182493]
mat_Sqrt:  [[0.15]]
grads:  [-0.076037]
Stock Position:  -0.07603700019047438
Bond Position:  [18.67199952]


portfolio before change:  [10.7112652]
curr_Stock_Price:  104.71088195171102
curr_Factors:  [104.71088195]
mat_Sqrt:  [[0.15]]
grads:  [0.10157095]
Stock Position:  0.10157094648509842
Bond Position:  [0.07568181]


portfolio before change:  [10.77904356]
curr_Stock_Price:  105.37813607533266
curr_Factors:  [105.37813608]
mat_Sqrt:  [[0.15]]
grads:  [-0.13183892]
Stock Position:  -0.1318389196765858
Bond Position:  [24.67198318]


portfolio before change:  [10.70936813]
curr_Stock_Price:  105.91832162895278
curr_Factors:  [105.91832163]
mat_Sqrt:  [[0.15]]
grads:  [0.06364196]
Stock Position:  0.0636419566537942
Bond Position:  [3.9685189]


portfolio before change:  [10.6773956]
curr_Stock_Price:  105.41204277850304
curr_Factors:  [105.41204278]
mat_Sqrt:  [[0.15]]
grads:  [-0.58277292]
Stock Position:  -0.5827729189653414
Bond Position:  [72.10867946]


portfolio before change:  [10.95518785]
curr_Stock_Price:  104.94310313470459
curr_Factors:  [104.94310313]
mat_Sqrt:  [[0.15]]
grads:  [0.07661104]
Stock Position:  0.0766110408707402
Bond Position:  [2.91538749]


portfolio before change:  [10.95168739]
curr_Stock_Price:  104.89503331394356
curr_Factors:  [104.89503331]
mat_Sqrt:  [[0.15]]
grads:  [0.04020927]
Stock Position:  0.04020927480321685
Bond Position:  [6.73393417]


portfolio before change:  [10.96822869]
curr_Stock_Price:  105.29594621380053
curr_Factors:  [105.29594621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02521717]
Stock Position:  -0.025217172251071285
Bond Position:  [13.62349471]


portfolio before change:  [10.96630439]
curr_Stock_Price:  105.40602176752284
curr_Factors:  [105.40602177]
mat_Sqrt:  [[0.15]]
grads:  [0.14500065]
Stock Position:  0.14500065087164735
Bond Position:  [-4.31763737]


portfolio before change:  [10.84637158]
curr_Stock_Price:  104.58076372215133
curr_Factors:  [104.58076372]
mat_Sqrt:  [[0.15]]
grads:  [0.39480203]
Stock Position:  0.394802028921124
Bond Position:  [-30.44232612]


portfolio before change:  [10.87040625]
curr_Stock_Price:  104.6464608930161
curr_Factors:  [104.64646089]
mat_Sqrt:  [[0.15]]
grads:  [0.04820146]
Stock Position:  0.048201457729710726
Bond Position:  [5.82629429]


portfolio before change:  [10.85262061]
curr_Stock_Price:  104.26992043121741
curr_Factors:  [104.26992043]
mat_Sqrt:  [[0.15]]
grads:  [0.13086841]
Stock Position:  0.13086841008935368
Bond Position:  [-2.7930181]


portfolio before change:  [10.92957725]
curr_Stock_Price:  104.85930036132983
curr_Factors:  [104.85930036]
mat_Sqrt:  [[0.15]]
grads:  [0.02615674]
Stock Position:  0.026156737767023798
Bond Position:  [8.18680003]


portfolio before change:  [10.92259816]
curr_Stock_Price:  104.57291973676017
curr_Factors:  [104.57291974]
mat_Sqrt:  [[0.15]]
grads:  [-0.01784125]
Stock Position:  -0.017841254086766352
Bond Position:  [12.78831019]


portfolio before change:  [10.9259971]
curr_Stock_Price:  104.42720999732764
curr_Factors:  [104.42721]
mat_Sqrt:  [[0.15]]
grads:  [0.05279683]
Stock Position:  0.05279682829111822
Bond Position:  [5.41257162]


portfolio before change:  [10.92570739]
curr_Stock_Price:  104.41531519175427
curr_Factors:  [104.41531519]
mat_Sqrt:  [[0.15]]
grads:  [0.06701215]
Stock Position:  0.067012145071972
Bond Position:  [3.92861314]


portfolio before change:  [10.94320319]
curr_Stock_Price:  104.67273498799544
curr_Factors:  [104.67273499]
mat_Sqrt:  [[0.15]]
grads:  [0.04032093]
Stock Position:  0.04032092604669419
Bond Position:  [6.72270158]


portfolio before change:  [10.92460909]
curr_Stock_Price:  104.20116159188707
curr_Factors:  [104.20116159]
mat_Sqrt:  [[0.15]]
grads:  [-0.21632011]
Stock Position:  -0.21632011215608132
Bond Position:  [33.46541605]


portfolio before change:  [11.16339807]
curr_Stock_Price:  103.10696225503281
curr_Factors:  [103.10696226]
mat_Sqrt:  [[0.15]]
grads:  [0.06046889]
Stock Position:  0.06046889038691143
Bond Position:  [4.92863447]


portfolio before change:  [11.02601006]
curr_Stock_Price:  100.82982345471167
curr_Factors:  [100.82982345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00883502]
Stock Position:  -0.00883502457330522
Bond Position:  [11.91684403]


portfolio before change:  [11.02782]
curr_Stock_Price:  100.7092678436399
curr_Factors:  [100.70926784]
mat_Sqrt:  [[0.15]]
grads:  [0.12744838]
Stock Position:  0.12744838411978937
Bond Position:  [-1.80741345]


portfolio before change:  [11.04087135]
curr_Stock_Price:  100.8125591740152
curr_Factors:  [100.81255917]
mat_Sqrt:  [[0.15]]
grads:  [-0.03864007]
Stock Position:  -0.038640066077256396
Bond Position:  [14.93627529]


portfolio before change:  [11.04276937]
curr_Stock_Price:  100.78759871987452
curr_Factors:  [100.78759872]
mat_Sqrt:  [[0.15]]
grads:  [-0.10042668]
Stock Position:  -0.10042668494981129
Bond Position:  [21.16453379]


portfolio before change:  [10.97543017]
curr_Stock_Price:  101.4713016356986
curr_Factors:  [101.47130164]
mat_Sqrt:  [[0.15]]
grads:  [0.14740945]
Stock Position:  0.14740944699100142
Bond Position:  [-3.98239829]


portfolio before change:  [10.83757369]
curr_Stock_Price:  100.53779585774798
curr_Factors:  [100.53779586]
mat_Sqrt:  [[0.15]]
grads:  [0.02187679]
Stock Position:  0.021876789892397577
Bond Position:  [8.63812946]


portfolio before change:  [10.82766673]
curr_Stock_Price:  100.06026393515124
curr_Factors:  [100.06026394]
mat_Sqrt:  [[0.15]]
grads:  [-0.0552055]
Stock Position:  -0.05520549530390051
Bond Position:  [16.35154316]


portfolio before change:  [10.85885688]
curr_Stock_Price:  99.51379392663401
curr_Factors:  [99.51379393]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231448]
Stock Position:  -0.03231448329135274
Bond Position:  [14.07459371]


portfolio before change:  [10.86939745]
curr_Stock_Price:  99.21482960294723
curr_Factors:  [99.2148296]
mat_Sqrt:  [[0.15]]
grads:  [0.00031876]
Stock Position:  0.0003187587249985774
Bond Position:  [10.83777185]


portfolio before change:  [10.87008444]
curr_Stock_Price:  99.24497249186604
curr_Factors:  [99.24497249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0823646]
Stock Position:  -0.08236460148757825
Bond Position:  [19.04435705]


portfolio before change:  [10.90532655]
curr_Stock_Price:  98.8315448171763
curr_Factors:  [98.83154482]
mat_Sqrt:  [[0.15]]
grads:  [-0.06672046]
Stock Position:  -0.0667204584833302
Bond Position:  [17.49941254]


portfolio before change:  [10.93466941]
curr_Stock_Price:  98.40814974246375
curr_Factors:  [98.40814974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260748]
Stock Position:  -0.02607480167006114
Bond Position:  [13.5006424]


portfolio before change:  [10.94425372]
curr_Stock_Price:  98.07294162855074
curr_Factors:  [98.07294163]
mat_Sqrt:  [[0.15]]
grads:  [0.30335228]
Stock Position:  0.30335227800534187
Bond Position:  [-18.80639654]


portfolio before change:  [10.77337647]
curr_Stock_Price:  97.51352005048693
curr_Factors:  [97.51352005]
mat_Sqrt:  [[0.15]]
grads:  [-0.05604101]
Stock Position:  -0.056041014474559545
Bond Position:  [16.23813306]


portfolio before change:  [10.79422144]
curr_Stock_Price:  97.15967113501677
curr_Factors:  [97.15967114]
mat_Sqrt:  [[0.15]]
grads:  [0.01615252]
Stock Position:  0.016152515887488308
Bond Position:  [9.2248483]


portfolio before change:  [10.79265118]
curr_Stock_Price:  97.02676164647049
curr_Factors:  [97.02676165]
mat_Sqrt:  [[0.15]]
grads:  [0.03343784]
Stock Position:  0.03343783535776251
Bond Position:  [7.5482863]


portfolio before change:  [10.77877705]
curr_Stock_Price:  96.59772917560528
curr_Factors:  [96.59772918]
mat_Sqrt:  [[0.15]]
grads:  [0.02759042]
Stock Position:  0.027590421887281474
Bond Position:  [8.11360495]


portfolio before change:  [10.77952964]
curr_Stock_Price:  96.60662610303237
curr_Factors:  [96.6066261]
mat_Sqrt:  [[0.15]]
grads:  [0.00668204]
Stock Position:  0.006682040017312249
Bond Position:  [10.13400029]


portfolio before change:  [10.781961]
curr_Stock_Price:  96.87570127358408
curr_Factors:  [96.87570127]
mat_Sqrt:  [[0.15]]
grads:  [-0.00496109]
Stock Position:  -0.004961088496085898
Bond Position:  [11.26256993]


portfolio before change:  [10.78629862]
curr_Stock_Price:  96.14326366407994
curr_Factors:  [96.14326366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00247605]
Stock Position:  -0.0024760456122956366
Bond Position:  [11.02435373]


portfolio before change:  [10.78537561]
curr_Stock_Price:  96.79432458059114
curr_Factors:  [96.79432458]
mat_Sqrt:  [[0.15]]
grads:  [0.01030003]
Stock Position:  0.010300030660341597
Bond Position:  [9.7883911]


portfolio before change:  [10.77643937]
curr_Stock_Price:  95.86733373407466
curr_Factors:  [95.86733373]
mat_Sqrt:  [[0.15]]
grads:  [-0.25324035]
Stock Position:  -0.2532403515939439
Bond Position:  [35.05391667]


portfolio before change:  [10.96631934]
curr_Stock_Price:  95.12618393907054
curr_Factors:  [95.12618394]
mat_Sqrt:  [[0.15]]
grads:  [-0.07699339]
Stock Position:  -0.07699338896267362
Bond Position:  [18.29040662]


portfolio before change:  [10.97835351]
curr_Stock_Price:  94.9847304667168
curr_Factors:  [94.98473047]
mat_Sqrt:  [[0.15]]
grads:  [0.12020751]
Stock Position:  0.12020751222273744
Bond Position:  [-0.43952464]


portfolio before change:  [10.96519354]
curr_Stock_Price:  94.8754819331517
curr_Factors:  [94.87548193]
mat_Sqrt:  [[0.15]]
grads:  [0.10769387]
Stock Position:  0.10769387398051204
Bond Position:  [0.74768535]


portfolio before change:  [11.04127713]
curr_Stock_Price:  95.58152811821546
curr_Factors:  [95.58152812]
mat_Sqrt:  [[0.15]]
grads:  [-0.1270061]
Stock Position:  -0.1270060977452449
Bond Position:  [23.18071403]


portfolio before change:  [11.07635791]
curr_Stock_Price:  95.31672237052547
curr_Factors:  [95.31672237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02404727]
Stock Position:  -0.024047268309328303
Bond Position:  [13.36846471]


portfolio before change:  [11.07826852]
curr_Stock_Price:  95.27201633021093
curr_Factors:  [95.27201633]
mat_Sqrt:  [[0.15]]
grads:  [-0.12300415]
Stock Position:  -0.12300415087653047
Bond Position:  [22.79712199]


portfolio before change:  [11.12506197]
curr_Stock_Price:  94.90317851318805
curr_Factors:  [94.90317851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02810413]
Stock Position:  -0.028104130123844974
Bond Position:  [13.79223325]


portfolio before change:  [11.12742263]
curr_Stock_Price:  94.84985475899256
curr_Factors:  [94.84985476]
mat_Sqrt:  [[0.15]]
grads:  [0.0120845]
Stock Position:  0.012084497359925948
Bond Position:  [9.98120981]


portfolio before change:  [11.12429667]
curr_Stock_Price:  94.53955587381324
curr_Factors:  [94.53955587]
mat_Sqrt:  [[0.15]]
grads:  [-0.11435781]
Stock Position:  -0.11435781047063956
Bond Position:  [21.93563328]


portfolio before change:  [11.08697575]
curr_Stock_Price:  94.87789688998389
curr_Factors:  [94.87789689]
mat_Sqrt:  [[0.15]]
grads:  [0.08539766]
Stock Position:  0.08539766274283515
Bond Position:  [2.98462511]


portfolio before change:  [11.1138511]
curr_Stock_Price:  95.1904207546017
curr_Factors:  [95.19042075]
mat_Sqrt:  [[0.15]]
grads:  [0.0276951]
Stock Position:  0.027695096883637027
Bond Position:  [8.47754318]


portfolio before change:  [11.10612922]
curr_Stock_Price:  94.89247097670874
curr_Factors:  [94.89247098]
mat_Sqrt:  [[0.15]]
grads:  [0.08181316]
Stock Position:  0.08181315929225771
Bond Position:  [3.34267637]


portfolio before change:  [11.04325633]
curr_Stock_Price:  94.1214237419803
curr_Factors:  [94.12142374]
mat_Sqrt:  [[0.15]]
grads:  [0.02263709]
Stock Position:  0.022637086390471444
Bond Position:  [8.91262153]


portfolio before change:  [11.05329792]
curr_Stock_Price:  94.54040570704692
curr_Factors:  [94.54040571]
mat_Sqrt:  [[0.15]]
grads:  [0.00205091]
Stock Position:  0.002050908171478522
Bond Position:  [10.85940423]


portfolio before change:  [11.05266955]
curr_Stock_Price:  93.90307796544492
curr_Factors:  [93.90307797]
mat_Sqrt:  [[0.15]]
grads:  [0.09521613]
Stock Position:  0.0952161323648097
Bond Position:  [2.11158165]


portfolio before change:  [11.12923392]
curr_Stock_Price:  94.70580318851752
curr_Factors:  [94.70580319]
mat_Sqrt:  [[0.15]]
grads:  [-0.12173197]
Stock Position:  -0.12173196955517773
Bond Position:  [22.65795787]


portfolio before change:  [11.16344076]
curr_Stock_Price:  94.43643536673397
curr_Factors:  [94.43643537]
mat_Sqrt:  [[0.15]]
grads:  [0.03308939]
Stock Position:  0.03308938563355522
Bond Position:  [8.03859714]


portfolio before change:  [11.16433111]
curr_Stock_Price:  94.44815874991933
curr_Factors:  [94.44815875]
mat_Sqrt:  [[0.15]]
grads:  [0.04961654]
Stock Position:  0.04961653554245362
Bond Position:  [6.47814069]


portfolio before change:  [11.17339144]
curr_Stock_Price:  94.62260522918804
curr_Factors:  [94.62260523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.17339144]
Stock Price:  95.37287803175339
PL:  [11.17339144]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.44154550e-03]
 [-7.70456325e-03]
 [-5.65421012e-04]
 [ 7.02143575e-03]
 [ 4.32916396e-03]
 [ 2.10289594e-02]
 [ 1.94471191e-03]
 [-2.54163152e-02]
 [-1.92402106e-02]
 [ 2.92862339e-02]
 [-4.78726195e-02]
 [ 3.19352301e-02]
 [-1.09788084e-02]
 [ 1.58565875e-03]
 [-7.03744659e-03]
 [ 1.06538967e-02]
 [ 1.35695361e-02]
 [ 2.93654006e-02]
 [ 1.01041174e-03]
 [ 1.52913704e-02]
 [ 1.32175174e-02]
 [-1.16820136e-02]
 [-1.77816796e-03]
 [-7.56404294e-02]
 [-1.27703760e-02]
 [-2.67658086e-03]
 [ 4.83644422e-04]
 [ 1.09042961e-02]
 [-4.63370717e-02]
 [ 2.57457237e-03]
 [ 3.18858704e-03]
 [-1.00504699e-02]
 [-8.26199507e-03]
 [ 5.44340906e-03]
 [ 1.37334486e-02]
 [ 1.59420209e-02]
 [-3.49216619e-02]
 [ 9.49299616e-03]
 [-1.34109330e-02]
 [ 2.44522741e-02]
 [-5.63463583e-03]
 [-2.91352772e-03]
 [ 2.30205061e-02]
 [ 4.30679881e-03]
 [-7.77954080e-03]
 [-9.29565570e-04]
 [ 5.90899353e-03]
 [-1.21404004e-02]
 [-1.49810251e-02]
 [-6.89357796e-03]
 [ 4.76223125e-02]
 [-9.01547248e-03]
 [ 2.60143077e-03]
 [ 5.37182962e-03]
 [ 5.53326402e-03]
 [-3.02418698e-03]
 [ 6.58712239e-03]
 [-2.13497842e-04]
 [ 1.55559931e-03]
 [ 2.58542052e-03]
 [ 9.00849938e-04]
 [-1.21066545e-02]
 [-7.08976136e-03]
 [-1.30149387e-02]
 [-2.73330735e-03]
 [ 2.64964592e-04]
 [-5.43959290e-03]
 [ 1.50529521e-02]
 [-8.26470191e-03]
 [ 3.47147062e-03]
 [-1.25058453e-02]
 [ 1.25260318e-02]
 [-6.73340359e-04]
 [ 2.37043546e-02]
 [-2.29867144e-02]
 [ 5.71035869e-04]
 [-2.71908524e-03]
 [-1.04705741e-02]
 [ 2.86447371e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.77229863]
curr_Stock_Price:  99.91746524258957
curr_Factors:  [99.91746524]
mat_Sqrt:  [[0.15]]
grads:  [0.01627697]
Stock Position:  0.016276970023810733
Bond Position:  [-0.85405495]


portfolio before change:  [0.7622536]
curr_Stock_Price:  99.30361293601811
curr_Factors:  [99.30361294]
mat_Sqrt:  [[0.15]]
grads:  [-0.05136375]
Stock Position:  -0.05136375498550824
Bond Position:  [5.86286004]


portfolio before change:  [0.74815214]
curr_Stock_Price:  99.58528822911946
curr_Factors:  [99.58528823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00376947]
Stock Position:  -0.0037694734135919165
Bond Position:  [1.12353623]


portfolio before change:  [0.745369]
curr_Stock_Price:  100.34225330514263
curr_Factors:  [100.34225331]
mat_Sqrt:  [[0.15]]
grads:  [0.04680957]
Stock Position:  0.04680957166807121
Bond Position:  [-3.9516089]


portfolio before change:  [0.72568658]
curr_Stock_Price:  99.92705117761278
curr_Factors:  [99.92705118]
mat_Sqrt:  [[0.15]]
grads:  [0.02886109]
Stock Position:  0.028861093064987804
Bond Position:  [-2.15831734]


portfolio before change:  [0.71303566]
curr_Stock_Price:  99.49338690430928
curr_Factors:  [99.4933869]
mat_Sqrt:  [[0.15]]
grads:  [0.14019306]
Stock Position:  0.14019306288399347
Bond Position:  [-13.23524699]


portfolio before change:  [0.60381128]
curr_Stock_Price:  98.72018780998994
curr_Factors:  [98.72018781]
mat_Sqrt:  [[0.15]]
grads:  [0.01296475]
Stock Position:  0.012964746061457099
Bond Position:  [-0.67607088]


portfolio before change:  [0.59299098]
curr_Stock_Price:  97.88885245005959
curr_Factors:  [97.88885245]
mat_Sqrt:  [[0.15]]
grads:  [-0.1694421]
Stock Position:  -0.16944210126265064
Bond Position:  [17.17948382]


portfolio before change:  [0.62017887]
curr_Stock_Price:  97.73473404549378
curr_Factors:  [97.73473405]
mat_Sqrt:  [[0.15]]
grads:  [-0.12826807]
Stock Position:  -0.12826807070364535
Bond Position:  [13.15642465]


portfolio before change:  [0.60637917]
curr_Stock_Price:  97.84872969040498
curr_Factors:  [97.84872969]
mat_Sqrt:  [[0.15]]
grads:  [0.19524156]
Stock Position:  0.19524155921256148
Bond Position:  [-18.49775938]


portfolio before change:  [0.56121915]
curr_Stock_Price:  97.62334795557162
curr_Factors:  [97.62334796]
mat_Sqrt:  [[0.15]]
grads:  [-0.3191508]
Stock Position:  -0.319150796398938
Bond Position:  [31.71778839]


portfolio before change:  [0.76563981]
curr_Stock_Price:  96.98904516227186
curr_Factors:  [96.98904516]
mat_Sqrt:  [[0.15]]
grads:  [0.21290153]
Stock Position:  0.2129015337601765
Bond Position:  [-19.88347666]


portfolio before change:  [0.83380931]
curr_Stock_Price:  97.31507501030114
curr_Factors:  [97.31507501]
mat_Sqrt:  [[0.15]]
grads:  [-0.07319206]
Stock Position:  -0.07319205605670764
Bond Position:  [7.95649974]


portfolio before change:  [0.83943904]
curr_Stock_Price:  97.24495216712974
curr_Factors:  [97.24495217]
mat_Sqrt:  [[0.15]]
grads:  [0.01057106]
Stock Position:  0.010571058346661465
Bond Position:  [-0.18854302]


portfolio before change:  [0.84002873]
curr_Stock_Price:  97.30185006674894
curr_Factors:  [97.30185007]
mat_Sqrt:  [[0.15]]
grads:  [-0.04691631]
Stock Position:  -0.04691631062956962
Bond Position:  [5.40507255]


portfolio before change:  [0.8417995]
curr_Stock_Price:  97.27130759990503
curr_Factors:  [97.2713076]
mat_Sqrt:  [[0.15]]
grads:  [0.07102598]
Stock Position:  0.07102597772312243
Bond Position:  [-6.06699023]


portfolio before change:  [0.80973003]
curr_Stock_Price:  96.82512899245553
curr_Factors:  [96.82512899]
mat_Sqrt:  [[0.15]]
grads:  [0.09046357]
Stock Position:  0.09046357386274195
Bond Position:  [-7.94941718]


portfolio before change:  [0.71963888]
curr_Stock_Price:  95.83473820316733
curr_Factors:  [95.8347382]
mat_Sqrt:  [[0.15]]
grads:  [0.19576934]
Stock Position:  0.1957693370633298
Bond Position:  [-18.04186428]


portfolio before change:  [0.66829722]
curr_Stock_Price:  95.57824243319664
curr_Factors:  [95.57824243]
mat_Sqrt:  [[0.15]]
grads:  [0.00673608]
Stock Position:  0.006736078237220429
Bond Position:  [0.0244747]


portfolio before change:  [0.66789052]
curr_Stock_Price:  95.51763901613293
curr_Factors:  [95.51763902]
mat_Sqrt:  [[0.15]]
grads:  [0.10194247]
Stock Position:  0.10194246951395812
Bond Position:  [-9.06941348]


portfolio before change:  [0.68771886]
curr_Stock_Price:  95.71770469099724
curr_Factors:  [95.71770469]
mat_Sqrt:  [[0.15]]
grads:  [0.08811678]
Stock Position:  0.0881167827378529
Bond Position:  [-7.74661733]


portfolio before change:  [0.67307361]
curr_Stock_Price:  95.55699670566233
curr_Factors:  [95.55699671]
mat_Sqrt:  [[0.15]]
grads:  [-0.07788009]
Stock Position:  -0.07788009093044757
Bond Position:  [8.1150612]


portfolio before change:  [0.69025332]
curr_Stock_Price:  95.34291748370806
curr_Factors:  [95.34291748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01185445]
Stock Position:  -0.011854453069028749
Bond Position:  [1.82049146]


portfolio before change:  [0.68250708]
curr_Stock_Price:  96.0059613444997
curr_Factors:  [96.00596134]
mat_Sqrt:  [[0.15]]
grads:  [-0.50426953]
Stock Position:  -0.5042695294006456
Bond Position:  [49.09538803]


portfolio before change:  [0.74440192]
curr_Stock_Price:  95.88930491973504
curr_Factors:  [95.88930492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08513584]
Stock Position:  -0.08513583993744733
Bond Position:  [8.90801844]


portfolio before change:  [0.70836897]
curr_Stock_Price:  96.31908540179504
curr_Factors:  [96.3190854]
mat_Sqrt:  [[0.15]]
grads:  [-0.01784387]
Stock Position:  -0.017843872403060908
Bond Position:  [2.42707444]


portfolio before change:  [0.70886625]
curr_Stock_Price:  96.29971837842126
curr_Factors:  [96.29971838]
mat_Sqrt:  [[0.15]]
grads:  [0.0032243]
Stock Position:  0.0032242961465902414
Bond Position:  [0.39836744]


portfolio before change:  [0.70905182]
curr_Stock_Price:  96.3495507353339
curr_Factors:  [96.34955074]
mat_Sqrt:  [[0.15]]
grads:  [0.07269531]
Stock Position:  0.07269530746040581
Bond Position:  [-6.29510839]


portfolio before change:  [0.70362816]
curr_Stock_Price:  96.28035496082093
curr_Factors:  [96.28035496]
mat_Sqrt:  [[0.15]]
grads:  [-0.30891381]
Stock Position:  -0.30891381133874046
Bond Position:  [30.44595957]


portfolio before change:  [0.433365]
curr_Stock_Price:  97.16139711850849
curr_Factors:  [97.16139712]
mat_Sqrt:  [[0.15]]
grads:  [0.01716382]
Stock Position:  0.017163815768713512
Bond Position:  [-1.23429532]


portfolio before change:  [0.43511752]
curr_Stock_Price:  97.26799711688
curr_Factors:  [97.26799712]
mat_Sqrt:  [[0.15]]
grads:  [0.02125725]
Stock Position:  0.021257246910722692
Bond Position:  [-1.63253232]


portfolio before change:  [0.43073631]
curr_Stock_Price:  97.06669300743069
curr_Factors:  [97.06669301]
mat_Sqrt:  [[0.15]]
grads:  [-0.06700313]
Stock Position:  -0.06700313249488006
Bond Position:  [6.9345088]


portfolio before change:  [0.43193646]
curr_Stock_Price:  97.05524981540412
curr_Factors:  [97.05524982]
mat_Sqrt:  [[0.15]]
grads:  [-0.05507997]
Stock Position:  -0.055079967102353855
Bond Position:  [5.77773642]


portfolio before change:  [0.41132317]
curr_Stock_Price:  97.43604897976321
curr_Factors:  [97.43604898]
mat_Sqrt:  [[0.15]]
grads:  [0.03628939]
Stock Position:  0.03628939376348856
Bond Position:  [-3.12457198]


portfolio before change:  [0.41045433]
curr_Stock_Price:  97.41748848435218
curr_Factors:  [97.41748848]
mat_Sqrt:  [[0.15]]
grads:  [0.09155632]
Stock Position:  0.0915563240860428
Bond Position:  [-8.50873282]


portfolio before change:  [0.44008168]
curr_Stock_Price:  97.74689408103146
curr_Factors:  [97.74689408]
mat_Sqrt:  [[0.15]]
grads:  [0.10628014]
Stock Position:  0.10628013946467986
Bond Position:  [-9.94847185]


portfolio before change:  [0.55242572]
curr_Stock_Price:  98.80980042296359
curr_Factors:  [98.80980042]
mat_Sqrt:  [[0.15]]
grads:  [-0.23281108]
Stock Position:  -0.23281107961050843
Bond Position:  [23.55644203]


portfolio before change:  [0.39645631]
curr_Stock_Price:  99.48606436156233
curr_Factors:  [99.48606436]
mat_Sqrt:  [[0.15]]
grads:  [0.06328664]
Stock Position:  0.0632866410806651
Bond Position:  [-5.89968254]


portfolio before change:  [0.39403045]
curr_Stock_Price:  99.4535595897014
curr_Factors:  [99.45355959]
mat_Sqrt:  [[0.15]]
grads:  [-0.08940622]
Stock Position:  -0.08940622003703122
Bond Position:  [9.28579728]


portfolio before change:  [0.42228045]
curr_Stock_Price:  99.14407746573468
curr_Factors:  [99.14407747]
mat_Sqrt:  [[0.15]]
grads:  [0.16301516]
Stock Position:  0.1630151605987125
Bond Position:  [-15.73970726]


portfolio before change:  [0.46888115]
curr_Stock_Price:  99.43597951142468
curr_Factors:  [99.43597951]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756424]
Stock Position:  -0.037564238863741786
Bond Position:  [4.20411804]


portfolio before change:  [0.47190043]
curr_Stock_Price:  99.36259820949354
curr_Factors:  [99.36259821]
mat_Sqrt:  [[0.15]]
grads:  [-0.01942352]
Stock Position:  -0.019423518132830102
Bond Position:  [2.40187166]


portfolio before change:  [0.48093155]
curr_Stock_Price:  98.90536880549757
curr_Factors:  [98.90536881]
mat_Sqrt:  [[0.15]]
grads:  [0.15347004]
Stock Position:  0.15347004075157694
Bond Position:  [-14.69807943]


portfolio before change:  [0.49701374]
curr_Stock_Price:  99.01614514268482
curr_Factors:  [99.01614514]
mat_Sqrt:  [[0.15]]
grads:  [0.02871199]
Stock Position:  0.028711992048688156
Bond Position:  [-2.34593703]


portfolio before change:  [0.49921812]
curr_Stock_Price:  99.09802721842348
curr_Factors:  [99.09802722]
mat_Sqrt:  [[0.15]]
grads:  [-0.05186361]
Stock Position:  -0.05186360533569439
Bond Position:  [5.63879909]


portfolio before change:  [0.43907785]
curr_Stock_Price:  100.26440778284717
curr_Factors:  [100.26440778]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061971]
Stock Position:  -0.006197103799776815
Bond Position:  [1.06042679]


portfolio before change:  [0.44016272]
curr_Stock_Price:  100.10004158058277
curr_Factors:  [100.10004158]
mat_Sqrt:  [[0.15]]
grads:  [0.03939329]
Stock Position:  0.039393290202136604
Bond Position:  [-3.50310726]


portfolio before change:  [0.43174511]
curr_Stock_Price:  99.8919182560128
curr_Factors:  [99.89191826]
mat_Sqrt:  [[0.15]]
grads:  [-0.080936]
Stock Position:  -0.08093600238670275
Bond Position:  [8.51659764]


portfolio before change:  [0.4290002]
curr_Stock_Price:  99.9324096832003
curr_Factors:  [99.93240968]
mat_Sqrt:  [[0.15]]
grads:  [-0.0998735]
Stock Position:  -0.09987350066104285
Bond Position:  [10.40959978]


portfolio before change:  [0.4160745]
curr_Stock_Price:  100.06834483784203
curr_Factors:  [100.06834484]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595719]
Stock Position:  -0.04595718641835424
Bond Position:  [5.01493408]


portfolio before change:  [0.43955385]
curr_Stock_Price:  99.56426906095196
curr_Factors:  [99.56426906]
mat_Sqrt:  [[0.15]]
grads:  [0.31748208]
Stock Position:  0.317482083664591
Bond Position:  [-31.17031775]


portfolio before change:  [0.52876402]
curr_Stock_Price:  99.85139827533905
curr_Factors:  [99.85139828]
mat_Sqrt:  [[0.15]]
grads:  [-0.06010315]
Stock Position:  -0.06010314983599753
Bond Position:  [6.53014757]


portfolio before change:  [0.52470953]
curr_Stock_Price:  99.92564799899628
curr_Factors:  [99.925648]
mat_Sqrt:  [[0.15]]
grads:  [0.01734287]
Stock Position:  0.017342871794854994
Bond Position:  [-1.20828817]


portfolio before change:  [0.53054672]
curr_Stock_Price:  100.2665782409643
curr_Factors:  [100.26657824]
mat_Sqrt:  [[0.15]]
grads:  [0.0358122]
Stock Position:  0.035812197456995196
Bond Position:  [-3.06021978]


portfolio before change:  [0.52450465]
curr_Stock_Price:  100.10320387943528
curr_Factors:  [100.10320388]
mat_Sqrt:  [[0.15]]
grads:  [0.03688843]
Stock Position:  0.03688842679311969
Bond Position:  [-3.16814506]


portfolio before change:  [0.51363534]
curr_Stock_Price:  99.81391810582478
curr_Factors:  [99.81391811]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016125]
Stock Position:  -0.020161246545668324
Bond Position:  [2.52600835]


portfolio before change:  [0.51657396]
curr_Stock_Price:  99.67599317589273
curr_Factors:  [99.67599318]
mat_Sqrt:  [[0.15]]
grads:  [0.04391415]
Stock Position:  0.04391414924800342
Bond Position:  [-3.86061248]


portfolio before change:  [0.53865066]
curr_Stock_Price:  100.18421188765787
curr_Factors:  [100.18421189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142332]
Stock Position:  -0.0014233189487915503
Bond Position:  [0.68124474]


portfolio before change:  [0.53879623]
curr_Stock_Price:  100.111849166897
curr_Factors:  [100.11184917]
mat_Sqrt:  [[0.15]]
grads:  [0.01037066]
Stock Position:  0.010370662077797735
Bond Position:  [-0.49942993]


portfolio before change:  [0.54426399]
curr_Stock_Price:  100.64209215764443
curr_Factors:  [100.64209216]
mat_Sqrt:  [[0.15]]
grads:  [0.01723614]
Stock Position:  0.017236136829771414
Bond Position:  [-1.19041689]


portfolio before change:  [0.54005745]
curr_Stock_Price:  100.40235539015295
curr_Factors:  [100.40235539]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-0.06292559]


portfolio before change:  [0.54264885]
curr_Stock_Price:  100.83450358827446
curr_Factors:  [100.83450359]
mat_Sqrt:  [[0.15]]
grads:  [-0.08071103]
Stock Position:  -0.08071103026642396
Bond Position:  [8.68110552]


portfolio before change:  [0.52865065]
curr_Stock_Price:  101.01466216286902
curr_Factors:  [101.01466216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04726508]
Stock Position:  -0.0472650757319697
Bond Position:  [5.30311631]


portfolio before change:  [0.51997377]
curr_Stock_Price:  101.20525394660345
curr_Factors:  [101.20525395]
mat_Sqrt:  [[0.15]]
grads:  [-0.08676626]
Stock Position:  -0.08676625796884752
Bond Position:  [9.30117494]


portfolio before change:  [0.47523105]
curr_Stock_Price:  101.72762364468676
curr_Factors:  [101.72762364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822205]
Stock Position:  -0.01822204897021352
Bond Position:  [2.32891679]


portfolio before change:  [0.47124113]
curr_Stock_Price:  101.95457281809395
curr_Factors:  [101.95457282]
mat_Sqrt:  [[0.15]]
grads:  [0.00176643]
Stock Position:  0.0017664306139389407
Bond Position:  [0.29114545]


portfolio before change:  [0.47189403]
curr_Stock_Price:  102.31388576348576
curr_Factors:  [102.31388576]
mat_Sqrt:  [[0.15]]
grads:  [-0.03626395]
Stock Position:  -0.03626395266838208
Bond Position:  [4.18219994]


portfolio before change:  [0.46712494]
curr_Stock_Price:  102.45260432243828
curr_Factors:  [102.45260432]
mat_Sqrt:  [[0.15]]
grads:  [0.10035301]
Stock Position:  0.10035301374273314
Bond Position:  [-9.81430266]


portfolio before change:  [0.50611876]
curr_Stock_Price:  102.84728338207476
curr_Factors:  [102.84728338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05509801]
Stock Position:  -0.055098012758774954
Bond Position:  [6.1727997]


portfolio before change:  [0.46444996]
curr_Stock_Price:  103.61055255581357
curr_Factors:  [103.61055256]
mat_Sqrt:  [[0.15]]
grads:  [0.02314314]
Stock Position:  0.023143137462944934
Bond Position:  [-1.9334233]


portfolio before change:  [0.44997461]
curr_Stock_Price:  102.99030332711423
curr_Factors:  [102.99030333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0833723]
Stock Position:  -0.08337230202222058
Bond Position:  [9.03651328]


portfolio before change:  [0.4700208]
curr_Stock_Price:  102.7566358424405
curr_Factors:  [102.75663584]
mat_Sqrt:  [[0.15]]
grads:  [0.08350688]
Stock Position:  0.0835068788544084
Bond Position:  [-8.11086514]


portfolio before change:  [0.55330638]
curr_Stock_Price:  103.76005646110201
curr_Factors:  [103.76005646]
mat_Sqrt:  [[0.15]]
grads:  [-0.00448894]
Stock Position:  -0.004488935729338309
Bond Position:  [1.01907861]


portfolio before change:  [0.55358311]
curr_Stock_Price:  103.71259875878091
curr_Factors:  [103.71259876]
mat_Sqrt:  [[0.15]]
grads:  [0.15802903]
Stock Position:  0.15802903072155636
Bond Position:  [-15.83601835]


portfolio before change:  [0.49633741]
curr_Stock_Price:  103.35661404375676
curr_Factors:  [103.35661404]
mat_Sqrt:  [[0.15]]
grads:  [-0.15324476]
Stock Position:  -0.15324476258628184
Bond Position:  [16.33519719]


portfolio before change:  [0.38089499]
curr_Stock_Price:  104.11659694770769
curr_Factors:  [104.11659695]
mat_Sqrt:  [[0.15]]
grads:  [0.00380691]
Stock Position:  0.003806905795396935
Bond Position:  [-0.01546709]


portfolio before change:  [0.38175481]
curr_Stock_Price:  104.34270870178699
curr_Factors:  [104.3427087]
mat_Sqrt:  [[0.15]]
grads:  [-0.01812723]
Stock Position:  -0.0181272349156982
Bond Position:  [2.2731996]


portfolio before change:  [0.37521411]
curr_Stock_Price:  104.71136825195293
curr_Factors:  [104.71136825]
mat_Sqrt:  [[0.15]]
grads:  [-0.06980383]
Stock Position:  -0.06980382723177733
Bond Position:  [7.68446837]


portfolio before change:  [0.39711878]
curr_Stock_Price:  104.40444562843696
curr_Factors:  [104.40444563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.39711878]
Stock Price:  104.24741765091747
PL:  [-3.85029887]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.11898337e-03]
 [-1.38191561e-02]
 [-3.79611039e-03]
 [ 2.35323783e-03]
 [-7.62599070e-03]
 [ 8.65598943e-03]
 [ 3.96824103e-03]
 [-2.65759332e-02]
 [-1.46818858e-02]
 [ 2.48253542e-02]
 [ 9.67787521e-03]
 [ 2.33838398e-02]
 [-1.35324752e-02]
 [ 1.24506577e-02]
 [-6.91201262e-03]
 [ 2.32906319e-02]
 [ 1.10222414e-02]
 [-1.11865579e-02]
 [-1.05100113e-04]
 [ 1.10223739e-03]
 [ 1.20550453e-02]
 [-8.05869273e-03]
 [ 8.17754358e-03]
 [ 1.02320641e-02]
 [-8.11661887e-03]
 [ 1.15844660e-02]
 [-6.55619448e-03]
 [ 5.83002812e-03]
 [-4.11187289e-03]
 [-2.90725445e-03]
 [ 7.69582236e-03]
 [-1.17483537e-02]
 [ 9.34013665e-03]
 [ 7.56814804e-03]
 [ 1.14584669e-02]
 [ 1.01093541e-02]
 [-3.41858542e-02]
 [ 9.74928669e-03]
 [-5.17666000e-04]
 [ 2.22172603e-02]
 [-5.79650076e-03]
 [-1.55800838e-02]
 [ 2.29672843e-02]
 [ 2.38418728e-03]
 [-7.57529075e-03]
 [ 2.05843906e-03]
 [ 9.86322484e-03]
 [-7.50038502e-03]
 [-8.99208101e-03]
 [-7.62679159e-03]
 [-1.71853587e-02]
 [-6.64972595e-04]
 [-8.38106540e-03]
 [ 5.59842753e-03]
 [ 2.50032984e-04]
 [-1.07719592e-03]
 [ 5.40755546e-03]
 [-7.09993715e-04]
 [ 1.58721074e-03]
 [-2.27772575e-03]
 [ 9.00849938e-04]
 [-4.75571996e-03]
 [ 5.09577095e-03]
 [-1.77501311e-02]
 [-1.31766947e-02]
 [-1.17160203e-03]
 [-4.88133121e-03]
 [ 2.24812435e-02]
 [-8.87120657e-03]
 [ 6.12007769e-03]
 [-8.82172809e-03]
 [ 1.06785344e-02]
 [-7.12729061e-03]
 [ 1.08156051e-02]
 [-2.11692299e-02]
 [-5.08518057e-03]
 [-6.60360592e-03]
 [-1.61841176e-03]
 [ 7.39660406e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.60736206]
curr_Stock_Price:  99.37257815037111
curr_Factors:  [99.37257815]
mat_Sqrt:  [[0.15]]
grads:  [0.03412656]
Stock Position:  0.03412655582338417
Bond Position:  [-10.9986059]


portfolio before change:  [-7.61779213]
curr_Stock_Price:  99.08709260059672
curr_Factors:  [99.0870926]
mat_Sqrt:  [[0.15]]
grads:  [-0.09212771]
Stock Position:  -0.09212770713457878
Bond Position:  [1.51087451]


portfolio before change:  [-7.599364]
curr_Stock_Price:  98.88808953781636
curr_Factors:  [98.88808954]
mat_Sqrt:  [[0.15]]
grads:  [-0.0253074]
Stock Position:  -0.025307402595969287
Bond Position:  [-5.09676331]


portfolio before change:  [-7.56031744]
curr_Stock_Price:  97.33261077882736
curr_Factors:  [97.33261078]
mat_Sqrt:  [[0.15]]
grads:  [0.01568825]
Stock Position:  0.015688252206908407
Bond Position:  [-9.08729598]


portfolio before change:  [-7.55194746]
curr_Stock_Price:  97.90233350221797
curr_Factors:  [97.9023335]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083994]
Stock Position:  -0.050839938007766546
Bond Position:  [-2.57459889]


portfolio before change:  [-7.53716859]
curr_Stock_Price:  97.60847422538295
curr_Factors:  [97.60847423]
mat_Sqrt:  [[0.15]]
grads:  [0.0577066]
Stock Position:  0.05770659618260714
Bond Position:  [-13.16982139]


portfolio before change:  [-7.52812435]
curr_Stock_Price:  97.77946629099175
curr_Factors:  [97.77946629]
mat_Sqrt:  [[0.15]]
grads:  [0.02645494]
Stock Position:  0.026454940210389327
Bond Position:  [-10.11487429]


portfolio before change:  [-7.53364473]
curr_Stock_Price:  97.5946924874804
curr_Factors:  [97.59469249]
mat_Sqrt:  [[0.15]]
grads:  [-0.17717289]
Stock Position:  -0.17717288778461995
Bond Position:  [9.75748877]


portfolio before change:  [-7.59173121]
curr_Stock_Price:  97.92598661254732
curr_Factors:  [97.92598661]
mat_Sqrt:  [[0.15]]
grads:  [-0.09787924]
Stock Position:  -0.09787923858761864
Bond Position:  [1.9931898]


portfolio before change:  [-7.63615379]
curr_Stock_Price:  98.38111024968022
curr_Factors:  [98.38111025]
mat_Sqrt:  [[0.15]]
grads:  [0.16550236]
Stock Position:  0.1655023615212671
Bond Position:  [-23.91845986]


portfolio before change:  [-7.56519322]
curr_Stock_Price:  98.81890168511258
curr_Factors:  [98.81890169]
mat_Sqrt:  [[0.15]]
grads:  [0.06451917]
Stock Position:  0.0645191680468601
Bond Position:  [-13.94090654]


portfolio before change:  [-7.58932674]
curr_Stock_Price:  98.4583547188524
curr_Factors:  [98.45835472]
mat_Sqrt:  [[0.15]]
grads:  [0.15589227]
Stock Position:  0.15589226544544926
Bond Position:  [-22.93822271]


portfolio before change:  [-7.50290215]
curr_Stock_Price:  99.0219380397967
curr_Factors:  [99.02193804]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902165]
Stock Position:  -0.09021650101168611
Bond Position:  [1.43051063]


portfolio before change:  [-7.53728118]
curr_Stock_Price:  99.40400165513597
curr_Factors:  [99.40400166]
mat_Sqrt:  [[0.15]]
grads:  [0.08300438]
Stock Position:  0.0830043846448405
Bond Position:  [-15.78824917]


portfolio before change:  [-7.50773028]
curr_Stock_Price:  99.77190632279081
curr_Factors:  [99.77190632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608008]
Stock Position:  -0.046080084101747514
Bond Position:  [-2.91023244]


portfolio before change:  [-7.59442588]
curr_Stock_Price:  101.64937064280491
curr_Factors:  [101.64937064]
mat_Sqrt:  [[0.15]]
grads:  [0.15527088]
Stock Position:  0.15527087952263824
Bond Position:  [-23.37761307]


portfolio before change:  [-7.51329261]
curr_Stock_Price:  102.18130822898006
curr_Factors:  [102.18130823]
mat_Sqrt:  [[0.15]]
grads:  [0.07348161]
Stock Position:  0.07348160956031052
Bond Position:  [-15.02173961]


portfolio before change:  [-7.57375835]
curr_Stock_Price:  101.3712163970198
curr_Factors:  [101.3712164]
mat_Sqrt:  [[0.15]]
grads:  [-0.07457705]
Stock Position:  -0.07457705280832344
Bond Position:  [-0.0137918]


portfolio before change:  [-7.56657154]
curr_Stock_Price:  101.27483718216958
curr_Factors:  [101.27483718]
mat_Sqrt:  [[0.15]]
grads:  [-0.00070067]
Stock Position:  -0.0007006674172714729
Bond Position:  [-7.49561156]


portfolio before change:  [-7.56679175]
curr_Stock_Price:  100.92048639937352
curr_Factors:  [100.9204864]
mat_Sqrt:  [[0.15]]
grads:  [0.00734825]
Stock Position:  0.007348249242505409
Bond Position:  [-8.30838063]


portfolio before change:  [-7.56893779]
curr_Stock_Price:  100.69910605495446
curr_Factors:  [100.69910605]
mat_Sqrt:  [[0.15]]
grads:  [0.08036697]
Stock Position:  0.08036696844139742
Bond Position:  [-15.66181967]


portfolio before change:  [-7.6205844]
curr_Stock_Price:  100.0686516568617
curr_Factors:  [100.06865166]
mat_Sqrt:  [[0.15]]
grads:  [-0.05372462]
Stock Position:  -0.05372461821978643
Bond Position:  [-2.24443429]


portfolio before change:  [-7.56307003]
curr_Stock_Price:  98.99550025275474
curr_Factors:  [98.99550025]
mat_Sqrt:  [[0.15]]
grads:  [0.05451696]
Stock Position:  0.05451695723299714
Bond Position:  [-12.96000348]


portfolio before change:  [-7.58359539]
curr_Stock_Price:  98.63386342463535
curr_Factors:  [98.63386342]
mat_Sqrt:  [[0.15]]
grads:  [0.06821376]
Stock Position:  0.06821376065591855
Bond Position:  [-14.31178215]


portfolio before change:  [-7.59293123]
curr_Stock_Price:  98.51011535870903
curr_Factors:  [98.51011536]
mat_Sqrt:  [[0.15]]
grads:  [-0.05411079]
Stock Position:  -0.054110792487743614
Bond Position:  [-2.26247082]


portfolio before change:  [-7.67380636]
curr_Stock_Price:  100.00212312842217
curr_Factors:  [100.00212313]
mat_Sqrt:  [[0.15]]
grads:  [0.07722977]
Stock Position:  0.07722977364169706
Bond Position:  [-15.39694769]


portfolio before change:  [-7.63020131]
curr_Stock_Price:  100.57919841342773
curr_Factors:  [100.57919841]
mat_Sqrt:  [[0.15]]
grads:  [-0.04370796]
Stock Position:  -0.04370796321571855
Bond Position:  [-3.2340894]


portfolio before change:  [-7.61643081]
curr_Stock_Price:  100.25951667771514
curr_Factors:  [100.25951668]
mat_Sqrt:  [[0.15]]
grads:  [0.03886685]
Stock Position:  0.03886685412935256
Bond Position:  [-11.51320282]


portfolio before change:  [-7.62844088]
curr_Stock_Price:  99.96902568099156
curr_Factors:  [99.96902568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02741249]
Stock Position:  -0.027412485950610507
Bond Position:  [-4.88804136]


portfolio before change:  [-7.63576713]
curr_Stock_Price:  100.22514031321784
curr_Factors:  [100.22514031]
mat_Sqrt:  [[0.15]]
grads:  [-0.0193817]
Stock Position:  -0.01938169635773665
Bond Position:  [-5.69323389]


portfolio before change:  [-7.64837191]
curr_Stock_Price:  100.85712548186164
curr_Factors:  [100.85712548]
mat_Sqrt:  [[0.15]]
grads:  [0.05130548]
Stock Position:  0.05130548240292855
Bond Position:  [-12.82289539]


portfolio before change:  [-7.6331407]
curr_Stock_Price:  101.1696195926648
curr_Factors:  [101.16961959]
mat_Sqrt:  [[0.15]]
grads:  [-0.07832236]
Stock Position:  -0.07832235798939913
Bond Position:  [0.29070246]


portfolio before change:  [-7.643989]
curr_Stock_Price:  101.30835986496463
curr_Factors:  [101.30835986]
mat_Sqrt:  [[0.15]]
grads:  [0.06226758]
Stock Position:  0.062267577673703174
Bond Position:  [-13.95221517]


portfolio before change:  [-7.65773862]
curr_Stock_Price:  101.10154952310857
curr_Factors:  [101.10154952]
mat_Sqrt:  [[0.15]]
grads:  [0.05045432]
Stock Position:  0.05045432024003791
Bond Position:  [-12.75874858]


portfolio before change:  [-7.689687]
curr_Stock_Price:  100.48414089301954
curr_Factors:  [100.48414089]
mat_Sqrt:  [[0.15]]
grads:  [0.07638978]
Stock Position:  0.07638977930541904
Bond Position:  [-15.36564835]


portfolio before change:  [-7.68594127]
curr_Stock_Price:  100.54574741141774
curr_Factors:  [100.54574741]
mat_Sqrt:  [[0.15]]
grads:  [0.06739569]
Stock Position:  0.06739569414102232
Bond Position:  [-14.46229171]


portfolio before change:  [-7.66994137]
curr_Stock_Price:  100.79656206555137
curr_Factors:  [100.79656207]
mat_Sqrt:  [[0.15]]
grads:  [-0.22790569]
Stock Position:  -0.22790569489268955
Bond Position:  [15.30216915]


portfolio before change:  [-7.65679685]
curr_Stock_Price:  100.74308335544157
curr_Factors:  [100.74308336]
mat_Sqrt:  [[0.15]]
grads:  [0.06499524]
Stock Position:  0.06499524460866132
Bond Position:  [-14.20461819]


portfolio before change:  [-7.64467456]
curr_Stock_Price:  100.94325347817761
curr_Factors:  [100.94325348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345111]
Stock Position:  -0.0034511066658307844
Bond Position:  [-7.29630862]


portfolio before change:  [-7.64349722]
curr_Stock_Price:  100.46996435798707
curr_Factors:  [100.46996436]
mat_Sqrt:  [[0.15]]
grads:  [0.14811507]
Stock Position:  0.1481150689644421
Bond Position:  [-22.52461292]


portfolio before change:  [-7.55655515]
curr_Stock_Price:  101.06645937630701
curr_Factors:  [101.06645938]
mat_Sqrt:  [[0.15]]
grads:  [-0.03864334]
Stock Position:  -0.03864333840639638
Bond Position:  [-3.65100976]


portfolio before change:  [-7.54920617]
curr_Stock_Price:  100.87037954445454
curr_Factors:  [100.87037954]
mat_Sqrt:  [[0.15]]
grads:  [-0.10386723]
Stock Position:  -0.10386722500080721
Bond Position:  [2.92792024]


portfolio before change:  [-7.54719853]
curr_Stock_Price:  100.8528125183342
curr_Factors:  [100.85281252]
mat_Sqrt:  [[0.15]]
grads:  [0.15311523]
Stock Position:  0.15311522868939087
Bond Position:  [-22.98929998]


portfolio before change:  [-7.50985237]
curr_Stock_Price:  101.10610565643277
curr_Factors:  [101.10610566]
mat_Sqrt:  [[0.15]]
grads:  [0.01589458]
Stock Position:  0.015894581840455394
Bond Position:  [-9.11689164]


portfolio before change:  [-7.51793902]
curr_Stock_Price:  100.6331883258688
curr_Factors:  [100.63318833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05050194]
Stock Position:  -0.050501938317521054
Bond Position:  [-2.43576795]


portfolio before change:  [-7.52573114]
curr_Stock_Price:  100.78446736040375
curr_Factors:  [100.78446736]
mat_Sqrt:  [[0.15]]
grads:  [0.01372293]
Stock Position:  0.013722927075509941
Bond Position:  [-8.90878904]


portfolio before change:  [-7.52612637]
curr_Stock_Price:  100.79624238878945
curr_Factors:  [100.79624239]
mat_Sqrt:  [[0.15]]
grads:  [0.06575483]
Stock Position:  0.0657548322517057
Bond Position:  [-14.15396638]


portfolio before change:  [-7.51726731]
curr_Stock_Price:  100.9444247953088
curr_Factors:  [100.9444248]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000257]
Stock Position:  -0.05000256679344843
Bond Position:  [-2.46978697]


portfolio before change:  [-7.53205046]
curr_Stock_Price:  101.23698549243795
curr_Factors:  [101.23698549]
mat_Sqrt:  [[0.15]]
grads:  [-0.05994721]
Stock Position:  -0.05994720676519299
Bond Position:  [-1.46317596]


portfolio before change:  [-7.53395166]
curr_Stock_Price:  101.267174485003
curr_Factors:  [101.26717449]
mat_Sqrt:  [[0.15]]
grads:  [-0.05084528]
Stock Position:  -0.050845277298794116
Bond Position:  [-2.38499409]


portfolio before change:  [-7.56248688]
curr_Stock_Price:  101.82545941624787
curr_Factors:  [101.82545942]
mat_Sqrt:  [[0.15]]
grads:  [-0.11456906]
Stock Position:  -0.11456905812122192
Bond Position:  [4.1035601]


portfolio before change:  [-7.56296955]
curr_Stock_Price:  101.8319110278134
curr_Factors:  [101.83191103]
mat_Sqrt:  [[0.15]]
grads:  [-0.00443315]
Stock Position:  -0.0044331506303216025
Bond Position:  [-7.11153335]


portfolio before change:  [-7.56838644]
curr_Stock_Price:  102.95355046085947
curr_Factors:  [102.95355046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05587377]
Stock Position:  -0.05587376933591907
Bond Position:  [-1.8159835]


portfolio before change:  [-7.55121154]
curr_Stock_Price:  102.64413162540563
curr_Factors:  [102.64413163]
mat_Sqrt:  [[0.15]]
grads:  [0.03732285]
Stock Position:  0.03732285018149332
Bond Position:  [-11.38218309]


portfolio before change:  [-7.57570727]
curr_Stock_Price:  102.0068726223008
curr_Factors:  [102.00687262]
mat_Sqrt:  [[0.15]]
grads:  [0.00166689]
Stock Position:  0.0016668865606206107
Bond Position:  [-7.74574116]


portfolio before change:  [-7.57678822]
curr_Stock_Price:  101.64882539452167
curr_Factors:  [101.64882539]
mat_Sqrt:  [[0.15]]
grads:  [-0.00718131]
Stock Position:  -0.007181306100698635
Bond Position:  [-6.84681689]


portfolio before change:  [-7.57386187]
curr_Stock_Price:  101.18173965529067
curr_Factors:  [101.18173966]
mat_Sqrt:  [[0.15]]
grads:  [0.03605037]
Stock Position:  0.036050369757387325
Bond Position:  [-11.221501]


portfolio before change:  [-7.54464465]
curr_Stock_Price:  102.01165031713484
curr_Factors:  [102.01165032]
mat_Sqrt:  [[0.15]]
grads:  [-0.00473329]
Stock Position:  -0.004733291433717816
Bond Position:  [-7.06179378]


portfolio before change:  [-7.54160805]
curr_Stock_Price:  101.27685949950111
curr_Factors:  [101.2768595]
mat_Sqrt:  [[0.15]]
grads:  [0.0105814]
Stock Position:  0.010581404927722976
Bond Position:  [-8.61325951]


portfolio before change:  [-7.55171859]
curr_Stock_Price:  100.37223528099545
curr_Factors:  [100.37223528]
mat_Sqrt:  [[0.15]]
grads:  [-0.01518484]
Stock Position:  -0.015184838345499534
Bond Position:  [-6.02758242]


portfolio before change:  [-7.54063189]
curr_Stock_Price:  99.61730889054105
curr_Factors:  [99.61730889]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-8.1389002]


portfolio before change:  [-7.54456548]
curr_Stock_Price:  99.04703146333068
curr_Factors:  [99.04703146]
mat_Sqrt:  [[0.15]]
grads:  [-0.0317048]
Stock Position:  -0.031704799714796186
Bond Position:  [-4.40429919]


portfolio before change:  [-7.52561928]
curr_Stock_Price:  98.44076723757952
curr_Factors:  [98.44076724]
mat_Sqrt:  [[0.15]]
grads:  [0.03397181]
Stock Position:  0.033971806323996045
Bond Position:  [-10.86982996]


portfolio before change:  [-7.52857191]
curr_Stock_Price:  98.37385157060488
curr_Factors:  [98.37385157]
mat_Sqrt:  [[0.15]]
grads:  [-0.11833421]
Stock Position:  -0.11833420738873168
Bond Position:  [4.11241985]


portfolio before change:  [-7.56952905]
curr_Stock_Price:  98.7221377949956
curr_Factors:  [98.72213779]
mat_Sqrt:  [[0.15]]
grads:  [-0.08784463]
Stock Position:  -0.08784463129299185
Bond Position:  [1.10268075]


portfolio before change:  [-7.58918866]
curr_Stock_Price:  98.94672220428036
curr_Factors:  [98.9467222]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781068]
Stock Position:  -0.007810680169455866
Bond Position:  [-6.81634746]


portfolio before change:  [-7.58644835]
curr_Stock_Price:  98.54133585937315
curr_Factors:  [98.54133586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03254221]
Stock Position:  -0.032542208071258565
Bond Position:  [-4.3796957]


portfolio before change:  [-7.60621715]
curr_Stock_Price:  99.14040563129568
curr_Factors:  [99.14040563]
mat_Sqrt:  [[0.15]]
grads:  [0.14987496]
Stock Position:  0.1498749566986133
Bond Position:  [-22.46488115]


portfolio before change:  [-7.56628546]
curr_Stock_Price:  99.41620748335596
curr_Factors:  [99.41620748]
mat_Sqrt:  [[0.15]]
grads:  [-0.05914138]
Stock Position:  -0.05914137710308317
Bond Position:  [-1.68667404]


portfolio before change:  [-7.54668052]
curr_Stock_Price:  99.08293228143846
curr_Factors:  [99.08293228]
mat_Sqrt:  [[0.15]]
grads:  [0.04080052]
Stock Position:  0.040800517906990526
Bond Position:  [-11.58931547]


portfolio before change:  [-7.53677925]
curr_Stock_Price:  99.34336089632407
curr_Factors:  [99.3433609]
mat_Sqrt:  [[0.15]]
grads:  [-0.05881152]
Stock Position:  -0.05881152062428334
Bond Position:  [-1.69424514]


portfolio before change:  [-7.54595749]
curr_Stock_Price:  99.49762227743547
curr_Factors:  [99.49762228]
mat_Sqrt:  [[0.15]]
grads:  [0.07119023]
Stock Position:  0.07119022928345897
Bond Position:  [-14.62921604]


portfolio before change:  [-7.53328837]
curr_Stock_Price:  99.68842768141589
curr_Factors:  [99.68842768]
mat_Sqrt:  [[0.15]]
grads:  [-0.04751527]
Stock Position:  -0.04751527072634607
Bond Position:  [-2.79656574]


portfolio before change:  [-7.53071972]
curr_Stock_Price:  99.63068954529822
curr_Factors:  [99.63068955]
mat_Sqrt:  [[0.15]]
grads:  [0.07210403]
Stock Position:  0.07210403424445054
Bond Position:  [-14.71449437]


portfolio before change:  [-7.50829839]
curr_Stock_Price:  99.95440249227654
curr_Factors:  [99.95440249]
mat_Sqrt:  [[0.15]]
grads:  [-0.1411282]
Stock Position:  -0.14112819900210957
Bond Position:  [6.59808641]


portfolio before change:  [-7.37561369]
curr_Stock_Price:  99.01715315955717
curr_Factors:  [99.01715316]
mat_Sqrt:  [[0.15]]
grads:  [-0.0339012]
Stock Position:  -0.03390120377157213
Bond Position:  [-4.018813]


portfolio before change:  [-7.40845319]
curr_Stock_Price:  99.9784264605337
curr_Factors:  [99.97842646]
mat_Sqrt:  [[0.15]]
grads:  [-0.04402404]
Stock Position:  -0.04402403948609071
Bond Position:  [-3.006999]


portfolio before change:  [-7.43281033]
curr_Stock_Price:  100.52742628665655
curr_Factors:  [100.52742629]
mat_Sqrt:  [[0.15]]
grads:  [-0.01078941]
Stock Position:  -0.010789411723921054
Bond Position:  [-6.34817854]


portfolio before change:  [-7.43517292]
curr_Stock_Price:  100.70962561028057
curr_Factors:  [100.70962561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.43517292]
Stock Price:  100.15785385616358
PL:  [-7.59302678]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.89316411e-03]
 [ 3.01046044e-03]
 [-4.56417029e-03]
 [ 4.92671174e-03]
 [ 5.08314525e-03]
 [ 1.76665137e-02]
 [ 2.30753437e-03]
 [-2.11461838e-02]
 [-7.41113868e-04]
 [ 2.46130071e-02]
 [-2.30348088e-02]
 [ 2.92226472e-02]
 [-1.43183552e-02]
 [ 6.88788363e-03]
 [-6.98107868e-03]
 [ 7.77610940e-03]
 [ 7.26208072e-03]
 [-9.50944872e-03]
 [-2.30746127e-05]
 [ 1.58481839e-02]
 [ 1.16332946e-02]
 [-8.27891468e-03]
 [ 7.78308100e-03]
 [ 4.89770034e-02]
 [-5.02612030e-03]
 [ 1.07427906e-02]
 [-6.47874562e-03]
 [ 6.11926834e-03]
 [-1.39424076e-02]
 [ 9.23016416e-05]
 [-2.28927378e-03]
 [-1.01136241e-02]
 [-8.16519395e-03]
 [ 6.01006316e-03]
 [ 1.37303172e-02]
 [ 1.54613992e-03]
 [-3.10505735e-02]
 [ 7.78147815e-03]
 [-4.40337618e-02]
 [-5.00134510e-03]
 [-1.43274596e-02]
 [ 5.67539996e-02]
 [ 2.34367040e-02]
 [ 3.35853455e-03]
 [ 6.38779777e-03]
 [ 1.97921711e-02]
 [-2.65074471e-03]
 [-3.16501982e-03]
 [ 1.68862778e-02]
 [ 5.79112049e-03]
 [ 3.03558310e-02]
 [ 9.73739669e-03]
 [ 3.70671461e-04]
 [ 4.45781420e-03]
 [ 4.48175430e-03]
 [ 6.35155115e-03]
 [-2.81461506e-02]
 [ 1.28268713e-03]
 [ 1.64068702e-03]
 [-1.48891246e-01]
 [-1.81935593e-02]
 [ 1.68804196e-02]
 [ 1.91958361e-02]
 [-2.04061394e-02]
 [-6.55534511e-03]
 [-1.67703471e-02]
 [-3.15174539e-03]
 [-1.62289814e-02]
 [-2.55630608e-02]
 [ 1.92527331e-02]
 [ 2.21362680e-02]
 [ 1.44837816e-02]
 [-3.30362032e-03]
 [ 1.72089955e-02]
 [ 3.96213903e-02]
 [-3.21147828e-02]
 [ 3.67621871e-03]
 [ 1.31406459e-02]
 [ 1.45595678e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.58381559]
curr_Stock_Price:  99.97023409923563
curr_Factors:  [99.9702341]
mat_Sqrt:  [[0.15]]
grads:  [0.01262109]
Stock Position:  0.012621094093895373
Bond Position:  [0.32208186]


portfolio before change:  [1.58589016]
curr_Stock_Price:  100.1330125266372
curr_Factors:  [100.13301253]
mat_Sqrt:  [[0.15]]
grads:  [0.02006974]
Stock Position:  0.020069736250269036
Bond Position:  [-0.42375299]


portfolio before change:  [1.60405007]
curr_Stock_Price:  101.03917273323893
curr_Factors:  [101.03917273]
mat_Sqrt:  [[0.15]]
grads:  [-0.0304278]
Stock Position:  -0.030427801939322468
Bond Position:  [4.67845001]


portfolio before change:  [1.60994705]
curr_Stock_Price:  100.85498040165706
curr_Factors:  [100.8549804]
mat_Sqrt:  [[0.15]]
grads:  [0.03284474]
Stock Position:  0.032844744937135094
Bond Position:  [-1.70260905]


portfolio before change:  [1.57325817]
curr_Stock_Price:  99.74118083804396
curr_Factors:  [99.74118084]
mat_Sqrt:  [[0.15]]
grads:  [0.03388764]
Stock Position:  0.0338876350128228
Bond Position:  [-1.80673456]


portfolio before change:  [1.54660375]
curr_Stock_Price:  98.95796012318684
curr_Factors:  [98.95796012]
mat_Sqrt:  [[0.15]]
grads:  [0.11777676]
Stock Position:  0.11777675775097518
Bond Position:  [-10.10834394]


portfolio before change:  [1.49564975]
curr_Stock_Price:  98.53069238764252
curr_Factors:  [98.53069239]
mat_Sqrt:  [[0.15]]
grads:  [0.01538356]
Stock Position:  0.015383562481090622
Bond Position:  [-0.02010331]


portfolio before change:  [1.49679499]
curr_Stock_Price:  98.60521954660355
curr_Factors:  [98.60521955]
mat_Sqrt:  [[0.15]]
grads:  [-0.14097456]
Stock Position:  -0.1409745586486537
Bond Position:  [15.3976223]


portfolio before change:  [1.48682867]
curr_Stock_Price:  98.68274207659911
curr_Factors:  [98.68274208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00494076]
Stock Position:  -0.00494075912109668
Bond Position:  [1.97439632]


portfolio before change:  [1.48831715]
curr_Stock_Price:  98.40645266724785
curr_Factors:  [98.40645267]
mat_Sqrt:  [[0.15]]
grads:  [0.16408671]
Stock Position:  0.16408671409972672
Bond Position:  [-14.65887432]


portfolio before change:  [1.4383965]
curr_Stock_Price:  98.10780300877138
curr_Factors:  [98.10780301]
mat_Sqrt:  [[0.15]]
grads:  [-0.15356539]
Stock Position:  -0.15356539223792567
Bond Position:  [16.50435975]


portfolio before change:  [1.52920459]
curr_Stock_Price:  97.52318865470136
curr_Factors:  [97.52318865]
mat_Sqrt:  [[0.15]]
grads:  [0.19481765]
Stock Position:  0.19481764816634056
Bond Position:  [-17.47003367]


portfolio before change:  [1.74255931]
curr_Stock_Price:  98.62394433611469
curr_Factors:  [98.62394434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0954557]
Stock Position:  -0.0954557015035829
Bond Position:  [11.1567771]


portfolio before change:  [1.74377564]
curr_Stock_Price:  98.61850714689874
curr_Factors:  [98.61850715]
mat_Sqrt:  [[0.15]]
grads:  [0.04591922]
Stock Position:  0.045919224183289864
Bond Position:  [-2.7847097]


portfolio before change:  [1.73242532]
curr_Stock_Price:  98.37511739027768
curr_Factors:  [98.37511739]
mat_Sqrt:  [[0.15]]
grads:  [-0.04654052]
Stock Position:  -0.046540524508747
Bond Position:  [6.31085488]


portfolio before change:  [1.6959518]
curr_Stock_Price:  99.1672863310681
curr_Factors:  [99.16728633]
mat_Sqrt:  [[0.15]]
grads:  [0.05184073]
Stock Position:  0.05184072932008295
Bond Position:  [-3.44495264]


portfolio before change:  [1.68268763]
curr_Stock_Price:  98.91557585071811
curr_Factors:  [98.91557585]
mat_Sqrt:  [[0.15]]
grads:  [0.04841387]
Stock Position:  0.048413871481158166
Bond Position:  [-3.10619834]


portfolio before change:  [1.68529345]
curr_Stock_Price:  98.97340974687329
curr_Factors:  [98.97340975]
mat_Sqrt:  [[0.15]]
grads:  [-0.06339632]
Stock Position:  -0.06339632480389176
Bond Position:  [7.95984388]


portfolio before change:  [1.67958065]
curr_Stock_Price:  99.07136975552409
curr_Factors:  [99.07136976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00015383]
Stock Position:  -0.00015383075126571233
Bond Position:  [1.69482088]


portfolio before change:  [1.67961277]
curr_Stock_Price:  99.55117910031956
curr_Factors:  [99.5511791]
mat_Sqrt:  [[0.15]]
grads:  [0.10565456]
Stock Position:  0.10565455964555003
Bond Position:  [-8.83842322]


portfolio before change:  [1.63275999]
curr_Stock_Price:  99.11295511688394
curr_Factors:  [99.11295512]
mat_Sqrt:  [[0.15]]
grads:  [0.0775553]
Stock Position:  0.07755529741316802
Bond Position:  [-6.05397472]


portfolio before change:  [1.62821432]
curr_Stock_Price:  99.05922200983211
curr_Factors:  [99.05922201]
mat_Sqrt:  [[0.15]]
grads:  [-0.05519276]
Stock Position:  -0.05519276451256854
Bond Position:  [7.09556663]


portfolio before change:  [1.64313937]
curr_Stock_Price:  98.79684040651235
curr_Factors:  [98.79684041]
mat_Sqrt:  [[0.15]]
grads:  [0.05188721]
Stock Position:  0.05188720664873796
Bond Position:  [-3.4831527]


portfolio before change:  [1.71840937]
curr_Stock_Price:  100.25168259354423
curr_Factors:  [100.25168259]
mat_Sqrt:  [[0.15]]
grads:  [0.32651336]
Stock Position:  0.32651335612207066
Bond Position:  [-31.01510397]


portfolio before change:  [1.52308726]
curr_Stock_Price:  99.6594140061807
curr_Factors:  [99.65941401]
mat_Sqrt:  [[0.15]]
grads:  [-0.03350747]
Stock Position:  -0.0335074686817812
Bond Position:  [4.86242195]


portfolio before change:  [1.51460776]
curr_Stock_Price:  99.92154694035568
curr_Factors:  [99.92154694]
mat_Sqrt:  [[0.15]]
grads:  [0.0716186]
Stock Position:  0.07161860369896925
Bond Position:  [-5.64163391]


portfolio before change:  [1.4705779]
curr_Stock_Price:  99.31168794699762
curr_Factors:  [99.31168795]
mat_Sqrt:  [[0.15]]
grads:  [-0.04319164]
Stock Position:  -0.043191637459454445
Bond Position:  [5.76001232]


portfolio before change:  [1.46981692]
curr_Stock_Price:  99.33764165393119
curr_Factors:  [99.33764165]
mat_Sqrt:  [[0.15]]
grads:  [0.04079512]
Stock Position:  0.040795122234026024
Bond Position:  [-2.58267431]


portfolio before change:  [1.44190135]
curr_Stock_Price:  98.6573114713508
curr_Factors:  [98.65731147]
mat_Sqrt:  [[0.15]]
grads:  [-0.09294938]
Stock Position:  -0.0929493843287462
Bond Position:  [10.61203771]


portfolio before change:  [1.4754408]
curr_Stock_Price:  98.30361171288811
curr_Factors:  [98.30361171]
mat_Sqrt:  [[0.15]]
grads:  [0.00061534]
Stock Position:  0.000615344277600166
Bond Position:  [1.41495023]


portfolio before change:  [1.47549454]
curr_Stock_Price:  98.24722853124801
curr_Factors:  [98.24722853]
mat_Sqrt:  [[0.15]]
grads:  [-0.01526183]
Stock Position:  -0.015261825187766595
Bond Position:  [2.97492657]


portfolio before change:  [1.48363098]
curr_Stock_Price:  97.72628811406214
curr_Factors:  [97.72628811]
mat_Sqrt:  [[0.15]]
grads:  [-0.06742416]
Stock Position:  -0.06742416080122936
Bond Position:  [8.07274394]


portfolio before change:  [1.53334791]
curr_Stock_Price:  96.996395913242
curr_Factors:  [96.99639591]
mat_Sqrt:  [[0.15]]
grads:  [-0.05443463]
Stock Position:  -0.05443462633213699
Bond Position:  [6.81331048]


portfolio before change:  [1.57232379]
curr_Stock_Price:  96.28820640798905
curr_Factors:  [96.28820641]
mat_Sqrt:  [[0.15]]
grads:  [0.04006709]
Stock Position:  0.0400670877011617
Bond Position:  [-2.28566422]


portfolio before change:  [1.52108522]
curr_Stock_Price:  95.01295243994574
curr_Factors:  [95.01295244]
mat_Sqrt:  [[0.15]]
grads:  [0.09153545]
Stock Position:  0.09153544771625659
Bond Position:  [-7.17596792]


portfolio before change:  [1.5064673]
curr_Stock_Price:  94.85815557325029
curr_Factors:  [94.85815557]
mat_Sqrt:  [[0.15]]
grads:  [0.0103076]
Stock Position:  0.010307599498922312
Bond Position:  [0.52870743]


portfolio before change:  [1.51141499]
curr_Stock_Price:  95.33495380491695
curr_Factors:  [95.3349538]
mat_Sqrt:  [[0.15]]
grads:  [-0.20700382]
Stock Position:  -0.20700382359145975
Bond Position:  [21.24611495]


portfolio before change:  [1.54194918]
curr_Stock_Price:  95.19386336315014
curr_Factors:  [95.19386336]
mat_Sqrt:  [[0.15]]
grads:  [0.05187652]
Stock Position:  0.051876520988916146
Bond Position:  [-3.39637727]


portfolio before change:  [1.52698924]
curr_Stock_Price:  94.90957957590295
curr_Factors:  [94.90957958]
mat_Sqrt:  [[0.15]]
grads:  [-0.29355841]
Stock Position:  -0.2935584121383146
Bond Position:  [29.38849472]


portfolio before change:  [1.56641536]
curr_Stock_Price:  94.78153256938931
curr_Factors:  [94.78153257]
mat_Sqrt:  [[0.15]]
grads:  [-0.0333423]
Stock Position:  -0.03334230064198296
Bond Position:  [4.72664971]


portfolio before change:  [1.55155145]
curr_Stock_Price:  95.23619039334862
curr_Factors:  [95.23619039]
mat_Sqrt:  [[0.15]]
grads:  [-0.0955164]
Stock Position:  -0.09551639748286882
Bond Position:  [10.64816926]


portfolio before change:  [1.60592055]
curr_Stock_Price:  94.67394584388444
curr_Factors:  [94.67394584]
mat_Sqrt:  [[0.15]]
grads:  [0.37836]
Stock Position:  0.3783599970354852
Bond Position:  [-34.21491332]


portfolio before change:  [1.60662242]
curr_Stock_Price:  94.6814529085203
curr_Factors:  [94.68145291]
mat_Sqrt:  [[0.15]]
grads:  [0.15624469]
Stock Position:  0.1562446930837384
Bond Position:  [-13.18685213]


portfolio before change:  [1.62090982]
curr_Stock_Price:  94.77817045953057
curr_Factors:  [94.77817046]
mat_Sqrt:  [[0.15]]
grads:  [0.02239023]
Stock Position:  0.022390230320862084
Bond Position:  [-0.50119524]


portfolio before change:  [1.645245]
curr_Stock_Price:  95.8664353260483
curr_Factors:  [95.86643533]
mat_Sqrt:  [[0.15]]
grads:  [0.04258532]
Stock Position:  0.042585318474593827
Bond Position:  [-2.43725768]


portfolio before change:  [1.6122401]
curr_Stock_Price:  95.09498254856236
curr_Factors:  [95.09498255]
mat_Sqrt:  [[0.15]]
grads:  [0.13194781]
Stock Position:  0.13194780743309012
Bond Position:  [-10.93533434]


portfolio before change:  [1.54491642]
curr_Stock_Price:  94.5899327954009
curr_Factors:  [94.5899328]
mat_Sqrt:  [[0.15]]
grads:  [-0.01767163]
Stock Position:  -0.01767163138069255
Bond Position:  [3.21647484]


portfolio before change:  [1.54880838]
curr_Stock_Price:  94.38107098560171
curr_Factors:  [94.38107099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110013]
Stock Position:  -0.021100132153296782
Bond Position:  [3.54026145]


portfolio before change:  [1.53712692]
curr_Stock_Price:  94.94517793751109
curr_Factors:  [94.94517794]
mat_Sqrt:  [[0.15]]
grads:  [0.11257519]
Stock Position:  0.11257518564296069
Bond Position:  [-9.15134411]


portfolio before change:  [1.53816358]
curr_Stock_Price:  94.95946732741253
curr_Factors:  [94.95946733]
mat_Sqrt:  [[0.15]]
grads:  [0.03860747]
Stock Position:  0.03860746992391471
Bond Position:  [-2.1279812]


portfolio before change:  [1.51773715]
curr_Stock_Price:  94.43383260209966
curr_Factors:  [94.4338326]
mat_Sqrt:  [[0.15]]
grads:  [0.20237221]
Stock Position:  0.20237220682556106
Bond Position:  [-17.59304595]


portfolio before change:  [1.52096724]
curr_Stock_Price:  94.45522729711355
curr_Factors:  [94.4552273]
mat_Sqrt:  [[0.15]]
grads:  [0.06491598]
Stock Position:  0.06491597796463164
Bond Position:  [-4.61068621]


portfolio before change:  [1.53229392]
curr_Stock_Price:  94.63414862730218
curr_Factors:  [94.63414863]
mat_Sqrt:  [[0.15]]
grads:  [0.00247114]
Stock Position:  0.0024711430738217927
Bond Position:  [1.2984394]


portfolio before change:  [1.53092749]
curr_Stock_Price:  94.04835570388288
curr_Factors:  [94.0483557]
mat_Sqrt:  [[0.15]]
grads:  [0.02971876]
Stock Position:  0.02971876131997254
Bond Position:  [-1.26407314]


portfolio before change:  [1.50317969]
curr_Stock_Price:  93.11733465925735
curr_Factors:  [93.11733466]
mat_Sqrt:  [[0.15]]
grads:  [0.02987836]
Stock Position:  0.02987836198738051
Bond Position:  [-1.27901374]


portfolio before change:  [1.48916255]
curr_Stock_Price:  92.65087005194421
curr_Factors:  [92.65087005]
mat_Sqrt:  [[0.15]]
grads:  [0.04234367]
Stock Position:  0.0423436743176
Bond Position:  [-2.43401571]


portfolio before change:  [1.48997207]
curr_Stock_Price:  92.67358056566815
curr_Factors:  [92.67358057]
mat_Sqrt:  [[0.15]]
grads:  [-0.187641]
Stock Position:  -0.18764100375388515
Bond Position:  [18.87933575]


portfolio before change:  [1.53882942]
curr_Stock_Price:  92.41949242972571
curr_Factors:  [92.41949243]
mat_Sqrt:  [[0.15]]
grads:  [0.00855125]
Stock Position:  0.008551247552504783
Bond Position:  [0.74852746]


portfolio before change:  [1.53978519]
curr_Stock_Price:  92.52579170409872
curr_Factors:  [92.5257917]
mat_Sqrt:  [[0.15]]
grads:  [0.01093791]
Stock Position:  0.010937913441520602
Bond Position:  [0.52774609]


portfolio before change:  [1.53232379]
curr_Stock_Price:  91.84061583674682
curr_Factors:  [91.84061584]
mat_Sqrt:  [[0.15]]
grads:  [-0.9926083]
Stock Position:  -0.9926083034680466
Bond Position:  [92.69408166]


portfolio before change:  [1.28331166]
curr_Stock_Price:  92.09731899433854
curr_Factors:  [92.09731899]
mat_Sqrt:  [[0.15]]
grads:  [-0.1212904]
Stock Position:  -0.12129039557327781
Bond Position:  [12.45383191]


portfolio before change:  [1.31026815]
curr_Stock_Price:  91.88148903908575
curr_Factors:  [91.88148904]
mat_Sqrt:  [[0.15]]
grads:  [0.11253613]
Stock Position:  0.11253613037996486
Bond Position:  [-9.02971908]


portfolio before change:  [1.32629415]
curr_Stock_Price:  92.02891164875162
curr_Factors:  [92.02891165]
mat_Sqrt:  [[0.15]]
grads:  [0.12797224]
Stock Position:  0.12797224087147213
Bond Position:  [-10.4508519]


portfolio before change:  [1.28122949]
curr_Stock_Price:  91.68187187792266
curr_Factors:  [91.68187188]
mat_Sqrt:  [[0.15]]
grads:  [-0.13604093]
Stock Position:  -0.13604092954257507
Bond Position:  [13.75371656]


portfolio before change:  [1.24588177]
curr_Stock_Price:  91.94802231208145
curr_Factors:  [91.94802231]
mat_Sqrt:  [[0.15]]
grads:  [-0.0437023]
Stock Position:  -0.04370230072803026
Bond Position:  [5.26422189]


portfolio before change:  [1.22053838]
curr_Stock_Price:  92.53546080263683
curr_Factors:  [92.5354608]
mat_Sqrt:  [[0.15]]
grads:  [-0.11180231]
Stock Position:  -0.11180231383983517
Bond Position:  [11.56621701]


portfolio before change:  [1.32790294]
curr_Stock_Price:  91.58161966086385
curr_Factors:  [91.58161966]
mat_Sqrt:  [[0.15]]
grads:  [-0.02101164]
Stock Position:  -0.02101163593122579
Bond Position:  [3.25218259]


portfolio before change:  [1.33268126]
curr_Stock_Price:  91.36388081280312
curr_Factors:  [91.36388081]
mat_Sqrt:  [[0.15]]
grads:  [-0.10819321]
Stock Position:  -0.1081932095454477
Bond Position:  [11.21763276]


portfolio before change:  [1.35372315]
curr_Stock_Price:  91.17587666089113
curr_Factors:  [91.17587666]
mat_Sqrt:  [[0.15]]
grads:  [-0.17042041]
Stock Position:  -0.1704204052978055
Bond Position:  [16.89195301]


portfolio before change:  [1.45774991]
curr_Stock_Price:  90.57165926015293
curr_Factors:  [90.57165926]
mat_Sqrt:  [[0.15]]
grads:  [0.12835155]
Stock Position:  0.12835155428838013
Bond Position:  [-10.16726333]


portfolio before change:  [1.4668329]
curr_Stock_Price:  90.64737680800765
curr_Factors:  [90.64737681]
mat_Sqrt:  [[0.15]]
grads:  [0.14757512]
Stock Position:  0.14757511968505335
Bond Position:  [-11.91046458]


portfolio before change:  [1.28025082]
curr_Stock_Price:  89.38810186885144
curr_Factors:  [89.38810187]
mat_Sqrt:  [[0.15]]
grads:  [0.09655854]
Stock Position:  0.09655854427167583
Bond Position:  [-7.35093417]


portfolio before change:  [1.25034762]
curr_Stock_Price:  89.08317025787899
curr_Factors:  [89.08317026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02202414]
Stock Position:  -0.02202413549352163
Bond Position:  [3.21232743]


portfolio before change:  [1.24988331]
curr_Stock_Price:  89.11336851745894
curr_Factors:  [89.11336852]
mat_Sqrt:  [[0.15]]
grads:  [0.11472664]
Stock Position:  0.11472663686187565
Bond Position:  [-8.97379376]


portfolio before change:  [1.33479014]
curr_Stock_Price:  89.8583368481466
curr_Factors:  [89.85833685]
mat_Sqrt:  [[0.15]]
grads:  [0.2641426]
Stock Position:  0.2641426021683465
Bond Position:  [-22.40062478]


portfolio before change:  [1.31121614]
curr_Stock_Price:  89.7743900960895
curr_Factors:  [89.7743901]
mat_Sqrt:  [[0.15]]
grads:  [-0.21409855]
Stock Position:  -0.21409855179662624
Bond Position:  [20.53178305]


portfolio before change:  [1.30740589]
curr_Stock_Price:  89.79818067582602
curr_Factors:  [89.79818068]
mat_Sqrt:  [[0.15]]
grads:  [0.02450812]
Stock Position:  0.02450812474449316
Bond Position:  [-0.89337912]


portfolio before change:  [1.30054917]
curr_Stock_Price:  89.52068577617669
curr_Factors:  [89.52068578]
mat_Sqrt:  [[0.15]]
grads:  [0.08760431]
Stock Position:  0.08760430587865539
Bond Position:  [-6.54184837]


portfolio before change:  [1.28541626]
curr_Stock_Price:  89.35261150158871
curr_Factors:  [89.3526115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.28541626]
Stock Price:  89.62723709077333
PL:  [1.28541626]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.64118819e-03]
 [-1.30628992e-02]
 [-6.30041926e-03]
 [ 5.97991872e-03]
 [ 4.19754547e-03]
 [ 2.48907373e-02]
 [ 1.53687255e-03]
 [-1.68420671e-02]
 [ 7.57192667e-03]
 [ 1.00681630e-02]
 [ 1.32611014e-02]
 [-2.57942420e-02]
 [ 1.11445104e-03]
 [ 1.88353339e-03]
 [-6.91481366e-03]
 [ 1.28839231e-02]
 [ 7.22640590e-03]
 [-1.16237319e-02]
 [ 4.15603719e-04]
 [ 1.55626727e-02]
 [ 1.14202738e-02]
 [-7.50130858e-03]
 [ 1.08163847e-02]
 [ 5.75471486e-03]
 [ 1.96123425e-03]
 [ 1.45065994e-02]
 [-6.65343635e-03]
 [ 5.75840473e-03]
 [-7.68007934e-03]
 [-2.29928227e-03]
 [ 2.18228257e-03]
 [-1.20484835e-02]
 [ 6.40842653e-03]
 [ 7.30165486e-03]
 [ 1.14522754e-02]
 [ 8.54912625e-03]
 [-3.40930797e-02]
 [ 9.56731585e-03]
 [ 7.26336911e-03]
 [ 1.31502108e-02]
 [-3.86139919e-03]
 [-1.48076329e-02]
 [ 2.02442799e-02]
 [-3.76088734e-03]
 [ 7.50839882e-03]
 [-1.64098170e-02]
 [ 1.53471030e-02]
 [ 1.85110658e-02]
 [ 7.82756528e-03]
 [-7.65062301e-03]
 [ 2.32410129e-02]
 [ 3.80643243e-03]
 [-9.45582498e-03]
 [ 5.90444681e-03]
 [-1.35291797e-02]
 [ 1.61244014e-02]
 [ 1.04526443e-02]
 [ 7.56395836e-04]
 [ 1.76020074e-03]
 [ 1.03958447e-02]
 [ 9.63972040e-03]
 [ 3.10050370e-02]
 [ 1.93217793e-03]
 [-1.24206963e-02]
 [ 1.46783452e-02]
 [ 7.53286526e-03]
 [-5.13706973e-03]
 [ 1.54081777e-02]
 [-9.79837624e-03]
 [-2.07496074e-02]
 [-8.71534327e-03]
 [ 1.56594700e-02]
 [-2.55349300e-02]
 [ 2.77980981e-02]
 [-2.66469041e-02]
 [ 2.86040688e-03]
 [ 3.14886651e-03]
 [-1.25247654e-02]
 [ 2.62837130e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.6275187]
curr_Stock_Price:  99.43629242441327
curr_Factors:  [99.43629242]
mat_Sqrt:  [[0.15]]
grads:  [0.03094125]
Stock Position:  0.030941254594964916
Bond Position:  [-9.70420234]


portfolio before change:  [-6.63810133]
curr_Stock_Price:  99.11387197925168
curr_Factors:  [99.11387198]
mat_Sqrt:  [[0.15]]
grads:  [-0.08708599]
Stock Position:  -0.0870859945030692
Bond Position:  [1.99332878]


portfolio before change:  [-6.58334463]
curr_Stock_Price:  98.48653680588319
curr_Factors:  [98.48653681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0420028]
Stock Position:  -0.04200279506323761
Bond Position:  [-2.44663481]


portfolio before change:  [-6.58429682]
curr_Stock_Price:  98.50556566229298
curr_Factors:  [98.50556566]
mat_Sqrt:  [[0.15]]
grads:  [0.03986612]
Stock Position:  0.039866124789282184
Bond Position:  [-10.51133199]


portfolio before change:  [-6.5452487]
curr_Stock_Price:  99.50152632217933
curr_Factors:  [99.50152632]
mat_Sqrt:  [[0.15]]
grads:  [0.02798364]
Stock Position:  0.027983636483370246
Bond Position:  [-9.32966325]


portfolio before change:  [-6.52843043]
curr_Stock_Price:  100.12336810298441
curr_Factors:  [100.1233681]
mat_Sqrt:  [[0.15]]
grads:  [0.16593825]
Stock Position:  0.16593824863641374
Bond Position:  [-23.14272678]


portfolio before change:  [-6.49643166]
curr_Stock_Price:  100.32492041063841
curr_Factors:  [100.32492041]
mat_Sqrt:  [[0.15]]
grads:  [0.01024582]
Stock Position:  0.010245816990454163
Bond Position:  [-7.52434244]


portfolio before change:  [-6.49959345]
curr_Stock_Price:  100.06222787516135
curr_Factors:  [100.06222788]
mat_Sqrt:  [[0.15]]
grads:  [-0.11228045]
Stock Position:  -0.11228044752242648
Bond Position:  [4.73543828]


portfolio before change:  [-6.40315458]
curr_Stock_Price:  99.20595328606076
curr_Factors:  [99.20595329]
mat_Sqrt:  [[0.15]]
grads:  [0.05047951]
Stock Position:  0.05047951116004087
Bond Position:  [-11.4110226]


portfolio before change:  [-6.38644801]
curr_Stock_Price:  99.55103937479852
curr_Factors:  [99.55103937]
mat_Sqrt:  [[0.15]]
grads:  [0.06712109]
Stock Position:  0.06712108658311003
Bond Position:  [-13.06842195]


portfolio before change:  [-6.36796411]
curr_Stock_Price:  99.83858987463296
curr_Factors:  [99.83858987]
mat_Sqrt:  [[0.15]]
grads:  [0.08840734]
Stock Position:  0.08840734267045447
Bond Position:  [-15.19442854]


portfolio before change:  [-6.28107875]
curr_Stock_Price:  100.83211649061323
curr_Factors:  [100.83211649]
mat_Sqrt:  [[0.15]]
grads:  [-0.17196161]
Stock Position:  -0.17196161350273934
Bond Position:  [11.0581747]


portfolio before change:  [-6.17221327]
curr_Stock_Price:  100.20305563880729
curr_Factors:  [100.20305564]
mat_Sqrt:  [[0.15]]
grads:  [0.00742967]
Stock Position:  0.007429673627694713
Bond Position:  [-6.91668927]


portfolio before change:  [-6.17130003]
curr_Stock_Price:  100.38415942107119
curr_Factors:  [100.38415942]
mat_Sqrt:  [[0.15]]
grads:  [0.01255689]
Stock Position:  0.01255688927877918
Bond Position:  [-7.43181281]


portfolio before change:  [-6.17316076]
curr_Stock_Price:  100.27296751619322
curr_Factors:  [100.27296752]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609876]
Stock Position:  -0.04609875770619243
Bond Position:  [-1.55070153]


portfolio before change:  [-6.16838244]
curr_Stock_Price:  100.1672109909151
curr_Factors:  [100.16721099]
mat_Sqrt:  [[0.15]]
grads:  [0.08589282]
Stock Position:  0.08589282071283096
Bond Position:  [-14.77202673]


portfolio before change:  [-6.2402639]
curr_Stock_Price:  99.34108628836172
curr_Factors:  [99.34108629]
mat_Sqrt:  [[0.15]]
grads:  [0.04817604]
Stock Position:  0.0481760393030382
Bond Position:  [-11.02612398]


portfolio before change:  [-6.24525874]
curr_Stock_Price:  99.2517122201038
curr_Factors:  [99.25171222]
mat_Sqrt:  [[0.15]]
grads:  [-0.07749155]
Stock Position:  -0.07749154592794216
Bond Position:  [1.44590987]


portfolio before change:  [-6.21681016]
curr_Stock_Price:  98.88575984962176
curr_Factors:  [98.88575985]
mat_Sqrt:  [[0.15]]
grads:  [0.00277069]
Stock Position:  0.002770691462139306
Bond Position:  [-6.49079209]


portfolio before change:  [-6.21585549]
curr_Stock_Price:  99.376737946221
curr_Factors:  [99.37673795]
mat_Sqrt:  [[0.15]]
grads:  [0.10375115]
Stock Position:  0.10375115132094284
Bond Position:  [-16.52630647]


portfolio before change:  [-6.1460167]
curr_Stock_Price:  100.05983128506492
curr_Factors:  [100.05983129]
mat_Sqrt:  [[0.15]]
grads:  [0.07613516]
Stock Position:  0.07613515866623194
Bond Position:  [-13.76408783]


portfolio before change:  [-6.12550511]
curr_Stock_Price:  100.34054097963667
curr_Factors:  [100.34054098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000872]
Stock Position:  -0.05000872389499737
Bond Position:  [-1.1076027]


portfolio before change:  [-6.20205291]
curr_Stock_Price:  101.86984562651128
curr_Factors:  [101.86984563]
mat_Sqrt:  [[0.15]]
grads:  [0.07210923]
Stock Position:  0.07210923154381257
Bond Position:  [-13.54780919]


portfolio before change:  [-6.21042615]
curr_Stock_Price:  101.76546955807349
curr_Factors:  [101.76546956]
mat_Sqrt:  [[0.15]]
grads:  [0.03836477]
Stock Position:  0.03836476575361685
Bond Position:  [-10.11463455]


portfolio before change:  [-6.21363029]
curr_Stock_Price:  101.69843000536692
curr_Factors:  [101.69843001]
mat_Sqrt:  [[0.15]]
grads:  [0.01307489]
Stock Position:  0.013074894979094668
Bond Position:  [-7.54332658]


portfolio before change:  [-6.22930214]
curr_Stock_Price:  100.53586797446798
curr_Factors:  [100.53586797]
mat_Sqrt:  [[0.15]]
grads:  [0.09671066]
Stock Position:  0.096710662817836
Bond Position:  [-15.95219257]


portfolio before change:  [-6.23290829]
curr_Stock_Price:  100.50888948785584
curr_Factors:  [100.50888949]
mat_Sqrt:  [[0.15]]
grads:  [-0.04435624]
Stock Position:  -0.04435624232739646
Bond Position:  [-1.77471163]


portfolio before change:  [-6.21442357]
curr_Stock_Price:  100.0896555639937
curr_Factors:  [100.08965556]
mat_Sqrt:  [[0.15]]
grads:  [0.03838936]
Stock Position:  0.03838936484962129
Bond Position:  [-10.05680188]


portfolio before change:  [-6.22826807]
curr_Stock_Price:  99.74539553953241
curr_Factors:  [99.74539554]
mat_Sqrt:  [[0.15]]
grads:  [-0.05120053]
Stock Position:  -0.05120052890943895
Bond Position:  [-1.12125106]


portfolio before change:  [-6.22958779]
curr_Stock_Price:  99.76980235336308
curr_Factors:  [99.76980235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01532855]
Stock Position:  -0.015328548477222054
Bond Position:  [-4.70026154]


portfolio before change:  [-6.23247624]
curr_Stock_Price:  99.93907342662735
curr_Factors:  [99.93907343]
mat_Sqrt:  [[0.15]]
grads:  [0.01454855]
Stock Position:  0.014548550499598814
Bond Position:  [-7.6864449]


portfolio before change:  [-6.22118884]
curr_Stock_Price:  100.74793887995997
curr_Factors:  [100.74793888]
mat_Sqrt:  [[0.15]]
grads:  [-0.08032322]
Stock Position:  -0.08032322334842304
Bond Position:  [1.87121036]


portfolio before change:  [-6.20839569]
curr_Stock_Price:  100.59012399415882
curr_Factors:  [100.59012399]
mat_Sqrt:  [[0.15]]
grads:  [0.04272284]
Stock Position:  0.04272284356070368
Bond Position:  [-10.50589182]


portfolio before change:  [-6.1947545]
curr_Stock_Price:  100.9247885257544
curr_Factors:  [100.92478853]
mat_Sqrt:  [[0.15]]
grads:  [0.0486777]
Stock Position:  0.04867769904151828
Bond Position:  [-11.10754099]


portfolio before change:  [-6.20219605]
curr_Stock_Price:  100.78617673085262
curr_Factors:  [100.78617673]
mat_Sqrt:  [[0.15]]
grads:  [0.0763485]
Stock Position:  0.07634850265013793
Bond Position:  [-13.89706973]


portfolio before change:  [-6.13792013]
curr_Stock_Price:  101.63942876424723
curr_Factors:  [101.63942876]
mat_Sqrt:  [[0.15]]
grads:  [0.05699417]
Stock Position:  0.05699417499558118
Bond Position:  [-11.93077552]


portfolio before change:  [-6.17634536]
curr_Stock_Price:  100.97831669645656
curr_Factors:  [100.9783167]
mat_Sqrt:  [[0.15]]
grads:  [-0.2272872]
Stock Position:  -0.22728719826839505
Bond Position:  [16.77473332]


portfolio before change:  [-6.35089553]
curr_Stock_Price:  101.75090144395686
curr_Factors:  [101.75090144]
mat_Sqrt:  [[0.15]]
grads:  [0.06378211]
Stock Position:  0.0637821056925294
Bond Position:  [-12.84078228]


portfolio before change:  [-6.29678269]
curr_Stock_Price:  102.61188605026766
curr_Factors:  [102.61188605]
mat_Sqrt:  [[0.15]]
grads:  [0.04842246]
Stock Position:  0.04842246072361297
Bond Position:  [-11.26550272]


portfolio before change:  [-6.26591114]
curr_Stock_Price:  103.26397328836954
curr_Factors:  [103.26397329]
mat_Sqrt:  [[0.15]]
grads:  [0.08766807]
Stock Position:  0.08766807196097895
Bond Position:  [-15.31886458]


portfolio before change:  [-6.19040841]
curr_Stock_Price:  104.13612879846433
curr_Factors:  [104.1361288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574266]
Stock Position:  -0.025742661278086304
Bond Position:  [-3.50966732]


portfolio before change:  [-6.21175861]
curr_Stock_Price:  104.95697774493505
curr_Factors:  [104.95697774]
mat_Sqrt:  [[0.15]]
grads:  [-0.09871755]
Stock Position:  -0.09871755277640067
Bond Position:  [4.14933738]


portfolio before change:  [-6.21666245]
curr_Stock_Price:  105.00928034717342
curr_Factors:  [105.00928035]
mat_Sqrt:  [[0.15]]
grads:  [0.13496187]
Stock Position:  0.13496186579040753
Bond Position:  [-20.38891085]


portfolio before change:  [-6.27673283]
curr_Stock_Price:  104.57363112880111
curr_Factors:  [104.57363113]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507258]
Stock Position:  -0.02507258228510341
Bond Position:  [-3.65480186]


portfolio before change:  [-6.26439692]
curr_Stock_Price:  104.07251236531725
curr_Factors:  [104.07251237]
mat_Sqrt:  [[0.15]]
grads:  [0.05005599]
Stock Position:  0.05005599212767456
Bond Position:  [-11.47384978]


portfolio before change:  [-6.27350872]
curr_Stock_Price:  103.90480692556746
curr_Factors:  [103.90480693]
mat_Sqrt:  [[0.15]]
grads:  [-0.10939878]
Stock Position:  -0.1093987800676183
Bond Position:  [5.0935504]


portfolio before change:  [-6.37230986]
curr_Stock_Price:  104.81084538582489
curr_Factors:  [104.81084539]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [-17.09592876]


portfolio before change:  [-6.32441859]
curr_Stock_Price:  105.28937030619991
curr_Factors:  [105.28937031]
mat_Sqrt:  [[0.15]]
grads:  [0.12340711]
Stock Position:  0.1234071054760133
Bond Position:  [-19.31787501]


portfolio before change:  [-6.32003133]
curr_Stock_Price:  105.33470526679353
curr_Factors:  [105.33470527]
mat_Sqrt:  [[0.15]]
grads:  [0.05218377]
Stock Position:  0.052183768534385104
Bond Position:  [-11.81679321]


portfolio before change:  [-6.28785639]
curr_Stock_Price:  105.96542856355565
curr_Factors:  [105.96542856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05100415]
Stock Position:  -0.05100415337056429
Bond Position:  [-0.88317942]


portfolio before change:  [-6.2891739]
curr_Stock_Price:  105.99017767199793
curr_Factors:  [105.99017767]
mat_Sqrt:  [[0.15]]
grads:  [0.15494009]
Stock Position:  0.15494008603097414
Bond Position:  [-22.71130114]


portfolio before change:  [-6.38954543]
curr_Stock_Price:  105.35153056720299
curr_Factors:  [105.35153057]
mat_Sqrt:  [[0.15]]
grads:  [0.02537622]
Stock Position:  0.025376216170875054
Bond Position:  [-9.06296865]


portfolio before change:  [-6.40767912]
curr_Stock_Price:  104.65925917842368
curr_Factors:  [104.65925918]
mat_Sqrt:  [[0.15]]
grads:  [-0.06303883]
Stock Position:  -0.06303883319673945
Bond Position:  [0.18991847]


portfolio before change:  [-6.38381376]
curr_Stock_Price:  104.28086565979413
curr_Factors:  [104.28086566]
mat_Sqrt:  [[0.15]]
grads:  [0.03936298]
Stock Position:  0.0393629787144283
Bond Position:  [-10.48861925]


portfolio before change:  [-6.35971567]
curr_Stock_Price:  104.90972181774968
curr_Factors:  [104.90972182]
mat_Sqrt:  [[0.15]]
grads:  [-0.09019453]
Stock Position:  -0.0901945310078647
Bond Position:  [3.10256749]


portfolio before change:  [-6.32934763]
curr_Stock_Price:  104.57517687750314
curr_Factors:  [104.57517688]
mat_Sqrt:  [[0.15]]
grads:  [0.10749601]
Stock Position:  0.10749600943530258
Bond Position:  [-17.57076183]


portfolio before change:  [-6.40229456]
curr_Stock_Price:  103.90679177171454
curr_Factors:  [103.90679177]
mat_Sqrt:  [[0.15]]
grads:  [0.0696843]
Stock Position:  0.06968429565619746
Bond Position:  [-13.64296616]


portfolio before change:  [-6.34764215]
curr_Stock_Price:  104.703314568543
curr_Factors:  [104.70331457]
mat_Sqrt:  [[0.15]]
grads:  [0.00504264]
Stock Position:  0.005042638905794071
Bond Position:  [-6.87562315]


portfolio before change:  [-6.35282976]
curr_Stock_Price:  103.75978561722754
curr_Factors:  [103.75978562]
mat_Sqrt:  [[0.15]]
grads:  [0.01173467]
Stock Position:  0.011734671602428675
Bond Position:  [-7.57041677]


portfolio before change:  [-6.34203985]
curr_Stock_Price:  104.71959793592723
curr_Factors:  [104.71959794]
mat_Sqrt:  [[0.15]]
grads:  [0.06930563]
Stock Position:  0.06930563123520284
Bond Position:  [-13.59969768]


portfolio before change:  [-6.35252869]
curr_Stock_Price:  104.58052074704779
curr_Factors:  [104.58052075]
mat_Sqrt:  [[0.15]]
grads:  [0.0642648]
Stock Position:  0.06426480268277304
Bond Position:  [-13.07337522]


portfolio before change:  [-6.32798645]
curr_Stock_Price:  104.97512781445684
curr_Factors:  [104.97512781]
mat_Sqrt:  [[0.15]]
grads:  [0.20670025]
Stock Position:  0.20670024644603113
Bond Position:  [-28.02637124]


portfolio before change:  [-6.37955665]
curr_Stock_Price:  104.7341097453216
curr_Factors:  [104.73410975]
mat_Sqrt:  [[0.15]]
grads:  [0.01288119]
Stock Position:  0.012881186187913188
Bond Position:  [-7.72865622]


portfolio before change:  [-6.3784724]
curr_Stock_Price:  104.85578341437876
curr_Factors:  [104.85578341]
mat_Sqrt:  [[0.15]]
grads:  [-0.08280464]
Stock Position:  -0.08280464221363884
Bond Position:  [2.30407323]


portfolio before change:  [-6.42178431]
curr_Stock_Price:  105.38058393286578
curr_Factors:  [105.38058393]
mat_Sqrt:  [[0.15]]
grads:  [0.09785563]
Stock Position:  0.09785563460588621
Bond Position:  [-16.73386823]


portfolio before change:  [-6.36002399]
curr_Stock_Price:  106.02240927659349
curr_Factors:  [106.02240928]
mat_Sqrt:  [[0.15]]
grads:  [0.0502191]
Stock Position:  0.05021910172870637
Bond Position:  [-11.68437414]


portfolio before change:  [-6.36816092]
curr_Stock_Price:  105.87492292430704
curr_Factors:  [105.87492292]
mat_Sqrt:  [[0.15]]
grads:  [-0.03424713]
Stock Position:  -0.034247131565985245
Bond Position:  [-2.7422485]


portfolio before change:  [-6.34090744]
curr_Stock_Price:  105.07412955040795
curr_Factors:  [105.07412955]
mat_Sqrt:  [[0.15]]
grads:  [0.10272118]
Stock Position:  0.1027211844587614
Bond Position:  [-17.13424648]


portfolio before change:  [-6.3439591]
curr_Stock_Price:  105.05484682636877
curr_Factors:  [105.05484683]
mat_Sqrt:  [[0.15]]
grads:  [-0.06532251]
Stock Position:  -0.0653225082721722
Bond Position:  [0.518487]


portfolio before change:  [-6.39705909]
curr_Stock_Price:  105.86823250642114
curr_Factors:  [105.86823251]
mat_Sqrt:  [[0.15]]
grads:  [-0.13833072]
Stock Position:  -0.13833071617670792
Bond Position:  [8.24776933]


portfolio before change:  [-6.4909711]
curr_Stock_Price:  106.55085390686523
curr_Factors:  [106.55085391]
mat_Sqrt:  [[0.15]]
grads:  [-0.05810229]
Stock Position:  -0.058102288438638613
Bond Position:  [-0.30012265]


portfolio before change:  [-6.52314379]
curr_Stock_Price:  107.10425612968392
curr_Factors:  [107.10425613]
mat_Sqrt:  [[0.15]]
grads:  [0.10439647]
Stock Position:  0.10439646695464581
Bond Position:  [-17.70444973]


portfolio before change:  [-6.52393256]
curr_Stock_Price:  107.10730023722809
curr_Factors:  [107.10730024]
mat_Sqrt:  [[0.15]]
grads:  [-0.17023287]
Stock Position:  -0.17023286676921684
Bond Position:  [11.70925021]


portfolio before change:  [-6.35000502]
curr_Stock_Price:  106.08989570320774
curr_Factors:  [106.0898957]
mat_Sqrt:  [[0.15]]
grads:  [0.18532065]
Stock Position:  0.1853206538485068
Bond Position:  [-26.01065386]


portfolio before change:  [-6.43407723]
curr_Stock_Price:  105.64501009462175
curr_Factors:  [105.64501009]
mat_Sqrt:  [[0.15]]
grads:  [-0.17764603]
Stock Position:  -0.1776460271762916
Bond Position:  [12.33333911]


portfolio before change:  [-6.42975604]
curr_Stock_Price:  105.6250246882554
curr_Factors:  [105.62502469]
mat_Sqrt:  [[0.15]]
grads:  [0.01906938]
Stock Position:  0.01906937919624458
Bond Position:  [-8.44395969]


portfolio before change:  [-6.42902708]
curr_Stock_Price:  105.69092749141629
curr_Factors:  [105.69092749]
mat_Sqrt:  [[0.15]]
grads:  [0.02099244]
Stock Position:  0.020992443413124194
Bond Position:  [-8.64773789]


portfolio before change:  [-6.43309324]
curr_Stock_Price:  105.5229784517903
curr_Factors:  [105.52297845]
mat_Sqrt:  [[0.15]]
grads:  [-0.08349844]
Stock Position:  -0.08349843581679338
Bond Position:  [2.3779104]


portfolio before change:  [-6.42173856]
curr_Stock_Price:  105.38877174554726
curr_Factors:  [105.38877175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.42173856]
Stock Price:  105.19463191196016
PL:  [-11.61637048]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.88627330e-03]
 [ 1.95053410e-03]
 [-2.22682184e-03]
 [ 4.80162268e-03]
 [ 4.97720536e-03]
 [ 2.76997905e-02]
 [ 1.51382766e-03]
 [-1.57457942e-02]
 [ 2.33784221e-02]
 [-4.66245184e-03]
 [ 1.59252062e-02]
 [-4.50660551e-02]
 [ 1.39405873e-02]
 [ 6.55133303e-03]
 [-6.91465524e-03]
 [ 1.32180853e-02]
 [ 7.87021657e-03]
 [-1.20802719e-02]
 [ 2.99432621e-04]
 [-4.05471509e-03]
 [ 1.27298148e-02]
 [-5.92067941e-03]
 [ 1.10642696e-02]
 [-3.79106233e-02]
 [ 9.10404292e-03]
 [ 6.37665562e-03]
 [-4.59037405e-03]
 [ 1.80261500e-02]
 [ 4.62013055e-02]
 [ 8.88402967e-04]
 [ 1.49945720e-02]
 [-9.76886818e-03]
 [ 4.93719714e-03]
 [ 8.42965873e-03]
 [ 1.10886248e-02]
 [ 9.79713280e-03]
 [-3.41756991e-02]
 [ 9.71922316e-03]
 [-7.00531326e-03]
 [ 2.21796288e-02]
 [-6.35349050e-03]
 [-9.17458791e-03]
 [ 2.29953746e-02]
 [ 1.88817997e-03]
 [-6.49284133e-03]
 [-8.20393824e-03]
 [ 1.36338885e-02]
 [ 1.35627816e-03]
 [ 2.62110432e-03]
 [-7.38682987e-03]
 [-2.50077631e-03]
 [ 2.64657704e-03]
 [-8.58284104e-03]
 [ 5.68070502e-03]
 [-5.83879826e-03]
 [ 7.11405174e-03]
 [ 9.31100555e-03]
 [-3.84182891e-04]
 [ 1.60469609e-03]
 [ 1.47353070e-02]
 [ 1.78545550e-04]
 [-8.32354994e-03]
 [-6.20720294e-03]
 [-1.29890211e-02]
 [-4.47804189e-03]
 [-4.03958526e-04]
 [-5.48850560e-03]
 [ 2.02128237e-02]
 [-8.31990156e-03]
 [ 1.04978924e-02]
 [-1.11872662e-02]
 [ 1.12552936e-02]
 [-8.36766166e-03]
 [ 1.72534283e-02]
 [-2.24891694e-02]
 [-4.21914203e-03]
 [-9.91021427e-03]
 [-2.02021490e-03]
 [ 2.36831969e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.59374798]
curr_Stock_Price:  99.97087995274482
curr_Factors:  [99.97087995]
mat_Sqrt:  [[0.15]]
grads:  [0.01257516]
Stock Position:  0.012575155322704631
Bond Position:  [0.33659864]


portfolio before change:  [1.59334272]
curr_Stock_Price:  99.93697986349228
curr_Factors:  [99.93697986]
mat_Sqrt:  [[0.15]]
grads:  [0.01300356]
Stock Position:  0.013003560634017187
Bond Position:  [0.29380615]


portfolio before change:  [1.60085151]
curr_Stock_Price:  100.51300840493843
curr_Factors:  [100.5130084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01484548]
Stock Position:  -0.014845478916480227
Bond Position:  [3.09301526]


portfolio before change:  [1.59552479]
curr_Stock_Price:  100.88484107362714
curr_Factors:  [100.88484107]
mat_Sqrt:  [[0.15]]
grads:  [0.03201082]
Stock Position:  0.03201081784755695
Bond Position:  [-1.63388148]


portfolio before change:  [1.56852683]
curr_Stock_Price:  100.04463013508831
curr_Factors:  [100.04463014]
mat_Sqrt:  [[0.15]]
grads:  [0.03318137]
Stock Position:  0.03318136908013806
Bond Position:  [-1.75109096]


portfolio before change:  [1.58536142]
curr_Stock_Price:  100.55527917240342
curr_Factors:  [100.55527917]
mat_Sqrt:  [[0.15]]
grads:  [0.18466527]
Stock Position:  0.18466526985949192
Bond Position:  [-16.98370634]


portfolio before change:  [1.48621211]
curr_Stock_Price:  100.024113821037
curr_Factors:  [100.02411382]
mat_Sqrt:  [[0.15]]
grads:  [0.01009218]
Stock Position:  0.01009218440142682
Bond Position:  [0.47675031]


portfolio before change:  [1.48874926]
curr_Stock_Price:  100.27255800812614
curr_Factors:  [100.27255801]
mat_Sqrt:  [[0.15]]
grads:  [-0.10497196]
Stock Position:  -0.10497196130391724
Bond Position:  [12.01455634]


portfolio before change:  [1.48214822]
curr_Stock_Price:  100.34259549287722
curr_Factors:  [100.34259549]
mat_Sqrt:  [[0.15]]
grads:  [0.15585615]
Stock Position:  0.15585614747191412
Bond Position:  [-14.15686214]


portfolio before change:  [1.56560741]
curr_Stock_Price:  100.8837613741328
curr_Factors:  [100.88376137]
mat_Sqrt:  [[0.15]]
grads:  [-0.03108301]
Stock Position:  -0.031083012287885296
Bond Position:  [4.70137861]


portfolio before change:  [1.57399673]
curr_Stock_Price:  100.62331471570913
curr_Factors:  [100.62331472]
mat_Sqrt:  [[0.15]]
grads:  [0.10616804]
Stock Position:  0.10616804118068172
Bond Position:  [-9.10898349]


portfolio before change:  [1.64116918]
curr_Stock_Price:  101.26137665716028
curr_Factors:  [101.26137666]
mat_Sqrt:  [[0.15]]
grads:  [-0.30044037]
Stock Position:  -0.300440367482541
Bond Position:  [32.0641744]


portfolio before change:  [1.82080134]
curr_Stock_Price:  100.67015089501484
curr_Factors:  [100.6701509]
mat_Sqrt:  [[0.15]]
grads:  [0.09293725]
Stock Position:  0.09293724873414941
Bond Position:  [-7.53520551]


portfolio before change:  [1.75591982]
curr_Stock_Price:  99.97709661423558
curr_Factors:  [99.97709661]
mat_Sqrt:  [[0.15]]
grads:  [0.04367555]
Stock Position:  0.04367555355080371
Bond Position:  [-2.61063522]


portfolio before change:  [1.76639904]
curr_Stock_Price:  100.22076582878725
curr_Factors:  [100.22076583]
mat_Sqrt:  [[0.15]]
grads:  [-0.0460977]
Stock Position:  -0.04609770159769156
Bond Position:  [6.38634599]


portfolio before change:  [1.76582962]
curr_Stock_Price:  100.2417772909791
curr_Factors:  [100.24177729]
mat_Sqrt:  [[0.15]]
grads:  [0.08812057]
Stock Position:  0.08812056856633026
Bond Position:  [-7.06753279]


portfolio before change:  [1.76531932]
curr_Stock_Price:  100.24099925534499
curr_Factors:  [100.24099926]
mat_Sqrt:  [[0.15]]
grads:  [0.05246811]
Stock Position:  0.052468110495309
Bond Position:  [-3.4941365]


portfolio before change:  [1.77251769]
curr_Stock_Price:  100.3823567836227
curr_Factors:  [100.38235678]
mat_Sqrt:  [[0.15]]
grads:  [-0.08053515]
Stock Position:  -0.08053514617933788
Bond Position:  [9.85682547]


portfolio before change:  [1.69050172]
curr_Stock_Price:  101.40839380660096
curr_Factors:  [101.40839381]
mat_Sqrt:  [[0.15]]
grads:  [0.00199622]
Stock Position:  0.0019962174702641
Bond Position:  [1.48806852]


portfolio before change:  [1.69040726]
curr_Stock_Price:  101.3144821372678
curr_Factors:  [101.31448214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02703143]
Stock Position:  -0.02703143393257041
Bond Position:  [4.42908299]


portfolio before change:  [1.69118511]
curr_Stock_Price:  101.29594725525818
curr_Factors:  [101.29594726]
mat_Sqrt:  [[0.15]]
grads:  [0.08486543]
Stock Position:  0.08486543179502959
Bond Position:  [-6.90533919]


portfolio before change:  [1.77343246]
curr_Stock_Price:  102.27018304658881
curr_Factors:  [102.27018305]
mat_Sqrt:  [[0.15]]
grads:  [-0.0394712]
Stock Position:  -0.039471196075199604
Bond Position:  [5.8101589]


portfolio before change:  [1.74010545]
curr_Stock_Price:  103.12372081883102
curr_Factors:  [103.12372082]
mat_Sqrt:  [[0.15]]
grads:  [0.0737618]
Stock Position:  0.07376179720974171
Bond Position:  [-5.86648554]


portfolio before change:  [1.76554557]
curr_Stock_Price:  103.47358749234465
curr_Factors:  [103.47358749]
mat_Sqrt:  [[0.15]]
grads:  [-0.25273749]
Stock Position:  -0.25273748834501536
Bond Position:  [27.91720019]


portfolio before change:  [1.59434725]
curr_Stock_Price:  104.15786745402453
curr_Factors:  [104.15786745]
mat_Sqrt:  [[0.15]]
grads:  [0.06069362]
Stock Position:  0.06069361946279578
Bond Position:  [-4.72737072]


portfolio before change:  [1.60745267]
curr_Stock_Price:  104.378663076282
curr_Factors:  [104.37866308]
mat_Sqrt:  [[0.15]]
grads:  [0.04251104]
Stock Position:  0.042511037479041676
Bond Position:  [-2.82979259]


portfolio before change:  [1.59384356]
curr_Stock_Price:  104.06269228618355
curr_Factors:  [104.06269229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03060249]
Stock Position:  -0.03060249366166505
Bond Position:  [4.77842144]


portfolio before change:  [1.58160969]
curr_Stock_Price:  104.47221871214981
curr_Factors:  [104.47221871]
mat_Sqrt:  [[0.15]]
grads:  [0.12017433]
Stock Position:  0.12017433357070083
Bond Position:  [-10.97326957]


portfolio before change:  [1.44284328]
curr_Stock_Price:  103.32321662757376
curr_Factors:  [103.32321663]
mat_Sqrt:  [[0.15]]
grads:  [0.3080087]
Stock Position:  0.3080087032400845
Bond Position:  [-30.38160669]


portfolio before change:  [1.21629539]
curr_Stock_Price:  102.59385743185288
curr_Factors:  [102.59385743]
mat_Sqrt:  [[0.15]]
grads:  [0.00592269]
Stock Position:  0.005922686449372008
Bond Position:  [0.60866414]


portfolio before change:  [1.21619113]
curr_Stock_Price:  102.5698310084932
curr_Factors:  [102.56983101]
mat_Sqrt:  [[0.15]]
grads:  [0.09996381]
Stock Position:  0.09996381306876972
Bond Position:  [-9.03708029]


portfolio before change:  [1.21605086]
curr_Stock_Price:  102.57407819954554
curr_Factors:  [102.5740782]
mat_Sqrt:  [[0.15]]
grads:  [-0.06512579]
Stock Position:  -0.06512578786854224
Bond Position:  [7.89626852]


portfolio before change:  [1.22606447]
curr_Stock_Price:  102.42789828442746
curr_Factors:  [102.42789828]
mat_Sqrt:  [[0.15]]
grads:  [0.03291465]
Stock Position:  0.03291464756975098
Bond Position:  [-2.1453137]


portfolio before change:  [1.21957079]
curr_Stock_Price:  102.23468340853708
curr_Factors:  [102.23468341]
mat_Sqrt:  [[0.15]]
grads:  [0.05619772]
Stock Position:  0.05619772489545108
Bond Position:  [-4.52578583]


portfolio before change:  [1.19073859]
curr_Stock_Price:  101.72666769828919
curr_Factors:  [101.7266677]
mat_Sqrt:  [[0.15]]
grads:  [0.07392417]
Stock Position:  0.07392416500898646
Bond Position:  [-6.32932038]


portfolio before change:  [1.11255475]
curr_Stock_Price:  100.67439690098541
curr_Factors:  [100.6743969]
mat_Sqrt:  [[0.15]]
grads:  [0.06531422]
Stock Position:  0.06531421869198477
Bond Position:  [-5.46291482]


portfolio before change:  [1.12149185]
curr_Stock_Price:  100.8164569378622
curr_Factors:  [100.81645694]
mat_Sqrt:  [[0.15]]
grads:  [-0.22783799]
Stock Position:  -0.22783799421676318
Bond Position:  [24.09131118]


portfolio before change:  [1.09510555]
curr_Stock_Price:  100.93887750366862
curr_Factors:  [100.9388775]
mat_Sqrt:  [[0.15]]
grads:  [0.06479482]
Stock Position:  0.06479482107350074
Bond Position:  [-5.44521096]


portfolio before change:  [1.04674915]
curr_Stock_Price:  100.19782964523668
curr_Factors:  [100.19782965]
mat_Sqrt:  [[0.15]]
grads:  [-0.04670209]
Stock Position:  -0.04670208840796327
Bond Position:  [5.72619705]


portfolio before change:  [1.03410003]
curr_Stock_Price:  100.47634012916149
curr_Factors:  [100.47634013]
mat_Sqrt:  [[0.15]]
grads:  [0.14786419]
Stock Position:  0.1478641917541335
Bond Position:  [-13.8227528]


portfolio before change:  [0.99903433]
curr_Stock_Price:  100.2450350026107
curr_Factors:  [100.245035]
mat_Sqrt:  [[0.15]]
grads:  [-0.0423566]
Stock Position:  -0.04235660330920945
Bond Position:  [5.24507351]


portfolio before change:  [1.01514075]
curr_Stock_Price:  99.87251726318311
curr_Factors:  [99.87251726]
mat_Sqrt:  [[0.15]]
grads:  [-0.06116392]
Stock Position:  -0.061163919404683666
Bond Position:  [7.12373534]


portfolio before change:  [0.95710653]
curr_Stock_Price:  100.82862777185564
curr_Factors:  [100.82862777]
mat_Sqrt:  [[0.15]]
grads:  [0.1533025]
Stock Position:  0.15330249710043575
Bond Position:  [-14.50017389]


portfolio before change:  [1.04073952]
curr_Stock_Price:  101.38008184256019
curr_Factors:  [101.38008184]
mat_Sqrt:  [[0.15]]
grads:  [0.01258787]
Stock Position:  0.012587866434462991
Bond Position:  [-0.2354194]


portfolio before change:  [1.04006504]
curr_Stock_Price:  101.32766841834113
curr_Factors:  [101.32766842]
mat_Sqrt:  [[0.15]]
grads:  [-0.04328561]
Stock Position:  -0.043285608887397777
Bond Position:  [5.42609486]


portfolio before change:  [1.01916116]
curr_Stock_Price:  101.81843246432797
curr_Factors:  [101.81843246]
mat_Sqrt:  [[0.15]]
grads:  [-0.05469292]
Stock Position:  -0.05469292163246203
Bond Position:  [6.58790871]


portfolio before change:  [0.99038489]
curr_Stock_Price:  102.35210343889307
curr_Factors:  [102.35210344]
mat_Sqrt:  [[0.15]]
grads:  [0.09089259]
Stock Position:  0.09089259012475678
Bond Position:  [-8.3126629]


portfolio before change:  [0.99934805]
curr_Stock_Price:  102.45643227593379
curr_Factors:  [102.45643228]
mat_Sqrt:  [[0.15]]
grads:  [0.00904185]
Stock Position:  0.009041854394605305
Bond Position:  [0.07295191]


portfolio before change:  [1.00451786]
curr_Stock_Price:  103.0276922347679
curr_Factors:  [103.02769223]
mat_Sqrt:  [[0.15]]
grads:  [0.01747403]
Stock Position:  0.01747402879203875
Bond Position:  [-0.795791]


portfolio before change:  [1.00797119]
curr_Stock_Price:  103.22816503635902
curr_Factors:  [103.22816504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04924553]
Stock Position:  -0.049245532472355705
Bond Position:  [6.09149714]


portfolio before change:  [0.93351445]
curr_Stock_Price:  104.74784536728812
curr_Factors:  [104.74784537]
mat_Sqrt:  [[0.15]]
grads:  [-0.01667184]
Stock Position:  -0.016671842073375725
Bond Position:  [2.67985399]


portfolio before change:  [0.95604036]
curr_Stock_Price:  103.4067573202865
curr_Factors:  [103.40675732]
mat_Sqrt:  [[0.15]]
grads:  [0.01764385]
Stock Position:  0.01764384692101466
Bond Position:  [-0.86845264]


portfolio before change:  [0.95183081]
curr_Stock_Price:  103.17124959066554
curr_Factors:  [103.17124959]
mat_Sqrt:  [[0.15]]
grads:  [-0.05721894]
Stock Position:  -0.05721894028009556
Bond Position:  [6.85518038]


portfolio before change:  [0.95724073]
curr_Stock_Price:  103.08419009246784
curr_Factors:  [103.08419009]
mat_Sqrt:  [[0.15]]
grads:  [0.03787137]
Stock Position:  0.03787136681031056
Bond Position:  [-2.94669845]


portfolio before change:  [0.95371686]
curr_Stock_Price:  102.99600487744834
curr_Factors:  [102.99600488]
mat_Sqrt:  [[0.15]]
grads:  [-0.03892532]
Stock Position:  -0.03892532174598021
Bond Position:  [4.96286949]


portfolio before change:  [0.94538775]
curr_Stock_Price:  103.21795034389318
curr_Factors:  [103.21795034]
mat_Sqrt:  [[0.15]]
grads:  [0.04742701]
Stock Position:  0.04742701156673711
Bond Position:  [-3.94993117]


portfolio before change:  [0.9086047]
curr_Stock_Price:  102.44758396774318
curr_Factors:  [102.44758397]
mat_Sqrt:  [[0.15]]
grads:  [0.06207337]
Stock Position:  0.062073370349438745
Bond Position:  [-5.45066212]


portfolio before change:  [0.91771864]
curr_Stock_Price:  102.5998976414777
curr_Factors:  [102.59989764]
mat_Sqrt:  [[0.15]]
grads:  [-0.00256122]
Stock Position:  -0.0025612192761001436
Bond Position:  [1.18049948]


portfolio before change:  [0.92053547]
curr_Stock_Price:  101.52890698448118
curr_Factors:  [101.52890698]
mat_Sqrt:  [[0.15]]
grads:  [0.01069797]
Stock Position:  0.010697973939840111
Bond Position:  [-0.16561813]


portfolio before change:  [0.92227915]
curr_Stock_Price:  101.69286671812506
curr_Factors:  [101.69286672]
mat_Sqrt:  [[0.15]]
grads:  [0.09823538]
Stock Position:  0.09823538005432564
Bond Position:  [-9.06755826]


portfolio before change:  [0.87699238]
curr_Stock_Price:  101.23763323142563
curr_Factors:  [101.23763323]
mat_Sqrt:  [[0.15]]
grads:  [0.0011903]
Stock Position:  0.0011903036694993429
Bond Position:  [0.75648885]


portfolio before change:  [0.87699544]
curr_Stock_Price:  101.2004801813636
curr_Factors:  [101.20048018]
mat_Sqrt:  [[0.15]]
grads:  [-0.05549033]
Stock Position:  -0.05549033295868769
Bond Position:  [6.49264378]


portfolio before change:  [0.87523906]
curr_Stock_Price:  101.23944524914873
curr_Factors:  [101.23944525]
mat_Sqrt:  [[0.15]]
grads:  [-0.04138135]
Stock Position:  -0.04138135291204578
Bond Position:  [5.06466427]


portfolio before change:  [0.87551732]
curr_Stock_Price:  101.24037040234614
curr_Factors:  [101.2403704]
mat_Sqrt:  [[0.15]]
grads:  [-0.08659347]
Stock Position:  -0.08659347416718323
Bond Position:  [9.64227272]


portfolio before change:  [0.86240083]
curr_Stock_Price:  101.39880217512754
curr_Factors:  [101.39880218]
mat_Sqrt:  [[0.15]]
grads:  [-0.02985361]
Stock Position:  -0.029853612577258326
Bond Position:  [3.88952138]


portfolio before change:  [0.861747]
curr_Stock_Price:  101.4288464455847
curr_Factors:  [101.42884645]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269306]
Stock Position:  -0.0026930568387249776
Bond Position:  [1.13490065]


portfolio before change:  [0.86352713]
curr_Stock_Price:  100.79417944695335
curr_Factors:  [100.79417945]
mat_Sqrt:  [[0.15]]
grads:  [-0.03659004]
Stock Position:  -0.03659003732635591
Bond Position:  [4.55158992]


portfolio before change:  [0.85756122]
curr_Stock_Price:  100.96500164890998
curr_Factors:  [100.96500165]
mat_Sqrt:  [[0.15]]
grads:  [0.13475216]
Stock Position:  0.1347521583304152
Bond Position:  [-12.74769067]


portfolio before change:  [0.95377995]
curr_Stock_Price:  101.68495662913024
curr_Factors:  [101.68495663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05546601]
Stock Position:  -0.055466010375962105
Bond Position:  [6.59383881]


portfolio before change:  [0.95759655]
curr_Stock_Price:  101.6235772344728
curr_Factors:  [101.62357723]
mat_Sqrt:  [[0.15]]
grads:  [0.06998595]
Stock Position:  0.06998594945612355
Bond Position:  [-6.15462599]


portfolio before change:  [0.9293861]
curr_Stock_Price:  101.22598643121496
curr_Factors:  [101.22598643]
mat_Sqrt:  [[0.15]]
grads:  [-0.07458177]
Stock Position:  -0.07458177485781874
Bond Position:  [8.47899983]


portfolio before change:  [0.93193891]
curr_Stock_Price:  101.1988637714005
curr_Factors:  [101.19886377]
mat_Sqrt:  [[0.15]]
grads:  [0.07503529]
Stock Position:  0.07503529097052083
Bond Position:  [-6.66154728]


portfolio before change:  [0.88612985]
curr_Stock_Price:  100.59391231666143
curr_Factors:  [100.59391232]
mat_Sqrt:  [[0.15]]
grads:  [-0.05578441]
Stock Position:  -0.05578441107173409
Bond Position:  [6.497702]


portfolio before change:  [0.87515195]
curr_Stock_Price:  100.79798389174647
curr_Factors:  [100.79798389]
mat_Sqrt:  [[0.15]]
grads:  [0.11502286]
Stock Position:  0.1150228552398396
Bond Position:  [-10.71891996]


portfolio before change:  [0.88183497]
curr_Stock_Price:  100.86191006844732
curr_Factors:  [100.86191007]
mat_Sqrt:  [[0.15]]
grads:  [-0.1499278]
Stock Position:  -0.1499277957474298
Bond Position:  [16.00383882]


portfolio before change:  [0.8503692]
curr_Stock_Price:  101.07845456092768
curr_Factors:  [101.07845456]
mat_Sqrt:  [[0.15]]
grads:  [-0.02812761]
Stock Position:  -0.0281276135644082
Bond Position:  [3.69346491]


portfolio before change:  [0.84460328]
curr_Stock_Price:  101.29165328354375
curr_Factors:  [101.29165328]
mat_Sqrt:  [[0.15]]
grads:  [-0.0660681]
Stock Position:  -0.06606809513234956
Bond Position:  [7.53674987]


portfolio before change:  [0.78838718]
curr_Stock_Price:  102.14966443484943
curr_Factors:  [102.14966443]
mat_Sqrt:  [[0.15]]
grads:  [-0.0134681]
Stock Position:  -0.013468099334283098
Bond Position:  [2.16414901]


portfolio before change:  [0.79009704]
curr_Stock_Price:  102.0327515593831
curr_Factors:  [102.03275156]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.79009704]
Stock Price:  102.7606380305942
PL:  [-1.97054099]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.70031474e-05]
 [ 2.98711977e-03]
 [-8.02492950e-04]
 [ 7.64967057e-03]
 [ 8.52208040e-04]
 [ 1.48101851e-02]
 [ 1.74040146e-03]
 [-2.59723380e-02]
 [-1.66891614e-02]
 [ 2.69973444e-02]
 [-1.05994377e-02]
 [ 2.49155800e-02]
 [-1.13996640e-02]
 [ 2.52525366e-03]
 [-6.99597548e-03]
 [ 9.32009040e-03]
 [ 7.23999939e-03]
 [-8.43106311e-03]
 [ 1.77317637e-03]
 [ 9.76743402e-03]
 [ 1.23583129e-02]
 [-9.39496152e-03]
 [ 7.31593673e-03]
 [ 2.74522488e-02]
 [-8.06268539e-03]
 [ 6.72001131e-03]
 [-6.91573840e-03]
 [ 6.18748382e-03]
 [-1.24927560e-02]
 [ 2.78777336e-04]
 [-4.43938953e-03]
 [-1.04276935e-02]
 [ 8.59123446e-04]
 [ 4.79955116e-03]
 [ 1.17616969e-02]
 [ 1.49985307e-02]
 [-3.52601234e-02]
 [ 9.47826214e-03]
 [-1.58516410e-02]
 [ 2.48252255e-02]
 [-4.86740244e-03]
 [ 3.41276964e-04]
 [ 2.30416925e-02]
 [ 4.15513246e-03]
 [-7.69222218e-03]
 [-4.50015868e-03]
 [ 5.72576322e-03]
 [-9.24106172e-03]
 [-9.05227932e-03]
 [-7.69495886e-03]
 [ 6.62130601e-03]
 [ 1.96624939e-03]
 [-8.29943069e-03]
 [ 5.71274502e-03]
 [-4.43560680e-03]
 [ 7.29046845e-03]
 [ 1.03517488e-02]
 [ 6.47532073e-06]
 [ 1.69743138e-03]
 [ 1.71238638e-02]
 [-1.79542976e-03]
 [ 1.89588096e-02]
 [ 3.47212653e-03]
 [-1.25244267e-02]
 [ 7.36972286e-03]
 [ 4.01435539e-03]
 [-5.22971984e-03]
 [ 1.52912508e-02]
 [-8.53853952e-03]
 [-4.15692369e-03]
 [-1.31339877e-02]
 [ 1.29087395e-02]
 [ 7.33108532e-04]
 [ 2.22835195e-02]
 [-2.24877876e-02]
 [-2.64009056e-04]
 [-9.04741022e-03]
 [-3.98200492e-03]
 [ 2.77272608e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.71368637]
curr_Stock_Price:  100.3688286949413
curr_Factors:  [100.36882869]
mat_Sqrt:  [[0.15]]
grads:  [0.00018002]
Stock Position:  0.00018002098256295353
Bond Position:  [7.69561788]


portfolio before change:  [7.71411955]
curr_Stock_Price:  100.10323356468834
curr_Factors:  [100.10323356]
mat_Sqrt:  [[0.15]]
grads:  [0.01991413]
Stock Position:  0.01991413179444786
Bond Position:  [5.72065057]


portfolio before change:  [7.70211727]
curr_Stock_Price:  99.48257732238993
curr_Factors:  [99.48257732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534995]
Stock Position:  -0.005349952999566839
Bond Position:  [8.23434439]


portfolio before change:  [7.70452015]
curr_Stock_Price:  99.12963783677691
curr_Factors:  [99.12963784]
mat_Sqrt:  [[0.15]]
grads:  [0.0509978]
Stock Position:  0.05099780377726809
Bond Position:  [2.64912633]


portfolio before change:  [7.70067261]
curr_Stock_Price:  99.05094606694304
curr_Factors:  [99.05094607]
mat_Sqrt:  [[0.15]]
grads:  [0.00568139]
Stock Position:  0.005681386935497357
Bond Position:  [7.13792586]


portfolio before change:  [7.69800637]
curr_Stock_Price:  98.50312607394609
curr_Factors:  [98.50312607]
mat_Sqrt:  [[0.15]]
grads:  [0.09873457]
Stock Position:  0.09873456712447465
Bond Position:  [-2.02765714]


portfolio before change:  [7.73052132]
curr_Stock_Price:  98.83372640070004
curr_Factors:  [98.8337264]
mat_Sqrt:  [[0.15]]
grads:  [0.01160268]
Stock Position:  0.011602676417297307
Bond Position:  [6.58378557]


portfolio before change:  [7.71833324]
curr_Stock_Price:  97.7478062987959
curr_Factors:  [97.7478063]
mat_Sqrt:  [[0.15]]
grads:  [-0.17314892]
Stock Position:  -0.1731489200819233
Bond Position:  [24.64326034]


portfolio before change:  [7.70377299]
curr_Stock_Price:  97.84079275443082
curr_Factors:  [97.84079275]
mat_Sqrt:  [[0.15]]
grads:  [-0.11126108]
Stock Position:  -0.11126107609768249
Bond Position:  [18.58964487]


portfolio before change:  [7.67365907]
curr_Stock_Price:  98.12189560278424
curr_Factors:  [98.1218956]
mat_Sqrt:  [[0.15]]
grads:  [0.1799823]
Stock Position:  0.17998229602340693
Bond Position:  [-9.98654499]


portfolio before change:  [7.71628804]
curr_Stock_Price:  98.36221450396148
curr_Factors:  [98.3622145]
mat_Sqrt:  [[0.15]]
grads:  [-0.07066292]
Stock Position:  -0.07066291800277374
Bond Position:  [14.66684914]


portfolio before change:  [7.72441672]
curr_Stock_Price:  98.2601528580445
curr_Factors:  [98.26015286]
mat_Sqrt:  [[0.15]]
grads:  [0.16610387]
Stock Position:  0.16610386642472647
Bond Position:  [-8.59697459]


portfolio before change:  [7.58512796]
curr_Stock_Price:  97.42482350006365
curr_Factors:  [97.4248235]
mat_Sqrt:  [[0.15]]
grads:  [-0.07599776]
Stock Position:  -0.07599776007361658
Bond Position:  [14.98919632]


portfolio before change:  [7.58261766]
curr_Stock_Price:  97.47018205928659
curr_Factors:  [97.47018206]
mat_Sqrt:  [[0.15]]
grads:  [0.01683502]
Stock Position:  0.01683502442913058
Bond Position:  [5.94170476]


portfolio before change:  [7.59338622]
curr_Stock_Price:  98.08777521003294
curr_Factors:  [98.08777521]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663984]
Stock Position:  -0.046639836536857084
Bond Position:  [12.16818403]


portfolio before change:  [7.53133694]
curr_Stock_Price:  99.43447421205637
curr_Factors:  [99.43447421]
mat_Sqrt:  [[0.15]]
grads:  [0.06213394]
Stock Position:  0.062133936002383636
Bond Position:  [1.35308168]


portfolio before change:  [7.50308013]
curr_Stock_Price:  98.97834063621782
curr_Factors:  [98.97834064]
mat_Sqrt:  [[0.15]]
grads:  [0.04826666]
Stock Position:  0.04826666257240186
Bond Position:  [2.72572596]


portfolio before change:  [7.46396585]
curr_Stock_Price:  98.16443213078983
curr_Factors:  [98.16443213]
mat_Sqrt:  [[0.15]]
grads:  [-0.05620709]
Stock Position:  -0.05620708743062003
Bond Position:  [12.98150267]


portfolio before change:  [7.47349565]
curr_Stock_Price:  98.00931953499101
curr_Factors:  [98.00931953]
mat_Sqrt:  [[0.15]]
grads:  [0.01182118]
Stock Position:  0.011821175798612978
Bond Position:  [6.31491025]


portfolio before change:  [7.47487064]
curr_Stock_Price:  98.09224723521297
curr_Factors:  [98.09224724]
mat_Sqrt:  [[0.15]]
grads:  [0.06511623]
Stock Position:  0.06511622681377174
Bond Position:  [1.08747362]


portfolio before change:  [7.46462389]
curr_Stock_Price:  97.93384237360996
curr_Factors:  [97.93384237]
mat_Sqrt:  [[0.15]]
grads:  [0.08238875]
Stock Position:  0.08238875235294613
Bond Position:  [-0.6040232]


portfolio before change:  [7.47862469]
curr_Stock_Price:  98.10423644536648
curr_Factors:  [98.10423645]
mat_Sqrt:  [[0.15]]
grads:  [-0.06263308]
Stock Position:  -0.06263307678615905
Bond Position:  [13.62319486]


portfolio before change:  [7.44937245]
curr_Stock_Price:  98.5848724710173
curr_Factors:  [98.58487247]
mat_Sqrt:  [[0.15]]
grads:  [0.04877291]
Stock Position:  0.04877291153786478
Bond Position:  [2.64110119]


portfolio before change:  [7.47916413]
curr_Stock_Price:  99.19231217894351
curr_Factors:  [99.19231218]
mat_Sqrt:  [[0.15]]
grads:  [0.18301499]
Stock Position:  0.1830149919275737
Bond Position:  [-10.67451608]


portfolio before change:  [7.42175797]
curr_Stock_Price:  98.8822885063617
curr_Factors:  [98.88228851]
mat_Sqrt:  [[0.15]]
grads:  [-0.05375124]
Stock Position:  -0.05375123590007904
Bond Position:  [12.73680319]


portfolio before change:  [7.38395528]
curr_Stock_Price:  99.60038850860559
curr_Factors:  [99.60038851]
mat_Sqrt:  [[0.15]]
grads:  [0.04480008]
Stock Position:  0.04480007543043898
Bond Position:  [2.92185036]


portfolio before change:  [7.37888483]
curr_Stock_Price:  99.48313253063715
curr_Factors:  [99.48313253]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610492]
Stock Position:  -0.04610492266319679
Bond Position:  [11.96554696]


portfolio before change:  [7.39631983]
curr_Stock_Price:  99.121194308448
curr_Factors:  [99.12119431]
mat_Sqrt:  [[0.15]]
grads:  [0.04124989]
Stock Position:  0.041249892126494846
Bond Position:  [3.30758126]


portfolio before change:  [7.39278356]
curr_Stock_Price:  99.03045466866801
curr_Factors:  [99.03045467]
mat_Sqrt:  [[0.15]]
grads:  [-0.08328504]
Stock Position:  -0.08328504025832682
Bond Position:  [15.64053897]


portfolio before change:  [7.46144268]
curr_Stock_Price:  98.21780509339122
curr_Factors:  [98.21780509]
mat_Sqrt:  [[0.15]]
grads:  [0.00185852]
Stock Position:  0.0018585155726266993
Bond Position:  [7.27890336]


portfolio before change:  [7.46269032]
curr_Stock_Price:  98.64432397858995
curr_Factors:  [98.64432398]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959593]
Stock Position:  -0.02959593020803927
Bond Position:  [10.38216084]


portfolio before change:  [7.44594664]
curr_Stock_Price:  99.23199183717401
curr_Factors:  [99.23199184]
mat_Sqrt:  [[0.15]]
grads:  [-0.06951796]
Stock Position:  -0.06951795637760087
Bond Position:  [14.34435192]


portfolio before change:  [7.41041627]
curr_Stock_Price:  99.75598489738728
curr_Factors:  [99.7559849]
mat_Sqrt:  [[0.15]]
grads:  [0.00572749]
Stock Position:  0.0057274896412100405
Bond Position:  [6.8390649]


portfolio before change:  [7.41141143]
curr_Stock_Price:  99.85510526942895
curr_Factors:  [99.85510527]
mat_Sqrt:  [[0.15]]
grads:  [0.03199701]
Stock Position:  0.03199700774973198
Bond Position:  [4.21634686]


portfolio before change:  [7.41078511]
curr_Stock_Price:  99.82729478749847
curr_Factors:  [99.82729479]
mat_Sqrt:  [[0.15]]
grads:  [0.07841131]
Stock Position:  0.0784113127409143
Bond Position:  [-0.41680412]


portfolio before change:  [7.3456177]
curr_Stock_Price:  98.99652995008313
curr_Factors:  [98.99652995]
mat_Sqrt:  [[0.15]]
grads:  [0.0999902]
Stock Position:  0.09999020459159069
Bond Position:  [-2.55306558]


portfolio before change:  [7.39878618]
curr_Stock_Price:  99.52986276394702
curr_Factors:  [99.52986276]
mat_Sqrt:  [[0.15]]
grads:  [-0.23506749]
Stock Position:  -0.2350674893761452
Bond Position:  [30.79502114]


portfolio before change:  [7.4185741]
curr_Stock_Price:  99.45387111240052
curr_Factors:  [99.45387111]
mat_Sqrt:  [[0.15]]
grads:  [0.06318841]
Stock Position:  0.06318841423733976
Bond Position:  [1.13424169]


portfolio before change:  [7.3846126]
curr_Stock_Price:  98.91528514936662
curr_Factors:  [98.91528515]
mat_Sqrt:  [[0.15]]
grads:  [-0.10567761]
Stock Position:  -0.10567760695722614
Bond Position:  [17.83774323]


portfolio before change:  [7.29247477]
curr_Stock_Price:  99.79771163834188
curr_Factors:  [99.79771164]
mat_Sqrt:  [[0.15]]
grads:  [0.1655015]
Stock Position:  0.1655015035942534
Bond Position:  [-9.22419656]


portfolio before change:  [7.12766975]
curr_Stock_Price:  98.80540348075938
curr_Factors:  [98.80540348]
mat_Sqrt:  [[0.15]]
grads:  [-0.03244935]
Stock Position:  -0.03244934962983274
Bond Position:  [10.33384083]


portfolio before change:  [7.11883673]
curr_Stock_Price:  99.09751739667509
curr_Factors:  [99.0975174]
mat_Sqrt:  [[0.15]]
grads:  [0.00227518]
Stock Position:  0.0022751797613786615
Bond Position:  [6.89337206]


portfolio before change:  [7.11805498]
curr_Stock_Price:  98.56455044197122
curr_Factors:  [98.56455044]
mat_Sqrt:  [[0.15]]
grads:  [0.15361128]
Stock Position:  0.15361128346510403
Bond Position:  [-8.02257211]


portfolio before change:  [7.24676273]
curr_Stock_Price:  99.40569421249181
curr_Factors:  [99.40569421]
mat_Sqrt:  [[0.15]]
grads:  [0.02770088]
Stock Position:  0.027700883055395583
Bond Position:  [4.49313722]


portfolio before change:  [7.23750377]
curr_Stock_Price:  99.06130826758672
curr_Factors:  [99.06130827]
mat_Sqrt:  [[0.15]]
grads:  [-0.05128148]
Stock Position:  -0.05128148119347648
Bond Position:  [12.31751438]


portfolio before change:  [7.20981354]
curr_Stock_Price:  99.61628624761744
curr_Factors:  [99.61628625]
mat_Sqrt:  [[0.15]]
grads:  [-0.03000106]
Stock Position:  -0.030001057839013832
Bond Position:  [10.19840751]


portfolio before change:  [7.19698081]
curr_Stock_Price:  100.0652756005001
curr_Factors:  [100.0652756]
mat_Sqrt:  [[0.15]]
grads:  [0.03817175]
Stock Position:  0.038171754783832085
Bond Position:  [3.37731364]


portfolio before change:  [7.21994886]
curr_Stock_Price:  100.66144840449307
curr_Factors:  [100.6614484]
mat_Sqrt:  [[0.15]]
grads:  [-0.06160708]
Stock Position:  -0.06160707811895009
Bond Position:  [13.42140657]


portfolio before change:  [7.18605387]
curr_Stock_Price:  101.22524477351394
curr_Factors:  [101.22524477]
mat_Sqrt:  [[0.15]]
grads:  [-0.06034853]
Stock Position:  -0.06034852876748632
Bond Position:  [13.29484847]


portfolio before change:  [7.20751103]
curr_Stock_Price:  100.88346010159944
curr_Factors:  [100.8834601]
mat_Sqrt:  [[0.15]]
grads:  [-0.05129973]
Stock Position:  -0.051299725751867926
Bond Position:  [12.38280487]


portfolio before change:  [7.18994707]
curr_Stock_Price:  101.24092621211958
curr_Factors:  [101.24092621]
mat_Sqrt:  [[0.15]]
grads:  [0.04414204]
Stock Position:  0.04414204007230597
Bond Position:  [2.72096605]


portfolio before change:  [7.23550909]
curr_Stock_Price:  102.26924209092194
curr_Factors:  [102.26924209]
mat_Sqrt:  [[0.15]]
grads:  [0.01310833]
Stock Position:  0.013108329254406838
Bond Position:  [5.8949302]


portfolio before change:  [7.2437525]
curr_Stock_Price:  102.87000196523775
curr_Factors:  [102.87000197]
mat_Sqrt:  [[0.15]]
grads:  [-0.05532954]
Stock Position:  -0.05532953792207053
Bond Position:  [12.93550217]


portfolio before change:  [7.22322852]
curr_Stock_Price:  103.25555496987486
curr_Factors:  [103.25555497]
mat_Sqrt:  [[0.15]]
grads:  [0.03808497]
Stock Position:  0.038084966801876466
Bond Position:  [3.29074414]


portfolio before change:  [7.20464634]
curr_Stock_Price:  102.76224078195678
curr_Factors:  [102.76224078]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957071]
Stock Position:  -0.029570711997253647
Bond Position:  [10.24339897]


portfolio before change:  [7.19102512]
curr_Stock_Price:  103.24452394619227
curr_Factors:  [103.24452395]
mat_Sqrt:  [[0.15]]
grads:  [0.04860312]
Stock Position:  0.04860312301190538
Bond Position:  [2.17301882]


portfolio before change:  [7.21648589]
curr_Stock_Price:  103.76558005413736
curr_Factors:  [103.76558005]
mat_Sqrt:  [[0.15]]
grads:  [0.06901166]
Stock Position:  0.069011658474665
Bond Position:  [0.05545112]


portfolio before change:  [7.18429345]
curr_Stock_Price:  103.29905146697602
curr_Factors:  [103.29905147]
mat_Sqrt:  [[0.15]]
grads:  [4.31688049e-05]
Stock Position:  4.3168804872772134e-05
Bond Position:  [7.17983415]


portfolio before change:  [7.18472718]
curr_Stock_Price:  102.95103180772527
curr_Factors:  [102.95103181]
mat_Sqrt:  [[0.15]]
grads:  [0.01131621]
Stock Position:  0.011316209200528013
Bond Position:  [6.01971176]


portfolio before change:  [7.18926841]
curr_Stock_Price:  103.31908719694633
curr_Factors:  [103.3190872]
mat_Sqrt:  [[0.15]]
grads:  [0.11415909]
Stock Position:  0.11415909179669455
Bond Position:  [-4.60554475]


portfolio before change:  [7.14379624]
curr_Stock_Price:  102.92328587332285
curr_Factors:  [102.92328587]
mat_Sqrt:  [[0.15]]
grads:  [-0.01196953]
Stock Position:  -0.01196953172676205
Bond Position:  [8.37573977]


portfolio before change:  [7.13746362]
curr_Stock_Price:  103.49608358794967
curr_Factors:  [103.49608359]
mat_Sqrt:  [[0.15]]
grads:  [0.12639206]
Stock Position:  0.12639206422766439
Bond Position:  [-5.94362003]


portfolio before change:  [7.21506347]
curr_Stock_Price:  104.11298417882561
curr_Factors:  [104.11298418]
mat_Sqrt:  [[0.15]]
grads:  [0.02314751]
Stock Position:  0.02314751021833695
Bond Position:  [4.8051071]


portfolio before change:  [7.20846791]
curr_Stock_Price:  103.8150735183325
curr_Factors:  [103.81507352]
mat_Sqrt:  [[0.15]]
grads:  [-0.08349618]
Stock Position:  -0.08349617775344984
Bond Position:  [15.87662974]


portfolio before change:  [7.21441]
curr_Stock_Price:  103.75579205153645
curr_Factors:  [103.75579205]
mat_Sqrt:  [[0.15]]
grads:  [0.04913149]
Stock Position:  0.04913148573731979
Bond Position:  [2.11673379]


portfolio before change:  [7.24394848]
curr_Stock_Price:  104.35431211581452
curr_Factors:  [104.35431212]
mat_Sqrt:  [[0.15]]
grads:  [0.02676237]
Stock Position:  0.026762369235051067
Bond Position:  [4.45117985]


portfolio before change:  [7.26383922]
curr_Stock_Price:  105.08715207794165
curr_Factors:  [105.08715208]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348648]
Stock Position:  -0.0348647989439116
Bond Position:  [10.92768165]


portfolio before change:  [7.29814935]
curr_Stock_Price:  104.12265118226661
curr_Factors:  [104.12265118]
mat_Sqrt:  [[0.15]]
grads:  [0.10194167]
Stock Position:  0.10194167198189567
Bond Position:  [-3.3162878]


portfolio before change:  [7.33175849]
curr_Stock_Price:  104.45437427358019
curr_Factors:  [104.45437427]
mat_Sqrt:  [[0.15]]
grads:  [-0.0569236]
Stock Position:  -0.056923596820485624
Bond Position:  [13.27767717]


portfolio before change:  [7.33996575]
curr_Stock_Price:  104.32477288172599
curr_Factors:  [104.32477288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02771282]
Stock Position:  -0.02771282463137984
Bond Position:  [10.23109988]


portfolio before change:  [7.35687108]
curr_Stock_Price:  103.73782920272619
curr_Factors:  [103.7378292]
mat_Sqrt:  [[0.15]]
grads:  [-0.08755992]
Stock Position:  -0.08755991773297012
Bond Position:  [16.44014687]


portfolio before change:  [7.38197082]
curr_Stock_Price:  103.46290661322223
curr_Factors:  [103.46290661]
mat_Sqrt:  [[0.15]]
grads:  [0.08605826]
Stock Position:  0.08605826345543964
Bond Position:  [-1.52186726]


portfolio before change:  [7.30495369]
curr_Stock_Price:  102.56907027525862
curr_Factors:  [102.56907028]
mat_Sqrt:  [[0.15]]
grads:  [0.00488739]
Stock Position:  0.004887390214864711
Bond Position:  [6.80365862]


portfolio before change:  [7.30725033]
curr_Stock_Price:  102.95197377342016
curr_Factors:  [102.95197377]
mat_Sqrt:  [[0.15]]
grads:  [0.1485568]
Stock Position:  0.14855679646260886
Bond Position:  [-7.98696508]


portfolio before change:  [7.31888082]
curr_Stock_Price:  103.03362390142759
curr_Factors:  [103.0336239]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991858]
Stock Position:  -0.14991858421257442
Bond Position:  [22.76553584]


portfolio before change:  [7.24043067]
curr_Stock_Price:  103.5664000049199
curr_Factors:  [103.5664]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176006]
Stock Position:  -0.0017600603765967108
Bond Position:  [7.42271378]


portfolio before change:  [7.24217543]
curr_Stock_Price:  102.83868191162716
curr_Factors:  [102.83868191]
mat_Sqrt:  [[0.15]]
grads:  [-0.06031607]
Stock Position:  -0.06031606811731191
Bond Position:  [13.44500037]


portfolio before change:  [7.24178022]
curr_Stock_Price:  102.85916650945148
curr_Factors:  [102.85916651]
mat_Sqrt:  [[0.15]]
grads:  [-0.0265467]
Stock Position:  -0.026546699480776148
Bond Position:  [9.9723516]


portfolio before change:  [7.25555309]
curr_Stock_Price:  102.3638288093169
curr_Factors:  [102.36382881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.25555309]
Stock Price:  103.24711250714589
PL:  [4.00844058]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.34426190e-03]
 [ 2.99265411e-03]
 [ 3.31393714e-04]
 [ 8.50697424e-03]
 [-2.56473739e-04]
 [ 1.53969867e-02]
 [ 1.24436983e-03]
 [-1.88976174e-02]
 [-4.18938918e-03]
 [ 2.69462044e-02]
 [-1.52104020e-02]
 [ 2.29092190e-02]
 [-1.42265765e-02]
 [ 8.78706455e-03]
 [-6.97728722e-03]
 [ 7.50694584e-03]
 [ 1.04657790e-02]
 [-4.51130894e-03]
 [ 1.41120730e-03]
 [ 8.20140188e-03]
 [ 1.26777533e-02]
 [-9.66899080e-03]
 [ 6.70104725e-03]
 [-7.54308845e-03]
 [-1.09512908e-02]
 [-3.20722744e-03]
 [-7.54535035e-04]
 [ 1.04508826e-02]
 [-3.27037508e-02]
 [ 2.32304904e-03]
 [ 2.37019943e-03]
 [-1.00501824e-02]
 [-8.15599377e-03]
 [ 5.64322363e-03]
 [ 1.37731189e-02]
 [ 1.02111467e-02]
 [-3.39027483e-02]
 [ 8.21853289e-03]
 [-2.65016743e-02]
 [ 1.52791324e-02]
 [-6.25636370e-03]
 [ 4.26107167e-03]
 [ 2.30245981e-02]
 [ 4.62579081e-03]
 [-4.57585341e-03]
 [-2.88924062e-03]
 [ 1.80766191e-03]
 [-1.19334036e-02]
 [-3.07324210e-03]
 [-4.09878445e-03]
 [ 4.72459663e-02]
 [-9.71782255e-03]
 [ 3.39262968e-03]
 [ 5.28891873e-03]
 [ 5.23198535e-03]
 [-1.61227163e-03]
 [ 8.13572208e-03]
 [-3.97304564e-04]
 [ 1.53273402e-03]
 [-1.54112034e-03]
 [ 4.50783411e-05]
 [ 4.77117409e-03]
 [ 1.35189153e-02]
 [-1.81416306e-02]
 [-9.88258842e-03]
 [-8.99147258e-03]
 [-4.81510179e-03]
 [ 1.93479763e-02]
 [-9.41898229e-03]
 [ 6.10429016e-03]
 [-8.20104885e-03]
 [ 1.07405049e-02]
 [-4.89089887e-03]
 [ 1.36028141e-02]
 [-2.20305646e-02]
 [-4.27272345e-03]
 [-8.36456269e-03]
 [-2.16174021e-03]
 [-2.93350443e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.60642688]
curr_Stock_Price:  100.03672935612538
curr_Factors:  [100.03672936]
mat_Sqrt:  [[0.15]]
grads:  [0.00896175]
Stock Position:  0.00896174599727148
Bond Position:  [1.70992312]


portfolio before change:  [2.60717661]
curr_Stock_Price:  100.10846322515752
curr_Factors:  [100.10846323]
mat_Sqrt:  [[0.15]]
grads:  [0.01995103]
Stock Position:  0.019951027381806746
Bond Position:  [0.60990992]


portfolio before change:  [2.60574785]
curr_Stock_Price:  100.03493888099428
curr_Factors:  [100.03493888]
mat_Sqrt:  [[0.15]]
grads:  [0.00220929]
Stock Position:  0.002209291429919452
Bond Position:  [2.38474151]


portfolio before change:  [2.60494139]
curr_Stock_Price:  99.60244384017022
curr_Factors:  [99.60244384]
mat_Sqrt:  [[0.15]]
grads:  [0.05671316]
Stock Position:  0.056713161584440466
Bond Position:  [-3.0438281]


portfolio before change:  [2.56500514]
curr_Stock_Price:  98.90161879300749
curr_Factors:  [98.90161879]
mat_Sqrt:  [[0.15]]
grads:  [-0.00170982]
Stock Position:  -0.0017098249272326873
Bond Position:  [2.73410959]


portfolio before change:  [2.56569761]
curr_Stock_Price:  98.59656677859208
curr_Factors:  [98.59656678]
mat_Sqrt:  [[0.15]]
grads:  [0.10264658]
Stock Position:  0.10264657791855185
Bond Position:  [-7.55490256]


portfolio before change:  [2.6234987]
curr_Stock_Price:  99.16427476236987
curr_Factors:  [99.16427476]
mat_Sqrt:  [[0.15]]
grads:  [0.0082958]
Stock Position:  0.008295798883787247
Bond Position:  [1.80085182]


portfolio before change:  [2.62150243]
curr_Stock_Price:  98.91007121831586
curr_Factors:  [98.91007122]
mat_Sqrt:  [[0.15]]
grads:  [-0.12598412]
Stock Position:  -0.1259841158065332
Bond Position:  [15.0826003]


portfolio before change:  [2.68323312]
curr_Stock_Price:  98.42756602002963
curr_Factors:  [98.42756602]
mat_Sqrt:  [[0.15]]
grads:  [-0.02792926]
Stock Position:  -0.027929261180541905
Bond Position:  [5.43224231]


portfolio before change:  [2.69193933]
curr_Stock_Price:  98.1279988697461
curr_Factors:  [98.12799887]
mat_Sqrt:  [[0.15]]
grads:  [0.17964136]
Stock Position:  0.17964136272000994
Bond Position:  [-14.93590811]


portfolio before change:  [2.71479341]
curr_Stock_Price:  98.26041603456447
curr_Factors:  [98.26041603]
mat_Sqrt:  [[0.15]]
grads:  [-0.10140268]
Stock Position:  -0.10140267995063441
Bond Position:  [12.67866293]


portfolio before change:  [2.68928676]
curr_Stock_Price:  98.5197690065842
curr_Factors:  [98.51976901]
mat_Sqrt:  [[0.15]]
grads:  [0.15272813]
Stock Position:  0.15272812663168225
Bond Position:  [-12.35745299]


portfolio before change:  [2.71152363]
curr_Stock_Price:  98.67042387879258
curr_Factors:  [98.67042388]
mat_Sqrt:  [[0.15]]
grads:  [-0.09484384]
Stock Position:  -0.0948438434751568
Bond Position:  [12.06980587]


portfolio before change:  [2.68480625]
curr_Stock_Price:  98.96007647819124
curr_Factors:  [98.96007648]
mat_Sqrt:  [[0.15]]
grads:  [0.05858043]
Stock Position:  0.05858043031553751
Bond Position:  [-3.11231761]


portfolio before change:  [2.65462873]
curr_Stock_Price:  98.44825030281284
curr_Factors:  [98.4482503]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651525]
Stock Position:  -0.046515248101853736
Bond Position:  [7.23397352]


portfolio before change:  [2.6590097]
curr_Stock_Price:  98.36378705654217
curr_Factors:  [98.36378706]
mat_Sqrt:  [[0.15]]
grads:  [0.05004631]
Stock Position:  0.050046305596873474
Bond Position:  [-2.26373445]


portfolio before change:  [2.62696617]
curr_Stock_Price:  97.72633669816699
curr_Factors:  [97.7263367]
mat_Sqrt:  [[0.15]]
grads:  [0.06977186]
Stock Position:  0.06977185990627462
Bond Position:  [-4.1915821]


portfolio before change:  [2.6312543]
curr_Stock_Price:  97.79155084073876
curr_Factors:  [97.79155084]
mat_Sqrt:  [[0.15]]
grads:  [-0.03007539]
Stock Position:  -0.030075392914394036
Bond Position:  [5.57237362]


portfolio before change:  [2.65992824]
curr_Stock_Price:  96.8497294752417
curr_Factors:  [96.84972948]
mat_Sqrt:  [[0.15]]
grads:  [0.00940805]
Stock Position:  0.00940804869136187
Bond Position:  [1.74876126]


portfolio before change:  [2.66292663]
curr_Stock_Price:  97.15681650826745
curr_Factors:  [97.15681651]
mat_Sqrt:  [[0.15]]
grads:  [0.05467601]
Stock Position:  0.05467601254664313
Bond Position:  [-2.64922069]


portfolio before change:  [2.66827992]
curr_Stock_Price:  97.25775437758932
curr_Factors:  [97.25775438]
mat_Sqrt:  [[0.15]]
grads:  [0.08451836]
Stock Position:  0.08451835553754947
Bond Position:  [-5.55178554]


portfolio before change:  [2.71338744]
curr_Stock_Price:  97.79556079358865
curr_Factors:  [97.79556079]
mat_Sqrt:  [[0.15]]
grads:  [-0.06445994]
Stock Position:  -0.06445993865042836
Bond Position:  [9.01728329]


portfolio before change:  [2.68105688]
curr_Stock_Price:  98.30586475767448
curr_Factors:  [98.30586476]
mat_Sqrt:  [[0.15]]
grads:  [0.04467365]
Stock Position:  0.0446736483378426
Bond Position:  [-1.71062475]


portfolio before change:  [2.65599673]
curr_Stock_Price:  97.74729758970402
curr_Factors:  [97.74729759]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028726]
Stock Position:  -0.05028725630883922
Bond Position:  [7.57144013]


portfolio before change:  [2.69727331]
curr_Stock_Price:  96.93589217876885
curr_Factors:  [96.93589218]
mat_Sqrt:  [[0.15]]
grads:  [-0.07300861]
Stock Position:  -0.07300860558055831
Bond Position:  [9.77442763]


portfolio before change:  [2.72610735]
curr_Stock_Price:  96.54931962083734
curr_Factors:  [96.54931962]
mat_Sqrt:  [[0.15]]
grads:  [-0.02138152]
Stock Position:  -0.021381516242267216
Bond Position:  [4.7904782]


portfolio before change:  [2.72022634]
curr_Stock_Price:  96.83837436761024
curr_Factors:  [96.83837437]
mat_Sqrt:  [[0.15]]
grads:  [-0.00503023]
Stock Position:  -0.005030233566753681
Bond Position:  [3.20734598]


portfolio before change:  [2.7214426]
curr_Stock_Price:  96.63643692640926
curr_Factors:  [96.63643693]
mat_Sqrt:  [[0.15]]
grads:  [0.06967255]
Stock Position:  0.06967255045919679
Bond Position:  [-4.01146443]


portfolio before change:  [2.7463207]
curr_Stock_Price:  96.99710742307519
curr_Factors:  [96.99710742]
mat_Sqrt:  [[0.15]]
grads:  [-0.21802501]
Stock Position:  -0.21802500502485583
Bond Position:  [23.89411554]


portfolio before change:  [2.68676104]
curr_Stock_Price:  97.27713534596646
curr_Factors:  [97.27713535]
mat_Sqrt:  [[0.15]]
grads:  [0.01548699]
Stock Position:  0.015486993596291056
Bond Position:  [1.18023067]


portfolio before change:  [2.68892056]
curr_Stock_Price:  97.41181276099368
curr_Factors:  [97.41181276]
mat_Sqrt:  [[0.15]]
grads:  [0.01580133]
Stock Position:  0.015801329538932027
Bond Position:  [1.1496844]


portfolio before change:  [2.68375408]
curr_Stock_Price:  97.08030025182694
curr_Factors:  [97.08030025]
mat_Sqrt:  [[0.15]]
grads:  [-0.06700122]
Stock Position:  -0.06700121624478894
Bond Position:  [9.18825227]


portfolio before change:  [2.69032483]
curr_Stock_Price:  96.99080231449399
curr_Factors:  [96.99080231]
mat_Sqrt:  [[0.15]]
grads:  [-0.05437329]
Stock Position:  -0.054373291786903255
Bond Position:  [7.96403403]


portfolio before change:  [2.69624961]
curr_Stock_Price:  96.8909920568908
curr_Factors:  [96.89099206]
mat_Sqrt:  [[0.15]]
grads:  [0.03762149]
Stock Position:  0.037621490840354606
Bond Position:  [-0.94893396]


portfolio before change:  [2.68457178]
curr_Stock_Price:  96.58216524986025
curr_Factors:  [96.58216525]
mat_Sqrt:  [[0.15]]
grads:  [0.09182079]
Stock Position:  0.09182079270357543
Bond Position:  [-6.1836792]


portfolio before change:  [2.68464057]
curr_Stock_Price:  96.58712363545067
curr_Factors:  [96.58712364]
mat_Sqrt:  [[0.15]]
grads:  [0.06807431]
Stock Position:  0.06807431112738473
Bond Position:  [-3.89046134]


portfolio before change:  [2.69887254]
curr_Stock_Price:  96.79976085833123
curr_Factors:  [96.79976086]
mat_Sqrt:  [[0.15]]
grads:  [-0.22601832]
Stock Position:  -0.22601832225174087
Bond Position:  [24.57739208]


portfolio before change:  [2.77883113]
curr_Stock_Price:  96.45278696083477
curr_Factors:  [96.45278696]
mat_Sqrt:  [[0.15]]
grads:  [0.05479022]
Stock Position:  0.05479021929120087
Bond Position:  [-2.50583822]


portfolio before change:  [2.82702665]
curr_Stock_Price:  97.33528268022764
curr_Factors:  [97.33528268]
mat_Sqrt:  [[0.15]]
grads:  [-0.17667783]
Stock Position:  -0.17667782890216147
Bond Position:  [20.02401307]


portfolio before change:  [2.87028695]
curr_Stock_Price:  97.09751225050192
curr_Factors:  [97.09751225]
mat_Sqrt:  [[0.15]]
grads:  [0.10186088]
Stock Position:  0.10186088286606305
Bond Position:  [-7.02015137]


portfolio before change:  [2.98314392]
curr_Stock_Price:  98.20977186824224
curr_Factors:  [98.20977187]
mat_Sqrt:  [[0.15]]
grads:  [-0.04170909]
Stock Position:  -0.04170909131861024
Bond Position:  [7.07938427]


portfolio before change:  [2.96576477]
curr_Stock_Price:  98.63705598391874
curr_Factors:  [98.63705598]
mat_Sqrt:  [[0.15]]
grads:  [0.02840714]
Stock Position:  0.02840714444545256
Bond Position:  [0.16376767]


portfolio before change:  [2.97231346]
curr_Stock_Price:  98.86722543154791
curr_Factors:  [98.86722543]
mat_Sqrt:  [[0.15]]
grads:  [0.15349732]
Stock Position:  0.15349732062757787
Bond Position:  [-12.20354074]


portfolio before change:  [2.89463083]
curr_Stock_Price:  98.36610996757487
curr_Factors:  [98.36610997]
mat_Sqrt:  [[0.15]]
grads:  [0.03083861]
Stock Position:  0.030838605392314866
Bond Position:  [-0.13884282]


portfolio before change:  [2.89507855]
curr_Stock_Price:  98.38090946176227
curr_Factors:  [98.38090946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03050569]
Stock Position:  -0.030505689378713716
Bond Position:  [5.89625602]


portfolio before change:  [2.90216035]
curr_Stock_Price:  98.1608431347386
curr_Factors:  [98.16084313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192616]
Stock Position:  -0.019261604153940303
Bond Position:  [4.79289566]


portfolio before change:  [2.91669944]
curr_Stock_Price:  97.42157355031448
curr_Factors:  [97.42157355]
mat_Sqrt:  [[0.15]]
grads:  [0.01205108]
Stock Position:  0.012051079416025949
Bond Position:  [1.74266432]


portfolio before change:  [2.91500833]
curr_Stock_Price:  97.27220713068425
curr_Factors:  [97.27220713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07955602]
Stock Position:  -0.07955602410906577
Bond Position:  [10.65359839]


portfolio before change:  [2.9167002]
curr_Stock_Price:  97.25931056610145
curr_Factors:  [97.25931057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048828]
Stock Position:  -0.020488280649190244
Bond Position:  [4.90937625]


portfolio before change:  [2.89222815]
curr_Stock_Price:  98.46872838587716
curr_Factors:  [98.46872839]
mat_Sqrt:  [[0.15]]
grads:  [-0.02732523]
Stock Position:  -0.027325229658112123
Bond Position:  [5.58290877]


portfolio before change:  [2.8856958]
curr_Stock_Price:  98.72055794165547
curr_Factors:  [98.72055794]
mat_Sqrt:  [[0.15]]
grads:  [0.31497311]
Stock Position:  0.3149731086441781
Bond Position:  [-28.20862523]


portfolio before change:  [2.96078337]
curr_Stock_Price:  98.96454914425684
curr_Factors:  [98.96454914]
mat_Sqrt:  [[0.15]]
grads:  [-0.06478548]
Stock Position:  -0.06478548369807989
Bond Position:  [9.37224955]


portfolio before change:  [2.95867404]
curr_Stock_Price:  99.0061497257677
curr_Factors:  [99.00614973]
mat_Sqrt:  [[0.15]]
grads:  [0.02261753]
Stock Position:  0.022617531209037832
Bond Position:  [0.71939936]


portfolio before change:  [2.94694548]
curr_Stock_Price:  98.48560117270517
curr_Factors:  [98.48560117]
mat_Sqrt:  [[0.15]]
grads:  [0.03525946]
Stock Position:  0.035259458169395616
Bond Position:  [-0.52560345]


portfolio before change:  [2.93318633]
curr_Stock_Price:  98.09630707496082
curr_Factors:  [98.09630707]
mat_Sqrt:  [[0.15]]
grads:  [0.0348799]
Stock Position:  0.034879902322126295
Bond Position:  [-0.48840328]


portfolio before change:  [2.91321015]
curr_Stock_Price:  97.52446910551716
curr_Factors:  [97.52446911]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074848]
Stock Position:  -0.010748477566544165
Bond Position:  [3.96144972]


portfolio before change:  [2.90643137]
curr_Stock_Price:  98.17817888305298
curr_Factors:  [98.17817888]
mat_Sqrt:  [[0.15]]
grads:  [0.05423815]
Stock Position:  0.054238147220359974
Bond Position:  [-2.41857115]


portfolio before change:  [2.92359391]
curr_Stock_Price:  98.49739540336869
curr_Factors:  [98.4973954]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026487]
Stock Position:  -0.00264869709024875
Bond Position:  [3.18448368]


portfolio before change:  [2.92490668]
curr_Stock_Price:  98.07691343191578
curr_Factors:  [98.07691343]
mat_Sqrt:  [[0.15]]
grads:  [0.01021823]
Stock Position:  0.010218226821958698
Bond Position:  [1.92273453]


portfolio before change:  [2.9219644]
curr_Stock_Price:  97.77720897346224
curr_Factors:  [97.77720897]
mat_Sqrt:  [[0.15]]
grads:  [-0.01027414]
Stock Position:  -0.010274135572592505
Bond Position:  [3.92654071]


portfolio before change:  [2.91793387]
curr_Stock_Price:  98.19339503639708
curr_Factors:  [98.19339504]
mat_Sqrt:  [[0.15]]
grads:  [0.00030052]
Stock Position:  0.00030052227366891837
Bond Position:  [2.88842457]


portfolio before change:  [2.91789222]
curr_Stock_Price:  97.4540737306705
curr_Factors:  [97.45407373]
mat_Sqrt:  [[0.15]]
grads:  [0.03180783]
Stock Position:  0.03180782725406509
Bond Position:  [-0.18191012]


portfolio before change:  [2.90812607]
curr_Stock_Price:  97.14739526969022
curr_Factors:  [97.14739527]
mat_Sqrt:  [[0.15]]
grads:  [0.0901261]
Stock Position:  0.09012610190777362
Bond Position:  [-5.84738997]


portfolio before change:  [2.97129119]
curr_Stock_Price:  97.85230308504376
curr_Factors:  [97.85230309]
mat_Sqrt:  [[0.15]]
grads:  [-0.1209442]
Stock Position:  -0.12094420404038018
Bond Position:  [14.8059601]


portfolio before change:  [2.97605364]
curr_Stock_Price:  97.82057735011617
curr_Factors:  [97.82057735]
mat_Sqrt:  [[0.15]]
grads:  [-0.06588392]
Stock Position:  -0.06588392280826838
Bond Position:  [9.42085701]


portfolio before change:  [3.01111124]
curr_Stock_Price:  97.29740304884248
curr_Factors:  [97.29740305]
mat_Sqrt:  [[0.15]]
grads:  [-0.05994315]
Stock Position:  -0.05994315055655234
Bond Position:  [8.84342412]


portfolio before change:  [2.96530044]
curr_Stock_Price:  98.07086138853401
curr_Factors:  [98.07086139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03210068]
Stock Position:  -0.032100678594986415
Bond Position:  [6.11344164]


portfolio before change:  [2.96428502]
curr_Stock_Price:  98.11439676533692
curr_Factors:  [98.11439677]
mat_Sqrt:  [[0.15]]
grads:  [0.12898651]
Stock Position:  0.12898650837484552
Bond Position:  [-9.69114844]


portfolio before change:  [3.02755028]
curr_Stock_Price:  98.60957232558683
curr_Factors:  [98.60957233]
mat_Sqrt:  [[0.15]]
grads:  [-0.06279322]
Stock Position:  -0.06279321523666756
Bond Position:  [9.21956237]


portfolio before change:  [2.9943213]
curr_Stock_Price:  99.14793014955337
curr_Factors:  [99.14793015]
mat_Sqrt:  [[0.15]]
grads:  [0.04069527]
Stock Position:  0.040695267736238175
Bond Position:  [-1.04053027]


portfolio before change:  [2.99570794]
curr_Stock_Price:  99.18360199553366
curr_Factors:  [99.183602]
mat_Sqrt:  [[0.15]]
grads:  [-0.05467366]
Stock Position:  -0.05467365900003592
Bond Position:  [8.41843837]


portfolio before change:  [2.99168892]
curr_Stock_Price:  99.26673500757853
curr_Factors:  [99.26673501]
mat_Sqrt:  [[0.15]]
grads:  [0.07160337]
Stock Position:  0.07160336572742487
Bond Position:  [-4.11614341]


portfolio before change:  [2.97332163]
curr_Stock_Price:  99.01381358691101
curr_Factors:  [99.01381359]
mat_Sqrt:  [[0.15]]
grads:  [-0.03260599]
Stock Position:  -0.032605992448178356
Bond Position:  [6.20176529]


portfolio before change:  [2.93916764]
curr_Stock_Price:  100.07317743696737
curr_Factors:  [100.07317744]
mat_Sqrt:  [[0.15]]
grads:  [0.09068543]
Stock Position:  0.09068542749868748
Bond Position:  [-6.13601124]


portfolio before change:  [2.9553698]
curr_Stock_Price:  100.25606975212243
curr_Factors:  [100.25606975]
mat_Sqrt:  [[0.15]]
grads:  [-0.14687043]
Stock Position:  -0.14687043092539764
Bond Position:  [17.68002196]


portfolio before change:  [2.94769466]
curr_Stock_Price:  100.31585153523885
curr_Factors:  [100.31585154]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848482]
Stock Position:  -0.028484822984895023
Bond Position:  [5.80517393]


portfolio before change:  [2.93840784]
curr_Stock_Price:  100.65461606448275
curr_Factors:  [100.65461606]
mat_Sqrt:  [[0.15]]
grads:  [-0.05576375]
Stock Position:  -0.05576375124963051
Bond Position:  [8.55128682]


portfolio before change:  [2.98671185]
curr_Stock_Price:  99.79797474437977
curr_Factors:  [99.79797474]
mat_Sqrt:  [[0.15]]
grads:  [-0.0144116]
Stock Position:  -0.014411601397448843
Bond Position:  [4.42496048]


portfolio before change:  [2.99382637]
curr_Stock_Price:  99.32349913397191
curr_Factors:  [99.32349913]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.99382637]
Stock Price:  98.9753405395429
PL:  [2.99382637]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.14177777e-03]
 [-1.64092395e-02]
 [-1.34285630e-03]
 [ 8.47862983e-03]
 [-8.93300323e-04]
 [ 1.60153436e-02]
 [ 2.41036855e-03]
 [-1.89990402e-02]
 [ 5.11916555e-03]
 [ 1.90001663e-02]
 [ 1.51907128e-02]
 [ 1.84815608e-02]
 [-1.31831111e-02]
 [ 8.18854358e-03]
 [-6.91228895e-03]
 [ 1.71773788e-02]
 [ 9.56762084e-03]
 [-1.15105227e-02]
 [-3.41306690e-04]
 [ 3.30412093e-03]
 [ 1.24632946e-02]
 [-7.55263174e-03]
 [ 6.84107671e-03]
 [ 1.90939048e-02]
 [ 1.53783908e-03]
 [ 1.18470270e-02]
 [-5.41087257e-03]
 [ 8.41443215e-03]
 [ 1.10098633e-02]
 [-1.16442114e-03]
 [ 1.40260135e-02]
 [-1.18036812e-02]
 [ 9.16812146e-03]
 [ 7.08701980e-03]
 [ 1.14929298e-02]
 [ 8.50437846e-03]
 [-3.35601957e-02]
 [ 9.44020816e-03]
 [ 5.20968193e-03]
 [ 1.79990828e-02]
 [-5.12864317e-03]
 [-1.98834951e-02]
 [ 2.18757241e-02]
 [ 2.05994699e-04]
 [-1.90657138e-03]
 [-1.29045334e-02]
 [ 1.41897679e-02]
 [-1.15561351e-03]
 [-6.00423195e-03]
 [-7.54151862e-03]
 [-1.72112295e-02]
 [-3.05537488e-03]
 [-3.05765915e-03]
 [ 5.57025617e-03]
 [-7.38685149e-03]
 [ 7.33066064e-03]
 [ 9.84185600e-03]
 [-3.72341463e-05]
 [ 1.69992657e-03]
 [ 1.65024080e-02]
 [-1.99195514e-03]
 [ 1.67727617e-02]
 [-2.28752181e-03]
 [-1.23376829e-02]
 [ 1.63457549e-03]
 [ 1.50275162e-03]
 [-5.42891105e-03]
 [ 1.50486808e-02]
 [-8.36577495e-03]
 [ 2.18486960e-03]
 [-1.31451433e-02]
 [ 1.28519051e-02]
 [ 1.19476128e-03]
 [ 2.03551975e-02]
 [-2.24820742e-02]
 [-2.91623559e-03]
 [-1.05312794e-02]
 [-1.51098008e-03]
 [ 1.03609195e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.70486812]
curr_Stock_Price:  99.23618790522217
curr_Factors:  [99.23618791]
mat_Sqrt:  [[0.15]]
grads:  [0.04094519]
Stock Position:  0.040945185117186415
Bond Position:  [-13.7681122]


portfolio before change:  [-9.71534792]
curr_Stock_Price:  99.00125759218156
curr_Factors:  [99.00125759]
mat_Sqrt:  [[0.15]]
grads:  [-0.10939493]
Stock Position:  -0.10939493028615847
Bond Position:  [1.11488776]


portfolio before change:  [-9.74801056]
curr_Stock_Price:  99.30047006623393
curr_Factors:  [99.30047007]
mat_Sqrt:  [[0.15]]
grads:  [-0.00895238]
Stock Position:  -0.008952375311271476
Bond Position:  [-8.85903549]


portfolio before change:  [-9.75015469]
curr_Stock_Price:  99.47812339050613
curr_Factors:  [99.47812339]
mat_Sqrt:  [[0.15]]
grads:  [0.0565242]
Stock Position:  0.05652419889038166
Bond Position:  [-15.37307592]


portfolio before change:  [-9.78855028]
curr_Stock_Price:  98.81584523780185
curr_Factors:  [98.81584524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00595534]
Stock Position:  -0.005955335489609635
Bond Position:  [-9.20006877]


portfolio before change:  [-9.78840582]
curr_Stock_Price:  98.69503226040007
curr_Factors:  [98.69503226]
mat_Sqrt:  [[0.15]]
grads:  [0.10676896]
Stock Position:  0.1067689572299683
Bond Position:  [-20.3259715]


portfolio before change:  [-9.812789]
curr_Stock_Price:  98.47855759837331
curr_Factors:  [98.4785576]
mat_Sqrt:  [[0.15]]
grads:  [0.01606912]
Stock Position:  0.016069123648316072
Bond Position:  [-11.39525312]


portfolio before change:  [-9.80678834]
curr_Stock_Price:  98.89630861371663
curr_Factors:  [98.89630861]
mat_Sqrt:  [[0.15]]
grads:  [-0.12666027]
Stock Position:  -0.12666026812845918
Bond Position:  [2.71944463]


portfolio before change:  [-9.83131336]
curr_Stock_Price:  99.09127891019038
curr_Factors:  [99.09127891]
mat_Sqrt:  [[0.15]]
grads:  [0.03412777]
Stock Position:  0.03412777033372232
Bond Position:  [-13.21307777]


portfolio before change:  [-9.82517804]
curr_Stock_Price:  99.29525236294876
curr_Factors:  [99.29525236]
mat_Sqrt:  [[0.15]]
grads:  [0.12666778]
Stock Position:  0.12666777566456303
Bond Position:  [-22.40268679]


portfolio before change:  [-9.86933329]
curr_Stock_Price:  98.95771557872337
curr_Factors:  [98.95771558]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-19.89092151]


portfolio before change:  [-9.85686565]
curr_Stock_Price:  99.0931028636724
curr_Factors:  [99.09310286]
mat_Sqrt:  [[0.15]]
grads:  [0.12321041]
Stock Position:  0.12321040517980539
Bond Position:  [-22.066167]


portfolio before change:  [-9.84521362]
curr_Stock_Price:  99.19886667556716
curr_Factors:  [99.19886668]
mat_Sqrt:  [[0.15]]
grads:  [-0.08788741]
Stock Position:  -0.0878874073929084
Bond Position:  [-1.12688241]


portfolio before change:  [-9.90456984]
curr_Stock_Price:  99.8734318822222
curr_Factors:  [99.87343188]
mat_Sqrt:  [[0.15]]
grads:  [0.05459029]
Stock Position:  0.05459029053453282
Bond Position:  [-15.3566895]


portfolio before change:  [-9.90816489]
curr_Stock_Price:  99.82515908931369
curr_Factors:  [99.82515909]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608193]
Stock Position:  -0.04608192630041421
Bond Position:  [-5.30802927]


portfolio before change:  [-9.94675831]
curr_Stock_Price:  100.65545543972854
curr_Factors:  [100.65545544]
mat_Sqrt:  [[0.15]]
grads:  [0.11451586]
Stock Position:  0.11451585899826723
Bond Position:  [-21.47340425]


portfolio before change:  [-9.95081272]
curr_Stock_Price:  100.63177067568138
curr_Factors:  [100.63177068]
mat_Sqrt:  [[0.15]]
grads:  [0.06378414]
Stock Position:  0.06378413894711697
Bond Position:  [-16.36952356]


portfolio before change:  [-9.93370363]
curr_Stock_Price:  100.91604527534982
curr_Factors:  [100.91604528]
mat_Sqrt:  [[0.15]]
grads:  [-0.07673682]
Stock Position:  -0.07673681828188496
Bond Position:  [-2.18972741]


portfolio before change:  [-9.95538883]
curr_Stock_Price:  101.19685349733051
curr_Factors:  [101.1968535]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227538]
Stock Position:  -0.002275377934343592
Bond Position:  [-9.72512774]


portfolio before change:  [-9.95502302]
curr_Stock_Price:  100.76895017281443
curr_Factors:  [100.76895017]
mat_Sqrt:  [[0.15]]
grads:  [0.02202747]
Stock Position:  0.02202747288682808
Bond Position:  [-12.17470834]


portfolio before change:  [-9.94675419]
curr_Stock_Price:  101.1788824866201
curr_Factors:  [101.17888249]
mat_Sqrt:  [[0.15]]
grads:  [0.08308863]
Stock Position:  0.0830886309831913
Bond Position:  [-18.35356902]


portfolio before change:  [-10.01963869]
curr_Stock_Price:  100.31549888995714
curr_Factors:  [100.31549889]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035088]
Stock Position:  -0.050350878284156644
Bond Position:  [-4.96866521]


portfolio before change:  [-10.03574372]
curr_Stock_Price:  100.62918714289603
curr_Factors:  [100.62918714]
mat_Sqrt:  [[0.15]]
grads:  [0.04560718]
Stock Position:  0.04560717805966067
Bond Position:  [-14.62515698]


portfolio before change:  [-10.01013496]
curr_Stock_Price:  101.21073718222166
curr_Factors:  [101.21073718]
mat_Sqrt:  [[0.15]]
grads:  [0.1272927]
Stock Position:  0.1272926987201555
Bond Position:  [-22.89352284]


portfolio before change:  [-9.99038594]
curr_Stock_Price:  101.37712465774992
curr_Factors:  [101.37712466]
mat_Sqrt:  [[0.15]]
grads:  [0.01025226]
Stock Position:  0.010252260519332316
Bond Position:  [-11.02973064]


portfolio before change:  [-9.99034987]
curr_Stock_Price:  101.44788510115978
curr_Factors:  [101.4478851]
mat_Sqrt:  [[0.15]]
grads:  [0.07898018]
Stock Position:  0.07898017985064924
Bond Position:  [-18.00272208]


portfolio before change:  [-9.94645811]
curr_Stock_Price:  102.01786308094881
curr_Factors:  [102.01786308]
mat_Sqrt:  [[0.15]]
grads:  [-0.03607248]
Stock Position:  -0.036072483823900936
Bond Position:  [-6.26642039]


portfolio before change:  [-9.92740191]
curr_Stock_Price:  101.47873011181876
curr_Factors:  [101.47873011]
mat_Sqrt:  [[0.15]]
grads:  [0.05609621]
Stock Position:  0.05609621431032068
Bond Position:  [-15.6199745]


portfolio before change:  [-9.95610475]
curr_Stock_Price:  100.98446219541671
curr_Factors:  [100.9844622]
mat_Sqrt:  [[0.15]]
grads:  [0.07339909]
Stock Position:  0.07339908854989981
Bond Position:  [-17.36827223]


portfolio before change:  [-9.89357236]
curr_Stock_Price:  101.85120231428388
curr_Factors:  [101.85120231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00776281]
Stock Position:  -0.007762807571329659
Bond Position:  [-9.10292108]


portfolio before change:  [-9.89755106]
curr_Stock_Price:  102.2904441190042
curr_Factors:  [102.29044412]
mat_Sqrt:  [[0.15]]
grads:  [0.09350676]
Stock Position:  0.09350675657576182
Bond Position:  [-19.46239872]


portfolio before change:  [-9.96975537]
curr_Stock_Price:  101.53127045347648
curr_Factors:  [101.53127045]
mat_Sqrt:  [[0.15]]
grads:  [-0.07869121]
Stock Position:  -0.07869120783854537
Bond Position:  [-1.98013706]


portfolio before change:  [-9.95591936]
curr_Stock_Price:  101.3538710881707
curr_Factors:  [101.35387109]
mat_Sqrt:  [[0.15]]
grads:  [0.06112081]
Stock Position:  0.061120809728042416
Bond Position:  [-16.15075003]


portfolio before change:  [-9.99185611]
curr_Stock_Price:  100.78242426008258
curr_Factors:  [100.78242426]
mat_Sqrt:  [[0.15]]
grads:  [0.0472468]
Stock Position:  0.04724679869534363
Bond Position:  [-14.75350302]


portfolio before change:  [-9.98283144]
curr_Stock_Price:  100.99295259530413
curr_Factors:  [100.9929526]
mat_Sqrt:  [[0.15]]
grads:  [0.07661953]
Stock Position:  0.07661953194925654
Bond Position:  [-17.7208642]


portfolio before change:  [-9.9053486]
curr_Stock_Price:  102.01867576289712
curr_Factors:  [102.01867576]
mat_Sqrt:  [[0.15]]
grads:  [0.05669586]
Stock Position:  0.05669585636957016
Bond Position:  [-15.68938479]


portfolio before change:  [-9.90612428]
curr_Stock_Price:  102.02229046996712
curr_Factors:  [102.02229047]
mat_Sqrt:  [[0.15]]
grads:  [-0.22373464]
Stock Position:  -0.22373463814075106
Bond Position:  [12.91979596]


portfolio before change:  [-9.93359718]
curr_Stock_Price:  102.14869208254741
curr_Factors:  [102.14869208]
mat_Sqrt:  [[0.15]]
grads:  [0.06293472]
Stock Position:  0.06293472107457163
Bond Position:  [-16.36229663]


portfolio before change:  [-9.94444744]
curr_Stock_Price:  101.99253685475217
curr_Factors:  [101.99253685]
mat_Sqrt:  [[0.15]]
grads:  [0.03473121]
Stock Position:  0.03473121286102328
Bond Position:  [-13.48677195]


portfolio before change:  [-9.96225388]
curr_Stock_Price:  101.50411482494602
curr_Factors:  [101.50411482]
mat_Sqrt:  [[0.15]]
grads:  [0.11999389]
Stock Position:  0.11999388550600654
Bond Position:  [-22.14212702]


portfolio before change:  [-9.91317408]
curr_Stock_Price:  101.924667356061
curr_Factors:  [101.92466736]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419095]
Stock Position:  -0.03419095444075086
Bond Position:  [-6.42827242]


portfolio before change:  [-9.94403236]
curr_Stock_Price:  102.81544400879797
curr_Factors:  [102.81544401]
mat_Sqrt:  [[0.15]]
grads:  [-0.13255663]
Stock Position:  -0.13255663377629548
Bond Position:  [3.6848368]


portfolio before change:  [-9.7841289]
curr_Stock_Price:  101.61087847270097
curr_Factors:  [101.61087847]
mat_Sqrt:  [[0.15]]
grads:  [0.14583816]
Stock Position:  0.14583816055693133
Bond Position:  [-24.60287251]


portfolio before change:  [-9.67305296]
curr_Stock_Price:  102.38306090219221
curr_Factors:  [102.3830609]
mat_Sqrt:  [[0.15]]
grads:  [0.0013733]
Stock Position:  0.0013732979926318427
Bond Position:  [-9.81365541]


portfolio before change:  [-9.6735408]
curr_Stock_Price:  102.47447315585903
curr_Factors:  [102.47447316]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271048]
Stock Position:  -0.01271047587341736
Bond Position:  [-8.37104148]


portfolio before change:  [-9.67601125]
curr_Stock_Price:  102.62767316317428
curr_Factors:  [102.62767316]
mat_Sqrt:  [[0.15]]
grads:  [-0.08603022]
Stock Position:  -0.08603022296706293
Bond Position:  [-0.84692964]


portfolio before change:  [-9.7013698]
curr_Stock_Price:  102.92182111309226
curr_Factors:  [102.92182111]
mat_Sqrt:  [[0.15]]
grads:  [0.09459845]
Stock Position:  0.09459845275512647
Bond Position:  [-19.43761483]


portfolio before change:  [-9.78848888]
curr_Stock_Price:  102.01372813492436
curr_Factors:  [102.01372813]
mat_Sqrt:  [[0.15]]
grads:  [-0.00770409]
Stock Position:  -0.0077040900496425264
Bond Position:  [-9.00256593]


portfolio before change:  [-9.78755688]
curr_Stock_Price:  101.81971782697268
curr_Factors:  [101.81971783]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002821]
Stock Position:  -0.040028212978679895
Bond Position:  [-5.71189553]


portfolio before change:  [-9.78179436]
curr_Stock_Price:  101.66683744383798
curr_Factors:  [101.66683744]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027679]
Stock Position:  -0.05027679079784815
Bond Position:  [-4.67031204]


portfolio before change:  [-9.79010926]
curr_Stock_Price:  101.82641402040606
curr_Factors:  [101.82641402]
mat_Sqrt:  [[0.15]]
grads:  [-0.11474153]
Stock Position:  -0.11474153031806605
Bond Position:  [1.89360931]


portfolio before change:  [-9.74876095]
curr_Stock_Price:  101.4670850248046
curr_Factors:  [101.46708502]
mat_Sqrt:  [[0.15]]
grads:  [-0.02036917]
Stock Position:  -0.02036916584147472
Bond Position:  [-7.68196107]


portfolio before change:  [-9.74905209]
curr_Stock_Price:  101.45780662144095
curr_Factors:  [101.45780662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02038439]
Stock Position:  -0.020384394342440548
Bond Position:  [-7.68089615]


portfolio before change:  [-9.77064329]
curr_Stock_Price:  102.493458052468
curr_Factors:  [102.49345805]
mat_Sqrt:  [[0.15]]
grads:  [0.03713504]
Stock Position:  0.03713504113686488
Bond Position:  [-13.57674207]


portfolio before change:  [-9.74141674]
curr_Stock_Price:  103.30334340624077
curr_Factors:  [103.30334341]
mat_Sqrt:  [[0.15]]
grads:  [-0.04924568]
Stock Position:  -0.04924567658041806
Bond Position:  [-4.6541737]


portfolio before change:  [-9.73910917]
curr_Stock_Price:  103.25057808482458
curr_Factors:  [103.25057808]
mat_Sqrt:  [[0.15]]
grads:  [0.04887107]
Stock Position:  0.048871070942184104
Bond Position:  [-14.78507549]


portfolio before change:  [-9.74974078]
curr_Stock_Price:  103.05194288876626
curr_Factors:  [103.05194289]
mat_Sqrt:  [[0.15]]
grads:  [0.06561237]
Stock Position:  0.0656123733460093
Bond Position:  [-16.51122333]


portfolio before change:  [-9.74028831]
curr_Stock_Price:  103.21173678620124
curr_Factors:  [103.21173679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00024823]
Stock Position:  -0.0002482276417226317
Bond Position:  [-9.7146683]


portfolio before change:  [-9.74084008]
curr_Stock_Price:  102.98852650741544
curr_Factors:  [102.98852651]
mat_Sqrt:  [[0.15]]
grads:  [0.01133284]
Stock Position:  0.011332843794460496
Bond Position:  [-10.90799297]


portfolio before change:  [-9.74306034]
curr_Stock_Price:  102.85277217304387
curr_Factors:  [102.85277217]
mat_Sqrt:  [[0.15]]
grads:  [0.11001605]
Stock Position:  0.11001605339297671
Bond Position:  [-21.05851641]


portfolio before change:  [-9.74466031]
curr_Stock_Price:  102.8501927682108
curr_Factors:  [102.85019277]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132797]
Stock Position:  -0.013279700945973775
Bond Position:  [-8.37884051]


portfolio before change:  [-9.75020964]
curr_Stock_Price:  103.22863773547303
curr_Factors:  [103.22863774]
mat_Sqrt:  [[0.15]]
grads:  [0.11181841]
Stock Position:  0.11181841132347477
Bond Position:  [-21.29307192]


portfolio before change:  [-9.87779656]
curr_Stock_Price:  102.09952084430384
curr_Factors:  [102.09952084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525015]
Stock Position:  -0.01525014537580417
Bond Position:  [-8.32076402]


portfolio before change:  [-9.88286479]
curr_Stock_Price:  102.39775864585405
curr_Factors:  [102.39775865]
mat_Sqrt:  [[0.15]]
grads:  [-0.08225122]
Stock Position:  -0.08225121961250148
Bond Position:  [-1.46052426]


portfolio before change:  [-9.8955453]
curr_Stock_Price:  102.55081686840761
curr_Factors:  [102.55081687]
mat_Sqrt:  [[0.15]]
grads:  [0.01089717]
Stock Position:  0.010897169903883869
Bond Position:  [-11.01305898]


portfolio before change:  [-9.89358755]
curr_Stock_Price:  102.79364083003381
curr_Factors:  [102.79364083]
mat_Sqrt:  [[0.15]]
grads:  [0.01001834]
Stock Position:  0.010018344139705778
Bond Position:  [-10.92340962]


portfolio before change:  [-9.89329829]
curr_Stock_Price:  102.89066239859402
curr_Factors:  [102.8906624]
mat_Sqrt:  [[0.15]]
grads:  [-0.03619274]
Stock Position:  -0.0361927403242766
Bond Position:  [-6.16940326]


portfolio before change:  [-9.88201821]
curr_Stock_Price:  102.56834157357909
curr_Factors:  [102.56834157]
mat_Sqrt:  [[0.15]]
grads:  [0.10032454]
Stock Position:  0.1003245387397597
Bond Position:  [-20.17213977]


portfolio before change:  [-9.79406428]
curr_Stock_Price:  103.45760285897786
curr_Factors:  [103.45760286]
mat_Sqrt:  [[0.15]]
grads:  [-0.05577183]
Stock Position:  -0.05577183303166515
Bond Position:  [-4.02404413]


portfolio before change:  [-9.80956435]
curr_Stock_Price:  103.73101258448744
curr_Factors:  [103.73101258]
mat_Sqrt:  [[0.15]]
grads:  [0.0145658]
Stock Position:  0.014565797348332934
Bond Position:  [-11.32048926]


portfolio before change:  [-9.81036659]
curr_Stock_Price:  103.72451225510734
curr_Factors:  [103.72451226]
mat_Sqrt:  [[0.15]]
grads:  [-0.08763429]
Stock Position:  -0.08763428845496787
Bond Position:  [-0.72054276]


portfolio before change:  [-9.78083565]
curr_Stock_Price:  103.38701907459526
curr_Factors:  [103.38701907]
mat_Sqrt:  [[0.15]]
grads:  [0.08567937]
Stock Position:  0.08567936703031817
Bond Position:  [-18.63897]


portfolio before change:  [-9.83179943]
curr_Stock_Price:  102.8057961797267
curr_Factors:  [102.80579618]
mat_Sqrt:  [[0.15]]
grads:  [0.00796508]
Stock Position:  0.007965075221002605
Bond Position:  [-10.65065533]


portfolio before change:  [-9.83643265]
curr_Stock_Price:  102.30768010357902
curr_Factors:  [102.3076801]
mat_Sqrt:  [[0.15]]
grads:  [0.13570132]
Stock Position:  0.13570131655212006
Bond Position:  [-23.71971953]


portfolio before change:  [-9.83759964]
curr_Stock_Price:  102.31000531428522
curr_Factors:  [102.31000531]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988049]
Stock Position:  -0.14988049463194164
Bond Position:  [5.49667456]


portfolio before change:  [-9.75044654]
curr_Stock_Price:  101.7308135181436
curr_Factors:  [101.73081352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01944157]
Stock Position:  -0.019441570572625817
Bond Position:  [-7.77263975]


portfolio before change:  [-9.74731552]
curr_Stock_Price:  101.54477784089553
curr_Factors:  [101.54477784]
mat_Sqrt:  [[0.15]]
grads:  [-0.07020853]
Stock Position:  -0.07020852910188599
Bond Position:  [-2.61800603]


portfolio before change:  [-9.73068062]
curr_Stock_Price:  101.3055116648314
curr_Factors:  [101.30551166]
mat_Sqrt:  [[0.15]]
grads:  [-0.0100732]
Stock Position:  -0.010073200534460234
Bond Position:  [-8.71020989]


portfolio before change:  [-9.7280918]
curr_Stock_Price:  100.99446579310995
curr_Factors:  [100.99446579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.7280918]
Stock Price:  101.68912603438223
PL:  [-11.41721783]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.25684180e-03]
 [ 8.32901157e-04]
 [-9.74739322e-05]
 [ 7.13212935e-03]
 [ 4.50629126e-03]
 [ 2.02975199e-02]
 [ 1.28881919e-03]
 [-1.80611891e-02]
 [ 2.41998153e-04]
 [ 1.89034787e-02]
 [ 1.40815053e-02]
 [-1.75515383e-02]
 [ 2.05185408e-02]
 [ 1.05485694e-03]
 [-6.91553778e-03]
 [ 1.54065848e-02]
 [ 8.26436686e-03]
 [-1.22579625e-02]
 [-2.70955193e-04]
 [ 1.12282115e-02]
 [ 1.20913454e-02]
 [-7.01731147e-03]
 [ 7.47718749e-03]
 [ 2.71433272e-02]
 [-1.86131609e-03]
 [ 1.36660470e-02]
 [-5.63813993e-03]
 [ 6.77718027e-03]
 [ 1.25604942e-02]
 [-1.93234562e-03]
 [ 2.80434782e-03]
 [-1.15079177e-02]
 [ 3.90806191e-03]
 [ 5.48988552e-03]
 [ 1.14941416e-02]
 [ 9.26894121e-03]
 [-3.40900693e-02]
 [ 9.64348637e-03]
 [ 5.81313487e-03]
 [ 1.84877725e-02]
 [-4.70026664e-03]
 [-2.10465235e-02]
 [ 2.07286946e-02]
 [-1.95019473e-03]
 [ 5.11791185e-03]
 [-1.44940755e-02]
 [ 1.41668221e-02]
 [ 4.12078033e-03]
 [ 4.88607714e-03]
 [-7.42557875e-03]
 [-1.66442871e-02]
 [ 3.14730939e-03]
 [-9.54309978e-03]
 [ 5.87569155e-03]
 [-1.77780110e-02]
 [ 2.62382718e-02]
 [ 1.54152824e-02]
 [ 1.68100632e-03]
 [ 2.02767468e-03]
 [ 2.99973313e-03]
 [ 1.87980894e-02]
 [ 4.29055085e-02]
 [-4.47948078e-03]
 [-1.17416797e-02]
 [ 2.05456410e-02]
 [ 1.01202971e-02]
 [-4.36904665e-03]
 [ 1.58123056e-02]
 [-2.62006282e-02]
 [-6.27135505e-02]
 [-1.59554662e-03]
 [ 1.63197756e-02]
 [-3.14533794e-02]
 [ 2.85445591e-02]
 [-3.01128291e-02]
 [ 6.59738824e-03]
 [ 1.02982056e-02]
 [-1.87870689e-02]
 [ 1.93250580e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.99159708]
curr_Stock_Price:  99.0874934484319
curr_Factors:  [99.08749345]
mat_Sqrt:  [[0.15]]
grads:  [0.04837895]
Stock Position:  0.04837894533800856
Bond Position:  [-16.78534551]


portfolio before change:  [-11.95963413]
curr_Stock_Price:  99.76985777712366
curr_Factors:  [99.76985778]
mat_Sqrt:  [[0.15]]
grads:  [0.00555267]
Stock Position:  0.005552674380678137
Bond Position:  [-12.51362366]


portfolio before change:  [-11.96060217]
curr_Stock_Price:  99.73637659404729
curr_Factors:  [99.73637659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00064983]
Stock Position:  -0.0006498262147531901
Bond Position:  [-11.89579085]


portfolio before change:  [-11.96169326]
curr_Stock_Price:  100.27126980239255
curr_Factors:  [100.2712698]
mat_Sqrt:  [[0.15]]
grads:  [0.04754753]
Stock Position:  0.04754752900436236
Bond Position:  [-16.72934437]


portfolio before change:  [-11.9812629]
curr_Stock_Price:  99.88168020016575
curr_Factors:  [99.8816802]
mat_Sqrt:  [[0.15]]
grads:  [0.03004194]
Stock Position:  0.030041941702883754
Bond Position:  [-14.98190252]


portfolio before change:  [-11.99736345]
curr_Stock_Price:  99.37691444752173
curr_Factors:  [99.37691445]
mat_Sqrt:  [[0.15]]
grads:  [0.1353168]
Stock Position:  0.13531679926963153
Bond Position:  [-25.44472943]


portfolio before change:  [-12.03178317]
curr_Stock_Price:  99.13430315195119
curr_Factors:  [99.13430315]
mat_Sqrt:  [[0.15]]
grads:  [0.00859213]
Stock Position:  0.008592127908090328
Bond Position:  [-12.88355779]


portfolio before change:  [-12.02907915]
curr_Stock_Price:  99.54273213045856
curr_Factors:  [99.54273213]
mat_Sqrt:  [[0.15]]
grads:  [-0.12040793]
Stock Position:  -0.12040792711624948
Bond Position:  [-0.04334511]


portfolio before change:  [-11.93670152]
curr_Stock_Price:  98.77550410530674
curr_Factors:  [98.77550411]
mat_Sqrt:  [[0.15]]
grads:  [0.00161332]
Stock Position:  0.0016133210188640456
Bond Position:  [-12.09605812]


portfolio before change:  [-11.936719]
curr_Stock_Price:  99.23328604637925
curr_Factors:  [99.23328605]
mat_Sqrt:  [[0.15]]
grads:  [0.12602319]
Stock Position:  0.12602319142368937
Bond Position:  [-24.4424144]


portfolio before change:  [-11.9033664]
curr_Stock_Price:  99.5100628562757
curr_Factors:  [99.51006286]
mat_Sqrt:  [[0.15]]
grads:  [0.0938767]
Stock Position:  0.09387670232230445
Bond Position:  [-21.24504295]


portfolio before change:  [-11.8148342]
curr_Stock_Price:  100.46727642609979
curr_Factors:  [100.46727643]
mat_Sqrt:  [[0.15]]
grads:  [-0.11701026]
Stock Position:  -0.1170102555017801
Bond Position:  [-0.05913252]


portfolio before change:  [-11.85795734]
curr_Stock_Price:  100.835786323981
curr_Factors:  [100.83578632]
mat_Sqrt:  [[0.15]]
grads:  [0.13679027]
Stock Position:  0.1367902718040234
Bond Position:  [-25.65131196]


portfolio before change:  [-11.87464683]
curr_Stock_Price:  100.7254990100521
curr_Factors:  [100.72549901]
mat_Sqrt:  [[0.15]]
grads:  [0.00703238]
Stock Position:  0.007032379592876425
Bond Position:  [-12.58298677]


portfolio before change:  [-11.87740746]
curr_Stock_Price:  100.44477267679578
curr_Factors:  [100.44477268]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610359]
Stock Position:  -0.046103585188281414
Bond Position:  [-7.24654333]


portfolio before change:  [-11.8799356]
curr_Stock_Price:  100.48978466936885
curr_Factors:  [100.48978467]
mat_Sqrt:  [[0.15]]
grads:  [0.10271057]
Stock Position:  0.10271056518934432
Bond Position:  [-22.20129818]


portfolio before change:  [-11.89676606]
curr_Stock_Price:  100.33943176639278
curr_Factors:  [100.33943177]
mat_Sqrt:  [[0.15]]
grads:  [0.05509578]
Stock Position:  0.05509577905237808
Bond Position:  [-17.42504522]


portfolio before change:  [-11.90177952]
curr_Stock_Price:  100.26820372861688
curr_Factors:  [100.26820373]
mat_Sqrt:  [[0.15]]
grads:  [-0.08171975]
Stock Position:  -0.08171974994370317
Bond Position:  [-3.70788698]


portfolio before change:  [-11.88169763]
curr_Stock_Price:  100.01962689149144
curr_Factors:  [100.01962689]
mat_Sqrt:  [[0.15]]
grads:  [-0.00180637]
Stock Position:  -0.0018063679512729698
Bond Position:  [-11.70102538]


portfolio before change:  [-11.88270697]
curr_Stock_Price:  100.17352615505524
curr_Factors:  [100.17352616]
mat_Sqrt:  [[0.15]]
grads:  [0.07485474]
Stock Position:  0.074854743407213
Bond Position:  [-19.38117056]


portfolio before change:  [-11.84166544]
curr_Stock_Price:  100.7379912753653
curr_Factors:  [100.73799128]
mat_Sqrt:  [[0.15]]
grads:  [0.08060897]
Stock Position:  0.08060896966023946
Bond Position:  [-19.96205112]


portfolio before change:  [-11.86159713]
curr_Stock_Price:  100.50620529659182
curr_Factors:  [100.5062053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04678208]
Stock Position:  -0.04678207644964152
Bond Position:  [-7.15970815]


portfolio before change:  [-11.81439308]
curr_Stock_Price:  99.48761981371874
curr_Factors:  [99.48761981]
mat_Sqrt:  [[0.15]]
grads:  [0.04984792]
Stock Position:  0.04984791657833198
Bond Position:  [-16.77364366]


portfolio before change:  [-11.83066107]
curr_Stock_Price:  99.18229919647439
curr_Factors:  [99.1822992]
mat_Sqrt:  [[0.15]]
grads:  [0.18095551]
Stock Position:  0.1809555148015186
Bond Position:  [-29.77824508]


portfolio before change:  [-11.64776673]
curr_Stock_Price:  100.203298967375
curr_Factors:  [100.20329897]
mat_Sqrt:  [[0.15]]
grads:  [-0.01240877]
Stock Position:  -0.012408773926507084
Bond Position:  [-10.40436664]


portfolio before change:  [-11.65685592]
curr_Stock_Price:  100.88337389621125
curr_Factors:  [100.8833739]
mat_Sqrt:  [[0.15]]
grads:  [0.09110698]
Stock Position:  0.09110697993386062
Bond Position:  [-20.84803544]


portfolio before change:  [-11.61906916]
curr_Stock_Price:  101.31242769852574
curr_Factors:  [101.3124277]
mat_Sqrt:  [[0.15]]
grads:  [-0.0375876]
Stock Position:  -0.03758759953990795
Bond Position:  [-7.8109782]


portfolio before change:  [-11.59967476]
curr_Stock_Price:  100.78346066488763
curr_Factors:  [100.78346066]
mat_Sqrt:  [[0.15]]
grads:  [0.0451812]
Stock Position:  0.045181201772361346
Bond Position:  [-16.15319263]


portfolio before change:  [-11.58552751]
curr_Stock_Price:  101.11892885782308
curr_Factors:  [101.11892886]
mat_Sqrt:  [[0.15]]
grads:  [0.08373663]
Stock Position:  0.08373662822721897
Bond Position:  [-20.05288567]


portfolio before change:  [-11.71937949]
curr_Stock_Price:  99.53540879889606
curr_Factors:  [99.5354088]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128823]
Stock Position:  -0.012882304125125265
Bond Position:  [-10.43713408]


portfolio before change:  [-11.72600936]
curr_Stock_Price:  99.99941959738649
curr_Factors:  [99.9994196]
mat_Sqrt:  [[0.15]]
grads:  [0.01869565]
Stock Position:  0.01869565214713098
Bond Position:  [-13.59556372]


portfolio before change:  [-11.72603762]
curr_Stock_Price:  100.04335979458877
curr_Factors:  [100.04335979]
mat_Sqrt:  [[0.15]]
grads:  [-0.07671945]
Stock Position:  -0.07671945101524526
Bond Position:  [-4.05076597]


portfolio before change:  [-11.74406656]
curr_Stock_Price:  100.27505804324507
curr_Factors:  [100.27505804]
mat_Sqrt:  [[0.15]]
grads:  [0.02605375]
Stock Position:  0.026053746065733165
Bond Position:  [-14.35660746]


portfolio before change:  [-11.74910723]
curr_Stock_Price:  100.11602696905575
curr_Factors:  [100.11602697]
mat_Sqrt:  [[0.15]]
grads:  [0.03659924]
Stock Position:  0.036599236781566374
Bond Position:  [-15.41327741]


portfolio before change:  [-11.71845905]
curr_Stock_Price:  100.97974822588903
curr_Factors:  [100.97974823]
mat_Sqrt:  [[0.15]]
grads:  [0.07662761]
Stock Position:  0.07662761079688202
Bond Position:  [-19.4562959]


portfolio before change:  [-11.72255086]
curr_Stock_Price:  100.94221926757542
curr_Factors:  [100.94221927]
mat_Sqrt:  [[0.15]]
grads:  [0.06179294]
Stock Position:  0.061792941405646166
Bond Position:  [-17.9600675]


portfolio before change:  [-11.72107839]
curr_Stock_Price:  100.98421447321527
curr_Factors:  [100.98421447]
mat_Sqrt:  [[0.15]]
grads:  [-0.22726713]
Stock Position:  -0.22726712860085513
Bond Position:  [11.22931406]


portfolio before change:  [-11.80208266]
curr_Stock_Price:  101.34373025248824
curr_Factors:  [101.34373025]
mat_Sqrt:  [[0.15]]
grads:  [0.06428991]
Stock Position:  0.06428990910549567
Bond Position:  [-18.31746187]


portfolio before change:  [-11.74850168]
curr_Stock_Price:  102.19496583190796
curr_Factors:  [102.19496583]
mat_Sqrt:  [[0.15]]
grads:  [0.03875423]
Stock Position:  0.038754232465548676
Bond Position:  [-15.70898914]


portfolio before change:  [-11.7735943]
curr_Stock_Price:  101.5728201636772
curr_Factors:  [101.57282016]
mat_Sqrt:  [[0.15]]
grads:  [0.12325182]
Stock Position:  0.12325181669967751
Bond Position:  [-24.29262891]


portfolio before change:  [-11.6708408]
curr_Stock_Price:  102.41882663133589
curr_Factors:  [102.41882663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03133511]
Stock Position:  -0.031335110954211584
Bond Position:  [-8.4615355]


portfolio before change:  [-11.66929308]
curr_Stock_Price:  102.3525565961064
curr_Factors:  [102.3525566]
mat_Sqrt:  [[0.15]]
grads:  [-0.14031016]
Stock Position:  -0.14031015639154693
Bond Position:  [2.69181014]


portfolio before change:  [-11.82657955]
curr_Stock_Price:  103.4747469814429
curr_Factors:  [103.47474698]
mat_Sqrt:  [[0.15]]
grads:  [0.1381913]
Stock Position:  0.1381912972157277
Bond Position:  [-26.12588906]


portfolio before change:  [-11.81726883]
curr_Stock_Price:  103.55393892352956
curr_Factors:  [103.55393892]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130013]
Stock Position:  -0.01300129817052676
Bond Position:  [-10.4709332]


portfolio before change:  [-11.81939018]
curr_Stock_Price:  103.66676579093219
curr_Factors:  [103.66676579]
mat_Sqrt:  [[0.15]]
grads:  [0.03411941]
Stock Position:  0.034119412332284764
Bond Position:  [-15.35643931]


portfolio before change:  [-11.84261701]
curr_Stock_Price:  103.0141456260669
curr_Factors:  [103.01414563]
mat_Sqrt:  [[0.15]]
grads:  [-0.09662717]
Stock Position:  -0.0966271702380194
Bond Position:  [-1.88865162]


portfolio before change:  [-11.83154161]
curr_Stock_Price:  102.89830410113532
curr_Factors:  [102.8983041]
mat_Sqrt:  [[0.15]]
grads:  [0.09444548]
Stock Position:  0.0944454808187864
Bond Position:  [-21.54982142]


portfolio before change:  [-11.82842627]
curr_Stock_Price:  102.94555087069924
curr_Factors:  [102.94555087]
mat_Sqrt:  [[0.15]]
grads:  [0.02747187]
Stock Position:  0.027471868867673603
Bond Position:  [-14.65653295]


portfolio before change:  [-11.79951437]
curr_Stock_Price:  104.03131481918368
curr_Factors:  [104.03131482]
mat_Sqrt:  [[0.15]]
grads:  [0.03257385]
Stock Position:  0.032573847571140124
Bond Position:  [-15.18821456]


portfolio before change:  [-11.79897469]
curr_Stock_Price:  104.07702536320645
curr_Factors:  [104.07702536]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950386]
Stock Position:  -0.04950385834601854
Bond Position:  [-6.64676037]


portfolio before change:  [-11.79860485]
curr_Stock_Price:  104.06116232729933
curr_Factors:  [104.06116233]
mat_Sqrt:  [[0.15]]
grads:  [-0.11096191]
Stock Position:  -0.11096191428318965
Bond Position:  [-0.25177907]


portfolio before change:  [-11.8190072]
curr_Stock_Price:  104.24488851857781
curr_Factors:  [104.24488852]
mat_Sqrt:  [[0.15]]
grads:  [0.02098206]
Stock Position:  0.02098206258475087
Bond Position:  [-14.00627997]


portfolio before change:  [-11.80806696]
curr_Stock_Price:  104.8080199230566
curr_Factors:  [104.80801992]
mat_Sqrt:  [[0.15]]
grads:  [-0.06362067]
Stock Position:  -0.0636206652031234
Bond Position:  [-5.14011101]


portfolio before change:  [-11.83522781]
curr_Stock_Price:  105.22988888184207
curr_Factors:  [105.22988888]
mat_Sqrt:  [[0.15]]
grads:  [0.03917128]
Stock Position:  0.03917127699540423
Bond Position:  [-15.95721693]


portfolio before change:  [-11.80669714]
curr_Stock_Price:  105.98370705363867
curr_Factors:  [105.98370705]
mat_Sqrt:  [[0.15]]
grads:  [-0.11852007]
Stock Position:  -0.11852007354298116
Bond Position:  [0.75449961]


portfolio before change:  [-11.82027024]
curr_Stock_Price:  106.09862643832223
curr_Factors:  [106.09862644]
mat_Sqrt:  [[0.15]]
grads:  [0.17492181]
Stock Position:  0.1749218120964877
Bond Position:  [-30.37923424]


portfolio before change:  [-11.75475874]
curr_Stock_Price:  106.48400013743216
curr_Factors:  [106.48400014]
mat_Sqrt:  [[0.15]]
grads:  [0.10276855]
Stock Position:  0.10276854963125887
Bond Position:  [-22.69796499]


portfolio before change:  [-11.76395391]
curr_Stock_Price:  106.40833008267168
curr_Factors:  [106.40833008]
mat_Sqrt:  [[0.15]]
grads:  [0.01120671]
Stock Position:  0.011206708824676854
Bond Position:  [-12.95644108]


portfolio before change:  [-11.75525814]
curr_Stock_Price:  107.25653385333301
curr_Factors:  [107.25653385]
mat_Sqrt:  [[0.15]]
grads:  [0.01351783]
Stock Position:  0.013517831214590933
Bond Position:  [-13.20513386]


portfolio before change:  [-11.7667022]
curr_Stock_Price:  106.47099985036863
curr_Factors:  [106.47099985]
mat_Sqrt:  [[0.15]]
grads:  [0.01999822]
Stock Position:  0.019998220845217757
Bond Position:  [-13.89593277]


portfolio before change:  [-11.75909736]
curr_Stock_Price:  106.89470567934633
curr_Factors:  [106.89470568]
mat_Sqrt:  [[0.15]]
grads:  [0.1253206]
Stock Position:  0.12532059574574447
Bond Position:  [-25.15520556]


portfolio before change:  [-11.81389451]
curr_Stock_Price:  106.46999570850195
curr_Factors:  [106.46999571]
mat_Sqrt:  [[0.15]]
grads:  [0.28603672]
Stock Position:  0.2860367234510276
Bond Position:  [-42.26822323]


portfolio before change:  [-11.57334688]
curr_Stock_Price:  107.32019939631584
curr_Factors:  [107.3201994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02986321]
Stock Position:  -0.029863205221716285
Bond Position:  [-8.36842174]


portfolio before change:  [-11.59235519]
curr_Stock_Price:  107.93919740669395
curr_Factors:  [107.93919741]
mat_Sqrt:  [[0.15]]
grads:  [-0.07827786]
Stock Position:  -0.07827786455143375
Bond Position:  [-3.14310532]


portfolio before change:  [-11.68304484]
curr_Stock_Price:  109.09524836372255
curr_Factors:  [109.09524836]
mat_Sqrt:  [[0.15]]
grads:  [0.13697094]
Stock Position:  0.1369709400155112
Bond Position:  [-26.62592356]


portfolio before change:  [-11.76938742]
curr_Stock_Price:  108.47702665176679
curr_Factors:  [108.47702665]
mat_Sqrt:  [[0.15]]
grads:  [0.06746865]
Stock Position:  0.06746864728804536
Bond Position:  [-19.08818567]


portfolio before change:  [-11.74947574]
curr_Stock_Price:  108.7898346358593
curr_Factors:  [108.78983464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02912698]
Stock Position:  -0.029126977641487535
Bond Position:  [-8.58075666]


portfolio before change:  [-11.7375701]
curr_Stock_Price:  108.36267214145195
curr_Factors:  [108.36267214]
mat_Sqrt:  [[0.15]]
grads:  [0.10541537]
Stock Position:  0.10541537075479848
Bond Position:  [-23.16066136]


portfolio before change:  [-11.64761121]
curr_Stock_Price:  109.22977987506601
curr_Factors:  [109.22977988]
mat_Sqrt:  [[0.15]]
grads:  [-0.17467085]
Stock Position:  -0.17467085452801304
Bond Position:  [7.43164779]


portfolio before change:  [-11.74857348]
curr_Stock_Price:  109.81045354996598
curr_Factors:  [109.81045355]
mat_Sqrt:  [[0.15]]
grads:  [-0.41809034]
Stock Position:  -0.4180903367641359
Bond Position:  [34.16211603]


portfolio before change:  [-11.26577058]
curr_Stock_Price:  108.66077928336597
curr_Factors:  [108.66077928]
mat_Sqrt:  [[0.15]]
grads:  [-0.01063698]
Stock Position:  -0.010636977489751008
Bond Position:  [-10.10994832]


portfolio before change:  [-11.25902059]
curr_Stock_Price:  107.96679653926222
curr_Factors:  [107.96679654]
mat_Sqrt:  [[0.15]]
grads:  [0.1087985]
Stock Position:  0.10879850402753177
Bond Position:  [-23.00564654]


portfolio before change:  [-11.27205976]
curr_Stock_Price:  107.86016574088111
curr_Factors:  [107.86016574]
mat_Sqrt:  [[0.15]]
grads:  [-0.2096892]
Stock Position:  -0.20968919627855337
Bond Position:  [11.3450517]


portfolio before change:  [-11.24575435]
curr_Stock_Price:  107.73809783705379
curr_Factors:  [107.73809784]
mat_Sqrt:  [[0.15]]
grads:  [0.19029706]
Stock Position:  0.19029706084003475
Bond Position:  [-31.74799771]


portfolio before change:  [-11.21553156]
curr_Stock_Price:  107.90734432467633
curr_Factors:  [107.90734432]
mat_Sqrt:  [[0.15]]
grads:  [-0.20075219]
Stock Position:  -0.20075219374219305
Bond Position:  [10.44710454]


portfolio before change:  [-11.25099673]
curr_Stock_Price:  108.08725834638986
curr_Factors:  [108.08725835]
mat_Sqrt:  [[0.15]]
grads:  [0.04398259]
Stock Position:  0.043982588297200934
Bond Position:  [-16.00495411]


portfolio before change:  [-11.23374425]
curr_Stock_Price:  108.50225929474803
curr_Factors:  [108.50225929]
mat_Sqrt:  [[0.15]]
grads:  [0.0686547]
Stock Position:  0.06865470428115596
Bond Position:  [-18.68293478]


portfolio before change:  [-11.22032451]
curr_Stock_Price:  108.71473500498836
curr_Factors:  [108.714735]
mat_Sqrt:  [[0.15]]
grads:  [-0.12524713]
Stock Position:  -0.12524712575168037
Bond Position:  [2.39588357]


portfolio before change:  [-11.27375586]
curr_Stock_Price:  109.14253796319501
curr_Factors:  [109.14253796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.27375586]
Stock Price:  108.91106860124567
PL:  [-20.18482446]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-1.81895239e-05]
 [-7.56582465e-04]
 [-3.83439307e-03]
 [ 6.20983263e-03]
 [-3.24332231e-03]
 [ 1.17644473e-02]
 [ 2.87577745e-03]
 [-2.52955617e-02]
 [-3.72000553e-03]
 [ 2.48740323e-02]
 [-8.54159158e-03]
 [ 2.32362270e-02]
 [-1.36403000e-02]
 [ 7.98260629e-03]
 [-6.93671774e-03]
 [ 1.07284078e-02]
 [ 7.21718326e-03]
 [-1.24161738e-02]
 [-2.20437311e-04]
 [ 1.17800541e-02]
 [ 1.16698317e-02]
 [-7.91663251e-03]
 [ 7.43135133e-03]
 [ 3.99901623e-02]
 [-3.53679665e-03]
 [ 1.45399171e-02]
 [-6.62802491e-03]
 [ 6.13634778e-03]
 [ 3.53680800e-04]
 [-2.87783177e-03]
 [ 3.46950250e-03]
 [-1.13492774e-02]
 [ 2.03792210e-03]
 [ 4.66502508e-03]
 [ 1.15855865e-02]
 [ 1.19359135e-02]
 [-3.51542006e-02]
 [ 9.73912149e-03]
 [-3.07625027e-03]
 [ 2.23740269e-02]
 [-6.13226982e-03]
 [-5.58055215e-03]
 [ 2.36235281e-02]
 [ 3.93166838e-03]
 [-8.17454098e-03]
 [-4.17172127e-03]
 [ 4.77840393e-03]
 [-1.17875091e-02]
 [-1.51648156e-02]
 [-7.00025943e-03]
 [ 3.47521229e-02]
 [-9.01978256e-03]
 [ 8.76279673e-04]
 [ 5.34027255e-03]
 [ 4.69795956e-03]
 [-3.60815074e-03]
 [ 6.26970208e-03]
 [-3.20801636e-04]
 [ 1.62766476e-03]
 [ 1.57278878e-02]
 [-1.19563673e-03]
 [ 9.77766536e-03]
 [ 3.29010921e-03]
 [-1.24799818e-02]
 [ 2.50311974e-03]
 [ 2.73725157e-03]
 [-5.42176358e-03]
 [ 1.50161525e-02]
 [-8.39983121e-03]
 [ 4.16699667e-04]
 [-1.32469313e-02]
 [ 1.32354309e-02]
 [-2.05669400e-04]
 [ 2.32907674e-02]
 [-2.41962284e-02]
 [ 3.48732923e-04]
 [-3.21566803e-03]
 [-7.84645415e-03]
 [ 2.87724829e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.89758857]
curr_Stock_Price:  100.3807869276409
curr_Factors:  [100.38078693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012126]
Stock Position:  -0.00012126349250873916
Bond Position:  [7.90976109]


portfolio before change:  [7.89817686]
curr_Stock_Price:  99.60633930698647
curr_Factors:  [99.60633931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00504388]
Stock Position:  -0.005043883100346924
Bond Position:  [8.40057959]


portfolio before change:  [7.90235713]
curr_Stock_Price:  98.88165439790738
curr_Factors:  [98.8816544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02556262]
Stock Position:  -0.025562620487065976
Bond Position:  [10.43003134]


portfolio before change:  [7.91057426]
curr_Stock_Price:  98.58570549126203
curr_Factors:  [98.58570549]
mat_Sqrt:  [[0.15]]
grads:  [0.04139888]
Stock Position:  0.0413988841786577
Bond Position:  [3.82923606]


portfolio before change:  [7.90721625]
curr_Stock_Price:  98.49881070532699
curr_Factors:  [98.49881071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02162215]
Stock Position:  -0.021622148764720933
Bond Position:  [10.03697219]


portfolio before change:  [7.91823691]
curr_Stock_Price:  98.01813102130774
curr_Factors:  [98.01813102]
mat_Sqrt:  [[0.15]]
grads:  [0.07842965]
Stock Position:  0.07842964874673841
Bond Position:  [0.23070932]


portfolio before change:  [7.93722174]
curr_Stock_Price:  98.26000907443513
curr_Factors:  [98.26000907]
mat_Sqrt:  [[0.15]]
grads:  [0.01917185]
Stock Position:  0.019171849693500467
Bond Position:  [6.05339561]


portfolio before change:  [7.93107159]
curr_Stock_Price:  97.91948395108113
curr_Factors:  [97.91948395]
mat_Sqrt:  [[0.15]]
grads:  [-0.16863708]
Stock Position:  -0.16863707805973505
Bond Position:  [24.44392725]


portfolio before change:  [7.84309526]
curr_Stock_Price:  98.45023393776482
curr_Factors:  [98.45023394]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480004]
Stock Position:  -0.024800036882376558
Bond Position:  [10.28466469]


portfolio before change:  [7.84559641]
curr_Stock_Price:  98.37530080211788
curr_Factors:  [98.3753008]
mat_Sqrt:  [[0.15]]
grads:  [0.16582688]
Stock Position:  0.16582688184141636
Bond Position:  [-8.46767297]


portfolio before change:  [7.85058268]
curr_Stock_Price:  98.40856147061378
curr_Factors:  [98.40856147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05694394]
Stock Position:  -0.05694394384996998
Bond Position:  [13.45435428]


portfolio before change:  [7.84750052]
curr_Stock_Price:  98.47745530309295
curr_Factors:  [98.4774553]
mat_Sqrt:  [[0.15]]
grads:  [0.15490818]
Stock Position:  0.15490818010972032
Bond Position:  [-7.40746287]


portfolio before change:  [7.92292348]
curr_Stock_Price:  98.967332232772
curr_Factors:  [98.96733223]
mat_Sqrt:  [[0.15]]
grads:  [-0.09093533]
Stock Position:  -0.0909353334162639
Bond Position:  [16.92255083]


portfolio before change:  [7.93388617]
curr_Stock_Price:  98.85840865584939
curr_Factors:  [98.85840866]
mat_Sqrt:  [[0.15]]
grads:  [0.05321738]
Stock Position:  0.05321737527461232
Bond Position:  [2.67290114]


portfolio before change:  [7.95281412]
curr_Stock_Price:  99.21094164783634
curr_Factors:  [99.21094165]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624478]
Stock Position:  -0.04624478496643243
Bond Position:  [12.54080278]


portfolio before change:  [7.93170353]
curr_Stock_Price:  99.68438761182043
curr_Factors:  [99.68438761]
mat_Sqrt:  [[0.15]]
grads:  [0.07152272]
Stock Position:  0.07152271844939316
Bond Position:  [0.80200514]


portfolio before change:  [7.90552515]
curr_Stock_Price:  99.31767182360353
curr_Factors:  [99.31767182]
mat_Sqrt:  [[0.15]]
grads:  [0.04811456]
Stock Position:  0.04811455505454495
Bond Position:  [3.12689956]


portfolio before change:  [7.93792806]
curr_Stock_Price:  99.9870632706526
curr_Factors:  [99.98706327]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277449]
Stock Position:  -0.08277449219874979
Bond Position:  [16.21430645]


portfolio before change:  [7.92823497]
curr_Stock_Price:  100.11640881233892
curr_Factors:  [100.11640881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00146958]
Stock Position:  -0.0014695820728598842
Bond Position:  [8.07536425]


portfolio before change:  [7.92874978]
curr_Stock_Price:  100.10954732065771
curr_Factors:  [100.10954732]
mat_Sqrt:  [[0.15]]
grads:  [0.07853369]
Stock Position:  0.07853369369008899
Bond Position:  [0.06677726]


portfolio before change:  [7.94468395]
curr_Stock_Price:  100.31239011482391
curr_Factors:  [100.31239011]
mat_Sqrt:  [[0.15]]
grads:  [0.07779888]
Stock Position:  0.07779887797168725
Bond Position:  [0.14049255]


portfolio before change:  [7.88126467]
curr_Stock_Price:  99.49710765859184
curr_Factors:  [99.49710766]
mat_Sqrt:  [[0.15]]
grads:  [-0.05277755]
Stock Position:  -0.052777550051376694
Bond Position:  [13.13247825]


portfolio before change:  [7.88155941]
curr_Stock_Price:  99.50707531766133
curr_Factors:  [99.50707532]
mat_Sqrt:  [[0.15]]
grads:  [0.04954234]
Stock Position:  0.04954234219328687
Bond Position:  [2.95174583]


portfolio before change:  [7.89348992]
curr_Stock_Price:  99.74416578153034
curr_Factors:  [99.74416578]
mat_Sqrt:  [[0.15]]
grads:  [0.26660108]
Stock Position:  0.26660108170854063
Bond Position:  [-18.69841258]


portfolio before change:  [7.93001711]
curr_Stock_Price:  99.88556012289163
curr_Factors:  [99.88556012]
mat_Sqrt:  [[0.15]]
grads:  [-0.02357864]
Stock Position:  -0.023578644315934972
Bond Position:  [10.28518321]


portfolio before change:  [7.9195351]
curr_Stock_Price:  100.35737926782899
curr_Factors:  [100.35737927]
mat_Sqrt:  [[0.15]]
grads:  [0.09693278]
Stock Position:  0.09693278052614765
Bond Position:  [-1.80838472]


portfolio before change:  [7.82373732]
curr_Stock_Price:  99.37025441950279
curr_Factors:  [99.37025442]
mat_Sqrt:  [[0.15]]
grads:  [-0.04418683]
Stock Position:  -0.044186832724085426
Bond Position:  [12.21459413]


portfolio before change:  [7.82833642]
curr_Stock_Price:  99.28344867992523
curr_Factors:  [99.28344868]
mat_Sqrt:  [[0.15]]
grads:  [0.04090899]
Stock Position:  0.04090898518257006
Bond Position:  [3.76675129]


portfolio before change:  [7.86549416]
curr_Stock_Price:  100.18599624361093
curr_Factors:  [100.18599624]
mat_Sqrt:  [[0.15]]
grads:  [0.00235787]
Stock Position:  0.0023578720018550825
Bond Position:  [7.6292684]


portfolio before change:  [7.86587064]
curr_Stock_Price:  100.14343182472241
curr_Factors:  [100.14343182]
mat_Sqrt:  [[0.15]]
grads:  [-0.01918555]
Stock Position:  -0.01918554514810192
Bond Position:  [9.78717697]


portfolio before change:  [7.867872]
curr_Stock_Price:  100.0710000278422
curr_Factors:  [100.07100003]
mat_Sqrt:  [[0.15]]
grads:  [0.02313002]
Stock Position:  0.023130016637207408
Bond Position:  [5.55322811]


portfolio before change:  [7.86567639]
curr_Stock_Price:  99.96106945618128
curr_Factors:  [99.96106946]
mat_Sqrt:  [[0.15]]
grads:  [-0.07566185]
Stock Position:  -0.07566184906299313
Bond Position:  [15.42891574]


portfolio before change:  [7.86337472]
curr_Stock_Price:  100.00423535323696
curr_Factors:  [100.00423535]
mat_Sqrt:  [[0.15]]
grads:  [0.01358615]
Stock Position:  0.013586147346068816
Bond Position:  [6.50470244]


portfolio before change:  [7.85862501]
curr_Stock_Price:  99.6247118655946
curr_Factors:  [99.62471187]
mat_Sqrt:  [[0.15]]
grads:  [0.03110017]
Stock Position:  0.031100167210926958
Bond Position:  [4.76027982]


portfolio before change:  [7.87508156]
curr_Stock_Price:  100.14429180969636
curr_Factors:  [100.14429181]
mat_Sqrt:  [[0.15]]
grads:  [0.07723724]
Stock Position:  0.07723724332540621
Bond Position:  [0.14021253]


portfolio before change:  [7.86971753]
curr_Stock_Price:  100.0747295479578
curr_Factors:  [100.07472955]
mat_Sqrt:  [[0.15]]
grads:  [0.07957276]
Stock Position:  0.07957275660888065
Bond Position:  [-0.09350457]


portfolio before change:  [7.83295689]
curr_Stock_Price:  99.61282779464618
curr_Factors:  [99.61282779]
mat_Sqrt:  [[0.15]]
grads:  [-0.23436134]
Stock Position:  -0.23436133756505897
Bond Position:  [31.17835245]


portfolio before change:  [7.55351768]
curr_Stock_Price:  100.81348621560566
curr_Factors:  [100.81348622]
mat_Sqrt:  [[0.15]]
grads:  [0.06492748]
Stock Position:  0.06492747659654528
Bond Position:  [1.00795242]


portfolio before change:  [7.53816084]
curr_Stock_Price:  100.57599289486393
curr_Factors:  [100.57599289]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050834]
Stock Position:  -0.020508335149619455
Bond Position:  [9.60080701]


portfolio before change:  [7.54148009]
curr_Stock_Price:  100.44340402045664
curr_Factors:  [100.44340402]
mat_Sqrt:  [[0.15]]
grads:  [0.14916018]
Stock Position:  0.14916017914832597
Bond Position:  [-7.44067605]


portfolio before change:  [7.54249216]
curr_Stock_Price:  100.45330696202696
curr_Factors:  [100.45330696]
mat_Sqrt:  [[0.15]]
grads:  [-0.0408818]
Stock Position:  -0.0408817987818179
Bond Position:  [11.64920404]


portfolio before change:  [7.57893044]
curr_Stock_Price:  99.57980847928205
curr_Factors:  [99.57980848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03720368]
Stock Position:  -0.03720368099542388
Bond Position:  [11.28366587]


portfolio before change:  [7.56320701]
curr_Stock_Price:  100.02139615220734
curr_Factors:  [100.02139615]
mat_Sqrt:  [[0.15]]
grads:  [0.15749019]
Stock Position:  0.15749018708273202
Bond Position:  [-8.18918139]


portfolio before change:  [7.53544241]
curr_Stock_Price:  99.848352019014
curr_Factors:  [99.84835202]
mat_Sqrt:  [[0.15]]
grads:  [0.02621112]
Stock Position:  0.02621112252924726
Bond Position:  [4.91830502]


portfolio before change:  [7.53025464]
curr_Stock_Price:  99.63870145511619
curr_Factors:  [99.63870146]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449694]
Stock Position:  -0.054496939888787274
Bond Position:  [12.96025896]


portfolio before change:  [7.52699973]
curr_Stock_Price:  99.71329192852144
curr_Factors:  [99.71329193]
mat_Sqrt:  [[0.15]]
grads:  [-0.02781148]
Stock Position:  -0.02781147515543844
Bond Position:  [10.30017347]


portfolio before change:  [7.52435655]
curr_Stock_Price:  99.8314792107135
curr_Factors:  [99.83147921]
mat_Sqrt:  [[0.15]]
grads:  [0.03185603]
Stock Position:  0.03185602619061797
Bond Position:  [4.34412233]


portfolio before change:  [7.5327337]
curr_Stock_Price:  100.08592504172883
curr_Factors:  [100.08592504]
mat_Sqrt:  [[0.15]]
grads:  [-0.07858339]
Stock Position:  -0.07858339416712294
Bond Position:  [15.3978254]


portfolio before change:  [7.53021372]
curr_Stock_Price:  100.13023936608228
curr_Factors:  [100.13023937]
mat_Sqrt:  [[0.15]]
grads:  [-0.10109877]
Stock Position:  -0.10109877086985924
Bond Position:  [17.65325785]


portfolio before change:  [7.52865402]
curr_Stock_Price:  100.15658058347616
curr_Factors:  [100.15658058]
mat_Sqrt:  [[0.15]]
grads:  [-0.0466684]
Stock Position:  -0.04666839621990262
Bond Position:  [12.20280101]


portfolio before change:  [7.50907134]
curr_Stock_Price:  100.59253686522328
curr_Factors:  [100.59253687]
mat_Sqrt:  [[0.15]]
grads:  [0.23168082]
Stock Position:  0.23168081911819993
Bond Position:  [-15.79629]


portfolio before change:  [7.22280115]
curr_Stock_Price:  99.3611751530249
curr_Factors:  [99.36117515]
mat_Sqrt:  [[0.15]]
grads:  [-0.06013188]
Stock Position:  -0.0601318837560141
Bond Position:  [13.19757578]


portfolio before change:  [7.15334221]
curr_Stock_Price:  100.53000290078668
curr_Factors:  [100.5300029]
mat_Sqrt:  [[0.15]]
grads:  [0.00584186]
Stock Position:  0.005841864489741523
Bond Position:  [6.56605956]


portfolio before change:  [7.15361403]
curr_Stock_Price:  100.506283430416
curr_Factors:  [100.50628343]
mat_Sqrt:  [[0.15]]
grads:  [0.03560182]
Stock Position:  0.03560181699264734
Bond Position:  [3.57540773]


portfolio before change:  [7.1644805]
curr_Stock_Price:  100.80522882091914
curr_Factors:  [100.80522882]
mat_Sqrt:  [[0.15]]
grads:  [0.03131973]
Stock Position:  0.03131973042089248
Bond Position:  [4.00728791]


portfolio before change:  [7.15935141]
curr_Stock_Price:  100.63346626269464
curr_Factors:  [100.63346626]
mat_Sqrt:  [[0.15]]
grads:  [-0.02405434]
Stock Position:  -0.02405433827097231
Bond Position:  [9.58002285]


portfolio before change:  [7.17958121]
curr_Stock_Price:  99.81735431371952
curr_Factors:  [99.81735431]
mat_Sqrt:  [[0.15]]
grads:  [0.04179801]
Stock Position:  0.04179801386260909
Bond Position:  [3.00741405]


portfolio before change:  [7.21114014]
curr_Stock_Price:  100.56789134140516
curr_Factors:  [100.56789134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213868]
Stock Position:  -0.0021386775733603864
Bond Position:  [7.42622243]


portfolio before change:  [7.20871882]
curr_Stock_Price:  101.91707827062774
curr_Factors:  [101.91707827]
mat_Sqrt:  [[0.15]]
grads:  [0.0108511]
Stock Position:  0.010851098428540696
Bond Position:  [6.10280657]


portfolio before change:  [7.21373701]
curr_Stock_Price:  102.34438571155141
curr_Factors:  [102.34438571]
mat_Sqrt:  [[0.15]]
grads:  [0.10485259]
Stock Position:  0.10485258527819451
Bond Position:  [-3.51733642]


portfolio before change:  [7.15519954]
curr_Stock_Price:  101.78819888518866
curr_Factors:  [101.78819889]
mat_Sqrt:  [[0.15]]
grads:  [-0.00797091]
Stock Position:  -0.007970911513224729
Bond Position:  [7.96654427]


portfolio before change:  [7.15111663]
curr_Stock_Price:  102.36289265209017
curr_Factors:  [102.36289265]
mat_Sqrt:  [[0.15]]
grads:  [0.06518444]
Stock Position:  0.06518443572387268
Bond Position:  [0.47864924]


portfolio before change:  [7.21746664]
curr_Stock_Price:  103.38031480218838
curr_Factors:  [103.3803148]
mat_Sqrt:  [[0.15]]
grads:  [0.02193406]
Stock Position:  0.021934061410022184
Bond Position:  [4.94991647]


portfolio before change:  [7.21114846]
curr_Stock_Price:  103.07815654085107
curr_Factors:  [103.07815654]
mat_Sqrt:  [[0.15]]
grads:  [-0.08319988]
Stock Position:  -0.0831998786469365
Bond Position:  [15.78723858]


portfolio before change:  [7.24239078]
curr_Stock_Price:  102.71450709819926
curr_Factors:  [102.7145071]
mat_Sqrt:  [[0.15]]
grads:  [0.01668746]
Stock Position:  0.01668746493001332
Bond Position:  [5.52834605]


portfolio before change:  [7.25353376]
curr_Stock_Price:  103.36154644047792
curr_Factors:  [103.36154644]
mat_Sqrt:  [[0.15]]
grads:  [0.01824834]
Stock Position:  0.018248343815196282
Bond Position:  [5.36735673]


portfolio before change:  [7.25231904]
curr_Stock_Price:  103.27659690038283
curr_Factors:  [103.2765969]
mat_Sqrt:  [[0.15]]
grads:  [-0.03614509]
Stock Position:  -0.036145090508263526
Bond Position:  [10.98526099]


portfolio before change:  [7.2467468]
curr_Stock_Price:  103.44975588093423
curr_Factors:  [103.44975588]
mat_Sqrt:  [[0.15]]
grads:  [0.10010768]
Stock Position:  0.10010768310533227
Bond Position:  [-3.10936858]


portfolio before change:  [7.26700804]
curr_Stock_Price:  103.65409164639998
curr_Factors:  [103.65409165]
mat_Sqrt:  [[0.15]]
grads:  [-0.05599887]
Stock Position:  -0.05599887472542433
Bond Position:  [13.07152053]


portfolio before change:  [7.25424706]
curr_Stock_Price:  103.89656025485164
curr_Factors:  [103.89656025]
mat_Sqrt:  [[0.15]]
grads:  [0.002778]
Stock Position:  0.002777997780895857
Bond Position:  [6.96562265]


portfolio before change:  [7.25386693]
curr_Stock_Price:  103.60300333801148
curr_Factors:  [103.60300334]
mat_Sqrt:  [[0.15]]
grads:  [-0.08831288]
Stock Position:  -0.08831287533179653
Bond Position:  [16.40334604]


portfolio before change:  [7.22874148]
curr_Stock_Price:  103.89911743303098
curr_Factors:  [103.89911743]
mat_Sqrt:  [[0.15]]
grads:  [0.08823621]
Stock Position:  0.08823620627998262
Bond Position:  [-1.93892248]


portfolio before change:  [7.20991073]
curr_Stock_Price:  103.68707791469353
curr_Factors:  [103.68707791]
mat_Sqrt:  [[0.15]]
grads:  [-0.00137113]
Stock Position:  -0.0013711293334682149
Bond Position:  [7.35207913]


portfolio before change:  [7.21065218]
curr_Stock_Price:  103.48145986568127
curr_Factors:  [103.48145987]
mat_Sqrt:  [[0.15]]
grads:  [0.15527178]
Stock Position:  0.1552717824931665
Bond Position:  [-8.85709855]


portfolio before change:  [7.2996233]
curr_Stock_Price:  104.05802762416276
curr_Factors:  [104.05802762]
mat_Sqrt:  [[0.15]]
grads:  [-0.16130819]
Stock Position:  -0.16130818947106665
Bond Position:  [24.08503533]


portfolio before change:  [7.31530802]
curr_Stock_Price:  103.97012530575728
curr_Factors:  [103.97012531]
mat_Sqrt:  [[0.15]]
grads:  [0.00232489]
Stock Position:  0.002324886153915867
Bond Position:  [7.07358932]


portfolio before change:  [7.31638582]
curr_Stock_Price:  104.24355229826368
curr_Factors:  [104.2435523]
mat_Sqrt:  [[0.15]]
grads:  [-0.02143779]
Stock Position:  -0.021437786853505687
Bond Position:  [9.55113688]


portfolio before change:  [7.32457475]
curr_Stock_Price:  103.88941313687866
curr_Factors:  [103.88941314]
mat_Sqrt:  [[0.15]]
grads:  [-0.05230969]
Stock Position:  -0.05230969431610666
Bond Position:  [12.75899819]


portfolio before change:  [7.30276502]
curr_Stock_Price:  104.32159291884341
curr_Factors:  [104.32159292]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.30276502]
Stock Price:  104.5670025423469
PL:  [2.73576248]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.42980465e-03]
 [-1.59365151e-02]
 [-4.45895873e-03]
 [ 6.01384317e-03]
 [-8.26371574e-03]
 [ 1.28650947e-02]
 [ 3.40222521e-03]
 [-2.09958445e-02]
 [-8.84826430e-04]
 [ 2.50547692e-02]
 [-1.26717574e-02]
 [ 2.39397840e-02]
 [-1.13845117e-02]
 [ 3.23422258e-03]
 [-7.00212936e-03]
 [ 1.00630889e-02]
 [ 1.34060407e-02]
 [ 2.69349793e-02]
 [ 9.31969359e-04]
 [ 1.15171281e-02]
 [ 1.31948542e-02]
 [-1.10668100e-02]
 [-3.50965148e-04]
 [-7.41466801e-02]
 [-1.21472740e-02]
 [-4.07634211e-03]
 [-2.33456071e-04]
 [ 1.01070815e-02]
 [-3.59796185e-02]
 [ 4.80412224e-03]
 [ 5.86640382e-03]
 [-1.04879621e-02]
 [-8.27041655e-03]
 [ 5.52742089e-03]
 [ 1.34980778e-02]
 [ 1.23406050e-02]
 [-3.43671777e-02]
 [ 8.68267367e-03]
 [-3.08470243e-02]
 [ 1.23019218e-02]
 [-1.21911706e-02]
 [ 3.28442664e-02]
 [ 2.32510156e-02]
 [ 4.11805279e-03]
 [ 5.24642679e-03]
 [ 1.33281852e-02]
 [-6.84520320e-04]
 [-7.79271281e-03]
 [ 1.60620940e-02]
 [ 4.61260235e-03]
 [ 3.42765845e-02]
 [ 8.20218436e-03]
 [ 5.67428405e-04]
 [ 4.62472780e-03]
 [ 3.42016095e-03]
 [ 3.16953512e-03]
 [-1.00072773e-03]
 [-3.43941634e-04]
 [ 1.55842890e-03]
 [-1.69357235e-02]
 [-4.38027006e-03]
 [ 2.82437029e-03]
 [ 1.25481303e-02]
 [-1.87483691e-02]
 [-6.42576868e-03]
 [-7.69363648e-03]
 [-4.83748769e-03]
 [ 2.02651347e-02]
 [-9.51789812e-03]
 [ 7.55063238e-03]
 [-3.71667157e-03]
 [ 1.14964440e-02]
 [-1.98478492e-03]
 [ 7.59567564e-03]
 [-1.38468636e-02]
 [-5.45116959e-03]
 [-1.91128388e-04]
 [ 8.77976641e-04]
 [-9.71858763e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.22594077]
curr_Stock_Price:  99.65747988961495
curr_Factors:  [99.65747989]
mat_Sqrt:  [[0.15]]
grads:  [0.02286536]
Stock Position:  0.02286536435072957
Bond Position:  [-5.50464536]


portfolio before change:  [-3.24094181]
curr_Stock_Price:  99.01646711932968
curr_Factors:  [99.01646712]
mat_Sqrt:  [[0.15]]
grads:  [-0.10624343]
Stock Position:  -0.10624343377162791
Bond Position:  [7.27890765]


portfolio before change:  [-3.21500977]
curr_Stock_Price:  98.77666783547856
curr_Factors:  [98.77666784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02972639]
Stock Position:  -0.029726391506126482
Bond Position:  [-0.27873587]


portfolio before change:  [-3.20731981]
curr_Stock_Price:  98.51739052381019
curr_Factors:  [98.51739052]
mat_Sqrt:  [[0.15]]
grads:  [0.04009229]
Stock Position:  0.04009228783145156
Bond Position:  [-7.15710739]


portfolio before change:  [-3.23590595]
curr_Stock_Price:  97.81553970161656
curr_Factors:  [97.8155397]
mat_Sqrt:  [[0.15]]
grads:  [-0.05509144]
Stock Position:  -0.05509143825011712
Bond Position:  [2.15289282]


portfolio before change:  [-3.25658799]
curr_Stock_Price:  98.19339514457455
curr_Factors:  [98.19339514]
mat_Sqrt:  [[0.15]]
grads:  [0.0857673]
Stock Position:  0.08576729827144743
Bond Position:  [-11.6783702]


portfolio before change:  [-3.27146566]
curr_Stock_Price:  98.0284400987012
curr_Factors:  [98.0284401]
mat_Sqrt:  [[0.15]]
grads:  [0.0226815]
Stock Position:  0.022681501423339273
Bond Position:  [-5.49489786]


portfolio before change:  [-3.25827025]
curr_Stock_Price:  98.62535164877903
curr_Factors:  [98.62535165]
mat_Sqrt:  [[0.15]]
grads:  [-0.1399723]
Stock Position:  -0.13997229636145295
Bond Position:  [10.5465467]


portfolio before change:  [-3.26374611]
curr_Stock_Price:  98.66918200557424
curr_Factors:  [98.66918201]
mat_Sqrt:  [[0.15]]
grads:  [-0.00589884]
Stock Position:  -0.005898842869787198
Bond Position:  [-2.6817121]


portfolio before change:  [-3.26205292]
curr_Stock_Price:  98.35373088283812
curr_Factors:  [98.35373088]
mat_Sqrt:  [[0.15]]
grads:  [0.16703179]
Stock Position:  0.16703179453491582
Bond Position:  [-19.69025309]


portfolio before change:  [-3.26966243]
curr_Stock_Price:  98.31554156187664
curr_Factors:  [98.31554156]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447838]
Stock Position:  -0.0844783827968598
Bond Position:  [5.03587552]


portfolio before change:  [-3.27533516]
curr_Stock_Price:  98.3864174765486
curr_Factors:  [98.38641748]
mat_Sqrt:  [[0.15]]
grads:  [0.15959856]
Stock Position:  0.15959855967983264
Bond Position:  [-18.97766568]


portfolio before change:  [-3.43062094]
curr_Stock_Price:  97.42087216998783
curr_Factors:  [97.42087217]
mat_Sqrt:  [[0.15]]
grads:  [-0.07589674]
Stock Position:  -0.07589674490074208
Bond Position:  [3.96330614]


portfolio before change:  [-3.44778691]
curr_Stock_Price:  97.65031125290854
curr_Factors:  [97.65031125]
mat_Sqrt:  [[0.15]]
grads:  [0.02156148]
Stock Position:  0.021561483886464863
Bond Position:  [-5.55327252]


portfolio before change:  [-3.441261]
curr_Stock_Price:  97.96907390262767
curr_Factors:  [97.9690739]
mat_Sqrt:  [[0.15]]
grads:  [-0.04668086]
Stock Position:  -0.04668086242302422
Bond Position:  [1.13201986]


portfolio before change:  [-3.42173624]
curr_Stock_Price:  97.55232911334252
curr_Factors:  [97.55232911]
mat_Sqrt:  [[0.15]]
grads:  [0.06708726]
Stock Position:  0.06708725902717613
Bond Position:  [-9.96625461]


portfolio before change:  [-3.46788994]
curr_Stock_Price:  96.8736490128073
curr_Factors:  [96.87364901]
mat_Sqrt:  [[0.15]]
grads:  [0.0893736]
Stock Position:  0.08937360461784667
Bond Position:  [-12.12583715]


portfolio before change:  [-3.54814659]
curr_Stock_Price:  95.98413853090581
curr_Factors:  [95.98413853]
mat_Sqrt:  [[0.15]]
grads:  [0.17956653]
Stock Position:  0.1795665285428929
Bond Position:  [-20.78368514]


portfolio before change:  [-3.61520732]
curr_Stock_Price:  95.61791377167654
curr_Factors:  [95.61791377]
mat_Sqrt:  [[0.15]]
grads:  [0.00621313]
Stock Position:  0.006213129063259484
Bond Position:  [-4.20929376]


portfolio before change:  [-3.61071223]
curr_Stock_Price:  96.38374028211254
curr_Factors:  [96.38374028]
mat_Sqrt:  [[0.15]]
grads:  [0.07678085]
Stock Position:  0.07678085371063957
Bond Position:  [-11.01113809]


portfolio before change:  [-3.64731697]
curr_Stock_Price:  95.91596058982073
curr_Factors:  [95.91596059]
mat_Sqrt:  [[0.15]]
grads:  [0.08796569]
Stock Position:  0.087965694384187
Bond Position:  [-12.08463104]


portfolio before change:  [-3.63388308]
curr_Stock_Price:  96.07726435933361
curr_Factors:  [96.07726436]
mat_Sqrt:  [[0.15]]
grads:  [-0.07377873]
Stock Position:  -0.07377873318742753
Bond Position:  [3.45457577]


portfolio before change:  [-3.61265191]
curr_Stock_Price:  95.7924227053332
curr_Factors:  [95.79242271]
mat_Sqrt:  [[0.15]]
grads:  [-0.00233977]
Stock Position:  -0.0023397676552740568
Bond Position:  [-3.3885199]


portfolio before change:  [-3.61344412]
curr_Stock_Price:  96.04049123240084
curr_Factors:  [96.04049123]
mat_Sqrt:  [[0.15]]
grads:  [-0.4943112]
Stock Position:  -0.4943112003870425
Bond Position:  [43.86044639]


portfolio before change:  [-3.71317714]
curr_Stock_Price:  96.2477986627979
curr_Factors:  [96.24779866]
mat_Sqrt:  [[0.15]]
grads:  [-0.08098183]
Stock Position:  -0.08098182640434276
Bond Position:  [4.08114538]


portfolio before change:  [-3.76787698]
curr_Stock_Price:  96.92640664596054
curr_Factors:  [96.92640665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02717561]
Stock Position:  -0.027175614082379253
Bond Position:  [-1.13384236]


portfolio before change:  [-3.758896]
curr_Stock_Price:  96.59331944207418
curr_Factors:  [96.59331944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00155637]
Stock Position:  -0.0015563738059057772
Bond Position:  [-3.60856068]


portfolio before change:  [-3.75952943]
curr_Stock_Price:  96.85539653899002
curr_Factors:  [96.85539654]
mat_Sqrt:  [[0.15]]
grads:  [0.06738054]
Stock Position:  0.06738054308799159
Bond Position:  [-10.28569865]


portfolio before change:  [-3.76449942]
curr_Stock_Price:  96.79117749878355
curr_Factors:  [96.7911775]
mat_Sqrt:  [[0.15]]
grads:  [-0.23986412]
Stock Position:  -0.23986412330695633
Bond Position:  [19.45223152]


portfolio before change:  [-3.60462135]
curr_Stock_Price:  96.12971024423491
curr_Factors:  [96.12971024]
mat_Sqrt:  [[0.15]]
grads:  [0.03202748]
Stock Position:  0.032027481604430946
Bond Position:  [-6.68341388]


portfolio before change:  [-3.58365392]
curr_Stock_Price:  96.79742309609131
curr_Factors:  [96.7974231]
mat_Sqrt:  [[0.15]]
grads:  [0.03910936]
Stock Position:  0.03910935883190665
Bond Position:  [-7.36933907]


portfolio before change:  [-3.59175675]
curr_Stock_Price:  96.6020163829133
curr_Factors:  [96.60201638]
mat_Sqrt:  [[0.15]]
grads:  [-0.06991975]
Stock Position:  -0.06991974711881621
Bond Position:  [3.16263181]


portfolio before change:  [-3.62360704]
curr_Stock_Price:  97.06036997661408
curr_Factors:  [97.06036998]
mat_Sqrt:  [[0.15]]
grads:  [-0.05513611]
Stock Position:  -0.05513611034277563
Bond Position:  [1.72792423]


portfolio before change:  [-3.63244662]
curr_Stock_Price:  97.22265156241754
curr_Factors:  [97.22265156]
mat_Sqrt:  [[0.15]]
grads:  [0.03684947]
Stock Position:  0.03684947261342833
Bond Position:  [-7.21505006]


portfolio before change:  [-3.61873584]
curr_Stock_Price:  97.60696467452252
curr_Factors:  [97.60696467]
mat_Sqrt:  [[0.15]]
grads:  [0.08998719]
Stock Position:  0.0899871851912445
Bond Position:  [-12.40211185]


portfolio before change:  [-3.67304802]
curr_Stock_Price:  97.0120241008801
curr_Factors:  [97.0120241]
mat_Sqrt:  [[0.15]]
grads:  [0.0822707]
Stock Position:  0.08227069982529016
Bond Position:  [-11.65429514]


portfolio before change:  [-3.61803458]
curr_Stock_Price:  97.68956612215425
curr_Factors:  [97.68956612]
mat_Sqrt:  [[0.15]]
grads:  [-0.22911452]
Stock Position:  -0.22911451774223573
Bond Position:  [18.76406325]


portfolio before change:  [-3.58201374]
curr_Stock_Price:  97.53746728435105
curr_Factors:  [97.53746728]
mat_Sqrt:  [[0.15]]
grads:  [0.05788449]
Stock Position:  0.057884491107016656
Bond Position:  [-9.2279204]


portfolio before change:  [-3.6250531]
curr_Stock_Price:  96.80389265874364
curr_Factors:  [96.80389266]
mat_Sqrt:  [[0.15]]
grads:  [-0.20564683]
Stock Position:  -0.20564682883803215
Bond Position:  [16.28236045]


portfolio before change:  [-3.61647266]
curr_Stock_Price:  96.76711719143775
curr_Factors:  [96.76711719]
mat_Sqrt:  [[0.15]]
grads:  [0.08201281]
Stock Position:  0.08201281187483224
Bond Position:  [-11.55261604]


portfolio before change:  [-3.65441693]
curr_Stock_Price:  96.31325867883344
curr_Factors:  [96.31325868]
mat_Sqrt:  [[0.15]]
grads:  [-0.08127447]
Stock Position:  -0.08127447052864593
Bond Position:  [4.17339217]


portfolio before change:  [-3.69799249]
curr_Stock_Price:  96.85262111888461
curr_Factors:  [96.85262112]
mat_Sqrt:  [[0.15]]
grads:  [0.21896178]
Stock Position:  0.21896177631229763
Bond Position:  [-24.90501445]


portfolio before change:  [-3.85391343]
curr_Stock_Price:  96.14763812530688
curr_Factors:  [96.14763813]
mat_Sqrt:  [[0.15]]
grads:  [0.15500677]
Stock Position:  0.15500677036707688
Bond Position:  [-18.75744829]


portfolio before change:  [-3.78712188]
curr_Stock_Price:  96.58609588748578
curr_Factors:  [96.58609589]
mat_Sqrt:  [[0.15]]
grads:  [0.02745369]
Stock Position:  0.027453685299414107
Bond Position:  [-6.43876616]


portfolio before change:  [-3.79555215]
curr_Stock_Price:  96.29368212918477
curr_Factors:  [96.29368213]
mat_Sqrt:  [[0.15]]
grads:  [0.03497618]
Stock Position:  0.03497617858192513
Bond Position:  [-7.16353717]


portfolio before change:  [-3.81145154]
curr_Stock_Price:  95.85190564895393
curr_Factors:  [95.85190565]
mat_Sqrt:  [[0.15]]
grads:  [0.08885457]
Stock Position:  0.08885456767522121
Bond Position:  [-12.32833118]


portfolio before change:  [-3.81359801]
curr_Stock_Price:  95.83642051644969
curr_Factors:  [95.83642052]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456347]
Stock Position:  -0.004563468802907094
Bond Position:  [-3.37625149]


portfolio before change:  [-3.81153257]
curr_Stock_Price:  95.33757604330302
curr_Factors:  [95.33757604]
mat_Sqrt:  [[0.15]]
grads:  [-0.05195142]
Stock Position:  -0.05195141870737238
Bond Position:  [1.14138976]


portfolio before change:  [-3.79594138]
curr_Stock_Price:  95.03883823346001
curr_Factors:  [95.03883823]
mat_Sqrt:  [[0.15]]
grads:  [0.10708063]
Stock Position:  0.10708062641868646
Bond Position:  [-13.97275971]


portfolio before change:  [-3.7527642]
curr_Stock_Price:  95.45021518051635
curr_Factors:  [95.45021518]
mat_Sqrt:  [[0.15]]
grads:  [0.03075068]
Stock Position:  0.030750682346112636
Bond Position:  [-6.68792345]


portfolio before change:  [-3.75686494]
curr_Stock_Price:  95.33045436605788
curr_Factors:  [95.33045437]
mat_Sqrt:  [[0.15]]
grads:  [0.22851056]
Stock Position:  0.2285105634892681
Bond Position:  [-25.54088078]


portfolio before change:  [-3.8993274]
curr_Stock_Price:  94.71400097430582
curr_Factors:  [94.71400097]
mat_Sqrt:  [[0.15]]
grads:  [0.05468123]
Stock Position:  0.05468122905178341
Bond Position:  [-9.07840539]


portfolio before change:  [-3.89343711]
curr_Stock_Price:  94.83209834015923
curr_Factors:  [94.83209834]
mat_Sqrt:  [[0.15]]
grads:  [0.00378286]
Stock Position:  0.003782856032890734
Bond Position:  [-4.25217329]


portfolio before change:  [-3.89329659]
curr_Stock_Price:  94.93950309465536
curr_Factors:  [94.93950309]
mat_Sqrt:  [[0.15]]
grads:  [0.03083152]
Stock Position:  0.030831518677012615
Bond Position:  [-6.82042565]


portfolio before change:  [-3.87365664]
curr_Stock_Price:  95.59033822654104
curr_Factors:  [95.59033823]
mat_Sqrt:  [[0.15]]
grads:  [0.02280107]
Stock Position:  0.022801072979906467
Bond Position:  [-6.05321892]


portfolio before change:  [-3.86907207]
curr_Stock_Price:  95.80799933077968
curr_Factors:  [95.80799933]
mat_Sqrt:  [[0.15]]
grads:  [0.02113023]
Stock Position:  0.021130234124791536
Bond Position:  [-5.89351753]


portfolio before change:  [-3.84754191]
curr_Stock_Price:  96.84435860812515
curr_Factors:  [96.84435861]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667152]
Stock Position:  -0.006671518226127651
Bond Position:  [-3.20144301]


portfolio before change:  [-3.84245697]
curr_Stock_Price:  96.0521786952235
curr_Factors:  [96.0521787]
mat_Sqrt:  [[0.15]]
grads:  [-0.00229294]
Stock Position:  -0.0022929442257895154
Bond Position:  [-3.62221468]


portfolio before change:  [-3.84291645]
curr_Stock_Price:  96.15383160941471
curr_Factors:  [96.15383161]
mat_Sqrt:  [[0.15]]
grads:  [0.01038953]
Stock Position:  0.010389526030535586
Bond Position:  [-4.84190918]


portfolio before change:  [-3.83799447]
curr_Stock_Price:  96.65670421489546
curr_Factors:  [96.65670421]
mat_Sqrt:  [[0.15]]
grads:  [-0.11290482]
Stock Position:  -0.11290482305230393
Bond Position:  [7.07501362]


portfolio before change:  [-3.87623132]
curr_Stock_Price:  96.99928524250123
curr_Factors:  [96.99928524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0292018]
Stock Position:  -0.029201800407993653
Bond Position:  [-1.04367755]


portfolio before change:  [-3.89993367]
curr_Stock_Price:  97.80872581669848
curr_Factors:  [97.80872582]
mat_Sqrt:  [[0.15]]
grads:  [0.01882914]
Stock Position:  0.018829135236692607
Bond Position:  [-5.7415874]


portfolio before change:  [-3.90913929]
curr_Stock_Price:  97.33888163458519
curr_Factors:  [97.33888163]
mat_Sqrt:  [[0.15]]
grads:  [0.0836542]
Stock Position:  0.08365420219100624
Bond Position:  [-12.05194578]


portfolio before change:  [-3.98407537]
curr_Stock_Price:  96.45210234486055
curr_Factors:  [96.45210234]
mat_Sqrt:  [[0.15]]
grads:  [-0.12498913]
Stock Position:  -0.1249891272175456
Bond Position:  [8.07138872]


portfolio before change:  [-4.00718436]
curr_Stock_Price:  96.64102645157826
curr_Factors:  [96.64102645]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283846]
Stock Position:  -0.04283845784326337
Bond Position:  [0.13276818]


portfolio before change:  [-4.04586666]
curr_Stock_Price:  97.54420100031787
curr_Factors:  [97.544201]
mat_Sqrt:  [[0.15]]
grads:  [-0.05129091]
Stock Position:  -0.051290909890607944
Bond Position:  [0.95726416]


portfolio before change:  [-4.08097615]
curr_Stock_Price:  98.22988432414401
curr_Factors:  [98.22988432]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224992]
Stock Position:  -0.03224991796465915
Bond Position:  [-0.91307044]


portfolio before change:  [-4.08820654]
curr_Stock_Price:  98.45231337918801
curr_Factors:  [98.45231338]
mat_Sqrt:  [[0.15]]
grads:  [0.1351009]
Stock Position:  0.13510089810360565
Bond Position:  [-17.3892025]


portfolio before change:  [-4.08064817]
curr_Stock_Price:  98.51630431509057
curr_Factors:  [98.51630432]
mat_Sqrt:  [[0.15]]
grads:  [-0.06345265]
Stock Position:  -0.063452654125696
Bond Position:  [2.17047282]


portfolio before change:  [-4.02884301]
curr_Stock_Price:  97.70200426350127
curr_Factors:  [97.70200426]
mat_Sqrt:  [[0.15]]
grads:  [0.05033755]
Stock Position:  0.05033754917679137
Bond Position:  [-8.94692245]


portfolio before change:  [-4.03615453]
curr_Stock_Price:  97.56786351369388
curr_Factors:  [97.56786351]
mat_Sqrt:  [[0.15]]
grads:  [-0.02477781]
Stock Position:  -0.024777810453394934
Bond Position:  [-1.6186365]


portfolio before change:  [-4.03314944]
curr_Stock_Price:  97.44249901082335
curr_Factors:  [97.44249901]
mat_Sqrt:  [[0.15]]
grads:  [0.07664296]
Stock Position:  0.0766429603000962
Bond Position:  [-11.50143102]


portfolio before change:  [-3.99624624]
curr_Stock_Price:  97.93337332867776
curr_Factors:  [97.93337333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132319]
Stock Position:  -0.013231899444998583
Bond Position:  [-2.70040169]


portfolio before change:  [-4.002338]
curr_Stock_Price:  98.38100213637337
curr_Factors:  [98.38100214]
mat_Sqrt:  [[0.15]]
grads:  [0.05063784]
Stock Position:  0.05063783757628354
Bond Position:  [-8.9841392]


portfolio before change:  [-4.02130166]
curr_Stock_Price:  98.01759525925785
curr_Factors:  [98.01759526]
mat_Sqrt:  [[0.15]]
grads:  [-0.09231242]
Stock Position:  -0.09231242417012238
Bond Position:  [5.02694017]


portfolio before change:  [-4.10220294]
curr_Stock_Price:  98.89738444000383
curr_Factors:  [98.89738444]
mat_Sqrt:  [[0.15]]
grads:  [-0.03634113]
Stock Position:  -0.03634113057546232
Bond Position:  [-0.50816018]


portfolio before change:  [-4.08545802]
curr_Stock_Price:  98.43574000759484
curr_Factors:  [98.43574001]
mat_Sqrt:  [[0.15]]
grads:  [-0.00127419]
Stock Position:  -0.0012741892510188292
Bond Position:  [-3.96003226]


portfolio before change:  [-4.08592493]
curr_Stock_Price:  98.6079278940401
curr_Factors:  [98.60792789]
mat_Sqrt:  [[0.15]]
grads:  [0.00585318]
Stock Position:  0.005853177608942141
Bond Position:  [-4.66309465]


portfolio before change:  [-4.08984869]
curr_Stock_Price:  97.98735803906256
curr_Factors:  [97.98735804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.08984869]
Stock Price:  97.51909424995344
PL:  [-4.08984869]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.50305807e-03]
 [-1.77966508e-03]
 [-3.50033758e-03]
 [ 6.64414041e-03]
 [ 1.57220194e-03]
 [ 1.84231023e-02]
 [ 8.09573417e-04]
 [-1.75586016e-02]
 [ 3.81706339e-03]
 [ 1.92005858e-02]
 [ 1.51907128e-02]
 [ 2.00880370e-02]
 [-1.41927317e-02]
 [ 3.96863915e-03]
 [-7.00694926e-03]
 [ 9.51554945e-03]
 [ 7.34107587e-03]
 [-1.17586075e-02]
 [-2.93035014e-04]
 [ 1.49277658e-02]
 [ 1.14926127e-02]
 [-8.83942752e-03]
 [ 7.82330681e-03]
 [ 3.80729715e-02]
 [-8.03413720e-03]
 [ 3.03155369e-03]
 [-5.92020926e-03]
 [ 6.65746158e-03]
 [-1.60728954e-02]
 [ 1.85507008e-03]
 [ 1.01652195e-03]
 [-1.03893793e-02]
 [-7.44056568e-03]
 [ 5.88514429e-03]
 [ 1.37710190e-02]
 [ 7.07202935e-03]
 [-3.20823789e-02]
 [ 7.96531902e-03]
 [-4.05939514e-02]
 [-5.12721209e-03]
 [-1.51437225e-02]
 [ 6.39405154e-02]
 [ 2.36269459e-02]
 [ 2.55511694e-03]
 [ 1.29016608e-02]
 [ 3.93005343e-02]
 [-6.00748185e-03]
 [ 1.14567351e-02]
 [ 5.52951746e-02]
 [ 1.37725445e-02]
 [ 2.67190815e-02]
 [ 3.95433986e-02]
 [-4.28050921e-03]
 [ 3.68742636e-03]
 [ 5.96880279e-03]
 [ 1.27329594e-02]
 [-5.22051099e-02]
 [ 2.26121373e-03]
 [ 1.68323025e-03]
 [-1.75226621e-01]
 [-2.21855045e-02]
 [ 1.63057015e-02]
 [ 2.13551919e-02]
 [-2.07161678e-02]
 [-9.22418294e-03]
 [-1.37622527e-02]
 [-3.04508847e-03]
 [-1.65553188e-02]
 [-2.41608562e-02]
 [ 1.75125967e-02]
 [ 1.61902123e-02]
 [ 1.32910860e-02]
 [ 1.98020572e-03]
 [ 7.30363246e-03]
 [ 2.65719605e-02]
 [-2.53287266e-02]
 [ 4.58157697e-03]
 [ 1.10367810e-02]
 [ 9.49965119e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.20364791]
curr_Stock_Price:  100.0105386705048
curr_Factors:  [100.01053867]
mat_Sqrt:  [[0.15]]
grads:  [0.01002039]
Stock Position:  0.010020387129263205
Bond Position:  [1.2015036]


portfolio before change:  [2.19912366]
curr_Stock_Price:  99.55154010856937
curr_Factors:  [99.55154011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01186443]
Stock Position:  -0.011864433846932422
Bond Position:  [3.38024633]


portfolio before change:  [2.20661653]
curr_Stock_Price:  98.93780756287457
curr_Factors:  [98.93780756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333558]
Stock Position:  -0.02333558385009236
Bond Position:  [4.51538803]


portfolio before change:  [2.21158261]
curr_Stock_Price:  98.73708977224906
curr_Factors:  [98.73708977]
mat_Sqrt:  [[0.15]]
grads:  [0.04429427]
Stock Position:  0.04429426942057445
Bond Position:  [-2.16190464]


portfolio before change:  [2.22964497]
curr_Stock_Price:  99.147921347605
curr_Factors:  [99.14792135]
mat_Sqrt:  [[0.15]]
grads:  [0.01048135]
Stock Position:  0.010481346286055218
Bond Position:  [1.19044128]


portfolio before change:  [2.22899109]
curr_Stock_Price:  99.07843725817403
curr_Factors:  [99.07843726]
mat_Sqrt:  [[0.15]]
grads:  [0.12282068]
Stock Position:  0.12282068217657696
Bond Position:  [-9.93989016]


portfolio before change:  [2.32170278]
curr_Stock_Price:  99.83834956886751
curr_Factors:  [99.83834957]
mat_Sqrt:  [[0.15]]
grads:  [0.00539716]
Stock Position:  0.00539715611302002
Bond Position:  [1.78285962]


portfolio before change:  [2.31904348]
curr_Stock_Price:  99.32498142246622
curr_Factors:  [99.32498142]
mat_Sqrt:  [[0.15]]
grads:  [-0.11705734]
Stock Position:  -0.11705734376543316
Bond Position:  [13.94576198]


portfolio before change:  [2.35444013]
curr_Stock_Price:  99.0300403984534
curr_Factors:  [99.0300404]
mat_Sqrt:  [[0.15]]
grads:  [0.02544709]
Stock Position:  0.02544708925637698
Bond Position:  [-0.16558614]


portfolio before change:  [2.3566012]
curr_Stock_Price:  99.11537109161003
curr_Factors:  [99.11537109]
mat_Sqrt:  [[0.15]]
grads:  [0.12800391]
Stock Position:  0.12800390530823308
Bond Position:  [-10.33055337]


portfolio before change:  [2.34910545]
curr_Stock_Price:  99.06185656821542
curr_Factors:  [99.06185657]
mat_Sqrt:  [[0.15]]
grads:  [0.10127142]
Stock Position:  0.10127141842384363
Bond Position:  [-7.68302927]


portfolio before change:  [2.33069652]
curr_Stock_Price:  98.88482016785571
curr_Factors:  [98.88482017]
mat_Sqrt:  [[0.15]]
grads:  [0.13392025]
Stock Position:  0.13392024672212663
Bond Position:  [-10.91198299]


portfolio before change:  [2.3035979]
curr_Stock_Price:  98.68756392079408
curr_Factors:  [98.68756392]
mat_Sqrt:  [[0.15]]
grads:  [-0.09461821]
Stock Position:  -0.09461821147230193
Bond Position:  [11.64123869]


portfolio before change:  [2.38405432]
curr_Stock_Price:  97.84492676343055
curr_Factors:  [97.84492676]
mat_Sqrt:  [[0.15]]
grads:  [0.02645759]
Stock Position:  0.026457594366228472
Bond Position:  [-0.20468707]


portfolio before change:  [2.38486639]
curr_Stock_Price:  97.87610361746118
curr_Factors:  [97.87610362]
mat_Sqrt:  [[0.15]]
grads:  [-0.046713]
Stock Position:  -0.04671299507951757
Bond Position:  [6.95695234]


portfolio before change:  [2.31092501]
curr_Stock_Price:  99.46829865037478
curr_Factors:  [99.46829865]
mat_Sqrt:  [[0.15]]
grads:  [0.063437]
Stock Position:  0.06343699635540712
Bond Position:  [-3.99904509]


portfolio before change:  [2.32107316]
curr_Stock_Price:  99.63221082874153
curr_Factors:  [99.63221083]
mat_Sqrt:  [[0.15]]
grads:  [0.04894051]
Stock Position:  0.04894050578852344
Bond Position:  [-2.55497763]


portfolio before change:  [2.30968353]
curr_Stock_Price:  99.40274973445055
curr_Factors:  [99.40274973]
mat_Sqrt:  [[0.15]]
grads:  [-0.07839072]
Stock Position:  -0.07839071671631308
Bond Position:  [10.10193632]


portfolio before change:  [2.3284379]
curr_Stock_Price:  99.17156189575596
curr_Factors:  [99.1715619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195357]
Stock Position:  -0.0019535667584099094
Bond Position:  [2.52217617]


portfolio before change:  [2.32847437]
curr_Stock_Price:  99.23358699799816
curr_Factors:  [99.233587]
mat_Sqrt:  [[0.15]]
grads:  [0.09951844]
Stock Position:  0.099518438622125
Bond Position:  [-7.54709727]


portfolio before change:  [2.35079899]
curr_Stock_Price:  99.46265334417527
curr_Factors:  [99.46265334]
mat_Sqrt:  [[0.15]]
grads:  [0.07661742]
Stock Position:  0.07661741794608284
Bond Position:  [-5.26977269]


portfolio before change:  [2.28806361]
curr_Stock_Price:  98.64813873839392
curr_Factors:  [98.64813874]
mat_Sqrt:  [[0.15]]
grads:  [-0.05892952]
Stock Position:  -0.05892951681928489
Bond Position:  [8.10135076]


portfolio before change:  [2.24830743]
curr_Stock_Price:  99.33137078608719
curr_Factors:  [99.33137079]
mat_Sqrt:  [[0.15]]
grads:  [0.05215538]
Stock Position:  0.05215537870388409
Bond Position:  [-2.93235784]


portfolio before change:  [2.26417488]
curr_Stock_Price:  99.63911914236051
curr_Factors:  [99.63911914]
mat_Sqrt:  [[0.15]]
grads:  [0.25381981]
Stock Position:  0.2538198098242694
Bond Position:  [-23.02620739]


portfolio before change:  [2.11826001]
curr_Stock_Price:  99.06991343353815
curr_Factors:  [99.06991343]
mat_Sqrt:  [[0.15]]
grads:  [-0.05356091]
Stock Position:  -0.053560914666141206
Bond Position:  [7.42453519]


portfolio before change:  [2.10028417]
curr_Stock_Price:  99.41419223911552
curr_Factors:  [99.41419224]
mat_Sqrt:  [[0.15]]
grads:  [0.02021036]
Stock Position:  0.020210357924256968
Bond Position:  [0.09108776]


portfolio before change:  [2.09378953]
curr_Stock_Price:  99.09255839328843
curr_Factors:  [99.09255839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946806]
Stock Position:  -0.03946806175369832
Bond Position:  [6.00478074]


portfolio before change:  [2.10884013]
curr_Stock_Price:  98.72073131315949
curr_Factors:  [98.72073131]
mat_Sqrt:  [[0.15]]
grads:  [0.04438308]
Stock Position:  0.04438307722611898
Bond Position:  [-2.27268971]


portfolio before change:  [2.09432908]
curr_Stock_Price:  98.3969815646845
curr_Factors:  [98.39698156]
mat_Sqrt:  [[0.15]]
grads:  [-0.10715264]
Stock Position:  -0.10715263607688381
Bond Position:  [12.63782503]


portfolio before change:  [2.19203918]
curr_Stock_Price:  97.4924754337108
curr_Factors:  [97.49247543]
mat_Sqrt:  [[0.15]]
grads:  [0.01236713]
Stock Position:  0.012367133877753322
Bond Position:  [0.98633669]


portfolio before change:  [2.19404519]
curr_Stock_Price:  97.64969514917836
curr_Factors:  [97.64969515]
mat_Sqrt:  [[0.15]]
grads:  [0.00677681]
Stock Position:  0.006776813032827091
Bond Position:  [1.53229146]


portfolio before change:  [2.18743072]
curr_Stock_Price:  96.65951937687534
curr_Factors:  [96.65951938]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926253]
Stock Position:  -0.06926252845999586
Bond Position:  [8.88231343]


portfolio before change:  [2.22176192]
curr_Stock_Price:  96.17186694979266
curr_Factors:  [96.17186695]
mat_Sqrt:  [[0.15]]
grads:  [-0.04960377]
Stock Position:  -0.04960377118244922
Bond Position:  [6.99224921]


portfolio before change:  [2.20992397]
curr_Stock_Price:  96.41932766947589
curr_Factors:  [96.41932767]
mat_Sqrt:  [[0.15]]
grads:  [0.0392343]
Stock Position:  0.039234295295090205
Bond Position:  [-1.57302041]


portfolio before change:  [2.21319387]
curr_Stock_Price:  96.50517650466948
curr_Factors:  [96.5051765]
mat_Sqrt:  [[0.15]]
grads:  [0.09180679]
Stock Position:  0.09180679310302324
Bond Position:  [-6.6466369]


portfolio before change:  [2.16279743]
curr_Stock_Price:  95.9607613321204
curr_Factors:  [95.96076133]
mat_Sqrt:  [[0.15]]
grads:  [0.04714686]
Stock Position:  0.04714686235463486
Bond Position:  [-2.36145137]


portfolio before change:  [2.1577455]
curr_Stock_Price:  95.8567386936103
curr_Factors:  [95.85673869]
mat_Sqrt:  [[0.15]]
grads:  [-0.21388253]
Stock Position:  -0.21388252595139737
Bond Position:  [22.6598269]


portfolio before change:  [2.18767809]
curr_Stock_Price:  95.72341169810382
curr_Factors:  [95.7234117]
mat_Sqrt:  [[0.15]]
grads:  [0.05310213]
Stock Position:  0.05310212680595696
Bond Position:  [-2.89543865]


portfolio before change:  [2.17386763]
curr_Stock_Price:  95.46674611242588
curr_Factors:  [95.46674611]
mat_Sqrt:  [[0.15]]
grads:  [-0.27062634]
Stock Position:  -0.2706263428052598
Bond Position:  [28.00968399]


portfolio before change:  [2.36557179]
curr_Stock_Price:  94.76484292706088
curr_Factors:  [94.76484293]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418141]
Stock Position:  -0.034181413910868895
Bond Position:  [5.60476811]


portfolio before change:  [2.37342481]
curr_Stock_Price:  94.54534614821677
curr_Factors:  [94.54534615]
mat_Sqrt:  [[0.15]]
grads:  [-0.10095815]
Stock Position:  -0.10095815031665491
Bond Position:  [11.91854807]


portfolio before change:  [2.42322527]
curr_Stock_Price:  94.05944644926203
curr_Factors:  [94.05944645]
mat_Sqrt:  [[0.15]]
grads:  [0.4262701]
Stock Position:  0.4262701025164457
Bond Position:  [-37.67150461]


portfolio before change:  [2.03147916]
curr_Stock_Price:  93.14596091479662
curr_Factors:  [93.14596091]
mat_Sqrt:  [[0.15]]
grads:  [0.15751297]
Stock Position:  0.15751297239842857
Bond Position:  [-12.64021801]


portfolio before change:  [2.04485346]
curr_Stock_Price:  93.23588583511844
curr_Factors:  [93.23588584]
mat_Sqrt:  [[0.15]]
grads:  [0.01703411]
Stock Position:  0.017034112909741772
Bond Position:  [0.45666285]


portfolio before change:  [2.04815647]
curr_Stock_Price:  93.42811579407568
curr_Factors:  [93.42811579]
mat_Sqrt:  [[0.15]]
grads:  [0.08601107]
Stock Position:  0.08601107212705623
Bond Position:  [-5.98769594]


portfolio before change:  [1.99466751]
curr_Stock_Price:  92.81058236282783
curr_Factors:  [92.81058236]
mat_Sqrt:  [[0.15]]
grads:  [0.26200356]
Stock Position:  0.26200356191574764
Bond Position:  [-22.32203565]


portfolio before change:  [1.9019241]
curr_Stock_Price:  92.46192967360317
curr_Factors:  [92.46192967]
mat_Sqrt:  [[0.15]]
grads:  [-0.04004988]
Stock Position:  -0.040049879008426825
Bond Position:  [5.60501319]


portfolio before change:  [1.94645152]
curr_Stock_Price:  91.35887773427585
curr_Factors:  [91.35887773]
mat_Sqrt:  [[0.15]]
grads:  [0.07637823]
Stock Position:  0.07637823376618748
Bond Position:  [-5.0313782]


portfolio before change:  [1.88667746]
curr_Stock_Price:  90.58038907740064
curr_Factors:  [90.58038908]
mat_Sqrt:  [[0.15]]
grads:  [0.3686345]
Stock Position:  0.36863449711913293
Bond Position:  [-31.50437872]


portfolio before change:  [1.75858056]
curr_Stock_Price:  90.23824037249756
curr_Factors:  [90.23824037]
mat_Sqrt:  [[0.15]]
grads:  [0.09181696]
Stock Position:  0.09181696323366563
Bond Position:  [-6.52682064]


portfolio before change:  [1.78811828]
curr_Stock_Price:  90.56438553503426
curr_Factors:  [90.56438554]
mat_Sqrt:  [[0.15]]
grads:  [0.17812721]
Stock Position:  0.1781272102909774
Bond Position:  [-14.34386307]


portfolio before change:  [1.63617471]
curr_Stock_Price:  89.71641262192243
curr_Factors:  [89.71641262]
mat_Sqrt:  [[0.15]]
grads:  [0.26362266]
Stock Position:  0.263622657027543
Bond Position:  [-22.01510437]


portfolio before change:  [1.69763561]
curr_Stock_Price:  89.95477183217055
curr_Factors:  [89.95477183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853673]
Stock Position:  -0.02853672803621419
Bond Position:  [4.26465047]


portfolio before change:  [1.69845853]
curr_Stock_Price:  89.93527508358288
curr_Factors:  [89.93527508]
mat_Sqrt:  [[0.15]]
grads:  [0.02458284]
Stock Position:  0.02458284242739712
Bond Position:  [-0.51240616]


portfolio before change:  [1.68756274]
curr_Stock_Price:  89.49335028160792
curr_Factors:  [89.49335028]
mat_Sqrt:  [[0.15]]
grads:  [0.03979202]
Stock Position:  0.03979201859988268
Bond Position:  [-1.87355832]


portfolio before change:  [1.66238324]
curr_Stock_Price:  88.86351543356949
curr_Factors:  [88.86351543]
mat_Sqrt:  [[0.15]]
grads:  [0.0848864]
Stock Position:  0.08488639620522818
Bond Position:  [-5.88092034]


portfolio before change:  [1.67133164]
curr_Stock_Price:  88.97326179425734
curr_Factors:  [88.97326179]
mat_Sqrt:  [[0.15]]
grads:  [-0.34803407]
Stock Position:  -0.3480340658070372
Bond Position:  [32.63705769]


portfolio before change:  [1.2845904]
curr_Stock_Price:  90.09033958587207
curr_Factors:  [90.09033959]
mat_Sqrt:  [[0.15]]
grads:  [0.01507476]
Stock Position:  0.01507475823317202
Bond Position:  [-0.07349969]


portfolio before change:  [1.29201378]
curr_Stock_Price:  90.5830823613964
curr_Factors:  [90.58308236]
mat_Sqrt:  [[0.15]]
grads:  [0.01122153]
Stock Position:  0.0112215349771791
Bond Position:  [0.27553255]


portfolio before change:  [1.29541267]
curr_Stock_Price:  90.88443763943043
curr_Factors:  [90.88443764]
mat_Sqrt:  [[0.15]]
grads:  [-1.16817747]
Stock Position:  -1.168177472553779
Bond Position:  [107.46456533]


portfolio before change:  [1.43697951]
curr_Stock_Price:  90.76900132898048
curr_Factors:  [90.76900133]
mat_Sqrt:  [[0.15]]
grads:  [-0.14790336]
Stock Position:  -0.14790336313063632
Bond Position:  [14.86202008]


portfolio before change:  [1.47156676]
curr_Stock_Price:  90.54143150230533
curr_Factors:  [90.5414315]
mat_Sqrt:  [[0.15]]
grads:  [0.10870468]
Stock Position:  0.10870467637052911
Bond Position:  [-8.37071025]


portfolio before change:  [1.41992614]
curr_Stock_Price:  90.07119011530726
curr_Factors:  [90.07119012]
mat_Sqrt:  [[0.15]]
grads:  [0.14236795]
Stock Position:  0.14236794571386174
Bond Position:  [-11.40332417]


portfolio before change:  [1.52151559]
curr_Stock_Price:  90.7897660668613
curr_Factors:  [90.78976607]
mat_Sqrt:  [[0.15]]
grads:  [-0.13810779]
Stock Position:  -0.13810778504257548
Bond Position:  [14.06028908]


portfolio before change:  [1.5607297]
curr_Stock_Price:  90.51219069124815
curr_Factors:  [90.51219069]
mat_Sqrt:  [[0.15]]
grads:  [-0.06149455]
Stock Position:  -0.06149455290788133
Bond Position:  [7.1267364]


portfolio before change:  [1.52435708]
curr_Stock_Price:  91.11091136561761
curr_Factors:  [91.11091137]
mat_Sqrt:  [[0.15]]
grads:  [-0.09174835]
Stock Position:  -0.09174835131451738
Bond Position:  [9.88363298]


portfolio before change:  [1.51159319]
curr_Stock_Price:  91.25676283165043
curr_Factors:  [91.25676283]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030059]
Stock Position:  -0.020300589791153054
Bond Position:  [3.3641593]


portfolio before change:  [1.51094051]
curr_Stock_Price:  91.29927143495537
curr_Factors:  [91.29927143]
mat_Sqrt:  [[0.15]]
grads:  [-0.11036879]
Stock Position:  -0.1103687919508926
Bond Position:  [11.58753081]


portfolio before change:  [1.46338124]
curr_Stock_Price:  91.73674574474896
curr_Factors:  [91.73674574]
mat_Sqrt:  [[0.15]]
grads:  [-0.16107237]
Stock Position:  -0.16107237470124663
Bond Position:  [16.23963673]


portfolio before change:  [1.42251063]
curr_Stock_Price:  91.99678797168973
curr_Factors:  [91.99678797]
mat_Sqrt:  [[0.15]]
grads:  [0.11675064]
Stock Position:  0.11675064442003026
Bond Position:  [-9.31817365]


portfolio before change:  [1.44006439]
curr_Stock_Price:  92.15212899964551
curr_Factors:  [92.152129]
mat_Sqrt:  [[0.15]]
grads:  [0.10793475]
Stock Position:  0.10793474837884627
Bond Position:  [-8.50635246]


portfolio before change:  [1.43921654]
curr_Stock_Price:  92.14919955981307
curr_Factors:  [92.14919956]
mat_Sqrt:  [[0.15]]
grads:  [0.08860724]
Stock Position:  0.08860723993397454
Bond Position:  [-6.72586969]


portfolio before change:  [1.45686829]
curr_Stock_Price:  92.35315723746649
curr_Factors:  [92.35315724]
mat_Sqrt:  [[0.15]]
grads:  [0.01320137]
Stock Position:  0.01320137144313561
Bond Position:  [0.23767996]


portfolio before change:  [1.45566181]
curr_Stock_Price:  92.2606418310797
curr_Factors:  [92.26064183]
mat_Sqrt:  [[0.15]]
grads:  [0.04869088]
Stock Position:  0.04869088304067261
Bond Position:  [-3.03659031]


portfolio before change:  [1.44864568]
curr_Stock_Price:  92.12044438963682
curr_Factors:  [92.12044439]
mat_Sqrt:  [[0.15]]
grads:  [0.1771464]
Stock Position:  0.17714640309150234
Bond Position:  [-14.87015969]


portfolio before change:  [1.47361938]
curr_Stock_Price:  92.26666872051675
curr_Factors:  [92.26666872]
mat_Sqrt:  [[0.15]]
grads:  [-0.16885818]
Stock Position:  -0.16885817730561511
Bond Position:  [17.05360089]


portfolio before change:  [1.48019074]
curr_Stock_Price:  92.23406459685543
curr_Factors:  [92.2340646]
mat_Sqrt:  [[0.15]]
grads:  [0.03054385]
Stock Position:  0.03054384646059196
Bond Position:  [-1.33699237]


portfolio before change:  [1.45279892]
curr_Stock_Price:  91.33999712215414
curr_Factors:  [91.33999712]
mat_Sqrt:  [[0.15]]
grads:  [0.07357854]
Stock Position:  0.07357854014654136
Bond Position:  [-5.26786473]


portfolio before change:  [1.44201969]
curr_Stock_Price:  91.19797242210483
curr_Factors:  [91.19797242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.44201969]
Stock Price:  90.13250182634569
PL:  [1.44201969]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.20162708e-03]
 [-1.75622542e-02]
 [-3.22001765e-03]
 [ 6.11638358e-03]
 [-5.59153499e-03]
 [ 9.22746047e-03]
 [ 4.89869193e-03]
 [-3.03355055e-02]
 [-5.39951400e-02]
 [ 5.05000296e-02]
 [-1.36488809e-01]
 [ 4.01563906e-02]
 [-5.14969236e-03]
 [-8.61231846e-04]
 [-7.09496306e-03]
 [ 1.09197198e-02]
 [ 1.11602548e-02]
 [-7.25194746e-03]
 [ 2.35951947e-03]
 [ 8.38862377e-03]
 [ 1.29111099e-02]
 [-1.01145813e-02]
 [ 5.40200281e-03]
 [-3.00149074e-03]
 [-8.06342276e-03]
 [-9.87508216e-03]
 [-3.22498250e-03]
 [ 9.37426112e-03]
 [-3.99656620e-02]
 [ 3.79344379e-03]
 [ 5.74400153e-03]
 [-1.01709692e-02]
 [-7.71244922e-03]
 [ 5.36782006e-03]
 [ 1.31403272e-02]
 [ 1.61101923e-02]
 [-3.49293828e-02]
 [ 9.15853593e-03]
 [-1.32459798e-02]
 [ 2.29806255e-02]
 [-5.80362988e-03]
 [-2.01119486e-02]
 [ 2.09811063e-02]
 [-4.06740171e-05]
 [ 9.24113258e-04]
 [-1.27313880e-02]
 [ 1.21175812e-02]
 [-3.00197612e-04]
 [-6.88789929e-04]
 [-7.46319679e-03]
 [-1.93145594e-02]
 [-4.82444600e-03]
 [-5.52190204e-03]
 [ 5.46180474e-03]
 [ 1.00842276e-03]
 [-1.09202312e-03]
 [ 5.11870973e-03]
 [-4.98193120e-04]
 [ 1.61584307e-03]
 [ 1.55514314e-02]
 [-2.66972047e-03]
 [ 3.70806186e-03]
 [ 1.69015159e-03]
 [-1.23767190e-02]
 [ 6.35606074e-04]
 [ 5.08122885e-04]
 [-5.47549493e-03]
 [ 1.74127566e-02]
 [-8.16344422e-03]
 [ 8.78007364e-03]
 [-1.12287864e-02]
 [ 1.14783622e-02]
 [-6.57467267e-03]
 [ 1.73447254e-02]
 [-2.24856017e-02]
 [-3.56323263e-03]
 [-7.80878294e-03]
 [-1.68085048e-03]
 [ 3.47544395e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.77684448]
curr_Stock_Price:  99.36155756303047
curr_Factors:  [99.36155756]
mat_Sqrt:  [[0.15]]
grads:  [0.03467751]
Stock Position:  0.03467751384529871
Bond Position:  [-11.22245627]


portfolio before change:  [-7.79132665]
curr_Stock_Price:  98.96416027912565
curr_Factors:  [98.96416028]
mat_Sqrt:  [[0.15]]
grads:  [-0.11708169]
Stock Position:  -0.11708169475001667
Bond Position:  [3.79556495]


portfolio before change:  [-7.79352095]
curr_Stock_Price:  98.98492803122686
curr_Factors:  [98.98492803]
mat_Sqrt:  [[0.15]]
grads:  [-0.02146678]
Stock Position:  -0.02146678430098043
Bond Position:  [-5.66863285]


portfolio before change:  [-7.78460599]
curr_Stock_Price:  98.55313247129091
curr_Factors:  [98.55313247]
mat_Sqrt:  [[0.15]]
grads:  [0.04077589]
Stock Position:  0.040775890558090465
Bond Position:  [-11.80319773]


portfolio before change:  [-7.80059028]
curr_Stock_Price:  98.17922108456793
curr_Factors:  [98.17922108]
mat_Sqrt:  [[0.15]]
grads:  [-0.0372769]
Stock Position:  -0.03727689991854933
Bond Position:  [-4.14077328]


portfolio before change:  [-7.78179391]
curr_Stock_Price:  97.66804181584767
curr_Factors:  [97.66804182]
mat_Sqrt:  [[0.15]]
grads:  [0.0615164]
Stock Position:  0.06151640314581088
Bond Position:  [-13.78998054]


portfolio before change:  [-7.80097869]
curr_Stock_Price:  97.37018814985458
curr_Factors:  [97.37018815]
mat_Sqrt:  [[0.15]]
grads:  [0.03265795]
Stock Position:  0.032657946167791094
Bond Position:  [-10.98088906]


portfolio before change:  [-7.82547872]
curr_Stock_Price:  96.64100283715844
curr_Factors:  [96.64100284]
mat_Sqrt:  [[0.15]]
grads:  [-0.2022367]
Stock Position:  -0.20223670350653725
Bond Position:  [11.71887912]


portfolio before change:  [-7.75364936]
curr_Stock_Price:  96.28944990603094
curr_Factors:  [96.28944991]
mat_Sqrt:  [[0.15]]
grads:  [-0.3599676]
Stock Position:  -0.35996759995321087
Bond Position:  [26.90743283]


portfolio before change:  [-7.53119394]
curr_Stock_Price:  95.67613456288933
curr_Factors:  [95.67613456]
mat_Sqrt:  [[0.15]]
grads:  [0.33666686]
Stock Position:  0.3366668637609106
Bond Position:  [-39.7421781]


portfolio before change:  [-7.46002273]
curr_Stock_Price:  95.89491217365308
curr_Factors:  [95.89491217]
mat_Sqrt:  [[0.15]]
grads:  [-0.90992539]
Stock Position:  -0.9099253907085696
Bond Position:  [79.7971927]


portfolio before change:  [-6.977577]
curr_Stock_Price:  95.37018975844246
curr_Factors:  [95.37018976]
mat_Sqrt:  [[0.15]]
grads:  [0.26770927]
Stock Position:  0.26770927050271254
Bond Position:  [-32.50906093]


portfolio before change:  [-6.86588617]
curr_Stock_Price:  95.7949890739158
curr_Factors:  [95.79498907]
mat_Sqrt:  [[0.15]]
grads:  [-0.03433128]
Stock Position:  -0.03433128241882703
Bond Position:  [-3.57712134]


portfolio before change:  [-6.89575206]
curr_Stock_Price:  96.6584090747992
curr_Factors:  [96.65840907]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574155]
Stock Position:  -0.005741545638011571
Bond Position:  [-6.34078339]


portfolio before change:  [-6.8940664]
curr_Stock_Price:  96.29579432388279
curr_Factors:  [96.29579432]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729975]
Stock Position:  -0.047299753701841
Bond Position:  [-2.33929905]


portfolio before change:  [-6.92452965]
curr_Stock_Price:  96.93674985646096
curr_Factors:  [96.93674986]
mat_Sqrt:  [[0.15]]
grads:  [0.07279813]
Stock Position:  0.07279813181429623
Bond Position:  [-13.98134394]


portfolio before change:  [-6.88176728]
curr_Stock_Price:  97.53616400551
curr_Factors:  [97.53616401]
mat_Sqrt:  [[0.15]]
grads:  [0.0744017]
Stock Position:  0.07440169843866122
Bond Position:  [-14.13862354]


portfolio before change:  [-6.85105033]
curr_Stock_Price:  97.96089414690874
curr_Factors:  [97.96089415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04834632]
Stock Position:  -0.04834631642352137
Bond Position:  [-2.11500194]


portfolio before change:  [-6.82574242]
curr_Stock_Price:  97.43468848423515
curr_Factors:  [97.43468848]
mat_Sqrt:  [[0.15]]
grads:  [0.01573013]
Stock Position:  0.015730129802760097
Bond Position:  [-8.35840271]


portfolio before change:  [-6.82931793]
curr_Stock_Price:  97.24059618083949
curr_Factors:  [97.24059618]
mat_Sqrt:  [[0.15]]
grads:  [0.05592416]
Stock Position:  0.05592415847642691
Bond Position:  [-12.26741644]


portfolio before change:  [-6.85674569]
curr_Stock_Price:  96.76386079889804
curr_Factors:  [96.7638608]
mat_Sqrt:  [[0.15]]
grads:  [0.08607407]
Stock Position:  0.08607406625010013
Bond Position:  [-15.18560466]


portfolio before change:  [-6.81547575]
curr_Stock_Price:  97.25435783746974
curr_Factors:  [97.25435784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06743054]
Stock Position:  -0.0674305419920963
Bond Position:  [-0.25756169]


portfolio before change:  [-6.84664894]
curr_Stock_Price:  97.71641993683463
curr_Factors:  [97.71641994]
mat_Sqrt:  [[0.15]]
grads:  [0.03601335]
Stock Position:  0.03601335205584137
Bond Position:  [-10.36574478]


portfolio before change:  [-6.8362157]
curr_Stock_Price:  98.02411470361778
curr_Factors:  [98.0241147]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000994]
Stock Position:  -0.02000993827783728
Bond Position:  [-4.87475922]


portfolio before change:  [-6.84157528]
curr_Stock_Price:  98.27673381633801
curr_Factors:  [98.27673382]
mat_Sqrt:  [[0.15]]
grads:  [-0.05375615]
Stock Position:  -0.05375615174518702
Bond Position:  [-1.55859626]


portfolio before change:  [-6.83847623]
curr_Stock_Price:  98.2172715265877
curr_Factors:  [98.21727153]
mat_Sqrt:  [[0.15]]
grads:  [-0.06583388]
Stock Position:  -0.0658338810888985
Bond Position:  [-0.37245205]


portfolio before change:  [-6.82649454]
curr_Stock_Price:  98.03491917641395
curr_Factors:  [98.03491918]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149988]
Stock Position:  -0.021499883315559586
Bond Position:  [-4.71875522]


portfolio before change:  [-6.81172611]
curr_Stock_Price:  97.33429354461227
curr_Factors:  [97.33429354]
mat_Sqrt:  [[0.15]]
grads:  [0.06249507]
Stock Position:  0.0624950741084497
Bond Position:  [-12.89463999]


portfolio before change:  [-6.85875997]
curr_Stock_Price:  96.59458855012817
curr_Factors:  [96.59458855]
mat_Sqrt:  [[0.15]]
grads:  [-0.26643775]
Stock Position:  -0.2664377463684841
Bond Position:  [18.87768452]


portfolio before change:  [-6.88549082]
curr_Stock_Price:  96.69934377866572
curr_Factors:  [96.69934378]
mat_Sqrt:  [[0.15]]
grads:  [0.02528963]
Stock Position:  0.025289625235503287
Bond Position:  [-9.33098098]


portfolio before change:  [-6.88304966]
curr_Stock_Price:  96.81893290937225
curr_Factors:  [96.81893291]
mat_Sqrt:  [[0.15]]
grads:  [0.03829334]
Stock Position:  0.038293343546039395
Bond Position:  [-10.59057032]


portfolio before change:  [-6.88493758]
curr_Stock_Price:  96.78691718975756
curr_Factors:  [96.78691719]
mat_Sqrt:  [[0.15]]
grads:  [-0.06780646]
Stock Position:  -0.06780646132418033
Bond Position:  [-0.32215922]


portfolio before change:  [-6.87654075]
curr_Stock_Price:  96.66278502071198
curr_Factors:  [96.66278502]
mat_Sqrt:  [[0.15]]
grads:  [-0.05141633]
Stock Position:  -0.05141632812999251
Bond Position:  [-1.90649528]


portfolio before change:  [-6.92629038]
curr_Stock_Price:  97.62805168587548
curr_Factors:  [97.62805169]
mat_Sqrt:  [[0.15]]
grads:  [0.03578547]
Stock Position:  0.035785467070456004
Bond Position:  [-10.41995581]


portfolio before change:  [-6.91875012]
curr_Stock_Price:  97.85695836200391
curr_Factors:  [97.85695836]
mat_Sqrt:  [[0.15]]
grads:  [0.08760218]
Stock Position:  0.08760218109858305
Bond Position:  [-15.4912331]


portfolio before change:  [-6.84326868]
curr_Stock_Price:  98.72964968679254
curr_Factors:  [98.72964969]
mat_Sqrt:  [[0.15]]
grads:  [0.10740128]
Stock Position:  0.1074012817269843
Bond Position:  [-17.44695961]


portfolio before change:  [-6.83407554]
curr_Stock_Price:  98.8253991035494
curr_Factors:  [98.8253991]
mat_Sqrt:  [[0.15]]
grads:  [-0.23286255]
Stock Position:  -0.23286255231385908
Bond Position:  [16.17865913]


portfolio before change:  [-6.81948738]
curr_Stock_Price:  98.76709448513847
curr_Factors:  [98.76709449]
mat_Sqrt:  [[0.15]]
grads:  [0.06105691]
Stock Position:  0.06105690618219566
Bond Position:  [-12.84990061]


portfolio before change:  [-6.7758853]
curr_Stock_Price:  99.49437049762456
curr_Factors:  [99.4943705]
mat_Sqrt:  [[0.15]]
grads:  [-0.08830653]
Stock Position:  -0.08830653209917566
Bond Position:  [2.01011752]


portfolio before change:  [-6.84992478]
curr_Stock_Price:  100.33423037229235
curr_Factors:  [100.33423037]
mat_Sqrt:  [[0.15]]
grads:  [0.15320417]
Stock Position:  0.15320416987377064
Bond Position:  [-22.22154725]


portfolio before change:  [-6.74939001]
curr_Stock_Price:  100.99951030875955
curr_Factors:  [100.99951031]
mat_Sqrt:  [[0.15]]
grads:  [-0.03869087]
Stock Position:  -0.03869086584516462
Bond Position:  [-2.84163151]


portfolio before change:  [-6.77515787]
curr_Stock_Price:  101.66091328893965
curr_Factors:  [101.66091329]
mat_Sqrt:  [[0.15]]
grads:  [-0.13407966]
Stock Position:  -0.13407965719858564
Bond Position:  [6.85550253]


portfolio before change:  [-6.91071853]
curr_Stock_Price:  102.67515469598067
curr_Factors:  [102.6751547]
mat_Sqrt:  [[0.15]]
grads:  [0.13987404]
Stock Position:  0.1398740422845429
Bond Position:  [-21.27230746]


portfolio before change:  [-6.93621776]
curr_Stock_Price:  102.50235871843536
curr_Factors:  [102.50235872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027116]
Stock Position:  -0.00027116011382077057
Bond Position:  [-6.90842321]


portfolio before change:  [-6.93677227]
curr_Stock_Price:  102.95493617874473
curr_Factors:  [102.95493618]
mat_Sqrt:  [[0.15]]
grads:  [0.00616076]
Stock Position:  0.0061607550533175105
Bond Position:  [-7.57105242]


portfolio before change:  [-6.93952102]
curr_Stock_Price:  102.58557552897078
curr_Factors:  [102.58557553]
mat_Sqrt:  [[0.15]]
grads:  [-0.08487592]
Stock Position:  -0.0848759197431089
Bond Position:  [1.76752406]


portfolio before change:  [-6.85927732]
curr_Stock_Price:  101.64145351520857
curr_Factors:  [101.64145352]
mat_Sqrt:  [[0.15]]
grads:  [0.08078387]
Stock Position:  0.08078387471506673
Bond Position:  [-15.07026777]


portfolio before change:  [-6.81796637]
curr_Stock_Price:  102.1644894770686
curr_Factors:  [102.16448948]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200132]
Stock Position:  -0.0020013174165901294
Bond Position:  [-6.6135028]


portfolio before change:  [-6.81918883]
curr_Stock_Price:  102.56877642900908
curr_Factors:  [102.56877643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00459193]
Stock Position:  -0.004591932857959412
Bond Position:  [-6.3481999]


portfolio before change:  [-6.81758801]
curr_Stock_Price:  102.13375365210867
curr_Factors:  [102.13375365]
mat_Sqrt:  [[0.15]]
grads:  [-0.04975465]
Stock Position:  -0.04975464527667689
Bond Position:  [-1.73595933]


portfolio before change:  [-6.80626642]
curr_Stock_Price:  101.9040244965212
curr_Factors:  [101.9040245]
mat_Sqrt:  [[0.15]]
grads:  [-0.12876373]
Stock Position:  -0.12876372915154055
Bond Position:  [6.31527579]


portfolio before change:  [-6.71767407]
curr_Stock_Price:  101.21906734790909
curr_Factors:  [101.21906735]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216297]
Stock Position:  -0.03216297333202287
Bond Position:  [-3.4621679]


portfolio before change:  [-6.74066757]
curr_Stock_Price:  101.92724539859309
curr_Factors:  [101.9272454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03681268]
Stock Position:  -0.03681268029320575
Bond Position:  [-2.98845247]


portfolio before change:  [-6.74034501]
curr_Stock_Price:  101.91340916616176
curr_Factors:  [101.91340917]
mat_Sqrt:  [[0.15]]
grads:  [0.03641203]
Stock Position:  0.03641203161999329
Bond Position:  [-10.45121928]


portfolio before change:  [-6.74180342]
curr_Stock_Price:  101.89129587237366
curr_Factors:  [101.89129587]
mat_Sqrt:  [[0.15]]
grads:  [0.00672282]
Stock Position:  0.006722818427940838
Bond Position:  [-7.4268001]


portfolio before change:  [-6.74416944]
curr_Stock_Price:  101.608403799438
curr_Factors:  [101.6084038]
mat_Sqrt:  [[0.15]]
grads:  [-0.00728015]
Stock Position:  -0.007280154108175464
Bond Position:  [-6.0044446]


portfolio before change:  [-6.73453671]
curr_Stock_Price:  100.23370488822523
curr_Factors:  [100.23370489]
mat_Sqrt:  [[0.15]]
grads:  [0.03412473]
Stock Position:  0.03412473150616511
Bond Position:  [-10.15498498]


portfolio before change:  [-6.70459521]
curr_Stock_Price:  101.12971805203497
curr_Factors:  [101.12971805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332129]
Stock Position:  -0.003321287469623121
Bond Position:  [-6.36871434]


portfolio before change:  [-6.70685275]
curr_Stock_Price:  101.68958824217746
curr_Factors:  [101.68958824]
mat_Sqrt:  [[0.15]]
grads:  [0.01077229]
Stock Position:  0.010772287141088183
Bond Position:  [-7.8022822]


portfolio before change:  [-6.70153444]
curr_Stock_Price:  102.22856173016682
curr_Factors:  [102.22856173]
mat_Sqrt:  [[0.15]]
grads:  [0.10367621]
Stock Position:  0.10367620966612379
Bond Position:  [-17.30020424]


portfolio before change:  [-6.67296445]
curr_Stock_Price:  102.51456067162881
curr_Factors:  [102.51456067]
mat_Sqrt:  [[0.15]]
grads:  [-0.01779814]
Stock Position:  -0.017798136495178668
Bond Position:  [-4.8483963]


portfolio before change:  [-6.66432685]
curr_Stock_Price:  102.01222568573269
curr_Factors:  [102.01222569]
mat_Sqrt:  [[0.15]]
grads:  [0.02472041]
Stock Position:  0.024720412373667816
Bond Position:  [-9.18611114]


portfolio before change:  [-6.64016353]
curr_Stock_Price:  103.01291580209289
curr_Factors:  [103.0129158]
mat_Sqrt:  [[0.15]]
grads:  [0.01126768]
Stock Position:  0.01126767724389068
Bond Position:  [-7.80087982]


portfolio before change:  [-6.64928217]
curr_Stock_Price:  102.24691325440205
curr_Factors:  [102.24691325]
mat_Sqrt:  [[0.15]]
grads:  [-0.08251146]
Stock Position:  -0.08251145979693507
Bond Position:  [1.7872599]


portfolio before change:  [-6.65871149]
curr_Stock_Price:  102.36254605578632
curr_Factors:  [102.36254606]
mat_Sqrt:  [[0.15]]
grads:  [0.00423737]
Stock Position:  0.004237373828859017
Bond Position:  [-7.09245987]


portfolio before change:  [-6.66007374]
curr_Stock_Price:  102.14567807970705
curr_Factors:  [102.14567808]
mat_Sqrt:  [[0.15]]
grads:  [0.00338749]
Stock Position:  0.003387485902137735
Bond Position:  [-7.00609078]


portfolio before change:  [-6.661403]
curr_Stock_Price:  101.88254140102192
curr_Factors:  [101.8825414]
mat_Sqrt:  [[0.15]]
grads:  [-0.0365033]
Stock Position:  -0.03650329956420912
Bond Position:  [-2.94235407]


portfolio before change:  [-6.6469219]
curr_Stock_Price:  101.48079679381901
curr_Factors:  [101.48079679]
mat_Sqrt:  [[0.15]]
grads:  [0.11608504]
Stock Position:  0.11608504429738611
Bond Position:  [-18.42732469]


portfolio before change:  [-6.74630497]
curr_Stock_Price:  100.63459544809393
curr_Factors:  [100.63459545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05442296]
Stock Position:  -0.054422961447859665
Bond Position:  [-1.26947226]


portfolio before change:  [-6.75861406]
curr_Stock_Price:  100.85931219591026
curr_Factors:  [100.8593122]
mat_Sqrt:  [[0.15]]
grads:  [0.05853382]
Stock Position:  0.05853382426938034
Bond Position:  [-12.66229532]


portfolio before change:  [-6.72755425]
curr_Stock_Price:  101.40346305139813
curr_Factors:  [101.40346305]
mat_Sqrt:  [[0.15]]
grads:  [-0.07485858]
Stock Position:  -0.07485857598639852
Bond Position:  [0.86336459]


portfolio before change:  [-6.73295553]
curr_Stock_Price:  101.47633699868824
curr_Factors:  [101.476337]
mat_Sqrt:  [[0.15]]
grads:  [0.07652241]
Stock Position:  0.07652241484996804
Bond Position:  [-14.49816989]


portfolio before change:  [-6.75529738]
curr_Stock_Price:  101.19621403361828
curr_Factors:  [101.19621403]
mat_Sqrt:  [[0.15]]
grads:  [-0.04383115]
Stock Position:  -0.04383115114482697
Bond Position:  [-2.31975083]


portfolio before change:  [-6.73997988]
curr_Stock_Price:  100.84344000857118
curr_Factors:  [100.84344001]
mat_Sqrt:  [[0.15]]
grads:  [0.1156315]
Stock Position:  0.11563150249388972
Bond Position:  [-18.40065836]


portfolio before change:  [-6.69994888]
curr_Stock_Price:  101.19958061492258
curr_Factors:  [101.19958061]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990401]
Stock Position:  -0.1499040112460493
Bond Position:  [8.47027419]


portfolio before change:  [-6.72292079]
curr_Stock_Price:  101.35635643353439
curr_Factors:  [101.35635643]
mat_Sqrt:  [[0.15]]
grads:  [-0.02375488]
Stock Position:  -0.023754884184390753
Bond Position:  [-4.31521229]


portfolio before change:  [-6.70135137]
curr_Stock_Price:  100.43700301308085
curr_Factors:  [100.43700301]
mat_Sqrt:  [[0.15]]
grads:  [-0.05205855]
Stock Position:  -0.05205855296446178
Bond Position:  [-1.47274633]


portfolio before change:  [-6.70261712]
curr_Stock_Price:  100.45954879197642
curr_Factors:  [100.45954879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01120567]
Stock Position:  -0.011205669888580013
Bond Position:  [-5.57690058]


portfolio before change:  [-6.70117675]
curr_Stock_Price:  100.29990272067835
curr_Factors:  [100.29990272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.70117675]
Stock Price:  99.63948606068487
PL:  [-6.70117675]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.30096245e-03]
 [-8.99579451e-04]
 [-2.21559802e-03]
 [ 6.73238991e-03]
 [ 1.16400862e-03]
 [ 1.43905806e-02]
 [ 3.32291802e-03]
 [-2.45242831e-02]
 [-1.72521672e-02]
 [ 2.78521649e-02]
 [-2.66055015e-02]
 [ 2.32848843e-02]
 [-1.36712452e-02]
 [ 7.07556655e-03]
 [-6.98382957e-03]
 [ 6.19473325e-03]
 [ 7.25433831e-03]
 [-1.23136464e-02]
 [-1.86844616e-04]
 [ 1.06130137e-02]
 [ 1.17066951e-02]
 [-7.88786042e-03]
 [ 7.28104598e-03]
 [ 3.67593539e-02]
 [-6.58315236e-03]
 [ 4.81169690e-03]
 [-6.23753720e-03]
 [ 6.78580524e-03]
 [-9.86894929e-03]
 [-1.84748525e-03]
 [-6.20127631e-03]
 [-1.01866778e-02]
 [-6.83559888e-03]
 [ 4.72796122e-03]
 [ 1.25448905e-02]
 [ 1.41497246e-02]
 [-3.41752178e-02]
 [ 8.41292368e-03]
 [-2.29215396e-02]
 [ 1.67432478e-02]
 [-6.67326190e-03]
 [ 4.14502310e-03]
 [ 2.31741230e-02]
 [ 4.32412441e-03]
 [-6.76859510e-03]
 [-5.49310612e-03]
 [ 5.91822822e-05]
 [-1.23675912e-02]
 [-7.57229575e-03]
 [-1.81788699e-03]
 [ 4.31540379e-02]
 [-3.13944756e-03]
 [ 2.08739840e-03]
 [ 4.76453654e-03]
 [ 3.59018597e-03]
 [ 3.95632763e-03]
 [-9.07126894e-03]
 [-2.26764866e-04]
 [ 1.55554253e-03]
 [-3.86817691e-02]
 [-9.23032057e-03]
 [ 1.73411480e-02]
 [ 1.58847253e-02]
 [-1.88625554e-02]
 [-6.93457958e-03]
 [-1.11942736e-02]
 [-4.71161193e-03]
 [ 1.30115403e-02]
 [-1.03992932e-02]
 [ 6.79377205e-03]
 [-5.82415692e-03]
 [ 1.10305847e-02]
 [-4.49195521e-03]
 [ 7.14018081e-03]
 [-1.33740290e-02]
 [-7.70367757e-03]
 [ 3.22820425e-04]
 [ 2.19117265e-03]
 [-9.20110585e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.92979728]
curr_Stock_Price:  99.48166173097479
curr_Factors:  [99.48166173]
mat_Sqrt:  [[0.15]]
grads:  [0.02867308]
Stock Position:  0.028673082978863663
Bond Position:  [-8.78224323]


portfolio before change:  [-5.92699092]
curr_Stock_Price:  99.59867998395391
curr_Factors:  [99.59867998]
mat_Sqrt:  [[0.15]]
grads:  [-0.0059972]
Stock Position:  -0.005997196340996779
Bond Position:  [-5.32967808]


portfolio before change:  [-5.9246558]
curr_Stock_Price:  99.15376626786959
curr_Factors:  [99.15376627]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477065]
Stock Position:  -0.014770653478343047
Bond Position:  [-4.46008988]


portfolio before change:  [-5.91923433]
curr_Stock_Price:  98.76785041522015
curr_Factors:  [98.76785042]
mat_Sqrt:  [[0.15]]
grads:  [0.0448826]
Stock Position:  0.04488259940509941
Bond Position:  [-10.3521922]


portfolio before change:  [-5.9052904]
curr_Stock_Price:  99.09294218406454
curr_Factors:  [99.09294218]
mat_Sqrt:  [[0.15]]
grads:  [0.00776006]
Stock Position:  0.007760057434705552
Bond Position:  [-6.67425732]


portfolio before change:  [-5.91080306]
curr_Stock_Price:  98.43630938701361
curr_Factors:  [98.43630939]
mat_Sqrt:  [[0.15]]
grads:  [0.0959372]
Stock Position:  0.0959372037966338
Bond Position:  [-15.35450734]


portfolio before change:  [-5.94754583]
curr_Stock_Price:  98.06332501407742
curr_Factors:  [98.06332501]
mat_Sqrt:  [[0.15]]
grads:  [0.02215279]
Stock Position:  0.022152786800806405
Bond Position:  [-8.11992176]


portfolio before change:  [-5.94690563]
curr_Stock_Price:  98.11513396611953
curr_Factors:  [98.11513397]
mat_Sqrt:  [[0.15]]
grads:  [-0.16349522]
Stock Position:  -0.16349522093539987
Bond Position:  [10.09444988]


portfolio before change:  [-5.89759434]
curr_Stock_Price:  97.81738604565747
curr_Factors:  [97.81738605]
mat_Sqrt:  [[0.15]]
grads:  [-0.11501445]
Stock Position:  -0.11501444792203622
Bond Position:  [5.35281831]


portfolio before change:  [-5.92054924]
curr_Stock_Price:  98.01987765502143
curr_Factors:  [98.01987766]
mat_Sqrt:  [[0.15]]
grads:  [0.1856811]
Stock Position:  0.18568109900131785
Bond Position:  [-24.12098785]


portfolio before change:  [-5.91866261]
curr_Stock_Price:  98.03815757556544
curr_Factors:  [98.03815758]
mat_Sqrt:  [[0.15]]
grads:  [-0.17737001]
Stock Position:  -0.17737000967189967
Bond Position:  [11.47036634]


portfolio before change:  [-5.9947472]
curr_Stock_Price:  98.47115921645424
curr_Factors:  [98.47115922]
mat_Sqrt:  [[0.15]]
grads:  [0.15523256]
Stock Position:  0.15523256215246972
Bond Position:  [-21.28067754]


portfolio before change:  [-5.92148781]
curr_Stock_Price:  98.95166065762123
curr_Factors:  [98.95166066]
mat_Sqrt:  [[0.15]]
grads:  [-0.09114163]
Stock Position:  -0.09114163447951788
Bond Position:  [3.09712827]


portfolio before change:  [-5.89546299]
curr_Stock_Price:  98.66824187472574
curr_Factors:  [98.66824187]
mat_Sqrt:  [[0.15]]
grads:  [0.04717044]
Stock Position:  0.04717044368511051
Bond Position:  [-10.54968773]


portfolio before change:  [-5.91245212]
curr_Stock_Price:  98.32205572839837
curr_Factors:  [98.32205573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04655886]
Stock Position:  -0.04655886383244684
Bond Position:  [-1.33468891]


portfolio before change:  [-5.93823519]
curr_Stock_Price:  98.87403766178187
curr_Factors:  [98.87403766]
mat_Sqrt:  [[0.15]]
grads:  [0.04129822]
Stock Position:  0.041298221639249184
Bond Position:  [-10.02155711]


portfolio before change:  [-5.93623724]
curr_Stock_Price:  98.93758316806868
curr_Factors:  [98.93758317]
mat_Sqrt:  [[0.15]]
grads:  [0.04836226]
Stock Position:  0.04836225538550776
Bond Position:  [-10.7210819]


portfolio before change:  [-5.88980454]
curr_Stock_Price:  99.91154084907657
curr_Factors:  [99.91154085]
mat_Sqrt:  [[0.15]]
grads:  [-0.08209098]
Stock Position:  -0.0820909758305461
Bond Position:  [2.31203135]


portfolio before change:  [-5.91182705]
curr_Stock_Price:  100.18157077859179
curr_Factors:  [100.18157078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00124563]
Stock Position:  -0.001245630775930084
Bond Position:  [-5.7870378]


portfolio before change:  [-5.91226757]
curr_Stock_Price:  100.24485019036557
curr_Factors:  [100.24485019]
mat_Sqrt:  [[0.15]]
grads:  [0.07075342]
Stock Position:  0.07075342486410899
Bond Position:  [-13.00493405]


portfolio before change:  [-6.0008655]
curr_Stock_Price:  99.00413152873212
curr_Factors:  [99.00413153]
mat_Sqrt:  [[0.15]]
grads:  [0.07804463]
Stock Position:  0.0780446342532061
Bond Position:  [-13.72760674]


portfolio before change:  [-5.96612233]
curr_Stock_Price:  99.460295764216
curr_Factors:  [99.46029576]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258574]
Stock Position:  -0.052585736126977194
Bond Position:  [-0.73592947]


portfolio before change:  [-5.97198315]
curr_Stock_Price:  99.5708735583858
curr_Factors:  [99.57087356]
mat_Sqrt:  [[0.15]]
grads:  [0.04854031]
Stock Position:  0.04854030656193705
Bond Position:  [-10.80518387]


portfolio before change:  [-5.97283955]
curr_Stock_Price:  99.56714346406513
curr_Factors:  [99.56714346]
mat_Sqrt:  [[0.15]]
grads:  [0.24506236]
Stock Position:  0.2450623596038874
Bond Position:  [-30.37299867]


portfolio before change:  [-6.0067426]
curr_Stock_Price:  99.43654538724284
curr_Factors:  [99.43654539]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388768]
Stock Position:  -0.04388768240348015
Bond Position:  [-1.64270307]


portfolio before change:  [-6.00965137]
curr_Stock_Price:  99.50048375987298
curr_Factors:  [99.50048376]
mat_Sqrt:  [[0.15]]
grads:  [0.03207798]
Stock Position:  0.032077979312295495
Bond Position:  [-9.20142583]


portfolio before change:  [-6.0193183]
curr_Stock_Price:  99.21705508452587
curr_Factors:  [99.21705508]
mat_Sqrt:  [[0.15]]
grads:  [-0.04158358]
Stock Position:  -0.041583581304082365
Bond Position:  [-1.89351782]


portfolio before change:  [-5.99627062]
curr_Stock_Price:  98.65995955253976
curr_Factors:  [98.65995955]
mat_Sqrt:  [[0.15]]
grads:  [0.0452387]
Stock Position:  0.04523870162899923
Bond Position:  [-10.4595191]


portfolio before change:  [-5.9663098]
curr_Stock_Price:  99.3366935273631
curr_Factors:  [99.33669353]
mat_Sqrt:  [[0.15]]
grads:  [-0.065793]
Stock Position:  -0.06579299523989694
Bond Position:  [0.56934881]


portfolio before change:  [-5.97578181]
curr_Stock_Price:  99.48120128558152
curr_Factors:  [99.48120129]
mat_Sqrt:  [[0.15]]
grads:  [-0.01231657]
Stock Position:  -0.012316568332652019
Bond Position:  [-4.7505148]


portfolio before change:  [-5.97212726]
curr_Stock_Price:  99.16037569438828
curr_Factors:  [99.16037569]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134184]
Stock Position:  -0.04134184203669764
Bond Position:  [-1.87265467]


portfolio before change:  [-5.93694517]
curr_Stock_Price:  98.30654028141257
curr_Factors:  [98.30654028]
mat_Sqrt:  [[0.15]]
grads:  [-0.06791119]
Stock Position:  -0.06791118515957739
Bond Position:  [0.73916849]


portfolio before change:  [-5.95995584]
curr_Stock_Price:  98.64605532001397
curr_Factors:  [98.64605532]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557066]
Stock Position:  -0.04557065917139481
Bond Position:  [-1.46459007]


portfolio before change:  [-5.9530557]
curr_Stock_Price:  98.492630294832
curr_Factors:  [98.49263029]
mat_Sqrt:  [[0.15]]
grads:  [0.03151974]
Stock Position:  0.03151974148008235
Bond Position:  [-9.05751795]


portfolio before change:  [-5.94668285]
curr_Stock_Price:  98.71277670813625
curr_Factors:  [98.71277671]
mat_Sqrt:  [[0.15]]
grads:  [0.0836326]
Stock Position:  0.08363260346358582
Bond Position:  [-14.20228937]


portfolio before change:  [-6.05961904]
curr_Stock_Price:  97.3730059347393
curr_Factors:  [97.37300593]
mat_Sqrt:  [[0.15]]
grads:  [0.0943315]
Stock Position:  0.09433149721973141
Bond Position:  [-15.24496048]


portfolio before change:  [-6.06729391]
curr_Stock_Price:  97.30174631225731
curr_Factors:  [97.30174631]
mat_Sqrt:  [[0.15]]
grads:  [-0.22783479]
Stock Position:  -0.22783478552908185
Bond Position:  [16.10142859]


portfolio before change:  [-5.98407724]
curr_Stock_Price:  96.94091336750854
curr_Factors:  [96.94091337]
mat_Sqrt:  [[0.15]]
grads:  [0.05608616]
Stock Position:  0.05608615789767176
Bond Position:  [-11.42112062]


portfolio before change:  [-5.93838097]
curr_Stock_Price:  97.76839235107371
curr_Factors:  [97.76839235]
mat_Sqrt:  [[0.15]]
grads:  [-0.15281026]
Stock Position:  -0.15281026421482324
Bond Position:  [9.0016329]


portfolio before change:  [-5.87051223]
curr_Stock_Price:  97.32793684912599
curr_Factors:  [97.32793685]
mat_Sqrt:  [[0.15]]
grads:  [0.11162165]
Stock Position:  0.11162165201463312
Bond Position:  [-16.73441733]


portfolio before change:  [-5.78429878]
curr_Stock_Price:  98.10967926641356
curr_Factors:  [98.10967927]
mat_Sqrt:  [[0.15]]
grads:  [-0.04448841]
Stock Position:  -0.04448841266284023
Bond Position:  [-1.41955488]


portfolio before change:  [-5.8085864]
curr_Stock_Price:  98.65361636748261
curr_Factors:  [98.65361637]
mat_Sqrt:  [[0.15]]
grads:  [0.02763349]
Stock Position:  0.02763348734342699
Bond Position:  [-8.53472986]


portfolio before change:  [-5.7933005]
curr_Stock_Price:  99.22608638439847
curr_Factors:  [99.22608638]
mat_Sqrt:  [[0.15]]
grads:  [0.15449415]
Stock Position:  0.15449415338475228
Bond Position:  [-21.12315071]


portfolio before change:  [-5.83001753]
curr_Stock_Price:  98.99697223403459
curr_Factors:  [98.99697223]
mat_Sqrt:  [[0.15]]
grads:  [0.0288275]
Stock Position:  0.028827496058886484
Bond Position:  [-8.68385236]


portfolio before change:  [-5.83814894]
curr_Stock_Price:  98.73372880673797
curr_Factors:  [98.73372881]
mat_Sqrt:  [[0.15]]
grads:  [-0.04512397]
Stock Position:  -0.04512396734698931
Bond Position:  [-1.38289139]


portfolio before change:  [-5.86482626]
curr_Stock_Price:  99.32301409969858
curr_Factors:  [99.3230141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662071]
Stock Position:  -0.03662070743761385
Bond Position:  [-2.22754722]


portfolio before change:  [-5.86204481]
curr_Stock_Price:  99.24325925378463
curr_Factors:  [99.24325925]
mat_Sqrt:  [[0.15]]
grads:  [0.00039455]
Stock Position:  0.00039454854807089806
Bond Position:  [-5.90120109]


portfolio before change:  [-5.86265103]
curr_Stock_Price:  98.64159861617837
curr_Factors:  [98.64159862]
mat_Sqrt:  [[0.15]]
grads:  [-0.08245061]
Stock Position:  -0.08245060804040481
Bond Position:  [2.27040875]


portfolio before change:  [-5.81557867]
curr_Stock_Price:  98.07240382372588
curr_Factors:  [98.07240382]
mat_Sqrt:  [[0.15]]
grads:  [-0.05048197]
Stock Position:  -0.050481971642380274
Bond Position:  [-0.86469036]


portfolio before change:  [-5.79668584]
curr_Stock_Price:  97.69708410904025
curr_Factors:  [97.69708411]
mat_Sqrt:  [[0.15]]
grads:  [-0.01211925]
Stock Position:  -0.012119246598065587
Bond Position:  [-4.61267078]


portfolio before change:  [-5.7939456]
curr_Stock_Price:  97.44718925799285
curr_Factors:  [97.44718926]
mat_Sqrt:  [[0.15]]
grads:  [0.28769359]
Stock Position:  0.28769358605813344
Bond Position:  [-33.82887693]


portfolio before change:  [-6.03238029]
curr_Stock_Price:  96.62575865479042
curr_Factors:  [96.62575865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02092965]
Stock Position:  -0.02092965042495935
Bond Position:  [-4.01003694]


portfolio before change:  [-6.03037748]
curr_Stock_Price:  96.51809104684784
curr_Factors:  [96.51809105]
mat_Sqrt:  [[0.15]]
grads:  [0.01391599]
Stock Position:  0.01391598932011611
Bond Position:  [-7.3735222]


portfolio before change:  [-6.04241856]
curr_Stock_Price:  95.68593830100446
curr_Factors:  [95.6859383]
mat_Sqrt:  [[0.15]]
grads:  [0.03176358]
Stock Position:  0.03176357691566006
Bond Position:  [-9.08174622]


portfolio before change:  [-6.05706704]
curr_Stock_Price:  95.24263666134641
curr_Factors:  [95.24263666]
mat_Sqrt:  [[0.15]]
grads:  [0.02393457]
Stock Position:  0.02393457315497665
Bond Position:  [-8.33665889]


portfolio before change:  [-6.06279175]
curr_Stock_Price:  95.02522491764327
curr_Factors:  [95.02522492]
mat_Sqrt:  [[0.15]]
grads:  [0.02637552]
Stock Position:  0.026375517539899928
Bond Position:  [-8.56913124]


portfolio before change:  [-6.04797381]
curr_Stock_Price:  95.60733765979954
curr_Factors:  [95.60733766]
mat_Sqrt:  [[0.15]]
grads:  [-0.06047513]
Stock Position:  -0.060475126239908666
Bond Position:  [-0.266108]


portfolio before change:  [-6.05139149]
curr_Stock_Price:  95.6635764214909
curr_Factors:  [95.66357642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151177]
Stock Position:  -0.0015117657721633294
Bond Position:  [-5.90677057]


portfolio before change:  [-6.05269428]
curr_Stock_Price:  96.28113666717748
curr_Factors:  [96.28113667]
mat_Sqrt:  [[0.15]]
grads:  [0.01037028]
Stock Position:  0.010370283548960472
Bond Position:  [-7.05115697]


portfolio before change:  [-6.0576882]
curr_Stock_Price:  95.84207384043826
curr_Factors:  [95.84207384]
mat_Sqrt:  [[0.15]]
grads:  [-0.25787846]
Stock Position:  -0.25787846042071133
Bond Position:  [18.65791824]


portfolio before change:  [-6.0627485]
curr_Stock_Price:  95.86621875857824
curr_Factors:  [95.86621876]
mat_Sqrt:  [[0.15]]
grads:  [-0.06153547]
Stock Position:  -0.06153547048732805
Bond Position:  [-0.16357562]


portfolio before change:  [-6.0420596]
curr_Stock_Price:  95.52984168391107
curr_Factors:  [95.52984168]
mat_Sqrt:  [[0.15]]
grads:  [0.11560765]
Stock Position:  0.1156076531224021
Bond Position:  [-17.0860404]


portfolio before change:  [-6.0896351]
curr_Stock_Price:  95.12755355752789
curr_Factors:  [95.12755356]
mat_Sqrt:  [[0.15]]
grads:  [0.10589817]
Stock Position:  0.10589816884373277
Bond Position:  [-16.16346883]


portfolio before change:  [-5.9851731]
curr_Stock_Price:  96.12353158497523
curr_Factors:  [96.12353158]
mat_Sqrt:  [[0.15]]
grads:  [-0.12575037]
Stock Position:  -0.1257503690722538
Bond Position:  [6.10239648]


portfolio before change:  [-6.07283309]
curr_Stock_Price:  96.82365996050828
curr_Factors:  [96.82365996]
mat_Sqrt:  [[0.15]]
grads:  [-0.04623053]
Stock Position:  -0.04623053053695941
Bond Position:  [-1.59662392]


portfolio before change:  [-6.0754689]
curr_Stock_Price:  96.87851595870023
curr_Factors:  [96.87851596]
mat_Sqrt:  [[0.15]]
grads:  [-0.07462849]
Stock Position:  -0.07462849090926439
Bond Position:  [1.15442855]


portfolio before change:  [-6.05348899]
curr_Stock_Price:  96.58495834331733
curr_Factors:  [96.58495834]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141075]
Stock Position:  -0.03141074621196931
Bond Position:  [-3.01968337]


portfolio before change:  [-6.05857402]
curr_Stock_Price:  96.74083822942714
curr_Factors:  [96.74083823]
mat_Sqrt:  [[0.15]]
grads:  [0.0867436]
Stock Position:  0.08674360224308371
Bond Position:  [-14.45022282]


portfolio before change:  [-5.98542472]
curr_Stock_Price:  97.59453194412845
curr_Factors:  [97.59453194]
mat_Sqrt:  [[0.15]]
grads:  [-0.06932862]
Stock Position:  -0.06932862122976892
Bond Position:  [0.78066962]


portfolio before change:  [-6.0210045]
curr_Stock_Price:  98.1084404504147
curr_Factors:  [98.10844045]
mat_Sqrt:  [[0.15]]
grads:  [0.04529181]
Stock Position:  0.04529181366256841
Bond Position:  [-10.4645137]


portfolio before change:  [-6.02136399]
curr_Stock_Price:  98.11494418096132
curr_Factors:  [98.11494418]
mat_Sqrt:  [[0.15]]
grads:  [-0.03882771]
Stock Position:  -0.03882771280393415
Bond Position:  [-2.21178511]


portfolio before change:  [-6.03388547]
curr_Stock_Price:  98.43387205132007
curr_Factors:  [98.43387205]
mat_Sqrt:  [[0.15]]
grads:  [0.07353723]
Stock Position:  0.07353723158629309
Bond Position:  [-13.27243991]


portfolio before change:  [-6.00205876]
curr_Stock_Price:  98.87794992610687
curr_Factors:  [98.87794993]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994637]
Stock Position:  -0.029946368076902853
Bond Position:  [-3.04102328]


portfolio before change:  [-5.98153211]
curr_Stock_Price:  98.1861558041834
curr_Factors:  [98.1861558]
mat_Sqrt:  [[0.15]]
grads:  [0.04760121]
Stock Position:  0.04760120541155426
Bond Position:  [-10.65531148]


portfolio before change:  [-5.993967]
curr_Stock_Price:  97.9389161101598
curr_Factors:  [97.93891611]
mat_Sqrt:  [[0.15]]
grads:  [-0.08916019]
Stock Position:  -0.08916019350154247
Bond Position:  [2.73828572]


portfolio before change:  [-6.01353078]
curr_Stock_Price:  98.16025851008325
curr_Factors:  [98.16025851]
mat_Sqrt:  [[0.15]]
grads:  [-0.05135785]
Stock Position:  -0.0513578504749756
Bond Position:  [-0.9722309]


portfolio before change:  [-6.0204817]
curr_Stock_Price:  98.29441831492295
curr_Factors:  [98.29441831]
mat_Sqrt:  [[0.15]]
grads:  [0.00215214]
Stock Position:  0.002152136166695094
Bond Position:  [-6.23202468]


portfolio before change:  [-6.021275]
curr_Stock_Price:  98.10680059386463
curr_Factors:  [98.10680059]
mat_Sqrt:  [[0.15]]
grads:  [0.01460782]
Stock Position:  0.014607817698927397
Bond Position:  [-7.45440125]


portfolio before change:  [-6.01799868]
curr_Stock_Price:  98.36298065049589
curr_Factors:  [98.36298065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.01799868]
Stock Price:  99.09426738371526
PL:  [-6.01799868]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 2.27520628e-04]
 [ 1.21370002e-03]
 [-4.28794062e-03]
 [ 4.38773972e-03]
 [ 1.04882415e-02]
 [ 2.74606535e-02]
 [ 1.73644112e-03]
 [ 2.90356809e-03]
 [ 2.46014848e-02]
 [-4.69314090e-03]
 [ 3.01717301e-02]
 [-5.76508191e-02]
 [ 5.73159528e-02]
 [ 8.87200480e-03]
 [-6.89440529e-03]
 [ 2.60603201e-02]
 [ 1.07837365e-02]
 [-1.10771261e-02]
 [-5.36095364e-04]
 [ 1.27578667e-02]
 [ 1.21439950e-02]
 [-6.15436396e-03]
 [ 7.67499493e-03]
 [ 1.10751737e-02]
 [ 2.02312621e-03]
 [ 1.02473219e-02]
 [-5.44871056e-03]
 [ 9.49303551e-03]
 [ 2.26876745e-02]
 [-7.22419813e-04]
 [ 1.28769140e-02]
 [-7.71117767e-03]
 [ 5.88847409e-03]
 [ 6.16200482e-03]
 [ 1.14458265e-02]
 [ 1.23910135e-02]
 [-3.48913364e-02]
 [ 8.81934241e-03]
 [-2.23782506e-02]
 [ 2.01146737e-02]
 [-6.23543981e-03]
 [ 1.25698759e-02]
 [ 2.30340535e-02]
 [ 4.35365572e-03]
 [ 5.18924650e-04]
 [-1.62849255e-03]
 [ 1.01958187e-03]
 [-1.22092097e-02]
 [-3.20328924e-03]
 [-1.01230662e-03]
 [ 4.25915742e-02]
 [-2.60096734e-03]
 [ 2.01561328e-03]
 [ 4.75723378e-03]
 [ 3.80135690e-03]
 [ 8.16106860e-04]
 [ 1.10387489e-03]
 [-6.69375459e-04]
 [ 1.54584107e-03]
 [-2.63285216e-02]
 [-9.06189587e-03]
 [ 1.60775275e-02]
 [ 1.56946230e-02]
 [-1.92662660e-02]
 [-3.73692484e-03]
 [-1.97273190e-02]
 [-4.19815142e-03]
 [-7.50309072e-04]
 [-1.72448372e-02]
 [ 1.45709715e-02]
 [ 4.40790155e-03]
 [ 1.22623421e-02]
 [ 3.70683423e-03]
 [ 1.12886777e-03]
 [ 5.94881448e-03]
 [-1.92118076e-02]
 [ 4.83208909e-03]
 [ 8.61810293e-03]
 [ 3.07656367e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.89772211]
curr_Stock_Price:  100.3157706519796
curr_Factors:  [100.31577065]
mat_Sqrt:  [[0.15]]
grads:  [0.0015168]
Stock Position:  0.0015168041865330022
Bond Position:  [6.74556272]


portfolio before change:  [6.89893408]
curr_Stock_Price:  100.83684144626001
curr_Factors:  [100.83684145]
mat_Sqrt:  [[0.15]]
grads:  [0.00809133]
Stock Position:  0.008091333494521104
Bond Position:  [6.08302957]


portfolio before change:  [6.90522157]
curr_Stock_Price:  101.56691823487611
curr_Factors:  [101.56691823]
mat_Sqrt:  [[0.15]]
grads:  [-0.02858627]
Stock Position:  -0.028586270796574147
Bond Position:  [9.808641]


portfolio before change:  [6.92248767]
curr_Stock_Price:  100.98436460390565
curr_Factors:  [100.9843646]
mat_Sqrt:  [[0.15]]
grads:  [0.0292516]
Stock Position:  0.02925159812621512
Bond Position:  [3.96853362]


portfolio before change:  [6.92164405]
curr_Stock_Price:  100.94704500321505
curr_Factors:  [100.947045]
mat_Sqrt:  [[0.15]]
grads:  [0.06992161]
Stock Position:  0.0699216100720893
Bond Position:  [-0.13673587]


portfolio before change:  [6.94346063]
curr_Stock_Price:  101.25918198787214
curr_Factors:  [101.25918199]
mat_Sqrt:  [[0.15]]
grads:  [0.18307102]
Stock Position:  0.1830710230741981
Bond Position:  [-11.59416141]


portfolio before change:  [6.94283733]
curr_Stock_Price:  101.25973568218902
curr_Factors:  [101.25973568]
mat_Sqrt:  [[0.15]]
grads:  [0.01157627]
Stock Position:  0.011576274145038014
Bond Position:  [5.77062687]


portfolio before change:  [6.94583495]
curr_Stock_Price:  101.48752394142505
curr_Factors:  [101.48752394]
mat_Sqrt:  [[0.15]]
grads:  [0.01935712]
Stock Position:  0.019357120571760547
Bond Position:  [4.98132871]


portfolio before change:  [6.95976302]
curr_Stock_Price:  102.19097189971738
curr_Factors:  [102.1909719]
mat_Sqrt:  [[0.15]]
grads:  [0.1640099]
Stock Position:  0.16400989861659326
Bond Position:  [-9.80056792]


portfolio before change:  [6.92862993]
curr_Stock_Price:  102.0048822920118
curr_Factors:  [102.00488229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03128761]
Stock Position:  -0.031287606020782316
Bond Position:  [10.1201185]


portfolio before change:  [6.93483501]
curr_Stock_Price:  101.82677495740958
curr_Factors:  [101.82677496]
mat_Sqrt:  [[0.15]]
grads:  [0.20114487]
Stock Position:  0.20114486730723172
Bond Position:  [-13.54709813]


portfolio before change:  [6.89934527]
curr_Stock_Price:  101.65454577053431
curr_Factors:  [101.65454577]
mat_Sqrt:  [[0.15]]
grads:  [-0.38433879]
Stock Position:  -0.38433879405817606
Bond Position:  [45.9691308]


portfolio before change:  [6.83540209]
curr_Stock_Price:  101.82839327448626
curr_Factors:  [101.82839327]
mat_Sqrt:  [[0.15]]
grads:  [0.38210635]
Stock Position:  0.3821063518186174
Bond Position:  [-32.07387378]


portfolio before change:  [6.93276998]
curr_Stock_Price:  102.08845849462367
curr_Factors:  [102.08845849]
mat_Sqrt:  [[0.15]]
grads:  [0.0591467]
Stock Position:  0.059146698683407994
Bond Position:  [0.89457469]


portfolio before change:  [6.992854]
curr_Stock_Price:  103.10336054976645
curr_Factors:  [103.10336055]
mat_Sqrt:  [[0.15]]
grads:  [-0.0459627]
Stock Position:  -0.04596270191712262
Bond Position:  [11.73176303]


portfolio before change:  [7.03178679]
curr_Stock_Price:  102.2722621453215
curr_Factors:  [102.27226215]
mat_Sqrt:  [[0.15]]
grads:  [0.17373547]
Stock Position:  0.17373546717881147
Bond Position:  [-10.73653246]


portfolio before change:  [6.9323455]
curr_Stock_Price:  101.70375279363715
curr_Factors:  [101.70375279]
mat_Sqrt:  [[0.15]]
grads:  [0.07189158]
Stock Position:  0.07189157645690379
Bond Position:  [-0.37929762]


portfolio before change:  [6.91241797]
curr_Stock_Price:  101.42689388185141
curr_Factors:  [101.42689388]
mat_Sqrt:  [[0.15]]
grads:  [-0.07384751]
Stock Position:  -0.07384750701642337
Bond Position:  [14.40254122]


portfolio before change:  [6.95935893]
curr_Stock_Price:  100.8034364274125
curr_Factors:  [100.80343643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00357397]
Stock Position:  -0.0035739690956631
Bond Position:  [7.3196273]


portfolio before change:  [6.96270152]
curr_Stock_Price:  99.99618289256831
curr_Factors:  [99.99618289]
mat_Sqrt:  [[0.15]]
grads:  [0.08505244]
Stock Position:  0.0850524447538586
Bond Position:  [-1.5422183]


portfolio before change:  [7.03100572]
curr_Stock_Price:  100.80039954554084
curr_Factors:  [100.80039955]
mat_Sqrt:  [[0.15]]
grads:  [0.08095997]
Stock Position:  0.08095996639103431
Bond Position:  [-1.12979124]


portfolio before change:  [7.02574896]
curr_Stock_Price:  100.7363413278846
curr_Factors:  [100.73634133]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102909]
Stock Position:  -0.041029093064379574
Bond Position:  [11.15886968]


portfolio before change:  [7.00868477]
curr_Stock_Price:  101.16924490349118
curr_Factors:  [101.1692449]
mat_Sqrt:  [[0.15]]
grads:  [0.05116663]
Stock Position:  0.051166632854458056
Bond Position:  [1.83219516]


portfolio before change:  [7.02798495]
curr_Stock_Price:  101.5442094385385
curr_Factors:  [101.54420944]
mat_Sqrt:  [[0.15]]
grads:  [0.07383449]
Stock Position:  0.07383449121891456
Bond Position:  [-0.46948009]


portfolio before change:  [7.05081719]
curr_Stock_Price:  101.85384228001014
curr_Factors:  [101.85384228]
mat_Sqrt:  [[0.15]]
grads:  [0.01348751]
Stock Position:  0.013487508098836433
Bond Position:  [5.67706267]


portfolio before change:  [7.05218804]
curr_Stock_Price:  101.92917226674736
curr_Factors:  [101.92917227]
mat_Sqrt:  [[0.15]]
grads:  [0.06831548]
Stock Position:  0.06831547932494401
Bond Position:  [0.08884778]


portfolio before change:  [7.04051268]
curr_Stock_Price:  101.75818750945885
curr_Factors:  [101.75818751]
mat_Sqrt:  [[0.15]]
grads:  [-0.03632474]
Stock Position:  -0.03632473706953718
Bond Position:  [10.73685209]


portfolio before change:  [7.02975244]
curr_Stock_Price:  102.07288550219859
curr_Factors:  [102.0728855]
mat_Sqrt:  [[0.15]]
grads:  [0.0632869]
Stock Position:  0.06328690337553308
Bond Position:  [0.56987559]


portfolio before change:  [7.00529417]
curr_Stock_Price:  101.68585617166065
curr_Factors:  [101.68585617]
mat_Sqrt:  [[0.15]]
grads:  [0.15125116]
Stock Position:  0.15125116305449116
Bond Position:  [-8.37480985]


portfolio before change:  [7.06629493]
curr_Stock_Price:  102.09262465358269
curr_Factors:  [102.09262465]
mat_Sqrt:  [[0.15]]
grads:  [-0.00481613]
Stock Position:  -0.004816132085508585
Bond Position:  [7.5579865]


portfolio before change:  [7.06710558]
curr_Stock_Price:  102.02238905567211
curr_Factors:  [102.02238906]
mat_Sqrt:  [[0.15]]
grads:  [0.08584609]
Stock Position:  0.085846093234482
Bond Position:  [-1.69111794]


portfolio before change:  [7.13967692]
curr_Stock_Price:  102.8689859525228
curr_Factors:  [102.86898595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05140785]
Stock Position:  -0.05140785113717416
Bond Position:  [12.42795044]


portfolio before change:  [7.17408465]
curr_Stock_Price:  102.21478705141922
curr_Factors:  [102.21478705]
mat_Sqrt:  [[0.15]]
grads:  [0.03925649]
Stock Position:  0.039256493930805166
Bond Position:  [3.16149048]


portfolio before change:  [7.10118176]
curr_Stock_Price:  100.35266235841566
curr_Factors:  [100.35266236]
mat_Sqrt:  [[0.15]]
grads:  [0.04108003]
Stock Position:  0.041080032164311185
Bond Position:  [2.97869117]


portfolio before change:  [7.11718258]
curr_Stock_Price:  100.73763395808693
curr_Factors:  [100.73763396]
mat_Sqrt:  [[0.15]]
grads:  [0.07630551]
Stock Position:  0.0763055101406374
Bond Position:  [-0.56965396]


portfolio before change:  [7.05921723]
curr_Stock_Price:  99.9784521638929
curr_Factors:  [99.97845216]
mat_Sqrt:  [[0.15]]
grads:  [0.08260676]
Stock Position:  0.08260675668068251
Bond Position:  [-1.19967845]


portfolio before change:  [6.95754263]
curr_Stock_Price:  98.74853328218438
curr_Factors:  [98.74853328]
mat_Sqrt:  [[0.15]]
grads:  [-0.23260891]
Stock Position:  -0.23260890960355632
Bond Position:  [29.92733129]


portfolio before change:  [7.1436462]
curr_Stock_Price:  97.95650408544796
curr_Factors:  [97.95650409]
mat_Sqrt:  [[0.15]]
grads:  [0.05879562]
Stock Position:  0.05879561604632086
Bond Position:  [1.38423319]


portfolio before change:  [7.13643042]
curr_Stock_Price:  97.83230606060239
curr_Factors:  [97.83230606]
mat_Sqrt:  [[0.15]]
grads:  [-0.14918834]
Stock Position:  -0.14918833732740602
Bond Position:  [21.73186949]


portfolio before change:  [7.12102459]
curr_Stock_Price:  97.94467485064453
curr_Factors:  [97.94467485]
mat_Sqrt:  [[0.15]]
grads:  [0.13409782]
Stock Position:  0.1340978249847702
Bond Position:  [-6.01314328]


portfolio before change:  [7.15687134]
curr_Stock_Price:  98.21479546052745
curr_Factors:  [98.21479546]
mat_Sqrt:  [[0.15]]
grads:  [-0.0415696]
Stock Position:  -0.04156959871867912
Bond Position:  [11.23962098]


portfolio before change:  [7.16261411]
curr_Stock_Price:  98.09354653084675
curr_Factors:  [98.09354653]
mat_Sqrt:  [[0.15]]
grads:  [0.08379917]
Stock Position:  0.08379917282556974
Bond Position:  [-1.05754395]


portfolio before change:  [7.13798331]
curr_Stock_Price:  97.80040874480399
curr_Factors:  [97.80040874]
mat_Sqrt:  [[0.15]]
grads:  [0.15356036]
Stock Position:  0.15356035634590598
Bond Position:  [-7.88028231]


portfolio before change:  [7.12760974]
curr_Stock_Price:  97.73606251980083
curr_Factors:  [97.73606252]
mat_Sqrt:  [[0.15]]
grads:  [0.02902437]
Stock Position:  0.02902437146113516
Bond Position:  [4.29088196]


portfolio before change:  [7.12409282]
curr_Stock_Price:  97.60565104150689
curr_Factors:  [97.60565104]
mat_Sqrt:  [[0.15]]
grads:  [0.0034595]
Stock Position:  0.0034594976677512538
Bond Position:  [6.7864263]


portfolio before change:  [7.12576154]
curr_Stock_Price:  97.96539977522544
curr_Factors:  [97.96539978]
mat_Sqrt:  [[0.15]]
grads:  [-0.01085662]
Stock Position:  -0.01085661701748684
Bond Position:  [8.18933436]


portfolio before change:  [7.12291604]
curr_Stock_Price:  98.274643541399
curr_Factors:  [98.27464354]
mat_Sqrt:  [[0.15]]
grads:  [0.00679721]
Stock Position:  0.0067972124344565146
Bond Position:  [6.45492241]


portfolio before change:  [7.1210508]
curr_Stock_Price:  97.94087539935562
curr_Factors:  [97.9408754]
mat_Sqrt:  [[0.15]]
grads:  [-0.08139473]
Stock Position:  -0.08139473134051632
Bond Position:  [15.09292204]


portfolio before change:  [7.17628767]
curr_Stock_Price:  97.27383547241875
curr_Factors:  [97.27383547]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135526]
Stock Position:  -0.021355261625408108
Bond Position:  [9.25359587]


portfolio before change:  [7.17383846]
curr_Stock_Price:  97.41560731996934
curr_Factors:  [97.41560732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00674871]
Stock Position:  -0.00674871082995028
Bond Position:  [7.83126823]


portfolio before change:  [7.17512607]
curr_Stock_Price:  97.29734149280841
curr_Factors:  [97.29734149]
mat_Sqrt:  [[0.15]]
grads:  [0.28394383]
Stock Position:  0.2839438279998321
Bond Position:  [-20.45185352]


portfolio before change:  [6.95738332]
curr_Stock_Price:  96.53499184942294
curr_Factors:  [96.53499185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01733978]
Stock Position:  -0.017339782288852343
Bond Position:  [8.63127906]


portfolio before change:  [6.96059632]
curr_Stock_Price:  96.38080703478423
curr_Factors:  [96.38080703]
mat_Sqrt:  [[0.15]]
grads:  [0.01343742]
Stock Position:  0.013437421880262904
Bond Position:  [5.66548675]


portfolio before change:  [6.95108926]
curr_Stock_Price:  95.64694905702423
curr_Factors:  [95.64694906]
mat_Sqrt:  [[0.15]]
grads:  [0.03171489]
Stock Position:  0.03171489185128835
Bond Position:  [3.91765662]


portfolio before change:  [6.96680529]
curr_Stock_Price:  96.13476929396653
curr_Factors:  [96.13476929]
mat_Sqrt:  [[0.15]]
grads:  [0.02534238]
Stock Position:  0.025342379315554175
Bond Position:  [4.5305215]


portfolio before change:  [6.98018683]
curr_Stock_Price:  96.65162583172655
curr_Factors:  [96.65162583]
mat_Sqrt:  [[0.15]]
grads:  [0.00544071]
Stock Position:  0.005440712397343772
Bond Position:  [6.45433313]


portfolio before change:  [6.98303768]
curr_Stock_Price:  97.10146302544985
curr_Factors:  [97.10146303]
mat_Sqrt:  [[0.15]]
grads:  [0.00735917]
Stock Position:  0.0073591659125000946
Bond Position:  [6.2684519]


portfolio before change:  [6.98785421]
curr_Stock_Price:  97.70271966771452
curr_Factors:  [97.70271967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0044625]
Stock Position:  -0.004462503058801491
Bond Position:  [7.4238529]


portfolio before change:  [6.99256124]
curr_Stock_Price:  96.7519023248825
curr_Factors:  [96.75190232]
mat_Sqrt:  [[0.15]]
grads:  [0.01030561]
Stock Position:  0.010305607124792298
Bond Position:  [5.99547415]


portfolio before change:  [6.98818189]
curr_Stock_Price:  96.290592449789
curr_Factors:  [96.29059245]
mat_Sqrt:  [[0.15]]
grads:  [-0.17552348]
Stock Position:  -0.17552347702514154
Bond Position:  [23.88944149]


portfolio before change:  [7.0563529]
curr_Stock_Price:  95.91071237438311
curr_Factors:  [95.91071237]
mat_Sqrt:  [[0.15]]
grads:  [-0.06041264]
Stock Position:  -0.06041263910035958
Bond Position:  [12.85057216]


portfolio before change:  [7.06488228]
curr_Stock_Price:  95.78282198381636
curr_Factors:  [95.78282198]
mat_Sqrt:  [[0.15]]
grads:  [0.10718352]
Stock Position:  0.10718351666905608
Bond Position:  [-3.20145741]


portfolio before change:  [7.01351657]
curr_Stock_Price:  95.30545733916193
curr_Factors:  [95.30545734]
mat_Sqrt:  [[0.15]]
grads:  [0.10463082]
Stock Position:  0.10463081979037013
Bond Position:  [-2.95837157]


portfolio before change:  [6.97738028]
curr_Stock_Price:  94.96185507967131
curr_Factors:  [94.96185508]
mat_Sqrt:  [[0.15]]
grads:  [-0.12844177]
Stock Position:  -0.12844177343756352
Bond Position:  [19.17444935]


portfolio before change:  [6.96312821]
curr_Stock_Price:  95.08214701296933
curr_Factors:  [95.08214701]
mat_Sqrt:  [[0.15]]
grads:  [-0.02491283]
Stock Position:  -0.024912832248085853
Bond Position:  [9.33189379]


portfolio before change:  [6.96759757]
curr_Stock_Price:  94.9261590024692
curr_Factors:  [94.926159]
mat_Sqrt:  [[0.15]]
grads:  [-0.13151546]
Stock Position:  -0.13151546005813958
Bond Position:  [19.45185504]


portfolio before change:  [6.97913097]
curr_Stock_Price:  94.84770727813371
curr_Factors:  [94.84770728]
mat_Sqrt:  [[0.15]]
grads:  [-0.02798768]
Stock Position:  -0.027987676136898183
Bond Position:  [9.63369788]


portfolio before change:  [6.9927995]
curr_Stock_Price:  94.3808444192975
curr_Factors:  [94.38084442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500206]
Stock Position:  -0.005002060482299046
Bond Position:  [7.46489819]


portfolio before change:  [6.99265459]
curr_Stock_Price:  94.50309046360903
curr_Factors:  [94.50309046]
mat_Sqrt:  [[0.15]]
grads:  [-0.11496558]
Stock Position:  -0.11496558112535349
Bond Position:  [17.8572573]


portfolio before change:  [7.05941934]
curr_Stock_Price:  93.93206180822918
curr_Factors:  [93.93206181]
mat_Sqrt:  [[0.15]]
grads:  [0.09713981]
Stock Position:  0.0971398102589077
Bond Position:  [-2.06512332]


portfolio before change:  [7.17530787]
curr_Stock_Price:  95.12639817178943
curr_Factors:  [95.12639817]
mat_Sqrt:  [[0.15]]
grads:  [0.02938601]
Stock Position:  0.029386010321888666
Bond Position:  [4.37992256]


portfolio before change:  [7.16969338]
curr_Stock_Price:  94.92602224596034
curr_Factors:  [94.92602225]
mat_Sqrt:  [[0.15]]
grads:  [0.08174895]
Stock Position:  0.0817489470148219
Bond Position:  [-0.59040898]


portfolio before change:  [7.15714588]
curr_Stock_Price:  94.7729854230924
curr_Factors:  [94.77298542]
mat_Sqrt:  [[0.15]]
grads:  [0.02471223]
Stock Position:  0.02471222820917359
Bond Position:  [4.81509423]


portfolio before change:  [7.14836487]
curr_Stock_Price:  94.40547670527548
curr_Factors:  [94.40547671]
mat_Sqrt:  [[0.15]]
grads:  [0.00752579]
Stock Position:  0.007525785120383169
Bond Position:  [6.43788954]


portfolio before change:  [7.15345695]
curr_Stock_Price:  95.02862773270381
curr_Factors:  [95.02862773]
mat_Sqrt:  [[0.15]]
grads:  [0.03965876]
Stock Position:  0.039658763197908516
Bond Position:  [3.38473911]


portfolio before change:  [7.12851028]
curr_Stock_Price:  94.39426029502113
curr_Factors:  [94.3942603]
mat_Sqrt:  [[0.15]]
grads:  [-0.12807872]
Stock Position:  -0.12807871734740828
Bond Position:  [19.21840606]


portfolio before change:  [7.22132121]
curr_Stock_Price:  93.67899902501831
curr_Factors:  [93.67899903]
mat_Sqrt:  [[0.15]]
grads:  [0.03221393]
Stock Position:  0.03221392728420131
Bond Position:  [4.20355275]


portfolio before change:  [7.21361239]
curr_Stock_Price:  93.43154234005044
curr_Factors:  [93.43154234]
mat_Sqrt:  [[0.15]]
grads:  [0.05745402]
Stock Position:  0.05745401956396028
Bond Position:  [1.84559473]


portfolio before change:  [7.2199869]
curr_Stock_Price:  93.54048428777432
curr_Factors:  [93.54048429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.2199869]
Stock Price:  93.40373154933826
PL:  [7.2199869]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.93723523e-04]
 [ 3.34741833e-04]
 [-4.23766087e-03]
 [ 5.47287474e-03]
 [ 3.03338225e-03]
 [ 2.83318522e-02]
 [ 1.19197495e-03]
 [-5.06843168e-03]
 [ 2.30331749e-02]
 [-4.79423571e-03]
 [ 2.11933495e-02]
 [-3.42668272e-02]
 [ 4.94570324e-02]
 [ 7.25481840e-03]
 [-6.89901749e-03]
 [ 3.01989726e-02]
 [ 1.27991951e-02]
 [-8.48658477e-03]
 [ 4.02133502e-03]
 [-5.97056329e-03]
 [ 1.28601580e-02]
 [-6.73694730e-03]
 [ 9.15767467e-03]
 [ 1.06483214e-02]
 [ 1.25322762e-03]
 [ 1.44896347e-02]
 [-6.45059761e-03]
 [ 5.89198657e-03]
 [ 1.07530959e-02]
 [-8.82360454e-04]
 [ 7.81077470e-03]
 [-1.21076892e-02]
 [ 3.94027338e-03]
 [ 4.57045010e-03]
 [ 1.20386982e-02]
 [ 1.34892415e-02]
 [-3.51452748e-02]
 [ 9.48423791e-03]
 [-1.36340211e-02]
 [ 2.47990049e-02]
 [-6.21420591e-03]
 [-1.49732213e-02]
 [ 2.30150070e-02]
 [ 2.22062792e-03]
 [-6.88515885e-03]
 [-1.32006319e-03]
 [ 7.94479847e-03]
 [-1.18069943e-02]
 [-1.39105910e-02]
 [-5.48183084e-03]
 [ 4.73682905e-02]
 [-1.01382374e-02]
 [ 3.49055037e-03]
 [ 5.31081261e-03]
 [ 5.64454218e-03]
 [-2.49662857e-03]
 [ 6.89149996e-03]
 [-4.24673765e-05]
 [ 1.55839603e-03]
 [ 1.47179270e-02]
 [-4.87549065e-04]
 [-9.78109713e-03]
 [-8.86499875e-03]
 [-1.46304642e-02]
 [-1.35709272e-02]
 [-1.88442146e-03]
 [-4.80675177e-03]
 [ 1.52374214e-02]
 [-1.13081055e-02]
 [ 1.10551340e-02]
 [ 1.22166686e-03]
 [ 1.19334279e-02]
 [ 2.81135893e-03]
 [-6.00609247e-04]
 [-4.31699067e-04]
 [-1.53803590e-02]
 [ 5.11139724e-03]
 [ 6.37845134e-03]
 [-2.48067500e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.87467298]
curr_Stock_Price:  100.76944659559648
curr_Factors:  [100.7694466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195816]
Stock Position:  -0.0019581568179429776
Bond Position:  [14.07199536]


portfolio before change:  [13.87519802]
curr_Stock_Price:  100.95047556549692
curr_Factors:  [100.95047557]
mat_Sqrt:  [[0.15]]
grads:  [0.00223161]
Stock Position:  0.002231612216970994
Bond Position:  [13.64991571]


portfolio before change:  [13.87605841]
curr_Stock_Price:  100.95372294509846
curr_Factors:  [100.95372295]
mat_Sqrt:  [[0.15]]
grads:  [-0.02825107]
Stock Position:  -0.028251072444124524
Bond Position:  [16.72810935]


portfolio before change:  [13.88345659]
curr_Stock_Price:  100.72885955286539
curr_Factors:  [100.72885955]
mat_Sqrt:  [[0.15]]
grads:  [0.03648583]
Stock Position:  0.03648583157043523
Bond Position:  [10.20828038]


portfolio before change:  [13.86799437]
curr_Stock_Price:  100.28758548935988
curr_Factors:  [100.28758549]
mat_Sqrt:  [[0.15]]
grads:  [0.02022255]
Stock Position:  0.02022254833477122
Bond Position:  [11.83992383]


portfolio before change:  [13.87629582]
curr_Stock_Price:  100.66149625971065
curr_Factors:  [100.66149626]
mat_Sqrt:  [[0.15]]
grads:  [0.18887901]
Stock Position:  0.1888790148350492
Bond Position:  [-5.13654843]


portfolio before change:  [13.9375323]
curr_Stock_Price:  100.98740608000182
curr_Factors:  [100.98740608]
mat_Sqrt:  [[0.15]]
grads:  [0.0079465]
Stock Position:  0.007946499636142296
Bond Position:  [13.13503592]


portfolio before change:  [13.93938118]
curr_Stock_Price:  101.11676039510586
curr_Factors:  [101.1167604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03378954]
Stock Position:  -0.03378954452961408
Bond Position:  [17.35607046]


portfolio before change:  [13.93773953]
curr_Stock_Price:  101.19744925297258
curr_Factors:  [101.19744925]
mat_Sqrt:  [[0.15]]
grads:  [0.1535545]
Stock Position:  0.1535544992578388
Bond Position:  [-1.60158412]


portfolio before change:  [13.92179418]
curr_Stock_Price:  101.09425952767218
curr_Factors:  [101.09425953]
mat_Sqrt:  [[0.15]]
grads:  [-0.03196157]
Stock Position:  -0.03196157138295315
Bond Position:  [17.15292557]


portfolio before change:  [13.91858846]
curr_Stock_Price:  101.22810181753144
curr_Factors:  [101.22810182]
mat_Sqrt:  [[0.15]]
grads:  [0.141289]
Stock Position:  0.14128899658235644
Bond Position:  [-0.38382847]


portfolio before change:  [14.03090765]
curr_Stock_Price:  102.02323223588314
curr_Factors:  [102.02323224]
mat_Sqrt:  [[0.15]]
grads:  [-0.22844551]
Stock Position:  -0.2284455146634414
Bond Position:  [37.33765745]


portfolio before change:  [14.12366265]
curr_Stock_Price:  101.62742088534
curr_Factors:  [101.62742089]
mat_Sqrt:  [[0.15]]
grads:  [0.32971355]
Stock Position:  0.3297135491079384
Bond Position:  [-19.38427497]


portfolio before change:  [14.207802]
curr_Stock_Price:  101.88628468681678
curr_Factors:  [101.88628469]
mat_Sqrt:  [[0.15]]
grads:  [0.04836546]
Stock Position:  0.04836545602408091
Bond Position:  [9.28002538]


portfolio before change:  [14.20905938]
curr_Stock_Price:  101.90028964627996
curr_Factors:  [101.90028965]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599345]
Stock Position:  -0.04599344991809621
Bond Position:  [18.89580525]


portfolio before change:  [14.1481377]
curr_Stock_Price:  103.25054058230332
curr_Factors:  [103.25054058]
mat_Sqrt:  [[0.15]]
grads:  [0.20132648]
Stock Position:  0.2013264843284966
Bond Position:  [-6.63893064]


portfolio before change:  [14.13737188]
curr_Stock_Price:  103.19912717679063
curr_Factors:  [103.19912718]
mat_Sqrt:  [[0.15]]
grads:  [0.08532797]
Stock Position:  0.08532796736986824
Bond Position:  [5.33160012]


portfolio before change:  [14.09204863]
curr_Stock_Price:  102.66405659044374
curr_Factors:  [102.66405659]
mat_Sqrt:  [[0.15]]
grads:  [-0.05657723]
Stock Position:  -0.05657723182809526
Bond Position:  [19.90049676]


portfolio before change:  [14.11625857]
curr_Stock_Price:  102.2581314712917
curr_Factors:  [102.25813147]
mat_Sqrt:  [[0.15]]
grads:  [0.0268089]
Stock Position:  0.026808900119689005
Bond Position:  [11.37483053]


portfolio before change:  [14.12289454]
curr_Stock_Price:  102.4791411496837
curr_Factors:  [102.47914115]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980376]
Stock Position:  -0.03980375525330798
Bond Position:  [18.2019492]


portfolio before change:  [14.16896678]
curr_Stock_Price:  101.3502381971614
curr_Factors:  [101.3502382]
mat_Sqrt:  [[0.15]]
grads:  [0.08573439]
Stock Position:  0.08573438690537596
Bond Position:  [5.47976624]


portfolio before change:  [14.26374623]
curr_Stock_Price:  102.45174439455955
curr_Factors:  [102.45174439]
mat_Sqrt:  [[0.15]]
grads:  [-0.04491298]
Stock Position:  -0.044912982012713064
Bond Position:  [18.86515958]


portfolio before change:  [14.3076748]
curr_Stock_Price:  101.49991590165124
curr_Factors:  [101.4999159]
mat_Sqrt:  [[0.15]]
grads:  [0.06105116]
Stock Position:  0.06105116449299558
Bond Position:  [8.11098674]


portfolio before change:  [14.31196966]
curr_Stock_Price:  101.56196080123274
curr_Factors:  [101.5619608]
mat_Sqrt:  [[0.15]]
grads:  [0.07098881]
Stock Position:  0.0709888091198406
Bond Position:  [7.10220701]


portfolio before change:  [14.28661631]
curr_Stock_Price:  101.19856190930147
curr_Factors:  [101.19856191]
mat_Sqrt:  [[0.15]]
grads:  [0.00835485]
Stock Position:  0.008354850794273274
Bond Position:  [13.44111742]


portfolio before change:  [14.28200703]
curr_Stock_Price:  100.54632116048832
curr_Factors:  [100.54632116]
mat_Sqrt:  [[0.15]]
grads:  [0.09659756]
Stock Position:  0.09659756440369953
Bond Position:  [4.5694773]


portfolio before change:  [14.29284371]
curr_Stock_Price:  100.65554827393885
curr_Factors:  [100.65554827]
mat_Sqrt:  [[0.15]]
grads:  [-0.04300398]
Stock Position:  -0.04300398403603006
Bond Position:  [18.6214333]


portfolio before change:  [14.30767523]
curr_Stock_Price:  100.3377254842155
curr_Factors:  [100.33772548]
mat_Sqrt:  [[0.15]]
grads:  [0.03927991]
Stock Position:  0.039279910495612004
Bond Position:  [10.36641835]


portfolio before change:  [14.33260017]
curr_Stock_Price:  100.95577740049887
curr_Factors:  [100.9557774]
mat_Sqrt:  [[0.15]]
grads:  [0.07168731]
Stock Position:  0.07168730574405595
Bond Position:  [7.09535249]


portfolio before change:  [14.40773656]
curr_Stock_Price:  101.99770405403893
curr_Factors:  [101.99770405]
mat_Sqrt:  [[0.15]]
grads:  [-0.0058824]
Stock Position:  -0.005882403028567855
Bond Position:  [15.00772816]


portfolio before change:  [14.41526304]
curr_Stock_Price:  100.87767522408333
curr_Factors:  [100.87767522]
mat_Sqrt:  [[0.15]]
grads:  [0.05207183]
Stock Position:  0.05207183131659004
Bond Position:  [9.16237775]


portfolio before change:  [14.4022853]
curr_Stock_Price:  100.6174500472534
curr_Factors:  [100.61745005]
mat_Sqrt:  [[0.15]]
grads:  [-0.08071793]
Stock Position:  -0.0807179282286602
Bond Position:  [22.52391741]


portfolio before change:  [14.43100264]
curr_Stock_Price:  100.27911694633949
curr_Factors:  [100.27911695]
mat_Sqrt:  [[0.15]]
grads:  [0.02626849]
Stock Position:  0.026268489205089198
Bond Position:  [11.79682173]


portfolio before change:  [14.40975201]
curr_Stock_Price:  99.44207024537633
curr_Factors:  [99.44207025]
mat_Sqrt:  [[0.15]]
grads:  [0.03046967]
Stock Position:  0.030469667356915302
Bond Position:  [11.37978521]


portfolio before change:  [14.41019025]
curr_Stock_Price:  99.43311006511573
curr_Factors:  [99.43311007]
mat_Sqrt:  [[0.15]]
grads:  [0.08025799]
Stock Position:  0.08025798806373512
Bond Position:  [6.42988889]


portfolio before change:  [14.41878128]
curr_Stock_Price:  99.53514535864797
curr_Factors:  [99.53514536]
mat_Sqrt:  [[0.15]]
grads:  [0.08992828]
Stock Position:  0.08992827669632915
Bond Position:  [5.46775719]


portfolio before change:  [14.42673759]
curr_Stock_Price:  99.61981904819505
curr_Factors:  [99.61981905]
mat_Sqrt:  [[0.15]]
grads:  [-0.23430183]
Stock Position:  -0.23430183193583543
Bond Position:  [37.76784369]


portfolio before change:  [14.46492082]
curr_Stock_Price:  99.46692793119966
curr_Factors:  [99.46692793]
mat_Sqrt:  [[0.15]]
grads:  [0.06322825]
Stock Position:  0.06322825271676949
Bond Position:  [8.17580076]


portfolio before change:  [14.46101275]
curr_Stock_Price:  99.39703719600833
curr_Factors:  [99.3970372]
mat_Sqrt:  [[0.15]]
grads:  [-0.09089347]
Stock Position:  -0.09089347428166054
Bond Position:  [23.4955548]


portfolio before change:  [14.41207046]
curr_Stock_Price:  99.95165140967677
curr_Factors:  [99.95165141]
mat_Sqrt:  [[0.15]]
grads:  [0.1653267]
Stock Position:  0.16532669900522262
Bond Position:  [-2.11260613]


portfolio before change:  [14.48212215]
curr_Stock_Price:  100.3761668414588
curr_Factors:  [100.37616684]
mat_Sqrt:  [[0.15]]
grads:  [-0.04142804]
Stock Position:  -0.04142803937693366
Bond Position:  [18.64050994]


portfolio before change:  [14.46688699]
curr_Stock_Price:  100.77203949618786
curr_Factors:  [100.7720395]
mat_Sqrt:  [[0.15]]
grads:  [-0.09982148]
Stock Position:  -0.09982147555243517
Bond Position:  [24.52610067]


portfolio before change:  [14.46445846]
curr_Stock_Price:  100.81172495552981
curr_Factors:  [100.81172496]
mat_Sqrt:  [[0.15]]
grads:  [0.15343338]
Stock Position:  0.15343337974410245
Bond Position:  [-1.00342522]


portfolio before change:  [14.52205687]
curr_Stock_Price:  101.18753057057918
curr_Factors:  [101.18753057]
mat_Sqrt:  [[0.15]]
grads:  [0.01480419]
Stock Position:  0.014804186131367426
Bond Position:  [13.02405783]


portfolio before change:  [14.52277749]
curr_Stock_Price:  101.18122078913173
curr_Factors:  [101.18122079]
mat_Sqrt:  [[0.15]]
grads:  [-0.04590106]
Stock Position:  -0.045901058980442846
Bond Position:  [19.16710267]


portfolio before change:  [14.52155714]
curr_Stock_Price:  101.23390641112029
curr_Factors:  [101.23390641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00880042]
Stock Position:  -0.008800421252496393
Bond Position:  [15.41245816]


portfolio before change:  [14.52999519]
curr_Stock_Price:  100.38454540958308
curr_Factors:  [100.38454541]
mat_Sqrt:  [[0.15]]
grads:  [0.05296532]
Stock Position:  0.052965323165701496
Bond Position:  [9.2130953]


portfolio before change:  [14.51419404]
curr_Stock_Price:  100.07534343032026
curr_Factors:  [100.07534343]
mat_Sqrt:  [[0.15]]
grads:  [-0.0787133]
Stock Position:  -0.07871329565677042
Bond Position:  [22.39145413]


portfolio before change:  [14.54123206]
curr_Stock_Price:  99.74962326963055
curr_Factors:  [99.74962327]
mat_Sqrt:  [[0.15]]
grads:  [-0.09273727]
Stock Position:  -0.0927372733309448
Bond Position:  [23.79174013]


portfolio before change:  [14.61652323]
curr_Stock_Price:  98.95378205442081
curr_Factors:  [98.95378205]
mat_Sqrt:  [[0.15]]
grads:  [-0.03654554]
Stock Position:  -0.03654553891016443
Bond Position:  [18.23284252]


portfolio before change:  [14.61870218]
curr_Stock_Price:  98.92534185120033
curr_Factors:  [98.92534185]
mat_Sqrt:  [[0.15]]
grads:  [0.3157886]
Stock Position:  0.31578860329781977
Bond Position:  [-16.62079335]


portfolio before change:  [14.55377917]
curr_Stock_Price:  98.72304140623383
curr_Factors:  [98.72304141]
mat_Sqrt:  [[0.15]]
grads:  [-0.06758825]
Stock Position:  -0.06758824965309933
Bond Position:  [21.22629674]


portfolio before change:  [14.56744608]
curr_Stock_Price:  98.54046198694745
curr_Factors:  [98.54046199]
mat_Sqrt:  [[0.15]]
grads:  [0.02327034]
Stock Position:  0.02327033580819493
Bond Position:  [12.27437644]


portfolio before change:  [14.56965672]
curr_Stock_Price:  98.602492068081
curr_Factors:  [98.60249207]
mat_Sqrt:  [[0.15]]
grads:  [0.03540542]
Stock Position:  0.0354054174182778
Bond Position:  [11.07859433]


portfolio before change:  [14.58384319]
curr_Stock_Price:  98.98362136890107
curr_Factors:  [98.98362137]
mat_Sqrt:  [[0.15]]
grads:  [0.03763028]
Stock Position:  0.03763028122122947
Bond Position:  [10.85906168]


portfolio before change:  [14.55577718]
curr_Stock_Price:  98.21974910786889
curr_Factors:  [98.21974911]
mat_Sqrt:  [[0.15]]
grads:  [-0.01664419]
Stock Position:  -0.016644190441071998
Bond Position:  [16.19056539]


portfolio before change:  [14.54219383]
curr_Stock_Price:  99.09664917192535
curr_Factors:  [99.09664917]
mat_Sqrt:  [[0.15]]
grads:  [0.04594333]
Stock Position:  0.04594333305696992
Bond Position:  [9.98936347]


portfolio before change:  [14.55943562]
curr_Stock_Price:  99.45834344154711
curr_Factors:  [99.45834344]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028312]
Stock Position:  -0.00028311584314395674
Bond Position:  [14.58759385]


portfolio before change:  [14.55995535]
curr_Stock_Price:  100.8430169584939
curr_Factors:  [100.84301696]
mat_Sqrt:  [[0.15]]
grads:  [0.01038931]
Stock Position:  0.010389306894100917
Bond Position:  [13.5122663]


portfolio before change:  [14.56951072]
curr_Stock_Price:  101.68145869552839
curr_Factors:  [101.6814587]
mat_Sqrt:  [[0.15]]
grads:  [0.09811951]
Stock Position:  0.09811951355237797
Bond Position:  [4.59257546]


portfolio before change:  [14.55217373]
curr_Stock_Price:  101.5018406496297
curr_Factors:  [101.50184065]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325033]
Stock Position:  -0.003250327097396594
Bond Position:  [14.88208792]


portfolio before change:  [14.55439587]
curr_Stock_Price:  101.10434905109277
curr_Factors:  [101.10434905]
mat_Sqrt:  [[0.15]]
grads:  [-0.06520731]
Stock Position:  -0.06520731419090715
Bond Position:  [21.14713893]


portfolio before change:  [14.60116891]
curr_Stock_Price:  100.40732140148786
curr_Factors:  [100.4073214]
mat_Sqrt:  [[0.15]]
grads:  [-0.05909999]
Stock Position:  -0.059099991694489776
Bond Position:  [20.53524077]


portfolio before change:  [14.61452359]
curr_Stock_Price:  100.20307114974915
curr_Factors:  [100.20307115]
mat_Sqrt:  [[0.15]]
grads:  [-0.09753643]
Stock Position:  -0.09753642801412228
Bond Position:  [24.38797323]


portfolio before change:  [14.71684393]
curr_Stock_Price:  99.16965171701641
curr_Factors:  [99.16965172]
mat_Sqrt:  [[0.15]]
grads:  [-0.09047285]
Stock Position:  -0.09047284802855707
Bond Position:  [23.68900475]


portfolio before change:  [14.75784125]
curr_Stock_Price:  98.73287193047757
curr_Factors:  [98.73287193]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256281]
Stock Position:  -0.01256280974442509
Bond Position:  [15.99820353]


portfolio before change:  [14.76790306]
curr_Stock_Price:  98.01154526625967
curr_Factors:  [98.01154527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204501]
Stock Position:  -0.03204501177770818
Bond Position:  [17.90868418]


portfolio before change:  [14.79818727]
curr_Stock_Price:  97.10142286948198
curr_Factors:  [97.10142287]
mat_Sqrt:  [[0.15]]
grads:  [0.10158281]
Stock Position:  0.1015828092728606
Bond Position:  [4.93435195]


portfolio before change:  [14.76138916]
curr_Stock_Price:  96.73613952345714
curr_Factors:  [96.73613952]
mat_Sqrt:  [[0.15]]
grads:  [-0.07538737]
Stock Position:  -0.07538737011367622
Bond Position:  [22.05407232]


portfolio before change:  [14.83182715]
curr_Stock_Price:  95.82007675672637
curr_Factors:  [95.82007676]
mat_Sqrt:  [[0.15]]
grads:  [0.07370089]
Stock Position:  0.07370089319455497
Bond Position:  [7.76980191]


portfolio before change:  [14.86608169]
curr_Stock_Price:  96.278265459794
curr_Factors:  [96.27826546]
mat_Sqrt:  [[0.15]]
grads:  [0.00814445]
Stock Position:  0.008144445752194668
Bond Position:  [14.08194858]


portfolio before change:  [14.8652799]
curr_Stock_Price:  96.07175191097843
curr_Factors:  [96.07175191]
mat_Sqrt:  [[0.15]]
grads:  [0.07955619]
Stock Position:  0.07955618612208522
Bond Position:  [7.22217773]


portfolio before change:  [14.85262468]
curr_Stock_Price:  95.90700507887057
curr_Factors:  [95.90700508]
mat_Sqrt:  [[0.15]]
grads:  [0.01874239]
Stock Position:  0.018742392863986417
Bond Position:  [13.05509791]


portfolio before change:  [14.85069502]
curr_Stock_Price:  95.76051215830324
curr_Factors:  [95.76051216]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400406]
Stock Position:  -0.004004061649708705
Bond Position:  [15.23412601]


portfolio before change:  [14.85072527]
curr_Stock_Price:  95.99075636659835
curr_Factors:  [95.99075637]
mat_Sqrt:  [[0.15]]
grads:  [-0.00287799]
Stock Position:  -0.0028779937771268352
Bond Position:  [15.12698607]


portfolio before change:  [14.85265693]
curr_Stock_Price:  95.64808941969811
curr_Factors:  [95.64808942]
mat_Sqrt:  [[0.15]]
grads:  [-0.10253573]
Stock Position:  -0.10253572665495622
Bond Position:  [24.66000328]


portfolio before change:  [14.89091245]
curr_Stock_Price:  95.2900266934664
curr_Factors:  [95.29002669]
mat_Sqrt:  [[0.15]]
grads:  [0.03407598]
Stock Position:  0.03407598161894381
Bond Position:  [11.64381125]


portfolio before change:  [14.89430659]
curr_Stock_Price:  95.36827489219341
curr_Factors:  [95.36827489]
mat_Sqrt:  [[0.15]]
grads:  [0.04252301]
Stock Position:  0.04252300892513947
Bond Position:  [10.83896059]


portfolio before change:  [14.89948488]
curr_Stock_Price:  95.47411944652275
curr_Factors:  [95.47411945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.89948488]
Stock Price:  95.33515058344187
PL:  [14.89948488]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.44014517e-03]
 [-2.16364714e-02]
 [-3.41848383e-03]
 [ 8.10099745e-03]
 [ 5.07712284e-03]
 [ 2.48044636e-02]
 [ 1.43020189e-03]
 [-1.21516683e-02]
 [ 2.38587215e-02]
 [-4.57245056e-03]
 [ 2.08164499e-02]
 [-2.08035904e-02]
 [ 5.97094348e-02]
 [ 7.25818645e-03]
 [-6.90356485e-03]
 [ 1.78077358e-02]
 [ 1.00525321e-02]
 [-1.20391357e-02]
 [-4.71086278e-04]
 [ 5.17407266e-03]
 [ 1.20570319e-02]
 [-6.18811692e-03]
 [ 6.83207935e-03]
 [ 2.03188849e-02]
 [-7.52207756e-03]
 [ 1.07020674e-02]
 [-7.23999997e-03]
 [ 5.67771909e-03]
 [ 3.76657226e-03]
 [-2.66177001e-03]
 [ 5.93539474e-03]
 [-1.17538262e-02]
 [ 1.72331929e-03]
 [ 4.59424862e-03]
 [ 1.21450123e-02]
 [ 1.52198522e-02]
 [-3.48370008e-02]
 [ 9.44899522e-03]
 [-1.53781676e-02]
 [ 2.16733484e-02]
 [-6.20376316e-03]
 [ 6.86338774e-03]
 [ 2.30351668e-02]
 [ 4.59818511e-03]
 [-3.11085338e-03]
 [-5.32848943e-03]
 [ 5.47585590e-04]
 [-1.23638701e-02]
 [-1.16439137e-02]
 [-6.16026875e-03]
 [ 4.75811379e-02]
 [-9.31896888e-03]
 [ 3.39228580e-03]
 [ 5.15270571e-03]
 [ 5.03593958e-03]
 [-2.41350766e-03]
 [ 6.48986342e-03]
 [-6.30556371e-04]
 [ 1.53078462e-03]
 [-3.32091923e-03]
 [-1.29213191e-03]
 [ 2.13425247e-03]
 [ 1.38331108e-02]
 [-1.85324858e-02]
 [-4.91205357e-03]
 [-1.28583977e-02]
 [-4.41484840e-03]
 [ 1.01012971e-02]
 [-1.16701042e-02]
 [ 1.00315012e-02]
 [ 7.70696730e-04]
 [ 1.20444505e-02]
 [ 3.72752230e-03]
 [ 1.57365379e-03]
 [ 1.18829941e-02]
 [-2.20658374e-02]
 [ 4.84015583e-03]
 [ 8.00270957e-03]
 [-1.45931698e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.21522768]
curr_Stock_Price:  99.46310163153518
curr_Factors:  [99.46310163]
mat_Sqrt:  [[0.15]]
grads:  [0.02960097]
Stock Position:  0.02960096779640801
Bond Position:  [-9.15943174]


portfolio before change:  [-6.23444954]
curr_Stock_Price:  98.8330756396456
curr_Factors:  [98.83307564]
mat_Sqrt:  [[0.15]]
grads:  [-0.14424314]
Stock Position:  -0.14424314299275356
Bond Position:  [8.02154393]


portfolio before change:  [-6.25103971]
curr_Stock_Price:  98.95156679500221
curr_Factors:  [98.9515668]
mat_Sqrt:  [[0.15]]
grads:  [-0.02278989]
Stock Position:  -0.02278989218582436
Bond Position:  [-3.99594417]


portfolio before change:  [-6.25930236]
curr_Stock_Price:  99.30316544095514
curr_Factors:  [99.30316544]
mat_Sqrt:  [[0.15]]
grads:  [0.05400665]
Stock Position:  0.054006649669937096
Bond Position:  [-11.62233363]


portfolio before change:  [-6.23629678]
curr_Stock_Price:  99.74259286950526
curr_Factors:  [99.74259287]
mat_Sqrt:  [[0.15]]
grads:  [0.03384749]
Stock Position:  0.03384748562458497
Bond Position:  [-9.61233275]


portfolio before change:  [-6.22460702]
curr_Stock_Price:  100.10570821762963
curr_Factors:  [100.10570822]
mat_Sqrt:  [[0.15]]
grads:  [0.16536309]
Stock Position:  0.1653630904343381
Bond Position:  [-22.77839631]


portfolio before change:  [-6.1780731]
curr_Stock_Price:  100.39572224567864
curr_Factors:  [100.39572225]
mat_Sqrt:  [[0.15]]
grads:  [0.00953468]
Stock Position:  0.009534679280250785
Bond Position:  [-7.13531412]


portfolio before change:  [-6.17629811]
curr_Stock_Price:  100.62865746235016
curr_Factors:  [100.62865746]
mat_Sqrt:  [[0.15]]
grads:  [-0.08101112]
Stock Position:  -0.08101112207029632
Bond Position:  [1.97574234]


portfolio before change:  [-6.20622978]
curr_Stock_Price:  100.99965780875256
curr_Factors:  [100.99965781]
mat_Sqrt:  [[0.15]]
grads:  [0.15905814]
Stock Position:  0.1590581435945605
Bond Position:  [-22.27104785]


portfolio before change:  [-6.15543398]
curr_Stock_Price:  101.32776287147625
curr_Factors:  [101.32776287]
mat_Sqrt:  [[0.15]]
grads:  [-0.030483]
Stock Position:  -0.030483003750210153
Bond Position:  [-3.0666594]


portfolio before change:  [-6.1518216]
curr_Stock_Price:  101.20297037590221
curr_Factors:  [101.20297038]
mat_Sqrt:  [[0.15]]
grads:  [0.13877633]
Stock Position:  0.13877633279123597
Bond Position:  [-20.1963987]


portfolio before change:  [-6.2206898]
curr_Stock_Price:  100.71581325042624
curr_Factors:  [100.71581325]
mat_Sqrt:  [[0.15]]
grads:  [-0.1386906]
Stock Position:  -0.13869060244740755
Bond Position:  [7.74764702]


portfolio before change:  [-6.38299883]
curr_Stock_Price:  101.88960063763581
curr_Factors:  [101.88960064]
mat_Sqrt:  [[0.15]]
grads:  [0.3980629]
Stock Position:  0.3980628984644424
Bond Position:  [-46.94146859]


portfolio before change:  [-6.38707709]
curr_Stock_Price:  101.88672591042395
curr_Factors:  [101.88672591]
mat_Sqrt:  [[0.15]]
grads:  [0.04838791]
Stock Position:  0.0483879096690481
Bond Position:  [-11.31716278]


portfolio before change:  [-6.41813537]
curr_Stock_Price:  101.25948380378303
curr_Factors:  [101.2594838]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602377]
Stock Position:  -0.04602376569363377
Bond Position:  [-1.75779261]


portfolio before change:  [-6.39534484]
curr_Stock_Price:  100.76190630160434
curr_Factors:  [100.7619063]
mat_Sqrt:  [[0.15]]
grads:  [0.11871824]
Stock Position:  0.1187182388356129
Bond Position:  [-18.3576209]


portfolio before change:  [-6.39479536]
curr_Stock_Price:  100.77619957272236
curr_Factors:  [100.77619957]
mat_Sqrt:  [[0.15]]
grads:  [0.06701688]
Stock Position:  0.06701688050504756
Bond Position:  [-13.14850188]


portfolio before change:  [-6.42110155]
curr_Stock_Price:  100.3959313923347
curr_Factors:  [100.39593139]
mat_Sqrt:  [[0.15]]
grads:  [-0.0802609]
Stock Position:  -0.08026090443598399
Bond Position:  [1.6367667]


portfolio before change:  [-6.36888522]
curr_Stock_Price:  99.74662363599658
curr_Factors:  [99.74662364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00314058]
Stock Position:  -0.003140575189232037
Bond Position:  [-6.05562345]


portfolio before change:  [-6.3719622]
curr_Stock_Price:  100.60585641704743
curr_Factors:  [100.60585642]
mat_Sqrt:  [[0.15]]
grads:  [0.03449382]
Stock Position:  0.03449381771636595
Bond Position:  [-9.84224227]


portfolio before change:  [-6.36929202]
curr_Stock_Price:  100.70110047025696
curr_Factors:  [100.70110047]
mat_Sqrt:  [[0.15]]
grads:  [0.08038021]
Stock Position:  0.08038021288880567
Bond Position:  [-14.46366792]


portfolio before change:  [-6.3680869]
curr_Stock_Price:  100.72733988603052
curr_Factors:  [100.72733989]
mat_Sqrt:  [[0.15]]
grads:  [-0.04125411]
Stock Position:  -0.04125411278484231
Bond Position:  [-2.21266986]


portfolio before change:  [-6.34568528]
curr_Stock_Price:  100.18097220370599
curr_Factors:  [100.1809722]
mat_Sqrt:  [[0.15]]
grads:  [0.0455472]
Stock Position:  0.045547195663970357
Bond Position:  [-10.90864763]


portfolio before change:  [-6.40192883]
curr_Stock_Price:  98.96110058756692
curr_Factors:  [98.96110059]
mat_Sqrt:  [[0.15]]
grads:  [0.13545923]
Stock Position:  0.13545923267325793
Bond Position:  [-19.80712358]


portfolio before change:  [-6.35908896]
curr_Stock_Price:  99.28649631101507
curr_Factors:  [99.28649631]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014718]
Stock Position:  -0.05014718370075496
Bond Position:  [-1.38015079]


portfolio before change:  [-6.39082572]
curr_Stock_Price:  99.91764839184647
curr_Factors:  [99.91764839]
mat_Sqrt:  [[0.15]]
grads:  [0.07134712]
Stock Position:  0.07134711631863992
Bond Position:  [-13.5196618]


portfolio before change:  [-6.39417014]
curr_Stock_Price:  99.88261655075772
curr_Factors:  [99.88261655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04826667]
Stock Position:  -0.04826666648393918
Bond Position:  [-1.5731692]


portfolio before change:  [-6.38665622]
curr_Stock_Price:  99.72490423880508
curr_Factors:  [99.72490424]
mat_Sqrt:  [[0.15]]
grads:  [0.03785146]
Stock Position:  0.037851460625774005
Bond Position:  [-10.16138951]


portfolio before change:  [-6.36242556]
curr_Stock_Price:  100.38183439658829
curr_Factors:  [100.3818344]
mat_Sqrt:  [[0.15]]
grads:  [0.02511048]
Stock Position:  0.025110481739244857
Bond Position:  [-8.88306178]


portfolio before change:  [-6.3724567]
curr_Stock_Price:  100.00446480306714
curr_Factors:  [100.0044648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774513]
Stock Position:  -0.01774513343211704
Bond Position:  [-4.59786413]


portfolio before change:  [-6.38229013]
curr_Stock_Price:  100.54241823264101
curr_Factors:  [100.54241823]
mat_Sqrt:  [[0.15]]
grads:  [0.0395693]
Stock Position:  0.03956929827177196
Bond Position:  [-10.36068307]


portfolio before change:  [-6.39788984]
curr_Stock_Price:  100.16454600352172
curr_Factors:  [100.164546]
mat_Sqrt:  [[0.15]]
grads:  [-0.07835884]
Stock Position:  -0.07835884106069699
Bond Position:  [1.4508879]


portfolio before change:  [-6.37991925]
curr_Stock_Price:  99.93636624543238
curr_Factors:  [99.93636625]
mat_Sqrt:  [[0.15]]
grads:  [0.0114888]
Stock Position:  0.01148879525125457
Bond Position:  [-7.5280677]


portfolio before change:  [-6.38554062]
curr_Stock_Price:  99.48802954045776
curr_Factors:  [99.48802954]
mat_Sqrt:  [[0.15]]
grads:  [0.03062832]
Stock Position:  0.03062832412312602
Bond Position:  [-9.43269223]


portfolio before change:  [-6.39244602]
curr_Stock_Price:  99.28182060500743
curr_Factors:  [99.28182061]
mat_Sqrt:  [[0.15]]
grads:  [0.08096675]
Stock Position:  0.08096674844109347
Bond Position:  [-14.43097221]


portfolio before change:  [-6.42114195]
curr_Stock_Price:  98.93854425081344
curr_Factors:  [98.93854425]
mat_Sqrt:  [[0.15]]
grads:  [0.10146568]
Stock Position:  0.10146568136013147
Bond Position:  [-16.46000875]


portfolio before change:  [-6.32997525]
curr_Stock_Price:  99.84718134662108
curr_Factors:  [99.84718135]
mat_Sqrt:  [[0.15]]
grads:  [-0.23224667]
Stock Position:  -0.23224667226097367
Bond Position:  [16.85920035]


portfolio before change:  [-6.22026918]
curr_Stock_Price:  99.37934972304322
curr_Factors:  [99.37934972]
mat_Sqrt:  [[0.15]]
grads:  [0.0629933]
Stock Position:  0.06299330145139291
Bond Position:  [-12.48050251]


portfolio before change:  [-6.24532219]
curr_Stock_Price:  98.9940238336621
curr_Factors:  [98.99402383]
mat_Sqrt:  [[0.15]]
grads:  [-0.10252112]
Stock Position:  -0.10252111715691684
Bond Position:  [3.90365573]


portfolio before change:  [-6.16672959]
curr_Stock_Price:  98.22980461390648
curr_Factors:  [98.22980461]
mat_Sqrt:  [[0.15]]
grads:  [0.14448899]
Stock Position:  0.1444889892428992
Bond Position:  [-20.35985477]


portfolio before change:  [-6.16907191]
curr_Stock_Price:  98.22240067090598
curr_Factors:  [98.22240067]
mat_Sqrt:  [[0.15]]
grads:  [-0.04135842]
Stock Position:  -0.04135842103774953
Bond Position:  [-2.10674851]


portfolio before change:  [-6.17778001]
curr_Stock_Price:  98.42976903717494
curr_Factors:  [98.42976904]
mat_Sqrt:  [[0.15]]
grads:  [0.04575592]
Stock Position:  0.04575591828853512
Bond Position:  [-10.68152448]


portfolio before change:  [-6.16622185]
curr_Stock_Price:  98.69696459965155
curr_Factors:  [98.6969646]
mat_Sqrt:  [[0.15]]
grads:  [0.15356778]
Stock Position:  0.153567778657738
Bond Position:  [-21.32289547]


portfolio before change:  [-6.22884618]
curr_Stock_Price:  98.29784697802664
curr_Factors:  [98.29784698]
mat_Sqrt:  [[0.15]]
grads:  [0.03065457]
Stock Position:  0.03065456742739403
Bond Position:  [-9.24212416]


portfolio before change:  [-6.23278369]
curr_Stock_Price:  98.18824315885591
curr_Factors:  [98.18824316]
mat_Sqrt:  [[0.15]]
grads:  [-0.02073902]
Stock Position:  -0.020739022565110517
Bond Position:  [-4.1964555]


portfolio before change:  [-6.24031991]
curr_Stock_Price:  98.53897972898962
curr_Factors:  [98.53897973]
mat_Sqrt:  [[0.15]]
grads:  [-0.03552326]
Stock Position:  -0.03552326286886875
Bond Position:  [-2.73989383]


portfolio before change:  [-6.26883408]
curr_Stock_Price:  99.33684893909813
curr_Factors:  [99.33684894]
mat_Sqrt:  [[0.15]]
grads:  [0.00365057]
Stock Position:  0.0036505705972494458
Bond Position:  [-6.63147026]


portfolio before change:  [-6.26981373]
curr_Stock_Price:  99.1820311456594
curr_Factors:  [99.18203115]
mat_Sqrt:  [[0.15]]
grads:  [-0.0824258]
Stock Position:  -0.08242580071319006
Bond Position:  [1.9053446]


portfolio before change:  [-6.27322764]
curr_Stock_Price:  99.22489394889186
curr_Factors:  [99.22489395]
mat_Sqrt:  [[0.15]]
grads:  [-0.07762609]
Stock Position:  -0.07762609131965932
Bond Position:  [1.42921304]


portfolio before change:  [-6.2997297]
curr_Stock_Price:  99.56745128042601
curr_Factors:  [99.56745128]
mat_Sqrt:  [[0.15]]
grads:  [-0.04106846]
Stock Position:  -0.04106845834878099
Bond Position:  [-2.21064797]


portfolio before change:  [-6.28813133]
curr_Stock_Price:  99.28167130641185
curr_Factors:  [99.28167131]
mat_Sqrt:  [[0.15]]
grads:  [0.31720759]
Stock Position:  0.3172075857086252
Bond Position:  [-37.78103059]


portfolio before change:  [-6.29618018]
curr_Stock_Price:  99.26374151312686
curr_Factors:  [99.26374151]
mat_Sqrt:  [[0.15]]
grads:  [-0.06212646]
Stock Position:  -0.06212645917739342
Bond Position:  [-0.1292754]


portfolio before change:  [-6.28020775]
curr_Stock_Price:  99.00651596344197
curr_Factors:  [99.00651596]
mat_Sqrt:  [[0.15]]
grads:  [0.02261524]
Stock Position:  0.02261523865692545
Bond Position:  [-8.51926374]


portfolio before change:  [-6.30896749]
curr_Stock_Price:  97.75836345004716
curr_Factors:  [97.75836345]
mat_Sqrt:  [[0.15]]
grads:  [0.03435137]
Stock Position:  0.034351371432471786
Bond Position:  [-9.66710134]


portfolio before change:  [-6.30711907]
curr_Stock_Price:  97.8297616704499
curr_Factors:  [97.82976167]
mat_Sqrt:  [[0.15]]
grads:  [0.03357293]
Stock Position:  0.03357293054085709
Bond Position:  [-9.59155087]


portfolio before change:  [-6.29681952]
curr_Stock_Price:  98.15439958609468
curr_Factors:  [98.15439959]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609005]
Stock Position:  -0.016090051079138194
Bond Position:  [-4.71751021]


portfolio before change:  [-6.29114482]
curr_Stock_Price:  97.78339104416463
curr_Factors:  [97.78339104]
mat_Sqrt:  [[0.15]]
grads:  [0.04326576]
Stock Position:  0.0432657561518157
Bond Position:  [-10.52181718]


portfolio before change:  [-6.30697769]
curr_Stock_Price:  97.43264651534646
curr_Factors:  [97.43264652]
mat_Sqrt:  [[0.15]]
grads:  [-0.00420371]
Stock Position:  -0.0042037091392014255
Bond Position:  [-5.89739918]


portfolio before change:  [-6.30793485]
curr_Stock_Price:  97.57265653572017
curr_Factors:  [97.57265654]
mat_Sqrt:  [[0.15]]
grads:  [0.01020523]
Stock Position:  0.010205230826026817
Bond Position:  [-7.30368633]


portfolio before change:  [-6.30873782]
curr_Stock_Price:  97.5387051400638
curr_Factors:  [97.53870514]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213946]
Stock Position:  -0.022139461557154096
Bond Position:  [-4.14928341]


portfolio before change:  [-6.3104478]
curr_Stock_Price:  97.60422776608536
curr_Factors:  [97.60422777]
mat_Sqrt:  [[0.15]]
grads:  [-0.00861421]
Stock Position:  -0.00861421270143466
Bond Position:  [-5.46966422]


portfolio before change:  [-6.31363423]
curr_Stock_Price:  97.93444558533311
curr_Factors:  [97.93444559]
mat_Sqrt:  [[0.15]]
grads:  [0.01422835]
Stock Position:  0.014228349785581178
Bond Position:  [-7.70707978]


portfolio before change:  [-6.32648128]
curr_Stock_Price:  97.06538175824656
curr_Factors:  [97.06538176]
mat_Sqrt:  [[0.15]]
grads:  [0.09222074]
Stock Position:  0.09222073857686638
Bond Position:  [-15.27792248]


portfolio before change:  [-6.32670541]
curr_Stock_Price:  97.07330588978158
curr_Factors:  [97.07330589]
mat_Sqrt:  [[0.15]]
grads:  [-0.12354991]
Stock Position:  -0.12354990560557978
Bond Position:  [5.66669237]


portfolio before change:  [-6.20344275]
curr_Stock_Price:  96.07849754061733
curr_Factors:  [96.07849754]
mat_Sqrt:  [[0.15]]
grads:  [-0.03274702]
Stock Position:  -0.032747023800785244
Bond Position:  [-3.05715791]


portfolio before change:  [-6.2194692]
curr_Stock_Price:  96.56206428402763
curr_Factors:  [96.56206428]
mat_Sqrt:  [[0.15]]
grads:  [-0.08572265]
Stock Position:  -0.08572265126205666
Bond Position:  [2.05808696]


portfolio before change:  [-6.13137029]
curr_Stock_Price:  95.53584452635015
curr_Factors:  [95.53584453]
mat_Sqrt:  [[0.15]]
grads:  [-0.02943232]
Stock Position:  -0.029432322646803916
Bond Position:  [-3.31952849]


portfolio before change:  [-6.1531677]
curr_Stock_Price:  96.26938940946395
curr_Factors:  [96.26938941]
mat_Sqrt:  [[0.15]]
grads:  [0.06734198]
Stock Position:  0.06734198091413804
Bond Position:  [-12.63613908]


portfolio before change:  [-6.13052987]
curr_Stock_Price:  96.61727957103592
curr_Factors:  [96.61727957]
mat_Sqrt:  [[0.15]]
grads:  [-0.07780069]
Stock Position:  -0.07780069466567874
Bond Position:  [1.3863616]


portfolio before change:  [-6.11118684]
curr_Stock_Price:  96.36977054584676
curr_Factors:  [96.36977055]
mat_Sqrt:  [[0.15]]
grads:  [0.06687667]
Stock Position:  0.06687667437984784
Bond Position:  [-12.55607661]


portfolio before change:  [-6.10974997]
curr_Stock_Price:  96.40299067611708
curr_Factors:  [96.40299068]
mat_Sqrt:  [[0.15]]
grads:  [0.00513798]
Stock Position:  0.00513797820076569
Bond Position:  [-6.60506644]


portfolio before change:  [-6.11385172]
curr_Stock_Price:  95.685019148167
curr_Factors:  [95.68501915]
mat_Sqrt:  [[0.15]]
grads:  [0.08029634]
Stock Position:  0.08029633670395875
Bond Position:  [-13.79700824]


portfolio before change:  [-6.17921642]
curr_Stock_Price:  94.88171531674556
curr_Factors:  [94.88171532]
mat_Sqrt:  [[0.15]]
grads:  [0.02485015]
Stock Position:  0.024850148679384423
Bond Position:  [-8.53704115]


portfolio before change:  [-6.19340062]
curr_Stock_Price:  94.33239800457909
curr_Factors:  [94.332398]
mat_Sqrt:  [[0.15]]
grads:  [0.01049103]
Stock Position:  0.010491025273691883
Bond Position:  [-7.18304419]


portfolio before change:  [-6.19495375]
curr_Stock_Price:  94.22714815635416
curr_Factors:  [94.22714816]
mat_Sqrt:  [[0.15]]
grads:  [0.07921996]
Stock Position:  0.07921996075510795
Bond Position:  [-13.65962473]


portfolio before change:  [-6.25799204]
curr_Stock_Price:  93.44218774653721
curr_Factors:  [93.44218775]
mat_Sqrt:  [[0.15]]
grads:  [-0.14710558]
Stock Position:  -0.1471055826286993
Bond Position:  [7.48787544]


portfolio before change:  [-6.29920487]
curr_Stock_Price:  93.72552735040077
curr_Factors:  [93.72552735]
mat_Sqrt:  [[0.15]]
grads:  [0.03226771]
Stock Position:  0.03226770554739537
Bond Position:  [-9.32351258]


portfolio before change:  [-6.29210225]
curr_Stock_Price:  93.96370205687349
curr_Factors:  [93.96370206]
mat_Sqrt:  [[0.15]]
grads:  [0.0533514]
Stock Position:  0.05335139714216796
Bond Position:  [-11.30519704]


portfolio before change:  [-6.23115159]
curr_Stock_Price:  95.11938431297555
curr_Factors:  [95.11938431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23115159]
Stock Price:  95.09876179455392
PL:  [-6.23115159]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.27057741e-04]
 [ 2.07842268e-03]
 [ 5.99235593e-04]
 [ 7.18302164e-03]
 [ 4.59583310e-03]
 [ 2.48017256e-02]
 [ 1.11607557e-03]
 [-1.81524472e-02]
 [ 1.98377341e-02]
 [ 9.07997757e-03]
 [ 1.34571716e-02]
 [ 2.08284623e-02]
 [-1.44057779e-02]
 [ 4.41789001e-03]
 [-6.97710409e-03]
 [ 6.59593211e-03]
 [ 7.46127593e-03]
 [-8.91900611e-03]
 [ 1.10578894e-03]
 [ 1.27432752e-02]
 [ 1.17863755e-02]
 [-9.19059731e-03]
 [ 6.01377309e-03]
 [-6.96074833e-03]
 [-9.51536737e-03]
 [-9.85110437e-03]
 [-3.61585580e-03]
 [ 7.64409477e-03]
 [-1.87661406e-02]
 [-1.30549544e-03]
 [-4.17823261e-03]
 [-1.01418540e-02]
 [-7.79720886e-03]
 [ 5.06293860e-03]
 [ 1.24614342e-02]
 [ 1.37836284e-02]
 [-3.52400325e-02]
 [ 9.63299887e-03]
 [-3.79560812e-03]
 [ 2.18937458e-02]
 [-6.56017311e-03]
 [-4.66381438e-03]
 [ 2.32930258e-02]
 [ 4.00896763e-03]
 [-8.19318920e-03]
 [-2.24014665e-03]
 [ 9.25751991e-03]
 [-9.52327250e-03]
 [-1.13315555e-02]
 [-7.51430399e-03]
 [-8.96778291e-03]
 [-3.96174827e-03]
 [-7.83774546e-03]
 [ 5.45603010e-03]
 [ 3.64543457e-03]
 [ 1.92994416e-03]
 [ 8.92289583e-03]
 [-2.18642133e-04]
 [ 1.64947921e-03]
 [ 1.70752486e-02]
 [-1.52292368e-03]
 [ 1.60339013e-02]
 [ 1.54004000e-03]
 [-1.23681068e-02]
 [ 3.64044343e-03]
 [ 2.63929782e-03]
 [-5.41402408e-03]
 [ 1.50243473e-02]
 [-8.31579696e-03]
 [ 6.31437904e-03]
 [-1.26503944e-02]
 [ 1.30217314e-02]
 [-5.29023954e-04]
 [ 2.14434618e-02]
 [-2.24861188e-02]
 [-1.07820101e-03]
 [-7.75256971e-03]
 [-5.06938804e-03]
 [ 2.97495246e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.14521922]
curr_Stock_Price:  100.59196397723575
curr_Factors:  [100.59196398]
mat_Sqrt:  [[0.15]]
grads:  [-0.00218038]
Stock Position:  -0.002180384941925772
Bond Position:  [11.36454842]


portfolio before change:  [11.14581406]
curr_Stock_Price:  100.6449210959955
curr_Factors:  [100.6449211]
mat_Sqrt:  [[0.15]]
grads:  [0.01385615]
Stock Position:  0.013856151166913879
Bond Position:  [9.75126282]


portfolio before change:  [11.13688828]
curr_Stock_Price:  99.95676066579951
curr_Factors:  [99.95676067]
mat_Sqrt:  [[0.15]]
grads:  [0.0039949]
Stock Position:  0.003994903951904794
Bond Position:  [10.73757062]


portfolio before change:  [11.13867866]
curr_Stock_Price:  100.23693259712628
curr_Factors:  [100.2369326]
mat_Sqrt:  [[0.15]]
grads:  [0.04788681]
Stock Position:  0.04788681090515613
Bond Position:  [6.33865162]


portfolio before change:  [11.12640033]
curr_Stock_Price:  99.97225625961474
curr_Factors:  [99.97225626]
mat_Sqrt:  [[0.15]]
grads:  [0.03063889]
Stock Position:  0.030638887364341824
Bond Position:  [8.06336163]


portfolio before change:  [11.13097595]
curr_Stock_Price:  100.10514776751253
curr_Factors:  [100.10514777]
mat_Sqrt:  [[0.15]]
grads:  [0.16534484]
Stock Position:  0.16534483734405836
Bond Position:  [-5.42089342]


portfolio before change:  [11.10008684]
curr_Stock_Price:  99.92038063097789
curr_Factors:  [99.92038063]
mat_Sqrt:  [[0.15]]
grads:  [0.0074405]
Stock Position:  0.007440503768894402
Bond Position:  [10.35662888]


portfolio before change:  [11.09818882]
curr_Stock_Price:  99.57828879265955
curr_Factors:  [99.57828879]
mat_Sqrt:  [[0.15]]
grads:  [-0.12101631]
Stock Position:  -0.1210163147825101
Bond Position:  [23.14878636]


portfolio before change:  [11.04729779]
curr_Stock_Price:  100.01077490608444
curr_Factors:  [100.01077491]
mat_Sqrt:  [[0.15]]
grads:  [0.13225156]
Stock Position:  0.13225156095181884
Bond Position:  [-2.17928331]


portfolio before change:  [10.98949737]
curr_Stock_Price:  99.57475583667211
curr_Factors:  [99.57475584]
mat_Sqrt:  [[0.15]]
grads:  [0.06053318]
Stock Position:  0.060533183820961345
Bond Position:  [4.96192038]


portfolio before change:  [10.99977531]
curr_Stock_Price:  99.73942258828318
curr_Factors:  [99.73942259]
mat_Sqrt:  [[0.15]]
grads:  [0.08971448]
Stock Position:  0.0897144772629242
Bond Position:  [2.05170515]


portfolio before change:  [10.91463793]
curr_Stock_Price:  98.78901170908972
curr_Factors:  [98.78901171]
mat_Sqrt:  [[0.15]]
grads:  [0.13885642]
Stock Position:  0.1388564150677187
Bond Position:  [-2.80285009]


portfolio before change:  [10.88539442]
curr_Stock_Price:  98.57967084367385
curr_Factors:  [98.57967084]
mat_Sqrt:  [[0.15]]
grads:  [-0.09603852]
Stock Position:  -0.09603851902362964
Bond Position:  [20.35284002]


portfolio before change:  [10.94579701]
curr_Stock_Price:  97.96397525500589
curr_Factors:  [97.96397526]
mat_Sqrt:  [[0.15]]
grads:  [0.0294526]
Stock Position:  0.02945260008616601
Bond Position:  [8.06050322]


portfolio before change:  [10.960668]
curr_Stock_Price:  98.45178264231353
curr_Factors:  [98.45178264]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651403]
Stock Position:  -0.04651402724454874
Bond Position:  [15.5400569]


portfolio before change:  [10.95770511]
curr_Stock_Price:  98.53636297327756
curr_Factors:  [98.53636297]
mat_Sqrt:  [[0.15]]
grads:  [0.04397288]
Stock Position:  0.04397288073864911
Bond Position:  [6.62477737]


portfolio before change:  [10.95867832]
curr_Stock_Price:  98.54907876236696
curr_Factors:  [98.54907876]
mat_Sqrt:  [[0.15]]
grads:  [0.04974184]
Stock Position:  0.04974183951886356
Bond Position:  [6.05666586]


portfolio before change:  [10.96981232]
curr_Stock_Price:  98.76530410306479
curr_Factors:  [98.7653041]
mat_Sqrt:  [[0.15]]
grads:  [-0.05946004]
Stock Position:  -0.05946004070426919
Bond Position:  [16.84240133]


portfolio before change:  [10.99019686]
curr_Stock_Price:  98.44018063799997
curr_Factors:  [98.44018064]
mat_Sqrt:  [[0.15]]
grads:  [0.00737193]
Stock Position:  0.007371926261727875
Bond Position:  [10.26450311]


portfolio before change:  [10.99404733]
curr_Stock_Price:  98.87546978287693
curr_Factors:  [98.87546978]
mat_Sqrt:  [[0.15]]
grads:  [0.08495517]
Stock Position:  0.0849551679598132
Bond Position:  [2.59406519]


portfolio before change:  [10.99510384]
curr_Stock_Price:  98.88599743996139
curr_Factors:  [98.88599744]
mat_Sqrt:  [[0.15]]
grads:  [0.07857584]
Stock Position:  0.07857583674966488
Bond Position:  [3.22505385]


portfolio before change:  [10.95196625]
curr_Stock_Price:  98.33443904884378
curr_Factors:  [98.33443905]
mat_Sqrt:  [[0.15]]
grads:  [-0.06127065]
Stock Position:  -0.06127064876527003
Bond Position:  [16.97698113]


portfolio before change:  [10.97388552]
curr_Stock_Price:  97.99401230451544
curr_Factors:  [97.9940123]
mat_Sqrt:  [[0.15]]
grads:  [0.04009182]
Stock Position:  0.04009182058206007
Bond Position:  [7.04512716]


portfolio before change:  [10.96586633]
curr_Stock_Price:  97.78300873800706
curr_Factors:  [97.78300874]
mat_Sqrt:  [[0.15]]
grads:  [-0.04640499]
Stock Position:  -0.04640498889922018
Bond Position:  [15.50348577]


portfolio before change:  [10.96780874]
curr_Stock_Price:  97.76203228593702
curr_Factors:  [97.76203229]
mat_Sqrt:  [[0.15]]
grads:  [-0.06343578]
Stock Position:  -0.06343578247882983
Bond Position:  [17.16941976]


portfolio before change:  [10.93973749]
curr_Stock_Price:  98.22146344902173
curr_Factors:  [98.22146345]
mat_Sqrt:  [[0.15]]
grads:  [-0.06567403]
Stock Position:  -0.06567402910167476
Bond Position:  [17.39033674]


portfolio before change:  [10.94263033]
curr_Stock_Price:  98.19396540687946
curr_Factors:  [98.19396541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02410571]
Stock Position:  -0.02410570535039801
Bond Position:  [13.30966513]


portfolio before change:  [10.94202582]
curr_Stock_Price:  98.25355252429895
curr_Factors:  [98.25355252]
mat_Sqrt:  [[0.15]]
grads:  [0.05096063]
Stock Position:  0.05096063180378575
Bond Position:  [5.9349627]


portfolio before change:  [10.9347117]
curr_Stock_Price:  98.1027485397363
curr_Factors:  [98.10274854]
mat_Sqrt:  [[0.15]]
grads:  [-0.1251076]
Stock Position:  -0.12510760407465532
Bond Position:  [23.20811152]


portfolio before change:  [10.83056415]
curr_Stock_Price:  98.94680675870552
curr_Factors:  [98.94680676]
mat_Sqrt:  [[0.15]]
grads:  [-0.0087033]
Stock Position:  -0.008703302963740566
Bond Position:  [11.69172819]


portfolio before change:  [10.83434728]
curr_Stock_Price:  98.59609205202442
curr_Factors:  [98.59609205]
mat_Sqrt:  [[0.15]]
grads:  [-0.02785488]
Stock Position:  -0.027854884055663807
Bond Position:  [13.58072999]


portfolio before change:  [10.85317863]
curr_Stock_Price:  97.95051305389697
curr_Factors:  [97.95051305]
mat_Sqrt:  [[0.15]]
grads:  [-0.06761236]
Stock Position:  -0.06761236002493473
Bond Position:  [17.47584399]


portfolio before change:  [10.83326802]
curr_Stock_Price:  98.26114987532567
curr_Factors:  [98.26114988]
mat_Sqrt:  [[0.15]]
grads:  [-0.05198139]
Stock Position:  -0.051981392409452556
Bond Position:  [15.94101941]


portfolio before change:  [10.84515186]
curr_Stock_Price:  98.05170003834664
curr_Factors:  [98.05170004]
mat_Sqrt:  [[0.15]]
grads:  [0.03375292]
Stock Position:  0.033752924029509586
Bond Position:  [7.53562027]


portfolio before change:  [10.87194468]
curr_Stock_Price:  98.83153869651231
curr_Factors:  [98.8315387]
mat_Sqrt:  [[0.15]]
grads:  [0.08307623]
Stock Position:  0.08307622768144615
Bond Position:  [2.66139327]


portfolio before change:  [10.91686847]
curr_Stock_Price:  99.37029016757745
curr_Factors:  [99.37029017]
mat_Sqrt:  [[0.15]]
grads:  [0.09189086]
Stock Position:  0.09189085589684225
Bond Position:  [1.78564745]


portfolio before change:  [10.93308937]
curr_Stock_Price:  99.5455991733946
curr_Factors:  [99.54559917]
mat_Sqrt:  [[0.15]]
grads:  [-0.23493355]
Stock Position:  -0.2349335498845574
Bond Position:  [34.31969036]


portfolio before change:  [10.8591686]
curr_Stock_Price:  99.86937502099026
curr_Factors:  [99.86937502]
mat_Sqrt:  [[0.15]]
grads:  [0.06421999]
Stock Position:  0.06421999247577073
Bond Position:  [4.44555809]


portfolio before change:  [10.89811943]
curr_Stock_Price:  100.47157026142662
curr_Factors:  [100.47157026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02530405]
Stock Position:  -0.02530405412711818
Bond Position:  [13.44045749]


portfolio before change:  [10.89761316]
curr_Stock_Price:  100.52477615799283
curr_Factors:  [100.52477616]
mat_Sqrt:  [[0.15]]
grads:  [0.14595831]
Stock Position:  0.14595830531949824
Bond Position:  [-3.77481281]


portfolio before change:  [10.81545808]
curr_Stock_Price:  99.96352579264823
curr_Factors:  [99.96352579]
mat_Sqrt:  [[0.15]]
grads:  [-0.04373449]
Stock Position:  -0.04373448739625455
Bond Position:  [15.18731164]


portfolio before change:  [10.83645429]
curr_Stock_Price:  99.50514667381246
curr_Factors:  [99.50514667]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310921]
Stock Position:  -0.03109209583806889
Bond Position:  [13.93027785]


portfolio before change:  [10.84127579]
curr_Stock_Price:  99.37807821849344
curr_Factors:  [99.37807822]
mat_Sqrt:  [[0.15]]
grads:  [0.15528684]
Stock Position:  0.15528683848520766
Bond Position:  [-4.5908318]


portfolio before change:  [10.89024249]
curr_Stock_Price:  99.69525668304283
curr_Factors:  [99.69525668]
mat_Sqrt:  [[0.15]]
grads:  [0.02672645]
Stock Position:  0.02672645088966025
Bond Position:  [8.22574211]


portfolio before change:  [10.88636882]
curr_Stock_Price:  99.53108230712127
curr_Factors:  [99.53108231]
mat_Sqrt:  [[0.15]]
grads:  [-0.05462126]
Stock Position:  -0.05462126136556135
Bond Position:  [16.32288208]


portfolio before change:  [10.85638287]
curr_Stock_Price:  100.09873958292462
curr_Factors:  [100.09873958]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493431]
Stock Position:  -0.014934311017016482
Bond Position:  [12.35128858]


portfolio before change:  [10.84867937]
curr_Stock_Price:  100.66625726362122
curr_Factors:  [100.66625726]
mat_Sqrt:  [[0.15]]
grads:  [0.0617168]
Stock Position:  0.061716799369877784
Bond Position:  [4.63588016]


portfolio before change:  [10.84584088]
curr_Stock_Price:  100.61557027674404
curr_Factors:  [100.61557028]
mat_Sqrt:  [[0.15]]
grads:  [-0.06348848]
Stock Position:  -0.06348848331859124
Bond Position:  [17.23377083]


portfolio before change:  [10.83586478]
curr_Stock_Price:  100.78966872444362
curr_Factors:  [100.78966872]
mat_Sqrt:  [[0.15]]
grads:  [-0.0755437]
Stock Position:  -0.07554370320364105
Bond Position:  [18.4498896]


portfolio before change:  [10.75962977]
curr_Stock_Price:  101.81408455553249
curr_Factors:  [101.81408456]
mat_Sqrt:  [[0.15]]
grads:  [-0.05009536]
Stock Position:  -0.050095359907114535
Bond Position:  [15.86004298]


portfolio before change:  [10.77098801]
curr_Stock_Price:  101.6071399717571
curr_Factors:  [101.60713997]
mat_Sqrt:  [[0.15]]
grads:  [-0.05978522]
Stock Position:  -0.05978521942292754
Bond Position:  [16.84559317]


portfolio before change:  [10.78855431]
curr_Stock_Price:  101.33092759418251
curr_Factors:  [101.33092759]
mat_Sqrt:  [[0.15]]
grads:  [-0.02641166]
Stock Position:  -0.026411655101315455
Bond Position:  [13.46487182]


portfolio before change:  [10.76042953]
curr_Stock_Price:  102.42765406288534
curr_Factors:  [102.42765406]
mat_Sqrt:  [[0.15]]
grads:  [-0.05225164]
Stock Position:  -0.052251636366872405
Bond Position:  [16.11244207]


portfolio before change:  [10.78997873]
curr_Stock_Price:  101.88141020761363
curr_Factors:  [101.88141021]
mat_Sqrt:  [[0.15]]
grads:  [0.03637353]
Stock Position:  0.03637353402094578
Bond Position:  [7.08419179]


portfolio before change:  [10.77515311]
curr_Stock_Price:  101.46164378225818
curr_Factors:  [101.46164378]
mat_Sqrt:  [[0.15]]
grads:  [0.0243029]
Stock Position:  0.024302897108199932
Bond Position:  [8.30934123]


portfolio before change:  [10.79483044]
curr_Stock_Price:  102.24994400792221
curr_Factors:  [102.24994401]
mat_Sqrt:  [[0.15]]
grads:  [0.01286629]
Stock Position:  0.012866294371948311
Bond Position:  [9.47925257]


portfolio before change:  [10.7931827]
curr_Stock_Price:  102.07582890080745
curr_Factors:  [102.0758289]
mat_Sqrt:  [[0.15]]
grads:  [0.05948597]
Stock Position:  0.05948597219756248
Bond Position:  [4.72110278]


portfolio before change:  [10.83949164]
curr_Stock_Price:  102.84935349526918
curr_Factors:  [102.8493535]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145761]
Stock Position:  -0.0014576142230641666
Bond Position:  [10.98940632]


portfolio before change:  [10.8410806]
curr_Stock_Price:  102.23046432650591
curr_Factors:  [102.23046433]
mat_Sqrt:  [[0.15]]
grads:  [0.01099653]
Stock Position:  0.010996528084261593
Bond Position:  [9.71690043]


portfolio before change:  [10.85266592]
curr_Stock_Price:  103.22877835168596
curr_Factors:  [103.22877835]
mat_Sqrt:  [[0.15]]
grads:  [0.11383499]
Stock Position:  0.11383499048402086
Bond Position:  [-0.89838109]


portfolio before change:  [10.82548174]
curr_Stock_Price:  102.99046825693344
curr_Factors:  [102.99046826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015282]
Stock Position:  -0.010152824522464873
Bond Position:  [11.87112589]


portfolio before change:  [10.82685969]
curr_Stock_Price:  102.92782672152993
curr_Factors:  [102.92782672]
mat_Sqrt:  [[0.15]]
grads:  [0.10689268]
Stock Position:  0.10689267520833849
Bond Position:  [-0.17537106]


portfolio before change:  [10.83225952]
curr_Stock_Price:  102.97844560950661
curr_Factors:  [102.97844561]
mat_Sqrt:  [[0.15]]
grads:  [0.01026693]
Stock Position:  0.010266933321587674
Bond Position:  [9.77498669]


portfolio before change:  [10.82558585]
curr_Stock_Price:  102.26892289086685
curr_Factors:  [102.26892289]
mat_Sqrt:  [[0.15]]
grads:  [-0.08245405]
Stock Position:  -0.08245404539510989
Bond Position:  [19.25807227]


portfolio before change:  [10.77103963]
curr_Stock_Price:  102.94505575002673
curr_Factors:  [102.94505575]
mat_Sqrt:  [[0.15]]
grads:  [0.02426962]
Stock Position:  0.02426962289237708
Bond Position:  [8.27260195]


portfolio before change:  [10.78057113]
curr_Stock_Price:  103.31648488726482
curr_Factors:  [103.31648489]
mat_Sqrt:  [[0.15]]
grads:  [0.01759532]
Stock Position:  0.017595318802763535
Bond Position:  [8.96268464]


portfolio before change:  [10.78778258]
curr_Stock_Price:  103.69449802746492
curr_Factors:  [103.69449803]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609349]
Stock Position:  -0.03609349389867088
Bond Position:  [14.53047931]


portfolio before change:  [10.80553903]
curr_Stock_Price:  103.22770291753399
curr_Factors:  [103.22770292]
mat_Sqrt:  [[0.15]]
grads:  [0.10016232]
Stock Position:  0.10016231511646821
Bond Position:  [0.46601332]


portfolio before change:  [10.79971367]
curr_Stock_Price:  103.16925298743463
curr_Factors:  [103.16925299]
mat_Sqrt:  [[0.15]]
grads:  [-0.05543865]
Stock Position:  -0.055438646369518514
Bond Position:  [16.51927741]


portfolio before change:  [10.79103731]
curr_Stock_Price:  103.34438081689316
curr_Factors:  [103.34438082]
mat_Sqrt:  [[0.15]]
grads:  [0.04209586]
Stock Position:  0.042095860276908335
Bond Position:  [6.4406667]


portfolio before change:  [10.8323038]
curr_Stock_Price:  104.31511609448098
curr_Factors:  [104.31511609]
mat_Sqrt:  [[0.15]]
grads:  [-0.08433596]
Stock Position:  -0.08433596250175854
Bond Position:  [19.62981952]


portfolio before change:  [10.89267876]
curr_Stock_Price:  103.6137776271314
curr_Factors:  [103.61377763]
mat_Sqrt:  [[0.15]]
grads:  [0.08681154]
Stock Position:  0.08681154243719214
Bond Position:  [1.89780691]


portfolio before change:  [10.90354106]
curr_Stock_Price:  103.73753635104904
curr_Factors:  [103.73753635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00352683]
Stock Position:  -0.0035268263613905666
Bond Position:  [11.26940534]


portfolio before change:  [10.90811475]
curr_Stock_Price:  102.6404231470361
curr_Factors:  [102.64042315]
mat_Sqrt:  [[0.15]]
grads:  [0.14295641]
Stock Position:  0.1429564120766427
Bond Position:  [-3.76499188]


portfolio before change:  [10.93387499]
curr_Stock_Price:  102.82226573562949
curr_Factors:  [102.82226574]
mat_Sqrt:  [[0.15]]
grads:  [-0.14990746]
Stock Position:  -0.1499074588157955
Bond Position:  [26.34769956]


portfolio before change:  [10.95759295]
curr_Stock_Price:  102.67503372459272
curr_Factors:  [102.67503372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00718801]
Stock Position:  -0.007188006753299847
Bond Position:  [11.69562179]


portfolio before change:  [10.95406221]
curr_Stock_Price:  103.2679295800848
curr_Factors:  [103.26792958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0516838]
Stock Position:  -0.05168379805826277
Bond Position:  [16.29134103]


portfolio before change:  [10.96122416]
curr_Stock_Price:  103.1490584782262
curr_Factors:  [103.14905848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03379592]
Stock Position:  -0.03379592029404635
Bond Position:  [14.44724152]


portfolio before change:  [10.94401096]
curr_Stock_Price:  103.68510483408612
curr_Factors:  [103.68510483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.94401096]
Stock Price:  102.54752916310557
PL:  [8.3964818]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 8.58366998e-04]
 [ 3.12657274e-03]
 [-1.79574418e-03]
 [ 7.23838552e-03]
 [ 3.63137789e-03]
 [ 2.47721052e-02]
 [ 1.63024425e-03]
 [-1.55670559e-02]
 [ 1.44979379e-02]
 [ 4.26356302e-03]
 [ 1.59169132e-02]
 [-2.38521922e-02]
 [ 3.17671869e-03]
 [ 2.81759482e-03]
 [-6.91228937e-03]
 [ 6.72124064e-03]
 [ 7.22704711e-03]
 [-1.21906364e-02]
 [-2.13197521e-04]
 [ 5.09869030e-03]
 [ 1.23665428e-02]
 [-5.32397334e-03]
 [ 8.08920130e-03]
 [ 1.02319387e-02]
 [ 1.99407994e-03]
 [ 9.54614808e-03]
 [-5.46695705e-03]
 [ 9.98951026e-03]
 [ 3.46123643e-02]
 [-7.89215594e-04]
 [ 1.14861917e-02]
 [-1.19492449e-02]
 [ 9.40617303e-03]
 [ 6.90168488e-03]
 [ 1.14659457e-02]
 [ 1.00219870e-02]
 [-3.38151869e-02]
 [ 9.74543179e-03]
 [-1.35299422e-03]
 [ 2.45737427e-02]
 [-5.28285015e-03]
 [ 8.03417903e-03]
 [ 2.30184286e-02]
 [ 3.93267865e-03]
 [-7.52612246e-03]
 [ 6.60372270e-05]
 [ 4.42618920e-03]
 [-1.23627455e-02]
 [-1.20863153e-02]
 [-7.46112807e-03]
 [ 3.75885564e-02]
 [-8.27011330e-03]
 [ 2.36112991e-03]
 [ 5.31368071e-03]
 [ 4.24909028e-03]
 [-2.63388169e-03]
 [ 4.02681902e-03]
 [-2.63949710e-04]
 [ 1.55614246e-03]
 [-7.68631865e-03]
 [ 9.00849938e-04]
 [-1.21542719e-02]
 [-1.13605730e-03]
 [-1.71195761e-02]
 [-1.33882344e-02]
 [-1.22205767e-03]
 [-5.21923193e-03]
 [ 2.34908415e-02]
 [-9.00024889e-03]
 [ 6.32349482e-03]
 [-3.42375631e-03]
 [ 1.12597702e-02]
 [-1.59778796e-03]
 [ 5.71718212e-03]
 [-6.01786158e-03]
 [-1.09429435e-02]
 [ 2.98430337e-03]
 [ 2.65772801e-03]
 [-8.62502379e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.33062374]
curr_Stock_Price:  100.1488451863783
curr_Factors:  [100.14884519]
mat_Sqrt:  [[0.15]]
grads:  [0.00572245]
Stock Position:  0.005722446654195596
Bond Position:  [3.75752732]


portfolio before change:  [4.33128263]
curr_Stock_Price:  100.22294512657166
curr_Factors:  [100.22294513]
mat_Sqrt:  [[0.15]]
grads:  [0.02084382]
Stock Position:  0.02084381825097186
Bond Position:  [2.24225377]


portfolio before change:  [4.33612229]
curr_Stock_Price:  100.44840872250276
curr_Factors:  [100.44840872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01197163]
Stock Position:  -0.011971627840366912
Bond Position:  [5.53865326]


portfolio before change:  [4.34019312]
curr_Stock_Price:  100.13728546631182
curr_Factors:  [100.13728547]
mat_Sqrt:  [[0.15]]
grads:  [0.0482559]
Stock Position:  0.048255903466437315
Bond Position:  [-0.49202206]


portfolio before change:  [4.35430076]
curr_Stock_Price:  100.43027321135752
curr_Factors:  [100.43027321]
mat_Sqrt:  [[0.15]]
grads:  [0.02420919]
Stock Position:  0.02420918596598652
Bond Position:  [1.9229656]


portfolio before change:  [4.34640314]
curr_Stock_Price:  100.09908459268405
curr_Factors:  [100.09908459]
mat_Sqrt:  [[0.15]]
grads:  [0.16514737]
Stock Position:  0.16514736807043906
Bond Position:  [-12.18469723]


portfolio before change:  [4.34107712]
curr_Stock_Price:  100.07144594408054
curr_Factors:  [100.07144594]
mat_Sqrt:  [[0.15]]
grads:  [0.0108683]
Stock Position:  0.010868295008082764
Bond Position:  [3.25347113]


portfolio before change:  [4.34364967]
curr_Stock_Price:  100.28943727196999
curr_Factors:  [100.28943727]
mat_Sqrt:  [[0.15]]
grads:  [-0.10378037]
Stock Position:  -0.1037803728548588
Bond Position:  [14.75172486]


portfolio before change:  [4.4044704]
curr_Stock_Price:  99.71226910929938
curr_Factors:  [99.71226911]
mat_Sqrt:  [[0.15]]
grads:  [0.09665292]
Stock Position:  0.09665291954660309
Bond Position:  [-5.23301152]


portfolio before change:  [4.40196841]
curr_Stock_Price:  99.68976668748401
curr_Factors:  [99.68976669]
mat_Sqrt:  [[0.15]]
grads:  [0.02842375]
Stock Position:  0.028423753495008648
Bond Position:  [1.56841105]


portfolio before change:  [4.43212973]
curr_Stock_Price:  100.74744875680081
curr_Factors:  [100.74744876]
mat_Sqrt:  [[0.15]]
grads:  [0.10611275]
Stock Position:  0.10611275455675848
Bond Position:  [-6.25845957]


portfolio before change:  [4.43707107]
curr_Stock_Price:  100.79770196022534
curr_Factors:  [100.79770196]
mat_Sqrt:  [[0.15]]
grads:  [-0.15901461]
Stock Position:  -0.15901461443454765
Bond Position:  [20.46537878]


portfolio before change:  [4.51064161]
curr_Stock_Price:  100.34308079397034
curr_Factors:  [100.34308079]
mat_Sqrt:  [[0.15]]
grads:  [0.02117812]
Stock Position:  0.02117812456850057
Bond Position:  [2.38556334]


portfolio before change:  [4.50895556]
curr_Stock_Price:  100.2564277229462
curr_Factors:  [100.25642772]
mat_Sqrt:  [[0.15]]
grads:  [0.01878397]
Stock Position:  0.018783965471212704
Bond Position:  [2.62574228]


portfolio before change:  [4.50101992]
curr_Stock_Price:  99.82522195919567
curr_Factors:  [99.82522196]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608193]
Stock Position:  -0.046081929153396234
Bond Position:  [9.10115872]


portfolio before change:  [4.54088751]
curr_Stock_Price:  98.97242009685134
curr_Factors:  [98.9724201]
mat_Sqrt:  [[0.15]]
grads:  [0.04480827]
Stock Position:  0.0448082709446302
Bond Position:  [0.1061045]


portfolio before change:  [4.55748638]
curr_Stock_Price:  99.34271419903237
curr_Factors:  [99.3427142]
mat_Sqrt:  [[0.15]]
grads:  [0.04818031]
Stock Position:  0.04818031404795479
Bond Position:  [-0.22887678]


portfolio before change:  [4.58054777]
curr_Stock_Price:  99.821658500227
curr_Factors:  [99.8216585]
mat_Sqrt:  [[0.15]]
grads:  [-0.08127091]
Stock Position:  -0.0812709092477598
Bond Position:  [12.69314471]


portfolio before change:  [4.55624516]
curr_Stock_Price:  100.13045231080069
curr_Factors:  [100.13045231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142132]
Stock Position:  -0.0014213168059442303
Bond Position:  [4.69856225]


portfolio before change:  [4.55585369]
curr_Stock_Price:  100.61249950428608
curr_Factors:  [100.6124995]
mat_Sqrt:  [[0.15]]
grads:  [0.03399127]
Stock Position:  0.03399126868983399
Bond Position:  [1.13590718]


portfolio before change:  [4.57127846]
curr_Stock_Price:  101.06419732891369
curr_Factors:  [101.06419733]
mat_Sqrt:  [[0.15]]
grads:  [0.08244362]
Stock Position:  0.08244361846622184
Bond Position:  [-3.76081966]


portfolio before change:  [4.56160556]
curr_Stock_Price:  100.9497209234022
curr_Factors:  [100.94972092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03549316]
Stock Position:  -0.03549315557057919
Bond Position:  [8.14462971]


portfolio before change:  [4.55104425]
curr_Stock_Price:  101.26162225965477
curr_Factors:  [101.26162226]
mat_Sqrt:  [[0.15]]
grads:  [0.05392801]
Stock Position:  0.05392800867744885
Bond Position:  [-0.9097934]


portfolio before change:  [4.56811786]
curr_Stock_Price:  101.57927676551218
curr_Factors:  [101.57927677]
mat_Sqrt:  [[0.15]]
grads:  [0.06821292]
Stock Position:  0.06821292478763596
Bond Position:  [-2.36090171]


portfolio before change:  [4.58172404]
curr_Stock_Price:  101.7809063671134
curr_Factors:  [101.78090637]
mat_Sqrt:  [[0.15]]
grads:  [0.01329387]
Stock Position:  0.01329386628624069
Bond Position:  [3.22866228]


portfolio before change:  [4.58670128]
curr_Stock_Price:  102.14012737609441
curr_Factors:  [102.14012738]
mat_Sqrt:  [[0.15]]
grads:  [0.06364099]
Stock Position:  0.06364098719962988
Bond Position:  [-1.91359726]


portfolio before change:  [4.55694203]
curr_Stock_Price:  101.67439535943839
curr_Factors:  [101.67439536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03644638]
Stock Position:  -0.03644638030082952
Bond Position:  [8.26260571]


portfolio before change:  [4.53675211]
curr_Stock_Price:  102.24252712818058
curr_Factors:  [102.24252713]
mat_Sqrt:  [[0.15]]
grads:  [0.06659674]
Stock Position:  0.06659673508231562
Bond Position:  [-2.27226638]


portfolio before change:  [4.54484915]
curr_Stock_Price:  102.36624286751099
curr_Factors:  [102.36624287]
mat_Sqrt:  [[0.15]]
grads:  [0.2307491]
Stock Position:  0.23074909518321624
Bond Position:  [-19.07606876]


portfolio before change:  [4.47148573]
curr_Stock_Price:  102.05347399637907
curr_Factors:  [102.053474]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526144]
Stock Position:  -0.005261437295865588
Bond Position:  [5.00843368]


portfolio before change:  [4.47366416]
curr_Stock_Price:  101.69893278008757
curr_Factors:  [101.69893278]
mat_Sqrt:  [[0.15]]
grads:  [0.07657461]
Stock Position:  0.07657461111014784
Bond Position:  [-3.31389207]


portfolio before change:  [4.47860216]
curr_Stock_Price:  101.76612374630284
curr_Factors:  [101.76612375]
mat_Sqrt:  [[0.15]]
grads:  [-0.07966163]
Stock Position:  -0.07966163245048313
Bond Position:  [12.58545771]


portfolio before change:  [4.53059727]
curr_Stock_Price:  101.1232986149239
curr_Factors:  [101.12329861]
mat_Sqrt:  [[0.15]]
grads:  [0.06270782]
Stock Position:  0.06270782018789563
Bond Position:  [-1.81062435]


portfolio before change:  [4.50139995]
curr_Stock_Price:  100.6594943347719
curr_Factors:  [100.65949433]
mat_Sqrt:  [[0.15]]
grads:  [0.04601123]
Stock Position:  0.04601123250988152
Bond Position:  [-0.13006745]


portfolio before change:  [4.49232727]
curr_Stock_Price:  100.46248693798245
curr_Factors:  [100.46248694]
mat_Sqrt:  [[0.15]]
grads:  [0.07643964]
Stock Position:  0.07643963782327784
Bond Position:  [-3.18698885]


portfolio before change:  [4.50124425]
curr_Stock_Price:  100.58174666927371
curr_Factors:  [100.58174667]
mat_Sqrt:  [[0.15]]
grads:  [0.06681325]
Stock Position:  0.06681324665784484
Bond Position:  [-2.2189488]


portfolio before change:  [4.56397618]
curr_Stock_Price:  101.52273697373907
curr_Factors:  [101.52273697]
mat_Sqrt:  [[0.15]]
grads:  [-0.22543458]
Stock Position:  -0.22543457915206302
Bond Position:  [27.45071166]


portfolio before change:  [4.73543401]
curr_Stock_Price:  100.76978188565654
curr_Factors:  [100.76978189]
mat_Sqrt:  [[0.15]]
grads:  [0.06496955]
Stock Position:  0.0649695452789058
Bond Position:  [-1.8115329]


portfolio before change:  [4.73896852]
curr_Stock_Price:  100.8259271485519
curr_Factors:  [100.82592715]
mat_Sqrt:  [[0.15]]
grads:  [-0.00901996]
Stock Position:  -0.009019961434513375
Bond Position:  [5.64841449]


portfolio before change:  [4.75174379]
curr_Stock_Price:  99.44873331072955
curr_Factors:  [99.44873331]
mat_Sqrt:  [[0.15]]
grads:  [0.16382495]
Stock Position:  0.1638249516167966
Bond Position:  [-11.54044013]


portfolio before change:  [4.7165503]
curr_Stock_Price:  99.23831241797592
curr_Factors:  [99.23831242]
mat_Sqrt:  [[0.15]]
grads:  [-0.035219]
Stock Position:  -0.03521900098802458
Bond Position:  [8.21162452]


portfolio before change:  [4.74812549]
curr_Stock_Price:  98.35634678375679
curr_Factors:  [98.35634678]
mat_Sqrt:  [[0.15]]
grads:  [0.05356119]
Stock Position:  0.05356119354700847
Bond Position:  [-0.51995784]


portfolio before change:  [4.77853649]
curr_Stock_Price:  98.9247339967022
curr_Factors:  [98.924734]
mat_Sqrt:  [[0.15]]
grads:  [0.15345619]
Stock Position:  0.1534561909013908
Bond Position:  [-10.40207638]


portfolio before change:  [4.91932021]
curr_Stock_Price:  99.84639034754255
curr_Factors:  [99.84639035]
mat_Sqrt:  [[0.15]]
grads:  [0.02621786]
Stock Position:  0.02621785768787627
Bond Position:  [2.30156176]


portfolio before change:  [4.94111588]
curr_Stock_Price:  100.67223277425452
curr_Factors:  [100.67223277]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017415]
Stock Position:  -0.05017414971402119
Bond Position:  [9.99225956]


portfolio before change:  [4.91947442]
curr_Stock_Price:  101.11600719018081
curr_Factors:  [101.11600719]
mat_Sqrt:  [[0.15]]
grads:  [0.00044025]
Stock Position:  0.0004402481801996326
Bond Position:  [4.87495828]


portfolio before change:  [4.91917546]
curr_Stock_Price:  99.74484239754318
curr_Factors:  [99.7448424]
mat_Sqrt:  [[0.15]]
grads:  [0.02950793]
Stock Position:  0.02950792802993338
Bond Position:  [1.97591183]


portfolio before change:  [4.91759289]
curr_Stock_Price:  99.68702523578011
curr_Factors:  [99.68702524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0824183]
Stock Position:  -0.0824183032229883
Bond Position:  [13.13362836]


portfolio before change:  [4.94690983]
curr_Stock_Price:  99.3412759823403
curr_Factors:  [99.34127598]
mat_Sqrt:  [[0.15]]
grads:  [-0.08057544]
Stock Position:  -0.0805754355023543
Bond Position:  [12.95137641]


portfolio before change:  [4.85393258]
curr_Stock_Price:  100.50523793296686
curr_Factors:  [100.50523793]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974085]
Stock Position:  -0.04974085380464338
Bond Position:  [9.85314893]


portfolio before change:  [4.85777677]
curr_Stock_Price:  100.44033446996555
curr_Factors:  [100.44033447]
mat_Sqrt:  [[0.15]]
grads:  [0.25059038]
Stock Position:  0.250590376109996
Bond Position:  [-20.31160442]


portfolio before change:  [4.86388116]
curr_Stock_Price:  100.46976056832582
curr_Factors:  [100.46976057]
mat_Sqrt:  [[0.15]]
grads:  [-0.05513409]
Stock Position:  -0.05513408866367864
Bond Position:  [10.40318984]


portfolio before change:  [4.88571002]
curr_Stock_Price:  100.08563085673997
curr_Factors:  [100.08563086]
mat_Sqrt:  [[0.15]]
grads:  [0.01574087]
Stock Position:  0.01574086606885204
Bond Position:  [3.31027551]


portfolio before change:  [4.89587221]
curr_Stock_Price:  100.71807989699305
curr_Factors:  [100.7180799]
mat_Sqrt:  [[0.15]]
grads:  [0.03542454]
Stock Position:  0.035424538096938026
Bond Position:  [1.32798075]


portfolio before change:  [4.90830435]
curr_Stock_Price:  101.06668393392303
curr_Factors:  [101.06668393]
mat_Sqrt:  [[0.15]]
grads:  [0.02832727]
Stock Position:  0.02832726852958633
Bond Position:  [2.04536126]


portfolio before change:  [4.90322142]
curr_Stock_Price:  100.8827351288671
curr_Factors:  [100.88273513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755921]
Stock Position:  -0.017559211290248865
Bond Position:  [6.67464268]


portfolio before change:  [4.90627538]
curr_Stock_Price:  100.73257007600667
curr_Factors:  [100.73257008]
mat_Sqrt:  [[0.15]]
grads:  [0.02684546]
Stock Position:  0.0268454601316386
Bond Position:  [2.20206319]


portfolio before change:  [4.89653494]
curr_Stock_Price:  100.36460947179724
curr_Factors:  [100.36460947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175966]
Stock Position:  -0.0017596647353722216
Bond Position:  [5.07314301]


portfolio before change:  [4.89777043]
curr_Stock_Price:  99.84269009974716
curr_Factors:  [99.8426901]
mat_Sqrt:  [[0.15]]
grads:  [0.01037428]
Stock Position:  0.010374283048794808
Bond Position:  [3.8619741]


portfolio before change:  [4.89952119]
curr_Stock_Price:  99.98818301602056
curr_Factors:  [99.98818302]
mat_Sqrt:  [[0.15]]
grads:  [-0.05124212]
Stock Position:  -0.051242124321477026
Bond Position:  [10.0231281]


portfolio before change:  [4.87930485]
curr_Stock_Price:  100.39493452518813
curr_Factors:  [100.39493453]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [4.27636638]


portfolio before change:  [4.8768878]
curr_Stock_Price:  99.947968964819
curr_Factors:  [99.94796896]
mat_Sqrt:  [[0.15]]
grads:  [-0.08102848]
Stock Position:  -0.08102847939385356
Bond Position:  [12.97551975]


portfolio before change:  [4.93992661]
curr_Stock_Price:  99.17999441295503
curr_Factors:  [99.17999441]
mat_Sqrt:  [[0.15]]
grads:  [-0.00757372]
Stock Position:  -0.007573715365305466
Bond Position:  [5.69108765]


portfolio before change:  [4.94135979]
curr_Stock_Price:  99.03772924411467
curr_Factors:  [99.03772924]
mat_Sqrt:  [[0.15]]
grads:  [-0.11413051]
Stock Position:  -0.11413050714819638
Bond Position:  [16.24458605]


portfolio before change:  [4.95779457]
curr_Stock_Price:  98.90262546264287
curr_Factors:  [98.90262546]
mat_Sqrt:  [[0.15]]
grads:  [-0.0892549]
Stock Position:  -0.08925489606023909
Bond Position:  [13.78533812]


portfolio before change:  [4.95607138]
curr_Stock_Price:  98.9315851976972
curr_Factors:  [98.9315852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00814705]
Stock Position:  -0.00814705110497603
Bond Position:  [5.76207206]


portfolio before change:  [4.94933907]
curr_Stock_Price:  99.80213924926768
curr_Factors:  [99.80213925]
mat_Sqrt:  [[0.15]]
grads:  [-0.03479488]
Stock Position:  -0.034794879557297625
Bond Position:  [8.42194249]


portfolio before change:  [4.96115479]
curr_Stock_Price:  99.47768550330366
curr_Factors:  [99.4776855]
mat_Sqrt:  [[0.15]]
grads:  [0.15660561]
Stock Position:  0.15660561021820163
Bond Position:  [-10.61760885]


portfolio before change:  [4.90029569]
curr_Stock_Price:  99.09330923161954
curr_Factors:  [99.09330923]
mat_Sqrt:  [[0.15]]
grads:  [-0.06000166]
Stock Position:  -0.06000165928198735
Bond Position:  [10.84605867]


portfolio before change:  [4.93988367]
curr_Stock_Price:  98.44482572090685
curr_Factors:  [98.44482572]
mat_Sqrt:  [[0.15]]
grads:  [0.04215663]
Stock Position:  0.042156632138274336
Bond Position:  [0.78978137]


portfolio before change:  [4.89975777]
curr_Stock_Price:  97.49182584375266
curr_Factors:  [97.49182584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282504]
Stock Position:  -0.02282504205641822
Bond Position:  [7.1250128]


portfolio before change:  [4.88983305]
curr_Stock_Price:  97.94615344209545
curr_Factors:  [97.94615344]
mat_Sqrt:  [[0.15]]
grads:  [0.07506513]
Stock Position:  0.07506513443118593
Bond Position:  [-2.46250812]


portfolio before change:  [4.87642024]
curr_Stock_Price:  97.7695214264063
curr_Factors:  [97.76952143]
mat_Sqrt:  [[0.15]]
grads:  [-0.01065192]
Stock Position:  -0.010651919724739152
Bond Position:  [5.91785333]


portfolio before change:  [4.87883613]
curr_Stock_Price:  97.57744180646675
curr_Factors:  [97.57744181]
mat_Sqrt:  [[0.15]]
grads:  [0.03811455]
Stock Position:  0.03811454747033596
Bond Position:  [1.15971609]


portfolio before change:  [4.85054181]
curr_Stock_Price:  96.83319042855221
curr_Factors:  [96.83319043]
mat_Sqrt:  [[0.15]]
grads:  [-0.04011908]
Stock Position:  -0.04011907722211679
Bond Position:  [8.73540005]


portfolio before change:  [4.84037484]
curr_Stock_Price:  97.10021925265121
curr_Factors:  [97.10021925]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295296]
Stock Position:  -0.07295295650124162
Bond Position:  [11.92412291]


portfolio before change:  [4.82803629]
curr_Stock_Price:  97.27956538558041
curr_Factors:  [97.27956539]
mat_Sqrt:  [[0.15]]
grads:  [0.01989536]
Stock Position:  0.019895355827177105
Bond Position:  [2.89262472]


portfolio before change:  [4.83966305]
curr_Stock_Price:  97.85487379469679
curr_Factors:  [97.85487379]
mat_Sqrt:  [[0.15]]
grads:  [0.01771819]
Stock Position:  0.01771818675560988
Bond Position:  [3.10585212]


portfolio before change:  [4.83547672]
curr_Stock_Price:  97.60764463518825
curr_Factors:  [97.60764464]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.83547672]
Stock Price:  97.84556243758682
PL:  [4.83547672]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 5.73487493e-04]
 [ 2.74454734e-03]
 [-3.59340368e-03]
 [ 8.73618997e-04]
 [ 2.36103464e-02]
 [ 2.70485632e-02]
 [ 4.76556141e-03]
 [ 1.80881817e-02]
 [ 2.44866451e-02]
 [-1.70991940e-03]
 [ 4.99366011e-02]
 [ 5.68660729e-02]
 [ 8.53286760e-02]
 [ 1.42063356e-02]
 [-6.89559879e-03]
 [ 3.21557287e-02]
 [ 1.26277978e-02]
 [-6.21355342e-03]
 [ 4.80079860e-03]
 [-6.62337816e-03]
 [ 1.41503414e-02]
 [-7.23031172e-03]
 [ 1.10843802e-02]
 [-2.84682789e-03]
 [ 4.95387994e-03]
 [ 1.33625745e-02]
 [-6.49676979e-03]
 [ 7.23603910e-03]
 [ 1.17522259e-02]
 [-2.10915996e-03]
 [ 9.19234476e-03]
 [-1.21193182e-02]
 [ 8.15999044e-03]
 [ 8.46411992e-03]
 [ 1.05376593e-02]
 [ 7.90047614e-03]
 [-3.26043284e-02]
 [ 8.86938551e-03]
 [ 1.37114915e-02]
 [ 3.88536480e-03]
 [-4.08295491e-03]
 [-2.10700283e-02]
 [ 2.09790313e-02]
 [-7.99652242e-04]
 [-2.06122729e-03]
 [-1.50668895e-02]
 [ 1.51454061e-02]
 [ 1.21627772e-02]
 [ 6.59544679e-03]
 [-7.41572349e-03]
 [-1.83253203e-03]
 [ 3.06469384e-03]
 [-8.86949455e-03]
 [ 5.78148422e-03]
 [-7.96101251e-03]
 [ 4.96155034e-03]
 [ 9.81297341e-03]
 [ 2.06164017e-05]
 [ 1.73160405e-03]
 [ 1.44071632e-02]
 [ 9.38823338e-03]
 [ 2.34755143e-02]
 [ 3.11315951e-03]
 [-1.24664629e-02]
 [ 1.38464811e-02]
 [ 6.95231732e-03]
 [-5.17769293e-03]
 [ 1.54468565e-02]
 [-1.38080759e-02]
 [-3.04365753e-02]
 [-9.21669280e-03]
 [ 1.51307244e-02]
 [-2.69811763e-02]
 [ 2.84104813e-02]
 [-3.00455272e-02]
 [ 6.25379641e-03]
 [ 6.66755798e-03]
 [-1.62259522e-02]
 [ 2.29844729e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.48988176]
curr_Stock_Price:  100.22422589134128
curr_Factors:  [100.22422589]
mat_Sqrt:  [[0.15]]
grads:  [0.00382325]
Stock Position:  0.0038232499504889444
Bond Position:  [5.10669949]


portfolio before change:  [5.49067934]
curr_Stock_Price:  100.34935560672798
curr_Factors:  [100.34935561]
mat_Sqrt:  [[0.15]]
grads:  [0.01829698]
Stock Position:  0.01829698224358556
Bond Position:  [3.65458896]


portfolio before change:  [5.4989907]
curr_Stock_Price:  100.79111912898651
curr_Factors:  [100.79111913]
mat_Sqrt:  [[0.15]]
grads:  [-0.02395602]
Stock Position:  -0.02395602451692215
Bond Position:  [7.91354522]


portfolio before change:  [5.47750611]
curr_Stock_Price:  101.70860026502967
curr_Factors:  [101.70860027]
mat_Sqrt:  [[0.15]]
grads:  [0.00582413]
Stock Position:  0.005824126645074003
Bond Position:  [4.88514234]


portfolio before change:  [5.47748225]
curr_Stock_Price:  101.65207794284282
curr_Factors:  [101.65207794]
mat_Sqrt:  [[0.15]]
grads:  [0.15740231]
Stock Position:  0.15740230946146208
Bond Position:  [-10.52278958]


portfolio before change:  [5.51272019]
curr_Stock_Price:  101.8801281691791
curr_Factors:  [101.88012817]
mat_Sqrt:  [[0.15]]
grads:  [0.18032375]
Stock Position:  0.1803237549813817
Bond Position:  [-12.85868708]


portfolio before change:  [5.69501282]
curr_Stock_Price:  102.89550369466915
curr_Factors:  [102.89550369]
mat_Sqrt:  [[0.15]]
grads:  [0.03177041]
Stock Position:  0.031770409384146533
Bond Position:  [2.42598054]


portfolio before change:  [5.69819909]
curr_Stock_Price:  102.99102157804326
curr_Factors:  [102.99102158]
mat_Sqrt:  [[0.15]]
grads:  [0.12058788]
Stock Position:  0.12058787798381333
Bond Position:  [-6.72126965]


portfolio before change:  [5.68724738]
curr_Stock_Price:  102.90368591986507
curr_Factors:  [102.90368592]
mat_Sqrt:  [[0.15]]
grads:  [0.1632443]
Stock Position:  0.1632443006036025
Bond Position:  [-11.11119286]


portfolio before change:  [5.78940856]
curr_Stock_Price:  103.5337578730772
curr_Factors:  [103.53375787]
mat_Sqrt:  [[0.15]]
grads:  [-0.01139946]
Stock Position:  -0.011399462637552512
Bond Position:  [6.96963776]


portfolio before change:  [5.7942794]
curr_Stock_Price:  103.1446849341568
curr_Factors:  [103.14468493]
mat_Sqrt:  [[0.15]]
grads:  [0.33291067]
Stock Position:  0.33291067395634943
Bond Position:  [-28.54368718]


portfolio before change:  [5.83747024]
curr_Stock_Price:  103.27978085354462
curr_Factors:  [103.27978085]
mat_Sqrt:  [[0.15]]
grads:  [0.37910715]
Stock Position:  0.3791071529761741
Bond Position:  [-33.31663344]


portfolio before change:  [5.55673211]
curr_Stock_Price:  102.54474916268896
curr_Factors:  [102.54474916]
mat_Sqrt:  [[0.15]]
grads:  [0.56885784]
Stock Position:  0.5688578398248845
Bond Position:  [-52.77665238]


portfolio before change:  [5.8055739]
curr_Stock_Price:  102.98798895419006
curr_Factors:  [102.98798895]
mat_Sqrt:  [[0.15]]
grads:  [0.0947089]
Stock Position:  0.09470890429472623
Bond Position:  [-3.94830569]


portfolio before change:  [5.80362876]
curr_Stock_Price:  102.9700565475084
curr_Factors:  [102.97005655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597066]
Stock Position:  -0.04597065859817453
Bond Position:  [10.53723008]


portfolio before change:  [5.7701305]
curr_Stock_Price:  103.71307088148959
curr_Factors:  [103.71307088]
mat_Sqrt:  [[0.15]]
grads:  [0.21437152]
Stock Position:  0.21437152440570553
Bond Position:  [-16.46299861]


portfolio before change:  [5.64318335]
curr_Stock_Price:  103.12568794155273
curr_Factors:  [103.12568794]
mat_Sqrt:  [[0.15]]
grads:  [0.08418532]
Stock Position:  0.08418531894273001
Bond Position:  [-3.03848558]


portfolio before change:  [5.64814228]
curr_Stock_Price:  103.18684865973141
curr_Factors:  [103.18684866]
mat_Sqrt:  [[0.15]]
grads:  [-0.04142369]
Stock Position:  -0.04142368949450432
Bond Position:  [9.92252226]


portfolio before change:  [5.68050298]
curr_Stock_Price:  102.42060771220484
curr_Factors:  [102.42060771]
mat_Sqrt:  [[0.15]]
grads:  [0.03200532]
Stock Position:  0.03200532403151745
Bond Position:  [2.40249824]


portfolio before change:  [5.69460797]
curr_Stock_Price:  102.85662361348402
curr_Factors:  [102.85662361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04415585]
Stock Position:  -0.044155854370651205
Bond Position:  [10.23633007]


portfolio before change:  [5.70982312]
curr_Stock_Price:  102.5265348034163
curr_Factors:  [102.5265348]
mat_Sqrt:  [[0.15]]
grads:  [0.09433561]
Stock Position:  0.09433560922649752
Bond Position:  [-3.96208001]


portfolio before change:  [5.71296573]
curr_Stock_Price:  102.56247295034174
curr_Factors:  [102.56247295]
mat_Sqrt:  [[0.15]]
grads:  [-0.04820208]
Stock Position:  -0.04820207813773659
Bond Position:  [10.65669006]


portfolio before change:  [5.73680052]
curr_Stock_Price:  102.0818145812894
curr_Factors:  [102.08181458]
mat_Sqrt:  [[0.15]]
grads:  [0.07389587]
Stock Position:  0.07389586816246423
Bond Position:  [-1.80662379]


portfolio before change:  [5.73858341]
curr_Stock_Price:  102.1074696289263
curr_Factors:  [102.10746963]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897885]
Stock Position:  -0.018978852567438552
Bond Position:  [7.67646602]


portfolio before change:  [5.72605326]
curr_Stock_Price:  102.79296628861783
curr_Factors:  [102.79296629]
mat_Sqrt:  [[0.15]]
grads:  [0.03302587]
Stock Position:  0.033025866246134926
Bond Position:  [2.3312265]


portfolio before change:  [5.66692563]
curr_Stock_Price:  100.99821137364182
curr_Factors:  [100.99821137]
mat_Sqrt:  [[0.15]]
grads:  [0.08908383]
Stock Position:  0.08908383022251358
Bond Position:  [-3.33038188]


portfolio before change:  [5.63321777]
curr_Stock_Price:  100.62216433705032
curr_Factors:  [100.62216434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433118]
Stock Position:  -0.043311798567035514
Bond Position:  [9.99134468]


portfolio before change:  [5.61863847]
curr_Stock_Price:  100.97319521624188
curr_Factors:  [100.97319522]
mat_Sqrt:  [[0.15]]
grads:  [0.04824026]
Stock Position:  0.04824026067936417
Bond Position:  [0.74766521]


portfolio before change:  [5.62322943]
curr_Stock_Price:  101.06739529684477
curr_Factors:  [101.0673953]
mat_Sqrt:  [[0.15]]
grads:  [0.07834817]
Stock Position:  0.07834817246235323
Bond Position:  [-2.29521628]


portfolio before change:  [5.64586634]
curr_Stock_Price:  101.35815338280275
curr_Factors:  [101.35815338]
mat_Sqrt:  [[0.15]]
grads:  [-0.01406107]
Stock Position:  -0.014061066421504623
Bond Position:  [7.07107007]


portfolio before change:  [5.64901824]
curr_Stock_Price:  101.16542643848476
curr_Factors:  [101.16542644]
mat_Sqrt:  [[0.15]]
grads:  [0.0612823]
Stock Position:  0.061282298415176926
Bond Position:  [-0.55063161]


portfolio before change:  [5.61424961]
curr_Stock_Price:  100.59863611941998
curr_Factors:  [100.59863612]
mat_Sqrt:  [[0.15]]
grads:  [-0.08079545]
Stock Position:  -0.08079545497435668
Bond Position:  [13.74216219]


portfolio before change:  [5.53253856]
curr_Stock_Price:  101.62059913286642
curr_Factors:  [101.62059913]
mat_Sqrt:  [[0.15]]
grads:  [0.05439994]
Stock Position:  0.05439993627489949
Bond Position:  [0.00438444]


portfolio before change:  [5.58865014]
curr_Stock_Price:  102.65205813368267
curr_Factors:  [102.65205813]
mat_Sqrt:  [[0.15]]
grads:  [0.05642747]
Stock Position:  0.05642746612966397
Bond Position:  [-0.2037454]


portfolio before change:  [5.6132806]
curr_Stock_Price:  103.08878158909737
curr_Factors:  [103.08878159]
mat_Sqrt:  [[0.15]]
grads:  [0.07025106]
Stock Position:  0.07025106173451234
Bond Position:  [-1.62881576]


portfolio before change:  [5.61190005]
curr_Stock_Price:  103.07057909048245
curr_Factors:  [103.07057909]
mat_Sqrt:  [[0.15]]
grads:  [0.05266984]
Stock Position:  0.05266984094973132
Bond Position:  [0.18318904]


portfolio before change:  [5.65533001]
curr_Stock_Price:  103.89493139401759
curr_Factors:  [103.89493139]
mat_Sqrt:  [[0.15]]
grads:  [-0.21736219]
Stock Position:  -0.21736218928333853
Bond Position:  [28.23815975]


portfolio before change:  [5.6693792]
curr_Stock_Price:  103.83841625457852
curr_Factors:  [103.83841625]
mat_Sqrt:  [[0.15]]
grads:  [0.05912924]
Stock Position:  0.05912923670544682
Bond Position:  [-0.47050709]


portfolio before change:  [5.70134179]
curr_Stock_Price:  104.37946830094472
curr_Factors:  [104.3794683]
mat_Sqrt:  [[0.15]]
grads:  [0.09140994]
Stock Position:  0.09140994352733817
Bond Position:  [-3.83997951]


portfolio before change:  [5.69570682]
curr_Stock_Price:  104.32044884738399
curr_Factors:  [104.32044885]
mat_Sqrt:  [[0.15]]
grads:  [0.02590243]
Stock Position:  0.02590243201860088
Bond Position:  [2.99355348]


portfolio before change:  [5.67118517]
curr_Stock_Price:  103.36653261691869
curr_Factors:  [103.36653262]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272197]
Stock Position:  -0.0272196993726298
Bond Position:  [8.48479111]


portfolio before change:  [5.69957025]
curr_Stock_Price:  102.34320162246837
curr_Factors:  [102.34320162]
mat_Sqrt:  [[0.15]]
grads:  [-0.14046686]
Stock Position:  -0.1404668554023186
Bond Position:  [20.07539795]


portfolio before change:  [5.65327324]
curr_Stock_Price:  102.68172813919385
curr_Factors:  [102.68172814]
mat_Sqrt:  [[0.15]]
grads:  [0.13986021]
Stock Position:  0.13986020844778227
Bond Position:  [-8.70781466]


portfolio before change:  [5.68396095]
curr_Stock_Price:  102.90503658145438
curr_Factors:  [102.90503658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533101]
Stock Position:  -0.005331014947325975
Bond Position:  [6.23254924]


portfolio before change:  [5.68678578]
curr_Stock_Price:  102.44822281114838
curr_Factors:  [102.44822281]
mat_Sqrt:  [[0.15]]
grads:  [-0.01374152]
Stock Position:  -0.013741515294444367
Bond Position:  [7.0945796]


portfolio before change:  [5.67753878]
curr_Stock_Price:  103.15341644226632
curr_Factors:  [103.15341644]
mat_Sqrt:  [[0.15]]
grads:  [-0.10044593]
Stock Position:  -0.10044593001355867
Bond Position:  [16.03887963]


portfolio before change:  [5.55219885]
curr_Stock_Price:  104.41123131062137
curr_Factors:  [104.41123131]
mat_Sqrt:  [[0.15]]
grads:  [0.10096937]
Stock Position:  0.10096937393353127
Bond Position:  [-4.9901378]


portfolio before change:  [5.53758397]
curr_Stock_Price:  104.26957453783727
curr_Factors:  [104.26957454]
mat_Sqrt:  [[0.15]]
grads:  [0.08108518]
Stock Position:  0.08108518153559575
Bond Position:  [-2.91713341]


portfolio before change:  [5.57949879]
curr_Stock_Price:  104.78874642322194
curr_Factors:  [104.78874642]
mat_Sqrt:  [[0.15]]
grads:  [0.04396965]
Stock Position:  0.043969645290458916
Bond Position:  [0.97197477]


portfolio before change:  [5.54462921]
curr_Stock_Price:  103.99432736067796
curr_Factors:  [103.99432736]
mat_Sqrt:  [[0.15]]
grads:  [-0.04943816]
Stock Position:  -0.04943815659243625
Bond Position:  [10.68591705]


portfolio before change:  [5.50644059]
curr_Stock_Price:  104.78028936371702
curr_Factors:  [104.78028936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01221688]
Stock Position:  -0.012216880194450472
Bond Position:  [6.78652883]


portfolio before change:  [5.51510027]
curr_Stock_Price:  104.10618020903406
curr_Factors:  [104.10618021]
mat_Sqrt:  [[0.15]]
grads:  [0.02043129]
Stock Position:  0.02043129224617186
Bond Position:  [3.38807648]


portfolio before change:  [5.506193]
curr_Stock_Price:  103.65985327960497
curr_Factors:  [103.65985328]
mat_Sqrt:  [[0.15]]
grads:  [-0.05912996]
Stock Position:  -0.05912996368458111
Bond Position:  [11.63559636]


portfolio before change:  [5.5090873]
curr_Stock_Price:  103.62320430799495
curr_Factors:  [103.62320431]
mat_Sqrt:  [[0.15]]
grads:  [0.03854323]
Stock Position:  0.038543228125374675
Bond Position:  [1.51511449]


portfolio before change:  [5.5026411]
curr_Stock_Price:  103.45350143227299
curr_Factors:  [103.45350143]
mat_Sqrt:  [[0.15]]
grads:  [-0.05307342]
Stock Position:  -0.05307341673495053
Bond Position:  [10.99327189]


portfolio before change:  [5.53873521]
curr_Stock_Price:  102.78636877974115
curr_Factors:  [102.78636878]
mat_Sqrt:  [[0.15]]
grads:  [0.033077]
Stock Position:  0.03307700228599393
Bond Position:  [2.13887025]


portfolio before change:  [5.5463162]
curr_Stock_Price:  103.01151930881457
curr_Factors:  [103.01151931]
mat_Sqrt:  [[0.15]]
grads:  [0.06541982]
Stock Position:  0.06541982273227359
Bond Position:  [-1.19267914]


portfolio before change:  [5.56689996]
curr_Stock_Price:  103.32729990044163
curr_Factors:  [103.3272999]
mat_Sqrt:  [[0.15]]
grads:  [0.00013744]
Stock Position:  0.00013744267795709938
Bond Position:  [5.55269838]


portfolio before change:  [5.56725533]
curr_Stock_Price:  103.38776778613551
curr_Factors:  [103.38776779]
mat_Sqrt:  [[0.15]]
grads:  [0.01154403]
Stock Position:  0.011544026980726685
Bond Position:  [4.37374415]


portfolio before change:  [5.57193792]
curr_Stock_Price:  103.76971625872343
curr_Factors:  [103.76971626]
mat_Sqrt:  [[0.15]]
grads:  [0.09604775]
Stock Position:  0.09604775438444946
Bond Position:  [-4.3949103]


portfolio before change:  [5.64543976]
curr_Stock_Price:  104.53783972245313
curr_Factors:  [104.53783972]
mat_Sqrt:  [[0.15]]
grads:  [0.06258822]
Stock Position:  0.06258822252203092
Bond Position:  [-0.89739781]


portfolio before change:  [5.61355589]
curr_Stock_Price:  104.02931304672879
curr_Factors:  [104.02931305]
mat_Sqrt:  [[0.15]]
grads:  [0.15650343]
Stock Position:  0.15650342847317852
Bond Position:  [-10.66738826]


portfolio before change:  [5.64864354]
curr_Stock_Price:  104.25777056508218
curr_Factors:  [104.25777057]
mat_Sqrt:  [[0.15]]
grads:  [0.0207544]
Stock Position:  0.0207543967535515
Bond Position:  [3.48483641]


portfolio before change:  [5.65174298]
curr_Stock_Price:  104.39661458324954
curr_Factors:  [104.39661458]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310975]
Stock Position:  -0.08310975276049316
Bond Position:  [14.3281198]


portfolio before change:  [5.59843159]
curr_Stock_Price:  105.04884753912698
curr_Factors:  [105.04884754]
mat_Sqrt:  [[0.15]]
grads:  [0.09230987]
Stock Position:  0.09230987407112985
Bond Position:  [-4.0986143]


portfolio before change:  [5.6372053]
curr_Stock_Price:  105.47166121791845
curr_Factors:  [105.47166122]
mat_Sqrt:  [[0.15]]
grads:  [0.04634878]
Stock Position:  0.04634878213188513
Bond Position:  [0.74872225]


portfolio before change:  [5.63914978]
curr_Stock_Price:  105.51260475965657
curr_Factors:  [105.51260476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03451795]
Stock Position:  -0.03451795289264737
Bond Position:  [9.2812289]


portfolio before change:  [5.64400082]
curr_Stock_Price:  105.38887360267047
curr_Factors:  [105.3888736]
mat_Sqrt:  [[0.15]]
grads:  [0.10297904]
Stock Position:  0.10297904309640646
Bond Position:  [-5.20884454]


portfolio before change:  [5.72302393]
curr_Stock_Price:  106.15940582909295
curr_Factors:  [106.15940583]
mat_Sqrt:  [[0.15]]
grads:  [-0.09205384]
Stock Position:  -0.09205383936817406
Bond Position:  [15.49540482]


portfolio before change:  [5.66798182]
curr_Stock_Price:  106.76786060015073
curr_Factors:  [106.7678606]
mat_Sqrt:  [[0.15]]
grads:  [-0.2029105]
Stock Position:  -0.20291050180698383
Bond Position:  [27.33230199]


portfolio before change:  [5.74988308]
curr_Stock_Price:  106.37264729439447
curr_Factors:  [106.37264729]
mat_Sqrt:  [[0.15]]
grads:  [-0.06144462]
Stock Position:  -0.06144461868436874
Bond Position:  [12.28590983]


portfolio before change:  [5.74813655]
curr_Stock_Price:  106.41356904974492
curr_Factors:  [106.41356905]
mat_Sqrt:  [[0.15]]
grads:  [0.1008715]
Stock Position:  0.10087149572096037
Bond Position:  [-4.98595933]


portfolio before change:  [5.83636015]
curr_Stock_Price:  107.29127222818917
curr_Factors:  [107.29127223]
mat_Sqrt:  [[0.15]]
grads:  [-0.17987451]
Stock Position:  -0.17987450855068765
Bond Position:  [25.13532501]


portfolio before change:  [5.81080987]
curr_Stock_Price:  107.4420511466052
curr_Factors:  [107.44205115]
mat_Sqrt:  [[0.15]]
grads:  [0.18940321]
Stock Position:  0.18940320881186806
Bond Position:  [-14.53905938]


portfolio before change:  [5.88970862]
curr_Stock_Price:  107.86341397619826
curr_Factors:  [107.86341398]
mat_Sqrt:  [[0.15]]
grads:  [-0.20030351]
Stock Position:  -0.20030351470275337
Bond Position:  [27.49512955]


portfolio before change:  [5.89193639]
curr_Stock_Price:  107.86087150997368
curr_Factors:  [107.86087151]
mat_Sqrt:  [[0.15]]
grads:  [0.04169198]
Stock Position:  0.041691976041655136
Bond Position:  [1.39500352]


portfolio before change:  [5.85924158]
curr_Stock_Price:  107.07458114834414
curr_Factors:  [107.07458115]
mat_Sqrt:  [[0.15]]
grads:  [0.04445039]
Stock Position:  0.04445038653792554
Bond Position:  [1.09973506]


portfolio before change:  [5.87419274]
curr_Stock_Price:  107.40939090110275
curr_Factors:  [107.4093909]
mat_Sqrt:  [[0.15]]
grads:  [-0.10817301]
Stock Position:  -0.10817301457084863
Bond Position:  [17.49299034]


portfolio before change:  [5.95275335]
curr_Stock_Price:  106.69324867967369
curr_Factors:  [106.69324868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.95275335]
Stock Price:  106.79188631897316
PL:  [-0.83913297]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.01901555e-03]
 [ 2.62393013e-03]
 [-2.21280517e-03]
 [ 3.66089297e-03]
 [ 4.03660396e-02]
 [ 2.64361851e-02]
 [ 6.46636149e-03]
 [ 2.13817724e-02]
 [ 2.43591347e-02]
 [-3.51191879e-03]
 [ 5.64712643e-02]
 [ 9.41564543e-02]
 [ 1.23498042e-01]
 [ 1.39335457e-02]
 [-6.90002293e-03]
 [ 2.99086247e-02]
 [ 1.33634909e-02]
 [ 1.06222173e-03]
 [ 1.25130085e-02]
 [-9.76731888e-03]
 [ 1.51339021e-02]
 [-1.42859983e-02]
 [ 1.04106855e-02]
 [-8.88644939e-02]
 [ 1.23378697e-02]
 [ 6.16029880e-03]
 [-4.48341639e-03]
 [ 1.37106972e-02]
 [ 4.40493738e-02]
 [ 3.11077331e-03]
 [ 1.53299824e-02]
 [-6.91466387e-03]
 [ 2.33596003e-03]
 [ 8.09046844e-03]
 [ 1.01903171e-02]
 [ 6.71948974e-03]
 [-3.25903480e-02]
 [ 8.78151049e-03]
 [ 1.39729495e-02]
 [ 2.43888408e-03]
 [-4.37782420e-03]
 [-1.63505211e-02]
 [ 2.03521055e-02]
 [-3.65977266e-03]
 [ 4.89922328e-03]
 [-1.63009715e-02]
 [ 1.47685537e-02]
 [ 7.86178356e-03]
 [-1.16495936e-03]
 [-7.48608988e-03]
 [-1.61072138e-02]
 [-7.00413958e-03]
 [ 9.22727733e-04]
 [ 5.42757032e-03]
 [ 5.54680748e-03]
 [-2.87384861e-03]
 [ 5.31827047e-03]
 [-2.73377882e-04]
 [ 1.61228329e-03]
 [ 1.39108566e-02]
 [ 3.63912225e-04]
 [-1.02880140e-02]
 [ 4.28699814e-03]
 [-1.78513553e-02]
 [-1.21932857e-02]
 [-6.13207829e-03]
 [-4.82817858e-03]
 [ 2.06181035e-02]
 [-9.73746372e-03]
 [ 6.92291322e-03]
 [-5.78672930e-03]
 [ 1.09409165e-02]
 [-4.55683283e-03]
 [ 8.38260908e-03]
 [-1.82067301e-02]
 [-5.95274322e-03]
 [-3.16171050e-03]
 [-1.97787572e-03]
 [-4.00835734e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.67689781]
curr_Stock_Price:  100.10633668426811
curr_Factors:  [100.10633668]
mat_Sqrt:  [[0.15]]
grads:  [0.00679344]
Stock Position:  0.006793436997504822
Bond Position:  [2.99683171]


portfolio before change:  [3.67910861]
curr_Stock_Price:  100.40419721786338
curr_Factors:  [100.40419722]
mat_Sqrt:  [[0.15]]
grads:  [0.01749287]
Stock Position:  0.01749286752009516
Bond Position:  [1.92275129]


portfolio before change:  [3.68109423]
curr_Stock_Price:  100.51083730400553
curr_Factors:  [100.5108373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475203]
Stock Position:  -0.0147520344950204
Bond Position:  [5.16383357]


portfolio before change:  [3.67185313]
curr_Stock_Price:  101.15914434056191
curr_Factors:  [101.15914434]
mat_Sqrt:  [[0.15]]
grads:  [0.02440595]
Stock Position:  0.024405953132277496
Bond Position:  [1.20296779]


portfolio before change:  [3.70583933]
curr_Stock_Price:  102.54860112485632
curr_Factors:  [102.54860112]
mat_Sqrt:  [[0.15]]
grads:  [0.26910693]
Stock Position:  0.2691069306008794
Bond Position:  [-23.89069995]


portfolio before change:  [3.77277228]
curr_Stock_Price:  102.80287239114739
curr_Factors:  [102.80287239]
mat_Sqrt:  [[0.15]]
grads:  [0.17624123]
Stock Position:  0.1762412340880126
Bond Position:  [-14.34533282]


portfolio before change:  [3.98435482]
curr_Stock_Price:  104.00848782725275
curr_Factors:  [104.00848783]
mat_Sqrt:  [[0.15]]
grads:  [0.04310908]
Stock Position:  0.04310907662922725
Bond Position:  [-0.49935505]


portfolio before change:  [3.96056605]
curr_Stock_Price:  103.45738438455648
curr_Factors:  [103.45738438]
mat_Sqrt:  [[0.15]]
grads:  [0.14254515]
Stock Position:  0.1425451492694751
Bond Position:  [-10.78678225]


portfolio before change:  [3.99376801]
curr_Stock_Price:  103.69503653052541
curr_Factors:  [103.69503653]
mat_Sqrt:  [[0.15]]
grads:  [0.16239423]
Stock Position:  0.16239423109749998
Bond Position:  [-12.84570771]


portfolio before change:  [3.86325976]
curr_Stock_Price:  102.89632973622635
curr_Factors:  [102.89632974]
mat_Sqrt:  [[0.15]]
grads:  [-0.02341279]
Stock Position:  -0.023412791947382574
Bond Position:  [6.27235012]


portfolio before change:  [3.8476355]
curr_Stock_Price:  103.58041243634877
curr_Factors:  [103.58041244]
mat_Sqrt:  [[0.15]]
grads:  [0.3764751]
Stock Position:  0.3764750955166461
Bond Position:  [-35.14781016]


portfolio before change:  [3.92014018]
curr_Stock_Price:  103.77883586276579
curr_Factors:  [103.77883586]
mat_Sqrt:  [[0.15]]
grads:  [0.6277097]
Stock Position:  0.6277096956367695
Bond Position:  [-61.2228413]


portfolio before change:  [3.7543646]
curr_Stock_Price:  103.52083598632764
curr_Factors:  [103.52083599]
mat_Sqrt:  [[0.15]]
grads:  [0.82332028]
Stock Position:  0.8233202791512128
Bond Position:  [-81.47643898]


portfolio before change:  [3.27247082]
curr_Stock_Price:  102.9417158589916
curr_Factors:  [102.94171586]
mat_Sqrt:  [[0.15]]
grads:  [0.0928903]
Stock Position:  0.09289030434555735
Bond Position:  [-6.28981649]


portfolio before change:  [3.22880957]
curr_Stock_Price:  102.47591777922722
curr_Factors:  [102.47591778]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600015]
Stock Position:  -0.04600015287072444
Bond Position:  [7.94271746]


portfolio before change:  [3.19683029]
curr_Stock_Price:  103.18190927121842
curr_Factors:  [103.18190927]
mat_Sqrt:  [[0.15]]
grads:  [0.19939083]
Stock Position:  0.19939083123673346
Bond Position:  [-17.37669637]


portfolio before change:  [3.24738721]
curr_Stock_Price:  103.4409131395554
curr_Factors:  [103.44091314]
mat_Sqrt:  [[0.15]]
grads:  [0.08908994]
Stock Position:  0.08908993941604132
Bond Position:  [-5.96815747]


portfolio before change:  [3.29561909]
curr_Stock_Price:  103.98648425820559
curr_Factors:  [103.98648426]
mat_Sqrt:  [[0.15]]
grads:  [0.00708148]
Stock Position:  0.007081478209914431
Bond Position:  [2.55924106]


portfolio before change:  [3.29607437]
curr_Stock_Price:  104.02818873025714
curr_Factors:  [104.02818873]
mat_Sqrt:  [[0.15]]
grads:  [0.08342006]
Stock Position:  0.08342005639767504
Bond Position:  [-5.381963]


portfolio before change:  [3.32391249]
curr_Stock_Price:  104.3659312753421
curr_Factors:  [104.36593128]
mat_Sqrt:  [[0.15]]
grads:  [-0.06511546]
Stock Position:  -0.06511545921566979
Bond Position:  [10.11974803]


portfolio before change:  [3.31450378]
curr_Stock_Price:  104.52013760236167
curr_Factors:  [104.5201376]
mat_Sqrt:  [[0.15]]
grads:  [0.10089268]
Stock Position:  0.10089268071835773
Bond Position:  [-7.23081309]


portfolio before change:  [3.27630616]
curr_Stock_Price:  104.14602044429694
curr_Factors:  [104.14602044]
mat_Sqrt:  [[0.15]]
grads:  [-0.09523999]
Stock Position:  -0.0952399889039971
Bond Position:  [13.19517199]


portfolio before change:  [3.22311209]
curr_Stock_Price:  104.71320648505011
curr_Factors:  [104.71320649]
mat_Sqrt:  [[0.15]]
grads:  [0.06940457]
Stock Position:  0.06940456972302424
Bond Position:  [-4.04446295]


portfolio before change:  [3.2760907]
curr_Stock_Price:  105.48017898784039
curr_Factors:  [105.48017899]
mat_Sqrt:  [[0.15]]
grads:  [-0.59242996]
Stock Position:  -0.5924299592456227
Bond Position:  [65.76570884]


portfolio before change:  [3.43350667]
curr_Stock_Price:  105.22140496188452
curr_Factors:  [105.22140496]
mat_Sqrt:  [[0.15]]
grads:  [0.08225246]
Stock Position:  0.08225246493082364
Bond Position:  [-5.22121325]


portfolio before change:  [3.39047789]
curr_Stock_Price:  104.70224182295826
curr_Factors:  [104.70224182]
mat_Sqrt:  [[0.15]]
grads:  [0.04106866]
Stock Position:  0.041068658682846135
Bond Position:  [-0.90950275]


portfolio before change:  [3.37086173]
curr_Stock_Price:  104.22598300543633
curr_Factors:  [104.22598301]
mat_Sqrt:  [[0.15]]
grads:  [-0.02988944]
Stock Position:  -0.029889442612849402
Bond Position:  [6.48611827]


portfolio before change:  [3.39647315]
curr_Stock_Price:  103.3826744755486
curr_Factors:  [103.38267448]
mat_Sqrt:  [[0.15]]
grads:  [0.09140465]
Stock Position:  0.0914046478795864
Bond Position:  [-6.05318381]


portfolio before change:  [3.37317052]
curr_Stock_Price:  103.13187443647074
curr_Factors:  [103.13187444]
mat_Sqrt:  [[0.15]]
grads:  [0.29366249]
Stock Position:  0.29366249184247123
Bond Position:  [-26.91279271]


portfolio before change:  [3.39360601]
curr_Stock_Price:  103.20719080591982
curr_Factors:  [103.20719081]
mat_Sqrt:  [[0.15]]
grads:  [0.02073849]
Stock Position:  0.020738488765571234
Bond Position:  [1.25324485]


portfolio before change:  [3.38247294]
curr_Stock_Price:  102.66658228647927
curr_Factors:  [102.66658229]
mat_Sqrt:  [[0.15]]
grads:  [0.10219988]
Stock Position:  0.10219988244507221
Bond Position:  [-7.1100397]


portfolio before change:  [3.41438093]
curr_Stock_Price:  102.98314213535569
curr_Factors:  [102.98314214]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609776]
Stock Position:  -0.0460977591582879
Bond Position:  [8.16167301]


portfolio before change:  [3.41362326]
curr_Stock_Price:  103.01064429201568
curr_Factors:  [103.01064429]
mat_Sqrt:  [[0.15]]
grads:  [0.01557307]
Stock Position:  0.015573066858708743
Bond Position:  [1.80943161]


portfolio before change:  [3.43208005]
curr_Stock_Price:  104.18855627113123
curr_Factors:  [104.18855627]
mat_Sqrt:  [[0.15]]
grads:  [0.05393646]
Stock Position:  0.0539364562651896
Bond Position:  [-2.18748145]


portfolio before change:  [3.42379126]
curr_Stock_Price:  104.0374140679892
curr_Factors:  [104.03741407]
mat_Sqrt:  [[0.15]]
grads:  [0.06793545]
Stock Position:  0.06793544719429426
Bond Position:  [-3.64403699]


portfolio before change:  [3.42727579]
curr_Stock_Price:  104.09205849052596
curr_Factors:  [104.09205849]
mat_Sqrt:  [[0.15]]
grads:  [0.0447966]
Stock Position:  0.04479659827345797
Bond Position:  [-1.23569434]


portfolio before change:  [3.41959487]
curr_Stock_Price:  103.9223204093978
curr_Factors:  [103.92232041]
mat_Sqrt:  [[0.15]]
grads:  [-0.21726899]
Stock Position:  -0.21726898663165892
Bond Position:  [25.99869211]


portfolio before change:  [3.33655905]
curr_Stock_Price:  104.31197926143028
curr_Factors:  [104.31197926]
mat_Sqrt:  [[0.15]]
grads:  [0.0585434]
Stock Position:  0.058543403280242386
Bond Position:  [-2.77021921]


portfolio before change:  [3.34453286]
curr_Stock_Price:  104.45114009201401
curr_Factors:  [104.45114009]
mat_Sqrt:  [[0.15]]
grads:  [0.093153]
Stock Position:  0.09315299672043478
Bond Position:  [-6.38540385]


portfolio before change:  [3.34732441]
curr_Stock_Price:  104.48539185141804
curr_Factors:  [104.48539185]
mat_Sqrt:  [[0.15]]
grads:  [0.01625923]
Stock Position:  0.01625922720306666
Bond Position:  [1.64847269]


portfolio before change:  [3.34746737]
curr_Stock_Price:  104.48784752422792
curr_Factors:  [104.48784752]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918549]
Stock Position:  -0.02918549467722335
Bond Position:  [6.39699689]


portfolio before change:  [3.35409667]
curr_Stock_Price:  104.27440325601886
curr_Factors:  [104.27440326]
mat_Sqrt:  [[0.15]]
grads:  [-0.10900347]
Stock Position:  -0.10900347416257924
Bond Position:  [14.7203689]


portfolio before change:  [3.31214502]
curr_Stock_Price:  104.66770916719841
curr_Factors:  [104.66770917]
mat_Sqrt:  [[0.15]]
grads:  [0.1356807]
Stock Position:  0.13568070366466248
Bond Position:  [-10.88924342]


portfolio before change:  [3.29102274]
curr_Stock_Price:  104.5170489803997
curr_Factors:  [104.51704898]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439848]
Stock Position:  -0.024398484373802713
Bond Position:  [5.84108032]


portfolio before change:  [3.31303908]
curr_Stock_Price:  103.62964693576247
curr_Factors:  [103.62964694]
mat_Sqrt:  [[0.15]]
grads:  [0.03266149]
Stock Position:  0.03266148850822709
Bond Position:  [-0.07165944]


portfolio before change:  [3.30645855]
curr_Stock_Price:  103.42830733282968
curr_Factors:  [103.42830733]
mat_Sqrt:  [[0.15]]
grads:  [-0.10867314]
Stock Position:  -0.10867314349818377
Bond Position:  [14.54633783]


portfolio before change:  [3.26298935]
curr_Stock_Price:  103.83667290639997
curr_Factors:  [103.83667291]
mat_Sqrt:  [[0.15]]
grads:  [0.09845702]
Stock Position:  0.0984570244155345
Bond Position:  [-6.96046049]


portfolio before change:  [3.23545813]
curr_Stock_Price:  103.5614646630234
curr_Factors:  [103.56146466]
mat_Sqrt:  [[0.15]]
grads:  [0.05241189]
Stock Position:  0.05241189036724277
Bond Position:  [-2.19239401]


portfolio before change:  [3.18077158]
curr_Stock_Price:  102.52067942058679
curr_Factors:  [102.52067942]
mat_Sqrt:  [[0.15]]
grads:  [-0.0077664]
Stock Position:  -0.007766395763204873
Bond Position:  [3.97698775]


portfolio before change:  [3.18531768]
curr_Stock_Price:  101.96732916147177
curr_Factors:  [101.96732916]
mat_Sqrt:  [[0.15]]
grads:  [-0.04990727]
Stock Position:  -0.04990726589940565
Bond Position:  [8.27422829]


portfolio before change:  [3.19437789]
curr_Stock_Price:  101.79615069225497
curr_Factors:  [101.79615069]
mat_Sqrt:  [[0.15]]
grads:  [-0.10738143]
Stock Position:  -0.1073814250671486
Bond Position:  [14.12539362]


portfolio before change:  [3.28407322]
curr_Stock_Price:  100.96907590530971
curr_Factors:  [100.96907591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04669426]
Stock Position:  -0.04669426386604209
Bond Position:  [7.99874989]


portfolio before change:  [3.30566089]
curr_Stock_Price:  100.51746294453429
curr_Factors:  [100.51746294]
mat_Sqrt:  [[0.15]]
grads:  [0.00615152]
Stock Position:  0.006151518220269484
Bond Position:  [2.68732589]


portfolio before change:  [3.30095448]
curr_Stock_Price:  99.72507734125942
curr_Factors:  [99.72507734]
mat_Sqrt:  [[0.15]]
grads:  [0.0361838]
Stock Position:  0.03618380210803991
Bond Position:  [-0.30747798]


portfolio before change:  [3.31404866]
curr_Stock_Price:  100.0874879748259
curr_Factors:  [100.08748797]
mat_Sqrt:  [[0.15]]
grads:  [0.03697872]
Stock Position:  0.03697871653322879
Bond Position:  [-0.38705819]


portfolio before change:  [3.31230658]
curr_Stock_Price:  100.04103174787824
curr_Factors:  [100.04103175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01915899]
Stock Position:  -0.019158990720794095
Bond Position:  [5.22899177]


portfolio before change:  [3.3102618]
curr_Stock_Price:  100.16481683376811
curr_Factors:  [100.16481683]
mat_Sqrt:  [[0.15]]
grads:  [0.03545514]
Stock Position:  0.03545513645393154
Bond Position:  [-0.24109545]


portfolio before change:  [3.31852566]
curr_Stock_Price:  100.39832119536206
curr_Factors:  [100.3983212]
mat_Sqrt:  [[0.15]]
grads:  [-0.00182252]
Stock Position:  -0.001822519214457937
Bond Position:  [3.50150353]


portfolio before change:  [3.31648467]
curr_Stock_Price:  101.63827479764544
curr_Factors:  [101.6382748]
mat_Sqrt:  [[0.15]]
grads:  [0.01074856]
Stock Position:  0.01074855527350816
Bond Position:  [2.22402006]


portfolio before change:  [3.31188918]
curr_Stock_Price:  101.1977969231268
curr_Factors:  [101.19779692]
mat_Sqrt:  [[0.15]]
grads:  [0.09273904]
Stock Position:  0.09273904393442281
Bond Position:  [-6.07309776]


portfolio before change:  [3.30838525]
curr_Stock_Price:  101.16410726462453
curr_Factors:  [101.16410726]
mat_Sqrt:  [[0.15]]
grads:  [0.00242608]
Stock Position:  0.0024260815010307933
Bond Position:  [3.06295288]


portfolio before change:  [3.30499222]
curr_Stock_Price:  99.68663584815404
curr_Factors:  [99.68663585]
mat_Sqrt:  [[0.15]]
grads:  [-0.06858676]
Stock Position:  -0.06858676012914884
Bond Position:  [10.14217561]


portfolio before change:  [3.38398571]
curr_Stock_Price:  98.54414744690116
curr_Factors:  [98.54414745]
mat_Sqrt:  [[0.15]]
grads:  [0.02857999]
Stock Position:  0.02857998759120508
Bond Position:  [0.5675952]


portfolio before change:  [3.37573438]
curr_Stock_Price:  98.25419620224936
curr_Factors:  [98.2541962]
mat_Sqrt:  [[0.15]]
grads:  [-0.11900904]
Stock Position:  -0.11900903556352763
Bond Position:  [15.06887151]


portfolio before change:  [3.35776693]
curr_Stock_Price:  98.4130856632939
curr_Factors:  [98.41308566]
mat_Sqrt:  [[0.15]]
grads:  [-0.08128857]
Stock Position:  -0.08128857127979303
Bond Position:  [11.35762606]


portfolio before change:  [3.40496875]
curr_Stock_Price:  97.84114863804186
curr_Factors:  [97.84114864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04088052]
Stock Position:  -0.04088052191367205
Bond Position:  [7.40476597]


portfolio before change:  [3.39224324]
curr_Stock_Price:  98.16375508602843
curr_Factors:  [98.16375509]
mat_Sqrt:  [[0.15]]
grads:  [-0.03218786]
Stock Position:  -0.03218785719477427
Bond Position:  [6.55192417]


portfolio before change:  [3.37941193]
curr_Stock_Price:  98.57511570417597
curr_Factors:  [98.5751157]
mat_Sqrt:  [[0.15]]
grads:  [0.13745402]
Stock Position:  0.13745402316617114
Bond Position:  [-10.1701343]


portfolio before change:  [3.34126114]
curr_Stock_Price:  98.3021870421763
curr_Factors:  [98.30218704]
mat_Sqrt:  [[0.15]]
grads:  [-0.06491642]
Stock Position:  -0.06491642480087184
Bond Position:  [9.72268767]


portfolio before change:  [3.35894806]
curr_Stock_Price:  98.03909126677495
curr_Factors:  [98.03909127]
mat_Sqrt:  [[0.15]]
grads:  [0.04615275]
Stock Position:  0.04615275481407114
Bond Position:  [-1.16582608]


portfolio before change:  [3.36192761]
curr_Stock_Price:  98.10522837098014
curr_Factors:  [98.10522837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0385782]
Stock Position:  -0.03857819533848661
Bond Position:  [7.14665027]


portfolio before change:  [3.34233436]
curr_Stock_Price:  98.6246908016457
curr_Factors:  [98.6246908]
mat_Sqrt:  [[0.15]]
grads:  [0.07293944]
Stock Position:  0.07293944321823195
Bond Position:  [-3.85129567]


portfolio before change:  [3.3621778]
curr_Stock_Price:  98.90004455241454
curr_Factors:  [98.90004455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03037889]
Stock Position:  -0.03037888554518156
Bond Position:  [6.36665093]


portfolio before change:  [3.36811735]
curr_Stock_Price:  98.71762746700216
curr_Factors:  [98.71762747]
mat_Sqrt:  [[0.15]]
grads:  [0.05588406]
Stock Position:  0.055884060561138656
Bond Position:  [-2.14862452]


portfolio before change:  [3.36955712]
curr_Stock_Price:  98.7457940636208
curr_Factors:  [98.74579406]
mat_Sqrt:  [[0.15]]
grads:  [-0.1213782]
Stock Position:  -0.12137820070074529
Bond Position:  [15.35514393]


portfolio before change:  [3.3720399]
curr_Stock_Price:  98.73324609684143
curr_Factors:  [98.7332461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03968495]
Stock Position:  -0.039684954776987254
Bond Position:  [7.29026431]


portfolio before change:  [3.35321922]
curr_Stock_Price:  99.21898012998696
curr_Factors:  [99.21898013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02107807]
Stock Position:  -0.021078070023069318
Bond Position:  [5.44456383]


portfolio before change:  [3.34606537]
curr_Stock_Price:  99.57452276483934
curr_Factors:  [99.57452276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01318584]
Stock Position:  -0.013185838101811303
Bond Position:  [4.6590389]


portfolio before change:  [3.35214721]
curr_Stock_Price:  99.13536656016863
curr_Factors:  [99.13536656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35214721]
Stock Price:  100.3210427239287
PL:  [3.03110448]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 9.99566727e-04]
 [ 2.01913872e-03]
 [-3.27704374e-03]
 [-5.43589757e-03]
 [ 3.57935140e-02]
 [ 2.63613196e-02]
 [ 3.94820835e-03]
 [ 1.14643628e-02]
 [ 2.45972698e-02]
 [-4.06436128e-03]
 [ 3.76532510e-02]
 [-5.22848915e-02]
 [ 3.69955396e-02]
 [ 9.64954711e-04]
 [-6.91408092e-03]
 [ 1.92934984e-02]
 [ 9.14577720e-03]
 [-1.18775778e-02]
 [-6.60729420e-04]
 [-4.39605374e-03]
 [ 1.17840932e-02]
 [-8.06094443e-03]
 [ 6.86784828e-03]
 [ 4.60552538e-02]
 [-8.04484058e-03]
 [ 6.66653239e-03]
 [-7.16633063e-03]
 [ 6.51069514e-03]
 [-8.31200120e-04]
 [-2.22349571e-03]
 [-2.95986932e-03]
 [-1.06333963e-02]
 [-5.21483558e-03]
 [ 4.75096945e-03]
 [ 1.16135791e-02]
 [ 1.17613545e-02]
 [-3.51250653e-02]
 [ 9.39682687e-03]
 [-1.41454735e-02]
 [ 2.45240518e-02]
 [-5.93901574e-03]
 [-3.89448745e-03]
 [ 2.33975611e-02]
 [ 4.60222049e-03]
 [-4.73952810e-03]
 [-5.82468587e-03]
 [ 1.29893357e-03]
 [-1.23626070e-02]
 [-1.23184745e-02]
 [-6.04921297e-03]
 [ 4.74806312e-02]
 [-1.02228190e-02]
 [ 2.76896551e-03]
 [ 5.03558559e-03]
 [ 4.16520390e-03]
 [-1.30563274e-03]
 [ 2.77381731e-03]
 [-6.61113073e-04]
 [ 1.53547526e-03]
 [-8.39381786e-04]
 [ 3.11147435e-04]
 [-1.49223505e-04]
 [ 3.53682927e-04]
 [-1.69959859e-02]
 [-1.35842613e-02]
 [-1.22846585e-04]
 [-4.86448398e-03]
 [ 1.99997769e-02]
 [-9.63131066e-03]
 [ 6.17497626e-03]
 [-8.04587538e-03]
 [ 1.06681476e-02]
 [-6.11191481e-03]
 [ 9.61401781e-03]
 [-1.72215120e-02]
 [-4.33852767e-03]
 [-5.21772840e-03]
 [-2.09334711e-03]
 [-6.86251371e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75604075]
curr_Stock_Price:  100.1114829510097
curr_Factors:  [100.11148295]
mat_Sqrt:  [[0.15]]
grads:  [0.00666378]
Stock Position:  0.006663778183132321
Bond Position:  [3.08892003]


portfolio before change:  [3.75996286]
curr_Stock_Price:  100.6710821763699
curr_Factors:  [100.67108218]
mat_Sqrt:  [[0.15]]
grads:  [0.01346092]
Stock Position:  0.013460924779100901
Bond Position:  [2.40483699]


portfolio before change:  [3.78280874]
curr_Stock_Price:  102.3571160785242
curr_Factors:  [102.35711608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02184696]
Stock Position:  -0.021846958266427595
Bond Position:  [6.01900038]


portfolio before change:  [3.77206783]
curr_Stock_Price:  102.86597895922998
curr_Factors:  [102.86597896]
mat_Sqrt:  [[0.15]]
grads:  [-0.03623932]
Stock Position:  -0.03623931712976477
Bond Position:  [7.49986067]


portfolio before change:  [3.7929043]
curr_Stock_Price:  102.30394546330848
curr_Factors:  [102.30394546]
mat_Sqrt:  [[0.15]]
grads:  [0.23862343]
Stock Position:  0.23862342662562608
Bond Position:  [-20.61921372]


portfolio before change:  [3.93759008]
curr_Stock_Price:  102.91568139114665
curr_Factors:  [102.91568139]
mat_Sqrt:  [[0.15]]
grads:  [0.17574213]
Stock Position:  0.17574213034019875
Bond Position:  [-14.14903101]


portfolio before change:  [3.83916109]
curr_Stock_Price:  102.36063719709632
curr_Factors:  [102.3606372]
mat_Sqrt:  [[0.15]]
grads:  [0.02632139]
Stock Position:  0.026321388990260063
Bond Position:  [1.14488694]


portfolio before change:  [3.83113806]
curr_Stock_Price:  102.0531082050961
curr_Factors:  [102.05310821]
mat_Sqrt:  [[0.15]]
grads:  [0.07642909]
Stock Position:  0.07642908554875412
Bond Position:  [-3.96868768]


portfolio before change:  [3.84342612]
curr_Stock_Price:  102.21713095251269
curr_Factors:  [102.21713095]
mat_Sqrt:  [[0.15]]
grads:  [0.1639818]
Stock Position:  0.16398179853959735
Bond Position:  [-12.91832286]


portfolio before change:  [3.92195001]
curr_Stock_Price:  102.70091214292833
curr_Factors:  [102.70091214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02709574]
Stock Position:  -0.027095741860483982
Bond Position:  [6.70470741]


portfolio before change:  [3.93253738]
curr_Stock_Price:  102.32563837012934
curr_Factors:  [102.32563837]
mat_Sqrt:  [[0.15]]
grads:  [0.25102167]
Stock Position:  0.2510216731168266
Bond Position:  [-21.75341556]


portfolio before change:  [3.72063755]
curr_Stock_Price:  101.4869051997375
curr_Factors:  [101.4869052]
mat_Sqrt:  [[0.15]]
grads:  [-0.34856594]
Stock Position:  -0.34856594303385596
Bond Position:  [39.09551637]


portfolio before change:  [3.78518024]
curr_Stock_Price:  101.30874912866369
curr_Factors:  [101.30874913]
mat_Sqrt:  [[0.15]]
grads:  [0.24663693]
Stock Position:  0.24663693073297333
Bond Position:  [-21.20129871]


portfolio before change:  [3.63514086]
curr_Stock_Price:  100.70578083149479
curr_Factors:  [100.70578083]
mat_Sqrt:  [[0.15]]
grads:  [0.00643303]
Stock Position:  0.006433031409028145
Bond Position:  [2.98729741]


portfolio before change:  [3.63144145]
curr_Stock_Price:  100.10169096965282
curr_Factors:  [100.10169097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609387]
Stock Position:  -0.046093872786945975
Bond Position:  [8.24551605]


portfolio before change:  [3.58808979]
curr_Stock_Price:  101.05337955701592
curr_Factors:  [101.05337956]
mat_Sqrt:  [[0.15]]
grads:  [0.12862332]
Stock Position:  0.12862332241696078
Bond Position:  [-9.40973163]


portfolio before change:  [3.52110186]
curr_Stock_Price:  100.53714498288207
curr_Factors:  [100.53714498]
mat_Sqrt:  [[0.15]]
grads:  [0.06097185]
Stock Position:  0.06097184797863107
Bond Position:  [-2.60883366]


portfolio before change:  [3.51910201]
curr_Stock_Price:  100.50701970126376
curr_Factors:  [100.5070197]
mat_Sqrt:  [[0.15]]
grads:  [-0.07918385]
Stock Position:  -0.07918385211140272
Bond Position:  [11.47763499]


portfolio before change:  [3.4782608]
curr_Stock_Price:  101.03185636881142
curr_Factors:  [101.03185637]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440486]
Stock Position:  -0.004404862799772605
Bond Position:  [3.92329226]


portfolio before change:  [3.47714844]
curr_Stock_Price:  101.34005392348693
curr_Factors:  [101.34005392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02930702]
Stock Position:  -0.02930702496069052
Bond Position:  [6.44712393]


portfolio before change:  [3.50430744]
curr_Stock_Price:  100.42709729220562
curr_Factors:  [100.42709729]
mat_Sqrt:  [[0.15]]
grads:  [0.07856062]
Stock Position:  0.07856062161468749
Bond Position:  [-4.38530775]


portfolio before change:  [3.47579481]
curr_Stock_Price:  100.0676482150961
curr_Factors:  [100.06764822]
mat_Sqrt:  [[0.15]]
grads:  [-0.05373963]
Stock Position:  -0.05373962951234784
Bond Position:  [8.85339315]


portfolio before change:  [3.43844334]
curr_Stock_Price:  100.77299023838664
curr_Factors:  [100.77299024]
mat_Sqrt:  [[0.15]]
grads:  [0.04578566]
Stock Position:  0.04578565517375305
Bond Position:  [-1.17551404]


portfolio before change:  [3.40590147]
curr_Stock_Price:  100.06385103096052
curr_Factors:  [100.06385103]
mat_Sqrt:  [[0.15]]
grads:  [0.30703503]
Stock Position:  0.30703502556103285
Bond Position:  [-27.31720559]


portfolio before change:  [3.07922123]
curr_Stock_Price:  99.00542828258882
curr_Factors:  [99.00542828]
mat_Sqrt:  [[0.15]]
grads:  [-0.05363227]
Stock Position:  -0.05363227052596391
Bond Position:  [8.38910715]


portfolio before change:  [3.04806384]
curr_Stock_Price:  99.59614973906434
curr_Factors:  [99.59614974]
mat_Sqrt:  [[0.15]]
grads:  [0.04444355]
Stock Position:  0.044443549259351074
Bond Position:  [-1.37834255]


portfolio before change:  [3.06719788]
curr_Stock_Price:  100.02861286141044
curr_Factors:  [100.02861286]
mat_Sqrt:  [[0.15]]
grads:  [-0.04777554]
Stock Position:  -0.047775537544717736
Bond Position:  [7.84611863]


portfolio before change:  [3.03825889]
curr_Stock_Price:  100.64460573620696
curr_Factors:  [100.64460574]
mat_Sqrt:  [[0.15]]
grads:  [0.04340463]
Stock Position:  0.04340463429216873
Bond Position:  [-1.33018341]


portfolio before change:  [3.01577115]
curr_Stock_Price:  100.12842571649358
curr_Factors:  [100.12842572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554133]
Stock Position:  -0.005541334135164602
Bond Position:  [3.57061621]


portfolio before change:  [3.01824983]
curr_Stock_Price:  99.7213910491356
curr_Factors:  [99.72139105]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148233]
Stock Position:  -0.014823304722488957
Bond Position:  [4.4964504]


portfolio before change:  [3.0223298]
curr_Stock_Price:  99.46511009416804
curr_Factors:  [99.46511009]
mat_Sqrt:  [[0.15]]
grads:  [-0.01973246]
Stock Position:  -0.019732462155959564
Bond Position:  [4.98502132]


portfolio before change:  [3.03846711]
curr_Stock_Price:  98.66309461002156
curr_Factors:  [98.66309461]
mat_Sqrt:  [[0.15]]
grads:  [-0.07088931]
Stock Position:  -0.07088930873791734
Bond Position:  [10.03262569]


portfolio before change:  [3.01330659]
curr_Stock_Price:  99.02686708147117
curr_Factors:  [99.02686708]
mat_Sqrt:  [[0.15]]
grads:  [-0.03476557]
Stock Position:  -0.03476557055831168
Bond Position:  [6.45603213]


portfolio before change:  [2.9871555]
curr_Stock_Price:  99.79068618805398
curr_Factors:  [99.79068619]
mat_Sqrt:  [[0.15]]
grads:  [0.03167313]
Stock Position:  0.03167312963841338
Bond Position:  [-0.17352784]


portfolio before change:  [2.99627927]
curr_Stock_Price:  100.07908870764432
curr_Factors:  [100.07908871]
mat_Sqrt:  [[0.15]]
grads:  [0.07742386]
Stock Position:  0.07742386040439334
Bond Position:  [-4.75223013]


portfolio before change:  [2.99840105]
curr_Stock_Price:  100.110329842043
curr_Factors:  [100.11032984]
mat_Sqrt:  [[0.15]]
grads:  [0.07840903]
Stock Position:  0.07840903017407674
Bond Position:  [-4.85115282]


portfolio before change:  [2.96084505]
curr_Stock_Price:  99.63522139172963
curr_Factors:  [99.63522139]
mat_Sqrt:  [[0.15]]
grads:  [-0.2341671]
Stock Position:  -0.2341671017664653
Bond Position:  [26.29213608]


portfolio before change:  [3.05298175]
curr_Stock_Price:  99.24877347712503
curr_Factors:  [99.24877348]
mat_Sqrt:  [[0.15]]
grads:  [0.06264551]
Stock Position:  0.06264551243464729
Bond Position:  [-3.16450852]


portfolio before change:  [3.0539542]
curr_Stock_Price:  99.26745381907497
curr_Factors:  [99.26745382]
mat_Sqrt:  [[0.15]]
grads:  [-0.09430316]
Stock Position:  -0.09430315697174663
Bond Position:  [12.41518848]


portfolio before change:  [3.04938794]
curr_Stock_Price:  99.32410338935615
curr_Factors:  [99.32410339]
mat_Sqrt:  [[0.15]]
grads:  [0.16349368]
Stock Position:  0.1634936788295817
Bond Position:  [-13.18947512]


portfolio before change:  [3.09481693]
curr_Stock_Price:  99.60700947315023
curr_Factors:  [99.60700947]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959344]
Stock Position:  -0.039593438247023466
Bond Position:  [7.03860091]


portfolio before change:  [3.10177073]
curr_Stock_Price:  99.44249043866749
curr_Factors:  [99.44249044]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596325]
Stock Position:  -0.025963249645302677
Bond Position:  [5.68362093]


portfolio before change:  [3.10032895]
curr_Stock_Price:  99.51170434138051
curr_Factors:  [99.51170434]
mat_Sqrt:  [[0.15]]
grads:  [0.15598374]
Stock Position:  0.15598374063968778
Bond Position:  [-12.42187893]


portfolio before change:  [2.94570867]
curr_Stock_Price:  98.52542278605547
curr_Factors:  [98.52542279]
mat_Sqrt:  [[0.15]]
grads:  [0.03068147]
Stock Position:  0.030681469910881772
Bond Position:  [-0.07719612]


portfolio before change:  [2.94196679]
curr_Stock_Price:  98.40362108091259
curr_Factors:  [98.40362108]
mat_Sqrt:  [[0.15]]
grads:  [-0.03159685]
Stock Position:  -0.03159685400551813
Bond Position:  [6.05121164]


portfolio before change:  [2.93563763]
curr_Stock_Price:  98.61590096463136
curr_Factors:  [98.61590096]
mat_Sqrt:  [[0.15]]
grads:  [-0.03883124]
Stock Position:  -0.038831239142400865
Bond Position:  [6.76501526]


portfolio before change:  [2.95700921]
curr_Stock_Price:  98.0764190449281
curr_Factors:  [98.07641904]
mat_Sqrt:  [[0.15]]
grads:  [0.00865956]
Stock Position:  0.008659557122491664
Bond Position:  [2.10771085]


portfolio before change:  [2.96626322]
curr_Stock_Price:  99.12985427075576
curr_Factors:  [99.12985427]
mat_Sqrt:  [[0.15]]
grads:  [-0.08241738]
Stock Position:  -0.08241738015779765
Bond Position:  [11.13628611]


portfolio before change:  [2.9445009]
curr_Stock_Price:  99.40234980813386
curr_Factors:  [99.40234981]
mat_Sqrt:  [[0.15]]
grads:  [-0.08212316]
Stock Position:  -0.08212316351055182
Bond Position:  [11.10773632]


portfolio before change:  [2.94845717]
curr_Stock_Price:  99.36262878933731
curr_Factors:  [99.36262879]
mat_Sqrt:  [[0.15]]
grads:  [-0.04032809]
Stock Position:  -0.040328086464533355
Bond Position:  [6.95556185]


portfolio before change:  [2.95894233]
curr_Stock_Price:  99.11341230275191
curr_Factors:  [99.1134123]
mat_Sqrt:  [[0.15]]
grads:  [0.31653754]
Stock Position:  0.3165375412787831
Bond Position:  [-28.41417351]


portfolio before change:  [2.64985255]
curr_Stock_Price:  98.14255166453032
curr_Factors:  [98.14255166]
mat_Sqrt:  [[0.15]]
grads:  [-0.06815213]
Stock Position:  -0.06815212687234884
Bond Position:  [9.33847618]


portfolio before change:  [2.68369916]
curr_Stock_Price:  97.65448264700403
curr_Factors:  [97.65448265]
mat_Sqrt:  [[0.15]]
grads:  [0.01845977]
Stock Position:  0.01845977006444928
Bond Position:  [0.88101987]


portfolio before change:  [2.67412892]
curr_Stock_Price:  97.1330621643941
curr_Factors:  [97.13306216]
mat_Sqrt:  [[0.15]]
grads:  [0.03357057]
Stock Position:  0.03357057062086431
Bond Position:  [-0.5866834]


portfolio before change:  [2.65734869]
curr_Stock_Price:  96.63430480302584
curr_Factors:  [96.6343048]
mat_Sqrt:  [[0.15]]
grads:  [0.02776803]
Stock Position:  0.027768025975216788
Bond Position:  [-0.0259952]


portfolio before change:  [2.67537088]
curr_Stock_Price:  97.28339010091064
curr_Factors:  [97.2833901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00870422]
Stock Position:  -0.008704218294841269
Bond Position:  [3.52214674]


portfolio before change:  [2.67539885]
curr_Stock_Price:  97.30546808117866
curr_Factors:  [97.30546808]
mat_Sqrt:  [[0.15]]
grads:  [0.01849212]
Stock Position:  0.018492115433157076
Bond Position:  [0.8760149]


portfolio before change:  [2.68173664]
curr_Stock_Price:  97.6452363865436
curr_Factors:  [97.64523639]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440742]
Stock Position:  -0.004407420487597151
Bond Position:  [3.11210025]


portfolio before change:  [2.68355142]
curr_Stock_Price:  97.27761306340263
curr_Factors:  [97.27761306]
mat_Sqrt:  [[0.15]]
grads:  [0.0102365]
Stock Position:  0.010236501717836974
Bond Position:  [1.68776897]


portfolio before change:  [2.68973363]
curr_Stock_Price:  97.87124618987201
curr_Factors:  [97.87124619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00559588]
Stock Position:  -0.005595878575696453
Bond Position:  [3.23740924]


portfolio before change:  [2.68747728]
curr_Stock_Price:  98.31062357398288
curr_Factors:  [98.31062357]
mat_Sqrt:  [[0.15]]
grads:  [0.00207432]
Stock Position:  0.0020743162312719145
Bond Position:  [2.48354995]


portfolio before change:  [2.68771507]
curr_Stock_Price:  98.3504297312458
curr_Factors:  [98.35042973]
mat_Sqrt:  [[0.15]]
grads:  [-0.00099482]
Stock Position:  -0.000994823365259856
Bond Position:  [2.78555638]


portfolio before change:  [2.68723148]
curr_Stock_Price:  99.01154881702183
curr_Factors:  [99.01154882]
mat_Sqrt:  [[0.15]]
grads:  [0.00235789]
Stock Position:  0.0023578861793656777
Bond Position:  [2.45377352]


portfolio before change:  [2.6877247]
curr_Stock_Price:  99.15568553048828
curr_Factors:  [99.15568553]
mat_Sqrt:  [[0.15]]
grads:  [-0.11330657]
Stock Position:  -0.1133065723865689
Bond Position:  [13.92271556]


portfolio before change:  [2.69027764]
curr_Stock_Price:  99.1408343323457
curr_Factors:  [99.14083433]
mat_Sqrt:  [[0.15]]
grads:  [-0.09056174]
Stock Position:  -0.09056174199288732
Bond Position:  [11.6686443]


portfolio before change:  [2.68009577]
curr_Stock_Price:  99.26131768857111
curr_Factors:  [99.26131769]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081898]
Stock Position:  -0.0008189772303368592
Bond Position:  [2.76138853]


portfolio before change:  [2.68095602]
curr_Stock_Price:  98.42165803062089
curr_Factors:  [98.42165803]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242989]
Stock Position:  -0.03242989317996144
Bond Position:  [5.87275988]


portfolio before change:  [2.68388739]
curr_Stock_Price:  98.34258563245434
curr_Factors:  [98.34258563]
mat_Sqrt:  [[0.15]]
grads:  [0.13333185]
Stock Position:  0.13333184568974682
Bond Position:  [-10.42831106]


portfolio before change:  [2.69213973]
curr_Stock_Price:  98.40936731951768
curr_Factors:  [98.40936732]
mat_Sqrt:  [[0.15]]
grads:  [-0.06420874]
Stock Position:  -0.0642087377301537
Bond Position:  [9.01088098]


portfolio before change:  [2.6639666]
curr_Stock_Price:  98.8569126757497
curr_Factors:  [98.85691268]
mat_Sqrt:  [[0.15]]
grads:  [0.04116651]
Stock Position:  0.04116650840455683
Bond Position:  [-1.40562732]


portfolio before change:  [2.67570493]
curr_Stock_Price:  99.14418953072943
curr_Factors:  [99.14418953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05363917]
Stock Position:  -0.053639169211711496
Bond Position:  [7.99371689]


portfolio before change:  [2.64863604]
curr_Stock_Price:  99.65815199142648
curr_Factors:  [99.65815199]
mat_Sqrt:  [[0.15]]
grads:  [0.07112098]
Stock Position:  0.07112098380765607
Bond Position:  [-4.43914978]


portfolio before change:  [2.63210665]
curr_Stock_Price:  99.42964096727162
curr_Factors:  [99.42964097]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407461]
Stock Position:  -0.04074609870252865
Bond Position:  [6.68347662]


portfolio before change:  [2.63709677]
curr_Stock_Price:  99.31742435916675
curr_Factors:  [99.31742436]
mat_Sqrt:  [[0.15]]
grads:  [0.06409345]
Stock Position:  0.06409345203506149
Bond Position:  [-3.7284998]


portfolio before change:  [2.58797405]
curr_Stock_Price:  98.55463686273534
curr_Factors:  [98.55463686]
mat_Sqrt:  [[0.15]]
grads:  [-0.11481008]
Stock Position:  -0.11481008013332218
Bond Position:  [13.9030398]


portfolio before change:  [2.49194066]
curr_Stock_Price:  99.39865995601087
curr_Factors:  [99.39865996]
mat_Sqrt:  [[0.15]]
grads:  [-0.02892352]
Stock Position:  -0.028923517805033654
Bond Position:  [5.36689957]


portfolio before change:  [2.48496013]
curr_Stock_Price:  99.6516017626991
curr_Factors:  [99.65160176]
mat_Sqrt:  [[0.15]]
grads:  [-0.03478486]
Stock Position:  -0.03478485600899562
Bond Position:  [5.95132675]


portfolio before change:  [2.47591184]
curr_Stock_Price:  99.92241678953862
curr_Factors:  [99.92241679]
mat_Sqrt:  [[0.15]]
grads:  [-0.01395565]
Stock Position:  -0.013955647398778734
Bond Position:  [3.87039386]


portfolio before change:  [2.48009298]
curr_Stock_Price:  99.6401489611256
curr_Factors:  [99.64014896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48009298]
Stock Price:  99.10941962700485
PL:  [2.48009298]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.75779255e-03]
 [-2.27598021e-03]
 [ 3.89573270e-04]
 [ 7.27153417e-03]
 [ 5.15018347e-03]
 [ 1.82600451e-02]
 [ 1.55573373e-03]
 [-2.22086011e-02]
 [ 3.42513398e-03]
 [-3.62094979e-03]
 [ 1.46455212e-02]
 [-1.78735504e-02]
 [ 3.76251431e-02]
 [ 8.60339209e-03]
 [-6.89921816e-03]
 [ 1.62031246e-02]
 [ 9.95860623e-03]
 [-1.14924264e-02]
 [ 5.81783628e-05]
 [ 8.99234483e-04]
 [ 1.23410848e-02]
 [-4.74896610e-03]
 [ 7.05381111e-03]
 [ 4.91314146e-02]
 [-2.95135820e-03]
 [ 1.14347387e-02]
 [-6.77413773e-03]
 [ 8.06161878e-03]
 [ 1.86336704e-02]
 [-3.16003103e-03]
 [ 4.61492234e-03]
 [-1.21250325e-02]
 [ 6.55799242e-03]
 [ 6.77116666e-03]
 [ 1.17940616e-02]
 [ 1.30574190e-02]
 [-3.52680007e-02]
 [ 9.64155702e-03]
 [-1.23095726e-02]
 [ 2.38794634e-02]
 [-6.22847167e-03]
 [-1.23776940e-02]
 [ 2.33699997e-02]
 [ 3.05317580e-03]
 [-7.72160973e-03]
 [ 1.34043732e-03]
 [ 8.98020546e-03]
 [-9.08515939e-03]
 [-1.14297253e-02]
 [-7.66583559e-03]
 [ 2.13614927e-02]
 [-7.73170513e-03]
 [-1.59305890e-04]
 [ 5.29218033e-03]
 [ 4.49303492e-03]
 [-1.39107210e-03]
 [ 5.08248749e-03]
 [-6.03000495e-04]
 [ 1.63057142e-03]
 [ 1.50396888e-02]
 [-2.35305003e-03]
 [ 1.29732750e-02]
 [ 1.15748746e-03]
 [-1.23890094e-02]
 [-6.42781589e-04]
 [ 9.47692786e-05]
 [-5.44214647e-03]
 [ 1.50604297e-02]
 [-8.25236631e-03]
 [ 8.90584527e-03]
 [-1.11982407e-02]
 [ 1.09532458e-02]
 [-7.85449598e-03]
 [ 1.54296896e-02]
 [-2.08919566e-02]
 [-4.31182845e-03]
 [-8.08662578e-03]
 [-1.75128532e-03]
 [ 1.99926848e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.86664628]
curr_Stock_Price:  99.42074316352972
curr_Factors:  [99.42074316]
mat_Sqrt:  [[0.15]]
grads:  [0.03171862]
Stock Position:  0.03171861697628318
Bond Position:  [-10.02013475]


portfolio before change:  [-6.86396707]
curr_Stock_Price:  99.52495606639887
curr_Factors:  [99.52495607]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151732]
Stock Position:  -0.015173201382057206
Bond Position:  [-5.35385487]


portfolio before change:  [-6.87184365]
curr_Stock_Price:  100.02201366775311
curr_Factors:  [100.02201367]
mat_Sqrt:  [[0.15]]
grads:  [0.00259716]
Stock Position:  0.0025971551362821413
Bond Position:  [-7.13161634]


portfolio before change:  [-6.87206665]
curr_Stock_Price:  100.10777730929368
curr_Factors:  [100.10777731]
mat_Sqrt:  [[0.15]]
grads:  [0.04847689]
Stock Position:  0.048476894481442344
Bond Position:  [-11.72498081]


portfolio before change:  [-6.8913329]
curr_Stock_Price:  99.72546286069839
curr_Factors:  [99.72546286]
mat_Sqrt:  [[0.15]]
grads:  [0.03433456]
Stock Position:  0.03433455648168909
Bond Position:  [-10.31536244]


portfolio before change:  [-6.91508446]
curr_Stock_Price:  99.05247246483049
curr_Factors:  [99.05247246]
mat_Sqrt:  [[0.15]]
grads:  [0.12173363]
Stock Position:  0.12173363395481133
Bond Position:  [-18.97310188]


portfolio before change:  [-6.92821801]
curr_Stock_Price:  98.95432621033524
curr_Factors:  [98.95432621]
mat_Sqrt:  [[0.15]]
grads:  [0.01037156]
Stock Position:  0.010371558200992663
Bond Position:  [-7.95452857]


portfolio before change:  [-6.93380065]
curr_Stock_Price:  98.46399855950486
curr_Factors:  [98.46399856]
mat_Sqrt:  [[0.15]]
grads:  [-0.14805734]
Stock Position:  -0.1480573405925319
Bond Position:  [7.64451712]


portfolio before change:  [-7.01439188]
curr_Stock_Price:  99.01155009900903
curr_Factors:  [99.0115501]
mat_Sqrt:  [[0.15]]
grads:  [0.02283423]
Stock Position:  0.022834226557949984
Bond Position:  [-9.27524404]


portfolio before change:  [-6.98956287]
curr_Stock_Price:  100.12429774568193
curr_Factors:  [100.12429775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413967]
Stock Position:  -0.02413966523488891
Bond Position:  [-4.57259584]


portfolio before change:  [-6.99667262]
curr_Stock_Price:  100.40698431530404
curr_Factors:  [100.40698432]
mat_Sqrt:  [[0.15]]
grads:  [0.09763681]
Stock Position:  0.09763680791441777
Bond Position:  [-16.80009006]


portfolio before change:  [-6.98922135]
curr_Stock_Price:  100.49405502267173
curr_Factors:  [100.49405502]
mat_Sqrt:  [[0.15]]
grads:  [-0.119157]
Stock Position:  -0.1191570027049224
Bond Position:  [4.98534903]


portfolio before change:  [-7.08790476]
curr_Stock_Price:  101.32484967482398
curr_Factors:  [101.32484967]
mat_Sqrt:  [[0.15]]
grads:  [0.25083429]
Stock Position:  0.2508342871066196
Bond Position:  [-32.50365119]


portfolio before change:  [-6.9077362]
curr_Stock_Price:  102.05122604758662
curr_Factors:  [102.05122605]
mat_Sqrt:  [[0.15]]
grads:  [0.05735595]
Stock Position:  0.05735594723886284
Bond Position:  [-12.76098094]


portfolio before change:  [-6.91452759]
curr_Stock_Price:  101.94672419914816
curr_Factors:  [101.9467242]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599479]
Stock Position:  -0.04599478770402147
Bond Position:  [-2.22550965]


portfolio before change:  [-6.85106435]
curr_Stock_Price:  100.56390795667075
curr_Factors:  [100.56390796]
mat_Sqrt:  [[0.15]]
grads:  [0.10802083]
Stock Position:  0.10802083075205939
Bond Position:  [-17.71406123]


portfolio before change:  [-6.83331978]
curr_Stock_Price:  100.73842737223909
curr_Factors:  [100.73842737]
mat_Sqrt:  [[0.15]]
grads:  [0.06639071]
Stock Position:  0.0663907082022523
Bond Position:  [-13.52141532]


portfolio before change:  [-6.80328721]
curr_Stock_Price:  101.20351781988539
curr_Factors:  [101.20351782]
mat_Sqrt:  [[0.15]]
grads:  [-0.07661618]
Stock Position:  -0.07661617572449116
Bond Position:  [0.95053929]


portfolio before change:  [-6.81282212]
curr_Stock_Price:  101.32874362837408
curr_Factors:  [101.32874363]
mat_Sqrt:  [[0.15]]
grads:  [0.00038786]
Stock Position:  0.00038785575204835826
Bond Position:  [-6.85212306]


portfolio before change:  [-6.81340291]
curr_Stock_Price:  100.93551122668109
curr_Factors:  [100.93551123]
mat_Sqrt:  [[0.15]]
grads:  [0.0059949]
Stock Position:  0.005994896550476619
Bond Position:  [-7.41850086]


portfolio before change:  [-6.81327603]
curr_Stock_Price:  101.03402063756394
curr_Factors:  [101.03402064]
mat_Sqrt:  [[0.15]]
grads:  [0.0822739]
Stock Position:  0.08227389865216224
Bond Position:  [-15.1257388]


portfolio before change:  [-6.80837968]
curr_Stock_Price:  101.10502421546806
curr_Factors:  [101.10502422]
mat_Sqrt:  [[0.15]]
grads:  [-0.03165977]
Stock Position:  -0.03165977400842366
Bond Position:  [-3.60741746]


portfolio before change:  [-6.80550283]
curr_Stock_Price:  101.0070348613239
curr_Factors:  [101.00703486]
mat_Sqrt:  [[0.15]]
grads:  [0.04702541]
Stock Position:  0.047025407388347755
Bond Position:  [-11.55539979]


portfolio before change:  [-6.84224401]
curr_Stock_Price:  100.24108822016791
curr_Factors:  [100.24108822]
mat_Sqrt:  [[0.15]]
grads:  [0.32754276]
Stock Position:  0.32754276385875214
Bond Position:  [-39.6754871]


portfolio before change:  [-6.92480975]
curr_Stock_Price:  99.99658291905388
curr_Factors:  [99.99658292]
mat_Sqrt:  [[0.15]]
grads:  [-0.01967572]
Stock Position:  -0.019675721318211492
Bond Position:  [-4.95730485]


portfolio before change:  [-6.92494657]
curr_Stock_Price:  99.9877892685549
curr_Factors:  [99.98778927]
mat_Sqrt:  [[0.15]]
grads:  [0.07623159]
Stock Position:  0.07623159135508732
Bond Position:  [-14.54717486]


portfolio before change:  [-6.89307306]
curr_Stock_Price:  100.41783060458984
curr_Factors:  [100.4178306]
mat_Sqrt:  [[0.15]]
grads:  [-0.04516092]
Stock Position:  -0.04516091817815923
Bond Position:  [-2.35811163]


portfolio before change:  [-6.9341584]
curr_Stock_Price:  101.32432124293744
curr_Factors:  [101.32432124]
mat_Sqrt:  [[0.15]]
grads:  [0.05374413]
Stock Position:  0.0537441251719546
Bond Position:  [-12.3797454]


portfolio before change:  [-6.92793329]
curr_Stock_Price:  101.45454697702084
curr_Factors:  [101.45454698]
mat_Sqrt:  [[0.15]]
grads:  [0.12422447]
Stock Position:  0.1242244696044619
Bond Position:  [-19.53107058]


portfolio before change:  [-7.01512898]
curr_Stock_Price:  100.76245335000115
curr_Factors:  [100.76245335]
mat_Sqrt:  [[0.15]]
grads:  [-0.02106687]
Stock Position:  -0.021066873506488375
Bond Position:  [-4.89237912]


portfolio before change:  [-7.00565827]
curr_Stock_Price:  100.29838372869109
curr_Factors:  [100.29838373]
mat_Sqrt:  [[0.15]]
grads:  [0.03076615]
Stock Position:  0.03076614890569561
Bond Position:  [-10.09145328]


portfolio before change:  [-6.9973313]
curr_Stock_Price:  100.58953817134025
curr_Factors:  [100.58953817]
mat_Sqrt:  [[0.15]]
grads:  [-0.08083355]
Stock Position:  -0.08083354973404852
Bond Position:  [1.13367813]


portfolio before change:  [-6.99883851]
curr_Stock_Price:  100.60906048175528
curr_Factors:  [100.60906048]
mat_Sqrt:  [[0.15]]
grads:  [0.04371995]
Stock Position:  0.04371994949925341
Bond Position:  [-11.39746155]


portfolio before change:  [-7.00113077]
curr_Stock_Price:  100.57292352753751
curr_Factors:  [100.57292353]
mat_Sqrt:  [[0.15]]
grads:  [0.04514111]
Stock Position:  0.04514111108259956
Bond Position:  [-11.54110429]


portfolio before change:  [-7.03758966]
curr_Stock_Price:  99.78123843592428
curr_Factors:  [99.78123844]
mat_Sqrt:  [[0.15]]
grads:  [0.07862708]
Stock Position:  0.07862707738901409
Bond Position:  [-14.88309682]


portfolio before change:  [-7.03634232]
curr_Stock_Price:  99.80893327504015
curr_Factors:  [99.80893328]
mat_Sqrt:  [[0.15]]
grads:  [0.08704946]
Stock Position:  0.08704945999577769
Bond Position:  [-15.72465606]


portfolio before change:  [-7.06338937]
curr_Stock_Price:  99.50951469997506
curr_Factors:  [99.5095147]
mat_Sqrt:  [[0.15]]
grads:  [-0.23512]
Stock Position:  -0.23512000472842146
Bond Position:  [16.3332882]


portfolio before change:  [-7.15568039]
curr_Stock_Price:  99.90638390069125
curr_Factors:  [99.9063839]
mat_Sqrt:  [[0.15]]
grads:  [0.06427705]
Stock Position:  0.06427704683271793
Bond Position:  [-13.57736771]


portfolio before change:  [-7.16873853]
curr_Stock_Price:  99.71643229532876
curr_Factors:  [99.7164323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08206382]
Stock Position:  -0.08206381712059219
Bond Position:  [1.01437253]


portfolio before change:  [-7.20385479]
curr_Stock_Price:  100.14511885285012
curr_Factors:  [100.14511885]
mat_Sqrt:  [[0.15]]
grads:  [0.15919642]
Stock Position:  0.15919642278767462
Bond Position:  [-23.14659947]


portfolio before change:  [-7.17065761]
curr_Stock_Price:  100.36273609494488
curr_Factors:  [100.36273609]
mat_Sqrt:  [[0.15]]
grads:  [-0.04152314]
Stock Position:  -0.041523144478073995
Bond Position:  [-3.00328122]


portfolio before change:  [-7.16208778]
curr_Stock_Price:  100.15182871543946
curr_Factors:  [100.15182872]
mat_Sqrt:  [[0.15]]
grads:  [-0.08251796]
Stock Position:  -0.08251796031578179
Bond Position:  [1.10223685]


portfolio before change:  [-7.18067274]
curr_Stock_Price:  100.37788672851363
curr_Factors:  [100.37788673]
mat_Sqrt:  [[0.15]]
grads:  [0.1558]
Stock Position:  0.1557999982030026
Bond Position:  [-22.81954731]


portfolio before change:  [-7.12258912]
curr_Stock_Price:  100.75985006256343
curr_Factors:  [100.75985006]
mat_Sqrt:  [[0.15]]
grads:  [0.02035451]
Stock Position:  0.020354505314806787
Bond Position:  [-9.17350602]


portfolio before change:  [-7.12810564]
curr_Stock_Price:  100.51699669104065
curr_Factors:  [100.51699669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514774]
Stock Position:  -0.05147739821754113
Bond Position:  [-1.95375217]


portfolio before change:  [-7.13038507]
curr_Stock_Price:  100.55890480071257
curr_Factors:  [100.5589048]
mat_Sqrt:  [[0.15]]
grads:  [0.00893625]
Stock Position:  0.008936248789056963
Bond Position:  [-8.02900446]


portfolio before change:  [-7.13045939]
curr_Stock_Price:  100.60674519674959
curr_Factors:  [100.6067452]
mat_Sqrt:  [[0.15]]
grads:  [0.05986804]
Stock Position:  0.059868036424254846
Bond Position:  [-13.15358767]


portfolio before change:  [-7.12648921]
curr_Stock_Price:  100.68679296128776
curr_Factors:  [100.68679296]
mat_Sqrt:  [[0.15]]
grads:  [-0.06056773]
Stock Position:  -0.060567729233638276
Bond Position:  [-1.0281188]


portfolio before change:  [-7.13157395]
curr_Stock_Price:  100.76968340748523
curr_Factors:  [100.76968341]
mat_Sqrt:  [[0.15]]
grads:  [-0.07619817]
Stock Position:  -0.07619816844489945
Bond Position:  [0.54689136]


portfolio before change:  [-7.12402978]
curr_Stock_Price:  100.67112471815993
curr_Factors:  [100.67112472]
mat_Sqrt:  [[0.15]]
grads:  [-0.05110557]
Stock Position:  -0.05110557059345224
Bond Position:  [-1.97917451]


portfolio before change:  [-7.136689]
curr_Stock_Price:  100.91641146151373
curr_Factors:  [100.91641146]
mat_Sqrt:  [[0.15]]
grads:  [0.14240995]
Stock Position:  0.14240995134970927
Bond Position:  [-21.50819025]


portfolio before change:  [-7.16439158]
curr_Stock_Price:  100.73132413683335
curr_Factors:  [100.73132414]
mat_Sqrt:  [[0.15]]
grads:  [-0.0515447]
Stock Position:  -0.05154470085574881
Bond Position:  [-1.97222561]


portfolio before change:  [-7.16810586]
curr_Stock_Price:  100.80099196272485
curr_Factors:  [100.80099196]
mat_Sqrt:  [[0.15]]
grads:  [-0.00106204]
Stock Position:  -0.0010620392679764445
Bond Position:  [-7.06105125]


portfolio before change:  [-7.16891799]
curr_Stock_Price:  101.15013198271409
curr_Factors:  [101.15013198]
mat_Sqrt:  [[0.15]]
grads:  [0.0352812]
Stock Position:  0.03528120220387025
Bond Position:  [-10.73761625]


portfolio before change:  [-7.17758503]
curr_Stock_Price:  100.92349794096415
curr_Factors:  [100.92349794]
mat_Sqrt:  [[0.15]]
grads:  [0.02995357]
Stock Position:  0.02995356616513544
Bond Position:  [-10.2006037]


portfolio before change:  [-7.17072889]
curr_Stock_Price:  101.1736751218229
curr_Factors:  [101.17367512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927381]
Stock Position:  -0.009273813976715187
Bond Position:  [-6.23246305]


portfolio before change:  [-7.17070089]
curr_Stock_Price:  101.12865128321691
curr_Factors:  [101.12865128]
mat_Sqrt:  [[0.15]]
grads:  [0.03388325]
Stock Position:  0.03388324993194239
Bond Position:  [-10.59726826]


portfolio before change:  [-7.15973106]
curr_Stock_Price:  101.47195300596611
curr_Factors:  [101.47195301]
mat_Sqrt:  [[0.15]]
grads:  [-0.00402]
Stock Position:  -0.004020003300656324
Bond Position:  [-6.75181347]


portfolio before change:  [-7.1620928]
curr_Stock_Price:  101.9544733581976
curr_Factors:  [101.95447336]
mat_Sqrt:  [[0.15]]
grads:  [0.01087048]
Stock Position:  0.010870476152299186
Bond Position:  [-8.27038647]


portfolio before change:  [-7.16328166]
curr_Stock_Price:  101.89265953198813
curr_Factors:  [101.89265953]
mat_Sqrt:  [[0.15]]
grads:  [0.10026459]
Stock Position:  0.10026459188840192
Bond Position:  [-17.37950758]


portfolio before change:  [-7.08396533]
curr_Stock_Price:  102.69456354309821
curr_Factors:  [102.69456354]
mat_Sqrt:  [[0.15]]
grads:  [-0.015687]
Stock Position:  -0.015687000192298614
Bond Position:  [-5.47299569]


portfolio before change:  [-7.08279793]
curr_Stock_Price:  102.5983390742332
curr_Factors:  [102.59833907]
mat_Sqrt:  [[0.15]]
grads:  [0.0864885]
Stock Position:  0.08648849987545143
Bond Position:  [-15.95637437]


portfolio before change:  [-7.05851804]
curr_Stock_Price:  102.89059989638018
curr_Factors:  [102.8905999]
mat_Sqrt:  [[0.15]]
grads:  [0.00771658]
Stock Position:  0.007716583093876553
Bond Position:  [-7.8524819]


portfolio before change:  [-7.06006149]
curr_Stock_Price:  102.75418415055258
curr_Factors:  [102.75418415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0825934]
Stock Position:  -0.08259339621589619
Bond Position:  [1.42675555]


portfolio before change:  [-7.00772626]
curr_Stock_Price:  102.12161467045316
curr_Factors:  [102.12161467]
mat_Sqrt:  [[0.15]]
grads:  [-0.00428521]
Stock Position:  -0.004285210591169486
Bond Position:  [-6.57011363]


portfolio before change:  [-7.0068479]
curr_Stock_Price:  101.82081131040997
curr_Factors:  [101.82081131]
mat_Sqrt:  [[0.15]]
grads:  [0.0006318]
Stock Position:  0.0006317951907261246
Bond Position:  [-7.0711778]


portfolio before change:  [-7.00706545]
curr_Stock_Price:  102.17600347960234
curr_Factors:  [102.17600348]
mat_Sqrt:  [[0.15]]
grads:  [-0.03628098]
Stock Position:  -0.03628097645202426
Bond Position:  [-3.30002027]


portfolio before change:  [-7.00995582]
curr_Stock_Price:  102.24998468726794
curr_Factors:  [102.24998469]
mat_Sqrt:  [[0.15]]
grads:  [0.10040286]
Stock Position:  0.10040286454407103
Bond Position:  [-17.27614718]


portfolio before change:  [-7.10688523]
curr_Stock_Price:  101.29533448012444
curr_Factors:  [101.29533448]
mat_Sqrt:  [[0.15]]
grads:  [-0.05501578]
Stock Position:  -0.05501577541150677
Bond Position:  [-1.53404386]


portfolio before change:  [-7.0934553]
curr_Stock_Price:  101.04948118433512
curr_Factors:  [101.04948118]
mat_Sqrt:  [[0.15]]
grads:  [0.0593723]
Stock Position:  0.05937230181362022
Bond Position:  [-13.09299559]


portfolio before change:  [-7.08100896]
curr_Stock_Price:  101.27289637470493
curr_Factors:  [101.27289637]
mat_Sqrt:  [[0.15]]
grads:  [-0.07465494]
Stock Position:  -0.07465493787662222
Bond Position:  [0.47951283]


portfolio before change:  [-7.01629849]
curr_Stock_Price:  100.4065035798183
curr_Factors:  [100.40650358]
mat_Sqrt:  [[0.15]]
grads:  [0.07302164]
Stock Position:  0.07302163860327401
Bond Position:  [-14.34814591]


portfolio before change:  [-7.03599731]
curr_Stock_Price:  100.14901777863726
curr_Factors:  [100.14901778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05236331]
Stock Position:  -0.05236330650947512
Bond Position:  [-1.7918636]


portfolio before change:  [-7.04868085]
curr_Stock_Price:  100.38910073521873
curr_Factors:  [100.38910074]
mat_Sqrt:  [[0.15]]
grads:  [0.1028646]
Stock Position:  0.10286459725302323
Bond Position:  [-17.37516526]


portfolio before change:  [-7.10447107]
curr_Stock_Price:  99.85729245773824
curr_Factors:  [99.85729246]
mat_Sqrt:  [[0.15]]
grads:  [-0.13927971]
Stock Position:  -0.13927971090074143
Bond Position:  [6.80362375]


portfolio before change:  [-7.22906521]
curr_Stock_Price:  100.7549061914833
curr_Factors:  [100.75490619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02874552]
Stock Position:  -0.02874552300926679
Bond Position:  [-4.33281274]


portfolio before change:  [-7.22297502]
curr_Stock_Price:  100.53361930589524
curr_Factors:  [100.53361931]
mat_Sqrt:  [[0.15]]
grads:  [-0.05391084]
Stock Position:  -0.05391083851576555
Bond Position:  [-1.8031233]


portfolio before change:  [-7.21496655]
curr_Stock_Price:  100.38297867694199
curr_Factors:  [100.38297868]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167524]
Stock Position:  -0.011675235474377953
Bond Position:  [-6.04297164]


portfolio before change:  [-7.21130235]
curr_Stock_Price:  100.03678425980245
curr_Factors:  [100.03678426]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.21130235]
Stock Price:  100.34925440235234
PL:  [-7.56055675]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-1.69816561e-04]
 [-4.55363043e-04]
 [ 1.34633261e-04]
 [ 8.50948907e-03]
 [ 4.81880462e-03]
 [ 2.29643319e-02]
 [ 7.44796388e-04]
 [-1.95019682e-02]
 [ 1.43195613e-03]
 [ 1.07231774e-02]
 [-7.93054498e-03]
 [ 6.82310274e-03]
 [ 2.52865732e-03]
 [ 1.38995693e-03]
 [-6.91342414e-03]
 [ 1.92010969e-02]
 [ 1.04134372e-02]
 [-1.14835603e-02]
 [-4.04747626e-04]
 [-5.52885347e-03]
 [ 1.32805078e-02]
 [-3.70620372e-03]
 [ 1.01701727e-02]
 [-1.14682941e-02]
 [ 1.98471203e-03]
 [ 7.43246116e-03]
 [-5.30093569e-03]
 [ 1.00266053e-02]
 [ 3.53244086e-02]
 [-7.48498410e-04]
 [ 1.23405575e-02]
 [-1.17469154e-02]
 [ 9.46778774e-03]
 [ 8.13330254e-03]
 [ 1.14364562e-02]
 [ 9.73368385e-03]
 [-3.43796847e-02]
 [ 9.75105517e-03]
 [-7.83883219e-03]
 [ 2.47093842e-02]
 [-6.35201223e-03]
 [-6.06241627e-03]
 [ 2.36345034e-02]
 [ 4.03361142e-03]
 [-8.17583679e-03]
 [-2.24654691e-03]
 [ 2.77313177e-03]
 [-1.23112621e-02]
 [-1.49952066e-02]
 [-6.35974542e-03]
 [ 4.69350913e-02]
 [-7.90748975e-03]
 [ 2.43887366e-03]
 [ 5.28676151e-03]
 [ 3.42968981e-03]
 [-1.00991444e-03]
 [ 8.90627370e-03]
 [-4.18352134e-05]
 [ 1.69383498e-03]
 [ 1.65742372e-02]
 [-8.80461990e-04]
 [ 1.63644090e-02]
 [-1.54464737e-03]
 [-1.24955157e-02]
 [-3.33527495e-03]
 [ 1.84027111e-04]
 [-5.43672112e-03]
 [ 1.57787090e-02]
 [-8.27281056e-03]
 [ 1.00852461e-02]
 [-1.32632832e-02]
 [ 1.26950539e-02]
 [ 4.89430319e-04]
 [ 2.10773201e-02]
 [-2.24799695e-02]
 [-2.94964296e-03]
 [-1.03937971e-02]
 [-3.23474910e-03]
 [ 2.88691033e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.92428138]
curr_Stock_Price:  101.2278470924551
curr_Factors:  [101.22784709]
mat_Sqrt:  [[0.15]]
grads:  [-0.00113211]
Stock Position:  -0.0011321104036753158
Bond Position:  [21.03888248]


portfolio before change:  [20.92579473]
curr_Stock_Price:  101.05262248500766
curr_Factors:  [101.05262249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00303575]
Stock Position:  -0.0030357536209734987
Bond Position:  [21.23256559]


portfolio before change:  [20.92994727]
curr_Stock_Price:  100.12189328939053
curr_Factors:  [100.12189329]
mat_Sqrt:  [[0.15]]
grads:  [0.00089756]
Stock Position:  0.0008975550728323723
Bond Position:  [20.84008236]


portfolio before change:  [20.93071193]
curr_Stock_Price:  99.52261214750575
curr_Factors:  [99.52261215]
mat_Sqrt:  [[0.15]]
grads:  [0.05672993]
Stock Position:  0.05672992714620555
Bond Position:  [15.28480139]


portfolio before change:  [20.95827188]
curr_Stock_Price:  99.99158202217247
curr_Factors:  [99.99158202]
mat_Sqrt:  [[0.15]]
grads:  [0.03212536]
Stock Position:  0.03212536412405354
Bond Position:  [17.7460059]


portfolio before change:  [20.95327685]
curr_Stock_Price:  99.80157038380017
curr_Factors:  [99.80157038]
mat_Sqrt:  [[0.15]]
grads:  [0.15309555]
Stock Position:  0.15309554583178409
Bond Position:  [5.67410096]


portfolio before change:  [20.9537479]
curr_Stock_Price:  99.80233070694551
curr_Factors:  [99.80233071]
mat_Sqrt:  [[0.15]]
grads:  [0.00496531]
Stock Position:  0.004965309255190137
Bond Position:  [20.45819846]


portfolio before change:  [20.95018904]
curr_Stock_Price:  98.82806364759603
curr_Factors:  [98.82806365]
mat_Sqrt:  [[0.15]]
grads:  [-0.13001312]
Stock Position:  -0.13001312128713866
Bond Position:  [33.79913406]


portfolio before change:  [20.94453722]
curr_Stock_Price:  98.88778318846906
curr_Factors:  [98.88778319]
mat_Sqrt:  [[0.15]]
grads:  [0.00954637]
Stock Position:  0.009546374223275932
Bond Position:  [20.00051744]


portfolio before change:  [20.95196892]
curr_Stock_Price:  99.53531902114196
curr_Factors:  [99.53531902]
mat_Sqrt:  [[0.15]]
grads:  [0.07148785]
Stock Position:  0.0714878492911407
Bond Position:  [13.83640303]


portfolio before change:  [20.87326806]
curr_Stock_Price:  98.42232350847381
curr_Factors:  [98.42232351]
mat_Sqrt:  [[0.15]]
grads:  [-0.0528703]
Stock Position:  -0.05287029987002594
Bond Position:  [26.07688582]


portfolio before change:  [20.81747727]
curr_Stock_Price:  99.50838982680763
curr_Factors:  [99.50838983]
mat_Sqrt:  [[0.15]]
grads:  [0.04548735]
Stock Position:  0.04548735163034901
Bond Position:  [16.29110415]


portfolio before change:  [20.85494545]
curr_Stock_Price:  100.30971053865385
curr_Factors:  [100.30971054]
mat_Sqrt:  [[0.15]]
grads:  [0.01685772]
Stock Position:  0.01685771546427156
Bond Position:  [19.16395289]


portfolio before change:  [20.85851747]
curr_Stock_Price:  100.45055021646772
curr_Factors:  [100.45055022]
mat_Sqrt:  [[0.15]]
grads:  [0.00926638]
Stock Position:  0.009266379558938168
Bond Position:  [19.92770454]


portfolio before change:  [20.8625332]
curr_Stock_Price:  100.74950309944155
curr_Factors:  [100.7495031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04608949]
Stock Position:  -0.04608949426079293
Bond Position:  [25.50602685]


portfolio before change:  [20.85097838]
curr_Stock_Price:  101.0347957309245
curr_Factors:  [101.03479573]
mat_Sqrt:  [[0.15]]
grads:  [0.12800731]
Stock Position:  0.12800731279553704
Bond Position:  [7.91778568]


portfolio before change:  [20.83694975]
curr_Stock_Price:  100.92133727312554
curr_Factors:  [100.92133727]
mat_Sqrt:  [[0.15]]
grads:  [0.06942291]
Stock Position:  0.06942291475566247
Bond Position:  [13.83069635]


portfolio before change:  [20.82853744]
curr_Stock_Price:  100.78771061609318
curr_Factors:  [100.78771062]
mat_Sqrt:  [[0.15]]
grads:  [-0.07655707]
Stock Position:  -0.07655706874430022
Bond Position:  [28.54454913]


portfolio before change:  [20.84527155]
curr_Stock_Price:  100.59243128397793
curr_Factors:  [100.59243128]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269832]
Stock Position:  -0.002698317509437758
Bond Position:  [21.11670186]


portfolio before change:  [20.84430875]
curr_Stock_Price:  101.43837875611662
curr_Factors:  [101.43837876]
mat_Sqrt:  [[0.15]]
grads:  [-0.03685902]
Stock Position:  -0.03685902312607786
Bond Position:  [24.58322829]


portfolio before change:  [20.84263531]
curr_Stock_Price:  101.5254655692908
curr_Factors:  [101.52546557]
mat_Sqrt:  [[0.15]]
grads:  [0.08853672]
Stock Position:  0.08853671877391736
Bond Position:  [11.85390372]


portfolio before change:  [20.83727258]
curr_Stock_Price:  101.45652667036775
curr_Factors:  [101.45652667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02470802]
Stock Position:  -0.02470802476810295
Bond Position:  [23.34406295]


portfolio before change:  [20.83208025]
curr_Stock_Price:  101.72572577764933
curr_Factors:  [101.72572578]
mat_Sqrt:  [[0.15]]
grads:  [0.06780115]
Stock Position:  0.06780115126539776
Bond Position:  [13.93495893]


portfolio before change:  [20.88160831]
curr_Stock_Price:  102.4433699182204
curr_Factors:  [102.44336992]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645529]
Stock Position:  -0.07645529401167066
Bond Position:  [28.71394628]


portfolio before change:  [20.9358503]
curr_Stock_Price:  101.7573833034229
curr_Factors:  [101.7573833]
mat_Sqrt:  [[0.15]]
grads:  [0.01323141]
Stock Position:  0.013231413531350489
Bond Position:  [19.58945628]


portfolio before change:  [20.95086497]
curr_Stock_Price:  102.79962233788316
curr_Factors:  [102.79962234]
mat_Sqrt:  [[0.15]]
grads:  [0.04954974]
Stock Position:  0.0495497410490088
Bond Position:  [15.85717031]


portfolio before change:  [20.95050429]
curr_Stock_Price:  102.77234096316884
curr_Factors:  [102.77234096]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533957]
Stock Position:  -0.03533957123817413
Bond Position:  [24.58243476]


portfolio before change:  [20.9703162]
curr_Stock_Price:  102.25520221780488
curr_Factors:  [102.25520222]
mat_Sqrt:  [[0.15]]
grads:  [0.06684404]
Stock Position:  0.06684403531468486
Bond Position:  [14.13516585]


portfolio before change:  [20.98133776]
curr_Stock_Price:  102.40686996079226
curr_Factors:  [102.40686996]
mat_Sqrt:  [[0.15]]
grads:  [0.23549606]
Stock Position:  0.23549605735040763
Bond Position:  [-3.13507636]


portfolio before change:  [20.90353865]
curr_Stock_Price:  102.07733934393896
curr_Factors:  [102.07733934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498999]
Stock Position:  -0.004989989397555113
Bond Position:  [21.41290349]


portfolio before change:  [20.90577369]
curr_Stock_Price:  101.89764246627027
curr_Factors:  [101.89764247]
mat_Sqrt:  [[0.15]]
grads:  [0.08227038]
Stock Position:  0.08227038343685744
Bond Position:  [12.52261557]


portfolio before change:  [20.86887997]
curr_Stock_Price:  101.43968421734075
curr_Factors:  [101.43968422]
mat_Sqrt:  [[0.15]]
grads:  [-0.07831277]
Stock Position:  -0.0783127692968019
Bond Position:  [28.81290256]


portfolio before change:  [20.88361011]
curr_Stock_Price:  101.27458635355904
curr_Factors:  [101.27458635]
mat_Sqrt:  [[0.15]]
grads:  [0.06311858]
Stock Position:  0.06311858491024692
Bond Position:  [14.49130153]


portfolio before change:  [20.90715925]
curr_Stock_Price:  101.63333021124328
curr_Factors:  [101.63333021]
mat_Sqrt:  [[0.15]]
grads:  [0.05422202]
Stock Position:  0.05422201694447448
Bond Position:  [15.39639509]


portfolio before change:  [20.88089971]
curr_Stock_Price:  101.13128614443922
curr_Factors:  [101.13128614]
mat_Sqrt:  [[0.15]]
grads:  [0.07624304]
Stock Position:  0.07624304102687561
Bond Position:  [13.17034291]


portfolio before change:  [20.8490849]
curr_Stock_Price:  100.70320802312402
curr_Factors:  [100.70320802]
mat_Sqrt:  [[0.15]]
grads:  [0.06489123]
Stock Position:  0.0648912256564879
Bond Position:  [14.31433031]


portfolio before change:  [20.83139607]
curr_Stock_Price:  100.41682861722995
curr_Factors:  [100.41682862]
mat_Sqrt:  [[0.15]]
grads:  [-0.2291979]
Stock Position:  -0.22919789776393887
Bond Position:  [43.84672209]


portfolio before change:  [20.76216694]
curr_Stock_Price:  100.73083511005714
curr_Factors:  [100.73083511]
mat_Sqrt:  [[0.15]]
grads:  [0.06500703]
Stock Position:  0.06500703445980766
Bond Position:  [14.21395408]


portfolio before change:  [20.72393825]
curr_Stock_Price:  100.1290987322083
curr_Factors:  [100.12909873]
mat_Sqrt:  [[0.15]]
grads:  [-0.05225888]
Stock Position:  -0.052258881281254714
Bond Position:  [25.95657293]


portfolio before change:  [20.74734559]
curr_Stock_Price:  99.71223157613278
curr_Factors:  [99.71223158]
mat_Sqrt:  [[0.15]]
grads:  [0.16472923]
Stock Position:  0.16472922808250853
Bond Position:  [4.32182666]


portfolio before change:  [20.83561328]
curr_Stock_Price:  100.2464267452936
curr_Factors:  [100.24642675]
mat_Sqrt:  [[0.15]]
grads:  [-0.04234675]
Stock Position:  -0.04234674817357131
Bond Position:  [25.08072346]


portfolio before change:  [20.86374811]
curr_Stock_Price:  99.61905290250789
curr_Factors:  [99.6190529]
mat_Sqrt:  [[0.15]]
grads:  [-0.04041611]
Stock Position:  -0.04041610846067842
Bond Position:  [24.88996256]


portfolio before change:  [20.85343094]
curr_Stock_Price:  99.91281803431491
curr_Factors:  [99.91281803]
mat_Sqrt:  [[0.15]]
grads:  [0.15756336]
Stock Position:  0.1575633557422582
Bond Position:  [5.11083205]


portfolio before change:  [20.81177828]
curr_Stock_Price:  99.64643566040759
curr_Factors:  [99.64643566]
mat_Sqrt:  [[0.15]]
grads:  [0.02689074]
Stock Position:  0.026890742811639407
Bond Position:  [18.1322116]


portfolio before change:  [20.8125025]
curr_Stock_Price:  99.63122334082128
curr_Factors:  [99.63122334]
mat_Sqrt:  [[0.15]]
grads:  [-0.05450558]
Stock Position:  -0.05450557859509526
Bond Position:  [26.24295998]


portfolio before change:  [20.78870445]
curr_Stock_Price:  100.09793314150478
curr_Factors:  [100.09793314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01497698]
Stock Position:  -0.014976979397528442
Bond Position:  [22.28786913]


portfolio before change:  [20.79792314]
curr_Stock_Price:  99.5754213667574
curr_Factors:  [99.57542137]
mat_Sqrt:  [[0.15]]
grads:  [0.01848755]
Stock Position:  0.018487545158083325
Bond Position:  [18.95701804]


portfolio before change:  [20.80204836]
curr_Stock_Price:  99.73446765983576
curr_Factors:  [99.73446766]
mat_Sqrt:  [[0.15]]
grads:  [-0.08207508]
Stock Position:  -0.08207508047790293
Bond Position:  [28.98776282]


portfolio before change:  [20.78732015]
curr_Stock_Price:  99.93599048017785
curr_Factors:  [99.93599048]
mat_Sqrt:  [[0.15]]
grads:  [-0.09996804]
Stock Position:  -0.09996804388782328
Bond Position:  [30.77772563]


portfolio before change:  [20.80653229]
curr_Stock_Price:  99.76305052221532
curr_Factors:  [99.76305052]
mat_Sqrt:  [[0.15]]
grads:  [-0.0423983]
Stock Position:  -0.04239830282260551
Bond Position:  [25.03631632]


portfolio before change:  [20.8037616]
curr_Stock_Price:  99.86530713816323
curr_Factors:  [99.86530714]
mat_Sqrt:  [[0.15]]
grads:  [0.31290061]
Stock Position:  0.31290060876866244
Bond Position:  [-10.4441538]


portfolio before change:  [21.04768801]
curr_Stock_Price:  100.64695851003997
curr_Factors:  [100.64695851]
mat_Sqrt:  [[0.15]]
grads:  [-0.0527166]
Stock Position:  -0.05271659835356634
Bond Position:  [26.3534533]


portfolio before change:  [21.08165498]
curr_Stock_Price:  100.03387212954287
curr_Factors:  [100.03387213]
mat_Sqrt:  [[0.15]]
grads:  [0.01625916]
Stock Position:  0.016259157706529914
Bond Position:  [19.45518848]


portfolio before change:  [21.10055692]
curr_Stock_Price:  101.12162523457808
curr_Factors:  [101.12162523]
mat_Sqrt:  [[0.15]]
grads:  [0.03524508]
Stock Position:  0.03524507671201854
Bond Position:  [17.53651748]


portfolio before change:  [21.117385]
curr_Stock_Price:  101.56798580006821
curr_Factors:  [101.5679858]
mat_Sqrt:  [[0.15]]
grads:  [0.0228646]
Stock Position:  0.022864598758043586
Bond Position:  [18.79507376]


portfolio before change:  [21.12298053]
curr_Stock_Price:  101.76133284795841
curr_Factors:  [101.76133285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673276]
Stock Position:  -0.006732762957261362
Bond Position:  [21.80811546]


portfolio before change:  [21.12233335]
curr_Stock_Price:  102.05990721556036
curr_Factors:  [102.05990722]
mat_Sqrt:  [[0.15]]
grads:  [0.05937516]
Stock Position:  0.05937515800120845
Bond Position:  [15.06251023]


portfolio before change:  [21.19111912]
curr_Stock_Price:  103.20254562620657
curr_Factors:  [103.20254563]
mat_Sqrt:  [[0.15]]
grads:  [-0.0002789]
Stock Position:  -0.0002789014223374413
Bond Position:  [21.21990246]


portfolio before change:  [21.19253063]
curr_Stock_Price:  102.89698945657743
curr_Factors:  [102.89698946]
mat_Sqrt:  [[0.15]]
grads:  [0.01129223]
Stock Position:  0.011292233209949903
Bond Position:  [20.03059382]


portfolio before change:  [21.19381567]
curr_Stock_Price:  102.89992007042149
curr_Factors:  [102.89992007]
mat_Sqrt:  [[0.15]]
grads:  [0.11049491]
Stock Position:  0.11049491481676837
Bond Position:  [9.82389777]


portfolio before change:  [21.22137217]
curr_Stock_Price:  103.14375473794749
curr_Factors:  [103.14375474]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586975]
Stock Position:  -0.005869746599352349
Bond Position:  [21.82679988]


portfolio before change:  [21.22319506]
curr_Stock_Price:  103.06561377515075
curr_Factors:  [103.06561378]
mat_Sqrt:  [[0.15]]
grads:  [0.10909606]
Stock Position:  0.10909605998732237
Bond Position:  [9.97914268]


portfolio before change:  [21.13703217]
curr_Stock_Price:  102.27010744060017
curr_Factors:  [102.27010744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01029765]
Stock Position:  -0.010297649127266433
Bond Position:  [22.19017385]


portfolio before change:  [21.14178434]
curr_Stock_Price:  101.9433106900082
curr_Factors:  [101.94331069]
mat_Sqrt:  [[0.15]]
grads:  [-0.08330344]
Stock Position:  -0.08330343833120908
Bond Position:  [29.63401263]


portfolio before change:  [21.17105475]
curr_Stock_Price:  101.61417379365622
curr_Factors:  [101.61417379]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223517]
Stock Position:  -0.02223516636257981
Bond Position:  [23.43046281]


portfolio before change:  [21.16636478]
curr_Stock_Price:  101.89096166859838
curr_Factors:  [101.89096167]
mat_Sqrt:  [[0.15]]
grads:  [0.00122685]
Stock Position:  0.0012268474051470072
Bond Position:  [21.04136012]


portfolio before change:  [21.16838901]
curr_Stock_Price:  102.46895015159994
curr_Factors:  [102.46895015]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624481]
Stock Position:  -0.03624480747786507
Bond Position:  [24.88235638]


portfolio before change:  [21.19357838]
curr_Stock_Price:  101.81687959166209
curr_Factors:  [101.81687959]
mat_Sqrt:  [[0.15]]
grads:  [0.10519139]
Stock Position:  0.10519139333958974
Bond Position:  [10.48331895]


portfolio before change:  [21.25222164]
curr_Stock_Price:  102.36814178825426
curr_Factors:  [102.36814179]
mat_Sqrt:  [[0.15]]
grads:  [-0.05515207]
Stock Position:  -0.05515207042055818
Bond Position:  [26.89803661]


portfolio before change:  [21.23133271]
curr_Stock_Price:  102.77737608712066
curr_Factors:  [102.77737609]
mat_Sqrt:  [[0.15]]
grads:  [0.06723497]
Stock Position:  0.06723497409048831
Bond Position:  [14.32109849]


portfolio before change:  [21.28642641]
curr_Stock_Price:  103.58348339590479
curr_Factors:  [103.5834834]
mat_Sqrt:  [[0.15]]
grads:  [-0.08842189]
Stock Position:  -0.08842188771431651
Bond Position:  [30.44547354]


portfolio before change:  [21.32496756]
curr_Stock_Price:  103.16912613092872
curr_Factors:  [103.16912613]
mat_Sqrt:  [[0.15]]
grads:  [0.08463369]
Stock Position:  0.08463369284444539
Bond Position:  [12.59338343]


portfolio before change:  [21.26224753]
curr_Stock_Price:  102.41874958720818
curr_Factors:  [102.41874959]
mat_Sqrt:  [[0.15]]
grads:  [0.00326287]
Stock Position:  0.003262868795678549
Bond Position:  [20.92806859]


portfolio before change:  [21.26396651]
curr_Stock_Price:  102.54469219719122
curr_Factors:  [102.5446922]
mat_Sqrt:  [[0.15]]
grads:  [0.14051547]
Stock Position:  0.14051546704958534
Bond Position:  [6.85485119]


portfolio before change:  [21.19396193]
curr_Stock_Price:  102.04344474548509
curr_Factors:  [102.04344475]
mat_Sqrt:  [[0.15]]
grads:  [-0.14986646]
Stock Position:  -0.1498664635104928
Bond Position:  [36.48685212]


portfolio before change:  [21.24555766]
curr_Stock_Price:  101.71438360684456
curr_Factors:  [101.71438361]
mat_Sqrt:  [[0.15]]
grads:  [-0.01966429]
Stock Position:  -0.019664286393026188
Bond Position:  [23.24569843]


portfolio before change:  [21.23905786]
curr_Stock_Price:  102.11880724232718
curr_Factors:  [102.11880724]
mat_Sqrt:  [[0.15]]
grads:  [-0.06929198]
Stock Position:  -0.0692919806942616
Bond Position:  [28.31507228]


portfolio before change:  [21.20333068]
curr_Stock_Price:  102.65995111223856
curr_Factors:  [102.65995111]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156499]
Stock Position:  -0.02156499402027689
Bond Position:  [23.41719191]


portfolio before change:  [21.20807659]
curr_Stock_Price:  102.50774643850451
curr_Factors:  [102.50774644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.20807659]
Stock Price:  102.71364064530471
PL:  [18.49443595]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.40306514e-03]
 [-1.14878709e-02]
 [-7.13795233e-03]
 [ 5.93870984e-03]
 [-1.47433259e-03]
 [ 1.25731757e-02]
 [ 1.47079821e-03]
 [-2.20966335e-02]
 [ 3.23836078e-03]
 [ 1.16838262e-02]
 [ 1.35284736e-02]
 [-1.85138421e-02]
 [-8.78972743e-03]
 [ 7.79050303e-03]
 [-6.94720291e-03]
 [ 7.17477861e-03]
 [ 7.18743442e-03]
 [-1.16797913e-02]
 [-3.97470218e-04]
 [ 1.48777871e-02]
 [ 1.14830300e-02]
 [-8.27626289e-03]
 [ 7.99840992e-03]
 [ 2.60295060e-02]
 [-7.99384921e-03]
 [-7.90370270e-03]
 [-5.28650985e-03]
 [ 6.54295215e-03]
 [-1.33483891e-02]
 [-7.66983453e-04]
 [ 2.79203259e-03]
 [-1.01564576e-02]
 [-6.42998451e-03]
 [ 5.13822525e-03]
 [ 1.22961780e-02]
 [ 1.34234003e-02]
 [-3.47662080e-02]
 [ 9.58348340e-03]
 [-1.41892774e-02]
 [ 2.44883380e-02]
 [-6.15305816e-03]
 [-1.31554448e-03]
 [ 2.33144617e-02]
 [ 3.61347462e-03]
 [-5.94561650e-03]
 [-7.78224177e-03]
 [ 1.44069784e-02]
 [-3.13144943e-03]
 [-6.92831746e-03]
 [-7.50045233e-03]
 [-3.82645321e-02]
 [ 2.67459269e-03]
 [-8.31121984e-03]
 [ 5.70698117e-03]
 [-6.19611029e-03]
 [ 5.01665843e-03]
 [ 1.01412595e-02]
 [ 1.77799313e-04]
 [ 1.87899068e-03]
 [ 6.20348023e-03]
 [ 1.36875642e-02]
 [ 3.58962360e-02]
 [-9.25793446e-04]
 [-1.21842558e-02]
 [ 1.54626084e-02]
 [ 5.98730868e-03]
 [-5.08717088e-03]
 [ 1.56225747e-02]
 [-1.84806125e-02]
 [-3.51915636e-02]
 [-9.56409107e-03]
 [ 1.50793593e-02]
 [-2.32635515e-02]
 [ 2.79631354e-02]
 [-2.70386975e-02]
 [ 2.26761045e-03]
 [ 4.32805255e-03]
 [-1.38780167e-02]
 [ 2.37097746e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.1083673]
curr_Stock_Price:  99.66512509999528
curr_Factors:  [99.6651251]
mat_Sqrt:  [[0.15]]
grads:  [0.0226871]
Stock Position:  0.022687100933052633
Bond Position:  [-5.36948005]


portfolio before change:  [-3.11994392]
curr_Stock_Price:  99.1696443997048
curr_Factors:  [99.1696444]
mat_Sqrt:  [[0.15]]
grads:  [-0.07658581]
Stock Position:  -0.07658580626826127
Bond Position:  [4.47504325]


portfolio before change:  [-3.05804129]
curr_Stock_Price:  98.36501844853555
curr_Factors:  [98.36501845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758635]
Stock Position:  -0.04758634888338511
Bond Position:  [1.62279079]


portfolio before change:  [-3.06394447]
curr_Stock_Price:  98.49120171126147
curr_Factors:  [98.49120171]
mat_Sqrt:  [[0.15]]
grads:  [0.0395914]
Stock Position:  0.03959139896199634
Bond Position:  [-6.96334893]


portfolio before change:  [-3.05462497]
curr_Stock_Price:  98.73758656550956
curr_Factors:  [98.73758657]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982888]
Stock Position:  -0.009828883916254883
Bond Position:  [-2.08414469]


portfolio before change:  [-3.04894955]
curr_Stock_Price:  98.14691074428409
curr_Factors:  [98.14691074]
mat_Sqrt:  [[0.15]]
grads:  [0.08382117]
Stock Position:  0.08382117129839585
Bond Position:  [-11.27573857]


portfolio before change:  [-2.97717528]
curr_Stock_Price:  99.01159710947019
curr_Factors:  [99.01159711]
mat_Sqrt:  [[0.15]]
grads:  [0.00980532]
Stock Position:  0.009805321371388306
Bond Position:  [-3.94801581]


portfolio before change:  [-2.98264548]
curr_Stock_Price:  98.47888175817266
curr_Factors:  [98.47888176]
mat_Sqrt:  [[0.15]]
grads:  [-0.14731089]
Stock Position:  -0.14731089027408265
Bond Position:  [11.52436626]


portfolio before change:  [-3.059095]
curr_Stock_Price:  99.00273858246635
curr_Factors:  [99.00273858]
mat_Sqrt:  [[0.15]]
grads:  [0.02158907]
Stock Position:  0.02158907187777846
Bond Position:  [-5.19647224]


portfolio before change:  [-3.04841962]
curr_Stock_Price:  99.5122634384114
curr_Factors:  [99.51226344]
mat_Sqrt:  [[0.15]]
grads:  [0.07789217]
Stock Position:  0.07789217460590415
Bond Position:  [-10.79964622]


portfolio before change:  [-3.03397936]
curr_Stock_Price:  99.70631704976732
curr_Factors:  [99.70631705]
mat_Sqrt:  [[0.15]]
grads:  [0.09018982]
Stock Position:  0.09018982426672616
Bond Position:  [-12.02647458]


portfolio before change:  [-2.95888277]
curr_Stock_Price:  100.54730182705273
curr_Factors:  [100.54730183]
mat_Sqrt:  [[0.15]]
grads:  [-0.12342561]
Stock Position:  -0.12342561432070548
Bond Position:  [9.45122972]


portfolio before change:  [-2.84042618]
curr_Stock_Price:  99.59234713909268
curr_Factors:  [99.59234714]
mat_Sqrt:  [[0.15]]
grads:  [-0.05859818]
Stock Position:  -0.05859818284185089
Bond Position:  [2.99550438]


portfolio before change:  [-2.79580885]
curr_Stock_Price:  98.83413055278331
curr_Factors:  [98.83413055]
mat_Sqrt:  [[0.15]]
grads:  [0.05193669]
Stock Position:  0.05193668685192894
Bond Position:  [-7.92892613]


portfolio before change:  [-2.78645861]
curr_Stock_Price:  99.02370386362438
curr_Factors:  [99.02370386]
mat_Sqrt:  [[0.15]]
grads:  [-0.04631469]
Stock Position:  -0.04631468604524057
Bond Position:  [1.79979315]


portfolio before change:  [-2.78789598]
curr_Stock_Price:  99.05716756698385
curr_Factors:  [99.05716757]
mat_Sqrt:  [[0.15]]
grads:  [0.04783186]
Stock Position:  0.047831857405582
Bond Position:  [-7.52598429]


portfolio before change:  [-2.78499013]
curr_Stock_Price:  99.12775319329643
curr_Factors:  [99.12775319]
mat_Sqrt:  [[0.15]]
grads:  [0.04791623]
Stock Position:  0.0479162294544216
Bond Position:  [-7.53481829]


portfolio before change:  [-2.77743814]
curr_Stock_Price:  99.29518965896102
curr_Factors:  [99.29518966]
mat_Sqrt:  [[0.15]]
grads:  [-0.07786528]
Stock Position:  -0.07786527527551738
Bond Position:  [4.95420913]


portfolio before change:  [-2.77052022]
curr_Stock_Price:  99.21032160488106
curr_Factors:  [99.2103216]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026498]
Stock Position:  -0.0026498014528423637
Bond Position:  [-2.50763257]


portfolio before change:  [-2.77070961]
curr_Stock_Price:  99.22264739672768
curr_Factors:  [99.2226474]
mat_Sqrt:  [[0.15]]
grads:  [0.09918525]
Stock Position:  0.09918524719410417
Bond Position:  [-12.61213242]


portfolio before change:  [-2.74495259]
curr_Stock_Price:  99.49028106718018
curr_Factors:  [99.49028107]
mat_Sqrt:  [[0.15]]
grads:  [0.07655353]
Stock Position:  0.07655353307468178
Bond Position:  [-10.36128511]


portfolio before change:  [-2.7784504]
curr_Stock_Price:  99.06116684238864
curr_Factors:  [99.06116684]
mat_Sqrt:  [[0.15]]
grads:  [-0.05517509]
Stock Position:  -0.0551750859592273
Bond Position:  [2.687258]


portfolio before change:  [-2.76908914]
curr_Stock_Price:  98.89454646888376
curr_Factors:  [98.89454647]
mat_Sqrt:  [[0.15]]
grads:  [0.05332273]
Stock Position:  0.053322732789214504
Bond Position:  [-8.04241662]


portfolio before change:  [-2.7561731]
curr_Stock_Price:  99.14619724380827
curr_Factors:  [99.14619724]
mat_Sqrt:  [[0.15]]
grads:  [0.17353004]
Stock Position:  0.1735300403286377
Bond Position:  [-19.96101671]


portfolio before change:  [-2.74816906]
curr_Stock_Price:  99.19951163403161
curr_Factors:  [99.19951163]
mat_Sqrt:  [[0.15]]
grads:  [-0.05329233]
Stock Position:  -0.05329232809071141
Bond Position:  [2.53840386]


portfolio before change:  [-2.71374492]
curr_Stock_Price:  98.5565395326138
curr_Factors:  [98.55653953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05269135]
Stock Position:  -0.05269135134595792
Bond Position:  [2.47933233]


portfolio before change:  [-2.72873349]
curr_Stock_Price:  98.84394025372639
curr_Factors:  [98.84394025]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352434]
Stock Position:  -0.03524339899683398
Bond Position:  [0.75486293]


portfolio before change:  [-2.72672089]
curr_Stock_Price:  98.78817309693494
curr_Factors:  [98.7881731]
mat_Sqrt:  [[0.15]]
grads:  [0.04361968]
Stock Position:  0.04361968098043657
Bond Position:  [-7.03582948]


portfolio before change:  [-2.72714464]
curr_Stock_Price:  98.78853978533915
curr_Factors:  [98.78853979]
mat_Sqrt:  [[0.15]]
grads:  [-0.08898926]
Stock Position:  -0.0889892606716575
Bond Position:  [6.06397447]


portfolio before change:  [-2.71879853]
curr_Stock_Price:  98.69901096019476
curr_Factors:  [98.69901096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00511322]
Stock Position:  -0.005113223019524387
Bond Position:  [-2.21412848]


portfolio before change:  [-2.71197615]
curr_Stock_Price:  97.33768381965716
curr_Factors:  [97.33768382]
mat_Sqrt:  [[0.15]]
grads:  [0.01861355]
Stock Position:  0.018613550568729702
Bond Position:  [-4.52377605]


portfolio before change:  [-2.69869291]
curr_Stock_Price:  98.06650665459634
curr_Factors:  [98.06650665]
mat_Sqrt:  [[0.15]]
grads:  [-0.06770972]
Stock Position:  -0.06770971719502697
Bond Position:  [3.94136252]


portfolio before change:  [-2.74462814]
curr_Stock_Price:  98.74855894621341
curr_Factors:  [98.74855895]
mat_Sqrt:  [[0.15]]
grads:  [-0.04286656]
Stock Position:  -0.04286656340174784
Bond Position:  [1.48838323]


portfolio before change:  [-2.71169574]
curr_Stock_Price:  97.98247532036605
curr_Factors:  [97.98247532]
mat_Sqrt:  [[0.15]]
grads:  [0.03425484]
Stock Position:  0.03425483502259808
Bond Position:  [-6.06806927]


portfolio before change:  [-2.67493489]
curr_Stock_Price:  99.0667052747025
curr_Factors:  [99.06670527]
mat_Sqrt:  [[0.15]]
grads:  [0.08197452]
Stock Position:  0.08197452005038694
Bond Position:  [-10.7958805]


portfolio before change:  [-2.63418704]
curr_Stock_Price:  99.57201611968692
curr_Factors:  [99.57201612]
mat_Sqrt:  [[0.15]]
grads:  [0.08948934]
Stock Position:  0.08948933517284881
Bond Position:  [-11.54482056]


portfolio before change:  [-2.6030782]
curr_Stock_Price:  99.92770554494008
curr_Factors:  [99.92770554]
mat_Sqrt:  [[0.15]]
grads:  [-0.23177472]
Stock Position:  -0.23177471986056122
Bond Position:  [20.55763776]


portfolio before change:  [-2.55119627]
curr_Stock_Price:  99.70940290591922
curr_Factors:  [99.70940291]
mat_Sqrt:  [[0.15]]
grads:  [0.06388989]
Stock Position:  0.0638898893071261
Bond Position:  [-8.92161899]


portfolio before change:  [-2.58069904]
curr_Stock_Price:  99.25635552380014
curr_Factors:  [99.25635552]
mat_Sqrt:  [[0.15]]
grads:  [-0.09459518]
Stock Position:  -0.09459518258632445
Bond Position:  [6.80847403]


portfolio before change:  [-2.57820885]
curr_Stock_Price:  99.23452942124044
curr_Factors:  [99.23452942]
mat_Sqrt:  [[0.15]]
grads:  [0.16325559]
Stock Position:  0.1632555865821311
Bond Position:  [-18.77880016]


portfolio before change:  [-2.49893842]
curr_Stock_Price:  99.72727913168359
curr_Factors:  [99.72727913]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102039]
Stock Position:  -0.04102038773856892
Bond Position:  [1.59191324]


portfolio before change:  [-2.478541]
curr_Stock_Price:  99.2324537809936
curr_Factors:  [99.23245378]
mat_Sqrt:  [[0.15]]
grads:  [-0.0087703]
Stock Position:  -0.008770296548782341
Bond Position:  [-1.60824295]


portfolio before change:  [-2.480159]
curr_Stock_Price:  99.40547953621906
curr_Factors:  [99.40547954]
mat_Sqrt:  [[0.15]]
grads:  [0.15542974]
Stock Position:  0.1554297449539878
Bond Position:  [-17.93072733]


portfolio before change:  [-2.355459]
curr_Stock_Price:  100.21498168115825
curr_Factors:  [100.21498168]
mat_Sqrt:  [[0.15]]
grads:  [0.02408983]
Stock Position:  0.02408983081571017
Bond Position:  [-4.76962095]


portfolio before change:  [-2.3250362]
curr_Stock_Price:  101.490245982746
curr_Factors:  [101.49024598]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963744]
Stock Position:  -0.03963744331047491
Bond Position:  [1.69777767]


portfolio before change:  [-2.33632332]
curr_Stock_Price:  101.7776820267673
curr_Factors:  [101.77768203]
mat_Sqrt:  [[0.15]]
grads:  [-0.05188161]
Stock Position:  -0.05188161177979884
Bond Position:  [2.94406687]


portfolio before change:  [-2.40745921]
curr_Stock_Price:  103.15234833181401
curr_Factors:  [103.15234833]
mat_Sqrt:  [[0.15]]
grads:  [0.09604652]
Stock Position:  0.09604652265676825
Bond Position:  [-12.31488357]


portfolio before change:  [-2.55139795]
curr_Stock_Price:  101.66172657199577
curr_Factors:  [101.66172657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02087633]
Stock Position:  -0.020876329522975558
Bond Position:  [-0.42907425]


portfolio before change:  [-2.55096055]
curr_Stock_Price:  101.6394896770496
curr_Factors:  [101.63948968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04618878]
Stock Position:  -0.046188783082171656
Bond Position:  [2.14364379]


portfolio before change:  [-2.56236591]
curr_Stock_Price:  101.88931966783238
curr_Factors:  [101.88931967]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000302]
Stock Position:  -0.0500030155553758
Bond Position:  [2.53240733]


portfolio before change:  [-2.61257514]
curr_Stock_Price:  102.89660910015331
curr_Factors:  [102.8966091]
mat_Sqrt:  [[0.15]]
grads:  [-0.25509688]
Stock Position:  -0.2550968804543605
Bond Position:  [23.63602885]


portfolio before change:  [-2.75318443]
curr_Stock_Price:  103.45359979707358
curr_Factors:  [103.4535998]
mat_Sqrt:  [[0.15]]
grads:  [0.01783062]
Stock Position:  0.01783061794221167
Bond Position:  [-4.59782604]


portfolio before change:  [-2.76366258]
curr_Stock_Price:  102.88206749761521
curr_Factors:  [102.8820675]
mat_Sqrt:  [[0.15]]
grads:  [-0.05540813]
Stock Position:  -0.055408132296460626
Bond Position:  [2.93684063]


portfolio before change:  [-2.78246515]
curr_Stock_Price:  103.22472723300193
curr_Factors:  [103.22472723]
mat_Sqrt:  [[0.15]]
grads:  [0.03804654]
Stock Position:  0.03804654116626379
Bond Position:  [-6.70980899]


portfolio before change:  [-2.78901538]
curr_Stock_Price:  103.06358635500229
curr_Factors:  [103.06358636]
mat_Sqrt:  [[0.15]]
grads:  [-0.0413074]
Stock Position:  -0.041307401958357456
Bond Position:  [1.46827361]


portfolio before change:  [-2.77796416]
curr_Stock_Price:  102.79827176616651
curr_Factors:  [102.79827177]
mat_Sqrt:  [[0.15]]
grads:  [0.03344439]
Stock Position:  0.03344438955208542
Bond Position:  [-6.2159896]


portfolio before change:  [-2.75585426]
curr_Stock_Price:  103.47098282764202
curr_Factors:  [103.47098283]
mat_Sqrt:  [[0.15]]
grads:  [0.0676084]
Stock Position:  0.06760839639757273
Bond Position:  [-9.75136148]


portfolio before change:  [-2.74528275]
curr_Stock_Price:  103.63636144530298
curr_Factors:  [103.63636145]
mat_Sqrt:  [[0.15]]
grads:  [0.00118533]
Stock Position:  0.00118532875387879
Bond Position:  [-2.86812591]


portfolio before change:  [-2.74331765]
curr_Stock_Price:  105.44545123258173
curr_Factors:  [105.44545123]
mat_Sqrt:  [[0.15]]
grads:  [0.0125266]
Stock Position:  0.01252660453418832
Bond Position:  [-4.06419112]


portfolio before change:  [-2.74022832]
curr_Stock_Price:  105.71235136762459
curr_Factors:  [105.71235137]
mat_Sqrt:  [[0.15]]
grads:  [0.04135653]
Stock Position:  0.04135653487465579
Bond Position:  [-7.11212486]


portfolio before change:  [-2.75283785]
curr_Stock_Price:  105.41820176253678
curr_Factors:  [105.41820176]
mat_Sqrt:  [[0.15]]
grads:  [0.09125043]
Stock Position:  0.0912504281368975
Bond Position:  [-12.37229389]


portfolio before change:  [-2.73797721]
curr_Stock_Price:  105.58953173636219
curr_Factors:  [105.58953174]
mat_Sqrt:  [[0.15]]
grads:  [0.23930824]
Stock Position:  0.23930823997923942
Bond Position:  [-28.00642221]


portfolio before change:  [-2.66857721]
curr_Stock_Price:  105.886848923336
curr_Factors:  [105.88684892]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617196]
Stock Position:  -0.006171956304389381
Bond Position:  [-2.01504821]


portfolio before change:  [-2.6706373]
curr_Stock_Price:  106.20022489175071
curr_Factors:  [106.20022489]
mat_Sqrt:  [[0.15]]
grads:  [-0.08122837]
Stock Position:  -0.08122837227947938
Bond Position:  [5.95583411]


portfolio before change:  [-2.6396568]
curr_Stock_Price:  105.82340764614283
curr_Factors:  [105.82340765]
mat_Sqrt:  [[0.15]]
grads:  [0.10308406]
Stock Position:  0.10308405617857881
Bond Position:  [-13.54836289]


portfolio before change:  [-2.71374291]
curr_Stock_Price:  105.11292614078832
curr_Factors:  [105.11292614]
mat_Sqrt:  [[0.15]]
grads:  [0.03991539]
Stock Position:  0.039915391187226174
Bond Position:  [-6.90936648]


portfolio before change:  [-2.66599511]
curr_Stock_Price:  106.31997063183307
curr_Factors:  [106.31997063]
mat_Sqrt:  [[0.15]]
grads:  [-0.03391447]
Stock Position:  -0.03391447253218709
Bond Position:  [0.93979062]


portfolio before change:  [-2.68285253]
curr_Stock_Price:  106.81875956463715
curr_Factors:  [106.81875956]
mat_Sqrt:  [[0.15]]
grads:  [0.1041505]
Stock Position:  0.10415049794516476
Bond Position:  [-13.80807953]


portfolio before change:  [-2.6342161]
curr_Stock_Price:  107.29402818863159
curr_Factors:  [107.29402819]
mat_Sqrt:  [[0.15]]
grads:  [-0.12320408]
Stock Position:  -0.1232040833739724
Bond Position:  [10.5848463]


portfolio before change:  [-2.62313489]
curr_Stock_Price:  107.20945606766229
curr_Factors:  [107.20945607]
mat_Sqrt:  [[0.15]]
grads:  [-0.23461042]
Stock Position:  -0.23461042405926724
Bond Position:  [22.52932106]


portfolio before change:  [-2.39512261]
curr_Stock_Price:  106.24358187604729
curr_Factors:  [106.24358188]
mat_Sqrt:  [[0.15]]
grads:  [-0.06376061]
Stock Position:  -0.06376060714036443
Bond Position:  [4.37903267]


portfolio before change:  [-2.40140926]
curr_Stock_Price:  106.34647212022728
curr_Factors:  [106.34647212]
mat_Sqrt:  [[0.15]]
grads:  [0.10052906]
Stock Position:  0.10052906171098988
Bond Position:  [-13.09232032]


portfolio before change:  [-2.3547885]
curr_Stock_Price:  106.8183660293411
curr_Factors:  [106.81836603]
mat_Sqrt:  [[0.15]]
grads:  [-0.15509034]
Stock Position:  -0.1550903436258506
Bond Position:  [14.21170859]


portfolio before change:  [-2.29743736]
curr_Stock_Price:  106.45430157564145
curr_Factors:  [106.45430158]
mat_Sqrt:  [[0.15]]
grads:  [0.1864209]
Stock Position:  0.1864209023520693
Bond Position:  [-22.14274432]


portfolio before change:  [-2.40201532]
curr_Stock_Price:  105.90074779588674
curr_Factors:  [105.9007478]
mat_Sqrt:  [[0.15]]
grads:  [-0.18025798]
Stock Position:  -0.18025798337803597
Bond Position:  [16.68743991]


portfolio before change:  [-2.28086524]
curr_Stock_Price:  105.23444116892405
curr_Factors:  [105.23444117]
mat_Sqrt:  [[0.15]]
grads:  [0.0151174]
Stock Position:  0.01511740296671712
Bond Position:  [-3.87173669]


portfolio before change:  [-2.26719654]
curr_Stock_Price:  106.15461835144971
curr_Factors:  [106.15461835]
mat_Sqrt:  [[0.15]]
grads:  [0.02885368]
Stock Position:  0.02885368366475278
Bond Position:  [-5.33014832]


portfolio before change:  [-2.2658538]
curr_Stock_Price:  106.21270052246508
curr_Factors:  [106.21270052]
mat_Sqrt:  [[0.15]]
grads:  [-0.09252011]
Stock Position:  -0.09252011162129618
Bond Position:  [7.56095711]


portfolio before change:  [-2.28330915]
curr_Stock_Price:  106.40647375439914
curr_Factors:  [106.40647375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.28330915]
Stock Price:  105.87688123222979
PL:  [-8.16019038]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 1.15575198e-02]
 [-5.76876173e-03]
 [-9.03807661e-04]
 [ 8.50710269e-03]
 [ 4.45516849e-03]
 [ 2.21615666e-02]
 [ 1.25932436e-03]
 [-1.73677046e-02]
 [ 8.65272612e-03]
 [ 6.84587261e-03]
 [ 1.48858780e-02]
 [ 3.75288926e-03]
 [ 8.28007851e-04]
 [ 7.53289291e-04]
 [-6.91424983e-03]
 [ 2.51420491e-02]
 [ 1.05598041e-02]
 [-1.18903607e-02]
 [-3.00201159e-04]
 [ 1.20950150e-02]
 [ 1.14305501e-02]
 [-8.39937850e-03]
 [ 6.59895512e-03]
 [ 4.99097359e-03]
 [-8.11044348e-03]
 [-9.51097314e-03]
 [-3.92875878e-03]
 [ 8.06177898e-03]
 [-1.67443852e-02]
 [ 5.59569609e-04]
 [-2.19583909e-03]
 [-1.07975928e-02]
 [-5.77796339e-03]
 [ 4.48331007e-03]
 [ 1.21755171e-02]
 [ 1.06368943e-02]
 [-3.40841543e-02]
 [ 9.60301213e-03]
 [ 3.15591824e-03]
 [ 1.64860827e-02]
 [-6.05260832e-03]
 [-1.42963575e-02]
 [ 2.29535889e-02]
 [ 3.11128456e-03]
 [-7.28250889e-03]
 [-7.06328625e-04]
 [ 1.16875400e-02]
 [-8.31480579e-03]
 [-9.36053211e-03]
 [-6.15798697e-03]
 [ 4.75472576e-02]
 [-9.07080124e-03]
 [ 3.49604874e-03]
 [ 5.30036286e-03]
 [ 5.19291568e-03]
 [-1.77138009e-03]
 [ 7.19096150e-03]
 [-4.58440012e-04]
 [ 1.53772498e-03]
 [-1.75601015e-03]
 [-4.62608188e-04]
 [-9.59637545e-05]
 [ 3.62094018e-03]
 [-1.83254878e-02]
 [-9.52533033e-03]
 [-4.00162552e-03]
 [-4.79123979e-03]
 [ 2.05745187e-02]
 [-9.85960534e-03]
 [ 7.77409046e-03]
 [-4.66936036e-03]
 [ 1.12767372e-02]
 [-2.94745973e-03]
 [ 8.96531130e-03]
 [-1.86263421e-02]
 [-4.27111719e-03]
 [-7.83855275e-03]
 [-1.54920904e-03]
 [ 2.42447238e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.81125636]
curr_Stock_Price:  98.51399546607006
curr_Factors:  [98.51399547]
mat_Sqrt:  [[0.15]]
grads:  [0.07705013]
Stock Position:  0.07705013174286483
Bond Position:  [-28.40177269]


portfolio before change:  [-20.7469098]
curr_Stock_Price:  99.3721604918835
curr_Factors:  [99.37216049]
mat_Sqrt:  [[0.15]]
grads:  [-0.03845841]
Stock Position:  -0.03845841155993909
Bond Position:  [-16.92521436]


portfolio before change:  [-20.75056961]
curr_Stock_Price:  99.43981674570706
curr_Factors:  [99.43981675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00602538]
Stock Position:  -0.006025384406432346
Bond Position:  [-20.15140649]


portfolio before change:  [-20.75223624]
curr_Stock_Price:  99.50738471374315
curr_Factors:  [99.50738471]
mat_Sqrt:  [[0.15]]
grads:  [0.05671402]
Stock Position:  0.05671401792346063
Bond Position:  [-26.39569984]


portfolio before change:  [-20.75215956]
curr_Stock_Price:  99.537826210225
curr_Factors:  [99.53782621]
mat_Sqrt:  [[0.15]]
grads:  [0.02970112]
Stock Position:  0.029701123243806606
Bond Position:  [-23.7085448]


portfolio before change:  [-20.74960459]
curr_Stock_Price:  99.6737402104104
curr_Factors:  [99.67374021]
mat_Sqrt:  [[0.15]]
grads:  [0.14774378]
Stock Position:  0.14774377734925753
Bond Position:  [-35.47577947]


portfolio before change:  [-20.71054057]
curr_Stock_Price:  99.95315185632813
curr_Factors:  [99.95315186]
mat_Sqrt:  [[0.15]]
grads:  [0.0083955]
Stock Position:  0.008395495721057805
Bond Position:  [-21.54969683]


portfolio before change:  [-20.718449]
curr_Stock_Price:  99.17159819859395
curr_Factors:  [99.1715982]
mat_Sqrt:  [[0.15]]
grads:  [-0.1157847]
Stock Position:  -0.11578469728471888
Bond Position:  [-9.23589552]


portfolio before change:  [-20.72885474]
curr_Stock_Price:  99.25648409440889
curr_Factors:  [99.25648409]
mat_Sqrt:  [[0.15]]
grads:  [0.05768484]
Stock Position:  0.057684840821366816
Bond Position:  [-26.45444923]


portfolio before change:  [-20.70905577]
curr_Stock_Price:  99.62837438281565
curr_Factors:  [99.62837438]
mat_Sqrt:  [[0.15]]
grads:  [0.04563915]
Stock Position:  0.045639150717532696
Bond Position:  [-25.25601016]


portfolio before change:  [-20.72872436]
curr_Stock_Price:  99.23200325100143
curr_Factors:  [99.23200325]
mat_Sqrt:  [[0.15]]
grads:  [0.09923919]
Stock Position:  0.0992391863792518
Bond Position:  [-30.57642762]


portfolio before change:  [-20.69393139]
curr_Stock_Price:  99.6018576733145
curr_Factors:  [99.60185767]
mat_Sqrt:  [[0.15]]
grads:  [0.02501926]
Stock Position:  0.025019261736970146
Bond Position:  [-23.18589634]


portfolio before change:  [-20.6819078]
curr_Stock_Price:  100.14035297264603
curr_Factors:  [100.14035297]
mat_Sqrt:  [[0.15]]
grads:  [0.00552005]
Stock Position:  0.00552005234294888
Bond Position:  [-21.23468779]


portfolio before change:  [-20.68105278]
curr_Stock_Price:  100.53568033678678
curr_Factors:  [100.53568034]
mat_Sqrt:  [[0.15]]
grads:  [0.00502193]
Stock Position:  0.005021928608496817
Bond Position:  [-21.18593579]


portfolio before change:  [-20.6814525]
curr_Stock_Price:  100.71976133827481
curr_Factors:  [100.71976134]
mat_Sqrt:  [[0.15]]
grads:  [-0.046095]
Stock Position:  -0.04609499886582031
Bond Position:  [-16.03877522]


portfolio before change:  [-20.74401223]
curr_Stock_Price:  102.05520485608689
curr_Factors:  [102.05520486]
mat_Sqrt:  [[0.15]]
grads:  [0.16761366]
Stock Position:  0.16761366058128171
Bond Position:  [-37.84985869]


portfolio before change:  [-20.91662009]
curr_Stock_Price:  101.03952288732948
curr_Factors:  [101.03952289]
mat_Sqrt:  [[0.15]]
grads:  [0.07039869]
Stock Position:  0.0703986941864738
Bond Position:  [-28.02967056]


portfolio before change:  [-21.01955416]
curr_Stock_Price:  99.6022496328639
curr_Factors:  [99.60224963]
mat_Sqrt:  [[0.15]]
grads:  [-0.07926907]
Stock Position:  -0.07926907148545785
Bond Position:  [-13.12417631]


portfolio before change:  [-21.08555199]
curr_Stock_Price:  100.42448136213332
curr_Factors:  [100.42448136]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200134]
Stock Position:  -0.0020013410610165523
Bond Position:  [-20.88456835]


portfolio before change:  [-21.08615395]
curr_Stock_Price:  100.07303177151466
curr_Factors:  [100.07303177]
mat_Sqrt:  [[0.15]]
grads:  [0.08063343]
Stock Position:  0.08063343325418473
Bond Position:  [-29.15538608]


portfolio before change:  [-21.11905074]
curr_Stock_Price:  99.68765158336785
curr_Factors:  [99.68765158]
mat_Sqrt:  [[0.15]]
grads:  [0.07620367]
Stock Position:  0.07620366766655252
Bond Position:  [-28.71561542]


portfolio before change:  [-21.17546667]
curr_Stock_Price:  98.97087316711219
curr_Factors:  [98.97087317]
mat_Sqrt:  [[0.15]]
grads:  [-0.05599586]
Stock Position:  -0.055995856646856294
Bond Position:  [-15.63350784]


portfolio before change:  [-21.1366121]
curr_Stock_Price:  98.2595401845222
curr_Factors:  [98.25954018]
mat_Sqrt:  [[0.15]]
grads:  [0.04399303]
Stock Position:  0.04399303411501433
Bond Position:  [-25.4593474]


portfolio before change:  [-21.13220038]
curr_Stock_Price:  98.39599307998874
curr_Factors:  [98.39599308]
mat_Sqrt:  [[0.15]]
grads:  [0.03327316]
Stock Position:  0.033273157238651
Bond Position:  [-24.40614573]


portfolio before change:  [-21.1285107]
curr_Stock_Price:  98.55272926888291
curr_Factors:  [98.55272927]
mat_Sqrt:  [[0.15]]
grads:  [-0.05406962]
Stock Position:  -0.054069623176561735
Bond Position:  [-15.79980177]


portfolio before change:  [-21.10202612]
curr_Stock_Price:  98.04464177982189
curr_Factors:  [98.04464178]
mat_Sqrt:  [[0.15]]
grads:  [-0.06340649]
Stock Position:  -0.06340648757205139
Bond Position:  [-14.88535976]


portfolio before change:  [-21.12003592]
curr_Stock_Price:  98.3140059056347
curr_Factors:  [98.31400591]
mat_Sqrt:  [[0.15]]
grads:  [-0.02619173]
Stock Position:  -0.02619172521902405
Bond Position:  [-18.54502249]


portfolio before change:  [-21.11443152]
curr_Stock_Price:  98.0557756748572
curr_Factors:  [98.05577567]
mat_Sqrt:  [[0.15]]
grads:  [0.05374519]
Stock Position:  0.05374519320173579
Bond Position:  [-26.38445813]


portfolio before change:  [-21.10168513]
curr_Stock_Price:  98.32362231029909
curr_Factors:  [98.32362231]
mat_Sqrt:  [[0.15]]
grads:  [-0.11162923]
Stock Position:  -0.11162923439572313
Bond Position:  [-10.12589445]


portfolio before change:  [-21.07608253]
curr_Stock_Price:  98.0885987865929
curr_Factors:  [98.08859879]
mat_Sqrt:  [[0.15]]
grads:  [0.00373046]
Stock Position:  0.0037304640620307106
Bond Position:  [-21.44199852]


portfolio before change:  [-21.0768953]
curr_Stock_Price:  98.22997248772272
curr_Factors:  [98.22997249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01463893]
Stock Position:  -0.014638927237710877
Bond Position:  [-19.63891388]


portfolio before change:  [-21.08612404]
curr_Stock_Price:  98.77654748194567
curr_Factors:  [98.77654748]
mat_Sqrt:  [[0.15]]
grads:  [-0.07198395]
Stock Position:  -0.07198395201353933
Bond Position:  [-13.97579779]


portfolio before change:  [-21.09618879]
curr_Stock_Price:  98.90423186814249
curr_Factors:  [98.90423187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03851976]
Stock Position:  -0.03851975592098652
Bond Position:  [-17.28642192]


portfolio before change:  [-21.1005865]
curr_Stock_Price:  98.99035080173613
curr_Factors:  [98.9903508]
mat_Sqrt:  [[0.15]]
grads:  [0.02988873]
Stock Position:  0.029888733811195778
Bond Position:  [-24.05928275]


portfolio before change:  [-21.09467605]
curr_Stock_Price:  99.23841090984688
curr_Factors:  [99.23841091]
mat_Sqrt:  [[0.15]]
grads:  [0.08117011]
Stock Position:  0.0811701140417174
Bond Position:  [-29.14986918]


portfolio before change:  [-21.00438762]
curr_Stock_Price:  100.3731925935917
curr_Factors:  [100.37319259]
mat_Sqrt:  [[0.15]]
grads:  [0.07091263]
Stock Position:  0.07091262840313425
Bond Position:  [-28.12211452]


portfolio before change:  [-20.9619944]
curr_Stock_Price:  100.99580252493638
curr_Factors:  [100.99580252]
mat_Sqrt:  [[0.15]]
grads:  [-0.2272277]
Stock Position:  -0.22722769537796558
Bond Position:  [1.98704905]


portfolio before change:  [-21.09009109]
curr_Stock_Price:  101.56008622059835
curr_Factors:  [101.56008622]
mat_Sqrt:  [[0.15]]
grads:  [0.06402008]
Stock Position:  0.06402008083344711
Bond Position:  [-27.59197602]


portfolio before change:  [-21.09670724]
curr_Stock_Price:  101.48367896325112
curr_Factors:  [101.48367896]
mat_Sqrt:  [[0.15]]
grads:  [0.02103945]
Stock Position:  0.021039454954648203
Bond Position:  [-23.23186853]


portfolio before change:  [-21.1022047]
curr_Stock_Price:  101.29140072456572
curr_Factors:  [101.29140072]
mat_Sqrt:  [[0.15]]
grads:  [0.10990722]
Stock Position:  0.10990721806850198
Bond Position:  [-32.23486077]


portfolio before change:  [-21.1880891]
curr_Stock_Price:  100.5283056315838
curr_Factors:  [100.52830563]
mat_Sqrt:  [[0.15]]
grads:  [-0.04035072]
Stock Position:  -0.04035072211782148
Bond Position:  [-17.13169938]


portfolio before change:  [-21.19420885]
curr_Stock_Price:  100.65343313182953
curr_Factors:  [100.65343313]
mat_Sqrt:  [[0.15]]
grads:  [-0.09530905]
Stock Position:  -0.09530905012474132
Bond Position:  [-11.60102575]


portfolio before change:  [-21.21506042]
curr_Stock_Price:  100.86460379801407
curr_Factors:  [100.8646038]
mat_Sqrt:  [[0.15]]
grads:  [0.15302393]
Stock Position:  0.1530239259249896
Bond Position:  [-36.64975808]


portfolio before change:  [-21.24202807]
curr_Stock_Price:  100.70334159206966
curr_Factors:  [100.70334159]
mat_Sqrt:  [[0.15]]
grads:  [0.0207419]
Stock Position:  0.020741897092446795
Bond Position:  [-23.33080642]


portfolio before change:  [-21.24011897]
curr_Stock_Price:  100.86568585470766
curr_Factors:  [100.86568585]
mat_Sqrt:  [[0.15]]
grads:  [-0.04855006]
Stock Position:  -0.04855005928103553
Bond Position:  [-16.34308394]


portfolio before change:  [-21.2564831]
curr_Stock_Price:  101.18170324744598
curr_Factors:  [101.18170325]
mat_Sqrt:  [[0.15]]
grads:  [-0.00470886]
Stock Position:  -0.004708857499900512
Bond Position:  [-20.78003288]


portfolio before change:  [-21.2590796]
curr_Stock_Price:  101.4572903864254
curr_Factors:  [101.45729039]
mat_Sqrt:  [[0.15]]
grads:  [0.07791693]
Stock Position:  0.07791693348001592
Bond Position:  [-29.16432054]


portfolio before change:  [-21.31117937]
curr_Stock_Price:  100.81202694611692
curr_Factors:  [100.81202695]
mat_Sqrt:  [[0.15]]
grads:  [-0.05543204]
Stock Position:  -0.0554320386161344
Bond Position:  [-15.7229632]


portfolio before change:  [-21.33184274]
curr_Stock_Price:  101.1670681021374
curr_Factors:  [101.1670681]
mat_Sqrt:  [[0.15]]
grads:  [-0.06240355]
Stock Position:  -0.06240354740359065
Bond Position:  [-15.01865881]


portfolio before change:  [-21.232736]
curr_Stock_Price:  99.56386694893295
curr_Factors:  [99.56386695]
mat_Sqrt:  [[0.15]]
grads:  [-0.04105325]
Stock Position:  -0.04105324645684037
Bond Position:  [-17.14531603]


portfolio before change:  [-21.21989406]
curr_Stock_Price:  99.22495208327204
curr_Factors:  [99.22495208]
mat_Sqrt:  [[0.15]]
grads:  [0.31698172]
Stock Position:  0.3169817172635309
Bond Position:  [-52.67238977]


portfolio before change:  [-21.18767411]
curr_Stock_Price:  99.33698402889574
curr_Factors:  [99.33698403]
mat_Sqrt:  [[0.15]]
grads:  [-0.06047201]
Stock Position:  -0.060472008293850056
Bond Position:  [-15.18056719]


portfolio before change:  [-21.14085215]
curr_Stock_Price:  98.5470189243459
curr_Factors:  [98.54701892]
mat_Sqrt:  [[0.15]]
grads:  [0.02330699]
Stock Position:  0.023306991631155464
Bond Position:  [-23.43768669]


portfolio before change:  [-21.14232446]
curr_Stock_Price:  98.54670109983704
curr_Factors:  [98.5467011]
mat_Sqrt:  [[0.15]]
grads:  [0.03533575]
Stock Position:  0.03533575238754022
Bond Position:  [-24.62454629]


portfolio before change:  [-21.16158169]
curr_Stock_Price:  98.04527845998314
curr_Factors:  [98.04527846]
mat_Sqrt:  [[0.15]]
grads:  [0.03461944]
Stock Position:  0.034619437888486676
Bond Position:  [-24.55585411]


portfolio before change:  [-21.17681603]
curr_Stock_Price:  97.64955991517563
curr_Factors:  [97.64955992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0118092]
Stock Position:  -0.011809200576689561
Bond Position:  [-20.02365279]


portfolio before change:  [-21.18152941]
curr_Stock_Price:  97.94270960465762
curr_Factors:  [97.9427096]
mat_Sqrt:  [[0.15]]
grads:  [0.04793974]
Stock Position:  0.04793974330531796
Bond Position:  [-25.87687777]


portfolio before change:  [-21.16265553]
curr_Stock_Price:  98.3701469000327
curr_Factors:  [98.3701469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305627]
Stock Position:  -0.003056266747235342
Bond Position:  [-20.86201012]


portfolio before change:  [-21.16413034]
curr_Stock_Price:  98.42606420102585
curr_Factors:  [98.4260642]
mat_Sqrt:  [[0.15]]
grads:  [0.0102515]
Stock Position:  0.010251499860694279
Bond Position:  [-22.17314513]


portfolio before change:  [-21.17246316]
curr_Stock_Price:  97.74841243635967
curr_Factors:  [97.74841244]
mat_Sqrt:  [[0.15]]
grads:  [-0.01170673]
Stock Position:  -0.01170673434922336
Bond Position:  [-20.02814846]


portfolio before change:  [-21.17630564]
curr_Stock_Price:  97.96971122335867
curr_Factors:  [97.96971122]
mat_Sqrt:  [[0.15]]
grads:  [-0.00308405]
Stock Position:  -0.0030840545892022245
Bond Position:  [-20.8741617]


portfolio before change:  [-21.17875455]
curr_Stock_Price:  98.34072732490745
curr_Factors:  [98.34072732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063976]
Stock Position:  -0.0006397583630954329
Bond Position:  [-21.11584025]


portfolio before change:  [-21.18025838]
curr_Stock_Price:  98.62841068575405
curr_Factors:  [98.62841069]
mat_Sqrt:  [[0.15]]
grads:  [0.0241396]
Stock Position:  0.024139601213921197
Bond Position:  [-23.56110888]


portfolio before change:  [-21.20661077]
curr_Stock_Price:  97.59774831473186
curr_Factors:  [97.59774831]
mat_Sqrt:  [[0.15]]
grads:  [-0.12216992]
Stock Position:  -0.12216991890348895
Bond Position:  [-9.28310178]


portfolio before change:  [-21.22322225]
curr_Stock_Price:  97.72896933454646
curr_Factors:  [97.72896933]
mat_Sqrt:  [[0.15]]
grads:  [-0.0635022]
Stock Position:  -0.0635022021713765
Bond Position:  [-15.01721748]


portfolio before change:  [-21.25701109]
curr_Stock_Price:  98.24627789735264
curr_Factors:  [98.2462779]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266775]
Stock Position:  -0.026677503487392215
Bond Position:  [-18.63604566]


portfolio before change:  [-21.24897413]
curr_Stock_Price:  97.90135269198836
curr_Factors:  [97.90135269]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319416]
Stock Position:  -0.031941598579707645
Bond Position:  [-18.12184842]


portfolio before change:  [-21.27121322]
curr_Stock_Price:  98.56213484325872
curr_Factors:  [98.56213484]
mat_Sqrt:  [[0.15]]
grads:  [0.13716346]
Stock Position:  0.1371634578465415
Bond Position:  [-34.79033645]


portfolio before change:  [-21.32695641]
curr_Stock_Price:  98.17158822977565
curr_Factors:  [98.17158823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0657307]
Stock Position:  -0.06573070228616368
Bond Position:  [-14.87406897]


portfolio before change:  [-21.28913245]
curr_Stock_Price:  97.58200662738649
curr_Factors:  [97.58200663]
mat_Sqrt:  [[0.15]]
grads:  [0.05182727]
Stock Position:  0.051827269712665304
Bond Position:  [-26.34654143]


portfolio before change:  [-21.27869487]
curr_Stock_Price:  97.81517133978512
curr_Factors:  [97.81517134]
mat_Sqrt:  [[0.15]]
grads:  [-0.03112907]
Stock Position:  -0.0311290690794057
Bond Position:  [-18.23379965]


portfolio before change:  [-21.2827879]
curr_Stock_Price:  97.9100466019621
curr_Factors:  [97.9100466]
mat_Sqrt:  [[0.15]]
grads:  [0.07517825]
Stock Position:  0.07517824831020639
Bond Position:  [-28.6434937]


portfolio before change:  [-21.25218261]
curr_Stock_Price:  98.34096335142263
curr_Factors:  [98.34096335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01964973]
Stock Position:  -0.01964973151337162
Bond Position:  [-19.31980908]


portfolio before change:  [-21.2661331]
curr_Stock_Price:  98.98946944833169
curr_Factors:  [98.98946945]
mat_Sqrt:  [[0.15]]
grads:  [0.05976874]
Stock Position:  0.05976874202748632
Bond Position:  [-27.18260917]


portfolio before change:  [-21.26505648]
curr_Stock_Price:  99.03590824334123
curr_Factors:  [99.03590824]
mat_Sqrt:  [[0.15]]
grads:  [-0.12417561]
Stock Position:  -0.12417561383773555
Bond Position:  [-8.96721178]


portfolio before change:  [-21.3983819]
curr_Stock_Price:  100.10507909996996
curr_Factors:  [100.1050791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847411]
Stock Position:  -0.028474114609877938
Bond Position:  [-18.5479784]


portfolio before change:  [-21.40928719]
curr_Stock_Price:  100.44735508315068
curr_Factors:  [100.44735508]
mat_Sqrt:  [[0.15]]
grads:  [-0.05225702]
Stock Position:  -0.05225701835014217
Bond Position:  [-16.16020791]


portfolio before change:  [-21.46612818]
curr_Stock_Price:  101.51574645840256
curr_Factors:  [101.51574646]
mat_Sqrt:  [[0.15]]
grads:  [-0.01032806]
Stock Position:  -0.010328060255536465
Bond Position:  [-20.41766743]


portfolio before change:  [-21.47321877]
curr_Stock_Price:  102.07872234201592
curr_Factors:  [102.07872234]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.47321877]
Stock Price:  101.77829676746676
PL:  [-23.25151554]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 3.24390682e-03]
 [ 4.39000851e-04]
 [-9.21911368e-04]
 [ 8.36230132e-03]
 [ 3.46025414e-03]
 [ 1.67523727e-02]
 [ 1.25095248e-03]
 [-1.75627965e-02]
 [ 1.05669219e-02]
 [ 1.72839876e-03]
 [ 1.27763073e-02]
 [-1.04604644e-02]
 [ 5.44102648e-04]
 [ 6.93414251e-03]
 [-6.95208662e-03]
 [ 8.77180507e-03]
 [ 9.70492134e-03]
 [-8.76185989e-03]
 [ 1.35136197e-03]
 [ 1.01085656e-02]
 [ 1.18270480e-02]
 [-8.75192639e-03]
 [ 7.04153659e-03]
 [ 3.68584015e-02]
 [-6.08473705e-03]
 [ 2.66824585e-03]
 [-5.76814232e-03]
 [ 6.21962625e-03]
 [-1.56764392e-02]
 [-6.71382704e-04]
 [-4.07860755e-03]
 [-1.05468966e-02]
 [-1.58308866e-03]
 [ 4.74448279e-03]
 [ 1.22743625e-02]
 [ 1.66302714e-02]
 [-3.45862814e-02]
 [ 8.54421306e-03]
 [-1.92002522e-02]
 [ 2.15608037e-02]
 [-6.22875032e-03]
 [-1.40124110e-02]
 [ 2.31501460e-02]
 [ 2.18628091e-03]
 [-5.86517798e-03]
 [-4.36912597e-03]
 [ 1.28000157e-02]
 [-4.62705722e-03]
 [-6.60886719e-03]
 [-7.55543440e-03]
 [-1.79244985e-03]
 [-6.07857198e-03]
 [-9.31751175e-04]
 [ 5.30302039e-03]
 [ 4.18608350e-03]
 [-1.04630112e-03]
 [ 8.93680683e-03]
 [-5.50972063e-04]
 [ 1.55590583e-03]
 [ 1.48594836e-03]
 [ 3.25571560e-04]
 [-1.66303572e-03]
 [-6.38854600e-03]
 [-1.33445764e-02]
 [-5.31804172e-03]
 [-5.85911662e-04]
 [-5.50123992e-03]
 [ 1.50387330e-02]
 [-8.40175038e-03]
 [ 6.62951651e-03]
 [-1.24812326e-02]
 [ 1.32465739e-02]
 [ 3.43933036e-04]
 [ 2.46957127e-02]
 [-2.51038667e-02]
 [ 1.60867196e-03]
 [ 6.24063027e-04]
 [-6.87028236e-03]
 [ 3.00245538e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.40854911]
curr_Stock_Price:  99.71063074843104
curr_Factors:  [99.71063075]
mat_Sqrt:  [[0.15]]
grads:  [0.02162605]
Stock Position:  0.021626045447302848
Bond Position:  [-4.56489575]


portfolio before change:  [-2.40883066]
curr_Stock_Price:  99.71080497350881
curr_Factors:  [99.71080497]
mat_Sqrt:  [[0.15]]
grads:  [0.00292667]
Stock Position:  0.0029266723428289336
Bond Position:  [-2.70065152]


portfolio before change:  [-2.40981491]
curr_Stock_Price:  99.43217595065519
curr_Factors:  [99.43217595]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614608]
Stock Position:  -0.00614607578507613
Bond Position:  [-1.79869723]


portfolio before change:  [-2.40982888]
curr_Stock_Price:  99.41615703139946
curr_Factors:  [99.41615703]
mat_Sqrt:  [[0.15]]
grads:  [0.05574868]
Stock Position:  0.05574867548018931
Bond Position:  [-7.95214796]


portfolio before change:  [-2.41110281]
curr_Stock_Price:  99.4022212675798
curr_Factors:  [99.40222127]
mat_Sqrt:  [[0.15]]
grads:  [0.02306836]
Stock Position:  0.023068360939655027
Bond Position:  [-4.70414913]


portfolio before change:  [-2.42500316]
curr_Stock_Price:  98.81239477996148
curr_Factors:  [98.81239478]
mat_Sqrt:  [[0.15]]
grads:  [0.11168248]
Stock Position:  0.11168248442439291
Bond Position:  [-13.4606169]


portfolio before change:  [-2.38704135]
curr_Stock_Price:  99.15983617370564
curr_Factors:  [99.15983617]
mat_Sqrt:  [[0.15]]
grads:  [0.00833968]
Stock Position:  0.008339683167273652
Bond Position:  [-3.21400297]


portfolio before change:  [-2.387916]
curr_Stock_Price:  99.07904604596347
curr_Factors:  [99.07904605]
mat_Sqrt:  [[0.15]]
grads:  [-0.11708531]
Stock Position:  -0.11708530967726422
Bond Position:  [9.21278479]


portfolio before change:  [-2.42447659]
curr_Stock_Price:  99.39621994626563
curr_Factors:  [99.39621995]
mat_Sqrt:  [[0.15]]
grads:  [0.07044615]
Stock Position:  0.07044614593203019
Bond Position:  [-9.4265572]


portfolio before change:  [-2.40026548]
curr_Stock_Price:  99.74826588584109
curr_Factors:  [99.74826589]
mat_Sqrt:  [[0.15]]
grads:  [0.01152266]
Stock Position:  0.011522658432090254
Bond Position:  [-3.54963068]


portfolio before change:  [-2.39655845]
curr_Stock_Price:  100.08923702754487
curr_Factors:  [100.08923703]
mat_Sqrt:  [[0.15]]
grads:  [0.08517538]
Stock Position:  0.08517538228466591
Bond Position:  [-10.92169748]


portfolio before change:  [-2.39885046]
curr_Stock_Price:  100.07034210752177
curr_Factors:  [100.07034211]
mat_Sqrt:  [[0.15]]
grads:  [-0.06973643]
Stock Position:  -0.06973642903677534
Bond Position:  [4.57969785]


portfolio before change:  [-2.39597209]
curr_Stock_Price:  100.03317168324156
curr_Factors:  [100.03317168]
mat_Sqrt:  [[0.15]]
grads:  [0.00362735]
Stock Position:  0.003627350988928806
Bond Position:  [-2.75882751]


portfolio before change:  [-2.39643584]
curr_Stock_Price:  99.95285792233246
curr_Factors:  [99.95285792]
mat_Sqrt:  [[0.15]]
grads:  [0.04622762]
Stock Position:  0.04622761674350229
Bond Position:  [-7.01701825]


portfolio before change:  [-2.44412409]
curr_Stock_Price:  98.93074886963278
curr_Factors:  [98.93074887]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634724]
Stock Position:  -0.046347244122319525
Bond Position:  [2.14104348]


portfolio before change:  [-2.40477109]
curr_Stock_Price:  98.08454593484244
curr_Factors:  [98.08454593]
mat_Sqrt:  [[0.15]]
grads:  [0.0584787]
Stock Position:  0.05847870045461029
Bond Position:  [-8.14062788]


portfolio before change:  [-2.41404345]
curr_Stock_Price:  97.93468715660687
curr_Factors:  [97.93468716]
mat_Sqrt:  [[0.15]]
grads:  [0.06469948]
Stock Position:  0.06469947560520524
Bond Position:  [-8.75036635]


portfolio before change:  [-2.37793016]
curr_Stock_Price:  98.50130992377372
curr_Factors:  [98.50130992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0584124]
Stock Position:  -0.0584123992979639
Bond Position:  [3.37576768]


portfolio before change:  [-2.36488774]
curr_Stock_Price:  98.28164024067864
curr_Factors:  [98.28164024]
mat_Sqrt:  [[0.15]]
grads:  [0.00900908]
Stock Position:  0.00900907982335919
Bond Position:  [-3.25031488]


portfolio before change:  [-2.36392453]
curr_Stock_Price:  98.41110476536068
curr_Factors:  [98.41110477]
mat_Sqrt:  [[0.15]]
grads:  [0.06739044]
Stock Position:  0.06739043713123716
Bond Position:  [-8.9958919]


portfolio before change:  [-2.33654728]
curr_Stock_Price:  98.82569648358064
curr_Factors:  [98.82569648]
mat_Sqrt:  [[0.15]]
grads:  [0.07884699]
Stock Position:  0.07884698641443659
Bond Position:  [-10.12865563]


portfolio before change:  [-2.34612032]
curr_Stock_Price:  98.7123125608478
curr_Factors:  [98.71231256]
mat_Sqrt:  [[0.15]]
grads:  [-0.05834618]
Stock Position:  -0.058346175934975805
Bond Position:  [3.41336564]


portfolio before change:  [-2.40193229]
curr_Stock_Price:  99.67253513112179
curr_Factors:  [99.67253513]
mat_Sqrt:  [[0.15]]
grads:  [0.04694358]
Stock Position:  0.04694357729379833
Bond Position:  [-7.08091765]


portfolio before change:  [-2.40706756]
curr_Stock_Price:  99.57257047528435
curr_Factors:  [99.57257048]
mat_Sqrt:  [[0.15]]
grads:  [0.24572268]
Stock Position:  0.24572267683497787
Bond Position:  [-26.87430612]


portfolio before change:  [-2.42346603]
curr_Stock_Price:  99.5126705422018
curr_Factors:  [99.51267054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04056491]
Stock Position:  -0.04056491367575176
Bond Position:  [1.61325686]


portfolio before change:  [-2.41865604]
curr_Stock_Price:  99.39658107960793
curr_Factors:  [99.39658108]
mat_Sqrt:  [[0.15]]
grads:  [0.01778831]
Stock Position:  0.01778830565995726
Bond Position:  [-4.18675281]


portfolio before change:  [-2.42538702]
curr_Stock_Price:  99.03289824542517
curr_Factors:  [99.03289825]
mat_Sqrt:  [[0.15]]
grads:  [-0.03845428]
Stock Position:  -0.038454282126874094
Bond Position:  [1.38285199]


portfolio before change:  [-2.42603777]
curr_Stock_Price:  99.05206848296254
curr_Factors:  [99.05206848]
mat_Sqrt:  [[0.15]]
grads:  [0.04146417]
Stock Position:  0.04146417497631111
Bond Position:  [-6.53315007]


portfolio before change:  [-2.45181283]
curr_Stock_Price:  98.44029381294013
curr_Factors:  [98.44029381]
mat_Sqrt:  [[0.15]]
grads:  [-0.10450959]
Stock Position:  -0.10450959479530632
Bond Position:  [7.83614238]


portfolio before change:  [-2.47376405]
curr_Stock_Price:  98.65502036351081
curr_Factors:  [98.65502036]
mat_Sqrt:  [[0.15]]
grads:  [-0.00447588]
Stock Position:  -0.004475884695637453
Bond Position:  [-2.03219555]


portfolio before change:  [-2.47354495]
curr_Stock_Price:  98.57769273704976
curr_Factors:  [98.57769274]
mat_Sqrt:  [[0.15]]
grads:  [-0.02719072]
Stock Position:  -0.027190717002343774
Bond Position:  [0.20685319]


portfolio before change:  [-2.4878674]
curr_Stock_Price:  99.10490848139081
curr_Factors:  [99.10490848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07031264]
Stock Position:  -0.07031264420710981
Bond Position:  [4.48046077]


portfolio before change:  [-2.51157364]
curr_Stock_Price:  99.4460459267679
curr_Factors:  [99.44604593]
mat_Sqrt:  [[0.15]]
grads:  [-0.01055392]
Stock Position:  -0.010553924408569929
Bond Position:  [-1.46202758]


portfolio before change:  [-2.51517011]
curr_Stock_Price:  99.77815927219163
curr_Factors:  [99.77815927]
mat_Sqrt:  [[0.15]]
grads:  [0.03162989]
Stock Position:  0.0316298852858228
Bond Position:  [-5.67114185]


portfolio before change:  [-2.53704585]
curr_Stock_Price:  99.09774972911875
curr_Factors:  [99.09774973]
mat_Sqrt:  [[0.15]]
grads:  [0.08182908]
Stock Position:  0.0818290830899325
Bond Position:  [-10.64612384]


portfolio before change:  [-2.57747416]
curr_Stock_Price:  98.61182333684808
curr_Factors:  [98.61182334]
mat_Sqrt:  [[0.15]]
grads:  [0.11086848]
Stock Position:  0.11086847584799475
Bond Position:  [-13.51041672]


portfolio before change:  [-2.63149091]
curr_Stock_Price:  98.1322251807486
curr_Factors:  [98.13222518]
mat_Sqrt:  [[0.15]]
grads:  [-0.23057521]
Stock Position:  -0.23057520913104895
Bond Position:  [19.99536744]


portfolio before change:  [-2.41899258]
curr_Stock_Price:  97.216044371877
curr_Factors:  [97.21604437]
mat_Sqrt:  [[0.15]]
grads:  [0.05696142]
Stock Position:  0.056961420378174706
Bond Position:  [-7.95655655]


portfolio before change:  [-2.3648309]
curr_Stock_Price:  98.17562326175569
curr_Factors:  [98.17562326]
mat_Sqrt:  [[0.15]]
grads:  [-0.12800168]
Stock Position:  -0.12800168134803494
Bond Position:  [10.20181395]


portfolio before change:  [-2.36849329]
curr_Stock_Price:  98.2092167205217
curr_Factors:  [98.20921672]
mat_Sqrt:  [[0.15]]
grads:  [0.14373869]
Stock Position:  0.14373869162597394
Bond Position:  [-16.4849576]


portfolio before change:  [-2.14520595]
curr_Stock_Price:  99.76981027764853
curr_Factors:  [99.76981028]
mat_Sqrt:  [[0.15]]
grads:  [-0.041525]
Stock Position:  -0.041525002101406784
Bond Position:  [1.99773563]


portfolio before change:  [-2.17926105]
curr_Stock_Price:  100.5929279424868
curr_Factors:  [100.59292794]
mat_Sqrt:  [[0.15]]
grads:  [-0.09341607]
Stock Position:  -0.09341607363194336
Bond Position:  [7.21773531]


portfolio before change:  [-2.18472386]
curr_Stock_Price:  100.65623537500878
curr_Factors:  [100.65623538]
mat_Sqrt:  [[0.15]]
grads:  [0.15433431]
Stock Position:  0.15433430659226413
Bond Position:  [-17.71943415]


portfolio before change:  [-2.10119532]
curr_Stock_Price:  101.204629577826
curr_Factors:  [101.20462958]
mat_Sqrt:  [[0.15]]
grads:  [0.01457521]
Stock Position:  0.014575206041832805
Bond Position:  [-3.57627365]


portfolio before change:  [-2.09690761]
curr_Stock_Price:  101.51414383420834
curr_Factors:  [101.51414383]
mat_Sqrt:  [[0.15]]
grads:  [-0.03910119]
Stock Position:  -0.03910118654351915
Bond Position:  [1.87241586]


portfolio before change:  [-2.09577471]
curr_Stock_Price:  101.48816325572417
curr_Factors:  [101.48816326]
mat_Sqrt:  [[0.15]]
grads:  [-0.02912751]
Stock Position:  -0.02912750649994359
Bond Position:  [0.86032243]


portfolio before change:  [-2.10745578]
curr_Stock_Price:  101.89104150433775
curr_Factors:  [101.8910415]
mat_Sqrt:  [[0.15]]
grads:  [0.08533344]
Stock Position:  0.0853334379041699
Bond Position:  [-10.80216864]


portfolio before change:  [-2.14904906]
curr_Stock_Price:  101.41153274912494
curr_Factors:  [101.41153275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03084705]
Stock Position:  -0.030847048113372875
Bond Position:  [0.97919737]


portfolio before change:  [-2.15794155]
curr_Stock_Price:  101.7017933611579
curr_Factors:  [101.70179336]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405911]
Stock Position:  -0.04405911458244612
Bond Position:  [2.32294942]


portfolio before change:  [-2.15338263]
curr_Stock_Price:  101.60161604295534
curr_Factors:  [101.60161604]
mat_Sqrt:  [[0.15]]
grads:  [-0.05036956]
Stock Position:  -0.05036956268264492
Bond Position:  [2.96424634]


portfolio before change:  [-2.14442708]
curr_Stock_Price:  101.42749745100193
curr_Factors:  [101.42749745]
mat_Sqrt:  [[0.15]]
grads:  [-0.01194967]
Stock Position:  -0.011949665677261677
Bond Position:  [-0.9324024]


portfolio before change:  [-2.14025205]
curr_Stock_Price:  101.07323547714076
curr_Factors:  [101.07323548]
mat_Sqrt:  [[0.15]]
grads:  [-0.04052381]
Stock Position:  -0.04052381317559103
Bond Position:  [1.95562086]


portfolio before change:  [-2.13988414]
curr_Stock_Price:  101.0671730031685
curr_Factors:  [101.067173]
mat_Sqrt:  [[0.15]]
grads:  [-0.00621167]
Stock Position:  -0.006211674496802702
Bond Position:  [-1.51208776]


portfolio before change:  [-2.14082947]
curr_Stock_Price:  101.20414307322704
curr_Factors:  [101.20414307]
mat_Sqrt:  [[0.15]]
grads:  [0.03535347]
Stock Position:  0.03535346925210336
Bond Position:  [-5.71874703]


portfolio before change:  [-2.14458914]
curr_Stock_Price:  101.10790800831748
curr_Factors:  [101.10790801]
mat_Sqrt:  [[0.15]]
grads:  [0.02790722]
Stock Position:  0.027907223333687368
Bond Position:  [-4.96623011]


portfolio before change:  [-2.12745356]
curr_Stock_Price:  101.73305011917002
curr_Factors:  [101.73305012]
mat_Sqrt:  [[0.15]]
grads:  [-0.00697534]
Stock Position:  -0.006975340794417989
Bond Position:  [-1.41783087]


portfolio before change:  [-2.13002612]
curr_Stock_Price:  102.08915369744147
curr_Factors:  [102.0891537]
mat_Sqrt:  [[0.15]]
grads:  [0.05957871]
Stock Position:  0.059578712168719336
Bond Position:  [-8.21236643]


portfolio before change:  [-2.17743339]
curr_Stock_Price:  101.30206087587183
curr_Factors:  [101.30206088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367315]
Stock Position:  -0.0036731470853537023
Bond Position:  [-1.80533602]


portfolio before change:  [-2.17534925]
curr_Stock_Price:  100.70394320817505
curr_Factors:  [100.70394321]
mat_Sqrt:  [[0.15]]
grads:  [0.01037271]
Stock Position:  0.010372705557134088
Bond Position:  [-3.2199216]


portfolio before change:  [-2.1768249]
curr_Stock_Price:  100.58108224633986
curr_Factors:  [100.58108225]
mat_Sqrt:  [[0.15]]
grads:  [0.00990632]
Stock Position:  0.009906322431808928
Bond Position:  [-3.17321353]


portfolio before change:  [-2.17109695]
curr_Stock_Price:  101.17931514628629
curr_Factors:  [101.17931515]
mat_Sqrt:  [[0.15]]
grads:  [0.00217048]
Stock Position:  0.0021704770684774152
Bond Position:  [-2.39070433]


portfolio before change:  [-2.17019068]
curr_Stock_Price:  101.66570330532623
curr_Factors:  [101.66570331]
mat_Sqrt:  [[0.15]]
grads:  [-0.0110869]
Stock Position:  -0.011086904823139898
Bond Position:  [-1.0430327]


portfolio before change:  [-2.1651186]
curr_Stock_Price:  101.20234011764762
curr_Factors:  [101.20234012]
mat_Sqrt:  [[0.15]]
grads:  [-0.04259031]
Stock Position:  -0.04259030665822768
Bond Position:  [2.1451201]


portfolio before change:  [-2.15419038]
curr_Stock_Price:  100.94889869916302
curr_Factors:  [100.9488987]
mat_Sqrt:  [[0.15]]
grads:  [-0.08896384]
Stock Position:  -0.08896384260107672
Bond Position:  [6.82661155]


portfolio before change:  [-2.17995818]
curr_Stock_Price:  101.24333821167805
curr_Factors:  [101.24333821]
mat_Sqrt:  [[0.15]]
grads:  [-0.03545361]
Stock Position:  -0.03545361147467181
Bond Position:  [1.4094838]


portfolio before change:  [-2.18137707]
curr_Stock_Price:  101.28584411865737
curr_Factors:  [101.28584412]
mat_Sqrt:  [[0.15]]
grads:  [-0.00390608]
Stock Position:  -0.003906077748424437
Bond Position:  [-1.78574669]


portfolio before change:  [-2.18339081]
curr_Stock_Price:  101.77281086739899
curr_Factors:  [101.77281087]
mat_Sqrt:  [[0.15]]
grads:  [-0.03667493]
Stock Position:  -0.03667493282609458
Bond Position:  [1.54912019]


portfolio before change:  [-2.22235589]
curr_Stock_Price:  102.83789532808365
curr_Factors:  [102.83789533]
mat_Sqrt:  [[0.15]]
grads:  [0.10025822]
Stock Position:  0.10025822004041733
Bond Position:  [-12.53270023]


portfolio before change:  [-2.14019868]
curr_Stock_Price:  103.66516438491271
curr_Factors:  [103.66516438]
mat_Sqrt:  [[0.15]]
grads:  [-0.05601167]
Stock Position:  -0.056011669212781445
Bond Position:  [3.66626021]


portfolio before change:  [-2.12034927]
curr_Stock_Price:  103.31487557976482
curr_Factors:  [103.31487558]
mat_Sqrt:  [[0.15]]
grads:  [0.04419678]
Stock Position:  0.0441967767119961
Bond Position:  [-6.68653376]


portfolio before change:  [-2.1358341]
curr_Stock_Price:  102.97397062087346
curr_Factors:  [102.97397062]
mat_Sqrt:  [[0.15]]
grads:  [-0.08320822]
Stock Position:  -0.08320821702716895
Bond Position:  [6.4324464]


portfolio before change:  [-2.21364989]
curr_Stock_Price:  103.913995936263
curr_Factors:  [103.91399594]
mat_Sqrt:  [[0.15]]
grads:  [0.08831049]
Stock Position:  0.08831049267519013
Bond Position:  [-11.39034606]


portfolio before change:  [-2.24197488]
curr_Stock_Price:  103.60131422532095
curr_Factors:  [103.60131423]
mat_Sqrt:  [[0.15]]
grads:  [0.00229289]
Stock Position:  0.0022928869071762083
Bond Position:  [-2.47952098]


portfolio before change:  [-2.24060436]
curr_Stock_Price:  104.26663281587386
curr_Factors:  [104.26663282]
mat_Sqrt:  [[0.15]]
grads:  [0.16463808]
Stock Position:  0.16463808470594607
Bond Position:  [-19.40686308]


portfolio before change:  [-2.18070677]
curr_Stock_Price:  104.63781393982882
curr_Factors:  [104.63781394]
mat_Sqrt:  [[0.15]]
grads:  [-0.16735911]
Stock Position:  -0.16735911120781438
Bond Position:  [15.33138477]


portfolio before change:  [-2.20693833]
curr_Stock_Price:  104.80027777234679
curr_Factors:  [104.80027777]
mat_Sqrt:  [[0.15]]
grads:  [0.01072448]
Stock Position:  0.010724479717058553
Bond Position:  [-3.33086679]


portfolio before change:  [-2.20489457]
curr_Stock_Price:  105.0102601444188
curr_Factors:  [105.01026014]
mat_Sqrt:  [[0.15]]
grads:  [0.00416042]
Stock Position:  0.004160420177314091
Bond Position:  [-2.64178137]


portfolio before change:  [-2.2108056]
curr_Stock_Price:  103.62916966288454
curr_Factors:  [103.62916966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04580188]
Stock Position:  -0.04580188240199937
Bond Position:  [2.53560544]


portfolio before change:  [-2.20606344]
curr_Stock_Price:  103.5290934055075
curr_Factors:  [103.52909341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.20606344]
Stock Price:  104.1101787905376
PL:  [-6.31624223]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-3.22624633e-04]
 [ 1.95269024e-03]
 [-1.95387141e-03]
 [ 8.49963225e-03]
 [ 4.55005215e-03]
 [ 2.44045833e-02]
 [ 1.64687434e-03]
 [-1.81215111e-02]
 [ 1.98731537e-02]
 [-3.65748707e-03]
 [ 1.59267438e-02]
 [-4.75456776e-02]
 [ 4.64709527e-02]
 [ 3.49984444e-03]
 [-6.90333386e-03]
 [ 2.14636155e-02]
 [ 1.07991983e-02]
 [-9.43489697e-03]
 [ 8.11396686e-04]
 [-5.58275596e-03]
 [ 1.40258741e-02]
 [-4.04436806e-03]
 [ 1.10904907e-02]
 [-7.19001287e-03]
 [ 4.85482783e-03]
 [ 9.00288602e-03]
 [-5.51824438e-03]
 [ 8.04223197e-03]
 [ 1.72331943e-02]
 [-2.89166071e-03]
 [ 4.69641765e-03]
 [-1.21197600e-02]
 [ 5.04171538e-03]
 [ 7.79092314e-03]
 [ 1.14271205e-02]
 [ 9.95202375e-03]
 [-3.42326681e-02]
 [ 9.73782041e-03]
 [-5.25886384e-03]
 [ 2.46423993e-02]
 [-6.34880061e-03]
 [-1.23920588e-02]
 [ 2.28901208e-02]
 [ 1.85899405e-03]
 [-2.38309007e-03]
 [-4.76292630e-03]
 [ 1.30788317e-02]
 [ 4.38829131e-03]
 [-2.41106715e-03]
 [-7.43444849e-03]
 [-5.44415616e-03]
 [-7.86683338e-03]
 [ 1.12641202e-03]
 [ 5.35946981e-03]
 [ 5.81431539e-03]
 [-2.87428710e-03]
 [ 6.73814624e-03]
 [-6.52219354e-05]
 [ 1.55528745e-03]
 [-7.78195913e-03]
 [ 9.00849938e-04]
 [-1.19116543e-02]
 [-8.49840489e-03]
 [-1.26705089e-02]
 [ 1.42562843e-03]
 [ 1.12071073e-03]
 [-5.43204402e-03]
 [ 1.50482980e-02]
 [-8.28765892e-03]
 [ 1.09373558e-02]
 [-1.17167426e-02]
 [ 1.22202464e-02]
 [-2.21666600e-04]
 [ 1.80835487e-02]
 [-2.24873603e-02]
 [-4.27106168e-03]
 [-8.41041844e-03]
 [-1.64599071e-03]
 [ 3.05672248e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.50820846]
curr_Stock_Price:  100.61556733773816
curr_Factors:  [100.61556734]
mat_Sqrt:  [[0.15]]
grads:  [-0.00215083]
Stock Position:  -0.002150830889971027
Bond Position:  [11.72461553]


portfolio before change:  [11.5087588]
curr_Stock_Price:  100.70040484652178
curr_Factors:  [100.70040485]
mat_Sqrt:  [[0.15]]
grads:  [0.01301793]
Stock Position:  0.013017934931613413
Bond Position:  [10.19784748]


portfolio before change:  [11.50640633]
curr_Stock_Price:  100.47073304880259
curr_Factors:  [100.47073305]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302581]
Stock Position:  -0.013025809422242558
Bond Position:  [12.81511896]


portfolio before change:  [11.52000624]
curr_Stock_Price:  99.48815050152115
curr_Factors:  [99.4881505]
mat_Sqrt:  [[0.15]]
grads:  [0.05666422]
Stock Position:  0.05666421503144711
Bond Position:  [5.88258828]


portfolio before change:  [11.55402402]
curr_Stock_Price:  100.08200170384356
curr_Factors:  [100.0820017]
mat_Sqrt:  [[0.15]]
grads:  [0.03033368]
Stock Position:  0.03033368100732803
Bond Position:  [8.51816851]


portfolio before change:  [11.55300669]
curr_Stock_Price:  100.0309121222183
curr_Factors:  [100.03091212]
mat_Sqrt:  [[0.15]]
grads:  [0.16269722]
Stock Position:  0.1626972216712709
Bond Position:  [-4.72174479]


portfolio before change:  [11.56040637]
curr_Stock_Price:  100.07820732963917
curr_Factors:  [100.07820733]
mat_Sqrt:  [[0.15]]
grads:  [0.01097916]
Stock Position:  0.010979162273489832
Bond Position:  [10.46163149]


portfolio before change:  [11.54939135]
curr_Stock_Price:  99.01538519181777
curr_Factors:  [99.01538519]
mat_Sqrt:  [[0.15]]
grads:  [-0.12081007]
Stock Position:  -0.12081007427964637
Bond Position:  [23.51144739]


portfolio before change:  [11.42902508]
curr_Stock_Price:  100.02387539068414
curr_Factors:  [100.02387539]
mat_Sqrt:  [[0.15]]
grads:  [0.13248769]
Stock Position:  0.13248769127635115
Bond Position:  [-1.82290724]


portfolio before change:  [11.42149586]
curr_Stock_Price:  99.96790577289414
curr_Factors:  [99.96790577]
mat_Sqrt:  [[0.15]]
grads:  [-0.02438325]
Stock Position:  -0.02438324710074117
Bond Position:  [13.85903801]


portfolio before change:  [11.40694227]
curr_Stock_Price:  100.60029918387596
curr_Factors:  [100.60029918]
mat_Sqrt:  [[0.15]]
grads:  [0.10617829]
Stock Position:  0.10617829180204037
Bond Position:  [0.72537435]


portfolio before change:  [11.48540506]
curr_Stock_Price:  101.33884421822529
curr_Factors:  [101.33884422]
mat_Sqrt:  [[0.15]]
grads:  [-0.31697118]
Stock Position:  -0.31697118402667335
Bond Position:  [43.6068985]


portfolio before change:  [11.42086451]
curr_Stock_Price:  101.55105930664541
curr_Factors:  [101.55105931]
mat_Sqrt:  [[0.15]]
grads:  [0.30980635]
Stock Position:  0.3098063511877774
Bond Position:  [-20.04029863]


portfolio before change:  [11.33187245]
curr_Stock_Price:  101.26785175235997
curr_Factors:  [101.26785175]
mat_Sqrt:  [[0.15]]
grads:  [0.0233323]
Stock Position:  0.02333229625934827
Bond Position:  [8.96906093]


portfolio before change:  [11.33276167]
curr_Stock_Price:  101.28193659819242
curr_Factors:  [101.2819366]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602223]
Stock Position:  -0.0460222257041948
Bond Position:  [15.99398181]


portfolio before change:  [11.32591715]
curr_Stock_Price:  101.45237970040351
curr_Factors:  [101.4523797]
mat_Sqrt:  [[0.15]]
grads:  [0.14309077]
Stock Position:  0.14309077028552447
Bond Position:  [-3.19098201]


portfolio before change:  [11.36611682]
curr_Stock_Price:  101.73471177400691
curr_Factors:  [101.73471177]
mat_Sqrt:  [[0.15]]
grads:  [0.07199466]
Stock Position:  0.07199465517822606
Bond Position:  [4.04176133]


portfolio before change:  [11.40478707]
curr_Stock_Price:  102.26832960731572
curr_Factors:  [102.26832961]
mat_Sqrt:  [[0.15]]
grads:  [-0.06289931]
Stock Position:  -0.06289931312768517
Bond Position:  [17.83739476]


portfolio before change:  [11.45046299]
curr_Stock_Price:  101.55987919141192
curr_Factors:  [101.55987919]
mat_Sqrt:  [[0.15]]
grads:  [0.00540931]
Stock Position:  0.0054093112413082945
Bond Position:  [10.90109399]


portfolio before change:  [11.45197431]
curr_Stock_Price:  101.71331551330222
curr_Factors:  [101.71331551]
mat_Sqrt:  [[0.15]]
grads:  [-0.03721837]
Stock Position:  -0.03721837306279788
Bond Position:  [15.23757844]


portfolio before change:  [11.4330702]
curr_Stock_Price:  102.24682871239014
curr_Factors:  [102.24682871]
mat_Sqrt:  [[0.15]]
grads:  [0.09350583]
Stock Position:  0.09350582718579495
Bond Position:  [1.8723959]


portfolio before change:  [11.39423847]
curr_Stock_Price:  101.83029037240449
curr_Factors:  [101.83029037]
mat_Sqrt:  [[0.15]]
grads:  [-0.02696245]
Stock Position:  -0.02696245370646069
Bond Position:  [14.13983296]


portfolio before change:  [11.3761311]
curr_Stock_Price:  102.53464497118695
curr_Factors:  [102.53464497]
mat_Sqrt:  [[0.15]]
grads:  [0.0739366]
Stock Position:  0.07393660498660735
Bond Position:  [3.79506756]


portfolio before change:  [11.35729556]
curr_Stock_Price:  102.27668412884344
curr_Factors:  [102.27668413]
mat_Sqrt:  [[0.15]]
grads:  [-0.04793342]
Stock Position:  -0.04793341916350123
Bond Position:  [16.25976673]


portfolio before change:  [11.33512614]
curr_Stock_Price:  102.76039013675009
curr_Factors:  [102.76039014]
mat_Sqrt:  [[0.15]]
grads:  [0.03236552]
Stock Position:  0.032365518849949544
Bond Position:  [8.0092328]


portfolio before change:  [11.32084161]
curr_Stock_Price:  102.30357316501313
curr_Factors:  [102.30357317]
mat_Sqrt:  [[0.15]]
grads:  [0.06001924]
Stock Position:  0.06001924011049275
Bond Position:  [5.18065889]


portfolio before change:  [11.26965601]
curr_Stock_Price:  101.4453582293528
curr_Factors:  [101.44535823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0367883]
Stock Position:  -0.036788295846200504
Bond Position:  [15.00165786]


portfolio before change:  [11.27535852]
curr_Stock_Price:  101.31583660020296
curr_Factors:  [101.3158366]
mat_Sqrt:  [[0.15]]
grads:  [0.05361488]
Stock Position:  0.05361487977197658
Bond Position:  [5.84332212]


portfolio before change:  [11.27887648]
curr_Stock_Price:  101.374640047038
curr_Factors:  [101.37464005]
mat_Sqrt:  [[0.15]]
grads:  [0.11488796]
Stock Position:  0.11488796179921819
Bond Position:  [-0.36784929]


portfolio before change:  [11.22467218]
curr_Stock_Price:  100.90303875930427
curr_Factors:  [100.90303876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927774]
Stock Position:  -0.019277738099340923
Bond Position:  [13.16985453]


portfolio before change:  [11.23685656]
curr_Stock_Price:  100.31369378141346
curr_Factors:  [100.31369378]
mat_Sqrt:  [[0.15]]
grads:  [0.03130945]
Stock Position:  0.03130945097313764
Bond Position:  [8.09608988]


portfolio before change:  [11.23961039]
curr_Stock_Price:  100.38548716966442
curr_Factors:  [100.38548717]
mat_Sqrt:  [[0.15]]
grads:  [-0.0807984]
Stock Position:  -0.08079840004448638
Bond Position:  [19.35059714]


portfolio before change:  [11.23820033]
curr_Stock_Price:  100.417907451682
curr_Factors:  [100.41790745]
mat_Sqrt:  [[0.15]]
grads:  [0.03361144]
Stock Position:  0.03361143584283566
Bond Position:  [7.86301028]


portfolio before change:  [11.26663652]
curr_Stock_Price:  101.2493129662677
curr_Factors:  [101.24931297]
mat_Sqrt:  [[0.15]]
grads:  [0.05193949]
Stock Position:  0.051939487609606205
Bond Position:  [6.00779908]


portfolio before change:  [11.26196848]
curr_Stock_Price:  101.15220882413844
curr_Factors:  [101.15220882]
mat_Sqrt:  [[0.15]]
grads:  [0.0761808]
Stock Position:  0.07618080302334836
Bond Position:  [3.55611198]


portfolio before change:  [11.22092862]
curr_Stock_Price:  100.61057473309079
curr_Factors:  [100.61057473]
mat_Sqrt:  [[0.15]]
grads:  [0.06634683]
Stock Position:  0.0663468250087562
Bond Position:  [4.54573643]


portfolio before change:  [11.22746754]
curr_Stock_Price:  100.7048489698963
curr_Factors:  [100.70484897]
mat_Sqrt:  [[0.15]]
grads:  [-0.22821779]
Stock Position:  -0.22821778729871967
Bond Position:  [34.21010534]


portfolio before change:  [11.32151951]
curr_Stock_Price:  100.30210310291166
curr_Factors:  [100.3021031]
mat_Sqrt:  [[0.15]]
grads:  [0.0649188]
Stock Position:  0.06491880275152334
Bond Position:  [4.81002706]


portfolio before change:  [11.32421798]
curr_Stock_Price:  100.33903902693432
curr_Factors:  [100.33903903]
mat_Sqrt:  [[0.15]]
grads:  [-0.03505909]
Stock Position:  -0.0350590922661852
Bond Position:  [14.8420136]


portfolio before change:  [11.35032185]
curr_Stock_Price:  99.62093097585878
curr_Factors:  [99.62093098]
mat_Sqrt:  [[0.15]]
grads:  [0.16428266]
Stock Position:  0.16428266193106755
Bond Position:  [-5.01566988]


portfolio before change:  [11.4532632]
curr_Stock_Price:  100.24945037361603
curr_Factors:  [100.24945037]
mat_Sqrt:  [[0.15]]
grads:  [-0.04232534]
Stock Position:  -0.04232533741452545
Bond Position:  [15.69635501]


portfolio before change:  [11.45828397]
curr_Stock_Price:  100.15400588881933
curr_Factors:  [100.15400589]
mat_Sqrt:  [[0.15]]
grads:  [-0.08261373]
Stock Position:  -0.08261372549275603
Bond Position:  [19.73237952]


portfolio before change:  [11.39629781]
curr_Stock_Price:  100.91924765857442
curr_Factors:  [100.91924766]
mat_Sqrt:  [[0.15]]
grads:  [0.15260081]
Stock Position:  0.1526008051389368
Bond Position:  [-4.00406064]


portfolio before change:  [11.46937772]
curr_Stock_Price:  101.39978357514622
curr_Factors:  [101.39978358]
mat_Sqrt:  [[0.15]]
grads:  [0.01239329]
Stock Position:  0.012393293640915896
Bond Position:  [10.21270042]


portfolio before change:  [11.48233259]
curr_Stock_Price:  102.39359180011259
curr_Factors:  [102.3935918]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588727]
Stock Position:  -0.01588726715444261
Bond Position:  [13.10908694]


portfolio before change:  [11.49702464]
curr_Stock_Price:  101.52039530512877
curr_Factors:  [101.52039531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03175284]
Stock Position:  -0.03175284200889026
Bond Position:  [14.72058571]


portfolio before change:  [11.48293774]
curr_Stock_Price:  101.99301338636647
curr_Factors:  [101.99301339]
mat_Sqrt:  [[0.15]]
grads:  [0.08719221]
Stock Position:  0.08719221132680179
Bond Position:  [2.58994136]


portfolio before change:  [11.56999364]
curr_Stock_Price:  102.9895935231392
curr_Factors:  [102.98959352]
mat_Sqrt:  [[0.15]]
grads:  [0.02925528]
Stock Position:  0.02925527542950103
Bond Position:  [8.55700471]


portfolio before change:  [11.55312798]
curr_Stock_Price:  102.39481234047697
curr_Factors:  [102.39481234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607378]
Stock Position:  -0.016073780981262803
Bond Position:  [13.19899977]


portfolio before change:  [11.55242211]
curr_Stock_Price:  102.4900504586379
curr_Factors:  [102.49005046]
mat_Sqrt:  [[0.15]]
grads:  [-0.04956299]
Stock Position:  -0.049562989939574205
Bond Position:  [16.63213545]


portfolio before change:  [11.60184482]
curr_Stock_Price:  101.51385477204988
curr_Factors:  [101.51385477]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629437]
Stock Position:  -0.03629437436857146
Bond Position:  [15.28622667]


portfolio before change:  [11.63354264]
curr_Stock_Price:  100.66682546509392
curr_Factors:  [100.66682547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05244556]
Stock Position:  -0.05244555586362659
Bond Position:  [16.91307026]


portfolio before change:  [11.64531714]
curr_Stock_Price:  100.4624726596313
curr_Factors:  [100.46247266]
mat_Sqrt:  [[0.15]]
grads:  [0.00750941]
Stock Position:  0.007509413456927098
Bond Position:  [10.89090289]


portfolio before change:  [11.64517864]
curr_Stock_Price:  100.35338266221197
curr_Factors:  [100.35338266]
mat_Sqrt:  [[0.15]]
grads:  [0.0357298]
Stock Position:  0.035729798728029394
Bond Position:  [8.05957248]


portfolio before change:  [11.62109546]
curr_Stock_Price:  99.66524770583445
curr_Factors:  [99.66524771]
mat_Sqrt:  [[0.15]]
grads:  [0.0387621]
Stock Position:  0.03876210259941316
Bond Position:  [7.7578609]


portfolio before change:  [11.63097586]
curr_Stock_Price:  99.90763716395492
curr_Factors:  [99.90763716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916191]
Stock Position:  -0.01916191397978325
Bond Position:  [13.54539741]


portfolio before change:  [11.64250538]
curr_Stock_Price:  99.35012998422143
curr_Factors:  [99.35012998]
mat_Sqrt:  [[0.15]]
grads:  [0.04492097]
Stock Position:  0.044920974957132466
Bond Position:  [7.17960068]


portfolio before change:  [11.64156785]
curr_Stock_Price:  99.31926978383872
curr_Factors:  [99.31926978]
mat_Sqrt:  [[0.15]]
grads:  [-0.00043481]
Stock Position:  -0.00043481290253034443
Bond Position:  [11.68475315]


portfolio before change:  [11.64215233]
curr_Stock_Price:  99.65467664759628
curr_Factors:  [99.65467665]
mat_Sqrt:  [[0.15]]
grads:  [0.01036858]
Stock Position:  0.010368583003973482
Bond Position:  [10.60887454]


portfolio before change:  [11.64645262]
curr_Stock_Price:  100.00546902349731
curr_Factors:  [100.00546902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05187973]
Stock Position:  -0.051879727536749735
Bond Position:  [16.83470911]


portfolio before change:  [11.61467912]
curr_Stock_Price:  100.63819615218104
curr_Factors:  [100.63819615]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [11.0102797]


portfolio before change:  [11.61532316]
curr_Stock_Price:  100.63085037376007
curr_Factors:  [100.63085037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07941103]
Stock Position:  -0.07941102885831354
Bond Position:  [19.60652253]


portfolio before change:  [11.62261665]
curr_Stock_Price:  100.55443734219483
curr_Factors:  [100.55443734]
mat_Sqrt:  [[0.15]]
grads:  [-0.05665603]
Stock Position:  -0.05665603258106086
Bond Position:  [17.31963213]


portfolio before change:  [11.56038636]
curr_Stock_Price:  101.67193170015327
curr_Factors:  [101.6719317]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447006]
Stock Position:  -0.08447005937177712
Bond Position:  [20.14862047]


portfolio before change:  [11.49073257]
curr_Stock_Price:  102.51143765333674
curr_Factors:  [102.51143765]
mat_Sqrt:  [[0.15]]
grads:  [0.00950419]
Stock Position:  0.009504189556505001
Bond Position:  [10.51644444]


portfolio before change:  [11.49240162]
curr_Stock_Price:  102.61789099418625
curr_Factors:  [102.61789099]
mat_Sqrt:  [[0.15]]
grads:  [0.0074714]
Stock Position:  0.007471404885378448
Bond Position:  [10.72570181]


portfolio before change:  [11.49384607]
curr_Stock_Price:  102.72149471931132
curr_Factors:  [102.72149472]
mat_Sqrt:  [[0.15]]
grads:  [-0.03621363]
Stock Position:  -0.03621362679272092
Bond Position:  [15.21376394]


portfolio before change:  [11.49996754]
curr_Stock_Price:  102.57871473512617
curr_Factors:  [102.57871474]
mat_Sqrt:  [[0.15]]
grads:  [0.10032199]
Stock Position:  0.10032198661584972
Bond Position:  [1.20906709]


portfolio before change:  [11.54248549]
curr_Stock_Price:  103.00177639079112
curr_Factors:  [103.00177639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05525106]
Stock Position:  -0.05525105947354312
Bond Position:  [17.23344276]


portfolio before change:  [11.5682667]
curr_Stock_Price:  102.55465225362613
curr_Factors:  [102.55465225]
mat_Sqrt:  [[0.15]]
grads:  [0.07291571]
Stock Position:  0.0729157055062439
Bond Position:  [4.09042188]


portfolio before change:  [11.55634956]
curr_Stock_Price:  102.38770881867677
curr_Factors:  [102.38770882]
mat_Sqrt:  [[0.15]]
grads:  [-0.07811162]
Stock Position:  -0.078111617429842
Bond Position:  [19.5540191]


portfolio before change:  [11.55214401]
curr_Stock_Price:  102.4571953841746
curr_Factors:  [102.45719538]
mat_Sqrt:  [[0.15]]
grads:  [0.08146831]
Stock Position:  0.08146830945150729
Bond Position:  [3.20512952]


portfolio before change:  [11.52297448]
curr_Stock_Price:  102.0966888058848
curr_Factors:  [102.09668881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00147778]
Stock Position:  -0.0014777773302140514
Bond Position:  [11.67385065]


portfolio before change:  [11.52497436]
curr_Stock_Price:  101.2371262114438
curr_Factors:  [101.23712621]
mat_Sqrt:  [[0.15]]
grads:  [0.12055699]
Stock Position:  0.12055699115930558
Bond Position:  [-0.67986897]


portfolio before change:  [11.50033889]
curr_Stock_Price:  101.0331315988401
curr_Factors:  [101.0331316]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991574]
Stock Position:  -0.14991573541593653
Bond Position:  [26.64679512]


portfolio before change:  [11.642226]
curr_Stock_Price:  100.09779525477242
curr_Factors:  [100.09779525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847374]
Stock Position:  -0.028473744551308126
Bond Position:  [14.49238506]


portfolio before change:  [11.62664959]
curr_Stock_Price:  100.67665171547341
curr_Factors:  [100.67665172]
mat_Sqrt:  [[0.15]]
grads:  [-0.05606946]
Stock Position:  -0.05606945627484437
Bond Position:  [17.27153472]


portfolio before change:  [11.57337809]
curr_Stock_Price:  101.64600310273696
curr_Factors:  [101.6460031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01097327]
Stock Position:  -0.010973271416401512
Bond Position:  [12.68876727]


portfolio before change:  [11.56154822]
curr_Stock_Price:  102.7963386355879
curr_Factors:  [102.79633864]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.56154822]
Stock Price:  103.58810973747316
PL:  [7.97343849]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.91787754e-04]
 [ 2.67135568e-03]
 [-7.64563596e-05]
 [ 7.22057813e-03]
 [ 6.12718886e-03]
 [ 2.75133335e-02]
 [ 1.54234085e-03]
 [-1.50478339e-02]
 [ 2.21026675e-02]
 [-3.37312627e-03]
 [ 1.44135897e-02]
 [ 2.29211896e-02]
 [-9.69772830e-03]
 [ 1.23313743e-02]
 [-6.91491956e-03]
 [ 1.14011666e-02]
 [ 7.67312491e-03]
 [-1.22440983e-02]
 [-3.47234842e-04]
 [-2.86616857e-03]
 [ 1.25808437e-02]
 [-7.24137423e-03]
 [ 1.10910863e-02]
 [-9.41642334e-03]
 [ 8.13543802e-04]
 [ 1.37184019e-02]
 [-6.73666037e-03]
 [ 7.17841516e-03]
 [ 7.36744885e-03]
 [-3.34139671e-03]
 [ 7.65118883e-03]
 [-1.20071146e-02]
 [ 8.57072734e-03]
 [ 7.03190899e-03]
 [ 1.12996795e-02]
 [ 8.58225804e-03]
 [-3.33375459e-02]
 [ 9.45212437e-03]
 [ 8.60623658e-03]
 [ 1.95304413e-02]
 [-5.44907560e-03]
 [-1.88031668e-02]
 [ 2.10848395e-02]
 [-1.26626966e-03]
 [ 4.38257232e-03]
 [-1.63957042e-02]
 [ 1.46007478e-02]
 [ 7.31133668e-03]
 [-1.36552082e-03]
 [-7.56483307e-03]
 [-2.65033927e-02]
 [ 2.21738636e-03]
 [-8.77022733e-03]
 [ 5.58983541e-03]
 [ 1.28046144e-04]
 [ 2.27905214e-03]
 [ 9.30571419e-03]
 [-5.63279622e-04]
 [ 1.64117657e-03]
 [ 1.59578868e-02]
 [-1.49444022e-03]
 [ 1.15855944e-02]
 [ 3.90174987e-03]
 [-1.24980180e-02]
 [ 9.94007964e-03]
 [ 4.54562268e-03]
 [-5.25508428e-03]
 [ 1.54222309e-02]
 [-1.12435580e-02]
 [-1.15505072e-02]
 [-1.24651820e-02]
 [ 1.35121666e-02]
 [ 1.37677351e-03]
 [ 2.19953405e-02]
 [-2.24876215e-02]
 [-1.10807129e-03]
 [-1.01930713e-02]
 [-1.83732060e-03]
 [ 2.25371967e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.03317651]
curr_Stock_Price:  100.77975328138477
curr_Factors:  [100.77975328]
mat_Sqrt:  [[0.15]]
grads:  [-0.00194525]
Stock Position:  -0.0019452516925376705
Bond Position:  [14.2292185]


portfolio before change:  [14.03483713]
curr_Stock_Price:  100.38326906470282
curr_Factors:  [100.38326906]
mat_Sqrt:  [[0.15]]
grads:  [0.01780904]
Stock Position:  0.01780903788687207
Bond Position:  [12.24710768]


portfolio before change:  [14.03166926]
curr_Stock_Price:  100.16240740663564
curr_Factors:  [100.16240741]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050971]
Stock Position:  -0.0005097090643148283
Bond Position:  [14.08272295]


portfolio before change:  [14.0325267]
curr_Stock_Price:  100.2070541377242
curr_Factors:  [100.20705414]
mat_Sqrt:  [[0.15]]
grads:  [0.04813719]
Stock Position:  0.04813718754005102
Bond Position:  [9.20884094]


portfolio before change:  [14.05552323]
curr_Stock_Price:  100.67282610208751
curr_Factors:  [100.6728261]
mat_Sqrt:  [[0.15]]
grads:  [0.04084793]
Stock Position:  0.040847925744327766
Bond Position:  [9.9432471]


portfolio before change:  [14.07685363]
curr_Stock_Price:  101.17980253546149
curr_Factors:  [101.17980254]
mat_Sqrt:  [[0.15]]
grads:  [0.18342222]
Stock Position:  0.18342222361846125
Bond Position:  [-4.48177073]


portfolio before change:  [14.07486908]
curr_Stock_Price:  101.170510134365
curr_Factors:  [101.17051013]
mat_Sqrt:  [[0.15]]
grads:  [0.01028227]
Stock Position:  0.010282272333184492
Bond Position:  [13.03460634]


portfolio before change:  [14.06712851]
curr_Stock_Price:  100.33847033928852
curr_Factors:  [100.33847034]
mat_Sqrt:  [[0.15]]
grads:  [-0.10031889]
Stock Position:  -0.10031889271098554
Bond Position:  [24.13297275]


portfolio before change:  [14.07673584]
curr_Stock_Price:  100.25773802058902
curr_Factors:  [100.25773802]
mat_Sqrt:  [[0.15]]
grads:  [0.14735112]
Stock Position:  0.14735111687563124
Bond Position:  [-0.69635383]


portfolio before change:  [14.0189093]
curr_Stock_Price:  99.8655929207536
curr_Factors:  [99.86559292]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248751]
Stock Position:  -0.0224875084546764
Bond Position:  [16.26463767]


portfolio before change:  [14.02980815]
curr_Stock_Price:  99.42613670966962
curr_Factors:  [99.42613671]
mat_Sqrt:  [[0.15]]
grads:  [0.0960906]
Stock Position:  0.09609059797110023
Bond Position:  [4.47589122]


portfolio before change:  [13.94284565]
curr_Stock_Price:  98.51822005777618
curr_Factors:  [98.51822006]
mat_Sqrt:  [[0.15]]
grads:  [0.15280793]
Stock Position:  0.15280793035855333
Bond Position:  [-1.11151966]


portfolio before change:  [14.1033148]
curr_Stock_Price:  99.56881099327383
curr_Factors:  [99.56881099]
mat_Sqrt:  [[0.15]]
grads:  [-0.06465152]
Stock Position:  -0.06465152202242896
Bond Position:  [20.54058998]


portfolio before change:  [14.10651838]
curr_Stock_Price:  99.53911717484479
curr_Factors:  [99.53911717]
mat_Sqrt:  [[0.15]]
grads:  [0.08220916]
Stock Position:  0.08220916209878248
Bond Position:  [5.92349096]


portfolio before change:  [14.20196518]
curr_Stock_Price:  100.69563752027584
curr_Factors:  [100.69563752]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609946]
Stock Position:  -0.04609946370195063
Bond Position:  [18.84398006]


portfolio before change:  [14.24283465]
curr_Stock_Price:  99.8346365027308
curr_Factors:  [99.8346365]
mat_Sqrt:  [[0.15]]
grads:  [0.07600778]
Stock Position:  0.07600777755488229
Bond Position:  [6.6546258]


portfolio before change:  [14.27003465]
curr_Stock_Price:  100.18702242863088
curr_Factors:  [100.18702243]
mat_Sqrt:  [[0.15]]
grads:  [0.05115417]
Stock Position:  0.051154166091327384
Bond Position:  [9.14505106]


portfolio before change:  [14.27601926]
curr_Stock_Price:  100.29284034764123
curr_Factors:  [100.29284035]
mat_Sqrt:  [[0.15]]
grads:  [-0.08162732]
Stock Position:  -0.08162732182683005
Bond Position:  [22.46265521]


portfolio before change:  [14.26051013]
curr_Stock_Price:  100.50003918346962
curr_Factors:  [100.50003918]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023149]
Stock Position:  -0.0023148989441464443
Bond Position:  [14.49315757]


portfolio before change:  [14.25976267]
curr_Stock_Price:  101.21424265203352
curr_Factors:  [101.21424265]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910779]
Stock Position:  -0.019107790461120433
Bond Position:  [16.19374321]


portfolio before change:  [14.26039925]
curr_Stock_Price:  101.2338974182971
curr_Factors:  [101.23389742]
mat_Sqrt:  [[0.15]]
grads:  [0.08387229]
Stock Position:  0.08387229148408067
Bond Position:  [5.7696803]


portfolio before change:  [14.37239878]
curr_Stock_Price:  102.56495577134412
curr_Factors:  [102.56495577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04827583]
Stock Position:  -0.048275828191463935
Bond Position:  [19.32380697]


portfolio before change:  [14.37293923]
curr_Stock_Price:  102.57877898314001
curr_Factors:  [102.57877898]
mat_Sqrt:  [[0.15]]
grads:  [0.07394058]
Stock Position:  0.07394057530203611
Bond Position:  [6.7882053]


portfolio before change:  [14.35744027]
curr_Stock_Price:  102.36342713776247
curr_Factors:  [102.36342714]
mat_Sqrt:  [[0.15]]
grads:  [-0.06277616]
Stock Position:  -0.06277615562945926
Bond Position:  [20.7834227]


portfolio before change:  [14.44918208]
curr_Stock_Price:  100.92270811474543
curr_Factors:  [100.92270811]
mat_Sqrt:  [[0.15]]
grads:  [0.00542363]
Stock Position:  0.005423625345331284
Bond Position:  [13.90181512]


portfolio before change:  [14.44973018]
curr_Stock_Price:  100.86356219288417
curr_Factors:  [100.86356219]
mat_Sqrt:  [[0.15]]
grads:  [0.09145601]
Stock Position:  0.09145601269532762
Bond Position:  [5.22515096]


portfolio before change:  [14.41211658]
curr_Stock_Price:  100.44871590445359
curr_Factors:  [100.4487159]
mat_Sqrt:  [[0.15]]
grads:  [-0.04491107]
Stock Position:  -0.04491106914173299
Bond Position:  [18.9233758]


portfolio before change:  [14.39075858]
curr_Stock_Price:  100.95061313366054
curr_Factors:  [100.95061313]
mat_Sqrt:  [[0.15]]
grads:  [0.0478561]
Stock Position:  0.047856101052167095
Bond Position:  [9.55965584]


portfolio before change:  [14.37613282]
curr_Stock_Price:  100.6325081971729
curr_Factors:  [100.6325082]
mat_Sqrt:  [[0.15]]
grads:  [0.04911633]
Stock Position:  0.049116325672407535
Bond Position:  [9.43343377]


portfolio before change:  [14.37465984]
curr_Stock_Price:  100.59051423829219
curr_Factors:  [100.59051424]
mat_Sqrt:  [[0.15]]
grads:  [-0.02227598]
Stock Position:  -0.022275978043021658
Bond Position:  [16.61541192]


portfolio before change:  [14.36993705]
curr_Stock_Price:  100.84914645761158
curr_Factors:  [100.84914646]
mat_Sqrt:  [[0.15]]
grads:  [0.05100793]
Stock Position:  0.05100792555281616
Bond Position:  [9.22583129]


portfolio before change:  [14.36985068]
curr_Stock_Price:  100.83614857037632
curr_Factors:  [100.83614857]
mat_Sqrt:  [[0.15]]
grads:  [-0.08004743]
Stock Position:  -0.08004743046607195
Bond Position:  [22.44152528]


portfolio before change:  [14.3667222]
curr_Stock_Price:  100.89275399295708
curr_Factors:  [100.89275399]
mat_Sqrt:  [[0.15]]
grads:  [0.05713818]
Stock Position:  0.05713818227091043
Bond Position:  [8.60189364]


portfolio before change:  [14.35886716]
curr_Stock_Price:  100.7458700682124
curr_Factors:  [100.74587007]
mat_Sqrt:  [[0.15]]
grads:  [0.04687939]
Stock Position:  0.04687939325441831
Bond Position:  [9.6359619]


portfolio before change:  [14.39085835]
curr_Stock_Price:  101.41543773365777
curr_Factors:  [101.41543773]
mat_Sqrt:  [[0.15]]
grads:  [0.0753312]
Stock Position:  0.07533119690300237
Bond Position:  [6.75111204]


portfolio before change:  [14.40187191]
curr_Stock_Price:  101.55603818838601
curr_Factors:  [101.55603819]
mat_Sqrt:  [[0.15]]
grads:  [0.05721505]
Stock Position:  0.05721505361439488
Bond Position:  [8.59133774]


portfolio before change:  [14.45404238]
curr_Stock_Price:  102.45848410330399
curr_Factors:  [102.4584841]
mat_Sqrt:  [[0.15]]
grads:  [-0.22225031]
Stock Position:  -0.2222503057283439
Bond Position:  [37.22547179]


portfolio before change:  [14.53189855]
curr_Stock_Price:  102.11864425186967
curr_Factors:  [102.11864425]
mat_Sqrt:  [[0.15]]
grads:  [0.06301416]
Stock Position:  0.06301416248210144
Bond Position:  [8.09697771]


portfolio before change:  [14.58668209]
curr_Stock_Price:  102.9799976587814
curr_Factors:  [102.97999766]
mat_Sqrt:  [[0.15]]
grads:  [0.05737491]
Stock Position:  0.057374910565635914
Bond Position:  [8.67821394]


portfolio before change:  [14.54808815]
curr_Stock_Price:  102.29788158547672
curr_Factors:  [102.29788159]
mat_Sqrt:  [[0.15]]
grads:  [0.13020294]
Stock Position:  0.1302029419849457
Bond Position:  [1.22860301]


portfolio before change:  [14.45144327]
curr_Stock_Price:  101.55502838454105
curr_Factors:  [101.55502838]
mat_Sqrt:  [[0.15]]
grads:  [-0.03632717]
Stock Position:  -0.036327170640677565
Bond Position:  [18.14065011]


portfolio before change:  [14.45805802]
curr_Stock_Price:  101.40415165492058
curr_Factors:  [101.40415165]
mat_Sqrt:  [[0.15]]
grads:  [-0.12535445]
Stock Position:  -0.12535444562349116
Bond Position:  [27.16951923]


portfolio before change:  [14.34162259]
curr_Stock_Price:  102.34654800548242
curr_Factors:  [102.34654801]
mat_Sqrt:  [[0.15]]
grads:  [0.1405656]
Stock Position:  0.1405655963403651
Bond Position:  [-0.04478096]


portfolio before change:  [14.45711683]
curr_Stock_Price:  103.16820733960955
curr_Factors:  [103.16820734]
mat_Sqrt:  [[0.15]]
grads:  [-0.0084418]
Stock Position:  -0.008441797757354388
Bond Position:  [15.32804197]


portfolio before change:  [14.45491977]
curr_Stock_Price:  103.54195377591985
curr_Factors:  [103.54195378]
mat_Sqrt:  [[0.15]]
grads:  [0.02921715]
Stock Position:  0.02921714879578519
Bond Position:  [11.4297191]


portfolio before change:  [14.46835819]
curr_Stock_Price:  103.97745283009003
curr_Factors:  [103.97745283]
mat_Sqrt:  [[0.15]]
grads:  [-0.10930469]
Stock Position:  -0.10930469480216981
Bond Position:  [25.83358194]


portfolio before change:  [14.51963412]
curr_Stock_Price:  103.52311480676583
curr_Factors:  [103.52311481]
mat_Sqrt:  [[0.15]]
grads:  [0.09733832]
Stock Position:  0.09733831854480268
Bond Position:  [4.44286819]


portfolio before change:  [14.51482345]
curr_Stock_Price:  103.47083982207161
curr_Factors:  [103.47083982]
mat_Sqrt:  [[0.15]]
grads:  [0.04874224]
Stock Position:  0.04874224453384821
Bond Position:  [9.47142247]


portfolio before change:  [14.46811504]
curr_Stock_Price:  102.50042107275358
curr_Factors:  [102.50042107]
mat_Sqrt:  [[0.15]]
grads:  [-0.00910347]
Stock Position:  -0.009103472139212436
Bond Position:  [15.40122477]


portfolio before change:  [14.47766091]
curr_Stock_Price:  101.55756575300606
curr_Factors:  [101.55756575]
mat_Sqrt:  [[0.15]]
grads:  [-0.05043222]
Stock Position:  -0.05043222046627317
Bond Position:  [19.59943445]


portfolio before change:  [14.44769164]
curr_Stock_Price:  102.17610427955127
curr_Factors:  [102.17610428]
mat_Sqrt:  [[0.15]]
grads:  [-0.17668928]
Stock Position:  -0.17668928494799518
Bond Position:  [32.50111444]


portfolio before change:  [14.35907408]
curr_Stock_Price:  102.68914583384644
curr_Factors:  [102.68914583]
mat_Sqrt:  [[0.15]]
grads:  [0.01478258]
Stock Position:  0.01478257571295569
Bond Position:  [12.841064]


portfolio before change:  [14.37172498]
curr_Stock_Price:  103.49065133748174
curr_Factors:  [103.49065134]
mat_Sqrt:  [[0.15]]
grads:  [-0.05846818]
Stock Position:  -0.05846818220645966
Bond Position:  [20.42263524]


portfolio before change:  [14.42518279]
curr_Stock_Price:  102.59817698363203
curr_Factors:  [102.59817698]
mat_Sqrt:  [[0.15]]
grads:  [0.03726557]
Stock Position:  0.0372655694175247
Bond Position:  [10.6018033]


portfolio before change:  [14.40454297]
curr_Stock_Price:  102.02653802114322
curr_Factors:  [102.02653802]
mat_Sqrt:  [[0.15]]
grads:  [0.00085364]
Stock Position:  0.0008536409575757587
Bond Position:  [14.31744894]


portfolio before change:  [14.40567395]
curr_Stock_Price:  102.30313035694004
curr_Factors:  [102.30313036]
mat_Sqrt:  [[0.15]]
grads:  [0.01519368]
Stock Position:  0.015193680959671996
Bond Position:  [12.85131283]


portfolio before change:  [14.40859496]
curr_Stock_Price:  102.44251557681518
curr_Factors:  [102.44251558]
mat_Sqrt:  [[0.15]]
grads:  [0.06203809]
Stock Position:  0.062038094581906615
Bond Position:  [8.05325649]


portfolio before change:  [14.40310571]
curr_Stock_Price:  102.34592021128668
curr_Factors:  [102.34592021]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037552]
Stock Position:  -0.0037551974808649447
Bond Position:  [14.78743485]


portfolio before change:  [14.40493202]
curr_Stock_Price:  102.10570215728384
curr_Factors:  [102.10570216]
mat_Sqrt:  [[0.15]]
grads:  [0.01094118]
Stock Position:  0.010941177113583259
Bond Position:  [13.28777545]


portfolio before change:  [14.41002579]
curr_Stock_Price:  102.49535451075488
curr_Factors:  [102.49535451]
mat_Sqrt:  [[0.15]]
grads:  [0.10638591]
Stock Position:  0.1063859120680654
Bond Position:  [3.50596401]


portfolio before change:  [14.34813865]
curr_Stock_Price:  101.91157167979951
curr_Factors:  [101.91157168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00996293]
Stock Position:  -0.009962934782587994
Bond Position:  [15.36347699]


portfolio before change:  [14.34366478]
curr_Stock_Price:  102.45700472552527
curr_Factors:  [102.45700473]
mat_Sqrt:  [[0.15]]
grads:  [0.0772373]
Stock Position:  0.07723729611565379
Bond Position:  [6.43016277]


portfolio before change:  [14.45858599]
curr_Stock_Price:  103.93969914829522
curr_Factors:  [103.93969915]
mat_Sqrt:  [[0.15]]
grads:  [0.02601167]
Stock Position:  0.02601166582391427
Bond Position:  [11.75494127]


portfolio before change:  [14.46297086]
curr_Stock_Price:  104.08002734274856
curr_Factors:  [104.08002734]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332012]
Stock Position:  -0.08332012005793969
Bond Position:  [23.13493124]


portfolio before change:  [14.45292059]
curr_Stock_Price:  104.21800419831247
curr_Factors:  [104.2180042]
mat_Sqrt:  [[0.15]]
grads:  [0.0662672]
Stock Position:  0.06626719759086178
Bond Position:  [7.54668552]


portfolio before change:  [14.48095772]
curr_Stock_Price:  104.63397832374673
curr_Factors:  [104.63397832]
mat_Sqrt:  [[0.15]]
grads:  [0.03030415]
Stock Position:  0.030304151207975704
Bond Position:  [11.31011382]


portfolio before change:  [14.490285]
curr_Stock_Price:  104.91844037129042
curr_Factors:  [104.91844037]
mat_Sqrt:  [[0.15]]
grads:  [-0.0350339]
Stock Position:  -0.035033895169502484
Bond Position:  [18.16598664]


portfolio before change:  [14.48195967]
curr_Stock_Price:  105.18848564520802
curr_Factors:  [105.18848565]
mat_Sqrt:  [[0.15]]
grads:  [0.10281487]
Stock Position:  0.10281487235087401
Bond Position:  [3.66701895]


portfolio before change:  [14.51855555]
curr_Stock_Price:  105.54219594914339
curr_Factors:  [105.54219595]
mat_Sqrt:  [[0.15]]
grads:  [-0.07495705]
Stock Position:  -0.07495705340111979
Bond Position:  [22.42968757]


portfolio before change:  [14.55816761]
curr_Stock_Price:  105.0324352361751
curr_Factors:  [105.03243524]
mat_Sqrt:  [[0.15]]
grads:  [-0.07700338]
Stock Position:  -0.07700338132306582
Bond Position:  [22.64602027]


portfolio before change:  [14.59779387]
curr_Stock_Price:  104.5362123489068
curr_Factors:  [104.53621235]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310121]
Stock Position:  -0.08310121347794032
Bond Position:  [23.28487997]


portfolio before change:  [14.62148602]
curr_Stock_Price:  104.26862540311056
curr_Factors:  [104.2686254]
mat_Sqrt:  [[0.15]]
grads:  [0.09008111]
Stock Position:  0.09008111061408211
Bond Position:  [5.22885244]


portfolio before change:  [14.54817099]
curr_Stock_Price:  103.4511194977888
curr_Factors:  [103.4511195]
mat_Sqrt:  [[0.15]]
grads:  [0.00917849]
Stock Position:  0.00917849007098397
Bond Position:  [13.59864592]


portfolio before change:  [14.54332517]
curr_Stock_Price:  102.83056331081178
curr_Factors:  [102.83056331]
mat_Sqrt:  [[0.15]]
grads:  [0.1466356]
Stock Position:  0.14663560324651337
Bond Position:  [-0.53529652]


portfolio before change:  [14.56998156]
curr_Stock_Price:  103.01257814299524
curr_Factors:  [103.01257814]
mat_Sqrt:  [[0.15]]
grads:  [-0.14991748]
Stock Position:  -0.14991747641334563
Bond Position:  [30.01336732]


portfolio before change:  [14.60531977]
curr_Stock_Price:  102.78937328854808
curr_Factors:  [102.78937329]
mat_Sqrt:  [[0.15]]
grads:  [-0.00738714]
Stock Position:  -0.007387141944543429
Bond Position:  [15.36463946]


portfolio before change:  [14.60956625]
curr_Stock_Price:  102.34452462147667
curr_Factors:  [102.34452462]
mat_Sqrt:  [[0.15]]
grads:  [-0.06795381]
Stock Position:  -0.06795380858708017
Bond Position:  [21.56426648]


portfolio before change:  [14.64088265]
curr_Stock_Price:  101.90351041265289
curr_Factors:  [101.90351041]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122488]
Stock Position:  -0.012248803971466424
Bond Position:  [15.88907877]


portfolio before change:  [14.64144188]
curr_Stock_Price:  101.93893143608803
curr_Factors:  [101.93893144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.64144188]
Stock Price:  101.40211431809219
PL:  [13.23932757]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 7.89401402e-03]
 [ 1.90694160e-03]
 [-7.47737914e-04]
 [ 7.19195014e-03]
 [ 7.34559728e-04]
 [ 1.31627104e-02]
 [ 3.79313565e-03]
 [-2.75198176e-02]
 [-2.22631399e-02]
 [ 3.56961052e-02]
 [-5.62722890e-02]
 [ 3.16042565e-02]
 [-2.95902069e-03]
 [-5.36301925e-03]
 [-7.13937312e-03]
 [ 9.88328566e-03]
 [ 1.87976224e-02]
 [ 5.35855238e-02]
 [ 3.18679313e-03]
 [ 1.76017399e-02]
 [ 1.33345153e-02]
 [-1.26782086e-02]
 [-3.96919450e-03]
 [-1.52978873e-01]
 [-1.41848298e-02]
 [ 3.26909595e-03]
 [ 5.20147096e-03]
 [ 1.53579413e-02]
 [-7.63088329e-02]
 [ 8.24678051e-03]
 [ 2.15130140e-02]
 [-1.63778597e-02]
 [-5.60151551e-03]
 [ 9.23293768e-03]
 [ 1.42934278e-02]
 [-1.22078246e-02]
 [-2.47661708e-02]
 [ 6.79183676e-03]
 [-6.12948435e-02]
 [-2.64263381e-02]
 [-1.79208846e-02]
 [ 9.12085954e-02]
 [ 2.38558538e-02]
 [ 1.65108557e-03]
 [ 1.99583438e-02]
 [ 6.09366489e-02]
 [-9.85214290e-03]
 [ 1.69842041e-02]
 [ 5.37255714e-02]
 [ 1.21716059e-02]
 [ 2.60147404e-02]
 [ 3.15197311e-02]
 [-3.17071574e-03]
 [ 3.91128263e-03]
 [ 5.47620769e-03]
 [ 1.02758787e-02]
 [-4.50350877e-02]
 [ 2.19765265e-03]
 [ 1.67427694e-03]
 [-1.74770261e-01]
 [-2.23254631e-02]
 [ 1.64429851e-02]
 [ 2.13520212e-02]
 [-2.09809937e-02]
 [-1.04525981e-02]
 [-1.10304344e-02]
 [-2.34975065e-03]
 [-3.16899300e-02]
 [-3.32040575e-02]
 [ 2.21825834e-02]
 [ 3.46068008e-02]
 [ 1.48192574e-02]
 [-5.66975716e-03]
 [ 1.64754293e-02]
 [ 4.40820515e-02]
 [-3.57349198e-02]
 [ 3.34495444e-03]
 [ 1.36077089e-02]
 [ 1.60080557e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.29828452]
curr_Stock_Price:  99.00252615152111
curr_Factors:  [99.00252615]
mat_Sqrt:  [[0.15]]
grads:  [0.05262676]
Stock Position:  0.052626760121964905
Bond Position:  [-18.50846671]


portfolio before change:  [-13.25057073]
curr_Stock_Price:  99.9311526608663
curr_Factors:  [99.93115266]
mat_Sqrt:  [[0.15]]
grads:  [0.01271294]
Stock Position:  0.012712943971721272
Bond Position:  [-14.52098987]


portfolio before change:  [-13.25688724]
curr_Stock_Price:  99.50568706536079
curr_Factors:  [99.50568707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498492]
Stock Position:  -0.004984919423830058
Bond Position:  [-12.76085941]


portfolio before change:  [-13.25491887]
curr_Stock_Price:  98.95082330861243
curr_Factors:  [98.95082331]
mat_Sqrt:  [[0.15]]
grads:  [0.04794633]
Stock Position:  0.04794633426158732
Bond Position:  [-17.99924812]


portfolio before change:  [-13.25200309]
curr_Stock_Price:  99.0351001297856
curr_Factors:  [99.03510013]
mat_Sqrt:  [[0.15]]
grads:  [0.00489706]
Stock Position:  0.004897064851477823
Bond Position:  [-13.7369844]


portfolio before change:  [-13.25675148]
curr_Stock_Price:  98.24078665949133
curr_Factors:  [98.24078666]
mat_Sqrt:  [[0.15]]
grads:  [0.0877514]
Stock Position:  0.08775140272147826
Bond Position:  [-21.87751832]


portfolio before change:  [-13.29184144]
curr_Stock_Price:  97.85649002781096
curr_Factors:  [97.85649003]
mat_Sqrt:  [[0.15]]
grads:  [0.02528757]
Stock Position:  0.025287571005125797
Bond Position:  [-15.76639438]


portfolio before change:  [-13.30550182]
curr_Stock_Price:  97.35525758944512
curr_Factors:  [97.35525759]
mat_Sqrt:  [[0.15]]
grads:  [-0.18346545]
Stock Position:  -0.1834654507370719
Bond Position:  [4.55582439]


portfolio before change:  [-13.35178052]
curr_Stock_Price:  97.60905713636504
curr_Factors:  [97.60905714]
mat_Sqrt:  [[0.15]]
grads:  [-0.14842093]
Stock Position:  -0.1484209326144526
Bond Position:  [1.13544677]


portfolio before change:  [-13.27374269]
curr_Stock_Price:  97.0837480843858
curr_Factors:  [97.08374808]
mat_Sqrt:  [[0.15]]
grads:  [0.23797403]
Stock Position:  0.2379740347232697
Bond Position:  [-36.37715393]


portfolio before change:  [-13.18659367]
curr_Stock_Price:  97.4595145792225
curr_Factors:  [97.45951458]
mat_Sqrt:  [[0.15]]
grads:  [-0.37514859]
Stock Position:  -0.37514859363245473
Bond Position:  [23.37520616]


portfolio before change:  [-13.03308632]
curr_Stock_Price:  97.0542182329851
curr_Factors:  [97.05421823]
mat_Sqrt:  [[0.15]]
grads:  [0.21069504]
Stock Position:  0.21069504361046734
Bond Position:  [-33.48192906]


portfolio before change:  [-13.39385505]
curr_Stock_Price:  95.35187136727185
curr_Factors:  [95.35187137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197268]
Stock Position:  -0.019726804570362213
Bond Position:  [-11.51286732]


portfolio before change:  [-13.39906082]
curr_Stock_Price:  95.57928755431705
curr_Factors:  [95.57928755]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575346]
Stock Position:  -0.03575346163384881
Bond Position:  [-9.98177043]


portfolio before change:  [-13.39752888]
curr_Stock_Price:  95.51899055760963
curr_Factors:  [95.51899056]
mat_Sqrt:  [[0.15]]
grads:  [-0.04759582]
Stock Position:  -0.047595820818204945
Bond Position:  [-8.85122412]


portfolio before change:  [-13.39614043]
curr_Stock_Price:  95.47819561936545
curr_Factors:  [95.47819562]
mat_Sqrt:  [[0.15]]
grads:  [0.06588857]
Stock Position:  0.06588857103623212
Bond Position:  [-19.6870623]


portfolio before change:  [-13.41085102]
curr_Stock_Price:  95.27360597989576
curr_Factors:  [95.27360598]
mat_Sqrt:  [[0.15]]
grads:  [0.12531748]
Stock Position:  0.1253174827064835
Bond Position:  [-25.35029949]


portfolio before change:  [-13.52869275]
curr_Stock_Price:  94.34590399332978
curr_Factors:  [94.34590399]
mat_Sqrt:  [[0.15]]
grads:  [0.35723683]
Stock Position:  0.3572368250256152
Bond Position:  [-47.23252394]


portfolio before change:  [-13.48461167]
curr_Stock_Price:  94.47756232374721
curr_Factors:  [94.47756232]
mat_Sqrt:  [[0.15]]
grads:  [0.02124529]
Stock Position:  0.021245287557783984
Bond Position:  [-15.49181465]


portfolio before change:  [-13.47474696]
curr_Stock_Price:  94.98746269599158
curr_Factors:  [94.9874627]
mat_Sqrt:  [[0.15]]
grads:  [0.11734493]
Stock Position:  0.11734493271244512
Bond Position:  [-24.62104437]


portfolio before change:  [-13.51069656]
curr_Stock_Price:  94.69421831756587
curr_Factors:  [94.69421832]
mat_Sqrt:  [[0.15]]
grads:  [0.08889677]
Stock Position:  0.08889676896816869
Bond Position:  [-21.92870661]


portfolio before change:  [-13.50750977]
curr_Stock_Price:  94.74548430157337
curr_Factors:  [94.7454843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08452139]
Stock Position:  -0.0845213904714134
Bond Position:  [-5.49948969]


portfolio before change:  [-13.50002323]
curr_Stock_Price:  94.65284185958032
curr_Factors:  [94.65284186]
mat_Sqrt:  [[0.15]]
grads:  [-0.0264613]
Stock Position:  -0.026461296681518517
Bond Position:  [-10.9953863]


portfolio before change:  [-13.48920891]
curr_Stock_Price:  94.21818632583924
curr_Factors:  [94.21818633]
mat_Sqrt:  [[0.15]]
grads:  [-1.01985915]
Stock Position:  -1.019859151037571
Bond Position:  [82.60007061]


portfolio before change:  [-12.9867345]
curr_Stock_Price:  93.730558455213
curr_Factors:  [93.73055846]
mat_Sqrt:  [[0.15]]
grads:  [-0.09456553]
Stock Position:  -0.09456553204411951
Bond Position:  [-4.12305437]


portfolio before change:  [-12.98782883]
curr_Stock_Price:  93.73940559466332
curr_Factors:  [93.73940559]
mat_Sqrt:  [[0.15]]
grads:  [0.02179397]
Stock Position:  0.021793972982351965
Bond Position:  [-15.03078291]


portfolio before change:  [-12.97791913]
curr_Stock_Price:  94.23721102271874
curr_Factors:  [94.23721102]
mat_Sqrt:  [[0.15]]
grads:  [0.03467647]
Stock Position:  0.03467647303822033
Bond Position:  [-16.24573324]


portfolio before change:  [-12.97419419]
curr_Stock_Price:  94.37391257222104
curr_Factors:  [94.37391257]
mat_Sqrt:  [[0.15]]
grads:  [0.10238628]
Stock Position:  0.10238627539125504
Bond Position:  [-22.63678759]


portfolio before change:  [-12.93176155]
curr_Stock_Price:  94.80216811142209
curr_Factors:  [94.80216811]
mat_Sqrt:  [[0.15]]
grads:  [-0.50872555]
Stock Position:  -0.5087255526349843
Bond Position:  [35.29652382]


portfolio before change:  [-12.61781265]
curr_Stock_Price:  94.18937641307427
curr_Factors:  [94.18937641]
mat_Sqrt:  [[0.15]]
grads:  [0.05497854]
Stock Position:  0.05497853675113238
Bond Position:  [-17.79620674]


portfolio before change:  [-12.62670658]
curr_Stock_Price:  94.04783683821911
curr_Factors:  [94.04783684]
mat_Sqrt:  [[0.15]]
grads:  [0.14342009]
Stock Position:  0.1434200930501142
Bond Position:  [-26.1150561]


portfolio before change:  [-12.75474595]
curr_Stock_Price:  93.16646016955893
curr_Factors:  [93.16646017]
mat_Sqrt:  [[0.15]]
grads:  [-0.10918573]
Stock Position:  -0.1091857312227664
Bond Position:  [-2.58229787]


portfolio before change:  [-12.72049015]
curr_Stock_Price:  92.85124315863837
curr_Factors:  [92.85124316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03734344]
Stock Position:  -0.03734343676134387
Bond Position:  [-9.25310562]


portfolio before change:  [-12.72308759]
curr_Stock_Price:  92.90531154147303
curr_Factors:  [92.90531154]
mat_Sqrt:  [[0.15]]
grads:  [0.06155292]
Stock Position:  0.0615529178665138
Bond Position:  [-18.4416806]


portfolio before change:  [-12.76654008]
curr_Stock_Price:  92.21810036205594
curr_Factors:  [92.21810036]
mat_Sqrt:  [[0.15]]
grads:  [0.09528952]
Stock Position:  0.09528951867810645
Bond Position:  [-21.55395848]


portfolio before change:  [-12.78271739]
curr_Stock_Price:  92.0624678914407
curr_Factors:  [92.06246789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0813855]
Stock Position:  -0.08138549722617171
Bond Position:  [-5.29016766]


portfolio before change:  [-12.79073553]
curr_Stock_Price:  92.15692575229664
curr_Factors:  [92.15692575]
mat_Sqrt:  [[0.15]]
grads:  [-0.16510781]
Stock Position:  -0.16510780563614705
Bond Position:  [2.42509225]


portfolio before change:  [-12.82134423]
curr_Stock_Price:  92.34322987653844
curr_Factors:  [92.34322988]
mat_Sqrt:  [[0.15]]
grads:  [0.04527891]
Stock Position:  0.04527891175698786
Bond Position:  [-17.00254518]


portfolio before change:  [-12.83154555]
curr_Stock_Price:  92.14140014582573
curr_Factors:  [92.14140015]
mat_Sqrt:  [[0.15]]
grads:  [-0.40863229]
Stock Position:  -0.4086322898246122
Bond Position:  [24.82040578]


portfolio before change:  [-12.74795431]
curr_Stock_Price:  91.94063306267095
curr_Factors:  [91.94063306]
mat_Sqrt:  [[0.15]]
grads:  [-0.17617559]
Stock Position:  -0.17617558758429047
Bond Position:  [3.44974074]


portfolio before change:  [-12.79253337]
curr_Stock_Price:  92.19489460320007
curr_Factors:  [92.1948946]
mat_Sqrt:  [[0.15]]
grads:  [-0.11947256]
Stock Position:  -0.1194725643049066
Bond Position:  [-1.7777729]


portfolio before change:  [-12.73684275]
curr_Stock_Price:  91.72782719657191
curr_Factors:  [91.7278272]
mat_Sqrt:  [[0.15]]
grads:  [0.6080573]
Stock Position:  0.6080573024964628
Bond Position:  [-68.51261792]


portfolio before change:  [-12.98588858]
curr_Stock_Price:  91.32529332436776
curr_Factors:  [91.32529332]
mat_Sqrt:  [[0.15]]
grads:  [0.15903903]
Stock Position:  0.15903902560473954
Bond Position:  [-27.51017424]


portfolio before change:  [-12.95975008]
curr_Stock_Price:  91.5004575184969
curr_Factors:  [91.50045752]
mat_Sqrt:  [[0.15]]
grads:  [0.01100724]
Stock Position:  0.01100723714681256
Bond Position:  [-13.96691731]


portfolio before change:  [-12.96453257]
curr_Stock_Price:  91.14527856463862
curr_Factors:  [91.14527856]
mat_Sqrt:  [[0.15]]
grads:  [0.13305563]
Stock Position:  0.1330556250045837
Bond Position:  [-25.09192458]


portfolio before change:  [-13.0816268]
curr_Stock_Price:  90.27702565836049
curr_Factors:  [90.27702566]
mat_Sqrt:  [[0.15]]
grads:  [0.40624433]
Stock Position:  0.40624432620116396
Bond Position:  [-49.75615626]


portfolio before change:  [-13.18728021]
curr_Stock_Price:  90.02460724974938
curr_Factors:  [90.02460725]
mat_Sqrt:  [[0.15]]
grads:  [-0.06568095]
Stock Position:  -0.06568095266190488
Bond Position:  [-7.27437824]


portfolio before change:  [-13.20761238]
curr_Stock_Price:  90.32724465428765
curr_Factors:  [90.32724465]
mat_Sqrt:  [[0.15]]
grads:  [0.11322803]
Stock Position:  0.11322802708447452
Bond Position:  [-23.43518809]


portfolio before change:  [-13.16021762]
curr_Stock_Price:  90.75875885192306
curr_Factors:  [90.75875885]
mat_Sqrt:  [[0.15]]
grads:  [0.35817048]
Stock Position:  0.3581704762658498
Bond Position:  [-45.66732551]


portfolio before change:  [-13.00541277]
curr_Stock_Price:  91.19893792266396
curr_Factors:  [91.19893792]
mat_Sqrt:  [[0.15]]
grads:  [0.08114404]
Stock Position:  0.08114403915152409
Bond Position:  [-20.40566296]


portfolio before change:  [-13.03460107]
curr_Stock_Price:  90.85494594838175
curr_Factors:  [90.85494595]
mat_Sqrt:  [[0.15]]
grads:  [0.1734316]
Stock Position:  0.17343160247124062
Bond Position:  [-28.79171993]


portfolio before change:  [-13.02801856]
curr_Stock_Price:  90.9032764746298
curr_Factors:  [90.90327647]
mat_Sqrt:  [[0.15]]
grads:  [0.21013154]
Stock Position:  0.21013154082205207
Bond Position:  [-32.12966412]


portfolio before change:  [-12.99472115]
curr_Stock_Price:  91.07129302838725
curr_Factors:  [91.07129303]
mat_Sqrt:  [[0.15]]
grads:  [-0.0211381]
Stock Position:  -0.02113810491615916
Bond Position:  [-11.06964661]


portfolio before change:  [-12.99666324]
curr_Stock_Price:  91.1304378780874
curr_Factors:  [91.13043788]
mat_Sqrt:  [[0.15]]
grads:  [0.02607522]
Stock Position:  0.026075217545381408
Bond Position:  [-15.37290923]


portfolio before change:  [-13.00937825]
curr_Stock_Price:  90.67965821364503
curr_Factors:  [90.67965821]
mat_Sqrt:  [[0.15]]
grads:  [0.03650805]
Stock Position:  0.0365080512345884
Bond Position:  [-16.31991586]


portfolio before change:  [-13.02346341]
curr_Stock_Price:  90.32178851717077
curr_Factors:  [90.32178852]
mat_Sqrt:  [[0.15]]
grads:  [0.06850586]
Stock Position:  0.0685058582088981
Bond Position:  [-19.21103504]


portfolio before change:  [-13.04150028]
curr_Stock_Price:  90.07602635970449
curr_Factors:  [90.07602636]
mat_Sqrt:  [[0.15]]
grads:  [-0.30023392]
Stock Position:  -0.3002339176840305
Bond Position:  [14.002378]


portfolio before change:  [-13.0906466]
curr_Stock_Price:  90.24263478443012
curr_Factors:  [90.24263478]
mat_Sqrt:  [[0.15]]
grads:  [0.01465102]
Stock Position:  0.01465101764474925
Bond Position:  [-14.41279304]


portfolio before change:  [-13.08037905]
curr_Stock_Price:  91.0049288989
curr_Factors:  [91.0049289]
mat_Sqrt:  [[0.15]]
grads:  [0.01116185]
Stock Position:  0.011161846279864275
Bond Position:  [-14.09616207]


portfolio before change:  [-13.08242004]
curr_Stock_Price:  90.90100703126554
curr_Factors:  [90.90100703]
mat_Sqrt:  [[0.15]]
grads:  [-1.16513507]
Stock Position:  -1.1651350748449507
Bond Position:  [92.82953159]


portfolio before change:  [-12.86855184]
curr_Stock_Price:  90.72243015947672
curr_Factors:  [90.72243016]
mat_Sqrt:  [[0.15]]
grads:  [-0.14883642]
Stock Position:  -0.1488364208286817
Bond Position:  [0.63424995]


portfolio before change:  [-12.88921574]
curr_Stock_Price:  90.86153278755134
curr_Factors:  [90.86153279]
mat_Sqrt:  [[0.15]]
grads:  [0.1096199]
Stock Position:  0.10961990076882462
Bond Position:  [-22.84944794]


portfolio before change:  [-12.97696913]
curr_Stock_Price:  90.07403656076862
curr_Factors:  [90.07403656]
mat_Sqrt:  [[0.15]]
grads:  [0.14234681]
Stock Position:  0.1423468080260634
Bond Position:  [-25.79872072]


portfolio before change:  [-12.98517319]
curr_Stock_Price:  90.027729977873
curr_Factors:  [90.02772998]
mat_Sqrt:  [[0.15]]
grads:  [-0.13987329]
Stock Position:  -0.13987329140089694
Bond Position:  [-0.39269828]


portfolio before change:  [-12.96052057]
curr_Stock_Price:  89.85130478327149
curr_Factors:  [89.85130478]
mat_Sqrt:  [[0.15]]
grads:  [-0.06968399]
Stock Position:  -0.06968398721634603
Bond Position:  [-6.69932339]


portfolio before change:  [-12.95856263]
curr_Stock_Price:  89.8171985621491
curr_Factors:  [89.81719856]
mat_Sqrt:  [[0.15]]
grads:  [-0.07353623]
Stock Position:  -0.07353622935856244
Bond Position:  [-6.35374452]


portfolio before change:  [-12.90907988]
curr_Stock_Price:  89.13889521411427
curr_Factors:  [89.13889521]
mat_Sqrt:  [[0.15]]
grads:  [-0.015665]
Stock Position:  -0.015665004329457725
Bond Position:  [-11.5127187]


portfolio before change:  [-12.89670311]
curr_Stock_Price:  88.30286976081447
curr_Factors:  [88.30286976]
mat_Sqrt:  [[0.15]]
grads:  [-0.2112662]
Stock Position:  -0.21126620002173163
Bond Position:  [5.75870864]


portfolio before change:  [-12.85761337]
curr_Stock_Price:  88.11954746717574
curr_Factors:  [88.11954747]
mat_Sqrt:  [[0.15]]
grads:  [-0.22136038]
Stock Position:  -0.22136038333954408
Bond Position:  [6.64856344]


portfolio before change:  [-12.8895725]
curr_Stock_Price:  88.26580073091861
curr_Factors:  [88.26580073]
mat_Sqrt:  [[0.15]]
grads:  [0.14788389]
Stock Position:  0.1478838890214387
Bond Position:  [-25.94266238]


portfolio before change:  [-13.01281001]
curr_Stock_Price:  87.44342551746755
curr_Factors:  [87.44342552]
mat_Sqrt:  [[0.15]]
grads:  [0.23071201]
Stock Position:  0.23071200517246132
Bond Position:  [-33.18705805]


portfolio before change:  [-13.02895741]
curr_Stock_Price:  87.38242679880112
curr_Factors:  [87.3824268]
mat_Sqrt:  [[0.15]]
grads:  [0.09879505]
Stock Position:  0.09879504913331186
Bond Position:  [-21.66190855]


portfolio before change:  [-12.98281991]
curr_Stock_Price:  87.86313315222596
curr_Factors:  [87.86313315]
mat_Sqrt:  [[0.15]]
grads:  [-0.03779838]
Stock Position:  -0.037798381052535995
Bond Position:  [-9.66173572]


portfolio before change:  [-13.03949067]
curr_Stock_Price:  89.34644764182963
curr_Factors:  [89.34644764]
mat_Sqrt:  [[0.15]]
grads:  [0.1098362]
Stock Position:  0.10983619547212015
Bond Position:  [-22.85296456]


portfolio before change:  [-13.0696261]
curr_Stock_Price:  89.08508503812038
curr_Factors:  [89.08508504]
mat_Sqrt:  [[0.15]]
grads:  [0.29388034]
Stock Position:  0.2938803432649771
Bond Position:  [-39.24998147]


portfolio before change:  [-13.20712542]
curr_Stock_Price:  88.62555747552136
curr_Factors:  [88.62555748]
mat_Sqrt:  [[0.15]]
grads:  [-0.2382328]
Stock Position:  -0.23823279867080277
Bond Position:  [7.90638917]


portfolio before change:  [-13.28535755]
curr_Stock_Price:  88.9560169900019
curr_Factors:  [88.95601699]
mat_Sqrt:  [[0.15]]
grads:  [0.0222997]
Stock Position:  0.022299696286099322
Bond Position:  [-15.26904971]


portfolio before change:  [-13.28272661]
curr_Stock_Price:  89.11679433262904
curr_Factors:  [89.11679433]
mat_Sqrt:  [[0.15]]
grads:  [0.09071806]
Stock Position:  0.09071805921226148
Bond Position:  [-21.36722923]


portfolio before change:  [-13.31059251]
curr_Stock_Price:  88.82434527885322
curr_Factors:  [88.82434528]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.31059251]
Stock Price:  87.55682422275574
PL:  [-13.31059251]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.89003521e-03]
 [-1.96710559e-02]
 [-6.42369417e-03]
 [ 6.82575071e-03]
 [ 4.44276785e-03]
 [ 2.27911920e-02]
 [ 1.61656082e-03]
 [-5.41581674e-03]
 [ 2.32944925e-02]
 [-4.63738515e-03]
 [ 3.37126991e-02]
 [-4.84802160e-02]
 [ 6.63199857e-02]
 [ 6.07362819e-03]
 [-6.89858699e-03]
 [ 2.63439798e-02]
 [ 1.16953789e-02]
 [-1.03995845e-02]
 [ 6.01202884e-03]
 [-7.53105759e-03]
 [ 1.45074332e-02]
 [-1.01433647e-02]
 [ 1.10090928e-02]
 [-3.43047572e-02]
 [ 5.76970353e-03]
 [ 6.95382619e-03]
 [-4.88113490e-03]
 [ 1.57231366e-02]
 [ 5.11549738e-02]
 [ 8.54278252e-03]
 [ 2.10937010e-02]
 [ 5.67578105e-03]
 [-2.88455375e-03]
 [ 7.14036729e-03]
 [ 9.38265360e-03]
 [ 3.52046623e-03]
 [-3.13972196e-02]
 [ 8.32701145e-03]
 [ 2.47762402e-02]
 [-2.01355979e-02]
 [-8.73333096e-03]
 [-9.67075744e-03]
 [ 1.91285425e-02]
 [-1.03872216e-02]
 [ 3.31738468e-02]
 [ 2.03482625e-03]
 [ 1.59558283e-02]
 [ 4.34950276e-02]
 [ 1.60364406e-02]
 [-7.85048421e-03]
 [ 8.91914135e-02]
 [ 2.44966198e-02]
 [-1.23343346e-02]
 [ 5.57964756e-03]
 [-3.62119350e-02]
 [ 5.55052377e-02]
 [ 2.40666198e-02]
 [ 3.27090788e-03]
 [ 2.27864913e-03]
 [-1.54883893e-02]
 [ 3.32197651e-02]
 [ 7.19224065e-02]
 [-1.41118076e-02]
 [-1.06506375e-02]
 [ 2.72265209e-02]
 [ 1.61337723e-02]
 [-2.58242136e-03]
 [ 1.65575418e-02]
 [-4.68472514e-02]
 [-1.05594021e-01]
 [ 1.53855460e-02]
 [ 2.11977043e-02]
 [-7.82838751e-02]
 [ 3.12679899e-02]
 [-3.10762425e-02]
 [ 1.43995800e-02]
 [ 2.35381366e-02]
 [-2.68829382e-02]
 [ 2.56180305e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.23936471]
curr_Stock_Price:  99.1364073275972
curr_Factors:  [99.13640733]
mat_Sqrt:  [[0.15]]
grads:  [0.04593357]
Stock Position:  0.04593356803858387
Bond Position:  [-15.79305362]


portfolio before change:  [-11.25138027]
curr_Stock_Price:  98.89631129298228
curr_Factors:  [98.89631129]
mat_Sqrt:  [[0.15]]
grads:  [-0.13114037]
Stock Position:  -0.1311403726604515
Bond Position:  [1.71791885]


portfolio before change:  [-11.19518933]
curr_Stock_Price:  98.46865074919194
curr_Factors:  [98.46865075]
mat_Sqrt:  [[0.15]]
grads:  [-0.04282463]
Stock Position:  -0.042824627766917964
Bond Position:  [-6.97830602]


portfolio before change:  [-11.20983222]
curr_Stock_Price:  98.80039267531966
curr_Factors:  [98.80039268]
mat_Sqrt:  [[0.15]]
grads:  [0.045505]
Stock Position:  0.04550500471043488
Bond Position:  [-15.70574455]


portfolio before change:  [-11.16086943]
curr_Stock_Price:  99.89795165506698
curr_Factors:  [99.89795166]
mat_Sqrt:  [[0.15]]
grads:  [0.02961845]
Stock Position:  0.02961845236150543
Bond Position:  [-14.11969215]


portfolio before change:  [-11.16542319]
curr_Stock_Price:  99.77400005945702
curr_Factors:  [99.77400006]
mat_Sqrt:  [[0.15]]
grads:  [0.15194128]
Stock Position:  0.15194128006682492
Bond Position:  [-26.32521248]


portfolio before change:  [-11.0923185]
curr_Stock_Price:  100.26596686349441
curr_Factors:  [100.26596686]
mat_Sqrt:  [[0.15]]
grads:  [0.01077707]
Stock Position:  0.010777072124249628
Bond Position:  [-12.17289206]


portfolio before change:  [-11.08408439]
curr_Stock_Price:  101.10060413321816
curr_Factors:  [101.10060413]
mat_Sqrt:  [[0.15]]
grads:  [-0.03610544]
Stock Position:  -0.036105444915077285
Bond Position:  [-7.43380209]


portfolio before change:  [-11.08578514]
curr_Stock_Price:  101.13484057810555
curr_Factors:  [101.13484058]
mat_Sqrt:  [[0.15]]
grads:  [0.15529662]
Stock Position:  0.15529661646730888
Bond Position:  [-26.79168369]


portfolio before change:  [-11.06811641]
curr_Stock_Price:  101.25939740858028
curr_Factors:  [101.25939741]
mat_Sqrt:  [[0.15]]
grads:  [-0.0309159]
Stock Position:  -0.030915901022637374
Bond Position:  [-7.93759091]


portfolio before change:  [-11.09345306]
curr_Stock_Price:  102.06288468855004
curr_Factors:  [102.06288469]
mat_Sqrt:  [[0.15]]
grads:  [0.22475133]
Stock Position:  0.22475132733132172
Bond Position:  [-34.03222187]


portfolio before change:  [-11.15385649]
curr_Stock_Price:  101.80359213506206
curr_Factors:  [101.80359214]
mat_Sqrt:  [[0.15]]
grads:  [-0.32320144]
Stock Position:  -0.3232014399255018
Bond Position:  [21.74921108]


portfolio before change:  [-11.23493189]
curr_Stock_Price:  102.05864907575476
curr_Factors:  [102.05864908]
mat_Sqrt:  [[0.15]]
grads:  [0.44213324]
Stock Position:  0.442133238198866
Bond Position:  [-56.35845289]


portfolio before change:  [-11.38307779]
curr_Stock_Price:  101.73154544298212
curr_Factors:  [101.73154544]
mat_Sqrt:  [[0.15]]
grads:  [0.04049085]
Stock Position:  0.04049085460370982
Bond Position:  [-15.50227501]


portfolio before change:  [-11.38124766]
curr_Stock_Price:  101.80067348959804
curr_Factors:  [101.80067349]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599058]
Stock Position:  -0.0459905799627697
Bond Position:  [-6.69937565]


portfolio before change:  [-11.40643871]
curr_Stock_Price:  102.33931251679186
curr_Factors:  [102.33931252]
mat_Sqrt:  [[0.15]]
grads:  [0.17562653]
Stock Position:  0.17562653201188627
Bond Position:  [-29.37993725]


portfolio before change:  [-11.34033242]
curr_Stock_Price:  102.72617086064695
curr_Factors:  [102.72617086]
mat_Sqrt:  [[0.15]]
grads:  [0.07796919]
Stock Position:  0.07796919260871958
Bond Position:  [-19.34980902]


portfolio before change:  [-11.40104258]
curr_Stock_Price:  101.96303924221786
curr_Factors:  [101.96303924]
mat_Sqrt:  [[0.15]]
grads:  [-0.06933056]
Stock Position:  -0.0693305634186795
Bond Position:  [-4.33188762]


portfolio before change:  [-11.45054114]
curr_Stock_Price:  102.67308407996718
curr_Factors:  [102.67308408]
mat_Sqrt:  [[0.15]]
grads:  [0.04008019]
Stock Position:  0.04008019225371597
Bond Position:  [-15.56569809]


portfolio before change:  [-11.42312144]
curr_Stock_Price:  103.38147849160309
curr_Factors:  [103.38147849]
mat_Sqrt:  [[0.15]]
grads:  [-0.05020705]
Stock Position:  -0.05020705057404296
Bond Position:  [-6.23264232]


portfolio before change:  [-11.42087623]
curr_Stock_Price:  103.32900055912442
curr_Factors:  [103.32900056]
mat_Sqrt:  [[0.15]]
grads:  [0.09671622]
Stock Position:  0.09671622121075062
Bond Position:  [-21.41446671]


portfolio before change:  [-11.43311795]
curr_Stock_Price:  103.2162658471583
curr_Factors:  [103.21626585]
mat_Sqrt:  [[0.15]]
grads:  [-0.06762243]
Stock Position:  -0.06762243152622935
Bond Position:  [-4.45338308]


portfolio before change:  [-11.44408645]
curr_Stock_Price:  103.37435177213092
curr_Factors:  [103.37435177]
mat_Sqrt:  [[0.15]]
grads:  [0.07339395]
Stock Position:  0.07339395170184528
Bond Position:  [-19.03113863]


portfolio before change:  [-11.44830359]
curr_Stock_Price:  103.33309961841148
curr_Factors:  [103.33309962]
mat_Sqrt:  [[0.15]]
grads:  [-0.22869838]
Stock Position:  -0.2286983811542694
Bond Position:  [12.18380901]


portfolio before change:  [-11.38537588]
curr_Stock_Price:  103.06127348074456
curr_Factors:  [103.06127348]
mat_Sqrt:  [[0.15]]
grads:  [0.03846469]
Stock Position:  0.038464690218275616
Bond Position:  [-15.34959584]


portfolio before change:  [-11.36886517]
curr_Stock_Price:  103.51545880645541
curr_Factors:  [103.51545881]
mat_Sqrt:  [[0.15]]
grads:  [0.04635884]
Stock Position:  0.04635884129302065
Bond Position:  [-16.16772189]


portfolio before change:  [-11.36508528]
curr_Stock_Price:  103.618791877584
curr_Factors:  [103.61879188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0325409]
Stock Position:  -0.032540899306333616
Bond Position:  [-7.99323661]


portfolio before change:  [-11.37456394]
curr_Stock_Price:  103.89472374257377
curr_Factors:  [103.89472374]
mat_Sqrt:  [[0.15]]
grads:  [0.10482091]
Stock Position:  0.10482091052083933
Bond Position:  [-22.26490348]


portfolio before change:  [-11.38969173]
curr_Stock_Price:  103.7636793690284
curr_Factors:  [103.76367937]
mat_Sqrt:  [[0.15]]
grads:  [0.34103316]
Stock Position:  0.34103315835505044
Bond Position:  [-46.77654703]


portfolio before change:  [-10.92577072]
curr_Stock_Price:  105.13259210618345
curr_Factors:  [105.13259211]
mat_Sqrt:  [[0.15]]
grads:  [0.05695188]
Stock Position:  0.05695188348008598
Bond Position:  [-16.91326986]


portfolio before change:  [-10.93067639]
curr_Stock_Price:  105.06501651364249
curr_Factors:  [105.06501651]
mat_Sqrt:  [[0.15]]
grads:  [0.14062467]
Stock Position:  0.14062467355543812
Bond Position:  [-25.70541004]


portfolio before change:  [-10.91186137]
curr_Stock_Price:  105.21023758526353
curr_Factors:  [105.21023759]
mat_Sqrt:  [[0.15]]
grads:  [0.03783854]
Stock Position:  0.03783854032724002
Bond Position:  [-14.89286318]


portfolio before change:  [-10.93253861]
curr_Stock_Price:  104.68837797500385
curr_Factors:  [104.68837798]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923036]
Stock Position:  -0.019230358316394983
Bond Position:  [-8.91934359]


portfolio before change:  [-10.94899202]
curr_Stock_Price:  105.51498434019746
curr_Factors:  [105.51498434]
mat_Sqrt:  [[0.15]]
grads:  [0.04760245]
Stock Position:  0.047602448591422215
Bond Position:  [-15.97176364]


portfolio before change:  [-10.89759769]
curr_Stock_Price:  106.6156124527562
curr_Factors:  [106.61561245]
mat_Sqrt:  [[0.15]]
grads:  [0.06255102]
Stock Position:  0.06255102401280382
Bond Position:  [-17.56651343]


portfolio before change:  [-10.93185494]
curr_Stock_Price:  106.08549638389566
curr_Factors:  [106.08549638]
mat_Sqrt:  [[0.15]]
grads:  [0.02346977]
Stock Position:  0.023469774841473428
Bond Position:  [-13.42165765]


portfolio before change:  [-10.93460033]
curr_Stock_Price:  106.00426371690979
curr_Factors:  [106.00426372]
mat_Sqrt:  [[0.15]]
grads:  [-0.2093148]
Stock Position:  -0.20931479736466957
Bond Position:  [11.25366065]


portfolio before change:  [-11.09235546]
curr_Stock_Price:  106.76129816060232
curr_Factors:  [106.76129816]
mat_Sqrt:  [[0.15]]
grads:  [0.05551341]
Stock Position:  0.05551340967989954
Bond Position:  [-17.01903915]


portfolio before change:  [-11.06075578]
curr_Stock_Price:  107.34968577089629
curr_Factors:  [107.34968577]
mat_Sqrt:  [[0.15]]
grads:  [0.16517493]
Stock Position:  0.16517493434194036
Bond Position:  [-28.79223308]


portfolio before change:  [-11.11047477]
curr_Stock_Price:  107.05957263565551
curr_Factors:  [107.05957264]
mat_Sqrt:  [[0.15]]
grads:  [-0.13423732]
Stock Position:  -0.13423731964949195
Bond Position:  [3.2609153]


portfolio before change:  [-11.11951651]
curr_Stock_Price:  107.12844732562122
curr_Factors:  [107.12844733]
mat_Sqrt:  [[0.15]]
grads:  [-0.05822221]
Stock Position:  -0.05822220641699689
Bond Position:  [-4.88226194]


portfolio before change:  [-11.16169932]
curr_Stock_Price:  107.84772015517751
curr_Factors:  [107.84772016]
mat_Sqrt:  [[0.15]]
grads:  [-0.06447172]
Stock Position:  -0.06447171626505571
Bond Position:  [-4.2085717]


portfolio before change:  [-11.20683489]
curr_Stock_Price:  108.5437234435204
curr_Factors:  [108.54372344]
mat_Sqrt:  [[0.15]]
grads:  [0.12752362]
Stock Position:  0.12752361657324876
Bond Position:  [-25.04872306]


portfolio before change:  [-11.24182474]
curr_Stock_Price:  108.28162093034105
curr_Factors:  [108.28162093]
mat_Sqrt:  [[0.15]]
grads:  [-0.06924814]
Stock Position:  -0.06924814385285077
Bond Position:  [-3.74352348]


portfolio before change:  [-11.26565581]
curr_Stock_Price:  108.62238232072663
curr_Factors:  [108.62238232]
mat_Sqrt:  [[0.15]]
grads:  [0.22115898]
Stock Position:  0.22115897833929823
Bond Position:  [-35.28847091]


portfolio before change:  [-11.29747031]
curr_Stock_Price:  108.48850170441173
curr_Factors:  [108.4885017]
mat_Sqrt:  [[0.15]]
grads:  [0.01356551]
Stock Position:  0.013565508336326032
Bond Position:  [-12.76917199]


portfolio before change:  [-11.28846919]
curr_Stock_Price:  109.21086472948033
curr_Factors:  [109.21086473]
mat_Sqrt:  [[0.15]]
grads:  [0.10637219]
Stock Position:  0.10637218897357302
Bond Position:  [-22.90546793]


portfolio before change:  [-11.28315864]
curr_Stock_Price:  109.27424765126872
curr_Factors:  [109.27424765]
mat_Sqrt:  [[0.15]]
grads:  [0.28996685]
Stock Position:  0.289966850391036
Bond Position:  [-42.96906806]


portfolio before change:  [-11.32310432]
curr_Stock_Price:  109.14575010568807
curr_Factors:  [109.14575011]
mat_Sqrt:  [[0.15]]
grads:  [0.1069096]
Stock Position:  0.1069096040021086
Bond Position:  [-22.99183325]


portfolio before change:  [-11.48525169]
curr_Stock_Price:  107.64251442927495
curr_Factors:  [107.64251443]
mat_Sqrt:  [[0.15]]
grads:  [-0.05233656]
Stock Position:  -0.05233656139635528
Bond Position:  [-5.85161262]


portfolio before change:  [-11.5630399]
curr_Stock_Price:  109.12183343461872
curr_Factors:  [109.12183343]
mat_Sqrt:  [[0.15]]
grads:  [0.59460942]
Stock Position:  0.5946094234249932
Bond Position:  [-76.44791036]


portfolio before change:  [-11.10614939]
curr_Stock_Price:  109.898256806087
curr_Factors:  [109.89825681]
mat_Sqrt:  [[0.15]]
grads:  [0.1633108]
Stock Position:  0.16331079887311306
Bond Position:  [-29.0537215]


portfolio before change:  [-11.16227433]
curr_Stock_Price:  109.56570668977568
curr_Factors:  [109.56570669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0822289]
Stock Position:  -0.08222889712651822
Bond Position:  [-2.1528071]


portfolio before change:  [-11.1797277]
curr_Stock_Price:  109.77632388272204
curr_Factors:  [109.77632388]
mat_Sqrt:  [[0.15]]
grads:  [0.03719765]
Stock Position:  0.03719765036995465
Bond Position:  [-15.26314901]


portfolio before change:  [-11.14895064]
curr_Stock_Price:  110.62936263191347
curr_Factors:  [110.62936263]
mat_Sqrt:  [[0.15]]
grads:  [-0.2414129]
Stock Position:  -0.24141289969773555
Bond Position:  [15.55840459]


portfolio before change:  [-11.17085393]
curr_Stock_Price:  110.72412030769725
curr_Factors:  [110.72412031]
mat_Sqrt:  [[0.15]]
grads:  [0.37003492]
Stock Position:  0.370034917859809
Bond Position:  [-52.1426447]


portfolio before change:  [-11.33740218]
curr_Stock_Price:  110.2828397188752
curr_Factors:  [110.28283972]
mat_Sqrt:  [[0.15]]
grads:  [0.16044413]
Stock Position:  0.1604441318443561
Bond Position:  [-29.03163665]


portfolio before change:  [-11.41721301]
curr_Stock_Price:  109.79671225317225
curr_Factors:  [109.79671225]
mat_Sqrt:  [[0.15]]
grads:  [0.02180605]
Stock Position:  0.021806052507834253
Bond Position:  [-13.81144588]


portfolio before change:  [-11.40702064]
curr_Stock_Price:  110.30370971647184
curr_Factors:  [110.30370972]
mat_Sqrt:  [[0.15]]
grads:  [0.01519099]
Stock Position:  0.015190994211214977
Bond Position:  [-13.08264366]


portfolio before change:  [-11.39955492]
curr_Stock_Price:  110.84899398659887
curr_Factors:  [110.84899399]
mat_Sqrt:  [[0.15]]
grads:  [-0.10325593]
Stock Position:  -0.1032559287478028
Bond Position:  [0.0462609]


portfolio before change:  [-11.42147743]
curr_Stock_Price:  111.06133438221818
curr_Factors:  [111.06133438]
mat_Sqrt:  [[0.15]]
grads:  [0.2214651]
Stock Position:  0.2214651007853393
Bond Position:  [-36.01768705]


portfolio before change:  [-11.25804159]
curr_Stock_Price:  111.80947490085279
curr_Factors:  [111.8094749]
mat_Sqrt:  [[0.15]]
grads:  [0.47948271]
Stock Position:  0.47948271001683385
Bond Position:  [-64.86875162]


portfolio before change:  [-11.26217903]
curr_Stock_Price:  111.8093017634651
curr_Factors:  [111.80930176]
mat_Sqrt:  [[0.15]]
grads:  [-0.09407872]
Stock Position:  -0.09407871737626186
Bond Position:  [-0.74330333]


portfolio before change:  [-11.28241057]
curr_Stock_Price:  112.02385694041843
curr_Factors:  [112.02385694]
mat_Sqrt:  [[0.15]]
grads:  [-0.07100425]
Stock Position:  -0.07100424981100784
Bond Position:  [-3.32824064]


portfolio before change:  [-11.40445312]
curr_Stock_Price:  113.73973346907559
curr_Factors:  [113.73973347]
mat_Sqrt:  [[0.15]]
grads:  [0.18151014]
Stock Position:  0.18151013963560556
Bond Position:  [-32.04936802]


portfolio before change:  [-11.39660153]
curr_Stock_Price:  113.79402649365238
curr_Factors:  [113.79402649]
mat_Sqrt:  [[0.15]]
grads:  [0.10755848]
Stock Position:  0.10755848192482913
Bond Position:  [-23.63611427]


portfolio before change:  [-11.34495764]
curr_Stock_Price:  114.28790842468852
curr_Factors:  [114.28790842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721614]
Stock Position:  -0.017216142421275452
Bond Position:  [-9.37736073]


portfolio before change:  [-11.34793737]
curr_Stock_Price:  114.42694221186225
curr_Factors:  [114.42694221]
mat_Sqrt:  [[0.15]]
grads:  [0.11038361]
Stock Position:  0.11038361211608234
Bond Position:  [-23.97879657]


portfolio before change:  [-11.33684038]
curr_Stock_Price:  114.54105072844892
curr_Factors:  [114.54105073]
mat_Sqrt:  [[0.15]]
grads:  [-0.31231501]
Stock Position:  -0.31231500923032973
Bond Position:  [24.43604893]


portfolio before change:  [-11.21897658]
curr_Stock_Price:  114.16855343156683
curr_Factors:  [114.16855343]
mat_Sqrt:  [[0.15]]
grads:  [-0.70396014]
Stock Position:  -0.703960141552406
Bond Position:  [69.15113445]


portfolio before change:  [-10.89852474]
curr_Stock_Price:  113.71948004399002
curr_Factors:  [113.71948004]
mat_Sqrt:  [[0.15]]
grads:  [0.10257031]
Stock Position:  0.1025703063902186
Bond Position:  [-22.56276665]


portfolio before change:  [-10.83642023]
curr_Stock_Price:  114.33871112412417
curr_Factors:  [114.33871112]
mat_Sqrt:  [[0.15]]
grads:  [0.14131803]
Stock Position:  0.1413180288130875
Bond Position:  [-26.99454151]


portfolio before change:  [-10.9125129]
curr_Stock_Price:  113.81220042762524
curr_Factors:  [113.81220043]
mat_Sqrt:  [[0.15]]
grads:  [-0.5218925]
Stock Position:  -0.5218925005248395
Bond Position:  [48.48522097]


portfolio before change:  [-10.87779915]
curr_Stock_Price:  113.75149189238529
curr_Factors:  [113.75149189]
mat_Sqrt:  [[0.15]]
grads:  [0.20845327]
Stock Position:  0.20845326608043008
Bond Position:  [-34.58966915]


portfolio before change:  [-10.8231449]
curr_Stock_Price:  114.02405258127997
curr_Factors:  [114.02405258]
mat_Sqrt:  [[0.15]]
grads:  [-0.20717495]
Stock Position:  -0.2071749499759272
Bond Position:  [12.79978249]


portfolio before change:  [-10.84915331]
curr_Stock_Price:  114.15345248883008
curr_Factors:  [114.15345249]
mat_Sqrt:  [[0.15]]
grads:  [0.0959972]
Stock Position:  0.09599719972646663
Bond Position:  [-21.80756509]


portfolio before change:  [-10.85989423]
curr_Stock_Price:  114.05576316501927
curr_Factors:  [114.05576317]
mat_Sqrt:  [[0.15]]
grads:  [0.15692091]
Stock Position:  0.15692091090291094
Bond Position:  [-28.75762848]


portfolio before change:  [-10.96041022]
curr_Stock_Price:  113.42666545316004
curr_Factors:  [113.42666545]
mat_Sqrt:  [[0.15]]
grads:  [-0.17921959]
Stock Position:  -0.17921958825155665
Bond Position:  [9.36787006]


portfolio before change:  [-10.82955302]
curr_Stock_Price:  112.69978233838937
curr_Factors:  [112.69978234]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.82955302]
Stock Price:  112.92622153678487
PL:  [-23.75577456]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.54212345e-04]
 [ 2.82793994e-03]
 [ 5.21156029e-04]
 [ 7.43056122e-03]
 [ 4.17364870e-03]
 [ 2.47987626e-02]
 [ 9.16557954e-04]
 [-1.84181826e-02]
 [ 8.12138903e-03]
 [ 2.19132624e-02]
 [ 1.17159376e-02]
 [ 2.36729477e-02]
 [-1.33552580e-02]
 [ 2.83308694e-03]
 [-7.04793595e-03]
 [ 1.06576259e-02]
 [ 1.36526430e-02]
 [ 1.43252241e-02]
 [ 1.40032536e-03]
 [ 8.74917141e-03]
 [ 1.28321640e-02]
 [-1.07185853e-02]
 [ 3.16962007e-03]
 [-1.02710574e-02]
 [-1.11959696e-02]
 [-2.35105036e-03]
 [ 2.64554275e-03]
 [ 1.09013472e-02]
 [-3.16802743e-02]
 [ 2.19445514e-03]
 [-7.09474270e-05]
 [-1.06532583e-02]
 [-7.77066180e-03]
 [ 5.13805150e-03]
 [ 1.37827276e-02]
 [ 1.49989513e-02]
 [-3.43949820e-02]
 [ 8.73652427e-03]
 [-2.55907657e-02]
 [ 2.18279096e-02]
 [-5.09061906e-03]
 [ 2.14317585e-03]
 [ 2.32581534e-02]
 [ 4.27686549e-03]
 [-5.75015386e-03]
 [-5.11584166e-03]
 [ 6.44092807e-03]
 [-1.23709336e-02]
 [-1.51875860e-02]
 [-7.67989600e-03]
 [ 3.31994046e-02]
 [-7.44273217e-03]
 [-3.58004672e-03]
 [ 5.43795420e-03]
 [ 1.95066924e-03]
 [-3.47058160e-03]
 [ 5.84900309e-03]
 [-4.81069791e-04]
 [ 1.57626735e-03]
 [ 9.87610008e-03]
 [ 7.37637111e-04]
 [-1.19086676e-02]
 [-8.85914211e-03]
 [-1.50267318e-02]
 [-8.57755798e-03]
 [ 1.45951713e-03]
 [-5.20407346e-03]
 [ 2.08862037e-02]
 [-8.21032496e-03]
 [ 8.80568847e-03]
 [-9.72247648e-03]
 [ 1.08972824e-02]
 [-7.97129458e-03]
 [ 1.72645222e-02]
 [-2.23588973e-02]
 [-4.27349263e-03]
 [-7.01182593e-03]
 [-1.50346715e-03]
 [ 7.26004887e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.85803445]
curr_Stock_Price:  100.44323988149134
curr_Factors:  [100.44323988]
mat_Sqrt:  [[0.15]]
grads:  [-0.00169475]
Stock Position:  -0.0016947489639932505
Bond Position:  [9.02826053]


portfolio before change:  [8.85882164]
curr_Stock_Price:  100.31171126653406
curr_Factors:  [100.31171127]
mat_Sqrt:  [[0.15]]
grads:  [0.01885293]
Stock Position:  0.018852932913131813
Bond Position:  [6.96765168]


portfolio before change:  [8.85209964]
curr_Stock_Price:  99.93206243572179
curr_Factors:  [99.93206244]
mat_Sqrt:  [[0.15]]
grads:  [0.00347437]
Stock Position:  0.003474373527936591
Bond Position:  [8.50489833]


portfolio before change:  [8.85308319]
curr_Stock_Price:  100.06215101615622
curr_Factors:  [100.06215102]
mat_Sqrt:  [[0.15]]
grads:  [0.04953707]
Stock Position:  0.049537074774352305
Bond Position:  [3.89629693]


portfolio before change:  [8.85594139]
curr_Stock_Price:  100.11493318395102
curr_Factors:  [100.11493318]
mat_Sqrt:  [[0.15]]
grads:  [0.02782432]
Stock Position:  0.02782432466383904
Bond Position:  [6.07031098]


portfolio before change:  [8.85603165]
curr_Stock_Price:  100.10454125153541
curr_Factors:  [100.10454125]
mat_Sqrt:  [[0.15]]
grads:  [0.16532508]
Stock Position:  0.1653250839520113
Bond Position:  [-7.69376004]


portfolio before change:  [8.73664446]
curr_Stock_Price:  99.38531397035715
curr_Factors:  [99.38531397]
mat_Sqrt:  [[0.15]]
grads:  [0.00611039]
Stock Position:  0.006110386357714643
Bond Position:  [8.12936179]


portfolio before change:  [8.73464617]
curr_Stock_Price:  98.97512826344571
curr_Factors:  [98.97512826]
mat_Sqrt:  [[0.15]]
grads:  [-0.12278788]
Stock Position:  -0.12278788417719226
Bond Position:  [20.88759275]


portfolio before change:  [8.70445486]
curr_Stock_Price:  99.2316423970526
curr_Factors:  [99.2316424]
mat_Sqrt:  [[0.15]]
grads:  [0.05414259]
Stock Position:  0.05414259353401232
Bond Position:  [3.33179638]


portfolio before change:  [8.67742988]
curr_Stock_Price:  98.72865181031449
curr_Factors:  [98.72865181]
mat_Sqrt:  [[0.15]]
grads:  [0.14608842]
Stock Position:  0.14608841599382333
Bond Position:  [-5.74568247]


portfolio before change:  [8.69696089]
curr_Stock_Price:  98.86480308091625
curr_Factors:  [98.86480308]
mat_Sqrt:  [[0.15]]
grads:  [0.07810625]
Stock Position:  0.07810625061328995
Bond Position:  [0.9750018]


portfolio before change:  [8.66235375]
curr_Stock_Price:  98.42094516251716
curr_Factors:  [98.42094516]
mat_Sqrt:  [[0.15]]
grads:  [0.15781965]
Stock Position:  0.157819651296171
Bond Position:  [-6.87040549]


portfolio before change:  [8.5717444]
curr_Stock_Price:  97.84953380679671
curr_Factors:  [97.84953381]
mat_Sqrt:  [[0.15]]
grads:  [-0.08903505]
Stock Position:  -0.0890350531343613
Bond Position:  [17.28378284]


portfolio before change:  [8.60002673]
curr_Stock_Price:  97.54401297401597
curr_Factors:  [97.54401297]
mat_Sqrt:  [[0.15]]
grads:  [0.01888725]
Stock Position:  0.018887246278832127
Bond Position:  [6.75768894]


portfolio before change:  [8.59240996]
curr_Stock_Price:  97.11837434232093
curr_Factors:  [97.11837434]
mat_Sqrt:  [[0.15]]
grads:  [-0.04698624]
Stock Position:  -0.046986239652847664
Bond Position:  [13.15563717]


portfolio before change:  [8.6214514]
curr_Stock_Price:  96.51779030516003
curr_Factors:  [96.51779031]
mat_Sqrt:  [[0.15]]
grads:  [0.07105084]
Stock Position:  0.07105083950572312
Bond Position:  [1.76378137]


portfolio before change:  [8.64164595]
curr_Stock_Price:  96.80046560337182
curr_Factors:  [96.8004656]
mat_Sqrt:  [[0.15]]
grads:  [0.09101762]
Stock Position:  0.09101762011790046
Bond Position:  [-0.16890205]


portfolio before change:  [8.63576132]
curr_Stock_Price:  96.73592781446632
curr_Factors:  [96.73592781]
mat_Sqrt:  [[0.15]]
grads:  [0.09550149]
Stock Position:  0.09550149374224284
Bond Position:  [-0.60266428]


portfolio before change:  [8.64595083]
curr_Stock_Price:  96.84301703220308
curr_Factors:  [96.84301703]
mat_Sqrt:  [[0.15]]
grads:  [0.0093355]
Stock Position:  0.009335502395479088
Bond Position:  [7.74187262]


portfolio before change:  [8.64807688]
curr_Stock_Price:  97.01892226478411
curr_Factors:  [97.01892226]
mat_Sqrt:  [[0.15]]
grads:  [0.05832781]
Stock Position:  0.05832780942938506
Bond Position:  [2.98917567]


portfolio before change:  [8.64313236]
curr_Stock_Price:  96.93094795029128
curr_Factors:  [96.93094795]
mat_Sqrt:  [[0.15]]
grads:  [0.08554776]
Stock Position:  0.08554776001214326
Bond Position:  [0.35090689]


portfolio before change:  [8.60694816]
curr_Stock_Price:  96.50772084575951
curr_Factors:  [96.50772085]
mat_Sqrt:  [[0.15]]
grads:  [-0.07145724]
Stock Position:  -0.07145723525386559
Bond Position:  [15.50312307]


portfolio before change:  [8.58083386]
curr_Stock_Price:  96.88673465277567
curr_Factors:  [96.88673465]
mat_Sqrt:  [[0.15]]
grads:  [0.0211308]
Stock Position:  0.02113080045475474
Bond Position:  [6.5335396]


portfolio before change:  [8.59589166]
curr_Stock_Price:  97.58000891940242
curr_Factors:  [97.58000892]
mat_Sqrt:  [[0.15]]
grads:  [-0.06847372]
Stock Position:  -0.0684737158199981
Bond Position:  [15.27755746]


portfolio before change:  [8.65059084]
curr_Stock_Price:  96.79511941125796
curr_Factors:  [96.79511941]
mat_Sqrt:  [[0.15]]
grads:  [-0.0746398]
Stock Position:  -0.07463979717775855
Bond Position:  [15.87535892]


portfolio before change:  [8.69765625]
curr_Stock_Price:  96.17784589556896
curr_Factors:  [96.1778459]
mat_Sqrt:  [[0.15]]
grads:  [-0.01567367]
Stock Position:  -0.015673669072156712
Bond Position:  [10.20511598]


portfolio before change:  [8.71062034]
curr_Stock_Price:  95.39141516347611
curr_Factors:  [95.39141516]
mat_Sqrt:  [[0.15]]
grads:  [0.01763695]
Stock Position:  0.017636951686974968
Bond Position:  [7.02820656]


portfolio before change:  [8.72799112]
curr_Stock_Price:  96.3514165621069
curr_Factors:  [96.35141656]
mat_Sqrt:  [[0.15]]
grads:  [0.07267565]
Stock Position:  0.07267564830246614
Bond Position:  [1.72558945]


portfolio before change:  [8.78078548]
curr_Stock_Price:  97.07637073870556
curr_Factors:  [97.07637074]
mat_Sqrt:  [[0.15]]
grads:  [-0.21120183]
Stock Position:  -0.21120182846960306
Bond Position:  [29.28349249]


portfolio before change:  [8.7277166]
curr_Stock_Price:  97.33630771210626
curr_Factors:  [97.33630771]
mat_Sqrt:  [[0.15]]
grads:  [0.0146297]
Stock Position:  0.01462970091333583
Bond Position:  [7.30371553]


portfolio before change:  [8.73555361]
curr_Stock_Price:  97.84079666209293
curr_Factors:  [97.84079666]
mat_Sqrt:  [[0.15]]
grads:  [-0.00047298]
Stock Position:  -0.0004729828465552255
Bond Position:  [8.78183063]


portfolio before change:  [8.73555823]
curr_Stock_Price:  98.9915155065548
curr_Factors:  [98.99151551]
mat_Sqrt:  [[0.15]]
grads:  [-0.07102172]
Stock Position:  -0.07102172224883005
Bond Position:  [15.76610615]


portfolio before change:  [8.78755606]
curr_Stock_Price:  98.27325038912335
curr_Factors:  [98.27325039]
mat_Sqrt:  [[0.15]]
grads:  [-0.05180441]
Stock Position:  -0.051804412028137625
Bond Position:  [13.87854402]


portfolio before change:  [8.80347866]
curr_Stock_Price:  97.98263508794865
curr_Factors:  [97.98263509]
mat_Sqrt:  [[0.15]]
grads:  [0.03425368]
Stock Position:  0.03425367663425951
Bond Position:  [5.44721316]


portfolio before change:  [8.76791472]
curr_Stock_Price:  96.93444400392787
curr_Factors:  [96.934444]
mat_Sqrt:  [[0.15]]
grads:  [0.09188485]
Stock Position:  0.09188485092179602
Bond Position:  [-0.13889222]


portfolio before change:  [8.82377313]
curr_Stock_Price:  97.54245598863314
curr_Factors:  [97.54245599]
mat_Sqrt:  [[0.15]]
grads:  [0.09999301]
Stock Position:  0.09999300862223523
Bond Position:  [-0.92979051]


portfolio before change:  [8.84404196]
curr_Stock_Price:  97.74573965939683
curr_Factors:  [97.74573966]
mat_Sqrt:  [[0.15]]
grads:  [-0.22929988]
Stock Position:  -0.2292998798183898
Bond Position:  [31.25712832]


portfolio before change:  [8.85048164]
curr_Stock_Price:  97.72617554145178
curr_Factors:  [97.72617554]
mat_Sqrt:  [[0.15]]
grads:  [0.0582435]
Stock Position:  0.058243495108468414
Bond Position:  [3.15856761]


portfolio before change:  [8.83440009]
curr_Stock_Price:  97.44667710948765
curr_Factors:  [97.44667711]
mat_Sqrt:  [[0.15]]
grads:  [-0.1706051]
Stock Position:  -0.17060510438039125
Bond Position:  [25.45930061]


portfolio before change:  [8.6975621]
curr_Stock_Price:  98.25807864439041
curr_Factors:  [98.25807864]
mat_Sqrt:  [[0.15]]
grads:  [0.1455194]
Stock Position:  0.14551939761429142
Bond Position:  [-5.60089431]


portfolio before change:  [8.82262706]
curr_Stock_Price:  99.11992269014232
curr_Factors:  [99.11992269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03393746]
Stock Position:  -0.03393746041200329
Bond Position:  [12.18650552]


portfolio before change:  [8.82951915]
curr_Stock_Price:  98.93928433951272
curr_Factors:  [98.93928434]
mat_Sqrt:  [[0.15]]
grads:  [0.01428784]
Stock Position:  0.014287839005634578
Bond Position:  [7.41589059]


portfolio before change:  [8.83561517]
curr_Stock_Price:  99.33350133462916
curr_Factors:  [99.33350133]
mat_Sqrt:  [[0.15]]
grads:  [0.15505436]
Stock Position:  0.15505435605038248
Bond Position:  [-6.56647692]


portfolio before change:  [8.80900544]
curr_Stock_Price:  99.16453278561897
curr_Factors:  [99.16453279]
mat_Sqrt:  [[0.15]]
grads:  [0.02851244]
Stock Position:  0.02851243660731981
Bond Position:  [5.98158299]


portfolio before change:  [8.79215983]
curr_Stock_Price:  98.56060423501532
curr_Factors:  [98.56060424]
mat_Sqrt:  [[0.15]]
grads:  [-0.03833436]
Stock Position:  -0.03833435903996824
Bond Position:  [12.57041742]


portfolio before change:  [8.75944753]
curr_Stock_Price:  99.43444110290804
curr_Factors:  [99.4344411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03410561]
Stock Position:  -0.034105611059376324
Bond Position:  [12.1507199]


portfolio before change:  [8.73505831]
curr_Stock_Price:  100.17181721891873
curr_Factors:  [100.17181722]
mat_Sqrt:  [[0.15]]
grads:  [0.04293952]
Stock Position:  0.042939520447694585
Bond Position:  [4.43372851]


portfolio before change:  [8.71419469]
curr_Stock_Price:  99.67947984858033
curr_Factors:  [99.67947985]
mat_Sqrt:  [[0.15]]
grads:  [-0.08247289]
Stock Position:  -0.08247289041070034
Bond Position:  [16.93504951]


portfolio before change:  [8.69009184]
curr_Stock_Price:  99.98456591109901
curr_Factors:  [99.98456591]
mat_Sqrt:  [[0.15]]
grads:  [-0.10125057]
Stock Position:  -0.10125057345046766
Bond Position:  [18.81358647]


portfolio before change:  [8.58660345]
curr_Stock_Price:  101.01828130517555
curr_Factors:  [101.01828131]
mat_Sqrt:  [[0.15]]
grads:  [-0.05119931]
Stock Position:  -0.05119930663721936
Bond Position:  [13.75866941]


portfolio before change:  [8.60541159]
curr_Stock_Price:  100.6677258727858
curr_Factors:  [100.66772587]
mat_Sqrt:  [[0.15]]
grads:  [0.22132936]
Stock Position:  0.22132936407844742
Bond Position:  [-13.67531216]


portfolio before change:  [8.64754593]
curr_Stock_Price:  100.86195713578418
curr_Factors:  [100.86195714]
mat_Sqrt:  [[0.15]]
grads:  [-0.04961821]
Stock Position:  -0.04961821444851695
Bond Position:  [13.65213615]


portfolio before change:  [8.61412498]
curr_Stock_Price:  101.55271635735964
curr_Factors:  [101.55271636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02386698]
Stock Position:  -0.023866978142895044
Bond Position:  [11.03788144]


portfolio before change:  [8.60999142]
curr_Stock_Price:  101.75481372474674
curr_Factors:  [101.75481372]
mat_Sqrt:  [[0.15]]
grads:  [0.03625303]
Stock Position:  0.03625302799648537
Bond Position:  [4.92107131]


portfolio before change:  [8.61084194]
curr_Stock_Price:  101.76979028779266
curr_Factors:  [101.76979029]
mat_Sqrt:  [[0.15]]
grads:  [0.01300446]
Stock Position:  0.013004461576856538
Bond Position:  [7.28738061]


portfolio before change:  [8.59536246]
curr_Stock_Price:  100.54444487601845
curr_Factors:  [100.54444488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313721]
Stock Position:  -0.023137210650504156
Bond Position:  [10.92168046]


portfolio before change:  [8.60906754]
curr_Stock_Price:  99.98160876564725
curr_Factors:  [99.98160877]
mat_Sqrt:  [[0.15]]
grads:  [0.03899335]
Stock Position:  0.03899335396086265
Bond Position:  [4.71044928]


portfolio before change:  [8.65207209]
curr_Stock_Price:  101.07692716761595
curr_Factors:  [101.07692717]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320713]
Stock Position:  -0.0032071319420906978
Bond Position:  [8.97623913]


portfolio before change:  [8.65241062]
curr_Stock_Price:  101.14630381355752
curr_Factors:  [101.14630381]
mat_Sqrt:  [[0.15]]
grads:  [0.01050845]
Stock Position:  0.010508449002778968
Bond Position:  [7.58951985]


portfolio before change:  [8.65148626]
curr_Stock_Price:  101.01319880978309
curr_Factors:  [101.01319881]
mat_Sqrt:  [[0.15]]
grads:  [0.06584067]
Stock Position:  0.06584066719596159
Bond Position:  [2.00070985]


portfolio before change:  [8.65178709]
curr_Stock_Price:  101.01586873353376
curr_Factors:  [101.01586873]
mat_Sqrt:  [[0.15]]
grads:  [0.00491758]
Stock Position:  0.004917580742330395
Bond Position:  [8.1550334]


portfolio before change:  [8.6503881]
curr_Stock_Price:  100.62773113892872
curr_Factors:  [100.62773114]
mat_Sqrt:  [[0.15]]
grads:  [-0.07939112]
Stock Position:  -0.07939111751204382
Bond Position:  [16.63933613]


portfolio before change:  [8.67032619]
curr_Stock_Price:  100.38969320957335
curr_Factors:  [100.38969321]
mat_Sqrt:  [[0.15]]
grads:  [-0.05906095]
Stock Position:  -0.059060947388136636
Bond Position:  [14.59943658]


portfolio before change:  [8.69108127]
curr_Stock_Price:  100.05372518454224
curr_Factors:  [100.05372518]
mat_Sqrt:  [[0.15]]
grads:  [-0.10017821]
Stock Position:  -0.10017821190369529
Bond Position:  [18.71428456]


portfolio before change:  [8.65501121]
curr_Stock_Price:  100.42546008360492
curr_Factors:  [100.42546008]
mat_Sqrt:  [[0.15]]
grads:  [-0.05718372]
Stock Position:  -0.057183719894292724
Bond Position:  [14.39771259]


portfolio before change:  [8.69534012]
curr_Stock_Price:  99.73594526410423
curr_Factors:  [99.73594526]
mat_Sqrt:  [[0.15]]
grads:  [0.00973011]
Stock Position:  0.009730114207096643
Bond Position:  [7.72489798]


portfolio before change:  [8.69597717]
curr_Stock_Price:  99.75179615160297
curr_Factors:  [99.75179615]
mat_Sqrt:  [[0.15]]
grads:  [-0.03469382]
Stock Position:  -0.034693823054237585
Bond Position:  [12.15674834]


portfolio before change:  [8.65894975]
curr_Stock_Price:  100.84095957354921
curr_Factors:  [100.84095957]
mat_Sqrt:  [[0.15]]
grads:  [0.13924136]
Stock Position:  0.13924135833260093
Bond Position:  [-5.38228243]


portfolio before change:  [8.68402597]
curr_Stock_Price:  101.02346725382115
curr_Factors:  [101.02346725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547355]
Stock Position:  -0.054735499749252424
Bond Position:  [14.21359593]


portfolio before change:  [8.69177954]
curr_Stock_Price:  100.89804228506547
curr_Factors:  [100.89804229]
mat_Sqrt:  [[0.15]]
grads:  [0.05870459]
Stock Position:  0.05870458980960856
Bond Position:  [2.76860136]


portfolio before change:  [8.63145847]
curr_Stock_Price:  99.86755879393442
curr_Factors:  [99.86755879]
mat_Sqrt:  [[0.15]]
grads:  [-0.06481651]
Stock Position:  -0.06481650985997593
Bond Position:  [15.10452508]


portfolio before change:  [8.60386404]
curr_Stock_Price:  100.30785544020392
curr_Factors:  [100.30785544]
mat_Sqrt:  [[0.15]]
grads:  [0.07264855]
Stock Position:  0.07264854940260308
Bond Position:  [1.31664385]


portfolio before change:  [8.60131419]
curr_Stock_Price:  100.27162425321293
curr_Factors:  [100.27162425]
mat_Sqrt:  [[0.15]]
grads:  [-0.05314196]
Stock Position:  -0.05314196389529315
Bond Position:  [13.92994523]


portfolio before change:  [8.57405165]
curr_Stock_Price:  100.80102119397556
curr_Factors:  [100.80102119]
mat_Sqrt:  [[0.15]]
grads:  [0.11509681]
Stock Position:  0.11509681498894593
Bond Position:  [-3.02782484]


portfolio before change:  [8.52657528]
curr_Stock_Price:  100.39017468884408
curr_Factors:  [100.39017469]
mat_Sqrt:  [[0.15]]
grads:  [-0.14905932]
Stock Position:  -0.14905931555318852
Bond Position:  [23.49066601]


portfolio before change:  [8.5376779]
curr_Stock_Price:  100.32554000138443
curr_Factors:  [100.32554]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848995]
Stock Position:  -0.028489950853436884
Bond Position:  [11.3959476]


portfolio before change:  [8.54384084]
curr_Stock_Price:  100.13422078172438
curr_Factors:  [100.13422078]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674551]
Stock Position:  -0.04674550618149606
Bond Position:  [13.22466568]


portfolio before change:  [8.51812803]
curr_Stock_Price:  100.70196261489916
curr_Factors:  [100.70196261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01002311]
Stock Position:  -0.010023114311574365
Bond Position:  [9.52747531]


portfolio before change:  [8.51877365]
curr_Stock_Price:  100.69696055951717
curr_Factors:  [100.69696056]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.51877365]
Stock Price:  101.06124138392792
PL:  [7.45753227]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.40651618e-03]
 [-1.05208563e-02]
 [-3.28671139e-03]
 [ 6.59935523e-03]
 [-3.86090803e-03]
 [ 1.07608437e-02]
 [ 5.46551954e-03]
 [-2.59952546e-02]
 [-3.91313379e-02]
 [ 3.87583850e-02]
 [-7.84509588e-02]
 [ 3.07625173e-02]
 [-1.46043225e-02]
 [ 4.05351746e-03]
 [-7.01220899e-03]
 [ 9.21001615e-03]
 [ 7.68332261e-03]
 [-8.61127956e-03]
 [ 1.01907560e-03]
 [ 9.91429496e-03]
 [ 1.23893430e-02]
 [-9.47661582e-03]
 [ 4.65082384e-03]
 [-2.07277613e-02]
 [-1.09190776e-02]
 [-5.71588440e-03]
 [-2.95250780e-03]
 [ 8.92760601e-03]
 [-2.02012440e-02]
 [ 6.46072630e-04]
 [ 9.16635001e-04]
 [-1.00997484e-02]
 [-8.49700907e-03]
 [ 5.50117403e-03]
 [ 1.36563434e-02]
 [ 1.30943138e-02]
 [-3.44139650e-02]
 [ 9.01143061e-03]
 [-1.74864135e-02]
 [ 2.44169071e-02]
 [-6.51915912e-03]
 [-2.66670324e-03]
 [ 2.32629193e-02]
 [ 4.44528091e-03]
 [-4.83915374e-03]
 [ 1.41463230e-03]
 [ 1.85084908e-03]
 [-1.19475933e-02]
 [-7.71296902e-03]
 [-3.72589529e-03]
 [ 4.52232080e-02]
 [-1.02333595e-02]
 [ 3.38391343e-03]
 [ 5.20924612e-03]
 [ 4.81025275e-03]
 [-1.87032038e-03]
 [ 1.08470094e-03]
 [-6.33280444e-04]
 [ 1.53355444e-03]
 [ 8.48891339e-04]
 [-4.78238897e-04]
 [ 3.34668234e-04]
 [ 6.28737983e-03]
 [-1.74704719e-02]
 [-1.01356356e-02]
 [-7.80132822e-03]
 [-4.72577612e-03]
 [ 1.60983253e-02]
 [-1.12931492e-02]
 [ 9.97958881e-03]
 [-1.42486777e-04]
 [ 1.17414791e-02]
 [ 1.63695758e-03]
 [ 1.43909284e-03]
 [-6.67246325e-03]
 [-1.16315663e-02]
 [ 2.95038334e-03]
 [ 3.28573724e-03]
 [-7.77397030e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.24778311]
curr_Stock_Price:  99.20088487983507
curr_Factors:  [99.20088488]
mat_Sqrt:  [[0.15]]
grads:  [0.04271011]
Stock Position:  0.04271010784169341
Bond Position:  [-14.48466361]


portfolio before change:  [-10.24856022]
curr_Stock_Price:  99.20388679948982
curr_Factors:  [99.2038868]
mat_Sqrt:  [[0.15]]
grads:  [-0.07013904]
Stock Position:  -0.07013904207131068
Bond Position:  [-3.29049463]


portfolio before change:  [-10.232622]
curr_Stock_Price:  98.97371712547137
curr_Factors:  [98.97371713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191141]
Stock Position:  -0.021911409245375133
Bond Position:  [-8.06396838]


portfolio before change:  [-10.22759913]
curr_Stock_Price:  98.72147924517614
curr_Factors:  [98.72147925]
mat_Sqrt:  [[0.15]]
grads:  [0.0439957]
Stock Position:  0.04399570150182634
Bond Position:  [-14.57091986]


portfolio before change:  [-10.24200426]
curr_Stock_Price:  98.4147578485518
curr_Factors:  [98.41475785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02573939]
Stock Position:  -0.025739386844790015
Bond Position:  [-7.70886874]


portfolio before change:  [-10.22816371]
curr_Stock_Price:  97.85831989950594
curr_Factors:  [97.8583199]
mat_Sqrt:  [[0.15]]
grads:  [0.07173896]
Stock Position:  0.07173895826157208
Bond Position:  [-17.24841764]


portfolio before change:  [-10.28214657]
curr_Stock_Price:  97.12085725601152
curr_Factors:  [97.12085726]
mat_Sqrt:  [[0.15]]
grads:  [0.0364368]
Stock Position:  0.03643679694046107
Bond Position:  [-13.82091953]


portfolio before change:  [-10.26037821]
curr_Stock_Price:  97.741993056273
curr_Factors:  [97.74199306]
mat_Sqrt:  [[0.15]]
grads:  [-0.1733017]
Stock Position:  -0.17330169728705633
Bond Position:  [6.67847508]


portfolio before change:  [-10.11538843]
curr_Stock_Price:  96.90776948159153
curr_Factors:  [96.90776948]
mat_Sqrt:  [[0.15]]
grads:  [-0.26087559]
Stock Position:  -0.26087558609360095
Bond Position:  [15.16548273]


portfolio before change:  [-10.06500802]
curr_Stock_Price:  96.71828245204635
curr_Factors:  [96.71828245]
mat_Sqrt:  [[0.15]]
grads:  [0.25838923]
Stock Position:  0.2583892330248618
Bond Position:  [-35.05597084]


portfolio before change:  [-9.98744908]
curr_Stock_Price:  97.02692537949429
curr_Factors:  [97.02692538]
mat_Sqrt:  [[0.15]]
grads:  [-0.52300639]
Stock Position:  -0.5230063917905652
Bond Position:  [40.75825307]


portfolio before change:  [-10.08586405]
curr_Stock_Price:  97.21996784325718
curr_Factors:  [97.21996784]
mat_Sqrt:  [[0.15]]
grads:  [0.20508345]
Stock Position:  0.20508344853935634
Bond Position:  [-30.02407032]


portfolio before change:  [-9.90716458]
curr_Stock_Price:  98.10046811573301
curr_Factors:  [98.10046812]
mat_Sqrt:  [[0.15]]
grads:  [-0.09736215]
Stock Position:  -0.09736214996518454
Bond Position:  [-0.35589209]


portfolio before change:  [-9.88449665]
curr_Stock_Price:  97.86741895087344
curr_Factors:  [97.86741895]
mat_Sqrt:  [[0.15]]
grads:  [0.02702345]
Stock Position:  0.027023449751323363
Bond Position:  [-12.52921193]


portfolio before change:  [-9.8877867]
curr_Stock_Price:  97.77464958371614
curr_Factors:  [97.77464958]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674806]
Stock Position:  -0.04674805991351649
Bond Position:  [-5.31701153]


portfolio before change:  [-9.89791438]
curr_Stock_Price:  97.98418453209355
curr_Factors:  [97.98418453]
mat_Sqrt:  [[0.15]]
grads:  [0.06140011]
Stock Position:  0.06140010768601527
Bond Position:  [-15.91415386]


portfolio before change:  [-9.86795788]
curr_Stock_Price:  98.48827431600922
curr_Factors:  [98.48827432]
mat_Sqrt:  [[0.15]]
grads:  [0.05122215]
Stock Position:  0.05122215072839811
Bond Position:  [-14.91273911]


portfolio before change:  [-9.88150663]
curr_Stock_Price:  98.24196131591714
curr_Factors:  [98.24196132]
mat_Sqrt:  [[0.15]]
grads:  [-0.05740853]
Stock Position:  -0.057408530390201794
Bond Position:  [-4.24158001]


portfolio before change:  [-9.89636504]
curr_Stock_Price:  98.49616222393351
curr_Factors:  [98.49616222]
mat_Sqrt:  [[0.15]]
grads:  [0.00679384]
Stock Position:  0.006793837305566807
Bond Position:  [-10.56553194]


portfolio before change:  [-9.89883694]
curr_Stock_Price:  98.2295189630758
curr_Factors:  [98.22951896]
mat_Sqrt:  [[0.15]]
grads:  [0.0660953]
Stock Position:  0.06609529975477256
Bond Position:  [-16.39134644]


portfolio before change:  [-9.92374505]
curr_Stock_Price:  97.86816775689341
curr_Factors:  [97.86816776]
mat_Sqrt:  [[0.15]]
grads:  [0.08259562]
Stock Position:  0.0825956202070278
Bond Position:  [-18.00722706]


portfolio before change:  [-9.91296928]
curr_Stock_Price:  98.0122583352422
curr_Factors:  [98.01225834]
mat_Sqrt:  [[0.15]]
grads:  [-0.06317744]
Stock Position:  -0.06317743880747764
Bond Position:  [-3.72080583]


portfolio before change:  [-9.87445716]
curr_Stock_Price:  97.3989906941089
curr_Factors:  [97.39899069]
mat_Sqrt:  [[0.15]]
grads:  [0.03100549]
Stock Position:  0.031005492281888127
Bond Position:  [-12.89436082]


portfolio before change:  [-9.87909704]
curr_Stock_Price:  97.27533647096878
curr_Factors:  [97.27533647]
mat_Sqrt:  [[0.15]]
grads:  [-0.13818508]
Stock Position:  -0.1381850756297711
Bond Position:  [3.56290268]


portfolio before change:  [-9.83452927]
curr_Stock_Price:  96.95442566580486
curr_Factors:  [96.95442567]
mat_Sqrt:  [[0.15]]
grads:  [-0.07279385]
Stock Position:  -0.07279385049081666
Bond Position:  [-2.77684331]


portfolio before change:  [-9.85902417]
curr_Stock_Price:  97.2885382235895
curr_Factors:  [97.28853822]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381059]
Stock Position:  -0.038105896024315015
Bond Position:  [-6.15175725]


portfolio before change:  [-9.8828213]
curr_Stock_Price:  97.90294786984482
curr_Factors:  [97.90294787]
mat_Sqrt:  [[0.15]]
grads:  [-0.01968339]
Stock Position:  -0.019683385362374774
Bond Position:  [-7.95575985]


portfolio before change:  [-9.87740188]
curr_Stock_Price:  97.6023561101794
curr_Factors:  [97.60235611]
mat_Sqrt:  [[0.15]]
grads:  [0.05951737]
Stock Position:  0.05951737341280918
Bond Position:  [-15.68643776]


portfolio before change:  [-9.85677691]
curr_Stock_Price:  97.96536624683137
curr_Factors:  [97.96536625]
mat_Sqrt:  [[0.15]]
grads:  [-0.13467496]
Stock Position:  -0.134674960264214
Bond Position:  [3.3367049]


portfolio before change:  [-9.86780405]
curr_Stock_Price:  98.0487945011304
curr_Factors:  [98.0487945]
mat_Sqrt:  [[0.15]]
grads:  [0.00430715]
Stock Position:  0.004307150865404923
Bond Position:  [-10.290115]


portfolio before change:  [-9.87009058]
curr_Stock_Price:  97.66724833116494
curr_Factors:  [97.66724833]
mat_Sqrt:  [[0.15]]
grads:  [0.0061109]
Stock Position:  0.006110900008406267
Bond Position:  [-10.46692537]


portfolio before change:  [-9.8710575]
curr_Stock_Price:  97.61607560760777
curr_Factors:  [97.61607561]
mat_Sqrt:  [[0.15]]
grads:  [-0.06733166]
Stock Position:  -0.06733165588998884
Bond Position:  [-3.29840549]


portfolio before change:  [-9.84312305]
curr_Stock_Price:  97.19813547247831
curr_Factors:  [97.19813547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05664673]
Stock Position:  -0.056646727106392715
Bond Position:  [-4.3371668]


portfolio before change:  [-9.84855949]
curr_Stock_Price:  97.28932090312594
curr_Factors:  [97.2893209]
mat_Sqrt:  [[0.15]]
grads:  [0.03667449]
Stock Position:  0.03667449351511189
Bond Position:  [-13.41659606]


portfolio before change:  [-9.84180464]
curr_Stock_Price:  97.49636977320777
curr_Factors:  [97.49636977]
mat_Sqrt:  [[0.15]]
grads:  [0.09104229]
Stock Position:  0.09104228900174677
Bond Position:  [-18.71809731]


portfolio before change:  [-9.87337856]
curr_Stock_Price:  97.16241504450994
curr_Factors:  [97.16241504]
mat_Sqrt:  [[0.15]]
grads:  [0.08729543]
Stock Position:  0.08729542553430134
Bond Position:  [-18.35521293]


portfolio before change:  [-9.8202563]
curr_Stock_Price:  97.78409138497365
curr_Factors:  [97.78409138]
mat_Sqrt:  [[0.15]]
grads:  [-0.22942643]
Stock Position:  -0.22942643327800744
Bond Position:  [12.61399902]


portfolio before change:  [-9.97063104]
curr_Stock_Price:  98.44296551681845
curr_Factors:  [98.44296552]
mat_Sqrt:  [[0.15]]
grads:  [0.0600762]
Stock Position:  0.06007620407382298
Bond Position:  [-15.88471073]


portfolio before change:  [-9.96494318]
curr_Stock_Price:  98.55416911369714
curr_Factors:  [98.55416911]
mat_Sqrt:  [[0.15]]
grads:  [-0.11657609]
Stock Position:  -0.11657608978340775
Bond Position:  [1.52411649]


portfolio before change:  [-10.02327635]
curr_Stock_Price:  99.05537341593009
curr_Factors:  [99.05537342]
mat_Sqrt:  [[0.15]]
grads:  [0.16277938]
Stock Position:  0.16277938063919603
Bond Position:  [-26.14744869]


portfolio before change:  [-9.88205275]
curr_Stock_Price:  99.93298992825034
curr_Factors:  [99.93298993]
mat_Sqrt:  [[0.15]]
grads:  [-0.04346106]
Stock Position:  -0.04346106080728767
Bond Position:  [-5.538859]


portfolio before change:  [-9.85673545]
curr_Stock_Price:  99.34249610204914
curr_Factors:  [99.3424961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777802]
Stock Position:  -0.017778021607317448
Bond Position:  [-8.09062241]


portfolio before change:  [-9.85718953]
curr_Stock_Price:  99.33959351377258
curr_Factors:  [99.33959351]
mat_Sqrt:  [[0.15]]
grads:  [0.15508613]
Stock Position:  0.15508612867596497
Bond Position:  [-25.26338251]


portfolio before change:  [-9.93269745]
curr_Stock_Price:  98.86289766189446
curr_Factors:  [98.86289766]
mat_Sqrt:  [[0.15]]
grads:  [0.02963521]
Stock Position:  0.029635206095497062
Bond Position:  [-12.8625198]


portfolio before change:  [-9.94668692]
curr_Stock_Price:  98.4179696393774
curr_Factors:  [98.41796964]
mat_Sqrt:  [[0.15]]
grads:  [-0.03226102]
Stock Position:  -0.03226102492024521
Bond Position:  [-6.77162235]


portfolio before change:  [-9.91639935]
curr_Stock_Price:  97.4660219905929
curr_Factors:  [97.46602199]
mat_Sqrt:  [[0.15]]
grads:  [0.00943088]
Stock Position:  0.009430881971838797
Bond Position:  [-10.8355899]


portfolio before change:  [-9.91501345]
curr_Stock_Price:  97.68478665646548
curr_Factors:  [97.68478666]
mat_Sqrt:  [[0.15]]
grads:  [0.01233899]
Stock Position:  0.012338993878800454
Bond Position:  [-11.12034544]


portfolio before change:  [-9.91775721]
curr_Stock_Price:  97.51875088899422
curr_Factors:  [97.51875089]
mat_Sqrt:  [[0.15]]
grads:  [-0.07965062]
Stock Position:  -0.07965062201386114
Bond Position:  [-2.15032804]


portfolio before change:  [-9.96562215]
curr_Stock_Price:  98.11799974717695
curr_Factors:  [98.11799975]
mat_Sqrt:  [[0.15]]
grads:  [-0.05141979]
Stock Position:  -0.05141979344087534
Bond Position:  [-4.92041487]


portfolio before change:  [-9.97777139]
curr_Stock_Price:  98.34829431810819
curr_Factors:  [98.34829432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248393]
Stock Position:  -0.02483930193560698
Bond Position:  [-7.53486841]


portfolio before change:  [-9.96955228]
curr_Stock_Price:  97.99844351980117
curr_Factors:  [97.99844352]
mat_Sqrt:  [[0.15]]
grads:  [0.30148805]
Stock Position:  0.3014880534487188
Bond Position:  [-39.51491226]


portfolio before change:  [-9.92620671]
curr_Stock_Price:  98.15040753350553
curr_Factors:  [98.15040753]
mat_Sqrt:  [[0.15]]
grads:  [-0.0682224]
Stock Position:  -0.06822239676993556
Bond Position:  [-3.23015066]


portfolio before change:  [-9.94434341]
curr_Stock_Price:  98.41329497611316
curr_Factors:  [98.41329498]
mat_Sqrt:  [[0.15]]
grads:  [0.02255942]
Stock Position:  0.022559422899882903
Bond Position:  [-12.16449055]


portfolio before change:  [-9.95306863]
curr_Stock_Price:  98.06023121286599
curr_Factors:  [98.06023121]
mat_Sqrt:  [[0.15]]
grads:  [0.03472831]
Stock Position:  0.03472830747852663
Bond Position:  [-13.35853449]


portfolio before change:  [-9.972668]
curr_Stock_Price:  97.51991004403658
curr_Factors:  [97.51991004]
mat_Sqrt:  [[0.15]]
grads:  [0.03206835]
Stock Position:  0.032068351689163735
Bond Position:  [-13.09997078]


portfolio before change:  [-9.96683463]
curr_Stock_Price:  97.72734661638266
curr_Factors:  [97.72734662]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124688]
Stock Position:  -0.012468802541685253
Bond Position:  [-8.74829164]


portfolio before change:  [-9.95954819]
curr_Stock_Price:  97.09912068013988
curr_Factors:  [97.09912068]
mat_Sqrt:  [[0.15]]
grads:  [0.00723134]
Stock Position:  0.007231339609358748
Bond Position:  [-10.66170491]


portfolio before change:  [-9.95766568]
curr_Stock_Price:  97.45159850528746
curr_Factors:  [97.45159851]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422187]
Stock Position:  -0.004221869625418026
Bond Position:  [-9.54623773]


portfolio before change:  [-9.96114464]
curr_Stock_Price:  98.13430701886334
curr_Factors:  [98.13430702]
mat_Sqrt:  [[0.15]]
grads:  [0.0102237]
Stock Position:  0.010223696261555084
Bond Position:  [-10.96443999]


portfolio before change:  [-9.9622064]
curr_Stock_Price:  98.09748501533966
curr_Factors:  [98.09748502]
mat_Sqrt:  [[0.15]]
grads:  [0.00565928]
Stock Position:  0.005659275592217508
Bond Position:  [-10.5173671]


portfolio before change:  [-9.96362584]
curr_Stock_Price:  97.9628244213589
curr_Factors:  [97.96282442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318826]
Stock Position:  -0.003188259316361467
Bond Position:  [-9.65129495]


portfolio before change:  [-9.9651838]
curr_Stock_Price:  98.26227846804504
curr_Factors:  [98.26227847]
mat_Sqrt:  [[0.15]]
grads:  [0.00223112]
Stock Position:  0.0022311215568151382
Bond Position:  [-10.18441889]


portfolio before change:  [-9.96578495]
curr_Stock_Price:  98.2781440111729
curr_Factors:  [98.27814401]
mat_Sqrt:  [[0.15]]
grads:  [0.04191587]
Stock Position:  0.04191586554421823
Bond Position:  [-14.08519842]


portfolio before change:  [-9.9495386]
curr_Stock_Price:  98.68674112012818
curr_Factors:  [98.68674112]
mat_Sqrt:  [[0.15]]
grads:  [-0.11646981]
Stock Position:  -0.11646981296069031
Bond Position:  [1.54448768]


portfolio before change:  [-9.85611743]
curr_Stock_Price:  97.88546363666246
curr_Factors:  [97.88546364]
mat_Sqrt:  [[0.15]]
grads:  [-0.0675709]
Stock Position:  -0.0675709040921385
Bond Position:  [-3.24190815]


portfolio before change:  [-9.83187686]
curr_Stock_Price:  97.52372222124056
curr_Factors:  [97.52372222]
mat_Sqrt:  [[0.15]]
grads:  [-0.05200885]
Stock Position:  -0.0520088547684409
Bond Position:  [-4.75977975]


portfolio before change:  [-9.80728262]
curr_Stock_Price:  97.04511661829176
curr_Factors:  [97.04511662]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150517]
Stock Position:  -0.03150517410183001
Bond Position:  [-6.74985933]


portfolio before change:  [-9.81387226]
curr_Stock_Price:  97.24088617181134
curr_Factors:  [97.24088617]
mat_Sqrt:  [[0.15]]
grads:  [0.10732217]
Stock Position:  0.10732216859778101
Bond Position:  [-20.24997504]


portfolio before change:  [-9.86865716]
curr_Stock_Price:  96.74220782721325
curr_Factors:  [96.74220783]
mat_Sqrt:  [[0.15]]
grads:  [-0.07528766]
Stock Position:  -0.07528766138877083
Bond Position:  [-2.58516258]


portfolio before change:  [-9.84287761]
curr_Stock_Price:  96.3976476240348
curr_Factors:  [96.39764762]
mat_Sqrt:  [[0.15]]
grads:  [0.06653059]
Stock Position:  0.06653059209688428
Bond Position:  [-16.25627018]


portfolio before change:  [-9.82776692]
curr_Stock_Price:  96.6400433520403
curr_Factors:  [96.64004335]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094991]
Stock Position:  -0.000949911845305763
Bond Position:  [-9.7359674]


portfolio before change:  [-9.82847075]
curr_Stock_Price:  96.7403806015301
curr_Factors:  [96.7403806]
mat_Sqrt:  [[0.15]]
grads:  [0.07827653]
Stock Position:  0.07827652750001375
Bond Position:  [-17.40097181]


portfolio before change:  [-9.85620592]
curr_Stock_Price:  96.39995197752759
curr_Factors:  [96.39995198]
mat_Sqrt:  [[0.15]]
grads:  [0.01091305]
Stock Position:  0.010913050560070872
Bond Position:  [-10.90822347]


portfolio before change:  [-9.85799929]
curr_Stock_Price:  96.29809382336627
curr_Factors:  [96.29809382]
mat_Sqrt:  [[0.15]]
grads:  [0.00959395]
Stock Position:  0.009593952294745044
Bond Position:  [-10.7818786]


portfolio before change:  [-9.85259238]
curr_Stock_Price:  96.93190913525748
curr_Factors:  [96.93190914]
mat_Sqrt:  [[0.15]]
grads:  [-0.04448309]
Stock Position:  -0.04448308831809071
Bond Position:  [-5.54076171]


portfolio before change:  [-9.8504014]
curr_Stock_Price:  96.87486967350638
curr_Factors:  [96.87486967]
mat_Sqrt:  [[0.15]]
grads:  [-0.07754378]
Stock Position:  -0.07754377520959406
Bond Position:  [-2.33835828]


portfolio before change:  [-9.88328874]
curr_Stock_Price:  97.29709819813114
curr_Factors:  [97.2970982]
mat_Sqrt:  [[0.15]]
grads:  [0.01966922]
Stock Position:  0.019669222279454536
Bond Position:  [-11.79704699]


portfolio before change:  [-9.8795831]
curr_Stock_Price:  97.52298322440538
curr_Factors:  [97.52298322]
mat_Sqrt:  [[0.15]]
grads:  [0.02190491]
Stock Position:  0.02190491490011385
Bond Position:  [-12.01581575]


portfolio before change:  [-9.88495268]
curr_Stock_Price:  97.31213704557373
curr_Factors:  [97.31213705]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.88495268]
Stock Price:  96.76349923573437
PL:  [-9.88495268]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-5.46497173e-05]
 [ 1.33363926e-03]
 [-2.35657602e-03]
 [ 6.76798875e-03]
 [ 3.65840603e-03]
 [ 2.34877808e-02]
 [ 7.49151886e-04]
 [-1.84850811e-02]
 [-2.21250039e-03]
 [ 2.41001000e-02]
 [-3.21500853e-02]
 [ 3.33829143e-02]
 [-1.01287694e-02]
 [ 1.86507025e-03]
 [-7.03688136e-03]
 [ 1.00233149e-02]
 [ 1.25199395e-02]
 [ 1.88893011e-02]
 [ 1.24776753e-03]
 [ 1.17649386e-02]
 [ 1.31953713e-02]
 [-1.12858562e-02]
 [-7.93120562e-04]
 [-1.26955250e-01]
 [-1.35742721e-02]
 [ 1.65669323e-04]
 [ 3.35843178e-03]
 [ 1.31193633e-02]
 [-6.49179211e-02]
 [ 5.65515281e-03]
 [ 1.58466455e-02]
 [-1.37917562e-02]
 [-6.39149502e-03]
 [ 7.61347877e-03]
 [ 1.37250702e-02]
 [ 4.05696781e-05]
 [-2.93947802e-02]
 [ 7.90057362e-03]
 [-2.88302858e-02]
 [ 1.32871587e-02]
 [-1.21717479e-02]
 [ 4.27592319e-02]
 [ 2.33278780e-02]
 [ 3.68807596e-03]
 [ 6.47714045e-03]
 [ 1.10780860e-02]
 [-9.17623350e-04]
 [-9.61213566e-03]
 [ 1.00947905e-02]
 [ 3.35950505e-03]
 [ 3.74128793e-02]
 [-1.62138383e-03]
 [ 2.27611325e-03]
 [ 5.11714213e-03]
 [ 4.30960409e-03]
 [-1.66198747e-03]
 [ 5.16715131e-03]
 [-6.35529089e-04]
 [ 1.53182526e-03]
 [ 1.23607495e-03]
 [ 8.18482656e-04]
 [-4.29965557e-03]
 [ 1.78580870e-03]
 [-1.60476081e-02]
 [-1.35199651e-02]
 [-1.95303463e-03]
 [-5.03526731e-03]
 [ 2.07719530e-02]
 [-9.22136102e-03]
 [ 6.18218191e-03]
 [-7.11530346e-03]
 [ 1.11576654e-02]
 [-1.95728611e-03]
 [ 5.44265717e-03]
 [-1.40087159e-02]
 [-8.23035523e-03]
 [ 1.71149873e-03]
 [ 3.64652077e-03]
 [-7.80981425e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.04595576]
curr_Stock_Price:  100.3904344980328
curr_Factors:  [100.3904345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00036433]
Stock Position:  -0.0003643314486400512
Bond Position:  [8.08253115]


portfolio before change:  [8.0466591]
curr_Stock_Price:  99.84650807645126
curr_Factors:  [99.84650808]
mat_Sqrt:  [[0.15]]
grads:  [0.00889093]
Stock Position:  0.008890928397406997
Bond Position:  [7.15893095]


portfolio before change:  [8.04073674]
curr_Stock_Price:  99.1300685257482
curr_Factors:  [99.13006853]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571051]
Stock Position:  -0.015710506823185148
Bond Position:  [9.59812035]


portfolio before change:  [8.04683232]
curr_Stock_Price:  98.78025890712999
curr_Factors:  [98.78025891]
mat_Sqrt:  [[0.15]]
grads:  [0.04511992]
Stock Position:  0.04511992499872042
Bond Position:  [3.58987445]


portfolio before change:  [8.07632379]
curr_Stock_Price:  99.42891015355762
curr_Factors:  [99.42891015]
mat_Sqrt:  [[0.15]]
grads:  [0.02438937]
Stock Position:  0.024389373541328172
Bond Position:  [5.65131496]


portfolio before change:  [8.08779888]
curr_Stock_Price:  99.88492297450148
curr_Factors:  [99.88492297]
mat_Sqrt:  [[0.15]]
grads:  [0.15658521]
Stock Position:  0.1565852052449182
Bond Position:  [-7.55270229]


portfolio before change:  [8.075074]
curr_Stock_Price:  99.80667277947673
curr_Factors:  [99.80667278]
mat_Sqrt:  [[0.15]]
grads:  [0.00499435]
Stock Position:  0.004994345904294184
Bond Position:  [7.57660495]


portfolio before change:  [8.07134919]
curr_Stock_Price:  98.9660504542163
curr_Factors:  [98.96605045]
mat_Sqrt:  [[0.15]]
grads:  [-0.12323387]
Stock Position:  -0.1232338740146685
Bond Position:  [20.26731898]


portfolio before change:  [8.12463811]
curr_Stock_Price:  98.54390866182591
curr_Factors:  [98.54390866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475]
Stock Position:  -0.014750002614419902
Bond Position:  [9.57816102]


portfolio before change:  [8.12636135]
curr_Stock_Price:  98.46766521297536
curr_Factors:  [98.46766521]
mat_Sqrt:  [[0.15]]
grads:  [0.16066733]
Stock Position:  0.16066733304445946
Bond Position:  [-7.69417581]


portfolio before change:  [8.03949713]
curr_Stock_Price:  97.93001190539057
curr_Factors:  [97.93001191]
mat_Sqrt:  [[0.15]]
grads:  [-0.2143339]
Stock Position:  -0.21433390216490503
Bond Position:  [29.02921872]


portfolio before change:  [8.30409236]
curr_Stock_Price:  96.70397696906196
curr_Factors:  [96.70397697]
mat_Sqrt:  [[0.15]]
grads:  [0.22255276]
Stock Position:  0.22255276168958946
Bond Position:  [-13.21764478]


portfolio before change:  [8.38993482]
curr_Stock_Price:  97.0934063462403
curr_Factors:  [97.09340635]
mat_Sqrt:  [[0.15]]
grads:  [-0.06752513]
Stock Position:  -0.06752512922679312
Bond Position:  [14.94617963]


portfolio before change:  [8.37611316]
curr_Stock_Price:  97.31192977614654
curr_Factors:  [97.31192978]
mat_Sqrt:  [[0.15]]
grads:  [0.0124338]
Stock Position:  0.012433801640406531
Bond Position:  [7.16615593]


portfolio before change:  [8.37655866]
curr_Stock_Price:  97.31173695913087
curr_Factors:  [97.31173696]
mat_Sqrt:  [[0.15]]
grads:  [-0.04691254]
Stock Position:  -0.046912542388677377
Bond Position:  [12.94169965]


portfolio before change:  [8.36519323]
curr_Stock_Price:  97.57124783487633
curr_Factors:  [97.57124783]
mat_Sqrt:  [[0.15]]
grads:  [0.0668221]
Stock Position:  0.06682209953352336
Bond Position:  [1.84527759]


portfolio before change:  [8.33626545]
curr_Stock_Price:  97.13661452072441
curr_Factors:  [97.13661452]
mat_Sqrt:  [[0.15]]
grads:  [0.08346626]
Stock Position:  0.0834662634003487
Bond Position:  [0.2286352]


portfolio before change:  [8.28136725]
curr_Stock_Price:  96.47871408874016
curr_Factors:  [96.47871409]
mat_Sqrt:  [[0.15]]
grads:  [0.12592867]
Stock Position:  0.12592867390240062
Bond Position:  [-3.86806928]


portfolio before change:  [8.31515127]
curr_Stock_Price:  96.74891291928957
curr_Factors:  [96.74891292]
mat_Sqrt:  [[0.15]]
grads:  [0.00831845]
Stock Position:  0.008318450216422463
Bond Position:  [7.51035025]


portfolio before change:  [8.31210997]
curr_Stock_Price:  96.32687348949872
curr_Factors:  [96.32687349]
mat_Sqrt:  [[0.15]]
grads:  [0.07843292]
Stock Position:  0.07843292425241111
Bond Position:  [0.75691159]


portfolio before change:  [8.27957337]
curr_Stock_Price:  95.91143692057166
curr_Factors:  [95.91143692]
mat_Sqrt:  [[0.15]]
grads:  [0.08796914]
Stock Position:  0.08796914181623532
Bond Position:  [-0.15767343]


portfolio before change:  [8.27677264]
curr_Stock_Price:  95.87971135697826
curr_Factors:  [95.87971136]
mat_Sqrt:  [[0.15]]
grads:  [-0.07523904]
Stock Position:  -0.07523904113891226
Bond Position:  [15.49067019]


portfolio before change:  [8.29478609]
curr_Stock_Price:  95.65316347358626
curr_Factors:  [95.65316347]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528747]
Stock Position:  -0.005287470412191654
Bond Position:  [8.80054936]


portfolio before change:  [8.29974276]
curr_Stock_Price:  94.81975497452461
curr_Factors:  [94.81975497]
mat_Sqrt:  [[0.15]]
grads:  [-0.84636833]
Stock Position:  -0.8463683321554879
Bond Position:  [88.55218063]


portfolio before change:  [8.10235348]
curr_Stock_Price:  95.0595134360676
curr_Factors:  [95.05951344]
mat_Sqrt:  [[0.15]]
grads:  [-0.09049515]
Stock Position:  -0.09049514759652909
Bond Position:  [16.70477817]


portfolio before change:  [8.1010093]
curr_Stock_Price:  95.085904446739
curr_Factors:  [95.08590445]
mat_Sqrt:  [[0.15]]
grads:  [0.00110446]
Stock Position:  0.0011044621513333491
Bond Position:  [7.99599052]


portfolio before change:  [8.10149093]
curr_Stock_Price:  95.0694892715958
curr_Factors:  [95.06948927]
mat_Sqrt:  [[0.15]]
grads:  [0.02238955]
Stock Position:  0.02238954519665847
Bond Position:  [5.97292831]


portfolio before change:  [8.10562833]
curr_Stock_Price:  95.23760670409675
curr_Factors:  [95.2376067]
mat_Sqrt:  [[0.15]]
grads:  [0.08746242]
Stock Position:  0.08746242184280605
Bond Position:  [-0.22408341]


portfolio before change:  [8.1166655]
curr_Stock_Price:  95.36396012129133
curr_Factors:  [95.36396012]
mat_Sqrt:  [[0.15]]
grads:  [-0.43278614]
Stock Position:  -0.4327861409266874
Bond Position:  [49.38886578]


portfolio before change:  [7.99593378]
curr_Stock_Price:  95.65005665103942
curr_Factors:  [95.65005665]
mat_Sqrt:  [[0.15]]
grads:  [0.03770102]
Stock Position:  0.037701018751468425
Bond Position:  [4.3898292]


portfolio before change:  [7.97334376]
curr_Stock_Price:  95.04359046439559
curr_Factors:  [95.04359046]
mat_Sqrt:  [[0.15]]
grads:  [0.1056443]
Stock Position:  0.1056443034928554
Bond Position:  [-2.06747015]


portfolio before change:  [7.93426715]
curr_Stock_Price:  94.6749251002823
curr_Factors:  [94.6749251]
mat_Sqrt:  [[0.15]]
grads:  [-0.09194504]
Stock Position:  -0.09194504112405351
Bond Position:  [16.63915703]


portfolio before change:  [7.97183505]
curr_Stock_Price:  94.27764511244375
curr_Factors:  [94.27764511]
mat_Sqrt:  [[0.15]]
grads:  [-0.04260997]
Stock Position:  -0.04260996680884818
Bond Position:  [11.98900238]


portfolio before change:  [7.95862818]
curr_Stock_Price:  94.60517890903007
curr_Factors:  [94.60517891]
mat_Sqrt:  [[0.15]]
grads:  [0.05075653]
Stock Position:  0.05075652513067656
Bond Position:  [3.15679804]


portfolio before change:  [7.96975892]
curr_Stock_Price:  94.82058818676748
curr_Factors:  [94.82058819]
mat_Sqrt:  [[0.15]]
grads:  [0.09150047]
Stock Position:  0.09150046828259599
Bond Position:  [-0.70636931]


portfolio before change:  [7.94522459]
curr_Stock_Price:  94.55293730621361
curr_Factors:  [94.55293731]
mat_Sqrt:  [[0.15]]
grads:  [0.00027046]
Stock Position:  0.00027046452046842567
Bond Position:  [7.91965137]


portfolio before change:  [7.94570462]
curr_Stock_Price:  94.4976176475377
curr_Factors:  [94.49761765]
mat_Sqrt:  [[0.15]]
grads:  [-0.1959652]
Stock Position:  -0.19596520149519817
Bond Position:  [26.4639493]


portfolio before change:  [7.74369266]
curr_Stock_Price:  95.53691443784146
curr_Factors:  [95.53691444]
mat_Sqrt:  [[0.15]]
grads:  [0.05267049]
Stock Position:  0.05267049080230544
Bond Position:  [2.71171649]


portfolio before change:  [7.82358441]
curr_Stock_Price:  97.05051829866146
curr_Factors:  [97.0505183]
mat_Sqrt:  [[0.15]]
grads:  [-0.19220191]
Stock Position:  -0.19220190541434598
Bond Position:  [26.47687895]


portfolio before change:  [7.85869484]
curr_Stock_Price:  96.87645356768951
curr_Factors:  [96.87645357]
mat_Sqrt:  [[0.15]]
grads:  [0.08858106]
Stock Position:  0.08858105827632398
Bond Position:  [-0.72272394]


portfolio before change:  [7.80951263]
curr_Stock_Price:  96.32174092657087
curr_Factors:  [96.32174093]
mat_Sqrt:  [[0.15]]
grads:  [-0.08114499]
Stock Position:  -0.08114498586024449
Bond Position:  [15.62553894]


portfolio before change:  [7.84210495]
curr_Stock_Price:  95.93212114881342
curr_Factors:  [95.93212115]
mat_Sqrt:  [[0.15]]
grads:  [0.28506155]
Stock Position:  0.2850615462583358
Bond Position:  [-19.50445384]


portfolio before change:  [7.7451774]
curr_Stock_Price:  95.5963744268559
curr_Factors:  [95.59637443]
mat_Sqrt:  [[0.15]]
grads:  [0.15551919]
Stock Position:  0.15551918699246353
Bond Position:  [-7.12189303]


portfolio before change:  [7.73525332]
curr_Stock_Price:  95.53542405732587
curr_Factors:  [95.53542406]
mat_Sqrt:  [[0.15]]
grads:  [0.02458717]
Stock Position:  0.02458717306133605
Bond Position:  [5.38630732]


portfolio before change:  [7.74290633]
curr_Stock_Price:  95.83299188494371
curr_Factors:  [95.83299188]
mat_Sqrt:  [[0.15]]
grads:  [0.04318094]
Stock Position:  0.04318093632354908
Bond Position:  [3.60474801]


portfolio before change:  [7.7553258]
curr_Stock_Price:  96.11538889946827
curr_Factors:  [96.1153889]
mat_Sqrt:  [[0.15]]
grads:  [0.07385391]
Stock Position:  0.07385390660314738
Bond Position:  [0.65682884]


portfolio before change:  [7.72385014]
curr_Stock_Price:  95.68864487792736
curr_Factors:  [95.68864488]
mat_Sqrt:  [[0.15]]
grads:  [-0.00611749]
Stock Position:  -0.006117489000680917
Bond Position:  [8.30922437]


portfolio before change:  [7.72391094]
curr_Stock_Price:  95.76360124167928
curr_Factors:  [95.76360124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0640809]
Stock Position:  -0.06408090441157532
Bond Position:  [13.86052911]


portfolio before change:  [7.72776587]
curr_Stock_Price:  95.7169628868815
curr_Factors:  [95.71696289]
mat_Sqrt:  [[0.15]]
grads:  [0.0672986]
Stock Position:  0.06729860318337856
Bond Position:  [1.28614797]


portfolio before change:  [7.73936074]
curr_Stock_Price:  95.88805828095404
curr_Factors:  [95.88805828]
mat_Sqrt:  [[0.15]]
grads:  [0.0223967]
Stock Position:  0.022396700337560898
Bond Position:  [5.59178463]


portfolio before change:  [7.74328527]
curr_Stock_Price:  96.0476813321836
curr_Factors:  [96.04768133]
mat_Sqrt:  [[0.15]]
grads:  [0.2494192]
Stock Position:  0.24941919520333822
Bond Position:  [-16.21285011]


portfolio before change:  [7.82263252]
curr_Stock_Price:  96.36987219897898
curr_Factors:  [96.3698722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01080923]
Stock Position:  -0.010809225557522837
Bond Position:  [8.86431621]


portfolio before change:  [7.81768333]
curr_Stock_Price:  96.8789950040697
curr_Factors:  [96.878995]
mat_Sqrt:  [[0.15]]
grads:  [0.01517409]
Stock Position:  0.015174088353239289
Bond Position:  [6.3476329]


portfolio before change:  [7.82854254]
curr_Stock_Price:  97.5684904024588
curr_Factors:  [97.5684904]
mat_Sqrt:  [[0.15]]
grads:  [0.03411428]
Stock Position:  0.03411428087618975
Bond Position:  [4.50006365]


portfolio before change:  [7.80371792]
curr_Stock_Price:  96.83255578716938
curr_Factors:  [96.83255579]
mat_Sqrt:  [[0.15]]
grads:  [0.02873069]
Stock Position:  0.028730693951249525
Bond Position:  [5.0216514]


portfolio before change:  [7.82503392]
curr_Stock_Price:  97.56355561729912
curr_Factors:  [97.56355562]
mat_Sqrt:  [[0.15]]
grads:  [-0.01107992]
Stock Position:  -0.011079916483173064
Bond Position:  [8.90602996]


portfolio before change:  [7.82517362]
curr_Stock_Price:  97.60118600055758
curr_Factors:  [97.601186]
mat_Sqrt:  [[0.15]]
grads:  [0.03444768]
Stock Position:  0.034447675426141036
Bond Position:  [4.46303964]


portfolio before change:  [7.83924419]
curr_Stock_Price:  98.00155027432307
curr_Factors:  [98.00155027]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423686]
Stock Position:  -0.004236860596030707
Bond Position:  [8.25446309]


portfolio before change:  [7.83971016]
curr_Stock_Price:  98.01333913302577
curr_Factors:  [98.01333913]
mat_Sqrt:  [[0.15]]
grads:  [0.01021217]
Stock Position:  0.010212168378739606
Bond Position:  [6.83878144]


portfolio before change:  [7.84152677]
curr_Stock_Price:  98.14936996424835
curr_Factors:  [98.14936996]
mat_Sqrt:  [[0.15]]
grads:  [0.0082405]
Stock Position:  0.00824049964938176
Bond Position:  [7.03272692]


portfolio before change:  [7.84513713]
curr_Stock_Price:  98.53415260252689
curr_Factors:  [98.5341526]
mat_Sqrt:  [[0.15]]
grads:  [0.00545655]
Stock Position:  0.005456551038133968
Bond Position:  [7.30748049]


portfolio before change:  [7.8481047]
curr_Stock_Price:  98.99430455146015
curr_Factors:  [98.99430455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02866437]
Stock Position:  -0.02866437047052623
Bond Position:  [10.68571412]


portfolio before change:  [7.85291994]
curr_Stock_Price:  98.84961771342068
curr_Factors:  [98.84961771]
mat_Sqrt:  [[0.15]]
grads:  [0.01190539]
Stock Position:  0.01190539135304456
Bond Position:  [6.67607655]


portfolio before change:  [7.86309198]
curr_Stock_Price:  99.66897567158472
curr_Factors:  [99.66897567]
mat_Sqrt:  [[0.15]]
grads:  [-0.10698405]
Stock Position:  -0.1069840540531238
Bond Position:  [18.52608306]


portfolio before change:  [7.90627143]
curr_Stock_Price:  99.27619248422066
curr_Factors:  [99.27619248]
mat_Sqrt:  [[0.15]]
grads:  [-0.0901331]
Stock Position:  -0.0901331004981309
Bond Position:  [16.85434247]


portfolio before change:  [7.95815136]
curr_Stock_Price:  98.71228755243462
curr_Factors:  [98.71228755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302023]
Stock Position:  -0.013020230864074871
Bond Position:  [9.24340814]


portfolio before change:  [7.95222701]
curr_Stock_Price:  99.21167071361369
curr_Factors:  [99.21167071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03356845]
Stock Position:  -0.033568448708041654
Bond Position:  [11.28260889]


portfolio before change:  [7.97276222]
curr_Stock_Price:  98.62093671786594
curr_Factors:  [98.62093672]
mat_Sqrt:  [[0.15]]
grads:  [0.13847969]
Stock Position:  0.13847968683928621
Bond Position:  [-5.68423421]


portfolio before change:  [7.99663718]
curr_Stock_Price:  98.79590995797922
curr_Factors:  [98.79590996]
mat_Sqrt:  [[0.15]]
grads:  [-0.06147574]
Stock Position:  -0.06147574013845101
Bond Position:  [14.07018887]


portfolio before change:  [7.99559015]
curr_Stock_Price:  98.82724674704525
curr_Factors:  [98.82724675]
mat_Sqrt:  [[0.15]]
grads:  [0.04121455]
Stock Position:  0.04121454604259362
Bond Position:  [3.92247003]


portfolio before change:  [7.99721716]
curr_Stock_Price:  98.86077494276627
curr_Factors:  [98.86077494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04743536]
Stock Position:  -0.047435356389620015
Bond Position:  [12.68671325]


portfolio before change:  [8.03108854]
curr_Stock_Price:  98.16343776790264
curr_Factors:  [98.16343777]
mat_Sqrt:  [[0.15]]
grads:  [0.07438444]
Stock Position:  0.07438443590282916
Bond Position:  [0.72925659]


portfolio before change:  [8.01315486]
curr_Stock_Price:  97.92173051775598
curr_Factors:  [97.92173052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304857]
Stock Position:  -0.01304857404170084
Bond Position:  [9.29089381]


portfolio before change:  [8.01976037]
curr_Stock_Price:  97.46000868224866
curr_Factors:  [97.46000868]
mat_Sqrt:  [[0.15]]
grads:  [0.03628438]
Stock Position:  0.03628438111207206
Bond Position:  [4.48348427]


portfolio before change:  [8.04124949]
curr_Stock_Price:  98.04452730073523
curr_Factors:  [98.0445273]
mat_Sqrt:  [[0.15]]
grads:  [-0.09339144]
Stock Position:  -0.0933914394884834
Bond Position:  [17.19776903]


portfolio before change:  [8.04761243]
curr_Stock_Price:  97.987904954372
curr_Factors:  [97.98790495]
mat_Sqrt:  [[0.15]]
grads:  [-0.05486903]
Stock Position:  -0.054869034880169164
Bond Position:  [13.42411421]


portfolio before change:  [8.05663611]
curr_Stock_Price:  97.83873796376093
curr_Factors:  [97.83873796]
mat_Sqrt:  [[0.15]]
grads:  [0.01140999]
Stock Position:  0.011409991536633374
Bond Position:  [6.94029694]


portfolio before change:  [8.05072315]
curr_Stock_Price:  97.28249305480941
curr_Factors:  [97.28249305]
mat_Sqrt:  [[0.15]]
grads:  [0.02431014]
Stock Position:  0.0243101384720587
Bond Position:  [5.68577227]


portfolio before change:  [8.05210173]
curr_Stock_Price:  97.32458298424228
curr_Factors:  [97.32458298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.05210173]
Stock Price:  97.03095648471266
PL:  [8.05210173]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [-2.71167730e-04]
 [ 7.49469913e-04]
 [-8.90931477e-05]
 [ 6.66672862e-03]
 [ 5.01101626e-03]
 [ 2.45283974e-02]
 [ 1.19165058e-03]
 [-5.58997722e-03]
 [ 2.46554850e-02]
 [-4.54816536e-03]
 [ 1.67100990e-02]
 [-2.10156488e-02]
 [ 8.13240227e-03]
 [ 4.53146781e-03]
 [-6.91472367e-03]
 [ 2.41770787e-02]
 [ 1.11319663e-02]
 [-9.82506111e-03]
 [ 3.97718248e-03]
 [-5.63468801e-03]
 [ 1.38804015e-02]
 [-4.32447465e-03]
 [ 1.02047056e-02]
 [ 8.47537668e-03]
 [ 1.15595767e-03]
 [ 1.18282117e-02]
 [-5.53464922e-03]
 [ 9.35139609e-03]
 [ 3.73605548e-02]
 [ 1.02072109e-03]
 [ 1.84883632e-02]
 [-4.42433956e-03]
 [ 1.86108863e-03]
 [ 8.36734964e-03]
 [ 1.01063329e-02]
 [ 5.74674434e-03]
 [-3.22244309e-02]
 [ 8.72407356e-03]
 [ 1.27051110e-02]
 [ 5.24483420e-03]
 [-4.19860026e-03]
 [-1.66055154e-02]
 [ 2.05175739e-02]
 [-2.60155789e-03]
 [ 3.32108583e-03]
 [-1.63612590e-02]
 [ 1.53471030e-02]
 [ 2.05082883e-02]
 [ 9.10081505e-03]
 [-7.69116342e-03]
 [ 4.35451293e-02]
 [ 1.06064698e-02]
 [-1.13421466e-02]
 [ 5.69737742e-03]
 [-2.48688635e-02]
 [ 2.97501668e-02]
 [ 1.71523338e-02]
 [ 1.94816808e-03]
 [ 1.95279768e-03]
 [ 3.57122401e-03]
 [ 1.51359281e-02]
 [ 3.19507802e-02]
 [-2.45185259e-03]
 [-1.18189312e-02]
 [ 1.87140641e-02]
 [ 9.59680680e-03]
 [-4.76867181e-03]
 [ 1.57448656e-02]
 [-2.10184013e-02]
 [-4.64836052e-02]
 [-2.86056618e-03]
 [ 1.61453230e-02]
 [-2.41042962e-02]
 [ 2.77654296e-02]
 [-2.71166960e-02]
 [ 3.43349536e-03]
 [ 2.61260863e-03]
 [-1.23983706e-02]
 [ 2.60529057e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.72157373]
curr_Stock_Price:  100.88954124094826
curr_Factors:  [100.88954124]
mat_Sqrt:  [[0.15]]
grads:  [-0.00180778]
Stock Position:  -0.0018077848661235667
Bond Position:  [15.90396031]


portfolio before change:  [15.72255453]
curr_Stock_Price:  100.89685838481817
curr_Factors:  [100.89685838]
mat_Sqrt:  [[0.15]]
grads:  [0.00499647]
Stock Position:  0.004996466088108308
Bond Position:  [15.2184268]


portfolio before change:  [15.71984817]
curr_Stock_Price:  100.16483276658472
curr_Factors:  [100.16483277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059395]
Stock Position:  -0.0005939543177744626
Bond Position:  [15.7793415]


portfolio before change:  [15.72068356]
curr_Stock_Price:  100.41880019422564
curr_Factors:  [100.41880019]
mat_Sqrt:  [[0.15]]
grads:  [0.04444486]
Stock Position:  0.04444485749454238
Bond Position:  [11.2575843]


portfolio before change:  [15.69202212]
curr_Stock_Price:  99.75809241312993
curr_Factors:  [99.75809241]
mat_Sqrt:  [[0.15]]
grads:  [0.03340678]
Stock Position:  0.0334067750515153
Bond Position:  [12.35942597]


portfolio before change:  [15.70256728]
curr_Stock_Price:  100.05062795303651
curr_Factors:  [100.05062795]
mat_Sqrt:  [[0.15]]
grads:  [0.16352265]
Stock Position:  0.1635226493397303
Bond Position:  [-0.65797647]


portfolio before change:  [15.85568188]
curr_Stock_Price:  100.98723048777074
curr_Factors:  [100.98723049]
mat_Sqrt:  [[0.15]]
grads:  [0.00794434]
Stock Position:  0.007944337212304482
Bond Position:  [15.05340527]


portfolio before change:  [15.85745908]
curr_Stock_Price:  101.09250423850985
curr_Factors:  [101.09250424]
mat_Sqrt:  [[0.15]]
grads:  [-0.03726651]
Stock Position:  -0.03726651480906407
Bond Position:  [19.62482438]


portfolio before change:  [15.86925973]
curr_Stock_Price:  100.80876248572292
curr_Factors:  [100.80876249]
mat_Sqrt:  [[0.15]]
grads:  [0.1643699]
Stock Position:  0.16436989996320397
Bond Position:  [-0.70066647]


portfolio before change:  [15.95872665]
curr_Stock_Price:  101.35333120051666
curr_Factors:  [101.3533312]
mat_Sqrt:  [[0.15]]
grads:  [-0.0303211]
Stock Position:  -0.03032110241241094
Bond Position:  [19.03187138]


portfolio before change:  [15.972378]
curr_Stock_Price:  100.94233600261275
curr_Factors:  [100.942336]
mat_Sqrt:  [[0.15]]
grads:  [0.11140066]
Stock Position:  0.11140066031745384
Bond Position:  [4.72733512]


portfolio before change:  [15.95009653]
curr_Stock_Price:  100.73967164744394
curr_Factors:  [100.73967165]
mat_Sqrt:  [[0.15]]
grads:  [-0.14010433]
Stock Position:  -0.14010432504427323
Bond Position:  [30.06416023]


portfolio before change:  [15.98004442]
curr_Stock_Price:  100.53932931475913
curr_Factors:  [100.53932931]
mat_Sqrt:  [[0.15]]
grads:  [0.05421602]
Stock Position:  0.054216015116810894
Bond Position:  [10.52920263]


portfolio before change:  [15.95665681]
curr_Stock_Price:  100.09581258979595
curr_Factors:  [100.09581259]
mat_Sqrt:  [[0.15]]
grads:  [0.03020979]
Stock Position:  0.030209785378602992
Bond Position:  [12.93278379]


portfolio before change:  [15.97579887]
curr_Stock_Price:  100.70269336050735
curr_Factors:  [100.70269336]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609816]
Stock Position:  -0.04609815780707127
Bond Position:  [20.61800752]


portfolio before change:  [15.92525405]
curr_Stock_Price:  101.82710894709777
curr_Factors:  [101.82710895]
mat_Sqrt:  [[0.15]]
grads:  [0.16118052]
Stock Position:  0.16118052467765512
Bond Position:  [-0.4872928]


portfolio before change:  [16.0177251]
curr_Stock_Price:  102.40100899493896
curr_Factors:  [102.40100899]
mat_Sqrt:  [[0.15]]
grads:  [0.07421311]
Stock Position:  0.0742131089106794
Bond Position:  [8.41822787]


portfolio before change:  [15.99982541]
curr_Stock_Price:  102.15272605134658
curr_Factors:  [102.15272605]
mat_Sqrt:  [[0.15]]
grads:  [-0.06550041]
Stock Position:  -0.06550040741387383
Bond Position:  [22.69087059]


portfolio before change:  [15.99494237]
curr_Stock_Price:  102.24892804172181
curr_Factors:  [102.24892804]
mat_Sqrt:  [[0.15]]
grads:  [0.02651455]
Stock Position:  0.026514549873652857
Bond Position:  [13.28385806]


portfolio before change:  [15.98859445]
curr_Stock_Price:  101.97820177640335
curr_Factors:  [101.97820178]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756459]
Stock Position:  -0.03756458672610731
Bond Position:  [19.81936345]


portfolio before change:  [15.99202256]
curr_Stock_Price:  101.91991911292118
curr_Factors:  [101.91991911]
mat_Sqrt:  [[0.15]]
grads:  [0.09253601]
Stock Position:  0.09253601021263767
Bond Position:  [6.56075988]


portfolio before change:  [15.99088958]
curr_Stock_Price:  101.90324407814455
curr_Factors:  [101.90324408]
mat_Sqrt:  [[0.15]]
grads:  [-0.02882983]
Stock Position:  -0.028829831010323444
Bond Position:  [18.92874289]


portfolio before change:  [15.99696845]
curr_Stock_Price:  101.73342740031515
curr_Factors:  [101.7334274]
mat_Sqrt:  [[0.15]]
grads:  [0.06803137]
Stock Position:  0.06803137082904863
Bond Position:  [9.07590392]


portfolio before change:  [15.99201829]
curr_Stock_Price:  101.65232631642432
curr_Factors:  [101.65232632]
mat_Sqrt:  [[0.15]]
grads:  [0.05650251]
Stock Position:  0.05650251117282841
Bond Position:  [10.24840659]


portfolio before change:  [15.96357187]
curr_Stock_Price:  101.13753558935304
curr_Factors:  [101.13753559]
mat_Sqrt:  [[0.15]]
grads:  [0.00770638]
Stock Position:  0.007706384448628046
Bond Position:  [15.18416714]


portfolio before change:  [15.96695621]
curr_Stock_Price:  101.4535458546615
curr_Factors:  [101.45354585]
mat_Sqrt:  [[0.15]]
grads:  [0.07885474]
Stock Position:  0.07885474488133776
Bond Position:  [7.96686273]


portfolio before change:  [15.96346857]
curr_Stock_Price:  101.40300252321529
curr_Factors:  [101.40300252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689766]
Stock Position:  -0.03689766148053177
Bond Position:  [19.70500223]


portfolio before change:  [15.94156989]
curr_Stock_Price:  102.0298790117911
curr_Factors:  [102.02987901]
mat_Sqrt:  [[0.15]]
grads:  [0.06234264]
Stock Position:  0.06234264056732689
Bond Position:  [9.58075782]


portfolio before change:  [15.9749166]
curr_Stock_Price:  102.55516784600552
curr_Factors:  [102.55516785]
mat_Sqrt:  [[0.15]]
grads:  [0.24907037]
Stock Position:  0.24907036531802754
Bond Position:  [-9.56853652]


portfolio before change:  [15.99305038]
curr_Stock_Price:  102.63037480267035
curr_Factors:  [102.6303748]
mat_Sqrt:  [[0.15]]
grads:  [0.00680481]
Stock Position:  0.006804807282861355
Bond Position:  [15.29467045]


portfolio before change:  [16.00094141]
curr_Stock_Price:  103.64951973328897
curr_Factors:  [103.64951973]
mat_Sqrt:  [[0.15]]
grads:  [0.12325575]
Stock Position:  0.12325575446530466
Bond Position:  [3.22554165]


portfolio before change:  [15.96299968]
curr_Stock_Price:  103.34005487049745
curr_Factors:  [103.34005487]
mat_Sqrt:  [[0.15]]
grads:  [-0.0294956]
Stock Position:  -0.029495597058902246
Bond Position:  [19.0110763]


portfolio before change:  [15.97076622]
curr_Stock_Price:  103.1170280618201
curr_Factors:  [103.11702806]
mat_Sqrt:  [[0.15]]
grads:  [0.01240726]
Stock Position:  0.01240725755862727
Bond Position:  [14.6913667]


portfolio before change:  [15.98018314]
curr_Stock_Price:  103.80200479966776
curr_Factors:  [103.8020048]
mat_Sqrt:  [[0.15]]
grads:  [0.05578233]
Stock Position:  0.05578233094445446
Bond Position:  [10.18986536]


portfolio before change:  [16.00674655]
curr_Stock_Price:  104.2667849017744
curr_Factors:  [104.2667849]
mat_Sqrt:  [[0.15]]
grads:  [0.06737555]
Stock Position:  0.06737555234604341
Bond Position:  [8.98171432]


portfolio before change:  [16.04719683]
curr_Stock_Price:  104.85882317403825
curr_Factors:  [104.85882317]
mat_Sqrt:  [[0.15]]
grads:  [0.03831163]
Stock Position:  0.03831162891862988
Bond Position:  [12.02988451]


portfolio before change:  [16.03953418]
curr_Stock_Price:  104.63918911407166
curr_Factors:  [104.63918911]
mat_Sqrt:  [[0.15]]
grads:  [-0.21482954]
Stock Position:  -0.21482953916506556
Bond Position:  [38.51912296]


portfolio before change:  [16.04573972]
curr_Stock_Price:  104.6215098788205
curr_Factors:  [104.62150988]
mat_Sqrt:  [[0.15]]
grads:  [0.05816049]
Stock Position:  0.058160490385510875
Bond Position:  [9.9609014]


portfolio before change:  [16.01624016]
curr_Stock_Price:  104.10359569432983
curr_Factors:  [104.10359569]
mat_Sqrt:  [[0.15]]
grads:  [0.08470074]
Stock Position:  0.08470074007820075
Bond Position:  [7.19858856]


portfolio before change:  [16.02192731]
curr_Stock_Price:  104.16542779352098
curr_Factors:  [104.16542779]
mat_Sqrt:  [[0.15]]
grads:  [0.03496556]
Stock Position:  0.0349655613212068
Bond Position:  [12.37972465]


portfolio before change:  [16.02970665]
curr_Stock_Price:  104.36578446313335
curr_Factors:  [104.36578446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02799067]
Stock Position:  -0.027990668377813468
Bond Position:  [18.95097471]


portfolio before change:  [16.03660656]
curr_Stock_Price:  104.16159365170844
curr_Factors:  [104.16159365]
mat_Sqrt:  [[0.15]]
grads:  [-0.11070344]
Stock Position:  -0.11070343620391658
Bond Position:  [27.5676529]


portfolio before change:  [16.04032852]
curr_Stock_Price:  104.14353703897899
curr_Factors:  [104.14353704]
mat_Sqrt:  [[0.15]]
grads:  [0.13678383]
Stock Position:  0.13678382594336438
Bond Position:  [1.79517708]


portfolio before change:  [16.01004307]
curr_Stock_Price:  103.92130569742503
curr_Factors:  [103.9213057]
mat_Sqrt:  [[0.15]]
grads:  [-0.01734372]
Stock Position:  -0.017343719240483897
Bond Position:  [17.81242502]


portfolio before change:  [16.02086057]
curr_Stock_Price:  103.3617835787892
curr_Factors:  [103.36178358]
mat_Sqrt:  [[0.15]]
grads:  [0.02214057]
Stock Position:  0.022140572172370667
Bond Position:  [13.73237154]


portfolio before change:  [16.03927583]
curr_Stock_Price:  104.1547603019336
curr_Factors:  [104.1547603]
mat_Sqrt:  [[0.15]]
grads:  [-0.10907506]
Stock Position:  -0.1090750601012998
Bond Position:  [27.39996257]


portfolio before change:  [15.86037877]
curr_Stock_Price:  105.8105889762072
curr_Factors:  [105.81058898]
mat_Sqrt:  [[0.15]]
grads:  [0.10231402]
Stock Position:  0.10231401969608162
Bond Position:  [5.03447209]


portfolio before change:  [15.83996319]
curr_Stock_Price:  105.60797508925208
curr_Factors:  [105.60797509]
mat_Sqrt:  [[0.15]]
grads:  [0.13672192]
Stock Position:  0.1367219222967565
Bond Position:  [1.40103783]


portfolio before change:  [15.87982516]
curr_Stock_Price:  105.89888961975501
curr_Factors:  [105.89888962]
mat_Sqrt:  [[0.15]]
grads:  [0.0606721]
Stock Position:  0.06067210032365266
Bond Position:  [9.4547171]


portfolio before change:  [15.90509288]
curr_Stock_Price:  106.30561339425539
curr_Factors:  [106.30561339]
mat_Sqrt:  [[0.15]]
grads:  [-0.05127442]
Stock Position:  -0.05127442277533461
Bond Position:  [21.35585184]


portfolio before change:  [15.87382457]
curr_Stock_Price:  106.9414682659465
curr_Factors:  [106.94146827]
mat_Sqrt:  [[0.15]]
grads:  [0.29030086]
Stock Position:  0.29030086213264017
Bond Position:  [-15.17137586]


portfolio before change:  [15.94855986]
curr_Stock_Price:  107.20217548157902
curr_Factors:  [107.20217548]
mat_Sqrt:  [[0.15]]
grads:  [0.0707098]
Stock Position:  0.0707097986260572
Bond Position:  [8.36831562]


portfolio before change:  [15.99662372]
curr_Stock_Price:  107.87451261461061
curr_Factors:  [107.87451261]
mat_Sqrt:  [[0.15]]
grads:  [-0.07561431]
Stock Position:  -0.07561431043319439
Bond Position:  [24.1534806]


portfolio before change:  [15.98676242]
curr_Stock_Price:  108.0248933608559
curr_Factors:  [108.02489336]
mat_Sqrt:  [[0.15]]
grads:  [0.03798252]
Stock Position:  0.0379825161517679
Bond Position:  [11.88370517]


portfolio before change:  [15.97785103]
curr_Stock_Price:  107.77071986859868
curr_Factors:  [107.77071987]
mat_Sqrt:  [[0.15]]
grads:  [-0.16579242]
Stock Position:  -0.1657924232695079
Bond Position:  [33.84541983]


portfolio before change:  [16.16948336]
curr_Stock_Price:  106.62762222828391
curr_Factors:  [106.62762223]
mat_Sqrt:  [[0.15]]
grads:  [0.19833445]
Stock Position:  0.19833444528099356
Bond Position:  [-4.97844695]


portfolio before change:  [16.29196594]
curr_Stock_Price:  107.24674687056587
curr_Factors:  [107.24674687]
mat_Sqrt:  [[0.15]]
grads:  [0.11434889]
Stock Position:  0.11434889172559755
Bond Position:  [4.02841929]


portfolio before change:  [16.25268037]
curr_Stock_Price:  106.90098612274365
curr_Factors:  [106.90098612]
mat_Sqrt:  [[0.15]]
grads:  [0.01298779]
Stock Position:  0.01298778720889053
Bond Position:  [14.86427311]


portfolio before change:  [16.24641986]
curr_Stock_Price:  106.3474238397902
curr_Factors:  [106.34742384]
mat_Sqrt:  [[0.15]]
grads:  [0.01301865]
Stock Position:  0.013018651218805133
Bond Position:  [14.86191984]


portfolio before change:  [16.24719575]
curr_Stock_Price:  106.33567060049471
curr_Factors:  [106.3356706]
mat_Sqrt:  [[0.15]]
grads:  [0.02380816]
Stock Position:  0.023808160075202818
Bond Position:  [13.71553908]


portfolio before change:  [16.23617235]
curr_Stock_Price:  105.83665484268957
curr_Factors:  [105.83665484]
mat_Sqrt:  [[0.15]]
grads:  [0.10090619]
Stock Position:  0.10090618753918179
Bond Position:  [5.55659901]


portfolio before change:  [16.16157377]
curr_Stock_Price:  105.09392656482721
curr_Factors:  [105.09392656]
mat_Sqrt:  [[0.15]]
grads:  [0.2130052]
Stock Position:  0.21300520112766305
Bond Position:  [-6.22397919]


portfolio before change:  [16.46119103]
curr_Stock_Price:  106.50237229222985
curr_Factors:  [106.50237229]
mat_Sqrt:  [[0.15]]
grads:  [-0.01634568]
Stock Position:  -0.016345683959831474
Bond Position:  [18.20204514]


portfolio before change:  [16.44357022]
curr_Stock_Price:  107.64998202178177
curr_Factors:  [107.64998202]
mat_Sqrt:  [[0.15]]
grads:  [-0.07879287]
Stock Position:  -0.07879287474248804
Bond Position:  [24.92562177]


portfolio before change:  [16.43157802]
curr_Stock_Price:  107.82195325906645
curr_Factors:  [107.82195326]
mat_Sqrt:  [[0.15]]
grads:  [0.12476043]
Stock Position:  0.1247604272126595
Bond Position:  [2.97966506]


portfolio before change:  [16.45153306]
curr_Stock_Price:  107.98040743887405
curr_Factors:  [107.98040744]
mat_Sqrt:  [[0.15]]
grads:  [0.06397871]
Stock Position:  0.0639787120235602
Bond Position:  [9.54308567]


portfolio before change:  [16.42523544]
curr_Stock_Price:  107.56004759677008
curr_Factors:  [107.5600476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03179115]
Stock Position:  -0.03179114537388587
Bond Position:  [19.84469255]


portfolio before change:  [16.41840592]
curr_Stock_Price:  107.81388722643939
curr_Factors:  [107.81388723]
mat_Sqrt:  [[0.15]]
grads:  [0.10496577]
Stock Position:  0.10496577074003059
Bond Position:  [5.10163815]


portfolio before change:  [16.43081404]
curr_Stock_Price:  107.9290605399736
curr_Factors:  [107.92906054]
mat_Sqrt:  [[0.15]]
grads:  [-0.14012268]
Stock Position:  -0.1401226750984513
Bond Position:  [31.55412272]


portfolio before change:  [16.38667372]
curr_Stock_Price:  108.25814726076825
curr_Factors:  [108.25814726]
mat_Sqrt:  [[0.15]]
grads:  [-0.3098907]
Stock Position:  -0.30989070144853564
Bond Position:  [49.93486691]


portfolio before change:  [16.38073354]
curr_Stock_Price:  108.2873872650953
curr_Factors:  [108.28738727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01907044]
Stock Position:  -0.01907044118359009
Bond Position:  [18.44582179]


portfolio before change:  [16.39234608]
curr_Stock_Price:  107.73891353302965
curr_Factors:  [107.73891353]
mat_Sqrt:  [[0.15]]
grads:  [0.10763549]
Stock Position:  0.10763548670037029
Bond Position:  [4.79581568]


portfolio before change:  [16.30507367]
curr_Stock_Price:  106.92531425706628
curr_Factors:  [106.92531426]
mat_Sqrt:  [[0.15]]
grads:  [-0.16069531]
Stock Position:  -0.1606953082484677
Bond Position:  [33.48747001]


portfolio before change:  [16.45300593]
curr_Stock_Price:  106.01776302037474
curr_Factors:  [106.01776302]
mat_Sqrt:  [[0.15]]
grads:  [0.18510286]
Stock Position:  0.1851028640642338
Bond Position:  [-3.17118565]


portfolio before change:  [16.44057191]
curr_Stock_Price:  105.95166023358001
curr_Factors:  [105.95166023]
mat_Sqrt:  [[0.15]]
grads:  [-0.18077797]
Stock Position:  -0.18077797341752214
Bond Position:  [35.59429833]


portfolio before change:  [16.43358368]
curr_Stock_Price:  106.00262297082254
curr_Factors:  [106.00262297]
mat_Sqrt:  [[0.15]]
grads:  [0.02288997]
Stock Position:  0.022889969065397874
Bond Position:  [14.00718692]


portfolio before change:  [16.4224976]
curr_Stock_Price:  105.48005501535653
curr_Factors:  [105.48005502]
mat_Sqrt:  [[0.15]]
grads:  [0.01741739]
Stock Position:  0.017417390851937067
Bond Position:  [14.58531025]


portfolio before change:  [16.42303478]
curr_Stock_Price:  105.45855784721923
curr_Factors:  [105.45855785]
mat_Sqrt:  [[0.15]]
grads:  [-0.0826558]
Stock Position:  -0.08265580393029803
Bond Position:  [25.13979666]


portfolio before change:  [16.42283127]
curr_Stock_Price:  105.48002994897197
curr_Factors:  [105.48002995]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.42283127]
Stock Price:  105.34649974582956
PL:  [11.07633153]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 4.69511855e-03]
 [-5.22474347e-04]
 [-2.14356908e-03]
 [ 2.12046926e-03]
 [ 2.49461322e-02]
 [ 2.70745059e-02]
 [ 3.66927312e-03]
 [ 1.08718041e-02]
 [ 2.45724592e-02]
 [-1.67120844e-03]
 [ 5.54498008e-02]
 [ 3.63225830e-02]
 [ 1.02052430e-01]
 [ 1.20970826e-02]
 [-6.90093325e-03]
 [ 2.44208193e-02]
 [ 1.10853110e-02]
 [-4.95037357e-03]
 [ 5.40476985e-03]
 [-7.67604054e-03]
 [ 1.45523410e-02]
 [-1.02997965e-02]
 [ 1.10964081e-02]
 [-8.98137192e-03]
 [ 1.40293616e-03]
 [ 1.15169305e-02]
 [-6.48115299e-03]
 [ 7.66875464e-03]
 [ 2.98018422e-02]
 [-2.39049918e-03]
 [ 1.13895115e-02]
 [-9.51398706e-03]
 [-8.47919030e-04]
 [ 8.52927158e-03]
 [ 1.04842072e-02]
 [ 7.48037348e-03]
 [-3.27000840e-02]
 [ 8.94537456e-03]
 [ 1.10893381e-02]
 [ 1.62158874e-02]
 [-4.16538174e-03]
 [-2.03673533e-02]
 [ 2.12400042e-02]
 [ 9.30075954e-05]
 [-5.14471994e-04]
 [-1.39078231e-02]
 [ 1.36839606e-02]
 [ 1.26761715e-03]
 [-5.66394616e-03]
 [-7.52484166e-03]
 [-2.35679718e-02]
 [ 1.84831806e-04]
 [-4.94501104e-03]
 [ 5.40938378e-03]
 [ 3.99970222e-03]
 [-1.71689726e-03]
 [ 5.81784077e-03]
 [-2.99505298e-04]
 [ 1.55491823e-03]
 [-3.60567601e-03]
 [ 9.00849938e-04]
 [-1.08530357e-02]
 [-4.00262512e-03]
 [-1.63796904e-02]
 [-1.11212551e-02]
 [ 1.75014781e-03]
 [-5.18096282e-03]
 [ 2.02677232e-02]
 [-9.38709391e-03]
 [ 6.73062088e-03]
 [-2.51345749e-03]
 [ 1.15034650e-02]
 [ 3.02647144e-04]
 [ 4.55431884e-03]
 [-1.38152799e-02]
 [-5.29354974e-03]
 [-1.28616710e-03]
 [ 1.66037727e-03]
 [-3.44776096e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.73811695]
curr_Stock_Price:  99.4291007778903
curr_Factors:  [99.42910078]
mat_Sqrt:  [[0.15]]
grads:  [0.03130079]
Stock Position:  0.03130079036380763
Bond Position:  [-9.85032639]


portfolio before change:  [-6.73279241]
curr_Stock_Price:  99.61887879996641
curr_Factors:  [99.6188788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00348316]
Stock Position:  -0.0034831623110531413
Bond Position:  [-6.38580369]


portfolio before change:  [-6.73626102]
curr_Stock_Price:  100.50011302842456
curr_Factors:  [100.50011303]
mat_Sqrt:  [[0.15]]
grads:  [-0.01429046]
Stock Position:  -0.014290460501817006
Bond Position:  [-5.30006812]


portfolio before change:  [-6.75059369]
curr_Stock_Price:  101.47988576543956
curr_Factors:  [101.47988577]
mat_Sqrt:  [[0.15]]
grads:  [0.01413646]
Stock Position:  0.014136461702050445
Bond Position:  [-8.18516021]


portfolio before change:  [-6.74766073]
curr_Stock_Price:  101.72354994303242
curr_Factors:  [101.72354994]
mat_Sqrt:  [[0.15]]
grads:  [0.16630755]
Stock Position:  0.16630754790195032
Bond Position:  [-23.66505488]


portfolio before change:  [-6.72960082]
curr_Stock_Price:  101.84103718788234
curr_Factors:  [101.84103719]
mat_Sqrt:  [[0.15]]
grads:  [0.18049671]
Stock Position:  0.18049670621108002
Bond Position:  [-25.11157259]


portfolio before change:  [-6.67033069]
curr_Stock_Price:  102.17810517355326
curr_Factors:  [102.17810517]
mat_Sqrt:  [[0.15]]
grads:  [0.02446182]
Stock Position:  0.02446182081140254
Bond Position:  [-9.16979318]


portfolio before change:  [-6.67601393]
curr_Stock_Price:  101.96920362614
curr_Factors:  [101.96920363]
mat_Sqrt:  [[0.15]]
grads:  [0.07247869]
Stock Position:  0.07247869418709661
Bond Position:  [-14.06660865]


portfolio before change:  [-6.64776352]
curr_Stock_Price:  102.37110932622572
curr_Factors:  [102.37110933]
mat_Sqrt:  [[0.15]]
grads:  [0.16381639]
Stock Position:  0.1638163948382176
Bond Position:  [-23.41782958]


portfolio before change:  [-6.45652309]
curr_Stock_Price:  103.5474512477268
curr_Factors:  [103.54745125]
mat_Sqrt:  [[0.15]]
grads:  [-0.01114139]
Stock Position:  -0.011141389594462339
Bond Position:  [-5.30286059]


portfolio before change:  [-6.45646291]
curr_Stock_Price:  103.51230184936446
curr_Factors:  [103.51230185]
mat_Sqrt:  [[0.15]]
grads:  [0.36966534]
Stock Position:  0.3696653387095176
Bond Position:  [-44.72137303]


portfolio before change:  [-6.64684599]
curr_Stock_Price:  103.00484851976796
curr_Factors:  [103.00484852]
mat_Sqrt:  [[0.15]]
grads:  [0.24215055]
Stock Position:  0.2421505530551416
Bond Position:  [-31.58952703]


portfolio before change:  [-6.65667354]
curr_Stock_Price:  102.9724176856967
curr_Factors:  [102.97241769]
mat_Sqrt:  [[0.15]]
grads:  [0.68034954]
Stock Position:  0.680349536006128
Bond Position:  [-76.71391014]


portfolio before change:  [-6.88840942]
curr_Stock_Price:  102.63885222723434
curr_Factors:  [102.63885223]
mat_Sqrt:  [[0.15]]
grads:  [0.08064722]
Stock Position:  0.08064721718320281
Bond Position:  [-15.16594722]


portfolio before change:  [-6.91316888]
curr_Stock_Price:  102.34359642226703
curr_Factors:  [102.34359642]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600622]
Stock Position:  -0.04600622164795808
Bond Position:  [-2.2047267]


portfolio before change:  [-6.89219566]
curr_Stock_Price:  101.88472340289339
curr_Factors:  [101.8847234]
mat_Sqrt:  [[0.15]]
grads:  [0.16280546]
Stock Position:  0.1628054623005577
Bond Position:  [-23.47958516]


portfolio before change:  [-6.82481793]
curr_Stock_Price:  102.30759163014926
curr_Factors:  [102.30759163]
mat_Sqrt:  [[0.15]]
grads:  [0.07390207]
Stock Position:  0.0739020733921705
Bond Position:  [-14.38556107]


portfolio before change:  [-6.75047843]
curr_Stock_Price:  103.32567697054772
curr_Factors:  [103.32567697]
mat_Sqrt:  [[0.15]]
grads:  [-0.03300249]
Stock Position:  -0.033002490499467074
Bond Position:  [-3.34047376]


portfolio before change:  [-6.72497255]
curr_Stock_Price:  102.54650323815719
curr_Factors:  [102.54650324]
mat_Sqrt:  [[0.15]]
grads:  [0.0360318]
Stock Position:  0.03603179902733344
Bond Position:  [-10.41990754]


portfolio before change:  [-6.69251744]
curr_Stock_Price:  103.46531316639016
curr_Factors:  [103.46531317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0511736]
Stock Position:  -0.05117360359075889
Bond Position:  [-1.39782451]


portfolio before change:  [-6.69078812]
curr_Stock_Price:  103.42981273796917
curr_Factors:  [103.42981274]
mat_Sqrt:  [[0.15]]
grads:  [0.09701561]
Stock Position:  0.09701560633756394
Bond Position:  [-16.72509411]


portfolio before change:  [-6.70914474]
curr_Stock_Price:  103.25137471029528
curr_Factors:  [103.25137471]
mat_Sqrt:  [[0.15]]
grads:  [-0.06866531]
Stock Position:  -0.06866530998591945
Bond Position:  [0.38064291]


portfolio before change:  [-6.69001704]
curr_Stock_Price:  102.97315693996985
curr_Factors:  [102.97315694]
mat_Sqrt:  [[0.15]]
grads:  [0.07397605]
Stock Position:  0.07397605371919135
Bond Position:  [-14.30756483]


portfolio before change:  [-6.73727059]
curr_Stock_Price:  102.34647713227115
curr_Factors:  [102.34647713]
mat_Sqrt:  [[0.15]]
grads:  [-0.05987581]
Stock Position:  -0.05987581279215809
Bond Position:  [-0.60919209]


portfolio before change:  [-6.6742002]
curr_Stock_Price:  101.29248774358739
curr_Factors:  [101.29248774]
mat_Sqrt:  [[0.15]]
grads:  [0.00935291]
Stock Position:  0.009352907740399671
Bond Position:  [-7.62157949]


portfolio before change:  [-6.67229428]
curr_Stock_Price:  101.54719791440492
curr_Factors:  [101.54719791]
mat_Sqrt:  [[0.15]]
grads:  [0.07677954]
Stock Position:  0.07677953647730758
Bond Position:  [-14.46904107]


portfolio before change:  [-6.74335532]
curr_Stock_Price:  100.63345577365469
curr_Factors:  [100.63345577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04320769]
Stock Position:  -0.04320768657226518
Bond Position:  [-2.39521651]


portfolio before change:  [-6.76592672]
curr_Stock_Price:  101.15238414519753
curr_Factors:  [101.15238415]
mat_Sqrt:  [[0.15]]
grads:  [0.05112503]
Stock Position:  0.05112503092557998
Bond Position:  [-11.93734549]


portfolio before change:  [-6.71864675]
curr_Stock_Price:  102.09176904553165
curr_Factors:  [102.09176905]
mat_Sqrt:  [[0.15]]
grads:  [0.19867895]
Stock Position:  0.1986789483036478
Bond Position:  [-27.00213205]


portfolio before change:  [-6.89859851]
curr_Stock_Price:  101.19452211027254
curr_Factors:  [101.19452211]
mat_Sqrt:  [[0.15]]
grads:  [-0.01593666]
Stock Position:  -0.01593666122980791
Bond Position:  [-5.28589569]


portfolio before change:  [-6.90660916]
curr_Stock_Price:  101.67644676085291
curr_Factors:  [101.67644676]
mat_Sqrt:  [[0.15]]
grads:  [0.07593008]
Stock Position:  0.07593007662088835
Bond Position:  [-14.62690955]


portfolio before change:  [-6.83659246]
curr_Stock_Price:  102.61060770526879
curr_Factors:  [102.61060771]
mat_Sqrt:  [[0.15]]
grads:  [-0.06342658]
Stock Position:  -0.06342658042729714
Bond Position:  [-0.32835249]


portfolio before change:  [-6.90617719]
curr_Stock_Price:  103.70737521893145
curr_Factors:  [103.70737522]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565279]
Stock Position:  -0.005652793536295563
Bond Position:  [-6.31994081]


portfolio before change:  [-6.90570743]
curr_Stock_Price:  103.55439322895612
curr_Factors:  [103.55439323]
mat_Sqrt:  [[0.15]]
grads:  [0.05686181]
Stock Position:  0.05686181054124946
Bond Position:  [-12.79399771]


portfolio before change:  [-6.92468169]
curr_Stock_Price:  103.23476551661099
curr_Factors:  [103.23476552]
mat_Sqrt:  [[0.15]]
grads:  [0.06989471]
Stock Position:  0.06989471455822378
Bond Position:  [-14.14024615]


portfolio before change:  [-6.91164412]
curr_Stock_Price:  103.43394162369715
curr_Factors:  [103.43394162]
mat_Sqrt:  [[0.15]]
grads:  [0.04986916]
Stock Position:  0.04986915656652892
Bond Position:  [-12.06980755]


portfolio before change:  [-6.89876454]
curr_Stock_Price:  103.70733644542884
curr_Factors:  [103.70733645]
mat_Sqrt:  [[0.15]]
grads:  [-0.21800056]
Stock Position:  -0.21800056004648777
Bond Position:  [15.70949289]


portfolio before change:  [-6.84120762]
curr_Stock_Price:  103.4478185362785
curr_Factors:  [103.44781854]
mat_Sqrt:  [[0.15]]
grads:  [0.05963583]
Stock Position:  0.05963583038670964
Bond Position:  [-13.01040418]


portfolio before change:  [-6.82932696]
curr_Stock_Price:  103.66067427341267
curr_Factors:  [103.66067427]
mat_Sqrt:  [[0.15]]
grads:  [0.07392892]
Stock Position:  0.07392892057289366
Bond Position:  [-14.49284872]


portfolio before change:  [-6.8854046]
curr_Stock_Price:  102.9143924748566
curr_Factors:  [102.91439247]
mat_Sqrt:  [[0.15]]
grads:  [0.10810592]
Stock Position:  0.10810591595459357
Bond Position:  [-18.01105927]


portfolio before change:  [-6.85557263]
curr_Stock_Price:  103.20075698628912
curr_Factors:  [103.20075699]
mat_Sqrt:  [[0.15]]
grads:  [-0.02776921]
Stock Position:  -0.027769211629739415
Bond Position:  [-3.98976897]


portfolio before change:  [-6.83977446]
curr_Stock_Price:  102.62286755839105
curr_Factors:  [102.62286756]
mat_Sqrt:  [[0.15]]
grads:  [-0.13578236]
Stock Position:  -0.13578235524215398
Bond Position:  [7.09460019]


portfolio before change:  [-6.75964545]
curr_Stock_Price:  102.03600494320087
curr_Factors:  [102.03600494]
mat_Sqrt:  [[0.15]]
grads:  [0.14160003]
Stock Position:  0.14160002786992978
Bond Position:  [-21.20794659]


portfolio before change:  [-6.70409018]
curr_Stock_Price:  102.43770550782314
curr_Factors:  [102.43770551]
mat_Sqrt:  [[0.15]]
grads:  [0.00062005]
Stock Position:  0.0006200506362801413
Bond Position:  [-6.76760674]


portfolio before change:  [-6.70434386]
curr_Stock_Price:  102.710759554681
curr_Factors:  [102.71075955]
mat_Sqrt:  [[0.15]]
grads:  [-0.00342981]
Stock Position:  -0.0034298132945682195
Bond Position:  [-6.35206513]


portfolio before change:  [-6.70529255]
curr_Stock_Price:  102.8716074601217
curr_Factors:  [102.87160746]
mat_Sqrt:  [[0.15]]
grads:  [-0.09271882]
Stock Position:  -0.09271882081173742
Bond Position:  [2.83284159]


portfolio before change:  [-6.66170589]
curr_Stock_Price:  102.40342201726007
curr_Factors:  [102.40342202]
mat_Sqrt:  [[0.15]]
grads:  [0.0912264]
Stock Position:  0.09122640388976103
Bond Position:  [-16.00360183]


portfolio before change:  [-6.65929571]
curr_Stock_Price:  102.44080636431093
curr_Factors:  [102.44080636]
mat_Sqrt:  [[0.15]]
grads:  [0.00845078]
Stock Position:  0.008450780980810847
Bond Position:  [-7.52500053]


portfolio before change:  [-6.66445386]
curr_Stock_Price:  101.88608514461455
curr_Factors:  [101.88608514]
mat_Sqrt:  [[0.15]]
grads:  [-0.03775964]
Stock Position:  -0.03775964109860466
Bond Position:  [-2.81727186]


portfolio before change:  [-6.65975005]
curr_Stock_Price:  101.75684928867582
curr_Factors:  [101.75684929]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016561]
Stock Position:  -0.0501656110631625
Bond Position:  [-1.55505553]


portfolio before change:  [-6.67516321]
curr_Stock_Price:  102.06215735216058
curr_Factors:  [102.06215735]
mat_Sqrt:  [[0.15]]
grads:  [-0.15711981]
Stock Position:  -0.15711981199675257
Bond Position:  [9.36082377]


portfolio before change:  [-6.65878003]
curr_Stock_Price:  101.96160917326559
curr_Factors:  [101.96160917]
mat_Sqrt:  [[0.15]]
grads:  [0.00123221]
Stock Position:  0.0012322120404816585
Bond Position:  [-6.78441835]


portfolio before change:  [-6.65939078]
curr_Stock_Price:  101.81008616794426
curr_Factors:  [101.81008617]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296674]
Stock Position:  -0.03296674028994383
Bond Position:  [-3.30304411]


portfolio before change:  [-6.65288188]
curr_Stock_Price:  101.6063856291596
curr_Factors:  [101.60638563]
mat_Sqrt:  [[0.15]]
grads:  [0.03606256]
Stock Position:  0.03606255851367815
Bond Position:  [-10.31706811]


portfolio before change:  [-6.66710543]
curr_Stock_Price:  101.22985354802512
curr_Factors:  [101.22985355]
mat_Sqrt:  [[0.15]]
grads:  [0.02666468]
Stock Position:  0.026664681472701852
Bond Position:  [-9.36636723]


portfolio before change:  [-6.67173501]
curr_Stock_Price:  101.07818595769913
curr_Factors:  [101.07818596]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144598]
Stock Position:  -0.011445981713921739
Bond Position:  [-5.51479594]


portfolio before change:  [-6.67403192]
curr_Stock_Price:  101.24874526842599
curr_Factors:  [101.24874527]
mat_Sqrt:  [[0.15]]
grads:  [0.03878561]
Stock Position:  0.03878560512003808
Bond Position:  [-10.60102577]


portfolio before change:  [-6.70405528]
curr_Stock_Price:  100.49174336037638
curr_Factors:  [100.49174336]
mat_Sqrt:  [[0.15]]
grads:  [-0.0019967]
Stock Position:  -0.001996701988166994
Bond Position:  [-6.50340321]


portfolio before change:  [-6.70437714]
curr_Stock_Price:  100.44936524381475
curr_Factors:  [100.44936524]
mat_Sqrt:  [[0.15]]
grads:  [0.01036612]
Stock Position:  0.010366121506534402
Bond Position:  [-7.74564746]


portfolio before change:  [-6.70642465]
curr_Stock_Price:  100.29854707825235
curr_Factors:  [100.29854708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02403784]
Stock Position:  -0.024037840060745035
Bond Position:  [-4.29546422]


portfolio before change:  [-6.70064285]
curr_Stock_Price:  100.04684876752906
curr_Factors:  [100.04684877]
mat_Sqrt:  [[0.15]]
grads:  [0.00600567]
Stock Position:  0.006005666251550282
Bond Position:  [-7.30149083]


portfolio before change:  [-6.70287021]
curr_Stock_Price:  99.75195962439412
curr_Factors:  [99.75195962]
mat_Sqrt:  [[0.15]]
grads:  [-0.07235357]
Stock Position:  -0.07235357128080945
Bond Position:  [0.51454031]


portfolio before change:  [-6.68490586]
curr_Stock_Price:  99.50411852079583
curr_Factors:  [99.50411852]
mat_Sqrt:  [[0.15]]
grads:  [-0.02668417]
Stock Position:  -0.026684167450818978
Bond Position:  [-4.0297213]


portfolio before change:  [-6.68632548]
curr_Stock_Price:  99.54788074858067
curr_Factors:  [99.54788075]
mat_Sqrt:  [[0.15]]
grads:  [-0.10919794]
Stock Position:  -0.10919793591927666
Bond Position:  [4.18409762]


portfolio before change:  [-6.72029008]
curr_Stock_Price:  99.86131262757455
curr_Factors:  [99.86131263]
mat_Sqrt:  [[0.15]]
grads:  [-0.0741417]
Stock Position:  -0.07414170044430377
Bond Position:  [0.68359744]


portfolio before change:  [-6.75791677]
curr_Stock_Price:  100.3693858125781
curr_Factors:  [100.36938581]
mat_Sqrt:  [[0.15]]
grads:  [0.01166765]
Stock Position:  0.011667652065789486
Bond Position:  [-7.92899184]


portfolio before change:  [-6.76644409]
curr_Stock_Price:  99.68100869964555
curr_Factors:  [99.6810087]
mat_Sqrt:  [[0.15]]
grads:  [-0.03453975]
Stock Position:  -0.03453975210589492
Bond Position:  [-3.32348676]


portfolio before change:  [-6.72424995]
curr_Stock_Price:  98.45338372143854
curr_Factors:  [98.45338372]
mat_Sqrt:  [[0.15]]
grads:  [0.13511815]
Stock Position:  0.13511815437285662
Bond Position:  [-20.02708945]


portfolio before change:  [-6.70033508]
curr_Stock_Price:  98.63963996579871
curr_Factors:  [98.63963997]
mat_Sqrt:  [[0.15]]
grads:  [-0.06258063]
Stock Position:  -0.06258062604181362
Bond Position:  [-0.52740466]


portfolio before change:  [-6.66924751]
curr_Stock_Price:  98.14235281031091
curr_Factors:  [98.14235281]
mat_Sqrt:  [[0.15]]
grads:  [0.04487081]
Stock Position:  0.04487080587780717
Bond Position:  [-11.07297397]


portfolio before change:  [-6.7097324]
curr_Stock_Price:  97.2555220028826
curr_Factors:  [97.255522]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675638]
Stock Position:  -0.016756383286470288
Bond Position:  [-5.0800816]


portfolio before change:  [-6.71293262]
curr_Stock_Price:  97.42755801172885
curr_Factors:  [97.42755801]
mat_Sqrt:  [[0.15]]
grads:  [0.07668977]
Stock Position:  0.07668976678766966
Bond Position:  [-14.18462932]


portfolio before change:  [-6.74930109]
curr_Stock_Price:  96.96489001961308
curr_Factors:  [96.96489002]
mat_Sqrt:  [[0.15]]
grads:  [0.00201765]
Stock Position:  0.002017647628655561
Bond Position:  [-6.94494207]


portfolio before change:  [-6.74942394]
curr_Stock_Price:  97.11913939814846
curr_Factors:  [97.1191394]
mat_Sqrt:  [[0.15]]
grads:  [0.03036213]
Stock Position:  0.030362125579842827
Bond Position:  [-9.69816744]


portfolio before change:  [-6.72291063]
curr_Stock_Price:  98.01233975578583
curr_Factors:  [98.01233976]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210187]
Stock Position:  -0.09210186572594475
Bond Position:  [2.30420873]


portfolio before change:  [-6.80903155]
curr_Stock_Price:  98.94896502329941
curr_Factors:  [98.94896502]
mat_Sqrt:  [[0.15]]
grads:  [-0.03529033]
Stock Position:  -0.035290331600466775
Bond Position:  [-3.31708976]


portfolio before change:  [-6.80214278]
curr_Stock_Price:  98.74788759665796
curr_Factors:  [98.7478876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857445]
Stock Position:  -0.008574447337169016
Bond Position:  [-5.95543422]


portfolio before change:  [-6.79936935]
curr_Stock_Price:  98.38102338500185
curr_Factors:  [98.38102339]
mat_Sqrt:  [[0.15]]
grads:  [0.01106918]
Stock Position:  0.01106918180055671
Bond Position:  [-7.88836679]


portfolio before change:  [-6.7903063]
curr_Stock_Price:  99.24432952473349
curr_Factors:  [99.24432952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.7903063]
Stock Price:  99.3971364927427
PL:  [-6.7903063]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.75520108e-04]
 [ 2.82451537e-03]
 [-6.71478069e-03]
 [ 6.37091834e-03]
 [-5.20983335e-04]
 [ 1.34206998e-02]
 [ 1.65467488e-03]
 [-1.90873388e-02]
 [-9.03893882e-03]
 [ 2.14812958e-02]
 [-5.95689462e-03]
 [ 1.93607916e-02]
 [-1.37810930e-02]
 [ 7.97825033e-03]
 [-6.95916583e-03]
 [ 7.47282400e-03]
 [ 7.21041606e-03]
 [-1.17212452e-02]
 [-2.81400797e-04]
 [ 1.53219757e-02]
 [ 1.17089295e-02]
 [-8.08748816e-03]
 [ 7.22009811e-03]
 [ 3.55075851e-02]
 [-3.46663904e-03]
 [ 1.26156894e-02]
 [-7.22790785e-03]
 [ 5.74044878e-03]
 [ 3.61686415e-03]
 [-3.34889133e-03]
 [ 1.02065108e-02]
 [-1.00903136e-02]
 [ 4.22689319e-03]
 [ 8.54406144e-03]
 [ 1.01814615e-02]
 [ 6.93459226e-03]
 [-3.26509657e-02]
 [ 8.89012001e-03]
 [ 1.31261088e-02]
 [ 4.95294586e-03]
 [-3.88222249e-03]
 [-1.82107003e-02]
 [ 2.05664408e-02]
 [-1.76226053e-03]
 [ 4.66689200e-03]
 [-9.82946582e-03]
 [ 1.14796683e-02]
 [-8.42747146e-03]
 [-1.52654470e-02]
 [-6.12400594e-03]
 [ 4.26540341e-02]
 [-9.06999014e-03]
 [ 2.74053447e-03]
 [ 5.43974360e-03]
 [ 5.74496913e-03]
 [-3.44614182e-03]
 [ 6.96136629e-03]
 [-1.80867364e-04]
 [ 1.54412173e-03]
 [-4.60869667e-04]
 [ 1.16638721e-03]
 [-4.24047228e-03]
 [-2.88478874e-03]
 [-1.71487055e-02]
 [-1.05888839e-02]
 [ 1.73987025e-03]
 [-5.52800882e-03]
 [ 1.70866323e-02]
 [-8.18899705e-03]
 [ 1.06940463e-02]
 [-1.13516687e-02]
 [ 1.10606281e-02]
 [-8.36433637e-03]
 [ 1.01266197e-02]
 [-2.17176738e-02]
 [-4.27229425e-03]
 [-7.64951145e-03]
 [-1.54964789e-03]
 [ 1.23756063e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.07468121]
curr_Stock_Price:  100.19722749261526
curr_Factors:  [100.19722749]
mat_Sqrt:  [[0.15]]
grads:  [0.00450347]
Stock Position:  0.0045034673866482106
Bond Position:  [4.62344626]


portfolio before change:  [5.07436822]
curr_Stock_Price:  100.0635611452451
curr_Factors:  [100.06356115]
mat_Sqrt:  [[0.15]]
grads:  [0.0188301]
Stock Position:  0.018830102445232193
Bond Position:  [3.19016111]


portfolio before change:  [5.04374002]
curr_Stock_Price:  98.42641676710582
curr_Factors:  [98.42641677]
mat_Sqrt:  [[0.15]]
grads:  [-0.0447652]
Stock Position:  -0.04476520462430917
Bond Position:  [9.4498187]


portfolio before change:  [5.03468655]
curr_Stock_Price:  98.64185425290847
curr_Factors:  [98.64185425]
mat_Sqrt:  [[0.15]]
grads:  [0.04247279]
Stock Position:  0.042472788911454507
Bond Position:  [0.84509189]


portfolio before change:  [5.04425913]
curr_Stock_Price:  98.86599225202879
curr_Factors:  [98.86599225]
mat_Sqrt:  [[0.15]]
grads:  [-0.00347322]
Stock Position:  -0.0034732222314879852
Bond Position:  [5.38764269]


portfolio before change:  [5.04662466]
curr_Stock_Price:  98.28186819846695
curr_Factors:  [98.2818682]
mat_Sqrt:  [[0.15]]
grads:  [0.08947133]
Stock Position:  0.08947133221600383
Bond Position:  [-3.74678502]


portfolio before change:  [5.10058714]
curr_Stock_Price:  98.88761150618582
curr_Factors:  [98.88761151]
mat_Sqrt:  [[0.15]]
grads:  [0.01103117]
Stock Position:  0.0110311658400581
Bond Position:  [4.0097415]


portfolio before change:  [5.10080152]
curr_Stock_Price:  98.88432691043386
curr_Factors:  [98.88432691]
mat_Sqrt:  [[0.15]]
grads:  [-0.12724893]
Stock Position:  -0.12724892534351234
Bond Position:  [17.68372586]


portfolio before change:  [5.1898307]
curr_Stock_Price:  98.1933669943763
curr_Factors:  [98.19336699]
mat_Sqrt:  [[0.15]]
grads:  [-0.06025959]
Stock Position:  -0.06025959210209269
Bond Position:  [11.10692294]


portfolio before change:  [5.15516231]
curr_Stock_Price:  98.78020456653043
curr_Factors:  [98.78020457]
mat_Sqrt:  [[0.15]]
grads:  [0.14320864]
Stock Position:  0.14320863839501816
Bond Position:  [-8.99101629]


portfolio before change:  [5.10971442]
curr_Stock_Price:  98.46677421176928
curr_Factors:  [98.46677421]
mat_Sqrt:  [[0.15]]
grads:  [-0.03971263]
Stock Position:  -0.03971263080055532
Bond Position:  [9.02008907]


portfolio before change:  [5.08993941]
curr_Stock_Price:  98.97892320253433
curr_Factors:  [98.9789232]
mat_Sqrt:  [[0.15]]
grads:  [0.12907194]
Stock Position:  0.12907194390014523
Bond Position:  [-7.68546261]


portfolio before change:  [5.07875991]
curr_Stock_Price:  98.89603035487744
curr_Factors:  [98.89603035]
mat_Sqrt:  [[0.15]]
grads:  [-0.09187395]
Stock Position:  -0.09187395337502721
Bond Position:  [14.16472919]


portfolio before change:  [5.08315227]
curr_Stock_Price:  98.85785814706765
curr_Factors:  [98.85785815]
mat_Sqrt:  [[0.15]]
grads:  [0.05318834]
Stock Position:  0.05318833551720359
Bond Position:  [-0.17493266]


portfolio before change:  [5.0798515]
curr_Stock_Price:  98.79600551804238
curr_Factors:  [98.79600552]
mat_Sqrt:  [[0.15]]
grads:  [-0.04639444]
Stock Position:  -0.046394438837079575
Bond Position:  [9.66343673]


portfolio before change:  [5.0657552]
curr_Stock_Price:  99.11285991140612
curr_Factors:  [99.11285991]
mat_Sqrt:  [[0.15]]
grads:  [0.04981883]
Stock Position:  0.049818826672162926
Bond Position:  [0.12806881]


portfolio before change:  [5.07511077]
curr_Stock_Price:  99.30049123324372
curr_Factors:  [99.30049123]
mat_Sqrt:  [[0.15]]
grads:  [0.04806944]
Stock Position:  0.04806944039154256
Bond Position:  [0.30179173]


portfolio before change:  [5.07759418]
curr_Stock_Price:  99.35176165501231
curr_Factors:  [99.35176166]
mat_Sqrt:  [[0.15]]
grads:  [-0.07814163]
Stock Position:  -0.07814163498406693
Bond Position:  [12.84110327]


portfolio before change:  [5.02776364]
curr_Stock_Price:  99.99972780965437
curr_Factors:  [99.99972781]
mat_Sqrt:  [[0.15]]
grads:  [-0.00187601]
Stock Position:  -0.0018760053110072085
Bond Position:  [5.21536366]


portfolio before change:  [5.02936502]
curr_Stock_Price:  99.31987371734375
curr_Factors:  [99.31987372]
mat_Sqrt:  [[0.15]]
grads:  [0.1021465]
Stock Position:  0.10214650472134951
Bond Position:  [-5.11581293]


portfolio before change:  [4.99645493]
curr_Stock_Price:  99.00081883209992
curr_Factors:  [99.00081883]
mat_Sqrt:  [[0.15]]
grads:  [0.07805953]
Stock Position:  0.07805953014599494
Bond Position:  [-2.73150248]


portfolio before change:  [5.06905367]
curr_Stock_Price:  99.93304929885473
curr_Factors:  [99.9330493]
mat_Sqrt:  [[0.15]]
grads:  [-0.05391659]
Stock Position:  -0.053916587747484965
Bond Position:  [10.4571027]


portfolio before change:  [5.08783973]
curr_Stock_Price:  99.59674334583177
curr_Factors:  [99.59674335]
mat_Sqrt:  [[0.15]]
grads:  [0.04813399]
Stock Position:  0.04813398738288221
Bond Position:  [0.29385135]


portfolio before change:  [5.08310098]
curr_Stock_Price:  99.49791256548801
curr_Factors:  [99.49791257]
mat_Sqrt:  [[0.15]]
grads:  [0.23671723]
Stock Position:  0.23671723416849433
Bond Position:  [-18.46976969]


portfolio before change:  [5.1768589]
curr_Stock_Price:  99.8988648409266
curr_Factors:  [99.89886484]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311093]
Stock Position:  -0.023110926948043845
Bond Position:  [7.48561426]


portfolio before change:  [5.17265881]
curr_Stock_Price:  100.10084531664144
curr_Factors:  [100.10084532]
mat_Sqrt:  [[0.15]]
grads:  [0.0841046]
Stock Position:  0.08410459594973654
Bond Position:  [-3.24628234]


portfolio before change:  [5.15724097]
curr_Stock_Price:  99.91994030775726
curr_Factors:  [99.91994031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04818605]
Stock Position:  -0.04818605235067118
Bond Position:  [9.97198844]


portfolio before change:  [5.15173829]
curr_Stock_Price:  100.0470714704059
curr_Factors:  [100.04707147]
mat_Sqrt:  [[0.15]]
grads:  [0.03826966]
Stock Position:  0.038269658533503566
Bond Position:  [1.32297102]


portfolio before change:  [5.164252]
curr_Stock_Price:  100.37189873087112
curr_Factors:  [100.37189873]
mat_Sqrt:  [[0.15]]
grads:  [0.02411243]
Stock Position:  0.024112427650862175
Bond Position:  [2.74404186]


portfolio before change:  [5.17188474]
curr_Stock_Price:  100.68133371672208
curr_Factors:  [100.68133372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232594]
Stock Position:  -0.022325942185483727
Bond Position:  [7.41969037]


portfolio before change:  [5.1562745]
curr_Stock_Price:  101.40130268289575
curr_Factors:  [101.40130268]
mat_Sqrt:  [[0.15]]
grads:  [0.06804341]
Stock Position:  0.0680434050892072
Bond Position:  [-1.74341542]


portfolio before change:  [5.23283045]
curr_Stock_Price:  102.52800870620477
curr_Factors:  [102.52800871]
mat_Sqrt:  [[0.15]]
grads:  [-0.06726876]
Stock Position:  -0.06726875762269213
Bond Position:  [12.12976221]


portfolio before change:  [5.22961861]
curr_Stock_Price:  102.58702518177412
curr_Factors:  [102.58702518]
mat_Sqrt:  [[0.15]]
grads:  [0.02817929]
Stock Position:  0.028179287914426067
Bond Position:  [2.3387893]


portfolio before change:  [5.25098556]
curr_Stock_Price:  103.3400879093932
curr_Factors:  [103.34008791]
mat_Sqrt:  [[0.15]]
grads:  [0.05696041]
Stock Position:  0.05696040959685167
Bond Position:  [-0.63530817]


portfolio before change:  [5.29204346]
curr_Stock_Price:  104.06159959106327
curr_Factors:  [104.06159959]
mat_Sqrt:  [[0.15]]
grads:  [0.06787641]
Stock Position:  0.06787641026467262
Bond Position:  [-1.77128437]


portfolio before change:  [5.28137177]
curr_Stock_Price:  103.90600825730849
curr_Factors:  [103.90600826]
mat_Sqrt:  [[0.15]]
grads:  [0.04623062]
Stock Position:  0.046230615088712276
Bond Position:  [0.47773309]


portfolio before change:  [5.27666557]
curr_Stock_Price:  103.80356414632706
curr_Factors:  [103.80356415]
mat_Sqrt:  [[0.15]]
grads:  [-0.2176731]
Stock Position:  -0.2176731047961166
Bond Position:  [27.87190967]


portfolio before change:  [5.2951439]
curr_Stock_Price:  103.72667693140758
curr_Factors:  [103.72667693]
mat_Sqrt:  [[0.15]]
grads:  [0.05926747]
Stock Position:  0.05926746673920398
Bond Position:  [-0.85247347]


portfolio before change:  [5.32426943]
curr_Stock_Price:  104.21900110456318
curr_Factors:  [104.2190011]
mat_Sqrt:  [[0.15]]
grads:  [0.08750739]
Stock Position:  0.08750739198136542
Bond Position:  [-3.79566356]


portfolio before change:  [5.32225674]
curr_Stock_Price:  104.19871198388182
curr_Factors:  [104.19871198]
mat_Sqrt:  [[0.15]]
grads:  [0.03301964]
Stock Position:  0.03301963905158088
Bond Position:  [1.88165288]


portfolio before change:  [5.30822645]
curr_Stock_Price:  103.77024266773849
curr_Factors:  [103.77024267]
mat_Sqrt:  [[0.15]]
grads:  [-0.02588148]
Stock Position:  -0.025881483252435528
Bond Position:  [7.99395424]


portfolio before change:  [5.31620644]
curr_Stock_Price:  103.4812193653876
curr_Factors:  [103.48121937]
mat_Sqrt:  [[0.15]]
grads:  [-0.12140467]
Stock Position:  -0.12140466864944464
Bond Position:  [17.87930958]


portfolio before change:  [5.25570905]
curr_Stock_Price:  103.98873589164822
curr_Factors:  [103.98873589]
mat_Sqrt:  [[0.15]]
grads:  [0.13710961]
Stock Position:  0.13710960555886828
Bond Position:  [-9.00214551]


portfolio before change:  [5.18099872]
curr_Stock_Price:  103.44794462932043
curr_Factors:  [103.44794463]
mat_Sqrt:  [[0.15]]
grads:  [-0.0117484]
Stock Position:  -0.011748403545386005
Bond Position:  [6.39634692]


portfolio before change:  [5.17972709]
curr_Stock_Price:  103.59021245223765
curr_Factors:  [103.59021245]
mat_Sqrt:  [[0.15]]
grads:  [0.03111261]
Stock Position:  0.031112613340677556
Bond Position:  [1.95676486]


portfolio before change:  [5.12961192]
curr_Stock_Price:  101.97551454426196
curr_Factors:  [101.97551454]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552977]
Stock Position:  -0.06552977211628071
Bond Position:  [11.81204415]


portfolio before change:  [5.17036431]
curr_Stock_Price:  101.36488959251162
curr_Factors:  [101.36488959]
mat_Sqrt:  [[0.15]]
grads:  [0.07653112]
Stock Position:  0.07653112192873147
Bond Position:  [-2.58720442]


portfolio before change:  [5.12648968]
curr_Stock_Price:  100.79371123958535
curr_Factors:  [100.79371124]
mat_Sqrt:  [[0.15]]
grads:  [-0.05618314]
Stock Position:  -0.05618314305727666
Bond Position:  [10.78939718]


portfolio before change:  [5.17013881]
curr_Stock_Price:  100.02880624440549
curr_Factors:  [100.02880624]
mat_Sqrt:  [[0.15]]
grads:  [-0.10176965]
Stock Position:  -0.10176964675991092
Bond Position:  [15.35003508]


portfolio before change:  [5.22439914]
curr_Stock_Price:  99.50506533926458
curr_Factors:  [99.50506534]
mat_Sqrt:  [[0.15]]
grads:  [-0.04082671]
Stock Position:  -0.04082670624181864
Bond Position:  [9.28686321]


portfolio before change:  [5.19789284]
curr_Stock_Price:  100.16852206111126
curr_Factors:  [100.16852206]
mat_Sqrt:  [[0.15]]
grads:  [0.28436023]
Stock Position:  0.28436022728483223
Bond Position:  [-23.28605086]


portfolio before change:  [4.96004914]
curr_Stock_Price:  99.33722341284908
curr_Factors:  [99.33722341]
mat_Sqrt:  [[0.15]]
grads:  [-0.0604666]
Stock Position:  -0.06046660092916576
Bond Position:  [10.96663338]


portfolio before change:  [4.93081012]
curr_Stock_Price:  99.83211568768503
curr_Factors:  [99.83211569]
mat_Sqrt:  [[0.15]]
grads:  [0.01827023]
Stock Position:  0.018270229768398462
Bond Position:  [3.10685443]


portfolio before change:  [4.92273751]
curr_Stock_Price:  99.37964190467328
curr_Factors:  [99.3796419]
mat_Sqrt:  [[0.15]]
grads:  [0.03626496]
Stock Position:  0.03626495732771018
Bond Position:  [1.31873903]


portfolio before change:  [4.92619345]
curr_Stock_Price:  99.47266615376047
curr_Factors:  [99.47266615]
mat_Sqrt:  [[0.15]]
grads:  [0.03829979]
Stock Position:  0.038299794209715084
Bond Position:  [1.11641081]


portfolio before change:  [4.91770823]
curr_Stock_Price:  99.24929692606696
curr_Factors:  [99.24929693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02297428]
Stock Position:  -0.02297427878408191
Bond Position:  [7.19788925]


portfolio before change:  [4.92431823]
curr_Stock_Price:  98.9811659889197
curr_Factors:  [98.98116599]
mat_Sqrt:  [[0.15]]
grads:  [0.04640911]
Stock Position:  0.04640910861793427
Bond Position:  [0.33069055]


portfolio before change:  [4.9261167]
curr_Stock_Price:  99.01947305326199
curr_Factors:  [99.01947305]
mat_Sqrt:  [[0.15]]
grads:  [-0.00120578]
Stock Position:  -0.0012057824296697116
Bond Position:  [5.04551264]


portfolio before change:  [4.92660799]
curr_Stock_Price:  98.87355986636591
curr_Factors:  [98.87355987]
mat_Sqrt:  [[0.15]]
grads:  [0.01029414]
Stock Position:  0.010294144878045426
Bond Position:  [3.90878924]


portfolio before change:  [4.9290705]
curr_Stock_Price:  99.08904238083224
curr_Factors:  [99.08904238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00307246]
Stock Position:  -0.003072464445200036
Bond Position:  [5.23351806]


portfolio before change:  [4.92922814]
curr_Stock_Price:  99.1441987133849
curr_Factors:  [99.14419871]
mat_Sqrt:  [[0.15]]
grads:  [0.00777591]
Stock Position:  0.007775914751410977
Bond Position:  [4.15829131]


portfolio before change:  [4.92826928]
curr_Stock_Price:  98.98746220101677
curr_Factors:  [98.9874622]
mat_Sqrt:  [[0.15]]
grads:  [-0.02826982]
Stock Position:  -0.028269815173246615
Bond Position:  [7.72662654]


portfolio before change:  [4.91771957]
curr_Stock_Price:  99.37772426068332
curr_Factors:  [99.37772426]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923192]
Stock Position:  -0.019231924950701175
Bond Position:  [6.8289445]


portfolio before change:  [4.92521983]
curr_Stock_Price:  99.00992770630356
curr_Factors:  [99.00992771]
mat_Sqrt:  [[0.15]]
grads:  [-0.1143247]
Stock Position:  -0.11432470327062036
Bond Position:  [16.24450043]


portfolio before change:  [4.81405438]
curr_Stock_Price:  99.99117455698418
curr_Factors:  [99.99117456]
mat_Sqrt:  [[0.15]]
grads:  [-0.07059256]
Stock Position:  -0.07059255914650536
Bond Position:  [11.87268729]


portfolio before change:  [4.77709066]
curr_Stock_Price:  100.52530714597579
curr_Factors:  [100.52530715]
mat_Sqrt:  [[0.15]]
grads:  [0.01159914]
Stock Position:  0.011599135021228812
Bond Position:  [3.61108405]


portfolio before change:  [4.78829517]
curr_Stock_Price:  101.4718267661984
curr_Factors:  [101.47182677]
mat_Sqrt:  [[0.15]]
grads:  [-0.03685339]
Stock Position:  -0.036853392118989935
Bond Position:  [8.52787619]


portfolio before change:  [4.78622877]
curr_Stock_Price:  101.54236062970958
curr_Factors:  [101.54236063]
mat_Sqrt:  [[0.15]]
grads:  [0.11391088]
Stock Position:  0.11391088231058401
Bond Position:  [-6.78055112]


portfolio before change:  [4.71098673]
curr_Stock_Price:  100.88554683530295
curr_Factors:  [100.88554684]
mat_Sqrt:  [[0.15]]
grads:  [-0.05459331]
Stock Position:  -0.05459331366391876
Bond Position:  [10.21866304]


portfolio before change:  [4.65147838]
curr_Stock_Price:  101.98727588705184
curr_Factors:  [101.98727589]
mat_Sqrt:  [[0.15]]
grads:  [0.07129364]
Stock Position:  0.07129364210467518
Bond Position:  [-2.61956597]


portfolio before change:  [4.64085193]
curr_Stock_Price:  101.84052052047603
curr_Factors:  [101.84052052]
mat_Sqrt:  [[0.15]]
grads:  [-0.07567779]
Stock Position:  -0.07567779164243388
Bond Position:  [12.34791762]


portfolio before change:  [4.71056581]
curr_Stock_Price:  100.92952521141154
curr_Factors:  [100.92952521]
mat_Sqrt:  [[0.15]]
grads:  [0.07373752]
Stock Position:  0.07373752052728373
Bond Position:  [-2.73172713]


portfolio before change:  [4.69605007]
curr_Stock_Price:  100.73498384571388
curr_Factors:  [100.73498385]
mat_Sqrt:  [[0.15]]
grads:  [-0.05576224]
Stock Position:  -0.055762242445664516
Bond Position:  [10.31325866]


portfolio before change:  [4.76525772]
curr_Stock_Price:  99.50542345303096
curr_Factors:  [99.50542345]
mat_Sqrt:  [[0.15]]
grads:  [0.0675108]
Stock Position:  0.06751079786854476
Bond Position:  [-1.95243281]


portfolio before change:  [4.80841428]
curr_Stock_Price:  100.14648528574708
curr_Factors:  [100.14648529]
mat_Sqrt:  [[0.15]]
grads:  [-0.14478449]
Stock Position:  -0.14478449219463024
Bond Position:  [19.3080723]


portfolio before change:  [4.79325352]
curr_Stock_Price:  100.25953297041956
curr_Factors:  [100.25953297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848196]
Stock Position:  -0.028481961698447675
Bond Position:  [7.6488417]


portfolio before change:  [4.79036912]
curr_Stock_Price:  100.37758901942055
curr_Factors:  [100.37758902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05099674]
Stock Position:  -0.05099674299518489
Bond Position:  [9.90929923]


portfolio before change:  [4.77806008]
curr_Stock_Price:  100.6311031111469
curr_Factors:  [100.63110311]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033099]
Stock Position:  -0.010330985904904876
Bond Position:  [5.81767859]


portfolio before change:  [4.7731096]
curr_Stock_Price:  101.14548749248182
curr_Factors:  [101.14548749]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.7731096]
Stock Price:  101.16228088898225
PL:  [3.61082871]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.30680653e+00]
 [ 6.86059923e-04]
 [-3.25407269e-04]
 [-3.71838989e-03]
 [-3.03713128e-03]
 [ 3.62875868e-02]
 [ 2.66310017e-02]
 [ 3.30649419e-03]
 [ 1.67180048e-02]
 [ 2.43453074e-02]
 [-1.50907201e-03]
 [ 6.26817429e-02]
 [ 1.34110189e-01]
 [ 1.31706721e-01]
 [ 1.73610580e-02]
 [-6.89235679e-03]
 [ 3.77036371e-02]
 [ 1.50544248e-02]
 [-1.40879182e-03]
 [ 1.16709992e-02]
 [-1.11993413e-02]
 [ 1.59295222e-02]
 [-2.38641331e-02]
 [ 9.41932477e-03]
 [-9.95198770e-02]
 [ 1.58079559e-02]
 [ 5.46993951e-03]
 [-3.95858857e-03]
 [ 2.22957742e-02]
 [ 6.85236695e-02]
 [ 1.26942536e-02]
 [ 2.46078785e-02]
 [ 1.75250351e-02]
 [-8.51137865e-03]
 [ 6.38369679e-03]
 [ 9.32071461e-03]
 [ 2.50000034e-03]
 [-3.10140409e-02]
 [ 8.34297649e-03]
 [ 2.18592868e-02]
 [-1.94388727e-02]
 [-9.71438905e-03]
 [-9.32590819e-03]
 [ 1.92733174e-02]
 [-9.91387543e-03]
 [ 2.98023896e-02]
 [ 5.54001016e-04]
 [ 1.56537201e-02]
 [ 4.12342581e-02]
 [ 1.58065682e-02]
 [-8.22418060e-03]
 [ 1.00580471e-01]
 [ 2.04118884e-02]
 [-1.18822058e-02]
 [ 5.68171390e-03]
 [-2.73757357e-02]
 [ 4.30593006e-02]
 [ 1.88841310e-02]
 [ 2.10749107e-03]
 [ 2.00535622e-03]
 [-5.36707828e-04]
 [ 2.45973287e-02]
 [ 5.58348903e-02]
 [-8.19058071e-03]
 [-1.15318785e-02]
 [ 2.02360595e-02]
 [ 1.10540818e-02]
 [-3.83159611e-03]
 [ 1.60188040e-02]
 [-3.29724121e-02]
 [-7.45444750e-02]
 [ 8.73100440e-03]
 [ 1.93866940e-02]
 [-6.17057395e-02]
 [ 3.01169014e-02]
 [-3.13391531e-02]
 [ 1.10623497e-02]
 [ 1.78199613e-02]
 [-2.48581062e-02]
 [ 2.51410509e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.30680653]
mat_Sqrt:  [[0.15]]
grads:  [15.37871022]
init_Out:  [2.13756309]
Stock Position:  15.378710222012492
Bond position:  [-1535.73345911]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.03179162]
curr_Stock_Price:  100.19443859870324
curr_Factors:  [100.1944386]
mat_Sqrt:  [[0.15]]
grads:  [0.00457373]
Stock Position:  0.004573732822973186
Bond Position:  [4.57352903]


portfolio before change:  [5.03592573]
curr_Stock_Price:  101.0358214470718
curr_Factors:  [101.03582145]
mat_Sqrt:  [[0.15]]
grads:  [-0.00216938]
Stock Position:  -0.0021693817941063525
Bond Position:  [5.255111]


portfolio before change:  [5.03413103]
curr_Stock_Price:  102.01451436286035
curr_Factors:  [102.01451436]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478927]
Stock Position:  -0.02478926595226697
Bond Position:  [7.56299596]


portfolio before change:  [5.02440419]
curr_Stock_Price:  102.42596410708606
curr_Factors:  [102.42596411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024754]
Stock Position:  -0.020247541848262426
Bond Position:  [7.09827819]


portfolio before change:  [5.02678317]
curr_Stock_Price:  102.33038111584382
curr_Factors:  [102.33038112]
mat_Sqrt:  [[0.15]]
grads:  [0.24191725]
Stock Position:  0.24191724502349685
Bond Position:  [-19.72870071]


portfolio before change:  [5.06883816]
curr_Stock_Price:  102.50931863432596
curr_Factors:  [102.50931863]
mat_Sqrt:  [[0.15]]
grads:  [0.17754001]
Stock Position:  0.17754001149243093
Bond Position:  [-13.13066745]


portfolio before change:  [4.97715094]
curr_Stock_Price:  101.99750990844586
curr_Factors:  [101.99750991]
mat_Sqrt:  [[0.15]]
grads:  [0.02204329]
Stock Position:  0.02204329461204324
Bond Position:  [2.72878978]


portfolio before change:  [4.99494508]
curr_Stock_Price:  102.79700853477833
curr_Factors:  [102.79700853]
mat_Sqrt:  [[0.15]]
grads:  [0.11145337]
Stock Position:  0.1114533651872756
Bond Position:  [-6.46212745]


portfolio before change:  [5.10419372]
curr_Stock_Price:  103.78085083478473
curr_Factors:  [103.78085083]
mat_Sqrt:  [[0.15]]
grads:  [0.16230205]
Stock Position:  0.16230204929811065
Bond Position:  [-11.73965105]


portfolio before change:  [5.07488727]
curr_Stock_Price:  103.6048043860278
curr_Factors:  [103.60480439]
mat_Sqrt:  [[0.15]]
grads:  [-0.01006048]
Stock Position:  -0.010060480080856152
Bond Position:  [6.11720134]


portfolio before change:  [5.07134884]
curr_Stock_Price:  103.99452349681887
curr_Factors:  [103.9945235]
mat_Sqrt:  [[0.15]]
grads:  [0.41787829]
Stock Position:  0.41787828608952493
Bond Position:  [-38.3857044]


portfolio before change:  [5.20225738]
curr_Stock_Price:  104.31353437530436
curr_Factors:  [104.31353438]
mat_Sqrt:  [[0.15]]
grads:  [0.89406793]
Stock Position:  0.8940679273302684
Bond Position:  [-88.06112809]


portfolio before change:  [4.67570687]
curr_Stock_Price:  103.7307525779641
curr_Factors:  [103.73075258]
mat_Sqrt:  [[0.15]]
grads:  [0.8780448]
Stock Position:  0.8780448043361266
Bond Position:  [-86.40454148]


portfolio before change:  [4.48799692]
curr_Stock_Price:  103.52312137498477
curr_Factors:  [103.52312137]
mat_Sqrt:  [[0.15]]
grads:  [0.11574039]
Stock Position:  0.11574038682430426
Bond Position:  [-7.49380919]


portfolio before change:  [4.54465785]
curr_Stock_Price:  104.01672003838597
curr_Factors:  [104.01672004]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594905]
Stock Position:  -0.045949045242660386
Bond Position:  [9.32412682]


portfolio before change:  [4.49893576]
curr_Stock_Price:  105.02446369249299
curr_Factors:  [105.02446369]
mat_Sqrt:  [[0.15]]
grads:  [0.25135758]
Stock Position:  0.2513575809010311
Bond Position:  [-21.89975937]


portfolio before change:  [4.28164335]
curr_Stock_Price:  104.16543398032572
curr_Factors:  [104.16543398]
mat_Sqrt:  [[0.15]]
grads:  [0.10036283]
Stock Position:  0.10036283184817647
Bond Position:  [-6.17269458]


portfolio before change:  [4.23604173]
curr_Stock_Price:  103.71491039011808
curr_Factors:  [103.71491039]
mat_Sqrt:  [[0.15]]
grads:  [-0.00939195]
Stock Position:  -0.009391945485651814
Bond Position:  [5.21012651]


portfolio before change:  [4.23507349]
curr_Stock_Price:  103.85267507399816
curr_Factors:  [103.85267507]
mat_Sqrt:  [[0.15]]
grads:  [0.07780666]
Stock Position:  0.0778066611399388
Bond Position:  [-3.84535641]


portfolio before change:  [4.32750196]
curr_Stock_Price:  105.0436889523378
curr_Factors:  [105.04368895]
mat_Sqrt:  [[0.15]]
grads:  [-0.07466228]
Stock Position:  -0.07466227540833915
Bond Position:  [12.1703028]


portfolio before change:  [4.24701302]
curr_Stock_Price:  106.13191738687728
curr_Factors:  [106.13191739]
mat_Sqrt:  [[0.15]]
grads:  [0.10619681]
Stock Position:  0.1061968143675097
Bond Position:  [-7.02385851]


portfolio before change:  [4.26396669]
curr_Stock_Price:  106.29569518083404
curr_Factors:  [106.29569518]
mat_Sqrt:  [[0.15]]
grads:  [-0.15909422]
Stock Position:  -0.15909422050721828
Bond Position:  [21.17499746]


portfolio before change:  [4.29716577]
curr_Stock_Price:  106.09533847381925
curr_Factors:  [106.09533847]
mat_Sqrt:  [[0.15]]
grads:  [0.0627955]
Stock Position:  0.06279549846358508
Bond Position:  [-2.3651439]


portfolio before change:  [4.28986185]
curr_Stock_Price:  105.98137976330152
curr_Factors:  [105.98137976]
mat_Sqrt:  [[0.15]]
grads:  [-0.66346585]
Stock Position:  -0.6634658463929619
Bond Position:  [74.60488767]


portfolio before change:  [4.04156954]
curr_Stock_Price:  106.36264318478001
curr_Factors:  [106.36264318]
mat_Sqrt:  [[0.15]]
grads:  [0.10538637]
Stock Position:  0.10538637258126113
Bond Position:  [-7.1676036]


portfolio before change:  [3.97494793]
curr_Stock_Price:  105.73472878546556
curr_Factors:  [105.73472879]
mat_Sqrt:  [[0.15]]
grads:  [0.03646626]
Stock Position:  0.0364662633853605
Bond Position:  [0.11919746]


portfolio before change:  [3.94915555]
curr_Stock_Price:  105.02723010033694
curr_Factors:  [105.0272301]
mat_Sqrt:  [[0.15]]
grads:  [-0.02639059]
Stock Position:  -0.026390590479710846
Bond Position:  [6.72088616]


portfolio before change:  [3.93596801]
curr_Stock_Price:  105.54285355776129
curr_Factors:  [105.54285356]
mat_Sqrt:  [[0.15]]
grads:  [0.14863849]
Stock Position:  0.14863849444237684
Bond Position:  [-11.75176285]


portfolio before change:  [3.93756772]
curr_Stock_Price:  105.5585575594062
curr_Factors:  [105.55855756]
mat_Sqrt:  [[0.15]]
grads:  [0.45682446]
Stock Position:  0.4568244632753396
Bond Position:  [-44.28416368]


portfolio before change:  [4.44260833]
curr_Stock_Price:  106.67016277484477
curr_Factors:  [106.67016277]
mat_Sqrt:  [[0.15]]
grads:  [0.08462836]
Stock Position:  0.08462835766575791
Bond Position:  [-4.58471236]


portfolio before change:  [4.45857465]
curr_Stock_Price:  106.86221281794786
curr_Factors:  [106.86221282]
mat_Sqrt:  [[0.15]]
grads:  [0.16405252]
Stock Position:  0.16405252325091169
Bond Position:  [-13.072441]


portfolio before change:  [4.50605151]
curr_Stock_Price:  107.15659359151978
curr_Factors:  [107.15659359]
mat_Sqrt:  [[0.15]]
grads:  [0.11683357]
Stock Position:  0.11683356707268731
Bond Position:  [-8.01343556]


portfolio before change:  [4.58272564]
curr_Stock_Price:  107.81714853805079
curr_Factors:  [107.81714854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05674252]
Stock Position:  -0.05674252434989215
Bond Position:  [10.70054282]


portfolio before change:  [4.62571659]
curr_Stock_Price:  107.07128561238268
curr_Factors:  [107.07128561]
mat_Sqrt:  [[0.15]]
grads:  [0.04255798]
Stock Position:  0.04255797861501146
Bond Position:  [0.06897911]


portfolio before change:  [4.63538573]
curr_Stock_Price:  107.29838354242648
curr_Factors:  [107.29838354]
mat_Sqrt:  [[0.15]]
grads:  [0.0621381]
Stock Position:  0.06213809738454397
Bond Position:  [-2.03193167]


portfolio before change:  [4.59483087]
curr_Stock_Price:  106.64777032522308
curr_Factors:  [106.64777033]
mat_Sqrt:  [[0.15]]
grads:  [0.01666667]
Stock Position:  0.016666668911134188
Bond Position:  [2.81736779]


portfolio before change:  [4.59508295]
curr_Stock_Price:  106.65232969824532
curr_Factors:  [106.6523297]
mat_Sqrt:  [[0.15]]
grads:  [-0.20676027]
Stock Position:  -0.20676027275657136
Bond Position:  [26.64654773]


portfolio before change:  [4.59200698]
curr_Stock_Price:  106.67526172960461
curr_Factors:  [106.67526173]
mat_Sqrt:  [[0.15]]
grads:  [0.05561984]
Stock Position:  0.05561984328289321
Bond Position:  [-1.34125436]


portfolio before change:  [4.58618621]
curr_Stock_Price:  106.5721161930361
curr_Factors:  [106.57211619]
mat_Sqrt:  [[0.15]]
grads:  [0.14572858]
Stock Position:  0.1457285788667406
Bond Position:  [-10.94441683]


portfolio before change:  [4.64496065]
curr_Stock_Price:  106.98012466269851
curr_Factors:  [106.98012466]
mat_Sqrt:  [[0.15]]
grads:  [-0.12959248]
Stock Position:  -0.12959248442359153
Bond Position:  [18.50878079]


portfolio before change:  [4.55381105]
curr_Stock_Price:  107.69240697769305
curr_Factors:  [107.69240698]
mat_Sqrt:  [[0.15]]
grads:  [-0.06476259]
Stock Position:  -0.0647625936559535
Bond Position:  [11.52825065]


portfolio before change:  [4.52922694]
curr_Stock_Price:  108.08313647159093
curr_Factors:  [108.08313647]
mat_Sqrt:  [[0.15]]
grads:  [-0.06217272]
Stock Position:  -0.062172721294949156
Bond Position:  [11.24904966]


portfolio before change:  [4.52980768]
curr_Stock_Price:  108.08510425981223
curr_Factors:  [108.08510426]
mat_Sqrt:  [[0.15]]
grads:  [0.12848878]
Stock Position:  0.12848878242574674
Bond Position:  [-9.35791576]


portfolio before change:  [4.52043927]
curr_Stock_Price:  108.0167440602171
curr_Factors:  [108.01674406]
mat_Sqrt:  [[0.15]]
grads:  [-0.0660925]
Stock Position:  -0.06609250289634833
Bond Position:  [11.65953624]


portfolio before change:  [4.52420839]
curr_Stock_Price:  107.97074223732034
curr_Factors:  [107.97074224]
mat_Sqrt:  [[0.15]]
grads:  [0.1986826]
Stock Position:  0.19868259711366687
Bond Position:  [-16.92769909]


portfolio before change:  [4.56591748]
curr_Stock_Price:  108.18599563536714
curr_Factors:  [108.18599564]
mat_Sqrt:  [[0.15]]
grads:  [0.00369334]
Stock Position:  0.003693340107144445
Bond Position:  [4.16634981]


portfolio before change:  [4.56494382]
curr_Stock_Price:  107.85186174761554
curr_Factors:  [107.85186175]
mat_Sqrt:  [[0.15]]
grads:  [0.10435813]
Stock Position:  0.1043581338578827
Bond Position:  [-6.69027521]


portfolio before change:  [4.67533971]
curr_Stock_Price:  108.91372483677173
curr_Factors:  [108.91372484]
mat_Sqrt:  [[0.15]]
grads:  [0.27489505]
Stock Position:  0.2748950541353803
Bond Position:  [-25.26450457]


portfolio before change:  [4.70561265]
curr_Stock_Price:  109.02959457386451
curr_Factors:  [109.02959457]
mat_Sqrt:  [[0.15]]
grads:  [0.10537712]
Stock Position:  0.10537712155273063
Bond Position:  [-6.78361219]


portfolio before change:  [4.80839646]
curr_Stock_Price:  110.00900826450238
curr_Factors:  [110.00900826]
mat_Sqrt:  [[0.15]]
grads:  [-0.05482787]
Stock Position:  -0.05482787066105756
Bond Position:  [10.83995613]


portfolio before change:  [4.8278285]
curr_Stock_Price:  109.66694631409003
curr_Factors:  [109.66694631]
mat_Sqrt:  [[0.15]]
grads:  [0.67053647]
Stock Position:  0.6705364722178497
Bond Position:  [-68.7078588]


portfolio before change:  [4.46796049]
curr_Stock_Price:  109.13666399380838
curr_Factors:  [109.13666399]
mat_Sqrt:  [[0.15]]
grads:  [0.13607926]
Stock Position:  0.13607925606085228
Bond Position:  [-10.38327555]


portfolio before change:  [4.42082478]
curr_Stock_Price:  108.79504882397454
curr_Factors:  [108.79504882]
mat_Sqrt:  [[0.15]]
grads:  [-0.07921471]
Stock Position:  -0.07921470535569144
Bond Position:  [13.03899252]


portfolio before change:  [4.46418866]
curr_Stock_Price:  108.25791475152802
curr_Factors:  [108.25791475]
mat_Sqrt:  [[0.15]]
grads:  [0.03787809]
Stock Position:  0.03787809264556215
Bond Position:  [0.36358533]


portfolio before change:  [4.46968775]
curr_Stock_Price:  108.4024933803614
curr_Factors:  [108.40249338]
mat_Sqrt:  [[0.15]]
grads:  [-0.1825049]
Stock Position:  -0.18250490464959973
Bond Position:  [24.25367446]


portfolio before change:  [4.42924941]
curr_Stock_Price:  108.6323734509511
curr_Factors:  [108.63237345]
mat_Sqrt:  [[0.15]]
grads:  [0.287062]
Stock Position:  0.28706200397460135
Bond Position:  [-26.75497741]


portfolio before change:  [4.24810975]
curr_Stock_Price:  108.00718650332755
curr_Factors:  [108.0071865]
mat_Sqrt:  [[0.15]]
grads:  [0.12589421]
Stock Position:  0.12589420645057028
Bond Position:  [-9.34936928]


portfolio before change:  [4.14524857]
curr_Stock_Price:  107.19478354068109
curr_Factors:  [107.19478354]
mat_Sqrt:  [[0.15]]
grads:  [0.01404994]
Stock Position:  0.01404994049204063
Bond Position:  [2.63916824]


portfolio before change:  [4.1424739]
curr_Stock_Price:  106.98555693208874
curr_Factors:  [106.98555693]
mat_Sqrt:  [[0.15]]
grads:  [0.01336904]
Stock Position:  0.013369041457147127
Bond Position:  [2.71217956]


portfolio before change:  [4.14695993]
curr_Stock_Price:  107.30843035816098
curr_Factors:  [107.30843036]
mat_Sqrt:  [[0.15]]
grads:  [-0.00357805]
Stock Position:  -0.003578052185169827
Bond Position:  [4.53091509]


portfolio before change:  [4.14272848]
curr_Stock_Price:  108.5701889975578
curr_Factors:  [108.570189]
mat_Sqrt:  [[0.15]]
grads:  [0.16398219]
Stock Position:  0.16398219144312703
Bond Position:  [-13.66084904]


portfolio before change:  [4.18122797]
curr_Stock_Price:  108.81017430806772
curr_Factors:  [108.81017431]
mat_Sqrt:  [[0.15]]
grads:  [0.3722326]
Stock Position:  0.37223260176207257
Bond Position:  [-36.32146631]


portfolio before change:  [4.18151379]
curr_Stock_Price:  108.81704093695453
curr_Factors:  [108.81704094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05460387]
Stock Position:  -0.05460387137250317
Bond Position:  [10.12334549]


portfolio before change:  [4.18719119]
curr_Stock_Price:  108.7246542175779
curr_Factors:  [108.72465422]
mat_Sqrt:  [[0.15]]
grads:  [-0.07687919]
Stock Position:  -0.07687918978051494
Bond Position:  [12.54585451]


portfolio before change:  [4.17603015]
curr_Stock_Price:  108.88003020973312
curr_Factors:  [108.88003021]
mat_Sqrt:  [[0.15]]
grads:  [0.13490706]
Stock Position:  0.13490706337365152
Bond Position:  [-10.51265499]


portfolio before change:  [4.24051288]
curr_Stock_Price:  109.36287961418155
curr_Factors:  [109.36287961]
mat_Sqrt:  [[0.15]]
grads:  [0.07369388]
Stock Position:  0.0736938786371746
Bond Position:  [-3.81886189]


portfolio before change:  [4.31992838]
curr_Stock_Price:  110.443758791183
curr_Factors:  [110.44375879]
mat_Sqrt:  [[0.15]]
grads:  [-0.02554397]
Stock Position:  -0.02554397405924855
Bond Position:  [7.14110089]


portfolio before change:  [4.33061097]
curr_Stock_Price:  110.0430279089775
curr_Factors:  [110.04302791]
mat_Sqrt:  [[0.15]]
grads:  [0.10679203]
Stock Position:  0.10679202663076745
Bond Position:  [-7.421107]


portfolio before change:  [4.4291375]
curr_Stock_Price:  110.96997317545727
curr_Factors:  [110.96997318]
mat_Sqrt:  [[0.15]]
grads:  [-0.21981608]
Stock Position:  -0.2198160807280809
Bond Position:  [28.82212208]


portfolio before change:  [4.42150867]
curr_Stock_Price:  111.01287389727517
curr_Factors:  [111.0128739]
mat_Sqrt:  [[0.15]]
grads:  [-0.49696317]
Stock Position:  -0.4969631665058116
Bond Position:  [59.590818]


portfolio before change:  [4.06722171]
curr_Stock_Price:  111.73327236005552
curr_Factors:  [111.73327236]
mat_Sqrt:  [[0.15]]
grads:  [0.0582067]
Stock Position:  0.05820669599321237
Bond Position:  [-2.43640291]


portfolio before change:  [4.08102518]
curr_Stock_Price:  111.97303431738611
curr_Factors:  [111.97303432]
mat_Sqrt:  [[0.15]]
grads:  [0.12924463]
Stock Position:  0.12924462692943697
Bond Position:  [-10.39088787]


portfolio before change:  [4.04602989]
curr_Stock_Price:  111.7072914554849
curr_Factors:  [111.70729146]
mat_Sqrt:  [[0.15]]
grads:  [-0.4113716]
Stock Position:  -0.41137159670562584
Bond Position:  [49.99923674]


portfolio before change:  [4.25378262]
curr_Stock_Price:  111.2098636267033
curr_Factors:  [111.20986363]
mat_Sqrt:  [[0.15]]
grads:  [0.20077934]
Stock Position:  0.20077934283310878
Bond Position:  [-18.07486071]


portfolio before change:  [4.28293859]
curr_Stock_Price:  111.36070426578758
curr_Factors:  [111.36070427]
mat_Sqrt:  [[0.15]]
grads:  [-0.20892769]
Stock Position:  -0.2089276871362728
Bond Position:  [27.54927297]


portfolio before change:  [4.32295391]
curr_Stock_Price:  111.17741868722099
curr_Factors:  [111.17741869]
mat_Sqrt:  [[0.15]]
grads:  [0.073749]
Stock Position:  0.07374899815654096
Bond Position:  [-3.87626934]


portfolio before change:  [4.3435544]
curr_Stock_Price:  111.4600363033167
curr_Factors:  [111.4600363]
mat_Sqrt:  [[0.15]]
grads:  [0.11879974]
Stock Position:  0.11879974201906965
Bond Position:  [-8.89786916]


portfolio before change:  [4.43220636]
curr_Stock_Price:  112.21094781641115
curr_Factors:  [112.21094782]
mat_Sqrt:  [[0.15]]
grads:  [-0.16572071]
Stock Position:  -0.1657207078428571
Bond Position:  [23.02788406]


portfolio before change:  [4.39411802]
curr_Stock_Price:  112.44946736289867
curr_Factors:  [112.44946736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.39411802]
Stock Price:  113.4268265372078
PL:  [-9.03270852]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.12404207647065761
FINAL STD P&L:  9.113712166966362
