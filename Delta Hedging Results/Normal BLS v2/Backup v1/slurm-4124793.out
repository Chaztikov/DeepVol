WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 00:26:52.127866: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 00:26:52.156562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 00:26:52.157185: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:26:52.159215: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:26:52.161058: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:26:52.161585: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:26:52.163846: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:26:52.165739: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:26:52.171088: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:26:52.173372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:26:52.174011: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 00:26:52.180460: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399875000 Hz
2019-12-17 00:26:52.180641: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f17e5541a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:26:52.180658: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 00:26:52.181684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 00:26:52.181717: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:26:52.181730: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:26:52.181740: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:26:52.181751: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:26:52.181760: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:26:52.181771: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:26:52.181782: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:26:52.183658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:26:52.183687: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:26:52.285806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 00:26:52.285854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 00:26:52.285865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 00:26:52.288916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-17 00:26:52.291008: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f17eb8d4b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:26:52.291024: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 00:27:08.721946: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 3.5511e+01,   Y0: 2.3522e+00,  elapsed time  16
INFO   step:     1,    loss: 8.9615e+00,   Y0: 2.3472e+00,  elapsed time  23
INFO   step:     2,    loss: 8.9847e+00,   Y0: 2.3422e+00,  elapsed time  23
INFO   step:     3,    loss: 8.9758e+00,   Y0: 2.3372e+00,  elapsed time  23
INFO   step:     4,    loss: 8.9598e+00,   Y0: 2.3323e+00,  elapsed time  23
INFO   step:     5,    loss: 8.9487e+00,   Y0: 2.3275e+00,  elapsed time  23
INFO   step:     6,    loss: 8.9484e+00,   Y0: 2.3226e+00,  elapsed time  23
INFO   step:     7,    loss: 9.0044e+00,   Y0: 2.3179e+00,  elapsed time  23
INFO   step:     8,    loss: 9.0609e+00,   Y0: 2.3131e+00,  elapsed time  23
INFO   step:     9,    loss: 9.0774e+00,   Y0: 2.3085e+00,  elapsed time  24
INFO   step:    10,    loss: 9.0672e+00,   Y0: 2.3039e+00,  elapsed time  24
INFO   step:    11,    loss: 9.0467e+00,   Y0: 2.2994e+00,  elapsed time  24
INFO   step:    12,    loss: 9.0239e+00,   Y0: 2.2950e+00,  elapsed time  24
INFO   step:    13,    loss: 9.0033e+00,   Y0: 2.2906e+00,  elapsed time  24
INFO   step:    14,    loss: 8.9852e+00,   Y0: 2.2862e+00,  elapsed time  24
INFO   step:    15,    loss: 8.9693e+00,   Y0: 2.2818e+00,  elapsed time  24
INFO   step:    16,    loss: 8.9556e+00,   Y0: 2.2774e+00,  elapsed time  24
INFO   step:    17,    loss: 8.9442e+00,   Y0: 2.2729e+00,  elapsed time  24
INFO   step:    18,    loss: 8.9347e+00,   Y0: 2.2684e+00,  elapsed time  24
INFO   step:    19,    loss: 8.9262e+00,   Y0: 2.2640e+00,  elapsed time  24
INFO   step:    20,    loss: 8.9191e+00,   Y0: 2.2597e+00,  elapsed time  24
INFO   step:    21,    loss: 8.9125e+00,   Y0: 2.2554e+00,  elapsed time  24
INFO   step:    22,    loss: 8.9067e+00,   Y0: 2.2512e+00,  elapsed time  25
INFO   step:    23,    loss: 8.9015e+00,   Y0: 2.2471e+00,  elapsed time  25
INFO   step:    24,    loss: 8.8971e+00,   Y0: 2.2429e+00,  elapsed time  25
INFO   step:    25,    loss: 8.8931e+00,   Y0: 2.2387e+00,  elapsed time  25
INFO   step:    26,    loss: 8.8898e+00,   Y0: 2.2345e+00,  elapsed time  25
INFO   step:    27,    loss: 8.8868e+00,   Y0: 2.2303e+00,  elapsed time  25
INFO   step:    28,    loss: 8.8842e+00,   Y0: 2.2264e+00,  elapsed time  25
INFO   step:    29,    loss: 8.8818e+00,   Y0: 2.2224e+00,  elapsed time  25
INFO   step:    30,    loss: 8.8797e+00,   Y0: 2.2184e+00,  elapsed time  25
INFO   step:    31,    loss: 8.8777e+00,   Y0: 2.2147e+00,  elapsed time  25
INFO   step:    32,    loss: 8.8758e+00,   Y0: 2.2110e+00,  elapsed time  25
INFO   step:    33,    loss: 8.8741e+00,   Y0: 2.2076e+00,  elapsed time  25
INFO   step:    34,    loss: 8.8725e+00,   Y0: 2.2043e+00,  elapsed time  25
INFO   step:    35,    loss: 8.8711e+00,   Y0: 2.2010e+00,  elapsed time  25
INFO   step:    36,    loss: 8.8698e+00,   Y0: 2.1978e+00,  elapsed time  26
INFO   step:    37,    loss: 8.8686e+00,   Y0: 2.1949e+00,  elapsed time  26
INFO   step:    38,    loss: 8.8674e+00,   Y0: 2.1919e+00,  elapsed time  26
INFO   step:    39,    loss: 8.8664e+00,   Y0: 2.1894e+00,  elapsed time  26
INFO   step:    40,    loss: 8.8653e+00,   Y0: 2.1868e+00,  elapsed time  26
INFO   step:    41,    loss: 8.8645e+00,   Y0: 2.1845e+00,  elapsed time  26
INFO   step:    42,    loss: 8.8636e+00,   Y0: 2.1821e+00,  elapsed time  26
INFO   step:    43,    loss: 8.8627e+00,   Y0: 2.1797e+00,  elapsed time  26
INFO   step:    44,    loss: 8.8618e+00,   Y0: 2.1772e+00,  elapsed time  26
INFO   step:    45,    loss: 8.8609e+00,   Y0: 2.1746e+00,  elapsed time  26
INFO   step:    46,    loss: 8.8601e+00,   Y0: 2.1721e+00,  elapsed time  26
INFO   step:    47,    loss: 8.8594e+00,   Y0: 2.1698e+00,  elapsed time  26
INFO   step:    48,    loss: 8.8587e+00,   Y0: 2.1676e+00,  elapsed time  26
INFO   step:    49,    loss: 8.8580e+00,   Y0: 2.1654e+00,  elapsed time  27
INFO   step:    50,    loss: 8.8575e+00,   Y0: 2.1636e+00,  elapsed time  27
INFO   step:    51,    loss: 8.8569e+00,   Y0: 2.1619e+00,  elapsed time  27
INFO   step:    52,    loss: 8.8564e+00,   Y0: 2.1601e+00,  elapsed time  27
INFO   step:    53,    loss: 8.8559e+00,   Y0: 2.1585e+00,  elapsed time  27
INFO   step:    54,    loss: 8.8555e+00,   Y0: 2.1571e+00,  elapsed time  27
INFO   step:    55,    loss: 8.8551e+00,   Y0: 2.1558e+00,  elapsed time  27
INFO   step:    56,    loss: 8.8547e+00,   Y0: 2.1546e+00,  elapsed time  27
INFO   step:    57,    loss: 8.8543e+00,   Y0: 2.1535e+00,  elapsed time  27
INFO   step:    58,    loss: 8.8540e+00,   Y0: 2.1526e+00,  elapsed time  27
INFO   step:    59,    loss: 8.8537e+00,   Y0: 2.1520e+00,  elapsed time  27
INFO   step:    60,    loss: 8.8534e+00,   Y0: 2.1516e+00,  elapsed time  27
INFO   step:    61,    loss: 8.8532e+00,   Y0: 2.1512e+00,  elapsed time  27
INFO   step:    62,    loss: 8.8530e+00,   Y0: 2.1512e+00,  elapsed time  28
INFO   step:    63,    loss: 8.8528e+00,   Y0: 2.1508e+00,  elapsed time  28
INFO   step:    64,    loss: 8.8525e+00,   Y0: 2.1501e+00,  elapsed time  28
INFO   step:    65,    loss: 8.8523e+00,   Y0: 2.1494e+00,  elapsed time  28
INFO   step:    66,    loss: 8.8520e+00,   Y0: 2.1487e+00,  elapsed time  28
INFO   step:    67,    loss: 8.8518e+00,   Y0: 2.1481e+00,  elapsed time  28
INFO   step:    68,    loss: 8.8515e+00,   Y0: 2.1474e+00,  elapsed time  28
INFO   step:    69,    loss: 8.8513e+00,   Y0: 2.1469e+00,  elapsed time  28
INFO   step:    70,    loss: 8.8510e+00,   Y0: 2.1461e+00,  elapsed time  28
INFO   step:    71,    loss: 8.8507e+00,   Y0: 2.1452e+00,  elapsed time  28
INFO   step:    72,    loss: 8.8505e+00,   Y0: 2.1445e+00,  elapsed time  28
INFO   step:    73,    loss: 8.8502e+00,   Y0: 2.1437e+00,  elapsed time  28
INFO   step:    74,    loss: 8.8500e+00,   Y0: 2.1429e+00,  elapsed time  28
INFO   step:    75,    loss: 8.8498e+00,   Y0: 2.1427e+00,  elapsed time  29
INFO   step:    76,    loss: 8.8496e+00,   Y0: 2.1424e+00,  elapsed time  29
INFO   step:    77,    loss: 8.8495e+00,   Y0: 2.1422e+00,  elapsed time  29
INFO   step:    78,    loss: 8.8493e+00,   Y0: 2.1423e+00,  elapsed time  29
INFO   step:    79,    loss: 8.8492e+00,   Y0: 2.1424e+00,  elapsed time  29
INFO   step:    80,    loss: 8.8491e+00,   Y0: 2.1424e+00,  elapsed time  29
INFO   step:    81,    loss: 8.8490e+00,   Y0: 2.1425e+00,  elapsed time  29
INFO   step:    82,    loss: 8.8488e+00,   Y0: 2.1427e+00,  elapsed time  29
INFO   step:    83,    loss: 8.8487e+00,   Y0: 2.1429e+00,  elapsed time  29
INFO   step:    84,    loss: 8.8486e+00,   Y0: 2.1428e+00,  elapsed time  29
INFO   step:    85,    loss: 8.8484e+00,   Y0: 2.1425e+00,  elapsed time  29
INFO   step:    86,    loss: 8.8483e+00,   Y0: 2.1426e+00,  elapsed time  29
INFO   step:    87,    loss: 8.8481e+00,   Y0: 2.1422e+00,  elapsed time  29
INFO   step:    88,    loss: 8.8480e+00,   Y0: 2.1420e+00,  elapsed time  30
INFO   step:    89,    loss: 8.8478e+00,   Y0: 2.1418e+00,  elapsed time  30
INFO   step:    90,    loss: 8.8477e+00,   Y0: 2.1419e+00,  elapsed time  30
INFO   step:    91,    loss: 8.8475e+00,   Y0: 2.1418e+00,  elapsed time  30
INFO   step:    92,    loss: 8.8474e+00,   Y0: 2.1418e+00,  elapsed time  30
INFO   step:    93,    loss: 8.8473e+00,   Y0: 2.1417e+00,  elapsed time  30
INFO   step:    94,    loss: 8.8471e+00,   Y0: 2.1417e+00,  elapsed time  30
INFO   step:    95,    loss: 8.8470e+00,   Y0: 2.1414e+00,  elapsed time  30
INFO   step:    96,    loss: 8.8469e+00,   Y0: 2.1415e+00,  elapsed time  30
INFO   step:    97,    loss: 8.8468e+00,   Y0: 2.1416e+00,  elapsed time  30
INFO   step:    98,    loss: 8.8467e+00,   Y0: 2.1422e+00,  elapsed time  30
INFO   step:    99,    loss: 8.8467e+00,   Y0: 2.1429e+00,  elapsed time  30
INFO   step:   100,    loss: 8.8466e+00,   Y0: 2.1433e+00,  elapsed time  30
INFO   step:   101,    loss: 8.8465e+00,   Y0: 2.1437e+00,  elapsed time  31
INFO   step:   102,    loss: 8.8465e+00,   Y0: 2.1440e+00,  elapsed time  31
INFO   step:   103,    loss: 8.8464e+00,   Y0: 2.1443e+00,  elapsed time  31
INFO   step:   104,    loss: 8.8463e+00,   Y0: 2.1444e+00,  elapsed time  31
INFO   step:   105,    loss: 8.8461e+00,   Y0: 2.1442e+00,  elapsed time  31
INFO   step:   106,    loss: 8.8460e+00,   Y0: 2.1440e+00,  elapsed time  31
INFO   step:   107,    loss: 8.8458e+00,   Y0: 2.1440e+00,  elapsed time  31
INFO   step:   108,    loss: 8.8457e+00,   Y0: 2.1436e+00,  elapsed time  31
INFO   step:   109,    loss: 8.8455e+00,   Y0: 2.1434e+00,  elapsed time  31
INFO   step:   110,    loss: 8.8454e+00,   Y0: 2.1434e+00,  elapsed time  31
INFO   step:   111,    loss: 8.8453e+00,   Y0: 2.1435e+00,  elapsed time  31
INFO   step:   112,    loss: 8.8452e+00,   Y0: 2.1437e+00,  elapsed time  31
INFO   step:   113,    loss: 8.8451e+00,   Y0: 2.1439e+00,  elapsed time  31
INFO   step:   114,    loss: 8.8450e+00,   Y0: 2.1438e+00,  elapsed time  31
INFO   step:   115,    loss: 8.8448e+00,   Y0: 2.1435e+00,  elapsed time  32
INFO   step:   116,    loss: 8.8447e+00,   Y0: 2.1436e+00,  elapsed time  32
INFO   step:   117,    loss: 8.8446e+00,   Y0: 2.1436e+00,  elapsed time  32
INFO   step:   118,    loss: 8.8445e+00,   Y0: 2.1434e+00,  elapsed time  32
INFO   step:   119,    loss: 8.8443e+00,   Y0: 2.1430e+00,  elapsed time  32
INFO   step:   120,    loss: 8.8441e+00,   Y0: 2.1425e+00,  elapsed time  32
INFO   step:   121,    loss: 8.8439e+00,   Y0: 2.1414e+00,  elapsed time  32
INFO   step:   122,    loss: 8.8436e+00,   Y0: 2.1404e+00,  elapsed time  32
INFO   step:   123,    loss: 8.8434e+00,   Y0: 2.1395e+00,  elapsed time  32
INFO   step:   124,    loss: 8.8432e+00,   Y0: 2.1392e+00,  elapsed time  32
INFO   step:   125,    loss: 8.8431e+00,   Y0: 2.1393e+00,  elapsed time  32
INFO   step:   126,    loss: 8.8430e+00,   Y0: 2.1395e+00,  elapsed time  32
INFO   step:   127,    loss: 8.8429e+00,   Y0: 2.1391e+00,  elapsed time  32
INFO   step:   128,    loss: 8.8427e+00,   Y0: 2.1385e+00,  elapsed time  33
INFO   step:   129,    loss: 8.8425e+00,   Y0: 2.1380e+00,  elapsed time  33
INFO   step:   130,    loss: 8.8424e+00,   Y0: 2.1382e+00,  elapsed time  33
INFO   step:   131,    loss: 8.8423e+00,   Y0: 2.1382e+00,  elapsed time  33
INFO   step:   132,    loss: 8.8422e+00,   Y0: 2.1384e+00,  elapsed time  33
INFO   step:   133,    loss: 8.8421e+00,   Y0: 2.1384e+00,  elapsed time  33
INFO   step:   134,    loss: 8.8420e+00,   Y0: 2.1379e+00,  elapsed time  33
INFO   step:   135,    loss: 8.8419e+00,   Y0: 2.1380e+00,  elapsed time  33
INFO   step:   136,    loss: 8.8418e+00,   Y0: 2.1382e+00,  elapsed time  33
INFO   step:   137,    loss: 8.8418e+00,   Y0: 2.1387e+00,  elapsed time  33
INFO   step:   138,    loss: 8.8417e+00,   Y0: 2.1393e+00,  elapsed time  33
INFO   step:   139,    loss: 8.8417e+00,   Y0: 2.1400e+00,  elapsed time  33
INFO   step:   140,    loss: 8.8417e+00,   Y0: 2.1411e+00,  elapsed time  33
INFO   step:   141,    loss: 8.8418e+00,   Y0: 2.1422e+00,  elapsed time  34
INFO   step:   142,    loss: 8.8418e+00,   Y0: 2.1433e+00,  elapsed time  34
INFO   step:   143,    loss: 8.8418e+00,   Y0: 2.1444e+00,  elapsed time  34
INFO   step:   144,    loss: 8.8418e+00,   Y0: 2.1449e+00,  elapsed time  34
INFO   step:   145,    loss: 8.8418e+00,   Y0: 2.1458e+00,  elapsed time  34
INFO   step:   146,    loss: 8.8419e+00,   Y0: 2.1472e+00,  elapsed time  34
INFO   step:   147,    loss: 8.8421e+00,   Y0: 2.1489e+00,  elapsed time  34
INFO   step:   148,    loss: 8.8422e+00,   Y0: 2.1504e+00,  elapsed time  34
INFO   step:   149,    loss: 8.8424e+00,   Y0: 2.1524e+00,  elapsed time  34
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  1
Loss out:  6.788438075863104
Output_Z_Vals:  [[[ 2.31216140e+00]
  [ 2.31216140e+00]
  [ 2.31216140e+00]
  ...
  [ 2.31216140e+00]
  [ 2.31216140e+00]
  [ 2.31216140e+00]]

 [[ 3.46106427e-03]
  [ 4.34182224e-03]
  [ 6.62147130e-03]
  ...
  [ 1.30325137e-02]
  [ 2.69364207e-03]
  [ 3.56453977e-02]]

 [[ 1.84189134e-03]
  [ 6.09377249e-03]
  [ 1.02782021e-02]
  ...
  [ 2.27994830e-03]
  [ 1.04597217e-02]
  [ 5.89362208e-03]]

 ...

 [[ 2.74809543e-03]
  [ 6.08111769e-03]
  [ 4.43758278e-03]
  ...
  [ 7.09189019e-03]
  [ 4.08922817e-03]
  [ 7.49530734e-03]]

 [[-4.81431348e-03]
  [-5.51283397e-03]
  [-1.98942944e-03]
  ...
  [-5.34490961e-03]
  [-2.65943683e-03]
  [-3.04450643e-03]]

 [[-1.11647371e-02]
  [-9.33958927e-03]
  [-1.26995121e-02]
  ...
  [-1.13803427e-02]
  [-1.21784113e-02]
  [-1.21492233e-02]]]
Z_Vals dimensionality:  (20, 200, 1)
X_test:  [[[100.         100.07302196  97.89949559 ...  93.91590305  92.5486149
    92.98083573]]

 [[100.         100.16407476 100.95925015 ... 107.54079207 108.54369525
   106.50239265]]

 [[100.         100.76961388  99.6051294  ...  97.77032758  97.80182131
    97.03845747]]

 ...

 [[100.          99.12626733  98.00401975 ... 105.10135446 103.5863383
   103.25138199]]

 [[100.          99.61201937  99.72425158 ...  96.44993553  95.37924563
    93.2518843 ]]

 [[100.          97.96506671  98.6862559  ... 101.13660901 101.85624664
   103.70759022]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.46106427e-03]
 [ 1.84189134e-03]
 [-4.00111459e-03]
 [-1.29497111e-03]
 [-6.21050125e-03]
 [-3.93695077e-03]
 [-2.97251410e-03]
 [ 3.16544030e-03]
 [ 4.62825914e-03]
 [ 1.08686942e-02]
 [-1.81072381e-02]
 [ 5.58880608e-03]
 [ 2.14439308e-03]
 [-2.78684537e-03]
 [-1.63470967e-02]
 [ 6.53692179e-03]
 [ 2.74809543e-03]
 [-4.81431348e-03]
 [-1.11647371e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.894896]
curr_Stock_Price:  100.07302196238841
curr_Factors:  [100.07302196]
mat_Sqrt:  [[0.15]]
grads:  [0.02307376]
Stock Position:  0.023073761826534075
Bond Position:  [0.58583493]


portfolio before change:  [2.84489105]
curr_Stock_Price:  97.89949558533041
curr_Factors:  [97.89949559]
mat_Sqrt:  [[0.15]]
grads:  [0.01227928]
Stock Position:  0.012279275596900861
Bond Position:  [1.64275616]


portfolio before change:  [2.82926385]
curr_Stock_Price:  96.59339726051321
curr_Factors:  [96.59339726]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266741]
Stock Position:  -0.02667409726845007
Bond Position:  [5.40580552]


portfolio before change:  [2.82867956]
curr_Stock_Price:  96.66597372121913
curr_Factors:  [96.66597372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00863314]
Stock Position:  -0.008633140755711876
Bond Position:  [3.66321051]


portfolio before change:  [2.83423015]
curr_Stock_Price:  96.12912623856654
curr_Factors:  [96.12912624]
mat_Sqrt:  [[0.15]]
grads:  [-0.04140334]
Stock Position:  -0.04140334167660149
Bond Position:  [6.81429721]


portfolio before change:  [2.88194895]
curr_Stock_Price:  95.0177422273937
curr_Factors:  [95.01774223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02624634]
Stock Position:  -0.026246338433696323
Bond Position:  [5.37581677]


portfolio before change:  [2.84734485]
curr_Stock_Price:  96.38738964493524
curr_Factors:  [96.38738964]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981676]
Stock Position:  -0.01981676063657271
Bond Position:  [4.75743067]


portfolio before change:  [2.85444029]
curr_Stock_Price:  96.08936238075077
curr_Factors:  [96.08936238]
mat_Sqrt:  [[0.15]]
grads:  [0.02110294]
Stock Position:  0.021102935322242108
Bond Position:  [0.82667269]


portfolio before change:  [2.86297701]
curr_Stock_Price:  96.4840957211485
curr_Factors:  [96.48409572]
mat_Sqrt:  [[0.15]]
grads:  [0.03085506]
Stock Position:  0.030855060909381976
Bond Position:  [-0.11404564]


portfolio before change:  [2.92110019]
curr_Stock_Price:  98.36876838703043
curr_Factors:  [98.36876839]
mat_Sqrt:  [[0.15]]
grads:  [0.07245796]
Stock Position:  0.07245796111628343
Bond Position:  [-4.20650021]


portfolio before change:  [2.87581652]
curr_Stock_Price:  97.75831912170719
curr_Factors:  [97.75831912]
mat_Sqrt:  [[0.15]]
grads:  [-0.12071492]
Stock Position:  -0.12071492034389668
Bond Position:  [14.67670423]


portfolio before change:  [2.95951774]
curr_Stock_Price:  97.09533903738472
curr_Factors:  [97.09533904]
mat_Sqrt:  [[0.15]]
grads:  [0.03725871]
Stock Position:  0.03725870723126568
Bond Position:  [-0.65812907]


portfolio before change:  [2.94133466]
curr_Stock_Price:  96.61173303504738
curr_Factors:  [96.61173304]
mat_Sqrt:  [[0.15]]
grads:  [0.01429595]
Stock Position:  0.014295953837130764
Bond Position:  [1.56017778]


portfolio before change:  [2.92922249]
curr_Stock_Price:  95.73720149421297
curr_Factors:  [95.73720149]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857897]
Stock Position:  -0.018578969138273456
Bond Position:  [4.707921]


portfolio before change:  [2.94408884]
curr_Stock_Price:  95.00038864392882
curr_Factors:  [95.00038864]
mat_Sqrt:  [[0.15]]
grads:  [-0.10898064]
Stock Position:  -0.10898064466389484
Bond Position:  [13.29729244]


portfolio before change:  [2.9109024]
curr_Stock_Price:  95.33541305716201
curr_Factors:  [95.33541306]
mat_Sqrt:  [[0.15]]
grads:  [0.04357948]
Stock Position:  0.0435794785967745
Bond Position:  [-1.24376519]


portfolio before change:  [2.88306543]
curr_Stock_Price:  94.70378570570057
curr_Factors:  [94.70378571]
mat_Sqrt:  [[0.15]]
grads:  [0.01832064]
Stock Position:  0.018320636199097278
Bond Position:  [1.14803183]


portfolio before change:  [2.86891796]
curr_Stock_Price:  93.91590305166369
curr_Factors:  [93.91590305]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209542]
Stock Position:  -0.032095423214425524
Bond Position:  [5.88318862]


portfolio before change:  [2.91427264]
curr_Stock_Price:  92.54861489707932
curr_Factors:  [92.5486149]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.91427264]
Stock Price:  92.9808357316719
PL:  [2.91427264]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.34182224e-03]
 [ 6.09377249e-03]
 [ 1.02543384e-03]
 [ 1.20819229e-02]
 [ 2.53979923e-02]
 [ 6.53248629e-03]
 [ 2.98150359e-02]
 [-1.43323968e-02]
 [ 1.03113201e-02]
 [-3.79665060e-02]
 [-8.56540544e-03]
 [-2.86609099e-02]
 [-1.75198991e-02]
 [ 8.97706018e-03]
 [ 4.46518617e-02]
 [-1.46018349e-03]
 [ 6.08111769e-03]
 [-5.51283397e-03]
 [-9.33958927e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.29842106]
curr_Stock_Price:  100.16407475759748
curr_Factors:  [100.16407476]
mat_Sqrt:  [[0.15]]
grads:  [0.02894548]
Stock Position:  0.028945481611989406
Bond Position:  [1.39912367]


portfolio before change:  [4.32178761]
curr_Stock_Price:  100.95925014789532
curr_Factors:  [100.95925015]
mat_Sqrt:  [[0.15]]
grads:  [0.04062515]
Stock Position:  0.04062514994952457
Bond Position:  [0.22030294]


portfolio before change:  [4.34245806]
curr_Stock_Price:  101.46670342224256
curr_Factors:  [101.46670342]
mat_Sqrt:  [[0.15]]
grads:  [0.00683623]
Stock Position:  0.006836225626229988
Bond Position:  [3.64880878]


portfolio before change:  [4.34060639]
curr_Stock_Price:  101.06238820052751
curr_Factors:  [101.0623882]
mat_Sqrt:  [[0.15]]
grads:  [0.08054615]
Stock Position:  0.08054615286730896
Bond Position:  [-3.79958018]


portfolio before change:  [4.45316341]
curr_Stock_Price:  102.4716055986748
curr_Factors:  [102.4716056]
mat_Sqrt:  [[0.15]]
grads:  [0.16931995]
Stock Position:  0.16931994865960884
Bond Position:  [-12.89732358]


portfolio before change:  [4.5637065]
curr_Stock_Price:  103.14351591913527
curr_Factors:  [103.14351592]
mat_Sqrt:  [[0.15]]
grads:  [0.04354991]
Stock Position:  0.043549908632986745
Bond Position:  [0.07181581]


portfolio before change:  [4.61317805]
curr_Stock_Price:  104.27907718884177
curr_Factors:  [104.27907719]
mat_Sqrt:  [[0.15]]
grads:  [0.19876691]
Stock Position:  0.19876690621859017
Bond Position:  [-16.11405151]


portfolio before change:  [5.13699535]
curr_Stock_Price:  106.93468181628856
curr_Factors:  [106.93468182]
mat_Sqrt:  [[0.15]]
grads:  [-0.09554931]
Stock Position:  -0.09554931225127963
Bond Position:  [15.35453065]


portfolio before change:  [5.25903672]
curr_Stock_Price:  105.69760060786133
curr_Factors:  [105.69760061]
mat_Sqrt:  [[0.15]]
grads:  [0.06874213]
Stock Position:  0.06874213409322603
Bond Position:  [-2.00684192]


portfolio before change:  [5.39485971]
curr_Stock_Price:  107.68073320493326
curr_Factors:  [107.6807332]
mat_Sqrt:  [[0.15]]
grads:  [-0.25311004]
Stock Position:  -0.2531100397797881
Bond Position:  [32.64993438]


portfolio before change:  [5.8332186]
curr_Stock_Price:  105.98109542695502
curr_Factors:  [105.98109543]
mat_Sqrt:  [[0.15]]
grads:  [-0.0571027]
Stock Position:  -0.057102702902118975
Bond Position:  [11.88502561]


portfolio before change:  [5.81665152]
curr_Stock_Price:  106.32326333919394
curr_Factors:  [106.32326334]
mat_Sqrt:  [[0.15]]
grads:  [-0.19107273]
Stock Position:  -0.19107273239237896
Bond Position:  [26.13212796]


portfolio before change:  [5.68527692]
curr_Stock_Price:  107.04502221884174
curr_Factors:  [107.04502222]
mat_Sqrt:  [[0.15]]
grads:  [-0.11679933]
Stock Position:  -0.1167993271784106
Bond Position:  [18.1880635]


portfolio before change:  [5.55417794]
curr_Stock_Price:  108.20638653268502
curr_Factors:  [108.20638653]
mat_Sqrt:  [[0.15]]
grads:  [0.05984707]
Stock Position:  0.05984706784184258
Bond Position:  [-0.92165702]


portfolio before change:  [5.47828968]
curr_Stock_Price:  106.94220072151793
curr_Factors:  [106.94220072]
mat_Sqrt:  [[0.15]]
grads:  [0.29767908]
Stock Position:  0.2976790779448238
Bond Position:  [-26.35616602]


portfolio before change:  [5.80653912]
curr_Stock_Price:  108.06703389490454
curr_Factors:  [108.06703389]
mat_Sqrt:  [[0.15]]
grads:  [-0.00973456]
Stock Position:  -0.009734556592880379
Bond Position:  [6.85852377]


portfolio before change:  [5.81684352]
curr_Stock_Price:  107.1846563033865
curr_Factors:  [107.1846563]
mat_Sqrt:  [[0.15]]
grads:  [0.04054078]
Stock Position:  0.04054078459216465
Bond Position:  [1.47149345]


portfolio before change:  [5.83164946]
curr_Stock_Price:  107.54079206981993
curr_Factors:  [107.54079207]
mat_Sqrt:  [[0.15]]
grads:  [-0.03675223]
Stock Position:  -0.036752226457509425
Bond Position:  [9.784013]


portfolio before change:  [5.79723684]
curr_Stock_Price:  108.54369524971968
curr_Factors:  [108.54369525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.79723684]
Stock Price:  106.502392654705
PL:  [-0.70515581]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.62147130e-03]
 [ 1.02782021e-02]
 [ 1.32231410e-03]
 [ 1.79205334e-03]
 [ 2.60036033e-03]
 [ 4.24078564e-03]
 [-9.40393533e-03]
 [ 1.22165388e-02]
 [ 4.27428996e-03]
 [ 8.78890354e-03]
 [-1.54373789e-02]
 [-5.18633407e-03]
 [-2.46602906e-02]
 [ 3.49073887e-03]
 [ 3.32119597e-03]
 [ 7.87603497e-03]
 [ 4.43758278e-03]
 [-1.98942944e-03]
 [-1.26995121e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.6324489]
curr_Stock_Price:  100.76961387728713
curr_Factors:  [100.76961388]
mat_Sqrt:  [[0.15]]
grads:  [0.04414314]
Stock Position:  0.044143141970818145
Bond Position:  [9.18416152]


portfolio before change:  [13.58334122]
curr_Stock_Price:  99.60512939568527
curr_Factors:  [99.6051294]
mat_Sqrt:  [[0.15]]
grads:  [0.06852135]
Stock Position:  0.06852134726552507
Bond Position:  [6.75826356]


portfolio before change:  [13.61181096]
curr_Stock_Price:  99.99595605055113
curr_Factors:  [99.99595605]
mat_Sqrt:  [[0.15]]
grads:  [0.00881543]
Stock Position:  0.008815427341055605
Bond Position:  [12.73030388]


portfolio before change:  [13.60120527]
curr_Stock_Price:  98.43180446585295
curr_Factors:  [98.43180447]
mat_Sqrt:  [[0.15]]
grads:  [0.01194702]
Stock Position:  0.011947022262468143
Bond Position:  [12.42523831]


portfolio before change:  [13.61009085]
curr_Stock_Price:  98.9155128267969
curr_Factors:  [98.91551283]
mat_Sqrt:  [[0.15]]
grads:  [0.01733574]
Stock Position:  0.017335735511200462
Bond Position:  [11.89531768]


portfolio before change:  [13.62042894]
curr_Stock_Price:  99.34029396088123
curr_Factors:  [99.34029396]
mat_Sqrt:  [[0.15]]
grads:  [0.0282719]
Stock Position:  0.028271904246686432
Bond Position:  [10.81188966]


portfolio before change:  [13.60004635]
curr_Stock_Price:  98.52372701394172
curr_Factors:  [98.52372701]
mat_Sqrt:  [[0.15]]
grads:  [-0.0626929]
Stock Position:  -0.06269290217874193
Bond Position:  [19.77678473]


portfolio before change:  [13.57861809]
curr_Stock_Price:  98.9443978355418
curr_Factors:  [98.94439784]
mat_Sqrt:  [[0.15]]
grads:  [0.08144359]
Stock Position:  0.0814435920115397
Bond Position:  [5.52023092]


portfolio before change:  [13.56561891]
curr_Stock_Price:  98.76784115075499
curr_Factors:  [98.76784115]
mat_Sqrt:  [[0.15]]
grads:  [0.02849527]
Stock Position:  0.02849526637749211
Bond Position:  [10.75120296]


portfolio before change:  [13.6082566]
curr_Stock_Price:  100.16981270904368
curr_Factors:  [100.16981271]
mat_Sqrt:  [[0.15]]
grads:  [0.05859269]
Stock Position:  0.0585926902548179
Bond Position:  [7.73903779]


portfolio before change:  [13.69555855]
curr_Stock_Price:  101.62676838099468
curr_Factors:  [101.62676838]
mat_Sqrt:  [[0.15]]
grads:  [-0.10291586]
Stock Position:  -0.10291585934827076
Bond Position:  [24.15456475]


portfolio before change:  [13.78172437]
curr_Stock_Price:  100.84820594742658
curr_Factors:  [100.84820595]
mat_Sqrt:  [[0.15]]
grads:  [-0.03457556]
Stock Position:  -0.03457556044882589
Bond Position:  [17.26860761]


portfolio before change:  [13.77161489]
curr_Stock_Price:  101.26547106783812
curr_Factors:  [101.26547107]
mat_Sqrt:  [[0.15]]
grads:  [-0.16440194]
Stock Position:  -0.16440193748595655
Bond Position:  [30.41985453]


portfolio before change:  [13.43185123]
curr_Stock_Price:  103.37839975918912
curr_Factors:  [103.37839976]
mat_Sqrt:  [[0.15]]
grads:  [0.02327159]
Stock Position:  0.023271592467341944
Bond Position:  [11.02607124]


portfolio before change:  [13.39342859]
curr_Stock_Price:  101.6088818578312
curr_Factors:  [101.60888186]
mat_Sqrt:  [[0.15]]
grads:  [0.02214131]
Stock Position:  0.022141306478994142
Bond Position:  [11.1436752]


portfolio before change:  [13.34850473]
curr_Stock_Price:  99.45408002587519
curr_Factors:  [99.45408003]
mat_Sqrt:  [[0.15]]
grads:  [0.0525069]
Stock Position:  0.05250689977915822
Bond Position:  [8.12647932]


portfolio before change:  [13.29173335]
curr_Stock_Price:  98.33416523765038
curr_Factors:  [98.33416524]
mat_Sqrt:  [[0.15]]
grads:  [0.02958389]
Stock Position:  0.02958388519727337
Bond Position:  [10.3826267]


portfolio before change:  [13.27764882]
curr_Stock_Price:  97.77032758323011
curr_Factors:  [97.77032758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326286]
Stock Position:  -0.013262862920103306
Bond Position:  [14.57436328]


portfolio before change:  [13.28087517]
curr_Stock_Price:  97.80182130741281
curr_Factors:  [97.80182131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.28087517]
Stock Price:  97.03845747001462
PL:  [13.28087517]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.79200265e-02]
 [ 6.50306921e-03]
 [ 1.00249565e-03]
 [ 1.63358414e-02]
 [ 2.42391446e-02]
 [ 6.30452022e-03]
 [ 3.09499064e-02]
 [-5.89712314e-03]
 [ 9.79024957e-03]
 [-2.06875887e-02]
 [-7.66274029e-03]
 [-2.77286391e-02]
 [-2.06774606e-02]
 [ 5.11243552e-03]
 [ 2.11143401e-02]
 [ 1.14128132e-03]
 [ 6.87420614e-03]
 [-5.38985876e-03]
 [-1.02826512e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.31827714]
curr_Stock_Price:  102.37109128470718
curr_Factors:  [102.37109128]
mat_Sqrt:  [[0.15]]
grads:  [0.18613351]
Stock Position:  0.18613351023869093
Bond Position:  [19.26358657]


portfolio before change:  [38.25450175]
curr_Stock_Price:  102.00258216579272
curr_Factors:  [102.00258217]
mat_Sqrt:  [[0.15]]
grads:  [0.04335379]
Stock Position:  0.04335379473570287
Bond Position:  [33.83230274]


portfolio before change:  [38.23856144]
curr_Stock_Price:  101.4397839351679
curr_Factors:  [101.43978394]
mat_Sqrt:  [[0.15]]
grads:  [0.0066833]
Stock Position:  0.0066833043486868
Bond Position:  [37.56060849]


portfolio before change:  [38.26246232]
curr_Stock_Price:  103.6107996894325
curr_Factors:  [103.61079969]
mat_Sqrt:  [[0.15]]
grads:  [0.10890561]
Stock Position:  0.10890560955608512
Bond Position:  [26.97866503]


portfolio before change:  [38.26125472]
curr_Stock_Price:  103.53777213424107
curr_Factors:  [103.53777213]
mat_Sqrt:  [[0.15]]
grads:  [0.1615943]
Stock Position:  0.16159429728914768
Bond Position:  [21.53014119]


portfolio before change:  [38.3016186]
curr_Stock_Price:  103.75424433000077
curr_Factors:  [103.75424433]
mat_Sqrt:  [[0.15]]
grads:  [0.04203013]
Stock Position:  0.04203013479920442
Bond Position:  [33.94081373]


portfolio before change:  [38.31787306]
curr_Stock_Price:  103.93906860421457
curr_Factors:  [103.9390686]
mat_Sqrt:  [[0.15]]
grads:  [0.20633271]
Stock Position:  0.20633270948828994
Bond Position:  [16.87184341]


portfolio before change:  [38.55274252]
curr_Stock_Price:  105.05692808407576
curr_Factors:  [105.05692808]
mat_Sqrt:  [[0.15]]
grads:  [-0.03931415]
Stock Position:  -0.0393141542881022
Bond Position:  [42.6829668]


portfolio before change:  [38.5623131]
curr_Stock_Price:  105.08494592969397
curr_Factors:  [105.08494593]
mat_Sqrt:  [[0.15]]
grads:  [0.06526833]
Stock Position:  0.0652683304701955
Bond Position:  [31.70359412]


portfolio before change:  [38.60037291]
curr_Stock_Price:  105.54662342475932
curr_Factors:  [105.54662342]
mat_Sqrt:  [[0.15]]
grads:  [-0.13791726]
Stock Position:  -0.13791725796628546
Bond Position:  [53.1570738]


portfolio before change:  [38.47629475]
curr_Stock_Price:  106.54264881066185
curr_Factors:  [106.54264881]
mat_Sqrt:  [[0.15]]
grads:  [-0.05108494]
Stock Position:  -0.0510849352946645
Bond Position:  [43.91901907]


portfolio before change:  [38.50673114]
curr_Stock_Price:  106.16180735844556
curr_Factors:  [106.16180736]
mat_Sqrt:  [[0.15]]
grads:  [-0.18485759]
Stock Position:  -0.1848575941294107
Bond Position:  [58.13154743]


portfolio before change:  [38.9008684]
curr_Stock_Price:  104.10832094205016
curr_Factors:  [104.10832094]
mat_Sqrt:  [[0.15]]
grads:  [-0.13784974]
Stock Position:  -0.13784973721041344
Bond Position:  [53.25217308]


portfolio before change:  [38.78142855]
curr_Stock_Price:  105.071359070709
curr_Factors:  [105.07135907]
mat_Sqrt:  [[0.15]]
grads:  [0.0340829]
Stock Position:  0.03408290348985279
Bond Position:  [35.20029156]


portfolio before change:  [38.7414845]
curr_Stock_Price:  103.6411631889349
curr_Factors:  [103.64116319]
mat_Sqrt:  [[0.15]]
grads:  [0.14076227]
Stock Position:  0.1407622674839641
Bond Position:  [24.15271936]


portfolio before change:  [38.89376535]
curr_Stock_Price:  104.68009160948168
curr_Factors:  [104.68009161]
mat_Sqrt:  [[0.15]]
grads:  [0.00760854]
Stock Position:  0.007608542138008972
Bond Position:  [38.09730246]


portfolio before change:  [38.90407522]
curr_Stock_Price:  104.78317988289581
curr_Factors:  [104.78317988]
mat_Sqrt:  [[0.15]]
grads:  [0.04582804]
Stock Position:  0.04582804091081759
Bond Position:  [34.10206736]


portfolio before change:  [38.94127277]
curr_Stock_Price:  105.4088004891269
curr_Factors:  [105.40880049]
mat_Sqrt:  [[0.15]]
grads:  [-0.03593239]
Stock Position:  -0.035932391706500665
Bond Position:  [42.72886308]


portfolio before change:  [38.92875971]
curr_Stock_Price:  106.0543631399766
curr_Factors:  [106.05436314]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.92875971]
Stock Price:  106.01739056302019
PL:  [32.91136915]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.75280596e-02]
 [ 7.06830842e-03]
 [ 2.14773142e-03]
 [ 1.78942807e-02]
 [ 1.84711181e-02]
 [ 5.11295584e-03]
 [ 2.29831119e-02]
 [-1.04770857e-02]
 [ 1.15333332e-02]
 [-4.02931280e-02]
 [-4.42293067e-03]
 [-4.04616313e-02]
 [-1.66009681e-02]
 [ 6.88000788e-03]
 [ 5.91801624e-02]
 [-2.39467532e-03]
 [ 5.00781759e-03]
 [-6.40086025e-03]
 [-7.62270779e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.86422852]
curr_Stock_Price:  102.34163516894601
curr_Factors:  [102.34163517]
mat_Sqrt:  [[0.15]]
grads:  [0.1835204]
Stock Position:  0.18352039729541203
Bond Position:  [19.08245097]


portfolio before change:  [37.95086108]
curr_Stock_Price:  102.78769650880356
curr_Factors:  [102.78769651]
mat_Sqrt:  [[0.15]]
grads:  [0.04712206]
Stock Position:  0.047122056142824484
Bond Position:  [33.10729348]


portfolio before change:  [37.98559113]
curr_Stock_Price:  103.34905119019793
curr_Factors:  [103.34905119]
mat_Sqrt:  [[0.15]]
grads:  [0.01431821]
Stock Position:  0.014318209461222116
Bond Position:  [36.50581776]


portfolio before change:  [38.01923871]
curr_Stock_Price:  105.06155522333421
curr_Factors:  [105.06155522]
mat_Sqrt:  [[0.15]]
grads:  [0.1192952]
Stock Position:  0.11929520449460256
Bond Position:  [25.485899]


portfolio before change:  [38.31725555]
curr_Stock_Price:  107.50628525943165
curr_Factors:  [107.50628526]
mat_Sqrt:  [[0.15]]
grads:  [0.12314079]
Stock Position:  0.12314078708290532
Bond Position:  [25.07884697]


portfolio before change:  [38.1881245]
curr_Stock_Price:  106.40671821237386
curr_Factors:  [106.40671821]
mat_Sqrt:  [[0.15]]
grads:  [0.03408637]
Stock Position:  0.034086372290853234
Bond Position:  [34.56110549]


portfolio before change:  [38.19401208]
curr_Stock_Price:  106.32592996477021
curr_Factors:  [106.32592996]
mat_Sqrt:  [[0.15]]
grads:  [0.15322075]
Stock Position:  0.1532207461365047
Bond Position:  [21.90267375]


portfolio before change:  [38.15539637]
curr_Stock_Price:  106.03816174391335
curr_Factors:  [106.03816174]
mat_Sqrt:  [[0.15]]
grads:  [-0.06984724]
Stock Position:  -0.06984723810524542
Bond Position:  [45.5618691]


portfolio before change:  [38.09021929]
curr_Stock_Price:  107.13439653806904
curr_Factors:  [107.13439654]
mat_Sqrt:  [[0.15]]
grads:  [0.07688889]
Stock Position:  0.07688888802456251
Bond Position:  [29.85277467]


portfolio before change:  [38.16178541]
curr_Stock_Price:  107.96809303979269
curr_Factors:  [107.96809304]
mat_Sqrt:  [[0.15]]
grads:  [-0.26862085]
Stock Position:  -0.26862085326578783
Bond Position:  [67.16426669]


portfolio before change:  [37.86036546]
curr_Stock_Price:  109.1527110853235
curr_Factors:  [109.15271109]
mat_Sqrt:  [[0.15]]
grads:  [-0.0294862]
Stock Position:  -0.029486204480211886
Bond Position:  [41.07886462]


portfolio before change:  [37.8938047]
curr_Stock_Price:  108.36697980544254
curr_Factors:  [108.36697981]
mat_Sqrt:  [[0.15]]
grads:  [-0.26974421]
Stock Position:  -0.2697442089717156
Bond Position:  [67.12516994]


portfolio before change:  [38.11008102]
curr_Stock_Price:  107.62741646910531
curr_Factors:  [107.62741647]
mat_Sqrt:  [[0.15]]
grads:  [-0.11067312]
Stock Position:  -0.11067312042467761
Bond Position:  [50.02154304]


portfolio before change:  [38.24637981]
curr_Stock_Price:  106.50888066746009
curr_Factors:  [106.50888067]
mat_Sqrt:  [[0.15]]
grads:  [0.04586672]
Stock Position:  0.04586671918455339
Bond Position:  [33.36116689]


portfolio before change:  [38.36779136]
curr_Stock_Price:  108.97407138697506
curr_Factors:  [108.97407139]
mat_Sqrt:  [[0.15]]
grads:  [0.39453442]
Stock Position:  0.39453441585464394
Bond Position:  [-4.62623024]


portfolio before change:  [38.84104601]
curr_Stock_Price:  110.17653012060116
curr_Factors:  [110.17653012]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159645]
Stock Position:  -0.015964502102712858
Bond Position:  [40.59995946]


portfolio before change:  [38.84707707]
curr_Stock_Price:  110.43461522786772
curr_Factors:  [110.43461523]
mat_Sqrt:  [[0.15]]
grads:  [0.03338545]
Stock Position:  0.033385450601704426
Bond Position:  [35.16016768]


portfolio before change:  [38.82096288]
curr_Stock_Price:  109.38909001936221
curr_Factors:  [109.38909002]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426724]
Stock Position:  -0.042672401668307325
Bond Position:  [43.48885807]


portfolio before change:  [38.67452324]
curr_Stock_Price:  113.07562285624451
curr_Factors:  [113.07562286]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.67452324]
Stock Price:  110.85659528195694
PL:  [27.81792796]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.10942456e-03]
 [ 1.00944310e-02]
 [ 1.20488187e-03]
 [ 1.36209723e-02]
 [ 2.49648552e-02]
 [ 6.69472688e-03]
 [ 3.35870486e-02]
 [ 6.64834260e-04]
 [ 9.06486452e-03]
 [-5.92306479e-03]
 [-1.21988529e-02]
 [-1.20738238e-02]
 [-2.08391255e-02]
 [ 7.44320256e-03]
 [ 3.75150420e-02]
 [ 5.09421030e-04]
 [ 5.92933493e-03]
 [-5.55244137e-03]
 [-1.06445892e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.56008623]
curr_Stock_Price:  99.58938473166906
curr_Factors:  [99.58938473]
mat_Sqrt:  [[0.15]]
grads:  [0.0207295]
Stock Position:  0.02072949705020038
Bond Position:  [-6.62452408]


portfolio before change:  [-4.56297989]
curr_Stock_Price:  99.52969546058812
curr_Factors:  [99.52969546]
mat_Sqrt:  [[0.15]]
grads:  [0.06729621]
Stock Position:  0.06729620671738447
Bond Position:  [-11.26095085]


portfolio before change:  [-4.51838034]
curr_Stock_Price:  100.23426923311607
curr_Factors:  [100.23426923]
mat_Sqrt:  [[0.15]]
grads:  [0.00803255]
Stock Position:  0.008032545774355717
Bond Position:  [-5.3235167]


portfolio before change:  [-4.51112301]
curr_Stock_Price:  101.30346670890825
curr_Factors:  [101.30346671]
mat_Sqrt:  [[0.15]]
grads:  [0.09080648]
Stock Position:  0.0908064821885325
Bond Position:  [-13.71013445]


portfolio before change:  [-4.46363584]
curr_Stock_Price:  101.86416595913013
curr_Factors:  [101.86416596]
mat_Sqrt:  [[0.15]]
grads:  [0.16643237]
Stock Position:  0.16643236791233676
Bond Position:  [-21.41713019]


portfolio before change:  [-4.328405]
curr_Stock_Price:  102.70886820430358
curr_Factors:  [102.7088682]
mat_Sqrt:  [[0.15]]
grads:  [0.04463151]
Stock Position:  0.04463151252133108
Bond Position:  [-8.91245714]


portfolio before change:  [-4.35729125]
curr_Stock_Price:  102.11158054949952
curr_Factors:  [102.11158055]
mat_Sqrt:  [[0.15]]
grads:  [0.22391366]
Stock Position:  0.22391365752357748
Bond Position:  [-27.22146872]


portfolio before change:  [-4.01804619]
curr_Stock_Price:  103.65704801461996
curr_Factors:  [103.65704801]
mat_Sqrt:  [[0.15]]
grads:  [0.00443223]
Stock Position:  0.0044322284015931605
Bond Position:  [-4.4774779]


portfolio before change:  [-4.01661709]
curr_Stock_Price:  104.23206612776218
curr_Factors:  [104.23206613]
mat_Sqrt:  [[0.15]]
grads:  [0.06043243]
Stock Position:  0.060432430163643164
Bond Position:  [-10.31561415]


portfolio before change:  [-4.05259614]
curr_Stock_Price:  103.67938567748456
curr_Factors:  [103.67938568]
mat_Sqrt:  [[0.15]]
grads:  [-0.0394871]
Stock Position:  -0.03948709863084054
Bond Position:  [0.04140199]


portfolio before change:  [-4.05523537]
curr_Stock_Price:  103.7464857534916
curr_Factors:  [103.74648575]
mat_Sqrt:  [[0.15]]
grads:  [-0.08132569]
Stock Position:  -0.08132568568983051
Bond Position:  [4.38201872]


portfolio before change:  [-4.03007799]
curr_Stock_Price:  103.45061686864393
curr_Factors:  [103.45061687]
mat_Sqrt:  [[0.15]]
grads:  [-0.08049216]
Stock Position:  -0.08049215858929153
Bond Position:  [4.29688547]


portfolio before change:  [-4.06564923]
curr_Stock_Price:  103.9058860471276
curr_Factors:  [103.90588605]
mat_Sqrt:  [[0.15]]
grads:  [-0.1389275]
Stock Position:  -0.13892750320846947
Bond Position:  [10.36973608]


portfolio before change:  [-4.48801975]
curr_Stock_Price:  106.96477119339714
curr_Factors:  [106.96477119]
mat_Sqrt:  [[0.15]]
grads:  [0.04962135]
Stock Position:  0.0496213503953918
Bond Position:  [-9.79575614]


portfolio before change:  [-4.5411174]
curr_Stock_Price:  105.9440733568842
curr_Factors:  [105.94407336]
mat_Sqrt:  [[0.15]]
grads:  [0.25010028]
Stock Position:  0.2501002803263785
Bond Position:  [-31.03775985]


portfolio before change:  [-4.67316874]
curr_Stock_Price:  105.44710900608875
curr_Factors:  [105.44710901]
mat_Sqrt:  [[0.15]]
grads:  [0.00339614]
Stock Position:  0.0033961402016071595
Bond Position:  [-5.0312819]


portfolio before change:  [-4.6669649]
curr_Stock_Price:  107.64425539212522
curr_Factors:  [107.64425539]
mat_Sqrt:  [[0.15]]
grads:  [0.0395289]
Stock Position:  0.039528899501290245
Bond Position:  [-8.92202385]


portfolio before change:  [-4.66078658]
curr_Stock_Price:  107.85698848682762
curr_Factors:  [107.85698849]
mat_Sqrt:  [[0.15]]
grads:  [-0.03701628]
Stock Position:  -0.03701627578375844
Bond Position:  [-0.66832255]


portfolio before change:  [-4.55886253]
curr_Stock_Price:  105.09898154058877
curr_Factors:  [105.09898154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.55886253]
Stock Price:  107.55533576661514
PL:  [-12.1141983]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.46854626e-03]
 [ 6.05723321e-03]
 [ 1.40870082e-03]
 [ 3.36090648e-03]
 [ 2.44840295e-03]
 [ 4.09079012e-03]
 [-4.72316264e-03]
 [ 1.09122891e-02]
 [ 3.73912274e-03]
 [ 1.06897503e-02]
 [-1.85165261e-02]
 [-1.25761289e-04]
 [-2.50747354e-02]
 [ 8.37322025e-04]
 [-1.09129950e-02]
 [ 7.85086845e-03]
 [ 6.14792510e-03]
 [-1.74007233e-03]
 [-1.28043479e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.30325176]
curr_Stock_Price:  99.80066979625332
curr_Factors:  [99.8006698]
mat_Sqrt:  [[0.15]]
grads:  [0.00979031]
Stock Position:  0.009790308367000001
Bond Position:  [-2.28033109]


portfolio before change:  [-1.29214452]
curr_Stock_Price:  100.99342011195279
curr_Factors:  [100.99342011]
mat_Sqrt:  [[0.15]]
grads:  [0.04038155]
Stock Position:  0.04038155472513887
Bond Position:  [-5.37041584]


portfolio before change:  [-1.25421346]
curr_Stock_Price:  101.96598870544008
curr_Factors:  [101.96598871]
mat_Sqrt:  [[0.15]]
grads:  [0.00939134]
Stock Position:  0.00939133877596242
Bond Position:  [-2.21181061]


portfolio before change:  [-1.27356297]
curr_Stock_Price:  99.96451790965817
curr_Factors:  [99.96451791]
mat_Sqrt:  [[0.15]]
grads:  [0.02240604]
Stock Position:  0.022406043206033927
Bond Position:  [-3.51337228]


portfolio before change:  [-1.29917282]
curr_Stock_Price:  98.86073575980653
curr_Factors:  [98.86073576]
mat_Sqrt:  [[0.15]]
grads:  [0.01632269]
Stock Position:  0.016322686330841364
Bond Position:  [-2.9128456]


portfolio before change:  [-1.31104217]
curr_Stock_Price:  98.1781859123745
curr_Factors:  [98.17818591]
mat_Sqrt:  [[0.15]]
grads:  [0.02727193]
Stock Position:  0.027271934141442477
Bond Position:  [-3.98855119]


portfolio before change:  [-1.34328192]
curr_Stock_Price:  97.03259454865126
curr_Factors:  [97.03259455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148775]
Stock Position:  -0.03148775090270677
Bond Position:  [1.71205624]


portfolio before change:  [-1.3935354]
curr_Stock_Price:  98.6421585151503
curr_Factors:  [98.64215852]
mat_Sqrt:  [[0.15]]
grads:  [0.07274859]
Stock Position:  0.07274859385594391
Bond Position:  [-8.56961373]


portfolio before change:  [-1.36330774]
curr_Stock_Price:  99.08712022651865
curr_Factors:  [99.08712023]
mat_Sqrt:  [[0.15]]
grads:  [0.02492748]
Stock Position:  0.024927484933144204
Bond Position:  [-3.83330043]


portfolio before change:  [-1.35330795]
curr_Stock_Price:  99.52672448826418
curr_Factors:  [99.52672449]
mat_Sqrt:  [[0.15]]
grads:  [0.071265]
Stock Position:  0.07126500176466244
Bond Position:  [-8.44608015]


portfolio before change:  [-1.38876402]
curr_Stock_Price:  99.0588331077059
curr_Factors:  [99.05883311]
mat_Sqrt:  [[0.15]]
grads:  [-0.12344351]
Stock Position:  -0.12344350751347022
Bond Position:  [10.83940579]


portfolio before change:  [-1.54417911]
curr_Stock_Price:  100.33978571595514
curr_Factors:  [100.33978572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083841]
Stock Position:  -0.0008384085945557987
Bond Position:  [-1.46005337]


portfolio before change:  [-1.54522188]
curr_Stock_Price:  101.14811470971254
curr_Factors:  [101.14811471]
mat_Sqrt:  [[0.15]]
grads:  [-0.1671649]
Stock Position:  -0.16716490260703845
Bond Position:  [15.36319287]


portfolio before change:  [-1.08261269]
curr_Stock_Price:  98.40371139249572
curr_Factors:  [98.40371139]
mat_Sqrt:  [[0.15]]
grads:  [0.00558215]
Stock Position:  0.005582146833796349
Bond Position:  [-1.63191665]


portfolio before change:  [-1.07406446]
curr_Stock_Price:  100.00815872396574
curr_Factors:  [100.00815872]
mat_Sqrt:  [[0.15]]
grads:  [-0.0727533]
Stock Position:  -0.07275329993958636
Bond Position:  [6.20185911]


portfolio before change:  [-1.04153612]
curr_Stock_Price:  99.58236800773199
curr_Factors:  [99.58236801]
mat_Sqrt:  [[0.15]]
grads:  [0.05233912]
Stock Position:  0.052339123014790045
Bond Position:  [-6.25358993]


portfolio before change:  [-1.05779645]
curr_Stock_Price:  99.30156960346629
curr_Factors:  [99.3015696]
mat_Sqrt:  [[0.15]]
grads:  [0.04098617]
Stock Position:  0.04098616736253622
Bond Position:  [-5.1277872]


portfolio before change:  [-1.06594523]
curr_Stock_Price:  99.13403328133548
curr_Factors:  [99.13403328]
mat_Sqrt:  [[0.15]]
grads:  [-0.01160048]
Stock Position:  -0.011600482210208624
Bond Position:  [0.08405736]


portfolio before change:  [-1.07678622]
curr_Stock_Price:  100.07037374014196
curr_Factors:  [100.07037374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.07678622]
Stock Price:  101.33039846231782
PL:  [-2.40718468]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.43659349e-03]
 [ 6.24119986e-03]
 [ 1.79501241e-03]
 [ 1.46813871e-02]
 [ 2.42605499e-02]
 [ 6.57968044e-03]
 [ 2.94488631e-02]
 [ 9.29846550e-03]
 [ 8.82954022e-03]
 [-2.53042377e-02]
 [-6.74907170e-03]
 [-3.61766674e-02]
 [-1.94942973e-02]
 [ 5.94402007e-03]
 [ 3.23608721e-02]
 [-1.58589204e-04]
 [ 6.41104585e-03]
 [-5.33569030e-03]
 [-1.08973505e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.98852541]
curr_Stock_Price:  100.27371920291289
curr_Factors:  [100.2737192]
mat_Sqrt:  [[0.15]]
grads:  [0.03624396]
Stock Position:  0.03624395662319358
Bond Position:  [2.35420908]


portfolio before change:  [6.03859167]
curr_Stock_Price:  101.63884699001228
curr_Factors:  [101.63884699]
mat_Sqrt:  [[0.15]]
grads:  [0.041608]
Stock Position:  0.04160799905956041
Bond Position:  [1.80960262]


portfolio before change:  [6.08543559]
curr_Stock_Price:  102.75381193967424
curr_Factors:  [102.75381194]
mat_Sqrt:  [[0.15]]
grads:  [0.01196675]
Stock Position:  0.011966749404569585
Bond Position:  [4.85580647]


portfolio before change:  [6.0817268]
curr_Stock_Price:  102.34243104573326
curr_Factors:  [102.34243105]
mat_Sqrt:  [[0.15]]
grads:  [0.09787591]
Stock Position:  0.09787591427114706
Bond Position:  [-3.93513221]


portfolio before change:  [6.19612931]
curr_Stock_Price:  103.52133615731356
curr_Factors:  [103.52133616]
mat_Sqrt:  [[0.15]]
grads:  [0.161737]
Stock Position:  0.16173699904388703
Bond Position:  [-10.54710094]


portfolio before change:  [6.11193554]
curr_Stock_Price:  103.01708130517049
curr_Factors:  [103.01708131]
mat_Sqrt:  [[0.15]]
grads:  [0.04386454]
Stock Position:  0.04386453623925069
Bond Position:  [1.59313904]


portfolio before change:  [6.17250293]
curr_Stock_Price:  104.38878300216805
curr_Factors:  [104.388783]
mat_Sqrt:  [[0.15]]
grads:  [0.19632575]
Stock Position:  0.19632575432214844
Bond Position:  [-14.32170363]


portfolio before change:  [5.68670767]
curr_Stock_Price:  101.93258772226443
curr_Factors:  [101.93258772]
mat_Sqrt:  [[0.15]]
grads:  [0.06198977]
Stock Position:  0.06198976997418462
Bond Position:  [-0.63207]


portfolio before change:  [5.80867152]
curr_Stock_Price:  103.90262072033718
curr_Factors:  [103.90262072]
mat_Sqrt:  [[0.15]]
grads:  [0.0588636]
Stock Position:  0.058863601473064034
Bond Position:  [-0.30741094]


portfolio before change:  [5.9389306]
curr_Stock_Price:  106.1168232660716
curr_Factors:  [106.11682327]
mat_Sqrt:  [[0.15]]
grads:  [-0.16869492]
Stock Position:  -0.168694918291251
Bond Position:  [23.84029943]


portfolio before change:  [5.74888527]
curr_Stock_Price:  107.27872043196238
curr_Factors:  [107.27872043]
mat_Sqrt:  [[0.15]]
grads:  [-0.04499381]
Stock Position:  -0.04499381135368921
Bond Position:  [10.57576378]


portfolio before change:  [5.73595427]
curr_Stock_Price:  107.6248852331798
curr_Factors:  [107.62488523]
mat_Sqrt:  [[0.15]]
grads:  [-0.24117778]
Stock Position:  -0.2411777826960665
Bond Position:  [31.69268545]


portfolio before change:  [6.18551947]
curr_Stock_Price:  105.793700652659
curr_Factors:  [105.79370065]
mat_Sqrt:  [[0.15]]
grads:  [-0.12996198]
Stock Position:  -0.12996198224647054
Bond Position:  [19.93467851]


portfolio before change:  [6.19602405]
curr_Stock_Price:  105.75122441457438
curr_Factors:  [105.75122441]
mat_Sqrt:  [[0.15]]
grads:  [0.0396268]
Stock Position:  0.039626800492835505
Bond Position:  [2.00544138]


portfolio before change:  [6.17551728]
curr_Stock_Price:  105.22107330738095
curr_Factors:  [105.22107331]
mat_Sqrt:  [[0.15]]
grads:  [0.21573915]
Stock Position:  0.21573914721970247
Bond Position:  [-16.52478734]


portfolio before change:  [6.39509318]
curr_Stock_Price:  106.2580089441935
curr_Factors:  [106.25800894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105726]
Stock Position:  -0.0010572613569631978
Bond Position:  [6.50743567]


portfolio before change:  [6.39679677]
curr_Stock_Price:  106.18563192561955
curr_Factors:  [106.18563193]
mat_Sqrt:  [[0.15]]
grads:  [0.04274031]
Stock Position:  0.042740305648780855
Bond Position:  [1.8583904]


portfolio before change:  [6.34822392]
curr_Stock_Price:  105.03829568281809
curr_Factors:  [105.03829568]
mat_Sqrt:  [[0.15]]
grads:  [-0.03557127]
Stock Position:  -0.03557126869689986
Bond Position:  [10.08456936]


portfolio before change:  [6.3723197]
curr_Stock_Price:  104.43178574051979
curr_Factors:  [104.43178574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.3723197]
Stock Price:  105.9686681191185
PL:  [0.40365159]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.45691628e-03]
 [ 9.99033550e-03]
 [ 1.01655619e-03]
 [ 2.62989905e-03]
 [ 2.29380025e-03]
 [ 3.40430991e-03]
 [ 1.70002750e-03]
 [ 6.05896256e-03]
 [ 4.57087858e-03]
 [ 2.03077145e-04]
 [-1.49186611e-02]
 [-7.76774353e-03]
 [-2.10843529e-02]
 [ 4.29450677e-03]
 [ 2.53487990e-02]
 [ 5.27470480e-04]
 [ 6.74822581e-03]
 [-5.27913462e-03]
 [-1.04622458e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.01808042]
curr_Stock_Price:  100.27563656491307
curr_Factors:  [100.27563656]
mat_Sqrt:  [[0.15]]
grads:  [0.03637944]
Stock Position:  0.03637944187254064
Bond Position:  [2.37010872]


portfolio before change:  [5.99028559]
curr_Stock_Price:  99.49532136276224
curr_Factors:  [99.49532136]
mat_Sqrt:  [[0.15]]
grads:  [0.06660224]
Stock Position:  0.0666022366660211
Bond Position:  [-0.63632536]


portfolio before change:  [5.9739366]
curr_Stock_Price:  99.25223813716275
curr_Factors:  [99.25223814]
mat_Sqrt:  [[0.15]]
grads:  [0.00677704]
Stock Position:  0.006777041241327773
Bond Position:  [5.30130009]


portfolio before change:  [5.97294995]
curr_Stock_Price:  98.91106653169936
curr_Factors:  [98.91106653]
mat_Sqrt:  [[0.15]]
grads:  [0.01753266]
Stock Position:  0.0175326603387803
Bond Position:  [4.23877582]


portfolio before change:  [5.97215024]
curr_Stock_Price:  98.80500511641281
curr_Factors:  [98.80500512]
mat_Sqrt:  [[0.15]]
grads:  [0.015292]
Stock Position:  0.015292001671861634
Bond Position:  [4.46122394]


portfolio before change:  [5.98739038]
curr_Stock_Price:  99.72867073487645
curr_Factors:  [99.72867073]
mat_Sqrt:  [[0.15]]
grads:  [0.0226954]
Stock Position:  0.022695399380576835
Bond Position:  [3.72400837]


portfolio before change:  [6.00182338]
curr_Stock_Price:  100.32358769393903
curr_Factors:  [100.32358769]
mat_Sqrt:  [[0.15]]
grads:  [0.01133352]
Stock Position:  0.011333516656121118
Bond Position:  [4.86480433]


portfolio before change:  [6.02777759]
curr_Stock_Price:  102.506304076869
curr_Factors:  [102.50630408]
mat_Sqrt:  [[0.15]]
grads:  [0.04039308]
Stock Position:  0.040393083747058696
Bond Position:  [1.88723186]


portfolio before change:  [5.9931872]
curr_Stock_Price:  101.6382780241562
curr_Factors:  [101.63827802]
mat_Sqrt:  [[0.15]]
grads:  [0.03047252]
Stock Position:  0.030472523833458266
Bond Position:  [2.89601235]


portfolio before change:  [6.03092339]
curr_Stock_Price:  102.85288344403348
curr_Factors:  [102.85288344]
mat_Sqrt:  [[0.15]]
grads:  [0.00135385]
Stock Position:  0.0013538476309989229
Bond Position:  [5.89167626]


portfolio before change:  [6.03127407]
curr_Stock_Price:  102.02382256775866
curr_Factors:  [102.02382257]
mat_Sqrt:  [[0.15]]
grads:  [-0.09945774]
Stock Position:  -0.09945774052537093
Bond Position:  [16.17833294]


portfolio before change:  [6.0320382]
curr_Stock_Price:  102.05681109232584
curr_Factors:  [102.05681109]
mat_Sqrt:  [[0.15]]
grads:  [-0.05178496]
Stock Position:  -0.05178495689974378
Bond Position:  [11.31704576]


portfolio before change:  [5.95501519]
curr_Stock_Price:  103.5988152017266
curr_Factors:  [103.5988152]
mat_Sqrt:  [[0.15]]
grads:  [-0.14056235]
Stock Position:  -0.14056235235981787
Bond Position:  [20.51710836]


portfolio before change:  [5.86156279]
curr_Stock_Price:  104.30015752741211
curr_Factors:  [104.30015753]
mat_Sqrt:  [[0.15]]
grads:  [0.02863005]
Stock Position:  0.028630045112462404
Bond Position:  [2.87544457]


portfolio before change:  [5.86044545]
curr_Stock_Price:  104.23601895189955
curr_Factors:  [104.23601895]
mat_Sqrt:  [[0.15]]
grads:  [0.16899199]
Stock Position:  0.16899199301023693
Bond Position:  [-11.75460714]


portfolio before change:  [6.05846829]
curr_Stock_Price:  105.42519871693277
curr_Factors:  [105.42519872]
mat_Sqrt:  [[0.15]]
grads:  [0.00351647]
Stock Position:  0.003516469864110339
Bond Position:  [5.68774375]


portfolio before change:  [6.05897418]
curr_Stock_Price:  105.1646490395175
curr_Factors:  [105.16464904]
mat_Sqrt:  [[0.15]]
grads:  [0.04498817]
Stock Position:  0.04498817207366819
Bond Position:  [1.32780886]


portfolio before change:  [6.03621886]
curr_Stock_Price:  104.65146254911838
curr_Factors:  [104.65146255]
mat_Sqrt:  [[0.15]]
grads:  [-0.03519423]
Stock Position:  -0.03519423082026157
Bond Position:  [9.71934658]


portfolio before change:  [6.00595927]
curr_Stock_Price:  105.5803002881224
curr_Factors:  [105.58030029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.00595927]
Stock Price:  105.45020225828677
PL:  [0.55575701]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.25248285e-02]
 [ 6.67597389e-03]
 [ 1.58029056e-03]
 [ 1.50709553e-02]
 [ 2.39254261e-02]
 [ 6.97363355e-03]
 [ 3.19153489e-02]
 [ 1.29040831e-03]
 [ 8.53198134e-03]
 [-4.82220060e-03]
 [-1.17846032e-02]
 [-9.67943733e-03]
 [-2.24328469e-02]
 [ 3.38126534e-03]
 [ 1.83033638e-02]
 [ 5.83532739e-03]
 [ 7.48931060e-03]
 [-2.86407148e-03]
 [-1.28623430e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.48471066]
curr_Stock_Price:  101.21415000135924
curr_Factors:  [101.21415]
mat_Sqrt:  [[0.15]]
grads:  [0.08349886]
Stock Position:  0.08349885648312752
Bond Position:  [12.03344488]


portfolio before change:  [20.57360598]
curr_Stock_Price:  102.24274586749686
curr_Factors:  [102.24274587]
mat_Sqrt:  [[0.15]]
grads:  [0.04450649]
Stock Position:  0.0445064925772077
Bond Position:  [16.02313997]


portfolio before change:  [20.58265205]
curr_Stock_Price:  102.35598305199937
curr_Factors:  [102.35598305]
mat_Sqrt:  [[0.15]]
grads:  [0.01053527]
Stock Position:  0.01053527040705617
Bond Position:  [19.50430409]


portfolio before change:  [20.59053241]
curr_Stock_Price:  102.64108907121893
curr_Factors:  [102.64108907]
mat_Sqrt:  [[0.15]]
grads:  [0.10047304]
Stock Position:  0.10047303540928933
Bond Position:  [10.27787063]


portfolio before change:  [20.70739741]
curr_Stock_Price:  103.77866005459882
curr_Factors:  [103.77866005]
mat_Sqrt:  [[0.15]]
grads:  [0.15950284]
Stock Position:  0.1595028409016051
Bond Position:  [4.1544063]


portfolio before change:  [20.4125401]
curr_Stock_Price:  101.92354554217803
curr_Factors:  [101.92354554]
mat_Sqrt:  [[0.15]]
grads:  [0.04649089]
Stock Position:  0.046490890313445776
Bond Position:  [15.67402373]


portfolio before change:  [20.49906489]
curr_Stock_Price:  103.70036233302315
curr_Factors:  [103.70036233]
mat_Sqrt:  [[0.15]]
grads:  [0.21276899]
Stock Position:  0.2127689928422195
Bond Position:  [-1.56515676]


portfolio before change:  [20.46106244]
curr_Stock_Price:  103.52359261582914
curr_Factors:  [103.52359262]
mat_Sqrt:  [[0.15]]
grads:  [0.00860272]
Stock Position:  0.008602722056651966
Bond Position:  [19.57047775]


portfolio before change:  [20.46155972]
curr_Stock_Price:  103.01259702446336
curr_Factors:  [103.01259702]
mat_Sqrt:  [[0.15]]
grads:  [0.05687988]
Stock Position:  0.0568798756066644
Bond Position:  [14.60221601]


portfolio before change:  [20.49468967]
curr_Stock_Price:  103.53086369977181
curr_Factors:  [103.5308637]
mat_Sqrt:  [[0.15]]
grads:  [-0.032148]
Stock Position:  -0.032148003992051255
Bond Position:  [23.82300029]


portfolio before change:  [20.48552406]
curr_Stock_Price:  104.00125380155053
curr_Factors:  [104.0012538]
mat_Sqrt:  [[0.15]]
grads:  [-0.07856402]
Stock Position:  -0.07856402126302904
Bond Position:  [28.65628078]


portfolio before change:  [20.57040205]
curr_Stock_Price:  103.01208580022949
curr_Factors:  [103.0120858]
mat_Sqrt:  [[0.15]]
grads:  [-0.06452958]
Stock Position:  -0.06452958222762242
Bond Position:  [27.21772891]


portfolio before change:  [20.62023259]
curr_Stock_Price:  102.34533326751485
curr_Factors:  [102.34533327]
mat_Sqrt:  [[0.15]]
grads:  [-0.14955231]
Stock Position:  -0.14955231233711244
Bond Position:  [35.92621384]


portfolio before change:  [20.49349315]
curr_Stock_Price:  103.2528559612958
curr_Factors:  [103.25285596]
mat_Sqrt:  [[0.15]]
grads:  [0.02254177]
Stock Position:  0.022541768950696338
Bond Position:  [18.16599113]


portfolio before change:  [20.49788693]
curr_Stock_Price:  103.246277909705
curr_Factors:  [103.24627791]
mat_Sqrt:  [[0.15]]
grads:  [0.12202243]
Stock Position:  0.12202242542297813
Bond Position:  [7.89952569]


portfolio before change:  [20.29336664]
curr_Stock_Price:  101.55400351042107
curr_Factors:  [101.55400351]
mat_Sqrt:  [[0.15]]
grads:  [0.03890218]
Stock Position:  0.03890218256671278
Bond Position:  [16.34269425]


portfolio before change:  [20.27794242]
curr_Stock_Price:  101.05247893477129
curr_Factors:  [101.05247893]
mat_Sqrt:  [[0.15]]
grads:  [0.04992874]
Stock Position:  0.04992873735933463
Bond Position:  [15.23251974]


portfolio before change:  [20.27621837]
curr_Stock_Price:  100.94166778763983
curr_Factors:  [100.94166779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01909381]
Stock Position:  -0.01909380988540087
Bond Position:  [22.20357938]


portfolio before change:  [20.30235011]
curr_Stock_Price:  99.86382343604197
curr_Factors:  [99.86382344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.30235011]
Stock Price:  99.99653263463959
PL:  [20.30235011]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.92756629e-03]
 [ 9.83644563e-03]
 [-4.03229329e-04]
 [ 9.06477334e-04]
 [ 1.69435336e-02]
 [ 6.41568740e-03]
 [ 3.37861112e-02]
 [ 7.38992432e-03]
 [ 4.09874775e-03]
 [ 9.36550866e-03]
 [-1.32566013e-02]
 [-1.18103078e-02]
 [-2.11097325e-02]
 [ 4.40653959e-03]
 [ 7.69874274e-03]
 [ 2.40452334e-03]
 [ 7.24930683e-03]
 [-5.21546479e-03]
 [-1.07444847e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.18795997]
curr_Stock_Price:  100.41640612117875
curr_Factors:  [100.41640612]
mat_Sqrt:  [[0.15]]
grads:  [0.03951711]
Stock Position:  0.03951710857069795
Bond Position:  [4.21979395]


portfolio before change:  [8.15096843]
curr_Stock_Price:  99.45361743607502
curr_Factors:  [99.45361744]
mat_Sqrt:  [[0.15]]
grads:  [0.0655763]
Stock Position:  0.06557630417424339
Bond Position:  [1.62916776]


portfolio before change:  [8.10248764]
curr_Stock_Price:  98.7081022886503
curr_Factors:  [98.70810229]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026882]
Stock Position:  -0.002688195524209826
Bond Position:  [8.36783432]


portfolio before change:  [8.10668435]
curr_Stock_Price:  97.92523985591806
curr_Factors:  [97.92523986]
mat_Sqrt:  [[0.15]]
grads:  [0.00604318]
Stock Position:  0.006043182223788394
Bond Position:  [7.51490428]


portfolio before change:  [8.12618333]
curr_Stock_Price:  100.84092465242516
curr_Factors:  [100.84092465]
mat_Sqrt:  [[0.15]]
grads:  [0.11295689]
Stock Position:  0.11295689080176075
Bond Position:  [-3.26449399]


portfolio before change:  [8.18056912]
curr_Stock_Price:  101.32962457696036
curr_Factors:  [101.32962458]
mat_Sqrt:  [[0.15]]
grads:  [0.04277125]
Stock Position:  0.042771249352006255
Bond Position:  [3.84657449]


portfolio before change:  [8.21659796]
curr_Stock_Price:  102.1494994971053
curr_Factors:  [102.1494995]
mat_Sqrt:  [[0.15]]
grads:  [0.22524074]
Stock Position:  0.22524074142296915
Bond Position:  [-14.79163104]


portfolio before change:  [8.2341129]
curr_Stock_Price:  102.24368007337931
curr_Factors:  [102.24368007]
mat_Sqrt:  [[0.15]]
grads:  [0.04926616]
Stock Position:  0.04926616213047602
Bond Position:  [3.19695918]


portfolio before change:  [8.16531657]
curr_Stock_Price:  100.8310335906812
curr_Factors:  [100.83103359]
mat_Sqrt:  [[0.15]]
grads:  [0.02732499]
Stock Position:  0.027324985019515757
Bond Position:  [5.41011008]


portfolio before change:  [8.18642399]
curr_Stock_Price:  101.55398823241474
curr_Factors:  [101.55398823]
mat_Sqrt:  [[0.15]]
grads:  [0.06243672]
Stock Position:  0.06243672437385803
Bond Position:  [1.84572561]


portfolio before change:  [8.28316108]
curr_Stock_Price:  103.0959589676312
curr_Factors:  [103.09595897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08837734]
Stock Position:  -0.08837734188015693
Bond Position:  [17.39450789]


portfolio before change:  [8.26019982]
curr_Stock_Price:  103.4049796641963
curr_Factors:  [103.40497966]
mat_Sqrt:  [[0.15]]
grads:  [-0.07873539]
Stock Position:  -0.07873538541642652
Bond Position:  [16.40183075]


portfolio before change:  [8.25154129]
curr_Stock_Price:  103.56703516233523
curr_Factors:  [103.56703516]
mat_Sqrt:  [[0.15]]
grads:  [-0.14073155]
Stock Position:  -0.14073154970045418
Bond Position:  [22.82669064]


portfolio before change:  [8.13599421]
curr_Stock_Price:  104.42863631110697
curr_Factors:  [104.42863631]
mat_Sqrt:  [[0.15]]
grads:  [0.02937693]
Stock Position:  0.029376930576372074
Bond Position:  [5.06820141]


portfolio before change:  [8.07368047]
curr_Stock_Price:  102.2643207801376
curr_Factors:  [102.26432078]
mat_Sqrt:  [[0.15]]
grads:  [0.05132495]
Stock Position:  0.051324951616511585
Bond Position:  [2.82496916]


portfolio before change:  [8.1174394]
curr_Stock_Price:  103.10314467536438
curr_Factors:  [103.10314468]
mat_Sqrt:  [[0.15]]
grads:  [0.01603016]
Stock Position:  0.01603015560378
Bond Position:  [6.46467995]


portfolio before change:  [8.12777983]
curr_Stock_Price:  103.64737279285006
curr_Factors:  [103.64737279]
mat_Sqrt:  [[0.15]]
grads:  [0.04832871]
Stock Position:  0.048328712232165845
Bond Position:  [3.11863578]


portfolio before change:  [8.15603914]
curr_Stock_Price:  104.21596958133276
curr_Factors:  [104.21596958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03476977]
Stock Position:  -0.03476976525730838
Bond Position:  [11.77960394]


portfolio before change:  [8.13745062]
curr_Stock_Price:  104.8352945980608
curr_Factors:  [104.8352946]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.13745062]
Stock Price:  105.11544060473089
PL:  [3.02201002]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.83599424e-02]
 [-1.48125542e-03]
 [-1.27123335e-03]
 [ 1.64360786e-03]
 [-9.78806596e-04]
 [-3.59873994e-03]
 [-3.93847623e-03]
 [ 8.83386183e-03]
 [ 4.65518101e-03]
 [-2.16489365e-03]
 [-1.81589899e-02]
 [ 5.90043921e-03]
 [-2.59401562e-02]
 [ 3.76640899e-03]
 [-1.08715661e-02]
 [ 7.77458565e-03]
 [ 7.43980158e-03]
 [-1.94325628e-03]
 [-1.27830841e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.25898581]
curr_Stock_Price:  98.37630551389641
curr_Factors:  [98.37630551]
mat_Sqrt:  [[0.15]]
grads:  [0.18906628]
Stock Position:  0.1890662826895365
Bond Position:  [-41.85862819]


portfolio before change:  [-23.51112216]
curr_Stock_Price:  97.09807451629166
curr_Factors:  [97.09807452]
mat_Sqrt:  [[0.15]]
grads:  [-0.00987504]
Stock Position:  -0.009875036149229431
Bond Position:  [-22.55227516]


portfolio before change:  [-23.52881958]
curr_Stock_Price:  98.31919946771781
curr_Factors:  [98.31919947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847489]
Stock Position:  -0.008474889023711782
Bond Position:  [-22.69557528]


portfolio before change:  [-23.53472887]
curr_Stock_Price:  98.34689111184393
curr_Factors:  [98.34689111]
mat_Sqrt:  [[0.15]]
grads:  [0.01095739]
Stock Position:  0.010957385700053624
Bond Position:  [-24.61235369]


portfolio before change:  [-23.55151766]
curr_Stock_Price:  97.37631861510997
curr_Factors:  [97.37631862]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652538]
Stock Position:  -0.006525377307291218
Bond Position:  [-22.91610044]


portfolio before change:  [-23.54267654]
curr_Stock_Price:  95.14336479317716
curr_Factors:  [95.14336479]
mat_Sqrt:  [[0.15]]
grads:  [-0.0239916]
Stock Position:  -0.023991599624404714
Bond Position:  [-21.26003502]


portfolio before change:  [-23.58603074]
curr_Stock_Price:  96.72885840540356
curr_Factors:  [96.72885841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625651]
Stock Position:  -0.02625650821147819
Bond Position:  [-21.04626867]


portfolio before change:  [-23.61733691]
curr_Stock_Price:  97.72076286361461
curr_Factors:  [97.72076286]
mat_Sqrt:  [[0.15]]
grads:  [0.05889241]
Stock Position:  0.058892412187795354
Bond Position:  [-29.37234836]


portfolio before change:  [-23.67353594]
curr_Stock_Price:  96.8911988884855
curr_Factors:  [96.89119889]
mat_Sqrt:  [[0.15]]
grads:  [0.03103454]
Stock Position:  0.03103454004092279
Bond Position:  [-26.68050973]


portfolio before change:  [-23.682264]
curr_Stock_Price:  96.82491472795844
curr_Factors:  [96.82491473]
mat_Sqrt:  [[0.15]]
grads:  [-0.01443262]
Stock Position:  -0.014432624356769895
Bond Position:  [-22.28482638]


portfolio before change:  [-23.70309061]
curr_Stock_Price:  97.88187479864403
curr_Factors:  [97.8818748]
mat_Sqrt:  [[0.15]]
grads:  [-0.12105993]
Stock Position:  -0.12105993247095075
Bond Position:  [-11.85351746]


portfolio before change:  [-23.80120809]
curr_Stock_Price:  98.66787994812151
curr_Factors:  [98.66787995]
mat_Sqrt:  [[0.15]]
grads:  [0.03933626]
Stock Position:  0.03933626140388373
Bond Position:  [-27.68243361]


portfolio before change:  [-23.72145633]
curr_Stock_Price:  100.87127266206292
curr_Factors:  [100.87127266]
mat_Sqrt:  [[0.15]]
grads:  [-0.17293437]
Stock Position:  -0.17293437447655935
Bond Position:  [-6.27734589]


portfolio before change:  [-23.49944861]
curr_Stock_Price:  99.578428162777
curr_Factors:  [99.57842816]
mat_Sqrt:  [[0.15]]
grads:  [0.02510939]
Stock Position:  0.025109393299410487
Bond Position:  [-25.99980253]


portfolio before change:  [-23.4949138]
curr_Stock_Price:  100.01792791453788
curr_Factors:  [100.01792791]
mat_Sqrt:  [[0.15]]
grads:  [-0.07247711]
Stock Position:  -0.07247710719619226
Bond Position:  [-16.24590372]


portfolio before change:  [-23.49661148]
curr_Stock_Price:  99.98530645667662
curr_Factors:  [99.98530646]
mat_Sqrt:  [[0.15]]
grads:  [0.05183057]
Stock Position:  0.051830570987004415
Bond Position:  [-28.678907]


portfolio before change:  [-23.51180076]
curr_Stock_Price:  99.83059740079973
curr_Factors:  [99.8305974]
mat_Sqrt:  [[0.15]]
grads:  [0.04959868]
Stock Position:  0.04959867719762901
Bond Position:  [-28.46326633]


portfolio before change:  [-23.61070611]
curr_Stock_Price:  97.97997058400853
curr_Factors:  [97.97997058]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295504]
Stock Position:  -0.01295504189753445
Bond Position:  [-22.34137148]


portfolio before change:  [-23.62786645]
curr_Stock_Price:  98.87339143169858
curr_Factors:  [98.87339143]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.62786645]
Stock Price:  98.83608745330788
PL:  [-23.62786645]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.96182774e-03]
 [ 1.03895136e-02]
 [ 5.23367316e-04]
 [ 2.64277283e-03]
 [ 4.33662536e-04]
 [ 2.40495954e-03]
 [-5.33053700e-03]
 [ 7.75919176e-03]
 [ 4.67026270e-03]
 [ 1.15513689e-02]
 [-1.63854504e-02]
 [ 3.17105911e-03]
 [-2.30747190e-02]
 [ 1.97712748e-03]
 [-3.40850281e-03]
 [ 7.90477518e-03]
 [ 7.51847141e-03]
 [-2.56089165e-03]
 [-1.24745454e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.68452584]
curr_Stock_Price:  100.6432436076786
curr_Factors:  [100.64324361]
mat_Sqrt:  [[0.15]]
grads:  [0.03974552]
Stock Position:  0.039745518260279285
Bond Position:  [7.68440796]


portfolio before change:  [11.65055887]
curr_Stock_Price:  99.74029122440783
curr_Factors:  [99.74029122]
mat_Sqrt:  [[0.15]]
grads:  [0.06926342]
Stock Position:  0.06926342404835494
Bond Position:  [4.74220478]


portfolio before change:  [11.60364569]
curr_Stock_Price:  99.0458572905837
curr_Factors:  [99.04585729]
mat_Sqrt:  [[0.15]]
grads:  [0.00348912]
Stock Position:  0.003489115441878334
Bond Position:  [11.25806326]


portfolio before change:  [11.60601484]
curr_Stock_Price:  98.91810986471249
curr_Factors:  [98.91810986]
mat_Sqrt:  [[0.15]]
grads:  [0.01761849]
Stock Position:  0.017618485552602904
Bond Position:  [9.86322755]


portfolio before change:  [11.59350685]
curr_Stock_Price:  98.06820103515159
curr_Factors:  [98.06820104]
mat_Sqrt:  [[0.15]]
grads:  [0.00289108]
Stock Position:  0.002891083572253983
Bond Position:  [11.30998348]


portfolio before change:  [11.59432578]
curr_Stock_Price:  97.37333522910683
curr_Factors:  [97.37333523]
mat_Sqrt:  [[0.15]]
grads:  [0.01603306]
Stock Position:  0.016033063572898406
Bond Position:  [10.03313291]


portfolio before change:  [11.59514067]
curr_Stock_Price:  97.26769680749528
curr_Factors:  [97.26769681]
mat_Sqrt:  [[0.15]]
grads:  [-0.03553691]
Stock Position:  -0.03553691331096616
Bond Position:  [15.05173438]


portfolio before change:  [11.59714504]
curr_Stock_Price:  97.31719557084621
curr_Factors:  [97.31719557]
mat_Sqrt:  [[0.15]]
grads:  [0.05172795]
Stock Position:  0.05172794504024357
Bond Position:  [6.5631265]


portfolio before change:  [11.58854717]
curr_Stock_Price:  97.11925898948137
curr_Factors:  [97.11925899]
mat_Sqrt:  [[0.15]]
grads:  [0.03113508]
Stock Position:  0.03113508465012739
Bond Position:  [8.56473082]


portfolio before change:  [11.65953791]
curr_Stock_Price:  99.3305678871242
curr_Factors:  [99.33056789]
mat_Sqrt:  [[0.15]]
grads:  [0.07700913]
Stock Position:  0.07700912612669711
Bond Position:  [4.01017768]


portfolio before change:  [11.78148312]
curr_Stock_Price:  100.90106407305679
curr_Factors:  [100.90106407]
mat_Sqrt:  [[0.15]]
grads:  [-0.10923634]
Stock Position:  -0.10923633602575587
Bond Position:  [22.80354566]


portfolio before change:  [11.89026277]
curr_Stock_Price:  99.95743993283709
curr_Factors:  [99.95743993]
mat_Sqrt:  [[0.15]]
grads:  [0.02114039]
Stock Position:  0.021140394041014206
Bond Position:  [9.7771231]


portfolio before change:  [11.936192]
curr_Stock_Price:  102.01438598813083
curr_Factors:  [102.01438599]
mat_Sqrt:  [[0.15]]
grads:  [-0.15383146]
Stock Position:  -0.15383145987701072
Bond Position:  [27.62921393]


portfolio before change:  [12.05485102]
curr_Stock_Price:  101.28793604071672
curr_Factors:  [101.28793604]
mat_Sqrt:  [[0.15]]
grads:  [0.01318085]
Stock Position:  0.013180849876199205
Bond Position:  [10.71978995]


portfolio before change:  [12.05198679]
curr_Stock_Price:  100.86728647801363
curr_Factors:  [100.86728648]
mat_Sqrt:  [[0.15]]
grads:  [-0.02272335]
Stock Position:  -0.022723352090517474
Bond Position:  [14.34402965]


portfolio before change:  [12.09101512]
curr_Stock_Price:  99.30757489636197
curr_Factors:  [99.3075749]
mat_Sqrt:  [[0.15]]
grads:  [0.0526985]
Stock Position:  0.052698501176555515
Bond Position:  [6.85765477]


portfolio before change:  [12.14299776]
curr_Stock_Price:  100.26145423513411
curr_Factors:  [100.26145424]
mat_Sqrt:  [[0.15]]
grads:  [0.05012314]
Stock Position:  0.050123142757552135
Bond Position:  [7.11757858]


portfolio before change:  [12.16066284]
curr_Stock_Price:  100.57838293077394
curr_Factors:  [100.57838293]
mat_Sqrt:  [[0.15]]
grads:  [-0.01707261]
Stock Position:  -0.0170726110142739
Bond Position:  [13.87779845]


portfolio before change:  [12.15830995]
curr_Stock_Price:  100.91944208103475
curr_Factors:  [100.91944208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.15830995]
Stock Price:  102.0945949185026
PL:  [10.06371503]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.28839268e-03]
 [-8.57196719e-04]
 [-3.79232373e-03]
 [ 1.20974662e-03]
 [-3.94800752e-03]
 [-6.25396561e-04]
 [-4.22259630e-03]
 [ 5.74746573e-03]
 [ 4.63527085e-03]
 [-7.54108796e-03]
 [-1.76208383e-02]
 [ 7.31998913e-03]
 [ 1.85924027e-02]
 [-4.70079852e-03]
 [-1.60587092e-02]
 [ 6.50686818e-03]
 [ 2.94561476e-03]
 [-2.94670900e-03]
 [-1.19306761e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.68224556]
curr_Stock_Price:  99.7760828143849
curr_Factors:  [99.77608281]
mat_Sqrt:  [[0.15]]
grads:  [0.00858928]
Stock Position:  0.008589284506617218
Bond Position:  [-2.53925073]


portfolio before change:  [-1.70456324]
curr_Stock_Price:  97.25168361622362
curr_Factors:  [97.25168362]
mat_Sqrt:  [[0.15]]
grads:  [-0.00571464]
Stock Position:  -0.005714644792920998
Bond Position:  [-1.14880441]


portfolio before change:  [-1.70184291]
curr_Stock_Price:  96.72539264713147
curr_Factors:  [96.72539265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02528216]
Stock Position:  -0.025282158193171284
Bond Position:  [0.74358377]


portfolio before change:  [-1.73637755]
curr_Stock_Price:  98.09871507097735
curr_Factors:  [98.09871507]
mat_Sqrt:  [[0.15]]
grads:  [0.00806498]
Stock Position:  0.008064977470237308
Bond Position:  [-2.52754147]


portfolio before change:  [-1.74950027]
curr_Stock_Price:  96.54994903786252
curr_Factors:  [96.54994904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02632005]
Stock Position:  -0.02632005014263726
Bond Position:  [0.79169923]


portfolio before change:  [-1.74134874]
curr_Stock_Price:  96.24776181745993
curr_Factors:  [96.24776182]
mat_Sqrt:  [[0.15]]
grads:  [-0.00416931]
Stock Position:  -0.004169310404416061
Bond Position:  [-1.34006195]


portfolio before change:  [-1.74414817]
curr_Stock_Price:  96.83883550552216
curr_Factors:  [96.83883551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02815064]
Stock Position:  -0.028150642031201656
Bond Position:  [0.98192723]


portfolio before change:  [-1.74027654]
curr_Stock_Price:  96.71002448289637
curr_Factors:  [96.71002448]
mat_Sqrt:  [[0.15]]
grads:  [0.03831644]
Stock Position:  0.03831643823293927
Bond Position:  [-5.44586022]


portfolio before change:  [-1.74623232]
curr_Stock_Price:  96.59012445191061
curr_Factors:  [96.59012445]
mat_Sqrt:  [[0.15]]
grads:  [0.03090181]
Stock Position:  0.030901805680836385
Bond Position:  [-4.73104158]


portfolio before change:  [-1.76146702]
curr_Stock_Price:  96.13540038728632
curr_Factors:  [96.13540039]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027392]
Stock Position:  -0.05027391971041687
Bond Position:  [3.07163638]


portfolio before change:  [-1.75079665]
curr_Stock_Price:  95.93843212051176
curr_Factors:  [95.93843212]
mat_Sqrt:  [[0.15]]
grads:  [-0.11747226]
Stock Position:  -0.1174722553982531
Bond Position:  [9.51930735]


portfolio before change:  [-1.72478022]
curr_Stock_Price:  95.73722457841502
curr_Factors:  [95.73722458]
mat_Sqrt:  [[0.15]]
grads:  [0.04879993]
Stock Position:  0.04879992753552195
Bond Position:  [-6.39674984]


portfolio before change:  [-1.78249755]
curr_Stock_Price:  94.58726514824816
curr_Factors:  [94.58726515]
mat_Sqrt:  [[0.15]]
grads:  [0.12394935]
Stock Position:  0.12394935104496428
Bond Position:  [-13.50652768]


portfolio before change:  [-1.90545628]
curr_Stock_Price:  93.62250270980354
curr_Factors:  [93.62250271]
mat_Sqrt:  [[0.15]]
grads:  [-0.03133866]
Stock Position:  -0.031338656828252376
Bond Position:  [1.0285472]


portfolio before change:  [-1.91631677]
curr_Stock_Price:  93.9772614817399
curr_Factors:  [93.97726148]
mat_Sqrt:  [[0.15]]
grads:  [-0.10705806]
Stock Position:  -0.10705806160065888
Bond Position:  [8.14470668]


portfolio before change:  [-2.0384253]
curr_Stock_Price:  95.13686549084969
curr_Factors:  [95.13686549]
mat_Sqrt:  [[0.15]]
grads:  [0.04337912]
Stock Position:  0.04337912120833046
Bond Position:  [-6.16537892]


portfolio before change:  [-2.04296467]
curr_Stock_Price:  95.06775778133138
curr_Factors:  [95.06775778]
mat_Sqrt:  [[0.15]]
grads:  [0.01963743]
Stock Position:  0.01963743171464029
Bond Position:  [-3.90985127]


portfolio before change:  [-2.02436902]
curr_Stock_Price:  96.06448871865014
curr_Factors:  [96.06448872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01964473]
Stock Position:  -0.019644726647753023
Bond Position:  [-0.1372084]


portfolio before change:  [-1.99759353]
curr_Stock_Price:  94.69975644578544
curr_Factors:  [94.69975645]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.99759353]
Stock Price:  95.8207349348167
PL:  [-1.99759353]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.45729261e-03]
 [ 6.17319773e-03]
 [ 1.51185097e-03]
 [ 1.11538492e-02]
 [ 2.36527702e-02]
 [ 4.60389182e-03]
 [ 2.40133829e-02]
 [ 1.29281685e-02]
 [ 3.55278608e-03]
 [ 8.85344204e-03]
 [-1.42491289e-02]
 [-4.07239896e-03]
 [-2.60216385e-02]
 [ 2.31686700e-03]
 [-3.81787748e-03]
 [ 7.03565888e-03]
 [ 7.48140766e-03]
 [-2.92033211e-03]
 [-1.27847970e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.77293813]
curr_Stock_Price:  100.90847675527385
curr_Factors:  [100.90847676]
mat_Sqrt:  [[0.15]]
grads:  [0.05638195]
Stock Position:  0.0563819507024569
Bond Position:  [10.08352137]


portfolio before change:  [15.81131349]
curr_Stock_Price:  101.54439239092993
curr_Factors:  [101.54439239]
mat_Sqrt:  [[0.15]]
grads:  [0.04115465]
Stock Position:  0.041154651564872725
Bond Position:  [11.63228941]


portfolio before change:  [15.83798454]
curr_Stock_Price:  102.12179023729504
curr_Factors:  [102.12179024]
mat_Sqrt:  [[0.15]]
grads:  [0.01007901]
Stock Position:  0.01007900649178472
Bond Position:  [14.80869835]


portfolio before change:  [15.82970025]
curr_Stock_Price:  100.93249383024018
curr_Factors:  [100.93249383]
mat_Sqrt:  [[0.15]]
grads:  [0.07435899]
Stock Position:  0.07435899472042826
Bond Position:  [8.32446147]


portfolio before change:  [15.88640914]
curr_Stock_Price:  101.66713958242946
curr_Factors:  [101.66713958]
mat_Sqrt:  [[0.15]]
grads:  [0.15768513]
Stock Position:  0.15768513498899633
Bond Position:  [-0.14498749]


portfolio before change:  [15.76587526]
curr_Stock_Price:  100.90297351459348
curr_Factors:  [100.90297351]
mat_Sqrt:  [[0.15]]
grads:  [0.03069261]
Stock Position:  0.03069261216623974
Bond Position:  [12.66889943]


portfolio before change:  [15.77499475]
curr_Stock_Price:  101.09689213069313
curr_Factors:  [101.09689213]
mat_Sqrt:  [[0.15]]
grads:  [0.16008922]
Stock Position:  0.16008921913770394
Bond Position:  [-0.40952777]


portfolio before change:  [15.6451358]
curr_Stock_Price:  100.28636563616097
curr_Factors:  [100.28636564]
mat_Sqrt:  [[0.15]]
grads:  [0.08618779]
Stock Position:  0.0861877897041157
Bond Position:  [7.00167561]


portfolio before change:  [15.66627537]
curr_Stock_Price:  100.51132709593028
curr_Factors:  [100.5113271]
mat_Sqrt:  [[0.15]]
grads:  [0.02368524]
Stock Position:  0.02368524052452803
Bond Position:  [13.28564041]


portfolio before change:  [15.67966697]
curr_Stock_Price:  100.93647662975596
curr_Factors:  [100.93647663]
mat_Sqrt:  [[0.15]]
grads:  [0.05902295]
Stock Position:  0.059022946904777863
Bond Position:  [9.72209866]


portfolio before change:  [15.7735283]
curr_Stock_Price:  102.48554367391642
curr_Factors:  [102.48554367]
mat_Sqrt:  [[0.15]]
grads:  [-0.09499419]
Stock Position:  -0.09499419283564933
Bond Position:  [25.50905979]


portfolio before change:  [15.94645671]
curr_Stock_Price:  100.73227489294739
curr_Factors:  [100.73227489]
mat_Sqrt:  [[0.15]]
grads:  [-0.02714933]
Stock Position:  -0.027149326370223822
Bond Position:  [18.68127012]


portfolio before change:  [15.96453381]
curr_Stock_Price:  100.23848006940118
curr_Factors:  [100.23848007]
mat_Sqrt:  [[0.15]]
grads:  [-0.17347759]
Stock Position:  -0.17347759004372257
Bond Position:  [33.35366376]


portfolio before change:  [15.91857251]
curr_Stock_Price:  100.55149316652086
curr_Factors:  [100.55149317]
mat_Sqrt:  [[0.15]]
grads:  [0.01544578]
Stock Position:  0.01544578002648597
Bond Position:  [14.36547626]


portfolio before change:  [15.92634521]
curr_Stock_Price:  100.82217444991618
curr_Factors:  [100.82217445]
mat_Sqrt:  [[0.15]]
grads:  [-0.02545252]
Stock Position:  -0.02545251652849997
Bond Position:  [18.49252327]


portfolio before change:  [15.92612295]
curr_Stock_Price:  101.0125668936004
curr_Factors:  [101.01256689]
mat_Sqrt:  [[0.15]]
grads:  [0.04690439]
Stock Position:  0.046904392561155715
Bond Position:  [11.18818986]


portfolio before change:  [15.93915672]
curr_Stock_Price:  101.23080597065805
curr_Factors:  [101.23080597]
mat_Sqrt:  [[0.15]]
grads:  [0.04987605]
Stock Position:  0.049876051037932086
Bond Position:  [10.89016388]


portfolio before change:  [15.93082089]
curr_Stock_Price:  101.00908201035315
curr_Factors:  [101.00908201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01946888]
Stock Position:  -0.019468880710046897
Bond Position:  [17.89735466]


portfolio before change:  [15.95238219]
curr_Stock_Price:  100.13145547666262
curr_Factors:  [100.13145548]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.95238219]
Stock Price:  99.909326399622
PL:  [15.95238219]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.31637935e-02]
 [ 5.91223979e-03]
 [ 9.96425656e-04]
 [ 7.91750829e-03]
 [ 2.24695900e-02]
 [ 4.16791439e-03]
 [ 3.48928445e-02]
 [ 1.33628685e-02]
 [ 5.97841456e-03]
 [ 9.07710672e-03]
 [-1.33746161e-02]
 [-7.49039385e-03]
 [-2.54933372e-02]
 [ 1.98739939e-03]
 [ 2.57797170e-03]
 [ 7.73642478e-03]
 [ 7.48877758e-03]
 [-2.34417219e-03]
 [-1.26266601e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.8087282]
curr_Stock_Price:  102.0136628009286
curr_Factors:  [102.0136628]
mat_Sqrt:  [[0.15]]
grads:  [0.15442529]
Stock Position:  0.15442529029443158
Bond Position:  [17.05523871]


portfolio before change:  [32.6787027]
curr_Stock_Price:  101.14405236305025
curr_Factors:  [101.14405236]
mat_Sqrt:  [[0.15]]
grads:  [0.03941493]
Stock Position:  0.039414931962382854
Bond Position:  [28.69211675]


portfolio before change:  [32.6620527]
curr_Stock_Price:  100.53961342236063
curr_Factors:  [100.53961342]
mat_Sqrt:  [[0.15]]
grads:  [0.00664284]
Stock Position:  0.006642837706737317
Bond Position:  [31.99418437]


portfolio before change:  [32.67033133]
curr_Stock_Price:  100.58162559205775
curr_Factors:  [100.58162559]
mat_Sqrt:  [[0.15]]
grads:  [0.05278339]
Stock Position:  0.052783388594686474
Bond Position:  [27.3612923]


portfolio before change:  [32.72643095]
curr_Stock_Price:  101.514844261216
curr_Factors:  [101.51484426]
mat_Sqrt:  [[0.15]]
grads:  [0.14979727]
Stock Position:  0.14979726691233797
Bond Position:  [17.51978473]


portfolio before change:  [32.62457027]
curr_Stock_Price:  100.80561117699946
curr_Factors:  [100.80561118]
mat_Sqrt:  [[0.15]]
grads:  [0.0277861]
Stock Position:  0.027786095937966777
Bond Position:  [29.82357588]


portfolio before change:  [32.67522634]
curr_Stock_Price:  102.36031843342056
curr_Factors:  [102.36031843]
mat_Sqrt:  [[0.15]]
grads:  [0.23261896]
Stock Position:  0.23261896349229855
Bond Position:  [8.86427516]


portfolio before change:  [32.31681713]
curr_Stock_Price:  100.81003403352935
curr_Factors:  [100.81003403]
mat_Sqrt:  [[0.15]]
grads:  [0.08908579]
Stock Position:  0.08908578981957467
Bond Position:  [23.33607563]


portfolio before change:  [32.42998084]
curr_Stock_Price:  102.01481610207279
curr_Factors:  [102.0148161]
mat_Sqrt:  [[0.15]]
grads:  [0.0398561]
Stock Position:  0.03985609707365198
Bond Position:  [28.36406843]


portfolio before change:  [32.4003799]
curr_Stock_Price:  101.09418289756614
curr_Factors:  [101.0941829]
mat_Sqrt:  [[0.15]]
grads:  [0.06051404]
Stock Position:  0.06051404481137497
Bond Position:  [26.28276199]


portfolio before change:  [32.52369485]
curr_Stock_Price:  103.02337859423791
curr_Factors:  [103.02337859]
mat_Sqrt:  [[0.15]]
grads:  [-0.08916411]
Stock Position:  -0.08916410708408021
Bond Position:  [41.70968241]


portfolio before change:  [32.58667052]
curr_Stock_Price:  102.43405009730526
curr_Factors:  [102.4340501]
mat_Sqrt:  [[0.15]]
grads:  [-0.04993596]
Stock Position:  -0.04993595899885811
Bond Position:  [37.70181305]


portfolio before change:  [32.66623065]
curr_Stock_Price:  101.02958122077166
curr_Factors:  [101.02958122]
mat_Sqrt:  [[0.15]]
grads:  [-0.16995558]
Stock Position:  -0.16995558136407132
Bond Position:  [49.83677186]


portfolio before change:  [32.64131541]
curr_Stock_Price:  101.24949745086153
curr_Factors:  [101.24949745]
mat_Sqrt:  [[0.15]]
grads:  [0.01324933]
Stock Position:  0.013249329269957118
Bond Position:  [31.29982748]


portfolio before change:  [32.65281781]
curr_Stock_Price:  101.52698046759943
curr_Factors:  [101.52698047]
mat_Sqrt:  [[0.15]]
grads:  [0.01718648]
Stock Position:  0.017186477998238775
Bond Position:  [30.90792659]


portfolio before change:  [32.64311131]
curr_Stock_Price:  100.51255198343974
curr_Factors:  [100.51255198]
mat_Sqrt:  [[0.15]]
grads:  [0.05157617]
Stock Position:  0.051576165190321516
Bond Position:  [27.45905932]


portfolio before change:  [32.67844462]
curr_Stock_Price:  101.06450631694503
curr_Factors:  [101.06450632]
mat_Sqrt:  [[0.15]]
grads:  [0.04992518]
Stock Position:  0.049925183896340763
Bond Position:  [27.63278055]


portfolio before change:  [32.64811911]
curr_Stock_Price:  100.31869910705646
curr_Factors:  [100.31869911]
mat_Sqrt:  [[0.15]]
grads:  [-0.01562781]
Stock Position:  -0.015627814619852493
Bond Position:  [34.21588115]


portfolio before change:  [32.65347511]
curr_Stock_Price:  100.52340077001998
curr_Factors:  [100.52340077]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.65347511]
Stock Price:  100.37663536384088
PL:  [32.27683975]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.23216710e-02]
 [ 6.00803922e-03]
 [ 9.09871973e-04]
 [ 1.36123326e-02]
 [ 2.51170922e-02]
 [ 4.35518216e-03]
 [ 1.88551388e-02]
 [ 1.22757742e-02]
 [ 2.73990503e-03]
 [ 9.36017215e-03]
 [-1.70507377e-02]
 [ 6.17273470e-03]
 [-2.60692560e-02]
 [ 2.05022015e-03]
 [ 1.24724087e-02]
 [ 2.65592259e-03]
 [ 7.23585267e-03]
 [-5.17755290e-03]
 [-1.16120975e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.24937606]
curr_Stock_Price:  101.19888281869119
curr_Factors:  [101.19888282]
mat_Sqrt:  [[0.15]]
grads:  [0.08214447]
Stock Position:  0.08214447313670178
Bond Position:  [11.93644715]


portfolio before change:  [20.26135133]
curr_Stock_Price:  101.30833367879123
curr_Factors:  [101.30833368]
mat_Sqrt:  [[0.15]]
grads:  [0.04005359]
Stock Position:  0.040053594786742974
Bond Position:  [16.20358838]


portfolio before change:  [20.2650383]
curr_Stock_Price:  101.29923502858047
curr_Factors:  [101.29923503]
mat_Sqrt:  [[0.15]]
grads:  [0.00606581]
Stock Position:  0.006065813151474472
Bond Position:  [19.65057606]


portfolio before change:  [20.26992434]
curr_Stock_Price:  101.29474820124453
curr_Factors:  [101.2947482]
mat_Sqrt:  [[0.15]]
grads:  [0.09074888]
Stock Position:  0.09074888396607982
Bond Position:  [11.07753899]


portfolio before change:  [20.34049597]
curr_Stock_Price:  102.04188579519939
curr_Factors:  [102.0418858]
mat_Sqrt:  [[0.15]]
grads:  [0.16744728]
Stock Position:  0.16744728118628965
Bond Position:  [3.25385963]


portfolio before change:  [20.14130146]
curr_Stock_Price:  100.84743175449877
curr_Factors:  [100.84743175]
mat_Sqrt:  [[0.15]]
grads:  [0.02903455]
Stock Position:  0.029034547753948817
Bond Position:  [17.21324188]


portfolio before change:  [20.14353721]
curr_Stock_Price:  100.77620286315843
curr_Factors:  [100.77620286]
mat_Sqrt:  [[0.15]]
grads:  [0.12570093]
Stock Position:  0.1257009250710323
Bond Position:  [7.47587528]


portfolio before change:  [19.96227059]
curr_Stock_Price:  99.31928581965883
curr_Factors:  [99.31928582]
mat_Sqrt:  [[0.15]]
grads:  [0.08183849]
Stock Position:  0.081838494956033
Bond Position:  [11.83412972]


portfolio before change:  [19.99259601]
curr_Stock_Price:  99.65368246991535
curr_Factors:  [99.65368247]
mat_Sqrt:  [[0.15]]
grads:  [0.01826603]
Stock Position:  0.018266033523106587
Bond Position:  [18.17231851]


portfolio before change:  [20.03037655]
curr_Stock_Price:  101.4732832326039
curr_Factors:  [101.47328323]
mat_Sqrt:  [[0.15]]
grads:  [0.06240115]
Stock Position:  0.06240114767278417
Bond Position:  [13.69832721]


portfolio before change:  [19.95505929]
curr_Stock_Price:  100.21141122529336
curr_Factors:  [100.21141123]
mat_Sqrt:  [[0.15]]
grads:  [-0.11367158]
Stock Position:  -0.11367158469608346
Bond Position:  [31.34624921]


portfolio before change:  [20.07515077]
curr_Stock_Price:  99.2238826652608
curr_Factors:  [99.22388267]
mat_Sqrt:  [[0.15]]
grads:  [0.04115156]
Stock Position:  0.04115156465998685
Bond Position:  [15.99193275]


portfolio before change:  [20.13593265]
curr_Stock_Price:  100.60374246241435
curr_Factors:  [100.60374246]
mat_Sqrt:  [[0.15]]
grads:  [-0.17379504]
Stock Position:  -0.1737950402885284
Bond Position:  [37.62036412]


portfolio before change:  [20.07536792]
curr_Stock_Price:  101.00634886424288
curr_Factors:  [101.00634886]
mat_Sqrt:  [[0.15]]
grads:  [0.01366813]
Stock Position:  0.013668134309129464
Bond Position:  [18.69479957]


portfolio before change:  [20.10322596]
curr_Stock_Price:  102.70253906709024
curr_Factors:  [102.70253907]
mat_Sqrt:  [[0.15]]
grads:  [0.08314939]
Stock Position:  0.08314939161764663
Bond Position:  [11.56357232]


portfolio before change:  [20.11986735]
curr_Stock_Price:  102.8679057382931
curr_Factors:  [102.86790574]
mat_Sqrt:  [[0.15]]
grads:  [0.01770615]
Stock Position:  0.01770615061470357
Bond Position:  [18.29847272]


portfolio before change:  [20.13896524]
curr_Stock_Price:  103.68811207730359
curr_Factors:  [103.68811208]
mat_Sqrt:  [[0.15]]
grads:  [0.04823902]
Stock Position:  0.048239017810306685
Bond Position:  [15.13715255]


portfolio before change:  [20.1263943]
curr_Stock_Price:  103.34905674085672
curr_Factors:  [103.34905674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03451702]
Stock Position:  -0.034517019303964294
Bond Position:  [23.69369569]


portfolio before change:  [20.13830732]
curr_Stock_Price:  103.17555232223829
curr_Factors:  [103.17555232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.13830732]
Stock Price:  103.82860228427587
PL:  [16.30970504]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.25616663e-03]
 [ 6.23299421e-03]
 [-9.56826454e-04]
 [-4.25892986e-05]
 [-1.28104854e-02]
 [-7.94806415e-03]
 [ 6.06180091e-03]
 [-8.75537624e-03]
 [ 4.40972882e-03]
 [-1.82915055e-02]
 [-1.74728436e-02]
 [ 7.14362836e-03]
 [ 1.11028506e-02]
 [-5.71887926e-03]
 [-1.58345839e-02]
 [ 5.98214898e-03]
 [ 6.63818709e-04]
 [-6.72169697e-03]
 [-1.03897526e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.62383173]
curr_Stock_Price:  99.39062619061076
curr_Factors:  [99.39062619]
mat_Sqrt:  [[0.15]]
grads:  [0.04837444]
Stock Position:  0.04837444420545573
Bond Position:  [-12.43179803]


portfolio before change:  [-7.65800608]
curr_Stock_Price:  98.74842738677744
curr_Factors:  [98.74842739]
mat_Sqrt:  [[0.15]]
grads:  [0.04155329]
Stock Position:  0.041553294761839187
Bond Position:  [-11.76132859]


portfolio before change:  [-7.67075482]
curr_Stock_Price:  98.51239216535869
curr_Factors:  [98.51239217]
mat_Sqrt:  [[0.15]]
grads:  [-0.00637884]
Stock Position:  -0.006378843027066088
Bond Position:  [-7.04235973]


portfolio before change:  [-7.66530732]
curr_Stock_Price:  97.38235752262827
curr_Factors:  [97.38235752]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028393]
Stock Position:  -0.00028392865744789286
Bond Position:  [-7.63765767]


portfolio before change:  [-7.66651051]
curr_Stock_Price:  94.89418474615118
curr_Factors:  [94.89418475]
mat_Sqrt:  [[0.15]]
grads:  [-0.08540324]
Stock Position:  -0.08540323627931416
Bond Position:  [0.43775998]


portfolio before change:  [-7.5586748]
curr_Stock_Price:  93.63280104030152
curr_Factors:  [93.63280104]
mat_Sqrt:  [[0.15]]
grads:  [-0.05298709]
Stock Position:  -0.05298709434174864
Bond Position:  [-2.59734474]


portfolio before change:  [-7.56398858]
curr_Stock_Price:  93.72082924353501
curr_Factors:  [93.72082924]
mat_Sqrt:  [[0.15]]
grads:  [0.04041201]
Stock Position:  0.040412006070602025
Bond Position:  [-11.3514353]


portfolio before change:  [-7.58502113]
curr_Stock_Price:  93.27060801160171
curr_Factors:  [93.27060801]
mat_Sqrt:  [[0.15]]
grads:  [-0.05836917]
Stock Position:  -0.05836917490540948
Bond Position:  [-2.1408927]


portfolio before change:  [-7.60133389]
curr_Stock_Price:  93.54091283800562
curr_Factors:  [93.54091284]
mat_Sqrt:  [[0.15]]
grads:  [0.02939819]
Stock Position:  0.029398192115686787
Bond Position:  [-10.35126762]


portfolio before change:  [-7.57085083]
curr_Stock_Price:  94.66585295022549
curr_Factors:  [94.66585295]
mat_Sqrt:  [[0.15]]
grads:  [-0.12194337]
Stock Position:  -0.1219433699747606
Bond Position:  [3.9730223]


portfolio before change:  [-7.55965693]
curr_Stock_Price:  94.58220334275838
curr_Factors:  [94.58220334]
mat_Sqrt:  [[0.15]]
grads:  [-0.11648562]
Stock Position:  -0.11648562380621978
Bond Position:  [3.45781002]


portfolio before change:  [-7.70945213]
curr_Stock_Price:  95.8755797412742
curr_Factors:  [95.87557974]
mat_Sqrt:  [[0.15]]
grads:  [0.04762419]
Stock Position:  0.04762418906646819
Bond Position:  [-12.27544887]


portfolio before change:  [-7.72997465]
curr_Stock_Price:  95.5091005566684
curr_Factors:  [95.50910056]
mat_Sqrt:  [[0.15]]
grads:  [0.074019]
Stock Position:  0.07401900398494451
Bond Position:  [-14.79946315]


portfolio before change:  [-7.95658027]
curr_Stock_Price:  92.49764023105512
curr_Factors:  [92.49764023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03812586]
Stock Position:  -0.038125861714746065
Bond Position:  [-4.43002803]


portfolio before change:  [-7.98378431]
curr_Stock_Price:  93.18212024781438
curr_Factors:  [93.18212025]
mat_Sqrt:  [[0.15]]
grads:  [-0.10556389]
Stock Position:  -0.10556389242431216
Bond Position:  [1.85288301]


portfolio before change:  [-7.95843375]
curr_Stock_Price:  92.94636464094111
curr_Factors:  [92.94636464]
mat_Sqrt:  [[0.15]]
grads:  [0.03988099]
Stock Position:  0.03988099323039655
Bond Position:  [-11.66522709]


portfolio before change:  [-8.04443488]
curr_Stock_Price:  90.863055106556
curr_Factors:  [90.86305511]
mat_Sqrt:  [[0.15]]
grads:  [0.00442546]
Stock Position:  0.00442545805775723
Bond Position:  [-8.44654551]


portfolio before change:  [-8.04479624]
curr_Stock_Price:  91.25861521837882
curr_Factors:  [91.25861522]
mat_Sqrt:  [[0.15]]
grads:  [-0.04481131]
Stock Position:  -0.044811313157528565
Bond Position:  [-3.95537786]


portfolio before change:  [-8.0060579]
curr_Stock_Price:  90.37206886546461
curr_Factors:  [90.37206887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.0060579]
Stock Price:  90.1662799173438
PL:  [-8.0060579]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.93695379e-03]
 [ 8.29733054e-03]
 [ 1.11931705e-03]
 [ 1.04665671e-02]
 [ 2.39517677e-02]
 [ 5.06916877e-03]
 [ 3.19469956e-02]
 [ 5.25126076e-03]
 [ 3.10595086e-03]
 [ 9.14855813e-03]
 [-1.74856408e-02]
 [ 5.12489190e-03]
 [-2.35308712e-02]
 [ 3.66235766e-03]
 [-1.32942739e-02]
 [ 7.81101019e-03]
 [ 6.94923158e-03]
 [-1.94222768e-03]
 [-1.27168881e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.05970379]
curr_Stock_Price:  100.01883939869857
curr_Factors:  [100.0188394]
mat_Sqrt:  [[0.15]]
grads:  [0.01957969]
Stock Position:  0.01957969192440894
Bond Position:  [0.10136573]


portfolio before change:  [2.06736335]
curr_Stock_Price:  100.40874415011277
curr_Factors:  [100.40874415]
mat_Sqrt:  [[0.15]]
grads:  [0.05531554]
Stock Position:  0.05531553693113212
Bond Position:  [-3.48680025]


portfolio before change:  [2.06703522]
curr_Stock_Price:  100.41857283883007
curr_Factors:  [100.41857284]
mat_Sqrt:  [[0.15]]
grads:  [0.00746211]
Stock Position:  0.007462113688331993
Bond Position:  [1.31770041]


portfolio before change:  [2.07050069]
curr_Stock_Price:  100.83882964415035
curr_Factors:  [100.83882964]
mat_Sqrt:  [[0.15]]
grads:  [0.06977711]
Stock Position:  0.0697771136811784
Bond Position:  [-4.96574179]


portfolio before change:  [2.1295819]
curr_Stock_Price:  101.70333667508064
curr_Factors:  [101.70333668]
mat_Sqrt:  [[0.15]]
grads:  [0.15967845]
Stock Position:  0.1596784515119982
Bond Position:  [-14.11024941]


portfolio before change:  [2.01484462]
curr_Stock_Price:  101.00687900871175
curr_Factors:  [101.00687901]
mat_Sqrt:  [[0.15]]
grads:  [0.03379446]
Stock Position:  0.033794458448123475
Bond Position:  [-1.39862816]


portfolio before change:  [2.04358966]
curr_Stock_Price:  101.86781130339914
curr_Factors:  [101.8678113]
mat_Sqrt:  [[0.15]]
grads:  [0.21297997]
Stock Position:  0.21297997091783114
Bond Position:  [-19.65221383]


portfolio before change:  [2.21136057]
curr_Stock_Price:  102.67861327963332
curr_Factors:  [102.67861328]
mat_Sqrt:  [[0.15]]
grads:  [0.03500841]
Stock Position:  0.03500840509525478
Bond Position:  [-1.38325392]


portfolio before change:  [2.12285454]
curr_Stock_Price:  100.16035591665764
curr_Factors:  [100.16035592]
mat_Sqrt:  [[0.15]]
grads:  [0.02070634]
Stock Position:  0.020706339040718957
Bond Position:  [0.04890025]


portfolio before change:  [2.11984529]
curr_Stock_Price:  100.01443547748755
curr_Factors:  [100.01443548]
mat_Sqrt:  [[0.15]]
grads:  [0.06099039]
Stock Position:  0.06099038754153817
Bond Position:  [-3.98007389]


portfolio before change:  [2.11032213]
curr_Stock_Price:  99.87460982089245
curr_Factors:  [99.87460982]
mat_Sqrt:  [[0.15]]
grads:  [-0.11657094]
Stock Position:  -0.11657093842815963
Bond Position:  [13.75279912]


portfolio before change:  [2.14148948]
curr_Stock_Price:  99.63673988354444
curr_Factors:  [99.63673988]
mat_Sqrt:  [[0.15]]
grads:  [0.03416595]
Stock Position:  0.034165946018465475
Bond Position:  [-1.262694]


portfolio before change:  [2.14040171]
curr_Stock_Price:  99.61414277044328
curr_Factors:  [99.61414277]
mat_Sqrt:  [[0.15]]
grads:  [-0.15687247]
Stock Position:  -0.15687247490139952
Bond Position:  [17.76711882]


portfolio before change:  [2.08981151]
curr_Stock_Price:  99.96495343369605
curr_Factors:  [99.96495343]
mat_Sqrt:  [[0.15]]
grads:  [0.02441572]
Stock Position:  0.024415717725632936
Bond Position:  [-0.35090458]


portfolio before change:  [2.07872824]
curr_Stock_Price:  99.51460677403092
curr_Factors:  [99.51460677]
mat_Sqrt:  [[0.15]]
grads:  [-0.08862849]
Stock Position:  -0.08862849281700415
Bond Position:  [10.89855785]


portfolio before change:  [2.05744009]
curr_Stock_Price:  99.78554812572034
curr_Factors:  [99.78554813]
mat_Sqrt:  [[0.15]]
grads:  [0.0520734]
Stock Position:  0.0520734012980195
Bond Position:  [-3.1387328]


portfolio before change:  [2.04561919]
curr_Stock_Price:  99.57361419584014
curr_Factors:  [99.5736142]
mat_Sqrt:  [[0.15]]
grads:  [0.04632821]
Stock Position:  0.046328210538985885
Bond Position:  [-2.56744817]


portfolio before change:  [1.97136296]
curr_Stock_Price:  97.98464082290931
curr_Factors:  [97.98464082]
mat_Sqrt:  [[0.15]]
grads:  [-0.01294818]
Stock Position:  -0.01294818453664601
Bond Position:  [3.24008617]


portfolio before change:  [1.97041138]
curr_Stock_Price:  98.12069851113438
curr_Factors:  [98.12069851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.97041138]
Stock Price:  98.36529405063638
PL:  [1.97041138]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.14239236e-02]
 [ 6.50114417e-03]
 [-5.27908591e-04]
 [ 3.65053874e-03]
 [ 5.04594445e-03]
 [ 3.53420713e-03]
 [-7.06157963e-03]
 [ 5.98573258e-03]
 [ 2.65636505e-03]
 [ 9.84864706e-03]
 [-1.84128054e-02]
 [ 5.40942387e-03]
 [ 3.53464746e-03]
 [-2.40540686e-05]
 [-1.71999928e-02]
 [ 6.66249034e-03]
 [ 3.96497458e-03]
 [-1.84784358e-03]
 [-1.28046379e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.62351394]
curr_Stock_Price:  98.2229082548069
curr_Factors:  [98.22290825]
mat_Sqrt:  [[0.15]]
grads:  [0.20949282]
Stock Position:  0.20949282382238157
Bond Position:  [-46.20050836]


portfolio before change:  [-25.51155335]
curr_Stock_Price:  98.81248532539774
curr_Factors:  [98.81248533]
mat_Sqrt:  [[0.15]]
grads:  [0.04334096]
Stock Position:  0.04334096115535524
Bond Position:  [-29.79418144]


portfolio before change:  [-25.52551325]
curr_Stock_Price:  98.66227129415229
curr_Factors:  [98.66227129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00351939]
Stock Position:  -0.003519390603464084
Bond Position:  [-25.17828218]


portfolio before change:  [-25.53683771]
curr_Stock_Price:  100.09124172869294
curr_Factors:  [100.09124173]
mat_Sqrt:  [[0.15]]
grads:  [0.02433692]
Stock Position:  0.024336924927191063
Bond Position:  [-27.97275075]


portfolio before change:  [-25.55647964]
curr_Stock_Price:  99.5715429324527
curr_Factors:  [99.57154293]
mat_Sqrt:  [[0.15]]
grads:  [0.03363963]
Stock Position:  0.033639629663859416
Bond Position:  [-28.90602947]


portfolio before change:  [-25.62049958]
curr_Stock_Price:  97.88328048876582
curr_Factors:  [97.88328049]
mat_Sqrt:  [[0.15]]
grads:  [0.02356138]
Stock Position:  0.023561380869635603
Bond Position:  [-27.92676483]


portfolio before change:  [-25.62619881]
curr_Stock_Price:  97.93774819447233
curr_Factors:  [97.93774819]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470772]
Stock Position:  -0.04707719753065484
Bond Position:  [-21.01556409]


portfolio before change:  [-25.57635187]
curr_Stock_Price:  96.76729858989587
curr_Factors:  [96.76729859]
mat_Sqrt:  [[0.15]]
grads:  [0.03990488]
Stock Position:  0.03990488386887348
Bond Position:  [-29.43783968]


portfolio before change:  [-25.4633361]
curr_Stock_Price:  99.7838753302367
curr_Factors:  [99.78387533]
mat_Sqrt:  [[0.15]]
grads:  [0.0177091]
Stock Position:  0.01770910030646823
Bond Position:  [-27.23041876]


portfolio before change:  [-25.47130742]
curr_Stock_Price:  99.71821053001916
curr_Factors:  [99.71821053]
mat_Sqrt:  [[0.15]]
grads:  [0.06565765]
Stock Position:  0.06565764707436837
Bond Position:  [-32.0185705]


portfolio before change:  [-25.5646527]
curr_Stock_Price:  98.41844368933859
curr_Factors:  [98.41844369]
mat_Sqrt:  [[0.15]]
grads:  [-0.12275204]
Stock Position:  -0.12275203621962108
Bond Position:  [-13.48358833]


portfolio before change:  [-25.49326815]
curr_Stock_Price:  97.80944472248193
curr_Factors:  [97.80944472]
mat_Sqrt:  [[0.15]]
grads:  [0.03606283]
Stock Position:  0.03606282578519671
Bond Position:  [-29.02055312]


portfolio before change:  [-25.54988801]
curr_Stock_Price:  96.44061656338047
curr_Factors:  [96.44061656]
mat_Sqrt:  [[0.15]]
grads:  [0.02356432]
Stock Position:  0.023564316431985585
Bond Position:  [-27.82244522]


portfolio before change:  [-25.52094514]
curr_Stock_Price:  97.96407877904382
curr_Factors:  [97.96407878]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016036]
Stock Position:  -0.00016036045726256927
Bond Position:  [-25.50523558]


portfolio before change:  [-25.52725435]
curr_Stock_Price:  97.54064634728734
curr_Factors:  [97.54064635]
mat_Sqrt:  [[0.15]]
grads:  [-0.11466662]
Stock Position:  -0.11466661846590806
Bond Position:  [-14.34259827]


portfolio before change:  [-25.36634331]
curr_Stock_Price:  96.10607772010432
curr_Factors:  [96.10607772]
mat_Sqrt:  [[0.15]]
grads:  [0.0444166]
Stock Position:  0.04441660224640524
Bond Position:  [-29.63504874]


portfolio before change:  [-25.3364399]
curr_Stock_Price:  96.94614870508394
curr_Factors:  [96.94614871]
mat_Sqrt:  [[0.15]]
grads:  [0.02643316]
Stock Position:  0.02643316388873041
Bond Position:  [-27.89903334]


portfolio before change:  [-25.30607409]
curr_Stock_Price:  98.35882274490427
curr_Factors:  [98.35882274]
mat_Sqrt:  [[0.15]]
grads:  [-0.01231896]
Stock Position:  -0.012318957176760329
Bond Position:  [-24.09439596]


portfolio before change:  [-25.32541994]
curr_Stock_Price:  99.44020496418892
curr_Factors:  [99.44020496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.32541994]
Stock Price:  99.86987184357277
PL:  [-25.32541994]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.17856269e-02]
 [ 4.65846163e-03]
 [ 1.20525648e-03]
 [ 4.97611043e-03]
 [ 1.03282180e-02]
 [ 3.00803498e-03]
 [ 2.67735499e-02]
 [ 9.28556818e-03]
 [ 8.61815326e-03]
 [-9.48406415e-03]
 [-1.20995516e-02]
 [-1.60737282e-02]
 [-2.10195777e-02]
 [ 4.92992530e-03]
 [ 2.84378807e-02]
 [ 7.27868790e-04]
 [ 6.31237079e-03]
 [-5.38064643e-03]
 [-1.03984753e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.82679511]
curr_Stock_Price:  99.18283597864705
curr_Factors:  [99.18283598]
mat_Sqrt:  [[0.15]]
grads:  [0.07857085]
Stock Position:  0.078570845678187
Bond Position:  [-18.61967441]


portfolio before change:  [-10.88824602]
curr_Stock_Price:  98.45997993291365
curr_Factors:  [98.45997993]
mat_Sqrt:  [[0.15]]
grads:  [0.03105641]
Stock Position:  0.031056410833549243
Bond Position:  [-13.94605961]


portfolio before change:  [-10.83665352]
curr_Stock_Price:  100.23350899661393
curr_Factors:  [100.233509]
mat_Sqrt:  [[0.15]]
grads:  [0.00803504]
Stock Position:  0.008035043223877646
Bond Position:  [-11.6420341]


portfolio before change:  [-10.83888497]
curr_Stock_Price:  100.31806632317604
curr_Factors:  [100.31806632]
mat_Sqrt:  [[0.15]]
grads:  [0.03317407]
Stock Position:  0.033174069538482565
Bond Position:  [-14.16684348]


portfolio before change:  [-10.84468241]
curr_Stock_Price:  100.25008286712293
curr_Factors:  [100.25008287]
mat_Sqrt:  [[0.15]]
grads:  [0.06885479]
Stock Position:  0.06885478675311799
Bond Position:  [-17.74738049]


portfolio before change:  [-10.86557173]
curr_Stock_Price:  100.01114640035117
curr_Factors:  [100.0111464]
mat_Sqrt:  [[0.15]]
grads:  [0.02005357]
Stock Position:  0.020053566533964198
Bond Position:  [-12.87115191]


portfolio before change:  [-10.84141381]
curr_Stock_Price:  101.37629601917286
curr_Factors:  [101.37629602]
mat_Sqrt:  [[0.15]]
grads:  [0.17849033]
Stock Position:  0.1784903324414301
Bond Position:  [-28.93610258]


portfolio before change:  [-10.74898398]
curr_Stock_Price:  101.93467223284324
curr_Factors:  [101.93467223]
mat_Sqrt:  [[0.15]]
grads:  [0.06190379]
Stock Position:  0.06190378789298116
Bond Position:  [-17.05912631]


portfolio before change:  [-10.67063804]
curr_Stock_Price:  103.2691826812926
curr_Factors:  [103.26918268]
mat_Sqrt:  [[0.15]]
grads:  [0.05745436]
Stock Position:  0.05745435506678173
Bond Position:  [-16.60390233]


portfolio before change:  [-10.62361887]
curr_Stock_Price:  104.15981429809551
curr_Factors:  [104.1598143]
mat_Sqrt:  [[0.15]]
grads:  [-0.06322709]
Stock Position:  -0.06322709434155123
Bond Position:  [-4.03789647]


portfolio before change:  [-10.60235627]
curr_Stock_Price:  103.80755709159173
curr_Factors:  [103.80755709]
mat_Sqrt:  [[0.15]]
grads:  [-0.08066368]
Stock Position:  -0.08066367747014482
Bond Position:  [-2.22885697]


portfolio before change:  [-10.6299993]
curr_Stock_Price:  104.14334320441799
curr_Factors:  [104.1433432]
mat_Sqrt:  [[0.15]]
grads:  [-0.10715819]
Stock Position:  -0.1071581881490442
Bond Position:  [0.52981267]


portfolio before change:  [-10.58020787]
curr_Stock_Price:  103.67992588212935
curr_Factors:  [103.67992588]
mat_Sqrt:  [[0.15]]
grads:  [-0.14013052]
Stock Position:  -0.14013051804859053
Bond Position:  [3.94851386]


portfolio before change:  [-10.75144041]
curr_Stock_Price:  104.90892152597837
curr_Factors:  [104.90892153]
mat_Sqrt:  [[0.15]]
grads:  [0.03286617]
Stock Position:  0.032866168666826165
Bond Position:  [-14.19939472]


portfolio before change:  [-10.76284405]
curr_Stock_Price:  104.66997241845581
curr_Factors:  [104.66997242]
mat_Sqrt:  [[0.15]]
grads:  [0.18958587]
Stock Position:  0.18958587141700106
Bond Position:  [-30.60679198]


portfolio before change:  [-10.67343592]
curr_Stock_Price:  105.18193451323248
curr_Factors:  [105.18193451]
mat_Sqrt:  [[0.15]]
grads:  [0.00485246]
Stock Position:  0.004852458600815962
Bond Position:  [-11.1838269]


portfolio before change:  [-10.66991197]
curr_Stock_Price:  106.484420572971
curr_Factors:  [106.48442057]
mat_Sqrt:  [[0.15]]
grads:  [0.04208247]
Stock Position:  0.04208247193025201
Bond Position:  [-15.15103961]


portfolio before change:  [-10.72161661]
curr_Stock_Price:  105.34578945316237
curr_Factors:  [105.34578945]
mat_Sqrt:  [[0.15]]
grads:  [-0.03587098]
Stock Position:  -0.03587097621456069
Bond Position:  [-6.94276031]


portfolio before change:  [-10.73780282]
curr_Stock_Price:  105.74863051090813
curr_Factors:  [105.74863051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.73780282]
Stock Price:  105.62550263694082
PL:  [-16.36330546]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.44361041e-04]
 [ 1.01556958e-02]
 [ 1.19659403e-03]
 [ 2.99292661e-03]
 [ 8.62487301e-03]
 [ 3.18741541e-03]
 [-9.62799949e-03]
 [ 1.19826401e-02]
 [ 4.67044871e-03]
 [ 1.25835408e-02]
 [-1.70187833e-02]
 [-8.68777316e-03]
 [-2.60799296e-02]
 [ 3.11528749e-03]
 [-1.23266971e-02]
 [ 7.85660930e-03]
 [ 4.44499851e-03]
 [-1.73539327e-03]
 [-1.27226377e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.61636654]
curr_Stock_Price:  99.71548231001024
curr_Factors:  [99.71548231]
mat_Sqrt:  [[0.15]]
grads:  [0.00562907]
Stock Position:  0.005629073607421675
Bond Position:  [-3.17767233]


portfolio before change:  [-2.61806521]
curr_Stock_Price:  99.55486007817149
curr_Factors:  [99.55486008]
mat_Sqrt:  [[0.15]]
grads:  [0.06770464]
Stock Position:  0.06770463867234447
Bond Position:  [-9.35839104]


portfolio before change:  [-2.57326722]
curr_Stock_Price:  100.2510882956163
curr_Factors:  [100.2510883]
mat_Sqrt:  [[0.15]]
grads:  [0.00797729]
Stock Position:  0.007977293547605603
Bond Position:  [-3.37299958]


portfolio before change:  [-2.58295775]
curr_Stock_Price:  99.14204365419297
curr_Factors:  [99.14204365]
mat_Sqrt:  [[0.15]]
grads:  [0.01995284]
Stock Position:  0.019952844062025393
Bond Position:  [-4.56112349]


portfolio before change:  [-2.56481011]
curr_Stock_Price:  100.10872617372348
curr_Factors:  [100.10872617]
mat_Sqrt:  [[0.15]]
grads:  [0.05749915]
Stock Position:  0.057499153414618254
Bond Position:  [-8.32097712]


portfolio before change:  [-2.56303207]
curr_Stock_Price:  100.17583239307874
curr_Factors:  [100.17583239]
mat_Sqrt:  [[0.15]]
grads:  [0.02124944]
Stock Position:  0.02124943604180803
Bond Position:  [-4.69171201]


portfolio before change:  [-2.57315463]
curr_Stock_Price:  99.75466871212005
curr_Factors:  [99.75466871]
mat_Sqrt:  [[0.15]]
grads:  [-0.06418666]
Stock Position:  -0.06418666328590039
Bond Position:  [3.8297647]


portfolio before change:  [-2.51670942]
curr_Stock_Price:  98.89019550607287
curr_Factors:  [98.89019551]
mat_Sqrt:  [[0.15]]
grads:  [0.07988427]
Stock Position:  0.07988426758561532
Bond Position:  [-10.41648026]


portfolio before change:  [-2.66055913]
curr_Stock_Price:  97.12207185287923
curr_Factors:  [97.12207185]
mat_Sqrt:  [[0.15]]
grads:  [0.03113632]
Stock Position:  0.03113632475416071
Bond Position:  [-5.6845835]


portfolio before change:  [-2.59934691]
curr_Stock_Price:  99.1336626932779
curr_Factors:  [99.13366269]
mat_Sqrt:  [[0.15]]
grads:  [0.08389027]
Stock Position:  0.0838902721445314
Bond Position:  [-10.91569685]


portfolio before change:  [-2.50958757]
curr_Stock_Price:  100.23615760387035
curr_Factors:  [100.2361576]
mat_Sqrt:  [[0.15]]
grads:  [-0.11345856]
Stock Position:  -0.11345855558116574
Bond Position:  [8.86306209]


portfolio before change:  [-2.67477257]
curr_Stock_Price:  101.71159537825369
curr_Factors:  [101.71159538]
mat_Sqrt:  [[0.15]]
grads:  [-0.05791849]
Stock Position:  -0.05791848771918602
Bond Position:  [3.21620922]


portfolio before change:  [-2.61524843]
curr_Stock_Price:  100.69775697119408
curr_Factors:  [100.69775697]
mat_Sqrt:  [[0.15]]
grads:  [-0.1738662]
Stock Position:  -0.17386619716465912
Bond Position:  [14.89268764]


portfolio before change:  [-2.38221664]
curr_Stock_Price:  99.37887984623589
curr_Factors:  [99.37887985]
mat_Sqrt:  [[0.15]]
grads:  [0.02076858]
Stock Position:  0.02076858325764982
Bond Position:  [-4.44617518]


portfolio before change:  [-2.37717595]
curr_Stock_Price:  99.6751142957864
curr_Factors:  [99.6751143]
mat_Sqrt:  [[0.15]]
grads:  [-0.08217798]
Stock Position:  -0.08217798040425565
Bond Position:  [5.81392363]


portfolio before change:  [-2.27080581]
curr_Stock_Price:  98.3984160229804
curr_Factors:  [98.39841602]
mat_Sqrt:  [[0.15]]
grads:  [0.0523774]
Stock Position:  0.05237739532766707
Bond Position:  [-7.42465854]


portfolio before change:  [-2.28291563]
curr_Stock_Price:  98.20265557056977
curr_Factors:  [98.20265557]
mat_Sqrt:  [[0.15]]
grads:  [0.02963332]
Stock Position:  0.029633323367959995
Bond Position:  [-5.19298667]


portfolio before change:  [-2.25693139]
curr_Stock_Price:  99.12333002197181
curr_Factors:  [99.12333002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156929]
Stock Position:  -0.011569288492233067
Bond Position:  [-1.11014499]


portfolio before change:  [-2.24682995]
curr_Stock_Price:  98.22621209002537
curr_Factors:  [98.22621209]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.24682995]
Stock Price:  98.31374023217478
PL:  [-2.24682995]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.03702106e-03]
 [ 9.06566964e-03]
 [ 1.18542042e-03]
 [ 3.40278482e-03]
 [ 4.00568633e-03]
 [ 3.18240284e-03]
 [ 3.31634666e-02]
 [ 1.32220585e-02]
 [ 2.87397212e-03]
 [ 1.12516608e-02]
 [-1.80357717e-02]
 [ 5.80273056e-03]
 [-1.15269434e-02]
 [-2.84046035e-03]
 [-1.68839737e-02]
 [ 7.76790411e-03]
 [ 3.76389721e-03]
 [-2.99840205e-03]
 [-1.25911299e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.10215883]
curr_Stock_Price:  100.60546291869295
curr_Factors:  [100.60546292]
mat_Sqrt:  [[0.15]]
grads:  [0.04024681]
Stock Position:  0.04024680707770037
Bond Position:  [7.05311017]


portfolio before change:  [11.08032638]
curr_Stock_Price:  100.01918151505369
curr_Factors:  [100.01918152]
mat_Sqrt:  [[0.15]]
grads:  [0.0604378]
Stock Position:  0.06043779759490901
Bond Position:  [5.03538733]


portfolio before change:  [11.09697176]
curr_Stock_Price:  100.27376365875676
curr_Factors:  [100.27376366]
mat_Sqrt:  [[0.15]]
grads:  [0.0079028]
Stock Position:  0.007902802813900479
Bond Position:  [10.30452798]


portfolio before change:  [11.09497603]
curr_Stock_Price:  99.69521089581843
curr_Factors:  [99.6952109]
mat_Sqrt:  [[0.15]]
grads:  [0.02268523]
Stock Position:  0.022685232125833392
Bond Position:  [8.83336703]


portfolio before change:  [11.09088842]
curr_Stock_Price:  99.41766364890945
curr_Factors:  [99.41766365]
mat_Sqrt:  [[0.15]]
grads:  [0.02670458]
Stock Position:  0.026704575503374493
Bond Position:  [8.43598192]


portfolio before change:  [11.11313711]
curr_Stock_Price:  100.17182019375018
curr_Factors:  [100.17182019]
mat_Sqrt:  [[0.15]]
grads:  [0.02121602]
Stock Position:  0.02121601895704735
Bond Position:  [8.98788988]


portfolio before change:  [11.1548265]
curr_Stock_Price:  102.03089343258583
curr_Factors:  [102.03089343]
mat_Sqrt:  [[0.15]]
grads:  [0.22108978]
Stock Position:  0.22108977710216823
Bond Position:  [-11.40316099]


portfolio before change:  [10.92493033]
curr_Stock_Price:  101.00395757312798
curr_Factors:  [101.00395757]
mat_Sqrt:  [[0.15]]
grads:  [0.08814706]
Stock Position:  0.0881470569860495
Bond Position:  [2.02172873]


portfolio before change:  [10.83395158]
curr_Stock_Price:  99.96609824818572
curr_Factors:  [99.96609825]
mat_Sqrt:  [[0.15]]
grads:  [0.01915981]
Stock Position:  0.01915981412185292
Bond Position:  [8.91861972]


portfolio before change:  [10.82531218]
curr_Stock_Price:  99.39879961469705
curr_Factors:  [99.39879961]
mat_Sqrt:  [[0.15]]
grads:  [0.07501107]
Stock Position:  0.07501107188668091
Bond Position:  [3.36930168]


portfolio before change:  [10.8316607]
curr_Stock_Price:  99.47220326650829
curr_Factors:  [99.47220327]
mat_Sqrt:  [[0.15]]
grads:  [-0.12023848]
Stock Position:  -0.120238478147657
Bond Position:  [22.79204704]


portfolio before change:  [10.94611372]
curr_Stock_Price:  98.56771496815875
curr_Factors:  [98.56771497]
mat_Sqrt:  [[0.15]]
grads:  [0.03868487]
Stock Position:  0.03868487040049026
Bond Position:  [7.13303444]


portfolio before change:  [10.93193405]
curr_Stock_Price:  98.15506920291968
curr_Factors:  [98.1550692]
mat_Sqrt:  [[0.15]]
grads:  [-0.07684629]
Stock Position:  -0.07684628927648444
Bond Position:  [18.47478689]


portfolio before change:  [11.12690974]
curr_Stock_Price:  95.67796309327538
curr_Factors:  [95.67796309]
mat_Sqrt:  [[0.15]]
grads:  [-0.0189364]
Stock Position:  -0.01893640231069025
Bond Position:  [12.93870614]


portfolio before change:  [11.10921239]
curr_Stock_Price:  96.78336970195349
curr_Factors:  [96.7833697]
mat_Sqrt:  [[0.15]]
grads:  [-0.11255982]
Stock Position:  -0.11255982438318428
Bond Position:  [22.00313149]


portfolio before change:  [10.94546338]
curr_Stock_Price:  98.28701887087783
curr_Factors:  [98.28701887]
mat_Sqrt:  [[0.15]]
grads:  [0.05178603]
Stock Position:  0.051786027367445135
Bond Position:  [5.85556913]


portfolio before change:  [10.85830091]
curr_Stock_Price:  96.57562016767149
curr_Factors:  [96.57562017]
mat_Sqrt:  [[0.15]]
grads:  [0.02509265]
Stock Position:  0.025092648093391064
Bond Position:  [8.43496286]


portfolio before change:  [10.84584387]
curr_Stock_Price:  95.9951296749463
curr_Factors:  [95.99512967]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998935]
Stock Position:  -0.019989347005926156
Bond Position:  [12.76472383]


portfolio before change:  [10.84077472]
curr_Stock_Price:  96.40838675043513
curr_Factors:  [96.40838675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.84077472]
Stock Price:  96.29946477356229
PL:  [10.84077472]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.93725120e-03]
 [-1.97506059e-03]
 [-3.58796384e-03]
 [-4.43139808e-04]
 [ 1.46760654e-03]
 [ 3.25239191e-03]
 [-1.51499364e-02]
 [ 1.20004901e-02]
 [ 4.73198877e-03]
 [ 8.23744066e-03]
 [-1.80709732e-02]
 [ 5.83223405e-03]
 [ 4.26618722e-03]
 [-3.76085217e-03]
 [-1.65686781e-02]
 [ 6.64057586e-03]
 [ 2.84597775e-03]
 [-2.44292698e-03]
 [-1.28062187e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.40377675]
curr_Stock_Price:  99.59952520956462
curr_Factors:  [99.59952521]
mat_Sqrt:  [[0.15]]
grads:  [0.01958167]
Stock Position:  0.01958167467226608
Bond Position:  [-6.35410225]


portfolio before change:  [-4.45672818]
curr_Stock_Price:  96.9765267075012
curr_Factors:  [96.97652671]
mat_Sqrt:  [[0.15]]
grads:  [-0.01316707]
Stock Position:  -0.01316707062696729
Bond Position:  [-3.1798314]


portfolio before change:  [-4.45591764]
curr_Stock_Price:  96.85458681885753
curr_Factors:  [96.85458682]
mat_Sqrt:  [[0.15]]
grads:  [-0.02391976]
Stock Position:  -0.023919758941719767
Bond Position:  [-2.13917927]


portfolio before change:  [-4.46359612]
curr_Stock_Price:  97.15323578593393
curr_Factors:  [97.15323579]
mat_Sqrt:  [[0.15]]
grads:  [-0.00295427]
Stock Position:  -0.002954265385079688
Bond Position:  [-4.17657968]


portfolio before change:  [-4.46864031]
curr_Stock_Price:  98.50718167931299
curr_Factors:  [98.50718168]
mat_Sqrt:  [[0.15]]
grads:  [0.00978404]
Stock Position:  0.009784043589719316
Bond Position:  [-5.43243887]


portfolio before change:  [-4.45236953]
curr_Stock_Price:  100.30899924152043
curr_Factors:  [100.30899924]
mat_Sqrt:  [[0.15]]
grads:  [0.02168261]
Stock Position:  0.02168261275660237
Bond Position:  [-6.62733071]


portfolio before change:  [-4.47370328]
curr_Stock_Price:  99.40151128381304
curr_Factors:  [99.40151128]
mat_Sqrt:  [[0.15]]
grads:  [-0.10099958]
Stock Position:  -0.10099957604155002
Bond Position:  [5.56580722]


portfolio before change:  [-4.42108675]
curr_Stock_Price:  98.89433196324454
curr_Factors:  [98.89433196]
mat_Sqrt:  [[0.15]]
grads:  [0.08000327]
Stock Position:  0.0800032676132482
Bond Position:  [-12.33295646]


portfolio before change:  [-4.49150695]
curr_Stock_Price:  98.0526591745042
curr_Factors:  [98.05265917]
mat_Sqrt:  [[0.15]]
grads:  [0.03154659]
Stock Position:  0.03154659177664715
Bond Position:  [-7.58473416]


portfolio before change:  [-4.49677956]
curr_Stock_Price:  97.94563680153628
curr_Factors:  [97.9456368]
mat_Sqrt:  [[0.15]]
grads:  [0.05491627]
Stock Position:  0.05491627106290952
Bond Position:  [-9.8755887]


portfolio before change:  [-4.51501965]
curr_Stock_Price:  97.65845626750132
curr_Factors:  [97.65845627]
mat_Sqrt:  [[0.15]]
grads:  [-0.12047315]
Stock Position:  -0.12047315484130579
Bond Position:  [7.25020267]


portfolio before change:  [-4.42235968]
curr_Stock_Price:  96.90436960991411
curr_Factors:  [96.90436961]
mat_Sqrt:  [[0.15]]
grads:  [0.03888156]
Stock Position:  0.038881560312064176
Bond Position:  [-8.19015277]


portfolio before change:  [-4.44593981]
curr_Stock_Price:  96.35057656553944
curr_Factors:  [96.35057657]
mat_Sqrt:  [[0.15]]
grads:  [0.02844125]
Stock Position:  0.02844124814931924
Bond Position:  [-7.18627047]


portfolio before change:  [-4.49578925]
curr_Stock_Price:  94.66103566146478
curr_Factors:  [94.66103566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507235]
Stock Position:  -0.025072347783841535
Bond Position:  [-2.12241485]


portfolio before change:  [-4.52453807]
curr_Stock_Price:  95.78650455939825
curr_Factors:  [95.78650456]
mat_Sqrt:  [[0.15]]
grads:  [-0.11045785]
Stock Position:  -0.11045785414544956
Bond Position:  [6.05583368]


portfolio before change:  [-4.54883721]
curr_Stock_Price:  96.02019814424608
curr_Factors:  [96.02019814]
mat_Sqrt:  [[0.15]]
grads:  [0.04427051]
Stock Position:  0.04427050571053813
Bond Position:  [-8.79969995]


portfolio before change:  [-4.60133062]
curr_Stock_Price:  94.88415504018303
curr_Factors:  [94.88415504]
mat_Sqrt:  [[0.15]]
grads:  [0.01897318]
Stock Position:  0.01897318497052805
Bond Position:  [-6.40158524]


portfolio before change:  [-4.56771163]
curr_Stock_Price:  96.7404371617185
curr_Factors:  [96.74043716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01628618]
Stock Position:  -0.0162861798437996
Bond Position:  [-2.99217947]


portfolio before change:  [-4.60900838]
curr_Stock_Price:  99.23019320550111
curr_Factors:  [99.23019321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.60900838]
Stock Price:  97.69761241464204
PL:  [-4.60900838]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.09710675e-03]
 [ 7.92098546e-03]
 [ 1.92709955e-04]
 [ 2.53909380e-03]
 [ 1.02328646e-03]
 [ 4.28858851e-03]
 [-1.28028047e-02]
 [ 9.96406980e-03]
 [ 3.98659371e-03]
 [ 9.07921840e-03]
 [-1.49831116e-02]
 [-7.59875110e-03]
 [-2.57880777e-02]
 [ 2.02005231e-03]
 [-6.69991139e-03]
 [ 7.84034190e-03]
 [ 5.05403094e-03]
 [-1.82314633e-03]
 [-1.28057798e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.29871356]
curr_Stock_Price:  100.68308864599965
curr_Factors:  [100.68308865]
mat_Sqrt:  [[0.15]]
grads:  [0.04064738]
Stock Position:  0.04064737832762458
Bond Position:  [8.20620997]


portfolio before change:  [12.29230613]
curr_Stock_Price:  100.47497578362322
curr_Factors:  [100.47497578]
mat_Sqrt:  [[0.15]]
grads:  [0.05280657]
Stock Position:  0.052806569754205716
Bond Position:  [6.98656731]


portfolio before change:  [12.21231904]
curr_Stock_Price:  98.92717687747104
curr_Factors:  [98.92717688]
mat_Sqrt:  [[0.15]]
grads:  [0.00128473]
Stock Position:  0.0012847330324916495
Bond Position:  [12.08522403]


portfolio before change:  [12.2152533]
curr_Stock_Price:  98.85912437756168
curr_Factors:  [98.85912438]
mat_Sqrt:  [[0.15]]
grads:  [0.01692729]
Stock Position:  0.016927292014031228
Bond Position:  [10.54183603]


portfolio before change:  [12.20922045]
curr_Stock_Price:  98.3470147220785
curr_Factors:  [98.34701472]
mat_Sqrt:  [[0.15]]
grads:  [0.00682191]
Stock Position:  0.006821909732214361
Bond Position:  [11.538306]


portfolio before change:  [12.21864011]
curr_Stock_Price:  99.30491572441467
curr_Factors:  [99.30491572]
mat_Sqrt:  [[0.15]]
grads:  [0.02859059]
Stock Position:  0.02859059007073179
Bond Position:  [9.37945397]


portfolio before change:  [12.21119942]
curr_Stock_Price:  98.96264094673771
curr_Factors:  [98.96264095]
mat_Sqrt:  [[0.15]]
grads:  [-0.08535203]
Stock Position:  -0.08535203120902303
Bond Position:  [20.65786184]


portfolio before change:  [12.27948513]
curr_Stock_Price:  98.22310850392233
curr_Factors:  [98.2231085]
mat_Sqrt:  [[0.15]]
grads:  [0.06642713]
Stock Position:  0.06642713200043822
Bond Position:  [5.75480574]


portfolio before change:  [12.32851051]
curr_Stock_Price:  98.93947982807789
curr_Factors:  [98.93947983]
mat_Sqrt:  [[0.15]]
grads:  [0.02657729]
Stock Position:  0.02657729136888744
Bond Position:  [9.69896712]


portfolio before change:  [12.38824892]
curr_Stock_Price:  101.09595867277655
curr_Factors:  [101.09595867]
mat_Sqrt:  [[0.15]]
grads:  [0.06052812]
Stock Position:  0.060528122670859344
Bond Position:  [6.26910033]


portfolio before change:  [12.44299216]
curr_Stock_Price:  101.97448874421507
curr_Factors:  [101.97448874]
mat_Sqrt:  [[0.15]]
grads:  [-0.09988741]
Stock Position:  -0.099887410402906
Bond Position:  [22.62895977]


portfolio before change:  [12.43518488]
curr_Stock_Price:  102.10929280608309
curr_Factors:  [102.10929281]
mat_Sqrt:  [[0.15]]
grads:  [-0.05065834]
Stock Position:  -0.05065834068275231
Bond Position:  [17.60787222]


portfolio before change:  [12.49851176]
curr_Stock_Price:  100.94612094157375
curr_Factors:  [100.94612094]
mat_Sqrt:  [[0.15]]
grads:  [-0.17192052]
Stock Position:  -0.17192051828016783
Bond Position:  [29.85322119]


portfolio before change:  [12.47482644]
curr_Stock_Price:  101.1273067161188
curr_Factors:  [101.12730672]
mat_Sqrt:  [[0.15]]
grads:  [0.01346702]
Stock Position:  0.013467015388764776
Bond Position:  [11.11294345]


portfolio before change:  [12.47004297]
curr_Stock_Price:  100.56578278751613
curr_Factors:  [100.56578279]
mat_Sqrt:  [[0.15]]
grads:  [-0.04466608]
Stock Position:  -0.04466607594536749
Bond Position:  [16.96192187]


portfolio before change:  [12.51581249]
curr_Stock_Price:  99.63602783301933
curr_Factors:  [99.63602783]
mat_Sqrt:  [[0.15]]
grads:  [0.05226895]
Stock Position:  0.052268945966769134
Bond Position:  [7.30794234]


portfolio before change:  [12.48080891]
curr_Stock_Price:  98.93138779625502
curr_Factors:  [98.9313878]
mat_Sqrt:  [[0.15]]
grads:  [0.03369354]
Stock Position:  0.03369353961877485
Bond Position:  [9.14746028]


portfolio before change:  [12.46656099]
curr_Stock_Price:  98.440638790412
curr_Factors:  [98.44063879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01215431]
Stock Position:  -0.012154308843591357
Bond Position:  [13.66303892]


portfolio before change:  [12.46070912]
curr_Stock_Price:  99.20317194573998
curr_Factors:  [99.20317195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.46070912]
Stock Price:  98.71529424077258
PL:  [12.46070912]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.90830981e-02]
 [ 6.16790535e-03]
 [ 1.07125279e-03]
 [ 1.49994368e-02]
 [ 2.47921177e-02]
 [ 6.28370523e-03]
 [ 3.04771759e-02]
 [-6.28053608e-03]
 [ 9.27777453e-03]
 [-1.30360939e-02]
 [-8.30953036e-03]
 [-3.73282141e-02]
 [-1.63046329e-02]
 [ 6.83989922e-03]
 [ 2.28418428e-02]
 [ 1.42918606e-03]
 [ 7.03210063e-03]
 [-5.18789064e-03]
 [-1.10317006e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.08171183]
curr_Stock_Price:  101.70700062023366
curr_Factors:  [101.70700062]
mat_Sqrt:  [[0.15]]
grads:  [0.12722065]
Stock Position:  0.12722065407947006
Bond Position:  [15.14248068]


portfolio before change:  [28.06387558]
curr_Stock_Price:  101.53704129937155
curr_Factors:  [101.5370413]
mat_Sqrt:  [[0.15]]
grads:  [0.04111937]
Stock Position:  0.041119369016710976
Bond Position:  [23.88873651]


portfolio before change:  [28.06916732]
curr_Stock_Price:  101.52047499421096
curr_Factors:  [101.52047499]
mat_Sqrt:  [[0.15]]
grads:  [0.00714169]
Stock Position:  0.007141685290379912
Bond Position:  [27.34414004]


portfolio before change:  [28.08361571]
curr_Stock_Price:  102.58626020313636
curr_Factors:  [102.5862602]
mat_Sqrt:  [[0.15]]
grads:  [0.09999625]
Stock Position:  0.09999624523415135
Bond Position:  [17.82537488]


portfolio before change:  [28.13856468]
curr_Stock_Price:  103.09119982336185
curr_Factors:  [103.09119982]
mat_Sqrt:  [[0.15]]
grads:  [0.16528078]
Stock Position:  0.16528078480531302
Bond Position:  [11.09957026]


portfolio before change:  [28.26014515]
curr_Stock_Price:  103.8100083459845
curr_Factors:  [103.81000835]
mat_Sqrt:  [[0.15]]
grads:  [0.04189137]
Stock Position:  0.04189136822006583
Bond Position:  [23.91140187]


portfolio before change:  [28.27746336]
curr_Stock_Price:  104.08069925628607
curr_Factors:  [104.08069926]
mat_Sqrt:  [[0.15]]
grads:  [0.20318117]
Stock Position:  0.20318117244193232
Bond Position:  [7.13022486]


portfolio before change:  [28.49421657]
curr_Stock_Price:  105.13872259953138
curr_Factors:  [105.1387226]
mat_Sqrt:  [[0.15]]
grads:  [-0.04187024]
Stock Position:  -0.04187024052228275
Bond Position:  [32.89640017]


portfolio before change:  [28.52992218]
curr_Stock_Price:  104.48239751200273
curr_Factors:  [104.48239751]
mat_Sqrt:  [[0.15]]
grads:  [0.06185183]
Stock Position:  0.06185183019521445
Bond Position:  [22.06749467]


portfolio before change:  [28.54281211]
curr_Stock_Price:  104.6015914131329
curr_Factors:  [104.60159141]
mat_Sqrt:  [[0.15]]
grads:  [-0.08690729]
Stock Position:  -0.08690729243715332
Bond Position:  [37.6334532]


portfolio before change:  [28.41865644]
curr_Stock_Price:  106.13846138039074
curr_Factors:  [106.13846138]
mat_Sqrt:  [[0.15]]
grads:  [-0.05539687]
Stock Position:  -0.055396869070505235
Bond Position:  [34.29839489]


portfolio before change:  [28.333841]
curr_Stock_Price:  107.82431668021245
curr_Factors:  [107.82431668]
mat_Sqrt:  [[0.15]]
grads:  [-0.24885476]
Stock Position:  -0.24885476072776544
Bond Position:  [55.16643553]


portfolio before change:  [28.34989663]
curr_Stock_Price:  107.81522588397358
curr_Factors:  [107.81522588]
mat_Sqrt:  [[0.15]]
grads:  [-0.10869755]
Stock Position:  -0.10869755266235857
Bond Position:  [40.06914782]


portfolio before change:  [28.50544076]
curr_Stock_Price:  106.47641382075122
curr_Factors:  [106.47641382]
mat_Sqrt:  [[0.15]]
grads:  [0.04559933]
Stock Position:  0.04559932815746389
Bond Position:  [23.65018783]


portfolio before change:  [28.39313453]
curr_Stock_Price:  103.88384235090473
curr_Factors:  [103.88384235]
mat_Sqrt:  [[0.15]]
grads:  [0.15227895]
Stock Position:  0.15227895196426816
Bond Position:  [12.57381189]


portfolio before change:  [28.46431063]
curr_Stock_Price:  104.33060304674586
curr_Factors:  [104.33060305]
mat_Sqrt:  [[0.15]]
grads:  [0.00952791]
Stock Position:  0.009527907076706418
Bond Position:  [27.47025833]


portfolio before change:  [28.47093581]
curr_Stock_Price:  104.30507444629556
curr_Factors:  [104.30507445]
mat_Sqrt:  [[0.15]]
grads:  [0.04688067]
Stock Position:  0.046880670855079264
Bond Position:  [23.58104395]


portfolio before change:  [28.45371977]
curr_Stock_Price:  103.8120771396109
curr_Factors:  [103.81207714]
mat_Sqrt:  [[0.15]]
grads:  [-0.03458594]
Stock Position:  -0.034585937572095674
Bond Position:  [32.04415779]


portfolio before change:  [28.44861337]
curr_Stock_Price:  104.1913770152931
curr_Factors:  [104.19137702]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.44861337]
Stock Price:  103.72925457118232
PL:  [24.7193588]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.97699351e-03]
 [ 5.91006423e-03]
 [ 1.29122736e-03]
 [ 2.95566546e-03]
 [ 1.32007450e-03]
 [ 4.57853917e-03]
 [-8.64187982e-03]
 [ 1.22512747e-02]
 [ 2.78028448e-03]
 [ 8.35727207e-03]
 [-1.62735434e-02]
 [-6.97538940e-03]
 [-2.60490611e-02]
 [ 2.02764336e-03]
 [ 4.98461973e-03]
 [ 7.77649015e-03]
 [ 7.47123442e-03]
 [-3.73455922e-03]
 [-1.18256993e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.99320231]
curr_Stock_Price:  100.66326879740836
curr_Factors:  [100.6632688]
mat_Sqrt:  [[0.15]]
grads:  [0.03984662]
Stock Position:  0.03984662339073384
Bond Position:  [7.98211095]


portfolio before change:  [12.01420703]
curr_Stock_Price:  101.14032159568256
curr_Factors:  [101.1403216]
mat_Sqrt:  [[0.15]]
grads:  [0.03940043]
Stock Position:  0.03940042816800241
Bond Position:  [8.02923505]


portfolio before change:  [11.94991861]
curr_Stock_Price:  99.4577009714084
curr_Factors:  [99.45770097]
mat_Sqrt:  [[0.15]]
grads:  [0.00860818]
Stock Position:  0.008608182368663909
Bond Position:  [11.09376859]


portfolio before change:  [11.95204765]
curr_Stock_Price:  99.38280144019208
curr_Factors:  [99.38280144]
mat_Sqrt:  [[0.15]]
grads:  [0.01970444]
Stock Position:  0.019704436391649004
Bond Position:  [9.99376556]


portfolio before change:  [11.9362449]
curr_Stock_Price:  98.45399984368113
curr_Factors:  [98.45399984]
mat_Sqrt:  [[0.15]]
grads:  [0.0088005]
Stock Position:  0.008800496679361482
Bond Position:  [11.0698008]


portfolio before change:  [11.93892631]
curr_Stock_Price:  98.44418391869067
curr_Factors:  [98.44418392]
mat_Sqrt:  [[0.15]]
grads:  [0.03052359]
Stock Position:  0.030523594479177307
Bond Position:  [8.93405596]


portfolio before change:  [11.98298403]
curr_Stock_Price:  99.81440037341525
curr_Factors:  [99.81440037]
mat_Sqrt:  [[0.15]]
grads:  [-0.05761253]
Stock Position:  -0.057612532115984785
Bond Position:  [17.73354438]


portfolio before change:  [12.00642307]
curr_Stock_Price:  99.4845225413062
curr_Factors:  [99.48452254]
mat_Sqrt:  [[0.15]]
grads:  [0.08167516]
Stock Position:  0.08167516475984249
Bond Position:  [3.8810083]


portfolio before change:  [12.04031852]
curr_Stock_Price:  99.8876447583843
curr_Factors:  [99.88764476]
mat_Sqrt:  [[0.15]]
grads:  [0.01853523]
Stock Position:  0.01853522988842569
Bond Position:  [10.18887806]


portfolio before change:  [12.05605586]
curr_Stock_Price:  100.59925218498097
curr_Factors:  [100.59925218]
mat_Sqrt:  [[0.15]]
grads:  [0.05571515]
Stock Position:  0.05571514710900725
Bond Position:  [6.45115373]


portfolio before change:  [12.07925688]
curr_Stock_Price:  100.98672363788755
curr_Factors:  [100.98672364]
mat_Sqrt:  [[0.15]]
grads:  [-0.10849029]
Stock Position:  -0.10849028935661756
Bond Position:  [23.03533575]


portfolio before change:  [12.07827572]
curr_Stock_Price:  101.04885554704862
curr_Factors:  [101.04885555]
mat_Sqrt:  [[0.15]]
grads:  [-0.0465026]
Stock Position:  -0.04650259603237649
Bond Position:  [16.77730983]


portfolio before change:  [12.11037323]
curr_Stock_Price:  100.44883192361333
curr_Factors:  [100.44883192]
mat_Sqrt:  [[0.15]]
grads:  [-0.17366041]
Stock Position:  -0.1736604072427891
Bond Position:  [29.55435829]


portfolio before change:  [11.9230067]
curr_Stock_Price:  101.57030828654322
curr_Factors:  [101.57030829]
mat_Sqrt:  [[0.15]]
grads:  [0.01351762]
Stock Position:  0.013517622409450192
Bond Position:  [10.55001763]


portfolio before change:  [11.93041046]
curr_Stock_Price:  101.922879250674
curr_Factors:  [101.92287925]
mat_Sqrt:  [[0.15]]
grads:  [0.0332308]
Stock Position:  0.03323079821173155
Bond Position:  [8.54343183]


portfolio before change:  [11.88295408]
curr_Stock_Price:  100.43051364934658
curr_Factors:  [100.43051365]
mat_Sqrt:  [[0.15]]
grads:  [0.05184327]
Stock Position:  0.051843267642188356
Bond Position:  [6.67630809]


portfolio before change:  [11.95232671]
curr_Stock_Price:  101.73643705249172
curr_Factors:  [101.73643705]
mat_Sqrt:  [[0.15]]
grads:  [0.04980823]
Stock Position:  0.04980822945361319
Bond Position:  [6.88501491]


portfolio before change:  [11.9552209]
curr_Stock_Price:  101.7599818274263
curr_Factors:  [101.75998183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02489706]
Stock Position:  -0.02489706144960097
Bond Position:  [14.48874542]


portfolio before change:  [11.93916454]
curr_Stock_Price:  102.550396425332
curr_Factors:  [102.55039643]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.93916454]
Stock Price:  104.36037615106244
PL:  [7.57878839]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.94954431e-03]
 [ 8.80842416e-03]
 [ 9.32392989e-04]
 [ 2.97536403e-03]
 [ 2.11201963e-03]
 [ 4.46969308e-03]
 [-7.78090303e-03]
 [ 8.99283532e-03]
 [ 4.68493213e-03]
 [-6.95157631e-03]
 [-1.78037212e-02]
 [ 6.16886517e-03]
 [ 1.39309706e-03]
 [-2.23492262e-03]
 [-1.66647466e-02]
 [ 6.62721796e-03]
 [ 3.48550570e-03]
 [-2.30451521e-03]
 [-1.27555072e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.04510246]
curr_Stock_Price:  99.88814341892159
curr_Factors:  [99.88814342]
mat_Sqrt:  [[0.15]]
grads:  [0.01299696]
Stock Position:  0.012996962064491913
Bond Position:  [-1.25313995]


portfolio before change:  [0.04714543]
curr_Stock_Price:  100.06943895168112
curr_Factors:  [100.06943895]
mat_Sqrt:  [[0.15]]
grads:  [0.05872283]
Stock Position:  0.05872282774577476
Bond Position:  [-5.829215]


portfolio before change:  [0.07705602]
curr_Stock_Price:  100.6036108019731
curr_Factors:  [100.6036108]
mat_Sqrt:  [[0.15]]
grads:  [0.00621595]
Stock Position:  0.006215953262250131
Bond Position:  [-0.54829132]


portfolio before change:  [0.06961959]
curr_Stock_Price:  99.4293194368603
curr_Factors:  [99.42931944]
mat_Sqrt:  [[0.15]]
grads:  [0.01983576]
Stock Position:  0.01983576022532988
Bond Position:  [-1.90263655]


portfolio before change:  [0.05546034]
curr_Stock_Price:  98.73947747159336
curr_Factors:  [98.73947747]
mat_Sqrt:  [[0.15]]
grads:  [0.01408013]
Stock Position:  0.014080130892309637
Bond Position:  [-1.33480443]


portfolio before change:  [0.06069044]
curr_Stock_Price:  99.13463352775825
curr_Factors:  [99.13463353]
mat_Sqrt:  [[0.15]]
grads:  [0.02979795]
Stock Position:  0.02979795385178466
Bond Position:  [-2.89331879]


portfolio before change:  [0.03259909]
curr_Stock_Price:  98.2161836500597
curr_Factors:  [98.21618365]
mat_Sqrt:  [[0.15]]
grads:  [-0.05187269]
Stock Position:  -0.05187268688679497
Bond Position:  [5.12733644]


portfolio before change:  [0.05648316]
curr_Stock_Price:  97.78046165205284
curr_Factors:  [97.78046165]
mat_Sqrt:  [[0.15]]
grads:  [0.05995224]
Stock Position:  0.05995223545934975
Bond Position:  [-5.8056741]


portfolio before change:  [0.02868995]
curr_Stock_Price:  97.341085030263
curr_Factors:  [97.34108503]
mat_Sqrt:  [[0.15]]
grads:  [0.03123288]
Stock Position:  0.03123288085597135
Bond Position:  [-3.01155256]


portfolio before change:  [-0.00723009]
curr_Stock_Price:  96.21512237765504
curr_Factors:  [96.21512238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634384]
Stock Position:  -0.04634384205277831
Bond Position:  [4.45174834]


portfolio before change:  [-0.037888]
curr_Stock_Price:  96.90067169743752
curr_Factors:  [96.9006717]
mat_Sqrt:  [[0.15]]
grads:  [-0.11869147]
Stock Position:  -0.11869147484021413
Bond Position:  [11.46339563]


portfolio before change:  [-0.00411579]
curr_Stock_Price:  96.6402822309124
curr_Factors:  [96.64028223]
mat_Sqrt:  [[0.15]]
grads:  [0.04112577]
Stock Position:  0.04112576778699569
Bond Position:  [-3.97852159]


portfolio before change:  [-0.00248168]
curr_Stock_Price:  96.70420468935583
curr_Factors:  [96.70420469]
mat_Sqrt:  [[0.15]]
grads:  [0.00928731]
Stock Position:  0.009287313736456073
Bond Position:  [-0.90060397]


portfolio before change:  [-0.00640415]
curr_Stock_Price:  96.30610379570558
curr_Factors:  [96.3061038]
mat_Sqrt:  [[0.15]]
grads:  [-0.01489948]
Stock Position:  -0.014899484109017319
Bond Position:  [1.42850711]


portfolio before change:  [-0.00338337]
curr_Stock_Price:  96.1273317440863
curr_Factors:  [96.12733174]
mat_Sqrt:  [[0.15]]
grads:  [-0.11109831]
Stock Position:  -0.11109831077390038
Bond Position:  [10.67620081]


portfolio before change:  [0.02099261]
curr_Stock_Price:  95.93194990908638
curr_Factors:  [95.93194991]
mat_Sqrt:  [[0.15]]
grads:  [0.04418145]
Stock Position:  0.044181453065573535
Bond Position:  [-4.21742033]


portfolio before change:  [0.02571148]
curr_Stock_Price:  96.06262359948214
curr_Factors:  [96.0626236]
mat_Sqrt:  [[0.15]]
grads:  [0.0232367]
Stock Position:  0.023236704668857296
Bond Position:  [-2.20646734]


portfolio before change:  [0.04522532]
curr_Stock_Price:  96.92615084963053
curr_Factors:  [96.92615085]
mat_Sqrt:  [[0.15]]
grads:  [-0.01536343]
Stock Position:  -0.015363434744844983
Bond Position:  [1.53434391]


portfolio before change:  [0.01905457]
curr_Stock_Price:  98.65456533235245
curr_Factors:  [98.65456533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.01905457]
Stock Price:  98.26740534798407
PL:  [0.01905457]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.10651274e-03]
 [ 8.62346727e-03]
 [ 1.37089873e-03]
 [ 5.00626551e-03]
 [ 1.56507407e-02]
 [ 3.31748572e-03]
 [ 2.24978089e-02]
 [ 7.98978430e-03]
 [ 6.84751428e-03]
 [ 5.99770827e-03]
 [-1.26093308e-02]
 [-8.29320109e-03]
 [-2.38435500e-02]
 [ 2.32721995e-03]
 [-1.28046849e-02]
 [ 7.88862923e-03]
 [ 7.46432903e-03]
 [-4.38299673e-03]
 [-1.17483533e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.36581292]
curr_Stock_Price:  100.88206476580058
curr_Factors:  [100.88206477]
mat_Sqrt:  [[0.15]]
grads:  [0.05404342]
Stock Position:  0.05404341827375623
Bond Position:  [9.91380129]


portfolio before change:  [15.33264821]
curr_Stock_Price:  100.22253078616532
curr_Factors:  [100.22253079]
mat_Sqrt:  [[0.15]]
grads:  [0.05748978]
Stock Position:  0.057489781768261805
Bond Position:  [9.57087678]


portfolio before change:  [15.31634723]
curr_Stock_Price:  99.89735998070451
curr_Factors:  [99.89735998]
mat_Sqrt:  [[0.15]]
grads:  [0.00913932]
Stock Position:  0.009139324847694497
Bond Position:  [14.4033528]


portfolio before change:  [15.32381818]
curr_Stock_Price:  100.3207683214209
curr_Factors:  [100.32076832]
mat_Sqrt:  [[0.15]]
grads:  [0.0333751]
Stock Position:  0.033375103430773635
Bond Position:  [11.97560216]


portfolio before change:  [15.34020587]
curr_Stock_Price:  100.72206792106904
curr_Factors:  [100.72206792]
mat_Sqrt:  [[0.15]]
grads:  [0.10433827]
Stock Position:  0.10433827155615728
Bond Position:  [4.8310394]


portfolio before change:  [15.244222]
curr_Stock_Price:  99.79056140071397
curr_Factors:  [99.7905614]
mat_Sqrt:  [[0.15]]
grads:  [0.02211657]
Stock Position:  0.022116571488859024
Bond Position:  [13.03719692]


portfolio before change:  [15.27310524]
curr_Stock_Price:  100.94912825950104
curr_Factors:  [100.94912826]
mat_Sqrt:  [[0.15]]
grads:  [0.14998539]
Stock Position:  0.14998539284781653
Bond Position:  [0.13221058]


portfolio before change:  [15.45236683]
curr_Stock_Price:  102.14410154483318
curr_Factors:  [102.14410154]
mat_Sqrt:  [[0.15]]
grads:  [0.05326523]
Stock Position:  0.0532652286585457
Bond Position:  [10.0116379]


portfolio before change:  [15.46054009]
curr_Stock_Price:  102.25055059651531
curr_Factors:  [102.2505506]
mat_Sqrt:  [[0.15]]
grads:  [0.0456501]
Stock Position:  0.045650095185028224
Bond Position:  [10.79279272]


portfolio before change:  [15.45504699]
curr_Stock_Price:  102.07110665641183
curr_Factors:  [102.07110666]
mat_Sqrt:  [[0.15]]
grads:  [0.03998472]
Stock Position:  0.03998472178930713
Bond Position:  [11.37376219]


portfolio before change:  [15.51478627]
curr_Stock_Price:  103.49403735279925
curr_Factors:  [103.49403735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08406221]
Stock Position:  -0.08406220533233179
Bond Position:  [24.21472329]


portfolio before change:  [15.58995991]
curr_Stock_Price:  102.67179863031764
curr_Factors:  [102.67179863]
mat_Sqrt:  [[0.15]]
grads:  [-0.05528801]
Stock Position:  -0.0552880072985175
Bond Position:  [21.26647906]


portfolio before change:  [15.65304028]
curr_Stock_Price:  101.62703170908546
curr_Factors:  [101.62703171]
mat_Sqrt:  [[0.15]]
grads:  [-0.158957]
Stock Position:  -0.15895699993247012
Bond Position:  [31.80736835]


portfolio before change:  [15.83363237]
curr_Stock_Price:  100.54095649078812
curr_Factors:  [100.54095649]
mat_Sqrt:  [[0.15]]
grads:  [0.0155148]
Stock Position:  0.015514799698706288
Bond Position:  [14.27375957]


portfolio before change:  [15.8225377]
curr_Stock_Price:  99.59582277016557
curr_Factors:  [99.59582277]
mat_Sqrt:  [[0.15]]
grads:  [-0.08536457]
Stock Position:  -0.08536456608353668
Bond Position:  [24.32449189]


portfolio before change:  [15.8461998]
curr_Stock_Price:  99.3898799513419
curr_Factors:  [99.38987995]
mat_Sqrt:  [[0.15]]
grads:  [0.05259086]
Stock Position:  0.05259086150824212
Bond Position:  [10.61920039]


portfolio before change:  [15.95069868]
curr_Stock_Price:  101.32640938835401
curr_Factors:  [101.32640939]
mat_Sqrt:  [[0.15]]
grads:  [0.04976219]
Stock Position:  0.04976219350008524
Bond Position:  [10.90847429]


portfolio before change:  [16.00066512]
curr_Stock_Price:  102.27570389854016
curr_Factors:  [102.2757039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02921998]
Stock Position:  -0.029219978209637787
Bond Position:  [18.98915896]


portfolio before change:  [15.99033031]
curr_Stock_Price:  102.79188112537713
curr_Factors:  [102.79188113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.99033031]
Stock Price:  103.79754378861287
PL:  [12.19278653]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.18390039e-02]
 [ 1.76210787e-03]
 [-7.24321522e-04]
 [ 2.66066615e-03]
 [ 6.87350817e-03]
 [ 4.55606867e-03]
 [-1.11727343e-02]
 [ 1.33144242e-02]
 [ 4.12064267e-03]
 [ 9.05979438e-03]
 [-1.46422808e-02]
 [-7.42593411e-03]
 [-2.44465231e-02]
 [ 1.98121289e-03]
 [ 1.06923501e-02]
 [ 7.50041534e-03]
 [ 7.48371145e-03]
 [-3.96550836e-03]
 [-1.22753329e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-35.75954457]
curr_Stock_Price:  97.56533971439796
curr_Factors:  [97.56533971]
mat_Sqrt:  [[0.15]]
grads:  [0.27892669]
Stock Position:  0.2789266928496055
Bond Position:  [-62.97312211]


portfolio before change:  [-35.68739476]
curr_Stock_Price:  97.88045856230673
curr_Factors:  [97.88045856]
mat_Sqrt:  [[0.15]]
grads:  [0.01174739]
Stock Position:  0.011747385781796696
Bond Position:  [-36.83723427]


portfolio before change:  [-35.68822723]
curr_Stock_Price:  98.59363764286283
curr_Factors:  [98.59363764]
mat_Sqrt:  [[0.15]]
grads:  [-0.00482881]
Stock Position:  -0.004828810147732874
Bond Position:  [-35.21213727]


portfolio before change:  [-35.69864408]
curr_Stock_Price:  98.927614872397
curr_Factors:  [98.92761487]
mat_Sqrt:  [[0.15]]
grads:  [0.01773777]
Stock Position:  0.017737774357119082
Bond Position:  [-37.45339979]


portfolio before change:  [-35.69167299]
curr_Stock_Price:  99.84856522416698
curr_Factors:  [99.84856522]
mat_Sqrt:  [[0.15]]
grads:  [0.04582339]
Stock Position:  0.045823387798128584
Bond Position:  [-40.26707252]


portfolio before change:  [-35.74152353]
curr_Stock_Price:  98.98039474088664
curr_Factors:  [98.98039474]
mat_Sqrt:  [[0.15]]
grads:  [0.03037379]
Stock Position:  0.030373791108668585
Bond Position:  [-38.74793336]


portfolio before change:  [-35.75814464]
curr_Stock_Price:  98.752141351599
curr_Factors:  [98.75214135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0744849]
Stock Position:  -0.07448489501062121
Bond Position:  [-28.40260176]


portfolio before change:  [-35.92349755]
curr_Stock_Price:  100.87675151296675
curr_Factors:  [100.87675151]
mat_Sqrt:  [[0.15]]
grads:  [0.08876283]
Stock Position:  0.08876282805512056
Bond Position:  [-44.8776033]


portfolio before change:  [-35.9320803]
curr_Stock_Price:  100.90647172798363
curr_Factors:  [100.90647173]
mat_Sqrt:  [[0.15]]
grads:  [0.02747095]
Stock Position:  0.027470951141028925
Bond Position:  [-38.70407705]


portfolio before change:  [-35.93700086]
curr_Stock_Price:  101.07962442188663
curr_Factors:  [101.07962442]
mat_Sqrt:  [[0.15]]
grads:  [0.06039863]
Stock Position:  0.06039862920374689
Bond Position:  [-42.04207162]


portfolio before change:  [-35.87770671]
curr_Stock_Price:  102.23537874523961
curr_Factors:  [102.23537875]
mat_Sqrt:  [[0.15]]
grads:  [-0.09761521]
Stock Position:  -0.09761520511374315
Bond Position:  [-25.89797925]


portfolio before change:  [-35.90162848]
curr_Stock_Price:  102.41410566977557
curr_Factors:  [102.41410567]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950623]
Stock Position:  -0.04950622742744718
Bond Position:  [-30.83149248]


portfolio before change:  [-35.8555757]
curr_Stock_Price:  101.32814890955267
curr_Factors:  [101.32814891]
mat_Sqrt:  [[0.15]]
grads:  [-0.16297682]
Stock Position:  -0.1629768204584437
Bond Position:  [-19.34143617]


portfolio before change:  [-35.8808559]
curr_Stock_Price:  101.4535914894679
curr_Factors:  [101.45359149]
mat_Sqrt:  [[0.15]]
grads:  [0.01320809]
Stock Position:  0.013208085944230155
Bond Position:  [-37.22086365]


portfolio before change:  [-35.87582437]
curr_Stock_Price:  102.53913126934347
curr_Factors:  [102.53913127]
mat_Sqrt:  [[0.15]]
grads:  [0.07128233]
Stock Position:  0.07128233401201284
Bond Position:  [-43.18505298]


portfolio before change:  [-36.0111837]
curr_Stock_Price:  100.79168973412551
curr_Factors:  [100.79168973]
mat_Sqrt:  [[0.15]]
grads:  [0.05000277]
Stock Position:  0.05000276895937856
Bond Position:  [-41.05104727]


portfolio before change:  [-36.00209006]
curr_Stock_Price:  101.17882183442045
curr_Factors:  [101.17882183]
mat_Sqrt:  [[0.15]]
grads:  [0.04989141]
Stock Position:  0.04989140963398588
Bond Position:  [-41.05004411]


portfolio before change:  [-35.97419487]
curr_Stock_Price:  101.94366270145463
curr_Factors:  [101.9436627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02643672]
Stock Position:  -0.026436722389688982
Bond Position:  [-33.27913856]


portfolio before change:  [-35.97060426]
curr_Stock_Price:  101.4930987497154
curr_Factors:  [101.49309875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-35.97060426]
Stock Price:  101.74521492113085
PL:  [-37.71581918]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.80639526e-03]
 [ 7.01032718e-03]
 [ 2.37772886e-03]
 [ 1.63674667e-02]
 [ 2.35939153e-02]
 [ 6.96536816e-03]
 [ 3.03724893e-02]
 [ 1.31608082e-02]
 [ 4.12136719e-03]
 [ 8.39681844e-03]
 [-1.71627438e-02]
 [ 4.55318588e-03]
 [-2.59961198e-02]
 [ 3.72426279e-03]
 [-1.46450976e-02]
 [ 7.91681153e-03]
 [ 4.44462875e-03]
 [-1.72420252e-03]
 [-1.25189657e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.52530816]
curr_Stock_Price:  100.30854264217568
curr_Factors:  [100.30854264]
mat_Sqrt:  [[0.15]]
grads:  [0.0387093]
Stock Position:  0.03870930175125389
Bond Position:  [2.64243451]


portfolio before change:  [6.61881769]
curr_Stock_Price:  102.70716086795032
curr_Factors:  [102.70716087]
mat_Sqrt:  [[0.15]]
grads:  [0.04673551]
Stock Position:  0.046735514551746994
Bond Position:  [1.81874568]


portfolio before change:  [6.66931897]
curr_Stock_Price:  103.7780068254023
curr_Factors:  [103.77800683]
mat_Sqrt:  [[0.15]]
grads:  [0.01585153]
Stock Position:  0.015851525701503236
Bond Position:  [5.02427922]


portfolio before change:  [6.66830903]
curr_Stock_Price:  103.63504482367928
curr_Factors:  [103.63504482]
mat_Sqrt:  [[0.15]]
grads:  [0.10911644]
Stock Position:  0.10911644450869361
Bond Position:  [-4.63997859]


portfolio before change:  [6.71059524]
curr_Stock_Price:  104.03320982271295
curr_Factors:  [104.03320982]
mat_Sqrt:  [[0.15]]
grads:  [0.15729277]
Stock Position:  0.1572927685257081
Bond Position:  [-9.65307635]


portfolio before change:  [6.38582614]
curr_Stock_Price:  101.98381155745423
curr_Factors:  [101.98381156]
mat_Sqrt:  [[0.15]]
grads:  [0.04643579]
Stock Position:  0.04643578771188575
Bond Position:  [1.65012752]


portfolio before change:  [6.37390585]
curr_Stock_Price:  101.71822165770743
curr_Factors:  [101.71822166]
mat_Sqrt:  [[0.15]]
grads:  [0.20248326]
Stock Position:  0.20248326213726595
Bond Position:  [-14.22233149]


portfolio before change:  [6.24280358]
curr_Stock_Price:  101.08831163185674
curr_Factors:  [101.08831163]
mat_Sqrt:  [[0.15]]
grads:  [0.08773872]
Stock Position:  0.08773872118146525
Bond Position:  [-2.62655561]


portfolio before change:  [6.23580025]
curr_Stock_Price:  101.01597632152796
curr_Factors:  [101.01597632]
mat_Sqrt:  [[0.15]]
grads:  [0.02747578]
Stock Position:  0.027475781284672814
Bond Position:  [3.46030738]


portfolio before change:  [6.21819883]
curr_Stock_Price:  100.34387146021183
curr_Factors:  [100.34387146]
mat_Sqrt:  [[0.15]]
grads:  [0.05597879]
Stock Position:  0.05597878957092459
Bond Position:  [0.60107037]


portfolio before change:  [6.20607851]
curr_Stock_Price:  100.12467049590497
curr_Factors:  [100.1246705]
mat_Sqrt:  [[0.15]]
grads:  [-0.11441829]
Stock Position:  -0.11441829196686389
Bond Position:  [17.6621723]


portfolio before change:  [6.25423448]
curr_Stock_Price:  99.74239013985637
curr_Factors:  [99.74239014]
mat_Sqrt:  [[0.15]]
grads:  [0.03035457]
Stock Position:  0.030354572507701773
Bond Position:  [3.22659686]


portfolio before change:  [6.28840058]
curr_Stock_Price:  100.84137963718437
curr_Factors:  [100.84137964]
mat_Sqrt:  [[0.15]]
grads:  [-0.17330747]
Stock Position:  -0.17330746525846455
Bond Position:  [23.76496448]


portfolio before change:  [6.51546001]
curr_Stock_Price:  99.56551167244358
curr_Factors:  [99.56551167]
mat_Sqrt:  [[0.15]]
grads:  [0.02482842]
Stock Position:  0.024828418586541116
Bond Position:  [4.04340581]


portfolio before change:  [6.50964348]
curr_Stock_Price:  99.29052395101482
curr_Factors:  [99.29052395]
mat_Sqrt:  [[0.15]]
grads:  [-0.09763398]
Stock Position:  -0.09763398374689994
Bond Position:  [16.20377288]


portfolio before change:  [6.51802062]
curr_Stock_Price:  99.24621878915053
curr_Factors:  [99.24621879]
mat_Sqrt:  [[0.15]]
grads:  [0.05277874]
Stock Position:  0.052778743526564885
Bond Position:  [1.27992989]


portfolio before change:  [6.46455361]
curr_Stock_Price:  98.22711474518887
curr_Factors:  [98.22711475]
mat_Sqrt:  [[0.15]]
grads:  [0.02963086]
Stock Position:  0.0296308583225169
Bond Position:  [3.55399989]


portfolio before change:  [6.48148143]
curr_Stock_Price:  98.76841582357343
curr_Factors:  [98.76841582]
mat_Sqrt:  [[0.15]]
grads:  [-0.01149468]
Stock Position:  -0.011494683438498278
Bond Position:  [7.61679311]


portfolio before change:  [6.46013083]
curr_Stock_Price:  100.79152838691849
curr_Factors:  [100.79152839]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.46013083]
Stock Price:  101.29187489947587
PL:  [5.16825593]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.10846739e-02]
 [ 7.62588020e-03]
 [-2.45550384e-03]
 [ 2.99182955e-03]
 [-8.32602117e-04]
 [-1.01934927e-03]
 [-3.97777974e-03]
 [ 5.80567108e-03]
 [ 4.55558223e-03]
 [-2.68208800e-02]
 [-1.73530481e-02]
 [ 9.93181416e-03]
 [ 3.07370414e-02]
 [-3.82451993e-03]
 [-1.59882791e-02]
 [ 6.15553191e-03]
 [ 2.45530507e-03]
 [-3.04555941e-03]
 [-1.25994664e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.33660501]
curr_Stock_Price:  99.21463674970083
curr_Factors:  [99.21463675]
mat_Sqrt:  [[0.15]]
grads:  [0.07389783]
Stock Position:  0.07389782590265999
Bond Position:  [-17.66835096]


portfolio before change:  [-10.35292672]
curr_Stock_Price:  99.05354850613045
curr_Factors:  [99.05354851]
mat_Sqrt:  [[0.15]]
grads:  [0.0508392]
Stock Position:  0.05083920130247426
Bond Position:  [-15.38873001]


portfolio before change:  [-10.43217056]
curr_Stock_Price:  97.57051611858438
curr_Factors:  [97.57051612]
mat_Sqrt:  [[0.15]]
grads:  [-0.01637003]
Stock Position:  -0.016370025629381953
Bond Position:  [-8.83493871]


portfolio before change:  [-10.46022156]
curr_Stock_Price:  99.14913216698487
curr_Factors:  [99.14913217]
mat_Sqrt:  [[0.15]]
grads:  [0.01994553]
Stock Position:  0.01994553031745954
Bond Position:  [-12.43780358]


portfolio before change:  [-10.49738691]
curr_Stock_Price:  97.44170633863305
curr_Factors:  [97.44170634]
mat_Sqrt:  [[0.15]]
grads:  [-0.00555068]
Stock Position:  -0.005550680781386957
Bond Position:  [-9.95651911]


portfolio before change:  [-10.49243693]
curr_Stock_Price:  96.10143489105286
curr_Factors:  [96.10143489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00679566]
Stock Position:  -0.0067956617908629625
Bond Position:  [-9.83936408]


portfolio before change:  [-10.49926423]
curr_Stock_Price:  96.74407199434545
curr_Factors:  [96.74407199]
mat_Sqrt:  [[0.15]]
grads:  [-0.02651853]
Stock Position:  -0.026518531608194278
Bond Position:  [-7.9337535]


portfolio before change:  [-10.50071605]
curr_Stock_Price:  96.72401576788003
curr_Factors:  [96.72401577]
mat_Sqrt:  [[0.15]]
grads:  [0.03870447]
Stock Position:  0.038704473887054405
Bond Position:  [-14.24436819]


portfolio before change:  [-10.55609959]
curr_Stock_Price:  95.38510080051113
curr_Factors:  [95.3851008]
mat_Sqrt:  [[0.15]]
grads:  [0.03037055]
Stock Position:  0.030370548211497497
Bond Position:  [-13.45299739]


portfolio before change:  [-10.61671369]
curr_Stock_Price:  93.50003677371377
curr_Factors:  [93.50003677]
mat_Sqrt:  [[0.15]]
grads:  [-0.17880587]
Stock Position:  -0.17880586659072598
Bond Position:  [6.10164142]


portfolio before change:  [-10.67768098]
curr_Stock_Price:  93.84953816018104
curr_Factors:  [93.84953816]
mat_Sqrt:  [[0.15]]
grads:  [-0.11568699]
Stock Position:  -0.1156869874999819
Bond Position:  [0.17948936]


portfolio before change:  [-10.69243123]
curr_Stock_Price:  93.97742741085918
curr_Factors:  [93.97742741]
mat_Sqrt:  [[0.15]]
grads:  [0.06621209]
Stock Position:  0.06621209438069972
Bond Position:  [-16.91487352]


portfolio before change:  [-10.75525546]
curr_Stock_Price:  93.09246840811156
curr_Factors:  [93.09246841]
mat_Sqrt:  [[0.15]]
grads:  [0.20491361]
Stock Position:  0.20491360923842117
Bond Position:  [-29.83116916]


portfolio before change:  [-10.45570818]
curr_Stock_Price:  94.59069008897416
curr_Factors:  [94.59069009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254968]
Stock Position:  -0.025496799503382166
Bond Position:  [-8.04394832]


portfolio before change:  [-10.4357081]
curr_Stock_Price:  93.72739290430107
curr_Factors:  [93.7273929]
mat_Sqrt:  [[0.15]]
grads:  [-0.10658853]
Stock Position:  -0.10658852749700867
Bond Position:  [-0.4454433]


portfolio before change:  [-10.42388417]
curr_Stock_Price:  93.61541738483804
curr_Factors:  [93.61541738]
mat_Sqrt:  [[0.15]]
grads:  [0.04103688]
Stock Position:  0.04103687940468097
Bond Position:  [-14.26556876]


portfolio before change:  [-10.40492838]
curr_Stock_Price:  94.16425614399564
curr_Factors:  [94.16425614]
mat_Sqrt:  [[0.15]]
grads:  [0.0163687]
Stock Position:  0.016368700446540575
Bond Position:  [-11.94627488]


portfolio before change:  [-10.378982]
curr_Stock_Price:  95.93185639207339
curr_Factors:  [95.93185639]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030373]
Stock Position:  -0.020303729388410446
Bond Position:  [-8.43120755]


portfolio before change:  [-10.3919709]
curr_Stock_Price:  96.46775987665167
curr_Factors:  [96.46775988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.3919709]
Stock Price:  96.3183390911464
PL:  [-10.3919709]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.06583028e-02]
 [ 9.63903628e-03]
 [ 1.46221365e-03]
 [ 2.59118815e-03]
 [-1.80339291e-03]
 [ 3.32874054e-04]
 [-4.47014894e-03]
 [ 8.94086713e-03]
 [ 3.87267120e-03]
 [ 9.16580147e-03]
 [-1.77791930e-02]
 [ 1.28786756e-03]
 [-1.94781895e-02]
 [-1.16590383e-03]
 [-1.70773933e-02]
 [ 7.23915609e-03]
 [ 4.43839305e-03]
 [-1.88998488e-03]
 [-1.27615851e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-34.58495334]
curr_Stock_Price:  97.64154057370193
curr_Factors:  [97.64154057]
mat_Sqrt:  [[0.15]]
grads:  [0.27105535]
Stock Position:  0.27105535200805425
Bond Position:  [-61.05121549]


portfolio before change:  [-34.12354574]
curr_Stock_Price:  99.40011979762643
curr_Factors:  [99.4001198]
mat_Sqrt:  [[0.15]]
grads:  [0.06426024]
Stock Position:  0.06426024187801241
Bond Position:  [-40.51102148]


portfolio before change:  [-34.11104325]
curr_Stock_Price:  99.75230501836897
curr_Factors:  [99.75230502]
mat_Sqrt:  [[0.15]]
grads:  [0.00974809]
Stock Position:  0.009748091004266364
Bond Position:  [-35.0834378]


portfolio before change:  [-34.12823153]
curr_Stock_Price:  98.8889232370323
curr_Factors:  [98.88892324]
mat_Sqrt:  [[0.15]]
grads:  [0.01727459]
Stock Position:  0.017274587692014065
Bond Position:  [-35.83649691]


portfolio before change:  [-34.16969198]
curr_Stock_Price:  97.00753495989828
curr_Factors:  [97.00753496]
mat_Sqrt:  [[0.15]]
grads:  [-0.01202262]
Stock Position:  -0.012022619422137818
Bond Position:  [-33.00340731]


portfolio before change:  [-34.17308865]
curr_Stock_Price:  96.60369487973304
curr_Factors:  [96.60369488]
mat_Sqrt:  [[0.15]]
grads:  [0.00221916]
Stock Position:  0.00221916036126336
Bond Position:  [-34.38746774]


portfolio before change:  [-34.18095213]
curr_Stock_Price:  96.9346580952293
curr_Factors:  [96.9346581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980099]
Stock Position:  -0.029800992946636733
Bond Position:  [-31.29220307]


portfolio before change:  [-34.21340037]
curr_Stock_Price:  97.7609462120616
curr_Factors:  [97.76094621]
mat_Sqrt:  [[0.15]]
grads:  [0.05960578]
Stock Position:  0.05960578089974446
Bond Position:  [-40.04051791]


portfolio before change:  [-34.14911318]
curr_Stock_Price:  99.00744563537906
curr_Factors:  [99.00744564]
mat_Sqrt:  [[0.15]]
grads:  [0.02581781]
Stock Position:  0.02581780800606706
Bond Position:  [-36.7052684]


portfolio before change:  [-34.1324847]
curr_Stock_Price:  100.0069860473807
curr_Factors:  [100.00698605]
mat_Sqrt:  [[0.15]]
grads:  [0.06110534]
Stock Position:  0.061105343112414896
Bond Position:  [-40.24344589]


portfolio before change:  [-34.16331065]
curr_Stock_Price:  99.66718221716556
curr_Factors:  [99.66718222]
mat_Sqrt:  [[0.15]]
grads:  [-0.11852795]
Stock Position:  -0.11852795320110561
Bond Position:  [-22.34996354]


portfolio before change:  [-34.23541442]
curr_Stock_Price:  100.22836281255161
curr_Factors:  [100.22836281]
mat_Sqrt:  [[0.15]]
grads:  [0.00858578]
Stock Position:  0.008585783734880108
Bond Position:  [-35.09595347]


portfolio before change:  [-34.25361094]
curr_Stock_Price:  99.13103322733153
curr_Factors:  [99.13103323]
mat_Sqrt:  [[0.15]]
grads:  [-0.1298546]
Stock Position:  -0.12985459689812584
Bond Position:  [-21.38099058]


portfolio before change:  [-34.03199557]
curr_Stock_Price:  97.38322223368465
curr_Factors:  [97.38322223]
mat_Sqrt:  [[0.15]]
grads:  [-0.00777269]
Stock Position:  -0.007772692176724763
Bond Position:  [-33.27506576]


portfolio before change:  [-34.03925548]
curr_Stock_Price:  97.24686115575274
curr_Factors:  [97.24686116]
mat_Sqrt:  [[0.15]]
grads:  [-0.11384929]
Stock Position:  -0.11384928848890329
Bond Position:  [-22.96776953]


portfolio before change:  [-34.0315521]
curr_Stock_Price:  97.128757250294
curr_Factors:  [97.12875725]
mat_Sqrt:  [[0.15]]
grads:  [0.04826104]
Stock Position:  0.048261040588333595
Bond Position:  [-38.71908699]


portfolio before change:  [-33.98339331]
curr_Stock_Price:  98.32723473499466
curr_Factors:  [98.32723473]
mat_Sqrt:  [[0.15]]
grads:  [0.02958929]
Stock Position:  0.029589286968223744
Bond Position:  [-36.89282607]


portfolio before change:  [-33.99581378]
curr_Stock_Price:  98.21921873772486
curr_Factors:  [98.21921874]
mat_Sqrt:  [[0.15]]
grads:  [-0.0125999]
Stock Position:  -0.012599899221113417
Bond Position:  [-32.75826152]


portfolio before change:  [-34.01009737]
curr_Stock_Price:  98.70279414786508
curr_Factors:  [98.70279415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.01009737]
Stock Price:  99.18877970649007
PL:  [-34.01009737]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.10008475e-03]
 [ 6.58591296e-03]
 [ 9.94795968e-04]
 [ 1.42273476e-02]
 [ 1.93083006e-02]
 [ 6.91131972e-03]
 [ 2.09311441e-02]
 [ 1.22711221e-02]
 [ 3.31271475e-03]
 [ 8.69491921e-03]
 [-1.59654458e-02]
 [ 3.93056849e-04]
 [-2.60702242e-02]
 [ 3.68780277e-03]
 [-1.42982649e-02]
 [ 7.92710375e-03]
 [ 6.92983285e-03]
 [-1.96038009e-03]
 [-1.26431325e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.07839389]
curr_Stock_Price:  99.7503829438365
curr_Factors:  [99.75038294]
mat_Sqrt:  [[0.15]]
grads:  [0.0073339]
Stock Position:  0.007333898306612375
Bond Position:  [-2.80995305]


portfolio before change:  [-2.07205924]
curr_Stock_Price:  100.7099304523043
curr_Factors:  [100.70993045]
mat_Sqrt:  [[0.15]]
grads:  [0.04390609]
Stock Position:  0.043906086396906414
Bond Position:  [-6.49383815]


portfolio before change:  [-2.04203463]
curr_Stock_Price:  101.4307478453524
curr_Factors:  [101.43074785]
mat_Sqrt:  [[0.15]]
grads:  [0.00663197]
Stock Position:  0.006631973118089921
Bond Position:  [-2.71472062]


portfolio before change:  [-2.03949939]
curr_Stock_Price:  101.91537072482438
curr_Factors:  [101.91537072]
mat_Sqrt:  [[0.15]]
grads:  [0.09484898]
Stock Position:  0.09484898406934555
Bond Position:  [-11.70606876]


portfolio before change:  [-2.11772468]
curr_Stock_Price:  101.12149397316394
curr_Factors:  [101.12149397]
mat_Sqrt:  [[0.15]]
grads:  [0.128722]
Stock Position:  0.1287220041506259
Bond Position:  [-15.13428604]


portfolio before change:  [-1.99187085]
curr_Stock_Price:  102.12860904625752
curr_Factors:  [102.12860905]
mat_Sqrt:  [[0.15]]
grads:  [0.04607546]
Stock Position:  0.046075464807685595
Bond Position:  [-6.69749398]


portfolio before change:  [-2.0519368]
curr_Stock_Price:  100.86131050740333
curr_Factors:  [100.86131051]
mat_Sqrt:  [[0.15]]
grads:  [0.13954096]
Stock Position:  0.13954096095267923
Bond Position:  [-16.12622099]


portfolio before change:  [-2.26761978]
curr_Stock_Price:  99.34454496546198
curr_Factors:  [99.34454497]
mat_Sqrt:  [[0.15]]
grads:  [0.08180748]
Stock Position:  0.08180748085674405
Bond Position:  [-10.39474674]


portfolio before change:  [-2.27061663]
curr_Stock_Price:  99.33968183989901
curr_Factors:  [99.33968184]
mat_Sqrt:  [[0.15]]
grads:  [0.02208477]
Stock Position:  0.02208476500607512
Bond Position:  [-4.46451016]


portfolio before change:  [-2.25250295]
curr_Stock_Price:  100.21041562486076
curr_Factors:  [100.21041562]
mat_Sqrt:  [[0.15]]
grads:  [0.05796613]
Stock Position:  0.057966128048035394
Bond Position:  [-8.06131273]


portfolio before change:  [-2.19584856]
curr_Stock_Price:  101.22255795405164
curr_Factors:  [101.22255795]
mat_Sqrt:  [[0.15]]
grads:  [-0.10643631]
Stock Position:  -0.10643630500133473
Bond Position:  [8.57790649]


portfolio before change:  [-2.09425312]
curr_Stock_Price:  100.28818976993784
curr_Factors:  [100.28818977]
mat_Sqrt:  [[0.15]]
grads:  [0.00262038]
Stock Position:  0.0026203789919513037
Bond Position:  [-2.35704618]


portfolio before change:  [-2.09359618]
curr_Stock_Price:  100.7637985990282
curr_Factors:  [100.7637986]
mat_Sqrt:  [[0.15]]
grads:  [-0.17380149]
Stock Position:  -0.17380149477651102
Bond Position:  [15.41930264]


portfolio before change:  [-1.94916664]
curr_Stock_Price:  99.95497801141676
curr_Factors:  [99.95497801]
mat_Sqrt:  [[0.15]]
grads:  [0.02458535]
Stock Position:  0.024585351798762072
Bond Position:  [-4.40659494]


portfolio before change:  [-1.96518975]
curr_Stock_Price:  99.3480586602468
curr_Factors:  [99.34805866]
mat_Sqrt:  [[0.15]]
grads:  [-0.09532177]
Stock Position:  -0.09532176590186915
Bond Position:  [7.50484264]


portfolio before change:  [-1.94860467]
curr_Stock_Price:  99.19375349489793
curr_Factors:  [99.19375349]
mat_Sqrt:  [[0.15]]
grads:  [0.05284736]
Stock Position:  0.052847358350681065
Bond Position:  [-7.19073251]


portfolio before change:  [-1.93068149]
curr_Stock_Price:  99.56692419608741
curr_Factors:  [99.5669242]
mat_Sqrt:  [[0.15]]
grads:  [0.04619889]
Stock Position:  0.046198885634970786
Bond Position:  [-6.53056243]


portfolio before change:  [-2.00922171]
curr_Stock_Price:  97.90222223991185
curr_Factors:  [97.90222224]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130692]
Stock Position:  -0.013069200608743527
Bond Position:  [-0.72971793]


portfolio before change:  [-1.99546589]
curr_Stock_Price:  96.83572476006684
curr_Factors:  [96.83572476]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.99546589]
Stock Price:  96.66477599949233
PL:  [-1.99546589]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.25980915e-02]
 [ 9.57518206e-03]
 [ 1.17833845e-03]
 [ 1.37596904e-02]
 [ 2.50923490e-02]
 [ 5.16893763e-03]
 [ 3.56092113e-02]
 [ 1.40172856e-03]
 [ 8.46017896e-03]
 [-8.24853975e-03]
 [-1.30963932e-02]
 [-1.71947053e-02]
 [-2.00395794e-02]
 [ 6.19196130e-03]
 [ 3.27421702e-02]
 [-3.32888924e-04]
 [ 6.65570947e-03]
 [-5.44745637e-03]
 [-1.09048869e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.39496751]
curr_Stock_Price:  99.14597615523627
curr_Factors:  [99.14597616]
mat_Sqrt:  [[0.15]]
grads:  [0.08398728]
Stock Position:  0.08398727672728977
Bond Position:  [-19.72196805]


portfolio before change:  [-11.38000714]
curr_Stock_Price:  99.38281539993105
curr_Factors:  [99.3828154]
mat_Sqrt:  [[0.15]]
grads:  [0.06383455]
Stock Position:  0.06383454709920924
Bond Position:  [-17.72406415]


portfolio before change:  [-11.326648]
curr_Stock_Price:  100.28813559297934
curr_Factors:  [100.28813559]
mat_Sqrt:  [[0.15]]
grads:  [0.00785559]
Stock Position:  0.007855589637274809
Bond Position:  [-12.11447044]


portfolio before change:  [-11.32060133]
curr_Stock_Price:  101.44344953752166
curr_Factors:  [101.44344954]
mat_Sqrt:  [[0.15]]
grads:  [0.09173127]
Stock Position:  0.09173126913751843
Bond Position:  [-20.6261377]


portfolio before change:  [-11.27428973]
curr_Stock_Price:  102.00453171211284
curr_Factors:  [102.00453171]
mat_Sqrt:  [[0.15]]
grads:  [0.16728233]
Stock Position:  0.16728232688742356
Bond Position:  [-28.33784514]


portfolio before change:  [-11.44453763]
curr_Stock_Price:  101.02915935887657
curr_Factors:  [101.02915936]
mat_Sqrt:  [[0.15]]
grads:  [0.03445958]
Stock Position:  0.034459584213649815
Bond Position:  [-14.92596045]


portfolio before change:  [-11.38736563]
curr_Stock_Price:  102.79656203690058
curr_Factors:  [102.79656204]
mat_Sqrt:  [[0.15]]
grads:  [0.23739474]
Stock Position:  0.23739474181640963
Bond Position:  [-35.79072893]


portfolio before change:  [-11.2293589]
curr_Stock_Price:  103.49984436608318
curr_Factors:  [103.49984437]
mat_Sqrt:  [[0.15]]
grads:  [0.00934486]
Stock Position:  0.00934485707540495
Bond Position:  [-12.19655015]


portfolio before change:  [-11.23818231]
curr_Stock_Price:  102.88197549989066
curr_Factors:  [102.8819755]
mat_Sqrt:  [[0.15]]
grads:  [0.05640119]
Stock Position:  0.05640119306619864
Bond Position:  [-17.04084848]


portfolio before change:  [-11.17977291]
curr_Stock_Price:  103.9931247746956
curr_Factors:  [103.99312477]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499026]
Stock Position:  -0.05499026497551179
Bond Position:  [-5.46116343]


portfolio before change:  [-11.13722117]
curr_Stock_Price:  103.19448870649852
curr_Factors:  [103.19448871]
mat_Sqrt:  [[0.15]]
grads:  [-0.08730929]
Stock Position:  -0.08730928771526045
Bond Position:  [-2.12738386]


portfolio before change:  [-11.23754687]
curr_Stock_Price:  104.33748042993938
curr_Factors:  [104.33748043]
mat_Sqrt:  [[0.15]]
grads:  [-0.11463137]
Stock Position:  -0.11463136872130705
Bond Position:  [0.72280132]


portfolio before change:  [-11.324794]
curr_Stock_Price:  105.10016740574055
curr_Factors:  [105.10016741]
mat_Sqrt:  [[0.15]]
grads:  [-0.1335972]
Stock Position:  -0.13359719583062304
Bond Position:  [2.71629365]


portfolio before change:  [-11.4379074]
curr_Stock_Price:  105.95192598251067
curr_Factors:  [105.95192598]
mat_Sqrt:  [[0.15]]
grads:  [0.04127974]
Stock Position:  0.04127974199559866
Bond Position:  [-15.81157557]


portfolio before change:  [-11.46981906]
curr_Stock_Price:  105.27463796952507
curr_Factors:  [105.27463797]
mat_Sqrt:  [[0.15]]
grads:  [0.21828113]
Stock Position:  0.2182811343775641
Bond Position:  [-34.44928646]


portfolio before change:  [-11.21759654]
curr_Stock_Price:  106.46959197860977
curr_Factors:  [106.46959198]
mat_Sqrt:  [[0.15]]
grads:  [-0.00221926]
Stock Position:  -0.0022192594913307204
Bond Position:  [-10.98131289]


portfolio before change:  [-11.21806791]
curr_Stock_Price:  105.44478904331658
curr_Factors:  [105.44478904]
mat_Sqrt:  [[0.15]]
grads:  [0.0443714]
Stock Position:  0.04437139649654572
Bond Position:  [-15.89680046]


portfolio before change:  [-11.19834493]
curr_Stock_Price:  105.97886452255032
curr_Factors:  [105.97886452]
mat_Sqrt:  [[0.15]]
grads:  [-0.03631638]
Stock Position:  -0.0363163758030489
Bond Position:  [-7.34957666]


portfolio before change:  [-11.14327581]
curr_Stock_Price:  104.41189252988002
curr_Factors:  [104.41189253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.14327581]
Stock Price:  103.95943296734654
PL:  [-15.10270878]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.05515024e-03]
 [ 6.04255360e-03]
 [ 1.45629382e-03]
 [ 3.54013459e-03]
 [ 4.50576765e-03]
 [ 3.21744970e-03]
 [-1.37080693e-02]
 [ 1.27972027e-02]
 [ 3.20572633e-03]
 [ 9.69613644e-03]
 [-1.71159530e-02]
 [-8.68446442e-03]
 [-2.12576640e-02]
 [ 2.67494862e-03]
 [-1.63712798e-02]
 [ 7.30139310e-03]
 [ 4.43988608e-03]
 [-1.85296415e-03]
 [-1.27295966e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.24805482]
curr_Stock_Price:  100.03105855235243
curr_Factors:  [100.03105855]
mat_Sqrt:  [[0.15]]
grads:  [0.02036767]
Stock Position:  0.020367668241953477
Bond Position:  [0.21065541]


portfolio before change:  [2.26798816]
curr_Stock_Price:  101.00714784669063
curr_Factors:  [101.00714785]
mat_Sqrt:  [[0.15]]
grads:  [0.04028369]
Stock Position:  0.04028369068822776
Bond Position:  [-1.80095254]


portfolio before change:  [2.21347124]
curr_Stock_Price:  99.66500126326865
curr_Factors:  [99.66500126]
mat_Sqrt:  [[0.15]]
grads:  [0.00970863]
Stock Position:  0.009708625480092058
Bond Position:  [1.24586107]


portfolio before change:  [2.21745207]
curr_Stock_Price:  100.04294618870479
curr_Factors:  [100.04294619]
mat_Sqrt:  [[0.15]]
grads:  [0.0236009]
Stock Position:  0.023600897247554493
Bond Position:  [-0.14365122]


portfolio before change:  [2.20483739]
curr_Stock_Price:  99.5099680272158
curr_Factors:  [99.50996803]
mat_Sqrt:  [[0.15]]
grads:  [0.03003845]
Stock Position:  0.030038451016776217
Bond Position:  [-0.78428791]


portfolio before change:  [2.22617728]
curr_Stock_Price:  100.22691502264647
curr_Factors:  [100.22691502]
mat_Sqrt:  [[0.15]]
grads:  [0.02144966]
Stock Position:  0.021449664670483266
Bond Position:  [0.07634356]


portfolio before change:  [2.21067552]
curr_Stock_Price:  99.50332142331905
curr_Factors:  [99.50332142]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138713]
Stock Position:  -0.09138712843954146
Bond Position:  [11.30399834]


portfolio before change:  [2.25133119]
curr_Stock_Price:  99.08937567332643
curr_Factors:  [99.08937567]
mat_Sqrt:  [[0.15]]
grads:  [0.08531468]
Stock Position:  0.08531468444923242
Bond Position:  [-6.20244763]


portfolio before change:  [2.34827889]
curr_Stock_Price:  100.24390733053548
curr_Factors:  [100.24390733]
mat_Sqrt:  [[0.15]]
grads:  [0.02137151]
Stock Position:  0.02137150888747467
Bond Position:  [0.20591533]


portfolio before change:  [2.33837049]
curr_Stock_Price:  99.77787183213142
curr_Factors:  [99.77787183]
mat_Sqrt:  [[0.15]]
grads:  [0.06464091]
Stock Position:  0.06464090959632271
Bond Position:  [-4.1113619]


portfolio before change:  [2.36210224]
curr_Stock_Price:  100.16090665979908
curr_Factors:  [100.16090666]
mat_Sqrt:  [[0.15]]
grads:  [-0.11410635]
Stock Position:  -0.11410635307453831
Bond Position:  [13.79109802]


portfolio before change:  [2.19254571]
curr_Stock_Price:  101.67707765139433
curr_Factors:  [101.67707765]
mat_Sqrt:  [[0.15]]
grads:  [-0.05789643]
Stock Position:  -0.057896429462777926
Bond Position:  [8.07928546]


portfolio before change:  [2.32932698]
curr_Stock_Price:  99.3494522002195
curr_Factors:  [99.3494522]
mat_Sqrt:  [[0.15]]
grads:  [-0.14171776]
Stock Position:  -0.14171775969475273
Bond Position:  [16.40890877]


portfolio before change:  [2.34838412]
curr_Stock_Price:  99.24392979460337
curr_Factors:  [99.24392979]
mat_Sqrt:  [[0.15]]
grads:  [0.01783299]
Stock Position:  0.017832990768490257
Bond Position:  [0.57856804]


portfolio before change:  [2.33429448]
curr_Stock_Price:  98.4457292074799
curr_Factors:  [98.44572921]
mat_Sqrt:  [[0.15]]
grads:  [-0.10914187]
Stock Position:  -0.10914186545790981
Bond Position:  [13.07884501]


portfolio before change:  [2.43577874]
curr_Stock_Price:  97.54585324243708
curr_Factors:  [97.54585324]
mat_Sqrt:  [[0.15]]
grads:  [0.04867595]
Stock Position:  0.04867595397032166
Bond Position:  [-2.31235872]


portfolio before change:  [2.47261345]
curr_Stock_Price:  98.31446426936391
curr_Factors:  [98.31446427]
mat_Sqrt:  [[0.15]]
grads:  [0.02959924]
Stock Position:  0.029599240521911194
Bond Position:  [-0.43742002]


portfolio before change:  [2.50440635]
curr_Stock_Price:  99.39227126865887
curr_Factors:  [99.39227127]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235309]
Stock Position:  -0.01235309435137351
Bond Position:  [3.73220846]


portfolio before change:  [2.51816637]
curr_Stock_Price:  98.35391979105722
curr_Factors:  [98.35391979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.51816637]
Stock Price:  96.92872775179706
PL:  [2.51816637]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.73802651e-02]
 [ 8.38431587e-03]
 [ 1.13631228e-03]
 [ 7.13431691e-03]
 [ 1.23538357e-02]
 [ 3.51282212e-03]
 [ 1.10299668e-02]
 [ 5.13685087e-03]
 [ 4.38659388e-03]
 [ 5.13230233e-03]
 [-1.27193136e-02]
 [-1.63423549e-02]
 [-2.13848346e-02]
 [ 2.86958248e-03]
 [ 1.24116482e-02]
 [ 1.79475387e-03]
 [ 6.35948323e-03]
 [-5.33677293e-03]
 [-1.07294037e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.7857758]
curr_Stock_Price:  98.92599962406794
curr_Factors:  [98.92599962]
mat_Sqrt:  [[0.15]]
grads:  [0.11586843]
Stock Position:  0.11586843405426878
Bond Position:  [-26.24817646]


portfolio before change:  [-14.76319887]
curr_Stock_Price:  99.17749002559816
curr_Factors:  [99.17749003]
mat_Sqrt:  [[0.15]]
grads:  [0.05589544]
Stock Position:  0.05589543916604332
Bond Position:  [-20.30676823]


portfolio before change:  [-14.75909092]
curr_Stock_Price:  99.34181952900204
curr_Factors:  [99.34181953]
mat_Sqrt:  [[0.15]]
grads:  [0.00757542]
Stock Position:  0.007575415173251774
Bond Position:  [-15.51164645]


portfolio before change:  [-14.75410889]
curr_Stock_Price:  100.51144897662648
curr_Factors:  [100.51144898]
mat_Sqrt:  [[0.15]]
grads:  [0.04756211]
Stock Position:  0.04756211275750924
Bond Position:  [-19.53464576]


portfolio before change:  [-14.76311448]
curr_Stock_Price:  100.42479775203671
curr_Factors:  [100.42479775]
mat_Sqrt:  [[0.15]]
grads:  [0.0823589]
Stock Position:  0.08235890443788879
Bond Position:  [-23.0339908]


portfolio before change:  [-14.75513234]
curr_Stock_Price:  100.59164495074702
curr_Factors:  [100.59164495]
mat_Sqrt:  [[0.15]]
grads:  [0.02341881]
Stock Position:  0.023418814129318184
Bond Position:  [-17.11086938]


portfolio before change:  [-14.75984942]
curr_Stock_Price:  100.57290693619142
curr_Factors:  [100.57290694]
mat_Sqrt:  [[0.15]]
grads:  [0.07353311]
Stock Position:  0.07353311219912738
Bond Position:  [-22.15528827]


portfolio before change:  [-14.60875504]
curr_Stock_Price:  102.70302065043201
curr_Factors:  [102.70302065]
mat_Sqrt:  [[0.15]]
grads:  [0.03424567]
Stock Position:  0.034245672482150276
Bond Position:  [-18.12588905]


portfolio before change:  [-14.65839713]
curr_Stock_Price:  101.38577253275798
curr_Factors:  [101.38577253]
mat_Sqrt:  [[0.15]]
grads:  [0.02924396]
Stock Position:  0.029243959203678147
Bond Position:  [-17.62331852]


portfolio before change:  [-14.63934724]
curr_Stock_Price:  102.1878620224231
curr_Factors:  [102.18786202]
mat_Sqrt:  [[0.15]]
grads:  [0.03421535]
Stock Position:  0.034215348838991966
Bond Position:  [-18.13574058]


portfolio before change:  [-14.60150484]
curr_Stock_Price:  103.42639670869983
curr_Factors:  [103.42639671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08479542]
Stock Position:  -0.08479542428203345
Bond Position:  [-5.83141965]


portfolio before change:  [-14.66770154]
curr_Stock_Price:  104.18986550100547
curr_Factors:  [104.1898655]
mat_Sqrt:  [[0.15]]
grads:  [-0.10894903]
Stock Position:  -0.10894903234237627
Bond Position:  [-3.31631651]


portfolio before change:  [-14.56314322]
curr_Stock_Price:  103.22255541448375
curr_Factors:  [103.22255541]
mat_Sqrt:  [[0.15]]
grads:  [-0.14256556]
Stock Position:  -0.14256556433214712
Bond Position:  [0.15283864]


portfolio before change:  [-14.48376795]
curr_Stock_Price:  102.66606013244913
curr_Factors:  [102.66606013]
mat_Sqrt:  [[0.15]]
grads:  [0.01913055]
Stock Position:  0.019130549897678848
Bond Position:  [-16.44782613]


portfolio before change:  [-14.48728926]
curr_Stock_Price:  102.69696130116186
curr_Factors:  [102.6969613]
mat_Sqrt:  [[0.15]]
grads:  [0.08274432]
Stock Position:  0.08274432117122094
Bond Position:  [-22.98487961]


portfolio before change:  [-14.39458057]
curr_Stock_Price:  103.88683901173597
curr_Factors:  [103.88683901]
mat_Sqrt:  [[0.15]]
grads:  [0.01196503]
Stock Position:  0.011965025828706214
Bond Position:  [-15.63758929]


portfolio before change:  [-14.36911722]
curr_Stock_Price:  106.34176381694513
curr_Factors:  [106.34176382]
mat_Sqrt:  [[0.15]]
grads:  [0.04239655]
Stock Position:  0.04239655489532322
Bond Position:  [-18.87764165]


portfolio before change:  [-14.42878583]
curr_Stock_Price:  105.04570071023007
curr_Factors:  [105.04570071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03557849]
Stock Position:  -0.03557848621672592
Bond Position:  [-10.69141882]


portfolio before change:  [-14.42538941]
curr_Stock_Price:  104.87510292437771
curr_Factors:  [104.87510292]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.42538941]
Stock Price:  104.96795815129492
PL:  [-19.39334756]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.09407549e-03]
 [ 8.32959808e-03]
 [ 1.44645747e-03]
 [ 3.22810847e-03]
 [ 5.90380170e-03]
 [ 4.45427541e-03]
 [ 2.46066208e-02]
 [ 1.31438862e-02]
 [ 4.28038188e-03]
 [ 9.21997322e-03]
 [-1.60146436e-02]
 [-8.69041367e-03]
 [-2.08660487e-02]
 [ 5.38746735e-03]
 [ 3.55390107e-02]
 [ 9.09679005e-04]
 [ 6.55802799e-03]
 [-5.43592739e-03]
 [-1.04878259e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.5423887]
curr_Stock_Price:  99.59053284753062
curr_Factors:  [99.59053285]
mat_Sqrt:  [[0.15]]
grads:  [0.02062717]
Stock Position:  0.020627169949921597
Bond Position:  [-6.59665955]


portfolio before change:  [-4.52727782]
curr_Stock_Price:  100.40306549979795
curr_Factors:  [100.4030655]
mat_Sqrt:  [[0.15]]
grads:  [0.05553065]
Stock Position:  0.055530653884979964
Bond Position:  [-10.1027257]


portfolio before change:  [-4.56471167]
curr_Stock_Price:  99.77444246026123
curr_Factors:  [99.77444246]
mat_Sqrt:  [[0.15]]
grads:  [0.00964305]
Stock Position:  0.00964304976676598
Bond Position:  [-5.52684158]


portfolio before change:  [-4.56486745]
curr_Stock_Price:  99.90159084976439
curr_Factors:  [99.90159085]
mat_Sqrt:  [[0.15]]
grads:  [0.02152072]
Stock Position:  0.021520723141258646
Bond Position:  [-6.71482193]


portfolio before change:  [-4.57140643]
curr_Stock_Price:  99.67575893167702
curr_Factors:  [99.67575893]
mat_Sqrt:  [[0.15]]
grads:  [0.03935868]
Stock Position:  0.03935867796829179
Bond Position:  [-8.49451253]


portfolio before change:  [-4.59312507]
curr_Stock_Price:  99.17790816536777
curr_Factors:  [99.17790817]
mat_Sqrt:  [[0.15]]
grads:  [0.02969517]
Stock Position:  0.029695169399309423
Bond Position:  [-7.53822986]


portfolio before change:  [-4.53630778]
curr_Stock_Price:  101.1547310289808
curr_Factors:  [101.15473103]
mat_Sqrt:  [[0.15]]
grads:  [0.16404414]
Stock Position:  0.1640441384043859
Bond Position:  [-21.13014848]


portfolio before change:  [-4.54866365]
curr_Stock_Price:  101.11161657923667
curr_Factors:  [101.11161658]
mat_Sqrt:  [[0.15]]
grads:  [0.08762591]
Stock Position:  0.0876259080627771
Bond Position:  [-13.40866087]


portfolio before change:  [-4.54074534]
curr_Stock_Price:  101.24024165205196
curr_Factors:  [101.24024165]
mat_Sqrt:  [[0.15]]
grads:  [0.02853588]
Stock Position:  0.028535879186938198
Bond Position:  [-7.42972465]


portfolio before change:  [-4.54307199]
curr_Stock_Price:  101.22380686736709
curr_Factors:  [101.22380687]
mat_Sqrt:  [[0.15]]
grads:  [0.06146649]
Stock Position:  0.061466488113070136
Bond Position:  [-10.76494391]


portfolio before change:  [-4.54815507]
curr_Stock_Price:  101.18489931091968
curr_Factors:  [101.18489931]
mat_Sqrt:  [[0.15]]
grads:  [-0.10676429]
Stock Position:  -0.10676429061891732
Bond Position:  [6.25477893]


portfolio before change:  [-4.6057645]
curr_Stock_Price:  101.73914195011844
curr_Factors:  [101.73914195]
mat_Sqrt:  [[0.15]]
grads:  [-0.05793609]
Stock Position:  -0.057936091118964625
Bond Position:  [1.2886037]


portfolio before change:  [-4.7290218]
curr_Stock_Price:  103.87217314864762
curr_Factors:  [103.87217315]
mat_Sqrt:  [[0.15]]
grads:  [-0.13910699]
Stock Position:  -0.1391069911158854
Bond Position:  [9.72032367]


portfolio before change:  [-4.92531093]
curr_Stock_Price:  105.30071037170465
curr_Factors:  [105.30071037]
mat_Sqrt:  [[0.15]]
grads:  [0.03591645]
Stock Position:  0.03591644901579416
Bond Position:  [-8.70733853]


portfolio before change:  [-4.91431291]
curr_Stock_Price:  105.66753746511054
curr_Factors:  [105.66753747]
mat_Sqrt:  [[0.15]]
grads:  [0.23692674]
Stock Position:  0.23692673825389018
Bond Position:  [-29.9497779]


portfolio before change:  [-5.08914336]
curr_Stock_Price:  104.96123446364757
curr_Factors:  [104.96123446]
mat_Sqrt:  [[0.15]]
grads:  [0.00606453]
Stock Position:  0.006064526697769079
Bond Position:  [-5.72568357]


portfolio before change:  [-5.08584866]
curr_Stock_Price:  105.74056913976656
curr_Factors:  [105.74056914]
mat_Sqrt:  [[0.15]]
grads:  [0.04372019]
Stock Position:  0.0437201866114337
Bond Position:  [-9.70884608]


portfolio before change:  [-5.088274]
curr_Stock_Price:  105.74061903618991
curr_Factors:  [105.74061904]
mat_Sqrt:  [[0.15]]
grads:  [-0.03623952]
Stock Position:  -0.036239515946912854
Bond Position:  [-1.25628515]


portfolio before change:  [-5.08033127]
curr_Stock_Price:  105.51277820405222
curr_Factors:  [105.5127782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.08033127]
Stock Price:  106.90209507532165
PL:  [-11.98242634]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.36984900e-03]
 [ 8.63051174e-03]
 [ 1.29474782e-03]
 [ 1.11396087e-02]
 [ 1.46345523e-02]
 [ 4.62485281e-03]
 [-6.75894268e-03]
 [ 6.89592870e-03]
 [ 4.72469165e-03]
 [ 1.14929878e-02]
 [-1.85372789e-02]
 [ 6.20822273e-03]
 [-1.73488336e-02]
 [-1.66514262e-03]
 [-1.68626238e-02]
 [ 6.59959502e-03]
 [ 3.11080668e-03]
 [-3.49668439e-03]
 [-1.12870100e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.8914603]
curr_Stock_Price:  100.26742216560207
curr_Factors:  [100.26742217]
mat_Sqrt:  [[0.15]]
grads:  [0.03579899]
Stock Position:  0.03579899335067776
Bond Position:  [2.30198752]


portfolio before change:  [5.89014914]
curr_Stock_Price:  100.21471858485008
curr_Factors:  [100.21471858]
mat_Sqrt:  [[0.15]]
grads:  [0.05753674]
Stock Position:  0.0575367449182791
Bond Position:  [0.12412044]


portfolio before change:  [5.88081201]
curr_Stock_Price:  100.05189817771532
curr_Factors:  [100.05189818]
mat_Sqrt:  [[0.15]]
grads:  [0.00863165]
Stock Position:  0.008631652110128576
Bond Position:  [5.01719884]


portfolio before change:  [5.88965026]
curr_Stock_Price:  100.93050071343444
curr_Factors:  [100.93050071]
mat_Sqrt:  [[0.15]]
grads:  [0.07426406]
Stock Position:  0.07426405812806483
Bond Position:  [-1.60585831]


portfolio before change:  [5.86696516]
curr_Stock_Price:  100.63044183311447
curr_Factors:  [100.63044183]
mat_Sqrt:  [[0.15]]
grads:  [0.09756368]
Stock Position:  0.09756368185776974
Bond Position:  [-3.95091126]


portfolio before change:  [5.69300926]
curr_Stock_Price:  98.85756856471369
curr_Factors:  [98.85756856]
mat_Sqrt:  [[0.15]]
grads:  [0.03083235]
Stock Position:  0.030832352082827762
Bond Position:  [2.6449979]


portfolio before change:  [5.66169853]
curr_Stock_Price:  97.82060358847481
curr_Factors:  [97.82060359]
mat_Sqrt:  [[0.15]]
grads:  [-0.04505962]
Stock Position:  -0.045059617872900276
Bond Position:  [10.06945754]


portfolio before change:  [5.70150693]
curr_Stock_Price:  96.99301725421549
curr_Factors:  [96.99301725]
mat_Sqrt:  [[0.15]]
grads:  [0.04597286]
Stock Position:  0.04597285799263547
Bond Position:  [1.24246072]


portfolio before change:  [5.7454595]
curr_Stock_Price:  97.94231467343816
curr_Factors:  [97.94231467]
mat_Sqrt:  [[0.15]]
grads:  [0.03149794]
Stock Position:  0.03149794431622287
Bond Position:  [2.66047792]


portfolio before change:  [5.76413764]
curr_Stock_Price:  98.51419137459887
curr_Factors:  [98.51419137]
mat_Sqrt:  [[0.15]]
grads:  [0.07661992]
Stock Position:  0.07661991862714163
Bond Position:  [-1.78401169]


portfolio before change:  [5.78333711]
curr_Stock_Price:  98.77059371496556
curr_Factors:  [98.77059371]
mat_Sqrt:  [[0.15]]
grads:  [-0.12358186]
Stock Position:  -0.12358185956133692
Bond Position:  [17.98959075]


portfolio before change:  [5.76153596]
curr_Stock_Price:  98.9834009421921
curr_Factors:  [98.98340094]
mat_Sqrt:  [[0.15]]
grads:  [0.04138815]
Stock Position:  0.04138815156545214
Bond Position:  [1.66479595]


portfolio before change:  [5.75724503]
curr_Stock_Price:  98.86966856448988
curr_Factors:  [98.86966856]
mat_Sqrt:  [[0.15]]
grads:  [-0.11565889]
Stock Position:  -0.11565889080364596
Bond Position:  [17.19240123]


portfolio before change:  [5.9916433]
curr_Stock_Price:  96.88020085199857
curr_Factors:  [96.88020085]
mat_Sqrt:  [[0.15]]
grads:  [-0.01110095]
Stock Position:  -0.011100950795616455
Bond Position:  [7.06710564]


portfolio before change:  [5.99505315]
curr_Stock_Price:  96.7322089609447
curr_Factors:  [96.73220896]
mat_Sqrt:  [[0.15]]
grads:  [-0.11241749]
Stock Position:  -0.11241749179298845
Bond Position:  [16.86944546]


portfolio before change:  [6.10974916]
curr_Stock_Price:  95.7494604265579
curr_Factors:  [95.74946043]
mat_Sqrt:  [[0.15]]
grads:  [0.0439973]
Stock Position:  0.0439973001352858
Bond Position:  [1.89703141]


portfolio before change:  [6.09362326]
curr_Stock_Price:  95.37215962229185
curr_Factors:  [95.37215962]
mat_Sqrt:  [[0.15]]
grads:  [0.02073871]
Stock Position:  0.020738711197153353
Bond Position:  [4.11572759]


portfolio before change:  [6.09370665]
curr_Stock_Price:  95.32656041289553
curr_Factors:  [95.32656041]
mat_Sqrt:  [[0.15]]
grads:  [-0.02331123]
Stock Position:  -0.023311229290452623
Bond Position:  [8.31588596]


portfolio before change:  [6.15253805]
curr_Stock_Price:  92.89201854759463
curr_Factors:  [92.89201855]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.15253805]
Stock Price:  92.49001897725323
PL:  [6.15253805]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.62616504e-02]
 [ 1.03730412e-02]
 [-2.03810272e-04]
 [ 1.23586256e-03]
 [ 1.31980278e-04]
 [ 4.39171257e-03]
 [-7.96571067e-03]
 [ 1.27475864e-02]
 [ 4.72235683e-03]
 [-4.23799403e-03]
 [-1.79861157e-02]
 [ 6.69042164e-03]
 [ 5.24441330e-03]
 [-1.84453948e-03]
 [-1.63048282e-02]
 [ 6.36770937e-03]
 [ 2.49024824e-03]
 [-3.86233655e-03]
 [-1.24265592e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.95600166]
curr_Stock_Price:  98.97983069379438
curr_Factors:  [98.97983069]
mat_Sqrt:  [[0.15]]
grads:  [0.108411]
Stock Position:  0.10841100273891693
Bond Position:  [-24.68650436]


portfolio before change:  [-13.89027857]
curr_Stock_Price:  99.64300585072108
curr_Factors:  [99.64300585]
mat_Sqrt:  [[0.15]]
grads:  [0.06915361]
Stock Position:  0.06915360827959242
Bond Position:  [-20.78095197]


portfolio before change:  [-13.95505684]
curr_Stock_Price:  98.78141117943916
curr_Factors:  [98.78141118]
mat_Sqrt:  [[0.15]]
grads:  [-0.00135874]
Stock Position:  -0.0013587351461578877
Bond Position:  [-13.82083907]


portfolio before change:  [-13.95760518]
curr_Stock_Price:  98.11365383653735
curr_Factors:  [98.11365384]
mat_Sqrt:  [[0.15]]
grads:  [0.00823908]
Stock Position:  0.008239083755026817
Bond Position:  [-14.76597179]


portfolio before change:  [-13.96323979]
curr_Stock_Price:  97.87786827028191
curr_Factors:  [97.87786827]
mat_Sqrt:  [[0.15]]
grads:  [0.00087987]
Stock Position:  0.0008798685231041551
Bond Position:  [-14.04935944]


portfolio before change:  [-13.96556411]
curr_Stock_Price:  99.22859505397021
curr_Factors:  [99.22859505]
mat_Sqrt:  [[0.15]]
grads:  [0.02927808]
Stock Position:  0.029278083800818307
Bond Position:  [-16.87078723]


portfolio before change:  [-13.99732938]
curr_Stock_Price:  98.28771892525397
curr_Factors:  [98.28771893]
mat_Sqrt:  [[0.15]]
grads:  [-0.05310474]
Stock Position:  -0.053104737776502924
Bond Position:  [-8.77778584]


portfolio before change:  [-14.04093203]
curr_Stock_Price:  99.06745975690048
curr_Factors:  [99.06745976]
mat_Sqrt:  [[0.15]]
grads:  [0.08498391]
Stock Position:  0.08498390959117091
Bond Position:  [-22.46007208]


portfolio before change:  [-14.14516745]
curr_Stock_Price:  97.90700838838053
curr_Factors:  [97.90700839]
mat_Sqrt:  [[0.15]]
grads:  [0.03148238]
Stock Position:  0.03148237887264864
Bond Position:  [-17.22751298]


portfolio before change:  [-14.19118642]
curr_Stock_Price:  96.58209083474998
curr_Factors:  [96.58209083]
mat_Sqrt:  [[0.15]]
grads:  [-0.02825329]
Stock Position:  -0.028253293540166244
Bond Position:  [-11.46242426]


portfolio before change:  [-14.2176652]
curr_Stock_Price:  97.41784542096963
curr_Factors:  [97.41784542]
mat_Sqrt:  [[0.15]]
grads:  [-0.11990744]
Stock Position:  -0.11990743794728781
Bond Position:  [-2.53654095]


portfolio before change:  [-14.07600231]
curr_Stock_Price:  96.2311207683658
curr_Factors:  [96.23112077]
mat_Sqrt:  [[0.15]]
grads:  [0.04460281]
Stock Position:  0.044602810939046715
Bond Position:  [-18.36818079]


portfolio before change:  [-14.08063717]
curr_Stock_Price:  96.23017371200766
curr_Factors:  [96.23017371]
mat_Sqrt:  [[0.15]]
grads:  [0.03496276]
Stock Position:  0.03496275536085237
Bond Position:  [-17.44510919]


portfolio before change:  [-14.06859198]
curr_Stock_Price:  96.69944475258193
curr_Factors:  [96.69944475]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229693]
Stock Position:  -0.012296929868681434
Bond Position:  [-12.87948569]


portfolio before change:  [-14.04907506]
curr_Stock_Price:  94.85043052267204
curr_Factors:  [94.85043052]
mat_Sqrt:  [[0.15]]
grads:  [-0.10869885]
Stock Position:  -0.10869885472147324
Bond Position:  [-3.73894189]


portfolio before change:  [-14.00476298]
curr_Stock_Price:  94.43417106537318
curr_Factors:  [94.43417107]
mat_Sqrt:  [[0.15]]
grads:  [0.0424514]
Stock Position:  0.042451395775935624
Bond Position:  [-18.01362535]


portfolio before change:  [-14.01799176]
curr_Stock_Price:  94.22864649348973
curr_Factors:  [94.22864649]
mat_Sqrt:  [[0.15]]
grads:  [0.01660165]
Stock Position:  0.016601654920619692
Bond Position:  [-15.58234323]


portfolio before change:  [-14.01180563]
curr_Stock_Price:  94.83594741226159
curr_Factors:  [94.83594741]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574891]
Stock Position:  -0.025748910362366123
Bond Position:  [-11.56988332]


portfolio before change:  [-14.04440125]
curr_Stock_Price:  95.98950246429199
curr_Factors:  [95.98950246]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.04440125]
Stock Price:  95.43952380779737
PL:  [-14.04440125]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.34777914e-03]
 [ 9.76592862e-03]
 [ 1.30609123e-03]
 [ 1.36834160e-02]
 [ 1.97641471e-02]
 [ 5.60368815e-03]
 [ 2.47169409e-02]
 [ 6.29937176e-03]
 [ 8.83240112e-03]
 [ 3.91013460e-03]
 [-1.37496808e-02]
 [-1.76866232e-02]
 [-2.29663597e-02]
 [ 3.15991852e-03]
 [ 1.10949671e-02]
 [ 2.85341384e-03]
 [ 7.50541800e-03]
 [-5.18899535e-03]
 [-1.19164795e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.48112774]
curr_Stock_Price:  100.82467137749889
curr_Factors:  [100.82467138]
mat_Sqrt:  [[0.15]]
grads:  [0.04898519]
Stock Position:  0.048985194296888454
Bond Position:  [9.54221162]


portfolio before change:  [14.41541614]
curr_Stock_Price:  99.43450743116311
curr_Factors:  [99.43450743]
mat_Sqrt:  [[0.15]]
grads:  [0.06510619]
Stock Position:  0.06510619076971313
Bond Position:  [7.94161413]


portfolio before change:  [14.45609901]
curr_Stock_Price:  100.02887821664999
curr_Factors:  [100.02887822]
mat_Sqrt:  [[0.15]]
grads:  [0.00870727]
Stock Position:  0.008707274880930588
Bond Position:  [13.58512007]


portfolio before change:  [14.47114258]
curr_Stock_Price:  101.36647970761182
curr_Factors:  [101.36647971]
mat_Sqrt:  [[0.15]]
grads:  [0.09122277]
Stock Position:  0.09122277323933324
Bond Position:  [5.22421118]


portfolio before change:  [14.45511615]
curr_Stock_Price:  101.17647627398394
curr_Factors:  [101.17647627]
mat_Sqrt:  [[0.15]]
grads:  [0.13176098]
Stock Position:  0.13176098047896856
Bond Position:  [1.12400444]


portfolio before change:  [14.44877902]
curr_Stock_Price:  101.12624770082981
curr_Factors:  [101.1262477]
mat_Sqrt:  [[0.15]]
grads:  [0.03735792]
Stock Position:  0.03735792096723002
Bond Position:  [10.67091265]


portfolio before change:  [14.45291298]
curr_Stock_Price:  101.16548691283374
curr_Factors:  [101.16548691]
mat_Sqrt:  [[0.15]]
grads:  [0.16477961]
Stock Position:  0.16477960629086985
Bond Position:  [-2.21709612]


portfolio before change:  [14.66484689]
curr_Stock_Price:  102.45501693394057
curr_Factors:  [102.45501693]
mat_Sqrt:  [[0.15]]
grads:  [0.04199581]
Stock Position:  0.04199581174537947
Bond Position:  [10.36216528]


portfolio before change:  [14.72859523]
curr_Stock_Price:  103.91129264405241
curr_Factors:  [103.91129264]
mat_Sqrt:  [[0.15]]
grads:  [0.05888267]
Stock Position:  0.058882674119929646
Bond Position:  [8.61002045]


portfolio before change:  [14.63897682]
curr_Stock_Price:  102.35274954365593
curr_Factors:  [102.35274954]
mat_Sqrt:  [[0.15]]
grads:  [0.02606756]
Stock Position:  0.026067563967559448
Bond Position:  [11.97088997]


portfolio before change:  [14.65343861]
curr_Stock_Price:  102.79270972367556
curr_Factors:  [102.79270972]
mat_Sqrt:  [[0.15]]
grads:  [-0.09166454]
Stock Position:  -0.09166453843352164
Bond Position:  [24.0758849]


portfolio before change:  [14.51004845]
curr_Stock_Price:  104.42267358022066
curr_Factors:  [104.42267358]
mat_Sqrt:  [[0.15]]
grads:  [-0.11791082]
Stock Position:  -0.11791082114915623
Bond Position:  [26.82261163]


portfolio before change:  [14.7942809]
curr_Stock_Price:  102.0689798208979
curr_Factors:  [102.06897982]
mat_Sqrt:  [[0.15]]
grads:  [-0.15310906]
Stock Position:  -0.15310906466475607
Bond Position:  [30.42196693]


portfolio before change:  [14.65949032]
curr_Stock_Price:  102.99901632255381
curr_Factors:  [102.99901632]
mat_Sqrt:  [[0.15]]
grads:  [0.02106612]
Stock Position:  0.02106612347143379
Bond Position:  [12.48970033]


portfolio before change:  [14.65370375]
curr_Stock_Price:  102.57609115517869
curr_Factors:  [102.57609116]
mat_Sqrt:  [[0.15]]
grads:  [0.07396645]
Stock Position:  0.07396644762441121
Bond Position:  [7.06651467]


portfolio before change:  [14.66781439]
curr_Stock_Price:  102.74297491435031
curr_Factors:  [102.74297491]
mat_Sqrt:  [[0.15]]
grads:  [0.01902276]
Stock Position:  0.01902275891935195
Bond Position:  [12.71335955]


portfolio before change:  [14.67005865]
curr_Stock_Price:  102.69385045750082
curr_Factors:  [102.69385046]
mat_Sqrt:  [[0.15]]
grads:  [0.05003612]
Stock Position:  0.050036119989382934
Bond Position:  [9.53165683]


portfolio before change:  [14.73086935]
curr_Stock_Price:  103.86155666278383
curr_Factors:  [103.86155666]
mat_Sqrt:  [[0.15]]
grads:  [-0.0345933]
Stock Position:  -0.03459330235138882
Bond Position:  [18.32378358]


portfolio before change:  [14.78945029]
curr_Stock_Price:  102.30057751097165
curr_Factors:  [102.30057751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.78945029]
Stock Price:  102.19210349178292
PL:  [12.5973468]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.37835281e-02]
 [ 9.85507158e-03]
 [ 1.34998381e-03]
 [ 9.13616852e-03]
 [ 5.68844085e-03]
 [ 4.14869328e-03]
 [-1.50839735e-02]
 [ 1.15685994e-02]
 [ 3.65952132e-03]
 [ 1.00319888e-02]
 [-1.76640174e-02]
 [ 7.47290707e-03]
 [ 3.45372688e-03]
 [-1.38795474e-03]
 [-1.63617231e-02]
 [ 7.33506403e-03]
 [ 5.95229413e-03]
 [-1.71771106e-03]
 [-1.28055477e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.72728644]
curr_Stock_Price:  98.60542226395225
curr_Factors:  [98.60542226]
mat_Sqrt:  [[0.15]]
grads:  [0.15855685]
Stock Position:  0.15855685411814602
Bond Position:  [-35.361852]


portfolio before change:  [-19.60084052]
curr_Stock_Price:  99.45866504069079
curr_Factors:  [99.45866504]
mat_Sqrt:  [[0.15]]
grads:  [0.06570048]
Stock Position:  0.06570047717166336
Bond Position:  [-26.13532227]


portfolio before change:  [-19.57576411]
curr_Stock_Price:  99.93980404686185
curr_Factors:  [99.93980405]
mat_Sqrt:  [[0.15]]
grads:  [0.00899989]
Stock Position:  0.00899989203641345
Bond Position:  [-20.47521155]


portfolio before change:  [-19.57412447]
curr_Stock_Price:  100.69082170019502
curr_Factors:  [100.6908217]
mat_Sqrt:  [[0.15]]
grads:  [0.06090779]
Stock Position:  0.060907790112588574
Bond Position:  [-25.70697991]


portfolio before change:  [-19.64461509]
curr_Stock_Price:  99.63901754441204
curr_Factors:  [99.63901754]
mat_Sqrt:  [[0.15]]
grads:  [0.03792294]
Stock Position:  0.03792293899530136
Bond Position:  [-23.42321947]


portfolio before change:  [-19.65921541]
curr_Stock_Price:  99.40845022376203
curr_Factors:  [99.40845022]
mat_Sqrt:  [[0.15]]
grads:  [0.02765796]
Stock Position:  0.027657955192992446
Bond Position:  [-22.40864988]


portfolio before change:  [-19.66900099]
curr_Stock_Price:  99.25722030612157
curr_Factors:  [99.25722031]
mat_Sqrt:  [[0.15]]
grads:  [-0.10055982]
Stock Position:  -0.10055982302236778
Bond Position:  [-9.68771248]


portfolio before change:  [-19.62486681]
curr_Stock_Price:  98.79424809731844
curr_Factors:  [98.7942481]
mat_Sqrt:  [[0.15]]
grads:  [0.077124]
Stock Position:  0.07712399621829828
Bond Position:  [-27.24427403]


portfolio before change:  [-19.60542865]
curr_Stock_Price:  99.1346101817224
curr_Factors:  [99.13461018]
mat_Sqrt:  [[0.15]]
grads:  [0.02439681]
Stock Position:  0.02439680881362828
Bond Position:  [-22.02399678]


portfolio before change:  [-19.63370253]
curr_Stock_Price:  98.2014064899252
curr_Factors:  [98.20140649]
mat_Sqrt:  [[0.15]]
grads:  [0.06687993]
Stock Position:  0.06687992517275387
Bond Position:  [-26.20140525]


portfolio before change:  [-19.7633676]
curr_Stock_Price:  96.3605865215501
curr_Factors:  [96.36058652]
mat_Sqrt:  [[0.15]]
grads:  [-0.11776012]
Stock Position:  -0.11776011629809446
Bond Position:  [-8.41593373]


portfolio before change:  [-19.67793767]
curr_Stock_Price:  95.61726033577304
curr_Factors:  [95.61726034]
mat_Sqrt:  [[0.15]]
grads:  [0.04981938]
Stock Position:  0.04981938045704896
Bond Position:  [-24.44153034]


portfolio before change:  [-19.64253352]
curr_Stock_Price:  96.45057649897079
curr_Factors:  [96.4505765]
mat_Sqrt:  [[0.15]]
grads:  [0.02302485]
Stock Position:  0.023024845897248666
Bond Position:  [-21.86329318]


portfolio before change:  [-19.63167743]
curr_Stock_Price:  97.15948890801774
curr_Factors:  [97.15948891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00925303]
Stock Position:  -0.009253031574998993
Bond Position:  [-18.73265761]


portfolio before change:  [-19.648344]
curr_Stock_Price:  98.45450483130519
curr_Factors:  [98.45450483]
mat_Sqrt:  [[0.15]]
grads:  [-0.10907815]
Stock Position:  -0.1090781538449268
Bond Position:  [-8.90910838]


portfolio before change:  [-19.56649837]
curr_Stock_Price:  97.68374380808505
curr_Factors:  [97.68374381]
mat_Sqrt:  [[0.15]]
grads:  [0.04890043]
Stock Position:  0.04890042683951759
Bond Position:  [-24.34327514]


portfolio before change:  [-19.49661228]
curr_Stock_Price:  99.23736362628483
curr_Factors:  [99.23736363]
mat_Sqrt:  [[0.15]]
grads:  [0.03968196]
Stock Position:  0.039681960856467226
Bond Position:  [-23.43454545]


portfolio before change:  [-19.52022707]
curr_Stock_Price:  98.78992046602221
curr_Factors:  [98.78992047]
mat_Sqrt:  [[0.15]]
grads:  [-0.01145141]
Stock Position:  -0.011451407043108867
Bond Position:  [-18.38894347]


portfolio before change:  [-19.52939348]
curr_Stock_Price:  99.18887645615962
curr_Factors:  [99.18887646]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.52939348]
Stock Price:  100.97043424601112
PL:  [-20.49982773]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.02953621e-02]
 [ 6.19562616e-03]
 [ 7.42336221e-04]
 [ 1.89047694e-03]
 [-6.81293925e-04]
 [ 4.29446037e-03]
 [-6.36215601e-03]
 [ 4.66238820e-04]
 [ 4.55265515e-03]
 [-1.16071260e-02]
 [-1.75440520e-02]
 [ 7.93657398e-03]
 [ 7.01205511e-03]
 [ 1.10762840e-04]
 [-1.49890677e-02]
 [ 7.24732947e-03]
 [ 7.49152679e-03]
 [-3.12212465e-03]
 [-1.21956179e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [41.06983022]
curr_Stock_Price:  102.54959654081122
curr_Factors:  [102.54959654]
mat_Sqrt:  [[0.15]]
grads:  [0.20196908]
Stock Position:  0.20196908064963817
Bond Position:  [20.35798249]


portfolio before change:  [40.73448217]
curr_Stock_Price:  100.86400098526242
curr_Factors:  [100.86400099]
mat_Sqrt:  [[0.15]]
grads:  [0.04130417]
Stock Position:  0.041304174402259725
Bond Position:  [36.56837788]


portfolio before change:  [40.75206881]
curr_Stock_Price:  101.06842104030927
curr_Factors:  [101.06842104]
mat_Sqrt:  [[0.15]]
grads:  [0.00494891]
Stock Position:  0.00494890813861589
Bond Position:  [40.25189048]


portfolio before change:  [40.74936329]
curr_Stock_Price:  98.48810444930469
curr_Factors:  [98.48810445]
mat_Sqrt:  [[0.15]]
grads:  [0.01260318]
Stock Position:  0.012603179621195141
Bond Position:  [39.50810002]


portfolio before change:  [40.74690647]
curr_Stock_Price:  97.50937662005161
curr_Factors:  [97.50937662]
mat_Sqrt:  [[0.15]]
grads:  [-0.00454196]
Stock Position:  -0.004541959500819412
Bond Position:  [41.18979011]


portfolio before change:  [40.75367735]
curr_Stock_Price:  98.28610056508599
curr_Factors:  [98.28610057]
mat_Sqrt:  [[0.15]]
grads:  [0.02862974]
Stock Position:  0.028629735781014323
Bond Position:  [37.93977226]


portfolio before change:  [40.74543924]
curr_Stock_Price:  97.66701553850157
curr_Factors:  [97.66701554]
mat_Sqrt:  [[0.15]]
grads:  [-0.04241437]
Stock Position:  -0.04241437336794445
Bond Position:  [44.8879245]


portfolio before change:  [40.85109746]
curr_Stock_Price:  95.44053373646753
curr_Factors:  [95.44053374]
mat_Sqrt:  [[0.15]]
grads:  [0.00310826]
Stock Position:  0.003108258801307849
Bond Position:  [40.55444358]


portfolio before change:  [40.86092746]
curr_Stock_Price:  95.34083847173662
curr_Factors:  [95.34083847]
mat_Sqrt:  [[0.15]]
grads:  [0.03035103]
Stock Position:  0.030351034326650095
Bond Position:  [37.96723439]


portfolio before change:  [40.87784721]
curr_Stock_Price:  95.58553398839865
curr_Factors:  [95.58553399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07738084]
Stock Position:  -0.07738084013425907
Bond Position:  [48.27433614]


portfolio before change:  [40.92070156]
curr_Stock_Price:  95.18770617326079
curr_Factors:  [95.18770617]
mat_Sqrt:  [[0.15]]
grads:  [-0.11696035]
Stock Position:  -0.11696034637591814
Bond Position:  [52.05388864]


portfolio before change:  [40.92601983]
curr_Stock_Price:  95.25351327571904
curr_Factors:  [95.25351328]
mat_Sqrt:  [[0.15]]
grads:  [0.05291049]
Stock Position:  0.052910493232840666
Bond Position:  [35.88610946]


portfolio before change:  [40.97515652]
curr_Stock_Price:  96.01260732213684
curr_Factors:  [96.01260732]
mat_Sqrt:  [[0.15]]
grads:  [0.04674703]
Stock Position:  0.04674703404619944
Bond Position:  [36.4868519]


portfolio before change:  [41.07793013]
curr_Stock_Price:  98.01595909977249
curr_Factors:  [98.0159591]
mat_Sqrt:  [[0.15]]
grads:  [0.00073842]
Stock Position:  0.000738418931342283
Bond Position:  [41.00555329]


portfolio before change:  [41.08903985]
curr_Stock_Price:  99.1766088185128
curr_Factors:  [99.17660882]
mat_Sqrt:  [[0.15]]
grads:  [-0.09992712]
Stock Position:  -0.09992711804983201
Bond Position:  [50.99947254]


portfolio before change:  [40.9283817]
curr_Stock_Price:  100.91196969682844
curr_Factors:  [100.9119697]
mat_Sqrt:  [[0.15]]
grads:  [0.04831553]
Stock Position:  0.048315529778542185
Bond Position:  [36.05276642]


portfolio before change:  [40.94176866]
curr_Stock_Price:  101.00247150442245
curr_Factors:  [101.0024715]
mat_Sqrt:  [[0.15]]
grads:  [0.04994351]
Stock Position:  0.049943511942082436
Bond Position:  [35.89735052]


portfolio before change:  [40.96122264]
curr_Stock_Price:  101.21227894247343
curr_Factors:  [101.21227894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02081416]
Stock Position:  -0.0208141643110371
Bond Position:  [43.06787164]


portfolio before change:  [40.96136805]
curr_Stock_Price:  101.72264773634707
curr_Factors:  [101.72264774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.96136805]
Stock Price:  101.26763660330052
PL:  [39.69373145]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.69915978e-03]
 [ 7.45166635e-03]
 [-1.93815012e-03]
 [-2.54750973e-03]
 [-7.35841944e-03]
 [-2.35413540e-03]
 [-3.37685401e-03]
 [ 4.07068881e-03]
 [ 4.67273348e-03]
 [-8.09880533e-03]
 [-1.75520521e-02]
 [ 9.65312889e-03]
 [ 1.56372102e-02]
 [-1.24878849e-03]
 [-1.67634018e-02]
 [ 6.28870045e-03]
 [ 2.49161544e-03]
 [-4.16032766e-03]
 [-1.16931062e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.66836839]
curr_Stock_Price:  99.32286253898924
curr_Factors:  [99.32286254]
mat_Sqrt:  [[0.15]]
grads:  [0.0579944]
Stock Position:  0.057994398507399014
Bond Position:  [-14.42853806]


portfolio before change:  [-8.68924576]
curr_Stock_Price:  99.02507894731512
curr_Factors:  [99.02507895]
mat_Sqrt:  [[0.15]]
grads:  [0.04967778]
Stock Position:  0.049677775640924876
Bond Position:  [-13.60859141]


portfolio before change:  [-8.74865989]
curr_Stock_Price:  97.8975817023905
curr_Factors:  [97.8975817]
mat_Sqrt:  [[0.15]]
grads:  [-0.012921]
Stock Position:  -0.012921000796451693
Bond Position:  [-7.48372516]


portfolio before change:  [-8.72535989]
curr_Stock_Price:  95.94950022636905
curr_Factors:  [95.94950023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0169834]
Stock Position:  -0.016983398200843353
Bond Position:  [-7.09581132]


portfolio before change:  [-8.72655856]
curr_Stock_Price:  95.91561397994839
curr_Factors:  [95.91561398]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905613]
Stock Position:  -0.049056129615373145
Bond Position:  [-4.02130977]


portfolio before change:  [-8.71235846]
curr_Stock_Price:  95.6056516458704
curr_Factors:  [95.60565165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569424]
Stock Position:  -0.015694235999548247
Bond Position:  [-7.2119008]


portfolio before change:  [-8.72837772]
curr_Stock_Price:  96.5114658693643
curr_Factors:  [96.51146587]
mat_Sqrt:  [[0.15]]
grads:  [-0.02251236]
Stock Position:  -0.022512360073154714
Bond Position:  [-6.55567685]


portfolio before change:  [-8.72541303]
curr_Stock_Price:  96.30696420342016
curr_Factors:  [96.3069642]
mat_Sqrt:  [[0.15]]
grads:  [0.02713793]
Stock Position:  0.02713792536745998
Bond Position:  [-11.33898424]


portfolio before change:  [-8.70519021]
curr_Stock_Price:  97.15662122920698
curr_Factors:  [97.15662123]
mat_Sqrt:  [[0.15]]
grads:  [0.03115156]
Stock Position:  0.031151556500204708
Bond Position:  [-11.73177018]


portfolio before change:  [-8.74228566]
curr_Stock_Price:  96.0599780622684
curr_Factors:  [96.05997806]
mat_Sqrt:  [[0.15]]
grads:  [-0.05399204]
Stock Position:  -0.053992035541058164
Bond Position:  [-3.55581191]


portfolio before change:  [-8.70030203]
curr_Stock_Price:  95.26592216103504
curr_Factors:  [95.26592216]
mat_Sqrt:  [[0.15]]
grads:  [-0.11701368]
Stock Position:  -0.11701368071180876
Bond Position:  [2.44711417]


portfolio before change:  [-8.56920473]
curr_Stock_Price:  94.15079237014555
curr_Factors:  [94.15079237]
mat_Sqrt:  [[0.15]]
grads:  [0.06435419]
Stock Position:  0.06435419260200888
Bond Position:  [-14.62820295]


portfolio before change:  [-8.52136561]
curr_Stock_Price:  94.9509986596358
curr_Factors:  [94.95099866]
mat_Sqrt:  [[0.15]]
grads:  [0.10424807]
Stock Position:  0.10424806782774902
Bond Position:  [-18.41982376]


portfolio before change:  [-8.28112256]
curr_Stock_Price:  97.29970958160663
curr_Factors:  [97.29970958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00832526]
Stock Position:  -0.008325256568984708
Bond Position:  [-7.47107752]


portfolio before change:  [-8.27614409]
curr_Stock_Price:  96.47733574094134
curr_Factors:  [96.47733574]
mat_Sqrt:  [[0.15]]
grads:  [-0.11175601]
Stock Position:  -0.11175601177264861
Bond Position:  [2.50577818]


portfolio before change:  [-8.01310937]
curr_Stock_Price:  94.12929023849732
curr_Factors:  [94.12929024]
mat_Sqrt:  [[0.15]]
grads:  [0.04192467]
Stock Position:  0.04192466969072806
Bond Position:  [-11.95944877]


portfolio before change:  [-8.0118285]
curr_Stock_Price:  94.2311658560229
curr_Factors:  [94.23116586]
mat_Sqrt:  [[0.15]]
grads:  [0.01661077]
Stock Position:  0.016610769590419464
Bond Position:  [-9.57708069]


portfolio before change:  [-8.00923294]
curr_Stock_Price:  94.53158148577805
curr_Factors:  [94.53158149]
mat_Sqrt:  [[0.15]]
grads:  [-0.02773552]
Stock Position:  -0.027735517711248436
Bond Position:  [-5.38735059]


portfolio before change:  [-7.99673879]
curr_Stock_Price:  94.03254081900673
curr_Factors:  [94.03254082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.99673879]
Stock Price:  93.99720323364951
PL:  [-7.99673879]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.97873438e-03]
 [ 6.00153488e-03]
 [ 1.45850713e-03]
 [ 2.97813889e-03]
 [ 6.78638560e-04]
 [ 3.22052499e-03]
 [-1.16487676e-02]
 [ 1.04173679e-02]
 [ 4.63437285e-03]
 [ 9.26954364e-03]
 [-1.81317825e-02]
 [ 6.43308431e-03]
 [ 1.16263861e-02]
 [-3.74117952e-03]
 [-1.65366942e-02]
 [ 6.58039435e-03]
 [ 3.26043278e-03]
 [-4.27719057e-03]
 [-1.11237229e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.82084633]
curr_Stock_Price:  100.45746422107551
curr_Factors:  [100.45746422]
mat_Sqrt:  [[0.15]]
grads:  [0.03985823]
Stock Position:  0.039858229186093656
Bond Position:  [4.8167897]


portfolio before change:  [8.85552025]
curr_Stock_Price:  101.29717974001325
curr_Factors:  [101.29717974]
mat_Sqrt:  [[0.15]]
grads:  [0.04001023]
Stock Position:  0.040010232545513266
Bond Position:  [4.80259653]


portfolio before change:  [8.79188007]
curr_Stock_Price:  99.67656988343606
curr_Factors:  [99.67656988]
mat_Sqrt:  [[0.15]]
grads:  [0.00972338]
Stock Position:  0.009723380892329356
Bond Position:  [7.82268682]


portfolio before change:  [8.79144867]
curr_Stock_Price:  99.43104617157526
curr_Factors:  [99.43104617]
mat_Sqrt:  [[0.15]]
grads:  [0.01985426]
Stock Position:  0.019854259284182524
Bond Position:  [6.8173189]


portfolio before change:  [8.76916354]
curr_Stock_Price:  98.22275756922623
curr_Factors:  [98.22275757]
mat_Sqrt:  [[0.15]]
grads:  [0.00452426]
Stock Position:  0.004524257069671694
Bond Position:  [8.32477853]


portfolio before change:  [8.78036548]
curr_Stock_Price:  100.2386663553967
curr_Factors:  [100.23866636]
mat_Sqrt:  [[0.15]]
grads:  [0.02147017]
Stock Position:  0.021470166569358372
Bond Position:  [6.62822462]


portfolio before change:  [8.76900323]
curr_Stock_Price:  99.63226588484663
curr_Factors:  [99.63226588]
mat_Sqrt:  [[0.15]]
grads:  [-0.07765845]
Stock Position:  -0.07765845068667172
Bond Position:  [16.50629063]


portfolio before change:  [8.8661351]
curr_Stock_Price:  98.4346526429962
curr_Factors:  [98.43465264]
mat_Sqrt:  [[0.15]]
grads:  [0.06944912]
Stock Position:  0.06944911965350388
Bond Position:  [2.02993513]


portfolio before change:  [8.73759872]
curr_Stock_Price:  96.57654515734438
curr_Factors:  [96.57654516]
mat_Sqrt:  [[0.15]]
grads:  [0.03089582]
Stock Position:  0.03089581899197907
Bond Position:  [5.75378726]


portfolio before change:  [8.78588138]
curr_Stock_Price:  98.09273826744015
curr_Factors:  [98.09273827]
mat_Sqrt:  [[0.15]]
grads:  [0.06179696]
Stock Position:  0.06179695762201807
Bond Position:  [2.72404859]


portfolio before change:  [8.76951762]
curr_Stock_Price:  97.81691804848664
curr_Factors:  [97.81691805]
mat_Sqrt:  [[0.15]]
grads:  [-0.12087855]
Stock Position:  -0.1208785497365113
Bond Position:  [20.59348482]


portfolio before change:  [8.94195239]
curr_Stock_Price:  96.43300210608142
curr_Factors:  [96.43300211]
mat_Sqrt:  [[0.15]]
grads:  [0.04288723]
Stock Position:  0.04288722873718918
Bond Position:  [4.80620817]


portfolio before change:  [8.90076694]
curr_Stock_Price:  95.44466231263394
curr_Factors:  [95.44466231]
mat_Sqrt:  [[0.15]]
grads:  [0.07750924]
Stock Position:  0.07750924080942599
Bond Position:  [1.50292362]


portfolio before change:  [8.84208915]
curr_Stock_Price:  94.68277168420323
curr_Factors:  [94.68277168]
mat_Sqrt:  [[0.15]]
grads:  [-0.0249412]
Stock Position:  -0.024941196783136475
Bond Position:  [11.20359079]


portfolio before change:  [8.82019208]
curr_Stock_Price:  95.67303368625201
curr_Factors:  [95.67303369]
mat_Sqrt:  [[0.15]]
grads:  [-0.11024463]
Stock Position:  -0.11024462827583735
Bond Position:  [19.36763011]


portfolio before change:  [8.83059329]
curr_Stock_Price:  95.62261223141438
curr_Factors:  [95.62261223]
mat_Sqrt:  [[0.15]]
grads:  [0.0438693]
Stock Position:  0.043869295679830465
Bond Position:  [4.63569664]


portfolio before change:  [8.83286075]
curr_Stock_Price:  95.64787806401148
curr_Factors:  [95.64787806]
mat_Sqrt:  [[0.15]]
grads:  [0.02173622]
Stock Position:  0.02173621851136063
Bond Position:  [6.75383757]


portfolio before change:  [8.80789399]
curr_Stock_Price:  94.42156385162511
curr_Factors:  [94.42156385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0285146]
Stock Position:  -0.02851460377633029
Bond Position:  [11.50028747]


portfolio before change:  [8.86746037]
curr_Stock_Price:  92.43342642825694
curr_Factors:  [92.43342643]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.86746037]
Stock Price:  92.6180401933136
PL:  [8.86746037]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.97458840e-03]
 [ 8.65424795e-03]
 [ 1.44594849e-03]
 [ 2.23364389e-03]
 [ 6.42744303e-03]
 [ 6.87243376e-03]
 [ 3.39126288e-02]
 [ 4.51564709e-03]
 [ 6.51822408e-03]
 [-5.77472341e-03]
 [-1.42808640e-02]
 [-1.03305764e-02]
 [-2.17122207e-02]
 [ 3.05007419e-03]
 [-4.15807574e-03]
 [ 7.88548738e-03]
 [ 5.00525778e-03]
 [-1.83503164e-03]
 [-1.27463908e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.76956572]
curr_Stock_Price:  100.45413742440196
curr_Factors:  [100.45413742]
mat_Sqrt:  [[0.15]]
grads:  [0.03983059]
Stock Position:  0.039830589355428284
Bond Position:  [4.76841823]


portfolio before change:  [8.76017332]
curr_Stock_Price:  100.18839552174616
curr_Factors:  [100.18839552]
mat_Sqrt:  [[0.15]]
grads:  [0.05769499]
Stock Position:  0.05769498635517721
Bond Position:  [2.97980521]


portfolio before change:  [8.72760138]
curr_Stock_Price:  99.61092791835564
curr_Factors:  [99.61092792]
mat_Sqrt:  [[0.15]]
grads:  [0.00963966]
Stock Position:  0.00963965662436859
Bond Position:  [7.76738624]


portfolio before change:  [8.72061208]
curr_Stock_Price:  98.68440180484296
curr_Factors:  [98.6844018]
mat_Sqrt:  [[0.15]]
grads:  [0.01489096]
Stock Position:  0.01489095923387396
Bond Position:  [7.25110667]


portfolio before change:  [8.73857689]
curr_Stock_Price:  99.76907430072255
curr_Factors:  [99.7690743]
mat_Sqrt:  [[0.15]]
grads:  [0.04284962]
Stock Position:  0.04284962019528595
Bond Position:  [4.46350995]


portfolio before change:  [8.84526201]
curr_Stock_Price:  102.23278576882191
curr_Factors:  [102.23278577]
mat_Sqrt:  [[0.15]]
grads:  [0.04581623]
Stock Position:  0.04581622509617761
Bond Position:  [4.16134169]


portfolio before change:  [8.84359079]
curr_Stock_Price:  102.17359952476926
curr_Factors:  [102.17359952]
mat_Sqrt:  [[0.15]]
grads:  [0.22608419]
Stock Position:  0.22608419201184432
Bond Position:  [-14.25624491]


portfolio before change:  [8.9896814]
curr_Stock_Price:  102.835543728628
curr_Factors:  [102.83554373]
mat_Sqrt:  [[0.15]]
grads:  [0.03010431]
Stock Position:  0.03010431393260581
Bond Position:  [5.89388791]


portfolio before change:  [8.97015695]
curr_Stock_Price:  102.13803208278384
curr_Factors:  [102.13803208]
mat_Sqrt:  [[0.15]]
grads:  [0.04345483]
Stock Position:  0.04345482720600738
Bond Position:  [4.53176641]


portfolio before change:  [9.03739961]
curr_Stock_Price:  103.65937234987867
curr_Factors:  [103.65937235]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849816]
Stock Position:  -0.03849815606760018
Bond Position:  [13.0280943]


portfolio before change:  [9.08659866]
curr_Stock_Price:  102.46602626869979
curr_Factors:  [102.46602627]
mat_Sqrt:  [[0.15]]
grads:  [-0.09520576]
Stock Position:  -0.09520575988301225
Bond Position:  [18.84195456]


portfolio before change:  [9.02631419]
curr_Stock_Price:  103.14871131637246
curr_Factors:  [103.14871132]
mat_Sqrt:  [[0.15]]
grads:  [-0.06887051]
Stock Position:  -0.06887050951176793
Bond Position:  [16.1302185]


portfolio before change:  [9.05009054]
curr_Stock_Price:  102.8620386972402
curr_Factors:  [102.8620387]
mat_Sqrt:  [[0.15]]
grads:  [-0.14474814]
Stock Position:  -0.14474813810559406
Bond Position:  [23.93917912]


portfolio before change:  [9.05448261]
curr_Stock_Price:  102.87304728625601
curr_Factors:  [102.87304729]
mat_Sqrt:  [[0.15]]
grads:  [0.02033383]
Stock Position:  0.02033382791719657
Bond Position:  [6.96267977]


portfolio before change:  [9.01375911]
curr_Stock_Price:  100.78468548232027
curr_Factors:  [100.78468548]
mat_Sqrt:  [[0.15]]
grads:  [-0.0277205]
Stock Position:  -0.027720504945212207
Bond Position:  [11.80756148]


portfolio before change:  [9.05493212]
curr_Stock_Price:  99.40589569602595
curr_Factors:  [99.4058957]
mat_Sqrt:  [[0.15]]
grads:  [0.05256992]
Stock Position:  0.052569915899907387
Bond Position:  [3.82917254]


portfolio before change:  [9.02951513]
curr_Stock_Price:  98.904194343484
curr_Factors:  [98.90419434]
mat_Sqrt:  [[0.15]]
grads:  [0.03336839]
Stock Position:  0.03336838518727791
Bond Position:  [5.72924188]


portfolio before change:  [9.04586518]
curr_Stock_Price:  99.35125096188685
curr_Factors:  [99.35125096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01223354]
Stock Position:  -0.012233544237035439
Bond Position:  [10.2612831]


portfolio before change:  [9.05783873]
curr_Stock_Price:  98.58222563382782
curr_Factors:  [98.58222563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.05783873]
Stock Price:  96.63714987149173
PL:  [9.05783873]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.05692197e-03]
 [ 8.67457954e-03]
 [ 1.46234412e-03]
 [ 3.95270887e-03]
 [ 7.76289198e-03]
 [ 4.61378967e-03]
 [ 1.64143782e-02]
 [ 1.10050952e-02]
 [ 3.25460025e-03]
 [ 9.87599273e-03]
 [-1.73287069e-02]
 [ 1.56700257e-03]
 [-2.28740418e-02]
 [ 2.58430224e-03]
 [ 1.30967377e-02]
 [ 2.07128505e-03]
 [ 6.77139009e-03]
 [-5.19200033e-03]
 [-1.08230259e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.84442044]
curr_Stock_Price:  100.13462175614285
curr_Factors:  [100.13462176]
mat_Sqrt:  [[0.15]]
grads:  [0.02704615]
Stock Position:  0.027046146495641837
Bond Position:  [1.13616479]


portfolio before change:  [3.84554907]
curr_Stock_Price:  100.16584813514247
curr_Factors:  [100.16584814]
mat_Sqrt:  [[0.15]]
grads:  [0.05783053]
Stock Position:  0.05783053026358883
Bond Position:  [-1.94709505]


portfolio before change:  [3.81792682]
curr_Stock_Price:  99.69662517699456
curr_Factors:  [99.69662518]
mat_Sqrt:  [[0.15]]
grads:  [0.00974896]
Stock Position:  0.009748960790339357
Bond Position:  [2.84598833]


portfolio before change:  [3.82380283]
curr_Stock_Price:  100.22636605708908
curr_Factors:  [100.22636606]
mat_Sqrt:  [[0.15]]
grads:  [0.02635139]
Stock Position:  0.026351392488011792
Bond Position:  [1.18269852]


portfolio before change:  [3.81800789]
curr_Stock_Price:  99.99523400954675
curr_Factors:  [99.99523401]
mat_Sqrt:  [[0.15]]
grads:  [0.05175261]
Stock Position:  0.05175261317047026
Bond Position:  [-1.35700678]


portfolio before change:  [3.75981382]
curr_Stock_Price:  98.877323740273
curr_Factors:  [98.87732374]
mat_Sqrt:  [[0.15]]
grads:  [0.0307586]
Stock Position:  0.030758597832460047
Bond Position:  [0.71848598]


portfolio before change:  [3.81669871]
curr_Stock_Price:  100.72088150701839
curr_Factors:  [100.72088151]
mat_Sqrt:  [[0.15]]
grads:  [0.10942919]
Stock Position:  0.10942918828876594
Bond Position:  [-7.2051056]


portfolio before change:  [3.9173092]
curr_Stock_Price:  101.65675601498543
curr_Factors:  [101.65675601]
mat_Sqrt:  [[0.15]]
grads:  [0.0733673]
Stock Position:  0.07336730122529965
Bond Position:  [-3.54097264]


portfolio before change:  [3.81576963]
curr_Stock_Price:  100.2848340677972
curr_Factors:  [100.28483407]
mat_Sqrt:  [[0.15]]
grads:  [0.02169733]
Stock Position:  0.021697334990099168
Bond Position:  [1.63985599]


portfolio before change:  [3.80375035]
curr_Stock_Price:  99.71198499984995
curr_Factors:  [99.711985]
mat_Sqrt:  [[0.15]]
grads:  [0.06583995]
Stock Position:  0.06583995151532894
Bond Position:  [-2.76128191]


portfolio before change:  [3.82176895]
curr_Stock_Price:  99.99614390654459
curr_Factors:  [99.99614391]
mat_Sqrt:  [[0.15]]
grads:  [-0.11552471]
Stock Position:  -0.11552471266958016
Bond Position:  [15.37379475]


portfolio before change:  [3.80320086]
curr_Stock_Price:  100.19014589138304
curr_Factors:  [100.19014589]
mat_Sqrt:  [[0.15]]
grads:  [0.01044668]
Stock Position:  0.010446683778045671
Bond Position:  [2.75654609]


portfolio before change:  [3.82400356]
curr_Stock_Price:  102.1154916381467
curr_Factors:  [102.11549164]
mat_Sqrt:  [[0.15]]
grads:  [-0.15249361]
Stock Position:  -0.15249361210554227
Bond Position:  [19.39596373]


portfolio before change:  [3.79478452]
curr_Stock_Price:  102.33890190615666
curr_Factors:  [102.33890191]
mat_Sqrt:  [[0.15]]
grads:  [0.01722868]
Stock Position:  0.017228681615701204
Bond Position:  [2.03162016]


portfolio before change:  [3.8025449]
curr_Stock_Price:  102.75985191094453
curr_Factors:  [102.75985191]
mat_Sqrt:  [[0.15]]
grads:  [0.08731158]
Stock Position:  0.08731158478676122
Bond Position:  [-5.16958062]


portfolio before change:  [3.87034243]
curr_Stock_Price:  103.55115685984815
curr_Factors:  [103.55115686]
mat_Sqrt:  [[0.15]]
grads:  [0.01380857]
Stock Position:  0.013808566995937542
Bond Position:  [2.44044934]


portfolio before change:  [3.89226408]
curr_Stock_Price:  105.09450747124815
curr_Factors:  [105.09450747]
mat_Sqrt:  [[0.15]]
grads:  [0.0451426]
Stock Position:  0.045142600593918475
Bond Position:  [-0.85197529]


portfolio before change:  [3.84246825]
curr_Stock_Price:  103.99614774818298
curr_Factors:  [103.99614775]
mat_Sqrt:  [[0.15]]
grads:  [-0.03461334]
Stock Position:  -0.03461333556058779
Bond Position:  [7.4421218]


portfolio before change:  [3.82245935]
curr_Stock_Price:  104.62797521775528
curr_Factors:  [104.62797522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.82245935]
Stock Price:  105.46750512827285
PL:  [-1.64504578]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.88867005e-04]
 [ 3.72932587e-03]
 [-1.16011865e-03]
 [ 4.09536951e-04]
 [-5.77749145e-03]
 [-2.82974455e-03]
 [-3.56819325e-04]
 [-3.38396689e-03]
 [ 4.39998923e-03]
 [-3.64229259e-02]
 [-1.78883543e-02]
 [ 1.38137375e-02]
 [ 2.74613066e-02]
 [-4.61950051e-03]
 [-1.59371231e-02]
 [ 5.87784881e-03]
 [ 2.92725324e-03]
 [-3.22862425e-03]
 [-1.21067365e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.94348342]
curr_Stock_Price:  99.69426081069918
curr_Factors:  [99.69426081]
mat_Sqrt:  [[0.15]]
grads:  [0.00459245]
Stock Position:  0.004592446698023192
Bond Position:  [-3.401324]


portfolio before change:  [-2.95070286]
curr_Stock_Price:  98.30741701030561
curr_Factors:  [98.30741701]
mat_Sqrt:  [[0.15]]
grads:  [0.02486217]
Stock Position:  0.024862172452487844
Bond Position:  [-5.39483882]


portfolio before change:  [-2.95001235]
curr_Stock_Price:  98.38944501442629
curr_Factors:  [98.38944501]
mat_Sqrt:  [[0.15]]
grads:  [-0.00773412]
Stock Position:  -0.007734124336150122
Bond Position:  [-2.18905614]


portfolio before change:  [-2.94477097]
curr_Stock_Price:  97.64098146458107
curr_Factors:  [97.64098146]
mat_Sqrt:  [[0.15]]
grads:  [0.00273025]
Stock Position:  0.0027302463431675096
Bond Position:  [-3.2113549]


portfolio before change:  [-2.94948175]
curr_Stock_Price:  96.20966586366617
curr_Factors:  [96.20966586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03851661]
Stock Position:  -0.038516609666248064
Bond Position:  [0.75618839]


portfolio before change:  [-2.91922388]
curr_Stock_Price:  95.42899484677581
curr_Factors:  [95.42899485]
mat_Sqrt:  [[0.15]]
grads:  [-0.01886496]
Stock Position:  -0.0188649636340277
Bond Position:  [-1.11895936]


portfolio before change:  [-2.92301912]
curr_Stock_Price:  95.61534349739027
curr_Factors:  [95.6153435]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023788]
Stock Position:  -0.002378795502445917
Bond Position:  [-2.69556977]


portfolio before change:  [-2.92107567]
curr_Stock_Price:  94.51502900000177
curr_Factors:  [94.515029]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255978]
Stock Position:  -0.022559779282447477
Bond Position:  [-0.78883748]


portfolio before change:  [-2.8968193]
curr_Stock_Price:  93.43108210379339
curr_Factors:  [93.4310821]
mat_Sqrt:  [[0.15]]
grads:  [0.02933326]
Stock Position:  0.029333261527464388
Bond Position:  [-5.63745767]


portfolio before change:  [-2.93193114]
curr_Stock_Price:  92.28213736088964
curr_Factors:  [92.28213736]
mat_Sqrt:  [[0.15]]
grads:  [-0.24281951]
Stock Position:  -0.24281950606605524
Bond Position:  [19.47597188]


portfolio before change:  [-2.52087366]
curr_Stock_Price:  90.60933982637142
curr_Factors:  [90.60933983]
mat_Sqrt:  [[0.15]]
grads:  [-0.1192557]
Stock Position:  -0.11925569507516952
Bond Position:  [8.28480614]


portfolio before change:  [-2.63247849]
curr_Stock_Price:  91.56255456295987
curr_Factors:  [91.56255456]
mat_Sqrt:  [[0.15]]
grads:  [0.09209158]
Stock Position:  0.09209158339562282
Bond Position:  [-11.06461912]


portfolio before change:  [-2.45722269]
curr_Stock_Price:  93.49565517574264
curr_Factors:  [93.49565518]
mat_Sqrt:  [[0.15]]
grads:  [0.18307538]
Stock Position:  0.18307537753898265
Bond Position:  [-19.57397506]


portfolio before change:  [-2.4224494]
curr_Stock_Price:  93.71232768871161
curr_Factors:  [93.71232769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03079667]
Stock Position:  -0.03079667009894817
Bond Position:  [0.46357824]


portfolio before change:  [-2.4172082]
curr_Stock_Price:  93.54590416843949
curr_Factors:  [93.54590417]
mat_Sqrt:  [[0.15]]
grads:  [-0.10624749]
Stock Position:  -0.10624748761200639
Bond Position:  [7.5218091]


portfolio before change:  [-2.30886597]
curr_Stock_Price:  92.54388948504815
curr_Factors:  [92.54388949]
mat_Sqrt:  [[0.15]]
grads:  [0.03918566]
Stock Position:  0.03918565871090864
Bond Position:  [-5.93525924]


portfolio before change:  [-2.21277638]
curr_Stock_Price:  95.03392271823722
curr_Factors:  [95.03392272]
mat_Sqrt:  [[0.15]]
grads:  [0.01951502]
Stock Position:  0.019515021611411297
Bond Position:  [-4.06736543]


portfolio before change:  [-2.20106356]
curr_Stock_Price:  95.68622952832902
curr_Factors:  [95.68622953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02152416]
Stock Position:  -0.02152416169601224
Bond Position:  [-0.14149769]


portfolio before change:  [-2.19069739]
curr_Stock_Price:  95.20297947048299
curr_Factors:  [95.20297947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.19069739]
Stock Price:  92.91566612712563
PL:  [-2.19069739]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.19988880e-02]
 [ 5.73453247e-03]
 [ 1.38005560e-03]
 [ 1.27100625e-02]
 [ 3.95232373e-03]
 [ 2.56811096e-03]
 [-9.60637482e-03]
 [ 1.22511023e-02]
 [ 4.26883819e-03]
 [ 1.09210649e-02]
 [-1.78104867e-02]
 [-1.80257471e-03]
 [-1.53850271e-02]
 [ 2.62559132e-04]
 [-1.61250948e-02]
 [ 7.03211313e-03]
 [ 4.69532597e-03]
 [-1.68540107e-03]
 [-1.28032642e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.35004828]
curr_Stock_Price:  98.69476971371292
curr_Factors:  [98.69476971]
mat_Sqrt:  [[0.15]]
grads:  [0.14665925]
Stock Position:  0.1466592532843152
Bond Position:  [-32.82454951]


portfolio before change:  [-18.36377839]
curr_Stock_Price:  98.65711138406112
curr_Factors:  [98.65711138]
mat_Sqrt:  [[0.15]]
grads:  [0.03823022]
Stock Position:  0.03823021643866798
Bond Position:  [-22.13546111]


portfolio before change:  [-18.32260839]
curr_Stock_Price:  99.87877732057636
curr_Factors:  [99.87877732]
mat_Sqrt:  [[0.15]]
grads:  [0.00920037]
Stock Position:  0.009200370661098538
Bond Position:  [-19.24153016]


portfolio before change:  [-18.31572086]
curr_Stock_Price:  101.1503034059853
curr_Factors:  [101.15030341]
mat_Sqrt:  [[0.15]]
grads:  [0.08473375]
Stock Position:  0.08473374990080289
Bond Position:  [-26.88656538]


portfolio before change:  [-18.47080923]
curr_Stock_Price:  99.39933778670982
curr_Factors:  [99.39933779]
mat_Sqrt:  [[0.15]]
grads:  [0.02634882]
Stock Position:  0.026348824895013254
Bond Position:  [-21.08986498]


portfolio before change:  [-18.52786841]
curr_Stock_Price:  97.43393500693037
curr_Factors:  [97.43393501]
mat_Sqrt:  [[0.15]]
grads:  [0.01712074]
Stock Position:  0.017120739740321585
Bond Position:  [-20.19600945]


portfolio before change:  [-18.51381242]
curr_Stock_Price:  98.54986909379589
curr_Factors:  [98.54986909]
mat_Sqrt:  [[0.15]]
grads:  [-0.0640425]
Stock Position:  -0.06404249879956771
Bond Position:  [-12.20243255]


portfolio before change:  [-18.57471784]
curr_Stock_Price:  99.45324458884588
curr_Factors:  [99.45324459]
mat_Sqrt:  [[0.15]]
grads:  [0.08167402]
Stock Position:  0.0816740154997368
Bond Position:  [-26.69746368]


portfolio before change:  [-18.43673366]
curr_Stock_Price:  101.22442457735686
curr_Factors:  [101.22442458]
mat_Sqrt:  [[0.15]]
grads:  [0.02845892]
Stock Position:  0.028458921262540668
Bond Position:  [-21.31747159]


portfolio before change:  [-18.49187709]
curr_Stock_Price:  99.47406325745905
curr_Factors:  [99.47406326]
mat_Sqrt:  [[0.15]]
grads:  [0.0728071]
Stock Position:  0.07280709954288915
Bond Position:  [-25.73429511]


portfolio before change:  [-18.48532464]
curr_Stock_Price:  99.65243628473398
curr_Factors:  [99.65243628]
mat_Sqrt:  [[0.15]]
grads:  [-0.11873658]
Stock Position:  -0.11873657777138195
Bond Position:  [-6.65293539]


portfolio before change:  [-18.58840181]
curr_Stock_Price:  100.50654313759611
curr_Factors:  [100.50654314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01201716]
Stock Position:  -0.0120171647653652
Bond Position:  [-17.38059812]


portfolio before change:  [-18.57018024]
curr_Stock_Price:  98.62862401639049
curr_Factors:  [98.62862402]
mat_Sqrt:  [[0.15]]
grads:  [-0.10256685]
Stock Position:  -0.10256684720719
Bond Position:  [-8.45415323]


portfolio before change:  [-18.5154463]
curr_Stock_Price:  98.07437343693252
curr_Factors:  [98.07437344]
mat_Sqrt:  [[0.15]]
grads:  [0.00175039]
Stock Position:  0.001750394214090424
Bond Position:  [-18.68711512]


portfolio before change:  [-18.51907295]
curr_Stock_Price:  98.67179238746732
curr_Factors:  [98.67179239]
mat_Sqrt:  [[0.15]]
grads:  [-0.10750063]
Stock Position:  -0.10750063172686763
Bond Position:  [-7.91179293]


portfolio before change:  [-18.2974432]
curr_Stock_Price:  96.59173074856368
curr_Factors:  [96.59173075]
mat_Sqrt:  [[0.15]]
grads:  [0.04688075]
Stock Position:  0.046880754199654505
Bond Position:  [-22.82573639]


portfolio before change:  [-18.20530005]
curr_Stock_Price:  98.67894761502026
curr_Factors:  [98.67894762]
mat_Sqrt:  [[0.15]]
grads:  [0.03130217]
Stock Position:  0.031302173134303966
Bond Position:  [-21.29416555]


portfolio before change:  [-18.20380013]
curr_Stock_Price:  98.89695569088062
curr_Factors:  [98.89695569]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123601]
Stock Position:  -0.011236007102254376
Bond Position:  [-17.09259323]


portfolio before change:  [-18.20977402]
curr_Stock_Price:  99.04827355526926
curr_Factors:  [99.04827356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.20977402]
Stock Price:  98.97965860440081
PL:  [-18.20977402]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.35527121e-03]
 [ 7.22325708e-03]
 [-1.96468778e-03]
 [ 6.93978600e-04]
 [-6.93258809e-04]
 [ 2.39249156e-03]
 [-4.10555491e-03]
 [ 1.22846165e-02]
 [ 3.71990391e-03]
 [ 1.25605703e-02]
 [-1.81131694e-02]
 [ 6.02911955e-03]
 [-1.44896616e-02]
 [ 1.71020061e-03]
 [-1.48905808e-02]
 [ 7.77825194e-03]
 [ 7.45843658e-03]
 [-4.49366800e-03]
 [-1.10865298e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94368083]
curr_Stock_Price:  99.6293736398544
curr_Factors:  [99.62937364]
mat_Sqrt:  [[0.15]]
grads:  [0.01570181]
Stock Position:  0.015701808073968367
Bond Position:  [-5.50804213]


portfolio before change:  [-3.95513262]
curr_Stock_Price:  98.98775291911986
curr_Factors:  [98.98775292]
mat_Sqrt:  [[0.15]]
grads:  [0.04815505]
Stock Position:  0.04815504719715521
Bond Position:  [-8.72189253]


portfolio before change:  [-4.0106185]
curr_Stock_Price:  97.8808048752658
curr_Factors:  [97.88080488]
mat_Sqrt:  [[0.15]]
grads:  [-0.01309792]
Stock Position:  -0.013097918504201625
Bond Position:  [-2.72858369]


portfolio before change:  [-4.01029064]
curr_Stock_Price:  97.80368694847311
curr_Factors:  [97.80368695]
mat_Sqrt:  [[0.15]]
grads:  [0.00462652]
Stock Position:  0.0046265239975380856
Bond Position:  [-4.46278175]


portfolio before change:  [-4.01279287]
curr_Stock_Price:  97.50402550827356
curr_Factors:  [97.50402551]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462173]
Stock Position:  -0.0046217253923164
Bond Position:  [-3.56215604]


portfolio before change:  [-4.0130581]
curr_Stock_Price:  97.36870421316712
curr_Factors:  [97.36870421]
mat_Sqrt:  [[0.15]]
grads:  [0.01594994]
Stock Position:  0.015949943702669764
Bond Position:  [-5.56608345]


portfolio before change:  [-4.02362378]
curr_Stock_Price:  96.79353116203015
curr_Factors:  [96.79353116]
mat_Sqrt:  [[0.15]]
grads:  [-0.02737037]
Stock Position:  -0.027370366054694832
Bond Position:  [-1.3743494]


portfolio before change:  [-4.09178418]
curr_Stock_Price:  99.27127573913911
curr_Factors:  [99.27127574]
mat_Sqrt:  [[0.15]]
grads:  [0.08189744]
Stock Position:  0.08189744348167667
Bond Position:  [-12.22184788]


portfolio before change:  [-4.10898286]
curr_Stock_Price:  99.09858611821883
curr_Factors:  [99.09858612]
mat_Sqrt:  [[0.15]]
grads:  [0.02479936]
Stock Position:  0.024799359419271902
Bond Position:  [-6.56656432]


portfolio before change:  [-4.11851262]
curr_Stock_Price:  98.78051715132307
curr_Factors:  [98.78051715]
mat_Sqrt:  [[0.15]]
grads:  [0.08373714]
Stock Position:  0.08373713516301559
Bond Position:  [-12.39011013]


portfolio before change:  [-4.06911202]
curr_Stock_Price:  99.4074613932501
curr_Factors:  [99.40746139]
mat_Sqrt:  [[0.15]]
grads:  [-0.12075446]
Stock Position:  -0.12075446269943796
Bond Position:  [7.93478257]


portfolio before change:  [-4.05916393]
curr_Stock_Price:  99.34150822409237
curr_Factors:  [99.34150822]
mat_Sqrt:  [[0.15]]
grads:  [0.04019413]
Stock Position:  0.04019413036096663
Bond Position:  [-8.05210947]


portfolio before change:  [-4.09424832]
curr_Stock_Price:  98.51872369717036
curr_Factors:  [98.5187237]
mat_Sqrt:  [[0.15]]
grads:  [-0.09659774]
Stock Position:  -0.09659774406074191
Bond Position:  [5.42243814]


portfolio before change:  [-4.12227529]
curr_Stock_Price:  98.82290003555013
curr_Factors:  [98.82290004]
mat_Sqrt:  [[0.15]]
grads:  [0.01140134]
Stock Position:  0.011401337381172633
Bond Position:  [-5.24898851]


portfolio before change:  [-4.11912582]
curr_Stock_Price:  99.21424750404674
curr_Factors:  [99.2142475]
mat_Sqrt:  [[0.15]]
grads:  [-0.09927054]
Stock Position:  -0.09927053854299256
Bond Position:  [5.72992596]


portfolio before change:  [-4.19098341]
curr_Stock_Price:  99.95253552777453
curr_Factors:  [99.95253553]
mat_Sqrt:  [[0.15]]
grads:  [0.05185501]
Stock Position:  0.05185501290651643
Bond Position:  [-9.37402343]


portfolio before change:  [-4.12134106]
curr_Stock_Price:  101.34075503180995
curr_Factors:  [101.34075503]
mat_Sqrt:  [[0.15]]
grads:  [0.04972291]
Stock Position:  0.04972291054554266
Bond Position:  [-9.16029836]


portfolio before change:  [-4.07270675]
curr_Stock_Price:  102.36492431742344
curr_Factors:  [102.36492432]
mat_Sqrt:  [[0.15]]
grads:  [-0.02995779]
Stock Position:  -0.029957786641461003
Bond Position:  [-1.00608019]


portfolio before change:  [-4.12487916]
curr_Stock_Price:  104.09805850076309
curr_Factors:  [104.0980585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.12487916]
Stock Price:  103.30392788226409
PL:  [-7.42880705]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.72240135e-03]
 [ 5.48554080e-03]
 [-1.55538111e-03]
 [-2.30214351e-03]
 [-8.82490160e-03]
 [-9.47535749e-04]
 [-2.91245204e-03]
 [ 2.55332321e-03]
 [ 4.53075394e-03]
 [-2.82628427e-02]
 [-1.76292052e-02]
 [ 1.10064775e-02]
 [ 3.51869167e-02]
 [-5.81285238e-03]
 [-1.57154270e-02]
 [ 5.69675622e-03]
 [ 1.91492660e-03]
 [-4.39023111e-03]
 [-1.19540159e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.50894387]
curr_Stock_Price:  99.46295383140408
curr_Factors:  [99.46295383]
mat_Sqrt:  [[0.15]]
grads:  [0.03814934]
Stock Position:  0.038149342326372675
Bond Position:  [-10.30339015]


portfolio before change:  [-6.54400255]
curr_Stock_Price:  98.61149720548174
curr_Factors:  [98.61149721]
mat_Sqrt:  [[0.15]]
grads:  [0.03657027]
Stock Position:  0.0365702720307064
Bond Position:  [-10.15025183]


portfolio before change:  [-6.56379915]
curr_Stock_Price:  98.13956424715786
curr_Factors:  [98.13956425]
mat_Sqrt:  [[0.15]]
grads:  [-0.01036921]
Stock Position:  -0.010369207372252554
Bond Position:  [-5.54616966]


portfolio before change:  [-6.54393199]
curr_Stock_Price:  96.089853897562
curr_Factors:  [96.0898539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534762]
Stock Position:  -0.015347623400722028
Bond Position:  [-5.0691811]


portfolio before change:  [-6.53833898]
curr_Stock_Price:  95.6428489684742
curr_Factors:  [95.64284897]
mat_Sqrt:  [[0.15]]
grads:  [-0.05883268]
Stock Position:  -0.05883267735758991
Bond Position:  [-0.91141411]


portfolio before change:  [-6.567116]
curr_Stock_Price:  96.12810878203794
curr_Factors:  [96.12810878]
mat_Sqrt:  [[0.15]]
grads:  [-0.0063169]
Stock Position:  -0.0063169049940741545
Bond Position:  [-5.95988387]


portfolio before change:  [-6.57013202]
curr_Stock_Price:  96.36966178107461
curr_Factors:  [96.36966178]
mat_Sqrt:  [[0.15]]
grads:  [-0.01941635]
Stock Position:  -0.019416346914042093
Bond Position:  [-4.69898524]


portfolio before change:  [-6.56300762]
curr_Stock_Price:  95.94222290229789
curr_Factors:  [95.9422229]
mat_Sqrt:  [[0.15]]
grads:  [0.01702215]
Stock Position:  0.017022154762463042
Bond Position:  [-8.19615098]


portfolio before change:  [-6.58093121]
curr_Stock_Price:  95.00965601924952
curr_Factors:  [95.00965602]
mat_Sqrt:  [[0.15]]
grads:  [0.03020503]
Stock Position:  0.030205026278265764
Bond Position:  [-9.45070036]


portfolio before change:  [-6.63447312]
curr_Stock_Price:  93.31527118662649
curr_Factors:  [93.31527119]
mat_Sqrt:  [[0.15]]
grads:  [-0.18841895]
Stock Position:  -0.18841895152946056
Bond Position:  [10.94789244]


portfolio before change:  [-6.44995921]
curr_Stock_Price:  92.35052432347614
curr_Factors:  [92.35052432]
mat_Sqrt:  [[0.15]]
grads:  [-0.11752803]
Stock Position:  -0.11752803475647607
Bond Position:  [4.40381642]


portfolio before change:  [-6.56149403]
curr_Stock_Price:  93.3088991601508
curr_Factors:  [93.30889916]
mat_Sqrt:  [[0.15]]
grads:  [0.07337652]
Stock Position:  0.07337651694457233
Bond Position:  [-13.40817605]


portfolio before change:  [-6.62091599]
curr_Stock_Price:  92.54476507810675
curr_Factors:  [92.54476508]
mat_Sqrt:  [[0.15]]
grads:  [0.23457944]
Stock Position:  0.23457944448761564
Bond Position:  [-28.33001557]


portfolio before change:  [-6.66341017]
curr_Stock_Price:  92.39381070774412
curr_Factors:  [92.39381071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03875235]
Stock Position:  -0.03875234918436343
Bond Position:  [-3.08293295]


portfolio before change:  [-6.67834772]
curr_Stock_Price:  92.75938120715219
curr_Factors:  [92.75938121]
mat_Sqrt:  [[0.15]]
grads:  [-0.10476951]
Stock Position:  -0.10476951324078332
Bond Position:  [3.0400075]


portfolio before change:  [-6.58179741]
curr_Stock_Price:  91.84508656795332
curr_Factors:  [91.84508657]
mat_Sqrt:  [[0.15]]
grads:  [0.03797837]
Stock Position:  0.03797837477434655
Bond Position:  [-10.06992453]


portfolio before change:  [-6.53405442]
curr_Stock_Price:  93.16849195209181
curr_Factors:  [93.16849195]
mat_Sqrt:  [[0.15]]
grads:  [0.01276618]
Stock Position:  0.012766177312959372
Bond Position:  [-7.72345991]


portfolio before change:  [-6.52134716]
curr_Stock_Price:  94.31514468524853
curr_Factors:  [94.31514469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02926821]
Stock Position:  -0.029268207416510112
Bond Position:  [-3.76091194]


portfolio before change:  [-6.53554192]
curr_Stock_Price:  94.76800511613538
curr_Factors:  [94.76800512]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.53554192]
Stock Price:  94.17843751687322
PL:  [-6.53554192]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.50261685e-02]
 [ 4.89726865e-04]
 [-4.53810795e-03]
 [-3.28624482e-03]
 [-4.70303387e-03]
 [-2.97324758e-03]
 [ 3.42204307e-03]
 [-2.84474452e-03]
 [ 4.54953462e-03]
 [-2.31248188e-02]
 [-1.73859989e-02]
 [ 1.04774261e-02]
 [ 1.83906445e-02]
 [-4.25209570e-03]
 [-1.60788881e-02]
 [ 6.09944382e-03]
 [ 3.10088522e-03]
 [-2.47167876e-03]
 [-1.27009056e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.09296915]
curr_Stock_Price:  99.03581937903074
curr_Factors:  [99.03581938]
mat_Sqrt:  [[0.15]]
grads:  [0.10017446]
Stock Position:  0.10017445636348386
Bond Position:  [-23.01382852]


portfolio before change:  [-13.24487404]
curr_Stock_Price:  97.57685750616447
curr_Factors:  [97.57685751]
mat_Sqrt:  [[0.15]]
grads:  [0.00326485]
Stock Position:  0.0032648457640552997
Bond Position:  [-13.56344743]


portfolio before change:  [-13.25260848]
curr_Stock_Price:  96.2465768955102
curr_Factors:  [96.2465769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03025405]
Stock Position:  -0.03025405300483352
Bond Position:  [-10.34075945]


portfolio before change:  [-13.2334218]
curr_Stock_Price:  95.52693113244851
curr_Factors:  [95.52693113]
mat_Sqrt:  [[0.15]]
grads:  [-0.0219083]
Stock Position:  -0.02190829877002676
Bond Position:  [-11.14058925]


portfolio before change:  [-13.25554319]
curr_Stock_Price:  96.40951448231272
curr_Factors:  [96.40951448]
mat_Sqrt:  [[0.15]]
grads:  [-0.03135356]
Stock Position:  -0.03135355913108563
Bond Position:  [-10.23276178]


portfolio before change:  [-13.22568772]
curr_Stock_Price:  95.37569312501594
curr_Factors:  [95.37569313]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982165]
Stock Position:  -0.01982165051511878
Bond Position:  [-11.33518407]


portfolio before change:  [-13.21116375]
curr_Stock_Price:  94.49997782543824
curr_Factors:  [94.49997783]
mat_Sqrt:  [[0.15]]
grads:  [0.02281362]
Stock Position:  0.02281362047054906
Bond Position:  [-15.36705038]


portfolio before change:  [-13.21170558]
curr_Stock_Price:  94.64464619278887
curr_Factors:  [94.64464619]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896496]
Stock Position:  -0.01896496349201384
Bond Position:  [-11.41677332]


portfolio before change:  [-13.22686849]
curr_Stock_Price:  95.29365094881368
curr_Factors:  [95.29365095]
mat_Sqrt:  [[0.15]]
grads:  [0.03033023]
Stock Position:  0.030330230814633284
Bond Position:  [-16.11714691]


portfolio before change:  [-13.27093479]
curr_Stock_Price:  93.97363078717683
curr_Factors:  [93.97363079]
mat_Sqrt:  [[0.15]]
grads:  [-0.15416546]
Stock Position:  -0.1541654584407716
Bond Position:  [1.21655308]


portfolio before change:  [-13.22392563]
curr_Stock_Price:  93.6706771287466
curr_Factors:  [93.67067713]
mat_Sqrt:  [[0.15]]
grads:  [-0.11590666]
Stock Position:  -0.11590665966254173
Bond Position:  [-2.36687033]


portfolio before change:  [-13.22073135]
curr_Stock_Price:  93.638012310095
curr_Factors:  [93.63801231]
mat_Sqrt:  [[0.15]]
grads:  [0.06984951]
Stock Position:  0.06984950716595943
Bond Position:  [-19.76130036]


portfolio before change:  [-13.15763288]
curr_Stock_Price:  94.61209812260742
curr_Factors:  [94.61209812]
mat_Sqrt:  [[0.15]]
grads:  [0.1226043]
Stock Position:  0.12260429636712818
Bond Position:  [-24.75748259]


portfolio before change:  [-13.22436873]
curr_Stock_Price:  94.11826788850584
curr_Factors:  [94.11826789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0283473]
Stock Position:  -0.02834730463452877
Bond Position:  [-10.55636952]


portfolio before change:  [-13.22504037]
curr_Stock_Price:  94.04885111769379
curr_Factors:  [94.04885112]
mat_Sqrt:  [[0.15]]
grads:  [-0.10719259]
Stock Position:  -0.10719258742176391
Bond Position:  [-3.14370068]


portfolio before change:  [-13.15616544]
curr_Stock_Price:  93.39898378897274
curr_Factors:  [93.39898379]
mat_Sqrt:  [[0.15]]
grads:  [0.04066296]
Stock Position:  0.0406629588081459
Bond Position:  [-16.95404447]


portfolio before change:  [-13.08091273]
curr_Stock_Price:  95.35387718139978
curr_Factors:  [95.35387718]
mat_Sqrt:  [[0.15]]
grads:  [0.02067257]
Stock Position:  0.020672568111483724
Bond Position:  [-15.05212225]


portfolio before change:  [-13.05680997]
curr_Stock_Price:  96.70185952033897
curr_Factors:  [96.70185952]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647786]
Stock Position:  -0.016477858388943008
Bond Position:  [-11.46337042]


portfolio before change:  [-13.0782226]
curr_Stock_Price:  97.82739581952717
curr_Factors:  [97.82739582]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.0782226]
Stock Price:  98.21710471746132
PL:  [-13.0782226]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.38129357e-03]
 [ 4.66216787e-03]
 [ 1.01060018e-04]
 [ 3.38659622e-03]
 [ 1.99132959e-02]
 [ 5.18554825e-03]
 [ 1.59748479e-02]
 [ 1.12858347e-02]
 [ 8.06034811e-03]
 [ 2.62054637e-03]
 [-1.44183255e-02]
 [-8.74701224e-03]
 [-2.42644774e-02]
 [ 3.64819072e-03]
 [-1.11915042e-02]
 [ 7.80501573e-03]
 [ 7.47368701e-03]
 [-2.45499343e-03]
 [-1.21053200e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.26099399]
curr_Stock_Price:  99.47903942235321
curr_Factors:  [99.47903942]
mat_Sqrt:  [[0.15]]
grads:  [0.03587529]
Stock Position:  0.03587529046409298
Bond Position:  [-9.82983342]


portfolio before change:  [-6.29998645]
curr_Stock_Price:  98.4606589005455
curr_Factors:  [98.4606589]
mat_Sqrt:  [[0.15]]
grads:  [0.03108112]
Stock Position:  0.031081119127302853
Bond Position:  [-9.36025392]


portfolio before change:  [-6.28887408]
curr_Stock_Price:  98.89348523688201
curr_Factors:  [98.89348524]
mat_Sqrt:  [[0.15]]
grads:  [0.00067373]
Stock Position:  0.0006737334558689097
Bond Position:  [-6.35550193]


portfolio before change:  [-6.28987086]
curr_Stock_Price:  99.7726142737431
curr_Factors:  [99.77261427]
mat_Sqrt:  [[0.15]]
grads:  [0.02257731]
Stock Position:  0.022577308128792807
Bond Position:  [-8.54246791]


portfolio before change:  [-6.25990516]
curr_Stock_Price:  101.1944659833853
curr_Factors:  [101.19446598]
mat_Sqrt:  [[0.15]]
grads:  [0.13275531]
Stock Position:  0.13275530592932527
Bond Position:  [-19.69400745]


portfolio before change:  [-6.28628215]
curr_Stock_Price:  101.03286883571957
curr_Factors:  [101.03286884]
mat_Sqrt:  [[0.15]]
grads:  [0.03457032]
Stock Position:  0.03457032163952721
Bond Position:  [-9.77902092]


portfolio before change:  [-6.29994627]
curr_Stock_Price:  100.70834027274645
curr_Factors:  [100.70834027]
mat_Sqrt:  [[0.15]]
grads:  [0.10649899]
Stock Position:  0.106498986264903
Bond Position:  [-17.02528242]


portfolio before change:  [-6.20803011]
curr_Stock_Price:  101.61138186833735
curr_Factors:  [101.61138187]
mat_Sqrt:  [[0.15]]
grads:  [0.0752389]
Stock Position:  0.0752388981369596
Bond Position:  [-13.85315852]


portfolio before change:  [-6.12869539]
curr_Stock_Price:  102.71185579001369
curr_Factors:  [102.71185579]
mat_Sqrt:  [[0.15]]
grads:  [0.05373565]
Stock Position:  0.05373565409401563
Bond Position:  [-11.64798414]


portfolio before change:  [-6.14155544]
curr_Stock_Price:  102.52673303203858
curr_Factors:  [102.52673303]
mat_Sqrt:  [[0.15]]
grads:  [0.01747031]
Stock Position:  0.017470309160620805
Bond Position:  [-7.93272916]


portfolio before change:  [-6.14607638]
curr_Stock_Price:  102.38148595144592
curr_Factors:  [102.38148595]
mat_Sqrt:  [[0.15]]
grads:  [-0.09612217]
Stock Position:  -0.09612216988249743
Bond Position:  [3.69505421]


portfolio before change:  [-6.18376595]
curr_Stock_Price:  102.78319819222135
curr_Factors:  [102.78319819]
mat_Sqrt:  [[0.15]]
grads:  [-0.05831341]
Stock Position:  -0.05831341492311077
Bond Position:  [-0.19012667]


portfolio before change:  [-6.1040268]
curr_Stock_Price:  101.41495907382192
curr_Factors:  [101.41495907]
mat_Sqrt:  [[0.15]]
grads:  [-0.16176318]
Stock Position:  -0.16176318240033666
Bond Position:  [10.30117973]


portfolio before change:  [-5.79850738]
curr_Stock_Price:  99.542197968776
curr_Factors:  [99.54219797]
mat_Sqrt:  [[0.15]]
grads:  [0.02432127]
Stock Position:  0.02432127144170407
Bond Position:  [-8.2195002]


portfolio before change:  [-5.79082704]
curr_Stock_Price:  99.9424845498148
curr_Factors:  [99.94248455]
mat_Sqrt:  [[0.15]]
grads:  [-0.07461003]
Stock Position:  -0.07461002800676081
Bond Position:  [1.66588454]


portfolio before change:  [-5.81749319]
curr_Stock_Price:  100.3054743900382
curr_Factors:  [100.30547439]
mat_Sqrt:  [[0.15]]
grads:  [0.05203344]
Stock Position:  0.05203343820095827
Bond Position:  [-11.0367319]


portfolio before change:  [-5.74222053]
curr_Stock_Price:  101.80512920095889
curr_Factors:  [101.8051292]
mat_Sqrt:  [[0.15]]
grads:  [0.04982458]
Stock Position:  0.049824580060817414
Bond Position:  [-10.81461834]


portfolio before change:  [-5.812369]
curr_Stock_Price:  100.45149051129529
curr_Factors:  [100.45149051]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636662]
Stock Position:  -0.016366622834041198
Bond Position:  [-4.16831734]


portfolio before change:  [-5.83841017]
curr_Stock_Price:  101.97892613773202
curr_Factors:  [101.97892614]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.83841017]
Stock Price:  103.11297592018526
PL:  [-8.95138609]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.67915027e-02]
 [ 5.33263230e-04]
 [-4.52891649e-03]
 [-6.23683555e-03]
 [-1.81244761e-02]
 [-4.98950511e-03]
 [-1.21372763e-03]
 [ 3.94589883e-03]
 [ 4.61468766e-03]
 [-1.12167748e-02]
 [-1.75564318e-02]
 [ 6.57454339e-03]
 [-9.34139318e-03]
 [ 1.64128295e-03]
 [-4.37872609e-03]
 [ 3.83838006e-03]
 [ 7.48700551e-03]
 [-3.60915201e-03]
 [-1.24535924e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.04859332]
curr_Stock_Price:  98.45482895690289
curr_Factors:  [98.45482896]
mat_Sqrt:  [[0.15]]
grads:  [0.17861002]
Stock Position:  0.17861001803406812
Bond Position:  [-39.63361209]


portfolio before change:  [-22.21346203]
curr_Stock_Price:  97.58724565755014
curr_Factors:  [97.58724566]
mat_Sqrt:  [[0.15]]
grads:  [0.00355509]
Stock Position:  0.003555088199173531
Bond Position:  [-22.56039329]


portfolio before change:  [-22.22384768]
curr_Stock_Price:  96.25258009371109
curr_Factors:  [96.25258009]
mat_Sqrt:  [[0.15]]
grads:  [-0.03019278]
Stock Position:  -0.030192776574116155
Bond Position:  [-19.31771504]


portfolio before change:  [-22.15580934]
curr_Stock_Price:  93.83914280767995
curr_Factors:  [93.83914281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0415789]
Stock Position:  -0.041578903650745874
Bond Position:  [-18.25408067]


portfolio before change:  [-22.16262218]
curr_Stock_Price:  93.89322651409485
curr_Factors:  [93.89322651]
mat_Sqrt:  [[0.15]]
grads:  [-0.12082984]
Stock Position:  -0.12082984072161528
Bond Position:  [-10.81751857]


portfolio before change:  [-22.25396314]
curr_Stock_Price:  94.62678910257192
curr_Factors:  [94.6267891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03326337]
Stock Position:  -0.03326336740179628
Bond Position:  [-19.10635749]


portfolio before change:  [-22.30003609]
curr_Stock_Price:  95.86826779229118
curr_Factors:  [95.86826779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00809152]
Stock Position:  -0.008091517533482667
Bond Position:  [-21.52431632]


portfolio before change:  [-22.30872484]
curr_Stock_Price:  96.27696743847646
curr_Factors:  [96.27696744]
mat_Sqrt:  [[0.15]]
grads:  [0.02630599]
Stock Position:  0.026305992180489235
Bond Position:  [-24.841386]


portfolio before change:  [-22.31488585]
curr_Stock_Price:  96.27887251897074
curr_Factors:  [96.27887252]
mat_Sqrt:  [[0.15]]
grads:  [0.03076458]
Stock Position:  0.030764584378973628
Bond Position:  [-25.27686535]


portfolio before change:  [-22.34091211]
curr_Stock_Price:  95.63832272905499
curr_Factors:  [95.63832273]
mat_Sqrt:  [[0.15]]
grads:  [-0.0747785]
Stock Position:  -0.074778498556122
Bond Position:  [-15.18922193]


portfolio before change:  [-22.32006431]
curr_Stock_Price:  95.30874166464372
curr_Factors:  [95.30874166]
mat_Sqrt:  [[0.15]]
grads:  [-0.11704288]
Stock Position:  -0.11704287870384493
Bond Position:  [-11.16485482]


portfolio before change:  [-22.44145375]
curr_Stock_Price:  96.32202734952742
curr_Factors:  [96.32202735]
mat_Sqrt:  [[0.15]]
grads:  [0.04383029]
Stock Position:  0.04383028924666388
Bond Position:  [-26.66327607]


portfolio before change:  [-22.37953565]
curr_Stock_Price:  97.88680705355651
curr_Factors:  [97.88680705]
mat_Sqrt:  [[0.15]]
grads:  [-0.06227595]
Stock Position:  -0.06227595452950957
Bond Position:  [-16.28354131]


portfolio before change:  [-22.43984199]
curr_Stock_Price:  98.78980322336533
curr_Factors:  [98.78980322]
mat_Sqrt:  [[0.15]]
grads:  [0.01094189]
Stock Position:  0.010941886344496702
Bond Position:  [-23.52078879]


portfolio before change:  [-22.4241612]
curr_Stock_Price:  100.7603703848954
curr_Factors:  [100.76037038]
mat_Sqrt:  [[0.15]]
grads:  [-0.02919151]
Stock Position:  -0.02919150729196393
Bond Position:  [-19.48281412]


portfolio before change:  [-22.4738693]
curr_Stock_Price:  102.29632351573203
curr_Factors:  [102.29632352]
mat_Sqrt:  [[0.15]]
grads:  [0.0255892]
Stock Position:  0.02558920043098945
Bond Position:  [-25.09155043]


portfolio before change:  [-22.51064098]
curr_Stock_Price:  101.10449245484784
curr_Factors:  [101.10449245]
mat_Sqrt:  [[0.15]]
grads:  [0.04991337]
Stock Position:  0.04991337008189175
Bond Position:  [-27.55710693]


portfolio before change:  [-22.4897918]
curr_Stock_Price:  101.66024166337404
curr_Factors:  [101.66024166]
mat_Sqrt:  [[0.15]]
grads:  [-0.02406101]
Stock Position:  -0.024061013409424847
Bond Position:  [-20.04374336]


portfolio before change:  [-22.47843074]
curr_Stock_Price:  100.97977880950964
curr_Factors:  [100.97977881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.47843074]
Stock Price:  102.7343114345093
PL:  [-25.21274217]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.29041629e-02]
 [ 4.76063480e-03]
 [ 7.62631363e-04]
 [ 1.78528204e-03]
 [ 6.36898652e-03]
 [ 3.23560521e-03]
 [-1.12479453e-02]
 [ 1.14776137e-02]
 [ 4.65695979e-03]
 [ 1.13869132e-02]
 [-1.79422283e-02]
 [ 6.07382637e-03]
 [-1.59404086e-02]
 [ 2.29675409e-03]
 [-1.43224921e-02]
 [ 7.78556209e-03]
 [ 7.48440480e-03]
 [-5.18962762e-03]
 [-1.06787923e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.87093959]
curr_Stock_Price:  98.14198230972133
curr_Factors:  [98.14198231]
mat_Sqrt:  [[0.15]]
grads:  [0.21936109]
Stock Position:  0.21936108620150704
Bond Position:  [-48.39947143]


portfolio before change:  [-26.80917873]
curr_Stock_Price:  98.47869761027384
curr_Factors:  [98.47869761]
mat_Sqrt:  [[0.15]]
grads:  [0.03173757]
Stock Position:  0.0317375653524234
Bond Position:  [-29.93465283]


portfolio before change:  [-26.79621035]
curr_Stock_Price:  99.12313849351767
curr_Factors:  [99.12313849]
mat_Sqrt:  [[0.15]]
grads:  [0.00508421]
Stock Position:  0.005084209086353939
Bond Position:  [-27.30017311]


portfolio before change:  [-26.80657082]
curr_Stock_Price:  98.42793116421984
curr_Factors:  [98.42793116]
mat_Sqrt:  [[0.15]]
grads:  [0.01190188]
Stock Position:  0.011901880235538459
Bond Position:  [-27.97804827]


portfolio before change:  [-26.79772807]
curr_Stock_Price:  99.75865707273358
curr_Factors:  [99.75865707]
mat_Sqrt:  [[0.15]]
grads:  [0.04245991]
Stock Position:  0.042459910103080575
Bond Position:  [-31.03347168]


portfolio before change:  [-26.80165451]
curr_Stock_Price:  99.84892807966888
curr_Factors:  [99.84892808]
mat_Sqrt:  [[0.15]]
grads:  [0.0215707]
Stock Position:  0.021570701424789483
Bond Position:  [-28.95546592]


portfolio before change:  [-26.81304412]
curr_Stock_Price:  99.65654466644679
curr_Factors:  [99.65654467]
mat_Sqrt:  [[0.15]]
grads:  [-0.0749863]
Stock Position:  -0.0749863017555325
Bond Position:  [-19.34016839]


portfolio before change:  [-26.75163829]
curr_Stock_Price:  98.7731635762868
curr_Factors:  [98.77316358]
mat_Sqrt:  [[0.15]]
grads:  [0.07651742]
Stock Position:  0.07651742434259273
Bond Position:  [-34.30950636]


portfolio before change:  [-26.90216165]
curr_Stock_Price:  96.9180970789935
curr_Factors:  [96.91809708]
mat_Sqrt:  [[0.15]]
grads:  [0.0310464]
Stock Position:  0.031046398616978485
Bond Position:  [-29.91111952]


portfolio before change:  [-26.86085451]
curr_Stock_Price:  98.48948235300013
curr_Factors:  [98.48948235]
mat_Sqrt:  [[0.15]]
grads:  [0.07591275]
Stock Position:  0.07591275465156713
Bond Position:  [-34.33746242]


portfolio before change:  [-26.96023754]
curr_Stock_Price:  97.293404147514
curr_Factors:  [97.29340415]
mat_Sqrt:  [[0.15]]
grads:  [-0.11961486]
Stock Position:  -0.11961485541527926
Bond Position:  [-15.32250107]


portfolio before change:  [-27.20467246]
curr_Stock_Price:  99.30489186220146
curr_Factors:  [99.30489186]
mat_Sqrt:  [[0.15]]
grads:  [0.04049218]
Stock Position:  0.04049217579537684
Bond Position:  [-31.22574359]


portfolio before change:  [-27.23710309]
curr_Stock_Price:  98.69679350183138
curr_Factors:  [98.6967935]
mat_Sqrt:  [[0.15]]
grads:  [-0.10626939]
Stock Position:  -0.10626939050210031
Bond Position:  [-16.748655]


portfolio before change:  [-27.28333661]
curr_Stock_Price:  99.092446785339
curr_Factors:  [99.09244679]
mat_Sqrt:  [[0.15]]
grads:  [0.01531169]
Stock Position:  0.015311693946440176
Bond Position:  [-28.80060983]


portfolio before change:  [-27.28668535]
curr_Stock_Price:  99.344039699613
curr_Factors:  [99.3440397]
mat_Sqrt:  [[0.15]]
grads:  [-0.09548328]
Stock Position:  -0.09548328079644251
Bond Position:  [-17.80099051]


portfolio before change:  [-27.39310257]
curr_Stock_Price:  100.41193781915568
curr_Factors:  [100.41193782]
mat_Sqrt:  [[0.15]]
grads:  [0.05190375]
Stock Position:  0.05190374729288214
Bond Position:  [-32.60485842]


portfolio before change:  [-27.31336228]
curr_Stock_Price:  102.10531306359019
curr_Factors:  [102.10531306]
mat_Sqrt:  [[0.15]]
grads:  [0.04989603]
Stock Position:  0.04989603201764876
Bond Position:  [-32.40801225]


portfolio before change:  [-27.23242271]
curr_Stock_Price:  103.88987558162812
curr_Factors:  [103.88987558]
mat_Sqrt:  [[0.15]]
grads:  [-0.03459752]
Stock Position:  -0.0345975174806733
Bond Position:  [-23.63809093]


portfolio before change:  [-27.27704146]
curr_Stock_Price:  105.0086981019071
curr_Factors:  [105.0086981]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.27704146]
Stock Price:  105.78691857362605
PL:  [-33.06396003]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.16650834e-02]
 [ 1.38041894e-03]
 [ 1.43847912e-03]
 [ 3.12499330e-03]
 [ 2.50563279e-02]
 [ 6.64138554e-03]
 [ 3.18148860e-02]
 [ 1.29120562e-02]
 [ 2.80280278e-03]
 [ 8.42993045e-03]
 [-1.56412881e-02]
 [-8.00479078e-03]
 [-2.29990635e-02]
 [ 1.98397787e-03]
 [-5.02988301e-03]
 [ 4.74269282e-03]
 [ 7.49631465e-03]
 [-5.15986153e-03]
 [-1.21449569e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.80962121]
curr_Stock_Price:  98.2108346642183
curr_Factors:  [98.21083466]
mat_Sqrt:  [[0.15]]
grads:  [0.21110056]
Stock Position:  0.2111005559047086
Bond Position:  [-46.541983]


portfolio before change:  [-25.91022657]
curr_Stock_Price:  97.78938429996825
curr_Factors:  [97.7893843]
mat_Sqrt:  [[0.15]]
grads:  [0.00920279]
Stock Position:  0.0092027929378558
Bond Position:  [-26.81016202]


portfolio before change:  [-25.90052595]
curr_Stock_Price:  99.57188670287957
curr_Factors:  [99.5718867]
mat_Sqrt:  [[0.15]]
grads:  [0.00958986]
Stock Position:  0.00958986077834188
Bond Position:  [-26.85540648]


portfolio before change:  [-25.90771491]
curr_Stock_Price:  99.52243049848651
curr_Factors:  [99.5224305]
mat_Sqrt:  [[0.15]]
grads:  [0.02083329]
Stock Position:  0.020833288678259433
Bond Position:  [-27.98109444]


portfolio before change:  [-25.86413365]
curr_Stock_Price:  101.95015159527868
curr_Factors:  [101.9501516]
mat_Sqrt:  [[0.15]]
grads:  [0.16704219]
Stock Position:  0.16704218623067518
Bond Position:  [-42.89410986]


portfolio before change:  [-25.72424998]
curr_Stock_Price:  102.85177135945379
curr_Factors:  [102.85177136]
mat_Sqrt:  [[0.15]]
grads:  [0.0442759]
Stock Position:  0.044275903592553074
Bond Position:  [-30.27810509]


portfolio before change:  [-25.7759419]
curr_Stock_Price:  101.85525991749569
curr_Factors:  [101.85525992]
mat_Sqrt:  [[0.15]]
grads:  [0.21209924]
Stock Position:  0.2120992398885439
Bond Position:  [-47.3793651]


portfolio before change:  [-25.91905582]
curr_Stock_Price:  101.23636285084126
curr_Factors:  [101.23636285]
mat_Sqrt:  [[0.15]]
grads:  [0.08608037]
Stock Position:  0.0860803749906328
Bond Position:  [-34.63351989]


portfolio before change:  [-26.04219025]
curr_Stock_Price:  99.90650145241425
curr_Factors:  [99.90650145]
mat_Sqrt:  [[0.15]]
grads:  [0.01868535]
Stock Position:  0.018685351875547963
Bond Position:  [-27.90897838]


portfolio before change:  [-26.0349515]
curr_Stock_Price:  100.66735773884201
curr_Factors:  [100.66735774]
mat_Sqrt:  [[0.15]]
grads:  [0.05619954]
Stock Position:  0.05619953630960265
Bond Position:  [-31.69241032]


portfolio before change:  [-25.99772894]
curr_Stock_Price:  101.47068544808911
curr_Factors:  [101.47068545]
mat_Sqrt:  [[0.15]]
grads:  [-0.10427525]
Stock Position:  -0.10427525397552094
Bond Position:  [-15.41684745]


portfolio before change:  [-26.11863509]
curr_Stock_Price:  102.59320917901535
curr_Factors:  [102.59320918]
mat_Sqrt:  [[0.15]]
grads:  [-0.05336527]
Stock Position:  -0.05336527188266118
Bond Position:  [-20.64372058]


portfolio before change:  [-26.09494172]
curr_Stock_Price:  102.05250293603372
curr_Factors:  [102.05250294]
mat_Sqrt:  [[0.15]]
grads:  [-0.15332709]
Stock Position:  -0.15332708970779596
Bond Position:  [-10.44752845]


portfolio before change:  [-26.01051378]
curr_Stock_Price:  101.48482661428481
curr_Factors:  [101.48482661]
mat_Sqrt:  [[0.15]]
grads:  [0.01322652]
Stock Position:  0.013226519112369177
Bond Position:  [-27.35280477]


portfolio before change:  [-26.02788394]
curr_Stock_Price:  100.68861457936679
curr_Factors:  [100.68861458]
mat_Sqrt:  [[0.15]]
grads:  [-0.03353255]
Stock Position:  -0.033532553370504876
Bond Position:  [-22.6515376]


portfolio before change:  [-26.07595049]
curr_Stock_Price:  101.95314565222307
curr_Factors:  [101.95314565]
mat_Sqrt:  [[0.15]]
grads:  [0.03161795]
Stock Position:  0.03161795214107093
Bond Position:  [-29.29950017]


portfolio before change:  [-26.06791823]
curr_Stock_Price:  102.43888395034199
curr_Factors:  [102.43888395]
mat_Sqrt:  [[0.15]]
grads:  [0.04997543]
Stock Position:  0.04997543099796527
Bond Position:  [-31.18734561]


portfolio before change:  [-26.03458356]
curr_Stock_Price:  103.26193811524263
curr_Factors:  [103.26193812]
mat_Sqrt:  [[0.15]]
grads:  [-0.03439908]
Stock Position:  -0.034399076899365374
Bond Position:  [-22.48246821]


portfolio before change:  [-25.992273]
curr_Stock_Price:  101.86853232092025
curr_Factors:  [101.86853232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.992273]
Stock Price:  103.0909564795833
PL:  [-29.08322948]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.05583332e-02]
 [ 8.69467591e-03]
 [ 1.06964279e-03]
 [ 3.32603802e-03]
 [ 9.47843191e-03]
 [ 4.03548414e-03]
 [ 1.27582335e-02]
 [ 1.32184991e-02]
 [ 4.20867137e-03]
 [ 6.71634220e-03]
 [-1.45048892e-02]
 [-1.34945161e-02]
 [-2.01020532e-02]
 [ 4.73135580e-03]
 [ 2.50798892e-02]
 [ 4.72505291e-03]
 [ 7.50865589e-03]
 [-1.67499959e-03]
 [-1.26178725e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.96852471]
curr_Stock_Price:  99.23851572515709
curr_Factors:  [99.23851573]
mat_Sqrt:  [[0.15]]
grads:  [0.07038889]
Stock Position:  0.0703888881999302
Bond Position:  [-16.95381349]


portfolio before change:  [-9.90905852]
curr_Stock_Price:  100.14356159734159
curr_Factors:  [100.1435616]
mat_Sqrt:  [[0.15]]
grads:  [0.05796451]
Stock Position:  0.057964506076022576
Bond Position:  [-15.7138306]


portfolio before change:  [-9.8940801]
curr_Stock_Price:  100.46975025507861
curr_Factors:  [100.46975026]
mat_Sqrt:  [[0.15]]
grads:  [0.00713095]
Stock Position:  0.00713095192800999
Bond Position:  [-10.61052506]


portfolio before change:  [-9.90259658]
curr_Stock_Price:  99.64748745496998
curr_Factors:  [99.64748745]
mat_Sqrt:  [[0.15]]
grads:  [0.02217359]
Stock Position:  0.022173586791375002
Bond Position:  [-12.11213879]


portfolio before change:  [-9.89397295]
curr_Stock_Price:  100.17297939058483
curr_Factors:  [100.17297939]
mat_Sqrt:  [[0.15]]
grads:  [0.06318955]
Stock Position:  0.06318954604489231
Bond Position:  [-16.22385805]


portfolio before change:  [-9.94104537]
curr_Stock_Price:  99.49223471804459
curr_Factors:  [99.49223472]
mat_Sqrt:  [[0.15]]
grads:  [0.02690323]
Stock Position:  0.026903227618375134
Bond Position:  [-12.61770761]


portfolio before change:  [-9.91388413]
curr_Stock_Price:  100.6190905306248
curr_Factors:  [100.61909053]
mat_Sqrt:  [[0.15]]
grads:  [0.08505489]
Stock Position:  0.0850548899348833
Bond Position:  [-18.4720298]


portfolio before change:  [-9.88535095]
curr_Stock_Price:  101.00885963126592
curr_Factors:  [101.00885963]
mat_Sqrt:  [[0.15]]
grads:  [0.08812333]
Stock Position:  0.08812332741234477
Bond Position:  [-18.78658776]


portfolio before change:  [-9.87831678]
curr_Stock_Price:  101.14198445289055
curr_Factors:  [101.14198445]
mat_Sqrt:  [[0.15]]
grads:  [0.02805781]
Stock Position:  0.02805780911074888
Bond Position:  [-12.71613927]


portfolio before change:  [-9.85814739]
curr_Stock_Price:  101.97415288695345
curr_Factors:  [101.97415289]
mat_Sqrt:  [[0.15]]
grads:  [0.04477561]
Stock Position:  0.044775614696878484
Bond Position:  [-14.42410277]


portfolio before change:  [-9.84589903]
curr_Stock_Price:  102.32824832283315
curr_Factors:  [102.32824832]
mat_Sqrt:  [[0.15]]
grads:  [-0.09669926]
Stock Position:  -0.0966992613436415
Bond Position:  [0.049167]


portfolio before change:  [-9.97821118]
curr_Stock_Price:  103.69666049900002
curr_Factors:  [103.6966605]
mat_Sqrt:  [[0.15]]
grads:  [-0.08996344]
Stock Position:  -0.08996344094314179
Bond Position:  [-0.64930279]


portfolio before change:  [-10.09279152]
curr_Stock_Price:  104.96848818933044
curr_Factors:  [104.96848819]
mat_Sqrt:  [[0.15]]
grads:  [-0.13401369]
Stock Position:  -0.13401368830020116
Bond Position:  [3.97442274]


portfolio before change:  [-10.06013072]
curr_Stock_Price:  104.73219091803897
curr_Factors:  [104.73219092]
mat_Sqrt:  [[0.15]]
grads:  [0.03154237]
Stock Position:  0.03154237197111053
Bond Position:  [-13.36363245]


portfolio before change:  [-10.08031404]
curr_Stock_Price:  104.19824257603479
curr_Factors:  [104.19824258]
mat_Sqrt:  [[0.15]]
grads:  [0.16719926]
Stock Position:  0.16719926141304242
Bond Position:  [-27.50218324]


portfolio before change:  [-10.46144974]
curr_Stock_Price:  101.95983982721731
curr_Factors:  [101.95983983]
mat_Sqrt:  [[0.15]]
grads:  [0.03150035]
Stock Position:  0.03150035271746171
Bond Position:  [-13.67322065]


portfolio before change:  [-10.50896635]
curr_Stock_Price:  100.55992264598271
curr_Factors:  [100.55992265]
mat_Sqrt:  [[0.15]]
grads:  [0.05005771]
Stock Position:  0.050057705917297586
Bond Position:  [-15.54276539]


portfolio before change:  [-10.59437198]
curr_Stock_Price:  98.93141326256931
curr_Factors:  [98.93141326]
mat_Sqrt:  [[0.15]]
grads:  [-0.01116666]
Stock Position:  -0.01116666395925122
Bond Position:  [-9.48963813]


portfolio before change:  [-10.61473084]
curr_Stock_Price:  100.54211473461027
curr_Factors:  [100.54211473]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.61473084]
Stock Price:  98.82029160115806
PL:  [-10.61473084]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.00788054e-03]
 [ 9.66069481e-03]
 [ 1.22860227e-03]
 [ 1.40101878e-02]
 [ 2.23415398e-02]
 [ 6.55014205e-03]
 [ 3.33331646e-02]
 [ 8.45902082e-03]
 [ 3.41139715e-03]
 [ 9.63410034e-03]
 [-1.75763805e-02]
 [ 5.83263316e-03]
 [-2.01557525e-02]
 [ 3.62050466e-03]
 [-6.93742066e-04]
 [ 6.63460526e-03]
 [ 7.47988385e-03]
 [-1.79733672e-03]
 [-1.28609169e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.71645755]
curr_Stock_Price:  99.44949151329735
curr_Factors:  [99.44949151]
mat_Sqrt:  [[0.15]]
grads:  [0.04005254]
Stock Position:  0.04005253690951948
Bond Position:  [-10.69966198]


portfolio before change:  [-6.72087518]
curr_Stock_Price:  99.405989226179
curr_Factors:  [99.40598923]
mat_Sqrt:  [[0.15]]
grads:  [0.06440463]
Stock Position:  0.06440463205751307
Bond Position:  [-13.12308134]


portfolio before change:  [-6.67391156]
curr_Stock_Price:  100.18613181338371
curr_Factors:  [100.18613181]
mat_Sqrt:  [[0.15]]
grads:  [0.00819068]
Stock Position:  0.008190681795919195
Bond Position:  [-7.49450429]


portfolio before change:  [-6.66341668]
curr_Stock_Price:  101.69623091828574
curr_Factors:  [101.69623092]
mat_Sqrt:  [[0.15]]
grads:  [0.09340125]
Stock Position:  0.09340125197893404
Bond Position:  [-16.16197197]


portfolio before change:  [-6.68601778]
curr_Stock_Price:  101.49751736168822
curr_Factors:  [101.49751736]
mat_Sqrt:  [[0.15]]
grads:  [0.1489436]
Stock Position:  0.1489435984054001
Bond Position:  [-21.80342324]


portfolio before change:  [-6.69868744]
curr_Stock_Price:  101.44905519234419
curr_Factors:  [101.44905519]
mat_Sqrt:  [[0.15]]
grads:  [0.04366761]
Stock Position:  0.04366761367907367
Bond Position:  [-11.12872559]


portfolio before change:  [-6.61830931]
curr_Stock_Price:  103.3534565365114
curr_Factors:  [103.35345654]
mat_Sqrt:  [[0.15]]
grads:  [0.2222211]
Stock Position:  0.2222210975817728
Bond Position:  [-29.58562786]


portfolio before change:  [-6.91130402]
curr_Stock_Price:  102.06826182859092
curr_Factors:  [102.06826183]
mat_Sqrt:  [[0.15]]
grads:  [0.05639347]
Stock Position:  0.056393472144887276
Bond Position:  [-12.6672877]


portfolio before change:  [-7.00814788]
curr_Stock_Price:  100.40713622222967
curr_Factors:  [100.40713622]
mat_Sqrt:  [[0.15]]
grads:  [0.02274265]
Stock Position:  0.022742647643910256
Bond Position:  [-9.291672]


portfolio before change:  [-7.02417271]
curr_Stock_Price:  99.80467253895657
curr_Factors:  [99.80467254]
mat_Sqrt:  [[0.15]]
grads:  [0.06422734]
Stock Position:  0.06422733560357491
Bond Position:  [-13.43436091]


portfolio before change:  [-7.02755318]
curr_Stock_Price:  99.80433835298433
curr_Factors:  [99.80433835]
mat_Sqrt:  [[0.15]]
grads:  [-0.11717587]
Stock Position:  -0.11717587011809812
Bond Position:  [4.66710701]


portfolio before change:  [-6.98854266]
curr_Stock_Price:  99.48137426280684
curr_Factors:  [99.48137426]
mat_Sqrt:  [[0.15]]
grads:  [0.03888422]
Stock Position:  0.038884221041844406
Bond Position:  [-10.85679841]


portfolio before change:  [-7.00164607]
curr_Stock_Price:  99.21419969802446
curr_Factors:  [99.2141997]
mat_Sqrt:  [[0.15]]
grads:  [-0.13437168]
Stock Position:  -0.13437168333986613
Bond Position:  [6.32993295]


portfolio before change:  [-7.1031482]
curr_Stock_Price:  99.98136135290501
curr_Factors:  [99.98136135]
mat_Sqrt:  [[0.15]]
grads:  [0.0241367]
Stock Position:  0.024136697741409616
Bond Position:  [-9.51636809]


portfolio before change:  [-7.07692355]
curr_Stock_Price:  101.16644608261943
curr_Factors:  [101.16644608]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462495]
Stock Position:  -0.004624947106210836
Bond Position:  [-6.60903409]


portfolio before change:  [-7.07874586]
curr_Stock_Price:  101.20316905453596
curr_Factors:  [101.20316905]
mat_Sqrt:  [[0.15]]
grads:  [0.0442307]
Stock Position:  0.04423070172640831
Bond Position:  [-11.55503304]


portfolio before change:  [-7.07889174]
curr_Stock_Price:  101.26519018160097
curr_Factors:  [101.26519018]
mat_Sqrt:  [[0.15]]
grads:  [0.04986589]
Stock Position:  0.049865892300195544
Bond Position:  [-12.12857081]


portfolio before change:  [-7.18166431]
curr_Stock_Price:  99.2650245366962
curr_Factors:  [99.26502454]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198224]
Stock Position:  -0.011982244824581245
Bond Position:  [-5.99224648]


portfolio before change:  [-7.18965469]
curr_Stock_Price:  99.80683762624803
curr_Factors:  [99.80683763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.18965469]
Stock Price:  99.0616370555615
PL:  [-7.18965469]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.48432130e-03]
 [ 5.92623607e-03]
 [-2.61246078e-03]
 [ 2.96148452e-03]
 [ 2.98770905e-03]
 [ 4.26592276e-03]
 [-8.13360712e-03]
 [ 1.19340847e-02]
 [ 3.27376663e-03]
 [ 9.24045193e-03]
 [-1.49893198e-02]
 [-8.65796326e-03]
 [-2.15335639e-02]
 [ 2.88599653e-03]
 [ 2.25945146e-02]
 [ 3.47565001e-04]
 [ 6.07286792e-03]
 [-5.37957041e-03]
 [-1.12886990e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.25972579]
curr_Stock_Price:  99.96694133498455
curr_Factors:  [99.96694133]
mat_Sqrt:  [[0.15]]
grads:  [0.01656214]
Stock Position:  0.0165621420161026
Bond Position:  [-0.39594089]


portfolio before change:  [1.23851485]
curr_Stock_Price:  98.69223064203429
curr_Factors:  [98.69223064]
mat_Sqrt:  [[0.15]]
grads:  [0.03950824]
Stock Position:  0.03950824045882868
Bond Position:  [-2.66064153]


portfolio before change:  [1.18961238]
curr_Stock_Price:  97.47128959648369
curr_Factors:  [97.4712896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01741641]
Stock Position:  -0.017416405180626524
Bond Position:  [2.88721185]


portfolio before change:  [1.15769745]
curr_Stock_Price:  99.34520236597302
curr_Factors:  [99.34520237]
mat_Sqrt:  [[0.15]]
grads:  [0.01974323]
Stock Position:  0.01974323014611213
Bond Position:  [-0.80369775]


portfolio before change:  [1.15176979]
curr_Stock_Price:  99.05514294769284
curr_Factors:  [99.05514295]
mat_Sqrt:  [[0.15]]
grads:  [0.01991806]
Stock Position:  0.019918060328846018
Bond Position:  [-0.82121652]


portfolio before change:  [1.15687357]
curr_Stock_Price:  99.32169032792427
curr_Factors:  [99.32169033]
mat_Sqrt:  [[0.15]]
grads:  [0.02843949]
Stock Position:  0.028439485072959115
Bond Position:  [-1.66778416]


portfolio before change:  [1.12889922]
curr_Stock_Price:  98.35270822719484
curr_Factors:  [98.35270823]
mat_Sqrt:  [[0.15]]
grads:  [-0.05422405]
Stock Position:  -0.05422404747455474
Bond Position:  [6.46198114]


portfolio before change:  [1.1019803]
curr_Stock_Price:  98.87894355802047
curr_Factors:  [98.87894356]
mat_Sqrt:  [[0.15]]
grads:  [0.07956056]
Stock Position:  0.0795605649401889
Bond Position:  [-6.76488431]


portfolio before change:  [1.13863405]
curr_Stock_Price:  99.3609057011262
curr_Factors:  [99.3609057]
mat_Sqrt:  [[0.15]]
grads:  [0.02182511]
Stock Position:  0.021825110865767335
Bond Position:  [-1.02992873]


portfolio before change:  [1.17982988]
curr_Stock_Price:  101.26024761322395
curr_Factors:  [101.26024761]
mat_Sqrt:  [[0.15]]
grads:  [0.06160301]
Stock Position:  0.06160301283534562
Bond Position:  [-5.05810645]


portfolio before change:  [1.22227186]
curr_Stock_Price:  101.96973664814975
curr_Factors:  [101.96973665]
mat_Sqrt:  [[0.15]]
grads:  [-0.0999288]
Stock Position:  -0.09992879848896459
Bond Position:  [11.41198513]


portfolio before change:  [1.28199738]
curr_Stock_Price:  101.40060978948428
curr_Factors:  [101.40060979]
mat_Sqrt:  [[0.15]]
grads:  [-0.05771976]
Stock Position:  -0.057719755053958086
Bond Position:  [7.13481574]


portfolio before change:  [1.1893686]
curr_Stock_Price:  103.03631843603456
curr_Factors:  [103.03631844]
mat_Sqrt:  [[0.15]]
grads:  [-0.14355709]
Stock Position:  -0.1435570924134595
Bond Position:  [15.98096289]


portfolio before change:  [1.24381529]
curr_Stock_Price:  102.68488369101092
curr_Factors:  [102.68488369]
mat_Sqrt:  [[0.15]]
grads:  [0.01923998]
Stock Position:  0.019239976854134568
Bond Position:  [-0.73183949]


portfolio before change:  [1.26603176]
curr_Stock_Price:  103.84909774911142
curr_Factors:  [103.84909775]
mat_Sqrt:  [[0.15]]
grads:  [0.1506301]
Stock Position:  0.15063009751380999
Bond Position:  [-14.37676796]


portfolio before change:  [1.53274115]
curr_Stock_Price:  105.64358660107548
curr_Factors:  [105.6435866]
mat_Sqrt:  [[0.15]]
grads:  [0.0023171]
Stock Position:  0.002317100006113907
Bond Position:  [1.2879544]


portfolio before change:  [1.53669187]
curr_Stock_Price:  107.20963665204292
curr_Factors:  [107.20963665]
mat_Sqrt:  [[0.15]]
grads:  [0.04048579]
Stock Position:  0.04048578613157232
Bond Position:  [-2.80377455]


portfolio before change:  [1.46023355]
curr_Stock_Price:  105.33842961256971
curr_Factors:  [105.33842961]
mat_Sqrt:  [[0.15]]
grads:  [-0.0358638]
Stock Position:  -0.035863802737348675
Bond Position:  [5.23807022]


portfolio before change:  [1.51855422]
curr_Stock_Price:  103.74877707052363
curr_Factors:  [103.74877707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.51855422]
Stock Price:  104.52037735656123
PL:  [-3.00182314]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.11537257e-03]
 [ 8.71566287e-03]
 [ 1.46809123e-03]
 [ 1.26865076e-03]
 [-3.26750489e-04]
 [ 2.90977707e-03]
 [-2.91853471e-03]
 [ 5.90576128e-03]
 [ 4.64957943e-03]
 [ 4.90601479e-03]
 [-1.77502909e-02]
 [ 6.27803714e-03]
 [ 5.57856416e-03]
 [-3.71711490e-04]
 [-1.64918211e-02]
 [ 7.73399604e-03]
 [ 4.09542989e-03]
 [-2.97565196e-03]
 [-1.17324365e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.93756394]
curr_Stock_Price:  100.14066438161665
curr_Factors:  [100.14066438]
mat_Sqrt:  [[0.15]]
grads:  [0.02743582]
Stock Position:  0.027435817163842417
Bond Position:  [1.19012298]


portfolio before change:  [3.93730245]
curr_Stock_Price:  100.1202874091881
curr_Factors:  [100.12028741]
mat_Sqrt:  [[0.15]]
grads:  [0.05810442]
Stock Position:  0.05810441916142264
Bond Position:  [-1.8801287]


portfolio before change:  [3.91396112]
curr_Stock_Price:  99.72666438443233
curr_Factors:  [99.72666438]
mat_Sqrt:  [[0.15]]
grads:  [0.00978727]
Stock Position:  0.009787274857411814
Bond Position:  [2.93790884]


portfolio before change:  [3.89909227]
curr_Stock_Price:  98.1324092466573
curr_Factors:  [98.13240925]
mat_Sqrt:  [[0.15]]
grads:  [0.00845767]
Stock Position:  0.008457671747626797
Bond Position:  [3.06912057]


portfolio before change:  [3.89593133]
curr_Stock_Price:  97.66794076477451
curr_Factors:  [97.66794076]
mat_Sqrt:  [[0.15]]
grads:  [-0.00217834]
Stock Position:  -0.0021783365962874577
Bond Position:  [4.10868498]


portfolio before change:  [3.89719193]
curr_Stock_Price:  97.56084097954664
curr_Factors:  [97.56084098]
mat_Sqrt:  [[0.15]]
grads:  [0.01939851]
Stock Position:  0.019398513799498633
Bond Position:  [2.00465661]


portfolio before change:  [3.87462088]
curr_Stock_Price:  96.37145713654033
curr_Factors:  [96.37145714]
mat_Sqrt:  [[0.15]]
grads:  [-0.0194569]
Stock Position:  -0.019456898047047293
Bond Position:  [5.74971049]


portfolio before change:  [3.86873066]
curr_Stock_Price:  96.74807524911938
curr_Factors:  [96.74807525]
mat_Sqrt:  [[0.15]]
grads:  [0.03937174]
Stock Position:  0.039371741872180725
Bond Position:  [0.05959042]


portfolio before change:  [3.8710456]
curr_Stock_Price:  96.80649378068334
curr_Factors:  [96.80649378]
mat_Sqrt:  [[0.15]]
grads:  [0.0309972]
Stock Position:  0.0309971961919794
Bond Position:  [0.87031572]


portfolio before change:  [3.89523117]
curr_Stock_Price:  97.57972394709589
curr_Factors:  [97.57972395]
mat_Sqrt:  [[0.15]]
grads:  [0.03270677]
Stock Position:  0.03270676525500653
Bond Position:  [0.70371405]


portfolio before change:  [3.86824245]
curr_Stock_Price:  96.74917161623142
curr_Factors:  [96.74917162]
mat_Sqrt:  [[0.15]]
grads:  [-0.11833527]
Stock Position:  -0.11833527246355983
Bond Position:  [15.31708203]


portfolio before change:  [3.89509253]
curr_Stock_Price:  96.55463673001074
curr_Factors:  [96.55463673]
mat_Sqrt:  [[0.15]]
grads:  [0.04185358]
Stock Position:  0.04185358096021284
Bond Position:  [-0.14606477]


portfolio before change:  [3.87975471]
curr_Stock_Price:  96.18904547282628
curr_Factors:  [96.18904547]
mat_Sqrt:  [[0.15]]
grads:  [0.03719043]
Stock Position:  0.03719042771704079
Bond Position:  [0.30244297]


portfolio before change:  [3.94086903]
curr_Stock_Price:  97.830293048622
curr_Factors:  [97.83029305]
mat_Sqrt:  [[0.15]]
grads:  [-0.00247808]
Stock Position:  -0.0024780766028788073
Bond Position:  [4.18329999]


portfolio before change:  [3.94066418]
curr_Stock_Price:  98.3350403625184
curr_Factors:  [98.33504036]
mat_Sqrt:  [[0.15]]
grads:  [-0.10994547]
Stock Position:  -0.10994547383858896
Bond Position:  [14.75215679]


portfolio before change:  [3.95431415]
curr_Stock_Price:  98.24443667349037
curr_Factors:  [98.24443667]
mat_Sqrt:  [[0.15]]
grads:  [0.05155997]
Stock Position:  0.0515599735883717
Bond Position:  [-1.11116641]


portfolio before change:  [3.89949124]
curr_Stock_Price:  97.18654082291569
curr_Factors:  [97.18654082]
mat_Sqrt:  [[0.15]]
grads:  [0.02730287]
Stock Position:  0.027302865945362666
Bond Position:  [1.24602014]


portfolio before change:  [3.86810726]
curr_Stock_Price:  96.02565456137853
curr_Factors:  [96.02565456]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983768]
Stock Position:  -0.019837679728903247
Bond Position:  [5.77303344]


portfolio before change:  [3.9068982]
curr_Stock_Price:  94.1430000467623
curr_Factors:  [94.14300005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.9068982]
Stock Price:  94.15986748257552
PL:  [3.9068982]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.88180419e-03]
 [ 6.36652942e-03]
 [ 8.34573294e-04]
 [ 3.25848565e-03]
 [ 1.74327106e-02]
 [ 3.00144906e-03]
 [-7.29357213e-03]
 [ 1.22898408e-02]
 [ 3.30475633e-03]
 [ 8.77045421e-03]
 [-1.56159806e-02]
 [-8.65469061e-03]
 [-2.43482834e-02]
 [ 2.68116927e-03]
 [ 1.14363453e-02]
 [ 4.51454073e-03]
 [ 6.83405784e-03]
 [-5.38884809e-03]
 [-1.05022657e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62193913]
curr_Stock_Price:  100.37968587927632
curr_Factors:  [100.37968588]
mat_Sqrt:  [[0.15]]
grads:  [0.03921203]
Stock Position:  0.03921202792773789
Bond Position:  [3.68584809]


portfolio before change:  [7.67906109]
curr_Stock_Price:  101.81292910485129
curr_Factors:  [101.8129291]
mat_Sqrt:  [[0.15]]
grads:  [0.04244353]
Stock Position:  0.04244352947733634
Bond Position:  [3.35776103]


portfolio before change:  [7.6336664]
curr_Stock_Price:  100.72361755713453
curr_Factors:  [100.72361756]
mat_Sqrt:  [[0.15]]
grads:  [0.00556382]
Stock Position:  0.005563821957649391
Bond Position:  [7.07325813]


portfolio before change:  [7.62921383]
curr_Stock_Price:  99.60548138431218
curr_Factors:  [99.60548138]
mat_Sqrt:  [[0.15]]
grads:  [0.02172324]
Stock Position:  0.021723237661285522
Bond Position:  [5.46546028]


portfolio before change:  [7.65866019]
curr_Stock_Price:  100.89809828938292
curr_Factors:  [100.89809829]
mat_Sqrt:  [[0.15]]
grads:  [0.11621807]
Stock Position:  0.11621807069474265
Bond Position:  [-4.06752213]


portfolio before change:  [7.55640345]
curr_Stock_Price:  100.0269795806848
curr_Factors:  [100.02697958]
mat_Sqrt:  [[0.15]]
grads:  [0.02000966]
Stock Position:  0.0200096603872831
Bond Position:  [5.55489755]


portfolio before change:  [7.51778439]
curr_Stock_Price:  98.0275477702837
curr_Factors:  [98.02754777]
mat_Sqrt:  [[0.15]]
grads:  [-0.04862381]
Stock Position:  -0.04862381417500672
Bond Position:  [12.28425766]


portfolio before change:  [7.47544914]
curr_Stock_Price:  98.9613844133363
curr_Factors:  [98.96138441]
mat_Sqrt:  [[0.15]]
grads:  [0.08193227]
Stock Position:  0.08193227185108494
Bond Position:  [-0.63268191]


portfolio before change:  [7.58716538]
curr_Stock_Price:  100.32683448426629
curr_Factors:  [100.32683448]
mat_Sqrt:  [[0.15]]
grads:  [0.02203171]
Stock Position:  0.022031708871877633
Bond Position:  [5.37679377]


portfolio before change:  [7.58522589]
curr_Stock_Price:  100.1777831474448
curr_Factors:  [100.17778315]
mat_Sqrt:  [[0.15]]
grads:  [0.05846969]
Stock Position:  0.05846969476611672
Bond Position:  [1.72786149]


portfolio before change:  [7.66238617]
curr_Stock_Price:  101.49005715028672
curr_Factors:  [101.49005715]
mat_Sqrt:  [[0.15]]
grads:  [-0.10410654]
Stock Position:  -0.10410653733624528
Bond Position:  [18.22816459]


portfolio before change:  [7.67981016]
curr_Stock_Price:  101.36646856370518
curr_Factors:  [101.36646856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05769794]
Stock Position:  -0.057697937397326725
Bond Position:  [13.52844632]


portfolio before change:  [7.68283109]
curr_Stock_Price:  101.3727357361144
curr_Factors:  [101.37273574]
mat_Sqrt:  [[0.15]]
grads:  [-0.16232189]
Stock Position:  -0.16232188904281483
Bond Position:  [24.13784505]


portfolio before change:  [7.51400458]
curr_Stock_Price:  102.44998862491224
curr_Factors:  [102.44998862]
mat_Sqrt:  [[0.15]]
grads:  [0.01787446]
Stock Position:  0.017874461822252812
Bond Position:  [5.68276617]


portfolio before change:  [7.51823962]
curr_Stock_Price:  102.6074293666189
curr_Factors:  [102.60742937]
mat_Sqrt:  [[0.15]]
grads:  [0.0762423]
Stock Position:  0.07624230205453343
Bond Position:  [-0.304787]


portfolio before change:  [7.47488049]
curr_Stock_Price:  102.03972714241952
curr_Factors:  [102.03972714]
mat_Sqrt:  [[0.15]]
grads:  [0.03009694]
Stock Position:  0.030096938222090083
Bond Position:  [4.40379712]


portfolio before change:  [7.56220997]
curr_Stock_Price:  104.90474916224595
curr_Factors:  [104.90474916]
mat_Sqrt:  [[0.15]]
grads:  [0.04556039]
Stock Position:  0.04556038559056803
Bond Position:  [2.78270914]


portfolio before change:  [7.58555555]
curr_Stock_Price:  105.40188764595081
curr_Factors:  [105.40188765]
mat_Sqrt:  [[0.15]]
grads:  [-0.03592565]
Stock Position:  -0.03592565390798864
Bond Position:  [11.37218729]


portfolio before change:  [7.58578447]
curr_Stock_Price:  105.47466255799321
curr_Factors:  [105.47466256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.58578447]
Stock Price:  105.95983981243506
PL:  [1.62594466]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.15875067e-02]
 [-1.26544202e-02]
 [-7.40085758e-03]
 [-1.80649720e-03]
 [-1.19604846e-02]
 [-1.83388380e-03]
 [ 2.19239422e-03]
 [-9.74552669e-05]
 [ 4.57552035e-03]
 [-1.42900734e-02]
 [-1.74264909e-02]
 [ 6.56290217e-03]
 [-6.52847175e-03]
 [ 2.48912730e-04]
 [-1.71765890e-02]
 [ 7.59473866e-03]
 [ 4.43128232e-03]
 [-1.95933141e-03]
 [-1.26432239e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.45760083]
curr_Stock_Price:  96.93618448261635
curr_Factors:  [96.93618448]
mat_Sqrt:  [[0.15]]
grads:  [0.34391671]
Stock Position:  0.34391671155587755
Bond Position:  [-78.79557463]


portfolio before change:  [-46.38911288]
curr_Stock_Price:  94.28493007451888
curr_Factors:  [94.28493007]
mat_Sqrt:  [[0.15]]
grads:  [-0.0843628]
Stock Position:  -0.08436280154868563
Bond Position:  [-38.43497204]


portfolio before change:  [-46.4064763]
curr_Stock_Price:  94.37683642045522
curr_Factors:  [94.37683642]
mat_Sqrt:  [[0.15]]
grads:  [-0.04933905]
Stock Position:  -0.04933905050869218
Bond Position:  [-41.7500128]


portfolio before change:  [-46.51542228]
curr_Stock_Price:  96.37337205821802
curr_Factors:  [96.37337206]
mat_Sqrt:  [[0.15]]
grads:  [-0.01204331]
Stock Position:  -0.012043314659554693
Bond Position:  [-45.35476744]


portfolio before change:  [-46.51087631]
curr_Stock_Price:  95.05429330432344
curr_Factors:  [95.0542933]
mat_Sqrt:  [[0.15]]
grads:  [-0.07973656]
Stock Position:  -0.07973656370842896
Bond Position:  [-38.9315736]


portfolio before change:  [-46.57998201]
curr_Stock_Price:  95.79889011218143
curr_Factors:  [95.79889011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01222589]
Stock Position:  -0.012225892022315922
Bond Position:  [-45.40875513]


portfolio before change:  [-46.57989255]
curr_Stock_Price:  94.86291988951103
curr_Factors:  [94.86291989]
mat_Sqrt:  [[0.15]]
grads:  [0.01461596]
Stock Position:  0.014615961458666615
Bond Position:  [-47.96640533]


portfolio before change:  [-46.58542373]
curr_Stock_Price:  95.3050340809956
curr_Factors:  [95.30503408]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006497]
Stock Position:  -0.0006497017795003997
Bond Position:  [-46.52350388]


portfolio before change:  [-46.59730396]
curr_Stock_Price:  95.68659816539692
curr_Factors:  [95.68659817]
mat_Sqrt:  [[0.15]]
grads:  [0.03050347]
Stock Position:  0.030503469027529206
Bond Position:  [-49.51607714]


portfolio before change:  [-46.62383477]
curr_Stock_Price:  95.22270841455943
curr_Factors:  [95.22270841]
mat_Sqrt:  [[0.15]]
grads:  [-0.09526716]
Stock Position:  -0.09526715575145306
Bond Position:  [-37.55223818]


portfolio before change:  [-46.55654695]
curr_Stock_Price:  94.4178449482745
curr_Factors:  [94.41784495]
mat_Sqrt:  [[0.15]]
grads:  [-0.11617661]
Stock Position:  -0.1161766060363504
Bond Position:  [-35.58740218]


portfolio before change:  [-46.78772735]
curr_Stock_Price:  96.33115989664654
curr_Factors:  [96.3311599]
mat_Sqrt:  [[0.15]]
grads:  [0.04375268]
Stock Position:  0.043752681105800086
Bond Position:  [-51.00247387]


portfolio before change:  [-46.74589052]
curr_Stock_Price:  97.57883309105793
curr_Factors:  [97.57883309]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352315]
Stock Position:  -0.04352314502959758
Bond Position:  [-42.49895281]


portfolio before change:  [-46.7778555]
curr_Stock_Price:  98.06912202074518
curr_Factors:  [98.06912202]
mat_Sqrt:  [[0.15]]
grads:  [0.00165942]
Stock Position:  0.0016594182030738246
Bond Position:  [-46.94059319]


portfolio before change:  [-46.79019429]
curr_Stock_Price:  97.7062417445977
curr_Factors:  [97.70624174]
mat_Sqrt:  [[0.15]]
grads:  [-0.11451059]
Stock Position:  -0.11451059365076524
Bond Position:  [-35.60179454]


portfolio before change:  [-46.84069911]
curr_Stock_Price:  98.06955542436694
curr_Factors:  [98.06955542]
mat_Sqrt:  [[0.15]]
grads:  [0.05063159]
Stock Position:  0.05063159107927517
Bond Position:  [-51.80611674]


portfolio before change:  [-46.8375261]
curr_Stock_Price:  98.38805538531602
curr_Factors:  [98.38805539]
mat_Sqrt:  [[0.15]]
grads:  [0.02954188]
Stock Position:  0.02954188214949715
Bond Position:  [-49.74409444]


portfolio before change:  [-46.86417544]
curr_Stock_Price:  97.90698365177715
curr_Factors:  [97.90698365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01306221]
Stock Position:  -0.013062209377632536
Bond Position:  [-45.58529392]


portfolio before change:  [-46.86159306]
curr_Stock_Price:  96.83671071468346
curr_Factors:  [96.83671071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.86159306]
Stock Price:  96.01207287579234
PL:  [-46.86159306]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.01950470e-03]
 [ 8.46477554e-03]
 [ 1.07657784e-03]
 [ 5.97155322e-03]
 [ 6.69878746e-03]
 [ 6.85743997e-03]
 [ 3.40748662e-02]
 [-6.47841727e-04]
 [ 1.04321872e-02]
 [-1.89150798e-02]
 [-9.95433482e-03]
 [-2.76220548e-02]
 [-1.74860135e-02]
 [ 6.99805132e-03]
 [ 3.65087272e-02]
 [ 5.43751261e-04]
 [ 6.38676963e-03]
 [-5.36761295e-03]
 [-1.01822622e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.32512507]
curr_Stock_Price:  100.49017898328863
curr_Factors:  [100.49017898]
mat_Sqrt:  [[0.15]]
grads:  [0.04013003]
Stock Position:  0.040130031335893795
Bond Position:  [5.29245103]


portfolio before change:  [9.32096141]
curr_Stock_Price:  100.3534500562931
curr_Factors:  [100.35345006]
mat_Sqrt:  [[0.15]]
grads:  [0.05643184]
Stock Position:  0.05643183695989664
Bond Position:  [3.65783188]


portfolio before change:  [9.388086]
curr_Stock_Price:  101.52672428608035
curr_Factors:  [101.52672429]
mat_Sqrt:  [[0.15]]
grads:  [0.00717719]
Stock Position:  0.007177185584042915
Bond Position:  [8.65940986]


portfolio before change:  [9.38221653]
curr_Stock_Price:  100.4072613885055
curr_Factors:  [100.40726139]
mat_Sqrt:  [[0.15]]
grads:  [0.03981035]
Stock Position:  0.03981035481012435
Bond Position:  [5.38496783]


portfolio before change:  [9.36008151]
curr_Stock_Price:  99.81742916449797
curr_Factors:  [99.81742916]
mat_Sqrt:  [[0.15]]
grads:  [0.04465858]
Stock Position:  0.04465858304417977
Bond Position:  [4.90237656]


portfolio before change:  [9.4495495]
curr_Stock_Price:  101.79335938639494
curr_Factors:  [101.79335939]
mat_Sqrt:  [[0.15]]
grads:  [0.04571627]
Stock Position:  0.04571626648417349
Bond Position:  [4.79593716]


portfolio before change:  [9.51377401]
curr_Stock_Price:  103.17197980932254
curr_Factors:  [103.17197981]
mat_Sqrt:  [[0.15]]
grads:  [0.22716577]
Stock Position:  0.22716577435116894
Bond Position:  [-13.92336867]


portfolio before change:  [9.68409839]
curr_Stock_Price:  103.93708472308451
curr_Factors:  [103.93708472]
mat_Sqrt:  [[0.15]]
grads:  [-0.00431894]
Stock Position:  -0.0043189448474230865
Bond Position:  [10.13299692]


portfolio before change:  [9.67841461]
curr_Stock_Price:  105.83971145707476
curr_Factors:  [105.83971146]
mat_Sqrt:  [[0.15]]
grads:  [0.06954791]
Stock Position:  0.06954791457685228
Bond Position:  [2.3174834]


portfolio before change:  [9.64338485]
curr_Stock_Price:  105.32770180508669
curr_Factors:  [105.32770181]
mat_Sqrt:  [[0.15]]
grads:  [-0.12610053]
Stock Position:  -0.1261005320398658
Bond Position:  [22.92526409]


portfolio before change:  [9.67443952]
curr_Stock_Price:  105.1268887536494
curr_Factors:  [105.12688875]
mat_Sqrt:  [[0.15]]
grads:  [-0.06636223]
Stock Position:  -0.06636223211222972
Bond Position:  [16.65089451]


portfolio before change:  [9.61114823]
curr_Stock_Price:  106.14334848271751
curr_Factors:  [106.14334848]
mat_Sqrt:  [[0.15]]
grads:  [-0.18414703]
Stock Position:  -0.18414703225182058
Bond Position:  [29.15713084]


portfolio before change:  [9.44844317]
curr_Stock_Price:  107.0664980138609
curr_Factors:  [107.06649801]
mat_Sqrt:  [[0.15]]
grads:  [-0.11657342]
Stock Position:  -0.11657342323030588
Bond Position:  [21.92955136]


portfolio before change:  [9.50779068]
curr_Stock_Price:  106.6044335734562
curr_Factors:  [106.60443357]
mat_Sqrt:  [[0.15]]
grads:  [0.04665368]
Stock Position:  0.0466536754881569
Bond Position:  [4.53430203]


portfolio before change:  [9.47155016]
curr_Stock_Price:  105.80333413991393
curr_Factors:  [105.80333414]
mat_Sqrt:  [[0.15]]
grads:  [0.24339151]
Stock Position:  0.2433915145330833
Bond Position:  [-16.28008358]


portfolio before change:  [9.37063446]
curr_Stock_Price:  105.4054354205871
curr_Factors:  [105.40543542]
mat_Sqrt:  [[0.15]]
grads:  [0.00362501]
Stock Position:  0.0036250084033461554
Bond Position:  [8.98853887]


portfolio before change:  [9.37597657]
curr_Stock_Price:  106.25914044118099
curr_Factors:  [106.25914044]
mat_Sqrt:  [[0.15]]
grads:  [0.04257846]
Stock Position:  0.04257846422487151
Bond Position:  [4.85162556]


portfolio before change:  [9.33450479]
curr_Stock_Price:  105.25664222641277
curr_Factors:  [105.25664223]
mat_Sqrt:  [[0.15]]
grads:  [-0.03578409]
Stock Position:  -0.0357840863435706
Bond Position:  [13.10101756]


portfolio before change:  [9.29975233]
curr_Stock_Price:  106.31935257838543
curr_Factors:  [106.31935258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.29975233]
Stock Price:  106.88070596774685
PL:  [2.41904637]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.95640978e-03]
 [ 6.31093786e-03]
 [ 1.64554120e-03]
 [ 1.60501539e-02]
 [ 2.29481891e-02]
 [ 5.73754343e-03]
 [ 2.98345206e-02]
 [ 2.18992462e-03]
 [ 8.77901874e-03]
 [ 3.52992518e-03]
 [-1.41111085e-02]
 [-1.23919064e-02]
 [-2.32807899e-02]
 [ 2.68216163e-03]
 [ 1.30034648e-02]
 [ 2.11887291e-03]
 [ 6.94166969e-03]
 [-5.48867675e-03]
 [-9.21297908e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.09070774]
curr_Stock_Price:  100.0208507601599
curr_Factors:  [100.02085076]
mat_Sqrt:  [[0.15]]
grads:  [0.0197094]
Stock Position:  0.019709398550780265
Bond Position:  [0.11935693]


portfolio before change:  [2.12453648]
curr_Stock_Price:  101.7357127106995
curr_Factors:  [101.73571271]
mat_Sqrt:  [[0.15]]
grads:  [0.04207292]
Stock Position:  0.04207291905521184
Bond Position:  [-2.15578193]


portfolio before change:  [2.15621924]
curr_Stock_Price:  102.50156828110235
curr_Factors:  [102.50156828]
mat_Sqrt:  [[0.15]]
grads:  [0.01097027]
Stock Position:  0.010970274647312216
Bond Position:  [1.03174889]


portfolio before change:  [2.16624309]
curr_Stock_Price:  103.39178056305437
curr_Factors:  [103.39178056]
mat_Sqrt:  [[0.15]]
grads:  [0.10700103]
Stock Position:  0.10700102587095184
Bond Position:  [-8.8967835]


portfolio before change:  [2.31225056]
curr_Stock_Price:  104.7771125743893
curr_Factors:  [104.77711257]
mat_Sqrt:  [[0.15]]
grads:  [0.15298793]
Stock Position:  0.1529879275759664
Bond Position:  [-13.71738275]


portfolio before change:  [2.38471514]
curr_Stock_Price:  105.27319328259513
curr_Factors:  [105.27319328]
mat_Sqrt:  [[0.15]]
grads:  [0.03825029]
Stock Position:  0.03825028956532649
Bond Position:  [-1.64201498]


portfolio before change:  [2.34605607]
curr_Stock_Price:  104.27323955300248
curr_Factors:  [104.27323955]
mat_Sqrt:  [[0.15]]
grads:  [0.1988968]
Stock Position:  0.1988968041279873
Bond Position:  [-18.39355803]


portfolio before change:  [2.15418718]
curr_Stock_Price:  103.33169637582452
curr_Factors:  [103.33169638]
mat_Sqrt:  [[0.15]]
grads:  [0.0145995]
Stock Position:  0.014599497448432043
Bond Position:  [0.64559634]


portfolio before change:  [2.16044803]
curr_Stock_Price:  103.74948049336099
curr_Factors:  [103.74948049]
mat_Sqrt:  [[0.15]]
grads:  [0.05852679]
Stock Position:  0.05852679160641652
Bond Position:  [-3.91167619]


portfolio before change:  [2.08072598]
curr_Stock_Price:  102.40404511165154
curr_Factors:  [102.40404511]
mat_Sqrt:  [[0.15]]
grads:  [0.02353283]
Stock Position:  0.02353283453648257
Bond Position:  [-0.32913147]


portfolio before change:  [2.08455914]
curr_Stock_Price:  102.57042771668999
curr_Factors:  [102.57042772]
mat_Sqrt:  [[0.15]]
grads:  [-0.09407406]
Stock Position:  -0.09407405688015212
Bond Position:  [11.73377539]


portfolio before change:  [1.99950769]
curr_Stock_Price:  103.50570424100707
curr_Factors:  [103.50570424]
mat_Sqrt:  [[0.15]]
grads:  [-0.08261271]
Stock Position:  -0.08261270955428801
Bond Position:  [10.55039437]


portfolio before change:  [2.13392457]
curr_Stock_Price:  101.91056284094043
curr_Factors:  [101.91056284]
mat_Sqrt:  [[0.15]]
grads:  [-0.15520527]
Stock Position:  -0.15520526604979837
Bond Position:  [17.95098059]


portfolio before change:  [2.05451453]
curr_Stock_Price:  102.45112665893895
curr_Factors:  [102.45112666]
mat_Sqrt:  [[0.15]]
grads:  [0.01788108]
Stock Position:  0.017881077553251665
Bond Position:  [0.22257799]


portfolio before change:  [2.05993741]
curr_Stock_Price:  102.75128954277388
curr_Factors:  [102.75128954]
mat_Sqrt:  [[0.15]]
grads:  [0.08668977]
Stock Position:  0.08668976552401599
Bond Position:  [-6.84754778]


portfolio before change:  [2.12255781]
curr_Stock_Price:  103.49338979092582
curr_Factors:  [103.49338979]
mat_Sqrt:  [[0.15]]
grads:  [0.01412582]
Stock Position:  0.014125819399944412
Bond Position:  [0.66062888]


portfolio before change:  [2.13805671]
curr_Stock_Price:  104.57889984663106
curr_Factors:  [104.57889985]
mat_Sqrt:  [[0.15]]
grads:  [0.0462778]
Stock Position:  0.04627779794499022
Bond Position:  [-2.70162449]


portfolio before change:  [2.24158867]
curr_Stock_Price:  106.83068057348613
curr_Factors:  [106.83068057]
mat_Sqrt:  [[0.15]]
grads:  [-0.03659118]
Stock Position:  -0.036591178319266414
Bond Position:  [6.15064915]


portfolio before change:  [2.16821639]
curr_Stock_Price:  108.87789899303512
curr_Factors:  [108.87789899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.16821639]
Stock Price:  107.170387635161
PL:  [-5.00217125]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.13861136e-02]
 [ 6.94288663e-03]
 [ 8.97907446e-04]
 [ 3.35912892e-03]
 [ 2.09379660e-02]
 [ 6.84065688e-03]
 [ 3.03532427e-02]
 [ 1.12772831e-02]
 [ 6.30656737e-03]
 [ 6.01406703e-03]
 [-1.64106497e-02]
 [ 1.60296403e-03]
 [-2.58838109e-02]
 [ 3.16327422e-03]
 [ 8.60388938e-03]
 [ 2.22663811e-03]
 [ 7.39468868e-03]
 [-5.18042319e-03]
 [-1.05749024e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.16564038]
curr_Stock_Price:  101.12857615608249
curr_Factors:  [101.12857616]
mat_Sqrt:  [[0.15]]
grads:  [0.07590742]
Stock Position:  0.0759074237052281
Bond Position:  [11.48923071]


portfolio before change:  [19.13196604]
curr_Stock_Price:  100.64710792342572
curr_Factors:  [100.64710792]
mat_Sqrt:  [[0.15]]
grads:  [0.04628591]
Stock Position:  0.04628591087916098
Bond Position:  [14.47342297]


portfolio before change:  [19.13528383]
curr_Stock_Price:  100.64060452972325
curr_Factors:  [100.64060453]
mat_Sqrt:  [[0.15]]
grads:  [0.00598605]
Stock Position:  0.005986049637760616
Bond Position:  [18.53284418]


portfolio before change:  [19.13480685]
curr_Stock_Price:  99.7868237381967
curr_Factors:  [99.78682374]
mat_Sqrt:  [[0.15]]
grads:  [0.02239419]
Stock Position:  0.02239419279637543
Bond Position:  [16.90016148]


portfolio before change:  [19.17332316]
curr_Stock_Price:  101.31805742630492
curr_Factors:  [101.31805743]
mat_Sqrt:  [[0.15]]
grads:  [0.13958644]
Stock Position:  0.1395864400182394
Bond Position:  [5.03069621]


portfolio before change:  [19.31414783]
curr_Stock_Price:  102.31791705268328
curr_Factors:  [102.31791705]
mat_Sqrt:  [[0.15]]
grads:  [0.04560438]
Stock Position:  0.045604379216164524
Bond Position:  [14.64800275]


portfolio before change:  [19.29037817]
curr_Stock_Price:  101.71639309072036
curr_Factors:  [101.71639309]
mat_Sqrt:  [[0.15]]
grads:  [0.20235495]
Stock Position:  0.2023549515509261
Bond Position:  [-1.29243763]


portfolio before change:  [19.26908516]
curr_Stock_Price:  101.61276400519576
curr_Factors:  [101.61276401]
mat_Sqrt:  [[0.15]]
grads:  [0.07518189]
Stock Position:  0.0751818876306081
Bond Position:  [11.62964575]


portfolio before change:  [19.30785136]
curr_Stock_Price:  102.08971969050779
curr_Factors:  [102.08971969]
mat_Sqrt:  [[0.15]]
grads:  [0.04204378]
Stock Position:  0.042043782462893226
Bond Position:  [15.0156134]


portfolio before change:  [19.31073038]
curr_Stock_Price:  102.06889963031637
curr_Factors:  [102.06889963]
mat_Sqrt:  [[0.15]]
grads:  [0.04009378]
Stock Position:  0.040093780217119075
Bond Position:  [15.21840235]


portfolio before change:  [19.26693915]
curr_Stock_Price:  100.88177520874694
curr_Factors:  [100.88177521]
mat_Sqrt:  [[0.15]]
grads:  [-0.10940433]
Stock Position:  -0.1094043311935838
Bond Position:  [30.3038423]


portfolio before change:  [19.35074816]
curr_Stock_Price:  100.18498287596819
curr_Factors:  [100.18498288]
mat_Sqrt:  [[0.15]]
grads:  [0.01068643]
Stock Position:  0.010686426886445484
Bond Position:  [18.28012866]


portfolio before change:  [19.36297438]
curr_Stock_Price:  100.90136955209795
curr_Factors:  [100.90136955]
mat_Sqrt:  [[0.15]]
grads:  [-0.17255874]
Stock Position:  -0.17255873928133553
Bond Position:  [36.7743875]


portfolio before change:  [19.00953778]
curr_Stock_Price:  103.00286462792181
curr_Factors:  [103.00286463]
mat_Sqrt:  [[0.15]]
grads:  [0.02108849]
Stock Position:  0.021088494817560872
Bond Position:  [16.8373624]


portfolio before change:  [18.99992515]
curr_Stock_Price:  102.34741243556209
curr_Factors:  [102.34741244]
mat_Sqrt:  [[0.15]]
grads:  [0.05735926]
Stock Position:  0.05735926255556569
Bond Position:  [13.12935305]


portfolio before change:  [19.06143677]
curr_Stock_Price:  103.3625732400721
curr_Factors:  [103.36257324]
mat_Sqrt:  [[0.15]]
grads:  [0.01484425]
Stock Position:  0.014844254072439757
Bond Position:  [17.52709647]


portfolio before change:  [19.06351204]
curr_Stock_Price:  103.20715572638757
curr_Factors:  [103.20715573]
mat_Sqrt:  [[0.15]]
grads:  [0.04929792]
Stock Position:  0.04929792452439279
Bond Position:  [13.97561346]


portfolio before change:  [19.08033948]
curr_Stock_Price:  103.47761551007729
curr_Factors:  [103.47761551]
mat_Sqrt:  [[0.15]]
grads:  [-0.03453615]
Stock Position:  -0.03453615463310231
Bond Position:  [22.65405841]


portfolio before change:  [19.02365513]
curr_Stock_Price:  105.2829286515118
curr_Factors:  [105.28292865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.02365513]
Stock Price:  104.44097560922482
PL:  [14.58267952]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.59451613e-02]
 [ 5.92270449e-03]
 [ 6.96749410e-04]
 [ 1.78911590e-03]
 [-7.08270240e-04]
 [ 5.03461186e-05]
 [-2.69766979e-03]
 [ 8.27920941e-03]
 [ 4.68951943e-03]
 [ 4.77448631e-03]
 [-1.78172835e-02]
 [ 5.42669797e-03]
 [-1.04206212e-02]
 [ 7.47094900e-04]
 [-1.67172747e-02]
 [ 7.82812587e-03]
 [ 3.96722927e-03]
 [-1.95576966e-03]
 [-1.23629049e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.44677294]
curr_Stock_Price:  101.47118627199532
curr_Factors:  [101.47118627]
mat_Sqrt:  [[0.15]]
grads:  [0.10630108]
Stock Position:  0.10630107559230657
Bond Position:  [13.6602767]


portfolio before change:  [24.41310439]
curr_Stock_Price:  101.12232760965621
curr_Factors:  [101.12232761]
mat_Sqrt:  [[0.15]]
grads:  [0.0394847]
Stock Position:  0.03948469662543696
Bond Position:  [20.42031996]


portfolio before change:  [24.41097587]
curr_Stock_Price:  100.9391113595885
curr_Factors:  [100.93911136]
mat_Sqrt:  [[0.15]]
grads:  [0.004645]
Stock Position:  0.0046449960655997515
Bond Position:  [23.94211409]


portfolio before change:  [24.40530791]
curr_Stock_Price:  98.43012419906545
curr_Factors:  [98.4301242]
mat_Sqrt:  [[0.15]]
grads:  [0.01192744]
Stock Position:  0.011927439318572992
Bond Position:  [23.23128858]


portfolio before change:  [24.3999904]
curr_Stock_Price:  97.49731187440382
curr_Factors:  [97.49731187]
mat_Sqrt:  [[0.15]]
grads:  [-0.0047218]
Stock Position:  -0.004721801603208177
Bond Position:  [24.86035336]


portfolio before change:  [24.41092125]
curr_Stock_Price:  96.49875475976005
curr_Factors:  [96.49875476]
mat_Sqrt:  [[0.15]]
grads:  [0.00033564]
Stock Position:  0.00033564079072109787
Bond Position:  [24.37853233]


portfolio before change:  [24.41695204]
curr_Stock_Price:  96.3062668443133
curr_Factors:  [96.30626684]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798447]
Stock Position:  -0.017984465283080224
Bond Position:  [26.14896875]


portfolio before change:  [24.40179707]
curr_Stock_Price:  97.51247607790643
curr_Factors:  [97.51247608]
mat_Sqrt:  [[0.15]]
grads:  [0.05519473]
Stock Position:  0.05519472939680641
Bond Position:  [19.01962234]


portfolio before change:  [24.40092141]
curr_Stock_Price:  97.41045259803931
curr_Factors:  [97.4104526]
mat_Sqrt:  [[0.15]]
grads:  [0.03126346]
Stock Position:  0.031263462860289935
Bond Position:  [21.35553334]


portfolio before change:  [24.41113338]
curr_Stock_Price:  97.56630292727792
curr_Factors:  [97.56630293]
mat_Sqrt:  [[0.15]]
grads:  [0.03182991]
Stock Position:  0.03182990872658896
Bond Position:  [21.30560686]


portfolio before change:  [24.3964975]
curr_Stock_Price:  96.93912720098132
curr_Factors:  [96.9391272]
mat_Sqrt:  [[0.15]]
grads:  [-0.11878189]
Stock Position:  -0.11878189024889702
Bond Position:  [35.91111027]


portfolio before change:  [24.2937893]
curr_Stock_Price:  97.87939764323028
curr_Factors:  [97.87939764]
mat_Sqrt:  [[0.15]]
grads:  [0.03617799]
Stock Position:  0.03617798649931512
Bond Position:  [20.75270978]


portfolio before change:  [24.30403862]
curr_Stock_Price:  98.01927530919065
curr_Factors:  [98.01927531]
mat_Sqrt:  [[0.15]]
grads:  [-0.06947081]
Stock Position:  -0.06947080789409768
Bond Position:  [31.11351687]


portfolio before change:  [24.28812109]
curr_Stock_Price:  98.36038098352199
curr_Factors:  [98.36038098]
mat_Sqrt:  [[0.15]]
grads:  [0.00498063]
Stock Position:  0.0049806326694895875
Bond Position:  [23.79822416]


portfolio before change:  [24.29291405]
curr_Stock_Price:  98.12801416565455
curr_Factors:  [98.12801417]
mat_Sqrt:  [[0.15]]
grads:  [-0.1114485]
Stock Position:  -0.11144849780525773
Bond Position:  [35.22913382]


portfolio before change:  [24.27557305]
curr_Stock_Price:  98.36264616230112
curr_Factors:  [98.36264616]
mat_Sqrt:  [[0.15]]
grads:  [0.05218751]
Stock Position:  0.052187505827369446
Bond Position:  [19.14227188]


portfolio before change:  [24.20665258]
curr_Stock_Price:  96.95030344747803
curr_Factors:  [96.95030345]
mat_Sqrt:  [[0.15]]
grads:  [0.0264482]
Stock Position:  0.02644819511370351
Bond Position:  [21.64249203]


portfolio before change:  [24.23779405]
curr_Stock_Price:  97.92315526530844
curr_Factors:  [97.92315527]
mat_Sqrt:  [[0.15]]
grads:  [-0.01303846]
Stock Position:  -0.013038464427430058
Bond Position:  [25.51456163]


portfolio before change:  [24.27142641]
curr_Stock_Price:  95.8329609074578
curr_Factors:  [95.83296091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.27142641]
Stock Price:  94.45239321728724
PL:  [24.27142641]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.04217160e-03]
 [ 6.11886293e-03]
 [ 1.29678194e-03]
 [ 1.46238793e-02]
 [ 2.52595453e-02]
 [ 6.94069226e-03]
 [ 3.38764809e-02]
 [ 3.92620728e-03]
 [ 8.50963527e-03]
 [ 1.33573383e-03]
 [-1.50299109e-02]
 [-7.90062278e-03]
 [-2.15618073e-02]
 [ 2.58975576e-03]
 [ 1.19111792e-02]
 [ 2.42321612e-03]
 [ 7.47304280e-03]
 [-3.10754804e-03]
 [-1.22934949e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.6054867]
curr_Stock_Price:  100.50836726609509
curr_Factors:  [100.50836727]
mat_Sqrt:  [[0.15]]
grads:  [0.04028114]
Stock Position:  0.040281143984543695
Bond Position:  [5.55689469]


portfolio before change:  [9.62409304]
curr_Stock_Price:  100.93578665050423
curr_Factors:  [100.93578665]
mat_Sqrt:  [[0.15]]
grads:  [0.04079242]
Stock Position:  0.04079241954050922
Bond Position:  [5.50667808]


portfolio before change:  [9.66083344]
curr_Stock_Price:  101.80270148091823
curr_Factors:  [101.80270148]
mat_Sqrt:  [[0.15]]
grads:  [0.00864521]
Stock Position:  0.008645212915276833
Bond Position:  [8.78072741]


portfolio before change:  [9.66731382]
curr_Stock_Price:  102.29834329269937
curr_Factors:  [102.29834329]
mat_Sqrt:  [[0.15]]
grads:  [0.09749253]
Stock Position:  0.09749252850693962
Bond Position:  [-0.30601033]


portfolio before change:  [9.66320114]
curr_Stock_Price:  102.25694356745781
curr_Factors:  [102.25694357]
mat_Sqrt:  [[0.15]]
grads:  [0.16839697]
Stock Position:  0.1683969686396364
Bond Position:  [-7.55655817]


portfolio before change:  [9.62644947]
curr_Stock_Price:  102.04991908768537
curr_Factors:  [102.04991909]
mat_Sqrt:  [[0.15]]
grads:  [0.04627128]
Stock Position:  0.04627128170090978
Bond Position:  [4.90446892]


portfolio before change:  [9.63307999]
curr_Stock_Price:  102.16671379410951
curr_Factors:  [102.16671379]
mat_Sqrt:  [[0.15]]
grads:  [0.22584321]
Stock Position:  0.2258432058328743
Bond Position:  [-13.44057819]


portfolio before change:  [9.80916917]
curr_Stock_Price:  102.96129051215374
curr_Factors:  [102.96129051]
mat_Sqrt:  [[0.15]]
grads:  [0.02617472]
Stock Position:  0.02617471522330084
Bond Position:  [7.11418672]


portfolio before change:  [9.81042624]
curr_Stock_Price:  102.94135897539361
curr_Factors:  [102.94135898]
mat_Sqrt:  [[0.15]]
grads:  [0.0567309]
Stock Position:  0.05673090177480296
Bond Position:  [3.97047012]


portfolio before change:  [9.79773057]
curr_Stock_Price:  102.70007221414764
curr_Factors:  [102.70007221]
mat_Sqrt:  [[0.15]]
grads:  [0.00890489]
Stock Position:  0.008904892232432123
Bond Position:  [8.88319749]


portfolio before change:  [9.7931714]
curr_Stock_Price:  101.93866602325834
curr_Factors:  [101.93866602]
mat_Sqrt:  [[0.15]]
grads:  [-0.10019941]
Stock Position:  -0.10019940617012761
Bond Position:  [20.0073652]


portfolio before change:  [9.73581851]
curr_Stock_Price:  102.56097865297609
curr_Factors:  [102.56097865]
mat_Sqrt:  [[0.15]]
grads:  [-0.05267082]
Stock Position:  -0.05267081852812657
Bond Position:  [15.13778921]


portfolio before change:  [9.71642966]
curr_Stock_Price:  103.00095236310342
curr_Factors:  [103.00095236]
mat_Sqrt:  [[0.15]]
grads:  [-0.14374538]
Stock Position:  -0.14374538184302882
Bond Position:  [24.52234089]


portfolio before change:  [9.81682871]
curr_Stock_Price:  102.34515597629803
curr_Factors:  [102.34515598]
mat_Sqrt:  [[0.15]]
grads:  [0.01726504]
Stock Position:  0.017265038389516534
Bond Position:  [8.04983567]


portfolio before change:  [9.82412215]
curr_Stock_Price:  102.65101869865333
curr_Factors:  [102.6510187]
mat_Sqrt:  [[0.15]]
grads:  [0.07940786]
Stock Position:  0.07940786160172983
Bond Position:  [1.67282427]


portfolio before change:  [9.85903261]
curr_Stock_Price:  103.08538624626647
curr_Factors:  [103.08538625]
mat_Sqrt:  [[0.15]]
grads:  [0.01615477]
Stock Position:  0.016154774110399162
Bond Position:  [8.19371148]


portfolio before change:  [9.84010755]
curr_Stock_Price:  101.78708610784145
curr_Factors:  [101.78708611]
mat_Sqrt:  [[0.15]]
grads:  [0.04982029]
Stock Position:  0.04982028531192842
Bond Position:  [4.76904588]


portfolio before change:  [9.81195492]
curr_Stock_Price:  101.19806822422832
curr_Factors:  [101.19806822]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071699]
Stock Position:  -0.020716986955495394
Bond Position:  [11.90847398]


portfolio before change:  [9.80990376]
curr_Stock_Price:  101.44079887323379
curr_Factors:  [101.44079887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.80990376]
Stock Price:  100.87722182205215
PL:  [8.93268194]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.31542856e-02]
 [ 6.56482821e-03]
 [ 1.33467984e-03]
 [ 1.55742183e-02]
 [ 2.37295266e-02]
 [ 6.71728626e-03]
 [ 2.96885242e-02]
 [ 2.33439491e-04]
 [ 9.27267931e-03]
 [-9.32947142e-03]
 [-9.78361585e-03]
 [-1.88997509e-02]
 [-2.14860371e-02]
 [ 4.21101435e-03]
 [ 2.58326870e-02]
 [ 2.55166406e-03]
 [ 6.81930490e-03]
 [-5.21047989e-03]
 [-1.16447235e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.2138643]
curr_Stock_Price:  101.26145337999492
curr_Factors:  [101.26145338]
mat_Sqrt:  [[0.15]]
grads:  [0.08769524]
Stock Position:  0.08769523702345206
Bond Position:  [12.33371715]


portfolio before change:  [21.28946433]
curr_Stock_Price:  102.08836509275321
curr_Factors:  [102.08836509]
mat_Sqrt:  [[0.15]]
grads:  [0.04376552]
Stock Position:  0.043765521379003774
Bond Position:  [16.82151381]


portfolio before change:  [21.28358791]
curr_Stock_Price:  101.85799370437024
curr_Factors:  [101.8579937]
mat_Sqrt:  [[0.15]]
grads:  [0.00889787]
Stock Position:  0.008897865613203238
Bond Position:  [20.37726918]


portfolio before change:  [21.29908373]
curr_Stock_Price:  103.02690996690424
curr_Factors:  [103.02690997]
mat_Sqrt:  [[0.15]]
grads:  [0.10382812]
Stock Position:  0.10382812222502738
Bond Position:  [10.60199313]


portfolio before change:  [21.39540528]
curr_Stock_Price:  103.92908101416606
curr_Factors:  [103.92908101]
mat_Sqrt:  [[0.15]]
grads:  [0.15819684]
Stock Position:  0.15819684400379394
Bond Position:  [4.95415267]


portfolio before change:  [21.19404917]
curr_Stock_Price:  102.64843088815071
curr_Factors:  [102.64843089]
mat_Sqrt:  [[0.15]]
grads:  [0.04478191]
Stock Position:  0.0447819084256955
Bond Position:  [16.59725654]


portfolio before change:  [21.27291983]
curr_Stock_Price:  104.31698026816805
curr_Factors:  [104.31698027]
mat_Sqrt:  [[0.15]]
grads:  [0.19792349]
Stock Position:  0.1979234944505818
Bond Position:  [0.62613856]


portfolio before change:  [21.1606753]
curr_Stock_Price:  103.74907862412228
curr_Factors:  [103.74907862]
mat_Sqrt:  [[0.15]]
grads:  [0.00155626]
Stock Position:  0.0015562632740809038
Bond Position:  [20.99921442]


portfolio before change:  [21.16705768]
curr_Stock_Price:  104.4764067551107
curr_Factors:  [104.47640676]
mat_Sqrt:  [[0.15]]
grads:  [0.06181786]
Stock Position:  0.061817862099094456
Bond Position:  [14.70854957]


portfolio before change:  [21.14987489]
curr_Stock_Price:  104.13895757577077
curr_Factors:  [104.13895758]
mat_Sqrt:  [[0.15]]
grads:  [-0.06219648]
Stock Position:  -0.06219647610340578
Bond Position:  [27.62695107]


portfolio before change:  [21.08880639]
curr_Stock_Price:  105.23188277685651
curr_Factors:  [105.23188278]
mat_Sqrt:  [[0.15]]
grads:  [-0.06522411]
Stock Position:  -0.06522410564336122
Bond Position:  [27.95246183]


portfolio before change:  [21.13487198]
curr_Stock_Price:  104.63276997626492
curr_Factors:  [104.63276998]
mat_Sqrt:  [[0.15]]
grads:  [-0.12599834]
Stock Position:  -0.12599833914578804
Bond Position:  [34.31842722]


portfolio before change:  [21.33710443]
curr_Stock_Price:  103.09583089420167
curr_Factors:  [103.09583089]
mat_Sqrt:  [[0.15]]
grads:  [-0.14324025]
Stock Position:  -0.1432402473166802
Bond Position:  [36.10457674]


portfolio before change:  [21.18733873]
curr_Stock_Price:  104.20440876226031
curr_Factors:  [104.20440876]
mat_Sqrt:  [[0.15]]
grads:  [0.02807343]
Stock Position:  0.028073429001828805
Bond Position:  [18.26196366]


portfolio before change:  [21.19470053]
curr_Stock_Price:  104.3039954268863
curr_Factors:  [104.30399543]
mat_Sqrt:  [[0.15]]
grads:  [0.17221791]
Stock Position:  0.17221791322584548
Bond Position:  [3.2316841]


portfolio before change:  [20.96496857]
curr_Stock_Price:  102.96534264327539
curr_Factors:  [102.96534264]
mat_Sqrt:  [[0.15]]
grads:  [0.01701109]
Stock Position:  0.01701109372684596
Bond Position:  [19.21341547]


portfolio before change:  [21.00352387]
curr_Stock_Price:  104.94942113317344
curr_Factors:  [104.94942113]
mat_Sqrt:  [[0.15]]
grads:  [0.04546203]
Stock Position:  0.045462032694600474
Bond Position:  [16.23230985]


portfolio before change:  [20.97268818]
curr_Stock_Price:  104.18187355437995
curr_Factors:  [104.18187355]
mat_Sqrt:  [[0.15]]
grads:  [-0.03473653]
Stock Position:  -0.034736532598355054
Bond Position:  [24.59160523]


portfolio before change:  [21.01580176]
curr_Stock_Price:  103.11772276854143
curr_Factors:  [103.11772277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.01580176]
Stock Price:  104.03395817067712
PL:  [16.98184359]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.37253843e-03]
 [ 8.59603118e-03]
 [ 9.45199413e-04]
 [ 1.42908805e-02]
 [ 2.78793324e-03]
 [ 4.57070624e-03]
 [-8.62481333e-03]
 [ 4.96692793e-03]
 [ 4.57501537e-03]
 [-2.05392423e-02]
 [-1.73233025e-02]
 [ 1.16580255e-02]
 [ 3.67261885e-02]
 [-6.62651655e-03]
 [-1.49281376e-02]
 [ 5.32738285e-03]
 [ 3.20762756e-05]
 [-7.43377536e-03]
 [-1.00759965e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.98152592]
curr_Stock_Price:  99.43229537155914
curr_Factors:  [99.43229537]
mat_Sqrt:  [[0.15]]
grads:  [0.04248359]
Stock Position:  0.0424835895371426
Bond Position:  [-11.20576674]


portfolio before change:  [-6.94946306]
curr_Stock_Price:  100.25295693729504
curr_Factors:  [100.25295694]
mat_Sqrt:  [[0.15]]
grads:  [0.05730687]
Stock Position:  0.05730687456422398
Bond Position:  [-12.69464669]


portfolio before change:  [-6.93331546]
curr_Stock_Price:  100.59011822025955
curr_Factors:  [100.59011822]
mat_Sqrt:  [[0.15]]
grads:  [0.00630133]
Stock Position:  0.0063013294226728885
Bond Position:  [-7.56716693]


portfolio before change:  [-6.92645265]
curr_Stock_Price:  101.9794829231262
curr_Factors:  [101.97948292]
mat_Sqrt:  [[0.15]]
grads:  [0.09527254]
Stock Position:  0.09527253690684442
Bond Position:  [-16.6422967]


portfolio before change:  [-7.21608403]
curr_Stock_Price:  98.98312845750276
curr_Factors:  [98.98312846]
mat_Sqrt:  [[0.15]]
grads:  [0.01858622]
Stock Position:  0.018586221581914607
Bond Position:  [-9.05580639]


portfolio before change:  [-7.22854643]
curr_Stock_Price:  98.43443338233635
curr_Factors:  [98.43443338]
mat_Sqrt:  [[0.15]]
grads:  [0.03047137]
Stock Position:  0.030471374924657346
Bond Position:  [-10.22797896]


portfolio before change:  [-7.23144864]
curr_Stock_Price:  98.4231148795227
curr_Factors:  [98.42311488]
mat_Sqrt:  [[0.15]]
grads:  [-0.05749876]
Stock Position:  -0.057498755523858934
Bond Position:  [-1.57224202]


portfolio before change:  [-7.12255303]
curr_Stock_Price:  96.52240037002882
curr_Factors:  [96.52240037]
mat_Sqrt:  [[0.15]]
grads:  [0.03311285]
Stock Position:  0.03311285289754078
Bond Position:  [-10.31868508]


portfolio before change:  [-7.15306167]
curr_Stock_Price:  95.67896200264755
curr_Factors:  [95.678962]
mat_Sqrt:  [[0.15]]
grads:  [0.0305001]
Stock Position:  0.030500102480745698
Bond Position:  [-10.07127982]


portfolio before change:  [-7.19641814]
curr_Stock_Price:  94.34000488994344
curr_Factors:  [94.34000489]
mat_Sqrt:  [[0.15]]
grads:  [-0.13692828]
Stock Position:  -0.13692828182220476
Bond Position:  [5.72139664]


portfolio before change:  [-7.15138372]
curr_Stock_Price:  94.0215615819164
curr_Factors:  [94.02156158]
mat_Sqrt:  [[0.15]]
grads:  [-0.11548868]
Stock Position:  -0.11548868333721564
Bond Position:  [3.70704264]


portfolio before change:  [-7.02134299]
curr_Stock_Price:  92.90358321528963
curr_Factors:  [92.90358322]
mat_Sqrt:  [[0.15]]
grads:  [0.07772017]
Stock Position:  0.07772016988337302
Bond Position:  [-14.24182526]


portfolio before change:  [-7.067516]
curr_Stock_Price:  92.35530711770195
curr_Factors:  [92.35530712]
mat_Sqrt:  [[0.15]]
grads:  [0.24484126]
Stock Position:  0.2448412565528582
Bond Position:  [-29.67990545]


portfolio before change:  [-7.2856233]
curr_Stock_Price:  91.49480509241995
curr_Factors:  [91.49480509]
mat_Sqrt:  [[0.15]]
grads:  [-0.04417678]
Stock Position:  -0.04417677698828707
Bond Position:  [-3.2436777]


portfolio before change:  [-7.21890874]
curr_Stock_Price:  89.96627393018969
curr_Factors:  [89.96627393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09952092]
Stock Position:  -0.09952091761851455
Bond Position:  [1.73461739]


portfolio before change:  [-7.26360468]
curr_Stock_Price:  90.41974283733018
curr_Factors:  [90.41974284]
mat_Sqrt:  [[0.15]]
grads:  [0.03551589]
Stock Position:  0.03551588564047927
Bond Position:  [-10.47494192]


portfolio before change:  [-7.29182394]
curr_Stock_Price:  89.69893305465702
curr_Factors:  [89.69893305]
mat_Sqrt:  [[0.15]]
grads:  [0.00021384]
Stock Position:  0.0002138418373949051
Bond Position:  [-7.31100532]


portfolio before change:  [-7.29355692]
curr_Stock_Price:  90.14316773288691
curr_Factors:  [90.14316773]
mat_Sqrt:  [[0.15]]
grads:  [-0.0495585]
Stock Position:  -0.04955850242486553
Bond Position:  [-2.82619652]


portfolio before change:  [-7.26193735]
curr_Stock_Price:  89.49088389618086
curr_Factors:  [89.4908839]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.26193735]
Stock Price:  90.06309617746486
PL:  [-7.26193735]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.89508857e-02]
 [ 6.08691524e-03]
 [ 9.73038044e-04]
 [ 3.44430425e-03]
 [ 7.04807286e-03]
 [ 4.10785408e-03]
 [-1.49124041e-02]
 [ 1.31918206e-02]
 [ 5.01407535e-03]
 [-6.60607574e-04]
 [-1.37333945e-02]
 [-1.96812493e-02]
 [-2.01815733e-02]
 [ 4.80904104e-03]
 [ 2.52840882e-02]
 [ 1.88913022e-03]
 [ 7.05269223e-03]
 [-5.19294757e-03]
 [-1.17079086e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.92855892]
curr_Stock_Price:  101.69706492310323
curr_Factors:  [101.69706492]
mat_Sqrt:  [[0.15]]
grads:  [0.12633924]
Stock Position:  0.12633923784039172
Bond Position:  [15.08022925]


portfolio before change:  [27.89789968]
curr_Stock_Price:  101.42454645097057
curr_Factors:  [101.42454645]
mat_Sqrt:  [[0.15]]
grads:  [0.04057943]
Stock Position:  0.04057943493003548
Bond Position:  [23.78214889]


portfolio before change:  [27.86884146]
curr_Stock_Price:  100.56192968330875
curr_Factors:  [100.56192968]
mat_Sqrt:  [[0.15]]
grads:  [0.00648692]
Stock Position:  0.006486920293339337
Bond Position:  [27.21650423]


portfolio before change:  [27.8720078]
curr_Stock_Price:  100.00101187227666
curr_Factors:  [100.00101187]
mat_Sqrt:  [[0.15]]
grads:  [0.02296203]
Stock Position:  0.022962028359040678
Bond Position:  [25.57578173]


portfolio before change:  [27.87561637]
curr_Stock_Price:  99.87967347899726
curr_Factors:  [99.87967348]
mat_Sqrt:  [[0.15]]
grads:  [0.04698715]
Stock Position:  0.04698715236880954
Bond Position:  [23.18255494]


portfolio before change:  [27.86069146]
curr_Stock_Price:  99.43867474205776
curr_Factors:  [99.43867474]
mat_Sqrt:  [[0.15]]
grads:  [0.02738569]
Stock Position:  0.027385693868475846
Bond Position:  [25.13749436]


portfolio before change:  [27.86140062]
curr_Stock_Price:  99.23506464387646
curr_Factors:  [99.23506464]
mat_Sqrt:  [[0.15]]
grads:  [-0.09941603]
Stock Position:  -0.09941602700211888
Bond Position:  [37.72695648]


portfolio before change:  [27.69083717]
curr_Stock_Price:  101.04560128776926
curr_Factors:  [101.04560129]
mat_Sqrt:  [[0.15]]
grads:  [0.08794547]
Stock Position:  0.08794547072001543
Bond Position:  [18.80433421]


portfolio before change:  [27.76141848]
curr_Stock_Price:  101.79469771250777
curr_Factors:  [101.79469771]
mat_Sqrt:  [[0.15]]
grads:  [0.03342717]
Stock Position:  0.03342716896999303
Bond Position:  [24.35870992]


portfolio before change:  [27.80677611]
curr_Stock_Price:  102.96940659288637
curr_Factors:  [102.96940659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440405]
Stock Position:  -0.004404050494321519
Bond Position:  [28.26025858]


portfolio before change:  [27.81457613]
curr_Stock_Price:  102.80272596969391
curr_Factors:  [102.80272597]
mat_Sqrt:  [[0.15]]
grads:  [-0.09155596]
Stock Position:  -0.09155596316072057
Bond Position:  [37.22677872]


portfolio before change:  [27.64394097]
curr_Stock_Price:  104.76811433770479
curr_Factors:  [104.76811434]
mat_Sqrt:  [[0.15]]
grads:  [-0.13120833]
Stock Position:  -0.13120832836738816
Bond Position:  [41.39039011]


portfolio before change:  [27.64999073]
curr_Stock_Price:  104.80087997525949
curr_Factors:  [104.80087998]
mat_Sqrt:  [[0.15]]
grads:  [-0.13454382]
Stock Position:  -0.13454382176319654
Bond Position:  [41.75030165]


portfolio before change:  [27.66036876]
curr_Stock_Price:  104.80133224974212
curr_Factors:  [104.80133225]
mat_Sqrt:  [[0.15]]
grads:  [0.03206027]
Stock Position:  0.03206027358143817
Bond Position:  [24.30040938]


portfolio before change:  [27.64802908]
curr_Stock_Price:  104.2269283975581
curr_Factors:  [104.2269284]
mat_Sqrt:  [[0.15]]
grads:  [0.16856059]
Stock Position:  0.1685605878362118
Bond Position:  [10.07947676]


portfolio before change:  [27.57391266]
curr_Stock_Price:  103.77227523976994
curr_Factors:  [103.77227524]
mat_Sqrt:  [[0.15]]
grads:  [0.0125942]
Stock Position:  0.012594201460192437
Bond Position:  [26.26698372]


portfolio before change:  [27.58640514]
curr_Stock_Price:  104.2427229637556
curr_Factors:  [104.24272296]
mat_Sqrt:  [[0.15]]
grads:  [0.04701795]
Stock Position:  0.04701794818465201
Bond Position:  [22.68512619]


portfolio before change:  [27.58247845]
curr_Stock_Price:  104.03857363334404
curr_Factors:  [104.03857363]
mat_Sqrt:  [[0.15]]
grads:  [-0.03461965]
Stock Position:  -0.0346196504411786
Bond Position:  [31.1842575]


portfolio before change:  [27.62885771]
curr_Stock_Price:  102.92411328141331
curr_Factors:  [102.92411328]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.62885771]
Stock Price:  103.7868908799002
PL:  [23.84196683]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.80331572e-03]
 [ 9.28917981e-03]
 [ 1.11358791e-03]
 [ 1.41256135e-02]
 [ 2.01324598e-02]
 [ 3.67807111e-03]
 [-9.96841481e-03]
 [ 1.22936015e-02]
 [ 4.45122516e-03]
 [ 1.31219816e-02]
 [-1.85316377e-02]
 [ 5.97043297e-03]
 [-1.88570105e-02]
 [ 2.05329945e-03]
 [-8.59672985e-04]
 [ 6.50629483e-03]
 [ 7.46748934e-03]
 [-2.45334323e-03]
 [-1.28068165e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.84628209]
curr_Stock_Price:  100.7834861697822
curr_Factors:  [100.78348617]
mat_Sqrt:  [[0.15]]
grads:  [0.04535544]
Stock Position:  0.045355438129334597
Bond Position:  [9.27520292]


portfolio before change:  [13.81195529]
curr_Stock_Price:  99.97551486479367
curr_Factors:  [99.97551486]
mat_Sqrt:  [[0.15]]
grads:  [0.06192787]
Stock Position:  0.061927865406441025
Bond Position:  [7.62068506]


portfolio before change:  [13.91261355]
curr_Stock_Price:  101.570158059753
curr_Factors:  [101.57015806]
mat_Sqrt:  [[0.15]]
grads:  [0.00742392]
Stock Position:  0.00742391941445056
Bond Position:  [13.15856488]


portfolio before change:  [13.91770428]
curr_Stock_Price:  101.81270907726929
curr_Factors:  [101.81270908]
mat_Sqrt:  [[0.15]]
grads:  [0.09417076]
Stock Position:  0.0941707569413418
Bond Position:  [4.3299244]


portfolio before change:  [13.86305584]
curr_Stock_Price:  101.22090062648813
curr_Factors:  [101.22090063]
mat_Sqrt:  [[0.15]]
grads:  [0.1342164]
Stock Position:  0.13421639892542797
Bond Position:  [0.27755107]


portfolio before change:  [13.65200725]
curr_Stock_Price:  99.64793347290016
curr_Factors:  [99.64793347]
mat_Sqrt:  [[0.15]]
grads:  [0.02452047]
Stock Position:  0.024520474077494234
Bond Position:  [11.20859268]


portfolio before change:  [13.62903108]
curr_Stock_Price:  98.59662122787856
curr_Factors:  [98.59662123]
mat_Sqrt:  [[0.15]]
grads:  [-0.0664561]
Stock Position:  -0.06645609873218292
Bond Position:  [20.18137787]


portfolio before change:  [13.5924842]
curr_Stock_Price:  99.22249085740098
curr_Factors:  [99.22249086]
mat_Sqrt:  [[0.15]]
grads:  [0.08195734]
Stock Position:  0.08195734333647868
Bond Position:  [5.46047245]


portfolio before change:  [13.54793627]
curr_Stock_Price:  98.66228216795265
curr_Factors:  [98.66228217]
mat_Sqrt:  [[0.15]]
grads:  [0.02967483]
Stock Position:  0.02967483437525617
Bond Position:  [10.62014939]


portfolio before change:  [13.5606956]
curr_Stock_Price:  99.00277128186185
curr_Factors:  [99.00277128]
mat_Sqrt:  [[0.15]]
grads:  [0.08747988]
Stock Position:  0.08747987745955654
Bond Position:  [4.8999453]


portfolio before change:  [13.53585521]
curr_Stock_Price:  98.70481100956682
curr_Factors:  [98.70481101]
mat_Sqrt:  [[0.15]]
grads:  [-0.12354425]
Stock Position:  -0.12354425124244474
Bond Position:  [25.73026718]


portfolio before change:  [13.53798649]
curr_Stock_Price:  98.73963329827767
curr_Factors:  [98.7396333]
mat_Sqrt:  [[0.15]]
grads:  [0.03980289]
Stock Position:  0.03980288643363375
Bond Position:  [9.60786408]


portfolio before change:  [13.5529328]
curr_Stock_Price:  99.05478751836684
curr_Factors:  [99.05478752]
mat_Sqrt:  [[0.15]]
grads:  [-0.1257134]
Stock Position:  -0.12571340327363106
Bond Position:  [26.00544725]


portfolio before change:  [13.31592892]
curr_Stock_Price:  100.99178110981873
curr_Factors:  [100.99178111]
mat_Sqrt:  [[0.15]]
grads:  [0.01368866]
Stock Position:  0.013688663022133427
Bond Position:  [11.93348646]


portfolio before change:  [13.3210533]
curr_Stock_Price:  101.14816092505308
curr_Factors:  [101.14816093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573115]
Stock Position:  -0.005731153230776736
Bond Position:  [13.9007489]


portfolio before change:  [13.32386417]
curr_Stock_Price:  101.26414904128073
curr_Factors:  [101.26414904]
mat_Sqrt:  [[0.15]]
grads:  [0.0433753]
Stock Position:  0.04337529887650252
Bond Position:  [8.93150144]


portfolio before change:  [13.34203324]
curr_Stock_Price:  101.63154506745018
curr_Factors:  [101.63154507]
mat_Sqrt:  [[0.15]]
grads:  [0.04978326]
Stock Position:  0.04978326229674659
Bond Position:  [8.28248337]


portfolio before change:  [13.28525871]
curr_Stock_Price:  100.44951317131391
curr_Factors:  [100.44951317]
mat_Sqrt:  [[0.15]]
grads:  [-0.01635562]
Stock Position:  -0.016355621557046916
Bond Position:  [14.92817294]


portfolio before change:  [13.29531843]
curr_Stock_Price:  100.06266111728395
curr_Factors:  [100.06266112]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.29531843]
Stock Price:  99.58891825512337
PL:  [13.29531843]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.52789526e-02]
 [ 5.12726248e-03]
 [-1.01914412e-03]
 [ 2.19964172e-03]
 [ 1.56246646e-02]
 [ 5.02426472e-03]
 [ 2.64220481e-02]
 [ 7.68468227e-03]
 [ 4.59474032e-03]
 [ 1.87623497e-03]
 [-1.35911866e-02]
 [-1.64223924e-02]
 [-1.99040545e-02]
 [ 6.95768437e-03]
 [ 4.83741862e-02]
 [-1.68316870e-03]
 [ 5.98388424e-03]
 [-5.57601255e-03]
 [-9.85118453e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.26974606]
curr_Stock_Price:  99.0243510895639
curr_Factors:  [99.02435109]
mat_Sqrt:  [[0.15]]
grads:  [0.10185968]
Stock Position:  0.10185968416439321
Bond Position:  [-23.35633518]


portfolio before change:  [-13.3243246]
curr_Stock_Price:  98.54586218941245
curr_Factors:  [98.54586219]
mat_Sqrt:  [[0.15]]
grads:  [0.03418175]
Stock Position:  0.03418174983686499
Bond Position:  [-16.69279461]


portfolio before change:  [-13.33079856]
curr_Stock_Price:  98.47856763186333
curr_Factors:  [98.47856763]
mat_Sqrt:  [[0.15]]
grads:  [-0.00679429]
Stock Position:  -0.006794294112685517
Bond Position:  [-12.66170621]


portfolio before change:  [-13.33523074]
curr_Stock_Price:  98.6649519872295
curr_Factors:  [98.66495199]
mat_Sqrt:  [[0.15]]
grads:  [0.01466428]
Stock Position:  0.01466427815564776
Bond Position:  [-14.78208104]


portfolio before change:  [-13.30879508]
curr_Stock_Price:  100.71971672618474
curr_Factors:  [100.71971673]
mat_Sqrt:  [[0.15]]
grads:  [0.10416443]
Stock Position:  0.10416443044826187
Bond Position:  [-23.80020701]


portfolio before change:  [-13.28587833]
curr_Stock_Price:  100.99685105109911
curr_Factors:  [100.99685105]
mat_Sqrt:  [[0.15]]
grads:  [0.0334951]
Stock Position:  0.03349509811785833
Bond Position:  [-16.66877777]


portfolio before change:  [-13.27845508]
curr_Stock_Price:  101.34290077052829
curr_Factors:  [101.34290077]
mat_Sqrt:  [[0.15]]
grads:  [0.17614699]
Stock Position:  0.17614698709787113
Bond Position:  [-31.12970171]


portfolio before change:  [-13.13642327]
curr_Stock_Price:  102.19341324601277
curr_Factors:  [102.19341325]
mat_Sqrt:  [[0.15]]
grads:  [0.05123122]
Stock Position:  0.05123121514084319
Bond Position:  [-18.37191601]


portfolio before change:  [-13.16778206]
curr_Stock_Price:  101.67097320028041
curr_Factors:  [101.6709732]
mat_Sqrt:  [[0.15]]
grads:  [0.0306316]
Stock Position:  0.03063160210430393
Bond Position:  [-16.28212686]


portfolio before change:  [-13.14256384]
curr_Stock_Price:  102.62715105136773
curr_Factors:  [102.62715105]
mat_Sqrt:  [[0.15]]
grads:  [0.01250823]
Stock Position:  0.012508233118771288
Bond Position:  [-14.42624817]


portfolio before change:  [-13.14288076]
curr_Stock_Price:  102.89018537149403
curr_Factors:  [102.89018537]
mat_Sqrt:  [[0.15]]
grads:  [-0.09060791]
Stock Position:  -0.09060791052782197
Bond Position:  [-3.82021605]


portfolio before change:  [-13.26285318]
curr_Stock_Price:  104.20372686808352
curr_Factors:  [104.20372687]
mat_Sqrt:  [[0.15]]
grads:  [-0.10948262]
Stock Position:  -0.10948261624867998
Bond Position:  [-1.85435654]


portfolio before change:  [-13.39273546]
curr_Stock_Price:  105.38581983174632
curr_Factors:  [105.38581983]
mat_Sqrt:  [[0.15]]
grads:  [-0.1326937]
Stock Position:  -0.13269369649647172
Bond Position:  [0.59129853]


portfolio before change:  [-13.54995409]
curr_Stock_Price:  106.5717576429533
curr_Factors:  [106.57175764]
mat_Sqrt:  [[0.15]]
grads:  [0.04638456]
Stock Position:  0.04638456248507967
Bond Position:  [-18.49323844]


portfolio before change:  [-13.51324782]
curr_Stock_Price:  107.462790298265
curr_Factors:  [107.4627903]
mat_Sqrt:  [[0.15]]
grads:  [0.32249457]
Stock Position:  0.3224945744355034
Bond Position:  [-48.16941464]


portfolio before change:  [-13.1680953]
curr_Stock_Price:  108.57039459208711
curr_Factors:  [108.57039459]
mat_Sqrt:  [[0.15]]
grads:  [-0.01122112]
Stock Position:  -0.011221124654505223
Bond Position:  [-11.94981337]


portfolio before change:  [-13.15883735]
curr_Stock_Price:  107.47907973579062
curr_Factors:  [107.47907974]
mat_Sqrt:  [[0.15]]
grads:  [0.03989256]
Stock Position:  0.03989256163229898
Bond Position:  [-17.44645316]


portfolio before change:  [-13.14642571]
curr_Stock_Price:  107.89955406361149
curr_Factors:  [107.89955406]
mat_Sqrt:  [[0.15]]
grads:  [-0.03717342]
Stock Position:  -0.03717341697546505
Bond Position:  [-9.13543059]


portfolio before change:  [-13.12245502]
curr_Stock_Price:  107.19327433253514
curr_Factors:  [107.19327433]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.12245502]
Stock Price:  106.71027758787366
PL:  [-19.83273261]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.39859849e-02]
 [ 6.81313573e-03]
 [ 1.62444714e-03]
 [ 1.50369644e-02]
 [ 2.40456230e-02]
 [ 6.57418080e-03]
 [ 3.02365541e-02]
 [-7.25490538e-03]
 [ 9.51447307e-03]
 [-5.38723236e-03]
 [-9.67860283e-03]
 [-1.83340376e-02]
 [-2.31485003e-02]
 [ 2.43019679e-03]
 [ 1.33720446e-02]
 [ 2.94725014e-03]
 [ 7.00583841e-03]
 [-5.08882383e-03]
 [-1.13602849e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.17729234]
curr_Stock_Price:  101.32395516108907
curr_Factors:  [101.32395516]
mat_Sqrt:  [[0.15]]
grads:  [0.0932399]
Stock Position:  0.09323989927557849
Bond Position:  [12.72985696]


portfolio before change:  [22.28390695]
curr_Stock_Price:  102.43326295532347
curr_Factors:  [102.43326296]
mat_Sqrt:  [[0.15]]
grads:  [0.0454209]
Stock Position:  0.04542090484829305
Bond Position:  [17.63129546]


portfolio before change:  [22.28980093]
curr_Stock_Price:  102.46597051328033
curr_Factors:  [102.46597051]
mat_Sqrt:  [[0.15]]
grads:  [0.01082965]
Stock Position:  0.010829647615297859
Bond Position:  [21.18013057]


portfolio before change:  [22.29671089]
curr_Stock_Price:  102.61503029644203
curr_Factors:  [102.6150303]
mat_Sqrt:  [[0.15]]
grads:  [0.10024643]
Stock Position:  0.10024642909359718
Bond Position:  [12.00992053]


portfolio before change:  [22.40711144]
curr_Stock_Price:  103.68636717712508
curr_Factors:  [103.68636718]
mat_Sqrt:  [[0.15]]
grads:  [0.16030415]
Stock Position:  0.1603041535113473
Bond Position:  [5.78575612]


portfolio before change:  [22.30363063]
curr_Stock_Price:  103.03181501632027
curr_Factors:  [103.03181502]
mat_Sqrt:  [[0.15]]
grads:  [0.04382787]
Stock Position:  0.04382787197362707
Bond Position:  [17.78796543]


portfolio before change:  [22.35720812]
curr_Stock_Price:  104.15278983816958
curr_Factors:  [104.15278984]
mat_Sqrt:  [[0.15]]
grads:  [0.20157703]
Stock Position:  0.20157702717975634
Bond Position:  [1.36239837]


portfolio before change:  [22.59819093]
curr_Stock_Price:  105.34658742955506
curr_Factors:  [105.34658743]
mat_Sqrt:  [[0.15]]
grads:  [-0.04836604]
Stock Position:  -0.048366035841005336
Bond Position:  [27.69338775]


portfolio before change:  [22.63345226]
curr_Stock_Price:  104.76069854062494
curr_Factors:  [104.76069854]
mat_Sqrt:  [[0.15]]
grads:  [0.06342982]
Stock Position:  0.06342982046603501
Bond Position:  [15.98849996]


portfolio before change:  [22.56427699]
curr_Stock_Price:  103.60709438703131
curr_Factors:  [103.60709439]
mat_Sqrt:  [[0.15]]
grads:  [-0.03591488]
Stock Position:  -0.03591488238131837
Bond Position:  [26.28531359]


portfolio before change:  [22.51017552]
curr_Stock_Price:  105.29646692693254
curr_Factors:  [105.29646693]
mat_Sqrt:  [[0.15]]
grads:  [-0.06452402]
Stock Position:  -0.0645240188343633
Bond Position:  [29.30432673]


portfolio before change:  [22.56664855]
curr_Stock_Price:  104.53479650877048
curr_Factors:  [104.53479651]
mat_Sqrt:  [[0.15]]
grads:  [-0.12222692]
Stock Position:  -0.12222691709156693
Bond Position:  [35.34361446]


portfolio before change:  [22.88809107]
curr_Stock_Price:  101.97721328428781
curr_Factors:  [101.97721328]
mat_Sqrt:  [[0.15]]
grads:  [-0.15432334]
Stock Position:  -0.15432333564248987
Bond Position:  [38.62555479]


portfolio before change:  [22.86920485]
curr_Stock_Price:  102.16217439827022
curr_Factors:  [102.1621744]
mat_Sqrt:  [[0.15]]
grads:  [0.01620131]
Stock Position:  0.01620131193708682
Bond Position:  [21.2140436]


portfolio before change:  [22.88460164]
curr_Stock_Price:  102.7851248362924
curr_Factors:  [102.78512484]
mat_Sqrt:  [[0.15]]
grads:  [0.08914696]
Stock Position:  0.08914696391249177
Bond Position:  [13.72161983]


portfolio before change:  [22.88031861]
curr_Stock_Price:  102.69859507618023
curr_Factors:  [102.69859508]
mat_Sqrt:  [[0.15]]
grads:  [0.01964833]
Stock Position:  0.019648334267693652
Bond Position:  [20.86246229]


portfolio before change:  [22.918662]
curr_Stock_Price:  104.38459659661765
curr_Factors:  [104.3845966]
mat_Sqrt:  [[0.15]]
grads:  [0.04670559]
Stock Position:  0.04670558939761594
Bond Position:  [18.04331789]


portfolio before change:  [22.86635033]
curr_Stock_Price:  103.16797437820301
curr_Factors:  [103.16797438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392549]
Stock Position:  -0.03392549220167523
Bond Position:  [26.36637465]


portfolio before change:  [22.85754342]
curr_Stock_Price:  103.62189076040889
curr_Factors:  [103.62189076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.85754342]
Stock Price:  103.25793628189331
PL:  [19.59960713]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.64821507e-02]
 [ 5.95336096e-03]
 [ 3.39552943e-04]
 [ 1.92192005e-03]
 [-1.06730191e-03]
 [ 2.62658392e-03]
 [-4.12510824e-03]
 [ 7.87747781e-03]
 [ 4.63860415e-03]
 [-1.21401342e-02]
 [-1.75626913e-02]
 [ 8.35029766e-03]
 [ 1.92284882e-02]
 [-4.06187721e-03]
 [-1.64198871e-02]
 [ 6.64108008e-03]
 [ 3.90143415e-03]
 [-3.10510949e-03]
 [-1.24962201e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.10991847]
curr_Stock_Price:  98.96984543866616
curr_Factors:  [98.96984544]
mat_Sqrt:  [[0.15]]
grads:  [0.109881]
Stock Position:  0.10988100499448247
Bond Position:  [-24.98482455]


portfolio before change:  [-14.14612403]
curr_Stock_Price:  98.6971998022817
curr_Factors:  [98.6971998]
mat_Sqrt:  [[0.15]]
grads:  [0.03968907]
Stock Position:  0.03968907304250914
Bond Position:  [-18.0633244]


portfolio before change:  [-14.13937038]
curr_Stock_Price:  98.98115816066394
curr_Factors:  [98.98115816]
mat_Sqrt:  [[0.15]]
grads:  [0.00226369]
Stock Position:  0.0022636862861707147
Bond Position:  [-14.36343267]


portfolio before change:  [-14.1440371]
curr_Stock_Price:  98.5060904415018
curr_Factors:  [98.50609044]
mat_Sqrt:  [[0.15]]
grads:  [0.0128128]
Stock Position:  0.012812800306861185
Bond Position:  [-15.40617596]


portfolio before change:  [-14.16287177]
curr_Stock_Price:  97.3367404360592
curr_Factors:  [97.33674044]
mat_Sqrt:  [[0.15]]
grads:  [-0.00711535]
Stock Position:  -0.007115346058975391
Bond Position:  [-13.47028718]


portfolio before change:  [-14.16708587]
curr_Stock_Price:  97.45565377801182
curr_Factors:  [97.45565378]
mat_Sqrt:  [[0.15]]
grads:  [0.01751056]
Stock Position:  0.01751055948124205
Bond Position:  [-15.87358889]


portfolio before change:  [-14.18251637]
curr_Stock_Price:  96.80109985770379
curr_Factors:  [96.80109986]
mat_Sqrt:  [[0.15]]
grads:  [-0.02750072]
Stock Position:  -0.027500721578080693
Bond Position:  [-11.52041627]


portfolio before change:  [-14.20081141]
curr_Stock_Price:  97.3616151407626
curr_Factors:  [97.36161514]
mat_Sqrt:  [[0.15]]
grads:  [0.05251652]
Stock Position:  0.052516518730621395
Bond Position:  [-19.31390449]


portfolio before change:  [-14.2435094]
curr_Stock_Price:  96.64052947274523
curr_Factors:  [96.64052947]
mat_Sqrt:  [[0.15]]
grads:  [0.03092403]
Stock Position:  0.030924027687665515
Bond Position:  [-17.23202381]


portfolio before change:  [-14.28267168]
curr_Stock_Price:  95.51345318437734
curr_Factors:  [95.51345318]
mat_Sqrt:  [[0.15]]
grads:  [-0.08093423]
Stock Position:  -0.08093422805293336
Bond Position:  [-6.55236408]


portfolio before change:  [-14.27269481]
curr_Stock_Price:  95.3699395563536
curr_Factors:  [95.36993956]
mat_Sqrt:  [[0.15]]
grads:  [-0.11708461]
Stock Position:  -0.11708460864941146
Bond Position:  [-3.10634276]


portfolio before change:  [-14.22562136]
curr_Stock_Price:  94.96125962424733
curr_Factors:  [94.96125962]
mat_Sqrt:  [[0.15]]
grads:  [0.05566865]
Stock Position:  0.055668651076405236
Bond Position:  [-19.51198659]


portfolio before change:  [-14.2556781]
curr_Stock_Price:  94.5089739313432
curr_Factors:  [94.50897393]
mat_Sqrt:  [[0.15]]
grads:  [0.12818992]
Stock Position:  0.12818992110346888
Bond Position:  [-26.37077602]


portfolio before change:  [-14.28541457]
curr_Stock_Price:  94.32843750790417
curr_Factors:  [94.32843751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02707918]
Stock Position:  -0.02707918137971104
Bond Position:  [-11.7310777]


portfolio before change:  [-14.31353659]
curr_Stock_Price:  95.25863105587268
curr_Factors:  [95.25863106]
mat_Sqrt:  [[0.15]]
grads:  [-0.10946591]
Stock Position:  -0.10946591424304496
Bond Position:  [-3.88596345]


portfolio before change:  [-14.39823848]
curr_Stock_Price:  96.02352926715055
curr_Factors:  [96.02352927]
mat_Sqrt:  [[0.15]]
grads:  [0.04427387]
Stock Position:  0.044273867197652396
Bond Position:  [-18.64957147]


portfolio before change:  [-14.36723742]
curr_Stock_Price:  96.82906171890373
curr_Factors:  [96.82906172]
mat_Sqrt:  [[0.15]]
grads:  [0.02600956]
Stock Position:  0.026009561011879526
Bond Position:  [-16.88571881]


portfolio before change:  [-14.39687349]
curr_Stock_Price:  95.85195519452948
curr_Factors:  [95.85195519]
mat_Sqrt:  [[0.15]]
grads:  [-0.02070073]
Stock Position:  -0.02070072995020624
Bond Position:  [-12.41266805]


portfolio before change:  [-14.40637069]
curr_Stock_Price:  96.16081601122657
curr_Factors:  [96.16081601]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.40637069]
Stock Price:  96.36312768465284
PL:  [-14.40637069]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.95157258e-03]
 [ 8.73429309e-03]
 [ 1.25071590e-03]
 [ 1.29326297e-02]
 [ 1.92901652e-02]
 [ 6.98290050e-03]
 [ 2.59961554e-02]
 [ 1.31147402e-02]
 [ 3.29622440e-03]
 [ 9.26573862e-03]
 [-1.75427831e-02]
 [ 5.12774127e-03]
 [-1.23324246e-02]
 [ 1.94076475e-04]
 [-1.71783603e-02]
 [ 7.68693829e-03]
 [ 4.73199481e-03]
 [-1.96251072e-03]
 [-1.27724313e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.0520915]
curr_Stock_Price:  99.88859682843345
curr_Factors:  [99.88859683]
mat_Sqrt:  [[0.15]]
grads:  [0.01301048]
Stock Position:  0.013010483890873179
Bond Position:  [-1.24750748]


portfolio before change:  [0.05452519]
curr_Stock_Price:  100.09962681675202
curr_Factors:  [100.09962682]
mat_Sqrt:  [[0.15]]
grads:  [0.05822862]
Stock Position:  0.05822862058210623
Bond Position:  [-5.774138]


portfolio before change:  [0.05550543]
curr_Stock_Price:  100.14125513557427
curr_Factors:  [100.14125514]
mat_Sqrt:  [[0.15]]
grads:  [0.00833811]
Stock Position:  0.008338105968823091
Bond Position:  [-0.77948297]


portfolio before change:  [0.06398383]
curr_Stock_Price:  101.18145419560216
curr_Factors:  [101.1814542]
mat_Sqrt:  [[0.15]]
grads:  [0.08621753]
Stock Position:  0.08621753138673925
Bond Position:  [-8.65963138]


portfolio before change:  [0.05646043]
curr_Stock_Price:  101.11930654880518
curr_Factors:  [101.11930655]
mat_Sqrt:  [[0.15]]
grads:  [0.1286011]
Stock Position:  0.12860110104640615
Bond Position:  [-12.94759373]


portfolio before change:  [0.15835907]
curr_Stock_Price:  101.93684183873061
curr_Factors:  [101.93684184]
mat_Sqrt:  [[0.15]]
grads:  [0.04655267]
Stock Position:  0.046552670025245206
Bond Position:  [-4.58707309]


portfolio before change:  [0.12767896]
curr_Stock_Price:  101.30243783972611
curr_Factors:  [101.30243784]
mat_Sqrt:  [[0.15]]
grads:  [0.1733077]
Stock Position:  0.17330770233939194
Bond Position:  [-17.42881379]


portfolio before change:  [-0.03177748]
curr_Stock_Price:  100.40750535755075
curr_Factors:  [100.40750536]
mat_Sqrt:  [[0.15]]
grads:  [0.0874316]
Stock Position:  0.0874316012521179
Bond Position:  [-8.81056646]


portfolio before change:  [-0.12655626]
curr_Stock_Price:  99.34866787093215
curr_Factors:  [99.34866787]
mat_Sqrt:  [[0.15]]
grads:  [0.02197483]
Stock Position:  0.021974829300328323
Bond Position:  [-2.30972628]


portfolio before change:  [-0.11361609]
curr_Stock_Price:  99.96381140615016
curr_Factors:  [99.96381141]
mat_Sqrt:  [[0.15]]
grads:  [0.06177159]
Stock Position:  0.061771590792959186
Bond Position:  [-6.28853974]


portfolio before change:  [-0.1234321]
curr_Stock_Price:  99.83035716921863
curr_Factors:  [99.83035717]
mat_Sqrt:  [[0.15]]
grads:  [-0.11695189]
Stock Position:  -0.11695188722798132
Bond Position:  [11.55191657]


portfolio before change:  [-0.09783491]
curr_Stock_Price:  99.63618454687175
curr_Factors:  [99.63618455]
mat_Sqrt:  [[0.15]]
grads:  [0.03418494]
Stock Position:  0.034184941808000406
Bond Position:  [-3.50389208]


portfolio before change:  [-0.14596305]
curr_Stock_Price:  98.25393680627408
curr_Factors:  [98.25393681]
mat_Sqrt:  [[0.15]]
grads:  [-0.08221616]
Stock Position:  -0.08221616378142133
Bond Position:  [7.93209871]


portfolio before change:  [-0.12705008]
curr_Stock_Price:  98.04801990129147
curr_Factors:  [98.0480199]
mat_Sqrt:  [[0.15]]
grads:  [0.00129384]
Stock Position:  0.0012938431689473251
Bond Position:  [-0.25390884]


portfolio before change:  [-0.12755787]
curr_Stock_Price:  97.704615220981
curr_Factors:  [97.70461522]
mat_Sqrt:  [[0.15]]
grads:  [-0.1145224]
Stock Position:  -0.11452240232046627
Bond Position:  [11.06180938]


portfolio before change:  [-0.17984594]
curr_Stock_Price:  98.1853409338668
curr_Factors:  [98.18534093]
mat_Sqrt:  [[0.15]]
grads:  [0.05124626]
Stock Position:  0.0512462552720648
Bond Position:  [-5.21147698]


portfolio before change:  [-0.1543959]
curr_Stock_Price:  98.7073903002775
curr_Factors:  [98.7073903]
mat_Sqrt:  [[0.15]]
grads:  [0.03154663]
Stock Position:  0.03154663207608657
Bond Position:  [-3.26828162]


portfolio before change:  [-0.12570224]
curr_Stock_Price:  99.64285704607457
curr_Factors:  [99.64285705]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130834]
Stock Position:  -0.013083404792687872
Bond Position:  [1.17796559]


portfolio before change:  [-0.1323057]
curr_Stock_Price:  100.17008910002794
curr_Factors:  [100.1700891]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.1323057]
Stock Price:  101.93175585530174
PL:  [-2.06406156]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.44423802e-03]
 [ 7.97808844e-03]
 [-2.61614088e-04]
 [-1.65328874e-04]
 [-8.66068865e-03]
 [-3.39069417e-03]
 [-6.92907502e-04]
 [ 8.34177465e-03]
 [ 4.61754541e-03]
 [-9.69311535e-03]
 [-1.75986616e-02]
 [ 7.28377121e-03]
 [ 8.25729065e-03]
 [-3.42448264e-03]
 [-1.66904985e-02]
 [ 7.22974419e-03]
 [ 4.12088358e-03]
 [-2.13664748e-03]
 [-1.26650669e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.18165129]
curr_Stock_Price:  100.74036866956453
curr_Factors:  [100.74036867]
mat_Sqrt:  [[0.15]]
grads:  [0.04296159]
Stock Position:  0.04296158680623784
Bond Position:  [8.8536852]


portfolio before change:  [13.17203156]
curr_Stock_Price:  100.46492643420905
curr_Factors:  [100.46492643]
mat_Sqrt:  [[0.15]]
grads:  [0.05318726]
Stock Position:  0.05318725624030355
Bond Position:  [7.82857777]


portfolio before change:  [13.08331719]
curr_Stock_Price:  98.76016178783765
curr_Factors:  [98.76016179]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174409]
Stock Position:  -0.0017440939189878395
Bond Position:  [13.25556419]


portfolio before change:  [13.08915697]
curr_Stock_Price:  97.31214838761029
curr_Factors:  [97.31214839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00110219]
Stock Position:  -0.0011021924963952024
Bond Position:  [13.19641369]


portfolio before change:  [13.09426271]
curr_Stock_Price:  95.67339250228636
curr_Factors:  [95.6733925]
mat_Sqrt:  [[0.15]]
grads:  [-0.05773792]
Stock Position:  -0.05773792435053505
Bond Position:  [18.61824581]


portfolio before change:  [13.12505885]
curr_Stock_Price:  95.2206398007401
curr_Factors:  [95.2206398]
mat_Sqrt:  [[0.15]]
grads:  [-0.02260463]
Stock Position:  -0.02260462780565646
Bond Position:  [15.27748597]


portfolio before change:  [13.1177142]
curr_Stock_Price:  95.71454298551676
curr_Factors:  [95.71454299]
mat_Sqrt:  [[0.15]]
grads:  [-0.00461938]
Stock Position:  -0.004619383349136567
Bond Position:  [13.55985637]


portfolio before change:  [13.11269072]
curr_Stock_Price:  97.53597099408051
curr_Factors:  [97.53597099]
mat_Sqrt:  [[0.15]]
grads:  [0.05561183]
Stock Position:  0.05561183097584871
Bond Position:  [7.68853678]


portfolio before change:  [13.04710675]
curr_Stock_Price:  96.32208643523195
curr_Factors:  [96.32208644]
mat_Sqrt:  [[0.15]]
grads:  [0.03078364]
Stock Position:  0.03078363605133417
Bond Position:  [10.0819627]


portfolio before change:  [13.0349218]
curr_Stock_Price:  95.84437321605054
curr_Factors:  [95.84437322]
mat_Sqrt:  [[0.15]]
grads:  [-0.06462077]
Stock Position:  -0.06462076903203909
Bond Position:  [19.22845891]


portfolio before change:  [13.04766227]
curr_Stock_Price:  95.72161465819586
curr_Factors:  [95.72161466]
mat_Sqrt:  [[0.15]]
grads:  [-0.11732441]
Stock Position:  -0.1173244107479307
Bond Position:  [24.27814431]


portfolio before change:  [13.04856761]
curr_Stock_Price:  95.7656375657037
curr_Factors:  [95.76563757]
mat_Sqrt:  [[0.15]]
grads:  [0.04855847]
Stock Position:  0.048558474730395824
Bond Position:  [8.39833431]


portfolio before change:  [13.05521751]
curr_Stock_Price:  95.85934018326522
curr_Factors:  [95.85934018]
mat_Sqrt:  [[0.15]]
grads:  [0.0550486]
Stock Position:  0.05504860433397039
Bond Position:  [7.77829462]


portfolio before change:  [13.01165613]
curr_Stock_Price:  95.03268542568783
curr_Factors:  [95.03268543]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282988]
Stock Position:  -0.022829884244115837
Bond Position:  [15.18124134]


portfolio before change:  [12.98837551]
curr_Stock_Price:  96.21869288583333
curr_Factors:  [96.21869289]
mat_Sqrt:  [[0.15]]
grads:  [-0.11126999]
Stock Position:  -0.11126998971103738
Bond Position:  [23.69462847]


portfolio before change:  [12.90005552]
curr_Stock_Price:  97.06568121664061
curr_Factors:  [97.06568122]
mat_Sqrt:  [[0.15]]
grads:  [0.04819829]
Stock Position:  0.04819829462352339
Bond Position:  [8.22165522]


portfolio before change:  [12.91019711]
curr_Stock_Price:  97.2334447400756
curr_Factors:  [97.23344474]
mat_Sqrt:  [[0.15]]
grads:  [0.02747256]
Stock Position:  0.027472557171455848
Bond Position:  [10.23894574]


portfolio before change:  [12.91050283]
curr_Stock_Price:  97.15138702151913
curr_Factors:  [97.15138702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424432]
Stock Position:  -0.014244316514766332
Bond Position:  [14.29435793]


portfolio before change:  [12.91381603]
curr_Stock_Price:  97.16969822020394
curr_Factors:  [97.16969822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.91381603]
Stock Price:  97.94044596379993
PL:  [12.91381603]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.79245825e-02]
 [ 7.38836243e-03]
 [ 2.54293240e-03]
 [ 1.83228376e-02]
 [ 2.09297410e-02]
 [ 5.19374836e-03]
 [ 2.70412635e-02]
 [-9.42587103e-03]
 [ 9.24629017e-03]
 [-1.59720100e-02]
 [-8.88774159e-03]
 [-3.20341785e-02]
 [-1.74420413e-02]
 [ 9.64582340e-03]
 [ 6.18202568e-02]
 [-1.99508370e-03]
 [ 5.58292087e-03]
 [-5.47253635e-03]
 [-1.01036982e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.32355468]
curr_Stock_Price:  102.37143366189822
curr_Factors:  [102.37143366]
mat_Sqrt:  [[0.15]]
grads:  [0.18616388]
Stock Position:  0.18616388322733143
Bond Position:  [19.26569106]


portfolio before change:  [38.59231828]
curr_Stock_Price:  103.7892520242757
curr_Factors:  [103.78925202]
mat_Sqrt:  [[0.15]]
grads:  [0.04925575]
Stock Position:  0.0492557495532902
Bond Position:  [33.48010088]


portfolio before change:  [38.61744253]
curr_Stock_Price:  104.12937841957714
curr_Factors:  [104.12937842]
mat_Sqrt:  [[0.15]]
grads:  [0.01695288]
Stock Position:  0.016952882665456435
Bond Position:  [36.8521494]


portfolio before change:  [38.65062851]
curr_Stock_Price:  105.54340243536967
curr_Factors:  [105.54340244]
mat_Sqrt:  [[0.15]]
grads:  [0.12215225]
Stock Position:  0.12215225064466102
Bond Position:  [25.75826436]


portfolio before change:  [38.71698771]
curr_Stock_Price:  106.03392823638511
curr_Factors:  [106.03392824]
mat_Sqrt:  [[0.15]]
grads:  [0.13953161]
Stock Position:  0.13953160691161168
Bond Position:  [23.92190331]


portfolio before change:  [38.75933745]
curr_Stock_Price:  106.29457543292274
curr_Factors:  [106.29457543]
mat_Sqrt:  [[0.15]]
grads:  [0.03462499]
Stock Position:  0.03462498905216555
Bond Position:  [35.07888894]


portfolio before change:  [38.72709592]
curr_Stock_Price:  105.1101027993843
curr_Factors:  [105.1101028]
mat_Sqrt:  [[0.15]]
grads:  [0.18027509]
Stock Position:  0.18027508993594915
Bond Position:  [19.77836268]


portfolio before change:  [38.85816565]
curr_Stock_Price:  105.8097253862343
curr_Factors:  [105.80972539]
mat_Sqrt:  [[0.15]]
grads:  [-0.06283914]
Stock Position:  -0.06283914016835679
Bond Position:  [45.50715782]


portfolio before change:  [38.95527819]
curr_Stock_Price:  104.44537941835695
curr_Factors:  [104.44537942]
mat_Sqrt:  [[0.15]]
grads:  [0.06164193]
Stock Position:  0.06164193448657612
Bond Position:  [32.51706296]


portfolio before change:  [38.99538988]
curr_Stock_Price:  104.96420483245845
curr_Factors:  [104.96420483]
mat_Sqrt:  [[0.15]]
grads:  [-0.10648007]
Stock Position:  -0.106480066472991
Bond Position:  [50.17198538]


portfolio before change:  [38.9207645]
curr_Stock_Price:  105.78285518776923
curr_Factors:  [105.78285519]
mat_Sqrt:  [[0.15]]
grads:  [-0.05925161]
Stock Position:  -0.05925161058772238
Bond Position:  [45.18856904]


portfolio before change:  [38.86542809]
curr_Stock_Price:  106.90746530181046
curr_Factors:  [106.9074653]
mat_Sqrt:  [[0.15]]
grads:  [-0.21356119]
Stock Position:  -0.21356118995418136
Bond Position:  [61.6967136]


portfolio before change:  [38.84093937]
curr_Stock_Price:  107.09436644044148
curr_Factors:  [107.09436644]
mat_Sqrt:  [[0.15]]
grads:  [-0.11628028]
Stock Position:  -0.11628027517285747
Bond Position:  [51.29390177]


portfolio before change:  [38.66399158]
curr_Stock_Price:  108.72639618584991
curr_Factors:  [108.72639619]
mat_Sqrt:  [[0.15]]
grads:  [0.06430549]
Stock Position:  0.06430548936553045
Bond Position:  [31.67228746]


portfolio before change:  [38.71158123]
curr_Stock_Price:  109.34330455559878
curr_Factors:  [109.34330456]
mat_Sqrt:  [[0.15]]
grads:  [0.41213505]
Stock Position:  0.4121350456203762
Bond Position:  [-6.35262658]


portfolio before change:  [38.68163733]
curr_Stock_Price:  109.27450295972443
curr_Factors:  [109.27450296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01330056]
Stock Position:  -0.013300557985536181
Bond Position:  [40.13504919]


portfolio before change:  [38.69940401]
curr_Stock_Price:  108.6931991644027
curr_Factors:  [108.69319916]
mat_Sqrt:  [[0.15]]
grads:  [0.03721947]
Stock Position:  0.037219472458591044
Bond Position:  [34.65390048]


portfolio before change:  [38.62633243]
curr_Stock_Price:  106.4971405088397
curr_Factors:  [106.49714051]
mat_Sqrt:  [[0.15]]
grads:  [-0.03648358]
Stock Position:  -0.036483575687309075
Bond Position:  [42.51172891]


portfolio before change:  [38.63588207]
curr_Stock_Price:  106.52673238242078
curr_Factors:  [106.52673238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.63588207]
Stock Price:  104.38553140841324
PL:  [34.25035066]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.86957433e-03]
 [ 1.03349017e-02]
 [ 9.35901951e-04]
 [ 6.61145257e-03]
 [ 4.57991965e-03]
 [ 4.48219861e-03]
 [ 1.08445149e-02]
 [ 1.34249463e-02]
 [ 3.42486018e-03]
 [ 8.43927155e-03]
 [-1.64153518e-02]
 [-1.88421217e-03]
 [-1.59562659e-02]
 [ 3.63714428e-03]
 [-1.52886526e-02]
 [ 7.90012240e-03]
 [ 4.77381689e-03]
 [-1.87940557e-03]
 [-1.26933973e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.02009172]
curr_Stock_Price:  100.34064141111804
curr_Factors:  [100.34064141]
mat_Sqrt:  [[0.15]]
grads:  [0.0391305]
Stock Position:  0.03913049554275335
Bond Position:  [3.0937127]


portfolio before change:  [6.99297039]
curr_Stock_Price:  99.62777385870014
curr_Factors:  [99.62777386]
mat_Sqrt:  [[0.15]]
grads:  [0.06889934]
Stock Position:  0.06889934491961505
Bond Position:  [0.12868203]


portfolio before change:  [7.05998237]
curr_Stock_Price:  100.59991383300901
curr_Factors:  [100.59991383]
mat_Sqrt:  [[0.15]]
grads:  [0.00623935]
Stock Position:  0.006239346340169337
Bond Position:  [6.43230466]


portfolio before change:  [7.06074637]
curr_Stock_Price:  100.46459854975245
curr_Factors:  [100.46459855]
mat_Sqrt:  [[0.15]]
grads:  [0.04407635]
Stock Position:  0.04407635043774602
Bond Position:  [2.63263351]


portfolio before change:  [7.01983506]
curr_Stock_Price:  99.52147269934713
curr_Factors:  [99.5214727]
mat_Sqrt:  [[0.15]]
grads:  [0.0305328]
Stock Position:  0.030532797669646207
Bond Position:  [3.98116607]


portfolio before change:  [7.00833737]
curr_Stock_Price:  99.11230269431087
curr_Factors:  [99.11230269]
mat_Sqrt:  [[0.15]]
grads:  [0.02988132]
Stock Position:  0.029881324099548332
Bond Position:  [4.04673053]


portfolio before change:  [7.05284589]
curr_Stock_Price:  100.56795119942669
curr_Factors:  [100.5679512]
mat_Sqrt:  [[0.15]]
grads:  [0.07229677]
Stock Position:  0.07229676630139764
Bond Position:  [-0.21789178]


portfolio before change:  [7.06394641]
curr_Stock_Price:  100.72224583903406
curr_Factors:  [100.72224584]
mat_Sqrt:  [[0.15]]
grads:  [0.08949964]
Stock Position:  0.08949964223070898
Bond Position:  [-1.95065856]


portfolio before change:  [7.03614442]
curr_Stock_Price:  100.41705726444933
curr_Factors:  [100.41705726]
mat_Sqrt:  [[0.15]]
grads:  [0.0228324]
Stock Position:  0.02283240122243795
Bond Position:  [4.74338188]


portfolio before change:  [7.0351999]
curr_Stock_Price:  100.323746577384
curr_Factors:  [100.32374658]
mat_Sqrt:  [[0.15]]
grads:  [0.05626181]
Stock Position:  0.05626181035675073
Bond Position:  [1.3908043]


portfolio before change:  [7.06674085]
curr_Stock_Price:  100.87817594219867
curr_Factors:  [100.87817594]
mat_Sqrt:  [[0.15]]
grads:  [-0.10943568]
Stock Position:  -0.10943567878243736
Bond Position:  [18.10641251]


portfolio before change:  [7.11104942]
curr_Stock_Price:  100.51466190142327
curr_Factors:  [100.5146619]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256141]
Stock Position:  -0.012561414492537514
Bond Position:  [8.37365575]


portfolio before change:  [7.13595365]
curr_Stock_Price:  98.69873988648143
curr_Factors:  [98.69873989]
mat_Sqrt:  [[0.15]]
grads:  [-0.10637511]
Stock Position:  -0.10637510603433274
Bond Position:  [17.63504257]


portfolio before change:  [7.05100014]
curr_Stock_Price:  99.53881258287758
curr_Factors:  [99.53881258]
mat_Sqrt:  [[0.15]]
grads:  [0.02424763]
Stock Position:  0.024247628539785408
Bond Position:  [4.63741998]


portfolio before change:  [7.04060089]
curr_Stock_Price:  99.06211666766387
curr_Factors:  [99.06211667]
mat_Sqrt:  [[0.15]]
grads:  [-0.10192435]
Stock Position:  -0.1019243503887146
Bond Position:  [17.13744278]


portfolio before change:  [7.08843666]
curr_Stock_Price:  98.63483038268517
curr_Factors:  [98.63483038]
mat_Sqrt:  [[0.15]]
grads:  [0.05266748]
Stock Position:  0.0526674826904501
Bond Position:  [1.89358844]


portfolio before change:  [7.09444019]
curr_Stock_Price:  98.73983016688756
curr_Factors:  [98.73983017]
mat_Sqrt:  [[0.15]]
grads:  [0.03182545]
Stock Position:  0.03182544595710189
Bond Position:  [3.95200107]


portfolio before change:  [7.07997501]
curr_Stock_Price:  98.25426545788484
curr_Factors:  [98.25426546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01252937]
Stock Position:  -0.01252937046331808
Bond Position:  [8.3110391]


portfolio before change:  [7.08912786]
curr_Stock_Price:  97.6896052548494
curr_Factors:  [97.68960525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.08912786]
Stock Price:  98.41766730770725
PL:  [7.08912786]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.01683354e-03]
 [ 6.90398247e-03]
 [ 1.42493362e-03]
 [ 1.38978187e-02]
 [ 2.88647681e-03]
 [ 4.33414996e-03]
 [-2.18916372e-03]
 [ 1.25383958e-02]
 [ 2.94434216e-03]
 [ 9.39281849e-03]
 [-1.66111910e-02]
 [ 5.72780481e-03]
 [-1.42404376e-02]
 [ 6.34026365e-06]
 [-1.71124282e-02]
 [ 7.59202976e-03]
 [ 4.45106030e-03]
 [-1.71195942e-03]
 [-1.27644828e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.3228479]
curr_Stock_Price:  99.90616197752392
curr_Factors:  [99.90616198]
mat_Sqrt:  [[0.15]]
grads:  [0.01344556]
Stock Position:  0.01344555692606211
Bond Position:  [-1.02044609]


portfolio before change:  [0.33264724]
curr_Stock_Price:  100.65395452790969
curr_Factors:  [100.65395453]
mat_Sqrt:  [[0.15]]
grads:  [0.04602655]
Stock Position:  0.04602654983047158
Bond Position:  [-4.30010701]


portfolio before change:  [0.39305055]
curr_Stock_Price:  101.98967201118596
curr_Factors:  [101.98967201]
mat_Sqrt:  [[0.15]]
grads:  [0.00949956]
Stock Position:  0.009499557449745838
Bond Position:  [-0.5758062]


portfolio before change:  [0.38904183]
curr_Stock_Price:  101.58283723039811
curr_Factors:  [101.58283723]
mat_Sqrt:  [[0.15]]
grads:  [0.09265212]
Stock Position:  0.09265212436310732
Bond Position:  [-9.02282384]


portfolio before change:  [0.14920855]
curr_Stock_Price:  99.018651102678
curr_Factors:  [99.0186511]
mat_Sqrt:  [[0.15]]
grads:  [0.01924318]
Stock Position:  0.019243178745855016
Bond Position:  [-1.75622505]


portfolio before change:  [0.15362921]
curr_Stock_Price:  99.27119633558833
curr_Factors:  [99.27119634]
mat_Sqrt:  [[0.15]]
grads:  [0.02889433]
Stock Position:  0.028894333057598375
Bond Position:  [-2.7147458]


portfolio before change:  [0.18034725]
curr_Stock_Price:  100.21936891668054
curr_Factors:  [100.21936892]
mat_Sqrt:  [[0.15]]
grads:  [-0.01459442]
Stock Position:  -0.01459442478186172
Bond Position:  [1.6429913]


portfolio before change:  [0.18665551]
curr_Stock_Price:  99.81527942851645
curr_Factors:  [99.81527943]
mat_Sqrt:  [[0.15]]
grads:  [0.08358931]
Stock Position:  0.08358930545610736
Bond Position:  [-8.15683437]


portfolio before change:  [0.20214859]
curr_Stock_Price:  100.02502571864632
curr_Factors:  [100.02502572]
mat_Sqrt:  [[0.15]]
grads:  [0.01962895]
Stock Position:  0.01962894773284469
Bond Position:  [-1.76123741]


portfolio before change:  [0.19942901]
curr_Stock_Price:  99.90891062254165
curr_Factors:  [99.90891062]
mat_Sqrt:  [[0.15]]
grads:  [0.06261879]
Stock Position:  0.06261878995192535
Bond Position:  [-6.05674608]


portfolio before change:  [0.24725195]
curr_Stock_Price:  100.69681016586694
curr_Factors:  [100.69681017]
mat_Sqrt:  [[0.15]]
grads:  [-0.11074127]
Stock Position:  -0.11074127365195133
Bond Position:  [11.39854496]


portfolio before change:  [0.38155296]
curr_Stock_Price:  99.50979997303655
curr_Factors:  [99.50979997]
mat_Sqrt:  [[0.15]]
grads:  [0.03818537]
Stock Position:  0.038185365372639
Bond Position:  [-3.41826511]


portfolio before change:  [0.34168556]
curr_Stock_Price:  98.48813306776626
curr_Factors:  [98.48813307]
mat_Sqrt:  [[0.15]]
grads:  [-0.09493625]
Stock Position:  -0.09493625095932436
Bond Position:  [9.69177968]


portfolio before change:  [0.39275015]
curr_Stock_Price:  97.97577514358075
curr_Factors:  [97.97577514]
mat_Sqrt:  [[0.15]]
grads:  [4.22684244e-05]
Stock Position:  4.2268424358899694e-05
Bond Position:  [0.38860887]


portfolio before change:  [0.39282006]
curr_Stock_Price:  97.33081529515162
curr_Factors:  [97.3308153]
mat_Sqrt:  [[0.15]]
grads:  [-0.11408285]
Stock Position:  -0.11408285449836046
Bond Position:  [11.4965973]


portfolio before change:  [0.31180508]
curr_Stock_Price:  98.06615354578373
curr_Factors:  [98.06615355]
mat_Sqrt:  [[0.15]]
grads:  [0.05061353]
Stock Position:  0.050613531712759036
Bond Position:  [-4.65166929]


portfolio before change:  [0.31332264]
curr_Stock_Price:  98.11911624974591
curr_Factors:  [98.11911625]
mat_Sqrt:  [[0.15]]
grads:  [0.02967374]
Stock Position:  0.029673735319837663
Bond Position:  [-2.59823804]


portfolio before change:  [0.33314367]
curr_Stock_Price:  98.80897426669773
curr_Factors:  [98.80897427]
mat_Sqrt:  [[0.15]]
grads:  [-0.01141306]
Stock Position:  -0.011413062773322984
Bond Position:  [1.46085669]


portfolio before change:  [0.33445834]
curr_Stock_Price:  98.72578822449283
curr_Factors:  [98.72578822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.33445834]
Stock Price:  98.85876442574252
PL:  [0.33445834]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.22264125e-03]
 [ 7.25146227e-03]
 [ 8.01821430e-04]
 [ 2.96456208e-03]
 [ 2.92526656e-03]
 [ 4.18704326e-03]
 [-1.33457530e-02]
 [ 9.30544042e-03]
 [ 4.65137328e-03]
 [-1.39033694e-02]
 [-1.73261604e-02]
 [ 1.16221139e-02]
 [ 3.25595710e-02]
 [-5.72286735e-03]
 [-1.53082451e-02]
 [ 5.33362641e-03]
 [ 2.81999206e-04]
 [-7.64091231e-03]
 [-1.06693749e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.83882756]
curr_Stock_Price:  99.63617592920568
curr_Factors:  [99.63617593]
mat_Sqrt:  [[0.15]]
grads:  [0.01481761]
Stock Position:  0.014817608302334449
Bond Position:  [-5.31519738]


portfolio before change:  [-3.8259816]
curr_Stock_Price:  100.59280279295959
curr_Factors:  [100.59280279]
mat_Sqrt:  [[0.15]]
grads:  [0.04834308]
Stock Position:  0.0483430817906522
Bond Position:  [-8.68894769]


portfolio before change:  [-3.80119941]
curr_Stock_Price:  101.15037380700876
curr_Factors:  [101.15037381]
mat_Sqrt:  [[0.15]]
grads:  [0.00534548]
Stock Position:  0.005345476200326002
Bond Position:  [-4.34189632]


portfolio before change:  [-3.81204081]
curr_Stock_Price:  99.3253171259123
curr_Factors:  [99.32531713]
mat_Sqrt:  [[0.15]]
grads:  [0.01976375]
Stock Position:  0.01976374722362924
Bond Position:  [-5.77508127]


portfolio before change:  [-3.81926928]
curr_Stock_Price:  99.0326338944367
curr_Factors:  [99.03263389]
mat_Sqrt:  [[0.15]]
grads:  [0.01950178]
Stock Position:  0.019501777033579255
Bond Position:  [-5.75058163]


portfolio before change:  [-3.81393153]
curr_Stock_Price:  99.38006794364843
curr_Factors:  [99.38006794]
mat_Sqrt:  [[0.15]]
grads:  [0.02791362]
Stock Position:  0.027913621705223265
Bond Position:  [-6.58798915]


portfolio before change:  [-3.81144479]
curr_Stock_Price:  99.52816534626976
curr_Factors:  [99.52816535]
mat_Sqrt:  [[0.15]]
grads:  [-0.08897169]
Stock Position:  -0.08897168649680344
Bond Position:  [5.04374393]


portfolio before change:  [-3.66672357]
curr_Stock_Price:  97.91574085483492
curr_Factors:  [97.91574085]
mat_Sqrt:  [[0.15]]
grads:  [0.06203627]
Stock Position:  0.06203626943832509
Bond Position:  [-9.74105086]


portfolio before change:  [-3.73628989]
curr_Stock_Price:  96.83361983182282
curr_Factors:  [96.83361983]
mat_Sqrt:  [[0.15]]
grads:  [0.03100916]
Stock Position:  0.031009155224704408
Bond Position:  [-6.73901864]


portfolio before change:  [-3.78630622]
curr_Stock_Price:  95.27500392524452
curr_Factors:  [95.27500393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09268913]
Stock Position:  -0.09268912907164081
Bond Position:  [5.04465092]


portfolio before change:  [-3.66646867]
curr_Stock_Price:  93.9957144711611
curr_Factors:  [93.99571447]
mat_Sqrt:  [[0.15]]
grads:  [-0.11550774]
Stock Position:  -0.1155077357335371
Bond Position:  [7.19076347]


portfolio before change:  [-3.54110158]
curr_Stock_Price:  92.92592312323335
curr_Factors:  [92.92592312]
mat_Sqrt:  [[0.15]]
grads:  [0.07748076]
Stock Position:  0.0774807595961081
Bond Position:  [-10.74107269]


portfolio before change:  [-3.54826378]
curr_Stock_Price:  92.86814626747783
curr_Factors:  [92.86814627]
mat_Sqrt:  [[0.15]]
grads:  [0.21706381]
Stock Position:  0.21706380680382295
Bond Position:  [-23.70657714]


portfolio before change:  [-3.63557108]
curr_Stock_Price:  92.49323384621084
curr_Factors:  [92.49323385]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815245]
Stock Position:  -0.03815244899746898
Bond Position:  [-0.1067277]


portfolio before change:  [-3.59063766]
curr_Stock_Price:  91.31480079111631
curr_Factors:  [91.31480079]
mat_Sqrt:  [[0.15]]
grads:  [-0.10205497]
Stock Position:  -0.10205496714720609
Bond Position:  [5.72849133]


portfolio before change:  [-3.50031904]
curr_Stock_Price:  90.44383559904823
curr_Factors:  [90.4438356]
mat_Sqrt:  [[0.15]]
grads:  [0.03555751]
Stock Position:  0.03555750939947921
Bond Position:  [-6.71627657]


portfolio before change:  [-3.51210964]
curr_Stock_Price:  90.1594701024464
curr_Factors:  [90.1594701]
mat_Sqrt:  [[0.15]]
grads:  [0.00187999]
Stock Position:  0.0018799947097535366
Bond Position:  [-3.68160897]


portfolio before change:  [-3.51367082]
curr_Stock_Price:  89.81869449152792
curr_Factors:  [89.81869449]
mat_Sqrt:  [[0.15]]
grads:  [-0.05093942]
Stock Position:  -0.05093941538486741
Bond Position:  [1.06164097]


portfolio before change:  [-3.58159768]
curr_Stock_Price:  91.15738873543752
curr_Factors:  [91.15738874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.58159768]
Stock Price:  91.53641913980942
PL:  [-3.58159768]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.95265398e-03]
 [ 7.83821431e-03]
 [ 7.19785331e-04]
 [ 1.53621634e-02]
 [ 2.36989358e-02]
 [ 6.21146011e-03]
 [ 3.05900952e-02]
 [ 4.64978662e-03]
 [ 9.06282478e-03]
 [-1.68634619e-02]
 [-1.04653238e-02]
 [-1.83595867e-02]
 [-2.07715053e-02]
 [ 4.90210011e-03]
 [ 3.72906827e-02]
 [-6.15594440e-04]
 [ 6.55324582e-03]
 [-5.47010781e-03]
 [-1.06616826e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.75557596]
curr_Stock_Price:  100.64785293927842
curr_Factors:  [100.64785294]
mat_Sqrt:  [[0.15]]
grads:  [0.03968436]
Stock Position:  0.03968435986299194
Bond Position:  [7.76143034]


portfolio before change:  [11.69562462]
curr_Stock_Price:  99.08824757661802
curr_Factors:  [99.08824758]
mat_Sqrt:  [[0.15]]
grads:  [0.05225476]
Stock Position:  0.052254762082940616
Bond Position:  [6.51779182]


portfolio before change:  [11.79910429]
curr_Stock_Price:  101.03735268143971
curr_Factors:  [101.03735268]
mat_Sqrt:  [[0.15]]
grads:  [0.00479857]
Stock Position:  0.004798568871820925
Bond Position:  [11.3142696]


portfolio before change:  [11.81070014]
curr_Stock_Price:  102.8643404516969
curr_Factors:  [102.86434045]
mat_Sqrt:  [[0.15]]
grads:  [0.10241442]
Stock Position:  0.10241442264780706
Bond Position:  [1.2759081]


portfolio before change:  [11.92246957]
curr_Stock_Price:  103.9525701144622
curr_Factors:  [103.95257011]
mat_Sqrt:  [[0.15]]
grads:  [0.15799291]
Stock Position:  0.15799290505667285
Bond Position:  [-4.50129897]


portfolio before change:  [11.92939941]
curr_Stock_Price:  104.00355535145312
curr_Factors:  [104.00355535]
mat_Sqrt:  [[0.15]]
grads:  [0.04140973]
Stock Position:  0.04140973404473519
Bond Position:  [7.62263984]


portfolio before change:  [11.9330989]
curr_Stock_Price:  104.04686848326482
curr_Factors:  [104.04686848]
mat_Sqrt:  [[0.15]]
grads:  [0.20393397]
Stock Position:  0.20393396806155265
Bond Position:  [-9.28559186]


portfolio before change:  [11.6779111]
curr_Stock_Price:  102.80692738112984
curr_Factors:  [102.80692738]
mat_Sqrt:  [[0.15]]
grads:  [0.03099858]
Stock Position:  0.030998577459996908
Bond Position:  [8.4910426]


portfolio before change:  [11.72413706]
curr_Stock_Price:  104.2296678745919
curr_Factors:  [104.22966787]
mat_Sqrt:  [[0.15]]
grads:  [0.06041883]
Stock Position:  0.06041883186618607
Bond Position:  [5.42670228]


portfolio before change:  [11.77652604]
curr_Stock_Price:  105.07430757608749
curr_Factors:  [105.07430758]
mat_Sqrt:  [[0.15]]
grads:  [-0.11242308]
Stock Position:  -0.1124230790779445
Bond Position:  [23.58930323]


portfolio before change:  [11.81184327]
curr_Stock_Price:  104.81262496154676
curr_Factors:  [104.81262496]
mat_Sqrt:  [[0.15]]
grads:  [-0.06976883]
Stock Position:  -0.06976882545034256
Bond Position:  [19.12449701]


portfolio before change:  [11.83570005]
curr_Stock_Price:  104.53922125276439
curr_Factors:  [104.53922125]
mat_Sqrt:  [[0.15]]
grads:  [-0.12239724]
Stock Position:  -0.12239724460481784
Bond Position:  [24.63101268]


portfolio before change:  [11.9090133]
curr_Stock_Price:  103.99055920421227
curr_Factors:  [103.9905592]
mat_Sqrt:  [[0.15]]
grads:  [-0.1384767]
Stock Position:  -0.1384767022253243
Bond Position:  [26.309283]


portfolio before change:  [11.79184902]
curr_Stock_Price:  104.88415658202904
curr_Factors:  [104.88415658]
mat_Sqrt:  [[0.15]]
grads:  [0.03268067]
Stock Position:  0.032680667403904226
Bond Position:  [8.36416478]


portfolio before change:  [11.82755366]
curr_Stock_Price:  105.91269533946826
curr_Factors:  [105.91269534]
mat_Sqrt:  [[0.15]]
grads:  [0.24860455]
Stock Position:  0.24860455103049994
Bond Position:  [-14.50282442]


portfolio before change:  [12.04768995]
curr_Stock_Price:  106.8127691849593
curr_Factors:  [106.81276918]
mat_Sqrt:  [[0.15]]
grads:  [-0.00410396]
Stock Position:  -0.004103962934760286
Bond Position:  [12.4860456]


portfolio before change:  [12.0551527]
curr_Stock_Price:  105.75504957600387
curr_Factors:  [105.75504958]
mat_Sqrt:  [[0.15]]
grads:  [0.04368831]
Stock Position:  0.04368830548308313
Bond Position:  [7.43489378]


portfolio before change:  [12.08723982]
curr_Stock_Price:  106.44695477754689
curr_Factors:  [106.44695478]
mat_Sqrt:  [[0.15]]
grads:  [-0.03646739]
Stock Position:  -0.03646738537811929
Bond Position:  [15.96908194]


portfolio before change:  [12.14203506]
curr_Stock_Price:  105.05386136940591
curr_Factors:  [105.05386137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.14203506]
Stock Price:  105.66265029403361
PL:  [6.47938477]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.30071607e-02]
 [ 2.72090447e-03]
 [-4.71197689e-03]
 [-2.68169944e-03]
 [-1.15246390e-02]
 [-2.39090418e-03]
 [ 4.44302938e-03]
 [-4.98641389e-03]
 [ 4.36257595e-03]
 [-3.15047526e-02]
 [-1.76325693e-02]
 [ 1.15127297e-02]
 [ 1.02566528e-02]
 [-2.76657896e-03]
 [-1.69400633e-02]
 [ 6.62797997e-03]
 [ 3.62501849e-03]
 [-1.91418027e-03]
 [-1.27522146e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.68103759]
curr_Stock_Price:  99.12741754063943
curr_Factors:  [99.12741754]
mat_Sqrt:  [[0.15]]
grads:  [0.0867144]
Stock Position:  0.0867144047227333
Bond Position:  [-20.2768126]


portfolio before change:  [-11.77439846]
curr_Stock_Price:  98.10923568330179
curr_Factors:  [98.10923568]
mat_Sqrt:  [[0.15]]
grads:  [0.01813936]
Stock Position:  0.01813936316370281
Bond Position:  [-13.55403752]


portfolio before change:  [-11.81363472]
curr_Stock_Price:  96.13301831273867
curr_Factors:  [96.13301831]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141318]
Stock Position:  -0.03141317925665872
Bond Position:  [-8.79379099]


portfolio before change:  [-11.80765732]
curr_Stock_Price:  95.87274141871836
curr_Factors:  [95.87274142]
mat_Sqrt:  [[0.15]]
grads:  [-0.017878]
Stock Position:  -0.01787799626995705
Bond Position:  [-10.09364481]


portfolio before change:  [-11.79701657]
curr_Stock_Price:  95.13639039738675
curr_Factors:  [95.1363904]
mat_Sqrt:  [[0.15]]
grads:  [-0.07683093]
Stock Position:  -0.07683092674109838
Bond Position:  [-4.48759952]


portfolio before change:  [-11.83314309]
curr_Stock_Price:  95.59199451946778
curr_Factors:  [95.59199452]
mat_Sqrt:  [[0.15]]
grads:  [-0.01593936]
Stock Position:  -0.015939361170582134
Bond Position:  [-10.30946777]


portfolio before change:  [-11.81351135]
curr_Stock_Price:  94.19862441255636
curr_Factors:  [94.19862441]
mat_Sqrt:  [[0.15]]
grads:  [0.0296202]
Stock Position:  0.029620195859330716
Bond Position:  [-14.60369306]


portfolio before change:  [-11.81920026]
curr_Stock_Price:  94.12983600175006
curr_Factors:  [94.129836]
mat_Sqrt:  [[0.15]]
grads:  [-0.03324276]
Stock Position:  -0.033242759238312956
Bond Position:  [-8.69006478]


portfolio before change:  [-11.78411943]
curr_Stock_Price:  93.0091825737393
curr_Factors:  [93.00918257]
mat_Sqrt:  [[0.15]]
grads:  [0.02908384]
Stock Position:  0.02908383967980341
Bond Position:  [-14.48918359]


portfolio before change:  [-11.79079342]
curr_Stock_Price:  92.90427077801432
curr_Factors:  [92.90427078]
mat_Sqrt:  [[0.15]]
grads:  [-0.21003168]
Stock Position:  -0.21003168432277255
Bond Position:  [7.72204705]


portfolio before change:  [-11.66872304]
curr_Stock_Price:  92.3322636272327
curr_Factors:  [92.33226363]
mat_Sqrt:  [[0.15]]
grads:  [-0.11755046]
Stock Position:  -0.1175504620375975
Bond Position:  [-0.81502279]


portfolio before change:  [-11.7467106]
curr_Stock_Price:  92.99396904837644
curr_Factors:  [92.99396905]
mat_Sqrt:  [[0.15]]
grads:  [0.07675153]
Stock Position:  0.07675153123371925
Bond Position:  [-18.88414012]


portfolio before change:  [-11.55039817]
curr_Stock_Price:  95.61325299147352
curr_Factors:  [95.61325299]
mat_Sqrt:  [[0.15]]
grads:  [0.06837769]
Stock Position:  0.06837768540522415
Bond Position:  [-18.08821111]


portfolio before change:  [-11.54491436]
curr_Stock_Price:  95.75959355282511
curr_Factors:  [95.75959355]
mat_Sqrt:  [[0.15]]
grads:  [-0.01844386]
Stock Position:  -0.018443859742678505
Bond Position:  [-9.77873785]


portfolio before change:  [-11.56872073]
curr_Stock_Price:  96.91777738580653
curr_Factors:  [96.91777739]
mat_Sqrt:  [[0.15]]
grads:  [-0.11293376]
Stock Position:  -0.11293375551490326
Bond Position:  [-0.62343216]


portfolio before change:  [-11.45811194]
curr_Stock_Price:  95.93698407777129
curr_Factors:  [95.93698408]
mat_Sqrt:  [[0.15]]
grads:  [0.04418653]
Stock Position:  0.04418653312225431
Bond Position:  [-15.69723466]


portfolio before change:  [-11.44512558]
curr_Stock_Price:  96.31970608455784
curr_Factors:  [96.31970608]
mat_Sqrt:  [[0.15]]
grads:  [0.02416679]
Stock Position:  0.02416678993126586
Bond Position:  [-13.77286368]


portfolio before change:  [-11.40525557]
curr_Stock_Price:  98.11198632295546
curr_Factors:  [98.11198632]
mat_Sqrt:  [[0.15]]
grads:  [-0.0127612]
Stock Position:  -0.012761201799811448
Bond Position:  [-10.15322871]


portfolio before change:  [-11.41438474]
curr_Stock_Price:  98.62843836379145
curr_Factors:  [98.62843836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.41438474]
Stock Price:  98.83934515632262
PL:  [-11.41438474]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.01964944e-03]
 [ 1.01175754e-02]
 [ 1.45675096e-03]
 [ 3.35321274e-03]
 [ 1.64397172e-02]
 [ 5.35867507e-03]
 [ 3.59363929e-02]
 [ 1.09940076e-02]
 [ 4.74417355e-03]
 [ 5.82984972e-03]
 [-1.67462709e-02]
 [ 1.21627975e-03]
 [-2.10738214e-02]
 [ 6.62765789e-05]
 [-1.67257480e-02]
 [ 7.79419341e-03]
 [ 4.05894719e-03]
 [-2.03697500e-03]
 [-1.26274625e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.32691526]
curr_Stock_Price:  100.49029512073709
curr_Factors:  [100.49029512]
mat_Sqrt:  [[0.15]]
grads:  [0.040131]
Stock Position:  0.040130996233879265
Bond Position:  [5.2941396]


portfolio before change:  [9.29007064]
curr_Stock_Price:  99.5392020654691
curr_Factors:  [99.53920207]
mat_Sqrt:  [[0.15]]
grads:  [0.0674505]
Stock Position:  0.06745050277229962
Bond Position:  [2.57610142]


portfolio before change:  [9.29936114]
curr_Stock_Price:  99.66739066862718
curr_Factors:  [99.66739067]
mat_Sqrt:  [[0.15]]
grads:  [0.00971167]
Stock Position:  0.009711673091696276
Bond Position:  [8.33142402]


portfolio before change:  [9.30141507]
curr_Stock_Price:  99.66438550400001
curr_Factors:  [99.6643855]
mat_Sqrt:  [[0.15]]
grads:  [0.02235475]
Stock Position:  0.02235475159831187
Bond Position:  [7.07344249]


portfolio before change:  [9.32841818]
curr_Stock_Price:  100.79320711362773
curr_Factors:  [100.79320711]
mat_Sqrt:  [[0.15]]
grads:  [0.10959811]
Stock Position:  0.10959811459669594
Bond Position:  [-1.71832729]


portfolio before change:  [9.35849236]
curr_Stock_Price:  101.07153146197294
curr_Factors:  [101.07153146]
mat_Sqrt:  [[0.15]]
grads:  [0.0357245]
Stock Position:  0.03572450048742697
Bond Position:  [5.74776239]


portfolio before change:  [9.41716851]
curr_Stock_Price:  102.6737658761201
curr_Factors:  [102.67376588]
mat_Sqrt:  [[0.15]]
grads:  [0.23957595]
Stock Position:  0.239575952555635
Bond Position:  [-15.18099675]


portfolio before change:  [9.170151]
curr_Stock_Price:  101.6585480264006
curr_Factors:  [101.65854803]
mat_Sqrt:  [[0.15]]
grads:  [0.07329338]
Stock Position:  0.07329338417609757
Bond Position:  [1.71925199]


portfolio before change:  [9.17604433]
curr_Stock_Price:  101.73309039907636
curr_Factors:  [101.7330904]
mat_Sqrt:  [[0.15]]
grads:  [0.03162782]
Stock Position:  0.03162782367452359
Bond Position:  [5.95844809]


portfolio before change:  [9.18894111]
curr_Stock_Price:  102.09375312227533
curr_Factors:  [102.09375312]
mat_Sqrt:  [[0.15]]
grads:  [0.03886566]
Stock Position:  0.03886566480685962
Bond Position:  [5.22099952]


portfolio before change:  [9.12993372]
curr_Stock_Price:  100.54192593584217
curr_Factors:  [100.54192594]
mat_Sqrt:  [[0.15]]
grads:  [-0.11164181]
Stock Position:  -0.11164180572376571
Bond Position:  [20.35461589]


portfolio before change:  [9.16951309]
curr_Stock_Price:  100.23299083358492
curr_Factors:  [100.23299083]
mat_Sqrt:  [[0.15]]
grads:  [0.00810853]
Stock Position:  0.008108531638502923
Bond Position:  [8.35677071]


portfolio before change:  [9.16425537]
curr_Stock_Price:  99.32688671385738
curr_Factors:  [99.32688671]
mat_Sqrt:  [[0.15]]
grads:  [-0.14049214]
Stock Position:  -0.14049214254822265
Bond Position:  [23.11890249]


portfolio before change:  [9.35661596]
curr_Stock_Price:  97.99883987112877
curr_Factors:  [97.99883987]
mat_Sqrt:  [[0.15]]
grads:  [0.00044184]
Stock Position:  0.0004418438593749752
Bond Position:  [9.31331577]


portfolio before change:  [9.35899822]
curr_Stock_Price:  98.12023335792293
curr_Factors:  [98.12023336]
mat_Sqrt:  [[0.15]]
grads:  [-0.11150499]
Stock Position:  -0.11150498698719563
Bond Position:  [20.29989356]


portfolio before change:  [9.34179513]
curr_Stock_Price:  98.32003333148933
curr_Factors:  [98.32003333]
mat_Sqrt:  [[0.15]]
grads:  [0.05196129]
Stock Position:  0.05196128942631413
Bond Position:  [4.23295942]


portfolio before change:  [9.28046256]
curr_Stock_Price:  97.11931355898714
curr_Factors:  [97.11931356]
mat_Sqrt:  [[0.15]]
grads:  [0.02705965]
Stock Position:  0.027059647947086353
Bond Position:  [6.65244812]


portfolio before change:  [9.29390061]
curr_Stock_Price:  97.55445333383975
curr_Factors:  [97.55445333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01357983]
Stock Position:  -0.013579833350534554
Bond Position:  [10.61867382]


portfolio before change:  [9.30860505]
curr_Stock_Price:  96.66714914976434
curr_Factors:  [96.66714915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.30860505]
Stock Price:  97.44806393344726
PL:  [9.30860505]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.40766217e-02]
 [ 7.38492859e-03]
 [ 1.53717685e-03]
 [ 1.58435420e-02]
 [ 2.34206768e-02]
 [ 5.89678426e-03]
 [ 2.65485226e-02]
 [-1.01556298e-03]
 [ 9.46250244e-03]
 [-2.50851681e-02]
 [-1.04384006e-02]
 [-9.69850443e-03]
 [-2.09397116e-02]
 [ 3.44553562e-03]
 [ 2.34440385e-02]
 [ 2.19133690e-03]
 [ 6.78883990e-03]
 [-5.20949609e-03]
 [-1.17935087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.86613468]
curr_Stock_Price:  102.08226137381762
curr_Factors:  [102.08226137]
mat_Sqrt:  [[0.15]]
grads:  [0.16051081]
Stock Position:  0.16051081155460858
Bond Position:  [17.48082806]


portfolio before change:  [34.05432545]
curr_Stock_Price:  103.22748028959191
curr_Factors:  [103.22748029]
mat_Sqrt:  [[0.15]]
grads:  [0.04923286]
Stock Position:  0.0492328572807419
Bond Position:  [28.97214164]


portfolio before change:  [34.01139975]
curr_Stock_Price:  102.20845263765312
curr_Factors:  [102.20845264]
mat_Sqrt:  [[0.15]]
grads:  [0.01024785]
Stock Position:  0.01024784568586561
Bond Position:  [32.9639833]


portfolio before change:  [34.03014511]
curr_Stock_Price:  103.23338391209813
curr_Factors:  [103.23338391]
mat_Sqrt:  [[0.15]]
grads:  [0.10562361]
Stock Position:  0.10562361339479137
Bond Position:  [23.12626208]


portfolio before change:  [34.13445803]
curr_Stock_Price:  104.16623057684876
curr_Factors:  [104.16623058]
mat_Sqrt:  [[0.15]]
grads:  [0.15613785]
Stock Position:  0.15613784508454912
Bond Position:  [17.87016726]


portfolio before change:  [34.24515474]
curr_Stock_Price:  104.84658200383379
curr_Factors:  [104.846582]
mat_Sqrt:  [[0.15]]
grads:  [0.0393119]
Stock Position:  0.03931189509590758
Bond Position:  [30.12343691]


portfolio before change:  [34.26884949]
curr_Stock_Price:  105.2577285734141
curr_Factors:  [105.25772857]
mat_Sqrt:  [[0.15]]
grads:  [0.17699015]
Stock Position:  0.17699015063045676
Bond Position:  [15.63926826]


portfolio before change:  [34.05290318]
curr_Stock_Price:  104.01553168991742
curr_Factors:  [104.01553169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677042]
Stock Position:  -0.0067704198750321905
Bond Position:  [34.75713201]


portfolio before change:  [34.05696217]
curr_Stock_Price:  104.69959347895501
curr_Factors:  [104.69959348]
mat_Sqrt:  [[0.15]]
grads:  [0.06308335]
Stock Position:  0.06308334962009389
Bond Position:  [27.45216111]


portfolio before change:  [34.15152281]
curr_Stock_Price:  106.08976609620177
curr_Factors:  [106.0897661]
mat_Sqrt:  [[0.15]]
grads:  [-0.16723445]
Stock Position:  -0.16723445421659944
Bond Position:  [51.89338694]


portfolio before change:  [34.3753107]
curr_Stock_Price:  104.8291830579546
curr_Factors:  [104.82918306]
mat_Sqrt:  [[0.15]]
grads:  [-0.06958934]
Stock Position:  -0.06958933706404989
Bond Position:  [41.67030405]


portfolio before change:  [34.51185445]
curr_Stock_Price:  103.01676630804823
curr_Factors:  [103.01676631]
mat_Sqrt:  [[0.15]]
grads:  [-0.0646567]
Stock Position:  -0.06465669622878932
Bond Position:  [41.17257822]


portfolio before change:  [34.47280503]
curr_Stock_Price:  103.77993329870301
curr_Factors:  [103.7799333]
mat_Sqrt:  [[0.15]]
grads:  [-0.13959808]
Stock Position:  -0.13959807726965393
Bond Position:  [48.96028418]


portfolio before change:  [34.54833655]
curr_Stock_Price:  103.32656085336254
curr_Factors:  [103.32656085]
mat_Sqrt:  [[0.15]]
grads:  [0.02297024]
Stock Position:  0.022970237456705966
Bond Position:  [32.17490091]


portfolio before change:  [34.57112537]
curr_Stock_Price:  103.96843866498776
curr_Factors:  [103.96843866]
mat_Sqrt:  [[0.15]]
grads:  [0.15629359]
Stock Position:  0.1562935902611149
Bond Position:  [18.32152482]


portfolio before change:  [34.48771097]
curr_Stock_Price:  103.40542549944868
curr_Factors:  [103.4054255]
mat_Sqrt:  [[0.15]]
grads:  [0.01460891]
Stock Position:  0.01460891268230228
Bond Position:  [32.97707014]


portfolio before change:  [34.51986001]
curr_Stock_Price:  105.0416693546358
curr_Factors:  [105.04166935]
mat_Sqrt:  [[0.15]]
grads:  [0.04525893]
Stock Position:  0.04525893264013
Bond Position:  [29.76578618]


portfolio before change:  [34.4880844]
curr_Stock_Price:  104.17514451467241
curr_Factors:  [104.17514451]
mat_Sqrt:  [[0.15]]
grads:  [-0.03472997]
Stock Position:  -0.03472997394910264
Bond Position:  [38.10608446]


portfolio before change:  [34.55078013]
curr_Stock_Price:  102.6442474535322
curr_Factors:  [102.64424745]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.55078013]
Stock Price:  104.1611642674457
PL:  [30.38961586]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.37113407e-02]
 [ 7.45828750e-03]
 [ 2.43890114e-03]
 [ 1.79636294e-02]
 [ 2.22638424e-02]
 [ 5.64243508e-03]
 [ 2.31557013e-02]
 [-1.25520377e-02]
 [ 1.07283452e-02]
 [-1.76355566e-02]
 [-9.75636858e-03]
 [-1.45123004e-02]
 [-1.91681519e-02]
 [ 5.92172182e-03]
 [ 3.28969615e-02]
 [ 1.04605437e-03]
 [ 7.25438434e-03]
 [-5.03169204e-03]
 [-1.22469276e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [56.61069859]
curr_Stock_Price:  103.5578004919516
curr_Factors:  [103.55780049]
mat_Sqrt:  [[0.15]]
grads:  [0.29140894]
Stock Position:  0.29140893808202634
Bond Position:  [26.43302992]


portfolio before change:  [56.55074257]
curr_Stock_Price:  103.32937544017453
curr_Factors:  [103.32937544]
mat_Sqrt:  [[0.15]]
grads:  [0.04972192]
Stock Position:  0.04972191669855961
Bond Position:  [51.41300797]


portfolio before change:  [56.59237343]
curr_Stock_Price:  103.90811421446132
curr_Factors:  [103.90811421]
mat_Sqrt:  [[0.15]]
grads:  [0.01625934]
Stock Position:  0.016259340907335117
Bond Position:  [54.90289598]


portfolio before change:  [56.62612283]
curr_Stock_Price:  105.13952736659368
curr_Factors:  [105.13952737]
mat_Sqrt:  [[0.15]]
grads:  [0.11975753]
Stock Position:  0.11975752949337184
Bond Position:  [44.03487279]


portfolio before change:  [56.648566]
curr_Stock_Price:  105.2349958367755
curr_Factors:  [105.23499584]
mat_Sqrt:  [[0.15]]
grads:  [0.14842562]
Stock Position:  0.14842561618540828
Bond Position:  [41.0289969]


portfolio before change:  [56.70231261]
curr_Stock_Price:  105.52799161408204
curr_Factors:  [105.52799161]
mat_Sqrt:  [[0.15]]
grads:  [0.03761623]
Stock Position:  0.03761623385382547
Bond Position:  [52.732747]


portfolio before change:  [56.74356782]
curr_Stock_Price:  106.27422197824606
curr_Factors:  [106.27422198]
mat_Sqrt:  [[0.15]]
grads:  [0.15437134]
Stock Position:  0.15437134194849836
Bond Position:  [40.33787356]


portfolio before change:  [56.79169873]
curr_Stock_Price:  106.52067432527244
curr_Factors:  [106.52067433]
mat_Sqrt:  [[0.15]]
grads:  [-0.08368025]
Stock Position:  -0.08368025146949655
Bond Position:  [65.70537554]


portfolio before change:  [56.83597187]
curr_Stock_Price:  106.18792261985456
curr_Factors:  [106.18792262]
mat_Sqrt:  [[0.15]]
grads:  [0.0715223]
Stock Position:  0.07152230119618339
Bond Position:  [49.24116729]


portfolio before change:  [56.77545583]
curr_Stock_Price:  105.16966857836385
curr_Factors:  [105.16966858]
mat_Sqrt:  [[0.15]]
grads:  [-0.11757038]
Stock Position:  -0.11757037713673646
Bond Position:  [69.14029343]


portfolio before change:  [56.78345835]
curr_Stock_Price:  105.24864014494118
curr_Factors:  [105.24864014]
mat_Sqrt:  [[0.15]]
grads:  [-0.06504246]
Stock Position:  -0.06504245716868454
Bond Position:  [63.62908851]


portfolio before change:  [56.88884742]
curr_Stock_Price:  103.87292619185237
curr_Factors:  [103.87292619]
mat_Sqrt:  [[0.15]]
grads:  [-0.09674867]
Stock Position:  -0.09674866900974777
Bond Position:  [66.93841478]


portfolio before change:  [56.69975357]
curr_Stock_Price:  106.00040303156705
curr_Factors:  [106.00040303]
mat_Sqrt:  [[0.15]]
grads:  [-0.12778768]
Stock Position:  -0.12778767934237067
Bond Position:  [70.24529908]


portfolio before change:  [56.75146559]
curr_Stock_Price:  105.73317459199089
curr_Factors:  [105.73317459]
mat_Sqrt:  [[0.15]]
grads:  [0.03947815]
Stock Position:  0.03947814544657694
Bond Position:  [52.57731594]


portfolio before change:  [56.74736784]
curr_Stock_Price:  105.29638302182957
curr_Factors:  [105.29638302]
mat_Sqrt:  [[0.15]]
grads:  [0.21931308]
Stock Position:  0.21931307673456757
Bond Position:  [33.65449411]


portfolio before change:  [56.64597353]
curr_Stock_Price:  104.79568793000999
curr_Factors:  [104.79568793]
mat_Sqrt:  [[0.15]]
grads:  [0.0069737]
Stock Position:  0.006973695827366805
Bond Position:  [55.91516028]


portfolio before change:  [56.65183885]
curr_Stock_Price:  103.63199806776507
curr_Factors:  [103.63199807]
mat_Sqrt:  [[0.15]]
grads:  [0.04836256]
Stock Position:  0.04836256228859763
Bond Position:  [51.63992989]


portfolio before change:  [56.6370668]
curr_Stock_Price:  103.05957902018082
curr_Factors:  [103.05957902]
mat_Sqrt:  [[0.15]]
grads:  [-0.03354461]
Stock Position:  -0.033544613614166975
Bond Position:  [60.09416055]


portfolio before change:  [56.70189536]
curr_Stock_Price:  101.57489513472119
curr_Factors:  [101.57489513]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [56.70189536]
Stock Price:  102.67444466883379
PL:  [54.02745069]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.59934930e-03]
 [ 6.59594478e-03]
 [ 1.45618605e-03]
 [ 3.23543340e-03]
 [ 8.29405089e-03]
 [ 6.51871764e-03]
 [ 2.95417963e-02]
 [ 1.31298237e-02]
 [ 4.24764573e-03]
 [ 8.45016339e-03]
 [-1.48227949e-02]
 [-7.77770074e-03]
 [-2.42928472e-02]
 [ 2.53538517e-03]
 [ 1.93208110e-02]
 [ 1.95671597e-03]
 [ 7.22654556e-03]
 [-4.88500755e-03]
 [-1.18959854e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.69260182]
curr_Stock_Price:  99.51591350272643
curr_Factors:  [99.5159135]
mat_Sqrt:  [[0.15]]
grads:  [0.03066233]
Stock Position:  0.030662328664451205
Bond Position:  [-8.74399147]


portfolio before change:  [-5.71543169]
curr_Stock_Price:  98.84265747228253
curr_Factors:  [98.84265747]
mat_Sqrt:  [[0.15]]
grads:  [0.04397297]
Stock Position:  0.043972965168965185
Bond Position:  [-10.06183642]


portfolio before change:  [-5.68181134]
curr_Stock_Price:  99.66443794239036
curr_Factors:  [99.66443794]
mat_Sqrt:  [[0.15]]
grads:  [0.00970791]
Stock Position:  0.009707906981977325
Bond Position:  [-6.64934443]


portfolio before change:  [-5.68161027]
curr_Stock_Price:  99.85640633380409
curr_Factors:  [99.85640633]
mat_Sqrt:  [[0.15]]
grads:  [0.02156956]
Stock Position:  0.02156955603020521
Bond Position:  [-7.83546862]


portfolio before change:  [-5.67882788]
curr_Stock_Price:  100.07623024398896
curr_Factors:  [100.07623024]
mat_Sqrt:  [[0.15]]
grads:  [0.05529367]
Stock Position:  0.05529367260196276
Bond Position:  [-11.21241019]


portfolio before change:  [-5.60766962]
curr_Stock_Price:  101.41384650723971
curr_Factors:  [101.41384651]
mat_Sqrt:  [[0.15]]
grads:  [0.04345812]
Stock Position:  0.043458117620793
Bond Position:  [-10.01492449]


portfolio before change:  [-5.60037589]
curr_Stock_Price:  101.63929972604997
curr_Factors:  [101.63929973]
mat_Sqrt:  [[0.15]]
grads:  [0.19694531]
Stock Position:  0.19694530842946073
Bond Position:  [-25.61775912]


portfolio before change:  [-5.70689164]
curr_Stock_Price:  101.13098341060989
curr_Factors:  [101.13098341]
mat_Sqrt:  [[0.15]]
grads:  [0.08753216]
Stock Position:  0.08753215832755164
Bond Position:  [-14.5591049]


portfolio before change:  [-5.7048945]
curr_Stock_Price:  101.19538682532243
curr_Factors:  [101.19538683]
mat_Sqrt:  [[0.15]]
grads:  [0.02831764]
Stock Position:  0.028317638176456914
Bond Position:  [-8.57050885]


portfolio before change:  [-5.72145289]
curr_Stock_Price:  100.68632287415338
curr_Factors:  [100.68632287]
mat_Sqrt:  [[0.15]]
grads:  [0.05633442]
Stock Position:  0.05633442261786752
Bond Position:  [-11.39355875]


portfolio before change:  [-5.64482048]
curr_Stock_Price:  102.09720367318269
curr_Factors:  [102.09720367]
mat_Sqrt:  [[0.15]]
grads:  [-0.09881863]
Stock Position:  -0.0988186323371907
Bond Position:  [4.44428555]


portfolio before change:  [-5.63941216]
curr_Stock_Price:  102.05371881769999
curr_Factors:  [102.05371882]
mat_Sqrt:  [[0.15]]
grads:  [-0.05185134]
Stock Position:  -0.05185133824462494
Bond Position:  [-0.34779026]


portfolio before change:  [-5.60563744]
curr_Stock_Price:  101.40066571544456
curr_Factors:  [101.40066572]
mat_Sqrt:  [[0.15]]
grads:  [-0.16195231]
Stock Position:  -0.1619523146362595
Bond Position:  [10.81643508]


portfolio before change:  [-5.74579733]
curr_Stock_Price:  102.28280400834102
curr_Factors:  [102.28280401]
mat_Sqrt:  [[0.15]]
grads:  [0.01690257]
Stock Position:  0.01690256781520089
Bond Position:  [-7.47463936]


portfolio before change:  [-5.72896514]
curr_Stock_Price:  103.38920864267229
curr_Factors:  [103.38920864]
mat_Sqrt:  [[0.15]]
grads:  [0.12880541]
Stock Position:  0.12880540646165173
Bond Position:  [-19.04605418]


portfolio before change:  [-5.69495373]
curr_Stock_Price:  103.69023265889602
curr_Factors:  [103.69023266]
mat_Sqrt:  [[0.15]]
grads:  [0.01304477]
Stock Position:  0.01304477315265917
Bond Position:  [-7.04756929]


portfolio before change:  [-5.69637588]
curr_Stock_Price:  103.71629406718692
curr_Factors:  [103.71629407]
mat_Sqrt:  [[0.15]]
grads:  [0.04817697]
Stock Position:  0.04817697039530337
Bond Position:  [-10.69311271]


portfolio before change:  [-5.74310287]
curr_Stock_Price:  102.80188663593434
curr_Factors:  [102.80188664]
mat_Sqrt:  [[0.15]]
grads:  [-0.03256672]
Stock Position:  -0.03256671699281333
Bond Position:  [-2.39518292]


portfolio before change:  [-5.72921244]
curr_Stock_Price:  102.35697541971142
curr_Factors:  [102.35697542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.72921244]
Stock Price:  101.20881217158517
PL:  [-6.93802461]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.11638926e-02]
 [ 6.12989238e-03]
 [ 1.38201941e-03]
 [ 1.48357291e-02]
 [ 2.50879702e-02]
 [ 3.21662053e-03]
 [-1.04810894e-02]
 [ 1.24682689e-02]
 [ 3.30505518e-03]
 [ 9.39203007e-03]
 [-1.85385017e-02]
 [-1.21577274e-04]
 [-1.57928069e-02]
 [-9.46054171e-04]
 [-1.62652974e-02]
 [ 7.53353216e-03]
 [ 3.63829858e-03]
 [-2.86198146e-03]
 [-1.21438705e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.90822293]
curr_Stock_Price:  101.11187636235223
curr_Factors:  [101.11187636]
mat_Sqrt:  [[0.15]]
grads:  [0.07442595]
Stock Position:  0.07442595046889029
Bond Position:  [11.38287543]


portfolio before change:  [18.93878263]
curr_Stock_Price:  101.48424147489878
curr_Factors:  [101.48424147]
mat_Sqrt:  [[0.15]]
grads:  [0.04086595]
Stock Position:  0.04086594918986068
Bond Position:  [14.79153278]


portfolio before change:  [18.96057722]
curr_Stock_Price:  101.9270611069865
curr_Factors:  [101.92706111]
mat_Sqrt:  [[0.15]]
grads:  [0.00921346]
Stock Position:  0.009213462717467057
Bond Position:  [18.02147604]


portfolio before change:  [18.97000033]
curr_Stock_Price:  102.46075559069632
curr_Factors:  [102.46075559]
mat_Sqrt:  [[0.15]]
grads:  [0.09890486]
Stock Position:  0.09890486092806318
Bond Position:  [8.83613355]


portfolio before change:  [18.92643305]
curr_Stock_Price:  101.99792104766205
curr_Factors:  [101.99792105]
mat_Sqrt:  [[0.15]]
grads:  [0.16725313]
Stock Position:  0.1672531344289446
Bond Position:  [1.86696105]


portfolio before change:  [18.63016361]
curr_Stock_Price:  100.22374656664086
curr_Factors:  [100.22374657]
mat_Sqrt:  [[0.15]]
grads:  [0.02144414]
Stock Position:  0.021444136840917435
Bond Position:  [16.48095187]


portfolio before change:  [18.60081176]
curr_Stock_Price:  98.66282559982719
curr_Factors:  [98.6628256]
mat_Sqrt:  [[0.15]]
grads:  [-0.06987393]
Stock Position:  -0.0698739291865437
Bond Position:  [25.49477105]


portfolio before change:  [18.58343563]
curr_Stock_Price:  99.00273230846308
curr_Factors:  [99.00273231]
mat_Sqrt:  [[0.15]]
grads:  [0.08312179]
Stock Position:  0.0831217923654891
Bond Position:  [10.35415107]


portfolio before change:  [18.61437928]
curr_Stock_Price:  99.34385574083984
curr_Factors:  [99.34385574]
mat_Sqrt:  [[0.15]]
grads:  [0.0220337]
Stock Position:  0.022033701222302464
Bond Position:  [16.42546645]


portfolio before change:  [18.63094392]
curr_Stock_Price:  99.9092512335265
curr_Factors:  [99.90925123]
mat_Sqrt:  [[0.15]]
grads:  [0.06261353]
Stock Position:  0.06261353382767895
Bond Position:  [12.37527263]


portfolio before change:  [18.56363554]
curr_Stock_Price:  98.78485252058401
curr_Factors:  [98.78485252]
mat_Sqrt:  [[0.15]]
grads:  [-0.12359001]
Stock Position:  -0.12359001139555337
Bond Position:  [30.77245659]


portfolio before change:  [18.37920683]
curr_Stock_Price:  100.33936961985056
curr_Factors:  [100.33936962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081052]
Stock Position:  -0.0008105151619812008
Bond Position:  [18.46053342]


portfolio before change:  [18.38516856]
curr_Stock_Price:  98.67867635025996
curr_Factors:  [98.67867635]
mat_Sqrt:  [[0.15]]
grads:  [-0.10528538]
Stock Position:  -0.1052853792888756
Bond Position:  [28.77459043]


portfolio before change:  [18.50878417]
curr_Stock_Price:  97.57290969767875
curr_Factors:  [97.5729097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00630703]
Stock Position:  -0.006307027806431626
Bond Position:  [19.12417922]


portfolio before change:  [18.50744712]
curr_Stock_Price:  98.54304921908883
curr_Factors:  [98.54304922]
mat_Sqrt:  [[0.15]]
grads:  [-0.10843532]
Stock Position:  -0.1084353156970562
Bond Position:  [29.19299377]


portfolio before change:  [18.57461381]
curr_Stock_Price:  97.99094559076553
curr_Factors:  [97.99094559]
mat_Sqrt:  [[0.15]]
grads:  [0.05022355]
Stock Position:  0.05022354770676828
Bond Position:  [13.65316088]


portfolio before change:  [18.49532099]
curr_Stock_Price:  96.34417752622652
curr_Factors:  [96.34417753]
mat_Sqrt:  [[0.15]]
grads:  [0.02425532]
Stock Position:  0.024255323878801298
Bond Position:  [16.15846176]


portfolio before change:  [18.49533459]
curr_Stock_Price:  96.17817170506875
curr_Factors:  [96.17817171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01907988]
Stock Position:  -0.01907987642194747
Bond Position:  [20.33040222]


portfolio before change:  [18.51728196]
curr_Stock_Price:  95.2943012940062
curr_Factors:  [95.29430129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.51728196]
Stock Price:  94.7159718742166
PL:  [18.51728196]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.63959270e-02]
 [ 6.62643319e-03]
 [ 1.16008971e-03]
 [ 1.07831076e-02]
 [ 2.21389135e-02]
 [ 3.93075541e-03]
 [ 8.79394539e-03]
 [ 1.25003536e-02]
 [ 3.60481655e-03]
 [ 9.36827077e-03]
 [-1.52733267e-02]
 [-7.60404832e-03]
 [-2.30829290e-02]
 [ 2.13276195e-03]
 [ 2.86113309e-03]
 [ 6.88324631e-03]
 [ 7.52162230e-03]
 [-2.04752793e-03]
 [-1.26995262e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.55278314]
curr_Stock_Price:  102.2565559843188
curr_Factors:  [102.25655598]
mat_Sqrt:  [[0.15]]
grads:  [0.17597285]
Stock Position:  0.1759728468866723
Bond Position:  [18.55840587]


portfolio before change:  [36.28400436]
curr_Stock_Price:  100.70279944011044
curr_Factors:  [100.70279944]
mat_Sqrt:  [[0.15]]
grads:  [0.04417622]
Stock Position:  0.04417622129445288
Bond Position:  [31.83533521]


portfolio before change:  [36.2752819]
curr_Stock_Price:  100.32516899030382
curr_Factors:  [100.32516899]
mat_Sqrt:  [[0.15]]
grads:  [0.00773393]
Stock Position:  0.007733931389898032
Bond Position:  [35.49937393]


portfolio before change:  [36.28845356]
curr_Stock_Price:  100.8806043631782
curr_Factors:  [100.88060436]
mat_Sqrt:  [[0.15]]
grads:  [0.07188738]
Stock Position:  0.07188738384029808
Bond Position:  [29.03641083]


portfolio before change:  [36.33809082]
curr_Stock_Price:  101.47009934174187
curr_Factors:  [101.47009934]
mat_Sqrt:  [[0.15]]
grads:  [0.14759276]
Stock Position:  0.1475927566051532
Bond Position:  [21.36183914]


portfolio before change:  [36.23581384]
curr_Stock_Price:  100.74094357738932
curr_Factors:  [100.74094358]
mat_Sqrt:  [[0.15]]
grads:  [0.02620504]
Stock Position:  0.02620503608164677
Bond Position:  [33.59589377]


portfolio before change:  [36.23824465]
curr_Stock_Price:  100.51315486787861
curr_Factors:  [100.51315487]
mat_Sqrt:  [[0.15]]
grads:  [0.0586263]
Stock Position:  0.05862630256687203
Bond Position:  [30.34553002]


portfolio before change:  [36.29768321]
curr_Stock_Price:  101.39759119433883
curr_Factors:  [101.39759119]
mat_Sqrt:  [[0.15]]
grads:  [0.08333569]
Stock Position:  0.08333569057103317
Bond Position:  [27.84764493]


portfolio before change:  [36.2339838]
curr_Stock_Price:  100.54966885259797
curr_Factors:  [100.54966885]
mat_Sqrt:  [[0.15]]
grads:  [0.02403211]
Stock Position:  0.02403211031822224
Bond Position:  [33.81756306]


portfolio before change:  [36.26544141]
curr_Stock_Price:  101.50681187735869
curr_Factors:  [101.50681188]
mat_Sqrt:  [[0.15]]
grads:  [0.06245514]
Stock Position:  0.062455138492287954
Bond Position:  [29.92581942]


portfolio before change:  [36.28825846]
curr_Stock_Price:  101.75234263871063
curr_Factors:  [101.75234264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10182218]
Stock Position:  -0.10182217813609566
Bond Position:  [46.64890362]


portfolio before change:  [36.36466951]
curr_Stock_Price:  101.11645594829157
curr_Factors:  [101.11645595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05069366]
Stock Position:  -0.05069365549283928
Bond Position:  [41.49063229]


portfolio before change:  [36.3297338]
curr_Stock_Price:  102.01024962191951
curr_Factors:  [102.01024962]
mat_Sqrt:  [[0.15]]
grads:  [-0.15388619]
Stock Position:  -0.1538861930033681
Bond Position:  [52.02770276]


portfolio before change:  [36.38335528]
curr_Stock_Price:  101.74633428811512
curr_Factors:  [101.74633429]
mat_Sqrt:  [[0.15]]
grads:  [0.01421841]
Stock Position:  0.014218412978548388
Bond Position:  [34.93668388]


portfolio before change:  [36.38941534]
curr_Stock_Price:  101.55818411969615
curr_Factors:  [101.55818412]
mat_Sqrt:  [[0.15]]
grads:  [0.01907422]
Stock Position:  0.019074220607672998
Bond Position:  [34.45227213]


portfolio before change:  [36.3890039]
curr_Stock_Price:  101.08500150959665
curr_Factors:  [101.08500151]
mat_Sqrt:  [[0.15]]
grads:  [0.04588831]
Stock Position:  0.04588830875624483
Bond Position:  [31.75038414]


portfolio before change:  [36.35475467]
curr_Stock_Price:  100.16564273800638
curr_Factors:  [100.16564274]
mat_Sqrt:  [[0.15]]
grads:  [0.05014415]
Stock Position:  0.05014414867109013
Bond Position:  [31.33203379]


portfolio before change:  [36.22925017]
curr_Stock_Price:  97.50653917525571
curr_Factors:  [97.50653918]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365019]
Stock Position:  -0.013650186213430546
Bond Position:  [37.56023259]


portfolio before change:  [36.23460721]
curr_Stock_Price:  97.80208036792092
curr_Factors:  [97.80208037]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.23460721]
Stock Price:  95.73891289985487
PL:  [36.23460721]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.03811918e-03]
 [ 8.96563490e-03]
 [ 1.37034942e-03]
 [ 4.52726142e-03]
 [ 4.59465824e-03]
 [ 4.57802078e-03]
 [-1.05565405e-02]
 [ 1.29914924e-02]
 [ 2.73741854e-03]
 [ 9.82647064e-03]
 [-1.85334633e-02]
 [ 6.32213375e-03]
 [-2.48920683e-02]
 [ 2.50132494e-03]
 [-1.21156186e-02]
 [ 6.37485718e-03]
 [ 7.49231620e-03]
 [-5.01166528e-03]
 [-1.19089794e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.1486771]
curr_Stock_Price:  100.6733551257604
curr_Factors:  [100.67335513]
mat_Sqrt:  [[0.15]]
grads:  [0.04025413]
Stock Position:  0.040254127877248025
Bond Position:  [8.09615899]


portfolio before change:  [12.12515491]
curr_Stock_Price:  100.03872506463583
curr_Factors:  [100.03872506]
mat_Sqrt:  [[0.15]]
grads:  [0.0597709]
Stock Position:  0.05977089931024536
Bond Position:  [6.14575035]


portfolio before change:  [12.11830865]
curr_Stock_Price:  99.89847472693276
curr_Factors:  [99.89847473]
mat_Sqrt:  [[0.15]]
grads:  [0.00913566]
Stock Position:  0.009135662799862117
Bond Position:  [11.20566987]


portfolio before change:  [12.12457625]
curr_Stock_Price:  100.2778479229643
curr_Factors:  [100.27784792]
mat_Sqrt:  [[0.15]]
grads:  [0.03018174]
Stock Position:  0.03018174282188351
Bond Position:  [9.09801603]


portfolio before change:  [12.10409133]
curr_Stock_Price:  99.52375938909896
curr_Factors:  [99.52375939]
mat_Sqrt:  [[0.15]]
grads:  [0.03063105]
Stock Position:  0.030631054917837932
Bond Position:  [9.05557359]


portfolio before change:  [12.08851096]
curr_Stock_Price:  98.94119538396136
curr_Factors:  [98.94119538]
mat_Sqrt:  [[0.15]]
grads:  [0.03052014]
Stock Position:  0.030520138539307115
Bond Position:  [9.06881197]


portfolio before change:  [12.08257993]
curr_Stock_Price:  98.6725690019414
curr_Factors:  [98.672569]
mat_Sqrt:  [[0.15]]
grads:  [-0.07037694]
Stock Position:  -0.07037693669941175
Bond Position:  [19.02685307]


portfolio before change:  [11.90909458]
curr_Stock_Price:  101.20525459625908
curr_Factors:  [101.2052546]
mat_Sqrt:  [[0.15]]
grads:  [0.08660995]
Stock Position:  0.08660994900857796
Bond Position:  [3.14371264]


portfolio before change:  [11.79265356]
curr_Stock_Price:  99.85174906361695
curr_Factors:  [99.85174906]
mat_Sqrt:  [[0.15]]
grads:  [0.01824946]
Stock Position:  0.01824945694121396
Bond Position:  [9.97041337]


portfolio before change:  [11.79280161]
curr_Stock_Price:  99.72325922632994
curr_Factors:  [99.72325923]
mat_Sqrt:  [[0.15]]
grads:  [0.0655098]
Stock Position:  0.06550980428291149
Bond Position:  [5.25995041]


portfolio before change:  [11.72879305]
curr_Stock_Price:  98.72609991730778
curr_Factors:  [98.72609992]
mat_Sqrt:  [[0.15]]
grads:  [-0.12355642]
Stock Position:  -0.12355642222304418
Bond Position:  [23.92703674]


portfolio before change:  [11.68839001]
curr_Stock_Price:  99.10151989413568
curr_Factors:  [99.10151989]
mat_Sqrt:  [[0.15]]
grads:  [0.04214756]
Stock Position:  0.042147558346751136
Bond Position:  [7.51150292]


portfolio before change:  [11.77870717]
curr_Stock_Price:  101.19983967055576
curr_Factors:  [101.19983967]
mat_Sqrt:  [[0.15]]
grads:  [-0.16594712]
Stock Position:  -0.16594712229260314
Bond Position:  [28.57252934]


portfolio before change:  [11.6126183]
curr_Stock_Price:  102.24374387025591
curr_Factors:  [102.24374387]
mat_Sqrt:  [[0.15]]
grads:  [0.0166755]
Stock Position:  0.01667549959027618
Bond Position:  [9.90765279]


portfolio before change:  [11.57308709]
curr_Stock_Price:  99.72457271967646
curr_Factors:  [99.72457272]
mat_Sqrt:  [[0.15]]
grads:  [-0.08077079]
Stock Position:  -0.08077079083961018
Bond Position:  [19.62791969]


portfolio before change:  [11.44859644]
curr_Stock_Price:  101.32661525392376
curr_Factors:  [101.32661525]
mat_Sqrt:  [[0.15]]
grads:  [0.04249905]
Stock Position:  0.04249904784448236
Bond Position:  [7.14231177]


portfolio before change:  [11.49289319]
curr_Stock_Price:  102.32689541809935
curr_Factors:  [102.32689542]
mat_Sqrt:  [[0.15]]
grads:  [0.04994877]
Stock Position:  0.049948774669069794
Bond Position:  [6.38179015]


portfolio before change:  [11.52839403]
curr_Stock_Price:  103.0056946217322
curr_Factors:  [103.00569462]
mat_Sqrt:  [[0.15]]
grads:  [-0.0334111]
Stock Position:  -0.03341110186845268
Bond Position:  [14.96992778]


portfolio before change:  [11.55500612]
curr_Stock_Price:  102.32121726719274
curr_Factors:  [102.32121727]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.55500612]
Stock Price:  102.01585124951423
PL:  [9.53915487]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.76688892e-02]
 [ 8.24280875e-03]
 [ 8.08347199e-04]
 [ 5.15966077e-03]
 [ 5.58098588e-03]
 [ 3.02381872e-03]
 [-7.98663730e-03]
 [ 8.59204592e-03]
 [ 4.61956491e-03]
 [-3.81483088e-03]
 [-1.79916253e-02]
 [ 5.47809216e-03]
 [-1.24971968e-02]
 [-2.02898566e-03]
 [-1.63406233e-02]
 [ 6.33266707e-03]
 [ 2.54746511e-03]
 [-5.52594507e-03]
 [-1.16651578e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.00851212]
curr_Stock_Price:  98.9115497473582
curr_Factors:  [98.91154975]
mat_Sqrt:  [[0.15]]
grads:  [0.11779259]
Stock Position:  0.11779259490777932
Bond Position:  [-26.65956023]


portfolio before change:  [-14.83768919]
curr_Stock_Price:  100.41833924691824
curr_Factors:  [100.41833925]
mat_Sqrt:  [[0.15]]
grads:  [0.05495206]
Stock Position:  0.05495205830817844
Bond Position:  [-20.35588363]


portfolio before change:  [-14.91288522]
curr_Stock_Price:  99.14256496347878
curr_Factors:  [99.14256496]
mat_Sqrt:  [[0.15]]
grads:  [0.00538898]
Stock Position:  0.005388981325247759
Bond Position:  [-15.44716265]


portfolio before change:  [-14.91032411]
curr_Stock_Price:  100.33451305876338
curr_Factors:  [100.33451306]
mat_Sqrt:  [[0.15]]
grads:  [0.03439774]
Stock Position:  0.034397738457180374
Bond Position:  [-18.36160445]


portfolio before change:  [-14.93922673]
curr_Stock_Price:  99.6277326832992
curr_Factors:  [99.62773268]
mat_Sqrt:  [[0.15]]
grads:  [0.03720657]
Stock Position:  0.03720657250566812
Bond Position:  [-18.64603319]


portfolio before change:  [-14.93004193]
curr_Stock_Price:  99.99989531744026
curr_Factors:  [99.99989532]
mat_Sqrt:  [[0.15]]
grads:  [0.02015879]
Stock Position:  0.020158791457831535
Bond Position:  [-16.94591896]


portfolio before change:  [-14.96863105]
curr_Stock_Price:  98.29581919826333
curr_Factors:  [98.2958192]
mat_Sqrt:  [[0.15]]
grads:  [-0.05324425]
Stock Position:  -0.053244248647761575
Bond Position:  [-9.73494401]


portfolio before change:  [-14.93561163]
curr_Stock_Price:  97.62995453796599
curr_Factors:  [97.62995454]
mat_Sqrt:  [[0.15]]
grads:  [0.05728031]
Stock Position:  0.05728030615865878
Bond Position:  [-20.52788531]


portfolio before change:  [-15.01391008]
curr_Stock_Price:  96.35262472275048
curr_Factors:  [96.35262472]
mat_Sqrt:  [[0.15]]
grads:  [0.0307971]
Stock Position:  0.030797099433008148
Bond Position:  [-17.98129145]


portfolio before change:  [-15.00958036]
curr_Stock_Price:  96.63919751189565
curr_Factors:  [96.63919751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02543221]
Stock Position:  -0.02543220587324201
Bond Position:  [-12.55183239]


portfolio before change:  [-15.03291875]
curr_Stock_Price:  97.43346780487158
curr_Factors:  [97.4334678]
mat_Sqrt:  [[0.15]]
grads:  [-0.11994417]
Stock Position:  -0.11994416882050304
Bond Position:  [-3.34634244]


portfolio before change:  [-15.1122055]
curr_Stock_Price:  98.08752261641939
curr_Factors:  [98.08752262]
mat_Sqrt:  [[0.15]]
grads:  [0.03652061]
Stock Position:  0.03652061437363404
Bond Position:  [-18.69442209]


portfolio before change:  [-15.11006353]
curr_Stock_Price:  98.2741615258245
curr_Factors:  [98.27416153]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331465]
Stock Position:  -0.08331464500477961
Bond Position:  [-6.92238665]


portfolio before change:  [-14.96511387]
curr_Stock_Price:  96.51360107816564
curr_Factors:  [96.51360108]
mat_Sqrt:  [[0.15]]
grads:  [-0.01352657]
Stock Position:  -0.013526571060213401
Bond Position:  [-13.65961579]


portfolio before change:  [-14.94774998]
curr_Stock_Price:  94.97742266907672
curr_Factors:  [94.97742267]
mat_Sqrt:  [[0.15]]
grads:  [-0.10893749]
Stock Position:  -0.1089374887435818
Bond Position:  [-4.60114806]


portfolio before change:  [-14.87498922]
curr_Stock_Price:  94.29894931748115
curr_Factors:  [94.29894932]
mat_Sqrt:  [[0.15]]
grads:  [0.04221778]
Stock Position:  0.04221778048883494
Bond Position:  [-18.85608157]


portfolio before change:  [-14.87822065]
curr_Stock_Price:  94.33408096087183
curr_Factors:  [94.33408096]
mat_Sqrt:  [[0.15]]
grads:  [0.0169831]
Stock Position:  0.016983100759814247
Bond Position:  [-16.48030586]


portfolio before change:  [-14.90333021]
curr_Stock_Price:  93.09820731968684
curr_Factors:  [93.09820732]
mat_Sqrt:  [[0.15]]
grads:  [-0.03683963]
Stock Position:  -0.03683963377621137
Bond Position:  [-11.47362635]


portfolio before change:  [-14.93772782]
curr_Stock_Price:  93.95404767291951
curr_Factors:  [93.95404767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.93772782]
Stock Price:  92.96830007010391
PL:  [-14.93772782]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.28342974e-03]
 [ 8.99119244e-03]
 [-3.10115689e-04]
 [-1.32986542e-03]
 [-3.39400382e-03]
 [ 3.15485384e-03]
 [-7.67453109e-03]
 [ 1.25169385e-02]
 [ 4.24725449e-03]
 [ 8.20774575e-03]
 [-1.85363580e-02]
 [ 5.89228512e-03]
 [-2.02264189e-02]
 [ 3.65683278e-03]
 [-9.86132682e-03]
 [ 7.81014142e-03]
 [ 4.60238125e-03]
 [-2.00159722e-03]
 [-1.24879154e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.20537013]
curr_Stock_Price:  100.15803813790365
curr_Factors:  [100.15803814]
mat_Sqrt:  [[0.15]]
grads:  [0.0285562]
Stock Position:  0.02855619823840134
Bond Position:  [1.34523734]


portfolio before change:  [4.18053779]
curr_Stock_Price:  99.27666416239157
curr_Factors:  [99.27666416]
mat_Sqrt:  [[0.15]]
grads:  [0.05994128]
Stock Position:  0.059941282945392554
Bond Position:  [-1.77023283]


portfolio before change:  [4.14806662]
curr_Stock_Price:  98.74233200440007
curr_Factors:  [98.742332]
mat_Sqrt:  [[0.15]]
grads:  [-0.00206744]
Stock Position:  -0.0020674379278035992
Bond Position:  [4.35221026]


portfolio before change:  [4.15348882]
curr_Stock_Price:  96.6460135820396
curr_Factors:  [96.64601358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00886577]
Stock Position:  -0.00886576946003639
Bond Position:  [5.01033009]


portfolio before change:  [4.15467967]
curr_Stock_Price:  96.65299347333966
curr_Factors:  [96.65299347]
mat_Sqrt:  [[0.15]]
grads:  [-0.02262669]
Stock Position:  -0.022626692121506503
Bond Position:  [6.3416172]


portfolio before change:  [4.13297592]
curr_Stock_Price:  97.68228019743106
curr_Factors:  [97.6822802]
mat_Sqrt:  [[0.15]]
grads:  [0.02103236]
Stock Position:  0.021032358922463974
Bond Position:  [2.07848715]


portfolio before change:  [4.14385886]
curr_Stock_Price:  98.17500923611601
curr_Factors:  [98.17500924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05116354]
Stock Position:  -0.05116354062021915
Bond Position:  [9.16683994]


portfolio before change:  [4.0584521]
curr_Stock_Price:  99.88909632130131
curr_Factors:  [99.88909632]
mat_Sqrt:  [[0.15]]
grads:  [0.08344626]
Stock Position:  0.08344625650623666
Bond Position:  [-4.27691906]


portfolio before change:  [3.96516411]
curr_Stock_Price:  98.78397042628194
curr_Factors:  [98.78397043]
mat_Sqrt:  [[0.15]]
grads:  [0.02831503]
Stock Position:  0.028315029918844853
Bond Position:  [1.16809304]


portfolio before change:  [3.94159889]
curr_Stock_Price:  97.94140450561487
curr_Factors:  [97.94140451]
mat_Sqrt:  [[0.15]]
grads:  [0.0547183]
Stock Position:  0.054718304975476875
Bond Position:  [-1.41758875]


portfolio before change:  [3.98602863]
curr_Stock_Price:  98.75985412436127
curr_Factors:  [98.75985412]
mat_Sqrt:  [[0.15]]
grads:  [-0.12357572]
Stock Position:  -0.12357571968086577
Bond Position:  [16.19034868]


portfolio before change:  [3.90434903]
curr_Stock_Price:  99.45358015923817
curr_Factors:  [99.45358016]
mat_Sqrt:  [[0.15]]
grads:  [0.0392819]
Stock Position:  0.03928190077640976
Bond Position:  [-0.00237664]


portfolio before change:  [3.89528584]
curr_Stock_Price:  99.22287353709673
curr_Factors:  [99.22287354]
mat_Sqrt:  [[0.15]]
grads:  [-0.13484279]
Stock Position:  -0.13484279243641378
Bond Position:  [17.27477518]


portfolio before change:  [3.79924888]
curr_Stock_Price:  99.96711938986462
curr_Factors:  [99.96711939]
mat_Sqrt:  [[0.15]]
grads:  [0.02437889]
Stock Position:  0.02437888520297803
Bond Position:  [1.36216196]


portfolio before change:  [3.80764726]
curr_Stock_Price:  100.29764271664955
curr_Factors:  [100.29764272]
mat_Sqrt:  [[0.15]]
grads:  [-0.06574218]
Stock Position:  -0.06574217880833194
Bond Position:  [10.40143282]


portfolio before change:  [3.812448]
curr_Stock_Price:  100.26417775946315
curr_Factors:  [100.26417776]
mat_Sqrt:  [[0.15]]
grads:  [0.05206761]
Stock Position:  0.05206760947944147
Bond Position:  [-1.40806805]


portfolio before change:  [3.72580304]
curr_Stock_Price:  98.60685378109537
curr_Factors:  [98.60685378]
mat_Sqrt:  [[0.15]]
grads:  [0.03068254]
Stock Position:  0.030682541682810125
Bond Position:  [0.70029414]


portfolio before change:  [3.69861629]
curr_Stock_Price:  97.71508142176837
curr_Factors:  [97.71508142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01334398]
Stock Position:  -0.013343981439925118
Bond Position:  [5.00252453]


portfolio before change:  [3.7208797]
curr_Stock_Price:  96.14039250617513
curr_Factors:  [96.14039251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.7208797]
Stock Price:  96.42382079617234
PL:  [3.7208797]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.43179894e-03]
 [ 1.04719709e-02]
 [ 1.10140435e-03]
 [ 3.56361040e-03]
 [ 1.06058174e-03]
 [ 3.33167670e-03]
 [-1.18742383e-02]
 [ 1.25114040e-02]
 [ 4.37838806e-03]
 [ 9.28478026e-03]
 [-1.57724151e-02]
 [-7.52958788e-03]
 [-2.45398457e-02]
 [ 2.05548430e-03]
 [ 1.31415580e-02]
 [ 2.23353945e-03]
 [ 7.20481226e-03]
 [-5.21821414e-03]
 [-1.11898207e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.84826045]
curr_Stock_Price:  100.06999651092482
curr_Factors:  [100.06999651]
mat_Sqrt:  [[0.15]]
grads:  [0.02287866]
Stock Position:  0.022878659598448845
Bond Position:  [0.55879307]


portfolio before change:  [2.84042597]
curr_Stock_Price:  99.72145316029118
curr_Factors:  [99.72145316]
mat_Sqrt:  [[0.15]]
grads:  [0.06981314]
Stock Position:  0.06981313925434697
Bond Position:  [-4.12144173]


portfolio before change:  [2.81106908]
curr_Stock_Price:  99.31570728193748
curr_Factors:  [99.31570728]
mat_Sqrt:  [[0.15]]
grads:  [0.0073427]
Stock Position:  0.007342695666083327
Bond Position:  [2.08182407]


portfolio before change:  [2.81700493]
curr_Stock_Price:  100.05321895197685
curr_Factors:  [100.05321895]
mat_Sqrt:  [[0.15]]
grads:  [0.0237574]
Stock Position:  0.023757402692559847
Bond Position:  [0.44000031]


portfolio before change:  [2.77689936]
curr_Stock_Price:  98.36045879379542
curr_Factors:  [98.36045879]
mat_Sqrt:  [[0.15]]
grads:  [0.00707054]
Stock Position:  0.007070544910799346
Bond Position:  [2.08143732]


portfolio before change:  [2.78745986]
curr_Stock_Price:  99.78044568200423
curr_Factors:  [99.78044568]
mat_Sqrt:  [[0.15]]
grads:  [0.02221118]
Stock Position:  0.02221117800269668
Bond Position:  [0.57121862]


portfolio before change:  [2.76677492]
curr_Stock_Price:  98.8427302710663
curr_Factors:  [98.84273027]
mat_Sqrt:  [[0.15]]
grads:  [-0.07916159]
Stock Position:  -0.0791615886891471
Bond Position:  [10.59132248]


portfolio before change:  [2.68045206]
curr_Stock_Price:  99.96664680231152
curr_Factors:  [99.9666468]
mat_Sqrt:  [[0.15]]
grads:  [0.08340936]
Stock Position:  0.0834093598698198
Bond Position:  [-5.65770195]


portfolio before change:  [2.79646801]
curr_Stock_Price:  101.37452898609422
curr_Factors:  [101.37452899]
mat_Sqrt:  [[0.15]]
grads:  [0.02918925]
Stock Position:  0.02918925376472754
Bond Position:  [-0.16257884]


portfolio before change:  [2.79539402]
curr_Stock_Price:  101.33912746830126
curr_Factors:  [101.33912747]
mat_Sqrt:  [[0.15]]
grads:  [0.06189854]
Stock Position:  0.061898535060654764
Bond Position:  [-3.47734951]


portfolio before change:  [2.79645497]
curr_Stock_Price:  101.37031389665356
curr_Factors:  [101.3703139]
mat_Sqrt:  [[0.15]]
grads:  [-0.10514943]
Stock Position:  -0.1051494337798741
Bond Position:  [13.45548608]


portfolio before change:  [2.82751288]
curr_Stock_Price:  101.10693999202051
curr_Factors:  [101.10693999]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019725]
Stock Position:  -0.05019725251202676
Bond Position:  [7.90280347]


portfolio before change:  [2.81981898]
curr_Stock_Price:  101.29957687925162
curr_Factors:  [101.29957688]
mat_Sqrt:  [[0.15]]
grads:  [-0.16359897]
Stock Position:  -0.16359897146974073
Bond Position:  [19.39232557]


portfolio before change:  [2.87671373]
curr_Stock_Price:  100.98144493830591
curr_Factors:  [100.98144494]
mat_Sqrt:  [[0.15]]
grads:  [0.01370323]
Stock Position:  0.013703228636871827
Bond Position:  [1.4929419]


portfolio before change:  [2.90151331]
curr_Stock_Price:  102.76396637506782
curr_Factors:  [102.76396638]
mat_Sqrt:  [[0.15]]
grads:  [0.08761039]
Stock Position:  0.08761038682338775
Bond Position:  [-6.10167754]


portfolio before change:  [2.95169792]
curr_Stock_Price:  103.35419568304525
curr_Factors:  [103.35419568]
mat_Sqrt:  [[0.15]]
grads:  [0.01489026]
Stock Position:  0.01489026298644655
Bond Position:  [1.41272676]


portfolio before change:  [2.95842279]
curr_Stock_Price:  103.78210262280642
curr_Factors:  [103.78210262]
mat_Sqrt:  [[0.15]]
grads:  [0.04803208]
Stock Position:  0.0480320817349144
Bond Position:  [-2.02644765]


portfolio before change:  [2.9796589]
curr_Stock_Price:  104.2347747957544
curr_Factors:  [104.2347748]
mat_Sqrt:  [[0.15]]
grads:  [-0.03478809]
Stock Position:  -0.0347880942924855
Bond Position:  [6.60578808]


portfolio before change:  [2.99218238]
curr_Stock_Price:  103.92225918039273
curr_Factors:  [103.92225918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.99218238]
Stock Price:  102.80383871718774
PL:  [0.18834366]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.58823405e-02]
 [ 3.48912902e-03]
 [-9.90067014e-04]
 [ 3.45150508e-04]
 [ 1.02295568e-03]
 [ 1.43722123e-03]
 [-1.31943494e-02]
 [ 1.22464237e-02]
 [ 4.55145067e-03]
 [ 8.26797227e-03]
 [-1.60875913e-02]
 [-5.74009186e-03]
 [-2.53690615e-02]
 [ 2.43673607e-03]
 [-1.46935032e-02]
 [ 7.90950550e-03]
 [ 4.46678823e-03]
 [-2.13796856e-03]
 [-1.26811356e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.34697688]
curr_Stock_Price:  98.50034587697947
curr_Factors:  [98.50034588]
mat_Sqrt:  [[0.15]]
grads:  [0.17254894]
Stock Position:  0.17254893685371792
Bond Position:  [-38.34310684]


portfolio before change:  [-21.39632895]
curr_Stock_Price:  98.26988895837853
curr_Factors:  [98.26988896]
mat_Sqrt:  [[0.15]]
grads:  [0.02326086]
Stock Position:  0.02326086013491267
Bond Position:  [-23.68217109]


portfolio before change:  [-21.3969686]
curr_Stock_Price:  98.49694987058382
curr_Factors:  [98.49694987]
mat_Sqrt:  [[0.15]]
grads:  [-0.00660045]
Stock Position:  -0.006600446759215843
Bond Position:  [-20.74684473]


portfolio before change:  [-21.39626309]
curr_Stock_Price:  97.60415131864167
curr_Factors:  [97.60415132]
mat_Sqrt:  [[0.15]]
grads:  [0.002301]
Stock Position:  0.0023010033878505835
Bond Position:  [-21.62085058]


portfolio before change:  [-21.39995992]
curr_Stock_Price:  98.34689548447331
curr_Factors:  [98.34689548]
mat_Sqrt:  [[0.15]]
grads:  [0.0068197]
Stock Position:  0.006819704547365349
Bond Position:  [-22.07065669]


portfolio before change:  [-21.41456901]
curr_Stock_Price:  97.01388555654309
curr_Factors:  [97.01388556]
mat_Sqrt:  [[0.15]]
grads:  [0.00958147]
Stock Position:  0.009581474866186882
Bond Position:  [-22.34410512]


portfolio before change:  [-21.39596576]
curr_Stock_Price:  99.53854704245853
curr_Factors:  [99.53854704]
mat_Sqrt:  [[0.15]]
grads:  [-0.08796233]
Stock Position:  -0.08796232962265611
Bond Position:  [-12.64032327]


portfolio before change:  [-21.39385734]
curr_Stock_Price:  99.47864766877676
curr_Factors:  [99.47864767]
mat_Sqrt:  [[0.15]]
grads:  [0.08164282]
Stock Position:  0.08164282467288266
Bond Position:  [-29.51557513]


portfolio before change:  [-21.22709217]
curr_Stock_Price:  101.61165805481657
curr_Factors:  [101.61165805]
mat_Sqrt:  [[0.15]]
grads:  [0.030343]
Stock Position:  0.03034300446104627
Bond Position:  [-24.31029516]


portfolio before change:  [-21.26978562]
curr_Stock_Price:  100.40495093053597
curr_Factors:  [100.40495093]
mat_Sqrt:  [[0.15]]
grads:  [0.05511982]
Stock Position:  0.05511981514424736
Bond Position:  [-26.80408795]


portfolio before change:  [-21.23657465]
curr_Stock_Price:  101.12906127752147
curr_Factors:  [101.12906128]
mat_Sqrt:  [[0.15]]
grads:  [-0.10725061]
Stock Position:  -0.10725060850893055
Bond Position:  [-10.39042129]


portfolio before change:  [-21.21668483]
curr_Stock_Price:  100.91938645595077
curr_Factors:  [100.91938646]
mat_Sqrt:  [[0.15]]
grads:  [-0.03826728]
Stock Position:  -0.038267279045690876
Bond Position:  [-17.35477451]


portfolio before change:  [-21.22658757]
curr_Stock_Price:  101.06477179432201
curr_Factors:  [101.06477179]
mat_Sqrt:  [[0.15]]
grads:  [-0.16912708]
Stock Position:  -0.16912707638263313
Bond Position:  [-4.13379819]


portfolio before change:  [-20.90400453]
curr_Stock_Price:  99.15131937954907
curr_Factors:  [99.15131938]
mat_Sqrt:  [[0.15]]
grads:  [0.01624491]
Stock Position:  0.016244907154363993
Bond Position:  [-22.51470851]


portfolio before change:  [-20.90750299]
curr_Stock_Price:  99.28249413206241
curr_Factors:  [99.28249413]
mat_Sqrt:  [[0.15]]
grads:  [-0.09795669]
Stock Position:  -0.09795668791838161
Bond Position:  [-11.1821187]


portfolio before change:  [-20.85534858]
curr_Stock_Price:  98.72152896559376
curr_Factors:  [98.72152897]
mat_Sqrt:  [[0.15]]
grads:  [0.05273004]
Stock Position:  0.05273003665142026
Bond Position:  [-26.06093842]


portfolio before change:  [-20.90505917]
curr_Stock_Price:  97.90236506357198
curr_Factors:  [97.90236506]
mat_Sqrt:  [[0.15]]
grads:  [0.02977859]
Stock Position:  0.02977858820131594
Bond Position:  [-23.82045339]


portfolio before change:  [-20.93343088]
curr_Stock_Price:  97.14961446126874
curr_Factors:  [97.14961446]
mat_Sqrt:  [[0.15]]
grads:  [-0.01425312]
Stock Position:  -0.014253123734643562
Bond Position:  [-19.5487454]


portfolio before change:  [-20.94280798]
curr_Stock_Price:  97.46458384967708
curr_Factors:  [97.46458385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.94280798]
Stock Price:  96.60368611605472
PL:  [-20.94280798]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.99530809e-03]
 [ 8.39484450e-03]
 [ 1.41978424e-03]
 [ 6.21872308e-03]
 [ 2.60917546e-03]
 [ 4.27252170e-03]
 [-4.36544596e-03]
 [ 1.31467942e-02]
 [ 3.02189138e-03]
 [ 8.58448729e-03]
 [-1.71736754e-02]
 [ 5.81428650e-03]
 [-2.60428791e-02]
 [ 2.00384608e-03]
 [-1.04169345e-02]
 [ 7.86768101e-03]
 [ 7.46337344e-03]
 [-1.77191962e-03]
 [-1.26743274e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.42522286]
curr_Stock_Price:  100.62642149177863
curr_Factors:  [100.62642149]
mat_Sqrt:  [[0.15]]
grads:  [0.03996872]
Stock Position:  0.03996872061080357
Bond Position:  [7.40331353]


portfolio before change:  [11.41719146]
curr_Stock_Price:  100.37916668982466
curr_Factors:  [100.37916669]
mat_Sqrt:  [[0.15]]
grads:  [0.05596563]
Stock Position:  0.055965629971328826
Bond Position:  [5.79940816]


portfolio before change:  [11.38689508]
curr_Stock_Price:  99.81191833784382
curr_Factors:  [99.81191834]
mat_Sqrt:  [[0.15]]
grads:  [0.00946523]
Stock Position:  0.00946522829232206
Bond Position:  [10.44215249]


portfolio before change:  [11.39535063]
curr_Stock_Price:  100.42940864950297
curr_Factors:  [100.42940865]
mat_Sqrt:  [[0.15]]
grads:  [0.04145815]
Stock Position:  0.04145815383826422
Bond Position:  [7.23173276]


portfolio before change:  [11.3345272]
curr_Stock_Price:  98.91869047506039
curr_Factors:  [98.91869048]
mat_Sqrt:  [[0.15]]
grads:  [0.0173945]
Stock Position:  0.01739450306020705
Bond Position:  [9.61388574]


portfolio before change:  [11.34385601]
curr_Stock_Price:  99.31680654899131
curr_Factors:  [99.31680655]
mat_Sqrt:  [[0.15]]
grads:  [0.02848348]
Stock Position:  0.028483477969981158
Bond Position:  [8.51496794]


portfolio before change:  [11.36777629]
curr_Stock_Price:  100.08185607849333
curr_Factors:  [100.08185608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910297]
Stock Position:  -0.029102973089045518
Bond Position:  [14.28045585]


portfolio before change:  [11.3611823]
curr_Stock_Price:  100.4311174283922
curr_Factors:  [100.43111743]
mat_Sqrt:  [[0.15]]
grads:  [0.08764529]
Stock Position:  0.08764529463802714
Bond Position:  [2.55886742]


portfolio before change:  [11.2800527]
curr_Stock_Price:  99.49815918498032
curr_Factors:  [99.49815918]
mat_Sqrt:  [[0.15]]
grads:  [0.02014594]
Stock Position:  0.020145942547951656
Bond Position:  [9.2755685]


portfolio before change:  [11.29768209]
curr_Stock_Price:  100.2581241926143
curr_Factors:  [100.25812419]
mat_Sqrt:  [[0.15]]
grads:  [0.05722992]
Stock Position:  0.05722991526891506
Bond Position:  [5.55991814]


portfolio before change:  [11.29095021]
curr_Stock_Price:  100.11620473271323
curr_Factors:  [100.11620473]
mat_Sqrt:  [[0.15]]
grads:  [-0.11449117]
Stock Position:  -0.11449116946020022
Bond Position:  [22.75337157]


portfolio before change:  [11.36875216]
curr_Stock_Price:  99.48634922120499
curr_Factors:  [99.48634922]
mat_Sqrt:  [[0.15]]
grads:  [0.03876191]
Stock Position:  0.03876191001240988
Bond Position:  [7.51247124]


portfolio before change:  [11.40610007]
curr_Stock_Price:  100.4014115997464
curr_Factors:  [100.4014116]
mat_Sqrt:  [[0.15]]
grads:  [-0.17361919]
Stock Position:  -0.17361919414856372
Bond Position:  [28.83771225]


portfolio before change:  [11.27675186]
curr_Stock_Price:  101.18795216043416
curr_Factors:  [101.18795216]
mat_Sqrt:  [[0.15]]
grads:  [0.01335897]
Stock Position:  0.01335897387952787
Bond Position:  [9.92498465]


portfolio before change:  [11.26570201]
curr_Stock_Price:  100.17504410299868
curr_Factors:  [100.1750441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06944623]
Stock Position:  -0.06944623006205172
Bond Position:  [18.22248117]


portfolio before change:  [11.31736908]
curr_Stock_Price:  99.49666486674626
curr_Factors:  [99.49666487]
mat_Sqrt:  [[0.15]]
grads:  [0.05245121]
Stock Position:  0.052451206746115836
Bond Position:  [6.09864894]


portfolio before change:  [11.42482449]
curr_Stock_Price:  101.51626686148894
curr_Factors:  [101.51626686]
mat_Sqrt:  [[0.15]]
grads:  [0.04975582]
Stock Position:  0.049755822935670546
Bond Position:  [6.37379909]


portfolio before change:  [11.31151287]
curr_Stock_Price:  99.20688336650649
curr_Factors:  [99.20688337]
mat_Sqrt:  [[0.15]]
grads:  [-0.0118128]
Stock Position:  -0.01181279744373752
Bond Position:  [12.48342368]


portfolio before change:  [11.33669145]
curr_Stock_Price:  97.33964261580478
curr_Factors:  [97.33964262]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.33669145]
Stock Price:  97.80212298698545
PL:  [11.33669145]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.05371631e-03]
 [ 7.74601629e-03]
 [-1.09922010e-03]
 [ 2.76128151e-03]
 [-1.79473861e-04]
 [ 3.26697523e-03]
 [-1.14157240e-02]
 [ 1.16367252e-02]
 [ 3.86132197e-03]
 [ 8.87367099e-03]
 [-1.66470354e-02]
 [ 4.93337724e-03]
 [-1.90267612e-02]
 [ 3.81453647e-03]
 [-3.49368433e-03]
 [ 4.98816096e-03]
 [ 7.49334796e-03]
 [-4.19271992e-03]
 [-1.23039757e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.49585441]
curr_Stock_Price:  99.59355172997807
curr_Factors:  [99.59355173]
mat_Sqrt:  [[0.15]]
grads:  [0.02035811]
Stock Position:  0.02035810870160766
Bond Position:  [-6.52339076]


portfolio before change:  [-4.50807923]
curr_Stock_Price:  99.07318082406645
curr_Factors:  [99.07318082]
mat_Sqrt:  [[0.15]]
grads:  [0.05164011]
Stock Position:  0.05164010861524489
Bond Position:  [-9.62422905]


portfolio before change:  [-4.54380566]
curr_Stock_Price:  98.4279444366688
curr_Factors:  [98.42794444]
mat_Sqrt:  [[0.15]]
grads:  [-0.00732813]
Stock Position:  -0.00732813400900341
Bond Position:  [-3.8225125]


portfolio before change:  [-4.54881473]
curr_Stock_Price:  98.98106217329423
curr_Factors:  [98.98106217]
mat_Sqrt:  [[0.15]]
grads:  [0.01840854]
Stock Position:  0.018408543370705514
Bond Position:  [-6.37091191]


portfolio before change:  [-4.57336779]
curr_Stock_Price:  97.73380799100161
curr_Factors:  [97.73380799]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119649]
Stock Position:  -0.0011964924042072156
Bond Position:  [-4.45643003]


portfolio before change:  [-4.57449147]
curr_Stock_Price:  97.74168770262858
curr_Factors:  [97.7416877]
mat_Sqrt:  [[0.15]]
grads:  [0.02177983]
Stock Position:  0.021779834876222946
Bond Position:  [-6.70328929]


portfolio before change:  [-4.55347657]
curr_Stock_Price:  98.7835198945643
curr_Factors:  [98.78351989]
mat_Sqrt:  [[0.15]]
grads:  [-0.07610483]
Stock Position:  -0.07610482639284845
Bond Position:  [2.96442607]


portfolio before change:  [-4.76363324]
curr_Stock_Price:  101.55466967084678
curr_Factors:  [101.55466967]
mat_Sqrt:  [[0.15]]
grads:  [0.07757817]
Stock Position:  0.0775781679969535
Bond Position:  [-12.64205846]


portfolio before change:  [-4.83165998]
curr_Stock_Price:  100.71853458328626
curr_Factors:  [100.71853458]
mat_Sqrt:  [[0.15]]
grads:  [0.02574215]
Stock Position:  0.0257421464509413
Bond Position:  [-7.42437124]


portfolio before change:  [-4.8276167]
curr_Stock_Price:  100.94771530519421
curr_Factors:  [100.94771531]
mat_Sqrt:  [[0.15]]
grads:  [0.05915781]
Stock Position:  0.059157806573305376
Bond Position:  [-10.79946211]


portfolio before change:  [-4.84759126]
curr_Stock_Price:  100.65571061947185
curr_Factors:  [100.65571062]
mat_Sqrt:  [[0.15]]
grads:  [-0.11098024]
Stock Position:  -0.1109802357442178
Bond Position:  [6.32320324]


portfolio before change:  [-4.73706708]
curr_Stock_Price:  99.67406574015986
curr_Factors:  [99.67406574]
mat_Sqrt:  [[0.15]]
grads:  [0.03288918]
Stock Position:  0.032889181577480976
Bond Position:  [-8.01526553]


portfolio before change:  [-4.75875343]
curr_Stock_Price:  99.07562332170116
curr_Factors:  [99.07562332]
mat_Sqrt:  [[0.15]]
grads:  [-0.12684507]
Stock Position:  -0.12684507477489898
Bond Position:  [7.80850142]


portfolio before change:  [-4.86204066]
curr_Stock_Price:  99.90529372472673
curr_Factors:  [99.90529372]
mat_Sqrt:  [[0.15]]
grads:  [0.02543024]
Stock Position:  0.025430243141280885
Bond Position:  [-7.40265657]


portfolio before change:  [-4.83966656]
curr_Stock_Price:  100.85789969504495
curr_Factors:  [100.8578997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02329123]
Stock Position:  -0.02329122889290413
Bond Position:  [-2.49056213]


portfolio before change:  [-4.86363794]
curr_Stock_Price:  101.86036560414988
curr_Factors:  [101.8603656]
mat_Sqrt:  [[0.15]]
grads:  [0.03325441]
Stock Position:  0.03325440641658058
Bond Position:  [-8.25094393]


portfolio before change:  [-4.84922579]
curr_Stock_Price:  102.35579290480814
curr_Factors:  [102.3557929]
mat_Sqrt:  [[0.15]]
grads:  [0.04995565]
Stock Position:  0.04995565306004905
Bond Position:  [-9.96247627]


portfolio before change:  [-4.86327756]
curr_Stock_Price:  102.12437096277398
curr_Factors:  [102.12437096]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795147]
Stock Position:  -0.027951466115601897
Bond Position:  [-2.00875166]


portfolio before change:  [-4.84382937]
curr_Stock_Price:  101.41061832572944
curr_Factors:  [101.41061833]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.84382937]
Stock Price:  100.30607856133679
PL:  [-5.14990793]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.89731583e-03]
 [ 6.20348193e-03]
 [ 1.13838194e-03]
 [ 1.34968680e-02]
 [ 2.50019606e-02]
 [ 6.30969095e-03]
 [ 2.87839074e-02]
 [-3.24629867e-03]
 [ 9.43756723e-03]
 [-4.84826881e-03]
 [-1.36718487e-02]
 [-7.78512557e-03]
 [-2.40281346e-02]
 [ 2.00681486e-03]
 [-1.09301835e-02]
 [ 7.74670025e-03]
 [ 7.51019422e-03]
 [-2.61793271e-03]
 [-1.27554772e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.813799]
curr_Stock_Price:  100.39213266597842
curr_Factors:  [100.39213267]
mat_Sqrt:  [[0.15]]
grads:  [0.03931544]
Stock Position:  0.03931543883935311
Bond Position:  [3.86683825]


portfolio before change:  [7.86172121]
curr_Stock_Price:  101.58645697679741
curr_Factors:  [101.58645698]
mat_Sqrt:  [[0.15]]
grads:  [0.04135655]
Stock Position:  0.04135654617671129
Bond Position:  [3.66045622]


portfolio before change:  [7.81229581]
curr_Stock_Price:  100.36922204103566
curr_Factors:  [100.36922204]
mat_Sqrt:  [[0.15]]
grads:  [0.00758921]
Stock Position:  0.007589212910610887
Bond Position:  [7.05057241]


portfolio before change:  [7.82082221]
curr_Stock_Price:  101.26042570284413
curr_Factors:  [101.2604257]
mat_Sqrt:  [[0.15]]
grads:  [0.08997912]
Stock Position:  0.08997912015554327
Bond Position:  [-1.2905018]


portfolio before change:  [7.96592195]
curr_Stock_Price:  102.87660516686313
curr_Factors:  [102.87660517]
mat_Sqrt:  [[0.15]]
grads:  [0.16667974]
Stock Position:  0.1666797374509614
Bond Position:  [-9.18152359]


portfolio before change:  [8.107602]
curr_Stock_Price:  103.74039176727322
curr_Factors:  [103.74039177]
mat_Sqrt:  [[0.15]]
grads:  [0.04206461]
Stock Position:  0.04206460636134183
Bond Position:  [3.74380326]


portfolio before change:  [8.14419257]
curr_Stock_Price:  104.5880045463891
curr_Factors:  [104.58800455]
mat_Sqrt:  [[0.15]]
grads:  [0.19189272]
Stock Position:  0.19189271622014012
Bond Position:  [-11.92548371]


portfolio before change:  [8.12267706]
curr_Stock_Price:  104.49142055011195
curr_Factors:  [104.49142055]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164199]
Stock Position:  -0.02164199112607946
Bond Position:  [10.38407946]


portfolio before change:  [8.12140263]
curr_Stock_Price:  104.67027561375156
curr_Factors:  [104.67027561]
mat_Sqrt:  [[0.15]]
grads:  [0.06291711]
Stock Position:  0.06291711485523782
Bond Position:  [1.53585087]


portfolio before change:  [8.0503194]
curr_Stock_Price:  103.53438066544338
curr_Factors:  [103.53438067]
mat_Sqrt:  [[0.15]]
grads:  [-0.03232179]
Stock Position:  -0.03232179203542686
Bond Position:  [11.39673612]


portfolio before change:  [8.07559391]
curr_Stock_Price:  102.8405772614918
curr_Factors:  [102.84057726]
mat_Sqrt:  [[0.15]]
grads:  [-0.09114566]
Stock Position:  -0.09114565830945233
Bond Position:  [17.44906603]


portfolio before change:  [8.15188562]
curr_Stock_Price:  102.05141298792435
curr_Factors:  [102.05141299]
mat_Sqrt:  [[0.15]]
grads:  [-0.05190084]
Stock Position:  -0.051900837108759895
Bond Position:  [13.44843938]


portfolio before change:  [8.18210056]
curr_Stock_Price:  101.53403387036363
curr_Factors:  [101.53403387]
mat_Sqrt:  [[0.15]]
grads:  [-0.16018756]
Stock Position:  -0.1601875637166489
Bond Position:  [24.44659008]


portfolio before change:  [8.24543056]
curr_Stock_Price:  101.17684268877794
curr_Factors:  [101.17684269]
mat_Sqrt:  [[0.15]]
grads:  [0.01337877]
Stock Position:  0.013378765705577042
Bond Position:  [6.89180929]


portfolio before change:  [8.23146395]
curr_Stock_Price:  100.00410556563601
curr_Factors:  [100.00410557]
mat_Sqrt:  [[0.15]]
grads:  [-0.07286789]
Stock Position:  -0.0728678900799083
Bond Position:  [15.51855212]


portfolio before change:  [8.19982781]
curr_Stock_Price:  100.49151181176504
curr_Factors:  [100.49151181]
mat_Sqrt:  [[0.15]]
grads:  [0.05164467]
Stock Position:  0.05164466830540961
Bond Position:  [3.00997701]


portfolio before change:  [8.20169766]
curr_Stock_Price:  100.51314543611792
curr_Factors:  [100.51314544]
mat_Sqrt:  [[0.15]]
grads:  [0.05006796]
Stock Position:  0.050067961450875734
Bond Position:  [3.16920937]


portfolio before change:  [8.20917848]
curr_Stock_Price:  100.6467323054603
curr_Factors:  [100.64673231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745288]
Stock Position:  -0.017452884720560835
Bond Position:  [9.9657543]


portfolio before change:  [8.21910874]
curr_Stock_Price:  100.22052738461458
curr_Factors:  [100.22052738]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.21910874]
Stock Price:  99.52642265215239
PL:  [8.21910874]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.34276669e-02]
 [ 6.14196296e-03]
 [ 1.12666910e-03]
 [ 1.18994277e-02]
 [ 2.16740429e-02]
 [ 6.70641811e-03]
 [-7.92442094e-03]
 [ 1.22505237e-02]
 [ 3.13869562e-03]
 [ 8.46022905e-03]
 [-1.60749859e-02]
 [-8.69228100e-03]
 [-2.17934802e-02]
 [ 5.30863776e-03]
 [ 3.06106677e-02]
 [ 1.23260613e-03]
 [ 7.48776972e-03]
 [-4.11758080e-03]
 [-1.24572564e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.53054511]
curr_Stock_Price:  101.28199784588934
curr_Factors:  [101.28199785]
mat_Sqrt:  [[0.15]]
grads:  [0.08951778]
Stock Position:  0.08951777907810639
Bond Position:  [12.4640056]


portfolio before change:  [21.55326675]
curr_Stock_Price:  101.50100744624524
curr_Factors:  [101.50100745]
mat_Sqrt:  [[0.15]]
grads:  [0.04094642]
Stock Position:  0.040946419714110095
Bond Position:  [17.3971639]


portfolio before change:  [21.51242245]
curr_Stock_Price:  100.39726912255209
curr_Factors:  [100.39726912]
mat_Sqrt:  [[0.15]]
grads:  [0.00751113]
Stock Position:  0.007511127348608527
Bond Position:  [20.75832578]


portfolio before change:  [21.52241663]
curr_Stock_Price:  101.03684593350503
curr_Factors:  [101.03684593]
mat_Sqrt:  [[0.15]]
grads:  [0.07932952]
Stock Position:  0.07932951780338511
Bond Position:  [13.50721236]


portfolio before change:  [21.55518936]
curr_Stock_Price:  101.4073953604468
curr_Factors:  [101.40739536]
mat_Sqrt:  [[0.15]]
grads:  [0.14449362]
Stock Position:  0.1444936195853468
Bond Position:  [6.90246775]


portfolio before change:  [21.58823496]
curr_Stock_Price:  101.62415075071546
curr_Factors:  [101.62415075]
mat_Sqrt:  [[0.15]]
grads:  [0.04470945]
Stock Position:  0.044709454042961214
Bond Position:  [17.04467466]


portfolio before change:  [21.51352671]
curr_Stock_Price:  99.85785859827278
curr_Factors:  [99.8578586]
mat_Sqrt:  [[0.15]]
grads:  [-0.05282947]
Stock Position:  -0.05282947294049846
Bond Position:  [26.78896474]


portfolio before change:  [21.54143437]
curr_Stock_Price:  99.45638608260762
curr_Factors:  [99.45638608]
mat_Sqrt:  [[0.15]]
grads:  [0.08167016]
Stock Position:  0.08167015825926634
Bond Position:  [13.41881557]


portfolio before change:  [21.60452224]
curr_Stock_Price:  100.18777619870352
curr_Factors:  [100.1877762]
mat_Sqrt:  [[0.15]]
grads:  [0.02092464]
Stock Position:  0.020924637498637596
Bond Position:  [19.50812934]


portfolio before change:  [21.62002921]
curr_Stock_Price:  100.69575780582238
curr_Factors:  [100.69575781]
mat_Sqrt:  [[0.15]]
grads:  [0.05640153]
Stock Position:  0.05640152696912417
Bond Position:  [15.94063471]


portfolio before change:  [21.64899805]
curr_Stock_Price:  101.13871011785967
curr_Factors:  [101.13871012]
mat_Sqrt:  [[0.15]]
grads:  [-0.10716657]
Stock Position:  -0.10716657253221763
Bond Position:  [32.48768697]


portfolio before change:  [21.5906871]
curr_Stock_Price:  101.7586225163251
curr_Factors:  [101.75862252]
mat_Sqrt:  [[0.15]]
grads:  [-0.05794854]
Stock Position:  -0.05794854000721556
Bond Position:  [27.48745071]


portfolio before change:  [21.53699483]
curr_Stock_Price:  102.80377379676054
curr_Factors:  [102.8037738]
mat_Sqrt:  [[0.15]]
grads:  [-0.14528987]
Stock Position:  -0.1452898679140755
Bond Position:  [36.47334155]


portfolio before change:  [21.19260573]
curr_Stock_Price:  105.23689999219108
curr_Factors:  [105.23689999]
mat_Sqrt:  [[0.15]]
grads:  [0.03539092]
Stock Position:  0.03539091837002211
Bond Position:  [17.46817519]


portfolio before change:  [21.18771169]
curr_Stock_Price:  104.97520502088072
curr_Factors:  [104.97520502]
mat_Sqrt:  [[0.15]]
grads:  [0.20407112]
Stock Position:  0.20407111830303873
Bond Position:  [-0.23469579]


portfolio before change:  [21.10480566]
curr_Stock_Price:  104.56923210260057
curr_Factors:  [104.5692321]
mat_Sqrt:  [[0.15]]
grads:  [0.00821737]
Stock Position:  0.008217374223852473
Bond Position:  [20.24552115]


portfolio before change:  [21.09039517]
curr_Stock_Price:  102.19955758991782
curr_Factors:  [102.19955759]
mat_Sqrt:  [[0.15]]
grads:  [0.04991846]
Stock Position:  0.04991846478857697
Bond Position:  [15.98875015]


portfolio before change:  [21.08765651]
curr_Stock_Price:  102.06461053873623
curr_Factors:  [102.06461054]
mat_Sqrt:  [[0.15]]
grads:  [-0.02745054]
Stock Position:  -0.027450538672063006
Bond Position:  [23.88938505]


portfolio before change:  [21.12369844]
curr_Stock_Price:  100.96922800948255
curr_Factors:  [100.96922801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.12369844]
Stock Price:  101.63016118206433
PL:  [19.49353726]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.34630507e-02]
 [ 6.51164657e-03]
 [ 1.05045119e-03]
 [ 1.42066410e-02]
 [ 1.88973932e-02]
 [ 3.25807638e-03]
 [-1.19404009e-02]
 [ 1.25120002e-02]
 [ 4.12047476e-03]
 [ 1.13831168e-02]
 [-1.70985500e-02]
 [ 6.10579822e-03]
 [-8.35261912e-03]
 [-4.10518257e-04]
 [-1.67737015e-02]
 [ 7.26399520e-03]
 [ 4.45924359e-03]
 [-1.93313063e-03]
 [-1.28032397e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.15538316]
curr_Stock_Price:  102.03615182098955
curr_Factors:  [102.03615182]
mat_Sqrt:  [[0.15]]
grads:  [0.15642034]
Stock Position:  0.15642033777046022
Bond Position:  [17.19485382]


portfolio before change:  [33.15629501]
curr_Stock_Price:  102.01449607769551
curr_Factors:  [102.01449608]
mat_Sqrt:  [[0.15]]
grads:  [0.04341098]
Stock Position:  0.04341097715101712
Bond Position:  [28.72774605]


portfolio before change:  [33.14097215]
curr_Stock_Price:  101.49606294055778
curr_Factors:  [101.49606294]
mat_Sqrt:  [[0.15]]
grads:  [0.00700301]
Stock Position:  0.0070030079663379
Bond Position:  [32.43019442]


portfolio before change:  [33.1518708]
curr_Stock_Price:  101.89447530724482
curr_Factors:  [101.89447531]
mat_Sqrt:  [[0.15]]
grads:  [0.09471094]
Stock Position:  0.09471093992734193
Bond Position:  [23.50134927]


portfolio before change:  [33.07984303]
curr_Stock_Price:  101.07193202800464
curr_Factors:  [101.07193203]
mat_Sqrt:  [[0.15]]
grads:  [0.12598262]
Stock Position:  0.1259826211877554
Bond Position:  [20.3465361]


portfolio before change:  [32.92883506]
curr_Stock_Price:  99.83291001687991
curr_Factors:  [99.83291002]
mat_Sqrt:  [[0.15]]
grads:  [0.02172051]
Stock Position:  0.021720509176702936
Bond Position:  [30.76041342]


portfolio before change:  [32.93178434]
curr_Stock_Price:  99.61460094837693
curr_Factors:  [99.61460095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07960267]
Stock Position:  -0.07960267267785487
Bond Position:  [40.86137281]


portfolio before change:  [32.93209946]
curr_Stock_Price:  99.73898740725268
curr_Factors:  [99.73898741]
mat_Sqrt:  [[0.15]]
grads:  [0.08341333]
Stock Position:  0.08341333492919707
Bond Position:  [24.6125379]


portfolio before change:  [33.03352028]
curr_Stock_Price:  100.8810939923381
curr_Factors:  [100.88109399]
mat_Sqrt:  [[0.15]]
grads:  [0.02746983]
Stock Position:  0.027469831753206393
Bond Position:  [30.26233361]


portfolio before change:  [32.99954634]
curr_Stock_Price:  99.36887227205298
curr_Factors:  [99.36887227]
mat_Sqrt:  [[0.15]]
grads:  [0.07588745]
Stock Position:  0.07588744503432768
Bond Position:  [25.4586965]


portfolio before change:  [33.06704003]
curr_Stock_Price:  100.17438400284883
curr_Factors:  [100.174384]
mat_Sqrt:  [[0.15]]
grads:  [-0.11399033]
Stock Position:  -0.11399033341322115
Bond Position:  [44.48595147]


portfolio before change:  [33.22589239]
curr_Stock_Price:  98.87840154114095
curr_Factors:  [98.87840154]
mat_Sqrt:  [[0.15]]
grads:  [0.04070532]
Stock Position:  0.0407053214462643
Bond Position:  [29.20101527]


portfolio before change:  [33.18807557]
curr_Stock_Price:  97.7699965132339
curr_Factors:  [97.76999651]
mat_Sqrt:  [[0.15]]
grads:  [-0.05568413]
Stock Position:  -0.055684127456262084
Bond Position:  [38.63231252]


portfolio before change:  [33.19520886]
curr_Stock_Price:  97.81535940641196
curr_Factors:  [97.81535941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273679]
Stock Position:  -0.0027367883769515516
Bond Position:  [33.4629088]


portfolio before change:  [33.20286177]
curr_Stock_Price:  98.07619934403897
curr_Factors:  [98.07619934]
mat_Sqrt:  [[0.15]]
grads:  [-0.11182468]
Stock Position:  -0.11182467685842343
Bond Position:  [44.17020107]


portfolio before change:  [33.30123819]
curr_Stock_Price:  97.29522241078055
curr_Factors:  [97.29522241]
mat_Sqrt:  [[0.15]]
grads:  [0.04842663]
Stock Position:  0.04842663465785668
Bond Position:  [28.589558]


portfolio before change:  [33.3428235]
curr_Stock_Price:  98.00633987686116
curr_Factors:  [98.00633988]
mat_Sqrt:  [[0.15]]
grads:  [0.02972829]
Stock Position:  0.029728290627554246
Bond Position:  [30.42926255]


portfolio before change:  [33.35101459]
curr_Stock_Price:  98.02594474489723
curr_Factors:  [98.02594474]
mat_Sqrt:  [[0.15]]
grads:  [-0.01288754]
Stock Position:  -0.012887537553654871
Bond Position:  [34.61432763]


portfolio before change:  [33.34651335]
curr_Stock_Price:  99.04676858947333
curr_Factors:  [99.04676859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.34651335]
Stock Price:  98.0164098760897
PL:  [33.34651335]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.12572738e-02]
 [ 5.30131734e-03]
 [-2.97015746e-03]
 [ 5.23365094e-04]
 [-1.66256585e-03]
 [-5.30721624e-04]
 [-5.44123797e-04]
 [-7.95884965e-04]
 [ 4.51826178e-03]
 [-2.08390591e-02]
 [-1.73603600e-02]
 [ 1.04095773e-02]
 [ 2.02515235e-02]
 [-8.61742198e-04]
 [-1.34991183e-02]
 [ 7.70046042e-03]
 [ 7.42370480e-03]
 [-4.27941027e-03]
 [-1.28649676e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.77773156]
curr_Stock_Price:  98.73189839700073
curr_Factors:  [98.7318984]
mat_Sqrt:  [[0.15]]
grads:  [0.14171516]
Stock Position:  0.14171515857956882
Bond Position:  [-31.7695382]


portfolio before change:  [-17.80752035]
curr_Stock_Price:  98.57774827630914
curr_Factors:  [98.57774828]
mat_Sqrt:  [[0.15]]
grads:  [0.03534212]
Stock Position:  0.03534211561093673
Bond Position:  [-21.29146652]


portfolio before change:  [-17.85994046]
curr_Stock_Price:  97.24515751692563
curr_Factors:  [97.24515752]
mat_Sqrt:  [[0.15]]
grads:  [-0.01980105]
Stock Position:  -0.019801049718402842
Bond Position:  [-15.93438426]


portfolio before change:  [-17.87305156]
curr_Stock_Price:  97.70609310759532
curr_Factors:  [97.70609311]
mat_Sqrt:  [[0.15]]
grads:  [0.0034891]
Stock Position:  0.0034891006284306037
Bond Position:  [-18.21395795]


portfolio before change:  [-17.8798232]
curr_Stock_Price:  97.07051771801504
curr_Factors:  [97.07051772]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108377]
Stock Position:  -0.01108377230802179
Bond Position:  [-16.80391569]


portfolio before change:  [-17.87529523]
curr_Stock_Price:  96.28292718696284
curr_Factors:  [96.28292719]
mat_Sqrt:  [[0.15]]
grads:  [-0.00353814]
Stock Position:  -0.0035381441575971923
Bond Position:  [-17.53463236]


portfolio before change:  [-17.87751304]
curr_Stock_Price:  95.67062811918409
curr_Factors:  [95.67062812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00362749]
Stock Position:  -0.0036274919830393366
Bond Position:  [-17.5304686]


portfolio before change:  [-17.879961]
curr_Stock_Price:  95.13714694925898
curr_Factors:  [95.13714695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053059]
Stock Position:  -0.005305899766821371
Bond Position:  [-17.37517284]


portfolio before change:  [-17.88262659]
curr_Stock_Price:  94.82075392499358
curr_Factors:  [94.82075392]
mat_Sqrt:  [[0.15]]
grads:  [0.03012175]
Stock Position:  0.030121745216993078
Bond Position:  [-20.73879318]


portfolio before change:  [-17.90360214]
curr_Stock_Price:  94.29654129534704
curr_Factors:  [94.2965413]
mat_Sqrt:  [[0.15]]
grads:  [-0.13892706]
Stock Position:  -0.13892706043404152
Bond Position:  [-4.80326085]


portfolio before change:  [-17.83718826]
curr_Stock_Price:  93.8098482278333
curr_Factors:  [93.80984823]
mat_Sqrt:  [[0.15]]
grads:  [-0.11573573]
Stock Position:  -0.1157357335750814
Bond Position:  [-6.98003666]


portfolio before change:  [-17.82393085]
curr_Stock_Price:  93.68021979979473
curr_Factors:  [93.6802198]
mat_Sqrt:  [[0.15]]
grads:  [0.06939718]
Stock Position:  0.06939718179115467
Bond Position:  [-24.32507409]


portfolio before change:  [-17.78123804]
curr_Stock_Price:  94.38305582609811
curr_Factors:  [94.38305583]
mat_Sqrt:  [[0.15]]
grads:  [0.13501016]
Stock Position:  0.13501015673186764
Bond Position:  [-30.5239092]


portfolio before change:  [-17.35234106]
curr_Stock_Price:  97.61636003448079
curr_Factors:  [97.61636003]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574495]
Stock Position:  -0.005744947986727451
Bond Position:  [-16.79154015]


portfolio before change:  [-17.36724958]
curr_Stock_Price:  99.48062594737534
curr_Factors:  [99.48062595]
mat_Sqrt:  [[0.15]]
grads:  [-0.08999412]
Stock Position:  -0.08999412192734078
Bond Position:  [-8.414578]


portfolio before change:  [-17.46884803]
curr_Stock_Price:  100.58619303447203
curr_Factors:  [100.58619303]
mat_Sqrt:  [[0.15]]
grads:  [0.0513364]
Stock Position:  0.05133640282183601
Bond Position:  [-22.63258135]


portfolio before change:  [-17.34446655]
curr_Stock_Price:  103.11929475050583
curr_Factors:  [103.11929475]
mat_Sqrt:  [[0.15]]
grads:  [0.04949137]
Stock Position:  0.04949136531603663
Bond Position:  [-22.44798124]


portfolio before change:  [-17.39590708]
curr_Stock_Price:  102.19331843897672
curr_Factors:  [102.19331844]
mat_Sqrt:  [[0.15]]
grads:  [-0.0285294]
Stock Position:  -0.028529401823870742
Bond Position:  [-14.48039284]


portfolio before change:  [-17.33264241]
curr_Stock_Price:  99.84888713757036
curr_Factors:  [99.84888714]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.33264241]
Stock Price:  97.96131845424941
PL:  [-17.33264241]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.28651096e-02]
 [ 1.05136517e-02]
 [ 1.44958789e-03]
 [ 2.97756962e-03]
 [ 1.55447321e-03]
 [ 1.88676565e-03]
 [-4.45213291e-03]
 [ 6.79265296e-03]
 [ 4.73287389e-03]
 [ 5.78001295e-03]
 [-1.76024080e-02]
 [ 8.10444582e-03]
 [ 2.87629383e-02]
 [-4.13227056e-03]
 [-1.60327050e-02]
 [ 5.77430784e-03]
 [ 1.44184298e-03]
 [-5.77752525e-03]
 [-1.08988376e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.83208839]
curr_Stock_Price:  98.14450275639285
curr_Factors:  [98.14450276]
mat_Sqrt:  [[0.15]]
grads:  [0.21910073]
Stock Position:  0.2191007309377238
Bond Position:  [-48.33562068]


portfolio before change:  [-26.50354677]
curr_Stock_Price:  99.69916225041027
curr_Factors:  [99.69916225]
mat_Sqrt:  [[0.15]]
grads:  [0.07009101]
Stock Position:  0.0700910112699267
Bond Position:  [-33.49156188]


portfolio before change:  [-26.50695252]
curr_Stock_Price:  99.77004421479
curr_Factors:  [99.77004421]
mat_Sqrt:  [[0.15]]
grads:  [0.00966392]
Stock Position:  0.009663919257892143
Bond Position:  [-27.47112217]


portfolio before change:  [-26.51893118]
curr_Stock_Price:  99.24127074479158
curr_Factors:  [99.24127074]
mat_Sqrt:  [[0.15]]
grads:  [0.01985046]
Stock Position:  0.019850464110691426
Bond Position:  [-28.48891647]


portfolio before change:  [-26.54000473]
curr_Stock_Price:  98.53849507530037
curr_Factors:  [98.53849508]
mat_Sqrt:  [[0.15]]
grads:  [0.01036315]
Stock Position:  0.01036315473754443
Bond Position:  [-27.5611744]


portfolio before change:  [-26.56096525]
curr_Stock_Price:  97.18086106538098
curr_Factors:  [97.18086107]
mat_Sqrt:  [[0.15]]
grads:  [0.01257844]
Stock Position:  0.012578437693924397
Bond Position:  [-27.78334866]


portfolio before change:  [-26.57109653]
curr_Stock_Price:  96.92768445552448
curr_Factors:  [96.92768446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02968089]
Stock Position:  -0.029680886062595134
Bond Position:  [-23.69419697]


portfolio before change:  [-26.5780175]
curr_Stock_Price:  96.96126449354365
curr_Factors:  [96.96126449]
mat_Sqrt:  [[0.15]]
grads:  [0.04528435]
Stock Position:  0.04528435304457456
Bond Position:  [-30.96884563]


portfolio before change:  [-26.53573147]
curr_Stock_Price:  98.06604372888873
curr_Factors:  [98.06604373]
mat_Sqrt:  [[0.15]]
grads:  [0.03155249]
Stock Position:  0.03155249261061194
Bond Position:  [-29.62995959]


portfolio before change:  [-26.55567058]
curr_Stock_Price:  97.66890574763151
curr_Factors:  [97.66890575]
mat_Sqrt:  [[0.15]]
grads:  [0.03853342]
Stock Position:  0.038533419643142636
Bond Position:  [-30.31918751]


portfolio before change:  [-26.63687573]
curr_Stock_Price:  95.75824203379639
curr_Factors:  [95.75824203]
mat_Sqrt:  [[0.15]]
grads:  [-0.11734939]
Stock Position:  -0.1173493864186172
Bond Position:  [-15.39970478]


portfolio before change:  [-26.56604213]
curr_Stock_Price:  95.12181769183569
curr_Factors:  [95.12181769]
mat_Sqrt:  [[0.15]]
grads:  [0.05402964]
Stock Position:  0.05402963877809062
Bond Position:  [-31.70543958]


portfolio before change:  [-26.67048646]
curr_Stock_Price:  93.33544664148239
curr_Factors:  [93.33544664]
mat_Sqrt:  [[0.15]]
grads:  [0.19175292]
Stock Position:  0.19175292197318902
Bond Position:  [-44.56783108]


portfolio before change:  [-26.5061348]
curr_Stock_Price:  94.25066092699238
curr_Factors:  [94.25066093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754847]
Stock Position:  -0.027548470381693297
Bond Position:  [-23.90967326]


portfolio before change:  [-26.5020397]
curr_Stock_Price:  93.88500505071286
curr_Factors:  [93.88500505]
mat_Sqrt:  [[0.15]]
grads:  [-0.1068847]
Stock Position:  -0.10688470030372324
Bond Position:  [-16.46716908]


portfolio before change:  [-26.32010698]
curr_Stock_Price:  92.14434399830247
curr_Factors:  [92.144344]
mat_Sqrt:  [[0.15]]
grads:  [0.03849539]
Stock Position:  0.03849538562206794
Bond Position:  [-29.86723903]


portfolio before change:  [-26.32170844]
curr_Stock_Price:  92.29673307134816
curr_Factors:  [92.29673307]
mat_Sqrt:  [[0.15]]
grads:  [0.00961229]
Stock Position:  0.009612286501943866
Bond Position:  [-27.20889108]


portfolio before change:  [-26.3244893]
curr_Stock_Price:  92.71517889473276
curr_Factors:  [92.71517889]
mat_Sqrt:  [[0.15]]
grads:  [-0.03851683]
Stock Position:  -0.038516834968735904
Bond Position:  [-22.75339405]


portfolio before change:  [-26.29499925]
curr_Stock_Price:  91.80183536970229
curr_Factors:  [91.80183537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.29499925]
Stock Price:  90.70365470221486
PL:  [-26.29499925]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.18884939e-03]
 [ 9.70639665e-03]
 [ 1.31203852e-03]
 [ 2.77430370e-03]
 [ 2.56884028e-03]
 [ 4.28730690e-03]
 [-7.84727489e-03]
 [ 1.22595618e-02]
 [ 7.05364882e-03]
 [ 9.32538323e-03]
 [-1.66394800e-02]
 [-4.37738061e-03]
 [-2.20007705e-02]
 [ 4.27324638e-03]
 [ 2.01081317e-02]
 [ 2.03918004e-03]
 [ 7.48176262e-03]
 [-4.37817021e-03]
 [-1.17038639e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.65166335]
curr_Stock_Price:  99.5834437243043
curr_Factors:  [99.58344372]
mat_Sqrt:  [[0.15]]
grads:  [0.021259]
Stock Position:  0.02125899592457732
Bond Position:  [-6.76870737]


portfolio before change:  [-4.65686494]
curr_Stock_Price:  99.41837435806929
curr_Factors:  [99.41837436]
mat_Sqrt:  [[0.15]]
grads:  [0.06470931]
Stock Position:  0.06470931102255469
Bond Position:  [-11.09015945]


portfolio before change:  [-4.62091354]
curr_Stock_Price:  100.01680897364758
curr_Factors:  [100.01680897]
mat_Sqrt:  [[0.15]]
grads:  [0.00874692]
Stock Position:  0.008746923496961432
Bond Position:  [-5.49575291]


portfolio before change:  [-4.63128674]
curr_Stock_Price:  98.98797961935871
curr_Factors:  [98.98797962]
mat_Sqrt:  [[0.15]]
grads:  [0.01849536]
Stock Position:  0.018495358016072348
Bond Position:  [-6.46210486]


portfolio before change:  [-4.63445292]
curr_Stock_Price:  98.90415059157202
curr_Factors:  [98.90415059]
mat_Sqrt:  [[0.15]]
grads:  [0.0171256]
Stock Position:  0.017125601896641814
Bond Position:  [-6.32824602]


portfolio before change:  [-4.64668456]
curr_Stock_Price:  98.28231030044802
curr_Factors:  [98.2823103]
mat_Sqrt:  [[0.15]]
grads:  [0.02858205]
Stock Position:  0.028582045987177
Bond Position:  [-7.45579408]


portfolio before change:  [-4.64970447]
curr_Stock_Price:  98.24187484714102
curr_Factors:  [98.24187485]
mat_Sqrt:  [[0.15]]
grads:  [-0.05231517]
Stock Position:  -0.05231516595933341
Bond Position:  [0.48983551]


portfolio before change:  [-4.7105521]
curr_Stock_Price:  99.40731321921712
curr_Factors:  [99.40731322]
mat_Sqrt:  [[0.15]]
grads:  [0.08173041]
Stock Position:  0.08173041170843075
Bond Position:  [-12.83515274]


portfolio before change:  [-4.47539889]
curr_Stock_Price:  102.3237600484702
curr_Factors:  [102.32376005]
mat_Sqrt:  [[0.15]]
grads:  [0.04702433]
Stock Position:  0.0470243254709215
Bond Position:  [-9.28710469]


portfolio before change:  [-4.5206251]
curr_Stock_Price:  101.41137824638189
curr_Factors:  [101.41137825]
mat_Sqrt:  [[0.15]]
grads:  [0.06216922]
Stock Position:  0.062169221545788356
Bond Position:  [-10.82529154]


portfolio before change:  [-4.56977245]
curr_Stock_Price:  100.66437368531298
curr_Factors:  [100.66437369]
mat_Sqrt:  [[0.15]]
grads:  [-0.11092987]
Stock Position:  -0.11092986671291663
Bond Position:  [6.59691311]


portfolio before change:  [-4.5790198]
curr_Stock_Price:  100.76260501419294
curr_Factors:  [100.76260501]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918254]
Stock Position:  -0.029182537406342076
Bond Position:  [-1.63851131]


portfolio before change:  [-4.63465851]
curr_Stock_Price:  102.65514192299393
curr_Factors:  [102.65514192]
mat_Sqrt:  [[0.15]]
grads:  [-0.1466718]
Stock Position:  -0.1466718031074241
Bond Position:  [10.42195625]


portfolio before change:  [-4.86975405]
curr_Stock_Price:  104.27577619774979
curr_Factors:  [104.2757762]
mat_Sqrt:  [[0.15]]
grads:  [0.02848831]
Stock Position:  0.02848830917605423
Bond Position:  [-7.8403946]


portfolio before change:  [-4.89382032]
curr_Stock_Price:  103.49981126946535
curr_Factors:  [103.49981127]
mat_Sqrt:  [[0.15]]
grads:  [0.13405421]
Stock Position:  0.13405421128333206
Bond Position:  [-18.76840589]


portfolio before change:  [-4.8864055]
curr_Stock_Price:  103.59012924510053
curr_Factors:  [103.59012925]
mat_Sqrt:  [[0.15]]
grads:  [0.01359453]
Stock Position:  0.013594533583097802
Bond Position:  [-6.29466499]


portfolio before change:  [-4.90917078]
curr_Stock_Price:  102.03131070038378
curr_Factors:  [102.0313107]
mat_Sqrt:  [[0.15]]
grads:  [0.04987842]
Stock Position:  0.049878417434323426
Bond Position:  [-9.99833108]


portfolio before change:  [-4.89967219]
curr_Stock_Price:  102.27186521956573
curr_Factors:  [102.27186522]
mat_Sqrt:  [[0.15]]
grads:  [-0.0291878]
Stock Position:  -0.02918780140239138
Bond Position:  [-1.9145813]


portfolio before change:  [-4.91957456]
curr_Stock_Price:  102.93733712129126
curr_Factors:  [102.93733712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.91957456]
Stock Price:  102.83362497238613
PL:  [-7.75319953]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.15595536e-02]
 [ 2.53790467e-03]
 [-1.28075634e-03]
 [-1.48261033e-03]
 [-3.28349598e-03]
 [-1.08092210e-03]
 [-2.48568663e-03]
 [ 6.88435632e-03]
 [ 4.68028472e-03]
 [ 1.31414153e-02]
 [-1.81678502e-02]
 [ 6.02598700e-03]
 [-2.04830273e-02]
 [ 7.90443040e-04]
 [-1.56888545e-02]
 [ 7.94423787e-03]
 [ 5.08384133e-03]
 [-1.77361446e-03]
 [-1.28063087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.66869769]
curr_Stock_Price:  99.1930924480198
curr_Factors:  [99.19309245]
mat_Sqrt:  [[0.15]]
grads:  [0.07706369]
Stock Position:  0.07706369089489833
Bond Position:  [-18.31288351]


portfolio before change:  [-10.7601675]
curr_Stock_Price:  98.06557035440748
curr_Factors:  [98.06557035]
mat_Sqrt:  [[0.15]]
grads:  [0.01691936]
Stock Position:  0.016919364444198202
Bond Position:  [-12.41937462]


portfolio before change:  [-10.75908335]
curr_Stock_Price:  98.31317913362653
curr_Factors:  [98.31317913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00853838]
Stock Position:  -0.008538375623376934
Bond Position:  [-9.91964849]


portfolio before change:  [-10.74658266]
curr_Stock_Price:  96.55864088512408
curr_Factors:  [96.55864089]
mat_Sqrt:  [[0.15]]
grads:  [-0.00988407]
Stock Position:  -0.009884068836306555
Bond Position:  [-9.79219041]


portfolio before change:  [-10.75016676]
curr_Stock_Price:  96.67354788148953
curr_Factors:  [96.67354788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188997]
Stock Position:  -0.021889973172459505
Bond Position:  [-8.63398539]


portfolio before change:  [-10.73930137]
curr_Stock_Price:  96.07856472819363
curr_Factors:  [96.07856473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720615]
Stock Position:  -0.007206147307154988
Bond Position:  [-10.04694507]


portfolio before change:  [-10.74300339]
curr_Stock_Price:  96.24369808214443
curr_Factors:  [96.24369808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01657124]
Stock Position:  -0.01657124419952939
Bond Position:  [-9.14812557]


portfolio before change:  [-10.75763584]
curr_Stock_Price:  96.98867151759067
curr_Factors:  [96.98867152]
mat_Sqrt:  [[0.15]]
grads:  [0.04589571]
Stock Position:  0.04589570880874797
Bond Position:  [-15.20899967]


portfolio before change:  [-10.74848969]
curr_Stock_Price:  97.27080850624428
curr_Factors:  [97.27080851]
mat_Sqrt:  [[0.15]]
grads:  [0.0312019]
Stock Position:  0.03120189812110075
Bond Position:  [-13.78352355]


portfolio before change:  [-10.69748547]
curr_Stock_Price:  99.01591163784028
curr_Factors:  [99.01591164]
mat_Sqrt:  [[0.15]]
grads:  [0.08760944]
Stock Position:  0.08760943524845069
Bond Position:  [-19.37221357]


portfolio before change:  [-10.7998282]
curr_Stock_Price:  97.90302850800471
curr_Factors:  [97.90302851]
mat_Sqrt:  [[0.15]]
grads:  [-0.121119]
Stock Position:  -0.1211190012765495
Bond Position:  [1.05808884]


portfolio before change:  [-10.90779018]
curr_Stock_Price:  98.79658392490846
curr_Factors:  [98.79658392]
mat_Sqrt:  [[0.15]]
grads:  [0.04017325]
Stock Position:  0.040173246671700025
Bond Position:  [-14.87676972]


portfolio before change:  [-10.89311906]
curr_Stock_Price:  99.25437056495291
curr_Factors:  [99.25437056]
mat_Sqrt:  [[0.15]]
grads:  [-0.13655352]
Stock Position:  -0.13655351547538414
Bond Position:  [2.66041416]


portfolio before change:  [-10.77321914]
curr_Stock_Price:  98.3811983665536
curr_Factors:  [98.38119837]
mat_Sqrt:  [[0.15]]
grads:  [0.00526962]
Stock Position:  0.00526962026628128
Bond Position:  [-11.2916507]


portfolio before change:  [-10.77326019]
curr_Stock_Price:  98.90917174541698
curr_Factors:  [98.90917175]
mat_Sqrt:  [[0.15]]
grads:  [-0.10459236]
Stock Position:  -0.10459236337051633
Bond Position:  [-0.42811616]


portfolio before change:  [-10.79399697]
curr_Stock_Price:  99.10641118193146
curr_Factors:  [99.10641118]
mat_Sqrt:  [[0.15]]
grads:  [0.05296159]
Stock Position:  0.05296158581337744
Bond Position:  [-16.04282967]


portfolio before change:  [-10.80639743]
curr_Stock_Price:  98.94800856163872
curr_Factors:  [98.94800856]
mat_Sqrt:  [[0.15]]
grads:  [0.03389228]
Stock Position:  0.03389227552645393
Bond Position:  [-14.1599706]


portfolio before change:  [-10.80103261]
curr_Stock_Price:  99.21076028688127
curr_Factors:  [99.21076029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0118241]
Stock Position:  -0.01182409639078491
Bond Position:  [-9.62795502]


portfolio before change:  [-10.80373525]
curr_Stock_Price:  99.23573879967704
curr_Factors:  [99.2357388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.80373525]
Stock Price:  99.03044673898505
PL:  [-10.80373525]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.3121614 ]
 [ 0.00631557]
 [ 0.00646978]
 [ 0.00258633]
 [ 0.0188332 ]
 [ 0.01921747]
 [ 0.00396426]
 [ 0.0127785 ]
 [-0.02056021]
 [ 0.01276793]
 [-0.05796521]
 [-0.00375411]
 [-0.04623824]
 [-0.00891008]
 [ 0.01482972]
 [ 0.08465166]
 [-0.0037615 ]
 [ 0.00429698]
 [-0.00780578]
 [-0.00767528]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.85437098]
curr_Stock_Price:  100.71913656764431
curr_Factors:  [100.71913657]
mat_Sqrt:  [[0.15]]
grads:  [0.04210377]
Stock Position:  0.04210377447962599
Bond Position:  [8.61371517]


portfolio before change:  [12.90861568]
curr_Stock_Price:  101.9563414980649
curr_Factors:  [101.9563415]
mat_Sqrt:  [[0.15]]
grads:  [0.04313186]
Stock Position:  0.04313185645984596
Bond Position:  [8.51104939]


portfolio before change:  [13.00845174]
curr_Stock_Price:  104.22167478911038
curr_Factors:  [104.22167479]
mat_Sqrt:  [[0.15]]
grads:  [0.01724218]
Stock Position:  0.017242181092017545
Bond Position:  [11.21144275]


portfolio before change:  [13.04393848]
curr_Stock_Price:  106.11723146806374
curr_Factors:  [106.11723147]
mat_Sqrt:  [[0.15]]
grads:  [0.12555469]
Stock Position:  0.12555469023069696
Bond Position:  [-0.27957764]


portfolio before change:  [13.16215361]
curr_Stock_Price:  107.05933116738257
curr_Factors:  [107.05933117]
mat_Sqrt:  [[0.15]]
grads:  [0.12811644]
Stock Position:  0.12811644439958125
Bond Position:  [-0.55390724]


portfolio before change:  [13.28267668]
curr_Stock_Price:  108.00114278816503
curr_Factors:  [108.00114279]
mat_Sqrt:  [[0.15]]
grads:  [0.02642842]
Stock Position:  0.026428422261678883
Bond Position:  [10.42837687]


portfolio before change:  [13.32181086]
curr_Stock_Price:  109.38324420317193
curr_Factors:  [109.3832442]
mat_Sqrt:  [[0.15]]
grads:  [0.08519]
Stock Position:  0.08518999895180726
Bond Position:  [4.0034524]


portfolio before change:  [13.23759315]
curr_Stock_Price:  108.38290736673565
curr_Factors:  [108.38290737]
mat_Sqrt:  [[0.15]]
grads:  [-0.13706807]
Stock Position:  -0.13706807086552478
Bond Position:  [28.09342918]


portfolio before change:  [13.21678228]
curr_Stock_Price:  108.58598243601523
curr_Factors:  [108.58598244]
mat_Sqrt:  [[0.15]]
grads:  [0.0851195]
Stock Position:  0.08511950231858838
Bond Position:  [3.97399749]


portfolio before change:  [13.35096917]
curr_Stock_Price:  110.15076209809801
curr_Factors:  [110.1507621]
mat_Sqrt:  [[0.15]]
grads:  [-0.38643472]
Stock Position:  -0.3864347178290039
Bond Position:  [55.91704784]


portfolio before change:  [13.54241484]
curr_Stock_Price:  109.6915262882019
curr_Factors:  [109.69152629]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502741]
Stock Position:  -0.02502741258138103
Bond Position:  [16.28770992]


portfolio before change:  [13.55459915]
curr_Stock_Price:  109.36740652694772
curr_Factors:  [109.36740653]
mat_Sqrt:  [[0.15]]
grads:  [-0.30825496]
Stock Position:  -0.30825495578519435
Bond Position:  [47.26764422]


portfolio before change:  [12.60025688]
curr_Stock_Price:  112.50169729812983
curr_Factors:  [112.5016973]
mat_Sqrt:  [[0.15]]
grads:  [-0.05940055]
Stock Position:  -0.05940054669846341
Bond Position:  [19.2829192]


portfolio before change:  [12.59944581]
curr_Stock_Price:  112.59651793230026
curr_Factors:  [112.59651793]
mat_Sqrt:  [[0.15]]
grads:  [0.09886479]
Stock Position:  0.09886478744209841
Bond Position:  [1.467615]


portfolio before change:  [12.59387058]
curr_Stock_Price:  112.5364138366942
curr_Factors:  [112.53641384]
mat_Sqrt:  [[0.15]]
grads:  [0.56434438]
Stock Position:  0.5643443784589416
Bond Position:  [-50.91542194]


portfolio before change:  [12.99059806]
curr_Stock_Price:  113.26196004882284
curr_Factors:  [113.26196005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507666]
Stock Position:  -0.025076658878854845
Bond Position:  [15.8308296]


portfolio before change:  [13.01148081]
curr_Stock_Price:  112.58704757781683
curr_Factors:  [112.58704758]
mat_Sqrt:  [[0.15]]
grads:  [0.02864651]
Stock Position:  0.02864650690621891
Bond Position:  [9.78625518]


portfolio before change:  [12.99499479]
curr_Stock_Price:  111.92613314110083
curr_Factors:  [111.92613314]
mat_Sqrt:  [[0.15]]
grads:  [-0.05203851]
Stock Position:  -0.05203851413955011
Bond Position:  [18.81946446]


portfolio before change:  [12.94710411]
curr_Stock_Price:  112.93684880746537
curr_Factors:  [112.93684881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.94710411]
Stock Price:  113.00541005739694
PL:  [-0.05830595]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.87308673e-03]
 [-5.57846507e-03]
 [-5.15748337e-03]
 [-5.10739310e-03]
 [-1.62579051e-02]
 [-1.03261804e-02]
 [ 7.84799110e-03]
 [-8.79334913e-03]
 [ 4.53236419e-03]
 [-1.17505056e-02]
 [-1.77674527e-02]
 [ 5.59977580e-03]
 [-1.42306064e-02]
 [ 4.15253471e-03]
 [-1.02202197e-02]
 [ 7.81712883e-03]
 [ 7.52338552e-03]
 [-1.68710567e-03]
 [-1.28063607e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.48931844]
curr_Stock_Price:  99.26960392657601
curr_Factors:  [99.26960393]
mat_Sqrt:  [[0.15]]
grads:  [0.06582058]
Stock Position:  0.06582057821239604
Bond Position:  [-16.02330117]


portfolio before change:  [-9.70263672]
curr_Stock_Price:  96.08956572829509
curr_Factors:  [96.08956573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03718977]
Stock Position:  -0.03718976715280491
Bond Position:  [-6.12908815]


portfolio before change:  [-9.69496398]
curr_Stock_Price:  95.84204578233687
curr_Factors:  [95.84204578]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438322]
Stock Position:  -0.03438322247415206
Bond Position:  [-6.39960559]


portfolio before change:  [-9.64991146]
curr_Stock_Price:  94.4852031886865
curr_Factors:  [94.48520319]
mat_Sqrt:  [[0.15]]
grads:  [-0.03404929]
Stock Position:  -0.03404928734912278
Bond Position:  [-6.43275762]


portfolio before change:  [-9.64333494]
curr_Stock_Price:  94.24481908647513
curr_Factors:  [94.24481909]
mat_Sqrt:  [[0.15]]
grads:  [-0.10838603]
Stock Position:  -0.10838603378975331
Bond Position:  [0.5714872]


portfolio before change:  [-9.49117842]
curr_Stock_Price:  92.84229863450247
curr_Factors:  [92.84229863]
mat_Sqrt:  [[0.15]]
grads:  [-0.0688412]
Stock Position:  -0.06884120260890565
Bond Position:  [-3.09980293]


portfolio before change:  [-9.51613878]
curr_Stock_Price:  93.1936189314252
curr_Factors:  [93.19361893]
mat_Sqrt:  [[0.15]]
grads:  [0.05231994]
Stock Position:  0.052319940680674304
Bond Position:  [-14.3920234]


portfolio before change:  [-9.51609182]
curr_Stock_Price:  93.26329449438121
curr_Factors:  [93.26329449]
mat_Sqrt:  [[0.15]]
grads:  [-0.05862233]
Stock Position:  -0.058622327503290786
Bond Position:  [-4.04878042]


portfolio before change:  [-9.62090734]
curr_Stock_Price:  95.03400559912828
curr_Factors:  [95.0340056]
mat_Sqrt:  [[0.15]]
grads:  [0.03021576]
Stock Position:  0.030215761251119473
Bond Position:  [-12.49243217]


portfolio before change:  [-9.60795187]
curr_Stock_Price:  95.5661441992096
curr_Factors:  [95.5661442]
mat_Sqrt:  [[0.15]]
grads:  [-0.0783367]
Stock Position:  -0.0783367040925698
Bond Position:  [-2.12161511]


portfolio before change:  [-9.70496882]
curr_Stock_Price:  96.79783353703661
curr_Factors:  [96.79783354]
mat_Sqrt:  [[0.15]]
grads:  [-0.11844968]
Stock Position:  -0.1184496848896482
Bond Position:  [1.76070406]


portfolio before change:  [-9.73874868]
curr_Stock_Price:  97.08673328431371
curr_Factors:  [97.08673328]
mat_Sqrt:  [[0.15]]
grads:  [0.03733184]
Stock Position:  0.0373318386904154
Bond Position:  [-13.36317494]


portfolio before change:  [-9.68981811]
curr_Stock_Price:  98.48692634534729
curr_Factors:  [98.48692635]
mat_Sqrt:  [[0.15]]
grads:  [-0.09487071]
Stock Position:  -0.09487070928811632
Bond Position:  [-0.34629355]


portfolio before change:  [-9.80816919]
curr_Stock_Price:  99.73351240103456
curr_Factors:  [99.7335124]
mat_Sqrt:  [[0.15]]
grads:  [0.02768356]
Stock Position:  0.027683564737817613
Bond Position:  [-12.56914834]


portfolio before change:  [-9.7969309]
curr_Stock_Price:  100.25298914700873
curr_Factors:  [100.25298915]
mat_Sqrt:  [[0.15]]
grads:  [-0.0681348]
Stock Position:  -0.06813479804613594
Bond Position:  [-2.96621374]


portfolio before change:  [-9.79161421]
curr_Stock_Price:  100.16407215903955
curr_Factors:  [100.16407216]
mat_Sqrt:  [[0.15]]
grads:  [0.05211419]
Stock Position:  0.052114192208933985
Bond Position:  [-15.01158392]


portfolio before change:  [-9.79807986]
curr_Stock_Price:  100.11202719109714
curr_Factors:  [100.11202719]
mat_Sqrt:  [[0.15]]
grads:  [0.0501559]
Stock Position:  0.05015590345602123
Bond Position:  [-14.81928903]


portfolio before change:  [-9.86301138]
curr_Stock_Price:  98.89130875855922
curr_Factors:  [98.89130876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01124737]
Stock Position:  -0.01124737110779223
Bond Position:  [-8.75074413]


portfolio before change:  [-9.8715987]
curr_Stock_Price:  99.46027375599174
curr_Factors:  [99.46027376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.8715987]
Stock Price:  100.14804625296478
PL:  [-10.01964495]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.16299262e-03]
 [ 5.93536074e-03]
 [ 1.04774422e-03]
 [ 3.31915785e-03]
 [ 9.57249072e-03]
 [ 4.35515843e-03]
 [-4.15275478e-03]
 [ 1.22543261e-02]
 [ 4.77725421e-03]
 [ 1.15383608e-02]
 [-1.79162486e-02]
 [ 5.75161150e-03]
 [-7.83223963e-03]
 [ 2.04687342e-03]
 [-1.60102922e-02]
 [ 6.40301418e-03]
 [ 7.49565373e-03]
 [-2.04481191e-03]
 [-1.22538303e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94605295]
curr_Stock_Price:  99.7589684780899
curr_Factors:  [99.75896848]
mat_Sqrt:  [[0.15]]
grads:  [0.00775328]
Stock Position:  0.007753284124182245
Bond Position:  [-2.71951257]


portfolio before change:  [-1.93625735]
curr_Stock_Price:  101.11008172050845
curr_Factors:  [101.11008172]
mat_Sqrt:  [[0.15]]
grads:  [0.03956907]
Stock Position:  0.03956907157702596
Bond Position:  [-5.93708941]


portfolio before change:  [-1.96225231]
curr_Stock_Price:  100.49064568050696
curr_Factors:  [100.49064568]
mat_Sqrt:  [[0.15]]
grads:  [0.00698496]
Stock Position:  0.006984961491161581
Bond Position:  [-2.6641756]


portfolio before change:  [-1.96672103]
curr_Stock_Price:  99.94624916184074
curr_Factors:  [99.94624916]
mat_Sqrt:  [[0.15]]
grads:  [0.02212772]
Stock Position:  0.022127719016997647
Bond Position:  [-4.17830355]


portfolio before change:  [-1.96255987]
curr_Stock_Price:  100.18151361014007
curr_Factors:  [100.18151361]
mat_Sqrt:  [[0.15]]
grads:  [0.0638166]
Stock Position:  0.06381660477438239
Bond Position:  [-8.35580393]


portfolio before change:  [-2.02373467]
curr_Stock_Price:  99.2556482620647
curr_Factors:  [99.25564826]
mat_Sqrt:  [[0.15]]
grads:  [0.02903439]
Stock Position:  0.02903438951936901
Bond Position:  [-4.90556182]


portfolio before change:  [-2.00058257]
curr_Stock_Price:  100.09529540542056
curr_Factors:  [100.09529541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768503]
Stock Position:  -0.02768503185163048
Bond Position:  [0.77055887]


portfolio before change:  [-1.98213012]
curr_Stock_Price:  99.43574099467357
curr_Factors:  [99.43574099]
mat_Sqrt:  [[0.15]]
grads:  [0.08169551]
Stock Position:  0.08169550705023514
Bond Position:  [-10.1055834]


portfolio before change:  [-2.06731097]
curr_Stock_Price:  98.4240068058983
curr_Factors:  [98.42400681]
mat_Sqrt:  [[0.15]]
grads:  [0.03184836]
Stock Position:  0.03184836140357475
Bond Position:  [-5.20195431]


portfolio before change:  [-2.06540278]
curr_Stock_Price:  98.52476055633052
curr_Factors:  [98.52476056]
mat_Sqrt:  [[0.15]]
grads:  [0.07692241]
Stock Position:  0.07692240509112656
Bond Position:  [-9.64416432]


portfolio before change:  [-2.16819948]
curr_Stock_Price:  97.21973950462345
curr_Factors:  [97.2197395]
mat_Sqrt:  [[0.15]]
grads:  [-0.11944166]
Stock Position:  -0.11944165735053823
Bond Position:  [9.44388734]


portfolio before change:  [-2.13572441]
curr_Stock_Price:  96.9676180593601
curr_Factors:  [96.96761806]
mat_Sqrt:  [[0.15]]
grads:  [0.03834408]
Stock Position:  0.03834407668236132
Bond Position:  [-5.85385819]


portfolio before change:  [-2.10851264]
curr_Stock_Price:  97.71546280304055
curr_Factors:  [97.7154628]
mat_Sqrt:  [[0.15]]
grads:  [-0.05221493]
Stock Position:  -0.052214930871616355
Bond Position:  [2.9936935]


portfolio before change:  [-2.17403113]
curr_Stock_Price:  98.98458279827555
curr_Factors:  [98.9845828]
mat_Sqrt:  [[0.15]]
grads:  [0.01364582]
Stock Position:  0.01364582281777648
Bond Position:  [-3.52475721]


portfolio before change:  [-2.17774218]
curr_Stock_Price:  98.77721156521704
curr_Factors:  [98.77721157]
mat_Sqrt:  [[0.15]]
grads:  [-0.10673528]
Stock Position:  -0.1067352814808381
Bond Position:  [8.3652713]


portfolio before change:  [-2.44633362]
curr_Stock_Price:  101.31323353568322
curr_Factors:  [101.31323354]
mat_Sqrt:  [[0.15]]
grads:  [0.04268676]
Stock Position:  0.04268676123260607
Bond Position:  [-6.77106743]


portfolio before change:  [-2.50770647]
curr_Stock_Price:  99.91514517353617
curr_Factors:  [99.91514517]
mat_Sqrt:  [[0.15]]
grads:  [0.04997102]
Stock Position:  0.04997102486471845
Bond Position:  [-7.50056867]


portfolio before change:  [-2.62932613]
curr_Stock_Price:  97.51887088578322
curr_Factors:  [97.51887089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01363208]
Stock Position:  -0.01363207943318739
Bond Position:  [-1.29994113]


portfolio before change:  [-2.603012]
curr_Stock_Price:  95.56471944765389
curr_Factors:  [95.56471945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.603012]
Stock Price:  95.0865634711669
PL:  [-2.603012]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.98592839e-03]
 [ 6.40619718e-03]
 [ 1.17070821e-03]
 [ 1.42653982e-02]
 [ 2.18207865e-02]
 [ 4.01055330e-03]
 [ 2.89331860e-03]
 [ 1.22890476e-02]
 [ 3.39055016e-03]
 [ 7.80153719e-03]
 [-1.85341089e-02]
 [ 5.40075656e-03]
 [-1.44333046e-02]
 [ 1.03680784e-03]
 [-1.67749541e-02]
 [ 6.49936873e-03]
 [ 3.00871230e-03]
 [-4.58164788e-03]
 [-1.13168696e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.05920889]
curr_Stock_Price:  100.7972996607829
curr_Factors:  [100.79729966]
mat_Sqrt:  [[0.15]]
grads:  [0.04657286]
Stock Position:  0.04657285590952883
Bond Position:  [9.36479078]


portfolio before change:  [14.05895434]
curr_Stock_Price:  100.74155799465562
curr_Factors:  [100.74155799]
mat_Sqrt:  [[0.15]]
grads:  [0.04270798]
Stock Position:  0.042707981179800514
Bond Position:  [9.75648577]


portfolio before change:  [14.04269032]
curr_Stock_Price:  100.30362015421815
curr_Factors:  [100.30362015]
mat_Sqrt:  [[0.15]]
grads:  [0.00780472]
Stock Position:  0.007804721374630463
Bond Position:  [13.25984851]


portfolio before change:  [14.05888464]
curr_Stock_Price:  101.95376825764284
curr_Factors:  [101.95376826]
mat_Sqrt:  [[0.15]]
grads:  [0.09510265]
Stock Position:  0.09510265473435144
Bond Position:  [4.36281062]


portfolio before change:  [14.00988342]
curr_Stock_Price:  101.42705254984685
curr_Factors:  [101.42705255]
mat_Sqrt:  [[0.15]]
grads:  [0.14547191]
Stock Position:  0.14547191031603135
Bond Position:  [-0.74490367]


portfolio before change:  [13.91372821]
curr_Stock_Price:  100.76734469587078
curr_Factors:  [100.7673447]
mat_Sqrt:  [[0.15]]
grads:  [0.02673702]
Stock Position:  0.026737022021675508
Bond Position:  [11.2195095]


portfolio before change:  [13.90552128]
curr_Stock_Price:  100.35547540755715
curr_Factors:  [100.35547541]
mat_Sqrt:  [[0.15]]
grads:  [0.01928879]
Stock Position:  0.01928879067316064
Bond Position:  [11.96978552]


portfolio before change:  [13.89242557]
curr_Stock_Price:  99.52138845405936
curr_Factors:  [99.52138845]
mat_Sqrt:  [[0.15]]
grads:  [0.08192698]
Stock Position:  0.08192698431683784
Bond Position:  [5.73893834]


portfolio before change:  [13.96516854]
curr_Stock_Price:  100.39177387734509
curr_Factors:  [100.39177388]
mat_Sqrt:  [[0.15]]
grads:  [0.02260367]
Stock Position:  0.022603667746693767
Bond Position:  [11.69594624]


portfolio before change:  [13.91139691]
curr_Stock_Price:  97.88350924197096
curr_Factors:  [97.88350924]
mat_Sqrt:  [[0.15]]
grads:  [0.05201025]
Stock Position:  0.05201024792150433
Bond Position:  [8.82045133]


portfolio before change:  [13.95781716]
curr_Stock_Price:  98.7336274461021
curr_Factors:  [98.73362745]
mat_Sqrt:  [[0.15]]
grads:  [-0.12356073]
Stock Position:  -0.12356072575087344
Bond Position:  [26.15741582]


portfolio before change:  [13.85941141]
curr_Stock_Price:  99.582974369198
curr_Factors:  [99.58297437]
mat_Sqrt:  [[0.15]]
grads:  [0.03600504]
Stock Position:  0.03600504371355877
Bond Position:  [10.27392206]


portfolio before change:  [13.82341275]
curr_Stock_Price:  98.51180623635194
curr_Factors:  [98.51180624]
mat_Sqrt:  [[0.15]]
grads:  [-0.09622203]
Stock Position:  -0.09622203052842766
Bond Position:  [23.30241878]


portfolio before change:  [13.83042207]
curr_Stock_Price:  98.499511872755
curr_Factors:  [98.49951187]
mat_Sqrt:  [[0.15]]
grads:  [0.00691205]
Stock Position:  0.006912052255605423
Bond Position:  [13.1495883]


portfolio before change:  [13.82001578]
curr_Stock_Price:  96.51832056309851
curr_Factors:  [96.51832056]
mat_Sqrt:  [[0.15]]
grads:  [-0.11183303]
Stock Position:  -0.11183302734592375
Bond Position:  [24.61395177]


portfolio before change:  [13.98620308]
curr_Stock_Price:  95.0873207708615
curr_Factors:  [95.08732077]
mat_Sqrt:  [[0.15]]
grads:  [0.04332912]
Stock Position:  0.04332912487298172
Bond Position:  [9.86615268]


portfolio before change:  [13.99286019]
curr_Stock_Price:  95.18402864405321
curr_Factors:  [95.18402864]
mat_Sqrt:  [[0.15]]
grads:  [0.02005808]
Stock Position:  0.020058081981162
Bond Position:  [12.08365114]


portfolio before change:  [13.97483878]
curr_Stock_Price:  94.13494020969387
curr_Factors:  [94.13494021]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054432]
Stock Position:  -0.030544319167603147
Bond Position:  [16.85012644]


portfolio before change:  [14.01445457]
curr_Stock_Price:  92.97587933950697
curr_Factors:  [92.97587934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.01445457]
Stock Price:  93.28236563744038
PL:  [14.01445457]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.10242374e-03]
 [ 6.35264319e-03]
 [ 9.16463306e-04]
 [ 1.32607025e-02]
 [ 1.99984863e-02]
 [ 4.96134025e-03]
 [ 3.03685702e-02]
 [ 1.30117455e-02]
 [ 2.64124994e-03]
 [ 1.15447517e-02]
 [-1.78382960e-02]
 [ 5.96824760e-03]
 [-1.59870333e-02]
 [-3.04712029e-04]
 [-1.60597727e-02]
 [ 7.55767772e-03]
 [ 4.44176313e-03]
 [-1.76427966e-03]
 [-1.19118459e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.59561966]
curr_Stock_Price:  100.57260151178389
curr_Factors:  [100.57260151]
mat_Sqrt:  [[0.15]]
grads:  [0.04068282]
Stock Position:  0.0406828249548358
Bond Position:  [6.50404211]


portfolio before change:  [10.64692121]
curr_Stock_Price:  101.79364119547374
curr_Factors:  [101.7936412]
mat_Sqrt:  [[0.15]]
grads:  [0.04235095]
Stock Position:  0.04235095457384797
Bond Position:  [6.33586334]


portfolio before change:  [10.62814621]
curr_Stock_Price:  101.31291618595218
curr_Factors:  [101.31291619]
mat_Sqrt:  [[0.15]]
grads:  [0.00610976]
Stock Position:  0.006109755370152906
Bond Position:  [10.00914908]


portfolio before change:  [10.63012616]
curr_Stock_Price:  101.22737167154645
curr_Factors:  [101.22737167]
mat_Sqrt:  [[0.15]]
grads:  [0.08840468]
Stock Position:  0.08840468302960527
Bond Position:  [1.68115245]


portfolio before change:  [10.62854587]
curr_Stock_Price:  101.20474129058574
curr_Factors:  [101.20474129]
mat_Sqrt:  [[0.15]]
grads:  [0.13332324]
Stock Position:  0.13332324169925322
Bond Position:  [-2.86439832]


portfolio before change:  [10.59823958]
curr_Stock_Price:  100.98279877928697
curr_Factors:  [100.98279878]
mat_Sqrt:  [[0.15]]
grads:  [0.0330756]
Stock Position:  0.033075601656747694
Bond Position:  [7.25817276]


portfolio before change:  [10.62436659]
curr_Stock_Price:  101.71784931299673
curr_Factors:  [101.71784931]
mat_Sqrt:  [[0.15]]
grads:  [0.20245713]
Stock Position:  0.20245713470059912
Bond Position:  [-9.96913773]


portfolio before change:  [10.34122521]
curr_Stock_Price:  100.33163596058182
curr_Factors:  [100.33163596]
mat_Sqrt:  [[0.15]]
grads:  [0.08674497]
Stock Position:  0.08674496989165625
Bond Position:  [1.63796047]


portfolio before change:  [10.29302132]
curr_Stock_Price:  99.77121802960032
curr_Factors:  [99.77121803]
mat_Sqrt:  [[0.15]]
grads:  [0.01760833]
Stock Position:  0.01760833295456028
Bond Position:  [8.53621649]


portfolio before change:  [10.27323381]
curr_Stock_Price:  98.52624925335239
curr_Factors:  [98.52624925]
mat_Sqrt:  [[0.15]]
grads:  [0.07696501]
Stock Position:  0.07696501110448918
Bond Position:  [2.69015994]


portfolio before change:  [10.35942528]
curr_Stock_Price:  99.63738843492906
curr_Factors:  [99.63738843]
mat_Sqrt:  [[0.15]]
grads:  [-0.11892197]
Stock Position:  -0.1189219732212618
Bond Position:  [22.20850012]


portfolio before change:  [10.47200733]
curr_Stock_Price:  98.7373929945828
curr_Factors:  [98.73739299]
mat_Sqrt:  [[0.15]]
grads:  [0.03978832]
Stock Position:  0.03978831733301368
Bond Position:  [6.5434126]


portfolio before change:  [10.4722557]
curr_Stock_Price:  98.70251638055926
curr_Factors:  [98.70251638]
mat_Sqrt:  [[0.15]]
grads:  [-0.10658022]
Stock Position:  -0.10658022175048736
Bond Position:  [20.99199179]


portfolio before change:  [10.56771818]
curr_Stock_Price:  97.85607582004839
curr_Factors:  [97.85607582]
mat_Sqrt:  [[0.15]]
grads:  [-0.00203141]
Stock Position:  -0.002031413528832844
Bond Position:  [10.76650434]


portfolio before change:  [10.56863124]
curr_Stock_Price:  98.73177533367746
curr_Factors:  [98.73177533]
mat_Sqrt:  [[0.15]]
grads:  [-0.10706515]
Stock Position:  -0.10706515154556215
Bond Position:  [21.13936372]


portfolio before change:  [10.6498004]
curr_Stock_Price:  98.0230138006974
curr_Factors:  [98.0230138]
mat_Sqrt:  [[0.15]]
grads:  [0.05038452]
Stock Position:  0.0503845181107532
Bond Position:  [5.71095808]


portfolio before change:  [10.66510398]
curr_Stock_Price:  98.29840918619908
curr_Factors:  [98.29840919]
mat_Sqrt:  [[0.15]]
grads:  [0.02961175]
Stock Position:  0.029611754171519362
Bond Position:  [7.75431565]


portfolio before change:  [10.69342681]
curr_Stock_Price:  99.18940710743554
curr_Factors:  [99.18940711]
mat_Sqrt:  [[0.15]]
grads:  [-0.01176186]
Stock Position:  -0.011761864407528336
Bond Position:  [11.86007917]


portfolio before change:  [10.65964906]
curr_Stock_Price:  102.31332891771382
curr_Factors:  [102.31332892]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.65964906]
Stock Price:  102.15062422810482
PL:  [8.50902483]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.11780311e-02]
 [ 9.59190137e-03]
 [ 1.35894417e-03]
 [ 1.41419463e-02]
 [ 2.35790549e-02]
 [ 6.52465429e-03]
 [ 3.50627460e-02]
 [ 1.23607644e-02]
 [ 8.66340071e-03]
 [-1.79397618e-02]
 [-9.43197656e-03]
 [-3.39739458e-02]
 [-1.62184748e-02]
 [ 7.29541934e-03]
 [ 4.75885146e-02]
 [-1.07430212e-03]
 [ 5.93290794e-03]
 [-5.58564018e-03]
 [-9.47913811e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.43375444]
curr_Stock_Price:  98.23521878215865
curr_Factors:  [98.23521878]
mat_Sqrt:  [[0.15]]
grads:  [0.20785354]
Stock Position:  0.20785354099027625
Bond Position:  [-45.85229251]


portfolio before change:  [-25.20574516]
curr_Stock_Price:  99.38734630674251
curr_Factors:  [99.38734631]
mat_Sqrt:  [[0.15]]
grads:  [0.06394601]
Stock Position:  0.06394600913370659
Bond Position:  [-31.56116931]


portfolio before change:  [-25.17947176]
curr_Stock_Price:  99.92162016531613
curr_Factors:  [99.92162017]
mat_Sqrt:  [[0.15]]
grads:  [0.00905963]
Stock Position:  0.009059627824085655
Bond Position:  [-26.08472445]


portfolio before change:  [-25.16871187]
curr_Stock_Price:  101.8291907140955
curr_Factors:  [101.82919071]
mat_Sqrt:  [[0.15]]
grads:  [0.09427964]
Stock Position:  0.09427964174375496
Bond Position:  [-34.76913149]


portfolio before change:  [-25.19352472]
curr_Stock_Price:  101.6582154853556
curr_Factors:  [101.65821549]
mat_Sqrt:  [[0.15]]
grads:  [0.1571937]
Stock Position:  0.15719369910707015
Bond Position:  [-41.17355566]


portfolio before change:  [-24.96704126]
curr_Stock_Price:  103.16449810051296
curr_Factors:  [103.1644981]
mat_Sqrt:  [[0.15]]
grads:  [0.0434977]
Stock Position:  0.043497695292873326
Bond Position:  [-29.45445917]


portfolio before change:  [-25.007978]
curr_Stock_Price:  102.39268254453368
curr_Factors:  [102.39268254]
mat_Sqrt:  [[0.15]]
grads:  [0.23375164]
Stock Position:  0.23375163972642887
Bond Position:  [-48.94243544]


portfolio before change:  [-25.24345607]
curr_Stock_Price:  101.43764782236676
curr_Factors:  [101.43764782]
mat_Sqrt:  [[0.15]]
grads:  [0.0824051]
Stock Position:  0.08240509580477803
Bond Position:  [-33.60243516]


portfolio before change:  [-25.09023065]
curr_Stock_Price:  103.39902022703302
curr_Factors:  [103.39902023]
mat_Sqrt:  [[0.15]]
grads:  [0.057756]
Stock Position:  0.057756004740693825
Bond Position:  [-31.06214495]


portfolio before change:  [-24.99356156]
curr_Stock_Price:  105.2072408069362
curr_Factors:  [105.20724081]
mat_Sqrt:  [[0.15]]
grads:  [-0.11959841]
Stock Position:  -0.11959841223052067
Bond Position:  [-12.4109426]


portfolio before change:  [-25.02547641]
curr_Stock_Price:  105.44814476477835
curr_Factors:  [105.44814476]
mat_Sqrt:  [[0.15]]
grads:  [-0.06287984]
Stock Position:  -0.06287984370210321
Bond Position:  [-18.39491355]


portfolio before change:  [-25.14296142]
curr_Stock_Price:  107.24340529700942
curr_Factors:  [107.2434053]
mat_Sqrt:  [[0.15]]
grads:  [-0.22649297]
Stock Position:  -0.2264929717844023
Bond Position:  [-0.85308385]


portfolio before change:  [-25.28505565]
curr_Stock_Price:  107.8698306292177
curr_Factors:  [107.86983063]
mat_Sqrt:  [[0.15]]
grads:  [-0.10812317]
Stock Position:  -0.10812316519381976
Bond Position:  [-13.62182813]


portfolio before change:  [-25.17766925]
curr_Stock_Price:  106.84514476631256
curr_Factors:  [106.84514477]
mat_Sqrt:  [[0.15]]
grads:  [0.04863613]
Stock Position:  0.04863612896344903
Bond Position:  [-30.37420349]


portfolio before change:  [-25.16056805]
curr_Stock_Price:  107.35290937544319
curr_Factors:  [107.35290938]
mat_Sqrt:  [[0.15]]
grads:  [0.31725676]
Stock Position:  0.31725676373688083
Bond Position:  [-59.21900465]


portfolio before change:  [-25.1700807]
curr_Stock_Price:  107.3695960283552
curr_Factors:  [107.36959603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00716201]
Stock Position:  -0.007162014138992548
Bond Position:  [-24.40109813]


portfolio before change:  [-25.17807136]
curr_Stock_Price:  107.63343629178101
curr_Factors:  [107.63343629]
mat_Sqrt:  [[0.15]]
grads:  [0.03955272]
Stock Position:  0.039552719579709086
Bond Position:  [-29.43526648]


portfolio before change:  [-25.17421776]
curr_Stock_Price:  107.91693994918235
curr_Factors:  [107.91693995]
mat_Sqrt:  [[0.15]]
grads:  [-0.0372376]
Stock Position:  -0.03723760120563193
Bond Position:  [-21.15564978]


portfolio before change:  [-25.18912947]
curr_Stock_Price:  108.17533831095382
curr_Factors:  [108.17533831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.18912947]
Stock Price:  107.78554247933484
PL:  [-32.97467195]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.21493939e-02]
 [ 2.73942984e-03]
 [-2.21757091e-03]
 [-2.28204663e-03]
 [-2.03853654e-05]
 [ 4.64740777e-03]
 [-8.56187137e-03]
 [ 9.61209296e-03]
 [ 4.68431302e-03]
 [-8.24838530e-04]
 [-1.77436191e-02]
 [ 6.90458953e-03]
 [ 1.35566548e-02]
 [-2.88922879e-03]
 [-1.67648240e-02]
 [ 7.28489061e-03]
 [ 4.04084664e-03]
 [-2.32025548e-03]
 [-1.27705026e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.18337218]
curr_Stock_Price:  98.1865878075958
curr_Factors:  [98.18658781]
mat_Sqrt:  [[0.15]]
grads:  [0.21432929]
Stock Position:  0.21432929295699452
Bond Position:  [-47.22763413]


portfolio before change:  [-26.21081199]
curr_Stock_Price:  98.11365599408165
curr_Factors:  [98.11365599]
mat_Sqrt:  [[0.15]]
grads:  [0.01826287]
Stock Position:  0.01826286557689353
Bond Position:  [-28.0026485]


portfolio before change:  [-26.22498574]
curr_Stock_Price:  97.72093481639719
curr_Factors:  [97.72093482]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478381]
Stock Position:  -0.014783806076544646
Bond Position:  [-24.78029839]


portfolio before change:  [-26.20723796]
curr_Stock_Price:  96.10134965393125
curr_Factors:  [96.10134965]
mat_Sqrt:  [[0.15]]
grads:  [-0.01521364]
Stock Position:  -0.015213644229266483
Bond Position:  [-24.74518622]


portfolio before change:  [-26.23934312]
curr_Stock_Price:  97.80495789435699
curr_Factors:  [97.80495789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0001359]
Stock Position:  -0.00013590243590208437
Bond Position:  [-26.22605119]


portfolio before change:  [-26.24599897]
curr_Stock_Price:  98.52991243737492
curr_Factors:  [98.52991244]
mat_Sqrt:  [[0.15]]
grads:  [0.03098272]
Stock Position:  0.030982718458889537
Bond Position:  [-29.29872351]


portfolio before change:  [-26.25689492]
curr_Stock_Price:  98.41467567939819
curr_Factors:  [98.41467568]
mat_Sqrt:  [[0.15]]
grads:  [-0.05707914]
Stock Position:  -0.057079142478009735
Bond Position:  [-20.63946962]


portfolio before change:  [-26.24174514]
curr_Stock_Price:  98.05884876062517
curr_Factors:  [98.05884876]
mat_Sqrt:  [[0.15]]
grads:  [0.06408062]
Stock Position:  0.06408061973915385
Bond Position:  [-32.52541694]


portfolio before change:  [-26.29647217]
curr_Stock_Price:  97.33172309211001
curr_Factors:  [97.33172309]
mat_Sqrt:  [[0.15]]
grads:  [0.03122875]
Stock Position:  0.031228753468458704
Bond Position:  [-29.33602056]


portfolio before change:  [-26.31491019]
curr_Stock_Price:  96.97618236811539
curr_Factors:  [96.97618237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00549892]
Stock Position:  -0.005498923534126808
Bond Position:  [-25.78164557]


portfolio before change:  [-26.32000406]
curr_Stock_Price:  96.73025413852245
curr_Factors:  [96.73025414]
mat_Sqrt:  [[0.15]]
grads:  [-0.11829079]
Stock Position:  -0.11829079426614507
Bond Position:  [-14.87770547]


portfolio before change:  [-26.24480646]
curr_Stock_Price:  96.06310588841455
curr_Factors:  [96.06310589]
mat_Sqrt:  [[0.15]]
grads:  [0.0460306]
Stock Position:  0.046030596889710736
Bond Position:  [-30.66664856]


portfolio before change:  [-26.29187749]
curr_Stock_Price:  95.20707934381791
curr_Factors:  [95.20707934]
mat_Sqrt:  [[0.15]]
grads:  [0.0903777]
Stock Position:  0.09037769864927235
Bond Position:  [-34.89647422]


portfolio before change:  [-26.26291518]
curr_Stock_Price:  95.6240795498662
curr_Factors:  [95.62407955]
mat_Sqrt:  [[0.15]]
grads:  [-0.01926153]
Stock Position:  -0.019261525297755353
Bond Position:  [-24.42104955]


portfolio before change:  [-26.28555341]
curr_Stock_Price:  96.4823815324483
curr_Factors:  [96.48238153]
mat_Sqrt:  [[0.15]]
grads:  [-0.11176549]
Stock Position:  -0.11176549344183953
Bond Position:  [-15.50215243]


portfolio before change:  [-26.39592814]
curr_Stock_Price:  97.43525796380008
curr_Factors:  [97.43525796]
mat_Sqrt:  [[0.15]]
grads:  [0.04856594]
Stock Position:  0.048565937422679124
Bond Position:  [-31.12796278]


portfolio before change:  [-26.42067512]
curr_Stock_Price:  97.08595937301486
curr_Factors:  [97.08595937]
mat_Sqrt:  [[0.15]]
grads:  [0.02693898]
Stock Position:  0.026938977584018454
Bond Position:  [-29.0360716]


portfolio before change:  [-26.43280906]
curr_Stock_Price:  96.90503138058968
curr_Factors:  [96.90503138]
mat_Sqrt:  [[0.15]]
grads:  [-0.01546837]
Stock Position:  -0.015468369856354896
Bond Position:  [-24.93384619]


portfolio before change:  [-26.46794632]
curr_Stock_Price:  98.77355581726626
curr_Factors:  [98.77355582]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.46794632]
Stock Price:  98.40574329401984
PL:  [-26.46794632]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.93718822e-03]
 [ 5.99773902e-03]
 [-3.24303612e-03]
 [-2.32116956e-03]
 [-1.54721731e-02]
 [-3.81018860e-03]
 [ 3.41495538e-03]
 [-1.32180007e-03]
 [ 4.53616722e-03]
 [-1.83184254e-02]
 [-1.73889824e-02]
 [ 7.36396556e-03]
 [ 1.58180297e-02]
 [-3.94227287e-03]
 [-1.63008194e-02]
 [ 6.30139306e-03]
 [ 1.81325641e-03]
 [-4.83308192e-03]
 [-1.13957329e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.89195648]
curr_Stock_Price:  100.65670053871362
curr_Factors:  [100.65670054]
mat_Sqrt:  [[0.15]]
grads:  [0.03958125]
Stock Position:  0.03958125478550221
Bond Position:  [7.90783797]


portfolio before change:  [11.81669598]
curr_Stock_Price:  98.7053296684268
curr_Factors:  [98.70532967]
mat_Sqrt:  [[0.15]]
grads:  [0.03998493]
Stock Position:  0.03998492679380578
Bond Position:  [7.8699706]


portfolio before change:  [11.753381]
curr_Stock_Price:  97.07264649567114
curr_Factors:  [97.0726465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02162024]
Stock Position:  -0.021620240809488718
Bond Position:  [13.85211499]


portfolio before change:  [11.77832797]
curr_Stock_Price:  96.07897067289242
curr_Factors:  [96.07897067]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547446]
Stock Position:  -0.015474463721372156
Bond Position:  [13.26509852]


portfolio before change:  [11.80773691]
curr_Stock_Price:  94.39282177306191
curr_Factors:  [94.39282177]
mat_Sqrt:  [[0.15]]
grads:  [-0.10314782]
Stock Position:  -0.10314782057946094
Bond Position:  [21.54415075]


portfolio before change:  [11.74380787]
curr_Stock_Price:  95.06482584309884
curr_Factors:  [95.06482584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02540126]
Stock Position:  -0.02540125733739757
Bond Position:  [14.15857397]


portfolio before change:  [11.76164266]
curr_Stock_Price:  94.50206982195448
curr_Factors:  [94.50206982]
mat_Sqrt:  [[0.15]]
grads:  [0.02276637]
Stock Position:  0.02276636919881008
Bond Position:  [9.61017365]


portfolio before change:  [11.77562582]
curr_Stock_Price:  95.01072852974272
curr_Factors:  [95.01072853]
mat_Sqrt:  [[0.15]]
grads:  [-0.008812]
Stock Position:  -0.008812000469259063
Bond Position:  [12.6128604]


portfolio before change:  [11.77806755]
curr_Stock_Price:  95.09151377433173
curr_Factors:  [95.09151377]
mat_Sqrt:  [[0.15]]
grads:  [0.03024111]
Stock Position:  0.030241114817905815
Bond Position:  [8.90239416]


portfolio before change:  [11.76730295]
curr_Stock_Price:  94.66195044966489
curr_Factors:  [94.66195045]
mat_Sqrt:  [[0.15]]
grads:  [-0.12212284]
Stock Position:  -0.12212283591000203
Bond Position:  [23.32768879]


portfolio before change:  [11.81918863]
curr_Stock_Price:  94.2848462713308
curr_Factors:  [94.28484627]
mat_Sqrt:  [[0.15]]
grads:  [-0.11592655]
Stock Position:  -0.11592654911243248
Bond Position:  [22.7493055]


portfolio before change:  [11.66050688]
curr_Stock_Price:  95.70272503167398
curr_Factors:  [95.70272503]
mat_Sqrt:  [[0.15]]
grads:  [0.0490931]
Stock Position:  0.049093103759886424
Bond Position:  [6.96216307]


portfolio before change:  [11.62425045]
curr_Stock_Price:  94.92874287721507
curr_Factors:  [94.92874288]
mat_Sqrt:  [[0.15]]
grads:  [0.10545353]
Stock Position:  0.10545353133046181
Bond Position:  [1.61367929]


portfolio before change:  [11.57528519]
curr_Stock_Price:  94.46058658379073
curr_Factors:  [94.46058658]
mat_Sqrt:  [[0.15]]
grads:  [-0.02628182]
Stock Position:  -0.026281819150506813
Bond Position:  [14.05788124]


portfolio before change:  [11.56892807]
curr_Stock_Price:  94.83620841205246
curr_Factors:  [94.83620841]
mat_Sqrt:  [[0.15]]
grads:  [-0.10867213]
Stock Position:  -0.10867212960849539
Bond Position:  [21.8749808]


portfolio before change:  [11.64589722]
curr_Stock_Price:  94.17826865116686
curr_Factors:  [94.17826865]
mat_Sqrt:  [[0.15]]
grads:  [0.04200929]
Stock Position:  0.04200928704049539
Bond Position:  [7.6895353]


portfolio before change:  [11.59752943]
curr_Stock_Price:  92.98114264415256
curr_Factors:  [92.98114264]
mat_Sqrt:  [[0.15]]
grads:  [0.01208838]
Stock Position:  0.012088376061017148
Bond Position:  [10.47353841]


portfolio before change:  [11.61123429]
curr_Stock_Price:  93.8982339758687
curr_Factors:  [93.89823398]
mat_Sqrt:  [[0.15]]
grads:  [-0.03222055]
Stock Position:  -0.03222054616258492
Bond Position:  [14.63668667]


portfolio before change:  [11.63747623]
curr_Stock_Price:  93.19736717569
curr_Factors:  [93.19736718]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.63747623]
Stock Price:  93.3193281668581
PL:  [11.63747623]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.09392313e-03]
 [ 9.36843361e-03]
 [-3.01266609e-04]
 [ 2.68714169e-03]
 [ 1.83161143e-03]
 [ 4.50997153e-03]
 [-1.32385258e-02]
 [ 1.25203677e-02]
 [ 4.72940660e-03]
 [-8.86580432e-05]
 [-1.76106329e-02]
 [ 5.92391175e-03]
 [ 1.12519653e-02]
 [-3.80601093e-03]
 [-1.64828090e-02]
 [ 6.48839966e-03]
 [ 2.72035509e-03]
 [-5.37023014e-03]
 [-1.16330904e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.24558953]
curr_Stock_Price:  100.54989352994954
curr_Factors:  [100.54989353]
mat_Sqrt:  [[0.15]]
grads:  [0.04062615]
Stock Position:  0.040626154219228786
Bond Position:  [6.16063405]


portfolio before change:  [10.19790798]
curr_Stock_Price:  99.33831189938006
curr_Factors:  [99.3383119]
mat_Sqrt:  [[0.15]]
grads:  [0.06245622]
Stock Position:  0.062456224050707644
Bond Position:  [3.99361211]


portfolio before change:  [10.16188702]
curr_Stock_Price:  98.74558503474387
curr_Factors:  [98.74558503]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200844]
Stock Position:  -0.002008444060836701
Bond Position:  [10.36021201]


portfolio before change:  [10.16408356]
curr_Stock_Price:  98.9416787890883
curr_Factors:  [98.94167879]
mat_Sqrt:  [[0.15]]
grads:  [0.01791428]
Stock Position:  0.017914277929195397
Bond Position:  [8.39161482]


portfolio before change:  [10.16074865]
curr_Stock_Price:  98.63839689746017
curr_Factors:  [98.6383969]
mat_Sqrt:  [[0.15]]
grads:  [0.01221074]
Stock Position:  0.012210742872796752
Bond Position:  [8.95630055]


portfolio before change:  [10.16816917]
curr_Stock_Price:  99.06270927731782
curr_Factors:  [99.06270928]
mat_Sqrt:  [[0.15]]
grads:  [0.03006648]
Stock Position:  0.030066476860277462
Bond Position:  [7.18970252]


portfolio before change:  [10.16864987]
curr_Stock_Price:  99.01890791083987
curr_Factors:  [99.01890791]
mat_Sqrt:  [[0.15]]
grads:  [-0.08825684]
Stock Position:  -0.08825683851739832
Bond Position:  [18.90774563]


portfolio before change:  [10.1091047]
curr_Stock_Price:  99.7471539356794
curr_Factors:  [99.74715394]
mat_Sqrt:  [[0.15]]
grads:  [0.08346912]
Stock Position:  0.08346911793894861
Bond Position:  [1.78329775]


portfolio before change:  [9.96485341]
curr_Stock_Price:  98.01361249114285
curr_Factors:  [98.01361249]
mat_Sqrt:  [[0.15]]
grads:  [0.03152938]
Stock Position:  0.031529377307732295
Bond Position:  [6.87454524]


portfolio before change:  [9.93648287]
curr_Stock_Price:  97.05928363988156
curr_Factors:  [97.05928364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059105]
Stock Position:  -0.0005910536211047961
Bond Position:  [9.99385011]


portfolio before change:  [9.9397031]
curr_Stock_Price:  95.83865614988133
curr_Factors:  [95.83865615]
mat_Sqrt:  [[0.15]]
grads:  [-0.11740422]
Stock Position:  -0.11740421962599161
Bond Position:  [21.19156573]


portfolio before change:  [9.82832625]
curr_Stock_Price:  96.83244838296159
curr_Factors:  [96.83244838]
mat_Sqrt:  [[0.15]]
grads:  [0.03949274]
Stock Position:  0.03949274497277485
Bond Position:  [6.00414706]


portfolio before change:  [9.77684001]
curr_Stock_Price:  95.49074709906009
curr_Factors:  [95.4907471]
mat_Sqrt:  [[0.15]]
grads:  [0.0750131]
Stock Position:  0.07501310173793174
Bond Position:  [2.61378288]


portfolio before change:  [9.71151151]
curr_Stock_Price:  94.61114040376557
curr_Factors:  [94.6111404]
mat_Sqrt:  [[0.15]]
grads:  [-0.02537341]
Stock Position:  -0.025373406218332
Bond Position:  [12.11211841]


portfolio before change:  [9.69244674]
curr_Stock_Price:  95.48186224680853
curr_Factors:  [95.48186225]
mat_Sqrt:  [[0.15]]
grads:  [-0.10988539]
Stock Position:  -0.10988539338771054
Bond Position:  [20.18450873]


portfolio before change:  [9.74881086]
curr_Stock_Price:  95.01485417613782
curr_Factors:  [95.01485418]
mat_Sqrt:  [[0.15]]
grads:  [0.043256]
Stock Position:  0.04325599772295949
Bond Position:  [5.63884854]


portfolio before change:  [9.73455403]
curr_Stock_Price:  94.65266813123003
curr_Factors:  [94.65266813]
mat_Sqrt:  [[0.15]]
grads:  [0.0181357]
Stock Position:  0.018135700602838492
Bond Position:  [8.01796158]


portfolio before change:  [9.71266705]
curr_Stock_Price:  93.33528181053937
curr_Factors:  [93.33528181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03580153]
Stock Position:  -0.03580153427009054
Bond Position:  [13.05421334]


portfolio before change:  [9.69700258]
curr_Stock_Price:  93.86398625926648
curr_Factors:  [93.86398626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.69700258]
Stock Price:  95.41605334777786
PL:  [9.69700258]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.46218749e-02]
 [ 6.03679960e-03]
 [ 1.42979498e-03]
 [ 5.99716686e-04]
 [-4.03724902e-03]
 [ 1.84714249e-03]
 [-2.28508394e-03]
 [ 6.90109361e-03]
 [ 4.65189457e-03]
 [ 1.74665810e-03]
 [-1.79115267e-02]
 [ 5.39544586e-03]
 [ 1.11396074e-03]
 [-2.42625189e-03]
 [-1.61422612e-02]
 [ 6.21867478e-03]
 [ 2.58681689e-03]
 [-4.66868394e-03]
 [-1.16497237e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.91389776]
curr_Stock_Price:  101.37174196928875
curr_Factors:  [101.37174197]
mat_Sqrt:  [[0.15]]
grads:  [0.09747917]
Stock Position:  0.09747916585224058
Bond Position:  [13.03226491]


portfolio before change:  [22.91551801]
curr_Stock_Price:  101.35493609185866
curr_Factors:  [101.35493609]
mat_Sqrt:  [[0.15]]
grads:  [0.04024533]
Stock Position:  0.04024533069144621
Bond Position:  [18.83645509]


portfolio before change:  [22.8575624]
curr_Stock_Price:  99.7978532530086
curr_Factors:  [99.79785325]
mat_Sqrt:  [[0.15]]
grads:  [0.00953197]
Stock Position:  0.00953196653262245
Bond Position:  [21.9062926]


portfolio before change:  [22.84351737]
curr_Stock_Price:  97.74976752284084
curr_Factors:  [97.74976752]
mat_Sqrt:  [[0.15]]
grads:  [0.00399811]
Stock Position:  0.003998111238993329
Bond Position:  [22.45270293]


portfolio before change:  [22.84426788]
curr_Stock_Price:  96.53335016040316
curr_Factors:  [96.53335016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02691499]
Stock Position:  -0.02691499344959408
Bond Position:  [25.44246236]


portfolio before change:  [22.83359765]
curr_Stock_Price:  97.16614372453266
curr_Factors:  [97.16614372]
mat_Sqrt:  [[0.15]]
grads:  [0.01231428]
Stock Position:  0.012314283245451555
Bond Position:  [21.63706624]


portfolio before change:  [22.82691921]
curr_Stock_Price:  96.18448836908293
curr_Factors:  [96.18448837]
mat_Sqrt:  [[0.15]]
grads:  [-0.01523389]
Stock Position:  -0.015233892908740887
Bond Position:  [24.29218341]


portfolio before change:  [22.82064643]
curr_Stock_Price:  96.99495681626924
curr_Factors:  [96.99495682]
mat_Sqrt:  [[0.15]]
grads:  [0.04600729]
Stock Position:  0.046007290734990026
Bond Position:  [18.35817125]


portfolio before change:  [22.81817653]
curr_Stock_Price:  96.84150251722593
curr_Factors:  [96.84150252]
mat_Sqrt:  [[0.15]]
grads:  [0.03101263]
Stock Position:  0.03101263045566272
Bond Position:  [19.8148668]


portfolio before change:  [22.83602729]
curr_Stock_Price:  97.25734670274744
curr_Factors:  [97.2573467]
mat_Sqrt:  [[0.15]]
grads:  [0.01164439]
Stock Position:  0.011644387346770672
Bond Position:  [21.70352507]


portfolio before change:  [22.84086003]
curr_Stock_Price:  97.2063506574406
curr_Factors:  [97.20635066]
mat_Sqrt:  [[0.15]]
grads:  [-0.11941018]
Stock Position:  -0.11941017790082951
Bond Position:  [34.44828765]


portfolio before change:  [22.78421683]
curr_Stock_Price:  97.75283963494259
curr_Factors:  [97.75283963]
mat_Sqrt:  [[0.15]]
grads:  [0.03596964]
Stock Position:  0.03596963907856536
Bond Position:  [19.26808247]


portfolio before change:  [22.75255124]
curr_Stock_Price:  96.73856158246608
curr_Factors:  [96.73856158]
mat_Sqrt:  [[0.15]]
grads:  [0.0074264]
Stock Position:  0.007426404965509443
Bond Position:  [22.0341315]


portfolio before change:  [22.7534172]
curr_Stock_Price:  96.11332487237465
curr_Factors:  [96.11332487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01617501]
Stock Position:  -0.01617501261829528
Bond Position:  [24.30805144]


portfolio before change:  [22.7892512]
curr_Stock_Price:  94.27368300674416
curr_Factors:  [94.27368301]
mat_Sqrt:  [[0.15]]
grads:  [-0.10761507]
Stock Position:  -0.10761507447707645
Bond Position:  [32.93452062]


portfolio before change:  [22.84210403]
curr_Stock_Price:  93.85907406518508
curr_Factors:  [93.85907407]
mat_Sqrt:  [[0.15]]
grads:  [0.04145783]
Stock Position:  0.041457831849244245
Bond Position:  [18.95091032]


portfolio before change:  [22.86954139]
curr_Stock_Price:  94.40659511013679
curr_Factors:  [94.40659511]
mat_Sqrt:  [[0.15]]
grads:  [0.01724545]
Stock Position:  0.01724544590373798
Bond Position:  [21.24145756]


portfolio before change:  [22.86875455]
curr_Stock_Price:  94.0530023010109
curr_Factors:  [94.0530023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03112456]
Stock Position:  -0.031124559629492253
Bond Position:  [25.79611283]


portfolio before change:  [22.87963346]
curr_Stock_Price:  93.91070075420973
curr_Factors:  [93.91070075]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.87963346]
Stock Price:  94.18153854900956
PL:  [22.87963346]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.97792718e-03]
 [ 6.03826231e-03]
 [ 8.83542001e-04]
 [ 1.27369302e-02]
 [ 2.44577696e-02]
 [ 6.80765905e-03]
 [ 3.06112013e-02]
 [-7.99217239e-03]
 [ 1.12997099e-02]
 [-2.77941717e-02]
 [-8.58038517e-03]
 [-2.80982122e-02]
 [-1.51408468e-02]
 [ 8.94632358e-03]
 [ 7.69112041e-02]
 [-2.67550508e-03]
 [ 4.65942869e-03]
 [-7.47470975e-03]
 [-8.94445325e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.53441841]
curr_Stock_Price:  101.02275166777225
curr_Factors:  [101.02275167]
mat_Sqrt:  [[0.15]]
grads:  [0.06651951]
Stock Position:  0.06651951450628417
Bond Position:  [10.81443401]


portfolio before change:  [17.53635134]
curr_Stock_Price:  101.01116087556294
curr_Factors:  [101.01116088]
mat_Sqrt:  [[0.15]]
grads:  [0.04025508]
Stock Position:  0.040255082093060016
Bond Position:  [13.47013877]


portfolio before change:  [17.52556048]
curr_Stock_Price:  100.6594335344101
curr_Factors:  [100.65943353]
mat_Sqrt:  [[0.15]]
grads:  [0.00589028]
Stock Position:  0.005890280007189971
Bond Position:  [16.93264823]


portfolio before change:  [17.53270769]
curr_Stock_Price:  101.15406385215208
curr_Factors:  [101.15406385]
mat_Sqrt:  [[0.15]]
grads:  [0.08491287]
Stock Position:  0.08491286832668475
Bond Position:  [8.94342598]


portfolio before change:  [17.58678569]
curr_Stock_Price:  101.76459403564112
curr_Factors:  [101.76459404]
mat_Sqrt:  [[0.15]]
grads:  [0.1630518]
Stock Position:  0.16305179727038174
Bond Position:  [0.99388573]


portfolio before change:  [17.69166865]
curr_Stock_Price:  102.40631929116152
curr_Factors:  [102.40631929]
mat_Sqrt:  [[0.15]]
grads:  [0.04538439]
Stock Position:  0.045384393693145064
Bond Position:  [13.04401994]


portfolio before change:  [17.76909841]
curr_Stock_Price:  104.04054506792639
curr_Factors:  [104.04054507]
mat_Sqrt:  [[0.15]]
grads:  [0.20407468]
Stock Position:  0.20407467543956065
Bond Position:  [-3.46294206]


portfolio before change:  [18.06686025]
curr_Stock_Price:  105.50387058994049
curr_Factors:  [105.50387059]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328115]
Stock Position:  -0.05328114926750093
Bond Position:  [23.68822772]


portfolio before change:  [18.0005423]
curr_Stock_Price:  106.85971120325155
curr_Factors:  [106.8597112]
mat_Sqrt:  [[0.15]]
grads:  [0.0753314]
Stock Position:  0.07533139904212831
Bond Position:  [9.95065075]


portfolio before change:  [17.97023418]
curr_Stock_Price:  106.42435367440876
curr_Factors:  [106.42435367]
mat_Sqrt:  [[0.15]]
grads:  [-0.18529448]
Stock Position:  -0.18529447823784015
Bond Position:  [37.69007926]


portfolio before change:  [18.06349824]
curr_Stock_Price:  105.9718827256289
curr_Factors:  [105.97188273]
mat_Sqrt:  [[0.15]]
grads:  [-0.05720257]
Stock Position:  -0.05720256781736618
Bond Position:  [24.12536205]


portfolio before change:  [18.05500492]
curr_Stock_Price:  106.22581213201146
curr_Factors:  [106.22581213]
mat_Sqrt:  [[0.15]]
grads:  [-0.18732141]
Stock Position:  -0.18732141439396907
Bond Position:  [37.9533743]


portfolio before change:  [17.62859927]
curr_Stock_Price:  108.55280282229371
curr_Factors:  [108.55280282]
mat_Sqrt:  [[0.15]]
grads:  [-0.10093898]
Stock Position:  -0.10093897877724571
Bond Position:  [28.58580833]


portfolio before change:  [17.67322492]
curr_Stock_Price:  108.18150610616222
curr_Factors:  [108.18150611]
mat_Sqrt:  [[0.15]]
grads:  [0.05964216]
Stock Position:  0.059642157187536966
Bond Position:  [11.22104653]


portfolio before change:  [17.87120106]
curr_Stock_Price:  111.45386474294676
curr_Factors:  [111.45386474]
mat_Sqrt:  [[0.15]]
grads:  [0.51274136]
Stock Position:  0.5127413605792144
Bond Position:  [-39.27580519]


portfolio before change:  [17.53148452]
curr_Stock_Price:  110.81046753187567
curr_Factors:  [110.81046753]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178367]
Stock Position:  -0.01783670053605221
Bond Position:  [19.50797765]


portfolio before change:  [17.52424974]
curr_Stock_Price:  111.4895388434203
curr_Factors:  [111.48953884]
mat_Sqrt:  [[0.15]]
grads:  [0.03106286]
Stock Position:  0.031062857923119237
Bond Position:  [14.06106603]


portfolio before change:  [17.52275632]
curr_Stock_Price:  111.32828125347697
curr_Factors:  [111.32828125]
mat_Sqrt:  [[0.15]]
grads:  [-0.0498314]
Stock Position:  -0.049831398315364824
Bond Position:  [23.07040025]


portfolio before change:  [17.61530971]
curr_Stock_Price:  109.58670718495624
curr_Factors:  [109.58670718]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.61530971]
Stock Price:  108.27400741419424
PL:  [9.3413023]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.94926493e-02]
 [-2.65440068e-03]
 [-4.11659088e-03]
 [ 1.86371579e-04]
 [-3.40007805e-04]
 [ 3.29951081e-03]
 [-8.69053213e-03]
 [ 1.34520064e-02]
 [ 3.24986304e-03]
 [ 9.98996074e-03]
 [-1.69375794e-02]
 [ 6.03144827e-03]
 [-1.48531060e-02]
 [ 4.15453869e-03]
 [-1.11418321e-02]
 [ 7.88158015e-03]
 [ 4.84817301e-03]
 [-1.93654149e-03]
 [-1.27335859e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.41593985]
curr_Stock_Price:  98.82024376834283
curr_Factors:  [98.82024377]
mat_Sqrt:  [[0.15]]
grads:  [0.129951]
Stock Position:  0.12995099556696801
Bond Position:  [-29.25772891]


portfolio before change:  [-16.68457799]
curr_Stock_Price:  96.80931035652696
curr_Factors:  [96.80931036]
mat_Sqrt:  [[0.15]]
grads:  [-0.017696]
Stock Position:  -0.01769600453475543
Bond Position:  [-14.97144]


portfolio before change:  [-16.68320866]
curr_Stock_Price:  96.52039436645003
curr_Factors:  [96.52039437]
mat_Sqrt:  [[0.15]]
grads:  [-0.02744394]
Stock Position:  -0.027443939180795483
Bond Position:  [-14.03430883]


portfolio before change:  [-16.71396766]
curr_Stock_Price:  97.51332705771341
curr_Factors:  [97.51332706]
mat_Sqrt:  [[0.15]]
grads:  [0.00124248]
Stock Position:  0.0012424771946754898
Bond Position:  [-16.83512575]


portfolio before change:  [-16.71799223]
curr_Stock_Price:  97.6620116324922
curr_Factors:  [97.66201163]
mat_Sqrt:  [[0.15]]
grads:  [-0.00226672]
Stock Position:  -0.002266718701151108
Bond Position:  [-16.49661992]


portfolio before change:  [-16.72233658]
curr_Stock_Price:  97.75892667723788
curr_Factors:  [97.75892668]
mat_Sqrt:  [[0.15]]
grads:  [0.02199674]
Stock Position:  0.021996738766481713
Bond Position:  [-18.87271415]


portfolio before change:  [-16.68190646]
curr_Stock_Price:  99.81145338496165
curr_Factors:  [99.81145338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05793688]
Stock Position:  -0.057936880848802656
Bond Position:  [-10.89914217]


portfolio before change:  [-16.73465797]
curr_Stock_Price:  100.67491696011145
curr_Factors:  [100.67491696]
mat_Sqrt:  [[0.15]]
grads:  [0.08968004]
Stock Position:  0.08968004273245825
Bond Position:  [-25.76318882]


portfolio before change:  [-16.77643797]
curr_Stock_Price:  100.28086715990189
curr_Factors:  [100.28086716]
mat_Sqrt:  [[0.15]]
grads:  [0.02166575]
Stock Position:  0.021665753627266963
Bond Position:  [-18.94909854]


portfolio before change:  [-16.79406324]
curr_Stock_Price:  99.68603897585383
curr_Factors:  [99.68603898]
mat_Sqrt:  [[0.15]]
grads:  [0.06659974]
Stock Position:  0.0665997382758452
Bond Position:  [-23.43312735]


portfolio before change:  [-16.75752952]
curr_Stock_Price:  100.32256909387081
curr_Factors:  [100.32256909]
mat_Sqrt:  [[0.15]]
grads:  [-0.1129172]
Stock Position:  -0.11291719619660817
Bond Position:  [-5.4293863]


portfolio before change:  [-16.58720924]
curr_Stock_Price:  98.80218248327321
curr_Factors:  [98.80218248]
mat_Sqrt:  [[0.15]]
grads:  [0.04020966]
Stock Position:  0.04020965511057898
Bond Position:  [-20.56001092]


portfolio before change:  [-16.60195389]
curr_Stock_Price:  98.56333414770998
curr_Factors:  [98.56333415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09902071]
Stock Position:  -0.0990207068198141
Bond Position:  [-6.84214288]


portfolio before change:  [-16.71933015]
curr_Stock_Price:  99.73142825432657
curr_Factors:  [99.73142825]
mat_Sqrt:  [[0.15]]
grads:  [0.02769692]
Stock Position:  0.027696924584961296
Bond Position:  [-19.481584]


portfolio before change:  [-16.71803113]
curr_Stock_Price:  99.95419753577299
curr_Factors:  [99.95419754]
mat_Sqrt:  [[0.15]]
grads:  [-0.07427888]
Stock Position:  -0.07427888064084137
Bond Position:  [-9.29354522]


portfolio before change:  [-16.681107]
curr_Stock_Price:  99.4258131091261
curr_Factors:  [99.42581311]
mat_Sqrt:  [[0.15]]
grads:  [0.05254387]
Stock Position:  0.052543867636647
Bond Position:  [-21.90532377]


portfolio before change:  [-16.71959773]
curr_Stock_Price:  98.79750550153803
curr_Factors:  [98.7975055]
mat_Sqrt:  [[0.15]]
grads:  [0.03232115]
Stock Position:  0.032321153417494336
Bond Position:  [-19.91284706]


portfolio before change:  [-16.75001484]
curr_Stock_Price:  98.0104582192398
curr_Factors:  [98.01045822]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291028]
Stock Position:  -0.012910276582128037
Bond Position:  [-15.48467272]


portfolio before change:  [-16.75926582]
curr_Stock_Price:  98.42712881642252
curr_Factors:  [98.42712882]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.75926582]
Stock Price:  100.27463138843223
PL:  [-17.03389721]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.91995567e-02]
 [-4.84930122e-05]
 [-3.98033136e-03]
 [-2.70864337e-03]
 [-5.50160786e-03]
 [ 7.64001492e-04]
 [ 1.65460287e-03]
 [-2.53968881e-03]
 [ 4.45831910e-03]
 [-1.29858752e-02]
 [-1.75233932e-02]
 [ 5.59913420e-03]
 [-1.81777005e-02]
 [-5.51863180e-04]
 [-1.68662609e-02]
 [ 7.24481552e-03]
 [ 4.45525157e-03]
 [-1.92251090e-03]
 [-1.28325277e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.1897551]
curr_Stock_Price:  98.83491736017395
curr_Factors:  [98.83491736]
mat_Sqrt:  [[0.15]]
grads:  [0.12799704]
Stock Position:  0.12799704457146677
Bond Position:  [-28.84033242]


portfolio before change:  [-16.3744319]
curr_Stock_Price:  97.44843361215808
curr_Factors:  [97.44843361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032329]
Stock Position:  -0.00032328674768704324
Bond Position:  [-16.34292812]


portfolio before change:  [-16.37824597]
curr_Stock_Price:  96.60653619827876
curr_Factors:  [96.6065362]
mat_Sqrt:  [[0.15]]
grads:  [-0.02653554]
Stock Position:  -0.026535542419283856
Bond Position:  [-13.81473913]


portfolio before change:  [-16.36181947]
curr_Stock_Price:  95.85732903161322
curr_Factors:  [95.85732903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01805762]
Stock Position:  -0.01805762245445222
Bond Position:  [-14.63086401]


portfolio before change:  [-16.37276662]
curr_Stock_Price:  96.26098008479632
curr_Factors:  [96.26098008]
mat_Sqrt:  [[0.15]]
grads:  [-0.03667739]
Stock Position:  -0.03667738574958051
Bond Position:  [-12.84216552]


portfolio before change:  [-16.39442077]
curr_Stock_Price:  96.76382971706536
curr_Factors:  [96.76382972]
mat_Sqrt:  [[0.15]]
grads:  [0.00509334]
Stock Position:  0.005093343277374022
Bond Position:  [-16.88727218]


portfolio before change:  [-16.40751662]
curr_Stock_Price:  95.02165390802169
curr_Factors:  [95.02165391]
mat_Sqrt:  [[0.15]]
grads:  [0.01103069]
Stock Position:  0.011030685773800408
Bond Position:  [-17.45567063]


portfolio before change:  [-16.41523087]
curr_Stock_Price:  94.7179748734716
curr_Factors:  [94.71797487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01693126]
Stock Position:  -0.016931258753144544
Bond Position:  [-14.81153633]


portfolio before change:  [-16.40828238]
curr_Stock_Price:  94.08885246614108
curr_Factors:  [94.08885247]
mat_Sqrt:  [[0.15]]
grads:  [0.02972213]
Stock Position:  0.02972212732945359
Bond Position:  [-19.20480324]


portfolio before change:  [-16.37414143]
curr_Stock_Price:  95.39908029219295
curr_Factors:  [95.39908029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0865725]
Stock Position:  -0.08657250108318004
Bond Position:  [-8.11520444]


portfolio before change:  [-16.34038561]
curr_Stock_Price:  94.98572885293142
curr_Factors:  [94.98572885]
mat_Sqrt:  [[0.15]]
grads:  [-0.11682262]
Stock Position:  -0.11682262100094976
Bond Position:  [-5.24390381]


portfolio before change:  [-16.5872004]
curr_Stock_Price:  97.08723662270882
curr_Factors:  [97.08723662]
mat_Sqrt:  [[0.15]]
grads:  [0.03732756]
Stock Position:  0.03732756133421242
Bond Position:  [-20.21123018]


portfolio before change:  [-16.52192237]
curr_Stock_Price:  98.97140661623018
curr_Factors:  [98.97140662]
mat_Sqrt:  [[0.15]]
grads:  [-0.12118467]
Stock Position:  -0.12118467024692613
Bond Position:  [-4.52810509]


portfolio before change:  [-16.37636781]
curr_Stock_Price:  97.76096697114716
curr_Factors:  [97.76096697]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367909]
Stock Position:  -0.0036790878659562166
Bond Position:  [-16.01669662]


portfolio before change:  [-16.37661965]
curr_Stock_Price:  96.74092460491093
curr_Factors:  [96.7409246]
mat_Sqrt:  [[0.15]]
grads:  [-0.11244174]
Stock Position:  -0.11244173929520386
Bond Position:  [-5.49890183]


portfolio before change:  [-16.42586782]
curr_Stock_Price:  97.16668525406659
curr_Factors:  [97.16668525]
mat_Sqrt:  [[0.15]]
grads:  [0.04829877]
Stock Position:  0.048298770119697715
Bond Position:  [-21.11889921]


portfolio before change:  [-16.38793675]
curr_Stock_Price:  98.06135515525814
curr_Factors:  [98.06135516]
mat_Sqrt:  [[0.15]]
grads:  [0.02970168]
Stock Position:  0.02970167711476526
Bond Position:  [-19.30052346]


portfolio before change:  [-16.34850689]
curr_Stock_Price:  99.55135818095242
curr_Factors:  [99.55135818]
mat_Sqrt:  [[0.15]]
grads:  [-0.01281674]
Stock Position:  -0.012816739312881808
Bond Position:  [-15.07258309]


portfolio before change:  [-16.35323855]
curr_Stock_Price:  99.62649769531801
curr_Factors:  [99.6264977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.35323855]
Stock Price:  98.40609472064868
PL:  [-16.35323855]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.82388140e-03]
 [ 8.43149159e-03]
 [ 1.39188386e-03]
 [ 3.83482695e-03]
 [ 1.59949463e-03]
 [ 4.64438823e-03]
 [-5.13113419e-03]
 [ 6.44909981e-03]
 [ 4.67937581e-03]
 [-1.51405909e-03]
 [-1.75727559e-02]
 [ 6.05032248e-03]
 [-6.86093860e-03]
 [ 1.16820821e-03]
 [-1.23404998e-02]
 [ 7.87028220e-03]
 [ 7.50674294e-03]
 [-3.20954505e-03]
 [-1.28465551e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.19758909]
curr_Stock_Price:  100.93602571608986
curr_Factors:  [100.93602572]
mat_Sqrt:  [[0.15]]
grads:  [0.05882588]
Stock Position:  0.05882587598662881
Bond Position:  [10.25993896]


portfolio before change:  [16.1666039]
curr_Stock_Price:  100.36568998821515
curr_Factors:  [100.36568999]
mat_Sqrt:  [[0.15]]
grads:  [0.05620994]
Stock Position:  0.05620994392733273
Bond Position:  [10.52505409]


portfolio before change:  [16.1405169]
curr_Stock_Price:  99.85477343846102
curr_Factors:  [99.85477344]
mat_Sqrt:  [[0.15]]
grads:  [0.00927923]
Stock Position:  0.009279225706526858
Bond Position:  [15.21394192]


portfolio before change:  [16.14731434]
curr_Stock_Price:  100.177373551226
curr_Factors:  [100.17737355]
mat_Sqrt:  [[0.15]]
grads:  [0.02556551]
Stock Position:  0.025565512980159126
Bond Position:  [13.5862284]


portfolio before change:  [16.10922746]
curr_Stock_Price:  98.55472423999561
curr_Factors:  [98.55472424]
mat_Sqrt:  [[0.15]]
grads:  [0.0106633]
Stock Position:  0.010663297532617876
Bond Position:  [15.05830911]


portfolio before change:  [16.11268785]
curr_Stock_Price:  98.52615367933156
curr_Factors:  [98.52615368]
mat_Sqrt:  [[0.15]]
grads:  [0.03096259]
Stock Position:  0.03096258821544048
Bond Position:  [13.06206313]


portfolio before change:  [16.07459885]
curr_Stock_Price:  97.19051203653552
curr_Factors:  [97.19051204]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420756]
Stock Position:  -0.034207561246902274
Bond Position:  [19.39924925]


portfolio before change:  [16.09011622]
curr_Stock_Price:  96.87868187638334
curr_Factors:  [96.87868188]
mat_Sqrt:  [[0.15]]
grads:  [0.042994]
Stock Position:  0.0429939987343177
Bond Position:  [11.92491429]


portfolio before change:  [16.10936599]
curr_Stock_Price:  97.25706426179885
curr_Factors:  [97.25706426]
mat_Sqrt:  [[0.15]]
grads:  [0.03119584]
Stock Position:  0.031195838710969138
Bond Position:  [13.0753503]


portfolio before change:  [16.10144585]
curr_Stock_Price:  96.89838201077617
curr_Factors:  [96.89838201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01009373]
Stock Position:  -0.010093727258453587
Bond Position:  [17.07951169]


portfolio before change:  [16.12015072]
curr_Stock_Price:  95.46833901010434
curr_Factors:  [95.46833901]
mat_Sqrt:  [[0.15]]
grads:  [-0.11715171]
Stock Position:  -0.11715170579498407
Bond Position:  [27.30442949]


portfolio before change:  [15.9787878]
curr_Stock_Price:  96.73327905938046
curr_Factors:  [96.73327906]
mat_Sqrt:  [[0.15]]
grads:  [0.04033548]
Stock Position:  0.04033548322897598
Bond Position:  [12.07700424]


portfolio before change:  [16.01731859]
curr_Stock_Price:  97.61367429985904
curr_Factors:  [97.6136743]
mat_Sqrt:  [[0.15]]
grads:  [-0.04573959]
Stock Position:  -0.04573959064001409
Bond Position:  [20.4821281]


portfolio before change:  [15.9790356]
curr_Stock_Price:  98.56261520252153
curr_Factors:  [98.5626152]
mat_Sqrt:  [[0.15]]
grads:  [0.00778805]
Stock Position:  0.007788054757509322
Bond Position:  [15.21142455]


portfolio before change:  [15.9914853]
curr_Stock_Price:  99.67282462121155
curr_Factors:  [99.67282462]
mat_Sqrt:  [[0.15]]
grads:  [-0.08227]
Stock Position:  -0.0822699983614501
Bond Position:  [24.19156842]


portfolio before change:  [16.01311749]
curr_Stock_Price:  99.48340511904414
curr_Factors:  [99.48340512]
mat_Sqrt:  [[0.15]]
grads:  [0.05246855]
Stock Position:  0.05246854802418099
Bond Position:  [10.79336767]


portfolio before change:  [16.07535149]
curr_Stock_Price:  100.618091015211
curr_Factors:  [100.61809102]
mat_Sqrt:  [[0.15]]
grads:  [0.05004495]
Stock Position:  0.05004495296205441
Bond Position:  [11.03992386]


portfolio before change:  [16.11211306]
curr_Stock_Price:  101.29750502135181
curr_Factors:  [101.29750502]
mat_Sqrt:  [[0.15]]
grads:  [-0.02139697]
Stock Position:  -0.021396967011487255
Bond Position:  [18.27957243]


portfolio before change:  [16.14576194]
curr_Stock_Price:  99.93850803961182
curr_Factors:  [99.93850804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.14576194]
Stock Price:  99.95297335240576
PL:  [16.14576194]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.99965485e-03]
 [ 6.68634802e-03]
 [ 1.07725856e-03]
 [ 9.21051331e-03]
 [ 1.75585132e-02]
 [ 3.99943633e-03]
 [ 7.62356394e-03]
 [ 1.33977215e-02]
 [ 4.15257631e-03]
 [ 9.20590524e-03]
 [-1.74860966e-02]
 [ 6.22854615e-03]
 [-1.64280587e-02]
 [ 1.26378653e-03]
 [-1.17734727e-02]
 [ 7.92869830e-03]
 [ 7.45299148e-03]
 [-1.82528659e-03]
 [-1.27120091e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.07960684]
curr_Stock_Price:  100.47425114474913
curr_Factors:  [100.47425114]
mat_Sqrt:  [[0.15]]
grads:  [0.0399977]
Stock Position:  0.03999769900443736
Bond Position:  [5.06086799]


portfolio before change:  [9.08959188]
curr_Stock_Price:  100.6922552424484
curr_Factors:  [100.69225524]
mat_Sqrt:  [[0.15]]
grads:  [0.04457565]
Stock Position:  0.0445756534757066
Bond Position:  [4.6011688]


portfolio before change:  [9.12797493]
curr_Stock_Price:  101.52752315382635
curr_Factors:  [101.52752315]
mat_Sqrt:  [[0.15]]
grads:  [0.00718172]
Stock Position:  0.007181723704548983
Bond Position:  [8.39883231]


portfolio before change:  [9.12411378]
curr_Stock_Price:  100.69748324726893
curr_Factors:  [100.69748325]
mat_Sqrt:  [[0.15]]
grads:  [0.06140342]
Stock Position:  0.06140342209143877
Bond Position:  [2.94094372]


portfolio before change:  [9.1380704]
curr_Stock_Price:  100.91280173946289
curr_Factors:  [100.91280174]
mat_Sqrt:  [[0.15]]
grads:  [0.11705675]
Stock Position:  0.11705675436626864
Bond Position:  [-2.67445464]


portfolio before change:  [9.11994444]
curr_Stock_Price:  100.76366664763606
curr_Factors:  [100.76366665]
mat_Sqrt:  [[0.15]]
grads:  [0.02666291]
Stock Position:  0.026662908875712005
Bond Position:  [6.43329197]


portfolio before change:  [9.11403969]
curr_Stock_Price:  100.48187935750983
curr_Factors:  [100.48187936]
mat_Sqrt:  [[0.15]]
grads:  [0.05082376]
Stock Position:  0.0508237596192621
Bond Position:  [4.00717281]


portfolio before change:  [9.12928015]
curr_Stock_Price:  100.76203448511086
curr_Factors:  [100.76203449]
mat_Sqrt:  [[0.15]]
grads:  [0.08931814]
Stock Position:  0.08931814300469142
Bond Position:  [0.12940234]


portfolio before change:  [9.15638384]
curr_Stock_Price:  101.06512342915786
curr_Factors:  [101.06512343]
mat_Sqrt:  [[0.15]]
grads:  [0.02768384]
Stock Position:  0.027683842055047227
Bond Position:  [6.35851293]


portfolio before change:  [9.12820072]
curr_Stock_Price:  99.98966049859995
curr_Factors:  [99.9896605]
mat_Sqrt:  [[0.15]]
grads:  [0.0613727]
Stock Position:  0.06137270159786708
Bond Position:  [2.99156513]


portfolio before change:  [9.12186607]
curr_Stock_Price:  99.87425683044522
curr_Factors:  [99.87425683]
mat_Sqrt:  [[0.15]]
grads:  [-0.11657398]
Stock Position:  -0.11657397714521128
Bond Position:  [20.76460541]


portfolio before change:  [9.22847975]
curr_Stock_Price:  99.00423527871357
curr_Factors:  [99.00423528]
mat_Sqrt:  [[0.15]]
grads:  [0.04152364]
Stock Position:  0.041523641028703484
Bond Position:  [5.11746342]


portfolio before change:  [9.2194786]
curr_Stock_Price:  98.75664940584228
curr_Factors:  [98.75664941]
mat_Sqrt:  [[0.15]]
grads:  [-0.10952039]
Stock Position:  -0.10952039165933444
Bond Position:  [20.03534553]


portfolio before change:  [9.24071176]
curr_Stock_Price:  98.60851544999066
curr_Factors:  [98.60851545]
mat_Sqrt:  [[0.15]]
grads:  [0.00842524]
Stock Position:  0.008425243504438351
Bond Position:  [8.409911]


portfolio before change:  [9.2528973]
curr_Stock_Price:  99.80525281922583
curr_Factors:  [99.80525282]
mat_Sqrt:  [[0.15]]
grads:  [-0.07848982]
Stock Position:  -0.07848981803359648
Bond Position:  [17.08659343]


portfolio before change:  [9.30580394]
curr_Stock_Price:  99.18562518113761
curr_Factors:  [99.18562518]
mat_Sqrt:  [[0.15]]
grads:  [0.05285799]
Stock Position:  0.05285798866977054
Bond Position:  [4.06305129]


portfolio before change:  [9.34152469]
curr_Stock_Price:  99.84219306825138
curr_Factors:  [99.84219307]
mat_Sqrt:  [[0.15]]
grads:  [0.04968661]
Stock Position:  0.04968660986401659
Bond Position:  [4.3807046]


portfolio before change:  [9.27262924]
curr_Stock_Price:  98.43354862840589
curr_Factors:  [98.43354863]
mat_Sqrt:  [[0.15]]
grads:  [-0.01216858]
Stock Position:  -0.012168577234943632
Bond Position:  [10.47042548]


portfolio before change:  [9.28014366]
curr_Stock_Price:  98.03116098706816
curr_Factors:  [98.03116099]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.28014366]
Stock Price:  97.97244014482666
PL:  [9.28014366]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.05525437e-03]
 [ 6.22761009e-03]
 [ 1.18269038e-03]
 [ 8.64008929e-03]
 [ 1.12543255e-02]
 [ 3.92191179e-03]
 [-1.12628434e-02]
 [ 1.07987811e-02]
 [ 3.63917982e-03]
 [ 8.58771654e-03]
 [-1.70651957e-02]
 [-1.99023819e-03]
 [-1.66900387e-02]
 [ 2.21269203e-03]
 [ 1.54894733e-03]
 [ 5.39769839e-03]
 [ 7.49595296e-03]
 [-4.80987883e-03]
 [-1.22211874e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.30604553]
curr_Stock_Price:  100.87818739488776
curr_Factors:  [100.87818739]
mat_Sqrt:  [[0.15]]
grads:  [0.0537017]
Stock Position:  0.05370169580190397
Bond Position:  [9.8887158]


portfolio before change:  [15.30614997]
curr_Stock_Price:  100.83409098863662
curr_Factors:  [100.83409099]
mat_Sqrt:  [[0.15]]
grads:  [0.0415174]
Stock Position:  0.04151740062418914
Bond Position:  [11.11978062]


portfolio before change:  [15.28589695]
curr_Stock_Price:  100.27930392547677
curr_Factors:  [100.27930393]
mat_Sqrt:  [[0.15]]
grads:  [0.0078846]
Stock Position:  0.007884602508558445
Bond Position:  [14.4952345]


portfolio before change:  [15.29241539]
curr_Stock_Price:  100.64637131129598
curr_Factors:  [100.64637131]
mat_Sqrt:  [[0.15]]
grads:  [0.0576006]
Stock Position:  0.05760059525735914
Bond Position:  [9.49512449]


portfolio before change:  [15.2766942]
curr_Stock_Price:  100.3322205636106
curr_Factors:  [100.33222056]
mat_Sqrt:  [[0.15]]
grads:  [0.07502884]
Stock Position:  0.07502883652653171
Bond Position:  [7.74888442]


portfolio before change:  [15.22191492]
curr_Stock_Price:  99.57628802701939
curr_Factors:  [99.57628803]
mat_Sqrt:  [[0.15]]
grads:  [0.02614608]
Stock Position:  0.026146078571116026
Bond Position:  [12.61838547]


portfolio before change:  [15.20382595]
curr_Stock_Price:  98.76377762573104
curr_Factors:  [98.76377763]
mat_Sqrt:  [[0.15]]
grads:  [-0.07508562]
Stock Position:  -0.07508562289207747
Bond Position:  [22.61956571]


portfolio before change:  [15.22082909]
curr_Stock_Price:  98.61264964662253
curr_Factors:  [98.61264965]
mat_Sqrt:  [[0.15]]
grads:  [0.07199187]
Stock Position:  0.07199187384937261
Bond Position:  [8.12151965]


portfolio before change:  [15.36413239]
curr_Stock_Price:  100.57499148406117
curr_Factors:  [100.57499148]
mat_Sqrt:  [[0.15]]
grads:  [0.0242612]
Stock Position:  0.024261198829412772
Bond Position:  [12.92406252]


portfolio before change:  [15.35964238]
curr_Stock_Price:  100.25672910036155
curr_Factors:  [100.2567291]
mat_Sqrt:  [[0.15]]
grads:  [0.05725144]
Stock Position:  0.05725144357699248
Bond Position:  [9.61979991]


portfolio before change:  [15.35881209]
curr_Stock_Price:  100.20021456664472
curr_Factors:  [100.20021457]
mat_Sqrt:  [[0.15]]
grads:  [-0.11376797]
Stock Position:  -0.1137679710935733
Bond Position:  [26.75838721]


portfolio before change:  [15.3285289]
curr_Stock_Price:  100.5252060834047
curr_Factors:  [100.52520608]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326825]
Stock Position:  -0.013268254633331455
Bond Position:  [16.66232293]


portfolio before change:  [15.355734]
curr_Stock_Price:  98.78880575289682
curr_Factors:  [98.78880575]
mat_Sqrt:  [[0.15]]
grads:  [-0.11126692]
Stock Position:  -0.1112669248245112
Bond Position:  [26.34766063]


portfolio before change:  [15.33247029]
curr_Stock_Price:  99.0570925820214
curr_Factors:  [99.05709258]
mat_Sqrt:  [[0.15]]
grads:  [0.01475128]
Stock Position:  0.014751280227046163
Bond Position:  [13.87125136]


portfolio before change:  [15.37069981]
curr_Stock_Price:  101.41358464701432
curr_Factors:  [101.41358465]
mat_Sqrt:  [[0.15]]
grads:  [0.01032632]
Stock Position:  0.010326315553574942
Bond Position:  [14.32347114]


portfolio before change:  [15.37739412]
curr_Stock_Price:  101.71504639367467
curr_Factors:  [101.71504639]
mat_Sqrt:  [[0.15]]
grads:  [0.03598466]
Stock Position:  0.03598465595886913
Bond Position:  [11.71721317]


portfolio before change:  [15.4060063]
curr_Stock_Price:  102.4287536969963
curr_Factors:  [102.4287537]
mat_Sqrt:  [[0.15]]
grads:  [0.04997302]
Stock Position:  0.04997301972102848
Bond Position:  [10.28733217]


portfolio before change:  [15.4212634]
curr_Stock_Price:  102.68258960981181
curr_Factors:  [102.68258961]
mat_Sqrt:  [[0.15]]
grads:  [-0.03206586]
Stock Position:  -0.032065858838253025
Bond Position:  [18.71386882]


portfolio before change:  [15.45908484]
curr_Stock_Price:  101.6490172672001
curr_Factors:  [101.64901727]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.45908484]
Stock Price:  100.29921617086042
PL:  [15.15986867]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.70031616e-02]
 [ 7.54003122e-03]
 [ 1.15719844e-03]
 [ 8.28669700e-03]
 [ 6.71379797e-04]
 [ 4.57488154e-03]
 [-1.17544021e-02]
 [ 1.23649062e-02]
 [ 2.64505740e-03]
 [ 8.66065929e-03]
 [-1.84140698e-02]
 [ 5.49870543e-03]
 [-1.57357982e-02]
 [ 1.69151142e-03]
 [-1.08771425e-02]
 [ 7.93436655e-03]
 [ 6.86344127e-03]
 [-3.29481863e-03]
 [-1.24186239e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.6723446]
curr_Stock_Price:  101.55069445409961
curr_Factors:  [101.55069445]
mat_Sqrt:  [[0.15]]
grads:  [0.11335441]
Stock Position:  0.11335441084661997
Bond Position:  [14.16112546]


portfolio before change:  [25.56154747]
curr_Stock_Price:  100.54201856768778
curr_Factors:  [100.54201857]
mat_Sqrt:  [[0.15]]
grads:  [0.05026687]
Stock Position:  0.05026687481158843
Bond Position:  [20.50761441]


portfolio before change:  [25.62092902]
curr_Stock_Price:  101.62133790110632
curr_Factors:  [101.6213379]
mat_Sqrt:  [[0.15]]
grads:  [0.00771466]
Stock Position:  0.007714656258822805
Bond Position:  [24.83695533]


portfolio before change:  [25.61937322]
curr_Stock_Price:  100.61470615812341
curr_Factors:  [100.61470616]
mat_Sqrt:  [[0.15]]
grads:  [0.05524465]
Stock Position:  0.05524464665361881
Bond Position:  [20.06094933]


portfolio before change:  [25.49199373]
curr_Stock_Price:  98.21817798094442
curr_Factors:  [98.21817798]
mat_Sqrt:  [[0.15]]
grads:  [0.00447587]
Stock Position:  0.004475865312857982
Bond Position:  [25.0523824]


portfolio before change:  [25.4992488]
curr_Stock_Price:  98.43963084584517
curr_Factors:  [98.43963085]
mat_Sqrt:  [[0.15]]
grads:  [0.03049921]
Stock Position:  0.030499210237423906
Bond Position:  [22.49691781]


portfolio before change:  [25.51669597]
curr_Stock_Price:  98.82725519360592
curr_Factors:  [98.82725519]
mat_Sqrt:  [[0.15]]
grads:  [-0.07836268]
Stock Position:  -0.07836268086069109
Bond Position:  [33.26106463]


portfolio before change:  [25.51313842]
curr_Stock_Price:  98.97877964738457
curr_Factors:  [98.97877965]
mat_Sqrt:  [[0.15]]
grads:  [0.08243271]
Stock Position:  0.08243270815358149
Bond Position:  [17.35404956]


portfolio before change:  [25.58013215]
curr_Stock_Price:  99.73885025188419
curr_Factors:  [99.73885025]
mat_Sqrt:  [[0.15]]
grads:  [0.01763372]
Stock Position:  0.017633715980603943
Bond Position:  [23.82136559]


portfolio before change:  [25.60531818]
curr_Stock_Price:  100.82937158297027
curr_Factors:  [100.82937158]
mat_Sqrt:  [[0.15]]
grads:  [0.05773773]
Stock Position:  0.05773772862558425
Bond Position:  [19.78365928]


portfolio before change:  [25.5162086]
curr_Stock_Price:  99.20034821533707
curr_Factors:  [99.20034822]
mat_Sqrt:  [[0.15]]
grads:  [-0.12276047]
Stock Position:  -0.12276046500055605
Bond Position:  [37.69408948]


portfolio before change:  [25.65199684]
curr_Stock_Price:  98.17099775884817
curr_Factors:  [98.17099776]
mat_Sqrt:  [[0.15]]
grads:  [0.03665804]
Stock Position:  0.03665803618405169
Bond Position:  [22.05324085]


portfolio before change:  [25.67586483]
curr_Stock_Price:  98.6716788969891
curr_Factors:  [98.6716789]
mat_Sqrt:  [[0.15]]
grads:  [-0.10490532]
Stock Position:  -0.10490532106308889
Bond Position:  [36.02704898]


portfolio before change:  [25.66995037]
curr_Stock_Price:  98.81392479351258
curr_Factors:  [98.81392479]
mat_Sqrt:  [[0.15]]
grads:  [0.01127674]
Stock Position:  0.011276742775639522
Bond Position:  [24.55565115]


portfolio before change:  [25.68965245]
curr_Stock_Price:  100.0166129703381
curr_Factors:  [100.01661297]
mat_Sqrt:  [[0.15]]
grads:  [-0.07251428]
Stock Position:  -0.0725142830546488
Bond Position:  [32.94228543]


portfolio before change:  [25.76024278]
curr_Stock_Price:  99.15673092604153
curr_Factors:  [99.15673093]
mat_Sqrt:  [[0.15]]
grads:  [0.05289578]
Stock Position:  0.05289577696886666
Bond Position:  [20.51527046]


portfolio before change:  [25.78585861]
curr_Stock_Price:  99.54402787788064
curr_Factors:  [99.54402788]
mat_Sqrt:  [[0.15]]
grads:  [0.04575628]
Stock Position:  0.04575627513215451
Bond Position:  [21.23109469]


portfolio before change:  [25.8752035]
curr_Stock_Price:  101.38063816134682
curr_Factors:  [101.38063816]
mat_Sqrt:  [[0.15]]
grads:  [-0.02196546]
Stock Position:  -0.02196545753837335
Bond Position:  [28.1020756]


portfolio before change:  [25.88882312]
curr_Stock_Price:  101.080474789962
curr_Factors:  [101.08047479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.88882312]
Stock Price:  100.45516497640493
PL:  [25.43365814]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.76626646e-03]
 [ 6.03581094e-03]
 [ 7.86682007e-04]
 [ 3.21969580e-03]
 [ 5.88054369e-03]
 [ 4.29122586e-03]
 [-6.08290454e-03]
 [ 1.02167167e-02]
 [ 2.74932367e-03]
 [ 8.44584538e-03]
 [-1.85371233e-02]
 [ 6.15414807e-03]
 [-8.62543997e-03]
 [-1.03922139e-03]
 [-1.65779427e-02]
 [ 7.90437180e-03]
 [ 5.01964318e-03]
 [-1.73667310e-03]
 [-1.27976530e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.58643758]
curr_Stock_Price:  99.8471726606563
curr_Factors:  [99.84717266]
mat_Sqrt:  [[0.15]]
grads:  [0.01177511]
Stock Position:  0.01177510970919652
Bond Position:  [-1.76214899]


portfolio before change:  [-0.57314509]
curr_Stock_Price:  101.01345329660353
curr_Factors:  [101.0134533]
mat_Sqrt:  [[0.15]]
grads:  [0.04023874]
Stock Position:  0.040238739587787675
Bond Position:  [-4.63779913]


portfolio before change:  [-0.64995732]
curr_Stock_Price:  99.13335856500112
curr_Factors:  [99.13335857]
mat_Sqrt:  [[0.15]]
grads:  [0.00524455]
Stock Position:  0.0052445467119698105
Bond Position:  [-1.16986685]


portfolio before change:  [-0.64790026]
curr_Stock_Price:  99.58136070502051
curr_Factors:  [99.58136071]
mat_Sqrt:  [[0.15]]
grads:  [0.02146464]
Stock Position:  0.021464638683421806
Bond Position:  [-2.78537819]


portfolio before change:  [-0.64665943]
curr_Stock_Price:  99.67161424564353
curr_Factors:  [99.67161425]
mat_Sqrt:  [[0.15]]
grads:  [0.03920362]
Stock Position:  0.03920362462991882
Bond Position:  [-4.55414798]


portfolio before change:  [-0.70218246]
curr_Stock_Price:  98.28438676050946
curr_Factors:  [98.28438676]
mat_Sqrt:  [[0.15]]
grads:  [0.02860817]
Stock Position:  0.028608172382482037
Bond Position:  [-3.51391913]


portfolio before change:  [-0.72381524]
curr_Stock_Price:  97.55892297849736
curr_Factors:  [97.55892298]
mat_Sqrt:  [[0.15]]
grads:  [-0.0405527]
Stock Position:  -0.040552696952184206
Bond Position:  [3.2324622]


portfolio before change:  [-0.75472289]
curr_Stock_Price:  98.34101317350914
curr_Factors:  [98.34101317]
mat_Sqrt:  [[0.15]]
grads:  [0.06811144]
Stock Position:  0.0681114445854618
Bond Position:  [-7.45287136]


portfolio before change:  [-0.66756101]
curr_Stock_Price:  99.64806708637286
curr_Factors:  [99.64806709]
mat_Sqrt:  [[0.15]]
grads:  [0.01832882]
Stock Position:  0.01832882449582021
Bond Position:  [-2.49399294]


portfolio before change:  [-0.64922876]
curr_Stock_Price:  100.68227542870841
curr_Factors:  [100.68227543]
mat_Sqrt:  [[0.15]]
grads:  [0.05630564]
Stock Position:  0.0563056358486191
Bond Position:  [-6.3182083]


portfolio before change:  [-0.75854917]
curr_Stock_Price:  98.76877847001145
curr_Factors:  [98.76877847]
mat_Sqrt:  [[0.15]]
grads:  [-0.12358082]
Stock Position:  -0.12358082177624297
Bond Position:  [11.44737764]


portfolio before change:  [-0.77535961]
curr_Stock_Price:  98.92796687865346
curr_Factors:  [98.92796688]
mat_Sqrt:  [[0.15]]
grads:  [0.04102765]
Stock Position:  0.04102765381180543
Bond Position:  [-4.83414198]


portfolio before change:  [-0.82287031]
curr_Stock_Price:  97.79941059243068
curr_Factors:  [97.79941059]
mat_Sqrt:  [[0.15]]
grads:  [-0.05750293]
Stock Position:  -0.05750293310080879
Bond Position:  [4.80088266]


portfolio before change:  [-0.80490425]
curr_Stock_Price:  97.50784830565549
curr_Factors:  [97.50784831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692814]
Stock Position:  -0.006928142631059573
Bond Position:  [-0.12935597]


portfolio before change:  [-0.8101196]
curr_Stock_Price:  98.25595791415319
curr_Factors:  [98.25595791]
mat_Sqrt:  [[0.15]]
grads:  [-0.11051962]
Stock Position:  -0.11051961767659785
Bond Position:  [10.0490913]


portfolio before change:  [-0.85381928]
curr_Stock_Price:  98.67409422057004
curr_Factors:  [98.67409422]
mat_Sqrt:  [[0.15]]
grads:  [0.05269581]
Stock Position:  0.05269581197220069
Bond Position:  [-6.0535308]


portfolio before change:  [-0.84278489]
curr_Stock_Price:  98.91221491508172
curr_Factors:  [98.91221492]
mat_Sqrt:  [[0.15]]
grads:  [0.03346429]
Stock Position:  0.033464287845174925
Bond Position:  [-4.15281172]


portfolio before change:  [-0.85001784]
curr_Stock_Price:  98.72710377978527
curr_Factors:  [98.72710378]
mat_Sqrt:  [[0.15]]
grads:  [-0.01157782]
Stock Position:  -0.011577820665521694
Bond Position:  [0.29302687]


portfolio before change:  [-0.85297673]
curr_Stock_Price:  98.98899745667624
curr_Factors:  [98.98899746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.85297673]
Stock Price:  97.70241955383665
PL:  [-0.85297673]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.85348699e-04]
 [ 8.67234898e-03]
 [ 6.97465592e-04]
 [ 3.88969845e-03]
 [ 1.34260514e-02]
 [ 6.51763533e-03]
 [ 1.96228979e-02]
 [ 1.28512986e-02]
 [ 4.44968583e-03]
 [ 9.25603244e-03]
 [-1.70499527e-02]
 [-2.81934828e-03]
 [-2.60527028e-02]
 [ 2.04506194e-03]
 [-5.88804035e-03]
 [ 7.73248011e-03]
 [ 7.51338049e-03]
 [-2.02548374e-03]
 [-1.25742985e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.74051235]
curr_Stock_Price:  99.70742842963986
curr_Factors:  [99.70742843]
mat_Sqrt:  [[0.15]]
grads:  [0.00523566]
Stock Position:  0.005235657996458711
Bond Position:  [-3.26254635]


portfolio before change:  [-2.73891501]
curr_Stock_Price:  100.1683217830434
curr_Factors:  [100.16832178]
mat_Sqrt:  [[0.15]]
grads:  [0.05781566]
Stock Position:  0.05781565989699515
Bond Position:  [-8.53021263]


portfolio before change:  [-2.69335223]
curr_Stock_Price:  100.99328172503364
curr_Factors:  [100.99328173]
mat_Sqrt:  [[0.15]]
grads:  [0.00464977]
Stock Position:  0.004649770614174359
Bond Position:  [-3.16294782]


portfolio before change:  [-2.69780054]
curr_Stock_Price:  100.20668756931535
curr_Factors:  [100.20668757]
mat_Sqrt:  [[0.15]]
grads:  [0.02593132]
Stock Position:  0.025931323012958557
Bond Position:  [-5.29629253]


portfolio before change:  [-2.69096191]
curr_Stock_Price:  100.52147562012424
curr_Factors:  [100.52147562]
mat_Sqrt:  [[0.15]]
grads:  [0.08950701]
Stock Position:  0.08950700934805932
Bond Position:  [-11.68833857]


portfolio before change:  [-2.61411945]
curr_Stock_Price:  101.41263385683037
curr_Factors:  [101.41263386]
mat_Sqrt:  [[0.15]]
grads:  [0.0434509]
Stock Position:  0.043450902199936615
Bond Position:  [-7.02058989]


portfolio before change:  [-2.64267911]
curr_Stock_Price:  100.79574705686728
curr_Factors:  [100.79574706]
mat_Sqrt:  [[0.15]]
grads:  [0.13081932]
Stock Position:  0.1308193194099575
Bond Position:  [-15.82871014]


portfolio before change:  [-2.71729784]
curr_Stock_Price:  100.2556046510943
curr_Factors:  [100.25560465]
mat_Sqrt:  [[0.15]]
grads:  [0.08567532]
Stock Position:  0.08567532391342404
Bond Position:  [-11.30672924]


portfolio before change:  [-2.61589091]
curr_Stock_Price:  101.47222064043024
curr_Factors:  [101.47222064]
mat_Sqrt:  [[0.15]]
grads:  [0.02966457]
Stock Position:  0.029664572184447225
Bond Position:  [-5.62602092]


portfolio before change:  [-2.61352081]
curr_Stock_Price:  101.59953689508463
curr_Factors:  [101.5995369]
mat_Sqrt:  [[0.15]]
grads:  [0.06170688]
Stock Position:  0.06170688290339954
Bond Position:  [-8.88291153]


portfolio before change:  [-2.70136121]
curr_Stock_Price:  100.21201916683079
curr_Factors:  [100.21201917]
mat_Sqrt:  [[0.15]]
grads:  [-0.11366635]
Stock Position:  -0.11366635123344816
Bond Position:  [8.68937336]


portfolio before change:  [-2.74415967]
curr_Stock_Price:  100.6076602534179
curr_Factors:  [100.60766025]
mat_Sqrt:  [[0.15]]
grads:  [-0.01879566]
Stock Position:  -0.01879565516983416
Bond Position:  [-0.85317278]


portfolio before change:  [-2.74191276]
curr_Stock_Price:  100.47676656439108
curr_Factors:  [100.47676656]
mat_Sqrt:  [[0.15]]
grads:  [-0.17368469]
Stock Position:  -0.17368468529255016
Bond Position:  [14.70936282]


portfolio before change:  [-2.83445367]
curr_Stock_Price:  101.03075160241387
curr_Factors:  [101.0307516]
mat_Sqrt:  [[0.15]]
grads:  [0.01363375]
Stock Position:  0.013633746249457665
Bond Position:  [-4.21188131]


portfolio before change:  [-2.84124975]
curr_Stock_Price:  100.60951903478941
curr_Factors:  [100.60951903]
mat_Sqrt:  [[0.15]]
grads:  [-0.0392536]
Stock Position:  -0.03925360236170431
Bond Position:  [1.1080363]


portfolio before change:  [-2.83748346]
curr_Stock_Price:  100.520629127542
curr_Factors:  [100.52062913]
mat_Sqrt:  [[0.15]]
grads:  [0.05154987]
Stock Position:  0.05154986742333682
Bond Position:  [-8.01930857]


portfolio before change:  [-2.84486887]
curr_Stock_Price:  100.41625780149523
curr_Factors:  [100.4162578]
mat_Sqrt:  [[0.15]]
grads:  [0.0500892]
Stock Position:  0.05008920329905466
Bond Position:  [-7.87463922]


portfolio before change:  [-2.87836147]
curr_Stock_Price:  99.7869066756447
curr_Factors:  [99.78690668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01350322]
Stock Position:  -0.013503224902302576
Bond Position:  [-1.53091643]


portfolio before change:  [-2.89019502]
curr_Stock_Price:  100.63490934742251
curr_Factors:  [100.63490935]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.89019502]
Stock Price:  101.98474016343955
PL:  [-4.87493518]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.49793153e-02]
 [ 5.84556228e-03]
 [-8.55983088e-04]
 [ 1.69443782e-03]
 [ 1.66110278e-03]
 [ 4.73038145e-03]
 [-8.70568294e-03]
 [ 9.71410603e-03]
 [ 4.72640561e-03]
 [ 1.06246535e-02]
 [-1.80752542e-02]
 [-5.80851499e-03]
 [-2.57519916e-02]
 [ 2.06864824e-03]
 [-6.48275079e-03]
 [ 5.06329023e-03]
 [ 7.48449502e-03]
 [-2.76977661e-03]
 [-1.27263879e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.65009646]
curr_Stock_Price:  98.54555555130939
curr_Factors:  [98.54555555]
mat_Sqrt:  [[0.15]]
grads:  [0.16652877]
Stock Position:  0.16652876884169485
Bond Position:  [-37.0607665]


portfolio before change:  [-20.63739833]
curr_Stock_Price:  98.67745155745385
curr_Factors:  [98.67745156]
mat_Sqrt:  [[0.15]]
grads:  [0.03897042]
Stock Position:  0.03897041516923426
Bond Position:  [-24.48289958]


portfolio before change:  [-20.648579]
curr_Stock_Price:  98.54763041757047
curr_Factors:  [98.54763042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00570655]
Stock Position:  -0.005706553919826752
Bond Position:  [-20.08621163]


portfolio before change:  [-20.65262157]
curr_Stock_Price:  98.37596672229549
curr_Factors:  [98.37596672]
mat_Sqrt:  [[0.15]]
grads:  [0.01129625]
Stock Position:  0.011296252154136868
Bond Position:  [-21.7639013]


portfolio before change:  [-20.65579307]
curr_Stock_Price:  98.5769325324425
curr_Factors:  [98.57693253]
mat_Sqrt:  [[0.15]]
grads:  [0.01107402]
Stock Position:  0.011074018545929086
Bond Position:  [-21.74743585]


portfolio before change:  [-20.66020962]
curr_Stock_Price:  98.66912863987078
curr_Factors:  [98.66912864]
mat_Sqrt:  [[0.15]]
grads:  [0.03153588]
Stock Position:  0.03153587634938748
Bond Position:  [-23.77182706]


portfolio before change:  [-20.67358225]
curr_Stock_Price:  98.43355799869381
curr_Factors:  [98.433558]
mat_Sqrt:  [[0.15]]
grads:  [-0.05803789]
Stock Position:  -0.058037886244247064
Bond Position:  [-14.96070661]


portfolio before change:  [-20.65833859]
curr_Stock_Price:  98.10645598700611
curr_Factors:  [98.10645599]
mat_Sqrt:  [[0.15]]
grads:  [0.06476071]
Stock Position:  0.06476070688763083
Bond Position:  [-27.01178203]


portfolio before change:  [-20.67404382]
curr_Stock_Price:  97.96823266667448
curr_Factors:  [97.96823267]
mat_Sqrt:  [[0.15]]
grads:  [0.03150937]
Stock Position:  0.031509370753771235
Bond Position:  [-23.76096118]


portfolio before change:  [-20.66915538]
curr_Stock_Price:  98.31192153464744
curr_Factors:  [98.31192153]
mat_Sqrt:  [[0.15]]
grads:  [0.07083102]
Stock Position:  0.070831023118378
Bond Position:  [-27.63268937]


portfolio before change:  [-20.59621977]
curr_Stock_Price:  99.43917684313338
curr_Factors:  [99.43917684]
mat_Sqrt:  [[0.15]]
grads:  [-0.12050169]
Stock Position:  -0.12050169457011164
Bond Position:  [-8.61363045]


portfolio before change:  [-20.77760536]
curr_Stock_Price:  100.92655774950533
curr_Factors:  [100.92655775]
mat_Sqrt:  [[0.15]]
grads:  [-0.03872343]
Stock Position:  -0.03872343329166302
Bond Position:  [-16.86938254]


portfolio before change:  [-20.78297648]
curr_Stock_Price:  100.95633929140958
curr_Factors:  [100.95633929]
mat_Sqrt:  [[0.15]]
grads:  [-0.17167994]
Stock Position:  -0.17167994380561571
Bond Position:  [-3.45079782]


portfolio before change:  [-20.77745776]
curr_Stock_Price:  100.91916824362517
curr_Factors:  [100.91916824]
mat_Sqrt:  [[0.15]]
grads:  [0.01379099]
Stock Position:  0.013790988243102814
Bond Position:  [-22.16923283]


portfolio before change:  [-20.78771296]
curr_Stock_Price:  100.57748143079442
curr_Factors:  [100.57748143]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321834]
Stock Position:  -0.043218338618640474
Bond Position:  [-16.44092131]


portfolio before change:  [-20.84611569]
curr_Stock_Price:  101.83370692701612
curr_Factors:  [101.83370693]
mat_Sqrt:  [[0.15]]
grads:  [0.03375527]
Stock Position:  0.033755268214579866
Bond Position:  [-24.28353978]


portfolio before change:  [-20.91759299]
curr_Stock_Price:  99.8960638716266
curr_Factors:  [99.89606387]
mat_Sqrt:  [[0.15]]
grads:  [0.04989663]
Stock Position:  0.049896633474986546
Bond Position:  [-25.90207028]


portfolio before change:  [-20.87753496]
curr_Stock_Price:  100.82867906741335
curr_Factors:  [100.82867907]
mat_Sqrt:  [[0.15]]
grads:  [-0.01846518]
Stock Position:  -0.01846517736891763
Bond Position:  [-19.01571552]


portfolio before change:  [-20.87238514]
curr_Stock_Price:  100.29229977038831
curr_Factors:  [100.29229977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.87238514]
Stock Price:  100.01193741015986
PL:  [-20.88432255]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.27615079e-02]
 [ 1.04619385e-03]
 [ 1.11915477e-03]
 [ 1.56294946e-02]
 [ 2.28947575e-02]
 [ 6.15945216e-03]
 [ 2.39975331e-02]
 [-1.35183095e-02]
 [ 1.07295813e-02]
 [-2.33582046e-02]
 [-1.00256075e-02]
 [-2.53958846e-02]
 [-1.95646029e-02]
 [ 6.88687350e-03]
 [ 3.77411778e-02]
 [ 2.09138512e-04]
 [ 6.69974600e-03]
 [-5.62545550e-03]
 [-9.69674448e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.72902279]
curr_Stock_Price:  98.15118907151736
curr_Factors:  [98.15118907]
mat_Sqrt:  [[0.15]]
grads:  [0.21841005]
Stock Position:  0.2184100528298962
Bond Position:  [-48.16622918]


portfolio before change:  [-26.83750563]
curr_Stock_Price:  97.70963531619635
curr_Factors:  [97.70963532]
mat_Sqrt:  [[0.15]]
grads:  [0.00697463]
Stock Position:  0.006974625635623987
Bond Position:  [-27.51899376]


portfolio before change:  [-26.82548914]
curr_Stock_Price:  100.41904309402378
curr_Factors:  [100.41904309]
mat_Sqrt:  [[0.15]]
grads:  [0.00746103]
Stock Position:  0.007461031767787766
Bond Position:  [-27.57471881]


portfolio before change:  [-26.81261012]
curr_Stock_Price:  103.06928685214113
curr_Factors:  [103.06928685]
mat_Sqrt:  [[0.15]]
grads:  [0.10419663]
Stock Position:  0.10419663033472373
Bond Position:  [-37.55208251]


portfolio before change:  [-26.63630399]
curr_Stock_Price:  104.85144940181421
curr_Factors:  [104.8514494]
mat_Sqrt:  [[0.15]]
grads:  [0.15263172]
Stock Position:  0.15263171690332114
Bond Position:  [-42.63996073]


portfolio before change:  [-26.75511451]
curr_Stock_Price:  104.14288629844944
curr_Factors:  [104.1428863]
mat_Sqrt:  [[0.15]]
grads:  [0.04106301]
Stock Position:  0.04106301441664218
Bond Position:  [-31.03153535]


portfolio before change:  [-26.68571096]
curr_Stock_Price:  106.0220081275017
curr_Factors:  [106.02200813]
mat_Sqrt:  [[0.15]]
grads:  [0.15998355]
Stock Position:  0.1599835542951881
Bond Position:  [-43.64748865]


portfolio before change:  [-26.58089776]
curr_Stock_Price:  106.74537267572379
curr_Factors:  [106.74537268]
mat_Sqrt:  [[0.15]]
grads:  [-0.09012206]
Stock Position:  -0.09012206336166245
Bond Position:  [-16.96078452]


portfolio before change:  [-26.53503092]
curr_Stock_Price:  106.1893760066784
curr_Factors:  [106.18937601]
mat_Sqrt:  [[0.15]]
grads:  [0.07153054]
Stock Position:  0.07153054202187907
Bond Position:  [-34.13081455]


portfolio before change:  [-26.56594705]
curr_Stock_Price:  105.87646976425992
curr_Factors:  [105.87646976]
mat_Sqrt:  [[0.15]]
grads:  [-0.15572136]
Stock Position:  -0.15572136428314937
Bond Position:  [-10.07871873]


portfolio before change:  [-26.44491546]
curr_Stock_Price:  105.08305528381625
curr_Factors:  [105.08305528]
mat_Sqrt:  [[0.15]]
grads:  [-0.06683738]
Stock Position:  -0.0668373832752729
Bond Position:  [-19.42143901]


portfolio before change:  [-26.4948701]
curr_Stock_Price:  105.75780758786591
curr_Factors:  [105.75780759]
mat_Sqrt:  [[0.15]]
grads:  [-0.1693059]
Stock Position:  -0.16930589749531003
Bond Position:  [-8.58944957]


portfolio before change:  [-26.49555074]
curr_Stock_Price:  105.74914283940534
curr_Factors:  [105.74914284]
mat_Sqrt:  [[0.15]]
grads:  [-0.13043069]
Stock Position:  -0.13043068600919253
Bond Position:  [-12.70261749]


portfolio before change:  [-26.59854479]
curr_Stock_Price:  106.51443820242991
curr_Factors:  [106.5144382]
mat_Sqrt:  [[0.15]]
grads:  [0.04591249]
Stock Position:  0.04591249002879305
Bond Position:  [-31.48888787]


portfolio before change:  [-26.63115282]
curr_Stock_Price:  105.97569980608635
curr_Factors:  [105.97569981]
mat_Sqrt:  [[0.15]]
grads:  [0.25160785]
Stock Position:  0.25160785188417384
Bond Position:  [-53.295471]


portfolio before change:  [-26.68576136]
curr_Stock_Price:  105.81162299539211
curr_Factors:  [105.811623]
mat_Sqrt:  [[0.15]]
grads:  [0.00139426]
Stock Position:  0.00139425674866431
Bond Position:  [-26.83328993]


portfolio before change:  [-26.6931679]
curr_Stock_Price:  105.31144619026212
curr_Factors:  [105.31144619]
mat_Sqrt:  [[0.15]]
grads:  [0.04466497]
Stock Position:  0.04466497332967383
Bond Position:  [-31.39690083]


portfolio before change:  [-26.5814324]
curr_Stock_Price:  107.98883971382953
curr_Factors:  [107.98883971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03750304]
Stock Position:  -0.03750303669491121
Bond Position:  [-22.53152298]


portfolio before change:  [-26.57251851]
curr_Stock_Price:  107.60093854732172
curr_Factors:  [107.60093855]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.57251851]
Stock Price:  106.19635121997621
PL:  [-32.76886973]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.10407482e-03]
 [ 8.59421844e-03]
 [ 1.23851221e-03]
 [ 1.40070307e-02]
 [ 2.26719967e-02]
 [ 6.73664776e-03]
 [ 3.31506992e-02]
 [ 1.20158342e-02]
 [ 6.67108086e-03]
 [ 9.36841865e-03]
 [-1.31767310e-02]
 [-7.87254595e-03]
 [-2.54126154e-02]
 [ 2.90607038e-03]
 [-7.29785924e-03]
 [ 7.25220243e-03]
 [ 7.49097506e-03]
 [-3.99651031e-03]
 [-1.28055108e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.78638079]
curr_Stock_Price:  99.44495528764364
curr_Factors:  [99.44495529]
mat_Sqrt:  [[0.15]]
grads:  [0.04069383]
Stock Position:  0.040693832117646184
Bond Position:  [-10.83317711]


portfolio before change:  [-6.75612693]
curr_Stock_Price:  100.25496723995428
curr_Factors:  [100.25496724]
mat_Sqrt:  [[0.15]]
grads:  [0.05729479]
Stock Position:  0.05729478960358937
Bond Position:  [-12.50021419]


portfolio before change:  [-6.76434854]
curr_Stock_Price:  100.16602089821231
curr_Factors:  [100.1660209]
mat_Sqrt:  [[0.15]]
grads:  [0.00825675]
Stock Position:  0.008256748073108345
Bond Position:  [-7.59139414]


portfolio before change:  [-6.75363837]
curr_Stock_Price:  101.69304501168885
curr_Factors:  [101.69304501]
mat_Sqrt:  [[0.15]]
grads:  [0.0933802]
Stock Position:  0.09338020450567844
Bond Position:  [-16.24975571]


portfolio before change:  [-6.77178422]
curr_Stock_Price:  101.54223256357852
curr_Factors:  [101.54223256]
mat_Sqrt:  [[0.15]]
grads:  [0.15114664]
Stock Position:  0.15114664457496485
Bond Position:  [-22.11955195]


portfolio before change:  [-6.75981379]
curr_Stock_Price:  101.6580208019417
curr_Factors:  [101.6580208]
mat_Sqrt:  [[0.15]]
grads:  [0.04491099]
Stock Position:  0.044910985063066206
Bond Position:  [-11.32537565]


portfolio before change:  [-6.74600864]
curr_Stock_Price:  102.02846141155179
curr_Factors:  [102.02846141]
mat_Sqrt:  [[0.15]]
grads:  [0.22100466]
Stock Position:  0.22100466144993772
Bond Position:  [-29.29477421]


portfolio before change:  [-6.87158504]
curr_Stock_Price:  101.49339669526765
curr_Factors:  [101.4933967]
mat_Sqrt:  [[0.15]]
grads:  [0.08010556]
Stock Position:  0.08010556124473286
Bond Position:  [-15.00177055]


portfolio before change:  [-6.81970321]
curr_Stock_Price:  102.18788961139128
curr_Factors:  [102.18788961]
mat_Sqrt:  [[0.15]]
grads:  [0.04447387]
Stock Position:  0.0444738724268737
Bond Position:  [-11.36439438]


portfolio before change:  [-6.85294716]
curr_Stock_Price:  101.50428612082158
curr_Factors:  [101.50428612]
mat_Sqrt:  [[0.15]]
grads:  [0.06245612]
Stock Position:  0.06245612435861736
Bond Position:  [-13.19251148]


portfolio before change:  [-6.75376807]
curr_Stock_Price:  103.14508005102307
curr_Factors:  [103.14508005]
mat_Sqrt:  [[0.15]]
grads:  [-0.08784487]
Stock Position:  -0.08784487342642894
Bond Position:  [2.30699843]


portfolio before change:  [-6.6547333]
curr_Stock_Price:  102.02426401121359
curr_Factors:  [102.02426401]
mat_Sqrt:  [[0.15]]
grads:  [-0.05248364]
Stock Position:  -0.05248363967459316
Bond Position:  [-1.30012859]


portfolio before change:  [-6.60405345]
curr_Stock_Price:  101.05243882594
curr_Factors:  [101.05243883]
mat_Sqrt:  [[0.15]]
grads:  [-0.16941744]
Stock Position:  -0.16941743612132276
Bond Position:  [10.51599165]


portfolio before change:  [-6.46741614]
curr_Stock_Price:  100.26144595023757
curr_Factors:  [100.26144595]
mat_Sqrt:  [[0.15]]
grads:  [0.0193738]
Stock Position:  0.019373802523943554
Bond Position:  [-8.4098616]


portfolio before change:  [-6.46423592]
curr_Stock_Price:  100.53413135049057
curr_Factors:  [100.53413135]
mat_Sqrt:  [[0.15]]
grads:  [-0.04865239]
Stock Position:  -0.048652394913920274
Bond Position:  [-1.57300966]


portfolio before change:  [-6.48289929]
curr_Stock_Price:  100.90965380456726
curr_Factors:  [100.9096538]
mat_Sqrt:  [[0.15]]
grads:  [0.04834802]
Stock Position:  0.048348016188363485
Bond Position:  [-11.36168086]


portfolio before change:  [-6.41903533]
curr_Stock_Price:  102.2893326524439
curr_Factors:  [102.28933265]
mat_Sqrt:  [[0.15]]
grads:  [0.04993983]
Stock Position:  0.049939833705066744
Bond Position:  [-11.52734759]


portfolio before change:  [-6.43794887]
curr_Stock_Price:  101.96831949447545
curr_Factors:  [101.96831949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266434]
Stock Position:  -0.02664340205257071
Bond Position:  [-3.72116593]


portfolio before change:  [-6.38821474]
curr_Stock_Price:  100.06674047877269
curr_Factors:  [100.06674048]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.38821474]
Stock Price:  99.25816541654625
PL:  [-6.38821474]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.10431526e-03]
 [ 5.97758572e-03]
 [ 9.55142428e-04]
 [ 7.80524733e-03]
 [ 2.06253782e-02]
 [ 3.32375788e-03]
 [ 2.24163593e-02]
 [ 1.28275898e-02]
 [ 7.20485071e-03]
 [ 5.44270394e-03]
 [-1.38170871e-02]
 [-2.02489209e-02]
 [-2.06295590e-02]
 [ 5.40300300e-03]
 [ 3.15486962e-02]
 [ 1.06760874e-03]
 [ 6.73650566e-03]
 [-5.33102918e-03]
 [-9.94455299e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.62234198]
curr_Stock_Price:  99.9255914657703
curr_Factors:  [99.92559147]
mat_Sqrt:  [[0.15]]
grads:  [0.01402877]
Stock Position:  0.014028768396651115
Bond Position:  [-0.779491]


portfolio before change:  [0.63819087]
curr_Stock_Price:  101.06922580163008
curr_Factors:  [101.0692258]
mat_Sqrt:  [[0.15]]
grads:  [0.03985057]
Stock Position:  0.03985057144493188
Bond Position:  [-3.38947554]


portfolio before change:  [0.61783322]
curr_Stock_Price:  100.57964246711988
curr_Factors:  [100.57964247]
mat_Sqrt:  [[0.15]]
grads:  [0.00636762]
Stock Position:  0.006367616186732714
Bond Position:  [-0.02261934]


portfolio before change:  [0.61777614]
curr_Stock_Price:  100.57156662722379
curr_Factors:  [100.57156663]
mat_Sqrt:  [[0.15]]
grads:  [0.05203498]
Stock Position:  0.0520349821673912
Bond Position:  [-4.61546354]


portfolio before change:  [0.65350389]
curr_Stock_Price:  101.28035438145719
curr_Factors:  [101.28035438]
mat_Sqrt:  [[0.15]]
grads:  [0.13750252]
Stock Position:  0.13750252102813024
Bond Position:  [-13.27280017]


portfolio before change:  [0.52870322]
curr_Stock_Price:  100.39686474860069
curr_Factors:  [100.39686475]
mat_Sqrt:  [[0.15]]
grads:  [0.02215839]
Stock Position:  0.022158385894237513
Bond Position:  [-1.69592925]


portfolio before change:  [0.54034049]
curr_Stock_Price:  100.94118717218197
curr_Factors:  [100.94118717]
mat_Sqrt:  [[0.15]]
grads:  [0.1494424]
Stock Position:  0.14944239565792564
Bond Position:  [-14.54455234]


portfolio before change:  [0.58575894]
curr_Stock_Price:  101.26944103882595
curr_Factors:  [101.26944104]
mat_Sqrt:  [[0.15]]
grads:  [0.08551727]
Stock Position:  0.08551726564384765
Bond Position:  [-8.07452675]


portfolio before change:  [0.67849481]
curr_Stock_Price:  102.37745996287006
curr_Factors:  [102.37745996]
mat_Sqrt:  [[0.15]]
grads:  [0.04803234]
Stock Position:  0.04803233805328101
Bond Position:  [-4.23893396]


portfolio before change:  [0.66631663]
curr_Stock_Price:  102.14598450270573
curr_Factors:  [102.1459845]
mat_Sqrt:  [[0.15]]
grads:  [0.03628469]
Stock Position:  0.03628469295342334
Bond Position:  [-3.04001905]


portfolio before change:  [0.68751855]
curr_Stock_Price:  102.75125411503515
curr_Factors:  [102.75125412]
mat_Sqrt:  [[0.15]]
grads:  [-0.09211391]
Stock Position:  -0.09211391377923657
Bond Position:  [10.15233872]


portfolio before change:  [0.49522011]
curr_Stock_Price:  104.86642696548165
curr_Factors:  [104.86642697]
mat_Sqrt:  [[0.15]]
grads:  [-0.13499281]
Stock Position:  -0.13499280616620818
Bond Position:  [14.65143336]


portfolio before change:  [0.59312518]
curr_Stock_Price:  104.16830268410762
curr_Factors:  [104.16830268]
mat_Sqrt:  [[0.15]]
grads:  [-0.13753039]
Stock Position:  -0.13753039364013406
Bond Position:  [14.91943285]


portfolio before change:  [0.43938549]
curr_Stock_Price:  105.3132860461792
curr_Factors:  [105.31328605]
mat_Sqrt:  [[0.15]]
grads:  [0.03602002]
Stock Position:  0.03602001997678842
Bond Position:  [-3.35400118]


portfolio before change:  [0.4311157]
curr_Stock_Price:  105.1069790324092
curr_Factors:  [105.10697903]
mat_Sqrt:  [[0.15]]
grads:  [0.21032464]
Stock Position:  0.21032464127204342
Bond Position:  [-21.67547196]


portfolio before change:  [0.35472084]
curr_Stock_Price:  104.76952301159898
curr_Factors:  [104.76952301]
mat_Sqrt:  [[0.15]]
grads:  [0.00711739]
Stock Position:  0.007117391594200588
Bond Position:  [-0.39096488]


portfolio before change:  [0.35768794]
curr_Stock_Price:  105.20013771313272
curr_Factors:  [105.20013771]
mat_Sqrt:  [[0.15]]
grads:  [0.04491004]
Stock Position:  0.04491003775920579
Bond Position:  [-4.36685422]


portfolio before change:  [0.34789596]
curr_Stock_Price:  105.00641423154184
curr_Factors:  [105.00641423]
mat_Sqrt:  [[0.15]]
grads:  [-0.03554019]
Stock Position:  -0.03554019453689091
Bond Position:  [4.07984435]


portfolio before change:  [0.27995378]
curr_Stock_Price:  106.94681639077828
curr_Factors:  [106.94681639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.27995378]
Stock Price:  107.69154041246085
PL:  [-7.41158663]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.23406827e-03]
 [ 7.23779653e-03]
 [ 1.04397578e-03]
 [ 3.06507249e-03]
 [ 7.61749293e-03]
 [ 3.84693757e-03]
 [-4.78932990e-03]
 [ 1.23695638e-02]
 [ 2.99148916e-03]
 [ 8.34744600e-03]
 [-1.81500764e-02]
 [ 6.17089973e-03]
 [-2.60796628e-02]
 [ 2.14749455e-03]
 [ 8.59381769e-04]
 [ 7.81894235e-03]
 [ 6.98493978e-03]
 [-1.91729772e-03]
 [-1.26543658e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.12671055]
curr_Stock_Price:  100.15293514750725
curr_Factors:  [100.15293515]
mat_Sqrt:  [[0.15]]
grads:  [0.02822712]
Stock Position:  0.02822712179866512
Bond Position:  [1.29968145]


portfolio before change:  [4.13951959]
curr_Stock_Price:  100.59520777697394
curr_Factors:  [100.59520778]
mat_Sqrt:  [[0.15]]
grads:  [0.04825198]
Stock Position:  0.04825197689661292
Bond Position:  [-0.71439805]


portfolio before change:  [4.07552971]
curr_Stock_Price:  99.27274887266576
curr_Factors:  [99.27274887]
mat_Sqrt:  [[0.15]]
grads:  [0.00695984]
Stock Position:  0.006959838541235339
Bond Position:  [3.38460741]


portfolio before change:  [4.0778542]
curr_Stock_Price:  99.48514307177287
curr_Factors:  [99.48514307]
mat_Sqrt:  [[0.15]]
grads:  [0.02043382]
Stock Position:  0.020433816602291648
Bond Position:  [2.04499303]


portfolio before change:  [4.08833556]
curr_Stock_Price:  99.97306216043488
curr_Factors:  [99.97306216]
mat_Sqrt:  [[0.15]]
grads:  [0.05078329]
Stock Position:  0.05078328618938386
Bond Position:  [-0.98862507]


portfolio before change:  [4.06935722]
curr_Stock_Price:  99.6042173431131
curr_Factors:  [99.60421734]
mat_Sqrt:  [[0.15]]
grads:  [0.02564625]
Stock Position:  0.02564625049392597
Bond Position:  [1.51488251]


portfolio before change:  [4.08129872]
curr_Stock_Price:  100.05507210635028
curr_Factors:  [100.05507211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03192887]
Stock Position:  -0.03192886599343493
Bond Position:  [7.27594371]


portfolio before change:  [4.09764879]
curr_Stock_Price:  99.59997117662259
curr_Factors:  [99.59997118]
mat_Sqrt:  [[0.15]]
grads:  [0.08246376]
Stock Position:  0.08246375839634805
Bond Position:  [-4.11573917]


portfolio before change:  [4.13492705]
curr_Stock_Price:  100.06450634988445
curr_Factors:  [100.06450635]
mat_Sqrt:  [[0.15]]
grads:  [0.01994326]
Stock Position:  0.01994326109047239
Bond Position:  [2.13931447]


portfolio before change:  [4.14150016]
curr_Stock_Price:  100.36727644072205
curr_Factors:  [100.36727644]
mat_Sqrt:  [[0.15]]
grads:  [0.05564964]
Stock Position:  0.05564964002839449
Bond Position:  [-1.44390264]


portfolio before change:  [4.08600776]
curr_Stock_Price:  99.37658931884798
curr_Factors:  [99.37658932]
mat_Sqrt:  [[0.15]]
grads:  [-0.12100051]
Stock Position:  -0.12100050923271329
Bond Position:  [16.11062568]


portfolio before change:  [4.14224155]
curr_Stock_Price:  98.94513966531005
curr_Factors:  [98.94513967]
mat_Sqrt:  [[0.15]]
grads:  [0.04113933]
Stock Position:  0.041139331553222594
Bond Position:  [0.07170464]


portfolio before change:  [4.21377734]
curr_Stock_Price:  100.68356993700267
curr_Factors:  [100.68356994]
mat_Sqrt:  [[0.15]]
grads:  [-0.17386442]
Stock Position:  -0.17386441849946654
Bond Position:  [21.71906768]


portfolio before change:  [4.03014157]
curr_Stock_Price:  101.77100471843436
curr_Factors:  [101.77100472]
mat_Sqrt:  [[0.15]]
grads:  [0.01431663]
Stock Position:  0.014316630314333572
Bond Position:  [2.57312372]


portfolio before change:  [4.02457998]
curr_Stock_Price:  101.33759630749057
curr_Factors:  [101.33759631]
mat_Sqrt:  [[0.15]]
grads:  [0.00572921]
Stock Position:  0.005729211794870855
Bond Position:  [3.44399543]


portfolio before change:  [4.01875519]
curr_Stock_Price:  100.17061180487315
curr_Factors:  [100.1706118]
mat_Sqrt:  [[0.15]]
grads:  [0.05212628]
Stock Position:  0.0521262823652132
Bond Position:  [-1.20276641]


portfolio before change:  [3.98797711]
curr_Stock_Price:  99.58592880472585
curr_Factors:  [99.5859288]
mat_Sqrt:  [[0.15]]
grads:  [0.04656627]
Stock Position:  0.046566265198327544
Bond Position:  [-0.64936767]


portfolio before change:  [3.91851963]
curr_Stock_Price:  98.0978319379094
curr_Factors:  [98.09783194]
mat_Sqrt:  [[0.15]]
grads:  [-0.01278198]
Stock Position:  -0.012781984832216691
Bond Position:  [5.17240463]


portfolio before change:  [3.93418643]
curr_Stock_Price:  96.97331643740262
curr_Factors:  [96.97331644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.93418643]
Stock Price:  95.71552293332181
PL:  [3.93418643]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.96577885e-03]
 [ 7.03989673e-03]
 [ 7.41115837e-04]
 [ 4.01646177e-03]
 [ 2.03160223e-02]
 [ 3.05657049e-03]
 [-1.56350342e-02]
 [ 1.01376378e-02]
 [ 4.73090454e-03]
 [ 1.15969151e-02]
 [-1.84787019e-02]
 [ 5.31303489e-03]
 [-8.34433302e-03]
 [ 2.13053678e-03]
 [-1.60764040e-02]
 [ 7.81017757e-03]
 [ 7.46468202e-03]
 [-3.60395572e-03]
 [-1.19668005e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.10104355]
curr_Stock_Price:  99.89177256165142
curr_Factors:  [99.89177256]
mat_Sqrt:  [[0.15]]
grads:  [0.01310519]
Stock Position:  0.013105192343351805
Bond Position:  [-1.20805734]


portfolio before change:  [0.11041658]
curr_Stock_Price:  100.63003546068384
curr_Factors:  [100.63003546]
mat_Sqrt:  [[0.15]]
grads:  [0.04693264]
Stock Position:  0.046932644869829336
Bond Position:  [-4.61241714]


portfolio before change:  [0.11940445]
curr_Stock_Price:  100.84611365342337
curr_Factors:  [100.84611365]
mat_Sqrt:  [[0.15]]
grads:  [0.00494077]
Stock Position:  0.00494077224880716
Bond Position:  [-0.37885323]


portfolio before change:  [0.11627592]
curr_Stock_Price:  100.23207853414168
curr_Factors:  [100.23207853]
mat_Sqrt:  [[0.15]]
grads:  [0.02677641]
Stock Position:  0.026776411822755468
Bond Position:  [-2.56757949]


portfolio before change:  [0.14270389]
curr_Stock_Price:  101.24304116126248
curr_Factors:  [101.24304116]
mat_Sqrt:  [[0.15]]
grads:  [0.13544015]
Stock Position:  0.1354401483879394
Bond Position:  [-13.56966862]


portfolio before change:  [-0.03222284]
curr_Stock_Price:  99.97654895061152
curr_Factors:  [99.97654895]
mat_Sqrt:  [[0.15]]
grads:  [0.02037714]
Stock Position:  0.020377136633277275
Bond Position:  [-2.06945864]


portfolio before change:  [-0.04594806]
curr_Stock_Price:  99.32838169155902
curr_Factors:  [99.32838169]
mat_Sqrt:  [[0.15]]
grads:  [-0.10423356]
Stock Position:  -0.10423356152578866
Bond Position:  [10.30740292]


portfolio before change:  [0.06339272]
curr_Stock_Price:  98.30410879812558
curr_Factors:  [98.3041088]
mat_Sqrt:  [[0.15]]
grads:  [0.06758425]
Stock Position:  0.06758425169209546
Bond Position:  [-6.58041691]


portfolio before change:  [0.04364531]
curr_Stock_Price:  98.0362638672307
curr_Factors:  [98.03626387]
mat_Sqrt:  [[0.15]]
grads:  [0.03153936]
Stock Position:  0.031539363595323826
Bond Position:  [-3.04835606]


portfolio before change:  [0.05872019]
curr_Stock_Price:  98.53840020229023
curr_Factors:  [98.5384002]
mat_Sqrt:  [[0.15]]
grads:  [0.07731277]
Stock Position:  0.0773127672195399
Bond Position:  [-7.55955621]


portfolio before change:  [0.05750833]
curr_Stock_Price:  98.54717317533492
curr_Factors:  [98.54717318]
mat_Sqrt:  [[0.15]]
grads:  [-0.12319135]
Stock Position:  -0.12319134582377335
Bond Position:  [12.19766722]


portfolio before change:  [0.19952579]
curr_Stock_Price:  97.4191096081429
curr_Factors:  [97.41910961]
mat_Sqrt:  [[0.15]]
grads:  [0.03542023]
Stock Position:  0.03542023259491952
Bond Position:  [-3.25108173]


portfolio before change:  [0.21111066]
curr_Stock_Price:  97.7691281632119
curr_Factors:  [97.76912816]
mat_Sqrt:  [[0.15]]
grads:  [-0.05562889]
Stock Position:  -0.05562888681850021
Bond Position:  [5.64989843]


portfolio before change:  [0.14279739]
curr_Stock_Price:  99.02254033023902
curr_Factors:  [99.02254033]
mat_Sqrt:  [[0.15]]
grads:  [0.01420358]
Stock Position:  0.014203578564507558
Bond Position:  [-1.26367704]


portfolio before change:  [0.13813461]
curr_Stock_Price:  98.71650343359141
curr_Factors:  [98.71650343]
mat_Sqrt:  [[0.15]]
grads:  [-0.10717603]
Stock Position:  -0.10717602655652035
Bond Position:  [10.7181772]


portfolio before change:  [-0.02502788]
curr_Stock_Price:  100.2638865441028
curr_Factors:  [100.26388654]
mat_Sqrt:  [[0.15]]
grads:  [0.05206785]
Stock Position:  0.052067850448281806
Bond Position:  [-5.24555293]


portfolio before change:  [0.04077764]
curr_Stock_Price:  101.55291751456764
curr_Factors:  [101.55291751]
mat_Sqrt:  [[0.15]]
grads:  [0.04976455]
Stock Position:  0.04976454679197204
Bond Position:  [-5.01295728]


portfolio before change:  [0.04465951]
curr_Stock_Price:  101.6561088933546
curr_Factors:  [101.65610889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02402637]
Stock Position:  -0.02402637145442017
Bond Position:  [2.48708695]


portfolio before change:  [0.03203565]
curr_Stock_Price:  102.20740760049492
curr_Factors:  [102.2074076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.03203565]
Stock Price:  103.11309927170367
PL:  [-3.08106362]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.95432265e-03]
 [ 7.98025822e-03]
 [-1.85762775e-03]
 [ 3.15216459e-03]
 [ 9.47371009e-03]
 [ 3.01542124e-03]
 [-6.53673538e-03]
 [ 8.41002847e-03]
 [ 4.61980964e-03]
 [-5.98581333e-03]
 [-1.76032062e-02]
 [ 6.86014936e-03]
 [-9.04393102e-03]
 [ 2.36938305e-04]
 [-1.60985286e-02]
 [ 7.92931570e-03]
 [ 7.52649002e-03]
 [-3.92366896e-03]
 [-1.16118503e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.0873818]
curr_Stock_Price:  100.02063499226821
curr_Factors:  [100.02063499]
mat_Sqrt:  [[0.15]]
grads:  [0.01969548]
Stock Position:  0.019695484331059193
Bond Position:  [0.11742695]


portfolio before change:  [2.06950452]
curr_Stock_Price:  99.1114600099127
curr_Factors:  [99.11146001]
mat_Sqrt:  [[0.15]]
grads:  [0.05320172]
Stock Position:  0.05320172146050978
Bond Position:  [-3.20339577]


portfolio before change:  [2.00683141]
curr_Stock_Price:  97.9484870984388
curr_Factors:  [97.9484871]
mat_Sqrt:  [[0.15]]
grads:  [-0.01238418]
Stock Position:  -0.01238418499010005
Bond Position:  [3.21984359]


portfolio before change:  [1.98793507]
curr_Stock_Price:  99.53933860710426
curr_Factors:  [99.53933861]
mat_Sqrt:  [[0.15]]
grads:  [0.02101443]
Stock Position:  0.021014430629997784
Bond Position:  [-0.10382745]


portfolio before change:  [2.00121571]
curr_Stock_Price:  100.17255096694049
curr_Factors:  [100.17255097]
mat_Sqrt:  [[0.15]]
grads:  [0.06315807]
Stock Position:  0.06315806726884635
Bond Position:  [-4.325489]


portfolio before change:  [1.99164654]
curr_Stock_Price:  100.03816332046215
curr_Factors:  [100.03816332]
mat_Sqrt:  [[0.15]]
grads:  [0.02010281]
Stock Position:  0.020102808296815662
Bond Position:  [-0.01940148]


portfolio before change:  [1.94533343]
curr_Stock_Price:  97.73459166475268
curr_Factors:  [97.73459166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04357824]
Stock Position:  -0.04357823589932766
Bond Position:  [6.20443452]


portfolio before change:  [1.95442331]
curr_Stock_Price:  97.56160212776531
curr_Factors:  [97.56160213]
mat_Sqrt:  [[0.15]]
grads:  [0.05606686]
Stock Position:  0.05606685649087518
Bond Position:  [-3.51554904]


portfolio before change:  [1.88596824]
curr_Stock_Price:  96.35632542618666
curr_Factors:  [96.35632543]
mat_Sqrt:  [[0.15]]
grads:  [0.03079873]
Stock Position:  0.0307987309581156
Bond Position:  [-1.08168431]


portfolio before change:  [1.88537134]
curr_Stock_Price:  96.34572632178919
curr_Factors:  [96.34572632]
mat_Sqrt:  [[0.15]]
grads:  [-0.03990542]
Stock Position:  -0.039905422233262246
Bond Position:  [5.73008823]


portfolio before change:  [1.90993644]
curr_Stock_Price:  95.7660458452262
curr_Factors:  [95.76604585]
mat_Sqrt:  [[0.15]]
grads:  [-0.11735471]
Stock Position:  -0.11735470772327457
Bond Position:  [13.14853276]


portfolio before change:  [1.87427121]
curr_Stock_Price:  96.09796923967767
curr_Factors:  [96.09796924]
mat_Sqrt:  [[0.15]]
grads:  [0.04573433]
Stock Position:  0.045734329064259865
Bond Position:  [-2.52070494]


portfolio before change:  [1.95378242]
curr_Stock_Price:  97.85029549730555
curr_Factors:  [97.8502955]
mat_Sqrt:  [[0.15]]
grads:  [-0.06029287]
Stock Position:  -0.060292873435242963
Bond Position:  [7.8534579]


portfolio before change:  [1.94283018]
curr_Stock_Price:  98.06451401551838
curr_Factors:  [98.06451402]
mat_Sqrt:  [[0.15]]
grads:  [0.00157959]
Stock Position:  0.0015795887019786725
Bond Position:  [1.78792858]


portfolio before change:  [1.944275]
curr_Stock_Price:  98.69618717717876
curr_Factors:  [98.69618718]
mat_Sqrt:  [[0.15]]
grads:  [-0.10732352]
Stock Position:  -0.10732352393010812
Bond Position:  [12.53669761]


portfolio before change:  [1.89521913]
curr_Stock_Price:  99.18247796055579
curr_Factors:  [99.18247796]
mat_Sqrt:  [[0.15]]
grads:  [0.0528621]
Stock Position:  0.05286210464757553
Bond Position:  [-3.3477754]


portfolio before change:  [1.93852976]
curr_Stock_Price:  100.01762602131161
curr_Factors:  [100.01762602]
mat_Sqrt:  [[0.15]]
grads:  [0.0501766]
Stock Position:  0.050176600166435326
Bond Position:  [-3.08001467]


portfolio before change:  [2.03273195]
curr_Stock_Price:  101.91038655558565
curr_Factors:  [101.91038656]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615779]
Stock Position:  -0.026157793065652534
Bond Position:  [4.69848275]


portfolio before change:  [2.00080131]
curr_Stock_Price:  103.17599045189742
curr_Factors:  [103.17599045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.00080131]
Stock Price:  104.42057979018041
PL:  [-2.41977848]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.64941207e-03]
 [ 6.93253582e-03]
 [-1.27839147e-03]
 [ 7.00157326e-04]
 [-1.32052705e-03]
 [ 3.16330541e-03]
 [-7.84218268e-03]
 [ 2.08856319e-03]
 [ 4.48358196e-03]
 [-2.61556039e-02]
 [-1.73488035e-02]
 [ 9.51715468e-03]
 [ 1.28192831e-02]
 [-3.29324292e-03]
 [-1.63714550e-02]
 [ 6.39604404e-03]
 [ 2.27895932e-03]
 [-5.76228995e-03]
 [-1.08750799e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.92275962]
curr_Stock_Price:  99.82535398219916
curr_Factors:  [99.82535398]
mat_Sqrt:  [[0.15]]
grads:  [0.01099608]
Stock Position:  0.01099608044808542
Bond Position:  [-2.02044724]


portfolio before change:  [-0.93299753]
curr_Stock_Price:  98.94024403310156
curr_Factors:  [98.94024403]
mat_Sqrt:  [[0.15]]
grads:  [0.04621691]
Stock Position:  0.04621690548828093
Bond Position:  [-5.50570944]


portfolio before change:  [-0.96328603]
curr_Stock_Price:  98.3146741831227
curr_Factors:  [98.31467418]
mat_Sqrt:  [[0.15]]
grads:  [-0.00852261]
Stock Position:  -0.008522609785899487
Bond Position:  [-0.12538843]


portfolio before change:  [-0.95899256]
curr_Stock_Price:  97.807221285458
curr_Factors:  [97.80722129]
mat_Sqrt:  [[0.15]]
grads:  [0.00466772]
Stock Position:  0.004667715505575719
Bond Position:  [-1.41552884]


portfolio before change:  [-0.96207118]
curr_Stock_Price:  97.22348935524059
curr_Factors:  [97.22348936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00880351]
Stock Position:  -0.008803513639696094
Bond Position:  [-0.10616287]


portfolio before change:  [-0.96617612]
curr_Stock_Price:  97.68675826166785
curr_Factors:  [97.68675826]
mat_Sqrt:  [[0.15]]
grads:  [0.0210887]
Stock Position:  0.021088702735005255
Bond Position:  [-3.02626313]


portfolio before change:  [-0.95526766]
curr_Stock_Price:  98.23990375604997
curr_Factors:  [98.23990376]
mat_Sqrt:  [[0.15]]
grads:  [-0.05228122]
Stock Position:  -0.05228121788929609
Bond Position:  [4.18083415]


portfolio before change:  [-0.82825601]
curr_Stock_Price:  95.83050481860622
curr_Factors:  [95.83050482]
mat_Sqrt:  [[0.15]]
grads:  [0.01392375]
Stock Position:  0.013923754598902684
Bond Position:  [-2.16257644]


portfolio before change:  [-0.84908043]
curr_Stock_Price:  94.37373503863867
curr_Factors:  [94.37373504]
mat_Sqrt:  [[0.15]]
grads:  [0.02989055]
Stock Position:  0.02989054642579541
Bond Position:  [-3.66996294]


portfolio before change:  [-0.87356533]
curr_Stock_Price:  93.58528178670763
curr_Factors:  [93.58528179]
mat_Sqrt:  [[0.15]]
grads:  [-0.17437069]
Stock Position:  -0.17437069246857614
Bond Position:  [15.44496506]


portfolio before change:  [-0.9197997]
curr_Stock_Price:  93.87257831804929
curr_Factors:  [93.87257832]
mat_Sqrt:  [[0.15]]
grads:  [-0.11565869]
Stock Position:  -0.11565869021653202
Bond Position:  [9.93737975]


portfolio before change:  [-0.95927615]
curr_Stock_Price:  94.23537941356585
curr_Factors:  [94.23537941]
mat_Sqrt:  [[0.15]]
grads:  [0.0634477]
Stock Position:  0.06344769789239947
Bond Position:  [-6.93829403]


portfolio before change:  [-0.89360044]
curr_Stock_Price:  95.29783715763887
curr_Factors:  [95.29783716]
mat_Sqrt:  [[0.15]]
grads:  [0.08546189]
Stock Position:  0.08546188710515465
Bond Position:  [-9.03793344]


portfolio before change:  [-0.90612818]
curr_Stock_Price:  95.1776902692802
curr_Factors:  [95.17769027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195495]
Stock Position:  -0.02195495277330146
Bond Position:  [1.18349351]


portfolio before change:  [-0.90383691]
curr_Stock_Price:  95.08680582565945
curr_Factors:  [95.08680583]
mat_Sqrt:  [[0.15]]
grads:  [-0.10914303]
Stock Position:  -0.10914303328586497
Bond Position:  [9.4742255]


portfolio before change:  [-0.84217103]
curr_Stock_Price:  94.54350932784287
curr_Factors:  [94.54350933]
mat_Sqrt:  [[0.15]]
grads:  [0.04264029]
Stock Position:  0.042640293567719395
Bond Position:  [-4.87353402]


portfolio before change:  [-0.87341722]
curr_Stock_Price:  93.8393009680698
curr_Factors:  [93.83930097]
mat_Sqrt:  [[0.15]]
grads:  [0.01519306]
Stock Position:  0.015193062129589523
Bond Position:  [-2.29912355]


portfolio before change:  [-0.89071851]
curr_Stock_Price:  92.73837448372275
curr_Factors:  [92.73837448]
mat_Sqrt:  [[0.15]]
grads:  [-0.03841527]
Stock Position:  -0.03841526634619843
Bond Position:  [2.67185084]


portfolio before change:  [-0.85150986]
curr_Stock_Price:  91.73511175748467
curr_Factors:  [91.73511176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.85150986]
Stock Price:  92.07164497122204
PL:  [-0.85150986]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.05751704e-03]
 [ 4.19965837e-03]
 [-1.60580713e-03]
 [ 2.98770852e-03]
 [ 4.34292508e-03]
 [ 4.34724170e-03]
 [-1.18720819e-02]
 [ 1.27862953e-02]
 [ 4.12873975e-03]
 [ 8.52204037e-03]
 [-1.85242051e-02]
 [ 6.23025699e-03]
 [ 1.36878195e-03]
 [-3.76163737e-04]
 [-1.61133721e-02]
 [ 7.90266224e-03]
 [ 7.51972550e-03]
 [-3.87329084e-03]
 [-1.20566904e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.20633014]
curr_Stock_Price:  99.35283697665571
curr_Factors:  [99.35283698]
mat_Sqrt:  [[0.15]]
grads:  [0.05371678]
Stock Position:  0.05371678025268354
Bond Position:  [-13.54324465]


portfolio before change:  [-8.26212887]
curr_Stock_Price:  98.37711779757626
curr_Factors:  [98.3771178]
mat_Sqrt:  [[0.15]]
grads:  [0.02799772]
Stock Position:  0.02799772244816493
Bond Position:  [-11.01646411]


portfolio before change:  [-8.27242682]
curr_Stock_Price:  98.10768544583996
curr_Factors:  [98.10768545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01070538]
Stock Position:  -0.010705380858040923
Bond Position:  [-7.22214668]


portfolio before change:  [-8.28566673]
curr_Stock_Price:  99.17575960392398
curr_Factors:  [99.1757596]
mat_Sqrt:  [[0.15]]
grads:  [0.01991806]
Stock Position:  0.01991805681519797
Bond Position:  [-10.26105514]


portfolio before change:  [-8.28207876]
curr_Stock_Price:  99.48470302408789
curr_Factors:  [99.48470302]
mat_Sqrt:  [[0.15]]
grads:  [0.02895283]
Stock Position:  0.02895283383547096
Bond Position:  [-11.16244283]


portfolio before change:  [-8.29133186]
curr_Stock_Price:  99.2615073225262
curr_Factors:  [99.26150732]
mat_Sqrt:  [[0.15]]
grads:  [0.02898161]
Stock Position:  0.028981611323003628
Bond Position:  [-11.16809029]


portfolio before change:  [-8.28377108]
curr_Stock_Price:  99.61873919773704
curr_Factors:  [99.6187392]
mat_Sqrt:  [[0.15]]
grads:  [-0.07914721]
Stock Position:  -0.07914721248275437
Bond Position:  [-0.39922556]


portfolio before change:  [-8.41579928]
curr_Stock_Price:  101.28561254386659
curr_Factors:  [101.28561254]
mat_Sqrt:  [[0.15]]
grads:  [0.08524197]
Stock Position:  0.08524196865224135
Bond Position:  [-17.04958429]


portfolio before change:  [-8.44164119]
curr_Stock_Price:  101.03246275796478
curr_Factors:  [101.03246276]
mat_Sqrt:  [[0.15]]
grads:  [0.02752493]
Stock Position:  0.027524931667829485
Bond Position:  [-11.22255283]


portfolio before change:  [-8.45215703]
curr_Stock_Price:  100.75235853433479
curr_Factors:  [100.75235853]
mat_Sqrt:  [[0.15]]
grads:  [0.0568136]
Stock Position:  0.05681360244466932
Bond Position:  [-14.17626148]


portfolio before change:  [-8.57593585]
curr_Stock_Price:  98.63606420496639
curr_Factors:  [98.6360642]
mat_Sqrt:  [[0.15]]
grads:  [-0.1234947]
Stock Position:  -0.12349470043393002
Bond Position:  [3.60509536]


portfolio before change:  [-8.62071823]
curr_Stock_Price:  99.00598912636403
curr_Factors:  [99.00598913]
mat_Sqrt:  [[0.15]]
grads:  [0.04153505]
Stock Position:  0.04153504661757559
Bond Position:  [-12.7329366]


portfolio before change:  [-8.71938228]
curr_Stock_Price:  96.70719746185496
curr_Factors:  [96.70719746]
mat_Sqrt:  [[0.15]]
grads:  [0.00912521]
Stock Position:  0.009125213031506338
Bond Position:  [-9.60185606]


portfolio before change:  [-8.71155019]
curr_Stock_Price:  97.82857973266158
curr_Factors:  [97.82857973]
mat_Sqrt:  [[0.15]]
grads:  [-0.00250776]
Stock Position:  -0.0025077582441977273
Bond Position:  [-8.46621976]


portfolio before change:  [-8.71580858]
curr_Stock_Price:  98.68255691636632
curr_Factors:  [98.68255692]
mat_Sqrt:  [[0.15]]
grads:  [-0.10742248]
Stock Position:  -0.1074224805306899
Bond Position:  [1.88491647]


portfolio before change:  [-8.7836353]
curr_Stock_Price:  99.31834574918528
curr_Factors:  [99.31834575]
mat_Sqrt:  [[0.15]]
grads:  [0.05268441]
Stock Position:  0.05268441490900319
Bond Position:  [-14.01616424]


portfolio before change:  [-8.73946174]
curr_Stock_Price:  100.22332010772304
curr_Factors:  [100.22332011]
mat_Sqrt:  [[0.15]]
grads:  [0.0501315]
Stock Position:  0.05013150336360937
Bond Position:  [-13.76380745]


portfolio before change:  [-8.66033657]
curr_Stock_Price:  101.87031930702506
curr_Factors:  [101.87031931]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582194]
Stock Position:  -0.02582193894958371
Bond Position:  [-6.02984741]


portfolio before change:  [-8.66668167]
curr_Stock_Price:  102.05765795607573
curr_Factors:  [102.05765796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.66668167]
Stock Price:  102.02992378006066
PL:  [-10.69660545]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.84823651e-02]
 [ 5.10407084e-03]
 [-1.09963154e-03]
 [ 3.61827791e-04]
 [-8.23960281e-03]
 [-4.87443985e-03]
 [ 5.77114057e-03]
 [ 2.58558793e-03]
 [ 4.53388071e-03]
 [-1.51324255e-02]
 [-1.75502553e-02]
 [ 8.46757205e-03]
 [ 1.06270257e-02]
 [-2.85260654e-03]
 [-1.65612216e-02]
 [ 6.33412752e-03]
 [ 2.34508966e-03]
 [-3.37893745e-03]
 [-1.17503555e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.63628572]
curr_Stock_Price:  98.87082333415603
curr_Factors:  [98.87082333]
mat_Sqrt:  [[0.15]]
grads:  [0.12321577]
Stock Position:  0.12321576713005165
Bond Position:  [-27.81873006]


portfolio before change:  [-15.6838051]
curr_Stock_Price:  98.54161358292546
curr_Factors:  [98.54161358]
mat_Sqrt:  [[0.15]]
grads:  [0.03402714]
Stock Position:  0.034027138906681346
Bond Position:  [-19.03689427]


portfolio before change:  [-15.69244161]
curr_Stock_Price:  98.42768432632275
curr_Factors:  [98.42768433]
mat_Sqrt:  [[0.15]]
grads:  [-0.00733088]
Stock Position:  -0.007330876966646314
Bond Position:  [-14.97088036]


portfolio before change:  [-15.69021751]
curr_Stock_Price:  97.61369100965334
curr_Factors:  [97.61369101]
mat_Sqrt:  [[0.15]]
grads:  [0.00241219]
Stock Position:  0.002412185275899442
Bond Position:  [-15.92567982]


portfolio before change:  [-15.69869086]
curr_Stock_Price:  95.75171427672544
curr_Factors:  [95.75171428]
mat_Sqrt:  [[0.15]]
grads:  [-0.05493069]
Stock Position:  -0.05493068539081582
Bond Position:  [-10.43898357]


portfolio before change:  [-15.6418557]
curr_Stock_Price:  94.66952810622877
curr_Factors:  [94.66952811]
mat_Sqrt:  [[0.15]]
grads:  [-0.03249627]
Stock Position:  -0.03249626565049427
Bond Position:  [-12.56544957]


portfolio before change:  [-15.61695618]
curr_Stock_Price:  93.80662029306067
curr_Factors:  [93.80662029]
mat_Sqrt:  [[0.15]]
grads:  [0.03847427]
Stock Position:  0.038474270437562866
Bond Position:  [-19.22609746]


portfolio before change:  [-15.53929915]
curr_Stock_Price:  95.94997863099768
curr_Factors:  [95.94997863]
mat_Sqrt:  [[0.15]]
grads:  [0.01723725]
Stock Position:  0.017237252894098838
Bond Position:  [-17.1932132]


portfolio before change:  [-15.55899156]
curr_Stock_Price:  95.05693796936572
curr_Factors:  [95.05693797]
mat_Sqrt:  [[0.15]]
grads:  [0.03022587]
Stock Position:  0.03022587142029677
Bond Position:  [-18.43217035]


portfolio before change:  [-15.56203279]
curr_Stock_Price:  95.10879380360208
curr_Factors:  [95.1087938]
mat_Sqrt:  [[0.15]]
grads:  [-0.10088284]
Stock Position:  -0.1008828367615682
Bond Position:  [-5.96718787]


portfolio before change:  [-15.57760411]
curr_Stock_Price:  95.24835502115265
curr_Factors:  [95.24835502]
mat_Sqrt:  [[0.15]]
grads:  [-0.1170017]
Stock Position:  -0.11700170193655081
Bond Position:  [-4.43338446]


portfolio before change:  [-15.53658617]
curr_Stock_Price:  94.88830539139083
curr_Factors:  [94.88830539]
mat_Sqrt:  [[0.15]]
grads:  [0.05645048]
Stock Position:  0.05645048034308682
Bond Position:  [-20.89307659]


portfolio before change:  [-15.50345984]
curr_Stock_Price:  95.56766644690029
curr_Factors:  [95.56766645]
mat_Sqrt:  [[0.15]]
grads:  [0.07084684]
Stock Position:  0.07084683767581065
Bond Position:  [-22.27412679]


portfolio before change:  [-15.50216567]
curr_Stock_Price:  95.66454294410153
curr_Factors:  [95.66454294]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901738]
Stock Position:  -0.019017376922050255
Bond Position:  [-13.682877]


portfolio before change:  [-15.50740312]
curr_Stock_Price:  95.76005059196672
curr_Factors:  [95.76005059]
mat_Sqrt:  [[0.15]]
grads:  [-0.11040814]
Stock Position:  -0.11040814385369048
Bond Position:  [-4.93471368]


portfolio before change:  [-15.34794169]
curr_Stock_Price:  94.30458490950588
curr_Factors:  [94.30458491]
mat_Sqrt:  [[0.15]]
grads:  [0.04222752]
Stock Position:  0.04222751679582227
Bond Position:  [-19.33019014]


portfolio before change:  [-15.36727681]
curr_Stock_Price:  93.96116041742178
curr_Factors:  [93.96116042]
mat_Sqrt:  [[0.15]]
grads:  [0.01563393]
Stock Position:  0.015633931051072646
Bond Position:  [-16.83625911]


portfolio before change:  [-15.34766988]
curr_Stock_Price:  95.48454711916428
curr_Factors:  [95.48454712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02252625]
Stock Position:  -0.022526249677218557
Bond Position:  [-13.19676113]


portfolio before change:  [-15.3218831]
curr_Stock_Price:  94.19332566329739
curr_Factors:  [94.19332566]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.3218831]
Stock Price:  93.85590039404568
PL:  [-15.3218831]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.47641742e-02]
 [ 6.56097339e-03]
 [ 7.25193925e-04]
 [ 1.44729664e-03]
 [-1.93085865e-04]
 [ 2.27897867e-03]
 [ 2.96340439e-04]
 [-2.71291326e-03]
 [ 4.59328333e-03]
 [-4.98254602e-03]
 [-1.79482784e-02]
 [ 5.32468937e-03]
 [-1.51229117e-03]
 [ 3.87686114e-04]
 [-1.49813268e-02]
 [ 7.93178248e-03]
 [ 3.95926929e-03]
 [-1.97985768e-03]
 [-1.26577313e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.90975144]
curr_Stock_Price:  99.04770551161393
curr_Factors:  [99.04770551]
mat_Sqrt:  [[0.15]]
grads:  [0.09842783]
Stock Position:  0.09842782787696591
Bond Position:  [-22.65880195]


portfolio before change:  [-12.93669481]
curr_Stock_Price:  98.83152714324618
curr_Factors:  [98.83152714]
mat_Sqrt:  [[0.15]]
grads:  [0.04373982]
Stock Position:  0.04373982257388817
Bond Position:  [-17.25956827]


portfolio before change:  [-12.92895106]
curr_Stock_Price:  99.1072298429306
curr_Factors:  [99.10722984]
mat_Sqrt:  [[0.15]]
grads:  [0.00483463]
Stock Position:  0.004834626168463961
Bond Position:  [-13.40809746]


portfolio before change:  [-12.93652235]
curr_Stock_Price:  98.23459773922468
curr_Factors:  [98.23459774]
mat_Sqrt:  [[0.15]]
grads:  [0.00964864]
Stock Position:  0.009648644235794463
Bond Position:  [-13.88435303]


portfolio before change:  [-12.94488455]
curr_Stock_Price:  97.7277202297293
curr_Factors:  [97.72772023]
mat_Sqrt:  [[0.15]]
grads:  [-0.00128724]
Stock Position:  -0.0012872390985856654
Bond Position:  [-12.81908561]


portfolio before change:  [-12.94757331]
curr_Stock_Price:  97.32654181461051
curr_Factors:  [97.32654181]
mat_Sqrt:  [[0.15]]
grads:  [0.01519319]
Stock Position:  0.015193191158048958
Bond Position:  [-14.42627407]


portfolio before change:  [-12.98010793]
curr_Stock_Price:  95.42255744083971
curr_Factors:  [95.42255744]
mat_Sqrt:  [[0.15]]
grads:  [0.0019756]
Stock Position:  0.0019756029271867743
Bond Position:  [-13.16862501]


portfolio before change:  [-12.98487474]
curr_Stock_Price:  94.67633552746814
curr_Factors:  [94.67633553]
mat_Sqrt:  [[0.15]]
grads:  [-0.01808609]
Stock Position:  -0.018086088411911883
Bond Position:  [-11.27255016]


portfolio before change:  [-13.01082295]
curr_Stock_Price:  95.95520365814512
curr_Factors:  [95.95520366]
mat_Sqrt:  [[0.15]]
grads:  [0.03062189]
Stock Position:  0.030621888839590314
Bond Position:  [-15.94915253]


portfolio before change:  [-12.99869754]
curr_Stock_Price:  96.48140212604602
curr_Factors:  [96.48140213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03321697]
Stock Position:  -0.033216973481218416
Bond Position:  [-9.79387737]


portfolio before change:  [-13.0286884]
curr_Stock_Price:  97.31055910357382
curr_Factors:  [97.3105591]
mat_Sqrt:  [[0.15]]
grads:  [-0.11965519]
Stock Position:  -0.11965518962547414
Bond Position:  [-1.384975]


portfolio before change:  [-13.04767054]
curr_Stock_Price:  97.46630537427929
curr_Factors:  [97.46630537]
mat_Sqrt:  [[0.15]]
grads:  [0.03549793]
Stock Position:  0.03549792910956806
Bond Position:  [-16.50752254]


portfolio before change:  [-13.06646384]
curr_Stock_Price:  97.05315722393993
curr_Factors:  [97.05315722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01008194]
Stock Position:  -0.010081941114243667
Bond Position:  [-12.08797962]


portfolio before change:  [-13.08043209]
curr_Stock_Price:  98.13884840732624
curr_Factors:  [98.13884841]
mat_Sqrt:  [[0.15]]
grads:  [0.00258457]
Stock Position:  0.0025845740930485824
Bond Position:  [-13.33407921]


portfolio before change:  [-13.08107621]
curr_Stock_Price:  99.17956714741818
curr_Factors:  [99.17956715]
mat_Sqrt:  [[0.15]]
grads:  [-0.09987551]
Stock Position:  -0.09987551215270246
Bond Position:  [-3.17546615]


portfolio before change:  [-13.0566814]
curr_Stock_Price:  98.92736545909735
curr_Factors:  [98.92736546]
mat_Sqrt:  [[0.15]]
grads:  [0.05287855]
Stock Position:  0.05287854989752994
Bond Position:  [-18.28781703]


portfolio before change:  [-13.16657372]
curr_Stock_Price:  96.93563545962633
curr_Factors:  [96.93563546]
mat_Sqrt:  [[0.15]]
grads:  [0.02639513]
Stock Position:  0.026395128568442568
Bond Position:  [-15.72520228]


portfolio before change:  [-13.1473266]
curr_Stock_Price:  97.81378685740812
curr_Factors:  [97.81378686]
mat_Sqrt:  [[0.15]]
grads:  [-0.01319905]
Stock Position:  -0.013199051210826552
Bond Position:  [-11.85627741]


portfolio before change:  [-13.14001283]
curr_Stock_Price:  97.03507892950894
curr_Factors:  [97.03507893]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.14001283]
Stock Price:  96.29290021764554
PL:  [-13.14001283]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.84750739e-04]
 [ 1.02855721e-02]
 [ 1.21033086e-03]
 [ 1.35621026e-02]
 [ 2.08570039e-02]
 [ 3.48743135e-03]
 [ 1.67834915e-02]
 [ 7.03513008e-03]
 [ 7.52156861e-03]
 [ 2.63981492e-03]
 [-1.57151535e-02]
 [-1.04535122e-02]
 [-2.03148124e-02]
 [ 3.72006202e-03]
 [ 1.36279168e-02]
 [ 7.42119667e-03]
 [ 7.45843022e-03]
 [-2.62511436e-03]
 [-1.24664972e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.32102506]
curr_Stock_Price:  99.73464240097977
curr_Factors:  [99.7346424]
mat_Sqrt:  [[0.15]]
grads:  [0.006565]
Stock Position:  0.006565004928502766
Bond Position:  [-2.97578348]


portfolio before change:  [-2.32260003]
curr_Stock_Price:  99.60807279020493
curr_Factors:  [99.60807279]
mat_Sqrt:  [[0.15]]
grads:  [0.06857048]
Stock Position:  0.06857048052263788
Bond Position:  [-9.15277344]


portfolio before change:  [-2.28270817]
curr_Stock_Price:  100.22321122536161
curr_Factors:  [100.22321123]
mat_Sqrt:  [[0.15]]
grads:  [0.00806887]
Stock Position:  0.008068872386011085
Bond Position:  [-3.09139647]


portfolio before change:  [-2.27503829]
curr_Stock_Price:  101.26955601438848
curr_Factors:  [101.26955601]
mat_Sqrt:  [[0.15]]
grads:  [0.09041402]
Stock Position:  0.0904140172286823
Bond Position:  [-11.43122567]


portfolio before change:  [-2.27439417]
curr_Stock_Price:  101.30829211731576
curr_Factors:  [101.30829212]
mat_Sqrt:  [[0.15]]
grads:  [0.13904669]
Stock Position:  0.13904669281933338
Bond Position:  [-16.36097714]


portfolio before change:  [-2.3806372]
curr_Stock_Price:  100.57363046005304
curr_Factors:  [100.57363046]
mat_Sqrt:  [[0.15]]
grads:  [0.02324954]
Stock Position:  0.023249542363619723
Bond Position:  [-4.71892808]


portfolio before change:  [-2.37814869]
curr_Stock_Price:  100.73141351352815
curr_Factors:  [100.73141351]
mat_Sqrt:  [[0.15]]
grads:  [0.11188994]
Stock Position:  0.11188994343623476
Bond Position:  [-13.64898085]


portfolio before change:  [-2.20554025]
curr_Stock_Price:  102.30457646577521
curr_Factors:  [102.30457647]
mat_Sqrt:  [[0.15]]
grads:  [0.04690087]
Stock Position:  0.04690086720028157
Bond Position:  [-7.00371361]


portfolio before change:  [-2.19859752]
curr_Stock_Price:  102.48994350759023
curr_Factors:  [102.48994351]
mat_Sqrt:  [[0.15]]
grads:  [0.05014379]
Stock Position:  0.05014379073720962
Bond Position:  [-7.3378318]


portfolio before change:  [-2.1987178]
curr_Stock_Price:  102.52413343604343
curr_Factors:  [102.52413344]
mat_Sqrt:  [[0.15]]
grads:  [0.01759877]
Stock Position:  0.0175987661157784
Bond Position:  [-4.00301604]


portfolio before change:  [-2.21925311]
curr_Stock_Price:  101.41414495531217
curr_Factors:  [101.41414496]
mat_Sqrt:  [[0.15]]
grads:  [-0.10476769]
Stock Position:  -0.10476768989194213
Bond Position:  [8.40567258]


portfolio before change:  [-2.40110851]
curr_Stock_Price:  103.17000204051736
curr_Factors:  [103.17000204]
mat_Sqrt:  [[0.15]]
grads:  [-0.06969008]
Stock Position:  -0.06969008146980836
Bond Position:  [4.78881733]


portfolio before change:  [-2.49694921]
curr_Stock_Price:  104.56242469510816
curr_Factors:  [104.5624247]
mat_Sqrt:  [[0.15]]
grads:  [-0.13543208]
Stock Position:  -0.13543208295755976
Bond Position:  [11.66415777]


portfolio before change:  [-2.3692947]
curr_Stock_Price:  103.6413866201891
curr_Factors:  [103.64138662]
mat_Sqrt:  [[0.15]]
grads:  [0.02480041]
Stock Position:  0.02480041347600453
Bond Position:  [-4.93964394]


portfolio before change:  [-2.39118288]
curr_Stock_Price:  102.80861367595219
curr_Factors:  [102.80861368]
mat_Sqrt:  [[0.15]]
grads:  [0.09085278]
Stock Position:  0.09085277855032384
Bond Position:  [-11.73163109]


portfolio before change:  [-2.57393879]
curr_Stock_Price:  100.82933868814989
curr_Factors:  [100.82933869]
mat_Sqrt:  [[0.15]]
grads:  [0.04947464]
Stock Position:  0.04947464449941063
Bond Position:  [-7.56243447]


portfolio before change:  [-2.54869385]
curr_Stock_Price:  101.37781714425894
curr_Factors:  [101.37781714]
mat_Sqrt:  [[0.15]]
grads:  [0.04972287]
Stock Position:  0.04972286812213684
Bond Position:  [-7.58948969]


portfolio before change:  [-2.58651521]
curr_Stock_Price:  100.65533771095424
curr_Factors:  [100.65533771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01750076]
Stock Position:  -0.017500762399856384
Bond Position:  [-0.82497006]


portfolio before change:  [-2.5917491]
curr_Stock_Price:  100.94261780157636
curr_Factors:  [100.9426178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.5917491]
Stock Price:  102.67957871220693
PL:  [-5.27132781]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.59409935e-03]
 [ 8.44174636e-03]
 [ 1.12235065e-03]
 [ 2.95806476e-03]
 [-4.79457128e-04]
 [ 4.17287377e-03]
 [-6.41073343e-03]
 [ 8.78080670e-03]
 [ 4.62759162e-03]
 [-9.64783789e-03]
 [-1.75601564e-02]
 [ 8.04591994e-03]
 [ 7.05441871e-03]
 [ 2.41110423e-04]
 [-1.61846524e-02]
 [ 7.91360460e-03]
 [ 5.79952847e-03]
 [-1.68539784e-03]
 [-1.27863347e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.10689301]
curr_Stock_Price:  100.08677513361224
curr_Factors:  [100.08677513]
mat_Sqrt:  [[0.15]]
grads:  [0.02396066]
Stock Position:  0.023960662304463063
Bond Position:  [0.70874759]


portfolio before change:  [3.11366285]
curr_Stock_Price:  100.36191887255318
curr_Factors:  [100.36191887]
mat_Sqrt:  [[0.15]]
grads:  [0.05627831]
Stock Position:  0.05627830903718073
Bond Position:  [-2.53453624]


portfolio before change:  [3.11572282]
curr_Stock_Price:  100.40978252165358
curr_Factors:  [100.40978252]
mat_Sqrt:  [[0.15]]
grads:  [0.00748234]
Stock Position:  0.007482337653680992
Bond Position:  [2.36442292]


portfolio before change:  [3.10851378]
curr_Stock_Price:  99.36729869207207
curr_Factors:  [99.36729869]
mat_Sqrt:  [[0.15]]
grads:  [0.01972043]
Stock Position:  0.019720431727080965
Bond Position:  [1.14894775]


portfolio before change:  [3.07394216]
curr_Stock_Price:  97.59964504932672
curr_Factors:  [97.59964505]
mat_Sqrt:  [[0.15]]
grads:  [-0.00319638]
Stock Position:  -0.0031963808558891386
Bond Position:  [3.3859078]


portfolio before change:  [3.06906432]
curr_Stock_Price:  99.39055457807393
curr_Factors:  [99.39055458]
mat_Sqrt:  [[0.15]]
grads:  [0.02781916]
Stock Position:  0.027819158496563808
Bond Position:  [0.30410273]


portfolio before change:  [3.02171604]
curr_Stock_Price:  97.68581887087736
curr_Factors:  [97.68581887]
mat_Sqrt:  [[0.15]]
grads:  [-0.04273822]
Stock Position:  -0.042738222857865396
Bond Position:  [7.19663434]


portfolio before change:  [3.02287348]
curr_Stock_Price:  97.70083924743555
curr_Factors:  [97.70083925]
mat_Sqrt:  [[0.15]]
grads:  [0.05853871]
Stock Position:  0.058538711340048157
Bond Position:  [-2.69640775]


portfolio before change:  [2.95038181]
curr_Stock_Price:  96.4740017536528
curr_Factors:  [96.47400175]
mat_Sqrt:  [[0.15]]
grads:  [0.03085061]
Stock Position:  0.030850610792887402
Bond Position:  [-0.02590007]


portfolio before change:  [2.93113981]
curr_Stock_Price:  95.85049626720148
curr_Factors:  [95.85049627]
mat_Sqrt:  [[0.15]]
grads:  [-0.06431892]
Stock Position:  -0.06431891923609738
Bond Position:  [9.09614013]


portfolio before change:  [2.96591703]
curr_Stock_Price:  95.3451565412642
curr_Factors:  [95.34515654]
mat_Sqrt:  [[0.15]]
grads:  [-0.11706771]
Stock Position:  -0.11706770947459091
Bond Position:  [14.12775612]


portfolio before change:  [2.99022018]
curr_Stock_Price:  95.16773128704416
curr_Factors:  [95.16773129]
mat_Sqrt:  [[0.15]]
grads:  [0.05363947]
Stock Position:  0.05363946627549914
Bond Position:  [-2.11452613]


portfolio before change:  [3.03473049]
curr_Stock_Price:  96.00739308862146
curr_Factors:  [96.00739309]
mat_Sqrt:  [[0.15]]
grads:  [0.04702946]
Stock Position:  0.047029458095761215
Bond Position:  [-1.48044518]


portfolio before change:  [3.13118112]
curr_Stock_Price:  98.0661195324245
curr_Factors:  [98.06611953]
mat_Sqrt:  [[0.15]]
grads:  [0.0016074]
Stock Position:  0.0016074028226894803
Bond Position:  [2.97354937]


portfolio before change:  [3.13281026]
curr_Stock_Price:  98.61710263738289
curr_Factors:  [98.61710264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10789768]
Stock Position:  -0.10789768295204209
Bond Position:  [13.77336713]


portfolio before change:  [3.06660999]
curr_Stock_Price:  99.26256633435322
curr_Factors:  [99.26256633]
mat_Sqrt:  [[0.15]]
grads:  [0.05275736]
Stock Position:  0.05275736398500728
Bond Position:  [-2.17022135]


portfolio before change:  [3.06209261]
curr_Stock_Price:  99.18722602345254
curr_Factors:  [99.18722602]
mat_Sqrt:  [[0.15]]
grads:  [0.03866352]
Stock Position:  0.03866352315513288
Bond Position:  [-0.772835]


portfolio before change:  [3.05500723]
curr_Stock_Price:  99.00896638509482
curr_Factors:  [99.00896639]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123599]
Stock Position:  -0.011235985624930346
Bond Position:  [4.16747056]


portfolio before change:  [3.05728273]
curr_Stock_Price:  98.8991853096386
curr_Factors:  [98.89918531]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.05728273]
Stock Price:  99.67934745851049
PL:  [3.05728273]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.80531587e-02]
 [ 1.00579205e-02]
 [-1.59837485e-03]
 [ 1.20157322e-03]
 [ 2.16950286e-03]
 [ 3.32110727e-03]
 [-8.62801044e-03]
 [ 9.71529559e-03]
 [ 4.64547792e-03]
 [ 2.02584927e-03]
 [-1.77154457e-02]
 [ 5.79368357e-03]
 [-1.76257483e-02]
 [ 2.32785285e-04]
 [-1.71227055e-02]
 [ 7.47879949e-03]
 [ 4.45879938e-03]
 [-1.72464864e-03]
 [-1.28055625e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.0222354]
curr_Stock_Price:  98.39166454566416
curr_Factors:  [98.39166455]
mat_Sqrt:  [[0.15]]
grads:  [0.18702106]
Stock Position:  0.1870210577876956
Bond Position:  [-41.42354859]


portfolio before change:  [-22.76620317]
curr_Stock_Price:  99.81604648878987
curr_Factors:  [99.81604649]
mat_Sqrt:  [[0.15]]
grads:  [0.0670528]
Stock Position:  0.06705280301495722
Bond Position:  [-29.45914887]


portfolio before change:  [-22.88780422]
curr_Stock_Price:  98.11238405390586
curr_Factors:  [98.11238405]
mat_Sqrt:  [[0.15]]
grads:  [-0.01065583]
Stock Position:  -0.010655832337188021
Bond Position:  [-21.8423351]


portfolio before change:  [-22.89307001]
curr_Stock_Price:  98.09403974347364
curr_Factors:  [98.09403974]
mat_Sqrt:  [[0.15]]
grads:  [0.00801049]
Stock Position:  0.00801048810171653
Bond Position:  [-23.67885115]


portfolio before change:  [-22.8936542]
curr_Stock_Price:  98.7601988252238
curr_Factors:  [98.76019883]
mat_Sqrt:  [[0.15]]
grads:  [0.01446335]
Stock Position:  0.014463352402050957
Bond Position:  [-24.32205776]


portfolio before change:  [-22.91405173]
curr_Stock_Price:  97.77036955571221
curr_Factors:  [97.77036956]
mat_Sqrt:  [[0.15]]
grads:  [0.02214072]
Stock Position:  0.022140715128944593
Bond Position:  [-25.07875763]


portfolio before change:  [-22.90586081]
curr_Stock_Price:  98.4235277400324
curr_Factors:  [98.42352774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05752007]
Stock Position:  -0.05752006963321561
Bond Position:  [-17.24453264]


portfolio before change:  [-22.89196643]
curr_Stock_Price:  98.10701112709232
curr_Factors:  [98.10701113]
mat_Sqrt:  [[0.15]]
grads:  [0.06476864]
Stock Position:  0.06476863727272093
Bond Position:  [-29.24622384]


portfolio before change:  [-22.98752869]
curr_Stock_Price:  96.74447212851383
curr_Factors:  [96.74447213]
mat_Sqrt:  [[0.15]]
grads:  [0.03096985]
Stock Position:  0.03096985277350167
Bond Position:  [-25.98369075]


portfolio before change:  [-22.9772595]
curr_Stock_Price:  97.28583505951738
curr_Factors:  [97.28583506]
mat_Sqrt:  [[0.15]]
grads:  [0.01350566]
Stock Position:  0.01350566182191462
Bond Position:  [-24.29116908]


portfolio before change:  [-22.95066733]
curr_Stock_Price:  99.70450345044677
curr_Factors:  [99.70450345]
mat_Sqrt:  [[0.15]]
grads:  [-0.11810297]
Stock Position:  -0.1181029710795579
Bond Position:  [-11.17526924]


portfolio before change:  [-22.81810806]
curr_Stock_Price:  98.55844053987325
curr_Factors:  [98.55844054]
mat_Sqrt:  [[0.15]]
grads:  [0.03862456]
Stock Position:  0.03862455711386037
Bond Position:  [-26.62488418]


portfolio before change:  [-22.81143124]
curr_Stock_Price:  98.9036580558411
curr_Factors:  [98.90365806]
mat_Sqrt:  [[0.15]]
grads:  [-0.11750499]
Stock Position:  -0.11750498898798685
Bond Position:  [-11.18975799]


portfolio before change:  [-22.71543763]
curr_Stock_Price:  98.06291584803425
curr_Factors:  [98.06291585]
mat_Sqrt:  [[0.15]]
grads:  [0.0015519]
Stock Position:  0.0015519019033211415
Bond Position:  [-22.86762165]


portfolio before change:  [-22.72163198]
curr_Stock_Price:  97.75572114445448
curr_Factors:  [97.75572114]
mat_Sqrt:  [[0.15]]
grads:  [-0.11415137]
Stock Position:  -0.11415136991498846
Bond Position:  [-11.5626825]


portfolio before change:  [-22.74170345]
curr_Stock_Price:  97.90622684270768
curr_Factors:  [97.90622684]
mat_Sqrt:  [[0.15]]
grads:  [0.04985866]
Stock Position:  0.04985866328967719
Bond Position:  [-27.62317704]


portfolio before change:  [-22.74331338]
curr_Stock_Price:  98.01246165851917
curr_Factors:  [98.01246166]
mat_Sqrt:  [[0.15]]
grads:  [0.02972533]
Stock Position:  0.029725329229935486
Bond Position:  [-25.65676607]


portfolio before change:  [-22.72730131]
curr_Stock_Price:  98.76693793591305
curr_Factors:  [98.76693794]
mat_Sqrt:  [[0.15]]
grads:  [-0.01149766]
Stock Position:  -0.011497657570752917
Bond Position:  [-21.59171288]


portfolio before change:  [-22.73945659]
curr_Stock_Price:  99.35459429441337
curr_Factors:  [99.35459429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.73945659]
Stock Price:  99.9421350400043
PL:  [-22.73945659]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.98468284e-04]
 [ 6.62371411e-03]
 [-1.43090970e-03]
 [ 2.89480417e-03]
 [ 1.57507266e-02]
 [ 6.28377644e-03]
 [ 2.92973096e-02]
 [ 1.12794502e-02]
 [ 3.86615263e-03]
 [ 1.31681354e-02]
 [-1.79492632e-02]
 [ 7.26981597e-03]
 [ 2.02394505e-02]
 [-4.41244130e-03]
 [-1.58572741e-02]
 [ 6.13916215e-03]
 [ 1.94813515e-03]
 [-4.97978180e-03]
 [-1.14265610e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.2921671]
curr_Stock_Price:  99.736514542679
curr_Factors:  [99.73651454]
mat_Sqrt:  [[0.15]]
grads:  [0.00665646]
Stock Position:  0.006656455227804915
Bond Position:  [-2.95605874]


portfolio before change:  [-2.2987973]
curr_Stock_Price:  98.8514956053534
curr_Factors:  [98.85149561]
mat_Sqrt:  [[0.15]]
grads:  [0.04415809]
Stock Position:  0.04415809404278908
Bond Position:  [-6.66389093]


portfolio before change:  [-2.32842623]
curr_Stock_Price:  98.21825375770399
curr_Factors:  [98.21825376]
mat_Sqrt:  [[0.15]]
grads:  [-0.0095394]
Stock Position:  -0.009539398033078583
Bond Position:  [-1.39148321]


portfolio before change:  [-2.33672749]
curr_Stock_Price:  99.05198997574882
curr_Factors:  [99.05198998]
mat_Sqrt:  [[0.15]]
grads:  [0.01929869]
Stock Position:  0.019298694440817943
Bond Position:  [-4.24830157]


portfolio before change:  [-2.30538538]
curr_Stock_Price:  100.73108328642115
curr_Factors:  [100.73108329]
mat_Sqrt:  [[0.15]]
grads:  [0.10500484]
Stock Position:  0.10500484373669072
Bond Position:  [-12.88263704]


portfolio before change:  [-2.25116444]
curr_Stock_Price:  101.27812479563019
curr_Factors:  [101.2781248]
mat_Sqrt:  [[0.15]]
grads:  [0.04189184]
Stock Position:  0.04189184292975493
Bond Position:  [-6.49389173]


portfolio before change:  [-2.2386309]
curr_Stock_Price:  101.6160716968387
curr_Factors:  [101.6160717]
mat_Sqrt:  [[0.15]]
grads:  [0.1953154]
Stock Position:  0.19531539710070414
Bond Position:  [-22.08581429]


portfolio before change:  [-2.24486749]
curr_Stock_Price:  101.61241375852579
curr_Factors:  [101.61241376]
mat_Sqrt:  [[0.15]]
grads:  [0.07519633]
Stock Position:  0.07519633463698158
Bond Position:  [-9.88574856]


portfolio before change:  [-2.31438356]
curr_Stock_Price:  100.72082348815785
curr_Factors:  [100.72082349]
mat_Sqrt:  [[0.15]]
grads:  [0.02577435]
Stock Position:  0.025774350885401982
Bond Position:  [-4.9103974]


portfolio before change:  [-2.35908864]
curr_Stock_Price:  99.03397882362856
curr_Factors:  [99.03397882]
mat_Sqrt:  [[0.15]]
grads:  [0.08778757]
Stock Position:  0.08778756928424959
Bond Position:  [-11.05304091]


portfolio before change:  [-2.51290195]
curr_Stock_Price:  97.31335131819033
curr_Factors:  [97.31335132]
mat_Sqrt:  [[0.15]]
grads:  [-0.11966175]
Stock Position:  -0.11966175459543725
Bond Position:  [9.13178442]


portfolio before change:  [-2.32672662]
curr_Stock_Price:  95.77658546339325
curr_Factors:  [95.77658546]
mat_Sqrt:  [[0.15]]
grads:  [0.04846544]
Stock Position:  0.04846543978899687
Bond Position:  [-6.96858095]


portfolio before change:  [-2.39593499]
curr_Stock_Price:  94.38454180808874
curr_Factors:  [94.38454181]
mat_Sqrt:  [[0.15]]
grads:  [0.13492967]
Stock Position:  0.134929669916283
Bond Position:  [-15.13121006]


portfolio before change:  [-2.45955113]
curr_Stock_Price:  93.94110438080683
curr_Factors:  [93.94110438]
mat_Sqrt:  [[0.15]]
grads:  [-0.02941628]
Stock Position:  -0.02941627532906296
Bond Position:  [0.30384626]


portfolio before change:  [-2.43951667]
curr_Stock_Price:  93.26261969706856
curr_Factors:  [93.2626197]
mat_Sqrt:  [[0.15]]
grads:  [-0.10571516]
Stock Position:  -0.10571516089166946
Bond Position:  [7.41975618]


portfolio before change:  [-2.46827976]
curr_Stock_Price:  93.55224950568216
curr_Factors:  [93.55224951]
mat_Sqrt:  [[0.15]]
grads:  [0.04092775]
Stock Position:  0.040927747682494346
Bond Position:  [-6.29716262]


portfolio before change:  [-2.48305605]
curr_Stock_Price:  93.22968589992665
curr_Factors:  [93.2296859]
mat_Sqrt:  [[0.15]]
grads:  [0.01298757]
Stock Position:  0.012987567692832897
Bond Position:  [-3.6938829]


portfolio before change:  [-2.47709049]
curr_Stock_Price:  93.76012708429131
curr_Factors:  [93.76012708]
mat_Sqrt:  [[0.15]]
grads:  [-0.03319855]
Stock Position:  -0.03319854533106503
Bond Position:  [0.63560934]


portfolio before change:  [-2.46112311]
curr_Stock_Price:  93.28394780191606
curr_Factors:  [93.2839478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.46112311]
Stock Price:  94.45960638366024
PL:  [-2.46112311]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.44112334e-04]
 [ 8.59983809e-03]
 [ 1.13370555e-03]
 [ 1.18890217e-02]
 [ 6.59826133e-03]
 [ 3.07487359e-03]
 [-4.80444150e-03]
 [ 1.33443712e-02]
 [ 2.95582537e-03]
 [ 1.22216030e-02]
 [-1.84565581e-02]
 [ 6.02741770e-03]
 [-2.55980792e-02]
 [ 2.08658636e-03]
 [-1.24630240e-02]
 [ 7.81058243e-03]
 [ 4.46167279e-03]
 [-1.84085860e-03]
 [-1.26866505e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.61688975]
curr_Stock_Price:  99.71544836705239
curr_Factors:  [99.71544837]
mat_Sqrt:  [[0.15]]
grads:  [0.00562742]
Stock Position:  0.005627415563238358
Bond Position:  [-3.17803002]


portfolio before change:  [-2.61468333]
curr_Stock_Price:  100.24873514329668
curr_Factors:  [100.24873514]
mat_Sqrt:  [[0.15]]
grads:  [0.05733225]
Stock Position:  0.057332253933864666
Bond Position:  [-8.36216927]


portfolio before change:  [-2.60932226]
curr_Stock_Price:  100.37871214077283
curr_Factors:  [100.37871214]
mat_Sqrt:  [[0.15]]
grads:  [0.00755804]
Stock Position:  0.007558037026547809
Bond Position:  [-3.36798829]


portfolio before change:  [-2.60520117]
curr_Stock_Price:  101.03538949534264
curr_Factors:  [101.0353895]
mat_Sqrt:  [[0.15]]
grads:  [0.07926014]
Stock Position:  0.07926014441005028
Bond Position:  [-10.61328074]


portfolio before change:  [-2.70581042]
curr_Stock_Price:  99.79951493194733
curr_Factors:  [99.79951493]
mat_Sqrt:  [[0.15]]
grads:  [0.04398841]
Stock Position:  0.043988408864782724
Bond Position:  [-7.09583229]


portfolio before change:  [-2.70037107]
curr_Stock_Price:  99.96350199787956
curr_Factors:  [99.963502]
mat_Sqrt:  [[0.15]]
grads:  [0.02049916]
Stock Position:  0.020499157297314254
Bond Position:  [-4.74953862]


portfolio before change:  [-2.69970107]
curr_Stock_Price:  100.05411724878302
curr_Factors:  [100.05411725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03202961]
Stock Position:  -0.03202961002085693
Bond Position:  [0.50499329]


portfolio before change:  [-2.72460246]
curr_Stock_Price:  100.83550852640288
curr_Factors:  [100.83550853]
mat_Sqrt:  [[0.15]]
grads:  [0.08896247]
Stock Position:  0.08896247450196404
Bond Position:  [-11.69517882]


portfolio before change:  [-2.79877372]
curr_Stock_Price:  100.03464169013651
curr_Factors:  [100.03464169]
mat_Sqrt:  [[0.15]]
grads:  [0.0197055]
Stock Position:  0.019705502443120325
Bond Position:  [-4.77000659]


portfolio before change:  [-2.82656458]
curr_Stock_Price:  98.68485582803535
curr_Factors:  [98.68485583]
mat_Sqrt:  [[0.15]]
grads:  [0.08147735]
Stock Position:  0.08147735349126392
Bond Position:  [-10.86714546]


portfolio before change:  [-2.84402428]
curr_Stock_Price:  98.50391503034628
curr_Factors:  [98.50391503]
mat_Sqrt:  [[0.15]]
grads:  [-0.12304372]
Stock Position:  -0.12304372060485602
Bond Position:  [9.27626392]


portfolio before change:  [-2.87789646]
curr_Stock_Price:  98.79805058628206
curr_Factors:  [98.79805059]
mat_Sqrt:  [[0.15]]
grads:  [0.04018278]
Stock Position:  0.04018278463620771
Bond Position:  [-6.84787725]


portfolio before change:  [-2.79113132]
curr_Stock_Price:  100.99992193664569
curr_Factors:  [100.99992194]
mat_Sqrt:  [[0.15]]
grads:  [-0.17065386]
Stock Position:  -0.17065386110677289
Bond Position:  [14.44489533]


portfolio before change:  [-2.75925657]
curr_Stock_Price:  100.83430558263791
curr_Factors:  [100.83430558]
mat_Sqrt:  [[0.15]]
grads:  [0.01391058]
Stock Position:  0.013910575734862509
Bond Position:  [-4.16191982]


portfolio before change:  [-2.77673679]
curr_Stock_Price:  99.65249955315983
curr_Factors:  [99.65249955]
mat_Sqrt:  [[0.15]]
grads:  [-0.08308683]
Stock Position:  -0.08308682677125702
Bond Position:  [5.50307318]


portfolio before change:  [-2.82588803]
curr_Stock_Price:  100.2606246482761
curr_Factors:  [100.26062465]
mat_Sqrt:  [[0.15]]
grads:  [0.05207055]
Stock Position:  0.05207054953411819
Bond Position:  [-8.04651385]


portfolio before change:  [-2.94702494]
curr_Stock_Price:  97.97286248535366
curr_Factors:  [97.97286249]
mat_Sqrt:  [[0.15]]
grads:  [0.02974449]
Stock Position:  0.029744485237723953
Bond Position:  [-5.8611773]


portfolio before change:  [-2.93632196]
curr_Stock_Price:  98.38196227459763
curr_Factors:  [98.38196227]
mat_Sqrt:  [[0.15]]
grads:  [-0.01227239]
Stock Position:  -0.01227239069984642
Bond Position:  [-1.72894008]


portfolio before change:  [-2.92673789]
curr_Stock_Price:  97.5657919978008
curr_Factors:  [97.565792]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.92673789]
Stock Price:  97.45669585668433
PL:  [-2.92673789]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.86775736e-03]
 [ 1.03356166e-02]
 [ 8.27660638e-04]
 [ 1.44514085e-02]
 [ 1.88289821e-02]
 [ 6.58991717e-03]
 [ 3.49341797e-02]
 [ 1.31693230e-02]
 [ 7.78629281e-03]
 [ 5.21021174e-03]
 [-1.61119339e-02]
 [-1.96301290e-03]
 [-2.39970087e-02]
 [ 2.60274103e-03]
 [ 4.65463146e-03]
 [ 2.21676620e-03]
 [ 7.16905880e-03]
 [-5.06119562e-03]
 [-1.08402406e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.44819717]
curr_Stock_Price:  100.3684144800041
curr_Factors:  [100.36841448]
mat_Sqrt:  [[0.15]]
grads:  [0.03911838]
Stock Position:  0.039118382418915305
Bond Position:  [3.52194715]


portfolio before change:  [7.42011628]
curr_Stock_Price:  99.62805936289341
curr_Factors:  [99.62805936]
mat_Sqrt:  [[0.15]]
grads:  [0.06890411]
Stock Position:  0.06890411076083715
Bond Position:  [0.55533344]


portfolio before change:  [7.52760174]
curr_Stock_Price:  101.18597248080046
curr_Factors:  [101.18597248]
mat_Sqrt:  [[0.15]]
grads:  [0.00551774]
Stock Position:  0.005517737584945141
Bond Position:  [6.9692841]


portfolio before change:  [7.53461649]
curr_Stock_Price:  102.14147454735372
curr_Factors:  [102.14147455]
mat_Sqrt:  [[0.15]]
grads:  [0.09634272]
Stock Position:  0.09634272345339814
Bond Position:  [-2.30597134]


portfolio before change:  [7.43020232]
curr_Stock_Price:  101.0636805680681
curr_Factors:  [101.06368057]
mat_Sqrt:  [[0.15]]
grads:  [0.12552655]
Stock Position:  0.12552654730493462
Bond Position:  [-5.25597256]


portfolio before change:  [7.482857]
curr_Stock_Price:  101.49362022279325
curr_Factors:  [101.49362022]
mat_Sqrt:  [[0.15]]
grads:  [0.04393278]
Stock Position:  0.04393278115660198
Bond Position:  [3.02396]


portfolio before change:  [7.52203547]
curr_Stock_Price:  102.368192263876
curr_Factors:  [102.36819226]
mat_Sqrt:  [[0.15]]
grads:  [0.23289453]
Stock Position:  0.23289453109856437
Bond Position:  [-16.31895667]


portfolio before change:  [7.21714695]
curr_Stock_Price:  101.07658497542391
curr_Factors:  [101.07658498]
mat_Sqrt:  [[0.15]]
grads:  [0.08779549]
Stock Position:  0.08779548683994984
Bond Position:  [-1.65692104]


portfolio before change:  [7.35006468]
curr_Stock_Price:  102.59525095579676
curr_Factors:  [102.59525096]
mat_Sqrt:  [[0.15]]
grads:  [0.05190862]
Stock Position:  0.05190861870714068
Bond Position:  [2.02448692]


portfolio before change:  [7.32887826]
curr_Stock_Price:  102.17735095249212
curr_Factors:  [102.17735095]
mat_Sqrt:  [[0.15]]
grads:  [0.03473474]
Stock Position:  0.03473474494565861
Bond Position:  [3.77977403]


portfolio before change:  [7.29276403]
curr_Stock_Price:  101.11042810428434
curr_Factors:  [101.1104281]
mat_Sqrt:  [[0.15]]
grads:  [-0.10741289]
Stock Position:  -0.10741289297601271
Bond Position:  [18.15332762]


portfolio before change:  [7.36045414]
curr_Stock_Price:  100.52249855525106
curr_Factors:  [100.52249856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01308675]
Stock Position:  -0.013086752684229076
Bond Position:  [8.67596722]


portfolio before change:  [7.34918046]
curr_Stock_Price:  101.54971578177852
curr_Factors:  [101.54971578]
mat_Sqrt:  [[0.15]]
grads:  [-0.15998006]
Stock Position:  -0.15998005790233008
Bond Position:  [23.59510987]


portfolio before change:  [7.54215323]
curr_Stock_Price:  100.38036224471585
curr_Factors:  [100.38036224]
mat_Sqrt:  [[0.15]]
grads:  [0.01735161]
Stock Position:  0.017351606888612266
Bond Position:  [5.80039264]


portfolio before change:  [7.56925699]
curr_Stock_Price:  101.8588125494954
curr_Factors:  [101.85881255]
mat_Sqrt:  [[0.15]]
grads:  [0.03103088]
Stock Position:  0.03103087640722565
Bond Position:  [4.40848877]


portfolio before change:  [7.61739413]
curr_Stock_Price:  103.37455678895185
curr_Factors:  [103.37455679]
mat_Sqrt:  [[0.15]]
grads:  [0.01477844]
Stock Position:  0.014778441321999769
Bond Position:  [6.0896793]


portfolio before change:  [7.62653957]
curr_Stock_Price:  103.89036431559448
curr_Factors:  [103.89036432]
mat_Sqrt:  [[0.15]]
grads:  [0.04779373]
Stock Position:  0.04779372531618061
Bond Position:  [2.66123203]


portfolio before change:  [7.59093265]
curr_Stock_Price:  103.1314297031147
curr_Factors:  [103.1314297]
mat_Sqrt:  [[0.15]]
grads:  [-0.0337413]
Stock Position:  -0.03374130413669241
Bond Position:  [11.07072158]


portfolio before change:  [7.5447385]
curr_Stock_Price:  104.58253460220318
curr_Factors:  [104.5825346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.5447385]
Stock Price:  104.09007395143449
PL:  [3.45466455]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.34719255e-03]
 [ 8.46936618e-03]
 [ 1.52964075e-03]
 [ 1.48282177e-02]
 [ 2.52621957e-02]
 [ 6.36939420e-03]
 [ 3.37422886e-02]
 [ 1.24727234e-02]
 [ 6.34820836e-03]
 [-6.52712130e-04]
 [-1.53416144e-02]
 [-8.64981977e-03]
 [-2.33382175e-02]
 [ 1.97301412e-03]
 [ 8.70345806e-04]
 [ 4.66077218e-03]
 [ 7.51741372e-03]
 [-1.85832218e-03]
 [-1.26939346e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.93729408]
curr_Stock_Price:  99.62978797620231
curr_Factors:  [99.62978798]
mat_Sqrt:  [[0.15]]
grads:  [0.01564795]
Stock Position:  0.015647950308553014
Bond Position:  [-5.49629605]


portfolio before change:  [-3.92737091]
curr_Stock_Price:  100.35176188227673
curr_Factors:  [100.35176188]
mat_Sqrt:  [[0.15]]
grads:  [0.05646244]
Stock Position:  0.05646244121932979
Bond Position:  [-9.59347637]


portfolio before change:  [-3.82639233]
curr_Stock_Price:  102.18266491526477
curr_Factors:  [102.18266492]
mat_Sqrt:  [[0.15]]
grads:  [0.01019761]
Stock Position:  0.01019760500193301
Bond Position:  [-4.86841078]


portfolio before change:  [-3.82483245]
curr_Stock_Price:  102.45499702570798
curr_Factors:  [102.45499703]
mat_Sqrt:  [[0.15]]
grads:  [0.09885478]
Stock Position:  0.09885478462145025
Bond Position:  [-13.95299911]


portfolio before change:  [-3.81295117]
curr_Stock_Price:  102.6104772489242
curr_Factors:  [102.61047725]
mat_Sqrt:  [[0.15]]
grads:  [0.16841464]
Stock Position:  0.16841463784855767
Bond Position:  [-21.09405753]


portfolio before change:  [-3.6548686]
curr_Stock_Price:  103.58044485639444
curr_Factors:  [103.58044486]
mat_Sqrt:  [[0.15]]
grads:  [0.04246263]
Stock Position:  0.04246262801159274
Bond Position:  [-8.0531665]


portfolio before change:  [-3.71799831]
curr_Stock_Price:  102.14115182689997
curr_Factors:  [102.14115183]
mat_Sqrt:  [[0.15]]
grads:  [0.22494859]
Stock Position:  0.22494859041598286
Bond Position:  [-26.69450643]


portfolio before change:  [-3.88950166]
curr_Stock_Price:  101.40841156690104
curr_Factors:  [101.40841157]
mat_Sqrt:  [[0.15]]
grads:  [0.08315149]
Stock Position:  0.08315148903834055
Bond Position:  [-12.32176208]


portfolio before change:  [-3.83514035]
curr_Stock_Price:  102.09922458965475
curr_Factors:  [102.09922459]
mat_Sqrt:  [[0.15]]
grads:  [0.04232139]
Stock Position:  0.042321389042557334
Bond Position:  [-8.15612135]


portfolio before change:  [-3.8003974]
curr_Stock_Price:  102.96834138699164
curr_Factors:  [102.96834139]
mat_Sqrt:  [[0.15]]
grads:  [-0.00435141]
Stock Position:  -0.004351414197716584
Bond Position:  [-3.3523395]


portfolio before change:  [-3.79571683]
curr_Stock_Price:  101.70007165283303
curr_Factors:  [101.70007165]
mat_Sqrt:  [[0.15]]
grads:  [-0.10227743]
Stock Position:  -0.10227742904687953
Bond Position:  [6.60590504]


portfolio before change:  [-3.75474795]
curr_Stock_Price:  101.31565450053475
curr_Factors:  [101.3156545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05766547]
Stock Position:  -0.0576654651073891
Bond Position:  [2.08766639]


portfolio before change:  [-3.78686318]
curr_Stock_Price:  101.88162953004999
curr_Factors:  [101.88162953]
mat_Sqrt:  [[0.15]]
grads:  [-0.15558812]
Stock Position:  -0.15558811671630302
Bond Position:  [12.06470769]


portfolio before change:  [-3.70283855]
curr_Stock_Price:  101.36097233434687
curr_Factors:  [101.36097233]
mat_Sqrt:  [[0.15]]
grads:  [0.01315343]
Stock Position:  0.013153427463777612
Bond Position:  [-5.03608275]


portfolio before change:  [-3.70438931]
curr_Stock_Price:  101.33880451596826
curr_Factors:  [101.33880452]
mat_Sqrt:  [[0.15]]
grads:  [0.00580231]
Stock Position:  0.005802305374345551
Bond Position:  [-4.292388]


portfolio before change:  [-3.70171757]
curr_Stock_Price:  101.98423373526649
curr_Factors:  [101.98423374]
mat_Sqrt:  [[0.15]]
grads:  [0.03107181]
Stock Position:  0.031071814543806517
Bond Position:  [-6.87055276]


portfolio before change:  [-3.75596597]
curr_Stock_Price:  100.29361647490607
curr_Factors:  [100.29361647]
mat_Sqrt:  [[0.15]]
grads:  [0.05011609]
Stock Position:  0.050116091440663375
Bond Position:  [-8.78229002]


portfolio before change:  [-3.80271947]
curr_Stock_Price:  99.40452765799488
curr_Factors:  [99.40452766]
mat_Sqrt:  [[0.15]]
grads:  [-0.01238881]
Stock Position:  -0.01238881453149388
Bond Position:  [-2.57121521]


portfolio before change:  [-3.78223865]
curr_Stock_Price:  97.69946556147832
curr_Factors:  [97.69946556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.78223865]
Stock Price:  98.70008107628819
PL:  [-3.78223865]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.58508269e-03]
 [ 9.52563252e-03]
 [ 1.02065818e-03]
 [ 3.31519540e-03]
 [ 5.71639006e-04]
 [ 2.97216133e-03]
 [-4.26470227e-03]
 [ 2.92768824e-03]
 [ 4.63165233e-03]
 [-5.89218797e-03]
 [-1.76346593e-02]
 [ 5.86657468e-03]
 [-7.37375048e-03]
 [ 1.00534098e-03]
 [-1.60766605e-02]
 [ 7.85075850e-03]
 [ 7.44541428e-03]
 [-1.75221231e-03]
 [-1.28257045e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.09252459]
curr_Stock_Price:  100.08584299161411
curr_Factors:  [100.08584299]
mat_Sqrt:  [[0.15]]
grads:  [0.02390055]
Stock Position:  0.02390055128205353
Bond Position:  [0.70041777]


portfolio before change:  [3.08895873]
curr_Stock_Price:  99.92931966115513
curr_Factors:  [99.92931966]
mat_Sqrt:  [[0.15]]
grads:  [0.06350422]
Stock Position:  0.06350421682288937
Bond Position:  [-3.25697446]


portfolio before change:  [3.18541882]
curr_Stock_Price:  101.46109886480502
curr_Factors:  [101.46109886]
mat_Sqrt:  [[0.15]]
grads:  [0.00680439]
Stock Position:  0.006804387869402223
Bond Position:  [2.49503815]


portfolio before change:  [3.17480489]
curr_Stock_Price:  99.80955155416305
curr_Factors:  [99.80955155]
mat_Sqrt:  [[0.15]]
grads:  [0.0221013]
Stock Position:  0.02210130268856045
Bond Position:  [0.96888378]


portfolio before change:  [3.13848494]
curr_Stock_Price:  98.15525104345333
curr_Factors:  [98.15525104]
mat_Sqrt:  [[0.15]]
grads:  [0.00381093]
Stock Position:  0.0038109267051218004
Bond Position:  [2.76442248]


portfolio before change:  [3.13700478]
curr_Stock_Price:  97.58548059544549
curr_Factors:  [97.5854806]
mat_Sqrt:  [[0.15]]
grads:  [0.01981441]
Stock Position:  0.01981440885745005
Bond Position:  [1.20340617]


portfolio before change:  [3.12283428]
curr_Stock_Price:  96.85513386692729
curr_Factors:  [96.85513387]
mat_Sqrt:  [[0.15]]
grads:  [-0.02843135]
Stock Position:  -0.028431348446540383
Bond Position:  [5.87655634]


portfolio before change:  [3.14770038]
curr_Stock_Price:  96.03221201802556
curr_Factors:  [96.03221202]
mat_Sqrt:  [[0.15]]
grads:  [0.01951792]
Stock Position:  0.01951792162200712
Bond Position:  [1.2733512]


portfolio before change:  [3.15784007]
curr_Stock_Price:  96.53540646903787
curr_Factors:  [96.53540647]
mat_Sqrt:  [[0.15]]
grads:  [0.03087768]
Stock Position:  0.03087768222311467
Bond Position:  [0.17705047]


portfolio before change:  [3.15241841]
curr_Stock_Price:  96.3583876499641
curr_Factors:  [96.35838765]
mat_Sqrt:  [[0.15]]
grads:  [-0.03928125]
Stock Position:  -0.03928125313329202
Bond Position:  [6.93749662]


portfolio before change:  [3.16534148]
curr_Stock_Price:  96.07355760077972
curr_Factors:  [96.0735576]
mat_Sqrt:  [[0.15]]
grads:  [-0.1175644]
Stock Position:  -0.1175643954831267
Bond Position:  [14.4601712]


portfolio before change:  [3.07445028]
curr_Stock_Price:  96.87742935546068
curr_Factors:  [96.87742936]
mat_Sqrt:  [[0.15]]
grads:  [0.0391105]
Stock Position:  0.03911049787299406
Bond Position:  [-0.71447422]


portfolio before change:  [3.10516837]
curr_Stock_Price:  97.66741495560822
curr_Factors:  [97.66741496]
mat_Sqrt:  [[0.15]]
grads:  [-0.04915834]
Stock Position:  -0.04915833656286922
Bond Position:  [7.90633602]


portfolio before change:  [3.06698356]
curr_Stock_Price:  98.48440032142142
curr_Factors:  [98.48440032]
mat_Sqrt:  [[0.15]]
grads:  [0.00670227]
Stock Position:  0.006702273202347521
Bond Position:  [2.4069142]


portfolio before change:  [3.0691394]
curr_Stock_Price:  98.71626791415237
curr_Factors:  [98.71626791]
mat_Sqrt:  [[0.15]]
grads:  [-0.10717774]
Stock Position:  -0.1071777364433216
Bond Position:  [13.64932555]


portfolio before change:  [2.97966544]
curr_Stock_Price:  99.58292850391604
curr_Factors:  [99.5829285]
mat_Sqrt:  [[0.15]]
grads:  [0.05233839]
Stock Position:  0.05233838999027088
Bond Position:  [-2.23234471]


portfolio before change:  [2.99227921]
curr_Stock_Price:  99.83459712877475
curr_Factors:  [99.83459713]
mat_Sqrt:  [[0.15]]
grads:  [0.0496361]
Stock Position:  0.04963609518413026
Bond Position:  [-1.96312035]


portfolio before change:  [2.93426158]
curr_Stock_Price:  98.67562613064865
curr_Factors:  [98.67562613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01168142]
Stock Position:  -0.01168141537085381
Bond Position:  [4.08693255]


portfolio before change:  [2.92468223]
curr_Stock_Price:  99.58315373639064
curr_Factors:  [99.58315374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.92468223]
Stock Price:  100.17078897936192
PL:  [2.75389325]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.56956944e-02]
 [ 9.84199687e-03]
 [-9.80502067e-04]
 [ 4.62433278e-04]
 [-2.99789978e-03]
 [-1.87656593e-04]
 [-6.29789092e-03]
 [ 5.70435872e-03]
 [ 4.59527193e-03]
 [-2.49612239e-02]
 [-1.75227401e-02]
 [ 6.66408908e-03]
 [ 1.12851995e-02]
 [-2.02029964e-03]
 [-1.70869017e-02]
 [ 7.27581403e-03]
 [ 3.66172107e-03]
 [-2.36090598e-03]
 [-1.27195714e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.56094493]
curr_Stock_Price:  99.005459747617
curr_Factors:  [99.00545975]
mat_Sqrt:  [[0.15]]
grads:  [0.10463796]
Stock Position:  0.10463796274710452
Bond Position:  [-23.92067454]


portfolio before change:  [-13.47694596]
curr_Stock_Price:  99.86537606048472
curr_Factors:  [99.86537606]
mat_Sqrt:  [[0.15]]
grads:  [0.06561331]
Stock Position:  0.06561331244427945
Bond Position:  [-20.02944408]


portfolio before change:  [-13.57134417]
curr_Stock_Price:  98.5029967294678
curr_Factors:  [98.50299673]
mat_Sqrt:  [[0.15]]
grads:  [-0.00653668]
Stock Position:  -0.006536680446021571
Bond Position:  [-12.92746155]


portfolio before change:  [-13.5691395]
curr_Stock_Price:  97.67123906729002
curr_Factors:  [97.67123907]
mat_Sqrt:  [[0.15]]
grads:  [0.00308289]
Stock Position:  0.003082888519198475
Bond Position:  [-13.87024904]


portfolio before change:  [-13.5755195]
curr_Stock_Price:  96.7266686429791
curr_Factors:  [96.72666864]
mat_Sqrt:  [[0.15]]
grads:  [-0.019986]
Stock Position:  -0.019985998546098664
Bond Position:  [-11.64234044]


portfolio before change:  [-13.57210856]
curr_Stock_Price:  96.41035276475604
curr_Factors:  [96.41035276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00125104]
Stock Position:  -0.0012510439558547615
Bond Position:  [-13.45149497]


portfolio before change:  [-13.57701288]
curr_Stock_Price:  97.64213983117003
curr_Factors:  [97.64213983]
mat_Sqrt:  [[0.15]]
grads:  [-0.04198594]
Stock Position:  -0.04198593946220029
Bond Position:  [-9.4774159]


portfolio before change:  [-13.53981173]
curr_Stock_Price:  96.69966250448697
curr_Factors:  [96.6996625]
mat_Sqrt:  [[0.15]]
grads:  [0.03802906]
Stock Position:  0.038029058119195616
Bond Position:  [-17.21720882]


portfolio before change:  [-13.57128407]
curr_Stock_Price:  95.98527466460989
curr_Factors:  [95.98527466]
mat_Sqrt:  [[0.15]]
grads:  [0.03063515]
Stock Position:  0.030635146211573337
Bond Position:  [-16.51180699]


portfolio before change:  [-13.64424822]
curr_Stock_Price:  93.73832341176319
curr_Factors:  [93.73832341]
mat_Sqrt:  [[0.15]]
grads:  [-0.16640816]
Stock Position:  -0.16640815916346333
Bond Position:  [1.95457363]


portfolio before change:  [-13.85027548]
curr_Stock_Price:  94.97934412547768
curr_Factors:  [94.97934413]
mat_Sqrt:  [[0.15]]
grads:  [-0.11681827]
Stock Position:  -0.11681826734886047
Bond Position:  [-2.75495307]


portfolio before change:  [-13.99960791]
curr_Stock_Price:  96.25177868684325
curr_Factors:  [96.25177869]
mat_Sqrt:  [[0.15]]
grads:  [0.04442726]
Stock Position:  0.04442726050101044
Bond Position:  [-18.27581075]


portfolio before change:  [-14.03816971]
curr_Stock_Price:  95.48665653759329
curr_Factors:  [95.48665654]
mat_Sqrt:  [[0.15]]
grads:  [0.07523466]
Stock Position:  0.07523466314883222
Bond Position:  [-21.22207615]


portfolio before change:  [-13.96555563]
curr_Stock_Price:  96.52235290966355
curr_Factors:  [96.52235291]
mat_Sqrt:  [[0.15]]
grads:  [-0.01346866]
Stock Position:  -0.01346866426007607
Bond Position:  [-12.66552846]


portfolio before change:  [-13.98577704]
curr_Stock_Price:  97.7885984792501
curr_Factors:  [97.78859848]
mat_Sqrt:  [[0.15]]
grads:  [-0.11391268]
Stock Position:  -0.1139126782764105
Bond Position:  [-2.84641589]


portfolio before change:  [-13.93930959]
curr_Stock_Price:  97.37442906660327
curr_Factors:  [97.37442907]
mat_Sqrt:  [[0.15]]
grads:  [0.04850543]
Stock Position:  0.04850542683534676
Bond Position:  [-18.66249783]


portfolio before change:  [-13.99185504]
curr_Stock_Price:  96.3873385187192
curr_Factors:  [96.38733852]
mat_Sqrt:  [[0.15]]
grads:  [0.02441147]
Stock Position:  0.024411473773713478
Bond Position:  [-16.34481203]


portfolio before change:  [-13.98463558]
curr_Stock_Price:  96.85048865157319
curr_Factors:  [96.85048865]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573937]
Stock Position:  -0.01573937322960879
Bond Position:  [-12.46026959]


portfolio before change:  [-14.00851841]
curr_Stock_Price:  98.16994245028008
curr_Factors:  [98.16994245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.00851841]
Stock Price:  97.46861628696121
PL:  [-14.00851841]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.84171844e-03]
 [ 1.00622434e-02]
 [ 1.06504970e-03]
 [ 7.47559456e-03]
 [ 9.69059265e-03]
 [ 6.47621822e-03]
 [ 2.78722977e-02]
 [ 1.05300017e-02]
 [ 3.25952292e-03]
 [ 1.04736295e-02]
 [-1.85425932e-02]
 [-7.11675929e-03]
 [-2.52125659e-02]
 [ 1.54410693e-03]
 [-1.67868967e-02]
 [ 7.91514473e-03]
 [ 4.02952903e-03]
 [-3.09994210e-03]
 [-1.20751680e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.05706213]
curr_Stock_Price:  100.86203475467201
curr_Factors:  [100.86203475]
mat_Sqrt:  [[0.15]]
grads:  [0.05227812]
Stock Position:  0.052278122905326276
Bond Position:  [9.78418428]


portfolio before change:  [14.98916511]
curr_Stock_Price:  99.51647433893477
curr_Factors:  [99.51647434]
mat_Sqrt:  [[0.15]]
grads:  [0.06708162]
Stock Position:  0.0670816225479356
Bond Position:  [8.31343854]


portfolio before change:  [15.125187]
curr_Stock_Price:  101.51319525749368
curr_Factors:  [101.51319526]
mat_Sqrt:  [[0.15]]
grads:  [0.00710033]
Stock Position:  0.007100331358341799
Bond Position:  [14.40440968]


portfolio before change:  [15.12189295]
curr_Stock_Price:  100.54202861672965
curr_Factors:  [100.54202862]
mat_Sqrt:  [[0.15]]
grads:  [0.0498373]
Stock Position:  0.04983729709062386
Bond Position:  [10.11115]


portfolio before change:  [15.106988]
curr_Stock_Price:  100.19222933023691
curr_Factors:  [100.19222933]
mat_Sqrt:  [[0.15]]
grads:  [0.06460395]
Stock Position:  0.06460395103211675
Bond Position:  [8.63417413]


portfolio before change:  [15.18499184]
curr_Stock_Price:  101.36622910687966
curr_Factors:  [101.36622911]
mat_Sqrt:  [[0.15]]
grads:  [0.04317479]
Stock Position:  0.043174788162410736
Bond Position:  [10.80852637]


portfolio before change:  [15.19263593]
curr_Stock_Price:  101.48068512289635
curr_Factors:  [101.48068512]
mat_Sqrt:  [[0.15]]
grads:  [0.18581532]
Stock Position:  0.18581531818214372
Bond Position:  [-3.66402987]


portfolio before change:  [15.23870455]
curr_Stock_Price:  101.73354235398303
curr_Factors:  [101.73354235]
mat_Sqrt:  [[0.15]]
grads:  [0.07020001]
Stock Position:  0.07020001135778559
Bond Position:  [8.09700872]


portfolio before change:  [15.1393191]
curr_Stock_Price:  100.2889562856631
curr_Factors:  [100.28895629]
mat_Sqrt:  [[0.15]]
grads:  [0.02173015]
Stock Position:  0.02173015280728376
Bond Position:  [12.96002475]


portfolio before change:  [15.09883379]
curr_Stock_Price:  98.2767420094907
curr_Factors:  [98.27674201]
mat_Sqrt:  [[0.15]]
grads:  [0.0698242]
Stock Position:  0.06982419681531091
Bond Position:  [8.23673921]


portfolio before change:  [15.13970301]
curr_Stock_Price:  98.83256339263721
curr_Factors:  [98.83256339]
mat_Sqrt:  [[0.15]]
grads:  [-0.12361729]
Stock Position:  -0.12361728795220947
Bond Position:  [27.35711646]


portfolio before change:  [14.722979]
curr_Stock_Price:  102.25897853893191
curr_Factors:  [102.25897854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04744506]
Stock Position:  -0.04744506196133497
Bond Position:  [19.57466257]


portfolio before change:  [14.78243]
curr_Stock_Price:  101.10908590437944
curr_Factors:  [101.1090859]
mat_Sqrt:  [[0.15]]
grads:  [-0.16808377]
Stock Position:  -0.16808377253087725
Bond Position:  [31.7772266]


portfolio before change:  [15.18805314]
curr_Stock_Price:  98.74313569549092
curr_Factors:  [98.7431357]
mat_Sqrt:  [[0.15]]
grads:  [0.01029405]
Stock Position:  0.010294046185714254
Bond Position:  [14.17158674]


portfolio before change:  [15.18460627]
curr_Stock_Price:  98.06408267253411
curr_Factors:  [98.06408267]
mat_Sqrt:  [[0.15]]
grads:  [-0.11191264]
Stock Position:  -0.11191264469990421
Bond Position:  [26.15921711]


portfolio before change:  [15.11173905]
curr_Stock_Price:  98.77363471399272
curr_Factors:  [98.77363471]
mat_Sqrt:  [[0.15]]
grads:  [0.05276763]
Stock Position:  0.05276763150986338
Bond Position:  [9.89968829]


portfolio before change:  [15.02405917]
curr_Stock_Price:  97.06510422566808
curr_Factors:  [97.06510423]
mat_Sqrt:  [[0.15]]
grads:  [0.02686353]
Stock Position:  0.026863526838368085
Bond Position:  [12.41654814]


portfolio before change:  [14.99476049]
curr_Stock_Price:  95.85888853303925
curr_Factors:  [95.85888853]
mat_Sqrt:  [[0.15]]
grads:  [-0.02066628]
Stock Position:  -0.02066628066323557
Bond Position:  [16.97580719]


portfolio before change:  [15.01416459]
curr_Stock_Price:  95.12534479636665
curr_Factors:  [95.1253448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.01416459]
Stock Price:  96.10084253286762
PL:  [15.01416459]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.56668033e-03]
 [ 1.01365305e-02]
 [ 1.38893730e-03]
 [ 1.71958657e-03]
 [ 1.42023910e-03]
 [ 4.45337718e-03]
 [-1.55258410e-02]
 [ 1.25248640e-02]
 [ 4.04899510e-03]
 [ 1.11183057e-02]
 [-1.70182025e-02]
 [-8.67957651e-03]
 [-2.50320322e-02]
 [ 2.72576948e-03]
 [-4.05413138e-03]
 [ 7.56154361e-03]
 [ 7.52732819e-03]
 [-1.95061238e-03]
 [-1.28427219e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.65674192]
curr_Stock_Price:  100.1873205956447
curr_Factors:  [100.1873206]
mat_Sqrt:  [[0.15]]
grads:  [0.03044454]
Stock Position:  0.030444535505700598
Bond Position:  [1.60658548]


portfolio before change:  [4.64529359]
curr_Stock_Price:  99.79808734877392
curr_Factors:  [99.79808735]
mat_Sqrt:  [[0.15]]
grads:  [0.06757687]
Stock Position:  0.06757687025945638
Bond Position:  [-2.09874881]


portfolio before change:  [4.62670579]
curr_Stock_Price:  99.53079114330619
curr_Factors:  [99.53079114]
mat_Sqrt:  [[0.15]]
grads:  [0.00925958]
Stock Position:  0.009259582025723558
Bond Position:  [3.70509227]


portfolio before change:  [4.6170722]
curr_Stock_Price:  98.39035223816057
curr_Factors:  [98.39035224]
mat_Sqrt:  [[0.15]]
grads:  [0.01146391]
Stock Position:  0.011463910499934876
Bond Position:  [3.489134]


portfolio before change:  [4.61908817]
curr_Stock_Price:  98.49010682958652
curr_Factors:  [98.49010683]
mat_Sqrt:  [[0.15]]
grads:  [0.00946826]
Stock Position:  0.00946826066320378
Bond Position:  [3.68655816]


portfolio before change:  [4.6265581]
curr_Stock_Price:  99.18169957752869
curr_Factors:  [99.18169958]
mat_Sqrt:  [[0.15]]
grads:  [0.02968918]
Stock Position:  0.02968918123235597
Bond Position:  [1.68193465]


portfolio before change:  [4.63091487]
curr_Stock_Price:  99.31428099159328
curr_Factors:  [99.31428099]
mat_Sqrt:  [[0.15]]
grads:  [-0.10350561]
Stock Position:  -0.10350560655314658
Bond Position:  [14.91049976]


portfolio before change:  [4.57853738]
curr_Stock_Price:  99.85633454252144
curr_Factors:  [99.85633454]
mat_Sqrt:  [[0.15]]
grads:  [0.08349909]
Stock Position:  0.08349909329923001
Bond Position:  [-3.75937601]


portfolio before change:  [4.65701548]
curr_Stock_Price:  100.80745938445281
curr_Factors:  [100.80745938]
mat_Sqrt:  [[0.15]]
grads:  [0.0269933]
Stock Position:  0.026993300645529895
Bond Position:  [1.93588942]


portfolio before change:  [4.62029465]
curr_Stock_Price:  99.42915931244704
curr_Factors:  [99.42915931]
mat_Sqrt:  [[0.15]]
grads:  [0.07412204]
Stock Position:  0.07412203792883153
Bond Position:  [-2.74959727]


portfolio before change:  [4.67945686]
curr_Stock_Price:  100.23660744844844
curr_Factors:  [100.23660745]
mat_Sqrt:  [[0.15]]
grads:  [-0.11345468]
Stock Position:  -0.11345468309566151
Bond Position:  [16.05176939]


portfolio before change:  [4.5258275]
curr_Stock_Price:  101.62608560175079
curr_Factors:  [101.6260856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05786384]
Stock Position:  -0.05786384343211614
Bond Position:  [10.40630341]


portfolio before change:  [4.55538694]
curr_Stock_Price:  101.16020675926598
curr_Factors:  [101.16020676]
mat_Sqrt:  [[0.15]]
grads:  [-0.16688021]
Stock Position:  -0.16688021491144026
Bond Position:  [21.43702399]


portfolio before change:  [4.6989364]
curr_Stock_Price:  100.33213055546572
curr_Factors:  [100.33213056]
mat_Sqrt:  [[0.15]]
grads:  [0.0181718]
Stock Position:  0.018171796517915628
Bond Position:  [2.87572134]


portfolio before change:  [4.70808731]
curr_Stock_Price:  100.79613988187728
curr_Factors:  [100.79613988]
mat_Sqrt:  [[0.15]]
grads:  [-0.02702754]
Stock Position:  -0.027027542530356937
Bond Position:  [7.43235927]


portfolio before change:  [4.7108511]
curr_Stock_Price:  100.76263830843165
curr_Factors:  [100.76263831]
mat_Sqrt:  [[0.15]]
grads:  [0.05041029]
Stock Position:  0.05041029073265089
Bond Position:  [-0.3686228]


portfolio before change:  [4.67191785]
curr_Stock_Price:  99.99213937670665
curr_Factors:  [99.99213938]
mat_Sqrt:  [[0.15]]
grads:  [0.05018219]
Stock Position:  0.050182187911841605
Bond Position:  [-0.34590648]


portfolio before change:  [4.65293779]
curr_Stock_Price:  99.61563981875275
curr_Factors:  [99.61563982]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300408]
Stock Position:  -0.01300408255220901
Bond Position:  [5.9483478]


portfolio before change:  [4.65007073]
curr_Stock_Price:  99.95048395737244
curr_Factors:  [99.95048396]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.65007073]
Stock Price:  98.28447041206162
PL:  [4.65007073]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.21226573e-02]
 [ 2.21024749e-03]
 [-1.37341466e-03]
 [ 1.07200405e-03]
 [-1.93822808e-04]
 [ 4.03305781e-03]
 [-1.31004096e-02]
 [ 1.32905868e-02]
 [ 3.72971505e-03]
 [ 8.54092228e-03]
 [-1.67018138e-02]
 [-8.00950293e-03]
 [-2.02074049e-02]
 [ 5.67018553e-03]
 [ 3.15697608e-02]
 [ 7.71061519e-04]
 [ 6.95005261e-03]
 [-5.34401987e-03]
 [-1.01676056e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.06248708]
curr_Stock_Price:  99.16754561186765
curr_Factors:  [99.16754561]
mat_Sqrt:  [[0.15]]
grads:  [0.08081772]
Stock Position:  0.08081771529698843
Bond Position:  [-19.07698155]


portfolio before change:  [-11.16263452]
curr_Stock_Price:  97.98738853243063
curr_Factors:  [97.98738853]
mat_Sqrt:  [[0.15]]
grads:  [0.01473498]
Stock Position:  0.014734983263166019
Bond Position:  [-12.60647705]


portfolio before change:  [-11.16184915]
curr_Stock_Price:  98.25460152314311
curr_Factors:  [98.25460152]
mat_Sqrt:  [[0.15]]
grads:  [-0.0091561]
Stock Position:  -0.009156097704862625
Bond Position:  [-10.26222042]


portfolio before change:  [-11.1622663]
curr_Stock_Price:  98.01992396517504
curr_Factors:  [98.01992397]
mat_Sqrt:  [[0.15]]
grads:  [0.00714669]
Stock Position:  0.007146693650159029
Bond Position:  [-11.86278467]


portfolio before change:  [-11.16732301]
curr_Stock_Price:  97.72739064319036
curr_Factors:  [97.72739064]
mat_Sqrt:  [[0.15]]
grads:  [-0.00129215]
Stock Position:  -0.001292152052228436
Bond Position:  [-11.04104436]


portfolio before change:  [-11.17236639]
curr_Stock_Price:  99.49403041300376
curr_Factors:  [99.49403041]
mat_Sqrt:  [[0.15]]
grads:  [0.02688705]
Stock Position:  0.026887052065692314
Bond Position:  [-13.84746756]


portfolio before change:  [-11.18908288]
curr_Stock_Price:  99.001072244056
curr_Factors:  [99.00107224]
mat_Sqrt:  [[0.15]]
grads:  [-0.08733606]
Stock Position:  -0.08733606420426232
Bond Position:  [-2.54271888]


portfolio before change:  [-11.35640023]
curr_Stock_Price:  100.90958047917168
curr_Factors:  [100.90958048]
mat_Sqrt:  [[0.15]]
grads:  [0.08860391]
Stock Position:  0.08860391166708949
Bond Position:  [-20.29738379]


portfolio before change:  [-11.38520978]
curr_Stock_Price:  100.64170776994646
curr_Factors:  [100.64170777]
mat_Sqrt:  [[0.15]]
grads:  [0.02486477]
Stock Position:  0.024864767010225244
Bond Position:  [-13.8876424]


portfolio before change:  [-11.38566998]
curr_Stock_Price:  100.76284883097742
curr_Factors:  [100.76284883]
mat_Sqrt:  [[0.15]]
grads:  [0.05693948]
Stock Position:  0.05693948186308979
Bond Position:  [-17.12305439]


portfolio before change:  [-11.39962803]
curr_Stock_Price:  100.59290098075039
curr_Factors:  [100.59290098]
mat_Sqrt:  [[0.15]]
grads:  [-0.11134543]
Stock Position:  -0.11134542524142302
Bond Position:  [-0.19906869]


portfolio before change:  [-11.55431768]
curr_Stock_Price:  101.98173111923174
curr_Factors:  [101.98173112]
mat_Sqrt:  [[0.15]]
grads:  [-0.05339669]
Stock Position:  -0.05339668618987901
Bond Position:  [-6.10883119]


portfolio before change:  [-11.70347102]
curr_Stock_Price:  104.7464334434851
curr_Factors:  [104.74643344]
mat_Sqrt:  [[0.15]]
grads:  [-0.13471603]
Stock Position:  -0.13471603246657765
Bond Position:  [2.40755291]


portfolio before change:  [-11.80836916]
curr_Stock_Price:  105.52956291990898
curr_Factors:  [105.52956292]
mat_Sqrt:  [[0.15]]
grads:  [0.03780124]
Stock Position:  0.037801236856914035
Bond Position:  [-15.79751716]


portfolio before change:  [-11.82818136]
curr_Stock_Price:  105.1099381871985
curr_Factors:  [105.10993819]
mat_Sqrt:  [[0.15]]
grads:  [0.21046507]
Stock Position:  0.21046507216755195
Bond Position:  [-33.95015209]


portfolio before change:  [-11.83255231]
curr_Stock_Price:  105.12950270944094
curr_Factors:  [105.12950271]
mat_Sqrt:  [[0.15]]
grads:  [0.00514041]
Stock Position:  0.005140410129422137
Bond Position:  [-12.37296107]


portfolio before change:  [-11.83860675]
curr_Stock_Price:  104.55351633097499
curr_Factors:  [104.55351633]
mat_Sqrt:  [[0.15]]
grads:  [0.04633368]
Stock Position:  0.04633368404588926
Bond Position:  [-16.68295634]


portfolio before change:  [-11.81767662]
curr_Stock_Price:  105.09526879011997
curr_Factors:  [105.09526879]
mat_Sqrt:  [[0.15]]
grads:  [-0.0356268]
Stock Position:  -0.03562679915055346
Bond Position:  [-8.07346859]


portfolio before change:  [-11.86468375]
curr_Stock_Price:  106.35804045697358
curr_Factors:  [106.35804046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.86468375]
Stock Price:  106.02977828800063
PL:  [-17.89446204]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.22410911e-03]
 [ 8.76410722e-03]
 [-3.78064084e-04]
 [ 2.08279710e-03]
 [-1.07682624e-03]
 [ 4.21512555e-03]
 [-1.44575168e-02]
 [ 1.25251979e-02]
 [ 4.15137090e-03]
 [ 6.09031742e-03]
 [-1.73422398e-02]
 [-8.64858006e-03]
 [-2.58224772e-02]
 [ 1.99762267e-03]
 [ 5.05923934e-03]
 [ 2.36111190e-03]
 [ 6.93046412e-03]
 [-5.46112030e-03]
 [-1.03672258e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.67951383]
curr_Stock_Price:  100.25367227325417
curr_Factors:  [100.25367227]
mat_Sqrt:  [[0.15]]
grads:  [0.03482739]
Stock Position:  0.03482739404232544
Bond Position:  [2.18793969]


portfolio before change:  [5.64474181]
curr_Stock_Price:  99.23955450527825
curr_Factors:  [99.23955451]
mat_Sqrt:  [[0.15]]
grads:  [0.05842738]
Stock Position:  0.05842738143598534
Bond Position:  [-0.1535655]


portfolio before change:  [5.61419257]
curr_Stock_Price:  98.7173533412318
curr_Factors:  [98.71735334]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252043]
Stock Position:  -0.0025204272258486675
Bond Position:  [5.86300247]


portfolio before change:  [5.61595903]
curr_Stock_Price:  98.59811486517626
curr_Factors:  [98.59811487]
mat_Sqrt:  [[0.15]]
grads:  [0.01388531]
Stock Position:  0.013885313992914594
Bond Position:  [4.24689325]


portfolio before change:  [5.59944716]
curr_Stock_Price:  97.33248082391376
curr_Factors:  [97.33248082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717884]
Stock Position:  -0.007178841604257933
Bond Position:  [6.29818162]


portfolio before change:  [5.5864718]
curr_Stock_Price:  99.35928463099928
curr_Factors:  [99.35928463]
mat_Sqrt:  [[0.15]]
grads:  [0.02810084]
Stock Position:  0.028100837004217748
Bond Position:  [2.79439274]


portfolio before change:  [5.58977395]
curr_Stock_Price:  99.45193202270103
curr_Factors:  [99.45193202]
mat_Sqrt:  [[0.15]]
grads:  [-0.09638345]
Stock Position:  -0.09638344540249001
Bond Position:  [15.17529381]


portfolio before change:  [5.55468818]
curr_Stock_Price:  99.85532150466447
curr_Factors:  [99.8553215]
mat_Sqrt:  [[0.15]]
grads:  [0.08350132]
Stock Position:  0.08350131929061479
Bond Position:  [-2.7833629]


portfolio before change:  [5.46930962]
curr_Stock_Price:  98.84117427530984
curr_Factors:  [98.84117428]
mat_Sqrt:  [[0.15]]
grads:  [0.02767581]
Stock Position:  0.027675805971522686
Bond Position:  [2.73380046]


portfolio before change:  [5.43842599]
curr_Stock_Price:  97.7005688716665
curr_Factors:  [97.70056887]
mat_Sqrt:  [[0.15]]
grads:  [0.04060212]
Stock Position:  0.04060211616521977
Bond Position:  [1.47157614]


portfolio before change:  [5.53157361]
curr_Stock_Price:  99.9856636259109
curr_Factors:  [99.98566363]
mat_Sqrt:  [[0.15]]
grads:  [-0.11561493]
Stock Position:  -0.11561493212939067
Bond Position:  [17.09140932]


portfolio before change:  [5.38357544]
curr_Stock_Price:  101.30272147305449
curr_Factors:  [101.30272147]
mat_Sqrt:  [[0.15]]
grads:  [-0.0576572]
Stock Position:  -0.057657200367435234
Bond Position:  [11.22440675]


portfolio before change:  [5.40763379]
curr_Stock_Price:  100.93413101260936
curr_Factors:  [100.93413101]
mat_Sqrt:  [[0.15]]
grads:  [-0.17214985]
Stock Position:  -0.1721498479440347
Bond Position:  [22.78342909]


portfolio before change:  [5.36562594]
curr_Stock_Price:  101.21124084073018
curr_Factors:  [101.21124084]
mat_Sqrt:  [[0.15]]
grads:  [0.01331748]
Stock Position:  0.013317484461885264
Bond Position:  [4.01774682]


portfolio before change:  [5.37630067]
curr_Stock_Price:  101.9373665305173
curr_Factors:  [101.93736653]
mat_Sqrt:  [[0.15]]
grads:  [0.03372826]
Stock Position:  0.03372826229570895
Bond Position:  [1.93813044]


portfolio before change:  [5.41826125]
curr_Stock_Price:  103.16707666106619
curr_Factors:  [103.16707666]
mat_Sqrt:  [[0.15]]
grads:  [0.01574075]
Stock Position:  0.015740746014923382
Bond Position:  [3.7943345]


portfolio before change:  [5.4419672]
curr_Stock_Price:  104.61283038674506
curr_Factors:  [104.61283039]
mat_Sqrt:  [[0.15]]
grads:  [0.04620309]
Stock Position:  0.04620309412483929
Bond Position:  [0.60853075]


portfolio before change:  [5.51828045]
curr_Stock_Price:  106.26122864206155
curr_Factors:  [106.26122864]
mat_Sqrt:  [[0.15]]
grads:  [-0.03640747]
Stock Position:  -0.03640746867509091
Bond Position:  [9.3869828]


portfolio before change:  [5.53628674]
curr_Stock_Price:  105.83111750527125
curr_Factors:  [105.83111751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.53628674]
Stock Price:  107.4387387544009
PL:  [-1.90245201]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.47331465e-03]
 [ 5.93261790e-03]
 [-3.37424672e-03]
 [ 7.90642217e-04]
 [-6.95892174e-04]
 [ 4.45715430e-03]
 [-1.55234855e-02]
 [ 1.22772588e-02]
 [ 2.77378702e-03]
 [ 1.29538114e-02]
 [-1.81563751e-02]
 [ 6.29834594e-03]
 [-1.42554714e-02]
 [ 2.25626441e-03]
 [-1.24318266e-02]
 [ 7.03052836e-03]
 [ 7.52513830e-03]
 [-2.17599215e-03]
 [-1.26008741e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.78167576]
curr_Stock_Price:  99.3803861598155
curr_Factors:  [99.38038616]
mat_Sqrt:  [[0.15]]
grads:  [0.0498221]
Stock Position:  0.04982209764718229
Bond Position:  [-12.73301506]


portfolio before change:  [-7.81908651]
curr_Stock_Price:  98.69339976567454
curr_Factors:  [98.69339977]
mat_Sqrt:  [[0.15]]
grads:  [0.03955079]
Stock Position:  0.03955078600736872
Bond Position:  [-11.72248805]


portfolio before change:  [-7.8894003]
curr_Stock_Price:  96.98969653270207
curr_Factors:  [96.98969653]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249498]
Stock Position:  -0.02249497815984407
Bond Position:  [-5.7076192]


portfolio before change:  [-7.9103819]
curr_Stock_Price:  97.85898018988006
curr_Factors:  [97.85898019]
mat_Sqrt:  [[0.15]]
grads:  [0.00527095]
Stock Position:  0.005270948116564157
Bond Position:  [-8.42619151]


portfolio before change:  [-7.91436587]
curr_Stock_Price:  97.50284777595817
curr_Factors:  [97.50284778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00463928]
Stock Position:  -0.004639281158665161
Bond Position:  [-7.46202274]


portfolio before change:  [-7.92394631]
curr_Stock_Price:  99.16575636440344
curr_Factors:  [99.16575636]
mat_Sqrt:  [[0.15]]
grads:  [0.02971436]
Stock Position:  0.029714361987683322
Bond Position:  [-10.87059349]


portfolio before change:  [-7.92226002]
curr_Stock_Price:  99.31397682167884
curr_Factors:  [99.31397682]
mat_Sqrt:  [[0.15]]
grads:  [-0.1034899]
Stock Position:  -0.10348990364461876
Bond Position:  [2.35573387]


portfolio before change:  [-7.88487952]
curr_Stock_Price:  98.95846873715004
curr_Factors:  [98.95846874]
mat_Sqrt:  [[0.15]]
grads:  [0.08184839]
Stock Position:  0.0818483919673256
Bond Position:  [-15.98447105]


portfolio before change:  [-7.83359568]
curr_Stock_Price:  99.63386935382971
curr_Factors:  [99.63386935]
mat_Sqrt:  [[0.15]]
grads:  [0.01849191]
Stock Position:  0.01849191347163153
Bond Position:  [-9.67601657]


portfolio before change:  [-7.84971904]
curr_Stock_Price:  98.89278564705774
curr_Factors:  [98.89278565]
mat_Sqrt:  [[0.15]]
grads:  [0.08635874]
Stock Position:  0.08635874255556657
Bond Position:  [-16.38997566]


portfolio before change:  [-7.94165714]
curr_Stock_Price:  97.87563222653016
curr_Factors:  [97.87563223]
mat_Sqrt:  [[0.15]]
grads:  [-0.1210425]
Stock Position:  -0.12104250095232937
Bond Position:  [3.90545417]


portfolio before change:  [-8.09142343]
curr_Stock_Price:  99.12100290134337
curr_Factors:  [99.1210029]
mat_Sqrt:  [[0.15]]
grads:  [0.04198897]
Stock Position:  0.04198897292081147
Bond Position:  [-12.25341254]


portfolio before change:  [-8.12098324]
curr_Stock_Price:  98.48997836573602
curr_Factors:  [98.48997837]
mat_Sqrt:  [[0.15]]
grads:  [-0.09503648]
Stock Position:  -0.09503647609056654
Bond Position:  [1.23915723]


portfolio before change:  [-8.17631153]
curr_Stock_Price:  99.07541793003259
curr_Factors:  [99.07541793]
mat_Sqrt:  [[0.15]]
grads:  [0.01504176]
Stock Position:  0.015041762700823651
Bond Position:  [-9.66658045]


portfolio before change:  [-8.1699703]
curr_Stock_Price:  99.65767477222938
curr_Factors:  [99.65767477]
mat_Sqrt:  [[0.15]]
grads:  [-0.08287884]
Stock Position:  -0.08287884390240605
Bond Position:  [0.08954257]


portfolio before change:  [-8.28244189]
curr_Stock_Price:  101.01500519322275
curr_Factors:  [101.01500519]
mat_Sqrt:  [[0.15]]
grads:  [0.04687019]
Stock Position:  0.046870189069859146
Bond Position:  [-13.01703428]


portfolio before change:  [-8.33051741]
curr_Stock_Price:  100.05872890965162
curr_Factors:  [100.05872891]
mat_Sqrt:  [[0.15]]
grads:  [0.05016759]
Stock Position:  0.050167588683006754
Bond Position:  [-13.35022256]


portfolio before change:  [-8.33092315]
curr_Stock_Price:  100.11717758448957
curr_Factors:  [100.11717758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01450661]
Stock Position:  -0.014506614365501208
Bond Position:  [-6.87856186]


portfolio before change:  [-8.33933254]
curr_Stock_Price:  100.57831417198338
curr_Factors:  [100.57831417]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.33933254]
Stock Price:  100.61243221285253
PL:  [-8.95176475]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.10689653e-03]
 [ 6.04322055e-03]
 [ 7.05844422e-04]
 [ 7.27088526e-03]
 [ 2.51771395e-02]
 [ 6.12160619e-03]
 [ 2.94887997e-02]
 [-3.07762977e-03]
 [ 1.02219506e-02]
 [-1.43074975e-02]
 [-1.00342899e-02]
 [-8.90624127e-03]
 [-2.05219347e-02]
 [ 3.68647776e-03]
 [ 2.01773545e-02]
 [ 2.55334128e-03]
 [ 7.23164278e-03]
 [-5.17526380e-03]
 [-1.13447448e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.40605447]
curr_Stock_Price:  100.56030359098752
curr_Factors:  [100.56030359]
mat_Sqrt:  [[0.15]]
grads:  [0.04071264]
Stock Position:  0.04071264352186344
Bond Position:  [6.31197868]


portfolio before change:  [10.44034735]
curr_Stock_Price:  101.36385475982438
curr_Factors:  [101.36385476]
mat_Sqrt:  [[0.15]]
grads:  [0.04028814]
Stock Position:  0.0402881370324555
Bond Position:  [6.35658648]


portfolio before change:  [10.42800875]
curr_Stock_Price:  101.01814629260356
curr_Factors:  [101.01814629]
mat_Sqrt:  [[0.15]]
grads:  [0.00470563]
Stock Position:  0.004705629478802936
Bond Position:  [9.95265478]


portfolio before change:  [10.42817048]
curr_Stock_Price:  100.52368596586729
curr_Factors:  [100.52368597]
mat_Sqrt:  [[0.15]]
grads:  [0.04847257]
Stock Position:  0.048472568410723026
Bond Position:  [5.55552923]


portfolio before change:  [10.50754471]
curr_Stock_Price:  102.13253761412135
curr_Factors:  [102.13253761]
mat_Sqrt:  [[0.15]]
grads:  [0.1678476]
Stock Position:  0.16784759638601077
Bond Position:  [-6.63515625]


portfolio before change:  [10.86033607]
curr_Stock_Price:  104.24427687620245
curr_Factors:  [104.24427688]
mat_Sqrt:  [[0.15]]
grads:  [0.04081071]
Stock Position:  0.04081070791784561
Bond Position:  [6.60605333]


portfolio before change:  [10.86739688]
curr_Stock_Price:  104.37681795173896
curr_Factors:  [104.37681795]
mat_Sqrt:  [[0.15]]
grads:  [0.196592]
Stock Position:  0.19659199823995374
Bond Position:  [-9.65225033]


portfolio before change:  [10.88043958]
curr_Stock_Price:  104.45543795974852
curr_Factors:  [104.45543796]
mat_Sqrt:  [[0.15]]
grads:  [-0.02051753]
Stock Position:  -0.02051753182234977
Bond Position:  [13.02360736]


portfolio before change:  [10.86036571]
curr_Stock_Price:  105.59252337925702
curr_Factors:  [105.59252338]
mat_Sqrt:  [[0.15]]
grads:  [0.06814634]
Stock Position:  0.06814633735742813
Bond Position:  [3.66462199]


portfolio before change:  [10.80445464]
curr_Stock_Price:  104.7586217905994
curr_Factors:  [104.75862179]
mat_Sqrt:  [[0.15]]
grads:  [-0.09538332]
Stock Position:  -0.09538331657501059
Bond Position:  [20.79667942]


portfolio before change:  [10.77921824]
curr_Stock_Price:  105.07771553302601
curr_Factors:  [105.07771553]
mat_Sqrt:  [[0.15]]
grads:  [-0.06689527]
Stock Position:  -0.06689526572920614
Bond Position:  [17.80841994]


portfolio before change:  [10.93454852]
curr_Stock_Price:  102.82228503391526
curr_Factors:  [102.82228503]
mat_Sqrt:  [[0.15]]
grads:  [-0.05937494]
Stock Position:  -0.0593749417986316
Bond Position:  [17.03961571]


portfolio before change:  [10.85088752]
curr_Stock_Price:  104.30306865987632
curr_Factors:  [104.30306866]
mat_Sqrt:  [[0.15]]
grads:  [-0.1368129]
Stock Position:  -0.13681289784261405
Bond Position:  [25.12089259]


portfolio before change:  [10.95296441]
curr_Stock_Price:  103.6028723205796
curr_Factors:  [103.60287232]
mat_Sqrt:  [[0.15]]
grads:  [0.02457652]
Stock Position:  0.024576518372830796
Bond Position:  [8.40676652]


portfolio before change:  [10.95277248]
curr_Stock_Price:  103.5095356780719
curr_Factors:  [103.50953568]
mat_Sqrt:  [[0.15]]
grads:  [0.1345157]
Stock Position:  0.13451569691221768
Bond Position:  [-2.97088485]


portfolio before change:  [10.87861631]
curr_Stock_Price:  102.96377516464138
curr_Factors:  [102.96377516]
mat_Sqrt:  [[0.15]]
grads:  [0.01702228]
Stock Position:  0.017022275186492474
Bond Position:  [9.12593859]


portfolio before change:  [10.89344493]
curr_Stock_Price:  103.70085966824311
curr_Factors:  [103.70085967]
mat_Sqrt:  [[0.15]]
grads:  [0.04821095]
Stock Position:  0.048210951833823415
Bond Position:  [5.89392778]


portfolio before change:  [10.87473998]
curr_Stock_Price:  103.28231116660703
curr_Factors:  [103.28231117]
mat_Sqrt:  [[0.15]]
grads:  [-0.03450176]
Stock Position:  -0.03450175869635875
Bond Position:  [14.43816136]


portfolio before change:  [10.86568353]
curr_Stock_Price:  103.64943563066898
curr_Factors:  [103.64943563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.86568353]
Stock Price:  102.68069368766815
PL:  [8.18498984]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.49302418e-02]
 [ 7.77504302e-03]
 [-3.81765054e-04]
 [ 1.94512971e-03]
 [ 2.46840031e-03]
 [ 3.66110869e-03]
 [ 1.68616535e-02]
 [ 1.30368791e-02]
 [ 3.76640155e-03]
 [ 9.19009276e-03]
 [-1.72491545e-02]
 [ 2.52084528e-03]
 [-2.47435315e-02]
 [ 1.09128103e-03]
 [-1.21966005e-02]
 [ 7.86275106e-03]
 [ 7.29966266e-03]
 [-1.72829517e-03]
 [-1.27919396e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.61222553]
curr_Stock_Price:  98.54801240322443
curr_Factors:  [98.5480124]
mat_Sqrt:  [[0.15]]
grads:  [0.16620161]
Stock Position:  0.16620161184424953
Bond Position:  [-36.99106404]


portfolio before change:  [-20.53340225]
curr_Stock_Price:  99.07792429310987
curr_Factors:  [99.07792429]
mat_Sqrt:  [[0.15]]
grads:  [0.05183362]
Stock Position:  0.05183362010263844
Bond Position:  [-25.66896973]


portfolio before change:  [-20.55858051]
curr_Stock_Price:  98.71599281935217
curr_Factors:  [98.71599282]
mat_Sqrt:  [[0.15]]
grads:  [-0.0025451]
Stock Position:  -0.002545100357756398
Bond Position:  [-20.3073384]


portfolio before change:  [-20.56315755]
curr_Stock_Price:  98.5193667673843
curr_Factors:  [98.51936677]
mat_Sqrt:  [[0.15]]
grads:  [0.01296753]
Stock Position:  0.012967531416722088
Bond Position:  [-21.84071053]


portfolio before change:  [-20.56409822]
curr_Stock_Price:  98.86794433695547
curr_Factors:  [98.86794434]
mat_Sqrt:  [[0.15]]
grads:  [0.016456]
Stock Position:  0.016456002033443162
Bond Position:  [-22.19106931]


portfolio before change:  [-20.55673891]
curr_Stock_Price:  99.65232470183533
curr_Factors:  [99.6523247]
mat_Sqrt:  [[0.15]]
grads:  [0.02440739]
Stock Position:  0.02440739128634981
Bond Position:  [-22.98899219]


portfolio before change:  [-20.53610057]
curr_Stock_Price:  100.73340314731281
curr_Factors:  [100.73340315]
mat_Sqrt:  [[0.15]]
grads:  [0.11241102]
Stock Position:  0.11241102347283867
Bond Position:  [-31.85964552]


portfolio before change:  [-20.58714833]
curr_Stock_Price:  100.35015026121425
curr_Factors:  [100.35015026]
mat_Sqrt:  [[0.15]]
grads:  [0.08691253]
Stock Position:  0.08691252756232613
Bond Position:  [-29.30883353]


portfolio before change:  [-20.5667868]
curr_Stock_Price:  100.66874240867854
curr_Factors:  [100.66874241]
mat_Sqrt:  [[0.15]]
grads:  [0.02510934]
Stock Position:  0.02510934369044537
Bond Position:  [-23.09451286]


portfolio before change:  [-20.58944093]
curr_Stock_Price:  99.99649177197254
curr_Factors:  [99.99649177]
mat_Sqrt:  [[0.15]]
grads:  [0.06126729]
Stock Position:  0.06126728508692591
Bond Position:  [-26.7159545]


portfolio before change:  [-20.59236753]
curr_Stock_Price:  100.05775157267512
curr_Factors:  [100.05775157]
mat_Sqrt:  [[0.15]]
grads:  [-0.11499436]
Stock Position:  -0.11499436328746337
Bond Position:  [-9.0862901]


portfolio before change:  [-20.59377433]
curr_Stock_Price:  100.05022898115263
curr_Factors:  [100.05022898]
mat_Sqrt:  [[0.15]]
grads:  [0.01680564]
Stock Position:  0.016805635209251685
Bond Position:  [-22.27518198]


portfolio before change:  [-20.60444235]
curr_Stock_Price:  99.74684719972537
curr_Factors:  [99.7468472]
mat_Sqrt:  [[0.15]]
grads:  [-0.16495688]
Stock Position:  -0.16495687688459162
Bond Position:  [-4.15051395]


portfolio before change:  [-20.40403884]
curr_Stock_Price:  98.52567192027776
curr_Factors:  [98.52567192]
mat_Sqrt:  [[0.15]]
grads:  [0.00727521]
Stock Position:  0.007275206896805385
Bond Position:  [-21.12083349]


portfolio before change:  [-20.40073639]
curr_Stock_Price:  99.70547670843392
curr_Factors:  [99.70547671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08131067]
Stock Position:  -0.08131066972660823
Bond Position:  [-12.2936173]


portfolio before change:  [-20.38887494]
curr_Stock_Price:  99.52179562888054
curr_Factors:  [99.52179563]
mat_Sqrt:  [[0.15]]
grads:  [0.05241834]
Stock Position:  0.052418340394209895
Bond Position:  [-25.6056423]


portfolio before change:  [-20.38432509]
curr_Stock_Price:  99.73073142666762
curr_Factors:  [99.73073143]
mat_Sqrt:  [[0.15]]
grads:  [0.04866442]
Stock Position:  0.0486644177441485
Bond Position:  [-25.23766306]


portfolio before change:  [-20.43812561]
curr_Stock_Price:  98.75485784062178
curr_Factors:  [98.75485784]
mat_Sqrt:  [[0.15]]
grads:  [-0.01152197]
Stock Position:  -0.01152196780894506
Bond Position:  [-19.30027532]


portfolio before change:  [-20.44512667]
curr_Stock_Price:  98.94366082083555
curr_Factors:  [98.94366082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.44512667]
Stock Price:  98.26717662990809
PL:  [-20.44512667]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.04124575e-03]
 [ 6.75519464e-03]
 [ 1.45264332e-03]
 [ 1.46803872e-02]
 [ 2.51786416e-02]
 [ 6.29313813e-03]
 [ 3.46436223e-02]
 [ 8.73983348e-03]
 [ 2.81074191e-03]
 [ 8.71053009e-03]
 [-1.84597745e-02]
 [ 5.46837482e-03]
 [-1.51511532e-02]
 [ 2.81014020e-03]
 [-1.61919186e-02]
 [ 7.58204764e-03]
 [ 4.46227389e-03]
 [-2.00520037e-03]
 [-1.28070068e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.22589743]
curr_Stock_Price:  100.02962110565991
curr_Factors:  [100.02962111]
mat_Sqrt:  [[0.15]]
grads:  [0.02027497]
Stock Position:  0.02027497164581216
Bond Position:  [0.1977997]


portfolio before change:  [2.27304893]
curr_Stock_Price:  102.35278308174453
curr_Factors:  [102.35278308]
mat_Sqrt:  [[0.15]]
grads:  [0.04503463]
Stock Position:  0.0450346309197155
Bond Position:  [-2.33637088]


portfolio before change:  [2.25793285]
curr_Stock_Price:  102.0300998645715
curr_Factors:  [102.03009986]
mat_Sqrt:  [[0.15]]
grads:  [0.00968429]
Stock Position:  0.009684288784308492
Bond Position:  [1.26984389]


portfolio before change:  [2.26126763]
curr_Stock_Price:  102.34166442129008
curr_Factors:  [102.34166442]
mat_Sqrt:  [[0.15]]
grads:  [0.09786925]
Stock Position:  0.0978692477282233
Bond Position:  [-7.75483408]


portfolio before change:  [2.23908353]
curr_Stock_Price:  102.13480534358696
curr_Factors:  [102.13480534]
mat_Sqrt:  [[0.15]]
grads:  [0.16785761]
Stock Position:  0.1678576105984644
Bond Position:  [-14.90502085]


portfolio before change:  [2.51231045]
curr_Stock_Price:  103.78473731319865
curr_Factors:  [103.78473731]
mat_Sqrt:  [[0.15]]
grads:  [0.04195425]
Stock Position:  0.04195425419965548
Bond Position:  [-1.8419008]


portfolio before change:  [2.48030373]
curr_Stock_Price:  103.03281869059538
curr_Factors:  [103.03281869]
mat_Sqrt:  [[0.15]]
grads:  [0.23095748]
Stock Position:  0.2309574823108193
Bond Position:  [-21.31589667]


portfolio before change:  [2.24172024]
curr_Stock_Price:  102.02287586458225
curr_Factors:  [102.02287586]
mat_Sqrt:  [[0.15]]
grads:  [0.05826556]
Stock Position:  0.058265556500107694
Bond Position:  [-3.7026994]


portfolio before change:  [2.10040219]
curr_Stock_Price:  99.61335176763933
curr_Factors:  [99.61335177]
mat_Sqrt:  [[0.15]]
grads:  [0.01873828]
Stock Position:  0.018738279421748577
Bond Position:  [0.23381937]


portfolio before change:  [2.11152223]
curr_Stock_Price:  100.2036714457434
curr_Factors:  [100.20367145]
mat_Sqrt:  [[0.15]]
grads:  [0.0580702]
Stock Position:  0.058070200567598824
Bond Position:  [-3.70732507]


portfolio before change:  [2.01225495]
curr_Stock_Price:  98.51019823475522
curr_Factors:  [98.51019823]
mat_Sqrt:  [[0.15]]
grads:  [-0.12306516]
Stock Position:  -0.12306516302747073
Bond Position:  [14.13542855]


portfolio before change:  [2.07264865]
curr_Stock_Price:  98.04817145630619
curr_Factors:  [98.04817146]
mat_Sqrt:  [[0.15]]
grads:  [0.03645583]
Stock Position:  0.03645583212220627
Bond Position:  [-1.50177903]


portfolio before change:  [2.09238752]
curr_Stock_Price:  98.59991750833748
curr_Factors:  [98.59991751]
mat_Sqrt:  [[0.15]]
grads:  [-0.10100769]
Stock Position:  -0.1010076878820976
Bond Position:  [12.05173721]


portfolio before change:  [2.02616569]
curr_Stock_Price:  99.28536177559944
curr_Factors:  [99.28536178]
mat_Sqrt:  [[0.15]]
grads:  [0.01873427]
Stock Position:  0.01873426802442077
Bond Position:  [0.16612711]


portfolio before change:  [2.01356288]
curr_Stock_Price:  98.6104304153597
curr_Factors:  [98.61043042]
mat_Sqrt:  [[0.15]]
grads:  [-0.10794612]
Stock Position:  -0.10794612372796185
Bond Position:  [12.6581766]


portfolio before change:  [2.07683358]
curr_Stock_Price:  98.05361787515606
curr_Factors:  [98.05361788]
mat_Sqrt:  [[0.15]]
grads:  [0.05054698]
Stock Position:  0.050546984284667924
Bond Position:  [-2.87948111]


portfolio before change:  [2.07161295]
curr_Stock_Price:  97.96457854895552
curr_Factors:  [97.96457855]
mat_Sqrt:  [[0.15]]
grads:  [0.02974849]
Stock Position:  0.029748492572662703
Bond Position:  [-0.84268559]


portfolio before change:  [2.1242335]
curr_Stock_Price:  99.74050885704297
curr_Factors:  [99.74050886]
mat_Sqrt:  [[0.15]]
grads:  [-0.013368]
Stock Position:  -0.013368002497709123
Bond Position:  [3.45756487]


portfolio before change:  [2.12079941]
curr_Stock_Price:  100.06206659854602
curr_Factors:  [100.0620666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.12079941]
Stock Price:  98.04340577502703
PL:  [2.12079941]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.79244479e-03]
 [ 8.50832782e-03]
 [-1.15241895e-03]
 [ 2.30277429e-03]
 [ 5.30024709e-04]
 [ 4.67802871e-03]
 [-4.94381456e-03]
 [ 7.34278093e-03]
 [ 4.65064131e-03]
 [-1.54146247e-02]
 [-1.73393293e-02]
 [ 1.00065935e-02]
 [ 3.64032077e-02]
 [-5.10923367e-03]
 [-1.59554183e-02]
 [ 6.12290277e-03]
 [ 1.14570025e-03]
 [-6.21488407e-03]
 [-1.09949054e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.81018642]
curr_Stock_Price:  100.00265211790851
curr_Factors:  [100.00265212]
mat_Sqrt:  [[0.15]]
grads:  [0.0186163]
Stock Position:  0.018616298609940327
Bond Position:  [-0.05149282]


portfolio before change:  [1.79518935]
curr_Stock_Price:  99.19775572355762
curr_Factors:  [99.19775572]
mat_Sqrt:  [[0.15]]
grads:  [0.05672219]
Stock Position:  0.05672218543956237
Bond Position:  [-3.83152415]


portfolio before change:  [1.7486583]
curr_Stock_Price:  98.39431268656685
curr_Factors:  [98.39431269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00768279]
Stock Position:  -0.007682792973504168
Bond Position:  [2.50460144]


portfolio before change:  [1.74675203]
curr_Stock_Price:  98.72394557783053
curr_Factors:  [98.72394558]
mat_Sqrt:  [[0.15]]
grads:  [0.01535183]
Stock Position:  0.015351828599135451
Bond Position:  [0.23115894]


portfolio before change:  [1.73767627]
curr_Stock_Price:  98.12899638675422
curr_Factors:  [98.12899639]
mat_Sqrt:  [[0.15]]
grads:  [0.0035335]
Stock Position:  0.0035334980621886474
Bond Position:  [1.39093765]


portfolio before change:  [1.74026293]
curr_Stock_Price:  98.76261365647984
curr_Factors:  [98.76261366]
mat_Sqrt:  [[0.15]]
grads:  [0.03118686]
Stock Position:  0.031186858073143413
Bond Position:  [-1.33983268]


portfolio before change:  [1.68863774]
curr_Stock_Price:  97.11800441976969
curr_Factors:  [97.11800442]
mat_Sqrt:  [[0.15]]
grads:  [-0.03295876]
Stock Position:  -0.03295876373400374
Bond Position:  [4.8895271]


portfolio before change:  [1.68844905]
curr_Stock_Price:  97.16082219329427
curr_Factors:  [97.16082219]
mat_Sqrt:  [[0.15]]
grads:  [0.04895187]
Stock Position:  0.04895187288003959
Bond Position:  [-3.06775516]


portfolio before change:  [1.67112302]
curr_Stock_Price:  96.82255118471487
curr_Factors:  [96.82255118]
mat_Sqrt:  [[0.15]]
grads:  [0.03100428]
Stock Position:  0.031004275402267134
Bond Position:  [-1.33079002]


portfolio before change:  [1.61647326]
curr_Stock_Price:  95.07063089468319
curr_Factors:  [95.07063089]
mat_Sqrt:  [[0.15]]
grads:  [-0.10276416]
Stock Position:  -0.10276416454828048
Bond Position:  [11.38632722]


portfolio before change:  [1.73715219]
curr_Stock_Price:  93.92400558775496
curr_Factors:  [93.92400559]
mat_Sqrt:  [[0.15]]
grads:  [-0.11559553]
Stock Position:  -0.11559552866893165
Bond Position:  [12.59434727]


portfolio before change:  [1.73950322]
curr_Stock_Price:  93.93090853363621
curr_Factors:  [93.93090853]
mat_Sqrt:  [[0.15]]
grads:  [0.06671062]
Stock Position:  0.06671062363996293
Bond Position:  [-4.52668627]


portfolio before change:  [1.63591403]
curr_Stock_Price:  92.39506051722753
curr_Factors:  [92.39506052]
mat_Sqrt:  [[0.15]]
grads:  [0.24268805]
Stock Position:  0.24268805109232017
Bond Position:  [-20.78726314]


portfolio before change:  [1.81908331]
curr_Stock_Price:  93.17122870782714
curr_Factors:  [93.17122871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03406156]
Stock Position:  -0.03406155777768208
Bond Position:  [4.9926405]


portfolio before change:  [1.80535877]
curr_Stock_Price:  93.61081077636031
curr_Factors:  [93.61081078]
mat_Sqrt:  [[0.15]]
grads:  [-0.10636946]
Stock Position:  -0.10636945519305849
Bond Position:  [11.76268972]


portfolio before change:  [1.82120277]
curr_Stock_Price:  93.48950754535154
curr_Factors:  [93.48950755]
mat_Sqrt:  [[0.15]]
grads:  [0.04081935]
Stock Position:  0.04081935179718455
Bond Position:  [-1.99497832]


portfolio before change:  [1.74974028]
curr_Stock_Price:  91.75102605068652
curr_Factors:  [91.75102605]
mat_Sqrt:  [[0.15]]
grads:  [0.007638]
Stock Position:  0.007638001644067356
Bond Position:  [1.04894579]


portfolio before change:  [1.7522808]
curr_Stock_Price:  92.04930424528479
curr_Factors:  [92.04930425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143256]
Stock Position:  -0.04143256049552946
Bond Position:  [5.56611916]


portfolio before change:  [1.752747]
curr_Stock_Price:  92.07164187673955
curr_Factors:  [92.07164188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.752747]
Stock Price:  92.10467789121293
PL:  [1.752747]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.42999722e-02]
 [ 7.46966276e-03]
 [ 1.58486529e-03]
 [ 1.38094369e-02]
 [ 2.53589893e-02]
 [ 6.15015026e-03]
 [ 3.00782325e-02]
 [-6.74794565e-03]
 [ 1.01772169e-02]
 [-2.79445374e-02]
 [-7.44043937e-03]
 [-4.17273927e-02]
 [-9.80454766e-03]
 [ 1.17126042e-02]
 [ 5.93116342e-02]
 [-1.24445450e-03]
 [ 5.41631729e-03]
 [-6.24764707e-03]
 [-8.91343178e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.54101048]
curr_Stock_Price:  101.34755114457941
curr_Factors:  [101.34755114]
mat_Sqrt:  [[0.15]]
grads:  [0.09533315]
Stock Position:  0.09533314776658712
Bond Position:  [12.87922942]


portfolio before change:  [22.737415]
curr_Stock_Price:  103.37396388366732
curr_Factors:  [103.37396388]
mat_Sqrt:  [[0.15]]
grads:  [0.04979775]
Stock Position:  0.04979775176171376
Bond Position:  [17.58962401]


portfolio before change:  [22.69189934]
curr_Stock_Price:  102.37163726247219
curr_Factors:  [102.37163726]
mat_Sqrt:  [[0.15]]
grads:  [0.01056577]
Stock Position:  0.010565768573149769
Bond Position:  [21.61026432]


portfolio before change:  [22.68802597]
curr_Stock_Price:  101.4936496333309
curr_Factors:  [101.49364963]
mat_Sqrt:  [[0.15]]
grads:  [0.09206291]
Stock Position:  0.09206291262480962
Bond Position:  [13.34422497]


portfolio before change:  [22.78506796]
curr_Stock_Price:  102.51149183789552
curr_Factors:  [102.51149184]
mat_Sqrt:  [[0.15]]
grads:  [0.16905993]
Stock Position:  0.16905992839259354
Bond Position:  [5.45448249]


portfolio before change:  [23.06644817]
curr_Stock_Price:  104.16780639868978
curr_Factors:  [104.1678064]
mat_Sqrt:  [[0.15]]
grads:  [0.041001]
Stock Position:  0.041001001719006475
Bond Position:  [18.79546376]


portfolio before change:  [23.07247675]
curr_Stock_Price:  104.20022318971394
curr_Factors:  [104.20022319]
mat_Sqrt:  [[0.15]]
grads:  [0.20052155]
Stock Position:  0.20052154969350244
Bond Position:  [2.17808652]


portfolio before change:  [23.28120545]
curr_Stock_Price:  105.23843634316661
curr_Factors:  [105.23843634]
mat_Sqrt:  [[0.15]]
grads:  [-0.0449863]
Stock Position:  -0.044986304307792886
Bond Position:  [28.01549377]


portfolio before change:  [23.27464724]
curr_Stock_Price:  105.53992716441986
curr_Factors:  [105.53992716]
mat_Sqrt:  [[0.15]]
grads:  [0.06784811]
Stock Position:  0.06784811238964454
Bond Position:  [16.1139624]


portfolio before change:  [23.33994295]
curr_Stock_Price:  106.44292525237995
curr_Factors:  [106.44292525]
mat_Sqrt:  [[0.15]]
grads:  [-0.18629692]
Stock Position:  -0.1862969157642702
Bond Position:  [43.16993163]


portfolio before change:  [23.29879457]
curr_Stock_Price:  106.72173935001967
curr_Factors:  [106.72173935]
mat_Sqrt:  [[0.15]]
grads:  [-0.04960293]
Stock Position:  -0.04960292914157142
Bond Position:  [28.59250545]


portfolio before change:  [23.2134613]
curr_Stock_Price:  108.58619160749953
curr_Factors:  [108.58619161]
mat_Sqrt:  [[0.15]]
grads:  [-0.27818262]
Stock Position:  -0.2781826183285167
Bond Position:  [53.4202524]


portfolio before change:  [22.29529101]
curr_Stock_Price:  111.93480854414139
curr_Factors:  [111.93480854]
mat_Sqrt:  [[0.15]]
grads:  [-0.06536365]
Stock Position:  -0.06536365109334306
Bond Position:  [29.61175878]


portfolio before change:  [22.41155301]
curr_Stock_Price:  110.26938534982195
curr_Factors:  [110.26938535]
mat_Sqrt:  [[0.15]]
grads:  [0.07808403]
Stock Position:  0.07808402811448138
Bond Position:  [13.80127523]


portfolio before change:  [22.31529617]
curr_Stock_Price:  108.99245851991303
curr_Factors:  [108.99245852]
mat_Sqrt:  [[0.15]]
grads:  [0.39541089]
Stock Position:  0.39541089485706105
Bond Position:  [-20.78150938]


portfolio before change:  [21.75161969]
curr_Stock_Price:  107.58005318086738
curr_Factors:  [107.58005318]
mat_Sqrt:  [[0.15]]
grads:  [-0.00829636]
Stock Position:  -0.008296363304912357
Bond Position:  [22.64414289]


portfolio before change:  [21.74386105]
curr_Stock_Price:  109.19767578129475
curr_Factors:  [109.19767578]
mat_Sqrt:  [[0.15]]
grads:  [0.03610878]
Stock Position:  0.036108781902766146
Bond Position:  [17.80086599]


portfolio before change:  [21.74523308]
curr_Stock_Price:  109.11241282891841
curr_Factors:  [109.11241283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04165098]
Stock Position:  -0.0416509804469967
Bond Position:  [26.28987205]


portfolio before change:  [21.72864095]
curr_Stock_Price:  109.66859230492408
curr_Factors:  [109.6685923]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.72864095]
Stock Price:  110.70822186292895
PL:  [11.02041908]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.85846568e-02]
 [ 9.87992776e-03]
 [-5.01360381e-04]
 [ 2.36049240e-03]
 [-2.81066433e-04]
 [ 4.60767254e-03]
 [ 1.11380538e-02]
 [ 1.32851354e-02]
 [ 2.83701848e-03]
 [ 8.24068253e-03]
 [-1.67131619e-02]
 [-8.66361202e-03]
 [-2.41493219e-02]
 [ 2.38674310e-03]
 [ 7.74844011e-03]
 [ 7.66035945e-03]
 [ 7.48786678e-03]
 [-4.85424707e-03]
 [-1.19114088e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.71522608]
curr_Stock_Price:  98.86570212833384
curr_Factors:  [98.86570213]
mat_Sqrt:  [[0.15]]
grads:  [0.12389771]
Stock Position:  0.1238977123095004
Bond Position:  [-27.9644604]


portfolio before change:  [-15.64791675]
curr_Stock_Price:  99.46540102892885
curr_Factors:  [99.46540103]
mat_Sqrt:  [[0.15]]
grads:  [0.06586619]
Stock Position:  0.0658661850497125
Bond Position:  [-22.19932326]


portfolio before change:  [-15.70572372]
curr_Stock_Price:  98.67202811049289
curr_Factors:  [98.67202811]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033424]
Stock Position:  -0.0033424025380519163
Bond Position:  [-15.37592208]


portfolio before change:  [-15.70985206]
curr_Stock_Price:  98.75696132417059
curr_Factors:  [98.75696132]
mat_Sqrt:  [[0.15]]
grads:  [0.01573662]
Stock Position:  0.015736616010901608
Bond Position:  [-17.26395244]


portfolio before change:  [-15.73098456]
curr_Stock_Price:  97.68837226235733
curr_Factors:  [97.68837226]
mat_Sqrt:  [[0.15]]
grads:  [-0.00187378]
Stock Position:  -0.001873776219507266
Bond Position:  [-15.54793842]


portfolio before change:  [-15.73712033]
curr_Stock_Price:  98.88824696742881
curr_Factors:  [98.88824697]
mat_Sqrt:  [[0.15]]
grads:  [0.03071782]
Stock Position:  0.03071781690251838
Bond Position:  [-18.7747514]


portfolio before change:  [-15.68997681]
curr_Stock_Price:  100.57579529053749
curr_Factors:  [100.57579529]
mat_Sqrt:  [[0.15]]
grads:  [0.07425369]
Stock Position:  0.07425369224937903
Bond Position:  [-23.15810096]


portfolio before change:  [-15.6704248]
curr_Stock_Price:  100.91708809526406
curr_Factors:  [100.9170881]
mat_Sqrt:  [[0.15]]
grads:  [0.08856757]
Stock Position:  0.08856756927285504
Bond Position:  [-24.608406]


portfolio before change:  [-15.79332627]
curr_Stock_Price:  99.5989013182765
curr_Factors:  [99.59890132]
mat_Sqrt:  [[0.15]]
grads:  [0.01891346]
Stock Position:  0.01891345653921848
Bond Position:  [-17.67708577]


portfolio before change:  [-15.78089294]
curr_Stock_Price:  100.48996822946232
curr_Factors:  [100.48996823]
mat_Sqrt:  [[0.15]]
grads:  [0.05493788]
Stock Position:  0.054937883510805335
Bond Position:  [-21.30159911]


portfolio before change:  [-15.78127894]
curr_Stock_Price:  100.57988913059462
curr_Factors:  [100.57988913]
mat_Sqrt:  [[0.15]]
grads:  [-0.11142108]
Stock Position:  -0.11142107909189589
Bond Position:  [-4.57455916]


portfolio before change:  [-15.8804343]
curr_Stock_Price:  101.45953933986675
curr_Factors:  [101.45953934]
mat_Sqrt:  [[0.15]]
grads:  [-0.05775741]
Stock Position:  -0.0577574134761845
Bond Position:  [-10.02039374]


portfolio before change:  [-15.88371584]
curr_Stock_Price:  101.47297697581904
curr_Factors:  [101.47297698]
mat_Sqrt:  [[0.15]]
grads:  [-0.16099548]
Stock Position:  -0.16099547930085645
Bond Position:  [0.45297473]


portfolio before change:  [-15.98653744]
curr_Stock_Price:  102.11234188535623
curr_Factors:  [102.11234189]
mat_Sqrt:  [[0.15]]
grads:  [0.01591162]
Stock Position:  0.01591162068647577
Bond Position:  [-17.61131029]


portfolio before change:  [-15.98844999]
curr_Stock_Price:  102.26888295438748
curr_Factors:  [102.26888295]
mat_Sqrt:  [[0.15]]
grads:  [0.05165627]
Stock Position:  0.05165626741280167
Bond Position:  [-21.27127876]


portfolio before change:  [-16.0764484]
curr_Stock_Price:  100.66830427424854
curr_Factors:  [100.66830427]
mat_Sqrt:  [[0.15]]
grads:  [0.05106906]
Stock Position:  0.05106906300182911
Bond Position:  [-21.21748437]


portfolio before change:  [-16.00341494]
curr_Stock_Price:  102.20227595678702
curr_Factors:  [102.20227596]
mat_Sqrt:  [[0.15]]
grads:  [0.04991911]
Stock Position:  0.049919111834125965
Bond Position:  [-21.10526178]


portfolio before change:  [-15.98119816]
curr_Stock_Price:  102.75304201603028
curr_Factors:  [102.75304202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03236165]
Stock Position:  -0.03236164711822798
Bond Position:  [-12.65594047]


portfolio before change:  [-15.97017163]
curr_Stock_Price:  102.31453179372501
curr_Factors:  [102.31453179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.97017163]
Stock Price:  102.99156036700707
PL:  [-18.96173199]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.21665250e-03]
 [ 6.74520188e-03]
 [ 7.19122791e-04]
 [-2.73494368e-04]
 [-1.98999269e-04]
 [ 5.84818605e-04]
 [-3.33020677e-03]
 [ 3.66714723e-03]
 [ 4.60041047e-03]
 [-4.70171116e-03]
 [-1.80421456e-02]
 [ 5.29291699e-03]
 [-8.43683053e-03]
 [ 8.15722692e-04]
 [-1.56368083e-02]
 [ 7.34618165e-03]
 [ 5.13972279e-03]
 [-1.87388826e-03]
 [-1.26683365e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.14131706]
curr_Stock_Price:  99.48680338730455
curr_Factors:  [99.48680339]
mat_Sqrt:  [[0.15]]
grads:  [0.03477768]
Stock Position:  0.03477768335645733
Bond Position:  [-9.6012376]


portfolio before change:  [-6.10215505]
curr_Stock_Price:  100.68189776044466
curr_Factors:  [100.68189776]
mat_Sqrt:  [[0.15]]
grads:  [0.04496801]
Stock Position:  0.04496801254954552
Bond Position:  [-10.62961989]


portfolio before change:  [-6.17573849]
curr_Stock_Price:  99.10464997754704
curr_Factors:  [99.10464998]
mat_Sqrt:  [[0.15]]
grads:  [0.00479415]
Stock Position:  0.004794151941774106
Bond Position:  [-6.65086124]


portfolio before change:  [-6.18629156]
curr_Stock_Price:  97.25027587661272
curr_Factors:  [97.25027588]
mat_Sqrt:  [[0.15]]
grads:  [-0.0018233]
Stock Position:  -0.0018232957881709456
Bond Position:  [-6.00897554]


portfolio before change:  [-6.18865969]
curr_Stock_Price:  97.72507554998614
curr_Factors:  [97.72507555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132666]
Stock Position:  -0.0013266617916983584
Bond Position:  [-6.05901157]


portfolio before change:  [-6.18881109]
curr_Stock_Price:  96.69727532984034
curr_Factors:  [96.69727533]
mat_Sqrt:  [[0.15]]
grads:  [0.00389879]
Stock Position:  0.00389879069942732
Bond Position:  [-6.56581353]


portfolio before change:  [-6.19124758]
curr_Stock_Price:  96.49340966974074
curr_Factors:  [96.49340967]
mat_Sqrt:  [[0.15]]
grads:  [-0.02220138]
Stock Position:  -0.022201378438560793
Bond Position:  [-4.04896088]


portfolio before change:  [-6.18596701]
curr_Stock_Price:  96.20996168862936
curr_Factors:  [96.20996169]
mat_Sqrt:  [[0.15]]
grads:  [0.02444765]
Stock Position:  0.02444764821838915
Bond Position:  [-8.53807431]


portfolio before change:  [-6.19169521]
curr_Stock_Price:  96.06297782953196
curr_Factors:  [96.06297783]
mat_Sqrt:  [[0.15]]
grads:  [0.0306694]
Stock Position:  0.03066940312155865
Bond Position:  [-9.1378894]


portfolio before change:  [-6.17998237]
curr_Stock_Price:  96.51938053431212
curr_Factors:  [96.51938053]
mat_Sqrt:  [[0.15]]
grads:  [-0.03134474]
Stock Position:  -0.03134474107571819
Bond Position:  [-3.15460737]


portfolio before change:  [-6.21391304]
curr_Stock_Price:  97.5767165292997
curr_Factors:  [97.57671653]
mat_Sqrt:  [[0.15]]
grads:  [-0.12028097]
Stock Position:  -0.12028097085841467
Bond Position:  [5.52270916]


portfolio before change:  [-6.18377589]
curr_Stock_Price:  97.33764050446445
curr_Factors:  [97.3376405]
mat_Sqrt:  [[0.15]]
grads:  [0.03528611]
Stock Position:  0.035286113246393906
Bond Position:  [-9.6184429]


portfolio before change:  [-6.17061324]
curr_Stock_Price:  97.77882153568184
curr_Factors:  [97.77882154]
mat_Sqrt:  [[0.15]]
grads:  [-0.05624554]
Stock Position:  -0.05624553686023072
Bond Position:  [-0.67099093]


portfolio before change:  [-6.20534485]
curr_Stock_Price:  98.39333859241425
curr_Factors:  [98.39333859]
mat_Sqrt:  [[0.15]]
grads:  [0.00543815]
Stock Position:  0.005438151281473838
Bond Position:  [-6.74042271]


portfolio before change:  [-6.20411682]
curr_Stock_Price:  98.92906219756254
curr_Factors:  [98.9290622]
mat_Sqrt:  [[0.15]]
grads:  [-0.10424539]
Stock Position:  -0.10424538889265425
Bond Position:  [4.10878174]


portfolio before change:  [-6.07506471]
curr_Stock_Price:  97.70095238600136
curr_Factors:  [97.70095239]
mat_Sqrt:  [[0.15]]
grads:  [0.04897454]
Stock Position:  0.04897454434084888
Bond Position:  [-10.85992434]


portfolio before change:  [-6.01518014]
curr_Stock_Price:  98.97916524229665
curr_Factors:  [98.97916524]
mat_Sqrt:  [[0.15]]
grads:  [0.03426482]
Stock Position:  0.0342648186114371
Bond Position:  [-9.40668328]


portfolio before change:  [-6.04174439]
curr_Stock_Price:  98.2725429918693
curr_Factors:  [98.27254299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01249259]
Stock Position:  -0.012492588368970877
Bond Position:  [-4.81406596]


portfolio before change:  [-6.02992027]
curr_Stock_Price:  97.22970189512456
curr_Factors:  [97.2297019]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.02992027]
Stock Price:  97.55941701478598
PL:  [-6.02992027]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.92997475e-02]
 [ 1.06429941e-03]
 [ 3.82256265e-04]
 [ 6.58883613e-04]
 [ 5.85863406e-05]
 [ 2.84571682e-03]
 [-3.02524657e-04]
 [ 1.78805540e-03]
 [ 4.63012452e-03]
 [-1.06552601e-02]
 [-1.75877337e-02]
 [ 6.16488010e-03]
 [ 5.14638458e-03]
 [-2.26678588e-03]
 [-1.70950372e-02]
 [ 7.18611485e-03]
 [ 3.50229112e-03]
 [-2.88794524e-03]
 [-1.26462287e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.9842499]
curr_Stock_Price:  98.32925446688327
curr_Factors:  [98.32925447]
mat_Sqrt:  [[0.15]]
grads:  [0.19533165]
Stock Position:  0.19533164983404555
Bond Position:  [-43.19106541]


portfolio before change:  [-24.11523639]
curr_Stock_Price:  97.713955459437
curr_Factors:  [97.71395546]
mat_Sqrt:  [[0.15]]
grads:  [0.00709533]
Stock Position:  0.007095329392016823
Bond Position:  [-24.80854909]


portfolio before change:  [-24.11233805]
curr_Stock_Price:  98.99666630205562
curr_Factors:  [98.9966663]
mat_Sqrt:  [[0.15]]
grads:  [0.00254838]
Stock Position:  0.0025483751016199233
Bond Position:  [-24.36461869]


portfolio before change:  [-24.12152128]
curr_Stock_Price:  97.78361201606906
curr_Factors:  [97.78361202]
mat_Sqrt:  [[0.15]]
grads:  [0.00439256]
Stock Position:  0.004392557416817017
Bond Position:  [-24.55104141]


portfolio before change:  [-24.1274109]
curr_Stock_Price:  97.84027678552148
curr_Factors:  [97.84027679]
mat_Sqrt:  [[0.15]]
grads:  [0.00039058]
Stock Position:  0.00039057560404177097
Bond Position:  [-24.16562493]


portfolio before change:  [-24.1335715]
curr_Stock_Price:  97.53704690582505
curr_Factors:  [97.53704691]
mat_Sqrt:  [[0.15]]
grads:  [0.01897145]
Stock Position:  0.018971445453006577
Bond Position:  [-25.98399027]


portfolio before change:  [-24.17682983]
curr_Stock_Price:  95.59931793124531
curr_Factors:  [95.59931793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00201683]
Stock Position:  -0.0020168310465942347
Bond Position:  [-23.98402216]


portfolio before change:  [-24.18314716]
curr_Stock_Price:  95.75826935718686
curr_Factors:  [95.75826936]
mat_Sqrt:  [[0.15]]
grads:  [0.01192037]
Stock Position:  0.01192036930906659
Bond Position:  [-25.3246211]


portfolio before change:  [-24.18049074]
curr_Stock_Price:  96.512303437707
curr_Factors:  [96.51230344]
mat_Sqrt:  [[0.15]]
grads:  [0.0308675]
Stock Position:  0.030867496814766266
Bond Position:  [-27.15958396]


portfolio before change:  [-24.21191514]
curr_Stock_Price:  95.71425858446882
curr_Factors:  [95.71425858]
mat_Sqrt:  [[0.15]]
grads:  [-0.07103507]
Stock Position:  -0.07103506707134133
Bond Position:  [-17.41284636]


portfolio before change:  [-24.20920204]
curr_Stock_Price:  95.6147746311672
curr_Factors:  [95.61477463]
mat_Sqrt:  [[0.15]]
grads:  [-0.11725156]
Stock Position:  -0.11725155809912755
Bond Position:  [-12.99822074]


portfolio before change:  [-24.33306093]
curr_Stock_Price:  96.6434085226449
curr_Factors:  [96.64340852]
mat_Sqrt:  [[0.15]]
grads:  [0.0410992]
Stock Position:  0.04109920064357006
Bond Position:  [-28.30502777]


portfolio before change:  [-24.3566258]
curr_Stock_Price:  96.242239367161
curr_Factors:  [96.24223937]
mat_Sqrt:  [[0.15]]
grads:  [0.03430923]
Stock Position:  0.03430923050835623
Bond Position:  [-27.65862298]


portfolio before change:  [-24.36245167]
curr_Stock_Price:  96.27399911780698
curr_Factors:  [96.27399912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01511191]
Stock Position:  -0.015111905836627786
Bond Position:  [-22.90756806]


portfolio before change:  [-24.38352001]
curr_Stock_Price:  97.28914137270257
curr_Factors:  [97.28914137]
mat_Sqrt:  [[0.15]]
grads:  [-0.11396691]
Stock Position:  -0.11396691486948016
Bond Position:  [-13.29577672]


portfolio before change:  [-24.32805426]
curr_Stock_Price:  96.77328890449127
curr_Factors:  [96.7732889]
mat_Sqrt:  [[0.15]]
grads:  [0.04790743]
Stock Position:  0.047907432363069005
Bond Position:  [-28.96421405]


portfolio before change:  [-24.36786055]
curr_Stock_Price:  96.09355436639625
curr_Factors:  [96.09355437]
mat_Sqrt:  [[0.15]]
grads:  [0.02334861]
Stock Position:  0.02334860747100025
Bond Position:  [-26.61151124]


portfolio before change:  [-24.37335196]
curr_Stock_Price:  96.14333486050188
curr_Factors:  [96.14333486]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925297]
Stock Position:  -0.01925296828151111
Bond Position:  [-22.52230738]


portfolio before change:  [-24.39295622]
curr_Stock_Price:  96.86909219183376
curr_Factors:  [96.86909219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.39295622]
Stock Price:  96.70788109178861
PL:  [-24.39295622]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.01165751e-02]
 [-6.08783983e-04]
 [-3.63418619e-03]
 [-2.09896959e-03]
 [-2.96540751e-03]
 [-1.61409751e-03]
 [-7.03007404e-03]
 [ 9.48071975e-03]
 [ 4.25325635e-03]
 [ 1.29884417e-02]
 [-1.85530927e-02]
 [ 5.34059710e-03]
 [-2.47012265e-03]
 [-1.55387479e-03]
 [-1.71986563e-02]
 [ 7.01586154e-03]
 [ 4.23859024e-03]
 [-1.75384401e-03]
 [-1.27867916e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.61461017]
curr_Stock_Price:  98.28836024525212
curr_Factors:  [98.28836025]
mat_Sqrt:  [[0.15]]
grads:  [0.20077717]
Stock Position:  0.20077716760406816
Bond Position:  [-44.34866875]


portfolio before change:  [-24.82156308]
curr_Stock_Price:  97.3128292369863
curr_Factors:  [97.31282924]
mat_Sqrt:  [[0.15]]
grads:  [-0.00405856]
Stock Position:  -0.004058559885126145
Bond Position:  [-24.42661313]


portfolio before change:  [-24.8256921]
curr_Stock_Price:  96.8253655377194
curr_Factors:  [96.82536554]
mat_Sqrt:  [[0.15]]
grads:  [-0.02422791]
Stock Position:  -0.024227907916376617
Bond Position:  [-22.47981606]


portfolio before change:  [-24.81630859]
curr_Stock_Price:  96.2060728528232
curr_Factors:  [96.20607285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01399313]
Stock Position:  -0.013993130591970656
Bond Position:  [-23.47008445]


portfolio before change:  [-24.82954617]
curr_Stock_Price:  96.73271219004485
curr_Factors:  [96.73271219]
mat_Sqrt:  [[0.15]]
grads:  [-0.01976938]
Stock Position:  -0.019769383423429102
Bond Position:  [-22.9172001]


portfolio before change:  [-24.81842899]
curr_Stock_Price:  95.88052593418304
curr_Factors:  [95.88052593]
mat_Sqrt:  [[0.15]]
grads:  [-0.01076065]
Stock Position:  -0.01076065004968543
Bond Position:  [-23.78669221]


portfolio before change:  [-24.84638223]
curr_Stock_Price:  97.92555302189405
curr_Factors:  [97.92555302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04686716]
Stock Position:  -0.046867160270233264
Bond Position:  [-20.25688964]


portfolio before change:  [-24.8548209]
curr_Stock_Price:  97.99753981026059
curr_Factors:  [97.99753981]
mat_Sqrt:  [[0.15]]
grads:  [0.0632048]
Stock Position:  0.06320479830616552
Bond Position:  [-31.04873564]


portfolio before change:  [-24.81310419]
curr_Stock_Price:  98.78038973476701
curr_Factors:  [98.78038973]
mat_Sqrt:  [[0.15]]
grads:  [0.02835504]
Stock Position:  0.028355042327156486
Bond Position:  [-27.61402632]


portfolio before change:  [-24.81626323]
curr_Stock_Price:  98.91247632190984
curr_Factors:  [98.91247632]
mat_Sqrt:  [[0.15]]
grads:  [0.08658961]
Stock Position:  0.08658961121571357
Bond Position:  [-33.3810561]


portfolio before change:  [-24.82092762]
curr_Stock_Price:  98.95499783886802
curr_Factors:  [98.95499784]
mat_Sqrt:  [[0.15]]
grads:  [-0.12368728]
Stock Position:  -0.12368728436949464
Bond Position:  [-12.58145266]


portfolio before change:  [-24.61814164]
curr_Stock_Price:  97.29005918423795
curr_Factors:  [97.29005918]
mat_Sqrt:  [[0.15]]
grads:  [0.03560398]
Stock Position:  0.035603980637591605
Bond Position:  [-28.08205502]


portfolio before change:  [-24.63002386]
curr_Stock_Price:  97.15353417146598
curr_Factors:  [97.15353417]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646748]
Stock Position:  -0.01646748433695673
Bond Position:  [-23.03014956]


portfolio before change:  [-24.63312719]
curr_Stock_Price:  96.99231172329561
curr_Factors:  [96.99231172]
mat_Sqrt:  [[0.15]]
grads:  [-0.01035917]
Stock Position:  -0.010359165282612904
Bond Position:  [-23.6283678]


portfolio before change:  [-24.64468213]
curr_Stock_Price:  97.53744387095672
curr_Factors:  [97.53744387]
mat_Sqrt:  [[0.15]]
grads:  [-0.11465771]
Stock Position:  -0.11465770896338329
Bond Position:  [-13.46126228]


portfolio before change:  [-24.53775875]
curr_Stock_Price:  96.57554503768475
curr_Factors:  [96.57554504]
mat_Sqrt:  [[0.15]]
grads:  [0.04677241]
Stock Position:  0.046772410276439025
Bond Position:  [-29.05482977]


portfolio before change:  [-24.50410688]
curr_Stock_Price:  97.45034471554085
curr_Factors:  [97.45034472]
mat_Sqrt:  [[0.15]]
grads:  [0.02825727]
Stock Position:  0.028257268236223956
Bond Position:  [-27.25778741]


portfolio before change:  [-24.46245557]
curr_Stock_Price:  99.1655357364106
curr_Factors:  [99.16553574]
mat_Sqrt:  [[0.15]]
grads:  [-0.01169229]
Stock Position:  -0.011692293374057075
Bond Position:  [-23.30298303]


portfolio before change:  [-24.46521019]
curr_Stock_Price:  98.90281130411118
curr_Factors:  [98.9028113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.46521019]
Stock Price:  99.26007890186231
PL:  [-24.46521019]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.92907542e-03]
 [ 1.84304874e-03]
 [-3.45271768e-04]
 [-8.53053057e-04]
 [ 3.05285655e-03]
 [ 4.49696332e-03]
 [ 2.34670977e-02]
 [ 9.20370147e-03]
 [ 6.73026637e-03]
 [ 8.45317748e-03]
 [-1.85376647e-02]
 [ 6.25014948e-03]
 [-2.60370650e-02]
 [ 2.80956619e-03]
 [ 2.11969124e-02]
 [ 2.78680226e-03]
 [ 7.16111449e-03]
 [-4.07406870e-03]
 [-1.20307097e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.65917443]
curr_Stock_Price:  99.45320771954312
curr_Factors:  [99.45320772]
mat_Sqrt:  [[0.15]]
grads:  [0.03952717]
Stock Position:  0.039527169469772146
Bond Position:  [-10.59027823]


portfolio before change:  [-6.72322526]
curr_Stock_Price:  97.89977175108697
curr_Factors:  [97.89977175]
mat_Sqrt:  [[0.15]]
grads:  [0.01228699]
Stock Position:  0.01228699160128922
Bond Position:  [-7.92611893]


portfolio before change:  [-6.7150133]
curr_Stock_Price:  98.72940819854045
curr_Factors:  [98.7294082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230181]
Stock Position:  -0.0023018117894061806
Bond Position:  [-6.48775678]


portfolio before change:  [-6.71246767]
curr_Stock_Price:  96.91875840173836
curr_Factors:  [96.9187584]
mat_Sqrt:  [[0.15]]
grads:  [-0.00568702]
Stock Position:  -0.00568702038183515
Bond Position:  [-6.16128871]


portfolio before change:  [-6.7262914]
curr_Stock_Price:  99.07862709285953
curr_Factors:  [99.07862709]
mat_Sqrt:  [[0.15]]
grads:  [0.02035238]
Stock Position:  0.020352377011349627
Bond Position:  [-8.74277697]


portfolio before change:  [-6.69183358]
curr_Stock_Price:  100.8790942763754
curr_Factors:  [100.87909428]
mat_Sqrt:  [[0.15]]
grads:  [0.02997976]
Stock Position:  0.029979755479406223
Bond Position:  [-9.71616416]


portfolio before change:  [-6.68933015]
curr_Stock_Price:  101.04363097583051
curr_Factors:  [101.04363098]
mat_Sqrt:  [[0.15]]
grads:  [0.15644732]
Stock Position:  0.1564473176878485
Bond Position:  [-22.49733519]


portfolio before change:  [-6.55348413]
curr_Stock_Price:  101.94790382966943
curr_Factors:  [101.94790383]
mat_Sqrt:  [[0.15]]
grads:  [0.06135801]
Stock Position:  0.061358009788363935
Bond Position:  [-12.80880461]


portfolio before change:  [-6.54067194]
curr_Stock_Price:  102.20890956501924
curr_Factors:  [102.20890957]
mat_Sqrt:  [[0.15]]
grads:  [0.04486844]
Stock Position:  0.044868442473668
Bond Position:  [-11.12662651]


portfolio before change:  [-6.61164327]
curr_Stock_Price:  100.68914809450273
curr_Factors:  [100.68914809]
mat_Sqrt:  [[0.15]]
grads:  [0.05635452]
Stock Position:  0.05635451651842263
Bond Position:  [-12.28593153]


portfolio before change:  [-6.72258081]
curr_Stock_Price:  98.77509257789384
curr_Factors:  [98.77509258]
mat_Sqrt:  [[0.15]]
grads:  [-0.12358443]
Stock Position:  -0.12358443158495061
Bond Position:  [5.48448286]


portfolio before change:  [-6.76883708]
curr_Stock_Price:  99.16047740040679
curr_Factors:  [99.1604774]
mat_Sqrt:  [[0.15]]
grads:  [0.04166766]
Stock Position:  0.04166766316708623
Bond Position:  [-10.90062245]


portfolio before change:  [-6.72171409]
curr_Stock_Price:  100.35681257787317
curr_Factors:  [100.35681258]
mat_Sqrt:  [[0.15]]
grads:  [-0.17358043]
Stock Position:  -0.17358043305330007
Bond Position:  [10.6982649]


portfolio before change:  [-7.10793245]
curr_Stock_Price:  102.5972336867299
curr_Factors:  [102.59723369]
mat_Sqrt:  [[0.15]]
grads:  [0.01873044]
Stock Position:  0.018730441254353292
Bond Position:  [-9.02962391]


portfolio before change:  [-7.09041961]
curr_Stock_Price:  103.65276291916406
curr_Factors:  [103.65276292]
mat_Sqrt:  [[0.15]]
grads:  [0.14131275]
Stock Position:  0.1413127491652989
Bond Position:  [-21.7378765]


portfolio before change:  [-7.2199675]
curr_Stock_Price:  102.77447883141913
curr_Factors:  [102.77447883]
mat_Sqrt:  [[0.15]]
grads:  [0.01857868]
Stock Position:  0.01857868172783713
Bond Position:  [-9.12938183]


portfolio before change:  [-7.20107153]
curr_Stock_Price:  103.91441972863488
curr_Factors:  [103.91441973]
mat_Sqrt:  [[0.15]]
grads:  [0.04774076]
Stock Position:  0.04774076325771093
Bond Position:  [-12.16202524]


portfolio before change:  [-7.29407586]
curr_Stock_Price:  102.03000404508975
curr_Factors:  [102.03000405]
mat_Sqrt:  [[0.15]]
grads:  [-0.02716046]
Stock Position:  -0.027160458026362924
Bond Position:  [-4.52289422]


portfolio before change:  [-7.29707803]
curr_Stock_Price:  102.09890210148271
curr_Factors:  [102.0989021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.29707803]
Stock Price:  102.66448874692685
PL:  [-9.96156678]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.23857194e-02]
 [ 7.26444820e-03]
 [ 2.86225879e-03]
 [ 1.66516580e-02]
 [ 2.34256245e-02]
 [ 6.71801698e-03]
 [ 3.24289102e-02]
 [-2.43699225e-03]
 [ 1.05284823e-02]
 [-1.72926118e-02]
 [-9.26081905e-03]
 [-2.06238640e-02]
 [-2.06514448e-02]
 [ 6.05169903e-03]
 [ 3.17951076e-02]
 [ 1.44833699e-04]
 [ 7.50458891e-03]
 [-4.62992242e-03]
 [-1.17897343e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.49126881]
curr_Stock_Price:  102.70668582927259
curr_Factors:  [102.70668583]
mat_Sqrt:  [[0.15]]
grads:  [0.2159048]
Stock Position:  0.2159047962836101
Bond Position:  [21.31640273]


portfolio before change:  [43.86698959]
curr_Stock_Price:  104.4222151642435
curr_Factors:  [104.42221516]
mat_Sqrt:  [[0.15]]
grads:  [0.04842965]
Stock Position:  0.048429654641909674
Bond Position:  [38.80985777]


portfolio before change:  [43.89540353]
curr_Stock_Price:  104.80855404823811
curr_Factors:  [104.80855405]
mat_Sqrt:  [[0.15]]
grads:  [0.01908173]
Stock Position:  0.019081725237747513
Bond Position:  [41.8954755]


portfolio before change:  [43.8876435]
curr_Stock_Price:  103.85291685577708
curr_Factors:  [103.85291686]
mat_Sqrt:  [[0.15]]
grads:  [0.11101105]
Stock Position:  0.11101105309673023
Bond Position:  [32.35882183]


portfolio before change:  [43.93009376]
curr_Stock_Price:  104.16243146026225
curr_Factors:  [104.16243146]
mat_Sqrt:  [[0.15]]
grads:  [0.15617083]
Stock Position:  0.1561708300787321
Bond Position:  [27.66296037]


portfolio before change:  [43.70026192]
curr_Stock_Price:  102.64647328562474
curr_Factors:  [102.64647329]
mat_Sqrt:  [[0.15]]
grads:  [0.04478678]
Stock Position:  0.04478677984324043
Bond Position:  [39.10305692]


portfolio before change:  [43.75161146]
curr_Stock_Price:  103.57470610047903
curr_Factors:  [103.5747061]
mat_Sqrt:  [[0.15]]
grads:  [0.21619273]
Stock Position:  0.21619273462782082
Bond Position:  [21.35951251]


portfolio before change:  [43.91781301]
curr_Stock_Price:  104.31876903019196
curr_Factors:  [104.31876903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01624662]
Stock Position:  -0.01624661503124426
Bond Position:  [45.61263989]


portfolio before change:  [43.90266798]
curr_Stock_Price:  105.95293159112448
curr_Factors:  [105.95293159]
mat_Sqrt:  [[0.15]]
grads:  [0.07018988]
Stock Position:  0.07018988227232266
Bond Position:  [36.46584419]


portfolio before change:  [43.85383542]
curr_Stock_Price:  105.12731165168951
curr_Factors:  [105.12731165]
mat_Sqrt:  [[0.15]]
grads:  [-0.11528408]
Stock Position:  -0.11528407853203643
Bond Position:  [55.97334067]


portfolio before change:  [43.81870832]
curr_Stock_Price:  105.55340849074118
curr_Factors:  [105.55340849]
mat_Sqrt:  [[0.15]]
grads:  [-0.06173879]
Stock Position:  -0.06173879367782046
Bond Position:  [50.33544843]


portfolio before change:  [43.86969817]
curr_Stock_Price:  104.93136175684711
curr_Factors:  [104.93136176]
mat_Sqrt:  [[0.15]]
grads:  [-0.13749243]
Stock Position:  -0.137492426833976
Bond Position:  [58.29696575]


portfolio before change:  [43.99295706]
curr_Stock_Price:  104.14089763097944
curr_Factors:  [104.14089763]
mat_Sqrt:  [[0.15]]
grads:  [-0.1376763]
Stock Position:  -0.1376762984973364
Bond Position:  [58.33069037]


portfolio before change:  [43.77383743]
curr_Stock_Price:  105.83838755247237
curr_Factors:  [105.83838755]
mat_Sqrt:  [[0.15]]
grads:  [0.04034466]
Stock Position:  0.04034466019679351
Bond Position:  [39.50382365]


portfolio before change:  [43.75560276]
curr_Stock_Price:  105.14159485031152
curr_Factors:  [105.14159485]
mat_Sqrt:  [[0.15]]
grads:  [0.21196738]
Stock Position:  0.21196738409995175
Bond Position:  [21.46901394]


portfolio before change:  [43.91954093]
curr_Stock_Price:  105.8896828308749
curr_Factors:  [105.88968283]
mat_Sqrt:  [[0.15]]
grads:  [0.00096556]
Stock Position:  0.0009655579947671159
Bond Position:  [43.8172983]


portfolio before change:  [43.92738844]
curr_Stock_Price:  102.67062924768805
curr_Factors:  [102.67062925]
mat_Sqrt:  [[0.15]]
grads:  [0.05003059]
Stock Position:  0.050030592707314636
Bond Position:  [38.79071601]


portfolio before change:  [43.92778168]
curr_Stock_Price:  102.48462985676898
curr_Factors:  [102.48462986]
mat_Sqrt:  [[0.15]]
grads:  [-0.03086615]
Stock Position:  -0.030866149452845635
Bond Position:  [47.09108758]


portfolio before change:  [43.93424824]
curr_Stock_Price:  102.65658783735915
curr_Factors:  [102.65658784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.93424824]
Stock Price:  102.83194188614192
PL:  [41.10230635]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.14779259e-02]
 [-3.29973169e-04]
 [-2.29906910e-03]
 [-4.99616185e-04]
 [-2.19739333e-03]
 [ 3.28103608e-03]
 [-6.63466220e-03]
 [ 6.67618792e-03]
 [ 4.71042989e-03]
 [ 1.31519168e-02]
 [-1.85394336e-02]
 [-1.91986673e-03]
 [-2.60547759e-02]
 [ 2.83308774e-03]
 [ 2.68272604e-02]
 [ 1.76276470e-03]
 [ 7.24744727e-03]
 [-4.83259185e-03]
 [-1.18142956e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.61161385]
curr_Stock_Price:  99.19679572581717
curr_Factors:  [99.19679573]
mat_Sqrt:  [[0.15]]
grads:  [0.07651951]
Stock Position:  0.0765195062789943
Bond Position:  [-18.20210368]


portfolio before change:  [-10.75508808]
curr_Stock_Price:  97.38127002450767
curr_Factors:  [97.38127002]
mat_Sqrt:  [[0.15]]
grads:  [-0.00219982]
Stock Position:  -0.002199821128755902
Bond Position:  [-10.5408667]


portfolio before change:  [-10.75835748]
curr_Stock_Price:  97.66941252103628
curr_Factors:  [97.66941252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01532713]
Stock Position:  -0.015327127309189836
Bond Position:  [-9.26136596]


portfolio before change:  [-10.75226646]
curr_Stock_Price:  97.12093033284846
curr_Factors:  [97.12093033]
mat_Sqrt:  [[0.15]]
grads:  [-0.00333077]
Stock Position:  -0.0033307745680215507
Bond Position:  [-10.42877853]


portfolio before change:  [-10.75405671]
curr_Stock_Price:  96.87556247650892
curr_Factors:  [96.87556248]
mat_Sqrt:  [[0.15]]
grads:  [-0.01464929]
Stock Position:  -0.014649288884700403
Bond Position:  [-9.33489861]


portfolio before change:  [-10.76918799]
curr_Stock_Price:  97.74913783975883
curr_Factors:  [97.74913784]
mat_Sqrt:  [[0.15]]
grads:  [0.02187357]
Stock Position:  0.021873573846384158
Bond Position:  [-12.90731097]


portfolio before change:  [-10.77190427]
curr_Stock_Price:  97.77249714288696
curr_Factors:  [97.77249714]
mat_Sqrt:  [[0.15]]
grads:  [-0.04423108]
Stock Position:  -0.04423108133723588
Bond Position:  [-6.44732099]


portfolio before change:  [-10.73639633]
curr_Stock_Price:  96.93326886013716
curr_Factors:  [96.93326886]
mat_Sqrt:  [[0.15]]
grads:  [0.04450792]
Stock Position:  0.04450791943365544
Bond Position:  [-15.05069445]


portfolio before change:  [-10.70484758]
curr_Stock_Price:  97.7266532857892
curr_Factors:  [97.72665329]
mat_Sqrt:  [[0.15]]
grads:  [0.03140287]
Stock Position:  0.0314028659143147
Bond Position:  [-13.77374457]


portfolio before change:  [-10.66701878]
curr_Stock_Price:  99.04094944533274
curr_Factors:  [99.04094945]
mat_Sqrt:  [[0.15]]
grads:  [0.08767945]
Stock Position:  0.08767944513114811
Bond Position:  [-19.35087427]


portfolio before change:  [-10.67440063]
curr_Stock_Price:  99.01194009381656
curr_Factors:  [99.01194009]
mat_Sqrt:  [[0.15]]
grads:  [-0.12359622]
Stock Position:  -0.12359622396124322
Bond Position:  [1.5631013]


portfolio before change:  [-10.86017879]
curr_Stock_Price:  100.51820771174056
curr_Factors:  [100.51820771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01279911]
Stock Position:  -0.012799111553183912
Bond Position:  [-9.57363504]


portfolio before change:  [-10.86224563]
curr_Stock_Price:  100.49266907956581
curr_Factors:  [100.49266908]
mat_Sqrt:  [[0.15]]
grads:  [-0.17369851]
Stock Position:  -0.1736985061989228
Bond Position:  [6.59318087]


portfolio before change:  [-11.23084227]
curr_Stock_Price:  102.62420810297725
curr_Factors:  [102.6242081]
mat_Sqrt:  [[0.15]]
grads:  [0.01888725]
Stock Position:  0.018887251575973783
Bond Position:  [-13.16913151]


portfolio before change:  [-11.19976952]
curr_Stock_Price:  104.44371285823534
curr_Factors:  [104.44371286]
mat_Sqrt:  [[0.15]]
grads:  [0.1788484]
Stock Position:  0.17884840247009856
Bond Position:  [-29.87936072]


portfolio before change:  [-11.29989129]
curr_Stock_Price:  103.92567077848724
curr_Factors:  [103.92567078]
mat_Sqrt:  [[0.15]]
grads:  [0.01175176]
Stock Position:  0.011751764682113546
Bond Position:  [-12.52120132]


portfolio before change:  [-11.30622631]
curr_Stock_Price:  103.65300357427923
curr_Factors:  [103.65300357]
mat_Sqrt:  [[0.15]]
grads:  [0.04831632]
Stock Position:  0.048316315114944025
Bond Position:  [-16.31435749]


portfolio before change:  [-11.35544965]
curr_Stock_Price:  102.71865565830608
curr_Factors:  [102.71865566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03221728]
Stock Position:  -0.032217278995806356
Bond Position:  [-8.04613407]


portfolio before change:  [-11.35305163]
curr_Stock_Price:  102.58177835663113
curr_Factors:  [102.58177836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.35305163]
Stock Price:  101.72082138447068
PL:  [-13.07387301]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.09154997e-04]
 [ 5.98105988e-03]
 [ 1.83880192e-03]
 [ 1.75100358e-02]
 [ 2.24617096e-02]
 [ 5.69711985e-03]
 [ 2.21297803e-02]
 [-1.09907919e-02]
 [ 1.01711494e-02]
 [-1.16152486e-02]
 [-1.12721453e-02]
 [-2.04511636e-02]
 [-2.07186919e-02]
 [ 3.71100837e-03]
 [ 1.88241300e-02]
 [ 4.78664319e-03]
 [ 7.50681475e-03]
 [-2.76302096e-03]
 [-1.17047250e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.69043042]
curr_Stock_Price:  99.71067746303348
curr_Factors:  [99.71067746]
mat_Sqrt:  [[0.15]]
grads:  [0.00539437]
Stock Position:  0.005394366643571065
Bond Position:  [-3.22830637]


portfolio before change:  [-2.68392722]
curr_Stock_Price:  101.06586428354201
curr_Factors:  [101.06586428]
mat_Sqrt:  [[0.15]]
grads:  [0.03987373]
Stock Position:  0.03987373251739666
Bond Position:  [-6.71380046]


portfolio before change:  [-2.61535452]
curr_Stock_Price:  102.82770995706272
curr_Factors:  [102.82770996]
mat_Sqrt:  [[0.15]]
grads:  [0.01225868]
Stock Position:  0.012258679474708536
Bond Position:  [-3.87588646]


portfolio before change:  [-2.59423568]
curr_Stock_Price:  104.62953023133734
curr_Factors:  [104.62953023]
mat_Sqrt:  [[0.15]]
grads:  [0.11673357]
Stock Position:  0.11673357228156196
Bond Position:  [-14.80801451]


portfolio before change:  [-2.54109216]
curr_Stock_Price:  105.11650224802968
curr_Factors:  [105.11650225]
mat_Sqrt:  [[0.15]]
grads:  [0.14974473]
Stock Position:  0.14974473039044825
Bond Position:  [-18.28173445]


portfolio before change:  [-2.50598274]
curr_Stock_Price:  105.38148934948028
curr_Factors:  [105.38148935]
mat_Sqrt:  [[0.15]]
grads:  [0.0379808]
Stock Position:  0.03798079902611859
Bond Position:  [-6.50845591]


portfolio before change:  [-2.46202931]
curr_Stock_Price:  106.58158916897396
curr_Factors:  [106.58158917]
mat_Sqrt:  [[0.15]]
grads:  [0.14753187]
Stock Position:  0.1475318684712115
Bond Position:  [-18.1862103]


portfolio before change:  [-2.52912542]
curr_Stock_Price:  106.15761979168813
curr_Factors:  [106.15761979]
mat_Sqrt:  [[0.15]]
grads:  [-0.07327195]
Stock Position:  -0.0732719462583086
Bond Position:  [5.24924999]


portfolio before change:  [-2.48203069]
curr_Stock_Price:  105.53279322647926
curr_Factors:  [105.53279323]
mat_Sqrt:  [[0.15]]
grads:  [0.06780766]
Stock Position:  0.06780766236069996
Bond Position:  [-9.6379627]


portfolio before change:  [-2.55948252]
curr_Stock_Price:  104.42610358037156
curr_Factors:  [104.42610358]
mat_Sqrt:  [[0.15]]
grads:  [-0.07743499]
Stock Position:  -0.0774349907692638
Bond Position:  [5.52675185]


portfolio before change:  [-2.54960739]
curr_Stock_Price:  104.31642097152663
curr_Factors:  [104.31642097]
mat_Sqrt:  [[0.15]]
grads:  [-0.07514764]
Stock Position:  -0.07514763538399083
Bond Position:  [5.28952498]


portfolio before change:  [-2.59224858]
curr_Stock_Price:  104.90145251189217
curr_Factors:  [104.90145251]
mat_Sqrt:  [[0.15]]
grads:  [-0.13634109]
Stock Position:  -0.13634109077399065
Bond Position:  [11.71012988]


portfolio before change:  [-2.47414506]
curr_Stock_Price:  104.05669161238954
curr_Factors:  [104.05669161]
mat_Sqrt:  [[0.15]]
grads:  [-0.13812461]
Stock Position:  -0.13812461242909496
Bond Position:  [11.89864514]


portfolio before change:  [-2.41237208]
curr_Stock_Price:  103.63100392862253
curr_Factors:  [103.63100393]
mat_Sqrt:  [[0.15]]
grads:  [0.02474006]
Stock Position:  0.024740055795270787
Bond Position:  [-4.9762089]


portfolio before change:  [-2.42132452]
curr_Stock_Price:  103.31943501324103
curr_Factors:  [103.31943501]
mat_Sqrt:  [[0.15]]
grads:  [0.1254942]
Stock Position:  0.12549419972810835
Bond Position:  [-15.38731433]


portfolio before change:  [-2.5987263]
curr_Stock_Price:  101.93646691764559
curr_Factors:  [101.93646692]
mat_Sqrt:  [[0.15]]
grads:  [0.03191095]
Stock Position:  0.03191095457595374
Bond Position:  [-5.85161627]


portfolio before change:  [-2.64232969]
curr_Stock_Price:  100.6159076960836
curr_Factors:  [100.6159077]
mat_Sqrt:  [[0.15]]
grads:  [0.05004543]
Stock Position:  0.05004543163751817
Bond Position:  [-7.67769622]


portfolio before change:  [-2.63400624]
curr_Stock_Price:  100.82058412225561
curr_Factors:  [100.82058412]
mat_Sqrt:  [[0.15]]
grads:  [-0.01842014]
Stock Position:  -0.01842013972502626
Bond Position:  [-0.77687699]


portfolio before change:  [-2.67313951]
curr_Stock_Price:  102.93452191047803
curr_Factors:  [102.93452191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.67313951]
Stock Price:  103.53122695178244
PL:  [-6.20436646]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.05386031e-03]
 [ 6.40665315e-03]
 [ 1.42776869e-03]
 [ 1.37716693e-02]
 [ 1.75860659e-02]
 [ 4.88951104e-03]
 [ 2.27168595e-02]
 [ 1.28087266e-02]
 [ 4.37319146e-03]
 [ 7.22492855e-03]
 [-1.34679297e-02]
 [-8.33761175e-03]
 [-2.09321653e-02]
 [ 3.95051325e-03]
 [ 3.00805772e-02]
 [ 7.38111564e-04]
 [ 7.00833569e-03]
 [-5.43773271e-03]
 [-9.96588021e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.97174001]
curr_Stock_Price:  100.5970020803785
curr_Factors:  [100.59700208]
mat_Sqrt:  [[0.15]]
grads:  [0.04035907]
Stock Position:  0.040359068758122806
Bond Position:  [6.91173868]


portfolio before change:  [11.02479112]
curr_Stock_Price:  101.8686607535309
curr_Factors:  [101.86866075]
mat_Sqrt:  [[0.15]]
grads:  [0.04271102]
Stock Position:  0.04271102098700527
Bond Position:  [6.67387661]


portfolio before change:  [11.03180498]
curr_Stock_Price:  101.99380832156064
curr_Factors:  [101.99380832]
mat_Sqrt:  [[0.15]]
grads:  [0.00951846]
Stock Position:  0.009518457937199173
Bond Position:  [10.0609812]


portfolio before change:  [11.02919703]
curr_Stock_Price:  101.45553768163408
curr_Factors:  [101.45553768]
mat_Sqrt:  [[0.15]]
grads:  [0.09181113]
Stock Position:  0.0918111286318819
Bond Position:  [1.71444961]


portfolio before change:  [10.98009215]
curr_Stock_Price:  100.91602203023074
curr_Factors:  [100.91602203]
mat_Sqrt:  [[0.15]]
grads:  [0.11724044]
Stock Position:  0.11724043950614264
Bond Position:  [-0.85134662]


portfolio before change:  [10.98582759]
curr_Stock_Price:  100.9667579045875
curr_Factors:  [100.9667579]
mat_Sqrt:  [[0.15]]
grads:  [0.03259674]
Stock Position:  0.03259674028404605
Bond Position:  [7.6946404]


portfolio before change:  [10.98787298]
curr_Stock_Price:  100.9704850261438
curr_Factors:  [100.97048503]
mat_Sqrt:  [[0.15]]
grads:  [0.15144573]
Stock Position:  0.15144572992839941
Bond Position:  [-4.30367583]


portfolio before change:  [11.03319128]
curr_Stock_Price:  101.27682815250358
curr_Factors:  [101.27682815]
mat_Sqrt:  [[0.15]]
grads:  [0.08539151]
Stock Position:  0.08539151048580912
Bond Position:  [2.38500995]


portfolio before change:  [11.04152242]
curr_Stock_Price:  101.36740864396164
curr_Factors:  [101.36740864]
mat_Sqrt:  [[0.15]]
grads:  [0.02915461]
Stock Position:  0.029154609763729425
Bond Position:  [8.08619517]


portfolio before change:  [11.05923315]
curr_Stock_Price:  101.9055374758239
curr_Factors:  [101.90553748]
mat_Sqrt:  [[0.15]]
grads:  [0.04816619]
Stock Position:  0.04816619031211263
Bond Position:  [6.15083164]


portfolio before change:  [11.111849]
curr_Stock_Price:  102.96598968525313
curr_Factors:  [102.96598969]
mat_Sqrt:  [[0.15]]
grads:  [-0.0897862]
Stock Position:  -0.08978619807878604
Bond Position:  [20.35677374]


portfolio before change:  [11.21446055]
curr_Stock_Price:  101.87983476215095
curr_Factors:  [101.87983476]
mat_Sqrt:  [[0.15]]
grads:  [-0.05558408]
Stock Position:  -0.05558407833317938
Bond Position:  [16.87735726]


portfolio before change:  [11.11253996]
curr_Stock_Price:  103.78938264700241
curr_Factors:  [103.78938265]
mat_Sqrt:  [[0.15]]
grads:  [-0.13954777]
Stock Position:  -0.13954776881712772
Bond Position:  [25.59611673]


portfolio before change:  [11.10271254]
curr_Stock_Price:  103.90566715348106
curr_Factors:  [103.90566715]
mat_Sqrt:  [[0.15]]
grads:  [0.02633675]
Stock Position:  0.0263367549872915
Bond Position:  [8.36617444]


portfolio before change:  [11.13101128]
curr_Stock_Price:  104.90073803141368
curr_Factors:  [104.90073803]
mat_Sqrt:  [[0.15]]
grads:  [0.20053718]
Stock Position:  0.20053718149969463
Bond Position:  [-9.90548706]


portfolio before change:  [11.18243153]
curr_Stock_Price:  105.16950077447709
curr_Factors:  [105.16950077]
mat_Sqrt:  [[0.15]]
grads:  [0.00492074]
Stock Position:  0.004920743760242116
Bond Position:  [10.66491936]


portfolio before change:  [11.18119857]
curr_Stock_Price:  104.37703482214023
curr_Factors:  [104.37703482]
mat_Sqrt:  [[0.15]]
grads:  [0.04672224]
Stock Position:  0.04672223792247544
Bond Position:  [6.30446991]


portfolio before change:  [11.24822765]
curr_Stock_Price:  105.77792588936782
curr_Factors:  [105.77792589]
mat_Sqrt:  [[0.15]]
grads:  [-0.03625155]
Stock Position:  -0.03625155142935554
Bond Position:  [15.08284157]


portfolio before change:  [11.21166555]
curr_Stock_Price:  106.89052046109927
curr_Factors:  [106.89052046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.21166555]
Stock Price:  106.44233118951895
PL:  [4.76933436]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.17675861e-02]
 [ 6.25792082e-03]
 [ 1.46346592e-03]
 [ 2.59447378e-03]
 [ 1.05086395e-02]
 [ 4.35229376e-03]
 [-1.50273789e-02]
 [ 1.31897402e-02]
 [ 7.11328345e-03]
 [ 8.76256803e-03]
 [-1.81692323e-02]
 [ 5.44064134e-03]
 [-1.25668064e-02]
 [ 4.06139346e-03]
 [-1.16702784e-02]
 [ 7.23617957e-03]
 [ 7.47707345e-03]
 [-2.47130457e-03]
 [-1.28581197e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.81417884]
curr_Stock_Price:  99.18365445079036
curr_Factors:  [99.18365445]
mat_Sqrt:  [[0.15]]
grads:  [0.07845057]
Stock Position:  0.07845057386135096
Bond Position:  [-18.59519345]


portfolio before change:  [-10.69157423]
curr_Stock_Price:  100.80574570720823
curr_Factors:  [100.80574571]
mat_Sqrt:  [[0.15]]
grads:  [0.04171947]
Stock Position:  0.04171947210363851
Bond Position:  [-14.89713673]


portfolio before change:  [-10.74132628]
curr_Stock_Price:  99.70248866296987
curr_Factors:  [99.70248866]
mat_Sqrt:  [[0.15]]
grads:  [0.00975644]
Stock Position:  0.00975643948282493
Bond Position:  [-11.71406758]


portfolio before change:  [-10.75217433]
curr_Stock_Price:  98.89080267232504
curr_Factors:  [98.89080267]
mat_Sqrt:  [[0.15]]
grads:  [0.01729649]
Stock Position:  0.017296491877805874
Bond Position:  [-12.4626383]


portfolio before change:  [-10.73149646]
curr_Stock_Price:  100.26645301598755
curr_Factors:  [100.26645302]
mat_Sqrt:  [[0.15]]
grads:  [0.0700576]
Stock Position:  0.07005759676780977
Bond Position:  [-17.75592319]


portfolio before change:  [-10.80660201]
curr_Stock_Price:  99.25776836265753
curr_Factors:  [99.25776836]
mat_Sqrt:  [[0.15]]
grads:  [0.02901529]
Stock Position:  0.029015291732933934
Bond Position:  [-13.68659512]


portfolio before change:  [-10.81025205]
curr_Stock_Price:  99.24991194966145
curr_Factors:  [99.24991195]
mat_Sqrt:  [[0.15]]
grads:  [-0.10018253]
Stock Position:  -0.10018252583570877
Bond Position:  [-0.86714518]


portfolio before change:  [-10.99065259]
curr_Stock_Price:  101.04846642471591
curr_Factors:  [101.04846642]
mat_Sqrt:  [[0.15]]
grads:  [0.0879316]
Stock Position:  0.08793160134587999
Bond Position:  [-19.87600606]


portfolio before change:  [-10.88162126]
curr_Stock_Price:  102.34493951069958
curr_Factors:  [102.34493951]
mat_Sqrt:  [[0.15]]
grads:  [0.04742189]
Stock Position:  0.04742188968779972
Bond Position:  [-15.73501169]


portfolio before change:  [-10.95474167]
curr_Stock_Price:  100.88598941270736
curr_Factors:  [100.88598941]
mat_Sqrt:  [[0.15]]
grads:  [0.05841712]
Stock Position:  0.058417120231209985
Bond Position:  [-16.84821065]


portfolio before change:  [-11.04806511]
curr_Stock_Price:  99.36056574927989
curr_Factors:  [99.36056575]
mat_Sqrt:  [[0.15]]
grads:  [-0.12112822]
Stock Position:  -0.12112821505810008
Bond Position:  [0.98730287]


portfolio before change:  [-10.87524649]
curr_Stock_Price:  97.9358624491587
curr_Factors:  [97.93586245]
mat_Sqrt:  [[0.15]]
grads:  [0.03627094]
Stock Position:  0.036270942265904035
Bond Position:  [-14.4274725]


portfolio before change:  [-10.86627348]
curr_Stock_Price:  98.28270566411058
curr_Factors:  [98.28270566]
mat_Sqrt:  [[0.15]]
grads:  [-0.08377871]
Stock Position:  -0.08377870955972413
Bond Position:  [-2.63227522]


portfolio before change:  [-10.98510487]
curr_Stock_Price:  99.69324596535631
curr_Factors:  [99.69324597]
mat_Sqrt:  [[0.15]]
grads:  [0.02707596]
Stock Position:  0.027075956391263586
Bond Position:  [-13.68439485]


portfolio before change:  [-10.98483484]
curr_Stock_Price:  99.82958667430763
curr_Factors:  [99.82958667]
mat_Sqrt:  [[0.15]]
grads:  [-0.07780186]
Stock Position:  -0.07780185579734311
Bond Position:  [-3.21790774]


portfolio before change:  [-11.0702631]
curr_Stock_Price:  100.91726872544483
curr_Factors:  [100.91726873]
mat_Sqrt:  [[0.15]]
grads:  [0.0482412]
Stock Position:  0.04824119712577921
Bond Position:  [-15.93863296]


portfolio before change:  [-11.02684126]
curr_Stock_Price:  101.89997656688531
curr_Factors:  [101.89997657]
mat_Sqrt:  [[0.15]]
grads:  [0.04984716]
Stock Position:  0.04984715632403269
Bond Position:  [-16.10626532]


portfolio before change:  [-11.10209698]
curr_Stock_Price:  100.47103532461212
curr_Factors:  [100.47103532]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647536]
Stock Position:  -0.01647536382300831
Bond Position:  [-9.44680012]


portfolio before change:  [-11.09485092]
curr_Stock_Price:  99.88785797428748
curr_Factors:  [99.88785797]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.09485092]
Stock Price:  100.83023964418985
PL:  [-11.92509056]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.79307113e-03]
 [ 5.95836674e-03]
 [ 7.42260485e-04]
 [ 1.43614816e-02]
 [ 2.43946456e-02]
 [ 5.80071833e-03]
 [ 2.52138782e-02]
 [-1.07771408e-02]
 [ 1.02583719e-02]
 [-2.68475457e-02]
 [-8.32662322e-03]
 [-1.85166841e-02]
 [-1.96340255e-02]
 [ 5.48759258e-03]
 [ 3.28345228e-02]
 [ 1.78298183e-03]
 [ 7.31128431e-03]
 [-5.17710301e-03]
 [-1.12792717e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.50694335]
curr_Stock_Price:  100.30735123718
curr_Factors:  [100.30735124]
mat_Sqrt:  [[0.15]]
grads:  [0.03862047]
Stock Position:  0.03862047422825039
Bond Position:  [2.63302588]


portfolio before change:  [6.53774383]
curr_Stock_Price:  101.08782163822775
curr_Factors:  [101.08782164]
mat_Sqrt:  [[0.15]]
grads:  [0.03972244]
Stock Position:  0.03972244495335967
Bond Position:  [2.5222884]


portfolio before change:  [6.5375997]
curr_Stock_Price:  101.06831669965389
curr_Factors:  [101.0683167]
mat_Sqrt:  [[0.15]]
grads:  [0.0049484]
Stock Position:  0.004948403235936867
Bond Position:  [6.03747291]


portfolio before change:  [6.54397062]
curr_Stock_Price:  102.05072767645717
curr_Factors:  [102.05072768]
mat_Sqrt:  [[0.15]]
grads:  [0.09574321]
Stock Position:  0.09574321047957339
Bond Position:  [-3.22669368]


portfolio before change:  [6.67410642]
curr_Stock_Price:  103.41837109647042
curr_Factors:  [103.4183711]
mat_Sqrt:  [[0.15]]
grads:  [0.16263097]
Stock Position:  0.16263097053849127
Bond Position:  [-10.14492365]


portfolio before change:  [6.94569651]
curr_Stock_Price:  105.10394571236586
curr_Factors:  [105.10394571]
mat_Sqrt:  [[0.15]]
grads:  [0.03867146]
Stock Position:  0.03867145554367203
Bond Position:  [2.88117394]


portfolio before change:  [6.96782711]
curr_Stock_Price:  105.65758966055651
curr_Factors:  [105.65758966]
mat_Sqrt:  [[0.15]]
grads:  [0.16809252]
Stock Position:  0.1680925214019336
Bond Position:  [-10.79242354]


portfolio before change:  [7.04082868]
curr_Stock_Price:  106.10793701058388
curr_Factors:  [106.10793701]
mat_Sqrt:  [[0.15]]
grads:  [-0.07184761]
Stock Position:  -0.0718476050047553
Bond Position:  [14.66442983]


portfolio before change:  [7.07844978]
curr_Stock_Price:  105.63534609156713
curr_Factors:  [105.63534609]
mat_Sqrt:  [[0.15]]
grads:  [0.06838915]
Stock Position:  0.06838914574275833
Bond Position:  [-0.1458613]


portfolio before change:  [7.12437699]
curr_Stock_Price:  106.30743639954177
curr_Factors:  [106.3074364]
mat_Sqrt:  [[0.15]]
grads:  [-0.17898364]
Stock Position:  -0.17898363787756352
Bond Position:  [26.15166869]


portfolio before change:  [7.16304102]
curr_Stock_Price:  106.12794908541231
curr_Factors:  [106.12794909]
mat_Sqrt:  [[0.15]]
grads:  [-0.05551082]
Stock Position:  -0.05551082147272817
Bond Position:  [13.05429065]


portfolio before change:  [7.2529863]
curr_Stock_Price:  104.56642827583316
curr_Factors:  [104.56642828]
mat_Sqrt:  [[0.15]]
grads:  [-0.12344456]
Stock Position:  -0.1234445604695656
Bond Position:  [20.16114308]


portfolio before change:  [7.11745887]
curr_Stock_Price:  105.70514465796516
curr_Factors:  [105.70514466]
mat_Sqrt:  [[0.15]]
grads:  [-0.1308935]
Stock Position:  -0.13089350300329716
Bond Position:  [20.95357554]


portfolio before change:  [7.165027]
curr_Stock_Price:  105.38175897562934
curr_Factors:  [105.38175898]
mat_Sqrt:  [[0.15]]
grads:  [0.03658395]
Stock Position:  0.03658395053332409
Bond Position:  [3.30974595]


portfolio before change:  [7.16241026]
curr_Stock_Price:  105.2876116537508
curr_Factors:  [105.28761165]
mat_Sqrt:  [[0.15]]
grads:  [0.21889682]
Stock Position:  0.21889681899820537
Bond Position:  [-15.88471301]


portfolio before change:  [6.85494198]
curr_Stock_Price:  103.9011291346981
curr_Factors:  [103.90112913]
mat_Sqrt:  [[0.15]]
grads:  [0.01188655]
Stock Position:  0.011886545546637874
Bond Position:  [5.61991647]


portfolio before change:  [6.85110012]
curr_Stock_Price:  103.45970462968668
curr_Factors:  [103.45970463]
mat_Sqrt:  [[0.15]]
grads:  [0.0487419]
Stock Position:  0.04874189541940398
Bond Position:  [1.80827802]


portfolio before change:  [6.84517689]
curr_Stock_Price:  103.32890647771741
curr_Factors:  [103.32890648]
mat_Sqrt:  [[0.15]]
grads:  [-0.03451402]
Stock Position:  -0.03451402003818316
Bond Position:  [10.41147284]


portfolio before change:  [6.83271194]
curr_Stock_Price:  103.76548700013625
curr_Factors:  [103.765487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.83271194]
Stock Price:  102.95523154213426
PL:  [3.8774804]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.44923692e-03]
 [ 5.97738881e-03]
 [ 1.13657870e-03]
 [ 6.63074119e-03]
 [ 2.52526839e-02]
 [ 6.89249603e-03]
 [ 2.69143264e-02]
 [-1.35067927e-02]
 [ 1.15933365e-02]
 [-2.57159307e-02]
 [-5.93596156e-03]
 [-4.26439732e-02]
 [-1.45073846e-02]
 [ 8.75353524e-03]
 [ 5.23772227e-02]
 [-5.72998968e-04]
 [ 5.97905276e-03]
 [-5.45203020e-03]
 [-9.88289363e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.20087879]
curr_Stock_Price:  99.96312367296439
curr_Factors:  [99.96312367]
mat_Sqrt:  [[0.15]]
grads:  [0.01632825]
Stock Position:  0.016328246131214738
Bond Position:  [-0.4313437]


portfolio before change:  [1.22187763]
curr_Stock_Price:  101.25577292642147
curr_Factors:  [101.25577293]
mat_Sqrt:  [[0.15]]
grads:  [0.03984926]
Stock Position:  0.03984925871597605
Bond Position:  [-2.81308986]


portfolio before change:  [1.1859917]
curr_Stock_Price:  100.37288146949041
curr_Factors:  [100.37288147]
mat_Sqrt:  [[0.15]]
grads:  [0.00757719]
Stock Position:  0.0075771913386145666
Bond Position:  [0.42544717]


portfolio before change:  [1.18680613]
curr_Stock_Price:  100.46632687635129
curr_Factors:  [100.46632688]
mat_Sqrt:  [[0.15]]
grads:  [0.04420494]
Stock Position:  0.044204941277497835
Bond Position:  [-3.25430195]


portfolio before change:  [1.26468866]
curr_Stock_Price:  102.24658503889096
curr_Factors:  [102.24658504]
mat_Sqrt:  [[0.15]]
grads:  [0.16835123]
Stock Position:  0.1683512257468696
Bond Position:  [-15.94864926]


portfolio before change:  [1.24932943]
curr_Stock_Price:  102.17903831092669
curr_Factors:  [102.17903831]
mat_Sqrt:  [[0.15]]
grads:  [0.04594997]
Stock Position:  0.045949973549153124
Bond Position:  [-3.44579468]


portfolio before change:  [1.38489771]
curr_Stock_Price:  105.14813330695459
curr_Factors:  [105.14813331]
mat_Sqrt:  [[0.15]]
grads:  [0.17942884]
Stock Position:  0.17942884266004794
Bond Position:  [-17.48171016]


portfolio before change:  [1.66663701]
curr_Stock_Price:  106.74269454611184
curr_Factors:  [106.74269455]
mat_Sqrt:  [[0.15]]
grads:  [-0.09004528]
Stock Position:  -0.09004528483993145
Bond Position:  [11.27831334]


portfolio before change:  [1.62783337]
curr_Stock_Price:  107.2049460939412
curr_Factors:  [107.20494609]
mat_Sqrt:  [[0.15]]
grads:  [0.07728891]
Stock Position:  0.0772889099480464
Bond Position:  [-6.65792006]


portfolio before change:  [1.54599884]
curr_Stock_Price:  106.16767124610928
curr_Factors:  [106.16767125]
mat_Sqrt:  [[0.15]]
grads:  [-0.17143954]
Stock Position:  -0.17143953823749403
Bond Position:  [19.74733537]


portfolio before change:  [1.24815543]
curr_Stock_Price:  107.93377994504381
curr_Factors:  [107.93377995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03957308]
Stock Position:  -0.03957307705633371
Bond Position:  [5.51942722]


portfolio before change:  [1.21743574]
curr_Stock_Price:  108.74493025100443
curr_Factors:  [108.74493025]
mat_Sqrt:  [[0.15]]
grads:  [-0.28429315]
Stock Position:  -0.28429315454083903
Bond Position:  [32.13287501]


portfolio before change:  [1.16595484]
curr_Stock_Price:  108.95427447840373
curr_Factors:  [108.95427448]
mat_Sqrt:  [[0.15]]
grads:  [-0.0967159]
Stock Position:  -0.0967158972993972
Bond Position:  [11.70356526]


portfolio before change:  [1.25871326]
curr_Stock_Price:  108.02544927962617
curr_Factors:  [108.02544928]
mat_Sqrt:  [[0.15]]
grads:  [0.0583569]
Stock Position:  0.05835690163112394
Bond Position:  [-5.04531726]


portfolio before change:  [1.25728778]
curr_Stock_Price:  108.02263915847891
curr_Factors:  [108.02263916]
mat_Sqrt:  [[0.15]]
grads:  [0.34918148]
Stock Position:  0.34918148490489875
Bond Position:  [-36.46221776]


portfolio before change:  [0.80765184]
curr_Stock_Price:  106.76106239405708
curr_Factors:  [106.76106239]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381999]
Stock Position:  -0.0038199931224911525
Bond Position:  [1.21547836]


portfolio before change:  [0.80515704]
curr_Stock_Price:  107.49370950659666
curr_Factors:  [107.49370951]
mat_Sqrt:  [[0.15]]
grads:  [0.03986035]
Stock Position:  0.03986035171864971
Bond Position:  [-3.47958003]


portfolio before change:  [0.7476723]
curr_Stock_Price:  106.07338240428561
curr_Factors:  [106.0733824]
mat_Sqrt:  [[0.15]]
grads:  [-0.03634687]
Stock Position:  -0.036346868010491896
Bond Position:  [4.60310753]


portfolio before change:  [0.71116089]
curr_Stock_Price:  107.10957412288393
curr_Factors:  [107.10957412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.71116089]
Stock Price:  106.08844993182792
PL:  [-5.37728904]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.07424546e-03]
 [ 9.47150168e-03]
 [ 1.34594100e-03]
 [ 1.26313287e-02]
 [ 1.79601239e-02]
 [ 6.74481582e-03]
 [ 5.94760917e-03]
 [ 1.10480813e-02]
 [ 8.33910363e-03]
 [-1.54399755e-03]
 [-1.40848724e-02]
 [-8.68361862e-03]
 [-2.29772804e-02]
 [ 2.01464535e-03]
 [-3.25783908e-03]
 [ 7.93012251e-03]
 [ 4.63378547e-03]
 [-2.53388557e-03]
 [-1.27769956e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.00220087]
curr_Stock_Price:  100.53410384525512
curr_Factors:  [100.53410385]
mat_Sqrt:  [[0.15]]
grads:  [0.04049497]
Stock Position:  0.04049496970330081
Bond Position:  [5.93107538]


portfolio before change:  [9.97962135]
curr_Stock_Price:  99.93989507481629
curr_Factors:  [99.93989507]
mat_Sqrt:  [[0.15]]
grads:  [0.06314334]
Stock Position:  0.06314334454630538
Bond Position:  [3.66908213]


portfolio before change:  [9.95267569]
curr_Stock_Price:  99.49862852934946
curr_Factors:  [99.49862853]
mat_Sqrt:  [[0.15]]
grads:  [0.00897294]
Stock Position:  0.00897293998948848
Bond Position:  [9.05988047]


portfolio before change:  [9.96966245]
curr_Stock_Price:  101.13928372436978
curr_Factors:  [101.13928372]
mat_Sqrt:  [[0.15]]
grads:  [0.08420886]
Stock Position:  0.08420885792332417
Bond Position:  [1.45283887]


portfolio before change:  [9.95484171]
curr_Stock_Price:  100.95897017671128
curr_Factors:  [100.95897018]
mat_Sqrt:  [[0.15]]
grads:  [0.11973416]
Stock Position:  0.11973415932486102
Bond Position:  [-2.13339572]


portfolio before change:  [10.0391043]
curr_Stock_Price:  101.66717249778482
curr_Factors:  [101.6671725]
mat_Sqrt:  [[0.15]]
grads:  [0.04496544]
Stock Position:  0.04496543879231026
Bond Position:  [5.46759528]


portfolio before change:  [9.98516033]
curr_Stock_Price:  100.43709366722712
curr_Factors:  [100.43709367]
mat_Sqrt:  [[0.15]]
grads:  [0.03965073]
Stock Position:  0.039650727820623
Bond Position:  [6.00275647]


portfolio before change:  [10.03474623]
curr_Stock_Price:  101.6498084433091
curr_Factors:  [101.64980844]
mat_Sqrt:  [[0.15]]
grads:  [0.07365388]
Stock Position:  0.073653875291228
Bond Position:  [2.54784392]


portfolio before change:  [10.12234287]
curr_Stock_Price:  102.83046046564361
curr_Factors:  [102.83046047]
mat_Sqrt:  [[0.15]]
grads:  [0.05559402]
Stock Position:  0.05559402421117217
Bond Position:  [4.40558376]


portfolio before change:  [10.13779477]
curr_Stock_Price:  103.0885882561331
curr_Factors:  [103.08858826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01029332]
Stock Position:  -0.010293316980307561
Bond Position:  [11.19891828]


portfolio before change:  [10.14576235]
curr_Stock_Price:  102.58656322700452
curr_Factors:  [102.58656323]
mat_Sqrt:  [[0.15]]
grads:  [-0.09389915]
Stock Position:  -0.09389914929192276
Bond Position:  [19.77855337]


portfolio before change:  [10.23693606]
curr_Stock_Price:  101.66825407049693
curr_Factors:  [101.66825407]
mat_Sqrt:  [[0.15]]
grads:  [-0.05789079]
Stock Position:  -0.0578907908293101
Bond Position:  [16.12259169]


portfolio before change:  [10.36324517]
curr_Stock_Price:  99.55603623028522
curr_Factors:  [99.55603623]
mat_Sqrt:  [[0.15]]
grads:  [-0.15318187]
Stock Position:  -0.1531818693493361
Bond Position:  [25.6134249]


portfolio before change:  [10.12585978]
curr_Stock_Price:  101.147540135485
curr_Factors:  [101.14754014]
mat_Sqrt:  [[0.15]]
grads:  [0.01343097]
Stock Position:  0.013430969001603753
Bond Position:  [8.76735031]


portfolio before change:  [10.12451081]
curr_Stock_Price:  100.8838892314104
curr_Factors:  [100.88388923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02171893]
Stock Position:  -0.021718927194230946
Bond Position:  [12.31560065]


portfolio before change:  [10.16463224]
curr_Stock_Price:  99.17836518929224
curr_Factors:  [99.17836519]
mat_Sqrt:  [[0.15]]
grads:  [0.05286748]
Stock Position:  0.05286748338567086
Bond Position:  [4.92132167]


portfolio before change:  [10.13693616]
curr_Stock_Price:  98.63121288991216
curr_Factors:  [98.63121289]
mat_Sqrt:  [[0.15]]
grads:  [0.0308919]
Stock Position:  0.03089190313761888
Bond Position:  [7.09003029]


portfolio before change:  [10.19786102]
curr_Stock_Price:  100.54602293011048
curr_Factors:  [100.54602293]
mat_Sqrt:  [[0.15]]
grads:  [-0.01689257]
Stock Position:  -0.016892570488018777
Bond Position:  [11.8963418]


portfolio before change:  [10.22990664]
curr_Stock_Price:  98.82507891604423
curr_Factors:  [98.82507892]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.22990664]
Stock Price:  98.06527436492621
PL:  [10.22990664]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.33232863e-03]
 [ 7.00953783e-04]
 [-4.63953744e-05]
 [ 1.45590409e-03]
 [ 1.81821783e-03]
 [ 4.37101771e-03]
 [-9.75322633e-03]
 [ 6.48341882e-03]
 [ 4.56236931e-03]
 [-1.78879952e-02]
 [-1.76344590e-02]
 [ 7.24875680e-03]
 [ 5.88424482e-03]
 [-2.79898356e-03]
 [-1.64800701e-02]
 [ 6.57619857e-03]
 [ 3.76478525e-03]
 [-3.36463233e-03]
 [-1.22880895e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00478861]
curr_Stock_Price:  99.95040244719974
curr_Factors:  [99.95040245]
mat_Sqrt:  [[0.15]]
grads:  [0.01554886]
Stock Position:  0.015548857505043468
Bond Position:  [-0.54932596]


portfolio before change:  [0.96852902]
curr_Stock_Price:  97.62725806643022
curr_Factors:  [97.62725807]
mat_Sqrt:  [[0.15]]
grads:  [0.00467303]
Stock Position:  0.004673025217720861
Bond Position:  [0.51231438]


portfolio before change:  [0.97432091]
curr_Stock_Price:  98.83927882621472
curr_Factors:  [98.83927883]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003093]
Stock Position:  -0.00030930249574740115
Bond Position:  [1.00489215]


portfolio before change:  [0.97475768]
curr_Stock_Price:  98.23952134863222
curr_Factors:  [98.23952135]
mat_Sqrt:  [[0.15]]
grads:  [0.00970603]
Stock Position:  0.009706027246342761
Bond Position:  [0.0212422]


portfolio before change:  [0.97858762]
curr_Stock_Price:  98.63356881756063
curr_Factors:  [98.63356882]
mat_Sqrt:  [[0.15]]
grads:  [0.01212145]
Stock Position:  0.012121452177736379
Bond Position:  [-0.21699447]


portfolio before change:  [0.9859316]
curr_Stock_Price:  99.2439110324598
curr_Factors:  [99.24391103]
mat_Sqrt:  [[0.15]]
grads:  [0.02914012]
Stock Position:  0.029140118042388665
Bond Position:  [-1.90604768]


portfolio before change:  [0.96578317]
curr_Stock_Price:  98.56883280391764
curr_Factors:  [98.5688328]
mat_Sqrt:  [[0.15]]
grads:  [-0.06502151]
Stock Position:  -0.06502150885697194
Bond Position:  [7.37487741]


portfolio before change:  [1.07698689]
curr_Stock_Price:  96.88693141096782
curr_Factors:  [96.88693141]
mat_Sqrt:  [[0.15]]
grads:  [0.04322279]
Stock Position:  0.04322279212623085
Bond Position:  [-3.11073681]


portfolio before change:  [1.01573183]
curr_Stock_Price:  95.48773269404657
curr_Factors:  [95.48773269]
mat_Sqrt:  [[0.15]]
grads:  [0.0304158]
Stock Position:  0.030415795423010452
Bond Position:  [-1.88860351]


portfolio before change:  [0.99204069]
curr_Stock_Price:  94.72434870294614
curr_Factors:  [94.7243487]
mat_Sqrt:  [[0.15]]
grads:  [-0.1192533]
Stock Position:  -0.11925330118254363
Bond Position:  [12.28823197]


portfolio before change:  [0.83444912]
curr_Stock_Price:  96.07159874022705
curr_Factors:  [96.07159874]
mat_Sqrt:  [[0.15]]
grads:  [-0.11756306]
Stock Position:  -0.11756305976482084
Bond Position:  [12.12892022]


portfolio before change:  [0.87022214]
curr_Stock_Price:  95.79310639401609
curr_Factors:  [95.79310639]
mat_Sqrt:  [[0.15]]
grads:  [0.04832505]
Stock Position:  0.04832504536296699
Bond Position:  [-3.75898407]


portfolio before change:  [0.88659786]
curr_Stock_Price:  96.15142142618335
curr_Factors:  [96.15142143]
mat_Sqrt:  [[0.15]]
grads:  [0.0392283]
Stock Position:  0.03922829878331181
Bond Position:  [-2.88525882]


portfolio before change:  [0.86910121]
curr_Stock_Price:  95.72379019148043
curr_Factors:  [95.72379019]
mat_Sqrt:  [[0.15]]
grads:  [-0.01865989]
Stock Position:  -0.01865989037189987
Bond Position:  [2.65529664]


portfolio before change:  [0.87446079]
curr_Stock_Price:  95.47214532643311
curr_Factors:  [95.47214533]
mat_Sqrt:  [[0.15]]
grads:  [-0.10986713]
Stock Position:  -0.10986713408697944
Bond Position:  [11.36371178]


portfolio before change:  [0.86381613]
curr_Stock_Price:  95.59489301644844
curr_Factors:  [95.59489302]
mat_Sqrt:  [[0.15]]
grads:  [0.04384132]
Stock Position:  0.04384132379569485
Bond Position:  [-3.32719053]


portfolio before change:  [0.90605235]
curr_Stock_Price:  96.57725657492436
curr_Factors:  [96.57725657]
mat_Sqrt:  [[0.15]]
grads:  [0.02509857]
Stock Position:  0.025098568365512053
Bond Position:  [-1.51789853]


portfolio before change:  [0.87872912]
curr_Stock_Price:  95.50374098958308
curr_Factors:  [95.50374099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243088]
Stock Position:  -0.022430882178688657
Bond Position:  [3.02096228]


portfolio before change:  [0.87622681]
curr_Stock_Price:  95.64897139504508
curr_Factors:  [95.6489714]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87622681]
Stock Price:  93.54367194335181
PL:  [0.87622681]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.46774944e-02]
 [ 9.55487282e-03]
 [ 1.35573680e-03]
 [ 5.38878351e-03]
 [ 2.11932402e-03]
 [ 4.50809301e-03]
 [-1.38548226e-02]
 [ 1.05423884e-02]
 [ 5.15940397e-03]
 [ 8.21479435e-03]
 [-1.47767352e-02]
 [-6.07285281e-03]
 [-2.28698667e-02]
 [ 2.20978871e-03]
 [ 8.41022988e-03]
 [ 3.63114841e-03]
 [ 7.46900780e-03]
 [-3.67637411e-03]
 [-1.20551417e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.84913457]
curr_Stock_Price:  99.05163799229659
curr_Factors:  [99.05163799]
mat_Sqrt:  [[0.15]]
grads:  [0.09784996]
Stock Position:  0.09784996264326175
Bond Position:  [-22.54133365]


portfolio before change:  [-12.82290345]
curr_Stock_Price:  99.37731162373248
curr_Factors:  [99.37731162]
mat_Sqrt:  [[0.15]]
grads:  [0.06369915]
Stock Position:  0.06369915210698447
Bond Position:  [-19.15315394]


portfolio before change:  [-12.79260574]
curr_Stock_Price:  99.9281290965789
curr_Factors:  [99.9281291]
mat_Sqrt:  [[0.15]]
grads:  [0.00903825]
Stock Position:  0.009038245363200886
Bond Position:  [-13.69578068]


portfolio before change:  [-12.79217155]
curr_Stock_Price:  100.35504323716425
curr_Factors:  [100.35504324]
mat_Sqrt:  [[0.15]]
grads:  [0.03592522]
Stock Position:  0.03592522341436498
Bond Position:  [-16.3974489]


portfolio before change:  [-12.8542164]
curr_Stock_Price:  98.74211053054377
curr_Factors:  [98.74211053]
mat_Sqrt:  [[0.15]]
grads:  [0.01412883]
Stock Position:  0.014128826785648058
Bond Position:  [-14.24932657]


portfolio before change:  [-12.85320209]
curr_Stock_Price:  99.06606370749387
curr_Factors:  [99.06606371]
mat_Sqrt:  [[0.15]]
grads:  [0.03005395]
Stock Position:  0.030053953383465063
Bond Position:  [-15.83052896]


portfolio before change:  [-12.85618558]
curr_Stock_Price:  99.0984935768248
curr_Factors:  [99.09849358]
mat_Sqrt:  [[0.15]]
grads:  [-0.09236548]
Stock Position:  -0.09236548428998881
Bond Position:  [-3.70290522]


portfolio before change:  [-13.10031406]
curr_Stock_Price:  101.73154037713918
curr_Factors:  [101.73154038]
mat_Sqrt:  [[0.15]]
grads:  [0.07028259]
Stock Position:  0.07028258908001202
Bond Position:  [-20.25027011]


portfolio before change:  [-13.09860695]
curr_Stock_Price:  101.82787017055936
curr_Factors:  [101.82787017]
mat_Sqrt:  [[0.15]]
grads:  [0.03439603]
Stock Position:  0.034396026448265296
Bond Position:  [-16.60108107]


portfolio before change:  [-13.14961091]
curr_Stock_Price:  100.46570222341616
curr_Factors:  [100.46570222]
mat_Sqrt:  [[0.15]]
grads:  [0.0547653]
Stock Position:  0.05476529565850888
Bond Position:  [-18.65164479]


portfolio before change:  [-13.06299391]
curr_Stock_Price:  102.13246015598712
curr_Factors:  [102.13246016]
mat_Sqrt:  [[0.15]]
grads:  [-0.09851157]
Stock Position:  -0.09851156818605075
Bond Position:  [-3.0017651]


portfolio before change:  [-12.94767834]
curr_Stock_Price:  100.95426247284375
curr_Factors:  [100.95426247]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048569]
Stock Position:  -0.040485685399757006
Bond Position:  [-8.86047583]


portfolio before change:  [-12.99699206]
curr_Stock_Price:  102.11759515206778
curr_Factors:  [102.11759515]
mat_Sqrt:  [[0.15]]
grads:  [-0.15246578]
Stock Position:  -0.15246577803878986
Bond Position:  [2.57244653]


portfolio before change:  [-12.95941008]
curr_Stock_Price:  101.87531922217445
curr_Factors:  [101.87531922]
mat_Sqrt:  [[0.15]]
grads:  [0.01473192]
Stock Position:  0.014731924758270369
Bond Position:  [-14.46022962]


portfolio before change:  [-12.95633265]
curr_Stock_Price:  102.32963466594256
curr_Factors:  [102.32963467]
mat_Sqrt:  [[0.15]]
grads:  [0.0560682]
Stock Position:  0.056068199221480076
Bond Position:  [-18.69377099]


portfolio before change:  [-12.95845496]
curr_Stock_Price:  102.37514568895661
curr_Factors:  [102.37514569]
mat_Sqrt:  [[0.15]]
grads:  [0.02420766]
Stock Position:  0.024207656054938503
Bond Position:  [-15.43671727]


portfolio before change:  [-12.97928592]
curr_Stock_Price:  101.67407396291692
curr_Factors:  [101.67407396]
mat_Sqrt:  [[0.15]]
grads:  [0.04979339]
Stock Position:  0.0497933853352615
Bond Position:  [-18.04198226]


portfolio before change:  [-12.98182359]
curr_Stock_Price:  101.71370544088768
curr_Factors:  [101.71370544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02450916]
Stock Position:  -0.02450916072134692
Bond Position:  [-10.48890604]


portfolio before change:  [-12.99293759]
curr_Stock_Price:  102.06016536317561
curr_Factors:  [102.06016536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.99293759]
Stock Price:  101.47583327706643
PL:  [-14.46877087]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.54462003e-03]
 [ 1.04648252e-02]
 [ 8.59284682e-04]
 [ 1.13820672e-02]
 [ 2.51129571e-02]
 [ 6.77991778e-03]
 [ 3.44149051e-02]
 [ 5.20721413e-03]
 [ 8.70584529e-03]
 [-1.64890827e-02]
 [-1.09242301e-02]
 [-1.90085966e-02]
 [-2.08241718e-02]
 [ 4.50440694e-03]
 [ 3.10346242e-02]
 [ 2.22884426e-03]
 [ 7.50858571e-03]
 [-5.18712957e-03]
 [-1.18726161e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.14562614]
curr_Stock_Price:  100.28391101258201
curr_Factors:  [100.28391101]
mat_Sqrt:  [[0.15]]
grads:  [0.03696413]
Stock Position:  0.0369641335507525
Bond Position:  [2.43871826]


portfolio before change:  [6.12550547]
curr_Stock_Price:  99.72308564501967
curr_Factors:  [99.72308565]
mat_Sqrt:  [[0.15]]
grads:  [0.0697655]
Stock Position:  0.06976550157389057
Bond Position:  [-0.83172562]


portfolio before change:  [6.23039612]
curr_Stock_Price:  101.22954092362802
curr_Factors:  [101.22954092]
mat_Sqrt:  [[0.15]]
grads:  [0.00572856]
Stock Position:  0.005728564548081208
Bond Position:  [5.65049616]


portfolio before change:  [6.23029025]
curr_Stock_Price:  100.96443550381751
curr_Factors:  [100.9644355]
mat_Sqrt:  [[0.15]]
grads:  [0.07588045]
Stock Position:  0.07588044777079367
Bond Position:  [-1.43093633]


portfolio before change:  [6.31121619]
curr_Stock_Price:  102.03564316034499
curr_Factors:  [102.03564316]
mat_Sqrt:  [[0.15]]
grads:  [0.16741971]
Stock Position:  0.1674197139333845
Bond Position:  [-10.771562]


portfolio before change:  [6.38302404]
curr_Stock_Price:  102.4806390405557
curr_Factors:  [102.48063904]
mat_Sqrt:  [[0.15]]
grads:  [0.04519945]
Stock Position:  0.04519945189503494
Bond Position:  [1.75095533]


portfolio before change:  [6.41094949]
curr_Stock_Price:  103.08878036328588
curr_Factors:  [103.08878036]
mat_Sqrt:  [[0.15]]
grads:  [0.2294327]
Stock Position:  0.22943270066407248
Bond Position:  [-17.2409878]


portfolio before change:  [6.31468885]
curr_Stock_Price:  102.68800986656773
curr_Factors:  [102.68800987]
mat_Sqrt:  [[0.15]]
grads:  [0.03471476]
Stock Position:  0.03471476087745456
Bond Position:  [2.74989914]


portfolio before change:  [6.34452528]
curr_Stock_Price:  103.5276778372564
curr_Factors:  [103.52767784]
mat_Sqrt:  [[0.15]]
grads:  [0.05803897]
Stock Position:  0.05803896861895165
Bond Position:  [0.33588564]


portfolio before change:  [6.43169037]
curr_Stock_Price:  105.02806820670034
curr_Factors:  [105.02806821]
mat_Sqrt:  [[0.15]]
grads:  [-0.10992722]
Stock Position:  -0.10992721797534763
Bond Position:  [17.97713372]


portfolio before change:  [6.49089331]
curr_Stock_Price:  104.53039263478288
curr_Factors:  [104.53039263]
mat_Sqrt:  [[0.15]]
grads:  [-0.0728282]
Stock Position:  -0.072828200371396
Bond Position:  [14.10365369]


portfolio before change:  [6.48559086]
curr_Stock_Price:  104.65162049806315
curr_Factors:  [104.6516205]
mat_Sqrt:  [[0.15]]
grads:  [-0.12672398]
Stock Position:  -0.12672397717271075
Bond Position:  [19.74746042]


portfolio before change:  [6.58265788]
curr_Stock_Price:  103.92461093259631
curr_Factors:  [103.92461093]
mat_Sqrt:  [[0.15]]
grads:  [-0.13882781]
Stock Position:  -0.13882781167612063
Bond Position:  [21.0102842]


portfolio before change:  [6.50383821]
curr_Stock_Price:  104.5302021521793
curr_Factors:  [104.53020215]
mat_Sqrt:  [[0.15]]
grads:  [0.03002938]
Stock Position:  0.03002937960417217
Bond Position:  [3.36486108]


portfolio before change:  [6.51983115]
curr_Stock_Price:  105.03476231932916
curr_Factors:  [105.03476232]
mat_Sqrt:  [[0.15]]
grads:  [0.20689749]
Stock Position:  0.20689749453230485
Bond Position:  [-15.21159801]


portfolio before change:  [6.16950197]
curr_Stock_Price:  103.35989519195826
curr_Factors:  [103.35989519]
mat_Sqrt:  [[0.15]]
grads:  [0.01485896]
Stock Position:  0.014858961711549911
Bond Position:  [4.63368124]


portfolio before change:  [6.16208211]
curr_Stock_Price:  102.78257172535758
curr_Factors:  [102.78257173]
mat_Sqrt:  [[0.15]]
grads:  [0.05005724]
Stock Position:  0.05005723807396399
Bond Position:  [1.01707044]


portfolio before change:  [6.21216427]
curr_Stock_Price:  103.7779894973743
curr_Factors:  [103.7779895]
mat_Sqrt:  [[0.15]]
grads:  [-0.03458086]
Stock Position:  -0.03458086379721676
Bond Position:  [9.80089679]


portfolio before change:  [6.26153079]
curr_Stock_Price:  102.42128560635057
curr_Factors:  [102.42128561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.26153079]
Stock Price:  102.12512809113665
PL:  [4.1364027]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.20341776e-02]
 [ 7.29916805e-03]
 [ 1.83613823e-03]
 [ 1.54608005e-02]
 [ 2.47304847e-02]
 [ 6.95408225e-03]
 [ 3.23656212e-02]
 [ 9.68034801e-03]
 [ 6.91911880e-03]
 [ 9.24200402e-03]
 [-1.64332830e-02]
 [-8.56368434e-03]
 [-2.15349149e-02]
 [ 2.20827123e-03]
 [ 2.70707595e-03]
 [ 4.28029604e-03]
 [ 7.48518359e-03]
 [-4.73967184e-03]
 [-1.18862175e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.500198]
curr_Stock_Price:  101.9287727366063
curr_Factors:  [101.92877274]
mat_Sqrt:  [[0.15]]
grads:  [0.14689452]
Stock Position:  0.1468945171390351
Bond Position:  [16.52742015]


portfolio before change:  [31.67760518]
curr_Stock_Price:  103.10835933780838
curr_Factors:  [103.10835934]
mat_Sqrt:  [[0.15]]
grads:  [0.04866112]
Stock Position:  0.04866112032372221
Bond Position:  [26.6602369]


portfolio before change:  [31.67039561]
curr_Stock_Price:  102.82321478017747
curr_Factors:  [102.82321478]
mat_Sqrt:  [[0.15]]
grads:  [0.01224092]
Stock Position:  0.012240921524633857
Bond Position:  [30.41174471]


portfolio before change:  [31.67942856]
curr_Stock_Price:  102.93995948793605
curr_Factors:  [102.93995949]
mat_Sqrt:  [[0.15]]
grads:  [0.103072]
Stock Position:  0.10307200349514335
Bond Position:  [21.0692007]


portfolio before change:  [31.70678166]
curr_Stock_Price:  103.15422847824938
curr_Factors:  [103.15422848]
mat_Sqrt:  [[0.15]]
grads:  [0.1648699]
Stock Position:  0.16486989804352012
Bond Position:  [14.69975452]


portfolio before change:  [31.52247543]
curr_Stock_Price:  102.0140468595744
curr_Factors:  [102.01404686]
mat_Sqrt:  [[0.15]]
grads:  [0.04636055]
Stock Position:  0.04636054834165002
Bond Position:  [26.79304828]


portfolio before change:  [31.52423884]
curr_Stock_Price:  101.90758380010726
curr_Factors:  [101.9075838]
mat_Sqrt:  [[0.15]]
grads:  [0.21577081]
Stock Position:  0.21577080790050118
Bond Position:  [9.53555715]


portfolio before change:  [31.5187005]
curr_Stock_Price:  101.87086647863929
curr_Factors:  [101.87086648]
mat_Sqrt:  [[0.15]]
grads:  [0.06453565]
Stock Position:  0.06453565342293724
Bond Position:  [24.94439757]


portfolio before change:  [31.55108172]
curr_Stock_Price:  102.27598120806574
curr_Factors:  [102.27598121]
mat_Sqrt:  [[0.15]]
grads:  [0.04612746]
Stock Position:  0.04612745863535062
Bond Position:  [26.83335063]


portfolio before change:  [31.51106509]
curr_Stock_Price:  101.26300948520252
curr_Factors:  [101.26300949]
mat_Sqrt:  [[0.15]]
grads:  [0.06161336]
Stock Position:  0.06161336014838654
Bond Position:  [25.27191082]


portfolio before change:  [31.4928273]
curr_Stock_Price:  100.86445043939216
curr_Factors:  [100.86445044]
mat_Sqrt:  [[0.15]]
grads:  [-0.10955522]
Stock Position:  -0.1095552201981715
Bond Position:  [42.54305437]


portfolio before change:  [31.4594157]
curr_Stock_Price:  101.26651876580193
curr_Factors:  [101.26651877]
mat_Sqrt:  [[0.15]]
grads:  [-0.05709123]
Stock Position:  -0.057091228922417706
Bond Position:  [37.24084571]


portfolio before change:  [31.36778363]
curr_Stock_Price:  103.03462667246777
curr_Factors:  [103.03462667]
mat_Sqrt:  [[0.15]]
grads:  [-0.1435661]
Stock Position:  -0.14356609938456355
Bond Position:  [46.16006308]


portfolio before change:  [31.54612715]
curr_Stock_Price:  101.87277812677166
curr_Factors:  [101.87277813]
mat_Sqrt:  [[0.15]]
grads:  [0.01472181]
Stock Position:  0.014721808209138104
Bond Position:  [30.04637565]


portfolio before change:  [31.54875836]
curr_Stock_Price:  101.54120742112701
curr_Factors:  [101.54120742]
mat_Sqrt:  [[0.15]]
grads:  [0.01804717]
Stock Position:  0.018047172967315478
Bond Position:  [29.71622663]


portfolio before change:  [31.5667895]
curr_Stock_Price:  102.12862071826552
curr_Factors:  [102.12862072]
mat_Sqrt:  [[0.15]]
grads:  [0.02853531]
Stock Position:  0.028535306909635398
Bond Position:  [28.65251796]


portfolio before change:  [31.57391085]
curr_Stock_Price:  102.12712524277202
curr_Factors:  [102.12712524]
mat_Sqrt:  [[0.15]]
grads:  [0.04990122]
Stock Position:  0.04990122391194859
Bond Position:  [26.4776423]


portfolio before change:  [31.60318247]
curr_Stock_Price:  102.58104957746716
curr_Factors:  [102.58104958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03159781]
Stock Position:  -0.0315978122400916
Bond Position:  [34.84451921]


portfolio before change:  [31.61812557]
curr_Stock_Price:  102.38385589734294
curr_Factors:  [102.3838559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.61812557]
Stock Price:  102.64545486319533
PL:  [28.97267071]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.69231464e-03]
 [ 9.88185466e-03]
 [ 1.55808533e-03]
 [ 1.40925058e-02]
 [ 1.94009204e-02]
 [ 3.30330729e-03]
 [-1.04056494e-02]
 [ 1.25361033e-02]
 [ 2.99888395e-03]
 [ 1.09881348e-02]
 [-1.67820373e-02]
 [-8.65005309e-03]
 [-2.13672703e-02]
 [ 3.01458357e-03]
 [ 1.12261160e-03]
 [ 5.11276145e-03]
 [ 7.48522386e-03]
 [-3.20215318e-03]
 [-1.28399414e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.83250436]
curr_Stock_Price:  99.83120923475383
curr_Factors:  [99.83120923]
mat_Sqrt:  [[0.15]]
grads:  [0.0112821]
Stock Position:  0.011282097579604761
Bond Position:  [-1.9588098]


portfolio before change:  [-0.83711531]
curr_Stock_Price:  99.4659232169092
curr_Factors:  [99.46592322]
mat_Sqrt:  [[0.15]]
grads:  [0.06587903]
Stock Position:  0.0658790310730589
Bond Position:  [-7.38983396]


portfolio before change:  [-0.65357441]
curr_Stock_Price:  102.27999915882387
curr_Factors:  [102.27999916]
mat_Sqrt:  [[0.15]]
grads:  [0.01038724]
Stock Position:  0.010387235512639814
Bond Position:  [-1.71598085]


portfolio before change:  [-0.65920434]
curr_Stock_Price:  101.77929944217387
curr_Factors:  [101.77929944]
mat_Sqrt:  [[0.15]]
grads:  [0.09395004]
Stock Position:  0.09395003848027994
Bond Position:  [-10.22137344]


portfolio before change:  [-0.7225113]
curr_Stock_Price:  101.13266538439746
curr_Factors:  [101.13266538]
mat_Sqrt:  [[0.15]]
grads:  [0.12933947]
Stock Position:  0.12933946929461798
Bond Position:  [-13.80295657]


portfolio before change:  [-0.82438713]
curr_Stock_Price:  100.37168605116956
curr_Factors:  [100.37168605]
mat_Sqrt:  [[0.15]]
grads:  [0.02202205]
Stock Position:  0.022022048572842307
Bond Position:  [-3.03477728]


portfolio before change:  [-0.86299307]
curr_Stock_Price:  98.65308363151587
curr_Factors:  [98.65308363]
mat_Sqrt:  [[0.15]]
grads:  [-0.069371]
Stock Position:  -0.06937099569439133
Bond Position:  [5.98066957]


portfolio before change:  [-0.94260289]
curr_Stock_Price:  99.82223476070752
curr_Factors:  [99.82223476]
mat_Sqrt:  [[0.15]]
grads:  [0.08357402]
Stock Position:  0.08357402220738261
Bond Position:  [-9.28514856]


portfolio before change:  [-0.97096097]
curr_Stock_Price:  99.5106965428485
curr_Factors:  [99.51069654]
mat_Sqrt:  [[0.15]]
grads:  [0.01999256]
Stock Position:  0.01999255967175632
Bond Position:  [-2.96043451]


portfolio before change:  [-0.97273883]
curr_Stock_Price:  99.45879408591554
curr_Factors:  [99.45879409]
mat_Sqrt:  [[0.15]]
grads:  [0.07325423]
Stock Position:  0.07325423218966944
Bond Position:  [-8.25851643]


portfolio before change:  [-0.8984639]
curr_Stock_Price:  100.50091568795581
curr_Factors:  [100.50091569]
mat_Sqrt:  [[0.15]]
grads:  [-0.11188025]
Stock Position:  -0.11188024861423183
Bond Position:  [10.34560353]


portfolio before change:  [-0.98730269]
curr_Stock_Price:  101.31808858683748
curr_Factors:  [101.31808859]
mat_Sqrt:  [[0.15]]
grads:  [-0.05766702]
Stock Position:  -0.05766702058930143
Bond Position:  [4.85540961]


portfolio before change:  [-1.09718193]
curr_Stock_Price:  103.24454931451619
curr_Factors:  [103.24454931]
mat_Sqrt:  [[0.15]]
grads:  [-0.14244847]
Stock Position:  -0.1424484685239928
Bond Position:  [13.609846]


portfolio before change:  [-1.03506143]
curr_Stock_Price:  102.83234678973645
curr_Factors:  [102.83234679]
mat_Sqrt:  [[0.15]]
grads:  [0.02009722]
Stock Position:  0.02009722379976833
Bond Position:  [-3.10170611]


portfolio before change:  [-1.06529432]
curr_Stock_Price:  101.36660355317248
curr_Factors:  [101.36660355]
mat_Sqrt:  [[0.15]]
grads:  [0.00748408]
Stock Position:  0.0074840773306850015
Bond Position:  [-1.82392982]


portfolio before change:  [-1.0623859]
curr_Stock_Price:  101.81615268886796
curr_Factors:  [101.81615269]
mat_Sqrt:  [[0.15]]
grads:  [0.03408508]
Stock Position:  0.034085076300603145
Bond Position:  [-4.53279723]


portfolio before change:  [-1.08640593]
curr_Stock_Price:  101.14469482301872
curr_Factors:  [101.14469482]
mat_Sqrt:  [[0.15]]
grads:  [0.04990149]
Stock Position:  0.04990149238269677
Bond Position:  [-6.13367715]


portfolio before change:  [-1.08067369]
curr_Stock_Price:  101.29029868711036
curr_Factors:  [101.29029869]
mat_Sqrt:  [[0.15]]
grads:  [-0.02134769]
Stock Position:  -0.02134768783413303
Bond Position:  [1.08163998]


portfolio before change:  [-1.05198675]
curr_Stock_Price:  99.95917073820338
curr_Factors:  [99.95917074]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.05198675]
Stock Price:  99.5124630990444
PL:  [-1.05198675]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.06640840e-03]
 [ 6.08370523e-03]
 [ 5.62499612e-04]
 [ 1.98762574e-03]
 [ 1.39748037e-03]
 [ 4.72275011e-03]
 [-5.26972286e-03]
 [ 9.76818099e-03]
 [ 2.91185678e-03]
 [ 9.07512943e-03]
 [-1.43194302e-02]
 [-5.90518670e-03]
 [-2.57864086e-02]
 [ 2.09738021e-03]
 [ 4.81829784e-03]
 [ 3.19666417e-03]
 [ 7.33285715e-03]
 [-4.66985835e-03]
 [-1.23683676e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.1492397]
curr_Stock_Price:  99.74578686658751
curr_Factors:  [99.74578687]
mat_Sqrt:  [[0.15]]
grads:  [0.00710939]
Stock Position:  0.007109389317679041
Bond Position:  [-2.85837134]


portfolio before change:  [-2.15723944]
curr_Stock_Price:  98.72107829976254
curr_Factors:  [98.7210783]
mat_Sqrt:  [[0.15]]
grads:  [0.04055803]
Stock Position:  0.04055803483461673
Bond Position:  [-6.16117237]


portfolio before change:  [-2.14512358]
curr_Stock_Price:  99.05778948474182
curr_Factors:  [99.05778948]
mat_Sqrt:  [[0.15]]
grads:  [0.00375]
Stock Position:  0.0037499974148657786
Bond Position:  [-2.51659003]


portfolio before change:  [-2.14768073]
curr_Stock_Price:  98.54367521955533
curr_Factors:  [98.54367522]
mat_Sqrt:  [[0.15]]
grads:  [0.01325084]
Stock Position:  0.013250838245488136
Bond Position:  [-3.45346703]


portfolio before change:  [-2.14936274]
curr_Stock_Price:  98.48190284233918
curr_Factors:  [98.48190284]
mat_Sqrt:  [[0.15]]
grads:  [0.00931654]
Stock Position:  0.00931653580801852
Bond Position:  [-3.06687292]


portfolio before change:  [-2.1488085]
curr_Stock_Price:  98.62369956200156
curr_Factors:  [98.62369956]
mat_Sqrt:  [[0.15]]
grads:  [0.031485]
Stock Position:  0.0314850007631361
Bond Position:  [-5.25397576]


portfolio before change:  [-2.19355706]
curr_Stock_Price:  97.24415689419544
curr_Factors:  [97.24415689]
mat_Sqrt:  [[0.15]]
grads:  [-0.03513149]
Stock Position:  -0.03513148576426345
Bond Position:  [1.22277465]


portfolio before change:  [-2.22443174]
curr_Stock_Price:  98.1316915639545
curr_Factors:  [98.13169156]
mat_Sqrt:  [[0.15]]
grads:  [0.06512121]
Stock Position:  0.06512120660315181
Bond Position:  [-8.6148859]


portfolio before change:  [-2.133695]
curr_Stock_Price:  99.55811995032848
curr_Factors:  [99.55811995]
mat_Sqrt:  [[0.15]]
grads:  [0.01941238]
Stock Position:  0.01941237852715365
Bond Position:  [-4.06635491]


portfolio before change:  [-2.10492535]
curr_Stock_Price:  101.0925201355823
curr_Factors:  [101.09252014]
mat_Sqrt:  [[0.15]]
grads:  [0.06050086]
Stock Position:  0.0605008628897969
Bond Position:  [-8.22111005]


portfolio before change:  [-2.02531758]
curr_Stock_Price:  102.4423076045702
curr_Factors:  [102.4423076]
mat_Sqrt:  [[0.15]]
grads:  [-0.09546287]
Stock Position:  -0.09546286822715909
Bond Position:  [7.75411893]


portfolio before change:  [-1.87964821]
curr_Stock_Price:  100.93668972007363
curr_Factors:  [100.93668972]
mat_Sqrt:  [[0.15]]
grads:  [-0.03936791]
Stock Position:  -0.03936791135683022
Bond Position:  [2.09401844]


portfolio before change:  [-1.87951453]
curr_Stock_Price:  100.94659357415267
curr_Factors:  [100.94659357]
mat_Sqrt:  [[0.15]]
grads:  [-0.17190939]
Stock Position:  -0.17190939091262258
Bond Position:  [15.47415288]


portfolio before change:  [-1.84756375]
curr_Stock_Price:  100.78324144180937
curr_Factors:  [100.78324144]
mat_Sqrt:  [[0.15]]
grads:  [0.01398253]
Stock Position:  0.013982534738380757
Bond Position:  [-3.25676892]


portfolio before change:  [-1.83289453]
curr_Stock_Price:  101.89058811855861
curr_Factors:  [101.89058812]
mat_Sqrt:  [[0.15]]
grads:  [0.03212199]
Stock Position:  0.03212198560977181
Bond Position:  [-5.10582253]


portfolio before change:  [-1.81200547]
curr_Stock_Price:  102.58063481899028
curr_Factors:  [102.58063482]
mat_Sqrt:  [[0.15]]
grads:  [0.02131109]
Stock Position:  0.021311094476490385
Bond Position:  [-3.99811107]


portfolio before change:  [-1.79566328]
curr_Stock_Price:  103.39438193911532
curr_Factors:  [103.39438194]
mat_Sqrt:  [[0.15]]
grads:  [0.04888571]
Stock Position:  0.04888571436575211
Bond Position:  [-6.8501715]


portfolio before change:  [-1.84013474]
curr_Stock_Price:  102.51971534334419
curr_Factors:  [102.51971534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03113239]
Stock Position:  -0.031132389022029406
Bond Position:  [1.35154892]


portfolio before change:  [-1.79949527]
curr_Stock_Price:  101.22519394393613
curr_Factors:  [101.22519394]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.79949527]
Stock Price:  100.97542155380778
PL:  [-2.77491682]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.12757842e-02]
 [ 8.08749909e-03]
 [-1.63071961e-03]
 [ 1.93801983e-03]
 [ 3.22336944e-03]
 [ 4.71888213e-03]
 [-3.71880732e-03]
 [ 3.35173588e-03]
 [ 4.66732812e-03]
 [ 8.53112787e-04]
 [-1.75918339e-02]
 [ 6.18519972e-03]
 [ 7.50884905e-03]
 [-4.57613121e-03]
 [-1.59442895e-02]
 [ 6.52260282e-03]
 [ 2.91924504e-03]
 [-2.99793497e-03]
 [-1.20887267e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.47025221]
curr_Stock_Price:  99.20596647210691
curr_Factors:  [99.20596647]
mat_Sqrt:  [[0.15]]
grads:  [0.07517189]
Stock Position:  0.07517189496806607
Bond Position:  [-17.92775271]


portfolio before change:  [-10.48052155]
curr_Stock_Price:  99.12898502406458
curr_Factors:  [99.12898502]
mat_Sqrt:  [[0.15]]
grads:  [0.05391666]
Stock Position:  0.05391666057449524
Bond Position:  [-15.82522539]


portfolio before change:  [-10.54039257]
curr_Stock_Price:  98.09193603760409
curr_Factors:  [98.09193604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01087146]
Stock Position:  -0.010871464062141374
Bond Position:  [-9.47398962]


portfolio before change:  [-10.54736395]
curr_Stock_Price:  98.5152997921895
curr_Factors:  [98.51529979]
mat_Sqrt:  [[0.15]]
grads:  [0.01292013]
Stock Position:  0.012920132189613843
Bond Position:  [-11.82019465]


portfolio before change:  [-10.54224696]
curr_Stock_Price:  99.14009298439633
curr_Factors:  [99.14009298]
mat_Sqrt:  [[0.15]]
grads:  [0.02148913]
Stock Position:  0.021489129569721255
Bond Position:  [-12.67268126]


portfolio before change:  [-10.55509488]
curr_Stock_Price:  98.68966269712996
curr_Factors:  [98.6896627]
mat_Sqrt:  [[0.15]]
grads:  [0.03145921]
Stock Position:  0.03145921421112368
Bond Position:  [-13.65979412]


portfolio before change:  [-10.62287057]
curr_Stock_Price:  96.64382903984813
curr_Factors:  [96.64382904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02479205]
Stock Position:  -0.02479204882134582
Bond Position:  [-8.22687205]


portfolio before change:  [-10.61229141]
curr_Stock_Price:  96.1341437388581
curr_Factors:  [96.13414374]
mat_Sqrt:  [[0.15]]
grads:  [0.02234491]
Stock Position:  0.022344905849298234
Bond Position:  [-12.7603998]


portfolio before change:  [-10.59446117]
curr_Stock_Price:  97.07488329578747
curr_Factors:  [97.0748833]
mat_Sqrt:  [[0.15]]
grads:  [0.03111552]
Stock Position:  0.031115520786210982
Bond Position:  [-13.61499672]


portfolio before change:  [-10.59504288]
curr_Stock_Price:  97.16559228979864
curr_Factors:  [97.16559229]
mat_Sqrt:  [[0.15]]
grads:  [0.00568742]
Stock Position:  0.00568741857713214
Bond Position:  [-11.14766428]


portfolio before change:  [-10.60642231]
curr_Stock_Price:  95.65486097898247
curr_Factors:  [95.65486098]
mat_Sqrt:  [[0.15]]
grads:  [-0.11727889]
Stock Position:  -0.11727889239227969
Bond Position:  [0.61187384]


portfolio before change:  [-10.72033557]
curr_Stock_Price:  96.62746775931133
curr_Factors:  [96.62746776]
mat_Sqrt:  [[0.15]]
grads:  [0.04123466]
Stock Position:  0.04123466482351119
Bond Position:  [-14.70473681]


portfolio before change:  [-10.75188715]
curr_Stock_Price:  95.95146050787731
curr_Factors:  [95.95146051]
mat_Sqrt:  [[0.15]]
grads:  [0.05005899]
Stock Position:  0.05005899367554923
Bond Position:  [-15.5551207]


portfolio before change:  [-10.86546641]
curr_Stock_Price:  93.76024579589398
curr_Factors:  [93.7602458]
mat_Sqrt:  [[0.15]]
grads:  [-0.03050754]
Stock Position:  -0.030507541412229406
Bond Position:  [-8.00507183]


portfolio before change:  [-10.86170453]
curr_Stock_Price:  93.57132859840037
curr_Factors:  [93.5713286]
mat_Sqrt:  [[0.15]]
grads:  [-0.10629526]
Stock Position:  -0.10629526327493621
Bond Position:  [-0.91551553]


portfolio before change:  [-11.03939199]
curr_Stock_Price:  95.24081551444004
curr_Factors:  [95.24081551]
mat_Sqrt:  [[0.15]]
grads:  [0.04348402]
Stock Position:  0.043484018768356475
Bond Position:  [-15.1808454]


portfolio before change:  [-11.0528259]
curr_Stock_Price:  95.01916588009775
curr_Factors:  [95.01916588]
mat_Sqrt:  [[0.15]]
grads:  [0.01946163]
Stock Position:  0.019461633619346348
Bond Position:  [-12.90205409]


portfolio before change:  [-11.03704577]
curr_Stock_Price:  95.99575638284757
curr_Factors:  [95.99575638]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998623]
Stock Position:  -0.019986233117817623
Bond Position:  [-9.1184522]


portfolio before change:  [-11.02259584]
curr_Stock_Price:  95.15868901351534
curr_Factors:  [95.15868901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.02259584]
Stock Price:  94.02300890318799
PL:  [-11.02259584]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.13190224e-03]
 [ 8.72234071e-03]
 [ 1.26677708e-03]
 [ 2.95763091e-03]
 [ 9.57243731e-03]
 [ 3.38744266e-03]
 [ 1.34941133e-02]
 [ 1.33637495e-02]
 [ 2.95569406e-03]
 [ 8.19718066e-03]
 [-1.74640165e-02]
 [ 6.29116690e-03]
 [-2.42421697e-02]
 [ 3.45977919e-03]
 [-1.37422496e-02]
 [ 7.80633665e-03]
 [ 7.45305895e-03]
 [-1.68845790e-03]
 [-1.28452574e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.01145859]
curr_Stock_Price:  99.75472532878238
curr_Factors:  [99.75472533]
mat_Sqrt:  [[0.15]]
grads:  [0.00754601]
Stock Position:  0.007546014944550215
Bond Position:  [-2.76420924]


portfolio before change:  [-2.00944707]
curr_Stock_Price:  100.11288180003967
curr_Factors:  [100.1128818]
mat_Sqrt:  [[0.15]]
grads:  [0.05814894]
Stock Position:  0.05814893807733007
Bond Position:  [-7.83090484]


portfolio before change:  [-2.05056663]
curr_Stock_Price:  99.4394113797547
curr_Factors:  [99.43941138]
mat_Sqrt:  [[0.15]]
grads:  [0.00844518]
Stock Position:  0.008445180511894053
Bond Position:  [-2.89035041]


portfolio before change:  [-2.05187464]
curr_Stock_Price:  99.37010196092398
curr_Factors:  [99.37010196]
mat_Sqrt:  [[0.15]]
grads:  [0.01971754]
Stock Position:  0.019717539386623816
Bond Position:  [-4.01120854]


portfolio before change:  [-2.03687862]
curr_Stock_Price:  100.18150876460061
curr_Factors:  [100.18150876]
mat_Sqrt:  [[0.15]]
grads:  [0.06381625]
Stock Position:  0.06381624874442625
Bond Position:  [-8.43008671]


portfolio before change:  [-2.02023946]
curr_Stock_Price:  100.47527320414963
curr_Factors:  [100.4752732]
mat_Sqrt:  [[0.15]]
grads:  [0.02258295]
Stock Position:  0.022582951097958968
Bond Position:  [-4.28926765]


portfolio before change:  [-2.01762001]
curr_Stock_Price:  100.63875507296223
curr_Factors:  [100.63875507]
mat_Sqrt:  [[0.15]]
grads:  [0.08996076]
Stock Position:  0.0899607550774049
Bond Position:  [-11.07115841]


portfolio before change:  [-2.02469016]
curr_Stock_Price:  100.59093409996372
curr_Factors:  [100.5909341]
mat_Sqrt:  [[0.15]]
grads:  [0.08909166]
Stock Position:  0.08909166356950221
Bond Position:  [-10.98650382]


portfolio before change:  [-2.07700794]
curr_Stock_Price:  100.03453173792144
curr_Factors:  [100.03453174]
mat_Sqrt:  [[0.15]]
grads:  [0.01970463]
Stock Position:  0.019704627091110625
Bond Position:  [-4.04815108]


portfolio before change:  [-2.07005987]
curr_Stock_Price:  100.43850966305294
curr_Factors:  [100.43850966]
mat_Sqrt:  [[0.15]]
grads:  [0.05464787]
Stock Position:  0.054647871087254024
Bond Position:  [-7.5588106]


portfolio before change:  [-2.10185058]
curr_Stock_Price:  99.89135627294661
curr_Factors:  [99.89135627]
mat_Sqrt:  [[0.15]]
grads:  [-0.11642678]
Stock Position:  -0.11642677665321506
Bond Position:  [9.52817805]


portfolio before change:  [-2.00365761]
curr_Stock_Price:  99.06843027052219
curr_Factors:  [99.06843027]
mat_Sqrt:  [[0.15]]
grads:  [0.04194111]
Stock Position:  0.04194111268539021
Bond Position:  [-6.15869781]


portfolio before change:  [-1.90631007]
curr_Stock_Price:  101.42619816862539
curr_Factors:  [101.42619817]
mat_Sqrt:  [[0.15]]
grads:  [-0.16161446]
Stock Position:  -0.16161446471805282
Bond Position:  [14.48563065]


portfolio before change:  [-1.67936506]
curr_Stock_Price:  100.04437166574172
curr_Factors:  [100.04437167]
mat_Sqrt:  [[0.15]]
grads:  [0.02306519]
Stock Position:  0.0230651946294241
Bond Position:  [-3.98690796]


portfolio before change:  [-1.69429508]
curr_Stock_Price:  99.44029384650725
curr_Factors:  [99.44029385]
mat_Sqrt:  [[0.15]]
grads:  [-0.091615]
Stock Position:  -0.09161499747533024
Bond Position:  [7.41592719]


portfolio before change:  [-1.77072938]
curr_Stock_Price:  100.2948319740723
curr_Factors:  [100.29483197]
mat_Sqrt:  [[0.15]]
grads:  [0.05204224]
Stock Position:  0.05204224436636796
Bond Position:  [-6.99029753]


portfolio before change:  [-1.79602751]
curr_Stock_Price:  99.84230844886557
curr_Factors:  [99.84230845]
mat_Sqrt:  [[0.15]]
grads:  [0.04968706]
Stock Position:  0.04968705969308375
Bond Position:  [-6.75689825]


portfolio before change:  [-1.84519191]
curr_Stock_Price:  98.88682912146567
curr_Factors:  [98.88682912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01125639]
Stock Position:  -0.011256386023828318
Bond Position:  [-0.73208358]


portfolio before change:  [-1.85461118]
curr_Stock_Price:  99.70736202714929
curr_Factors:  [99.70736203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.85461118]
Stock Price:  99.61125445782541
PL:  [-1.85461118]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.95784738e-03]
 [ 6.26001993e-03]
 [ 1.28991408e-03]
 [ 2.35236222e-03]
 [-1.43098191e-03]
 [-6.21553097e-03]
 [ 6.08649704e-03]
 [-1.30763121e-02]
 [ 4.36616142e-03]
 [-2.41151491e-02]
 [-1.74944242e-02]
 [ 6.73155680e-03]
 [ 6.78111855e-03]
 [-2.17790240e-03]
 [-1.65028870e-02]
 [ 6.44731026e-03]
 [ 1.50584347e-03]
 [-6.23530188e-03]
 [-1.15019243e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.07371324]
curr_Stock_Price:  99.88999952503828
curr_Factors:  [99.88999953]
mat_Sqrt:  [[0.15]]
grads:  [0.01305232]
Stock Position:  0.01305231587599977
Bond Position:  [-1.23008259]


portfolio before change:  [0.08533267]
curr_Stock_Price:  100.80378270629119
curr_Factors:  [100.80378271]
mat_Sqrt:  [[0.15]]
grads:  [0.04173347]
Stock Position:  0.041733466196463696
Bond Position:  [-4.12155859]


portfolio before change:  [0.05333278]
curr_Stock_Price:  100.06170761571268
curr_Factors:  [100.06170762]
mat_Sqrt:  [[0.15]]
grads:  [0.00859943]
Stock Position:  0.008599427169379762
Bond Position:  [-0.80714058]


portfolio before change:  [0.04187091]
curr_Stock_Price:  98.75231072000116
curr_Factors:  [98.75231072]
mat_Sqrt:  [[0.15]]
grads:  [0.01568241]
Stock Position:  0.015682414784520805
Bond Position:  [-1.50680379]


portfolio before change:  [0.01674385]
curr_Stock_Price:  97.1740901013324
curr_Factors:  [97.1740901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00953988]
Stock Position:  -0.00953987940642247
Bond Position:  [0.94377295]


portfolio before change:  [0.04526922]
curr_Stock_Price:  94.20870713860495
curr_Factors:  [94.20870714]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143687]
Stock Position:  -0.04143687315679297
Bond Position:  [3.94898347]


portfolio before change:  [0.06677477]
curr_Stock_Price:  93.71353995462546
curr_Factors:  [93.71353995]
mat_Sqrt:  [[0.15]]
grads:  [0.04057665]
Stock Position:  0.04057664696190293
Bond Position:  [-3.73580646]


portfolio before change:  [0.01409991]
curr_Stock_Price:  92.43840274127139
curr_Factors:  [92.43840274]
mat_Sqrt:  [[0.15]]
grads:  [-0.08717541]
Stock Position:  -0.08717541406545624
Bond Position:  [8.07245594]


portfolio before change:  [-0.0371644]
curr_Stock_Price:  93.04961489943415
curr_Factors:  [93.0496149]
mat_Sqrt:  [[0.15]]
grads:  [0.02910774]
Stock Position:  0.029107742776777204
Bond Position:  [-2.74562865]


portfolio before change:  [-0.01464852]
curr_Stock_Price:  93.84673502762054
curr_Factors:  [93.84673503]
mat_Sqrt:  [[0.15]]
grads:  [-0.16076766]
Stock Position:  -0.16076766036706183
Bond Position:  [15.0728715]


portfolio before change:  [-0.14845996]
curr_Stock_Price:  94.70250491818484
curr_Factors:  [94.70250492]
mat_Sqrt:  [[0.15]]
grads:  [-0.11662949]
Stock Position:  -0.11662949475019356
Bond Position:  [10.89664534]


portfolio before change:  [-0.32025345]
curr_Stock_Price:  96.19885020704507
curr_Factors:  [96.19885021]
mat_Sqrt:  [[0.15]]
grads:  [0.04487705]
Stock Position:  0.044877045304997885
Bond Position:  [-4.63737361]


portfolio before change:  [-0.32849537]
curr_Stock_Price:  96.0410316514773
curr_Factors:  [96.04103165]
mat_Sqrt:  [[0.15]]
grads:  [0.04520746]
Stock Position:  0.04520745700679163
Bond Position:  [-4.67026618]


portfolio before change:  [-0.31508257]
curr_Stock_Price:  96.36355603348393
curr_Factors:  [96.36355603]
mat_Sqrt:  [[0.15]]
grads:  [-0.01451935]
Stock Position:  -0.014519349362221174
Bond Position:  [1.08405356]


portfolio before change:  [-0.30304415]
curr_Stock_Price:  95.5530941341169
curr_Factors:  [95.55309413]
mat_Sqrt:  [[0.15]]
grads:  [-0.11001925]
Stock Position:  -0.11001924695465994
Bond Position:  [10.20963531]


portfolio before change:  [-0.2114094]
curr_Stock_Price:  94.74339923260435
curr_Factors:  [94.74339923]
mat_Sqrt:  [[0.15]]
grads:  [0.04298207]
Stock Position:  0.042982068384127714
Bond Position:  [-4.28367666]


portfolio before change:  [-0.31257414]
curr_Stock_Price:  92.41466781448322
curr_Factors:  [92.41466781]
mat_Sqrt:  [[0.15]]
grads:  [0.01003896]
Stock Position:  0.010038956434294533
Bond Position:  [-1.24032097]


portfolio before change:  [-0.3168642]
curr_Stock_Price:  92.0182183341665
curr_Factors:  [92.01821833]
mat_Sqrt:  [[0.15]]
grads:  [-0.04156868]
Stock Position:  -0.041568679184904825
Bond Position:  [3.5082116]


portfolio before change:  [-0.37740009]
curr_Stock_Price:  93.49560594499975
curr_Factors:  [93.49560594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.37740009]
Stock Price:  91.76941758229067
PL:  [-0.37740009]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.83087439e-03]
 [ 1.05090365e-02]
 [-1.77135311e-03]
 [-1.45185991e-03]
 [-1.83072225e-03]
 [-3.71454101e-03]
 [ 1.03323350e-03]
 [ 7.71779730e-03]
 [ 4.72097476e-03]
 [ 1.30087303e-02]
 [-1.81543315e-02]
 [ 6.29285437e-03]
 [-2.41283439e-02]
 [ 2.92447331e-03]
 [-5.77881337e-03]
 [ 7.00549498e-03]
 [ 7.46617482e-03]
 [-3.30266983e-03]
 [-1.17618258e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.36407467]
curr_Stock_Price:  101.01170072612682
curr_Factors:  [101.01170073]
mat_Sqrt:  [[0.15]]
grads:  [0.06553916]
Stock Position:  0.06553916261999769
Bond Position:  [10.74385239]


portfolio before change:  [17.2806175]
curr_Stock_Price:  99.69731907171602
curr_Factors:  [99.69731907]
mat_Sqrt:  [[0.15]]
grads:  [0.07006024]
Stock Position:  0.07006024360623557
Bond Position:  [10.29579903]


portfolio before change:  [17.16448939]
curr_Stock_Price:  98.00302902029037
curr_Factors:  [98.00302902]
mat_Sqrt:  [[0.15]]
grads:  [-0.01180902]
Stock Position:  -0.011809020704354497
Bond Position:  [18.32180919]


portfolio before change:  [17.18591951]
curr_Stock_Price:  96.57623064853445
curr_Factors:  [96.57623065]
mat_Sqrt:  [[0.15]]
grads:  [-0.00967907]
Stock Position:  -0.00967906606379457
Bond Position:  [18.12068723]


portfolio before change:  [17.18639393]
curr_Stock_Price:  96.99531233137411
curr_Factors:  [96.99531233]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220481]
Stock Position:  -0.012204814992162964
Bond Position:  [18.37020377]


portfolio before change:  [17.21411469]
curr_Stock_Price:  95.10035248782538
curr_Factors:  [95.10035249]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476361]
Stock Position:  -0.02476360673593695
Bond Position:  [19.56914242]


portfolio before change:  [17.21641473]
curr_Stock_Price:  95.20505673865452
curr_Factors:  [95.20505674]
mat_Sqrt:  [[0.15]]
grads:  [0.00688822]
Stock Position:  0.006888223336489335
Bond Position:  [16.56062104]


portfolio before change:  [17.23499721]
curr_Stock_Price:  97.30165084752588
curr_Factors:  [97.30165085]
mat_Sqrt:  [[0.15]]
grads:  [0.05145198]
Stock Position:  0.051451981993826765
Bond Position:  [12.22863442]


portfolio before change:  [17.26812629]
curr_Stock_Price:  97.88610911823865
curr_Factors:  [97.88610912]
mat_Sqrt:  [[0.15]]
grads:  [0.03147317]
Stock Position:  0.031473165034103835
Bond Position:  [14.18734062]


portfolio before change:  [17.30440836]
curr_Stock_Price:  98.9261947820046
curr_Factors:  [98.92619478]
mat_Sqrt:  [[0.15]]
grads:  [0.08672487]
Stock Position:  0.08672486884190186
Bond Position:  [8.72504709]


portfolio before change:  [17.21505684]
curr_Stock_Price:  97.87075302030294
curr_Factors:  [97.87075302]
mat_Sqrt:  [[0.15]]
grads:  [-0.12102888]
Stock Position:  -0.12102887644424909
Bond Position:  [29.06024412]


portfolio before change:  [17.07715991]
curr_Stock_Price:  99.07016016238052
curr_Factors:  [99.07016016]
mat_Sqrt:  [[0.15]]
grads:  [0.04195236]
Stock Position:  0.041952362485407756
Bond Position:  [12.92093264]


portfolio before change:  [17.10581436]
curr_Stock_Price:  99.67617634398593
curr_Factors:  [99.67617634]
mat_Sqrt:  [[0.15]]
grads:  [-0.16085563]
Stock Position:  -0.1608556261306018
Bond Position:  [33.13928812]


portfolio before change:  [17.02111682]
curr_Stock_Price:  100.25423132410943
curr_Factors:  [100.25423132]
mat_Sqrt:  [[0.15]]
grads:  [0.01949649]
Stock Position:  0.01949648870022311
Bond Position:  [15.06651133]


portfolio before change:  [17.0319255]
curr_Stock_Price:  100.61540319377842
curr_Factors:  [100.61540319]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852542]
Stock Position:  -0.03852542248630153
Bond Position:  [20.90817642]


portfolio before change:  [17.02130002]
curr_Stock_Price:  101.02690239496106
curr_Factors:  [101.02690239]
mat_Sqrt:  [[0.15]]
grads:  [0.0467033]
Stock Position:  0.046703299885126434
Bond Position:  [12.3030103]


portfolio before change:  [17.05089549]
curr_Stock_Price:  101.59472800890877
curr_Factors:  [101.59472801]
mat_Sqrt:  [[0.15]]
grads:  [0.0497745]
Stock Position:  0.04977449883140072
Bond Position:  [11.99406882]


portfolio before change:  [17.04361914]
curr_Stock_Price:  101.38829228692529
curr_Factors:  [101.38829229]
mat_Sqrt:  [[0.15]]
grads:  [-0.0220178]
Stock Position:  -0.022017798853560137
Bond Position:  [19.27596617]


portfolio before change:  [17.01850464]
curr_Stock_Price:  102.74783315818627
curr_Factors:  [102.74783316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.01850464]
Stock Price:  101.64478441072407
PL:  [15.37372023]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.97048058e-04]
 [ 8.62640793e-03]
 [-2.15581863e-03]
 [ 1.21124214e-03]
 [ 2.02074454e-03]
 [ 3.31137562e-03]
 [-6.57259651e-03]
 [ 8.95899010e-03]
 [ 4.07492929e-03]
 [ 4.35338807e-03]
 [-1.79047618e-02]
 [ 1.60985943e-03]
 [-2.41214861e-02]
 [ 2.24593563e-03]
 [-1.22710645e-02]
 [ 7.54990778e-03]
 [ 7.52033718e-03]
 [-1.94389634e-03]
 [-1.23976873e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.50552748]
curr_Stock_Price:  99.72267292339478
curr_Factors:  [99.72267292]
mat_Sqrt:  [[0.15]]
grads:  [0.00598032]
Stock Position:  0.005980320388821692
Bond Position:  [-3.10190102]


portfolio before change:  [-2.50333325]
curr_Stock_Price:  100.21926963446099
curr_Factors:  [100.21926963]
mat_Sqrt:  [[0.15]]
grads:  [0.05750939]
Stock Position:  0.057509386224232725
Bond Position:  [-8.26688193]


portfolio before change:  [-2.64683281]
curr_Stock_Price:  97.75997396191494
curr_Factors:  [97.75997396]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437212]
Stock Position:  -0.014372124172321681
Bond Position:  [-1.24181433]


portfolio before change:  [-2.65202403]
curr_Stock_Price:  98.09957053569957
curr_Factors:  [98.09957054]
mat_Sqrt:  [[0.15]]
grads:  [0.00807495]
Stock Position:  0.00807494762365865
Bond Position:  [-3.44417292]


portfolio before change:  [-2.64798365]
curr_Stock_Price:  98.70657494322506
curr_Factors:  [98.70657494]
mat_Sqrt:  [[0.15]]
grads:  [0.01347163]
Stock Position:  0.013471630269209448
Bond Position:  [-3.97772213]


portfolio before change:  [-2.66165988]
curr_Stock_Price:  97.76521324338303
curr_Factors:  [97.76521324]
mat_Sqrt:  [[0.15]]
grads:  [0.02207584]
Stock Position:  0.02207583747647774
Bond Position:  [-4.81990884]


portfolio before change:  [-2.66323457]
curr_Stock_Price:  97.748472775445
curr_Factors:  [97.74847278]
mat_Sqrt:  [[0.15]]
grads:  [-0.04381731]
Stock Position:  -0.043817310044663486
Bond Position:  [1.61984057]


portfolio before change:  [-2.66367432]
curr_Stock_Price:  97.76775186877661
curr_Factors:  [97.76775187]
mat_Sqrt:  [[0.15]]
grads:  [0.0597266]
Stock Position:  0.0597266006609738
Bond Position:  [-8.50300979]


portfolio before change:  [-2.59896464]
curr_Stock_Price:  98.88677909592954
curr_Factors:  [98.8867791]
mat_Sqrt:  [[0.15]]
grads:  [0.0271662]
Stock Position:  0.027166195273137194
Bond Position:  [-5.28534219]


portfolio before change:  [-2.63732575]
curr_Stock_Price:  97.5233345305608
curr_Factors:  [97.52333453]
mat_Sqrt:  [[0.15]]
grads:  [0.02902259]
Stock Position:  0.029022587100659948
Bond Position:  [-5.46770522]


portfolio before change:  [-2.57895111]
curr_Stock_Price:  99.58179088308783
curr_Factors:  [99.58179088]
mat_Sqrt:  [[0.15]]
grads:  [-0.11936508]
Stock Position:  -0.11936507868644523
Bond Position:  [9.30763719]


portfolio before change:  [-2.6485058]
curr_Stock_Price:  100.18399289900903
curr_Factors:  [100.1839929]
mat_Sqrt:  [[0.15]]
grads:  [0.0107324]
Stock Position:  0.01073239617655252
Bond Position:  [-3.72372011]


portfolio before change:  [-2.63545245]
curr_Stock_Price:  101.48700125259278
curr_Factors:  [101.48700125]
mat_Sqrt:  [[0.15]]
grads:  [-0.16080991]
Stock Position:  -0.16080990760011324
Bond Position:  [13.68466284]


portfolio before change:  [-2.70421001]
curr_Stock_Price:  101.9358489324004
curr_Factors:  [101.93584893]
mat_Sqrt:  [[0.15]]
grads:  [0.0149729]
Stock Position:  0.014972904214133647
Bond Position:  [-4.23048571]


portfolio before change:  [-2.73892582]
curr_Stock_Price:  99.6879176437515
curr_Factors:  [99.68791764]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818071]
Stock Position:  -0.08180709634560511
Bond Position:  [5.41625326]


portfolio before change:  [-2.82594376]
curr_Stock_Price:  100.76816827909774
curr_Factors:  [100.76816828]
mat_Sqrt:  [[0.15]]
grads:  [0.05033272]
Stock Position:  0.05033271851723759
Bond Position:  [-7.89787961]


portfolio before change:  [-2.85627835]
curr_Stock_Price:  100.20472026849495
curr_Factors:  [100.20472027]
mat_Sqrt:  [[0.15]]
grads:  [0.05013558]
Stock Position:  0.0501355812313639
Bond Position:  [-7.88010024]


portfolio before change:  [-2.88855273]
curr_Stock_Price:  99.60027700173896
curr_Factors:  [99.600277]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295931]
Stock Position:  -0.012959308958955315
Bond Position:  [-1.59780197]


portfolio before change:  [-2.90891588]
curr_Stock_Price:  101.14076423387651
curr_Factors:  [101.14076423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.90891588]
Stock Price:  101.28302374710158
PL:  [-4.19193963]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.11434816e-03]
 [ 8.19765506e-03]
 [-1.05942166e-03]
 [ 2.51188767e-03]
 [-4.93041276e-04]
 [ 4.59384381e-03]
 [-9.73848451e-03]
 [ 1.28662482e-02]
 [ 3.39006228e-03]
 [ 1.23142523e-02]
 [-1.79181487e-02]
 [ 8.08308227e-03]
 [ 4.28518930e-03]
 [-2.31705197e-03]
 [-1.69363078e-02]
 [ 6.82399485e-03]
 [ 4.11036057e-03]
 [-2.43120671e-03]
 [-1.17185666e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.20894666]
curr_Stock_Price:  100.80701380292838
curr_Factors:  [100.8070138]
mat_Sqrt:  [[0.15]]
grads:  [0.04742899]
Stock Position:  0.04742898774228738
Bond Position:  [9.42777203]


portfolio before change:  [14.13257048]
curr_Stock_Price:  99.1469864176781
curr_Factors:  [99.14698642]
mat_Sqrt:  [[0.15]]
grads:  [0.05465103]
Stock Position:  0.05465103375611015
Bond Position:  [8.71408517]


portfolio before change:  [14.09682791]
curr_Stock_Price:  98.45310459236408
curr_Factors:  [98.45310459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00706281]
Stock Position:  -0.007062811070455128
Bond Position:  [14.79218359]


portfolio before change:  [14.09776869]
curr_Stock_Price:  98.84356200760766
curr_Factors:  [98.84356201]
mat_Sqrt:  [[0.15]]
grads:  [0.01674592]
Stock Position:  0.016745917829910445
Bond Position:  [12.44254252]


portfolio before change:  [14.07994745]
curr_Stock_Price:  97.59356974628092
curr_Factors:  [97.59356975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00328694]
Stock Position:  -0.003286941842776155
Bond Position:  [14.40073184]


portfolio before change:  [14.07921139]
curr_Stock_Price:  98.91294057803238
curr_Factors:  [98.91294058]
mat_Sqrt:  [[0.15]]
grads:  [0.03062563]
Stock Position:  0.03062562542927768
Bond Position:  [11.04994072]


portfolio before change:  [14.0713774]
curr_Stock_Price:  98.56692911549385
curr_Factors:  [98.56692912]
mat_Sqrt:  [[0.15]]
grads:  [-0.06492323]
Stock Position:  -0.06492323008656695
Bond Position:  [20.47066082]


portfolio before change:  [13.96647304]
curr_Stock_Price:  100.2615870435765
curr_Factors:  [100.26158704]
mat_Sqrt:  [[0.15]]
grads:  [0.08577499]
Stock Position:  0.08577498819553239
Bond Position:  [5.36653659]


portfolio before change:  [13.97895078]
curr_Stock_Price:  100.39141435225994
curr_Factors:  [100.39141435]
mat_Sqrt:  [[0.15]]
grads:  [0.02260042]
Stock Position:  0.022600415199002955
Bond Position:  [11.71006313]


portfolio before change:  [13.94388239]
curr_Stock_Price:  98.71019452576127
curr_Factors:  [98.71019453]
mat_Sqrt:  [[0.15]]
grads:  [0.08209502]
Stock Position:  0.08209501540510858
Bond Position:  [5.84026745]


portfolio before change:  [13.82342601]
curr_Stock_Price:  97.22512711378681
curr_Factors:  [97.22512711]
mat_Sqrt:  [[0.15]]
grads:  [-0.11945432]
Stock Position:  -0.1194543245331113
Bond Position:  [25.4373879]


portfolio before change:  [14.07903354]
curr_Stock_Price:  95.13857741048959
curr_Factors:  [95.13857741]
mat_Sqrt:  [[0.15]]
grads:  [0.05388722]
Stock Position:  0.053887215137767126
Bond Position:  [8.95228055]


portfolio before change:  [14.14645711]
curr_Stock_Price:  96.34823773549401
curr_Factors:  [96.34823774]
mat_Sqrt:  [[0.15]]
grads:  [0.02856793]
Stock Position:  0.028567928676901923
Bond Position:  [11.39398753]


portfolio before change:  [14.14573824]
curr_Stock_Price:  96.22335217003325
curr_Factors:  [96.22335217]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544701]
Stock Position:  -0.01544701314336612
Bond Position:  [15.63210163]


portfolio before change:  [14.13905898]
curr_Stock_Price:  96.90877798488644
curr_Factors:  [96.90877798]
mat_Sqrt:  [[0.15]]
grads:  [-0.11290872]
Stock Position:  -0.11290871858193638
Bond Position:  [25.08090492]


portfolio before change:  [14.20562249]
curr_Stock_Price:  96.3747846553012
curr_Factors:  [96.37478466]
mat_Sqrt:  [[0.15]]
grads:  [0.0454933]
Stock Position:  0.0454932989796016
Bond Position:  [9.8212156]


portfolio before change:  [14.24625922]
curr_Stock_Price:  97.2140538186956
curr_Factors:  [97.21405382]
mat_Sqrt:  [[0.15]]
grads:  [0.0274024]
Stock Position:  0.02740240377226672
Bond Position:  [11.58236047]


portfolio before change:  [14.23660786]
curr_Stock_Price:  96.75616279910959
curr_Factors:  [96.7561628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01620804]
Stock Position:  -0.016208044758584738
Bond Position:  [15.80483608]


portfolio before change:  [14.28354519]
curr_Stock_Price:  94.10404630496589
curr_Factors:  [94.1040463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.28354519]
Stock Price:  94.7707423857468
PL:  [14.28354519]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.82225148e-02]
 [ 2.30579705e-03]
 [ 4.10159965e-04]
 [ 3.21684615e-03]
 [ 1.53006222e-02]
 [ 5.01872472e-03]
 [-3.34939544e-03]
 [ 9.17011285e-03]
 [ 5.67898862e-03]
 [ 9.25750227e-03]
 [-1.52736837e-02]
 [-6.06315175e-03]
 [-2.60719205e-02]
 [ 2.08139201e-03]
 [-1.21134601e-02]
 [ 7.92959320e-03]
 [ 7.50528497e-03]
 [-5.05207690e-03]
 [-1.17758706e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-32.16177006]
curr_Stock_Price:  97.79874304759724
curr_Factors:  [97.79874305]
mat_Sqrt:  [[0.15]]
grads:  [0.25481677]
Stock Position:  0.25481676540328424
Bond Position:  [-57.08252942]


portfolio before change:  [-32.12216289]
curr_Stock_Price:  98.0101874789134
curr_Factors:  [98.01018748]
mat_Sqrt:  [[0.15]]
grads:  [0.01537198]
Stock Position:  0.015371980309091492
Bond Position:  [-33.62877356]


portfolio before change:  [-32.11525748]
curr_Stock_Price:  99.00639346767447
curr_Factors:  [99.00639347]
mat_Sqrt:  [[0.15]]
grads:  [0.0027344]
Stock Position:  0.0027343997652390477
Bond Position:  [-32.38598054]


portfolio before change:  [-32.12095503]
curr_Stock_Price:  99.88408281057289
curr_Factors:  [99.88408281]
mat_Sqrt:  [[0.15]]
grads:  [0.02144564]
Stock Position:  0.021445641031795477
Bond Position:  [-34.26303321]


portfolio before change:  [-32.11222775]
curr_Stock_Price:  100.69049898445084
curr_Factors:  [100.69049898]
mat_Sqrt:  [[0.15]]
grads:  [0.10200415]
Stock Position:  0.1020041481904544
Bond Position:  [-42.38307633]


portfolio before change:  [-32.09170186]
curr_Stock_Price:  100.9956138615291
curr_Factors:  [100.99561386]
mat_Sqrt:  [[0.15]]
grads:  [0.03345816]
Stock Position:  0.033458164826694295
Bond Position:  [-35.47082975]


portfolio before change:  [-32.12899528]
curr_Stock_Price:  100.14605730585413
curr_Factors:  [100.14605731]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223293]
Stock Position:  -0.02232930292977997
Bond Position:  [-29.89280363]


portfolio before change:  [-32.17682461]
curr_Stock_Price:  101.95333254439403
curr_Factors:  [101.95333254]
mat_Sqrt:  [[0.15]]
grads:  [0.06113409]
Stock Position:  0.06113408567158334
Bond Position:  [-38.40964837]


portfolio before change:  [-32.18684778]
curr_Stock_Price:  101.94646965920643
curr_Factors:  [101.94646966]
mat_Sqrt:  [[0.15]]
grads:  [0.03785992]
Stock Position:  0.037859924158717397
Bond Position:  [-36.04653339]


portfolio before change:  [-32.22069218]
curr_Stock_Price:  101.29058777783222
curr_Factors:  [101.29058778]
mat_Sqrt:  [[0.15]]
grads:  [0.06171668]
Stock Position:  0.06171668181904864
Bond Position:  [-38.47201115]


portfolio before change:  [-32.20183027]
curr_Stock_Price:  101.75206937325741
curr_Factors:  [101.75206937]
mat_Sqrt:  [[0.15]]
grads:  [-0.10182456]
Stock Position:  -0.10182455812461845
Bond Position:  [-21.84097077]


portfolio before change:  [-32.12595133]
curr_Stock_Price:  100.95324572379867
curr_Factors:  [100.95324572]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042101]
Stock Position:  -0.04042101165708189
Bond Position:  [-28.04531901]


portfolio before change:  [-32.12483933]
curr_Stock_Price:  100.75225612003015
curr_Factors:  [100.75225612]
mat_Sqrt:  [[0.15]]
grads:  [-0.1738128]
Stock Position:  -0.1738128031888083
Bond Position:  [-14.61280727]


portfolio before change:  [-32.14702546]
curr_Stock_Price:  100.85887928427906
curr_Factors:  [100.85887928]
mat_Sqrt:  [[0.15]]
grads:  [0.01387595]
Stock Position:  0.013875946755422901
Bond Position:  [-33.5465379]


portfolio before change:  [-32.17114566]
curr_Stock_Price:  99.72508171581129
curr_Factors:  [99.72508172]
mat_Sqrt:  [[0.15]]
grads:  [-0.0807564]
Stock Position:  -0.0807564005953198
Bond Position:  [-24.11770701]


portfolio before change:  [-32.11112155]
curr_Stock_Price:  98.90713678743153
curr_Factors:  [98.90713679]
mat_Sqrt:  [[0.15]]
grads:  [0.05286395]
Stock Position:  0.0528639546931401
Bond Position:  [-37.33974395]


portfolio before change:  [-32.0276662]
curr_Stock_Price:  100.66242464724996
curr_Factors:  [100.66242465]
mat_Sqrt:  [[0.15]]
grads:  [0.05003523]
Stock Position:  0.05003523316360277
Bond Position:  [-37.06433408]


portfolio before change:  [-31.91424693]
curr_Stock_Price:  103.11442691778356
curr_Factors:  [103.11442692]
mat_Sqrt:  [[0.15]]
grads:  [-0.03368051]
Stock Position:  -0.03368051266414309
Bond Position:  [-28.44130017]


portfolio before change:  [-31.90746452]
curr_Stock_Price:  102.70191448868687
curr_Factors:  [102.70191449]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.90746452]
Stock Price:  102.71308408241708
PL:  [-34.6205486]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.80026468e-02]
 [-1.56638405e-03]
 [-2.38290776e-03]
 [ 7.06740681e-05]
 [ 9.85715789e-05]
 [ 4.64601690e-03]
 [-3.52651295e-03]
 [ 1.35493831e-03]
 [ 4.61609817e-03]
 [-1.62363807e-02]
 [-1.76165735e-02]
 [ 5.55737008e-03]
 [ 1.07930389e-02]
 [-3.59091486e-03]
 [-1.65103473e-02]
 [ 6.67739045e-03]
 [ 2.74301864e-03]
 [-2.03247826e-03]
 [-1.28046433e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.26607867]
curr_Stock_Price:  98.89484028088788
curr_Factors:  [98.89484028]
mat_Sqrt:  [[0.15]]
grads:  [0.12001765]
Stock Position:  0.12001764512177499
Bond Position:  [-27.13520452]


portfolio before change:  [-15.49102177]
curr_Stock_Price:  97.077120507204
curr_Factors:  [97.07712051]
mat_Sqrt:  [[0.15]]
grads:  [-0.01044256]
Stock Position:  -0.010442560327985236
Bond Position:  [-14.47728808]


portfolio before change:  [-15.50027311]
curr_Stock_Price:  97.61641059745192
curr_Factors:  [97.6164106]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588605]
Stock Position:  -0.015886051756415956
Bond Position:  [-13.94953376]


portfolio before change:  [-15.50107198]
curr_Stock_Price:  97.44714610406874
curr_Factors:  [97.4471461]
mat_Sqrt:  [[0.15]]
grads:  [0.00047116]
Stock Position:  0.0004711604539028048
Bond Position:  [-15.54698523]


portfolio before change:  [-15.50476556]
curr_Stock_Price:  97.85815957354552
curr_Factors:  [97.85815957]
mat_Sqrt:  [[0.15]]
grads:  [0.00065714]
Stock Position:  0.0006571438590805348
Bond Position:  [-15.56907245]


portfolio before change:  [-15.50821802]
curr_Stock_Price:  98.52818106736541
curr_Factors:  [98.52818107]
mat_Sqrt:  [[0.15]]
grads:  [0.03097345]
Stock Position:  0.030973446007885996
Bond Position:  [-18.55997531]


portfolio before change:  [-15.57352892]
curr_Stock_Price:  96.56939580011726
curr_Factors:  [96.5693958]
mat_Sqrt:  [[0.15]]
grads:  [-0.02351009]
Stock Position:  -0.023510086335211632
Bond Position:  [-13.30317409]


portfolio before change:  [-15.5553378]
curr_Stock_Price:  95.65415753991387
curr_Factors:  [95.65415754]
mat_Sqrt:  [[0.15]]
grads:  [0.00903292]
Stock Position:  0.009032922075746288
Bond Position:  [-16.41937435]


portfolio before change:  [-15.55360749]
curr_Stock_Price:  96.30020181887292
curr_Factors:  [96.30020182]
mat_Sqrt:  [[0.15]]
grads:  [0.03077399]
Stock Position:  0.03077398780427209
Bond Position:  [-18.51714873]


portfolio before change:  [-15.59949605]
curr_Stock_Price:  94.95950158268525
curr_Factors:  [94.95950158]
mat_Sqrt:  [[0.15]]
grads:  [-0.10824254]
Stock Position:  -0.10824253788256309
Bond Position:  [-5.3208386]


portfolio before change:  [-15.70227506]
curr_Stock_Price:  95.89673606466569
curr_Factors:  [95.89673606]
mat_Sqrt:  [[0.15]]
grads:  [-0.11744382]
Stock Position:  -0.11744382346878329
Bond Position:  [-4.43979572]


portfolio before change:  [-15.84705002]
curr_Stock_Price:  97.12000060468317
curr_Factors:  [97.1200006]
mat_Sqrt:  [[0.15]]
grads:  [0.03704913]
Stock Position:  0.037049133892759614
Bond Position:  [-19.44526192]


portfolio before change:  [-15.91018161]
curr_Stock_Price:  95.54723306620227
curr_Factors:  [95.54723307]
mat_Sqrt:  [[0.15]]
grads:  [0.07195359]
Stock Position:  0.07195359250486452
Bond Position:  [-22.78514829]


portfolio before change:  [-15.9661336]
curr_Stock_Price:  94.84879689678715
curr_Factors:  [94.8487969]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393943]
Stock Position:  -0.023939432429342333
Bond Position:  [-13.69550724]


portfolio before change:  [-15.987052]
curr_Stock_Price:  95.57956136214304
curr_Factors:  [95.57956136]
mat_Sqrt:  [[0.15]]
grads:  [-0.11006898]
Stock Position:  -0.11006898216472409
Bond Position:  [-5.46670696]


portfolio before change:  [-16.04910062]
curr_Stock_Price:  96.13086814027639
curr_Factors:  [96.13086814]
mat_Sqrt:  [[0.15]]
grads:  [0.04451594]
Stock Position:  0.044515936356983005
Bond Position:  [-20.32845623]


portfolio before change:  [-16.11812773]
curr_Stock_Price:  94.69443062367301
curr_Factors:  [94.69443062]
mat_Sqrt:  [[0.15]]
grads:  [0.01828679]
Stock Position:  0.01828679093764381
Bond Position:  [-17.84978499]


portfolio before change:  [-16.06991674]
curr_Stock_Price:  97.57487017413698
curr_Factors:  [97.57487017]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354986]
Stock Position:  -0.01354985508923048
Bond Position:  [-14.74779139]


portfolio before change:  [-16.09471918]
curr_Stock_Price:  99.13319198605961
curr_Factors:  [99.13319199]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.09471918]
Stock Price:  99.01559216254478
PL:  [-16.09471918]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.86857262e-03]
 [ 8.71408144e-03]
 [ 1.05269116e-03]
 [ 7.63630479e-03]
 [ 7.46825889e-03]
 [ 3.97138701e-03]
 [-1.13940129e-02]
 [ 1.25111377e-02]
 [ 4.72384333e-03]
 [-1.55085457e-03]
 [-1.33488151e-02]
 [-8.66413150e-03]
 [-2.18819366e-02]
 [ 3.12747551e-03]
 [ 1.86814738e-02]
 [ 1.46748423e-03]
 [ 6.62493725e-03]
 [-5.37940331e-03]
 [-1.07335400e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.45828088]
curr_Stock_Price:  100.36906865428735
curr_Factors:  [100.36906865]
mat_Sqrt:  [[0.15]]
grads:  [0.03912382]
Stock Position:  0.0391238174569379
Bond Position:  [3.53145976]


portfolio before change:  [7.4494992]
curr_Stock_Price:  100.1220411949929
curr_Factors:  [100.12204119]
mat_Sqrt:  [[0.15]]
grads:  [0.05809388]
Stock Position:  0.05809387625520127
Bond Position:  [1.63302173]


portfolio before change:  [7.40094756]
curr_Stock_Price:  99.27926825870192
curr_Factors:  [99.27926826]
mat_Sqrt:  [[0.15]]
grads:  [0.00701794]
Stock Position:  0.007017941097542529
Bond Position:  [6.7042115]


portfolio before change:  [7.41158686]
curr_Stock_Price:  100.55642880040148
curr_Factors:  [100.5564288]
mat_Sqrt:  [[0.15]]
grads:  [0.0509087]
Stock Position:  0.0509086985908897
Bond Position:  [2.29238994]


portfolio before change:  [7.38130308]
curr_Stock_Price:  99.9503055150777
curr_Factors:  [99.95030552]
mat_Sqrt:  [[0.15]]
grads:  [0.04978839]
Stock Position:  0.04978839260913126
Bond Position:  [2.40493803]


portfolio before change:  [7.36145961]
curr_Stock_Price:  99.5396721069182
curr_Factors:  [99.53967211]
mat_Sqrt:  [[0.15]]
grads:  [0.02647591]
Stock Position:  0.026475913402811253
Bond Position:  [4.72605588]


portfolio before change:  [7.34254723]
curr_Stock_Price:  98.7807162271508
curr_Factors:  [98.78071623]
mat_Sqrt:  [[0.15]]
grads:  [-0.07596009]
Stock Position:  -0.07596008580264782
Bond Position:  [14.84593891]


portfolio before change:  [7.25589233]
curr_Stock_Price:  99.97037845874206
curr_Factors:  [99.97037846]
mat_Sqrt:  [[0.15]]
grads:  [0.08340758]
Stock Position:  0.0834075844382719
Bond Position:  [-1.08239545]


portfolio before change:  [7.40225819]
curr_Stock_Price:  101.7284498574856
curr_Factors:  [101.72844986]
mat_Sqrt:  [[0.15]]
grads:  [0.03149229]
Stock Position:  0.03149228884570733
Bond Position:  [4.19859646]


portfolio before change:  [7.44617097]
curr_Stock_Price:  103.08951336488296
curr_Factors:  [103.08951336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033903]
Stock Position:  -0.010339030488644927
Bond Position:  [8.51201659]


portfolio before change:  [7.44881895]
curr_Stock_Price:  103.03924645256178
curr_Factors:  [103.03924645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0889921]
Stock Position:  -0.08899210082114242
Bond Position:  [16.61849796]


portfolio before change:  [7.59307327]
curr_Stock_Price:  101.46495866155867
curr_Factors:  [101.46495866]
mat_Sqrt:  [[0.15]]
grads:  [-0.05776088]
Stock Position:  -0.05776087664709205
Bond Position:  [13.45377824]


portfolio before change:  [7.5227695]
curr_Stock_Price:  102.74034854122957
curr_Factors:  [102.74034854]
mat_Sqrt:  [[0.15]]
grads:  [-0.14587958]
Stock Position:  -0.14587957717726507
Bond Position:  [22.51048811]


portfolio before change:  [7.49609101]
curr_Stock_Price:  102.96181080409883
curr_Factors:  [102.9618108]
mat_Sqrt:  [[0.15]]
grads:  [0.02084984]
Stock Position:  0.020849836703205477
Bond Position:  [5.34935406]


portfolio before change:  [7.50446708]
curr_Stock_Price:  103.29939471128246
curr_Factors:  [103.29939471]
mat_Sqrt:  [[0.15]]
grads:  [0.12454316]
Stock Position:  0.12454315872123506
Bond Position:  [-5.36076583]


portfolio before change:  [7.62576662]
curr_Stock_Price:  104.28411276133887
curr_Factors:  [104.28411276]
mat_Sqrt:  [[0.15]]
grads:  [0.00978323]
Stock Position:  0.009783228232573995
Bond Position:  [6.60553134]


portfolio before change:  [7.63968496]
curr_Stock_Price:  105.5379675312626
curr_Factors:  [105.53796753]
mat_Sqrt:  [[0.15]]
grads:  [0.04416625]
Stock Position:  0.044166248303146256
Bond Position:  [2.97846888]


portfolio before change:  [7.63156635]
curr_Stock_Price:  105.33728669328084
curr_Factors:  [105.33728669]
mat_Sqrt:  [[0.15]]
grads:  [-0.03586269]
Stock Position:  -0.03586268875867338
Bond Position:  [11.40924467]


portfolio before change:  [7.65138573]
curr_Stock_Price:  104.8641845339794
curr_Factors:  [104.86418453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.65138573]
Stock Price:  105.13062140412063
PL:  [2.52076432]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 9.74647569e-03]
 [ 9.61676869e-03]
 [ 7.98148089e-04]
 [ 1.39610675e-03]
 [ 2.77865150e-03]
 [ 3.68683176e-03]
 [-1.00850409e-02]
 [ 1.24404635e-02]
 [ 4.65761677e-03]
 [ 1.09177157e-03]
 [-1.79649414e-02]
 [ 5.49379481e-03]
 [-1.95513529e-02]
 [ 2.09226236e-03]
 [-1.62018322e-02]
 [ 7.92691502e-03]
 [ 6.11905503e-03]
 [-1.66855766e-03]
 [-1.28063097e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.40077687]
curr_Stock_Price:  99.2753480051192
curr_Factors:  [99.27534801]
mat_Sqrt:  [[0.15]]
grads:  [0.0649765]
Stock Position:  0.06497650457093669
Bond Position:  [-15.85134197]


portfolio before change:  [-9.36340432]
curr_Stock_Price:  99.91151460473878
curr_Factors:  [99.9115146]
mat_Sqrt:  [[0.15]]
grads:  [0.06411179]
Stock Position:  0.06411179128281543
Bond Position:  [-15.76891049]


portfolio before change:  [-9.41692364]
curr_Stock_Price:  99.13823095770518
curr_Factors:  [99.13823096]
mat_Sqrt:  [[0.15]]
grads:  [0.00532099]
Stock Position:  0.005320987261187455
Bond Position:  [-9.9444369]


portfolio before change:  [-9.42437408]
curr_Stock_Price:  98.20531624749772
curr_Factors:  [98.20531625]
mat_Sqrt:  [[0.15]]
grads:  [0.00930738]
Stock Position:  0.009307378304737475
Bond Position:  [-10.33840811]


portfolio before change:  [-9.41975076]
curr_Stock_Price:  98.97978260839484
curr_Factors:  [98.97978261]
mat_Sqrt:  [[0.15]]
grads:  [0.01852434]
Stock Position:  0.01852434332003207
Bond Position:  [-11.25328623]


portfolio before change:  [-9.44137838]
curr_Stock_Price:  97.9641486271512
curr_Factors:  [97.96414863]
mat_Sqrt:  [[0.15]]
grads:  [0.02457888]
Stock Position:  0.024578878383920196
Bond Position:  [-11.84922728]


portfolio before change:  [-9.42842542]
curr_Stock_Price:  98.61168177313172
curr_Factors:  [98.61168177]
mat_Sqrt:  [[0.15]]
grads:  [-0.06723361]
Stock Position:  -0.06723360614914858
Bond Position:  [-2.79840645]


portfolio before change:  [-9.45498363]
curr_Stock_Price:  98.99628886537707
curr_Factors:  [98.99628887]
mat_Sqrt:  [[0.15]]
grads:  [0.08293642]
Stock Position:  0.08293642361308433
Bond Position:  [-17.66538178]


portfolio before change:  [-9.63093438]
curr_Stock_Price:  96.92803169884927
curr_Factors:  [96.9280317]
mat_Sqrt:  [[0.15]]
grads:  [0.03105078]
Stock Position:  0.03105077848205192
Bond Position:  [-12.64062522]


portfolio before change:  [-9.62594438]
curr_Stock_Price:  97.19052280861041
curr_Factors:  [97.19052281]
mat_Sqrt:  [[0.15]]
grads:  [0.00727848]
Stock Position:  0.00727847710872367
Bond Position:  [-10.33334338]


portfolio before change:  [-9.62731047]
curr_Stock_Price:  97.3578063331322
curr_Factors:  [97.35780633]
mat_Sqrt:  [[0.15]]
grads:  [-0.11976628]
Stock Position:  -0.1197662758725906
Bond Position:  [2.03287142]


portfolio before change:  [-9.72181343]
curr_Stock_Price:  98.15111182543866
curr_Factors:  [98.15111183]
mat_Sqrt:  [[0.15]]
grads:  [0.0366253]
Stock Position:  0.03662529876197047
Bond Position:  [-13.31662723]


portfolio before change:  [-9.68892418]
curr_Stock_Price:  99.14001355418155
curr_Factors:  [99.14001355]
mat_Sqrt:  [[0.15]]
grads:  [-0.13034235]
Stock Position:  -0.13034235250827267
Bond Position:  [3.23321841]


portfolio before change:  [-9.90545379]
curr_Stock_Price:  100.80745324716601
curr_Factors:  [100.80745325]
mat_Sqrt:  [[0.15]]
grads:  [0.01394842]
Stock Position:  0.013948415739048307
Bond Position:  [-11.31155806]


portfolio before change:  [-9.939054]
curr_Stock_Price:  98.60132706561633
curr_Factors:  [98.60132707]
mat_Sqrt:  [[0.15]]
grads:  [-0.10801221]
Stock Position:  -0.10801221465291999
Bond Position:  [0.71109371]


portfolio before change:  [-9.96923451]
curr_Stock_Price:  98.88239071201839
curr_Factors:  [98.88239071]
mat_Sqrt:  [[0.15]]
grads:  [0.0528461]
Stock Position:  0.05284610013331194
Bond Position:  [-15.19478323]


portfolio before change:  [-9.95138244]
curr_Stock_Price:  99.29209445982436
curr_Factors:  [99.29209446]
mat_Sqrt:  [[0.15]]
grads:  [0.0407937]
Stock Position:  0.040793700172934495
Bond Position:  [-14.00187437]


portfolio before change:  [-9.9687263]
curr_Stock_Price:  98.95275384748814
curr_Factors:  [98.95275385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01112372]
Stock Position:  -0.011123717716690393
Bond Position:  [-8.8680038]


portfolio before change:  [-9.97464394]
curr_Stock_Price:  99.28540880318036
curr_Factors:  [99.2854088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.97464394]
Stock Price:  100.89622270892312
PL:  [-10.87086665]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.07950320e-03]
 [ 7.67789489e-03]
 [ 7.91108574e-04]
 [ 2.96351581e-03]
 [ 1.08953472e-03]
 [ 3.37061065e-03]
 [-1.36990899e-02]
 [ 1.21792040e-02]
 [ 3.47227097e-03]
 [ 9.12985121e-03]
 [-1.79718135e-02]
 [ 3.64700853e-03]
 [-1.23127838e-02]
 [-1.24747863e-03]
 [-1.67454178e-02]
 [ 6.58866151e-03]
 [ 4.13369114e-03]
 [-2.12223489e-03]
 [-1.25707484e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.06723264]
curr_Stock_Price:  100.53832274001566
curr_Factors:  [100.53832274]
mat_Sqrt:  [[0.15]]
grads:  [0.04053002]
Stock Position:  0.040530021300443274
Bond Position:  [5.99241227]


portfolio before change:  [10.00889751]
curr_Stock_Price:  99.06204860720871
curr_Factors:  [99.06204861]
mat_Sqrt:  [[0.15]]
grads:  [0.05118597]
Stock Position:  0.05118596591453149
Bond Position:  [4.93831086]


portfolio before change:  [10.01387859]
curr_Stock_Price:  99.13523958894933
curr_Factors:  [99.13523959]
mat_Sqrt:  [[0.15]]
grads:  [0.00527406]
Stock Position:  0.0052740571624665345
Bond Position:  [9.49103367]


portfolio before change:  [10.01728978]
curr_Stock_Price:  99.33207744754112
curr_Factors:  [99.33207745]
mat_Sqrt:  [[0.15]]
grads:  [0.01975677]
Stock Position:  0.019756772098236248
Bond Position:  [8.05480856]


portfolio before change:  [10.00031388]
curr_Stock_Price:  98.37089566316676
curr_Factors:  [98.37089566]
mat_Sqrt:  [[0.15]]
grads:  [0.00726356]
Stock Position:  0.0072635647737286325
Bond Position:  [9.28579051]


portfolio before change:  [10.01267239]
curr_Stock_Price:  99.75269249500181
curr_Factors:  [99.7526925]
mat_Sqrt:  [[0.15]]
grads:  [0.02247074]
Stock Position:  0.022470737639091968
Bond Position:  [7.77115581]


portfolio before change:  [9.99946319]
curr_Stock_Price:  99.07838298004775
curr_Factors:  [99.07838298]
mat_Sqrt:  [[0.15]]
grads:  [-0.09132727]
Stock Position:  -0.09132726569359184
Bond Position:  [19.048021]


portfolio before change:  [10.01725243]
curr_Stock_Price:  98.9357460926634
curr_Factors:  [98.93574609]
mat_Sqrt:  [[0.15]]
grads:  [0.08119469]
Stock Position:  0.08119469359463982
Bond Position:  [1.98419484]


portfolio before change:  [10.04296575]
curr_Stock_Price:  99.24632315056846
curr_Factors:  [99.24632315]
mat_Sqrt:  [[0.15]]
grads:  [0.02314847]
Stock Position:  0.023148473148697203
Bond Position:  [7.7455649]


portfolio before change:  [10.01773777]
curr_Stock_Price:  98.07282846952961
curr_Factors:  [98.07282847]
mat_Sqrt:  [[0.15]]
grads:  [0.06086567]
Stock Position:  0.060865674728024906
Bond Position:  [4.04846889]


portfolio before change:  [10.10718022]
curr_Stock_Price:  99.52570325418024
curr_Factors:  [99.52570325]
mat_Sqrt:  [[0.15]]
grads:  [-0.11981209]
Stock Position:  -0.11981209000394201
Bond Position:  [22.03156273]


portfolio before change:  [10.06983198]
curr_Stock_Price:  99.88340355136438
curr_Factors:  [99.88340355]
mat_Sqrt:  [[0.15]]
grads:  [0.02431339]
Stock Position:  0.024313390206477308
Bond Position:  [7.64132781]


portfolio before change:  [10.03206607]
curr_Stock_Price:  98.25152603458473
curr_Factors:  [98.25152603]
mat_Sqrt:  [[0.15]]
grads:  [-0.08208523]
Stock Position:  -0.08208522562784347
Bond Position:  [18.09706476]


portfolio before change:  [10.11461264]
curr_Stock_Price:  97.3010293569623
curr_Factors:  [97.30102936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00831652]
Stock Position:  -0.008316524229043748
Bond Position:  [10.92381901]


portfolio before change:  [10.12472482]
curr_Stock_Price:  96.41353311082692
curr_Factors:  [96.41353311]
mat_Sqrt:  [[0.15]]
grads:  [-0.11163612]
Stock Position:  -0.11163611870306667
Bond Position:  [20.88795745]


portfolio before change:  [10.21214562]
curr_Stock_Price:  95.67722880308014
curr_Factors:  [95.6772288]
mat_Sqrt:  [[0.15]]
grads:  [0.04392441]
Stock Position:  0.04392441009834467
Bond Position:  [6.00957978]


portfolio before change:  [10.28304071]
curr_Stock_Price:  97.257045453558
curr_Factors:  [97.25704545]
mat_Sqrt:  [[0.15]]
grads:  [0.02755794]
Stock Position:  0.02755794095707571
Bond Position:  [7.6028368]


portfolio before change:  [10.28256285]
curr_Stock_Price:  97.17072508346018
curr_Factors:  [97.17072508]
mat_Sqrt:  [[0.15]]
grads:  [-0.01414823]
Stock Position:  -0.014148232579973902
Bond Position:  [11.65735687]


portfolio before change:  [10.29717285]
curr_Stock_Price:  96.34409925875231
curr_Factors:  [96.34409926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.29717285]
Stock Price:  96.01639389414292
PL:  [10.29717285]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 4.49817034e-02]
 [ 2.39420532e-04]
 [-3.10559390e-03]
 [-2.47942899e-03]
 [-9.15864888e-03]
 [-5.75727832e-03]
 [ 7.69665687e-03]
 [-4.34955437e-03]
 [ 4.60004800e-03]
 [-1.04713251e-02]
 [-1.75729836e-02]
 [ 6.60039697e-03]
 [ 5.52553742e-03]
 [-3.03975760e-03]
 [-1.64710968e-02]
 [ 6.32036244e-03]
 [ 3.17787654e-03]
 [-2.54162525e-03]
 [-1.26820927e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-38.88598123]
curr_Stock_Price:  97.36251412452468
curr_Factors:  [97.36251412]
mat_Sqrt:  [[0.15]]
grads:  [0.29987802]
Stock Position:  0.2998780228459365
Bond Position:  [-68.08285947]


portfolio before change:  [-38.85663749]
curr_Stock_Price:  97.51713226133695
curr_Factors:  [97.51713226]
mat_Sqrt:  [[0.15]]
grads:  [0.00159614]
Stock Position:  0.0015961368809035612
Bond Position:  [-39.01228818]


portfolio before change:  [-38.86696256]
curr_Stock_Price:  97.15953601963561
curr_Factors:  [97.15953602]
mat_Sqrt:  [[0.15]]
grads:  [-0.02070396]
Stock Position:  -0.020703959364074966
Bond Position:  [-36.85537547]


portfolio before change:  [-38.8519313]
curr_Stock_Price:  95.98844357540659
curr_Factors:  [95.98844358]
mat_Sqrt:  [[0.15]]
grads:  [-0.01652953]
Stock Position:  -0.016529526574639773
Bond Position:  [-37.26528777]


portfolio before change:  [-38.85451017]
curr_Stock_Price:  95.58077212724929
curr_Factors:  [95.58077213]
mat_Sqrt:  [[0.15]]
grads:  [-0.06105766]
Stock Position:  -0.06105765921520105
Bond Position:  [-33.01857196]


portfolio before change:  [-38.78829146]
curr_Stock_Price:  94.36103351321752
curr_Factors:  [94.36103351]
mat_Sqrt:  [[0.15]]
grads:  [-0.03838186]
Stock Position:  -0.03838185546508835
Bond Position:  [-35.16653991]


portfolio before change:  [-38.75399109]
curr_Stock_Price:  93.23828660945253
curr_Factors:  [93.23828661]
mat_Sqrt:  [[0.15]]
grads:  [0.05131105]
Stock Position:  0.05131104579201805
Bond Position:  [-43.53814508]


portfolio before change:  [-38.7112756]
curr_Stock_Price:  94.28292301604893
curr_Factors:  [94.28292302]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899703]
Stock Position:  -0.028997029142800515
Bond Position:  [-35.97735093]


portfolio before change:  [-38.77172842]
curr_Stock_Price:  96.05749664423931
curr_Factors:  [96.05749664]
mat_Sqrt:  [[0.15]]
grads:  [0.03066699]
Stock Position:  0.030666986637347585
Bond Position:  [-41.71752239]


portfolio before change:  [-38.79192237]
curr_Stock_Price:  95.73913283148521
curr_Factors:  [95.73913283]
mat_Sqrt:  [[0.15]]
grads:  [-0.06980883]
Stock Position:  -0.06980883423398251
Bond Position:  [-32.10848511]


portfolio before change:  [-38.78120214]
curr_Stock_Price:  95.47056576375601
curr_Factors:  [95.47056576]
mat_Sqrt:  [[0.15]]
grads:  [-0.11715322]
Stock Position:  -0.11715322418566844
Bond Position:  [-27.59651754]


portfolio before change:  [-38.88547748]
curr_Stock_Price:  96.30174519711031
curr_Factors:  [96.3017452]
mat_Sqrt:  [[0.15]]
grads:  [0.04400265]
Stock Position:  0.044002646434781655
Bond Position:  [-43.12300912]


portfolio before change:  [-38.90093147]
curr_Stock_Price:  96.19557215530165
curr_Factors:  [96.19557216]
mat_Sqrt:  [[0.15]]
grads:  [0.03683692]
Stock Position:  0.03683691610513127
Bond Position:  [-42.44447969]


portfolio before change:  [-38.93872255]
curr_Stock_Price:  95.45776248349392
curr_Factors:  [95.45776248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02026505]
Stock Position:  -0.02026505064144484
Bond Position:  [-37.00426616]


portfolio before change:  [-38.94762111]
curr_Stock_Price:  95.4403102979855
curr_Factors:  [95.4403103]
mat_Sqrt:  [[0.15]]
grads:  [-0.10980731]
Stock Position:  -0.10980731211296414
Bond Position:  [-28.46757717]


portfolio before change:  [-38.82419531]
curr_Stock_Price:  94.25146801323575
curr_Factors:  [94.25146801]
mat_Sqrt:  [[0.15]]
grads:  [0.04213575]
Stock Position:  0.04213574961217405
Bond Position:  [-42.79555157]


portfolio before change:  [-38.78246677]
curr_Stock_Price:  95.49575033557036
curr_Factors:  [95.49575034]
mat_Sqrt:  [[0.15]]
grads:  [0.02118584]
Stock Position:  0.021185843567750468
Bond Position:  [-40.8056248]


portfolio before change:  [-38.76910532]
curr_Stock_Price:  96.60800896430355
curr_Factors:  [96.60800896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01694417]
Stock Position:  -0.016944168339434563
Bond Position:  [-37.13216295]


portfolio before change:  [-38.79320109]
curr_Stock_Price:  97.48214904856978
curr_Factors:  [97.48214905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-38.79320109]
Stock Price:  96.02446794726492
PL:  [-38.79320109]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.23409510e-02]
 [ 6.46250485e-03]
 [ 9.79810397e-04]
 [ 9.63012693e-03]
 [ 1.39353485e-02]
 [ 3.86583429e-03]
 [ 2.30165018e-02]
 [ 1.27109022e-02]
 [ 3.16031220e-03]
 [ 8.20938578e-03]
 [-1.75820290e-02]
 [ 1.51299381e-03]
 [-2.60558279e-02]
 [ 3.45036784e-03]
 [-1.03729582e-02]
 [ 7.30112167e-03]
 [ 7.49906964e-03]
 [-3.49183019e-03]
 [-1.22395587e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.61402431]
curr_Stock_Price:  98.67764443686677
curr_Factors:  [98.67764444]
mat_Sqrt:  [[0.15]]
grads:  [0.14893967]
Stock Position:  0.1489396732473959
Bond Position:  [-33.31104043]


portfolio before change:  [-18.60410157]
curr_Stock_Price:  98.80018760578558
curr_Factors:  [98.80018761]
mat_Sqrt:  [[0.15]]
grads:  [0.04308337]
Stock Position:  0.0430833656921346
Bond Position:  [-22.86074618]


portfolio before change:  [-18.5341941]
curr_Stock_Price:  100.55546756169711
curr_Factors:  [100.55546756]
mat_Sqrt:  [[0.15]]
grads:  [0.00653207]
Stock Position:  0.006532069312213584
Bond Position:  [-19.19102939]


portfolio before change:  [-18.53778098]
curr_Stock_Price:  100.74093453751112
curr_Factors:  [100.74093454]
mat_Sqrt:  [[0.15]]
grads:  [0.06420085]
Stock Position:  0.06420084621692057
Bond Position:  [-25.00543422]


portfolio before change:  [-18.55517437]
curr_Stock_Price:  100.56739712227446
curr_Factors:  [100.56739712]
mat_Sqrt:  [[0.15]]
grads:  [0.09290232]
Stock Position:  0.09290232330662943
Bond Position:  [-27.89811921]


portfolio before change:  [-18.54802236]
curr_Stock_Price:  100.71946443466285
curr_Factors:  [100.71946443]
mat_Sqrt:  [[0.15]]
grads:  [0.02577223]
Stock Position:  0.025772228587435088
Bond Position:  [-21.14378742]


portfolio before change:  [-18.54608669]
curr_Stock_Price:  100.99969924195616
curr_Factors:  [100.99969924]
mat_Sqrt:  [[0.15]]
grads:  [0.15344335]
Stock Position:  0.15344334517346844
Bond Position:  [-34.04381841]


portfolio before change:  [-18.50619681]
curr_Stock_Price:  101.31513748340986
curr_Factors:  [101.31513748]
mat_Sqrt:  [[0.15]]
grads:  [0.08473935]
Stock Position:  0.08473934833253799
Bond Position:  [-27.09157554]


portfolio before change:  [-18.6069685]
curr_Stock_Price:  100.2058777959942
curr_Factors:  [100.2058778]
mat_Sqrt:  [[0.15]]
grads:  [0.02106875]
Stock Position:  0.02106874800661156
Bond Position:  [-20.71818088]


portfolio before change:  [-18.60678133]
curr_Stock_Price:  100.46063256148126
curr_Factors:  [100.46063256]
mat_Sqrt:  [[0.15]]
grads:  [0.05472924]
Stock Position:  0.054729238547851805
Bond Position:  [-24.10491525]


portfolio before change:  [-18.6489662]
curr_Stock_Price:  99.79996397512258
curr_Factors:  [99.79996398]
mat_Sqrt:  [[0.15]]
grads:  [-0.11721353]
Stock Position:  -0.11721352693488468
Bond Position:  [-6.95106043]


portfolio before change:  [-18.69734766]
curr_Stock_Price:  100.19789996959663
curr_Factors:  [100.19789997]
mat_Sqrt:  [[0.15]]
grads:  [0.01008663]
Stock Position:  0.010086625427580221
Bond Position:  [-19.70800635]


portfolio before change:  [-18.69922066]
curr_Stock_Price:  100.50073829354565
curr_Factors:  [100.50073829]
mat_Sqrt:  [[0.15]]
grads:  [-0.17370552]
Stock Position:  -0.17370551916823554
Bond Position:  [-1.24168774]


portfolio before change:  [-18.62089862]
curr_Stock_Price:  100.04806126321026
curr_Factors:  [100.04806126]
mat_Sqrt:  [[0.15]]
grads:  [0.02300245]
Stock Position:  0.02300245227834658
Bond Position:  [-20.92224938]


portfolio before change:  [-18.62275853]
curr_Stock_Price:  100.19462425019667
curr_Factors:  [100.19462425]
mat_Sqrt:  [[0.15]]
grads:  [-0.06915305]
Stock Position:  -0.069153054627042
Bond Position:  [-11.69399421]


portfolio before change:  [-18.67352113]
curr_Stock_Price:  100.88640475926881
curr_Factors:  [100.88640476]
mat_Sqrt:  [[0.15]]
grads:  [0.04867414]
Stock Position:  0.048674144491557686
Bond Position:  [-23.58408057]


portfolio before change:  [-18.68205285]
curr_Stock_Price:  100.83227002977512
curr_Factors:  [100.83227003]
mat_Sqrt:  [[0.15]]
grads:  [0.0499938]
Stock Position:  0.049993797584704444
Bond Position:  [-23.72304095]


portfolio before change:  [-18.65113189]
curr_Stock_Price:  101.56941074096476
curr_Factors:  [101.56941074]
mat_Sqrt:  [[0.15]]
grads:  [-0.02327887]
Stock Position:  -0.02327886790666143
Bond Position:  [-16.28671099]


portfolio before change:  [-18.65582572]
curr_Stock_Price:  101.59611491316804
curr_Factors:  [101.59611491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.65582572]
Stock Price:  102.41269462258995
PL:  [-21.06852034]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 8.67914665e-03]
 [ 6.01122512e-03]
 [ 9.56820470e-04]
 [ 1.45971217e-02]
 [ 2.51393437e-02]
 [ 6.24628192e-03]
 [ 3.08051030e-02]
 [-2.40508782e-03]
 [ 9.53447647e-03]
 [-2.38795464e-02]
 [-1.06114826e-02]
 [-2.43618742e-02]
 [-2.29652140e-02]
 [ 2.14027455e-03]
 [ 1.12410604e-02]
 [ 2.79857136e-03]
 [ 7.46644251e-03]
 [-1.87490976e-03]
 [-1.27232653e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.02993053]
curr_Stock_Price:  100.92514897364578
curr_Factors:  [100.92514897]
mat_Sqrt:  [[0.15]]
grads:  [0.05786098]
Stock Position:  0.057860977671732344
Bond Position:  [10.19030274]


portfolio before change:  [16.05496598]
curr_Stock_Price:  101.31379701978173
curr_Factors:  [101.31379702]
mat_Sqrt:  [[0.15]]
grads:  [0.04007483]
Stock Position:  0.04007483416367194
Bond Position:  [11.99483237]


portfolio before change:  [16.06086584]
curr_Stock_Price:  101.38618108353883
curr_Factors:  [101.38618108]
mat_Sqrt:  [[0.15]]
grads:  [0.0063788]
Stock Position:  0.0063788031325848525
Bond Position:  [15.41414335]


portfolio before change:  [16.07040751]
curr_Stock_Price:  102.27782990071702
curr_Factors:  [102.2778299]
mat_Sqrt:  [[0.15]]
grads:  [0.09731414]
Stock Position:  0.09731414467196398
Bond Position:  [6.11732798]


portfolio before change:  [16.05224537]
curr_Stock_Price:  102.07547836045022
curr_Factors:  [102.07547836]
mat_Sqrt:  [[0.15]]
grads:  [0.16759562]
Stock Position:  0.16759562475652842
Bond Position:  [-1.0551582]


portfolio before change:  [16.35948403]
curr_Stock_Price:  103.9102666076871
curr_Factors:  [103.91026661]
mat_Sqrt:  [[0.15]]
grads:  [0.04164188]
Stock Position:  0.04164187944560346
Bond Position:  [12.03246523]


portfolio before change:  [16.36549845]
curr_Stock_Price:  103.98245188228279
curr_Factors:  [103.98245188]
mat_Sqrt:  [[0.15]]
grads:  [0.20536735]
Stock Position:  0.20536735342994622
Bond Position:  [-4.98910249]


portfolio before change:  [16.4319218]
curr_Stock_Price:  104.31196277211522
curr_Factors:  [104.31196277]
mat_Sqrt:  [[0.15]]
grads:  [-0.01603392]
Stock Position:  -0.016033918831758316
Bond Position:  [18.10445134]


portfolio before change:  [16.42887638]
curr_Stock_Price:  104.7842177690206
curr_Factors:  [104.78421777]
mat_Sqrt:  [[0.15]]
grads:  [0.06356318]
Stock Position:  0.06356317647182991
Bond Position:  [9.76845866]


portfolio before change:  [16.50483868]
curr_Stock_Price:  105.94086040795347
curr_Factors:  [105.94086041]
mat_Sqrt:  [[0.15]]
grads:  [-0.15919698]
Stock Position:  -0.15919697619343098
Bond Position:  [33.37030331]


portfolio before change:  [16.70710406]
curr_Stock_Price:  104.72273575051402
curr_Factors:  [104.72273575]
mat_Sqrt:  [[0.15]]
grads:  [-0.07074322]
Stock Position:  -0.07074321701299631
Bond Position:  [24.11552728]


portfolio before change:  [16.65257779]
curr_Stock_Price:  105.57873175266087
curr_Factors:  [105.57873175]
mat_Sqrt:  [[0.15]]
grads:  [-0.16241249]
Stock Position:  -0.16241249490844448
Bond Position:  [33.79988302]


portfolio before change:  [17.23096263]
curr_Stock_Price:  102.0695570645119
curr_Factors:  [102.06955706]
mat_Sqrt:  [[0.15]]
grads:  [-0.15310143]
Stock Position:  -0.15310142647556996
Bond Position:  [32.85795742]


portfolio before change:  [17.28673797]
curr_Stock_Price:  101.75891449178054
curr_Factors:  [101.75891449]
mat_Sqrt:  [[0.15]]
grads:  [0.0142685]
Stock Position:  0.014268496988906688
Bond Position:  [15.8347912]


portfolio before change:  [17.3025484]
curr_Stock_Price:  102.58950238507515
curr_Factors:  [102.58950239]
mat_Sqrt:  [[0.15]]
grads:  [0.0749404]
Stock Position:  0.07494040260047845
Bond Position:  [9.61444979]


portfolio before change:  [17.31839739]
curr_Stock_Price:  102.768912638094
curr_Factors:  [102.76891264]
mat_Sqrt:  [[0.15]]
grads:  [0.01865714]
Stock Position:  0.018657142431433345
Bond Position:  [15.40102315]


portfolio before change:  [17.30048108]
curr_Stock_Price:  101.60222529680162
curr_Factors:  [101.6022253]
mat_Sqrt:  [[0.15]]
grads:  [0.04977628]
Stock Position:  0.04977628339065775
Bond Position:  [12.24309992]


portfolio before change:  [17.19603771]
curr_Stock_Price:  99.44247143881142
curr_Factors:  [99.44247144]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124994]
Stock Position:  -0.012499398378666135
Bond Position:  [18.43900878]


portfolio before change:  [17.21570657]
curr_Stock_Price:  98.23773101833146
curr_Factors:  [98.23773102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.21570657]
Stock Price:  97.75541201451857
PL:  [17.21570657]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.69731058e-03]
 [ 6.80061100e-03]
 [-1.47363219e-03]
 [ 2.29415519e-03]
 [-7.29287952e-03]
 [ 3.14808009e-03]
 [-1.04208014e-02]
 [ 1.22876437e-02]
 [ 3.88938813e-03]
 [-2.06525886e-03]
 [-1.76775744e-02]
 [ 5.85082831e-03]
 [-3.02204791e-03]
 [-1.07220804e-03]
 [-1.70625991e-02]
 [ 7.30271733e-03]
 [ 3.77973020e-03]
 [-3.29222761e-03]
 [-1.26737037e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.03691348]
curr_Stock_Price:  99.55845086717052
curr_Factors:  [99.55845087]
mat_Sqrt:  [[0.15]]
grads:  [0.02464874]
Stock Position:  0.024648737175248632
Bond Position:  [-7.49090356]


portfolio before change:  [-5.05482424]
curr_Stock_Price:  98.90779650333994
curr_Factors:  [98.9077965]
mat_Sqrt:  [[0.15]]
grads:  [0.04533741]
Stock Position:  0.0453374066595951
Bond Position:  [-9.53904724]


portfolio before change:  [-5.08969589]
curr_Stock_Price:  98.19124505374222
curr_Factors:  [98.19124505]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982421]
Stock Position:  -0.0098242145814459
Bond Position:  [-4.12504403]


portfolio before change:  [-5.09591221]
curr_Stock_Price:  98.71901530453297
curr_Factors:  [98.7190153]
mat_Sqrt:  [[0.15]]
grads:  [0.01529437]
Stock Position:  0.015294367923192297
Bond Position:  [-6.60575715]


portfolio before change:  [-5.14025366]
curr_Stock_Price:  95.92780437605941
curr_Factors:  [95.92780438]
mat_Sqrt:  [[0.15]]
grads:  [-0.0486192]
Stock Position:  -0.04861919678101934
Bond Position:  [-0.47632086]


portfolio before change:  [-5.22549946]
curr_Stock_Price:  97.67869112845781
curr_Factors:  [97.67869113]
mat_Sqrt:  [[0.15]]
grads:  [0.0209872]
Stock Position:  0.02098720060879692
Bond Position:  [-7.27550175]


portfolio before change:  [-5.20682773]
curr_Stock_Price:  98.65504029718177
curr_Factors:  [98.6550403]
mat_Sqrt:  [[0.15]]
grads:  [-0.06947201]
Stock Position:  -0.06947200943872786
Bond Position:  [1.64693616]


portfolio before change:  [-5.2480852]
curr_Stock_Price:  99.25483954698674
curr_Factors:  [99.25483955]
mat_Sqrt:  [[0.15]]
grads:  [0.08191762]
Stock Position:  0.08191762443709483
Bond Position:  [-13.37880587]


portfolio before change:  [-5.27251323]
curr_Stock_Price:  98.99747236614937
curr_Factors:  [98.99747237]
mat_Sqrt:  [[0.15]]
grads:  [0.02592925]
Stock Position:  0.025929254222240253
Bond Position:  [-7.83944386]


portfolio before change:  [-5.33051451]
curr_Stock_Price:  96.83616166849916
curr_Factors:  [96.83616167]
mat_Sqrt:  [[0.15]]
grads:  [-0.01376839]
Stock Position:  -0.013768392391119353
Bond Position:  [-3.99723624]


portfolio before change:  [-5.32679096]
curr_Stock_Price:  96.49313037809596
curr_Factors:  [96.49313038]
mat_Sqrt:  [[0.15]]
grads:  [-0.1178505]
Stock Position:  -0.11785049601158291
Bond Position:  [6.04497232]


portfolio before change:  [-5.37202516]
curr_Stock_Price:  96.88978239511572
curr_Factors:  [96.8897824]
mat_Sqrt:  [[0.15]]
grads:  [0.03900552]
Stock Position:  0.039005522072799545
Bond Position:  [-9.15126171]


portfolio before change:  [-5.36176942]
curr_Stock_Price:  97.21137375325657
curr_Factors:  [97.21137375]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014699]
Stock Position:  -0.02014698604138591
Bond Position:  [-3.40325323]


portfolio before change:  [-5.36798456]
curr_Stock_Price:  97.47762792684696
curr_Factors:  [97.47762793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00714805]
Stock Position:  -0.007148053595981542
Bond Position:  [-4.67120925]


portfolio before change:  [-5.36724957]
curr_Stock_Price:  97.2114099589113
curr_Factors:  [97.21140996]
mat_Sqrt:  [[0.15]]
grads:  [-0.11375066]
Stock Position:  -0.11375066089726778
Bond Position:  [5.69061256]


portfolio before change:  [-5.40487938]
curr_Stock_Price:  97.5547279323216
curr_Factors:  [97.55472793]
mat_Sqrt:  [[0.15]]
grads:  [0.04868478]
Stock Position:  0.04868478222008546
Bond Position:  [-10.15431007]


portfolio before change:  [-5.45366552]
curr_Stock_Price:  96.60479586915763
curr_Factors:  [96.60479587]
mat_Sqrt:  [[0.15]]
grads:  [0.0251982]
Stock Position:  0.02519820133621387
Bond Position:  [-7.88793261]


portfolio before change:  [-5.48093437]
curr_Stock_Price:  95.60088986050421
curr_Factors:  [95.60088986]
mat_Sqrt:  [[0.15]]
grads:  [-0.02194818]
Stock Position:  -0.02194818407754545
Bond Position:  [-3.38266844]


portfolio before change:  [-5.51969142]
curr_Stock_Price:  97.3281980894326
curr_Factors:  [97.32819809]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.51969142]
Stock Price:  96.92145124772115
PL:  [-5.51969142]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.94914327e-03]
 [ 6.01998174e-03]
 [ 8.21349374e-04]
 [ 1.27096320e-02]
 [ 2.40801501e-02]
 [ 3.55100721e-03]
 [-1.51265379e-02]
 [ 1.29312367e-02]
 [ 3.08933332e-03]
 [ 7.71147332e-03]
 [-1.53904073e-02]
 [-7.55225247e-03]
 [-2.27522251e-02]
 [ 2.02553700e-03]
 [-6.58379517e-03]
 [ 2.33261689e-03]
 [ 7.21348035e-03]
 [-5.29310955e-03]
 [-1.12880839e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.45484074]
curr_Stock_Price:  100.4337198412417
curr_Factors:  [100.43371984]
mat_Sqrt:  [[0.15]]
grads:  [0.03966096]
Stock Position:  0.039660955140741694
Bond Position:  [4.47154348]


portfolio before change:  [8.49145903]
curr_Stock_Price:  101.3288132754644
curr_Factors:  [101.32881328]
mat_Sqrt:  [[0.15]]
grads:  [0.04013321]
Stock Position:  0.040133211613489386
Bond Position:  [4.42480832]


portfolio before change:  [8.48648375]
curr_Stock_Price:  101.17727745287264
curr_Factors:  [101.17727745]
mat_Sqrt:  [[0.15]]
grads:  [0.00547566]
Stock Position:  0.005475662490830354
Bond Position:  [7.93247113]


portfolio before change:  [8.48831908]
curr_Stock_Price:  101.15024314978635
curr_Factors:  [101.15024315]
mat_Sqrt:  [[0.15]]
grads:  [0.08473088]
Stock Position:  0.08473087976384948
Bond Position:  [-0.08223001]


portfolio before change:  [8.53647953]
curr_Stock_Price:  101.71887884634842
curr_Factors:  [101.71887885]
mat_Sqrt:  [[0.15]]
grads:  [0.16053433]
Stock Position:  0.1605343342507012
Bond Position:  [-7.79289297]


portfolio before change:  [8.35625083]
curr_Stock_Price:  100.60833614651459
curr_Factors:  [100.60833615]
mat_Sqrt:  [[0.15]]
grads:  [0.02367338]
Stock Position:  0.023673381426515632
Bond Position:  [5.97451131]


portfolio before change:  [8.32588928]
curr_Stock_Price:  99.26271687989995
curr_Factors:  [99.26271688]
mat_Sqrt:  [[0.15]]
grads:  [-0.10084359]
Stock Position:  -0.10084358611385759
Bond Position:  [18.33589762]


portfolio before change:  [8.2271216]
curr_Stock_Price:  100.28759346271075
curr_Factors:  [100.28759346]
mat_Sqrt:  [[0.15]]
grads:  [0.08620824]
Stock Position:  0.08620824480665214
Bond Position:  [-0.41849581]


portfolio before change:  [8.21484841]
curr_Stock_Price:  100.14644048403176
curr_Factors:  [100.14644048]
mat_Sqrt:  [[0.15]]
grads:  [0.02059556]
Stock Position:  0.02059555544343803
Bond Position:  [6.15227685]


portfolio before change:  [8.25126433]
curr_Stock_Price:  101.8398957807985
curr_Factors:  [101.83989578]
mat_Sqrt:  [[0.15]]
grads:  [0.05140982]
Stock Position:  0.051409822126481076
Bond Position:  [3.0156934]


portfolio before change:  [8.24290992]
curr_Stock_Price:  101.66272294857286
curr_Factors:  [101.66272295]
mat_Sqrt:  [[0.15]]
grads:  [-0.10260272]
Stock Position:  -0.10260271527107385
Bond Position:  [18.67378134]


portfolio before change:  [8.16647491]
curr_Stock_Price:  102.45318971534056
curr_Factors:  [102.45318972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034835]
Stock Position:  -0.05034834978431801
Bond Position:  [13.32482394]


portfolio before change:  [8.183719]
curr_Stock_Price:  102.17686562489995
curr_Factors:  [102.17686562]
mat_Sqrt:  [[0.15]]
grads:  [-0.1516815]
Stock Position:  -0.15168150070137165
Bond Position:  [23.68205931]


portfolio before change:  [8.35195208]
curr_Stock_Price:  101.1067824052057
curr_Factors:  [101.10678241]
mat_Sqrt:  [[0.15]]
grads:  [0.01350358]
Stock Position:  0.01350358000713204
Bond Position:  [6.98664856]


portfolio before change:  [8.346478]
curr_Stock_Price:  100.57203807628835
curr_Factors:  [100.57203808]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389197]
Stock Position:  -0.04389196780055446
Bond Position:  [12.76078266]


portfolio before change:  [8.23392533]
curr_Stock_Price:  103.20904123899311
curr_Factors:  [103.20904124]
mat_Sqrt:  [[0.15]]
grads:  [0.01555078]
Stock Position:  0.015550779269622913
Bond Position:  [6.62894432]


portfolio before change:  [8.24408617]
curr_Stock_Price:  103.75585560853793
curr_Factors:  [103.75585561]
mat_Sqrt:  [[0.15]]
grads:  [0.04808987]
Stock Position:  0.04808986897398648
Bond Position:  [3.25448067]


portfolio before change:  [8.29256626]
curr_Stock_Price:  104.74704916167781
curr_Factors:  [104.74704916]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352874]
Stock Position:  -0.035287397021123844
Bond Position:  [11.98881697]


portfolio before change:  [8.33075179]
curr_Stock_Price:  103.74986731956074
curr_Factors:  [103.74986732]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.33075179]
Stock Price:  104.11380836081278
PL:  [4.21694343]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.59763250e-03]
 [ 1.03727019e-02]
 [ 1.04221632e-03]
 [ 2.96031334e-03]
 [ 1.55956926e-03]
 [ 4.56848989e-03]
 [-1.08163984e-02]
 [ 1.27822225e-02]
 [ 5.29068059e-03]
 [ 9.04595587e-03]
 [-1.71393364e-02]
 [-5.50511185e-03]
 [-2.20715992e-02]
 [ 3.48838757e-03]
 [ 2.77464752e-04]
 [ 2.79159078e-03]
 [ 7.47469738e-03]
 [-5.18936174e-03]
 [-1.09663718e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.44978256]
curr_Stock_Price:  99.97927114722793
curr_Factors:  [99.97927115]
mat_Sqrt:  [[0.15]]
grads:  [0.01731755]
Stock Position:  0.017317549993532525
Bond Position:  [-0.28161346]


portfolio before change:  [1.44388651]
curr_Stock_Price:  99.64287032387749
curr_Factors:  [99.64287032]
mat_Sqrt:  [[0.15]]
grads:  [0.06915135]
Stock Position:  0.06915134596809866
Bond Position:  [-5.44655209]


portfolio before change:  [1.4168393]
curr_Stock_Price:  99.27143273709083
curr_Factors:  [99.27143274]
mat_Sqrt:  [[0.15]]
grads:  [0.00694811]
Stock Position:  0.006948108780039196
Bond Position:  [0.72709058]


portfolio before change:  [1.41758623]
curr_Stock_Price:  99.35276980147837
curr_Factors:  [99.3527698]
mat_Sqrt:  [[0.15]]
grads:  [0.01973542]
Stock Position:  0.019735422261450017
Bond Position:  [-0.54318263]


portfolio before change:  [1.40141662]
curr_Stock_Price:  98.5403320820362
curr_Factors:  [98.54033208]
mat_Sqrt:  [[0.15]]
grads:  [0.01039713]
Stock Position:  0.010397128410657486
Bond Position:  [0.37688013]


portfolio before change:  [1.40038112]
curr_Stock_Price:  98.43167444522109
curr_Factors:  [98.43167445]
mat_Sqrt:  [[0.15]]
grads:  [0.0304566]
Stock Position:  0.0304565992793113
Bond Position:  [-1.59751294]


portfolio before change:  [1.43808321]
curr_Stock_Price:  99.68268450751408
curr_Factors:  [99.68268451]
mat_Sqrt:  [[0.15]]
grads:  [-0.07210932]
Stock Position:  -0.07210932260894842
Bond Position:  [8.62613406]


portfolio before change:  [1.40092038]
curr_Stock_Price:  100.22796249392952
curr_Factors:  [100.22796249]
mat_Sqrt:  [[0.15]]
grads:  [0.08521482]
Stock Position:  0.08521481655655049
Bond Position:  [-7.13998706]


portfolio before change:  [1.53802446]
curr_Stock_Price:  101.85783514294206
curr_Factors:  [101.85783514]
mat_Sqrt:  [[0.15]]
grads:  [0.0352712]
Stock Position:  0.03527120390825532
Bond Position:  [-2.05462401]


portfolio before change:  [1.50965185]
curr_Stock_Price:  101.06798719385824
curr_Factors:  [101.06798719]
mat_Sqrt:  [[0.15]]
grads:  [0.06030637]
Stock Position:  0.06030637244736864
Bond Position:  [-4.58539183]


portfolio before change:  [1.45271055]
curr_Stock_Price:  100.14279788939363
curr_Factors:  [100.14279789]
mat_Sqrt:  [[0.15]]
grads:  [-0.11426224]
Stock Position:  -0.11426224236232722
Bond Position:  [12.89525119]


portfolio before change:  [1.37046861]
curr_Stock_Price:  100.89078039059656
curr_Factors:  [100.89078039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03670075]
Stock Position:  -0.03670074563384688
Bond Position:  [5.07323548]


portfolio before change:  [1.30884757]
curr_Stock_Price:  102.60435606726006
curr_Factors:  [102.60435607]
mat_Sqrt:  [[0.15]]
grads:  [-0.14714399]
Stock Position:  -0.14714399497034292
Bond Position:  [16.40646242]


portfolio before change:  [1.19945059]
curr_Stock_Price:  103.37570330021046
curr_Factors:  [103.3757033]
mat_Sqrt:  [[0.15]]
grads:  [0.02325592]
Stock Position:  0.023255917147594417
Bond Position:  [-1.20464621]


portfolio before change:  [1.15026004]
curr_Stock_Price:  101.27347055901
curr_Factors:  [101.27347056]
mat_Sqrt:  [[0.15]]
grads:  [0.00184977]
Stock Position:  0.0018497650110961667
Bond Position:  [0.96292791]


portfolio before change:  [1.15327312]
curr_Stock_Price:  102.77221410170193
curr_Factors:  [102.7722141]
mat_Sqrt:  [[0.15]]
grads:  [0.01861061]
Stock Position:  0.018610605212467934
Bond Position:  [-0.75937998]


portfolio before change:  [1.15666905]
curr_Stock_Price:  102.96488891024121
curr_Factors:  [102.96488891]
mat_Sqrt:  [[0.15]]
grads:  [0.04983132]
Stock Position:  0.04983131587628787
Bond Position:  [-3.97420686]


portfolio before change:  [1.20117525]
curr_Stock_Price:  103.87796683725523
curr_Factors:  [103.87796684]
mat_Sqrt:  [[0.15]]
grads:  [-0.03459574]
Stock Position:  -0.034595744923697394
Bond Position:  [4.79491089]


portfolio before change:  [1.18768482]
curr_Stock_Price:  104.30256550947537
curr_Factors:  [104.30256551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.18768482]
Stock Price:  105.21435286113514
PL:  [-4.02666804]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.97205048e-03]
 [ 7.03390439e-03]
 [ 1.78145701e-03]
 [ 1.46751419e-02]
 [ 2.35154359e-02]
 [ 5.98109300e-03]
 [ 2.59764872e-02]
 [ 1.31906306e-02]
 [ 4.52956468e-03]
 [ 1.24698284e-02]
 [-1.78259441e-02]
 [ 6.01018830e-03]
 [ 7.59643690e-03]
 [-3.12006450e-04]
 [-1.68420635e-02]
 [ 7.40193338e-03]
 [ 4.46515103e-03]
 [-1.92128169e-03]
 [-1.28033534e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.60535144]
curr_Stock_Price:  100.63810721941087
curr_Factors:  [100.63810722]
mat_Sqrt:  [[0.15]]
grads:  [0.03981367]
Stock Position:  0.03981366984961445
Bond Position:  [7.59857907]


portfolio before change:  [11.69093179]
curr_Stock_Price:  102.73990948871341
curr_Factors:  [102.73990949]
mat_Sqrt:  [[0.15]]
grads:  [0.0468927]
Stock Position:  0.04689269594176556
Bond Position:  [6.87318045]


portfolio before change:  [11.69222952]
curr_Stock_Price:  102.73093620868976
curr_Factors:  [102.73093621]
mat_Sqrt:  [[0.15]]
grads:  [0.01187638]
Stock Position:  0.01187638008226865
Bond Position:  [10.47215787]


portfolio before change:  [11.69017699]
curr_Stock_Price:  102.33764322767435
curr_Factors:  [102.33764323]
mat_Sqrt:  [[0.15]]
grads:  [0.09783428]
Stock Position:  0.09783427955041188
Bond Position:  [1.67804739]


portfolio before change:  [11.8623766]
curr_Stock_Price:  104.09347003092827
curr_Factors:  [104.09347003]
mat_Sqrt:  [[0.15]]
grads:  [0.15676957]
Stock Position:  0.15676957252152635
Bond Position:  [-4.4563122]


portfolio before change:  [11.94391854]
curr_Stock_Price:  104.62071620130881
curr_Factors:  [104.6207162]
mat_Sqrt:  [[0.15]]
grads:  [0.03987395]
Stock Position:  0.03987395333737242
Bond Position:  [7.77227698]


portfolio before change:  [11.81347447]
curr_Stock_Price:  101.30056921726377
curr_Factors:  [101.30056922]
mat_Sqrt:  [[0.15]]
grads:  [0.17317658]
Stock Position:  0.17317658105945902
Bond Position:  [-5.72941177]


portfolio before change:  [11.66706536]
curr_Stock_Price:  100.46340881089586
curr_Factors:  [100.46340881]
mat_Sqrt:  [[0.15]]
grads:  [0.08793754]
Stock Position:  0.08793753731802043
Bond Position:  [2.8325606]


portfolio before change:  [11.76611073]
curr_Stock_Price:  101.58167004064728
curr_Factors:  [101.58167004]
mat_Sqrt:  [[0.15]]
grads:  [0.0301971]
Stock Position:  0.030197097877701334
Bond Position:  [8.69863909]


portfolio before change:  [11.68291667]
curr_Stock_Price:  98.75461076771376
curr_Factors:  [98.75461077]
mat_Sqrt:  [[0.15]]
grads:  [0.08313219]
Stock Position:  0.08313218925775533
Bond Position:  [3.47322968]


portfolio before change:  [11.53490143]
curr_Stock_Price:  96.96368407834203
curr_Factors:  [96.96368408]
mat_Sqrt:  [[0.15]]
grads:  [-0.11883963]
Stock Position:  -0.11883962763101229
Bond Position:  [23.05802954]


portfolio before change:  [11.5643062]
curr_Stock_Price:  96.76476436083213
curr_Factors:  [96.76476436]
mat_Sqrt:  [[0.15]]
grads:  [0.04006792]
Stock Position:  0.04006792198036451
Bond Position:  [7.68714318]


portfolio before change:  [11.53320888]
curr_Stock_Price:  95.94067994603387
curr_Factors:  [95.94067995]
mat_Sqrt:  [[0.15]]
grads:  [0.05064291]
Stock Position:  0.05064291265873033
Bond Position:  [6.67449341]


portfolio before change:  [11.63173678]
curr_Stock_Price:  97.8532687770105
curr_Factors:  [97.85326878]
mat_Sqrt:  [[0.15]]
grads:  [-0.00208004]
Stock Position:  -0.0020800429973854484
Bond Position:  [11.83527579]


portfolio before change:  [11.6371303]
curr_Stock_Price:  96.68294035961223
curr_Factors:  [96.68294036]
mat_Sqrt:  [[0.15]]
grads:  [-0.11228042]
Stock Position:  -0.11228042326144073
Bond Position:  [22.49273177]


portfolio before change:  [11.518762]
curr_Stock_Price:  97.78724850555335
curr_Factors:  [97.78724851]
mat_Sqrt:  [[0.15]]
grads:  [0.04934622]
Stock Position:  0.0493462225112869
Bond Position:  [6.69333068]


portfolio before change:  [11.5272295]
curr_Stock_Price:  97.92492778494582
curr_Factors:  [97.92492778]
mat_Sqrt:  [[0.15]]
grads:  [0.02976767]
Stock Position:  0.029767673537402138
Bond Position:  [8.61223222]


portfolio before change:  [11.53399132]
curr_Stock_Price:  98.07974329114356
curr_Factors:  [98.07974329]
mat_Sqrt:  [[0.15]]
grads:  [-0.01280854]
Stock Position:  -0.012808544582476274
Bond Position:  [12.79025009]


portfolio before change:  [11.52471342]
curr_Stock_Price:  99.05377018418096
curr_Factors:  [99.05377018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.52471342]
Stock Price:  98.8360162647806
PL:  [11.52471342]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.09270287e-02]
 [ 2.77433647e-03]
 [-3.57720088e-03]
 [-2.42524942e-03]
 [-1.08565876e-02]
 [-4.45989332e-03]
 [ 9.11830433e-05]
 [ 5.18399922e-03]
 [ 4.68118144e-03]
 [ 3.48121789e-03]
 [-1.79066469e-02]
 [ 5.65795105e-03]
 [-7.07252093e-03]
 [-1.14835511e-03]
 [-1.67460425e-02]
 [ 6.56461339e-03]
 [ 3.32883742e-03]
 [-3.64744960e-03]
 [-1.18228225e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.22636063]
curr_Stock_Price:  99.22178878338742
curr_Factors:  [99.22178878]
mat_Sqrt:  [[0.15]]
grads:  [0.07284686]
Stock Position:  0.07284685783662632
Bond Position:  [-17.45435617]


portfolio before change:  [-10.31084201]
curr_Stock_Price:  98.1219850181763
curr_Factors:  [98.12198502]
mat_Sqrt:  [[0.15]]
grads:  [0.01849558]
Stock Position:  0.01849557649394189
Bond Position:  [-12.12566469]


portfolio before change:  [-10.33718922]
curr_Stock_Price:  96.86139105086139
curr_Factors:  [96.86139105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02384801]
Stock Position:  -0.023848005855145415
Bond Position:  [-8.0272382]


portfolio before change:  [-10.31911731]
curr_Stock_Price:  96.01943521344313
curr_Factors:  [96.01943521]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616833]
Stock Position:  -0.016168329463913726
Bond Position:  [-8.76664345]


portfolio before change:  [-10.30906645]
curr_Stock_Price:  95.2622264457296
curr_Factors:  [95.26222645]
mat_Sqrt:  [[0.15]]
grads:  [-0.07237725]
Stock Position:  -0.07237725048722943
Bond Position:  [-3.41424842]


portfolio before change:  [-10.27816661]
curr_Stock_Price:  94.82350425215067
curr_Factors:  [94.82350425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02973262]
Stock Position:  -0.029732622114398005
Bond Position:  [-7.45881519]


portfolio before change:  [-10.2996434]
curr_Stock_Price:  95.48311151575169
curr_Factors:  [95.48311152]
mat_Sqrt:  [[0.15]]
grads:  [0.00060789]
Stock Position:  0.0006078869552815502
Bond Position:  [-10.35768634]


portfolio before change:  [-10.30156966]
curr_Stock_Price:  96.57457953070504
curr_Factors:  [96.57457953]
mat_Sqrt:  [[0.15]]
grads:  [0.03455999]
Stock Position:  0.03455999479821905
Bond Position:  [-13.63918662]


portfolio before change:  [-10.23757022]
curr_Stock_Price:  98.52509097563951
curr_Factors:  [98.52509098]
mat_Sqrt:  [[0.15]]
grads:  [0.03120788]
Stock Position:  0.031207876241817496
Bond Position:  [-13.31232906]


portfolio before change:  [-10.27493876]
curr_Stock_Price:  97.43433925514437
curr_Factors:  [97.43433926]
mat_Sqrt:  [[0.15]]
grads:  [0.02320812]
Stock Position:  0.023208119250558275
Bond Position:  [-12.53620652]


portfolio before change:  [-10.28368551]
curr_Stock_Price:  97.1925141487174
curr_Factors:  [97.19251415]
mat_Sqrt:  [[0.15]]
grads:  [-0.11937765]
Stock Position:  -0.11937764592294167
Bond Position:  [1.31892803]


portfolio before change:  [-10.42980604]
curr_Stock_Price:  98.41929580227703
curr_Factors:  [98.4192958]
mat_Sqrt:  [[0.15]]
grads:  [0.03771967]
Stock Position:  0.03771967368780291
Bond Position:  [-14.14214976]


portfolio before change:  [-10.46289344]
curr_Stock_Price:  97.63584729063128
curr_Factors:  [97.63584729]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715014]
Stock Position:  -0.04715013952043474
Bond Position:  [-5.85934962]


portfolio before change:  [-10.45328085]
curr_Stock_Price:  97.4009039165373
curr_Factors:  [97.40090392]
mat_Sqrt:  [[0.15]]
grads:  [-0.0076557]
Stock Position:  -0.007655700701822255
Bond Position:  [-9.70760868]


portfolio before change:  [-10.44816601]
curr_Stock_Price:  96.41574933285567
curr_Factors:  [96.41574933]
mat_Sqrt:  [[0.15]]
grads:  [-0.11164028]
Stock Position:  -0.11164028325962812
Bond Position:  [0.31571556]


portfolio before change:  [-10.34790184]
curr_Stock_Price:  95.51835614453059
curr_Factors:  [95.51835614]
mat_Sqrt:  [[0.15]]
grads:  [0.04376409]
Stock Position:  0.043764089266649965
Bond Position:  [-14.5281757]


portfolio before change:  [-10.34034945]
curr_Stock_Price:  95.77392841640139
curr_Factors:  [95.77392842]
mat_Sqrt:  [[0.15]]
grads:  [0.02219225]
Stock Position:  0.02219224948151686
Bond Position:  [-12.46578836]


portfolio before change:  [-10.35788363]
curr_Stock_Price:  95.1242715198991
curr_Factors:  [95.12427152]
mat_Sqrt:  [[0.15]]
grads:  [-0.02431633]
Stock Position:  -0.024316330673576518
Bond Position:  [-8.04481039]


portfolio before change:  [-10.34220685]
curr_Stock_Price:  94.39684938447392
curr_Factors:  [94.39684938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.34220685]
Stock Price:  95.45221793889804
PL:  [-10.34220685]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.03933698e-03]
 [ 7.77156334e-03]
 [ 1.08978003e-03]
 [ 6.10639017e-03]
 [ 2.50395091e-02]
 [ 6.72795136e-03]
 [ 3.31690532e-02]
 [ 1.25241519e-02]
 [ 8.22153982e-03]
 [-9.26222020e-03]
 [-8.91182989e-03]
 [-3.58381185e-02]
 [-1.52717708e-02]
 [ 8.39786455e-03]
 [ 5.19305063e-02]
 [-1.82802886e-03]
 [ 5.35871038e-03]
 [-5.79272462e-03]
 [-9.36235024e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.42379836]
curr_Stock_Price:  99.91271107434133
curr_Factors:  [99.91271107]
mat_Sqrt:  [[0.15]]
grads:  [0.01359558]
Stock Position:  0.01359557984011671
Bond Position:  [-0.93457288]


portfolio before change:  [0.41220754]
curr_Stock_Price:  99.07735565422014
curr_Factors:  [99.07735565]
mat_Sqrt:  [[0.15]]
grads:  [0.05181042]
Stock Position:  0.051810422279202864
Bond Position:  [-4.72103209]


portfolio before change:  [0.48217216]
curr_Stock_Price:  100.45053546873456
curr_Factors:  [100.45053547]
mat_Sqrt:  [[0.15]]
grads:  [0.0072652]
Stock Position:  0.007265200214169008
Bond Position:  [-0.24762109]


portfolio before change:  [0.48188363]
curr_Stock_Price:  100.41934323882792
curr_Factors:  [100.41934324]
mat_Sqrt:  [[0.15]]
grads:  [0.04070927]
Stock Position:  0.04070926782793202
Bond Position:  [-3.60611431]


portfolio before change:  [0.54226643]
curr_Stock_Price:  101.92476061232665
curr_Factors:  [101.92476061]
mat_Sqrt:  [[0.15]]
grads:  [0.16693006]
Stock Position:  0.16693006055540047
Bond Position:  [-16.47204003]


portfolio before change:  [0.65418068]
curr_Stock_Price:  102.61985874749297
curr_Factors:  [102.61985875]
mat_Sqrt:  [[0.15]]
grads:  [0.04485301]
Stock Position:  0.04485300908349077
Bond Position:  [-3.94862878]


portfolio before change:  [0.62682426]
curr_Stock_Price:  102.03195761901499
curr_Factors:  [102.03195762]
mat_Sqrt:  [[0.15]]
grads:  [0.22112702]
Stock Position:  0.2211270214025815
Bond Position:  [-21.93519861]


portfolio before change:  [0.47900338]
curr_Stock_Price:  101.38827146714902
curr_Factors:  [101.38827147]
mat_Sqrt:  [[0.15]]
grads:  [0.08349435]
Stock Position:  0.08349434573958377
Bond Position:  [-7.98634401]


portfolio before change:  [0.5932447]
curr_Stock_Price:  102.78043950716405
curr_Factors:  [102.78043951]
mat_Sqrt:  [[0.15]]
grads:  [0.05481027]
Stock Position:  0.05481026544301036
Bond Position:  [-5.04017847]


portfolio before change:  [0.66594794]
curr_Stock_Price:  104.12988444679628
curr_Factors:  [104.12988445]
mat_Sqrt:  [[0.15]]
grads:  [-0.06174813]
Stock Position:  -0.061748134698051696
Bond Position:  [7.09577407]


portfolio before change:  [0.56656901]
curr_Stock_Price:  105.76804062046405
curr_Factors:  [105.76804062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0594122]
Stock Position:  -0.05941219926372344
Bond Position:  [6.85048092]


portfolio before change:  [0.46144607]
curr_Stock_Price:  107.56625339639426
curr_Factors:  [107.5662534]
mat_Sqrt:  [[0.15]]
grads:  [-0.23892079]
Stock Position:  -0.23892078998173732
Bond Position:  [26.16126031]


portfolio before change:  [0.25210476]
curr_Stock_Price:  108.46982667254497
curr_Factors:  [108.46982667]
mat_Sqrt:  [[0.15]]
grads:  [-0.10181181]
Stock Position:  -0.10181180512942872
Bond Position:  [11.29561362]


portfolio before change:  [0.32948407]
curr_Stock_Price:  107.73754368677652
curr_Factors:  [107.73754369]
mat_Sqrt:  [[0.15]]
grads:  [0.05598576]
Stock Position:  0.055985763686402686
Bond Position:  [-5.70228459]


portfolio before change:  [0.34052184]
curr_Stock_Price:  107.96016315862725
curr_Factors:  [107.96016316]
mat_Sqrt:  [[0.15]]
grads:  [0.34620338]
Stock Position:  0.34620337503808557
Bond Position:  [-37.03565101]


portfolio before change:  [0.65573562]
curr_Stock_Price:  108.89739794580152
curr_Factors:  [108.89739795]
mat_Sqrt:  [[0.15]]
grads:  [-0.01218686]
Stock Position:  -0.012186859056092271
Bond Position:  [1.98285286]


portfolio before change:  [0.65044615]
curr_Stock_Price:  109.37210981859994
curr_Factors:  [109.37210982]
mat_Sqrt:  [[0.15]]
grads:  [0.03572474]
Stock Position:  0.03572473588088531
Bond Position:  [-3.25684359]


portfolio before change:  [0.61100588]
curr_Stock_Price:  108.29089954767058
curr_Factors:  [108.29089955]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861816]
Stock Position:  -0.038618164125169996
Bond Position:  [4.79300162]


portfolio before change:  [0.60476198]
curr_Stock_Price:  108.48361477217466
curr_Factors:  [108.48361477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.60476198]
Stock Price:  107.81634056389578
PL:  [-7.21157859]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.81539088e-03]
 [ 4.66913448e-03]
 [-2.60734586e-03]
 [-1.10520845e-03]
 [-4.57401560e-03]
 [-3.80372010e-03]
 [-4.77371258e-03]
 [ 2.77208956e-04]
 [ 4.58167710e-03]
 [-1.69408496e-02]
 [-1.73571714e-02]
 [ 9.01983000e-03]
 [ 1.39043991e-02]
 [-2.78163416e-03]
 [-1.63726614e-02]
 [ 6.44723913e-03]
 [ 2.64244464e-03]
 [-2.80375217e-03]
 [-1.24903686e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.8527497]
curr_Stock_Price:  100.00541338356201
curr_Factors:  [100.00541338]
mat_Sqrt:  [[0.15]]
grads:  [0.01876927]
Stock Position:  0.018769272500857838
Bond Position:  [-0.02427916]


portfolio before change:  [1.82377366]
curr_Stock_Price:  98.46193515350372
curr_Factors:  [98.46193515]
mat_Sqrt:  [[0.15]]
grads:  [0.03112756]
Stock Position:  0.03112756321611753
Bond Position:  [-1.24110645]


portfolio before change:  [1.79272762]
curr_Stock_Price:  97.47452319542364
curr_Factors:  [97.4745232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01738231]
Stock Position:  -0.0173823057106858
Bond Position:  [3.48705958]


portfolio before change:  [1.80576714]
curr_Stock_Price:  96.77452120686806
curr_Factors:  [96.77452121]
mat_Sqrt:  [[0.15]]
grads:  [-0.00736806]
Stock Position:  -0.007368056343370668
Bond Position:  [2.51880726]


portfolio before change:  [1.8089095]
curr_Stock_Price:  96.43351182229705
curr_Factors:  [96.43351182]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049344]
Stock Position:  -0.030493437303967686
Bond Position:  [4.74949874]


portfolio before change:  [1.8517597]
curr_Stock_Price:  95.06722845546726
curr_Factors:  [95.06722846]
mat_Sqrt:  [[0.15]]
grads:  [-0.02535813]
Stock Position:  -0.025358134007468863
Bond Position:  [4.26248722]


portfolio before change:  [1.80249126]
curr_Stock_Price:  97.05216140496981
curr_Factors:  [97.0521614]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182475]
Stock Position:  -0.031824750553164874
Bond Position:  [4.89115208]


portfolio before change:  [1.85644992]
curr_Stock_Price:  95.39509511638319
curr_Factors:  [95.39509512]
mat_Sqrt:  [[0.15]]
grads:  [0.00184806]
Stock Position:  0.0018480597068634929
Bond Position:  [1.68015409]


portfolio before change:  [1.85758078]
curr_Stock_Price:  95.77969831402099
curr_Factors:  [95.77969831]
mat_Sqrt:  [[0.15]]
grads:  [0.03054451]
Stock Position:  0.03054451398900827
Bond Position:  [-1.06796356]


portfolio before change:  [1.82927253]
curr_Stock_Price:  94.86165372088725
curr_Factors:  [94.86165372]
mat_Sqrt:  [[0.15]]
grads:  [-0.112939]
Stock Position:  -0.1129389975519543
Bond Position:  [12.54285261]


portfolio before change:  [1.94924368]
curr_Stock_Price:  93.82715676380163
curr_Factors:  [93.82715676]
mat_Sqrt:  [[0.15]]
grads:  [-0.11571448]
Stock Position:  -0.11571447571082547
Bond Position:  [12.80640393]


portfolio before change:  [1.86940907]
curr_Stock_Price:  94.54475591602655
curr_Factors:  [94.54475592]
mat_Sqrt:  [[0.15]]
grads:  [0.0601322]
Stock Position:  0.06013220001686053
Bond Position:  [-3.8157751]


portfolio before change:  [1.90570824]
curr_Stock_Price:  95.1642779880492
curr_Factors:  [95.16427799]
mat_Sqrt:  [[0.15]]
grads:  [0.09269599]
Stock Position:  0.09269599379030428
Bond Position:  [-6.91563909]


portfolio before change:  [1.95762055]
curr_Stock_Price:  95.74295928722654
curr_Factors:  [95.74295929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01854423]
Stock Position:  -0.018544227717330268
Bond Position:  [3.73309979]


portfolio before change:  [1.97064243]
curr_Stock_Price:  95.0910859786038
curr_Factors:  [95.09108598]
mat_Sqrt:  [[0.15]]
grads:  [-0.10915108]
Stock Position:  -0.10915107622506445
Bond Position:  [12.3499368]


portfolio before change:  [2.01173197]
curr_Stock_Price:  94.74292931105151
curr_Factors:  [94.74292931]
mat_Sqrt:  [[0.15]]
grads:  [0.04298159]
Stock Position:  0.042981594179095424
Bond Position:  [-2.06047017]


portfolio before change:  [2.00116649]
curr_Stock_Price:  94.50910127789456
curr_Factors:  [94.50910128]
mat_Sqrt:  [[0.15]]
grads:  [0.0176163]
Stock Position:  0.017616297601042066
Bond Position:  [0.33626603]


portfolio before change:  [2.03202975]
curr_Stock_Price:  96.25630073556748
curr_Factors:  [96.25630074]
mat_Sqrt:  [[0.15]]
grads:  [-0.01869168]
Stock Position:  -0.018691681126332294
Bond Position:  [3.83122183]


portfolio before change:  [2.03504143]
curr_Stock_Price:  96.14642564276667
curr_Factors:  [96.14642564]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.03504143]
Stock Price:  97.33081850992033
PL:  [2.03504143]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.08184815e-02]
 [ 1.01370603e-02]
 [ 9.45474855e-04]
 [ 1.02496367e-02]
 [ 1.58466359e-02]
 [ 3.23394637e-03]
 [-8.05281348e-03]
 [ 1.08520454e-02]
 [ 4.71565029e-03]
 [ 5.03031102e-03]
 [-1.76414593e-02]
 [ 6.72069150e-03]
 [ 4.65804353e-03]
 [-7.95426879e-04]
 [-1.61830100e-02]
 [ 6.58709126e-03]
 [ 3.42741182e-03]
 [-2.19559547e-03]
 [-1.26546896e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.15045149]
curr_Stock_Price:  99.22671334043888
curr_Factors:  [99.22671334]
mat_Sqrt:  [[0.15]]
grads:  [0.07212321]
Stock Position:  0.0721232102103404
Bond Position:  [-17.3070006]


portfolio before change:  [-10.11357819]
curr_Stock_Price:  99.79796632739861
curr_Factors:  [99.79796633]
mat_Sqrt:  [[0.15]]
grads:  [0.0675804]
Stock Position:  0.06758040179485392
Bond Position:  [-16.85796485]


portfolio before change:  [-10.06427887]
curr_Stock_Price:  100.589828020373
curr_Factors:  [100.58982802]
mat_Sqrt:  [[0.15]]
grads:  [0.00630317]
Stock Position:  0.006303165702237133
Bond Position:  [-10.69831323]


portfolio before change:  [-10.06556269]
curr_Stock_Price:  100.81052578677026
curr_Factors:  [100.81052579]
mat_Sqrt:  [[0.15]]
grads:  [0.06833091]
Stock Position:  0.0683309115351431
Bond Position:  [-16.95403781]


portfolio before change:  [-10.0746392]
curr_Stock_Price:  100.7397310926814
curr_Factors:  [100.73973109]
mat_Sqrt:  [[0.15]]
grads:  [0.10564424]
Stock Position:  0.10564423957375056
Bond Position:  [-20.71721148]


portfolio before change:  [-10.17380243]
curr_Stock_Price:  99.85011054751453
curr_Factors:  [99.85011055]
mat_Sqrt:  [[0.15]]
grads:  [0.02155964]
Stock Position:  0.021559642481395337
Bond Position:  [-12.32653512]


portfolio before change:  [-10.20984216]
curr_Stock_Price:  98.32143465244455
curr_Factors:  [98.32143465]
mat_Sqrt:  [[0.15]]
grads:  [-0.05368542]
Stock Position:  -0.053685423201554665
Bond Position:  [-4.93141433]


portfolio before change:  [-10.22754388]
curr_Stock_Price:  98.62819799036717
curr_Factors:  [98.62819799]
mat_Sqrt:  [[0.15]]
grads:  [0.07234697]
Stock Position:  0.0723469692854428
Bond Position:  [-17.36299509]


portfolio before change:  [-10.29139805]
curr_Stock_Price:  97.80559440643033
curr_Factors:  [97.80559441]
mat_Sqrt:  [[0.15]]
grads:  [0.03143767]
Stock Position:  0.03143766860049426
Bond Position:  [-13.36617792]


portfolio before change:  [-10.30144213]
curr_Stock_Price:  97.59240699626065
curr_Factors:  [97.592407]
mat_Sqrt:  [[0.15]]
grads:  [0.03353541]
Stock Position:  0.03353540678979232
Bond Position:  [-13.5742432]


portfolio before change:  [-10.35354183]
curr_Stock_Price:  96.1400399427357
curr_Factors:  [96.14003994]
mat_Sqrt:  [[0.15]]
grads:  [-0.11760973]
Stock Position:  -0.11760972881787797
Bond Position:  [0.95346219]


portfolio before change:  [-10.36122258]
curr_Stock_Price:  96.20737404310793
curr_Factors:  [96.20737404]
mat_Sqrt:  [[0.15]]
grads:  [0.04480461]
Stock Position:  0.044804609974389904
Bond Position:  [-14.67175645]


portfolio before change:  [-10.36063581]
curr_Stock_Price:  96.30234577490707
curr_Factors:  [96.30234577]
mat_Sqrt:  [[0.15]]
grads:  [0.03105362]
Stock Position:  0.031053623518345876
Bond Position:  [-13.3511726]


portfolio before change:  [-10.32210784]
curr_Stock_Price:  97.6505357612752
curr_Factors:  [97.65053576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00530285]
Stock Position:  -0.005302845858902648
Bond Position:  [-9.8042821]


portfolio before change:  [-10.32969277]
curr_Stock_Price:  98.61861086040726
curr_Factors:  [98.61861086]
mat_Sqrt:  [[0.15]]
grads:  [-0.10788673]
Stock Position:  -0.10788673315251382
Bond Position:  [0.30994699]


portfolio before change:  [-10.01115998]
curr_Stock_Price:  95.66685503029915
curr_Factors:  [95.66685503]
mat_Sqrt:  [[0.15]]
grads:  [0.04391394]
Stock Position:  0.04391394176543425
Bond Position:  [-14.21226868]


portfolio before change:  [-10.00203474]
curr_Stock_Price:  95.95557305501258
curr_Factors:  [95.95557306]
mat_Sqrt:  [[0.15]]
grads:  [0.02284941]
Stock Position:  0.022849412108982687
Bond Position:  [-12.19456317]


portfolio before change:  [-9.97956735]
curr_Stock_Price:  97.07229368120478
curr_Factors:  [97.07229368]
mat_Sqrt:  [[0.15]]
grads:  [-0.0146373]
Stock Position:  -0.014637303122030168
Bond Position:  [-8.55869077]


portfolio before change:  [-9.98034552]
curr_Stock_Price:  96.97925919145254
curr_Factors:  [96.97925919]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.98034552]
Stock Price:  98.07229481201426
PL:  [-9.98034552]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.39410758e-03]
 [ 5.66181144e-03]
 [ 8.95758029e-04]
 [ 2.96645092e-03]
 [ 3.62666899e-04]
 [ 4.35460570e-03]
 [-7.42185255e-03]
 [ 9.40012232e-03]
 [ 4.67416385e-03]
 [ 1.31068009e-02]
 [-1.85120253e-02]
 [ 5.43587975e-03]
 [-1.00940608e-02]
 [-6.21722356e-04]
 [-1.69602687e-02]
 [ 6.70016446e-03]
 [ 4.26949679e-03]
 [-1.83204030e-03]
 [-1.27476289e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.40884789]
curr_Stock_Price:  99.66407058658014
curr_Factors:  [99.66407059]
mat_Sqrt:  [[0.15]]
grads:  [0.00929405]
Stock Position:  0.009294050540827492
Bond Position:  [-4.3351308]


portfolio before change:  [-3.41941436]
curr_Stock_Price:  98.64378921246006
curr_Factors:  [98.64378921]
mat_Sqrt:  [[0.15]]
grads:  [0.03774541]
Stock Position:  0.03774540963210478
Bond Position:  [-7.14276459]


portfolio before change:  [-3.40097175]
curr_Stock_Price:  99.17970928843292
curr_Factors:  [99.17970929]
mat_Sqrt:  [[0.15]]
grads:  [0.00597172]
Stock Position:  0.0059717201913991845
Bond Position:  [-3.99324522]


portfolio before change:  [-3.40117353]
curr_Stock_Price:  99.31311268513744
curr_Factors:  [99.31311269]
mat_Sqrt:  [[0.15]]
grads:  [0.01977634]
Stock Position:  0.019776339450662147
Bond Position:  [-5.36522336]


portfolio before change:  [-3.42802062]
curr_Stock_Price:  98.02340955154611
curr_Factors:  [98.02340955]
mat_Sqrt:  [[0.15]]
grads:  [0.00241778]
Stock Position:  0.0024177793255427023
Bond Position:  [-3.66501959]


portfolio before change:  [-3.42822481]
curr_Stock_Price:  98.31796856111805
curr_Factors:  [98.31796856]
mat_Sqrt:  [[0.15]]
grads:  [0.0290307]
Stock Position:  0.029030704659428804
Bond Position:  [-6.28246471]


portfolio before change:  [-3.43678523]
curr_Stock_Price:  98.07720251378784
curr_Factors:  [98.07720251]
mat_Sqrt:  [[0.15]]
grads:  [-0.04947902]
Stock Position:  -0.04947901702068366
Bond Position:  [1.41597835]


portfolio before change:  [-3.4306285]
curr_Stock_Price:  97.95992678778232
curr_Factors:  [97.95992679]
mat_Sqrt:  [[0.15]]
grads:  [0.06266748]
Stock Position:  0.0626674821223105
Bond Position:  [-9.56953046]


portfolio before change:  [-3.48200684]
curr_Stock_Price:  97.17825087987751
curr_Factors:  [97.17825088]
mat_Sqrt:  [[0.15]]
grads:  [0.03116109]
Stock Position:  0.031161092340820398
Bond Position:  [-6.51018729]


portfolio before change:  [-3.4271004]
curr_Stock_Price:  98.99250664688593
curr_Factors:  [98.99250665]
mat_Sqrt:  [[0.15]]
grads:  [0.08737867]
Stock Position:  0.08737867294017596
Bond Position:  [-12.07693426]


portfolio before change:  [-3.46334452]
curr_Stock_Price:  98.61227080851388
curr_Factors:  [98.61227081]
mat_Sqrt:  [[0.15]]
grads:  [-0.1234135]
Stock Position:  -0.12341350172878421
Bond Position:  [8.70674114]


portfolio before change:  [-3.37530992]
curr_Stock_Price:  97.91658001085821
curr_Factors:  [97.91658001]
mat_Sqrt:  [[0.15]]
grads:  [0.0362392]
Stock Position:  0.03623919835384306
Bond Position:  [-6.92372829]


portfolio before change:  [-3.37477206]
curr_Stock_Price:  97.97919213241623
curr_Factors:  [97.97919213]
mat_Sqrt:  [[0.15]]
grads:  [-0.06729374]
Stock Position:  -0.06729373854342045
Bond Position:  [3.21861408]


portfolio before change:  [-3.35747304]
curr_Stock_Price:  97.73408372239528
curr_Factors:  [97.73408372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414482]
Stock Position:  -0.00414481570914561
Bond Position:  [-2.95238328]


portfolio before change:  [-3.35502847]
curr_Stock_Price:  96.96619550954856
curr_Factors:  [96.96619551]
mat_Sqrt:  [[0.15]]
grads:  [-0.11306846]
Stock Position:  -0.1130684579611297
Bond Position:  [7.60878973]


portfolio before change:  [-3.26296111]
curr_Stock_Price:  96.16875892860706
curr_Factors:  [96.16875893]
mat_Sqrt:  [[0.15]]
grads:  [0.04466776]
Stock Position:  0.04466776305987021
Bond Position:  [-7.55860445]


portfolio before change:  [-3.20506151]
curr_Stock_Price:  97.50729673126895
curr_Factors:  [97.50729673]
mat_Sqrt:  [[0.15]]
grads:  [0.02846331]
Stock Position:  0.028463311952028076
Bond Position:  [-5.98044212]


portfolio before change:  [-3.18082943]
curr_Stock_Price:  98.41117518465863
curr_Factors:  [98.41117518]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122136]
Stock Position:  -0.01221360202436462
Bond Position:  [-1.97887451]


portfolio before change:  [-3.18353335]
curr_Stock_Price:  98.59205019785628
curr_Factors:  [98.5920502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.18353335]
Stock Price:  99.858236944861
PL:  [-3.18353335]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 7.52017867e-03]
 [ 6.29403648e-03]
 [ 1.01103844e-03]
 [ 1.14553368e-02]
 [ 1.81131482e-02]
 [ 5.56106603e-03]
 [-7.70115178e-03]
 [ 1.34356653e-02]
 [ 4.42681189e-03]
 [ 7.44109186e-03]
 [-1.70979870e-02]
 [ 3.16259193e-05]
 [-2.55488651e-02]
 [ 2.43961655e-03]
 [ 1.90966606e-03]
 [ 3.90830253e-03]
 [ 7.52527584e-03]
 [-2.63795724e-03]
 [-1.20289798e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.682146]
curr_Stock_Price:  100.83771230919594
curr_Factors:  [100.83771231]
mat_Sqrt:  [[0.15]]
grads:  [0.05013452]
Stock Position:  0.05013452447833645
Bond Position:  [9.62669524]


portfolio before change:  [14.68150444]
curr_Stock_Price:  100.77690521739409
curr_Factors:  [100.77690522]
mat_Sqrt:  [[0.15]]
grads:  [0.04196024]
Stock Position:  0.041960243186485266
Bond Position:  [10.45288099]


portfolio before change:  [14.67357609]
curr_Stock_Price:  100.525670023876
curr_Factors:  [100.52567002]
mat_Sqrt:  [[0.15]]
grads:  [0.00674026]
Stock Position:  0.0067402562944997016
Bond Position:  [13.99600731]


portfolio before change:  [14.68010205]
curr_Stock_Price:  100.97469041335842
curr_Factors:  [100.97469041]
mat_Sqrt:  [[0.15]]
grads:  [0.07636891]
Stock Position:  0.07636891195112099
Bond Position:  [6.9687748]


portfolio before change:  [14.68204678]
curr_Stock_Price:  100.97733966622268
curr_Factors:  [100.97733967]
mat_Sqrt:  [[0.15]]
grads:  [0.12075432]
Stock Position:  0.12075432146202189
Bond Position:  [2.48859664]


portfolio before change:  [14.69950091]
curr_Stock_Price:  101.11672934405094
curr_Factors:  [101.11672934]
mat_Sqrt:  [[0.15]]
grads:  [0.03707377]
Stock Position:  0.03707377353272997
Bond Position:  [10.95072219]


portfolio before change:  [14.65606923]
curr_Stock_Price:  99.87138255297192
curr_Factors:  [99.87138255]
mat_Sqrt:  [[0.15]]
grads:  [-0.05134101]
Stock Position:  -0.05134101187646211
Bond Position:  [19.78356707]


portfolio before change:  [14.61826743]
curr_Stock_Price:  100.70401720572492
curr_Factors:  [100.70401721]
mat_Sqrt:  [[0.15]]
grads:  [0.0895711]
Stock Position:  0.089571101884009
Bond Position:  [5.59809765]


portfolio before change:  [14.68566865]
curr_Stock_Price:  101.44087894143225
curr_Factors:  [101.44087894]
mat_Sqrt:  [[0.15]]
grads:  [0.02951208]
Stock Position:  0.029512079252064113
Bond Position:  [11.69193739]


portfolio before change:  [14.70144437]
curr_Stock_Price:  101.87637402083973
curr_Factors:  [101.87637402]
mat_Sqrt:  [[0.15]]
grads:  [0.04960728]
Stock Position:  0.049607279095194017
Bond Position:  [9.64763465]


portfolio before change:  [14.61944711]
curr_Stock_Price:  100.17481997933172
curr_Factors:  [100.17481998]
mat_Sqrt:  [[0.15]]
grads:  [-0.11398658]
Stock Position:  -0.11398658031116692
Bond Position:  [26.03803227]


portfolio before change:  [14.60893767]
curr_Stock_Price:  100.32413371514741
curr_Factors:  [100.32413372]
mat_Sqrt:  [[0.15]]
grads:  [0.00021084]
Stock Position:  0.00021083946225201647
Bond Position:  [14.58778538]


portfolio before change:  [14.61273049]
curr_Stock_Price:  101.01385766162628
curr_Factors:  [101.01385766]
mat_Sqrt:  [[0.15]]
grads:  [-0.17032577]
Stock Position:  -0.17032576706335403
Bond Position:  [31.81799328]


portfolio before change:  [14.71769411]
curr_Stock_Price:  100.4443130597902
curr_Factors:  [100.44431306]
mat_Sqrt:  [[0.15]]
grads:  [0.01626411]
Stock Position:  0.016264110345883712
Bond Position:  [13.08405672]


portfolio before change:  [14.73737637]
curr_Stock_Price:  101.45333491704477
curr_Factors:  [101.45333492]
mat_Sqrt:  [[0.15]]
grads:  [0.01273111]
Stock Position:  0.012731107090168427
Bond Position:  [13.4457631]


portfolio before change:  [14.75113259]
curr_Stock_Price:  102.26978862170934
curr_Factors:  [102.26978862]
mat_Sqrt:  [[0.15]]
grads:  [0.02605535]
Stock Position:  0.02605535021722683
Bond Position:  [12.08645743]


portfolio before change:  [14.69643568]
curr_Stock_Price:  100.05454661239956
curr_Factors:  [100.05454661]
mat_Sqrt:  [[0.15]]
grads:  [0.05016851]
Stock Position:  0.05016850561862621
Bond Position:  [9.67684859]


portfolio before change:  [14.72976803]
curr_Stock_Price:  100.67072668067232
curr_Factors:  [100.67072668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01758638]
Stock Position:  -0.017586381625745082
Bond Position:  [16.50020184]


portfolio before change:  [14.70873526]
curr_Stock_Price:  102.10128435072266
curr_Factors:  [102.10128435]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.70873526]
Stock Price:  100.97734872218544
PL:  [13.73138654]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.67011049e-03]
 [ 6.90500323e-03]
 [-1.35581456e-03]
 [ 2.39650947e-03]
 [ 9.87346820e-04]
 [ 4.72084904e-03]
 [-7.69853839e-03]
 [ 1.22958797e-02]
 [ 4.14508610e-03]
 [ 9.02049991e-03]
 [-1.57516233e-02]
 [-1.83716702e-03]
 [-2.60251562e-02]
 [ 2.06226176e-03]
 [ 8.89989952e-04]
 [ 2.56905797e-03]
 [ 7.23642235e-03]
 [-4.31484782e-03]
 [-1.23357594e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.8792158]
curr_Stock_Price:  99.82817885989205
curr_Factors:  [99.82817886]
mat_Sqrt:  [[0.15]]
grads:  [0.01113407]
Stock Position:  0.011134069955295891
Bond Position:  [-1.99070972]


portfolio before change:  [-0.88964996]
curr_Stock_Price:  98.93574473114082
curr_Factors:  [98.93574473]
mat_Sqrt:  [[0.15]]
grads:  [0.04603335]
Stock Position:  0.04603335488287174
Bond Position:  [-5.44399421]


portfolio before change:  [-0.92185424]
curr_Stock_Price:  98.2657281165948
curr_Factors:  [98.26572812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00903876]
Stock Position:  -0.009038763754056095
Bond Position:  [-0.03365354]


portfolio before change:  [-0.92648902]
curr_Stock_Price:  98.77756370075883
curr_Factors:  [98.7775637]
mat_Sqrt:  [[0.15]]
grads:  [0.01597673]
Stock Position:  0.01597672977607255
Bond Position:  [-2.50463146]


portfolio before change:  [-0.934201]
curr_Stock_Price:  98.33405932551531
curr_Factors:  [98.33405933]
mat_Sqrt:  [[0.15]]
grads:  [0.00658231]
Stock Position:  0.006582312130687703
Bond Position:  [-1.58146647]


portfolio before change:  [-0.93270549]
curr_Stock_Price:  98.62133307768593
curr_Factors:  [98.62133308]
mat_Sqrt:  [[0.15]]
grads:  [0.03147233]
Stock Position:  0.03147232692118011
Bond Position:  [-4.03654833]


portfolio before change:  [-0.89436781]
curr_Stock_Price:  99.87154085266906
curr_Factors:  [99.87154085]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132359]
Stock Position:  -0.05132358924078572
Bond Position:  [4.23139813]


portfolio before change:  [-0.85936341]
curr_Stock_Price:  99.2101214002821
curr_Factors:  [99.2101214]
mat_Sqrt:  [[0.15]]
grads:  [0.08197253]
Stock Position:  0.08197253100649064
Bond Position:  [-8.99186816]


portfolio before change:  [-0.71039373]
curr_Stock_Price:  101.0548604056746
curr_Factors:  [101.05486041]
mat_Sqrt:  [[0.15]]
grads:  [0.02763391]
Stock Position:  0.027633907348374884
Bond Position:  [-3.50293438]


portfolio before change:  [-0.69496872]
curr_Stock_Price:  101.64474628860106
curr_Factors:  [101.64474629]
mat_Sqrt:  [[0.15]]
grads:  [0.06013667]
Stock Position:  0.06013666606970311
Bond Position:  [-6.80754488]


portfolio before change:  [-0.71221719]
curr_Stock_Price:  101.38622901671154
curr_Factors:  [101.38622902]
mat_Sqrt:  [[0.15]]
grads:  [-0.10501082]
Stock Position:  -0.10501082202844103
Bond Position:  [9.93443407]


portfolio before change:  [-0.61771798]
curr_Stock_Price:  100.50998330772651
curr_Factors:  [100.50998331]
mat_Sqrt:  [[0.15]]
grads:  [-0.01224778]
Stock Position:  -0.012247780126860952
Bond Position:  [0.61330619]


portfolio before change:  [-0.61456981]
curr_Stock_Price:  100.2654631291625
curr_Factors:  [100.26546313]
mat_Sqrt:  [[0.15]]
grads:  [-0.17350104]
Stock Position:  -0.1735010410726016
Bond Position:  [16.78159243]


portfolio before change:  [-0.72903448]
curr_Stock_Price:  100.94938174471866
curr_Factors:  [100.94938174]
mat_Sqrt:  [[0.15]]
grads:  [0.01374841]
Stock Position:  0.013748411722746089
Bond Position:  [-2.11692814]


portfolio before change:  [-0.72418007]
curr_Stock_Price:  101.34096924993771
curr_Factors:  [101.34096925]
mat_Sqrt:  [[0.15]]
grads:  [0.00593327]
Stock Position:  0.005933266344541217
Bond Position:  [-1.32546303]


portfolio before change:  [-0.71497009]
curr_Stock_Price:  102.94908681478151
curr_Factors:  [102.94908681]
mat_Sqrt:  [[0.15]]
grads:  [0.01712705]
Stock Position:  0.017127053132212466
Bond Position:  [-2.47818457]


portfolio before change:  [-0.70296193]
curr_Stock_Price:  103.68638707363768
curr_Factors:  [103.68638707]
mat_Sqrt:  [[0.15]]
grads:  [0.04824282]
Stock Position:  0.04824281569749582
Bond Position:  [-5.70508519]


portfolio before change:  [-0.77505851]
curr_Stock_Price:  102.22150299606298
curr_Factors:  [102.221503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02876565]
Stock Position:  -0.028765652124229744
Bond Position:  [2.16540968]


portfolio before change:  [-0.74855869]
curr_Stock_Price:  101.31909322315035
curr_Factors:  [101.31909322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.74855869]
Stock Price:  99.98185564402452
PL:  [-0.74855869]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 6.41560145e-03]
 [ 1.01148198e-02]
 [ 1.13825395e-03]
 [ 1.37488920e-02]
 [ 1.30933756e-02]
 [ 3.22005148e-03]
 [ 2.55327604e-02]
 [ 1.31711353e-02]
 [ 2.83288719e-03]
 [ 9.76154804e-03]
 [-1.58880053e-02]
 [ 6.19537504e-03]
 [-2.28117151e-02]
 [ 4.08035711e-03]
 [-1.05362150e-02]
 [ 7.15139887e-03]
 [ 7.48478443e-03]
 [-2.93076600e-03]
 [-1.23976915e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.10881342]
curr_Stock_Price:  100.73564335868693
curr_Factors:  [100.73564336]
mat_Sqrt:  [[0.15]]
grads:  [0.04277068]
Stock Position:  0.04277067636632374
Bond Position:  [8.80028182]


portfolio before change:  [13.071126]
curr_Stock_Price:  99.80304734082662
curr_Factors:  [99.80304734]
mat_Sqrt:  [[0.15]]
grads:  [0.06743213]
Stock Position:  0.06743213229508321
Bond Position:  [6.34119371]


portfolio before change:  [13.11090738]
curr_Stock_Price:  100.36948176793813
curr_Factors:  [100.36948177]
mat_Sqrt:  [[0.15]]
grads:  [0.00758836]
Stock Position:  0.007588359682929062
Bond Position:  [12.34926765]


portfolio before change:  [13.12206205]
curr_Stock_Price:  101.43255266451835
curr_Factors:  [101.43255266]
mat_Sqrt:  [[0.15]]
grads:  [0.09165928]
Stock Position:  0.09165927969397004
Bond Position:  [3.82482733]


portfolio before change:  [13.03676028]
curr_Stock_Price:  100.4914794274621
curr_Factors:  [100.49147943]
mat_Sqrt:  [[0.15]]
grads:  [0.08728917]
Stock Position:  0.08728917049521562
Bond Position:  [4.2649424]


portfolio before change:  [12.98270666]
curr_Stock_Price:  99.86001521023628
curr_Factors:  [99.86001521]
mat_Sqrt:  [[0.15]]
grads:  [0.02146701]
Stock Position:  0.021467009853133504
Bond Position:  [10.83901073]


portfolio before change:  [13.01543615]
curr_Stock_Price:  101.25841192058192
curr_Factors:  [101.25841192]
mat_Sqrt:  [[0.15]]
grads:  [0.1702184]
Stock Position:  0.170218402609345
Bond Position:  [-4.22060898]


portfolio before change:  [12.87661221]
curr_Stock_Price:  100.44904788988894
curr_Factors:  [100.44904789]
mat_Sqrt:  [[0.15]]
grads:  [0.08780757]
Stock Position:  0.08780756846203368
Bond Position:  [4.05642556]


portfolio before change:  [12.83219885]
curr_Stock_Price:  99.93169396216422
curr_Factors:  [99.93169396]
mat_Sqrt:  [[0.15]]
grads:  [0.01888591]
Stock Position:  0.01888591458384975
Bond Position:  [10.94489741]


portfolio before change:  [12.83149665]
curr_Stock_Price:  99.74961284984941
curr_Factors:  [99.74961285]
mat_Sqrt:  [[0.15]]
grads:  [0.06507699]
Stock Position:  0.06507698690613509
Bond Position:  [6.3400924]


portfolio before change:  [12.93279427]
curr_Stock_Price:  101.28183502334105
curr_Factors:  [101.28183502]
mat_Sqrt:  [[0.15]]
grads:  [-0.10592004]
Stock Position:  -0.10592003504144155
Bond Position:  [23.66056979]


portfolio before change:  [13.15865264]
curr_Stock_Price:  99.20533947558968
curr_Factors:  [99.20533948]
mat_Sqrt:  [[0.15]]
grads:  [0.0413025]
Stock Position:  0.04130250027279699
Bond Position:  [9.06122408]


portfolio before change:  [13.17467072]
curr_Stock_Price:  99.53830959803055
curr_Factors:  [99.5383096]
mat_Sqrt:  [[0.15]]
grads:  [-0.1520781]
Stock Position:  -0.15207810040594
Bond Position:  [28.31226776]


portfolio before change:  [13.14178771]
curr_Stock_Price:  99.80108222863211
curr_Factors:  [99.80108223]
mat_Sqrt:  [[0.15]]
grads:  [0.02720238]
Stock Position:  0.027202380706434718
Bond Position:  [10.42696068]


portfolio before change:  [13.15312275]
curr_Stock_Price:  100.1219352862599
curr_Factors:  [100.12193529]
mat_Sqrt:  [[0.15]]
grads:  [-0.07024143]
Stock Position:  -0.07024143350423102
Bond Position:  [20.18583101]


portfolio before change:  [13.09947428]
curr_Stock_Price:  100.95756105516007
curr_Factors:  [100.95756106]
mat_Sqrt:  [[0.15]]
grads:  [0.04767599]
Stock Position:  0.047675992449497016
Bond Position:  [8.28622236]


portfolio before change:  [13.11094061]
curr_Stock_Price:  101.15461027698333
curr_Factors:  [101.15461028]
mat_Sqrt:  [[0.15]]
grads:  [0.04989856]
Stock Position:  0.04989856288413911
Bond Position:  [8.06347093]


portfolio before change:  [13.10631474]
curr_Stock_Price:  101.02150036509993
curr_Factors:  [101.02150037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01953844]
Stock Position:  -0.019538439996657036
Bond Position:  [15.08011726]


portfolio before change:  [13.10775525]
curr_Stock_Price:  101.14075214051836
curr_Factors:  [101.14075214]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.10775525]
Stock Price:  100.36475374757985
PL:  [12.7430015]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 5.65793919e-03]
 [ 2.35538927e-03]
 [ 1.35101005e-03]
 [ 5.35745914e-03]
 [ 1.35483979e-03]
 [ 3.26813149e-03]
 [-2.59298528e-03]
 [ 5.43734363e-03]
 [ 6.62255805e-03]
 [ 8.88077040e-03]
 [-1.51829474e-02]
 [-8.67083261e-03]
 [-2.14755911e-02]
 [ 2.72136434e-03]
 [ 6.34461100e-03]
 [ 3.39521664e-03]
 [ 7.47573225e-03]
 [-4.13303147e-03]
 [-1.24407059e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.31042381]
curr_Stock_Price:  100.29460215652699
curr_Factors:  [100.29460216]
mat_Sqrt:  [[0.15]]
grads:  [0.03771959]
Stock Position:  0.03771959459725509
Bond Position:  [2.52735207]


portfolio before change:  [6.22533487]
curr_Stock_Price:  98.02202061080682
curr_Factors:  [98.02202061]
mat_Sqrt:  [[0.15]]
grads:  [0.0157026]
Stock Position:  0.015702595149818806
Bond Position:  [4.68613476]


portfolio before change:  [6.25658802]
curr_Stock_Price:  99.93772140941024
curr_Factors:  [99.93772141]
mat_Sqrt:  [[0.15]]
grads:  [0.00900673]
Stock Position:  0.009006733699360598
Bond Position:  [5.35647558]


portfolio before change:  [6.26166074]
curr_Stock_Price:  100.35223646651596
curr_Factors:  [100.35223647]
mat_Sqrt:  [[0.15]]
grads:  [0.03571639]
Stock Position:  0.035716394252736004
Bond Position:  [2.6774407]


portfolio before change:  [6.19497961]
curr_Stock_Price:  98.46653191276533
curr_Factors:  [98.46653191]
mat_Sqrt:  [[0.15]]
grads:  [0.00903227]
Stock Position:  0.00903226524623623
Bond Position:  [5.30560378]


portfolio before change:  [6.21312287]
curr_Stock_Price:  100.32837774136352
curr_Factors:  [100.32837774]
mat_Sqrt:  [[0.15]]
grads:  [0.02178754]
Stock Position:  0.021787543234777242
Bond Position:  [4.027214]


portfolio before change:  [6.21119882]
curr_Stock_Price:  100.19385262684631
curr_Factors:  [100.19385263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01728657]
Stock Position:  -0.017286568501389453
Bond Position:  [7.94320672]


portfolio before change:  [6.17091812]
curr_Stock_Price:  102.63891571975795
curr_Factors:  [102.63891572]
mat_Sqrt:  [[0.15]]
grads:  [0.03624896]
Stock Position:  0.03624895754260146
Bond Position:  [2.45036442]


portfolio before change:  [6.15455688]
curr_Stock_Price:  102.17065655220101
curr_Factors:  [102.17065655]
mat_Sqrt:  [[0.15]]
grads:  [0.04415039]
Stock Position:  0.04415038698578009
Bond Position:  [1.64368286]


portfolio before change:  [6.13293285]
curr_Stock_Price:  101.67156673020943
curr_Factors:  [101.67156673]
mat_Sqrt:  [[0.15]]
grads:  [0.05920514]
Stock Position:  0.05920513601311579
Bond Position:  [0.11345391]


portfolio before change:  [6.14183944]
curr_Stock_Price:  101.82152376148828
curr_Factors:  [101.82152376]
mat_Sqrt:  [[0.15]]
grads:  [-0.10121965]
Stock Position:  -0.10121964943638205
Bond Position:  [16.44817838]


portfolio before change:  [6.17496733]
curr_Stock_Price:  101.53486663108485
curr_Factors:  [101.53486663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05780555]
Stock Position:  -0.05780555073362928
Bond Position:  [12.04424622]


portfolio before change:  [6.08699025]
curr_Stock_Price:  103.10891131002572
curr_Factors:  [103.10891131]
mat_Sqrt:  [[0.15]]
grads:  [-0.14317061]
Stock Position:  -0.14317060701370277
Bond Position:  [20.84915567]


portfolio before change:  [6.17994203]
curr_Stock_Price:  102.49608416025335
curr_Factors:  [102.49608416]
mat_Sqrt:  [[0.15]]
grads:  [0.01814243]
Stock Position:  0.018142428908391947
Bond Position:  [4.32041411]


portfolio before change:  [6.1745385]
curr_Stock_Price:  102.13870273600452
curr_Factors:  [102.13870274]
mat_Sqrt:  [[0.15]]
grads:  [0.04229741]
Stock Position:  0.04229740663431109
Bond Position:  [1.85433626]


portfolio before change:  [6.18972277]
curr_Stock_Price:  102.48672951667187
curr_Factors:  [102.48672952]
mat_Sqrt:  [[0.15]]
grads:  [0.02263478]
Stock Position:  0.02263477758646065
Bond Position:  [3.86995844]


portfolio before change:  [6.1765591]
curr_Stock_Price:  101.86241227542419
curr_Factors:  [101.86241228]
mat_Sqrt:  [[0.15]]
grads:  [0.04983821]
Stock Position:  0.04983821499684624
Bond Position:  [1.0999183]


portfolio before change:  [6.18752375]
curr_Stock_Price:  102.07689892207746
curr_Factors:  [102.07689892]
mat_Sqrt:  [[0.15]]
grads:  [-0.02755354]
Stock Position:  -0.02755354310269511
Bond Position:  [9.00010398]


portfolio before change:  [6.21898114]
curr_Stock_Price:  101.01688692883938
curr_Factors:  [101.01688693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.21898114]
Stock Price:  102.61447141059516
PL:  [3.60450973]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 1.30325137e-02]
 [ 2.27994830e-03]
 [-9.69260586e-04]
 [ 1.05340105e-03]
 [ 7.87252057e-03]
 [ 4.57394829e-03]
 [ 6.19324324e-03]
 [ 8.77556193e-03]
 [ 6.56377344e-03]
 [ 9.07232174e-03]
 [-1.50029195e-02]
 [-8.65661914e-03]
 [-2.19512717e-02]
 [ 3.87467635e-03]
 [ 2.52040109e-02]
 [ 1.28287951e-03]
 [ 7.09189019e-03]
 [-5.34490961e-03]
 [-1.13803427e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.69876744]
curr_Stock_Price:  99.12626732805427
curr_Factors:  [99.12626733]
mat_Sqrt:  [[0.15]]
grads:  [0.08688342]
Stock Position:  0.0868834247174853
Bond Position:  [-20.31119703]


portfolio before change:  [-11.80135059]
curr_Stock_Price:  98.004019746753
curr_Factors:  [98.00401975]
mat_Sqrt:  [[0.15]]
grads:  [0.01519966]
Stock Position:  0.015199655365515959
Bond Position:  [-13.29097791]


portfolio before change:  [-11.7970127]
curr_Stock_Price:  98.50804723808128
curr_Factors:  [98.50804724]
mat_Sqrt:  [[0.15]]
grads:  [-0.00646174]
Stock Position:  -0.006461737242783694
Bond Position:  [-11.16047959]


portfolio before change:  [-11.79658029]
curr_Stock_Price:  98.00928273538966
curr_Factors:  [98.00928274]
mat_Sqrt:  [[0.15]]
grads:  [0.00702267]
Stock Position:  0.007022673698437928
Bond Position:  [-12.4848675]


portfolio before change:  [-11.78563781]
curr_Stock_Price:  100.01195123488802
curr_Factors:  [100.01195123]
mat_Sqrt:  [[0.15]]
grads:  [0.05248347]
Stock Position:  0.05248347046119145
Bond Position:  [-17.0346121]


portfolio before change:  [-11.74348401]
curr_Stock_Price:  100.89628653319558
curr_Factors:  [100.89628653]
mat_Sqrt:  [[0.15]]
grads:  [0.03049299]
Stock Position:  0.030492988570181602
Bond Position:  [-14.82011332]


portfolio before change:  [-11.76099151]
curr_Stock_Price:  100.4436576218854
curr_Factors:  [100.44365762]
mat_Sqrt:  [[0.15]]
grads:  [0.04128829]
Stock Position:  0.04128828824804356
Bond Position:  [-15.9081382]


portfolio before change:  [-11.70000424]
curr_Stock_Price:  102.01710130132369
curr_Factors:  [102.0171013]
mat_Sqrt:  [[0.15]]
grads:  [0.05850375]
Stock Position:  0.05850374620854887
Bond Position:  [-17.66838685]


portfolio before change:  [-11.69665975]
curr_Stock_Price:  102.14977897976962
curr_Factors:  [102.14977898]
mat_Sqrt:  [[0.15]]
grads:  [0.04375849]
Stock Position:  0.043758489606889175
Bond Position:  [-16.16657979]


portfolio before change:  [-11.72323663]
curr_Stock_Price:  101.6347993257705
curr_Factors:  [101.63479933]
mat_Sqrt:  [[0.15]]
grads:  [0.06048214]
Stock Position:  0.06048214490199535
Bond Position:  [-17.87032729]


portfolio before change:  [-11.70807666]
curr_Stock_Price:  101.95932672159323
curr_Factors:  [101.95932672]
mat_Sqrt:  [[0.15]]
grads:  [-0.10001946]
Stock Position:  -0.10001946309890986
Bond Position:  [-1.51015954]


portfolio before change:  [-11.65116918]
curr_Stock_Price:  101.3865875347579
curr_Factors:  [101.38658753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05771079]
Stock Position:  -0.057710794252702806
Bond Position:  [-5.80006869]


portfolio before change:  [-11.72787692]
curr_Stock_Price:  102.69063365422866
curr_Factors:  [102.69063365]
mat_Sqrt:  [[0.15]]
grads:  [-0.14634181]
Stock Position:  -0.14634181148972342
Bond Position:  [3.30005644]


portfolio before change:  [-11.89213474]
curr_Stock_Price:  103.81869770849546
curr_Factors:  [103.81869771]
mat_Sqrt:  [[0.15]]
grads:  [0.02583118]
Stock Position:  0.025831175681541592
Bond Position:  [-14.57389376]


portfolio before change:  [-11.88552417]
curr_Stock_Price:  104.21567915698722
curr_Factors:  [104.21567916]
mat_Sqrt:  [[0.15]]
grads:  [0.16802674]
Stock Position:  0.16802673913966099
Bond Position:  [-29.3965449]


portfolio before change:  [-11.84372205]
curr_Stock_Price:  104.50820507712288
curr_Factors:  [104.50820508]
mat_Sqrt:  [[0.15]]
grads:  [0.00855253]
Stock Position:  0.00855253006442687
Bond Position:  [-12.73753161]


portfolio before change:  [-11.85019249]
curr_Stock_Price:  104.1240313209225
curr_Factors:  [104.12403132]
mat_Sqrt:  [[0.15]]
grads:  [0.04727927]
Stock Position:  0.047279267901633594
Bond Position:  [-16.77310046]


portfolio before change:  [-11.80817916]
curr_Stock_Price:  105.10135445649495
curr_Factors:  [105.10135446]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563273]
Stock Position:  -0.035632730717754024
Bond Position:  [-8.0631309]


portfolio before change:  [-11.75621103]
curr_Stock_Price:  103.58633829965564
curr_Factors:  [103.5863383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.75621103]
Stock Price:  103.2513819878057
PL:  [-15.00759302]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 2.69364207e-03]
 [ 1.04597217e-02]
 [ 4.47228385e-04]
 [ 2.98663932e-03]
 [ 1.17836869e-02]
 [ 3.09624023e-03]
 [-7.33165042e-03]
 [ 9.80718109e-03]
 [ 4.74600588e-03]
 [-1.26001747e-02]
 [-1.76081785e-02]
 [ 8.35289211e-03]
 [ 2.11882868e-04]
 [-1.50354247e-03]
 [-1.66390374e-02]
 [ 7.21179717e-03]
 [ 4.08922817e-03]
 [-2.65943683e-03]
 [-1.21784113e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.21118668]
curr_Stock_Price:  99.61201936818757
curr_Factors:  [99.61201937]
mat_Sqrt:  [[0.15]]
grads:  [0.01795761]
Stock Position:  0.017957613767074613
Bond Position:  [-5.99998085]


portfolio before change:  [-4.21067144]
curr_Stock_Price:  99.72425158453301
curr_Factors:  [99.72425158]
mat_Sqrt:  [[0.15]]
grads:  [0.06973148]
Stock Position:  0.06973147819039535
Bond Position:  [-11.16459091]


portfolio before change:  [-4.26261917]
curr_Stock_Price:  99.01931543388525
curr_Factors:  [99.01931543]
mat_Sqrt:  [[0.15]]
grads:  [0.00298152]
Stock Position:  0.0029815225666643195
Bond Position:  [-4.5578475]


portfolio before change:  [-4.26327174]
curr_Stock_Price:  99.18266810823262
curr_Factors:  [99.18266811]
mat_Sqrt:  [[0.15]]
grads:  [0.01991093]
Stock Position:  0.01991092879873963
Bond Position:  [-6.23809078]


portfolio before change:  [-4.24106763]
curr_Stock_Price:  100.3761744486806
curr_Factors:  [100.37617445]
mat_Sqrt:  [[0.15]]
grads:  [0.07855791]
Stock Position:  0.07855791234277634
Bond Position:  [-12.12641035]


portfolio before change:  [-4.2777148]
curr_Stock_Price:  99.9482712746671
curr_Factors:  [99.94827127]
mat_Sqrt:  [[0.15]]
grads:  [0.0206416]
Stock Position:  0.02064160151385495
Bond Position:  [-6.34080718]


portfolio before change:  [-4.31864276]
curr_Stock_Price:  98.04228710220312
curr_Factors:  [98.0422871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04887767]
Stock Position:  -0.0488776694506822
Bond Position:  [0.47343574]


portfolio before change:  [-4.32378387]
curr_Stock_Price:  98.1498920390973
curr_Factors:  [98.14989204]
mat_Sqrt:  [[0.15]]
grads:  [0.06538121]
Stock Position:  0.06538120724132697
Bond Position:  [-10.7409423]


portfolio before change:  [-4.31896832]
curr_Stock_Price:  98.26462102701672
curr_Factors:  [98.26462103]
mat_Sqrt:  [[0.15]]
grads:  [0.03164004]
Stock Position:  0.031640039168514884
Bond Position:  [-7.42806478]


portfolio before change:  [-4.40984105]
curr_Stock_Price:  95.45124008538842
curr_Factors:  [95.45124009]
mat_Sqrt:  [[0.15]]
grads:  [-0.08400116]
Stock Position:  -0.08400116490709411
Bond Position:  [3.60817431]


portfolio before change:  [-4.43946651]
curr_Stock_Price:  95.81465907852659
curr_Factors:  [95.81465908]
mat_Sqrt:  [[0.15]]
grads:  [-0.11738786]
Stock Position:  -0.11738785637468656
Bond Position:  [6.80801093]


portfolio before change:  [-4.3373961]
curr_Stock_Price:  94.95964566673763
curr_Factors:  [94.95964567]
mat_Sqrt:  [[0.15]]
grads:  [0.05568595]
Stock Position:  0.055685947388995766
Bond Position:  [-9.62531394]


portfolio before change:  [-4.23455929]
curr_Stock_Price:  96.84959189790119
curr_Factors:  [96.8495919]
mat_Sqrt:  [[0.15]]
grads:  [0.00141255]
Stock Position:  0.0014125524564601265
Bond Position:  [-4.37136442]


portfolio before change:  [-4.23537903]
curr_Stock_Price:  97.04302539762323
curr_Factors:  [97.0430254]
mat_Sqrt:  [[0.15]]
grads:  [-0.01002362]
Stock Position:  -0.010023616477290198
Bond Position:  [-3.26265696]


portfolio before change:  [-4.22610198]
curr_Stock_Price:  96.0361218486325
curr_Factors:  [96.03612185]
mat_Sqrt:  [[0.15]]
grads:  [-0.11092692]
Stock Position:  -0.11092691604734069
Bond Position:  [6.42688884]


portfolio before change:  [-4.32535903]
curr_Stock_Price:  96.9454050014237
curr_Factors:  [96.945405]
mat_Sqrt:  [[0.15]]
grads:  [0.04807865]
Stock Position:  0.048078647798407724
Bond Position:  [-8.98636302]


portfolio before change:  [-4.31656186]
curr_Stock_Price:  97.17511281401515
curr_Factors:  [97.17511281]
mat_Sqrt:  [[0.15]]
grads:  [0.02726152]
Stock Position:  0.027261521150309862
Bond Position:  [-6.96570326]


portfolio before change:  [-4.33807294]
curr_Stock_Price:  96.44993553143134
curr_Factors:  [96.44993553]
mat_Sqrt:  [[0.15]]
grads:  [-0.01772958]
Stock Position:  -0.017729578866238837
Bond Position:  [-2.62805621]


portfolio before change:  [-4.31974716]
curr_Stock_Price:  95.37924563115747
curr_Factors:  [95.37924563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.31974716]
Stock Price:  93.2518842960103
PL:  [-4.31974716]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.31216140e+00]
 [ 3.56453977e-02]
 [ 5.89362208e-03]
 [ 3.69547309e-04]
 [ 1.94445097e-03]
 [ 2.19430641e-03]
 [ 4.02753941e-03]
 [-1.69140360e-03]
 [ 1.27262052e-02]
 [ 3.36155255e-03]
 [ 1.28167176e-02]
 [-1.85278357e-02]
 [ 5.94848568e-03]
 [-2.59050162e-02]
 [ 2.06905619e-03]
 [-9.85068018e-03]
 [ 5.31046111e-03]
 [ 7.49530734e-03]
 [-3.04450643e-03]
 [-1.21492233e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.3121614]
mat_Sqrt:  [[0.15]]
grads:  [15.4144093]
init_Out:  [2.15417538]
Stock Position:  15.414409303054821
Bond position:  [-1539.28675492]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.59798899]
curr_Stock_Price:  97.96506671370318
curr_Factors:  [97.96506671]
mat_Sqrt:  [[0.15]]
grads:  [0.23763598]
Stock Position:  0.2376359845315899
Bond Position:  [-52.87801407]


portfolio before change:  [-29.43982965]
curr_Stock_Price:  98.68625590298507
curr_Factors:  [98.6862559]
mat_Sqrt:  [[0.15]]
grads:  [0.03929081]
Stock Position:  0.03929081388264839
Bond Position:  [-33.31729296]


portfolio before change:  [-29.43613983]
curr_Stock_Price:  98.992184457533
curr_Factors:  [98.99218446]
mat_Sqrt:  [[0.15]]
grads:  [0.00246365]
Stock Position:  0.00246364872791968
Bond Position:  [-29.6800218]


portfolio before change:  [-29.44472658]
curr_Stock_Price:  98.5189785158069
curr_Factors:  [98.51897852]
mat_Sqrt:  [[0.15]]
grads:  [0.01296301]
Stock Position:  0.012963006475258446
Bond Position:  [-30.72182873]


portfolio before change:  [-29.44916515]
curr_Stock_Price:  98.76913992256436
curr_Factors:  [98.76913992]
mat_Sqrt:  [[0.15]]
grads:  [0.01462871]
Stock Position:  0.014628709399605042
Bond Position:  [-30.8940302]


portfolio before change:  [-29.44622567]
curr_Stock_Price:  99.49811450268874
curr_Factors:  [99.4981145]
mat_Sqrt:  [[0.15]]
grads:  [0.02685026]
Stock Position:  0.026850262739351212
Bond Position:  [-32.11777618]


portfolio before change:  [-29.43452531]
curr_Stock_Price:  100.23296019883993
curr_Factors:  [100.2329602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01127602]
Stock Position:  -0.011276023984682915
Bond Position:  [-28.30429605]


portfolio before change:  [-29.44119723]
curr_Stock_Price:  100.19703951211675
curr_Factors:  [100.19703951]
mat_Sqrt:  [[0.15]]
grads:  [0.08484137]
Stock Position:  0.08484136793815814
Bond Position:  [-37.94205112]


portfolio before change:  [-29.43597534]
curr_Stock_Price:  100.37040525356176
curr_Factors:  [100.37040525]
mat_Sqrt:  [[0.15]]
grads:  [0.02241035]
Stock Position:  0.022410350309845693
Bond Position:  [-31.68531128]


portfolio before change:  [-29.47246589]
curr_Stock_Price:  99.0956269915887
curr_Factors:  [99.09562699]
mat_Sqrt:  [[0.15]]
grads:  [0.08544478]
Stock Position:  0.0854447841108578
Bond Position:  [-37.93967034]


portfolio before change:  [-29.51913337]
curr_Stock_Price:  98.66047600449964
curr_Factors:  [98.660476]
mat_Sqrt:  [[0.15]]
grads:  [-0.1235189]
Stock Position:  -0.12351890468671178
Bond Position:  [-17.33269944]


portfolio before change:  [-29.53046546]
curr_Stock_Price:  98.71713427017559
curr_Factors:  [98.71713427]
mat_Sqrt:  [[0.15]]
grads:  [0.03965657]
Stock Position:  0.039656571179577604
Bond Position:  [-33.44524852]


portfolio before change:  [-29.48896606]
curr_Stock_Price:  99.9744732074228
curr_Factors:  [99.97447321]
mat_Sqrt:  [[0.15]]
grads:  [-0.17270011]
Stock Position:  -0.17270010828646862
Bond Position:  [-12.22336371]


portfolio before change:  [-29.65483792]
curr_Stock_Price:  100.91723829238252
curr_Factors:  [100.91723829]
mat_Sqrt:  [[0.15]]
grads:  [0.01379371]
Stock Position:  0.013793707908331797
Bond Position:  [-31.04686082]


portfolio before change:  [-29.67055562]
curr_Stock_Price:  100.34052512158118
curr_Factors:  [100.34052512]
mat_Sqrt:  [[0.15]]
grads:  [-0.0656712]
Stock Position:  -0.06567120117594104
Bond Position:  [-23.0810728]


portfolio before change:  [-29.76862592]
curr_Stock_Price:  101.7460014477774
curr_Factors:  [101.74600145]
mat_Sqrt:  [[0.15]]
grads:  [0.03540307]
Stock Position:  0.03540307406051487
Bond Position:  [-33.37074715]


portfolio before change:  [-29.80631301]
curr_Stock_Price:  100.91716496018206
curr_Factors:  [100.91716496]
mat_Sqrt:  [[0.15]]
grads:  [0.04996872]
Stock Position:  0.04996871556858378
Bond Position:  [-34.84901412]


portfolio before change:  [-29.80406102]
curr_Stock_Price:  101.1366090070916
curr_Factors:  [101.13660901]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029671]
Stock Position:  -0.020296709521801036
Bond Position:  [-27.75132064]


portfolio before change:  [-29.82560599]
curr_Stock_Price:  101.85624663588963
curr_Factors:  [101.85624664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.82560599]
Stock Price:  103.70759022154883
PL:  [-33.53319621]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.9965651141103951
FINAL STD P&L:  16.28627625460329
