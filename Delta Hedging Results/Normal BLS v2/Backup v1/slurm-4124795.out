WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 00:30:13.859551: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 00:30:13.888785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-17 00:30:13.889543: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:30:13.891768: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:30:13.893960: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:30:13.894692: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:30:13.897073: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:30:13.898889: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:30:13.903866: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:30:13.905982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:30:13.906445: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 00:30:13.913653: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399760000 Hz
2019-12-17 00:30:13.913959: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55602fcba350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:30:13.913979: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 00:30:13.915263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-17 00:30:13.915301: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:30:13.915314: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 00:30:13.915326: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 00:30:13.915337: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 00:30:13.915349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 00:30:13.915361: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 00:30:13.915373: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 00:30:13.917393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 00:30:13.917443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 00:30:14.013470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 00:30:14.013508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 00:30:14.013520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 00:30:14.016528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2019-12-17 00:30:14.018767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5560302f3680 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 00:30:14.018789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 00:30:49.419733: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 5.1518e+01,   Y0: 2.0164e+00,  elapsed time  35
INFO   step:     1,    loss: 1.8801e+02,   Y0: 2.0214e+00,  elapsed time  52
INFO   step:     2,    loss: 3.3033e+01,   Y0: 2.0264e+00,  elapsed time  52
INFO   step:     3,    loss: 2.0036e+01,   Y0: 2.0313e+00,  elapsed time  52
INFO   step:     4,    loss: 1.6250e+01,   Y0: 2.0360e+00,  elapsed time  52
INFO   step:     5,    loss: 1.4413e+01,   Y0: 2.0405e+00,  elapsed time  53
INFO   step:     6,    loss: 1.3347e+01,   Y0: 2.0451e+00,  elapsed time  53
INFO   step:     7,    loss: 1.2625e+01,   Y0: 2.0498e+00,  elapsed time  53
INFO   step:     8,    loss: 1.2085e+01,   Y0: 2.0544e+00,  elapsed time  53
INFO   step:     9,    loss: 1.1689e+01,   Y0: 2.0591e+00,  elapsed time  53
INFO   step:    10,    loss: 1.1388e+01,   Y0: 2.0638e+00,  elapsed time  54
INFO   step:    11,    loss: 1.1148e+01,   Y0: 2.0680e+00,  elapsed time  54
INFO   step:    12,    loss: 1.0962e+01,   Y0: 2.0719e+00,  elapsed time  54
INFO   step:    13,    loss: 1.0817e+01,   Y0: 2.0761e+00,  elapsed time  54
INFO   step:    14,    loss: 1.0712e+01,   Y0: 2.0803e+00,  elapsed time  54
INFO   step:    15,    loss: 1.0620e+01,   Y0: 2.0846e+00,  elapsed time  54
INFO   step:    16,    loss: 1.0547e+01,   Y0: 2.0887e+00,  elapsed time  55
INFO   step:    17,    loss: 1.0464e+01,   Y0: 2.0926e+00,  elapsed time  55
INFO   step:    18,    loss: 1.0387e+01,   Y0: 2.0967e+00,  elapsed time  55
INFO   step:    19,    loss: 1.0315e+01,   Y0: 2.1005e+00,  elapsed time  55
INFO   step:    20,    loss: 1.0252e+01,   Y0: 2.1045e+00,  elapsed time  55
INFO   step:    21,    loss: 1.0197e+01,   Y0: 2.1085e+00,  elapsed time  56
INFO   step:    22,    loss: 1.0148e+01,   Y0: 2.1124e+00,  elapsed time  56
INFO   step:    23,    loss: 1.0108e+01,   Y0: 2.1162e+00,  elapsed time  56
INFO   step:    24,    loss: 1.0071e+01,   Y0: 2.1202e+00,  elapsed time  56
INFO   step:    25,    loss: 1.0038e+01,   Y0: 2.1243e+00,  elapsed time  56
INFO   step:    26,    loss: 1.0006e+01,   Y0: 2.1281e+00,  elapsed time  56
INFO   step:    27,    loss: 9.9747e+00,   Y0: 2.1315e+00,  elapsed time  57
INFO   step:    28,    loss: 9.9468e+00,   Y0: 2.1350e+00,  elapsed time  57
INFO   step:    29,    loss: 9.9225e+00,   Y0: 2.1384e+00,  elapsed time  57
INFO   step:    30,    loss: 9.9005e+00,   Y0: 2.1416e+00,  elapsed time  57
INFO   step:    31,    loss: 9.8831e+00,   Y0: 2.1444e+00,  elapsed time  57
INFO   step:    32,    loss: 9.8685e+00,   Y0: 2.1468e+00,  elapsed time  58
INFO   step:    33,    loss: 9.8563e+00,   Y0: 2.1492e+00,  elapsed time  58
INFO   step:    34,    loss: 9.8461e+00,   Y0: 2.1511e+00,  elapsed time  58
INFO   step:    35,    loss: 9.8350e+00,   Y0: 2.1532e+00,  elapsed time  58
INFO   step:    36,    loss: 9.8230e+00,   Y0: 2.1549e+00,  elapsed time  58
INFO   step:    37,    loss: 9.8125e+00,   Y0: 2.1561e+00,  elapsed time  59
INFO   step:    38,    loss: 9.8039e+00,   Y0: 2.1570e+00,  elapsed time  59
INFO   step:    39,    loss: 9.7958e+00,   Y0: 2.1570e+00,  elapsed time  59
INFO   step:    40,    loss: 9.7885e+00,   Y0: 2.1573e+00,  elapsed time  59
INFO   step:    41,    loss: 9.7806e+00,   Y0: 2.1578e+00,  elapsed time  59
INFO   step:    42,    loss: 9.7726e+00,   Y0: 2.1577e+00,  elapsed time  59
INFO   step:    43,    loss: 9.7643e+00,   Y0: 2.1578e+00,  elapsed time  60
INFO   step:    44,    loss: 9.7566e+00,   Y0: 2.1583e+00,  elapsed time  60
INFO   step:    45,    loss: 9.7497e+00,   Y0: 2.1589e+00,  elapsed time  60
INFO   step:    46,    loss: 9.7436e+00,   Y0: 2.1594e+00,  elapsed time  60
INFO   step:    47,    loss: 9.7382e+00,   Y0: 2.1596e+00,  elapsed time  60
INFO   step:    48,    loss: 9.7331e+00,   Y0: 2.1595e+00,  elapsed time  61
INFO   step:    49,    loss: 9.7281e+00,   Y0: 2.1593e+00,  elapsed time  61
INFO   step:    50,    loss: 9.7238e+00,   Y0: 2.1589e+00,  elapsed time  61
INFO   step:    51,    loss: 9.7196e+00,   Y0: 2.1586e+00,  elapsed time  61
INFO   step:    52,    loss: 9.7156e+00,   Y0: 2.1581e+00,  elapsed time  61
INFO   step:    53,    loss: 9.7118e+00,   Y0: 2.1579e+00,  elapsed time  62
INFO   step:    54,    loss: 9.7088e+00,   Y0: 2.1570e+00,  elapsed time  62
INFO   step:    55,    loss: 9.7062e+00,   Y0: 2.1565e+00,  elapsed time  62
INFO   step:    56,    loss: 9.7038e+00,   Y0: 2.1554e+00,  elapsed time  62
INFO   step:    57,    loss: 9.7017e+00,   Y0: 2.1547e+00,  elapsed time  62
INFO   step:    58,    loss: 9.6997e+00,   Y0: 2.1539e+00,  elapsed time  62
INFO   step:    59,    loss: 9.6980e+00,   Y0: 2.1530e+00,  elapsed time  63
INFO   step:    60,    loss: 9.6963e+00,   Y0: 2.1526e+00,  elapsed time  63
INFO   step:    61,    loss: 9.6949e+00,   Y0: 2.1518e+00,  elapsed time  63
INFO   step:    62,    loss: 9.6936e+00,   Y0: 2.1512e+00,  elapsed time  63
INFO   step:    63,    loss: 9.6923e+00,   Y0: 2.1507e+00,  elapsed time  63
INFO   step:    64,    loss: 9.6911e+00,   Y0: 2.1506e+00,  elapsed time  64
INFO   step:    65,    loss: 9.6900e+00,   Y0: 2.1504e+00,  elapsed time  64
INFO   step:    66,    loss: 9.6891e+00,   Y0: 2.1497e+00,  elapsed time  64
INFO   step:    67,    loss: 9.6882e+00,   Y0: 2.1493e+00,  elapsed time  64
INFO   step:    68,    loss: 9.6874e+00,   Y0: 2.1490e+00,  elapsed time  64
INFO   step:    69,    loss: 9.6868e+00,   Y0: 2.1482e+00,  elapsed time  64
INFO   step:    70,    loss: 9.6861e+00,   Y0: 2.1477e+00,  elapsed time  65
INFO   step:    71,    loss: 9.6855e+00,   Y0: 2.1474e+00,  elapsed time  65
INFO   step:    72,    loss: 9.6849e+00,   Y0: 2.1472e+00,  elapsed time  65
INFO   step:    73,    loss: 9.6844e+00,   Y0: 2.1468e+00,  elapsed time  65
INFO   step:    74,    loss: 9.6840e+00,   Y0: 2.1461e+00,  elapsed time  65
INFO   step:    75,    loss: 9.6836e+00,   Y0: 2.1454e+00,  elapsed time  66
INFO   step:    76,    loss: 9.6832e+00,   Y0: 2.1453e+00,  elapsed time  66
INFO   step:    77,    loss: 9.6828e+00,   Y0: 2.1458e+00,  elapsed time  66
INFO   step:    78,    loss: 9.6824e+00,   Y0: 2.1461e+00,  elapsed time  66
INFO   step:    79,    loss: 9.6821e+00,   Y0: 2.1460e+00,  elapsed time  66
INFO   step:    80,    loss: 9.6818e+00,   Y0: 2.1460e+00,  elapsed time  66
INFO   step:    81,    loss: 9.6816e+00,   Y0: 2.1456e+00,  elapsed time  67
INFO   step:    82,    loss: 9.6813e+00,   Y0: 2.1456e+00,  elapsed time  67
INFO   step:    83,    loss: 9.6811e+00,   Y0: 2.1456e+00,  elapsed time  67
INFO   step:    84,    loss: 9.6808e+00,   Y0: 2.1460e+00,  elapsed time  67
INFO   step:    85,    loss: 9.6807e+00,   Y0: 2.1457e+00,  elapsed time  67
INFO   step:    86,    loss: 9.6804e+00,   Y0: 2.1464e+00,  elapsed time  68
INFO   step:    87,    loss: 9.6802e+00,   Y0: 2.1467e+00,  elapsed time  68
INFO   step:    88,    loss: 9.6800e+00,   Y0: 2.1468e+00,  elapsed time  68
INFO   step:    89,    loss: 9.6798e+00,   Y0: 2.1475e+00,  elapsed time  68
INFO   step:    90,    loss: 9.6796e+00,   Y0: 2.1476e+00,  elapsed time  68
INFO   step:    91,    loss: 9.6796e+00,   Y0: 2.1473e+00,  elapsed time  68
INFO   step:    92,    loss: 9.6794e+00,   Y0: 2.1476e+00,  elapsed time  69
INFO   step:    93,    loss: 9.6793e+00,   Y0: 2.1481e+00,  elapsed time  69
INFO   step:    94,    loss: 9.6791e+00,   Y0: 2.1487e+00,  elapsed time  69
INFO   step:    95,    loss: 9.6789e+00,   Y0: 2.1496e+00,  elapsed time  69
INFO   step:    96,    loss: 9.6787e+00,   Y0: 2.1499e+00,  elapsed time  69
INFO   step:    97,    loss: 9.6785e+00,   Y0: 2.1507e+00,  elapsed time  70
INFO   step:    98,    loss: 9.6783e+00,   Y0: 2.1512e+00,  elapsed time  70
INFO   step:    99,    loss: 9.6781e+00,   Y0: 2.1519e+00,  elapsed time  70
INFO   step:   100,    loss: 9.6779e+00,   Y0: 2.1525e+00,  elapsed time  70
INFO   step:   101,    loss: 9.6776e+00,   Y0: 2.1536e+00,  elapsed time  70
INFO   step:   102,    loss: 9.6774e+00,   Y0: 2.1539e+00,  elapsed time  70
INFO   step:   103,    loss: 9.6774e+00,   Y0: 2.1533e+00,  elapsed time  71
INFO   step:   104,    loss: 9.6774e+00,   Y0: 2.1522e+00,  elapsed time  71
INFO   step:   105,    loss: 9.6775e+00,   Y0: 2.1512e+00,  elapsed time  71
INFO   step:   106,    loss: 9.6775e+00,   Y0: 2.1502e+00,  elapsed time  71
INFO   step:   107,    loss: 9.6775e+00,   Y0: 2.1496e+00,  elapsed time  71
INFO   step:   108,    loss: 9.6775e+00,   Y0: 2.1490e+00,  elapsed time  72
INFO   step:   109,    loss: 9.6775e+00,   Y0: 2.1483e+00,  elapsed time  72
INFO   step:   110,    loss: 9.6775e+00,   Y0: 2.1478e+00,  elapsed time  72
INFO   step:   111,    loss: 9.6776e+00,   Y0: 2.1466e+00,  elapsed time  72
INFO   step:   112,    loss: 9.6778e+00,   Y0: 2.1453e+00,  elapsed time  72
INFO   step:   113,    loss: 9.6778e+00,   Y0: 2.1445e+00,  elapsed time  73
INFO   step:   114,    loss: 9.6779e+00,   Y0: 2.1436e+00,  elapsed time  73
INFO   step:   115,    loss: 9.6780e+00,   Y0: 2.1425e+00,  elapsed time  73
INFO   step:   116,    loss: 9.6782e+00,   Y0: 2.1411e+00,  elapsed time  73
INFO   step:   117,    loss: 9.6783e+00,   Y0: 2.1397e+00,  elapsed time  73
INFO   step:   118,    loss: 9.6784e+00,   Y0: 2.1385e+00,  elapsed time  73
INFO   step:   119,    loss: 9.6785e+00,   Y0: 2.1380e+00,  elapsed time  74
INFO   step:   120,    loss: 9.6784e+00,   Y0: 2.1379e+00,  elapsed time  74
INFO   step:   121,    loss: 9.6784e+00,   Y0: 2.1375e+00,  elapsed time  74
INFO   step:   122,    loss: 9.6784e+00,   Y0: 2.1370e+00,  elapsed time  74
INFO   step:   123,    loss: 9.6784e+00,   Y0: 2.1370e+00,  elapsed time  74
INFO   step:   124,    loss: 9.6782e+00,   Y0: 2.1376e+00,  elapsed time  75
INFO   step:   125,    loss: 9.6781e+00,   Y0: 2.1377e+00,  elapsed time  75
INFO   step:   126,    loss: 9.6781e+00,   Y0: 2.1375e+00,  elapsed time  75
INFO   step:   127,    loss: 9.6782e+00,   Y0: 2.1365e+00,  elapsed time  75
INFO   step:   128,    loss: 9.6783e+00,   Y0: 2.1356e+00,  elapsed time  75
INFO   step:   129,    loss: 9.6783e+00,   Y0: 2.1352e+00,  elapsed time  75
INFO   step:   130,    loss: 9.6782e+00,   Y0: 2.1354e+00,  elapsed time  76
INFO   step:   131,    loss: 9.6781e+00,   Y0: 2.1357e+00,  elapsed time  76
INFO   step:   132,    loss: 9.6780e+00,   Y0: 2.1359e+00,  elapsed time  76
INFO   step:   133,    loss: 9.6778e+00,   Y0: 2.1365e+00,  elapsed time  76
INFO   step:   134,    loss: 9.6777e+00,   Y0: 2.1372e+00,  elapsed time  76
INFO   step:   135,    loss: 9.6775e+00,   Y0: 2.1380e+00,  elapsed time  77
INFO   step:   136,    loss: 9.6772e+00,   Y0: 2.1391e+00,  elapsed time  77
INFO   step:   137,    loss: 9.6770e+00,   Y0: 2.1401e+00,  elapsed time  77
INFO   step:   138,    loss: 9.6767e+00,   Y0: 2.1413e+00,  elapsed time  77
INFO   step:   139,    loss: 9.6766e+00,   Y0: 2.1418e+00,  elapsed time  77
INFO   step:   140,    loss: 9.6764e+00,   Y0: 2.1425e+00,  elapsed time  77
INFO   step:   141,    loss: 9.6764e+00,   Y0: 2.1425e+00,  elapsed time  78
INFO   step:   142,    loss: 9.6763e+00,   Y0: 2.1429e+00,  elapsed time  78
INFO   step:   143,    loss: 9.6761e+00,   Y0: 2.1435e+00,  elapsed time  78
INFO   step:   144,    loss: 9.6759e+00,   Y0: 2.1442e+00,  elapsed time  78
INFO   step:   145,    loss: 9.6758e+00,   Y0: 2.1451e+00,  elapsed time  78
INFO   step:   146,    loss: 9.6756e+00,   Y0: 2.1456e+00,  elapsed time  79
INFO   step:   147,    loss: 9.6755e+00,   Y0: 2.1461e+00,  elapsed time  79
INFO   step:   148,    loss: 9.6754e+00,   Y0: 2.1463e+00,  elapsed time  79
INFO   step:   149,    loss: 9.6754e+00,   Y0: 2.1460e+00,  elapsed time  79
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  1
Loss out:  8.990618752890889
Output_Z_Vals:  [[[ 2.32524364e+00]
  [ 2.32524364e+00]
  [ 2.32524364e+00]
  ...
  [ 2.32524364e+00]
  [ 2.32524364e+00]
  [ 2.32524364e+00]]

 [[ 7.94892141e-03]
  [ 1.12309203e-02]
  [ 6.39716995e-03]
  ...
  [ 3.26164569e-03]
  [ 5.94770209e-03]
  [ 1.18374426e-02]]

 [[ 4.61168263e-03]
  [-1.57253535e-02]
  [ 2.54492568e-03]
  ...
  [-7.13667861e-03]
  [ 4.69932580e-03]
  [-1.27933961e-02]]

 ...

 [[-9.89917708e-03]
  [ 3.04355390e-03]
  [ 4.36426161e-04]
  ...
  [ 8.85310365e-03]
  [-3.05276841e-02]
  [ 7.27759645e-03]]

 [[ 9.62658009e-03]
  [ 1.04359326e-02]
  [ 7.86741690e-03]
  ...
  [ 7.98365829e-03]
  [ 1.00659641e-02]
  [ 8.60244842e-03]]

 [[-1.63704580e-02]
  [-2.74462771e-03]
  [-1.19728233e-02]
  ...
  [-6.89110724e-03]
  [-1.15745595e-02]
  [-6.94946470e-03]]]
Z_Vals dimensionality:  (40, 200, 1)
X_test:  [[[100.         101.21932013 100.32285728 ... 103.52015996 102.85669613
   103.30104432]]

 [[100.          98.34934852  97.36200001 ...  98.58730549  99.3224694
    98.11665295]]

 [[100.         100.4560873  100.85697385 ... 100.80200016 101.24017568
   100.74251238]]

 ...

 [[100.          99.69015816  99.07722785 ...  92.5613143   93.77178831
    94.54855189]]

 [[100.         100.5732103  100.26828084 ... 104.64681147 104.76455926
   102.66492724]]

 [[100.          98.25417452  98.34181746 ...  93.20041598  93.60638806
    92.99086012]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.94892141e-03]
 [ 4.61168263e-03]
 [ 1.48531390e-02]
 [-5.02854936e-05]
 [ 1.31249916e-02]
 [ 2.66664648e-02]
 [-3.71291550e-03]
 [ 7.59584910e-03]
 [-6.48583781e-03]
 [-6.47989275e-04]
 [ 9.64816410e-03]
 [ 4.84990052e-03]
 [ 1.13956704e-02]
 [ 6.55653275e-04]
 [ 1.32993797e-02]
 [-2.73018807e-03]
 [ 1.30086354e-02]
 [-8.23102135e-03]
 [ 8.22585266e-03]
 [-1.02375046e-02]
 [ 1.60519542e-02]
 [ 1.21564656e-04]
 [ 1.66396022e-02]
 [ 5.54787640e-03]
 [ 1.96884634e-03]
 [-7.18049280e-03]
 [-1.03028306e-03]
 [-1.11189823e-02]
 [-1.57848993e-02]
 [-1.04831495e-02]
 [-1.69354272e-03]
 [ 4.71236156e-03]
 [ 5.83442413e-03]
 [-1.82910950e-03]
 [ 7.10698793e-03]
 [ 4.82016184e-03]
 [-9.89917708e-03]
 [ 9.62658009e-03]
 [-1.63704580e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.85365423]
curr_Stock_Price:  101.21932012654813
curr_Factors:  [101.21932013]
mat_Sqrt:  [[0.15]]
grads:  [0.05299281]
Stock Position:  0.05299280938612016
Bond Position:  [15.48975809]


portfolio before change:  [20.80808448]
curr_Stock_Price:  100.32285727955639
curr_Factors:  [100.32285728]
mat_Sqrt:  [[0.15]]
grads:  [0.03074455]
Stock Position:  0.03074455088004968
Bond Position:  [17.72370329]


portfolio before change:  [20.83913364]
curr_Stock_Price:  101.26070003587978
curr_Factors:  [101.26070004]
mat_Sqrt:  [[0.15]]
grads:  [0.09902093]
Stock Position:  0.09902092640223217
Bond Position:  [10.81220531]


portfolio before change:  [20.81925821]
curr_Stock_Price:  101.04633078083698
curr_Factors:  [101.04633078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00033524]
Stock Position:  -0.0003352366239055344
Bond Position:  [20.85313264]


portfolio before change:  [20.82156114]
curr_Stock_Price:  101.95275521303334
curr_Factors:  [101.95275521]
mat_Sqrt:  [[0.15]]
grads:  [0.08749994]
Stock Position:  0.087499943813322
Bond Position:  [11.90070079]


portfolio before change:  [20.79200354]
curr_Stock_Price:  101.59795169739056
curr_Factors:  [101.5979517]
mat_Sqrt:  [[0.15]]
grads:  [0.17777643]
Stock Position:  0.17777643184157776
Bond Position:  [2.7302822]


portfolio before change:  [20.67451322]
curr_Stock_Price:  100.9351437686947
curr_Factors:  [100.93514377]
mat_Sqrt:  [[0.15]]
grads:  [-0.02475277]
Stock Position:  -0.0247527699684099
Bond Position:  [23.17293761]


portfolio before change:  [20.63608038]
curr_Stock_Price:  102.60484115763077
curr_Factors:  [102.60484116]
mat_Sqrt:  [[0.15]]
grads:  [0.05063899]
Stock Position:  0.05063899396733163
Bond Position:  [15.44027445]


portfolio before change:  [20.54697871]
curr_Stock_Price:  100.80717863839965
curr_Factors:  [100.80717864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04323892]
Stock Position:  -0.043238918746808234
Bond Position:  [24.90577212]


portfolio before change:  [20.54243222]
curr_Stock_Price:  100.98433171940606
curr_Factors:  [100.98433172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00431993]
Stock Position:  -0.0043199284980350566
Bond Position:  [20.97867731]


portfolio before change:  [20.54737263]
curr_Stock_Price:  100.44776979804796
curr_Factors:  [100.4477698]
mat_Sqrt:  [[0.15]]
grads:  [0.06432109]
Stock Position:  0.06432109398819491
Bond Position:  [14.08646219]


portfolio before change:  [20.61219404]
curr_Stock_Price:  101.42817129142374
curr_Factors:  [101.42817129]
mat_Sqrt:  [[0.15]]
grads:  [0.03233267]
Stock Position:  0.032332670131366835
Bond Position:  [17.33275044]


portfolio before change:  [20.6065792]
curr_Stock_Price:  101.18749933474318
curr_Factors:  [101.18749933]
mat_Sqrt:  [[0.15]]
grads:  [0.07597114]
Stock Position:  0.07597113600142238
Bond Position:  [12.91924993]


portfolio before change:  [20.57290968]
curr_Stock_Price:  100.72305280167409
curr_Factors:  [100.7230528]
mat_Sqrt:  [[0.15]]
grads:  [0.00437102]
Stock Position:  0.004371021830788478
Bond Position:  [20.13264702]


portfolio before change:  [20.5700644]
curr_Stock_Price:  99.49633321659581
curr_Factors:  [99.49633322]
mat_Sqrt:  [[0.15]]
grads:  [0.08866253]
Stock Position:  0.08866253147475293
Bond Position:  [11.74846763]


portfolio before change:  [20.56852779]
curr_Stock_Price:  99.46243770308219
curr_Factors:  [99.4624377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01820125]
Stock Position:  -0.018201253818058972
Bond Position:  [22.37886886]


portfolio before change:  [20.58697032]
curr_Stock_Price:  98.60288172259975
curr_Factors:  [98.60288172]
mat_Sqrt:  [[0.15]]
grads:  [0.08672424]
Stock Position:  0.0867242358243546
Bond Position:  [12.03571075]


portfolio before change:  [20.55431464]
curr_Stock_Price:  98.20898678291617
curr_Factors:  [98.20898678]
mat_Sqrt:  [[0.15]]
grads:  [-0.05487348]
Stock Position:  -0.05487347567702234
Bond Position:  [25.94338309]


portfolio before change:  [20.53348013]
curr_Stock_Price:  98.64777143202099
curr_Factors:  [98.64777143]
mat_Sqrt:  [[0.15]]
grads:  [0.05483902]
Stock Position:  0.05483901772722333
Bond Position:  [15.12373324]


portfolio before change:  [20.55296742]
curr_Stock_Price:  98.96865086662956
curr_Factors:  [98.96865087]
mat_Sqrt:  [[0.15]]
grads:  [-0.06825003]
Stock Position:  -0.06825003087971944
Bond Position:  [27.3075809]


portfolio before change:  [20.62322652]
curr_Stock_Price:  97.98923102409891
curr_Factors:  [97.98923102]
mat_Sqrt:  [[0.15]]
grads:  [0.10701303]
Stock Position:  0.10701302819800212
Bond Position:  [10.13710218]


portfolio before change:  [20.62501824]
curr_Stock_Price:  97.99413236800937
curr_Factors:  [97.99413237]
mat_Sqrt:  [[0.15]]
grads:  [0.00081043]
Stock Position:  0.0008104310382655034
Bond Position:  [20.54560076]


portfolio before change:  [20.62838687]
curr_Stock_Price:  98.98158691439284
curr_Factors:  [98.98158691]
mat_Sqrt:  [[0.15]]
grads:  [0.11093068]
Stock Position:  0.11093068131875014
Bond Position:  [9.64829199]


portfolio before change:  [20.7398573]
curr_Stock_Price:  99.97557990684476
curr_Factors:  [99.97557991]
mat_Sqrt:  [[0.15]]
grads:  [0.03698584]
Stock Position:  0.03698584266074044
Bond Position:  [17.04217623]


portfolio before change:  [20.730478]
curr_Stock_Price:  99.66438761459352
curr_Factors:  [99.66438761]
mat_Sqrt:  [[0.15]]
grads:  [0.01312564]
Stock Position:  0.013125642253408246
Bond Position:  [19.4223189]


portfolio before change:  [20.7519926]
curr_Stock_Price:  101.11853805501666
curr_Factors:  [101.11853806]
mat_Sqrt:  [[0.15]]
grads:  [-0.04786995]
Stock Position:  -0.04786995200758519
Bond Position:  [25.59253216]


portfolio before change:  [20.7251575]
curr_Stock_Price:  101.7459537873835
curr_Factors:  [101.74595379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00686855]
Stock Position:  -0.0068685537522013545
Bond Position:  [21.42400505]


portfolio before change:  [20.72436823]
curr_Stock_Price:  102.250782097102
curr_Factors:  [102.2507821]
mat_Sqrt:  [[0.15]]
grads:  [-0.07412655]
Stock Position:  -0.0741265488024128
Bond Position:  [28.30386582]


portfolio before change:  [20.80460143]
curr_Stock_Price:  101.21613260055877
curr_Factors:  [101.2161326]
mat_Sqrt:  [[0.15]]
grads:  [-0.10523266]
Stock Position:  -0.10523266168971711
Bond Position:  [31.45584447]


portfolio before change:  [20.76240307]
curr_Stock_Price:  101.65450017871599
curr_Factors:  [101.65450018]
mat_Sqrt:  [[0.15]]
grads:  [-0.06988766]
Stock Position:  -0.06988766341852504
Bond Position:  [27.86679856]


portfolio before change:  [20.82122592]
curr_Stock_Price:  100.86266830221885
curr_Factors:  [100.8626683]
mat_Sqrt:  [[0.15]]
grads:  [-0.01129028]
Stock Position:  -0.011290284781849284
Bond Position:  [21.95999417]


portfolio before change:  [20.78647781]
curr_Stock_Price:  104.18351270799205
curr_Factors:  [104.18351271]
mat_Sqrt:  [[0.15]]
grads:  [0.03141574]
Stock Position:  0.03141574374269446
Bond Position:  [17.51347527]


portfolio before change:  [20.82682901]
curr_Stock_Price:  105.39825017001613
curr_Factors:  [105.39825017]
mat_Sqrt:  [[0.15]]
grads:  [0.03889616]
Stock Position:  0.03889616088889023
Bond Position:  [16.72724171]


portfolio before change:  [20.82480054]
curr_Stock_Price:  105.29233993099959
curr_Factors:  [105.29233993]
mat_Sqrt:  [[0.15]]
grads:  [-0.01219406]
Stock Position:  -0.012194063359358062
Bond Position:  [22.10874201]


portfolio before change:  [20.83191602]
curr_Stock_Price:  104.93546865867222
curr_Factors:  [104.93546866]
mat_Sqrt:  [[0.15]]
grads:  [0.04737992]
Stock Position:  0.047379919519679035
Bond Position:  [15.86008196]


portfolio before change:  [20.7967183]
curr_Stock_Price:  104.15074047458087
curr_Factors:  [104.15074047]
mat_Sqrt:  [[0.15]]
grads:  [0.03213441]
Stock Position:  0.03213441227965959
Bond Position:  [17.44989546]


portfolio before change:  [20.78264666]
curr_Stock_Price:  103.64495842885185
curr_Factors:  [103.64495843]
mat_Sqrt:  [[0.15]]
grads:  [-0.06599451]
Stock Position:  -0.06599451384695969
Bond Position:  [27.62264531]


portfolio before change:  [20.79433572]
curr_Stock_Price:  103.52015995884807
curr_Factors:  [103.52015996]
mat_Sqrt:  [[0.15]]
grads:  [0.0641772]
Stock Position:  0.06417720062604583
Bond Position:  [14.15070165]


portfolio before change:  [20.75352542]
curr_Stock_Price:  102.85669613014716
curr_Factors:  [102.85669613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.75352542]
Stock Price:  103.30104432463499
PL:  [17.45248109]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.12309203e-02]
 [-1.57253535e-02]
 [-2.48979767e-02]
 [ 6.60035560e-03]
 [-2.54774517e-02]
 [-2.85886706e-02]
 [-5.08131608e-02]
 [ 1.99805293e-02]
 [-6.00219739e-03]
 [ 2.08401930e-03]
 [-9.03499585e-03]
 [ 7.45439293e-03]
 [ 1.39041830e-02]
 [ 1.71815547e-03]
 [-1.52392881e-03]
 [-6.43982474e-03]
 [ 1.89856538e-02]
 [-1.51281633e-02]
 [ 5.48432786e-03]
 [-2.60983071e-03]
 [ 2.38350157e-02]
 [-1.23752832e-03]
 [ 2.71326976e-02]
 [ 5.25999070e-04]
 [ 1.30619565e-02]
 [-1.23957113e-03]
 [ 2.33324454e-02]
 [-2.21557050e-02]
 [-4.80886776e-02]
 [-1.04612163e-03]
 [-3.47453544e-03]
 [ 5.60813333e-03]
 [ 7.36893466e-03]
 [-1.27506599e-02]
 [ 3.27798107e-03]
 [ 5.71457798e-03]
 [ 3.04355390e-03]
 [ 1.04359326e-02]
 [-2.74462771e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.63556723]
curr_Stock_Price:  98.34934851723449
curr_Factors:  [98.34934852]
mat_Sqrt:  [[0.15]]
grads:  [0.0748728]
Stock Position:  0.07487280179295129
Bond Position:  [-30.99925851]


portfolio before change:  [-23.71336793]
curr_Stock_Price:  97.3620000099274
curr_Factors:  [97.36200001]
mat_Sqrt:  [[0.15]]
grads:  [-0.10483569]
Stock Position:  -0.10483568968503414
Bond Position:  [-13.50635551]


portfolio before change:  [-23.74487732]
curr_Stock_Price:  97.6464545592466
curr_Factors:  [97.64645456]
mat_Sqrt:  [[0.15]]
grads:  [-0.16598651]
Stock Position:  -0.16598651151069999
Bond Position:  [-7.53688296]


portfolio before change:  [-23.72105424]
curr_Stock_Price:  97.49725420187745
curr_Factors:  [97.4972542]
mat_Sqrt:  [[0.15]]
grads:  [0.04400237]
Stock Position:  0.04400237065879876
Bond Position:  [-28.01116456]


portfolio before change:  [-23.70131454]
curr_Stock_Price:  98.0254372762933
curr_Factors:  [98.02543728]
mat_Sqrt:  [[0.15]]
grads:  [-0.16984968]
Stock Position:  -0.1698496782344131
Bond Position:  [-7.05172556]


portfolio before change:  [-23.64682808]
curr_Stock_Price:  97.6994549934676
curr_Factors:  [97.69945499]
mat_Sqrt:  [[0.15]]
grads:  [-0.19059114]
Stock Position:  -0.19059113764765637
Bond Position:  [-5.02617781]


portfolio before change:  [-23.68745561]
curr_Stock_Price:  97.90932422592184
curr_Factors:  [97.90932423]
mat_Sqrt:  [[0.15]]
grads:  [-0.33875441]
Stock Position:  -0.33875440517104044
Bond Position:  [9.47975928]


portfolio before change:  [-23.7481763]
curr_Stock_Price:  98.09206940239632
curr_Factors:  [98.0920694]
mat_Sqrt:  [[0.15]]
grads:  [0.13320353]
Stock Position:  0.1332035288715645
Bond Position:  [-36.8143861]


portfolio before change:  [-23.73084904]
curr_Stock_Price:  98.25669973204555
curr_Factors:  [98.25669973]
mat_Sqrt:  [[0.15]]
grads:  [-0.04001465]
Stock Position:  -0.04001464928697183
Bond Position:  [-19.79914166]


portfolio before change:  [-23.74579484]
curr_Stock_Price:  98.56835431561977
curr_Factors:  [98.56835432]
mat_Sqrt:  [[0.15]]
grads:  [0.01389346]
Stock Position:  0.013893462007395642
Bond Position:  [-25.11525052]


portfolio before change:  [-23.77202464]
curr_Stock_Price:  96.90640715790137
curr_Factors:  [96.90640716]
mat_Sqrt:  [[0.15]]
grads:  [-0.06023331]
Stock Position:  -0.06023330567380693
Bond Position:  [-17.9350314]


portfolio before change:  [-23.79127115]
curr_Stock_Price:  97.18871761988682
curr_Factors:  [97.18871762]
mat_Sqrt:  [[0.15]]
grads:  [0.04969595]
Stock Position:  0.04969595284512826
Bond Position:  [-28.62115708]


portfolio before change:  [-23.78095831]
curr_Stock_Price:  97.46823146042856
curr_Factors:  [97.46823146]
mat_Sqrt:  [[0.15]]
grads:  [0.09269455]
Stock Position:  0.09269455302499566
Bond Position:  [-32.81573246]


portfolio before change:  [-23.80585436]
curr_Stock_Price:  97.24390523288567
curr_Factors:  [97.24390523]
mat_Sqrt:  [[0.15]]
grads:  [0.01145437]
Stock Position:  0.01145436982018258
Bond Position:  [-24.91972201]


portfolio before change:  [-23.81411088]
curr_Stock_Price:  96.79504941512747
curr_Factors:  [96.79504942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015953]
Stock Position:  -0.010159525425903732
Bond Position:  [-22.83071911]


portfolio before change:  [-23.81417596]
curr_Stock_Price:  96.5205348953238
curr_Factors:  [96.5205349]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293216]
Stock Position:  -0.04293216490715994
Bond Position:  [-19.67034044]


portfolio before change:  [-23.8066582]
curr_Stock_Price:  96.28815194247989
curr_Factors:  [96.28815194]
mat_Sqrt:  [[0.15]]
grads:  [0.12657103]
Stock Position:  0.12657102564401035
Bond Position:  [-35.99394835]


portfolio before change:  [-23.78869825]
curr_Stock_Price:  96.46559759229531
curr_Factors:  [96.46559759]
mat_Sqrt:  [[0.15]]
grads:  [-0.10085442]
Stock Position:  -0.10085442179324312
Bond Position:  [-14.05971618]


portfolio before change:  [-23.89006495]
curr_Stock_Price:  97.45325012061306
curr_Factors:  [97.45325012]
mat_Sqrt:  [[0.15]]
grads:  [0.03656219]
Stock Position:  0.03656218573434226
Bond Position:  [-27.45316878]


portfolio before change:  [-23.90391105]
curr_Stock_Price:  97.16841374468333
curr_Factors:  [97.16841374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01739887]
Stock Position:  -0.017398871400028916
Bond Position:  [-22.21329031]


portfolio before change:  [-23.88139898]
curr_Stock_Price:  95.71493406987088
curr_Factors:  [95.71493407]
mat_Sqrt:  [[0.15]]
grads:  [0.1589001]
Stock Position:  0.15890010443024194
Bond Position:  [-39.090512]


portfolio before change:  [-23.95879302]
curr_Stock_Price:  95.25862584116643
curr_Factors:  [95.25862584]
mat_Sqrt:  [[0.15]]
grads:  [-0.00825019]
Stock Position:  -0.008250188813000228
Bond Position:  [-23.17289137]


portfolio before change:  [-23.96063071]
curr_Stock_Price:  95.13025220741186
curr_Factors:  [95.13025221]
mat_Sqrt:  [[0.15]]
grads:  [0.18088465]
Stock Position:  0.1808846508773012
Bond Position:  [-41.16823316]


portfolio before change:  [-24.10376139]
curr_Stock_Price:  94.36742167101885
curr_Factors:  [94.36742167]
mat_Sqrt:  [[0.15]]
grads:  [0.00350666]
Stock Position:  0.0035066604683651795
Bond Position:  [-24.4346759]


portfolio before change:  [-24.1028704]
curr_Stock_Price:  95.49257239512764
curr_Factors:  [95.4925724]
mat_Sqrt:  [[0.15]]
grads:  [0.08707971]
Stock Position:  0.08707970987245163
Bond Position:  [-32.4183359]


portfolio before change:  [-24.08705251]
curr_Stock_Price:  95.72075905982612
curr_Factors:  [95.72075906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00826381]
Stock Position:  -0.008263807506850643
Bond Position:  [-23.29603459]


portfolio before change:  [-24.09232404]
curr_Stock_Price:  96.00626151288898
curr_Factors:  [96.00626151]
mat_Sqrt:  [[0.15]]
grads:  [0.15554964]
Stock Position:  0.15554963614302125
Bond Position:  [-39.02606308]


portfolio before change:  [-24.13878596]
curr_Stock_Price:  95.73892972744697
curr_Factors:  [95.73892973]
mat_Sqrt:  [[0.15]]
grads:  [-0.1477047]
Stock Position:  -0.14770469986520748
Bond Position:  [-9.99769608]


portfolio before change:  [-24.2356745]
curr_Stock_Price:  96.38642941995182
curr_Factors:  [96.38642942]
mat_Sqrt:  [[0.15]]
grads:  [-0.32059118]
Stock Position:  -0.32059118392124814
Bond Position:  [6.66496502]


portfolio before change:  [-24.65338738]
curr_Stock_Price:  97.691973912221
curr_Factors:  [97.69197391]
mat_Sqrt:  [[0.15]]
grads:  [-0.00697414]
Stock Position:  -0.006974144206135201
Bond Position:  [-23.97206947]


portfolio before change:  [-24.66556393]
curr_Stock_Price:  99.00824304711752
curr_Factors:  [99.00824305]
mat_Sqrt:  [[0.15]]
grads:  [-0.02316357]
Stock Position:  -0.023163569584749463
Bond Position:  [-22.3721796]


portfolio before change:  [-24.67111956]
curr_Stock_Price:  99.127349811659
curr_Factors:  [99.12734981]
mat_Sqrt:  [[0.15]]
grads:  [0.03738756]
Stock Position:  0.03738755556030034
Bond Position:  [-28.37724886]


portfolio before change:  [-24.70138702]
curr_Stock_Price:  98.41267142981434
curr_Factors:  [98.41267143]
mat_Sqrt:  [[0.15]]
grads:  [0.04912623]
Stock Position:  0.04912623106547787
Bond Position:  [-29.53603065]


portfolio before change:  [-24.72260943]
curr_Stock_Price:  98.05583196585674
curr_Factors:  [98.05583197]
mat_Sqrt:  [[0.15]]
grads:  [-0.0850044]
Stock Position:  -0.08500439928218784
Bond Position:  [-16.38743234]


portfolio before change:  [-24.6841931]
curr_Stock_Price:  97.57979905723175
curr_Factors:  [97.57979906]
mat_Sqrt:  [[0.15]]
grads:  [0.02185321]
Stock Position:  0.021853207131117495
Bond Position:  [-26.81662466]


portfolio before change:  [-24.66479319]
curr_Stock_Price:  98.62093647470604
curr_Factors:  [98.62093647]
mat_Sqrt:  [[0.15]]
grads:  [0.03809719]
Stock Position:  0.038097186511690036
Bond Position:  [-28.4219734]


portfolio before change:  [-24.65061866]
curr_Stock_Price:  99.08625970563047
curr_Factors:  [99.08625971]
mat_Sqrt:  [[0.15]]
grads:  [0.02029036]
Stock Position:  0.02029035931784611
Bond Position:  [-26.66111447]


portfolio before change:  [-24.66407546]
curr_Stock_Price:  98.58730548727422
curr_Factors:  [98.58730549]
mat_Sqrt:  [[0.15]]
grads:  [0.06957288]
Stock Position:  0.06957288431496977
Bond Position:  [-31.52307866]


portfolio before change:  [-24.61686862]
curr_Stock_Price:  99.32246940453632
curr_Factors:  [99.3224694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.61686862]
Stock Price:  98.11665294573847
PL:  [-24.61686862]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.39716995e-03]
 [ 2.54492568e-03]
 [ 1.35395377e-02]
 [ 4.17613352e-03]
 [ 5.12814551e-03]
 [ 2.65092910e-02]
 [-6.04286566e-04]
 [ 1.12884633e-02]
 [-8.27697861e-03]
 [-2.91805290e-03]
 [ 1.17234219e-02]
 [ 4.06896368e-03]
 [ 1.10726211e-02]
 [ 5.13433026e-03]
 [ 1.21775179e-02]
 [-3.02487738e-03]
 [ 1.30466026e-02]
 [-9.31753819e-03]
 [ 5.81791621e-03]
 [-3.16599904e-03]
 [ 7.21992727e-03]
 [ 3.82252658e-03]
 [ 1.50721640e-02]
 [ 5.72846301e-03]
 [-1.49868057e-04]
 [-1.08098018e-02]
 [ 3.85559644e-03]
 [-1.13368475e-02]
 [-1.53139614e-02]
 [-1.06525967e-02]
 [-1.17178910e-03]
 [ 5.29932310e-03]
 [ 5.11235688e-03]
 [-9.45295549e-03]
 [ 2.15941352e-02]
 [ 5.47576829e-03]
 [ 4.36426161e-04]
 [ 7.86741690e-03]
 [-1.19728233e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.0223058]
curr_Stock_Price:  100.45608730364945
curr_Factors:  [100.4560873]
mat_Sqrt:  [[0.15]]
grads:  [0.0426478]
Stock Position:  0.04264779964153371
Bond Position:  [4.73807472]


portfolio before change:  [9.03999503]
curr_Stock_Price:  100.85697385367426
curr_Factors:  [100.85697385]
mat_Sqrt:  [[0.15]]
grads:  [0.01696617]
Stock Position:  0.01696617118399725
Bond Position:  [7.32883834]


portfolio before change:  [9.04199726]
curr_Stock_Price:  100.9209879140097
curr_Factors:  [100.92098791]
mat_Sqrt:  [[0.15]]
grads:  [0.09026358]
Stock Position:  0.09026358496390564
Bond Position:  [-0.0674929]


portfolio before change:  [9.10379293]
curr_Stock_Price:  101.6056948582267
curr_Factors:  [101.60569486]
mat_Sqrt:  [[0.15]]
grads:  [0.02784089]
Stock Position:  0.027840890100161605
Bond Position:  [6.27499995]


portfolio before change:  [9.12509219]
curr_Stock_Price:  102.34255478676843
curr_Factors:  [102.34255479]
mat_Sqrt:  [[0.15]]
grads:  [0.03418764]
Stock Position:  0.03418763672362299
Bond Position:  [5.62624211]


portfolio before change:  [9.09326827]
curr_Stock_Price:  101.39112178236445
curr_Factors:  [101.39112178]
mat_Sqrt:  [[0.15]]
grads:  [0.17672861]
Stock Position:  0.17672860688778264
Bond Position:  [-8.82544344]


portfolio before change:  [8.96860288]
curr_Stock_Price:  100.69195855375384
curr_Factors:  [100.69195855]
mat_Sqrt:  [[0.15]]
grads:  [-0.00402858]
Stock Position:  -0.004028577105238153
Bond Position:  [9.37424819]


portfolio before change:  [8.96591963]
curr_Stock_Price:  101.6488957719718
curr_Factors:  [101.64889577]
mat_Sqrt:  [[0.15]]
grads:  [0.07525642]
Stock Position:  0.07525642169517766
Bond Position:  [1.31618747]


portfolio before change:  [8.97452014]
curr_Stock_Price:  101.76099213236894
curr_Factors:  [101.76099213]
mat_Sqrt:  [[0.15]]
grads:  [-0.05517986]
Stock Position:  -0.055179857401307514
Bond Position:  [14.58967717]


portfolio before change:  [8.97436814]
curr_Stock_Price:  101.79679916017476
curr_Factors:  [101.79679916]
mat_Sqrt:  [[0.15]]
grads:  [-0.01945369]
Stock Position:  -0.019453685979109223
Bond Position:  [10.9546911]


portfolio before change:  [8.9714298]
curr_Stock_Price:  102.018235614321
curr_Factors:  [102.01823561]
mat_Sqrt:  [[0.15]]
grads:  [0.07815615]
Stock Position:  0.07815614568326888
Bond Position:  [0.99807772]


portfolio before change:  [8.8673692]
curr_Stock_Price:  100.68519429041885
curr_Factors:  [100.68519429]
mat_Sqrt:  [[0.15]]
grads:  [0.02712642]
Stock Position:  0.02712642451188904
Bond Position:  [6.13613988]


portfolio before change:  [8.84733708]
curr_Stock_Price:  99.91844440589001
curr_Factors:  [99.91844441]
mat_Sqrt:  [[0.15]]
grads:  [0.07381747]
Stock Position:  0.07381747385311715
Bond Position:  [1.47160992]


portfolio before change:  [8.82593372]
curr_Stock_Price:  99.6260024810296
curr_Factors:  [99.62600248]
mat_Sqrt:  [[0.15]]
grads:  [0.03422887]
Stock Position:  0.034228868375474
Bond Position:  [5.41584839]


portfolio before change:  [8.81804959]
curr_Stock_Price:  99.37588759680474
curr_Factors:  [99.3758876]
mat_Sqrt:  [[0.15]]
grads:  [0.08118345]
Stock Position:  0.08118345271945725
Bond Position:  [0.75037192]


portfolio before change:  [8.81316061]
curr_Stock_Price:  99.31451075886146
curr_Factors:  [99.31451076]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016585]
Stock Position:  -0.020165849204626173
Bond Position:  [10.81592206]


portfolio before change:  [8.8291613]
curr_Stock_Price:  98.5881037254157
curr_Factors:  [98.58810373]
mat_Sqrt:  [[0.15]]
grads:  [0.08697735]
Stock Position:  0.08697735055287831
Bond Position:  [0.25422924]


portfolio before change:  [8.75441372]
curr_Stock_Price:  97.72834702126781
curr_Factors:  [97.72834702]
mat_Sqrt:  [[0.15]]
grads:  [-0.06211692]
Stock Position:  -0.06211692126935793
Bond Position:  [14.82499776]


portfolio before change:  [8.76139606]
curr_Stock_Price:  97.64577536606998
curr_Factors:  [97.64577537]
mat_Sqrt:  [[0.15]]
grads:  [0.03878611]
Stock Position:  0.0387861080875838
Bond Position:  [4.97409646]


portfolio before change:  [8.74966199]
curr_Stock_Price:  97.32721098899906
curr_Factors:  [97.32721099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110666]
Stock Position:  -0.021106660279381826
Bond Position:  [10.80391437]


portfolio before change:  [8.71441775]
curr_Stock_Price:  99.06101498908801
curr_Factors:  [99.06101499]
mat_Sqrt:  [[0.15]]
grads:  [0.04813285]
Stock Position:  0.04813284848432309
Bond Position:  [3.94632892]


portfolio before change:  [8.69652955]
curr_Stock_Price:  98.67912355503621
curr_Factors:  [98.67912356]
mat_Sqrt:  [[0.15]]
grads:  [0.02548351]
Stock Position:  0.025483510541011216
Bond Position:  [6.18183906]


portfolio before change:  [8.71257739]
curr_Stock_Price:  99.27853311519226
curr_Factors:  [99.27853312]
mat_Sqrt:  [[0.15]]
grads:  [0.10048109]
Stock Position:  0.10048109313326006
Bond Position:  [-1.26303815]


portfolio before change:  [8.79456184]
curr_Stock_Price:  100.09602360367042
curr_Factors:  [100.0960236]
mat_Sqrt:  [[0.15]]
grads:  [0.03818975]
Stock Position:  0.038189753423059636
Bond Position:  [4.97191938]


portfolio before change:  [8.78617829]
curr_Stock_Price:  99.86022547336202
curr_Factors:  [99.86022547]
mat_Sqrt:  [[0.15]]
grads:  [-0.00099912]
Stock Position:  -0.0009991203820660748
Bond Position:  [8.88595068]


portfolio before change:  [8.78774046]
curr_Stock_Price:  99.4084737153648
curr_Factors:  [99.40847372]
mat_Sqrt:  [[0.15]]
grads:  [-0.07206535]
Stock Position:  -0.07206534526383908
Bond Position:  [15.95164644]


portfolio before change:  [8.7306041]
curr_Stock_Price:  100.22898514446963
curr_Factors:  [100.22898514]
mat_Sqrt:  [[0.15]]
grads:  [0.02570398]
Stock Position:  0.025703976253569485
Bond Position:  [6.15432065]


portfolio before change:  [8.77129091]
curr_Stock_Price:  101.78195393908845
curr_Factors:  [101.78195394]
mat_Sqrt:  [[0.15]]
grads:  [-0.07557898]
Stock Position:  -0.07557898348825126
Bond Position:  [16.46386753]


portfolio before change:  [8.81202288]
curr_Stock_Price:  101.27025270522267
curr_Factors:  [101.27025271]
mat_Sqrt:  [[0.15]]
grads:  [-0.10209308]
Stock Position:  -0.10209307580961967
Bond Position:  [19.15101447]


portfolio before change:  [8.76533707]
curr_Stock_Price:  101.75098889684855
curr_Factors:  [101.7509889]
mat_Sqrt:  [[0.15]]
grads:  [-0.07101731]
Stock Position:  -0.07101731116310044
Bond Position:  [15.99141871]


portfolio before change:  [8.80623975]
curr_Stock_Price:  101.20318406196449
curr_Factors:  [101.20318406]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781193]
Stock Position:  -0.007811927350884463
Bond Position:  [9.59683167]


portfolio before change:  [8.81293527]
curr_Stock_Price:  100.49966506557011
curr_Factors:  [100.49966507]
mat_Sqrt:  [[0.15]]
grads:  [0.03532882]
Stock Position:  0.03532882063465261
Bond Position:  [5.26240063]


portfolio before change:  [8.82822201]
curr_Stock_Price:  100.91374334777453
curr_Factors:  [100.91374335]
mat_Sqrt:  [[0.15]]
grads:  [0.03408238]
Stock Position:  0.034082379231999235
Bond Position:  [5.38884154]


portfolio before change:  [8.83384017]
curr_Stock_Price:  101.05881873154284
curr_Factors:  [101.05881873]
mat_Sqrt:  [[0.15]]
grads:  [-0.0630197]
Stock Position:  -0.063019703266333
Bond Position:  [15.20253694]


portfolio before change:  [8.83478423]
curr_Stock_Price:  101.07399459717108
curr_Factors:  [101.0739946]
mat_Sqrt:  [[0.15]]
grads:  [0.1439609]
Stock Position:  0.14396090131198705
Bond Position:  [-5.71591913]


portfolio before change:  [8.92738354]
curr_Stock_Price:  101.72218342538315
curr_Factors:  [101.72218343]
mat_Sqrt:  [[0.15]]
grads:  [0.03650512]
Stock Position:  0.036505121957329446
Bond Position:  [5.21400283]


portfolio before change:  [8.92044502]
curr_Stock_Price:  101.51425876282688
curr_Factors:  [101.51425876]
mat_Sqrt:  [[0.15]]
grads:  [0.00290951]
Stock Position:  0.002909507742468786
Bond Position:  [8.62508849]


portfolio before change:  [8.9194509]
curr_Stock_Price:  100.80200016056736
curr_Factors:  [100.80200016]
mat_Sqrt:  [[0.15]]
grads:  [0.05244945]
Stock Position:  0.052449445985455576
Bond Position:  [3.63244184]


portfolio before change:  [8.94288704]
curr_Stock_Price:  101.24017568284836
curr_Factors:  [101.24017568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.94288704]
Stock Price:  100.7425123753347
PL:  [8.20037467]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.74627253e-03]
 [-9.42094737e-04]
 [ 1.12728691e-02]
 [-2.68215790e-03]
 [ 1.26885207e-02]
 [ 6.74596608e-03]
 [-7.33759543e-03]
 [ 2.09077561e-02]
 [-5.90182345e-03]
 [ 4.35508045e-03]
 [ 8.01427855e-03]
 [ 4.16237819e-03]
 [ 1.10978044e-02]
 [ 4.55629687e-03]
 [ 2.08799084e-02]
 [-1.81920029e-03]
 [ 9.39149532e-03]
 [ 1.23317865e-02]
 [ 1.15637333e-02]
 [-1.26345651e-02]
 [-1.53771541e-02]
 [ 1.87383508e-02]
 [-1.25855869e-03]
 [ 5.50908159e-03]
 [-1.31609194e-03]
 [-1.08603568e-02]
 [ 6.28901531e-03]
 [-1.16833912e-02]
 [-1.87364737e-02]
 [-2.12369255e-03]
 [-3.58049143e-03]
 [ 5.63028804e-03]
 [ 9.65187354e-03]
 [-1.28513541e-02]
 [ 2.80054157e-03]
 [ 5.71155106e-03]
 [ 3.57032486e-03]
 [ 1.15880087e-02]
 [-1.55249128e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.19852836]
curr_Stock_Price:  100.98353026294123
curr_Factors:  [100.98353026]
mat_Sqrt:  [[0.15]]
grads:  [0.04497515]
Stock Position:  0.04497515017534665
Bond Position:  [12.65677892]


portfolio before change:  [17.21813324]
curr_Stock_Price:  101.38425561002833
curr_Factors:  [101.38425561]
mat_Sqrt:  [[0.15]]
grads:  [-0.00628063]
Stock Position:  -0.006280631580480069
Bond Position:  [17.8548904]


portfolio before change:  [17.22509449]
curr_Stock_Price:  100.63126616658481
curr_Factors:  [100.63126617]
mat_Sqrt:  [[0.15]]
grads:  [0.07515246]
Stock Position:  0.0751524607842074
Bond Position:  [9.66240721]


portfolio before change:  [17.21642]
curr_Stock_Price:  100.4997685911159
curr_Factors:  [100.49976859]
mat_Sqrt:  [[0.15]]
grads:  [-0.01788105]
Stock Position:  -0.017881052640563503
Bond Position:  [19.01346165]


portfolio before change:  [17.23053784]
curr_Stock_Price:  99.84315146639267
curr_Factors:  [99.84315147]
mat_Sqrt:  [[0.15]]
grads:  [0.08459014]
Stock Position:  0.08459013767093379
Bond Position:  [8.78479191]


portfolio before change:  [17.21275562]
curr_Stock_Price:  99.61995306376924
curr_Factors:  [99.61995306]
mat_Sqrt:  [[0.15]]
grads:  [0.04497311]
Stock Position:  0.04497310722883729
Bond Position:  [12.73253679]


portfolio before change:  [17.20892082]
curr_Stock_Price:  99.49929278814734
curr_Factors:  [99.49929279]
mat_Sqrt:  [[0.15]]
grads:  [-0.0489173]
Stock Position:  -0.048917302864058876
Bond Position:  [22.07615786]


portfolio before change:  [17.1783173]
curr_Stock_Price:  100.1813258537208
curr_Factors:  [100.18132585]
mat_Sqrt:  [[0.15]]
grads:  [0.13938504]
Stock Position:  0.13938504095039958
Bond Position:  [3.21453909]


portfolio before change:  [17.20173094]
curr_Stock_Price:  100.34642107910747
curr_Factors:  [100.34642108]
mat_Sqrt:  [[0.15]]
grads:  [-0.03934549]
Stock Position:  -0.03934548964199216
Bond Position:  [21.14991001]


portfolio before change:  [17.23669077]
curr_Stock_Price:  99.52508366225261
curr_Factors:  [99.52508366]
mat_Sqrt:  [[0.15]]
grads:  [0.02903387]
Stock Position:  0.029033869645535382
Bond Position:  [14.34709246]


portfolio before change:  [17.25742391]
curr_Stock_Price:  100.17741303198127
curr_Factors:  [100.17741303]
mat_Sqrt:  [[0.15]]
grads:  [0.05342852]
Stock Position:  0.053428523659157755
Bond Position:  [11.90509263]


portfolio before change:  [17.24725908]
curr_Stock_Price:  99.9593073297036
curr_Factors:  [99.95930733]
mat_Sqrt:  [[0.15]]
grads:  [0.02774919]
Stock Position:  0.02774918792958781
Bond Position:  [14.47346947]


portfolio before change:  [17.24723693]
curr_Stock_Price:  99.89330732001262
curr_Factors:  [99.89330732]
mat_Sqrt:  [[0.15]]
grads:  [0.07398536]
Stock Position:  0.07398536245193808
Bond Position:  [9.85659438]


portfolio before change:  [17.20088964]
curr_Stock_Price:  99.25021474176644
curr_Factors:  [99.25021474]
mat_Sqrt:  [[0.15]]
grads:  [0.03037531]
Stock Position:  0.0303753124727564
Bond Position:  [14.18613336]


portfolio before change:  [17.23907741]
curr_Stock_Price:  100.44903024168843
curr_Factors:  [100.44903024]
mat_Sqrt:  [[0.15]]
grads:  [0.13919939]
Stock Position:  0.13919938935143422
Bond Position:  [3.25663374]


portfolio before change:  [17.14911205]
curr_Stock_Price:  99.79979989749272
curr_Factors:  [99.7997999]
mat_Sqrt:  [[0.15]]
grads:  [-0.012128]
Stock Position:  -0.012128001939234034
Bond Position:  [18.35948422]


portfolio before change:  [17.14546312]
curr_Stock_Price:  100.28990641367835
curr_Factors:  [100.28990641]
mat_Sqrt:  [[0.15]]
grads:  [0.06260997]
Stock Position:  0.06260996877743101
Bond Position:  [10.86631521]


portfolio before change:  [17.15574377]
curr_Stock_Price:  100.43241205245623
curr_Factors:  [100.43241205]
mat_Sqrt:  [[0.15]]
grads:  [0.08221191]
Stock Position:  0.08221190984888455
Bond Position:  [8.89900336]


portfolio before change:  [17.21080097]
curr_Stock_Price:  101.08857927483572
curr_Factors:  [101.08857927]
mat_Sqrt:  [[0.15]]
grads:  [0.07709156]
Stock Position:  0.07709155517578836
Bond Position:  [9.41772518]


portfolio before change:  [17.14152514]
curr_Stock_Price:  100.17469036553
curr_Factors:  [100.17469037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08423043]
Stock Position:  -0.08423043416240401
Bond Position:  [25.57928281]


portfolio before change:  [17.1173634]
curr_Stock_Price:  100.49950590878062
curr_Factors:  [100.49950591]
mat_Sqrt:  [[0.15]]
grads:  [-0.10251436]
Stock Position:  -0.10251436081028599
Bond Position:  [27.42000601]


portfolio before change:  [17.08430504]
curr_Stock_Price:  100.85541774065169
curr_Factors:  [100.85541774]
mat_Sqrt:  [[0.15]]
grads:  [0.12492234]
Stock Position:  0.12492233846154305
Bond Position:  [4.48521041]


portfolio before change:  [17.02656814]
curr_Stock_Price:  100.38874707014979
curr_Factors:  [100.38874707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839039]
Stock Position:  -0.008390391292031492
Bond Position:  [17.868869]


portfolio before change:  [17.03249694]
curr_Stock_Price:  99.94835602880941
curr_Factors:  [99.94835603]
mat_Sqrt:  [[0.15]]
grads:  [0.03672721]
Stock Position:  0.036727210599862115
Bond Position:  [13.36167262]


portfolio before change:  [17.03620084]
curr_Stock_Price:  100.0037261202554
curr_Factors:  [100.00372612]
mat_Sqrt:  [[0.15]]
grads:  [-0.00877395]
Stock Position:  -0.008773946250983378
Bond Position:  [17.91362816]


portfolio before change:  [17.04382861]
curr_Stock_Price:  99.38958624958933
curr_Factors:  [99.38958625]
mat_Sqrt:  [[0.15]]
grads:  [-0.07240238]
Stock Position:  -0.0724023788656406
Bond Position:  [24.23987109]


portfolio before change:  [17.01439021]
curr_Stock_Price:  99.83803249960255
curr_Factors:  [99.8380325]
mat_Sqrt:  [[0.15]]
grads:  [0.04192677]
Stock Position:  0.041926768740476454
Bond Position:  [12.82850411]


portfolio before change:  [16.96189106]
curr_Stock_Price:  98.54762027681157
curr_Factors:  [98.54762028]
mat_Sqrt:  [[0.15]]
grads:  [-0.07788927]
Stock Position:  -0.07788927487869245
Bond Position:  [24.63769374]


portfolio before change:  [16.93835745]
curr_Stock_Price:  98.8893041997848
curr_Factors:  [98.8893042]
mat_Sqrt:  [[0.15]]
grads:  [-0.12490982]
Stock Position:  -0.12490982446662992
Bond Position:  [29.29060308]


portfolio before change:  [17.00587818]
curr_Stock_Price:  98.37806200094231
curr_Factors:  [98.378062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01415795]
Stock Position:  -0.014157950362065005
Bond Position:  [18.3987099]


portfolio before change:  [17.00447035]
curr_Stock_Price:  98.63995100481239
curr_Factors:  [98.639951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02386994]
Stock Position:  -0.02386994285838834
Bond Position:  [19.35900034]


portfolio before change:  [17.01524813]
curr_Stock_Price:  98.28981395455341
curr_Factors:  [98.28981395]
mat_Sqrt:  [[0.15]]
grads:  [0.03753525]
Stock Position:  0.03753525359209304
Bond Position:  [13.32591503]


portfolio before change:  [16.97726949]
curr_Stock_Price:  97.2336206995818
curr_Factors:  [97.2336207]
mat_Sqrt:  [[0.15]]
grads:  [0.06434582]
Stock Position:  0.06434582360135349
Bond Position:  [10.72069208]


portfolio before change:  [16.92973086]
curr_Stock_Price:  96.47399412432117
curr_Factors:  [96.47399412]
mat_Sqrt:  [[0.15]]
grads:  [-0.08567569]
Stock Position:  -0.08567569423515364
Bond Position:  [25.19520728]


portfolio before change:  [16.95692469]
curr_Stock_Price:  96.19335175529831
curr_Factors:  [96.19335176]
mat_Sqrt:  [[0.15]]
grads:  [0.01867028]
Stock Position:  0.01867027710576648
Bond Position:  [15.16096816]


portfolio before change:  [16.98859955]
curr_Stock_Price:  97.78837995968925
curr_Factors:  [97.78837996]
mat_Sqrt:  [[0.15]]
grads:  [0.03807701]
Stock Position:  0.03807700704784094
Bond Position:  [13.26511071]


portfolio before change:  [16.99675325]
curr_Stock_Price:  97.95896741367652
curr_Factors:  [97.95896741]
mat_Sqrt:  [[0.15]]
grads:  [0.02380217]
Stock Position:  0.023802165721057394
Bond Position:  [14.66511767]


portfolio before change:  [16.99157935]
curr_Stock_Price:  97.6645758472529
curr_Factors:  [97.66457585]
mat_Sqrt:  [[0.15]]
grads:  [0.07725339]
Stock Position:  0.07725339125505133
Bond Position:  [9.44665966]


portfolio before change:  [17.05290325]
curr_Stock_Price:  98.44309174572605
curr_Factors:  [98.44309175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.05290325]
Stock Price:  100.4363058625142
PL:  [16.61659738]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.43577498e-03]
 [-1.13936563e-02]
 [-1.93472006e-02]
 [ 5.33370125e-03]
 [-3.28093539e-02]
 [-2.51629520e-02]
 [-4.83509329e-02]
 [ 2.03376456e-02]
 [-6.16784737e-03]
 [ 4.51503799e-03]
 [ 7.93374643e-03]
 [ 4.25578894e-03]
 [ 1.39516336e-02]
 [ 2.92897767e-03]
 [ 1.13475459e-03]
 [-5.14649724e-03]
 [ 1.97818170e-02]
 [-2.41065133e-02]
 [ 2.86505107e-03]
 [-3.82113461e-04]
 [ 2.15126037e-02]
 [-2.31922740e-03]
 [ 2.74532747e-02]
 [-4.28445408e-04]
 [ 1.18713888e-02]
 [-2.46154342e-03]
 [ 2.77743162e-02]
 [-2.35099281e-02]
 [-4.76748866e-02]
 [ 1.37233345e-03]
 [-4.19783364e-03]
 [ 5.60084632e-03]
 [ 1.18690705e-02]
 [-1.28573095e-02]
 [ 2.89548749e-03]
 [ 5.58577637e-03]
 [ 3.65230305e-03]
 [ 1.07238324e-02]
 [-4.19752323e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.13364919]
curr_Stock_Price:  99.8654424231663
curr_Factors:  [99.86544242]
mat_Sqrt:  [[0.15]]
grads:  [0.0162385]
Stock Position:  0.016238499894686537
Bond Position:  [-1.75531417]


portfolio before change:  [-0.15322066]
curr_Stock_Price:  98.67370413365668
curr_Factors:  [98.67370413]
mat_Sqrt:  [[0.15]]
grads:  [-0.07595771]
Stock Position:  -0.0759577089334719
Bond Position:  [7.34180784]


portfolio before change:  [-0.10668517]
curr_Stock_Price:  98.07313698153368
curr_Factors:  [98.07313698]
mat_Sqrt:  [[0.15]]
grads:  [-0.12898134]
Stock Position:  -0.12898133753930086
Bond Position:  [12.54291921]


portfolio before change:  [-0.0602977]
curr_Stock_Price:  97.72564861264676
curr_Factors:  [97.72564861]
mat_Sqrt:  [[0.15]]
grads:  [0.03555801]
Stock Position:  0.03555800834046844
Bond Position:  [-3.53522712]


portfolio before change:  [-0.0580292]
curr_Stock_Price:  97.80187400074429
curr_Factors:  [97.801874]
mat_Sqrt:  [[0.15]]
grads:  [-0.21872903]
Stock Position:  -0.21872902598256858
Bond Position:  [21.33407943]


portfolio before change:  [-0.16683673]
curr_Stock_Price:  98.31152034691404
curr_Factors:  [98.31152035]
mat_Sqrt:  [[0.15]]
grads:  [-0.16775301]
Stock Position:  -0.16775301306744897
Bond Position:  [16.32521703]


portfolio before change:  [-0.05732201]
curr_Stock_Price:  97.67085262705477
curr_Factors:  [97.67085263]
mat_Sqrt:  [[0.15]]
grads:  [-0.32233955]
Stock Position:  -0.32233955234371164
Bond Position:  [31.42585691]


portfolio before change:  [-0.23635789]
curr_Stock_Price:  98.23846637181951
curr_Factors:  [98.23846637]
mat_Sqrt:  [[0.15]]
grads:  [0.1355843]
Stock Position:  0.13558430367499064
Bond Position:  [-13.55595195]


portfolio before change:  [-0.32243555]
curr_Stock_Price:  97.61610039968924
curr_Factors:  [97.6161004]
mat_Sqrt:  [[0.15]]
grads:  [-0.04111898]
Stock Position:  -0.041118982469200226
Bond Position:  [3.69143917]


portfolio before change:  [-0.39818639]
curr_Stock_Price:  99.46955827727705
curr_Factors:  [99.46955828]
mat_Sqrt:  [[0.15]]
grads:  [0.03010025]
Stock Position:  0.030100253285628795
Bond Position:  [-3.39224529]


portfolio before change:  [-0.37780901]
curr_Stock_Price:  100.16062996910324
curr_Factors:  [100.16062997]
mat_Sqrt:  [[0.15]]
grads:  [0.05289164]
Stock Position:  0.0528916428996494
Bond Position:  [-5.67546929]


portfolio before change:  [-0.39222214]
curr_Stock_Price:  99.90154088680107
curr_Factors:  [99.90154089]
mat_Sqrt:  [[0.15]]
grads:  [0.02837193]
Stock Position:  0.028371926272066732
Bond Position:  [-3.22662129]


portfolio before change:  [-0.41524978]
curr_Stock_Price:  99.1041229020948
curr_Factors:  [99.1041229]
mat_Sqrt:  [[0.15]]
grads:  [0.09301089]
Stock Position:  0.09301089045155536
Bond Position:  [-9.63301249]


portfolio before change:  [-0.45978279]
curr_Stock_Price:  98.63827619667606
curr_Factors:  [98.6382762]
mat_Sqrt:  [[0.15]]
grads:  [0.01952652]
Stock Position:  0.019526517774171248
Bond Position:  [-2.38584485]


portfolio before change:  [-0.47980157]
curr_Stock_Price:  97.62834051660286
curr_Factors:  [97.62834052]
mat_Sqrt:  [[0.15]]
grads:  [0.00756503]
Stock Position:  0.007565030624860503
Bond Position:  [-1.21836296]


portfolio before change:  [-0.48482146]
curr_Stock_Price:  96.98490836638102
curr_Factors:  [96.98490837]
mat_Sqrt:  [[0.15]]
grads:  [-0.03430998]
Stock Position:  -0.03430998157550924
Bond Position:  [2.84272896]


portfolio before change:  [-0.45003354]
curr_Stock_Price:  95.98133577862046
curr_Factors:  [95.98133578]
mat_Sqrt:  [[0.15]]
grads:  [0.13187878]
Stock Position:  0.13187878008410187
Bond Position:  [-13.10793501]


portfolio before change:  [-0.48379705]
curr_Stock_Price:  95.737741485946
curr_Factors:  [95.73774149]
mat_Sqrt:  [[0.15]]
grads:  [-0.16071009]
Stock Position:  -0.16071008879563617
Bond Position:  [14.90222388]


portfolio before change:  [-0.50623143]
curr_Stock_Price:  95.88892845438622
curr_Factors:  [95.88892845]
mat_Sqrt:  [[0.15]]
grads:  [0.01910034]
Stock Position:  0.019100340495955596
Bond Position:  [-2.33774261]


portfolio before change:  [-0.49389256]
curr_Stock_Price:  96.55023095673936
curr_Factors:  [96.55023096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00254742]
Stock Position:  -0.0025474230714759667
Bond Position:  [-0.24793828]


portfolio before change:  [-0.49421464]
curr_Stock_Price:  96.66449551784298
curr_Factors:  [96.66449552]
mat_Sqrt:  [[0.15]]
grads:  [0.14341736]
Stock Position:  0.14341735820742715
Bond Position:  [-14.35758122]


portfolio before change:  [-0.63604555]
curr_Stock_Price:  95.68807187039809
curr_Factors:  [95.68807187]
mat_Sqrt:  [[0.15]]
grads:  [-0.01546152]
Stock Position:  -0.01546151601942673
Bond Position:  [0.84343711]


portfolio before change:  [-0.62561125]
curr_Stock_Price:  95.02003516424784
curr_Factors:  [95.02003516]
mat_Sqrt:  [[0.15]]
grads:  [0.18302183]
Stock Position:  0.18302183132550356
Bond Position:  [-18.0163521]


portfolio before change:  [-0.8375786]
curr_Stock_Price:  93.87418737185459
curr_Factors:  [93.87418737]
mat_Sqrt:  [[0.15]]
grads:  [-0.0028563]
Stock Position:  -0.002856302717090895
Bond Position:  [-0.5694455]


portfolio before change:  [-0.84057967]
curr_Stock_Price:  94.89994961494553
curr_Factors:  [94.89994961]
mat_Sqrt:  [[0.15]]
grads:  [0.07914259]
Stock Position:  0.07914259211279832
Bond Position:  [-8.35120767]


portfolio before change:  [-0.76335175]
curr_Stock_Price:  95.8889478429528
curr_Factors:  [95.88894784]
mat_Sqrt:  [[0.15]]
grads:  [-0.01641029]
Stock Position:  -0.01641028948576081
Bond Position:  [0.81021364]


portfolio before change:  [-0.74755005]
curr_Stock_Price:  94.93220525260807
curr_Factors:  [94.93220525]
mat_Sqrt:  [[0.15]]
grads:  [0.18516211]
Stock Position:  0.18516210787870263
Bond Position:  [-18.32539728]


portfolio before change:  [-0.73616134]
curr_Stock_Price:  95.00608389617462
curr_Factors:  [95.0060839]
mat_Sqrt:  [[0.15]]
grads:  [-0.15673285]
Stock Position:  -0.156732853917163
Bond Position:  [14.15441333]


portfolio before change:  [-0.85400356]
curr_Stock_Price:  95.76923998100827
curr_Factors:  [95.76923998]
mat_Sqrt:  [[0.15]]
grads:  [-0.31783258]
Stock Position:  -0.3178325771724932
Bond Position:  [29.5845808]


portfolio before change:  [-0.74582942]
curr_Stock_Price:  95.44052657349728
curr_Factors:  [95.44052657]
mat_Sqrt:  [[0.15]]
grads:  [0.00914889]
Stock Position:  0.00914888965616136
Bond Position:  [-1.61900427]


portfolio before change:  [-0.74396726]
curr_Stock_Price:  95.66618767174562
curr_Factors:  [95.66618767]
mat_Sqrt:  [[0.15]]
grads:  [-0.02798556]
Stock Position:  -0.027985557615087035
Bond Position:  [1.93330434]


portfolio before change:  [-0.781828]
curr_Stock_Price:  97.02769042733982
curr_Factors:  [97.02769043]
mat_Sqrt:  [[0.15]]
grads:  [0.03733898]
Stock Position:  0.03733897543750139
Bond Position:  [-4.40474255]


portfolio before change:  [-0.80874533]
curr_Stock_Price:  96.32154616494921
curr_Factors:  [96.32154616]
mat_Sqrt:  [[0.15]]
grads:  [0.07912714]
Stock Position:  0.07912713635728093
Bond Position:  [-8.43039345]


portfolio before change:  [-0.77813911]
curr_Stock_Price:  96.72166275083882
curr_Factors:  [96.72166275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0857154]
Stock Position:  -0.08571539664060746
Bond Position:  [7.51239657]


portfolio before change:  [-0.77560849]
curr_Stock_Price:  96.70309534780992
curr_Factors:  [96.70309535]
mat_Sqrt:  [[0.15]]
grads:  [0.01930325]
Stock Position:  0.019303249929404666
Bond Position:  [-2.64229251]


portfolio before change:  [-0.79349527]
curr_Stock_Price:  95.79358681442358
curr_Factors:  [95.79358681]
mat_Sqrt:  [[0.15]]
grads:  [0.03723851]
Stock Position:  0.037238509118543414
Bond Position:  [-4.36070563]


portfolio before change:  [-0.81079605]
curr_Stock_Price:  95.34363183979515
curr_Factors:  [95.34363184]
mat_Sqrt:  [[0.15]]
grads:  [0.02434869]
Stock Position:  0.024348687021235427
Bond Position:  [-3.1322883]


portfolio before change:  [-0.80383703]
curr_Stock_Price:  95.6455198098696
curr_Factors:  [95.64551981]
mat_Sqrt:  [[0.15]]
grads:  [0.07149222]
Stock Position:  0.07149221596965084
Bond Position:  [-7.64174719]


portfolio before change:  [-0.79996815]
curr_Stock_Price:  95.7129979588237
curr_Factors:  [95.71299796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79996815]
Stock Price:  96.09006636321062
PL:  [-0.79996815]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.20923325e-03]
 [ 3.20469490e-03]
 [ 6.42618405e-03]
 [-2.30127745e-03]
 [ 1.29781250e-02]
 [-9.32643095e-03]
 [-3.42492905e-02]
 [ 2.11325444e-02]
 [-6.09481896e-03]
 [ 2.76254054e-03]
 [ 1.55644990e-03]
 [ 5.25427615e-03]
 [ 1.14085130e-02]
 [ 3.98956430e-03]
 [ 1.80758135e-02]
 [-1.25982346e-03]
 [ 1.01726564e-02]
 [-4.88058919e-03]
 [ 9.97930309e-03]
 [-1.01639125e-02]
 [ 9.73870197e-03]
 [ 2.27327316e-03]
 [ 2.09688244e-02]
 [ 5.08944295e-03]
 [ 1.48100920e-03]
 [-9.44471936e-03]
 [ 1.38784631e-02]
 [-1.08669649e-02]
 [-1.86374600e-02]
 [-2.05246452e-03]
 [-3.60505013e-03]
 [ 5.63122347e-03]
 [ 6.83726041e-03]
 [-1.26390413e-02]
 [ 3.24149407e-03]
 [ 5.71424562e-03]
 [ 2.54150988e-03]
 [ 8.36858009e-03]
 [-1.11453325e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.28431136]
curr_Stock_Price:  100.21495164051954
curr_Factors:  [100.21495164]
mat_Sqrt:  [[0.15]]
grads:  [0.04139489]
Stock Position:  0.04139488833146786
Bond Position:  [1.13592463]


portfolio before change:  [5.30483301]
curr_Stock_Price:  100.7072744075963
curr_Factors:  [100.70727441]
mat_Sqrt:  [[0.15]]
grads:  [0.02136463]
Stock Position:  0.02136463263728955
Bond Position:  [3.15325909]


portfolio before change:  [5.28645489]
curr_Stock_Price:  99.82861195068803
curr_Factors:  [99.82861195]
mat_Sqrt:  [[0.15]]
grads:  [0.04284123]
Stock Position:  0.04284122698228313
Bond Position:  [1.00967467]


portfolio before change:  [5.27847672]
curr_Stock_Price:  99.63943945041326
curr_Factors:  [99.63943945]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534185]
Stock Position:  -0.015341849640528791
Bond Position:  [6.80713002]


portfolio before change:  [5.27548958]
curr_Stock_Price:  99.8896105777343
curr_Factors:  [99.88961058]
mat_Sqrt:  [[0.15]]
grads:  [0.08652083]
Stock Position:  0.0865208333605085
Bond Position:  [-3.36704277]


portfolio before change:  [5.20693078]
curr_Stock_Price:  99.10207890498772
curr_Factors:  [99.1020789]
mat_Sqrt:  [[0.15]]
grads:  [-0.06217621]
Stock Position:  -0.06217620630600344
Bond Position:  [11.36872208]


portfolio before change:  [5.22580194]
curr_Stock_Price:  98.82142515497506
curr_Factors:  [98.82142515]
mat_Sqrt:  [[0.15]]
grads:  [-0.2283286]
Stock Position:  -0.22832860325664997
Bond Position:  [27.78955992]


portfolio before change:  [5.30357277]
curr_Stock_Price:  98.49603048075315
curr_Factors:  [98.49603048]
mat_Sqrt:  [[0.15]]
grads:  [0.14088363]
Stock Position:  0.14088362952097655
Bond Position:  [-8.5729055]


portfolio before change:  [5.21270127]
curr_Stock_Price:  97.85862632117265
curr_Factors:  [97.85862632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04063213]
Stock Position:  -0.04063212643131113
Bond Position:  [9.18890535]


portfolio before change:  [5.17914782]
curr_Stock_Price:  98.71268290529551
curr_Factors:  [98.71268291]
mat_Sqrt:  [[0.15]]
grads:  [0.01841694]
Stock Position:  0.018416936901237836
Bond Position:  [3.36116257]


portfolio before change:  [5.18284084]
curr_Stock_Price:  98.89039108668376
curr_Factors:  [98.89039109]
mat_Sqrt:  [[0.15]]
grads:  [0.01037633]
Stock Position:  0.010376332637425448
Bond Position:  [4.15672124]


portfolio before change:  [5.18929556]
curr_Stock_Price:  99.46237607350895
curr_Factors:  [99.46237607]
mat_Sqrt:  [[0.15]]
grads:  [0.03502851]
Stock Position:  0.03502850766970125
Bond Position:  [1.70527696]


portfolio before change:  [5.20978617]
curr_Stock_Price:  100.04125972373497
curr_Factors:  [100.04125972]
mat_Sqrt:  [[0.15]]
grads:  [0.07605675]
Stock Position:  0.07605675340500825
Bond Position:  [-2.39902725]


portfolio before change:  [5.13279043]
curr_Stock_Price:  99.0328569900238
curr_Factors:  [99.03285699]
mat_Sqrt:  [[0.15]]
grads:  [0.0265971]
Stock Position:  0.02659709534405567
Bond Position:  [2.49880409]


portfolio before change:  [5.16121454]
curr_Stock_Price:  100.08980446982216
curr_Factors:  [100.08980447]
mat_Sqrt:  [[0.15]]
grads:  [0.12050542]
Stock Position:  0.12050542360898693
Bond Position:  [-6.90014975]


portfolio before change:  [5.15036773]
curr_Stock_Price:  100.0069515174922
curr_Factors:  [100.00695152]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839882]
Stock Position:  -0.008398823073885208
Bond Position:  [5.99030843]


portfolio before change:  [5.15357811]
curr_Stock_Price:  99.71386943148133
curr_Factors:  [99.71386943]
mat_Sqrt:  [[0.15]]
grads:  [0.06781771]
Stock Position:  0.06781770922787415
Bond Position:  [-1.60878809]


portfolio before change:  [5.087462]
curr_Stock_Price:  98.74192565886369
curr_Factors:  [98.74192566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03253726]
Stock Position:  -0.0325372612540967
Bond Position:  [8.30025383]


portfolio before change:  [5.0767321]
curr_Stock_Price:  99.10358789912787
curr_Factors:  [99.1035879]
mat_Sqrt:  [[0.15]]
grads:  [0.06652869]
Stock Position:  0.0665286872737574
Bond Position:  [-1.51649951]


portfolio before change:  [5.06650803]
curr_Stock_Price:  98.95275834605984
curr_Factors:  [98.95275835]
mat_Sqrt:  [[0.15]]
grads:  [-0.06775942]
Stock Position:  -0.06775941653866834
Bond Position:  [11.7714892]


portfolio before change:  [5.08241189]
curr_Stock_Price:  98.73976472022224
curr_Factors:  [98.73976472]
mat_Sqrt:  [[0.15]]
grads:  [0.06492468]
Stock Position:  0.0649246797755603
Bond Position:  [-1.32823572]


portfolio before change:  [5.06275783]
curr_Stock_Price:  98.43960129111525
curr_Factors:  [98.43960129]
mat_Sqrt:  [[0.15]]
grads:  [0.01515515]
Stock Position:  0.01515515440490291
Bond Position:  [3.57089047]


portfolio before change:  [5.05115585]
curr_Stock_Price:  97.64460005477595
curr_Factors:  [97.64460005]
mat_Sqrt:  [[0.15]]
grads:  [0.13979216]
Stock Position:  0.13979216258284555
Bond Position:  [-8.59879395]


portfolio before change:  [5.25853536]
curr_Stock_Price:  99.13577395440356
curr_Factors:  [99.13577395]
mat_Sqrt:  [[0.15]]
grads:  [0.03392962]
Stock Position:  0.033929619666549324
Bond Position:  [1.89489626]


portfolio before change:  [5.27821455]
curr_Stock_Price:  99.70879275249544
curr_Factors:  [99.70879275]
mat_Sqrt:  [[0.15]]
grads:  [0.00987339]
Stock Position:  0.009873394656617514
Bond Position:  [4.29375029]


portfolio before change:  [5.28173489]
curr_Stock_Price:  100.01097802543556
curr_Factors:  [100.01097803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0629648]
Stock Position:  -0.06296479573470701
Bond Position:  [11.5789057]


portfolio before change:  [5.3645193]
curr_Stock_Price:  98.71919342029138
curr_Factors:  [98.71919342]
mat_Sqrt:  [[0.15]]
grads:  [0.09252309]
Stock Position:  0.09252308737867175
Bond Position:  [-3.76928526]


portfolio before change:  [5.40354994]
curr_Stock_Price:  99.14613361545206
curr_Factors:  [99.14613362]
mat_Sqrt:  [[0.15]]
grads:  [-0.07244643]
Stock Position:  -0.07244643263596182
Bond Position:  [12.58633363]


portfolio before change:  [5.41783703]
curr_Stock_Price:  98.97064252206881
curr_Factors:  [98.97064252]
mat_Sqrt:  [[0.15]]
grads:  [-0.12424973]
Stock Position:  -0.12424973336110638
Bond Position:  [17.71491297]


portfolio before change:  [5.49710977]
curr_Stock_Price:  98.35045418284764
curr_Factors:  [98.35045418]
mat_Sqrt:  [[0.15]]
grads:  [-0.0136831]
Stock Position:  -0.013683096785616614
Bond Position:  [6.84284855]


portfolio before change:  [5.495172]
curr_Stock_Price:  98.55458750876082
curr_Factors:  [98.55458751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02403367]
Stock Position:  -0.02403366752585007
Bond Position:  [7.86380019]


portfolio before change:  [5.50155475]
curr_Stock_Price:  98.32991463696901
curr_Factors:  [98.32991464]
mat_Sqrt:  [[0.15]]
grads:  [0.03754149]
Stock Position:  0.03754148981839951
Bond Position:  [1.81010326]


portfolio before change:  [5.51826896]
curr_Stock_Price:  98.76910689568
curr_Factors:  [98.7691069]
mat_Sqrt:  [[0.15]]
grads:  [0.04558174]
Stock Position:  0.045581736062273025
Bond Position:  [1.0162016]


portfolio before change:  [5.45765902]
curr_Stock_Price:  97.4366221210545
curr_Factors:  [97.43662212]
mat_Sqrt:  [[0.15]]
grads:  [-0.08426028]
Stock Position:  -0.08426027515135784
Bond Position:  [13.66769561]


portfolio before change:  [5.45421315]
curr_Stock_Price:  97.49779503491479
curr_Factors:  [97.49779503]
mat_Sqrt:  [[0.15]]
grads:  [0.02160996]
Stock Position:  0.021609960445170582
Bond Position:  [3.34728965]


portfolio before change:  [5.47692718]
curr_Stock_Price:  98.52952256853658
curr_Factors:  [98.52952257]
mat_Sqrt:  [[0.15]]
grads:  [0.03809497]
Stock Position:  0.03809497082592987
Bond Position:  [1.72344789]


portfolio before change:  [5.52480318]
curr_Stock_Price:  99.78062111773919
curr_Factors:  [99.78062112]
mat_Sqrt:  [[0.15]]
grads:  [0.0169434]
Stock Position:  0.016943399167906534
Bond Position:  [3.83418029]


portfolio before change:  [5.52805634]
curr_Stock_Price:  99.9443341214599
curr_Factors:  [99.94433412]
mat_Sqrt:  [[0.15]]
grads:  [0.05579053]
Stock Position:  0.05579053393861874
Bond Position:  [-0.04789142]


portfolio before change:  [5.58996004]
curr_Stock_Price:  101.05401504317538
curr_Factors:  [101.05401504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.58996004]
Stock Price:  102.60639867675648
PL:  [2.98356137]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.03409483e-03]
 [ 4.50604054e-03]
 [ 1.50655420e-02]
 [-6.54715994e-04]
 [ 1.53087982e-02]
 [ 2.22939801e-02]
 [-2.23345334e-03]
 [ 2.35136717e-02]
 [-6.01172288e-03]
 [ 6.40373696e-03]
 [-1.28805435e-02]
 [ 7.75628156e-03]
 [ 1.38664189e-02]
 [-7.18661974e-04]
 [-7.91518808e-03]
 [-9.67665216e-03]
 [ 2.14068110e-02]
 [-1.45221621e-02]
 [ 4.76920942e-03]
 [-7.81106225e-03]
 [ 9.49362963e-03]
 [ 5.98242724e-03]
 [ 1.67029193e-02]
 [ 4.94329881e-03]
 [ 1.35398594e-02]
 [-1.08359767e-02]
 [ 5.04875413e-03]
 [-1.08798962e-02]
 [-1.84912068e-02]
 [-1.32346580e-03]
 [-3.92069543e-03]
 [ 5.61948330e-03]
 [ 5.81382487e-03]
 [-1.08173720e-02]
 [ 1.28711920e-02]
 [ 5.71656249e-03]
 [ 3.07119677e-03]
 [ 1.02787378e-02]
 [-1.46481589e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.08600152]
curr_Stock_Price:  99.94412132089347
curr_Factors:  [99.94412132]
mat_Sqrt:  [[0.15]]
grads:  [0.0202273]
Stock Position:  0.020227298866215233
Bond Position:  [-0.9355981]


portfolio before change:  [1.09487601]
curr_Stock_Price:  100.38864186651472
curr_Factors:  [100.38864187]
mat_Sqrt:  [[0.15]]
grads:  [0.03004027]
Stock Position:  0.030040270273621328
Bond Position:  [-1.92082593]


portfolio before change:  [1.13179148]
curr_Stock_Price:  101.6255013196285
curr_Factors:  [101.62550132]
mat_Sqrt:  [[0.15]]
grads:  [0.10043695]
Stock Position:  0.10043694693518884
Bond Position:  [-9.0751636]


portfolio before change:  [1.06362502]
curr_Stock_Price:  100.95809752930562
curr_Factors:  [100.95809753]
mat_Sqrt:  [[0.15]]
grads:  [-0.00436477]
Stock Position:  -0.004364773293354353
Bond Position:  [1.50428422]


portfolio before change:  [1.06484143]
curr_Stock_Price:  100.72249199326735
curr_Factors:  [100.72249199]
mat_Sqrt:  [[0.15]]
grads:  [0.10205865]
Stock Position:  0.10205865440536759
Bond Position:  [-9.21476057]


portfolio before change:  [1.03080018]
curr_Stock_Price:  100.40023287856029
curr_Factors:  [100.40023288]
mat_Sqrt:  [[0.15]]
grads:  [0.14862653]
Stock Position:  0.14862653420443936
Bond Position:  [-13.89133847]


portfolio before change:  [0.98791523]
curr_Stock_Price:  100.12337504492065
curr_Factors:  [100.12337504]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488969]
Stock Position:  -0.014889688925730383
Bond Position:  [2.47872114]


portfolio before change:  [0.99897016]
curr_Stock_Price:  99.40173050451907
curr_Factors:  [99.4017305]
mat_Sqrt:  [[0.15]]
grads:  [0.15675781]
Stock Position:  0.1567578112708006
Bond Position:  [-14.58302755]


portfolio before change:  [0.81053828]
curr_Stock_Price:  98.21130252925562
curr_Factors:  [98.21130253]
mat_Sqrt:  [[0.15]]
grads:  [-0.04007815]
Stock Position:  -0.04007815251493792
Bond Position:  [4.74666584]


portfolio before change:  [0.88203828]
curr_Stock_Price:  96.44209348273795
curr_Factors:  [96.44209348]
mat_Sqrt:  [[0.15]]
grads:  [0.04269158]
Stock Position:  0.04269157971780493
Bond Position:  [-3.23522704]


portfolio before change:  [0.85584351]
curr_Stock_Price:  95.83798508093484
curr_Factors:  [95.83798508]
mat_Sqrt:  [[0.15]]
grads:  [-0.08587029]
Stock Position:  -0.085870290314128
Bond Position:  [9.08547911]


portfolio before change:  [0.97168175]
curr_Stock_Price:  94.50222061542817
curr_Factors:  [94.50222062]
mat_Sqrt:  [[0.15]]
grads:  [0.05170854]
Stock Position:  0.051708543705994765
Bond Position:  [-3.91489046]


portfolio before change:  [0.99218551]
curr_Stock_Price:  94.90821073282817
curr_Factors:  [94.90821073]
mat_Sqrt:  [[0.15]]
grads:  [0.09244279]
Stock Position:  0.09244279264437742
Bond Position:  [-7.78139453]


portfolio before change:  [1.07540151]
curr_Stock_Price:  95.81892243460052
curr_Factors:  [95.81892243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479108]
Stock Position:  -0.004791079825035935
Bond Position:  [1.53447762]


portfolio before change:  [1.07848932]
curr_Stock_Price:  95.21446949189541
curr_Factors:  [95.21446949]
mat_Sqrt:  [[0.15]]
grads:  [-0.05276792]
Stock Position:  -0.05276792056373552
Bond Position:  [6.10275888]


portfolio before change:  [1.07658072]
curr_Stock_Price:  95.26509669798209
curr_Factors:  [95.2650967]
mat_Sqrt:  [[0.15]]
grads:  [-0.06451101]
Stock Position:  -0.06451101441574891
Bond Position:  [7.22222874]


portfolio before change:  [1.07203982]
curr_Stock_Price:  95.34948121677232
curr_Factors:  [95.34948122]
mat_Sqrt:  [[0.15]]
grads:  [0.14271207]
Stock Position:  0.1427120734949573
Bond Position:  [-12.53548235]


portfolio before change:  [1.24127292]
curr_Stock_Price:  96.54629748677362
curr_Factors:  [96.54629749]
mat_Sqrt:  [[0.15]]
grads:  [-0.09681441]
Stock Position:  -0.0968144143269781
Bond Position:  [10.58834617]


portfolio before change:  [1.19474763]
curr_Stock_Price:  97.04053081728702
curr_Factors:  [97.04053082]
mat_Sqrt:  [[0.15]]
grads:  [0.03179473]
Stock Position:  0.031794729486707085
Bond Position:  [-1.89062979]


portfolio before change:  [1.24207665]
curr_Stock_Price:  98.53654475253609
curr_Factors:  [98.53654475]
mat_Sqrt:  [[0.15]]
grads:  [-0.05207375]
Stock Position:  -0.05207374834674672
Bond Position:  [6.37324388]


portfolio before change:  [1.23066326]
curr_Stock_Price:  98.77102180506907
curr_Factors:  [98.77102181]
mat_Sqrt:  [[0.15]]
grads:  [0.06329086]
Stock Position:  0.06329086419228683
Bond Position:  [-5.02064007]


portfolio before change:  [1.24191558]
curr_Stock_Price:  98.95872579090756
curr_Factors:  [98.95872579]
mat_Sqrt:  [[0.15]]
grads:  [0.03988285]
Stock Position:  0.03988284826018967
Bond Position:  [-2.70484026]


portfolio before change:  [1.24201082]
curr_Stock_Price:  98.9695916831825
curr_Factors:  [98.96959168]
mat_Sqrt:  [[0.15]]
grads:  [0.1113528]
Stock Position:  0.11135279558052612
Bond Position:  [-9.77852989]


portfolio before change:  [1.20962014]
curr_Stock_Price:  98.68968593316127
curr_Factors:  [98.68968593]
mat_Sqrt:  [[0.15]]
grads:  [0.03295533]
Stock Position:  0.03295532540852171
Bond Position:  [-2.04273057]


portfolio before change:  [1.2035146]
curr_Stock_Price:  98.51216747062186
curr_Factors:  [98.51216747]
mat_Sqrt:  [[0.15]]
grads:  [0.09026573]
Stock Position:  0.09026572930007655
Bond Position:  [-7.68875804]


portfolio before change:  [1.28257648]
curr_Stock_Price:  99.39869471765687
curr_Factors:  [99.39869472]
mat_Sqrt:  [[0.15]]
grads:  [-0.07223984]
Stock Position:  -0.07223984463070451
Bond Position:  [8.46312274]


portfolio before change:  [1.24295518]
curr_Stock_Price:  99.96180852700783
curr_Factors:  [99.96180853]
mat_Sqrt:  [[0.15]]
grads:  [0.03365836]
Stock Position:  0.03365836089644037
Bond Position:  [-2.12159545]


portfolio before change:  [1.20453369]
curr_Stock_Price:  98.82817423427962
curr_Factors:  [98.82817423]
mat_Sqrt:  [[0.15]]
grads:  [-0.07253264]
Stock Position:  -0.07253264143111356
Bond Position:  [8.37280222]


portfolio before change:  [1.20847238]
curr_Stock_Price:  98.78830220844537
curr_Factors:  [98.78830221]
mat_Sqrt:  [[0.15]]
grads:  [-0.12327471]
Stock Position:  -0.12327471231630574
Bond Position:  [13.38657192]


portfolio before change:  [1.31346682]
curr_Stock_Price:  97.95016593229082
curr_Factors:  [97.95016593]
mat_Sqrt:  [[0.15]]
grads:  [-0.00882311]
Stock Position:  -0.008823105365902051
Bond Position:  [2.17769145]


portfolio before change:  [1.31734217]
curr_Stock_Price:  97.54179141539582
curr_Factors:  [97.54179142]
mat_Sqrt:  [[0.15]]
grads:  [-0.02613797]
Stock Position:  -0.026137969561098637
Bond Position:  [3.86688655]


portfolio before change:  [1.31038045]
curr_Stock_Price:  97.82663045850032
curr_Factors:  [97.82663046]
mat_Sqrt:  [[0.15]]
grads:  [0.03746322]
Stock Position:  0.03746322197245968
Bond Position:  [-2.35452032]


portfolio before change:  [1.37638899]
curr_Stock_Price:  99.59644286086345
curr_Factors:  [99.59644286]
mat_Sqrt:  [[0.15]]
grads:  [0.03875883]
Stock Position:  0.03875883249823667
Bond Position:  [-2.48385285]


portfolio before change:  [1.41279059]
curr_Stock_Price:  100.54363606218587
curr_Factors:  [100.54363606]
mat_Sqrt:  [[0.15]]
grads:  [-0.07211581]
Stock Position:  -0.07211581339764028
Bond Position:  [8.66357669]


portfolio before change:  [1.50571711]
curr_Stock_Price:  99.27008041843028
curr_Factors:  [99.27008042]
mat_Sqrt:  [[0.15]]
grads:  [0.08580795]
Stock Position:  0.0858079466567007
Bond Position:  [-7.01244465]


portfolio before change:  [1.49597639]
curr_Stock_Price:  99.1667786927565
curr_Factors:  [99.16677869]
mat_Sqrt:  [[0.15]]
grads:  [0.03811042]
Stock Position:  0.03811041660851565
Bond Position:  [-2.28331086]


portfolio before change:  [1.49116531]
curr_Stock_Price:  99.0480277053624
curr_Factors:  [99.04802771]
mat_Sqrt:  [[0.15]]
grads:  [0.02047465]
Stock Position:  0.020474645165415157
Bond Position:  [-0.53680791]


portfolio before change:  [1.483586]
curr_Stock_Price:  98.68112479288303
curr_Factors:  [98.68112479]
mat_Sqrt:  [[0.15]]
grads:  [0.06852492]
Stock Position:  0.06852491898734925
Bond Position:  [-5.27853008]


portfolio before change:  [1.44222706]
curr_Stock_Price:  98.08719373034019
curr_Factors:  [98.08719373]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.44222706]
Stock Price:  97.76874742220437
PL:  [1.44222706]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.75143408e-03]
 [-1.13653006e-02]
 [-2.86938059e-03]
 [-2.27171671e-03]
 [ 1.19497682e-02]
 [ 2.05585199e-02]
 [-4.39118241e-03]
 [ 1.25611000e-02]
 [-6.22129065e-03]
 [ 2.44243497e-03]
 [ 8.07596726e-03]
 [ 4.28132222e-03]
 [ 1.38263306e-02]
 [ 3.99340532e-03]
 [ 7.02764259e-03]
 [-3.18457596e-03]
 [ 1.42784346e-02]
 [-8.66268217e-03]
 [ 7.42221488e-03]
 [-3.90722345e-03]
 [ 1.72983128e-02]
 [ 6.65016513e-03]
 [ 1.97095951e-03]
 [ 6.12873488e-03]
 [-6.83690345e-03]
 [-8.39513638e-03]
 [-1.09405967e-03]
 [-1.12594209e-02]
 [ 6.18995345e-03]
 [-7.75025843e-03]
 [-3.52423738e-03]
 [ 5.60391824e-03]
 [ 6.93716395e-03]
 [-1.24195126e-02]
 [ 3.95740537e-03]
 [ 5.71168255e-03]
 [ 3.05359174e-03]
 [ 7.84147217e-03]
 [-9.10130374e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.03908089]
curr_Stock_Price:  99.48448674999258
curr_Factors:  [99.48448675]
mat_Sqrt:  [[0.15]]
grads:  [0.03167623]
Stock Position:  0.03167622719882798
Bond Position:  [-9.19037409]


portfolio before change:  [-6.06570998]
curr_Stock_Price:  98.68009105580931
curr_Factors:  [98.68009106]
mat_Sqrt:  [[0.15]]
grads:  [-0.07576867]
Stock Position:  -0.07576867044941829
Bond Position:  [1.41114932]


portfolio before change:  [-6.10649453]
curr_Stock_Price:  99.22069654486272
curr_Factors:  [99.22069654]
mat_Sqrt:  [[0.15]]
grads:  [-0.0191292]
Stock Position:  -0.019129203936793366
Bond Position:  [-4.20848159]


portfolio before change:  [-6.11277179]
curr_Stock_Price:  99.5213452265981
curr_Factors:  [99.52134523]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514478]
Stock Position:  -0.015144778065241591
Bond Position:  [-4.60554311]


portfolio before change:  [-6.11484997]
curr_Stock_Price:  99.62055091181092
curr_Factors:  [99.62055091]
mat_Sqrt:  [[0.15]]
grads:  [0.07966512]
Stock Position:  0.07966512149324659
Bond Position:  [-14.05113326]


portfolio before change:  [-6.06366734]
curr_Stock_Price:  100.2850717384311
curr_Factors:  [100.28507174]
mat_Sqrt:  [[0.15]]
grads:  [0.1370568]
Stock Position:  0.1370567994238866
Bond Position:  [-19.8084183]


portfolio before change:  [-6.10741389]
curr_Stock_Price:  99.98395322119681
curr_Factors:  [99.98395322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02927455]
Stock Position:  -0.029274549407634343
Bond Position:  [-3.18042871]


portfolio before change:  [-6.15015026]
curr_Stock_Price:  101.43021953351223
curr_Factors:  [101.43021953]
mat_Sqrt:  [[0.15]]
grads:  [0.08374067]
Stock Position:  0.08374066682163545
Bond Position:  [-14.64398448]


portfolio before change:  [-6.21733761]
curr_Stock_Price:  100.64975358445132
curr_Factors:  [100.64975358]
mat_Sqrt:  [[0.15]]
grads:  [-0.04147527]
Stock Position:  -0.04147527098700304
Bond Position:  [-2.04286181]


portfolio before change:  [-6.19048841]
curr_Stock_Price:  99.99624176089803
curr_Factors:  [99.99624176]
mat_Sqrt:  [[0.15]]
grads:  [0.0162829]
Stock Position:  0.01628289980800306
Bond Position:  [-7.81871719]


portfolio before change:  [-6.18830648]
curr_Stock_Price:  100.19026909076385
curr_Factors:  [100.19026909]
mat_Sqrt:  [[0.15]]
grads:  [0.05383978]
Stock Position:  0.053839781762260466
Bond Position:  [-11.5825287]


portfolio before change:  [-6.20604159]
curr_Stock_Price:  99.88775672489156
curr_Factors:  [99.88775672]
mat_Sqrt:  [[0.15]]
grads:  [0.02854215]
Stock Position:  0.02854214811482434
Bond Position:  [-9.05705273]


portfolio before change:  [-6.2365376]
curr_Stock_Price:  98.85896913108819
curr_Factors:  [98.85896913]
mat_Sqrt:  [[0.15]]
grads:  [0.09217554]
Stock Position:  0.09217553759433479
Bond Position:  [-15.34891622]


portfolio before change:  [-6.2222964]
curr_Stock_Price:  99.03428600460889
curr_Factors:  [99.034286]
mat_Sqrt:  [[0.15]]
grads:  [0.0266227]
Stock Position:  0.026622702161829877
Bond Position:  [-8.8588567]


portfolio before change:  [-6.23305592]
curr_Stock_Price:  98.67173501378491
curr_Factors:  [98.67173501]
mat_Sqrt:  [[0.15]]
grads:  [0.04685095]
Stock Position:  0.04685095060383041
Bond Position:  [-10.8559205]


portfolio before change:  [-6.21399794]
curr_Stock_Price:  99.10747970070659
curr_Factors:  [99.1074797]
mat_Sqrt:  [[0.15]]
grads:  [-0.02123051]
Stock Position:  -0.021230506373999404
Bond Position:  [-4.10989596]


portfolio before change:  [-6.19330577]
curr_Stock_Price:  98.10863707990329
curr_Factors:  [98.10863708]
mat_Sqrt:  [[0.15]]
grads:  [0.09518956]
Stock Position:  0.0951895641772077
Bond Position:  [-15.53222418]


portfolio before change:  [-6.20387189]
curr_Stock_Price:  98.01803405503212
curr_Factors:  [98.01803406]
mat_Sqrt:  [[0.15]]
grads:  [-0.05775121]
Stock Position:  -0.05775121448579855
Bond Position:  [-0.54321138]


portfolio before change:  [-6.2223626]
curr_Stock_Price:  98.33703707347756
curr_Factors:  [98.33703707]
mat_Sqrt:  [[0.15]]
grads:  [0.04948143]
Stock Position:  0.04948143254794509
Bond Position:  [-11.08822007]


portfolio before change:  [-6.26322426]
curr_Stock_Price:  97.53925206271587
curr_Factors:  [97.53925206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02604816]
Stock Position:  -0.02604815634040718
Bond Position:  [-3.72250658]


portfolio before change:  [-6.27115307]
curr_Stock_Price:  97.82577761827342
curr_Factors:  [97.82577762]
mat_Sqrt:  [[0.15]]
grads:  [0.11532209]
Stock Position:  0.11532208503394997
Bond Position:  [-17.55262571]


portfolio before change:  [-6.13324078]
curr_Stock_Price:  99.04069233832783
curr_Factors:  [99.04069234]
mat_Sqrt:  [[0.15]]
grads:  [0.04433443]
Stock Position:  0.04433443417918552
Bond Position:  [-10.52415384]


portfolio before change:  [-6.08041282]
curr_Stock_Price:  100.26194546815664
curr_Factors:  [100.26194547]
mat_Sqrt:  [[0.15]]
grads:  [0.01313973]
Stock Position:  0.013139730093231229
Bond Position:  [-7.39782772]


portfolio before change:  [-6.06932086]
curr_Stock_Price:  101.17648048565869
curr_Factors:  [101.17648049]
mat_Sqrt:  [[0.15]]
grads:  [0.04085823]
Stock Position:  0.04085823255155431
Bond Position:  [-10.20321303]


portfolio before change:  [-6.08984147]
curr_Stock_Price:  100.70545840568076
curr_Factors:  [100.70545841]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557936]
Stock Position:  -0.04557935635459765
Bond Position:  [-1.4997515]


portfolio before change:  [-6.08234501]
curr_Stock_Price:  100.53687455199538
curr_Factors:  [100.53687455]
mat_Sqrt:  [[0.15]]
grads:  [-0.05596758]
Stock Position:  -0.05596757586611559
Bond Position:  [-0.45553986]


portfolio before change:  [-6.16221013]
curr_Stock_Price:  101.96284617479382
curr_Factors:  [101.96284617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729373]
Stock Position:  -0.007293731143486322
Bond Position:  [-5.41852054]


portfolio before change:  [-6.15828671]
curr_Stock_Price:  101.33206101634094
curr_Factors:  [101.33206102]
mat_Sqrt:  [[0.15]]
grads:  [-0.07506281]
Stock Position:  -0.0750628063331856
Bond Position:  [1.44798216]


portfolio before change:  [-6.19228229]
curr_Stock_Price:  101.78736759563837
curr_Factors:  [101.7873676]
mat_Sqrt:  [[0.15]]
grads:  [0.04126636]
Stock Position:  0.04126635632400715
Bond Position:  [-10.39267607]


portfolio before change:  [-6.24759377]
curr_Stock_Price:  100.47849726745957
curr_Factors:  [100.47849727]
mat_Sqrt:  [[0.15]]
grads:  [-0.05166839]
Stock Position:  -0.051668389538608424
Bond Position:  [-1.05603163]


portfolio before change:  [-6.16283394]
curr_Stock_Price:  98.83548425123637
curr_Factors:  [98.83548425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349492]
Stock Position:  -0.023494915859387056
Bond Position:  [-3.84070256]


portfolio before change:  [-6.17102704]
curr_Stock_Price:  99.16376731966905
curr_Factors:  [99.16376732]
mat_Sqrt:  [[0.15]]
grads:  [0.03735945]
Stock Position:  0.03735945495984361
Bond Position:  [-9.87573134]


portfolio before change:  [-6.18994794]
curr_Stock_Price:  98.6903570583141
curr_Factors:  [98.69035706]
mat_Sqrt:  [[0.15]]
grads:  [0.04624776]
Stock Position:  0.04624775965470067
Bond Position:  [-10.75415585]


portfolio before change:  [-6.19851306]
curr_Stock_Price:  98.53422464245521
curr_Factors:  [98.53422464]
mat_Sqrt:  [[0.15]]
grads:  [-0.08279675]
Stock Position:  -0.08279675073817144
Bond Position:  [1.95980057]


portfolio before change:  [-6.15282938]
curr_Stock_Price:  97.98542661704714
curr_Factors:  [97.98542662]
mat_Sqrt:  [[0.15]]
grads:  [0.0263827]
Stock Position:  0.026382702486692586
Bond Position:  [-8.73794974]


portfolio before change:  [-6.15816613]
curr_Stock_Price:  97.82454705594594
curr_Factors:  [97.82454706]
mat_Sqrt:  [[0.15]]
grads:  [0.03807788]
Stock Position:  0.03807788366414061
Bond Position:  [-9.88311785]


portfolio before change:  [-6.11188689]
curr_Stock_Price:  99.0723766844445
curr_Factors:  [99.07237668]
mat_Sqrt:  [[0.15]]
grads:  [0.02035728]
Stock Position:  0.020357278241996995
Bond Position:  [-8.12873082]


portfolio before change:  [-6.07352439]
curr_Stock_Price:  101.00675378055415
curr_Factors:  [101.00675378]
mat_Sqrt:  [[0.15]]
grads:  [0.05227648]
Stock Position:  0.05227648110412181
Bond Position:  [-11.35380204]


portfolio before change:  [-6.09555284]
curr_Stock_Price:  100.61252022087157
curr_Factors:  [100.61252022]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.09555284]
Stock Price:  100.22537628216001
PL:  [-6.32092913]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.03980404e-03]
 [ 2.30935000e-03]
 [ 5.21037529e-03]
 [-2.85009074e-03]
 [ 1.53582963e-02]
 [ 2.64101130e-02]
 [-4.15705192e-04]
 [ 9.25036842e-03]
 [-1.03436398e-02]
 [-3.03030160e-03]
 [ 2.58058457e-02]
 [ 9.73418081e-03]
 [-3.24164828e-03]
 [-4.02751326e-03]
 [ 5.69336561e-03]
 [ 3.72973145e-03]
 [ 9.09476644e-03]
 [ 1.16876604e-02]
 [ 1.15649556e-02]
 [-1.47267401e-02]
 [-1.15630448e-02]
 [ 2.21100096e-02]
 [-9.39703618e-03]
 [ 6.23874794e-03]
 [-8.61175469e-03]
 [-9.01414504e-03]
 [ 8.37506456e-03]
 [-1.10498344e-02]
 [-1.83712073e-02]
 [-1.29626219e-03]
 [-3.96995273e-03]
 [ 5.59591477e-03]
 [ 1.42464266e-02]
 [-1.28435246e-02]
 [ 2.87251571e-03]
 [ 5.56969482e-03]
 [ 3.40449920e-03]
 [ 1.07623428e-02]
 [-5.48861018e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.80128193]
curr_Stock_Price:  99.43531764160896
curr_Factors:  [99.43531764]
mat_Sqrt:  [[0.15]]
grads:  [0.03359869]
Stock Position:  0.033598693630803735
Bond Position:  [-10.1421787]


portfolio before change:  [-6.79197013]
curr_Stock_Price:  99.75020033609252
curr_Factors:  [99.75020034]
mat_Sqrt:  [[0.15]]
grads:  [0.01539567]
Stock Position:  0.015395666694393607
Bond Position:  [-8.32769097]


portfolio before change:  [-6.79500929]
curr_Stock_Price:  99.62041534656242
curr_Factors:  [99.62041535]
mat_Sqrt:  [[0.15]]
grads:  [0.03473584]
Stock Position:  0.034735835241154346
Bond Position:  [-10.25540762]


portfolio before change:  [-6.77516803]
curr_Stock_Price:  100.22852694472397
curr_Factors:  [100.22852694]
mat_Sqrt:  [[0.15]]
grads:  [-0.0190006]
Stock Position:  -0.019000604916806677
Bond Position:  [-4.87076539]


portfolio before change:  [-6.78381071]
curr_Stock_Price:  100.65134492450451
curr_Factors:  [100.65134492]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-17.08936524]


portfolio before change:  [-6.72356517]
curr_Stock_Price:  101.26061022798862
curr_Factors:  [101.26061023]
mat_Sqrt:  [[0.15]]
grads:  [0.17606742]
Stock Position:  0.17606741982779445
Bond Position:  [-24.55225954]


portfolio before change:  [-6.69533179]
curr_Stock_Price:  101.43839779661415
curr_Factors:  [101.4383978]
mat_Sqrt:  [[0.15]]
grads:  [-0.00277137]
Stock Position:  -0.0027713679498853235
Bond Position:  [-6.41420867]


portfolio before change:  [-6.697986]
curr_Stock_Price:  102.10679802320159
curr_Factors:  [102.10679802]
mat_Sqrt:  [[0.15]]
grads:  [0.06166912]
Stock Position:  0.06166912277797606
Bond Position:  [-12.99482267]


portfolio before change:  [-6.6365292]
curr_Stock_Price:  103.1296966354692
curr_Factors:  [103.12969664]
mat_Sqrt:  [[0.15]]
grads:  [-0.0689576]
Stock Position:  -0.06895759839660674
Bond Position:  [0.47504701]


portfolio before change:  [-6.626695]
curr_Stock_Price:  102.98794554223404
curr_Factors:  [102.98794554]
mat_Sqrt:  [[0.15]]
grads:  [-0.02020201]
Stock Position:  -0.020202010664138945
Bond Position:  [-4.54613142]


portfolio before change:  [-6.66002315]
curr_Stock_Price:  104.60955910421204
curr_Factors:  [104.6095591]
mat_Sqrt:  [[0.15]]
grads:  [0.17203897]
Stock Position:  0.17203897100667073
Bond Position:  [-24.65694406]


portfolio before change:  [-6.57077677]
curr_Stock_Price:  105.14623223972809
curr_Factors:  [105.14623224]
mat_Sqrt:  [[0.15]]
grads:  [0.06489454]
Stock Position:  0.06489453872762221
Bond Position:  [-13.39419301]


portfolio before change:  [-6.52744569]
curr_Stock_Price:  105.83974921109508
curr_Factors:  [105.83974921]
mat_Sqrt:  [[0.15]]
grads:  [-0.02161099]
Stock Position:  -0.02161098852510368
Bond Position:  [-4.24014408]


portfolio before change:  [-6.48331262]
curr_Stock_Price:  103.77306385479666
curr_Factors:  [103.77306385]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685009]
Stock Position:  -0.02685008838150133
Bond Position:  [-3.69699669]


portfolio before change:  [-6.47891377]
curr_Stock_Price:  103.59202121450458
curr_Factors:  [103.59202121]
mat_Sqrt:  [[0.15]]
grads:  [0.03795577]
Stock Position:  0.03795577075136516
Bond Position:  [-10.41082877]


portfolio before change:  [-6.45299634]
curr_Stock_Price:  104.30914164675404
curr_Factors:  [104.30914165]
mat_Sqrt:  [[0.15]]
grads:  [0.02486488]
Stock Position:  0.024864876353624107
Bond Position:  [-9.04663025]


portfolio before change:  [-6.48061362]
curr_Stock_Price:  103.24392887035242
curr_Factors:  [103.24392887]
mat_Sqrt:  [[0.15]]
grads:  [0.06063178]
Stock Position:  0.060631776267913995
Bond Position:  [-12.74047642]


portfolio before change:  [-6.54596793]
curr_Stock_Price:  102.1923078886274
curr_Factors:  [102.19230789]
mat_Sqrt:  [[0.15]]
grads:  [0.07791774]
Stock Position:  0.0779177359732682
Bond Position:  [-14.5085612]


portfolio before change:  [-6.51300296]
curr_Stock_Price:  102.63865886740106
curr_Factors:  [102.63865887]
mat_Sqrt:  [[0.15]]
grads:  [0.0770997]
Stock Position:  0.07709970400466724
Bond Position:  [-14.42641318]


portfolio before change:  [-6.51500366]
curr_Stock_Price:  102.6361000254502
curr_Factors:  [102.63610003]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817827]
Stock Position:  -0.09817826750154665
Bond Position:  [3.56163083]


portfolio before change:  [-6.42248083]
curr_Stock_Price:  101.69823869405225
curr_Factors:  [101.69823869]
mat_Sqrt:  [[0.15]]
grads:  [-0.07708697]
Stock Position:  -0.077086965228981
Bond Position:  [1.41712776]


portfolio before change:  [-6.43267573]
curr_Stock_Price:  101.83278879274172
curr_Factors:  [101.83278879]
mat_Sqrt:  [[0.15]]
grads:  [0.14740006]
Stock Position:  0.14740006413493348
Bond Position:  [-21.44283533]


portfolio before change:  [-6.60110734]
curr_Stock_Price:  100.70829070389657
curr_Factors:  [100.7082907]
mat_Sqrt:  [[0.15]]
grads:  [-0.06264691]
Stock Position:  -0.0626469078842083
Bond Position:  [-0.29204433]


portfolio before change:  [-6.60873178]
curr_Stock_Price:  100.82941290363395
curr_Factors:  [100.8294129]
mat_Sqrt:  [[0.15]]
grads:  [0.04159165]
Stock Position:  0.041591652940921674
Bond Position:  [-10.80239373]


portfolio before change:  [-6.59717047]
curr_Stock_Price:  101.13985243827334
curr_Factors:  [101.13985244]
mat_Sqrt:  [[0.15]]
grads:  [-0.0574117]
Stock Position:  -0.05741169792171967
Bond Position:  [-0.79055982]


portfolio before change:  [-6.54484473]
curr_Stock_Price:  100.22671851076393
curr_Factors:  [100.22671851]
mat_Sqrt:  [[0.15]]
grads:  [-0.0600943]
Stock Position:  -0.06009430023956782
Bond Position:  [-0.52179022]


portfolio before change:  [-6.50723953]
curr_Stock_Price:  99.59986328638915
curr_Factors:  [99.59986329]
mat_Sqrt:  [[0.15]]
grads:  [0.05583376]
Stock Position:  0.05583376372331812
Bond Position:  [-12.06827477]


portfolio before change:  [-6.5079947]
curr_Stock_Price:  99.61335802886775
curr_Factors:  [99.61335803]
mat_Sqrt:  [[0.15]]
grads:  [-0.07366556]
Stock Position:  -0.07366556258750322
Bond Position:  [0.83007936]


portfolio before change:  [-6.47665728]
curr_Stock_Price:  99.18936537670581
curr_Factors:  [99.18936538]
mat_Sqrt:  [[0.15]]
grads:  [-0.12247472]
Stock Position:  -0.12247471505649438
Bond Position:  [5.67153199]


portfolio before change:  [-6.32107601]
curr_Stock_Price:  97.9248408809316
curr_Factors:  [97.92484088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00864175]
Stock Position:  -0.008641747954779786
Bond Position:  [-5.47483422]


portfolio before change:  [-6.31649042]
curr_Stock_Price:  97.31501225292973
curr_Factors:  [97.31501225]
mat_Sqrt:  [[0.15]]
grads:  [-0.02646635]
Stock Position:  -0.026466351558586395
Bond Position:  [-3.7409171]


portfolio before change:  [-6.3037585]
curr_Stock_Price:  96.81628214855313
curr_Factors:  [96.81628215]
mat_Sqrt:  [[0.15]]
grads:  [0.0373061]
Stock Position:  0.03730609844413984
Bond Position:  [-9.91559625]


portfolio before change:  [-6.3602511]
curr_Stock_Price:  95.33520884800222
curr_Factors:  [95.33520885]
mat_Sqrt:  [[0.15]]
grads:  [0.09497618]
Stock Position:  0.09497617750556935
Bond Position:  [-15.41482481]


portfolio before change:  [-6.28494568]
curr_Stock_Price:  96.14838532419337
curr_Factors:  [96.14838532]
mat_Sqrt:  [[0.15]]
grads:  [-0.0856235]
Stock Position:  -0.08562349766595637
Bond Position:  [1.94761537]


portfolio before change:  [-6.27867155]
curr_Stock_Price:  96.07795299871617
curr_Factors:  [96.077953]
mat_Sqrt:  [[0.15]]
grads:  [0.0191501]
Stock Position:  0.01915010474202531
Bond Position:  [-8.11857441]


portfolio before change:  [-6.29143327]
curr_Stock_Price:  95.46454435947052
curr_Factors:  [95.46454436]
mat_Sqrt:  [[0.15]]
grads:  [0.0371313]
Stock Position:  0.03713129879532209
Bond Position:  [-9.83615579]


portfolio before change:  [-6.27045722]
curr_Stock_Price:  96.06257488324674
curr_Factors:  [96.06257488]
mat_Sqrt:  [[0.15]]
grads:  [0.02269666]
Stock Position:  0.022696661313946136
Bond Position:  [-8.45075694]


portfolio before change:  [-6.27991971]
curr_Stock_Price:  95.69220861417317
curr_Factors:  [95.69220861]
mat_Sqrt:  [[0.15]]
grads:  [0.07174895]
Stock Position:  0.07174895196863118
Bond Position:  [-13.14573539]


portfolio before change:  [-6.340537]
curr_Stock_Price:  94.87025972747556
curr_Factors:  [94.87025973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.340537]
Stock Price:  94.11522414322985
PL:  [-6.340537]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.73951624e-03]
 [ 4.74505446e-03]
 [ 8.27279177e-03]
 [-1.58875026e-03]
 [ 1.54865207e-02]
 [ 6.44345881e-03]
 [-5.89419693e-03]
 [ 2.36162999e-02]
 [-6.00975731e-03]
 [ 4.84164399e-03]
 [ 8.97988532e-03]
 [ 4.06889332e-03]
 [ 1.19724419e-02]
 [ 2.76974444e-03]
 [ 1.56008683e-02]
 [-2.34285242e-03]
 [ 1.10519826e-02]
 [ 1.26457523e-04]
 [ 1.03351959e-02]
 [-1.04648469e-02]
 [ 1.39019868e-02]
 [-1.92599387e-03]
 [ 2.11031945e-02]
 [ 4.64840292e-03]
 [ 1.19220918e-02]
 [-1.10121411e-02]
 [ 9.52168213e-03]
 [-1.08588589e-02]
 [-1.80947405e-02]
 [-7.65839319e-03]
 [-8.06629526e-04]
 [ 5.10564355e-03]
 [ 5.11553863e-03]
 [-8.79127479e-03]
 [ 1.33388068e-02]
 [ 5.26159407e-03]
 [-1.56796341e-03]
 [ 8.74862687e-03]
 [-1.59064364e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.66683766]
curr_Stock_Price:  100.17511880137342
curr_Factors:  [100.1751188]
mat_Sqrt:  [[0.15]]
grads:  [0.03826344]
Stock Position:  0.0382634416329196
Bond Position:  [0.83379285]


portfolio before change:  [4.66712815]
curr_Stock_Price:  100.17998666113058
curr_Factors:  [100.17998666]
mat_Sqrt:  [[0.15]]
grads:  [0.0316337]
Stock Position:  0.03163369643168608
Bond Position:  [1.49806486]


portfolio before change:  [4.66833199]
curr_Stock_Price:  100.21212240940042
curr_Factors:  [100.21212241]
mat_Sqrt:  [[0.15]]
grads:  [0.05515195]
Stock Position:  0.055151945155561544
Bond Position:  [-0.85856149]


portfolio before change:  [4.70148921]
curr_Stock_Price:  100.81526599484825
curr_Factors:  [100.81526599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059167]
Stock Position:  -0.010591668408261354
Bond Position:  [5.76929107]


portfolio before change:  [4.70756441]
curr_Stock_Price:  100.3097745298421
curr_Factors:  [100.30977453]
mat_Sqrt:  [[0.15]]
grads:  [0.10324347]
Stock Position:  0.10324347135306092
Bond Position:  [-5.64876492]


portfolio before change:  [4.63395843]
curr_Stock_Price:  99.60367816042577
curr_Factors:  [99.60367816]
mat_Sqrt:  [[0.15]]
grads:  [0.04295639]
Stock Position:  0.04295639208192725
Bond Position:  [0.35534378]


portfolio before change:  [4.63674844]
curr_Stock_Price:  99.66759378887517
curr_Factors:  [99.66759379]
mat_Sqrt:  [[0.15]]
grads:  [-0.03929465]
Stock Position:  -0.03929464620315827
Bond Position:  [8.55315127]


portfolio before change:  [4.65210173]
curr_Stock_Price:  99.30408157910635
curr_Factors:  [99.30408158]
mat_Sqrt:  [[0.15]]
grads:  [0.157442]
Stock Position:  0.1574419991849628
Bond Position:  [-10.9825314]


portfolio before change:  [4.48015437]
curr_Stock_Price:  98.22067018589745
curr_Factors:  [98.22067019]
mat_Sqrt:  [[0.15]]
grads:  [-0.04006505]
Stock Position:  -0.040065048702397174
Bond Position:  [8.41537031]


portfolio before change:  [4.43964875]
curr_Stock_Price:  99.25792368919723
curr_Factors:  [99.25792369]
mat_Sqrt:  [[0.15]]
grads:  [0.03227763]
Stock Position:  0.03227762659022416
Bond Position:  [1.23583855]


portfolio before change:  [4.47351391]
curr_Stock_Price:  100.30232131245528
curr_Factors:  [100.30232131]
mat_Sqrt:  [[0.15]]
grads:  [0.0598659]
Stock Position:  0.059865902115818555
Bond Position:  [-1.53117504]


portfolio before change:  [4.46466472]
curr_Stock_Price:  100.15770171289648
curr_Factors:  [100.15770171]
mat_Sqrt:  [[0.15]]
grads:  [0.02712596]
Stock Position:  0.02712595549837462
Bond Position:  [1.74779136]


portfolio before change:  [4.45490856]
curr_Stock_Price:  99.78998568252297
curr_Factors:  [99.78998568]
mat_Sqrt:  [[0.15]]
grads:  [0.07981628]
Stock Position:  0.07981627935900072
Bond Position:  [-3.50995681]


portfolio before change:  [4.50655932]
curr_Stock_Price:  100.44260350270126
curr_Factors:  [100.4426035]
mat_Sqrt:  [[0.15]]
grads:  [0.01846496]
Stock Position:  0.01846496290498449
Bond Position:  [2.65189037]


portfolio before change:  [4.494672]
curr_Stock_Price:  99.78087321480331
curr_Factors:  [99.78087321]
mat_Sqrt:  [[0.15]]
grads:  [0.10400579]
Stock Position:  0.10400578835352443
Bond Position:  [-5.88311638]


portfolio before change:  [4.47573605]
curr_Stock_Price:  99.60587805069609
curr_Factors:  [99.60587805]
mat_Sqrt:  [[0.15]]
grads:  [-0.01561902]
Stock Position:  -0.015619016166422892
Bond Position:  [6.03148187]


portfolio before change:  [4.48058888]
curr_Stock_Price:  99.34345138423434
curr_Factors:  [99.34345138]
mat_Sqrt:  [[0.15]]
grads:  [0.07367988]
Stock Position:  0.07367988368014715
Bond Position:  [-2.83902506]


portfolio before change:  [4.47053501]
curr_Stock_Price:  99.2118148073724
curr_Factors:  [99.21181481]
mat_Sqrt:  [[0.15]]
grads:  [0.00084305]
Stock Position:  0.0008430501537227963
Bond Position:  [4.38689448]


portfolio before change:  [4.47105895]
curr_Stock_Price:  99.18279783748277
curr_Factors:  [99.18279784]
mat_Sqrt:  [[0.15]]
grads:  [0.06890131]
Stock Position:  0.06890130602152283
Bond Position:  [-2.36276536]


portfolio before change:  [4.45939132]
curr_Stock_Price:  99.01774633469523
curr_Factors:  [99.01774633]
mat_Sqrt:  [[0.15]]
grads:  [-0.06976565]
Stock Position:  -0.06976564576333433
Bond Position:  [11.36742833]


portfolio before change:  [4.51289646]
curr_Stock_Price:  98.27118801672387
curr_Factors:  [98.27118802]
mat_Sqrt:  [[0.15]]
grads:  [0.09267991]
Stock Position:  0.09267991188768898
Bond Position:  [-4.59486859]


portfolio before change:  [4.41894178]
curr_Stock_Price:  97.26363109701653
curr_Factors:  [97.2636311]
mat_Sqrt:  [[0.15]]
grads:  [-0.01283996]
Stock Position:  -0.012839959159868197
Bond Position:  [5.66780283]


portfolio before change:  [4.41525634]
curr_Stock_Price:  97.60584093275308
curr_Factors:  [97.60584093]
mat_Sqrt:  [[0.15]]
grads:  [0.14068796]
Stock Position:  0.1406879630257832
Bond Position:  [-9.3167106]


portfolio before change:  [4.44913447]
curr_Stock_Price:  97.854922587867
curr_Factors:  [97.85492259]
mat_Sqrt:  [[0.15]]
grads:  [0.03098935]
Stock Position:  0.03098935282249359
Bond Position:  [1.41667374]


portfolio before change:  [4.47716443]
curr_Stock_Price:  98.75371105967162
curr_Factors:  [98.75371106]
mat_Sqrt:  [[0.15]]
grads:  [0.07948061]
Stock Position:  0.07948061230147498
Bond Position:  [-3.37184099]


portfolio before change:  [4.51522521]
curr_Stock_Price:  99.23788299957863
curr_Factors:  [99.237883]
mat_Sqrt:  [[0.15]]
grads:  [-0.07341427]
Stock Position:  -0.07341427396536973
Bond Position:  [11.80070234]


portfolio before change:  [4.49978934]
curr_Stock_Price:  99.46823397182442
curr_Factors:  [99.46823397]
mat_Sqrt:  [[0.15]]
grads:  [0.06347788]
Stock Position:  0.06347788086975599
Bond Position:  [-1.81424337]


portfolio before change:  [4.47296194]
curr_Stock_Price:  99.04918085641637
curr_Factors:  [99.04918086]
mat_Sqrt:  [[0.15]]
grads:  [-0.07239239]
Stock Position:  -0.07239239274819134
Bond Position:  [11.64336914]


portfolio before change:  [4.4447796]
curr_Stock_Price:  99.45858655273801
curr_Factors:  [99.45858655]
mat_Sqrt:  [[0.15]]
grads:  [-0.1206316]
Stock Position:  -0.12063160342040122
Bond Position:  [16.44262837]


portfolio before change:  [4.32666822]
curr_Stock_Price:  100.45473377662826
curr_Factors:  [100.45473378]
mat_Sqrt:  [[0.15]]
grads:  [-0.05105595]
Stock Position:  -0.051055954585809846
Bond Position:  [9.45548054]


portfolio before change:  [4.27737282]
curr_Stock_Price:  101.44340208118858
curr_Factors:  [101.44340208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00537753]
Stock Position:  -0.005377530172672245
Bond Position:  [4.82288778]


portfolio before change:  [4.2739713]
curr_Stock_Price:  102.18806048566022
curr_Factors:  [102.18806049]
mat_Sqrt:  [[0.15]]
grads:  [0.03403762]
Stock Position:  0.03403762366123135
Bond Position:  [0.79573255]


portfolio before change:  [4.24000921]
curr_Stock_Price:  101.18735731643136
curr_Factors:  [101.18735732]
mat_Sqrt:  [[0.15]]
grads:  [0.03410359]
Stock Position:  0.03410359089797555
Bond Position:  [0.78915697]


portfolio before change:  [4.24056929]
curr_Stock_Price:  101.2008874239886
curr_Factors:  [101.20088742]
mat_Sqrt:  [[0.15]]
grads:  [-0.0586085]
Stock Position:  -0.05860849858859689
Bond Position:  [10.17180136]


portfolio before change:  [4.14973585]
curr_Stock_Price:  102.7724169751615
curr_Factors:  [102.77241698]
mat_Sqrt:  [[0.15]]
grads:  [0.08892538]
Stock Position:  0.08892537877687914
Bond Position:  [-4.98934025]


portfolio before change:  [4.17512588]
curr_Stock_Price:  103.06495135607258
curr_Factors:  [103.06495136]
mat_Sqrt:  [[0.15]]
grads:  [0.03507729]
Stock Position:  0.035077293774447224
Bond Position:  [0.5598863]


portfolio before change:  [4.144658]
curr_Stock_Price:  102.19436336128351
curr_Factors:  [102.19436336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01045309]
Stock Position:  -0.010453089390630513
Bond Position:  [5.21290481]


portfolio before change:  [4.14181859]
curr_Stock_Price:  102.5283377820708
curr_Factors:  [102.52833778]
mat_Sqrt:  [[0.15]]
grads:  [0.05832418]
Stock Position:  0.05832417911722681
Bond Position:  [-1.83806255]


portfolio before change:  [4.17167551]
curr_Stock_Price:  103.04419065380068
curr_Factors:  [103.04419065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.17167551]
Stock Price:  103.62350257666535
PL:  [0.54817293]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.42454518e-03]
 [-7.61373200e-03]
 [ 1.34014105e-02]
 [ 6.00602293e-03]
 [ 1.41748922e-02]
 [ 2.63065476e-02]
 [ 1.29021312e-03]
 [ 1.85982824e-02]
 [-5.90874134e-03]
 [ 2.96518803e-03]
 [ 1.06209622e-02]
 [ 4.04815542e-03]
 [ 1.07446358e-02]
 [-5.04026118e-03]
 [ 1.47086227e-02]
 [ 2.10710131e-03]
 [ 8.96454571e-03]
 [ 9.78560430e-03]
 [ 1.16493351e-02]
 [-1.62024148e-02]
 [ 7.44100776e-03]
 [ 3.89687993e-02]
 [ 1.16976720e-02]
 [ 7.06120261e-03]
 [ 7.82336024e-03]
 [-2.89286694e-02]
 [ 2.26581331e-03]
 [-1.60892628e-02]
 [ 7.41799573e-02]
 [-1.50285107e-03]
 [-1.53748059e-02]
 [ 4.25615191e-03]
 [ 6.92033999e-03]
 [ 8.14916369e-03]
 [ 8.24296911e-03]
 [ 1.29368644e-03]
 [-1.05755401e-01]
 [ 8.71755054e-03]
 [ 3.28376537e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.8828724]
curr_Stock_Price:  100.898658127015
curr_Factors:  [100.89865813]
mat_Sqrt:  [[0.15]]
grads:  [0.0428303]
Stock Position:  0.042830301202658384
Bond Position:  [11.56135248]


portfolio before change:  [15.94647425]
curr_Stock_Price:  102.34988750015286
curr_Factors:  [102.3498875]
mat_Sqrt:  [[0.15]]
grads:  [-0.05075821]
Stock Position:  -0.05075821336213899
Bond Position:  [21.14157168]


portfolio before change:  [15.93832744]
curr_Stock_Price:  102.56245761288656
curr_Factors:  [102.56245761]
mat_Sqrt:  [[0.15]]
grads:  [0.08934274]
Stock Position:  0.08934273688762503
Bond Position:  [6.77511677]


portfolio before change:  [15.86996914]
curr_Stock_Price:  101.78785364917482
curr_Factors:  [101.78785365]
mat_Sqrt:  [[0.15]]
grads:  [0.04004015]
Stock Position:  0.04004015286194388
Bond Position:  [11.79436792]


portfolio before change:  [15.85868165]
curr_Stock_Price:  101.46912671786514
curr_Factors:  [101.46912672]
mat_Sqrt:  [[0.15]]
grads:  [0.09449928]
Stock Position:  0.09449928102235083
Bond Position:  [6.26992213]


portfolio before change:  [15.82688196]
curr_Stock_Price:  101.12432529050754
curr_Factors:  [101.12432529]
mat_Sqrt:  [[0.15]]
grads:  [0.17537698]
Stock Position:  0.17537698412220087
Bond Position:  [-1.90799723]


portfolio before change:  [15.72277842]
curr_Stock_Price:  100.5320867024693
curr_Factors:  [100.5320867]
mat_Sqrt:  [[0.15]]
grads:  [0.00860142]
Stock Position:  0.0086014208136524
Bond Position:  [14.85805964]


portfolio before change:  [15.72498803]
curr_Stock_Price:  100.57303716097107
curr_Factors:  [100.57303716]
mat_Sqrt:  [[0.15]]
grads:  [0.12398855]
Stock Position:  0.12398854957073681
Bond Position:  [3.25508303]


portfolio before change:  [15.6200973]
curr_Stock_Price:  99.72378420167001
curr_Factors:  [99.7237842]
mat_Sqrt:  [[0.15]]
grads:  [-0.03939161]
Stock Position:  -0.03939160890205569
Bond Position:  [19.5483776]


portfolio before change:  [15.61510974]
curr_Stock_Price:  99.91243508631557
curr_Factors:  [99.91243509]
mat_Sqrt:  [[0.15]]
grads:  [0.01976792]
Stock Position:  0.019767920232775817
Bond Position:  [13.64004869]


portfolio before change:  [15.63193698]
curr_Stock_Price:  100.67741846652717
curr_Factors:  [100.67741847]
mat_Sqrt:  [[0.15]]
grads:  [0.07080641]
Stock Position:  0.07080641462932981
Bond Position:  [8.50332994]


portfolio before change:  [15.62365502]
curr_Stock_Price:  100.5454397327269
curr_Factors:  [100.54543973]
mat_Sqrt:  [[0.15]]
grads:  [0.0269877]
Stock Position:  0.02698770279195157
Bond Position:  [12.91016458]


portfolio before change:  [15.64778829]
curr_Stock_Price:  101.3798715185379
curr_Factors:  [101.37987152]
mat_Sqrt:  [[0.15]]
grads:  [0.07163091]
Stock Position:  0.07163090510879895
Bond Position:  [8.38585633]


portfolio before change:  [15.66506749]
curr_Stock_Price:  101.60646225399937
curr_Factors:  [101.60646225]
mat_Sqrt:  [[0.15]]
grads:  [-0.03360174]
Stock Position:  -0.033601741178160914
Bond Position:  [19.07922153]


portfolio before change:  [15.64742923]
curr_Stock_Price:  102.20236317122605
curr_Factors:  [102.20236317]
mat_Sqrt:  [[0.15]]
grads:  [0.09805748]
Stock Position:  0.0980574849216663
Bond Position:  [5.62572254]


portfolio before change:  [15.63079301]
curr_Stock_Price:  102.0255334510184
curr_Factors:  [102.02553345]
mat_Sqrt:  [[0.15]]
grads:  [0.01404734]
Stock Position:  0.014047342056261812
Bond Position:  [14.19760544]


portfolio before change:  [15.62621612]
curr_Stock_Price:  101.57336926615183
curr_Factors:  [101.57336927]
mat_Sqrt:  [[0.15]]
grads:  [0.05976364]
Stock Position:  0.05976363807834208
Bond Position:  [9.55582204]


portfolio before change:  [15.72181451]
curr_Stock_Price:  103.1529892427563
curr_Factors:  [103.15298924]
mat_Sqrt:  [[0.15]]
grads:  [0.06523736]
Stock Position:  0.06523736196965112
Bond Position:  [8.99238561]


portfolio before change:  [15.71142315]
curr_Stock_Price:  102.97647268861948
curr_Factors:  [102.97647269]
mat_Sqrt:  [[0.15]]
grads:  [0.07766223]
Stock Position:  0.07766223380582653
Bond Position:  [7.71404025]


portfolio before change:  [15.79447067]
curr_Stock_Price:  104.03339823713026
curr_Factors:  [104.03339824]
mat_Sqrt:  [[0.15]]
grads:  [-0.1080161]
Stock Position:  -0.10801609888745795
Bond Position:  [27.0317525]


portfolio before change:  [15.75791235]
curr_Stock_Price:  104.40313478351845
curr_Factors:  [104.40313478]
mat_Sqrt:  [[0.15]]
grads:  [0.04960672]
Stock Position:  0.04960671838540171
Bond Position:  [10.57881544]


portfolio before change:  [15.80426048]
curr_Stock_Price:  105.31078797747371
curr_Factors:  [105.31078798]
mat_Sqrt:  [[0.15]]
grads:  [0.259792]
Stock Position:  0.2597919950471691
Bond Position:  [-11.55463923]


portfolio before change:  [16.02771081]
curr_Stock_Price:  106.17646035265498
curr_Factors:  [106.17646035]
mat_Sqrt:  [[0.15]]
grads:  [0.07798448]
Stock Position:  0.0779844801056042
Bond Position:  [7.74759475]


portfolio before change:  [16.09498018]
curr_Stock_Price:  107.02664048666442
curr_Factors:  [107.02664049]
mat_Sqrt:  [[0.15]]
grads:  [0.04707468]
Stock Position:  0.04707468406315572
Bond Position:  [11.05673489]


portfolio before change:  [16.12909605]
curr_Stock_Price:  107.72199712334573
curr_Factors:  [107.72199712]
mat_Sqrt:  [[0.15]]
grads:  [0.05215573]
Stock Position:  0.05215573490871781
Bond Position:  [10.51077612]


portfolio before change:  [16.16346533]
curr_Stock_Price:  108.35577888020626
curr_Factors:  [108.35577888]
mat_Sqrt:  [[0.15]]
grads:  [-0.1928578]
Stock Position:  -0.19285779622153776
Bond Position:  [37.06072205]


portfolio before change:  [16.13229195]
curr_Stock_Price:  108.541440341387
curr_Factors:  [108.54144034]
mat_Sqrt:  [[0.15]]
grads:  [0.01510542]
Stock Position:  0.015105422058336345
Bond Position:  [14.49272768]


portfolio before change:  [16.13290826]
curr_Stock_Price:  108.46230337567857
curr_Factors:  [108.46230338]
mat_Sqrt:  [[0.15]]
grads:  [-0.10726175]
Stock Position:  -0.10726175220476432
Bond Position:  [27.76676497]


portfolio before change:  [16.16941708]
curr_Stock_Price:  108.1542927422719
curr_Factors:  [108.15429274]
mat_Sqrt:  [[0.15]]
grads:  [0.49453305]
Stock Position:  0.4945330487253105
Bond Position:  [-37.31645504]


portfolio before change:  [16.40154887]
curr_Stock_Price:  108.63312148308248
curr_Factors:  [108.63312148]
mat_Sqrt:  [[0.15]]
grads:  [-0.01001901]
Stock Position:  -0.010019007102501554
Bond Position:  [17.48994488]


portfolio before change:  [16.40719192]
curr_Stock_Price:  108.28811016081315
curr_Factors:  [108.28811016]
mat_Sqrt:  [[0.15]]
grads:  [-0.10249871]
Stock Position:  -0.10249870609925166
Bond Position:  [27.5065831]


portfolio before change:  [16.59789861]
curr_Stock_Price:  106.46108075377398
curr_Factors:  [106.46108075]
mat_Sqrt:  [[0.15]]
grads:  [0.02837435]
Stock Position:  0.02837434608565131
Bond Position:  [13.57713506]


portfolio before change:  [16.63668218]
curr_Stock_Price:  107.76811775690378
curr_Factors:  [107.76811776]
mat_Sqrt:  [[0.15]]
grads:  [0.0461356]
Stock Position:  0.04613559991195755
Bond Position:  [11.66473541]


portfolio before change:  [16.73583867]
curr_Stock_Price:  109.88575164462023
curr_Factors:  [109.88575164]
mat_Sqrt:  [[0.15]]
grads:  [0.05432776]
Stock Position:  0.05432775795352566
Bond Position:  [10.76599215]


portfolio before change:  [16.79548615]
curr_Stock_Price:  110.95889818422494
curr_Factors:  [110.95889818]
mat_Sqrt:  [[0.15]]
grads:  [0.05495313]
Stock Position:  0.054953127373973495
Bond Position:  [10.69794768]


portfolio before change:  [16.82566188]
curr_Stock_Price:  111.48368015145215
curr_Factors:  [111.48368015]
mat_Sqrt:  [[0.15]]
grads:  [0.00862458]
Stock Position:  0.008624576255926233
Bond Position:  [15.86416238]


portfolio before change:  [16.83132243]
curr_Stock_Price:  111.91006619056333
curr_Factors:  [111.91006619]
mat_Sqrt:  [[0.15]]
grads:  [-0.70503601]
Stock Position:  -0.7050360078219552
Bond Position:  [95.73194873]


portfolio before change:  [17.48514911]
curr_Stock_Price:  110.99967376249904
curr_Factors:  [110.99967376]
mat_Sqrt:  [[0.15]]
grads:  [0.058117]
Stock Position:  0.05811700356907551
Bond Position:  [11.03418068]


portfolio before change:  [17.50236718]
curr_Stock_Price:  111.27220510569286
curr_Factors:  [111.27220511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.50236718]
Stock Price:  110.67005435385387
PL:  [6.83231282]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.56538900e-03]
 [ 3.93474796e-03]
 [ 6.93337575e-03]
 [-2.67755250e-03]
 [ 1.53582963e-02]
 [ 2.00015559e-02]
 [-6.15667946e-03]
 [ 1.44570513e-02]
 [-6.15169855e-03]
 [ 9.03011148e-04]
 [ 3.10583614e-03]
 [ 5.17542323e-03]
 [ 1.30332381e-02]
 [ 5.38712212e-03]
 [ 1.29341469e-02]
 [-3.33269540e-03]
 [ 1.38383987e-02]
 [-8.73913771e-03]
 [ 4.73023851e-03]
 [ 2.69436557e-03]
 [ 2.16094682e-02]
 [-3.45513858e-03]
 [ 2.53181446e-02]
 [ 4.54497927e-03]
 [ 1.60253077e-02]
 [-1.12067878e-02]
 [ 2.13911316e-02]
 [-1.70008590e-02]
 [-2.92323181e-02]
 [-1.10083884e-03]
 [-4.04129452e-03]
 [ 5.60045045e-03]
 [ 1.13927707e-02]
 [-1.29091987e-02]
 [ 2.92440791e-03]
 [ 5.65349083e-03]
 [ 3.57488373e-03]
 [ 1.08647034e-02]
 [-2.08480608e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.12259309]
curr_Stock_Price:  100.07550055850443
curr_Factors:  [100.07550056]
mat_Sqrt:  [[0.15]]
grads:  [0.03043593]
Stock Position:  0.03043592669464601
Bond Position:  [0.07670249]


portfolio before change:  [3.13648588]
curr_Stock_Price:  100.53164569361316
curr_Factors:  [100.53164569]
mat_Sqrt:  [[0.15]]
grads:  [0.02623165]
Stock Position:  0.02623165308976642
Bond Position:  [0.49937462]


portfolio before change:  [3.12236779]
curr_Stock_Price:  99.99105797096362
curr_Factors:  [99.99105797]
mat_Sqrt:  [[0.15]]
grads:  [0.0462225]
Stock Position:  0.046222504973684256
Bond Position:  [-1.49946938]


portfolio before change:  [3.14748874]
curr_Stock_Price:  100.53859184243767
curr_Factors:  [100.53859184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785035]
Stock Position:  -0.01785034997174122
Bond Position:  [4.94213779]


portfolio before change:  [3.14569982]
curr_Stock_Price:  100.67341932807611
curr_Factors:  [100.67341933]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-7.16211488]


portfolio before change:  [3.10122066]
curr_Stock_Price:  100.24774859874732
curr_Factors:  [100.2477486]
mat_Sqrt:  [[0.15]]
grads:  [0.13334371]
Stock Position:  0.1333437060293677
Bond Position:  [-10.26618566]


portfolio before change:  [3.01782134]
curr_Stock_Price:  99.63192675570953
curr_Factors:  [99.63192676]
mat_Sqrt:  [[0.15]]
grads:  [-0.04104453]
Stock Position:  -0.041044529755999246
Bond Position:  [7.10716692]


portfolio before change:  [2.95827119]
curr_Stock_Price:  101.10443962599842
curr_Factors:  [101.10443963]
mat_Sqrt:  [[0.15]]
grads:  [0.09638034]
Stock Position:  0.09638034185945589
Bond Position:  [-6.78620927]


portfolio before change:  [2.90885475]
curr_Stock_Price:  100.6005183141541
curr_Factors:  [100.60051831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101132]
Stock Position:  -0.04101132367572888
Bond Position:  [7.03461517]


portfolio before change:  [2.91681647]
curr_Stock_Price:  100.42782604082602
curr_Factors:  [100.42782604]
mat_Sqrt:  [[0.15]]
grads:  [0.00602007]
Stock Position:  0.006020074318357159
Bond Position:  [2.31223349]


portfolio before change:  [2.9101356]
curr_Stock_Price:  99.2700470058744
curr_Factors:  [99.27004701]
mat_Sqrt:  [[0.15]]
grads:  [0.02070557]
Stock Position:  0.020705574268543032
Bond Position:  [0.85469227]


portfolio before change:  [2.91491334]
curr_Stock_Price:  99.49563345037669
curr_Factors:  [99.49563345]
mat_Sqrt:  [[0.15]]
grads:  [0.03450282]
Stock Position:  0.03450282156369118
Bond Position:  [-0.51796674]


portfolio before change:  [2.92068093]
curr_Stock_Price:  99.66467297280175
curr_Factors:  [99.66467297]
mat_Sqrt:  [[0.15]]
grads:  [0.08688825]
Stock Position:  0.08688825397667482
Bond Position:  [-5.73900848]


portfolio before change:  [2.93261909]
curr_Stock_Price:  99.81032649405446
curr_Factors:  [99.81032649]
mat_Sqrt:  [[0.15]]
grads:  [0.03591415]
Stock Position:  0.03591414747755173
Bond Position:  [-0.65198369]


portfolio before change:  [2.91985252]
curr_Stock_Price:  99.45712099440892
curr_Factors:  [99.45712099]
mat_Sqrt:  [[0.15]]
grads:  [0.08622765]
Stock Position:  0.08622764593541428
Bond Position:  [-5.6561009]


portfolio before change:  [2.84784239]
curr_Stock_Price:  98.63020440968255
curr_Factors:  [98.63020441]
mat_Sqrt:  [[0.15]]
grads:  [-0.02221797]
Stock Position:  -0.022217969309995957
Bond Position:  [5.03920524]


portfolio before change:  [2.8562551]
curr_Stock_Price:  98.27991248681822
curr_Factors:  [98.27991249]
mat_Sqrt:  [[0.15]]
grads:  [0.09225599]
Stock Position:  0.09225599154323211
Bond Position:  [-6.21065567]


portfolio before change:  [2.82819864]
curr_Stock_Price:  97.98421260846091
curr_Factors:  [97.98421261]
mat_Sqrt:  [[0.15]]
grads:  [-0.05826092]
Stock Position:  -0.05826091806764931
Bond Position:  [8.53684882]


portfolio before change:  [2.88555595]
curr_Stock_Price:  97.01803937301908
curr_Factors:  [97.01803937]
mat_Sqrt:  [[0.15]]
grads:  [0.03153492]
Stock Position:  0.031534923425712666
Bond Position:  [-0.17390049]


portfolio before change:  [2.84507371]
curr_Stock_Price:  95.73500157499433
curr_Factors:  [95.73500157]
mat_Sqrt:  [[0.15]]
grads:  [0.01796244]
Stock Position:  0.01796243714238972
Bond Position:  [1.12543976]


portfolio before change:  [2.86119898]
curr_Stock_Price:  96.62489066957741
curr_Factors:  [96.62489067]
mat_Sqrt:  [[0.15]]
grads:  [0.14406312]
Stock Position:  0.14406312138178287
Bond Position:  [-11.05888438]


portfolio before change:  [2.823604]
curr_Stock_Price:  96.37352493253996
curr_Factors:  [96.37352493]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303426]
Stock Position:  -0.023034257185479003
Bond Position:  [5.04349656]


portfolio before change:  [2.83787014]
curr_Stock_Price:  95.7815516749406
curr_Factors:  [95.78155167]
mat_Sqrt:  [[0.15]]
grads:  [0.16878763]
Stock Position:  0.16878763067934294
Bond Position:  [-13.32887103]


portfolio before change:  [3.14560311]
curr_Stock_Price:  97.61461952568867
curr_Factors:  [97.61461953]
mat_Sqrt:  [[0.15]]
grads:  [0.03029986]
Stock Position:  0.030299861776218216
Bond Position:  [0.18789363]


portfolio before change:  [3.12861904]
curr_Stock_Price:  97.05331170461189
curr_Factors:  [97.0533117]
mat_Sqrt:  [[0.15]]
grads:  [0.10683538]
Stock Position:  0.1068353847157015
Bond Position:  [-7.24010885]


portfolio before change:  [3.21403448]
curr_Stock_Price:  97.86128844931793
curr_Factors:  [97.86128845]
mat_Sqrt:  [[0.15]]
grads:  [-0.07471192]
Stock Position:  -0.07471191845927788
Bond Position:  [10.52543908]


portfolio before change:  [3.31887198]
curr_Stock_Price:  96.4756764122021
curr_Factors:  [96.47567641]
mat_Sqrt:  [[0.15]]
grads:  [0.14260754]
Stock Position:  0.14260754367331918
Bond Position:  [-10.43928726]


portfolio before change:  [3.43300411]
curr_Stock_Price:  97.28515062198686
curr_Factors:  [97.28515062]
mat_Sqrt:  [[0.15]]
grads:  [-0.11333906]
Stock Position:  -0.11333905989307572
Bond Position:  [14.45921163]


portfolio before change:  [3.38038736]
curr_Stock_Price:  97.7653404607052
curr_Factors:  [97.76534046]
mat_Sqrt:  [[0.15]]
grads:  [-0.19488212]
Stock Position:  -0.19488212042342443
Bond Position:  [22.43310421]


portfolio before change:  [3.38756246]
curr_Stock_Price:  97.74291259653764
curr_Factors:  [97.7429126]
mat_Sqrt:  [[0.15]]
grads:  [-0.00733893]
Stock Position:  -0.0073389256149705
Bond Position:  [4.10489043]


portfolio before change:  [3.39500422]
curr_Stock_Price:  96.79882121431285
curr_Factors:  [96.79882121]
mat_Sqrt:  [[0.15]]
grads:  [-0.02694196]
Stock Position:  -0.026941963434541652
Bond Position:  [6.00295453]


portfolio before change:  [3.39004567]
curr_Stock_Price:  97.01072019738422
curr_Factors:  [97.0107202]
mat_Sqrt:  [[0.15]]
grads:  [0.03733634]
Stock Position:  0.03733633632544391
Bond Position:  [-0.23197921]


portfolio before change:  [3.3714224]
curr_Stock_Price:  96.5126995560965
curr_Factors:  [96.51269956]
mat_Sqrt:  [[0.15]]
grads:  [0.0759518]
Stock Position:  0.07595180445339596
Bond Position:  [-3.95889128]


portfolio before change:  [3.29108122]
curr_Stock_Price:  95.4614238626458
curr_Factors:  [95.46142386]
mat_Sqrt:  [[0.15]]
grads:  [-0.08606132]
Stock Position:  -0.08606132486514342
Bond Position:  [11.50661783]


portfolio before change:  [3.17993128]
curr_Stock_Price:  96.76965800864787
curr_Factors:  [96.76965801]
mat_Sqrt:  [[0.15]]
grads:  [0.01949605]
Stock Position:  0.019496052723335048
Bond Position:  [1.29330492]


portfolio before change:  [3.18406534]
curr_Stock_Price:  96.97341140251606
curr_Factors:  [96.9734114]
mat_Sqrt:  [[0.15]]
grads:  [0.03768994]
Stock Position:  0.03768993887175489
Bond Position:  [-0.47085661]


portfolio before change:  [3.21790463]
curr_Stock_Price:  97.8728066219212
curr_Factors:  [97.87280662]
mat_Sqrt:  [[0.15]]
grads:  [0.02383256]
Stock Position:  0.023832558187702926
Bond Position:  [0.88534527]


portfolio before change:  [3.22851837]
curr_Stock_Price:  98.31350928489226
curr_Factors:  [98.31350928]
mat_Sqrt:  [[0.15]]
grads:  [0.07243136]
Stock Position:  0.07243135578947342
Bond Position:  [-3.8924624]


portfolio before change:  [3.18948637]
curr_Stock_Price:  97.78134459606241
curr_Factors:  [97.7813446]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.18948637]
Stock Price:  97.29304984736093
PL:  [3.18948637]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.75662674e-03]
 [-7.06431843e-03]
 [ 1.46169747e-02]
 [ 8.02014011e-03]
 [ 1.45433468e-02]
 [ 2.63766006e-02]
 [-3.96554568e-03]
 [ 1.58158703e-02]
 [-7.88494049e-03]
 [-2.74029553e-03]
 [ 9.66759846e-03]
 [ 4.87100873e-03]
 [ 6.23946737e-03]
 [-5.16900999e-03]
 [ 1.25204781e-02]
 [ 2.43407535e-03]
 [ 8.82089360e-03]
 [ 1.37818865e-02]
 [ 1.15544022e-02]
 [-1.38983046e-02]
 [-1.58773945e-02]
 [ 1.71379454e-02]
 [-1.99372766e-02]
 [ 6.13299272e-03]
 [-5.34082255e-03]
 [-9.69520239e-03]
 [-9.59601761e-04]
 [-1.08425185e-02]
 [ 1.22693468e-02]
 [-1.08510080e-02]
 [-5.67850557e-04]
 [ 5.15564390e-03]
 [ 5.14688646e-03]
 [-6.73227624e-03]
 [ 1.94517806e-02]
 [ 5.54848375e-03]
 [ 3.43536957e-03]
 [ 1.02312389e-02]
 [-1.95201487e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.23094068]
curr_Stock_Price:  100.98562116083598
curr_Factors:  [100.98562116]
mat_Sqrt:  [[0.15]]
grads:  [0.04504418]
Stock Position:  0.04504417826655337
Bond Position:  [12.68212635]


portfolio before change:  [17.28907899]
curr_Stock_Price:  102.24112083479302
curr_Factors:  [102.24112083]
mat_Sqrt:  [[0.15]]
grads:  [-0.04709546]
Stock Position:  -0.047095456209463565
Bond Position:  [22.10417122]


portfolio before change:  [17.30894078]
curr_Stock_Price:  101.87805826587561
curr_Factors:  [101.87805827]
mat_Sqrt:  [[0.15]]
grads:  [0.0974465]
Stock Position:  0.09744649814819747
Bond Position:  [7.38128077]


portfolio before change:  [17.32023513]
curr_Stock_Price:  101.98449233430773
curr_Factors:  [101.98449233]
mat_Sqrt:  [[0.15]]
grads:  [0.0534676]
Stock Position:  0.053467600714215094
Bond Position:  [11.86736901]


portfolio before change:  [17.28485761]
curr_Stock_Price:  101.29508360779123
curr_Factors:  [101.29508361]
mat_Sqrt:  [[0.15]]
grads:  [0.09695565]
Stock Position:  0.0969556455332489
Bond Position:  [7.46372739]


portfolio before change:  [17.27817251]
curr_Stock_Price:  101.21651029150814
curr_Factors:  [101.21651029]
mat_Sqrt:  [[0.15]]
grads:  [0.175844]
Stock Position:  0.17584400430350142
Bond Position:  [-0.52014396]


portfolio before change:  [17.28512142]
curr_Stock_Price:  101.25639751471051
curr_Factors:  [101.25639751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02643697]
Stock Position:  -0.02643697121207914
Bond Position:  [19.96203388]


portfolio before change:  [17.29650118]
curr_Stock_Price:  100.9203396906156
curr_Factors:  [100.92033969]
mat_Sqrt:  [[0.15]]
grads:  [0.10543914]
Stock Position:  0.10543913524685179
Bond Position:  [6.65554783]


portfolio before change:  [17.35809834]
curr_Stock_Price:  101.49664527861076
curr_Factors:  [101.49664528]
mat_Sqrt:  [[0.15]]
grads:  [-0.05256627]
Stock Position:  -0.05256626995736872
Bond Position:  [22.69339839]


portfolio before change:  [17.34840794]
curr_Stock_Price:  101.73495861356126
curr_Factors:  [101.73495861]
mat_Sqrt:  [[0.15]]
grads:  [-0.01826864]
Stock Position:  -0.018268636885829897
Bond Position:  [19.20696696]


portfolio before change:  [17.35495382]
curr_Stock_Price:  101.50807489635581
curr_Factors:  [101.5080749]
mat_Sqrt:  [[0.15]]
grads:  [0.06445066]
Stock Position:  0.0644506564208462
Bond Position:  [10.81269176]


portfolio before change:  [17.35238225]
curr_Stock_Price:  101.44720286078518
curr_Factors:  [101.44720286]
mat_Sqrt:  [[0.15]]
grads:  [0.03247339]
Stock Position:  0.032473391522429965
Bond Position:  [14.05804751]


portfolio before change:  [17.39617384]
curr_Stock_Price:  102.74162348541505
curr_Factors:  [102.74162349]
mat_Sqrt:  [[0.15]]
grads:  [0.04159645]
Stock Position:  0.04159644911182466
Bond Position:  [13.12248713]


portfolio before change:  [17.37467402]
curr_Stock_Price:  102.18532024582977
curr_Factors:  [102.18532025]
mat_Sqrt:  [[0.15]]
grads:  [-0.03446007]
Stock Position:  -0.0344600665960741
Bond Position:  [20.89598696]


portfolio before change:  [17.36816779]
curr_Stock_Price:  102.44992757308411
curr_Factors:  [102.44992757]
mat_Sqrt:  [[0.15]]
grads:  [0.08346985]
Stock Position:  0.08346985402902202
Bond Position:  [8.81668729]


portfolio before change:  [17.37295223]
curr_Stock_Price:  102.49404262911295
curr_Factors:  [102.49404263]
mat_Sqrt:  [[0.15]]
grads:  [0.01622717]
Stock Position:  0.01622716897854266
Bond Position:  [15.70976408]


portfolio before change:  [17.37588074]
curr_Stock_Price:  102.55349062834595
curr_Factors:  [102.55349063]
mat_Sqrt:  [[0.15]]
grads:  [0.05880596]
Stock Position:  0.058805957335587924
Bond Position:  [11.34512455]


portfolio before change:  [17.31267231]
curr_Stock_Price:  101.45450903299505
curr_Factors:  [101.45450903]
mat_Sqrt:  [[0.15]]
grads:  [0.09187924]
Stock Position:  0.09187924331290452
Bond Position:  [7.99110879]


portfolio before change:  [17.34635315]
curr_Stock_Price:  101.81021394118397
curr_Factors:  [101.81021394]
mat_Sqrt:  [[0.15]]
grads:  [0.07702935]
Stock Position:  0.07702934778231314
Bond Position:  [9.50397878]


portfolio before change:  [17.35256795]
curr_Stock_Price:  101.87547122107934
curr_Factors:  [101.87547122]
mat_Sqrt:  [[0.15]]
grads:  [-0.09265536]
Stock Position:  -0.09265536385407258
Bond Position:  [26.79187681]


portfolio before change:  [17.43037678]
curr_Stock_Price:  101.07185192571589
curr_Factors:  [101.07185193]
mat_Sqrt:  [[0.15]]
grads:  [-0.1058493]
Stock Position:  -0.10584929698926528
Bond Position:  [28.12876126]


portfolio before change:  [17.49743701]
curr_Stock_Price:  100.47152754166196
curr_Factors:  [100.47152754]
mat_Sqrt:  [[0.15]]
grads:  [0.11425297]
Stock Position:  0.11425296915235367
Bond Position:  [6.01826668]


portfolio before change:  [17.57316555]
curr_Stock_Price:  101.12775739624875
curr_Factors:  [101.1277574]
mat_Sqrt:  [[0.15]]
grads:  [-0.13291518]
Stock Position:  -0.13291517754660154
Bond Position:  [31.01457938]


portfolio before change:  [17.57250102]
curr_Stock_Price:  101.16192654829109
curr_Factors:  [101.16192655]
mat_Sqrt:  [[0.15]]
grads:  [0.04088662]
Stock Position:  0.04088661814466213
Bond Position:  [13.43633196]


portfolio before change:  [17.61318313]
curr_Stock_Price:  102.11584403876662
curr_Factors:  [102.11584404]
mat_Sqrt:  [[0.15]]
grads:  [-0.03560548]
Stock Position:  -0.035605483647147274
Bond Position:  [21.24906714]


portfolio before change:  [17.57331894]
curr_Stock_Price:  103.31005565759625
curr_Factors:  [103.31005566]
mat_Sqrt:  [[0.15]]
grads:  [-0.06463468]
Stock Position:  -0.06463468259659286
Bond Position:  [24.2507316]


portfolio before change:  [17.59092003]
curr_Stock_Price:  103.08464178071335
curr_Factors:  [103.08464178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00639735]
Stock Position:  -0.006397345070685643
Bond Position:  [18.25038805]


portfolio before change:  [17.59494003]
curr_Stock_Price:  102.81287895640294
curr_Factors:  [102.81287896]
mat_Sqrt:  [[0.15]]
grads:  [-0.07228346]
Stock Position:  -0.07228345662237713
Bond Position:  [25.02661031]


portfolio before change:  [17.66181021]
curr_Stock_Price:  101.93104979301854
curr_Factors:  [101.93104979]
mat_Sqrt:  [[0.15]]
grads:  [0.08179565]
Stock Position:  0.08179564516277402
Bond Position:  [9.32429423]


portfolio before change:  [17.66343951]
curr_Stock_Price:  101.93671869948491
curr_Factors:  [101.9367187]
mat_Sqrt:  [[0.15]]
grads:  [-0.07234005]
Stock Position:  -0.07234005356052896
Bond Position:  [25.0375472]


portfolio before change:  [17.69259905]
curr_Stock_Price:  101.57689527691431
curr_Factors:  [101.57689528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00378567]
Stock Position:  -0.0037856703772274417
Bond Position:  [18.07713569]


portfolio before change:  [17.69421962]
curr_Stock_Price:  101.7457457037894
curr_Factors:  [101.7457457]
mat_Sqrt:  [[0.15]]
grads:  [0.03437096]
Stock Position:  0.03437095930715753
Bond Position:  [14.19712073]


portfolio before change:  [17.72290445]
curr_Stock_Price:  102.52867634182397
curr_Factors:  [102.52867634]
mat_Sqrt:  [[0.15]]
grads:  [0.03431258]
Stock Position:  0.03431257642235882
Bond Position:  [14.2048814]


portfolio before change:  [17.69612012]
curr_Stock_Price:  101.69632717690195
curr_Factors:  [101.69632718]
mat_Sqrt:  [[0.15]]
grads:  [-0.04488184]
Stock Position:  -0.044881841573122
Bond Position:  [22.26043857]


portfolio before change:  [17.77050046]
curr_Stock_Price:  100.10108044841124
curr_Factors:  [100.10108045]
mat_Sqrt:  [[0.15]]
grads:  [0.12967854]
Stock Position:  0.12967853723825123
Bond Position:  [4.78953877]


portfolio before change:  [17.80331722]
curr_Stock_Price:  100.34952576839339
curr_Factors:  [100.34952577]
mat_Sqrt:  [[0.15]]
grads:  [0.03698989]
Stock Position:  0.036989891649050755
Bond Position:  [14.09139913]


portfolio before change:  [17.73721083]
curr_Stock_Price:  98.51475621425752
curr_Factors:  [98.51475621]
mat_Sqrt:  [[0.15]]
grads:  [0.02290246]
Stock Position:  0.02290246381932785
Bond Position:  [15.48098019]


portfolio before change:  [17.74360558]
curr_Stock_Price:  98.70947383765244
curr_Factors:  [98.70947384]
mat_Sqrt:  [[0.15]]
grads:  [0.06820826]
Stock Position:  0.06820825904410255
Bond Position:  [11.01080422]


portfolio before change:  [17.74691408]
curr_Stock_Price:  98.73779972219009
curr_Factors:  [98.73779972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.74691408]
Stock Price:  97.78846525213169
PL:  [17.74691408]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.35583079e-03]
 [-2.15276078e-03]
 [ 6.81336382e-03]
 [-2.68271554e-03]
 [ 1.53255998e-02]
 [-2.65729697e-03]
 [-8.27785916e-04]
 [ 2.08953911e-02]
 [-7.54679003e-03]
 [-3.01834345e-03]
 [ 1.63270788e-02]
 [ 7.33582434e-03]
 [ 8.41638846e-03]
 [ 1.97384254e-05]
 [ 2.44938218e-02]
 [ 1.90184366e-03]
 [ 8.94234499e-03]
 [ 7.05134707e-03]
 [ 1.13850121e-02]
 [-1.33314251e-02]
 [-3.73930267e-03]
 [ 2.42298771e-02]
 [-3.41958776e-02]
 [ 7.25162674e-03]
 [ 5.58962226e-03]
 [-1.14846636e-02]
 [-6.58307401e-04]
 [-1.06903911e-02]
 [ 6.38923726e-02]
 [-2.96630846e-03]
 [-1.33682678e-02]
 [ 3.82197546e-03]
 [ 6.81712340e-03]
 [ 2.10875705e-03]
 [ 8.16710370e-03]
 [ 2.91667657e-03]
 [-6.05906867e-02]
 [ 9.57632674e-03]
 [-4.46537238e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.97667533]
curr_Stock_Price:  99.23047501658316
curr_Factors:  [99.23047502]
mat_Sqrt:  [[0.15]]
grads:  [0.04237221]
Stock Position:  0.04237220523698136
Bond Position:  [-14.18128938]


portfolio before change:  [-9.96935798]
curr_Stock_Price:  99.4450053644737
curr_Factors:  [99.44500536]
mat_Sqrt:  [[0.15]]
grads:  [-0.01435174]
Stock Position:  -0.014351738522598127
Bond Position:  [-8.54214926]


portfolio before change:  [-9.97771097]
curr_Stock_Price:  99.95261992018644
curr_Factors:  [99.95261992]
mat_Sqrt:  [[0.15]]
grads:  [0.04542243]
Stock Position:  0.04542242544631441
Bond Position:  [-14.51780139]


portfolio before change:  [-9.95488651]
curr_Stock_Price:  100.49506771373552
curr_Factors:  [100.49506771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01788477]
Stock Position:  -0.017884770244743272
Bond Position:  [-8.15755531]


portfolio before change:  [-9.94996659]
curr_Stock_Price:  100.16295953405634
curr_Factors:  [100.16295953]
mat_Sqrt:  [[0.15]]
grads:  [0.10217067]
Stock Position:  0.10217066523924533
Bond Position:  [-20.1836828]


portfolio before change:  [-10.04014757]
curr_Stock_Price:  99.30500425139871
curr_Factors:  [99.30500425]
mat_Sqrt:  [[0.15]]
grads:  [-0.01771531]
Stock Position:  -0.01771531314349836
Bond Position:  [-8.28092832]


portfolio before change:  [-10.06606282]
curr_Stock_Price:  100.70944270473977
curr_Factors:  [100.7094427]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551857]
Stock Position:  -0.005518572774462424
Bond Position:  [-9.51029043]


portfolio before change:  [-10.06435395]
curr_Stock_Price:  100.18435678200977
curr_Factors:  [100.18435678]
mat_Sqrt:  [[0.15]]
grads:  [0.13930261]
Stock Position:  0.1393026070365158
Bond Position:  [-24.02029604]


portfolio before change:  [-9.9106248]
curr_Stock_Price:  101.30947481722772
curr_Factors:  [101.30947482]
mat_Sqrt:  [[0.15]]
grads:  [-0.05031193]
Stock Position:  -0.050311933528434896
Bond Position:  [-4.81354924]


portfolio before change:  [-9.96264506]
curr_Stock_Price:  102.33146952553454
curr_Factors:  [102.33146953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02012229]
Stock Position:  -0.0201222896622452
Bond Position:  [-7.90350159]


portfolio before change:  [-9.97353664]
curr_Stock_Price:  102.82363884270991
curr_Factors:  [102.82363884]
mat_Sqrt:  [[0.15]]
grads:  [0.10884719]
Stock Position:  0.10884719224414245
Bond Position:  [-21.16560102]


portfolio before change:  [-9.95415471]
curr_Stock_Price:  103.02601238700291
curr_Factors:  [103.02601239]
mat_Sqrt:  [[0.15]]
grads:  [0.0489055]
Stock Position:  0.048905495582922356
Bond Position:  [-14.9926929]


portfolio before change:  [-10.00472593]
curr_Stock_Price:  102.03027521291725
curr_Factors:  [102.03027521]
mat_Sqrt:  [[0.15]]
grads:  [0.05610926]
Stock Position:  0.05610925638731778
Bond Position:  [-15.7295688]


portfolio before change:  [-10.07550325]
curr_Stock_Price:  100.80390012113509
curr_Factors:  [100.80390012]
mat_Sqrt:  [[0.15]]
grads:  [0.00013159]
Stock Position:  0.0001315895028693662
Bond Position:  [-10.08876798]


portfolio before change:  [-10.07673602]
curr_Stock_Price:  101.01970758898804
curr_Factors:  [101.01970759]
mat_Sqrt:  [[0.15]]
grads:  [0.16329215]
Stock Position:  0.16329214516845242
Bond Position:  [-26.57246078]


portfolio before change:  [-9.96135746]
curr_Stock_Price:  101.74662758744007
curr_Factors:  [101.74662759]
mat_Sqrt:  [[0.15]]
grads:  [0.01267896]
Stock Position:  0.012678957730059628
Bond Position:  [-11.25139865]


portfolio before change:  [-9.9645536]
curr_Stock_Price:  101.6054786620486
curr_Factors:  [101.60547866]
mat_Sqrt:  [[0.15]]
grads:  [0.05961563]
Stock Position:  0.059615633256970064
Bond Position:  [-16.02182855]


portfolio before change:  [-10.06511485]
curr_Stock_Price:  99.95224788213001
curr_Factors:  [99.95224788]
mat_Sqrt:  [[0.15]]
grads:  [0.04700898]
Stock Position:  0.04700898047502384
Bond Position:  [-14.76376812]


portfolio before change:  [-10.01988866]
curr_Stock_Price:  100.95358380305014
curr_Factors:  [100.9535838]
mat_Sqrt:  [[0.15]]
grads:  [0.07590008]
Stock Position:  0.07590008055564437
Bond Position:  [-17.6822738]


portfolio before change:  [-10.00152428]
curr_Stock_Price:  101.22466117034173
curr_Factors:  [101.22466117]
mat_Sqrt:  [[0.15]]
grads:  [-0.08887617]
Stock Position:  -0.08887616742172802
Bond Position:  [-1.00506435]


portfolio before change:  [-10.12522995]
curr_Stock_Price:  102.6151354651125
curr_Factors:  [102.61513547]
mat_Sqrt:  [[0.15]]
grads:  [-0.02492868]
Stock Position:  -0.02492868449548535
Bond Position:  [-7.56716962]


portfolio before change:  [-10.12049875]
curr_Stock_Price:  102.3873994292178
curr_Factors:  [102.38739943]
mat_Sqrt:  [[0.15]]
grads:  [0.16153251]
Stock Position:  0.16153251418555195
Bond Position:  [-26.6593928]


portfolio before change:  [-9.92479948]
curr_Stock_Price:  103.61954702468182
curr_Factors:  [103.61954702]
mat_Sqrt:  [[0.15]]
grads:  [-0.22797252]
Stock Position:  -0.22797251755214512
Bond Position:  [13.69760952]


portfolio before change:  [-9.92058003]
curr_Stock_Price:  103.60854946913214
curr_Factors:  [103.60854947]
mat_Sqrt:  [[0.15]]
grads:  [0.04834418]
Stock Position:  0.04834417824116032
Bond Position:  [-14.92945021]


portfolio before change:  [-9.9189276]
curr_Stock_Price:  103.68133437982046
curr_Factors:  [103.68133438]
mat_Sqrt:  [[0.15]]
grads:  [0.03726415]
Stock Position:  0.03726414840208526
Bond Position:  [-13.78252423]


portfolio before change:  [-9.91819688]
curr_Stock_Price:  103.74717908512662
curr_Factors:  [103.74717909]
mat_Sqrt:  [[0.15]]
grads:  [-0.07656442]
Stock Position:  -0.0765644239660566
Bond Position:  [-1.97485387]


portfolio before change:  [-9.92937523]
curr_Stock_Price:  103.88995405205809
curr_Factors:  [103.88995405]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438872]
Stock Position:  -0.004388716007327733
Bond Position:  [-9.47343173]


portfolio before change:  [-9.9328347]
curr_Stock_Price:  104.40837700711111
curr_Factors:  [104.40837701]
mat_Sqrt:  [[0.15]]
grads:  [-0.07126927]
Stock Position:  -0.07126927427450187
Bond Position:  [-2.49172544]


portfolio before change:  [-10.04609597]
curr_Stock_Price:  105.99320848580642
curr_Factors:  [105.99320849]
mat_Sqrt:  [[0.15]]
grads:  [0.42594915]
Stock Position:  0.4259491507851058
Bond Position:  [-55.19381312]


portfolio before change:  [-9.83223296]
curr_Stock_Price:  106.51149259053389
curr_Factors:  [106.51149259]
mat_Sqrt:  [[0.15]]
grads:  [-0.01977539]
Stock Position:  -0.019775389746290343
Bond Position:  [-7.72592668]


portfolio before change:  [-9.85193392]
curr_Stock_Price:  107.45889033161207
curr_Factors:  [107.45889033]
mat_Sqrt:  [[0.15]]
grads:  [-0.08912179]
Stock Position:  -0.08912178514998405
Bond Position:  [-0.27500578]


portfolio before change:  [-9.95621944]
curr_Stock_Price:  108.62865088018336
curr_Factors:  [108.62865088]
mat_Sqrt:  [[0.15]]
grads:  [0.02547984]
Stock Position:  0.02547983642823518
Bond Position:  [-12.7240597]


portfolio before change:  [-9.98462967]
curr_Stock_Price:  107.57606891712499
curr_Factors:  [107.57606892]
mat_Sqrt:  [[0.15]]
grads:  [0.04544749]
Stock Position:  0.0454474893149605
Bond Position:  [-14.87369191]


portfolio before change:  [-10.00789323]
curr_Stock_Price:  107.10510272002251
curr_Factors:  [107.10510272]
mat_Sqrt:  [[0.15]]
grads:  [0.01405838]
Stock Position:  0.01405838032568163
Bond Position:  [-11.51361749]


portfolio before change:  [-10.0120664]
curr_Stock_Price:  106.9106366646058
curr_Factors:  [106.91063666]
mat_Sqrt:  [[0.15]]
grads:  [0.05444736]
Stock Position:  0.05444735796785071
Bond Position:  [-15.8330681]


portfolio before change:  [-9.9380858]
curr_Stock_Price:  108.30574297507243
curr_Factors:  [108.30574298]
mat_Sqrt:  [[0.15]]
grads:  [0.01944451]
Stock Position:  0.019444510496450886
Bond Position:  [-12.04403796]


portfolio before change:  [-9.94365551]
curr_Stock_Price:  108.09673208537599
curr_Factors:  [108.09673209]
mat_Sqrt:  [[0.15]]
grads:  [-0.40393791]
Stock Position:  -0.40393791138219537
Bond Position:  [33.72071267]


portfolio before change:  [-9.47771389]
curr_Stock_Price:  106.95366961084974
curr_Factors:  [106.95366961]
mat_Sqrt:  [[0.15]]
grads:  [0.06384218]
Stock Position:  0.06384217823838628
Bond Position:  [-16.30586913]


portfolio before change:  [-9.43432313]
curr_Stock_Price:  107.66525435577869
curr_Factors:  [107.66525436]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.43432313]
Stock Price:  107.59930757393323
PL:  [-17.03363071]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.64623243e-03]
 [-9.56606843e-03]
 [-1.40803001e-02]
 [-1.36257909e-03]
 [ 1.06121495e-02]
 [ 1.97359194e-02]
 [-5.06251382e-03]
 [ 2.29246910e-02]
 [-5.94423230e-03]
 [-1.03538921e-03]
 [-9.05964823e-04]
 [ 7.06260621e-03]
 [ 1.39110311e-02]
 [ 2.42584057e-03]
 [ 7.30956617e-03]
 [-3.32825703e-03]
 [ 1.41561668e-02]
 [-1.07454239e-02]
 [ 4.73027405e-03]
 [ 1.78445951e-03]
 [ 2.20949896e-02]
 [-2.53004971e-03]
 [ 2.37799625e-02]
 [ 4.07782976e-03]
 [ 1.56452772e-02]
 [-1.04336470e-02]
 [ 1.77719516e-02]
 [-1.38761592e-02]
 [-4.76410056e-02]
 [ 5.67949959e-04]
 [-4.02493125e-03]
 [ 5.58855350e-03]
 [ 1.24513371e-02]
 [-1.28477778e-02]
 [ 3.09635618e-03]
 [ 5.58061550e-03]
 [ 4.56468796e-03]
 [ 9.41520666e-03]
 [-5.82777125e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.79686867]
curr_Stock_Price:  99.5001117072511
curr_Factors:  [99.50011171]
mat_Sqrt:  [[0.15]]
grads:  [0.03097488]
Stock Position:  0.03097488288080496
Bond Position:  [-8.87887298]


portfolio before change:  [-5.81645192]
curr_Stock_Price:  98.90371503906529
curr_Factors:  [98.90371504]
mat_Sqrt:  [[0.15]]
grads:  [-0.06377379]
Stock Position:  -0.06377378954548517
Bond Position:  [0.49101279]


portfolio before change:  [-5.78892324]
curr_Stock_Price:  98.47301618626396
curr_Factors:  [98.47301619]
mat_Sqrt:  [[0.15]]
grads:  [-0.09386867]
Stock Position:  -0.09386866753647921
Bond Position:  [3.45460758]


portfolio before change:  [-5.83864285]
curr_Stock_Price:  99.00728883100912
curr_Factors:  [99.00728883]
mat_Sqrt:  [[0.15]]
grads:  [-0.00908386]
Stock Position:  -0.009083860580876606
Bond Position:  [-4.93927444]


portfolio before change:  [-5.84291855]
curr_Stock_Price:  99.41000875106779
curr_Factors:  [99.41000875]
mat_Sqrt:  [[0.15]]
grads:  [0.07074766]
Stock Position:  0.07074766340238145
Bond Position:  [-12.87594438]


portfolio before change:  [-5.78653746]
curr_Stock_Price:  100.2296920719612
curr_Factors:  [100.22969207]
mat_Sqrt:  [[0.15]]
grads:  [0.1315728]
Stock Position:  0.13157279618007
Bond Position:  [-18.97403831]


portfolio before change:  [-5.84799691]
curr_Stock_Price:  99.78060576256487
curr_Factors:  [99.78060576]
mat_Sqrt:  [[0.15]]
grads:  [-0.03375009]
Stock Position:  -0.03375009212950097
Bond Position:  [-2.48039227]


portfolio before change:  [-5.84764845]
curr_Stock_Price:  99.76109388893381
curr_Factors:  [99.76109389]
mat_Sqrt:  [[0.15]]
grads:  [0.15283127]
Stock Position:  0.15283127355839515
Bond Position:  [-21.09426348]


portfolio before change:  [-6.03798362]
curr_Stock_Price:  98.53295375270244
curr_Factors:  [98.53295375]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962822]
Stock Position:  -0.039628215300465855
Bond Position:  [-2.13329851]


portfolio before change:  [-6.00978393]
curr_Stock_Price:  97.81461789529101
curr_Factors:  [97.8146179]
mat_Sqrt:  [[0.15]]
grads:  [-0.00690259]
Stock Position:  -0.0069025947230305675
Bond Position:  [-5.33460926]


portfolio before change:  [-6.01452685]
curr_Stock_Price:  98.40512910504243
curr_Factors:  [98.40512911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00603977]
Stock Position:  -0.006039765487615377
Bond Position:  [-5.42018295]


portfolio before change:  [-6.01567339]
curr_Stock_Price:  98.48277564076761
curr_Factors:  [98.48277564]
mat_Sqrt:  [[0.15]]
grads:  [0.04708404]
Stock Position:  0.047084041399875626
Bond Position:  [-10.65264047]


portfolio before change:  [-6.04291599]
curr_Stock_Price:  97.93246312669532
curr_Factors:  [97.93246313]
mat_Sqrt:  [[0.15]]
grads:  [0.09274021]
Stock Position:  0.09274020700729872
Bond Position:  [-15.12519289]


portfolio before change:  [-6.04031456]
curr_Stock_Price:  97.98090156763485
curr_Factors:  [97.98090157]
mat_Sqrt:  [[0.15]]
grads:  [0.01617227]
Stock Position:  0.016172270488453995
Bond Position:  [-7.62488821]


portfolio before change:  [-6.02941138]
curr_Stock_Price:  98.7140303718651
curr_Factors:  [98.71403037]
mat_Sqrt:  [[0.15]]
grads:  [0.04873044]
Stock Position:  0.048730441103918325
Bond Position:  [-10.83978962]


portfolio before change:  [-6.06473328]
curr_Stock_Price:  98.01699490202428
curr_Factors:  [98.0169949]
mat_Sqrt:  [[0.15]]
grads:  [-0.02218838]
Stock Position:  -0.022188380212819794
Bond Position:  [-3.88989493]


portfolio before change:  [-6.06830889]
curr_Stock_Price:  98.15622744247261
curr_Factors:  [98.15622744]
mat_Sqrt:  [[0.15]]
grads:  [0.09437445]
Stock Position:  0.09437444548743758
Bond Position:  [-15.33174843]


portfolio before change:  [-6.1702181]
curr_Stock_Price:  97.09669676245015
curr_Factors:  [97.09669676]
mat_Sqrt:  [[0.15]]
grads:  [-0.07163616]
Stock Position:  -0.07163615926881156
Bond Position:  [0.78541633]


portfolio before change:  [-6.16448667]
curr_Stock_Price:  97.01805988183742
curr_Factors:  [97.01805988]
mat_Sqrt:  [[0.15]]
grads:  [0.03153516]
Stock Position:  0.03153516032981036
Bond Position:  [-9.22396675]


portfolio before change:  [-6.19849762]
curr_Stock_Price:  95.97611557262925
curr_Factors:  [95.97611557]
mat_Sqrt:  [[0.15]]
grads:  [0.0118964]
Stock Position:  0.01189639671519957
Bond Position:  [-7.34026757]


portfolio before change:  [-6.19405873]
curr_Stock_Price:  96.42637617433165
curr_Factors:  [96.42637617]
mat_Sqrt:  [[0.15]]
grads:  [0.14729993]
Stock Position:  0.14729993091949603
Bond Position:  [-20.39765728]


portfolio before change:  [-6.29303196]
curr_Stock_Price:  95.7717705659514
curr_Factors:  [95.77177057]
mat_Sqrt:  [[0.15]]
grads:  [-0.016867]
Stock Position:  -0.0168669980574508
Bond Position:  [-4.67764969]


portfolio before change:  [-6.30309397]
curr_Stock_Price:  96.33365301227612
curr_Factors:  [96.33365301]
mat_Sqrt:  [[0.15]]
grads:  [0.15853308]
Stock Position:  0.15853308363601562
Bond Position:  [-21.57516504]


portfolio before change:  [-6.26666481]
curr_Stock_Price:  96.58045468346789
curr_Factors:  [96.58045468]
mat_Sqrt:  [[0.15]]
grads:  [0.02718553]
Stock Position:  0.027185531702072798
Bond Position:  [-8.89225582]


portfolio before change:  [-6.22593339]
curr_Stock_Price:  98.11961970216703
curr_Factors:  [98.1196197]
mat_Sqrt:  [[0.15]]
grads:  [0.10430185]
Stock Position:  0.10430184827029669
Bond Position:  [-16.45999108]


portfolio before change:  [-6.31811031]
curr_Stock_Price:  97.25559582050982
curr_Factors:  [97.25559582]
mat_Sqrt:  [[0.15]]
grads:  [-0.06955765]
Stock Position:  -0.06955764659370516
Bond Position:  [0.44676006]


portfolio before change:  [-6.32759002]
curr_Stock_Price:  97.39268448690063
curr_Factors:  [97.39268449]
mat_Sqrt:  [[0.15]]
grads:  [0.11847968]
Stock Position:  0.11847967732938383
Bond Position:  [-17.86664385]


portfolio before change:  [-6.27000745]
curr_Stock_Price:  97.89754778755642
curr_Factors:  [97.89754779]
mat_Sqrt:  [[0.15]]
grads:  [-0.09250773]
Stock Position:  -0.09250772766737393
Bond Position:  [2.78627224]


portfolio before change:  [-6.05333962]
curr_Stock_Price:  95.55915367577055
curr_Factors:  [95.55915368]
mat_Sqrt:  [[0.15]]
grads:  [-0.3176067]
Stock Position:  -0.3176067042688529
Bond Position:  [24.29688824]


portfolio before change:  [-6.250461]
curr_Stock_Price:  96.18936291989593
curr_Factors:  [96.18936292]
mat_Sqrt:  [[0.15]]
grads:  [0.00378633]
Stock Position:  0.003786333063055403
Bond Position:  [-6.61466597]


portfolio before change:  [-6.24853199]
curr_Stock_Price:  96.91721706689626
curr_Factors:  [96.91721707]
mat_Sqrt:  [[0.15]]
grads:  [-0.02683287]
Stock Position:  -0.026832874997626145
Bond Position:  [-3.64796442]


portfolio before change:  [-6.23781207]
curr_Stock_Price:  96.50071525957775
curr_Factors:  [96.50071526]
mat_Sqrt:  [[0.15]]
grads:  [0.03725702]
Stock Position:  0.037257023305864716
Bond Position:  [-9.83314147]


portfolio before change:  [-6.25416665]
curr_Stock_Price:  96.09474186459816
curr_Factors:  [96.09474186]
mat_Sqrt:  [[0.15]]
grads:  [0.08300891]
Stock Position:  0.08300891378225067
Bond Position:  [-14.23088679]


portfolio before change:  [-6.23681015]
curr_Stock_Price:  96.32526493737748
curr_Factors:  [96.32526494]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565185]
Stock Position:  -0.08565185227113144
Bond Position:  [2.01362721]


portfolio before change:  [-6.18463598]
curr_Stock_Price:  95.71906146170039
curr_Factors:  [95.71906146]
mat_Sqrt:  [[0.15]]
grads:  [0.02064237]
Stock Position:  0.020642374528806233
Bond Position:  [-8.1605047]


portfolio before change:  [-6.18629748]
curr_Stock_Price:  95.68799097569037
curr_Factors:  [95.68799098]
mat_Sqrt:  [[0.15]]
grads:  [0.0372041]
Stock Position:  0.03720410333342058
Bond Position:  [-9.74628338]


portfolio before change:  [-6.21868106]
curr_Stock_Price:  94.85030861632137
curr_Factors:  [94.85030862]
mat_Sqrt:  [[0.15]]
grads:  [0.03043125]
Stock Position:  0.03043125303389041
Bond Position:  [-9.1050948]


portfolio before change:  [-6.2439003]
curr_Stock_Price:  94.05898289431481
curr_Factors:  [94.05898289]
mat_Sqrt:  [[0.15]]
grads:  [0.06276804]
Stock Position:  0.06276804438269111
Bond Position:  [-12.14779871]


portfolio before change:  [-6.20839236]
curr_Stock_Price:  94.64887726745144
curr_Factors:  [94.64887727]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.20839236]
Stock Price:  95.44208383716854
PL:  [-6.20839236]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.30773454e-03]
 [ 2.57276212e-03]
 [ 7.20512427e-03]
 [-2.29352523e-03]
 [ 4.75670757e-03]
 [-1.41268858e-02]
 [-4.58376625e-02]
 [ 1.96859964e-02]
 [-6.11395878e-03]
 [ 2.84580822e-03]
 [-1.99141468e-03]
 [ 7.24264675e-03]
 [ 1.39084389e-02]
 [ 2.53761915e-03]
 [ 2.87901235e-03]
 [-3.33470281e-03]
 [ 1.23282660e-02]
 [-8.09411707e-03]
 [ 6.65584809e-03]
 [-5.70981879e-03]
 [ 1.65270934e-02]
 [-2.03623138e-03]
 [ 2.32916503e-02]
 [ 4.02026197e-03]
 [ 1.69457441e-02]
 [-1.09697121e-02]
 [ 1.45027112e-02]
 [-1.09724987e-02]
 [-1.79791590e-02]
 [-3.54374287e-03]
 [-3.67428419e-03]
 [ 5.61988086e-03]
 [ 9.09225891e-03]
 [-1.23653410e-02]
 [ 3.89733275e-03]
 [ 5.71151453e-03]
 [ 3.62809796e-03]
 [ 1.13587133e-02]
 [-2.84897260e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.44993703]
curr_Stock_Price:  99.96759857136446
curr_Factors:  [99.96759857]
mat_Sqrt:  [[0.15]]
grads:  [0.02205156]
Stock Position:  0.022051563619546584
Bond Position:  [-0.75450483]


portfolio before change:  [1.4455205]
curr_Stock_Price:  99.77159375698172
curr_Factors:  [99.77159376]
mat_Sqrt:  [[0.15]]
grads:  [0.01715175]
Stock Position:  0.017151747454937187
Bond Position:  [-0.26573668]


portfolio before change:  [1.4502642]
curr_Stock_Price:  100.05010320155803
curr_Factors:  [100.0501032]
mat_Sqrt:  [[0.15]]
grads:  [0.04803416]
Stock Position:  0.04803416182371698
Bond Position:  [-3.35555864]


portfolio before change:  [1.42251592]
curr_Stock_Price:  99.48115777646409
curr_Factors:  [99.48115778]
mat_Sqrt:  [[0.15]]
grads:  [-0.01529017]
Stock Position:  -0.01529016820956935
Bond Position:  [2.94359955]


portfolio before change:  [1.42825283]
curr_Stock_Price:  99.13002117038917
curr_Factors:  [99.13002117]
mat_Sqrt:  [[0.15]]
grads:  [0.03171138]
Stock Position:  0.03171138381873229
Bond Position:  [-1.71529732]


portfolio before change:  [1.42274022]
curr_Stock_Price:  98.96294626601671
curr_Factors:  [98.96294627]
mat_Sqrt:  [[0.15]]
grads:  [-0.09417924]
Stock Position:  -0.09417923853523391
Bond Position:  [10.74299515]


portfolio before change:  [1.46534461]
curr_Stock_Price:  98.52483030746795
curr_Factors:  [98.52483031]
mat_Sqrt:  [[0.15]]
grads:  [-0.30558442]
Stock Position:  -0.3055844163707333
Bond Position:  [31.57299738]


portfolio before change:  [1.63843317]
curr_Stock_Price:  97.97132796450377
curr_Factors:  [97.97132796]
mat_Sqrt:  [[0.15]]
grads:  [0.13123998]
Stock Position:  0.13123997611363006
Bond Position:  [-11.21932157]


portfolio before change:  [1.61389771]
curr_Stock_Price:  97.79506337058716
curr_Factors:  [97.79506337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04075973]
Stock Position:  -0.040759725188958575
Bond Position:  [5.59999762]


portfolio before change:  [1.6503676]
curr_Stock_Price:  96.91748515251162
curr_Factors:  [96.91748515]
mat_Sqrt:  [[0.15]]
grads:  [0.01897205]
Stock Position:  0.018972054779187095
Bond Position:  [-0.18835624]


portfolio before change:  [1.67519029]
curr_Stock_Price:  98.22710807179548
curr_Factors:  [98.22710807]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132761]
Stock Position:  -0.013276097855418419
Bond Position:  [2.97926299]


portfolio before change:  [1.67790534]
curr_Stock_Price:  98.05065423960656
curr_Factors:  [98.05065424]
mat_Sqrt:  [[0.15]]
grads:  [0.04828431]
Stock Position:  0.04828431166213059
Bond Position:  [-3.05640301]


portfolio before change:  [1.66333196]
curr_Stock_Price:  97.75674302809702
curr_Factors:  [97.75674303]
mat_Sqrt:  [[0.15]]
grads:  [0.09272293]
Stock Position:  0.0927229261476444
Bond Position:  [-7.4009593]


portfolio before change:  [1.72457939]
curr_Stock_Price:  98.42726335862672
curr_Factors:  [98.42726336]
mat_Sqrt:  [[0.15]]
grads:  [0.01691746]
Stock Position:  0.01691746099429448
Bond Position:  [0.05944001]


portfolio before change:  [1.71725698]
curr_Stock_Price:  97.99399209539335
curr_Factors:  [97.9939921]
mat_Sqrt:  [[0.15]]
grads:  [0.01919342]
Stock Position:  0.019193415645494094
Bond Position:  [-0.16358245]


portfolio before change:  [1.72538332]
curr_Stock_Price:  98.41844971781539
curr_Factors:  [98.41844972]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223135]
Stock Position:  -0.02223135208881706
Bond Position:  [3.91335853]


portfolio before change:  [1.71588503]
curr_Stock_Price:  98.86770225278956
curr_Factors:  [98.86770225]
mat_Sqrt:  [[0.15]]
grads:  [0.08218844]
Stock Position:  0.0821884400888606
Bond Position:  [-6.4098972]


portfolio before change:  [1.66592244]
curr_Stock_Price:  98.26954878991161
curr_Factors:  [98.26954879]
mat_Sqrt:  [[0.15]]
grads:  [-0.05396078]
Stock Position:  -0.05396078047858542
Bond Position:  [6.96862399]


portfolio before change:  [1.67914168]
curr_Stock_Price:  98.04071390373232
curr_Factors:  [98.0407139]
mat_Sqrt:  [[0.15]]
grads:  [0.04437232]
Stock Position:  0.04437232060440114
Bond Position:  [-2.67115231]


portfolio before change:  [1.68125006]
curr_Stock_Price:  98.09575489207803
curr_Factors:  [98.09575489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03806546]
Stock Position:  -0.038065458585864076
Bond Position:  [5.41530996]


portfolio before change:  [1.68835383]
curr_Stock_Price:  97.92691900848844
curr_Factors:  [97.92691901]
mat_Sqrt:  [[0.15]]
grads:  [0.11018062]
Stock Position:  0.11018062251428483
Bond Position:  [-9.10129506]


portfolio before change:  [1.60980132]
curr_Stock_Price:  97.22430199603
curr_Factors:  [97.224302]
mat_Sqrt:  [[0.15]]
grads:  [-0.01357488]
Stock Position:  -0.01357487584779983
Bond Position:  [2.92960915]


portfolio before change:  [1.61326378]
curr_Stock_Price:  96.99621593718138
curr_Factors:  [96.99621594]
mat_Sqrt:  [[0.15]]
grads:  [0.15527767]
Stock Position:  0.15527766833357484
Bond Position:  [-13.44808246]


portfolio before change:  [1.53259892]
curr_Stock_Price:  96.48755460905397
curr_Factors:  [96.48755461]
mat_Sqrt:  [[0.15]]
grads:  [0.02680175]
Stock Position:  0.026801746461264504
Bond Position:  [-1.05343605]


portfolio before change:  [1.56214622]
curr_Stock_Price:  97.59490716465422
curr_Factors:  [97.59490716]
mat_Sqrt:  [[0.15]]
grads:  [0.11297163]
Stock Position:  0.11297162755383938
Bond Position:  [-9.46330928]


portfolio before change:  [1.64744164]
curr_Stock_Price:  98.36039503971348
curr_Factors:  [98.36039504]
mat_Sqrt:  [[0.15]]
grads:  [-0.07313141]
Stock Position:  -0.07313141420791085
Bond Position:  [8.84067643]


portfolio before change:  [1.63717186]
curr_Stock_Price:  98.51593608561568
curr_Factors:  [98.51593609]
mat_Sqrt:  [[0.15]]
grads:  [0.09668474]
Stock Position:  0.09668474105569935
Bond Position:  [-7.88781591]


portfolio before change:  [1.74872742]
curr_Stock_Price:  99.67994193189807
curr_Factors:  [99.67994193]
mat_Sqrt:  [[0.15]]
grads:  [-0.07314999]
Stock Position:  -0.07314999152095557
Bond Position:  [9.04031433]


portfolio before change:  [1.82636279]
curr_Stock_Price:  98.63407366273951
curr_Factors:  [98.63407366]
mat_Sqrt:  [[0.15]]
grads:  [-0.11986106]
Stock Position:  -0.11986105973452908
Bond Position:  [13.64874739]


portfolio before change:  [1.79786467]
curr_Stock_Price:  98.88606808549771
curr_Factors:  [98.88606809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362495]
Stock Position:  -0.02362495247205257
Bond Position:  [4.13404333]


portfolio before change:  [1.81189803]
curr_Stock_Price:  98.31393709665014
curr_Factors:  [98.3139371]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449523]
Stock Position:  -0.02449522791781835
Bond Position:  [4.22012032]


portfolio before change:  [1.82394479]
curr_Stock_Price:  97.84367333753832
curr_Factors:  [97.84367334]
mat_Sqrt:  [[0.15]]
grads:  [0.03746587]
Stock Position:  0.03746587238248243
Bond Position:  [-1.84185379]


portfolio before change:  [1.81224544]
curr_Stock_Price:  97.5375519103205
curr_Factors:  [97.53755191]
mat_Sqrt:  [[0.15]]
grads:  [0.06061506]
Stock Position:  0.060615059396725686
Bond Position:  [-4.09999906]


portfolio before change:  [1.87688996]
curr_Stock_Price:  98.612483727289
curr_Factors:  [98.61248373]
mat_Sqrt:  [[0.15]]
grads:  [-0.08243561]
Stock Position:  -0.08243560692652734
Bond Position:  [10.00606991]


portfolio before change:  [1.93107193]
curr_Stock_Price:  97.97039316692003
curr_Factors:  [97.97039317]
mat_Sqrt:  [[0.15]]
grads:  [0.02598222]
Stock Position:  0.025982218342819753
Bond Position:  [-0.61441622]


portfolio before change:  [1.92600496]
curr_Stock_Price:  97.77833254039788
curr_Factors:  [97.77833254]
mat_Sqrt:  [[0.15]]
grads:  [0.03807676]
Stock Position:  0.03807676351898651
Bond Position:  [-1.79707749]


portfolio before change:  [1.89108273]
curr_Stock_Price:  96.86707925163954
curr_Factors:  [96.86707925]
mat_Sqrt:  [[0.15]]
grads:  [0.02418732]
Stock Position:  0.024187319732172502
Bond Position:  [-0.45187228]


portfolio before change:  [1.88009721]
curr_Stock_Price:  96.41522954574324
curr_Factors:  [96.41522955]
mat_Sqrt:  [[0.15]]
grads:  [0.07572476]
Stock Position:  0.0757247552456542
Bond Position:  [-5.42092245]


portfolio before change:  [1.9054301]
curr_Stock_Price:  96.75871754504234
curr_Factors:  [96.75871755]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.9054301]
Stock Price:  95.51572282963936
PL:  [1.9054301]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.35914432e-03]
 [ 7.91665900e-04]
 [ 2.44119987e-03]
 [ 1.66161682e-03]
 [-2.03329827e-02]
 [-2.83275056e-02]
 [-4.28236783e-02]
 [ 1.10747664e-02]
 [-6.51252421e-03]
 [ 5.84469099e-03]
 [-9.56031207e-03]
 [ 7.58649110e-03]
 [ 1.38955002e-02]
 [ 2.02893784e-03]
 [ 5.46464651e-03]
 [-3.25885562e-03]
 [ 1.25332365e-02]
 [ 3.08938491e-03]
 [ 1.15958260e-02]
 [-1.23469340e-02]
 [-4.04718346e-03]
 [ 8.83347664e-03]
 [ 1.81639176e-02]
 [ 5.16021771e-03]
 [ 7.42820384e-03]
 [-8.48342273e-03]
 [ 2.91280067e-03]
 [-1.05512132e-02]
 [-1.76443009e-02]
 [-4.60363631e-03]
 [-3.39415933e-03]
 [ 5.60149733e-03]
 [ 6.63036245e-03]
 [-1.18050850e-02]
 [ 1.09475557e-02]
 [ 5.67931243e-03]
 [ 3.58514725e-03]
 [ 1.06812905e-02]
 [-4.79626546e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.84829165]
curr_Stock_Price:  100.05780554592141
curr_Factors:  [100.05780555]
mat_Sqrt:  [[0.15]]
grads:  [0.02906096]
Stock Position:  0.029060962117560703
Bond Position:  [-0.05948444]


portfolio before change:  [2.8363385]
curr_Stock_Price:  99.64674822973362
curr_Factors:  [99.64674823]
mat_Sqrt:  [[0.15]]
grads:  [0.00527777]
Stock Position:  0.005277772667925859
Bond Position:  [2.31042561]


portfolio before change:  [2.83560064]
curr_Stock_Price:  99.45221907841754
curr_Factors:  [99.45221908]
mat_Sqrt:  [[0.15]]
grads:  [0.01627467]
Stock Position:  0.01627466578198063
Bond Position:  [1.21704901]


portfolio before change:  [2.81842928]
curr_Stock_Price:  98.38777365148181
curr_Factors:  [98.38777365]
mat_Sqrt:  [[0.15]]
grads:  [0.01107745]
Stock Position:  0.01107744548812569
Bond Position:  [1.72854408]


portfolio before change:  [2.81636926]
curr_Stock_Price:  98.18230166390887
curr_Factors:  [98.18230166]
mat_Sqrt:  [[0.15]]
grads:  [-0.13555322]
Stock Position:  -0.13555321817076385
Bond Position:  [16.12529622]


portfolio before change:  [2.87659284]
curr_Stock_Price:  97.75289251494162
curr_Factors:  [97.75289251]
mat_Sqrt:  [[0.15]]
grads:  [-0.18885004]
Stock Position:  -0.1888500374868008
Bond Position:  [21.33723026]


portfolio before change:  [2.99584963]
curr_Stock_Price:  97.135527194075
curr_Factors:  [97.13552719]
mat_Sqrt:  [[0.15]]
grads:  [-0.28549119]
Stock Position:  -0.2854911886860121
Bond Position:  [30.72718675]


portfolio before change:  [3.22342153]
curr_Stock_Price:  96.35185760132894
curr_Factors:  [96.3518576]
mat_Sqrt:  [[0.15]]
grads:  [0.07383178]
Stock Position:  0.07383177590664788
Bond Position:  [-3.89040723]


portfolio before change:  [3.20848438]
curr_Stock_Price:  96.15613135801364
curr_Factors:  [96.15613136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341683]
Stock Position:  -0.04341682809391087
Bond Position:  [7.38327861]


portfolio before change:  [3.19374868]
curr_Stock_Price:  96.51679025548118
curr_Factors:  [96.51679026]
mat_Sqrt:  [[0.15]]
grads:  [0.03896461]
Stock Position:  0.03896460662052484
Bond Position:  [-0.56699008]


portfolio before change:  [3.20317217]
curr_Stock_Price:  96.76045670015397
curr_Factors:  [96.7604567]
mat_Sqrt:  [[0.15]]
grads:  [-0.06373541]
Stock Position:  -0.06373541380521217
Bond Position:  [9.37023992]


portfolio before change:  [3.21629233]
curr_Stock_Price:  96.57298161957561
curr_Factors:  [96.57298162]
mat_Sqrt:  [[0.15]]
grads:  [0.05057661]
Stock Position:  0.05057660734977317
Bond Position:  [-1.66804145]


portfolio before change:  [3.23159285]
curr_Stock_Price:  96.87962623597252
curr_Factors:  [96.87962624]
mat_Sqrt:  [[0.15]]
grads:  [0.09263667]
Stock Position:  0.0926366677611201
Bond Position:  [-5.7430129]


portfolio before change:  [3.28145602]
curr_Stock_Price:  97.42564208507753
curr_Factors:  [97.42564209]
mat_Sqrt:  [[0.15]]
grads:  [0.01352625]
Stock Position:  0.013526252290986408
Bond Position:  [1.96365221]


portfolio before change:  [3.29538473]
curr_Stock_Price:  98.43724778166623
curr_Factors:  [98.43724778]
mat_Sqrt:  [[0.15]]
grads:  [0.03643098]
Stock Position:  0.03643097675413835
Bond Position:  [-0.29078036]


portfolio before change:  [3.31395622]
curr_Stock_Price:  98.94801757073104
curr_Factors:  [98.94801757]
mat_Sqrt:  [[0.15]]
grads:  [-0.0217257]
Stock Position:  -0.021725704125393798
Bond Position:  [5.46367157]


portfolio before change:  [3.31811742]
curr_Stock_Price:  98.78792149762862
curr_Factors:  [98.7879215]
mat_Sqrt:  [[0.15]]
grads:  [0.08355491]
Stock Position:  0.08355490970801774
Bond Position:  [-4.93609844]


portfolio before change:  [3.3849033]
curr_Stock_Price:  99.59461174888874
curr_Factors:  [99.59461175]
mat_Sqrt:  [[0.15]]
grads:  [0.0205959]
Stock Position:  0.020595899371588743
Bond Position:  [1.3336627]


portfolio before change:  [3.39745974]
curr_Stock_Price:  100.19617429354012
curr_Factors:  [100.19617429]
mat_Sqrt:  [[0.15]]
grads:  [0.07730551]
Stock Position:  0.07730550673594755
Bond Position:  [-4.34825629]


portfolio before change:  [3.35544739]
curr_Stock_Price:  99.65974695422189
curr_Factors:  [99.65974695]
mat_Sqrt:  [[0.15]]
grads:  [-0.08231289]
Stock Position:  -0.08231289304488372
Bond Position:  [11.55872948]


portfolio before change:  [3.34145662]
curr_Stock_Price:  99.84727160923651
curr_Factors:  [99.84727161]
mat_Sqrt:  [[0.15]]
grads:  [-0.02698122]
Stock Position:  -0.02698122309140613
Bond Position:  [6.03545813]


portfolio before change:  [3.35674244]
curr_Stock_Price:  99.3086994561068
curr_Factors:  [99.30869946]
mat_Sqrt:  [[0.15]]
grads:  [0.05888984]
Stock Position:  0.05888984427323787
Bond Position:  [-2.49153141]


portfolio before change:  [3.31777105]
curr_Stock_Price:  98.65222086662254
curr_Factors:  [98.65222087]
mat_Sqrt:  [[0.15]]
grads:  [0.12109278]
Stock Position:  0.1210927842754899
Bond Position:  [-8.62830105]


portfolio before change:  [3.40140712]
curr_Stock_Price:  99.35180569625388
curr_Factors:  [99.3518057]
mat_Sqrt:  [[0.15]]
grads:  [0.03440145]
Stock Position:  0.03440145140291901
Bond Position:  [-0.01643919]


portfolio before change:  [3.39506304]
curr_Stock_Price:  99.16745225799961
curr_Factors:  [99.16745226]
mat_Sqrt:  [[0.15]]
grads:  [0.04952136]
Stock Position:  0.04952135895657107
Bond Position:  [-1.51584396]


portfolio before change:  [3.46049857]
curr_Stock_Price:  100.4926384280128
curr_Factors:  [100.49263843]
mat_Sqrt:  [[0.15]]
grads:  [-0.05655615]
Stock Position:  -0.056556151507915674
Bond Position:  [9.14397545]


portfolio before change:  [3.44846485]
curr_Stock_Price:  100.72562433645491
curr_Factors:  [100.72562434]
mat_Sqrt:  [[0.15]]
grads:  [0.01941867]
Stock Position:  0.01941867110594403
Bond Position:  [1.49250708]


portfolio before change:  [3.43578622]
curr_Stock_Price:  100.06310708920708
curr_Factors:  [100.06310709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07034142]
Stock Position:  -0.07034142162253602
Bond Position:  [10.47436743]


portfolio before change:  [3.44144861]
curr_Stock_Price:  100.00122313081842
curr_Factors:  [100.00122313]
mat_Sqrt:  [[0.15]]
grads:  [-0.11762867]
Stock Position:  -0.11762867253005664
Bond Position:  [15.20445973]


portfolio before change:  [3.5142613]
curr_Stock_Price:  99.39837673866947
curr_Factors:  [99.39837674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03069091]
Stock Position:  -0.030690908739082052
Bond Position:  [6.56488781]


portfolio before change:  [3.51848113]
curr_Stock_Price:  99.28762205989737
curr_Factors:  [99.28762206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02262773]
Stock Position:  -0.022627728879074355
Bond Position:  [5.76513452]


portfolio before change:  [3.52167454]
curr_Stock_Price:  99.17834344952021
curr_Factors:  [99.17834345]
mat_Sqrt:  [[0.15]]
grads:  [0.03734332]
Stock Position:  0.03734331551209796
Bond Position:  [-0.18197363]


portfolio before change:  [3.51245983]
curr_Stock_Price:  98.93219602283908
curr_Factors:  [98.93219602]
mat_Sqrt:  [[0.15]]
grads:  [0.04420242]
Stock Position:  0.04420241630759596
Bond Position:  [-0.86058228]


portfolio before change:  [3.54803247]
curr_Stock_Price:  99.73939673229377
curr_Factors:  [99.73939673]
mat_Sqrt:  [[0.15]]
grads:  [-0.07870057]
Stock Position:  -0.07870056688846495
Bond Position:  [11.39757954]


portfolio before change:  [3.6050225]
curr_Stock_Price:  99.03336315378368
curr_Factors:  [99.03336315]
mat_Sqrt:  [[0.15]]
grads:  [0.0729837]
Stock Position:  0.07298370452966234
Bond Position:  [-3.62279921]


portfolio before change:  [3.47323528]
curr_Stock_Price:  97.23386080037538
curr_Factors:  [97.2338608]
mat_Sqrt:  [[0.15]]
grads:  [0.03786208]
Stock Position:  0.03786208286118618
Bond Position:  [-0.20824122]


portfolio before change:  [3.45106515]
curr_Stock_Price:  96.6489987228748
curr_Factors:  [96.64899872]
mat_Sqrt:  [[0.15]]
grads:  [0.02390098]
Stock Position:  0.02390098165400256
Bond Position:  [1.1410592]


portfolio before change:  [3.42599093]
curr_Stock_Price:  95.59394336584116
curr_Factors:  [95.59394337]
mat_Sqrt:  [[0.15]]
grads:  [0.0712086]
Stock Position:  0.07120860344028705
Bond Position:  [-3.38112027]


portfolio before change:  [3.40621621]
curr_Stock_Price:  95.32217767212266
curr_Factors:  [95.32217767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.40621621]
Stock Price:  95.53365520248059
PL:  [3.40621621]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.98005177e-03]
 [ 4.59890454e-03]
 [ 9.93569207e-03]
 [-1.13877751e-03]
 [ 1.53582963e-02]
 [ 2.56615857e-02]
 [ 1.55055066e-03]
 [ 2.27494576e-02]
 [-5.91015464e-03]
 [ 1.32501581e-03]
 [ 6.29809397e-03]
 [ 4.06346109e-03]
 [ 1.17499515e-02]
 [ 3.35815233e-03]
 [ 2.21239932e-02]
 [-6.82539266e-04]
 [ 9.77020305e-03]
 [ 7.03332023e-03]
 [ 9.89294264e-03]
 [-5.13729447e-03]
 [ 1.46671193e-02]
 [-1.99090464e-03]
 [ 2.32919684e-02]
 [ 3.03010891e-03]
 [ 1.52348213e-02]
 [-1.06484870e-02]
 [ 1.69230650e-02]
 [-1.85425157e-02]
 [-4.77048693e-02]
 [-1.12409025e-04]
 [-4.04291035e-03]
 [ 5.58282769e-03]
 [ 1.32239304e-02]
 [-1.28576517e-02]
 [ 2.98227686e-03]
 [ 5.71073344e-03]
 [ 3.61658673e-03]
 [ 1.17361365e-02]
 [-3.54681399e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.66847196]
curr_Stock_Price:  100.11071486002659
curr_Factors:  [100.11071486]
mat_Sqrt:  [[0.15]]
grads:  [0.03320035]
Stock Position:  0.03320034510685784
Bond Position:  [0.34476168]


portfolio before change:  [3.66887642]
curr_Stock_Price:  100.12159906122875
curr_Factors:  [100.12159906]
mat_Sqrt:  [[0.15]]
grads:  [0.03065936]
Stock Position:  0.030659363616914667
Bond Position:  [0.59921191]


portfolio before change:  [3.67928095]
curr_Stock_Price:  100.4585148155475
curr_Factors:  [100.45851482]
mat_Sqrt:  [[0.15]]
grads:  [0.06623795]
Stock Position:  0.0662379471599303
Bond Position:  [-2.97488485]


portfolio before change:  [3.70731988]
curr_Stock_Price:  100.88743544151163
curr_Factors:  [100.88743544]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759185]
Stock Position:  -0.0075918500355554525
Bond Position:  [4.47324216]


portfolio before change:  [3.7102742]
curr_Stock_Price:  100.57194945442512
curr_Factors:  [100.57194945]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-6.58715114]


portfolio before change:  [3.71867238]
curr_Stock_Price:  100.66201437945764
curr_Factors:  [100.66201438]
mat_Sqrt:  [[0.15]]
grads:  [0.17107724]
Stock Position:  0.17107723801477678
Bond Position:  [-13.50230702]


portfolio before change:  [3.68455111]
curr_Stock_Price:  100.47243118007914
curr_Factors:  [100.47243118]
mat_Sqrt:  [[0.15]]
grads:  [0.010337]
Stock Position:  0.010337004378825922
Bond Position:  [2.64596715]


portfolio before change:  [3.67828242]
curr_Stock_Price:  99.83400086230262
curr_Factors:  [99.83400086]
mat_Sqrt:  [[0.15]]
grads:  [0.15166305]
Stock Position:  0.15166305078804243
Bond Position:  [-11.46284672]


portfolio before change:  [3.74759497]
curr_Stock_Price:  100.30046578876744
curr_Factors:  [100.30046579]
mat_Sqrt:  [[0.15]]
grads:  [-0.03940103]
Stock Position:  -0.03940103092650939
Bond Position:  [7.69953672]


portfolio before change:  [3.74933084]
curr_Stock_Price:  100.28083772102563
curr_Factors:  [100.28083772]
mat_Sqrt:  [[0.15]]
grads:  [0.00883344]
Stock Position:  0.008833438723469523
Bond Position:  [2.8635062]


portfolio before change:  [3.74653873]
curr_Stock_Price:  99.92422991671314
curr_Factors:  [99.92422992]
mat_Sqrt:  [[0.15]]
grads:  [0.04198729]
Stock Position:  0.041987293160164696
Bond Position:  [-0.44900921]


portfolio before change:  [3.75701698]
curr_Stock_Price:  100.17512447631827
curr_Factors:  [100.17512448]
mat_Sqrt:  [[0.15]]
grads:  [0.02708974]
Stock Position:  0.02708974057631843
Bond Position:  [1.04329885]


portfolio before change:  [3.76146091]
curr_Stock_Price:  100.33435479084031
curr_Factors:  [100.33435479]
mat_Sqrt:  [[0.15]]
grads:  [0.07833301]
Stock Position:  0.07833300978696846
Bond Position:  [-4.09803109]


portfolio before change:  [3.76331367]
curr_Stock_Price:  100.36454699136523
curr_Factors:  [100.36454699]
mat_Sqrt:  [[0.15]]
grads:  [0.02238768]
Stock Position:  0.022387682181718636
Bond Position:  [1.51638409]


portfolio before change:  [3.76886884]
curr_Stock_Price:  100.6042151859907
curr_Factors:  [100.60421519]
mat_Sqrt:  [[0.15]]
grads:  [0.14749329]
Stock Position:  0.1474932880978095
Bond Position:  [-11.06957765]


portfolio before change:  [3.7043318]
curr_Stock_Price:  100.17603801046766
curr_Factors:  [100.17603801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00455026]
Stock Position:  -0.004550261773651994
Bond Position:  [4.160159]


portfolio before change:  [3.70615535]
curr_Stock_Price:  99.88957104404498
curr_Factors:  [99.88957104]
mat_Sqrt:  [[0.15]]
grads:  [0.06513469]
Stock Position:  0.06513468696774909
Bond Position:  [-2.80012059]


portfolio before change:  [3.70978176]
curr_Stock_Price:  99.9506206457344
curr_Factors:  [99.95062065]
mat_Sqrt:  [[0.15]]
grads:  [0.0468888]
Stock Position:  0.04688880154762573
Bond Position:  [-0.97678305]


portfolio before change:  [3.66909568]
curr_Stock_Price:  99.08551061576158
curr_Factors:  [99.08551062]
mat_Sqrt:  [[0.15]]
grads:  [0.06595295]
Stock Position:  0.06595295095864512
Bond Position:  [-2.86588614]


portfolio before change:  [3.59180283]
curr_Stock_Price:  97.91900340702844
curr_Factors:  [97.91900341]
mat_Sqrt:  [[0.15]]
grads:  [-0.03424863]
Stock Position:  -0.03424862980062877
Bond Position:  [6.94539453]


portfolio before change:  [3.58404584]
curr_Stock_Price:  98.17084488415708
curr_Factors:  [98.17084488]
mat_Sqrt:  [[0.15]]
grads:  [0.0977808]
Stock Position:  0.09778079545376606
Bond Position:  [-6.01517747]


portfolio before change:  [3.4923214]
curr_Stock_Price:  97.24047307831286
curr_Factors:  [97.24047308]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132727]
Stock Position:  -0.013272697615053723
Bond Position:  [4.78296479]


portfolio before change:  [3.49733436]
curr_Stock_Price:  96.90783088201316
curr_Factors:  [96.90783088]
mat_Sqrt:  [[0.15]]
grads:  [0.15527979]
Stock Position:  0.15527978956138178
Bond Position:  [-11.55049322]


portfolio before change:  [3.30235834]
curr_Stock_Price:  95.66148632272484
curr_Factors:  [95.66148632]
mat_Sqrt:  [[0.15]]
grads:  [0.02020073]
Stock Position:  0.020200726052120175
Bond Position:  [1.36992686]


portfolio before change:  [3.32124948]
curr_Stock_Price:  96.58818035326567
curr_Factors:  [96.58818035]
mat_Sqrt:  [[0.15]]
grads:  [0.10156548]
Stock Position:  0.10156547546781329
Bond Position:  [-6.48877498]


portfolio before change:  [3.39939694]
curr_Stock_Price:  97.36559615316662
curr_Factors:  [97.36559615]
mat_Sqrt:  [[0.15]]
grads:  [-0.07098991]
Stock Position:  -0.07098991323705169
Bond Position:  [10.31137217]


portfolio before change:  [3.37767503]
curr_Stock_Price:  97.68973960950657
curr_Factors:  [97.68973961]
mat_Sqrt:  [[0.15]]
grads:  [0.11282043]
Stock Position:  0.11282043320633574
Bond Position:  [-7.64372371]


portfolio before change:  [3.29698569]
curr_Stock_Price:  96.98300760662565
curr_Factors:  [96.98300761]
mat_Sqrt:  [[0.15]]
grads:  [-0.12361677]
Stock Position:  -0.1236167716241716
Bond Position:  [15.285712]


portfolio before change:  [3.42595637]
curr_Stock_Price:  95.95515480561025
curr_Factors:  [95.95515481]
mat_Sqrt:  [[0.15]]
grads:  [-0.31803246]
Stock Position:  -0.31803246226836107
Bond Position:  [33.94281052]


portfolio before change:  [3.15427944]
curr_Stock_Price:  96.82273934176123
curr_Factors:  [96.82273934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074939]
Stock Position:  -0.0007493934989984015
Bond Position:  [3.22683777]


portfolio before change:  [3.15470951]
curr_Stock_Price:  96.78712993022249
curr_Factors:  [96.78712993]
mat_Sqrt:  [[0.15]]
grads:  [-0.02695274]
Stock Position:  -0.026952735635417988
Bond Position:  [5.76338743]


portfolio before change:  [3.16976537]
curr_Stock_Price:  96.25525840345443
curr_Factors:  [96.2552584]
mat_Sqrt:  [[0.15]]
grads:  [0.03721885]
Stock Position:  0.03721885127459125
Bond Position:  [-0.41274478]


portfolio before change:  [3.15157278]
curr_Stock_Price:  95.76784446450178
curr_Factors:  [95.76784446]
mat_Sqrt:  [[0.15]]
grads:  [0.08815954]
Stock Position:  0.08815953569326881
Bond Position:  [-5.29127592]


portfolio before change:  [3.23625399]
curr_Stock_Price:  96.73589240359097
curr_Factors:  [96.7358924]
mat_Sqrt:  [[0.15]]
grads:  [-0.08571768]
Stock Position:  -0.08571767771855816
Bond Position:  [11.52823004]


portfolio before change:  [3.22338406]
curr_Stock_Price:  96.90284802462735
curr_Factors:  [96.90284802]
mat_Sqrt:  [[0.15]]
grads:  [0.01988185]
Stock Position:  0.019881845702179112
Bond Position:  [1.29677659]


portfolio before change:  [3.23668102]
curr_Stock_Price:  97.56349362115185
curr_Factors:  [97.56349362]
mat_Sqrt:  [[0.15]]
grads:  [0.03807156]
Stock Position:  0.03807155626383191
Bond Position:  [-0.47771301]


portfolio before change:  [3.21839048]
curr_Stock_Price:  97.08463681377575
curr_Factors:  [97.08463681]
mat_Sqrt:  [[0.15]]
grads:  [0.02411058]
Stock Position:  0.024110578202574093
Bond Position:  [0.87762375]


portfolio before change:  [3.22137002]
curr_Stock_Price:  97.20366457958143
curr_Factors:  [97.20366458]
mat_Sqrt:  [[0.15]]
grads:  [0.07824091]
Stock Position:  0.07824090978020412
Bond Position:  [-4.38393313]


portfolio before change:  [3.137423]
curr_Stock_Price:  96.13773895586145
curr_Factors:  [96.13773896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.137423]
Stock Price:  97.22743420769193
PL:  [3.137423]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.32658510e-03]
 [-7.99277178e-03]
 [-1.14035786e-03]
 [-2.62161474e-03]
 [ 1.53582963e-02]
 [ 2.23684162e-02]
 [-1.45244272e-04]
 [ 1.01127482e-02]
 [-9.09918100e-03]
 [-3.02190630e-03]
 [ 1.61771377e-02]
 [ 6.65893686e-03]
 [ 1.06982779e-02]
 [ 4.17505280e-04]
 [ 2.41793973e-02]
 [ 2.68843461e-04]
 [ 9.62360870e-03]
 [ 1.12573500e-02]
 [ 1.14432434e-02]
 [-1.47604096e-02]
 [-5.35662625e-03]
 [ 2.86945775e-02]
 [-3.41774865e-02]
 [ 5.60928017e-03]
 [-1.56967026e-03]
 [-8.87084612e-03]
 [-9.91907647e-04]
 [-1.08452921e-02]
 [ 2.36618103e-02]
 [-1.08433919e-02]
 [ 1.64727912e-04]
 [ 5.00598929e-03]
 [ 5.11408556e-03]
 [-6.75538569e-03]
 [ 2.10645574e-02]
 [ 5.49619273e-03]
 [-4.59163984e-03]
 [ 8.97230596e-03]
 [-1.63255835e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.54617435]
curr_Stock_Price:  98.806680779581
curr_Factors:  [98.80668078]
mat_Sqrt:  [[0.15]]
grads:  [0.06217723]
Stock Position:  0.06217723402467895
Bond Position:  [-22.68970046]


portfolio before change:  [-16.53599065]
curr_Stock_Price:  99.01608363812588
curr_Factors:  [99.01608364]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328515]
Stock Position:  -0.05328514517973653
Bond Position:  [-11.25990425]


portfolio before change:  [-16.55267139]
curr_Stock_Price:  99.30271445355193
curr_Factors:  [99.30271445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00760239]
Stock Position:  -0.007602385735231919
Bond Position:  [-15.79773385]


portfolio before change:  [-16.56476878]
curr_Stock_Price:  100.63421174652748
curr_Factors:  [100.63421175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01747743]
Stock Position:  -0.017477431574069984
Bond Position:  [-14.80594123]


portfolio before change:  [-16.5666891]
curr_Stock_Price:  100.63818609660838
curr_Factors:  [100.6381861]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-26.87089632]


portfolio before change:  [-16.59390614]
curr_Stock_Price:  100.40517228247734
curr_Factors:  [100.40517228]
mat_Sqrt:  [[0.15]]
grads:  [0.14912277]
Stock Position:  0.14912277445727273
Bond Position:  [-31.566604]


portfolio before change:  [-16.44170694]
curr_Stock_Price:  101.45226432494509
curr_Factors:  [101.45226432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0009683]
Stock Position:  -0.0009682951487269045
Bond Position:  [-16.34347121]


portfolio before change:  [-16.44413602]
curr_Stock_Price:  101.85091802062077
curr_Factors:  [101.85091802]
mat_Sqrt:  [[0.15]]
grads:  [0.06741832]
Stock Position:  0.0674183214488489
Bond Position:  [-23.31075395]


portfolio before change:  [-16.41573586]
curr_Stock_Price:  102.31539387583217
curr_Factors:  [102.31539388]
mat_Sqrt:  [[0.15]]
grads:  [-0.06066121]
Stock Position:  -0.060661206677886034
Bond Position:  [-10.20916061]


portfolio before change:  [-16.42985213]
curr_Stock_Price:  102.52706189156874
curr_Factors:  [102.52706189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014604]
Stock Position:  -0.020146041968477912
Bond Position:  [-14.36433763]


portfolio before change:  [-16.43715235]
curr_Stock_Price:  102.80029520111812
curr_Factors:  [102.8002952]
mat_Sqrt:  [[0.15]]
grads:  [0.10784758]
Stock Position:  0.10784758481211014
Bond Position:  [-27.52391591]


portfolio before change:  [-16.46015633]
curr_Stock_Price:  102.61889779189673
curr_Factors:  [102.61889779]
mat_Sqrt:  [[0.15]]
grads:  [0.04439291]
Stock Position:  0.044392912380293297
Bond Position:  [-21.01570807]


portfolio before change:  [-16.51713808]
curr_Stock_Price:  101.3944991187774
curr_Factors:  [101.39449912]
mat_Sqrt:  [[0.15]]
grads:  [0.07132185]
Stock Position:  0.07132185263246121
Bond Position:  [-23.7487816]


portfolio before change:  [-16.56574245]
curr_Stock_Price:  100.75464483490896
curr_Factors:  [100.75464483]
mat_Sqrt:  [[0.15]]
grads:  [0.00278337]
Stock Position:  0.002783368531397134
Bond Position:  [-16.84617976]


portfolio before change:  [-16.56743254]
curr_Stock_Price:  100.90403690287773
curr_Factors:  [100.9040369]
mat_Sqrt:  [[0.15]]
grads:  [0.16119598]
Stock Position:  0.16119598182883088
Bond Position:  [-32.83275784]


portfolio before change:  [-16.64417403]
curr_Stock_Price:  100.45342309555365
curr_Factors:  [100.4534231]
mat_Sqrt:  [[0.15]]
grads:  [0.00179229]
Stock Position:  0.001792289738862389
Bond Position:  [-16.82421567]


portfolio before change:  [-16.64707867]
curr_Stock_Price:  100.00624190689803
curr_Factors:  [100.00624191]
mat_Sqrt:  [[0.15]]
grads:  [0.06415739]
Stock Position:  0.06415739134708286
Bond Position:  [-23.06321827]


portfolio before change:  [-16.62894437]
curr_Stock_Price:  100.3338327777069
curr_Factors:  [100.33383278]
mat_Sqrt:  [[0.15]]
grads:  [0.075049]
Stock Position:  0.0750490000873001
Bond Position:  [-24.1588982]


portfolio before change:  [-16.510738]
curr_Stock_Price:  101.94912972258905
curr_Factors:  [101.94912972]
mat_Sqrt:  [[0.15]]
grads:  [0.07628829]
Stock Position:  0.07628828939908634
Bond Position:  [-24.28826272]


portfolio before change:  [-16.45908602]
curr_Stock_Price:  102.66599208972893
curr_Factors:  [102.66599209]
mat_Sqrt:  [[0.15]]
grads:  [-0.09840273]
Stock Position:  -0.09840273097125207
Bond Position:  [-6.35647202]


portfolio before change:  [-16.44173547]
curr_Stock_Price:  102.48159511789414
curr_Factors:  [102.48159512]
mat_Sqrt:  [[0.15]]
grads:  [-0.03571084]
Stock Position:  -0.03571084168710453
Bond Position:  [-12.78203145]


portfolio before change:  [-16.46749439]
curr_Stock_Price:  103.15817025001914
curr_Factors:  [103.15817025]
mat_Sqrt:  [[0.15]]
grads:  [0.19129718]
Stock Position:  0.19129718342160837
Bond Position:  [-36.2013618]


portfolio before change:  [-16.62292806]
curr_Stock_Price:  102.36930230650756
curr_Factors:  [102.36930231]
mat_Sqrt:  [[0.15]]
grads:  [-0.22784991]
Stock Position:  -0.22784991009490682
Bond Position:  [6.70190827]


portfolio before change:  [-16.66723082]
curr_Stock_Price:  102.56741763035905
curr_Factors:  [102.56741763]
mat_Sqrt:  [[0.15]]
grads:  [0.0373952]
Stock Position:  0.03739520115440723
Bond Position:  [-20.50276004]


portfolio before change:  [-16.6674045]
curr_Stock_Price:  102.63131157463219
curr_Factors:  [102.63131157]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046447]
Stock Position:  -0.010464468432829211
Bond Position:  [-15.59342238]


portfolio before change:  [-16.67434926]
curr_Stock_Price:  103.10868474384968
curr_Factors:  [103.10868474]
mat_Sqrt:  [[0.15]]
grads:  [-0.05913897]
Stock Position:  -0.059138974132963984
Bond Position:  [-10.57660742]


portfolio before change:  [-16.65830974]
curr_Stock_Price:  102.81511058885303
curr_Factors:  [102.81511059]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661272]
Stock Position:  -0.006612717644168759
Bond Position:  [-15.97842245]


portfolio before change:  [-16.66025512]
curr_Stock_Price:  102.80723980592361
curr_Factors:  [102.80723981]
mat_Sqrt:  [[0.15]]
grads:  [-0.07230195]
Stock Position:  -0.07230194716182485
Bond Position:  [-9.2270915]


portfolio before change:  [-16.61832091]
curr_Stock_Price:  102.21129917890731
curr_Factors:  [102.21129918]
mat_Sqrt:  [[0.15]]
grads:  [0.1577454]
Stock Position:  0.15774540178882682
Bond Position:  [-32.74168337]


portfolio before change:  [-16.66385624]
curr_Stock_Price:  101.94858244721016
curr_Factors:  [101.94858245]
mat_Sqrt:  [[0.15]]
grads:  [-0.07228928]
Stock Position:  -0.07228927933008343
Bond Position:  [-9.29406668]


portfolio before change:  [-16.69626102]
curr_Stock_Price:  102.38077590815423
curr_Factors:  [102.38077591]
mat_Sqrt:  [[0.15]]
grads:  [0.00109819]
Stock Position:  0.001098186081945846
Bond Position:  [-16.80869416]


portfolio before change:  [-16.69801001]
curr_Stock_Price:  102.70151485139648
curr_Factors:  [102.70151485]
mat_Sqrt:  [[0.15]]
grads:  [0.03337326]
Stock Position:  0.03337326190332955
Bond Position:  [-20.12549456]


portfolio before change:  [-16.71162694]
curr_Stock_Price:  102.3688806091846
curr_Factors:  [102.36888061]
mat_Sqrt:  [[0.15]]
grads:  [0.0340939]
Stock Position:  0.0340939037223666
Bond Position:  [-20.2017817]


portfolio before change:  [-16.7373147]
curr_Stock_Price:  101.68951063842248
curr_Factors:  [101.68951064]
mat_Sqrt:  [[0.15]]
grads:  [-0.0450359]
Stock Position:  -0.04503590456989843
Bond Position:  [-12.1576356]


portfolio before change:  [-16.73160115]
curr_Stock_Price:  101.52889783917897
curr_Factors:  [101.52889784]
mat_Sqrt:  [[0.15]]
grads:  [0.14043038]
Stock Position:  0.14043038276970723
Bond Position:  [-30.98934314]


portfolio before change:  [-16.86071109]
curr_Stock_Price:  100.63709637465337
curr_Factors:  [100.63709637]
mat_Sqrt:  [[0.15]]
grads:  [0.03664128]
Stock Position:  0.03664128485321265
Bond Position:  [-20.5481836]


portfolio before change:  [-16.78538239]
curr_Stock_Price:  102.76304207683098
curr_Factors:  [102.76304208]
mat_Sqrt:  [[0.15]]
grads:  [-0.03061093]
Stock Position:  -0.030610932292489703
Bond Position:  [-13.63970986]


portfolio before change:  [-16.78718026]
curr_Stock_Price:  102.76607379353958
curr_Factors:  [102.76607379]
mat_Sqrt:  [[0.15]]
grads:  [0.05981537]
Stock Position:  0.059815373093993415
Bond Position:  [-22.93417131]


portfolio before change:  [-16.78346258]
curr_Stock_Price:  102.87615643598947
curr_Factors:  [102.87615644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.78346258]
Stock Price:  104.15364152028322
PL:  [-20.9371041]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.29626295e-03]
 [-7.35376972e-03]
 [ 3.47936749e-03]
 [-2.08799210e-04]
 [ 1.48686924e-02]
 [ 1.99919513e-02]
 [-2.37961870e-04]
 [ 1.94900757e-02]
 [-5.89765585e-03]
 [ 1.57745954e-03]
 [ 7.87384607e-03]
 [ 4.90669394e-03]
 [ 1.39110591e-02]
 [ 2.43685416e-03]
 [ 4.72657030e-04]
 [-3.55695042e-03]
 [ 1.23962430e-02]
 [-9.02394921e-03]
 [ 4.00416994e-03]
 [-2.59724989e-03]
 [ 1.61005117e-02]
 [ 9.68627256e-04]
 [ 1.98524182e-02]
 [ 4.63545780e-03]
 [ 1.70942704e-02]
 [-1.00520989e-02]
 [ 1.93537064e-02]
 [-2.09697204e-02]
 [-4.76492505e-02]
 [-2.67005261e-06]
 [-4.08094599e-03]
 [ 5.61621982e-03]
 [ 6.74244467e-03]
 [-1.19348814e-02]
 [ 1.39837175e-02]
 [ 5.49167598e-03]
 [ 2.80362844e-03]
 [ 9.02405467e-03]
 [-9.07877328e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.05222763]
curr_Stock_Price:  99.54814803130859
curr_Factors:  [99.54814803]
mat_Sqrt:  [[0.15]]
grads:  [0.02864175]
Stock Position:  0.028641752983136756
Bond Position:  [-7.90346109]


portfolio before change:  [-5.0671477]
curr_Stock_Price:  99.06172268889223
curr_Factors:  [99.06172269]
mat_Sqrt:  [[0.15]]
grads:  [-0.04902513]
Stock Position:  -0.04902513146878419
Bond Position:  [-0.21063372]


portfolio before change:  [-5.08801604]
curr_Stock_Price:  99.48685186164461
curr_Factors:  [99.48685186]
mat_Sqrt:  [[0.15]]
grads:  [0.02319578]
Stock Position:  0.023195783284217134
Bond Position:  [-7.3956915]


portfolio before change:  [-5.10661152]
curr_Stock_Price:  98.72503422192707
curr_Factors:  [98.72503422]
mat_Sqrt:  [[0.15]]
grads:  [-0.00139199]
Stock Position:  -0.0013919947356257239
Bond Position:  [-4.96918679]


portfolio before change:  [-5.10917551]
curr_Stock_Price:  100.12073344648745
curr_Factors:  [100.12073345]
mat_Sqrt:  [[0.15]]
grads:  [0.09912462]
Stock Position:  0.09912461627486373
Bond Position:  [-15.03360479]


portfolio before change:  [-5.09852921]
curr_Stock_Price:  100.24709573110584
curr_Factors:  [100.24709573]
mat_Sqrt:  [[0.15]]
grads:  [0.13327968]
Stock Position:  0.1332796754574706
Bond Position:  [-18.4594296]


portfolio before change:  [-5.04536504]
curr_Stock_Price:  100.6633013058493
curr_Factors:  [100.66330131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158641]
Stock Position:  -0.0015864124668663454
Bond Position:  [-4.88567153]


portfolio before change:  [-5.04563794]
curr_Stock_Price:  100.45033427854078
curr_Factors:  [100.45033428]
mat_Sqrt:  [[0.15]]
grads:  [0.12993384]
Stock Position:  0.12993383802839237
Bond Position:  [-18.0975354]


portfolio before change:  [-5.15189775]
curr_Stock_Price:  99.64994635405776
curr_Factors:  [99.64994635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03931771]
Stock Position:  -0.0393177056855771
Bond Position:  [-1.23389048]


portfolio before change:  [-5.17417553]
curr_Stock_Price:  100.21263269499845
curr_Factors:  [100.21263269]
mat_Sqrt:  [[0.15]]
grads:  [0.0105164]
Stock Position:  0.010516396954381042
Bond Position:  [-6.22805135]


portfolio before change:  [-5.17563224]
curr_Stock_Price:  100.14814660574255
curr_Factors:  [100.14814661]
mat_Sqrt:  [[0.15]]
grads:  [0.05249231]
Stock Position:  0.052492307113862345
Bond Position:  [-10.43263951]


portfolio before change:  [-5.20523882]
curr_Stock_Price:  99.60897398344926
curr_Factors:  [99.60897398]
mat_Sqrt:  [[0.15]]
grads:  [0.03271129]
Stock Position:  0.03271129291364246
Bond Position:  [-8.46357714]


portfolio before change:  [-5.26107543]
curr_Stock_Price:  97.93436594220832
curr_Factors:  [97.93436594]
mat_Sqrt:  [[0.15]]
grads:  [0.09274039]
Stock Position:  0.0927403941360798
Bond Position:  [-14.34354712]


portfolio before change:  [-5.26908536]
curr_Stock_Price:  97.86733062280372
curr_Factors:  [97.86733062]
mat_Sqrt:  [[0.15]]
grads:  [0.01624569]
Stock Position:  0.016245694383748926
Bond Position:  [-6.85900811]


portfolio before change:  [-5.27840437]
curr_Stock_Price:  97.34647997558363
curr_Factors:  [97.34647998]
mat_Sqrt:  [[0.15]]
grads:  [0.00315105]
Stock Position:  0.0031510468646463695
Bond Position:  [-5.5851477]


portfolio before change:  [-5.27844349]
curr_Stock_Price:  97.55564035304249
curr_Factors:  [97.55564035]
mat_Sqrt:  [[0.15]]
grads:  [-0.023713]
Stock Position:  -0.023713002788092463
Bond Position:  [-2.96510632]


portfolio before change:  [-5.30929966]
curr_Stock_Price:  98.84124353402422
curr_Factors:  [98.84124353]
mat_Sqrt:  [[0.15]]
grads:  [0.08264162]
Stock Position:  0.08264161999774636
Bond Position:  [-13.47770015]


portfolio before change:  [-5.39222303]
curr_Stock_Price:  97.85822125035907
curr_Factors:  [97.85822125]
mat_Sqrt:  [[0.15]]
grads:  [-0.06015966]
Stock Position:  -0.06015966141003529
Bond Position:  [0.49489442]


portfolio before change:  [-5.31640687]
curr_Stock_Price:  96.5990003685057
curr_Factors:  [96.59900037]
mat_Sqrt:  [[0.15]]
grads:  [0.02669447]
Stock Position:  0.026694466233692447
Bond Position:  [-7.89506562]


portfolio before change:  [-5.30228951]
curr_Stock_Price:  97.16482166748148
curr_Factors:  [97.16482167]
mat_Sqrt:  [[0.15]]
grads:  [-0.017315]
Stock Position:  -0.01731499926509266
Bond Position:  [-3.6198807]


portfolio before change:  [-5.31690641]
curr_Stock_Price:  97.98286296477471
curr_Factors:  [97.98286296]
mat_Sqrt:  [[0.15]]
grads:  [0.10733674]
Stock Position:  0.107336744712762
Bond Position:  [-15.83406796]


portfolio before change:  [-5.29393481]
curr_Stock_Price:  98.21531811685676
curr_Factors:  [98.21531812]
mat_Sqrt:  [[0.15]]
grads:  [0.00645752]
Stock Position:  0.0064575150424418
Bond Position:  [-5.92816171]


portfolio before change:  [-5.2958524]
curr_Stock_Price:  98.03312359903605
curr_Factors:  [98.0331236]
mat_Sqrt:  [[0.15]]
grads:  [0.13234945]
Stock Position:  0.13234945463725364
Bond Position:  [-18.27048285]


portfolio before change:  [-5.32636152]
curr_Stock_Price:  97.81986122102956
curr_Factors:  [97.81986122]
mat_Sqrt:  [[0.15]]
grads:  [0.03090305]
Stock Position:  0.030903051999752983
Bond Position:  [-8.34929377]


portfolio before change:  [-5.33165625]
curr_Stock_Price:  97.68230173964592
curr_Factors:  [97.68230174]
mat_Sqrt:  [[0.15]]
grads:  [0.1139618]
Stock Position:  0.11396180264659779
Bond Position:  [-16.46370744]


portfolio before change:  [-5.40460571]
curr_Stock_Price:  97.06023921109464
curr_Factors:  [97.06023921]
mat_Sqrt:  [[0.15]]
grads:  [-0.06701399]
Stock Position:  -0.06701399287498694
Bond Position:  [1.09978847]


portfolio before change:  [-5.39830911]
curr_Stock_Price:  96.96833127777721
curr_Factors:  [96.96833128]
mat_Sqrt:  [[0.15]]
grads:  [0.12902471]
Stock Position:  0.12902470930813184
Bond Position:  [-17.90961987]


portfolio before change:  [-5.48572916]
curr_Stock_Price:  96.30813832522665
curr_Factors:  [96.30813833]
mat_Sqrt:  [[0.15]]
grads:  [-0.13979814]
Stock Position:  -0.13979813628902374
Bond Position:  [7.97796909]


portfolio before change:  [-5.38717224]
curr_Stock_Price:  95.61027772187862
curr_Factors:  [95.61027772]
mat_Sqrt:  [[0.15]]
grads:  [-0.31766167]
Stock Position:  -0.3176616699493958
Bond Position:  [24.98454825]


portfolio before change:  [-5.73674896]
curr_Stock_Price:  96.72057845438015
curr_Factors:  [96.72057845]
mat_Sqrt:  [[0.15]]
grads:  [-1.78003508e-05]
Stock Position:  -1.78003507522468e-05
Bond Position:  [-5.7350273]


portfolio before change:  [-5.73746217]
curr_Stock_Price:  96.51192434273179
curr_Factors:  [96.51192434]
mat_Sqrt:  [[0.15]]
grads:  [-0.02720631]
Stock Position:  -0.027206306573205927
Bond Position:  [-3.11172916]


portfolio before change:  [-5.76981328]
curr_Stock_Price:  97.6867299741474
curr_Factors:  [97.68672997]
mat_Sqrt:  [[0.15]]
grads:  [0.03744147]
Stock Position:  0.0374414654579005
Bond Position:  [-9.42734761]


portfolio before change:  [-5.72766764]
curr_Stock_Price:  98.84384623156126
curr_Factors:  [98.84384623]
mat_Sqrt:  [[0.15]]
grads:  [0.04494963]
Stock Position:  0.04494963112536996
Bond Position:  [-10.17066207]


portfolio before change:  [-5.71053791]
curr_Stock_Price:  99.25321883384703
curr_Factors:  [99.25321883]
mat_Sqrt:  [[0.15]]
grads:  [-0.07956588]
Stock Position:  -0.0795658760937834
Bond Position:  [2.1866314]


portfolio before change:  [-5.72249908]
curr_Stock_Price:  99.40698467271056
curr_Factors:  [99.40698467]
mat_Sqrt:  [[0.15]]
grads:  [0.09322478]
Stock Position:  0.0932247833953862
Bond Position:  [-14.98969369]


portfolio before change:  [-5.60736311]
curr_Stock_Price:  100.66212076795536
curr_Factors:  [100.66212077]
mat_Sqrt:  [[0.15]]
grads:  [0.03661117]
Stock Position:  0.036611173220248386
Bond Position:  [-9.29272145]


portfolio before change:  [-5.65407009]
curr_Stock_Price:  99.41809311088613
curr_Factors:  [99.41809311]
mat_Sqrt:  [[0.15]]
grads:  [0.01869086]
Stock Position:  0.01869085628607973
Bond Position:  [-7.51227938]


portfolio before change:  [-5.65478732]
curr_Stock_Price:  99.42996320985287
curr_Factors:  [99.42996321]
mat_Sqrt:  [[0.15]]
grads:  [0.06016036]
Stock Position:  0.0601603644654166
Bond Position:  [-11.63653015]


portfolio before change:  [-5.58535967]
curr_Stock_Price:  100.60818586343568
curr_Factors:  [100.60818586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.58535967]
Stock Price:  101.25508547930217
PL:  [-6.84044515]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.90509373e-03]
 [-8.86869959e-03]
 [-1.11799170e-02]
 [-1.66758337e-03]
 [-1.38757972e-02]
 [-2.61180689e-02]
 [-4.97051284e-02]
 [ 1.67279939e-02]
 [-6.40192461e-03]
 [ 3.64127649e-03]
 [-9.02522598e-03]
 [ 7.41335794e-03]
 [ 1.39108047e-02]
 [ 2.39180347e-03]
 [ 1.29389169e-02]
 [-2.80102368e-05]
 [ 1.00515114e-02]
 [ 1.30847772e-02]
 [ 1.14274002e-02]
 [-1.33050594e-02]
 [-1.39346617e-02]
 [ 2.26979035e-02]
 [-2.55018140e-02]
 [ 6.18397896e-03]
 [-7.42374598e-03]
 [-7.76286571e-03]
 [ 3.03130207e-03]
 [-1.13128844e-02]
 [ 3.92467795e-02]
 [-7.45090810e-03]
 [-1.95030466e-03]
 [ 4.89385247e-03]
 [ 5.43360546e-03]
 [-4.18125244e-03]
 [ 7.22851379e-03]
 [ 5.23735955e-03]
 [-7.34378832e-03]
 [ 9.70867310e-03]
 [-1.51902600e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.1913104]
curr_Stock_Price:  99.15211967446884
curr_Factors:  [99.15211967]
mat_Sqrt:  [[0.15]]
grads:  [0.04603396]
Stock Position:  0.04603395820753003
Bond Position:  [-15.75567493]


portfolio before change:  [-11.20242218]
curr_Stock_Price:  98.953522784903
curr_Factors:  [98.95352278]
mat_Sqrt:  [[0.15]]
grads:  [-0.05912466]
Stock Position:  -0.059124663925705256
Bond Position:  [-5.35182841]


portfolio before change:  [-11.18783928]
curr_Stock_Price:  98.69556072359212
curr_Factors:  [98.69556072]
mat_Sqrt:  [[0.15]]
grads:  [-0.07453278]
Stock Position:  -0.07453277990727526
Bond Position:  [-3.83178478]


portfolio before change:  [-11.2181624]
curr_Stock_Price:  99.09597671457331
curr_Factors:  [99.09597671]
mat_Sqrt:  [[0.15]]
grads:  [-0.01111722]
Stock Position:  -0.011117222465576709
Bond Position:  [-10.11649039]


portfolio before change:  [-11.21164439]
curr_Stock_Price:  98.39592323938803
curr_Factors:  [98.39592324]
mat_Sqrt:  [[0.15]]
grads:  [-0.09250531]
Stock Position:  -0.09250531461905323
Bond Position:  [-2.10949856]


portfolio before change:  [-11.18966825]
curr_Stock_Price:  98.15550625956537
curr_Factors:  [98.15550626]
mat_Sqrt:  [[0.15]]
grads:  [-0.17412046]
Stock Position:  -0.17412045938735468
Bond Position:  [5.90121359]


portfolio before change:  [-11.12737947]
curr_Stock_Price:  97.80200911918008
curr_Factors:  [97.80200912]
mat_Sqrt:  [[0.15]]
grads:  [-0.33136752]
Stock Position:  -0.3313675226588933
Bond Position:  [21.28103]


portfolio before change:  [-10.95489979]
curr_Stock_Price:  97.28952863814067
curr_Factors:  [97.28952864]
mat_Sqrt:  [[0.15]]
grads:  [0.11151996]
Stock Position:  0.11151995962721077
Bond Position:  [-21.80462409]


portfolio before change:  [-10.99140832]
curr_Stock_Price:  96.98659819957439
curr_Factors:  [96.9865982]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426795]
Stock Position:  -0.04267949742620326
Bond Position:  [-6.85206906]


portfolio before change:  [-10.98477893]
curr_Stock_Price:  96.81119887825311
curr_Factors:  [96.81119888]
mat_Sqrt:  [[0.15]]
grads:  [0.02427518]
Stock Position:  0.02427517659053019
Bond Position:  [-13.33488788]


portfolio before change:  [-10.98406881]
curr_Stock_Price:  96.90912155662782
curr_Factors:  [96.90912156]
mat_Sqrt:  [[0.15]]
grads:  [-0.06016817]
Stock Position:  -0.06016817317611864
Bond Position:  [-5.153224]


portfolio before change:  [-11.01158613]
curr_Stock_Price:  97.35575516617286
curr_Factors:  [97.35575517]
mat_Sqrt:  [[0.15]]
grads:  [0.04942239]
Stock Position:  0.049422386234719035
Bond Position:  [-15.82313986]


portfolio before change:  [-10.98582016]
curr_Stock_Price:  97.91711993296624
curr_Factors:  [97.91711993]
mat_Sqrt:  [[0.15]]
grads:  [0.0927387]
Stock Position:  0.09273869811002663
Bond Position:  [-20.06652638]


portfolio before change:  [-10.94837634]
curr_Stock_Price:  98.34792491958966
curr_Factors:  [98.34792492]
mat_Sqrt:  [[0.15]]
grads:  [0.01594536]
Stock Position:  0.015945356481114094
Bond Position:  [-12.51656906]


portfolio before change:  [-10.93224631]
curr_Stock_Price:  99.45763311074917
curr_Factors:  [99.45763311]
mat_Sqrt:  [[0.15]]
grads:  [0.08625945]
Stock Position:  0.08625944583355308
Bond Position:  [-19.51140663]


portfolio before change:  [-10.85651136]
curr_Stock_Price:  100.36389946159065
curr_Factors:  [100.36389946]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018673]
Stock Position:  -0.0001867349120933595
Bond Position:  [-10.83776991]


portfolio before change:  [-10.85775466]
curr_Stock_Price:  99.76675845601514
curr_Factors:  [99.76675846]
mat_Sqrt:  [[0.15]]
grads:  [0.06701008]
Stock Position:  0.0670100761727757
Bond Position:  [-17.54313274]


portfolio before change:  [-10.80237753]
curr_Stock_Price:  100.62588537509023
curr_Factors:  [100.62588538]
mat_Sqrt:  [[0.15]]
grads:  [0.08723185]
Stock Position:  0.08723184813270819
Bond Position:  [-19.58015948]


portfolio before change:  [-10.80101022]
curr_Stock_Price:  100.66961915128144
curr_Factors:  [100.66961915]
mat_Sqrt:  [[0.15]]
grads:  [0.07618267]
Stock Position:  0.07618266784512422
Bond Position:  [-18.47029038]


portfolio before change:  [-10.76334057]
curr_Stock_Price:  101.19439178049751
curr_Factors:  [101.19439178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0887004]
Stock Position:  -0.08870039575074837
Bond Position:  [-1.78735797]


portfolio before change:  [-10.77948959]
curr_Stock_Price:  101.37393537234196
curr_Factors:  [101.37393537]
mat_Sqrt:  [[0.15]]
grads:  [-0.09289774]
Stock Position:  -0.09289774435155307
Bond Position:  [-1.36207966]


portfolio before change:  [-10.84504943]
curr_Stock_Price:  102.07782288643493
curr_Factors:  [102.07782289]
mat_Sqrt:  [[0.15]]
grads:  [0.15131936]
Stock Position:  0.15131935697061782
Bond Position:  [-26.29139995]


portfolio before change:  [-10.92069448]
curr_Stock_Price:  101.59963935819351
curr_Factors:  [101.59963936]
mat_Sqrt:  [[0.15]]
grads:  [-0.17001209]
Stock Position:  -0.17001209307856568
Bond Position:  [6.35247286]


portfolio before change:  [-10.81917008]
curr_Stock_Price:  101.00715037196198
curr_Factors:  [101.00715037]
mat_Sqrt:  [[0.15]]
grads:  [0.04122653]
Stock Position:  0.04122652638079066
Bond Position:  [-14.98334403]


portfolio before change:  [-10.83105597]
curr_Stock_Price:  100.76427630465336
curr_Factors:  [100.7642763]
mat_Sqrt:  [[0.15]]
grads:  [-0.04949164]
Stock Position:  -0.04949163988280127
Bond Position:  [-5.84406669]


portfolio before change:  [-10.83561857]
curr_Stock_Price:  100.84170457664162
curr_Factors:  [100.84170458]
mat_Sqrt:  [[0.15]]
grads:  [-0.05175244]
Stock Position:  -0.05175243804319436
Bond Position:  [-5.61681451]


portfolio before change:  [-10.82686052]
curr_Stock_Price:  100.65890742339775
curr_Factors:  [100.65890742]
mat_Sqrt:  [[0.15]]
grads:  [0.02020868]
Stock Position:  0.020208680486864552
Bond Position:  [-12.86104422]


portfolio before change:  [-10.80426554]
curr_Stock_Price:  101.8565469351228
curr_Factors:  [101.85654694]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541923]
Stock Position:  -0.07541922947143981
Bond Position:  [-3.12232325]


portfolio before change:  [-10.87344832]
curr_Stock_Price:  102.76868121343902
curr_Factors:  [102.76868121]
mat_Sqrt:  [[0.15]]
grads:  [0.2616452]
Stock Position:  0.26164519677085385
Bond Position:  [-37.76238014]


portfolio before change:  [-10.65051405]
curr_Stock_Price:  103.63877118516258
curr_Factors:  [103.63877119]
mat_Sqrt:  [[0.15]]
grads:  [-0.04967272]
Stock Position:  -0.049672720685457784
Bond Position:  [-5.50249432]


portfolio before change:  [-10.61409372]
curr_Stock_Price:  102.89171766967567
curr_Factors:  [102.89171767]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300203]
Stock Position:  -0.01300203106052267
Bond Position:  [-9.27629241]


portfolio before change:  [-10.62026854]
curr_Stock_Price:  103.27744268947029
curr_Factors:  [103.27744269]
mat_Sqrt:  [[0.15]]
grads:  [0.03262568]
Stock Position:  0.03262568310611006
Bond Position:  [-13.98976566]


portfolio before change:  [-10.60980167]
curr_Stock_Price:  103.65186245472806
curr_Factors:  [103.65186245]
mat_Sqrt:  [[0.15]]
grads:  [0.03622404]
Stock Position:  0.03622403642168818
Bond Position:  [-14.36449051]


portfolio before change:  [-10.61838849]
curr_Stock_Price:  103.46438628620436
curr_Factors:  [103.46438629]
mat_Sqrt:  [[0.15]]
grads:  [-0.02787502]
Stock Position:  -0.02787501629018074
Bond Position:  [-7.73431703]


portfolio before change:  [-10.63364597]
curr_Stock_Price:  103.97705429494032
curr_Factors:  [103.97705429]
mat_Sqrt:  [[0.15]]
grads:  [0.04819009]
Stock Position:  0.048190091926513565
Bond Position:  [-15.64430977]


portfolio before change:  [-10.67699896]
curr_Stock_Price:  103.11801189183811
curr_Factors:  [103.11801189]
mat_Sqrt:  [[0.15]]
grads:  [0.03491573]
Stock Position:  0.03491573032426203
Bond Position:  [-14.27743965]


portfolio before change:  [-10.67091439]
curr_Stock_Price:  103.3433933255731
curr_Factors:  [103.34339333]
mat_Sqrt:  [[0.15]]
grads:  [-0.04895859]
Stock Position:  -0.04895858878544552
Bond Position:  [-5.6113677]


portfolio before change:  [-10.68594267]
curr_Stock_Price:  103.63602453667175
curr_Factors:  [103.63602454]
mat_Sqrt:  [[0.15]]
grads:  [0.06472449]
Stock Position:  0.06472448736545082
Bond Position:  [-17.39373123]


portfolio before change:  [-10.708014]
curr_Stock_Price:  103.32861410345943
curr_Factors:  [103.3286141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.708014]
Stock Price:  103.3145600906732
PL:  [-14.0225741]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.46172372e-03]
 [ 1.44180833e-03]
 [ 1.45433700e-02]
 [ 2.25396163e-02]
 [ 5.08469756e-03]
 [ 3.13054908e-02]
 [ 2.77147482e-02]
 [-3.24523728e-03]
 [-1.15820524e-02]
 [-2.11092933e-03]
 [ 2.05868040e-02]
 [ 8.64546018e-03]
 [ 4.26122862e-03]
 [-4.02654377e-03]
 [ 1.24707522e-02]
 [ 2.43690235e-03]
 [ 8.93311202e-03]
 [ 1.08225004e-02]
 [ 1.14891936e-02]
 [-1.32242609e-02]
 [-5.48694552e-03]
 [ 2.52500051e-02]
 [-3.26514629e-02]
 [ 5.92545254e-03]
 [-6.29734323e-03]
 [-6.53372581e-03]
 [ 3.98739448e-03]
 [-1.12194553e-02]
 [-1.65985736e-02]
 [-8.78620221e-03]
 [-3.30969292e-03]
 [ 5.25778393e-03]
 [ 5.22797785e-03]
 [-4.39067944e-03]
 [ 1.52956536e-02]
 [ 5.10013858e-03]
 [-4.17998108e-03]
 [ 9.42550836e-03]
 [-1.63663341e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.98472026]
curr_Stock_Price:  100.06660646954573
curr_Factors:  [100.06660647]
mat_Sqrt:  [[0.15]]
grads:  [0.02974482]
Stock Position:  0.02974482476938451
Bond Position:  [0.00825659]


portfolio before change:  [3.01540716]
curr_Stock_Price:  101.09824338426492
curr_Factors:  [101.09824338]
mat_Sqrt:  [[0.15]]
grads:  [0.00961206]
Stock Position:  0.009612055525673319
Bond Position:  [2.04364523]


portfolio before change:  [3.02355659]
curr_Stock_Price:  101.91949995640633
curr_Factors:  [101.91949996]
mat_Sqrt:  [[0.15]]
grads:  [0.0969558]
Stock Position:  0.09695579989174623
Bond Position:  [-6.85813005]


portfolio before change:  [3.16643934]
curr_Stock_Price:  103.4020318589053
curr_Factors:  [103.40203186]
mat_Sqrt:  [[0.15]]
grads:  [0.15026411]
Stock Position:  0.15026410864550976
Bond Position:  [-12.37117481]


portfolio before change:  [3.00599262]
curr_Stock_Price:  102.3445589169787
curr_Factors:  [102.34455892]
mat_Sqrt:  [[0.15]]
grads:  [0.03389798]
Stock Position:  0.033897983721574154
Bond Position:  [-0.46328158]


portfolio before change:  [3.03194759]
curr_Stock_Price:  103.11194650868356
curr_Factors:  [103.11194651]
mat_Sqrt:  [[0.15]]
grads:  [0.20870327]
Stock Position:  0.20870327219150017
Bond Position:  [-18.48785304]


portfolio before change:  [3.00027284]
curr_Stock_Price:  102.97125091425191
curr_Factors:  [102.97125091]
mat_Sqrt:  [[0.15]]
grads:  [0.18476499]
Stock Position:  0.18476498776120384
Bond Position:  [-16.02520908]


portfolio before change:  [3.24155584]
curr_Stock_Price:  104.2879845623102
curr_Factors:  [104.28798456]
mat_Sqrt:  [[0.15]]
grads:  [-0.02163492]
Stock Position:  -0.021634915206718786
Bond Position:  [5.49781754]


portfolio before change:  [3.25069148]
curr_Stock_Price:  103.89748722633249
curr_Factors:  [103.89748723]
mat_Sqrt:  [[0.15]]
grads:  [-0.07721368]
Stock Position:  -0.07721368259960222
Bond Position:  [11.27299909]


portfolio before change:  [3.25154066]
curr_Stock_Price:  103.90474034923292
curr_Factors:  [103.90474035]
mat_Sqrt:  [[0.15]]
grads:  [-0.01407286]
Stock Position:  -0.014072862213496433
Bond Position:  [4.71377775]


portfolio before change:  [3.25630305]
curr_Stock_Price:  103.60820228667568
curr_Factors:  [103.60820229]
mat_Sqrt:  [[0.15]]
grads:  [0.13724536]
Stock Position:  0.13724536029899978
Bond Position:  [-10.963442]


portfolio before change:  [3.30587598]
curr_Stock_Price:  103.97938745116323
curr_Factors:  [103.97938745]
mat_Sqrt:  [[0.15]]
grads:  [0.0576364]
Stock Position:  0.05763640121392372
Bond Position:  [-2.68712171]


portfolio before change:  [3.27145743]
curr_Stock_Price:  103.38804871408051
curr_Factors:  [103.38804871]
mat_Sqrt:  [[0.15]]
grads:  [0.02840819]
Stock Position:  0.02840819080805955
Bond Position:  [0.33439002]


portfolio before change:  [3.28229915]
curr_Stock_Price:  103.7682179696678
curr_Factors:  [103.76821797]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684363]
Stock Position:  -0.026843625142374036
Bond Position:  [6.0678143]


portfolio before change:  [3.31829435]
curr_Stock_Price:  102.45555351046916
curr_Factors:  [102.45555351]
mat_Sqrt:  [[0.15]]
grads:  [0.08313835]
Stock Position:  0.08313834797491133
Bond Position:  [-5.19969111]


portfolio before change:  [3.32265861]
curr_Stock_Price:  102.51586576933049
curr_Factors:  [102.51586577]
mat_Sqrt:  [[0.15]]
grads:  [0.01624602]
Stock Position:  0.016246015646074988
Bond Position:  [1.65718425]


portfolio before change:  [3.32781964]
curr_Stock_Price:  102.82079419866224
curr_Factors:  [102.8207942]
mat_Sqrt:  [[0.15]]
grads:  [0.05955408]
Stock Position:  0.05955408011175059
Bond Position:  [-2.79557817]


portfolio before change:  [3.31606465]
curr_Stock_Price:  102.62927873873045
curr_Factors:  [102.62927874]
mat_Sqrt:  [[0.15]]
grads:  [0.07215]
Stock Position:  0.07215000270336468
Bond Position:  [-4.08863809]


portfolio before change:  [3.29434621]
curr_Stock_Price:  102.33534497353335
curr_Factors:  [102.33534497]
mat_Sqrt:  [[0.15]]
grads:  [0.07659462]
Stock Position:  0.07659462370987405
Bond Position:  [-4.54399103]


portfolio before change:  [3.19928229]
curr_Stock_Price:  101.101630534067
curr_Factors:  [101.10163053]
mat_Sqrt:  [[0.15]]
grads:  [-0.08816174]
Stock Position:  -0.08816173939291766
Bond Position:  [12.11257789]


portfolio before change:  [3.08016296]
curr_Stock_Price:  102.46995077538998
curr_Factors:  [102.46995078]
mat_Sqrt:  [[0.15]]
grads:  [-0.03657964]
Stock Position:  -0.0365796368005746
Bond Position:  [6.82847654]


portfolio before change:  [3.07759418]
curr_Stock_Price:  102.56351087487445
curr_Factors:  [102.56351087]
mat_Sqrt:  [[0.15]]
grads:  [0.16833337]
Stock Position:  0.16833336702946647
Bond Position:  [-14.18726694]


portfolio before change:  [3.0202891]
curr_Stock_Price:  102.23362051310478
curr_Factors:  [102.23362051]
mat_Sqrt:  [[0.15]]
grads:  [-0.21767642]
Stock Position:  -0.21767641910944546
Bond Position:  [25.27413753]


portfolio before change:  [2.90715971]
curr_Stock_Price:  102.76784860103098
curr_Factors:  [102.7678486]
mat_Sqrt:  [[0.15]]
grads:  [0.03950302]
Stock Position:  0.0395030169214753
Bond Position:  [-1.15248035]


portfolio before change:  [2.87609472]
curr_Stock_Price:  101.98510008542215
curr_Factors:  [101.98510009]
mat_Sqrt:  [[0.15]]
grads:  [-0.04198229]
Stock Position:  -0.041982288181877964
Bond Position:  [7.15766258]


portfolio before change:  [2.89050762]
curr_Stock_Price:  101.66310371131145
curr_Factors:  [101.66310371]
mat_Sqrt:  [[0.15]]
grads:  [-0.04355817]
Stock Position:  -0.04355817205063966
Bond Position:  [7.31876659]


portfolio before change:  [2.95635686]
curr_Stock_Price:  100.17235396828927
curr_Factors:  [100.17235397]
mat_Sqrt:  [[0.15]]
grads:  [0.02658263]
Stock Position:  0.02658262989333894
Bond Position:  [0.29351225]


portfolio before change:  [2.98104851]
curr_Stock_Price:  101.09983761356473
curr_Factors:  [101.09983761]
mat_Sqrt:  [[0.15]]
grads:  [-0.07479637]
Stock Position:  -0.074796368678082
Bond Position:  [10.54294923]


portfolio before change:  [2.98066202]
curr_Stock_Price:  101.12262527430254
curr_Factors:  [101.12262527]
mat_Sqrt:  [[0.15]]
grads:  [-0.11065716]
Stock Position:  -0.11065715750366349
Bond Position:  [14.1706043]


portfolio before change:  [3.01852539]
curr_Stock_Price:  100.79646534932263
curr_Factors:  [100.79646535]
mat_Sqrt:  [[0.15]]
grads:  [-0.05857468]
Stock Position:  -0.05857468138325331
Bond Position:  [8.92264623]


portfolio before change:  [3.09082348]
curr_Stock_Price:  99.58121855541971
curr_Factors:  [99.58121856]
mat_Sqrt:  [[0.15]]
grads:  [-0.02206462]
Stock Position:  -0.02206461946087201
Bond Position:  [5.28804518]


portfolio before change:  [3.06607567]
curr_Stock_Price:  100.73278453338393
curr_Factors:  [100.73278453]
mat_Sqrt:  [[0.15]]
grads:  [0.03505189]
Stock Position:  0.03505189289452622
Bond Position:  [-0.46479911]


portfolio before change:  [3.14281428]
curr_Stock_Price:  102.92372814906636
curr_Factors:  [102.92372815]
mat_Sqrt:  [[0.15]]
grads:  [0.03485319]
Stock Position:  0.034853185635756796
Bond Position:  [-0.44440552]


portfolio before change:  [3.14698005]
curr_Stock_Price:  103.04484537714104
curr_Factors:  [103.04484538]
mat_Sqrt:  [[0.15]]
grads:  [-0.0292712]
Stock Position:  -0.02927119628125702
Bond Position:  [6.16322594]


portfolio before change:  [3.16574553]
curr_Stock_Price:  102.43007636093121
curr_Factors:  [102.43007636]
mat_Sqrt:  [[0.15]]
grads:  [0.10197102]
Stock Position:  0.10197102388516316
Bond Position:  [-7.27915424]


portfolio before change:  [3.25750524]
curr_Stock_Price:  103.3388606848117
curr_Factors:  [103.33886068]
mat_Sqrt:  [[0.15]]
grads:  [0.03400092]
Stock Position:  0.03400092387380581
Bond Position:  [-0.25611149]


portfolio before change:  [3.23526241]
curr_Stock_Price:  102.6856192502394
curr_Factors:  [102.68561925]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786654]
Stock Position:  -0.02786654054231022
Bond Position:  [6.09675539]


portfolio before change:  [3.22004027]
curr_Stock_Price:  103.25922070338208
curr_Factors:  [103.2592207]
mat_Sqrt:  [[0.15]]
grads:  [0.06283672]
Stock Position:  0.06283672241375936
Bond Position:  [-3.26843072]


portfolio before change:  [3.17145481]
curr_Stock_Price:  102.49252126836745
curr_Factors:  [102.49252127]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.17145481]
Stock Price:  101.84333058710223
PL:  [1.32812422]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.02057994e-02]
 [-8.05843448e-03]
 [-1.41179933e-02]
 [-1.35705200e-04]
 [ 1.19357950e-02]
 [ 2.68192070e-02]
 [ 1.35564804e-02]
 [ 9.47536989e-04]
 [-8.58454796e-03]
 [-3.02076870e-03]
 [ 1.65185029e-02]
 [ 7.98176557e-03]
 [ 3.52351522e-03]
 [-4.42225344e-03]
 [ 5.03203470e-03]
 [ 3.55629550e-03]
 [ 9.08635941e-03]
 [ 8.56806730e-04]
 [ 1.18120349e-02]
 [-1.57663706e-02]
 [ 9.10208068e-03]
 [ 3.54167504e-02]
 [-2.78985310e-02]
 [ 6.80371348e-03]
 [ 4.79019760e-03]
 [-9.50647837e-03]
 [-5.79039985e-04]
 [-1.10287051e-02]
 [ 4.84025629e-02]
 [-5.35049011e-03]
 [-6.01893956e-03]
 [ 4.87444700e-03]
 [ 5.53467118e-03]
 [-3.61315164e-03]
 [ 7.30513926e-03]
 [ 3.84370497e-03]
 [-4.67311684e-02]
 [ 9.56287239e-03]
 [-6.16849816e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.49046079]
curr_Stock_Price:  98.68125608784804
curr_Factors:  [98.68125609]
mat_Sqrt:  [[0.15]]
grads:  [0.06803866]
Stock Position:  0.06803866255195416
Bond Position:  [-25.20460147]


portfolio before change:  [-18.47114943]
curr_Stock_Price:  99.01139385159601
curr_Factors:  [99.01139385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0537229]
Stock Position:  -0.053722896504166166
Bond Position:  [-13.15197056]


portfolio before change:  [-18.44371658]
curr_Stock_Price:  98.47015440527578
curr_Factors:  [98.47015441]
mat_Sqrt:  [[0.15]]
grads:  [-0.09411996]
Stock Position:  -0.09411995535107301
Bond Position:  [-9.17571004]


portfolio before change:  [-18.46761241]
curr_Stock_Price:  98.71185441200802
curr_Factors:  [98.71185441]
mat_Sqrt:  [[0.15]]
grads:  [-0.0009047]
Stock Position:  -0.0009047013300278702
Bond Position:  [-18.37830766]


portfolio before change:  [-18.4708042]
curr_Stock_Price:  99.70042896151233
curr_Factors:  [99.70042896]
mat_Sqrt:  [[0.15]]
grads:  [0.07957197]
Stock Position:  0.07957196699430279
Bond Position:  [-26.40416344]


portfolio before change:  [-18.30712148]
curr_Stock_Price:  101.7989499953585
curr_Factors:  [101.79895]
mat_Sqrt:  [[0.15]]
grads:  [0.17879471]
Stock Position:  0.17879471312963355
Bond Position:  [-36.50823554]


portfolio before change:  [-18.234016]
curr_Stock_Price:  102.23335490596793
curr_Factors:  [102.23335491]
mat_Sqrt:  [[0.15]]
grads:  [0.09037654]
Stock Position:  0.09037653610135868
Bond Position:  [-27.47351249]


portfolio before change:  [-18.11441254]
curr_Stock_Price:  103.59474654599671
curr_Factors:  [103.59474655]
mat_Sqrt:  [[0.15]]
grads:  [0.00631691]
Stock Position:  0.006316913262038755
Bond Position:  [-18.76881157]


portfolio before change:  [-18.12703239]
curr_Stock_Price:  101.96838265367667
curr_Factors:  [101.96838265]
mat_Sqrt:  [[0.15]]
grads:  [-0.05723032]
Stock Position:  -0.0572303197191896
Bond Position:  [-12.29134925]


portfolio before change:  [-18.15696817]
curr_Stock_Price:  102.46461040796662
curr_Factors:  [102.46461041]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013846]
Stock Position:  -0.020138457997828735
Bond Position:  [-16.09348892]


portfolio before change:  [-18.16681043]
curr_Stock_Price:  102.85344076996937
curr_Factors:  [102.85344077]
mat_Sqrt:  [[0.15]]
grads:  [0.11012335]
Stock Position:  0.110123352515037
Bond Position:  [-29.49337614]


portfolio before change:  [-18.10670387]
curr_Stock_Price:  103.43273169473437
curr_Factors:  [103.43273169]
mat_Sqrt:  [[0.15]]
grads:  [0.05321177]
Stock Position:  0.053211770481517325
Bond Position:  [-23.61054265]


portfolio before change:  [-18.09920574]
curr_Stock_Price:  103.62910988861896
curr_Factors:  [103.62910989]
mat_Sqrt:  [[0.15]]
grads:  [0.0234901]
Stock Position:  0.023490101451637595
Bond Position:  [-20.53346405]


portfolio before change:  [-18.11352271]
curr_Stock_Price:  103.12889381704036
curr_Factors:  [103.12889382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02948169]
Stock Position:  -0.02948168959132454
Bond Position:  [-15.07310868]


portfolio before change:  [-18.13388339]
curr_Stock_Price:  103.75560207809315
curr_Factors:  [103.75560208]
mat_Sqrt:  [[0.15]]
grads:  [0.0335469]
Stock Position:  0.033546897999036575
Bond Position:  [-21.61456199]


portfolio before change:  [-18.12336477]
curr_Stock_Price:  104.14969553002655
curr_Factors:  [104.14969553]
mat_Sqrt:  [[0.15]]
grads:  [0.02370864]
Stock Position:  0.023708636685592154
Bond Position:  [-20.59261206]


portfolio before change:  [-18.14849163]
curr_Stock_Price:  103.19845453595592
curr_Factors:  [103.19845454]
mat_Sqrt:  [[0.15]]
grads:  [0.06057573]
Stock Position:  0.06057572942361722
Bond Position:  [-24.39981329]


portfolio before change:  [-18.09650259]
curr_Stock_Price:  104.10705615970154
curr_Factors:  [104.10705616]
mat_Sqrt:  [[0.15]]
grads:  [0.00571204]
Stock Position:  0.005712044868449474
Bond Position:  [-18.69116677]


portfolio before change:  [-18.10157642]
curr_Stock_Price:  103.62784258803003
curr_Factors:  [103.62784259]
mat_Sqrt:  [[0.15]]
grads:  [0.0787469]
Stock Position:  0.07874689925460815
Bond Position:  [-26.2619477]


portfolio before change:  [-18.11027325]
curr_Stock_Price:  103.55909215304331
curr_Factors:  [103.55909215]
mat_Sqrt:  [[0.15]]
grads:  [-0.10510914]
Stock Position:  -0.10510913763278172
Bond Position:  [-7.22526638]


portfolio before change:  [-18.23588291]
curr_Stock_Price:  104.7455393148216
curr_Factors:  [104.74553931]
mat_Sqrt:  [[0.15]]
grads:  [0.06068054]
Stock Position:  0.06068053787840137
Bond Position:  [-24.59189857]


portfolio before change:  [-18.2544144]
curr_Stock_Price:  104.4908067409158
curr_Factors:  [104.49080674]
mat_Sqrt:  [[0.15]]
grads:  [0.23611167]
Stock Position:  0.23611166933749234
Bond Position:  [-42.92591321]


portfolio before change:  [-18.38265519]
curr_Stock_Price:  103.97039741127759
curr_Factors:  [103.97039741]
mat_Sqrt:  [[0.15]]
grads:  [-0.18599021]
Stock Position:  -0.18599020640552713
Bond Position:  [0.95482049]


portfolio before change:  [-18.26242459]
curr_Stock_Price:  103.32460406599724
curr_Factors:  [103.32460407]
mat_Sqrt:  [[0.15]]
grads:  [0.04535809]
Stock Position:  0.04535808983522266
Bond Position:  [-22.94903126]


portfolio before change:  [-18.25624135]
curr_Stock_Price:  103.5241725851427
curr_Factors:  [103.52417259]
mat_Sqrt:  [[0.15]]
grads:  [0.03193465]
Stock Position:  0.03193465065388495
Bond Position:  [-21.56224964]


portfolio before change:  [-18.26724676]
curr_Stock_Price:  103.26395480414888
curr_Factors:  [103.2639548]
mat_Sqrt:  [[0.15]]
grads:  [-0.06337652]
Stock Position:  -0.06337652248917008
Bond Position:  [-11.72273641]


portfolio before change:  [-18.32089811]
curr_Stock_Price:  104.08738142812649
curr_Factors:  [104.08738143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00386027]
Stock Position:  -0.003860266563844043
Bond Position:  [-17.91909307]


portfolio before change:  [-18.31675692]
curr_Stock_Price:  102.43433076810454
curr_Factors:  [102.43433077]
mat_Sqrt:  [[0.15]]
grads:  [-0.0735247]
Stock Position:  -0.0735247003583541
Bond Position:  [-10.78530345]


portfolio before change:  [-18.37640545]
curr_Stock_Price:  103.2272653120308
curr_Factors:  [103.22726531]
mat_Sqrt:  [[0.15]]
grads:  [0.32268375]
Stock Position:  0.32268375234245555
Bond Position:  [-51.68616676]


portfolio before change:  [-17.95445254]
curr_Stock_Price:  104.55492460952561
curr_Factors:  [104.55492461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566993]
Stock Position:  -0.035669934041952886
Bond Position:  [-14.22498527]


portfolio before change:  [-17.94822539]
curr_Stock_Price:  104.3304952541289
curr_Factors:  [104.33049525]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012626]
Stock Position:  -0.04012626373962081
Bond Position:  [-13.76183242]


portfolio before change:  [-17.91157807]
curr_Stock_Price:  103.37432200067124
curr_Factors:  [103.374322]
mat_Sqrt:  [[0.15]]
grads:  [0.03249631]
Stock Position:  0.03249631331158373
Bond Position:  [-21.27086242]


portfolio before change:  [-17.89776025]
curr_Stock_Price:  103.88135918502444
curr_Factors:  [103.88135919]
mat_Sqrt:  [[0.15]]
grads:  [0.03689781]
Stock Position:  0.036897807855608866
Bond Position:  [-21.73075468]


portfolio before change:  [-17.88292842]
curr_Stock_Price:  104.35695239980708
curr_Factors:  [104.3569524]
mat_Sqrt:  [[0.15]]
grads:  [-0.02408768]
Stock Position:  -0.02408767759922563
Bond Position:  [-15.36921179]


portfolio before change:  [-17.90767769]
curr_Stock_Price:  105.30465680908213
curr_Factors:  [105.30465681]
mat_Sqrt:  [[0.15]]
grads:  [0.04870093]
Stock Position:  0.04870092842675842
Bond Position:  [-23.03611224]


portfolio before change:  [-17.85280321]
curr_Stock_Price:  106.49055141138838
curr_Factors:  [106.49055141]
mat_Sqrt:  [[0.15]]
grads:  [0.0256247]
Stock Position:  0.025624699802581485
Bond Position:  [-20.58159163]


portfolio before change:  [-17.84420376]
curr_Stock_Price:  106.92654924339469
curr_Factors:  [106.92654924]
mat_Sqrt:  [[0.15]]
grads:  [-0.31154112]
Stock Position:  -0.31154112251238614
Bond Position:  [15.46781342]


portfolio before change:  [-17.87046732]
curr_Stock_Price:  107.0170578667656
curr_Factors:  [107.01705787]
mat_Sqrt:  [[0.15]]
grads:  [0.06375248]
Stock Position:  0.06375248262179793
Bond Position:  [-24.69307044]


portfolio before change:  [-17.88028174]
curr_Stock_Price:  106.91153119031019
curr_Factors:  [106.91153119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.88028174]
Stock Price:  106.12887340218042
PL:  [-24.00915514]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.87873582e-03]
 [ 4.49933212e-03]
 [ 1.08241612e-02]
 [-3.14378412e-05]
 [ 1.40677453e-02]
 [ 1.96662329e-02]
 [ 6.28545557e-03]
 [ 1.61005099e-02]
 [-8.41925625e-03]
 [-3.01337272e-03]
 [ 1.14602453e-02]
 [ 4.04037104e-03]
 [ 1.40737253e-02]
 [ 3.00588556e-03]
 [ 9.12093020e-04]
 [-3.83784793e-03]
 [ 1.65456675e-02]
 [-1.04140117e-02]
 [ 2.75955333e-03]
 [ 7.57980389e-03]
 [ 2.89416677e-02]
 [ 2.17215950e-03]
 [ 5.18907611e-02]
 [-3.11710689e-03]
 [ 7.71078583e-03]
 [ 2.30485267e-02]
 [ 3.65512806e-02]
 [-2.61938519e-02]
 [-4.72982556e-02]
 [ 2.66074269e-03]
 [-4.30318640e-03]
 [ 5.58280097e-03]
 [ 1.60247615e-02]
 [-1.32567721e-02]
 [ 2.95131660e-03]
 [ 5.68761052e-03]
 [ 3.59901745e-03]
 [ 1.12275069e-02]
 [-2.55439447e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.88017266]
curr_Stock_Price:  100.31789964613438
curr_Factors:  [100.31789965]
mat_Sqrt:  [[0.15]]
grads:  [0.04585824]
Stock Position:  0.045858238824950645
Bond Position:  [2.27977046]


portfolio before change:  [6.88389333]
curr_Stock_Price:  100.39281927730825
curr_Factors:  [100.39281928]
mat_Sqrt:  [[0.15]]
grads:  [0.02999555]
Stock Position:  0.029995547496706697
Bond Position:  [3.87255575]


portfolio before change:  [6.89012957]
curr_Stock_Price:  100.584585646512
curr_Factors:  [100.58458565]
mat_Sqrt:  [[0.15]]
grads:  [0.07216107]
Stock Position:  0.07216107484272762
Bond Position:  [-0.36816224]


portfolio before change:  [6.92360211]
curr_Stock_Price:  101.04908211394928
curr_Factors:  [101.04908211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00020959]
Stock Position:  -0.00020958560829105336
Bond Position:  [6.94478054]


portfolio before change:  [6.92437162]
curr_Stock_Price:  101.51973856461737
curr_Factors:  [101.51973856]
mat_Sqrt:  [[0.15]]
grads:  [0.09378497]
Stock Position:  0.0937849686652553
Bond Position:  [-2.59665388]


portfolio before change:  [6.8026158]
curr_Stock_Price:  100.22495515981123
curr_Factors:  [100.22495516]
mat_Sqrt:  [[0.15]]
grads:  [0.13110822]
Stock Position:  0.13110821932755654
Bond Position:  [-6.33769961]


portfolio before change:  [7.0055532]
curr_Stock_Price:  101.77885978558535
curr_Factors:  [101.77885979]
mat_Sqrt:  [[0.15]]
grads:  [0.04190304]
Stock Position:  0.041903037116394655
Bond Position:  [2.74070986]


portfolio before change:  [6.96847322]
curr_Stock_Price:  100.88578379074147
curr_Factors:  [100.88578379]
mat_Sqrt:  [[0.15]]
grads:  [0.10733673]
Stock Position:  0.10733673291132717
Bond Position:  [-3.86027721]


portfolio before change:  [7.07223013]
curr_Stock_Price:  101.85692832857417
curr_Factors:  [101.85692833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05612837]
Stock Position:  -0.05612837498060349
Bond Position:  [12.789294]


portfolio before change:  [7.06251011]
curr_Stock_Price:  102.05858726648584
curr_Factors:  [102.05858727]
mat_Sqrt:  [[0.15]]
grads:  [-0.02008915]
Stock Position:  -0.02008915144159893
Bond Position:  [9.11278052]


portfolio before change:  [7.06577189]
curr_Stock_Price:  101.95292731826252
curr_Factors:  [101.95292732]
mat_Sqrt:  [[0.15]]
grads:  [0.07640164]
Stock Position:  0.07640163554782259
Bond Position:  [-0.7235985]


portfolio before change:  [6.95415263]
curr_Stock_Price:  100.493157466937
curr_Factors:  [100.49315747]
mat_Sqrt:  [[0.15]]
grads:  [0.02693581]
Stock Position:  0.026935806911399292
Bond Position:  [4.24728835]


portfolio before change:  [6.91950441]
curr_Stock_Price:  99.18712005019509
curr_Factors:  [99.18712005]
mat_Sqrt:  [[0.15]]
grads:  [0.09382484]
Stock Position:  0.09382483554447595
Bond Position:  [-2.38671082]


portfolio before change:  [6.87039546]
curr_Stock_Price:  98.66688902108352
curr_Factors:  [98.66688902]
mat_Sqrt:  [[0.15]]
grads:  [0.02003924]
Stock Position:  0.020039237090156762
Bond Position:  [4.89318628]


portfolio before change:  [6.84926006]
curr_Stock_Price:  97.5816636101999
curr_Factors:  [97.58166361]
mat_Sqrt:  [[0.15]]
grads:  [0.00608062]
Stock Position:  0.006080620134904109
Bond Position:  [6.25590303]


portfolio before change:  [6.84927058]
curr_Stock_Price:  97.45478318228987
curr_Factors:  [97.45478318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02558565]
Stock Position:  -0.02558565286554192
Bond Position:  [9.34271483]


portfolio before change:  [6.85622949]
curr_Stock_Price:  97.22844568758829
curr_Factors:  [97.22844569]
mat_Sqrt:  [[0.15]]
grads:  [0.11030445]
Stock Position:  0.11030445012266378
Bond Position:  [-3.86850075]


portfolio before change:  [6.85738469]
curr_Stock_Price:  97.24330275625731
curr_Factors:  [97.24330276]
mat_Sqrt:  [[0.15]]
grads:  [-0.06942674]
Stock Position:  -0.06942674460030661
Bond Position:  [13.60867064]


portfolio before change:  [6.95815375]
curr_Stock_Price:  95.8163618473743
curr_Factors:  [95.81636185]
mat_Sqrt:  [[0.15]]
grads:  [0.01839702]
Stock Position:  0.018397022206534618
Bond Position:  [5.19541801]


portfolio before change:  [6.93348998]
curr_Stock_Price:  94.44042006761876
curr_Factors:  [94.44042007]
mat_Sqrt:  [[0.15]]
grads:  [0.05053203]
Stock Position:  0.05053202595541107
Bond Position:  [2.16122422]


portfolio before change:  [6.87261778]
curr_Stock_Price:  93.23044729527346
curr_Factors:  [93.2304473]
mat_Sqrt:  [[0.15]]
grads:  [0.19294445]
Stock Position:  0.1929444510185348
Bond Position:  [-11.11567969]


portfolio before change:  [6.79557898]
curr_Stock_Price:  92.83836939733888
curr_Factors:  [92.8383694]
mat_Sqrt:  [[0.15]]
grads:  [0.01448106]
Stock Position:  0.01448106335224109
Bond Position:  [5.45118067]


portfolio before change:  [6.78679727]
curr_Stock_Price:  92.18488542316484
curr_Factors:  [92.18488542]
mat_Sqrt:  [[0.15]]
grads:  [0.34593841]
Stock Position:  0.3459384075019594
Bond Position:  [-25.10349519]


portfolio before change:  [6.89836573]
curr_Stock_Price:  92.51646638759455
curr_Factors:  [92.51646639]
mat_Sqrt:  [[0.15]]
grads:  [-0.02078071]
Stock Position:  -0.020780712628714733
Bond Position:  [8.82092383]


portfolio before change:  [6.89297483]
curr_Stock_Price:  92.82894753646075
curr_Factors:  [92.82894754]
mat_Sqrt:  [[0.15]]
grads:  [0.05140524]
Stock Position:  0.05140523889736989
Bond Position:  [2.12108061]


portfolio before change:  [6.89732461]
curr_Stock_Price:  92.90840683334149
curr_Factors:  [92.90840683]
mat_Sqrt:  [[0.15]]
grads:  [0.15365684]
Stock Position:  0.15365684452771564
Bond Position:  [-7.37868801]


portfolio before change:  [6.85139456]
curr_Stock_Price:  92.61549666998289
curr_Factors:  [92.61549667]
mat_Sqrt:  [[0.15]]
grads:  [0.2436752]
Stock Position:  0.2436752037307712
Bond Position:  [-15.71670545]


portfolio before change:  [7.07803765]
curr_Stock_Price:  93.55366267886346
curr_Factors:  [93.55366268]
mat_Sqrt:  [[0.15]]
grads:  [-0.17462568]
Stock Position:  -0.17462567930916728
Bond Position:  [23.41490954]


portfolio before change:  [7.10188605]
curr_Stock_Price:  93.43385581097704
curr_Factors:  [93.43385581]
mat_Sqrt:  [[0.15]]
grads:  [-0.3153217]
Stock Position:  -0.3153217043052603
Bond Position:  [36.5636087]


portfolio before change:  [7.16732507]
curr_Stock_Price:  93.24082031644593
curr_Factors:  [93.24082032]
mat_Sqrt:  [[0.15]]
grads:  [0.01773828]
Stock Position:  0.01773828461683925
Bond Position:  [5.51339286]


portfolio before change:  [7.19751467]
curr_Stock_Price:  94.9039114021771
curr_Factors:  [94.9039114]
mat_Sqrt:  [[0.15]]
grads:  [-0.02868791]
Stock Position:  -0.028687909301658484
Bond Position:  [9.92010947]


portfolio before change:  [7.18562779]
curr_Stock_Price:  95.361489777765
curr_Factors:  [95.36148978]
mat_Sqrt:  [[0.15]]
grads:  [0.03721867]
Stock Position:  0.0372186731610158
Bond Position:  [3.63639967]


portfolio before change:  [7.15709927]
curr_Stock_Price:  94.58276502092008
curr_Factors:  [94.58276502]
mat_Sqrt:  [[0.15]]
grads:  [0.10683174]
Stock Position:  0.10683174338476195
Bond Position:  [-2.94734241]


portfolio before change:  [7.20672052]
curr_Stock_Price:  95.05069421690109
curr_Factors:  [95.05069422]
mat_Sqrt:  [[0.15]]
grads:  [-0.08837848]
Stock Position:  -0.08837848081559929
Bond Position:  [15.60715647]


portfolio before change:  [7.12905008]
curr_Stock_Price:  95.95160867437575
curr_Factors:  [95.95160867]
mat_Sqrt:  [[0.15]]
grads:  [0.01967544]
Stock Position:  0.019675444011689417
Bond Position:  [5.24115958]


portfolio before change:  [7.15658096]
curr_Stock_Price:  97.31755946755071
curr_Factors:  [97.31755947]
mat_Sqrt:  [[0.15]]
grads:  [0.0379174]
Stock Position:  0.03791740348237427
Bond Position:  [3.46655179]


portfolio before change:  [7.16077304]
curr_Stock_Price:  97.41668913896189
curr_Factors:  [97.41668914]
mat_Sqrt:  [[0.15]]
grads:  [0.02399345]
Stock Position:  0.023993449645463467
Bond Position:  [4.82341062]


portfolio before change:  [7.13353089]
curr_Stock_Price:  96.25615907325886
curr_Factors:  [96.25615907]
mat_Sqrt:  [[0.15]]
grads:  [0.07485005]
Stock Position:  0.07485004625983309
Bond Position:  [-0.07124707]


portfolio before change:  [7.21205693]
curr_Stock_Price:  97.30538949054409
curr_Factors:  [97.30538949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.21205693]
Stock Price:  96.34214024837154
PL:  [7.21205693]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.33832151e-03]
 [-1.20529533e-02]
 [-1.10193085e-02]
 [-2.34098203e-03]
 [ 1.33846628e-02]
 [ 9.52776976e-03]
 [ 8.57939471e-04]
 [ 1.50607007e-02]
 [-7.06029640e-03]
 [ 1.75230601e-03]
 [ 8.97753940e-03]
 [ 4.81901670e-03]
 [ 1.08053710e-02]
 [ 4.42390900e-03]
 [ 1.44662797e-02]
 [ 2.48279047e-03]
 [ 9.12232157e-03]
 [ 6.52611072e-03]
 [ 1.18508574e-02]
 [-1.55982378e-02]
 [ 7.35034193e-03]
 [ 3.75543328e-02]
 [ 6.53305089e-03]
 [ 7.94825305e-03]
 [ 7.47010173e-03]
 [-1.73963007e-02]
 [-2.78682794e-04]
 [-1.31279426e-02]
 [ 6.36905569e-02]
 [-4.76625191e-03]
 [-5.88551491e-03]
 [ 4.43757486e-03]
 [ 5.82937585e-03]
 [-2.70342076e-03]
 [ 7.49118320e-03]
 [ 4.26042753e-03]
 [-2.85004346e-02]
 [ 9.83879902e-03]
 [-1.05408244e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.14934636]
curr_Stock_Price:  99.09031737909973
curr_Factors:  [99.09031738]
mat_Sqrt:  [[0.15]]
grads:  [0.04892214]
Stock Position:  0.04892214339756326
Bond Position:  [-16.99705708]


portfolio before change:  [-12.17911776]
curr_Stock_Price:  98.52520250478493
curr_Factors:  [98.5252025]
mat_Sqrt:  [[0.15]]
grads:  [-0.08035302]
Stock Position:  -0.0803530220640599
Bond Position:  [-4.26231999]


portfolio before change:  [-12.19435134]
curr_Stock_Price:  98.70815463438639
curr_Factors:  [98.70815463]
mat_Sqrt:  [[0.15]]
grads:  [-0.07346206]
Stock Position:  -0.07346205688841347
Bond Position:  [-4.94304727]


portfolio before change:  [-12.24533136]
curr_Stock_Price:  99.3937071947252
curr_Factors:  [99.39370719]
mat_Sqrt:  [[0.15]]
grads:  [-0.01560655]
Stock Position:  -0.015606546896402037
Bond Position:  [-10.6941388]


portfolio before change:  [-12.25542537]
curr_Stock_Price:  99.95482846159317
curr_Factors:  [99.95482846]
mat_Sqrt:  [[0.15]]
grads:  [0.08923109]
Stock Position:  0.08923108509828823
Bond Position:  [-21.17450318]


portfolio before change:  [-12.27539816]
curr_Stock_Price:  99.76066066477586
curr_Factors:  [99.76066066]
mat_Sqrt:  [[0.15]]
grads:  [0.06351847]
Stock Position:  0.06351846509554482
Bond Position:  [-18.6120422]


portfolio before change:  [-12.23858493]
curr_Stock_Price:  100.37685744492816
curr_Factors:  [100.37685744]
mat_Sqrt:  [[0.15]]
grads:  [0.0057196]
Stock Position:  0.00571959647486452
Bond Position:  [-12.81270005]


portfolio before change:  [-12.23654364]
curr_Stock_Price:  101.0137874103276
curr_Factors:  [101.01378741]
mat_Sqrt:  [[0.15]]
grads:  [0.10040467]
Stock Position:  0.10040467122352191
Bond Position:  [-22.37879975]


portfolio before change:  [-12.23266522]
curr_Stock_Price:  101.08027771915215
curr_Factors:  [101.08027772]
mat_Sqrt:  [[0.15]]
grads:  [-0.04706864]
Stock Position:  -0.047068642648420936
Bond Position:  [-7.47495375]


portfolio before change:  [-12.19053726]
curr_Stock_Price:  100.1653928299277
curr_Factors:  [100.16539283]
mat_Sqrt:  [[0.15]]
grads:  [0.01168204]
Stock Position:  0.011682040080392189
Bond Position:  [-13.3606734]


portfolio before change:  [-12.17863809]
curr_Stock_Price:  101.32695017678681
curr_Factors:  [101.32695018]
mat_Sqrt:  [[0.15]]
grads:  [0.05985026]
Stock Position:  0.05985026265426518
Bond Position:  [-18.24308267]


portfolio before change:  [-12.17652707]
curr_Stock_Price:  101.40032584096001
curr_Factors:  [101.40032584]
mat_Sqrt:  [[0.15]]
grads:  [0.03212678]
Stock Position:  0.032126777992383886
Bond Position:  [-15.43419282]


portfolio before change:  [-12.17969086]
curr_Stock_Price:  101.36190316761615
curr_Factors:  [101.36190317]
mat_Sqrt:  [[0.15]]
grads:  [0.07203581]
Stock Position:  0.07203580646396113
Bond Position:  [-19.4813773]


portfolio before change:  [-12.26169712]
curr_Stock_Price:  100.25730055040074
curr_Factors:  [100.25730055]
mat_Sqrt:  [[0.15]]
grads:  [0.02949273]
Stock Position:  0.02949272663610374
Bond Position:  [-15.21855828]


portfolio before change:  [-12.20542572]
curr_Stock_Price:  102.22978160682047
curr_Factors:  [102.22978161]
mat_Sqrt:  [[0.15]]
grads:  [0.09644186]
Stock Position:  0.09644186484421134
Bond Position:  [-22.0646565]


portfolio before change:  [-12.14643038]
curr_Stock_Price:  102.87010096218346
curr_Factors:  [102.87010096]
mat_Sqrt:  [[0.15]]
grads:  [0.01655194]
Stock Position:  0.01655193646413318
Bond Position:  [-13.84912975]


portfolio before change:  [-12.13328282]
curr_Stock_Price:  103.7690171652864
curr_Factors:  [103.76901717]
mat_Sqrt:  [[0.15]]
grads:  [0.06081548]
Stock Position:  0.060815477140665174
Bond Position:  [-18.44404512]


portfolio before change:  [-12.14947939]
curr_Stock_Price:  103.54060624181973
curr_Factors:  [103.54060624]
mat_Sqrt:  [[0.15]]
grads:  [0.0435074]
Stock Position:  0.04350740481374673
Bond Position:  [-16.65426246]


portfolio before change:  [-12.1410037]
curr_Stock_Price:  103.78326861991226
curr_Factors:  [103.78326862]
mat_Sqrt:  [[0.15]]
grads:  [0.07900572]
Stock Position:  0.07900571570709772
Bond Position:  [-20.34047511]


portfolio before change:  [-12.17305079]
curr_Stock_Price:  103.40982253357777
curr_Factors:  [103.40982253]
mat_Sqrt:  [[0.15]]
grads:  [-0.10398825]
Stock Position:  -0.10398825229028978
Bond Position:  [-1.41964407]


portfolio before change:  [-12.27457759]
curr_Stock_Price:  104.38444542426375
curr_Factors:  [104.38444542]
mat_Sqrt:  [[0.15]]
grads:  [0.04900228]
Stock Position:  0.0490022795655096
Bond Position:  [-17.38965336]


portfolio before change:  [-12.24735905]
curr_Stock_Price:  104.98426207620899
curr_Factors:  [104.98426208]
mat_Sqrt:  [[0.15]]
grads:  [0.25036222]
Stock Position:  0.2503622186695378
Bond Position:  [-38.53145182]


portfolio before change:  [-12.02573403]
curr_Stock_Price:  105.88871863942833
curr_Factors:  [105.88871864]
mat_Sqrt:  [[0.15]]
grads:  [0.04355367]
Stock Position:  0.04355367257036696
Bond Position:  [-16.63757661]


portfolio before change:  [-12.06484355]
curr_Stock_Price:  105.03851035080297
curr_Factors:  [105.03851035]
mat_Sqrt:  [[0.15]]
grads:  [0.05298835]
Stock Position:  0.052988353670510156
Bond Position:  [-17.63066128]


portfolio before change:  [-12.07131879]
curr_Stock_Price:  104.95790268326387
curr_Factors:  [104.95790268]
mat_Sqrt:  [[0.15]]
grads:  [0.04980068]
Stock Position:  0.0498006782053437
Bond Position:  [-17.29829352]


portfolio before change:  [-12.06186018]
curr_Stock_Price:  105.19125344914794
curr_Factors:  [105.19125345]
mat_Sqrt:  [[0.15]]
grads:  [-0.11597534]
Stock Position:  -0.115975337671547
Bond Position:  [0.13773096]


portfolio before change:  [-12.0573528]
curr_Stock_Price:  105.15253695163989
curr_Factors:  [105.15253695]
mat_Sqrt:  [[0.15]]
grads:  [-0.00185789]
Stock Position:  -0.001857885293836227
Bond Position:  [-11.86199145]


portfolio before change:  [-12.0613205]
curr_Stock_Price:  106.49000124782374
curr_Factors:  [106.49000125]
mat_Sqrt:  [[0.15]]
grads:  [-0.08751962]
Stock Position:  -0.08751961763304711
Bond Position:  [-2.74135631]


portfolio before change:  [-12.01472731]
curr_Stock_Price:  105.9537114122624
curr_Factors:  [105.95371141]
mat_Sqrt:  [[0.15]]
grads:  [0.42460371]
Stock Position:  0.4246037129991904
Bond Position:  [-57.00306658]


portfolio before change:  [-12.53219497]
curr_Stock_Price:  104.75178638435526
curr_Factors:  [104.75178638]
mat_Sqrt:  [[0.15]]
grads:  [-0.03177501]
Stock Position:  -0.03177501270798777
Bond Position:  [-9.20370563]


portfolio before change:  [-12.51814082]
curr_Stock_Price:  104.27327577218782
curr_Factors:  [104.27327577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03923677]
Stock Position:  -0.03923676608658589
Bond Position:  [-8.42679469]


portfolio before change:  [-12.56949869]
curr_Stock_Price:  105.5553500202444
curr_Factors:  [105.55535002]
mat_Sqrt:  [[0.15]]
grads:  [0.02958383]
Stock Position:  0.02958383237782622
Bond Position:  [-15.69223047]


portfolio before change:  [-12.5745493]
curr_Stock_Price:  105.45093605004648
curr_Factors:  [105.45093605]
mat_Sqrt:  [[0.15]]
grads:  [0.03886251]
Stock Position:  0.03886250563358179
Bond Position:  [-16.6726369]


portfolio before change:  [-12.5984384]
curr_Stock_Price:  104.88985830842306
curr_Factors:  [104.88985831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802281]
Stock Position:  -0.018022805098176175
Bond Position:  [-10.70802893]


portfolio before change:  [-12.61350007]
curr_Stock_Price:  105.65128691051473
curr_Factors:  [105.65128691]
mat_Sqrt:  [[0.15]]
grads:  [0.04994122]
Stock Position:  0.04994122135313158
Bond Position:  [-17.88985437]


portfolio before change:  [-12.61532703]
curr_Stock_Price:  105.6594846682034
curr_Factors:  [105.65948467]
mat_Sqrt:  [[0.15]]
grads:  [0.02840285]
Stock Position:  0.028402850193949385
Bond Position:  [-15.61635755]


portfolio before change:  [-12.62562549]
curr_Stock_Price:  105.36563050211566
curr_Factors:  [105.3656305]
mat_Sqrt:  [[0.15]]
grads:  [-0.1900029]
Stock Position:  -0.1900028974394821
Bond Position:  [7.39414959]


portfolio before change:  [-12.69147533]
curr_Stock_Price:  105.7170680839874
curr_Factors:  [105.71706808]
mat_Sqrt:  [[0.15]]
grads:  [0.06559199]
Stock Position:  0.0655919934813433
Bond Position:  [-19.62566857]


portfolio before change:  [-12.72947756]
curr_Stock_Price:  105.17509845989068
curr_Factors:  [105.17509846]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.72947756]
Stock Price:  104.87305637353585
PL:  [-17.60253393]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.61343047e-03]
 [-4.69336145e-03]
 [-1.63620417e-02]
 [ 9.66768049e-03]
 [-3.14239898e-02]
 [-2.76110299e-02]
 [-5.18880698e-02]
 [ 2.08332216e-02]
 [-5.99015083e-03]
 [-9.80790948e-05]
 [-4.75081813e-03]
 [ 7.22780953e-03]
 [ 1.39103615e-02]
 [ 2.70077967e-03]
 [ 9.77207291e-03]
 [-2.18071090e-03]
 [ 1.22342269e-02]
 [-4.39615716e-03]
 [ 1.08730448e-02]
 [-1.22952694e-02]
 [ 1.22725289e-03]
 [ 4.28300740e-03]
 [ 9.24684014e-03]
 [ 5.84240986e-03]
 [-4.83710342e-03]
 [-1.10084774e-02]
 [ 1.34675189e-02]
 [-1.08643761e-02]
 [-1.81529804e-02]
 [-1.41427271e-03]
 [-3.83998429e-03]
 [ 5.62972029e-03]
 [ 7.75475381e-03]
 [-1.27225400e-02]
 [ 8.07057982e-03]
 [ 5.71396538e-03]
 [ 3.58763695e-03]
 [ 9.94460093e-03]
 [-9.73535663e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.85650669]
curr_Stock_Price:  99.99382612367101
curr_Factors:  [99.99382612]
mat_Sqrt:  [[0.15]]
grads:  [0.02408954]
Stock Position:  0.02408953647748866
Bond Position:  [-0.55229823]


portfolio before change:  [1.83863308]
curr_Stock_Price:  99.25472642755959
curr_Factors:  [99.25472643]
mat_Sqrt:  [[0.15]]
grads:  [-0.03128908]
Stock Position:  -0.03128907633174638
Bond Position:  [4.94422179]


portfolio before change:  [1.86913056]
curr_Stock_Price:  98.29977937966335
curr_Factors:  [98.29977938]
mat_Sqrt:  [[0.15]]
grads:  [-0.10908028]
Stock Position:  -0.109080278319322
Bond Position:  [12.59169785]


portfolio before change:  [2.01857429]
curr_Stock_Price:  96.9441752491235
curr_Factors:  [96.94417525]
mat_Sqrt:  [[0.15]]
grads:  [0.0644512]
Stock Position:  0.06445120323734516
Bond Position:  [-4.22959445]


portfolio before change:  [2.07604785]
curr_Stock_Price:  97.84411631848643
curr_Factors:  [97.84411632]
mat_Sqrt:  [[0.15]]
grads:  [-0.20949327]
Stock Position:  -0.20949326517375508
Bond Position:  [22.57373125]


portfolio before change:  [2.06726889]
curr_Stock_Price:  97.89949210214846
curr_Factors:  [97.8994921]
mat_Sqrt:  [[0.15]]
grads:  [-0.18407353]
Stock Position:  -0.1840735329292077
Bond Position:  [20.08797427]


portfolio before change:  [2.00052108]
curr_Stock_Price:  98.27574913642066
curr_Factors:  [98.27574914]
mat_Sqrt:  [[0.15]]
grads:  [-0.34592047]
Stock Position:  -0.345920465351451
Bond Position:  [35.99611395]


portfolio before change:  [1.95202368]
curr_Stock_Price:  98.42895542298834
curr_Factors:  [98.42895542]
mat_Sqrt:  [[0.15]]
grads:  [0.13888814]
Stock Position:  0.13888814386351186
Bond Position:  [-11.71859124]


portfolio before change:  [1.93460839]
curr_Stock_Price:  98.31411208213486
curr_Factors:  [98.31411208]
mat_Sqrt:  [[0.15]]
grads:  [-0.03993434]
Stock Position:  -0.03993433884201639
Bond Position:  [5.86071745]


portfolio before change:  [1.94601756]
curr_Stock_Price:  98.04675975804624
curr_Factors:  [98.04675976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00065386]
Stock Position:  -0.0006538606322952322
Bond Position:  [2.01012648]


portfolio before change:  [1.94644683]
curr_Stock_Price:  97.77454745693677
curr_Factors:  [97.77454746]
mat_Sqrt:  [[0.15]]
grads:  [-0.03167212]
Stock Position:  -0.031672120875641634
Bond Position:  [5.04317412]


portfolio before change:  [1.9364195]
curr_Stock_Price:  98.11105080873823
curr_Factors:  [98.11105081]
mat_Sqrt:  [[0.15]]
grads:  [0.0481854]
Stock Position:  0.04818539686683418
Bond Position:  [-2.79110043]


portfolio before change:  [1.92527828]
curr_Stock_Price:  97.88707613926503
curr_Factors:  [97.88707614]
mat_Sqrt:  [[0.15]]
grads:  [0.09273574]
Stock Position:  0.09273574351014569
Bond Position:  [-7.15235251]


portfolio before change:  [1.98271153]
curr_Stock_Price:  98.51603914171791
curr_Factors:  [98.51603914]
mat_Sqrt:  [[0.15]]
grads:  [0.0180052]
Stock Position:  0.01800519778936543
Bond Position:  [0.20891076]


portfolio before change:  [1.99295428]
curr_Stock_Price:  99.08346597035684
curr_Factors:  [99.08346597]
mat_Sqrt:  [[0.15]]
grads:  [0.06514715]
Stock Position:  0.06514715275447346
Bond Position:  [-4.46205142]


portfolio before change:  [2.03034192]
curr_Stock_Price:  99.6659232240467
curr_Factors:  [99.66592322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453807]
Stock Position:  -0.014538072694072318
Bond Position:  [3.47929235]


portfolio before change:  [2.04184931]
curr_Stock_Price:  98.90430515338858
curr_Factors:  [98.90430515]
mat_Sqrt:  [[0.15]]
grads:  [0.08156151]
Stock Position:  0.08156151256052754
Bond Position:  [-6.02493541]


portfolio before change:  [2.03231921]
curr_Stock_Price:  98.79669382000975
curr_Factors:  [98.79669382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02930771]
Stock Position:  -0.029307714426436635
Bond Position:  [4.9278245]


portfolio before change:  [2.01698588]
curr_Stock_Price:  99.34089667940655
curr_Factors:  [99.34089668]
mat_Sqrt:  [[0.15]]
grads:  [0.07248697]
Stock Position:  0.07248696519749959
Bond Position:  [-5.18393424]


portfolio before change:  [2.03280184]
curr_Stock_Price:  99.56802698051887
curr_Factors:  [99.56802698]
mat_Sqrt:  [[0.15]]
grads:  [-0.08196846]
Stock Position:  -0.08196846291563009
Bond Position:  [10.19423996]


portfolio before change:  [2.03525819]
curr_Stock_Price:  99.5536068781597
curr_Factors:  [99.55360688]
mat_Sqrt:  [[0.15]]
grads:  [0.00818169]
Stock Position:  0.008181685960150925
Bond Position:  [1.22074184]


portfolio before change:  [2.02883689]
curr_Stock_Price:  98.75011762403435
curr_Factors:  [98.75011762]
mat_Sqrt:  [[0.15]]
grads:  [0.02855338]
Stock Position:  0.028553382673710596
Bond Position:  [-0.790813]


portfolio before change:  [2.06362429]
curr_Stock_Price:  99.9719081711175
curr_Factors:  [99.97190817]
mat_Sqrt:  [[0.15]]
grads:  [0.0616456]
Stock Position:  0.061645600946907686
Bond Position:  [-4.09920407]


portfolio before change:  [2.07544796]
curr_Stock_Price:  100.17202136984776
curr_Factors:  [100.17202137]
mat_Sqrt:  [[0.15]]
grads:  [0.0389494]
Stock Position:  0.03894939905852658
Bond Position:  [-1.82619208]


portfolio before change:  [2.08818988]
curr_Stock_Price:  100.5050229727094
curr_Factors:  [100.50502297]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224736]
Stock Position:  -0.03224735612032991
Bond Position:  [5.32921115]


portfolio before change:  [2.12983482]
curr_Stock_Price:  99.23425991211529
curr_Factors:  [99.23425991]
mat_Sqrt:  [[0.15]]
grads:  [-0.07338985]
Stock Position:  -0.07338984927965155
Bond Position:  [9.4126222]


portfolio before change:  [2.15727793]
curr_Stock_Price:  98.87635674333305
curr_Factors:  [98.87635674]
mat_Sqrt:  [[0.15]]
grads:  [0.08978346]
Stock Position:  0.08978345929921672
Bond Position:  [-6.72018342]


portfolio before change:  [2.1778793]
curr_Stock_Price:  99.11516963133397
curr_Factors:  [99.11516963]
mat_Sqrt:  [[0.15]]
grads:  [-0.07242917]
Stock Position:  -0.07242917381585923
Bond Position:  [9.35670915]


portfolio before change:  [2.15925724]
curr_Stock_Price:  99.38842597896662
curr_Factors:  [99.38842598]
mat_Sqrt:  [[0.15]]
grads:  [-0.12101987]
Stock Position:  -0.12101986945843277
Bond Position:  [14.18723157]


portfolio before change:  [2.32485824]
curr_Stock_Price:  98.03470211347606
curr_Factors:  [98.03470211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00942848]
Stock Position:  -0.009428484709400877
Bond Position:  [3.24917693]


portfolio before change:  [2.32783063]
curr_Stock_Price:  97.76252457866946
curr_Factors:  [97.76252458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0255999]
Stock Position:  -0.02559989527123753
Bond Position:  [4.83054102]


portfolio before change:  [2.315559]
curr_Stock_Price:  98.26547535826629
curr_Factors:  [98.26547536]
mat_Sqrt:  [[0.15]]
grads:  [0.03753147]
Stock Position:  0.03753146859430039
Bond Position:  [-1.3724886]


portfolio before change:  [2.31387682]
curr_Stock_Price:  98.22522618319175
curr_Factors:  [98.22522618]
mat_Sqrt:  [[0.15]]
grads:  [0.05169836]
Stock Position:  0.05169835873731512
Bond Position:  [-2.76420617]


portfolio before change:  [2.30687403]
curr_Stock_Price:  98.09645548465396
curr_Factors:  [98.09645548]
mat_Sqrt:  [[0.15]]
grads:  [-0.08481693]
Stock Position:  -0.08481693309277372
Bond Position:  [10.62711454]


portfolio before change:  [2.25876483]
curr_Stock_Price:  98.67933061199648
curr_Factors:  [98.67933061]
mat_Sqrt:  [[0.15]]
grads:  [0.05380387]
Stock Position:  0.0538038654777542
Bond Position:  [-3.0505646]


portfolio before change:  [2.24617588]
curr_Stock_Price:  98.45243990353573
curr_Factors:  [98.4524399]
mat_Sqrt:  [[0.15]]
grads:  [0.0380931]
Stock Position:  0.03809310250008807
Bond Position:  [-1.504183]


portfolio before change:  [2.21472622]
curr_Stock_Price:  97.6317759954051
curr_Factors:  [97.631776]
mat_Sqrt:  [[0.15]]
grads:  [0.02391758]
Stock Position:  0.023917579635715638
Bond Position:  [-0.12038956]


portfolio before change:  [2.2445788]
curr_Stock_Price:  98.88054928858097
curr_Factors:  [98.88054929]
mat_Sqrt:  [[0.15]]
grads:  [0.06629734]
Stock Position:  0.06629733953967042
Bond Position:  [-4.31093855]


portfolio before change:  [2.36710523]
curr_Stock_Price:  100.73681272606854
curr_Factors:  [100.73681273]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.36710523]
Stock Price:  99.59345572775509
PL:  [2.36710523]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.11059147e-03]
 [-2.68557579e-03]
 [-4.71883874e-04]
 [-2.80867618e-03]
 [ 1.55553768e-02]
 [-5.19496509e-03]
 [ 2.66573425e-05]
 [ 1.70560131e-02]
 [-6.06454095e-03]
 [ 4.87085887e-03]
 [ 2.35791076e-03]
 [ 7.41376139e-03]
 [ 1.39043580e-02]
 [ 2.31282896e-03]
 [ 6.88170898e-03]
 [-3.33043579e-03]
 [ 1.47558534e-02]
 [-8.35058934e-03]
 [ 5.72945340e-03]
 [-9.14975818e-03]
 [ 7.89212644e-03]
 [ 1.64929242e-04]
 [ 2.02513865e-02]
 [ 4.69904008e-03]
 [ 1.01672127e-02]
 [-1.04779672e-02]
 [ 8.33018627e-03]
 [-1.12191457e-02]
 [-1.71495074e-02]
 [-3.70979745e-03]
 [-3.48500597e-03]
 [ 5.58236908e-03]
 [ 6.34385915e-03]
 [-1.15984337e-02]
 [ 1.90270836e-02]
 [ 5.64344192e-03]
 [ 2.39619047e-03]
 [ 7.83505620e-03]
 [-5.30016147e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.98838272]
curr_Stock_Price:  99.42324788766733
curr_Factors:  [99.42324789]
mat_Sqrt:  [[0.15]]
grads:  [0.03407061]
Stock Position:  0.034070609790315814
Bond Position:  [-10.3757934]


portfolio before change:  [-6.99018229]
curr_Stock_Price:  99.40849855400222
curr_Factors:  [99.40849855]
mat_Sqrt:  [[0.15]]
grads:  [-0.01790384]
Stock Position:  -0.017903838586988734
Bond Position:  [-5.21038858]


portfolio before change:  [-6.98950742]
curr_Stock_Price:  99.3344241803127
curr_Factors:  [99.33442418]
mat_Sqrt:  [[0.15]]
grads:  [-0.00314589]
Stock Position:  -0.0031458924957177914
Bond Position:  [-6.677012]


portfolio before change:  [-6.99244108]
curr_Stock_Price:  100.00163789340871
curr_Factors:  [100.00163789]
mat_Sqrt:  [[0.15]]
grads:  [-0.01872451]
Stock Position:  -0.018724507871995262
Bond Position:  [-5.11995962]


portfolio before change:  [-6.99812888]
curr_Stock_Price:  100.27121861680261
curr_Factors:  [100.27121862]
mat_Sqrt:  [[0.15]]
grads:  [0.10370251]
Stock Position:  0.10370251196323806
Bond Position:  [-17.39650613]


portfolio before change:  [-7.10850983]
curr_Stock_Price:  99.22778925105959
curr_Factors:  [99.22778925]
mat_Sqrt:  [[0.15]]
grads:  [-0.0346331]
Stock Position:  -0.03463310060247595
Bond Position:  [-3.67194382]


portfolio before change:  [-7.14640398]
curr_Stock_Price:  100.30869548621783
curr_Factors:  [100.30869549]
mat_Sqrt:  [[0.15]]
grads:  [0.00017772]
Stock Position:  0.00017771561653550397
Bond Position:  [-7.1642304]


portfolio before change:  [-7.14721762]
curr_Stock_Price:  100.7697835360321
curr_Factors:  [100.76978354]
mat_Sqrt:  [[0.15]]
grads:  [0.11370675]
Stock Position:  0.11370675404279203
Bond Position:  [-18.60542262]


portfolio before change:  [-7.1758015]
curr_Stock_Price:  100.53885573377573
curr_Factors:  [100.53885573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04043027]
Stock Position:  -0.04043027297365907
Bond Position:  [-3.11098812]


portfolio before change:  [-7.12155382]
curr_Stock_Price:  99.18747784753506
curr_Factors:  [99.18747785]
mat_Sqrt:  [[0.15]]
grads:  [0.03247239]
Stock Position:  0.03247239245671627
Bond Position:  [-10.34240853]


portfolio before change:  [-7.12611666]
curr_Stock_Price:  99.0867781155095
curr_Factors:  [99.08677812]
mat_Sqrt:  [[0.15]]
grads:  [0.01571941]
Stock Position:  0.015719405065435545
Bond Position:  [-8.68370186]


portfolio before change:  [-7.15443866]
curr_Stock_Price:  97.3541128465734
curr_Factors:  [97.35411285]
mat_Sqrt:  [[0.15]]
grads:  [0.04942508]
Stock Position:  0.049425075952186814
Bond Position:  [-11.96617308]


portfolio before change:  [-7.14970787]
curr_Stock_Price:  97.48009452622709
curr_Factors:  [97.48009453]
mat_Sqrt:  [[0.15]]
grads:  [0.09269572]
Stock Position:  0.09269571967569025
Bond Position:  [-16.18569539]


portfolio before change:  [-7.13937566]
curr_Stock_Price:  97.6133860025411
curr_Factors:  [97.613386]
mat_Sqrt:  [[0.15]]
grads:  [0.01541886]
Stock Position:  0.015418859748743796
Bond Position:  [-8.64446277]


portfolio before change:  [-7.12447532]
curr_Stock_Price:  98.64984144167904
curr_Factors:  [98.64984144]
mat_Sqrt:  [[0.15]]
grads:  [0.04587806]
Stock Position:  0.04587805989776388
Bond Position:  [-11.65033866]


portfolio before change:  [-7.1450603]
curr_Stock_Price:  98.2328972016884
curr_Factors:  [98.2328972]
mat_Sqrt:  [[0.15]]
grads:  [-0.02220291]
Stock Position:  -0.02220290529136329
Bond Position:  [-4.96400459]


portfolio before change:  [-7.13879603]
curr_Stock_Price:  97.92281112304775
curr_Factors:  [97.92281112]
mat_Sqrt:  [[0.15]]
grads:  [0.09837236]
Stock Position:  0.09837235586652752
Bond Position:  [-16.77169365]


portfolio before change:  [-7.11794406]
curr_Stock_Price:  98.15609378772882
curr_Factors:  [98.15609379]
mat_Sqrt:  [[0.15]]
grads:  [-0.0556706]
Stock Position:  -0.05567059560638704
Bond Position:  [-1.65353585]


portfolio before change:  [-7.08689877]
curr_Stock_Price:  97.59472045051935
curr_Factors:  [97.59472045]
mat_Sqrt:  [[0.15]]
grads:  [0.03819636]
Stock Position:  0.0381963559869362
Bond Position:  [-10.81466146]


portfolio before change:  [-7.04430395]
curr_Stock_Price:  98.7452685427622
curr_Factors:  [98.74526854]
mat_Sqrt:  [[0.15]]
grads:  [-0.06099839]
Stock Position:  -0.06099838785607438
Bond Position:  [-1.02100176]


portfolio before change:  [-7.05846198]
curr_Stock_Price:  98.97528117417194
curr_Factors:  [98.97528117]
mat_Sqrt:  [[0.15]]
grads:  [0.05261418]
Stock Position:  0.052614176270001485
Bond Position:  [-12.26596487]


portfolio before change:  [-7.11080366]
curr_Stock_Price:  98.00960342041277
curr_Factors:  [98.00960342]
mat_Sqrt:  [[0.15]]
grads:  [0.00109953]
Stock Position:  0.0010995282793909863
Bond Position:  [-7.21856799]


portfolio before change:  [-7.11184102]
curr_Stock_Price:  97.88683986983153
curr_Factors:  [97.88683987]
mat_Sqrt:  [[0.15]]
grads:  [0.13500924]
Stock Position:  0.13500924301810724
Bond Position:  [-20.32746917]


portfolio before change:  [-7.10017488]
curr_Stock_Price:  97.99207138213629
curr_Factors:  [97.99207138]
mat_Sqrt:  [[0.15]]
grads:  [0.03132693]
Stock Position:  0.03132693389393897
Bond Position:  [-10.16996603]


portfolio before change:  [-7.07243547]
curr_Stock_Price:  98.9181353112622
curr_Factors:  [98.91813531]
mat_Sqrt:  [[0.15]]
grads:  [0.06778142]
Stock Position:  0.06778141802128965
Bond Position:  [-13.77724695]


portfolio before change:  [-7.03251876]
curr_Stock_Price:  99.53244779788415
curr_Factors:  [99.5324478]
mat_Sqrt:  [[0.15]]
grads:  [-0.06985311]
Stock Position:  -0.06985311456766069
Bond Position:  [-0.07986728]


portfolio before change:  [-7.03759584]
curr_Stock_Price:  99.60498714759485
curr_Factors:  [99.60498715]
mat_Sqrt:  [[0.15]]
grads:  [0.05553458]
Stock Position:  0.05553457512912953
Bond Position:  [-12.56911648]


portfolio before change:  [-7.08888539]
curr_Stock_Price:  98.70971950270629
curr_Factors:  [98.7097195]
mat_Sqrt:  [[0.15]]
grads:  [-0.0747943]
Stock Position:  -0.07479430468796527
Bond Position:  [0.29403945]


portfolio before change:  [-7.06450036]
curr_Stock_Price:  98.3841830551688
curr_Factors:  [98.38418306]
mat_Sqrt:  [[0.15]]
grads:  [-0.11433005]
Stock Position:  -0.11433004915674397
Bond Position:  [4.18376813]


portfolio before change:  [-7.13053447]
curr_Stock_Price:  98.96633200239758
curr_Factors:  [98.966332]
mat_Sqrt:  [[0.15]]
grads:  [-0.02473198]
Stock Position:  -0.024731983015307223
Bond Position:  [-4.68290083]


portfolio before change:  [-7.13125631]
curr_Stock_Price:  98.97184855911854
curr_Factors:  [98.97184856]
mat_Sqrt:  [[0.15]]
grads:  [-0.02323337]
Stock Position:  -0.023233373139204084
Bond Position:  [-4.83180642]


portfolio before change:  [-7.13875917]
curr_Stock_Price:  99.26878576189115
curr_Factors:  [99.26878576]
mat_Sqrt:  [[0.15]]
grads:  [0.03721579]
Stock Position:  0.037215793841294864
Bond Position:  [-10.83312584]


portfolio before change:  [-7.14423509]
curr_Stock_Price:  99.15803474547752
curr_Factors:  [99.15803475]
mat_Sqrt:  [[0.15]]
grads:  [0.04229239]
Stock Position:  0.04229239436479422
Bond Position:  [-11.3378658]


portfolio before change:  [-7.10903004]
curr_Stock_Price:  100.02396746223435
curr_Factors:  [100.02396746]
mat_Sqrt:  [[0.15]]
grads:  [-0.07732289]
Stock Position:  -0.07732289127150639
Bond Position:  [0.62511232]


portfolio before change:  [-7.11022098]
curr_Stock_Price:  100.04038026489305
curr_Factors:  [100.04038026]
mat_Sqrt:  [[0.15]]
grads:  [0.12684722]
Stock Position:  0.12684722383135164
Bond Position:  [-19.80006549]


portfolio before change:  [-7.13892541]
curr_Stock_Price:  99.83360185298812
curr_Factors:  [99.83360185]
mat_Sqrt:  [[0.15]]
grads:  [0.03762295]
Stock Position:  0.03762294611471818
Bond Position:  [-10.89495963]


portfolio before change:  [-7.13471894]
curr_Stock_Price:  99.98160785212231
curr_Factors:  [99.98160785]
mat_Sqrt:  [[0.15]]
grads:  [0.0159746]
Stock Position:  0.015974603121761192
Bond Position:  [-8.73188545]


portfolio before change:  [-7.12614441]
curr_Stock_Price:  100.58669872665337
curr_Factors:  [100.58669873]
mat_Sqrt:  [[0.15]]
grads:  [0.05223371]
Stock Position:  0.05223370797655427
Bond Position:  [-12.38016066]


portfolio before change:  [-7.15993474]
curr_Stock_Price:  99.96942090616865
curr_Factors:  [99.96942091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.15993474]
Stock Price:  99.95246344321646
PL:  [-7.15993474]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.28868860e-03]
 [ 4.42850831e-03]
 [ 1.30156946e-02]
 [-2.43588949e-03]
 [ 1.29921748e-02]
 [ 2.05655192e-02]
 [ 7.90199956e-03]
 [ 1.41210152e-02]
 [-6.90486864e-03]
 [ 1.79936495e-03]
 [ 1.10470256e-02]
 [ 7.61520349e-03]
 [ 9.86066083e-04]
 [-4.08927458e-03]
 [ 2.08066569e-02]
 [ 1.39370195e-03]
 [ 9.56256709e-03]
 [ 5.66073685e-03]
 [ 1.15893766e-02]
 [-1.25687317e-02]
 [ 2.93630854e-03]
 [ 1.15338089e-02]
 [ 2.36234753e-03]
 [ 6.16136426e-03]
 [-4.27520423e-04]
 [-9.60543998e-03]
 [ 9.76935833e-03]
 [-1.10990974e-02]
 [-1.79800211e-02]
 [-3.53121220e-03]
 [-3.42108288e-03]
 [ 5.61482206e-03]
 [ 6.27159456e-03]
 [-1.20177918e-02]
 [ 1.09438449e-02]
 [ 5.71331263e-03]
 [ 3.57368253e-03]
 [ 1.14056667e-02]
 [-3.17371705e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.07419525]
curr_Stock_Price:  100.1368878134922
curr_Factors:  [100.13688781]
mat_Sqrt:  [[0.15]]
grads:  [0.03525792]
Stock Position:  0.03525792399096445
Bond Position:  [0.54357647]


portfolio before change:  [4.071324]
curr_Stock_Price:  100.05352494141988
curr_Factors:  [100.05352494]
mat_Sqrt:  [[0.15]]
grads:  [0.02952339]
Stock Position:  0.029523388703097446
Bond Position:  [1.11740489]


portfolio before change:  [4.09397047]
curr_Stock_Price:  100.81586235799926
curr_Factors:  [100.81586236]
mat_Sqrt:  [[0.15]]
grads:  [0.0867713]
Stock Position:  0.08677129748357183
Bond Position:  [-4.65395272]


portfolio before change:  [4.00108796]
curr_Stock_Price:  99.75213814034267
curr_Factors:  [99.75213814]
mat_Sqrt:  [[0.15]]
grads:  [-0.01623926]
Stock Position:  -0.016239263243180292
Bond Position:  [5.62098919]


portfolio before change:  [3.99952157]
curr_Stock_Price:  99.89186448896696
curr_Factors:  [99.89186449]
mat_Sqrt:  [[0.15]]
grads:  [0.0866145]
Stock Position:  0.08661449887790285
Bond Position:  [-4.65256221]


portfolio before change:  [4.03303764]
curr_Stock_Price:  100.28553619588384
curr_Factors:  [100.2855362]
mat_Sqrt:  [[0.15]]
grads:  [0.13710346]
Stock Position:  0.13710346142756935
Bond Position:  [-9.7164565]


portfolio before change:  [4.25347805]
curr_Stock_Price:  101.90223527382662
curr_Factors:  [101.90223527]
mat_Sqrt:  [[0.15]]
grads:  [0.05268]
Stock Position:  0.052679997099281256
Bond Position:  [-1.11473141]


portfolio before change:  [4.21435261]
curr_Stock_Price:  101.16218046641484
curr_Factors:  [101.16218047]
mat_Sqrt:  [[0.15]]
grads:  [0.0941401]
Stock Position:  0.09414010100223466
Bond Position:  [-5.30906527]


portfolio before change:  [4.19908518]
curr_Stock_Price:  101.00705252248929
curr_Factors:  [101.00705252]
mat_Sqrt:  [[0.15]]
grads:  [-0.04603246]
Stock Position:  -0.04603245757226639
Bond Position:  [8.84868804]


portfolio before change:  [4.23952027]
curr_Stock_Price:  100.15267848660247
curr_Factors:  [100.15267849]
mat_Sqrt:  [[0.15]]
grads:  [0.01199577]
Stock Position:  0.011995766355363448
Bond Position:  [3.03811214]


portfolio before change:  [4.26026535]
curr_Stock_Price:  101.8503852117997
curr_Factors:  [101.85038521]
mat_Sqrt:  [[0.15]]
grads:  [0.07364684]
Stock Position:  0.07364683752127522
Bond Position:  [-3.24069342]


portfolio before change:  [4.35881655]
curr_Stock_Price:  103.19404523200699
curr_Factors:  [103.19404523]
mat_Sqrt:  [[0.15]]
grads:  [0.05076802]
Stock Position:  0.05076802324213754
Bond Position:  [-0.88014114]


portfolio before change:  [4.42288858]
curr_Stock_Price:  104.4582672087859
curr_Factors:  [104.45826721]
mat_Sqrt:  [[0.15]]
grads:  [0.00657377]
Stock Position:  0.006573773889058769
Bond Position:  [3.73620355]


portfolio before change:  [4.41738248]
curr_Stock_Price:  103.54963341753214
curr_Factors:  [103.54963342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02726183]
Stock Position:  -0.027261830519404624
Bond Position:  [7.24033503]


portfolio before change:  [4.47010504]
curr_Stock_Price:  101.64890024267334
curr_Factors:  [101.64890024]
mat_Sqrt:  [[0.15]]
grads:  [0.13871105]
Stock Position:  0.13871104604199308
Bond Position:  [-9.62972024]


portfolio before change:  [4.39069813]
curr_Stock_Price:  101.08511582570866
curr_Factors:  [101.08511583]
mat_Sqrt:  [[0.15]]
grads:  [0.00929135]
Stock Position:  0.00929134633337401
Bond Position:  [3.4514813]


portfolio before change:  [4.38670674]
curr_Stock_Price:  100.60909755999928
curr_Factors:  [100.60909756]
mat_Sqrt:  [[0.15]]
grads:  [0.06375045]
Stock Position:  0.06375044724756045
Bond Position:  [-2.02716823]


portfolio before change:  [4.33657647]
curr_Stock_Price:  99.8267210744979
curr_Factors:  [99.82672107]
mat_Sqrt:  [[0.15]]
grads:  [0.03773825]
Stock Position:  0.037738245662538215
Bond Position:  [0.56929115]


portfolio before change:  [4.34999798]
curr_Stock_Price:  100.18048251275921
curr_Factors:  [100.18048251]
mat_Sqrt:  [[0.15]]
grads:  [0.07726251]
Stock Position:  0.07726251042364156
Bond Position:  [-3.3901976]


portfolio before change:  [4.35926312]
curr_Stock_Price:  100.30588541397564
curr_Factors:  [100.30588541]
mat_Sqrt:  [[0.15]]
grads:  [-0.08379154]
Stock Position:  -0.08379154441053532
Bond Position:  [12.76404817]


portfolio before change:  [4.43186649]
curr_Stock_Price:  99.45845180717227
curr_Factors:  [99.45845181]
mat_Sqrt:  [[0.15]]
grads:  [0.01957539]
Stock Position:  0.01957539025230952
Bond Position:  [2.48492849]


portfolio before change:  [4.43566885]
curr_Stock_Price:  99.63682483181246
curr_Factors:  [99.63682483]
mat_Sqrt:  [[0.15]]
grads:  [0.07689206]
Stock Position:  0.07689205916130354
Bond Position:  [-3.22561178]


portfolio before change:  [4.48215082]
curr_Stock_Price:  100.2465782760011
curr_Factors:  [100.24657828]
mat_Sqrt:  [[0.15]]
grads:  [0.01574898]
Stock Position:  0.01574898350374695
Bond Position:  [2.90336911]


portfolio before change:  [4.48779852]
curr_Stock_Price:  100.5821397946269
curr_Factors:  [100.58213979]
mat_Sqrt:  [[0.15]]
grads:  [0.04107576]
Stock Position:  0.04107576172208481
Bond Position:  [0.35631051]


portfolio before change:  [4.45959321]
curr_Stock_Price:  99.89438983469395
curr_Factors:  [99.89438983]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285014]
Stock Position:  -0.002850136151186939
Bond Position:  [4.74430582]


portfolio before change:  [4.46008351]
curr_Stock_Price:  99.93044850201743
curr_Factors:  [99.9304485]
mat_Sqrt:  [[0.15]]
grads:  [-0.06403627]
Stock Position:  -0.06403626655227572
Bond Position:  [10.85925635]


portfolio before change:  [4.49287047]
curr_Stock_Price:  99.439641248612
curr_Factors:  [99.43964125]
mat_Sqrt:  [[0.15]]
grads:  [0.06512906]
Stock Position:  0.06512905552532972
Bond Position:  [-1.98353945]


portfolio before change:  [4.48889628]
curr_Stock_Price:  99.38242819587148
curr_Factors:  [99.3824282]
mat_Sqrt:  [[0.15]]
grads:  [-0.07399398]
Stock Position:  -0.07399398281700931
Bond Position:  [11.84259796]


portfolio before change:  [4.47451544]
curr_Stock_Price:  99.5967869414789
curr_Factors:  [99.59678694]
mat_Sqrt:  [[0.15]]
grads:  [-0.11986681]
Stock Position:  -0.11986680754564479
Bond Position:  [16.41286433]


portfolio before change:  [4.56248478]
curr_Stock_Price:  98.8800112773975
curr_Factors:  [98.88001128]
mat_Sqrt:  [[0.15]]
grads:  [-0.02354141]
Stock Position:  -0.023541414665519404
Bond Position:  [6.89026013]


portfolio before change:  [4.55595347]
curr_Stock_Price:  99.19403860157641
curr_Factors:  [99.1940386]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280722]
Stock Position:  -0.022807219191704777
Bond Position:  [6.81829365]


portfolio before change:  [4.55964481]
curr_Stock_Price:  99.06956060012662
curr_Factors:  [99.0695606]
mat_Sqrt:  [[0.15]]
grads:  [0.03743215]
Stock Position:  0.03743214706676842
Bond Position:  [0.85125845]


portfolio before change:  [4.56519526]
curr_Stock_Price:  99.21499794602546
curr_Factors:  [99.21499795]
mat_Sqrt:  [[0.15]]
grads:  [0.04181063]
Stock Position:  0.04181063037982446
Bond Position:  [0.41695365]


portfolio before change:  [4.56104849]
curr_Stock_Price:  99.11457158684863
curr_Factors:  [99.11457159]
mat_Sqrt:  [[0.15]]
grads:  [-0.08011861]
Stock Position:  -0.08011861173335996
Bond Position:  [12.50197037]


portfolio before change:  [4.56915422]
curr_Stock_Price:  99.03290651810586
curr_Factors:  [99.03290652]
mat_Sqrt:  [[0.15]]
grads:  [0.07295897]
Stock Position:  0.07295896612917148
Bond Position:  [-2.65618425]


portfolio before change:  [4.51337305]
curr_Stock_Price:  98.27290213181226
curr_Factors:  [98.27290213]
mat_Sqrt:  [[0.15]]
grads:  [0.03808875]
Stock Position:  0.03808875087241031
Bond Position:  [0.77028096]


portfolio before change:  [4.45019933]
curr_Stock_Price:  96.61178168096863
curr_Factors:  [96.61178168]
mat_Sqrt:  [[0.15]]
grads:  [0.02382455]
Stock Position:  0.023824550176399693
Bond Position:  [2.14846709]


portfolio before change:  [4.44714135]
curr_Stock_Price:  96.47215436454151
curr_Factors:  [96.47215436]
mat_Sqrt:  [[0.15]]
grads:  [0.07603778]
Stock Position:  0.0760377778308102
Bond Position:  [-2.88838689]


portfolio before change:  [4.43986983]
curr_Stock_Price:  96.38127255645209
curr_Factors:  [96.38127256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43986983]
Stock Price:  95.99159097739057
PL:  [4.43986983]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.79858618e-03]
 [ 8.45848202e-04]
 [ 1.44132233e-02]
 [-2.72968639e-04]
 [ 6.91495951e-03]
 [-1.71961456e-02]
 [-2.88793536e-02]
 [ 2.02275751e-02]
 [-6.12723605e-03]
 [ 2.34270223e-03]
 [-3.46543637e-03]
 [ 7.20798119e-03]
 [ 1.40849501e-02]
 [ 4.75488849e-03]
 [ 1.51503465e-02]
 [ 9.66169578e-04]
 [ 1.06448433e-02]
 [ 9.72142471e-03]
 [ 1.16618656e-02]
 [-1.26579619e-02]
 [-1.60371970e-02]
 [ 1.80146146e-02]
 [ 2.59294306e-03]
 [ 5.94812474e-03]
 [-2.92232204e-03]
 [-7.62165363e-03]
 [ 2.25086846e-03]
 [-1.13138787e-02]
 [-1.80231210e-02]
 [-9.47343970e-03]
 [ 1.85513425e-05]
 [ 4.94005555e-03]
 [ 5.21441223e-03]
 [-5.66727827e-03]
 [ 1.61771808e-02]
 [ 5.47391950e-03]
 [-5.79791495e-03]
 [ 9.51699345e-03]
 [-1.43150090e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62069415]
curr_Stock_Price:  100.36567022030567
curr_Factors:  [100.36567022]
mat_Sqrt:  [[0.15]]
grads:  [0.04532391]
Stock Position:  0.04532390789240842
Bond Position:  [3.07172976]


portfolio before change:  [7.65752193]
curr_Stock_Price:  101.16974456429728
curr_Factors:  [101.16974456]
mat_Sqrt:  [[0.15]]
grads:  [0.00563899]
Stock Position:  0.005638988014513835
Bond Position:  [7.08702696]


portfolio before change:  [7.65827923]
curr_Stock_Price:  101.1469328711345
curr_Factors:  [101.14693287]
mat_Sqrt:  [[0.15]]
grads:  [0.09608816]
Stock Position:  0.09608815526453926
Bond Position:  [-2.06074296]


portfolio before change:  [7.64523144]
curr_Stock_Price:  101.01382405263787
curr_Factors:  [101.01382405]
mat_Sqrt:  [[0.15]]
grads:  [-0.00181979]
Stock Position:  -0.001819790927512537
Bond Position:  [7.82905548]


portfolio before change:  [7.64944444]
curr_Stock_Price:  99.23652917021651
curr_Factors:  [99.23652917]
mat_Sqrt:  [[0.15]]
grads:  [0.04609973]
Stock Position:  0.046099730086842365
Bond Position:  [3.07466723]


portfolio before change:  [7.63053117]
curr_Stock_Price:  98.81792298058288
curr_Factors:  [98.81792298]
mat_Sqrt:  [[0.15]]
grads:  [-0.11464097]
Stock Position:  -0.11464097075791913
Bond Position:  [18.95911378]


portfolio before change:  [7.62035863]
curr_Stock_Price:  98.92733038298117
curr_Factors:  [98.92733038]
mat_Sqrt:  [[0.15]]
grads:  [-0.19252902]
Stock Position:  -0.19252902433303976
Bond Position:  [26.66674103]


portfolio before change:  [7.76500589]
curr_Stock_Price:  98.19334387147539
curr_Factors:  [98.19334387]
mat_Sqrt:  [[0.15]]
grads:  [0.1348505]
Stock Position:  0.13485050083528577
Bond Position:  [-5.47641571]


portfolio before change:  [7.70466693]
curr_Stock_Price:  97.75096982148077
curr_Factors:  [97.75096982]
mat_Sqrt:  [[0.15]]
grads:  [-0.04084824]
Stock Position:  -0.040848240307190524
Bond Position:  [11.69762204]


portfolio before change:  [7.67049285]
curr_Stock_Price:  98.62337889070399
curr_Factors:  [98.62337889]
mat_Sqrt:  [[0.15]]
grads:  [0.01561801]
Stock Position:  0.015618014880093904
Bond Position:  [6.13019145]


portfolio before change:  [7.66129456]
curr_Stock_Price:  97.985358659131
curr_Factors:  [97.98535866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02310291]
Stock Position:  -0.023102909147624914
Bond Position:  [9.9250414]


portfolio before change:  [7.6577667]
curr_Stock_Price:  98.19176430928508
curr_Factors:  [98.19176431]
mat_Sqrt:  [[0.15]]
grads:  [0.04805321]
Stock Position:  0.04805320791141787
Bond Position:  [2.93933744]


portfolio before change:  [7.70633085]
curr_Stock_Price:  99.19475057464491
curr_Factors:  [99.19475057]
mat_Sqrt:  [[0.15]]
grads:  [0.09389967]
Stock Position:  0.09389966736791248
Bond Position:  [-1.60802324]


portfolio before change:  [7.72318392]
curr_Stock_Price:  99.37637092959821
curr_Factors:  [99.37637093]
mat_Sqrt:  [[0.15]]
grads:  [0.03169926]
Stock Position:  0.031699256596312814
Bond Position:  [4.57302684]


portfolio before change:  [7.73479621]
curr_Stock_Price:  99.7246636130541
curr_Factors:  [99.72466361]
mat_Sqrt:  [[0.15]]
grads:  [0.10100231]
Stock Position:  0.10100230966823047
Bond Position:  [-2.33762515]


portfolio before change:  [7.83743245]
curr_Stock_Price:  100.74373397698307
curr_Factors:  [100.74373398]
mat_Sqrt:  [[0.15]]
grads:  [0.00644113]
Stock Position:  0.006441130522816525
Bond Position:  [7.18852891]


portfolio before change:  [7.83036977]
curr_Stock_Price:  99.50772376714222
curr_Factors:  [99.50772377]
mat_Sqrt:  [[0.15]]
grads:  [0.07096562]
Stock Position:  0.070965622318596
Bond Position:  [0.76874222]


portfolio before change:  [7.879116]
curr_Stock_Price:  100.19326892195572
curr_Factors:  [100.19326892]
mat_Sqrt:  [[0.15]]
grads:  [0.0648095]
Stock Position:  0.06480949804257076
Bond Position:  [1.38564054]


portfolio before change:  [7.97322637]
curr_Stock_Price:  101.64270381371266
curr_Factors:  [101.64270381]
mat_Sqrt:  [[0.15]]
grads:  [0.07774577]
Stock Position:  0.07774577070471785
Bond Position:  [0.07093602]


portfolio before change:  [7.85547843]
curr_Stock_Price:  100.12806450180632
curr_Factors:  [100.1280645]
mat_Sqrt:  [[0.15]]
grads:  [-0.08438641]
Stock Position:  -0.08438641271496981
Bond Position:  [16.30492661]


portfolio before change:  [7.78023902]
curr_Stock_Price:  101.04382400962227
curr_Factors:  [101.04382401]
mat_Sqrt:  [[0.15]]
grads:  [-0.10691465]
Stock Position:  -0.10691464692225683
Bond Position:  [18.58330378]


portfolio before change:  [7.8172443]
curr_Stock_Price:  100.71943229186142
curr_Factors:  [100.71943229]
mat_Sqrt:  [[0.15]]
grads:  [0.12009743]
Stock Position:  0.12009743045016726
Bond Position:  [-4.27890071]


portfolio before change:  [7.7588335]
curr_Stock_Price:  100.23752432998295
curr_Factors:  [100.23752433]
mat_Sqrt:  [[0.15]]
grads:  [0.01728629]
Stock Position:  0.01728628708447706
Bond Position:  [6.02609887]


portfolio before change:  [7.75967331]
curr_Stock_Price:  100.24252876214604
curr_Factors:  [100.24252876]
mat_Sqrt:  [[0.15]]
grads:  [0.03965416]
Stock Position:  0.039654164942073335
Bond Position:  [3.78463954]


portfolio before change:  [7.76197033]
curr_Stock_Price:  100.28852404052881
curr_Factors:  [100.28852404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948215]
Stock Position:  -0.0194821469650319
Bond Position:  [9.71580609]


portfolio before change:  [7.75109998]
curr_Stock_Price:  100.90883034655819
curr_Factors:  [100.90883035]
mat_Sqrt:  [[0.15]]
grads:  [-0.05081102]
Stock Position:  -0.05081102421615165
Bond Position:  [12.878381]


portfolio before change:  [7.7545252]
curr_Stock_Price:  100.87310335924921
curr_Factors:  [100.87310336]
mat_Sqrt:  [[0.15]]
grads:  [0.01500579]
Stock Position:  0.015005789727758049
Bond Position:  [6.24084463]


portfolio before change:  [7.74596377]
curr_Stock_Price:  100.25057121935171
curr_Factors:  [100.25057122]
mat_Sqrt:  [[0.15]]
grads:  [-0.07542586]
Stock Position:  -0.07542585831757344
Bond Position:  [15.30744915]


portfolio before change:  [7.7150747]
curr_Stock_Price:  100.68547010196704
curr_Factors:  [100.6854701]
mat_Sqrt:  [[0.15]]
grads:  [-0.12015414]
Stock Position:  -0.12015413997733825
Bond Position:  [19.81285077]


portfolio before change:  [7.66336902]
curr_Stock_Price:  101.13641121575172
curr_Factors:  [101.13641122]
mat_Sqrt:  [[0.15]]
grads:  [-0.06315626]
Stock Position:  -0.06315626467088432
Bond Position:  [14.05076698]


portfolio before change:  [7.61091643]
curr_Stock_Price:  101.99474322523989
curr_Factors:  [101.99474323]
mat_Sqrt:  [[0.15]]
grads:  [0.00012368]
Stock Position:  0.00012367561677406445
Bond Position:  [7.59830217]


portfolio before change:  [7.61199571]
curr_Stock_Price:  103.04122902616083
curr_Factors:  [103.04122903]
mat_Sqrt:  [[0.15]]
grads:  [0.0329337]
Stock Position:  0.03293370364578709
Bond Position:  [4.21846641]


portfolio before change:  [7.6064768]
curr_Stock_Price:  102.85764073352686
curr_Factors:  [102.85764073]
mat_Sqrt:  [[0.15]]
grads:  [0.03476275]
Stock Position:  0.034762748216979486
Bond Position:  [4.03086254]


portfolio before change:  [7.57826252]
curr_Stock_Price:  102.03152160008248
curr_Factors:  [102.0315216]
mat_Sqrt:  [[0.15]]
grads:  [-0.03778186]
Stock Position:  -0.03778185510571473
Bond Position:  [11.43320269]


portfolio before change:  [7.5704603]
curr_Stock_Price:  102.27585756382778
curr_Factors:  [102.27585756]
mat_Sqrt:  [[0.15]]
grads:  [0.10784787]
Stock Position:  0.10784787171568176
Bond Position:  [-3.45977327]


portfolio before change:  [7.52152619]
curr_Stock_Price:  101.82613514445588
curr_Factors:  [101.82613514]
mat_Sqrt:  [[0.15]]
grads:  [0.0364928]
Stock Position:  0.03649279665713375
Bond Position:  [3.80560575]


portfolio before change:  [7.56447141]
curr_Stock_Price:  102.98991257393459
curr_Factors:  [102.98991257]
mat_Sqrt:  [[0.15]]
grads:  [-0.03865277]
Stock Position:  -0.03865276630992426
Bond Position:  [11.54531644]


portfolio before change:  [7.55139751]
curr_Stock_Price:  103.36549137561691
curr_Factors:  [103.36549138]
mat_Sqrt:  [[0.15]]
grads:  [0.06344662]
Stock Position:  0.06344662303110751
Bond Position:  [0.99320614]


portfolio before change:  [7.57123589]
curr_Stock_Price:  103.67621268459958
curr_Factors:  [103.67621268]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.57123589]
Stock Price:  103.84652646843773
PL:  [3.72470942]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.59527242e-03]
 [ 3.27478199e-04]
 [ 1.41190553e-02]
 [ 1.27217095e-02]
 [ 3.54841436e-03]
 [ 2.67704046e-02]
 [ 1.25802011e-02]
 [ 9.65194282e-03]
 [-9.82056206e-03]
 [-3.02449810e-03]
 [ 1.91948465e-02]
 [ 6.58222580e-03]
 [ 3.64452441e-03]
 [-4.15080700e-03]
 [ 1.33549452e-03]
 [ 4.48166824e-03]
 [ 9.18405287e-03]
 [ 1.73267796e-03]
 [ 1.21849961e-02]
 [-1.64301323e-02]
 [ 7.10135200e-03]
 [ 3.57141569e-02]
 [ 1.21700719e-03]
 [ 7.84964258e-03]
 [ 7.75515716e-03]
 [-2.05415400e-02]
 [-5.80761864e-04]
 [-1.09056525e-02]
 [ 5.32204903e-02]
 [-8.06182573e-03]
 [-5.37826503e-03]
 [ 4.80301946e-03]
 [ 5.25237748e-03]
 [-4.90440656e-03]
 [ 1.43961235e-02]
 [ 4.99011047e-03]
 [-8.20766706e-03]
 [ 9.64884474e-03]
 [-1.63757168e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.59071848]
curr_Stock_Price:  100.94432083089127
curr_Factors:  [100.94432083]
mat_Sqrt:  [[0.15]]
grads:  [0.04396848]
Stock Position:  0.04396848280868633
Bond Position:  [12.15234985]


portfolio before change:  [16.60488366]
curr_Stock_Price:  101.23193675680449
curr_Factors:  [101.23193676]
mat_Sqrt:  [[0.15]]
grads:  [0.00218319]
Stock Position:  0.0021831879929428213
Bond Position:  [16.38387531]


portfolio before change:  [16.60895442]
curr_Stock_Price:  102.1584019340015
curr_Factors:  [102.15840193]
mat_Sqrt:  [[0.15]]
grads:  [0.09412704]
Stock Position:  0.094127035370615
Bond Position:  [6.9930869]


portfolio before change:  [16.63666475]
curr_Stock_Price:  102.44350754803465
curr_Factors:  [102.44350755]
mat_Sqrt:  [[0.15]]
grads:  [0.0848114]
Stock Position:  0.0848113967813588
Bond Position:  [7.94828779]


portfolio before change:  [16.63527648]
curr_Stock_Price:  102.41542328568886
curr_Factors:  [102.41542329]
mat_Sqrt:  [[0.15]]
grads:  [0.0236561]
Stock Position:  0.023656095729486355
Bond Position:  [14.21252743]


portfolio before change:  [16.6209506]
curr_Stock_Price:  101.73472935215952
curr_Factors:  [101.73472935]
mat_Sqrt:  [[0.15]]
grads:  [0.17846936]
Stock Position:  0.17846936371156652
Bond Position:  [-1.53558181]


portfolio before change:  [16.70066725]
curr_Stock_Price:  102.18247349480028
curr_Factors:  [102.18247349]
mat_Sqrt:  [[0.15]]
grads:  [0.08386801]
Stock Position:  0.08386800703430904
Bond Position:  [8.13082685]


portfolio before change:  [16.68274157]
curr_Stock_Price:  101.9566174393528
curr_Factors:  [101.95661744]
mat_Sqrt:  [[0.15]]
grads:  [0.06434629]
Stock Position:  0.06434628548669975
Bond Position:  [10.12221196]


portfolio before change:  [16.73822819]
curr_Stock_Price:  102.79926534145
curr_Factors:  [102.79926534]
mat_Sqrt:  [[0.15]]
grads:  [-0.06547041]
Stock Position:  -0.06547041373712595
Bond Position:  [23.46853862]


portfolio before change:  [16.7496678]
curr_Stock_Price:  102.6693462693357
curr_Factors:  [102.66934627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016332]
Stock Position:  -0.020163320670000602
Bond Position:  [18.81982275]


portfolio before change:  [16.73847497]
curr_Stock_Price:  103.34113290795277
curr_Factors:  [103.34113291]
mat_Sqrt:  [[0.15]]
grads:  [0.12796564]
Stock Position:  0.12796564318668574
Bond Position:  [3.51436043]


portfolio before change:  [16.64058894]
curr_Stock_Price:  102.57275985829367
curr_Factors:  [102.57275986]
mat_Sqrt:  [[0.15]]
grads:  [0.04388151]
Stock Position:  0.04388150535464524
Bond Position:  [12.13954183]


portfolio before change:  [16.68672555]
curr_Stock_Price:  103.5895679503327
curr_Factors:  [103.58956795]
mat_Sqrt:  [[0.15]]
grads:  [0.02429683]
Stock Position:  0.024296829396070568
Bond Position:  [14.16982749]


portfolio before change:  [16.68563753]
curr_Stock_Price:  103.47188336098387
curr_Factors:  [103.47188336]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767205]
Stock Position:  -0.027672046643984274
Bond Position:  [19.54891631]


portfolio before change:  [16.65585102]
curr_Stock_Price:  104.63660648926988
curr_Factors:  [104.63660649]
mat_Sqrt:  [[0.15]]
grads:  [0.0089033]
Stock Position:  0.008903296810777069
Bond Position:  [15.72424026]


portfolio before change:  [16.66061199]
curr_Stock_Price:  104.95057006676531
curr_Factors:  [104.95057007]
mat_Sqrt:  [[0.15]]
grads:  [0.02987779]
Stock Position:  0.029877788292753185
Bond Position:  [13.52492107]


portfolio before change:  [16.66409738]
curr_Stock_Price:  105.01063734671514
curr_Factors:  [105.01063735]
mat_Sqrt:  [[0.15]]
grads:  [0.06122702]
Stock Position:  0.06122701912213004
Bond Position:  [10.23460908]


portfolio before change:  [16.60469505]
curr_Stock_Price:  104.01954326791409
curr_Factors:  [104.01954327]
mat_Sqrt:  [[0.15]]
grads:  [0.01155119]
Stock Position:  0.01155118640690849
Bond Position:  [15.40314592]


portfolio before change:  [16.61934365]
curr_Stock_Price:  105.12099568326137
curr_Factors:  [105.12099568]
mat_Sqrt:  [[0.15]]
grads:  [0.08123331]
Stock Position:  0.081233307628106
Bond Position:  [8.08001747]


portfolio before change:  [16.55332826]
curr_Stock_Price:  104.29589743386352
curr_Factors:  [104.29589743]
mat_Sqrt:  [[0.15]]
grads:  [-0.10953422]
Stock Position:  -0.10953421531835826
Bond Position:  [27.97729754]


portfolio before change:  [16.55274849]
curr_Stock_Price:  104.33311999417676
curr_Factors:  [104.33311999]
mat_Sqrt:  [[0.15]]
grads:  [0.04734235]
Stock Position:  0.04734234666093892
Bond Position:  [11.61337376]


portfolio before change:  [16.56491583]
curr_Stock_Price:  104.55946225037175
curr_Factors:  [104.55946225]
mat_Sqrt:  [[0.15]]
grads:  [0.23809438]
Stock Position:  0.23809437912790746
Bond Position:  [-8.33010442]


portfolio before change:  [16.80984464]
curr_Stock_Price:  105.59254056908644
curr_Factors:  [105.59254057]
mat_Sqrt:  [[0.15]]
grads:  [0.00811338]
Stock Position:  0.008113381269722747
Bond Position:  [15.9531321]


portfolio before change:  [16.79980624]
curr_Stock_Price:  104.10947583454241
curr_Factors:  [104.10947583]
mat_Sqrt:  [[0.15]]
grads:  [0.05233095]
Stock Position:  0.05233095056226603
Bond Position:  [11.3516584]


portfolio before change:  [16.91922743]
curr_Stock_Price:  106.36439667702297
curr_Factors:  [106.36439668]
mat_Sqrt:  [[0.15]]
grads:  [0.05170105]
Stock Position:  0.05170104776391977
Bond Position:  [11.42007668]


portfolio before change:  [16.89972464]
curr_Stock_Price:  105.95956170045682
curr_Factors:  [105.9595617]
mat_Sqrt:  [[0.15]]
grads:  [-0.1369436]
Stock Position:  -0.13694360007268175
Bond Position:  [31.41020848]


portfolio before change:  [17.16062156]
curr_Stock_Price:  104.08309283016985
curr_Factors:  [104.08309283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387175]
Stock Position:  -0.003871745758111119
Bond Position:  [17.56360484]


portfolio before change:  [17.16067073]
curr_Stock_Price:  104.63747377452938
curr_Factors:  [104.63747377]
mat_Sqrt:  [[0.15]]
grads:  [-0.07270435]
Stock Position:  -0.07270435016173296
Bond Position:  [24.76827026]


portfolio before change:  [17.21488242]
curr_Stock_Price:  103.934414603744
curr_Factors:  [103.9344146]
mat_Sqrt:  [[0.15]]
grads:  [0.35480327]
Stock Position:  0.354803268617577
Bond Position:  [-19.66138761]


portfolio before change:  [17.01801456]
curr_Stock_Price:  103.3864770577295
curr_Factors:  [103.38647706]
mat_Sqrt:  [[0.15]]
grads:  [-0.0537455]
Stock Position:  -0.053745504882663546
Bond Position:  [22.57457297]


portfolio before change:  [16.98486666]
curr_Stock_Price:  104.05574043879486
curr_Factors:  [104.05574044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0358551]
Stock Position:  -0.03585510022836506
Bond Position:  [20.71579566]


portfolio before change:  [16.99910295]
curr_Stock_Price:  103.73091482063914
curr_Factors:  [103.73091482]
mat_Sqrt:  [[0.15]]
grads:  [0.03202013]
Stock Position:  0.032020129704609906
Bond Position:  [13.6776256]


portfolio before change:  [16.97877269]
curr_Stock_Price:  103.04259551408431
curr_Factors:  [103.04259551]
mat_Sqrt:  [[0.15]]
grads:  [0.03501585]
Stock Position:  0.03501584985225437
Bond Position:  [13.37064863]


portfolio before change:  [16.96603045]
curr_Stock_Price:  102.63096267787269
curr_Factors:  [102.63096268]
mat_Sqrt:  [[0.15]]
grads:  [-0.03269604]
Stock Position:  -0.03269604370948777
Bond Position:  [20.32165689]


portfolio before change:  [16.96999368]
curr_Stock_Price:  102.58744467106098
curr_Factors:  [102.58744467]
mat_Sqrt:  [[0.15]]
grads:  [0.09597416]
Stock Position:  0.09597415690559366
Bond Position:  [7.12425017]


portfolio before change:  [17.06986341]
curr_Stock_Price:  103.6187550198892
curr_Factors:  [103.61875502]
mat_Sqrt:  [[0.15]]
grads:  [0.0332674]
Stock Position:  0.03326740310558614
Bond Position:  [13.62273652]


portfolio before change:  [17.06727617]
curr_Stock_Price:  103.48979445138971
curr_Factors:  [103.48979445]
mat_Sqrt:  [[0.15]]
grads:  [-0.05471778]
Stock Position:  -0.05471778042840479
Bond Position:  [22.73000802]


portfolio before change:  [17.06673662]
curr_Stock_Price:  103.55158387194787
curr_Factors:  [103.55158387]
mat_Sqrt:  [[0.15]]
grads:  [0.06432563]
Stock Position:  0.06432563158969982
Bond Position:  [10.40571559]


portfolio before change:  [17.02319163]
curr_Stock_Price:  102.85441558211426
curr_Factors:  [102.85441558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.02319163]
Stock Price:  104.26866052072032
PL:  [12.75453111]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.11529641e-03]
 [ 1.97170841e-03]
 [ 1.47675584e-02]
 [ 8.01437628e-04]
 [ 1.52917157e-02]
 [ 8.06066740e-03]
 [-4.44288955e-03]
 [ 2.20319679e-02]
 [-6.47187809e-03]
 [-1.04251687e-03]
 [ 1.32314332e-02]
 [ 6.50454025e-03]
 [ 3.41253734e-03]
 [-4.01155730e-03]
 [ 1.15661274e-02]
 [ 1.88837423e-03]
 [ 9.32300613e-03]
 [ 1.36542101e-02]
 [ 1.15613003e-02]
 [-1.35285202e-02]
 [-1.35403818e-02]
 [ 1.22071447e-02]
 [ 1.43624174e-02]
 [ 5.19641408e-03]
 [-7.77584969e-03]
 [-7.16930968e-03]
 [-2.81835125e-04]
 [-1.13289883e-02]
 [ 1.51942419e-02]
 [-1.08369861e-02]
 [ 2.04135368e-04]
 [ 5.11708774e-03]
 [ 5.11713065e-03]
 [-1.09049436e-02]
 [ 1.94906967e-02]
 [ 5.51532708e-03]
 [ 2.71861277e-03]
 [ 9.38954667e-03]
 [-4.16884332e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.53944809]
curr_Stock_Price:  99.71024585412285
curr_Factors:  [99.71024585]
mat_Sqrt:  [[0.15]]
grads:  [0.02076864]
Stock Position:  0.020768642703043193
Bond Position:  [-4.61029456]


portfolio before change:  [-2.51350723]
curr_Stock_Price:  100.98703495031201
curr_Factors:  [100.98703495]
mat_Sqrt:  [[0.15]]
grads:  [0.01314472]
Stock Position:  0.013144722707586754
Bond Position:  [-3.84095381]


portfolio before change:  [-2.50338958]
curr_Stock_Price:  101.79327507992483
curr_Factors:  [101.79327508]
mat_Sqrt:  [[0.15]]
grads:  [0.09845039]
Stock Position:  0.09845038966395858
Bond Position:  [-12.52497718]


portfolio before change:  [-2.5659337]
curr_Stock_Price:  101.17389310877934
curr_Factors:  [101.17389311]
mat_Sqrt:  [[0.15]]
grads:  [0.00534292]
Stock Position:  0.0053429175204276575
Bond Position:  [-3.10649746]


portfolio before change:  [-2.56868466]
curr_Stock_Price:  100.73169622252061
curr_Factors:  [100.73169622]
mat_Sqrt:  [[0.15]]
grads:  [0.10194477]
Stock Position:  0.10194477121505838
Bond Position:  [-12.83775438]


portfolio before change:  [-2.67641522]
curr_Stock_Price:  99.69068404708106
curr_Factors:  [99.69068405]
mat_Sqrt:  [[0.15]]
grads:  [0.05373778]
Stock Position:  0.05373778265518349
Bond Position:  [-8.03357153]


portfolio before change:  [-2.66806275]
curr_Stock_Price:  99.8648024482484
curr_Factors:  [99.86480245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961926]
Stock Position:  -0.02961926367519102
Bond Position:  [0.28985917]


portfolio before change:  [-2.6716163]
curr_Stock_Price:  99.98600024060137
curr_Factors:  [99.98600024]
mat_Sqrt:  [[0.15]]
grads:  [0.14687979]
Stock Position:  0.1468797860959145
Bond Position:  [-17.35753863]


portfolio before change:  [-2.55422442]
curr_Stock_Price:  100.80001089200776
curr_Factors:  [100.80001089]
mat_Sqrt:  [[0.15]]
grads:  [-0.04314585]
Stock Position:  -0.04314585395139746
Bond Position:  [1.79487813]


portfolio before change:  [-2.56831591]
curr_Stock_Price:  101.13181265610808
curr_Factors:  [101.13181266]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695011]
Stock Position:  -0.0069501124816584384
Bond Position:  [-1.86543844]


portfolio before change:  [-2.57695791]
curr_Stock_Price:  102.34169202672861
curr_Factors:  [102.34169203]
mat_Sqrt:  [[0.15]]
grads:  [0.08820955]
Stock Position:  0.08820955448720252
Bond Position:  [-11.60447297]


portfolio before change:  [-2.56214767]
curr_Stock_Price:  102.52603581142255
curr_Factors:  [102.52603581]
mat_Sqrt:  [[0.15]]
grads:  [0.0433636]
Stock Position:  0.04336360166953049
Bond Position:  [-7.00804585]


portfolio before change:  [-2.51361793]
curr_Stock_Price:  103.66537391380626
curr_Factors:  [103.66537391]
mat_Sqrt:  [[0.15]]
grads:  [0.02275025]
Stock Position:  0.022750248936456604
Bond Position:  [-4.87203099]


portfolio before change:  [-2.51359143]
curr_Stock_Price:  103.69330948661168
curr_Factors:  [103.69330949]
mat_Sqrt:  [[0.15]]
grads:  [-0.02674372]
Stock Position:  -0.026743715337295266
Bond Position:  [0.25955292]


portfolio before change:  [-2.48319396]
curr_Stock_Price:  102.55790181559044
curr_Factors:  [102.55790182]
mat_Sqrt:  [[0.15]]
grads:  [0.07710752]
Stock Position:  0.0771075160524237
Bond Position:  [-10.39117903]


portfolio before change:  [-2.55014014]
curr_Stock_Price:  101.70652958393454
curr_Factors:  [101.70652958]
mat_Sqrt:  [[0.15]]
grads:  [0.01258916]
Stock Position:  0.012589161508404289
Bond Position:  [-3.83054007]


portfolio before change:  [-2.55498264]
curr_Stock_Price:  101.35990986147328
curr_Factors:  [101.35990986]
mat_Sqrt:  [[0.15]]
grads:  [0.06215337]
Stock Position:  0.06215337417265855
Bond Position:  [-8.85484304]


portfolio before change:  [-2.54790369]
curr_Stock_Price:  101.4916143157273
curr_Factors:  [101.49161432]
mat_Sqrt:  [[0.15]]
grads:  [0.09102807]
Stock Position:  0.09102806740321806
Bond Position:  [-11.7864892]


portfolio before change:  [-2.52103694]
curr_Stock_Price:  101.80294858428442
curr_Factors:  [101.80294858]
mat_Sqrt:  [[0.15]]
grads:  [0.07707534]
Stock Position:  0.07707533532865452
Bond Position:  [-10.36753333]


portfolio before change:  [-2.54946432]
curr_Stock_Price:  101.45093762753758
curr_Factors:  [101.45093763]
mat_Sqrt:  [[0.15]]
grads:  [-0.09019013]
Stock Position:  -0.09019013480558896
Bond Position:  [6.60040942]


portfolio before change:  [-2.4516746]
curr_Stock_Price:  100.37582430398606
curr_Factors:  [100.3758243]
mat_Sqrt:  [[0.15]]
grads:  [-0.09026921]
Stock Position:  -0.090269212310555
Bond Position:  [6.60917199]


portfolio before change:  [-2.39134351]
curr_Stock_Price:  99.71663060807937
curr_Factors:  [99.71663061]
mat_Sqrt:  [[0.15]]
grads:  [0.08138096]
Stock Position:  0.08138096471605522
Bond Position:  [-10.50637911]


portfolio before change:  [-2.41736726]
curr_Stock_Price:  99.4129923509143
curr_Factors:  [99.41299235]
mat_Sqrt:  [[0.15]]
grads:  [0.09574945]
Stock Position:  0.09574944936328293
Bond Position:  [-11.93610654]


portfolio before change:  [-2.40097963]
curr_Stock_Price:  99.59972695172567
curr_Factors:  [99.59972695]
mat_Sqrt:  [[0.15]]
grads:  [0.03464276]
Stock Position:  0.03464276052192059
Bond Position:  [-5.85138912]


portfolio before change:  [-2.36014534]
curr_Stock_Price:  100.79956686250279
curr_Factors:  [100.79956686]
mat_Sqrt:  [[0.15]]
grads:  [-0.051839]
Stock Position:  -0.051838997924945805
Bond Position:  [2.8652032]


portfolio before change:  [-2.37659788]
curr_Stock_Price:  101.12385400071894
curr_Factors:  [101.123854]
mat_Sqrt:  [[0.15]]
grads:  [-0.0477954]
Stock Position:  -0.04779539785656158
Bond Position:  [2.45665695]


portfolio before change:  [-2.38485529]
curr_Stock_Price:  101.3030450620079
curr_Factors:  [101.30304506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0018789]
Stock Position:  -0.00187890083013001
Bond Position:  [-2.19451691]


portfolio before change:  [-2.38610808]
curr_Stock_Price:  101.82380508577126
curr_Factors:  [101.82380509]
mat_Sqrt:  [[0.15]]
grads:  [-0.07552659]
Stock Position:  -0.07552658863116651
Bond Position:  [5.30429656]


portfolio before change:  [-2.39876582]
curr_Stock_Price:  102.0001776376218
curr_Factors:  [102.00017764]
mat_Sqrt:  [[0.15]]
grads:  [0.10129495]
Stock Position:  0.10129494592384046
Bond Position:  [-12.7308683]


portfolio before change:  [-2.40457285]
curr_Stock_Price:  101.95856083700683
curr_Factors:  [101.95856084]
mat_Sqrt:  [[0.15]]
grads:  [-0.07224657]
Stock Position:  -0.07224657401682616
Bond Position:  [4.96158387]


portfolio before change:  [-2.42895863]
curr_Stock_Price:  102.30468136354222
curr_Factors:  [102.30468136]
mat_Sqrt:  [[0.15]]
grads:  [0.0013609]
Stock Position:  0.0013609024504927163
Bond Position:  [-2.56818532]


portfolio before change:  [-2.42951863]
curr_Stock_Price:  102.12909592071163
curr_Factors:  [102.12909592]
mat_Sqrt:  [[0.15]]
grads:  [0.03411392]
Stock Position:  0.03411391827402907
Bond Position:  [-5.91354226]


portfolio before change:  [-2.47963917]
curr_Stock_Price:  100.68155489397475
curr_Factors:  [100.68155489]
mat_Sqrt:  [[0.15]]
grads:  [0.0341142]
Stock Position:  0.034114204329624004
Bond Position:  [-5.9143103]


portfolio before change:  [-2.48830018]
curr_Stock_Price:  100.44934441750735
curr_Factors:  [100.44934442]
mat_Sqrt:  [[0.15]]
grads:  [-0.07269962]
Stock Position:  -0.07269962386202006
Bond Position:  [4.81432938]


portfolio before change:  [-2.46387589]
curr_Stock_Price:  100.12166103945157
curr_Factors:  [100.12166104]
mat_Sqrt:  [[0.15]]
grads:  [0.12993798]
Stock Position:  0.12993797829173973
Bond Position:  [-15.47348211]


portfolio before change:  [-2.41261045]
curr_Stock_Price:  100.53108519874145
curr_Factors:  [100.5310852]
mat_Sqrt:  [[0.15]]
grads:  [0.03676885]
Stock Position:  0.036768847171333364
Bond Position:  [-6.10902256]


portfolio before change:  [-2.44997419]
curr_Stock_Price:  99.53567563648504
curr_Factors:  [99.53567564]
mat_Sqrt:  [[0.15]]
grads:  [0.01812409]
Stock Position:  0.01812408511958646
Bond Position:  [-4.25396724]


portfolio before change:  [-2.45637546]
curr_Stock_Price:  99.21182491079897
curr_Factors:  [99.21182491]
mat_Sqrt:  [[0.15]]
grads:  [0.06259698]
Stock Position:  0.0625969778314099
Bond Position:  [-8.66673587]


portfolio before change:  [-2.4227292]
curr_Stock_Price:  99.76663874067552
curr_Factors:  [99.76663874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.4227292]
Stock Price:  99.55295247558378
PL:  [-2.4227292]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.33285506e-03]
 [-1.92038791e-03]
 [ 6.44579879e-03]
 [-2.82533918e-03]
 [ 1.36771367e-02]
 [ 1.51219352e-03]
 [ 1.41255488e-03]
 [ 1.60012723e-02]
 [-5.95623185e-03]
 [-3.67577354e-04]
 [ 6.53752104e-03]
 [ 6.72885665e-03]
 [ 1.38856840e-02]
 [ 2.91384936e-03]
 [ 8.12432718e-03]
 [-1.47678126e-03]
 [ 9.37968099e-03]
 [ 1.21239071e-02]
 [ 1.10796594e-02]
 [-1.26092534e-02]
 [-3.41107608e-03]
 [ 8.49660509e-04]
 [ 1.87258011e-02]
 [ 4.65162078e-03]
 [ 1.14955930e-02]
 [-1.09052765e-02]
 [ 1.30061639e-02]
 [-1.10342440e-02]
 [-1.77481557e-02]
 [-1.07634022e-02]
 [ 1.36588149e-04]
 [ 5.00728260e-03]
 [ 5.06894910e-03]
 [-5.49104890e-03]
 [ 2.04178886e-02]
 [ 5.59574869e-03]
 [ 2.41314255e-03]
 [ 7.92225153e-03]
 [-1.00914399e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.48334684]
curr_Stock_Price:  99.96975381682506
curr_Factors:  [99.96975382]
mat_Sqrt:  [[0.15]]
grads:  [0.02221903]
Stock Position:  0.02221903375551523
Bond Position:  [-0.7378845]


portfolio before change:  [1.47194895]
curr_Stock_Price:  99.46092682361011
curr_Factors:  [99.46092682]
mat_Sqrt:  [[0.15]]
grads:  [-0.01280259]
Stock Position:  -0.012802586041368523
Bond Position:  [2.74530602]


portfolio before change:  [1.46750438]
curr_Stock_Price:  99.83489426207701
curr_Factors:  [99.83489426]
mat_Sqrt:  [[0.15]]
grads:  [0.04297199]
Stock Position:  0.04297199190467806
Bond Position:  [-2.82259988]


portfolio before change:  [1.48562634]
curr_Stock_Price:  100.26482093325829
curr_Factors:  [100.26482093]
mat_Sqrt:  [[0.15]]
grads:  [-0.01883559]
Stock Position:  -0.018835594504575694
Bond Position:  [3.37417385]


portfolio before change:  [1.49100328]
curr_Stock_Price:  100.00174792082447
curr_Factors:  [100.00174792]
mat_Sqrt:  [[0.15]]
grads:  [0.09118091]
Stock Position:  0.09118091140961981
Bond Position:  [-7.62724724]


portfolio before change:  [1.43808797]
curr_Stock_Price:  99.43187159349856
curr_Factors:  [99.43187159]
mat_Sqrt:  [[0.15]]
grads:  [0.01008129]
Stock Position:  0.010081290103332037
Bond Position:  [0.43568643]


portfolio before change:  [1.44812757]
curr_Stock_Price:  100.42233378951121
curr_Factors:  [100.42233379]
mat_Sqrt:  [[0.15]]
grads:  [0.00941703]
Stock Position:  0.009417032527468332
Bond Position:  [0.50244719]


portfolio before change:  [1.45266816]
curr_Stock_Price:  100.89783146561189
curr_Factors:  [100.89783147]
mat_Sqrt:  [[0.15]]
grads:  [0.10667515]
Stock Position:  0.10667514864410407
Bond Position:  [-9.31062301]


portfolio before change:  [1.35897128]
curr_Stock_Price:  100.03040374593854
curr_Factors:  [100.03040375]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970821]
Stock Position:  -0.03970821230740768
Bond Position:  [5.33099978]


portfolio before change:  [1.32575408]
curr_Stock_Price:  100.88371870590332
curr_Factors:  [100.88371871]
mat_Sqrt:  [[0.15]]
grads:  [-0.00245052]
Stock Position:  -0.002450515690534871
Bond Position:  [1.57297122]


portfolio before change:  [1.32822771]
curr_Stock_Price:  99.95452711785249
curr_Factors:  [99.95452712]
mat_Sqrt:  [[0.15]]
grads:  [0.04358347]
Stock Position:  0.0435834735999924
Bond Position:  [-3.02813778]


portfolio before change:  [1.27510987]
curr_Stock_Price:  98.74445138772212
curr_Factors:  [98.74445139]
mat_Sqrt:  [[0.15]]
grads:  [0.04485904]
Stock Position:  0.044859044343376016
Bond Position:  [-3.15447185]


portfolio before change:  [1.28883893]
curr_Stock_Price:  99.05929080789699
curr_Factors:  [99.05929081]
mat_Sqrt:  [[0.15]]
grads:  [0.09257123]
Stock Position:  0.09257122639184996
Bond Position:  [-7.88120111]


portfolio before change:  [1.24829616]
curr_Stock_Price:  98.63197055229325
curr_Factors:  [98.63197055]
mat_Sqrt:  [[0.15]]
grads:  [0.01942566]
Stock Position:  0.019425662431820766
Bond Position:  [-0.66769521]


portfolio before change:  [1.25218123]
curr_Stock_Price:  98.83626423845585
curr_Factors:  [98.83626424]
mat_Sqrt:  [[0.15]]
grads:  [0.05416218]
Stock Position:  0.05416218116888575
Bond Position:  [-4.10100642]


portfolio before change:  [1.31072389]
curr_Stock_Price:  99.9266064681284
curr_Factors:  [99.92660647]
mat_Sqrt:  [[0.15]]
grads:  [-0.00984521]
Stock Position:  -0.009845208383464902
Bond Position:  [2.29452215]


portfolio before change:  [1.30722316]
curr_Stock_Price:  100.3113179277878
curr_Factors:  [100.31131793]
mat_Sqrt:  [[0.15]]
grads:  [0.06253121]
Stock Position:  0.06253120660541024
Bond Position:  [-4.96536459]


portfolio before change:  [1.31298196]
curr_Stock_Price:  100.41333917310725
curr_Factors:  [100.41333917]
mat_Sqrt:  [[0.15]]
grads:  [0.08082605]
Stock Position:  0.08082604741463727
Bond Position:  [-6.80303136]


portfolio before change:  [1.2303591]
curr_Stock_Price:  99.40163032887655
curr_Factors:  [99.40163033]
mat_Sqrt:  [[0.15]]
grads:  [0.0738644]
Stock Position:  0.07386439570149796
Bond Position:  [-6.11188226]


portfolio before change:  [1.32306388]
curr_Stock_Price:  100.66704123497134
curr_Factors:  [100.66704123]
mat_Sqrt:  [[0.15]]
grads:  [-0.08406169]
Stock Position:  -0.08406168947347205
Bond Position:  [9.78530544]


portfolio before change:  [1.39617551]
curr_Stock_Price:  99.81185506592256
curr_Factors:  [99.81185507]
mat_Sqrt:  [[0.15]]
grads:  [-0.02274051]
Stock Position:  -0.022740507201205233
Bond Position:  [3.66594772]


portfolio before change:  [1.43342093]
curr_Stock_Price:  98.19416261037989
curr_Factors:  [98.19416261]
mat_Sqrt:  [[0.15]]
grads:  [0.0056644]
Stock Position:  0.005664403390715639
Bond Position:  [0.87720958]


portfolio before change:  [1.43495825]
curr_Stock_Price:  98.44620345197794
curr_Factors:  [98.44620345]
mat_Sqrt:  [[0.15]]
grads:  [0.12483867]
Stock Position:  0.12483867405219345
Bond Position:  [-10.85493525]


portfolio before change:  [1.3608746]
curr_Stock_Price:  97.8636380340712
curr_Factors:  [97.86363803]
mat_Sqrt:  [[0.15]]
grads:  [0.03101081]
Stock Position:  0.031010805214280315
Bond Position:  [-1.67395561]


portfolio before change:  [1.38954925]
curr_Stock_Price:  98.79505225154116
curr_Factors:  [98.79505225]
mat_Sqrt:  [[0.15]]
grads:  [0.07663729]
Stock Position:  0.07663728680839994
Bond Position:  [-6.1818355]


portfolio before change:  [1.4146148]
curr_Stock_Price:  99.13220310073926
curr_Factors:  [99.1322031]
mat_Sqrt:  [[0.15]]
grads:  [-0.07270184]
Stock Position:  -0.07270184338177983
Bond Position:  [8.6217087]


portfolio before change:  [1.42050774]
curr_Stock_Price:  99.06597156326804
curr_Factors:  [99.06597156]
mat_Sqrt:  [[0.15]]
grads:  [0.08670776]
Stock Position:  0.08670775963869208
Bond Position:  [-7.16928072]


portfolio before change:  [1.46823805]
curr_Stock_Price:  99.62678096572847
curr_Factors:  [99.62678097]
mat_Sqrt:  [[0.15]]
grads:  [-0.07356163]
Stock Position:  -0.07356162638733311
Bond Position:  [8.79694609]


portfolio before change:  [1.4509966]
curr_Stock_Price:  99.87611112302669
curr_Factors:  [99.87611112]
mat_Sqrt:  [[0.15]]
grads:  [-0.11832104]
Stock Position:  -0.11832103778541705
Bond Position:  [13.26844172]


portfolio before change:  [1.19269539]
curr_Stock_Price:  102.07318336025396
curr_Factors:  [102.07318336]
mat_Sqrt:  [[0.15]]
grads:  [-0.07175601]
Stock Position:  -0.07175601483229307
Bond Position:  [8.51706025]


portfolio before change:  [1.18764893]
curr_Stock_Price:  102.15834922249785
curr_Factors:  [102.15834922]
mat_Sqrt:  [[0.15]]
grads:  [0.00091059]
Stock Position:  0.0009105876604939154
Bond Position:  [1.0946248]


portfolio before change:  [1.1882743]
curr_Stock_Price:  102.69485122743866
curr_Factors:  [102.69485123]
mat_Sqrt:  [[0.15]]
grads:  [0.03338188]
Stock Position:  0.033381884007302236
Bond Position:  [-2.23987331]


portfolio before change:  [1.16357641]
curr_Stock_Price:  101.96338011928196
curr_Factors:  [101.96338012]
mat_Sqrt:  [[0.15]]
grads:  [0.03379299]
Stock Position:  0.03379299402000292
Bond Position:  [-2.28207148]


portfolio before change:  [1.17043274]
curr_Stock_Price:  102.17471407420523
curr_Factors:  [102.17471407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660699]
Stock Position:  -0.036606992686296906
Bond Position:  [4.91074175]


portfolio before change:  [1.23064384]
curr_Stock_Price:  100.54668591389031
curr_Factors:  [100.54668591]
mat_Sqrt:  [[0.15]]
grads:  [0.13611926]
Stock Position:  0.13611925765643282
Bond Position:  [-12.45569641]


portfolio before change:  [1.16729427]
curr_Stock_Price:  100.09272728199633
curr_Factors:  [100.09272728]
mat_Sqrt:  [[0.15]]
grads:  [0.03730499]
Stock Position:  0.037304991266913196
Bond Position:  [-2.56666405]


portfolio before change:  [1.16195346]
curr_Stock_Price:  99.9581619587524
curr_Factors:  [99.95816196]
mat_Sqrt:  [[0.15]]
grads:  [0.01608762]
Stock Position:  0.016087616992377228
Bond Position:  [-0.44613517]


portfolio before change:  [1.16930744]
curr_Stock_Price:  100.41874964662415
curr_Factors:  [100.41874965]
mat_Sqrt:  [[0.15]]
grads:  [0.05281501]
Stock Position:  0.05281501022381208
Bond Position:  [-4.13430984]


portfolio before change:  [1.18982004]
curr_Stock_Price:  100.81692078457202
curr_Factors:  [100.81692078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.18982004]
Stock Price:  101.17630488990271
PL:  [0.01351515]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.26565907e-03]
 [ 3.74259203e-03]
 [ 9.16048454e-04]
 [-2.73162975e-03]
 [ 1.53582963e-02]
 [ 2.60052890e-02]
 [-5.63283385e-03]
 [ 2.16860770e-02]
 [-5.94575593e-03]
 [-2.57501000e-03]
 [ 1.25727252e-02]
 [ 6.29213891e-03]
 [ 4.14065369e-03]
 [-4.14730929e-03]
 [-6.22740193e-04]
 [ 4.70191084e-03]
 [ 9.22412527e-03]
 [-1.99500668e-02]
 [ 1.22077542e-02]
 [-1.69533796e-02]
 [ 1.13096871e-02]
 [ 4.26054130e-02]
 [ 2.82683171e-03]
 [ 7.71826689e-03]
 [ 5.83086598e-03]
 [-1.09293947e-02]
 [-3.68263958e-04]
 [-1.11918589e-02]
 [ 5.93604027e-02]
 [-4.23483242e-03]
 [-6.19556476e-03]
 [ 4.58236072e-03]
 [ 5.86368271e-03]
 [-2.56703968e-03]
 [ 7.55132427e-03]
 [ 4.49993605e-03]
 [-2.95002902e-02]
 [ 9.95490627e-03]
 [-1.26442249e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.54715836]
curr_Stock_Price:  100.48994521123771
curr_Factors:  [100.48994521]
mat_Sqrt:  [[0.15]]
grads:  [0.04177106]
Stock Position:  0.04177106043551635
Bond Position:  [5.34958679]


portfolio before change:  [9.52329037]
curr_Stock_Price:  99.90253528618989
curr_Factors:  [99.90253529]
mat_Sqrt:  [[0.15]]
grads:  [0.02495061]
Stock Position:  0.02495061354643495
Bond Position:  [7.03066082]


portfolio before change:  [9.51163723]
curr_Stock_Price:  99.40026212735117
curr_Factors:  [99.40026213]
mat_Sqrt:  [[0.15]]
grads:  [0.00610699]
Stock Position:  0.0061069896906865056
Bond Position:  [8.90460086]


portfolio before change:  [9.51612246]
curr_Stock_Price:  99.95243048598194
curr_Factors:  [99.95243049]
mat_Sqrt:  [[0.15]]
grads:  [-0.01821087]
Stock Position:  -0.01821086502659411
Bond Position:  [11.33634268]


portfolio before change:  [9.50564945]
curr_Stock_Price:  100.60534543924678
curr_Factors:  [100.60534544]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-0.79519526]


portfolio before change:  [9.52338466]
curr_Stock_Price:  100.77953093706468
curr_Factors:  [100.77953094]
mat_Sqrt:  [[0.15]]
grads:  [0.17336859]
Stock Position:  0.17336859313755354
Bond Position:  [-7.94862084]


portfolio before change:  [9.57540823]
curr_Stock_Price:  101.08533723618343
curr_Factors:  [101.08533724]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755223]
Stock Position:  -0.037552225674555684
Bond Position:  [13.37138762]


portfolio before change:  [9.61618085]
curr_Stock_Price:  100.04409141433916
curr_Factors:  [100.04409141]
mat_Sqrt:  [[0.15]]
grads:  [0.14457385]
Stock Position:  0.1445738469720825
Bond Position:  [-4.84757831]


portfolio before change:  [9.60381743]
curr_Stock_Price:  99.96276665599869
curr_Factors:  [99.96276666]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963837]
Stock Position:  -0.03963837288130671
Bond Position:  [13.56617885]


portfolio before change:  [9.53754578]
curr_Stock_Price:  101.67745692945682
curr_Factors:  [101.67745693]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716673]
Stock Position:  -0.017166733323498048
Bond Position:  [11.28301557]


portfolio before change:  [9.52948816]
curr_Stock_Price:  102.22899361413712
curr_Factors:  [102.22899361]
mat_Sqrt:  [[0.15]]
grads:  [0.08381817]
Stock Position:  0.0838181682611162
Bond Position:  [0.96084117]


portfolio before change:  [9.54379812]
curr_Stock_Price:  102.39828682993844
curr_Factors:  [102.39828683]
mat_Sqrt:  [[0.15]]
grads:  [0.04194759]
Stock Position:  0.04194759272529764
Bond Position:  [5.24843649]


portfolio before change:  [9.58762508]
curr_Stock_Price:  103.42744874909162
curr_Factors:  [103.42744875]
mat_Sqrt:  [[0.15]]
grads:  [0.02760436]
Stock Position:  0.027604357950272013
Bond Position:  [6.73257677]


portfolio before change:  [9.5898153]
curr_Stock_Price:  103.47630293801744
curr_Factors:  [103.47630294]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764873]
Stock Position:  -0.027648728567529063
Bond Position:  [12.45080351]


portfolio before change:  [9.54678563]
curr_Stock_Price:  105.0888947914272
curr_Factors:  [105.08889479]
mat_Sqrt:  [[0.15]]
grads:  [-0.0041516]
Stock Position:  -0.00415160128812348
Bond Position:  [9.98307282]


portfolio before change:  [9.54782788]
curr_Stock_Price:  105.13844471371831
curr_Factors:  [105.13844471]
mat_Sqrt:  [[0.15]]
grads:  [0.03134607]
Stock Position:  0.031346072253033354
Bond Position:  [6.2521506]


portfolio before change:  [9.56986776]
curr_Stock_Price:  105.81662571911603
curr_Factors:  [105.81662572]
mat_Sqrt:  [[0.15]]
grads:  [0.06149417]
Stock Position:  0.06149416849419793
Bond Position:  [3.06276235]


portfolio before change:  [9.59296377]
curr_Stock_Price:  106.18598009702623
curr_Factors:  [106.1859801]
mat_Sqrt:  [[0.15]]
grads:  [-0.13300045]
Stock Position:  -0.13300044502633337
Bond Position:  [23.71574638]


portfolio before change:  [9.72545389]
curr_Stock_Price:  105.21210762232272
curr_Factors:  [105.21210762]
mat_Sqrt:  [[0.15]]
grads:  [0.08138503]
Stock Position:  0.08138502782942438
Bond Position:  [1.16276359]


portfolio before change:  [9.70012234]
curr_Stock_Price:  104.89906586586034
curr_Factors:  [104.89906587]
mat_Sqrt:  [[0.15]]
grads:  [-0.11302253]
Stock Position:  -0.11302253040126216
Bond Position:  [21.5560802]


portfolio before change:  [9.66873649]
curr_Stock_Price:  105.20060328803882
curr_Factors:  [105.20060329]
mat_Sqrt:  [[0.15]]
grads:  [0.07539791]
Stock Position:  0.075397914070815
Bond Position:  [1.73683045]


portfolio before change:  [9.74055807]
curr_Stock_Price:  106.15029079208739
curr_Factors:  [106.15029079]
mat_Sqrt:  [[0.15]]
grads:  [0.28403609]
Stock Position:  0.2840360864945451
Bond Position:  [-20.40995511]


portfolio before change:  [9.6050606]
curr_Stock_Price:  105.68223033610604
curr_Factors:  [105.68223034]
mat_Sqrt:  [[0.15]]
grads:  [0.01884554]
Stock Position:  0.018845544748919522
Bond Position:  [7.6134214]


portfolio before change:  [9.60360245]
curr_Stock_Price:  105.55435433688596
curr_Factors:  [105.55435434]
mat_Sqrt:  [[0.15]]
grads:  [0.05145511]
Stock Position:  0.05145511259364843
Bond Position:  [4.17229126]


portfolio before change:  [9.51018792]
curr_Stock_Price:  103.72876135698202
curr_Factors:  [103.72876136]
mat_Sqrt:  [[0.15]]
grads:  [0.03887244]
Stock Position:  0.03887243983515732
Bond Position:  [5.47799789]


portfolio before change:  [9.50631603]
curr_Stock_Price:  103.61153990363304
curr_Factors:  [103.6115399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07286263]
Stock Position:  -0.07286263117053884
Bond Position:  [17.05572545]


portfolio before change:  [9.41934226]
curr_Stock_Price:  104.8344695763033
curr_Factors:  [104.83446958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00245509]
Stock Position:  -0.002455093053514816
Bond Position:  [9.67672064]


portfolio before change:  [9.42029197]
curr_Stock_Price:  104.94035192628154
curr_Factors:  [104.94035193]
mat_Sqrt:  [[0.15]]
grads:  [-0.07461239]
Stock Position:  -0.07461239299075917
Bond Position:  [17.25014275]


portfolio before change:  [9.41006937]
curr_Stock_Price:  105.10626274096006
curr_Factors:  [105.10626274]
mat_Sqrt:  [[0.15]]
grads:  [0.39573602]
Stock Position:  0.39573601821351473
Bond Position:  [-32.18426453]


portfolio before change:  [9.3366292]
curr_Stock_Price:  104.93085064898384
curr_Factors:  [104.93085065]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823222]
Stock Position:  -0.0282322161185728
Bond Position:  [12.29905966]


portfolio before change:  [9.35297757]
curr_Stock_Price:  104.40624139604478
curr_Factors:  [104.4062414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04130377]
Stock Position:  -0.04130376505866477
Bond Position:  [13.66534843]


portfolio before change:  [9.33707871]
curr_Stock_Price:  104.83252520506673
curr_Factors:  [104.83252521]
mat_Sqrt:  [[0.15]]
grads:  [0.03054907]
Stock Position:  0.03054907146405482
Bond Position:  [6.13454241]


portfolio before change:  [9.33161182]
curr_Stock_Price:  104.62846784662591
curr_Factors:  [104.62846785]
mat_Sqrt:  [[0.15]]
grads:  [0.03909122]
Stock Position:  0.039091218077932054
Bond Position:  [5.24155756]


portfolio before change:  [9.34493934]
curr_Stock_Price:  104.95264015984064
curr_Factors:  [104.95264016]
mat_Sqrt:  [[0.15]]
grads:  [-0.0171136]
Stock Position:  -0.017113597876600696
Bond Position:  [11.14105662]


portfolio before change:  [9.33245808]
curr_Stock_Price:  105.76333950258037
curr_Factors:  [105.7633395]
mat_Sqrt:  [[0.15]]
grads:  [0.05034216]
Stock Position:  0.05034216182756367
Bond Position:  [4.00810293]


portfolio before change:  [9.30055598]
curr_Stock_Price:  105.11968125706363
curr_Factors:  [105.11968126]
mat_Sqrt:  [[0.15]]
grads:  [0.02999957]
Stock Position:  0.02999957368799347
Bond Position:  [6.14701035]


portfolio before change:  [9.31149763]
curr_Stock_Price:  105.45879378635516
curr_Factors:  [105.45879379]
mat_Sqrt:  [[0.15]]
grads:  [-0.1966686]
Stock Position:  -0.19666860106126544
Bond Position:  [30.05193108]


portfolio before change:  [9.37204218]
curr_Stock_Price:  105.17004500943243
curr_Factors:  [105.17004501]
mat_Sqrt:  [[0.15]]
grads:  [0.06636604]
Stock Position:  0.06636604178495026
Bond Position:  [2.39232257]


portfolio before change:  [9.31723788]
curr_Stock_Price:  104.33975058904139
curr_Factors:  [104.33975059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.31723788]
Stock Price:  104.45222160247312
PL:  [4.86501628]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.70790633e-03]
 [ 3.96747240e-03]
 [ 1.53017614e-02]
 [ 5.10853054e-03]
 [ 1.41060640e-02]
 [ 2.98140421e-02]
 [ 3.55795961e-02]
 [ 1.29171950e-03]
 [-1.03404488e-02]
 [-3.02015906e-03]
 [ 1.07693903e-02]
 [ 5.45836458e-03]
 [ 6.58809323e-03]
 [-5.02182494e-03]
 [ 1.01938500e-02]
 [ 3.20182414e-03]
 [ 9.14543961e-03]
 [ 1.64957548e-03]
 [ 1.20321893e-02]
 [-1.72914733e-02]
 [ 1.41507734e-02]
 [ 4.63914312e-02]
 [ 1.29417781e-02]
 [ 7.00211011e-03]
 [ 7.83557467e-03]
 [-2.17748274e-02]
 [ 6.68994439e-04]
 [-1.25829478e-02]
 [ 6.62682628e-02]
 [-2.97243745e-03]
 [-1.37066210e-02]
 [ 3.87072134e-03]
 [ 7.59713158e-03]
 [ 3.79816134e-03]
 [ 8.18248817e-03]
 [ 4.27896728e-03]
 [-3.70864899e-02]
 [ 9.48921827e-03]
 [-3.02015841e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.05770587]
curr_Stock_Price:  100.97444589299671
curr_Factors:  [100.97444589]
mat_Sqrt:  [[0.15]]
grads:  [0.04471938]
Stock Position:  0.04471937552108007
Bond Position:  [12.54219171]


portfolio before change:  [17.03911575]
curr_Stock_Price:  100.52367948556612
curr_Factors:  [100.52367949]
mat_Sqrt:  [[0.15]]
grads:  [0.02644982]
Stock Position:  0.026449815997538786
Bond Position:  [14.38028293]


portfolio before change:  [17.06347614]
curr_Stock_Price:  101.37671886523958
curr_Factors:  [101.37671887]
mat_Sqrt:  [[0.15]]
grads:  [0.10201174]
Stock Position:  0.10201174255676325
Bond Position:  [6.72186039]


portfolio before change:  [17.09731849]
curr_Stock_Price:  101.70023127791777
curr_Factors:  [101.70023128]
mat_Sqrt:  [[0.15]]
grads:  [0.03405687]
Stock Position:  0.03405687027463764
Bond Position:  [13.6337269]


portfolio before change:  [17.09225936]
curr_Stock_Price:  101.50163837656892
curr_Factors:  [101.50163838]
mat_Sqrt:  [[0.15]]
grads:  [0.09404043]
Stock Position:  0.09404042640525952
Bond Position:  [7.547002]


portfolio before change:  [17.19760476]
curr_Stock_Price:  102.61182016659275
curr_Factors:  [102.61182017]
mat_Sqrt:  [[0.15]]
grads:  [0.19876028]
Stock Position:  0.1987602805464261
Bond Position:  [-3.19754941]


portfolio before change:  [17.36902843]
curr_Stock_Price:  103.47629566826637
curr_Factors:  [103.47629567]
mat_Sqrt:  [[0.15]]
grads:  [0.23719731]
Stock Position:  0.23719730759955995
Bond Position:  [-7.1752703]


portfolio before change:  [17.38272939]
curr_Stock_Price:  103.53783902287648
curr_Factors:  [103.53783902]
mat_Sqrt:  [[0.15]]
grads:  [0.00861146]
Stock Position:  0.0086114633118141
Bond Position:  [16.49111708]


portfolio before change:  [17.38125916]
curr_Stock_Price:  103.12771829815244
curr_Factors:  [103.1277183]
mat_Sqrt:  [[0.15]]
grads:  [-0.06893633]
Stock Position:  -0.06893632525303946
Bond Position:  [24.4905051]


portfolio before change:  [17.43234003]
curr_Stock_Price:  102.4311426879978
curr_Factors:  [102.43114269]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013439]
Stock Position:  -0.020134393751612356
Bond Position:  [19.49472899]


portfolio before change:  [17.44785741]
curr_Stock_Price:  101.78148890236986
curr_Factors:  [101.7814889]
mat_Sqrt:  [[0.15]]
grads:  [0.07179594]
Stock Position:  0.07179593525487266
Bond Position:  [10.14036022]


portfolio before change:  [17.4574048]
curr_Stock_Price:  101.89681249627337
curr_Factors:  [101.8968125]
mat_Sqrt:  [[0.15]]
grads:  [0.0363891]
Stock Position:  0.03638909720131266
Bond Position:  [13.74947179]


portfolio before change:  [17.48572006]
curr_Stock_Price:  102.6277036886134
curr_Factors:  [102.62770369]
mat_Sqrt:  [[0.15]]
grads:  [0.04392062]
Stock Position:  0.043920621559788306
Bond Position:  [12.97824753]


portfolio before change:  [17.47608094]
curr_Stock_Price:  102.37129775763955
curr_Factors:  [102.37129776]
mat_Sqrt:  [[0.15]]
grads:  [-0.03347883]
Stock Position:  -0.03347883291547567
Bond Position:  [20.90335251]


portfolio before change:  [17.46724888]
curr_Stock_Price:  102.71315984544701
curr_Factors:  [102.71315985]
mat_Sqrt:  [[0.15]]
grads:  [0.067959]
Stock Position:  0.06795900028978351
Bond Position:  [10.48696522]


portfolio before change:  [17.53965924]
curr_Stock_Price:  103.75937021433056
curr_Factors:  [103.75937021]
mat_Sqrt:  [[0.15]]
grads:  [0.02134549]
Stock Position:  0.021345494264331494
Bond Position:  [15.3248642]


portfolio before change:  [17.55170611]
curr_Stock_Price:  104.23399714871317
curr_Factors:  [104.23399715]
mat_Sqrt:  [[0.15]]
grads:  [0.0609696]
Stock Position:  0.060969597367271644
Bond Position:  [11.19660127]


portfolio before change:  [17.54053685]
curr_Stock_Price:  104.0278464726724
curr_Factors:  [104.02784647]
mat_Sqrt:  [[0.15]]
grads:  [0.01099717]
Stock Position:  0.010997169886413916
Bond Position:  [16.39652495]


portfolio before change:  [17.54788043]
curr_Stock_Price:  104.50923247793075
curr_Factors:  [104.50923248]
mat_Sqrt:  [[0.15]]
grads:  [0.0802146]
Stock Position:  0.08021459550729945
Bond Position:  [9.16471462]


portfolio before change:  [17.61155881]
curr_Stock_Price:  105.28880031556216
curr_Factors:  [105.28880032]
mat_Sqrt:  [[0.15]]
grads:  [-0.11527649]
Stock Position:  -0.11527648881006235
Bond Position:  [29.74888202]


portfolio before change:  [17.55793347]
curr_Stock_Price:  105.78624934318641
curr_Factors:  [105.78624934]
mat_Sqrt:  [[0.15]]
grads:  [0.09433849]
Stock Position:  0.09433848905914806
Bond Position:  [7.57821855]


portfolio before change:  [17.67567506]
curr_Stock_Price:  107.02428325534814
curr_Factors:  [107.02428326]
mat_Sqrt:  [[0.15]]
grads:  [0.30927621]
Stock Position:  0.309276208188908
Bond Position:  [-15.42438945]


portfolio before change:  [17.43297265]
curr_Stock_Price:  106.2457744799442
curr_Factors:  [106.24577448]
mat_Sqrt:  [[0.15]]
grads:  [0.08627852]
Stock Position:  0.08627852044270397
Bond Position:  [8.26624442]


portfolio before change:  [17.5124481]
curr_Stock_Price:  107.15494755572159
curr_Factors:  [107.15494756]
mat_Sqrt:  [[0.15]]
grads:  [0.04668073]
Stock Position:  0.04668073409141125
Bond Position:  [12.51037649]


portfolio before change:  [17.49522381]
curr_Stock_Price:  106.75246495220274
curr_Factors:  [106.75246495]
mat_Sqrt:  [[0.15]]
grads:  [0.05223716]
Stock Position:  0.05223716447770219
Bond Position:  [11.91877774]


portfolio before change:  [17.47103187]
curr_Stock_Price:  106.26082490462062
curr_Factors:  [106.2608249]
mat_Sqrt:  [[0.15]]
grads:  [-0.14516552]
Stock Position:  -0.1451655160887489
Bond Position:  [32.89643936]


portfolio before change:  [17.42790332]
curr_Stock_Price:  106.58625250703032
curr_Factors:  [106.58625251]
mat_Sqrt:  [[0.15]]
grads:  [0.00445996]
Stock Position:  0.004459962925162199
Bond Position:  [16.95253258]


portfolio before change:  [17.42797437]
curr_Stock_Price:  106.12702314003374
curr_Factors:  [106.12702314]
mat_Sqrt:  [[0.15]]
grads:  [-0.08388632]
Stock Position:  -0.08388631898707762
Bond Position:  [26.33057969]


portfolio before change:  [17.40348547]
curr_Stock_Price:  106.45819076512271
curr_Factors:  [106.45819077]
mat_Sqrt:  [[0.15]]
grads:  [0.44178842]
Stock Position:  0.44178841866598245
Bond Position:  [-29.62851029]


portfolio before change:  [17.36671467]
curr_Stock_Price:  106.38334272792697
curr_Factors:  [106.38334273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981625]
Stock Position:  -0.019816249634021628
Bond Position:  [19.47483355]


portfolio before change:  [17.345065]
curr_Stock_Price:  107.59871781766417
curr_Factors:  [107.59871782]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137747]
Stock Position:  -0.09137747316127505
Bond Position:  [27.17716395]


portfolio before change:  [17.27658707]
curr_Stock_Price:  108.38529338189848
curr_Factors:  [108.38529338]
mat_Sqrt:  [[0.15]]
grads:  [0.02580481]
Stock Position:  0.025804808903362016
Bond Position:  [14.47972529]


portfolio before change:  [17.29496615]
curr_Stock_Price:  109.02738276742382
curr_Factors:  [109.02738277]
mat_Sqrt:  [[0.15]]
grads:  [0.05064754]
Stock Position:  0.05064754384853389
Bond Position:  [11.772997]


portfolio before change:  [17.23846783]
curr_Stock_Price:  107.88280536587006
curr_Factors:  [107.88280537]
mat_Sqrt:  [[0.15]]
grads:  [0.02532108]
Stock Position:  0.025321075609063978
Bond Position:  [14.50675916]


portfolio before change:  [17.23431703]
curr_Stock_Price:  107.64726016718843
curr_Factors:  [107.64726017]
mat_Sqrt:  [[0.15]]
grads:  [0.05454992]
Stock Position:  0.05454992112855335
Bond Position:  [11.36216748]


portfolio before change:  [17.12502503]
curr_Stock_Price:  105.61769983925163
curr_Factors:  [105.61769984]
mat_Sqrt:  [[0.15]]
grads:  [0.02852645]
Stock Position:  0.028526448557177713
Bond Position:  [14.11212715]


portfolio before change:  [17.14089642]
curr_Stock_Price:  106.11223254065871
curr_Factors:  [106.11223254]
mat_Sqrt:  [[0.15]]
grads:  [-0.24724327]
Stock Position:  -0.2472432660094982
Bond Position:  [43.37643136]


portfolio before change:  [16.83681068]
curr_Stock_Price:  107.3640690052879
curr_Factors:  [107.36406901]
mat_Sqrt:  [[0.15]]
grads:  [0.06326146]
Stock Position:  0.06326145510285022
Bond Position:  [10.04480345]


portfolio before change:  [16.89967552]
curr_Stock_Price:  108.33795056653881
curr_Factors:  [108.33795057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.89967552]
Stock Price:  108.42359006212898
PL:  [8.47608546]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.48140858e-03]
 [ 3.07797059e-03]
 [ 1.33022268e-02]
 [-1.40264912e-03]
 [ 1.45319391e-02]
 [ 1.79684701e-02]
 [-4.74057930e-03]
 [ 2.33229742e-02]
 [-5.92834056e-03]
 [-7.48567689e-04]
 [-6.35818626e-03]
 [ 7.51965838e-03]
 [ 1.38939327e-02]
 [ 9.58328816e-04]
 [ 4.99823131e-04]
 [-3.33661321e-03]
 [ 1.33853354e-02]
 [-7.83480307e-03]
 [ 1.01062646e-02]
 [-1.22566054e-02]
 [-4.50699995e-03]
 [ 3.23084970e-03]
 [ 1.42871325e-02]
 [ 6.12759962e-03]
 [-6.20334380e-04]
 [-7.88106222e-03]
 [-8.69001388e-04]
 [-1.12855717e-02]
 [ 5.33607621e-03]
 [-9.51338961e-03]
 [-1.66195499e-03]
 [ 5.01499764e-03]
 [ 5.09331434e-03]
 [-9.18811405e-03]
 [ 2.10319612e-02]
 [ 5.46549221e-03]
 [ 2.24745976e-03]
 [ 7.85341795e-03]
 [-2.71800701e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.64210363]
curr_Stock_Price:  100.23803259387087
curr_Factors:  [100.23803259]
mat_Sqrt:  [[0.15]]
grads:  [0.04320939]
Stock Position:  0.04320939055427356
Bond Position:  [1.31087933]


portfolio before change:  [5.66378556]
curr_Stock_Price:  100.73602773227492
curr_Factors:  [100.73602773]
mat_Sqrt:  [[0.15]]
grads:  [0.0205198]
Stock Position:  0.02051980392505072
Bond Position:  [3.59670203]


portfolio before change:  [5.66682176]
curr_Stock_Price:  100.86208033874716
curr_Factors:  [100.86208034]
mat_Sqrt:  [[0.15]]
grads:  [0.08868151]
Stock Position:  0.08868151224477737
Bond Position:  [-3.27778006]


portfolio before change:  [5.6649412]
curr_Stock_Price:  100.84549502543172
curr_Factors:  [100.84549503]
mat_Sqrt:  [[0.15]]
grads:  [-0.00935099]
Stock Position:  -0.00935099414590062
Bond Position:  [6.60794683]


portfolio before change:  [5.6728355]
curr_Stock_Price:  100.0896116549534
curr_Factors:  [100.08961165]
mat_Sqrt:  [[0.15]]
grads:  [0.09687959]
Stock Position:  0.09687959414921037
Bond Position:  [-4.02380545]


portfolio before change:  [5.67525738]
curr_Stock_Price:  100.11980257405557
curr_Factors:  [100.11980257]
mat_Sqrt:  [[0.15]]
grads:  [0.1197898]
Stock Position:  0.11978980083314379
Bond Position:  [-6.31807383]


portfolio before change:  [5.63907553]
curr_Stock_Price:  99.8243513376637
curr_Factors:  [99.82435134]
mat_Sqrt:  [[0.15]]
grads:  [-0.03160386]
Stock Position:  -0.03160386196733609
Bond Position:  [8.79391055]


portfolio before change:  [5.66040253]
curr_Stock_Price:  99.18431249425497
curr_Factors:  [99.18431249]
mat_Sqrt:  [[0.15]]
grads:  [0.15548649]
Stock Position:  0.15548649479459253
Bond Position:  [-9.76141856]


portfolio before change:  [5.56968101]
curr_Stock_Price:  98.6086916687298
curr_Factors:  [98.60869167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03952227]
Stock Position:  -0.03952227039964412
Bond Position:  [9.46692039]


portfolio before change:  [5.59944053]
curr_Stock_Price:  97.88565445072122
curr_Factors:  [97.88565445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00499045]
Stock Position:  -0.00499045125895789
Bond Position:  [6.08793411]


portfolio before change:  [5.60207162]
curr_Stock_Price:  97.51092833675087
curr_Factors:  [97.51092834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04238791]
Stock Position:  -0.042387908428265696
Bond Position:  [9.73535592]


portfolio before change:  [5.62820766]
curr_Stock_Price:  96.92304725008493
curr_Factors:  [96.92304725]
mat_Sqrt:  [[0.15]]
grads:  [0.05013106]
Stock Position:  0.05013105587536775
Bond Position:  [0.76935297]


portfolio before change:  [5.62080011]
curr_Stock_Price:  96.77336502172766
curr_Factors:  [96.77336502]
mat_Sqrt:  [[0.15]]
grads:  [0.09262622]
Stock Position:  0.0926262177036449
Bond Position:  [-3.34295067]


portfolio before change:  [5.62281039]
curr_Stock_Price:  96.79957982109315
curr_Factors:  [96.79957982]
mat_Sqrt:  [[0.15]]
grads:  [0.00638886]
Stock Position:  0.006388858775380396
Bond Position:  [5.00437155]


portfolio before change:  [5.62720944]
curr_Stock_Price:  97.39021107893593
curr_Factors:  [97.39021108]
mat_Sqrt:  [[0.15]]
grads:  [0.00333215]
Stock Position:  0.0033321542092328536
Bond Position:  [5.30269024]


portfolio before change:  [5.63157538]
curr_Stock_Price:  98.50152362437335
curr_Factors:  [98.50152362]
mat_Sqrt:  [[0.15]]
grads:  [-0.02224409]
Stock Position:  -0.022244088033566683
Bond Position:  [7.82265194]


portfolio before change:  [5.63356015]
curr_Stock_Price:  98.45625857876543
curr_Factors:  [98.45625858]
mat_Sqrt:  [[0.15]]
grads:  [0.08923557]
Stock Position:  0.08923556917925637
Bond Position:  [-3.15224012]


portfolio before change:  [5.62674134]
curr_Stock_Price:  98.38426088255581
curr_Factors:  [98.38426088]
mat_Sqrt:  [[0.15]]
grads:  [-0.05223202]
Stock Position:  -0.05223202046297233
Bond Position:  [10.76555007]


portfolio before change:  [5.58918083]
curr_Stock_Price:  99.12913524210457
curr_Factors:  [99.12913524]
mat_Sqrt:  [[0.15]]
grads:  [0.0673751]
Stock Position:  0.06737509763680301
Bond Position:  [-1.08965434]


portfolio before change:  [5.61773019]
curr_Stock_Price:  99.55489457600122
curr_Factors:  [99.55489458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0817107]
Stock Position:  -0.08171070256508127
Bond Position:  [13.75243057]


portfolio before change:  [5.59346713]
curr_Stock_Price:  99.8728728062595
curr_Factors:  [99.87287281]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004667]
Stock Position:  -0.030046666323996912
Bond Position:  [8.59431401]


portfolio before change:  [5.63315822]
curr_Stock_Price:  98.58764737355847
curr_Factors:  [98.58764737]
mat_Sqrt:  [[0.15]]
grads:  [0.021539]
Stock Position:  0.02153899797333899
Bond Position:  [3.50967909]


portfolio before change:  [5.65168126]
curr_Stock_Price:  99.42725484048789
curr_Factors:  [99.42725484]
mat_Sqrt:  [[0.15]]
grads:  [0.09524755]
Stock Position:  0.09524754988740901
Bond Position:  [-3.81852115]


portfolio before change:  [5.81818298]
curr_Stock_Price:  101.180360978698
curr_Factors:  [101.18036098]
mat_Sqrt:  [[0.15]]
grads:  [0.04085066]
Stock Position:  0.04085066414627062
Bond Position:  [1.68489804]


portfolio before change:  [5.76683002]
curr_Stock_Price:  99.91811506276086
curr_Factors:  [99.91811506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00413556]
Stock Position:  -0.004135562530188652
Bond Position:  [6.18004764]


portfolio before change:  [5.76401537]
curr_Stock_Price:  100.78551935522657
curr_Factors:  [100.78551936]
mat_Sqrt:  [[0.15]]
grads:  [-0.05254041]
Stock Position:  -0.05254041476780149
Bond Position:  [11.05932836]


portfolio before change:  [5.72102982]
curr_Stock_Price:  101.62997514348504
curr_Factors:  [101.62997514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00579334]
Stock Position:  -0.005793342586018132
Bond Position:  [6.30980708]


portfolio before change:  [5.72266421]
curr_Stock_Price:  101.48401202243882
curr_Factors:  [101.48401202]
mat_Sqrt:  [[0.15]]
grads:  [-0.07523714]
Stock Position:  -0.07523714479034115
Bond Position:  [13.35803151]


portfolio before change:  [5.7030288]
curr_Stock_Price:  101.76718680592022
curr_Factors:  [101.76718681]
mat_Sqrt:  [[0.15]]
grads:  [0.03557384]
Stock Position:  0.03557384138203965
Bond Position:  [2.08277904]


portfolio before change:  [5.73915009]
curr_Stock_Price:  102.77525681132659
curr_Factors:  [102.77525681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0634226]
Stock Position:  -0.06342259740792743
Bond Position:  [12.25742383]


portfolio before change:  [5.73732831]
curr_Stock_Price:  102.82814106096733
curr_Factors:  [102.82814106]
mat_Sqrt:  [[0.15]]
grads:  [-0.0110797]
Stock Position:  -0.011079699914318383
Bond Position:  [6.87663325]


portfolio before change:  [5.74010518]
curr_Stock_Price:  102.65510058234905
curr_Factors:  [102.65510058]
mat_Sqrt:  [[0.15]]
grads:  [0.03343332]
Stock Position:  0.03343331761116615
Bond Position:  [2.30800459]


portfolio before change:  [5.70992779]
curr_Stock_Price:  101.7438566257031
curr_Factors:  [101.74385663]
mat_Sqrt:  [[0.15]]
grads:  [0.03395543]
Stock Position:  0.03395542890895397
Bond Position:  [2.2551715]


portfolio before change:  [5.68887978]
curr_Stock_Price:  101.1156825291078
curr_Factors:  [101.11568253]
mat_Sqrt:  [[0.15]]
grads:  [-0.06125409]
Stock Position:  -0.06125409364823775
Bond Position:  [11.88262927]


portfolio before change:  [5.70873289]
curr_Stock_Price:  100.81582199426803
curr_Factors:  [100.81582199]
mat_Sqrt:  [[0.15]]
grads:  [0.14021307]
Stock Position:  0.1402130748565651
Bond Position:  [-8.42696351]


portfolio before change:  [5.71745728]
curr_Stock_Price:  100.88555746744782
curr_Factors:  [100.88555747]
mat_Sqrt:  [[0.15]]
grads:  [0.03643661]
Stock Position:  0.036436614761511686
Bond Position:  [2.04152908]


portfolio before change:  [5.7089794]
curr_Stock_Price:  100.64587868542033
curr_Factors:  [100.64587869]
mat_Sqrt:  [[0.15]]
grads:  [0.01498307]
Stock Position:  0.014983065042188558
Bond Position:  [4.20099565]


portfolio before change:  [5.71419073]
curr_Stock_Price:  100.95864366892394
curr_Factors:  [100.95864367]
mat_Sqrt:  [[0.15]]
grads:  [0.05235612]
Stock Position:  0.05235611966489485
Bond Position:  [0.42838791]


portfolio before change:  [5.62755245]
curr_Stock_Price:  99.30283268092741
curr_Factors:  [99.30283268]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.62755245]
Stock Price:  99.50635583737434
PL:  [5.62755245]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.68297160e-03]
 [ 4.74089661e-03]
 [ 1.23970323e-02]
 [-2.77577148e-03]
 [ 1.53582963e-02]
 [ 2.62890044e-02]
 [ 7.65132139e-03]
 [ 7.14782461e-03]
 [-9.90078180e-03]
 [-2.81515779e-03]
 [ 1.81678357e-02]
 [ 9.04184289e-03]
 [-8.79029028e-04]
 [-4.34314602e-03]
 [-9.32195717e-03]
 [ 6.33575331e-03]
 [ 9.21007498e-03]
 [-3.71969013e-03]
 [ 1.18958048e-02]
 [-1.54775466e-02]
 [ 7.91522757e-04]
 [ 2.75713068e-02]
 [-3.98976151e-02]
 [ 7.09432583e-03]
 [-3.02368090e-03]
 [-6.29369449e-03]
 [-1.00407103e-03]
 [-1.08936897e-02]
 [ 5.05948386e-02]
 [-6.58451365e-03]
 [ 1.99453746e-04]
 [ 4.89666970e-03]
 [ 5.15325499e-03]
 [-5.18239312e-03]
 [ 1.62118121e-02]
 [ 5.39598023e-03]
 [-1.00732245e-02]
 [ 9.36784699e-03]
 [-1.27351844e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.13072436]
curr_Stock_Price:  101.17268437663026
curr_Factors:  [101.17268438]
mat_Sqrt:  [[0.15]]
grads:  [0.05121981]
Stock Position:  0.05121981063651079
Bond Position:  [14.94867862]


portfolio before change:  [20.08166219]
curr_Stock_Price:  100.17832557687485
curr_Factors:  [100.17832558]
mat_Sqrt:  [[0.15]]
grads:  [0.03160598]
Stock Position:  0.031605977380018344
Bond Position:  [16.9154283]


portfolio before change:  [20.10178871]
curr_Stock_Price:  100.74821646939452
curr_Factors:  [100.74821647]
mat_Sqrt:  [[0.15]]
grads:  [0.08264688]
Stock Position:  0.08264688225018473
Bond Position:  [11.77526272]


portfolio before change:  [20.06931657]
curr_Stock_Price:  100.33750358758415
curr_Factors:  [100.33750359]
mat_Sqrt:  [[0.15]]
grads:  [-0.01850514]
Stock Position:  -0.018505143230502532
Bond Position:  [21.92607644]


portfolio before change:  [20.06876198]
curr_Stock_Price:  100.51559010453042
curr_Factors:  [100.5155901]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [9.7771072]


portfolio before change:  [20.12994805]
curr_Stock_Price:  101.10123961119774
curr_Factors:  [101.10123961]
mat_Sqrt:  [[0.15]]
grads:  [0.17526003]
Stock Position:  0.1752600293245684
Bond Position:  [2.41094184]


portfolio before change:  [20.26134881]
curr_Stock_Price:  101.84926739768001
curr_Factors:  [101.8492674]
mat_Sqrt:  [[0.15]]
grads:  [0.05100881]
Stock Position:  0.05100880928512194
Bond Position:  [15.06613896]


portfolio before change:  [20.30448066]
curr_Stock_Price:  102.6579210769501
curr_Factors:  [102.65792108]
mat_Sqrt:  [[0.15]]
grads:  [0.04765216]
Stock Position:  0.04765216405918868
Bond Position:  [15.41260856]


portfolio before change:  [20.31556818]
curr_Stock_Price:  102.85016467962758
curr_Factors:  [102.85016468]
mat_Sqrt:  [[0.15]]
grads:  [-0.06600521]
Stock Position:  -0.06600521198885652
Bond Position:  [27.1042151]


portfolio before change:  [20.29049139]
curr_Stock_Price:  103.28141887400055
curr_Factors:  [103.28141887]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876772]
Stock Position:  -0.018767718574475782
Bond Position:  [22.228848]


portfolio before change:  [20.29584763]
curr_Stock_Price:  103.14408442278528
curr_Factors:  [103.14408442]
mat_Sqrt:  [[0.15]]
grads:  [0.1211189]
Stock Position:  0.12111890467810742
Bond Position:  [7.8031491]


portfolio before change:  [20.45131705]
curr_Stock_Price:  104.4196405888612
curr_Factors:  [104.41964059]
mat_Sqrt:  [[0.15]]
grads:  [0.06027895]
Stock Position:  0.060278952586231074
Bond Position:  [14.15701048]


portfolio before change:  [20.49215238]
curr_Stock_Price:  105.06772071195871
curr_Factors:  [105.06772071]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586019]
Stock Position:  -0.005860193517460109
Bond Position:  [21.10786955]


portfolio before change:  [20.49319327]
curr_Stock_Price:  105.34036661350461
curr_Factors:  [105.34036661]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895431]
Stock Position:  -0.028954306817207915
Bond Position:  [23.54325056]


portfolio before change:  [20.43983328]
curr_Stock_Price:  107.28491588394569
curr_Factors:  [107.28491588]
mat_Sqrt:  [[0.15]]
grads:  [-0.06214638]
Stock Position:  -0.06214638111848324
Bond Position:  [27.10720255]


portfolio before change:  [20.49000235]
curr_Stock_Price:  106.53216957367007
curr_Factors:  [106.53216957]
mat_Sqrt:  [[0.15]]
grads:  [0.04223836]
Stock Position:  0.042238355432800224
Bond Position:  [15.99025871]


portfolio before change:  [20.4498414]
curr_Stock_Price:  105.53402801783712
curr_Factors:  [105.53402802]
mat_Sqrt:  [[0.15]]
grads:  [0.0614005]
Stock Position:  0.06140049989917885
Bond Position:  [13.96999932]


portfolio before change:  [20.39204708]
curr_Stock_Price:  104.56431798181454
curr_Factors:  [104.56431798]
mat_Sqrt:  [[0.15]]
grads:  [-0.02479793]
Stock Position:  -0.02479793423196155
Bond Position:  [22.98502616]


portfolio before change:  [20.40982647]
curr_Stock_Price:  103.96321609488672
curr_Factors:  [103.96321609]
mat_Sqrt:  [[0.15]]
grads:  [0.07930537]
Stock Position:  0.07930536542821146
Bond Position:  [12.16498563]


portfolio before change:  [20.35896249]
curr_Stock_Price:  103.30267187104985
curr_Factors:  [103.30267187]
mat_Sqrt:  [[0.15]]
grads:  [-0.10318364]
Stock Position:  -0.10318364377386254
Bond Position:  [31.01810858]


portfolio before change:  [20.39077744]
curr_Stock_Price:  103.03191724866305
curr_Factors:  [103.03191725]
mat_Sqrt:  [[0.15]]
grads:  [0.00527682]
Stock Position:  0.005276818382899419
Bond Position:  [19.84709673]


portfolio before change:  [20.39290143]
curr_Stock_Price:  102.96425258625855
curr_Factors:  [102.96425259]
mat_Sqrt:  [[0.15]]
grads:  [0.18380871]
Stock Position:  0.18380871218594094
Bond Position:  [1.46717476]


portfolio before change:  [20.45514378]
curr_Stock_Price:  103.30188041187917
curr_Factors:  [103.30188041]
mat_Sqrt:  [[0.15]]
grads:  [-0.2659841]
Stock Position:  -0.26598410052052407
Bond Position:  [47.93180152]


portfolio before change:  [20.40608985]
curr_Stock_Price:  103.50883179173374
curr_Factors:  [103.50883179]
mat_Sqrt:  [[0.15]]
grads:  [0.04729551]
Stock Position:  0.04729550551373132
Bond Position:  [15.51058732]


portfolio before change:  [20.35712632]
curr_Stock_Price:  102.43256720640024
curr_Factors:  [102.43256721]
mat_Sqrt:  [[0.15]]
grads:  [-0.02015787]
Stock Position:  -0.02015787264904128
Bond Position:  [22.42194896]


portfolio before change:  [20.3586068]
curr_Stock_Price:  102.49817091666476
curr_Factors:  [102.49817092]
mat_Sqrt:  [[0.15]]
grads:  [-0.04195796]
Stock Position:  -0.04195796329757688
Bond Position:  [24.6592213]


portfolio before change:  [20.35264916]
curr_Stock_Price:  102.71363025844826
curr_Factors:  [102.71363026]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669381]
Stock Position:  -0.006693806885700863
Bond Position:  [21.04019437]


portfolio before change:  [20.35531142]
curr_Stock_Price:  102.70883943847372
curr_Factors:  [102.70883944]
mat_Sqrt:  [[0.15]]
grads:  [-0.0726246]
Stock Position:  -0.07262459786651866
Bond Position:  [27.81449958]


portfolio before change:  [20.30582527]
curr_Stock_Price:  103.43811272703503
curr_Factors:  [103.43811273]
mat_Sqrt:  [[0.15]]
grads:  [0.33729892]
Stock Position:  0.33729892411529333
Bond Position:  [-14.58373886]


portfolio before change:  [20.49896628]
curr_Stock_Price:  104.01612848531008
curr_Factors:  [104.01612849]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389676]
Stock Position:  -0.043896757652682396
Bond Position:  [25.06493707]


portfolio before change:  [20.57612296]
curr_Stock_Price:  102.32982248952973
curr_Factors:  [102.32982249]
mat_Sqrt:  [[0.15]]
grads:  [0.00132969]
Stock Position:  0.0013296916383399437
Bond Position:  [20.44005585]


portfolio before change:  [20.57991947]
curr_Stock_Price:  103.2633780229619
curr_Factors:  [103.26337802]
mat_Sqrt:  [[0.15]]
grads:  [0.03264446]
Stock Position:  0.03264446464980307
Bond Position:  [17.20894178]


portfolio before change:  [20.55909959]
curr_Stock_Price:  102.55970182592098
curr_Factors:  [102.55970183]
mat_Sqrt:  [[0.15]]
grads:  [0.03435503]
Stock Position:  0.0343550332906619
Bond Position:  [17.03565762]


portfolio before change:  [20.55645346]
curr_Stock_Price:  102.42069113331083
curr_Factors:  [102.42069113]
mat_Sqrt:  [[0.15]]
grads:  [-0.03454929]
Stock Position:  -0.03454928743628013
Bond Position:  [24.09501536]


portfolio before change:  [20.56467874]
curr_Stock_Price:  102.26979898269138
curr_Factors:  [102.26979898]
mat_Sqrt:  [[0.15]]
grads:  [0.10807875]
Stock Position:  0.1080787473292665
Bond Position:  [9.51148698]


portfolio before change:  [20.59093771]
curr_Stock_Price:  102.50175905419076
curr_Factors:  [102.50175905]
mat_Sqrt:  [[0.15]]
grads:  [0.0359732]
Stock Position:  0.03597320150027619
Bond Position:  [16.90362128]


portfolio before change:  [20.63474967]
curr_Stock_Price:  103.66092398265891
curr_Factors:  [103.66092398]
mat_Sqrt:  [[0.15]]
grads:  [-0.06715483]
Stock Position:  -0.06715483015946032
Bond Position:  [27.59608141]


portfolio before change:  [20.66944835]
curr_Stock_Price:  103.19559697201429
curr_Factors:  [103.19559697]
mat_Sqrt:  [[0.15]]
grads:  [0.06245231]
Stock Position:  0.06245231326348344
Bond Position:  [14.2246446]


portfolio before change:  [20.74042557]
curr_Stock_Price:  104.30362680637923
curr_Factors:  [104.30362681]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.74042557]
Stock Price:  104.15853832243734
PL:  [16.58188724]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.70471837e-03]
 [ 3.72101338e-03]
 [ 7.55778279e-03]
 [-2.90632491e-03]
 [ 1.47809225e-02]
 [ 2.60101084e-02]
 [-2.36928411e-03]
 [ 1.88662146e-02]
 [-5.96476980e-03]
 [ 4.24002343e-03]
 [ 5.15363098e-03]
 [ 5.30181330e-03]
 [ 1.38220264e-02]
 [ 3.78109723e-03]
 [ 8.33577620e-03]
 [-3.32041184e-03]
 [ 9.93876633e-03]
 [ 9.57172195e-03]
 [ 1.13661784e-02]
 [-1.26554517e-02]
 [-8.77465440e-03]
 [ 1.95217245e-02]
 [-7.12584816e-03]
 [ 5.18032968e-03]
 [ 3.49077735e-05]
 [-1.01522972e-02]
 [ 3.58162389e-03]
 [-1.12436771e-02]
 [-1.77741256e-02]
 [-5.98791224e-03]
 [-3.30155843e-03]
 [ 5.41790645e-03]
 [ 5.30724855e-03]
 [-1.14719541e-02]
 [ 2.18015583e-02]
 [ 5.46522880e-03]
 [ 1.47015929e-04]
 [ 8.14643092e-03]
 [-1.38498389e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.92131103]
curr_Stock_Price:  99.49208400900297
curr_Factors:  [99.49208401]
mat_Sqrt:  [[0.15]]
grads:  [0.03136479]
Stock Position:  0.031364789126955867
Bond Position:  [-9.04185927]


portfolio before change:  [-5.90964338]
curr_Stock_Price:  99.90011994230105
curr_Factors:  [99.90011994]
mat_Sqrt:  [[0.15]]
grads:  [0.02480676]
Stock Position:  0.024806755874480318
Bond Position:  [-8.38784126]


portfolio before change:  [-5.90561849]
curr_Stock_Price:  100.10463797402771
curr_Factors:  [100.10463797]
mat_Sqrt:  [[0.15]]
grads:  [0.05038522]
Stock Position:  0.050385218571304645
Bond Position:  [-10.94941256]


portfolio before change:  [-5.90903464]
curr_Stock_Price:  100.06400341590908
curr_Factors:  [100.06400342]
mat_Sqrt:  [[0.15]]
grads:  [-0.0193755]
Stock Position:  -0.019375499381346466
Bond Position:  [-3.9702446]


portfolio before change:  [-5.93038629]
curr_Stock_Price:  101.14038024752516
curr_Factors:  [101.14038025]
mat_Sqrt:  [[0.15]]
grads:  [0.09853948]
Stock Position:  0.0985394833489124
Bond Position:  [-15.8967071]


portfolio before change:  [-5.96776903]
curr_Stock_Price:  100.78117876329794
curr_Factors:  [100.78117876]
mat_Sqrt:  [[0.15]]
grads:  [0.17340072]
Stock Position:  0.17340072269578743
Bond Position:  [-23.44329826]


portfolio before change:  [-6.08669453]
curr_Stock_Price:  100.1122374408611
curr_Factors:  [100.11223744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579523]
Stock Position:  -0.01579522738021597
Bond Position:  [-4.50539898]


portfolio before change:  [-6.09397236]
curr_Stock_Price:  100.53734171322542
curr_Factors:  [100.53734171]
mat_Sqrt:  [[0.15]]
grads:  [0.12577476]
Stock Position:  0.12577476383896832
Bond Position:  [-18.73903277]


portfolio before change:  [-6.15314158]
curr_Stock_Price:  100.08552852003635
curr_Factors:  [100.08552852]
mat_Sqrt:  [[0.15]]
grads:  [-0.03976513]
Stock Position:  -0.03976513200324853
Bond Position:  [-2.17322733]


portfolio before change:  [-6.13271528]
curr_Stock_Price:  99.56502291817445
curr_Factors:  [99.56502292]
mat_Sqrt:  [[0.15]]
grads:  [0.02826682]
Stock Position:  0.02826682284106376
Bond Position:  [-8.94710214]


portfolio before change:  [-6.12976568]
curr_Stock_Price:  99.7089393252509
curr_Factors:  [99.70893933]
mat_Sqrt:  [[0.15]]
grads:  [0.03435754]
Stock Position:  0.03435753988471025
Bond Position:  [-9.55551954]


portfolio before change:  [-6.14012035]
curr_Stock_Price:  99.44232658039783
curr_Factors:  [99.44232658]
mat_Sqrt:  [[0.15]]
grads:  [0.03534542]
Stock Position:  0.03534542201934982
Bond Position:  [-9.65495135]


portfolio before change:  [-6.13676186]
curr_Stock_Price:  99.57149277316225
curr_Factors:  [99.57149277]
mat_Sqrt:  [[0.15]]
grads:  [0.09214684]
Stock Position:  0.0921468427358403
Bond Position:  [-15.31196055]


portfolio before change:  [-6.1954563]
curr_Stock_Price:  98.95529887152155
curr_Factors:  [98.95529887]
mat_Sqrt:  [[0.15]]
grads:  [0.02520731]
Stock Position:  0.025207314842091
Bond Position:  [-8.68985367]


portfolio before change:  [-6.1987435]
curr_Stock_Price:  98.8679867079613
curr_Factors:  [98.86798671]
mat_Sqrt:  [[0.15]]
grads:  [0.05557184]
Stock Position:  0.05557184130136998
Bond Position:  [-11.69301957]


portfolio before change:  [-6.20723544]
curr_Stock_Price:  98.74147991970992
curr_Factors:  [98.74147992]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213608]
Stock Position:  -0.022136078921917258
Bond Position:  [-4.02148624]


portfolio before change:  [-6.23152338]
curr_Stock_Price:  99.8159803010459
curr_Factors:  [99.8159803]
mat_Sqrt:  [[0.15]]
grads:  [0.06625844]
Stock Position:  0.06625844217252366
Bond Position:  [-12.84517474]


portfolio before change:  [-6.20902594]
curr_Stock_Price:  100.17975563954728
curr_Factors:  [100.17975564]
mat_Sqrt:  [[0.15]]
grads:  [0.06381148]
Stock Position:  0.06381147969080896
Bond Position:  [-12.60164438]


portfolio before change:  [-6.24088011]
curr_Stock_Price:  99.70525056776975
curr_Factors:  [99.70525057]
mat_Sqrt:  [[0.15]]
grads:  [0.07577452]
Stock Position:  0.07577452243150715
Bond Position:  [-13.79599786]


portfolio before change:  [-6.16736403]
curr_Stock_Price:  100.69820560315785
curr_Factors:  [100.6982056]
mat_Sqrt:  [[0.15]]
grads:  [-0.08436968]
Stock Position:  -0.08436967779776003
Bond Position:  [2.32851113]


portfolio before change:  [-6.11748698]
curr_Stock_Price:  100.11048295289294
curr_Factors:  [100.11048295]
mat_Sqrt:  [[0.15]]
grads:  [-0.0584977]
Stock Position:  -0.05849769599025096
Bond Position:  [-0.26125438]


portfolio before change:  [-6.16717753]
curr_Stock_Price:  100.95936926543233
curr_Factors:  [100.95936927]
mat_Sqrt:  [[0.15]]
grads:  [0.13014483]
Stock Position:  0.13014482985049464
Bond Position:  [-19.30651746]


portfolio before change:  [-6.21387315]
curr_Stock_Price:  100.61911632530835
curr_Factors:  [100.61911633]
mat_Sqrt:  [[0.15]]
grads:  [-0.04750565]
Stock Position:  -0.04750565441989292
Bond Position:  [-1.43389619]


portfolio before change:  [-6.15676433]
curr_Stock_Price:  99.41319515769617
curr_Factors:  [99.41319516]
mat_Sqrt:  [[0.15]]
grads:  [0.03453553]
Stock Position:  0.034535531218871186
Bond Position:  [-9.59005183]


portfolio before change:  [-6.14316534]
curr_Stock_Price:  99.84167612952241
curr_Factors:  [99.84167613]
mat_Sqrt:  [[0.15]]
grads:  [0.00023272]
Stock Position:  0.00023271848993763658
Bond Position:  [-6.16640035]


portfolio before change:  [-6.1439793]
curr_Stock_Price:  99.65644416870575
curr_Factors:  [99.65644417]
mat_Sqrt:  [[0.15]]
grads:  [-0.06768198]
Stock Position:  -0.06768198100045908
Bond Position:  [0.60096626]


portfolio before change:  [-6.19078269]
curr_Stock_Price:  100.34907335930927
curr_Factors:  [100.34907336]
mat_Sqrt:  [[0.15]]
grads:  [0.02387749]
Stock Position:  0.023877492575770598
Bond Position:  [-8.58686694]


portfolio before change:  [-6.19464808]
curr_Stock_Price:  100.23214433077541
curr_Factors:  [100.23214433]
mat_Sqrt:  [[0.15]]
grads:  [-0.07495785]
Stock Position:  -0.07495784702331318
Bond Position:  [1.31853766]


portfolio before change:  [-6.16545068]
curr_Stock_Price:  99.84482564137156
curr_Factors:  [99.84482564]
mat_Sqrt:  [[0.15]]
grads:  [-0.11849417]
Stock Position:  -0.11849417049168226
Bond Position:  [5.66557911]


portfolio before change:  [-6.18343998]
curr_Stock_Price:  100.00261850945789
curr_Factors:  [100.00261851]
mat_Sqrt:  [[0.15]]
grads:  [-0.03991941]
Stock Position:  -0.039919414907383356
Bond Position:  [-2.19139396]


portfolio before change:  [-6.16802058]
curr_Stock_Price:  99.60949319289503
curr_Factors:  [99.60949319]
mat_Sqrt:  [[0.15]]
grads:  [-0.02201039]
Stock Position:  -0.022010389540210677
Bond Position:  [-3.97557684]


portfolio before change:  [-6.17553943]
curr_Stock_Price:  99.92851825935267
curr_Factors:  [99.92851826]
mat_Sqrt:  [[0.15]]
grads:  [0.03611938]
Stock Position:  0.03611937635408582
Bond Position:  [-9.78489519]


portfolio before change:  [-6.16955541]
curr_Stock_Price:  100.12805673067791
curr_Factors:  [100.12805673]
mat_Sqrt:  [[0.15]]
grads:  [0.03538166]
Stock Position:  0.035381657028931625
Bond Position:  [-9.71225197]


portfolio before change:  [-6.17262877]
curr_Stock_Price:  100.0755082902809
curr_Factors:  [100.07550829]
mat_Sqrt:  [[0.15]]
grads:  [-0.07647969]
Stock Position:  -0.07647969420071861
Bond Position:  [1.4811155]


portfolio before change:  [-6.26132185]
curr_Stock_Price:  101.23762368833752
curr_Factors:  [101.23762369]
mat_Sqrt:  [[0.15]]
grads:  [0.14534372]
Stock Position:  0.14534372228694595
Bond Position:  [-20.97557491]


portfolio before change:  [-6.32629293]
curr_Stock_Price:  100.80864767132535
curr_Factors:  [100.80864767]
mat_Sqrt:  [[0.15]]
grads:  [0.03643486]
Stock Position:  0.03643485868265229
Bond Position:  [-9.99924176]


portfolio before change:  [-6.29725332]
curr_Stock_Price:  101.63998319101287
curr_Factors:  [101.63998319]
mat_Sqrt:  [[0.15]]
grads:  [0.00098011]
Stock Position:  0.0009801061926683191
Bond Position:  [-6.3968713]


portfolio before change:  [-6.29801966]
curr_Stock_Price:  101.67397587714065
curr_Factors:  [101.67397588]
mat_Sqrt:  [[0.15]]
grads:  [0.05430954]
Stock Position:  0.054309539497548964
Bond Position:  [-11.81988647]


portfolio before change:  [-6.29995312]
curr_Stock_Price:  101.66558186952079
curr_Factors:  [101.66558187]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.29995312]
Stock Price:  101.34525900068093
PL:  [-7.64521212]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.00331174e-03]
 [ 4.42628129e-03]
 [-4.88830949e-05]
 [-2.82801634e-03]
 [ 1.53582963e-02]
 [ 2.24682211e-02]
 [-5.95231974e-03]
 [ 1.19203315e-02]
 [-6.43562904e-03]
 [-3.01367661e-03]
 [ 1.68586726e-02]
 [ 6.54084380e-03]
 [ 7.00614139e-03]
 [ 1.57106992e-04]
 [ 2.23145757e-02]
 [ 2.14860874e-03]
 [ 8.83101046e-03]
 [ 1.20755563e-02]
 [ 1.14686875e-02]
 [-1.35942473e-02]
 [-1.73746315e-02]
 [ 1.74092595e-02]
 [-2.89291122e-02]
 [ 7.20068114e-03]
 [ 4.11587375e-03]
 [-8.37100369e-03]
 [-1.04942269e-03]
 [-1.07284912e-02]
 [ 5.58942152e-02]
 [-3.00041210e-03]
 [-9.37988302e-03]
 [ 4.32658337e-03]
 [ 6.49546551e-03]
 [ 2.09162293e-03]
 [ 8.17717103e-03]
 [ 3.46087475e-03]
 [-4.70591753e-02]
 [ 9.52038343e-03]
 [-7.03601575e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.83129058]
curr_Stock_Price:  98.85279748015525
curr_Factors:  [98.85279748]
mat_Sqrt:  [[0.15]]
grads:  [0.06002208]
Stock Position:  0.06002207828464973
Bond Position:  [-21.76464093]


portfolio before change:  [-15.76199458]
curr_Stock_Price:  100.05263523793268
curr_Factors:  [100.05263524]
mat_Sqrt:  [[0.15]]
grads:  [0.02950854]
Stock Position:  0.029508541932474326
Bond Position:  [-18.71440196]


portfolio before change:  [-15.78493528]
curr_Stock_Price:  99.3544896419723
curr_Factors:  [99.35448964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032589]
Stock Position:  -0.0003258872995719848
Bond Position:  [-15.75255692]


portfolio before change:  [-15.78719986]
curr_Stock_Price:  100.26089532732635
curr_Factors:  [100.26089533]
mat_Sqrt:  [[0.15]]
grads:  [-0.01885344]
Stock Position:  -0.018853442249594725
Bond Position:  [-13.89693686]


portfolio before change:  [-15.79299541]
curr_Stock_Price:  100.47615169241048
curr_Factors:  [100.47615169]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-26.08061214]


portfolio before change:  [-15.80284507]
curr_Stock_Price:  100.41179510676751
curr_Factors:  [100.41179511]
mat_Sqrt:  [[0.15]]
grads:  [0.14978814]
Stock Position:  0.14978814057339154
Bond Position:  [-30.84334115]


portfolio before change:  [-15.70206844]
curr_Stock_Price:  101.11033032684502
curr_Factors:  [101.11033033]
mat_Sqrt:  [[0.15]]
grads:  [-0.03968213]
Stock Position:  -0.039682131603430176
Bond Position:  [-11.68979501]


portfolio before change:  [-15.72059276]
curr_Stock_Price:  101.54032231650972
curr_Factors:  [101.54032232]
mat_Sqrt:  [[0.15]]
grads:  [0.07946888]
Stock Position:  0.07946887667819635
Bond Position:  [-23.78988811]


portfolio before change:  [-15.7838775]
curr_Stock_Price:  100.78139848319823
curr_Factors:  [100.78139848]
mat_Sqrt:  [[0.15]]
grads:  [-0.04290419]
Stock Position:  -0.042904193613090384
Bond Position:  [-11.45993287]


portfolio before change:  [-15.8408226]
curr_Stock_Price:  102.07527009603854
curr_Factors:  [102.0752701]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009118]
Stock Position:  -0.020091177367684003
Bond Position:  [-13.79001024]


portfolio before change:  [-15.85924484]
curr_Stock_Price:  102.90640023015003
curr_Factors:  [102.90640023]
mat_Sqrt:  [[0.15]]
grads:  [0.11239115]
Stock Position:  0.11239115078399364
Bond Position:  [-27.42501359]


portfolio before change:  [-15.90296874]
curr_Stock_Price:  102.54787061388322
curr_Factors:  [102.54787061]
mat_Sqrt:  [[0.15]]
grads:  [0.04360563]
Stock Position:  0.0436056253257717
Bond Position:  [-20.37463276]


portfolio before change:  [-15.90799129]
curr_Stock_Price:  102.49109890598407
curr_Factors:  [102.49109891]
mat_Sqrt:  [[0.15]]
grads:  [0.04670761]
Stock Position:  0.046707609256052336
Bond Position:  [-20.69510549]


portfolio before change:  [-15.99010891]
curr_Stock_Price:  100.78836634857599
curr_Factors:  [100.78836635]
mat_Sqrt:  [[0.15]]
grads:  [0.00104738]
Stock Position:  0.0010473799446108784
Bond Position:  [-16.09567262]


portfolio before change:  [-15.99135836]
curr_Stock_Price:  101.51650397592587
curr_Factors:  [101.51650398]
mat_Sqrt:  [[0.15]]
grads:  [0.14876384]
Stock Position:  0.14876383785677344
Bond Position:  [-31.0933431]


portfolio before change:  [-15.91311213]
curr_Stock_Price:  102.06860818041078
curr_Factors:  [102.06860818]
mat_Sqrt:  [[0.15]]
grads:  [0.01432406]
Stock Position:  0.014324058238936557
Bond Position:  [-17.37514882]


portfolio before change:  [-15.91912508]
curr_Stock_Price:  101.80046336790068
curr_Factors:  [101.80046337]
mat_Sqrt:  [[0.15]]
grads:  [0.0588734]
Stock Position:  0.058873403033590614
Bond Position:  [-21.91246479]


portfolio before change:  [-15.91032937]
curr_Stock_Price:  101.99639130377099
curr_Factors:  [101.9963913]
mat_Sqrt:  [[0.15]]
grads:  [0.08050371]
Stock Position:  0.080503708479983
Bond Position:  [-24.12141712]


portfolio before change:  [-15.89266674]
curr_Stock_Price:  102.25324887805095
curr_Factors:  [102.25324888]
mat_Sqrt:  [[0.15]]
grads:  [0.07645792]
Stock Position:  0.07645791675069422
Bond Position:  [-23.71073713]


portfolio before change:  [-15.95120442]
curr_Stock_Price:  101.5263961058083
curr_Factors:  [101.52639611]
mat_Sqrt:  [[0.15]]
grads:  [-0.09062832]
Stock Position:  -0.09062831551829865
Bond Position:  [-6.75003816]


portfolio before change:  [-15.88188296]
curr_Stock_Price:  100.75218704681319
curr_Factors:  [100.75218705]
mat_Sqrt:  [[0.15]]
grads:  [-0.11583088]
Stock Position:  -0.11583087662622239
Bond Position:  [-4.21166882]


portfolio before change:  [-15.85878723]
curr_Stock_Price:  100.54824981978717
curr_Factors:  [100.54824982]
mat_Sqrt:  [[0.15]]
grads:  [0.11606173]
Stock Position:  0.11606172991559884
Bond Position:  [-27.52859104]


portfolio before change:  [-15.70617567]
curr_Stock_Price:  101.8928175092854
curr_Factors:  [101.89281751]
mat_Sqrt:  [[0.15]]
grads:  [-0.19286075]
Stock Position:  -0.1928607480074902
Bond Position:  [3.94494934]


portfolio before change:  [-16.03035125]
curr_Stock_Price:  103.57625355772873
curr_Factors:  [103.57625356]
mat_Sqrt:  [[0.15]]
grads:  [0.04800454]
Stock Position:  0.048004540953371116
Bond Position:  [-21.00248176]


portfolio before change:  [-16.0418407]
curr_Stock_Price:  103.39160481432623
curr_Factors:  [103.39160481]
mat_Sqrt:  [[0.15]]
grads:  [0.02743916]
Stock Position:  0.02743915836519714
Bond Position:  [-18.87881932]


portfolio before change:  [-16.05531411]
curr_Stock_Price:  102.98658495498634
curr_Factors:  [102.98658495]
mat_Sqrt:  [[0.15]]
grads:  [-0.05580669]
Stock Position:  -0.055806691279502094
Bond Position:  [-10.30797356]


portfolio before change:  [-16.02025422]
curr_Stock_Price:  102.33525693881268
curr_Factors:  [102.33525694]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699615]
Stock Position:  -0.006996151245271301
Bond Position:  [-15.30430129]


portfolio before change:  [-16.03030728]
curr_Stock_Price:  103.49873942720805
curr_Factors:  [103.49873943]
mat_Sqrt:  [[0.15]]
grads:  [-0.07152327]
Stock Position:  -0.0715232747115214
Bond Position:  [-8.62773851]


portfolio before change:  [-16.09869379]
curr_Stock_Price:  104.43980330621662
curr_Factors:  [104.43980331]
mat_Sqrt:  [[0.15]]
grads:  [0.3726281]
Stock Position:  0.3726281013873109
Bond Position:  [-55.0158994]


portfolio before change:  [-15.5993104]
curr_Stock_Price:  105.79842548201538
curr_Factors:  [105.79842548]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000275]
Stock Position:  -0.020002747321290832
Bond Position:  [-13.48305123]


portfolio before change:  [-15.60046418]
curr_Stock_Price:  105.77184395904935
curr_Factors:  [105.77184396]
mat_Sqrt:  [[0.15]]
grads:  [-0.06253255]
Stock Position:  -0.06253255346366973
Bond Position:  [-8.9862807]


portfolio before change:  [-15.62269958]
curr_Stock_Price:  106.10946076525329
curr_Factors:  [106.10946077]
mat_Sqrt:  [[0.15]]
grads:  [0.02884389]
Stock Position:  0.028843889119167666
Bond Position:  [-18.6833091]


portfolio before change:  [-15.60180124]
curr_Stock_Price:  106.91496573805972
curr_Factors:  [106.91496574]
mat_Sqrt:  [[0.15]]
grads:  [0.0433031]
Stock Position:  0.043303103403600815
Bond Position:  [-20.23155106]


portfolio before change:  [-15.59643838]
curr_Stock_Price:  107.09721517597384
curr_Factors:  [107.09721518]
mat_Sqrt:  [[0.15]]
grads:  [0.01394415]
Stock Position:  0.01394415285631562
Bond Position:  [-17.08981832]


portfolio before change:  [-15.59496454]
curr_Stock_Price:  107.35611956151976
curr_Factors:  [107.35611956]
mat_Sqrt:  [[0.15]]
grads:  [0.05451447]
Stock Position:  0.054514473501156666
Bond Position:  [-21.44742687]


portfolio before change:  [-15.60396701]
curr_Stock_Price:  107.24016187979879
curr_Factors:  [107.24016188]
mat_Sqrt:  [[0.15]]
grads:  [0.0230725]
Stock Position:  0.023072498319653027
Bond Position:  [-18.07826546]


portfolio before change:  [-15.61282378]
curr_Stock_Price:  106.95424342745058
curr_Factors:  [106.95424343]
mat_Sqrt:  [[0.15]]
grads:  [-0.31372784]
Stock Position:  -0.3137278352083285
Bond Position:  [17.94169947]


portfolio before change:  [-15.69308986]
curr_Stock_Price:  107.21723868010109
curr_Factors:  [107.21723868]
mat_Sqrt:  [[0.15]]
grads:  [0.06346922]
Stock Position:  0.06346922287246642
Bond Position:  [-22.49808468]


portfolio before change:  [-15.7371722]
curr_Stock_Price:  106.56700385225537
curr_Factors:  [106.56700385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.7371722]
Stock Price:  107.39723185414553
PL:  [-23.13440405]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.40756077e-03]
 [-1.83116760e-03]
 [ 1.40763495e-02]
 [ 1.87963137e-02]
 [-3.11953187e-02]
 [ 3.36013397e-02]
 [ 6.51507420e-02]
 [-8.74972195e-03]
 [-1.31206362e-02]
 [-1.21231981e-03]
 [ 3.17831950e-02]
 [ 1.14329945e-02]
 [-1.11017937e-02]
 [-5.05317877e-03]
 [-1.01091778e-02]
 [ 8.50229030e-03]
 [ 9.32745126e-03]
 [-2.89910459e-02]
 [ 1.27397452e-02]
 [-1.86066067e-02]
 [ 2.22302038e-02]
 [ 5.20074036e-02]
 [ 4.69361326e-02]
 [ 6.51340239e-03]
 [ 7.80244128e-03]
 [-3.29754547e-02]
 [ 4.36270180e-03]
 [-2.02167527e-02]
 [ 7.89097474e-02]
 [-5.12825016e-04]
 [-1.88862262e-02]
 [ 3.81198460e-03]
 [ 7.33826190e-03]
 [ 5.06462845e-03]
 [ 8.19973230e-03]
 [ 3.42609048e-03]
 [-6.76173479e-02]
 [ 9.04077457e-03]
 [-3.36590966e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.98602451]
curr_Stock_Price:  100.45374682062176
curr_Factors:  [100.45374682]
mat_Sqrt:  [[0.15]]
grads:  [0.04271707]
Stock Position:  0.04271707179354093
Bond Position:  [4.6949346]


portfolio before change:  [9.03091656]
curr_Stock_Price:  101.4909234149877
curr_Factors:  [101.49092341]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220778]
Stock Position:  -0.01220778397403528
Bond Position:  [10.26989583]


portfolio before change:  [9.03746328]
curr_Stock_Price:  101.05981349875032
curr_Factors:  [101.0598135]
mat_Sqrt:  [[0.15]]
grads:  [0.09384233]
Stock Position:  0.09384232992966231
Bond Position:  [-0.44622508]


portfolio before change:  [9.22291116]
curr_Stock_Price:  103.03657243712284
curr_Factors:  [103.03657244]
mat_Sqrt:  [[0.15]]
grads:  [0.12530876]
Stock Position:  0.1253087580501352
Bond Position:  [-3.68847377]


portfolio before change:  [9.34543815]
curr_Stock_Price:  104.0180527439403
curr_Factors:  [104.01805274]
mat_Sqrt:  [[0.15]]
grads:  [-0.20796879]
Stock Position:  -0.2079687914033515
Bond Position:  [30.97794686]


portfolio before change:  [9.39331566]
curr_Stock_Price:  103.8064583602194
curr_Factors:  [103.80645836]
mat_Sqrt:  [[0.15]]
grads:  [0.22400893]
Stock Position:  0.22400893114126302
Bond Position:  [-13.86025812]


portfolio before change:  [9.67450736]
curr_Stock_Price:  105.06946305186477
curr_Factors:  [105.06946305]
mat_Sqrt:  [[0.15]]
grads:  [0.43433828]
Stock Position:  0.43433828027494126
Bond Position:  [-35.96118254]


portfolio before change:  [9.72588486]
curr_Stock_Price:  105.19810225194865
curr_Factors:  [105.19810225]
mat_Sqrt:  [[0.15]]
grads:  [-0.05833148]
Stock Position:  -0.058331479660062316
Bond Position:  [15.86224582]


portfolio before change:  [9.74809271]
curr_Stock_Price:  104.85137784993059
curr_Factors:  [104.85137785]
mat_Sqrt:  [[0.15]]
grads:  [-0.08747091]
Stock Position:  -0.08747090820589552
Bond Position:  [18.91953795]


portfolio before change:  [9.76368925]
curr_Stock_Price:  104.70011095234074
curr_Factors:  [104.70011095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00808213]
Stock Position:  -0.008082132094749108
Bond Position:  [10.60988938]


portfolio before change:  [9.75647843]
curr_Stock_Price:  105.75640942321284
curr_Factors:  [105.75640942]
mat_Sqrt:  [[0.15]]
grads:  [0.21188797]
Stock Position:  0.21188796672975002
Bond Position:  [-12.65203214]


portfolio before change:  [10.01191436]
curr_Stock_Price:  106.96939732322107
curr_Factors:  [106.96939732]
mat_Sqrt:  [[0.15]]
grads:  [0.07621996]
Stock Position:  0.07621996348668846
Bond Position:  [1.8587108]


portfolio before change:  [10.12181172]
curr_Stock_Price:  108.40819366408783
curr_Factors:  [108.40819366]
mat_Sqrt:  [[0.15]]
grads:  [-0.07401196]
Stock Position:  -0.07401195832461717
Bond Position:  [18.14531443]


portfolio before change:  [10.14897167]
curr_Stock_Price:  108.07187440596172
curr_Factors:  [108.07187441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03368786]
Stock Position:  -0.033687858455781296
Bond Position:  [13.78968168]


portfolio before change:  [10.17026176]
curr_Stock_Price:  107.49106367454507
curr_Factors:  [107.49106367]
mat_Sqrt:  [[0.15]]
grads:  [-0.06739452]
Stock Position:  -0.0673945187924279
Bond Position:  [17.41457027]


portfolio before change:  [10.11250896]
curr_Stock_Price:  108.380301502997
curr_Factors:  [108.3803015]
mat_Sqrt:  [[0.15]]
grads:  [0.05668194]
Stock Position:  0.056681935300131235
Bond Position:  [3.96930373]


portfolio before change:  [10.08548896]
curr_Stock_Price:  107.8948524266229
curr_Factors:  [107.89485243]
mat_Sqrt:  [[0.15]]
grads:  [0.06218301]
Stock Position:  0.06218300840670354
Bond Position:  [3.37626245]


portfolio before change:  [10.03582008]
curr_Stock_Price:  107.0893117801245
curr_Factors:  [107.08931178]
mat_Sqrt:  [[0.15]]
grads:  [-0.19327364]
Stock Position:  -0.19327363959287194
Bond Position:  [30.73336113]


portfolio before change:  [9.99083612]
curr_Stock_Price:  107.3419374205659
curr_Factors:  [107.34193742]
mat_Sqrt:  [[0.15]]
grads:  [0.08493163]
Stock Position:  0.0849316344442382
Bond Position:  [0.87410993]


portfolio before change:  [10.11713812]
curr_Stock_Price:  108.82775287996816
curr_Factors:  [108.82775288]
mat_Sqrt:  [[0.15]]
grads:  [-0.12404404]
Stock Position:  -0.12404404450953498
Bond Position:  [23.61657274]


portfolio before change:  [10.16770656]
curr_Stock_Price:  108.44388778439456
curr_Factors:  [108.44388778]
mat_Sqrt:  [[0.15]]
grads:  [0.14820136]
Stock Position:  0.14820135883869273
Bond Position:  [-5.90382497]


portfolio before change:  [10.14871429]
curr_Stock_Price:  108.32071585670516
curr_Factors:  [108.32071586]
mat_Sqrt:  [[0.15]]
grads:  [0.34671602]
Stock Position:  0.34671602375060095
Bond Position:  [-27.40781361]


portfolio before change:  [10.12528027]
curr_Stock_Price:  108.26300919520716
curr_Factors:  [108.2630092]
mat_Sqrt:  [[0.15]]
grads:  [0.31290755]
Stock Position:  0.3129075505238809
Bond Position:  [-23.75103275]


portfolio before change:  [10.10762507]
curr_Stock_Price:  108.21607478403801
curr_Factors:  [108.21607478]
mat_Sqrt:  [[0.15]]
grads:  [0.04342268]
Stock Position:  0.04342268256950838
Bond Position:  [5.40859281]


portfolio before change:  [10.13209503]
curr_Stock_Price:  108.76403347469852
curr_Factors:  [108.76403347]
mat_Sqrt:  [[0.15]]
grads:  [0.05201628]
Stock Position:  0.052016275216773745
Bond Position:  [4.47459513]


portfolio before change:  [10.18165511]
curr_Stock_Price:  109.70606023113521
curr_Factors:  [109.70606023]
mat_Sqrt:  [[0.15]]
grads:  [-0.21983636]
Stock Position:  -0.21983636464573642
Bond Position:  [34.29903657]


portfolio before change:  [9.87754166]
curr_Stock_Price:  111.10892682236506
curr_Factors:  [111.10892682]
mat_Sqrt:  [[0.15]]
grads:  [0.02908468]
Stock Position:  0.029084678643278527
Bond Position:  [6.64597423]


portfolio before change:  [9.86967402]
curr_Stock_Price:  110.80985376673219
curr_Factors:  [110.80985377]
mat_Sqrt:  [[0.15]]
grads:  [-0.13477835]
Stock Position:  -0.13477835106182234
Bond Position:  [24.80444339]


portfolio before change:  [10.08470951]
curr_Stock_Price:  109.23738503936234
curr_Factors:  [109.23738504]
mat_Sqrt:  [[0.15]]
grads:  [0.52606498]
Stock Position:  0.5260649829549501
Bond Position:  [-47.38125359]


portfolio before change:  [10.71422184]
curr_Stock_Price:  110.44528782808263
curr_Factors:  [110.44528783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00341883]
Stock Position:  -0.0034188334426108117
Bond Position:  [11.09181589]


portfolio before change:  [10.71802228]
curr_Stock_Price:  109.73923598865998
curr_Factors:  [109.73923599]
mat_Sqrt:  [[0.15]]
grads:  [-0.12590817]
Stock Position:  -0.12590817461769035
Bond Position:  [24.53508917]


portfolio before change:  [10.85464104]
curr_Stock_Price:  108.6785289929008
curr_Factors:  [108.67852899]
mat_Sqrt:  [[0.15]]
grads:  [0.02541323]
Stock Position:  0.025413230657471288
Bond Position:  [8.09276852]


portfolio before change:  [10.85227759]
curr_Stock_Price:  108.54571967301717
curr_Factors:  [108.54571967]
mat_Sqrt:  [[0.15]]
grads:  [0.04892175]
Stock Position:  0.04892174597427773
Bond Position:  [5.54203146]


portfolio before change:  [10.84906119]
curr_Stock_Price:  108.46581253853415
curr_Factors:  [108.46581254]
mat_Sqrt:  [[0.15]]
grads:  [0.03376419]
Stock Position:  0.03376418965631758
Bond Position:  [7.18680092]


portfolio before change:  [10.8542021]
curr_Stock_Price:  108.59146369796075
curr_Factors:  [108.5914637]
mat_Sqrt:  [[0.15]]
grads:  [0.05466488]
Stock Position:  0.054664881990397825
Bond Position:  [4.91806255]


portfolio before change:  [10.78467138]
curr_Stock_Price:  107.30827209218312
curr_Factors:  [107.30827209]
mat_Sqrt:  [[0.15]]
grads:  [0.0228406]
Stock Position:  0.022840603232303944
Bond Position:  [8.33368572]


portfolio before change:  [10.81727277]
curr_Stock_Price:  108.69000510733093
curr_Factors:  [108.69000511]
mat_Sqrt:  [[0.15]]
grads:  [-0.45078232]
Stock Position:  -0.45078231909792565
Bond Position:  [59.81280534]


portfolio before change:  [10.47005459]
curr_Stock_Price:  109.47684886951896
curr_Factors:  [109.47684887]
mat_Sqrt:  [[0.15]]
grads:  [0.06027183]
Stock Position:  0.060271830449204006
Bond Position:  [3.87168451]


portfolio before change:  [10.39219524]
curr_Stock_Price:  108.17701553792655
curr_Factors:  [108.17701554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.39219524]
Stock Price:  107.04599956992263
PL:  [3.34619567]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.60101827e-03]
 [ 2.82065986e-03]
 [ 6.79384932e-03]
 [-2.90324885e-03]
 [ 1.47850058e-02]
 [ 2.36849202e-02]
 [ 1.46639163e-03]
 [ 2.18145711e-02]
 [-6.08397894e-03]
 [ 5.96535588e-04]
 [ 4.64400933e-03]
 [ 5.09131400e-03]
 [ 1.12160218e-02]
 [ 2.27139618e-03]
 [ 2.45129124e-02]
 [ 2.03776079e-03]
 [ 8.77855087e-03]
 [ 1.12471308e-02]
 [ 1.16810583e-02]
 [-1.43274147e-02]
 [-7.30606936e-03]
 [ 2.61973200e-02]
 [-3.12866768e-02]
 [ 7.97107998e-03]
 [ 3.58352970e-03]
 [-1.08822561e-02]
 [-8.55287266e-04]
 [-1.07208677e-02]
 [ 4.99036448e-02]
 [-8.86500271e-03]
 [-3.21887569e-03]
 [ 5.09478302e-03]
 [ 5.16946107e-03]
 [-1.02487898e-02]
 [ 2.09284563e-02]
 [ 5.64533142e-03]
 [ 3.34809018e-03]
 [ 1.15266208e-02]
 [-2.30888308e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.16997932]
curr_Stock_Price:  100.07855741449849
curr_Factors:  [100.07855741]
mat_Sqrt:  [[0.15]]
grads:  [0.03067346]
Stock Position:  0.030673455133202222
Bond Position:  [0.10022418]


portfolio before change:  [3.16142733]
curr_Stock_Price:  99.79934147378735
curr_Factors:  [99.79934147]
mat_Sqrt:  [[0.15]]
grads:  [0.0188044]
Stock Position:  0.01880439905462853
Bond Position:  [1.28476069]


portfolio before change:  [3.16435272]
curr_Stock_Price:  99.94636971416655
curr_Factors:  [99.94636971]
mat_Sqrt:  [[0.15]]
grads:  [0.04529233]
Stock Position:  0.0452923287900778
Bond Position:  [-1.36245112]


portfolio before change:  [3.17343154]
curr_Stock_Price:  100.15057954156336
curr_Factors:  [100.15057954]
mat_Sqrt:  [[0.15]]
grads:  [-0.01935499]
Stock Position:  -0.019354992341481584
Bond Position:  [5.11184524]


portfolio before change:  [3.15498475]
curr_Stock_Price:  101.1366716796358
curr_Factors:  [101.13667168]
mat_Sqrt:  [[0.15]]
grads:  [0.09856671]
Stock Position:  0.09856670562435244
Bond Position:  [-6.81372379]


portfolio before change:  [3.08956317]
curr_Stock_Price:  100.48158422764313
curr_Factors:  [100.48158423]
mat_Sqrt:  [[0.15]]
grads:  [0.15789947]
Stock Position:  0.15789946770557434
Bond Position:  [-12.77642549]


portfolio before change:  [3.08956581]
curr_Stock_Price:  100.49171595495083
curr_Factors:  [100.49171595]
mat_Sqrt:  [[0.15]]
grads:  [0.00977594]
Stock Position:  0.009775944195556715
Bond Position:  [2.10716441]


portfolio before change:  [3.07251501]
curr_Stock_Price:  98.72061199975421
curr_Factors:  [98.720612]
mat_Sqrt:  [[0.15]]
grads:  [0.14543047]
Stock Position:  0.14543047385420532
Bond Position:  [-11.28447037]


portfolio before change:  [2.9509808]
curr_Stock_Price:  97.89462582541398
curr_Factors:  [97.89462583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055986]
Stock Position:  -0.040559859615897295
Bond Position:  [6.92157309]


portfolio before change:  [2.93869785]
curr_Stock_Price:  98.2187936921233
curr_Factors:  [98.21879369]
mat_Sqrt:  [[0.15]]
grads:  [0.0039769]
Stock Position:  0.003976903917759864
Bond Position:  [2.54809115]


portfolio before change:  [2.94413559]
curr_Stock_Price:  99.50602706123762
curr_Factors:  [99.50602706]
mat_Sqrt:  [[0.15]]
grads:  [0.03096006]
Stock Position:  0.03096006222914071
Bond Position:  [-0.1365772]


portfolio before change:  [2.94489501]
curr_Stock_Price:  99.53110775838137
curr_Factors:  [99.53110776]
mat_Sqrt:  [[0.15]]
grads:  [0.03394209]
Stock Position:  0.03394209331045158
Bond Position:  [-0.43339913]


portfolio before change:  [2.95976754]
curr_Stock_Price:  99.97087737482747
curr_Factors:  [99.97087737]
mat_Sqrt:  [[0.15]]
grads:  [0.07477348]
Stock Position:  0.07477347899357063
Bond Position:  [-4.51540276]


portfolio before change:  [2.99941891]
curr_Stock_Price:  100.50871295959855
curr_Factors:  [100.50871296]
mat_Sqrt:  [[0.15]]
grads:  [0.01514264]
Stock Position:  0.015142641211294348
Bond Position:  [1.47745153]


portfolio before change:  [3.00822881]
curr_Stock_Price:  101.07831010011957
curr_Factors:  [101.0783101]
mat_Sqrt:  [[0.15]]
grads:  [0.16341942]
Stock Position:  0.16341941577508684
Bond Position:  [-13.50992957]


portfolio before change:  [3.14957519]
curr_Stock_Price:  101.95357466474309
curr_Factors:  [101.95357466]
mat_Sqrt:  [[0.15]]
grads:  [0.01358507]
Stock Position:  0.013585071928767007
Bond Position:  [1.76452854]


portfolio before change:  [3.15099844]
curr_Stock_Price:  102.04210385255598
curr_Factors:  [102.04210385]
mat_Sqrt:  [[0.15]]
grads:  [0.05852367]
Stock Position:  0.0585236724448023
Bond Position:  [-2.82088022]


portfolio before change:  [3.17245785]
curr_Stock_Price:  102.41480843536976
curr_Factors:  [102.41480844]
mat_Sqrt:  [[0.15]]
grads:  [0.07498087]
Stock Position:  0.07498087232271795
Bond Position:  [-4.50669382]


portfolio before change:  [3.22353143]
curr_Stock_Price:  103.1034767095607
curr_Factors:  [103.10347671]
mat_Sqrt:  [[0.15]]
grads:  [0.07787372]
Stock Position:  0.07787372173840666
Bond Position:  [-4.80552003]


portfolio before change:  [3.15968199]
curr_Stock_Price:  102.29128084917856
curr_Factors:  [102.29128085]
mat_Sqrt:  [[0.15]]
grads:  [-0.0955161]
Stock Position:  -0.0955160978419461
Bond Position:  [12.93014598]


portfolio before change:  [3.15988711]
curr_Stock_Price:  102.30605575690714
curr_Factors:  [102.30605576]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870713]
Stock Position:  -0.04870712909080373
Bond Position:  [8.14292138]


portfolio before change:  [3.14039952]
curr_Stock_Price:  102.72705212694679
curr_Factors:  [102.72705213]
mat_Sqrt:  [[0.15]]
grads:  [0.1746488]
Stock Position:  0.17464879976642922
Bond Position:  [-14.80075684]


portfolio before change:  [3.32273011]
curr_Stock_Price:  103.78163024581804
curr_Factors:  [103.78163025]
mat_Sqrt:  [[0.15]]
grads:  [-0.20857785]
Stock Position:  -0.20857784540311342
Bond Position:  [24.96927894]


portfolio before change:  [3.07437317]
curr_Stock_Price:  104.98731102547382
curr_Factors:  [104.98731103]
mat_Sqrt:  [[0.15]]
grads:  [0.05314053]
Stock Position:  0.05314053322638385
Bond Position:  [-2.50470852]


portfolio before change:  [2.98458062]
curr_Stock_Price:  103.3034845078769
curr_Factors:  [103.30348451]
mat_Sqrt:  [[0.15]]
grads:  [0.0238902]
Stock Position:  0.02389019802716273
Bond Position:  [0.51663992]


portfolio before change:  [2.99172962]
curr_Stock_Price:  103.60002506331709
curr_Factors:  [103.60002506]
mat_Sqrt:  [[0.15]]
grads:  [-0.07254837]
Stock Position:  -0.07254837423936458
Bond Position:  [10.50774301]


portfolio before change:  [3.00760209]
curr_Stock_Price:  103.39934618885849
curr_Factors:  [103.39934619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00570192]
Stock Position:  -0.0057019151058495775
Bond Position:  [3.59717639]


portfolio before change:  [3.00644723]
curr_Stock_Price:  103.68074969948195
curr_Factors:  [103.6807497]
mat_Sqrt:  [[0.15]]
grads:  [-0.07147245]
Stock Position:  -0.07147245151586504
Bond Position:  [10.41676458]


portfolio before change:  [3.03279925]
curr_Stock_Price:  103.33026725676828
curr_Factors:  [103.33026726]
mat_Sqrt:  [[0.15]]
grads:  [0.33269097]
Stock Position:  0.33269096513900476
Bond Position:  [-31.3442471]


portfolio before change:  [2.93723034]
curr_Stock_Price:  103.05478449304033
curr_Factors:  [103.05478449]
mat_Sqrt:  [[0.15]]
grads:  [-0.05910002]
Stock Position:  -0.05910001808335207
Bond Position:  [9.02776997]


portfolio before change:  [2.926428]
curr_Stock_Price:  103.25666068509209
curr_Factors:  [103.25666069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02145917]
Stock Position:  -0.021459171297922245
Bond Position:  [5.14223037]


portfolio before change:  [2.94880129]
curr_Stock_Price:  102.24401782897274
curr_Factors:  [102.24401783]
mat_Sqrt:  [[0.15]]
grads:  [0.03396522]
Stock Position:  0.033965220110981416
Bond Position:  [-0.52393928]


portfolio before change:  [2.96213966]
curr_Stock_Price:  102.63865274464507
curr_Factors:  [102.63865274]
mat_Sqrt:  [[0.15]]
grads:  [0.03446307]
Stock Position:  0.03446307378885987
Bond Position:  [-0.5751038]


portfolio before change:  [2.90170546]
curr_Stock_Price:  100.88714589171926
curr_Factors:  [100.88714589]
mat_Sqrt:  [[0.15]]
grads:  [-0.06832527]
Stock Position:  -0.06832526528274215
Bond Position:  [9.79484646]


portfolio before change:  [2.91105086]
curr_Stock_Price:  100.76828841320278
curr_Factors:  [100.76828841]
mat_Sqrt:  [[0.15]]
grads:  [0.13952304]
Stock Position:  0.13952304186842454
Bond Position:  [-11.14844727]


portfolio before change:  [2.77781456]
curr_Stock_Price:  99.82333583560056
curr_Factors:  [99.82333584]
mat_Sqrt:  [[0.15]]
grads:  [0.03763554]
Stock Position:  0.03763554283287324
Bond Position:  [-0.97909088]


portfolio before change:  [2.73407156]
curr_Stock_Price:  98.66430903319622
curr_Factors:  [98.66430903]
mat_Sqrt:  [[0.15]]
grads:  [0.0223206]
Stock Position:  0.02232060120474144
Bond Position:  [0.53182486]


portfolio before change:  [2.71540105]
curr_Stock_Price:  97.82486086844473
curr_Factors:  [97.82486087]
mat_Sqrt:  [[0.15]]
grads:  [0.07684414]
Stock Position:  0.07684413873230855
Bond Position:  [-4.80186613]


portfolio before change:  [2.70017979]
curr_Stock_Price:  97.6345926973275
curr_Factors:  [97.6345927]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.70017979]
Stock Price:  97.70080140857016
PL:  [2.70017979]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.64056211e-03]
 [-4.27629496e-03]
 [ 1.53283761e-02]
 [-8.17847031e-04]
 [ 1.16104850e-02]
 [ 2.63055857e-02]
 [-4.47395501e-03]
 [ 1.69933795e-02]
 [-5.95025276e-03]
 [-1.73010419e-03]
 [ 1.06679541e-02]
 [ 5.90883011e-03]
 [ 9.85156031e-03]
 [-2.58028390e-03]
 [ 2.30955482e-02]
 [-2.04354462e-04]
 [ 1.40198596e-02]
 [ 1.43511265e-03]
 [ 1.10402189e-02]
 [-1.24851126e-02]
 [ 6.38229903e-03]
 [ 1.00262962e-02]
 [ 1.46415027e-02]
 [ 5.97476572e-03]
 [-7.99747081e-03]
 [-6.61999036e-03]
 [ 7.90192450e-04]
 [-1.10430237e-02]
 [ 2.44831829e-02]
 [-1.03958423e-02]
 [-1.22239053e-03]
 [ 5.16257484e-03]
 [ 5.12728394e-03]
 [-4.57443460e-03]
 [ 1.23397471e-02]
 [ 5.40350291e-03]
 [ 2.15599880e-03]
 [ 7.88989290e-03]
 [-7.39370255e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.96165082]
curr_Stock_Price:  100.25864638132418
curr_Factors:  [100.25864638]
mat_Sqrt:  [[0.15]]
grads:  [0.04427041]
Stock Position:  0.044270414073020695
Bond Position:  [1.52315903]


portfolio before change:  [6.0293817]
curr_Stock_Price:  101.78428111517916
curr_Factors:  [101.78428112]
mat_Sqrt:  [[0.15]]
grads:  [-0.02850863]
Stock Position:  -0.02850863309640636
Bond Position:  [8.93111243]


portfolio before change:  [6.04192098]
curr_Stock_Price:  101.38360172333851
curr_Factors:  [101.38360172]
mat_Sqrt:  [[0.15]]
grads:  [0.10218917]
Stock Position:  0.10218917378327338
Bond Position:  [-4.31838551]


portfolio before change:  [5.99546575]
curr_Stock_Price:  100.93428406877953
curr_Factors:  [100.93428407]
mat_Sqrt:  [[0.15]]
grads:  [-0.00545231]
Stock Position:  -0.005452313543213803
Bond Position:  [6.54579112]


portfolio before change:  [5.99030728]
curr_Stock_Price:  102.0304696735248
curr_Factors:  [102.03046967]
mat_Sqrt:  [[0.15]]
grads:  [0.07740323]
Stock Position:  0.07740323315491732
Bond Position:  [-1.90718095]


portfolio before change:  [5.91983238]
curr_Stock_Price:  101.12305942857405
curr_Factors:  [101.12305943]
mat_Sqrt:  [[0.15]]
grads:  [0.17537057]
Stock Position:  0.17537057111505966
Bond Position:  [-11.8141763]


portfolio before change:  [5.93716786]
curr_Stock_Price:  101.23033137414696
curr_Factors:  [101.23033137]
mat_Sqrt:  [[0.15]]
grads:  [-0.02982637]
Stock Position:  -0.029826366737742527
Bond Position:  [8.95650085]


portfolio before change:  [5.95179716]
curr_Stock_Price:  100.77738739713024
curr_Factors:  [100.7773874]
mat_Sqrt:  [[0.15]]
grads:  [0.1132892]
Stock Position:  0.11328919671934222
Bond Position:  [-5.4651921]


portfolio before change:  [5.88085511]
curr_Stock_Price:  100.15721473366229
curr_Factors:  [100.15721473]
mat_Sqrt:  [[0.15]]
grads:  [-0.03966835]
Stock Position:  -0.03966835172166779
Bond Position:  [9.85392673]


portfolio before change:  [5.83344141]
curr_Stock_Price:  101.38352009365502
curr_Factors:  [101.38352009]
mat_Sqrt:  [[0.15]]
grads:  [-0.01153403]
Stock Position:  -0.01153402792512438
Bond Position:  [7.00280177]


portfolio before change:  [5.84229393]
curr_Stock_Price:  100.6919047319792
curr_Factors:  [100.69190473]
mat_Sqrt:  [[0.15]]
grads:  [0.07111969]
Stock Position:  0.07111969402108663
Bond Position:  [-1.31888352]


portfolio before change:  [5.9470904]
curr_Stock_Price:  102.16774539960731
curr_Factors:  [102.1677454]
mat_Sqrt:  [[0.15]]
grads:  [0.0393922]
Stock Position:  0.039392200709074114
Bond Position:  [1.92247806]


portfolio before change:  [5.9252471]
curr_Stock_Price:  101.60713634193661
curr_Factors:  [101.60713634]
mat_Sqrt:  [[0.15]]
grads:  [0.06567707]
Stock Position:  0.06567706870034132
Bond Position:  [-0.74801178]


portfolio before change:  [5.89170931]
curr_Stock_Price:  101.09791320290483
curr_Factors:  [101.0979132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01720189]
Stock Position:  -0.01720189268937733
Bond Position:  [7.63078476]


portfolio before change:  [5.88664219]
curr_Stock_Price:  101.44793407309048
curr_Factors:  [101.44793407]
mat_Sqrt:  [[0.15]]
grads:  [0.15397032]
Stock Position:  0.153970321203307
Bond Position:  [-9.7333288]


portfolio before change:  [5.71072325]
curr_Stock_Price:  100.31328553849542
curr_Factors:  [100.31328554]
mat_Sqrt:  [[0.15]]
grads:  [-0.00136236]
Stock Position:  -0.001362363076757679
Bond Position:  [5.84738637]


portfolio before change:  [5.71432064]
curr_Stock_Price:  98.2092823745483
curr_Factors:  [98.20928237]
mat_Sqrt:  [[0.15]]
grads:  [0.09346573]
Stock Position:  0.09346573068921826
Bond Position:  [-3.4648817]


portfolio before change:  [5.82941137]
curr_Stock_Price:  99.44528484724353
curr_Factors:  [99.44528485]
mat_Sqrt:  [[0.15]]
grads:  [0.00956742]
Stock Position:  0.00956741763420523
Bond Position:  [4.8779768]


portfolio before change:  [5.82949258]
curr_Stock_Price:  99.39003694159047
curr_Factors:  [99.39003694]
mat_Sqrt:  [[0.15]]
grads:  [0.07360146]
Stock Position:  0.07360145933209025
Bond Position:  [-1.48575918]


portfolio before change:  [5.86054183]
curr_Stock_Price:  99.81441684463974
curr_Factors:  [99.81441684]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323408]
Stock Position:  -0.08323408378934408
Bond Position:  [14.16850336]


portfolio before change:  [5.91619712]
curr_Stock_Price:  99.16703639011934
curr_Factors:  [99.16703639]
mat_Sqrt:  [[0.15]]
grads:  [0.04254866]
Stock Position:  0.04254866019929255
Bond Position:  [1.69677259]


portfolio before change:  [5.92866685]
curr_Stock_Price:  99.4551211302523
curr_Factors:  [99.45512113]
mat_Sqrt:  [[0.15]]
grads:  [0.06684197]
Stock Position:  0.06684197454316364
Bond Position:  [-0.71910982]


portfolio before change:  [5.92222693]
curr_Stock_Price:  99.36012052555598
curr_Factors:  [99.36012053]
mat_Sqrt:  [[0.15]]
grads:  [0.09761002]
Stock Position:  0.09761001804583265
Bond Position:  [-3.77631623]


portfolio before change:  [6.01180788]
curr_Stock_Price:  100.28270027609953
curr_Factors:  [100.28270028]
mat_Sqrt:  [[0.15]]
grads:  [0.03983177]
Stock Position:  0.039831771456454404
Bond Position:  [2.01737029]


portfolio before change:  [6.05783883]
curr_Stock_Price:  101.43200286560635
curr_Factors:  [101.43200287]
mat_Sqrt:  [[0.15]]
grads:  [-0.05331647]
Stock Position:  -0.053316472046013495
Bond Position:  [11.46583538]


portfolio before change:  [6.05304254]
curr_Stock_Price:  101.54884498549818
curr_Factors:  [101.54884499]
mat_Sqrt:  [[0.15]]
grads:  [-0.04413327]
Stock Position:  -0.044133269067248015
Bond Position:  [10.53472504]


portfolio before change:  [6.0740893]
curr_Stock_Price:  101.10179373773079
curr_Factors:  [101.10179374]
mat_Sqrt:  [[0.15]]
grads:  [0.00526795]
Stock Position:  0.005267949667843592
Bond Position:  [5.54149013]


portfolio before change:  [6.0816484]
curr_Stock_Price:  102.40521858232067
curr_Factors:  [102.40521858]
mat_Sqrt:  [[0.15]]
grads:  [-0.07362016]
Stock Position:  -0.07362015800248449
Bond Position:  [13.62073677]


portfolio before change:  [6.0958229]
curr_Stock_Price:  102.23581110807224
curr_Factors:  [102.23581111]
mat_Sqrt:  [[0.15]]
grads:  [0.16322122]
Stock Position:  0.163221219413646
Bond Position:  [-10.59123085]


portfolio before change:  [6.10844493]
curr_Stock_Price:  102.32125348538139
curr_Factors:  [102.32125349]
mat_Sqrt:  [[0.15]]
grads:  [-0.06930562]
Stock Position:  -0.06930561526940811
Bond Position:  [13.19988235]


portfolio before change:  [6.18987228]
curr_Stock_Price:  101.17015969171315
curr_Factors:  [101.17015969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00814927]
Stock Position:  -0.008149270220866412
Bond Position:  [7.01433525]


portfolio before change:  [6.18801824]
curr_Stock_Price:  101.50526809086885
curr_Factors:  [101.50526809]
mat_Sqrt:  [[0.15]]
grads:  [0.03441717]
Stock Position:  0.03441716558990418
Bond Position:  [2.69449462]


portfolio before change:  [6.18159254]
curr_Stock_Price:  101.30878104631742
curr_Factors:  [101.30878105]
mat_Sqrt:  [[0.15]]
grads:  [0.03418189]
Stock Position:  0.034181892934018104
Bond Position:  [2.71866664]


portfolio before change:  [6.23565866]
curr_Stock_Price:  102.8805564489506
curr_Factors:  [102.88055645]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049623]
Stock Position:  -0.030496230646524503
Bond Position:  [9.37312783]


portfolio before change:  [6.2352133]
curr_Stock_Price:  102.93358182872734
curr_Factors:  [102.93358183]
mat_Sqrt:  [[0.15]]
grads:  [0.08226498]
Stock Position:  0.08226498096571568
Bond Position:  [-2.23261585]


portfolio before change:  [6.19642556]
curr_Stock_Price:  102.4654769039409
curr_Factors:  [102.4654769]
mat_Sqrt:  [[0.15]]
grads:  [0.03602335]
Stock Position:  0.03602335276226924
Bond Position:  [2.50527554]


portfolio before change:  [6.14517681]
curr_Stock_Price:  101.03412967028224
curr_Factors:  [101.03412967]
mat_Sqrt:  [[0.15]]
grads:  [0.01437333]
Stock Position:  0.01437332534845008
Bond Position:  [4.69298039]


portfolio before change:  [6.14972885]
curr_Stock_Price:  101.3100140765991
curr_Factors:  [101.31001408]
mat_Sqrt:  [[0.15]]
grads:  [0.05259929]
Stock Position:  0.052599285966730774
Bond Position:  [0.82089445]


portfolio before change:  [6.09738583]
curr_Stock_Price:  100.31293518026305
curr_Factors:  [100.31293518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.09738583]
Stock Price:  100.93821402349018
PL:  [5.1591718]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.73123136e-03]
 [ 3.18589273e-03]
 [-4.39768257e-04]
 [-2.28880844e-03]
 [ 1.08576308e-02]
 [ 3.00479145e-02]
 [ 2.66476839e-02]
 [ 1.59114853e-03]
 [-1.20314574e-02]
 [-1.97742402e-03]
 [ 2.28345167e-02]
 [ 9.68818001e-03]
 [-3.05203140e-03]
 [-4.19529710e-03]
 [ 2.84384330e-03]
 [ 4.27873594e-03]
 [ 9.20187356e-03]
 [-7.35818232e-03]
 [ 1.21086847e-02]
 [-1.68966050e-02]
 [ 1.21894084e-02]
 [ 3.83517730e-02]
 [-1.89380784e-02]
 [ 6.66347634e-03]
 [ 4.25989076e-03]
 [-8.54524112e-03]
 [-1.12639172e-03]
 [-1.10014861e-02]
 [ 4.07776473e-02]
 [-7.74495119e-03]
 [ 1.58630884e-04]
 [ 5.15649016e-03]
 [ 5.11314121e-03]
 [-4.06333187e-03]
 [ 8.30841169e-03]
 [ 4.94407366e-03]
 [-2.17721840e-02]
 [ 9.61694893e-03]
 [-3.75787326e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.7166638]
curr_Stock_Price:  100.62989863848783
curr_Factors:  [100.62989864]
mat_Sqrt:  [[0.15]]
grads:  [0.03820821]
Stock Position:  0.03820820906273988
Bond Position:  [7.8717756]


portfolio before change:  [11.68747573]
curr_Stock_Price:  99.84022275892345
curr_Factors:  [99.84022276]
mat_Sqrt:  [[0.15]]
grads:  [0.02123928]
Stock Position:  0.021239284841839956
Bond Position:  [9.5669408]


portfolio before change:  [11.67796123]
curr_Stock_Price:  99.33594761647606
curr_Factors:  [99.33594762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293179]
Stock Position:  -0.002931788381415677
Bond Position:  [11.96919321]


portfolio before change:  [11.67859831]
curr_Stock_Price:  99.62900025807089
curr_Factors:  [99.62900026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525872]
Stock Position:  -0.015258722913726435
Bond Position:  [13.19880962]


portfolio before change:  [11.64301544]
curr_Stock_Price:  102.06910116810812
curr_Factors:  [102.06910117]
mat_Sqrt:  [[0.15]]
grads:  [0.07238421]
Stock Position:  0.07238420554226097
Bond Position:  [4.25482464]


portfolio before change:  [11.69019004]
curr_Stock_Price:  102.71347815113432
curr_Factors:  [102.71347815]
mat_Sqrt:  [[0.15]]
grads:  [0.20031943]
Stock Position:  0.20031943023023924
Bond Position:  [-8.88531538]


portfolio before change:  [11.72957585]
curr_Stock_Price:  102.91563800741142
curr_Factors:  [102.91563801]
mat_Sqrt:  [[0.15]]
grads:  [0.17765123]
Stock Position:  0.17765122632321895
Bond Position:  [-6.55351345]


portfolio before change:  [11.83049624]
curr_Stock_Price:  103.48833108978035
curr_Factors:  [103.48833109]
mat_Sqrt:  [[0.15]]
grads:  [0.01060766]
Stock Position:  0.010607656857437829
Bond Position:  [10.73272754]


portfolio before change:  [11.83913363]
curr_Stock_Price:  104.17610916263367
curr_Factors:  [104.17610916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08020972]
Stock Position:  -0.08020971588560259
Bond Position:  [20.19506975]


portfolio before change:  [11.85394643]
curr_Stock_Price:  104.02290758577003
curr_Factors:  [104.02290759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01318283]
Stock Position:  -0.013182826775669317
Bond Position:  [13.2252624]


portfolio before change:  [11.85538145]
curr_Stock_Price:  104.03946199550066
curr_Factors:  [104.039462]
mat_Sqrt:  [[0.15]]
grads:  [0.15223011]
Stock Position:  0.15223011114902815
Bond Position:  [-3.98255741]


portfolio before change:  [12.01716425]
curr_Stock_Price:  105.10548400886097
curr_Factors:  [105.10548401]
mat_Sqrt:  [[0.15]]
grads:  [0.06458787]
Stock Position:  0.06458786671097089
Bond Position:  [5.22862526]


portfolio before change:  [12.06124058]
curr_Stock_Price:  105.77778847280058
curr_Factors:  [105.77778847]
mat_Sqrt:  [[0.15]]
grads:  [-0.02034688]
Stock Position:  -0.020346876010487343
Bond Position:  [14.21348813]


portfolio before change:  [12.08674332]
curr_Stock_Price:  104.61171581803139
curr_Factors:  [104.61171582]
mat_Sqrt:  [[0.15]]
grads:  [-0.02796865]
Stock Position:  -0.027968647331799643
Bond Position:  [15.0125915]


portfolio before change:  [12.09766755]
curr_Stock_Price:  104.2882271535164
curr_Factors:  [104.28822715]
mat_Sqrt:  [[0.15]]
grads:  [0.01895896]
Stock Position:  0.01895895535054258
Bond Position:  [10.12047171]


portfolio before change:  [12.10820806]
curr_Stock_Price:  104.7774617021648
curr_Factors:  [104.7774617]
mat_Sqrt:  [[0.15]]
grads:  [0.02852491]
Stock Position:  0.028524906255418803
Bond Position:  [9.11944079]


portfolio before change:  [12.12622364]
curr_Stock_Price:  105.36907022823631
curr_Factors:  [105.36907023]
mat_Sqrt:  [[0.15]]
grads:  [0.06134582]
Stock Position:  0.06134582371349363
Bond Position:  [5.66227123]


portfolio before change:  [12.09986499]
curr_Stock_Price:  104.92785883287816
curr_Factors:  [104.92785883]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905455]
Stock Position:  -0.04905454878342849
Bond Position:  [17.24705376]


portfolio before change:  [12.10753358]
curr_Stock_Price:  104.81548239328589
curr_Factors:  [104.81548239]
mat_Sqrt:  [[0.15]]
grads:  [0.08072456]
Stock Position:  0.08072456488442085
Bond Position:  [3.64634938]


portfolio before change:  [12.10945352]
curr_Stock_Price:  104.83361956792497
curr_Factors:  [104.83361957]
mat_Sqrt:  [[0.15]]
grads:  [-0.11264403]
Stock Position:  -0.11264403362308618
Bond Position:  [23.91833529]


portfolio before change:  [12.050678]
curr_Stock_Price:  105.38194425643033
curr_Factors:  [105.38194426]
mat_Sqrt:  [[0.15]]
grads:  [0.08126272]
Stock Position:  0.08126272299437343
Bond Position:  [3.48705425]


portfolio before change:  [12.03375658]
curr_Stock_Price:  105.16834907423522
curr_Factors:  [105.16834907]
mat_Sqrt:  [[0.15]]
grads:  [0.25567849]
Stock Position:  0.25567848674717863
Bond Position:  [-14.85552777]


portfolio before change:  [11.85324955]
curr_Stock_Price:  104.46962008645781
curr_Factors:  [104.46962009]
mat_Sqrt:  [[0.15]]
grads:  [-0.12625386]
Stock Position:  -0.1262538558652889
Bond Position:  [25.04294191]


portfolio before change:  [12.01216683]
curr_Stock_Price:  103.23570361810809
curr_Factors:  [103.23570362]
mat_Sqrt:  [[0.15]]
grads:  [0.04442318]
Stock Position:  0.044423175609481926
Bond Position:  [7.42610904]


portfolio before change:  [12.02127852]
curr_Stock_Price:  103.41991764041762
curr_Factors:  [103.41991764]
mat_Sqrt:  [[0.15]]
grads:  [0.02839927]
Stock Position:  0.02839927175158738
Bond Position:  [9.08422818]


portfolio before change:  [12.01131652]
curr_Stock_Price:  103.02914707536814
curr_Factors:  [103.02914708]
mat_Sqrt:  [[0.15]]
grads:  [-0.05696827]
Stock Position:  -0.056968274155898606
Bond Position:  [17.88070922]


portfolio before change:  [12.08269153]
curr_Stock_Price:  101.81549291372026
curr_Factors:  [101.81549291]
mat_Sqrt:  [[0.15]]
grads:  [-0.00750928]
Stock Position:  -0.007509278101984949
Bond Position:  [12.84725238]


portfolio before change:  [12.07923494]
curr_Stock_Price:  102.48967148949863
curr_Factors:  [102.48967149]
mat_Sqrt:  [[0.15]]
grads:  [-0.07334324]
Stock Position:  -0.07334324043885543
Bond Position:  [19.59615956]


portfolio before change:  [12.05559745]
curr_Stock_Price:  102.84535751809295
curr_Factors:  [102.84535752]
mat_Sqrt:  [[0.15]]
grads:  [0.27185098]
Stock Position:  0.2718509821371946
Bond Position:  [-15.903014]


portfolio before change:  [12.23628815]
curr_Stock_Price:  103.51733854069984
curr_Factors:  [103.51733854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05163301]
Stock Position:  -0.05163300791221434
Bond Position:  [17.58119971]


portfolio before change:  [12.29674455]
curr_Stock_Price:  102.38901738679834
curr_Factors:  [102.38901739]
mat_Sqrt:  [[0.15]]
grads:  [0.00105754]
Stock Position:  0.0010575392294154375
Bond Position:  [12.18846415]


portfolio before change:  [12.29756195]
curr_Stock_Price:  101.72118179290523
curr_Factors:  [101.72118179]
mat_Sqrt:  [[0.15]]
grads:  [0.0343766]
Stock Position:  0.03437660107884176
Bond Position:  [8.80073346]


portfolio before change:  [12.32076964]
curr_Stock_Price:  102.36428006328715
curr_Factors:  [102.36428006]
mat_Sqrt:  [[0.15]]
grads:  [0.03408761]
Stock Position:  0.034087608098721196
Bond Position:  [8.83141618]


portfolio before change:  [12.36870652]
curr_Stock_Price:  103.73817787605311
curr_Factors:  [103.73817788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02708888]
Stock Position:  -0.027088879100967817
Bond Position:  [15.17885748]


portfolio before change:  [12.37794641]
curr_Stock_Price:  103.46712915249586
curr_Factors:  [103.46712915]
mat_Sqrt:  [[0.15]]
grads:  [0.05538941]
Stock Position:  0.055389411248624384
Bond Position:  [6.64696304]


portfolio before change:  [12.39472077]
curr_Stock_Price:  103.7549719055677
curr_Factors:  [103.75497191]
mat_Sqrt:  [[0.15]]
grads:  [0.03296049]
Stock Position:  0.03296049104626668
Bond Position:  [8.97490595]


portfolio before change:  [12.42826733]
curr_Stock_Price:  104.73871401589713
curr_Factors:  [104.73871402]
mat_Sqrt:  [[0.15]]
grads:  [-0.14514789]
Stock Position:  -0.1451478933801672
Bond Position:  [27.63087102]


portfolio before change:  [12.1380045]
curr_Stock_Price:  106.76228383381793
curr_Factors:  [106.76228383]
mat_Sqrt:  [[0.15]]
grads:  [0.06411299]
Stock Position:  0.0641129928400674
Bond Position:  [5.29315497]


portfolio before change:  [12.21767176]
curr_Stock_Price:  107.99457028450779
curr_Factors:  [107.99457028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.21767176]
Stock Price:  107.68315759874731
PL:  [4.53451416]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.59883006e-03]
 [ 2.96814630e-03]
 [ 1.07714132e-02]
 [-2.68407395e-03]
 [ 1.50289633e-02]
 [ 2.61563429e-02]
 [ 1.41969245e-03]
 [ 9.73201943e-03]
 [-6.07578442e-03]
 [ 2.87056916e-03]
 [ 1.05425855e-02]
 [ 4.47498931e-03]
 [ 5.23432357e-03]
 [-4.45174829e-03]
 [ 6.93181910e-03]
 [ 3.85174122e-03]
 [ 9.14462505e-03]
 [-1.36828514e-02]
 [ 1.25097576e-02]
 [-1.77232502e-02]
 [ 1.46935070e-02]
 [ 4.18094885e-02]
 [-3.97909850e-05]
 [ 7.39903687e-03]
 [ 7.63864114e-03]
 [-2.14068361e-02]
 [ 3.42740911e-04]
 [-1.43918990e-02]
 [ 7.08031582e-02]
 [-2.89997249e-03]
 [-1.03440624e-02]
 [ 4.33421008e-03]
 [ 6.48643555e-03]
 [ 5.65217676e-05]
 [ 6.99431160e-03]
 [ 4.09033849e-03]
 [-5.56885448e-02]
 [ 9.50525092e-03]
 [-9.38811182e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.25414592]
curr_Stock_Price:  100.66457127079022
curr_Factors:  [100.66457127]
mat_Sqrt:  [[0.15]]
grads:  [0.03732553]
Stock Position:  0.03732553374693257
Bond Position:  [8.49678707]


portfolio before change:  [12.25880534]
curr_Stock_Price:  100.7609464996722
curr_Factors:  [100.7609465]
mat_Sqrt:  [[0.15]]
grads:  [0.01978764]
Stock Position:  0.019787641978349417
Bond Position:  [10.26498381]


portfolio before change:  [12.25649019]
curr_Stock_Price:  100.57909809679406
curr_Factors:  [100.5790981]
mat_Sqrt:  [[0.15]]
grads:  [0.07180942]
Stock Position:  0.0718094211110688
Bond Position:  [5.03396338]


portfolio before change:  [12.2099378]
curr_Stock_Price:  99.9220579171491
curr_Factors:  [99.92205792]
mat_Sqrt:  [[0.15]]
grads:  [-0.01789383]
Stock Position:  -0.017893826322601097
Bond Position:  [13.99792575]


portfolio before change:  [12.19391824]
curr_Stock_Price:  100.9151049108937
curr_Factors:  [100.91510491]
mat_Sqrt:  [[0.15]]
grads:  [0.10019309]
Stock Position:  0.10019308858051547
Bond Position:  [2.0829222]


portfolio before change:  [12.19533698]
curr_Stock_Price:  100.926666106844
curr_Factors:  [100.92666611]
mat_Sqrt:  [[0.15]]
grads:  [0.17437562]
Stock Position:  0.17437561918442823
Bond Position:  [-5.40381292]


portfolio before change:  [12.30030388]
curr_Stock_Price:  101.53249861290178
curr_Factors:  [101.53249861]
mat_Sqrt:  [[0.15]]
grads:  [0.00946462]
Stock Position:  0.00946461631134017
Bond Position:  [11.33933773]


portfolio before change:  [12.30545207]
curr_Stock_Price:  101.92667043318134
curr_Factors:  [101.92667043]
mat_Sqrt:  [[0.15]]
grads:  [0.06488013]
Stock Position:  0.06488012951703609
Bond Position:  [5.69243649]


portfolio before change:  [12.21663816]
curr_Stock_Price:  100.54681030711465
curr_Factors:  [100.54681031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04050523]
Stock Position:  -0.040505229460962626
Bond Position:  [16.28930979]


portfolio before change:  [12.24380255]
curr_Stock_Price:  99.92644363823183
curr_Factors:  [99.92644364]
mat_Sqrt:  [[0.15]]
grads:  [0.01913713]
Stock Position:  0.019137127761105235
Bond Position:  [10.33149743]


portfolio before change:  [12.26395334]
curr_Stock_Price:  100.91192467349858
curr_Factors:  [100.91192467]
mat_Sqrt:  [[0.15]]
grads:  [0.0702839]
Stock Position:  0.07028390353605049
Bond Position:  [5.17146936]


portfolio before change:  [12.27712577]
curr_Stock_Price:  101.09014408981528
curr_Factors:  [101.09014409]
mat_Sqrt:  [[0.15]]
grads:  [0.02983326]
Stock Position:  0.029833262062379774
Bond Position:  [9.26127701]


portfolio before change:  [12.33735122]
curr_Stock_Price:  103.07007237078649
curr_Factors:  [103.07007237]
mat_Sqrt:  [[0.15]]
grads:  [0.03489549]
Stock Position:  0.03489549044286173
Bond Position:  [8.7406705]


portfolio before change:  [12.33919597]
curr_Stock_Price:  103.09162522403389
curr_Factors:  [103.09162522]
mat_Sqrt:  [[0.15]]
grads:  [-0.02967832]
Stock Position:  -0.029678321960101794
Bond Position:  [15.39878242]


portfolio before change:  [12.33536147]
curr_Stock_Price:  103.28568850435589
curr_Factors:  [103.2856885]
mat_Sqrt:  [[0.15]]
grads:  [0.04621213]
Stock Position:  0.046212127328125074
Bond Position:  [7.56231008]


portfolio before change:  [12.38841246]
curr_Stock_Price:  104.413220248134
curr_Factors:  [104.41322025]
mat_Sqrt:  [[0.15]]
grads:  [0.02567827]
Stock Position:  0.025678274773756976
Bond Position:  [9.7072611]


portfolio before change:  [12.3846031]
curr_Stock_Price:  104.21761382544447
curr_Factors:  [104.21761383]
mat_Sqrt:  [[0.15]]
grads:  [0.06096417]
Stock Position:  0.060964167022773526
Bond Position:  [6.03106309]


portfolio before change:  [12.46718167]
curr_Stock_Price:  105.559789712491
curr_Factors:  [105.55978971]
mat_Sqrt:  [[0.15]]
grads:  [-0.09121901]
Stock Position:  -0.09121900904997425
Bond Position:  [22.09624108]


portfolio before change:  [12.39136867]
curr_Stock_Price:  106.42118035074934
curr_Factors:  [106.42118035]
mat_Sqrt:  [[0.15]]
grads:  [0.08339838]
Stock Position:  0.08339838370413614
Bond Position:  [3.51601424]


portfolio before change:  [12.34565002]
curr_Stock_Price:  105.86771417098912
curr_Factors:  [105.86771417]
mat_Sqrt:  [[0.15]]
grads:  [-0.118155]
Stock Position:  -0.1181550010325573
Bond Position:  [24.85444989]


portfolio before change:  [12.34516377]
curr_Stock_Price:  105.89812550293135
curr_Factors:  [105.8981255]
mat_Sqrt:  [[0.15]]
grads:  [0.09795671]
Stock Position:  0.09795671336789405
Bond Position:  [1.97173144]


portfolio before change:  [12.35211325]
curr_Stock_Price:  105.96655369462425
curr_Factors:  [105.96655369]
mat_Sqrt:  [[0.15]]
grads:  [0.27872992]
Stock Position:  0.27872992323263573
Bond Position:  [-17.18393613]


portfolio before change:  [12.22619945]
curr_Stock_Price:  105.52251931272401
curr_Factors:  [105.52251931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026527]
Stock Position:  -0.0002652732331492417
Bond Position:  [12.25419175]


portfolio before change:  [12.22753294]
curr_Stock_Price:  106.27036647403648
curr_Factors:  [106.27036647]
mat_Sqrt:  [[0.15]]
grads:  [0.04932691]
Stock Position:  0.0493269124986025
Bond Position:  [6.98554387]


portfolio before change:  [12.20530947]
curr_Stock_Price:  105.80212889827584
curr_Factors:  [105.8021289]
mat_Sqrt:  [[0.15]]
grads:  [0.05092427]
Stock Position:  0.05092427426016455
Bond Position:  [6.81741284]


portfolio before change:  [12.2249428]
curr_Stock_Price:  106.17093325304018
curr_Factors:  [106.17093325]
mat_Sqrt:  [[0.15]]
grads:  [-0.14271224]
Stock Position:  -0.14271224068164662
Bond Position:  [27.37683458]


portfolio before change:  [12.22610374]
curr_Stock_Price:  106.18677894042973
curr_Factors:  [106.18677894]
mat_Sqrt:  [[0.15]]
grads:  [0.00228494]
Stock Position:  0.0022849394039928164
Bond Position:  [11.98347339]


portfolio before change:  [12.23021813]
curr_Stock_Price:  107.33182299435842
curr_Factors:  [107.33182299]
mat_Sqrt:  [[0.15]]
grads:  [-0.09594599]
Stock Position:  -0.0959459930705471
Bond Position:  [22.52827647]


portfolio before change:  [12.22831342]
curr_Stock_Price:  107.38102690598983
curr_Factors:  [107.38102691]
mat_Sqrt:  [[0.15]]
grads:  [0.47202105]
Stock Position:  0.4720210545423819
Bond Position:  [-38.45779214]


portfolio before change:  [11.91328598]
curr_Stock_Price:  106.72381063977333
curr_Factors:  [106.72381064]
mat_Sqrt:  [[0.15]]
grads:  [-0.01933315]
Stock Position:  -0.01933314990733266
Bond Position:  [13.97659341]


portfolio before change:  [11.9254436]
curr_Stock_Price:  106.18533459885951
curr_Factors:  [106.1853346]
mat_Sqrt:  [[0.15]]
grads:  [-0.06896042]
Stock Position:  -0.06896041581380125
Bond Position:  [19.24802843]


portfolio before change:  [11.93570774]
curr_Stock_Price:  106.07138539945187
curr_Factors:  [106.0713854]
mat_Sqrt:  [[0.15]]
grads:  [0.02889473]
Stock Position:  0.02889473384740924
Bond Position:  [8.87080329]


portfolio before change:  [11.96063223]
curr_Stock_Price:  106.89560395873207
curr_Factors:  [106.89560396]
mat_Sqrt:  [[0.15]]
grads:  [0.0432429]
Stock Position:  0.04324290364764064
Bond Position:  [7.33815593]


portfolio before change:  [11.92975608]
curr_Stock_Price:  106.1603739684606
curr_Factors:  [106.16037397]
mat_Sqrt:  [[0.15]]
grads:  [0.00037681]
Stock Position:  0.00037681178389518494
Bond Position:  [11.8897536]


portfolio before change:  [11.93070173]
curr_Stock_Price:  104.72553434187792
curr_Factors:  [104.72553434]
mat_Sqrt:  [[0.15]]
grads:  [0.04662874]
Stock Position:  0.04662874399554827
Bond Position:  [7.0474816]


portfolio before change:  [11.99136497]
curr_Stock_Price:  106.00762437565697
curr_Factors:  [106.00762438]
mat_Sqrt:  [[0.15]]
grads:  [0.02726892]
Stock Position:  0.02726892323419055
Bond Position:  [9.10065119]


portfolio before change:  [12.03818383]
curr_Stock_Price:  107.68283585976329
curr_Factors:  [107.68283586]
mat_Sqrt:  [[0.15]]
grads:  [-0.37125697]
Stock Position:  -0.37125696546506154
Bond Position:  [52.01618671]


portfolio before change:  [12.1910738]
curr_Stock_Price:  107.28853339096968
curr_Factors:  [107.28853339]
mat_Sqrt:  [[0.15]]
grads:  [0.06336834]
Stock Position:  0.06336833946814412
Bond Position:  [5.39237759]


portfolio before change:  [12.08683243]
curr_Stock_Price:  105.63288861067244
curr_Factors:  [105.63288861]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.08683243]
Stock Price:  105.90456311061003
PL:  [6.18226932]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.85892522e-03]
 [-1.23592552e-02]
 [-3.27143654e-02]
 [ 5.37972236e-03]
 [-5.64849959e-03]
 [-3.12434442e-02]
 [-3.80340816e-02]
 [ 1.49599985e-02]
 [-6.46635277e-03]
 [ 9.80223228e-03]
 [-1.39791895e-02]
 [ 7.63914155e-03]
 [ 1.38900011e-02]
 [ 1.81290951e-03]
 [ 3.64842517e-03]
 [-3.32967425e-03]
 [ 1.17898258e-02]
 [-8.42946216e-03]
 [ 5.74739850e-03]
 [-4.65351231e-03]
 [ 1.95944332e-02]
 [-1.24131671e-03]
 [ 2.19235621e-02]
 [ 4.54842032e-03]
 [ 1.13618345e-02]
 [-1.07966550e-02]
 [ 4.04504888e-03]
 [-1.07727579e-02]
 [-1.76747018e-02]
 [-5.27750768e-03]
 [-3.38751094e-03]
 [ 5.62354761e-03]
 [ 5.52035945e-03]
 [-1.12226631e-02]
 [ 1.97167584e-02]
 [ 5.48249436e-03]
 [ 2.38277963e-03]
 [ 8.19741972e-03]
 [-1.57099051e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.08921378]
curr_Stock_Price:  99.15870586340748
curr_Factors:  [99.15870586]
mat_Sqrt:  [[0.15]]
grads:  [0.04572617]
Stock Position:  0.04572616812889688
Bond Position:  [-15.62336143]


portfolio before change:  [-11.12328925]
curr_Stock_Price:  98.45621033418371
curr_Factors:  [98.45621033]
mat_Sqrt:  [[0.15]]
grads:  [-0.08239503]
Stock Position:  -0.0823950346376265
Bond Position:  [-3.01098639]


portfolio before change:  [-11.00711024]
curr_Stock_Price:  97.04161771622191
curr_Factors:  [97.04161772]
mat_Sqrt:  [[0.15]]
grads:  [-0.21809577]
Stock Position:  -0.21809576929165322
Bond Position:  [10.15725603]


portfolio before change:  [-11.15321494]
curr_Stock_Price:  97.71735040217905
curr_Factors:  [97.7173504]
mat_Sqrt:  [[0.15]]
grads:  [0.03586482]
Stock Position:  0.035864815742396826
Bond Position:  [-14.65782971]


portfolio before change:  [-11.12032753]
curr_Stock_Price:  98.68542317202007
curr_Factors:  [98.68542317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765666]
Stock Position:  -0.037656663957529604
Bond Position:  [-7.40416371]


portfolio before change:  [-11.06366978]
curr_Stock_Price:  97.15625622908551
curr_Factors:  [97.15625623]
mat_Sqrt:  [[0.15]]
grads:  [-0.20828963]
Stock Position:  -0.20828962795847408
Bond Position:  [9.17297068]


portfolio before change:  [-10.96158367]
curr_Stock_Price:  96.67164537201467
curr_Factors:  [96.67164537]
mat_Sqrt:  [[0.15]]
grads:  [-0.25356054]
Stock Position:  -0.2535605442211452
Bond Position:  [13.55053134]


portfolio before change:  [-11.04220443]
curr_Stock_Price:  96.99628055554784
curr_Factors:  [96.99628056]
mat_Sqrt:  [[0.15]]
grads:  [0.09973332]
Stock Position:  0.09973332318588495
Bond Position:  [-20.71596582]


portfolio before change:  [-11.06242341]
curr_Stock_Price:  96.8195159222392
curr_Factors:  [96.81951592]
mat_Sqrt:  [[0.15]]
grads:  [-0.04310902]
Stock Position:  -0.04310901849303143
Bond Position:  [-6.88862911]


portfolio before change:  [-11.0274389]
curr_Stock_Price:  95.9880044654717
curr_Factors:  [95.98800447]
mat_Sqrt:  [[0.15]]
grads:  [0.06534822]
Stock Position:  0.06534821519172145
Bond Position:  [-17.30008367]


portfolio before change:  [-11.05935198]
curr_Stock_Price:  95.53274440282294
curr_Factors:  [95.5327444]
mat_Sqrt:  [[0.15]]
grads:  [-0.0931946]
Stock Position:  -0.09319459663937163
Bond Position:  [-2.1562164]


portfolio before change:  [-11.09672354]
curr_Stock_Price:  95.93085780182017
curr_Factors:  [95.9308578]
mat_Sqrt:  [[0.15]]
grads:  [0.05092761]
Stock Position:  0.050927610335176794
Bond Position:  [-15.98225288]


portfolio before change:  [-11.06938787]
curr_Stock_Price:  96.50684340836054
curr_Factors:  [96.50684341]
mat_Sqrt:  [[0.15]]
grads:  [0.09260001]
Stock Position:  0.09260000714132305
Bond Position:  [-20.00592226]


portfolio before change:  [-10.99850592]
curr_Stock_Price:  97.29931475048434
curr_Factors:  [97.29931475]
mat_Sqrt:  [[0.15]]
grads:  [0.01208606]
Stock Position:  0.012086063430167895
Bond Position:  [-12.17447161]


portfolio before change:  [-10.98981851]
curr_Stock_Price:  98.14403282723958
curr_Factors:  [98.14403283]
mat_Sqrt:  [[0.15]]
grads:  [0.02432283]
Stock Position:  0.024322834490854785
Bond Position:  [-13.37695957]


portfolio before change:  [-10.97899999]
curr_Stock_Price:  98.6575726759753
curr_Factors:  [98.65757268]
mat_Sqrt:  [[0.15]]
grads:  [-0.02219783]
Stock Position:  -0.022197828328865417
Bond Position:  [-8.78901612]


portfolio before change:  [-10.98941526]
curr_Stock_Price:  99.0772796179479
curr_Factors:  [99.07727962]
mat_Sqrt:  [[0.15]]
grads:  [0.07859884]
Stock Position:  0.0785988387899736
Bond Position:  [-18.77677439]


portfolio before change:  [-11.06690902]
curr_Stock_Price:  98.12120301534672
curr_Factors:  [98.12120302]
mat_Sqrt:  [[0.15]]
grads:  [-0.05619641]
Stock Position:  -0.056196414382923165
Bond Position:  [-5.55284923]


portfolio before change:  [-11.03859875]
curr_Stock_Price:  97.60507718320345
curr_Factors:  [97.60507718]
mat_Sqrt:  [[0.15]]
grads:  [0.03831599]
Stock Position:  0.03831599000827232
Bond Position:  [-14.77843391]


portfolio before change:  [-11.03414045]
curr_Stock_Price:  97.76964867727243
curr_Factors:  [97.76964868]
mat_Sqrt:  [[0.15]]
grads:  [-0.03102342]
Stock Position:  -0.031023415417938335
Bond Position:  [-8.00099202]


portfolio before change:  [-11.02518605]
curr_Stock_Price:  97.44877533891342
curr_Factors:  [97.44877534]
mat_Sqrt:  [[0.15]]
grads:  [0.13062955]
Stock Position:  0.13062955446577243
Bond Position:  [-23.75487615]


portfolio before change:  [-11.02043199]
curr_Stock_Price:  97.50790130117036
curr_Factors:  [97.5079013]
mat_Sqrt:  [[0.15]]
grads:  [-0.00827544]
Stock Position:  -0.008275444719056616
Bond Position:  [-10.21351075]


portfolio before change:  [-11.02056099]
curr_Stock_Price:  97.36920542619002
curr_Factors:  [97.36920543]
mat_Sqrt:  [[0.15]]
grads:  [0.14615708]
Stock Position:  0.14615708050137813
Bond Position:  [-25.25175979]


portfolio before change:  [-10.98673527]
curr_Stock_Price:  97.62223725860636
curr_Factors:  [97.62223726]
mat_Sqrt:  [[0.15]]
grads:  [0.0303228]
Stock Position:  0.030322802156468848
Bond Position:  [-13.94691505]


portfolio before change:  [-10.95252255]
curr_Stock_Price:  98.80801766992647
curr_Factors:  [98.80801767]
mat_Sqrt:  [[0.15]]
grads:  [0.07574556]
Stock Position:  0.07574556349428604
Bond Position:  [-18.43679153]


portfolio before change:  [-10.93840808]
curr_Stock_Price:  99.0247857592863
curr_Factors:  [99.02478576]
mat_Sqrt:  [[0.15]]
grads:  [-0.0719777]
Stock Position:  -0.07197770000068746
Bond Position:  [-3.81083175]


portfolio before change:  [-11.01970067]
curr_Stock_Price:  100.1475809455164
curr_Factors:  [100.14758095]
mat_Sqrt:  [[0.15]]
grads:  [0.02696699]
Stock Position:  0.02696699250234011
Bond Position:  [-13.72037974]


portfolio before change:  [-11.0293891]
curr_Stock_Price:  99.85191333167197
curr_Factors:  [99.85191333]
mat_Sqrt:  [[0.15]]
grads:  [-0.07181839]
Stock Position:  -0.07181838622354743
Bond Position:  [-3.85818582]


portfolio before change:  [-11.03796435]
curr_Stock_Price:  99.96459963870493
curr_Factors:  [99.96459964]
mat_Sqrt:  [[0.15]]
grads:  [-0.11783135]
Stock Position:  -0.11783134559011657
Bond Position:  [0.74099894]


portfolio before change:  [-11.00953312]
curr_Stock_Price:  99.72409828742008
curr_Factors:  [99.72409829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03518338]
Stock Position:  -0.03518338452384958
Bond Position:  [-7.50090182]


portfolio before change:  [-10.99592714]
curr_Stock_Price:  99.31073116852463
curr_Factors:  [99.31073117]
mat_Sqrt:  [[0.15]]
grads:  [-0.02258341]
Stock Position:  -0.02258340629037617
Bond Position:  [-8.75315255]


portfolio before change:  [-10.9898724]
curr_Stock_Price:  98.99417365650493
curr_Factors:  [98.99417366]
mat_Sqrt:  [[0.15]]
grads:  [0.03749032]
Stock Position:  0.03749031739467182
Bond Position:  [-14.70119539]


portfolio before change:  [-10.95912611]
curr_Stock_Price:  99.86330635393266
curr_Factors:  [99.86330635]
mat_Sqrt:  [[0.15]]
grads:  [0.0368024]
Stock Position:  0.03680239633574215
Bond Position:  [-14.63433509]


portfolio before change:  [-10.94855228]
curr_Stock_Price:  100.20032886071117
curr_Factors:  [100.20032886]
mat_Sqrt:  [[0.15]]
grads:  [-0.07481775]
Stock Position:  -0.0748177540292804
Bond Position:  [-3.45178872]


portfolio before change:  [-10.9520426]
curr_Stock_Price:  100.24121246111088
curr_Factors:  [100.24121246]
mat_Sqrt:  [[0.15]]
grads:  [0.13144506]
Stock Position:  0.13144505584459232
Bond Position:  [-24.12825437]


portfolio before change:  [-10.81010299]
curr_Stock_Price:  101.34399889283783
curr_Factors:  [101.34399889]
mat_Sqrt:  [[0.15]]
grads:  [0.03654996]
Stock Position:  0.03654996236915301
Bond Position:  [-14.51422234]


portfolio before change:  [-10.83077827]
curr_Stock_Price:  100.82796871107978
curr_Factors:  [100.82796871]
mat_Sqrt:  [[0.15]]
grads:  [0.0158852]
Stock Position:  0.015885197535608735
Bond Position:  [-12.43245047]


portfolio before change:  [-10.81774429]
curr_Stock_Price:  101.74631593006623
curr_Factors:  [101.74631593]
mat_Sqrt:  [[0.15]]
grads:  [0.05464946]
Stock Position:  0.054649464815951815
Bond Position:  [-16.37812601]


portfolio before change:  [-10.79791898]
curr_Stock_Price:  102.1465523720393
curr_Factors:  [102.14655237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.79791898]
Stock Price:  102.42982876367094
PL:  [-13.22774774]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.93888959e-03]
 [ 4.66787480e-03]
 [ 1.13368611e-02]
 [ 1.73805604e-03]
 [ 1.49122560e-02]
 [ 2.62520468e-02]
 [ 2.27932163e-02]
 [ 5.48671841e-03]
 [-9.82874433e-03]
 [-2.53250966e-03]
 [ 2.11056905e-02]
 [ 9.19632919e-03]
 [ 4.74798698e-03]
 [-4.72783863e-03]
 [ 7.03763616e-03]
 [ 3.28650558e-03]
 [ 9.12559815e-03]
 [ 9.98794141e-03]
 [ 1.19338548e-02]
 [-1.66479892e-02]
 [ 5.63114431e-03]
 [ 3.08005816e-02]
 [-4.05846697e-02]
 [ 4.70540418e-03]
 [-1.96754420e-03]
 [-7.53550767e-03]
 [-7.97689539e-04]
 [-1.13123186e-02]
 [-1.85172932e-02]
 [-8.62100720e-03]
 [-3.10465732e-03]
 [ 5.48900257e-03]
 [ 5.72917693e-03]
 [-1.15874187e-02]
 [ 2.02276066e-02]
 [ 5.62808009e-03]
 [ 2.51009543e-03]
 [ 1.08622410e-02]
 [-1.62723067e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.28936101]
curr_Stock_Price:  100.02174928255259
curr_Factors:  [100.02174928]
mat_Sqrt:  [[0.15]]
grads:  [0.02625926]
Stock Position:  0.026259263916920905
Bond Position:  [-0.3371365]


portfolio before change:  [2.29266439]
curr_Stock_Price:  100.1491530136939
curr_Factors:  [100.14915301]
mat_Sqrt:  [[0.15]]
grads:  [0.03111917]
Stock Position:  0.03111916535749946
Bond Position:  [-0.82389366]


portfolio before change:  [2.30777153]
curr_Stock_Price:  100.63792345269007
curr_Factors:  [100.63792345]
mat_Sqrt:  [[0.15]]
grads:  [0.07557907]
Stock Position:  0.07557907368467655
Bond Position:  [-5.29834951]


portfolio before change:  [2.35710291]
curr_Stock_Price:  101.29939918786826
curr_Factors:  [101.29939919]
mat_Sqrt:  [[0.15]]
grads:  [0.01158704]
Stock Position:  0.011587040253279416
Bond Position:  [1.1833427]


portfolio before change:  [2.35402619]
curr_Stock_Price:  101.02110065963592
curr_Factors:  [101.02110066]
mat_Sqrt:  [[0.15]]
grads:  [0.09941504]
Stock Position:  0.09941504013868988
Bond Position:  [-7.68899059]


portfolio before change:  [2.35619711]
curr_Stock_Price:  101.05260599407053
curr_Factors:  [101.05260599]
mat_Sqrt:  [[0.15]]
grads:  [0.17501365]
Stock Position:  0.1750136456347971
Bond Position:  [-15.32938787]


portfolio before change:  [2.64517906]
curr_Stock_Price:  102.71475211090446
curr_Factors:  [102.71475211]
mat_Sqrt:  [[0.15]]
grads:  [0.15195478]
Stock Position:  0.15195477517193756
Bond Position:  [-12.962818]


portfolio before change:  [2.66844874]
curr_Stock_Price:  102.87855168441529
curr_Factors:  [102.87855168]
mat_Sqrt:  [[0.15]]
grads:  [0.03657812]
Stock Position:  0.03657812270062274
Bond Position:  [-1.09465555]


portfolio before change:  [2.66560165]
curr_Stock_Price:  102.80445698370613
curr_Factors:  [102.80445698]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552496]
Stock Position:  -0.06552496221067407
Bond Position:  [9.40185981]


portfolio before change:  [2.61913131]
curr_Stock_Price:  103.53159428716684
curr_Factors:  [103.53159429]
mat_Sqrt:  [[0.15]]
grads:  [-0.0168834]
Stock Position:  -0.016883397760041344
Bond Position:  [4.3670964]


portfolio before change:  [2.61670298]
curr_Stock_Price:  103.70775897520262
curr_Factors:  [103.70775898]
mat_Sqrt:  [[0.15]]
grads:  [0.1407046]
Stock Position:  0.14070460340124757
Bond Position:  [-11.97545612]


portfolio before change:  [2.75056883]
curr_Stock_Price:  104.66979485888535
curr_Factors:  [104.66979486]
mat_Sqrt:  [[0.15]]
grads:  [0.06130886]
Stock Position:  0.06130886128146408
Bond Position:  [-3.66661711]


portfolio before change:  [2.66177647]
curr_Stock_Price:  103.22899163120309
curr_Factors:  [103.22899163]
mat_Sqrt:  [[0.15]]
grads:  [0.03165325]
Stock Position:  0.03165324654074108
Bond Position:  [-0.60575626]


portfolio before change:  [2.64631018]
curr_Stock_Price:  102.74276783477883
curr_Factors:  [102.74276783]
mat_Sqrt:  [[0.15]]
grads:  [-0.03151892]
Stock Position:  -0.03151892417448577
Bond Position:  [5.88465169]


portfolio before change:  [2.63075851]
curr_Stock_Price:  103.25951454860318
curr_Factors:  [103.25951455]
mat_Sqrt:  [[0.15]]
grads:  [0.04691757]
Stock Position:  0.046917574394532265
Bond Position:  [-2.21392745]


portfolio before change:  [2.65830868]
curr_Stock_Price:  103.8526169871916
curr_Factors:  [103.85261699]
mat_Sqrt:  [[0.15]]
grads:  [0.02191004]
Stock Position:  0.021910037212822198
Bond Position:  [0.38289397]


portfolio before change:  [2.6579688]
curr_Stock_Price:  103.83492008282401
curr_Factors:  [103.83492008]
mat_Sqrt:  [[0.15]]
grads:  [0.06083732]
Stock Position:  0.060837321032761474
Bond Position:  [-3.65906957]


portfolio before change:  [2.60980725]
curr_Stock_Price:  103.05079378738492
curr_Factors:  [103.05079379]
mat_Sqrt:  [[0.15]]
grads:  [0.06658628]
Stock Position:  0.06658627603986773
Bond Position:  [-4.25196135]


portfolio before change:  [2.68017383]
curr_Stock_Price:  104.11554941175082
curr_Factors:  [104.11554941]
mat_Sqrt:  [[0.15]]
grads:  [0.07955903]
Stock Position:  0.07955903187127308
Bond Position:  [-5.60315848]


portfolio before change:  [2.71380156]
curr_Stock_Price:  104.54702990481984
curr_Factors:  [104.5470299]
mat_Sqrt:  [[0.15]]
grads:  [-0.11098659]
Stock Position:  -0.11098659435507882
Bond Position:  [14.31712036]


portfolio before change:  [2.77296811]
curr_Stock_Price:  104.03005938394128
curr_Factors:  [104.03005938]
mat_Sqrt:  [[0.15]]
grads:  [0.03754096]
Stock Position:  0.03754096208108648
Bond Position:  [-1.1324204]


portfolio before change:  [2.75374389]
curr_Stock_Price:  103.52174368920548
curr_Factors:  [103.52174369]
mat_Sqrt:  [[0.15]]
grads:  [0.20533721]
Stock Position:  0.20533721045473538
Bond Position:  [-18.50312218]


portfolio before change:  [2.63193001]
curr_Stock_Price:  102.93977003067612
curr_Factors:  [102.93977003]
mat_Sqrt:  [[0.15]]
grads:  [-0.27056446]
Stock Position:  -0.2705644645917443
Bond Position:  [30.48377377]


portfolio before change:  [2.89151775]
curr_Stock_Price:  101.9944240274536
curr_Factors:  [101.99442403]
mat_Sqrt:  [[0.15]]
grads:  [0.03136936]
Stock Position:  0.03136936120270543
Bond Position:  [-0.30798218]


portfolio before change:  [2.90975201]
curr_Stock_Price:  102.57692737585958
curr_Factors:  [102.57692738]
mat_Sqrt:  [[0.15]]
grads:  [-0.01311696]
Stock Position:  -0.013116961312841872
Bond Position:  [4.2552496]


portfolio before change:  [2.93162718]
curr_Stock_Price:  100.94978020287849
curr_Factors:  [100.9497802]
mat_Sqrt:  [[0.15]]
grads:  [-0.05023672]
Stock Position:  -0.05023671779101474
Bond Position:  [8.0030128]


portfolio before change:  [2.90089379]
curr_Stock_Price:  101.58146609204142
curr_Factors:  [101.58146609]
mat_Sqrt:  [[0.15]]
grads:  [-0.00531793]
Stock Position:  -0.005317930257331699
Bond Position:  [3.44109694]


portfolio before change:  [2.90101572]
curr_Stock_Price:  101.63942661539315
curr_Factors:  [101.63942662]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541546]
Stock Position:  -0.0754154571362142
Bond Position:  [10.56619954]


portfolio before change:  [2.96124814]
curr_Stock_Price:  100.85826639442271
curr_Factors:  [100.85826639]
mat_Sqrt:  [[0.15]]
grads:  [-0.12344862]
Stock Position:  -0.12344862103631969
Bond Position:  [15.41206204]


portfolio before change:  [2.98089158]
curr_Stock_Price:  100.71475071391966
curr_Factors:  [100.71475071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05747338]
Stock Position:  -0.05747338130906868
Bond Position:  [8.76930885]


portfolio before change:  [3.03317392]
curr_Stock_Price:  99.82414523980256
curr_Factors:  [99.82414524]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069772]
Stock Position:  -0.020697715497010553
Bond Position:  [5.09930568]


portfolio before change:  [3.03731992]
curr_Stock_Price:  99.65463149724023
curr_Factors:  [99.6546315]
mat_Sqrt:  [[0.15]]
grads:  [0.03659335]
Stock Position:  0.03659335043727218
Bond Position:  [-0.60937694]


portfolio before change:  [3.03766443]
curr_Stock_Price:  99.6661277100019
curr_Factors:  [99.66612771]
mat_Sqrt:  [[0.15]]
grads:  [0.03819451]
Stock Position:  0.03819451285018652
Bond Position:  [-0.76903477]


portfolio before change:  [3.05140725]
curr_Stock_Price:  100.0284561223766
curr_Factors:  [100.02845612]
mat_Sqrt:  [[0.15]]
grads:  [-0.07724946]
Stock Position:  -0.07724945773876858
Bond Position:  [10.77855124]


portfolio before change:  [3.01908189]
curr_Stock_Price:  100.46435250557805
curr_Factors:  [100.46435251]
mat_Sqrt:  [[0.15]]
grads:  [0.13485071]
Stock Position:  0.134850710850533
Bond Position:  [-10.52860746]


portfolio before change:  [2.94396366]
curr_Stock_Price:  99.91706529056707
curr_Factors:  [99.91706529]
mat_Sqrt:  [[0.15]]
grads:  [0.03752053]
Stock Position:  0.03752053391729602
Bond Position:  [-0.80497797]


portfolio before change:  [2.94037378]
curr_Stock_Price:  99.82406945716141
curr_Factors:  [99.82406946]
mat_Sqrt:  [[0.15]]
grads:  [0.01673397]
Stock Position:  0.016733969527820924
Bond Position:  [1.26992085]


portfolio before change:  [2.91528226]
curr_Stock_Price:  98.315146420683
curr_Factors:  [98.31514642]
mat_Sqrt:  [[0.15]]
grads:  [0.07241494]
Stock Position:  0.07241493968085987
Bond Position:  [-4.20420314]


portfolio before change:  [2.92801419]
curr_Stock_Price:  98.49822314225985
curr_Factors:  [98.49822314]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.92801419]
Stock Price:  97.97485998557381
PL:  [2.92801419]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.94974739e-03]
 [ 1.18079571e-03]
 [ 1.03958119e-02]
 [ 5.42002508e-03]
 [ 1.40318730e-02]
 [ 2.94581224e-02]
 [ 4.21537637e-02]
 [-1.27839945e-03]
 [-1.20156224e-02]
 [-2.06652890e-04]
 [ 3.07677180e-02]
 [ 1.16423948e-02]
 [-1.13409147e-02]
 [-5.12766074e-03]
 [-1.23291756e-02]
 [ 7.32599423e-03]
 [ 9.33489859e-03]
 [-4.25208346e-02]
 [ 1.31689909e-02]
 [-1.86158433e-02]
 [ 2.24761207e-02]
 [ 4.80576597e-02]
 [ 2.44717740e-02]
 [ 7.04567022e-03]
 [ 7.83287040e-03]
 [-2.11234504e-02]
 [ 1.20717592e-03]
 [-1.49556203e-02]
 [ 6.60309297e-02]
 [-3.01456049e-03]
 [-7.95593861e-03]
 [ 4.58180045e-03]
 [ 5.83091723e-03]
 [-1.75991615e-03]
 [ 7.79968479e-03]
 [ 3.77687901e-03]
 [-3.98807473e-02]
 [ 9.70443399e-03]
 [-6.37669945e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.18720425]
curr_Stock_Price:  99.73296888201794
curr_Factors:  [99.73296888]
mat_Sqrt:  [[0.15]]
grads:  [0.01966498]
Stock Position:  0.019664982571093823
Bond Position:  [-4.14845134]


portfolio before change:  [-2.18889406]
curr_Stock_Price:  99.67341018176745
curr_Factors:  [99.67341018]
mat_Sqrt:  [[0.15]]
grads:  [0.00787197]
Stock Position:  0.007871971402711373
Bond Position:  [-2.97352029]


portfolio before change:  [-2.18253907]
curr_Stock_Price:  100.52792246821723
curr_Factors:  [100.52792247]
mat_Sqrt:  [[0.15]]
grads:  [0.06930541]
Stock Position:  0.06930541241929523
Bond Position:  [-9.1496682]


portfolio before change:  [-2.10032784]
curr_Stock_Price:  101.73064255585359
curr_Factors:  [101.73064256]
mat_Sqrt:  [[0.15]]
grads:  [0.0361335]
Stock Position:  0.036133500558898385
Bond Position:  [-5.77621207]


portfolio before change:  [-2.10805834]
curr_Stock_Price:  101.5366832086672
curr_Factors:  [101.53668321]
mat_Sqrt:  [[0.15]]
grads:  [0.09354582]
Stock Position:  0.09354581974246193
Bond Position:  [-11.60639061]


portfolio before change:  [-2.01915179]
curr_Stock_Price:  102.5025996017951
curr_Factors:  [102.5025996]
mat_Sqrt:  [[0.15]]
grads:  [0.19638748]
Stock Position:  0.196387482488168
Bond Position:  [-22.14937928]


portfolio before change:  [-1.74453584]
curr_Stock_Price:  103.91503585044084
curr_Factors:  [103.91503585]
mat_Sqrt:  [[0.15]]
grads:  [0.28102509]
Stock Position:  0.2810250914693851
Bond Position:  [-30.94726829]


portfolio before change:  [-1.73498567]
curr_Stock_Price:  103.96278538206175
curr_Factors:  [103.96278538]
mat_Sqrt:  [[0.15]]
grads:  [-0.00852266]
Stock Position:  -0.008522663006783766
Bond Position:  [-0.84894589]


portfolio before change:  [-1.73682622]
curr_Stock_Price:  104.16629179128729
curr_Factors:  [104.16629179]
mat_Sqrt:  [[0.15]]
grads:  [-0.08010415]
Stock Position:  -0.08010414928260899
Bond Position:  [6.60732597]


portfolio before change:  [-1.84983603]
curr_Stock_Price:  105.58738901837687
curr_Factors:  [105.58738902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00137769]
Stock Position:  -0.0013776859363916958
Bond Position:  [-1.70436977]


portfolio before change:  [-1.85001353]
curr_Stock_Price:  105.56157387380117
curr_Factors:  [105.56157387]
mat_Sqrt:  [[0.15]]
grads:  [0.20511812]
Stock Position:  0.20511811991837678
Bond Position:  [-23.5026051]


portfolio before change:  [-1.51119781]
curr_Stock_Price:  107.2277052146105
curr_Factors:  [107.22770521]
mat_Sqrt:  [[0.15]]
grads:  [0.07761597]
Stock Position:  0.07761596544394156
Bond Position:  [-9.83377967]


portfolio before change:  [-1.41473767]
curr_Stock_Price:  108.4863307622472
curr_Factors:  [108.48633076]
mat_Sqrt:  [[0.15]]
grads:  [-0.0756061]
Stock Position:  -0.07560609820025307
Bond Position:  [6.78749051]


portfolio before change:  [-1.40421743]
curr_Stock_Price:  108.35840780500644
curr_Factors:  [108.35840781]
mat_Sqrt:  [[0.15]]
grads:  [-0.0341844]
Stock Position:  -0.03418440495815606
Bond Position:  [2.29995027]


portfolio before change:  [-1.39642467]
curr_Stock_Price:  108.13885618932166
curr_Factors:  [108.13885619]
mat_Sqrt:  [[0.15]]
grads:  [-0.0821945]
Stock Position:  -0.08219450390358138
Bond Position:  [7.49199497]


portfolio before change:  [-1.33285784]
curr_Stock_Price:  107.37687975478097
curr_Factors:  [107.37687975]
mat_Sqrt:  [[0.15]]
grads:  [0.04883996]
Stock Position:  0.048839961504324854
Bond Position:  [-6.57714051]


portfolio before change:  [-1.30106651]
curr_Stock_Price:  108.04464283645824
curr_Factors:  [108.04464284]
mat_Sqrt:  [[0.15]]
grads:  [0.06223266]
Stock Position:  0.06223265727919298
Bond Position:  [-8.02497174]


portfolio before change:  [-1.26759738]
curr_Stock_Price:  108.59856924372671
curr_Factors:  [108.59856924]
mat_Sqrt:  [[0.15]]
grads:  [-0.28347223]
Stock Position:  -0.2834722303821404
Bond Position:  [29.51708126]


portfolio before change:  [-1.39483098]
curr_Stock_Price:  109.06042564824091
curr_Factors:  [109.06042565]
mat_Sqrt:  [[0.15]]
grads:  [0.08779327]
Stock Position:  0.08779327236515509
Bond Position:  [-10.96960263]


portfolio before change:  [-1.4136082]
curr_Stock_Price:  108.86216520187504
curr_Factors:  [108.8621652]
mat_Sqrt:  [[0.15]]
grads:  [-0.12410562]
Stock Position:  -0.12410562207883297
Bond Position:  [12.09679853]


portfolio before change:  [-1.38398315]
curr_Stock_Price:  108.63564158307842
curr_Factors:  [108.63564158]
mat_Sqrt:  [[0.15]]
grads:  [0.1498408]
Stock Position:  0.14984080478956507
Bond Position:  [-17.66203512]


portfolio before change:  [-1.57000283]
curr_Stock_Price:  107.40892776741755
curr_Factors:  [107.40892777]
mat_Sqrt:  [[0.15]]
grads:  [0.3203844]
Stock Position:  0.3203843981353982
Bond Position:  [-35.98214751]


portfolio before change:  [-1.7413478]
curr_Stock_Price:  106.88815669670346
curr_Factors:  [106.8881567]
mat_Sqrt:  [[0.15]]
grads:  [0.16314516]
Stock Position:  0.1631451596980098
Bond Position:  [-19.1796332]


portfolio before change:  [-1.71565032]
curr_Stock_Price:  107.06036583706586
curr_Factors:  [107.06036584]
mat_Sqrt:  [[0.15]]
grads:  [0.04697113]
Stock Position:  0.04697113481263234
Bond Position:  [-6.7443972]


portfolio before change:  [-1.70766748]
curr_Stock_Price:  107.2482673164849
curr_Factors:  [107.24826732]
mat_Sqrt:  [[0.15]]
grads:  [0.05221914]
Stock Position:  0.05221913597226395
Bond Position:  [-7.30807933]


portfolio before change:  [-1.76845334]
curr_Stock_Price:  106.10170875912979
curr_Factors:  [106.10170876]
mat_Sqrt:  [[0.15]]
grads:  [-0.140823]
Stock Position:  -0.14082300240986428
Bond Position:  [13.17310785]


portfolio before change:  [-1.92783877]
curr_Stock_Price:  107.2452163356189
curr_Factors:  [107.24521634]
mat_Sqrt:  [[0.15]]
grads:  [0.00804784]
Stock Position:  0.008047839437184314
Bond Position:  [-2.79093105]


portfolio before change:  [-1.9244691]
curr_Stock_Price:  107.70727338115813
curr_Factors:  [107.70727338]
mat_Sqrt:  [[0.15]]
grads:  [-0.09970414]
Stock Position:  -0.09970413537365605
Bond Position:  [8.81439147]


portfolio before change:  [-1.79419746]
curr_Stock_Price:  106.41174262679323
curr_Factors:  [106.41174263]
mat_Sqrt:  [[0.15]]
grads:  [0.4402062]
Stock Position:  0.4402061981421147
Bond Position:  [-48.63730612]


portfolio before change:  [-2.20048806]
curr_Stock_Price:  105.50259923025867
curr_Factors:  [105.50259923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009707]
Stock Position:  -0.020097069915079598
Bond Position:  [-0.08019495]


portfolio before change:  [-2.1936366]
curr_Stock_Price:  105.16118196596089
curr_Factors:  [105.16118197]
mat_Sqrt:  [[0.15]]
grads:  [-0.05303959]
Stock Position:  -0.05303959073099051
Bond Position:  [3.38406946]


portfolio before change:  [-2.1759301]
curr_Stock_Price:  104.8353222961204
curr_Factors:  [104.8353223]
mat_Sqrt:  [[0.15]]
grads:  [0.03054534]
Stock Position:  0.03054533631059017
Bond Position:  [-5.37816027]


portfolio before change:  [-2.15828965]
curr_Stock_Price:  105.4348495913711
curr_Factors:  [105.43484959]
mat_Sqrt:  [[0.15]]
grads:  [0.03887278]
Stock Position:  0.03887278151534397
Bond Position:  [-6.25683552]


portfolio before change:  [-2.16337335]
curr_Stock_Price:  105.32419249344532
curr_Factors:  [105.32419249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01173277]
Stock Position:  -0.011732774322042266
Bond Position:  [-0.92762837]


portfolio before change:  [-2.1740709]
curr_Stock_Price:  106.22607551121442
curr_Factors:  [106.22607551]
mat_Sqrt:  [[0.15]]
grads:  [0.0519979]
Stock Position:  0.051997898579551075
Bond Position:  [-7.6976036]


portfolio before change:  [-2.15447703]
curr_Stock_Price:  106.62140168592092
curr_Factors:  [106.62140169]
mat_Sqrt:  [[0.15]]
grads:  [0.02517919]
Stock Position:  0.025179193397886008
Bond Position:  [-4.83911792]


portfolio before change:  [-2.16196205]
curr_Stock_Price:  106.34815647544077
curr_Factors:  [106.34815648]
mat_Sqrt:  [[0.15]]
grads:  [-0.26587165]
Stock Position:  -0.2658716488650218
Bond Position:  [26.11299766]


portfolio before change:  [-2.15921716]
curr_Stock_Price:  106.35011018935376
curr_Factors:  [106.35011019]
mat_Sqrt:  [[0.15]]
grads:  [0.06469623]
Stock Position:  0.06469622657394325
Bond Position:  [-9.03966799]


portfolio before change:  [-2.1293748]
curr_Stock_Price:  106.82884579342044
curr_Factors:  [106.82884579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.1293748]
Stock Price:  106.18736162226567
PL:  [-8.31673642]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.99592223e-03]
 [-2.58637342e-03]
 [ 1.49533353e-02]
 [-4.43422975e-04]
 [-8.83398685e-03]
 [-2.73682200e-02]
 [-4.41250566e-02]
 [ 1.47124506e-02]
 [-6.31069423e-03]
 [ 1.03125249e-03]
 [ 1.73268343e-03]
 [ 5.87171630e-03]
 [ 1.38184602e-02]
 [ 4.59686768e-03]
 [ 1.76906469e-02]
 [-7.35477947e-05]
 [ 9.48612621e-03]
 [ 1.32112086e-02]
 [ 1.16409637e-02]
 [-1.24636894e-02]
 [-3.76749933e-03]
 [ 1.11572130e-02]
 [ 1.68123373e-02]
 [ 5.02109709e-03]
 [ 1.32899089e-02]
 [-1.09623157e-02]
 [ 1.01898173e-02]
 [-1.11077133e-02]
 [-1.84892115e-02]
 [-9.44807413e-03]
 [-2.21775614e-03]
 [ 5.22000454e-03]
 [ 5.12860024e-03]
 [-5.51718922e-03]
 [ 1.43855608e-02]
 [ 5.47523699e-03]
 [ 1.41489003e-04]
 [ 7.83920307e-03]
 [-1.06667357e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.10577421]
curr_Stock_Price:  100.7840186438971
curr_Factors:  [100.78401864]
mat_Sqrt:  [[0.15]]
grads:  [0.03997281]
Stock Position:  0.03997281489692366
Bond Position:  [10.07715329]


portfolio before change:  [14.13891272]
curr_Stock_Price:  101.58153032876308
curr_Factors:  [101.58153033]
mat_Sqrt:  [[0.15]]
grads:  [-0.01724249]
Stock Position:  -0.017242489488606336
Bond Position:  [15.89043119]


portfolio before change:  [14.13905167]
curr_Stock_Price:  101.6886770961797
curr_Factors:  [101.6886771]
mat_Sqrt:  [[0.15]]
grads:  [0.0996889]
Stock Position:  0.09968890207971288
Bond Position:  [4.0018191]


portfolio before change:  [14.06979607]
curr_Stock_Price:  100.98894155537482
curr_Factors:  [100.98894156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00295615]
Stock Position:  -0.002956153165202943
Bond Position:  [14.36833484]


portfolio before change:  [14.07873313]
curr_Stock_Price:  98.57333310430205
curr_Factors:  [98.5733331]
mat_Sqrt:  [[0.15]]
grads:  [-0.05889325]
Stock Position:  -0.058893245641659576
Bond Position:  [19.88403665]


portfolio before change:  [14.11797755]
curr_Stock_Price:  97.94917395057455
curr_Factors:  [97.94917395]
mat_Sqrt:  [[0.15]]
grads:  [-0.1824548]
Stock Position:  -0.18245480002580483
Bond Position:  [31.98927449]


portfolio before change:  [14.24743342]
curr_Stock_Price:  97.26156823274644
curr_Factors:  [97.26156823]
mat_Sqrt:  [[0.15]]
grads:  [-0.29416704]
Stock Position:  -0.29416704404917987
Bond Position:  [42.85858145]


portfolio before change:  [14.34290831]
curr_Stock_Price:  96.95522109304628
curr_Factors:  [96.95522109]
mat_Sqrt:  [[0.15]]
grads:  [0.098083]
Stock Position:  0.09808300393161057
Bond Position:  [4.83324898]


portfolio before change:  [14.3697954]
curr_Stock_Price:  97.223186987923
curr_Factors:  [97.22318699]
mat_Sqrt:  [[0.15]]
grads:  [-0.04207129]
Stock Position:  -0.04207129486641148
Bond Position:  [18.46010077]


portfolio before change:  [14.32568697]
curr_Stock_Price:  98.32645922462544
curr_Factors:  [98.32645922]
mat_Sqrt:  [[0.15]]
grads:  [0.00687502]
Stock Position:  0.00687501662935112
Bond Position:  [13.64969093]


portfolio before change:  [14.33156722]
curr_Stock_Price:  98.93357470605025
curr_Factors:  [98.93357471]
mat_Sqrt:  [[0.15]]
grads:  [0.01155122]
Stock Position:  0.011551222890404778
Bond Position:  [13.18876344]


portfolio before change:  [14.33623609]
curr_Stock_Price:  99.19503374777315
curr_Factors:  [99.19503375]
mat_Sqrt:  [[0.15]]
grads:  [0.03914478]
Stock Position:  0.03914477536114015
Bond Position:  [10.45326877]


portfolio before change:  [14.33044035]
curr_Stock_Price:  99.0135925601827
curr_Factors:  [99.01359256]
mat_Sqrt:  [[0.15]]
grads:  [0.09212307]
Stock Position:  0.09212306804745447
Bond Position:  [5.20900443]


portfolio before change:  [14.35493461]
curr_Stock_Price:  99.27241036554689
curr_Factors:  [99.27241037]
mat_Sqrt:  [[0.15]]
grads:  [0.03064578]
Stock Position:  0.03064578452563705
Bond Position:  [11.31265371]


portfolio before change:  [14.37992137]
curr_Stock_Price:  100.04160560296663
curr_Factors:  [100.0416056]
mat_Sqrt:  [[0.15]]
grads:  [0.11793765]
Stock Position:  0.1179376460085299
Bond Position:  [2.5812499]


portfolio before change:  [14.41671317]
curr_Stock_Price:  100.35082937405511
curr_Factors:  [100.35082937]
mat_Sqrt:  [[0.15]]
grads:  [-0.00049032]
Stock Position:  -0.0004903186313893592
Bond Position:  [14.46591705]


portfolio before change:  [14.41842847]
curr_Stock_Price:  100.54060568129368
curr_Factors:  [100.54060568]
mat_Sqrt:  [[0.15]]
grads:  [0.06324084]
Stock Position:  0.06324084140591545
Bond Position:  [8.06015597]


portfolio before change:  [14.42822766]
curr_Stock_Price:  100.67962347118608
curr_Factors:  [100.67962347]
mat_Sqrt:  [[0.15]]
grads:  [0.08807472]
Stock Position:  0.08807472408855035
Bond Position:  [5.5608976]


portfolio before change:  [14.52046951]
curr_Stock_Price:  101.71904430281714
curr_Factors:  [101.7190443]
mat_Sqrt:  [[0.15]]
grads:  [0.07760642]
Stock Position:  0.07760642445277495
Bond Position:  [6.62641819]


portfolio before change:  [14.43203515]
curr_Stock_Price:  100.56884678309643
curr_Factors:  [100.56884678]
mat_Sqrt:  [[0.15]]
grads:  [-0.08309126]
Stock Position:  -0.08309126246188167
Bond Position:  [22.78842759]


portfolio before change:  [14.49613437]
curr_Stock_Price:  99.83169963878872
curr_Factors:  [99.83169964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511666]
Stock Position:  -0.02511666217324032
Bond Position:  [17.00357344]


portfolio before change:  [14.50427564]
curr_Stock_Price:  99.59218955744646
curr_Factors:  [99.59218956]
mat_Sqrt:  [[0.15]]
grads:  [0.07438142]
Stock Position:  0.07438141970120705
Bond Position:  [7.09646719]


portfolio before change:  [14.4573112]
curr_Stock_Price:  98.94886279952648
curr_Factors:  [98.9488628]
mat_Sqrt:  [[0.15]]
grads:  [0.11208225]
Stock Position:  0.11208224858301391
Bond Position:  [3.36690016]


portfolio before change:  [14.45529916]
curr_Stock_Price:  98.92715616351853
curr_Factors:  [98.92715616]
mat_Sqrt:  [[0.15]]
grads:  [0.03347398]
Stock Position:  0.03347398063097145
Bond Position:  [11.14381345]


portfolio before change:  [14.44436087]
curr_Stock_Price:  98.55876986585105
curr_Factors:  [98.55876987]
mat_Sqrt:  [[0.15]]
grads:  [0.08859939]
Stock Position:  0.08859939257293356
Bond Position:  [5.71211372]


portfolio before change:  [14.42887865]
curr_Stock_Price:  98.37596637438861
curr_Factors:  [98.37596637]
mat_Sqrt:  [[0.15]]
grads:  [-0.0730821]
Stock Position:  -0.07308210497992743
Bond Position:  [21.61840135]


portfolio before change:  [14.35739288]
curr_Stock_Price:  99.39110179915232
curr_Factors:  [99.3911018]
mat_Sqrt:  [[0.15]]
grads:  [0.06793212]
Stock Position:  0.06793211517613404
Bond Position:  [7.60554511]


portfolio before change:  [14.35832486]
curr_Stock_Price:  99.39082542784527
curr_Factors:  [99.39082543]
mat_Sqrt:  [[0.15]]
grads:  [-0.07405142]
Stock Position:  -0.07405142193083385
Bond Position:  [21.71835681]


portfolio before change:  [14.38313669]
curr_Stock_Price:  99.09242653066276
curr_Factors:  [99.09242653]
mat_Sqrt:  [[0.15]]
grads:  [-0.12326141]
Stock Position:  -0.1232614102852118
Bond Position:  [26.59740893]


portfolio before change:  [14.13606373]
curr_Stock_Price:  101.1238639968011
curr_Factors:  [101.123864]
mat_Sqrt:  [[0.15]]
grads:  [-0.06298716]
Stock Position:  -0.062987160897821
Bond Position:  [20.50556882]


portfolio before change:  [14.17675893]
curr_Stock_Price:  100.51847321396444
curr_Factors:  [100.51847321]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478504]
Stock Position:  -0.01478504092222371
Bond Position:  [15.66292867]


portfolio before change:  [14.17039176]
curr_Stock_Price:  101.08155296562349
curr_Factors:  [101.08155297]
mat_Sqrt:  [[0.15]]
grads:  [0.03480003]
Stock Position:  0.034800030256654235
Bond Position:  [10.65275066]


portfolio before change:  [14.18042329]
curr_Stock_Price:  101.33154864480287
curr_Factors:  [101.33154864]
mat_Sqrt:  [[0.15]]
grads:  [0.03419067]
Stock Position:  0.03419066826059837
Bond Position:  [10.71582993]


portfolio before change:  [14.20986504]
curr_Stock_Price:  102.15347416251686
curr_Factors:  [102.15347416]
mat_Sqrt:  [[0.15]]
grads:  [-0.03678126]
Stock Position:  -0.03678126144020544
Bond Position:  [17.96719868]


portfolio before change:  [14.19608113]
curr_Stock_Price:  102.5892925762626
curr_Factors:  [102.58929258]
mat_Sqrt:  [[0.15]]
grads:  [0.09590374]
Stock Position:  0.09590373839709057
Bond Position:  [4.35738445]


portfolio before change:  [14.11633179]
curr_Stock_Price:  101.7520567953229
curr_Factors:  [101.7520568]
mat_Sqrt:  [[0.15]]
grads:  [0.03650158]
Stock Position:  0.03650157994517563
Bond Position:  [10.40222096]


portfolio before change:  [14.11369839]
curr_Stock_Price:  101.64428724728761
curr_Factors:  [101.64428725]
mat_Sqrt:  [[0.15]]
grads:  [0.00094326]
Stock Position:  0.0009432600221691839
Bond Position:  [14.0178214]


portfolio before change:  [14.11506759]
curr_Stock_Price:  101.23809818780083
curr_Factors:  [101.23809819]
mat_Sqrt:  [[0.15]]
grads:  [0.05226135]
Stock Position:  0.05226135379210102
Bond Position:  [8.82422752]


portfolio before change:  [14.10092328]
curr_Stock_Price:  100.94634511067115
curr_Factors:  [100.94634511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.10092328]
Stock Price:  101.79037686840378
PL:  [12.31054641]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.09540881e-02]
 [ 4.78675747e-03]
 [ 7.43674669e-03]
 [-2.67784679e-03]
 [ 1.50751873e-02]
 [ 2.62140075e-02]
 [ 1.03679968e-02]
 [ 8.67781412e-03]
 [-8.93060858e-03]
 [-3.01446606e-03]
 [ 9.53786849e-03]
 [ 4.88231106e-03]
 [ 8.36867295e-03]
 [ 2.82841412e-03]
 [ 1.45809187e-02]
 [ 2.69099340e-03]
 [ 8.97795020e-03]
 [ 1.03906085e-02]
 [ 1.16657053e-02]
 [-1.26222308e-02]
 [-9.39791346e-03]
 [ 1.82388570e-02]
 [-2.56874832e-02]
 [ 5.92924438e-03]
 [-1.41731924e-03]
 [-1.07293558e-02]
 [ 1.52951353e-02]
 [-1.09436514e-02]
 [-1.86745748e-02]
 [-2.02225662e-03]
 [-3.48396106e-03]
 [ 5.63752341e-03]
 [ 6.66466209e-03]
 [-1.14453400e-02]
 [ 1.33045583e-02]
 [ 5.60977218e-03]
 [ 2.36195707e-03]
 [ 7.83809319e-03]
 [-6.81843126e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.22164175]
curr_Stock_Price:  101.69462435371044
curr_Factors:  [101.69462435]
mat_Sqrt:  [[0.15]]
grads:  [0.07302725]
Stock Position:  0.07302725403032985
Bond Position:  [20.79516259]


portfolio before change:  [28.11610341]
curr_Stock_Price:  100.21383609657376
curr_Factors:  [100.2138361]
mat_Sqrt:  [[0.15]]
grads:  [0.03191172]
Stock Position:  0.03191171644898769
Bond Position:  [24.91810789]


portfolio before change:  [28.11476943]
curr_Stock_Price:  100.07442223331009
curr_Factors:  [100.07442223]
mat_Sqrt:  [[0.15]]
grads:  [0.04957831]
Stock Position:  0.04957831125942276
Bond Position:  [23.15324858]


portfolio before change:  [28.14055352]
curr_Stock_Price:  100.53611096288978
curr_Factors:  [100.53611096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785231]
Stock Position:  -0.017852311930633222
Bond Position:  [29.93535553]


portfolio before change:  [28.13827922]
curr_Stock_Price:  100.87312342411589
curr_Factors:  [100.87312342]
mat_Sqrt:  [[0.15]]
grads:  [0.10050125]
Stock Position:  0.10050124839598525
Bond Position:  [18.00040439]


portfolio before change:  [28.15353683]
curr_Stock_Price:  101.00254883637999
curr_Factors:  [101.00254884]
mat_Sqrt:  [[0.15]]
grads:  [0.17476005]
Stock Position:  0.1747600501191885
Bond Position:  [10.50232633]


portfolio before change:  [28.34090444]
curr_Stock_Price:  102.06717855078715
curr_Factors:  [102.06717855]
mat_Sqrt:  [[0.15]]
grads:  [0.06911998]
Stock Position:  0.06911997868419092
Bond Position:  [21.28602324]


portfolio before change:  [28.36110407]
curr_Stock_Price:  102.32092157671987
curr_Factors:  [102.32092158]
mat_Sqrt:  [[0.15]]
grads:  [0.05785209]
Stock Position:  0.057852094119227
Bond Position:  [22.44162449]


portfolio before change:  [28.35701382]
curr_Stock_Price:  102.20172740410297
curr_Factors:  [102.2017274]
mat_Sqrt:  [[0.15]]
grads:  [-0.05953739]
Stock Position:  -0.059537390528441904
Bond Position:  [34.44183798]


portfolio before change:  [28.36626793]
curr_Stock_Price:  102.11860968362942
curr_Factors:  [102.11860968]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009644]
Stock Position:  -0.020096440431766272
Bond Position:  [30.41848849]


portfolio before change:  [28.38298702]
curr_Stock_Price:  101.47588189073798
curr_Factors:  [101.47588189]
mat_Sqrt:  [[0.15]]
grads:  [0.06358579]
Stock Position:  0.0635857899635066
Bond Position:  [21.93056291]


portfolio before change:  [28.3845529]
curr_Stock_Price:  101.45739326493506
curr_Factors:  [101.45739326]
mat_Sqrt:  [[0.15]]
grads:  [0.03254874]
Stock Position:  0.03254874042404869
Bond Position:  [25.08224254]


portfolio before change:  [28.40684246]
curr_Stock_Price:  102.0458671155709
curr_Factors:  [102.04586712]
mat_Sqrt:  [[0.15]]
grads:  [0.05579115]
Stock Position:  0.05579115302357983
Bond Position:  [22.71358587]


portfolio before change:  [28.31979969]
curr_Stock_Price:  100.43482055023541
curr_Factors:  [100.43482055]
mat_Sqrt:  [[0.15]]
grads:  [0.01885609]
Stock Position:  0.018856094114221338
Bond Position:  [26.42599126]


portfolio before change:  [28.35670453]
curr_Stock_Price:  102.21681147494158
curr_Factors:  [102.21681147]
mat_Sqrt:  [[0.15]]
grads:  [0.09720612]
Stock Position:  0.09720612454818359
Bond Position:  [18.42060442]


portfolio before change:  [28.45427495]
curr_Stock_Price:  103.19687013268552
curr_Factors:  [103.19687013]
mat_Sqrt:  [[0.15]]
grads:  [0.01793996]
Stock Position:  0.017939955982686093
Bond Position:  [26.60292765]


portfolio before change:  [28.45276981]
curr_Stock_Price:  102.9275984838906
curr_Factors:  [102.92759848]
mat_Sqrt:  [[0.15]]
grads:  [0.059853]
Stock Position:  0.05985300136550166
Bond Position:  [22.29224411]


portfolio before change:  [28.45075739]
curr_Stock_Price:  102.84741663814435
curr_Factors:  [102.84741664]
mat_Sqrt:  [[0.15]]
grads:  [0.06927072]
Stock Position:  0.06927072318259178
Bond Position:  [21.32644246]


portfolio before change:  [28.3482119]
curr_Stock_Price:  101.32857216523729
curr_Factors:  [101.32857217]
mat_Sqrt:  [[0.15]]
grads:  [0.07777137]
Stock Position:  0.07777136882015993
Bond Position:  [20.46775015]


portfolio before change:  [28.2629432]
curr_Stock_Price:  100.19927060209127
curr_Factors:  [100.1992706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08414821]
Stock Position:  -0.08414820534315316
Bond Position:  [36.694532]


portfolio before change:  [28.27208159]
curr_Stock_Price:  100.1451841404545
curr_Factors:  [100.14518414]
mat_Sqrt:  [[0.15]]
grads:  [-0.06265276]
Stock Position:  -0.06265275641488505
Bond Position:  [34.54645341]


portfolio before change:  [28.23695738]
curr_Stock_Price:  100.77472997464311
curr_Factors:  [100.77472997]
mat_Sqrt:  [[0.15]]
grads:  [0.12159238]
Stock Position:  0.12159237966735381
Bond Position:  [15.98351815]


portfolio before change:  [28.34094404]
curr_Stock_Price:  101.61350455328878
curr_Factors:  [101.61350455]
mat_Sqrt:  [[0.15]]
grads:  [-0.17124989]
Stock Position:  -0.1712498877286318
Bond Position:  [45.74224529]


portfolio before change:  [28.3728804]
curr_Stock_Price:  101.46040534930599
curr_Factors:  [101.46040535]
mat_Sqrt:  [[0.15]]
grads:  [0.0395283]
Stock Position:  0.03952829587616412
Bond Position:  [24.36232348]


portfolio before change:  [28.31883819]
curr_Stock_Price:  100.01618186238086
curr_Factors:  [100.01618186]
mat_Sqrt:  [[0.15]]
grads:  [-0.00944879]
Stock Position:  -0.009448794958568455
Bond Position:  [29.26387058]


portfolio before change:  [28.33249275]
curr_Stock_Price:  98.95823259070315
curr_Factors:  [98.95823259]
mat_Sqrt:  [[0.15]]
grads:  [-0.07152904]
Stock Position:  -0.07152903839848915
Bond Position:  [35.41087997]


portfolio before change:  [28.38701207]
curr_Stock_Price:  98.25792003165735
curr_Factors:  [98.25792003]
mat_Sqrt:  [[0.15]]
grads:  [0.10196757]
Stock Position:  0.10196756866632804
Bond Position:  [18.36789086]


portfolio before change:  [28.44518571]
curr_Stock_Price:  98.80591302342835
curr_Factors:  [98.80591302]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295768]
Stock Position:  -0.0729576760579844
Bond Position:  [35.65383551]


portfolio before change:  [28.44689809]
curr_Stock_Price:  98.84353253348702
curr_Factors:  [98.84353253]
mat_Sqrt:  [[0.15]]
grads:  [-0.12449717]
Stock Position:  -0.12449716527277971
Bond Position:  [40.75263769]


portfolio before change:  [28.51483702]
curr_Stock_Price:  98.33874567172317
curr_Factors:  [98.33874567]
mat_Sqrt:  [[0.15]]
grads:  [-0.01348171]
Stock Position:  -0.013481710773753144
Bond Position:  [29.84061155]


portfolio before change:  [28.50998305]
curr_Stock_Price:  98.97548055280956
curr_Factors:  [98.97548055]
mat_Sqrt:  [[0.15]]
grads:  [-0.02322641]
Stock Position:  -0.023226407082437527
Bond Position:  [30.80882786]


portfolio before change:  [28.52255584]
curr_Stock_Price:  98.59998351967204
curr_Factors:  [98.59998352]
mat_Sqrt:  [[0.15]]
grads:  [0.03758349]
Stock Position:  0.03758348936976404
Bond Position:  [24.81682441]


portfolio before change:  [28.5371277]
curr_Stock_Price:  98.9051590298073
curr_Factors:  [98.90515903]
mat_Sqrt:  [[0.15]]
grads:  [0.04443108]
Stock Position:  0.04443108059224462
Bond Position:  [24.14266461]


portfolio before change:  [28.59262748]
curr_Stock_Price:  100.08635363692773
curr_Factors:  [100.08635364]
mat_Sqrt:  [[0.15]]
grads:  [-0.07630227]
Stock Position:  -0.07630226661814196
Bond Position:  [36.22944312]


portfolio before change:  [28.65537083]
curr_Stock_Price:  99.32340925300772
curr_Factors:  [99.32340925]
mat_Sqrt:  [[0.15]]
grads:  [0.08869706]
Stock Position:  0.08869705526479085
Bond Position:  [19.84567691]


portfolio before change:  [28.71932993]
curr_Stock_Price:  100.01653525400476
curr_Factors:  [100.01653525]
mat_Sqrt:  [[0.15]]
grads:  [0.03739848]
Stock Position:  0.03739848122178458
Bond Position:  [24.97886341]


portfolio before change:  [28.75175097]
curr_Stock_Price:  100.79994932067342
curr_Factors:  [100.79994932]
mat_Sqrt:  [[0.15]]
grads:  [0.01574638]
Stock Position:  0.015746380472785766
Bond Position:  [27.16451662]


portfolio before change:  [28.75861746]
curr_Stock_Price:  101.0203621759596
curr_Factors:  [101.02036218]
mat_Sqrt:  [[0.15]]
grads:  [0.05225395]
Stock Position:  0.052253954591756836
Bond Position:  [23.47990404]


portfolio before change:  [28.71968594]
curr_Stock_Price:  100.2191465756621
curr_Factors:  [100.21914658]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.71968594]
Stock Price:  100.72640072227223
PL:  [27.99328522]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.56688479e-03]
 [-1.04502508e-03]
 [ 7.31974112e-03]
 [-2.67425489e-03]
 [ 1.47871836e-02]
 [ 2.29618720e-02]
 [-4.27714726e-03]
 [ 1.19271348e-02]
 [-5.98379664e-03]
 [ 8.50014359e-04]
 [ 9.45657029e-03]
 [ 4.59281351e-03]
 [ 9.43766546e-03]
 [-5.37037710e-03]
 [ 7.61569798e-03]
 [ 2.43130957e-03]
 [ 8.86039293e-03]
 [ 1.00204755e-03]
 [ 1.17895774e-02]
 [-1.50493919e-02]
 [-3.57197613e-03]
 [ 2.80144618e-02]
 [-4.27078894e-02]
 [ 7.63433428e-03]
 [ 5.18182346e-04]
 [-1.30079723e-02]
 [-5.17886390e-04]
 [-1.07084440e-02]
 [ 5.94233248e-02]
 [-6.06627591e-03]
 [-3.66934440e-03]
 [ 4.93497311e-03]
 [ 5.10222502e-03]
 [-4.40105287e-03]
 [ 1.12831408e-02]
 [ 5.28329329e-03]
 [-5.72850336e-03]
 [ 8.15384053e-03]
 [-1.42913516e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.31486424]
curr_Stock_Price:  99.78924298533956
curr_Factors:  [99.78924299]
mat_Sqrt:  [[0.15]]
grads:  [0.01711257]
Stock Position:  0.017112565254266552
Bond Position:  [-3.02251418]


portfolio before change:  [-1.31983405]
curr_Stock_Price:  99.52090393397364
curr_Factors:  [99.52090393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696683]
Stock Position:  -0.006966833894499261
Bond Position:  [-0.62648844]


portfolio before change:  [-1.32368276]
curr_Stock_Price:  100.06209574573802
curr_Factors:  [100.06209575]
mat_Sqrt:  [[0.15]]
grads:  [0.04879827]
Stock Position:  0.04879827414229949
Bond Position:  [-6.20654034]


portfolio before change:  [-1.29984991]
curr_Stock_Price:  100.56639049793272
curr_Factors:  [100.5663905]
mat_Sqrt:  [[0.15]]
grads:  [-0.01782837]
Stock Position:  -0.017828365905896128
Bond Position:  [0.49308449]


portfolio before change:  [-1.30992019]
curr_Stock_Price:  101.1346937850415
curr_Factors:  [101.13469379]
mat_Sqrt:  [[0.15]]
grads:  [0.09858122]
Stock Position:  0.09858122411047514
Bond Position:  [-11.27990211]


portfolio before change:  [-1.37936523]
curr_Stock_Price:  100.4445526404593
curr_Factors:  [100.44455264]
mat_Sqrt:  [[0.15]]
grads:  [0.15307915]
Stock Position:  0.15307914634542555
Bond Position:  [-16.7553316]


portfolio before change:  [-1.25962882]
curr_Stock_Price:  101.24042170553638
curr_Factors:  [101.24042171]
mat_Sqrt:  [[0.15]]
grads:  [-0.02851432]
Stock Position:  -0.028514315036787162
Bond Position:  [1.62717246]


portfolio before change:  [-1.26794354]
curr_Stock_Price:  101.53915330467589
curr_Factors:  [101.5391533]
mat_Sqrt:  [[0.15]]
grads:  [0.07951423]
Stock Position:  0.0795142322368237
Bond Position:  [-9.34175135]


portfolio before change:  [-1.35319149]
curr_Stock_Price:  100.48173045763102
curr_Factors:  [100.48173046]
mat_Sqrt:  [[0.15]]
grads:  [-0.03989198]
Stock Position:  -0.03989197759895763
Bond Position:  [2.65522345]


portfolio before change:  [-1.35146778]
curr_Stock_Price:  100.4468415183097
curr_Factors:  [100.44684152]
mat_Sqrt:  [[0.15]]
grads:  [0.00566676]
Stock Position:  0.005666762396656951
Bond Position:  [-1.92067617]


portfolio before change:  [-1.35199993]
curr_Stock_Price:  100.39530351301413
curr_Factors:  [100.39530351]
mat_Sqrt:  [[0.15]]
grads:  [0.0630438]
Stock Position:  0.06304380190474883
Bond Position:  [-7.68130156]


portfolio before change:  [-1.30245746]
curr_Stock_Price:  101.19637666594029
curr_Factors:  [101.19637667]
mat_Sqrt:  [[0.15]]
grads:  [0.03061876]
Stock Position:  0.030618756711013717
Bond Position:  [-4.4009647]


portfolio before change:  [-1.28739092]
curr_Stock_Price:  101.70641348816088
curr_Factors:  [101.70641349]
mat_Sqrt:  [[0.15]]
grads:  [0.06291777]
Stock Position:  0.06291776976594476
Bond Position:  [-7.68653163]


portfolio before change:  [-1.28050197]
curr_Stock_Price:  101.83117679973472
curr_Factors:  [101.8311768]
mat_Sqrt:  [[0.15]]
grads:  [-0.03580251]
Stock Position:  -0.03580251401114827
Bond Position:  [2.36531017]


portfolio before change:  [-1.32622518]
curr_Stock_Price:  103.11653037791011
curr_Factors:  [103.11653038]
mat_Sqrt:  [[0.15]]
grads:  [0.05077132]
Stock Position:  0.05077131987767448
Bond Position:  [-6.56158752]


portfolio before change:  [-1.35973394]
curr_Stock_Price:  102.47269213639207
curr_Factors:  [102.47269214]
mat_Sqrt:  [[0.15]]
grads:  [0.01620873]
Stock Position:  0.016208730493798906
Bond Position:  [-3.02068619]


portfolio before change:  [-1.35727688]
curr_Stock_Price:  102.64757777751304
curr_Factors:  [102.64757778]
mat_Sqrt:  [[0.15]]
grads:  [0.05906929]
Stock Position:  0.05906928617609991
Bond Position:  [-7.42059603]


portfolio before change:  [-1.27285136]
curr_Stock_Price:  104.09254438673325
curr_Factors:  [104.09254439]
mat_Sqrt:  [[0.15]]
grads:  [0.00668032]
Stock Position:  0.00668031702361444
Bond Position:  [-1.96822256]


portfolio before change:  [-1.27680238]
curr_Stock_Price:  103.53793370262355
curr_Factors:  [103.5379337]
mat_Sqrt:  [[0.15]]
grads:  [0.07859718]
Stock Position:  0.07859718238616349
Bond Position:  [-9.41459224]


portfolio before change:  [-1.32634648]
curr_Stock_Price:  102.92255283718715
curr_Factors:  [102.92255284]
mat_Sqrt:  [[0.15]]
grads:  [-0.10032928]
Stock Position:  -0.10032927960395013
Bond Position:  [8.9997991]


portfolio before change:  [-1.29575741]
curr_Stock_Price:  102.6288795641861
curr_Factors:  [102.62887956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02381317]
Stock Position:  -0.023813174222964858
Bond Position:  [1.14816198]


portfolio before change:  [-1.305422]
curr_Stock_Price:  103.04075737078207
curr_Factors:  [103.04075737]
mat_Sqrt:  [[0.15]]
grads:  [0.18676308]
Stock Position:  0.1867630788340588
Bond Position:  [-20.54963109]


portfolio before change:  [-1.29594997]
curr_Stock_Price:  103.1052288646462
curr_Factors:  [103.10522886]
mat_Sqrt:  [[0.15]]
grads:  [-0.28471926]
Stock Position:  -0.2847192627148874
Bond Position:  [28.06009478]


portfolio before change:  [-1.50482293]
curr_Stock_Price:  103.85115905059004
curr_Factors:  [103.85115905]
mat_Sqrt:  [[0.15]]
grads:  [0.05089556]
Stock Position:  0.05089556188872933
Bond Position:  [-6.79038602]


portfolio before change:  [-1.55323191]
curr_Stock_Price:  102.91669390870759
curr_Factors:  [102.91669391]
mat_Sqrt:  [[0.15]]
grads:  [0.00345455]
Stock Position:  0.0034545489711266045
Bond Position:  [-1.90876267]


portfolio before change:  [-1.5493161]
curr_Stock_Price:  104.11928769087099
curr_Factors:  [104.11928769]
mat_Sqrt:  [[0.15]]
grads:  [-0.08671982]
Stock Position:  -0.08671981520866827
Bond Position:  [7.47988929]


portfolio before change:  [-1.56433157]
curr_Stock_Price:  104.3032193437346
curr_Factors:  [104.30321934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345258]
Stock Position:  -0.0034525759323714663
Bond Position:  [-1.20421679]


portfolio before change:  [-1.56335707]
curr_Stock_Price:  103.97736491675718
curr_Factors:  [103.97736492]
mat_Sqrt:  [[0.15]]
grads:  [-0.07138963]
Stock Position:  -0.07138962688715692
Bond Position:  [5.85954821]


portfolio before change:  [-1.6440953]
curr_Stock_Price:  105.11857713143326
curr_Factors:  [105.11857713]
mat_Sqrt:  [[0.15]]
grads:  [0.3961555]
Stock Position:  0.3961554985639987
Bond Position:  [-43.28739763]


portfolio before change:  [-1.9683483]
curr_Stock_Price:  104.31373725794384
curr_Factors:  [104.31373726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044184]
Stock Position:  -0.040441839415514096
Bond Position:  [2.25029111]


portfolio before change:  [-1.93193339]
curr_Stock_Price:  103.42026621709276
curr_Factors:  [103.42026622]
mat_Sqrt:  [[0.15]]
grads:  [-0.0244623]
Stock Position:  -0.024462296010151423
Bond Position:  [0.59796378]


portfolio before change:  [-1.9232271]
curr_Stock_Price:  103.06741557508941
curr_Factors:  [103.06741558]
mat_Sqrt:  [[0.15]]
grads:  [0.03289982]
Stock Position:  0.03289982070926823
Bond Position:  [-5.31412659]


portfolio before change:  [-1.96891607]
curr_Stock_Price:  101.69887718334283
curr_Factors:  [101.69887718]
mat_Sqrt:  [[0.15]]
grads:  [0.03401483]
Stock Position:  0.03401483345883034
Bond Position:  [-5.42818645]


portfolio before change:  [-1.92451861]
curr_Stock_Price:  103.02406449219188
curr_Factors:  [103.02406449]
mat_Sqrt:  [[0.15]]
grads:  [-0.02934035]
Stock Position:  -0.029340352483038987
Bond Position:  [1.09824375]


portfolio before change:  [-1.92633264]
curr_Stock_Price:  103.0905705346006
curr_Factors:  [103.09057053]
mat_Sqrt:  [[0.15]]
grads:  [0.07522094]
Stock Position:  0.07522093881012948
Bond Position:  [-9.68090213]


portfolio before change:  [-1.93598872]
curr_Stock_Price:  102.97828937388786
curr_Factors:  [102.97828937]
mat_Sqrt:  [[0.15]]
grads:  [0.03522196]
Stock Position:  0.03522195528022632
Bond Position:  [-5.56308542]


portfolio before change:  [-1.93673457]
curr_Stock_Price:  102.97685797202453
curr_Factors:  [102.97685797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03819002]
Stock Position:  -0.03819002239626175
Bond Position:  [1.99595395]


portfolio before change:  [-1.88712943]
curr_Stock_Price:  101.68448821492684
curr_Factors:  [101.68448821]
mat_Sqrt:  [[0.15]]
grads:  [0.05435894]
Stock Position:  0.05435893688702573
Bond Position:  [-7.4145901]


portfolio before change:  [-1.88334986]
curr_Stock_Price:  101.77106906160859
curr_Factors:  [101.77106906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.88334986]
Stock Price:  101.92860822233104
PL:  [-3.81195809]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.51109895e-03]
 [ 3.44098405e-03]
 [ 1.30068305e-02]
 [ 9.00984010e-03]
 [ 1.40027439e-02]
 [ 2.50716553e-02]
 [-2.64881949e-04]
 [ 2.09892419e-02]
 [-7.10621821e-03]
 [ 1.08671453e-03]
 [ 4.95809324e-03]
 [ 5.03138480e-03]
 [ 1.19443680e-02]
 [ 3.49425176e-03]
 [ 1.74956264e-02]
 [ 2.43707402e-03]
 [ 9.74767808e-03]
 [ 1.30533836e-02]
 [ 1.18758005e-02]
 [-1.64197955e-02]
 [ 1.05026528e-02]
 [ 3.39060095e-02]
 [-2.03810970e-02]
 [ 7.86896784e-03]
 [ 7.33182877e-03]
 [-1.43259234e-02]
 [ 3.94251429e-04]
 [-1.39211921e-02]
 [ 6.21604167e-02]
 [-2.55028243e-03]
 [-1.35228706e-02]
 [ 4.10865724e-03]
 [ 6.71733574e-03]
 [ 2.60275230e-03]
 [ 8.18409631e-03]
 [ 2.91747057e-03]
 [-6.76605776e-02]
 [ 9.40607576e-03]
 [-4.15834654e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.72040775]
curr_Stock_Price:  99.98504646705318
curr_Factors:  [99.98504647]
mat_Sqrt:  [[0.15]]
grads:  [0.02340733]
Stock Position:  0.023407326346704768
Bond Position:  [-0.61997486]


portfolio before change:  [1.7359382]
curr_Stock_Price:  100.65184413081576
curr_Factors:  [100.65184413]
mat_Sqrt:  [[0.15]]
grads:  [0.02293989]
Stock Position:  0.022939893645998674
Bond Position:  [-0.5730044]


portfolio before change:  [1.78479218]
curr_Stock_Price:  102.78461809280472
curr_Factors:  [102.78461809]
mat_Sqrt:  [[0.15]]
grads:  [0.0867122]
Stock Position:  0.08671220326912649
Bond Position:  [-7.12788852]


portfolio before change:  [1.722899]
curr_Stock_Price:  102.08111695348633
curr_Factors:  [102.08111695]
mat_Sqrt:  [[0.15]]
grads:  [0.0600656]
Stock Position:  0.06006560066722115
Bond Position:  [-4.4086646]


portfolio before change:  [1.69047261]
curr_Stock_Price:  101.55044260570408
curr_Factors:  [101.55044261]
mat_Sqrt:  [[0.15]]
grads:  [0.09335163]
Stock Position:  0.09335162593290287
Bond Position:  [-7.78942632]


portfolio before change:  [1.59568089]
curr_Stock_Price:  100.5454469069489
curr_Factors:  [100.54544691]
mat_Sqrt:  [[0.15]]
grads:  [0.16714437]
Stock Position:  0.16714436880583047
Bond Position:  [-15.20992437]


portfolio before change:  [1.55021226]
curr_Stock_Price:  100.28479037808788
curr_Factors:  [100.28479038]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176588]
Stock Position:  -0.0017658796625335746
Bond Position:  [1.72730313]


portfolio before change:  [1.55064616]
curr_Stock_Price:  100.1613520675158
curr_Factors:  [100.16135207]
mat_Sqrt:  [[0.15]]
grads:  [0.13992828]
Stock Position:  0.13992827959380227
Bond Position:  [-12.46475951]


portfolio before change:  [1.68069897]
curr_Stock_Price:  101.10191242433619
curr_Factors:  [101.10191242]
mat_Sqrt:  [[0.15]]
grads:  [-0.04737479]
Stock Position:  -0.047374788069127975
Bond Position:  [6.47038064]


portfolio before change:  [1.71656515]
curr_Stock_Price:  100.36191246986868
curr_Factors:  [100.36191247]
mat_Sqrt:  [[0.15]]
grads:  [0.00724476]
Stock Position:  0.007244763545385911
Bond Position:  [0.98946683]


portfolio before change:  [1.71132265]
curr_Stock_Price:  99.62121277052881
curr_Factors:  [99.62121277]
mat_Sqrt:  [[0.15]]
grads:  [0.03305395]
Stock Position:  0.03305395494524316
Bond Position:  [-1.58155243]


portfolio before change:  [1.70898209]
curr_Stock_Price:  99.55638377645884
curr_Factors:  [99.55638378]
mat_Sqrt:  [[0.15]]
grads:  [0.03354257]
Stock Position:  0.03354256536297
Bond Position:  [-1.63039442]


portfolio before change:  [1.75750381]
curr_Stock_Price:  101.00903154456154
curr_Factors:  [101.00903154]
mat_Sqrt:  [[0.15]]
grads:  [0.07962912]
Stock Position:  0.07962911993633459
Bond Position:  [-6.28575648]


portfolio before change:  [1.70396064]
curr_Stock_Price:  100.34649242870726
curr_Factors:  [100.34649243]
mat_Sqrt:  [[0.15]]
grads:  [0.02329501]
Stock Position:  0.023295011753066305
Bond Position:  [-0.63361209]


portfolio before change:  [1.74099314]
curr_Stock_Price:  101.93961091635207
curr_Factors:  [101.93961092]
mat_Sqrt:  [[0.15]]
grads:  [0.11663751]
Stock Position:  0.11663750913176198
Bond Position:  [-10.14898916]


portfolio before change:  [1.80709195]
curr_Stock_Price:  102.51719103519
curr_Factors:  [102.51719104]
mat_Sqrt:  [[0.15]]
grads:  [0.01624716]
Stock Position:  0.016247160158037816
Bond Position:  [0.14147872]


portfolio before change:  [1.78470514]
curr_Stock_Price:  101.13821203642696
curr_Factors:  [101.13821204]
mat_Sqrt:  [[0.15]]
grads:  [0.06498452]
Stock Position:  0.06498452052397041
Bond Position:  [-4.78771308]


portfolio before change:  [1.81782302]
curr_Stock_Price:  101.65704914652864
curr_Factors:  [101.65704915]
mat_Sqrt:  [[0.15]]
grads:  [0.08702256]
Stock Position:  0.08702255746504008
Bond Position:  [-7.02863338]


portfolio before change:  [2.01066353]
curr_Stock_Price:  103.8831288227272
curr_Factors:  [103.88312882]
mat_Sqrt:  [[0.15]]
grads:  [0.079172]
Stock Position:  0.07917200357486637
Bond Position:  [-6.21397192]


portfolio before change:  [2.04162307]
curr_Stock_Price:  104.28398183961217
curr_Factors:  [104.28398184]
mat_Sqrt:  [[0.15]]
grads:  [-0.1094653]
Stock Position:  -0.10946530364303875
Bond Position:  [13.45710081]


portfolio before change:  [1.96117746]
curr_Stock_Price:  105.03424563420153
curr_Factors:  [105.03424563]
mat_Sqrt:  [[0.15]]
grads:  [0.07001769]
Stock Position:  0.0700176855356898
Bond Position:  [-5.39307732]


portfolio before change:  [1.89803424]
curr_Stock_Price:  104.14205612676335
curr_Factors:  [104.14205613]
mat_Sqrt:  [[0.15]]
grads:  [0.22604006]
Stock Position:  0.22604006310263963
Bond Position:  [-21.6422427]


portfolio before change:  [1.95119858]
curr_Stock_Price:  104.38922374589487
curr_Factors:  [104.38922375]
mat_Sqrt:  [[0.15]]
grads:  [-0.13587398]
Stock Position:  -0.1358739797514624
Bond Position:  [16.13497785]


portfolio before change:  [1.98478572]
curr_Stock_Price:  104.15687499900945
curr_Factors:  [104.156875]
mat_Sqrt:  [[0.15]]
grads:  [0.05245979]
Stock Position:  0.05245978562178883
Bond Position:  [-3.47926161]


portfolio before change:  [1.98795485]
curr_Stock_Price:  104.22557647102421
curr_Factors:  [104.22557647]
mat_Sqrt:  [[0.15]]
grads:  [0.04887886]
Stock Position:  0.04887885849155751
Bond Position:  [-3.10647235]


portfolio before change:  [1.99810753]
curr_Stock_Price:  104.44123226192875
curr_Factors:  [104.44123226]
mat_Sqrt:  [[0.15]]
grads:  [-0.09550616]
Stock Position:  -0.0955061561506788
Bond Position:  [11.97288816]


portfolio before change:  [1.82687012]
curr_Stock_Price:  106.24984979977795
curr_Factors:  [106.2498498]
mat_Sqrt:  [[0.15]]
grads:  [0.00262834]
Stock Position:  0.002628342858068763
Bond Position:  [1.54760909]


portfolio before change:  [1.8290834]
curr_Stock_Price:  107.01832225772021
curr_Factors:  [107.01832226]
mat_Sqrt:  [[0.15]]
grads:  [-0.09280795]
Stock Position:  -0.09280794761410602
Bond Position:  [11.76123424]


portfolio before change:  [1.95715041]
curr_Stock_Price:  105.65424972451125
curr_Factors:  [105.65424972]
mat_Sqrt:  [[0.15]]
grads:  [0.41440278]
Stock Position:  0.414402778246742
Bond Position:  [-41.82626421]


portfolio before change:  [2.57742893]
curr_Stock_Price:  107.16366800152124
curr_Factors:  [107.163668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01700188]
Stock Position:  -0.0170018828877592
Bond Position:  [4.39941306]


portfolio before change:  [2.57187329]
curr_Stock_Price:  107.52278131672145
curr_Factors:  [107.52278132]
mat_Sqrt:  [[0.15]]
grads:  [-0.09015247]
Stock Position:  -0.09015247041230134
Bond Position:  [12.26531765]


portfolio before change:  [2.60273787]
curr_Stock_Price:  107.19742893780513
curr_Factors:  [107.19742894]
mat_Sqrt:  [[0.15]]
grads:  [0.02739105]
Stock Position:  0.02739104828876313
Bond Position:  [-0.33351208]


portfolio before change:  [2.60798186]
curr_Stock_Price:  107.390400086426
curr_Factors:  [107.39040009]
mat_Sqrt:  [[0.15]]
grads:  [0.04478224]
Stock Position:  0.0447822382773433
Bond Position:  [-2.20120062]


portfolio before change:  [2.60511421]
curr_Stock_Price:  107.33250916034694
curr_Factors:  [107.33250916]
mat_Sqrt:  [[0.15]]
grads:  [0.01735168]
Stock Position:  0.017351682022066578
Bond Position:  [0.74271464]


portfolio before change:  [2.6121964]
curr_Stock_Price:  107.73531419393957
curr_Factors:  [107.73531419]
mat_Sqrt:  [[0.15]]
grads:  [0.05456064]
Stock Position:  0.054560642086984884
Bond Position:  [-3.26591152]


portfolio before change:  [2.64282627]
curr_Stock_Price:  108.30418826795702
curr_Factors:  [108.30418827]
mat_Sqrt:  [[0.15]]
grads:  [0.0194498]
Stock Position:  0.019449803813410407
Bond Position:  [0.53633106]


portfolio before change:  [2.65046837]
curr_Stock_Price:  108.69365506387595
curr_Factors:  [108.69365506]
mat_Sqrt:  [[0.15]]
grads:  [-0.45107052]
Stock Position:  -0.45107051702065787
Bond Position:  [51.67897155]


portfolio before change:  [3.07997494]
curr_Stock_Price:  107.75578331591213
curr_Factors:  [107.75578332]
mat_Sqrt:  [[0.15]]
grads:  [0.06270717]
Stock Position:  0.06270717172479721
Bond Position:  [-3.67708547]


portfolio before change:  [3.08279992]
curr_Stock_Price:  107.80816407446908
curr_Factors:  [107.80816407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.08279992]
Stock Price:  107.11348735648407
PL:  [-4.03068743]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.26562503e-03]
 [ 4.35955242e-03]
 [ 1.39653379e-03]
 [-1.78697524e-03]
 [ 1.51344138e-02]
 [ 2.64853779e-02]
 [-4.99882086e-03]
 [ 8.17933261e-03]
 [-9.45614522e-03]
 [-3.01309742e-03]
 [ 9.26939783e-03]
 [ 4.17120467e-03]
 [ 1.23605675e-02]
 [ 5.38303236e-03]
 [ 1.10338212e-02]
 [-2.05080859e-03]
 [ 1.16942885e-02]
 [ 5.90419838e-03]
 [ 1.15648505e-02]
 [-1.24665289e-02]
 [-1.46346714e-02]
 [ 2.12878160e-02]
 [-3.29490738e-02]
 [ 7.43437204e-03]
 [ 7.29932450e-03]
 [-1.54031649e-02]
 [-3.99068342e-04]
 [-1.09766280e-02]
 [ 5.99248375e-02]
 [-3.01032512e-03]
 [-9.06024034e-03]
 [ 4.39296435e-03]
 [ 6.05395207e-03]
 [-3.13588931e-03]
 [ 6.94146328e-03]
 [ 4.85248128e-03]
 [-2.29758280e-02]
 [ 9.96309544e-03]
 [-1.11616585e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.3939322]
curr_Stock_Price:  99.96398573490485
curr_Factors:  [99.96398573]
mat_Sqrt:  [[0.15]]
grads:  [0.02177083]
Stock Position:  0.02177083354764283
Bond Position:  [-0.7823671]


portfolio before change:  [1.39518399]
curr_Stock_Price:  100.02597673189187
curr_Factors:  [100.02597673]
mat_Sqrt:  [[0.15]]
grads:  [0.02906368]
Stock Position:  0.029063682796767187
Bond Position:  [-1.51193927]


portfolio before change:  [1.37730662]
curr_Stock_Price:  99.41736950981165
curr_Factors:  [99.41736951]
mat_Sqrt:  [[0.15]]
grads:  [0.00931023]
Stock Position:  0.009310225250530123
Bond Position:  [0.45170852]


portfolio before change:  [1.39007804]
curr_Stock_Price:  100.78306764819128
curr_Factors:  [100.78306765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01191317]
Stock Position:  -0.011913168278314148
Bond Position:  [2.59072369]


portfolio before change:  [1.38996987]
curr_Stock_Price:  100.81933278631423
curr_Factors:  [100.81933279]
mat_Sqrt:  [[0.15]]
grads:  [0.10089609]
Stock Position:  0.100896091796999
Bond Position:  [-8.78230678]


portfolio before change:  [1.44338829]
curr_Stock_Price:  101.35965376865377
curr_Factors:  [101.35965377]
mat_Sqrt:  [[0.15]]
grads:  [0.17656919]
Stock Position:  0.17656918618692172
Bond Position:  [-16.45360329]


portfolio before change:  [1.38413809]
curr_Stock_Price:  101.0357389764367
curr_Factors:  [101.03573898]
mat_Sqrt:  [[0.15]]
grads:  [-0.03332547]
Stock Position:  -0.033325472411953376
Bond Position:  [4.75120182]


portfolio before change:  [1.33569011]
curr_Stock_Price:  102.50734342603188
curr_Factors:  [102.50734343]
mat_Sqrt:  [[0.15]]
grads:  [0.05452888]
Stock Position:  0.054528884085818706
Bond Position:  [-4.25392093]


portfolio before change:  [1.33781648]
curr_Stock_Price:  102.55609079528075
curr_Factors:  [102.5560908]
mat_Sqrt:  [[0.15]]
grads:  [-0.06304097]
Stock Position:  -0.06304096810694033
Bond Position:  [7.80305173]


portfolio before change:  [1.37110777]
curr_Stock_Price:  102.04347413058669
curr_Factors:  [102.04347413]
mat_Sqrt:  [[0.15]]
grads:  [-0.02008732]
Stock Position:  -0.020087316135654842
Bond Position:  [3.4208873]


portfolio before change:  [1.38427507]
curr_Stock_Price:  101.4092598312233
curr_Factors:  [101.40925983]
mat_Sqrt:  [[0.15]]
grads:  [0.06179599]
Stock Position:  0.06179598551725121
Bond Position:  [-4.88241008]


portfolio before change:  [1.3465558]
curr_Stock_Price:  100.80875258355141
curr_Factors:  [100.80875258]
mat_Sqrt:  [[0.15]]
grads:  [0.02780803]
Stock Position:  0.027808031119556494
Bond Position:  [-1.45673713]


portfolio before change:  [1.34830453]
curr_Stock_Price:  100.8781871085736
curr_Factors:  [100.87818711]
mat_Sqrt:  [[0.15]]
grads:  [0.08240378]
Stock Position:  0.08240378342110853
Bond Position:  [-6.96443975]


portfolio before change:  [1.26113751]
curr_Stock_Price:  99.83094863866697
curr_Factors:  [99.83094864]
mat_Sqrt:  [[0.15]]
grads:  [0.03588688]
Stock Position:  0.035886882392216615
Bond Position:  [-2.321484]


portfolio before change:  [1.24033035]
curr_Stock_Price:  99.25923668645329
curr_Factors:  [99.25923669]
mat_Sqrt:  [[0.15]]
grads:  [0.07355881]
Stock Position:  0.0735588081127662
Bond Position:  [-6.0610608]


portfolio before change:  [1.27302668]
curr_Stock_Price:  99.71402939132369
curr_Factors:  [99.71402939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01367206]
Stock Position:  -0.01367205724942954
Bond Position:  [2.63632259]


portfolio before change:  [1.28155351]
curr_Stock_Price:  99.11446565521022
curr_Factors:  [99.11446566]
mat_Sqrt:  [[0.15]]
grads:  [0.07796192]
Stock Position:  0.07796192340764486
Bond Position:  [-6.44560087]


portfolio before change:  [1.3379899]
curr_Stock_Price:  99.84869772018281
curr_Factors:  [99.84869772]
mat_Sqrt:  [[0.15]]
grads:  [0.03936132]
Stock Position:  0.03936132250210836
Bond Position:  [-2.59218689]


portfolio before change:  [1.34656654]
curr_Stock_Price:  100.07482527513996
curr_Factors:  [100.07482528]
mat_Sqrt:  [[0.15]]
grads:  [0.077099]
Stock Position:  0.077099003490278
Bond Position:  [-6.36910277]


portfolio before change:  [1.32417624]
curr_Stock_Price:  99.79474246204506
curr_Factors:  [99.79474246]
mat_Sqrt:  [[0.15]]
grads:  [-0.08311019]
Stock Position:  -0.08311019248800093
Bond Position:  [9.6181365]


portfolio before change:  [1.27137602]
curr_Stock_Price:  100.44451313070849
curr_Factors:  [100.44451313]
mat_Sqrt:  [[0.15]]
grads:  [-0.09756448]
Stock Position:  -0.09756447614748086
Bond Position:  [11.07119233]


portfolio before change:  [1.170748]
curr_Stock_Price:  101.49009863503474
curr_Factors:  [101.49009864]
mat_Sqrt:  [[0.15]]
grads:  [0.14191877]
Stock Position:  0.1419187735124033
Bond Position:  [-13.23260232]


portfolio before change:  [1.27836888]
curr_Stock_Price:  102.26008168880892
curr_Factors:  [102.26008169]
mat_Sqrt:  [[0.15]]
grads:  [-0.21966049]
Stock Position:  -0.21966049173805172
Bond Position:  [23.7408687]


portfolio before change:  [0.95968443]
curr_Stock_Price:  103.72439709465986
curr_Factors:  [103.72439709]
mat_Sqrt:  [[0.15]]
grads:  [0.04956248]
Stock Position:  0.049562480237334505
Bond Position:  [-4.18115395]


portfolio before change:  [0.97546925]
curr_Stock_Price:  104.05342619055233
curr_Factors:  [104.05342619]
mat_Sqrt:  [[0.15]]
grads:  [0.04866216]
Stock Position:  0.04866216336359336
Bond Position:  [-4.08799558]


portfolio before change:  [1.0066349]
curr_Stock_Price:  104.70437710463233
curr_Factors:  [104.7043771]
mat_Sqrt:  [[0.15]]
grads:  [-0.10268777]
Stock Position:  -0.10268776600832924
Bond Position:  [11.75849347]


portfolio before change:  [1.00597729]
curr_Stock_Price:  104.72509536123768
curr_Factors:  [104.72509536]
mat_Sqrt:  [[0.15]]
grads:  [-0.00266046]
Stock Position:  -0.0026604556119250913
Bond Position:  [1.28459376]


portfolio before change:  [1.00617116]
curr_Stock_Price:  104.71258365634303
curr_Factors:  [104.71258366]
mat_Sqrt:  [[0.15]]
grads:  [-0.07317752]
Stock Position:  -0.07317752021561275
Bond Position:  [8.66877837]


portfolio before change:  [0.97036283]
curr_Stock_Price:  105.21672750786699
curr_Factors:  [105.21672751]
mat_Sqrt:  [[0.15]]
grads:  [0.39949892]
Stock Position:  0.39949891652656466
Bond Position:  [-41.06360581]


portfolio before change:  [1.11481329]
curr_Stock_Price:  105.59115590093828
curr_Factors:  [105.5911559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02006883]
Stock Position:  -0.020068834101570104
Bond Position:  [3.23390468]


portfolio before change:  [1.11434239]
curr_Stock_Price:  105.63476442585338
curr_Factors:  [105.63476443]
mat_Sqrt:  [[0.15]]
grads:  [-0.0604016]
Stock Position:  -0.06040160227500812
Bond Position:  [7.49485141]


portfolio before change:  [1.10662388]
curr_Stock_Price:  105.77806226011337
curr_Factors:  [105.77806226]
mat_Sqrt:  [[0.15]]
grads:  [0.02928643]
Stock Position:  0.02928642897607635
Bond Position:  [-1.99123783]


portfolio before change:  [1.11415827]
curr_Stock_Price:  106.04382722715508
curr_Factors:  [106.04382723]
mat_Sqrt:  [[0.15]]
grads:  [0.04035968]
Stock Position:  0.04035968046440609
Bond Position:  [-3.16573671]


portfolio before change:  [1.05711965]
curr_Stock_Price:  104.64037512014039
curr_Factors:  [104.64037512]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090593]
Stock Position:  -0.02090592875826809
Bond Position:  [3.24472388]


portfolio before change:  [1.06237745]
curr_Stock_Price:  104.40827874028281
curr_Factors:  [104.40827874]
mat_Sqrt:  [[0.15]]
grads:  [0.04627642]
Stock Position:  0.046276421872828453
Bond Position:  [-3.7692641]


portfolio before change:  [1.04421493]
curr_Stock_Price:  104.02598176275681
curr_Factors:  [104.02598176]
mat_Sqrt:  [[0.15]]
grads:  [0.03234988]
Stock Position:  0.0323498751673947
Bond Position:  [-2.32101259]


portfolio before change:  [1.07060968]
curr_Stock_Price:  104.85086564518166
curr_Factors:  [104.85086565]
mat_Sqrt:  [[0.15]]
grads:  [-0.15317219]
Stock Position:  -0.15317218672290564
Bond Position:  [17.13084605]


portfolio before change:  [1.16561524]
curr_Stock_Price:  104.24459323916312
curr_Factors:  [104.24459324]
mat_Sqrt:  [[0.15]]
grads:  [0.06642064]
Stock Position:  0.06642063628826944
Bond Position:  [-5.75837698]


portfolio before change:  [1.21032353]
curr_Stock_Price:  104.92853943023951
curr_Factors:  [104.92853943]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.21032353]
Stock Price:  104.14998177598694
PL:  [-2.93965824]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.97345307e-03]
 [-9.83390616e-03]
 [ 5.57370925e-03]
 [-1.99637369e-03]
 [-1.08149060e-02]
 [-2.60346130e-02]
 [-3.90780185e-02]
 [ 1.87414055e-02]
 [-6.31785474e-03]
 [ 4.80883033e-03]
 [-9.45905182e-03]
 [ 7.59085270e-03]
 [ 1.38752772e-02]
 [-1.25451368e-03]
 [-4.49199440e-03]
 [-8.98681609e-03]
 [ 2.04625409e-02]
 [-3.38417899e-02]
 [ 1.83872651e-03]
 [ 4.96250540e-03]
 [ 2.51095581e-02]
 [ 7.34058860e-04]
 [ 2.71003899e-02]
 [ 4.36940891e-04]
 [ 9.55061039e-03]
 [ 1.67486650e-02]
 [ 3.40315419e-02]
 [-2.45389993e-02]
 [-4.73279349e-02]
 [ 2.58344789e-03]
 [-4.44871704e-03]
 [ 5.59195530e-03]
 [ 1.91279041e-02]
 [-1.50403705e-02]
 [ 5.23807745e-03]
 [ 4.36620352e-03]
 [ 8.69675412e-03]
 [ 8.87224466e-03]
 [-7.13820741e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00534915]
curr_Stock_Price:  99.93891848756509
curr_Factors:  [99.93891849]
mat_Sqrt:  [[0.15]]
grads:  [0.01982302]
Stock Position:  0.01982302045762753
Bond Position:  [-0.97574208]


portfolio before change:  [0.98432711]
curr_Stock_Price:  98.88458542969823
curr_Factors:  [98.88458543]
mat_Sqrt:  [[0.15]]
grads:  [-0.06555937]
Stock Position:  -0.06555937440801987
Bond Position:  [7.46713867]


portfolio before change:  [0.93400289]
curr_Stock_Price:  99.66643658546425
curr_Factors:  [99.66643659]
mat_Sqrt:  [[0.15]]
grads:  [0.03715806]
Stock Position:  0.03715806165836807
Bond Position:  [-2.76940871]


portfolio before change:  [0.91592522]
curr_Stock_Price:  99.18924623945836
curr_Factors:  [99.18924624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01330916]
Stock Position:  -0.013309157937336849
Bond Position:  [2.23605056]


portfolio before change:  [0.92532973]
curr_Stock_Price:  98.50362905420278
curr_Factors:  [98.50362905]
mat_Sqrt:  [[0.15]]
grads:  [-0.07209937]
Stock Position:  -0.07209937339039545
Bond Position:  [8.02737966]


portfolio before change:  [0.95044978]
curr_Stock_Price:  98.16913841084933
curr_Factors:  [98.16913841]
mat_Sqrt:  [[0.15]]
grads:  [-0.17356409]
Stock Position:  -0.1735640866071755
Bond Position:  [17.98908662]


portfolio before change:  [1.19506097]
curr_Stock_Price:  96.77275269932117
curr_Factors:  [96.7727527]
mat_Sqrt:  [[0.15]]
grads:  [-0.26052012]
Stock Position:  -0.2605201230782727
Bond Position:  [26.40631041]


portfolio before change:  [0.97672971]
curr_Stock_Price:  97.62348259449858
curr_Factors:  [97.62348259]
mat_Sqrt:  [[0.15]]
grads:  [0.1249427]
Stock Position:  0.12494270339054861
Bond Position:  [-11.22061212]


portfolio before change:  [0.92299291]
curr_Stock_Price:  97.20461755438706
curr_Factors:  [97.20461755]
mat_Sqrt:  [[0.15]]
grads:  [-0.04211903]
Stock Position:  -0.04211903160444238
Bond Position:  [5.01715727]


portfolio before change:  [0.94676118]
curr_Stock_Price:  96.65519649363293
curr_Factors:  [96.65519649]
mat_Sqrt:  [[0.15]]
grads:  [0.03205887]
Stock Position:  0.032058868833693674
Bond Position:  [-2.15189509]


portfolio before change:  [0.95076863]
curr_Stock_Price:  96.78859019316258
curr_Factors:  [96.78859019]
mat_Sqrt:  [[0.15]]
grads:  [-0.06306035]
Stock Position:  -0.06306034545564455
Bond Position:  [7.05429056]


portfolio before change:  [0.96860125]
curr_Stock_Price:  96.51978767112877
curr_Factors:  [96.51978767]
mat_Sqrt:  [[0.15]]
grads:  [0.05060568]
Stock Position:  0.050605684661958056
Bond Position:  [-3.91584869]


portfolio before change:  [0.91694568]
curr_Stock_Price:  95.5087144003023
curr_Factors:  [95.5087144]
mat_Sqrt:  [[0.15]]
grads:  [0.09250185]
Stock Position:  0.09250184803805264
Bond Position:  [-7.91778691]


portfolio before change:  [0.91566515]
curr_Stock_Price:  95.5055713188798
curr_Factors:  [95.50557132]
mat_Sqrt:  [[0.15]]
grads:  [-0.00836342]
Stock Position:  -0.008363424542348216
Bond Position:  [1.71441879]


portfolio before change:  [0.91123388]
curr_Stock_Price:  96.06103680958002
curr_Factors:  [96.06103681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994663]
Stock Position:  -0.029946629306967124
Bond Position:  [3.78793814]


portfolio before change:  [0.92716558]
curr_Stock_Price:  95.5448459294129
curr_Factors:  [95.54484593]
mat_Sqrt:  [[0.15]]
grads:  [-0.05991211]
Stock Position:  -0.05991210728060535
Bond Position:  [6.65145863]


portfolio before change:  [0.91756275]
curr_Stock_Price:  95.71900627285456
curr_Factors:  [95.71900627]
mat_Sqrt:  [[0.15]]
grads:  [0.13641694]
Stock Position:  0.1364169392914959
Bond Position:  [-12.14013112]


portfolio before change:  [0.80319083]
curr_Stock_Price:  94.89173139875167
curr_Factors:  [94.8917314]
mat_Sqrt:  [[0.15]]
grads:  [-0.22561193]
Stock Position:  -0.2256119328510457
Bond Position:  [22.21189776]


portfolio before change:  [0.7402603]
curr_Stock_Price:  95.18297125924798
curr_Factors:  [95.18297126]
mat_Sqrt:  [[0.15]]
grads:  [0.01225818]
Stock Position:  0.012258176760678563
Bond Position:  [-0.42650938]


portfolio before change:  [0.73960635]
curr_Stock_Price:  95.13397221368669
curr_Factors:  [95.13397221]
mat_Sqrt:  [[0.15]]
grads:  [0.03308337]
Stock Position:  0.03308336931299239
Bond Position:  [-2.40774599]


portfolio before change:  [0.74128511]
curr_Stock_Price:  95.19381362887863
curr_Factors:  [95.19381363]
mat_Sqrt:  [[0.15]]
grads:  [0.16739705]
Stock Position:  0.16739705379211375
Bond Position:  [-15.19387883]


portfolio before change:  [0.57265791]
curr_Stock_Price:  94.19781134001366
curr_Factors:  [94.19781134]
mat_Sqrt:  [[0.15]]
grads:  [0.00489373]
Stock Position:  0.004893725732132577
Bond Position:  [0.11167966]


portfolio before change:  [0.57729173]
curr_Stock_Price:  95.14184845677491
curr_Factors:  [95.14184846]
mat_Sqrt:  [[0.15]]
grads:  [0.18066927]
Stock Position:  0.18066926598945887
Bond Position:  [-16.61191619]


portfolio before change:  [0.42698502]
curr_Stock_Price:  94.32139851360898
curr_Factors:  [94.32139851]
mat_Sqrt:  [[0.15]]
grads:  [0.00291294]
Stock Position:  0.002912939275874187
Bond Position:  [0.15223252]


portfolio before change:  [0.4253243]
curr_Stock_Price:  93.7447476026952
curr_Factors:  [93.7447476]
mat_Sqrt:  [[0.15]]
grads:  [0.06367074]
Stock Position:  0.06367073596072521
Bond Position:  [-5.54347277]


portfolio before change:  [0.42069192]
curr_Stock_Price:  93.68287612433981
curr_Factors:  [93.68287612]
mat_Sqrt:  [[0.15]]
grads:  [0.11165777]
Stock Position:  0.11165776637414987
Bond Position:  [-10.03972877]


portfolio before change:  [0.37576583]
curr_Stock_Price:  93.29176091185032
curr_Factors:  [93.29176091]
mat_Sqrt:  [[0.15]]
grads:  [0.22687695]
Stock Position:  0.2268769463261014
Bond Position:  [-20.789984]


portfolio before change:  [0.63576224]
curr_Stock_Price:  94.44919592439419
curr_Factors:  [94.44919592]
mat_Sqrt:  [[0.15]]
grads:  [-0.16359333]
Stock Position:  -0.16359332877336258
Bond Position:  [16.0870206]


portfolio before change:  [0.77376957]
curr_Stock_Price:  93.61788864337706
curr_Factors:  [93.61788864]
mat_Sqrt:  [[0.15]]
grads:  [-0.31551957]
Stock Position:  -0.3155195659896363
Bond Position:  [30.31204516]


portfolio before change:  [0.84715363]
curr_Stock_Price:  93.39731652279637
curr_Factors:  [93.39731652]
mat_Sqrt:  [[0.15]]
grads:  [0.01722299]
Stock Position:  0.01722298594434541
Bond Position:  [-0.76142704]


portfolio before change:  [0.85487101]
curr_Stock_Price:  93.85092932403069
curr_Factors:  [93.85092932]
mat_Sqrt:  [[0.15]]
grads:  [-0.02965811]
Stock Position:  -0.029658113633133025
Bond Position:  [3.63831254]


portfolio before change:  [0.91488687]
curr_Stock_Price:  91.84267491474705
curr_Factors:  [91.84267491]
mat_Sqrt:  [[0.15]]
grads:  [0.0372797]
Stock Position:  0.037279701983262
Bond Position:  [-2.50898068]


portfolio before change:  [0.9661574]
curr_Stock_Price:  93.22638154904934
curr_Factors:  [93.22638155]
mat_Sqrt:  [[0.15]]
grads:  [0.12751936]
Stock Position:  0.12751936046166953
Bond Position:  [-10.92201116]


portfolio before change:  [0.93194965]
curr_Stock_Price:  92.96883312829257
curr_Factors:  [92.96883313]
mat_Sqrt:  [[0.15]]
grads:  [-0.10026914]
Stock Position:  -0.10026913681386546
Bond Position:  [10.2538543]


portfolio before change:  [1.00178257]
curr_Stock_Price:  92.28516209976445
curr_Factors:  [92.2851621]
mat_Sqrt:  [[0.15]]
grads:  [0.03492052]
Stock Position:  0.03492051636316608
Bond Position:  [-2.22086295]


portfolio before change:  [1.01960432]
curr_Stock_Price:  92.80346431244604
curr_Factors:  [92.80346431]
mat_Sqrt:  [[0.15]]
grads:  [0.02910802]
Stock Position:  0.029108023449317805
Bond Position:  [-1.68172109]


portfolio before change:  [1.01384522]
curr_Stock_Price:  92.61283406804756
curr_Factors:  [92.61283407]
mat_Sqrt:  [[0.15]]
grads:  [0.05797836]
Stock Position:  0.05797836082381244
Bond Position:  [-4.35569509]


portfolio before change:  [1.06352356]
curr_Stock_Price:  93.47906817347987
curr_Factors:  [93.47906817]
mat_Sqrt:  [[0.15]]
grads:  [0.0591483]
Stock Position:  0.059148297719021775
Bond Position:  [-4.46560419]


portfolio before change:  [1.03885494]
curr_Stock_Price:  93.07144211107433
curr_Factors:  [93.07144211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.03885494]
Stock Price:  93.24976398471135
PL:  [1.03885494]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.71505405e-03]
 [ 4.67720145e-03]
 [ 1.34717743e-02]
 [ 3.14829752e-03]
 [ 1.38554084e-02]
 [ 2.49707685e-02]
 [ 6.72513517e-04]
 [ 9.96530926e-03]
 [-7.99533395e-03]
 [-2.47780625e-03]
 [ 8.04262260e-03]
 [ 4.38605583e-03]
 [ 1.19023735e-02]
 [-5.34203539e-03]
 [ 2.45296637e-02]
 [ 1.30317325e-03]
 [ 9.30540488e-03]
 [ 1.31769967e-02]
 [ 1.16635090e-02]
 [-1.40693966e-02]
 [-1.38022667e-02]
 [ 1.74089164e-02]
 [-4.71968929e-03]
 [ 5.36332355e-03]
 [ 1.70183190e-03]
 [-9.48062988e-03]
 [ 3.51503272e-03]
 [-1.12951982e-02]
 [-1.79631635e-02]
 [-4.01977331e-03]
 [-3.46801909e-03]
 [ 5.63141274e-03]
 [ 1.06352078e-02]
 [-1.28318112e-02]
 [ 2.99183511e-03]
 [ 5.58199442e-03]
 [ 4.27294880e-03]
 [ 1.14909031e-02]
 [-2.52416495e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.78233548]
curr_Stock_Price:  100.63413507666444
curr_Factors:  [100.63413508]
mat_Sqrt:  [[0.15]]
grads:  [0.03810036]
Stock Position:  0.03810036033141675
Bond Position:  [7.94813867]


portfolio before change:  [11.76991479]
curr_Stock_Price:  100.28205792951158
curr_Factors:  [100.28205793]
mat_Sqrt:  [[0.15]]
grads:  [0.03118134]
Stock Position:  0.0311813430272685
Bond Position:  [8.64298554]


portfolio before change:  [11.79037149]
curr_Stock_Price:  100.90346352235142
curr_Factors:  [100.90346352]
mat_Sqrt:  [[0.15]]
grads:  [0.08981183]
Stock Position:  0.0898118286933145
Bond Position:  [2.72804691]


portfolio before change:  [11.84324407]
curr_Stock_Price:  101.48837036089176
curr_Factors:  [101.48837036]
mat_Sqrt:  [[0.15]]
grads:  [0.02098865]
Stock Position:  0.02098865016648312
Bond Position:  [9.71314017]


portfolio before change:  [11.8482611]
curr_Stock_Price:  101.66955457253042
curr_Factors:  [101.66955457]
mat_Sqrt:  [[0.15]]
grads:  [0.09236939]
Stock Position:  0.09236938901077922
Bond Position:  [2.45710646]


portfolio before change:  [11.74430596]
curr_Stock_Price:  100.54080081221494
curr_Factors:  [100.54080081]
mat_Sqrt:  [[0.15]]
grads:  [0.16647179]
Stock Position:  0.16647178997285955
Bond Position:  [-4.99290111]


portfolio before change:  [11.90239434]
curr_Stock_Price:  101.49419075761452
curr_Factors:  [101.49419076]
mat_Sqrt:  [[0.15]]
grads:  [0.00448342]
Stock Position:  0.004483423449597758
Bond Position:  [11.44735291]


portfolio before change:  [11.90553829]
curr_Stock_Price:  101.87625234803501
curr_Factors:  [101.87625235]
mat_Sqrt:  [[0.15]]
grads:  [0.0664354]
Stock Position:  0.06643539506685825
Bond Position:  [5.13734922]


portfolio before change:  [11.88590641]
curr_Stock_Price:  101.57108233339027
curr_Factors:  [101.57108233]
mat_Sqrt:  [[0.15]]
grads:  [-0.05330223]
Stock Position:  -0.053302226330481164
Bond Position:  [17.29987123]


portfolio before change:  [11.88420152]
curr_Stock_Price:  101.64364042429074
curr_Factors:  [101.64364042]
mat_Sqrt:  [[0.15]]
grads:  [-0.01651871]
Stock Position:  -0.016518708346690995
Bond Position:  [13.56322318]


portfolio before change:  [11.91001964]
curr_Stock_Price:  100.18331999214604
curr_Factors:  [100.18331999]
mat_Sqrt:  [[0.15]]
grads:  [0.05361748]
Stock Position:  0.053617483998678744
Bond Position:  [6.53844208]


portfolio before change:  [11.95515935]
curr_Stock_Price:  101.00995994838752
curr_Factors:  [101.00995995]
mat_Sqrt:  [[0.15]]
grads:  [0.02924037]
Stock Position:  0.029240372232402653
Bond Position:  [9.00159052]


portfolio before change:  [11.95664351]
curr_Stock_Price:  101.02223373136312
curr_Factors:  [101.02223373]
mat_Sqrt:  [[0.15]]
grads:  [0.07934916]
Stock Position:  0.07934915674675837
Bond Position:  [3.94061445]


portfolio before change:  [12.01606529]
curr_Stock_Price:  101.76489034691203
curr_Factors:  [101.76489035]
mat_Sqrt:  [[0.15]]
grads:  [-0.03561357]
Stock Position:  -0.03561356929576565
Bond Position:  [15.64027627]


portfolio before change:  [12.04064072]
curr_Stock_Price:  101.12973173644356
curr_Factors:  [101.12973174]
mat_Sqrt:  [[0.15]]
grads:  [0.16353109]
Stock Position:  0.163531091242959
Bond Position:  [-4.49721467]


portfolio before change:  [12.02096134]
curr_Stock_Price:  101.01282923782516
curr_Factors:  [101.01282924]
mat_Sqrt:  [[0.15]]
grads:  [0.00868782]
Stock Position:  0.008687821639703478
Bond Position:  [11.14337989]


portfolio before change:  [12.02544955]
curr_Stock_Price:  101.36909850400038
curr_Factors:  [101.3690985]
mat_Sqrt:  [[0.15]]
grads:  [0.06203603]
Stock Position:  0.06203603250835188
Bond Position:  [5.73691286]


portfolio before change:  [11.98249232]
curr_Stock_Price:  100.6650821180801
curr_Factors:  [100.66508212]
mat_Sqrt:  [[0.15]]
grads:  [0.08784664]
Stock Position:  0.08784664461069581
Bond Position:  [3.13940263]


portfolio before change:  [12.05371845]
curr_Stock_Price:  101.47141540688027
curr_Factors:  [101.47141541]
mat_Sqrt:  [[0.15]]
grads:  [0.07775673]
Stock Position:  0.07775672692928319
Bond Position:  [4.16363331]


portfolio before change:  [12.10093023]
curr_Stock_Price:  102.07189460622087
curr_Factors:  [102.07189461]
mat_Sqrt:  [[0.15]]
grads:  [-0.09379598]
Stock Position:  -0.09379597708755671
Bond Position:  [21.67486332]


portfolio before change:  [12.16742565]
curr_Stock_Price:  101.39184532803147
curr_Factors:  [101.39184533]
mat_Sqrt:  [[0.15]]
grads:  [-0.09201511]
Stock Position:  -0.09201511119373616
Bond Position:  [21.49700757]


portfolio before change:  [12.2477454]
curr_Stock_Price:  100.54815280936091
curr_Factors:  [100.54815281]
mat_Sqrt:  [[0.15]]
grads:  [0.11605944]
Stock Position:  0.11605944285300221
Bond Position:  [0.57818281]


portfolio before change:  [12.24508909]
curr_Stock_Price:  100.52464254322848
curr_Factors:  [100.52464254]
mat_Sqrt:  [[0.15]]
grads:  [-0.0314646]
Stock Position:  -0.031464595285528286
Bond Position:  [15.40805628]


portfolio before change:  [12.26884399]
curr_Stock_Price:  99.83088584810054
curr_Factors:  [99.83088585]
mat_Sqrt:  [[0.15]]
grads:  [0.03575549]
Stock Position:  0.03575549036445947
Bond Position:  [8.69934171]


portfolio before change:  [12.26484728]
curr_Stock_Price:  99.68869247343572
curr_Factors:  [99.68869247]
mat_Sqrt:  [[0.15]]
grads:  [0.01134555]
Stock Position:  0.011345546019174401
Bond Position:  [11.13382463]


portfolio before change:  [12.26969146]
curr_Stock_Price:  99.99298495867879
curr_Factors:  [99.99298496]
mat_Sqrt:  [[0.15]]
grads:  [-0.0632042]
Stock Position:  -0.06320419918738045
Bond Position:  [18.589668]


portfolio before change:  [12.24713943]
curr_Stock_Price:  100.38656453534206
curr_Factors:  [100.38656454]
mat_Sqrt:  [[0.15]]
grads:  [0.02343355]
Stock Position:  0.023433551460835107
Bond Position:  [9.89472571]


portfolio before change:  [12.25256111]
curr_Stock_Price:  100.5651442755285
curr_Factors:  [100.56514428]
mat_Sqrt:  [[0.15]]
grads:  [-0.07530132]
Stock Position:  -0.07530132135375574
Bond Position:  [19.82524936]


portfolio before change:  [12.32642878]
curr_Stock_Price:  99.6170950705963
curr_Factors:  [99.61709507]
mat_Sqrt:  [[0.15]]
grads:  [-0.11975442]
Stock Position:  -0.11975442310509048
Bond Position:  [24.25601653]


portfolio before change:  [12.38944998]
curr_Stock_Price:  99.11616150978769
curr_Factors:  [99.11616151]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679849]
Stock Position:  -0.026798488705138367
Bond Position:  [15.04561331]


portfolio before change:  [12.39361586]
curr_Stock_Price:  99.03089319069343
curr_Factors:  [99.03089319]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312013]
Stock Position:  -0.02312012727748169
Bond Position:  [14.68322272]


portfolio before change:  [12.41147051]
curr_Stock_Price:  98.33802807353774
curr_Factors:  [98.33802807]
mat_Sqrt:  [[0.15]]
grads:  [0.03754275]
Stock Position:  0.037542751573150755
Bond Position:  [8.71959035]


portfolio before change:  [12.35549181]
curr_Stock_Price:  96.81792852523503
curr_Factors:  [96.81792853]
mat_Sqrt:  [[0.15]]
grads:  [0.07090139]
Stock Position:  0.07090138544238267
Bond Position:  [5.49096654]


portfolio before change:  [12.27416819]
curr_Stock_Price:  95.6612511173908
curr_Factors:  [95.66125112]
mat_Sqrt:  [[0.15]]
grads:  [-0.08554541]
Stock Position:  -0.08554540784060854
Bond Position:  [20.45754893]


portfolio before change:  [12.25744423]
curr_Stock_Price:  95.8866438886331
curr_Factors:  [95.88664389]
mat_Sqrt:  [[0.15]]
grads:  [0.01994557]
Stock Position:  0.019945567369221116
Bond Position:  [10.34493071]


portfolio before change:  [12.25533792]
curr_Stock_Price:  95.71620494016868
curr_Factors:  [95.71620494]
mat_Sqrt:  [[0.15]]
grads:  [0.0372133]
Stock Position:  0.03721329615399903
Bond Position:  [8.69342244]


portfolio before change:  [12.23007192]
curr_Stock_Price:  95.00805092664841
curr_Factors:  [95.00805093]
mat_Sqrt:  [[0.15]]
grads:  [0.02848633]
Stock Position:  0.02848632530720303
Bond Position:  [9.52364168]


portfolio before change:  [12.2759131]
curr_Stock_Price:  96.57549239977442
curr_Factors:  [96.5754924]
mat_Sqrt:  [[0.15]]
grads:  [0.07660602]
Stock Position:  0.07660602099111269
Bond Position:  [4.8776489]


portfolio before change:  [12.3367349]
curr_Stock_Price:  97.36148879754454
curr_Factors:  [97.3614888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.3367349]
Stock Price:  97.46485129278062
PL:  [12.3367349]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.42464244e-03]
 [ 4.27547266e-03]
 [-2.01300847e-02]
 [ 4.88353934e-03]
 [-2.30618940e-02]
 [-3.08825791e-02]
 [-4.34977227e-02]
 [ 1.54132843e-02]
 [-6.49915033e-03]
 [-9.29906452e-04]
 [-5.76873114e-03]
 [ 7.31408915e-03]
 [ 1.39045656e-02]
 [ 1.57459323e-03]
 [ 1.27433844e-03]
 [-3.39582924e-03]
 [ 1.48452694e-02]
 [ 8.48544843e-04]
 [ 1.07881562e-02]
 [-1.01126509e-02]
 [-6.76061866e-03]
 [ 1.30728858e-02]
 [ 1.49335522e-02]
 [ 5.06429893e-03]
 [ 1.42490707e-02]
 [-1.11714531e-02]
 [ 1.73316324e-02]
 [-1.84595863e-02]
 [-4.85126312e-02]
 [ 3.35896533e-04]
 [-4.11094970e-03]
 [ 5.59115063e-03]
 [ 1.24432117e-02]
 [-1.28519107e-02]
 [ 3.04766812e-03]
 [ 5.62023757e-03]
 [ 3.59878993e-03]
 [ 1.16629354e-02]
 [-2.46327870e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.12884479]
curr_Stock_Price:  99.22065866071567
curr_Factors:  [99.22065866]
mat_Sqrt:  [[0.15]]
grads:  [0.04283095]
Stock Position:  0.04283094958405222
Bond Position:  [-14.37855982]


portfolio before change:  [-10.09758839]
curr_Stock_Price:  99.99238646328129
curr_Factors:  [99.99238646]
mat_Sqrt:  [[0.15]]
grads:  [0.02850315]
Stock Position:  0.028503151091073542
Bond Position:  [-12.94768649]


portfolio before change:  [-10.15560581]
curr_Stock_Price:  98.0136980241137
curr_Factors:  [98.01369802]
mat_Sqrt:  [[0.15]]
grads:  [-0.13420056]
Stock Position:  -0.13420056492725074
Bond Position:  [2.99788784]


portfolio before change:  [-10.12746773]
curr_Stock_Price:  97.80681871636196
curr_Factors:  [97.80681872]
mat_Sqrt:  [[0.15]]
grads:  [0.03255693]
Stock Position:  0.03255692892316219
Bond Position:  [-13.31175737]


portfolio before change:  [-10.11961628]
curr_Stock_Price:  98.09909210617352
curr_Factors:  [98.09909211]
mat_Sqrt:  [[0.15]]
grads:  [-0.15374596]
Stock Position:  -0.15374595979404782
Bond Position:  [4.96272279]


portfolio before change:  [-9.98539089]
curr_Stock_Price:  97.23009359506928
curr_Factors:  [97.2300936]
mat_Sqrt:  [[0.15]]
grads:  [-0.20588386]
Stock Position:  -0.2058838605080889
Bond Position:  [10.03271614]


portfolio before change:  [-9.97810764]
curr_Stock_Price:  97.20080971003219
curr_Factors:  [97.20080971]
mat_Sqrt:  [[0.15]]
grads:  [-0.28998482]
Stock Position:  -0.28998481768303097
Bond Position:  [18.20865144]


portfolio before change:  [-9.93832332]
curr_Stock_Price:  97.07146468941262
curr_Factors:  [97.07146469]
mat_Sqrt:  [[0.15]]
grads:  [0.10275523]
Stock Position:  0.10275522888492669
Bond Position:  [-19.9129239]


portfolio before change:  [-10.00695396]
curr_Stock_Price:  96.42778584217228
curr_Factors:  [96.42778584]
mat_Sqrt:  [[0.15]]
grads:  [-0.04332767]
Stock Position:  -0.043327668885080495
Bond Position:  [-5.82896279]


portfolio before change:  [-10.06890275]
curr_Stock_Price:  97.84074261455254
curr_Factors:  [97.84074261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00619938]
Stock Position:  -0.0061993763464613496
Bond Position:  [-9.46235117]


portfolio before change:  [-10.0686403]
curr_Stock_Price:  97.60760291837907
curr_Factors:  [97.60760292]
mat_Sqrt:  [[0.15]]
grads:  [-0.03845821]
Stock Position:  -0.03845820758662723
Bond Position:  [-6.31482684]


portfolio before change:  [-10.07528446]
curr_Stock_Price:  97.7598399102436
curr_Factors:  [97.75983991]
mat_Sqrt:  [[0.15]]
grads:  [0.04876059]
Stock Position:  0.04876059434294777
Bond Position:  [-14.84211236]


portfolio before change:  [-10.09009403]
curr_Stock_Price:  97.49417067976178
curr_Factors:  [97.49417068]
mat_Sqrt:  [[0.15]]
grads:  [0.0926971]
Stock Position:  0.0926971039682992
Bond Position:  [-19.12752131]


portfolio before change:  [-10.12346604]
curr_Stock_Price:  97.15995403916274
curr_Factors:  [97.15995404]
mat_Sqrt:  [[0.15]]
grads:  [0.01049729]
Stock Position:  0.010497288168443565
Bond Position:  [-11.14338207]


portfolio before change:  [-10.1196351]
curr_Stock_Price:  97.6576017034341
curr_Factors:  [97.6576017]
mat_Sqrt:  [[0.15]]
grads:  [0.00849559]
Stock Position:  0.008495589567775158
Bond Position:  [-10.949294]


portfolio before change:  [-10.11991489]
curr_Stock_Price:  97.78577983955128
curr_Factors:  [97.78577984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02263886]
Stock Position:  -0.022638861578497066
Bond Position:  [-7.90615616]


portfolio before change:  [-10.12321755]
curr_Stock_Price:  97.88800768240164
curr_Factors:  [97.88800768]
mat_Sqrt:  [[0.15]]
grads:  [0.09896846]
Stock Position:  0.09896846258661499
Bond Position:  [-19.81104317]


portfolio before change:  [-9.97681293]
curr_Stock_Price:  99.39233688059316
curr_Factors:  [99.39233688]
mat_Sqrt:  [[0.15]]
grads:  [0.00565697]
Stock Position:  0.0056569656205255475
Bond Position:  [-10.53907197]


portfolio before change:  [-9.97856255]
curr_Stock_Price:  99.31594397336839
curr_Factors:  [99.31594397]
mat_Sqrt:  [[0.15]]
grads:  [0.07192104]
Stock Position:  0.07192104138501317
Bond Position:  [-17.12146867]


portfolio before change:  [-10.00761974]
curr_Stock_Price:  98.94168819394334
curr_Factors:  [98.94168819]
mat_Sqrt:  [[0.15]]
grads:  [-0.06741767]
Stock Position:  -0.06741767242311755
Bond Position:  [-3.33720141]


portfolio before change:  [-10.07927442]
curr_Stock_Price:  99.9983475087389
curr_Factors:  [99.99834751]
mat_Sqrt:  [[0.15]]
grads:  [-0.04507079]
Stock Position:  -0.04507079106439896
Bond Position:  [-5.5722698]


portfolio before change:  [-10.07189852]
curr_Stock_Price:  99.81924082787158
curr_Factors:  [99.81924083]
mat_Sqrt:  [[0.15]]
grads:  [0.08715257]
Stock Position:  0.08715257182453069
Bond Position:  [-18.77140208]


portfolio before change:  [-10.11908057]
curr_Stock_Price:  99.30479266838641
curr_Factors:  [99.30479267]
mat_Sqrt:  [[0.15]]
grads:  [0.09955701]
Stock Position:  0.09955701491277744
Bond Position:  [-20.0055693]


portfolio before change:  [-10.14604934]
curr_Stock_Price:  99.05902476533623
curr_Factors:  [99.05902477]
mat_Sqrt:  [[0.15]]
grads:  [0.03376199]
Stock Position:  0.03376199289636991
Bond Position:  [-13.49047944]


portfolio before change:  [-10.1706631]
curr_Stock_Price:  98.37993751752543
curr_Factors:  [98.37993752]
mat_Sqrt:  [[0.15]]
grads:  [0.0949938]
Stock Position:  0.09499380445993251
Bond Position:  [-19.51614765]


portfolio before change:  [-10.21530475]
curr_Stock_Price:  97.93567720292117
curr_Factors:  [97.9356772]
mat_Sqrt:  [[0.15]]
grads:  [-0.07447635]
Stock Position:  -0.07447635406564695
Bond Position:  [-2.92141258]


portfolio before change:  [-10.18670538]
curr_Stock_Price:  97.54676758695692
curr_Factors:  [97.54676759]
mat_Sqrt:  [[0.15]]
grads:  [0.11554422]
Stock Position:  0.1155442158204049
Bond Position:  [-21.45767014]


portfolio before change:  [-10.25264902]
curr_Stock_Price:  96.99926060159555
curr_Factors:  [96.9992606]
mat_Sqrt:  [[0.15]]
grads:  [-0.12306391]
Stock Position:  -0.12306390894466299
Bond Position:  [1.68445916]


portfolio before change:  [-10.21538712]
curr_Stock_Price:  96.69818673676701
curr_Factors:  [96.69818674]
mat_Sqrt:  [[0.15]]
grads:  [-0.32341754]
Stock Position:  -0.32341754123559924
Bond Position:  [21.05850268]


portfolio before change:  [-10.11805961]
curr_Stock_Price:  96.40539176955889
curr_Factors:  [96.40539177]
mat_Sqrt:  [[0.15]]
grads:  [0.00223931]
Stock Position:  0.00223931022203992
Bond Position:  [-10.33394119]


portfolio before change:  [-10.11959901]
curr_Stock_Price:  96.29483347453025
curr_Factors:  [96.29483347]
mat_Sqrt:  [[0.15]]
grads:  [-0.02740633]
Stock Position:  -0.027406331345729576
Bond Position:  [-7.4805109]


portfolio before change:  [-10.12922789]
curr_Stock_Price:  96.61205065645848
curr_Factors:  [96.61205066]
mat_Sqrt:  [[0.15]]
grads:  [0.03727434]
Stock Position:  0.03727433754315551
Bond Position:  [-13.73037808]


portfolio before change:  [-10.15009849]
curr_Stock_Price:  96.09817986007755
curr_Factors:  [96.09817986]
mat_Sqrt:  [[0.15]]
grads:  [0.08295474]
Stock Position:  0.08295474444703764
Bond Position:  [-18.12189844]


portfolio before change:  [-10.07911388]
curr_Stock_Price:  96.98119129425052
curr_Factors:  [96.98119129]
mat_Sqrt:  [[0.15]]
grads:  [-0.0856794]
Stock Position:  -0.08567940488281357
Bond Position:  [-1.76982313]


portfolio before change:  [-10.08551775]
curr_Stock_Price:  97.05335125551417
curr_Factors:  [97.05335126]
mat_Sqrt:  [[0.15]]
grads:  [0.02031779]
Stock Position:  0.020317787460594795
Bond Position:  [-12.05742711]


portfolio before change:  [-10.09546399]
curr_Stock_Price:  96.63800255579429
curr_Factors:  [96.63800256]
mat_Sqrt:  [[0.15]]
grads:  [0.03746825]
Stock Position:  0.03746825044613443
Bond Position:  [-13.71632087]


portfolio before change:  [-10.0678415]
curr_Stock_Price:  97.42098907188047
curr_Factors:  [97.42098907]
mat_Sqrt:  [[0.15]]
grads:  [0.02399193]
Stock Position:  0.023991932881687852
Bond Position:  [-12.40515933]


portfolio before change:  [-10.06914161]
curr_Stock_Price:  97.43143542055353
curr_Factors:  [97.43143542]
mat_Sqrt:  [[0.15]]
grads:  [0.0777529]
Stock Position:  0.07775290278031903
Bond Position:  [-17.64471854]


portfolio before change:  [-10.06800048]
curr_Stock_Price:  97.47448023070412
curr_Factors:  [97.47448023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.06800048]
Stock Price:  97.22337431243919
PL:  [-10.06800048]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.51498909e-03]
 [-1.11502693e-02]
 [-6.27025584e-03]
 [-2.47222437e-03]
 [ 1.55762385e-02]
 [-6.71645286e-03]
 [-9.22512230e-03]
 [ 2.36349970e-02]
 [-5.86461887e-03]
 [ 4.76193407e-03]
 [ 7.79801373e-03]
 [ 4.06719918e-03]
 [ 1.15575434e-02]
 [ 4.85789639e-03]
 [ 9.52972278e-03]
 [-2.10018603e-03]
 [ 9.67869431e-03]
 [ 1.33282875e-02]
 [ 1.14463172e-02]
 [-1.34972548e-02]
 [-1.06810397e-02]
 [ 2.78396265e-02]
 [-3.62001876e-02]
 [ 6.67414069e-03]
 [ 5.20382642e-03]
 [-7.17503647e-03]
 [-3.81789193e-04]
 [-1.12113410e-02]
 [ 2.87033224e-05]
 [-9.82437900e-03]
 [-1.37249058e-03]
 [ 5.21866765e-03]
 [ 5.10994862e-03]
 [-1.21484144e-02]
 [ 1.64786700e-02]
 [ 5.56630713e-03]
 [ 2.30719665e-03]
 [ 9.84986422e-03]
 [-3.09164760e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.54002745]
curr_Stock_Price:  99.065114788686
curr_Factors:  [99.06511479]
mat_Sqrt:  [[0.15]]
grads:  [0.05009993]
Stock Position:  0.0500999272961812
Bond Position:  [-17.5031825]


portfolio before change:  [-12.5590786]
curr_Stock_Price:  98.72852520601671
curr_Factors:  [98.72852521]
mat_Sqrt:  [[0.15]]
grads:  [-0.07433513]
Stock Position:  -0.0743351288917075
Bond Position:  [-5.22008095]


portfolio before change:  [-12.58284605]
curr_Stock_Price:  99.03948052387544
curr_Factors:  [99.03948052]
mat_Sqrt:  [[0.15]]
grads:  [-0.04180171]
Stock Position:  -0.04180170562571745
Bond Position:  [-8.44282684]


portfolio before change:  [-12.61496338]
curr_Stock_Price:  99.78255810345468
curr_Factors:  [99.7825581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0164815]
Stock Position:  -0.01648149577228924
Bond Position:  [-10.97039757]


portfolio before change:  [-12.62406574]
curr_Stock_Price:  100.25162807033716
curr_Factors:  [100.25162807]
mat_Sqrt:  [[0.15]]
grads:  [0.10384159]
Stock Position:  0.10384159020044595
Bond Position:  [-23.03435422]


portfolio before change:  [-12.73806963]
curr_Stock_Price:  99.18149411995239
curr_Factors:  [99.18149412]
mat_Sqrt:  [[0.15]]
grads:  [-0.04477635]
Stock Position:  -0.04477635236725359
Bond Position:  [-8.2970841]


portfolio before change:  [-12.74851371]
curr_Stock_Price:  99.39158011863437
curr_Factors:  [99.39158012]
mat_Sqrt:  [[0.15]]
grads:  [-0.06150082]
Stock Position:  -0.06150081531444076
Bond Position:  [-6.6358505]


portfolio before change:  [-12.74445584]
curr_Stock_Price:  99.31211123285613
curr_Factors:  [99.31211123]
mat_Sqrt:  [[0.15]]
grads:  [0.15756665]
Stock Position:  0.15756664687148741
Bond Position:  [-28.3927322]


portfolio before change:  [-12.81098933]
curr_Stock_Price:  98.91238082782941
curr_Factors:  [98.91238083]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909746]
Stock Position:  -0.03909745916203591
Bond Position:  [-8.94376656]


portfolio before change:  [-12.8212695]
curr_Stock_Price:  99.14672139442791
curr_Factors:  [99.14672139]
mat_Sqrt:  [[0.15]]
grads:  [0.03174623]
Stock Position:  0.03174622715732436
Bond Position:  [-15.96880384]


portfolio before change:  [-12.79196636]
curr_Stock_Price:  100.13264524320671
curr_Factors:  [100.13264524]
mat_Sqrt:  [[0.15]]
grads:  [0.05198676]
Stock Position:  0.051986758208915386
Bond Position:  [-17.99753798]


portfolio before change:  [-12.79263111]
curr_Stock_Price:  100.16313532968722
curr_Factors:  [100.16313533]
mat_Sqrt:  [[0.15]]
grads:  [0.02711466]
Stock Position:  0.027114661193114557
Bond Position:  [-15.50852059]


portfolio before change:  [-12.80335867]
curr_Stock_Price:  99.83899797224004
curr_Factors:  [99.83899797]
mat_Sqrt:  [[0.15]]
grads:  [0.07705029]
Stock Position:  0.07705028962336775
Bond Position:  [-20.49598238]


portfolio before change:  [-12.83634483]
curr_Stock_Price:  99.44413896544303
curr_Factors:  [99.44413897]
mat_Sqrt:  [[0.15]]
grads:  [0.03238598]
Stock Position:  0.03238597596628324
Bond Position:  [-16.05694033]


portfolio before change:  [-12.85121032]
curr_Stock_Price:  99.04710758607038
curr_Factors:  [99.04710759]
mat_Sqrt:  [[0.15]]
grads:  [0.06353149]
Stock Position:  0.06353148519740008
Bond Position:  [-19.14382017]


portfolio before change:  [-12.81239464]
curr_Stock_Price:  99.69574365628056
curr_Factors:  [99.69574366]
mat_Sqrt:  [[0.15]]
grads:  [-0.01400124]
Stock Position:  -0.014001240176699977
Bond Position:  [-11.41653059]


portfolio before change:  [-12.81712457]
curr_Stock_Price:  99.9316356284727
curr_Factors:  [99.93163563]
mat_Sqrt:  [[0.15]]
grads:  [0.06452463]
Stock Position:  0.06452462875319245
Bond Position:  [-19.26517626]


portfolio before change:  [-12.7680583]
curr_Stock_Price:  100.72938641023437
curr_Factors:  [100.72938641]
mat_Sqrt:  [[0.15]]
grads:  [0.08885525]
Stock Position:  0.08885525015596354
Bond Position:  [-21.71839312]


portfolio before change:  [-12.78129945]
curr_Stock_Price:  100.61092204082561
curr_Factors:  [100.61092204]
mat_Sqrt:  [[0.15]]
grads:  [0.07630878]
Stock Position:  0.07630878115127351
Bond Position:  [-20.45879628]


portfolio before change:  [-12.72249545]
curr_Stock_Price:  101.41504318790145
curr_Factors:  [101.41504319]
mat_Sqrt:  [[0.15]]
grads:  [-0.0899817]
Stock Position:  -0.08998169896772794
Bond Position:  [-3.59699756]


portfolio before change:  [-12.76159607]
curr_Stock_Price:  101.84458571411305
curr_Factors:  [101.84458571]
mat_Sqrt:  [[0.15]]
grads:  [-0.07120693]
Stock Position:  -0.0712069310476139
Bond Position:  [-5.50955568]


portfolio before change:  [-12.84531128]
curr_Stock_Price:  103.01057438586527
curr_Factors:  [103.01057439]
mat_Sqrt:  [[0.15]]
grads:  [0.18559751]
Stock Position:  0.18559750984992043
Bond Position:  [-31.96381738]


portfolio before change:  [-12.93494722]
curr_Stock_Price:  102.5491446752444
curr_Factors:  [102.54914468]
mat_Sqrt:  [[0.15]]
grads:  [-0.24133458]
Stock Position:  -0.24133458383972578
Bond Position:  [11.81370794]


portfolio before change:  [-13.10079236]
curr_Stock_Price:  103.24246406559293
curr_Factors:  [103.24246407]
mat_Sqrt:  [[0.15]]
grads:  [0.04449427]
Stock Position:  0.04449427129770422
Bond Position:  [-17.69449056]


portfolio before change:  [-13.08685176]
curr_Stock_Price:  103.60548937649509
curr_Factors:  [103.60548938]
mat_Sqrt:  [[0.15]]
grads:  [0.03469218]
Stock Position:  0.03469217615359061
Bond Position:  [-16.68115165]


portfolio before change:  [-13.11883742]
curr_Stock_Price:  102.74361238434469
curr_Factors:  [102.74361238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04783358]
Stock Position:  -0.04783357649290576
Bond Position:  [-8.20424298]


portfolio before change:  [-13.05309137]
curr_Stock_Price:  101.34769657559026
curr_Factors:  [101.34769658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00254526]
Stock Position:  -0.0025452612862519055
Bond Position:  [-12.795135]


portfolio before change:  [-13.053986]
curr_Stock_Price:  101.07076659586426
curr_Factors:  [101.0707666]
mat_Sqrt:  [[0.15]]
grads:  [-0.07474227]
Stock Position:  -0.07474227352090956
Bond Position:  [-5.49972712]


portfolio before change:  [-13.09735017]
curr_Stock_Price:  101.64175077019296
curr_Factors:  [101.64175077]
mat_Sqrt:  [[0.15]]
grads:  [0.00019136]
Stock Position:  0.00019135548277058578
Bond Position:  [-13.11679987]


portfolio before change:  [-13.09905335]
curr_Stock_Price:  101.31000529911482
curr_Factors:  [101.3100053]
mat_Sqrt:  [[0.15]]
grads:  [-0.06549586]
Stock Position:  -0.06549585997034313
Bond Position:  [-6.46366743]


portfolio before change:  [-13.08428602]
curr_Stock_Price:  101.07219883388622
curr_Factors:  [101.07219883]
mat_Sqrt:  [[0.15]]
grads:  [-0.00914994]
Stock Position:  -0.00914993720327127
Bond Position:  [-12.15948175]


portfolio before change:  [-13.0860075]
curr_Stock_Price:  101.09421518809451
curr_Factors:  [101.09421519]
mat_Sqrt:  [[0.15]]
grads:  [0.03479112]
Stock Position:  0.034791117684318924
Bond Position:  [-16.60318824]


portfolio before change:  [-13.09028661]
curr_Stock_Price:  101.03087780127335
curr_Factors:  [101.0308778]
mat_Sqrt:  [[0.15]]
grads:  [0.03406632]
Stock Position:  0.03406632410368936
Bond Position:  [-16.53203723]


portfolio before change:  [-13.16406321]
curr_Stock_Price:  98.92586735110265
curr_Factors:  [98.92586735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08098943]
Stock Position:  -0.08098942905911098
Bond Position:  [-5.15211369]


portfolio before change:  [-13.2290519]
curr_Stock_Price:  99.72034922393358
curr_Factors:  [99.72034922]
mat_Sqrt:  [[0.15]]
grads:  [0.1098578]
Stock Position:  0.10985780008886448
Bond Position:  [-24.18411009]


portfolio before change:  [-13.1735935]
curr_Stock_Price:  100.25268830857009
curr_Factors:  [100.25268831]
mat_Sqrt:  [[0.15]]
grads:  [0.03710871]
Stock Position:  0.03710871418189821
Bond Position:  [-16.89384185]


portfolio before change:  [-13.17782902]
curr_Stock_Price:  100.19546028708675
curr_Factors:  [100.19546029]
mat_Sqrt:  [[0.15]]
grads:  [0.01538131]
Stock Position:  0.015381311015135663
Bond Position:  [-14.71896656]


portfolio before change:  [-13.19902437]
curr_Stock_Price:  98.93709143967735
curr_Factors:  [98.93709144]
mat_Sqrt:  [[0.15]]
grads:  [0.06566576]
Stock Position:  0.06566576149170263
Bond Position:  [-19.69580382]


portfolio before change:  [-13.16244582]
curr_Stock_Price:  99.53162767078005
curr_Factors:  [99.53162767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.16244582]
Stock Price:  99.53357475320612
PL:  [-13.16244582]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.81393474e-03]
 [ 3.00949092e-03]
 [-9.27153967e-03]
 [-4.70487527e-04]
 [ 9.71938528e-04]
 [-1.93597167e-02]
 [-3.98739773e-02]
 [ 2.16696813e-02]
 [-6.34811698e-03]
 [-1.60134432e-04]
 [-8.73888215e-03]
 [ 7.39966978e-03]
 [ 1.38660542e-02]
 [-2.83426176e-03]
 [-1.19669131e-02]
 [-1.02909160e-02]
 [ 1.84347424e-02]
 [-2.73529580e-02]
 [ 2.72872806e-03]
 [-1.67486020e-03]
 [ 2.25774378e-02]
 [-3.27464950e-03]
 [ 2.41522558e-02]
 [ 3.99621635e-03]
 [ 1.37010130e-02]
 [ 4.09776578e-03]
 [ 2.74371710e-02]
 [-2.40668828e-02]
 [-4.75534626e-02]
 [ 1.36533795e-03]
 [-4.27600170e-03]
 [ 5.58412202e-03]
 [ 1.35057977e-02]
 [-1.28430808e-02]
 [ 2.85219802e-03]
 [ 5.62245552e-03]
 [ 3.59041816e-03]
 [ 1.09998945e-02]
 [-3.47776097e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.36837245]
curr_Stock_Price:  100.28488373723586
curr_Factors:  [100.28488374]
mat_Sqrt:  [[0.15]]
grads:  [0.04542623]
Stock Position:  0.04542623157586065
Bond Position:  [1.8128081]


portfolio before change:  [6.34750285]
curr_Stock_Price:  99.82047773262735
curr_Factors:  [99.82047773]
mat_Sqrt:  [[0.15]]
grads:  [0.02006327]
Stock Position:  0.02006327279289359
Bond Position:  [4.34477737]


portfolio before change:  [6.32821076]
curr_Stock_Price:  98.83184463191584
curr_Factors:  [98.83184463]
mat_Sqrt:  [[0.15]]
grads:  [-0.06181026]
Stock Position:  -0.061810264488542356
Bond Position:  [12.43703322]


portfolio before change:  [6.3334509]
curr_Stock_Price:  98.77222006154818
curr_Factors:  [98.77222006]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313658]
Stock Position:  -0.0031365835139285044
Bond Position:  [6.64325822]


portfolio before change:  [6.33383202]
curr_Stock_Price:  98.91547648825005
curr_Factors:  [98.91547649]
mat_Sqrt:  [[0.15]]
grads:  [0.00647959]
Stock Position:  0.006479590185605004
Bond Position:  [5.69290027]


portfolio before change:  [6.33302751]
curr_Stock_Price:  98.68148398825865
curr_Factors:  [98.68148399]
mat_Sqrt:  [[0.15]]
grads:  [-0.12906478]
Stock Position:  -0.12906477780699477
Bond Position:  [19.06933131]


portfolio before change:  [6.33566444]
curr_Stock_Price:  98.67952281868531
curr_Factors:  [98.67952282]
mat_Sqrt:  [[0.15]]
grads:  [-0.26582652]
Stock Position:  -0.26582651507176713
Bond Position:  [32.5672981]


portfolio before change:  [6.34042835]
curr_Stock_Price:  98.6769168296951
curr_Factors:  [98.67691683]
mat_Sqrt:  [[0.15]]
grads:  [0.14446454]
Stock Position:  0.14446454186724486
Bond Position:  [-7.91488724]


portfolio before change:  [6.11540639]
curr_Stock_Price:  97.1261381407869
curr_Factors:  [97.12613814]
mat_Sqrt:  [[0.15]]
grads:  [-0.04232078]
Stock Position:  -0.04232077988074797
Bond Position:  [10.2258603]


portfolio before change:  [6.10683996]
curr_Stock_Price:  97.35876005116427
curr_Factors:  [97.35876005]
mat_Sqrt:  [[0.15]]
grads:  [-0.00106756]
Stock Position:  -0.0010675628785137884
Bond Position:  [6.21077656]


portfolio before change:  [6.10801144]
curr_Stock_Price:  96.98867747028326
curr_Factors:  [96.98867747]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825921]
Stock Position:  -0.05825921436629914
Bond Position:  [11.7584956]


portfolio before change:  [6.08484953]
curr_Stock_Price:  97.41147434517947
curr_Factors:  [97.41147435]
mat_Sqrt:  [[0.15]]
grads:  [0.04933113]
Stock Position:  0.049331131859433254
Bond Position:  [1.27943125]


portfolio before change:  [5.96030111]
curr_Stock_Price:  94.8834893360096
curr_Factors:  [94.88348934]
mat_Sqrt:  [[0.15]]
grads:  [0.09244036]
Stock Position:  0.092440361465518
Bond Position:  [-2.81076294]


portfolio before change:  [5.92774949]
curr_Stock_Price:  94.53515388968114
curr_Factors:  [94.53515389]
mat_Sqrt:  [[0.15]]
grads:  [-0.01889508]
Stock Position:  -0.018895078380706185
Bond Position:  [7.71399863]


portfolio before change:  [5.93481105]
curr_Stock_Price:  94.21246426747172
curr_Factors:  [94.21246427]
mat_Sqrt:  [[0.15]]
grads:  [-0.07977942]
Stock Position:  -0.07977942052326471
Bond Position:  [13.45102685]


portfolio before change:  [5.87238737]
curr_Stock_Price:  95.0159942768063
curr_Factors:  [95.01599428]
mat_Sqrt:  [[0.15]]
grads:  [-0.06860611]
Stock Position:  -0.06860610663912226
Bond Position:  [12.39106481]


portfolio before change:  [5.77209322]
curr_Stock_Price:  96.50045582010745
curr_Factors:  [96.50045582]
mat_Sqrt:  [[0.15]]
grads:  [0.12289828]
Stock Position:  0.1228982828688203
Bond Position:  [-6.08764709]


portfolio before change:  [5.64292376]
curr_Stock_Price:  95.45562058831568
curr_Factors:  [95.45562059]
mat_Sqrt:  [[0.15]]
grads:  [-0.18235305]
Stock Position:  -0.18235305355448167
Bond Position:  [23.04954766]


portfolio before change:  [5.58388933]
curr_Stock_Price:  95.79515869069243
curr_Factors:  [95.79515869]
mat_Sqrt:  [[0.15]]
grads:  [0.01819152]
Stock Position:  0.018191520413053237
Bond Position:  [3.84122974]


portfolio before change:  [5.60449483]
curr_Stock_Price:  96.90146086109912
curr_Factors:  [96.90146086]
mat_Sqrt:  [[0.15]]
grads:  [-0.01116573]
Stock Position:  -0.011165734689565984
Bond Position:  [6.68647083]


portfolio before change:  [5.61283789]
curr_Stock_Price:  96.22911823127339
curr_Factors:  [96.22911823]
mat_Sqrt:  [[0.15]]
grads:  [0.15051625]
Stock Position:  0.15051625217951328
Bond Position:  [-8.87120834]


portfolio before change:  [5.65367743]
curr_Stock_Price:  96.50781580714538
curr_Factors:  [96.50781581]
mat_Sqrt:  [[0.15]]
grads:  [-0.021831]
Stock Position:  -0.021830996645779192
Bond Position:  [7.76053924]


portfolio before change:  [5.66136693]
curr_Stock_Price:  96.2000253787922
curr_Factors:  [96.20002538]
mat_Sqrt:  [[0.15]]
grads:  [0.16101504]
Stock Position:  0.16101503896049008
Bond Position:  [-9.8282839]


portfolio before change:  [5.70252267]
curr_Stock_Price:  96.46325760982141
curr_Factors:  [96.46325761]
mat_Sqrt:  [[0.15]]
grads:  [0.02664144]
Stock Position:  0.026641442322119097
Bond Position:  [3.13260236]


portfolio before change:  [5.68552846]
curr_Stock_Price:  95.81067229934847
curr_Factors:  [95.8106723]
mat_Sqrt:  [[0.15]]
grads:  [0.09134009]
Stock Position:  0.0913400867657586
Bond Position:  [-3.06582666]


portfolio before change:  [5.62084711]
curr_Stock_Price:  95.1067305768141
curr_Factors:  [95.10673058]
mat_Sqrt:  [[0.15]]
grads:  [0.02731844]
Stock Position:  0.02731843853190044
Bond Position:  [3.02267973]


portfolio before change:  [5.61868428]
curr_Stock_Price:  95.01372784999744
curr_Factors:  [95.01372785]
mat_Sqrt:  [[0.15]]
grads:  [0.18291447]
Stock Position:  0.18291447365293112
Bond Position:  [-11.76070174]


portfolio before change:  [5.56068561]
curr_Stock_Price:  94.70468456334409
curr_Factors:  [94.70468456]
mat_Sqrt:  [[0.15]]
grads:  [-0.16044589]
Stock Position:  -0.1604458853513819
Bond Position:  [20.75566257]


portfolio before change:  [5.51327906]
curr_Stock_Price:  95.01632336206217
curr_Factors:  [95.01632336]
mat_Sqrt:  [[0.15]]
grads:  [-0.31702308]
Stock Position:  -0.3170230838419907
Bond Position:  [35.63564691]


portfolio before change:  [5.381187]
curr_Stock_Price:  95.4470389953181
curr_Factors:  [95.447039]
mat_Sqrt:  [[0.15]]
grads:  [0.00910225]
Stock Position:  0.009102252990165864
Bond Position:  [4.5124039]


portfolio before change:  [5.37859776]
curr_Stock_Price:  95.10060535892092
curr_Factors:  [95.10060536]
mat_Sqrt:  [[0.15]]
grads:  [-0.02850668]
Stock Position:  -0.028506677984650973
Bond Position:  [8.08960009]


portfolio before change:  [5.38664758]
curr_Stock_Price:  94.85369633109515
curr_Factors:  [94.85369633]
mat_Sqrt:  [[0.15]]
grads:  [0.03722748]
Stock Position:  0.0372274801136976
Bond Position:  [1.85548348]


portfolio before change:  [5.4164711]
curr_Stock_Price:  95.64858157877738
curr_Factors:  [95.64858158]
mat_Sqrt:  [[0.15]]
grads:  [0.09003865]
Stock Position:  0.09003865137972614
Bond Position:  [-3.19559819]


portfolio before change:  [5.45941129]
curr_Stock_Price:  96.12992664331324
curr_Factors:  [96.12992664]
mat_Sqrt:  [[0.15]]
grads:  [-0.08562054]
Stock Position:  -0.08562053865559342
Bond Position:  [13.69010739]


portfolio before change:  [5.42057838]
curr_Stock_Price:  96.6034611572396
curr_Factors:  [96.60346116]
mat_Sqrt:  [[0.15]]
grads:  [0.01901465]
Stock Position:  0.01901465343895306
Bond Position:  [3.58369704]


portfolio before change:  [5.42210854]
curr_Stock_Price:  96.66037390387766
curr_Factors:  [96.6603739]
mat_Sqrt:  [[0.15]]
grads:  [0.03748304]
Stock Position:  0.037483036785207126
Bond Position:  [1.79898419]


portfolio before change:  [5.42254841]
curr_Stock_Price:  96.66610929080318
curr_Factors:  [96.66610929]
mat_Sqrt:  [[0.15]]
grads:  [0.02393612]
Stock Position:  0.02393612109342092
Bond Position:  [3.10873671]


portfolio before change:  [5.40651923]
curr_Stock_Price:  95.98020881488549
curr_Factors:  [95.98020881]
mat_Sqrt:  [[0.15]]
grads:  [0.07333263]
Stock Position:  0.07333262969050426
Bond Position:  [-1.63196188]


portfolio before change:  [5.42117267]
curr_Stock_Price:  96.18281231032078
curr_Factors:  [96.18281231]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.42117267]
Stock Price:  95.61727092165881
PL:  [5.42117267]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.11572196e-03]
 [-6.60741807e-03]
 [-1.11522880e-02]
 [ 2.53988088e-03]
 [ 1.39438853e-02]
 [ 2.65686511e-02]
 [ 7.98111142e-03]
 [ 9.01788244e-03]
 [-7.36737542e-03]
 [-1.05898521e-03]
 [ 1.05166799e-02]
 [ 4.30718584e-03]
 [ 1.22069137e-02]
 [-1.39840069e-03]
 [ 2.44699983e-02]
 [ 1.92472713e-03]
 [ 8.85447743e-03]
 [ 1.16921184e-02]
 [ 1.16647664e-02]
 [-1.32179014e-02]
 [-1.56647318e-02]
 [ 2.03104967e-02]
 [-1.80697424e-02]
 [ 4.60061988e-03]
 [-2.61380224e-03]
 [-9.99445799e-03]
 [-9.71763383e-04]
 [-1.08323917e-02]
 [ 5.07068508e-02]
 [-6.19326237e-03]
 [-1.02562883e-02]
 [ 4.62534851e-03]
 [ 5.85253322e-03]
 [-1.00850661e-03]
 [ 7.61617314e-03]
 [ 4.30958026e-03]
 [-3.25893840e-02]
 [ 9.99902848e-03]
 [-1.05956227e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.0019433]
curr_Stock_Price:  99.42237310325488
curr_Factors:  [99.4223731]
mat_Sqrt:  [[0.15]]
grads:  [0.03410481]
Stock Position:  0.03410481304767487
Bond Position:  [-10.39272475]


portfolio before change:  [-7.01372439]
curr_Stock_Price:  99.11502890377216
curr_Factors:  [99.1150289]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404945]
Stock Position:  -0.044049453788062624
Bond Position:  [-2.6477615]


portfolio before change:  [-6.99567347]
curr_Stock_Price:  98.6977272193843
curr_Factors:  [98.69772722]
mat_Sqrt:  [[0.15]]
grads:  [-0.07434859]
Stock Position:  -0.07434858637495266
Bond Position:  [0.34236303]


portfolio before change:  [-6.96081203]
curr_Stock_Price:  98.22941110911762
curr_Factors:  [98.22941111]
mat_Sqrt:  [[0.15]]
grads:  [0.01693254]
Stock Position:  0.016932539230878348
Bond Position:  [-8.62408539]


portfolio before change:  [-6.93099923]
curr_Stock_Price:  100.05376094093042
curr_Factors:  [100.05376094]
mat_Sqrt:  [[0.15]]
grads:  [0.09295924]
Stock Position:  0.09295923558418043
Bond Position:  [-16.23192037]


portfolio before change:  [-6.80144691]
curr_Stock_Price:  101.46923554385106
curr_Factors:  [101.46923554]
mat_Sqrt:  [[0.15]]
grads:  [0.17712434]
Stock Position:  0.17712434049580644
Bond Position:  [-24.77411834]


portfolio before change:  [-6.72557079]
curr_Stock_Price:  101.9150979303873
curr_Factors:  [101.91509793]
mat_Sqrt:  [[0.15]]
grads:  [0.05320741]
Stock Position:  0.05320740949301985
Bond Position:  [-12.14820914]


portfolio before change:  [-6.71226343]
curr_Stock_Price:  102.19374300451217
curr_Factors:  [102.193743]
mat_Sqrt:  [[0.15]]
grads:  [0.06011922]
Stock Position:  0.06011921628733601
Bond Position:  [-12.85607117]


portfolio before change:  [-6.77211368]
curr_Stock_Price:  101.22494892453841
curr_Factors:  [101.22494892]
mat_Sqrt:  [[0.15]]
grads:  [-0.04911584]
Stock Position:  -0.04911583611190519
Bond Position:  [-1.80036568]


portfolio before change:  [-6.76809608]
curr_Stock_Price:  101.1385682084532
curr_Factors:  [101.13856821]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070599]
Stock Position:  -0.0070599013875284125
Bond Position:  [-6.05406776]


portfolio before change:  [-6.76728514]
curr_Stock_Price:  100.91650557229117
curr_Factors:  [100.91650557]
mat_Sqrt:  [[0.15]]
grads:  [0.0701112]
Stock Position:  0.0701111993037516
Bond Position:  [-13.84266238]


portfolio before change:  [-6.76753552]
curr_Stock_Price:  100.93761579227717
curr_Factors:  [100.93761579]
mat_Sqrt:  [[0.15]]
grads:  [0.02871457]
Stock Position:  0.028714572282080852
Bond Position:  [-9.66591598]


portfolio before change:  [-6.76906323]
curr_Stock_Price:  100.9264926530163
curr_Factors:  [100.92649265]
mat_Sqrt:  [[0.15]]
grads:  [0.08137942]
Stock Position:  0.081379424767527
Bond Position:  [-14.98240315]


portfolio before change:  [-6.76786228]
curr_Stock_Price:  100.96426468641644
curr_Factors:  [100.96426469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00932267]
Stock Position:  -0.009322671238999424
Bond Position:  [-5.82660564]


portfolio before change:  [-6.76842575]
curr_Stock_Price:  100.94657659696864
curr_Factors:  [100.9465766]
mat_Sqrt:  [[0.15]]
grads:  [0.16313332]
Stock Position:  0.1631333221839351
Bond Position:  [-23.23617616]


portfolio before change:  [-6.62970231]
curr_Stock_Price:  101.81475082676047
curr_Factors:  [101.81475083]
mat_Sqrt:  [[0.15]]
grads:  [0.01283151]
Stock Position:  0.012831514190807984
Bond Position:  [-7.93613973]


portfolio before change:  [-6.63161648]
curr_Stock_Price:  101.74288913471878
curr_Factors:  [101.74288913]
mat_Sqrt:  [[0.15]]
grads:  [0.05902985]
Stock Position:  0.05902984952902172
Bond Position:  [-12.63748392]


portfolio before change:  [-6.60680006]
curr_Stock_Price:  102.19005625976567
curr_Factors:  [102.19005626]
mat_Sqrt:  [[0.15]]
grads:  [0.07794746]
Stock Position:  0.07794745602140073
Bond Position:  [-14.57225498]


portfolio before change:  [-6.67101223]
curr_Stock_Price:  101.38963854345027
curr_Factors:  [101.38963854]
mat_Sqrt:  [[0.15]]
grads:  [0.07776511]
Stock Position:  0.07776510932033512
Bond Position:  [-14.55558856]


portfolio before change:  [-6.69579654]
curr_Stock_Price:  101.09432946863147
curr_Factors:  [101.09432947]
mat_Sqrt:  [[0.15]]
grads:  [-0.08811934]
Stock Position:  -0.08811934275135529
Bond Position:  [2.21256933]


portfolio before change:  [-6.64508399]
curr_Stock_Price:  100.52196985720124
curr_Factors:  [100.52196986]
mat_Sqrt:  [[0.15]]
grads:  [-0.10443155]
Stock Position:  -0.1044315456062628
Bond Position:  [3.85258069]


portfolio before change:  [-6.70147752]
curr_Stock_Price:  101.06658622238018
curr_Factors:  [101.06658622]
mat_Sqrt:  [[0.15]]
grads:  [0.13540331]
Stock Position:  0.13540331116805276
Bond Position:  [-20.38622794]


portfolio before change:  [-6.70941441]
curr_Stock_Price:  101.02679062676694
curr_Factors:  [101.02679063]
mat_Sqrt:  [[0.15]]
grads:  [-0.12046495]
Stock Position:  -0.12046494913006835
Bond Position:  [5.46077278]


portfolio before change:  [-6.8172957]
curr_Stock_Price:  101.9279981751624
curr_Factors:  [101.92799818]
mat_Sqrt:  [[0.15]]
grads:  [0.0306708]
Stock Position:  0.030670799207366067
Bond Position:  [-9.94350886]


portfolio before change:  [-6.80134484]
curr_Stock_Price:  102.48859229511513
curr_Factors:  [102.4885923]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742535]
Stock Position:  -0.017425348271149534
Bond Position:  [-5.01544543]


portfolio before change:  [-6.81755991]
curr_Stock_Price:  103.38315678532003
curr_Factors:  [103.38315679]
mat_Sqrt:  [[0.15]]
grads:  [-0.06662972]
Stock Position:  -0.06662971990787998
Bond Position:  [0.07083087]


portfolio before change:  [-6.79090046]
curr_Stock_Price:  102.9831761662994
curr_Factors:  [102.98317617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647842]
Stock Position:  -0.006478422553204648
Bond Position:  [-6.12373193]


portfolio before change:  [-6.7906961]
curr_Stock_Price:  102.83346849931417
curr_Factors:  [102.8334685]
mat_Sqrt:  [[0.15]]
grads:  [-0.07221594]
Stock Position:  -0.072215944369102
Bond Position:  [0.63551994]


portfolio before change:  [-6.83581061]
curr_Stock_Price:  103.45928532345621
curr_Factors:  [103.45928532]
mat_Sqrt:  [[0.15]]
grads:  [0.33804567]
Stock Position:  0.3380456720909849
Bond Position:  [-41.80977425]


portfolio before change:  [-6.57611836]
curr_Stock_Price:  104.24296286144691
curr_Factors:  [104.24296286]
mat_Sqrt:  [[0.15]]
grads:  [-0.04128842]
Stock Position:  -0.04128841582994804
Bond Position:  [-2.27209156]


portfolio before change:  [-6.65504566]
curr_Stock_Price:  106.14769249215864
curr_Factors:  [106.14769249]
mat_Sqrt:  [[0.15]]
grads:  [-0.06837526]
Stock Position:  -0.068375255577639
Bond Position:  [0.60282994]


portfolio before change:  [-6.55037132]
curr_Stock_Price:  104.61791419020935
curr_Factors:  [104.61791419]
mat_Sqrt:  [[0.15]]
grads:  [0.03083566]
Stock Position:  0.03083565672721381
Bond Position:  [-9.77633341]


portfolio before change:  [-6.533359]
curr_Stock_Price:  105.20925674367702
curr_Factors:  [105.20925674]
mat_Sqrt:  [[0.15]]
grads:  [0.03901689]
Stock Position:  0.03901688815037654
Bond Position:  [-10.6382968]


portfolio before change:  [-6.5167083]
curr_Stock_Price:  105.67009737390285
curr_Factors:  [105.67009737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672338]
Stock Position:  -0.006723377367525904
Bond Position:  [-5.80624836]


portfolio before change:  [-6.51887338]
curr_Stock_Price:  105.88416347901504
curr_Factors:  [105.88416348]
mat_Sqrt:  [[0.15]]
grads:  [0.05077449]
Stock Position:  0.05077448759122001
Bond Position:  [-11.89508752]


portfolio before change:  [-6.53739312]
curr_Stock_Price:  105.54870442246296
curr_Factors:  [105.54870442]
mat_Sqrt:  [[0.15]]
grads:  [0.02873054]
Stock Position:  0.02873053508329874
Bond Position:  [-9.56986387]


portfolio before change:  [-6.5333079]
curr_Stock_Price:  105.73253419358142
curr_Factors:  [105.73253419]
mat_Sqrt:  [[0.15]]
grads:  [-0.21726256]
Stock Position:  -0.2172625597895064
Bond Position:  [16.43841314]


portfolio before change:  [-6.22764956]
curr_Stock_Price:  104.33513092817266
curr_Factors:  [104.33513093]
mat_Sqrt:  [[0.15]]
grads:  [0.06666019]
Stock Position:  0.06666018985167455
Bond Position:  [-13.18264919]


portfolio before change:  [-6.1747558]
curr_Stock_Price:  105.15333578934913
curr_Factors:  [105.15333579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.1747558]
Stock Price:  105.0260674110554
PL:  [-11.20082321]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.02989079e-03]
 [ 4.38740621e-03]
 [ 1.41930296e-02]
 [-2.67806985e-03]
 [ 1.48267342e-02]
 [ 2.63096277e-02]
 [ 9.81065998e-04]
 [ 9.77113037e-03]
 [-7.50954490e-03]
 [-1.96309068e-03]
 [ 1.06216684e-02]
 [ 6.08345568e-03]
 [ 5.46949207e-03]
 [-4.41952043e-03]
 [ 8.37676952e-03]
 [ 2.84929594e-03]
 [ 9.11189492e-03]
 [ 1.18502836e-02]
 [ 1.16616548e-02]
 [-1.36531946e-02]
 [-9.22448891e-03]
 [ 2.10115855e-02]
 [ 1.03198740e-04]
 [ 6.12006630e-03]
 [-8.25802373e-03]
 [-7.38996252e-03]
 [ 1.32658907e-02]
 [-1.11178016e-02]
 [-1.71787885e-02]
 [-3.80439827e-03]
 [-3.81295134e-03]
 [ 5.62807803e-03]
 [ 7.72602596e-03]
 [-1.26385693e-02]
 [ 3.02043968e-03]
 [ 5.68359230e-03]
 [ 3.59040285e-03]
 [ 1.12066951e-02]
 [-1.85272138e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.73398861]
curr_Stock_Price:  100.11494129802854
curr_Factors:  [100.1149413]
mat_Sqrt:  [[0.15]]
grads:  [0.03353261]
Stock Position:  0.03353260526233589
Bond Position:  [0.37687381]


portfolio before change:  [3.73142565]
curr_Stock_Price:  100.03710445743168
curr_Factors:  [100.03710446]
mat_Sqrt:  [[0.15]]
grads:  [0.02924937]
Stock Position:  0.029249374761591958
Bond Position:  [0.80540289]


portfolio before change:  [3.76232253]
curr_Stock_Price:  101.08998830485382
curr_Factors:  [101.0899883]
mat_Sqrt:  [[0.15]]
grads:  [0.0946202]
Stock Position:  0.0946201976090037
Bond Position:  [-5.80283214]


portfolio before change:  [3.70901123]
curr_Stock_Price:  100.53423061685832
curr_Factors:  [100.53423062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178538]
Stock Position:  -0.01785379896841378
Bond Position:  [5.50392917]


portfolio before change:  [3.69962003]
curr_Stock_Price:  101.0987732040967
curr_Factors:  [101.0987732]
mat_Sqrt:  [[0.15]]
grads:  [0.09884489]
Stock Position:  0.09884489461014337
Bond Position:  [-6.29347755]


portfolio before change:  [3.70175963]
curr_Stock_Price:  101.12837849658978
curr_Factors:  [101.1283785]
mat_Sqrt:  [[0.15]]
grads:  [0.17539752]
Stock Position:  0.1753975181463775
Bond Position:  [-14.03590697]


portfolio before change:  [3.76694229]
curr_Stock_Price:  101.51001023983721
curr_Factors:  [101.51001024]
mat_Sqrt:  [[0.15]]
grads:  [0.00654044]
Stock Position:  0.006540439989239979
Bond Position:  [3.10302216]


portfolio before change:  [3.76995967]
curr_Stock_Price:  101.91204374431747
curr_Factors:  [101.91204374]
mat_Sqrt:  [[0.15]]
grads:  [0.06514087]
Stock Position:  0.06514086912115093
Bond Position:  [-2.86867943]


portfolio before change:  [3.72920618]
curr_Stock_Price:  101.29192787601293
curr_Factors:  [101.29192788]
mat_Sqrt:  [[0.15]]
grads:  [-0.05006363]
Stock Position:  -0.05006363267780492
Bond Position:  [8.80024805]


portfolio before change:  [3.72166296]
curr_Stock_Price:  101.46457446700107
curr_Factors:  [101.46457447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01308727]
Stock Position:  -0.013087271175711412
Bond Position:  [5.04955736]


portfolio before change:  [3.7186264]
curr_Stock_Price:  101.74483113813538
curr_Factors:  [101.74483114]
mat_Sqrt:  [[0.15]]
grads:  [0.07081112]
Stock Position:  0.0708111228684861
Bond Position:  [-3.48603934]


portfolio before change:  [3.75557485]
curr_Stock_Price:  102.27277410808031
curr_Factors:  [102.27277411]
mat_Sqrt:  [[0.15]]
grads:  [0.04055637]
Stock Position:  0.04055637116954502
Bond Position:  [-0.39223773]


portfolio before change:  [3.78474477]
curr_Stock_Price:  102.99322681711655
curr_Factors:  [102.99322682]
mat_Sqrt:  [[0.15]]
grads:  [0.03646328]
Stock Position:  0.03646328044602589
Bond Position:  [0.02927385]


portfolio before change:  [3.78982121]
curr_Stock_Price:  103.13234714926836
curr_Factors:  [103.13234715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02946347]
Stock Position:  -0.029463469507297002
Bond Position:  [6.82845798]


portfolio before change:  [3.79668739]
curr_Stock_Price:  102.92827856959161
curr_Factors:  [102.92827857]
mat_Sqrt:  [[0.15]]
grads:  [0.05584513]
Stock Position:  0.05584513016369641
Bond Position:  [-1.95135573]


portfolio before change:  [3.8211776]
curr_Stock_Price:  103.37118461207766
curr_Factors:  [103.37118461]
mat_Sqrt:  [[0.15]]
grads:  [0.01899531]
Stock Position:  0.018995306287487766
Bond Position:  [1.85761029]


portfolio before change:  [3.82179162]
curr_Stock_Price:  103.39128429521048
curr_Factors:  [103.3912843]
mat_Sqrt:  [[0.15]]
grads:  [0.06074597]
Stock Position:  0.06074596610879603
Bond Position:  [-2.45881184]


portfolio before change:  [3.74366178]
curr_Stock_Price:  102.11017094701013
curr_Factors:  [102.11017095]
mat_Sqrt:  [[0.15]]
grads:  [0.07900189]
Stock Position:  0.07900189060450337
Bond Position:  [-4.32323478]


portfolio before change:  [3.70218591]
curr_Stock_Price:  101.59201336733757
curr_Factors:  [101.59201337]
mat_Sqrt:  [[0.15]]
grads:  [0.07774437]
Stock Position:  0.07774436525114804
Bond Position:  [-4.19602068]


portfolio before change:  [3.70182134]
curr_Stock_Price:  101.59407097770223
curr_Factors:  [101.59407098]
mat_Sqrt:  [[0.15]]
grads:  [-0.0910213]
Stock Position:  -0.0910212975168573
Bond Position:  [12.9490455]


portfolio before change:  [3.65876719]
curr_Stock_Price:  102.08486690623619
curr_Factors:  [102.08486691]
mat_Sqrt:  [[0.15]]
grads:  [-0.06149659]
Stock Position:  -0.061496592700815124
Bond Position:  [9.93663867]


portfolio before change:  [3.70366585]
curr_Stock_Price:  101.37496581461522
curr_Factors:  [101.37496581]
mat_Sqrt:  [[0.15]]
grads:  [0.14007724]
Stock Position:  0.14007723696774796
Bond Position:  [-10.49665926]


portfolio before change:  [3.55671736]
curr_Stock_Price:  100.3352799543183
curr_Factors:  [100.33527995]
mat_Sqrt:  [[0.15]]
grads:  [0.00068799]
Stock Position:  0.0006879915980681206
Bond Position:  [3.48768753]


portfolio before change:  [3.55726902]
curr_Stock_Price:  100.50340915034279
curr_Factors:  [100.50340915]
mat_Sqrt:  [[0.15]]
grads:  [0.04080044]
Stock Position:  0.04080044197111758
Bond Position:  [-0.54331449]


portfolio before change:  [3.57125624]
curr_Stock_Price:  100.8478940761097
curr_Factors:  [100.84789408]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505349]
Stock Position:  -0.05505349155801996
Bond Position:  [9.12328492]


portfolio before change:  [3.56297863]
curr_Stock_Price:  101.0189657172597
curr_Factors:  [101.01896572]
mat_Sqrt:  [[0.15]]
grads:  [-0.04926642]
Stock Position:  -0.049266416817923646
Bond Position:  [8.5398211]


portfolio before change:  [3.66507921]
curr_Stock_Price:  98.96821706415666
curr_Factors:  [98.96821706]
mat_Sqrt:  [[0.15]]
grads:  [0.08843927]
Stock Position:  0.08843927148952721
Bond Position:  [-5.08759781]


portfolio before change:  [3.82795973]
curr_Stock_Price:  100.81712995682791
curr_Factors:  [100.81712996]
mat_Sqrt:  [[0.15]]
grads:  [-0.07411868]
Stock Position:  -0.07411867748690724
Bond Position:  [11.30039207]


portfolio before change:  [3.86344936]
curr_Stock_Price:  100.35736736993273
curr_Factors:  [100.35736737]
mat_Sqrt:  [[0.15]]
grads:  [-0.11452526]
Stock Position:  -0.11452525653371104
Bond Position:  [15.35690261]


portfolio before change:  [4.01944098]
curr_Stock_Price:  99.01205812410264
curr_Factors:  [99.01205812]
mat_Sqrt:  [[0.15]]
grads:  [-0.02536266]
Stock Position:  -0.025362655119376857
Bond Position:  [6.53064967]


portfolio before change:  [4.05007376]
curr_Stock_Price:  97.83645575159109
curr_Factors:  [97.83645575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02541968]
Stock Position:  -0.025419675576206446
Bond Position:  [6.53704473]


portfolio before change:  [4.04177498]
curr_Stock_Price:  98.1950741352614
curr_Factors:  [98.19507414]
mat_Sqrt:  [[0.15]]
grads:  [0.03752052]
Stock Position:  0.0375205202030895
Bond Position:  [0.35744472]


portfolio before change:  [4.04347466]
curr_Stock_Price:  98.23918324039192
curr_Factors:  [98.23918324]
mat_Sqrt:  [[0.15]]
grads:  [0.05150684]
Stock Position:  0.05150683970074933
Bond Position:  [-1.0165152]


portfolio before change:  [4.00561038]
curr_Stock_Price:  97.50651911721376
curr_Factors:  [97.50651912]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425713]
Stock Position:  -0.08425712877706783
Bond Position:  [12.22122971]


portfolio before change:  [4.05060101]
curr_Stock_Price:  96.99068281863373
curr_Factors:  [96.99068282]
mat_Sqrt:  [[0.15]]
grads:  [0.02013626]
Stock Position:  0.020136264523114643
Bond Position:  [2.09757097]


portfolio before change:  [4.05662918]
curr_Stock_Price:  97.27702972277513
curr_Factors:  [97.27702972]
mat_Sqrt:  [[0.15]]
grads:  [0.03789062]
Stock Position:  0.03789061535380251
Bond Position:  [0.37074266]


portfolio before change:  [4.06813637]
curr_Stock_Price:  97.57950159336553
curr_Factors:  [97.57950159]
mat_Sqrt:  [[0.15]]
grads:  [0.02393602]
Stock Position:  0.02393601897439903
Bond Position:  [1.73247157]


portfolio before change:  [4.08047976]
curr_Stock_Price:  98.08613629061229
curr_Factors:  [98.08613629]
mat_Sqrt:  [[0.15]]
grads:  [0.0747113]
Stock Position:  0.07471130091741064
Bond Position:  [-3.24766308]


portfolio before change:  [4.12328827]
curr_Stock_Price:  98.66455602875848
curr_Factors:  [98.66455603]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.12328827]
Stock Price:  99.55953628695022
PL:  [4.12328827]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.45983018e-03]
 [-1.07601423e-02]
 [-2.21401128e-02]
 [ 8.98867993e-03]
 [-3.04389507e-02]
 [-2.89051486e-02]
 [-4.84333553e-02]
 [ 9.89878712e-03]
 [-6.47882475e-03]
 [ 7.75620804e-03]
 [-4.66617714e-03]
 [ 7.21533692e-03]
 [ 1.39004806e-02]
 [ 3.63183167e-03]
 [ 3.78150397e-03]
 [-3.29347811e-03]
 [ 1.04823148e-02]
 [ 8.40798417e-03]
 [ 1.14265845e-02]
 [-9.72197194e-03]
 [ 4.71160169e-03]
 [ 5.34345146e-03]
 [ 1.86039311e-02]
 [ 5.02627147e-03]
 [ 2.20305503e-03]
 [-1.02966997e-02]
 [ 1.42596147e-02]
 [-1.08462399e-02]
 [-1.72682076e-02]
 [-2.47436882e-03]
 [-3.98096166e-03]
 [ 5.61490052e-03]
 [ 9.46938025e-03]
 [-1.28615916e-02]
 [ 3.13347450e-03]
 [ 5.59838939e-03]
 [ 3.55280313e-03]
 [ 1.12108534e-02]
 [-2.88275602e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.40025476]
curr_Stock_Price:  99.52569702063224
curr_Factors:  [99.52569702]
mat_Sqrt:  [[0.15]]
grads:  [0.0297322]
Stock Position:  0.029732201206842553
Bond Position:  [-8.35937281]


portfolio before change:  [-5.42338971]
curr_Stock_Price:  98.78273274095991
curr_Factors:  [98.78273274]
mat_Sqrt:  [[0.15]]
grads:  [-0.07173428]
Stock Position:  -0.07173428204183194
Bond Position:  [1.6627187]


portfolio before change:  [-5.35698022]
curr_Stock_Price:  97.85985972300837
curr_Factors:  [97.85985972]
mat_Sqrt:  [[0.15]]
grads:  [-0.14760075]
Stock Position:  -0.14760075208070758
Bond Position:  [9.08720867]


portfolio before change:  [-5.23875969]
curr_Stock_Price:  97.06660796516928
curr_Factors:  [97.06660797]
mat_Sqrt:  [[0.15]]
grads:  [0.05992453]
Stock Position:  0.059924532858567005
Bond Position:  [-11.05543083]


portfolio before change:  [-5.19175001]
curr_Stock_Price:  97.87415198433463
curr_Factors:  [97.87415198]
mat_Sqrt:  [[0.15]]
grads:  [-0.20292634]
Stock Position:  -0.2029263379705423
Bond Position:  [14.66949323]


portfolio before change:  [-5.14132505]
curr_Stock_Price:  97.634699782421
curr_Factors:  [97.63469978]
mat_Sqrt:  [[0.15]]
grads:  [-0.19270099]
Stock Position:  -0.19270099052367928
Bond Position:  [13.67297831]


portfolio before change:  [-5.1481208]
curr_Stock_Price:  97.67883540066646
curr_Factors:  [97.6788354]
mat_Sqrt:  [[0.15]]
grads:  [-0.32288904]
Stock Position:  -0.3228890351945519
Bond Position:  [26.39130412]


portfolio before change:  [-4.65337447]
curr_Stock_Price:  96.15680412329331
curr_Factors:  [96.15680412]
mat_Sqrt:  [[0.15]]
grads:  [0.06599191]
Stock Position:  0.0659919141353636
Bond Position:  [-10.99894603]


portfolio before change:  [-4.61315023]
curr_Stock_Price:  96.7871722036993
curr_Factors:  [96.7871722]
mat_Sqrt:  [[0.15]]
grads:  [-0.04319217]
Stock Position:  -0.0431921650045228
Bond Position:  [-0.43270272]


portfolio before change:  [-4.59049436]
curr_Stock_Price:  96.2613834307774
curr_Factors:  [96.26138343]
mat_Sqrt:  [[0.15]]
grads:  [0.05170805]
Stock Position:  0.051708053620634235
Bond Position:  [-9.56798314]


portfolio before change:  [-4.51272987]
curr_Stock_Price:  97.78842914461137
curr_Factors:  [97.78842914]
mat_Sqrt:  [[0.15]]
grads:  [-0.03110785]
Stock Position:  -0.03110784763215347
Bond Position:  [-1.47074232]


portfolio before change:  [-4.52452918]
curr_Stock_Price:  98.16182197027113
curr_Factors:  [98.16182197]
mat_Sqrt:  [[0.15]]
grads:  [0.04810225]
Stock Position:  0.04810224613290693
Bond Position:  [-9.2463333]


portfolio before change:  [-4.51714415]
curr_Stock_Price:  98.33937891894946
curr_Factors:  [98.33937892]
mat_Sqrt:  [[0.15]]
grads:  [0.09266987]
Stock Position:  0.09266987070418252
Bond Position:  [-13.63024168]


portfolio before change:  [-4.46691703]
curr_Stock_Price:  98.8997660956847
curr_Factors:  [98.8997661]
mat_Sqrt:  [[0.15]]
grads:  [0.02421221]
Stock Position:  0.0242122111628315
Bond Position:  [-6.86149905]


portfolio before change:  [-4.48545336]
curr_Stock_Price:  98.16961437157516
curr_Factors:  [98.16961437]
mat_Sqrt:  [[0.15]]
grads:  [0.02521003]
Stock Position:  0.02521002649125853
Bond Position:  [-6.96031194]


portfolio before change:  [-4.46911396]
curr_Stock_Price:  98.85225918713964
curr_Factors:  [98.85225919]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195652]
Stock Position:  -0.021956520715756888
Bond Position:  [-2.29866228]


portfolio before change:  [-4.48535098]
curr_Stock_Price:  99.57867989261509
curr_Factors:  [99.57867989]
mat_Sqrt:  [[0.15]]
grads:  [0.0698821]
Stock Position:  0.06988209860268871
Bond Position:  [-11.44411811]


portfolio before change:  [-4.4521181]
curr_Stock_Price:  100.07470802318818
curr_Factors:  [100.07470802]
mat_Sqrt:  [[0.15]]
grads:  [0.05605323]
Stock Position:  0.05605322778972528
Bond Position:  [-10.0616285]


portfolio before change:  [-4.4198862]
curr_Stock_Price:  100.6721702005566
curr_Factors:  [100.6721702]
mat_Sqrt:  [[0.15]]
grads:  [0.07617723]
Stock Position:  0.07617722994780068
Bond Position:  [-12.08881326]


portfolio before change:  [-4.55964769]
curr_Stock_Price:  98.85731951112567
curr_Factors:  [98.85731951]
mat_Sqrt:  [[0.15]]
grads:  [-0.06481315]
Stock Position:  -0.06481314625344338
Bond Position:  [1.84760622]


portfolio before change:  [-4.59119217]
curr_Stock_Price:  99.34758179870084
curr_Factors:  [99.3475818]
mat_Sqrt:  [[0.15]]
grads:  [0.03141068]
Stock Position:  0.031410677913598146
Bond Position:  [-7.71176706]


portfolio before change:  [-4.60683416]
curr_Stock_Price:  98.88028986609606
curr_Factors:  [98.88028987]
mat_Sqrt:  [[0.15]]
grads:  [0.03562301]
Stock Position:  0.03562300971112793
Bond Position:  [-8.12924768]


portfolio before change:  [-4.62172205]
curr_Stock_Price:  98.49088772353241
curr_Factors:  [98.49088772]
mat_Sqrt:  [[0.15]]
grads:  [0.12402621]
Stock Position:  0.12402620702709212
Bond Position:  [-16.83717328]


portfolio before change:  [-4.56775922]
curr_Stock_Price:  98.94295034003467
curr_Factors:  [98.94295034]
mat_Sqrt:  [[0.15]]
grads:  [0.03350848]
Stock Position:  0.033508476458604504
Bond Position:  [-7.88318674]


portfolio before change:  [-4.54528477]
curr_Stock_Price:  99.64306888288793
curr_Factors:  [99.64306888]
mat_Sqrt:  [[0.15]]
grads:  [0.01468703]
Stock Position:  0.014687033507486957
Bond Position:  [-6.00874586]


portfolio before change:  [-4.54666597]
curr_Stock_Price:  99.60016968232877
curr_Factors:  [99.60016968]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864466]
Stock Position:  -0.0686446649584609
Bond Position:  [2.2903543]


portfolio before change:  [-4.47738624]
curr_Stock_Price:  98.59508912259848
curr_Factors:  [98.59508912]
mat_Sqrt:  [[0.15]]
grads:  [0.0950641]
Stock Position:  0.09506409829792138
Bond Position:  [-13.85023949]


portfolio before change:  [-4.45029796]
curr_Stock_Price:  98.89824950389905
curr_Factors:  [98.8982495]
mat_Sqrt:  [[0.15]]
grads:  [-0.07230827]
Stock Position:  -0.07230826607214685
Bond Position:  [2.70086298]


portfolio before change:  [-4.41537428]
curr_Stock_Price:  98.41993549254758
curr_Factors:  [98.41993549]
mat_Sqrt:  [[0.15]]
grads:  [-0.11512138]
Stock Position:  -0.11512138385814
Bond Position:  [6.9148649]


portfolio before change:  [-4.42449354]
curr_Stock_Price:  98.50665849981922
curr_Factors:  [98.5066585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01649579]
Stock Position:  -0.016495792132183815
Bond Position:  [-2.79954818]


portfolio before change:  [-4.40387239]
curr_Stock_Price:  97.23535756793189
curr_Factors:  [97.23535757]
mat_Sqrt:  [[0.15]]
grads:  [-0.02653974]
Stock Position:  -0.02653974437505601
Bond Position:  [-1.82327085]


portfolio before change:  [-4.41457863]
curr_Stock_Price:  97.63017360754469
curr_Factors:  [97.63017361]
mat_Sqrt:  [[0.15]]
grads:  [0.03743267]
Stock Position:  0.03743267013871991
Bond Position:  [-8.06913671]


portfolio before change:  [-4.42672128]
curr_Stock_Price:  97.33273427516527
curr_Factors:  [97.33273428]
mat_Sqrt:  [[0.15]]
grads:  [0.0631292]
Stock Position:  0.06312920165890572
Bond Position:  [-10.57125909]


portfolio before change:  [-4.4514177]
curr_Stock_Price:  96.96246305791043
curr_Factors:  [96.96246306]
mat_Sqrt:  [[0.15]]
grads:  [-0.08574394]
Stock Position:  -0.08574394412628958
Bond Position:  [3.86252632]


portfolio before change:  [-4.47566156]
curr_Stock_Price:  97.25084151234185
curr_Factors:  [97.25084151]
mat_Sqrt:  [[0.15]]
grads:  [0.02088983]
Stock Position:  0.020889829996320518
Bond Position:  [-6.5072151]


portfolio before change:  [-4.5015257]
curr_Stock_Price:  96.051660263027
curr_Factors:  [96.05166026]
mat_Sqrt:  [[0.15]]
grads:  [0.0373226]
Stock Position:  0.037322595951178955
Bond Position:  [-8.08642301]


portfolio before change:  [-4.48416108]
curr_Stock_Price:  96.5440024984309
curr_Factors:  [96.5440025]
mat_Sqrt:  [[0.15]]
grads:  [0.02368535]
Stock Position:  0.02368535418427502
Bond Position:  [-6.77083997]


portfolio before change:  [-4.49230337]
curr_Stock_Price:  96.23596879160804
curr_Factors:  [96.23596879]
mat_Sqrt:  [[0.15]]
grads:  [0.07473902]
Stock Position:  0.074739022381483
Bond Position:  [-11.6848856]


portfolio before change:  [-4.45938008]
curr_Stock_Price:  96.69602298035605
curr_Factors:  [96.69602298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.45938008]
Stock Price:  96.12557371269295
PL:  [-4.45938008]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.83893452e-03]
 [-1.12942357e-02]
 [ 5.04871244e-03]
 [-2.24660523e-03]
 [ 2.90137828e-03]
 [ 1.92348815e-03]
 [-2.85570532e-03]
 [ 1.74888761e-02]
 [-5.94356394e-03]
 [-1.31139315e-03]
 [ 9.83770117e-03]
 [ 4.81069849e-03]
 [ 1.39322065e-02]
 [ 5.36432103e-03]
 [ 1.27914155e-02]
 [-8.60051296e-04]
 [ 8.93042760e-03]
 [ 1.30184817e-02]
 [ 1.14481446e-02]
 [-1.46075975e-02]
 [-7.37420699e-03]
 [ 2.56395605e-02]
 [-3.52191299e-02]
 [ 4.59855761e-03]
 [-1.54795804e-03]
 [-1.02526968e-02]
 [-5.91430381e-04]
 [-1.11063501e-02]
 [ 5.87476411e-02]
 [-4.21586841e-03]
 [-1.26684773e-02]
 [ 3.98114745e-03]
 [ 6.96039610e-03]
 [ 4.02182931e-03]
 [ 8.17048645e-03]
 [ 2.58145319e-03]
 [-6.03875653e-02]
 [ 9.36252101e-03]
 [-1.96346480e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.15642271]
curr_Stock_Price:  100.01317351662149
curr_Factors:  [100.01317352]
mat_Sqrt:  [[0.15]]
grads:  [0.0255929]
Stock Position:  0.025592896808035722
Bond Position:  [-0.40320412]


portfolio before change:  [2.12266452]
curr_Stock_Price:  98.69609786757692
curr_Factors:  [98.69609787]
mat_Sqrt:  [[0.15]]
grads:  [-0.0752949]
Stock Position:  -0.07529490493939944
Bond Position:  [9.55397783]


portfolio before change:  [2.05580425]
curr_Stock_Price:  99.5999385250751
curr_Factors:  [99.59993853]
mat_Sqrt:  [[0.15]]
grads:  [0.03365808]
Stock Position:  0.03365808290048022
Bond Position:  [-1.29653874]


portfolio before change:  [2.05452211]
curr_Stock_Price:  99.5666610651023
curr_Factors:  [99.56666107]
mat_Sqrt:  [[0.15]]
grads:  [-0.01497737]
Stock Position:  -0.014977368175537095
Bond Position:  [3.54576865]


portfolio before change:  [2.06295211]
curr_Stock_Price:  99.03340702373086
curr_Factors:  [99.03340702]
mat_Sqrt:  [[0.15]]
grads:  [0.01934252]
Stock Position:  0.019342521878027742
Bond Position:  [0.14739626]


portfolio before change:  [2.07091991]
curr_Stock_Price:  99.44438627791938
curr_Factors:  [99.44438628]
mat_Sqrt:  [[0.15]]
grads:  [0.01282325]
Stock Position:  0.012823254361802724
Bond Position:  [0.79571925]


portfolio before change:  [2.07907195]
curr_Stock_Price:  100.07235275957969
curr_Factors:  [100.07235276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903804]
Stock Position:  -0.01903803547899431
Bond Position:  [3.98425295]


portfolio before change:  [2.06729276]
curr_Stock_Price:  100.71723298942175
curr_Factors:  [100.71723299]
mat_Sqrt:  [[0.15]]
grads:  [0.11659251]
Stock Position:  0.11659250712339173
Bond Position:  [-9.67558194]


portfolio before change:  [2.00258492]
curr_Stock_Price:  100.17261554612205
curr_Factors:  [100.17261555]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962376]
Stock Position:  -0.03962375957053182
Bond Position:  [5.97180056]


portfolio before change:  [1.96112272]
curr_Stock_Price:  101.23785344374176
curr_Factors:  [101.23785344]
mat_Sqrt:  [[0.15]]
grads:  [-0.00874262]
Stock Position:  -0.008742620978488018
Bond Position:  [2.8462069]


portfolio before change:  [1.95874703]
curr_Stock_Price:  101.55028655736379
curr_Factors:  [101.55028656]
mat_Sqrt:  [[0.15]]
grads:  [0.06558467]
Stock Position:  0.06558467447892292
Bond Position:  [-4.70139546]


portfolio before change:  [1.94783232]
curr_Stock_Price:  101.39282598267906
curr_Factors:  [101.39282598]
mat_Sqrt:  [[0.15]]
grads:  [0.03207132]
Stock Position:  0.03207132326502905
Bond Position:  [-1.30396978]


portfolio before change:  [1.88883932]
curr_Stock_Price:  99.55847711486568
curr_Factors:  [99.55847711]
mat_Sqrt:  [[0.15]]
grads:  [0.09288138]
Stock Position:  0.09288137641011956
Bond Position:  [-7.35828907]


portfolio before change:  [1.92086394]
curr_Stock_Price:  99.9131711522322
curr_Factors:  [99.91317115]
mat_Sqrt:  [[0.15]]
grads:  [0.03576214]
Stock Position:  0.035762140230155066
Bond Position:  [-1.65224489]


portfolio before change:  [1.90380005]
curr_Stock_Price:  99.44179703293696
curr_Factors:  [99.44179703]
mat_Sqrt:  [[0.15]]
grads:  [0.0852761]
Stock Position:  0.08527610353071235
Bond Position:  [-6.57620893]


portfolio before change:  [1.96124644]
curr_Stock_Price:  100.12508890652788
curr_Factors:  [100.12508891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573368]
Stock Position:  -0.005733675306788634
Bond Position:  [2.53533119]


portfolio before change:  [1.95297648]
curr_Stock_Price:  101.62271503705196
curr_Factors:  [101.62271504]
mat_Sqrt:  [[0.15]]
grads:  [0.05953618]
Stock Position:  0.05953618403246036
Bond Position:  [-4.09725219]


portfolio before change:  [1.95508056]
curr_Stock_Price:  101.66665923445257
curr_Factors:  [101.66665923]
mat_Sqrt:  [[0.15]]
grads:  [0.08678988]
Stock Position:  0.08678987791080349
Bond Position:  [-6.86855638]


portfolio before change:  [1.99799405]
curr_Stock_Price:  102.1710050370694
curr_Factors:  [102.17100504]
mat_Sqrt:  [[0.15]]
grads:  [0.07632096]
Stock Position:  0.07632096376473571
Bond Position:  [-5.79979553]


portfolio before change:  [2.02469261]
curr_Stock_Price:  102.53032422869687
curr_Factors:  [102.53032423]
mat_Sqrt:  [[0.15]]
grads:  [-0.09738398]
Stock Position:  -0.09738398303431395
Bond Position:  [12.00950397]


portfolio before change:  [2.04879911]
curr_Stock_Price:  102.29819966363557
curr_Factors:  [102.29819966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04916138]
Stock Position:  -0.04916137992084693
Bond Position:  [7.07791977]


portfolio before change:  [2.03333466]
curr_Stock_Price:  102.63076242037525
curr_Factors:  [102.63076242]
mat_Sqrt:  [[0.15]]
grads:  [0.1709304]
Stock Position:  0.17093040359782552
Bond Position:  [-15.50938298]


portfolio before change:  [2.00253503]
curr_Stock_Price:  102.46191689030647
curr_Factors:  [102.46191689]
mat_Sqrt:  [[0.15]]
grads:  [-0.2347942]
Stock Position:  -0.23479419944847837
Bond Position:  [26.05999878]


portfolio before change:  [2.13146071]
curr_Stock_Price:  101.92669084271962
curr_Factors:  [101.92669084]
mat_Sqrt:  [[0.15]]
grads:  [0.03065705]
Stock Position:  0.030657050753589682
Bond Position:  [-0.99331103]


portfolio before change:  [2.15302911]
curr_Stock_Price:  102.63427935331855
curr_Factors:  [102.63427935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01031972]
Stock Position:  -0.010319720288834665
Bond Position:  [3.21218617]


portfolio before change:  [2.14505147]
curr_Stock_Price:  103.44623848009739
curr_Factors:  [103.44623848]
mat_Sqrt:  [[0.15]]
grads:  [-0.06835131]
Stock Position:  -0.06835131215493301
Bond Position:  [9.21573761]


portfolio before change:  [2.10448988]
curr_Stock_Price:  104.05652128954658
curr_Factors:  [104.05652129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00394287]
Stock Position:  -0.003942869206816606
Bond Position:  [2.51477113]


portfolio before change:  [2.10167621]
curr_Stock_Price:  104.84986208975356
curr_Factors:  [104.84986209]
mat_Sqrt:  [[0.15]]
grads:  [-0.07404233]
Stock Position:  -0.07404233376830247
Bond Position:  [9.86500469]


portfolio before change:  [2.09280427]
curr_Stock_Price:  104.98633997588247
curr_Factors:  [104.98633998]
mat_Sqrt:  [[0.15]]
grads:  [0.39165094]
Stock Position:  0.39165094038243636
Bond Position:  [-39.02519451]


portfolio before change:  [2.06869602]
curr_Stock_Price:  104.9372406590534
curr_Factors:  [104.93724066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02810579]
Stock Position:  -0.028105789408431735
Bond Position:  [5.01804001]


portfolio before change:  [2.0065784]
curr_Stock_Price:  107.16969564908602
curr_Factors:  [107.16969565]
mat_Sqrt:  [[0.15]]
grads:  [-0.08445652]
Stock Position:  -0.0844565151324705
Bond Position:  [11.05775743]


portfolio before change:  [1.95185544]
curr_Stock_Price:  107.83400520642182
curr_Factors:  [107.83400521]
mat_Sqrt:  [[0.15]]
grads:  [0.02654098]
Stock Position:  0.02654098298534191
Bond Position:  [-0.91016506]


portfolio before change:  [1.95197104]
curr_Stock_Price:  107.84264773604464
curr_Factors:  [107.84264774]
mat_Sqrt:  [[0.15]]
grads:  [0.04640264]
Stock Position:  0.04640264067356727
Bond Position:  [-3.05221259]


portfolio before change:  [1.9582307]
curr_Stock_Price:  107.98576897824113
curr_Factors:  [107.98576898]
mat_Sqrt:  [[0.15]]
grads:  [0.0268122]
Stock Position:  0.02681219538035852
Bond Position:  [-0.93710484]


portfolio before change:  [1.93141762]
curr_Stock_Price:  106.99010541525577
curr_Factors:  [106.99010542]
mat_Sqrt:  [[0.15]]
grads:  [0.05446991]
Stock Position:  0.05446990969649967
Bond Position:  [-3.89632376]


portfolio before change:  [2.03834686]
curr_Stock_Price:  108.96213566898693
curr_Factors:  [108.96213567]
mat_Sqrt:  [[0.15]]
grads:  [0.01720969]
Stock Position:  0.017209687908734894
Bond Position:  [0.16314251]


portfolio before change:  [2.02317879]
curr_Stock_Price:  108.0795821989022
curr_Factors:  [108.0795822]
mat_Sqrt:  [[0.15]]
grads:  [-0.40258377]
Stock Position:  -0.4025837687791663
Bond Position:  [45.53426432]


portfolio before change:  [2.07661605]
curr_Stock_Price:  107.96098545297427
curr_Factors:  [107.96098545]
mat_Sqrt:  [[0.15]]
grads:  [0.06241681]
Stock Position:  0.062416806704603776
Bond Position:  [-4.66196391]


portfolio before change:  [2.13026216]
curr_Stock_Price:  108.82980423335853
curr_Factors:  [108.82980423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.13026216]
Stock Price:  109.4172538631208
PL:  [-7.2869917]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.88978889e-03]
 [ 2.32167766e-03]
 [ 7.60636343e-03]
 [-2.25476174e-03]
 [ 1.49999495e-02]
 [ 2.78918348e-02]
 [ 2.44918427e-02]
 [ 8.23500416e-03]
 [-1.00428889e-02]
 [-2.70995201e-03]
 [ 1.57785576e-02]
 [ 4.91096965e-03]
 [ 1.16418811e-02]
 [ 4.27629223e-03]
 [ 4.17484045e-03]
 [-3.33446064e-03]
 [ 1.32565466e-02]
 [-8.62228817e-03]
 [ 5.49594958e-03]
 [-2.51572247e-03]
 [ 1.67796833e-02]
 [-1.56040163e-03]
 [ 2.32429862e-02]
 [ 4.21600001e-03]
 [ 1.35329154e-02]
 [ 5.62530295e-03]
 [ 3.01369841e-02]
 [-2.38594767e-02]
 [-4.76465570e-02]
 [ 1.04663217e-03]
 [-4.25996788e-03]
 [ 5.58602833e-03]
 [ 1.48399668e-02]
 [-1.31516511e-02]
 [ 3.29525737e-03]
 [ 5.58919805e-03]
 [ 4.26064198e-03]
 [ 1.02549841e-02]
 [-5.00760124e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.64778483]
curr_Stock_Price:  101.01251151408952
curr_Factors:  [101.01251151]
mat_Sqrt:  [[0.15]]
grads:  [0.04593193]
Stock Position:  0.04593192594739492
Bond Position:  [13.00808563]


portfolio before change:  [17.64459344]
curr_Stock_Price:  100.9076280880931
curr_Factors:  [100.90762809]
mat_Sqrt:  [[0.15]]
grads:  [0.01547785]
Stock Position:  0.015477851064086372
Bond Position:  [16.0827602]


portfolio before change:  [17.63435391]
curr_Stock_Price:  100.1161745612604
curr_Factors:  [100.11617456]
mat_Sqrt:  [[0.15]]
grads:  [0.05070909]
Stock Position:  0.05070908955065833
Bond Position:  [12.55755385]


portfolio before change:  [17.60734479]
curr_Stock_Price:  99.55258884317642
curr_Factors:  [99.55258884]
mat_Sqrt:  [[0.15]]
grads:  [-0.01503174]
Stock Position:  -0.015031744919110322
Bond Position:  [19.10379391]


portfolio before change:  [17.58885582]
curr_Stock_Price:  100.94145578937034
curr_Factors:  [100.94145579]
mat_Sqrt:  [[0.15]]
grads:  [0.09999966]
Stock Position:  0.09999966327636159
Bond Position:  [7.49474423]


portfolio before change:  [17.70268289]
curr_Stock_Price:  102.07036132383831
curr_Factors:  [102.07036132]
mat_Sqrt:  [[0.15]]
grads:  [0.18594557]
Stock Position:  0.1859455656366612
Bond Position:  [-1.27684818]


portfolio before change:  [17.83880636]
curr_Stock_Price:  102.8032805719152
curr_Factors:  [102.80328057]
mat_Sqrt:  [[0.15]]
grads:  [0.16327895]
Stock Position:  0.16327895130085296
Bond Position:  [1.05319452]


portfolio before change:  [17.78721824]
curr_Stock_Price:  102.48652340848341
curr_Factors:  [102.48652341]
mat_Sqrt:  [[0.15]]
grads:  [0.05490003]
Stock Position:  0.054900027765962166
Bond Position:  [12.16070526]


portfolio before change:  [17.8136525]
curr_Stock_Price:  102.94033146757232
curr_Factors:  [102.94033147]
mat_Sqrt:  [[0.15]]
grads:  [-0.06695259]
Stock Position:  -0.06695259249091245
Bond Position:  [24.70577456]


portfolio before change:  [17.89815052]
curr_Stock_Price:  101.72440231438601
curr_Factors:  [101.72440231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01806635]
Stock Position:  -0.018066346746899067
Bond Position:  [19.73593885]


portfolio before change:  [17.88230129]
curr_Stock_Price:  102.7382421047246
curr_Factors:  [102.7382421]
mat_Sqrt:  [[0.15]]
grads:  [0.10519038]
Stock Position:  0.10519038430242668
Bond Position:  [7.07522612]


portfolio before change:  [17.75117079]
curr_Stock_Price:  101.48323240010022
curr_Factors:  [101.4832324]
mat_Sqrt:  [[0.15]]
grads:  [0.0327398]
Stock Position:  0.032739797660330645
Bond Position:  [14.4286303]


portfolio before change:  [17.74056265]
curr_Stock_Price:  101.10412710048176
curr_Factors:  [101.1041271]
mat_Sqrt:  [[0.15]]
grads:  [0.07761254]
Stock Position:  0.07761254074759155
Bond Position:  [9.89361447]


portfolio before change:  [17.58932216]
curr_Stock_Price:  99.13953128523515
curr_Factors:  [99.13953129]
mat_Sqrt:  [[0.15]]
grads:  [0.02850861]
Stock Position:  0.028508614839481295
Bond Position:  [14.76299145]


portfolio before change:  [17.56563004]
curr_Stock_Price:  98.2437456628773
curr_Factors:  [98.24374566]
mat_Sqrt:  [[0.15]]
grads:  [0.02783227]
Stock Position:  0.027832269696945067
Bond Position:  [14.83128362]


portfolio before change:  [17.57779502]
curr_Stock_Price:  98.6142132043804
curr_Factors:  [98.6142132]
mat_Sqrt:  [[0.15]]
grads:  [-0.02222974]
Stock Position:  -0.02222973763177429
Bond Position:  [19.76996311]


portfolio before change:  [17.58266337]
curr_Stock_Price:  98.50638709519093
curr_Factors:  [98.5063871]
mat_Sqrt:  [[0.15]]
grads:  [0.08837698]
Stock Position:  0.08837697747238789
Bond Position:  [8.87696661]


portfolio before change:  [17.5421931]
curr_Stock_Price:  98.03590305182314
curr_Factors:  [98.03590305]
mat_Sqrt:  [[0.15]]
grads:  [-0.05748192]
Stock Position:  -0.05748192110565517
Bond Position:  [23.17748514]


portfolio before change:  [17.57819693]
curr_Stock_Price:  97.4599574145264
curr_Factors:  [97.45995741]
mat_Sqrt:  [[0.15]]
grads:  [0.03663966]
Stock Position:  0.0366396638896265
Bond Position:  [14.00729685]


portfolio before change:  [17.56828139]
curr_Stock_Price:  97.14154394978202
curr_Factors:  [97.14154395]
mat_Sqrt:  [[0.15]]
grads:  [-0.01677148]
Stock Position:  -0.016771483140523177
Bond Position:  [19.19748915]


portfolio before change:  [17.55806489]
curr_Stock_Price:  97.8937931567113
curr_Factors:  [97.89379316]
mat_Sqrt:  [[0.15]]
grads:  [0.11186456]
Stock Position:  0.1118645555211587
Bond Position:  [6.60721923]


portfolio before change:  [17.50298868]
curr_Stock_Price:  97.3940623359396
curr_Factors:  [97.39406234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01040268]
Stock Position:  -0.010402677561567458
Bond Position:  [18.5161477]


portfolio before change:  [17.50854006]
curr_Stock_Price:  97.08291959930791
curr_Factors:  [97.0829196]
mat_Sqrt:  [[0.15]]
grads:  [0.15495324]
Stock Position:  0.15495324128409513
Bond Position:  [2.46522699]


portfolio before change:  [17.47838647]
curr_Stock_Price:  96.8863328063852
curr_Factors:  [96.88633281]
mat_Sqrt:  [[0.15]]
grads:  [0.02810667]
Stock Position:  0.028106666707183675
Bond Position:  [14.7552346]


portfolio before change:  [17.44764598]
curr_Stock_Price:  95.72699920011809
curr_Factors:  [95.7269992]
mat_Sqrt:  [[0.15]]
grads:  [0.09021944]
Stock Position:  0.09021943588274217
Bond Position:  [8.81121012]


portfolio before change:  [17.3772763]
curr_Stock_Price:  94.93480678174492
curr_Factors:  [94.93480678]
mat_Sqrt:  [[0.15]]
grads:  [0.03750202]
Stock Position:  0.03750201964935625
Bond Position:  [13.81702931]


portfolio before change:  [17.35658489]
curr_Stock_Price:  94.33700831274946
curr_Factors:  [94.33700831]
mat_Sqrt:  [[0.15]]
grads:  [0.20091323]
Stock Position:  0.20091322710980714
Bond Position:  [-1.59696789]


portfolio before change:  [17.45280658]
curr_Stock_Price:  94.81692360076474
curr_Factors:  [94.8169236]
mat_Sqrt:  [[0.15]]
grads:  [-0.15906318]
Stock Position:  -0.15906317799707087
Bond Position:  [32.53468778]


portfolio before change:  [17.33333687]
curr_Stock_Price:  95.59357605716998
curr_Factors:  [95.59357606]
mat_Sqrt:  [[0.15]]
grads:  [-0.31764371]
Stock Position:  -0.31764371326488816
Bond Position:  [47.69803533]


portfolio before change:  [17.29160201]
curr_Stock_Price:  95.74373637448524
curr_Factors:  [95.74373637]
mat_Sqrt:  [[0.15]]
grads:  [0.00697755]
Stock Position:  0.006977547779926308
Bond Position:  [16.62354552]


portfolio before change:  [17.29000209]
curr_Stock_Price:  95.21661747056532
curr_Factors:  [95.21661747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02839979]
Stock Position:  -0.02839978589640288
Bond Position:  [19.99413364]


portfolio before change:  [17.3236187]
curr_Stock_Price:  94.1209335042532
curr_Factors:  [94.1209335]
mat_Sqrt:  [[0.15]]
grads:  [0.03724019]
Stock Position:  0.03724018883923412
Bond Position:  [13.81853736]


portfolio before change:  [17.36121358]
curr_Stock_Price:  95.08407186395256
curr_Factors:  [95.08407186]
mat_Sqrt:  [[0.15]]
grads:  [0.09893311]
Stock Position:  0.09893311216559357
Bond Position:  [7.95425043]


portfolio before change:  [17.37119546]
curr_Stock_Price:  95.17491640450244
curr_Factors:  [95.1749164]
mat_Sqrt:  [[0.15]]
grads:  [-0.08767767]
Stock Position:  -0.08767767388782771
Bond Position:  [25.71591074]


portfolio before change:  [17.35466167]
curr_Stock_Price:  95.4001559657854
curr_Factors:  [95.40015597]
mat_Sqrt:  [[0.15]]
grads:  [0.02196838]
Stock Position:  0.02196838249307672
Bond Position:  [15.25887455]


portfolio before change:  [17.36675021]
curr_Stock_Price:  95.86359749372598
curr_Factors:  [95.86359749]
mat_Sqrt:  [[0.15]]
grads:  [0.03726132]
Stock Position:  0.03726132036202882
Bond Position:  [13.79474599]


portfolio before change:  [17.33684381]
curr_Stock_Price:  95.01470517850436
curr_Factors:  [95.01470518]
mat_Sqrt:  [[0.15]]
grads:  [0.02840428]
Stock Position:  0.028404279856568022
Bond Position:  [14.63801953]


portfolio before change:  [17.34044604]
curr_Stock_Price:  95.07710281563382
curr_Factors:  [95.07710282]
mat_Sqrt:  [[0.15]]
grads:  [0.06836656]
Stock Position:  0.06836656075038798
Bond Position:  [10.84035151]


portfolio before change:  [17.34912517]
curr_Stock_Price:  95.1842313176047
curr_Factors:  [95.18423132]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.34912517]
Stock Price:  95.07434813760796
PL:  [17.34912517]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.23815201e-03]
 [ 2.90387011e-03]
 [ 6.13993087e-03]
 [-2.56151772e-04]
 [ 1.53582963e-02]
 [ 2.12215711e-02]
 [-4.82863832e-03]
 [ 2.15082798e-02]
 [-6.00483309e-03]
 [-1.20934731e-03]
 [-1.17839389e-02]
 [ 7.59112764e-03]
 [ 1.38774575e-02]
 [-5.89921310e-04]
 [-2.20700938e-03]
 [-9.96517151e-03]
 [ 2.48479152e-02]
 [-3.86793817e-02]
 [ 1.21366882e-03]
 [ 6.85724437e-03]
 [ 2.63692236e-02]
 [-2.09419480e-03]
 [ 2.33388765e-02]
 [ 4.18058783e-03]
 [ 1.65163845e-02]
 [-6.71484780e-03]
 [ 2.18783899e-02]
 [-2.18114618e-02]
 [-4.77222470e-02]
 [ 1.32131457e-03]
 [-4.28338960e-03]
 [ 5.58446051e-03]
 [ 1.24408649e-02]
 [-1.28620828e-02]
 [ 2.82540350e-03]
 [ 5.70860640e-03]
 [ 3.63043994e-03]
 [ 1.09655036e-02]
 [-2.94251928e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.68737423]
curr_Stock_Price:  100.04742486430477
curr_Factors:  [100.04742486]
mat_Sqrt:  [[0.15]]
grads:  [0.02825435]
Stock Position:  0.028254346725686896
Bond Position:  [-0.1394004]


portfolio before change:  [2.68061053]
curr_Stock_Price:  99.80865537315282
curr_Factors:  [99.80865537]
mat_Sqrt:  [[0.15]]
grads:  [0.01935913]
Stock Position:  0.019359134090794358
Bond Position:  [0.74840138]


portfolio before change:  [2.67933928]
curr_Stock_Price:  99.73815633375655
curr_Factors:  [99.73815633]
mat_Sqrt:  [[0.15]]
grads:  [0.04093287]
Stock Position:  0.0409328724434518
Bond Position:  [-1.40322995]


portfolio before change:  [2.7314811]
curr_Stock_Price:  101.01627893677708
curr_Factors:  [101.01627894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00170768]
Stock Position:  -0.0017076784813937703
Bond Position:  [2.90398442]


portfolio before change:  [2.73254312]
curr_Stock_Price:  100.60695009881134
curr_Factors:  [100.6069501]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-7.56846589]


portfolio before change:  [2.70314527]
curr_Stock_Price:  100.32907028957324
curr_Factors:  [100.32907029]
mat_Sqrt:  [[0.15]]
grads:  [0.14147714]
Stock Position:  0.14147714092859895
Bond Position:  [-11.49112475]


portfolio before change:  [2.62860971]
curr_Stock_Price:  99.81238557365721
curr_Factors:  [99.81238557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03219092]
Stock Position:  -0.032190922111498495
Bond Position:  [5.84166244]


portfolio before change:  [2.6209199]
curr_Stock_Price:  100.0739518456853
curr_Factors:  [100.07395185]
mat_Sqrt:  [[0.15]]
grads:  [0.14338853]
Stock Position:  0.14338853201862062
Bond Position:  [-11.72853715]


portfolio before change:  [2.35707947]
curr_Stock_Price:  98.24413834567814
curr_Factors:  [98.24413835]
mat_Sqrt:  [[0.15]]
grads:  [-0.04003222]
Stock Position:  -0.04003222060267048
Bond Position:  [6.29001049]


portfolio before change:  [2.3785891]
curr_Stock_Price:  97.72647208734531
curr_Factors:  [97.72647209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00806232]
Stock Position:  -0.008062315430224756
Bond Position:  [3.16649075]


portfolio before change:  [2.39175414]
curr_Stock_Price:  96.14265861718485
curr_Factors:  [96.14265862]
mat_Sqrt:  [[0.15]]
grads:  [-0.07855959]
Stock Position:  -0.0785595926623814
Bond Position:  [9.94468224]


portfolio before change:  [2.36363362]
curr_Stock_Price:  96.5164345513464
curr_Factors:  [96.51643455]
mat_Sqrt:  [[0.15]]
grads:  [0.05060752]
Stock Position:  0.050607517571782376
Bond Position:  [-2.52082354]


portfolio before change:  [2.3198001]
curr_Stock_Price:  95.65651490465538
curr_Factors:  [95.6565149]
mat_Sqrt:  [[0.15]]
grads:  [0.09251638]
Stock Position:  0.0925163831981904
Bond Position:  [-6.52999469]


portfolio before change:  [2.34097415]
curr_Stock_Price:  95.89420637989183
curr_Factors:  [95.89420638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00393281]
Stock Position:  -0.003932808733065997
Bond Position:  [2.71810773]


portfolio before change:  [2.33843546]
curr_Stock_Price:  96.62612129254676
curr_Factors:  [96.62612129]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147134]
Stock Position:  -0.01471339586992004
Bond Position:  [3.76013383]


portfolio before change:  [2.36065231]
curr_Stock_Price:  95.14809344181357
curr_Factors:  [95.14809344]
mat_Sqrt:  [[0.15]]
grads:  [-0.06643448]
Stock Position:  -0.06643447674977007
Bond Position:  [8.68176611]


portfolio before change:  [2.43985754]
curr_Stock_Price:  93.97219885861303
curr_Factors:  [93.97219886]
mat_Sqrt:  [[0.15]]
grads:  [0.16565277]
Stock Position:  0.16565276795324813
Bond Position:  [-13.12689731]


portfolio before change:  [2.52090027]
curr_Stock_Price:  94.47133744532998
curr_Factors:  [94.47133745]
mat_Sqrt:  [[0.15]]
grads:  [-0.25786254]
Stock Position:  -0.25786254453972784
Bond Position:  [26.88151973]


portfolio before change:  [2.45162389]
curr_Stock_Price:  94.75302541750675
curr_Factors:  [94.75302542]
mat_Sqrt:  [[0.15]]
grads:  [0.00809113]
Stock Position:  0.008091125462449205
Bond Position:  [1.68496527]


portfolio before change:  [2.4508544]
curr_Stock_Price:  94.6318895193021
curr_Factors:  [94.63188952]
mat_Sqrt:  [[0.15]]
grads:  [0.04571496]
Stock Position:  0.045714962467285625
Bond Position:  [-1.87523888]


portfolio before change:  [2.45276339]
curr_Stock_Price:  94.67877588155318
curr_Factors:  [94.67877588]
mat_Sqrt:  [[0.15]]
grads:  [0.17579482]
Stock Position:  0.17579482389329046
Bond Position:  [-14.19127535]


portfolio before change:  [2.61271281]
curr_Stock_Price:  95.59873153402746
curr_Factors:  [95.59873153]
mat_Sqrt:  [[0.15]]
grads:  [-0.0139613]
Stock Position:  -0.013961298635990865
Bond Position:  [3.94739525]


portfolio before change:  [2.60043944]
curr_Stock_Price:  96.51317561777418
curr_Factors:  [96.51317562]
mat_Sqrt:  [[0.15]]
grads:  [0.15559251]
Stock Position:  0.15559251009774747
Bond Position:  [-12.41628782]


portfolio before change:  [2.64475014]
curr_Stock_Price:  96.80793813837136
curr_Factors:  [96.80793814]
mat_Sqrt:  [[0.15]]
grads:  [0.02787059]
Stock Position:  0.02787058551172951
Bond Position:  [-0.05334378]


portfolio before change:  [2.65963553]
curr_Stock_Price:  97.34226696202211
curr_Factors:  [97.34226696]
mat_Sqrt:  [[0.15]]
grads:  [0.11010923]
Stock Position:  0.11010922978945319
Bond Position:  [-8.05864651]


portfolio before change:  [2.56306363]
curr_Stock_Price:  96.47436053115574
curr_Factors:  [96.47436053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04476565]
Stock Position:  -0.04476565198980119
Bond Position:  [6.88180128]


portfolio before change:  [2.56913931]
curr_Stock_Price:  96.35785603310008
curr_Factors:  [96.35785603]
mat_Sqrt:  [[0.15]]
grads:  [0.14585593]
Stock Position:  0.1458559327708645
Bond Position:  [-11.48522566]


portfolio before change:  [2.50460088]
curr_Stock_Price:  95.92521895996146
curr_Factors:  [95.92521896]
mat_Sqrt:  [[0.15]]
grads:  [-0.14540975]
Stock Position:  -0.14540974529551107
Bond Position:  [16.45306254]


portfolio before change:  [2.48663618]
curr_Stock_Price:  96.06290891333938
curr_Factors:  [96.06290891]
mat_Sqrt:  [[0.15]]
grads:  [-0.31814831]
Stock Position:  -0.3181483133856645
Bond Position:  [33.04888863]


portfolio before change:  [2.67366675]
curr_Stock_Price:  95.4880223172374
curr_Factors:  [95.48802232]
mat_Sqrt:  [[0.15]]
grads:  [0.00880876]
Stock Position:  0.008808763786252751
Bond Position:  [1.83253532]


portfolio before change:  [2.6700123]
curr_Stock_Price:  95.04715045092529
curr_Factors:  [95.04715045]
mat_Sqrt:  [[0.15]]
grads:  [-0.02855593]
Stock Position:  -0.02855593065889142
Bond Position:  [5.38417213]


portfolio before change:  [2.67992513]
curr_Stock_Price:  94.72358290164517
curr_Factors:  [94.7235829]
mat_Sqrt:  [[0.15]]
grads:  [0.03722974]
Stock Position:  0.03722973674545201
Bond Position:  [-0.84660892]


portfolio before change:  [2.73103215]
curr_Stock_Price:  96.09917280828266
curr_Factors:  [96.09917281]
mat_Sqrt:  [[0.15]]
grads:  [0.0829391]
Stock Position:  0.08293909947469985
Bond Position:  [-5.2393467]


portfolio before change:  [2.79847024]
curr_Stock_Price:  96.92017339072869
curr_Factors:  [96.92017339]
mat_Sqrt:  [[0.15]]
grads:  [-0.08574722]
Stock Position:  -0.08574721879758639
Bond Position:  [11.10910555]


portfolio before change:  [2.83230417]
curr_Stock_Price:  96.541791432446
curr_Factors:  [96.54179143]
mat_Sqrt:  [[0.15]]
grads:  [0.01883602]
Stock Position:  0.018836023331751356
Bond Position:  [1.01384073]


portfolio before change:  [2.85103228]
curr_Stock_Price:  97.52933421599668
curr_Factors:  [97.52933422]
mat_Sqrt:  [[0.15]]
grads:  [0.03805738]
Stock Position:  0.03805737596976697
Bond Position:  [-0.86067826]


portfolio before change:  [2.82403649]
curr_Stock_Price:  96.8228167529427
curr_Factors:  [96.82281675]
mat_Sqrt:  [[0.15]]
grads:  [0.02420293]
Stock Position:  0.024202932941938694
Bond Position:  [0.48064035]


portfolio before change:  [2.80269386]
curr_Stock_Price:  95.93851437383
curr_Factors:  [95.93851437]
mat_Sqrt:  [[0.15]]
grads:  [0.07310336]
Stock Position:  0.07310335708144967
Bond Position:  [-4.21073361]


portfolio before change:  [2.84943621]
curr_Stock_Price:  96.58511556759098
curr_Factors:  [96.58511557]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.84943621]
Stock Price:  97.81582897990032
PL:  [2.84943621]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.48544653e-03]
 [ 4.12586047e-03]
 [ 6.60617659e-03]
 [-1.50472394e-03]
 [ 7.81455507e-03]
 [-2.21032214e-02]
 [-5.13772072e-02]
 [ 2.23957820e-02]
 [-6.07625221e-03]
 [-7.77948412e-04]
 [ 6.23752671e-04]
 [ 5.37542605e-03]
 [ 1.12467158e-02]
 [ 4.07078479e-03]
 [ 1.93233004e-02]
 [-1.54844840e-03]
 [ 1.18009111e-02]
 [-2.66047105e-03]
 [ 1.15923156e-02]
 [-1.32887233e-02]
 [-9.37113374e-03]
 [ 2.10660298e-02]
 [-2.38089592e-02]
 [ 5.97175869e-03]
 [-3.69557817e-03]
 [-7.76049434e-03]
 [ 3.66510678e-03]
 [-1.11445408e-02]
 [-1.78392047e-02]
 [-9.61592326e-03]
 [-8.55179381e-04]
 [ 5.15661258e-03]
 [ 5.11795333e-03]
 [-3.93109721e-03]
 [ 7.93270770e-03]
 [ 4.95243904e-03]
 [-2.75914568e-02]
 [ 1.00493256e-02]
 [-1.20404317e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.33284641]
curr_Stock_Price:  100.15357323639924
curr_Factors:  [100.15357324]
mat_Sqrt:  [[0.15]]
grads:  [0.03656964]
Stock Position:  0.036569643506725556
Bond Position:  [0.67026594]


portfolio before change:  [4.32565786]
curr_Stock_Price:  99.95471066448135
curr_Factors:  [99.95471066]
mat_Sqrt:  [[0.15]]
grads:  [0.02750574]
Stock Position:  0.027505736454653634
Bond Position:  [1.57632993]


portfolio before change:  [4.32397215]
curr_Stock_Price:  99.886260907853
curr_Factors:  [99.88626091]
mat_Sqrt:  [[0.15]]
grads:  [0.04404118]
Stock Position:  0.04404117727813218
Bond Position:  [-0.07513637]


portfolio before change:  [4.28732907]
curr_Stock_Price:  99.05445552010532
curr_Factors:  [99.05445552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003149]
Stock Position:  -0.010031492915009602
Bond Position:  [5.28099314]


portfolio before change:  [4.28571743]
curr_Stock_Price:  99.28092348848246
curr_Factors:  [99.28092349]
mat_Sqrt:  [[0.15]]
grads:  [0.05209703]
Stock Position:  0.052097033806588824
Bond Position:  [-0.8865242]


portfolio before change:  [4.24548284]
curr_Stock_Price:  98.51074983977522
curr_Factors:  [98.51074984]
mat_Sqrt:  [[0.15]]
grads:  [-0.14735481]
Stock Position:  -0.14735480945120571
Bond Position:  [18.76151561]


portfolio before change:  [4.30413905]
curr_Stock_Price:  98.1286050375499
curr_Factors:  [98.12860504]
mat_Sqrt:  [[0.15]]
grads:  [-0.34251471]
Stock Position:  -0.34251471435088404
Bond Position:  [37.91463018]


portfolio before change:  [4.04797244]
curr_Stock_Price:  98.89034234805294
curr_Factors:  [98.89034235]
mat_Sqrt:  [[0.15]]
grads:  [0.14930521]
Stock Position:  0.1493052133436791
Bond Position:  [-10.71687122]


portfolio before change:  [3.9017983]
curr_Stock_Price:  97.92028614552162
curr_Factors:  [97.92028615]
mat_Sqrt:  [[0.15]]
grads:  [-0.04050835]
Stock Position:  -0.040508348083842655
Bond Position:  [7.86838733]


portfolio before change:  [3.90447955]
curr_Stock_Price:  97.87837778136496
curr_Factors:  [97.87837778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00518632]
Stock Position:  -0.005186322746046846
Bond Position:  [4.4121084]


portfolio before change:  [3.90096777]
curr_Stock_Price:  98.66184638177005
curr_Factors:  [98.66184638]
mat_Sqrt:  [[0.15]]
grads:  [0.00415835]
Stock Position:  0.004158351140920938
Bond Position:  [3.49069717]


portfolio before change:  [3.90452054]
curr_Stock_Price:  99.41127932057032
curr_Factors:  [99.41127932]
mat_Sqrt:  [[0.15]]
grads:  [0.03583617]
Stock Position:  0.03583617368584222
Bond Position:  [0.34200067]


portfolio before change:  [3.92120694]
curr_Stock_Price:  99.87571629257418
curr_Factors:  [99.87571629]
mat_Sqrt:  [[0.15]]
grads:  [0.07497811]
Stock Position:  0.07497810532550678
Bond Position:  [-3.56728504]


portfolio before change:  [3.95201091]
curr_Stock_Price:  100.29250342902408
curr_Factors:  [100.29250343]
mat_Sqrt:  [[0.15]]
grads:  [0.02713857]
Stock Position:  0.027138565277258383
Bond Position:  [1.23021626]


portfolio before change:  [3.95103611]
curr_Stock_Price:  100.25091714211364
curr_Factors:  [100.25091714]
mat_Sqrt:  [[0.15]]
grads:  [0.128822]
Stock Position:  0.12882200276962819
Bond Position:  [-8.96348782]


portfolio before change:  [3.90471829]
curr_Stock_Price:  99.90006628274827
curr_Factors:  [99.90006628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01032299]
Stock Position:  -0.010322989336383714
Bond Position:  [4.93598561]


portfolio before change:  [3.91387348]
curr_Stock_Price:  99.07296488471803
curr_Factors:  [99.07296488]
mat_Sqrt:  [[0.15]]
grads:  [0.07867274]
Stock Position:  0.07867274072110328
Bond Position:  [-3.88046819]


portfolio before change:  [3.90500245]
curr_Stock_Price:  98.96637216412914
curr_Factors:  [98.96637216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01773647]
Stock Position:  -0.0177364736413424
Bond Position:  [5.66031691]


portfolio before change:  [3.88370269]
curr_Stock_Price:  100.2071682724043
curr_Factors:  [100.20716827]
mat_Sqrt:  [[0.15]]
grads:  [0.0772821]
Stock Position:  0.07728210384155525
Bond Position:  [-3.86051809]


portfolio before change:  [3.9580654]
curr_Stock_Price:  101.17563707175952
curr_Factors:  [101.17563707]
mat_Sqrt:  [[0.15]]
grads:  [-0.08859149]
Stock Position:  -0.08859148881504275
Bond Position:  [12.92136572]


portfolio before change:  [3.88116246]
curr_Stock_Price:  102.06193232775809
curr_Factors:  [102.06193233]
mat_Sqrt:  [[0.15]]
grads:  [-0.06247422]
Stock Position:  -0.06247422492960513
Bond Position:  [10.25740257]


portfolio before change:  [3.92394472]
curr_Stock_Price:  101.39765819081292
curr_Factors:  [101.39765819]
mat_Sqrt:  [[0.15]]
grads:  [0.1404402]
Stock Position:  0.1404401989789354
Bond Position:  [-10.31636257]


portfolio before change:  [3.93326733]
curr_Stock_Price:  101.4732222603284
curr_Factors:  [101.47322226]
mat_Sqrt:  [[0.15]]
grads:  [-0.15872639]
Stock Position:  -0.15872639487245033
Bond Position:  [20.03974608]


portfolio before change:  [3.7256217]
curr_Stock_Price:  102.7972034320165
curr_Factors:  [102.79720343]
mat_Sqrt:  [[0.15]]
grads:  [0.03981172]
Stock Position:  0.03981172457969562
Bond Position:  [-0.36691225]


portfolio before change:  [3.70740274]
curr_Stock_Price:  102.34072757643234
curr_Factors:  [102.34072758]
mat_Sqrt:  [[0.15]]
grads:  [-0.02463719]
Stock Position:  -0.024637187782676196
Bond Position:  [6.22879046]


portfolio before change:  [3.74508533]
curr_Stock_Price:  100.84283181710137
curr_Factors:  [100.84283182]
mat_Sqrt:  [[0.15]]
grads:  [-0.05173663]
Stock Position:  -0.05173662891718324
Bond Position:  [8.9623535]


portfolio before change:  [3.77372941]
curr_Stock_Price:  100.31083502006761
curr_Factors:  [100.31083502]
mat_Sqrt:  [[0.15]]
grads:  [0.02443405]
Stock Position:  0.024434045166851524
Bond Position:  [1.32272994]


portfolio before change:  [3.78803718]
curr_Stock_Price:  100.88963459821237
curr_Factors:  [100.8896346]
mat_Sqrt:  [[0.15]]
grads:  [-0.07429694]
Stock Position:  -0.07429693882559191
Bond Position:  [11.28382819]


portfolio before change:  [3.78273]
curr_Stock_Price:  100.98005214788145
curr_Factors:  [100.98005215]
mat_Sqrt:  [[0.15]]
grads:  [-0.11892803]
Stock Position:  -0.11892803165242492
Bond Position:  [15.79208884]


portfolio before change:  [3.75772657]
curr_Stock_Price:  101.20689150357754
curr_Factors:  [101.2068915]
mat_Sqrt:  [[0.15]]
grads:  [-0.06410616]
Stock Position:  -0.06410615505255651
Bond Position:  [10.24571125]


portfolio before change:  [3.74591708]
curr_Stock_Price:  101.41108862456542
curr_Factors:  [101.41108862]
mat_Sqrt:  [[0.15]]
grads:  [-0.0057012]
Stock Position:  -0.005701195876178716
Bond Position:  [4.32408156]


portfolio before change:  [3.74470998]
curr_Stock_Price:  101.71762841745254
curr_Factors:  [101.71762842]
mat_Sqrt:  [[0.15]]
grads:  [0.03437742]
Stock Position:  0.03437741720837047
Bond Position:  [0.24792063]


portfolio before change:  [3.7677771]
curr_Stock_Price:  102.3877231808209
curr_Factors:  [102.38772318]
mat_Sqrt:  [[0.15]]
grads:  [0.03411969]
Stock Position:  0.03411968886660323
Bond Position:  [0.27433984]


portfolio before change:  [3.82855866]
curr_Stock_Price:  104.16814010065691
curr_Factors:  [104.1681401]
mat_Sqrt:  [[0.15]]
grads:  [-0.02620731]
Stock Position:  -0.02620731470267699
Bond Position:  [6.55852589]


portfolio before change:  [3.8452242]
curr_Stock_Price:  103.56351230556943
curr_Factors:  [103.56351231]
mat_Sqrt:  [[0.15]]
grads:  [0.05288472]
Stock Position:  0.05288471797721223
Bond Position:  [-1.63170294]


portfolio before change:  [3.85383651]
curr_Stock_Price:  103.73021984663714
curr_Factors:  [103.73021985]
mat_Sqrt:  [[0.15]]
grads:  [0.03301626]
Stock Position:  0.03301626023626783
Bond Position:  [0.42905257]


portfolio before change:  [3.90508895]
curr_Stock_Price:  105.28093490759905
curr_Factors:  [105.28093491]
mat_Sqrt:  [[0.15]]
grads:  [-0.18394305]
Stock Position:  -0.18394304525922756
Bond Position:  [23.27078473]


portfolio before change:  [4.05866097]
curr_Stock_Price:  104.46186081727953
curr_Factors:  [104.46186082]
mat_Sqrt:  [[0.15]]
grads:  [0.0669955]
Stock Position:  0.06699550431416643
Bond Position:  [-2.93981408]


portfolio before change:  [4.06617758]
curr_Stock_Price:  104.57954201383873
curr_Factors:  [104.57954201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.06617758]
Stock Price:  104.2255533964743
PL:  [-0.15937582]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.21715484e-03]
 [ 2.47416041e-03]
 [ 1.43636243e-02]
 [-2.83285226e-03]
 [ 1.40581964e-02]
 [ 2.56800831e-02]
 [ 6.12120100e-04]
 [ 1.66750586e-02]
 [-5.90437191e-03]
 [ 2.80059641e-03]
 [ 2.05708597e-03]
 [ 7.50039162e-03]
 [ 1.38444317e-02]
 [ 4.16000735e-03]
 [ 4.38194455e-03]
 [-3.41524117e-03]
 [ 1.34941745e-02]
 [-9.73948376e-03]
 [ 5.64697584e-03]
 [-2.58240563e-03]
 [ 1.95645549e-02]
 [ 3.30281100e-03]
 [ 1.86949557e-02]
 [ 4.71248288e-03]
 [ 1.57462346e-02]
 [-4.61018651e-03]
 [ 2.03029961e-02]
 [-1.57135382e-02]
 [-3.16637537e-02]
 [-1.90179974e-03]
 [-3.84390062e-03]
 [ 5.60814216e-03]
 [ 9.13826376e-03]
 [-1.27344730e-02]
 [ 3.15701669e-03]
 [ 5.71274953e-03]
 [ 2.96127822e-03]
 [ 9.24035245e-03]
 [-7.79013220e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.96307512]
curr_Stock_Price:  101.41990690674704
curr_Factors:  [101.41990691]
mat_Sqrt:  [[0.15]]
grads:  [0.0614477]
Stock Position:  0.06144769893811856
Bond Position:  [17.73105521]


portfolio before change:  [23.93168733]
curr_Stock_Price:  100.87303025765453
curr_Factors:  [100.87303026]
mat_Sqrt:  [[0.15]]
grads:  [0.0164944]
Stock Position:  0.01649440274506142
Bond Position:  [22.26784694]


portfolio before change:  [23.93877727]
curr_Stock_Price:  101.13410601326547
curr_Factors:  [101.13410601]
mat_Sqrt:  [[0.15]]
grads:  [0.0957575]
Stock Position:  0.09575749537133041
Bond Position:  [14.25442858]


portfolio before change:  [23.83359543]
curr_Stock_Price:  100.01707848004719
curr_Factors:  [100.01707848]
mat_Sqrt:  [[0.15]]
grads:  [-0.01888568]
Stock Position:  -0.018885681712894013
Bond Position:  [25.72248614]


portfolio before change:  [23.83598926]
curr_Stock_Price:  100.06058677480512
curr_Factors:  [100.06058677]
mat_Sqrt:  [[0.15]]
grads:  [0.09372131]
Stock Position:  0.09372130926470087
Bond Position:  [14.45818006]


portfolio before change:  [23.89475596]
curr_Stock_Price:  100.66833887844284
curr_Factors:  [100.66833888]
mat_Sqrt:  [[0.15]]
grads:  [0.17120055]
Stock Position:  0.17120055402610151
Bond Position:  [6.66028058]


portfolio before change:  [23.88334108]
curr_Stock_Price:  100.59680016618888
curr_Factors:  [100.59680017]
mat_Sqrt:  [[0.15]]
grads:  [0.0040808]
Stock Position:  0.0040808006664606305
Bond Position:  [23.4728256]


portfolio before change:  [23.88717001]
curr_Stock_Price:  100.8160322790977
curr_Factors:  [100.81603228]
mat_Sqrt:  [[0.15]]
grads:  [0.11116706]
Stock Position:  0.11116705728635211
Bond Position:  [12.67974838]


portfolio before change:  [23.65607029]
curr_Stock_Price:  98.72292309678016
curr_Factors:  [98.7229231]
mat_Sqrt:  [[0.15]]
grads:  [-0.03936248]
Stock Position:  -0.03936247939996636
Bond Position:  [27.54204932]


portfolio before change:  [23.65959771]
curr_Stock_Price:  98.72077778899066
curr_Factors:  [98.72077779]
mat_Sqrt:  [[0.15]]
grads:  [0.01867064]
Stock Position:  0.018670642721033318
Bond Position:  [21.81641734]


portfolio before change:  [23.66778212]
curr_Stock_Price:  99.0130651123519
curr_Factors:  [99.01306511]
mat_Sqrt:  [[0.15]]
grads:  [0.01371391]
Stock Position:  0.013713906448179153
Bond Position:  [22.30992621]


portfolio before change:  [23.64298428]
curr_Stock_Price:  97.00147475309902
curr_Factors:  [97.00147475]
mat_Sqrt:  [[0.15]]
grads:  [0.05000261]
Stock Position:  0.05000261082430323
Bond Position:  [18.79265729]


portfolio before change:  [23.73187079]
curr_Stock_Price:  98.73212996882351
curr_Factors:  [98.73212997]
mat_Sqrt:  [[0.15]]
grads:  [0.09229621]
Stock Position:  0.09229621114835514
Bond Position:  [14.61926927]


portfolio before change:  [23.76730693]
curr_Stock_Price:  99.09626864461764
curr_Factors:  [99.09626864]
mat_Sqrt:  [[0.15]]
grads:  [0.02773338]
Stock Position:  0.027733382335717368
Bond Position:  [21.01903222]


portfolio before change:  [23.74715282]
curr_Stock_Price:  98.27481628884807
curr_Factors:  [98.27481629]
mat_Sqrt:  [[0.15]]
grads:  [0.02921296]
Stock Position:  0.029212963678377515
Bond Position:  [20.87625418]


portfolio before change:  [23.7335359]
curr_Stock_Price:  97.71935709451814
curr_Factors:  [97.71935709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276827]
Stock Position:  -0.022768274466111422
Bond Position:  [25.95843705]


portfolio before change:  [23.72096748]
curr_Stock_Price:  98.4138950643175
curr_Factors:  [98.41389506]
mat_Sqrt:  [[0.15]]
grads:  [0.08996116]
Stock Position:  0.08996116340730106
Bond Position:  [14.86753899]


portfolio before change:  [23.64436164]
curr_Stock_Price:  97.54169200317988
curr_Factors:  [97.541692]
mat_Sqrt:  [[0.15]]
grads:  [-0.06492989]
Stock Position:  -0.06492989176397533
Bond Position:  [29.97773314]


portfolio before change:  [23.64775666]
curr_Stock_Price:  97.54711982990786
curr_Factors:  [97.54711983]
mat_Sqrt:  [[0.15]]
grads:  [0.03764651]
Stock Position:  0.03764650558183826
Bond Position:  [19.97544847]


portfolio before change:  [23.635702]
curr_Stock_Price:  97.16058333236076
curr_Factors:  [97.16058333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721604]
Stock Position:  -0.017216037523688915
Bond Position:  [25.30842225]


portfolio before change:  [23.63369391]
curr_Stock_Price:  97.46099162636112
curr_Factors:  [97.46099163]
mat_Sqrt:  [[0.15]]
grads:  [0.13043037]
Stock Position:  0.13043036601015304
Bond Position:  [10.9218211]


portfolio before change:  [23.78346046]
curr_Stock_Price:  98.59877294875108
curr_Factors:  [98.59877295]
mat_Sqrt:  [[0.15]]
grads:  [0.02201874]
Stock Position:  0.022018740027071985
Bond Position:  [21.61243971]


portfolio before change:  [23.78305182]
curr_Stock_Price:  98.45751306466349
curr_Factors:  [98.45751306]
mat_Sqrt:  [[0.15]]
grads:  [0.12463304]
Stock Position:  0.12463303821985142
Bond Position:  [11.51199283]


portfolio before change:  [23.73101929]
curr_Stock_Price:  98.0284806680655
curr_Factors:  [98.02848067]
mat_Sqrt:  [[0.15]]
grads:  [0.03141655]
Stock Position:  0.03141655251450382
Bond Position:  [20.65130238]


portfolio before change:  [23.69780551]
curr_Stock_Price:  96.88910183599978
curr_Factors:  [96.88910184]
mat_Sqrt:  [[0.15]]
grads:  [0.1049749]
Stock Position:  0.10497489712936971
Bond Position:  [13.52688201]


portfolio before change:  [23.62554997]
curr_Stock_Price:  96.18468095151435
curr_Factors:  [96.18468095]
mat_Sqrt:  [[0.15]]
grads:  [-0.03073458]
Stock Position:  -0.03073457672225919
Bond Position:  [26.58174542]


portfolio before change:  [23.61184257]
curr_Stock_Price:  96.73879049339756
curr_Factors:  [96.73879049]
mat_Sqrt:  [[0.15]]
grads:  [0.13535331]
Stock Position:  0.13535330701850798
Bond Position:  [10.51792736]


portfolio before change:  [23.72125824]
curr_Stock_Price:  97.5374473632302
curr_Factors:  [97.53744736]
mat_Sqrt:  [[0.15]]
grads:  [-0.10475692]
Stock Position:  -0.10475692148390434
Bond Position:  [33.93898096]


portfolio before change:  [23.71487541]
curr_Stock_Price:  97.63887719045672
curr_Factors:  [97.63887719]
mat_Sqrt:  [[0.15]]
grads:  [-0.21109169]
Stock Position:  -0.21109169149579637
Bond Position:  [44.32563115]


portfolio before change:  [23.58253565]
curr_Stock_Price:  98.29205687321367
curr_Factors:  [98.29205687]
mat_Sqrt:  [[0.15]]
grads:  [-0.01267866]
Stock Position:  -0.01267866495259196
Bond Position:  [24.82874771]


portfolio before change:  [23.592489]
curr_Stock_Price:  97.75181398529554
curr_Factors:  [97.75181399]
mat_Sqrt:  [[0.15]]
grads:  [-0.025626]
Stock Position:  -0.025626004147847516
Bond Position:  [26.09747739]


portfolio before change:  [23.60629293]
curr_Stock_Price:  97.34045266796934
curr_Factors:  [97.34045267]
mat_Sqrt:  [[0.15]]
grads:  [0.03738761]
Stock Position:  0.037387614413079494
Bond Position:  [19.96696562]


portfolio before change:  [23.61522388]
curr_Stock_Price:  97.51256630410423
curr_Factors:  [97.5125663]
mat_Sqrt:  [[0.15]]
grads:  [0.06092176]
Stock Position:  0.060921758419429095
Bond Position:  [17.67458687]


portfolio before change:  [23.59890186]
curr_Stock_Price:  97.2083814808744
curr_Factors:  [97.20838148]
mat_Sqrt:  [[0.15]]
grads:  [-0.08489649]
Stock Position:  -0.08489648637924457
Bond Position:  [31.8515519]


portfolio before change:  [23.5946788]
curr_Stock_Price:  97.30502573856504
curr_Factors:  [97.30502574]
mat_Sqrt:  [[0.15]]
grads:  [0.02104678]
Stock Position:  0.021046777901817013
Bond Position:  [21.54672153]


portfolio before change:  [23.61448321]
curr_Stock_Price:  98.11801965137406
curr_Factors:  [98.11801965]
mat_Sqrt:  [[0.15]]
grads:  [0.038085]
Stock Position:  0.03808499683846971
Bond Position:  [19.87765874]


portfolio before change:  [23.6581773]
curr_Stock_Price:  99.20005262225698
curr_Factors:  [99.20005262]
mat_Sqrt:  [[0.15]]
grads:  [0.01974185]
Stock Position:  0.01974185482054456
Bond Position:  [21.69978426]


portfolio before change:  [23.66288024]
curr_Stock_Price:  99.30086919828877
curr_Factors:  [99.3008692]
mat_Sqrt:  [[0.15]]
grads:  [0.06160235]
Stock Position:  0.06160234964367752
Bond Position:  [17.54571338]


portfolio before change:  [23.73140068]
curr_Stock_Price:  100.37756657192418
curr_Factors:  [100.37756657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.73140068]
Stock Price:  100.73544295277179
PL:  [22.99595773]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.22848524e-03]
 [ 2.65990192e-03]
 [ 6.69637153e-03]
 [ 2.22010647e-03]
 [ 1.01004733e-02]
 [ 3.00314460e-02]
 [ 3.06339815e-02]
 [ 4.27791221e-03]
 [-9.27003983e-03]
 [-2.70226189e-03]
 [ 1.48907057e-02]
 [ 5.93742579e-03]
 [ 8.34676139e-03]
 [-4.01838248e-03]
 [ 4.85056322e-03]
 [ 3.55930569e-03]
 [ 9.22545451e-03]
 [-7.90249002e-03]
 [ 1.19527950e-02]
 [-1.55148290e-02]
 [ 4.52383804e-03]
 [ 3.72779865e-02]
 [-2.05420599e-02]
 [ 7.97388275e-03]
 [ 7.60287199e-03]
 [-2.61368460e-02]
 [ 8.50820919e-04]
 [-1.26540295e-02]
 [ 6.71326927e-02]
 [-2.09176030e-03]
 [-1.23909132e-02]
 [ 4.01480499e-03]
 [ 7.35421092e-03]
 [ 4.94069113e-03]
 [ 8.20696050e-03]
 [ 2.17673476e-03]
 [-7.51514900e-02]
 [ 8.98641158e-03]
 [ 1.42291374e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.06999535]
curr_Stock_Price:  100.84621994099459
curr_Factors:  [100.84621994]
mat_Sqrt:  [[0.15]]
grads:  [0.04152323]
Stock Position:  0.0415232349600731
Bond Position:  [10.88253406]


portfolio before change:  [15.07071904]
curr_Stock_Price:  100.83088612575133
curr_Factors:  [100.83088613]
mat_Sqrt:  [[0.15]]
grads:  [0.01773268]
Stock Position:  0.01773267946895949
Bond Position:  [13.28271726]


portfolio before change:  [15.05614101]
curr_Stock_Price:  99.91514901605561
curr_Factors:  [99.91514902]
mat_Sqrt:  [[0.15]]
grads:  [0.04464248]
Stock Position:  0.04464247686252933
Bond Position:  [10.59568128]


portfolio before change:  [15.12214556]
curr_Stock_Price:  101.36399353985635
curr_Factors:  [101.36399354]
mat_Sqrt:  [[0.15]]
grads:  [0.01480071]
Stock Position:  0.014800709779015122
Bond Position:  [13.62188651]


portfolio before change:  [15.13485954]
curr_Stock_Price:  102.10795348464913
curr_Factors:  [102.10795348]
mat_Sqrt:  [[0.15]]
grads:  [0.06733649]
Stock Position:  0.06733648860460864
Bond Position:  [8.25926849]


portfolio before change:  [15.17618389]
curr_Stock_Price:  102.70631973112346
curr_Factors:  [102.70631973]
mat_Sqrt:  [[0.15]]
grads:  [0.20020964]
Stock Position:  0.20020964005146524
Bond Position:  [-5.38661141]


portfolio before change:  [15.26107216]
curr_Stock_Price:  103.1336799463629
curr_Factors:  [103.13367995]
mat_Sqrt:  [[0.15]]
grads:  [0.20422654]
Stock Position:  0.20422654316024622
Bond Position:  [-5.80156278]


portfolio before change:  [15.2455934]
curr_Stock_Price:  103.06143900890308
curr_Factors:  [103.06143901]
mat_Sqrt:  [[0.15]]
grads:  [0.02851941]
Stock Position:  0.028519414741723266
Bond Position:  [12.30634148]


portfolio before change:  [15.22914069]
curr_Stock_Price:  102.43060204833867
curr_Factors:  [102.43060205]
mat_Sqrt:  [[0.15]]
grads:  [-0.06180027]
Stock Position:  -0.0618002655651826
Bond Position:  [21.5593791]


portfolio before change:  [15.17307965]
curr_Stock_Price:  103.38134445436337
curr_Factors:  [103.38134445]
mat_Sqrt:  [[0.15]]
grads:  [-0.01801508]
Stock Position:  -0.018015079261966816
Bond Position:  [17.03550276]


portfolio before change:  [15.1892849]
curr_Stock_Price:  102.60001653191065
curr_Factors:  [102.60001653]
mat_Sqrt:  [[0.15]]
grads:  [0.09927137]
Stock Position:  0.09927137165230367
Bond Position:  [5.00404053]


portfolio before change:  [15.14870566]
curr_Stock_Price:  102.18494430065832
curr_Factors:  [102.1849443]
mat_Sqrt:  [[0.15]]
grads:  [0.03958284]
Stock Position:  0.03958283861034178
Bond Position:  [11.1039355]


portfolio before change:  [15.14487208]
curr_Stock_Price:  102.05302711335321
curr_Factors:  [102.05302711]
mat_Sqrt:  [[0.15]]
grads:  [0.05564508]
Stock Position:  0.05564507595848367
Bond Position:  [9.46612364]


portfolio before change:  [15.23922739]
curr_Stock_Price:  103.7274245000933
curr_Factors:  [103.7274245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678922]
Stock Position:  -0.02678921651697684
Bond Position:  [18.01800382]


portfolio before change:  [15.23952243]
curr_Stock_Price:  103.8004892313239
curr_Factors:  [103.80048923]
mat_Sqrt:  [[0.15]]
grads:  [0.03233709]
Stock Position:  0.03233708810766375
Bond Position:  [11.88291687]


portfolio before change:  [15.25240739]
curr_Stock_Price:  104.15301019295111
curr_Factors:  [104.15301019]
mat_Sqrt:  [[0.15]]
grads:  [0.0237287]
Stock Position:  0.023728704614200014
Bond Position:  [12.78099138]


portfolio before change:  [15.29411495]
curr_Stock_Price:  105.84336096404101
curr_Factors:  [105.84336096]
mat_Sqrt:  [[0.15]]
grads:  [0.06150303]
Stock Position:  0.061503030041260336
Bond Position:  [8.78442754]


portfolio before change:  [15.24225174]
curr_Stock_Price:  104.98224347200386
curr_Factors:  [104.98224347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05268327]
Stock Position:  -0.05268326678013503
Bond Position:  [20.77305928]


portfolio before change:  [15.28651397]
curr_Stock_Price:  104.19137684793546
curr_Factors:  [104.19137685]
mat_Sqrt:  [[0.15]]
grads:  [0.0796853]
Stock Position:  0.07968530021768203
Bond Position:  [6.98399283]


portfolio before change:  [15.21920785]
curr_Stock_Price:  103.33577148846058
curr_Factors:  [103.33577149]
mat_Sqrt:  [[0.15]]
grads:  [-0.10343219]
Stock Position:  -0.10343219318485866
Bond Position:  [25.90745333]


portfolio before change:  [15.17424359]
curr_Stock_Price:  103.80180529623614
curr_Factors:  [103.8018053]
mat_Sqrt:  [[0.15]]
grads:  [0.03015892]
Stock Position:  0.030158920271749677
Bond Position:  [12.04369322]


portfolio before change:  [15.20948681]
curr_Stock_Price:  104.9204682523777
curr_Factors:  [104.92046825]
mat_Sqrt:  [[0.15]]
grads:  [0.24851991]
Stock Position:  0.24851991001753462
Bond Position:  [-10.86533852]


portfolio before change:  [15.07387502]
curr_Stock_Price:  104.38025585432126
curr_Factors:  [104.38025585]
mat_Sqrt:  [[0.15]]
grads:  [-0.13694707]
Stock Position:  -0.13694706625430447
Bond Position:  [29.36844484]


portfolio before change:  [14.99527279]
curr_Stock_Price:  104.98102459485285
curr_Factors:  [104.98102459]
mat_Sqrt:  [[0.15]]
grads:  [0.05315922]
Stock Position:  0.05315921835970912
Bond Position:  [9.41456358]


portfolio before change:  [15.03092313]
curr_Stock_Price:  105.62951882939578
curr_Factors:  [105.62951883]
mat_Sqrt:  [[0.15]]
grads:  [0.05068581]
Stock Position:  0.050685813275816234
Bond Position:  [9.67700506]


portfolio before change:  [15.12309962]
curr_Stock_Price:  107.424237704308
curr_Factors:  [107.4242377]
mat_Sqrt:  [[0.15]]
grads:  [-0.17424564]
Stock Position:  -0.17424564006857057
Bond Position:  [33.84130468]


portfolio before change:  [15.23455245]
curr_Stock_Price:  106.80888572412042
curr_Factors:  [106.80888572]
mat_Sqrt:  [[0.15]]
grads:  [0.00567214]
Stock Position:  0.005672139460108413
Bond Position:  [14.62871755]


portfolio before change:  [15.23278206]
curr_Stock_Price:  106.17436502228624
curr_Factors:  [106.17436502]
mat_Sqrt:  [[0.15]]
grads:  [-0.0843602]
Stock Position:  -0.08436019659290064
Bond Position:  [24.18967237]


portfolio before change:  [15.19759061]
curr_Stock_Price:  106.62736717383184
curr_Factors:  [106.62736717]
mat_Sqrt:  [[0.15]]
grads:  [0.44755128]
Stock Position:  0.44755128442639097
Bond Position:  [-32.52362453]


portfolio before change:  [15.69167299]
curr_Stock_Price:  107.74041971158952
curr_Factors:  [107.74041971]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394507]
Stock Position:  -0.01394506866320753
Bond Position:  [17.19412054]


portfolio before change:  [15.70338076]
curr_Stock_Price:  107.05498980572798
curr_Factors:  [107.05498981]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260609]
Stock Position:  -0.08260608784529651
Bond Position:  [24.54677465]


portfolio before change:  [15.65597826]
curr_Stock_Price:  107.66597426300646
curr_Factors:  [107.66597426]
mat_Sqrt:  [[0.15]]
grads:  [0.02676537]
Stock Position:  0.02676536658545462
Bond Position:  [12.77425899]


portfolio before change:  [15.68191613]
curr_Stock_Price:  108.57539505050018
curr_Factors:  [108.57539505]
mat_Sqrt:  [[0.15]]
grads:  [0.04902807]
Stock Position:  0.04902807279062018
Bond Position:  [10.35867375]


portfolio before change:  [15.6750412]
curr_Stock_Price:  108.40875906760813
curr_Factors:  [108.40875907]
mat_Sqrt:  [[0.15]]
grads:  [0.03293794]
Stock Position:  0.032937940882020726
Bond Position:  [12.1042799]


portfolio before change:  [15.69560845]
curr_Stock_Price:  108.98724440254882
curr_Factors:  [108.9872444]
mat_Sqrt:  [[0.15]]
grads:  [0.05471307]
Stock Position:  0.054713070002217146
Bond Position:  [9.73258171]


portfolio before change:  [15.73880974]
curr_Stock_Price:  109.75460489819244
curr_Factors:  [109.7546049]
mat_Sqrt:  [[0.15]]
grads:  [0.01451157]
Stock Position:  0.014511565047347538
Bond Position:  [14.14609865]


portfolio before change:  [15.73436021]
curr_Stock_Price:  109.32612561862477
curr_Factors:  [109.32612562]
mat_Sqrt:  [[0.15]]
grads:  [-0.50100993]
Stock Position:  -0.5010099335092402
Bond Position:  [70.50783514]


portfolio before change:  [15.53933991]
curr_Stock_Price:  109.73297250945939
curr_Factors:  [109.73297251]
mat_Sqrt:  [[0.15]]
grads:  [0.05990941]
Stock Position:  0.05990941051075664
Bond Position:  [8.96530221]


portfolio before change:  [15.58078397]
curr_Stock_Price:  110.40604420174746
curr_Factors:  [110.4060442]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.58078397]
Stock Price:  110.18163876327938
PL:  [5.3991452]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.64080244e-03]
 [ 2.68524014e-03]
 [ 1.36806174e-02]
 [-2.28039161e-03]
 [ 1.38554084e-02]
 [ 2.60362624e-02]
 [-4.83081933e-03]
 [ 2.09916598e-02]
 [-5.93820834e-03]
 [-7.65247126e-04]
 [-6.86964804e-03]
 [ 7.45452519e-03]
 [ 1.39036466e-02]
 [ 2.42771810e-03]
 [ 6.40398202e-03]
 [-3.33410946e-03]
 [ 1.10335347e-02]
 [-6.91784157e-03]
 [ 9.39882506e-03]
 [-1.24559061e-02]
 [-1.29452175e-02]
 [ 1.78515449e-02]
 [-7.57687984e-03]
 [ 4.89854756e-03]
 [-7.91265520e-03]
 [-6.63079453e-03]
 [-9.60677768e-04]
 [-1.07169269e-02]
 [ 5.28396540e-02]
 [-4.14551600e-03]
 [-6.55823629e-03]
 [ 4.45750254e-03]
 [ 5.86092966e-03]
 [-1.73225475e-03]
 [ 7.92933818e-03]
 [ 4.23572678e-03]
 [-2.37374717e-02]
 [ 9.83003121e-03]
 [-9.16457651e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.08375934]
curr_Stock_Price:  100.65357974028328
curr_Factors:  [100.65357974]
mat_Sqrt:  [[0.15]]
grads:  [0.03760535]
Stock Position:  0.03760534961371772
Bond Position:  [8.29864629]


portfolio before change:  [12.09124821]
curr_Stock_Price:  100.82513696717017
curr_Factors:  [100.82513697]
mat_Sqrt:  [[0.15]]
grads:  [0.0179016]
Stock Position:  0.01790160095177467
Bond Position:  [10.28631684]


portfolio before change:  [12.0949031]
curr_Stock_Price:  100.9574726997141
curr_Factors:  [100.9574727]
mat_Sqrt:  [[0.15]]
grads:  [0.09120412]
Stock Position:  0.09120411579912656
Bond Position:  [2.88716607]


portfolio before change:  [12.07134187]
curr_Stock_Price:  100.69518031676901
curr_Factors:  [100.69518032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520261]
Stock Position:  -0.015202610733817725
Bond Position:  [13.6021715]


portfolio before change:  [12.05645518]
curr_Stock_Price:  101.78624732874384
curr_Factors:  [101.78624733]
mat_Sqrt:  [[0.15]]
grads:  [0.09236939]
Stock Position:  0.09236938901077922
Bond Position:  [2.65452171]


portfolio before change:  [11.96477545]
curr_Stock_Price:  100.79012115398945
curr_Factors:  [100.79012115]
mat_Sqrt:  [[0.15]]
grads:  [0.17357508]
Stock Position:  0.17357508274460223
Bond Position:  [-5.52987816]


portfolio before change:  [11.7943222]
curr_Stock_Price:  99.8120892098361
curr_Factors:  [99.81208921]
mat_Sqrt:  [[0.15]]
grads:  [-0.03220546]
Stock Position:  -0.03220546221002134
Bond Position:  [15.00881667]


portfolio before change:  [11.78496934]
curr_Stock_Price:  100.16075938997606
curr_Factors:  [100.16075939]
mat_Sqrt:  [[0.15]]
grads:  [0.1399444]
Stock Position:  0.13994439898846048
Bond Position:  [-2.23196794]


portfolio before change:  [11.56090576]
curr_Stock_Price:  98.5616631290589
curr_Factors:  [98.56166313]
mat_Sqrt:  [[0.15]]
grads:  [-0.03958806]
Stock Position:  -0.03958805559987892
Bond Position:  [15.46277036]


portfolio before change:  [11.58976413]
curr_Stock_Price:  97.88152348547621
curr_Factors:  [97.88152349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00510165]
Stock Position:  -0.005101647503563207
Bond Position:  [12.08912116]


portfolio before change:  [11.59362343]
curr_Stock_Price:  97.42126661827999
curr_Factors:  [97.42126662]
mat_Sqrt:  [[0.15]]
grads:  [-0.04579765]
Stock Position:  -0.04579765358232226
Bond Position:  [16.05528885]


portfolio before change:  [11.60630532]
curr_Stock_Price:  97.18817924595483
curr_Factors:  [97.18817925]
mat_Sqrt:  [[0.15]]
grads:  [0.04969683]
Stock Position:  0.049696834569836174
Bond Position:  [6.77636046]


portfolio before change:  [11.61926306]
curr_Stock_Price:  97.43186958787417
curr_Factors:  [97.43186959]
mat_Sqrt:  [[0.15]]
grads:  [0.09269098]
Stock Position:  0.09269097708563852
Bond Position:  [2.58820787]


portfolio before change:  [11.66868234]
curr_Stock_Price:  97.96154072946378
curr_Factors:  [97.96154073]
mat_Sqrt:  [[0.15]]
grads:  [0.01618479]
Stock Position:  0.016184787317972862
Bond Position:  [10.08319564]


portfolio before change:  [11.67992285]
curr_Stock_Price:  98.5781708366586
curr_Factors:  [98.57817084]
mat_Sqrt:  [[0.15]]
grads:  [0.04269321]
Stock Position:  0.04269321344213025
Bond Position:  [7.47130396]


portfolio before change:  [11.67293624]
curr_Stock_Price:  98.39264776492166
curr_Factors:  [98.39264776]
mat_Sqrt:  [[0.15]]
grads:  [-0.0222274]
Stock Position:  -0.022227396427405358
Bond Position:  [13.85994863]


portfolio before change:  [11.65338951]
curr_Stock_Price:  99.34999493416224
curr_Factors:  [99.34999493]
mat_Sqrt:  [[0.15]]
grads:  [0.0735569]
Stock Position:  0.0735568982818495
Bond Position:  [4.34551204]


portfolio before change:  [11.59182442]
curr_Stock_Price:  98.50563747009181
curr_Factors:  [98.50563747]
mat_Sqrt:  [[0.15]]
grads:  [-0.04611894]
Stock Position:  -0.0461189438017916
Bond Position:  [16.13480038]


portfolio before change:  [11.57186836]
curr_Stock_Price:  98.98208012377843
curr_Factors:  [98.98208012]
mat_Sqrt:  [[0.15]]
grads:  [0.06265883]
Stock Position:  0.06265883374434976
Bond Position:  [5.36976666]


portfolio before change:  [11.67067481]
curr_Stock_Price:  100.54826284947539
curr_Factors:  [100.54826285]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303937]
Stock Position:  -0.08303937380630724
Bond Position:  [20.02013959]


portfolio before change:  [11.59349944]
curr_Stock_Price:  101.50778411964266
curr_Factors:  [101.50778412]
mat_Sqrt:  [[0.15]]
grads:  [-0.08630145]
Stock Position:  -0.08630144983536132
Bond Position:  [20.35376837]


portfolio before change:  [11.66805933]
curr_Stock_Price:  100.67331940598635
curr_Factors:  [100.67331941]
mat_Sqrt:  [[0.15]]
grads:  [0.1190103]
Stock Position:  0.119010299297535
Bond Position:  [-0.31310254]


portfolio before change:  [11.66367702]
curr_Stock_Price:  100.63682532584062
curr_Factors:  [100.63682533]
mat_Sqrt:  [[0.15]]
grads:  [-0.05051253]
Stock Position:  -0.05051253229113508
Bond Position:  [16.74709791]


portfolio before change:  [11.59101007]
curr_Stock_Price:  102.1168633019617
curr_Factors:  [102.1168633]
mat_Sqrt:  [[0.15]]
grads:  [0.03265698]
Stock Position:  0.032656983731555976
Bond Position:  [8.25618133]


portfolio before change:  [11.570994]
curr_Stock_Price:  101.47234075706645
curr_Factors:  [101.47234076]
mat_Sqrt:  [[0.15]]
grads:  [-0.05275103]
Stock Position:  -0.05275103464998823
Bond Position:  [16.92376496]


portfolio before change:  [11.56959137]
curr_Stock_Price:  101.5390357599534
curr_Factors:  [101.53903576]
mat_Sqrt:  [[0.15]]
grads:  [-0.0442053]
Stock Position:  -0.044205296877872655
Bond Position:  [16.05815459]


portfolio before change:  [11.56467819]
curr_Stock_Price:  101.69559108538671
curr_Factors:  [101.69559109]
mat_Sqrt:  [[0.15]]
grads:  [-0.00640452]
Stock Position:  -0.006404518450205129
Bond Position:  [12.21598948]


portfolio before change:  [11.55288871]
curr_Stock_Price:  103.77483679254517
curr_Factors:  [103.77483679]
mat_Sqrt:  [[0.15]]
grads:  [-0.07144618]
Stock Position:  -0.07144617933529114
Bond Position:  [18.96720431]


portfolio before change:  [11.54900165]
curr_Stock_Price:  103.86242875008983
curr_Factors:  [103.86242875]
mat_Sqrt:  [[0.15]]
grads:  [0.35226436]
Stock Position:  0.3522643598590449
Bond Position:  [-25.03803032]


portfolio before change:  [11.93284026]
curr_Stock_Price:  104.96094622995562
curr_Factors:  [104.96094623]
mat_Sqrt:  [[0.15]]
grads:  [-0.02763677]
Stock Position:  -0.027636773349215788
Bond Position:  [14.83362214]


portfolio before change:  [11.94572641]
curr_Stock_Price:  104.56177395807674
curr_Factors:  [104.56177396]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372158]
Stock Position:  -0.04372157529050899
Bond Position:  [16.51733189]


portfolio before change:  [11.9087002]
curr_Stock_Price:  105.45586361168199
curr_Factors:  [105.45586361]
mat_Sqrt:  [[0.15]]
grads:  [0.02971668]
Stock Position:  0.02971668361380561
Bond Position:  [8.77490167]


portfolio before change:  [11.8850239]
curr_Stock_Price:  104.62221630033503
curr_Factors:  [104.6222163]
mat_Sqrt:  [[0.15]]
grads:  [0.03907286]
Stock Position:  0.03907286438154958
Bond Position:  [7.79713423]


portfolio before change:  [11.91392436]
curr_Stock_Price:  105.33692618074801
curr_Factors:  [105.33692618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01154836]
Stock Position:  -0.011548364971386572
Bond Position:  [13.13039363]


portfolio before change:  [11.90250786]
curr_Stock_Price:  106.46764085839621
curr_Factors:  [106.46764086]
mat_Sqrt:  [[0.15]]
grads:  [0.05286225]
Stock Position:  0.05286225453169776
Bond Position:  [6.27438833]


portfolio before change:  [11.86351411]
curr_Stock_Price:  105.71515511887438
curr_Factors:  [105.71515512]
mat_Sqrt:  [[0.15]]
grads:  [0.02823818]
Stock Position:  0.028238178547427748
Bond Position:  [8.87831069]


portfolio before change:  [11.842222]
curr_Stock_Price:  104.92183312661592
curr_Factors:  [104.92183313]
mat_Sqrt:  [[0.15]]
grads:  [-0.15824981]
Stock Position:  -0.15824981147483133
Bond Position:  [28.44608232]


portfolio before change:  [11.71339517]
curr_Stock_Price:  105.7583764039063
curr_Factors:  [105.7583764]
mat_Sqrt:  [[0.15]]
grads:  [0.06553354]
Stock Position:  0.06553354140419082
Bond Position:  [4.78267423]


portfolio before change:  [11.71158713]
curr_Stock_Price:  105.7216637844795
curr_Factors:  [105.72166378]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.71158713]
Stock Price:  106.14911500628902
PL:  [5.56247213]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.39591517e-03]
 [ 2.78451556e-03]
 [ 5.14024116e-03]
 [ 1.81077216e-03]
 [-4.48378271e-02]
 [-2.92332493e-02]
 [-4.54252909e-02]
 [ 1.92668018e-02]
 [-5.92227580e-03]
 [ 7.07064067e-04]
 [ 1.07543961e-02]
 [ 4.26722585e-03]
 [ 6.98386397e-03]
 [-4.71786016e-03]
 [ 1.37053463e-02]
 [ 1.87205318e-03]
 [ 9.07463784e-03]
 [ 1.35115028e-02]
 [ 1.13643672e-02]
 [-1.30384765e-02]
 [-1.49023006e-02]
 [ 1.95230855e-02]
 [ 1.21754005e-02]
 [ 6.22673330e-03]
 [-8.22657778e-03]
 [-9.30801919e-03]
 [ 5.01822701e-03]
 [-1.11672922e-02]
 [-1.70286118e-02]
 [-8.79392188e-03]
 [-1.61535033e-03]
 [ 5.23520133e-03]
 [ 5.71408819e-03]
 [-1.18428815e-02]
 [ 9.84309949e-03]
 [ 5.58629414e-03]
 [ 2.44907075e-03]
 [ 7.83803499e-03]
 [-1.09757408e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.85392669]
curr_Stock_Price:  99.36741219219275
curr_Factors:  [99.36741219]
mat_Sqrt:  [[0.15]]
grads:  [0.03597277]
Stock Position:  0.035972767801875805
Bond Position:  [-11.42844754]


portfolio before change:  [-7.83996318]
curr_Stock_Price:  99.79529576571123
curr_Factors:  [99.79529577]
mat_Sqrt:  [[0.15]]
grads:  [0.01856344]
Stock Position:  0.018563437033474545
Bond Position:  [-9.69250687]


portfolio before change:  [-7.84458611]
curr_Stock_Price:  99.61153189581452
curr_Factors:  [99.6115319]
mat_Sqrt:  [[0.15]]
grads:  [0.03426827]
Stock Position:  0.03426827440204864
Bond Position:  [-11.25810142]


portfolio before change:  [-7.88885118]
curr_Stock_Price:  98.36087898566767
curr_Factors:  [98.36087899]
mat_Sqrt:  [[0.15]]
grads:  [0.01207181]
Stock Position:  0.012071814403722266
Bond Position:  [-9.07624545]


portfolio before change:  [-7.90116157]
curr_Stock_Price:  97.43510357739731
curr_Factors:  [97.43510358]
mat_Sqrt:  [[0.15]]
grads:  [-0.29891885]
Stock Position:  -0.29891884706339084
Bond Position:  [21.22402726]


portfolio before change:  [-7.93810403]
curr_Stock_Price:  97.56756640426036
curr_Factors:  [97.5675664]
mat_Sqrt:  [[0.15]]
grads:  [-0.19488833]
Stock Position:  -0.1948883287888166
Bond Position:  [11.07667593]


portfolio before change:  [-7.90162622]
curr_Stock_Price:  97.3874984717242
curr_Factors:  [97.38749847]
mat_Sqrt:  [[0.15]]
grads:  [-0.30283527]
Stock Position:  -0.3028352726732647
Bond Position:  [21.59074343]


portfolio before change:  [-8.02369049]
curr_Stock_Price:  97.79948245636952
curr_Factors:  [97.79948246]
mat_Sqrt:  [[0.15]]
grads:  [0.12844535]
Stock Position:  0.12844534547708095
Bond Position:  [-20.5855788]


portfolio before change:  [-7.71361216]
curr_Stock_Price:  100.23360481812665
curr_Factors:  [100.23360482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03948184]
Stock Position:  -0.039481838689140854
Bond Position:  [-3.75620515]


portfolio before change:  [-7.72452577]
curr_Stock_Price:  100.49813270322537
curr_Factors:  [100.4981327]
mat_Sqrt:  [[0.15]]
grads:  [0.00471376]
Stock Position:  0.004713760447355396
Bond Position:  [-8.19824989]


portfolio before change:  [-7.72451161]
curr_Stock_Price:  100.71855234946833
curr_Factors:  [100.71855235]
mat_Sqrt:  [[0.15]]
grads:  [0.07169597]
Stock Position:  0.07169597432096317
Bond Position:  [-14.94562635]


portfolio before change:  [-7.71338896]
curr_Stock_Price:  100.89974751595516
curr_Factors:  [100.89974752]
mat_Sqrt:  [[0.15]]
grads:  [0.02844817]
Stock Position:  0.028448172340784728
Bond Position:  [-10.58380237]


portfolio before change:  [-7.66923389]
curr_Stock_Price:  102.49837845362981
curr_Factors:  [102.49837845]
mat_Sqrt:  [[0.15]]
grads:  [0.04655909]
Stock Position:  0.04655909315483992
Bond Position:  [-12.44146544]


portfolio before change:  [-7.65882359]
curr_Stock_Price:  102.75537624716921
curr_Factors:  [102.75537625]
mat_Sqrt:  [[0.15]]
grads:  [-0.0314524]
Stock Position:  -0.031452401083731804
Bond Position:  [-4.42692028]


portfolio before change:  [-7.64555355]
curr_Stock_Price:  102.31587282025794
curr_Factors:  [102.31587282]
mat_Sqrt:  [[0.15]]
grads:  [0.09136898]
Stock Position:  0.09136897538474117
Bond Position:  [-16.99405001]


portfolio before change:  [-7.70779236]
curr_Stock_Price:  101.65794243038934
curr_Factors:  [101.65794243]
mat_Sqrt:  [[0.15]]
grads:  [0.01248035]
Stock Position:  0.012480354524816285
Bond Position:  [-8.97651953]


portfolio before change:  [-7.71101586]
curr_Stock_Price:  101.48956925724507
curr_Factors:  [101.48956926]
mat_Sqrt:  [[0.15]]
grads:  [0.06049759]
Stock Position:  0.06049758560019125
Bond Position:  [-13.85088976]


portfolio before change:  [-7.71024642]
curr_Stock_Price:  101.53090811573152
curr_Factors:  [101.53090812]
mat_Sqrt:  [[0.15]]
grads:  [0.09007669]
Stock Position:  0.09007668548646408
Bond Position:  [-16.8558141]


portfolio before change:  [-7.77217828]
curr_Stock_Price:  100.866754545726
curr_Factors:  [100.86675455]
mat_Sqrt:  [[0.15]]
grads:  [0.07576245]
Stock Position:  0.07576244780303046
Bond Position:  [-15.41409051]


portfolio before change:  [-7.76729931]
curr_Stock_Price:  100.95658614043494
curr_Factors:  [100.95658614]
mat_Sqrt:  [[0.15]]
grads:  [-0.08692318]
Stock Position:  -0.086923176980813
Bond Position:  [1.0081679]


portfolio before change:  [-7.79064872]
curr_Stock_Price:  101.22665734611084
curr_Factors:  [101.22665735]
mat_Sqrt:  [[0.15]]
grads:  [-0.09934867]
Stock Position:  -0.09934867040946059
Bond Position:  [2.26608509]


portfolio before change:  [-7.76382867]
curr_Stock_Price:  100.95954986839035
curr_Factors:  [100.95954987]
mat_Sqrt:  [[0.15]]
grads:  [0.1301539]
Stock Position:  0.1301539032853971
Bond Position:  [-20.90410816]


portfolio before change:  [-7.91380654]
curr_Stock_Price:  99.82731576266252
curr_Factors:  [99.82731576]
mat_Sqrt:  [[0.15]]
grads:  [0.08116934]
Stock Position:  0.08116933681521772
Bond Position:  [-16.01672355]


portfolio before change:  [-7.83855741]
curr_Stock_Price:  100.77904638221666
curr_Factors:  [100.77904638]
mat_Sqrt:  [[0.15]]
grads:  [0.04151156]
Stock Position:  0.04151155530309844
Bond Position:  [-12.02205237]


portfolio before change:  [-7.81747821]
curr_Stock_Price:  101.32304070504907
curr_Factors:  [101.32304071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05484385]
Stock Position:  -0.05484385183956893
Bond Position:  [-2.26053238]


portfolio before change:  [-7.7495587]
curr_Stock_Price:  100.0794720350568
curr_Factors:  [100.07947204]
mat_Sqrt:  [[0.15]]
grads:  [-0.06205346]
Stock Position:  -0.06205346124056925
Bond Position:  [-1.53928106]


portfolio before change:  [-7.74260802]
curr_Stock_Price:  99.9643600143744
curr_Factors:  [99.96436001]
mat_Sqrt:  [[0.15]]
grads:  [0.03345485]
Stock Position:  0.03345484672673165
Bond Position:  [-11.08690036]


portfolio before change:  [-7.71943553]
curr_Stock_Price:  100.69843720688438
curr_Factors:  [100.69843721]
mat_Sqrt:  [[0.15]]
grads:  [-0.07444861]
Stock Position:  -0.07444861454220948
Bond Position:  [-0.22257639]


portfolio before change:  [-7.70307013]
curr_Stock_Price:  100.47824203392122
curr_Factors:  [100.47824203]
mat_Sqrt:  [[0.15]]
grads:  [-0.11352408]
Stock Position:  -0.1135240785668445
Bond Position:  [3.70362971]


portfolio before change:  [-7.73916666]
curr_Stock_Price:  100.80028392758527
curr_Factors:  [100.80028393]
mat_Sqrt:  [[0.15]]
grads:  [-0.05862615]
Stock Position:  -0.05862614585474199
Bond Position:  [-1.82963451]


portfolio before change:  [-7.74604449]
curr_Stock_Price:  100.91369955535562
curr_Factors:  [100.91369956]
mat_Sqrt:  [[0.15]]
grads:  [-0.010769]
Stock Position:  -0.010769002187785637
Bond Position:  [-6.65930464]


portfolio before change:  [-7.74713453]
curr_Stock_Price:  100.93761761522785
curr_Factors:  [100.93761762]
mat_Sqrt:  [[0.15]]
grads:  [0.03490134]
Stock Position:  0.03490134218865905
Bond Position:  [-11.26999287]


portfolio before change:  [-7.79248655]
curr_Stock_Price:  99.67854923256151
curr_Factors:  [99.67854923]
mat_Sqrt:  [[0.15]]
grads:  [0.03809392]
Stock Position:  0.03809392126785902
Bond Position:  [-11.58963335]


portfolio before change:  [-7.79428039]
curr_Stock_Price:  99.66949146939213
curr_Factors:  [99.66949147]
mat_Sqrt:  [[0.15]]
grads:  [-0.07895254]
Stock Position:  -0.07895254309627396
Bond Position:  [0.07487943]


portfolio before change:  [-7.73331654]
curr_Stock_Price:  98.89745188763604
curr_Factors:  [98.89745189]
mat_Sqrt:  [[0.15]]
grads:  [0.06562066]
Stock Position:  0.0656206632767499
Bond Position:  [-14.22303293]


portfolio before change:  [-7.65328895]
curr_Stock_Price:  100.14409546620303
curr_Factors:  [100.14409547]
mat_Sqrt:  [[0.15]]
grads:  [0.03724196]
Stock Position:  0.03724196092962068
Bond Position:  [-11.38285144]


portfolio before change:  [-7.62592102]
curr_Stock_Price:  100.91717181355378
curr_Factors:  [100.91717181]
mat_Sqrt:  [[0.15]]
grads:  [0.01632714]
Stock Position:  0.016327138366602885
Bond Position:  [-9.27360964]


portfolio before change:  [-7.6329255]
curr_Stock_Price:  100.55916611551456
curr_Factors:  [100.55916612]
mat_Sqrt:  [[0.15]]
grads:  [0.05225357]
Stock Position:  0.05225356661571607
Bond Position:  [-12.88750058]


portfolio before change:  [-7.61067255]
curr_Stock_Price:  101.01586200103301
curr_Factors:  [101.015862]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.61067255]
Stock Price:  102.05155879186971
PL:  [-9.66223134]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.80440847e-03]
 [-1.30541771e-02]
 [-1.87243348e-02]
 [-1.09104313e-03]
 [ 3.47917617e-04]
 [-2.53739723e-02]
 [-5.18042637e-02]
 [ 2.24972007e-02]
 [-5.99730527e-03]
 [ 3.71958190e-03]
 [ 6.80650956e-04]
 [ 4.08048324e-03]
 [ 1.23983190e-02]
 [ 2.31338819e-03]
 [ 2.20140468e-02]
 [-1.62781998e-04]
 [ 9.38598112e-03]
 [ 1.22367005e-02]
 [ 1.14489275e-02]
 [-1.26377240e-02]
 [-1.49800056e-02]
 [ 1.83867344e-02]
 [-2.27392287e-02]
 [ 5.10312924e-03]
 [-2.24762991e-03]
 [-7.12202240e-03]
 [-1.06158312e-03]
 [-1.07490562e-02]
 [ 3.82590286e-02]
 [-6.30041175e-03]
 [-3.45093020e-03]
 [ 5.01516420e-03]
 [ 5.19598768e-03]
 [-4.30487520e-03]
 [ 1.33697282e-02]
 [ 5.46923812e-03]
 [-6.16750725e-04]
 [ 9.01361457e-03]
 [-1.59235977e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.3914377]
curr_Stock_Price:  98.88117211236838
curr_Factors:  [98.88117211]
mat_Sqrt:  [[0.15]]
grads:  [0.05869606]
Stock Position:  0.05869605645906651
Bond Position:  [-21.19537256]


portfolio before change:  [-15.43051679]
curr_Stock_Price:  98.26052548823705
curr_Factors:  [98.26052549]
mat_Sqrt:  [[0.15]]
grads:  [-0.08702785]
Stock Position:  -0.08702784702073432
Bond Position:  [-6.87911481]


portfolio before change:  [-15.41918425]
curr_Stock_Price:  98.12042685958099
curr_Factors:  [98.12042686]
mat_Sqrt:  [[0.15]]
grads:  [-0.1248289]
Stock Position:  -0.12482889884604938
Bond Position:  [-3.17091941]


portfolio before change:  [-15.51903939]
curr_Stock_Price:  98.91718741788804
curr_Factors:  [98.91718742]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727362]
Stock Position:  -0.007273620895608954
Bond Position:  [-14.79955327]


portfolio before change:  [-15.52059958]
curr_Stock_Price:  98.87733530243364
curr_Factors:  [98.8773353]
mat_Sqrt:  [[0.15]]
grads:  [0.00231945]
Stock Position:  0.0023194507796031145
Bond Position:  [-15.74994069]


portfolio before change:  [-15.52396077]
curr_Stock_Price:  98.27705111228222
curr_Factors:  [98.27705111]
mat_Sqrt:  [[0.15]]
grads:  [-0.16915982]
Stock Position:  -0.16915981552315215
Bond Position:  [1.10056706]


portfolio before change:  [-15.51758256]
curr_Stock_Price:  98.24015918681837
curr_Factors:  [98.24015919]
mat_Sqrt:  [[0.15]]
grads:  [-0.34536176]
Stock Position:  -0.345361758163371
Bond Position:  [18.41081154]


portfolio before change:  [-15.75005811]
curr_Stock_Price:  98.91995953977055
curr_Factors:  [98.91995954]
mat_Sqrt:  [[0.15]]
grads:  [0.14998134]
Stock Position:  0.14998133817029877
Bond Position:  [-30.58620602]


portfolio before change:  [-15.84986138]
curr_Stock_Price:  98.28001492378083
curr_Factors:  [98.28001492]
mat_Sqrt:  [[0.15]]
grads:  [-0.03998204]
Stock Position:  -0.03998203516440809
Bond Position:  [-11.92042636]


portfolio before change:  [-15.87678972]
curr_Stock_Price:  98.91625565065078
curr_Factors:  [98.91625565]
mat_Sqrt:  [[0.15]]
grads:  [0.02479721]
Stock Position:  0.024797212664715622
Bond Position:  [-18.32963715]


portfolio before change:  [-15.88504398]
curr_Stock_Price:  98.67578852856937
curr_Factors:  [98.67578853]
mat_Sqrt:  [[0.15]]
grads:  [0.00453767]
Stock Position:  0.00453767303705665
Bond Position:  [-16.33280245]


portfolio before change:  [-15.88052995]
curr_Stock_Price:  100.12052949712776
curr_Factors:  [100.1205295]
mat_Sqrt:  [[0.15]]
grads:  [0.02720322]
Stock Position:  0.02720322159354713
Bond Position:  [-18.6041309]


portfolio before change:  [-15.86365889]
curr_Stock_Price:  100.8262077256036
curr_Factors:  [100.82620773]
mat_Sqrt:  [[0.15]]
grads:  [0.08265546]
Stock Position:  0.08265545977565135
Bond Position:  [-24.19749545]


portfolio before change:  [-15.89338688]
curr_Stock_Price:  100.50314241945581
curr_Factors:  [100.50314242]
mat_Sqrt:  [[0.15]]
grads:  [0.01542259]
Stock Position:  0.015422587942524879
Bond Position:  [-17.44340543]


portfolio before change:  [-15.89422015]
curr_Stock_Price:  100.59050066388428
curr_Factors:  [100.59050066]
mat_Sqrt:  [[0.15]]
grads:  [0.14676031]
Stock Position:  0.14676031198200945
Bond Position:  [-30.65691341]


portfolio before change:  [-15.93698553]
curr_Stock_Price:  100.32521757357298
curr_Factors:  [100.32521757]
mat_Sqrt:  [[0.15]]
grads:  [-0.00108521]
Stock Position:  -0.0010852133195149785
Bond Position:  [-15.82811127]


portfolio before change:  [-15.93910053]
curr_Stock_Price:  100.45087456395213
curr_Factors:  [100.45087456]
mat_Sqrt:  [[0.15]]
grads:  [0.06257321]
Stock Position:  0.06257320748436469
Bond Position:  [-22.22463395]


portfolio before change:  [-15.94357994]
curr_Stock_Price:  100.42368793882315
curr_Factors:  [100.42368794]
mat_Sqrt:  [[0.15]]
grads:  [0.081578]
Stock Position:  0.08157800339276002
Bond Position:  [-24.1359439]


portfolio before change:  [-15.89943086]
curr_Stock_Price:  101.00186174387123
curr_Factors:  [101.00186174]
mat_Sqrt:  [[0.15]]
grads:  [0.07632618]
Stock Position:  0.07632618330146465
Bond Position:  [-23.60851747]


portfolio before change:  [-15.98068335]
curr_Stock_Price:  99.97598517647525
curr_Factors:  [99.97598518]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425149]
Stock Position:  -0.08425149365166841
Bond Position:  [-7.55755727]


portfolio before change:  [-16.02314641]
curr_Stock_Price:  100.46877529400933
curr_Factors:  [100.46877529]
mat_Sqrt:  [[0.15]]
grads:  [-0.0998667]
Stock Position:  -0.09986670397212126
Bond Position:  [-5.98966097]


portfolio before change:  [-16.05693119]
curr_Stock_Price:  100.7995764933572
curr_Factors:  [100.79957649]
mat_Sqrt:  [[0.15]]
grads:  [0.12257823]
Stock Position:  0.12257822947600555
Bond Position:  [-28.41276481]


portfolio before change:  [-15.98786023]
curr_Stock_Price:  101.39203716411922
curr_Factors:  [101.39203716]
mat_Sqrt:  [[0.15]]
grads:  [-0.15159486]
Stock Position:  -0.15159485813732895
Bond Position:  [-0.61734874]


portfolio before change:  [-16.1174777]
curr_Stock_Price:  102.24655365049472
curr_Factors:  [102.24655365]
mat_Sqrt:  [[0.15]]
grads:  [0.03402086]
Stock Position:  0.03402086158215963
Bond Position:  [-19.59599355]


portfolio before change:  [-16.10999022]
curr_Stock_Price:  102.53864329669594
curr_Factors:  [102.5386433]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149842]
Stock Position:  -0.014984199402051727
Bond Position:  [-14.57353074]


portfolio before change:  [-16.1146621]
curr_Stock_Price:  102.72884870327447
curr_Factors:  [102.7288487]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748015]
Stock Position:  -0.047480149339263346
Bond Position:  [-11.23708102]


portfolio before change:  [-16.09256189]
curr_Stock_Price:  102.23380120910205
curr_Factors:  [102.23380121]
mat_Sqrt:  [[0.15]]
grads:  [-0.00707722]
Stock Position:  -0.007077220829283341
Bond Position:  [-15.3690307]


portfolio before change:  [-16.09996056]
curr_Stock_Price:  103.0077515168051
curr_Factors:  [103.00775152]
mat_Sqrt:  [[0.15]]
grads:  [-0.07166037]
Stock Position:  -0.07166037452640298
Bond Position:  [-8.7183865]


portfolio before change:  [-16.08037328]
curr_Stock_Price:  102.71920790755051
curr_Factors:  [102.71920791]
mat_Sqrt:  [[0.15]]
grads:  [0.25506019]
Stock Position:  0.2550601905744776
Bond Position:  [-42.27995402]


portfolio before change:  [-15.71285413]
curr_Stock_Price:  104.18084124346979
curr_Factors:  [104.18084124]
mat_Sqrt:  [[0.15]]
grads:  [-0.04200275]
Stock Position:  -0.04200274501155295
Bond Position:  [-11.33697282]


portfolio before change:  [-15.6789932]
curr_Stock_Price:  103.34094045963582
curr_Factors:  [103.34094046]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230062]
Stock Position:  -0.023006201343778697
Bond Position:  [-13.30151072]


portfolio before change:  [-15.66485768]
curr_Stock_Price:  102.65424242311694
curr_Factors:  [102.65424242]
mat_Sqrt:  [[0.15]]
grads:  [0.03343443]
Stock Position:  0.033434427988668115
Bond Position:  [-19.09704355]


portfolio before change:  [-15.66344548]
curr_Stock_Price:  102.7678820674741
curr_Factors:  [102.76788207]
mat_Sqrt:  [[0.15]]
grads:  [0.03463992]
Stock Position:  0.034639917841416464
Bond Position:  [-19.22331647]


portfolio before change:  [-15.65030031]
curr_Stock_Price:  103.21673530388662
curr_Factors:  [103.2167353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869917]
Stock Position:  -0.028699167973158236
Bond Position:  [-12.68806588]


portfolio before change:  [-15.6389796]
curr_Stock_Price:  102.76700744042678
curr_Factors:  [102.76700744]
mat_Sqrt:  [[0.15]]
grads:  [0.08913152]
Stock Position:  0.08913152104401528
Bond Position:  [-24.79875928]


portfolio before change:  [-15.70247994]
curr_Stock_Price:  102.0893537523802
curr_Factors:  [102.08935375]
mat_Sqrt:  [[0.15]]
grads:  [0.03646159]
Stock Position:  0.03646158747282492
Bond Position:  [-19.42481984]


portfolio before change:  [-15.70811362]
curr_Stock_Price:  102.00144137227781
curr_Factors:  [102.00144137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00411167]
Stock Position:  -0.004111671500662828
Bond Position:  [-15.2887172]


portfolio before change:  [-15.71333946]
curr_Stock_Price:  102.80759406702568
curr_Factors:  [102.80759407]
mat_Sqrt:  [[0.15]]
grads:  [0.06009076]
Stock Position:  0.06009076377459069
Bond Position:  [-21.89112631]


portfolio before change:  [-15.7022683]
curr_Stock_Price:  103.03737518879925
curr_Factors:  [103.03737519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.7022683]
Stock Price:  102.83170648945226
PL:  [-18.53397479]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.56348127e-03]
 [-1.09942371e-02]
 [-1.45937176e-03]
 [-1.40569429e-03]
 [-5.10713668e-03]
 [-2.57599940e-02]
 [-5.18436983e-02]
 [ 1.52099886e-02]
 [-6.27411837e-03]
 [ 1.00706096e-03]
 [ 8.01724926e-04]
 [ 6.57549924e-03]
 [ 1.38500497e-02]
 [ 2.42437153e-03]
 [ 3.22537091e-03]
 [-4.15195257e-03]
 [ 1.45772376e-02]
 [-8.18134613e-03]
 [ 8.35640413e-03]
 [-1.11589916e-02]
 [ 4.92351364e-03]
 [ 1.17890576e-02]
 [ 1.43466630e-02]
 [ 5.87683684e-03]
 [-2.22315034e-03]
 [-8.71498751e-03]
 [-1.08571058e-03]
 [-1.11344194e-02]
 [ 5.32121904e-03]
 [-9.40661696e-03]
 [-2.73544369e-03]
 [ 4.86650999e-03]
 [ 5.58287382e-03]
 [-4.30746639e-03]
 [ 8.12264876e-03]
 [ 5.16350274e-03]
 [-4.12307072e-03]
 [ 7.91887649e-03]
 [-9.21539797e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.43587172]
curr_Stock_Price:  99.20085254751997
curr_Factors:  [99.20085255]
mat_Sqrt:  [[0.15]]
grads:  [0.04375654]
Stock Position:  0.04375654178839116
Bond Position:  [-14.77655797]


portfolio before change:  [-10.45720746]
curr_Stock_Price:  98.75546642670172
curr_Factors:  [98.75546643]
mat_Sqrt:  [[0.15]]
grads:  [-0.07329491]
Stock Position:  -0.07329491381542523
Bond Position:  [-3.21893406]


portfolio before change:  [-10.49661119]
curr_Stock_Price:  99.28758171259446
curr_Factors:  [99.28758171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00972915]
Stock Position:  -0.009729145082010974
Bond Position:  [-9.53062791]


portfolio before change:  [-10.49521478]
curr_Stock_Price:  99.02159537266137
curr_Factors:  [99.02159537]
mat_Sqrt:  [[0.15]]
grads:  [-0.0093713]
Stock Position:  -0.009371295245447277
Bond Position:  [-9.56725417]


portfolio before change:  [-10.49342063]
curr_Stock_Price:  98.70252256119359
curr_Factors:  [98.70252256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03404758]
Stock Position:  -0.03404757785627524
Bond Position:  [-7.13283881]


portfolio before change:  [-10.47767915]
curr_Stock_Price:  98.2139961885596
curr_Factors:  [98.21399619]
mat_Sqrt:  [[0.15]]
grads:  [-0.17173329]
Stock Position:  -0.17173329365472717
Bond Position:  [6.3889339]


portfolio before change:  [-10.48424951]
curr_Stock_Price:  98.25690587989486
curr_Factors:  [98.25690588]
mat_Sqrt:  [[0.15]]
grads:  [-0.34562466]
Stock Position:  -0.34562465535493686
Bond Position:  [23.47575972]


portfolio before change:  [-10.05994283]
curr_Stock_Price:  97.03774509180096
curr_Factors:  [97.03774509]
mat_Sqrt:  [[0.15]]
grads:  [0.10139992]
Stock Position:  0.10139992373004744
Bond Position:  [-19.89956278]


portfolio before change:  [-10.03400859]
curr_Stock_Price:  97.31803958909985
curr_Factors:  [97.31803959]
mat_Sqrt:  [[0.15]]
grads:  [-0.04182746]
Stock Position:  -0.04182745577648112
Bond Position:  [-5.96344259]


portfolio before change:  [-10.07668309]
curr_Stock_Price:  98.32046775177814
curr_Factors:  [98.32046775]
mat_Sqrt:  [[0.15]]
grads:  [0.00671374]
Stock Position:  0.006713739726553822
Bond Position:  [-10.73678112]


portfolio before change:  [-10.07544056]
curr_Stock_Price:  98.7054560500347
curr_Factors:  [98.70545605]
mat_Sqrt:  [[0.15]]
grads:  [0.00534483]
Stock Position:  0.005344832842349011
Bond Position:  [-10.60300472]


portfolio before change:  [-10.07608029]
curr_Stock_Price:  98.83375267754406
curr_Factors:  [98.83375268]
mat_Sqrt:  [[0.15]]
grads:  [0.04383666]
Stock Position:  0.043836661625651405
Bond Position:  [-14.40862206]


portfolio before change:  [-10.08406199]
curr_Stock_Price:  98.69276305714824
curr_Factors:  [98.69276306]
mat_Sqrt:  [[0.15]]
grads:  [0.09233366]
Stock Position:  0.09233366444793333
Bond Position:  [-19.19672646]


portfolio before change:  [-10.15079179]
curr_Stock_Price:  97.99605021360485
curr_Factors:  [97.99605021]
mat_Sqrt:  [[0.15]]
grads:  [0.01616248]
Stock Position:  0.016162476851559155
Bond Position:  [-11.73465068]


portfolio before change:  [-10.15118133]
curr_Stock_Price:  98.06270972129622
curr_Factors:  [98.06270972]
mat_Sqrt:  [[0.15]]
grads:  [0.02150247]
Stock Position:  0.021502472745117213
Bond Position:  [-12.25977207]


portfolio before change:  [-10.16821087]
curr_Stock_Price:  97.34200288330709
curr_Factors:  [97.34200288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767968]
Stock Position:  -0.027679683801060378
Bond Position:  [-7.47381501]


portfolio before change:  [-10.18714611]
curr_Stock_Price:  97.99233383045717
curr_Factors:  [97.99233383]
mat_Sqrt:  [[0.15]]
grads:  [0.09718158]
Stock Position:  0.0971815841406284
Bond Position:  [-19.71019635]


portfolio before change:  [-10.16641983]
curr_Stock_Price:  98.23096148753815
curr_Factors:  [98.23096149]
mat_Sqrt:  [[0.15]]
grads:  [-0.05454231]
Stock Position:  -0.05454230753398027
Bond Position:  [-4.80867652]


portfolio before change:  [-10.19250797]
curr_Stock_Price:  98.69825042734249
curr_Factors:  [98.69825043]
mat_Sqrt:  [[0.15]]
grads:  [0.05570936]
Stock Position:  0.05570936086683298
Bond Position:  [-15.69092442]


portfolio before change:  [-10.16775928]
curr_Stock_Price:  99.17770621977994
curr_Factors:  [99.17770622]
mat_Sqrt:  [[0.15]]
grads:  [-0.07439328]
Stock Position:  -0.07439327731033371
Bond Position:  [-2.78960468]


portfolio before change:  [-10.17968159]
curr_Stock_Price:  99.33327925994766
curr_Factors:  [99.33327926]
mat_Sqrt:  [[0.15]]
grads:  [0.03282342]
Stock Position:  0.03282342428704546
Bond Position:  [-13.44013996]


portfolio before change:  [-10.1704053]
curr_Stock_Price:  99.66707767629332
curr_Factors:  [99.66707768]
mat_Sqrt:  [[0.15]]
grads:  [0.07859372]
Stock Position:  0.07859371746211295
Bond Position:  [-18.00361145]


portfolio before change:  [-10.19239083]
curr_Stock_Price:  99.41597696583378
curr_Factors:  [99.41597697]
mat_Sqrt:  [[0.15]]
grads:  [0.09564442]
Stock Position:  0.0956444202478512
Bond Position:  [-19.70097432]


portfolio before change:  [-10.12034606]
curr_Stock_Price:  100.1949827254263
curr_Factors:  [100.19498273]
mat_Sqrt:  [[0.15]]
grads:  [0.03917891]
Stock Position:  0.03917891229854665
Bond Position:  [-14.0458765]


portfolio before change:  [-10.12508162]
curr_Stock_Price:  100.11892847809051
curr_Factors:  [100.11892848]
mat_Sqrt:  [[0.15]]
grads:  [-0.014821]
Stock Position:  -0.014821002238224861
Bond Position:  [-8.64121876]


portfolio before change:  [-10.12998097]
curr_Stock_Price:  100.37661223586598
curr_Factors:  [100.37661224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05809992]
Stock Position:  -0.058099916746826054
Bond Position:  [-4.29810816]


portfolio before change:  [-10.22672541]
curr_Stock_Price:  102.0325034477816
curr_Factors:  [102.03250345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00723807]
Stock Position:  -0.007238070549839817
Bond Position:  [-9.48820696]


portfolio before change:  [-10.22926425]
curr_Stock_Price:  102.21939591169867
curr_Factors:  [102.21939591]
mat_Sqrt:  [[0.15]]
grads:  [-0.07422946]
Stock Position:  -0.07422946279654208
Bond Position:  [-2.64157341]


portfolio before change:  [-10.19600117]
curr_Stock_Price:  101.76683566712305
curr_Factors:  [101.76683567]
mat_Sqrt:  [[0.15]]
grads:  [0.03547479]
Stock Position:  0.03547479358076276
Bond Position:  [-13.80615866]


portfolio before change:  [-10.1600048]
curr_Stock_Price:  102.83018909405442
curr_Factors:  [102.83018909]
mat_Sqrt:  [[0.15]]
grads:  [-0.06271078]
Stock Position:  -0.06271077971411003
Bond Position:  [-3.71144347]


portfolio before change:  [-10.17620349]
curr_Stock_Price:  103.08109853670034
curr_Factors:  [103.08109854]
mat_Sqrt:  [[0.15]]
grads:  [-0.01823629]
Stock Position:  -0.018236291253331895
Bond Position:  [-8.29638655]


portfolio before change:  [-10.18331051]
curr_Stock_Price:  103.4139465050309
curr_Factors:  [103.41394651]
mat_Sqrt:  [[0.15]]
grads:  [0.0324434]
Stock Position:  0.03244339990908662
Bond Position:  [-13.53841054]


portfolio before change:  [-10.16628731]
curr_Stock_Price:  103.9908161621642
curr_Factors:  [103.99081616]
mat_Sqrt:  [[0.15]]
grads:  [0.03721916]
Stock Position:  0.03721915877134893
Bond Position:  [-14.03673801]


portfolio before change:  [-10.19704585]
curr_Stock_Price:  103.21154442443522
curr_Factors:  [103.21154442]
mat_Sqrt:  [[0.15]]
grads:  [-0.02871644]
Stock Position:  -0.028716442574680028
Bond Position:  [-7.23317746]


portfolio before change:  [-10.20630817]
curr_Stock_Price:  103.50260122877623
curr_Factors:  [103.50260123]
mat_Sqrt:  [[0.15]]
grads:  [0.05415099]
Stock Position:  0.05415099174972314
Bond Position:  [-15.81107667]


portfolio before change:  [-10.22267375]
curr_Stock_Price:  103.23687992346629
curr_Factors:  [103.23687992]
mat_Sqrt:  [[0.15]]
grads:  [0.03442335]
Stock Position:  0.03442335162197278
Bond Position:  [-13.77643317]


portfolio before change:  [-10.2437406]
curr_Stock_Price:  102.67491581936882
curr_Factors:  [102.67491582]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748714]
Stock Position:  -0.027487138127376805
Bond Position:  [-7.421501]


portfolio before change:  [-10.20828138]
curr_Stock_Price:  101.35113437351994
curr_Factors:  [101.35113437]
mat_Sqrt:  [[0.15]]
grads:  [0.05279251]
Stock Position:  0.052792509906420364
Bond Position:  [-15.55886215]


portfolio before change:  [-10.2480609]
curr_Stock_Price:  100.63446939821978
curr_Factors:  [100.6344694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.2480609]
Stock Price:  100.50846520638919
PL:  [-10.75652611]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.59585296e-03]
 [ 4.79531905e-03]
 [ 9.78630409e-03]
 [ 1.28273377e-03]
 [ 1.53175604e-02]
 [ 2.66048024e-02]
 [-1.93066629e-03]
 [ 1.56014470e-02]
 [-5.91144655e-03]
 [ 3.30578844e-03]
 [ 7.21554289e-03]
 [ 5.28310922e-03]
 [ 1.39098985e-02]
 [ 2.39253483e-03]
 [ 3.41828491e-03]
 [-3.33058615e-03]
 [ 1.48854635e-02]
 [-9.90759133e-03]
 [ 4.75403921e-03]
 [-3.56394359e-03]
 [ 7.36775988e-03]
 [ 1.11992646e-02]
 [ 1.79630261e-02]
 [ 4.70660388e-03]
 [ 1.65582813e-02]
 [-1.12818823e-02]
 [ 1.82179973e-02]
 [-1.93699266e-02]
 [-3.70914791e-02]
 [-2.66303903e-03]
 [-3.57569187e-03]
 [ 5.63900098e-03]
 [ 5.97908754e-03]
 [-1.19112320e-02]
 [ 1.85085753e-02]
 [ 5.47142348e-03]
 [-3.10454220e-03]
 [ 8.36505815e-03]
 [-1.51266316e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.32857098]
curr_Stock_Price:  100.41133490812764
curr_Factors:  [100.41133491]
mat_Sqrt:  [[0.15]]
grads:  [0.04397235]
Stock Position:  0.04397235303867164
Bond Position:  [3.91324832]


portfolio before change:  [8.32014125]
curr_Stock_Price:  100.20850469928236
curr_Factors:  [100.2085047]
mat_Sqrt:  [[0.15]]
grads:  [0.03196879]
Stock Position:  0.03196879364428686
Bond Position:  [5.11659624]


portfolio before change:  [8.32805298]
curr_Stock_Price:  100.43598009838753
curr_Factors:  [100.4359801]
mat_Sqrt:  [[0.15]]
grads:  [0.06524203]
Stock Position:  0.0652420272669645
Bond Position:  [1.77540602]


portfolio before change:  [8.38062553]
curr_Stock_Price:  101.23838638718127
curr_Factors:  [101.23838639]
mat_Sqrt:  [[0.15]]
grads:  [0.00855156]
Stock Position:  0.00855155847797296
Bond Position:  [7.51487955]


portfolio before change:  [8.37711287]
curr_Stock_Price:  100.71777079019853
curr_Factors:  [100.71777079]
mat_Sqrt:  [[0.15]]
grads:  [0.10211707]
Stock Position:  0.10211706947226576
Bond Position:  [-1.90789072]


portfolio before change:  [8.45846974]
curr_Stock_Price:  101.5168082810813
curr_Factors:  [101.51680828]
mat_Sqrt:  [[0.15]]
grads:  [0.17736535]
Stock Position:  0.17736534964181813
Bond Position:  [-9.54709446]


portfolio before change:  [8.42959265]
curr_Stock_Price:  101.36072575846184
curr_Factors:  [101.36072576]
mat_Sqrt:  [[0.15]]
grads:  [-0.01287111]
Stock Position:  -0.01287110856705294
Bond Position:  [9.73421755]


portfolio before change:  [8.4361427]
curr_Stock_Price:  100.94637115913541
curr_Factors:  [100.94637116]
mat_Sqrt:  [[0.15]]
grads:  [0.10400965]
Stock Position:  0.1040096469671095
Bond Position:  [-2.06325372]


portfolio before change:  [8.38222963]
curr_Stock_Price:  100.43050415276883
curr_Factors:  [100.43050415]
mat_Sqrt:  [[0.15]]
grads:  [-0.03940964]
Stock Position:  -0.03940964368895037
Bond Position:  [12.34016002]


portfolio before change:  [8.44691701]
curr_Stock_Price:  98.82823743675786
curr_Factors:  [98.82823744]
mat_Sqrt:  [[0.15]]
grads:  [0.02203859]
Stock Position:  0.0220385895697355
Bond Position:  [6.26888205]


portfolio before change:  [8.47441335]
curr_Stock_Price:  100.0403242864291
curr_Factors:  [100.04032429]
mat_Sqrt:  [[0.15]]
grads:  [0.04810362]
Stock Position:  0.04810361926112621
Bond Position:  [3.66211168]


portfolio before change:  [8.44648477]
curr_Stock_Price:  99.45021530189169
curr_Factors:  [99.4502153]
mat_Sqrt:  [[0.15]]
grads:  [0.03522073]
Stock Position:  0.03522072814165787
Bond Position:  [4.94377577]


portfolio before change:  [8.39094231]
curr_Stock_Price:  97.85568644237188
curr_Factors:  [97.85568644]
mat_Sqrt:  [[0.15]]
grads:  [0.09273266]
Stock Position:  0.0927326565499687
Bond Position:  [-0.68347545]


portfolio before change:  [8.43431701]
curr_Stock_Price:  98.3243469909138
curr_Factors:  [98.32434699]
mat_Sqrt:  [[0.15]]
grads:  [0.01595023]
Stock Position:  0.015950232177197207
Bond Position:  [6.86602085]


portfolio before change:  [8.43159363]
curr_Stock_Price:  98.09979329920859
curr_Factors:  [98.0997933]
mat_Sqrt:  [[0.15]]
grads:  [0.02278857]
Stock Position:  0.02278856608016457
Bond Position:  [6.19604001]


portfolio before change:  [8.43555043]
curr_Stock_Price:  98.23943528972379
curr_Factors:  [98.23943529]
mat_Sqrt:  [[0.15]]
grads:  [-0.02220391]
Stock Position:  -0.022203907636521206
Bond Position:  [10.61684977]


portfolio before change:  [8.44502806]
curr_Stock_Price:  97.87236289766764
curr_Factors:  [97.8723629]
mat_Sqrt:  [[0.15]]
grads:  [0.09923642]
Stock Position:  0.0992364234876381
Bond Position:  [-1.26747519]


portfolio before change:  [8.40467527]
curr_Stock_Price:  97.46732667655186
curr_Factors:  [97.46732668]
mat_Sqrt:  [[0.15]]
grads:  [-0.06605061]
Stock Position:  -0.06605060885891349
Bond Position:  [14.84245154]


portfolio before change:  [8.43529911]
curr_Stock_Price:  97.03177556602051
curr_Factors:  [97.03177557]
mat_Sqrt:  [[0.15]]
grads:  [0.03169359]
Stock Position:  0.03169359470329924
Bond Position:  [5.36001334]


portfolio before change:  [8.44893362]
curr_Stock_Price:  97.44083215984051
curr_Factors:  [97.44083216]
mat_Sqrt:  [[0.15]]
grads:  [-0.02375962]
Stock Position:  -0.023759623909325966
Bond Position:  [10.76409115]


portfolio before change:  [8.41223227]
curr_Stock_Price:  99.0421600806854
curr_Factors:  [99.04216008]
mat_Sqrt:  [[0.15]]
grads:  [0.0491184]
Stock Position:  0.04911839922650937
Bond Position:  [3.54743991]


portfolio before change:  [8.43993711]
curr_Stock_Price:  99.59717364410717
curr_Factors:  [99.59717364]
mat_Sqrt:  [[0.15]]
grads:  [0.07466176]
Stock Position:  0.07466176399886515
Bond Position:  [1.00383643]


portfolio before change:  [8.37501018]
curr_Stock_Price:  98.72587878280686
curr_Factors:  [98.72587878]
mat_Sqrt:  [[0.15]]
grads:  [0.11975351]
Stock Position:  0.11975350703194192
Bond Position:  [-3.44776004]


portfolio before change:  [8.28915647]
curr_Stock_Price:  98.01255762622944
curr_Factors:  [98.01255763]
mat_Sqrt:  [[0.15]]
grads:  [0.03137736]
Stock Position:  0.031377359187633326
Bond Position:  [5.21378125]


portfolio before change:  [8.28782631]
curr_Stock_Price:  97.94939329378629
curr_Factors:  [97.94939329]
mat_Sqrt:  [[0.15]]
grads:  [0.11038854]
Stock Position:  0.11038854220135899
Bond Position:  [-2.52466443]


portfolio before change:  [8.25886575]
curr_Stock_Price:  97.68990120241898
curr_Factors:  [97.6899012]
mat_Sqrt:  [[0.15]]
grads:  [-0.07521255]
Stock Position:  -0.07521254868818557
Bond Position:  [15.6063722]


portfolio before change:  [8.2944331]
curr_Stock_Price:  97.242948776224
curr_Factors:  [97.24294878]
mat_Sqrt:  [[0.15]]
grads:  [0.12145332]
Stock Position:  0.12145331550725984
Bond Position:  [-3.51604544]


portfolio before change:  [8.23996627]
curr_Stock_Price:  96.79810876924238
curr_Factors:  [96.79810877]
mat_Sqrt:  [[0.15]]
grads:  [-0.12913284]
Stock Position:  -0.1291328437151052
Bond Position:  [20.73978133]


portfolio before change:  [8.17044302]
curr_Stock_Price:  97.35657158987297
curr_Factors:  [97.35657159]
mat_Sqrt:  [[0.15]]
grads:  [-0.24727653]
Stock Position:  -0.24727652751815404
Bond Position:  [32.24443797]


portfolio before change:  [7.87467994]
curr_Stock_Price:  98.5689546725755
curr_Factors:  [98.56895467]
mat_Sqrt:  [[0.15]]
grads:  [-0.01775359]
Stock Position:  -0.017753593525724323
Bond Position:  [9.6246331]


portfolio before change:  [7.87432648]
curr_Stock_Price:  98.65663376723232
curr_Factors:  [98.65663377]
mat_Sqrt:  [[0.15]]
grads:  [-0.02383795]
Stock Position:  -0.023837945812158017
Bond Position:  [10.22609797]


portfolio before change:  [7.87544531]
curr_Stock_Price:  98.66332513781006
curr_Factors:  [98.66332514]
mat_Sqrt:  [[0.15]]
grads:  [0.03759334]
Stock Position:  0.03759333989203775
Bond Position:  [4.1663614]


portfolio before change:  [7.90537331]
curr_Stock_Price:  99.44556916000131
curr_Factors:  [99.44556916]
mat_Sqrt:  [[0.15]]
grads:  [0.03986058]
Stock Position:  0.039860583581262994
Bond Position:  [3.94141489]


portfolio before change:  [7.90349955]
curr_Stock_Price:  99.38620052332587
curr_Factors:  [99.38620052]
mat_Sqrt:  [[0.15]]
grads:  [-0.07940821]
Stock Position:  -0.07940821326349884
Bond Position:  [15.79558015]


portfolio before change:  [7.85868724]
curr_Stock_Price:  99.97539498884542
curr_Factors:  [99.97539499]
mat_Sqrt:  [[0.15]]
grads:  [0.1233905]
Stock Position:  0.12339050168839355
Bond Position:  [-4.47732691]


portfolio before change:  [8.10380828]
curr_Stock_Price:  101.9664781098641
curr_Factors:  [101.96647811]
mat_Sqrt:  [[0.15]]
grads:  [0.03647616]
Stock Position:  0.03647615653617723
Bond Position:  [4.38446306]


portfolio before change:  [8.12321009]
curr_Stock_Price:  102.48335580868223
curr_Factors:  [102.48335581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069695]
Stock Position:  -0.020696947996942043
Bond Position:  [10.24430277]


portfolio before change:  [8.1348227]
curr_Stock_Price:  101.98415195365347
curr_Factors:  [101.98415195]
mat_Sqrt:  [[0.15]]
grads:  [0.05576705]
Stock Position:  0.05576705435004743
Bond Position:  [2.44746695]


portfolio before change:  [8.13437491]
curr_Stock_Price:  101.97063602902296
curr_Factors:  [101.97063603]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.13437491]
Stock Price:  101.62419162670467
PL:  [6.51018328]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.67829668e-03]
 [-2.38492756e-03]
 [ 1.06450942e-02]
 [-2.86454589e-03]
 [ 1.42565887e-02]
 [ 2.55719865e-02]
 [-4.60795359e-03]
 [ 1.33167044e-02]
 [-6.24013859e-03]
 [-1.00485431e-03]
 [ 1.01149229e-02]
 [ 5.41429966e-03]
 [ 4.53462000e-03]
 [-4.02161101e-03]
 [ 7.27594423e-03]
 [ 3.38423762e-03]
 [ 9.13259451e-03]
 [ 2.03673446e-03]
 [ 1.22238753e-02]
 [-1.68339385e-02]
 [ 9.41856632e-03]
 [ 3.86688566e-02]
 [-9.62013464e-03]
 [ 8.07815156e-03]
 [ 7.34980275e-03]
 [-1.35891845e-02]
 [-5.00219037e-04]
 [-1.07211962e-02]
 [ 3.99879287e-02]
 [-9.66703427e-03]
 [-3.96699781e-03]
 [ 4.76014694e-03]
 [ 5.55144650e-03]
 [-3.62370340e-03]
 [ 7.13508367e-03]
 [ 4.79638956e-03]
 [-1.64429896e-02]
 [ 9.84687932e-03]
 [-9.12959605e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.93494238]
curr_Stock_Price:  100.96652649745069
curr_Factors:  [100.9665265]
mat_Sqrt:  [[0.15]]
grads:  [0.04452198]
Stock Position:  0.04452197787319367
Bond Position:  [12.43971292]


portfolio before change:  [16.96280259]
curr_Stock_Price:  101.55736156876193
curr_Factors:  [101.55736157]
mat_Sqrt:  [[0.15]]
grads:  [-0.01589952]
Stock Position:  -0.01589951703553511
Bond Position:  [18.57751559]


portfolio before change:  [16.98089463]
curr_Stock_Price:  100.5655259408242
curr_Factors:  [100.56552594]
mat_Sqrt:  [[0.15]]
grads:  [0.07096729]
Stock Position:  0.0709672946673851
Bond Position:  [9.84403132]


portfolio before change:  [16.95670508]
curr_Stock_Price:  100.20733089843871
curr_Factors:  [100.2073309]
mat_Sqrt:  [[0.15]]
grads:  [-0.01909697]
Stock Position:  -0.019096972620562543
Bond Position:  [18.87036173]


portfolio before change:  [16.93570449]
curr_Stock_Price:  101.43053657879418
curr_Factors:  [101.43053658]
mat_Sqrt:  [[0.15]]
grads:  [0.09504392]
Stock Position:  0.09504392451926533
Bond Position:  [7.29534823]


portfolio before change:  [16.86066142]
curr_Stock_Price:  100.63137927076326
curr_Factors:  [100.63137927]
mat_Sqrt:  [[0.15]]
grads:  [0.17047991]
Stock Position:  0.17047991016010655
Bond Position:  [-0.29496708]


portfolio before change:  [16.92434696]
curr_Stock_Price:  101.00516178535483
curr_Factors:  [101.00516179]
mat_Sqrt:  [[0.15]]
grads:  [-0.03071969]
Stock Position:  -0.030719690619877272
Bond Position:  [20.02719428]


portfolio before change:  [16.91778136]
curr_Stock_Price:  101.30038459779176
curr_Factors:  [101.3003846]
mat_Sqrt:  [[0.15]]
grads:  [0.08877803]
Stock Position:  0.08877802903524426
Bond Position:  [7.92453288]


portfolio before change:  [16.86219407]
curr_Stock_Price:  100.66308819189064
curr_Factors:  [100.66308819]
mat_Sqrt:  [[0.15]]
grads:  [-0.04160092]
Stock Position:  -0.041600923902708205
Bond Position:  [21.04987154]


portfolio before change:  [16.84596882]
curr_Stock_Price:  101.11636292264375
curr_Factors:  [101.11636292]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669903]
Stock Position:  -0.006699028743959761
Bond Position:  [17.52335024]


portfolio before change:  [16.84479166]
curr_Stock_Price:  101.61908022753082
curr_Factors:  [101.61908023]
mat_Sqrt:  [[0.15]]
grads:  [0.06743282]
Stock Position:  0.06743281933718917
Bond Position:  [9.99233058]


portfolio before change:  [16.86298188]
curr_Stock_Price:  101.870309610897
curr_Factors:  [101.87030961]
mat_Sqrt:  [[0.15]]
grads:  [0.03609533]
Stock Position:  0.03609533108040157
Bond Position:  [13.18593933]


portfolio before change:  [16.91618893]
curr_Stock_Price:  103.29871314430507
curr_Factors:  [103.29871314]
mat_Sqrt:  [[0.15]]
grads:  [0.0302308]
Stock Position:  0.030230800009660257
Bond Position:  [13.79338619]


portfolio before change:  [16.93136135]
curr_Stock_Price:  103.74356204468296
curr_Factors:  [103.74356204]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681074]
Stock Position:  -0.026810740099735723
Bond Position:  [19.71280303]


portfolio before change:  [16.94838365]
curr_Stock_Price:  103.20056880934256
curr_Factors:  [103.20056881]
mat_Sqrt:  [[0.15]]
grads:  [0.04850629]
Stock Position:  0.04850629484746747
Bond Position:  [11.94250643]


portfolio before change:  [16.98672512]
curr_Stock_Price:  103.9602343986203
curr_Factors:  [103.9602344]
mat_Sqrt:  [[0.15]]
grads:  [0.02256158]
Stock Position:  0.022561584166060262
Bond Position:  [14.64121754]


portfolio before change:  [16.98890296]
curr_Stock_Price:  103.97563990994384
curr_Factors:  [103.97563991]
mat_Sqrt:  [[0.15]]
grads:  [0.06088396]
Stock Position:  0.06088396340967394
Bond Position:  [10.65845391]


portfolio before change:  [16.99105871]
curr_Stock_Price:  103.98916338730557
curr_Factors:  [103.98916339]
mat_Sqrt:  [[0.15]]
grads:  [0.01357823]
Stock Position:  0.013578229727856777
Bond Position:  [15.57906996]


portfolio before change:  [17.01048799]
curr_Stock_Price:  105.27664879760819
curr_Factors:  [105.2766488]
mat_Sqrt:  [[0.15]]
grads:  [0.0814925]
Stock Position:  0.08149250221981193
Bond Position:  [8.43123046]


portfolio before change:  [16.96955152]
curr_Stock_Price:  104.76138128432392
curr_Factors:  [104.76138128]
mat_Sqrt:  [[0.15]]
grads:  [-0.11222626]
Stock Position:  -0.11222625662932938
Bond Position:  [28.72652918]


portfolio before change:  [16.96759896]
curr_Stock_Price:  104.8107779419837
curr_Factors:  [104.81077794]
mat_Sqrt:  [[0.15]]
grads:  [0.06279044]
Stock Position:  0.06279044214402249
Bond Position:  [10.38648387]


portfolio before change:  [16.99594553]
curr_Stock_Price:  105.24154698912722
curr_Factors:  [105.24154699]
mat_Sqrt:  [[0.15]]
grads:  [0.25779238]
Stock Position:  0.25779237714934017
Bond Position:  [-10.13452304]


portfolio before change:  [16.92951209]
curr_Stock_Price:  104.98876002493898
curr_Factors:  [104.98876002]
mat_Sqrt:  [[0.15]]
grads:  [-0.06413423]
Stock Position:  -0.06413423092366882
Bond Position:  [23.66288547]


portfolio before change:  [16.95291734]
curr_Stock_Price:  104.66994100159997
curr_Factors:  [104.669941]
mat_Sqrt:  [[0.15]]
grads:  [0.05385434]
Stock Position:  0.05385434372689776
Bond Position:  [11.31598636]


portfolio before change:  [16.9355276]
curr_Stock_Price:  104.32077090239267
curr_Factors:  [104.3207709]
mat_Sqrt:  [[0.15]]
grads:  [0.04899869]
Stock Position:  0.04899868501423482
Bond Position:  [11.82394701]


portfolio before change:  [16.93408994]
curr_Stock_Price:  104.26126421769598
curr_Factors:  [104.26126422]
mat_Sqrt:  [[0.15]]
grads:  [-0.09059456]
Stock Position:  -0.09059456348085793
Bond Position:  [26.37959366]


portfolio before change:  [16.92790371]
curr_Stock_Price:  104.36594914534598
curr_Factors:  [104.36594915]
mat_Sqrt:  [[0.15]]
grads:  [-0.00333479]
Stock Position:  -0.003334793578095862
Bond Position:  [17.27594261]


portfolio before change:  [16.93237449]
curr_Stock_Price:  103.67290775895223
curr_Factors:  [103.67290776]
mat_Sqrt:  [[0.15]]
grads:  [-0.07147464]
Stock Position:  -0.071474641241054
Bond Position:  [24.34235838]


portfolio before change:  [16.99739347]
curr_Stock_Price:  102.80580301957887
curr_Factors:  [102.80580302]
mat_Sqrt:  [[0.15]]
grads:  [0.26658619]
Stock Position:  0.2665861910921652
Bond Position:  [-10.40921398]


portfolio before change:  [16.96687622]
curr_Stock_Price:  102.69620986739798
curr_Factors:  [102.69620987]
mat_Sqrt:  [[0.15]]
grads:  [-0.0644469]
Stock Position:  -0.06444689515301405
Bond Position:  [23.58532809]


portfolio before change:  [16.91619438]
curr_Stock_Price:  103.52837082776158
curr_Factors:  [103.52837083]
mat_Sqrt:  [[0.15]]
grads:  [-0.02644665]
Stock Position:  -0.026446652063613473
Bond Position:  [19.65417318]


portfolio before change:  [16.90763417]
curr_Stock_Price:  103.94495034693361
curr_Factors:  [103.94495035]
mat_Sqrt:  [[0.15]]
grads:  [0.03173431]
Stock Position:  0.031734312932021454
Bond Position:  [13.60901259]


portfolio before change:  [16.90852623]
curr_Stock_Price:  103.91945203088282
curr_Factors:  [103.91945203]
mat_Sqrt:  [[0.15]]
grads:  [0.03700964]
Stock Position:  0.03700964331114233
Bond Position:  [13.06250438]


portfolio before change:  [16.92611897]
curr_Stock_Price:  104.35068622870388
curr_Factors:  [104.35068623]
mat_Sqrt:  [[0.15]]
grads:  [-0.02415802]
Stock Position:  -0.024158022639388262
Bond Position:  [19.44702521]


portfolio before change:  [16.91315822]
curr_Stock_Price:  104.987815585193
curr_Factors:  [104.98781559]
mat_Sqrt:  [[0.15]]
grads:  [0.04756722]
Stock Position:  0.04756722443755207
Bond Position:  [11.91917923]


portfolio before change:  [16.88044115]
curr_Stock_Price:  104.26868468316891
curr_Factors:  [104.26868468]
mat_Sqrt:  [[0.15]]
grads:  [0.03197593]
Stock Position:  0.03197593036892732
Bond Position:  [13.54635294]


portfolio before change:  [16.88138453]
curr_Stock_Price:  104.24522917606379
curr_Factors:  [104.24522918]
mat_Sqrt:  [[0.15]]
grads:  [-0.10961993]
Stock Position:  -0.10961993068648875
Bond Position:  [28.30873933]


portfolio before change:  [16.91709205]
curr_Stock_Price:  103.95177244875624
curr_Factors:  [103.95177245]
mat_Sqrt:  [[0.15]]
grads:  [0.06564586]
Stock Position:  0.06564586210805272
Bond Position:  [10.09308833]


portfolio before change:  [17.03545178]
curr_Stock_Price:  105.735555982448
curr_Factors:  [105.73555598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.03545178]
Stock Price:  106.1240063282623
PL:  [10.91144545]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.65002314e-03]
 [ 3.81990290e-03]
 [-9.56238119e-04]
 [ 6.82314072e-03]
 [-2.53196118e-02]
 [-2.79481812e-02]
 [-4.56688787e-02]
 [ 2.16357721e-02]
 [-6.03336323e-03]
 [ 5.98461436e-04]
 [-8.60366789e-03]
 [ 7.50468697e-03]
 [ 1.39000778e-02]
 [ 2.21394063e-03]
 [-1.79843399e-03]
 [-6.96711723e-03]
 [ 1.69059933e-02]
 [-1.08903763e-02]
 [ 5.59781036e-03]
 [-5.16184815e-03]
 [ 1.76097057e-02]
 [ 3.03039117e-03]
 [ 1.94369135e-02]
 [ 4.74223892e-03]
 [ 1.54190651e-02]
 [-1.09091343e-02]
 [ 1.43670198e-02]
 [-1.29880591e-02]
 [-4.03931483e-02]
 [-1.07635720e-03]
 [-4.00042373e-03]
 [ 5.61542848e-03]
 [ 8.04827794e-03]
 [-1.26363340e-02]
 [ 3.08017047e-03]
 [ 5.61862304e-03]
 [ 3.58888793e-03]
 [ 1.15417064e-02]
 [-2.91585426e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.62724962]
curr_Stock_Price:  99.18850687988834
curr_Factors:  [99.18850688]
mat_Sqrt:  [[0.15]]
grads:  [0.04433349]
Stock Position:  0.0443334875830712
Bond Position:  [-15.02462205]


portfolio before change:  [-10.5970888]
curr_Stock_Price:  99.91118885491942
curr_Factors:  [99.91118885]
mat_Sqrt:  [[0.15]]
grads:  [0.02546602]
Stock Position:  0.025466019347353843
Bond Position:  [-13.14142907]


portfolio before change:  [-10.61400458]
curr_Stock_Price:  99.31144835616652
curr_Factors:  [99.31144836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00637492]
Stock Position:  -0.006374920792055927
Bond Position:  [-9.98090197]


portfolio before change:  [-10.60343084]
curr_Stock_Price:  97.4570831190869
curr_Factors:  [97.45708312]
mat_Sqrt:  [[0.15]]
grads:  [0.0454876]
Stock Position:  0.04548760480555634
Bond Position:  [-15.03652012]


portfolio before change:  [-10.57923853]
curr_Stock_Price:  98.03025010854752
curr_Factors:  [98.03025011]
mat_Sqrt:  [[0.15]]
grads:  [-0.16879741]
Stock Position:  -0.16879741193159298
Bond Position:  [5.96801398]


portfolio before change:  [-10.54477634]
curr_Stock_Price:  97.83050687646985
curr_Factors:  [97.83050688]
mat_Sqrt:  [[0.15]]
grads:  [-0.18632121]
Stock Position:  -0.18632120804984464
Bond Position:  [7.68312188]


portfolio before change:  [-10.46566971]
curr_Stock_Price:  97.41109042790826
curr_Factors:  [97.41109043]
mat_Sqrt:  [[0.15]]
grads:  [-0.30445919]
Stock Position:  -0.3044591913726376
Bond Position:  [19.19203211]


portfolio before change:  [-10.83818578]
curr_Stock_Price:  98.64250412305584
curr_Factors:  [98.64250412]
mat_Sqrt:  [[0.15]]
grads:  [0.14423848]
Stock Position:  0.14423848056568792
Bond Position:  [-25.06623069]


portfolio before change:  [-10.91839116]
curr_Stock_Price:  98.10816746580967
curr_Factors:  [98.10816747]
mat_Sqrt:  [[0.15]]
grads:  [-0.04022242]
Stock Position:  -0.04022242152366111
Bond Position:  [-6.97224309]


portfolio before change:  [-10.92373158]
curr_Stock_Price:  98.21927066335927
curr_Factors:  [98.21927066]
mat_Sqrt:  [[0.15]]
grads:  [0.00398974]
Stock Position:  0.003989742905037563
Bond Position:  [-11.31560122]


portfolio before change:  [-10.92990599]
curr_Stock_Price:  97.02624452657116
curr_Factors:  [97.02624453]
mat_Sqrt:  [[0.15]]
grads:  [-0.05735779]
Stock Position:  -0.057357785927297025
Bond Position:  [-5.36469543]


portfolio before change:  [-10.928153]
curr_Stock_Price:  96.98399006681115
curr_Factors:  [96.98399007]
mat_Sqrt:  [[0.15]]
grads:  [0.05003125]
Stock Position:  0.05003124646023171
Bond Position:  [-15.78038291]


portfolio before change:  [-10.91982162]
curr_Stock_Price:  97.18994230818173
curr_Factors:  [97.18994231]
mat_Sqrt:  [[0.15]]
grads:  [0.09266719]
Stock Position:  0.09266718520639329
Bond Position:  [-19.92614]


portfolio before change:  [-10.89044576]
curr_Stock_Price:  97.53382655096033
curr_Factors:  [97.53382655]
mat_Sqrt:  [[0.15]]
grads:  [0.0147596]
Stock Position:  0.014759604226889789
Bond Position:  [-12.33000644]


portfolio before change:  [-10.90389313]
curr_Stock_Price:  96.72716336153078
curr_Factors:  [96.72716336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198956]
Stock Position:  -0.011989559929999501
Bond Position:  [-9.74417701]


portfolio before change:  [-10.90040623]
curr_Stock_Price:  96.33473865576313
curr_Factors:  [96.33473866]
mat_Sqrt:  [[0.15]]
grads:  [-0.04644745]
Stock Position:  -0.04644744819398013
Bond Position:  [-6.42590345]


portfolio before change:  [-10.93627032]
curr_Stock_Price:  97.08958749214509
curr_Factors:  [97.08958749]
mat_Sqrt:  [[0.15]]
grads:  [0.11270662]
Stock Position:  0.11270662214038182
Bond Position:  [-21.87890978]


portfolio before change:  [-10.9454311]
curr_Stock_Price:  97.03257450427036
curr_Factors:  [97.0325745]
mat_Sqrt:  [[0.15]]
grads:  [-0.07260251]
Stock Position:  -0.07260250896653588
Bond Position:  [-3.90062274]


portfolio before change:  [-10.98121589]
curr_Stock_Price:  97.51874474967981
curr_Factors:  [97.51874475]
mat_Sqrt:  [[0.15]]
grads:  [0.03731874]
Stock Position:  0.037318735709142285
Bond Position:  [-14.62049215]


portfolio before change:  [-10.96782353]
curr_Stock_Price:  97.926583695503
curr_Factors:  [97.9265837]
mat_Sqrt:  [[0.15]]
grads:  [-0.03441232]
Stock Position:  -0.03441232100379972
Bond Position:  [-7.5979425]


portfolio before change:  [-10.96389905]
curr_Stock_Price:  97.78494006649525
curr_Factors:  [97.78494007]
mat_Sqrt:  [[0.15]]
grads:  [0.11739804]
Stock Position:  0.11739803773161353
Bond Position:  [-22.44365913]


portfolio before change:  [-10.8761068]
curr_Stock_Price:  98.55665549145249
curr_Factors:  [98.55665549]
mat_Sqrt:  [[0.15]]
grads:  [0.02020261]
Stock Position:  0.020202607817038434
Bond Position:  [-12.86720826]


portfolio before change:  [-10.88521421]
curr_Stock_Price:  98.18547049621993
curr_Factors:  [98.1854705]
mat_Sqrt:  [[0.15]]
grads:  [0.12957942]
Stock Position:  0.12957942334811234
Bond Position:  [-23.60803086]


portfolio before change:  [-10.89806484]
curr_Stock_Price:  98.10907375272227
curr_Factors:  [98.10907375]
mat_Sqrt:  [[0.15]]
grads:  [0.03161493]
Stock Position:  0.031614926113152454
Bond Position:  [-13.99977596]


portfolio before change:  [-10.89814811]
curr_Stock_Price:  98.16179615535864
curr_Factors:  [98.16179616]
mat_Sqrt:  [[0.15]]
grads:  [0.10279377]
Stock Position:  0.10279376756697406
Bond Position:  [-20.98856897]


portfolio before change:  [-10.8672476]
curr_Stock_Price:  98.48792723247911
curr_Factors:  [98.48792723]
mat_Sqrt:  [[0.15]]
grads:  [-0.07272756]
Stock Position:  -0.0727275622517728
Bond Position:  [-3.70446074]


portfolio before change:  [-10.87296092]
curr_Stock_Price:  98.56011766844279
curr_Factors:  [98.56011767]
mat_Sqrt:  [[0.15]]
grads:  [0.09578013]
Stock Position:  0.09578013189646412
Bond Position:  [-20.31306199]


portfolio before change:  [-10.92184884]
curr_Stock_Price:  98.07621124103933
curr_Factors:  [98.07621124]
mat_Sqrt:  [[0.15]]
grads:  [-0.08658706]
Stock Position:  -0.0865870607357043
Bond Position:  [-2.42971798]


portfolio before change:  [-10.84497187]
curr_Stock_Price:  97.18484593540583
curr_Factors:  [97.18484594]
mat_Sqrt:  [[0.15]]
grads:  [-0.26928766]
Stock Position:  -0.2692876552990912
Bond Position:  [15.32570742]


portfolio before change:  [-10.98719915]
curr_Stock_Price:  97.72012154313965
curr_Factors:  [97.72012154]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717571]
Stock Position:  -0.0071757146353606535
Bond Position:  [-10.28598744]


portfolio before change:  [-10.98399598]
curr_Stock_Price:  97.09454036984006
curr_Factors:  [97.09454037]
mat_Sqrt:  [[0.15]]
grads:  [-0.02666949]
Stock Position:  -0.02666949155534542
Bond Position:  [-8.39453396]


portfolio before change:  [-10.99993404]
curr_Stock_Price:  97.65280663865684
curr_Factors:  [97.65280664]
mat_Sqrt:  [[0.15]]
grads:  [0.03743619]
Stock Position:  0.037436189896876484
Bond Position:  [-14.65568306]


portfolio before change:  [-10.9856755]
curr_Stock_Price:  98.08262127972618
curr_Factors:  [98.08262128]
mat_Sqrt:  [[0.15]]
grads:  [0.05365519]
Stock Position:  0.05365518626403269
Bond Position:  [-16.24831681]


portfolio before change:  [-11.021567]
curr_Stock_Price:  97.45154834608692
curr_Factors:  [97.45154835]
mat_Sqrt:  [[0.15]]
grads:  [-0.08424223]
Stock Position:  -0.08424222645800937
Bond Position:  [-2.81203159]


portfolio before change:  [-10.9946754]
curr_Stock_Price:  97.12815802168511
curr_Factors:  [97.12815802]
mat_Sqrt:  [[0.15]]
grads:  [0.02053447]
Stock Position:  0.02053446980683952
Bond Position:  [-12.98915063]


portfolio before change:  [-11.00669864]
curr_Stock_Price:  96.62171760011161
curr_Factors:  [96.6217176]
mat_Sqrt:  [[0.15]]
grads:  [0.03745749]
Stock Position:  0.03745748690718223
Bond Position:  [-14.62590536]


portfolio before change:  [-10.97157835]
curr_Stock_Price:  97.60813283593524
curr_Factors:  [97.60813284]
mat_Sqrt:  [[0.15]]
grads:  [0.02392592]
Stock Position:  0.02392591955368694
Bond Position:  [-13.30694269]


portfolio before change:  [-10.99647504]
curr_Stock_Price:  96.63708471722738
curr_Factors:  [96.63708472]
mat_Sqrt:  [[0.15]]
grads:  [0.07694471]
Stock Position:  0.0769447095779523
Bond Position:  [-18.43218746]


portfolio before change:  [-10.9989704]
curr_Stock_Price:  96.6345999470196
curr_Factors:  [96.63459995]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.9989704]
Stock Price:  96.78464212168396
PL:  [-10.9989704]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.06771898e-02]
 [-5.23405960e-03]
 [-6.37119860e-03]
 [-6.03059400e-05]
 [ 9.41165877e-03]
 [ 1.17328684e-02]
 [-7.38007653e-03]
 [ 2.35699084e-02]
 [-5.84636014e-03]
 [ 4.23153281e-03]
 [ 6.02708759e-03]
 [ 4.26324864e-03]
 [ 1.17991590e-02]
 [-2.48937810e-03]
 [ 1.50970610e-02]
 [-3.12725843e-03]
 [ 1.36044576e-02]
 [-8.45072399e-03]
 [ 7.96771356e-03]
 [-6.52437601e-03]
 [ 1.86982869e-02]
 [-3.30228267e-03]
 [ 2.32916964e-02]
 [ 4.13066085e-03]
 [ 1.52875104e-02]
 [-2.75038902e-03]
 [ 1.86992818e-02]
 [-2.05762024e-02]
 [-3.22240475e-02]
 [-2.64140478e-03]
 [-3.53458139e-03]
 [ 5.64038494e-03]
 [ 6.65683399e-03]
 [-1.18867558e-02]
 [ 1.56196608e-02]
 [ 5.50110659e-03]
 [ 3.07484358e-03]
 [ 7.84827909e-03]
 [-2.99913823e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.53288933]
curr_Stock_Price:  98.61400968025869
curr_Factors:  [98.61400968]
mat_Sqrt:  [[0.15]]
grads:  [0.07118127]
Stock Position:  0.07118126554626876
Bond Position:  [-26.55235934]


portfolio before change:  [-19.49356333]
curr_Stock_Price:  99.21311744108277
curr_Factors:  [99.21311744]
mat_Sqrt:  [[0.15]]
grads:  [-0.03489373]
Stock Position:  -0.03489373063400975
Bond Position:  [-16.03164754]


portfolio before change:  [-19.4892649]
curr_Stock_Price:  99.03249706613398
curr_Factors:  [99.03249707]
mat_Sqrt:  [[0.15]]
grads:  [-0.04247466]
Stock Position:  -0.042474657319989055
Bond Position:  [-15.28289352]


portfolio before change:  [-19.47697873]
curr_Stock_Price:  98.69825893548287
curr_Factors:  [98.69825894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00040204]
Stock Position:  -0.0004020395999007468
Bond Position:  [-19.43729812]


portfolio before change:  [-19.47967306]
curr_Stock_Price:  99.35619861969762
curr_Factors:  [99.35619862]
mat_Sqrt:  [[0.15]]
grads:  [0.06274439]
Stock Position:  0.06274439177890051
Bond Position:  [-25.71371731]


portfolio before change:  [-19.45250846]
curr_Stock_Price:  99.84036965751528
curr_Factors:  [99.84036966]
mat_Sqrt:  [[0.15]]
grads:  [0.07821912]
Stock Position:  0.07821912257912107
Bond Position:  [-27.26193457]


portfolio before change:  [-19.48278476]
curr_Stock_Price:  99.4968685830705
curr_Factors:  [99.49686858]
mat_Sqrt:  [[0.15]]
grads:  [-0.04920051]
Stock Position:  -0.04920051016831429
Bond Position:  [-14.58748807]


portfolio before change:  [-19.47414286]
curr_Stock_Price:  99.28415836516037
curr_Factors:  [99.28415837]
mat_Sqrt:  [[0.15]]
grads:  [0.15713272]
Stock Position:  0.157132722769829
Bond Position:  [-35.07493299]


portfolio before change:  [-19.47926045]
curr_Stock_Price:  99.27949386014011
curr_Factors:  [99.27949386]
mat_Sqrt:  [[0.15]]
grads:  [-0.03897573]
Stock Position:  -0.03897573428232693
Bond Position:  [-15.60976928]


portfolio before change:  [-19.49245537]
curr_Stock_Price:  99.56797022962417
curr_Factors:  [99.56797023]
mat_Sqrt:  [[0.15]]
grads:  [0.02821022]
Stock Position:  0.02821021873622735
Bond Position:  [-22.30128959]


portfolio before change:  [-19.48616046]
curr_Stock_Price:  99.88993665512798
curr_Factors:  [99.88993666]
mat_Sqrt:  [[0.15]]
grads:  [0.04018058]
Stock Position:  0.04018058391635229
Bond Position:  [-23.49979645]


portfolio before change:  [-19.44867477]
curr_Stock_Price:  100.89597849169519
curr_Factors:  [100.89597849]
mat_Sqrt:  [[0.15]]
grads:  [0.02842166]
Stock Position:  0.028421657591788583
Bond Position:  [-22.31630573]


portfolio before change:  [-19.44695386]
curr_Stock_Price:  101.05468221985915
curr_Factors:  [101.05468222]
mat_Sqrt:  [[0.15]]
grads:  [0.07866106]
Stock Position:  0.0786610599584906
Bond Position:  [-27.39602228]


portfolio before change:  [-19.4477866]
curr_Stock_Price:  101.08763348517881
curr_Factors:  [101.08763349]
mat_Sqrt:  [[0.15]]
grads:  [-0.01659585]
Stock Position:  -0.01659585399520425
Bond Position:  [-17.77015099]


portfolio before change:  [-19.42727802]
curr_Stock_Price:  99.71801543056989
curr_Factors:  [99.71801543]
mat_Sqrt:  [[0.15]]
grads:  [0.10064707]
Stock Position:  0.10064707366288816
Bond Position:  [-29.46360447]


portfolio before change:  [-19.48335158]
curr_Stock_Price:  99.19747993520917
curr_Factors:  [99.19747994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084839]
Stock Position:  -0.020848389546289973
Bond Position:  [-17.41524388]


portfolio before change:  [-19.46829721]
curr_Stock_Price:  98.37096950726907
curr_Factors:  [98.37096951]
mat_Sqrt:  [[0.15]]
grads:  [0.09069638]
Stock Position:  0.0906963841942409
Bond Position:  [-28.39018845]


portfolio before change:  [-19.49535217]
curr_Stock_Price:  98.11179747004094
curr_Factors:  [98.11179747]
mat_Sqrt:  [[0.15]]
grads:  [-0.05633816]
Stock Position:  -0.05633815995023728
Bond Position:  [-13.96791403]


portfolio before change:  [-19.52167083]
curr_Stock_Price:  98.54795943919646
curr_Factors:  [98.54795944]
mat_Sqrt:  [[0.15]]
grads:  [0.05311809]
Stock Position:  0.053118090386012964
Bond Position:  [-24.75635025]


portfolio before change:  [-19.53788018]
curr_Stock_Price:  98.3010641445156
curr_Factors:  [98.30106414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04349584]
Stock Position:  -0.04349584004185709
Bond Position:  [-15.26219281]


portfolio before change:  [-19.51112928]
curr_Stock_Price:  97.6421783252092
curr_Factors:  [97.64217833]
mat_Sqrt:  [[0.15]]
grads:  [0.12465525]
Stock Position:  0.12465524608621367
Bond Position:  [-31.68273905]


portfolio before change:  [-19.65905704]
curr_Stock_Price:  96.48725565520782
curr_Factors:  [96.48725566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02201522]
Stock Position:  -0.02201521779698921
Bond Position:  [-17.53486909]


portfolio before change:  [-19.67217138]
curr_Stock_Price:  96.98338290290327
curr_Factors:  [96.9833829]
mat_Sqrt:  [[0.15]]
grads:  [0.15527798]
Stock Position:  0.1552779763244345
Bond Position:  [-34.73155482]


portfolio before change:  [-19.72091824]
curr_Stock_Price:  96.6974109513491
curr_Factors:  [96.69741095]
mat_Sqrt:  [[0.15]]
grads:  [0.02753774]
Stock Position:  0.027537739017146543
Bond Position:  [-22.38374631]


portfolio before change:  [-19.7258706]
curr_Stock_Price:  96.61918324515653
curr_Factors:  [96.61918325]
mat_Sqrt:  [[0.15]]
grads:  [0.10191674]
Stock Position:  0.10191673630244441
Bond Position:  [-29.57298242]


portfolio before change:  [-19.79993887]
curr_Stock_Price:  95.92870372752846
curr_Factors:  [95.92870373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833593]
Stock Position:  -0.01833592680372144
Bond Position:  [-18.04099718]


portfolio before change:  [-19.82415818]
curr_Stock_Price:  97.12657288876215
curr_Factors:  [97.12657289]
mat_Sqrt:  [[0.15]]
grads:  [0.12466188]
Stock Position:  0.12466187897420235
Bond Position:  [-31.93213926]


portfolio before change:  [-19.91262344]
curr_Stock_Price:  96.44895198709962
curr_Factors:  [96.44895199]
mat_Sqrt:  [[0.15]]
grads:  [-0.13717468]
Stock Position:  -0.1371746825254584
Bond Position:  [-6.68226907]


portfolio before change:  [-20.07268886]
curr_Stock_Price:  97.60973532065003
curr_Factors:  [97.60973532]
mat_Sqrt:  [[0.15]]
grads:  [-0.21482698]
Stock Position:  -0.21482698324402935
Bond Position:  [0.89651611]


portfolio before change:  [-20.27710841]
curr_Stock_Price:  98.56181135703525
curr_Factors:  [98.56181136]
mat_Sqrt:  [[0.15]]
grads:  [-0.01760937]
Stock Position:  -0.017609365207298333
Bond Position:  [-18.54149748]


portfolio before change:  [-20.28361231]
curr_Stock_Price:  98.79952955083894
curr_Factors:  [98.79952955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02356388]
Stock Position:  -0.023563875914194305
Bond Position:  [-17.95551246]


portfolio before change:  [-20.28404539]
curr_Stock_Price:  98.72265349451743
curr_Factors:  [98.72265349]
mat_Sqrt:  [[0.15]]
grads:  [0.03760257]
Stock Position:  0.0376025662950945
Bond Position:  [-23.99627052]


portfolio before change:  [-20.27995041]
curr_Stock_Price:  98.91132959636117
curr_Factors:  [98.9113296]
mat_Sqrt:  [[0.15]]
grads:  [0.04437889]
Stock Position:  0.044378893272994296
Bond Position:  [-24.66952575]


portfolio before change:  [-20.25585216]
curr_Stock_Price:  99.52383098638967
curr_Factors:  [99.52383099]
mat_Sqrt:  [[0.15]]
grads:  [-0.07924504]
Stock Position:  -0.07924503885636729
Bond Position:  [-12.36908231]


portfolio before change:  [-20.26440527]
curr_Stock_Price:  99.61225141599043
curr_Factors:  [99.61225142]
mat_Sqrt:  [[0.15]]
grads:  [0.10413107]
Stock Position:  0.1041310720442418
Bond Position:  [-30.6371358]


portfolio before change:  [-20.16435187]
curr_Stock_Price:  100.60987179597477
curr_Factors:  [100.6098718]
mat_Sqrt:  [[0.15]]
grads:  [0.03667404]
Stock Position:  0.03667404394994211
Bond Position:  [-23.85412273]


portfolio before change:  [-20.22479794]
curr_Stock_Price:  99.04298392399389
curr_Factors:  [99.04298392]
mat_Sqrt:  [[0.15]]
grads:  [0.02049896]
Stock Position:  0.02049895719507444
Bond Position:  [-22.25507583]


portfolio before change:  [-20.18788672]
curr_Stock_Price:  100.97933976672404
curr_Factors:  [100.97933977]
mat_Sqrt:  [[0.15]]
grads:  [0.05232186]
Stock Position:  0.05232186059987565
Bond Position:  [-25.47131366]


portfolio before change:  [-20.2691153]
curr_Stock_Price:  99.48771736963442
curr_Factors:  [99.48771737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.2691153]
Stock Price:  98.02533435490972
PL:  [-20.2691153]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.32116403e-03]
 [ 1.49858609e-03]
 [ 6.23507629e-03]
 [-2.27130271e-03]
 [ 1.19493547e-02]
 [ 2.62307798e-02]
 [-3.90185386e-03]
 [ 1.94151452e-02]
 [-1.02796440e-02]
 [-3.01868975e-03]
 [ 1.80725395e-02]
 [ 8.51344524e-03]
 [ 6.44051280e-04]
 [-4.01440569e-03]
 [ 6.67683258e-03]
 [ 3.28335189e-03]
 [ 9.21397387e-03]
 [-3.02645737e-02]
 [ 1.29629753e-02]
 [-1.84890077e-02]
 [ 2.24716063e-02]
 [ 5.15700788e-02]
 [ 5.61248963e-02]
 [ 6.53188870e-03]
 [ 7.81542241e-03]
 [-2.63256723e-02]
 [ 1.83385522e-03]
 [-1.61823542e-02]
 [ 7.86120487e-02]
 [-1.07561200e-03]
 [-2.06354280e-02]
 [ 3.52075979e-03]
 [ 8.18304928e-03]
 [ 9.55074399e-03]
 [ 8.22291693e-03]
 [ 1.82657762e-03]
 [-9.18127858e-02]
 [ 8.66472959e-03]
 [ 9.67582179e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.97747909]
curr_Stock_Price:  99.68198875030953
curr_Factors:  [99.68198875]
mat_Sqrt:  [[0.15]]
grads:  [0.02214109]
Stock Position:  0.02214109355189294
Bond Position:  [-5.18454733]


portfolio before change:  [-2.97783504]
curr_Stock_Price:  99.6951841798938
curr_Factors:  [99.69518418]
mat_Sqrt:  [[0.15]]
grads:  [0.00999057]
Stock Position:  0.009990573908594872
Bond Position:  [-3.97384715]


portfolio before change:  [-2.9776103]
curr_Stock_Price:  99.7674029535126
curr_Factors:  [99.76740295]
mat_Sqrt:  [[0.15]]
grads:  [0.04156718]
Stock Position:  0.04156717524082552
Bond Position:  [-7.12465942]


portfolio before change:  [-2.98869715]
curr_Stock_Price:  99.52210812954449
curr_Factors:  [99.52210813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514202]
Stock Position:  -0.015142018035204404
Bond Position:  [-1.48173159]


portfolio before change:  [-2.99143081]
curr_Stock_Price:  99.69041042876697
curr_Factors:  [99.69041043]
mat_Sqrt:  [[0.15]]
grads:  [0.07966236]
Stock Position:  0.07966236455650995
Bond Position:  [-10.93300463]


portfolio before change:  [-2.88651123]
curr_Stock_Price:  101.02462005647064
curr_Factors:  [101.02462006]
mat_Sqrt:  [[0.15]]
grads:  [0.17487187]
Stock Position:  0.17487186554573778
Bond Position:  [-20.552875]


portfolio before change:  [-2.8479781]
curr_Stock_Price:  101.2596629936027
curr_Factors:  [101.25966299]
mat_Sqrt:  [[0.15]]
grads:  [-0.02601236]
Stock Position:  -0.026012359078977875
Bond Position:  [-0.21397539]


portfolio before change:  [-2.82726036]
curr_Stock_Price:  100.46217715898312
curr_Factors:  [100.46217716]
mat_Sqrt:  [[0.15]]
grads:  [0.1294343]
Stock Position:  0.12943430116107402
Bond Position:  [-15.83051206]


portfolio before change:  [-2.48910623]
curr_Stock_Price:  103.0900205444414
curr_Factors:  [103.09002054]
mat_Sqrt:  [[0.15]]
grads:  [-0.06853096]
Stock Position:  -0.06853095973722573
Bond Position:  [4.57575182]


portfolio before change:  [-2.43785286]
curr_Stock_Price:  102.35048093235584
curr_Factors:  [102.35048093]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201246]
Stock Position:  -0.020124598365626065
Bond Position:  [-0.37809054]


portfolio before change:  [-2.45350312]
curr_Stock_Price:  103.12580031254659
curr_Factors:  [103.12580031]
mat_Sqrt:  [[0.15]]
grads:  [0.1204836]
Stock Position:  0.12048359646165475
Bond Position:  [-14.87847043]


portfolio before change:  [-2.36581706]
curr_Stock_Price:  103.86902166513323
curr_Factors:  [103.86902167]
mat_Sqrt:  [[0.15]]
grads:  [0.0567563]
Stock Position:  0.05675630160256763
Bond Position:  [-8.26103858]


portfolio before change:  [-2.3270633]
curr_Stock_Price:  104.57002672097441
curr_Factors:  [104.57002672]
mat_Sqrt:  [[0.15]]
grads:  [0.00429368]
Stock Position:  0.004293675202799649
Bond Position:  [-2.77605303]


portfolio before change:  [-2.33138538]
curr_Stock_Price:  103.64423494247319
curr_Factors:  [103.64423494]
mat_Sqrt:  [[0.15]]
grads:  [-0.0267627]
Stock Position:  -0.026762704568074135
Bond Position:  [0.44241466]


portfolio before change:  [-2.32342236]
curr_Stock_Price:  103.34875967461322
curr_Factors:  [103.34875967]
mat_Sqrt:  [[0.15]]
grads:  [0.04451222]
Stock Position:  0.0445122172169743
Bond Position:  [-6.9237048]


portfolio before change:  [-2.30201465]
curr_Stock_Price:  103.84914430701868
curr_Factors:  [103.84914431]
mat_Sqrt:  [[0.15]]
grads:  [0.02188901]
Stock Position:  0.021889012602062663
Bond Position:  [-4.57516987]


portfolio before change:  [-2.26398961]
curr_Stock_Price:  105.61244742081355
curr_Factors:  [105.61244742]
mat_Sqrt:  [[0.15]]
grads:  [0.06142649]
Stock Position:  0.0614264924506603
Bond Position:  [-8.75139182]


portfolio before change:  [-2.1665488]
curr_Stock_Price:  107.21655661918317
curr_Factors:  [107.21655662]
mat_Sqrt:  [[0.15]]
grads:  [-0.20176382]
Stock Position:  -0.20176382441165966
Bond Position:  [19.4658737]


portfolio before change:  [-2.36972973]
curr_Stock_Price:  108.23564076666521
curr_Factors:  [108.23564077]
mat_Sqrt:  [[0.15]]
grads:  [0.08641984]
Stock Position:  0.08641983514533255
Bond Position:  [-11.72343596]


portfolio before change:  [-2.35788822]
curr_Stock_Price:  108.38962200632649
curr_Factors:  [108.38962201]
mat_Sqrt:  [[0.15]]
grads:  [-0.12326005]
Stock Position:  -0.12326005108106886
Bond Position:  [11.00222212]


portfolio before change:  [-2.38640335]
curr_Stock_Price:  108.63212144710623
curr_Factors:  [108.63212145]
mat_Sqrt:  [[0.15]]
grads:  [0.14981071]
Stock Position:  0.14981070852703593
Bond Position:  [-18.66065843]


portfolio before change:  [-2.45051215]
curr_Stock_Price:  108.21976058149039
curr_Factors:  [108.21976058]
mat_Sqrt:  [[0.15]]
grads:  [0.34380053]
Stock Position:  0.34380052557501994
Bond Position:  [-39.65652272]


portfolio before change:  [-2.23105597]
curr_Stock_Price:  108.87250407977619
curr_Factors:  [108.87250408]
mat_Sqrt:  [[0.15]]
grads:  [0.37416598]
Stock Position:  0.37416597549274483
Bond Position:  [-42.96744266]


portfolio before change:  [-2.49705946]
curr_Stock_Price:  108.17593560148958
curr_Factors:  [108.1759356]
mat_Sqrt:  [[0.15]]
grads:  [0.04354592]
Stock Position:  0.04354592464764945
Bond Position:  [-7.2076806]


portfolio before change:  [-2.50050927]
curr_Stock_Price:  108.11740435506539
curr_Factors:  [108.11740436]
mat_Sqrt:  [[0.15]]
grads:  [0.05210282]
Stock Position:  0.05210281605357759
Bond Position:  [-8.1337305]


portfolio before change:  [-2.53435924]
curr_Stock_Price:  107.48724292334205
curr_Factors:  [107.48724292]
mat_Sqrt:  [[0.15]]
grads:  [-0.17550448]
Stock Position:  -0.17550448187337025
Bond Position:  [16.33013364]


portfolio before change:  [-2.62450971]
curr_Stock_Price:  108.01253927838255
curr_Factors:  [108.01253928]
mat_Sqrt:  [[0.15]]
grads:  [0.0122257]
Stock Position:  0.012225701474580387
Bond Position:  [-3.94503877]


portfolio before change:  [-2.61874618]
curr_Stock_Price:  108.52430419666365
curr_Factors:  [108.5243042]
mat_Sqrt:  [[0.15]]
grads:  [-0.10788236]
Stock Position:  -0.10788236125555711
Bond Position:  [9.08911201]


portfolio before change:  [-2.68718435]
curr_Stock_Price:  109.1692138921747
curr_Factors:  [109.16921389]
mat_Sqrt:  [[0.15]]
grads:  [0.52408032]
Stock Position:  0.5240803246435075
Bond Position:  [-59.90062141]


portfolio before change:  [-2.56578231]
curr_Stock_Price:  109.4151496558767
curr_Factors:  [109.41514966]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717075]
Stock Position:  -0.007170746642522233
Bond Position:  [-1.78119399]


portfolio before change:  [-2.57351245]
curr_Stock_Price:  110.46210928041786
curr_Factors:  [110.46210928]
mat_Sqrt:  [[0.15]]
grads:  [-0.13756952]
Stock Position:  -0.13756952006513168
Bond Position:  [12.62270691]


portfolio before change:  [-2.52658089]
curr_Stock_Price:  110.1324314326263
curr_Factors:  [110.13243143]
mat_Sqrt:  [[0.15]]
grads:  [0.02347173]
Stock Position:  0.023471731925110737
Bond Position:  [-5.1115798]


portfolio before change:  [-2.52756884]
curr_Stock_Price:  110.11756425384566
curr_Factors:  [110.11756425]
mat_Sqrt:  [[0.15]]
grads:  [0.05455366]
Stock Position:  0.05455366186685121
Bond Position:  [-8.5348852]


portfolio before change:  [-2.50608368]
curr_Stock_Price:  110.53095700532954
curr_Factors:  [110.53095701]
mat_Sqrt:  [[0.15]]
grads:  [0.06367163]
Stock Position:  0.06367162660521894
Bond Position:  [-9.5437695]


portfolio before change:  [-2.54993779]
curr_Stock_Price:  109.86094007209324
curr_Factors:  [109.86094007]
mat_Sqrt:  [[0.15]]
grads:  [0.05481945]
Stock Position:  0.054819446227137976
Bond Position:  [-8.57245369]


portfolio before change:  [-2.51925257]
curr_Stock_Price:  110.4402389952924
curr_Factors:  [110.440239]
mat_Sqrt:  [[0.15]]
grads:  [0.01217718]
Stock Position:  0.01217718414805799
Bond Position:  [-3.86410369]


portfolio before change:  [-2.51617222]
curr_Stock_Price:  110.73286731969652
curr_Factors:  [110.73286732]
mat_Sqrt:  [[0.15]]
grads:  [-0.61208524]
Stock Position:  -0.6120852383976713
Bond Position:  [65.26178127]


portfolio before change:  [-2.82364489]
curr_Stock_Price:  111.24853227281106
curr_Factors:  [111.24853227]
mat_Sqrt:  [[0.15]]
grads:  [0.05776486]
Stock Position:  0.057764863930538535
Bond Position:  [-9.24990122]


portfolio before change:  [-2.88571014]
curr_Stock_Price:  110.19410339167464
curr_Factors:  [110.19410339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.88571014]
Stock Price:  109.4048521537494
PL:  [-12.2905623]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.25160183e-03]
 [-1.56836611e-03]
 [-6.03596350e-03]
 [-2.36518986e-03]
 [ 1.49120408e-02]
 [ 1.68399161e-02]
 [-9.42448867e-03]
 [ 2.20430693e-02]
 [-6.04679434e-03]
 [ 1.23565068e-02]
 [-1.55095850e-02]
 [ 7.65222195e-03]
 [ 1.38922547e-02]
 [ 7.17180183e-04]
 [-2.71031520e-03]
 [-5.63431299e-03]
 [ 1.66632764e-02]
 [-1.04896682e-02]
 [ 4.69515281e-03]
 [-5.16088503e-03]
 [ 1.68968365e-02]
 [ 7.62131723e-04]
 [ 2.30168180e-02]
 [ 4.60028108e-03]
 [ 1.63277646e-02]
 [-1.12504931e-02]
 [ 1.39193412e-02]
 [-1.08560389e-02]
 [-1.74681665e-02]
 [-1.40124907e-06]
 [-4.06912374e-03]
 [ 5.58177083e-03]
 [ 1.39948559e-02]
 [-1.32010006e-02]
 [ 4.20414876e-03]
 [ 5.40000521e-03]
 [ 6.55540141e-03]
 [ 8.63402374e-03]
 [-6.94923936e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.16896614]
curr_Stock_Price:  98.96003298100892
curr_Factors:  [98.96003298]
mat_Sqrt:  [[0.15]]
grads:  [0.05501068]
Stock Position:  0.05501067889306326
Bond Position:  [-19.61282474]


portfolio before change:  [-14.14253656]
curr_Stock_Price:  99.48504625097738
curr_Factors:  [99.48504625]
mat_Sqrt:  [[0.15]]
grads:  [-0.01045577]
Stock Position:  -0.010455774079493654
Bond Position:  [-13.1023434]


portfolio before change:  [-14.1396852]
curr_Stock_Price:  99.05568942054065
curr_Factors:  [99.05568942]
mat_Sqrt:  [[0.15]]
grads:  [-0.04023976]
Stock Position:  -0.040239756677650174
Bond Position:  [-10.15370836]


portfolio before change:  [-14.15127516]
curr_Stock_Price:  99.31216881798521
curr_Factors:  [99.31216882]
mat_Sqrt:  [[0.15]]
grads:  [-0.01576793]
Stock Position:  -0.015767932385111785
Bond Position:  [-12.5853276]


portfolio before change:  [-14.17979783]
curr_Stock_Price:  101.02129614199049
curr_Factors:  [101.02129614]
mat_Sqrt:  [[0.15]]
grads:  [0.09941361]
Stock Position:  0.09941360522509038
Bond Position:  [-24.22268908]


portfolio before change:  [-14.27824745]
curr_Stock_Price:  100.06145169494215
curr_Factors:  [100.06145169]
mat_Sqrt:  [[0.15]]
grads:  [0.11226611]
Stock Position:  0.11226610705913595
Bond Position:  [-25.5117571]


portfolio before change:  [-14.3577478]
curr_Stock_Price:  99.38171694887617
curr_Factors:  [99.38171695]
mat_Sqrt:  [[0.15]]
grads:  [-0.06282992]
Stock Position:  -0.06282992446727904
Bond Position:  [-8.11360203]


portfolio before change:  [-14.32141741]
curr_Stock_Price:  98.78734007575636
curr_Factors:  [98.78734008]
mat_Sqrt:  [[0.15]]
grads:  [0.1469538]
Stock Position:  0.14695379548603907
Bond Position:  [-28.83859198]


portfolio before change:  [-14.4342361]
curr_Stock_Price:  98.04415653643264
curr_Factors:  [98.04415654]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031196]
Stock Position:  -0.04031196229689691
Bond Position:  [-10.48188376]


portfolio before change:  [-14.33890087]
curr_Stock_Price:  95.6467157781426
curr_Factors:  [95.64671578]
mat_Sqrt:  [[0.15]]
grads:  [0.08237671]
Stock Position:  0.08237671199778643
Bond Position:  [-22.21796283]


portfolio before change:  [-14.38609306]
curr_Stock_Price:  95.10754920966228
curr_Factors:  [95.10754921]
mat_Sqrt:  [[0.15]]
grads:  [-0.10339723]
Stock Position:  -0.10339723366007776
Bond Position:  [-4.55223557]


portfolio before change:  [-14.45529517]
curr_Stock_Price:  95.77132945396637
curr_Factors:  [95.77132945]
mat_Sqrt:  [[0.15]]
grads:  [0.05101481]
Stock Position:  0.05101481302849682
Bond Position:  [-19.34105163]


portfolio before change:  [-14.41239706]
curr_Stock_Price:  96.65961828378857
curr_Factors:  [96.65961828]
mat_Sqrt:  [[0.15]]
grads:  [0.09261503]
Stock Position:  0.09261503149654436
Bond Position:  [-23.36453065]


portfolio before change:  [-14.41541556]
curr_Stock_Price:  96.6585628340595
curr_Factors:  [96.65856283]
mat_Sqrt:  [[0.15]]
grads:  [0.0047812]
Stock Position:  0.004781201219981679
Bond Position:  [-14.8775596]


portfolio before change:  [-14.41802559]
curr_Stock_Price:  96.50165207032539
curr_Factors:  [96.50165207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01806877]
Stock Position:  -0.018068767986795284
Bond Position:  [-12.67435963]


portfolio before change:  [-14.42517706]
curr_Stock_Price:  96.8097565229533
curr_Factors:  [96.80975652]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756209]
Stock Position:  -0.037562086613879095
Bond Position:  [-10.7888006]


portfolio before change:  [-14.44055016]
curr_Stock_Price:  97.1831229387315
curr_Factors:  [97.18312294]
mat_Sqrt:  [[0.15]]
grads:  [0.11108851]
Stock Position:  0.1110885092754013
Bond Position:  [-25.23647842]


portfolio before change:  [-14.44073754]
curr_Stock_Price:  97.20983476489175
curr_Factors:  [97.20983476]
mat_Sqrt:  [[0.15]]
grads:  [-0.06993112]
Stock Position:  -0.06993112146190808
Bond Position:  [-7.64274478]


portfolio before change:  [-14.42686443]
curr_Stock_Price:  96.99779021189136
curr_Factors:  [96.99779021]
mat_Sqrt:  [[0.15]]
grads:  [0.03130102]
Stock Position:  0.03130101871384247
Bond Position:  [-17.46299408]


portfolio before change:  [-14.39998457]
curr_Stock_Price:  97.92628635805893
curr_Factors:  [97.92628636]
mat_Sqrt:  [[0.15]]
grads:  [-0.0344059]
Stock Position:  -0.03440590020278039
Bond Position:  [-11.03074253]


portfolio before change:  [-14.39971692]
curr_Stock_Price:  97.87842913072657
curr_Factors:  [97.87842913]
mat_Sqrt:  [[0.15]]
grads:  [0.11264558]
Stock Position:  0.11264557665982093
Bond Position:  [-25.42528902]


portfolio before change:  [-14.36908263]
curr_Stock_Price:  98.17859762413435
curr_Factors:  [98.17859762]
mat_Sqrt:  [[0.15]]
grads:  [0.00508088]
Stock Position:  0.0050808781527921995
Bond Position:  [-14.86791612]


portfolio before change:  [-14.37627486]
curr_Stock_Price:  97.12885367873542
curr_Factors:  [97.12885368]
mat_Sqrt:  [[0.15]]
grads:  [0.15344545]
Stock Position:  0.15344545349975466
Bond Position:  [-29.28025586]


portfolio before change:  [-14.28661086]
curr_Stock_Price:  97.73704540393088
curr_Factors:  [97.7370454]
mat_Sqrt:  [[0.15]]
grads:  [0.03066854]
Stock Position:  0.030668540519584314
Bond Position:  [-17.2840634]


portfolio before change:  [-14.30428257]
curr_Stock_Price:  97.23128084488184
curr_Factors:  [97.23128084]
mat_Sqrt:  [[0.15]]
grads:  [0.10885176]
Stock Position:  0.10885176399315293
Bond Position:  [-24.888079]


portfolio before change:  [-14.24883192]
curr_Stock_Price:  97.76927718011967
curr_Factors:  [97.76927718]
mat_Sqrt:  [[0.15]]
grads:  [-0.07500329]
Stock Position:  -0.07500328748733782
Bond Position:  [-6.91581472]


portfolio before change:  [-14.319945]
curr_Stock_Price:  98.70588337629795
curr_Factors:  [98.70588338]
mat_Sqrt:  [[0.15]]
grads:  [0.09279561]
Stock Position:  0.09279560789368832
Bond Position:  [-23.47941745]


portfolio before change:  [-14.2941535]
curr_Stock_Price:  99.01545198614072
curr_Factors:  [99.01545199]
mat_Sqrt:  [[0.15]]
grads:  [-0.07237359]
Stock Position:  -0.07237359282560565
Bond Position:  [-7.12804949]


portfolio before change:  [-14.25630377]
curr_Stock_Price:  98.48016299717415
curr_Factors:  [98.480163]
mat_Sqrt:  [[0.15]]
grads:  [-0.11645444]
Stock Position:  -0.11645444302511489
Bond Position:  [-2.78785124]


portfolio before change:  [-14.05160328]
curr_Stock_Price:  96.71939726876121
curr_Factors:  [96.71939727]
mat_Sqrt:  [[0.15]]
grads:  [-9.34166047e-06]
Stock Position:  -9.341660467034746e-06
Bond Position:  [-14.05069976]


portfolio before change:  [-14.05335859]
curr_Stock_Price:  96.59746383242577
curr_Factors:  [96.59746383]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712749]
Stock Position:  -0.02712749157232831
Bond Position:  [-11.43291171]


portfolio before change:  [-14.03200078]
curr_Stock_Price:  95.7574665492386
curr_Factors:  [95.75746655]
mat_Sqrt:  [[0.15]]
grads:  [0.03721181]
Stock Position:  0.037211805508996415
Bond Position:  [-17.595309]


portfolio before change:  [-14.04595233]
curr_Stock_Price:  95.44165270841208
curr_Factors:  [95.44165271]
mat_Sqrt:  [[0.15]]
grads:  [0.09329904]
Stock Position:  0.09329903942016803
Bond Position:  [-22.95056685]


portfolio before change:  [-14.07914846]
curr_Stock_Price:  95.11659973020758
curr_Factors:  [95.11659973]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800667]
Stock Position:  -0.08800667090631219
Bond Position:  [-5.70825317]


portfolio before change:  [-13.97656841]
curr_Stock_Price:  93.94289746176511
curr_Factors:  [93.94289746]
mat_Sqrt:  [[0.15]]
grads:  [0.02802766]
Stock Position:  0.02802765838228015
Bond Position:  [-16.60956785]


portfolio before change:  [-13.96902389]
curr_Stock_Price:  94.28615995709158
curr_Factors:  [94.28615996]
mat_Sqrt:  [[0.15]]
grads:  [0.03600003]
Stock Position:  0.036000034751402114
Bond Position:  [-17.36332893]


portfolio before change:  [-13.98963449]
curr_Stock_Price:  93.77393703593877
curr_Factors:  [93.77393704]
mat_Sqrt:  [[0.15]]
grads:  [0.04370268]
Stock Position:  0.04370267606911848
Bond Position:  [-18.08780648]


portfolio before change:  [-14.01553479]
curr_Stock_Price:  93.23302774011611
curr_Factors:  [93.23302774]
mat_Sqrt:  [[0.15]]
grads:  [0.05756016]
Stock Position:  0.05756015823804408
Bond Position:  [-19.38204262]


portfolio before change:  [-13.99643025]
curr_Stock_Price:  93.60702675478322
curr_Factors:  [93.60702675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.99643025]
Stock Price:  93.97312862756397
PL:  [-13.99643025]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.55161280e-03]
 [-8.16849917e-03]
 [-1.56018621e-02]
 [ 6.67316129e-03]
 [-6.36195789e-02]
 [-3.36384037e-02]
 [-4.12787247e-02]
 [ 1.34232450e-02]
 [-6.52636237e-03]
 [ 5.35572853e-03]
 [-9.42343979e-03]
 [ 7.57231475e-03]
 [ 1.39074223e-02]
 [ 6.17158388e-04]
 [-5.26922107e-03]
 [-5.25696575e-03]
 [ 1.85292586e-02]
 [-9.03054095e-03]
 [ 4.73883928e-03]
 [-3.31992625e-03]
 [ 2.09778471e-02]
 [-2.11850284e-03]
 [ 2.19211371e-02]
 [ 4.97839184e-03]
 [ 1.20001488e-03]
 [-1.04341773e-02]
 [ 3.51740096e-03]
 [-1.11478181e-02]
 [-1.71821954e-02]
 [-5.99080712e-03]
 [-3.28665202e-03]
 [ 5.41858085e-03]
 [ 5.15127085e-03]
 [-1.04359795e-02]
 [ 2.04978236e-02]
 [ 5.47993861e-03]
 [ 2.28523244e-03]
 [ 8.20435076e-03]
 [-1.22064511e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.40962589]
curr_Stock_Price:  99.2025456494046
curr_Factors:  [99.20254565]
mat_Sqrt:  [[0.15]]
grads:  [0.04367742]
Stock Position:  0.04367741864645713
Bond Position:  [-14.742537]


portfolio before change:  [-10.42016119]
curr_Stock_Price:  99.00353276891006
curr_Factors:  [99.00353277]
mat_Sqrt:  [[0.15]]
grads:  [-0.05445666]
Stock Position:  -0.054456661108441516
Bond Position:  [-5.02875935]


portfolio before change:  [-10.38560874]
curr_Stock_Price:  98.35749454320035
curr_Factors:  [98.35749454]
mat_Sqrt:  [[0.15]]
grads:  [-0.10401241]
Stock Position:  -0.10401241415569192
Bond Position:  [-0.15520828]


portfolio before change:  [-10.29478701]
curr_Stock_Price:  97.4841263802332
curr_Factors:  [97.48412638]
mat_Sqrt:  [[0.15]]
grads:  [0.04448774]
Stock Position:  0.04448774191653312
Bond Position:  [-14.63163566]


portfolio before change:  [-10.32427469]
curr_Stock_Price:  96.86241318143297
curr_Factors:  [96.86241318]
mat_Sqrt:  [[0.15]]
grads:  [-0.42413053]
Stock Position:  -0.4241305257151216
Bond Position:  [30.75803153]


portfolio before change:  [-10.23721757]
curr_Stock_Price:  96.66621855956255
curr_Factors:  [96.66621856]
mat_Sqrt:  [[0.15]]
grads:  [-0.22425602]
Stock Position:  -0.22425602463438374
Bond Position:  [11.44076432]


portfolio before change:  [-10.30747685]
curr_Stock_Price:  96.98589540977905
curr_Factors:  [96.98589541]
mat_Sqrt:  [[0.15]]
grads:  [-0.2751915]
Stock Position:  -0.27519149795060255
Bond Position:  [16.38221699]


portfolio before change:  [-10.2381424]
curr_Stock_Price:  96.74138735442655
curr_Factors:  [96.74138735]
mat_Sqrt:  [[0.15]]
grads:  [0.0894883]
Stock Position:  0.08948829970126719
Bond Position:  [-18.89536467]


portfolio before change:  [-10.31702932]
curr_Stock_Price:  95.88624926188953
curr_Factors:  [95.88624926]
mat_Sqrt:  [[0.15]]
grads:  [-0.04350908]
Stock Position:  -0.043509082458162124
Bond Position:  [-6.1451066]


portfolio before change:  [-10.34807433]
curr_Stock_Price:  96.58212284091455
curr_Factors:  [96.58212284]
mat_Sqrt:  [[0.15]]
grads:  [0.03570486]
Stock Position:  0.03570485684361173
Bond Position:  [-13.7965252]


portfolio before change:  [-10.34207385]
curr_Stock_Price:  96.79848440808665
curr_Factors:  [96.79848441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06282293]
Stock Position:  -0.0628229319450989
Bond Position:  [-4.26090925]


portfolio before change:  [-10.3369662]
curr_Stock_Price:  96.70870359755838
curr_Factors:  [96.7087036]
mat_Sqrt:  [[0.15]]
grads:  [0.0504821]
Stock Position:  0.0504820983073729
Bond Position:  [-15.21902448]


portfolio before change:  [-10.28944056]
curr_Stock_Price:  97.68782560294542
curr_Factors:  [97.6878256]
mat_Sqrt:  [[0.15]]
grads:  [0.09271615]
Stock Position:  0.09271614859424457
Bond Position:  [-19.34667952]


portfolio before change:  [-10.39271129]
curr_Stock_Price:  96.60007288148269
curr_Factors:  [96.60007288]
mat_Sqrt:  [[0.15]]
grads:  [0.00411439]
Stock Position:  0.004114389255317665
Bond Position:  [-10.79016159]


portfolio before change:  [-10.39706878]
curr_Stock_Price:  95.86882603689867
curr_Factors:  [95.86882604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512814]
Stock Position:  -0.03512814049268851
Bond Position:  [-7.02937519]


portfolio before change:  [-10.43576008]
curr_Stock_Price:  96.94524428340017
curr_Factors:  [96.94524428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03504644]
Stock Position:  -0.03504643836397338
Bond Position:  [-7.03817455]


portfolio before change:  [-10.41977514]
curr_Stock_Price:  96.4640322697867
curr_Factors:  [96.46403227]
mat_Sqrt:  [[0.15]]
grads:  [0.12352839]
Stock Position:  0.1235283906783536
Bond Position:  [-22.3358218]


portfolio before change:  [-10.25070558]
curr_Stock_Price:  97.85530527887248
curr_Factors:  [97.85530528]
mat_Sqrt:  [[0.15]]
grads:  [-0.06020361]
Stock Position:  -0.060203606340307726
Bond Position:  [-4.3594633]


portfolio before change:  [-10.20114295]
curr_Stock_Price:  97.02300316652537
curr_Factors:  [97.02300317]
mat_Sqrt:  [[0.15]]
grads:  [0.03159226]
Stock Position:  0.031592261835069156
Bond Position:  [-13.26631907]


portfolio before change:  [-10.19180228]
curr_Stock_Price:  97.37116030197325
curr_Factors:  [97.3711603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213284]
Stock Position:  -0.02213284165049528
Bond Position:  [-8.0367018]


portfolio before change:  [-10.18200567]
curr_Stock_Price:  96.8831407540752
curr_Factors:  [96.88314075]
mat_Sqrt:  [[0.15]]
grads:  [0.13985231]
Stock Position:  0.13985231382547494
Bond Position:  [-23.73133707]


portfolio before change:  [-10.14122598]
curr_Stock_Price:  97.19594424301037
curr_Factors:  [97.19594424]
mat_Sqrt:  [[0.15]]
grads:  [-0.01412335]
Stock Position:  -0.014123352235004227
Bond Position:  [-8.76849342]


portfolio before change:  [-10.14477902]
curr_Stock_Price:  97.36990490673234
curr_Factors:  [97.36990491]
mat_Sqrt:  [[0.15]]
grads:  [0.14614091]
Stock Position:  0.1461409141140363
Bond Position:  [-24.37450593]


portfolio before change:  [-9.93929778]
curr_Stock_Price:  98.79680333343647
curr_Factors:  [98.79680333]
mat_Sqrt:  [[0.15]]
grads:  [0.03318928]
Stock Position:  0.03318927894023129
Bond Position:  [-13.21829244]


portfolio before change:  [-9.909833]
curr_Stock_Price:  99.73437012353186
curr_Factors:  [99.73437012]
mat_Sqrt:  [[0.15]]
grads:  [0.0080001]
Stock Position:  0.00800009919091836
Bond Position:  [-10.70771786]


portfolio before change:  [-9.91265607]
curr_Stock_Price:  99.54880779779677
curr_Factors:  [99.5488078]
mat_Sqrt:  [[0.15]]
grads:  [-0.06956118]
Stock Position:  -0.06956118182445595
Bond Position:  [-2.98792335]


portfolio before change:  [-9.97121218]
curr_Stock_Price:  100.38523120204657
curr_Factors:  [100.3852312]
mat_Sqrt:  [[0.15]]
grads:  [0.02344934]
Stock Position:  0.023449339748438162
Bond Position:  [-12.32517957]


portfolio before change:  [-9.96071662]
curr_Stock_Price:  100.89852105887856
curr_Factors:  [100.89852106]
mat_Sqrt:  [[0.15]]
grads:  [-0.07431879]
Stock Position:  -0.07431878725273106
Bond Position:  [-2.4620609]


portfolio before change:  [-9.9206266]
curr_Stock_Price:  100.35494666388956
curr_Factors:  [100.35494666]
mat_Sqrt:  [[0.15]]
grads:  [-0.11454797]
Stock Position:  -0.11454796914076323
Bond Position:  [1.57482873]


portfolio before change:  [-9.88016638]
curr_Stock_Price:  100.0034488455809
curr_Factors:  [100.00344885]
mat_Sqrt:  [[0.15]]
grads:  [-0.03993871]
Stock Position:  -0.03993871411062593
Bond Position:  [-5.88615722]


portfolio before change:  [-9.86723746]
curr_Stock_Price:  99.66130632944277
curr_Factors:  [99.66130633]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191101]
Stock Position:  -0.021911013472643102
Bond Position:  [-7.68355724]


portfolio before change:  [-9.87399255]
curr_Stock_Price:  99.92576633197315
curr_Factors:  [99.92576633]
mat_Sqrt:  [[0.15]]
grads:  [0.03612387]
Stock Position:  0.03612387234671861
Bond Position:  [-13.48369818]


portfolio before change:  [-9.85928363]
curr_Stock_Price:  100.37960727400417
curr_Factors:  [100.37960727]
mat_Sqrt:  [[0.15]]
grads:  [0.03434181]
Stock Position:  0.034341805671817785
Bond Position:  [-13.30650059]


portfolio before change:  [-9.84511799]
curr_Stock_Price:  100.84053385618053
curr_Factors:  [100.84053386]
mat_Sqrt:  [[0.15]]
grads:  [-0.0695732]
Stock Position:  -0.0695731967499847
Bond Position:  [-2.82931969]


portfolio before change:  [-9.89870121]
curr_Stock_Price:  101.60562062414968
curr_Factors:  [101.60562062]
mat_Sqrt:  [[0.15]]
grads:  [0.13665216]
Stock Position:  0.1366521575012494
Bond Position:  [-23.78332849]


portfolio before change:  [-9.91778837]
curr_Stock_Price:  101.48770039430313
curr_Factors:  [101.48770039]
mat_Sqrt:  [[0.15]]
grads:  [0.03653292]
Stock Position:  0.03653292403481923
Bond Position:  [-13.62543082]


portfolio before change:  [-9.96032209]
curr_Stock_Price:  100.37006639997527
curr_Factors:  [100.3700664]
mat_Sqrt:  [[0.15]]
grads:  [0.01523488]
Stock Position:  0.015234882954019558
Bond Position:  [-11.48944831]


portfolio before change:  [-9.96558488]
curr_Stock_Price:  100.11889822972975
curr_Factors:  [100.11889823]
mat_Sqrt:  [[0.15]]
grads:  [0.05469567]
Stock Position:  0.05469567170001244
Bond Position:  [-15.44165527]


portfolio before change:  [-9.90331142]
curr_Stock_Price:  101.29273493492931
curr_Factors:  [101.29273493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.90331142]
Stock Price:  101.9423545915455
PL:  [-11.84566601]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.29098404e-03]
 [-6.06006963e-03]
 [ 1.52349948e-02]
 [ 2.26996655e-03]
 [ 2.47161146e-03]
 [ 2.67796599e-02]
 [ 8.52745931e-03]
 [ 8.83143733e-03]
 [-1.02192130e-02]
 [-2.10994535e-03]
 [ 2.19763538e-02]
 [ 8.38347740e-03]
 [ 3.64248583e-03]
 [-4.68561043e-03]
 [ 2.40409469e-02]
 [ 1.60592614e-03]
 [ 8.97291789e-03]
 [ 1.21652810e-02]
 [ 1.17320618e-02]
 [-1.57497462e-02]
 [ 6.09527476e-03]
 [ 3.45211335e-02]
 [-1.91480057e-02]
 [ 6.91239099e-03]
 [ 1.29385442e-03]
 [-1.03633434e-02]
 [-7.59557835e-04]
 [-1.07327376e-02]
 [ 5.13888065e-02]
 [-8.70348448e-03]
 [-1.27392880e-03]
 [ 5.10540176e-03]
 [ 5.11858070e-03]
 [-6.29334684e-03]
 [ 1.17263266e-02]
 [ 5.44015138e-03]
 [ 1.35293173e-04]
 [ 7.82351764e-03]
 [-1.42681893e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.90366609]
curr_Stock_Price:  101.09352762181041
curr_Factors:  [101.09352762]
mat_Sqrt:  [[0.15]]
grads:  [0.04860656]
Stock Position:  0.04860656026929899
Bond Position:  [13.98985744]


portfolio before change:  [18.95153203]
curr_Stock_Price:  102.04231105148331
curr_Factors:  [102.04231105]
mat_Sqrt:  [[0.15]]
grads:  [-0.04040046]
Stock Position:  -0.040400464196694776
Bond Position:  [23.07408876]


portfolio before change:  [18.98200428]
curr_Stock_Price:  101.35945228194915
curr_Factors:  [101.35945228]
mat_Sqrt:  [[0.15]]
grads:  [0.10156663]
Stock Position:  0.10156663225420705
Bond Position:  [8.68726606]


portfolio before change:  [18.98423008]
curr_Stock_Price:  101.3706747484516
curr_Factors:  [101.37067475]
mat_Sqrt:  [[0.15]]
grads:  [0.01513311]
Stock Position:  0.015133110303160047
Bond Position:  [17.45017648]


portfolio before change:  [19.00297345]
curr_Stock_Price:  102.46509313696767
curr_Factors:  [102.46509314]
mat_Sqrt:  [[0.15]]
grads:  [0.01647741]
Stock Position:  0.016477409703766363
Bond Position:  [17.31461413]


portfolio before change:  [18.99330409]
curr_Stock_Price:  101.74690874353735
curr_Factors:  [101.74690874]
mat_Sqrt:  [[0.15]]
grads:  [0.17853107]
Stock Position:  0.17853106595713455
Bond Position:  [0.82832001]


portfolio before change:  [19.03299104]
curr_Stock_Price:  101.9686259049978
curr_Factors:  [101.9686259]
mat_Sqrt:  [[0.15]]
grads:  [0.05684973]
Stock Position:  0.05684972873017243
Bond Position:  [13.23610232]


portfolio before change:  [19.05140744]
curr_Stock_Price:  102.26346964758172
curr_Factors:  [102.26346965]
mat_Sqrt:  [[0.15]]
grads:  [0.05887625]
Stock Position:  0.058876248895371394
Bond Position:  [13.03051795]


portfolio before change:  [19.09947437]
curr_Stock_Price:  103.05220894842508
curr_Factors:  [103.05220895]
mat_Sqrt:  [[0.15]]
grads:  [-0.06812809]
Stock Position:  -0.0681280867765025
Bond Position:  [26.1202242]


portfolio before change:  [19.04459893]
curr_Stock_Price:  103.9056112816755
curr_Factors:  [103.90561128]
mat_Sqrt:  [[0.15]]
grads:  [-0.0140663]
Stock Position:  -0.014066302351722945
Bond Position:  [20.50616668]


portfolio before change:  [19.04759563]
curr_Stock_Price:  103.87480968542332
curr_Factors:  [103.87480969]
mat_Sqrt:  [[0.15]]
grads:  [0.14650903]
Stock Position:  0.14650902523976705
Bond Position:  [3.82899851]


portfolio before change:  [19.03130744]
curr_Stock_Price:  103.76036727947438
curr_Factors:  [103.76036728]
mat_Sqrt:  [[0.15]]
grads:  [0.05588985]
Stock Position:  0.05588984936197475
Bond Position:  [13.23215614]


portfolio before change:  [19.02345284]
curr_Stock_Price:  103.59023409288696
curr_Factors:  [103.59023409]
mat_Sqrt:  [[0.15]]
grads:  [0.02428324]
Stock Position:  0.02428323886822091
Bond Position:  [16.50794644]


portfolio before change:  [19.00623294]
curr_Stock_Price:  102.79612579681493
curr_Factors:  [102.7961258]
mat_Sqrt:  [[0.15]]
grads:  [-0.0312374]
Stock Position:  -0.031237402882107898
Bond Position:  [22.21731694]


portfolio before change:  [19.05577739]
curr_Stock_Price:  101.29897473953062
curr_Factors:  [101.29897474]
mat_Sqrt:  [[0.15]]
grads:  [0.16027298]
Stock Position:  0.16027297956233144
Bond Position:  [2.82028888]


portfolio before change:  [19.04901395]
curr_Stock_Price:  101.25457547269228
curr_Factors:  [101.25457547]
mat_Sqrt:  [[0.15]]
grads:  [0.01070617]
Stock Position:  0.010706174236167553
Bond Position:  [17.96496482]


portfolio before change:  [19.05453132]
curr_Stock_Price:  101.56015735755629
curr_Factors:  [101.56015736]
mat_Sqrt:  [[0.15]]
grads:  [0.05981945]
Stock Position:  0.05981945257084911
Bond Position:  [12.97925831]


portfolio before change:  [19.07953822]
curr_Stock_Price:  101.95107358802733
curr_Factors:  [101.95107359]
mat_Sqrt:  [[0.15]]
grads:  [0.08110187]
Stock Position:  0.08110187308695656
Bond Position:  [10.81111519]


portfolio before change:  [19.1909122]
curr_Stock_Price:  103.30766994779786
curr_Factors:  [103.30766995]
mat_Sqrt:  [[0.15]]
grads:  [0.07821375]
Stock Position:  0.07821374566427607
Bond Position:  [11.11083238]


portfolio before change:  [19.21081144]
curr_Stock_Price:  103.54433282302539
curr_Factors:  [103.54433282]
mat_Sqrt:  [[0.15]]
grads:  [-0.10499831]
Stock Position:  -0.10499830786888659
Bond Position:  [30.08279117]


portfolio before change:  [19.15352602]
curr_Stock_Price:  104.12573270761952
curr_Factors:  [104.12573271]
mat_Sqrt:  [[0.15]]
grads:  [0.04063517]
Stock Position:  0.04063516504819184
Bond Position:  [14.92235968]


portfolio before change:  [19.16182492]
curr_Stock_Price:  104.28405591168713
curr_Factors:  [104.28405591]
mat_Sqrt:  [[0.15]]
grads:  [0.23014089]
Stock Position:  0.23014089005791796
Bond Position:  [-4.83820053]


portfolio before change:  [19.20123431]
curr_Stock_Price:  104.45792419621992
curr_Factors:  [104.4579242]
mat_Sqrt:  [[0.15]]
grads:  [-0.12765337]
Stock Position:  -0.12765337121959125
Bond Position:  [32.53564048]


portfolio before change:  [19.34117911]
curr_Stock_Price:  103.393497940693
curr_Factors:  [103.39349794]
mat_Sqrt:  [[0.15]]
grads:  [0.04608261]
Stock Position:  0.04608260658456174
Bond Position:  [14.57653723]


portfolio before change:  [19.32583402]
curr_Stock_Price:  103.02096533619932
curr_Factors:  [103.02096534]
mat_Sqrt:  [[0.15]]
grads:  [0.0086257]
Stock Position:  0.008625696166063151
Bond Position:  [18.43720648]


portfolio before change:  [19.33204023]
curr_Stock_Price:  103.47326684234942
curr_Factors:  [103.47326684]
mat_Sqrt:  [[0.15]]
grads:  [-0.06908896]
Stock Position:  -0.06908895592097083
Bond Position:  [26.4809002]


portfolio before change:  [19.32398488]
curr_Stock_Price:  103.63777467750899
curr_Factors:  [103.63777468]
mat_Sqrt:  [[0.15]]
grads:  [-0.00506372]
Stock Position:  -0.005063718901011473
Bond Position:  [19.84877744]


portfolio before change:  [19.32768353]
curr_Stock_Price:  103.39735768883706
curr_Factors:  [103.39735769]
mat_Sqrt:  [[0.15]]
grads:  [-0.07155158]
Stock Position:  -0.07155158379463408
Bond Position:  [26.72592824]


portfolio before change:  [19.31737021]
curr_Stock_Price:  103.58818889534753
curr_Factors:  [103.5881889]
mat_Sqrt:  [[0.15]]
grads:  [0.34259204]
Stock Position:  0.3425920432329252
Bond Position:  [-16.17111908]


portfolio before change:  [19.15546054]
curr_Stock_Price:  103.12148759519506
curr_Factors:  [103.1214876]
mat_Sqrt:  [[0.15]]
grads:  [-0.05802323]
Stock Position:  -0.05802322987934441
Bond Position:  [25.13890232]


portfolio before change:  [19.18059929]
curr_Stock_Price:  102.74239484199202
curr_Factors:  [102.74239484]
mat_Sqrt:  [[0.15]]
grads:  [-0.00849286]
Stock Position:  -0.008492858649936895
Bond Position:  [20.05317592]


portfolio before change:  [19.18780339]
curr_Stock_Price:  102.18930628205607
curr_Factors:  [102.18930628]
mat_Sqrt:  [[0.15]]
grads:  [0.03403601]
Stock Position:  0.034036011717621995
Bond Position:  [15.70968697]


portfolio before change:  [19.17026495]
curr_Stock_Price:  101.61631678493916
curr_Factors:  [101.61631678]
mat_Sqrt:  [[0.15]]
grads:  [0.03412387]
Stock Position:  0.034123871344749486
Bond Position:  [15.70272283]


portfolio before change:  [19.17906249]
curr_Stock_Price:  101.81660419277227
curr_Factors:  [101.81660419]
mat_Sqrt:  [[0.15]]
grads:  [-0.04195565]
Stock Position:  -0.04195564558098355
Bond Position:  [23.45084385]


portfolio before change:  [19.13130664]
curr_Stock_Price:  103.02472277972242
curr_Factors:  [103.02472278]
mat_Sqrt:  [[0.15]]
grads:  [0.07817551]
Stock Position:  0.07817551034209098
Bond Position:  [11.07729636]


portfolio before change:  [19.07515401]
curr_Stock_Price:  102.28872028473917
curr_Factors:  [102.28872028]
mat_Sqrt:  [[0.15]]
grads:  [0.03626768]
Stock Position:  0.03626767586488423
Bond Position:  [15.36537986]


portfolio before change:  [19.05387771]
curr_Stock_Price:  101.64911220901416
curr_Factors:  [101.64911221]
mat_Sqrt:  [[0.15]]
grads:  [0.00090195]
Stock Position:  0.0009019544836073579
Bond Position:  [18.96219484]


portfolio before change:  [19.05585734]
curr_Stock_Price:  101.2158445835692
curr_Factors:  [101.21584458]
mat_Sqrt:  [[0.15]]
grads:  [0.05215678]
Stock Position:  0.052156784287405854
Bond Position:  [13.77676437]


portfolio before change:  [19.08624964]
curr_Stock_Price:  101.76553508695736
curr_Factors:  [101.76553509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.08624964]
Stock Price:  103.01562940165722
PL:  [16.07062023]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.81374578e-03]
 [-1.13511160e-04]
 [ 1.44597904e-02]
 [-2.66861468e-03]
 [ 9.48604199e-03]
 [ 3.16714415e-02]
 [ 4.06870762e-02]
 [-4.01146572e-03]
 [-1.39474380e-02]
 [-4.35853969e-04]
 [ 3.46934424e-02]
 [ 1.07488304e-02]
 [-4.77591006e-03]
 [-4.37694188e-03]
 [-2.39167185e-03]
 [ 4.55052752e-03]
 [ 9.12881920e-03]
 [ 3.46521258e-04]
 [ 1.18002837e-02]
 [-1.52608510e-02]
 [ 9.31933896e-04]
 [ 2.32301109e-02]
 [-1.66836846e-02]
 [ 6.12703807e-03]
 [-7.65442782e-03]
 [-8.27001846e-03]
 [-4.70832377e-04]
 [-1.13724874e-02]
 [ 6.08603965e-02]
 [-2.96407512e-03]
 [-1.00107906e-02]
 [ 4.18460394e-03]
 [ 5.82934229e-03]
 [-1.13985685e-04]
 [ 7.76108058e-03]
 [ 4.06624769e-03]
 [-2.27997124e-02]
 [ 9.84360901e-03]
 [-1.05380457e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.97400756]
curr_Stock_Price:  101.35610278235379
curr_Factors:  [101.35610278]
mat_Sqrt:  [[0.15]]
grads:  [0.05875831]
Stock Position:  0.05875830522946039
Bond Position:  [17.01849473]


portfolio before change:  [22.97194802]
curr_Stock_Price:  101.2848450943011
curr_Factors:  [101.28484509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075674]
Stock Position:  -0.0007567410639218222
Bond Position:  [23.04859442]


portfolio before change:  [22.97492453]
curr_Stock_Price:  101.15897566107982
curr_Factors:  [101.15897566]
mat_Sqrt:  [[0.15]]
grads:  [0.0963986]
Stock Position:  0.09639860289543645
Bond Position:  [13.2233406]


portfolio before change:  [22.9240366]
curr_Stock_Price:  100.61393713540946
curr_Factors:  [100.61393714]
mat_Sqrt:  [[0.15]]
grads:  [-0.01779076]
Stock Position:  -0.017790764504304092
Bond Position:  [24.71403546]


portfolio before change:  [22.89998543]
curr_Stock_Price:  102.13948203481193
curr_Factors:  [102.13948203]
mat_Sqrt:  [[0.15]]
grads:  [0.06324028]
Stock Position:  0.06324027991372
Bond Position:  [16.440656]


portfolio before change:  [22.97054045]
curr_Stock_Price:  103.22264937808391
curr_Factors:  [103.22264938]
mat_Sqrt:  [[0.15]]
grads:  [0.21114294]
Stock Position:  0.21114294310576137
Bond Position:  [1.17580647]


portfolio before change:  [23.0989516]
curr_Stock_Price:  103.83012488427129
curr_Factors:  [103.83012488]
mat_Sqrt:  [[0.15]]
grads:  [0.27124717]
Stock Position:  0.2712471745111877
Bond Position:  [-5.0646764]


portfolio before change:  [23.25687567]
curr_Stock_Price:  104.41467363490393
curr_Factors:  [104.41467363]
mat_Sqrt:  [[0.15]]
grads:  [-0.0267431]
Stock Position:  -0.026743104807799373
Bond Position:  [26.04924823]


portfolio before change:  [23.23474468]
curr_Stock_Price:  105.36397810751055
curr_Factors:  [105.36397811]
mat_Sqrt:  [[0.15]]
grads:  [-0.09298292]
Stock Position:  -0.09298292012609753
Bond Position:  [33.03179505]


portfolio before change:  [23.23669881]
curr_Stock_Price:  105.38737065269359
curr_Factors:  [105.38737065]
mat_Sqrt:  [[0.15]]
grads:  [-0.00290569]
Stock Position:  -0.0029056931237614702
Bond Position:  [23.54292217]


portfolio before change:  [23.23694707]
curr_Stock_Price:  106.31478704519692
curr_Factors:  [106.31478705]
mat_Sqrt:  [[0.15]]
grads:  [0.23128962]
Stock Position:  0.23128961583919316
Bond Position:  [-1.35255918]


portfolio before change:  [23.19298389]
curr_Stock_Price:  106.12543958029867
curr_Factors:  [106.12543958]
mat_Sqrt:  [[0.15]]
grads:  [0.07165887]
Stock Position:  0.07165886914837273
Bond Position:  [15.5881549]


portfolio before change:  [23.21038629]
curr_Stock_Price:  106.34109695026642
curr_Factors:  [106.34109695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0318394]
Stock Position:  -0.03183940039858652
Bond Position:  [26.59622306]


portfolio before change:  [23.24143414]
curr_Stock_Price:  105.47037984434165
curr_Factors:  [105.47037984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02917961]
Stock Position:  -0.029179612541600956
Bond Position:  [26.31901896]


portfolio before change:  [23.24303685]
curr_Stock_Price:  105.5282070144483
curr_Factors:  [105.52820701]
mat_Sqrt:  [[0.15]]
grads:  [-0.01594448]
Stock Position:  -0.01594447898976549
Bond Position:  [24.92562913]


portfolio before change:  [23.2544263]
curr_Stock_Price:  105.00930943732287
curr_Factors:  [105.00930944]
mat_Sqrt:  [[0.15]]
grads:  [0.03033685]
Stock Position:  0.03033685010351574
Bond Position:  [20.06877462]


portfolio before change:  [23.22327318]
curr_Stock_Price:  103.89970589988667
curr_Factors:  [103.8997059]
mat_Sqrt:  [[0.15]]
grads:  [0.06085879]
Stock Position:  0.060858794655632285
Bond Position:  [16.90006231]


portfolio before change:  [23.24110781]
curr_Stock_Price:  104.15804145949188
curr_Factors:  [104.15804146]
mat_Sqrt:  [[0.15]]
grads:  [0.00231014]
Stock Position:  0.00231014172280009
Bond Position:  [23.00048797]


portfolio before change:  [23.24264953]
curr_Stock_Price:  103.58079649475341
curr_Factors:  [103.58079649]
mat_Sqrt:  [[0.15]]
grads:  [0.07866856]
Stock Position:  0.07866855779006794
Bond Position:  [15.09409765]


portfolio before change:  [23.20752217]
curr_Stock_Price:  103.11028786397056
curr_Factors:  [103.11028786]
mat_Sqrt:  [[0.15]]
grads:  [-0.10173901]
Stock Position:  -0.10173900678451966
Bond Position:  [33.69786045]


portfolio before change:  [23.21675714]
curr_Stock_Price:  103.06092165254867
curr_Factors:  [103.06092165]
mat_Sqrt:  [[0.15]]
grads:  [0.00621289]
Stock Position:  0.006212892637281499
Bond Position:  [22.5764507]


portfolio before change:  [23.21432253]
curr_Stock_Price:  102.21480316127379
curr_Factors:  [102.21480316]
mat_Sqrt:  [[0.15]]
grads:  [0.15486741]
Stock Position:  0.15486740610402183
Bond Position:  [7.3845811]


portfolio before change:  [23.02270876]
curr_Stock_Price:  100.9715660861417
curr_Factors:  [100.97156609]
mat_Sqrt:  [[0.15]]
grads:  [-0.11122456]
Stock Position:  -0.11122456367529822
Bond Position:  [34.25322714]


portfolio before change:  [23.00355406]
curr_Stock_Price:  101.18228045834098
curr_Factors:  [101.18228046]
mat_Sqrt:  [[0.15]]
grads:  [0.04084692]
Stock Position:  0.04084692044676525
Bond Position:  [18.8705695]


portfolio before change:  [23.02277758]
curr_Stock_Price:  101.59515244156589
curr_Factors:  [101.59515244]
mat_Sqrt:  [[0.15]]
grads:  [-0.05102952]
Stock Position:  -0.051029518810382465
Bond Position:  [28.20712932]


portfolio before change:  [22.95655838]
curr_Stock_Price:  102.96191662948215
curr_Factors:  [102.96191663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05513346]
Stock Position:  -0.05513345638805433
Bond Position:  [28.63320472]


portfolio before change:  [22.87697594]
curr_Stock_Price:  104.47028958025757
curr_Factors:  [104.47028958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313888]
Stock Position:  -0.0031388825158200615
Bond Position:  [23.2048959]


portfolio before change:  [22.87780126]
curr_Stock_Price:  105.1315021037374
curr_Factors:  [105.1315021]
mat_Sqrt:  [[0.15]]
grads:  [-0.07581658]
Stock Position:  -0.07581658260711717
Bond Position:  [30.84851247]


portfolio before change:  [22.86131428]
curr_Stock_Price:  105.3998245097584
curr_Factors:  [105.39982451]
mat_Sqrt:  [[0.15]]
grads:  [0.40573598]
Stock Position:  0.40573597671175543
Bond Position:  [-19.90318647]


portfolio before change:  [23.3288164]
curr_Stock_Price:  106.55818907953457
curr_Factors:  [106.55818908]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197605]
Stock Position:  -0.01976050082437349
Bond Position:  [25.43445959]


portfolio before change:  [23.34218796]
curr_Stock_Price:  106.04241021253769
curr_Factors:  [106.04241021]
mat_Sqrt:  [[0.15]]
grads:  [-0.0667386]
Stock Position:  -0.06673860425798087
Bond Position:  [30.41931041]


portfolio before change:  [23.29421049]
curr_Stock_Price:  106.81827479976685
curr_Factors:  [106.8182748]
mat_Sqrt:  [[0.15]]
grads:  [0.02789736]
Stock Position:  0.027897359619053985
Bond Position:  [20.31426266]


portfolio before change:  [23.25861456]
curr_Stock_Price:  105.45128626461648
curr_Factors:  [105.45128626]
mat_Sqrt:  [[0.15]]
grads:  [0.03886228]
Stock Position:  0.0388622819197374
Bond Position:  [19.16053695]


portfolio before change:  [23.28551618]
curr_Stock_Price:  106.08188233816479
curr_Factors:  [106.08188234]
mat_Sqrt:  [[0.15]]
grads:  [-0.0007599]
Stock Position:  -0.0007599045678336955
Bond Position:  [23.36612829]


portfolio before change:  [23.28838221]
curr_Stock_Price:  106.1541495964634
curr_Factors:  [106.1541496]
mat_Sqrt:  [[0.15]]
grads:  [0.05174054]
Stock Position:  0.051740537193682025
Bond Position:  [17.79590949]


portfolio before change:  [23.28546623]
curr_Stock_Price:  106.05479597811035
curr_Factors:  [106.05479598]
mat_Sqrt:  [[0.15]]
grads:  [0.02710832]
Stock Position:  0.027108317908081794
Bond Position:  [20.41049911]


portfolio before change:  [23.25493633]
curr_Stock_Price:  104.83445576811911
curr_Factors:  [104.83445577]
mat_Sqrt:  [[0.15]]
grads:  [-0.15199808]
Stock Position:  -0.1519980828056631
Bond Position:  [39.18957262]


portfolio before change:  [23.12912447]
curr_Stock_Price:  105.69440651174622
curr_Factors:  [105.69440651]
mat_Sqrt:  [[0.15]]
grads:  [0.06562406]
Stock Position:  0.06562406004739194
Bond Position:  [16.19302839]


portfolio before change:  [23.09714204]
curr_Stock_Price:  105.1762020184331
curr_Factors:  [105.17620202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.09714204]
Stock Price:  105.03074297011422
PL:  [18.06639907]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.09301249e-03]
 [ 4.74345276e-03]
 [ 1.24864962e-02]
 [-2.67780149e-03]
 [ 1.28337762e-02]
 [ 4.98497340e-03]
 [-4.68853276e-02]
 [ 1.70298613e-02]
 [-6.04781735e-03]
 [-2.37557357e-04]
 [-3.82747690e-03]
 [ 7.19160658e-03]
 [ 1.39146482e-02]
 [ 2.40405568e-03]
 [ 8.42611893e-03]
 [-4.77660184e-03]
 [ 2.05712722e-02]
 [-2.87300657e-02]
 [ 2.43866667e-03]
 [ 3.74591863e-03]
 [ 2.40401781e-02]
 [-2.20864931e-03]
 [ 2.68568509e-02]
 [ 1.89508475e-04]
 [ 1.00124862e-02]
 [ 1.53904862e-02]
 [ 3.59964945e-02]
 [-2.75609954e-02]
 [-4.73125847e-02]
 [ 2.52340140e-03]
 [-4.48114973e-03]
 [ 5.59031280e-03]
 [ 2.14359826e-02]
 [-1.60057924e-02]
 [ 5.22139266e-03]
 [ 4.00190374e-03]
 [ 9.43830955e-03]
 [ 8.04247439e-03]
 [-7.31182060e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.50831662]
curr_Stock_Price:  100.80998640027074
curr_Factors:  [100.8099864]
mat_Sqrt:  [[0.15]]
grads:  [0.04062008]
Stock Position:  0.04062008323947108
Bond Position:  [10.41340658]


portfolio before change:  [14.48400174]
curr_Stock_Price:  100.17934677263855
curr_Factors:  [100.17934677]
mat_Sqrt:  [[0.15]]
grads:  [0.03162302]
Stock Position:  0.031623018404903114
Bond Position:  [11.31602841]


portfolio before change:  [14.50370003]
curr_Stock_Price:  100.75752368552784
curr_Factors:  [100.75752369]
mat_Sqrt:  [[0.15]]
grads:  [0.08324331]
Stock Position:  0.083243308242272
Bond Position:  [6.11631043]


portfolio before change:  [14.48606528]
curr_Stock_Price:  100.53649282171199
curr_Factors:  [100.53649282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785201]
Stock Position:  -0.017852009944463842
Bond Position:  [16.28084375]


portfolio before change:  [14.50006205]
curr_Stock_Price:  99.86645375032742
curr_Factors:  [99.86645375]
mat_Sqrt:  [[0.15]]
grads:  [0.08555851]
Stock Position:  0.08555850787541855
Bond Position:  [5.95563728]


portfolio before change:  [14.47266516]
curr_Stock_Price:  99.53753974532238
curr_Factors:  [99.53753975]
mat_Sqrt:  [[0.15]]
grads:  [0.03323316]
Stock Position:  0.03323315600875327
Bond Position:  [11.16471857]


portfolio before change:  [14.4073076]
curr_Stock_Price:  97.52890589052382
curr_Factors:  [97.52890589]
mat_Sqrt:  [[0.15]]
grads:  [-0.31256885]
Stock Position:  -0.3125688509245738
Bond Position:  [44.89180564]


portfolio before change:  [14.47209124]
curr_Stock_Price:  97.33959778990628
curr_Factors:  [97.33959779]
mat_Sqrt:  [[0.15]]
grads:  [0.11353241]
Stock Position:  0.11353240889395241
Bond Position:  [3.42089222]


portfolio before change:  [14.5519556]
curr_Stock_Price:  98.03928102324556
curr_Factors:  [98.03928102]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031878]
Stock Position:  -0.0403187823388013
Bond Position:  [18.50478003]


portfolio before change:  [14.55536009]
curr_Stock_Price:  98.01221543471411
curr_Factors:  [98.01221543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158372]
Stock Position:  -0.001583715714376909
Bond Position:  [14.71058358]


portfolio before change:  [14.5573356]
curr_Stock_Price:  97.92598159266068
curr_Factors:  [97.92598159]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551651]
Stock Position:  -0.025516512642490132
Bond Position:  [17.05606515]


portfolio before change:  [14.5509851]
curr_Stock_Price:  98.25841899799906
curr_Factors:  [98.258419]
mat_Sqrt:  [[0.15]]
grads:  [0.04794404]
Stock Position:  0.047944043848218966
Bond Position:  [9.84007915]


portfolio before change:  [14.55133701]
curr_Stock_Price:  98.24010228014545
curr_Factors:  [98.24010228]
mat_Sqrt:  [[0.15]]
grads:  [0.09276432]
Stock Position:  0.09276432153956937
Bond Position:  [5.43816057]


portfolio before change:  [14.54881116]
curr_Stock_Price:  98.20554518215327
curr_Factors:  [98.20554518]
mat_Sqrt:  [[0.15]]
grads:  [0.01602704]
Stock Position:  0.016027037838893567
Bond Position:  [12.97486717]


portfolio before change:  [14.56126731]
curr_Stock_Price:  98.88154030428275
curr_Factors:  [98.8815403]
mat_Sqrt:  [[0.15]]
grads:  [0.05617413]
Stock Position:  0.05617412620175869
Bond Position:  [9.00668319]


portfolio before change:  [14.46331219]
curr_Stock_Price:  97.1177205190881
curr_Factors:  [97.11772052]
mat_Sqrt:  [[0.15]]
grads:  [-0.03184401]
Stock Position:  -0.03184401226269651
Bond Position:  [17.55593007]


portfolio before change:  [14.51138286]
curr_Stock_Price:  95.67707142332955
curr_Factors:  [95.67707142]
mat_Sqrt:  [[0.15]]
grads:  [0.13714181]
Stock Position:  0.13714181450246685
Bond Position:  [1.39005568]


portfolio before change:  [14.46477433]
curr_Stock_Price:  95.33594787340759
curr_Factors:  [95.33594787]
mat_Sqrt:  [[0.15]]
grads:  [-0.19153377]
Stock Position:  -0.19153377137122962
Bond Position:  [32.72482797]


portfolio before change:  [14.41912537]
curr_Stock_Price:  95.59564000390453
curr_Factors:  [95.59564]
mat_Sqrt:  [[0.15]]
grads:  [0.01625778]
Stock Position:  0.016257777782973416
Bond Position:  [12.8649527]


portfolio before change:  [14.41846909]
curr_Stock_Price:  95.45635285256333
curr_Factors:  [95.45635285]
mat_Sqrt:  [[0.15]]
grads:  [0.02497279]
Stock Position:  0.024972790883074313
Bond Position:  [12.03465755]


portfolio before change:  [14.42433618]
curr_Stock_Price:  95.63104960081995
curr_Factors:  [95.6310496]
mat_Sqrt:  [[0.15]]
grads:  [0.16026785]
Stock Position:  0.1602678536676663
Bond Position:  [-0.90224688]


portfolio before change:  [14.42632637]
curr_Stock_Price:  95.64417119123898
curr_Factors:  [95.64417119]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472433]
Stock Position:  -0.014724328711938663
Bond Position:  [15.83462258]


portfolio before change:  [14.43441507]
curr_Stock_Price:  95.22926215420685
curr_Factors:  [95.22926215]
mat_Sqrt:  [[0.15]]
grads:  [0.17904567]
Stock Position:  0.1790456729786664
Bond Position:  [-2.61597226]


portfolio before change:  [14.24864493]
curr_Stock_Price:  94.19353130128424
curr_Factors:  [94.1935313]
mat_Sqrt:  [[0.15]]
grads:  [0.00126339]
Stock Position:  0.0012633898304527324
Bond Position:  [14.12964178]


portfolio before change:  [14.25013472]
curr_Stock_Price:  93.97465316737474
curr_Factors:  [93.97465317]
mat_Sqrt:  [[0.15]]
grads:  [0.06674991]
Stock Position:  0.06674990807743036
Bond Position:  [7.97733526]


portfolio before change:  [14.24185942]
curr_Stock_Price:  93.83573869237969
curr_Factors:  [93.83573869]
mat_Sqrt:  [[0.15]]
grads:  [0.10260324]
Stock Position:  0.10260324101987663
Bond Position:  [4.6140085]


portfolio before change:  [14.13251275]
curr_Stock_Price:  92.76439385283219
curr_Factors:  [92.76439385]
mat_Sqrt:  [[0.15]]
grads:  [0.23997663]
Stock Position:  0.23997662993448993
Bond Position:  [-8.12877386]


portfolio before change:  [14.14335889]
curr_Stock_Price:  92.81382489771411
curr_Factors:  [92.8138249]
mat_Sqrt:  [[0.15]]
grads:  [-0.18373997]
Stock Position:  -0.18373996935033007
Bond Position:  [31.19696823]


portfolio before change:  [14.01700886]
curr_Stock_Price:  93.52270655981877
curr_Factors:  [93.52270656]
mat_Sqrt:  [[0.15]]
grads:  [-0.31541723]
Stock Position:  -0.31541723160109475
Bond Position:  [43.51568205]


portfolio before change:  [14.02365226]
curr_Stock_Price:  93.51889064891328
curr_Factors:  [93.51889065]
mat_Sqrt:  [[0.15]]
grads:  [0.01682268]
Stock Position:  0.01682267601186473
Bond Position:  [12.45041426]


portfolio before change:  [14.02684674]
curr_Stock_Price:  93.6162637189877
curr_Factors:  [93.61626372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02987433]
Stock Position:  -0.029874331545276044
Bond Position:  [16.82357004]


portfolio before change:  [14.06307327]
curr_Stock_Price:  92.47403043948624
curr_Factors:  [92.47403044]
mat_Sqrt:  [[0.15]]
grads:  [0.03726875]
Stock Position:  0.037268752022666336
Bond Position:  [10.61668156]


portfolio before change:  [14.05461255]
curr_Stock_Price:  92.21140067520311
curr_Factors:  [92.21140068]
mat_Sqrt:  [[0.15]]
grads:  [0.14290655]
Stock Position:  0.14290655052838006
Bond Position:  [0.87699936]


portfolio before change:  [14.01136874]
curr_Stock_Price:  91.90803145399887
curr_Factors:  [91.90803145]
mat_Sqrt:  [[0.15]]
grads:  [-0.10670528]
Stock Position:  -0.10670528240486128
Bond Position:  [23.81844119]


portfolio before change:  [13.97124989]
curr_Stock_Price:  92.31191343423721
curr_Factors:  [92.31191343]
mat_Sqrt:  [[0.15]]
grads:  [0.03480928]
Stock Position:  0.03480928440567349
Bond Position:  [10.75793824]


portfolio before change:  [13.97267042]
curr_Stock_Price:  92.31408822020987
curr_Factors:  [92.31408822]
mat_Sqrt:  [[0.15]]
grads:  [0.02667936]
Stock Position:  0.02667935828772451
Bond Position:  [11.50978978]


portfolio before change:  [13.97070486]
curr_Stock_Price:  92.1864851401697
curr_Factors:  [92.18648514]
mat_Sqrt:  [[0.15]]
grads:  [0.06292206]
Stock Position:  0.06292206365971735
Bond Position:  [8.17014097]


portfolio before change:  [13.99913353]
curr_Stock_Price:  92.62206101665609
curr_Factors:  [92.62206102]
mat_Sqrt:  [[0.15]]
grads:  [0.0536165]
Stock Position:  0.053616495963413016
Bond Position:  [9.03306317]


portfolio before change:  [13.99797417]
curr_Stock_Price:  92.57937712122377
curr_Factors:  [92.57937712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.99797417]
Stock Price:  93.73251647828566
PL:  [13.99797417]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.42317725e-03]
 [ 4.67576813e-03]
 [ 9.73816511e-03]
 [-2.34698350e-03]
 [ 1.39034627e-02]
 [ 2.64611588e-02]
 [ 1.52050043e-03]
 [ 1.11616779e-02]
 [-7.32799589e-03]
 [-1.78678213e-03]
 [ 9.00228730e-03]
 [ 6.26774232e-03]
 [ 8.21154629e-03]
 [-4.05781932e-03]
 [ 4.42809632e-03]
 [ 2.45533633e-03]
 [ 8.88538647e-03]
 [ 1.38449277e-02]
 [ 1.15736891e-02]
 [-1.25794093e-02]
 [ 1.73054961e-03]
 [ 2.61997206e-02]
 [-2.53707937e-02]
 [ 5.27664650e-03]
 [ 2.02290787e-03]
 [-7.13743724e-03]
 [-7.25603793e-04]
 [-1.06951099e-02]
 [ 5.92831668e-02]
 [-2.97600799e-03]
 [-8.63445632e-03]
 [ 4.50204196e-03]
 [ 5.87729468e-03]
 [-1.35711480e-03]
 [ 7.16790082e-03]
 [ 4.50076129e-03]
 [-4.68741587e-02]
 [ 9.83956153e-03]
 [-9.84403963e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.77353794]
curr_Stock_Price:  99.82416360376018
curr_Factors:  [99.8241636]
mat_Sqrt:  [[0.15]]
grads:  [0.01615451]
Stock Position:  0.016154514979492118
Bond Position:  [-2.38614889]


portfolio before change:  [-0.76642475]
curr_Stock_Price:  100.28295047490096
curr_Factors:  [100.28295047]
mat_Sqrt:  [[0.15]]
grads:  [0.03117179]
Stock Position:  0.03117178756090263
Bond Position:  [-3.89242358]


portfolio before change:  [-0.76236748]
curr_Stock_Price:  100.42871848095416
curr_Factors:  [100.42871848]
mat_Sqrt:  [[0.15]]
grads:  [0.0649211]
Stock Position:  0.06492110070704123
Bond Position:  [-7.28231043]


portfolio before change:  [-0.83118987]
curr_Stock_Price:  99.38264805815294
curr_Factors:  [99.38264806]
mat_Sqrt:  [[0.15]]
grads:  [-0.01564656]
Stock Position:  -0.01564655663717977
Bond Position:  [0.72380636]


portfolio before change:  [-0.84135426]
curr_Stock_Price:  100.03805573826746
curr_Factors:  [100.03805574]
mat_Sqrt:  [[0.15]]
grads:  [0.09268975]
Stock Position:  0.09268975100234236
Bond Position:  [-10.11385674]


portfolio before change:  [-0.72307407]
curr_Stock_Price:  101.32778308864359
curr_Factors:  [101.32778309]
mat_Sqrt:  [[0.15]]
grads:  [0.17640773]
Stock Position:  0.17640772553068723
Bond Position:  [-18.59807781]


portfolio before change:  [-0.87507493]
curr_Stock_Price:  100.47931709388483
curr_Factors:  [100.47931709]
mat_Sqrt:  [[0.15]]
grads:  [0.01013667]
Stock Position:  0.01013666955057799
Bond Position:  [-1.89360056]


portfolio before change:  [-0.86323518]
curr_Stock_Price:  101.67068121351136
curr_Factors:  [101.67068121]
mat_Sqrt:  [[0.15]]
grads:  [0.07441119]
Stock Position:  0.07441118570835159
Bond Position:  [-8.42867112]


portfolio before change:  [-0.89883681]
curr_Stock_Price:  101.20639642615035
curr_Factors:  [101.20639643]
mat_Sqrt:  [[0.15]]
grads:  [-0.04885331]
Stock Position:  -0.048853305960656755
Bond Position:  [4.04543024]


portfolio before change:  [-0.90794746]
curr_Stock_Price:  101.40323795442603
curr_Factors:  [101.40323795]
mat_Sqrt:  [[0.15]]
grads:  [-0.01191188]
Stock Position:  -0.011911880876103573
Bond Position:  [0.29995583]


portfolio before change:  [-0.90691411]
curr_Stock_Price:  101.31963660440118
curr_Factors:  [101.3196366]
mat_Sqrt:  [[0.15]]
grads:  [0.06001525]
Stock Position:  0.06001524869107143
Bond Position:  [-6.9876373]


portfolio before change:  [-0.84393278]
curr_Stock_Price:  102.38361347945539
curr_Factors:  [102.38361348]
mat_Sqrt:  [[0.15]]
grads:  [0.04178495]
Stock Position:  0.04178494880215636
Bond Position:  [-5.12202683]


portfolio before change:  [-0.85654039]
curr_Stock_Price:  102.09721109009048
curr_Factors:  [102.09721109]
mat_Sqrt:  [[0.15]]
grads:  [0.05474364]
Stock Position:  0.05474364192983123
Bond Position:  [-6.44571355]


portfolio before change:  [-0.75731119]
curr_Stock_Price:  103.92454588760127
curr_Factors:  [103.92454589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02705213]
Stock Position:  -0.027052128788047886
Bond Position:  [2.05406901]


portfolio before change:  [-0.7565253]
curr_Stock_Price:  103.90498684155733
curr_Factors:  [103.90498684]
mat_Sqrt:  [[0.15]]
grads:  [0.02952064]
Stock Position:  0.029520642122878752
Bond Position:  [-3.82386723]


portfolio before change:  [-0.79381022]
curr_Stock_Price:  102.65816760415203
curr_Factors:  [102.6581676]
mat_Sqrt:  [[0.15]]
grads:  [0.01636891]
Stock Position:  0.016368908838502224
Bond Position:  [-2.47421241]


portfolio before change:  [-0.81000241]
curr_Stock_Price:  101.68785902091582
curr_Factors:  [101.68785902]
mat_Sqrt:  [[0.15]]
grads:  [0.05923591]
Stock Position:  0.059235909815959095
Bond Position:  [-6.83357525]


portfolio before change:  [-0.83330317]
curr_Stock_Price:  101.30892487606656
curr_Factors:  [101.30892488]
mat_Sqrt:  [[0.15]]
grads:  [0.09229952]
Stock Position:  0.09229951768125264
Bond Position:  [-10.18406807]


portfolio before change:  [-0.94451015]
curr_Stock_Price:  100.1178688453207
curr_Factors:  [100.11786885]
mat_Sqrt:  [[0.15]]
grads:  [0.07715793]
Stock Position:  0.07715792704067202
Bond Position:  [-8.66939737]


portfolio before change:  [-0.90477425]
curr_Stock_Price:  100.64690903312189
curr_Factors:  [100.64690903]
mat_Sqrt:  [[0.15]]
grads:  [-0.08386273]
Stock Position:  -0.08386272881831856
Bond Position:  [7.53575019]


portfolio before change:  [-1.12011259]
curr_Stock_Price:  103.22588985331147
curr_Factors:  [103.22588985]
mat_Sqrt:  [[0.15]]
grads:  [0.011537]
Stock Position:  0.011536997422704812
Bond Position:  [-2.31102942]


portfolio before change:  [-1.1261518]
curr_Stock_Price:  102.72746656233771
curr_Factors:  [102.72746656]
mat_Sqrt:  [[0.15]]
grads:  [0.1746648]
Stock Position:  0.17466480391707692
Bond Position:  [-19.0690246]


portfolio before change:  [-0.88684119]
curr_Stock_Price:  104.11122777192466
curr_Factors:  [104.11122777]
mat_Sqrt:  [[0.15]]
grads:  [-0.16913862]
Stock Position:  -0.16913862451917963
Bond Position:  [16.72238867]


portfolio before change:  [-0.58796721]
curr_Stock_Price:  102.35655135023286
curr_Factors:  [102.35655135]
mat_Sqrt:  [[0.15]]
grads:  [0.03517764]
Stock Position:  0.03517764331639963
Bond Position:  [-4.18862946]


portfolio before change:  [-0.56195384]
curr_Stock_Price:  103.110922011849
curr_Factors:  [103.11092201]
mat_Sqrt:  [[0.15]]
grads:  [0.01348605]
Stock Position:  0.013486052490623315
Bond Position:  [-1.95251314]


portfolio before change:  [-0.56729268]
curr_Stock_Price:  102.73314152189455
curr_Factors:  [102.73314152]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758291]
Stock Position:  -0.04758291494756856
Bond Position:  [4.32104965]


portfolio before change:  [-0.61382158]
curr_Stock_Price:  103.72234230614845
curr_Factors:  [103.72234231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483736]
Stock Position:  -0.004837358620176891
Bond Position:  [-0.11207941]


portfolio before change:  [-0.61660921]
curr_Stock_Price:  104.29571744586443
curr_Factors:  [104.29571745]
mat_Sqrt:  [[0.15]]
grads:  [-0.07130073]
Stock Position:  -0.07130073249305324
Bond Position:  [6.81975184]


portfolio before change:  [-0.6724714]
curr_Stock_Price:  105.09114700585712
curr_Factors:  [105.09114701]
mat_Sqrt:  [[0.15]]
grads:  [0.39522111]
Stock Position:  0.3952211121877139
Bond Position:  [-42.2067114]


portfolio before change:  [-0.19655011]
curr_Stock_Price:  106.30868685182048
curr_Factors:  [106.30868685]
mat_Sqrt:  [[0.15]]
grads:  [-0.01984005]
Stock Position:  -0.019840053254674344
Bond Position:  [1.9126199]


portfolio before change:  [-0.1793176]
curr_Stock_Price:  105.4521659209333
curr_Factors:  [105.45216592]
mat_Sqrt:  [[0.15]]
grads:  [-0.05756304]
Stock Position:  -0.057563042119196675
Bond Position:  [5.89082987]


portfolio before change:  [-0.16599449]
curr_Stock_Price:  105.23350631181326
curr_Factors:  [105.23350631]
mat_Sqrt:  [[0.15]]
grads:  [0.03001361]
Stock Position:  0.030013613039075578
Bond Position:  [-3.32443222]


portfolio before change:  [-0.174894]
curr_Stock_Price:  104.95083666538086
curr_Factors:  [104.95083667]
mat_Sqrt:  [[0.15]]
grads:  [0.03918196]
Stock Position:  0.03918196451821692
Bond Position:  [-4.28707396]


portfolio before change:  [-0.15353575]
curr_Stock_Price:  105.50961860659169
curr_Factors:  [105.50961861]
mat_Sqrt:  [[0.15]]
grads:  [-0.00904743]
Stock Position:  -0.009047432024314045
Bond Position:  [0.80105535]


portfolio before change:  [-0.14926783]
curr_Stock_Price:  105.04895927345402
curr_Factors:  [105.04895927]
mat_Sqrt:  [[0.15]]
grads:  [0.04778601]
Stock Position:  0.04778600544857504
Bond Position:  [-5.16913797]


portfolio before change:  [-0.14662337]
curr_Stock_Price:  105.11782133530663
curr_Factors:  [105.11782134]
mat_Sqrt:  [[0.15]]
grads:  [0.03000508]
Stock Position:  0.030005075284880858
Bond Position:  [-3.30069151]


portfolio before change:  [-0.09240271]
curr_Stock_Price:  106.93862216310337
curr_Factors:  [106.93862216]
mat_Sqrt:  [[0.15]]
grads:  [-0.31249439]
Stock Position:  -0.3124943915002284
Bond Position:  [33.32531695]


portfolio before change:  [0.29461464]
curr_Stock_Price:  105.71347561268207
curr_Factors:  [105.71347561]
mat_Sqrt:  [[0.15]]
grads:  [0.06559708]
Stock Position:  0.0655970768982026
Bond Position:  [-6.63988035]


portfolio before change:  [0.2766208]
curr_Stock_Price:  105.45182070193714
curr_Factors:  [105.4518207]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.2766208]
Stock Price:  104.17440765651433
PL:  [-3.89778685]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.71601145e-03]
 [-1.39655423e-03]
 [-2.02174826e-03]
 [-2.80037996e-03]
 [ 1.53582963e-02]
 [ 2.14530362e-02]
 [-4.18049293e-03]
 [ 1.16416462e-02]
 [-8.62060312e-03]
 [-9.48599634e-04]
 [ 2.82166310e-02]
 [ 1.02282212e-02]
 [-6.31402256e-03]
 [-4.31890697e-03]
 [-4.30482567e-03]
 [ 6.34023782e-03]
 [ 9.22691379e-03]
 [-2.37242992e-02]
 [ 1.25394619e-02]
 [-1.80451487e-02]
 [ 1.74684100e-02]
 [ 4.20546146e-02]
 [ 1.72495298e-02]
 [ 7.26352153e-03]
 [ 7.70248972e-03]
 [-1.78722236e-02]
 [-4.55400587e-04]
 [-1.07088567e-02]
 [ 5.83002621e-02]
 [-6.34409869e-03]
 [-5.16620202e-03]
 [ 4.70803724e-03]
 [ 5.26974260e-03]
 [-5.56753505e-03]
 [ 2.01509447e-02]
 [ 5.59208517e-03]
 [ 1.79005689e-03]
 [ 7.86518323e-03]
 [-9.15671666e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.81760832]
curr_Stock_Price:  99.62779254364193
curr_Factors:  [99.62779254]
mat_Sqrt:  [[0.15]]
grads:  [0.02477341]
Stock Position:  0.02477340967094245
Bond Position:  [-6.28572844]


portfolio before change:  [-3.82163877]
curr_Stock_Price:  99.49681826100523
curr_Factors:  [99.49681826]
mat_Sqrt:  [[0.15]]
grads:  [-0.00931036]
Stock Position:  -0.009310361565010052
Bond Position:  [-2.89528742]


portfolio before change:  [-3.81980426]
curr_Stock_Price:  99.26090482568037
curr_Factors:  [99.26090483]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347832]
Stock Position:  -0.013478321701565326
Bond Position:  [-2.48193386]


portfolio before change:  [-3.83002695]
curr_Stock_Price:  99.99633932819104
curr_Factors:  [99.99633933]
mat_Sqrt:  [[0.15]]
grads:  [-0.0186692]
Stock Position:  -0.01866919973329679
Bond Position:  [-1.96317532]


portfolio before change:  [-3.83995266]
curr_Stock_Price:  100.51485629994964
curr_Factors:  [100.5148563]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-14.1315323]


portfolio before change:  [-3.85916895]
curr_Stock_Price:  100.34442977613767
curr_Factors:  [100.34442978]
mat_Sqrt:  [[0.15]]
grads:  [0.14302024]
Stock Position:  0.14302024119416257
Bond Position:  [-18.2104535]


portfolio before change:  [-3.77172992]
curr_Stock_Price:  100.97172192601143
curr_Factors:  [100.97172193]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786995]
Stock Position:  -0.0278699528407114
Bond Position:  [-0.95765279]


portfolio before change:  [-3.78903109]
curr_Stock_Price:  101.58820860807984
curr_Factors:  [101.58820861]
mat_Sqrt:  [[0.15]]
grads:  [0.07761097]
Stock Position:  0.07761097460918363
Bond Position:  [-11.67339097]


portfolio before change:  [-3.75909783]
curr_Stock_Price:  101.9926942415616
curr_Factors:  [101.99269424]
mat_Sqrt:  [[0.15]]
grads:  [-0.05747069]
Stock Position:  -0.057470687478195774
Bond Position:  [2.10249242]


portfolio before change:  [-3.92784703]
curr_Stock_Price:  104.93353300574995
curr_Factors:  [104.93353301]
mat_Sqrt:  [[0.15]]
grads:  [-0.006324]
Stock Position:  -0.006323997559383538
Bond Position:  [-3.26424762]


portfolio before change:  [-3.92913143]
curr_Stock_Price:  105.0721069266653
curr_Factors:  [105.07210693]
mat_Sqrt:  [[0.15]]
grads:  [0.18811087]
Stock Position:  0.1881108732360032
Bond Position:  [-23.69433721]


portfolio before change:  [-3.83582692]
curr_Stock_Price:  105.58386090944256
curr_Factors:  [105.58386091]
mat_Sqrt:  [[0.15]]
grads:  [0.06818814]
Stock Position:  0.06818814102224435
Bond Position:  [-11.03539411]


portfolio before change:  [-3.75130014]
curr_Stock_Price:  106.84370298283021
curr_Factors:  [106.84370298]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209348]
Stock Position:  -0.04209348376127742
Bond Position:  [0.74612354]


portfolio before change:  [-3.68326231]
curr_Stock_Price:  105.22956828633583
curr_Factors:  [105.22956829]
mat_Sqrt:  [[0.15]]
grads:  [-0.02879271]
Stock Position:  -0.02879271314060093
Bond Position:  [-0.65341754]


portfolio before change:  [-3.70590569]
curr_Stock_Price:  106.01315880798542
curr_Factors:  [106.01315881]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869884]
Stock Position:  -0.02869883783156892
Bond Position:  [-0.66345124]


portfolio before change:  [-3.72099342]
curr_Stock_Price:  106.53599501439045
curr_Factors:  [106.53599501]
mat_Sqrt:  [[0.15]]
grads:  [0.04226825]
Stock Position:  0.04226825213968349
Bond Position:  [-8.22408372]


portfolio before change:  [-3.75005731]
curr_Stock_Price:  105.87271190653958
curr_Factors:  [105.87271191]
mat_Sqrt:  [[0.15]]
grads:  [0.06151276]
Stock Position:  0.06151275857597201
Bond Position:  [-10.26257988]


portfolio before change:  [-3.70887356]
curr_Stock_Price:  106.5630834709612
curr_Factors:  [106.56308347]
mat_Sqrt:  [[0.15]]
grads:  [-0.15816199]
Stock Position:  -0.15816199471417758
Bond Position:  [13.14535629]


portfolio before change:  [-3.70359548]
curr_Stock_Price:  106.5401019347342
curr_Factors:  [106.54010193]
mat_Sqrt:  [[0.15]]
grads:  [0.08359641]
Stock Position:  0.08359641270943628
Bond Position:  [-12.60996581]


portfolio before change:  [-3.71683528]
curr_Stock_Price:  106.40058085944553
curr_Factors:  [106.40058086]
mat_Sqrt:  [[0.15]]
grads:  [-0.12030099]
Stock Position:  -0.12030099125595155
Bond Position:  [9.08326006]


portfolio before change:  [-3.73095508]
curr_Stock_Price:  106.52739005229267
curr_Factors:  [106.52739005]
mat_Sqrt:  [[0.15]]
grads:  [0.11645607]
Stock Position:  0.1164560668910168
Bond Position:  [-16.13671594]


portfolio before change:  [-3.79169522]
curr_Stock_Price:  106.02314041950083
curr_Factors:  [106.02314042]
mat_Sqrt:  [[0.15]]
grads:  [0.2803641]
Stock Position:  0.28036409730416206
Bond Position:  [-33.51677728]


portfolio before change:  [-3.66617851]
curr_Stock_Price:  106.48577656991407
curr_Factors:  [106.48577657]
mat_Sqrt:  [[0.15]]
grads:  [0.11499687]
Stock Position:  0.11499686536093764
Bond Position:  [-15.91170903]


portfolio before change:  [-3.65798555]
curr_Stock_Price:  106.57431856939169
curr_Factors:  [106.57431857]
mat_Sqrt:  [[0.15]]
grads:  [0.04842348]
Stock Position:  0.04842347686579508
Bond Position:  [-8.8186846]


portfolio before change:  [-3.6815602]
curr_Stock_Price:  106.11024101236032
curr_Factors:  [106.11024101]
mat_Sqrt:  [[0.15]]
grads:  [0.05134993]
Stock Position:  0.05134993145670559
Bond Position:  [-9.13031381]


portfolio before change:  [-3.72392173]
curr_Stock_Price:  105.30751026741385
curr_Factors:  [105.30751027]
mat_Sqrt:  [[0.15]]
grads:  [-0.11914816]
Stock Position:  -0.11914815726207939
Bond Position:  [8.82327406]


portfolio before change:  [-3.62959384]
curr_Stock_Price:  104.52508178208623
curr_Factors:  [104.52508178]
mat_Sqrt:  [[0.15]]
grads:  [-0.003036]
Stock Position:  -0.003036003910092858
Bond Position:  [-3.31225529]


portfolio before change:  [-3.62831512]
curr_Stock_Price:  103.96751226598691
curr_Factors:  [103.96751227]
mat_Sqrt:  [[0.15]]
grads:  [-0.07139238]
Stock Position:  -0.07139237806812902
Bond Position:  [3.79417283]


portfolio before change:  [-3.69432652]
curr_Stock_Price:  104.89878403419166
curr_Factors:  [104.89878403]
mat_Sqrt:  [[0.15]]
grads:  [0.38866841]
Stock Position:  0.3886684137858494
Bond Position:  [-44.46517052]


portfolio before change:  [-3.98877098]
curr_Stock_Price:  104.15551302084694
curr_Factors:  [104.15551302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04229399]
Stock Position:  -0.042293991265704704
Bond Position:  [0.41638138]


portfolio before change:  [-3.98065278]
curr_Stock_Price:  103.96479670389405
curr_Factors:  [103.9647967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03444135]
Stock Position:  -0.034441346800191716
Bond Position:  [-0.39996516]


portfolio before change:  [-3.98897919]
curr_Stock_Price:  104.2051013413579
curr_Factors:  [104.20510134]
mat_Sqrt:  [[0.15]]
grads:  [0.03138691]
Stock Position:  0.03138691491404134
Bond Position:  [-7.25965584]


portfolio before change:  [-4.02371892]
curr_Stock_Price:  103.12719297109932
curr_Factors:  [103.12719297]
mat_Sqrt:  [[0.15]]
grads:  [0.03513162]
Stock Position:  0.03513161736389188
Bond Position:  [-7.64674401]


portfolio before change:  [-4.0603203]
curr_Stock_Price:  102.11256642444138
curr_Factors:  [102.11256642]
mat_Sqrt:  [[0.15]]
grads:  [-0.0371169]
Stock Position:  -0.037116900337589465
Bond Position:  [-0.27021835]


portfolio before change:  [-4.04345132]
curr_Stock_Price:  101.65717407934162
curr_Factors:  [101.65717408]
mat_Sqrt:  [[0.15]]
grads:  [0.13433963]
Stock Position:  0.13433963109017644
Bond Position:  [-17.70003859]


portfolio before change:  [-4.2531572]
curr_Stock_Price:  100.112631835008
curr_Factors:  [100.11263184]
mat_Sqrt:  [[0.15]]
grads:  [0.03728057]
Stock Position:  0.03728056776996935
Bond Position:  [-7.98541296]


portfolio before change:  [-4.21599229]
curr_Stock_Price:  101.13630584803933
curr_Factors:  [101.13630585]
mat_Sqrt:  [[0.15]]
grads:  [0.01193371]
Stock Position:  0.011933712578318425
Bond Position:  [-5.4229239]


portfolio before change:  [-4.22450942]
curr_Stock_Price:  100.47940920016916
curr_Factors:  [100.4794092]
mat_Sqrt:  [[0.15]]
grads:  [0.05243455]
Stock Position:  0.052434554841285785
Bond Position:  [-9.49310251]


portfolio before change:  [-4.21815755]
curr_Stock_Price:  100.62318042622003
curr_Factors:  [100.62318043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.21815755]
Stock Price:  101.41211950176698
PL:  [-5.63027705]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.91298191e-03]
 [ 4.46614328e-03]
 [ 9.22948805e-03]
 [-2.28781577e-03]
 [-2.29088663e-02]
 [-3.17807067e-02]
 [-4.36727649e-02]
 [ 1.46972712e-02]
 [-6.42576685e-03]
 [-6.18209158e-05]
 [-6.72398760e-03]
 [ 7.28125669e-03]
 [ 1.39140512e-02]
 [ 9.61527437e-04]
 [-5.32090314e-04]
 [-7.30980186e-03]
 [ 2.03517079e-02]
 [-3.23551643e-02]
 [ 1.43205890e-03]
 [ 7.12101822e-03]
 [ 2.56880231e-02]
 [-1.62927296e-03]
 [ 2.83757331e-02]
 [ 9.46043349e-04]
 [ 1.14957246e-02]
 [ 1.61326207e-02]
 [ 3.50848843e-02]
 [-2.77425056e-02]
 [-4.71645597e-02]
 [ 2.74767926e-03]
 [-4.45260282e-03]
 [ 5.59234021e-03]
 [ 2.44364489e-02]
 [-1.69663692e-02]
 [ 6.15931181e-03]
 [ 2.45377798e-03]
 [ 1.14770914e-02]
 [ 5.75739013e-03]
 [-8.05973991e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.89486961]
curr_Stock_Price:  100.18982899882411
curr_Factors:  [100.189829]
mat_Sqrt:  [[0.15]]
grads:  [0.03941988]
Stock Position:  0.039419879392050876
Bond Position:  [0.94539864]


portfolio before change:  [4.8902074]
curr_Stock_Price:  100.06856029546407
curr_Factors:  [100.0685603]
mat_Sqrt:  [[0.15]]
grads:  [0.02977429]
Stock Position:  0.029774288532027487
Bond Position:  [1.91073721]


portfolio before change:  [4.89888505]
curr_Stock_Price:  100.35198611414971
curr_Factors:  [100.35198611]
mat_Sqrt:  [[0.15]]
grads:  [0.06152992]
Stock Position:  0.06152992033444571
Bond Position:  [-1.27576466]


portfolio before change:  [4.83135067]
curr_Stock_Price:  99.25699200203577
curr_Factors:  [99.256992]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525211]
Stock Position:  -0.015252105105279674
Bond Position:  [6.34522875]


portfolio before change:  [4.84973312]
curr_Stock_Price:  98.10375820286937
curr_Factors:  [98.1037582]
mat_Sqrt:  [[0.15]]
grads:  [-0.15272578]
Stock Position:  -0.15272577540793078
Bond Position:  [19.83270566]


portfolio before change:  [5.01370954]
curr_Stock_Price:  97.04632582782956
curr_Factors:  [97.04632583]
mat_Sqrt:  [[0.15]]
grads:  [-0.21187138]
Stock Position:  -0.21187137789803182
Bond Position:  [25.57504832]


portfolio before change:  [4.98058401]
curr_Stock_Price:  97.21776289858093
curr_Factors:  [97.2177629]
mat_Sqrt:  [[0.15]]
grads:  [-0.29115177]
Stock Position:  -0.29115176626854006
Bond Position:  [33.2857074]


portfolio before change:  [5.06191754]
curr_Stock_Price:  96.95270336023718
curr_Factors:  [96.95270336]
mat_Sqrt:  [[0.15]]
grads:  [0.09798181]
Stock Position:  0.09798180769866306
Bond Position:  [-4.4376836]


portfolio before change:  [5.05862562]
curr_Stock_Price:  96.92476785233714
curr_Factors:  [96.92476785]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283845]
Stock Position:  -0.042838445682902085
Bond Position:  [9.21073203]


portfolio before change:  [5.04233665]
curr_Stock_Price:  97.33188792602103
curr_Factors:  [97.33188793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041214]
Stock Position:  -0.000412139438949252
Bond Position:  [5.08245096]


portfolio before change:  [5.04292373]
curr_Stock_Price:  97.4490005922517
curr_Factors:  [97.44900059]
mat_Sqrt:  [[0.15]]
grads:  [-0.04482658]
Stock Position:  -0.04482658398751549
Bond Position:  [9.41122954]


portfolio before change:  [5.02417535]
curr_Stock_Price:  97.89348813444425
curr_Factors:  [97.89348813]
mat_Sqrt:  [[0.15]]
grads:  [0.04854171]
Stock Position:  0.048541711268485166
Bond Position:  [0.27225791]


portfolio before change:  [5.03603934]
curr_Stock_Price:  98.13719528796769
curr_Factors:  [98.13719529]
mat_Sqrt:  [[0.15]]
grads:  [0.09276034]
Stock Position:  0.0927603410032044
Bond Position:  [-4.06720036]


portfolio before change:  [4.91162675]
curr_Stock_Price:  96.80145028491823
curr_Factors:  [96.80145028]
mat_Sqrt:  [[0.15]]
grads:  [0.00641018]
Stock Position:  0.006410182910605523
Bond Position:  [4.29111175]


portfolio before change:  [4.91369446]
curr_Stock_Price:  97.04033441345821
curr_Factors:  [97.04033441]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354727]
Stock Position:  -0.003547268761978032
Bond Position:  [5.25792261]


portfolio before change:  [4.91728111]
curr_Stock_Price:  96.21452536608402
curr_Factors:  [96.21452537]
mat_Sqrt:  [[0.15]]
grads:  [-0.04873201]
Stock Position:  -0.048732012366967434
Bond Position:  [9.60600855]


portfolio before change:  [4.94054816]
curr_Stock_Price:  95.7617178297135
curr_Factors:  [95.76171783]
mat_Sqrt:  [[0.15]]
grads:  [0.13567805]
Stock Position:  0.1356780523544141
Bond Position:  [-8.05221521]


portfolio before change:  [4.83903175]
curr_Stock_Price:  95.02092138812552
curr_Factors:  [95.02092139]
mat_Sqrt:  [[0.15]]
grads:  [-0.2157011]
Stock Position:  -0.21570109529629827
Bond Position:  [25.33514857]


portfolio before change:  [4.86758177]
curr_Stock_Price:  94.90324500354477
curr_Factors:  [94.903245]
mat_Sqrt:  [[0.15]]
grads:  [0.00954706]
Stock Position:  0.00954705935050374
Bond Position:  [3.96153485]


portfolio before change:  [4.86481903]
curr_Stock_Price:  94.56199267026999
curr_Factors:  [94.56199267]
mat_Sqrt:  [[0.15]]
grads:  [0.04747345]
Stock Position:  0.04747345478262645
Bond Position:  [0.37563455]


portfolio before change:  [4.88363247]
curr_Stock_Price:  94.95729739689861
curr_Factors:  [94.9572974]
mat_Sqrt:  [[0.15]]
grads:  [0.17125349]
Stock Position:  0.17125348752280387
Bond Position:  [-11.37813587]


portfolio before change:  [4.96044817]
curr_Stock_Price:  95.41415262706788
curr_Factors:  [95.41415263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01086182]
Stock Position:  -0.010861819765801724
Bond Position:  [5.9968195]


portfolio before change:  [4.96891679]
curr_Stock_Price:  94.70350030371672
curr_Factors:  [94.7035003]
mat_Sqrt:  [[0.15]]
grads:  [0.18917155]
Stock Position:  0.18917155433328237
Bond Position:  [-12.94629156]


portfolio before change:  [4.94478516]
curr_Stock_Price:  94.58449060492768
curr_Factors:  [94.5844906]
mat_Sqrt:  [[0.15]]
grads:  [0.00630696]
Stock Position:  0.006306955657707723
Bond Position:  [4.34824497]


portfolio before change:  [4.94613895]
curr_Stock_Price:  94.71295714404812
curr_Factors:  [94.71295714]
mat_Sqrt:  [[0.15]]
grads:  [0.07663816]
Stock Position:  0.07663816381318896
Bond Position:  [-2.31248817]


portfolio before change:  [4.87222011]
curr_Stock_Price:  93.75221170007121
curr_Factors:  [93.7522117]
mat_Sqrt:  [[0.15]]
grads:  [0.1075508]
Stock Position:  0.1075508045687628
Bond Position:  [-5.21090569]


portfolio before change:  [4.79164191]
curr_Stock_Price:  93.00905787288741
curr_Factors:  [93.00905787]
mat_Sqrt:  [[0.15]]
grads:  [0.23389923]
Stock Position:  0.23389922862875223
Bond Position:  [-16.96310498]


portfolio before change:  [4.72088172]
curr_Stock_Price:  92.71559955665181
curr_Factors:  [92.71559956]
mat_Sqrt:  [[0.15]]
grads:  [-0.18495004]
Stock Position:  -0.18495003765265913
Bond Position:  [21.86863535]


portfolio before change:  [4.74409972]
curr_Stock_Price:  92.60484397618747
curr_Factors:  [92.60484398]
mat_Sqrt:  [[0.15]]
grads:  [-0.3144304]
Stock Position:  -0.3144303977059837
Bond Position:  [33.86187764]


portfolio before change:  [4.6037077]
curr_Stock_Price:  93.06480274716085
curr_Factors:  [93.06480275]
mat_Sqrt:  [[0.15]]
grads:  [0.01831786]
Stock Position:  0.0183178617318593
Bond Position:  [2.89895951]


portfolio before change:  [4.59428386]
curr_Stock_Price:  92.5305574640993
curr_Factors:  [92.53055746]
mat_Sqrt:  [[0.15]]
grads:  [-0.02968402]
Stock Position:  -0.02968401877610517
Bond Position:  [7.34096266]


portfolio before change:  [4.62001258]
curr_Stock_Price:  91.6947189416041
curr_Factors:  [91.69471894]
mat_Sqrt:  [[0.15]]
grads:  [0.03728227]
Stock Position:  0.0372822680684744
Bond Position:  [1.20142549]


portfolio before change:  [4.5902334]
curr_Stock_Price:  90.89194126094146
curr_Factors:  [90.89194126]
mat_Sqrt:  [[0.15]]
grads:  [0.16290966]
Stock Position:  0.16290965927230905
Bond Position:  [-10.21694178]


portfolio before change:  [4.58253954]
curr_Stock_Price:  90.85255343255069
curr_Factors:  [90.85255343]
mat_Sqrt:  [[0.15]]
grads:  [-0.11310913]
Stock Position:  -0.11310912808002968
Bond Position:  [14.85879264]


portfolio before change:  [4.58942355]
curr_Stock_Price:  90.80811366643124
curr_Factors:  [90.80811367]
mat_Sqrt:  [[0.15]]
grads:  [0.04106208]
Stock Position:  0.041062078710951674
Bond Position:  [0.86065364]


portfolio before change:  [4.56597486]
curr_Stock_Price:  90.23443901748294
curr_Factors:  [90.23443902]
mat_Sqrt:  [[0.15]]
grads:  [0.01635852]
Stock Position:  0.01635851988321824
Bond Position:  [3.089873]


portfolio before change:  [4.57068065]
curr_Stock_Price:  90.49849263617955
curr_Factors:  [90.49849264]
mat_Sqrt:  [[0.15]]
grads:  [0.07651394]
Stock Position:  0.07651394287320248
Bond Position:  [-2.35371585]


portfolio before change:  [4.55228912]
curr_Stock_Price:  90.26196972880199
curr_Factors:  [90.26196973]
mat_Sqrt:  [[0.15]]
grads:  [0.0383826]
Stock Position:  0.038382600860443275
Bond Position:  [1.08779996]


portfolio before change:  [4.56000986]
curr_Stock_Price:  90.45957912538688
curr_Factors:  [90.45957913]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.56000986]
Stock Price:  91.79332770858258
PL:  [4.56000986]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.49896166e-03]
 [-1.19618486e-02]
 [-2.65363248e-02]
 [ 8.16754086e-03]
 [-4.24478339e-02]
 [-2.99592653e-02]
 [-4.58403632e-02]
 [ 2.30847389e-02]
 [-5.92632302e-03]
 [ 4.42889582e-03]
 [-7.15133686e-03]
 [ 7.52360653e-03]
 [ 1.38706090e-02]
 [-2.59426927e-03]
 [-1.17853245e-02]
 [-1.41033253e-02]
 [ 2.55203104e-02]
 [-5.50195479e-02]
 [ 1.27114846e-03]
 [ 7.12369392e-03]
 [ 2.26770327e-02]
 [-1.72123580e-03]
 [ 2.70836052e-02]
 [ 3.93866177e-03]
 [ 1.48579190e-02]
 [-1.06813682e-02]
 [ 1.61421027e-02]
 [-1.08426360e-02]
 [-1.72038330e-02]
 [-2.74249819e-03]
 [-2.99350647e-03]
 [ 5.33325002e-03]
 [ 5.10945828e-03]
 [-7.95312475e-03]
 [ 1.74269353e-02]
 [ 5.42549515e-03]
 [-2.53234927e-03]
 [ 9.05851906e-03]
 [-1.52524624e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.35578467]
curr_Stock_Price:  99.6575844962944
curr_Factors:  [99.6575845]
mat_Sqrt:  [[0.15]]
grads:  [0.02332641]
Stock Position:  0.023326411033823474
Bond Position:  [-5.68043845]


portfolio before change:  [-3.3824305]
curr_Stock_Price:  98.5457231397303
curr_Factors:  [98.54572314]
mat_Sqrt:  [[0.15]]
grads:  [-0.07974566]
Stock Position:  -0.07974565757312013
Bond Position:  [4.47616299]


portfolio before change:  [-3.30004832]
curr_Stock_Price:  97.51967819980202
curr_Factors:  [97.5196782]
mat_Sqrt:  [[0.15]]
grads:  [-0.17690883]
Stock Position:  -0.17690883225060813
Bond Position:  [13.95204407]


portfolio before change:  [-3.24434558]
curr_Stock_Price:  97.21467012183962
curr_Factors:  [97.21467012]
mat_Sqrt:  [[0.15]]
grads:  [0.05445027]
Stock Position:  0.05445027237930958
Bond Position:  [-8.53771085]


portfolio before change:  [-3.22944212]
curr_Stock_Price:  97.50797889408615
curr_Factors:  [97.50797889]
mat_Sqrt:  [[0.15]]
grads:  [-0.28298556]
Stock Position:  -0.2829855595502952
Bond Position:  [24.36390785]


portfolio before change:  [-3.20122087]
curr_Stock_Price:  97.41901474653962
curr_Factors:  [97.41901475]
mat_Sqrt:  [[0.15]]
grads:  [-0.19972844]
Stock Position:  -0.1997284356653807
Bond Position:  [16.25612655]


portfolio before change:  [-3.42003755]
curr_Stock_Price:  98.52476025266732
curr_Factors:  [98.52476025]
mat_Sqrt:  [[0.15]]
grads:  [-0.30560242]
Stock Position:  -0.3056024213266742
Bond Position:  [26.68936774]


portfolio before change:  [-3.76837869]
curr_Stock_Price:  99.67552834788575
curr_Factors:  [99.67552835]
mat_Sqrt:  [[0.15]]
grads:  [0.15389826]
Stock Position:  0.1538982590703127
Bond Position:  [-19.10826897]


portfolio before change:  [-3.7458711]
curr_Stock_Price:  99.83729929285069
curr_Factors:  [99.83729929]
mat_Sqrt:  [[0.15]]
grads:  [-0.03950882]
Stock Position:  -0.039508820166302985
Bond Position:  [0.1985828]


portfolio before change:  [-3.73249866]
curr_Stock_Price:  99.4994604438312
curr_Factors:  [99.49946044]
mat_Sqrt:  [[0.15]]
grads:  [0.02952597]
Stock Position:  0.029525972148618445
Bond Position:  [-6.67031696]


portfolio before change:  [-3.79627679]
curr_Stock_Price:  97.36763262820949
curr_Factors:  [97.36763263]
mat_Sqrt:  [[0.15]]
grads:  [-0.04767558]
Stock Position:  -0.047675579084766564
Bond Position:  [0.84578148]


portfolio before change:  [-3.77420899]
curr_Stock_Price:  96.90697585677054
curr_Factors:  [96.90697586]
mat_Sqrt:  [[0.15]]
grads:  [0.05015738]
Stock Position:  0.050157376883376736
Bond Position:  [-8.6348087]


portfolio before change:  [-3.86129417]
curr_Stock_Price:  95.19225774723064
curr_Factors:  [95.19225775]
mat_Sqrt:  [[0.15]]
grads:  [0.09247073]
Stock Position:  0.09247072670900777
Bond Position:  [-12.66379142]


portfolio before change:  [-3.90887661]
curr_Stock_Price:  94.69480978843616
curr_Factors:  [94.69480979]
mat_Sqrt:  [[0.15]]
grads:  [-0.01729513]
Stock Position:  -0.017295128464822753
Bond Position:  [-2.27111771]


portfolio before change:  [-3.90159497]
curr_Stock_Price:  94.25737172312351
curr_Factors:  [94.25737172]
mat_Sqrt:  [[0.15]]
grads:  [-0.07856883]
Stock Position:  -0.07856883029184303
Bond Position:  [3.50409647]


portfolio before change:  [-3.81887391]
curr_Stock_Price:  93.21009853742899
curr_Factors:  [93.21009854]
mat_Sqrt:  [[0.15]]
grads:  [-0.09402217]
Stock Position:  -0.09402216845391542
Bond Position:  [4.94494168]


portfolio before change:  [-3.86460661]
curr_Stock_Price:  93.70307651999393
curr_Factors:  [93.70307652]
mat_Sqrt:  [[0.15]]
grads:  [0.1701354]
Stock Position:  0.17013540240041602
Bond Position:  [-19.80681724]


portfolio before change:  [-3.97796393]
curr_Stock_Price:  93.0513525774317
curr_Factors:  [93.05135258]
mat_Sqrt:  [[0.15]]
grads:  [-0.36679699]
Stock Position:  -0.36679698616442513
Bond Position:  [30.15299175]


portfolio before change:  [-4.61286522]
curr_Stock_Price:  94.79256277776513
curr_Factors:  [94.79256278]
mat_Sqrt:  [[0.15]]
grads:  [0.00847432]
Stock Position:  0.00847432304781473
Bond Position:  [-5.41616802]


portfolio before change:  [-4.61550222]
curr_Stock_Price:  94.5612836415718
curr_Factors:  [94.56128364]
mat_Sqrt:  [[0.15]]
grads:  [0.04749129]
Stock Position:  0.04749129280443079
Bond Position:  [-9.10633983]


portfolio before change:  [-4.53936687]
curr_Stock_Price:  96.18839701251746
curr_Factors:  [96.18839701]
mat_Sqrt:  [[0.15]]
grads:  [0.15118022]
Stock Position:  0.1511802179473196
Bond Position:  [-19.08114969]


portfolio before change:  [-4.65328297]
curr_Stock_Price:  95.45066284879573
curr_Factors:  [95.45066285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01147491]
Stock Position:  -0.011474905316341811
Bond Position:  [-3.55799565]


portfolio before change:  [-4.65025327]
curr_Stock_Price:  95.14787300942703
curr_Factors:  [95.14787301]
mat_Sqrt:  [[0.15]]
grads:  [0.18055737]
Stock Position:  0.18055736794754415
Bond Position:  [-21.82990278]


portfolio before change:  [-4.42598034]
curr_Stock_Price:  96.40510134191047
curr_Factors:  [96.40510134]
mat_Sqrt:  [[0.15]]
grads:  [0.02625775]
Stock Position:  0.026257745126669566
Bond Position:  [-6.95736091]


portfolio before change:  [-4.42764802]
curr_Stock_Price:  96.37471179474686
curr_Factors:  [96.37471179]
mat_Sqrt:  [[0.15]]
grads:  [0.09905279]
Stock Position:  0.09905279302728302
Bond Position:  [-13.9738324]


portfolio before change:  [-4.32957739]
curr_Stock_Price:  97.38243170145635
curr_Factors:  [97.3824317]
mat_Sqrt:  [[0.15]]
grads:  [-0.07120912]
Stock Position:  -0.07120912161265813
Bond Position:  [2.60494003]


portfolio before change:  [-4.37059533]
curr_Stock_Price:  97.96302564696592
curr_Factors:  [97.96302565]
mat_Sqrt:  [[0.15]]
grads:  [0.10761402]
Stock Position:  0.10761401768373834
Bond Position:  [-14.91279011]


portfolio before change:  [-4.27645504]
curr_Stock_Price:  98.85514467712422
curr_Factors:  [98.85514468]
mat_Sqrt:  [[0.15]]
grads:  [-0.07228424]
Stock Position:  -0.07228424014421529
Bond Position:  [2.86921398]


portfolio before change:  [-4.24323603]
curr_Stock_Price:  98.40054589194752
curr_Factors:  [98.40054589]
mat_Sqrt:  [[0.15]]
grads:  [-0.11469222]
Stock Position:  -0.1146922197248399
Bond Position:  [7.042541]


portfolio before change:  [-4.26467993]
curr_Stock_Price:  98.59519093643341
curr_Factors:  [98.59519094]
mat_Sqrt:  [[0.15]]
grads:  [-0.01828332]
Stock Position:  -0.018283321240633723
Bond Position:  [-2.46203239]


portfolio before change:  [-4.28904803]
curr_Stock_Price:  99.9111618659222
curr_Factors:  [99.91116187]
mat_Sqrt:  [[0.15]]
grads:  [-0.01995671]
Stock Position:  -0.019956709787911333
Bond Position:  [-2.29514996]


portfolio before change:  [-4.29727978]
curr_Stock_Price:  100.30926575891918
curr_Factors:  [100.30926576]
mat_Sqrt:  [[0.15]]
grads:  [0.035555]
Stock Position:  0.03555500015628133
Bond Position:  [-7.86377574]


portfolio before change:  [-4.27175795]
curr_Stock_Price:  101.05472674577648
curr_Factors:  [101.05472675]
mat_Sqrt:  [[0.15]]
grads:  [0.03406306]
Stock Position:  0.03406305522888254
Bond Position:  [-7.71399069]


portfolio before change:  [-4.26161365]
curr_Stock_Price:  101.38084564178682
curr_Factors:  [101.38084564]
mat_Sqrt:  [[0.15]]
grads:  [-0.05302083]
Stock Position:  -0.053020831675623825
Bond Position:  [1.1136831]


portfolio before change:  [-4.2975908]
curr_Stock_Price:  102.06201873465753
curr_Factors:  [102.06201873]
mat_Sqrt:  [[0.15]]
grads:  [0.11617957]
Stock Position:  0.11617956879534037
Bond Position:  [-16.15511213]


portfolio before change:  [-4.26505979]
curr_Stock_Price:  102.35940769164583
curr_Factors:  [102.35940769]
mat_Sqrt:  [[0.15]]
grads:  [0.03616997]
Stock Position:  0.03616996769050726
Bond Position:  [-7.96739626]


portfolio before change:  [-4.26546502]
curr_Stock_Price:  102.37574047782715
curr_Factors:  [102.37574048]
mat_Sqrt:  [[0.15]]
grads:  [-0.01688233]
Stock Position:  -0.01688232846942904
Bond Position:  [-2.53712414]


portfolio before change:  [-4.27386111]
curr_Stock_Price:  102.85428360338342
curr_Factors:  [102.8542836]
mat_Sqrt:  [[0.15]]
grads:  [0.06039013]
Stock Position:  0.060390127044716316
Bond Position:  [-10.48524436]


portfolio before change:  [-4.24801879]
curr_Stock_Price:  103.30391091142195
curr_Factors:  [103.30391091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.24801879]
Stock Price:  104.04413480293702
PL:  [-8.2921536]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.30255915e-03]
 [ 2.52879222e-03]
 [ 6.84655205e-03]
 [-2.86085907e-03]
 [ 1.53582963e-02]
 [ 2.68218061e-02]
 [ 9.88463343e-03]
 [ 1.43721382e-03]
 [-1.14363986e-02]
 [-1.85128800e-03]
 [ 2.26303685e-02]
 [ 8.67142882e-03]
 [ 3.53958803e-03]
 [-4.44246757e-03]
 [ 7.53129544e-03]
 [ 2.66451392e-03]
 [ 8.91606906e-03]
 [ 1.21965463e-02]
 [ 1.14185045e-02]
 [-1.29535820e-02]
 [-1.67486683e-02]
 [ 2.20006974e-02]
 [-1.12123748e-02]
 [ 5.39913055e-03]
 [-8.22289250e-03]
 [-7.31937178e-03]
 [-5.98325395e-04]
 [-1.14145358e-02]
 [-1.70146059e-02]
 [-9.40539691e-03]
 [-3.38062848e-03]
 [ 5.61685941e-03]
 [ 5.77105537e-03]
 [-1.08024720e-02]
 [ 1.60593982e-02]
 [ 5.71674900e-03]
 [ 2.77383254e-03]
 [ 8.09418578e-03]
 [-3.86651030e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.37711049]
curr_Stock_Price:  100.8660317449505
curr_Factors:  [100.86603174]
mat_Sqrt:  [[0.15]]
grads:  [0.04201706]
Stock Position:  0.04201706096971752
Bond Position:  [11.13901628]


portfolio before change:  [15.37827618]
curr_Stock_Price:  100.86063448135607
curr_Factors:  [100.86063448]
mat_Sqrt:  [[0.15]]
grads:  [0.01685861]
Stock Position:  0.016858614809039385
Bond Position:  [13.67790559]


portfolio before change:  [15.36485735]
curr_Stock_Price:  99.96324962024174
curr_Factors:  [99.96324962]
mat_Sqrt:  [[0.15]]
grads:  [0.04564368]
Stock Position:  0.045643680302488755
Bond Position:  [10.80216675]


portfolio before change:  [15.36948109]
curr_Stock_Price:  100.03496565345064
curr_Factors:  [100.03496565]
mat_Sqrt:  [[0.15]]
grads:  [-0.01907239]
Stock Position:  -0.01907239381831861
Bond Position:  [17.27738735]


portfolio before change:  [15.35948923]
curr_Stock_Price:  100.6720996150321
curr_Factors:  [100.67209962]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [5.05180966]


portfolio before change:  [15.47584762]
curr_Stock_Price:  101.80237021677061
curr_Factors:  [101.80237022]
mat_Sqrt:  [[0.15]]
grads:  [0.17881204]
Stock Position:  0.17881204037817264
Bond Position:  [-2.72764191]


portfolio before change:  [15.51835297]
curr_Stock_Price:  102.04198677542193
curr_Factors:  [102.04198678]
mat_Sqrt:  [[0.15]]
grads:  [0.06589756]
Stock Position:  0.06589755622276999
Bond Position:  [8.79403541]


portfolio before change:  [15.61644006]
curr_Stock_Price:  103.51378282837311
curr_Factors:  [103.51378283]
mat_Sqrt:  [[0.15]]
grads:  [0.00958143]
Stock Position:  0.009581425441048109
Bond Position:  [14.62463046]


portfolio before change:  [15.62107946]
curr_Stock_Price:  103.80718486221173
curr_Factors:  [103.80718486]
mat_Sqrt:  [[0.15]]
grads:  [-0.07624266]
Stock Position:  -0.0762426575170049
Bond Position:  [23.5356151]


portfolio before change:  [15.59906224]
curr_Stock_Price:  104.13455216680983
curr_Factors:  [104.13455217]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234192]
Stock Position:  -0.012341919968683073
Bond Position:  [16.88428255]


portfolio before change:  [15.60282993]
curr_Stock_Price:  104.00029289633821
curr_Factors:  [104.0002929]
mat_Sqrt:  [[0.15]]
grads:  [0.15086912]
Stock Position:  0.15086912337308092
Bond Position:  [-0.08760309]


portfolio before change:  [15.60294036]
curr_Stock_Price:  104.00109748463225
curr_Factors:  [104.00109748]
mat_Sqrt:  [[0.15]]
grads:  [0.05780953]
Stock Position:  0.05780952544658591
Bond Position:  [9.59068627]


portfolio before change:  [15.58233123]
curr_Stock_Price:  103.62385780606402
curr_Factors:  [103.62385781]
mat_Sqrt:  [[0.15]]
grads:  [0.02359725]
Stock Position:  0.023597253552601144
Bond Position:  [13.13709278]


portfolio before change:  [15.57169096]
curr_Stock_Price:  103.1033519963818
curr_Factors:  [103.103352]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961645]
Stock Position:  -0.0296164504796174
Bond Position:  [18.62524628]


portfolio before change:  [15.57301066]
curr_Stock_Price:  103.1374074308032
curr_Factors:  [103.13740743]
mat_Sqrt:  [[0.15]]
grads:  [0.05020864]
Stock Position:  0.05020863627502088
Bond Position:  [10.39462208]


portfolio before change:  [15.57583163]
curr_Stock_Price:  103.16771231266898
curr_Factors:  [103.16771231]
mat_Sqrt:  [[0.15]]
grads:  [0.01776343]
Stock Position:  0.01776342610204109
Bond Position:  [13.7432196]


portfolio before change:  [15.55047409]
curr_Stock_Price:  101.64348211310468
curr_Factors:  [101.64348211]
mat_Sqrt:  [[0.15]]
grads:  [0.05944046]
Stock Position:  0.05944046041961245
Bond Position:  [9.50873872]


portfolio before change:  [15.56900749]
curr_Stock_Price:  101.93528222875247
curr_Factors:  [101.93528223]
mat_Sqrt:  [[0.15]]
grads:  [0.08131031]
Stock Position:  0.08131030884015371
Bond Position:  [7.28061821]


portfolio before change:  [15.46926833]
curr_Stock_Price:  100.69744041036473
curr_Factors:  [100.69744041]
mat_Sqrt:  [[0.15]]
grads:  [0.07612336]
Stock Position:  0.07612336316928944
Bond Position:  [7.8038405]


portfolio before change:  [15.48561147]
curr_Stock_Price:  100.89931808462508
curr_Factors:  [100.89931808]
mat_Sqrt:  [[0.15]]
grads:  [-0.08635721]
Stock Position:  -0.0863572135562202
Bond Position:  [24.19899543]


portfolio before change:  [15.48693355]
curr_Stock_Price:  100.91903835735185
curr_Factors:  [100.91903836]
mat_Sqrt:  [[0.15]]
grads:  [-0.11165779]
Stock Position:  -0.11165778893254923
Bond Position:  [26.75533023]


portfolio before change:  [15.3933381]
curr_Stock_Price:  101.78722748660631
curr_Factors:  [101.78722749]
mat_Sqrt:  [[0.15]]
grads:  [0.14667132]
Stock Position:  0.14667131615529597
Bond Position:  [0.46407147]


portfolio before change:  [15.24560121]
curr_Stock_Price:  100.77956692172407
curr_Factors:  [100.77956692]
mat_Sqrt:  [[0.15]]
grads:  [-0.07474917]
Stock Position:  -0.07474916524994385
Bond Position:  [22.77878971]


portfolio before change:  [15.1844909]
curr_Stock_Price:  101.63519971698075
curr_Factors:  [101.63519972]
mat_Sqrt:  [[0.15]]
grads:  [0.0359942]
Stock Position:  0.03599420365593583
Bond Position:  [11.52621282]


portfolio before change:  [15.17475894]
curr_Stock_Price:  101.32479340524398
curr_Factors:  [101.32479341]
mat_Sqrt:  [[0.15]]
grads:  [-0.05481928]
Stock Position:  -0.054819283321028214
Bond Position:  [20.72931149]


portfolio before change:  [15.19227602]
curr_Stock_Price:  101.05252133368857
curr_Factors:  [101.05252133]
mat_Sqrt:  [[0.15]]
grads:  [-0.04879581]
Stock Position:  -0.04879581184280965
Bond Position:  [20.12321584]


portfolio before change:  [15.17566819]
curr_Stock_Price:  101.44442769740792
curr_Factors:  [101.4444277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00398884]
Stock Position:  -0.00398883596679872
Bond Position:  [15.58031337]


portfolio before change:  [15.18161924]
curr_Stock_Price:  100.44078059596873
curr_Factors:  [100.4407806]
mat_Sqrt:  [[0.15]]
grads:  [-0.07609691]
Stock Position:  -0.07609690560260397
Bond Position:  [22.82485184]


portfolio before change:  [15.18194277]
curr_Stock_Price:  100.4740243918753
curr_Factors:  [100.47402439]
mat_Sqrt:  [[0.15]]
grads:  [-0.11343071]
Stock Position:  -0.11343070599683722
Bond Position:  [26.57878229]


portfolio before change:  [15.11394814]
curr_Stock_Price:  101.10275346977862
curr_Factors:  [101.10275347]
mat_Sqrt:  [[0.15]]
grads:  [-0.06270265]
Stock Position:  -0.06270264607546043
Bond Position:  [21.45335831]


portfolio before change:  [15.2274945]
curr_Stock_Price:  99.33465391101834
curr_Factors:  [99.33465391]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253752]
Stock Position:  -0.02253752317592187
Bond Position:  [17.46625157]


portfolio before change:  [15.23604918]
curr_Stock_Price:  99.05195835445275
curr_Factors:  [99.05195835]
mat_Sqrt:  [[0.15]]
grads:  [0.03744573]
Stock Position:  0.037445729370991075
Bond Position:  [11.52697635]


portfolio before change:  [15.25919719]
curr_Stock_Price:  99.63165206370681
curr_Factors:  [99.63165206]
mat_Sqrt:  [[0.15]]
grads:  [0.0384737]
Stock Position:  0.03847370244195692
Bond Position:  [11.42599866]


portfolio before change:  [15.29633018]
curr_Stock_Price:  100.55967943438655
curr_Factors:  [100.55967943]
mat_Sqrt:  [[0.15]]
grads:  [-0.07201648]
Stock Position:  -0.07201648022123186
Bond Position:  [22.53828435]


portfolio before change:  [15.36339293]
curr_Stock_Price:  99.6675880106096
curr_Factors:  [99.66758801]
mat_Sqrt:  [[0.15]]
grads:  [0.10706265]
Stock Position:  0.1070626544169962
Bond Position:  [4.6927164]


portfolio before change:  [15.31585377]
curr_Stock_Price:  99.21807756578147
curr_Factors:  [99.21807757]
mat_Sqrt:  [[0.15]]
grads:  [0.03811166]
Stock Position:  0.038111659988076106
Bond Position:  [11.53448814]


portfolio before change:  [15.32648917]
curr_Stock_Price:  99.45930289871555
curr_Factors:  [99.4593029]
mat_Sqrt:  [[0.15]]
grads:  [0.01849222]
Stock Position:  0.018492216910032604
Bond Position:  [13.48726617]


portfolio before change:  [15.34253796]
curr_Stock_Price:  100.23599577091946
curr_Factors:  [100.23599577]
mat_Sqrt:  [[0.15]]
grads:  [0.05396124]
Stock Position:  0.05396123850321736
Bond Position:  [9.93367948]


portfolio before change:  [15.31552842]
curr_Stock_Price:  99.71244731397603
curr_Factors:  [99.71244731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.31552842]
Stock Price:  100.41262376664336
PL:  [14.90290466]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.33699769e-03]
 [ 4.40807312e-03]
 [ 5.00186824e-03]
 [-2.58212745e-03]
 [ 1.24737124e-02]
 [ 1.15604700e-02]
 [-4.19552951e-03]
 [ 2.26893667e-02]
 [-5.93630987e-03]
 [ 5.87661918e-04]
 [ 6.93196605e-03]
 [ 5.55154523e-03]
 [ 1.18205376e-02]
 [-2.47132767e-03]
 [ 1.68352907e-02]
 [-4.59580808e-04]
 [ 9.56479217e-03]
 [ 1.40678823e-02]
 [ 1.12050041e-02]
 [-1.24557092e-02]
 [-1.05812534e-02]
 [ 2.68908325e-02]
 [-3.14044692e-02]
 [ 7.60743425e-03]
 [ 7.37572314e-03]
 [-1.84750145e-02]
 [-3.37902337e-05]
 [-1.10345287e-02]
 [ 6.03342036e-02]
 [-3.86239146e-03]
 [-8.82194345e-03]
 [ 4.44669723e-03]
 [ 6.50687805e-03]
 [ 3.34004586e-03]
 [ 8.17457411e-03]
 [ 3.93622948e-03]
 [-3.67259621e-02]
 [ 9.96700294e-03]
 [-1.29557058e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.01116885]
curr_Stock_Price:  99.67981544513871
curr_Factors:  [99.67981545]
mat_Sqrt:  [[0.15]]
grads:  [0.02224665]
Stock Position:  0.022246651239128386
Bond Position:  [-5.22871094]


portfolio before change:  [-3.00369032]
curr_Stock_Price:  100.04536098691847
curr_Factors:  [100.04536099]
mat_Sqrt:  [[0.15]]
grads:  [0.02938715]
Stock Position:  0.029387154146746735
Bond Position:  [-5.94373876]


portfolio before change:  [-3.0176974]
curr_Stock_Price:  99.59400506432269
curr_Factors:  [99.59400506]
mat_Sqrt:  [[0.15]]
grads:  [0.03334579]
Stock Position:  0.033345788279062136
Bond Position:  [-6.33873801]


portfolio before change:  [-3.00972177]
curr_Stock_Price:  99.85694752660808
curr_Factors:  [99.85694753]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721418]
Stock Position:  -0.017214182992225952
Bond Position:  [-1.290766]


portfolio before change:  [-3.00905243]
curr_Stock_Price:  99.80869135147171
curr_Factors:  [99.80869135]
mat_Sqrt:  [[0.15]]
grads:  [0.08315808]
Stock Position:  0.08315808282918591
Bond Position:  [-11.30895185]


portfolio before change:  [-3.00831759]
curr_Stock_Price:  99.83452825707933
curr_Factors:  [99.83452826]
mat_Sqrt:  [[0.15]]
grads:  [0.0770698]
Stock Position:  0.07706979966714966
Bond Position:  [-10.70254468]


portfolio before change:  [-3.00473179]
curr_Stock_Price:  99.89841458492528
curr_Factors:  [99.89841458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0279702]
Stock Position:  -0.027970196737843574
Bond Position:  [-0.21055348]


portfolio before change:  [-3.00365573]
curr_Stock_Price:  99.85900206183162
curr_Factors:  [99.85900206]
mat_Sqrt:  [[0.15]]
grads:  [0.15126244]
Stock Position:  0.1512624447934944
Bond Position:  [-18.10857252]


portfolio before change:  [-2.99944894]
curr_Stock_Price:  99.90177874976294
curr_Factors:  [99.90177875]
mat_Sqrt:  [[0.15]]
grads:  [-0.0395754]
Stock Position:  -0.039575399143459714
Bond Position:  [0.95420383]


portfolio before change:  [-3.02462609]
curr_Stock_Price:  100.54097471222374
curr_Factors:  [100.54097471]
mat_Sqrt:  [[0.15]]
grads:  [0.00391775]
Stock Position:  0.0039177461194630885
Bond Position:  [-3.4185201]


portfolio before change:  [-3.02715544]
curr_Stock_Price:  100.00444035491593
curr_Factors:  [100.00444035]
mat_Sqrt:  [[0.15]]
grads:  [0.04621311]
Stock Position:  0.04621310702133272
Bond Position:  [-7.64867134]


portfolio before change:  [-3.05895615]
curr_Stock_Price:  99.33699846783448
curr_Factors:  [99.33699847]
mat_Sqrt:  [[0.15]]
grads:  [0.0370103]
Stock Position:  0.03701030153065392
Bond Position:  [-6.73544841]


portfolio before change:  [-2.99647488]
curr_Stock_Price:  101.04796122830831
curr_Factors:  [101.04796123]
mat_Sqrt:  [[0.15]]
grads:  [0.07880358]
Stock Position:  0.07880358409180005
Bond Position:  [-10.95941639]


portfolio before change:  [-2.99487943]
curr_Stock_Price:  101.08559232541059
curr_Factors:  [101.08559233]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647552]
Stock Position:  -0.016475517830973486
Bond Position:  [-1.32944195]


portfolio before change:  [-2.97608715]
curr_Stock_Price:  99.93488661744436
curr_Factors:  [99.93488662]
mat_Sqrt:  [[0.15]]
grads:  [0.11223527]
Stock Position:  0.11223527153232381
Bond Position:  [-14.19230628]


portfolio before change:  [-2.94361333]
curr_Stock_Price:  100.24003104617306
curr_Factors:  [100.24003105]
mat_Sqrt:  [[0.15]]
grads:  [-0.00306387]
Stock Position:  -0.0030638720508857284
Bond Position:  [-2.6364907]


portfolio before change:  [-2.94507979]
curr_Stock_Price:  100.61109125715652
curr_Factors:  [100.61109126]
mat_Sqrt:  [[0.15]]
grads:  [0.06376528]
Stock Position:  0.06376528111891858
Bond Position:  [-9.36057431]


portfolio before change:  [-2.91222665]
curr_Stock_Price:  101.1446619769764
curr_Factors:  [101.14466198]
mat_Sqrt:  [[0.15]]
grads:  [0.09378588]
Stock Position:  0.09378588229501579
Bond Position:  [-12.39816801]


portfolio before change:  [-3.06820183]
curr_Stock_Price:  99.49808885570727
curr_Factors:  [99.49808886]
mat_Sqrt:  [[0.15]]
grads:  [0.07470003]
Stock Position:  0.07470002722773504
Bond Position:  [-10.50071178]


portfolio before change:  [-2.99110956]
curr_Stock_Price:  100.54768608775395
curr_Factors:  [100.54768609]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303806]
Stock Position:  -0.08303806121378922
Bond Position:  [5.35817535]


portfolio before change:  [-3.09950664]
curr_Stock_Price:  101.8611427828819
curr_Factors:  [101.86114278]
mat_Sqrt:  [[0.15]]
grads:  [-0.07054169]
Stock Position:  -0.07054168941670338
Bond Position:  [4.08595046]


portfolio before change:  [-3.16852423]
curr_Stock_Price:  102.84677780109493
curr_Factors:  [102.8467778]
mat_Sqrt:  [[0.15]]
grads:  [0.17927222]
Stock Position:  0.17927221699228993
Bond Position:  [-21.60609409]


portfolio before change:  [-3.30102361]
curr_Stock_Price:  102.12274783058352
curr_Factors:  [102.12274783]
mat_Sqrt:  [[0.15]]
grads:  [-0.20936313]
Stock Position:  -0.2093631280784533
Bond Position:  [18.07971432]


portfolio before change:  [-3.65705888]
curr_Stock_Price:  103.83410632673933
curr_Factors:  [103.83410633]
mat_Sqrt:  [[0.15]]
grads:  [0.05071623]
Stock Position:  0.05071622832524119
Bond Position:  [-8.92313312]


portfolio before change:  [-3.6265302]
curr_Stock_Price:  104.45805139358744
curr_Factors:  [104.45805139]
mat_Sqrt:  [[0.15]]
grads:  [0.04917149]
Stock Position:  0.04917148760000404
Bond Position:  [-8.76288798]


portfolio before change:  [-3.57861608]
curr_Stock_Price:  105.45475796688288
curr_Factors:  [105.45475797]
mat_Sqrt:  [[0.15]]
grads:  [-0.12316676]
Stock Position:  -0.12316676358990464
Bond Position:  [9.40990516]


portfolio before change:  [-3.61081626]
curr_Stock_Price:  105.7257441127293
curr_Factors:  [105.72574411]
mat_Sqrt:  [[0.15]]
grads:  [-0.00022527]
Stock Position:  -0.00022526822466182326
Bond Position:  [-3.58699961]


portfolio before change:  [-3.61105023]
curr_Stock_Price:  104.77385703671379
curr_Factors:  [104.77385704]
mat_Sqrt:  [[0.15]]
grads:  [-0.07356352]
Stock Position:  -0.07356352440030006
Bond Position:  [4.09648396]


portfolio before change:  [-3.6490109]
curr_Stock_Price:  105.29684399871873
curr_Factors:  [105.296844]
mat_Sqrt:  [[0.15]]
grads:  [0.40222802]
Stock Position:  0.4022280238855422
Bond Position:  [-46.00235239]


portfolio before change:  [-3.75149645]
curr_Stock_Price:  105.05634635970377
curr_Factors:  [105.05634636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574928]
Stock Position:  -0.02574927639384875
Bond Position:  [-1.04637155]


portfolio before change:  [-3.76388967]
curr_Stock_Price:  105.53257023026576
curr_Factors:  [105.53257023]
mat_Sqrt:  [[0.15]]
grads:  [-0.05881296]
Stock Position:  -0.05881295634454348
Bond Position:  [2.44279278]


portfolio before change:  [-3.76224557]
curr_Stock_Price:  105.50980774150203
curr_Factors:  [105.50980774]
mat_Sqrt:  [[0.15]]
grads:  [0.02964465]
Stock Position:  0.029644648202898922
Bond Position:  [-6.89004671]


portfolio before change:  [-3.72072605]
curr_Stock_Price:  106.93943617303341
curr_Factors:  [106.93943617]
mat_Sqrt:  [[0.15]]
grads:  [0.04337919]
Stock Position:  0.04337918702116128
Bond Position:  [-8.35967185]


portfolio before change:  [-3.6899967]
curr_Stock_Price:  107.6719158687778
curr_Factors:  [107.67191587]
mat_Sqrt:  [[0.15]]
grads:  [0.02226697]
Stock Position:  0.02226697240278354
Bond Position:  [-6.08752428]


portfolio before change:  [-3.70095575]
curr_Stock_Price:  107.21392521608091
curr_Factors:  [107.21392522]
mat_Sqrt:  [[0.15]]
grads:  [0.05449716]
Stock Position:  0.05449716072486598
Bond Position:  [-9.54381027]


portfolio before change:  [-3.75144387]
curr_Stock_Price:  106.30938144693518
curr_Factors:  [106.30938145]
mat_Sqrt:  [[0.15]]
grads:  [0.02624153]
Stock Position:  0.02624152983821322
Bond Position:  [-6.54116468]


portfolio before change:  [-3.75823385]
curr_Stock_Price:  106.0817925642713
curr_Factors:  [106.08179256]
mat_Sqrt:  [[0.15]]
grads:  [-0.24483975]
Stock Position:  -0.2448397475416413
Bond Position:  [22.21480546]


portfolio before change:  [-3.51827093]
curr_Stock_Price:  105.11305322949303
curr_Factors:  [105.11305323]
mat_Sqrt:  [[0.15]]
grads:  [0.06644669]
Stock Position:  0.06644668626346244
Bond Position:  [-10.502685]


portfolio before change:  [-3.57918684]
curr_Stock_Price:  104.21604855280899
curr_Factors:  [104.21604855]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.57918684]
Stock Price:  103.31623945062738
PL:  [-6.89542629]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.76395280e-03]
 [ 2.35619960e-04]
 [ 1.39411322e-02]
 [ 3.99469160e-03]
 [-2.15091113e-03]
 [ 2.91350292e-02]
 [ 1.40048216e-02]
 [ 1.04451717e-02]
 [-6.08984764e-03]
 [ 1.06033081e-03]
 [ 5.20724291e-03]
 [ 4.02925934e-03]
 [ 1.21495686e-02]
 [ 2.92561293e-03]
 [ 2.44875195e-02]
 [ 1.53927122e-03]
 [ 9.84890097e-03]
 [ 1.35815155e-02]
 [ 1.16650178e-02]
 [-1.47074982e-02]
 [ 7.78461587e-03]
 [ 3.51398020e-02]
 [-2.20930362e-02]
 [ 7.36198080e-03]
 [ 7.35316812e-03]
 [-1.69150552e-02]
 [ 6.42939837e-06]
 [-1.31555782e-02]
 [ 6.31367755e-02]
 [-3.00272528e-03]
 [-1.07349956e-02]
 [ 4.44656648e-03]
 [ 5.86651190e-03]
 [-1.95576675e-03]
 [ 7.02627709e-03]
 [ 4.73450303e-03]
 [-2.79385771e-02]
 [ 9.78710614e-03]
 [-1.56825672e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.85192646]
curr_Stock_Price:  101.34822740761882
curr_Factors:  [101.34822741]
mat_Sqrt:  [[0.15]]
grads:  [0.05842635]
Stock Position:  0.05842635202945968
Bond Position:  [16.93051925]


portfolio before change:  [22.84789237]
curr_Stock_Price:  101.24295758221835
curr_Factors:  [101.24295758]
mat_Sqrt:  [[0.15]]
grads:  [0.0015708]
Stock Position:  0.0015707997305662003
Bond Position:  [22.68885996]


portfolio before change:  [22.852324]
curr_Stock_Price:  102.25857799664817
curr_Factors:  [102.258578]
mat_Sqrt:  [[0.15]]
grads:  [0.09294088]
Stock Position:  0.09294088155667878
Bond Position:  [13.34832161]


portfolio before change:  [22.79154652]
curr_Stock_Price:  101.5866871837652
curr_Factors:  [101.58668718]
mat_Sqrt:  [[0.15]]
grads:  [0.02663128]
Stock Position:  0.02663127732021017
Bond Position:  [20.08616328]


portfolio before change:  [22.82312894]
curr_Stock_Price:  102.67831693903354
curr_Factors:  [102.67831694]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433941]
Stock Position:  -0.01433940751699481
Bond Position:  [24.29547517]


portfolio before change:  [22.82996427]
curr_Stock_Price:  102.41343764930284
curr_Factors:  [102.41343765]
mat_Sqrt:  [[0.15]]
grads:  [0.19423353]
Stock Position:  0.1942335277328346
Bond Position:  [2.93784099]


portfolio before change:  [22.79989198]
curr_Stock_Price:  102.25672140797987
curr_Factors:  [102.25672141]
mat_Sqrt:  [[0.15]]
grads:  [0.09336548]
Stock Position:  0.09336547752515757
Bond Position:  [13.25264435]


portfolio before change:  [22.75832759]
curr_Stock_Price:  101.7937979462833
curr_Factors:  [101.79379795]
mat_Sqrt:  [[0.15]]
grads:  [0.06963448]
Stock Position:  0.06963447769762275
Bond Position:  [15.66996964]


portfolio before change:  [22.67414596]
curr_Stock_Price:  100.55675980860252
curr_Factors:  [100.55675981]
mat_Sqrt:  [[0.15]]
grads:  [-0.04059898]
Stock Position:  -0.04059898429232554
Bond Position:  [26.75664827]


portfolio before change:  [22.68501702]
curr_Stock_Price:  100.37137906254212
curr_Factors:  [100.37137906]
mat_Sqrt:  [[0.15]]
grads:  [0.00706887]
Stock Position:  0.007068872087899724
Bond Position:  [21.97550458]


portfolio before change:  [22.68325145]
curr_Stock_Price:  99.73299191835844
curr_Factors:  [99.73299192]
mat_Sqrt:  [[0.15]]
grads:  [0.03471495]
Stock Position:  0.034714952736832304
Bond Position:  [19.22102535]


portfolio before change:  [22.70945258]
curr_Stock_Price:  100.41852796063775
curr_Factors:  [100.41852796]
mat_Sqrt:  [[0.15]]
grads:  [0.02686173]
Stock Position:  0.026861728944691743
Bond Position:  [20.0120373]


portfolio before change:  [22.71755212]
curr_Stock_Price:  100.62692423603878
curr_Factors:  [100.62692424]
mat_Sqrt:  [[0.15]]
grads:  [0.08099712]
Stock Position:  0.08099712423324304
Bond Position:  [14.56706064]


portfolio before change:  [22.70276889]
curr_Stock_Price:  100.421926432665
curr_Factors:  [100.42192643]
mat_Sqrt:  [[0.15]]
grads:  [0.01950409]
Stock Position:  0.019504086225119132
Bond Position:  [20.74413098]


portfolio before change:  [22.71664391]
curr_Stock_Price:  101.00036133720198
curr_Factors:  [101.00036134]
mat_Sqrt:  [[0.15]]
grads:  [0.16325013]
Stock Position:  0.16325012974704234
Bond Position:  [6.22832182]


portfolio before change:  [22.75023424]
curr_Stock_Price:  101.20135194821961
curr_Factors:  [101.20135195]
mat_Sqrt:  [[0.15]]
grads:  [0.01026181]
Stock Position:  0.010261808106240304
Bond Position:  [21.71172539]


portfolio before change:  [22.75130332]
curr_Stock_Price:  101.04104278377892
curr_Factors:  [101.04104278]
mat_Sqrt:  [[0.15]]
grads:  [0.06565934]
Stock Position:  0.06565933980131115
Bond Position:  [16.11701515]


portfolio before change:  [22.7454843]
curr_Stock_Price:  100.92173349057552
curr_Factors:  [100.92173349]
mat_Sqrt:  [[0.15]]
grads:  [0.09054344]
Stock Position:  0.09054343652235684
Bond Position:  [13.60768373]


portfolio before change:  [22.78807084]
curr_Stock_Price:  101.3732899726864
curr_Factors:  [101.37328997]
mat_Sqrt:  [[0.15]]
grads:  [0.07776679]
Stock Position:  0.07776678510132669
Bond Position:  [14.90459599]


portfolio before change:  [22.88681021]
curr_Stock_Price:  102.61901688397009
curr_Factors:  [102.61901688]
mat_Sqrt:  [[0.15]]
grads:  [-0.09804999]
Stock Position:  -0.09804998792960594
Bond Position:  [32.94860358]


portfolio before change:  [22.70905147]
curr_Stock_Price:  104.47396428850078
curr_Factors:  [104.47396429]
mat_Sqrt:  [[0.15]]
grads:  [0.05189744]
Stock Position:  0.05189743910094715
Bond Position:  [17.28712027]


portfolio before change:  [22.70876863]
curr_Stock_Price:  104.42687392859666
curr_Factors:  [104.42687393]
mat_Sqrt:  [[0.15]]
grads:  [0.23426535]
Stock Position:  0.23426534682210384
Bond Position:  [-1.75482921]


portfolio before change:  [22.67738514]
curr_Stock_Price:  104.29384475877778
curr_Factors:  [104.29384476]
mat_Sqrt:  [[0.15]]
grads:  [-0.14728691]
Stock Position:  -0.14728690807356296
Bond Position:  [38.03850306]


portfolio before change:  [22.77277157]
curr_Stock_Price:  103.67850616147065
curr_Factors:  [103.67850616]
mat_Sqrt:  [[0.15]]
grads:  [0.04907987]
Stock Position:  0.049079872024554744
Bond Position:  [17.68424375]


portfolio before change:  [22.8073793]
curr_Stock_Price:  104.33859470114062
curr_Factors:  [104.3385947]
mat_Sqrt:  [[0.15]]
grads:  [0.04902112]
Stock Position:  0.04902112082055425
Bond Position:  [17.69258444]


portfolio before change:  [22.84562652]
curr_Stock_Price:  105.07369646885593
curr_Factors:  [105.07369647]
mat_Sqrt:  [[0.15]]
grads:  [-0.11276703]
Stock Position:  -0.1127670347467137
Bond Position:  [34.6944757]


portfolio before change:  [22.7708808]
curr_Stock_Price:  105.77499010850563
curr_Factors:  [105.77499011]
mat_Sqrt:  [[0.15]]
grads:  [4.28626558e-05]
Stock Position:  4.286265580759037e-05
Bond Position:  [22.766347]


portfolio before change:  [22.7737582]
curr_Stock_Price:  106.5084071344335
curr_Factors:  [106.50840713]
mat_Sqrt:  [[0.15]]
grads:  [-0.08770385]
Stock Position:  -0.08770385486791536
Bond Position:  [32.11495608]


portfolio before change:  [22.8359271]
curr_Stock_Price:  105.8453315923831
curr_Factors:  [105.84533159]
mat_Sqrt:  [[0.15]]
grads:  [0.42091184]
Stock Position:  0.42091183682173083
Bond Position:  [-21.71562583]


portfolio before change:  [22.79311132]
curr_Stock_Price:  105.75005948147046
curr_Factors:  [105.75005948]
mat_Sqrt:  [[0.15]]
grads:  [-0.02001817]
Stock Position:  -0.020018168557896638
Bond Position:  [24.91003384]


portfolio before change:  [22.78415576]
curr_Stock_Price:  106.3529872685514
curr_Factors:  [106.35298727]
mat_Sqrt:  [[0.15]]
grads:  [-0.07156664]
Stock Position:  -0.0715666375263564
Bond Position:  [30.39548145]


portfolio before change:  [22.84825224]
curr_Stock_Price:  105.51046050347553
curr_Factors:  [105.5104605]
mat_Sqrt:  [[0.15]]
grads:  [0.02964378]
Stock Position:  0.02964377652367929
Bond Position:  [19.72052373]


portfolio before change:  [22.83746401]
curr_Stock_Price:  105.06336987753023
curr_Factors:  [105.06336988]
mat_Sqrt:  [[0.15]]
grads:  [0.03911008]
Stock Position:  0.039110079337910844
Bond Position:  [18.72842728]


portfolio before change:  [22.84647991]
curr_Stock_Price:  105.2340343631314
curr_Factors:  [105.23403436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01303845]
Stock Position:  -0.013038445010533235
Bond Position:  [24.21856808]


portfolio before change:  [22.85536094]
curr_Stock_Price:  104.78509125548493
curr_Factors:  [104.78509126]
mat_Sqrt:  [[0.15]]
grads:  [0.04684185]
Stock Position:  0.046841847296035445
Bond Position:  [17.94703369]


portfolio before change:  [22.84779757]
curr_Stock_Price:  104.57572948424584
curr_Factors:  [104.57572948]
mat_Sqrt:  [[0.15]]
grads:  [0.03156335]
Stock Position:  0.031563353546906
Bond Position:  [19.54703684]


portfolio before change:  [22.87352062]
curr_Stock_Price:  105.31327845093718
curr_Factors:  [105.31327845]
mat_Sqrt:  [[0.15]]
grads:  [-0.18625718]
Stock Position:  -0.18625718087316778
Bond Position:  [42.48887497]


portfolio before change:  [23.16047375]
curr_Stock_Price:  103.8011665912774
curr_Factors:  [103.80116659]
mat_Sqrt:  [[0.15]]
grads:  [0.06524737]
Stock Position:  0.06524737424931193
Bond Position:  [16.38772019]


portfolio before change:  [23.11893265]
curr_Stock_Price:  103.13309841724451
curr_Factors:  [103.13309842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.11893265]
Stock Price:  102.98477219548556
PL:  [20.13416045]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.90398094e-03]
 [-8.01216172e-03]
 [-1.71505176e-03]
 [-2.11667923e-03]
 [-5.17225326e-03]
 [-7.10544205e-03]
 [-5.14382556e-02]
 [ 2.35992641e-02]
 [-5.93008893e-03]
 [ 1.60075655e-03]
 [ 1.00257931e-02]
 [ 4.86195167e-03]
 [ 8.95578682e-03]
 [-5.36970834e-03]
 [ 8.28147531e-03]
 [ 2.84194321e-03]
 [ 8.80471690e-03]
 [ 1.19276958e-02]
 [ 1.16619743e-02]
 [-1.45369567e-02]
 [-1.20082493e-02]
 [ 2.10076611e-02]
 [-2.15918674e-02]
 [ 6.11092601e-03]
 [-7.85457459e-03]
 [-6.57533071e-03]
 [ 2.20478789e-03]
 [-1.12532143e-02]
 [-1.80743528e-02]
 [-8.15064263e-03]
 [-3.28462707e-03]
 [ 5.33316308e-03]
 [ 5.51777567e-03]
 [-1.18835330e-02]
 [ 1.49486054e-02]
 [ 5.71579981e-03]
 [ 3.21676774e-03]
 [ 1.12696574e-02]
 [-2.45230628e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.82302224]
curr_Stock_Price:  98.72431212736987
curr_Factors:  [98.72431213]
mat_Sqrt:  [[0.15]]
grads:  [0.06602654]
Stock Position:  0.06602653962115139
Bond Position:  [-24.34144695]


portfolio before change:  [-17.80689189]
curr_Stock_Price:  99.01469876237886
curr_Factors:  [99.01469876]
mat_Sqrt:  [[0.15]]
grads:  [-0.05341441]
Stock Position:  -0.05341441144560376
Bond Position:  [-12.51808003]


portfolio before change:  [-17.82238479]
curr_Stock_Price:  99.27545327832625
curr_Factors:  [99.27545328]
mat_Sqrt:  [[0.15]]
grads:  [-0.01143368]
Stock Position:  -0.011433678385938149
Bond Position:  [-16.68730119]


portfolio before change:  [-17.82376167]
curr_Stock_Price:  99.21342892328515
curr_Factors:  [99.21342892]
mat_Sqrt:  [[0.15]]
grads:  [-0.01411119]
Stock Position:  -0.014111194887052066
Bond Position:  [-16.42374164]


portfolio before change:  [-17.81858369]
curr_Stock_Price:  98.70099355081837
curr_Factors:  [98.70099355]
mat_Sqrt:  [[0.15]]
grads:  [-0.03448169]
Stock Position:  -0.03448168839383695
Bond Position:  [-14.41520679]


portfolio before change:  [-17.83654605]
curr_Stock_Price:  99.16965813535653
curr_Factors:  [99.16965814]
mat_Sqrt:  [[0.15]]
grads:  [-0.04736961]
Stock Position:  -0.04736961366209282
Bond Position:  [-13.13891766]


portfolio before change:  [-17.78951002]
curr_Stock_Price:  98.14202683313484
curr_Factors:  [98.14202683]
mat_Sqrt:  [[0.15]]
grads:  [-0.3429217]
Stock Position:  -0.3429217039729465
Bond Position:  [15.86552105]


portfolio before change:  [-18.18351162]
curr_Stock_Price:  99.29676540177275
curr_Factors:  [99.2967654]
mat_Sqrt:  [[0.15]]
grads:  [0.15732843]
Stock Position:  0.15732842709240993
Bond Position:  [-33.80571554]


portfolio before change:  [-18.09887092]
curr_Stock_Price:  99.86161365240515
curr_Factors:  [99.86161365]
mat_Sqrt:  [[0.15]]
grads:  [-0.03953393]
Stock Position:  -0.0395339262274716
Bond Position:  [-14.15094925]


portfolio before change:  [-18.11426822]
curr_Stock_Price:  100.2063383292407
curr_Factors:  [100.20633833]
mat_Sqrt:  [[0.15]]
grads:  [0.01067171]
Stock Position:  0.010671710356888731
Bond Position:  [-19.18364123]


portfolio before change:  [-18.11298627]
curr_Stock_Price:  100.55118018407707
curr_Factors:  [100.55118018]
mat_Sqrt:  [[0.15]]
grads:  [0.06683862]
Stock Position:  0.0668386205738101
Bond Position:  [-24.83368845]


portfolio before change:  [-18.05674756]
curr_Stock_Price:  101.43903684212175
curr_Factors:  [101.43903684]
mat_Sqrt:  [[0.15]]
grads:  [0.03241301]
Stock Position:  0.03241301113634924
Bond Position:  [-21.34469219]


portfolio before change:  [-18.04596505]
curr_Stock_Price:  101.85401706041343
curr_Factors:  [101.85401706]
mat_Sqrt:  [[0.15]]
grads:  [0.05970525]
Stock Position:  0.0597052454364521
Bond Position:  [-24.12718414]


portfolio before change:  [-18.05043821]
curr_Stock_Price:  101.82961269001919
curr_Factors:  [101.82961269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03579806]
Stock Position:  -0.03579805563009983
Bond Position:  [-14.40513607]


portfolio before change:  [-18.09241287]
curr_Stock_Price:  102.95184968994762
curr_Factors:  [102.95184969]
mat_Sqrt:  [[0.15]]
grads:  [0.05520984]
Stock Position:  0.055209835374320296
Bond Position:  [-23.77636754]


portfolio before change:  [-18.07268069]
curr_Stock_Price:  103.36308816455158
curr_Factors:  [103.36308816]
mat_Sqrt:  [[0.15]]
grads:  [0.01894629]
Stock Position:  0.01894628805105526
Bond Position:  [-20.03102753]


portfolio before change:  [-18.1012171]
curr_Stock_Price:  101.98907893315241
curr_Factors:  [101.98907893]
mat_Sqrt:  [[0.15]]
grads:  [0.05869811]
Stock Position:  0.05869811267741762
Bond Position:  [-24.08778355]


portfolio before change:  [-18.09941542]
curr_Stock_Price:  102.07107196690032
curr_Factors:  [102.07107197]
mat_Sqrt:  [[0.15]]
grads:  [0.07951797]
Stock Position:  0.07951797191369281
Bond Position:  [-26.21590006]


portfolio before change:  [-18.1347109]
curr_Stock_Price:  101.66841733642235
curr_Factors:  [101.66841734]
mat_Sqrt:  [[0.15]]
grads:  [0.0777465]
Stock Position:  0.0777464952798944
Bond Position:  [-26.03907402]


portfolio before change:  [-18.07583165]
curr_Stock_Price:  102.4676087733333
curr_Factors:  [102.46760877]
mat_Sqrt:  [[0.15]]
grads:  [-0.09691304]
Stock Position:  -0.096913044373678
Bond Position:  [-8.14538373]


portfolio before change:  [-17.99611408]
curr_Stock_Price:  101.63453409029106
curr_Factors:  [101.63453409]
mat_Sqrt:  [[0.15]]
grads:  [-0.080055]
Stock Position:  -0.08005499513797724
Bond Position:  [-9.85976195]


portfolio before change:  [-17.97643595]
curr_Stock_Price:  101.37333008609677
curr_Factors:  [101.37333009]
mat_Sqrt:  [[0.15]]
grads:  [0.14005107]
Stock Position:  0.1400510736736256
Bond Position:  [-32.17387967]


portfolio before change:  [-17.99299417]
curr_Stock_Price:  101.2838181878963
curr_Factors:  [101.28381819]
mat_Sqrt:  [[0.15]]
grads:  [-0.14394578]
Stock Position:  -0.1439457825914081
Bond Position:  [-3.4136157]


portfolio before change:  [-17.98673256]
curr_Stock_Price:  101.23735390038033
curr_Factors:  [101.2373539]
mat_Sqrt:  [[0.15]]
grads:  [0.04073951]
Stock Position:  0.04073950674301724
Bond Position:  [-22.11109242]


portfolio before change:  [-17.97879803]
curr_Stock_Price:  101.49996361268246
curr_Factors:  [101.49996361]
mat_Sqrt:  [[0.15]]
grads:  [-0.05236383]
Stock Position:  -0.05236383058490286
Bond Position:  [-12.66387113]


portfolio before change:  [-17.98526248]
curr_Stock_Price:  101.59318379132274
curr_Factors:  [101.59318379]
mat_Sqrt:  [[0.15]]
grads:  [-0.04383554]
Stock Position:  -0.04383553807231832
Bond Position:  [-13.5318706]


portfolio before change:  [-17.95570521]
curr_Stock_Price:  100.88031795270794
curr_Factors:  [100.88031795]
mat_Sqrt:  [[0.15]]
grads:  [0.01469859]
Stock Position:  0.01469858591067988
Bond Position:  [-19.43850323]


portfolio before change:  [-17.96212469]
curr_Stock_Price:  100.60889634107525
curr_Factors:  [100.60889634]
mat_Sqrt:  [[0.15]]
grads:  [-0.07502143]
Stock Position:  -0.07502142890986199
Bond Position:  [-10.41430152]


portfolio before change:  [-17.96997196]
curr_Stock_Price:  100.69614348940907
curr_Factors:  [100.69614349]
mat_Sqrt:  [[0.15]]
grads:  [-0.12049569]
Stock Position:  -0.12049568502271116
Bond Position:  [-5.83652117]


portfolio before change:  [-17.95695594]
curr_Stock_Price:  100.58206773514885
curr_Factors:  [100.58206774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05433762]
Stock Position:  -0.05433761751276642
Bond Position:  [-12.49156601]


portfolio before change:  [-17.90886796]
curr_Stock_Price:  99.66834484004596
curr_Factors:  [99.66834484]
mat_Sqrt:  [[0.15]]
grads:  [-0.02189751]
Stock Position:  -0.021897513816920965
Bond Position:  [-15.726379]


portfolio before change:  [-17.92487913]
curr_Stock_Price:  100.30975369019878
curr_Factors:  [100.30975369]
mat_Sqrt:  [[0.15]]
grads:  [0.03555442]
Stock Position:  0.03555442053198885
Bond Position:  [-21.4913343]


portfolio before change:  [-17.94332477]
curr_Stock_Price:  99.86651622100986
curr_Factors:  [99.86651622]
mat_Sqrt:  [[0.15]]
grads:  [0.03678517]
Stock Position:  0.036785171112562985
Bond Position:  [-21.61693166]


portfolio before change:  [-17.95796616]
curr_Stock_Price:  99.54195327283782
curr_Factors:  [99.54195327]
mat_Sqrt:  [[0.15]]
grads:  [-0.07922355]
Stock Position:  -0.07922355310909013
Bond Position:  [-10.07189894]


portfolio before change:  [-17.95810441]
curr_Stock_Price:  99.527805734516
curr_Factors:  [99.52780573]
mat_Sqrt:  [[0.15]]
grads:  [0.09965737]
Stock Position:  0.09965736937118412
Bond Position:  [-27.87678371]


portfolio before change:  [-18.01847404]
curr_Stock_Price:  98.9570018486637
curr_Factors:  [98.95700185]
mat_Sqrt:  [[0.15]]
grads:  [0.03810533]
Stock Position:  0.03810533204768958
Bond Position:  [-21.78926345]


portfolio before change:  [-18.02540122]
curr_Stock_Price:  98.84669305476666
curr_Factors:  [98.84669305]
mat_Sqrt:  [[0.15]]
grads:  [0.02144512]
Stock Position:  0.021445118236923452
Bond Position:  [-20.14518024]


portfolio before change:  [-18.04512745]
curr_Stock_Price:  98.04427588192279
curr_Factors:  [98.04427588]
mat_Sqrt:  [[0.15]]
grads:  [0.07513105]
Stock Position:  0.07513104924832995
Bond Position:  [-25.41129677]


portfolio before change:  [-18.08958356]
curr_Stock_Price:  97.4948426279113
curr_Factors:  [97.49484263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.08958356]
Stock Price:  98.67584064180375
PL:  [-18.08958356]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.17112066e-03]
 [-1.80143358e-04]
 [ 2.69268546e-03]
 [-2.78477642e-03]
 [ 1.53582963e-02]
 [ 2.06810260e-02]
 [ 1.21392987e-03]
 [ 2.23147201e-02]
 [-5.87084221e-03]
 [ 4.80985865e-03]
 [ 4.63874262e-03]
 [ 5.01848363e-03]
 [ 1.17443691e-02]
 [ 5.15927261e-03]
 [ 2.21040000e-02]
 [ 1.85585979e-03]
 [ 8.72961423e-03]
 [ 1.26792430e-02]
 [ 1.16168389e-02]
 [-1.27523111e-02]
 [-1.71124520e-02]
 [ 1.55525853e-02]
 [ 1.81136375e-02]
 [ 4.51759635e-03]
 [ 1.69419257e-02]
 [-1.10080539e-02]
 [ 1.16474254e-02]
 [-1.13326613e-02]
 [-1.84647738e-02]
 [-2.26642254e-03]
 [-3.84190996e-03]
 [ 5.63312242e-03]
 [ 6.77801968e-03]
 [-1.19312984e-02]
 [ 9.24384514e-03]
 [ 5.65811041e-03]
 [ 2.30172704e-03]
 [ 8.00949742e-03]
 [-9.53977960e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.23420987]
curr_Stock_Price:  100.2117196247874
curr_Factors:  [100.21171962]
mat_Sqrt:  [[0.15]]
grads:  [0.0411408]
Stock Position:  0.0411408043843767
Bond Position:  [1.11141911]


portfolio before change:  [5.20836605]
curr_Stock_Price:  99.5801629125501
curr_Factors:  [99.58016291]
mat_Sqrt:  [[0.15]]
grads:  [-0.00120096]
Stock Position:  -0.0012009557227636812
Bond Position:  [5.32795742]


portfolio before change:  [5.20917567]
curr_Stock_Price:  99.46060851937044
curr_Factors:  [99.46060852]
mat_Sqrt:  [[0.15]]
grads:  [0.01795124]
Stock Position:  0.017951236395216782
Bond Position:  [3.42373477]


portfolio before change:  [5.22510798]
curr_Stock_Price:  100.32429936475503
curr_Factors:  [100.32429936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01856518]
Stock Position:  -0.01856517615441668
Bond Position:  [7.08764627]


portfolio before change:  [5.22101388]
curr_Stock_Price:  100.59254971475843
curr_Factors:  [100.59254971]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-5.07852069]


portfolio before change:  [5.18972911]
curr_Stock_Price:  100.29320095941152
curr_Factors:  [100.29320096]
mat_Sqrt:  [[0.15]]
grads:  [0.13787351]
Stock Position:  0.13787350661009876
Bond Position:  [-8.63804619]


portfolio before change:  [5.20420781]
curr_Stock_Price:  100.40604729754656
curr_Factors:  [100.4060473]
mat_Sqrt:  [[0.15]]
grads:  [0.00809287]
Stock Position:  0.008092865796114578
Bond Position:  [4.39163514]


portfolio before change:  [5.20098712]
curr_Stock_Price:  99.94024456025804
curr_Factors:  [99.94024456]
mat_Sqrt:  [[0.15]]
grads:  [0.1487648]
Stock Position:  0.14876480057345418
Bond Position:  [-9.66660343]


portfolio before change:  [5.14317583]
curr_Stock_Price:  99.55975878140183
curr_Factors:  [99.55975878]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913895]
Stock Position:  -0.03913894804181967
Bond Position:  [9.03984005]


portfolio before change:  [5.15311962]
curr_Stock_Price:  99.33456768458983
curr_Factors:  [99.33456768]
mat_Sqrt:  [[0.15]]
grads:  [0.03206572]
Stock Position:  0.0320657243143502
Bond Position:  [1.96788476]


portfolio before change:  [5.15883812]
curr_Stock_Price:  99.50523266183502
curr_Factors:  [99.50523266]
mat_Sqrt:  [[0.15]]
grads:  [0.03092495]
Stock Position:  0.030924950818937612
Bond Position:  [2.08164369]


portfolio before change:  [5.16084845]
curr_Stock_Price:  99.56182503458115
curr_Factors:  [99.56182503]
mat_Sqrt:  [[0.15]]
grads:  [0.03345656]
Stock Position:  0.03345655756369327
Bond Position:  [1.82985252]


portfolio before change:  [5.18679164]
curr_Stock_Price:  100.33041682559876
curr_Factors:  [100.33041683]
mat_Sqrt:  [[0.15]]
grads:  [0.07829579]
Stock Position:  0.07829579429384353
Bond Position:  [-2.66865804]


portfolio before change:  [5.13259014]
curr_Stock_Price:  99.64241184733302
curr_Factors:  [99.64241185]
mat_Sqrt:  [[0.15]]
grads:  [0.03439515]
Stock Position:  0.03439515074663959
Bond Position:  [1.70537436]


portfolio before change:  [5.16579891]
curr_Stock_Price:  100.60172126992867
curr_Factors:  [100.60172127]
mat_Sqrt:  [[0.15]]
grads:  [0.14736]
Stock Position:  0.14736000012072373
Bond Position:  [-9.65887075]


portfolio before change:  [5.31313243]
curr_Stock_Price:  101.60973532051443
curr_Factors:  [101.60973532]
mat_Sqrt:  [[0.15]]
grads:  [0.0123724]
Stock Position:  0.012372398618156642
Bond Position:  [4.05597628]


portfolio before change:  [5.32089239]
curr_Stock_Price:  102.19595434481865
curr_Factors:  [102.19595434]
mat_Sqrt:  [[0.15]]
grads:  [0.05819743]
Stock Position:  0.058197428229024226
Bond Position:  [-0.62664932]


portfolio before change:  [5.29544654]
curr_Stock_Price:  101.76006706535772
curr_Factors:  [101.76006707]
mat_Sqrt:  [[0.15]]
grads:  [0.08452829]
Stock Position:  0.08452828648424646
Bond Position:  [-3.30615756]


portfolio before change:  [5.2416642]
curr_Stock_Price:  101.12869210350713
curr_Factors:  [101.1286921]
mat_Sqrt:  [[0.15]]
grads:  [0.07744559]
Stock Position:  0.0774455923643847
Bond Position:  [-2.59030727]


portfolio before change:  [5.21306136]
curr_Stock_Price:  100.76354497195182
curr_Factors:  [100.76354497]
mat_Sqrt:  [[0.15]]
grads:  [-0.08501541]
Stock Position:  -0.08501540764488752
Bond Position:  [13.77951521]


portfolio before change:  [5.20698892]
curr_Stock_Price:  100.85523397707719
curr_Factors:  [100.85523398]
mat_Sqrt:  [[0.15]]
grads:  [-0.11408301]
Stock Position:  -0.11408301355585453
Bond Position:  [16.71285795]


portfolio before change:  [5.29373822]
curr_Stock_Price:  100.1131422274523
curr_Factors:  [100.11314223]
mat_Sqrt:  [[0.15]]
grads:  [0.1036839]
Stock Position:  0.10368390184649198
Bond Position:  [-5.08638299]


portfolio before change:  [5.14353982]
curr_Stock_Price:  98.67065632299395
curr_Factors:  [98.67065632]
mat_Sqrt:  [[0.15]]
grads:  [0.12075758]
Stock Position:  0.12075758354661166
Bond Position:  [-6.7716902]


portfolio before change:  [5.00784857]
curr_Stock_Price:  97.5539998477057
curr_Factors:  [97.55399985]
mat_Sqrt:  [[0.15]]
grads:  [0.03011731]
Stock Position:  0.030117308977554158
Bond Position:  [2.06978461]


portfolio before change:  [5.01786123]
curr_Stock_Price:  97.87786414404964
curr_Factors:  [97.87786414]
mat_Sqrt:  [[0.15]]
grads:  [0.11294617]
Stock Position:  0.11294617145370163
Bond Position:  [-6.0370688]


portfolio before change:  [5.0624896]
curr_Stock_Price:  98.27967545373815
curr_Factors:  [98.27967545]
mat_Sqrt:  [[0.15]]
grads:  [-0.07338703]
Stock Position:  -0.07338702623800107
Bond Position:  [12.27494272]


portfolio before change:  [4.99480877]
curr_Stock_Price:  99.22282973776458
curr_Factors:  [99.22282974]
mat_Sqrt:  [[0.15]]
grads:  [0.0776495]
Stock Position:  0.07764950239176678
Bond Position:  [-2.70979458]


portfolio before change:  [5.07469039]
curr_Stock_Price:  100.25593821676183
curr_Factors:  [100.25593822]
mat_Sqrt:  [[0.15]]
grads:  [-0.07555108]
Stock Position:  -0.07555107512179805
Bond Position:  [12.64913431]


portfolio before change:  [5.16265948]
curr_Stock_Price:  99.11250178876456
curr_Factors:  [99.11250179]
mat_Sqrt:  [[0.15]]
grads:  [-0.12309849]
Stock Position:  -0.12309849200829125
Bond Position:  [17.36325899]


portfolio before change:  [5.24842842]
curr_Stock_Price:  98.43338380463737
curr_Factors:  [98.4333838]
mat_Sqrt:  [[0.15]]
grads:  [-0.01510948]
Stock Position:  -0.01510948359261884
Bond Position:  [6.73570602]


portfolio before change:  [5.25948635]
curr_Stock_Price:  97.75725815409704
curr_Factors:  [97.75725815]
mat_Sqrt:  [[0.15]]
grads:  [-0.02561273]
Stock Position:  -0.025612733068784012
Bond Position:  [7.76331691]


portfolio before change:  [5.24370452]
curr_Stock_Price:  98.41131969556182
curr_Factors:  [98.4113197]
mat_Sqrt:  [[0.15]]
grads:  [0.03755415]
Stock Position:  0.037554149462507666
Bond Position:  [1.54795111]


portfolio before change:  [5.25908809]
curr_Stock_Price:  98.81580391802483
curr_Factors:  [98.81580392]
mat_Sqrt:  [[0.15]]
grads:  [0.0451868]
Stock Position:  0.04518679786788321
Bond Position:  [0.79391833]


portfolio before change:  [5.2798631]
curr_Stock_Price:  99.2733661826639
curr_Factors:  [99.27336618]
mat_Sqrt:  [[0.15]]
grads:  [-0.07954199]
Stock Position:  -0.07954198943653272
Bond Position:  [13.17626415]


portfolio before change:  [5.31727684]
curr_Stock_Price:  98.82370933587552
curr_Factors:  [98.82370934]
mat_Sqrt:  [[0.15]]
grads:  [0.06162563]
Stock Position:  0.061625634269235334
Bond Position:  [-0.77279693]


portfolio before change:  [5.37450416]
curr_Stock_Price:  99.75390541993322
curr_Factors:  [99.75390542]
mat_Sqrt:  [[0.15]]
grads:  [0.03772074]
Stock Position:  0.03772073608206936
Bond Position:  [1.61171342]


portfolio before change:  [5.39300155]
curr_Stock_Price:  100.23894136700082
curr_Factors:  [100.23894137]
mat_Sqrt:  [[0.15]]
grads:  [0.01534485]
Stock Position:  0.015344846941102228
Bond Position:  [3.85485034]


portfolio before change:  [5.39481954]
curr_Stock_Price:  100.32601347316329
curr_Factors:  [100.32601347]
mat_Sqrt:  [[0.15]]
grads:  [0.05339665]
Stock Position:  0.05339664945928543
Bond Position:  [0.03774657]


portfolio before change:  [5.41462693]
curr_Stock_Price:  100.69687316498923
curr_Factors:  [100.69687316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.41462693]
Stock Price:  99.834816119726
PL:  [5.41462693]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.22919026e-03]
 [ 4.52715383e-03]
 [ 6.93356218e-03]
 [-2.71469298e-03]
 [ 5.73109568e-03]
 [-2.02734521e-02]
 [-5.19034035e-02]
 [ 2.07013595e-02]
 [-5.86606696e-03]
 [ 4.86432033e-03]
 [-3.32724000e-03]
 [ 6.71210628e-03]
 [ 1.44074117e-02]
 [ 1.64140455e-03]
 [ 1.85470777e-02]
 [ 1.09341126e-03]
 [ 9.40868969e-03]
 [ 1.17914841e-02]
 [ 1.14752314e-02]
 [-1.41267938e-02]
 [-1.26339025e-02]
 [ 3.15220527e-02]
 [-2.09629215e-02]
 [ 8.06798966e-03]
 [ 7.38871908e-03]
 [-1.57722845e-02]
 [-4.11994361e-04]
 [-1.10500540e-02]
 [ 5.48340050e-02]
 [-2.99809304e-03]
 [-1.17016019e-02]
 [ 3.85561600e-03]
 [ 7.56802310e-03]
 [ 6.00322998e-03]
 [ 8.19447720e-03]
 [ 2.76693485e-03]
 [-7.13163653e-02]
 [ 9.26430369e-03]
 [-2.68339149e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.67545528]
curr_Stock_Price:  100.04665598034246
curr_Factors:  [100.04665598]
mat_Sqrt:  [[0.15]]
grads:  [0.0281946]
Stock Position:  0.02819460174347225
Bond Position:  [-0.14532034]


portfolio before change:  [2.67674191]
curr_Stock_Price:  100.09293430646822
curr_Factors:  [100.09293431]
mat_Sqrt:  [[0.15]]
grads:  [0.03018103]
Stock Position:  0.030181025558191125
Bond Position:  [-0.3441655]


portfolio before change:  [2.67362596]
curr_Stock_Price:  99.99111768171946
curr_Factors:  [99.99111768]
mat_Sqrt:  [[0.15]]
grads:  [0.04622375]
Stock Position:  0.04622374783986353
Bond Position:  [-1.94833825]


portfolio before change:  [2.69353351]
curr_Stock_Price:  100.42706490540424
curr_Factors:  [100.42706491]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809795]
Stock Position:  -0.01809795320895189
Bond Position:  [4.51105784]


portfolio before change:  [2.71670102]
curr_Stock_Price:  99.17810644089825
curr_Factors:  [99.17810644]
mat_Sqrt:  [[0.15]]
grads:  [0.0382073]
Stock Position:  0.03820730453456936
Bond Position:  [-1.07262709]


portfolio before change:  [2.69539075]
curr_Stock_Price:  98.62386205853123
curr_Factors:  [98.62386206]
mat_Sqrt:  [[0.15]]
grads:  [-0.13515635]
Stock Position:  -0.13515634724785283
Bond Position:  [16.0250317]


portfolio before change:  [2.74356357]
curr_Stock_Price:  98.28226089864401
curr_Factors:  [98.2822609]
mat_Sqrt:  [[0.15]]
grads:  [-0.34602269]
Stock Position:  -0.3460226899514307
Bond Position:  [36.75145586]


portfolio before change:  [2.71171913]
curr_Stock_Price:  98.38756803713046
curr_Factors:  [98.38756804]
mat_Sqrt:  [[0.15]]
grads:  [0.13800906]
Stock Position:  0.1380090634860706
Bond Position:  [-10.86665699]


portfolio before change:  [2.78183718]
curr_Stock_Price:  98.90547945073135
curr_Factors:  [98.90547945]
mat_Sqrt:  [[0.15]]
grads:  [-0.03910711]
Stock Position:  -0.03910711305470338
Bond Position:  [6.64974495]


portfolio before change:  [2.77102373]
curr_Stock_Price:  99.20324423152722
curr_Factors:  [99.20324423]
mat_Sqrt:  [[0.15]]
grads:  [0.0324288]
Stock Position:  0.03242880218414328
Bond Position:  [-0.44601865]


portfolio before change:  [2.73220841]
curr_Stock_Price:  98.00802378801696
curr_Factors:  [98.00802379]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221816]
Stock Position:  -0.022181600003494235
Bond Position:  [4.90618319]


portfolio before change:  [2.71629692]
curr_Stock_Price:  98.7530018123439
curr_Factors:  [98.75300181]
mat_Sqrt:  [[0.15]]
grads:  [0.04474738]
Stock Position:  0.04474737517437223
Bond Position:  [-1.70264071]


portfolio before change:  [2.74566012]
curr_Stock_Price:  99.41395779903841
curr_Factors:  [99.4139578]
mat_Sqrt:  [[0.15]]
grads:  [0.09604941]
Stock Position:  0.0960494116508418
Bond Position:  [-6.80299204]


portfolio before change:  [2.85798741]
curr_Stock_Price:  100.59228585186665
curr_Factors:  [100.59228585]
mat_Sqrt:  [[0.15]]
grads:  [0.0109427]
Stock Position:  0.010942696967037967
Bond Position:  [1.75723651]


portfolio before change:  [2.85335435]
curr_Stock_Price:  100.14881919683712
curr_Factors:  [100.1488192]
mat_Sqrt:  [[0.15]]
grads:  [0.12364718]
Stock Position:  0.12364718492370008
Bond Position:  [-9.52976521]


portfolio before change:  [2.93828536]
curr_Stock_Price:  100.84533564472241
curr_Factors:  [100.84533564]
mat_Sqrt:  [[0.15]]
grads:  [0.00728941]
Stock Position:  0.007289408428776473
Bond Position:  [2.20318252]


portfolio before change:  [2.94198565]
curr_Stock_Price:  101.3151791962528
curr_Factors:  [101.3151792]
mat_Sqrt:  [[0.15]]
grads:  [0.0627246]
Stock Position:  0.06272459790750719
Bond Position:  [-3.41296822]


portfolio before change:  [2.99328735]
curr_Stock_Price:  102.1398691178005
curr_Factors:  [102.13986912]
mat_Sqrt:  [[0.15]]
grads:  [0.07860989]
Stock Position:  0.07860989391254498
Bond Position:  [-5.03591693]


portfolio before change:  [3.00363006]
curr_Stock_Price:  102.27944741571301
curr_Factors:  [102.27944742]
mat_Sqrt:  [[0.15]]
grads:  [0.07650154]
Stock Position:  0.0765015427282476
Bond Position:  [-4.82090546]


portfolio before change:  [2.99138371]
curr_Stock_Price:  102.12724536216692
curr_Factors:  [102.12724536]
mat_Sqrt:  [[0.15]]
grads:  [-0.09417863]
Stock Position:  -0.0941786254271965
Bond Position:  [12.6095873]


portfolio before change:  [3.04733381]
curr_Stock_Price:  101.5498977814643
curr_Factors:  [101.54989778]
mat_Sqrt:  [[0.15]]
grads:  [-0.08422602]
Stock Position:  -0.08422601676532512
Bond Position:  [11.60047721]


portfolio before change:  [2.87221269]
curr_Stock_Price:  103.64629603051344
curr_Factors:  [103.64629603]
mat_Sqrt:  [[0.15]]
grads:  [0.21014702]
Stock Position:  0.21014701791183912
Bond Position:  [-18.90874734]


portfolio before change:  [3.01916091]
curr_Stock_Price:  104.3568079742779
curr_Factors:  [104.35680797]
mat_Sqrt:  [[0.15]]
grads:  [-0.13975281]
Stock Position:  -0.139752809765834
Bond Position:  [17.60331805]


portfolio before change:  [2.98108347]
curr_Stock_Price:  104.64501684888195
curr_Factors:  [104.64501685]
mat_Sqrt:  [[0.15]]
grads:  [0.0537866]
Stock Position:  0.053786597707846655
Bond Position:  [-2.64741596]


portfolio before change:  [2.97439839]
curr_Stock_Price:  104.5268809554813
curr_Factors:  [104.52688096]
mat_Sqrt:  [[0.15]]
grads:  [0.04925813]
Stock Position:  0.04925812719583522
Bond Position:  [-2.17440001]


portfolio before change:  [2.98731117]
curr_Stock_Price:  104.79454437164001
curr_Factors:  [104.79454437]
mat_Sqrt:  [[0.15]]
grads:  [-0.10514856]
Stock Position:  -0.10514856336588621
Bond Position:  [14.00630696]


portfolio before change:  [3.00119035]
curr_Stock_Price:  104.67920016725795
curr_Factors:  [104.67920017]
mat_Sqrt:  [[0.15]]
grads:  [-0.00274663]
Stock Position:  -0.0027466290710786412
Bond Position:  [3.28870528]


portfolio before change:  [3.00129635]
curr_Stock_Price:  104.79028677142021
curr_Factors:  [104.79028677]
mat_Sqrt:  [[0.15]]
grads:  [-0.07366703]
Stock Position:  -0.07366702687252509
Bond Position:  [10.72088522]


portfolio before change:  [3.04321859]
curr_Stock_Price:  104.23940188919067
curr_Factors:  [104.23940189]
mat_Sqrt:  [[0.15]]
grads:  [0.36556003]
Stock Position:  0.36556003332835313
Bond Position:  [-35.06254064]


portfolio before change:  [3.6264778]
curr_Stock_Price:  105.8469143151757
curr_Factors:  [105.84691432]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998729]
Stock Position:  -0.01998728692017264
Bond Position:  [5.74207044]


portfolio before change:  [3.60879522]
curr_Stock_Price:  106.76751870807058
curr_Factors:  [106.76751871]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801068]
Stock Position:  -0.07801067948642185
Bond Position:  [11.9378019]


portfolio before change:  [3.47820093]
curr_Stock_Price:  108.46070483714223
curr_Factors:  [108.46070484]
mat_Sqrt:  [[0.15]]
grads:  [0.02570411]
Stock Position:  0.025704106654874933
Bond Position:  [0.69031541]


portfolio before change:  [3.49146104]
curr_Stock_Price:  108.97322239149302
curr_Factors:  [108.97322239]
mat_Sqrt:  [[0.15]]
grads:  [0.05045349]
Stock Position:  0.0504534873332316
Bond Position:  [-2.00661806]


portfolio before change:  [3.48740939]
curr_Stock_Price:  108.89788962979762
curr_Factors:  [108.89788963]
mat_Sqrt:  [[0.15]]
grads:  [0.04002153]
Stock Position:  0.04002153318448208
Bond Position:  [-0.87085111]


portfolio before change:  [3.46352097]
curr_Stock_Price:  108.30372051347682
curr_Factors:  [108.30372051]
mat_Sqrt:  [[0.15]]
grads:  [0.05462985]
Stock Position:  0.054629848013717924
Bond Position:  [-2.45309482]


portfolio before change:  [3.47934258]
curr_Stock_Price:  108.59894857899556
curr_Factors:  [108.59894858]
mat_Sqrt:  [[0.15]]
grads:  [0.01844623]
Stock Position:  0.018446232312419687
Bond Position:  [1.47610114]


portfolio before change:  [3.48696778]
curr_Stock_Price:  109.00231947775544
curr_Factors:  [109.00231948]
mat_Sqrt:  [[0.15]]
grads:  [-0.47544244]
Stock Position:  -0.47544243537194536
Bond Position:  [55.31129601]


portfolio before change:  [3.76897161]
curr_Stock_Price:  108.42372263852195
curr_Factors:  [108.42372264]
mat_Sqrt:  [[0.15]]
grads:  [0.06176202]
Stock Position:  0.061762024575384794
Bond Position:  [-2.92749701]


portfolio before change:  [3.77298958]
curr_Stock_Price:  108.49470370941684
curr_Factors:  [108.49470371]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.77298958]
Stock Price:  108.21492057827781
PL:  [-4.44193099]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.15712735e-03]
 [ 4.01838338e-03]
 [ 9.39427381e-04]
 [-2.68413276e-03]
 [ 1.54345497e-02]
 [ 4.49837469e-03]
 [-2.60600697e-03]
 [ 2.08422751e-02]
 [-6.86972935e-03]
 [ 3.24865480e-04]
 [ 9.00733341e-03]
 [ 4.03982344e-03]
 [ 1.17325633e-02]
 [-5.11434972e-03]
 [ 2.10999525e-02]
 [ 5.42026513e-04]
 [ 9.34780717e-03]
 [ 1.41234596e-02]
 [ 1.16635001e-02]
 [-1.42496692e-02]
 [-6.30668582e-03]
 [ 2.09139688e-02]
 [-3.16658198e-02]
 [ 5.24901878e-03]
 [-6.49274238e-03]
 [-6.57874542e-03]
 [-1.04051504e-03]
 [-1.11879738e-02]
 [ 2.11310116e-02]
 [-9.25479470e-03]
 [-1.52657212e-03]
 [ 4.80284312e-03]
 [ 5.42648990e-03]
 [-1.71509355e-03]
 [ 7.04040338e-03]
 [ 4.44691944e-03]
 [-2.18892254e-02]
 [ 9.74502598e-03]
 [-5.04328773e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.75618446]
curr_Stock_Price:  99.56724558949999
curr_Factors:  [99.56724559]
mat_Sqrt:  [[0.15]]
grads:  [0.02771418]
Stock Position:  0.027714182340230417
Bond Position:  [-7.51560926]


portfolio before change:  [-4.73096066]
curr_Stock_Price:  100.51128607135013
curr_Factors:  [100.51128607]
mat_Sqrt:  [[0.15]]
grads:  [0.02678922]
Stock Position:  0.02678922255918377
Bond Position:  [-7.42357987]


portfolio before change:  [-4.76162242]
curr_Stock_Price:  99.40137112994456
curr_Factors:  [99.40137113]
mat_Sqrt:  [[0.15]]
grads:  [0.00626285]
Stock Position:  0.006262849203363007
Bond Position:  [-5.38415822]


portfolio before change:  [-4.75552065]
curr_Stock_Price:  100.48312062298577
curr_Factors:  [100.48312062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01789422]
Stock Position:  -0.01789421838620994
Bond Position:  [-2.95745374]


portfolio before change:  [-4.7533092]
curr_Stock_Price:  100.33887565542697
curr_Factors:  [100.33887566]
mat_Sqrt:  [[0.15]]
grads:  [0.102897]
Stock Position:  0.10289699794879636
Bond Position:  [-15.07787828]


portfolio before change:  [-4.83917261]
curr_Stock_Price:  99.52273374304326
curr_Factors:  [99.52273374]
mat_Sqrt:  [[0.15]]
grads:  [0.02998916]
Stock Position:  0.029989164574767357
Bond Position:  [-7.82377625]


portfolio before change:  [-4.82305402]
curr_Stock_Price:  100.09282707014671
curr_Factors:  [100.09282707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737338]
Stock Position:  -0.017373379826988892
Bond Position:  [-3.08410331]


portfolio before change:  [-4.82525593]
curr_Stock_Price:  100.19737655703067
curr_Factors:  [100.19737656]
mat_Sqrt:  [[0.15]]
grads:  [0.1389485]
Stock Position:  0.138948500666939
Bond Position:  [-18.74753118]


portfolio before change:  [-4.71739653]
curr_Stock_Price:  100.99049768764267
curr_Factors:  [100.99049769]
mat_Sqrt:  [[0.15]]
grads:  [-0.0457982]
Stock Position:  -0.04579819568444564
Bond Position:  [-0.09221395]


portfolio before change:  [-4.70113914]
curr_Stock_Price:  100.63526721377917
curr_Factors:  [100.63526721]
mat_Sqrt:  [[0.15]]
grads:  [0.00216577]
Stock Position:  0.0021657698698484703
Bond Position:  [-4.91909197]


portfolio before change:  [-4.70246844]
curr_Stock_Price:  100.3054210705384
curr_Factors:  [100.30542107]
mat_Sqrt:  [[0.15]]
grads:  [0.06004889]
Stock Position:  0.06004888941778018
Bond Position:  [-10.72569757]


portfolio before change:  [-4.69275672]
curr_Stock_Price:  100.48947967061424
curr_Factors:  [100.48947967]
mat_Sqrt:  [[0.15]]
grads:  [0.02693216]
Stock Position:  0.026932156295348376
Bond Position:  [-7.39915509]


portfolio before change:  [-4.69818987]
curr_Stock_Price:  100.32208860817443
curr_Factors:  [100.32208861]
mat_Sqrt:  [[0.15]]
grads:  [0.07821709]
Stock Position:  0.07821708899826846
Bond Position:  [-12.54509161]


portfolio before change:  [-4.5972436]
curr_Stock_Price:  101.63272937480129
curr_Factors:  [101.63272937]
mat_Sqrt:  [[0.15]]
grads:  [-0.03409566]
Stock Position:  -0.03409566477167324
Bond Position:  [-1.13200813]


portfolio before change:  [-4.55796196]
curr_Stock_Price:  100.47647814846947
curr_Factors:  [100.47647815]
mat_Sqrt:  [[0.15]]
grads:  [0.14066635]
Stock Position:  0.1406663496977827
Bond Position:  [-18.69162137]


portfolio before change:  [-4.54931563]
curr_Stock_Price:  100.55455600073232
curr_Factors:  [100.554556]
mat_Sqrt:  [[0.15]]
grads:  [0.00361351]
Stock Position:  0.0036135100843065066
Bond Position:  [-4.91267053]


portfolio before change:  [-4.55050417]
curr_Stock_Price:  100.39559180582944
curr_Factors:  [100.39559181]
mat_Sqrt:  [[0.15]]
grads:  [0.06231871]
Stock Position:  0.06231871448181307
Bond Position:  [-10.80702839]


portfolio before change:  [-4.5077258]
curr_Stock_Price:  101.1037151427107
curr_Factors:  [101.10371514]
mat_Sqrt:  [[0.15]]
grads:  [0.0941564]
Stock Position:  0.09415639764471015
Bond Position:  [-14.0272874]


portfolio before change:  [-4.47480296]
curr_Stock_Price:  101.47199984940936
curr_Factors:  [101.47199985]
mat_Sqrt:  [[0.15]]
grads:  [0.07775667]
Stock Position:  0.07775666702204759
Bond Position:  [-12.36492746]


portfolio before change:  [-4.41758693]
curr_Stock_Price:  102.22771310354942
curr_Factors:  [102.2277131]
mat_Sqrt:  [[0.15]]
grads:  [-0.09499779]
Stock Position:  -0.0949977947125705
Bond Position:  [5.29382038]


portfolio before change:  [-4.43297901]
curr_Stock_Price:  102.39670499213027
curr_Factors:  [102.39670499]
mat_Sqrt:  [[0.15]]
grads:  [-0.04204457]
Stock Position:  -0.04204457211620443
Bond Position:  [-0.12775337]


portfolio before change:  [-4.38058633]
curr_Stock_Price:  101.15020287129896
curr_Factors:  [101.15020287]
mat_Sqrt:  [[0.15]]
grads:  [0.13942646]
Stock Position:  0.13942645870009027
Bond Position:  [-18.48360092]


portfolio before change:  [-4.24405855]
curr_Stock_Price:  102.14598503393462
curr_Factors:  [102.14598503]
mat_Sqrt:  [[0.15]]
grads:  [-0.21110547]
Stock Position:  -0.21110546559398324
Bond Position:  [17.31951718]


portfolio before change:  [-4.14451285]
curr_Stock_Price:  101.68469605036418
curr_Factors:  [101.68469605]
mat_Sqrt:  [[0.15]]
grads:  [0.03499346]
Stock Position:  0.03499345855718242
Bond Position:  [-7.70281205]


portfolio before change:  [-4.13589821]
curr_Stock_Price:  101.95839155945869
curr_Factors:  [101.95839156]
mat_Sqrt:  [[0.15]]
grads:  [-0.04328495]
Stock Position:  -0.04328494918548777
Bond Position:  [0.27736559]


portfolio before change:  [-4.16266393]
curr_Stock_Price:  102.57755362943728
curr_Factors:  [102.57755363]
mat_Sqrt:  [[0.15]]
grads:  [-0.0438583]
Stock Position:  -0.043858302792186894
Bond Position:  [0.33621347]


portfolio before change:  [-4.15525462]
curr_Stock_Price:  102.40957432014238
curr_Factors:  [102.40957432]
mat_Sqrt:  [[0.15]]
grads:  [-0.00693677]
Stock Position:  -0.006936766928521075
Bond Position:  [-3.44486327]


portfolio before change:  [-4.15361072]
curr_Stock_Price:  102.11051092552778
curr_Factors:  [102.11051093]
mat_Sqrt:  [[0.15]]
grads:  [-0.07458649]
Stock Position:  -0.07458649212914548
Bond Position:  [3.4624541]


portfolio before change:  [-4.15541385]
curr_Stock_Price:  102.14048902472618
curr_Factors:  [102.14048902]
mat_Sqrt:  [[0.15]]
grads:  [0.14087341]
Stock Position:  0.14087341033356165
Bond Position:  [-18.54429287]


portfolio before change:  [-4.05160915]
curr_Stock_Price:  102.89380987859622
curr_Factors:  [102.89380988]
mat_Sqrt:  [[0.15]]
grads:  [-0.06169863]
Stock Position:  -0.06169863134688601
Bond Position:  [2.29679809]


portfolio before change:  [-4.04542452]
curr_Stock_Price:  102.79822408884966
curr_Factors:  [102.79822409]
mat_Sqrt:  [[0.15]]
grads:  [-0.01017715]
Stock Position:  -0.01017714748805221
Bond Position:  [-2.99923183]


portfolio before change:  [-4.05530054]
curr_Stock_Price:  103.73179517529083
curr_Factors:  [103.73179518]
mat_Sqrt:  [[0.15]]
grads:  [0.03201895]
Stock Position:  0.03201895410479415
Bond Position:  [-7.37668413]


portfolio before change:  [-4.0592994]
curr_Stock_Price:  103.63570466522786
curr_Factors:  [103.63570467]
mat_Sqrt:  [[0.15]]
grads:  [0.0361766]
Stock Position:  0.036176599331902724
Bond Position:  [-7.80848676]


portfolio before change:  [-3.99844532]
curr_Stock_Price:  105.34482618913844
curr_Factors:  [105.34482619]
mat_Sqrt:  [[0.15]]
grads:  [-0.01143396]
Stock Position:  -0.011433956993333686
Bond Position:  [-2.7939371]


portfolio before change:  [-3.99269553]
curr_Stock_Price:  104.81141082918863
curr_Factors:  [104.81141083]
mat_Sqrt:  [[0.15]]
grads:  [0.04693602]
Stock Position:  0.04693602255939231
Bond Position:  [-8.91212627]


portfolio before change:  [-3.97373231]
curr_Stock_Price:  105.23916989729825
curr_Factors:  [105.2391699]
mat_Sqrt:  [[0.15]]
grads:  [0.02964613]
Stock Position:  0.0296461296096555
Bond Position:  [-7.09366638]


portfolio before change:  [-3.98913234]
curr_Stock_Price:  104.74961955317696
curr_Factors:  [104.74961955]
mat_Sqrt:  [[0.15]]
grads:  [-0.14592817]
Stock Position:  -0.1459281694292255
Bond Position:  [11.29678789]


portfolio before change:  [-4.19336901]
curr_Stock_Price:  106.15886668791457
curr_Factors:  [106.15886669]
mat_Sqrt:  [[0.15]]
grads:  [0.06496684]
Stock Position:  0.06496683985289002
Bond Position:  [-11.0901751]


portfolio before change:  [-4.11436615]
curr_Stock_Price:  107.39625511164583
curr_Factors:  [107.39625511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.11436615]
Stock Price:  108.58325484843051
PL:  [-12.697621]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.88129002e-03]
 [ 2.47722583e-03]
 [ 1.30243559e-02]
 [-2.47080571e-03]
 [ 1.51027396e-02]
 [ 2.38472077e-02]
 [-5.50647260e-03]
 [ 2.23802292e-02]
 [-5.94792429e-03]
 [ 1.90859863e-03]
 [ 1.85495975e-03]
 [ 5.29601458e-03]
 [ 1.41958282e-02]
 [ 2.67052411e-03]
 [ 2.64597035e-03]
 [-3.34414886e-03]
 [ 1.45099532e-02]
 [-8.92468594e-03]
 [ 9.71127998e-03]
 [-8.58292361e-03]
 [ 1.76740771e-03]
 [ 1.95367638e-02]
 [-2.49746237e-02]
 [ 6.10705787e-03]
 [-2.22475512e-03]
 [-8.36883020e-03]
 [ 2.76152692e-03]
 [-1.12885928e-02]
 [ 3.44422620e-02]
 [-8.73813438e-03]
 [-4.72225345e-03]
 [ 4.48763831e-03]
 [ 6.15643817e-03]
 [ 1.78485716e-03]
 [ 8.18312237e-03]
 [ 3.31204181e-03]
 [-4.82947518e-02]
 [ 9.70923650e-03]
 [-1.11301082e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.32735788]
curr_Stock_Price:  100.3467472825307
curr_Factors:  [100.34674728]
mat_Sqrt:  [[0.15]]
grads:  [0.04587527]
Stock Position:  0.04587526679019766
Bond Position:  [2.72392408]


portfolio before change:  [7.30082917]
curr_Stock_Price:  99.76104560969124
curr_Factors:  [99.76104561]
mat_Sqrt:  [[0.15]]
grads:  [0.01651484]
Stock Position:  0.01651483884317772
Bond Position:  [5.65329158]


portfolio before change:  [7.31897908]
curr_Stock_Price:  100.81725942853069
curr_Factors:  [100.81725943]
mat_Sqrt:  [[0.15]]
grads:  [0.08682904]
Stock Position:  0.08682903918297977
Bond Position:  [-1.43488669]


portfolio before change:  [7.22885446]
curr_Stock_Price:  99.78137038789288
curr_Factors:  [99.78137039]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647204]
Stock Position:  -0.01647203805719158
Bond Position:  [8.87245699]


portfolio before change:  [7.21239237]
curr_Stock_Price:  100.84809985271217
curr_Factors:  [100.84809985]
mat_Sqrt:  [[0.15]]
grads:  [0.10068493]
Stock Position:  0.10068493076976526
Bond Position:  [-2.94149158]


portfolio before change:  [7.17587456]
curr_Stock_Price:  100.48905798012605
curr_Factors:  [100.48905798]
mat_Sqrt:  [[0.15]]
grads:  [0.15898138]
Stock Position:  0.15898138445732293
Bond Position:  [-8.800015]


portfolio before change:  [7.05255296]
curr_Stock_Price:  99.72027910941145
curr_Factors:  [99.72027911]
mat_Sqrt:  [[0.15]]
grads:  [-0.03670982]
Stock Position:  -0.03670981736543295
Bond Position:  [10.71326619]


portfolio before change:  [7.0461975]
curr_Stock_Price:  99.92988792258384
curr_Factors:  [99.92988792]
mat_Sqrt:  [[0.15]]
grads:  [0.14920153]
Stock Position:  0.14920152796459868
Bond Position:  [-7.86349447]


portfolio before change:  [7.07993191]
curr_Stock_Price:  100.16257595623553
curr_Factors:  [100.16257596]
mat_Sqrt:  [[0.15]]
grads:  [-0.03965283]
Stock Position:  -0.039652828615475574
Bond Position:  [11.05166137]


portfolio before change:  [7.14600845]
curr_Stock_Price:  98.53104049826334
curr_Factors:  [98.5310405]
mat_Sqrt:  [[0.15]]
grads:  [0.01272399]
Stock Position:  0.012723990897171052
Bond Position:  [5.89230039]


portfolio before change:  [7.15224811]
curr_Stock_Price:  98.96353684672751
curr_Factors:  [98.96353685]
mat_Sqrt:  [[0.15]]
grads:  [0.0123664]
Stock Position:  0.012366398356391025
Bond Position:  [5.9284256]


portfolio before change:  [7.15894036]
curr_Stock_Price:  99.4447722767131
curr_Factors:  [99.44477228]
mat_Sqrt:  [[0.15]]
grads:  [0.03530676]
Stock Position:  0.0353067638720892
Bond Position:  [3.64786727]


portfolio before change:  [7.15323014]
curr_Stock_Price:  99.27012477264302
curr_Factors:  [99.27012477]
mat_Sqrt:  [[0.15]]
grads:  [0.09463885]
Stock Position:  0.09463885491830076
Bond Position:  [-2.2415808]


portfolio before change:  [7.08002617]
curr_Stock_Price:  98.49957706655012
curr_Factors:  [98.49957707]
mat_Sqrt:  [[0.15]]
grads:  [0.01780349]
Stock Position:  0.017803494078513962
Bond Position:  [5.32638953]


portfolio before change:  [7.07082108]
curr_Stock_Price:  97.94513912310788
curr_Factors:  [97.94513912]
mat_Sqrt:  [[0.15]]
grads:  [0.0176398]
Stock Position:  0.017639802304026432
Bond Position:  [5.34308819]


portfolio before change:  [7.07179731]
curr_Stock_Price:  97.96261708607032
curr_Factors:  [97.96261709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229433]
Stock Position:  -0.02229432570154131
Bond Position:  [9.2558078]


portfolio before change:  [7.07170798]
curr_Stock_Price:  98.01852298080097
curr_Factors:  [98.01852298]
mat_Sqrt:  [[0.15]]
grads:  [0.09673302]
Stock Position:  0.09673302134845946
Bond Position:  [-2.4099199]


portfolio before change:  [7.06014788]
curr_Stock_Price:  97.90213209574014
curr_Factors:  [97.9021321]
mat_Sqrt:  [[0.15]]
grads:  [-0.05949791]
Stock Position:  -0.059497906297764386
Bond Position:  [12.88511976]


portfolio before change:  [6.99361256]
curr_Stock_Price:  99.04748432496471
curr_Factors:  [99.04748432]
mat_Sqrt:  [[0.15]]
grads:  [0.06474187]
Stock Position:  0.06474186652205394
Bond Position:  [0.58109355]


portfolio before change:  [6.9683974]
curr_Stock_Price:  98.65689010206533
curr_Factors:  [98.6568901]
mat_Sqrt:  [[0.15]]
grads:  [-0.05721949]
Stock Position:  -0.05721949076551482
Bond Position:  [12.61349441]


portfolio before change:  [6.92038534]
curr_Stock_Price:  99.52353268471045
curr_Factors:  [99.52353268]
mat_Sqrt:  [[0.15]]
grads:  [0.01178272]
Stock Position:  0.011782718079933127
Bond Position:  [5.74772761]


portfolio before change:  [6.93804542]
curr_Stock_Price:  100.96136494634753
curr_Factors:  [100.96136495]
mat_Sqrt:  [[0.15]]
grads:  [0.13024509]
Stock Position:  0.13024509222198694
Bond Position:  [-6.21167687]


portfolio before change:  [7.01527341]
curr_Stock_Price:  101.56027043570953
curr_Factors:  [101.56027044]
mat_Sqrt:  [[0.15]]
grads:  [-0.16649749]
Stock Position:  -0.16649749113502196
Bond Position:  [23.92480364]


portfolio before change:  [7.06982758]
curr_Stock_Price:  101.25057578869374
curr_Factors:  [101.25057579]
mat_Sqrt:  [[0.15]]
grads:  [0.04071372]
Stock Position:  0.040713719141194975
Bond Position:  [2.94754008]


portfolio before change:  [7.02414507]
curr_Stock_Price:  100.11948341305383
curr_Factors:  [100.11948341]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148317]
Stock Position:  -0.014831700789350115
Bond Position:  [8.50908729]


portfolio before change:  [7.01882266]
curr_Stock_Price:  100.55005533876249
curr_Factors:  [100.55005534]
mat_Sqrt:  [[0.15]]
grads:  [-0.0557922]
Stock Position:  -0.05579220132304004
Bond Position:  [12.62873159]


portfolio before change:  [7.00683844]
curr_Stock_Price:  100.79315224366846
curr_Factors:  [100.79315224]
mat_Sqrt:  [[0.15]]
grads:  [0.01841018]
Stock Position:  0.018410179459002154
Bond Position:  [5.15121842]


portfolio before change:  [7.02052441]
curr_Stock_Price:  101.50156620475056
curr_Factors:  [101.5015662]
mat_Sqrt:  [[0.15]]
grads:  [-0.07525729]
Stock Position:  -0.07525728528917348
Bond Position:  [14.65925673]


portfolio before change:  [6.94454689]
curr_Stock_Price:  102.53548655833492
curr_Factors:  [102.53548656]
mat_Sqrt:  [[0.15]]
grads:  [0.22961508]
Stock Position:  0.22961507987606147
Bond Position:  [-16.59914705]


portfolio before change:  [7.07374085]
curr_Stock_Price:  103.10717803046442
curr_Factors:  [103.10717803]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825423]
Stock Position:  -0.058254229188352526
Bond Position:  [13.08017003]


portfolio before change:  [7.03650699]
curr_Stock_Price:  103.77440828732448
curr_Factors:  [103.77440829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148169]
Stock Position:  -0.03148168963520576
Bond Position:  [10.3035007]


portfolio before change:  [6.98959634]
curr_Stock_Price:  105.30541465208279
curr_Factors:  [105.30541465]
mat_Sqrt:  [[0.15]]
grads:  [0.02991759]
Stock Position:  0.029917588747716783
Bond Position:  [3.83911225]


portfolio before change:  [7.01738438]
curr_Stock_Price:  106.21819267006703
curr_Factors:  [106.21819267]
mat_Sqrt:  [[0.15]]
grads:  [0.04104292]
Stock Position:  0.041042921149904536
Bond Position:  [2.65787947]


portfolio before change:  [7.04799833]
curr_Stock_Price:  106.95599820776366
curr_Factors:  [106.95599821]
mat_Sqrt:  [[0.15]]
grads:  [0.01189905]
Stock Position:  0.011899047711969545
Bond Position:  [5.7753238]


portfolio before change:  [7.05735885]
curr_Stock_Price:  107.68198603353187
curr_Factors:  [107.68198603]
mat_Sqrt:  [[0.15]]
grads:  [0.05455415]
Stock Position:  0.05455414915290727
Bond Position:  [1.18285972]


portfolio before change:  [7.04930188]
curr_Stock_Price:  107.5315880135047
curr_Factors:  [107.53158801]
mat_Sqrt:  [[0.15]]
grads:  [0.02208028]
Stock Position:  0.022080278704329968
Bond Position:  [4.67497445]


portfolio before change:  [7.03944182]
curr_Stock_Price:  107.0585652679942
curr_Factors:  [107.05856527]
mat_Sqrt:  [[0.15]]
grads:  [-0.32196501]
Stock Position:  -0.3219650121087333
Bond Position:  [41.50855408]


portfolio before change:  [7.28001335]
curr_Stock_Price:  106.32748382720897
curr_Factors:  [106.32748383]
mat_Sqrt:  [[0.15]]
grads:  [0.06472824]
Stock Position:  0.06472824331701983
Bond Position:  [0.39762211]


portfolio before change:  [7.19032289]
curr_Stock_Price:  104.94106934968765
curr_Factors:  [104.94106935]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.19032289]
Stock Price:  106.95942959023272
PL:  [0.2308933]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.49911144e-03]
 [ 2.14592618e-03]
 [ 1.48281257e-02]
 [-9.34465303e-04]
 [ 1.51393803e-02]
 [ 3.19391779e-03]
 [-6.34710858e-04]
 [ 2.31065449e-02]
 [-5.90846391e-03]
 [ 3.63264034e-03]
 [ 9.44667030e-03]
 [ 4.06817779e-03]
 [ 1.30573536e-02]
 [ 4.75138536e-03]
 [ 1.87718528e-02]
 [-3.32669430e-03]
 [ 1.76048657e-02]
 [-1.25051887e-02]
 [ 6.16077131e-03]
 [-5.17145413e-03]
 [ 1.92078486e-02]
 [-2.88814705e-03]
 [ 2.32914308e-02]
 [ 3.94563327e-03]
 [ 1.19467571e-02]
 [ 1.44477796e-02]
 [ 3.17303016e-02]
 [-2.39493490e-02]
 [-4.76491779e-02]
 [ 3.98276683e-04]
 [-4.33372984e-03]
 [ 5.58347331e-03]
 [ 1.50708891e-02]
 [-1.47230257e-02]
 [ 4.62980735e-03]
 [ 3.81555898e-03]
 [ 1.09888175e-02]
 [ 6.70410425e-03]
 [-8.36467814e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.66636011]
curr_Stock_Price:  100.4331254717837
curr_Factors:  [100.43312547]
mat_Sqrt:  [[0.15]]
grads:  [0.04332741]
Stock Position:  0.04332740957185521
Bond Position:  [4.31485295]


portfolio before change:  [8.68918626]
curr_Stock_Price:  100.94750551452334
curr_Factors:  [100.94750551]
mat_Sqrt:  [[0.15]]
grads:  [0.01430617]
Stock Position:  0.014306174564237285
Bond Position:  [7.24501362]


portfolio before change:  [8.70170381]
curr_Stock_Price:  101.75917386260906
curr_Factors:  [101.75917386]
mat_Sqrt:  [[0.15]]
grads:  [0.09885417]
Stock Position:  0.09885417164450833
Bond Position:  [-1.35761503]


portfolio before change:  [8.61830744]
curr_Stock_Price:  100.91726042542311
curr_Factors:  [100.91726043]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622977]
Stock Position:  -0.006229768685823719
Bond Position:  [9.24699863]


portfolio before change:  [8.62010156]
curr_Stock_Price:  100.81482208976882
curr_Factors:  [100.81482209]
mat_Sqrt:  [[0.15]]
grads:  [0.1009292]
Stock Position:  0.10092920199679803
Bond Position:  [-1.55505799]


portfolio before change:  [8.48549169]
curr_Stock_Price:  99.48304232745157
curr_Factors:  [99.48304233]
mat_Sqrt:  [[0.15]]
grads:  [0.02129279]
Stock Position:  0.02129278524462532
Bond Position:  [6.36722064]


portfolio before change:  [8.5027134]
curr_Stock_Price:  100.25446582047576
curr_Factors:  [100.25446582]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423141]
Stock Position:  -0.004231405720583713
Bond Position:  [8.92693072]


portfolio before change:  [8.50633655]
curr_Stock_Price:  99.66194097312142
curr_Factors:  [99.66194097]
mat_Sqrt:  [[0.15]]
grads:  [0.15404363]
Stock Position:  0.15404363271831836
Bond Position:  [-6.84595088]


portfolio before change:  [8.51473139]
curr_Stock_Price:  99.72199305394398
curr_Factors:  [99.72199305]
mat_Sqrt:  [[0.15]]
grads:  [-0.03938976]
Stock Position:  -0.03938975943263943
Bond Position:  [12.44275671]


portfolio before change:  [8.51413443]
curr_Stock_Price:  99.77663694188875
curr_Factors:  [99.77663694]
mat_Sqrt:  [[0.15]]
grads:  [0.0242176]
Stock Position:  0.024217602234197687
Bond Position:  [6.09778352]


portfolio before change:  [8.52981366]
curr_Stock_Price:  100.39259248775339
curr_Factors:  [100.39259249]
mat_Sqrt:  [[0.15]]
grads:  [0.0629778]
Stock Position:  0.06297780197543527
Bond Position:  [2.20730885]


portfolio before change:  [8.5481846]
curr_Stock_Price:  100.67991603936548
curr_Factors:  [100.67991604]
mat_Sqrt:  [[0.15]]
grads:  [0.02712119]
Stock Position:  0.02712118526905886
Bond Position:  [5.81762594]


portfolio before change:  [8.52129999]
curr_Stock_Price:  99.66182419409195
curr_Factors:  [99.66182419]
mat_Sqrt:  [[0.15]]
grads:  [0.08704902]
Stock Position:  0.0870490237084277
Bond Position:  [-0.15416451]


portfolio before change:  [8.49623167]
curr_Stock_Price:  99.37406624911132
curr_Factors:  [99.37406625]
mat_Sqrt:  [[0.15]]
grads:  [0.0316759]
Stock Position:  0.031675902389389124
Bond Position:  [5.34846845]


portfolio before change:  [8.52233288]
curr_Stock_Price:  100.17696697100367
curr_Factors:  [100.17696697]
mat_Sqrt:  [[0.15]]
grads:  [0.12514569]
Stock Position:  0.12514568525480185
Bond Position:  [-4.0143823]


portfolio before change:  [8.25817791]
curr_Stock_Price:  98.07019732022611
curr_Factors:  [98.07019732]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217796]
Stock Position:  -0.022177961999457024
Bond Position:  [10.43317502]


portfolio before change:  [8.28720311]
curr_Stock_Price:  96.820264143466
curr_Factors:  [96.82026414]
mat_Sqrt:  [[0.15]]
grads:  [0.11736577]
Stock Position:  0.11736577106457823
Bond Position:  [-3.07618184]


portfolio before change:  [8.28618825]
curr_Stock_Price:  96.81489359375746
curr_Factors:  [96.81489359]
mat_Sqrt:  [[0.15]]
grads:  [-0.08336792]
Stock Position:  -0.08336792490292926
Bond Position:  [16.35744503]


portfolio before change:  [8.20305788]
curr_Stock_Price:  97.83657159849766
curr_Factors:  [97.8365716]
mat_Sqrt:  [[0.15]]
grads:  [0.04107181]
Stock Position:  0.041071808717136706
Bond Position:  [4.18473293]


portfolio before change:  [8.20739977]
curr_Stock_Price:  97.92954928368825
curr_Factors:  [97.92954928]
mat_Sqrt:  [[0.15]]
grads:  [-0.03447636]
Stock Position:  -0.03447636087507694
Bond Position:  [11.58365425]


portfolio before change:  [8.22105925]
curr_Stock_Price:  97.57535196736454
curr_Factors:  [97.57535197]
mat_Sqrt:  [[0.15]]
grads:  [0.12805232]
Stock Position:  0.12805232430961544
Bond Position:  [-4.27369137]


portfolio before change:  [8.12064888]
curr_Stock_Price:  96.79538861682431
curr_Factors:  [96.79538862]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925431]
Stock Position:  -0.019254313641861066
Bond Position:  [9.98437766]


portfolio before change:  [8.11685661]
curr_Stock_Price:  97.05716876336807
curr_Factors:  [97.05716876]
mat_Sqrt:  [[0.15]]
grads:  [0.15527621]
Stock Position:  0.1552762054750678
Bond Position:  [-6.95381227]


portfolio before change:  [8.0158306]
curr_Stock_Price:  96.41214571969527
curr_Factors:  [96.41214572]
mat_Sqrt:  [[0.15]]
grads:  [0.02630422]
Stock Position:  0.02630422176791244
Bond Position:  [5.47978414]


portfolio before change:  [7.9777253]
curr_Stock_Price:  94.93746529954474
curr_Factors:  [94.9374653]
mat_Sqrt:  [[0.15]]
grads:  [0.07964505]
Stock Position:  0.07964504732791239
Bond Position:  [0.41642638]


portfolio before change:  [7.89848073]
curr_Stock_Price:  93.94183999327922
curr_Factors:  [93.94183999]
mat_Sqrt:  [[0.15]]
grads:  [0.09631853]
Stock Position:  0.09631853096014792
Bond Position:  [-1.1498593]


portfolio before change:  [7.89521079]
curr_Stock_Price:  93.90938312910234
curr_Factors:  [93.90938313]
mat_Sqrt:  [[0.15]]
grads:  [0.21153534]
Stock Position:  0.21153534412103234
Bond Position:  [-11.96994289]


portfolio before change:  [8.07540333]
curr_Stock_Price:  94.76828866062617
curr_Factors:  [94.76828866]
mat_Sqrt:  [[0.15]]
grads:  [-0.15966233]
Stock Position:  -0.15966232684003615
Bond Position:  [23.20632881]


portfolio before change:  [7.94394227]
curr_Stock_Price:  95.60982737680085
curr_Factors:  [95.60982738]
mat_Sqrt:  [[0.15]]
grads:  [-0.31766119]
Stock Position:  -0.31766118576386126
Bond Position:  [38.31547341]


portfolio before change:  [7.71445944]
curr_Stock_Price:  96.34731931564457
curr_Factors:  [96.34731932]
mat_Sqrt:  [[0.15]]
grads:  [0.00265518]
Stock Position:  0.0026551778840648434
Bond Position:  [7.45864017]


portfolio before change:  [7.71097254]
curr_Stock_Price:  94.68291532692429
curr_Factors:  [94.68291533]
mat_Sqrt:  [[0.15]]
grads:  [-0.02889153]
Stock Position:  -0.0288915322824281
Bond Position:  [10.44650705]


portfolio before change:  [7.70014004]
curr_Stock_Price:  95.10305228579816
curr_Factors:  [95.10305229]
mat_Sqrt:  [[0.15]]
grads:  [0.03722316]
Stock Position:  0.03722315539050869
Bond Position:  [4.16010434]


portfolio before change:  [7.6963166]
curr_Stock_Price:  94.98636469436723
curr_Factors:  [94.98636469]
mat_Sqrt:  [[0.15]]
grads:  [0.10047259]
Stock Position:  0.10047259424278758
Bond Position:  [-1.84720988]


portfolio before change:  [7.52846209]
curr_Stock_Price:  93.31801325414546
curr_Factors:  [93.31801325]
mat_Sqrt:  [[0.15]]
grads:  [-0.0981535]
Stock Position:  -0.09815350447090974
Bond Position:  [16.68795212]


portfolio before change:  [7.53620084]
curr_Stock_Price:  93.26042360594998
curr_Factors:  [93.26042361]
mat_Sqrt:  [[0.15]]
grads:  [0.03086538]
Stock Position:  0.030865382346932715
Bond Position:  [4.65768221]


portfolio before change:  [7.49984776]
curr_Stock_Price:  92.0637650623731
curr_Factors:  [92.06376506]
mat_Sqrt:  [[0.15]]
grads:  [0.02543706]
Stock Position:  0.025437059895499766
Bond Position:  [5.15801626]


portfolio before change:  [7.47048053]
curr_Stock_Price:  90.88391074960136
curr_Factors:  [90.88391075]
mat_Sqrt:  [[0.15]]
grads:  [0.07325878]
Stock Position:  0.07325878336043026
Bond Position:  [0.8124358]


portfolio before change:  [7.49665113]
curr_Stock_Price:  91.23975937971859
curr_Factors:  [91.23975938]
mat_Sqrt:  [[0.15]]
grads:  [0.04469403]
Stock Position:  0.044694028325766764
Bond Position:  [3.41877874]


portfolio before change:  [7.4235812]
curr_Stock_Price:  89.59530478002834
curr_Factors:  [89.59530478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.4235812]
Stock Price:  89.22482702062774
PL:  [7.4235812]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.37139862e-03]
 [ 3.46575742e-03]
 [ 1.52553194e-02]
 [-2.92515555e-03]
 [ 1.54846483e-02]
 [ 1.84164731e-02]
 [-6.66308575e-03]
 [ 2.30416538e-02]
 [-5.85863454e-03]
 [ 4.77618652e-03]
 [ 2.29337798e-03]
 [ 4.05930375e-03]
 [ 1.41973729e-02]
 [ 5.35405803e-03]
 [ 1.46278733e-02]
 [-3.42768572e-04]
 [ 9.07815960e-03]
 [ 1.33448673e-02]
 [ 1.16637121e-02]
 [-1.33062451e-02]
 [-8.07127059e-03]
 [ 2.09129160e-02]
 [-1.80120753e-02]
 [ 6.15793786e-03]
 [-8.18144675e-03]
 [-6.44060186e-03]
 [-1.00822993e-03]
 [-1.07452667e-02]
 [ 5.43897200e-02]
 [-8.24563576e-03]
 [-3.42833127e-03]
 [ 4.82164591e-03]
 [ 5.77140374e-03]
 [-2.45266650e-03]
 [ 7.55396392e-03]
 [ 4.33472379e-03]
 [-4.06861229e-02]
 [ 9.57128057e-03]
 [-7.48304786e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.11790941]
curr_Stock_Price:  100.4622546320976
curr_Factors:  [100.46225463]
mat_Sqrt:  [[0.15]]
grads:  [0.04247599]
Stock Position:  0.042475990781566865
Bond Position:  [4.85067561]


portfolio before change:  [9.12631263]
curr_Stock_Price:  100.64581347495519
curr_Factors:  [100.64581347]
mat_Sqrt:  [[0.15]]
grads:  [0.02310505]
Stock Position:  0.023105049440393148
Bond Position:  [6.80088613]


portfolio before change:  [9.14377289]
curr_Stock_Price:  101.36470843801202
curr_Factors:  [101.36470844]
mat_Sqrt:  [[0.15]]
grads:  [0.10170213]
Stock Position:  0.1017021291950937
Bond Position:  [-1.16523378]


portfolio before change:  [9.01688081]
curr_Stock_Price:  100.11845706932588
curr_Factors:  [100.11845707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950104]
Stock Position:  -0.019501036978619806
Bond Position:  [10.96929455]


portfolio before change:  [9.01450072]
curr_Stock_Price:  100.31082300792993
curr_Factors:  [100.31082301]
mat_Sqrt:  [[0.15]]
grads:  [0.10323099]
Stock Position:  0.10323098833856963
Bond Position:  [-1.34068468]


portfolio before change:  [8.99694271]
curr_Stock_Price:  100.1423617468182
curr_Factors:  [100.14236175]
mat_Sqrt:  [[0.15]]
grads:  [0.12277649]
Stock Position:  0.12277648718362902
Bond Position:  [-3.29818469]


portfolio before change:  [8.92541247]
curr_Stock_Price:  99.56311452023574
curr_Factors:  [99.56311452]
mat_Sqrt:  [[0.15]]
grads:  [-0.04442057]
Stock Position:  -0.04442057167489635
Bond Position:  [13.34806293]


portfolio before change:  [8.92089506]
curr_Stock_Price:  99.70237470203618
curr_Factors:  [99.7023747]
mat_Sqrt:  [[0.15]]
grads:  [0.15361103]
Stock Position:  0.15361102533265564
Bond Position:  [-6.39448894]


portfolio before change:  [8.88961894]
curr_Stock_Price:  99.50397250217115
curr_Factors:  [99.5039725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03905756]
Stock Position:  -0.03905756359579053
Bond Position:  [12.77600167]


portfolio before change:  [8.90500191]
curr_Stock_Price:  99.15100946580071
curr_Factors:  [99.15100947]
mat_Sqrt:  [[0.15]]
grads:  [0.03184124]
Stock Position:  0.03184124349472202
Bond Position:  [5.74791048]


portfolio before change:  [8.90317174]
curr_Stock_Price:  99.07096524117891
curr_Factors:  [99.07096524]
mat_Sqrt:  [[0.15]]
grads:  [0.01528919]
Stock Position:  0.015289186566033921
Bond Position:  [7.38845727]


portfolio before change:  [8.92118091]
curr_Stock_Price:  100.1884582549716
curr_Factors:  [100.18845825]
mat_Sqrt:  [[0.15]]
grads:  [0.02706203]
Stock Position:  0.0270620250100244
Bond Position:  [6.20987835]


portfolio before change:  [8.90406093]
curr_Stock_Price:  99.52715279481934
curr_Factors:  [99.52715279]
mat_Sqrt:  [[0.15]]
grads:  [0.09464915]
Stock Position:  0.09464915237455745
Bond Position:  [-0.51609972]


portfolio before change:  [8.92833272]
curr_Stock_Price:  99.78427401854312
curr_Factors:  [99.78427402]
mat_Sqrt:  [[0.15]]
grads:  [0.03569372]
Stock Position:  0.03569372022285465
Bond Position:  [5.36666076]


portfolio before change:  [8.92454912]
curr_Stock_Price:  99.65947696143357
curr_Factors:  [99.65947696]
mat_Sqrt:  [[0.15]]
grads:  [0.09751916]
Stock Position:  0.09751915532065898
Bond Position:  [-0.79415889]


portfolio before change:  [8.98433453]
curr_Stock_Price:  100.27355823157792
curr_Factors:  [100.27355823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00228512]
Stock Position:  -0.0022851238125853332
Bond Position:  [9.21347203]


portfolio before change:  [8.98271176]
curr_Stock_Price:  101.4877307401306
curr_Factors:  [101.48773074]
mat_Sqrt:  [[0.15]]
grads:  [0.06052106]
Stock Position:  0.060521064003821644
Bond Position:  [2.84056631]


portfolio before change:  [8.93759754]
curr_Stock_Price:  100.73643344002633
curr_Factors:  [100.73643344]
mat_Sqrt:  [[0.15]]
grads:  [0.08896578]
Stock Position:  0.0889657820207535
Bond Position:  [-0.02449804]


portfolio before change:  [9.00180763]
curr_Stock_Price:  101.45820708202861
curr_Factors:  [101.45820708]
mat_Sqrt:  [[0.15]]
grads:  [0.07775808]
Stock Position:  0.07775808082498684
Bond Position:  [1.11261216]


portfolio before change:  [8.98153879]
curr_Stock_Price:  101.19575303995101
curr_Factors:  [101.19575304]
mat_Sqrt:  [[0.15]]
grads:  [-0.0887083]
Stock Position:  -0.08870830046405812
Bond Position:  [17.95844206]


portfolio before change:  [8.89311703]
curr_Stock_Price:  102.21783001909758
curr_Factors:  [102.21783002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380847]
Stock Position:  -0.05380847059042733
Bond Position:  [14.39330213]


portfolio before change:  [8.94808057]
curr_Stock_Price:  101.22980216142862
curr_Factors:  [101.22980216]
mat_Sqrt:  [[0.15]]
grads:  [0.13941944]
Stock Position:  0.13941943982762334
Bond Position:  [-5.16532174]


portfolio before change:  [8.91881078]
curr_Stock_Price:  101.02449300393405
curr_Factors:  [101.024493]
mat_Sqrt:  [[0.15]]
grads:  [-0.1200805]
Stock Position:  -0.12008050191936653
Bond Position:  [21.0498826]


portfolio before change:  [8.88426176]
curr_Stock_Price:  101.3341220822446
curr_Factors:  [101.33412208]
mat_Sqrt:  [[0.15]]
grads:  [0.04105292]
Stock Position:  0.041052919089361525
Bond Position:  [4.72420025]


portfolio before change:  [8.88527857]
curr_Stock_Price:  101.3445048010481
curr_Factors:  [101.3445048]
mat_Sqrt:  [[0.15]]
grads:  [-0.05454298]
Stock Position:  -0.054542978340473655
Bond Position:  [14.4129097]


portfolio before change:  [8.85912468]
curr_Stock_Price:  101.85704760568781
curr_Factors:  [101.85704761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293735]
Stock Position:  -0.04293734571385311
Bond Position:  [13.23259595]


portfolio before change:  [8.82548932]
curr_Stock_Price:  102.67893212839927
curr_Factors:  [102.67893213]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672153]
Stock Position:  -0.006721532899570075
Bond Position:  [9.51564914]


portfolio before change:  [8.82386055]
curr_Stock_Price:  103.09822616218443
curr_Factors:  [103.09822616]
mat_Sqrt:  [[0.15]]
grads:  [-0.07163511]
Stock Position:  -0.07163511105887092
Bond Position:  [16.20931343]


portfolio before change:  [8.75015443]
curr_Stock_Price:  104.15542293970489
curr_Factors:  [104.15542294]
mat_Sqrt:  [[0.15]]
grads:  [0.36259813]
Stock Position:  0.362598133461105
Bond Position:  [-29.01640752]


portfolio before change:  [8.44018433]
curr_Stock_Price:  103.31056798553034
curr_Factors:  [103.31056799]
mat_Sqrt:  [[0.15]]
grads:  [-0.05497091]
Stock Position:  -0.05497090506467634
Bond Position:  [14.11925975]


portfolio before change:  [8.44073093]
curr_Stock_Price:  103.33273276340447
curr_Factors:  [103.33273276]
mat_Sqrt:  [[0.15]]
grads:  [-0.02285554]
Stock Position:  -0.022855541796504137
Bond Position:  [10.80245652]


portfolio before change:  [8.43510599]
curr_Stock_Price:  103.63792466588488
curr_Factors:  [103.63792467]
mat_Sqrt:  [[0.15]]
grads:  [0.03214431]
Stock Position:  0.03214430603353295
Bond Position:  [5.10373682]


portfolio before change:  [8.46084867]
curr_Stock_Price:  104.41892376378017
curr_Factors:  [104.41892376]
mat_Sqrt:  [[0.15]]
grads:  [0.03847602]
Stock Position:  0.03847602492469519
Bond Position:  [4.44322356]


portfolio before change:  [8.48396518]
curr_Stock_Price:  105.0052908634004
curr_Factors:  [105.00529086]
mat_Sqrt:  [[0.15]]
grads:  [-0.01635111]
Stock Position:  -0.01635111001081374
Bond Position:  [10.20091825]


portfolio before change:  [8.47276503]
curr_Stock_Price:  105.76825760062502
curr_Factors:  [105.7682576]
mat_Sqrt:  [[0.15]]
grads:  [0.05035976]
Stock Position:  0.05035975949779131
Bond Position:  [3.14630101]


portfolio before change:  [8.45924789]
curr_Stock_Price:  105.49203603556845
curr_Factors:  [105.49203604]
mat_Sqrt:  [[0.15]]
grads:  [0.02889816]
Stock Position:  0.028898158597446245
Bond Position:  [5.4107223]


portfolio before change:  [8.48662963]
curr_Stock_Price:  106.41615571076768
curr_Factors:  [106.41615571]
mat_Sqrt:  [[0.15]]
grads:  [-0.27124082]
Stock Position:  -0.2712408191898674
Bond Position:  [37.35103488]


portfolio before change:  [8.33905453]
curr_Stock_Price:  106.97744390693155
curr_Factors:  [106.97744391]
mat_Sqrt:  [[0.15]]
grads:  [0.06380854]
Stock Position:  0.06380853714643317
Bond Position:  [1.51298032]


portfolio before change:  [8.30172583]
curr_Stock_Price:  106.38946879492556
curr_Factors:  [106.38946879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.30172583]
Stock Price:  106.64517666990149
PL:  [1.65654916]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.87932278e-03]
 [ 4.51092185e-03]
 [ 1.51584389e-02]
 [ 2.72256411e-03]
 [ 1.25361558e-02]
 [ 2.67284421e-02]
 [-5.93803339e-03]
 [ 1.11556305e-02]
 [-6.46618413e-03]
 [ 9.22350762e-04]
 [ 2.43295970e-03]
 [ 6.67888039e-03]
 [ 1.15273306e-02]
 [-3.27614456e-05]
 [ 1.94861786e-02]
 [ 1.31847196e-03]
 [ 8.76751649e-03]
 [ 1.35749498e-02]
 [ 1.14740700e-02]
 [-1.53346523e-02]
 [ 1.73169717e-03]
 [ 2.23257724e-02]
 [-3.56038417e-02]
 [ 5.98063114e-03]
 [ 4.43821596e-04]
 [-9.32015442e-03]
 [-3.92665844e-04]
 [-1.12405020e-02]
 [ 6.25251069e-02]
 [-3.00794315e-03]
 [-1.00763216e-02]
 [ 4.24131547e-03]
 [ 6.69878792e-03]
 [ 5.78384922e-03]
 [ 8.21305255e-03]
 [ 1.79060682e-03]
 [-9.37735574e-02]
 [ 8.89212355e-03]
 [ 6.95137347e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.98293672]
curr_Stock_Price:  100.32452889056718
curr_Factors:  [100.32452889]
mat_Sqrt:  [[0.15]]
grads:  [0.04586215]
Stock Position:  0.04586215188535749
Bond Position:  [2.38183794]


portfolio before change:  [6.98603542]
curr_Stock_Price:  100.3856022160617
curr_Factors:  [100.38560222]
mat_Sqrt:  [[0.15]]
grads:  [0.03007281]
Stock Position:  0.030072812347127477
Bond Position:  [3.96715804]


portfolio before change:  [7.01522237]
curr_Stock_Price:  101.33965404007066
curr_Factors:  [101.33965404]
mat_Sqrt:  [[0.15]]
grads:  [0.10105626]
Stock Position:  0.10105625905040568
Bond Position:  [-3.22578396]


portfolio before change:  [7.02408278]
curr_Stock_Price:  101.43132244115844
curr_Factors:  [101.43132244]
mat_Sqrt:  [[0.15]]
grads:  [0.01815043]
Stock Position:  0.018150427388314433
Bond Position:  [5.18306093]


portfolio before change:  [7.03474335]
curr_Stock_Price:  101.9829703680695
curr_Factors:  [101.98297037]
mat_Sqrt:  [[0.15]]
grads:  [0.08357437]
Stock Position:  0.08357437222767689
Bond Position:  [-1.48841937]


portfolio before change:  [7.00919575]
curr_Stock_Price:  101.67950964809062
curr_Factors:  [101.67950965]
mat_Sqrt:  [[0.15]]
grads:  [0.17818961]
Stock Position:  0.17818961412187437
Bond Position:  [-11.10903684]


portfolio before change:  [6.91439263]
curr_Stock_Price:  101.15526809195813
curr_Factors:  [101.15526809]
mat_Sqrt:  [[0.15]]
grads:  [-0.03958689]
Stock Position:  -0.03958688928890642
Bond Position:  [10.91881503]


portfolio before change:  [6.89531283]
curr_Stock_Price:  101.67172032717001
curr_Factors:  [101.67172033]
mat_Sqrt:  [[0.15]]
grads:  [0.07437087]
Stock Position:  0.07437086996551469
Bond Position:  [-0.66610146]


portfolio before change:  [6.83018234]
curr_Stock_Price:  100.7970872753261
curr_Factors:  [100.79708728]
mat_Sqrt:  [[0.15]]
grads:  [-0.04310789]
Stock Position:  -0.043107894211548696
Bond Position:  [11.17533252]


portfolio before change:  [6.84779655]
curr_Stock_Price:  100.42088690321694
curr_Factors:  [100.4208869]
mat_Sqrt:  [[0.15]]
grads:  [0.00614901]
Stock Position:  0.006149005082557666
Bond Position:  [6.23030801]


portfolio before change:  [6.84048503]
curr_Stock_Price:  99.10516783243341
curr_Factors:  [99.10516783]
mat_Sqrt:  [[0.15]]
grads:  [0.01621973]
Stock Position:  0.016219731334652668
Bond Position:  [5.23302583]


portfolio before change:  [6.83574572]
curr_Stock_Price:  98.77264222872542
curr_Factors:  [98.77264223]
mat_Sqrt:  [[0.15]]
grads:  [0.04452587]
Stock Position:  0.044525869271533514
Bond Position:  [2.43780797]


portfolio before change:  [6.89870122]
curr_Stock_Price:  100.17970630692048
curr_Factors:  [100.17970631]
mat_Sqrt:  [[0.15]]
grads:  [0.07684887]
Stock Position:  0.07684887044311142
Bond Position:  [-0.79999605]


portfolio before change:  [6.94702603]
curr_Stock_Price:  100.8098368581825
curr_Factors:  [100.80983686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00021841]
Stock Position:  -0.00021840963754970327
Bond Position:  [6.96904387]


portfolio before change:  [6.9480143]
curr_Stock_Price:  100.27377451115667
curr_Factors:  [100.27377451]
mat_Sqrt:  [[0.15]]
grads:  [0.12990786]
Stock Position:  0.12990785727666235
Bond Position:  [-6.07833689]


portfolio before change:  [7.04485042]
curr_Stock_Price:  101.02504516483481
curr_Factors:  [101.02504516]
mat_Sqrt:  [[0.15]]
grads:  [0.00878981]
Stock Position:  0.008789813085451056
Bond Position:  [6.15685916]


portfolio before change:  [7.05793725]
curr_Stock_Price:  102.42634668253312
curr_Factors:  [102.42634668]
mat_Sqrt:  [[0.15]]
grads:  [0.05845011]
Stock Position:  0.05845010993107616
Bond Position:  [1.07110603]


portfolio before change:  [6.97247309]
curr_Stock_Price:  100.96188305494222
curr_Factors:  [100.96188305]
mat_Sqrt:  [[0.15]]
grads:  [0.09049967]
Stock Position:  0.09049966562069635
Bond Position:  [-2.16454357]


portfolio before change:  [7.09102084]
curr_Stock_Price:  102.27479772797493
curr_Factors:  [102.27479773]
mat_Sqrt:  [[0.15]]
grads:  [0.0764938]
Stock Position:  0.07649380003758642
Bond Position:  [-0.73236708]


portfolio before change:  [7.15985108]
curr_Stock_Price:  103.17580919303347
curr_Factors:  [103.17580919]
mat_Sqrt:  [[0.15]]
grads:  [-0.10223102]
Stock Position:  -0.1022310151223862
Bond Position:  [17.70761879]


portfolio before change:  [7.15692064]
curr_Stock_Price:  103.22612690200457
curr_Factors:  [103.2261269]
mat_Sqrt:  [[0.15]]
grads:  [0.01154465]
Stock Position:  0.011544647818814749
Bond Position:  [5.96521136]


portfolio before change:  [7.14261895]
curr_Stock_Price:  101.92271869184998
curr_Factors:  [101.92271869]
mat_Sqrt:  [[0.15]]
grads:  [0.14883848]
Stock Position:  0.14883848278099368
Bond Position:  [-8.02740386]


portfolio before change:  [7.22696]
curr_Stock_Price:  102.49612237460198
curr_Factors:  [102.49612237]
mat_Sqrt:  [[0.15]]
grads:  [-0.23735894]
Stock Position:  -0.23735894433728344
Bond Position:  [31.5553314]


portfolio before change:  [7.15810535]
curr_Stock_Price:  102.802827939631
curr_Factors:  [102.80282794]
mat_Sqrt:  [[0.15]]
grads:  [0.03987087]
Stock Position:  0.03987087424998891
Bond Position:  [3.05926673]


portfolio before change:  [7.16262247]
curr_Stock_Price:  102.90652976009456
curr_Factors:  [102.90652976]
mat_Sqrt:  [[0.15]]
grads:  [0.00295881]
Stock Position:  0.002958810642054351
Bond Position:  [6.85814153]


portfolio before change:  [7.16440267]
curr_Stock_Price:  103.21844023019885
curr_Factors:  [103.21844023]
mat_Sqrt:  [[0.15]]
grads:  [-0.06213436]
Stock Position:  -0.06213436281167829
Bond Position:  [13.57781469]


portfolio before change:  [7.07107246]
curr_Stock_Price:  104.74782810441202
curr_Factors:  [104.7478281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00261777]
Stock Position:  -0.002617772294882222
Bond Position:  [7.34527843]


portfolio before change:  [7.07135194]
curr_Stock_Price:  104.99182850651987
curr_Factors:  [104.99182851]
mat_Sqrt:  [[0.15]]
grads:  [-0.07493668]
Stock Position:  -0.07493668023042376
Bond Position:  [14.93909102]


portfolio before change:  [7.01823134]
curr_Stock_Price:  105.72562275318587
curr_Factors:  [105.72562275]
mat_Sqrt:  [[0.15]]
grads:  [0.41683405]
Stock Position:  0.41683404621314646
Bond Position:  [-37.05180778]


portfolio before change:  [6.97830923]
curr_Stock_Price:  105.64095993309382
curr_Factors:  [105.64095993]
mat_Sqrt:  [[0.15]]
grads:  [-0.02005295]
Stock Position:  -0.02005295435639476
Bond Position:  [9.09672258]


portfolio before change:  [6.97083258]
curr_Stock_Price:  106.07051332676645
curr_Factors:  [106.07051333]
mat_Sqrt:  [[0.15]]
grads:  [-0.06717548]
Stock Position:  -0.06717547738757718
Bond Position:  [14.09616995]


portfolio before change:  [6.94138253]
curr_Stock_Price:  106.53514977600263
curr_Factors:  [106.53514978]
mat_Sqrt:  [[0.15]]
grads:  [0.02827544]
Stock Position:  0.028275436482891984
Bond Position:  [3.92905467]


portfolio before change:  [6.96494006]
curr_Stock_Price:  107.35092360594015
curr_Factors:  [107.35092361]
mat_Sqrt:  [[0.15]]
grads:  [0.04465859]
Stock Position:  0.04465858612092662
Bond Position:  [2.17079959]


portfolio before change:  [7.02978667]
curr_Stock_Price:  108.7968995983166
curr_Factors:  [108.7968996]
mat_Sqrt:  [[0.15]]
grads:  [0.03855899]
Stock Position:  0.038558994825762215
Bond Position:  [2.83468758]


portfolio before change:  [7.05034267]
curr_Stock_Price:  109.32081490491923
curr_Factors:  [109.3208149]
mat_Sqrt:  [[0.15]]
grads:  [0.05475368]
Stock Position:  0.0547536836529699
Bond Position:  [1.06462536]


portfolio before change:  [7.11562485]
curr_Stock_Price:  110.51067254859562
curr_Factors:  [110.51067255]
mat_Sqrt:  [[0.15]]
grads:  [0.01193738]
Stock Position:  0.011937378773448389
Bond Position:  [5.79641709]


portfolio before change:  [7.12097812]
curr_Stock_Price:  110.8984186206321
curr_Factors:  [110.89841862]
mat_Sqrt:  [[0.15]]
grads:  [-0.62515705]
Stock Position:  -0.6251570491018581
Bond Position:  [76.44990625]


portfolio before change:  [7.5814115]
curr_Stock_Price:  110.1771973775207
curr_Factors:  [110.17719738]
mat_Sqrt:  [[0.15]]
grads:  [0.05928082]
Stock Position:  0.059280823671302746
Bond Position:  [1.05001649]


portfolio before change:  [7.57502735]
curr_Stock_Price:  110.0672899157171
curr_Factors:  [110.06728992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.57502735]
Stock Price:  111.27613714757452
PL:  [-3.70110979]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.74276170e-03]
 [-2.33920386e-03]
 [ 1.24255681e-02]
 [-2.62021571e-03]
 [ 1.47804114e-02]
 [ 2.14456249e-02]
 [-4.45900358e-03]
 [ 6.82189187e-03]
 [-8.16597286e-03]
 [-1.82085562e-03]
 [ 1.05836888e-02]
 [ 4.04904259e-03]
 [ 1.19997371e-02]
 [ 2.23177544e-03]
 [ 2.12780293e-02]
 [ 2.19006980e-03]
 [ 9.67937530e-03]
 [ 1.32168454e-02]
 [ 1.15023072e-02]
 [-1.40546108e-02]
 [-7.40782365e-03]
 [ 2.35807802e-02]
 [-3.19768346e-02]
 [ 5.87829498e-03]
 [-4.33520943e-03]
 [-6.52531183e-03]
 [-1.06349432e-03]
 [-1.07228574e-02]
 [ 5.19171774e-02]
 [-6.12621313e-03]
 [-4.76731853e-03]
 [ 4.63204220e-03]
 [ 5.71692514e-03]
 [-3.70013459e-03]
 [ 7.73273092e-03]
 [ 4.73852135e-03]
 [-2.40987983e-02]
 [ 9.95184319e-03]
 [-8.49132935e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.0561544]
curr_Stock_Price:  100.71630833209235
curr_Factors:  [100.71630833]
mat_Sqrt:  [[0.15]]
grads:  [0.03828508]
Stock Position:  0.0382850779717635
Bond Position:  [9.20022269]


portfolio before change:  [13.08929427]
curr_Stock_Price:  101.55187580235908
curr_Factors:  [101.5518758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01559469]
Stock Position:  -0.015594692412232807
Bond Position:  [14.67296454]


portfolio before change:  [13.10361503]
curr_Stock_Price:  100.75118513198606
curr_Factors:  [100.75118513]
mat_Sqrt:  [[0.15]]
grads:  [0.08283712]
Stock Position:  0.0828371203950791
Bond Position:  [4.75767698]


portfolio before change:  [13.0321488]
curr_Stock_Price:  99.88127344063193
curr_Factors:  [99.88127344]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174681]
Stock Position:  -0.017468104756236426
Bond Position:  [14.77688534]


portfolio before change:  [13.0119937]
curr_Stock_Price:  101.14084443712777
curr_Factors:  [101.14084444]
mat_Sqrt:  [[0.15]]
grads:  [0.09853608]
Stock Position:  0.09853607602360646
Bond Position:  [3.04597177]


portfolio before change:  [12.93385044]
curr_Stock_Price:  100.34393798197387
curr_Factors:  [100.34393798]
mat_Sqrt:  [[0.15]]
grads:  [0.14297083]
Stock Position:  0.14297083279098605
Bond Position:  [-1.41240594]


portfolio before change:  [13.06051187]
curr_Stock_Price:  101.23109793407389
curr_Factors:  [101.23109793]
mat_Sqrt:  [[0.15]]
grads:  [-0.02972669]
Stock Position:  -0.029726690501430064
Bond Position:  [16.06977739]


portfolio before change:  [13.01895809]
curr_Stock_Price:  102.6965361175481
curr_Factors:  [102.69653612]
mat_Sqrt:  [[0.15]]
grads:  [0.04547928]
Stock Position:  0.04547927910304477
Bond Position:  [8.34839367]


portfolio before change:  [12.97404972]
curr_Stock_Price:  101.68614221325284
curr_Factors:  [101.68614221]
mat_Sqrt:  [[0.15]]
grads:  [-0.05443982]
Stock Position:  -0.05443981905396015
Bond Position:  [18.50982491]


portfolio before change:  [12.99111953]
curr_Stock_Price:  101.41509188251983
curr_Factors:  [101.41509188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01213904]
Stock Position:  -0.01213903745069134
Bond Position:  [14.22220112]


portfolio before change:  [12.99909361]
curr_Stock_Price:  100.90465637183323
curr_Factors:  [100.90465637]
mat_Sqrt:  [[0.15]]
grads:  [0.07055793]
Stock Position:  0.07055792540731949
Bond Position:  [5.87947039]


portfolio before change:  [12.95161723]
curr_Stock_Price:  100.22136877197391
curr_Factors:  [100.22136877]
mat_Sqrt:  [[0.15]]
grads:  [0.02699362]
Stock Position:  0.02699361727359286
Bond Position:  [10.24627996]


portfolio before change:  [12.96080852]
curr_Stock_Price:  100.5144164786536
curr_Factors:  [100.51441648]
mat_Sqrt:  [[0.15]]
grads:  [0.07999825]
Stock Position:  0.07999824757034735
Bond Position:  [4.91983134]


portfolio before change:  [12.96138773]
curr_Stock_Price:  100.51396893359322
curr_Factors:  [100.51396893]
mat_Sqrt:  [[0.15]]
grads:  [0.0148785]
Stock Position:  0.01487850295871353
Bond Position:  [11.46589035]


portfolio before change:  [12.96259375]
curr_Stock_Price:  100.49869114128286
curr_Factors:  [100.49869114]
mat_Sqrt:  [[0.15]]
grads:  [0.14185353]
Stock Position:  0.1418535287380993
Bond Position:  [-1.29350023]


portfolio before change:  [13.1912338]
curr_Stock_Price:  102.11163479401523
curr_Factors:  [102.11163479]
mat_Sqrt:  [[0.15]]
grads:  [0.01460047]
Stock Position:  0.014600465321186277
Bond Position:  [11.70035641]


portfolio before change:  [13.1722868]
curr_Stock_Price:  100.71375902284784
curr_Factors:  [100.71375902]
mat_Sqrt:  [[0.15]]
grads:  [0.06452917]
Stock Position:  0.0645291686649127
Bond Position:  [6.67331165]


portfolio before change:  [13.23108638]
curr_Stock_Price:  101.61204069233018
curr_Factors:  [101.61204069]
mat_Sqrt:  [[0.15]]
grads:  [0.0881123]
Stock Position:  0.08811230265183469
Bond Position:  [4.2778155]


portfolio before change:  [13.29997908]
curr_Stock_Price:  102.3878453511934
curr_Factors:  [102.38784535]
mat_Sqrt:  [[0.15]]
grads:  [0.07668205]
Stock Position:  0.0766820476847113
Bond Position:  [5.44866944]


portfolio before change:  [13.27513079]
curr_Stock_Price:  102.05491975636204
curr_Factors:  [102.05491976]
mat_Sqrt:  [[0.15]]
grads:  [-0.09369741]
Stock Position:  -0.09369740563502107
Bond Position:  [22.837412]


portfolio before change:  [13.25555411]
curr_Stock_Price:  102.29432374861935
curr_Factors:  [102.29432375]
mat_Sqrt:  [[0.15]]
grads:  [-0.04938549]
Stock Position:  -0.04938549100920021
Bond Position:  [18.30740951]


portfolio before change:  [13.25878012]
curr_Stock_Price:  102.27534151964669
curr_Factors:  [102.27534152]
mat_Sqrt:  [[0.15]]
grads:  [0.1572052]
Stock Position:  0.1572052011585745
Bond Position:  [-2.81943551]


portfolio before change:  [13.24243935]
curr_Stock_Price:  102.17363797340343
curr_Factors:  [102.17363797]
mat_Sqrt:  [[0.15]]
grads:  [-0.2131789]
Stock Position:  -0.21317889728553133
Bond Position:  [35.02370282]


portfolio before change:  [13.39528242]
curr_Stock_Price:  101.47720488996666
curr_Factors:  [101.47720489]
mat_Sqrt:  [[0.15]]
grads:  [0.03918863]
Stock Position:  0.03918863318140976
Bond Position:  [9.41852946]


portfolio before change:  [13.42687385]
curr_Stock_Price:  102.25329829046044
curr_Factors:  [102.25329829]
mat_Sqrt:  [[0.15]]
grads:  [-0.0289014]
Stock Position:  -0.0289013962067931
Bond Position:  [16.38213694]


portfolio before change:  [13.41998038]
curr_Stock_Price:  102.56267311823467
curr_Factors:  [102.56267312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04350208]
Stock Position:  -0.04350207884681274
Bond Position:  [17.88166987]


portfolio before change:  [13.43721599]
curr_Stock_Price:  102.21785591515531
curr_Factors:  [102.21785592]
mat_Sqrt:  [[0.15]]
grads:  [-0.00708996]
Stock Position:  -0.0070899621338001125
Bond Position:  [14.16193672]


portfolio before change:  [13.42895129]
curr_Stock_Price:  103.63324565028748
curr_Factors:  [103.63324565]
mat_Sqrt:  [[0.15]]
grads:  [-0.07148572]
Stock Position:  -0.07148571619349281
Bond Position:  [20.83724807]


portfolio before change:  [13.42763753]
curr_Stock_Price:  103.68806180687967
curr_Factors:  [103.68806181]
mat_Sqrt:  [[0.15]]
grads:  [0.34611452]
Stock Position:  0.3461145160099726
Bond Position:  [-22.4603058]


portfolio before change:  [13.63034361]
curr_Stock_Price:  104.28183576688743
curr_Factors:  [104.28183577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04084142]
Stock Position:  -0.04084142086049704
Bond Position:  [17.88936195]


portfolio before change:  [13.65251466]
curr_Stock_Price:  103.7937345593081
curr_Factors:  [103.79373456]
mat_Sqrt:  [[0.15]]
grads:  [-0.03178212]
Stock Position:  -0.0317821235606485
Bond Position:  [16.95129996]


portfolio before change:  [13.6295016]
curr_Stock_Price:  104.58449680276293
curr_Factors:  [104.5844968]
mat_Sqrt:  [[0.15]]
grads:  [0.03088028]
Stock Position:  0.03088028132759499
Bond Position:  [10.39990292]


portfolio before change:  [13.62186859]
curr_Stock_Price:  104.29521553631062
curr_Factors:  [104.29521554]
mat_Sqrt:  [[0.15]]
grads:  [0.03811283]
Stock Position:  0.03811283426092278
Bond Position:  [9.64688232]


portfolio before change:  [13.62345877]
curr_Stock_Price:  104.30529748441153
curr_Factors:  [104.30529748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02466756]
Stock Position:  -0.024667563950596095
Bond Position:  [16.19641637]


portfolio before change:  [13.64219957]
curr_Stock_Price:  103.62764167465224
curr_Factors:  [103.62764167]
mat_Sqrt:  [[0.15]]
grads:  [0.05155154]
Stock Position:  0.051551539475165276
Bond Position:  [8.30003511]


portfolio before change:  [13.69108477]
curr_Stock_Price:  104.55579293119679
curr_Factors:  [104.55579293]
mat_Sqrt:  [[0.15]]
grads:  [0.03159014]
Stock Position:  0.03159014234017068
Bond Position:  [10.38815238]


portfolio before change:  [13.70501018]
curr_Stock_Price:  104.95550035771562
curr_Factors:  [104.95550036]
mat_Sqrt:  [[0.15]]
grads:  [-0.16065866]
Stock Position:  -0.1606586551100518
Bond Position:  [30.56701971]


portfolio before change:  [13.67204434]
curr_Stock_Price:  105.18447626447806
curr_Factors:  [105.18447626]
mat_Sqrt:  [[0.15]]
grads:  [0.06634562]
Stock Position:  0.06634562127801624
Bond Position:  [6.69351491]


portfolio before change:  [13.72626024]
curr_Stock_Price:  105.98903825097295
curr_Factors:  [105.98903825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.72626024]
Stock Price:  105.54195708201807
PL:  [8.18430316]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.71007944e-03]
 [ 3.25789949e-03]
 [ 1.36227865e-02]
 [-2.26629671e-03]
 [ 1.47315651e-02]
 [ 2.67052426e-02]
 [ 1.54350625e-02]
 [ 1.13582489e-02]
 [-1.01486961e-02]
 [-2.95244756e-03]
 [ 2.44243897e-02]
 [ 8.05705819e-03]
 [-1.66990033e-03]
 [-4.33291183e-03]
 [-2.46909843e-03]
 [ 6.22078952e-03]
 [ 9.26879084e-03]
 [-1.14352904e-02]
 [ 1.25775152e-02]
 [-1.81387222e-02]
 [ 2.22608952e-02]
 [ 5.92773328e-02]
 [ 9.59279417e-02]
 [ 4.92525890e-03]
 [ 7.73954872e-03]
 [-3.58307769e-02]
 [ 3.27618489e-03]
 [-1.64285802e-02]
 [ 6.95321041e-02]
 [-2.94330929e-03]
 [-1.04351691e-02]
 [ 4.53698483e-03]
 [ 5.88833377e-03]
 [-4.06666823e-03]
 [ 6.89219526e-03]
 [ 5.14032700e-03]
 [-1.97542299e-02]
 [ 9.81068820e-03]
 [-1.61308715e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62814105]
curr_Stock_Price:  100.172622507653
curr_Factors:  [100.17262251]
mat_Sqrt:  [[0.15]]
grads:  [0.0380672]
Stock Position:  0.03806719625104576
Bond Position:  [0.81485017]


portfolio before change:  [4.64813607]
curr_Stock_Price:  100.69520246221181
curr_Factors:  [100.69520246]
mat_Sqrt:  [[0.15]]
grads:  [0.02171933]
Stock Position:  0.021719329917948213
Bond Position:  [2.46110374]


portfolio before change:  [4.65381523]
curr_Stock_Price:  100.94251697272378
curr_Factors:  [100.94251697]
mat_Sqrt:  [[0.15]]
grads:  [0.09081858]
Stock Position:  0.09081857639891026
Bond Position:  [-4.51364046]


portfolio before change:  [4.63106044]
curr_Stock_Price:  100.69817761465369
curr_Factors:  [100.69817761]
mat_Sqrt:  [[0.15]]
grads:  [-0.01510864]
Stock Position:  -0.015108644737596006
Bond Position:  [6.15247343]


portfolio before change:  [4.62447118]
curr_Stock_Price:  101.18520754266108
curr_Factors:  [101.18520754]
mat_Sqrt:  [[0.15]]
grads:  [0.09821043]
Stock Position:  0.09821043423566388
Bond Position:  [-5.31297199]


portfolio before change:  [4.66935438]
curr_Stock_Price:  101.64898063993995
curr_Factors:  [101.64898064]
mat_Sqrt:  [[0.15]]
grads:  [0.17803495]
Stock Position:  0.17803495053488377
Bond Position:  [-13.42771686]


portfolio before change:  [4.78914578]
curr_Stock_Price:  102.33126223602584
curr_Factors:  [102.33126224]
mat_Sqrt:  [[0.15]]
grads:  [0.10290042]
Stock Position:  0.10290041641317331
Bond Position:  [-5.74078372]


portfolio before change:  [4.71697844]
curr_Stock_Price:  101.63690456217816
curr_Factors:  [101.63690456]
mat_Sqrt:  [[0.15]]
grads:  [0.07572166]
Stock Position:  0.07572165908890918
Bond Position:  [-2.9791366]


portfolio before change:  [4.82038721]
curr_Stock_Price:  103.00746604883514
curr_Factors:  [103.00746605]
mat_Sqrt:  [[0.15]]
grads:  [-0.06765797]
Stock Position:  -0.06765797409262904
Bond Position:  [11.78966368]


portfolio before change:  [4.81154751]
curr_Stock_Price:  103.15990196677558
curr_Factors:  [103.15990197]
mat_Sqrt:  [[0.15]]
grads:  [-0.01968298]
Stock Position:  -0.01968298372660145
Bond Position:  [6.84204218]


portfolio before change:  [4.7890863]
curr_Stock_Price:  104.3445046230257
curr_Factors:  [104.34450462]
mat_Sqrt:  [[0.15]]
grads:  [0.16282926]
Stock Position:  0.16282926446329282
Bond Position:  [-12.20125264]


portfolio before change:  [4.64801197]
curr_Stock_Price:  103.48747761087229
curr_Factors:  [103.48747761]
mat_Sqrt:  [[0.15]]
grads:  [0.05371372]
Stock Position:  0.05371372123459925
Bond Position:  [-0.91068555]


portfolio before change:  [4.74666018]
curr_Stock_Price:  105.32615219063035
curr_Factors:  [105.32615219]
mat_Sqrt:  [[0.15]]
grads:  [-0.01113267]
Stock Position:  -0.01113266888415055
Bond Position:  [5.91922136]


portfolio before change:  [4.74769606]
curr_Stock_Price:  105.29957027974686
curr_Factors:  [105.29957028]
mat_Sqrt:  [[0.15]]
grads:  [-0.02888608]
Stock Position:  -0.028886078874780636
Bond Position:  [7.78938775]


portfolio before change:  [4.74149845]
curr_Stock_Price:  105.54783332821081
curr_Factors:  [105.54783333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646066]
Stock Position:  -0.016460656168209017
Bond Position:  [6.47888504]


portfolio before change:  [4.72771981]
curr_Stock_Price:  106.43410143024657
curr_Factors:  [106.43410143]
mat_Sqrt:  [[0.15]]
grads:  [0.04147193]
Stock Position:  0.04147193013626105
Bond Position:  [0.31369219]


portfolio before change:  [4.73940833]
curr_Stock_Price:  106.71499774311138
curr_Factors:  [106.71499774]
mat_Sqrt:  [[0.15]]
grads:  [0.06179194]
Stock Position:  0.061791938946368134
Bond Position:  [-1.85471829]


portfolio before change:  [4.65391759]
curr_Stock_Price:  105.33522410460911
curr_Factors:  [105.3352241]
mat_Sqrt:  [[0.15]]
grads:  [-0.07623527]
Stock Position:  -0.07623526959959287
Bond Position:  [12.6841768]


portfolio before change:  [4.55203484]
curr_Stock_Price:  106.69244853714454
curr_Factors:  [106.69244854]
mat_Sqrt:  [[0.15]]
grads:  [0.0838501]
Stock Position:  0.08385010127567696
Bond Position:  [-4.39413778]


portfolio before change:  [4.56997849]
curr_Stock_Price:  106.91299627599771
curr_Factors:  [106.91299628]
mat_Sqrt:  [[0.15]]
grads:  [-0.12092481]
Stock Position:  -0.12092481482065216
Bond Position:  [17.49841276]


portfolio before change:  [4.38414923]
curr_Stock_Price:  108.46781938323714
curr_Factors:  [108.46781938]
mat_Sqrt:  [[0.15]]
grads:  [0.14840597]
Stock Position:  0.14840596788993282
Bond Position:  [-11.71312249]


portfolio before change:  [4.60991542]
curr_Stock_Price:  109.99896009623508
curr_Factors:  [109.9989601]
mat_Sqrt:  [[0.15]]
grads:  [0.39518222]
Stock Position:  0.3951822183909576
Bond Position:  [-38.85971765]


portfolio before change:  [5.20324423]
curr_Stock_Price:  111.51265820977804
curr_Factors:  [111.51265821]
mat_Sqrt:  [[0.15]]
grads:  [0.63951961]
Stock Position:  0.6395196113863609
Bond Position:  [-66.11128761]


portfolio before change:  [5.29202049]
curr_Stock_Price:  111.66439819074317
curr_Factors:  [111.66439819]
mat_Sqrt:  [[0.15]]
grads:  [0.03283506]
Stock Position:  0.032835059310557344
Bond Position:  [1.62551336]


portfolio before change:  [5.29985798]
curr_Stock_Price:  111.89690236215408
curr_Factors:  [111.89690236]
mat_Sqrt:  [[0.15]]
grads:  [0.05159699]
Stock Position:  0.05159699144670317
Bond Position:  [-0.47368553]


portfolio before change:  [5.23591584]
curr_Stock_Price:  110.65878888938653
curr_Factors:  [110.65878889]
mat_Sqrt:  [[0.15]]
grads:  [-0.23887185]
Stock Position:  -0.23887184586499846
Bond Position:  [31.669185]


portfolio before change:  [5.45013511]
curr_Stock_Price:  109.77856639317898
curr_Factors:  [109.77856639]
mat_Sqrt:  [[0.15]]
grads:  [0.02184123]
Stock Position:  0.0218412326006878
Bond Position:  [3.0524359]


portfolio before change:  [5.42670384]
curr_Stock_Price:  108.68829592014986
curr_Factors:  [108.68829592]
mat_Sqrt:  [[0.15]]
grads:  [-0.10952387]
Stock Position:  -0.10952386771036846
Bond Position:  [17.33066638]


portfolio before change:  [5.60316036]
curr_Stock_Price:  107.09695277379258
curr_Factors:  [107.09695277]
mat_Sqrt:  [[0.15]]
grads:  [0.46354736]
Stock Position:  0.46354736092572885
Bond Position:  [-44.04134946]


portfolio before change:  [5.39941729]
curr_Stock_Price:  106.66929947898997
curr_Factors:  [106.66929948]
mat_Sqrt:  [[0.15]]
grads:  [-0.01962206]
Stock Position:  -0.019622061910141854
Bond Position:  [7.49248889]


portfolio before change:  [5.40908364]
curr_Stock_Price:  106.22440595092628
curr_Factors:  [106.22440595]
mat_Sqrt:  [[0.15]]
grads:  [-0.06956779]
Stock Position:  -0.06956779418888134
Bond Position:  [12.79888125]


portfolio before change:  [5.49175425]
curr_Stock_Price:  105.05905850490396
curr_Factors:  [105.0590585]
mat_Sqrt:  [[0.15]]
grads:  [0.03024657]
Stock Position:  0.030246565530744427
Bond Position:  [2.31407855]


portfolio before change:  [5.48071275]
curr_Stock_Price:  104.68444467655578
curr_Factors:  [104.68444468]
mat_Sqrt:  [[0.15]]
grads:  [0.03925556]
Stock Position:  0.039255558497595044
Bond Position:  [1.3712664]


portfolio before change:  [5.44313164]
curr_Stock_Price:  103.72273314837467
curr_Factors:  [103.72273315]
mat_Sqrt:  [[0.15]]
grads:  [-0.02711112]
Stock Position:  -0.027111121511106236
Bond Position:  [8.25517126]


portfolio before change:  [5.42357111]
curr_Stock_Price:  104.48229211080394
curr_Factors:  [104.48229211]
mat_Sqrt:  [[0.15]]
grads:  [0.04594797]
Stock Position:  0.045947968390498445
Bond Position:  [0.62282205]


portfolio before change:  [5.36813866]
curr_Stock_Price:  103.27417987562035
curr_Factors:  [103.27417988]
mat_Sqrt:  [[0.15]]
grads:  [0.03426885]
Stock Position:  0.03426884664880627
Bond Position:  [1.82905163]


portfolio before change:  [5.41211176]
curr_Stock_Price:  104.55068762065804
curr_Factors:  [104.55068762]
mat_Sqrt:  [[0.15]]
grads:  [-0.13169487]
Stock Position:  -0.13169486589227875
Bond Position:  [19.18090054]


portfolio before change:  [5.50539256]
curr_Stock_Price:  103.86058449445825
curr_Factors:  [103.86058449]
mat_Sqrt:  [[0.15]]
grads:  [0.06540459]
Stock Position:  0.06540458800849608
Bond Position:  [-1.28756618]


portfolio before change:  [5.44600602]
curr_Stock_Price:  102.95505810066615
curr_Factors:  [102.9550581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.44600602]
Stock Price:  102.49138688043145
PL:  [2.95461914]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.74501513e-03]
 [-5.10885534e-03]
 [-4.11250232e-03]
 [-2.53661495e-03]
 [ 6.32322211e-03]
 [-4.47592907e-03]
 [-5.95565637e-03]
 [ 2.26298194e-02]
 [-5.84656261e-03]
 [ 2.95711389e-03]
 [-3.40629435e-03]
 [ 7.31693994e-03]
 [ 1.39135976e-02]
 [ 2.05733609e-03]
 [ 1.15530598e-03]
 [-4.34081997e-03]
 [ 1.88357117e-02]
 [-2.35446507e-02]
 [ 3.40295009e-03]
 [ 1.53723989e-03]
 [ 2.12920647e-02]
 [-2.91974411e-03]
 [ 2.19623955e-02]
 [ 4.20751963e-03]
 [ 1.67770405e-02]
 [-9.82504683e-03]
 [ 2.00276958e-02]
 [-2.14948253e-02]
 [-4.84254971e-02]
 [ 9.90369932e-04]
 [-4.22746172e-03]
 [ 5.58215450e-03]
 [ 1.04974798e-02]
 [-1.28481011e-02]
 [ 3.10054587e-03]
 [ 5.59635588e-03]
 [ 3.28522790e-03]
 [ 1.12009251e-02]
 [-3.83792413e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.26009581]
curr_Stock_Price:  98.88964489472679
curr_Factors:  [98.88964489]
mat_Sqrt:  [[0.15]]
grads:  [0.0583001]
Stock Position:  0.058300100865834606
Bond Position:  [-21.02537208]


portfolio before change:  [-15.24332943]
curr_Stock_Price:  99.22231522677988
curr_Factors:  [99.22231523]
mat_Sqrt:  [[0.15]]
grads:  [-0.03405904]
Stock Position:  -0.03405903560605015
Bond Position:  [-11.86391306]


portfolio before change:  [-15.24274896]
curr_Stock_Price:  99.16172783247626
curr_Factors:  [99.16172783]
mat_Sqrt:  [[0.15]]
grads:  [-0.02741668]
Stock Position:  -0.027416682100062612
Bond Position:  [-12.5240634]


portfolio before change:  [-15.26257825]
curr_Stock_Price:  99.82787996173462
curr_Factors:  [99.82787996]
mat_Sqrt:  [[0.15]]
grads:  [-0.01691077]
Stock Position:  -0.01691076634194416
Bond Position:  [-13.5744123]


portfolio before change:  [-15.25378114]
curr_Stock_Price:  99.2073274044813
curr_Factors:  [99.2073274]
mat_Sqrt:  [[0.15]]
grads:  [0.04215481]
Stock Position:  0.04215481404560973
Bond Position:  [-19.43584758]


portfolio before change:  [-15.25442592]
curr_Stock_Price:  99.24966774909014
curr_Factors:  [99.24966775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02983953]
Stock Position:  -0.029839527100219677
Bond Position:  [-12.29286277]


portfolio before change:  [-15.26818414]
curr_Stock_Price:  99.65924246831979
curr_Factors:  [99.65924247]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970438]
Stock Position:  -0.03970437578219282
Bond Position:  [-11.31127613]


portfolio before change:  [-15.27851315]
curr_Stock_Price:  99.88377708605262
curr_Factors:  [99.88377709]
mat_Sqrt:  [[0.15]]
grads:  [0.15086546]
Stock Position:  0.1508654629124252
Bond Position:  [-30.34752541]


portfolio before change:  [-15.37510312]
curr_Stock_Price:  99.26868403156354
curr_Factors:  [99.26868403]
mat_Sqrt:  [[0.15]]
grads:  [-0.03897708]
Stock Position:  -0.03897708404889809
Bond Position:  [-11.50589928]


portfolio before change:  [-15.40167958]
curr_Stock_Price:  99.91363048337882
curr_Factors:  [99.91363048]
mat_Sqrt:  [[0.15]]
grads:  [0.01971409]
Stock Position:  0.019714092580019923
Bond Position:  [-17.37138614]


portfolio before change:  [-15.44167405]
curr_Stock_Price:  97.99505834684047
curr_Factors:  [97.99505835]
mat_Sqrt:  [[0.15]]
grads:  [-0.02270863]
Stock Position:  -0.0227086289726953
Bond Position:  [-13.21634063]


portfolio before change:  [-15.43772119]
curr_Stock_Price:  97.74823544170209
curr_Factors:  [97.74823544]
mat_Sqrt:  [[0.15]]
grads:  [0.0487796]
Stock Position:  0.04877959962167149
Bond Position:  [-20.20584097]


portfolio before change:  [-15.42277341]
curr_Stock_Price:  98.10645217779275
curr_Factors:  [98.10645218]
mat_Sqrt:  [[0.15]]
grads:  [0.09275732]
Stock Position:  0.09275731763037173
Bond Position:  [-24.52286475]


portfolio before change:  [-15.4874487]
curr_Stock_Price:  97.44224858561576
curr_Factors:  [97.44224859]
mat_Sqrt:  [[0.15]]
grads:  [0.01371557]
Stock Position:  0.013715573922519105
Bond Position:  [-16.82392506]


portfolio before change:  [-15.48694037]
curr_Stock_Price:  97.63264873732066
curr_Factors:  [97.63264874]
mat_Sqrt:  [[0.15]]
grads:  [0.00770204]
Stock Position:  0.007702039876744914
Bond Position:  [-16.23891093]


portfolio before change:  [-15.49173123]
curr_Stock_Price:  97.27418942506766
curr_Factors:  [97.27418943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0289388]
Stock Position:  -0.02893879980517317
Bond Position:  [-12.67673294]


portfolio before change:  [-15.46645335]
curr_Stock_Price:  96.34593489650409
curr_Factors:  [96.3459349]
mat_Sqrt:  [[0.15]]
grads:  [0.12557141]
Stock Position:  0.12557141165064845
Bond Position:  [-27.5647484]


portfolio before change:  [-15.53819126]
curr_Stock_Price:  95.8020841925616
curr_Factors:  [95.80208419]
mat_Sqrt:  [[0.15]]
grads:  [-0.15696434]
Stock Position:  -0.15696433820101777
Bond Position:  [-0.50068052]


portfolio before change:  [-15.60887707]
curr_Stock_Price:  96.25201583985755
curr_Factors:  [96.25201584]
mat_Sqrt:  [[0.15]]
grads:  [0.02268633]
Stock Position:  0.022686333961697676
Bond Position:  [-17.79248245]


portfolio before change:  [-15.61587425]
curr_Stock_Price:  96.04162575281012
curr_Factors:  [96.04162575]
mat_Sqrt:  [[0.15]]
grads:  [0.01024827]
Stock Position:  0.010248265933629243
Bond Position:  [-16.60013437]


portfolio before change:  [-15.61064196]
curr_Stock_Price:  96.75466703273341
curr_Factors:  [96.75466703]
mat_Sqrt:  [[0.15]]
grads:  [0.1419471]
Stock Position:  0.1419470977155368
Bond Position:  [-29.34468614]


portfolio before change:  [-15.61186706]
curr_Stock_Price:  96.77187917312706
curr_Factors:  [96.77187917]
mat_Sqrt:  [[0.15]]
grads:  [-0.01946496]
Stock Position:  -0.019464960761363528
Bond Position:  [-13.72820623]


portfolio before change:  [-15.62499209]
curr_Stock_Price:  97.35800391328492
curr_Factors:  [97.35800391]
mat_Sqrt:  [[0.15]]
grads:  [0.14641597]
Stock Position:  0.14641596975630072
Bond Position:  [-29.87975865]


portfolio before change:  [-15.70053624]
curr_Stock_Price:  96.86755915275529
curr_Factors:  [96.86755915]
mat_Sqrt:  [[0.15]]
grads:  [0.02805013]
Stock Position:  0.028050130890344603
Bond Position:  [-18.41768395]


portfolio before change:  [-15.68522084]
curr_Stock_Price:  97.49563996648955
curr_Factors:  [97.49563997]
mat_Sqrt:  [[0.15]]
grads:  [0.11184694]
Stock Position:  0.11184693637981738
Bond Position:  [-26.58980949]


portfolio before change:  [-15.75031556]
curr_Stock_Price:  96.94336040297553
curr_Factors:  [96.9433604]
mat_Sqrt:  [[0.15]]
grads:  [-0.06550031]
Stock Position:  -0.0655003121990726
Bond Position:  [-9.40049518]


portfolio before change:  [-15.74245155]
curr_Stock_Price:  96.80535883464817
curr_Factors:  [96.80535883]
mat_Sqrt:  [[0.15]]
grads:  [0.13351797]
Stock Position:  0.13351797194652582
Bond Position:  [-28.66770673]


portfolio before change:  [-15.84067145]
curr_Stock_Price:  96.09656869352996
curr_Factors:  [96.09656869]
mat_Sqrt:  [[0.15]]
grads:  [-0.14329884]
Stock Position:  -0.14329883502570415
Bond Position:  [-2.07014511]


portfolio before change:  [-15.91600443]
curr_Stock_Price:  96.6204682033022
curr_Factors:  [96.6204682]
mat_Sqrt:  [[0.15]]
grads:  [-0.32283665]
Stock Position:  -0.32283664726968253
Bond Position:  [15.27662358]


portfolio before change:  [-15.64796279]
curr_Stock_Price:  95.79611339041591
curr_Factors:  [95.79611339]
mat_Sqrt:  [[0.15]]
grads:  [0.00660247]
Stock Position:  0.0066024662104257476
Bond Position:  [-16.28045339]


portfolio before change:  [-15.65227119]
curr_Stock_Price:  95.4518146897534
curr_Factors:  [95.45181469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02818308]
Stock Position:  -0.02818307816172926
Bond Position:  [-12.96214524]


portfolio before change:  [-15.65834937]
curr_Stock_Price:  95.60998805771665
curr_Factors:  [95.60998806]
mat_Sqrt:  [[0.15]]
grads:  [0.03721436]
Stock Position:  0.0372143633129715
Bond Position:  [-19.21641421]


portfolio before change:  [-15.61373375]
curr_Stock_Price:  96.87342038885092
curr_Factors:  [96.87342039]
mat_Sqrt:  [[0.15]]
grads:  [0.0699832]
Stock Position:  0.06998319879793256
Bond Position:  [-22.39324558]


portfolio before change:  [-15.65395403]
curr_Stock_Price:  96.3387070647817
curr_Factors:  [96.33870706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565401]
Stock Position:  -0.08565400710519282
Bond Position:  [-7.40215773]


portfolio before change:  [-15.72651579]
curr_Stock_Price:  97.17505364243812
curr_Factors:  [97.17505364]
mat_Sqrt:  [[0.15]]
grads:  [0.02067031]
Stock Position:  0.020670305823465823
Bond Position:  [-17.73515387]


portfolio before change:  [-15.75281374]
curr_Stock_Price:  96.01005281723745
curr_Factors:  [96.01005282]
mat_Sqrt:  [[0.15]]
grads:  [0.03730904]
Stock Position:  0.03730903919689281
Bond Position:  [-19.33485657]


portfolio before change:  [-15.77268932]
curr_Stock_Price:  95.54210804933926
curr_Factors:  [95.54210805]
mat_Sqrt:  [[0.15]]
grads:  [0.02190152]
Stock Position:  0.021901519344853505
Bond Position:  [-17.86520665]


portfolio before change:  [-15.75998963]
curr_Stock_Price:  96.22393202256143
curr_Factors:  [96.22393202]
mat_Sqrt:  [[0.15]]
grads:  [0.07467283]
Stock Position:  0.07467283366725531
Bond Position:  [-22.9453033]


portfolio before change:  [-15.78348343]
curr_Stock_Price:  95.94772104304012
curr_Factors:  [95.94772104]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.78348343]
Stock Price:  96.2305939610041
PL:  [-15.78348343]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.25978160e-03]
 [ 1.75085266e-03]
 [-7.55088410e-03]
 [ 4.07714808e-03]
 [ 2.62301092e-03]
 [-2.32808597e-02]
 [-3.96787204e-02]
 [ 2.16300263e-02]
 [-5.97614691e-03]
 [-1.01570517e-03]
 [-4.81758935e-03]
 [ 7.25490880e-03]
 [ 1.38710517e-02]
 [ 2.84334164e-03]
 [ 7.44172009e-03]
 [-3.33635002e-03]
 [ 1.14986362e-02]
 [-6.67356743e-03]
 [ 6.30106608e-03]
 [-3.62898487e-03]
 [ 1.34239925e-02]
 [ 1.22203271e-04]
 [ 1.89422173e-02]
 [ 4.12905159e-03]
 [ 1.32582784e-02]
 [ 3.50059947e-03]
 [ 2.92081022e-02]
 [-2.33849394e-02]
 [-4.75755686e-02]
 [ 1.77944370e-03]
 [-4.08455147e-03]
 [ 5.60281668e-03]
 [ 1.11502940e-02]
 [-1.28427960e-02]
 [ 3.14805322e-03]
 [ 5.55629275e-03]
 [ 3.34494023e-03]
 [ 8.98622190e-03]
 [-6.86578254e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.38616054]
curr_Stock_Price:  99.96348439042299
curr_Factors:  [99.96348439]
mat_Sqrt:  [[0.15]]
grads:  [0.02173188]
Stock Position:  0.02173187732196909
Bond Position:  [-0.78623364]


portfolio before change:  [1.38060722]
curr_Stock_Price:  99.71246869295656
curr_Factors:  [99.71246869]
mat_Sqrt:  [[0.15]]
grads:  [0.01167235]
Stock Position:  0.011672351066617376
Bond Position:  [0.21672828]


portfolio before change:  [1.37174482]
curr_Stock_Price:  98.95088364154199
curr_Factors:  [98.95088364]
mat_Sqrt:  [[0.15]]
grads:  [-0.05033923]
Stock Position:  -0.05033922733500124
Bond Position:  [6.35285585]


portfolio before change:  [1.42281085]
curr_Stock_Price:  97.95222164934022
curr_Factors:  [97.95222165]
mat_Sqrt:  [[0.15]]
grads:  [0.02718099]
Stock Position:  0.0271809871736218
Bond Position:  [-1.23962723]


portfolio before change:  [1.45158111]
curr_Stock_Price:  99.01639275199807
curr_Factors:  [99.01639275]
mat_Sqrt:  [[0.15]]
grads:  [0.01748674]
Stock Position:  0.017486739453205016
Bond Position:  [-0.27989275]


portfolio before change:  [1.44148176]
curr_Stock_Price:  98.44085010685207
curr_Factors:  [98.44085011]
mat_Sqrt:  [[0.15]]
grads:  [-0.15520573]
Stock Position:  -0.15520573151111058
Bond Position:  [16.72006591]


portfolio before change:  [1.40574244]
curr_Stock_Price:  98.68458760122928
curr_Factors:  [98.6845876]
mat_Sqrt:  [[0.15]]
grads:  [-0.2645248]
Stock Position:  -0.26452480290161134
Bond Position:  [27.51026352]


portfolio before change:  [1.42185603]
curr_Stock_Price:  98.63667302404407
curr_Factors:  [98.63667302]
mat_Sqrt:  [[0.15]]
grads:  [0.14420018]
Stock Position:  0.14420017535924406
Bond Position:  [-12.80156952]


portfolio before change:  [1.38336643]
curr_Stock_Price:  98.38085289437134
curr_Factors:  [98.38085289]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984098]
Stock Position:  -0.03984097941117851
Bond Position:  [5.30295596]


portfolio before change:  [1.41330306]
curr_Stock_Price:  97.64608884434867
curr_Factors:  [97.64608884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677137]
Stock Position:  -0.006771367820660818
Bond Position:  [2.07450064]


portfolio before change:  [1.4127667]
curr_Stock_Price:  97.76359653033444
curr_Factors:  [97.76359653]
mat_Sqrt:  [[0.15]]
grads:  [-0.03211726]
Stock Position:  -0.03211726234676144
Bond Position:  [4.55266578]


portfolio before change:  [1.40571941]
curr_Stock_Price:  98.00074019236757
curr_Factors:  [98.00074019]
mat_Sqrt:  [[0.15]]
grads:  [0.04836606]
Stock Position:  0.048366058652663926
Bond Position:  [-3.33419014]


portfolio before change:  [1.43165511]
curr_Stock_Price:  98.54559546174863
curr_Factors:  [98.54559546]
mat_Sqrt:  [[0.15]]
grads:  [0.09247368]
Stock Position:  0.09247367827691505
Bond Position:  [-7.68121858]


portfolio before change:  [1.43513473]
curr_Stock_Price:  98.59360723717202
curr_Factors:  [98.59360724]
mat_Sqrt:  [[0.15]]
grads:  [0.01895561]
Stock Position:  0.018955610938211638
Bond Position:  [-0.43376733]


portfolio before change:  [1.43773902]
curr_Stock_Price:  98.73385665905093
curr_Factors:  [98.73385666]
mat_Sqrt:  [[0.15]]
grads:  [0.04961147]
Stock Position:  0.04961146729944327
Bond Position:  [-3.46059249]


portfolio before change:  [1.42521225]
curr_Stock_Price:  98.49007912730791
curr_Factors:  [98.49007913]
mat_Sqrt:  [[0.15]]
grads:  [-0.02224233]
Stock Position:  -0.022242333493683354
Bond Position:  [3.61586144]


portfolio before change:  [1.41020714]
curr_Stock_Price:  99.18502062550603
curr_Factors:  [99.18502063]
mat_Sqrt:  [[0.15]]
grads:  [0.07665757]
Stock Position:  0.07665757471628364
Bond Position:  [-6.19307599]


portfolio before change:  [1.35957223]
curr_Stock_Price:  98.53458611219372
curr_Factors:  [98.53458611]
mat_Sqrt:  [[0.15]]
grads:  [-0.04449045]
Stock Position:  -0.04449044956465427
Bond Position:  [5.74342026]


portfolio before change:  [1.38836599]
curr_Stock_Price:  97.90353399069177
curr_Factors:  [97.90353399]
mat_Sqrt:  [[0.15]]
grads:  [0.04200711]
Stock Position:  0.0420071072033279
Bond Position:  [-2.72427825]


portfolio before change:  [1.36936877]
curr_Stock_Price:  97.45940275481698
curr_Factors:  [97.45940275]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419323]
Stock Position:  -0.024193232476234193
Bond Position:  [3.72722676]


portfolio before change:  [1.3486784]
curr_Stock_Price:  98.33387446611373
curr_Factors:  [98.33387447]
mat_Sqrt:  [[0.15]]
grads:  [0.08949328]
Stock Position:  0.0894932834525485
Bond Position:  [-7.4515429]


portfolio before change:  [1.31736266]
curr_Stock_Price:  97.99436020482415
curr_Factors:  [97.9943602]
mat_Sqrt:  [[0.15]]
grads:  [0.00081469]
Stock Position:  0.0008146884729162581
Bond Position:  [1.23752778]


portfolio before change:  [1.31782082]
curr_Stock_Price:  98.36685335170249
curr_Factors:  [98.36685335]
mat_Sqrt:  [[0.15]]
grads:  [0.12628145]
Stock Position:  0.1262814488288542
Bond Position:  [-11.10408793]


portfolio before change:  [1.10516324]
curr_Stock_Price:  96.69384840260727
curr_Factors:  [96.6938484]
mat_Sqrt:  [[0.15]]
grads:  [0.02752701]
Stock Position:  0.027527010599166842
Bond Position:  [-1.55652935]


portfolio before change:  [1.07459112]
curr_Stock_Price:  95.59029457525223
curr_Factors:  [95.59029458]
mat_Sqrt:  [[0.15]]
grads:  [0.08838852]
Stock Position:  0.08838852296117654
Bond Position:  [-7.37449383]


portfolio before change:  [1.03686841]
curr_Stock_Price:  95.17394144450353
curr_Factors:  [95.17394144]
mat_Sqrt:  [[0.15]]
grads:  [0.02333733]
Stock Position:  0.02333732979233129
Bond Position:  [-1.18423725]


portfolio before change:  [1.022988]
curr_Stock_Price:  94.58551194070212
curr_Factors:  [94.58551194]
mat_Sqrt:  [[0.15]]
grads:  [0.19472068]
Stock Position:  0.19472068155814787
Bond Position:  [-17.39476735]


portfolio before change:  [1.11587816]
curr_Stock_Price:  95.07372225266448
curr_Factors:  [95.07372225]
mat_Sqrt:  [[0.15]]
grads:  [-0.1558996]
Stock Position:  -0.15589959612111168
Bond Position:  [15.93783306]


portfolio before change:  [1.10544928]
curr_Stock_Price:  95.15339684493256
curr_Factors:  [95.15339684]
mat_Sqrt:  [[0.15]]
grads:  [-0.31717046]
Stock Position:  -0.31717045749184986
Bond Position:  [31.28529569]


portfolio before change:  [1.15003408]
curr_Stock_Price:  95.02515699639903
curr_Factors:  [95.025157]
mat_Sqrt:  [[0.15]]
grads:  [0.01186296]
Stock Position:  0.01186295802647538
Bond Position:  [0.02275463]


portfolio before change:  [1.16736491]
curr_Stock_Price:  96.48583698710011
curr_Factors:  [96.48583699]
mat_Sqrt:  [[0.15]]
grads:  [-0.02723034]
Stock Position:  -0.027230343131810164
Bond Position:  [3.79470736]


portfolio before change:  [1.15078436]
curr_Stock_Price:  97.11215724739823
curr_Factors:  [97.11215725]
mat_Sqrt:  [[0.15]]
grads:  [0.03735211]
Stock Position:  0.037352111229052555
Bond Position:  [-2.47655974]


portfolio before change:  [1.13173292]
curr_Stock_Price:  96.6103956164071
curr_Factors:  [96.61039562]
mat_Sqrt:  [[0.15]]
grads:  [0.07433529]
Stock Position:  0.07433529327594653
Bond Position:  [-6.04982918]


portfolio before change:  [1.09438031]
curr_Stock_Price:  96.11808123931594
curr_Factors:  [96.11808124]
mat_Sqrt:  [[0.15]]
grads:  [-0.08561864]
Stock Position:  -0.08561863978354455
Bond Position:  [9.32387968]


portfolio before change:  [1.13680613]
curr_Stock_Price:  95.63617372026786
curr_Factors:  [95.63617372]
mat_Sqrt:  [[0.15]]
grads:  [0.02098702]
Stock Position:  0.02098702147496369
Bond Position:  [-0.8703123]


portfolio before change:  [1.12734033]
curr_Stock_Price:  95.19032637508982
curr_Factors:  [95.19032638]
mat_Sqrt:  [[0.15]]
grads:  [0.03704195]
Stock Position:  0.0370419516661112
Bond Position:  [-2.39869514]


portfolio before change:  [1.1388752]
curr_Stock_Price:  95.50982180982835
curr_Factors:  [95.50982181]
mat_Sqrt:  [[0.15]]
grads:  [0.0222996]
Stock Position:  0.022299601522584044
Bond Position:  [-0.99095576]


portfolio before change:  [1.09609141]
curr_Stock_Price:  93.5967866751873
curr_Factors:  [93.59678668]
mat_Sqrt:  [[0.15]]
grads:  [0.05990815]
Stock Position:  0.05990814599943304
Bond Position:  [-4.51111855]


portfolio before change:  [1.11031152]
curr_Stock_Price:  93.84356508631761
curr_Factors:  [93.84356509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.11031152]
Stock Price:  94.49819696169759
PL:  [1.11031152]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.21994030e-03]
 [-2.98949942e-03]
 [ 1.52227993e-02]
 [ 6.24702764e-03]
 [ 1.46019784e-02]
 [ 2.65947995e-02]
 [-1.21472253e-03]
 [ 2.23650444e-02]
 [-5.84984224e-03]
 [ 4.36169227e-03]
 [ 3.72200439e-03]
 [ 4.90650462e-03]
 [ 1.38422560e-02]
 [ 3.25927820e-03]
 [ 1.60198030e-02]
 [-2.34359724e-03]
 [ 1.02730488e-02]
 [-3.10683978e-03]
 [ 1.06993163e-02]
 [-1.10780141e-02]
 [ 8.55736624e-03]
 [ 1.63786336e-02]
 [ 2.28639113e-03]
 [ 6.23266491e-03]
 [-8.94254951e-03]
 [-6.92181930e-03]
 [ 3.44581949e-03]
 [-1.11139364e-02]
 [-1.75948868e-02]
 [-8.81822216e-03]
 [-2.50087759e-04]
 [ 5.15376631e-03]
 [ 5.15022616e-03]
 [-9.95364526e-03]
 [ 1.88405052e-02]
 [ 5.40081828e-03]
 [ 3.55077260e-05]
 [ 7.85820351e-03]
 [-9.31331656e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.68127432]
curr_Stock_Price:  101.07918126927665
curr_Factors:  [101.07918127]
mat_Sqrt:  [[0.15]]
grads:  [0.04813294]
Stock Position:  0.04813293535740906
Bond Position:  [13.81603662]


portfolio before change:  [18.70950895]
curr_Stock_Price:  101.62989595501975
curr_Factors:  [101.62989596]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993]
Stock Position:  -0.019929996159828746
Bond Position:  [20.73499238]


portfolio before change:  [18.71395318]
curr_Stock_Price:  101.53696075484466
curr_Factors:  [101.53696075]
mat_Sqrt:  [[0.15]]
grads:  [0.10148533]
Stock Position:  0.10148532841307602
Bond Position:  [8.40944137]


portfolio before change:  [18.74285426]
curr_Stock_Price:  101.81138298975303
curr_Factors:  [101.81138299]
mat_Sqrt:  [[0.15]]
grads:  [0.04164685]
Stock Position:  0.041646850920357574
Bond Position:  [14.50273077]


portfolio before change:  [18.72201155]
curr_Stock_Price:  101.26738842278667
curr_Factors:  [101.26738842]
mat_Sqrt:  [[0.15]]
grads:  [0.09734652]
Stock Position:  0.09734652265294096
Bond Position:  [8.86398343]


portfolio before change:  [18.74611839]
curr_Stock_Price:  101.50364513301587
curr_Factors:  [101.50364513]
mat_Sqrt:  [[0.15]]
grads:  [0.17729866]
Stock Position:  0.17729866356784443
Bond Position:  [0.74965776]


portfolio before change:  [18.61076785]
curr_Stock_Price:  100.73971240445954
curr_Factors:  [100.7397124]
mat_Sqrt:  [[0.15]]
grads:  [-0.00809815]
Stock Position:  -0.008098150217337742
Bond Position:  [19.42657317]


portfolio before change:  [18.62824549]
curr_Stock_Price:  98.88136607927395
curr_Factors:  [98.88136608]
mat_Sqrt:  [[0.15]]
grads:  [0.1491003]
Stock Position:  0.14910029593524443
Bond Position:  [3.88500455]


portfolio before change:  [18.66037244]
curr_Stock_Price:  99.09358091020545
curr_Factors:  [99.09358091]
mat_Sqrt:  [[0.15]]
grads:  [-0.03899895]
Stock Position:  -0.03899894825683083
Bond Position:  [22.52491788]


portfolio before change:  [18.64644959]
curr_Stock_Price:  99.52278852842383
curr_Factors:  [99.52278853]
mat_Sqrt:  [[0.15]]
grads:  [0.02907795]
Stock Position:  0.029077948460439585
Bond Position:  [15.75253107]


portfolio before change:  [18.64388752]
curr_Stock_Price:  99.36695732670142
curr_Factors:  [99.36695733]
mat_Sqrt:  [[0.15]]
grads:  [0.02481336]
Stock Position:  0.0248133626216674
Bond Position:  [16.17825918]


portfolio before change:  [18.65191716]
curr_Stock_Price:  99.6090538298246
curr_Factors:  [99.60905383]
mat_Sqrt:  [[0.15]]
grads:  [0.03271003]
Stock Position:  0.0327100308137992
Bond Position:  [15.39370194]


portfolio before change:  [18.62565597]
curr_Stock_Price:  98.74737553099791
curr_Factors:  [98.74737553]
mat_Sqrt:  [[0.15]]
grads:  [0.09228171]
Stock Position:  0.09228170666773687
Bond Position:  [9.51307963]


portfolio before change:  [18.62811735]
curr_Stock_Price:  98.76116124951666
curr_Factors:  [98.76116125]
mat_Sqrt:  [[0.15]]
grads:  [0.02172852]
Stock Position:  0.021728521300285967
Bond Position:  [16.48218335]


portfolio before change:  [18.6534703]
curr_Stock_Price:  99.83314183685413
curr_Factors:  [99.83314184]
mat_Sqrt:  [[0.15]]
grads:  [0.10679869]
Stock Position:  0.10679868649465969
Bond Position:  [7.99142189]


portfolio before change:  [18.63016836]
curr_Stock_Price:  99.6056022277262
curr_Factors:  [99.60560223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01562398]
Stock Position:  -0.01562398157866499
Bond Position:  [20.18640446]


portfolio before change:  [18.63168504]
curr_Stock_Price:  99.67004048146387
curr_Factors:  [99.67004048]
mat_Sqrt:  [[0.15]]
grads:  [0.06848699]
Stock Position:  0.0684869919215213
Bond Position:  [11.80558378]


portfolio before change:  [18.58234941]
curr_Stock_Price:  98.92812710829605
curr_Factors:  [98.92812711]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071227]
Stock Position:  -0.020712265195834575
Bond Position:  [20.63137502]


portfolio before change:  [18.57743681]
curr_Stock_Price:  99.28982979799832
curr_Factors:  [99.2898298]
mat_Sqrt:  [[0.15]]
grads:  [0.07132878]
Stock Position:  0.07132877561380735
Bond Position:  [11.49521482]


portfolio before change:  [18.56891149]
curr_Stock_Price:  99.15016226739135
curr_Factors:  [99.15016227]
mat_Sqrt:  [[0.15]]
grads:  [-0.07385343]
Stock Position:  -0.0738534275144638
Bond Position:  [25.89149081]


portfolio before change:  [18.59132988]
curr_Stock_Price:  98.89043497320044
curr_Factors:  [98.89043497]
mat_Sqrt:  [[0.15]]
grads:  [0.05704911]
Stock Position:  0.0570491082544821
Bond Position:  [12.94971875]


portfolio before change:  [18.66828849]
curr_Stock_Price:  100.21104795051374
curr_Factors:  [100.21104795]
mat_Sqrt:  [[0.15]]
grads:  [0.10919089]
Stock Position:  0.10919089099753551
Bond Position:  [7.72615488]


portfolio before change:  [18.67345955]
curr_Stock_Price:  100.24956057623591
curr_Factors:  [100.24956058]
mat_Sqrt:  [[0.15]]
grads:  [0.01524261]
Stock Position:  0.01524260751911284
Bond Position:  [17.14539484]


portfolio before change:  [18.68394595]
curr_Stock_Price:  100.79691376238131
curr_Factors:  [100.79691376]
mat_Sqrt:  [[0.15]]
grads:  [0.0415511]
Stock Position:  0.04155109938174292
Bond Position:  [14.49572337]


portfolio before change:  [18.69072707]
curr_Stock_Price:  100.91650254548192
curr_Factors:  [100.91650255]
mat_Sqrt:  [[0.15]]
grads:  [-0.059617]
Stock Position:  -0.059616996703709776
Bond Position:  [24.70706587]


portfolio before change:  [18.67245436]
curr_Stock_Price:  101.27481118785401
curr_Factors:  [101.27481119]
mat_Sqrt:  [[0.15]]
grads:  [-0.04614546]
Stock Position:  -0.046145462016770555
Bond Position:  [23.34582731]


portfolio before change:  [18.71456316]
curr_Stock_Price:  100.42553194542957
curr_Factors:  [100.42553195]
mat_Sqrt:  [[0.15]]
grads:  [0.02297213]
Stock Position:  0.022972129939534763
Bond Position:  [16.40757479]


portfolio before change:  [18.71144416]
curr_Stock_Price:  100.200473365029
curr_Factors:  [100.20047337]
mat_Sqrt:  [[0.15]]
grads:  [-0.07409291]
Stock Position:  -0.07409290951378956
Bond Position:  [26.13558876]


portfolio before change:  [18.72506372]
curr_Stock_Price:  100.06075138677754
curr_Factors:  [100.06075139]
mat_Sqrt:  [[0.15]]
grads:  [-0.11729925]
Stock Position:  -0.11729924534823867
Bond Position:  [30.46211434]


portfolio before change:  [18.64071514]
curr_Stock_Price:  100.81230419710997
curr_Factors:  [100.8123042]
mat_Sqrt:  [[0.15]]
grads:  [-0.05878815]
Stock Position:  -0.05878814772446839
Bond Position:  [24.56728377]


portfolio before change:  [18.58755176]
curr_Stock_Price:  101.76886582869354
curr_Factors:  [101.76886583]
mat_Sqrt:  [[0.15]]
grads:  [-0.00166725]
Stock Position:  -0.0016672517270912726
Bond Position:  [18.75722607]


portfolio before change:  [18.58984424]
curr_Stock_Price:  101.80024503540677
curr_Factors:  [101.80024504]
mat_Sqrt:  [[0.15]]
grads:  [0.03435844]
Stock Position:  0.034358442050138514
Bond Position:  [15.09214642]


portfolio before change:  [18.54299244]
curr_Stock_Price:  100.3817163132145
curr_Factors:  [100.38171631]
mat_Sqrt:  [[0.15]]
grads:  [0.03433484]
Stock Position:  0.034334841060783175
Bond Position:  [15.09640216]


portfolio before change:  [18.56443673]
curr_Stock_Price:  100.95131621538806
curr_Factors:  [100.95131622]
mat_Sqrt:  [[0.15]]
grads:  [-0.06635764]
Stock Position:  -0.06635763503698916
Bond Position:  [25.26332733]


portfolio before change:  [18.50783206]
curr_Stock_Price:  101.85193274527528
curr_Factors:  [101.85193275]
mat_Sqrt:  [[0.15]]
grads:  [0.12560337]
Stock Position:  0.12560336778677583
Bond Position:  [5.71488629]


portfolio before change:  [18.587236]
curr_Stock_Price:  102.4784249976478
curr_Factors:  [102.478425]
mat_Sqrt:  [[0.15]]
grads:  [0.03600546]
Stock Position:  0.036005455167023824
Bond Position:  [14.89745367]


portfolio before change:  [18.5620364]
curr_Stock_Price:  101.72681945719262
curr_Factors:  [101.72681946]
mat_Sqrt:  [[0.15]]
grads:  [0.00023672]
Stock Position:  0.00023671817333488498
Bond Position:  [18.53795581]


portfolio before change:  [18.56424448]
curr_Stock_Price:  101.26505495621473
curr_Factors:  [101.26505496]
mat_Sqrt:  [[0.15]]
grads:  [0.05238802]
Stock Position:  0.052388023426910776
Bond Position:  [13.25916841]


portfolio before change:  [18.5338537]
curr_Stock_Price:  100.65330674227388
curr_Factors:  [100.65330674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.5338537]
Stock Price:  101.07945957660597
PL:  [17.45439413]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.47855862e-03]
 [-1.15682167e-02]
 [-1.84669722e-02]
 [-1.52798442e-03]
 [ 1.55285384e-02]
 [ 2.64098563e-02]
 [ 4.78887985e-03]
 [ 1.01404126e-02]
 [-8.42688788e-03]
 [-1.48463915e-03]
 [ 1.13286027e-02]
 [ 6.72490627e-03]
 [ 6.05582697e-03]
 [-4.19689329e-03]
 [ 3.78722162e-04]
 [ 6.57460863e-03]
 [ 9.23819498e-03]
 [-6.65966753e-03]
 [ 1.20030632e-02]
 [-1.60797515e-02]
 [ 5.42899970e-03]
 [ 3.31637959e-02]
 [ 1.03503952e-03]
 [ 7.50248507e-03]
 [ 7.67864930e-03]
 [-1.95106096e-02]
 [ 1.11617324e-03]
 [-1.58623268e-02]
 [ 7.38938953e-02]
 [-2.09497665e-03]
 [-1.60411396e-02]
 [ 3.95463054e-03]
 [ 6.64351306e-03]
 [ 1.90891849e-03]
 [ 7.88638396e-03]
 [ 4.21221781e-03]
 [-3.21141216e-02]
 [ 9.75811711e-03]
 [-7.79937079e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.67712975]
curr_Stock_Price:  99.98225463028885
curr_Factors:  [99.98225463]
mat_Sqrt:  [[0.15]]
grads:  [0.02319039]
Stock Position:  0.023190390832364124
Bond Position:  [-0.64149781]


portfolio before change:  [1.64579195]
curr_Stock_Price:  98.6343857474392
curr_Factors:  [98.63438575]
mat_Sqrt:  [[0.15]]
grads:  [-0.07712144]
Stock Position:  -0.07712144444619518
Bond Position:  [9.25261825]


portfolio before change:  [1.68507892]
curr_Stock_Price:  98.13996661514845
curr_Factors:  [98.13996662]
mat_Sqrt:  [[0.15]]
grads:  [-0.12311315]
Stock Position:  -0.12311314823671453
Bond Position:  [13.76739918]


portfolio before change:  [1.57326411]
curr_Stock_Price:  99.06217384305207
curr_Factors:  [99.06217384]
mat_Sqrt:  [[0.15]]
grads:  [-0.01018656]
Stock Position:  -0.010186562785923914
Bond Position:  [2.58236717]


portfolio before change:  [1.56111784]
curr_Stock_Price:  100.28624674210185
curr_Factors:  [100.28624674]
mat_Sqrt:  [[0.15]]
grads:  [0.10352359]
Stock Position:  0.1035235894773377
Bond Position:  [-8.8208744]


portfolio before change:  [1.6608498]
curr_Stock_Price:  101.2602724942327
curr_Factors:  [101.26027249]
mat_Sqrt:  [[0.15]]
grads:  [0.17606571]
Stock Position:  0.1760657088284105
Bond Position:  [-16.16761185]


portfolio before change:  [1.73685683]
curr_Stock_Price:  101.70344854280918
curr_Factors:  [101.70344854]
mat_Sqrt:  [[0.15]]
grads:  [0.03192587]
Stock Position:  0.03192586568212023
Bond Position:  [-1.51011381]


portfolio before change:  [1.74122438]
curr_Stock_Price:  101.84616446423794
curr_Factors:  [101.84616446]
mat_Sqrt:  [[0.15]]
grads:  [0.06760275]
Stock Position:  0.06760275089513187
Bond Position:  [-5.14385651]


portfolio before change:  [1.7416569]
curr_Stock_Price:  101.862074248844
curr_Factors:  [101.86207425]
mat_Sqrt:  [[0.15]]
grads:  [-0.05617925]
Stock Position:  -0.05617925250160877
Bond Position:  [7.46419209]


portfolio before change:  [1.77427226]
curr_Stock_Price:  101.29812452087661
curr_Factors:  [101.29812452]
mat_Sqrt:  [[0.15]]
grads:  [-0.00989759]
Stock Position:  -0.009897594361178636
Bond Position:  [2.77688001]


portfolio before change:  [1.76846175]
curr_Stock_Price:  101.92025968792755
curr_Factors:  [101.92025969]
mat_Sqrt:  [[0.15]]
grads:  [0.07552402]
Stock Position:  0.07552401827738568
Bond Position:  [-5.92896581]


portfolio before change:  [1.82348113]
curr_Stock_Price:  102.65857515460557
curr_Factors:  [102.65857515]
mat_Sqrt:  [[0.15]]
grads:  [0.04483271]
Stock Position:  0.044832708454020015
Bond Position:  [-2.77898084]


portfolio before change:  [1.82954733]
curr_Stock_Price:  102.80163130052603
curr_Factors:  [102.8016313]
mat_Sqrt:  [[0.15]]
grads:  [0.04037218]
Stock Position:  0.04037217980605845
Bond Position:  [-2.32077861]


portfolio before change:  [1.85396577]
curr_Stock_Price:  103.41365045445987
curr_Factors:  [103.41365045]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797929]
Stock Position:  -0.027979288571486384
Bond Position:  [4.74740613]


portfolio before change:  [1.81415884]
curr_Stock_Price:  104.85758967525132
curr_Factors:  [104.85758968]
mat_Sqrt:  [[0.15]]
grads:  [0.00252481]
Stock Position:  0.002524814411834214
Bond Position:  [1.54941288]


portfolio before change:  [1.81909496]
curr_Stock_Price:  106.73592152631817
curr_Factors:  [106.73592153]
mat_Sqrt:  [[0.15]]
grads:  [0.04383072]
Stock Position:  0.0438307242212499
Bond Position:  [-2.85921778]


portfolio before change:  [1.79084771]
curr_Stock_Price:  106.09961386642941
curr_Factors:  [106.09961387]
mat_Sqrt:  [[0.15]]
grads:  [0.06158797]
Stock Position:  0.06158796650474765
Bond Position:  [-4.74361175]


portfolio before change:  [1.71379035]
curr_Stock_Price:  104.8580665545429
curr_Factors:  [104.85806655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04439778]
Stock Position:  -0.044397783555273004
Bond Position:  [6.36925609]


portfolio before change:  [1.7352511]
curr_Stock_Price:  104.3926258154775
curr_Factors:  [104.39262582]
mat_Sqrt:  [[0.15]]
grads:  [0.08002042]
Stock Position:  0.08002042132458824
Bond Position:  [-6.61829081]


portfolio before change:  [1.6943634]
curr_Stock_Price:  103.89199916126749
curr_Factors:  [103.89199916]
mat_Sqrt:  [[0.15]]
grads:  [-0.10719834]
Stock Position:  -0.10719834301219126
Bond Position:  [12.83141356]


portfolio before change:  [1.68563445]
curr_Stock_Price:  103.98839039314595
curr_Factors:  [103.98839039]
mat_Sqrt:  [[0.15]]
grads:  [0.03619333]
Stock Position:  0.03619333131006085
Bond Position:  [-2.07805182]


portfolio before change:  [1.68504538]
curr_Stock_Price:  103.97929206035597
curr_Factors:  [103.97929206]
mat_Sqrt:  [[0.15]]
grads:  [0.22109197]
Stock Position:  0.22109197265299554
Bond Position:  [-21.30394142]


portfolio before change:  [2.03681705]
curr_Stock_Price:  105.58240242186308
curr_Factors:  [105.58240242]
mat_Sqrt:  [[0.15]]
grads:  [0.00690026]
Stock Position:  0.0069002634638362075
Bond Position:  [1.30827066]


portfolio before change:  [2.04012668]
curr_Stock_Price:  106.03833891855427
curr_Factors:  [106.03833892]
mat_Sqrt:  [[0.15]]
grads:  [0.05001657]
Stock Position:  0.05001656710082163
Bond Position:  [-3.26354702]


portfolio before change:  [2.0375608]
curr_Stock_Price:  105.9951950644212
curr_Factors:  [105.99519506]
mat_Sqrt:  [[0.15]]
grads:  [0.051191]
Stock Position:  0.05119099536352827
Bond Position:  [-3.38843874]


portfolio before change:  [2.02242157]
curr_Stock_Price:  105.70772956843099
curr_Factors:  [105.70772957]
mat_Sqrt:  [[0.15]]
grads:  [-0.13007073]
Stock Position:  -0.1300707307310353
Bond Position:  [15.7719032]


portfolio before change:  [1.83890443]
curr_Stock_Price:  107.133790223491
curr_Factors:  [107.13379022]
mat_Sqrt:  [[0.15]]
grads:  [0.00744115]
Stock Position:  0.007441154952869053
Bond Position:  [1.0417053]


portfolio before change:  [1.84779564]
curr_Stock_Price:  108.31115916945136
curr_Factors:  [108.31115917]
mat_Sqrt:  [[0.15]]
grads:  [-0.10574885]
Stock Position:  -0.10574884542596452
Bond Position:  [13.30157567]


portfolio before change:  [1.87297411]
curr_Stock_Price:  108.08878633177537
curr_Factors:  [108.08878633]
mat_Sqrt:  [[0.15]]
grads:  [0.49262597]
Stock Position:  0.4926259685688522
Bond Position:  [-51.37436895]


portfolio before change:  [1.69294446]
curr_Stock_Price:  107.736374022729
curr_Factors:  [107.73637402]
mat_Sqrt:  [[0.15]]
grads:  [-0.01396651]
Stock Position:  -0.013966511025737377
Bond Position:  [3.19764571]


portfolio before change:  [1.68179242]
curr_Stock_Price:  108.56347849606182
curr_Factors:  [108.5634785]
mat_Sqrt:  [[0.15]]
grads:  [-0.10694093]
Stock Position:  -0.10694093037179687
Bond Position:  [13.29167182]


portfolio before change:  [1.74730746]
curr_Stock_Price:  107.96638745153264
curr_Factors:  [107.96638745]
mat_Sqrt:  [[0.15]]
grads:  [0.0263642]
Stock Position:  0.026364203612773935
Bond Position:  [-1.09914036]


portfolio before change:  [1.72781919]
curr_Stock_Price:  107.23240489935006
curr_Factors:  [107.2324049]
mat_Sqrt:  [[0.15]]
grads:  [0.04429009]
Stock Position:  0.04429008707480611
Bond Position:  [-3.02151336]


portfolio before change:  [1.71772884]
curr_Stock_Price:  107.01310876738525
curr_Factors:  [107.01310877]
mat_Sqrt:  [[0.15]]
grads:  [0.01272612]
Stock Position:  0.012726123245164339
Bond Position:  [0.35586682]


portfolio before change:  [1.70981315]
curr_Stock_Price:  106.3876101647268
curr_Factors:  [106.38761016]
mat_Sqrt:  [[0.15]]
grads:  [0.05257589]
Stock Position:  0.05257589306787597
Bond Position:  [-3.88361047]


portfolio before change:  [1.67675845]
curr_Stock_Price:  105.76813955481349
curr_Factors:  [105.76813955]
mat_Sqrt:  [[0.15]]
grads:  [0.02808145]
Stock Position:  0.028081452057863665
Bond Position:  [-1.29336449]


portfolio before change:  [1.67447009]
curr_Stock_Price:  105.69240698222697
curr_Factors:  [105.69240698]
mat_Sqrt:  [[0.15]]
grads:  [-0.21409414]
Stock Position:  -0.21409414427148873
Bond Position:  [24.30259551]


portfolio before change:  [1.5908465]
curr_Stock_Price:  106.09718965103816
curr_Factors:  [106.09718965]
mat_Sqrt:  [[0.15]]
grads:  [0.06505411]
Stock Position:  0.0650541140612121
Bond Position:  [-5.31121218]


portfolio before change:  [1.6010241]
curr_Stock_Price:  106.26384379623963
curr_Factors:  [106.2638438]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.6010241]
Stock Price:  106.25244558074104
PL:  [-4.65142149]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.15057847e-03]
 [ 2.56581594e-03]
 [-1.24374993e-02]
 [-1.47896727e-03]
 [ 3.55202021e-03]
 [-3.78776034e-03]
 [-5.18558490e-02]
 [ 2.33091460e-02]
 [-5.85091002e-03]
 [-6.62576993e-04]
 [-6.72656762e-03]
 [ 6.53930878e-03]
 [ 1.44754200e-02]
 [ 5.36314578e-03]
 [ 2.36937629e-02]
 [ 9.62604986e-04]
 [ 9.83503846e-03]
 [ 1.35777136e-02]
 [ 1.14499282e-02]
 [-1.35990809e-02]
 [-9.86898506e-03]
 [ 2.17508654e-02]
 [-2.46165261e-02]
 [ 5.94559915e-03]
 [-7.39809594e-03]
 [-6.42040034e-03]
 [ 8.41097864e-04]
 [-1.12520934e-02]
 [-1.70241707e-02]
 [-4.09219934e-03]
 [-3.37188285e-03]
 [ 5.61115842e-03]
 [ 8.52889530e-03]
 [-1.28460929e-02]
 [ 3.16260593e-03]
 [ 5.70933862e-03]
 [ 3.59127517e-03]
 [ 1.01207532e-02]
 [-1.77129217e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.74698887]
curr_Stock_Price:  100.82538299705972
curr_Factors:  [100.825383]
mat_Sqrt:  [[0.15]]
grads:  [0.04100386]
Stock Position:  0.041003856467358525
Bond Position:  [10.61275934]


portfolio before change:  [14.70507425]
curr_Stock_Price:  99.77081625665316
curr_Factors:  [99.77081626]
mat_Sqrt:  [[0.15]]
grads:  [0.01710544]
Stock Position:  0.017105439602988493
Bond Position:  [12.99845058]


portfolio before change:  [14.68663322]
curr_Stock_Price:  98.59774265195864
curr_Factors:  [98.59774265]
mat_Sqrt:  [[0.15]]
grads:  [-0.08291666]
Stock Position:  -0.08291666208395886
Bond Position:  [22.86202893]


portfolio before change:  [14.6523307]
curr_Stock_Price:  99.04590890794051
curr_Factors:  [99.04590891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985978]
Stock Position:  -0.00985978177331511
Bond Position:  [15.62890175]


portfolio before change:  [14.65404127]
curr_Stock_Price:  99.07057081677875
curr_Factors:  [99.07057082]
mat_Sqrt:  [[0.15]]
grads:  [0.02368013]
Stock Position:  0.02368013475861571
Bond Position:  [12.3080368]


portfolio before change:  [14.66031676]
curr_Stock_Price:  99.27060703097298
curr_Factors:  [99.27060703]
mat_Sqrt:  [[0.15]]
grads:  [-0.02525174]
Stock Position:  -0.025251735623410706
Bond Position:  [17.16707188]


portfolio before change:  [14.68793019]
curr_Stock_Price:  98.26206590378561
curr_Factors:  [98.2620659]
mat_Sqrt:  [[0.15]]
grads:  [-0.34570566]
Stock Position:  -0.3457056597528243
Bond Position:  [48.65768251]


portfolio before change:  [14.25371028]
curr_Stock_Price:  99.53569996289647
curr_Factors:  [99.53569996]
mat_Sqrt:  [[0.15]]
grads:  [0.15539431]
Stock Position:  0.15539430689214834
Bond Position:  [-1.21357083]


portfolio before change:  [14.17599677]
curr_Stock_Price:  99.03657096261936
curr_Factors:  [99.03657096]
mat_Sqrt:  [[0.15]]
grads:  [-0.03900607]
Stock Position:  -0.039006066789833524
Bond Position:  [18.03902387]


portfolio before change:  [14.23820684]
curr_Stock_Price:  97.49950097836557
curr_Factors:  [97.49950098]
mat_Sqrt:  [[0.15]]
grads:  [-0.00441718]
Stock Position:  -0.004417179956035045
Bond Position:  [14.66887968]


portfolio before change:  [14.2402658]
curr_Stock_Price:  97.44850935133366
curr_Factors:  [97.44850935]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484378]
Stock Position:  -0.04484378415939647
Bond Position:  [18.61022572]


portfolio before change:  [14.17951334]
curr_Stock_Price:  98.85514550971618
curr_Factors:  [98.85514551]
mat_Sqrt:  [[0.15]]
grads:  [0.04359539]
Stock Position:  0.04359539186270365
Bond Position:  [9.86988453]


portfolio before change:  [14.20712427]
curr_Stock_Price:  99.46018934808014
curr_Factors:  [99.46018935]
mat_Sqrt:  [[0.15]]
grads:  [0.0965028]
Stock Position:  0.09650280003034563
Bond Position:  [4.60893751]


portfolio before change:  [14.25191282]
curr_Stock_Price:  99.91833554965328
curr_Factors:  [99.91833555]
mat_Sqrt:  [[0.15]]
grads:  [0.03575431]
Stock Position:  0.03575430517291696
Bond Position:  [10.67940216]


portfolio before change:  [14.28616195]
curr_Stock_Price:  100.8388994257984
curr_Factors:  [100.83889943]
mat_Sqrt:  [[0.15]]
grads:  [0.15795842]
Stock Position:  0.15795841951443537
Bond Position:  [-1.64219123]


portfolio before change:  [14.27047488]
curr_Stock_Price:  100.74088767275057
curr_Factors:  [100.74088767]
mat_Sqrt:  [[0.15]]
grads:  [0.00641737]
Stock Position:  0.006417366572403254
Bond Position:  [13.62398368]


portfolio before change:  [14.27320216]
curr_Stock_Price:  100.90048215595009
curr_Factors:  [100.90048216]
mat_Sqrt:  [[0.15]]
grads:  [0.06556692]
Stock Position:  0.06556692306510527
Bond Position:  [7.65746801]


portfolio before change:  [14.27707715]
curr_Stock_Price:  100.94498248999106
curr_Factors:  [100.94498249]
mat_Sqrt:  [[0.15]]
grads:  [0.09051809]
Stock Position:  0.09051809055202896
Bond Position:  [5.13973009]


portfolio before change:  [14.24657722]
curr_Stock_Price:  100.60093588597687
curr_Factors:  [100.60093589]
mat_Sqrt:  [[0.15]]
grads:  [0.07633285]
Stock Position:  0.07633285461352508
Bond Position:  [6.56742061]


portfolio before change:  [14.31846481]
curr_Stock_Price:  101.53194534693753
curr_Factors:  [101.53194535]
mat_Sqrt:  [[0.15]]
grads:  [-0.09066054]
Stock Position:  -0.09066053947097744
Bond Position:  [23.52340575]


portfolio before change:  [14.28084563]
curr_Stock_Price:  101.97932616660935
curr_Factors:  [101.97932617]
mat_Sqrt:  [[0.15]]
grads:  [-0.06579323]
Stock Position:  -0.0657932337549595
Bond Position:  [20.99039528]


portfolio before change:  [14.30295944]
curr_Stock_Price:  101.68309752148406
curr_Factors:  [101.68309752]
mat_Sqrt:  [[0.15]]
grads:  [0.14500577]
Stock Position:  0.14500576904659637
Bond Position:  [-0.44167632]


portfolio before change:  [14.2812159]
curr_Stock_Price:  101.53352883008183
curr_Factors:  [101.53352883]
mat_Sqrt:  [[0.15]]
grads:  [-0.16411017]
Stock Position:  -0.16411017410466802
Bond Position:  [30.94390099]


portfolio before change:  [14.29796943]
curr_Stock_Price:  101.45501269443903
curr_Factors:  [101.45501269]
mat_Sqrt:  [[0.15]]
grads:  [0.03963733]
Stock Position:  0.03963732764798357
Bond Position:  [10.27656385]


portfolio before change:  [14.30964104]
curr_Stock_Price:  101.7170626368384
curr_Factors:  [101.71706264]
mat_Sqrt:  [[0.15]]
grads:  [-0.04932064]
Stock Position:  -0.04932063961841924
Bond Position:  [19.32639162]


portfolio before change:  [14.30202855]
curr_Stock_Price:  101.92039405666455
curr_Factors:  [101.92039406]
mat_Sqrt:  [[0.15]]
grads:  [-0.04280267]
Stock Position:  -0.04280266896089934
Bond Position:  [18.66449344]


portfolio before change:  [14.33974117]
curr_Stock_Price:  101.09382374411769
curr_Factors:  [101.09382374]
mat_Sqrt:  [[0.15]]
grads:  [0.00560732]
Stock Position:  0.005607319096493156
Bond Position:  [13.77287584]


portfolio before change:  [14.34256002]
curr_Stock_Price:  101.28948374839473
curr_Factors:  [101.28948375]
mat_Sqrt:  [[0.15]]
grads:  [-0.07501396]
Stock Position:  -0.0750139560136371
Bond Position:  [21.9406849]


portfolio before change:  [14.40698341]
curr_Stock_Price:  100.46722832331422
curr_Factors:  [100.46722832]
mat_Sqrt:  [[0.15]]
grads:  [-0.11349447]
Stock Position:  -0.11349447104388118
Bond Position:  [25.80945834]


portfolio before change:  [14.55957522]
curr_Stock_Price:  99.15116925807529
curr_Factors:  [99.15116926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728133]
Stock Position:  -0.02728132891655367
Bond Position:  [17.26455088]


portfolio before change:  [14.55589839]
curr_Stock_Price:  99.36505281874962
curr_Factors:  [99.36505282]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247922]
Stock Position:  -0.022479218967569152
Bond Position:  [16.78954717]


portfolio before change:  [14.56392812]
curr_Stock_Price:  99.10121370754467
curr_Factors:  [99.10121371]
mat_Sqrt:  [[0.15]]
grads:  [0.03740772]
Stock Position:  0.03740772278917856
Bond Position:  [10.85677739]


portfolio before change:  [14.51823781]
curr_Stock_Price:  97.84351922354226
curr_Factors:  [97.84351922]
mat_Sqrt:  [[0.15]]
grads:  [0.0568593]
Stock Position:  0.056859301976553214
Bond Position:  [8.95492361]


portfolio before change:  [14.42904605]
curr_Stock_Price:  96.25519167683062
curr_Factors:  [96.25519168]
mat_Sqrt:  [[0.15]]
grads:  [-0.08564062]
Stock Position:  -0.08564061920927445
Bond Position:  [22.67240027]


portfolio before change:  [14.34087015]
curr_Stock_Price:  97.31788983455854
curr_Factors:  [97.31788983]
mat_Sqrt:  [[0.15]]
grads:  [0.02108404]
Stock Position:  0.021084039537961285
Bond Position:  [12.28901591]


portfolio before change:  [14.34702019]
curr_Stock_Price:  97.53671976877865
curr_Factors:  [97.53671977]
mat_Sqrt:  [[0.15]]
grads:  [0.03806226]
Stock Position:  0.03806225744974155
Bond Position:  [10.63455245]


portfolio before change:  [14.34935045]
curr_Stock_Price:  97.56301505217981
curr_Factors:  [97.56301505]
mat_Sqrt:  [[0.15]]
grads:  [0.02394183]
Stock Position:  0.023941834457786318
Bond Position:  [12.0135129]


portfolio before change:  [14.37987933]
curr_Stock_Price:  98.77541549254097
curr_Factors:  [98.77541549]
mat_Sqrt:  [[0.15]]
grads:  [0.06747169]
Stock Position:  0.06747168816968958
Bond Position:  [7.71533529]


portfolio before change:  [14.36931116]
curr_Stock_Price:  98.6044898953849
curr_Factors:  [98.6044899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.36931116]
Stock Price:  98.90397654092897
PL:  [14.36931116]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.06582657e-02]
 [-1.11213489e-02]
 [-1.47751398e-02]
 [-2.35245108e-03]
 [ 1.53582963e-02]
 [ 2.50844440e-02]
 [-6.26384095e-03]
 [ 1.14903512e-02]
 [-7.18349337e-03]
 [-2.19003000e-03]
 [ 9.96165684e-03]
 [ 5.14639936e-03]
 [ 1.09233581e-02]
 [ 2.51485378e-03]
 [ 1.03088051e-02]
 [-3.32902161e-03]
 [ 1.04722552e-02]
 [ 2.00746793e-03]
 [ 1.01547295e-02]
 [-7.11582797e-03]
 [ 6.84221159e-03]
 [ 1.72804227e-02]
 [ 1.37733147e-02]
 [ 5.16448250e-03]
 [ 1.20144020e-02]
 [-1.10466894e-02]
 [ 6.40407861e-03]
 [-1.12156689e-02]
 [-1.77251255e-02]
 [-3.84128012e-03]
 [-3.42521570e-03]
 [ 5.52070508e-03]
 [ 5.91062534e-03]
 [-1.20039951e-02]
 [ 5.92857816e-03]
 [ 5.71612189e-03]
 [ 3.26005443e-03]
 [ 8.29777369e-03]
 [-4.57699539e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.49104065]
curr_Stock_Price:  98.6167093119087
curr_Factors:  [98.61670931]
mat_Sqrt:  [[0.15]]
grads:  [0.0710551]
Stock Position:  0.07105510459862899
Bond Position:  [-26.49826125]


portfolio before change:  [-19.48594519]
curr_Stock_Price:  98.73503931426812
curr_Factors:  [98.73503931]
mat_Sqrt:  [[0.15]]
grads:  [-0.07414233]
Stock Position:  -0.07414232598611596
Bond Position:  [-12.16549972]


portfolio before change:  [-19.46412764]
curr_Stock_Price:  98.42026183329138
curr_Factors:  [98.42026183]
mat_Sqrt:  [[0.15]]
grads:  [-0.09850093]
Stock Position:  -0.0985009318933816
Bond Position:  [-9.76964013]


portfolio before change:  [-19.55915243]
curr_Stock_Price:  99.37257271536096
curr_Factors:  [99.37257272]
mat_Sqrt:  [[0.15]]
grads:  [-0.01568301]
Stock Position:  -0.015683007209131707
Bond Position:  [-18.00069166]


portfolio before change:  [-19.58167665]
curr_Stock_Price:  100.66530888138841
curr_Factors:  [100.66530888]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-29.88866093]


portfolio before change:  [-19.59762517]
curr_Stock_Price:  100.54603585902832
curr_Factors:  [100.54603586]
mat_Sqrt:  [[0.15]]
grads:  [0.16722963]
Stock Position:  0.16722962679666606
Bond Position:  [-36.41190122]


portfolio before change:  [-19.50308869]
curr_Stock_Price:  101.13856394215756
curr_Factors:  [101.13856394]
mat_Sqrt:  [[0.15]]
grads:  [-0.04175894]
Stock Position:  -0.04175893967189304
Bond Position:  [-15.2796495]


portfolio before change:  [-19.52486105]
curr_Stock_Price:  101.61420551375106
curr_Factors:  [101.61420551]
mat_Sqrt:  [[0.15]]
grads:  [0.07660234]
Stock Position:  0.07660234138136814
Bond Position:  [-27.30874711]


portfolio before change:  [-19.56472893]
curr_Stock_Price:  101.13831833234522
curr_Factors:  [101.13831833]
mat_Sqrt:  [[0.15]]
grads:  [-0.04788996]
Stock Position:  -0.04788995580212148
Bond Position:  [-14.72121934]


portfolio before change:  [-19.58597453]
curr_Stock_Price:  101.54352507261487
curr_Factors:  [101.54352507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0146002]
Stock Position:  -0.014600199969520871
Bond Position:  [-18.10341876]


portfolio before change:  [-19.58878542]
curr_Stock_Price:  101.58104664755365
curr_Factors:  [101.58104665]
mat_Sqrt:  [[0.15]]
grads:  [0.06641105]
Stock Position:  0.06641104560269322
Bond Position:  [-26.33488894]


portfolio before change:  [-19.58356797]
curr_Stock_Price:  101.7091807303913
curr_Factors:  [101.70918073]
mat_Sqrt:  [[0.15]]
grads:  [0.03430933]
Stock Position:  0.034309329083988704
Bond Position:  [-23.07314172]


portfolio before change:  [-19.59956315]
curr_Stock_Price:  101.32704390908509
curr_Factors:  [101.32704391]
mat_Sqrt:  [[0.15]]
grads:  [0.07282239]
Stock Position:  0.07282238705391407
Bond Position:  [-26.97844036]


portfolio before change:  [-19.66488038]
curr_Stock_Price:  100.4764165688893
curr_Factors:  [100.47641657]
mat_Sqrt:  [[0.15]]
grads:  [0.01676569]
Stock Position:  0.01676569189900381
Bond Position:  [-21.34943703]


portfolio before change:  [-19.68955299]
curr_Stock_Price:  99.16398878136528
curr_Factors:  [99.16398878]
mat_Sqrt:  [[0.15]]
grads:  [0.06872537]
Stock Position:  0.06872536713071208
Bond Position:  [-26.50463452]


portfolio before change:  [-19.76108223]
curr_Stock_Price:  98.17140111918735
curr_Factors:  [98.17140112]
mat_Sqrt:  [[0.15]]
grads:  [-0.02219348]
Stock Position:  -0.022193477412724892
Bond Position:  [-17.58231745]


portfolio before change:  [-19.79461003]
curr_Stock_Price:  99.58307166782488
curr_Factors:  [99.58307167]
mat_Sqrt:  [[0.15]]
grads:  [0.06981503]
Stock Position:  0.06981503472958349
Bond Position:  [-26.74700564]


portfolio before change:  [-19.80396621]
curr_Stock_Price:  99.49694988669519
curr_Factors:  [99.49694989]
mat_Sqrt:  [[0.15]]
grads:  [0.01338312]
Stock Position:  0.013383119545757721
Bond Position:  [-21.13554579]


portfolio before change:  [-19.81140215]
curr_Stock_Price:  99.13875027625336
curr_Factors:  [99.13875028]
mat_Sqrt:  [[0.15]]
grads:  [0.0676982]
Stock Position:  0.06769819699479136
Bond Position:  [-26.52291679]


portfolio before change:  [-19.86316105]
curr_Stock_Price:  98.42317238612948
curr_Factors:  [98.42317239]
mat_Sqrt:  [[0.15]]
grads:  [-0.04743885]
Stock Position:  -0.047438853114609374
Bond Position:  [-15.19407864]


portfolio before change:  [-19.89759866]
curr_Stock_Price:  99.10907059107456
curr_Factors:  [99.10907059]
mat_Sqrt:  [[0.15]]
grads:  [0.04561474]
Stock Position:  0.04561474394741161
Bond Position:  [-24.41843353]


portfolio before change:  [-19.83666522]
curr_Stock_Price:  100.51181731542651
curr_Factors:  [100.51181732]
mat_Sqrt:  [[0.15]]
grads:  [0.11520282]
Stock Position:  0.1152028179280433
Bond Position:  [-31.41590981]


portfolio before change:  [-19.95432313]
curr_Stock_Price:  99.52459598864421
curr_Factors:  [99.52459599]
mat_Sqrt:  [[0.15]]
grads:  [0.0918221]
Stock Position:  0.09182209804125747
Bond Position:  [-29.09288034]


portfolio before change:  [-19.97263062]
curr_Stock_Price:  99.36482346455566
curr_Factors:  [99.36482346]
mat_Sqrt:  [[0.15]]
grads:  [0.03442988]
Stock Position:  0.03442988331838144
Bond Position:  [-23.39374989]


portfolio before change:  [-19.99690362]
curr_Stock_Price:  98.74476329542493
curr_Factors:  [98.7447633]
mat_Sqrt:  [[0.15]]
grads:  [0.08009601]
Stock Position:  0.08009601318950314
Bond Position:  [-27.90596548]


portfolio before change:  [-19.95564282]
curr_Stock_Price:  99.3034585719669
curr_Factors:  [99.30345857]
mat_Sqrt:  [[0.15]]
grads:  [-0.0736446]
Stock Position:  -0.07364459622083551
Bond Position:  [-12.64247971]


portfolio before change:  [-19.99562423]
curr_Stock_Price:  99.82489544851576
curr_Factors:  [99.82489545]
mat_Sqrt:  [[0.15]]
grads:  [0.04269386]
Stock Position:  0.04269385740440629
Bond Position:  [-24.25753409]


portfolio before change:  [-19.96351413]
curr_Stock_Price:  100.64802299763909
curr_Factors:  [100.648023]
mat_Sqrt:  [[0.15]]
grads:  [-0.07477113]
Stock Position:  -0.0747711263152262
Bond Position:  [-12.43794808]


portfolio before change:  [-19.9094267]
curr_Stock_Price:  99.90385517052884
curr_Factors:  [99.90385517]
mat_Sqrt:  [[0.15]]
grads:  [-0.1181675]
Stock Position:  -0.11816750324566583
Bond Position:  [-8.10403757]


portfolio before change:  [-19.80716493]
curr_Stock_Price:  99.02988528617216
curr_Factors:  [99.02988529]
mat_Sqrt:  [[0.15]]
grads:  [-0.02560853]
Stock Position:  -0.025608534135412746
Bond Position:  [-17.27115473]


portfolio before change:  [-19.81315981]
curr_Stock_Price:  99.1796733366512
curr_Factors:  [99.17967334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02283477]
Stock Position:  -0.022834771346099382
Bond Position:  [-17.54841465]


portfolio before change:  [-19.82303949]
curr_Stock_Price:  99.5162650895934
curr_Factors:  [99.51626509]
mat_Sqrt:  [[0.15]]
grads:  [0.0368047]
Stock Position:  0.036804700556864356
Bond Position:  [-23.48570583]


portfolio before change:  [-19.82639942]
curr_Stock_Price:  99.50474402237587
curr_Factors:  [99.50474402]
mat_Sqrt:  [[0.15]]
grads:  [0.03940417]
Stock Position:  0.039404168934955075
Bond Position:  [-23.74730116]


portfolio before change:  [-19.84395706]
curr_Stock_Price:  99.13450301029835
curr_Factors:  [99.13450301]
mat_Sqrt:  [[0.15]]
grads:  [-0.08002663]
Stock Position:  -0.08002663378279483
Bond Position:  [-11.91055649]


portfolio before change:  [-19.78633687]
curr_Stock_Price:  98.39588516138718
curr_Factors:  [98.39588516]
mat_Sqrt:  [[0.15]]
grads:  [0.03952385]
Stock Position:  0.039523854418608964
Bond Position:  [-23.67532151]


portfolio before change:  [-19.76361759]
curr_Stock_Price:  99.04559096824543
curr_Factors:  [99.04559097]
mat_Sqrt:  [[0.15]]
grads:  [0.03810748]
Stock Position:  0.03810747926641139
Bond Position:  [-23.5379954]


portfolio before change:  [-19.77642096]
curr_Stock_Price:  98.78682457397504
curr_Factors:  [98.78682457]
mat_Sqrt:  [[0.15]]
grads:  [0.0217337]
Stock Position:  0.021733696225205466
Bond Position:  [-21.9234238]


portfolio before change:  [-19.75236887]
curr_Stock_Price:  100.01959628806205
curr_Factors:  [100.01959629]
mat_Sqrt:  [[0.15]]
grads:  [0.05531849]
Stock Position:  0.05531849128892931
Bond Position:  [-25.28530204]


portfolio before change:  [-19.76547593]
curr_Stock_Price:  99.83979761341827
curr_Factors:  [99.83979761]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.76547593]
Stock Price:  99.51499693339845
PL:  [-19.76547593]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.98098919e-03]
 [-3.18647081e-03]
 [ 3.43928024e-03]
 [ 3.87856538e-03]
 [-7.38843543e-03]
 [-1.79693084e-02]
 [-1.73701664e-02]
 [ 1.91308603e-02]
 [-6.37919891e-03]
 [-1.22057626e-03]
 [-5.88295998e-03]
 [ 7.38422683e-03]
 [ 1.38198408e-02]
 [ 2.87921653e-03]
 [ 1.32129224e-02]
 [-3.14255100e-03]
 [ 1.04726070e-02]
 [ 5.31135301e-03]
 [ 1.13490233e-02]
 [-9.35633889e-03]
 [ 3.32629641e-03]
 [ 1.12717150e-02]
 [ 1.51497444e-02]
 [ 5.19754291e-03]
 [ 8.09263119e-03]
 [-1.07255776e-02]
 [ 4.84453627e-03]
 [-1.16970980e-02]
 [-1.81145532e-02]
 [-2.24160938e-03]
 [-3.88029239e-03]
 [ 5.61875466e-03]
 [ 8.05541839e-03]
 [-1.25742681e-02]
 [ 3.31539632e-03]
 [ 5.71003565e-03]
 [ 3.56234479e-03]
 [ 1.14259750e-02]
 [-2.90052120e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.38140977]
curr_Stock_Price:  99.59142206819016
curr_Factors:  [99.59142207]
mat_Sqrt:  [[0.15]]
grads:  [0.02653993]
Stock Position:  0.026539927932568645
Bond Position:  [-7.02455893]


portfolio before change:  [-4.38812819]
curr_Stock_Price:  99.37136487085138
curr_Factors:  [99.37136487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02124314]
Stock Position:  -0.02124313875869234
Bond Position:  [-2.2771685]


portfolio before change:  [-4.39083776]
curr_Stock_Price:  99.48551456979807
curr_Factors:  [99.48551457]
mat_Sqrt:  [[0.15]]
grads:  [0.02292853]
Stock Position:  0.022928534939086993
Bond Position:  [-6.67189485]


portfolio before change:  [-4.42600695]
curr_Stock_Price:  97.98802871690086
curr_Factors:  [97.98802872]
mat_Sqrt:  [[0.15]]
grads:  [0.0258571]
Stock Position:  0.02585710253467401
Bond Position:  [-6.95969346]


portfolio before change:  [-4.41042745]
curr_Stock_Price:  98.62419877838298
curr_Factors:  [98.62419878]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925624]
Stock Position:  -0.04925623618551778
Bond Position:  [0.44742937]


portfolio before change:  [-4.41751205]
curr_Stock_Price:  98.76916583368558
curr_Factors:  [98.76916583]
mat_Sqrt:  [[0.15]]
grads:  [-0.11979539]
Stock Position:  -0.11979538935285415
Bond Position:  [7.41457862]


portfolio before change:  [-4.46466059]
curr_Stock_Price:  99.17047854160333
curr_Factors:  [99.17047854]
mat_Sqrt:  [[0.15]]
grads:  [-0.11580111]
Stock Position:  -0.11580110923638999
Bond Position:  [7.01939083]


portfolio before change:  [-4.29856686]
curr_Stock_Price:  97.74375429513381
curr_Factors:  [97.7437543]
mat_Sqrt:  [[0.15]]
grads:  [0.12753907]
Stock Position:  0.1275390685054057
Bond Position:  [-16.76471423]


portfolio before change:  [-4.38971307]
curr_Stock_Price:  97.0455330370695
curr_Factors:  [97.04553304]
mat_Sqrt:  [[0.15]]
grads:  [-0.04252799]
Stock Position:  -0.04252799270243489
Bond Position:  [-0.26256134]


portfolio before change:  [-4.41890309]
curr_Stock_Price:  97.731133362591
curr_Factors:  [97.73113336]
mat_Sqrt:  [[0.15]]
grads:  [-0.00813718]
Stock Position:  -0.00813717508892495
Bond Position:  [-3.62364775]


portfolio before change:  [-4.41819844]
curr_Stock_Price:  97.58886862523642
curr_Factors:  [97.58886863]
mat_Sqrt:  [[0.15]]
grads:  [-0.03921973]
Stock Position:  -0.039219733173707305
Bond Position:  [-0.59078906]


portfolio before change:  [-4.41378038]
curr_Stock_Price:  97.47433659887614
curr_Factors:  [97.4743366]
mat_Sqrt:  [[0.15]]
grads:  [0.04922818]
Stock Position:  0.049228178876413176
Bond Position:  [-9.21226446]


portfolio before change:  [-4.34453033]
curr_Stock_Price:  98.90444542225387
curr_Factors:  [98.90444542]
mat_Sqrt:  [[0.15]]
grads:  [0.09213227]
Stock Position:  0.09213227189011051
Bond Position:  [-13.45682159]


portfolio before change:  [-4.37305239]
curr_Stock_Price:  98.6131267950237
curr_Factors:  [98.6131268]
mat_Sqrt:  [[0.15]]
grads:  [0.01919478]
Stock Position:  0.01919477685215237
Bond Position:  [-6.26590935]


portfolio before change:  [-4.3570609]
curr_Stock_Price:  99.4870509657083
curr_Factors:  [99.48705097]
mat_Sqrt:  [[0.15]]
grads:  [0.08808615]
Stock Position:  0.08808614948979886
Bond Position:  [-13.12049214]


portfolio before change:  [-4.38632342]
curr_Stock_Price:  99.17346747480289
curr_Factors:  [99.17346747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095034]
Stock Position:  -0.02095034000504883
Bond Position:  [-2.30860556]


portfolio before change:  [-4.39519015]
curr_Stock_Price:  99.5829180661335
curr_Factors:  [99.58291807]
mat_Sqrt:  [[0.15]]
grads:  [0.06981738]
Stock Position:  0.06981738027867192
Bond Position:  [-11.34780861]


portfolio before change:  [-4.38178892]
curr_Stock_Price:  99.7951830936722
curr_Factors:  [99.79518309]
mat_Sqrt:  [[0.15]]
grads:  [0.03540902]
Stock Position:  0.03540902003917118
Bond Position:  [-7.91543856]


portfolio before change:  [-4.3867436]
curr_Stock_Price:  99.68320072854426
curr_Factors:  [99.68320073]
mat_Sqrt:  [[0.15]]
grads:  [0.07566016]
Stock Position:  0.07566015551372175
Bond Position:  [-11.92879007]


portfolio before change:  [-4.45669521]
curr_Stock_Price:  98.77835958639552
curr_Factors:  [98.77835959]
mat_Sqrt:  [[0.15]]
grads:  [-0.06237559]
Stock Position:  -0.062375592608572054
Bond Position:  [1.7046635]


portfolio before change:  [-4.49754889]
curr_Stock_Price:  99.4367384568829
curr_Factors:  [99.43673846]
mat_Sqrt:  [[0.15]]
grads:  [0.02217531]
Stock Position:  0.022175309413965533
Bond Position:  [-6.70258933]


portfolio before change:  [-4.49463865]
curr_Stock_Price:  99.60576068176047
curr_Factors:  [99.60576068]
mat_Sqrt:  [[0.15]]
grads:  [0.07514477]
Stock Position:  0.07514476664383438
Bond Position:  [-11.97949029]


portfolio before change:  [-4.52183004]
curr_Stock_Price:  99.26383574447183
curr_Factors:  [99.26383574]
mat_Sqrt:  [[0.15]]
grads:  [0.1009983]
Stock Position:  0.10099829615193663
Bond Position:  [-14.54730832]


portfolio before change:  [-4.50271501]
curr_Stock_Price:  99.47110224980209
curr_Factors:  [99.47110225]
mat_Sqrt:  [[0.15]]
grads:  [0.03465029]
Stock Position:  0.03465028608641878
Bond Position:  [-7.94941716]


portfolio before change:  [-4.51632593]
curr_Stock_Price:  99.106973083006
curr_Factors:  [99.10697308]
mat_Sqrt:  [[0.15]]
grads:  [0.05395087]
Stock Position:  0.05395087456720534
Bond Position:  [-9.8632338]


portfolio before change:  [-4.52578517]
curr_Stock_Price:  98.95449628523258
curr_Factors:  [98.95449629]
mat_Sqrt:  [[0.15]]
grads:  [-0.07150385]
Stock Position:  -0.07150385046477498
Bond Position:  [2.54984234]


portfolio before change:  [-4.5987136]
curr_Stock_Price:  99.97887725824528
curr_Factors:  [99.97887726]
mat_Sqrt:  [[0.15]]
grads:  [0.03229691]
Stock Position:  0.032296908470195354
Bond Position:  [-7.82772225]


portfolio before change:  [-4.64607187]
curr_Stock_Price:  98.5428343172822
curr_Factors:  [98.54283432]
mat_Sqrt:  [[0.15]]
grads:  [-0.07798065]
Stock Position:  -0.0779806534895138
Bond Position:  [3.03836274]


portfolio before change:  [-4.71524177]
curr_Stock_Price:  99.43471857349074
curr_Factors:  [99.43471857]
mat_Sqrt:  [[0.15]]
grads:  [-0.12076369]
Stock Position:  -0.1207636879408097
Bond Position:  [7.29286155]


portfolio before change:  [-4.59224378]
curr_Stock_Price:  98.42376628153028
curr_Factors:  [98.42376628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494406]
Stock Position:  -0.0149440625068848
Bond Position:  [-3.12139286]


portfolio before change:  [-4.58110496]
curr_Stock_Price:  97.65228782842067
curr_Factors:  [97.65228783]
mat_Sqrt:  [[0.15]]
grads:  [-0.02586862]
Stock Position:  -0.025868615930276756
Bond Position:  [-2.05497543]


portfolio before change:  [-4.58506383]
curr_Stock_Price:  97.79539510452638
curr_Factors:  [97.7953951]
mat_Sqrt:  [[0.15]]
grads:  [0.03745836]
Stock Position:  0.03745836443078183
Bond Position:  [-8.24831938]


portfolio before change:  [-4.57546586]
curr_Stock_Price:  98.0791521820993
curr_Factors:  [98.07915218]
mat_Sqrt:  [[0.15]]
grads:  [0.05370279]
Stock Position:  0.053702789295654925
Bond Position:  [-9.8425899]


portfolio before change:  [-4.56426382]
curr_Stock_Price:  98.31065680270905
curr_Factors:  [98.3106568]
mat_Sqrt:  [[0.15]]
grads:  [-0.08382845]
Stock Position:  -0.08382845385581511
Bond Position:  [3.67696654]


portfolio before change:  [-4.50958665]
curr_Stock_Price:  97.66388931304184
curr_Factors:  [97.66388931]
mat_Sqrt:  [[0.15]]
grads:  [0.02210264]
Stock Position:  0.02210264216452595
Bond Position:  [-6.66821665]


portfolio before change:  [-4.51307561]
curr_Stock_Price:  97.54375039428652
curr_Factors:  [97.54375039]
mat_Sqrt:  [[0.15]]
grads:  [0.0380669]
Stock Position:  0.038066904340588965
Bond Position:  [-8.22626423]


portfolio before change:  [-4.49255668]
curr_Stock_Price:  98.10978742428588
curr_Factors:  [98.10978742]
mat_Sqrt:  [[0.15]]
grads:  [0.02374897]
Stock Position:  0.023748965279782982
Bond Position:  [-6.82256262]


portfolio before change:  [-4.49753083]
curr_Stock_Price:  97.93625270128749
curr_Factors:  [97.9362527]
mat_Sqrt:  [[0.15]]
grads:  [0.07617317]
Stock Position:  0.07617316669149374
Bond Position:  [-11.95764533]


portfolio before change:  [-4.59600915]
curr_Stock_Price:  96.66305472561535
curr_Factors:  [96.66305473]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.59600915]
Stock Price:  97.1293477862089
PL:  [-4.59600915]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.42793132e-03]
 [-7.22230481e-03]
 [-1.34024719e-02]
 [ 5.51493972e-03]
 [-4.38172587e-02]
 [-6.07428818e-03]
 [-4.58214514e-03]
 [ 2.29508872e-02]
 [-6.09209223e-03]
 [-3.99434650e-04]
 [-6.61412021e-03]
 [ 7.59623563e-03]
 [ 1.38786978e-02]
 [ 8.53218458e-05]
 [-5.87053305e-03]
 [-7.74792250e-03]
 [ 2.06049951e-02]
 [-2.98257020e-02]
 [-9.00230050e-05]
 [ 9.36418811e-03]
 [ 2.65971474e-02]
 [ 1.91420995e-04]
 [ 2.78088482e-02]
 [ 1.47610604e-04]
 [ 9.00589036e-03]
 [ 2.73803902e-02]
 [ 3.50476343e-02]
 [-2.52471217e-02]
 [-4.74179713e-02]
 [ 1.69355703e-03]
 [-4.12399827e-03]
 [ 5.58182952e-03]
 [ 1.29371771e-02]
 [-1.28009401e-02]
 [ 8.09373416e-03]
 [ 5.71382545e-03]
 [ 2.99494137e-03]
 [ 8.59992015e-03]
 [-9.42198198e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.33238254]
curr_Stock_Price:  99.53007541453583
curr_Factors:  [99.53007541]
mat_Sqrt:  [[0.15]]
grads:  [0.02951954]
Stock Position:  0.029519542101036276
Bond Position:  [-8.27046479]


portfolio before change:  [-5.3469648]
curr_Stock_Price:  99.07111222659292
curr_Factors:  [99.07111223]
mat_Sqrt:  [[0.15]]
grads:  [-0.0481487]
Stock Position:  -0.04814869870621023
Bond Position:  [-0.57681966]


portfolio before change:  [-5.32071722]
curr_Stock_Price:  98.52447898200829
curr_Factors:  [98.52447898]
mat_Sqrt:  [[0.15]]
grads:  [-0.08934981]
Stock Position:  -0.089349812484709
Bond Position:  [3.4824265]


portfolio before change:  [-5.24598663]
curr_Stock_Price:  97.69296893765409
curr_Factors:  [97.69296894]
mat_Sqrt:  [[0.15]]
grads:  [0.03676626]
Stock Position:  0.03676626477351257
Bond Position:  [-8.83779219]


portfolio before change:  [-5.25542804]
curr_Stock_Price:  97.46622259610153
curr_Factors:  [97.4662226]
mat_Sqrt:  [[0.15]]
grads:  [-0.29211506]
Stock Position:  -0.29211505814461963
Bond Position:  [23.21592324]


portfolio before change:  [-5.75929029]
curr_Stock_Price:  99.20103361190932
curr_Factors:  [99.20103361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049525]
Stock Position:  -0.040495254516681005
Bond Position:  [-1.74211918]


portfolio before change:  [-5.78562128]
curr_Stock_Price:  99.84587991794304
curr_Factors:  [99.84587992]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054763]
Stock Position:  -0.03054763426339613
Bond Position:  [-2.73556586]


portfolio before change:  [-5.78304029]
curr_Stock_Price:  99.75019482425685
curr_Factors:  [99.75019482]
mat_Sqrt:  [[0.15]]
grads:  [0.15300591]
Stock Position:  0.15300591440470737
Bond Position:  [-21.04541006]


portfolio before change:  [-6.07370677]
curr_Stock_Price:  97.86768173798417
curr_Factors:  [97.86768174]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061395]
Stock Position:  -0.04061394823277743
Bond Position:  [-2.09891381]


portfolio before change:  [-6.05595631]
curr_Stock_Price:  97.42416820324408
curr_Factors:  [97.4241682]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026629]
Stock Position:  -0.002662897664398526
Bond Position:  [-5.79652572]


portfolio before change:  [-6.05680018]
curr_Stock_Price:  97.46895345845586
curr_Factors:  [97.46895346]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409413]
Stock Position:  -0.04409413473703792
Bond Position:  [-1.75899102]


portfolio before change:  [-6.01227264]
curr_Stock_Price:  96.4541375833084
curr_Factors:  [96.45413758]
mat_Sqrt:  [[0.15]]
grads:  [0.05064157]
Stock Position:  0.050641570851163
Bond Position:  [-10.89686169]


portfolio before change:  [-6.04976962]
curr_Stock_Price:  95.7405977271
curr_Factors:  [95.74059773]
mat_Sqrt:  [[0.15]]
grads:  [0.09252465]
Stock Position:  0.0925246521638109
Bond Position:  [-14.90813512]


portfolio before change:  [-6.00088607]
curr_Stock_Price:  96.28906972216537
curr_Factors:  [96.28906972]
mat_Sqrt:  [[0.15]]
grads:  [0.00056881]
Stock Position:  0.0005688123050038754
Bond Position:  [-6.05565648]


portfolio before change:  [-6.0019667]
curr_Stock_Price:  95.72011956076759
curr_Factors:  [95.72011956]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913689]
Stock Position:  -0.03913688703021973
Bond Position:  [-2.25577919]


portfolio before change:  [-6.01505173]
curr_Stock_Price:  96.04725446507643
curr_Factors:  [96.04725447]
mat_Sqrt:  [[0.15]]
grads:  [-0.05165282]
Stock Position:  -0.05165281667379086
Bond Position:  [-1.0539405]


portfolio before change:  [-5.99539029]
curr_Stock_Price:  95.66405774844101
curr_Factors:  [95.66405775]
mat_Sqrt:  [[0.15]]
grads:  [0.13736663]
Stock Position:  0.13736663422510265
Bond Position:  [-19.13643992]


portfolio before change:  [-6.05593286]
curr_Stock_Price:  95.24073543880152
curr_Factors:  [95.24073544]
mat_Sqrt:  [[0.15]]
grads:  [-0.19883801]
Stock Position:  -0.1988380135740995
Bond Position:  [12.88154579]


portfolio before change:  [-5.81947242]
curr_Stock_Price:  94.05962252706091
curr_Factors:  [94.05962253]
mat_Sqrt:  [[0.15]]
grads:  [-0.00060015]
Stock Position:  -0.0006001533668077246
Bond Position:  [-5.76302222]


portfolio before change:  [-5.8201376]
curr_Stock_Price:  93.96758003646322
curr_Factors:  [93.96758004]
mat_Sqrt:  [[0.15]]
grads:  [0.06242792]
Stock Position:  0.06242792073015739
Bond Position:  [-11.68633824]


portfolio before change:  [-5.78301772]
curr_Stock_Price:  94.58558499431419
curr_Factors:  [94.58558499]
mat_Sqrt:  [[0.15]]
grads:  [0.17731432]
Stock Position:  0.1773143157181551
Bond Position:  [-22.554396]


portfolio before change:  [-5.76947036]
curr_Stock_Price:  94.6778891082145
curr_Factors:  [94.67788911]
mat_Sqrt:  [[0.15]]
grads:  [0.00127614]
Stock Position:  0.0012761399674180523
Bond Position:  [-5.89029259]


portfolio before change:  [-5.76992577]
curr_Stock_Price:  94.89802271533631
curr_Factors:  [94.89802272]
mat_Sqrt:  [[0.15]]
grads:  [0.18539232]
Stock Position:  0.18539232146061085
Bond Position:  [-23.3632905]


portfolio before change:  [-5.90746774]
curr_Stock_Price:  94.17187947406751
curr_Factors:  [94.17187947]
mat_Sqrt:  [[0.15]]
grads:  [0.00098407]
Stock Position:  0.0009840706920405974
Bond Position:  [-6.00013953]


portfolio before change:  [-5.90890496]
curr_Stock_Price:  93.47360509775365
curr_Factors:  [93.4736051]
mat_Sqrt:  [[0.15]]
grads:  [0.06003927]
Stock Position:  0.06003926909286854
Bond Position:  [-11.52099189]


portfolio before change:  [-5.97776415]
curr_Stock_Price:  92.35069041889017
curr_Factors:  [92.35069042]
mat_Sqrt:  [[0.15]]
grads:  [0.18253593]
Stock Position:  0.18253593495960707
Bond Position:  [-22.83508377]


portfolio before change:  [-5.85861811]
curr_Stock_Price:  93.01905526204601
curr_Factors:  [93.01905526]
mat_Sqrt:  [[0.15]]
grads:  [0.2336509]
Stock Position:  0.23365089564577946
Bond Position:  [-27.59260368]


portfolio before change:  [-5.61744986]
curr_Stock_Price:  94.06599130306041
curr_Factors:  [94.0659913]
mat_Sqrt:  [[0.15]]
grads:  [-0.16831414]
Stock Position:  -0.16831414481296073
Bond Position:  [10.21518702]


portfolio before change:  [-5.63471907]
curr_Stock_Price:  94.1761792813375
curr_Factors:  [94.17617928]
mat_Sqrt:  [[0.15]]
grads:  [-0.31611981]
Stock Position:  -0.3161198084820153
Bond Position:  [24.13623668]


portfolio before change:  [-5.9368542]
curr_Stock_Price:  95.14148525809273
curr_Factors:  [95.14148526]
mat_Sqrt:  [[0.15]]
grads:  [0.01129038]
Stock Position:  0.011290380230498416
Bond Position:  [-7.01103774]


portfolio before change:  [-5.92577484]
curr_Stock_Price:  96.2004209730817
curr_Factors:  [96.20042097]
mat_Sqrt:  [[0.15]]
grads:  [-0.02749332]
Stock Position:  -0.027493321827098446
Bond Position:  [-3.28090571]


portfolio before change:  [-5.91338637]
curr_Stock_Price:  95.73490391710172
curr_Factors:  [95.73490392]
mat_Sqrt:  [[0.15]]
grads:  [0.0372122]
Stock Position:  0.03721219682565264
Bond Position:  [-9.47589246]


portfolio before change:  [-5.90883018]
curr_Stock_Price:  95.88917466329607
curr_Factors:  [95.88917466]
mat_Sqrt:  [[0.15]]
grads:  [0.08624785]
Stock Position:  0.08624784725465219
Bond Position:  [-14.17906507]


portfolio before change:  [-5.80791406]
curr_Stock_Price:  97.07979696217949
curr_Factors:  [97.07979696]
mat_Sqrt:  [[0.15]]
grads:  [-0.0853396]
Stock Position:  -0.08533960058437275
Bond Position:  [2.47683703]


portfolio before change:  [-5.94435116]
curr_Stock_Price:  98.68217991916495
curr_Factors:  [98.68217992]
mat_Sqrt:  [[0.15]]
grads:  [0.05395823]
Stock Position:  0.05395822770848306
Bond Position:  [-11.2690667]


portfolio before change:  [-5.9602329]
curr_Stock_Price:  98.41395363162721
curr_Factors:  [98.41395363]
mat_Sqrt:  [[0.15]]
grads:  [0.03809217]
Stock Position:  0.038092169671723075
Bond Position:  [-9.70903392]


portfolio before change:  [-5.9332759]
curr_Stock_Price:  99.15349417730314
curr_Factors:  [99.15349418]
mat_Sqrt:  [[0.15]]
grads:  [0.01996628]
Stock Position:  0.019966275788049593
Bond Position:  [-7.91300191]


portfolio before change:  [-5.92297998]
curr_Stock_Price:  99.71870251481612
curr_Factors:  [99.71870251]
mat_Sqrt:  [[0.15]]
grads:  [0.0573328]
Stock Position:  0.05733280098089498
Bond Position:  [-11.64013251]


portfolio before change:  [-5.86965308]
curr_Stock_Price:  100.67421153925082
curr_Factors:  [100.67421154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.86965308]
Stock Price:  100.05300003921278
PL:  [-5.92265312]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.13552120e-03]
 [ 2.97457541e-03]
 [ 1.36578741e-02]
 [ 7.15393346e-03]
 [ 1.53582963e-02]
 [ 1.79619128e-02]
 [-1.79991597e-03]
 [ 2.14089626e-02]
 [-5.91920363e-03]
 [ 2.91009550e-03]
 [ 1.07079929e-02]
 [ 4.03868969e-03]
 [ 1.07121961e-02]
 [-4.89365916e-03]
 [ 5.08353005e-03]
 [ 2.99356166e-03]
 [ 9.13845385e-03]
 [ 1.22849434e-03]
 [ 1.15359525e-02]
 [-1.52723470e-02]
 [ 3.32342980e-03]
 [ 2.22500129e-02]
 [-3.09802202e-02]
 [ 6.39957189e-03]
 [ 2.36192854e-03]
 [-7.00538332e-03]
 [-5.45657750e-04]
 [-1.12480785e-02]
 [ 4.05047407e-02]
 [-9.45076250e-03]
 [-8.73295135e-04]
 [ 5.23702340e-03]
 [ 5.06759703e-03]
 [-5.41405200e-03]
 [ 7.45990614e-03]
 [ 5.05430973e-03]
 [-2.02935174e-02]
 [ 1.00826080e-02]
 [-7.18960318e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.18741205]
curr_Stock_Price:  100.20870072712538
curr_Factors:  [100.20870073]
mat_Sqrt:  [[0.15]]
grads:  [0.04090347]
Stock Position:  0.04090347465042758
Bond Position:  [1.088528]


portfolio before change:  [5.21007723]
curr_Stock_Price:  100.75948775570889
curr_Factors:  [100.75948776]
mat_Sqrt:  [[0.15]]
grads:  [0.0198305]
Stock Position:  0.019830502718725745
Bond Position:  [3.21196593]


portfolio before change:  [5.21428825]
curr_Stock_Price:  100.95159103995924
curr_Factors:  [100.95159104]
mat_Sqrt:  [[0.15]]
grads:  [0.09105249]
Stock Position:  0.09105249417781505
Bond Position:  [-3.9776059]


portfolio before change:  [5.30013914]
curr_Stock_Price:  101.89992439652688
curr_Factors:  [101.8999244]
mat_Sqrt:  [[0.15]]
grads:  [0.04769289]
Stock Position:  0.04769288973219773
Bond Position:  [0.44023728]


portfolio before change:  [5.23832053]
curr_Stock_Price:  100.60258974164822
curr_Factors:  [100.60258974]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-5.06224202]


portfolio before change:  [5.18822198]
curr_Stock_Price:  100.11947237947751
curr_Factors:  [100.11947238]
mat_Sqrt:  [[0.15]]
grads:  [0.11974609]
Stock Position:  0.1197460852390643
Bond Position:  [-6.80069289]


portfolio before change:  [5.19209596]
curr_Stock_Price:  100.15892345270127
curr_Factors:  [100.15892345]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199944]
Stock Position:  -0.011999439813897925
Bond Position:  [6.39394693]


portfolio before change:  [5.19371471]
curr_Stock_Price:  100.09063181910938
curr_Factors:  [100.09063182]
mat_Sqrt:  [[0.15]]
grads:  [0.14272642]
Stock Position:  0.14272641760728783
Bond Position:  [-9.0918626]


portfolio before change:  [5.21540286]
curr_Stock_Price:  100.25055106805617
curr_Factors:  [100.25055107]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946136]
Stock Position:  -0.03946135755450158
Bond Position:  [9.1714257]


portfolio before change:  [5.22957]
curr_Stock_Price:  99.92059166819145
curr_Factors:  [99.92059167]
mat_Sqrt:  [[0.15]]
grads:  [0.01940064]
Stock Position:  0.01940063669964363
Bond Position:  [3.29104691]


portfolio before change:  [5.24864645]
curr_Stock_Price:  100.88267565713497
curr_Factors:  [100.88267566]
mat_Sqrt:  [[0.15]]
grads:  [0.07138662]
Stock Position:  0.07138661921375979
Bond Position:  [-1.9530267]


portfolio before change:  [5.21978979]
curr_Stock_Price:  100.48186503161307
curr_Factors:  [100.48186503]
mat_Sqrt:  [[0.15]]
grads:  [0.0269246]
Stock Position:  0.026924597931339563
Bond Position:  [2.51435598]


portfolio before change:  [5.24455817]
curr_Stock_Price:  101.39010740595893
curr_Factors:  [101.39010741]
mat_Sqrt:  [[0.15]]
grads:  [0.07141464]
Stock Position:  0.07141464090255986
Bond Position:  [-1.99617994]


portfolio before change:  [5.32594527]
curr_Stock_Price:  102.53324323142252
curr_Factors:  [102.53324323]
mat_Sqrt:  [[0.15]]
grads:  [-0.03262439]
Stock Position:  -0.03262439437745051
Bond Position:  [8.67103023]


portfolio before change:  [5.28756605]
curr_Stock_Price:  103.74286465078478
curr_Factors:  [103.74286465]
mat_Sqrt:  [[0.15]]
grads:  [0.0338902]
Stock Position:  0.033890200357042405
Bond Position:  [1.77169958]


portfolio before change:  [5.28057494]
curr_Stock_Price:  103.53004246862106
curr_Factors:  [103.53004247]
mat_Sqrt:  [[0.15]]
grads:  [0.01995708]
Stock Position:  0.01995707772442073
Bond Position:  [3.21441783]


portfolio before change:  [5.29222154]
curr_Stock_Price:  104.09349059870587
curr_Factors:  [104.0934906]
mat_Sqrt:  [[0.15]]
grads:  [0.06092303]
Stock Position:  0.06092302568225582
Bond Position:  [-1.04946886]


portfolio before change:  [5.29065429]
curr_Stock_Price:  104.06991889943048
curr_Factors:  [104.0699189]
mat_Sqrt:  [[0.15]]
grads:  [0.00818996]
Stock Position:  0.008189962288891045
Bond Position:  [4.43832558]


portfolio before change:  [5.27853618]
curr_Stock_Price:  102.52254470613835
curr_Factors:  [102.52254471]
mat_Sqrt:  [[0.15]]
grads:  [0.07690635]
Stock Position:  0.07690634993818382
Bond Position:  [-2.60609852]


portfolio before change:  [5.3241965]
curr_Stock_Price:  103.12049407837151
curr_Factors:  [103.12049408]
mat_Sqrt:  [[0.15]]
grads:  [-0.10181565]
Stock Position:  -0.1018156466002124
Bond Position:  [15.82347628]


portfolio before change:  [5.28200025]
curr_Stock_Price:  103.5543596757688
curr_Factors:  [103.55435968]
mat_Sqrt:  [[0.15]]
grads:  [0.0221562]
Stock Position:  0.022156198681120183
Bond Position:  [2.98762928]


portfolio before change:  [5.24552315]
curr_Stock_Price:  101.89114211697115
curr_Factors:  [101.89114212]
mat_Sqrt:  [[0.15]]
grads:  [0.14833342]
Stock Position:  0.1483334190087132
Bond Position:  [-9.86833833]


portfolio before change:  [5.27267929]
curr_Stock_Price:  102.08253364391635
curr_Factors:  [102.08253364]
mat_Sqrt:  [[0.15]]
grads:  [-0.2065348]
Stock Position:  -0.20653480106724834
Bond Position:  [26.35627507]


portfolio before change:  [5.07235691]
curr_Stock_Price:  103.06840681783122
curr_Factors:  [103.06840682]
mat_Sqrt:  [[0.15]]
grads:  [0.04266381]
Stock Position:  0.04266381261173019
Bond Position:  [0.67506572]


portfolio before change:  [5.07603984]
curr_Stock_Price:  103.15275319965139
curr_Factors:  [103.1527532]
mat_Sqrt:  [[0.15]]
grads:  [0.01574619]
Stock Position:  0.015746190237276598
Bond Position:  [3.45177696]


portfolio before change:  [5.06928498]
curr_Stock_Price:  102.69636634368521
curr_Factors:  [102.69636634]
mat_Sqrt:  [[0.15]]
grads:  [-0.04670256]
Stock Position:  -0.0467025554696453
Bond Position:  [9.86546773]


portfolio before change:  [5.13008578]
curr_Stock_Price:  101.42089999018827
curr_Factors:  [101.42089999]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363772]
Stock Position:  -0.003637718334795873
Bond Position:  [5.49902645]


portfolio before change:  [5.13133612]
curr_Stock_Price:  101.2661550855951
curr_Factors:  [101.26615509]
mat_Sqrt:  [[0.15]]
grads:  [-0.07498719]
Stock Position:  -0.07498719026075103
Bond Position:  [12.72500056]


portfolio before change:  [5.01553189]
curr_Stock_Price:  102.83168849430679
curr_Factors:  [102.83168849]
mat_Sqrt:  [[0.15]]
grads:  [0.2700316]
Stock Position:  0.2700316049050931
Bond Position:  [-22.75227399]


portfolio before change:  [4.55188018]
curr_Stock_Price:  101.12519381148945
curr_Factors:  [101.12519381]
mat_Sqrt:  [[0.15]]
grads:  [-0.06300508]
Stock Position:  -0.0630050833300478
Bond Position:  [10.92328145]


portfolio before change:  [4.53599253]
curr_Stock_Price:  101.39903127453937
curr_Factors:  [101.39903127]
mat_Sqrt:  [[0.15]]
grads:  [-0.00582197]
Stock Position:  -0.005821967563470395
Bond Position:  [5.1263344]


portfolio before change:  [4.53942017]
curr_Stock_Price:  100.9203599689015
curr_Factors:  [100.92035997]
mat_Sqrt:  [[0.15]]
grads:  [0.03491349]
Stock Position:  0.034913489346993495
Bond Position:  [1.01593825]


portfolio before change:  [4.57304007]
curr_Stock_Price:  101.87967126129081
curr_Factors:  [101.87967126]
mat_Sqrt:  [[0.15]]
grads:  [0.03378398]
Stock Position:  0.03378398016723421
Bond Position:  [1.13113928]


portfolio before change:  [4.58526281]
curr_Stock_Price:  102.23727673081117
curr_Factors:  [102.23727673]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609368]
Stock Position:  -0.036093679996118566
Bond Position:  [8.27538236]


portfolio before change:  [4.53295605]
curr_Stock_Price:  103.71513224017669
curr_Factors:  [103.71513224]
mat_Sqrt:  [[0.15]]
grads:  [0.04973271]
Stock Position:  0.04973270759271651
Bond Position:  [-0.62507829]


portfolio before change:  [4.51863773]
curr_Stock_Price:  103.42879781143057
curr_Factors:  [103.42879781]
mat_Sqrt:  [[0.15]]
grads:  [0.0336954]
Stock Position:  0.033695398194008616
Bond Position:  [1.0335632]


portfolio before change:  [4.55826262]
curr_Stock_Price:  104.60093667203785
curr_Factors:  [104.60093667]
mat_Sqrt:  [[0.15]]
grads:  [-0.13529012]
Stock Position:  -0.13529011574320254
Bond Position:  [18.70973545]


portfolio before change:  [4.56500388]
curr_Stock_Price:  104.56839620945982
curr_Factors:  [104.56839621]
mat_Sqrt:  [[0.15]]
grads:  [0.06721739]
Stock Position:  0.06721738655384282
Bond Position:  [-2.46381043]


portfolio before change:  [4.69493708]
curr_Stock_Price:  106.50600788935911
curr_Factors:  [106.50600789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.69493708]
Stock Price:  105.84135523054738
PL:  [-1.14641815]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.38569523e-03]
 [ 2.41234234e-03]
 [ 1.49222543e-02]
 [ 5.14542487e-03]
 [ 1.42561381e-02]
 [ 2.64066054e-02]
 [ 8.12594217e-03]
 [ 9.75460450e-03]
 [-1.09443325e-02]
 [-2.59924840e-03]
 [ 2.78494305e-02]
 [ 1.05969122e-02]
 [-6.09655197e-03]
 [-4.87620775e-03]
 [-1.12983311e-02]
 [ 7.40155017e-03]
 [ 9.21038928e-03]
 [-1.19221768e-02]
 [ 1.20498258e-02]
 [-1.69728879e-02]
 [ 8.53145905e-03]
 [ 3.15282469e-02]
 [-2.89682189e-02]
 [ 7.72693803e-03]
 [ 1.52336474e-03]
 [-1.07320129e-02]
 [-7.55944081e-04]
 [-1.07484828e-02]
 [ 4.27817444e-02]
 [-1.04414814e-02]
 [-3.34809952e-03]
 [ 4.75314825e-03]
 [ 5.30578524e-03]
 [-5.08736517e-03]
 [ 2.17713250e-02]
 [ 5.46493696e-03]
 [ 2.27095730e-03]
 [ 7.83913343e-03]
 [-9.47003021e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.92452463]
curr_Stock_Price:  101.28840130079524
curr_Factors:  [101.2884013]
mat_Sqrt:  [[0.15]]
grads:  [0.05590463]
Stock Position:  0.055904634870343535
Bond Position:  [16.26203354]


portfolio before change:  [21.90412048]
curr_Stock_Price:  100.88705657268565
curr_Factors:  [100.88705657]
mat_Sqrt:  [[0.15]]
grads:  [0.01608228]
Stock Position:  0.016082282275597857
Bond Position:  [20.28162636]


portfolio before change:  [21.91295234]
curr_Stock_Price:  101.2785740466385
curr_Factors:  [101.27857405]
mat_Sqrt:  [[0.15]]
grads:  [0.0994817]
Stock Position:  0.09948169540342205
Bond Position:  [11.83758808]


portfolio before change:  [21.95673764]
curr_Stock_Price:  101.70383327881208
curr_Factors:  [101.70383328]
mat_Sqrt:  [[0.15]]
grads:  [0.03430283]
Stock Position:  0.03430283245211915
Bond Position:  [18.46800809]


portfolio before change:  [21.94967873]
curr_Stock_Price:  101.43074941899111
curr_Factors:  [101.43074942]
mat_Sqrt:  [[0.15]]
grads:  [0.09504092]
Stock Position:  0.09504092059049181
Bond Position:  [12.30960693]


portfolio before change:  [21.93460866]
curr_Stock_Price:  101.2559944472795
curr_Factors:  [101.25599445]
mat_Sqrt:  [[0.15]]
grads:  [0.17604404]
Stock Position:  0.17604403573363359
Bond Position:  [4.10909475]


portfolio before change:  [22.05529901]
curr_Stock_Price:  101.93864570355449
curr_Factors:  [101.9386457]
mat_Sqrt:  [[0.15]]
grads:  [0.05417295]
Stock Position:  0.05417294778246119
Bond Position:  [16.53298208]


portfolio before change:  [22.05625946]
curr_Stock_Price:  101.91822408053628
curr_Factors:  [101.91822408]
mat_Sqrt:  [[0.15]]
grads:  [0.0650307]
Stock Position:  0.06503069665259135
Bond Position:  [15.42844635]


portfolio before change:  [22.16118959]
curr_Stock_Price:  103.50211386791295
curr_Factors:  [103.50211387]
mat_Sqrt:  [[0.15]]
grads:  [-0.07296222]
Stock Position:  -0.07296221640871998
Bond Position:  [29.71293323]


portfolio before change:  [22.16706296]
curr_Stock_Price:  103.47252299451016
curr_Factors:  [103.47252299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01732832]
Stock Position:  -0.01732832264246596
Bond Position:  [23.96006822]


portfolio before change:  [22.14356089]
curr_Stock_Price:  105.00165362645846
curr_Factors:  [105.00165363]
mat_Sqrt:  [[0.15]]
grads:  [0.18566287]
Stock Position:  0.1856628700292157
Bond Position:  [2.64865252]


portfolio before change:  [22.31774405]
curr_Stock_Price:  105.93803936150591
curr_Factors:  [105.93803936]
mat_Sqrt:  [[0.15]]
grads:  [0.07064608]
Stock Position:  0.07064608138251255
Bond Position:  [14.8336367]


portfolio before change:  [22.37855967]
curr_Stock_Price:  106.77264054097851
curr_Factors:  [106.77264054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064368]
Stock Position:  -0.040643679828390525
Bond Position:  [26.71819269]


portfolio before change:  [22.35676465]
curr_Stock_Price:  107.39106396532354
curr_Factors:  [107.39106397]
mat_Sqrt:  [[0.15]]
grads:  [-0.03250805]
Stock Position:  -0.03250805168907907
Bond Position:  [25.84783891]


portfolio before change:  [22.34546496]
curr_Stock_Price:  107.83805709847547
curr_Factors:  [107.8380571]
mat_Sqrt:  [[0.15]]
grads:  [-0.07532221]
Stock Position:  -0.07532220765991837
Bond Position:  [30.46806549]


portfolio before change:  [22.37915594]
curr_Stock_Price:  107.44133161960647
curr_Factors:  [107.44133162]
mat_Sqrt:  [[0.15]]
grads:  [0.04934367]
Stock Position:  0.0493436677833157
Bond Position:  [17.07760657]


portfolio before change:  [22.28748935]
curr_Stock_Price:  105.54034944145383
curr_Factors:  [105.54034944]
mat_Sqrt:  [[0.15]]
grads:  [0.0614026]
Stock Position:  0.06140259517053464
Bond Position:  [15.80703799]


portfolio before change:  [22.2798572]
curr_Stock_Price:  105.38387148090484
curr_Factors:  [105.38387148]
mat_Sqrt:  [[0.15]]
grads:  [-0.07948118]
Stock Position:  -0.07948117897207052
Bond Position:  [30.65589155]


portfolio before change:  [22.34759476]
curr_Stock_Price:  104.57984034759245
curr_Factors:  [104.57984035]
mat_Sqrt:  [[0.15]]
grads:  [0.08033217]
Stock Position:  0.08033217219713958
Bond Position:  [13.94646902]


portfolio before change:  [22.37678877]
curr_Stock_Price:  104.92155388293543
curr_Factors:  [104.92155388]
mat_Sqrt:  [[0.15]]
grads:  [-0.11315259]
Stock Position:  -0.11315258576388758
Bond Position:  [34.2489339]


portfolio before change:  [22.41429621]
curr_Stock_Price:  104.62791447702345
curr_Factors:  [104.62791448]
mat_Sqrt:  [[0.15]]
grads:  [0.05687639]
Stock Position:  0.056876393649607324
Bond Position:  [16.46343776]


portfolio before change:  [22.36058418]
curr_Stock_Price:  103.64736537566213
curr_Factors:  [103.64736538]
mat_Sqrt:  [[0.15]]
grads:  [0.21018831]
Stock Position:  0.2101883125532431
Bond Position:  [0.57511935]


portfolio before change:  [22.41602712]
curr_Stock_Price:  103.9108008156699
curr_Factors:  [103.91080082]
mat_Sqrt:  [[0.15]]
grads:  [-0.19312146]
Stock Position:  -0.19312145925765534
Bond Position:  [42.48343261]


portfolio before change:  [22.42151894]
curr_Stock_Price:  103.90986329300121
curr_Factors:  [103.90986329]
mat_Sqrt:  [[0.15]]
grads:  [0.05151292]
Stock Position:  0.05151292021081534
Bond Position:  [17.06881844]


portfolio before change:  [22.37932173]
curr_Stock_Price:  103.04928422680635
curr_Factors:  [103.04928423]
mat_Sqrt:  [[0.15]]
grads:  [0.01015576]
Stock Position:  0.010155764924966344
Bond Position:  [21.33277743]


portfolio before change:  [22.38720897]
curr_Stock_Price:  103.56332415471944
curr_Factors:  [103.56332415]
mat_Sqrt:  [[0.15]]
grads:  [-0.07154675]
Stock Position:  -0.07154675245471652
Bond Position:  [29.79682848]


portfolio before change:  [22.38496315]
curr_Stock_Price:  103.6467752737148
curr_Factors:  [103.64677527]
mat_Sqrt:  [[0.15]]
grads:  [-0.00503963]
Stock Position:  -0.005039627206380732
Bond Position:  [22.90730425]


portfolio before change:  [22.39097819]
curr_Stock_Price:  103.02144016738544
curr_Factors:  [103.02144017]
mat_Sqrt:  [[0.15]]
grads:  [-0.07165655]
Stock Position:  -0.07165655220935416
Bond Position:  [29.7731394]


portfolio before change:  [22.40012474]
curr_Stock_Price:  102.94573637124317
curr_Factors:  [102.94573637]
mat_Sqrt:  [[0.15]]
grads:  [0.28521163]
Stock Position:  0.28521162901753216
Bond Position:  [-6.96119643]


portfolio before change:  [22.21444789]
curr_Stock_Price:  102.29777314657815
curr_Factors:  [102.29777315]
mat_Sqrt:  [[0.15]]
grads:  [-0.06960988]
Stock Position:  -0.06960987571130137
Bond Position:  [29.33538316]


portfolio before change:  [22.14810002]
curr_Stock_Price:  103.30359343040294
curr_Factors:  [103.30359343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232066]
Stock Position:  -0.022320663483010608
Bond Position:  [24.45390476]


portfolio before change:  [22.13606155]
curr_Stock_Price:  103.97989042499866
curr_Factors:  [103.97989042]
mat_Sqrt:  [[0.15]]
grads:  [0.03168765]
Stock Position:  0.03168765497518859
Bond Position:  [18.84118266]


portfolio before change:  [22.11696085]
curr_Stock_Price:  103.30278137727825
curr_Factors:  [103.30278138]
mat_Sqrt:  [[0.15]]
grads:  [0.0353719]
Stock Position:  0.03537190157068694
Bond Position:  [18.46294503]


portfolio before change:  [22.09061018]
curr_Stock_Price:  102.49257112698393
curr_Factors:  [102.49257113]
mat_Sqrt:  [[0.15]]
grads:  [-0.03391577]
Stock Position:  -0.03391576782413249
Bond Position:  [25.56672443]


portfolio before change:  [22.13733558]
curr_Stock_Price:  101.20911617340082
curr_Factors:  [101.20911617]
mat_Sqrt:  [[0.15]]
grads:  [0.14514217]
Stock Position:  0.14514216656678752
Bond Position:  [7.44762518]


portfolio before change:  [22.08037641]
curr_Stock_Price:  100.81026456275069
curr_Factors:  [100.81026456]
mat_Sqrt:  [[0.15]]
grads:  [0.03643291]
Stock Position:  0.03643291309138239
Bond Position:  [18.4075648]


portfolio before change:  [22.07077425]
curr_Stock_Price:  100.48354767673283
curr_Factors:  [100.48354768]
mat_Sqrt:  [[0.15]]
grads:  [0.01513972]
Stock Position:  0.01513971536192499
Bond Position:  [20.54948194]


portfolio before change:  [22.07439519]
curr_Stock_Price:  100.55303997500401
curr_Factors:  [100.55303998]
mat_Sqrt:  [[0.15]]
grads:  [0.05226089]
Stock Position:  0.052260889533117943
Bond Position:  [16.81940387]


portfolio before change:  [22.08331335]
curr_Stock_Price:  100.68345494359093
curr_Factors:  [100.68345494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.08331335]
Stock Price:  100.61251714344512
PL:  [21.4707962]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.20868080e-03]
 [ 4.79393009e-03]
 [ 6.96723215e-03]
 [-2.24857424e-03]
 [-2.27258964e-03]
 [-3.29707794e-02]
 [-3.23682461e-02]
 [ 6.70369078e-03]
 [-6.55458734e-03]
 [ 1.99425799e-02]
 [-1.89609191e-02]
 [ 7.80309493e-03]
 [ 1.38609469e-02]
 [-3.64168562e-03]
 [-1.58121472e-02]
 [-1.14762785e-02]
 [ 2.62164586e-02]
 [-5.29906809e-02]
 [-3.97273889e-03]
 [ 1.44512576e-02]
 [ 3.01650288e-02]
 [ 2.42238679e-03]
 [ 3.37880167e-02]
 [-9.31958739e-04]
 [ 1.21373337e-02]
 [-7.34863776e-03]
 [ 1.66164855e-02]
 [-1.49948851e-02]
 [-1.77281292e-02]
 [-4.01027431e-03]
 [-3.74095001e-03]
 [ 5.62802571e-03]
 [ 7.39116082e-03]
 [-1.25430972e-02]
 [ 4.29194034e-03]
 [ 5.61900825e-03]
 [ 3.76546632e-03]
 [ 1.01727960e-02]
 [-5.45219937e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86587635]
curr_Stock_Price:  99.56016943479894
curr_Factors:  [99.56016943]
mat_Sqrt:  [[0.15]]
grads:  [0.02805787]
Stock Position:  0.028057872004614362
Bond Position:  [-7.65932284]


portfolio before change:  [-4.84861865]
curr_Stock_Price:  100.20936961873065
curr_Factors:  [100.20936962]
mat_Sqrt:  [[0.15]]
grads:  [0.03195953]
Stock Position:  0.03195953393739082
Bond Position:  [-8.0512634]


portfolio before change:  [-4.8562557]
curr_Stock_Price:  100.00190167711656
curr_Factors:  [100.00190168]
mat_Sqrt:  [[0.15]]
grads:  [0.04644821]
Stock Position:  0.04644821431945963
Bond Position:  [-9.50116546]


portfolio before change:  [-4.87780996]
curr_Stock_Price:  99.56342308822781
curr_Factors:  [99.56342309]
mat_Sqrt:  [[0.15]]
grads:  [-0.01499049]
Stock Position:  -0.014990494963282672
Bond Position:  [-3.38530497]


portfolio before change:  [-4.86632557]
curr_Stock_Price:  98.7690809060882
curr_Factors:  [98.76908091]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151506]
Stock Position:  -0.015150597593902616
Bond Position:  [-3.36991497]


portfolio before change:  [-4.83695685]
curr_Stock_Price:  96.80282257194428
curr_Factors:  [96.80282257]
mat_Sqrt:  [[0.15]]
grads:  [-0.2198052]
Stock Position:  -0.21980519567804918
Bond Position:  [16.44080651]


portfolio before change:  [-4.68545069]
curr_Stock_Price:  96.12289810217777
curr_Factors:  [96.1228981]
mat_Sqrt:  [[0.15]]
grads:  [-0.21578831]
Stock Position:  -0.21578830754154787
Bond Position:  [16.05674681]


portfolio before change:  [-4.57640216]
curr_Stock_Price:  95.62685034548298
curr_Factors:  [95.62685035]
mat_Sqrt:  [[0.15]]
grads:  [0.04469127]
Stock Position:  0.04469127184461368
Bond Position:  [-8.85008773]


portfolio before change:  [-4.59051659]
curr_Stock_Price:  95.3357846499706
curr_Factors:  [95.33578465]
mat_Sqrt:  [[0.15]]
grads:  [-0.04369725]
Stock Position:  -0.04369724893361467
Bond Position:  [-0.42460507]


portfolio before change:  [-4.55986449]
curr_Stock_Price:  94.63310470845579
curr_Factors:  [94.63310471]
mat_Sqrt:  [[0.15]]
grads:  [0.13295053]
Stock Position:  0.1329505326474855
Bond Position:  [-17.14138616]


portfolio before change:  [-4.62641542]
curr_Stock_Price:  94.14865290533231
curr_Factors:  [94.14865291]
mat_Sqrt:  [[0.15]]
grads:  [-0.12640613]
Stock Position:  -0.1264061272010706
Bond Position:  [7.27455118]


portfolio before change:  [-4.59802949]
curr_Stock_Price:  93.93128565074731
curr_Factors:  [93.93128565]
mat_Sqrt:  [[0.15]]
grads:  [0.05202063]
Stock Position:  0.05202063285692329
Bond Position:  [-9.48439442]


portfolio before change:  [-4.56769159]
curr_Stock_Price:  94.53726688756018
curr_Factors:  [94.53726689]
mat_Sqrt:  [[0.15]]
grads:  [0.09240631]
Stock Position:  0.09240631287580871
Bond Position:  [-13.30353185]


portfolio before change:  [-4.61918518]
curr_Stock_Price:  93.99801214548795
curr_Factors:  [93.99801215]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242779]
Stock Position:  -0.024277904165036612
Bond Position:  [-2.33711044]


portfolio before change:  [-4.60159697]
curr_Stock_Price:  93.26152491931484
curr_Factors:  [93.26152492]
mat_Sqrt:  [[0.15]]
grads:  [-0.10541431]
Stock Position:  -0.10541431497107344
Bond Position:  [5.2295028]


portfolio before change:  [-4.73259221]
curr_Stock_Price:  94.51039677176132
curr_Factors:  [94.51039677]
mat_Sqrt:  [[0.15]]
grads:  [-0.07650852]
Stock Position:  -0.07650852309583396
Bond Position:  [2.49825867]


portfolio before change:  [-4.6491955]
curr_Stock_Price:  93.4244471400983
curr_Factors:  [93.42444714]
mat_Sqrt:  [[0.15]]
grads:  [0.17477639]
Stock Position:  0.17477639081751253
Bond Position:  [-20.97758319]


portfolio before change:  [-4.68621089]
curr_Stock_Price:  93.2276641507943
curr_Factors:  [93.22766415]
mat_Sqrt:  [[0.15]]
grads:  [-0.35327121]
Stock Position:  -0.3532712062561831
Bond Position:  [28.24843848]


portfolio before change:  [-4.36615176]
curr_Stock_Price:  92.33167307943116
curr_Factors:  [92.33167308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02648493]
Stock Position:  -0.02648492590184022
Bond Position:  [-1.92075424]


portfolio before change:  [-4.37401677]
curr_Stock_Price:  92.6195687211295
curr_Factors:  [92.61956872]
mat_Sqrt:  [[0.15]]
grads:  [0.09634172]
Stock Position:  0.0963417175869683
Bond Position:  [-13.2971451]


portfolio before change:  [-4.43062714]
curr_Stock_Price:  92.04922258558936
curr_Factors:  [92.04922259]
mat_Sqrt:  [[0.15]]
grads:  [0.20110019]
Stock Position:  0.20110019208974048
Bond Position:  [-22.94174349]


portfolio before change:  [-4.32875078]
curr_Stock_Price:  92.570078673522
curr_Factors:  [92.57007867]
mat_Sqrt:  [[0.15]]
grads:  [0.01614925]
Stock Position:  0.01614924528834929
Bond Position:  [-5.82368769]


portfolio before change:  [-4.3181231]
curr_Stock_Price:  93.27324977035784
curr_Factors:  [93.27324977]
mat_Sqrt:  [[0.15]]
grads:  [0.22525344]
Stock Position:  0.2252534445984832
Bond Position:  [-25.3282439]


portfolio before change:  [-4.24453786]
curr_Stock_Price:  93.6139836082531
curr_Factors:  [93.61398361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00621306]
Stock Position:  -0.0062130582617044424
Bond Position:  [-3.66290873]


portfolio before change:  [-4.25380801]
curr_Stock_Price:  95.03232764215186
curr_Factors:  [95.03232764]
mat_Sqrt:  [[0.15]]
grads:  [0.08091556]
Stock Position:  0.08091555802950566
Bond Position:  [-11.94340183]


portfolio before change:  [-4.13155962]
curr_Stock_Price:  96.56159357402105
curr_Factors:  [96.56159357]
mat_Sqrt:  [[0.15]]
grads:  [-0.04899092]
Stock Position:  -0.048990918374733246
Bond Position:  [0.59908153]


portfolio before change:  [-4.19200953]
curr_Stock_Price:  97.79702249909104
curr_Factors:  [97.7970225]
mat_Sqrt:  [[0.15]]
grads:  [0.11077657]
Stock Position:  0.11077656990898521
Bond Position:  [-15.02562823]


portfolio before change:  [-4.20704027]
curr_Stock_Price:  97.67829326493008
curr_Factors:  [97.67829326]
mat_Sqrt:  [[0.15]]
grads:  [-0.0999659]
Stock Position:  -0.0999659003363617
Bond Position:  [5.55745826]


portfolio before change:  [-4.29433256]
curr_Stock_Price:  98.5584636312882
curr_Factors:  [98.55846363]
mat_Sqrt:  [[0.15]]
grads:  [-0.11818753]
Stock Position:  -0.11818752791270765
Bond Position:  [7.35404861]


portfolio before change:  [-4.35878353]
curr_Stock_Price:  99.11157008689005
curr_Factors:  [99.11157009]
mat_Sqrt:  [[0.15]]
grads:  [-0.02673516]
Stock Position:  -0.02673516205001113
Bond Position:  [-1.70901965]


portfolio before change:  [-4.33147716]
curr_Stock_Price:  98.08221359905002
curr_Factors:  [98.0822136]
mat_Sqrt:  [[0.15]]
grads:  [-0.02493967]
Stock Position:  -0.024939666751072426
Bond Position:  [-1.88533944]


portfolio before change:  [-4.33447162]
curr_Stock_Price:  98.19283140104011
curr_Factors:  [98.1928314]
mat_Sqrt:  [[0.15]]
grads:  [0.03752017]
Stock Position:  0.037520171426028696
Bond Position:  [-8.01868348]


portfolio before change:  [-4.32763073]
curr_Stock_Price:  98.40187313811965
curr_Factors:  [98.40187314]
mat_Sqrt:  [[0.15]]
grads:  [0.04927441]
Stock Position:  0.04927440545440978
Bond Position:  [-9.17632453]


portfolio before change:  [-4.33105359]
curr_Stock_Price:  98.3556879329443
curr_Factors:  [98.35568793]
mat_Sqrt:  [[0.15]]
grads:  [-0.08362065]
Stock Position:  -0.08362064777106028
Bond Position:  [3.89351274]


portfolio before change:  [-4.30660601]
curr_Stock_Price:  98.06914553235352
curr_Factors:  [98.06914553]
mat_Sqrt:  [[0.15]]
grads:  [0.02861294]
Stock Position:  0.028612935589471273
Bond Position:  [-7.11265216]


portfolio before change:  [-4.34879914]
curr_Stock_Price:  96.62560302246622
curr_Factors:  [96.62560302]
mat_Sqrt:  [[0.15]]
grads:  [0.03746005]
Stock Position:  0.03746005497648957
Bond Position:  [-7.96839954]


portfolio before change:  [-4.40011003]
curr_Stock_Price:  95.28244487019643
curr_Factors:  [95.28244487]
mat_Sqrt:  [[0.15]]
grads:  [0.02510311]
Stock Position:  0.02510310879582342
Bond Position:  [-6.79199561]


portfolio before change:  [-4.40861514]
curr_Stock_Price:  94.97746052037655
curr_Factors:  [94.97746052]
mat_Sqrt:  [[0.15]]
grads:  [0.06781864]
Stock Position:  0.06781864001017715
Bond Position:  [-10.84985734]


portfolio before change:  [-4.41562984]
curr_Stock_Price:  94.89402635208579
curr_Factors:  [94.89402635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.41562984]
Stock Price:  94.75910987005165
PL:  [-4.41562984]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.52505088e-03]
 [ 1.83782570e-03]
 [ 1.52994678e-02]
 [ 7.42767587e-03]
 [ 1.42545245e-02]
 [ 2.56091297e-02]
 [-1.90720584e-03]
 [ 2.08594467e-02]
 [-5.94212437e-03]
 [ 3.74625013e-03]
 [ 4.57900512e-03]
 [ 4.04665729e-03]
 [ 1.10479205e-02]
 [ 5.35286036e-03]
 [ 1.89474952e-02]
 [-2.79054466e-03]
 [ 9.36511995e-03]
 [ 1.52127885e-03]
 [ 1.15616333e-02]
 [-1.27180041e-02]
 [-1.36627939e-02]
 [ 1.52526504e-02]
 [ 1.81918663e-02]
 [ 4.92193824e-03]
 [ 1.30541235e-02]
 [-1.11475587e-02]
 [ 1.84975854e-02]
 [-1.23625922e-02]
 [-3.03862587e-02]
 [-3.62203356e-04]
 [-3.92569144e-03]
 [ 5.59208597e-03]
 [ 9.67347932e-03]
 [-1.28593555e-02]
 [ 5.07404526e-03]
 [ 5.67425769e-03]
 [ 3.61189472e-03]
 [ 1.07076039e-02]
 [-4.24040349e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.29957548]
curr_Stock_Price:  100.92553937945372
curr_Factors:  [100.92553938]
mat_Sqrt:  [[0.15]]
grads:  [0.04350034]
Stock Position:  0.0435003392090738
Bond Position:  [11.90928028]


portfolio before change:  [16.30521183]
curr_Stock_Price:  101.02088578684643
curr_Factors:  [101.02088579]
mat_Sqrt:  [[0.15]]
grads:  [0.01225217]
Stock Position:  0.01225217132876013
Bond Position:  [15.06748663]


portfolio before change:  [16.31288954]
curr_Stock_Price:  101.49379404081503
curr_Factors:  [101.49379404]
mat_Sqrt:  [[0.15]]
grads:  [0.10199645]
Stock Position:  0.10199645213992843
Bond Position:  [5.96088263]


portfolio before change:  [16.35778446]
curr_Stock_Price:  101.92664992625403
curr_Factors:  [101.92664993]
mat_Sqrt:  [[0.15]]
grads:  [0.04951784]
Stock Position:  0.0495178391641622
Bond Position:  [11.310597]


portfolio before change:  [16.33468019]
curr_Stock_Price:  101.43151162248257
curr_Factors:  [101.43151162]
mat_Sqrt:  [[0.15]]
grads:  [0.09503016]
Stock Position:  0.09503016320052236
Bond Position:  [6.69562709]


portfolio before change:  [16.26068735]
curr_Stock_Price:  100.64407898838496
curr_Factors:  [100.64407899]
mat_Sqrt:  [[0.15]]
grads:  [0.17072753]
Stock Position:  0.17072753112197592
Bond Position:  [-0.92202778]


portfolio before change:  [16.17624073]
curr_Stock_Price:  100.15012609333884
curr_Factors:  [100.15012609]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271471]
Stock Position:  -0.012714705606973927
Bond Position:  [17.4496201]


portfolio before change:  [16.17787481]
curr_Stock_Price:  100.19316746733308
curr_Factors:  [100.19316747]
mat_Sqrt:  [[0.15]]
grads:  [0.13906298]
Stock Position:  0.13906297771970236
Bond Position:  [2.24471459]


portfolio before change:  [16.14285459]
curr_Stock_Price:  99.93931971027064
curr_Factors:  [99.93931971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03961416]
Stock Position:  -0.03961416247788866
Bond Position:  [20.10186704]


portfolio before change:  [16.18567059]
curr_Stock_Price:  98.9219282631385
curr_Factors:  [98.92192826]
mat_Sqrt:  [[0.15]]
grads:  [0.024975]
Stock Position:  0.024975000864741078
Bond Position:  [13.71509535]


portfolio before change:  [16.20172808]
curr_Stock_Price:  99.49622221196942
curr_Factors:  [99.49622221]
mat_Sqrt:  [[0.15]]
grads:  [0.0305267]
Stock Position:  0.030526700769516378
Bond Position:  [13.16443667]


portfolio before change:  [16.23509573]
curr_Stock_Price:  100.53537785057661
curr_Factors:  [100.53537785]
mat_Sqrt:  [[0.15]]
grads:  [0.02697772]
Stock Position:  0.026977715270823297
Bond Position:  [13.52288093]


portfolio before change:  [16.21962357]
curr_Stock_Price:  99.89920014232885
curr_Factors:  [99.89920014]
mat_Sqrt:  [[0.15]]
grads:  [0.0736528]
Stock Position:  0.07365280328902775
Bond Position:  [8.86176744]


portfolio before change:  [16.22546961]
curr_Stock_Price:  99.96353237100888
curr_Factors:  [99.96353237]
mat_Sqrt:  [[0.15]]
grads:  [0.03568574]
Stock Position:  0.03568573576327769
Bond Position:  [12.65819741]


portfolio before change:  [16.23545347]
curr_Stock_Price:  100.19896203551835
curr_Factors:  [100.19896204]
mat_Sqrt:  [[0.15]]
grads:  [0.12631663]
Stock Position:  0.12631663437720209
Bond Position:  [3.57865781]


portfolio before change:  [16.14004217]
curr_Stock_Price:  99.4400861067185
curr_Factors:  [99.44008611]
mat_Sqrt:  [[0.15]]
grads:  [-0.01860363]
Stock Position:  -0.01860363107567581
Bond Position:  [17.98998885]


portfolio before change:  [16.12559205]
curr_Stock_Price:  100.3377074091105
curr_Factors:  [100.33770741]
mat_Sqrt:  [[0.15]]
grads:  [0.06243413]
Stock Position:  0.062434133000206414
Bond Position:  [9.86109428]


portfolio before change:  [16.07159274]
curr_Stock_Price:  99.45306284902883
curr_Factors:  [99.45306285]
mat_Sqrt:  [[0.15]]
grads:  [0.01014186]
Stock Position:  0.010141859008782802
Bond Position:  [15.0629538]


portfolio before change:  [16.07962266]
curr_Stock_Price:  100.059157202779
curr_Factors:  [100.0591572]
mat_Sqrt:  [[0.15]]
grads:  [0.07707756]
Stock Position:  0.07707755502660589
Bond Position:  [8.36730746]


portfolio before change:  [16.13317733]
curr_Stock_Price:  100.74040217711003
curr_Factors:  [100.74040218]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478669]
Stock Position:  -0.08478669418084385
Bond Position:  [24.674623]


portfolio before change:  [16.16659534]
curr_Stock_Price:  100.38263983885749
curr_Factors:  [100.38263984]
mat_Sqrt:  [[0.15]]
grads:  [-0.09108529]
Stock Position:  -0.09108529271606598
Bond Position:  [25.30997747]


portfolio before change:  [16.19754456]
curr_Stock_Price:  100.0775930521856
curr_Factors:  [100.07759305]
mat_Sqrt:  [[0.15]]
grads:  [0.10168434]
Stock Position:  0.10168433617861573
Bond Position:  [6.02122094]


portfolio before change:  [16.05231722]
curr_Stock_Price:  98.64197336525989
curr_Factors:  [98.64197337]
mat_Sqrt:  [[0.15]]
grads:  [0.12127911]
Stock Position:  0.1212791083814272
Bond Position:  [4.08910664]


portfolio before change:  [16.05070745]
curr_Stock_Price:  98.62448525430896
curr_Factors:  [98.62448525]
mat_Sqrt:  [[0.15]]
grads:  [0.03281292]
Stock Position:  0.032812921568919844
Bond Position:  [12.81454995]


portfolio before change:  [16.05159556]
curr_Stock_Price:  98.60273123273768
curr_Factors:  [98.60273123]
mat_Sqrt:  [[0.15]]
grads:  [0.08702749]
Stock Position:  0.08702748967270016
Bond Position:  [7.47044738]


portfolio before change:  [15.99885522]
curr_Stock_Price:  97.98598121294036
curr_Factors:  [97.98598121]
mat_Sqrt:  [[0.15]]
grads:  [-0.07431706]
Stock Position:  -0.07431705802903664
Bond Position:  [23.28088507]


portfolio before change:  [16.06200971]
curr_Stock_Price:  97.17534362537815
curr_Factors:  [97.17534363]
mat_Sqrt:  [[0.15]]
grads:  [0.12331724]
Stock Position:  0.12331723613473722
Bond Position:  [4.07861491]


portfolio before change:  [16.20168448]
curr_Stock_Price:  98.30385507292246
curr_Factors:  [98.30385507]
mat_Sqrt:  [[0.15]]
grads:  [-0.08241728]
Stock Position:  -0.08241728115780178
Bond Position:  [24.30362094]


portfolio before change:  [16.25405209]
curr_Stock_Price:  97.70532196480005
curr_Factors:  [97.70532196]
mat_Sqrt:  [[0.15]]
grads:  [-0.20257506]
Stock Position:  -0.2025750582473464
Bond Position:  [36.04671338]


portfolio before change:  [16.3902397]
curr_Stock_Price:  97.0552839881121
curr_Factors:  [97.05528399]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241469]
Stock Position:  -0.002414689037172621
Bond Position:  [16.62459803]


portfolio before change:  [16.39117613]
curr_Stock_Price:  97.52812808347964
curr_Factors:  [97.52812808]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617128]
Stock Position:  -0.02617127623558693
Bond Position:  [18.94361171]


portfolio before change:  [16.41646977]
curr_Stock_Price:  96.65214713789102
curr_Factors:  [96.65214714]
mat_Sqrt:  [[0.15]]
grads:  [0.03728057]
Stock Position:  0.037280573116149365
Bond Position:  [12.81322233]


portfolio before change:  [16.43931173]
curr_Stock_Price:  97.22188642577756
curr_Factors:  [97.22188643]
mat_Sqrt:  [[0.15]]
grads:  [0.06448986]
Stock Position:  0.06448986214405475
Bond Position:  [10.16948567]


portfolio before change:  [16.41381101]
curr_Stock_Price:  96.80675169364284
curr_Factors:  [96.80675169]
mat_Sqrt:  [[0.15]]
grads:  [-0.08572904]
Stock Position:  -0.085729036784514
Bond Position:  [24.71296059]


portfolio before change:  [16.29306038]
curr_Stock_Price:  98.25130247609673
curr_Factors:  [98.25130248]
mat_Sqrt:  [[0.15]]
grads:  [0.03382697]
Stock Position:  0.033826968371210984
Bond Position:  [12.96951668]


portfolio before change:  [16.25854005]
curr_Stock_Price:  97.18287624805872
curr_Factors:  [97.18287625]
mat_Sqrt:  [[0.15]]
grads:  [0.03782838]
Stock Position:  0.03782838462917914
Bond Position:  [12.58226883]


portfolio before change:  [16.2597512]
curr_Stock_Price:  97.17331385523663
curr_Factors:  [97.17331386]
mat_Sqrt:  [[0.15]]
grads:  [0.0240793]
Stock Position:  0.024079298150825237
Bond Position:  [13.919886]


portfolio before change:  [16.22422933]
curr_Stock_Price:  95.62584492838324
curr_Factors:  [95.62584493]
mat_Sqrt:  [[0.15]]
grads:  [0.07138403]
Stock Position:  0.07138402621348591
Bond Position:  [9.39807151]


portfolio before change:  [16.22962749]
curr_Stock_Price:  95.68500849269853
curr_Factors:  [95.68500849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.22962749]
Stock Price:  96.4536540527175
PL:  [16.22962749]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.67405429e-03]
 [-1.30869100e-02]
 [-1.57336308e-02]
 [ 6.46365604e-03]
 [-2.36284275e-02]
 [ 2.01458822e-02]
 [-6.05863859e-03]
 [ 2.17041393e-02]
 [-6.20892857e-03]
 [ 4.10309440e-03]
 [ 4.38276398e-03]
 [ 7.23080988e-03]
 [ 1.11115066e-02]
 [ 5.33327564e-03]
 [ 2.25651849e-02]
 [ 1.62032449e-03]
 [ 9.83020425e-03]
 [ 1.32938319e-02]
 [ 1.14432136e-02]
 [-1.39327692e-02]
 [-1.68604769e-02]
 [ 1.47226821e-02]
 [-1.30497833e-02]
 [ 6.05683699e-03]
 [-8.70059881e-03]
 [-6.40030923e-03]
 [-1.04903199e-03]
 [-1.07358041e-02]
 [ 4.50930510e-02]
 [-9.17050914e-03]
 [-5.50068593e-04]
 [ 5.15727521e-03]
 [ 5.12785855e-03]
 [-7.93795454e-03]
 [ 1.96838814e-02]
 [ 5.71387360e-03]
 [ 3.43239336e-03]
 [ 9.50867177e-03]
 [-3.56635893e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.46900101]
curr_Stock_Price:  99.32773413586051
curr_Factors:  [99.32773414]
mat_Sqrt:  [[0.15]]
grads:  [0.03782703]
Stock Position:  0.037827028618300514
Bond Position:  [-12.22627405]


portfolio before change:  [-8.51130804]
curr_Stock_Price:  98.24970474795403
curr_Factors:  [98.24970475]
mat_Sqrt:  [[0.15]]
grads:  [-0.08724607]
Stock Position:  -0.0872460668819547
Bond Position:  [0.06059227]


portfolio before change:  [-8.51983187]
curr_Stock_Price:  98.34749026439003
curr_Factors:  [98.34749026]
mat_Sqrt:  [[0.15]]
grads:  [-0.10489087]
Stock Position:  -0.1048908717907162
Bond Position:  [1.79592213]


portfolio before change:  [-8.43301079]
curr_Stock_Price:  97.52190292794863
curr_Factors:  [97.52190293]
mat_Sqrt:  [[0.15]]
grads:  [0.04309104]
Stock Position:  0.043091040241696875
Bond Position:  [-12.63533103]


portfolio before change:  [-8.410463]
curr_Stock_Price:  98.08181744979582
curr_Factors:  [98.08181745]
mat_Sqrt:  [[0.15]]
grads:  [-0.15752285]
Stock Position:  -0.15752284995743004
Bond Position:  [7.03966441]


portfolio before change:  [-8.75231202]
curr_Stock_Price:  100.25755911944127
curr_Factors:  [100.25755912]
mat_Sqrt:  [[0.15]]
grads:  [0.13430588]
Stock Position:  0.13430588153130318
Bond Position:  [-22.21749188]


portfolio before change:  [-8.83732624]
curr_Stock_Price:  99.64524888803307
curr_Factors:  [99.64524889]
mat_Sqrt:  [[0.15]]
grads:  [-0.04039092]
Stock Position:  -0.040390923942097666
Bond Position:  [-4.81256257]


portfolio before change:  [-8.85391494]
curr_Stock_Price:  100.0410579202163
curr_Factors:  [100.04105792]
mat_Sqrt:  [[0.15]]
grads:  [0.14469426]
Stock Position:  0.14469426204256108
Bond Position:  [-23.32928199]


portfolio before change:  [-8.77002201]
curr_Stock_Price:  100.64100761740418
curr_Factors:  [100.64100762]
mat_Sqrt:  [[0.15]]
grads:  [-0.04139286]
Stock Position:  -0.04139285714279127
Bond Position:  [-4.60420316]


portfolio before change:  [-8.70258187]
curr_Stock_Price:  98.99783278578698
curr_Factors:  [98.99783279]
mat_Sqrt:  [[0.15]]
grads:  [0.02735396]
Stock Position:  0.027353962671968775
Bond Position:  [-11.41056489]


portfolio before change:  [-8.69118502]
curr_Stock_Price:  99.46662236811993
curr_Factors:  [99.46662237]
mat_Sqrt:  [[0.15]]
grads:  [0.02921843]
Stock Position:  0.029218426548833186
Bond Position:  [-11.59744322]


portfolio before change:  [-8.73259932]
curr_Stock_Price:  98.09883752905783
curr_Factors:  [98.09883753]
mat_Sqrt:  [[0.15]]
grads:  [0.0482054]
Stock Position:  0.0482053992291679
Bond Position:  [-13.46149294]


portfolio before change:  [-8.64588184]
curr_Stock_Price:  99.93266248543443
curr_Factors:  [99.93266249]
mat_Sqrt:  [[0.15]]
grads:  [0.07407671]
Stock Position:  0.0740767106922146
Bond Position:  [-16.04856477]


portfolio before change:  [-8.63922622]
curr_Stock_Price:  100.04959284254372
curr_Factors:  [100.04959284]
mat_Sqrt:  [[0.15]]
grads:  [0.03555517]
Stock Position:  0.03555517092377382
Bond Position:  [-12.1965066]


portfolio before change:  [-8.58937695]
curr_Stock_Price:  101.49450032042243
curr_Factors:  [101.49450032]
mat_Sqrt:  [[0.15]]
grads:  [0.15043457]
Stock Position:  0.15043456599265242
Bond Position:  [-23.85765806]


portfolio before change:  [-8.62672279]
curr_Stock_Price:  101.26607247006378
curr_Factors:  [101.26607247]
mat_Sqrt:  [[0.15]]
grads:  [0.01080216]
Stock Position:  0.010802163298868208
Bond Position:  [-9.72061544]


portfolio before change:  [-8.6324166]
curr_Stock_Price:  100.85146513806623
curr_Factors:  [100.85146514]
mat_Sqrt:  [[0.15]]
grads:  [0.0655347]
Stock Position:  0.06553469503026131
Bond Position:  [-15.24168661]


portfolio before change:  [-8.64328207]
curr_Stock_Price:  100.71474146705353
curr_Factors:  [100.71474147]
mat_Sqrt:  [[0.15]]
grads:  [0.08862555]
Stock Position:  0.08862554587950766
Bond Position:  [-17.56918101]


portfolio before change:  [-8.53606917]
curr_Stock_Price:  101.94925220814362
curr_Factors:  [101.94925221]
mat_Sqrt:  [[0.15]]
grads:  [0.07628809]
Stock Position:  0.07628809068900985
Bond Position:  [-16.31358297]


portfolio before change:  [-8.54071858]
curr_Stock_Price:  101.91503861528662
curr_Factors:  [101.91503862]
mat_Sqrt:  [[0.15]]
grads:  [-0.09288513]
Stock Position:  -0.09288512821443506
Bond Position:  [0.92567285]


portfolio before change:  [-8.42190509]
curr_Stock_Price:  100.63714001893193
curr_Factors:  [100.63714002]
mat_Sqrt:  [[0.15]]
grads:  [-0.11240318]
Stock Position:  -0.1124031794297248
Bond Position:  [2.89002942]


portfolio before change:  [-8.35158853]
curr_Stock_Price:  100.01477962584462
curr_Factors:  [100.01477963]
mat_Sqrt:  [[0.15]]
grads:  [0.09815121]
Stock Position:  0.09815121424679008
Bond Position:  [-18.16816059]


portfolio before change:  [-8.27270402]
curr_Stock_Price:  100.84162284826269
curr_Factors:  [100.84162285]
mat_Sqrt:  [[0.15]]
grads:  [-0.08699856]
Stock Position:  -0.086998555362702
Bond Position:  [0.50037148]


portfolio before change:  [-8.23486167]
curr_Stock_Price:  100.40736501297255
curr_Factors:  [100.40736501]
mat_Sqrt:  [[0.15]]
grads:  [0.04037891]
Stock Position:  0.040378913275020537
Bond Position:  [-12.28920195]


portfolio before change:  [-8.20852703]
curr_Stock_Price:  101.09759860739456
curr_Factors:  [101.09759861]
mat_Sqrt:  [[0.15]]
grads:  [-0.05800399]
Stock Position:  -0.058003992046162016
Bond Position:  [-2.34446273]


portfolio before change:  [-8.25995744]
curr_Stock_Price:  101.97921609633609
curr_Factors:  [101.9792161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04266873]
Stock Position:  -0.04266872822302414
Bond Position:  [-3.90863399]


portfolio before change:  [-8.27577695]
curr_Stock_Price:  102.33851653565065
curr_Factors:  [102.33851654]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699355]
Stock Position:  -0.006993546619978534
Bond Position:  [-7.56006776]


portfolio before change:  [-8.28361505]
curr_Stock_Price:  103.32414445246678
curr_Factors:  [103.32414445]
mat_Sqrt:  [[0.15]]
grads:  [-0.07157203]
Stock Position:  -0.07157202731460789
Bond Position:  [-0.88849656]


portfolio before change:  [-8.26492829]
curr_Stock_Price:  103.06150237860312
curr_Factors:  [103.06150238]
mat_Sqrt:  [[0.15]]
grads:  [0.30062034]
Stock Position:  0.3006203400810891
Bond Position:  [-39.24731219]


portfolio before change:  [-8.30978233]
curr_Stock_Price:  102.92861776823133
curr_Factors:  [102.92861777]
mat_Sqrt:  [[0.15]]
grads:  [-0.06113673]
Stock Position:  -0.061136727570978225
Bond Position:  [-2.01706347]


portfolio before change:  [-8.28843426]
curr_Stock_Price:  102.57530774696008
curr_Factors:  [102.57530775]
mat_Sqrt:  [[0.15]]
grads:  [-0.00366712]
Stock Position:  -0.0036671239536998613
Bond Position:  [-7.91227789]


portfolio before change:  [-8.28620761]
curr_Stock_Price:  101.69839484891943
curr_Factors:  [101.69839485]
mat_Sqrt:  [[0.15]]
grads:  [0.03438183]
Stock Position:  0.03438183472164219
Bond Position:  [-11.78278501]


portfolio before change:  [-8.29638601]
curr_Stock_Price:  101.44519538947733
curr_Factors:  [101.44519539]
mat_Sqrt:  [[0.15]]
grads:  [0.03418572]
Stock Position:  0.03418572363586613
Bond Position:  [-11.76436342]


portfolio before change:  [-8.29994514]
curr_Stock_Price:  101.38410282098332
curr_Factors:  [101.38410282]
mat_Sqrt:  [[0.15]]
grads:  [-0.0529197]
Stock Position:  -0.052919696908628806
Bond Position:  [-2.93472915]


portfolio before change:  [-8.23891049]
curr_Stock_Price:  100.22382565598741
curr_Factors:  [100.22382566]
mat_Sqrt:  [[0.15]]
grads:  [0.13122588]
Stock Position:  0.13122587598580243
Bond Position:  [-21.3908698]


portfolio before change:  [-8.47734849]
curr_Stock_Price:  98.42719844149701
curr_Factors:  [98.42719844]
mat_Sqrt:  [[0.15]]
grads:  [0.03809249]
Stock Position:  0.03809249069877305
Bond Position:  [-12.22668564]


portfolio before change:  [-8.4752944]
curr_Stock_Price:  98.52124657963427
curr_Factors:  [98.52124658]
mat_Sqrt:  [[0.15]]
grads:  [0.02288262]
Stock Position:  0.022882622381856715
Bond Position:  [-10.72971888]


portfolio before change:  [-8.46246036]
curr_Stock_Price:  99.14072692391281
curr_Factors:  [99.14072692]
mat_Sqrt:  [[0.15]]
grads:  [0.06339115]
Stock Position:  0.06339114513670821
Bond Position:  [-14.74710457]


portfolio before change:  [-8.43167657]
curr_Stock_Price:  99.65542486606535
curr_Factors:  [99.65542487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.43167657]
Stock Price:  100.48985750693674
PL:  [-8.92153408]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.50320745e-03]
 [-5.86712782e-03]
 [-9.49020910e-03]
 [-2.52220987e-04]
 [ 5.60892682e-03]
 [-2.33781298e-02]
 [-5.04176058e-02]
 [ 2.02695397e-02]
 [-5.99648608e-03]
 [ 6.16864922e-04]
 [-1.18036728e-03]
 [ 7.10549852e-03]
 [ 1.39642456e-02]
 [ 4.89582866e-03]
 [ 1.12098826e-02]
 [-3.20026855e-03]
 [ 1.23846552e-02]
 [-8.16601437e-03]
 [ 6.09024618e-03]
 [-7.19625808e-03]
 [ 2.04681725e-02]
 [-2.52010452e-03]
 [ 1.87148883e-02]
 [ 4.91327491e-03]
 [ 1.23984453e-02]
 [-1.07015167e-02]
 [ 1.35584998e-02]
 [-1.33888655e-02]
 [-1.89114233e-02]
 [-3.18797194e-03]
 [-2.93075858e-03]
 [ 5.36731409e-03]
 [ 5.13253764e-03]
 [-1.12258945e-02]
 [ 1.98063876e-02]
 [ 5.47520129e-03]
 [-3.33493986e-03]
 [ 8.92747955e-03]
 [-1.21128901e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.3561943]
curr_Stock_Price:  100.15507939455345
curr_Factors:  [100.15507939]
mat_Sqrt:  [[0.15]]
grads:  [0.03668805]
Stock Position:  0.03668804967813101
Bond Position:  [0.68169977]


portfolio before change:  [4.32006191]
curr_Stock_Price:  99.1679021988704
curr_Factors:  [99.1679022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911419]
Stock Position:  -0.0391141854536086
Bond Position:  [8.19893363]


portfolio before change:  [4.33482319]
curr_Stock_Price:  98.81671656503529
curr_Factors:  [98.81671657]
mat_Sqrt:  [[0.15]]
grads:  [-0.06326806]
Stock Position:  -0.06326806069999534
Bond Position:  [10.58676521]


portfolio before change:  [4.34145182]
curr_Stock_Price:  98.7328637384634
curr_Factors:  [98.73286374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00168147]
Stock Position:  -0.0016814732486387127
Bond Position:  [4.50746849]


portfolio before change:  [4.34127676]
curr_Stock_Price:  99.17207750601277
curr_Factors:  [99.17207751]
mat_Sqrt:  [[0.15]]
grads:  [0.03739285]
Stock Position:  0.03739284549955708
Bond Position:  [0.63295059]


portfolio before change:  [4.31379732]
curr_Stock_Price:  98.43507655837534
curr_Factors:  [98.43507656]
mat_Sqrt:  [[0.15]]
grads:  [-0.1558542]
Stock Position:  -0.15585419863972963
Bond Position:  [19.6553173]


portfolio before change:  [4.40416592]
curr_Stock_Price:  97.87101394685702
curr_Factors:  [97.87101395]
mat_Sqrt:  [[0.15]]
grads:  [-0.33611737]
Stock Position:  -0.336117371681054
Bond Position:  [37.30031389]


portfolio before change:  [4.29470582]
curr_Stock_Price:  98.2105469183692
curr_Factors:  [98.21054692]
mat_Sqrt:  [[0.15]]
grads:  [0.13513026]
Stock Position:  0.1351302646907009
Bond Position:  [-8.97651138]


portfolio before change:  [4.30349849]
curr_Stock_Price:  98.2839191202016
curr_Factors:  [98.28391912]
mat_Sqrt:  [[0.15]]
grads:  [-0.03997657]
Stock Position:  -0.03997657383507292
Bond Position:  [8.23255284]


portfolio before change:  [4.30692984]
curr_Stock_Price:  98.22382862081292
curr_Factors:  [98.22382862]
mat_Sqrt:  [[0.15]]
grads:  [0.00411243]
Stock Position:  0.004112432814504195
Bond Position:  [3.90299094]


portfolio before change:  [4.30797825]
curr_Stock_Price:  98.36012526816289
curr_Factors:  [98.36012527]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786912]
Stock Position:  -0.00786911517482341
Bond Position:  [5.0819854]


portfolio before change:  [4.3079358]
curr_Stock_Price:  98.44625148436022
curr_Factors:  [98.44625148]
mat_Sqrt:  [[0.15]]
grads:  [0.04736999]
Stock Position:  0.047369990113136945
Bond Position:  [-0.35546216]


portfolio before change:  [4.33946086]
curr_Stock_Price:  99.11269650698841
curr_Factors:  [99.11269651]
mat_Sqrt:  [[0.15]]
grads:  [0.09309497]
Stock Position:  0.09309497097469957
Bond Position:  [-4.88743274]


portfolio before change:  [4.37202873]
curr_Stock_Price:  99.46909428421965
curr_Factors:  [99.46909428]
mat_Sqrt:  [[0.15]]
grads:  [0.03263886]
Stock Position:  0.03263885773530634
Bond Position:  [1.12547112]


portfolio before change:  [4.36586259]
curr_Stock_Price:  99.2758634972989
curr_Factors:  [99.2758635]
mat_Sqrt:  [[0.15]]
grads:  [0.07473255]
Stock Position:  0.0747325505556866
Bond Position:  [-3.05327589]


portfolio before change:  [4.35105571]
curr_Stock_Price:  99.08283912407595
curr_Factors:  [99.08283912]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133512]
Stock Position:  -0.021335123645577343
Bond Position:  [6.46500033]


portfolio before change:  [4.35692213]
curr_Stock_Price:  98.84575386567516
curr_Factors:  [98.84575387]
mat_Sqrt:  [[0.15]]
grads:  [0.08256437]
Stock Position:  0.08256436789401615
Bond Position:  [-3.80421506]


portfolio before change:  [4.3062466]
curr_Stock_Price:  98.23774376046792
curr_Factors:  [98.23774376]
mat_Sqrt:  [[0.15]]
grads:  [-0.0544401]
Stock Position:  -0.05444009579687703
Bond Position:  [9.65431878]


portfolio before change:  [4.33119322]
curr_Stock_Price:  97.80167267241869
curr_Factors:  [97.80167267]
mat_Sqrt:  [[0.15]]
grads:  [0.04060164]
Stock Position:  0.040601641210528526
Bond Position:  [0.36028479]


portfolio before change:  [4.3571202]
curr_Stock_Price:  98.43913321250038
curr_Factors:  [98.43913321]
mat_Sqrt:  [[0.15]]
grads:  [-0.04797505]
Stock Position:  -0.04797505387077645
Bond Position:  [9.07974292]


portfolio before change:  [4.42290654]
curr_Stock_Price:  97.09153069921533
curr_Factors:  [97.0915307]
mat_Sqrt:  [[0.15]]
grads:  [0.13645448]
Stock Position:  0.13645448355037199
Bond Position:  [-8.82566814]


portfolio before change:  [4.41875976]
curr_Stock_Price:  97.06922652997268
curr_Factors:  [97.06922653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0168007]
Stock Position:  -0.01680069677374966
Bond Position:  [6.0495904]


portfolio before change:  [4.39631461]
curr_Stock_Price:  98.45020469079022
curr_Factors:  [98.45020469]
mat_Sqrt:  [[0.15]]
grads:  [0.12476592]
Stock Position:  0.12476592195214876
Bond Position:  [-7.88691594]


portfolio before change:  [4.41377368]
curr_Stock_Price:  98.5980414695886
curr_Factors:  [98.59804147]
mat_Sqrt:  [[0.15]]
grads:  [0.03275517]
Stock Position:  0.032755166089313316
Bond Position:  [1.18417845]


portfolio before change:  [4.41750826]
curr_Stock_Price:  98.70753738220202
curr_Factors:  [98.70753738]
mat_Sqrt:  [[0.15]]
grads:  [0.0826563]
Stock Position:  0.08265630193017905
Bond Position:  [-3.74129175]


portfolio before change:  [4.43501663]
curr_Stock_Price:  98.92501695227304
curr_Factors:  [98.92501695]
mat_Sqrt:  [[0.15]]
grads:  [-0.07134344]
Stock Position:  -0.07134344476333077
Bond Position:  [11.49266811]


portfolio before change:  [4.44288209]
curr_Stock_Price:  98.83490650849595
curr_Factors:  [98.83490651]
mat_Sqrt:  [[0.15]]
grads:  [0.09039]
Stock Position:  0.09038999866112332
Bond Position:  [-4.49080497]


portfolio before change:  [4.36622534]
curr_Stock_Price:  97.99305048985642
curr_Factors:  [97.99305049]
mat_Sqrt:  [[0.15]]
grads:  [-0.0892591]
Stock Position:  -0.08925910302977708
Bond Position:  [13.11299713]


portfolio before change:  [4.34326032]
curr_Stock_Price:  98.26870027954014
curr_Factors:  [98.26870028]
mat_Sqrt:  [[0.15]]
grads:  [-0.12607616]
Stock Position:  -0.12607615528828706
Bond Position:  [16.73260023]


portfolio before change:  [4.28564492]
curr_Stock_Price:  98.74227992253005
curr_Factors:  [98.74227992]
mat_Sqrt:  [[0.15]]
grads:  [-0.02125315]
Stock Position:  -0.02125314624755031
Bond Position:  [6.38422904]


portfolio before change:  [4.26055656]
curr_Stock_Price:  99.96028527870713
curr_Factors:  [99.96028528]
mat_Sqrt:  [[0.15]]
grads:  [-0.01953839]
Stock Position:  -0.019538390543103627
Bond Position:  [6.21361965]


portfolio before change:  [4.25824992]
curr_Stock_Price:  100.11809682082115
curr_Factors:  [100.11809682]
mat_Sqrt:  [[0.15]]
grads:  [0.03578209]
Stock Position:  0.03578209394002371
Bond Position:  [0.67581478]


portfolio before change:  [4.27037161]
curr_Stock_Price:  100.45449988869088
curr_Factors:  [100.45449989]
mat_Sqrt:  [[0.15]]
grads:  [0.03421692]
Stock Position:  0.03421691762436066
Bond Position:  [0.83312826]


portfolio before change:  [4.26170618]
curr_Stock_Price:  100.19820635263757
curr_Factors:  [100.19820635]
mat_Sqrt:  [[0.15]]
grads:  [-0.0748393]
Stock Position:  -0.07483929640295173
Bond Position:  [11.76046945]


portfolio before change:  [4.25689819]
curr_Stock_Price:  100.28209464089386
curr_Factors:  [100.28209464]
mat_Sqrt:  [[0.15]]
grads:  [0.13204258]
Stock Position:  0.13204258427306603
Bond Position:  [-8.98460874]


portfolio before change:  [4.45013772]
curr_Stock_Price:  101.75406427819976
curr_Factors:  [101.75406428]
mat_Sqrt:  [[0.15]]
grads:  [0.03650134]
Stock Position:  0.03650134192285801
Bond Position:  [0.73597783]


portfolio before change:  [4.47843152]
curr_Stock_Price:  102.52668790765198
curr_Factors:  [102.52668791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223293]
Stock Position:  -0.022232932410916277
Bond Position:  [6.75790045]


portfolio before change:  [4.47495579]
curr_Stock_Price:  102.7210176804933
curr_Factors:  [102.72101768]
mat_Sqrt:  [[0.15]]
grads:  [0.05951653]
Stock Position:  0.059516530321653965
Bond Position:  [-1.63864277]


portfolio before change:  [4.38849179]
curr_Stock_Price:  101.27168650435199
curr_Factors:  [101.2716865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.38849179]
Stock Price:  101.37801791831832
PL:  [3.01047387]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.79412152e-03]
 [ 2.00454052e-03]
 [ 1.47868552e-02]
 [-2.45624416e-03]
 [ 1.52568427e-02]
 [ 2.62030036e-02]
 [ 1.62439428e-02]
 [ 8.31263095e-03]
 [-9.25927438e-03]
 [-2.96650808e-03]
 [ 1.78378610e-02]
 [ 7.31142930e-03]
 [ 6.47129588e-03]
 [-4.80198440e-03]
 [ 9.93935200e-03]
 [ 2.88035161e-03]
 [ 9.00012791e-03]
 [ 6.88811216e-03]
 [ 1.20670214e-02]
 [-1.64466094e-02]
 [ 6.70018199e-03]
 [ 2.97924828e-02]
 [-4.17886553e-02]
 [ 6.30531884e-03]
 [ 5.09970867e-03]
 [-1.50048321e-02]
 [ 6.53392853e-04]
 [-1.26374128e-02]
 [ 6.03311050e-02]
 [-2.99936153e-03]
 [-8.91485263e-03]
 [ 4.38391190e-03]
 [ 5.84463392e-03]
 [-2.48034379e-03]
 [ 7.34810801e-03]
 [ 4.22820599e-03]
 [-4.10247065e-02]
 [ 9.52447190e-03]
 [-5.48535320e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.46136164]
curr_Stock_Price:  100.61342925681194
curr_Factors:  [100.61342926]
mat_Sqrt:  [[0.15]]
grads:  [0.03862748]
Stock Position:  0.0386274768167759
Bond Position:  [7.57491873]


portfolio before change:  [11.47645225]
curr_Stock_Price:  100.97958545237013
curr_Factors:  [100.97958545]
mat_Sqrt:  [[0.15]]
grads:  [0.0133636]
Stock Position:  0.013363603474364182
Bond Position:  [10.12700111]


portfolio before change:  [11.48124583]
curr_Stock_Price:  101.24355831817236
curr_Factors:  [101.24355832]
mat_Sqrt:  [[0.15]]
grads:  [0.09857903]
Stock Position:  0.09857903497375897
Bond Position:  [1.50075356]


portfolio before change:  [11.33609058]
curr_Stock_Price:  99.7691792972905
curr_Factors:  [99.7691793]
mat_Sqrt:  [[0.15]]
grads:  [-0.01637496]
Stock Position:  -0.016374961058828998
Bond Position:  [12.969807]


portfolio before change:  [11.33136782]
curr_Stock_Price:  100.15660520249239
curr_Factors:  [100.1566052]
mat_Sqrt:  [[0.15]]
grads:  [0.10171228]
Stock Position:  0.10171228497732475
Bond Position:  [1.14421065]


portfolio before change:  [11.41608089]
curr_Stock_Price:  100.98806847396573
curr_Factors:  [100.98806847]
mat_Sqrt:  [[0.15]]
grads:  [0.17468669]
Stock Position:  0.17468669088062938
Bond Position:  [-6.22519061]


portfolio before change:  [11.65730502]
curr_Stock_Price:  102.37341919952362
curr_Factors:  [102.3734192]
mat_Sqrt:  [[0.15]]
grads:  [0.10829295]
Stock Position:  0.10829295203684648
Bond Position:  [0.57098525]


portfolio before change:  [11.66648095]
curr_Stock_Price:  102.45749258569816
curr_Factors:  [102.45749259]
mat_Sqrt:  [[0.15]]
grads:  [0.05541754]
Stock Position:  0.055417539645144294
Bond Position:  [5.9885388]


portfolio before change:  [11.66533708]
curr_Stock_Price:  102.4233430241954
curr_Factors:  [102.42334302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0617285]
Stock Position:  -0.061728495865311574
Bond Position:  [17.98777599]


portfolio before change:  [11.70522074]
curr_Stock_Price:  101.81365637933014
curr_Factors:  [101.81365638]
mat_Sqrt:  [[0.15]]
grads:  [-0.01977672]
Stock Position:  -0.01977672051501261
Bond Position:  [13.71876096]


portfolio before change:  [11.68187627]
curr_Stock_Price:  103.08077348557272
curr_Factors:  [103.08077349]
mat_Sqrt:  [[0.15]]
grads:  [0.11891907]
Stock Position:  0.11891907334492559
Bond Position:  [-0.57639379]


portfolio before change:  [11.67354724]
curr_Stock_Price:  103.01133996934072
curr_Factors:  [103.01133997]
mat_Sqrt:  [[0.15]]
grads:  [0.04874286]
Stock Position:  0.04874286199945425
Bond Position:  [6.65247972]


portfolio before change:  [11.65753963]
curr_Stock_Price:  102.6658693321003
curr_Factors:  [102.66586933]
mat_Sqrt:  [[0.15]]
grads:  [0.04314197]
Stock Position:  0.04314197254933157
Bond Position:  [7.22833151]


portfolio before change:  [11.6577189]
curr_Stock_Price:  102.64908002116631
curr_Factors:  [102.64908002]
mat_Sqrt:  [[0.15]]
grads:  [-0.03201323]
Stock Position:  -0.03201322930462566
Bond Position:  [14.94384744]


portfolio before change:  [11.65661382]
curr_Stock_Price:  102.74195348812353
curr_Factors:  [102.74195349]
mat_Sqrt:  [[0.15]]
grads:  [0.06626235]
Stock Position:  0.06626234669876933
Bond Position:  [4.84869088]


portfolio before change:  [11.70118024]
curr_Stock_Price:  103.40538149152836
curr_Factors:  [103.40538149]
mat_Sqrt:  [[0.15]]
grads:  [0.01920234]
Stock Position:  0.019202344092249694
Bond Position:  [9.71555453]


portfolio before change:  [11.69423461]
curr_Stock_Price:  102.98042564892349
curr_Factors:  [102.98042565]
mat_Sqrt:  [[0.15]]
grads:  [0.06000085]
Stock Position:  0.06000085275901073
Bond Position:  [5.51532126]


portfolio before change:  [11.72636519]
curr_Stock_Price:  103.50443677829955
curr_Factors:  [103.50443678]
mat_Sqrt:  [[0.15]]
grads:  [0.04592075]
Stock Position:  0.04592074772301058
Bond Position:  [6.97336406]


portfolio before change:  [11.77978155]
curr_Stock_Price:  104.64868296125702
curr_Factors:  [104.64868296]
mat_Sqrt:  [[0.15]]
grads:  [0.08044681]
Stock Position:  0.08044680937106065
Bond Position:  [3.3611289]


portfolio before change:  [11.75334924]
curr_Stock_Price:  104.31489124866923
curr_Factors:  [104.31489125]
mat_Sqrt:  [[0.15]]
grads:  [-0.10964406]
Stock Position:  -0.10964406259675322
Bond Position:  [23.19085771]


portfolio before change:  [11.76331662]
curr_Stock_Price:  104.25042499234576
curr_Factors:  [104.25042499]
mat_Sqrt:  [[0.15]]
grads:  [0.04466788]
Stock Position:  0.04466787994239294
Bond Position:  [7.10667115]


portfolio before change:  [11.7238826]
curr_Stock_Price:  103.34770891696492
curr_Factors:  [103.34770892]
mat_Sqrt:  [[0.15]]
grads:  [0.19861655]
Stock Position:  0.1986165520028156
Bond Position:  [-8.802683]


portfolio before change:  [11.69275417]
curr_Stock_Price:  103.19652299153971
curr_Factors:  [103.19652299]
mat_Sqrt:  [[0.15]]
grads:  [-0.27859104]
Stock Position:  -0.27859103547423325
Bond Position:  [40.44238036]


portfolio before change:  [11.75014755]
curr_Stock_Price:  103.0086570310751
curr_Factors:  [103.00865703]
mat_Sqrt:  [[0.15]]
grads:  [0.04203546]
Stock Position:  0.04203545890880082
Bond Position:  [7.42013138]


portfolio before change:  [11.77530283]
curr_Stock_Price:  103.58502048980253
curr_Factors:  [103.58502049]
mat_Sqrt:  [[0.15]]
grads:  [0.03399806]
Stock Position:  0.03399805780402723
Bond Position:  [8.25361331]


portfolio before change:  [11.81108242]
curr_Stock_Price:  104.60707373842601
curr_Factors:  [104.60707374]
mat_Sqrt:  [[0.15]]
grads:  [-0.10003221]
Stock Position:  -0.1000322140060544
Bond Position:  [22.27515961]


portfolio before change:  [11.61779627]
curr_Stock_Price:  106.56714950715963
curr_Factors:  [106.56714951]
mat_Sqrt:  [[0.15]]
grads:  [0.00435595]
Stock Position:  0.004355952353455889
Bond Position:  [11.15359485]


portfolio before change:  [11.6174314]
curr_Stock_Price:  106.16329795912993
curr_Factors:  [106.16329796]
mat_Sqrt:  [[0.15]]
grads:  [-0.08424942]
Stock Position:  -0.08424941871203731
Bond Position:  [20.56162754]


portfolio before change:  [11.6930511]
curr_Stock_Price:  105.29623757070162
curr_Factors:  [105.29623757]
mat_Sqrt:  [[0.15]]
grads:  [0.40220737]
Stock Position:  0.40220736637612914
Bond Position:  [-30.65787131]


portfolio before change:  [11.90003728]
curr_Stock_Price:  105.82039171032474
curr_Factors:  [105.82039171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01999574]
Stock Position:  -0.01999574350868934
Bond Position:  [14.01599469]


portfolio before change:  [11.90674788]
curr_Stock_Price:  105.5724145570649
curr_Factors:  [105.57241456]
mat_Sqrt:  [[0.15]]
grads:  [-0.05943235]
Stock Position:  -0.05943235089290889
Bond Position:  [18.18116466]


portfolio before change:  [11.8941126]
curr_Stock_Price:  105.82325545203436
curr_Factors:  [105.82325545]
mat_Sqrt:  [[0.15]]
grads:  [0.02922608]
Stock Position:  0.02922607931131997
Bond Position:  [8.80131374]


portfolio before change:  [11.87967746]
curr_Stock_Price:  105.29169690474357
curr_Factors:  [105.2916969]
mat_Sqrt:  [[0.15]]
grads:  [0.03896423]
Stock Position:  0.038964226134163345
Bond Position:  [7.77706797]


portfolio before change:  [11.86899362]
curr_Stock_Price:  104.99254986186094
curr_Factors:  [104.99254986]
mat_Sqrt:  [[0.15]]
grads:  [-0.01653563]
Stock Position:  -0.01653562528629885
Bond Position:  [13.60511108]


portfolio before change:  [11.86420968]
curr_Stock_Price:  105.38471457505608
curr_Factors:  [105.38471458]
mat_Sqrt:  [[0.15]]
grads:  [0.04898739]
Stock Position:  0.048987386759223615
Bond Position:  [6.70168791]


portfolio before change:  [11.88206521]
curr_Stock_Price:  105.73210546199326
curr_Factors:  [105.73210546]
mat_Sqrt:  [[0.15]]
grads:  [0.02818804]
Stock Position:  0.02818803990337425
Bond Position:  [8.90168441]


portfolio before change:  [11.90326585]
curr_Stock_Price:  106.44474290316643
curr_Factors:  [106.4447429]
mat_Sqrt:  [[0.15]]
grads:  [-0.27349804]
Stock Position:  -0.2734980431771684
Bond Position:  [41.01569474]


portfolio before change:  [11.70238523]
curr_Stock_Price:  107.19797642763805
curr_Factors:  [107.19797643]
mat_Sqrt:  [[0.15]]
grads:  [0.06349648]
Stock Position:  0.06349647933482831
Bond Position:  [4.89569114]


portfolio before change:  [11.70252182]
curr_Stock_Price:  107.19048920010638
curr_Factors:  [107.1904892]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.70252182]
Stock Price:  108.43868915079408
PL:  [3.26383267]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.22116071e-03]
 [-1.47490380e-03]
 [ 1.34413939e-02]
 [ 2.12298339e-03]
 [-6.23572132e-03]
 [ 2.90876604e-02]
 [ 2.69560821e-02]
 [ 1.10750722e-02]
 [-9.15994584e-03]
 [-2.44881560e-03]
 [ 1.07658277e-02]
 [ 4.65158793e-03]
 [ 1.11545709e-02]
 [-4.80003830e-03]
 [ 1.03896421e-02]
 [ 2.61411083e-03]
 [ 9.12888121e-03]
 [ 9.89252385e-03]
 [ 1.17616717e-02]
 [-1.60708001e-02]
 [ 9.02413978e-03]
 [ 3.87356195e-02]
 [-7.11677293e-03]
 [ 8.07695713e-03]
 [ 7.47818184e-03]
 [-9.53314417e-03]
 [-9.91649216e-04]
 [-1.10259064e-02]
 [-1.53037130e-02]
 [-9.06725475e-03]
 [ 2.72582574e-05]
 [ 5.03373055e-03]
 [ 5.21433864e-03]
 [-5.13049639e-03]
 [ 1.41074515e-02]
 [ 5.32592213e-03]
 [-2.05456749e-03]
 [ 8.31845587e-03]
 [-1.30258323e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.03962737]
curr_Stock_Price:  100.84426092165539
curr_Factors:  [100.84426092]
mat_Sqrt:  [[0.15]]
grads:  [0.0414744]
Stock Position:  0.04147440474222652
Bond Position:  [10.85717167]


portfolio before change:  [15.06603179]
curr_Stock_Price:  101.44818014935888
curr_Factors:  [101.44818015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00983269]
Stock Position:  -0.009832691983749966
Bond Position:  [16.0635405]


portfolio before change:  [15.07347314]
curr_Stock_Price:  100.89560681334163
curr_Factors:  [100.89560681]
mat_Sqrt:  [[0.15]]
grads:  [0.08960929]
Stock Position:  0.0896092928432497
Bond Position:  [6.03228916]


portfolio before change:  [15.11503281]
curr_Stock_Price:  101.35097912861728
curr_Factors:  [101.35097913]
mat_Sqrt:  [[0.15]]
grads:  [0.01415322]
Stock Position:  0.014153222568336373
Bond Position:  [13.68058985]


portfolio before change:  [15.13819586]
curr_Stock_Price:  102.86673759984996
curr_Factors:  [102.8667376]
mat_Sqrt:  [[0.15]]
grads:  [-0.04157148]
Stock Position:  -0.04157147546033241
Bond Position:  [19.41451792]


portfolio before change:  [15.1600106]
curr_Stock_Price:  102.4003655846025
curr_Factors:  [102.40036558]
mat_Sqrt:  [[0.15]]
grads:  [0.19391774]
Stock Position:  0.19391773568099746
Bond Position:  [-4.69723643]


portfolio before change:  [15.26246071]
curr_Stock_Price:  102.93171100198614
curr_Factors:  [102.931711]
mat_Sqrt:  [[0.15]]
grads:  [0.17970721]
Stock Position:  0.17970721396159495
Bond Position:  [-3.2351103]


portfolio before change:  [15.03811444]
curr_Stock_Price:  101.68556259108706
curr_Factors:  [101.68556259]
mat_Sqrt:  [[0.15]]
grads:  [0.07383381]
Stock Position:  0.07383381499783877
Bond Position:  [7.53028142]


portfolio before change:  [15.08858382]
curr_Stock_Price:  102.35636691917706
curr_Factors:  [102.35636692]
mat_Sqrt:  [[0.15]]
grads:  [-0.06106631]
Stock Position:  -0.06106630562309284
Bond Position:  [21.33910901]


portfolio before change:  [15.13539085]
curr_Stock_Price:  101.6335547795444
curr_Factors:  [101.63355478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01632544]
Stock Position:  -0.01632543734867632
Bond Position:  [16.79460308]


portfolio before change:  [15.13508965]
curr_Stock_Price:  101.7806048259094
curr_Factors:  [101.78060483]
mat_Sqrt:  [[0.15]]
grads:  [0.07177218]
Stock Position:  0.0717721845033758
Bond Position:  [7.8300733]


portfolio before change:  [15.0979405]
curr_Stock_Price:  101.24936882656537
curr_Factors:  [101.24936883]
mat_Sqrt:  [[0.15]]
grads:  [0.03101059]
Stock Position:  0.031010586224227872
Bond Position:  [11.95813822]


portfolio before change:  [15.09972572]
curr_Stock_Price:  101.2587321421154
curr_Factors:  [101.25873214]
mat_Sqrt:  [[0.15]]
grads:  [0.07436381]
Stock Position:  0.07436380566773448
Bond Position:  [7.56974104]


portfolio before change:  [15.12019712]
curr_Stock_Price:  101.5212943812237
curr_Factors:  [101.52129438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03200026]
Stock Position:  -0.03200025534762835
Bond Position:  [18.36890447]


portfolio before change:  [15.08506224]
curr_Stock_Price:  102.69100813730122
curr_Factors:  [102.69100814]
mat_Sqrt:  [[0.15]]
grads:  [0.06926428]
Stock Position:  0.06926428061137689
Bond Position:  [7.97224344]


portfolio before change:  [15.11523315]
curr_Stock_Price:  103.11221107381401
curr_Factors:  [103.11221107]
mat_Sqrt:  [[0.15]]
grads:  [0.01742741]
Stock Position:  0.017427405539970176
Bond Position:  [13.31825484]


portfolio before change:  [15.13064377]
curr_Stock_Price:  103.90095306193389
curr_Factors:  [103.90095306]
mat_Sqrt:  [[0.15]]
grads:  [0.06085921]
Stock Position:  0.06085920803449631
Bond Position:  [8.80731405]


portfolio before change:  [15.08293772]
curr_Stock_Price:  103.09898682552645
curr_Factors:  [103.09898683]
mat_Sqrt:  [[0.15]]
grads:  [0.06595016]
Stock Position:  0.06595015903251789
Bond Position:  [8.28354314]


portfolio before change:  [15.10555385]
curr_Stock_Price:  103.4262130165987
curr_Factors:  [103.42621302]
mat_Sqrt:  [[0.15]]
grads:  [0.07841114]
Stock Position:  0.07841114436359746
Bond Position:  [6.99578613]


portfolio before change:  [15.14214211]
curr_Stock_Price:  103.88168060988217
curr_Factors:  [103.88168061]
mat_Sqrt:  [[0.15]]
grads:  [-0.10713867]
Stock Position:  -0.10713866754424274
Bond Position:  [26.27188695]


portfolio before change:  [15.05459495]
curr_Stock_Price:  104.72947300227874
curr_Factors:  [104.729473]
mat_Sqrt:  [[0.15]]
grads:  [0.06016093]
Stock Position:  0.06016093188971731
Bond Position:  [8.75397226]


portfolio before change:  [15.08742332]
curr_Stock_Price:  105.25695903227636
curr_Factors:  [105.25695903]
mat_Sqrt:  [[0.15]]
grads:  [0.25823746]
Stock Position:  0.25823746318954677
Bond Position:  [-12.09386676]


portfolio before change:  [15.05266943]
curr_Stock_Price:  105.12823232461442
curr_Factors:  [105.12823232]
mat_Sqrt:  [[0.15]]
grads:  [-0.04744515]
Stock Position:  -0.04744515288638234
Bond Position:  [20.04049449]


portfolio before change:  [15.07312775]
curr_Stock_Price:  104.74983547802901
curr_Factors:  [104.74983548]
mat_Sqrt:  [[0.15]]
grads:  [0.05384638]
Stock Position:  0.05384638087395931
Bond Position:  [9.43272821]


portfolio before change:  [15.08781489]
curr_Stock_Price:  105.00069685264302
curr_Factors:  [105.00069685]
mat_Sqrt:  [[0.15]]
grads:  [0.04985455]
Stock Position:  0.04985454560529397
Bond Position:  [9.85305286]


portfolio before change:  [15.00278686]
curr_Stock_Price:  103.27046863302728
curr_Factors:  [103.27046863]
mat_Sqrt:  [[0.15]]
grads:  [-0.06355429]
Stock Position:  -0.0635542944614552
Bond Position:  [21.56606863]


portfolio before change:  [15.03428571]
curr_Stock_Price:  102.81726670289835
curr_Factors:  [102.8172667]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661099]
Stock Position:  -0.006610994771845692
Bond Position:  [15.71401012]


portfolio before change:  [15.03874406]
curr_Stock_Price:  102.44002097701848
curr_Factors:  [102.44002098]
mat_Sqrt:  [[0.15]]
grads:  [-0.07350604]
Stock Position:  -0.07350604240042653
Bond Position:  [22.56870458]


portfolio before change:  [15.12746379]
curr_Stock_Price:  101.27143044728321
curr_Factors:  [101.27143045]
mat_Sqrt:  [[0.15]]
grads:  [-0.10202475]
Stock Position:  -0.10202475328203768
Bond Position:  [25.45965649]


portfolio before change:  [15.16492073]
curr_Stock_Price:  100.93548955801718
curr_Factors:  [100.93548956]
mat_Sqrt:  [[0.15]]
grads:  [-0.06044836]
Stock Position:  -0.06044836497241369
Bond Position:  [21.26630604]


portfolio before change:  [15.10310649]
curr_Stock_Price:  102.00206418204013
curr_Factors:  [102.00206418]
mat_Sqrt:  [[0.15]]
grads:  [0.00018172]
Stock Position:  0.00018172171575198243
Bond Position:  [15.0845705]


portfolio before change:  [15.10509331]
curr_Stock_Price:  102.55858192591195
curr_Factors:  [102.55858193]
mat_Sqrt:  [[0.15]]
grads:  [0.0335582]
Stock Position:  0.03355820369363021
Bond Position:  [11.66341153]


portfolio before change:  [15.11657517]
curr_Stock_Price:  102.85728221774924
curr_Factors:  [102.85728222]
mat_Sqrt:  [[0.15]]
grads:  [0.03476226]
Stock Position:  0.03476225760554834
Bond Position:  [11.54102383]


portfolio before change:  [15.1042056]
curr_Stock_Price:  102.45994628876058
curr_Factors:  [102.45994629]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420331]
Stock Position:  -0.03420330923588658
Bond Position:  [18.60867482]


portfolio before change:  [15.10044363]
curr_Stock_Price:  102.63794641597786
curr_Factors:  [102.63794642]
mat_Sqrt:  [[0.15]]
grads:  [0.09404968]
Stock Position:  0.09404967639072365
Bond Position:  [5.44737799]


portfolio before change:  [15.11712176]
curr_Stock_Price:  102.80803908837854
curr_Factors:  [102.80803909]
mat_Sqrt:  [[0.15]]
grads:  [0.03550615]
Stock Position:  0.035506147518162966
Bond Position:  [11.46680436]


portfolio before change:  [15.1000154]
curr_Stock_Price:  102.28588154786944
curr_Factors:  [102.28588155]
mat_Sqrt:  [[0.15]]
grads:  [-0.01369712]
Stock Position:  -0.01369711660217509
Bond Position:  [16.50103704]


portfolio before change:  [15.10711659]
curr_Stock_Price:  101.9180352415383
curr_Factors:  [101.91803524]
mat_Sqrt:  [[0.15]]
grads:  [0.05545637]
Stock Position:  0.055456372459330404
Bond Position:  [9.45511207]


portfolio before change:  [15.08384428]
curr_Stock_Price:  101.47707115850264
curr_Factors:  [101.47707116]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.08384428]
Stock Price:  102.78070697306994
PL:  [12.30313731]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.81991769e-03]
 [ 4.23013841e-03]
 [-1.42618500e-04]
 [-2.28734054e-03]
 [ 1.26266045e-02]
 [ 9.45398708e-03]
 [-2.20840450e-03]
 [ 2.19670155e-02]
 [-6.52109798e-03]
 [-1.20241465e-03]
 [ 9.30830111e-03]
 [ 4.85566192e-03]
 [ 9.27057978e-03]
 [-5.08434172e-03]
 [ 2.36284252e-02]
 [ 1.23606216e-03]
 [ 8.82715960e-03]
 [ 1.11694493e-02]
 [ 1.14513718e-02]
 [-1.42958248e-02]
 [-1.38167260e-02]
 [ 1.89310156e-02]
 [ 1.51901873e-02]
 [ 6.01877633e-03]
 [ 1.96678976e-03]
 [-1.03504098e-02]
 [ 4.21068132e-03]
 [-1.06000831e-02]
 [-1.80352407e-02]
 [-5.42426770e-03]
 [-3.50384728e-03]
 [ 5.63646129e-03]
 [ 7.08572945e-03]
 [-1.27211325e-02]
 [ 3.22872178e-03]
 [ 5.61096870e-03]
 [ 3.27681573e-03]
 [ 1.12290664e-02]
 [-4.18427965e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.77253061]
curr_Stock_Price:  100.18193698717606
curr_Factors:  [100.18193699]
mat_Sqrt:  [[0.15]]
grads:  [0.03879945]
Stock Position:  0.03879945126415495
Bond Position:  [0.88552643]


portfolio before change:  [4.76463338]
curr_Stock_Price:  99.97554401286712
curr_Factors:  [99.97554401]
mat_Sqrt:  [[0.15]]
grads:  [0.02820092]
Stock Position:  0.028200922734153262
Bond Position:  [1.94523078]


portfolio before change:  [4.74723684]
curr_Stock_Price:  99.35004321005101
curr_Factors:  [99.35004321]
mat_Sqrt:  [[0.15]]
grads:  [-0.00095079]
Stock Position:  -0.0009507899973036985
Bond Position:  [4.84169787]


portfolio before change:  [4.74757803]
curr_Stock_Price:  99.6277713171919
curr_Factors:  [99.62777132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01524894]
Stock Position:  -0.01524893692364657
Bond Position:  [6.26679563]


portfolio before change:  [4.74522858]
curr_Stock_Price:  99.83321870394899
curr_Factors:  [99.8332187]
mat_Sqrt:  [[0.15]]
grads:  [0.08417736]
Stock Position:  0.0841773630594154
Bond Position:  [-3.65846852]


portfolio before change:  [4.73843272]
curr_Stock_Price:  99.75791911914492
curr_Factors:  [99.75791912]
mat_Sqrt:  [[0.15]]
grads:  [0.06302658]
Stock Position:  0.0630265805592392
Bond Position:  [-1.54896781]


portfolio before change:  [4.76140198]
curr_Stock_Price:  100.1254289540507
curr_Factors:  [100.12542895]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147227]
Stock Position:  -0.014722696663358424
Bond Position:  [6.23551829]


portfolio before change:  [4.76407363]
curr_Stock_Price:  99.99690876732505
curr_Factors:  [99.99690877]
mat_Sqrt:  [[0.15]]
grads:  [0.14644677]
Stock Position:  0.14644677025311112
Bond Position:  [-9.8801507]


portfolio before change:  [4.88414504]
curr_Stock_Price:  100.82524054412511
curr_Factors:  [100.82524054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04347399]
Stock Position:  -0.043473986518252336
Bond Position:  [9.26742019]


portfolio before change:  [4.86912407]
curr_Stock_Price:  101.19740506525561
curr_Factors:  [101.19740507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0080161]
Stock Position:  -0.008016097684020727
Bond Position:  [5.68033235]


portfolio before change:  [4.86805852]
curr_Stock_Price:  101.41891383370839
curr_Factors:  [101.41891383]
mat_Sqrt:  [[0.15]]
grads:  [0.06205534]
Stock Position:  0.06205534070227317
Bond Position:  [-1.42552673]


portfolio before change:  [4.86877714]
curr_Stock_Price:  101.43336587983964
curr_Factors:  [101.43336588]
mat_Sqrt:  [[0.15]]
grads:  [0.03237108]
Stock Position:  0.032371079455054484
Bond Position:  [1.5852696]


portfolio before change:  [4.87926242]
curr_Stock_Price:  101.75115277705176
curr_Factors:  [101.75115278]
mat_Sqrt:  [[0.15]]
grads:  [0.06180387]
Stock Position:  0.061803865167006394
Bond Position:  [-1.40935211]


portfolio before change:  [4.91253147]
curr_Stock_Price:  102.292303897566
curr_Factors:  [102.2923039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03389561]
Stock Position:  -0.0338956114566572
Bond Position:  [8.37979166]


portfolio before change:  [4.94443999]
curr_Stock_Price:  101.3818326982181
curr_Factors:  [101.3818327]
mat_Sqrt:  [[0.15]]
grads:  [0.15752283]
Stock Position:  0.1575228349252011
Bond Position:  [-11.02551371]


portfolio before change:  [4.87649394]
curr_Stock_Price:  100.95924146728866
curr_Factors:  [100.95924147]
mat_Sqrt:  [[0.15]]
grads:  [0.00824041]
Stock Position:  0.008240414399377633
Bond Position:  [4.04454796]


portfolio before change:  [4.88450242]
curr_Stock_Price:  101.8697389875877
curr_Factors:  [101.86973899]
mat_Sqrt:  [[0.15]]
grads:  [0.05884773]
Stock Position:  0.05884773064245601
Bond Position:  [-1.11030054]


portfolio before change:  [4.91874862]
curr_Stock_Price:  102.45404345959238
curr_Factors:  [102.45404346]
mat_Sqrt:  [[0.15]]
grads:  [0.074463]
Stock Position:  0.07446299531902136
Bond Position:  [-2.71028634]


portfolio before change:  [4.898296]
curr_Stock_Price:  102.18392520362822
curr_Factors:  [102.1839252]
mat_Sqrt:  [[0.15]]
grads:  [0.07634248]
Stock Position:  0.07634247851122829
Bond Position:  [-2.90267812]


portfolio before change:  [4.90415708]
curr_Stock_Price:  102.26545173392073
curr_Factors:  [102.26545173]
mat_Sqrt:  [[0.15]]
grads:  [-0.0953055]
Stock Position:  -0.09530549872230383
Bond Position:  [14.65061696]


portfolio before change:  [4.98943443]
curr_Stock_Price:  101.38988932491209
curr_Factors:  [101.38988932]
mat_Sqrt:  [[0.15]]
grads:  [-0.09211151]
Stock Position:  -0.09211150636298622
Bond Position:  [14.32860987]


portfolio before change:  [5.03810167]
curr_Stock_Price:  100.88098382489967
curr_Factors:  [100.88098382]
mat_Sqrt:  [[0.15]]
grads:  [0.12620677]
Stock Position:  0.12620677036493344
Bond Position:  [-7.69376149]


portfolio before change:  [4.83207789]
curr_Stock_Price:  99.25617397615824
curr_Factors:  [99.25617398]
mat_Sqrt:  [[0.15]]
grads:  [0.10126792]
Stock Position:  0.10126791510457547
Bond Position:  [-5.21938791]


portfolio before change:  [4.94214949]
curr_Stock_Price:  100.3495515795805
curr_Factors:  [100.34955158]
mat_Sqrt:  [[0.15]]
grads:  [0.04012518]
Stock Position:  0.04012517554711863
Bond Position:  [0.91560612]


portfolio before change:  [4.91477914]
curr_Stock_Price:  99.66457481384798
curr_Factors:  [99.66457481]
mat_Sqrt:  [[0.15]]
grads:  [0.01311193]
Stock Position:  0.013111931715526146
Bond Position:  [3.60798404]


portfolio before change:  [4.91412258]
curr_Stock_Price:  99.58010349816071
curr_Factors:  [99.5801035]
mat_Sqrt:  [[0.15]]
grads:  [-0.06900273]
Stock Position:  -0.06900273196464181
Bond Position:  [11.78542177]


portfolio before change:  [4.88134923]
curr_Stock_Price:  100.07641175621538
curr_Factors:  [100.07641176]
mat_Sqrt:  [[0.15]]
grads:  [0.02807121]
Stock Position:  0.02807120879160835
Bond Position:  [2.07208338]


portfolio before change:  [4.87919377]
curr_Stock_Price:  99.99039884729443
curr_Factors:  [99.99039885]
mat_Sqrt:  [[0.15]]
grads:  [-0.07066722]
Stock Position:  -0.07066722056522937
Bond Position:  [11.94523734]


portfolio before change:  [4.9132034]
curr_Stock_Price:  99.5302649157695
curr_Factors:  [99.53026492]
mat_Sqrt:  [[0.15]]
grads:  [-0.12023494]
Stock Position:  -0.12023493799235771
Bond Position:  [16.88021863]


portfolio before change:  [4.88381906]
curr_Stock_Price:  99.79220624486216
curr_Factors:  [99.79220624]
mat_Sqrt:  [[0.15]]
grads:  [-0.03616178]
Stock Position:  -0.03616178465944676
Bond Position:  [8.49248333]


portfolio before change:  [4.91691454]
curr_Stock_Price:  98.90635810741178
curr_Factors:  [98.90635811]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335898]
Stock Position:  -0.023358981893807258
Bond Position:  [7.22726636]


portfolio before change:  [4.92603817]
curr_Stock_Price:  98.55445202556878
curr_Factors:  [98.55445203]
mat_Sqrt:  [[0.15]]
grads:  [0.03757641]
Stock Position:  0.03757640857501957
Bond Position:  [1.22271581]


portfolio before change:  [4.92689734]
curr_Stock_Price:  98.57324900674232
curr_Factors:  [98.57324901]
mat_Sqrt:  [[0.15]]
grads:  [0.0472382]
Stock Position:  0.047238196305987294
Bond Position:  [0.27047485]


portfolio before change:  [4.88918699]
curr_Stock_Price:  97.7742310795073
curr_Factors:  [97.77423108]
mat_Sqrt:  [[0.15]]
grads:  [-0.08480755]
Stock Position:  -0.08480754969113243
Bond Position:  [13.18117995]


portfolio before change:  [4.91671305]
curr_Stock_Price:  97.46908949369502
curr_Factors:  [97.46908949]
mat_Sqrt:  [[0.15]]
grads:  [0.02152481]
Stock Position:  0.021524811844251517
Bond Position:  [2.81870923]


portfolio before change:  [4.89209564]
curr_Stock_Price:  96.30904392009545
curr_Factors:  [96.30904392]
mat_Sqrt:  [[0.15]]
grads:  [0.03740646]
Stock Position:  0.037406458032350626
Bond Position:  [1.28951544]


portfolio before change:  [4.86753275]
curr_Stock_Price:  95.64808590347248
curr_Factors:  [95.6480859]
mat_Sqrt:  [[0.15]]
grads:  [0.02184544]
Stock Position:  0.02184543823033484
Bond Position:  [2.77805839]


portfolio before change:  [4.88120495]
curr_Stock_Price:  96.25804977105376
curr_Factors:  [96.25804977]
mat_Sqrt:  [[0.15]]
grads:  [0.07486044]
Stock Position:  0.07486044297472844
Bond Position:  [-2.32471529]


portfolio before change:  [4.84075866]
curr_Stock_Price:  95.72164251511083
curr_Factors:  [95.72164252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.84075866]
Stock Price:  94.90653900466344
PL:  [4.84075866]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.71660446e-03]
 [-9.37259034e-03]
 [-1.10046359e-02]
 [-2.59438354e-03]
 [ 1.48615901e-02]
 [ 2.66465649e-02]
 [ 2.27072996e-02]
 [ 1.62626090e-02]
 [-6.73217564e-03]
 [-1.44304034e-03]
 [ 1.24683560e-02]
 [ 4.72559408e-03]
 [ 5.37431073e-03]
 [-4.10489390e-03]
 [ 4.22573993e-03]
 [ 3.41017927e-03]
 [ 9.12578147e-03]
 [ 9.27908680e-03]
 [ 1.18054387e-02]
 [-1.51343106e-02]
 [-9.51575403e-04]
 [ 2.85770691e-02]
 [-3.90764071e-02]
 [ 6.73463133e-03]
 [ 7.32105425e-03]
 [-1.54662945e-02]
 [-1.09200991e-04]
 [-1.18364277e-02]
 [ 6.12314881e-02]
 [-3.01697285e-03]
 [-9.21595857e-03]
 [ 4.35134913e-03]
 [ 5.93775987e-03]
 [-1.82670627e-03]
 [ 7.36087646e-03]
 [ 4.76754740e-03]
 [-1.01310310e-02]
 [ 1.00611496e-02]
 [-1.30034280e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.56309607]
curr_Stock_Price:  99.32166412308658
curr_Factors:  [99.32166412]
mat_Sqrt:  [[0.15]]
grads:  [0.0381107]
Stock Position:  0.038110696415625464
Bond Position:  [-12.34831386]


portfolio before change:  [-8.58004139]
curr_Stock_Price:  98.91753370564601
curr_Factors:  [98.91753371]
mat_Sqrt:  [[0.15]]
grads:  [-0.06248394]
Stock Position:  -0.06248393561310855
Bond Position:  [-2.39928459]


portfolio before change:  [-8.56733039]
curr_Stock_Price:  98.70930516835313
curr_Factors:  [98.70930517]
mat_Sqrt:  [[0.15]]
grads:  [-0.07336424]
Stock Position:  -0.07336423952077505
Bond Position:  [-1.32559728]


portfolio before change:  [-8.65226627]
curr_Stock_Price:  99.86477515297953
curr_Factors:  [99.86477515]
mat_Sqrt:  [[0.15]]
grads:  [-0.01729589]
Stock Position:  -0.017295890289814198
Bond Position:  [-6.92501608]


portfolio before change:  [-8.67392752]
curr_Stock_Price:  101.06711641475144
curr_Factors:  [101.06711641]
mat_Sqrt:  [[0.15]]
grads:  [0.09907727]
Stock Position:  0.09907726728466612
Bond Position:  [-18.68738122]


portfolio before change:  [-8.6262644]
curr_Stock_Price:  101.57176483071368
curr_Factors:  [101.57176483]
mat_Sqrt:  [[0.15]]
grads:  [0.17764377]
Stock Position:  0.1776437660598308
Bond Position:  [-26.66985523]


portfolio before change:  [-8.42734922]
curr_Stock_Price:  102.7102743312922
curr_Factors:  [102.71027433]
mat_Sqrt:  [[0.15]]
grads:  [0.151382]
Stock Position:  0.151381997057229
Bond Position:  [-23.97583567]


portfolio before change:  [-8.70952049]
curr_Stock_Price:  100.866104602386
curr_Factors:  [100.8661046]
mat_Sqrt:  [[0.15]]
grads:  [0.10841739]
Stock Position:  0.10841739300115566
Bond Position:  [-19.64516059]


portfolio before change:  [-8.70551583]
curr_Stock_Price:  100.92569332101448
curr_Factors:  [100.92569332]
mat_Sqrt:  [[0.15]]
grads:  [-0.04488117]
Stock Position:  -0.04488117093572486
Bond Position:  [-4.17585254]


portfolio before change:  [-8.72210348]
curr_Stock_Price:  101.28365258208392
curr_Factors:  [101.28365258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962027]
Stock Position:  -0.0096202689026655
Bond Position:  [-7.7477275]


portfolio before change:  [-8.73191728]
curr_Stock_Price:  102.20309398035926
curr_Factors:  [102.20309398]
mat_Sqrt:  [[0.15]]
grads:  [0.08312237]
Stock Position:  0.08312237350439863
Bond Position:  [-17.22728103]


portfolio before change:  [-8.80780035]
curr_Stock_Price:  101.31609419779487
curr_Factors:  [101.3160942]
mat_Sqrt:  [[0.15]]
grads:  [0.03150396]
Stock Position:  0.0315039605161889
Bond Position:  [-11.99965858]


portfolio before change:  [-8.75548424]
curr_Stock_Price:  103.02432903757536
curr_Factors:  [103.02432904]
mat_Sqrt:  [[0.15]]
grads:  [0.03582874]
Stock Position:  0.0358287381988456
Bond Position:  [-12.44671595]


portfolio before change:  [-8.7389263]
curr_Stock_Price:  103.52989742407397
curr_Factors:  [103.52989742]
mat_Sqrt:  [[0.15]]
grads:  [-0.02736596]
Stock Position:  -0.02736595935365318
Bond Position:  [-5.90573133]


portfolio before change:  [-8.75129899]
curr_Stock_Price:  103.95503989774738
curr_Factors:  [103.9550399]
mat_Sqrt:  [[0.15]]
grads:  [0.0281716]
Stock Position:  0.028171599510155115
Bond Position:  [-11.67987874]


portfolio before change:  [-8.75180799]
curr_Stock_Price:  103.98879998183315
curr_Factors:  [103.98879998]
mat_Sqrt:  [[0.15]]
grads:  [0.02273453]
Stock Position:  0.02273452847370269
Bond Position:  [-11.11594433]


portfolio before change:  [-8.75661213]
curr_Stock_Price:  103.83860715533748
curr_Factors:  [103.83860716]
mat_Sqrt:  [[0.15]]
grads:  [0.06083854]
Stock Position:  0.06083854313365087
Bond Position:  [-15.07400171]


portfolio before change:  [-8.79336095]
curr_Stock_Price:  103.26554195237007
curr_Factors:  [103.26554195]
mat_Sqrt:  [[0.15]]
grads:  [0.06186058]
Stock Position:  0.061860578677240936
Bond Position:  [-15.18142714]


portfolio before change:  [-8.77448024]
curr_Stock_Price:  103.60143456361756
curr_Factors:  [103.60143456]
mat_Sqrt:  [[0.15]]
grads:  [0.07870292]
Stock Position:  0.07870292443833768
Bond Position:  [-16.92821612]


portfolio before change:  [-8.82409285]
curr_Stock_Price:  102.99794427731393
curr_Factors:  [102.99794428]
mat_Sqrt:  [[0.15]]
grads:  [-0.1008954]
Stock Position:  -0.10089540391303617
Bond Position:  [1.56792634]


portfolio before change:  [-8.80837645]
curr_Stock_Price:  102.84411766722779
curr_Factors:  [102.84411767]
mat_Sqrt:  [[0.15]]
grads:  [-0.00634384]
Stock Position:  -0.006343836022243676
Bond Position:  [-8.15595023]


portfolio before change:  [-8.81125961]
curr_Stock_Price:  103.13788399538106
curr_Factors:  [103.137884]
mat_Sqrt:  [[0.15]]
grads:  [0.19051379]
Stock Position:  0.19051379406248173
Bond Position:  [-28.4604492]


portfolio before change:  [-8.77485727]
curr_Stock_Price:  103.34763319246298
curr_Factors:  [103.34763319]
mat_Sqrt:  [[0.15]]
grads:  [-0.26050938]
Stock Position:  -0.260509380971459
Bond Position:  [18.14817067]


portfolio before change:  [-8.75518077]
curr_Stock_Price:  103.28081086086594
curr_Factors:  [103.28081086]
mat_Sqrt:  [[0.15]]
grads:  [0.04489754]
Stock Position:  0.0448975422064967
Bond Position:  [-13.39223533]


portfolio before change:  [-8.7169993]
curr_Stock_Price:  104.16851205962635
curr_Factors:  [104.16851206]
mat_Sqrt:  [[0.15]]
grads:  [0.04880703]
Stock Position:  0.048807028344687205
Bond Position:  [-13.80115482]


portfolio before change:  [-8.69181791]
curr_Stock_Price:  104.719798192854
curr_Factors:  [104.71979819]
mat_Sqrt:  [[0.15]]
grads:  [-0.10310863]
Stock Position:  -0.10310863019115209
Bond Position:  [2.10569703]


portfolio before change:  [-8.78575586]
curr_Stock_Price:  105.63340915965556
curr_Factors:  [105.63340916]
mat_Sqrt:  [[0.15]]
grads:  [-0.00072801]
Stock Position:  -0.0007280066072549678
Bond Position:  [-8.70885404]


portfolio before change:  [-8.78683657]
curr_Stock_Price:  105.62246730467278
curr_Factors:  [105.6224673]
mat_Sqrt:  [[0.15]]
grads:  [-0.07890952]
Stock Position:  -0.07890951824980598
Bond Position:  [-0.45221856]


portfolio before change:  [-8.77505533]
curr_Stock_Price:  105.47245034280962
curr_Factors:  [105.47245034]
mat_Sqrt:  [[0.15]]
grads:  [0.40820992]
Stock Position:  0.4082099205069062
Bond Position:  [-51.8299559]


portfolio before change:  [-8.78981735]
curr_Stock_Price:  105.45215963776545
curr_Factors:  [105.45215964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011315]
Stock Position:  -0.020113152305216816
Bond Position:  [-6.668842]


portfolio before change:  [-8.79566692]
curr_Stock_Price:  105.70154456492105
curr_Factors:  [105.70154456]
mat_Sqrt:  [[0.15]]
grads:  [-0.06143972]
Stock Position:  -0.061439723819541096
Bond Position:  [-2.30139322]


portfolio before change:  [-8.81342048]
curr_Stock_Price:  105.98582089807314
curr_Factors:  [105.9858209]
mat_Sqrt:  [[0.15]]
grads:  [0.02900899]
Stock Position:  0.02900899417631635
Bond Position:  [-11.88796254]


portfolio before change:  [-8.81895848]
curr_Stock_Price:  105.8461428237108
curr_Factors:  [105.84614282]
mat_Sqrt:  [[0.15]]
grads:  [0.03958507]
Stock Position:  0.03958506580988528
Bond Position:  [-13.00888501]


portfolio before change:  [-8.84246323]
curr_Stock_Price:  105.2934462373085
curr_Factors:  [105.29344624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01217804]
Stock Position:  -0.01217804182347433
Bond Position:  [-7.56019524]


portfolio before change:  [-8.84480949]
curr_Stock_Price:  105.4085042707315
curr_Factors:  [105.40850427]
mat_Sqrt:  [[0.15]]
grads:  [0.04907251]
Stock Position:  0.04907250975098044
Bond Position:  [-14.01746935]


portfolio before change:  [-8.89547342]
curr_Stock_Price:  104.4117826427251
curr_Factors:  [104.41178264]
mat_Sqrt:  [[0.15]]
grads:  [0.03178365]
Stock Position:  0.03178364930380473
Bond Position:  [-12.2140609]


portfolio before change:  [-8.92069676]
curr_Stock_Price:  103.66622663149613
curr_Factors:  [103.66622663]
mat_Sqrt:  [[0.15]]
grads:  [-0.06754021]
Stock Position:  -0.06754020670321431
Bond Position:  [-1.91905839]


portfolio before change:  [-8.98869757]
curr_Stock_Price:  104.6694944409191
curr_Factors:  [104.66949444]
mat_Sqrt:  [[0.15]]
grads:  [0.06707433]
Stock Position:  0.06707433058746996
Bond Position:  [-16.00933385]


portfolio before change:  [-9.02238467]
curr_Stock_Price:  104.1970960836528
curr_Factors:  [104.19709608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.02238467]
Stock Price:  103.17838250488569
PL:  [-12.20076717]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.14980237e-03]
 [ 2.07206738e-03]
 [ 1.52277952e-02]
 [ 7.51229940e-03]
 [ 1.38554084e-02]
 [ 2.81714662e-02]
 [ 2.21961485e-02]
 [ 4.57184558e-03]
 [-1.11809034e-02]
 [-1.74139618e-03]
 [ 2.50634148e-02]
 [ 8.56184243e-03]
 [ 2.42006585e-03]
 [-4.33876036e-03]
 [ 2.34867016e-02]
 [ 2.54841111e-03]
 [ 9.01303245e-03]
 [ 9.58864228e-03]
 [ 1.17968319e-02]
 [-1.60776352e-02]
 [ 2.78857583e-03]
 [ 2.69274417e-02]
 [-3.13348428e-02]
 [ 4.63757411e-03]
 [-7.66484312e-04]
 [-8.94867569e-03]
 [-1.05774563e-03]
 [-1.10412100e-02]
 [-1.73548483e-03]
 [-1.08797855e-02]
 [-1.21605005e-03]
 [ 5.15297414e-03]
 [ 5.10766781e-03]
 [-6.66362875e-03]
 [ 1.58257001e-02]
 [ 5.46529786e-03]
 [-1.97891306e-04]
 [ 7.82543416e-03]
 [-1.07452916e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.2398903]
curr_Stock_Price:  99.95404858955106
curr_Factors:  [99.95404859]
mat_Sqrt:  [[0.15]]
grads:  [0.02099868]
Stock Position:  0.020998682479951465
Bond Position:  [-0.85901302]


portfolio before change:  [1.26099611]
curr_Stock_Price:  100.96426383188599
curr_Factors:  [100.96426383]
mat_Sqrt:  [[0.15]]
grads:  [0.01381378]
Stock Position:  0.013813782542271015
Bond Position:  [-0.13370228]


portfolio before change:  [1.26885165]
curr_Stock_Price:  101.53414790185155
curr_Factors:  [101.5341479]
mat_Sqrt:  [[0.15]]
grads:  [0.10151863]
Stock Position:  0.10151863453649225
Bond Position:  [-9.0387564]


portfolio before change:  [1.30840673]
curr_Stock_Price:  101.93491173895073
curr_Factors:  [101.93491174]
mat_Sqrt:  [[0.15]]
grads:  [0.050082]
Stock Position:  0.05008199600377527
Bond Position:  [-3.79669711]


portfolio before change:  [1.29583975]
curr_Stock_Price:  101.69346037838694
curr_Factors:  [101.69346038]
mat_Sqrt:  [[0.15]]
grads:  [0.09236939]
Stock Position:  0.09236938901077922
Bond Position:  [-8.09752305]


portfolio before change:  [1.33676957]
curr_Stock_Price:  102.14752938192935
curr_Factors:  [102.14752938]
mat_Sqrt:  [[0.15]]
grads:  [0.18780977]
Stock Position:  0.1878097745401117
Bond Position:  [-17.84753489]


portfolio before change:  [1.43522424]
curr_Stock_Price:  102.68363432354037
curr_Factors:  [102.68363432]
mat_Sqrt:  [[0.15]]
grads:  [0.14797432]
Stock Position:  0.14797432300062718
Bond Position:  [-13.75931703]


portfolio before change:  [1.48282906]
curr_Stock_Price:  103.01696811869573
curr_Factors:  [103.01696812]
mat_Sqrt:  [[0.15]]
grads:  [0.03047897]
Stock Position:  0.03047897053847985
Bond Position:  [-1.65702208]


portfolio before change:  [1.50187899]
curr_Stock_Price:  103.64878300816622
curr_Factors:  [103.64878301]
mat_Sqrt:  [[0.15]]
grads:  [-0.07453936]
Stock Position:  -0.07453935578281726
Bond Position:  [9.2277925]


portfolio before change:  [1.45957342]
curr_Stock_Price:  104.231818798944
curr_Factors:  [104.2318188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01160931]
Stock Position:  -0.011609307850007251
Bond Position:  [2.66963269]


portfolio before change:  [1.45717556]
curr_Stock_Price:  104.46711184604709
curr_Factors:  [104.46711185]
mat_Sqrt:  [[0.15]]
grads:  [0.16708943]
Stock Position:  0.1670894321807802
Bond Position:  [-15.99817484]


portfolio before change:  [1.36200164]
curr_Stock_Price:  103.90948218818971
curr_Factors:  [103.90948219]
mat_Sqrt:  [[0.15]]
grads:  [0.05707895]
Stock Position:  0.05707894951636576
Bond Position:  [-4.56904245]


portfolio before change:  [1.36600819]
curr_Stock_Price:  103.98968189386449
curr_Factors:  [103.98968189]
mat_Sqrt:  [[0.15]]
grads:  [0.01613377]
Stock Position:  0.016133772318101074
Bond Position:  [-0.31173767]


portfolio before change:  [1.35378355]
curr_Stock_Price:  103.23439253486639
curr_Factors:  [103.23439253]
mat_Sqrt:  [[0.15]]
grads:  [-0.02892507]
Stock Position:  -0.02892506909359077
Bond Position:  [4.33984549]


portfolio before change:  [1.40727343]
curr_Stock_Price:  101.4038916233118
curr_Factors:  [101.40389162]
mat_Sqrt:  [[0.15]]
grads:  [0.15657801]
Stock Position:  0.15657801071421237
Bond Position:  [-14.4703462]


portfolio before change:  [1.66162213]
curr_Stock_Price:  103.03986597480066
curr_Factors:  [103.03986597]
mat_Sqrt:  [[0.15]]
grads:  [0.01698941]
Stock Position:  0.016989407373891933
Bond Position:  [-0.08896413]


portfolio before change:  [1.66112339]
curr_Stock_Price:  103.0111641836114
curr_Factors:  [103.01116418]
mat_Sqrt:  [[0.15]]
grads:  [0.06008688]
Stock Position:  0.06008688302743804
Bond Position:  [-4.52849639]


portfolio before change:  [1.67350285]
curr_Stock_Price:  103.22661165906358
curr_Factors:  [103.22661166]
mat_Sqrt:  [[0.15]]
grads:  [0.06392428]
Stock Position:  0.06392428189730541
Bond Position:  [-4.92518417]


portfolio before change:  [1.69464479]
curr_Stock_Price:  103.5669772210461
curr_Factors:  [103.56697722]
mat_Sqrt:  [[0.15]]
grads:  [0.07864555]
Stock Position:  0.0786455458444266
Bond Position:  [-6.45043666]


portfolio before change:  [1.71920811]
curr_Stock_Price:  103.88955969452172
curr_Factors:  [103.88955969]
mat_Sqrt:  [[0.15]]
grads:  [-0.10718423]
Stock Position:  -0.10718423479930728
Bond Position:  [12.85453107]


portfolio before change:  [1.76856045]
curr_Stock_Price:  103.4441077892466
curr_Factors:  [103.44410779]
mat_Sqrt:  [[0.15]]
grads:  [0.01859051]
Stock Position:  0.01859050553604825
Bond Position:  [-0.15451781]


portfolio before change:  [1.75755396]
curr_Stock_Price:  102.85309787776193
curr_Factors:  [102.85309788]
mat_Sqrt:  [[0.15]]
grads:  [0.17951628]
Stock Position:  0.1795162778550823
Bond Position:  [-16.70625134]


portfolio before change:  [1.62324451]
curr_Stock_Price:  102.11655720389194
curr_Factors:  [102.1165572]
mat_Sqrt:  [[0.15]]
grads:  [-0.20889895]
Stock Position:  -0.20889895168999492
Bond Position:  [22.95528626]


portfolio before change:  [1.674213]
curr_Stock_Price:  101.88630762591475
curr_Factors:  [101.88630763]
mat_Sqrt:  [[0.15]]
grads:  [0.03091716]
Stock Position:  0.030917160732832138
Bond Position:  [-1.47582235]


portfolio before change:  [1.70045616]
curr_Stock_Price:  102.74109666235971
curr_Factors:  [102.74109666]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051099]
Stock Position:  -0.005109895411605723
Bond Position:  [2.22545241]


portfolio before change:  [1.69875887]
curr_Stock_Price:  103.12769668357156
curr_Factors:  [103.12769668]
mat_Sqrt:  [[0.15]]
grads:  [-0.05965784]
Stock Position:  -0.059657837935563576
Bond Position:  [7.85113428]


portfolio before change:  [1.75115815]
curr_Stock_Price:  102.26581778408384
curr_Factors:  [102.26581778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00705164]
Stock Position:  -0.007051637548549328
Bond Position:  [2.47229963]


portfolio before change:  [1.7504582]
curr_Stock_Price:  102.40890607309557
curr_Factors:  [102.40890607]
mat_Sqrt:  [[0.15]]
grads:  [-0.07360807]
Stock Position:  -0.07360806687388509
Bond Position:  [9.28857981]


portfolio before change:  [1.81115728]
curr_Stock_Price:  101.60005542045215
curr_Factors:  [101.60005542]
mat_Sqrt:  [[0.15]]
grads:  [-0.0115699]
Stock Position:  -0.01156989889453579
Bond Position:  [2.98665965]


portfolio before change:  [1.80815412]
curr_Stock_Price:  101.89189170679938
curr_Factors:  [101.89189171]
mat_Sqrt:  [[0.15]]
grads:  [-0.0725319]
Stock Position:  -0.07253190322806316
Bond Position:  [9.19856695]


portfolio before change:  [1.86135247]
curr_Stock_Price:  101.17429772367258
curr_Factors:  [101.17429772]
mat_Sqrt:  [[0.15]]
grads:  [-0.008107]
Stock Position:  -0.008107000358741942
Bond Position:  [2.68157254]


portfolio before change:  [1.85642672]
curr_Stock_Price:  101.82323870168477
curr_Factors:  [101.8232387]
mat_Sqrt:  [[0.15]]
grads:  [0.03435316]
Stock Position:  0.03435316092792892
Bond Position:  [-1.64152338]


portfolio before change:  [1.87389198]
curr_Stock_Price:  102.33761533198486
curr_Factors:  [102.33761533]
mat_Sqrt:  [[0.15]]
grads:  [0.03405112]
Stock Position:  0.034051118708847486
Bond Position:  [-1.6108183]


portfolio before change:  [1.85254353]
curr_Stock_Price:  101.71657595883792
curr_Factors:  [101.71657596]
mat_Sqrt:  [[0.15]]
grads:  [-0.04442419]
Stock Position:  -0.044424191691803665
Bond Position:  [6.3712202]


portfolio before change:  [1.82576272]
curr_Stock_Price:  102.33734735147983
curr_Factors:  [102.33734735]
mat_Sqrt:  [[0.15]]
grads:  [0.10550467]
Stock Position:  0.1055046675671006
Bond Position:  [-8.97130509]


portfolio before change:  [1.80671501]
curr_Stock_Price:  102.16743806337028
curr_Factors:  [102.16743806]
mat_Sqrt:  [[0.15]]
grads:  [0.03643532]
Stock Position:  0.03643531908385224
Bond Position:  [-1.91578819]


portfolio before change:  [1.79478466]
curr_Stock_Price:  101.846571868174
curr_Factors:  [101.84657187]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131928]
Stock Position:  -0.0013192753714377492
Bond Position:  [1.92914834]


portfolio before change:  [1.79585434]
curr_Stock_Price:  101.21856363668205
curr_Factors:  [101.21856364]
mat_Sqrt:  [[0.15]]
grads:  [0.05216956]
Stock Position:  0.052169561095795694
Bond Position:  [-3.4846737]


portfolio before change:  [1.78213918]
curr_Stock_Price:  100.96401782161153
curr_Factors:  [100.96401782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.78213918]
Stock Price:  102.71028558329364
PL:  [-0.9281464]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.15771386e-03]
 [-5.59922619e-03]
 [ 6.48288224e-03]
 [-2.32348399e-03]
 [ 1.12709392e-02]
 [-1.80184803e-02]
 [-4.72930632e-02]
 [ 2.11990153e-02]
 [-5.88757212e-03]
 [ 2.81876081e-03]
 [ 1.09303934e-02]
 [ 4.72768582e-03]
 [ 1.10774190e-02]
 [-5.19342647e-03]
 [ 7.09033501e-03]
 [ 3.22116776e-03]
 [ 9.11191597e-03]
 [ 1.04655890e-02]
 [ 1.15529573e-02]
 [-1.46968985e-02]
 [ 2.84859645e-03]
 [ 2.64673409e-02]
 [-3.44209446e-02]
 [ 7.82450647e-03]
 [ 7.49837468e-03]
 [-1.91115694e-02]
 [-3.06949840e-04]
 [-1.07018701e-02]
 [ 5.96523753e-02]
 [-4.10309193e-03]
 [-3.61968381e-03]
 [ 4.75649932e-03]
 [ 5.65903148e-03]
 [-2.38645014e-03]
 [ 7.14361399e-03]
 [ 4.47568319e-03]
 [-2.65624818e-02]
 [ 9.84007937e-03]
 [-7.54399963e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.58039305]
curr_Stock_Price:  100.04052357574366
curr_Factors:  [100.04052358]
mat_Sqrt:  [[0.15]]
grads:  [0.02771809]
Stock Position:  0.02771809238490869
Bond Position:  [-0.19253943]


portfolio before change:  [2.55671194]
curr_Stock_Price:  99.18703637229214
curr_Factors:  [99.18703637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03732817]
Stock Position:  -0.03732817457573827
Bond Position:  [6.25918295]


portfolio before change:  [2.53286768]
curr_Stock_Price:  99.8467715454357
curr_Factors:  [99.84677155]
mat_Sqrt:  [[0.15]]
grads:  [0.04321921]
Stock Position:  0.0432192149314424
Bond Position:  [-1.7824314]


portfolio before change:  [2.52448764]
curr_Stock_Price:  99.65803101470584
curr_Factors:  [99.65803101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548989]
Stock Position:  -0.015489893266423412
Bond Position:  [4.0681799]


portfolio before change:  [2.52838063]
curr_Stock_Price:  99.43953797323303
curr_Factors:  [99.43953797]
mat_Sqrt:  [[0.15]]
grads:  [0.07513959]
Stock Position:  0.07513959443471802
Bond Position:  [-4.94346592]


portfolio before change:  [2.47715817]
curr_Stock_Price:  98.7660649590449
curr_Factors:  [98.76606496]
mat_Sqrt:  [[0.15]]
grads:  [-0.1201232]
Stock Position:  -0.12012320192855905
Bond Position:  [14.34125413]


portfolio before change:  [2.51246368]
curr_Stock_Price:  98.48707855114176
curr_Factors:  [98.48707855]
mat_Sqrt:  [[0.15]]
grads:  [-0.31528709]
Stock Position:  -0.3152870877545488
Bond Position:  [33.56416786]


portfolio before change:  [2.5091407]
curr_Stock_Price:  98.51092588806077
curr_Factors:  [98.51092589]
mat_Sqrt:  [[0.15]]
grads:  [0.14132677]
Stock Position:  0.1413267684855182
Bond Position:  [-11.41309011]


portfolio before change:  [2.66389474]
curr_Stock_Price:  99.6160297773106
curr_Factors:  [99.61602978]
mat_Sqrt:  [[0.15]]
grads:  [-0.03925048]
Stock Position:  -0.03925048082116292
Bond Position:  [6.57387181]


portfolio before change:  [2.65223157]
curr_Stock_Price:  99.93411399016209
curr_Factors:  [99.93411399]
mat_Sqrt:  [[0.15]]
grads:  [0.01879174]
Stock Position:  0.018791738724351296
Bond Position:  [0.77429581]


portfolio before change:  [2.68779454]
curr_Stock_Price:  101.8214424633849
curr_Factors:  [101.82144246]
mat_Sqrt:  [[0.15]]
grads:  [0.07286929]
Stock Position:  0.07286928936114608
Bond Position:  [-4.73186161]


portfolio before change:  [2.65051608]
curr_Stock_Price:  101.31798015306703
curr_Factors:  [101.31798015]
mat_Sqrt:  [[0.15]]
grads:  [0.03151791]
Stock Position:  0.03151790546441366
Bond Position:  [-0.54281444]


portfolio before change:  [2.64929929]
curr_Stock_Price:  101.28152663664955
curr_Factors:  [101.28152664]
mat_Sqrt:  [[0.15]]
grads:  [0.07384946]
Stock Position:  0.07384946004726221
Bond Position:  [-4.83028677]


portfolio before change:  [2.71316175]
curr_Stock_Price:  102.15446850096096
curr_Factors:  [102.1544685]
mat_Sqrt:  [[0.15]]
grads:  [-0.03462284]
Stock Position:  -0.03462284311069629
Bond Position:  [6.25003989]


portfolio before change:  [2.67613453]
curr_Stock_Price:  103.24647943535693
curr_Factors:  [103.24647944]
mat_Sqrt:  [[0.15]]
grads:  [0.0472689]
Stock Position:  0.04726890005912426
Bond Position:  [-2.20421299]


portfolio before change:  [2.70110961]
curr_Stock_Price:  103.78067039691413
curr_Factors:  [103.7806704]
mat_Sqrt:  [[0.15]]
grads:  [0.02147445]
Stock Position:  0.021474451733959333
Bond Position:  [0.47247661]


portfolio before change:  [2.69278533]
curr_Stock_Price:  103.39028364422884
curr_Factors:  [103.39028364]
mat_Sqrt:  [[0.15]]
grads:  [0.06074611]
Stock Position:  0.06074610644463532
Bond Position:  [-3.58777185]


portfolio before change:  [2.65705927]
curr_Stock_Price:  102.80954581762678
curr_Factors:  [102.80954582]
mat_Sqrt:  [[0.15]]
grads:  [0.06977059]
Stock Position:  0.0697705935776218
Bond Position:  [-4.51602377]


portfolio before change:  [2.6412204]
curr_Stock_Price:  102.59062362703371
curr_Factors:  [102.59062363]
mat_Sqrt:  [[0.15]]
grads:  [0.07701972]
Stock Position:  0.0770197154058733
Bond Position:  [-5.26028024]


portfolio before change:  [2.64202487]
curr_Stock_Price:  102.6096063631901
curr_Factors:  [102.60960636]
mat_Sqrt:  [[0.15]]
grads:  [-0.09797932]
Stock Position:  -0.09797932308269823
Bond Position:  [12.69564464]


portfolio before change:  [2.5606358]
curr_Stock_Price:  103.45648011377183
curr_Factors:  [103.45648011]
mat_Sqrt:  [[0.15]]
grads:  [0.01899064]
Stock Position:  0.01899064302248718
Bond Position:  [0.59593072]


portfolio before change:  [2.54774325]
curr_Stock_Price:  102.77366763529338
curr_Factors:  [102.77366764]
mat_Sqrt:  [[0.15]]
grads:  [0.17644894]
Stock Position:  0.17644893950934804
Bond Position:  [-15.58656141]


portfolio before change:  [2.69283677]
curr_Stock_Price:  103.60700764441049
curr_Factors:  [103.60700764]
mat_Sqrt:  [[0.15]]
grads:  [-0.22947296]
Stock Position:  -0.22947296385133492
Bond Position:  [26.46784389]


portfolio before change:  [2.59498994]
curr_Stock_Price:  104.04782434519163
curr_Factors:  [104.04782435]
mat_Sqrt:  [[0.15]]
grads:  [0.05216338]
Stock Position:  0.05216337644172002
Bond Position:  [-2.83249589]


portfolio before change:  [2.64991957]
curr_Stock_Price:  105.10764287239297
curr_Factors:  [105.10764287]
mat_Sqrt:  [[0.15]]
grads:  [0.04998916]
Stock Position:  0.049989164505544706
Bond Position:  [-2.60432368]


portfolio before change:  [2.67471909]
curr_Stock_Price:  105.61025339601323
curr_Factors:  [105.6102534]
mat_Sqrt:  [[0.15]]
grads:  [-0.12741046]
Stock Position:  -0.12741046259304323
Bond Position:  [16.13057033]


portfolio before change:  [2.74784097]
curr_Stock_Price:  105.05217182370654
curr_Factors:  [105.05217182]
mat_Sqrt:  [[0.15]]
grads:  [-0.00204633]
Stock Position:  -0.002046332264040283
Bond Position:  [2.96281262]


portfolio before change:  [2.75008958]
curr_Stock_Price:  104.13431655603529
curr_Factors:  [104.13431656]
mat_Sqrt:  [[0.15]]
grads:  [-0.0713458]
Stock Position:  -0.07134580087793252
Bond Position:  [10.17963579]


portfolio before change:  [2.67794103]
curr_Stock_Price:  105.16340430295509
curr_Factors:  [105.1634043]
mat_Sqrt:  [[0.15]]
grads:  [0.3976825]
Stock Position:  0.39768250208576406
Bond Position:  [-39.14370473]


portfolio before change:  [2.59821859]
curr_Stock_Price:  104.97524121901067
curr_Factors:  [104.97524122]
mat_Sqrt:  [[0.15]]
grads:  [-0.02735395]
Stock Position:  -0.027353946183365573
Bond Position:  [5.46970569]


portfolio before change:  [2.64193041]
curr_Stock_Price:  103.4022300092037
curr_Factors:  [103.40223001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413123]
Stock Position:  -0.024131225410250683
Bond Position:  [5.13715293]


portfolio before change:  [2.62903665]
curr_Stock_Price:  103.96316061113066
curr_Factors:  [103.96316061]
mat_Sqrt:  [[0.15]]
grads:  [0.03171]
Stock Position:  0.03170999547860194
Bond Position:  [-0.6676347]


portfolio before change:  [2.63531396]
curr_Stock_Price:  104.16375249578785
curr_Factors:  [104.1637525]
mat_Sqrt:  [[0.15]]
grads:  [0.03772688]
Stock Position:  0.03772687651239092
Bond Position:  [-1.29445907]


portfolio before change:  [2.66805075]
curr_Stock_Price:  105.03577299026007
curr_Factors:  [105.03577299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01590967]
Stock Position:  -0.015909667631463533
Bond Position:  [4.33913499]


portfolio before change:  [2.66910331]
curr_Stock_Price:  105.00370896192223
curr_Factors:  [105.00370896]
mat_Sqrt:  [[0.15]]
grads:  [0.04762409]
Stock Position:  0.04762409325145988
Bond Position:  [-2.33160312]


portfolio before change:  [2.67693809]
curr_Stock_Price:  105.17434225895246
curr_Factors:  [105.17434226]
mat_Sqrt:  [[0.15]]
grads:  [0.02983789]
Stock Position:  0.029837887962926257
Bond Position:  [-0.46124215]


portfolio before change:  [2.67720018]
curr_Stock_Price:  105.18505837011737
curr_Factors:  [105.18505837]
mat_Sqrt:  [[0.15]]
grads:  [-0.17708321]
Stock Position:  -0.1770832121355635
Bond Position:  [21.30370819]


portfolio before change:  [2.58672152]
curr_Stock_Price:  105.71103590562257
curr_Factors:  [105.71103591]
mat_Sqrt:  [[0.15]]
grads:  [0.06560053]
Stock Position:  0.06560052913120445
Bond Position:  [-4.34797837]


portfolio before change:  [2.62909559]
curr_Stock_Price:  106.36526231049382
curr_Factors:  [106.36526231]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.62909559]
Stock Price:  106.77675254114797
PL:  [-4.14765695]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.48024685e-03]
 [ 3.17736172e-04]
 [-8.01743248e-03]
 [-2.83247497e-03]
 [ 1.53582963e-02]
 [ 2.72383195e-02]
 [-6.21991683e-03]
 [ 2.15676747e-02]
 [-5.88836607e-03]
 [ 2.42519159e-03]
 [ 6.34087086e-03]
 [ 4.09209045e-03]
 [ 1.18420884e-02]
 [-4.78402291e-03]
 [ 1.98360865e-02]
 [ 1.87291772e-03]
 [ 8.72451112e-03]
 [ 1.18360895e-02]
 [ 1.16647902e-02]
 [-1.37046552e-02]
 [-1.72281201e-02]
 [ 1.84583051e-02]
 [ 1.25174804e-02]
 [ 6.18811413e-03]
 [-5.51866507e-03]
 [-6.89163885e-03]
 [ 1.14032413e-04]
 [-1.11703440e-02]
 [-1.85566163e-02]
 [-8.29767385e-03]
 [-2.78427621e-03]
 [ 5.33973228e-03]
 [ 5.26360313e-03]
 [-1.18713317e-02]
 [ 9.78301470e-03]
 [ 5.71343750e-03]
 [ 3.56110756e-03]
 [ 9.71882455e-03]
 [-1.94546809e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.25180787]
curr_Stock_Price:  99.212726389876
curr_Factors:  [99.21272639]
mat_Sqrt:  [[0.15]]
grads:  [0.04320165]
Stock Position:  0.043201645640334234
Bond Position:  [-14.53796092]


portfolio before change:  [-10.23627763]
curr_Stock_Price:  99.61427605372052
curr_Factors:  [99.61427605]
mat_Sqrt:  [[0.15]]
grads:  [0.00211824]
Stock Position:  0.00211824114442685
Bond Position:  [-10.44728468]


portfolio before change:  [-10.23905721]
curr_Stock_Price:  98.91860672459246
curr_Factors:  [98.91860672]
mat_Sqrt:  [[0.15]]
grads:  [-0.05344955]
Stock Position:  -0.05344954986450337
Bond Position:  [-4.95190221]


portfolio before change:  [-10.31107152]
curr_Stock_Price:  100.25435750174441
curr_Factors:  [100.2543575]
mat_Sqrt:  [[0.15]]
grads:  [-0.01888317]
Stock Position:  -0.018883166436379804
Bond Position:  [-8.4179518]


portfolio before change:  [-10.31789337]
curr_Stock_Price:  100.55989632907105
curr_Factors:  [100.55989633]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-20.6140846]


portfolio before change:  [-10.17966823]
curr_Stock_Price:  101.93506895805932
curr_Factors:  [101.93506896]
mat_Sqrt:  [[0.15]]
grads:  [0.1815888]
Stock Position:  0.18158879647741247
Bond Position:  [-28.68993472]


portfolio before change:  [-10.32921663]
curr_Stock_Price:  101.13126420373419
curr_Factors:  [101.1312642]
mat_Sqrt:  [[0.15]]
grads:  [-0.04146611]
Stock Position:  -0.041466112188479946
Bond Position:  [-6.13569629]


portfolio before change:  [-10.28572738]
curr_Stock_Price:  100.06397668422468
curr_Factors:  [100.06397668]
mat_Sqrt:  [[0.15]]
grads:  [0.1437845]
Stock Position:  0.14378449776691837
Bond Position:  [-24.67337601]


portfolio before change:  [-10.3528356]
curr_Stock_Price:  99.61870022568081
curr_Factors:  [99.61870023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03925577]
Stock Position:  -0.03925577382378373
Bond Position:  [-6.44222643]


portfolio before change:  [-10.36860207]
curr_Stock_Price:  99.99981990475166
curr_Factors:  [99.9998199]
mat_Sqrt:  [[0.15]]
grads:  [0.01616794]
Stock Position:  0.01616794393057747
Bond Position:  [-11.98539356]


portfolio before change:  [-10.37123496]
curr_Stock_Price:  99.92964292148055
curr_Factors:  [99.92964292]
mat_Sqrt:  [[0.15]]
grads:  [0.04227247]
Stock Position:  0.04227247238482965
Bond Position:  [-14.59550803]


portfolio before change:  [-10.36656397]
curr_Stock_Price:  100.08330179466955
curr_Factors:  [100.08330179]
mat_Sqrt:  [[0.15]]
grads:  [0.0272806]
Stock Position:  0.027280603023244285
Bond Position:  [-13.0968968]


portfolio before change:  [-10.34206952]
curr_Stock_Price:  101.04118611598707
curr_Factors:  [101.04118612]
mat_Sqrt:  [[0.15]]
grads:  [0.07894726]
Stock Position:  0.07894725590039516
Bond Position:  [-18.3189939]


portfolio before change:  [-10.30690458]
curr_Stock_Price:  101.51561633377206
curr_Factors:  [101.51561633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189349]
Stock Position:  -0.031893486066648095
Bond Position:  [-7.06921768]


portfolio before change:  [-10.31475703]
curr_Stock_Price:  101.73411696437363
curr_Factors:  [101.73411696]
mat_Sqrt:  [[0.15]]
grads:  [0.13224058]
Stock Position:  0.13224057687064467
Bond Position:  [-23.76813535]


portfolio before change:  [-10.32746125]
curr_Stock_Price:  101.66051614238334
curr_Factors:  [101.66051614]
mat_Sqrt:  [[0.15]]
grads:  [0.01248612]
Stock Position:  0.012486118143762052
Bond Position:  [-11.59680646]


portfolio before change:  [-10.32162842]
curr_Stock_Price:  102.24376559970993
curr_Factors:  [102.2437656]
mat_Sqrt:  [[0.15]]
grads:  [0.05816341]
Stock Position:  0.05816340747193263
Bond Position:  [-16.26847422]


portfolio before change:  [-10.33101545]
curr_Stock_Price:  102.11734001084127
curr_Factors:  [102.11734001]
mat_Sqrt:  [[0.15]]
grads:  [0.07890726]
Stock Position:  0.07890726358770538
Bond Position:  [-18.38881531]


portfolio before change:  [-10.39085741]
curr_Stock_Price:  101.38808887291243
curr_Factors:  [101.38808887]
mat_Sqrt:  [[0.15]]
grads:  [0.07776527]
Stock Position:  0.0777652681665407
Bond Position:  [-18.27532933]


portfolio before change:  [-10.37252936]
curr_Stock_Price:  101.65315065165888
curr_Factors:  [101.65315065]
mat_Sqrt:  [[0.15]]
grads:  [-0.09136437]
Stock Position:  -0.0913643679608186
Bond Position:  [-1.0850535]


portfolio before change:  [-10.28556766]
curr_Stock_Price:  100.69985404143962
curr_Factors:  [100.69985404]
mat_Sqrt:  [[0.15]]
grads:  [-0.11485413]
Stock Position:  -0.1148541339690923
Bond Position:  [1.28022686]


portfolio before change:  [-10.29824232]
curr_Stock_Price:  100.81160186159588
curr_Factors:  [100.81160186]
mat_Sqrt:  [[0.15]]
grads:  [0.12305537]
Stock Position:  0.12305536702245606
Bond Position:  [-22.70365099]


portfolio before change:  [-10.43017686]
curr_Stock_Price:  99.76250982082271
curr_Factors:  [99.76250982]
mat_Sqrt:  [[0.15]]
grads:  [0.08344987]
Stock Position:  0.08344986912166143
Bond Position:  [-18.75534525]


portfolio before change:  [-10.35739929]
curr_Stock_Price:  100.66271657357154
curr_Factors:  [100.66271657]
mat_Sqrt:  [[0.15]]
grads:  [0.04125409]
Stock Position:  0.041254094217064594
Bond Position:  [-14.51014849]


portfolio before change:  [-10.30026855]
curr_Stock_Price:  102.09153527560369
curr_Factors:  [102.09153528]
mat_Sqrt:  [[0.15]]
grads:  [-0.0367911]
Stock Position:  -0.03679110047458619
Bond Position:  [-6.54420862]


portfolio before change:  [-10.27204657]
curr_Stock_Price:  101.30221235096559
curr_Factors:  [101.30221235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594426]
Stock Position:  -0.04594425899839878
Bond Position:  [-5.61779149]


portfolio before change:  [-10.26840454]
curr_Stock_Price:  101.20765656696456
curr_Factors:  [101.20765657]
mat_Sqrt:  [[0.15]]
grads:  [0.00076022]
Stock Position:  0.0007602160840648937
Bond Position:  [-10.34534423]


portfolio before change:  [-10.26988637]
curr_Stock_Price:  100.95960110210187
curr_Factors:  [100.9596011]
mat_Sqrt:  [[0.15]]
grads:  [-0.07446896]
Stock Position:  -0.07446895984946403
Bond Position:  [-2.75152989]


portfolio before change:  [-10.2613942]
curr_Stock_Price:  100.84094588695295
curr_Factors:  [100.84094589]
mat_Sqrt:  [[0.15]]
grads:  [-0.12371078]
Stock Position:  -0.12371077526401056
Bond Position:  [2.21371739]


portfolio before change:  [-10.23379663]
curr_Stock_Price:  100.62010143424894
curr_Factors:  [100.62010143]
mat_Sqrt:  [[0.15]]
grads:  [-0.05531783]
Stock Position:  -0.05531782563447959
Bond Position:  [-4.6677114]


portfolio before change:  [-10.2042242]
curr_Stock_Price:  100.07496187637963
curr_Factors:  [100.07496188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01856184]
Stock Position:  -0.018561841378136292
Bond Position:  [-8.34664863]


portfolio before change:  [-10.20894145]
curr_Stock_Price:  100.27288707359477
curr_Factors:  [100.27288707]
mat_Sqrt:  [[0.15]]
grads:  [0.03559822]
Stock Position:  0.035598215196235475
Bond Position:  [-13.77847726]


portfolio before change:  [-10.21388939]
curr_Stock_Price:  100.18227800177533
curr_Factors:  [100.182278]
mat_Sqrt:  [[0.15]]
grads:  [0.03509069]
Stock Position:  0.035090687504882756
Bond Position:  [-13.7293544]


portfolio before change:  [-10.23566758]
curr_Stock_Price:  99.61056165120618
curr_Factors:  [99.61056165]
mat_Sqrt:  [[0.15]]
grads:  [-0.07914221]
Stock Position:  -0.0791422111502295
Bond Position:  [-2.35226748]


portfolio before change:  [-10.17893938]
curr_Stock_Price:  98.8900580219209
curr_Factors:  [98.89005802]
mat_Sqrt:  [[0.15]]
grads:  [0.0652201]
Stock Position:  0.06522009796805782
Bond Position:  [-16.62855866]


portfolio before change:  [-10.21902905]
curr_Stock_Price:  98.30724735146596
curr_Factors:  [98.30724735]
mat_Sqrt:  [[0.15]]
grads:  [0.03808958]
Stock Position:  0.03808958333015449
Bond Position:  [-13.96351114]


portfolio before change:  [-10.22740511]
curr_Stock_Price:  98.13317061568061
curr_Factors:  [98.13317062]
mat_Sqrt:  [[0.15]]
grads:  [0.02374072]
Stock Position:  0.023740717063279262
Bond Position:  [-12.55715695]


portfolio before change:  [-10.20803246]
curr_Stock_Price:  99.01530046216726
curr_Factors:  [99.01530046]
mat_Sqrt:  [[0.15]]
grads:  [0.06479216]
Stock Position:  0.06479216363948372
Bond Position:  [-16.62344801]


portfolio before change:  [-10.28416387]
curr_Stock_Price:  97.87236356454899
curr_Factors:  [97.87236356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.28416387]
Stock Price:  97.72252067554312
PL:  [-10.28416387]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.88092129e-03]
 [ 3.27277547e-03]
 [ 1.34784533e-02]
 [-2.68272512e-03]
 [ 1.24021473e-02]
 [ 1.91647099e-02]
 [-2.99536942e-03]
 [ 2.12740889e-02]
 [-5.93568886e-03]
 [ 3.00688200e-03]
 [ 5.74578229e-03]
 [ 7.15144425e-03]
 [ 1.38587934e-02]
 [ 2.44424660e-03]
 [ 1.02066680e-02]
 [-3.22628286e-03]
 [ 1.26214827e-02]
 [-1.03139956e-02]
 [ 6.08067587e-03]
 [-3.61299362e-03]
 [ 1.99361228e-02]
 [-7.41010772e-04]
 [ 1.93409434e-02]
 [ 4.65322941e-03]
 [ 1.65362731e-02]
 [-1.02377111e-02]
 [ 2.18206748e-02]
 [-2.01610848e-02]
 [-4.77134023e-02]
 [-2.43954149e-04]
 [-4.09395030e-03]
 [ 5.58998028e-03]
 [ 1.11419639e-02]
 [-1.27251639e-02]
 [ 5.52996509e-03]
 [ 5.71703598e-03]
 [ 2.45324283e-03]
 [ 9.16901315e-03]
 [-2.96551931e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.2628014]
curr_Stock_Price:  100.34258278450254
curr_Factors:  [100.34258278]
mat_Sqrt:  [[0.15]]
grads:  [0.04587281]
Stock Position:  0.045872808601709114
Bond Position:  [2.6598053]


portfolio before change:  [7.27915471]
curr_Stock_Price:  100.69182715152908
curr_Factors:  [100.69182715]
mat_Sqrt:  [[0.15]]
grads:  [0.0218185]
Stock Position:  0.02181850312345977
Bond Position:  [5.08220977]


portfolio before change:  [7.2844453]
curr_Stock_Price:  100.90519077663943
curr_Factors:  [100.90519078]
mat_Sqrt:  [[0.15]]
grads:  [0.08985636]
Stock Position:  0.08985635508662426
Bond Position:  [-1.78252735]


portfolio before change:  [7.24736305]
curr_Stock_Price:  100.49498690283285
curr_Factors:  [100.4949869]
mat_Sqrt:  [[0.15]]
grads:  [-0.01788483]
Stock Position:  -0.017884834152589905
Bond Position:  [9.04469922]


portfolio before change:  [7.26097332]
curr_Stock_Price:  99.79721068299946
curr_Factors:  [99.79721068]
mat_Sqrt:  [[0.15]]
grads:  [0.08268098]
Stock Position:  0.08268098207343076
Bond Position:  [-0.99035807]


portfolio before change:  [7.29339719]
curr_Stock_Price:  100.19086434989316
curr_Factors:  [100.19086435]
mat_Sqrt:  [[0.15]]
grads:  [0.12776473]
Stock Position:  0.1277647329655608
Bond Position:  [-5.50746184]


portfolio before change:  [7.27610396]
curr_Stock_Price:  100.06090083678467
curr_Factors:  [100.06090084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996913]
Stock Position:  -0.019969129492861774
Bond Position:  [9.27423305]


portfolio before change:  [7.27621728]
curr_Stock_Price:  100.11328338947506
curr_Factors:  [100.11328339]
mat_Sqrt:  [[0.15]]
grads:  [0.14182726]
Stock Position:  0.14182725962920606
Bond Position:  [-6.92257536]


portfolio before change:  [7.24478611]
curr_Stock_Price:  99.89776919932294
curr_Factors:  [99.8977692]
mat_Sqrt:  [[0.15]]
grads:  [-0.03957126]
Stock Position:  -0.03957125903775884
Bond Position:  [11.19786662]


portfolio before change:  [7.24584986]
curr_Stock_Price:  99.90626219435218
curr_Factors:  [99.90626219]
mat_Sqrt:  [[0.15]]
grads:  [0.02004588]
Stock Position:  0.020045879996369725
Bond Position:  [5.24314091]


portfolio before change:  [7.24546447]
curr_Stock_Price:  99.85434016530597
curr_Factors:  [99.85434017]
mat_Sqrt:  [[0.15]]
grads:  [0.03830522]
Stock Position:  0.0383052152801843
Bond Position:  [3.42052247]


portfolio before change:  [7.19042139]
curr_Stock_Price:  98.406217112321
curr_Factors:  [98.40621711]
mat_Sqrt:  [[0.15]]
grads:  [0.04767629]
Stock Position:  0.04767629499194213
Bond Position:  [2.49877756]


portfolio before change:  [7.20147409]
curr_Stock_Price:  98.63149318864095
curr_Factors:  [98.63149319]
mat_Sqrt:  [[0.15]]
grads:  [0.09239196]
Stock Position:  0.09239195600911351
Bond Position:  [-1.91128249]


portfolio before change:  [7.12358965]
curr_Stock_Price:  97.79110055819457
curr_Factors:  [97.79110056]
mat_Sqrt:  [[0.15]]
grads:  [0.01629498]
Stock Position:  0.01629497730809599
Bond Position:  [5.53008588]


portfolio before change:  [7.14640244]
curr_Stock_Price:  99.14866575580923
curr_Factors:  [99.14866576]
mat_Sqrt:  [[0.15]]
grads:  [0.06804445]
Stock Position:  0.06804445361508343
Bond Position:  [0.39988566]


portfolio before change:  [7.13892951]
curr_Stock_Price:  99.03810684436806
curr_Factors:  [99.03810684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02150855]
Stock Position:  -0.02150855239215333
Bond Position:  [9.26909582]


portfolio before change:  [7.14620812]
curr_Stock_Price:  98.7535733686568
curr_Factors:  [98.75357337]
mat_Sqrt:  [[0.15]]
grads:  [0.08414322]
Stock Position:  0.08414321793623883
Bond Position:  [-1.16323532]


portfolio before change:  [7.0227065]
curr_Stock_Price:  97.28754664233689
curr_Factors:  [97.28754664]
mat_Sqrt:  [[0.15]]
grads:  [-0.06875997]
Stock Position:  -0.06875997042308928
Bond Position:  [13.71219533]


portfolio before change:  [6.98939498]
curr_Stock_Price:  97.79693686246813
curr_Factors:  [97.79693686]
mat_Sqrt:  [[0.15]]
grads:  [0.04053784]
Stock Position:  0.040537839133892056
Bond Position:  [3.02491848]


portfolio before change:  [6.97590513]
curr_Stock_Price:  97.45483693055439
curr_Factors:  [97.45483693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02408662]
Stock Position:  -0.02408662412481853
Bond Position:  [9.32326315]


portfolio before change:  [6.98058166]
curr_Stock_Price:  97.3090691419237
curr_Factors:  [97.30906914]
mat_Sqrt:  [[0.15]]
grads:  [0.13290749]
Stock Position:  0.13290748560794985
Bond Position:  [-5.95252205]


portfolio before change:  [7.02998684]
curr_Stock_Price:  97.68639393855071
curr_Factors:  [97.68639394]
mat_Sqrt:  [[0.15]]
grads:  [-0.00494007]
Stock Position:  -0.004940071812142947
Bond Position:  [7.51256464]


portfolio before change:  [7.02828666]
curr_Stock_Price:  98.22065840296148
curr_Factors:  [98.2206584]
mat_Sqrt:  [[0.15]]
grads:  [0.12893962]
Stock Position:  0.12893962296835257
Bond Position:  [-5.636248]


portfolio before change:  [6.98210979]
curr_Stock_Price:  97.86799494787894
curr_Factors:  [97.86799495]
mat_Sqrt:  [[0.15]]
grads:  [0.03102153]
Stock Position:  0.031021529418158625
Bond Position:  [3.94609491]


portfolio before change:  [6.98525548]
curr_Stock_Price:  97.95349665585704
curr_Factors:  [97.95349666]
mat_Sqrt:  [[0.15]]
grads:  [0.11024182]
Stock Position:  0.11024182049553931
Bond Position:  [-3.81331631]


portfolio before change:  [6.89678133]
curr_Stock_Price:  97.1552745671074
curr_Factors:  [97.15527457]
mat_Sqrt:  [[0.15]]
grads:  [-0.06825141]
Stock Position:  -0.06825140704518165
Bond Position:  [13.52776552]


portfolio before change:  [6.95194485]
curr_Stock_Price:  96.37181169280315
curr_Factors:  [96.37181169]
mat_Sqrt:  [[0.15]]
grads:  [0.14547117]
Stock Position:  0.14547116560941015
Bond Position:  [-7.06737493]


portfolio before change:  [6.98232049]
curr_Stock_Price:  96.58669356136431
curr_Factors:  [96.58669356]
mat_Sqrt:  [[0.15]]
grads:  [-0.13440723]
Stock Position:  -0.13440723233305543
Bond Position:  [19.96427065]


portfolio before change:  [7.06258802]
curr_Stock_Price:  96.00806516687597
curr_Factors:  [96.00806517]
mat_Sqrt:  [[0.15]]
grads:  [-0.31808935]
Stock Position:  -0.3180893484938482
Bond Position:  [37.60173092]


portfolio before change:  [6.76919575]
curr_Stock_Price:  96.94520054509351
curr_Factors:  [96.94520055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162636]
Stock Position:  -0.0016263609919460117
Bond Position:  [6.92686364]


portfolio before change:  [6.77091935]
curr_Stock_Price:  96.41783209213037
curr_Factors:  [96.41783209]
mat_Sqrt:  [[0.15]]
grads:  [-0.027293]
Stock Position:  -0.027293001979506112
Bond Position:  [9.40245143]


portfolio before change:  [6.76816325]
curr_Stock_Price:  96.56187945944164
curr_Factors:  [96.56187946]
mat_Sqrt:  [[0.15]]
grads:  [0.03726654]
Stock Position:  0.037266535208636126
Bond Position:  [3.16963657]


portfolio before change:  [6.77049258]
curr_Stock_Price:  96.613751873571
curr_Factors:  [96.61375187]
mat_Sqrt:  [[0.15]]
grads:  [0.07427976]
Stock Position:  0.07427975953996395
Bond Position:  [-0.40595368]


portfolio before change:  [6.85761295]
curr_Stock_Price:  97.78730323586429
curr_Factors:  [97.78730324]
mat_Sqrt:  [[0.15]]
grads:  [-0.08483443]
Stock Position:  -0.08483442629458775
Bond Position:  [15.15334272]


portfolio before change:  [6.81360005]
curr_Stock_Price:  98.32844182640432
curr_Factors:  [98.32844183]
mat_Sqrt:  [[0.15]]
grads:  [0.03686643]
Stock Position:  0.03686643390326843
Bond Position:  [3.18858105]


portfolio before change:  [6.84970638]
curr_Stock_Price:  99.2970120435903
curr_Factors:  [99.29701204]
mat_Sqrt:  [[0.15]]
grads:  [0.03811357]
Stock Position:  0.03811357319806568
Bond Position:  [3.06514244]


portfolio before change:  [6.8731745]
curr_Stock_Price:  99.9027005084008
curr_Factors:  [99.90270051]
mat_Sqrt:  [[0.15]]
grads:  [0.01635495]
Stock Position:  0.016354952217157246
Bond Position:  [5.2392706]


portfolio before change:  [6.86468288]
curr_Stock_Price:  99.34344696429562
curr_Factors:  [99.34344696]
mat_Sqrt:  [[0.15]]
grads:  [0.06112675]
Stock Position:  0.06112675432549473
Bond Position:  [0.79214041]


portfolio before change:  [6.87238542]
curr_Stock_Price:  99.4678362367097
curr_Factors:  [99.46783624]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.87238542]
Stock Price:  100.00585772961983
PL:  [6.86652769]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.57658087e-03]
 [-5.96886474e-03]
 [ 1.00364842e-02]
 [ 1.00392424e-02]
 [ 1.53582963e-02]
 [ 2.64567145e-02]
 [ 1.37330528e-03]
 [ 1.66657489e-02]
 [-6.65148787e-03]
 [-1.04497031e-03]
 [ 1.03770348e-02]
 [ 4.68521254e-03]
 [ 9.83603640e-03]
 [-5.25062360e-03]
 [ 1.18870759e-02]
 [ 1.86140657e-03]
 [ 8.99140812e-03]
 [ 1.35816793e-02]
 [ 1.14944571e-02]
 [-1.38938646e-02]
 [-1.48368962e-02]
 [ 2.09178578e-02]
 [-2.07602349e-02]
 [ 6.01243974e-03]
 [-7.52493938e-03]
 [-6.27656312e-03]
 [-5.58107839e-04]
 [-1.13311376e-02]
 [-2.12692431e-04]
 [-9.92586610e-03]
 [-3.42906989e-03]
 [ 5.09641314e-03]
 [ 5.07111346e-03]
 [-5.49464911e-03]
 [ 1.45128151e-02]
 [ 5.47358594e-03]
 [ 9.40915385e-05]
 [ 8.37013847e-03]
 [-5.62730270e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.64866886]
curr_Stock_Price:  99.50967198368815
curr_Factors:  [99.50967198]
mat_Sqrt:  [[0.15]]
grads:  [0.03051054]
Stock Position:  0.03051053913213299
Bond Position:  [-8.6847626]


portfolio before change:  [-5.6604038]
curr_Stock_Price:  99.16063590512952
curr_Factors:  [99.16063591]
mat_Sqrt:  [[0.15]]
grads:  [-0.03979243]
Stock Position:  -0.0397924316143887
Bond Position:  [-1.71456098]


portfolio before change:  [-5.7128689]
curr_Stock_Price:  100.4737189986347
curr_Factors:  [100.473719]
mat_Sqrt:  [[0.15]]
grads:  [0.06690989]
Stock Position:  0.06690989472800174
Bond Position:  [-12.43555487]


portfolio before change:  [-5.60014812]
curr_Stock_Price:  102.18161771538685
curr_Factors:  [102.18161772]
mat_Sqrt:  [[0.15]]
grads:  [0.06692828]
Stock Position:  0.06692828253788455
Bond Position:  [-12.4389883]


portfolio before change:  [-5.70187755]
curr_Stock_Price:  100.6848743886337
curr_Factors:  [100.68487439]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-16.01086512]


portfolio before change:  [-5.6386513]
curr_Stock_Price:  101.3219346156102
curr_Factors:  [101.32193462]
mat_Sqrt:  [[0.15]]
grads:  [0.1763781]
Stock Position:  0.17637809647057195
Bond Position:  [-23.50962126]


portfolio before change:  [-5.60487079]
curr_Stock_Price:  101.5301203432283
curr_Factors:  [101.53012034]
mat_Sqrt:  [[0.15]]
grads:  [0.00915537]
Stock Position:  0.009155368512631854
Bond Position:  [-6.53441646]


portfolio before change:  [-5.61221503]
curr_Stock_Price:  100.81716249159838
curr_Factors:  [100.81716249]
mat_Sqrt:  [[0.15]]
grads:  [0.11110499]
Stock Position:  0.11110499296131722
Bond Position:  [-16.81350516]


portfolio before change:  [-5.60648204]
curr_Stock_Price:  100.88767966449524
curr_Factors:  [100.88767966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04434325]
Stock Position:  -0.044343252495482675
Bond Position:  [-1.13279419]


portfolio before change:  [-5.61749393]
curr_Stock_Price:  101.13281909301202
curr_Factors:  [101.13281909]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696647]
Stock Position:  -0.006966468746974165
Bond Position:  [-4.91295531]


portfolio before change:  [-5.62194874]
curr_Stock_Price:  101.68412433929377
curr_Factors:  [101.68412434]
mat_Sqrt:  [[0.15]]
grads:  [0.06918023]
Stock Position:  0.06918023215036459
Bond Position:  [-12.65648007]


portfolio before change:  [-5.65151008]
curr_Stock_Price:  101.27968541938506
curr_Factors:  [101.27968542]
mat_Sqrt:  [[0.15]]
grads:  [0.03123475]
Stock Position:  0.0312347502452214
Bond Position:  [-8.81495576]


portfolio before change:  [-5.64226841]
curr_Stock_Price:  101.61084243616558
curr_Factors:  [101.61084244]
mat_Sqrt:  [[0.15]]
grads:  [0.06557358]
Stock Position:  0.06557357602614648
Bond Position:  [-12.30525471]


portfolio before change:  [-5.6128983]
curr_Stock_Price:  102.08219634957513
curr_Factors:  [102.08219635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03500416]
Stock Position:  -0.03500415732669475
Bond Position:  [-2.03959704]


portfolio before change:  [-5.62853387]
curr_Stock_Price:  102.52159003627068
curr_Factors:  [102.52159004]
mat_Sqrt:  [[0.15]]
grads:  [0.07924717]
Stock Position:  0.07924717276314676
Bond Position:  [-13.75308003]


portfolio before change:  [-5.70120645]
curr_Stock_Price:  101.62624786754053
curr_Factors:  [101.62624787]
mat_Sqrt:  [[0.15]]
grads:  [0.01240938]
Stock Position:  0.012409377125893118
Bond Position:  [-6.96232488]


portfolio before change:  [-5.70323371]
curr_Stock_Price:  101.5330189072348
curr_Factors:  [101.53301891]
mat_Sqrt:  [[0.15]]
grads:  [0.05994272]
Stock Position:  0.059942720806147785
Bond Position:  [-11.78939911]


portfolio before change:  [-5.70599226]
curr_Stock_Price:  101.51158534935297
curr_Factors:  [101.51158535]
mat_Sqrt:  [[0.15]]
grads:  [0.09054453]
Stock Position:  0.09054452851799213
Bond Position:  [-14.89731089]


portfolio before change:  [-5.67509871]
curr_Stock_Price:  101.87335019309482
curr_Factors:  [101.87335019]
mat_Sqrt:  [[0.15]]
grads:  [0.07662971]
Stock Position:  0.076629714102825
Bond Position:  [-13.48162441]


portfolio before change:  [-5.6770121]
curr_Stock_Price:  101.87037383254687
curr_Factors:  [101.87037383]
mat_Sqrt:  [[0.15]]
grads:  [-0.09262576]
Stock Position:  -0.09262576376947895
Bond Position:  [3.75880908]


portfolio before change:  [-5.6178604]
curr_Stock_Price:  101.23683718605848
curr_Factors:  [101.23683719]
mat_Sqrt:  [[0.15]]
grads:  [-0.09891264]
Stock Position:  -0.09891264133952703
Bond Position:  [4.39574256]


portfolio before change:  [-5.61577937]
curr_Stock_Price:  101.221353527926
curr_Factors:  [101.22135353]
mat_Sqrt:  [[0.15]]
grads:  [0.13945239]
Stock Position:  0.13945238502973176
Bond Position:  [-19.73133854]


portfolio before change:  [-5.62047367]
curr_Stock_Price:  101.20537871208133
curr_Factors:  [101.20537871]
mat_Sqrt:  [[0.15]]
grads:  [-0.13840157]
Stock Position:  -0.13840156569680823
Bond Position:  [8.3865092]


portfolio before change:  [-5.49964534]
curr_Stock_Price:  100.33992640661901
curr_Factors:  [100.33992641]
mat_Sqrt:  [[0.15]]
grads:  [0.04008293]
Stock Position:  0.04008293156722274
Bond Position:  [-9.52156374]


portfolio before change:  [-5.448054]
curr_Stock_Price:  101.65673651700583
curr_Factors:  [101.65673652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016626]
Stock Position:  -0.050166262502406765
Bond Position:  [-0.34831547]


portfolio before change:  [-5.47002459]
curr_Stock_Price:  102.0938242116674
curr_Factors:  [102.09382421]
mat_Sqrt:  [[0.15]]
grads:  [-0.04184375]
Stock Position:  -0.0418437541628954
Bond Position:  [-1.19803571]


portfolio before change:  [-5.4422494]
curr_Stock_Price:  101.42646169793595
curr_Factors:  [101.4264617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00372072]
Stock Position:  -0.003720718927927402
Bond Position:  [-5.06487005]


portfolio before change:  [-5.44408179]
curr_Stock_Price:  101.74877572857308
curr_Factors:  [101.74877573]
mat_Sqrt:  [[0.15]]
grads:  [-0.07554092]
Stock Position:  -0.07554091702076941
Bond Position:  [2.24211403]


portfolio before change:  [-5.43528577]
curr_Stock_Price:  101.63604555087096
curr_Factors:  [101.63604555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00141795]
Stock Position:  -0.0014179495390497245
Bond Position:  [-5.29117099]


portfolio before change:  [-5.43726165]
curr_Stock_Price:  102.5630463387984
curr_Factors:  [102.56304634]
mat_Sqrt:  [[0.15]]
grads:  [-0.06617244]
Stock Position:  -0.06617244069966424
Bond Position:  [1.34958545]


portfolio before change:  [-5.48804272]
curr_Stock_Price:  103.33300102397693
curr_Factors:  [103.33300102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02286047]
Stock Position:  -0.02286046595734777
Bond Position:  [-3.12580217]


portfolio before change:  [-5.4633468]
curr_Stock_Price:  102.23561884127888
curr_Factors:  [102.23561884]
mat_Sqrt:  [[0.15]]
grads:  [0.03397609]
Stock Position:  0.03397608761275226
Bond Position:  [-8.93691315]


portfolio before change:  [-5.47736458]
curr_Stock_Price:  101.85592243587317
curr_Factors:  [101.85592244]
mat_Sqrt:  [[0.15]]
grads:  [0.03380742]
Stock Position:  0.03380742309428948
Bond Position:  [-8.92085085]


portfolio before change:  [-5.46780113]
curr_Stock_Price:  102.17178877892397
curr_Factors:  [102.17178878]
mat_Sqrt:  [[0.15]]
grads:  [-0.03663099]
Stock Position:  -0.03663099408380551
Bond Position:  [-1.72514694]


portfolio before change:  [-5.48249487]
curr_Stock_Price:  102.56703006706327
curr_Factors:  [102.56703007]
mat_Sqrt:  [[0.15]]
grads:  [0.0967521]
Stock Position:  0.09675210047322674
Bond Position:  [-15.40607047]


portfolio before change:  [-5.55428933]
curr_Stock_Price:  101.84488985970442
curr_Factors:  [101.84488986]
mat_Sqrt:  [[0.15]]
grads:  [0.03649057]
Stock Position:  0.03649057295657752
Bond Position:  [-9.27066772]


portfolio before change:  [-5.56142146]
curr_Stock_Price:  101.68119770560044
curr_Factors:  [101.68119771]
mat_Sqrt:  [[0.15]]
grads:  [0.00062728]
Stock Position:  0.0006272769231137748
Bond Position:  [-5.62520373]


portfolio before change:  [-5.56321519]
curr_Stock_Price:  99.94267767425178
curr_Factors:  [99.94267767]
mat_Sqrt:  [[0.15]]
grads:  [0.05580092]
Stock Position:  0.05580092313898992
Bond Position:  [-11.14010886]


portfolio before change:  [-5.55984343]
curr_Stock_Price:  100.0280590596431
curr_Factors:  [100.02805906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.55984343]
Stock Price:  99.33307602724105
PL:  [-5.55984343]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.30452887e-03]
 [ 2.84307206e-05]
 [ 1.49418602e-02]
 [ 2.15837411e-03]
 [ 1.38554084e-02]
 [ 2.62762359e-02]
 [-5.86275440e-03]
 [ 1.86204020e-02]
 [-5.95389869e-03]
 [ 7.16974136e-04]
 [-8.77065956e-03]
 [ 7.36238462e-03]
 [ 1.38917504e-02]
 [-7.26934944e-05]
 [ 3.45667828e-05]
 [-3.32955765e-03]
 [ 1.50386026e-02]
 [-4.91888767e-03]
 [ 9.38205000e-03]
 [-1.12016274e-02]
 [ 1.04885379e-02]
 [-1.85861511e-03]
 [ 2.32918955e-02]
 [ 4.29922242e-03]
 [ 1.67212228e-02]
 [-1.00490579e-02]
 [ 2.30974413e-02]
 [-1.85040357e-02]
 [-4.26270512e-02]
 [ 5.91760036e-04]
 [-4.17636093e-03]
 [ 5.58294257e-03]
 [ 1.47048597e-02]
 [-1.28804190e-02]
 [ 3.17181923e-03]
 [ 5.56326998e-03]
 [ 4.06988443e-03]
 [ 9.76341507e-03]
 [-5.64920388e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.38936667]
curr_Stock_Price:  100.47976616844498
curr_Factors:  [100.47976617]
mat_Sqrt:  [[0.15]]
grads:  [0.04203019]
Stock Position:  0.04203019247179605
Bond Position:  [5.16618275]


portfolio before change:  [9.42313434]
curr_Stock_Price:  101.26781541148736
curr_Factors:  [101.26781541]
mat_Sqrt:  [[0.15]]
grads:  [0.00018954]
Stock Position:  0.0001895381370923636
Bond Position:  [9.40394023]


portfolio before change:  [9.42431291]
curr_Stock_Price:  101.28364433859949
curr_Factors:  [101.28364434]
mat_Sqrt:  [[0.15]]
grads:  [0.0996124]
Stock Position:  0.09961240100689168
Bond Position:  [-0.66479409]


portfolio before change:  [9.43140958]
curr_Stock_Price:  101.3557214563073
curr_Factors:  [101.35572146]
mat_Sqrt:  [[0.15]]
grads:  [0.01438916]
Stock Position:  0.01438916075038105
Bond Position:  [7.97298581]


portfolio before change:  [9.43902514]
curr_Stock_Price:  101.81571220860938
curr_Factors:  [101.81571221]
mat_Sqrt:  [[0.15]]
grads:  [0.09236939]
Stock Position:  0.09236938901077922
Bond Position:  [0.03437002]


portfolio before change:  [9.37148201]
curr_Stock_Price:  101.08443719539625
curr_Factors:  [101.0844372]
mat_Sqrt:  [[0.15]]
grads:  [0.17517491]
Stock Position:  0.17517490628732021
Bond Position:  [-8.3359748]


portfolio before change:  [9.38352384]
curr_Stock_Price:  101.15912764489265
curr_Factors:  [101.15912764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03908503]
Stock Position:  -0.03908502936010518
Bond Position:  [13.33733132]


portfolio before change:  [9.40821366]
curr_Stock_Price:  100.57009026843481
curr_Factors:  [100.57009027]
mat_Sqrt:  [[0.15]]
grads:  [0.12413601]
Stock Position:  0.12413601323424682
Bond Position:  [-3.0761564]


portfolio before change:  [9.14922832]
curr_Stock_Price:  98.48688499559823
curr_Factors:  [98.486885]
mat_Sqrt:  [[0.15]]
grads:  [-0.03969266]
Stock Position:  -0.03969265792258166
Bond Position:  [13.05843455]


portfolio before change:  [9.160318]
curr_Stock_Price:  98.24862248472593
curr_Factors:  [98.24862248]
mat_Sqrt:  [[0.15]]
grads:  [0.00477983]
Stock Position:  0.004779827574050809
Bond Position:  [8.69070652]


portfolio before change:  [9.15533988]
curr_Stock_Price:  96.97984864172764
curr_Factors:  [96.97984864]
mat_Sqrt:  [[0.15]]
grads:  [-0.05847106]
Stock Position:  -0.058471063734588685
Bond Position:  [14.82585479]


portfolio before change:  [9.12308126]
curr_Stock_Price:  97.56324777369541
curr_Factors:  [97.56324777]
mat_Sqrt:  [[0.15]]
grads:  [0.04908256]
Stock Position:  0.049082564137310554
Bond Position:  [4.3344269]


portfolio before change:  [9.07759263]
curr_Stock_Price:  96.62543066990612
curr_Factors:  [96.62543067]
mat_Sqrt:  [[0.15]]
grads:  [0.09261167]
Stock Position:  0.09261166938053074
Bond Position:  [0.12895019]


portfolio before change:  [9.03790021]
curr_Stock_Price:  96.19666676362128
curr_Factors:  [96.19666676]
mat_Sqrt:  [[0.15]]
grads:  [-0.00048462]
Stock Position:  -0.0004846232956952039
Bond Position:  [9.08451936]


portfolio before change:  [9.03855907]
curr_Stock_Price:  97.18047062029311
curr_Factors:  [97.18047062]
mat_Sqrt:  [[0.15]]
grads:  [0.00023045]
Stock Position:  0.0002304452189306391
Bond Position:  [9.0161643]


portfolio before change:  [9.03991989]
curr_Stock_Price:  98.19471086735996
curr_Factors:  [98.19471087]
mat_Sqrt:  [[0.15]]
grads:  [-0.02219705]
Stock Position:  -0.022197050997706646
Bond Position:  [11.21955289]


portfolio before change:  [9.04980068]
curr_Stock_Price:  97.81275650598785
curr_Factors:  [97.81275651]
mat_Sqrt:  [[0.15]]
grads:  [0.10025735]
Stock Position:  0.10025735044143456
Bond Position:  [-0.75664713]


portfolio before change:  [9.14242803]
curr_Stock_Price:  98.73759576858913
curr_Factors:  [98.73759577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03279258]
Stock Position:  -0.03279258447670961
Bond Position:  [12.38028898]


portfolio before change:  [9.13607354]
curr_Stock_Price:  98.97856870632621
curr_Factors:  [98.97856871]
mat_Sqrt:  [[0.15]]
grads:  [0.062547]
Stock Position:  0.0625469999857149
Bond Position:  [2.945261]


portfolio before change:  [9.15004274]
curr_Stock_Price:  99.19602149702754
curr_Factors:  [99.1960215]
mat_Sqrt:  [[0.15]]
grads:  [-0.07467752]
Stock Position:  -0.07467751567415677
Bond Position:  [16.55775519]


portfolio before change:  [9.1924452]
curr_Stock_Price:  98.65593101517113
curr_Factors:  [98.65593102]
mat_Sqrt:  [[0.15]]
grads:  [0.06992359]
Stock Position:  0.06992358567148708
Bond Position:  [2.29406876]


portfolio before change:  [9.09705823]
curr_Stock_Price:  97.28766961460059
curr_Factors:  [97.28766961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239077]
Stock Position:  -0.01239076740916641
Bond Position:  [10.30252712]


portfolio before change:  [9.10280159]
curr_Stock_Price:  96.92809041383322
curr_Factors:  [96.92809041]
mat_Sqrt:  [[0.15]]
grads:  [0.1552793]
Stock Position:  0.15527930333571616
Bond Position:  [-5.94812476]


portfolio before change:  [9.12418195]
curr_Stock_Price:  97.07056866881207
curr_Factors:  [97.07056867]
mat_Sqrt:  [[0.15]]
grads:  [0.02866148]
Stock Position:  0.028661482790333447
Bond Position:  [6.34199552]


portfolio before change:  [9.13621658]
curr_Stock_Price:  97.46279622307961
curr_Factors:  [97.46279622]
mat_Sqrt:  [[0.15]]
grads:  [0.11147482]
Stock Position:  0.1114748188121018
Bond Position:  [-1.72843097]


portfolio before change:  [9.09095197]
curr_Stock_Price:  97.05868216819022
curr_Factors:  [97.05868217]
mat_Sqrt:  [[0.15]]
grads:  [-0.06699372]
Stock Position:  -0.0669937192943497
Bond Position:  [15.59327408]


portfolio before change:  [9.15959993]
curr_Stock_Price:  96.063086129503
curr_Factors:  [96.06308613]
mat_Sqrt:  [[0.15]]
grads:  [0.15398294]
Stock Position:  0.15398294227827594
Bond Position:  [-5.63247672]


portfolio before change:  [9.30170931]
curr_Stock_Price:  96.9905491497849
curr_Factors:  [96.99054915]
mat_Sqrt:  [[0.15]]
grads:  [-0.12336024]
Stock Position:  -0.12336023811964666
Bond Position:  [21.26648655]


portfolio before change:  [9.29473242]
curr_Stock_Price:  97.06865669561206
curr_Factors:  [97.0686567]
mat_Sqrt:  [[0.15]]
grads:  [-0.28418034]
Stock Position:  -0.2841803410297541
Bond Position:  [36.87973639]


portfolio before change:  [9.55551979]
curr_Stock_Price:  96.16719706142597
curr_Factors:  [96.16719706]
mat_Sqrt:  [[0.15]]
grads:  [0.00394507]
Stock Position:  0.003945066905304811
Bond Position:  [9.17613376]


portfolio before change:  [9.55530328]
curr_Stock_Price:  95.8215527744025
curr_Factors:  [95.82155277]
mat_Sqrt:  [[0.15]]
grads:  [-0.02784241]
Stock Position:  -0.027842406180047345
Bond Position:  [12.22320588]


portfolio before change:  [9.5711559]
curr_Stock_Price:  95.30706344602667
curr_Factors:  [95.30706345]
mat_Sqrt:  [[0.15]]
grads:  [0.03721962]
Stock Position:  0.037219617108070265
Bond Position:  [6.02386349]


portfolio before change:  [9.56573697]
curr_Stock_Price:  95.14123800182476
curr_Factors:  [95.141238]
mat_Sqrt:  [[0.15]]
grads:  [0.0980324]
Stock Position:  0.09803239786744954
Bond Position:  [0.23881327]


portfolio before change:  [9.60048942]
curr_Stock_Price:  95.49543309325824
curr_Factors:  [95.49543309]
mat_Sqrt:  [[0.15]]
grads:  [-0.08586946]
Stock Position:  -0.08586945974924376
Bond Position:  [17.80063067]


portfolio before change:  [9.59390136]
curr_Stock_Price:  95.59806881951872
curr_Factors:  [95.59806882]
mat_Sqrt:  [[0.15]]
grads:  [0.02114546]
Stock Position:  0.021145461522307913
Bond Position:  [7.57243608]


portfolio before change:  [9.5892448]
curr_Stock_Price:  95.33308650412529
curr_Factors:  [95.3330865]
mat_Sqrt:  [[0.15]]
grads:  [0.03708847]
Stock Position:  0.037088466513501346
Bond Position:  [6.05348682]


portfolio before change:  [9.58201864]
curr_Stock_Price:  95.11784709827917
curr_Factors:  [95.1178471]
mat_Sqrt:  [[0.15]]
grads:  [0.02713256]
Stock Position:  0.02713256284457615
Bond Position:  [7.00122767]


portfolio before change:  [9.56561835]
curr_Stock_Price:  94.48113987939198
curr_Factors:  [94.48113988]
mat_Sqrt:  [[0.15]]
grads:  [0.06508943]
Stock Position:  0.06508943378015039
Bond Position:  [3.41589445]


portfolio before change:  [9.58454994]
curr_Stock_Price:  94.76543452454636
curr_Factors:  [94.76543452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.58454994]
Stock Price:  95.009977133336
PL:  [9.58454994]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.29842102e-03]
 [-3.46723947e-03]
 [ 3.07472836e-04]
 [-2.87518098e-03]
 [ 1.53582963e-02]
 [ 2.54656325e-02]
 [-1.10383691e-02]
 [ 2.32042780e-02]
 [-5.89060260e-03]
 [ 1.61746260e-03]
 [-9.37711062e-04]
 [ 7.16525295e-03]
 [ 1.39074099e-02]
 [ 2.41857542e-03]
 [ 1.05263745e-02]
 [-3.33566877e-03]
 [ 1.18615205e-02]
 [ 1.27808364e-02]
 [ 1.15617197e-02]
 [-1.25268346e-02]
 [-1.63545289e-02]
 [ 1.77683368e-02]
 [-5.14231592e-03]
 [ 6.17241704e-03]
 [-8.26547152e-03]
 [-8.33445374e-03]
 [ 3.91600249e-03]
 [-1.07011718e-02]
 [-1.80051861e-02]
 [-8.27506484e-03]
 [-2.22757429e-03]
 [ 5.32312053e-03]
 [ 5.11893162e-03]
 [-1.12408248e-02]
 [ 1.85493731e-02]
 [ 5.51413131e-03]
 [ 1.91083110e-04]
 [ 8.18097354e-03]
 [-1.05976066e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.57872782]
curr_Stock_Price:  99.38516509745428
curr_Factors:  [99.3851651]
mat_Sqrt:  [[0.15]]
grads:  [0.03532281]
Stock Position:  0.035322806824619496
Bond Position:  [-11.08929081]


portfolio before change:  [-7.58135241]
curr_Stock_Price:  99.35010725445082
curr_Factors:  [99.35010725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311493]
Stock Position:  -0.023114929769658354
Bond Position:  [-5.28488166]


portfolio before change:  [-7.5825051]
curr_Stock_Price:  99.37139373910412
curr_Factors:  [99.37139374]
mat_Sqrt:  [[0.15]]
grads:  [0.00204982]
Stock Position:  0.002049818904282085
Bond Position:  [-7.78619846]


portfolio before change:  [-7.58179688]
curr_Stock_Price:  100.19173634093181
curr_Factors:  [100.19173634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916787]
Stock Position:  -0.019167873187479808
Bond Position:  [-5.66133439]


portfolio before change:  [-7.58801134]
curr_Stock_Price:  100.47902667477962
curr_Factors:  [100.47902667]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-17.87592244]


portfolio before change:  [-7.57837003]
curr_Stock_Price:  100.59501546002562
curr_Factors:  [100.59501546]
mat_Sqrt:  [[0.15]]
grads:  [0.16977088]
Stock Position:  0.16977088323050543
Bond Position:  [-24.65647466]


portfolio before change:  [-7.79661227]
curr_Stock_Price:  99.32766043192133
curr_Factors:  [99.32766043]
mat_Sqrt:  [[0.15]]
grads:  [-0.07358913]
Stock Position:  -0.07358912717608973
Bond Position:  [-0.48717643]


portfolio before change:  [-7.78307503]
curr_Stock_Price:  99.142875805221
curr_Factors:  [99.14287581]
mat_Sqrt:  [[0.15]]
grads:  [0.15469519]
Stock Position:  0.15469518634812904
Bond Position:  [-23.12000068]


portfolio before change:  [-7.71119376]
curr_Stock_Price:  99.62622278172987
curr_Factors:  [99.62622278]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927068]
Stock Position:  -0.03927068401988684
Bond Position:  [-3.79880385]


portfolio before change:  [-7.73427292]
curr_Stock_Price:  100.20182470423043
curr_Factors:  [100.2018247]
mat_Sqrt:  [[0.15]]
grads:  [0.01078308]
Stock Position:  0.01078308400198097
Bond Position:  [-8.81475761]


portfolio before change:  [-7.7548049]
curr_Stock_Price:  98.399922509615
curr_Factors:  [98.39992251]
mat_Sqrt:  [[0.15]]
grads:  [-0.00625141]
Stock Position:  -0.006251407080355223
Bond Position:  [-7.13966693]


portfolio before change:  [-7.75548344]
curr_Stock_Price:  98.3656944041849
curr_Factors:  [98.3656944]
mat_Sqrt:  [[0.15]]
grads:  [0.04776835]
Stock Position:  0.047768352993659384
Bond Position:  [-12.45425065]


portfolio before change:  [-7.78946097]
curr_Stock_Price:  97.68698876215159
curr_Factors:  [97.68698876]
mat_Sqrt:  [[0.15]]
grads:  [0.09271607]
Stock Position:  0.09271606629672474
Bond Position:  [-16.84661429]


portfolio before change:  [-7.75737043]
curr_Stock_Price:  98.05581910458116
curr_Factors:  [98.0558191]
mat_Sqrt:  [[0.15]]
grads:  [0.01612384]
Stock Position:  0.016123836116471037
Bond Position:  [-9.33840638]


portfolio before change:  [-7.74014356]
curr_Stock_Price:  99.19662945788622
curr_Factors:  [99.19662946]
mat_Sqrt:  [[0.15]]
grads:  [0.07017583]
Stock Position:  0.0701758298817605
Bond Position:  [-14.70134936]


portfolio before change:  [-7.79364303]
curr_Stock_Price:  98.46045458635481
curr_Factors:  [98.46045459]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223779]
Stock Position:  -0.02223779179662778
Bond Position:  [-5.60409994]


portfolio before change:  [-7.80743985]
curr_Stock_Price:  99.04937387339506
curr_Factors:  [99.04937387]
mat_Sqrt:  [[0.15]]
grads:  [0.0790768]
Stock Position:  0.07907680308166898
Bond Position:  [-15.63994768]


portfolio before change:  [-7.69494511]
curr_Stock_Price:  100.49669908460329
curr_Factors:  [100.49669908]
mat_Sqrt:  [[0.15]]
grads:  [0.08520558]
Stock Position:  0.08520557578614125
Bond Position:  [-16.25782422]


portfolio before change:  [-7.73422263]
curr_Stock_Price:  100.05957796098353
curr_Factors:  [100.05957796]
mat_Sqrt:  [[0.15]]
grads:  [0.07707813]
Stock Position:  0.07707813101431236
Bond Position:  [-15.44662789]


portfolio before change:  [-7.71073311]
curr_Stock_Price:  100.38937921554061
curr_Factors:  [100.38937922]
mat_Sqrt:  [[0.15]]
grads:  [-0.08351223]
Stock Position:  -0.0835122307147403
Bond Position:  [0.67300789]


portfolio before change:  [-7.72701767]
curr_Stock_Price:  100.58538276636898
curr_Factors:  [100.58538277]
mat_Sqrt:  [[0.15]]
grads:  [-0.10903019]
Stock Position:  -0.10903019264890344
Bond Position:  [3.23982599]


portfolio before change:  [-7.73363498]
curr_Stock_Price:  100.64978981069845
curr_Factors:  [100.64978981]
mat_Sqrt:  [[0.15]]
grads:  [0.11845558]
Stock Position:  0.11845557895069725
Bond Position:  [-19.65616411]


portfolio before change:  [-7.74895093]
curr_Stock_Price:  100.54123626705062
curr_Factors:  [100.54123627]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428211]
Stock Position:  -0.03428210612536352
Bond Position:  [-4.3021856]


portfolio before change:  [-7.75203237]
curr_Stock_Price:  100.61543332093548
curr_Factors:  [100.61543332]
mat_Sqrt:  [[0.15]]
grads:  [0.04114945]
Stock Position:  0.04114944694121434
Bond Position:  [-11.8923018]


portfolio before change:  [-7.72516251]
curr_Stock_Price:  101.3045430316464
curr_Factors:  [101.30454303]
mat_Sqrt:  [[0.15]]
grads:  [-0.05510314]
Stock Position:  -0.055103143436197044
Bond Position:  [-2.14296375]


portfolio before change:  [-7.68480488]
curr_Stock_Price:  100.56727976099492
curr_Factors:  [100.56727976]
mat_Sqrt:  [[0.15]]
grads:  [-0.05556302]
Stock Position:  -0.05556302492923826
Bond Position:  [-2.09698261]


portfolio before change:  [-7.66482819]
curr_Stock_Price:  100.20302978532959
curr_Factors:  [100.20302979]
mat_Sqrt:  [[0.15]]
grads:  [0.02610668]
Stock Position:  0.02610668324851655
Bond Position:  [-10.28079695]


portfolio before change:  [-7.67373879]
curr_Stock_Price:  99.91094273178146
curr_Factors:  [99.91094273]
mat_Sqrt:  [[0.15]]
grads:  [-0.07134115]
Stock Position:  -0.07134114536138415
Bond Position:  [-0.5459777]


portfolio before change:  [-7.72879615]
curr_Stock_Price:  100.68173363135288
curr_Factors:  [100.68173363]
mat_Sqrt:  [[0.15]]
grads:  [-0.12003457]
Stock Position:  -0.12003457409140113
Bond Position:  [4.35649287]


portfolio before change:  [-7.72015154]
curr_Stock_Price:  100.61425298842939
curr_Factors:  [100.61425299]
mat_Sqrt:  [[0.15]]
grads:  [-0.0551671]
Stock Position:  -0.05516709893086231
Bond Position:  [-2.16955509]


portfolio before change:  [-7.71471483]
curr_Stock_Price:  100.51078687913672
curr_Factors:  [100.51078688]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148505]
Stock Position:  -0.014850495287020057
Bond Position:  [-6.22207986]


portfolio before change:  [-7.71334416]
curr_Stock_Price:  100.36611286988443
curr_Factors:  [100.36611287]
mat_Sqrt:  [[0.15]]
grads:  [0.03548747]
Stock Position:  0.0354874702235822
Bond Position:  [-11.2750836]


portfolio before change:  [-7.70666797]
curr_Stock_Price:  100.59395836252942
curr_Factors:  [100.59395836]
mat_Sqrt:  [[0.15]]
grads:  [0.03412621]
Stock Position:  0.03412621081883232
Bond Position:  [-11.1395586]


portfolio before change:  [-7.72190069]
curr_Stock_Price:  100.18839936739047
curr_Factors:  [100.18839937]
mat_Sqrt:  [[0.15]]
grads:  [-0.07493883]
Stock Position:  -0.0749388322979667
Bond Position:  [-0.21389903]


portfolio before change:  [-7.70634831]
curr_Stock_Price:  99.98050823722767
curr_Factors:  [99.98050824]
mat_Sqrt:  [[0.15]]
grads:  [0.12366249]
Stock Position:  0.12366248759012889
Bond Position:  [-20.07018667]


portfolio before change:  [-7.63995227]
curr_Stock_Price:  100.53771015497101
curr_Factors:  [100.53771015]
mat_Sqrt:  [[0.15]]
grads:  [0.03676088]
Stock Position:  0.03676087541961172
Bond Position:  [-11.33580651]


portfolio before change:  [-7.60211033]
curr_Stock_Price:  101.60566616851125
curr_Factors:  [101.60566617]
mat_Sqrt:  [[0.15]]
grads:  [0.00127389]
Stock Position:  0.0012738874030912418
Bond Position:  [-7.73154451]


portfolio before change:  [-7.60493916]
curr_Stock_Price:  100.1437465443204
curr_Factors:  [100.14374654]
mat_Sqrt:  [[0.15]]
grads:  [0.05453982]
Stock Position:  0.05453982361870871
Bond Position:  [-13.06676143]


portfolio before change:  [-7.56364722]
curr_Stock_Price:  100.93079312353493
curr_Factors:  [100.93079312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.56364722]
Stock Price:  101.40715185169745
PL:  [-8.97079908]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.26555265e-03]
 [-7.73697249e-03]
 [-2.30592218e-02]
 [ 2.29505778e-03]
 [-3.93131804e-02]
 [-1.56904974e-02]
 [-5.12071767e-02]
 [ 1.80353938e-02]
 [-6.37487250e-03]
 [-3.62993600e-04]
 [-9.32788277e-03]
 [ 7.46964016e-03]
 [ 1.39044770e-02]
 [ 1.77435167e-03]
 [-2.36170080e-03]
 [-5.26933614e-03]
 [ 1.67479382e-02]
 [-1.69823727e-02]
 [ 3.91595202e-03]
 [ 9.74191826e-03]
 [ 2.93746378e-02]
 [ 2.28463925e-03]
 [ 5.50151393e-02]
 [-4.55234146e-03]
 [ 6.90359801e-03]
 [ 2.96209911e-02]
 [ 4.12390207e-02]
 [-3.10695628e-02]
 [-4.70638137e-02]
 [ 3.24892658e-03]
 [-4.50388489e-03]
 [ 5.59206414e-03]
 [ 2.28058651e-02]
 [-1.53168640e-02]
 [ 5.14529390e-03]
 [ 4.54238063e-03]
 [ 9.07639893e-03]
 [ 8.87414834e-03]
 [-6.87351034e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.77703508]
curr_Stock_Price:  99.24335368312718
curr_Factors:  [99.24335368]
mat_Sqrt:  [[0.15]]
grads:  [0.04177035]
Stock Position:  0.04177035098937393
Bond Position:  [-13.9224648]


portfolio before change:  [-9.78750551]
curr_Stock_Price:  99.0343534332377
curr_Factors:  [99.03435343]
mat_Sqrt:  [[0.15]]
grads:  [-0.05157982]
Stock Position:  -0.051579816598932154
Bond Position:  [-4.67933173]


portfolio before change:  [-9.72384188]
curr_Stock_Price:  97.78873851634845
curr_Factors:  [97.78873852]
mat_Sqrt:  [[0.15]]
grads:  [-0.15372815]
Stock Position:  -0.15372814549973401
Bond Position:  [5.30903955]


portfolio before change:  [-9.79770829]
curr_Stock_Price:  98.2735559293312
curr_Factors:  [98.27355593]
mat_Sqrt:  [[0.15]]
grads:  [0.01530039]
Stock Position:  0.015300385207908478
Bond Position:  [-11.30133155]


portfolio before change:  [-9.80937223]
curr_Stock_Price:  97.60356028506547
curr_Factors:  [97.60356029]
mat_Sqrt:  [[0.15]]
grads:  [-0.26208787]
Stock Position:  -0.2620878694602814
Bond Position:  [15.77133693]


portfolio before change:  [-10.15055543]
curr_Stock_Price:  98.91287207915374
curr_Factors:  [98.91287208]
mat_Sqrt:  [[0.15]]
grads:  [-0.10460332]
Stock Position:  -0.10460331617003243
Bond Position:  [0.196059]


portfolio before change:  [-10.06031792]
curr_Stock_Price:  98.05044245058787
curr_Factors:  [98.05044245]
mat_Sqrt:  [[0.15]]
grads:  [-0.34138118]
Stock Position:  -0.34138117808094515
Bond Position:  [23.41225763]


portfolio before change:  [-9.87165858]
curr_Stock_Price:  97.50638015305178
curr_Factors:  [97.50638015]
mat_Sqrt:  [[0.15]]
grads:  [0.12023596]
Stock Position:  0.12023595853642625
Bond Position:  [-21.59543166]


portfolio before change:  [-9.92841956]
curr_Stock_Price:  97.05675274111246
curr_Factors:  [97.05675274]
mat_Sqrt:  [[0.15]]
grads:  [-0.04249915]
Stock Position:  -0.042499150030866815
Bond Position:  [-5.80359006]


portfolio before change:  [-9.94433659]
curr_Stock_Price:  97.4142077371832
curr_Factors:  [97.41420774]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241996]
Stock Position:  -0.002419957335322096
Bond Position:  [-9.70859836]


portfolio before change:  [-9.94412446]
curr_Stock_Price:  96.82503335371939
curr_Factors:  [96.82503335]
mat_Sqrt:  [[0.15]]
grads:  [-0.06218589]
Stock Position:  -0.06218588510183677
Bond Position:  [-3.92297406]


portfolio before change:  [-9.96337129]
curr_Stock_Price:  97.12665205320094
curr_Factors:  [97.12665205]
mat_Sqrt:  [[0.15]]
grads:  [0.0497976]
Stock Position:  0.04979760104985166
Bond Position:  [-14.80004556]


portfolio before change:  [-9.94721892]
curr_Stock_Price:  97.48816532275629
curr_Factors:  [97.48816532]
mat_Sqrt:  [[0.15]]
grads:  [0.09269651]
Stock Position:  0.09269651338285971
Bond Position:  [-18.98403194]


portfolio before change:  [-9.96918794]
curr_Stock_Price:  97.27676720076923
curr_Factors:  [97.2767672]
mat_Sqrt:  [[0.15]]
grads:  [0.01182901]
Stock Position:  0.011829011145775012
Bond Position:  [-11.1198759]


portfolio before change:  [-9.97872704]
curr_Stock_Price:  96.5878655839552
curr_Factors:  [96.58786558]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574467]
Stock Position:  -0.015744672000907227
Bond Position:  [-8.45798277]


portfolio before change:  [-9.98534123]
curr_Stock_Price:  96.94080265560936
curr_Factors:  [96.94080266]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512891]
Stock Position:  -0.035128907607998375
Bond Position:  [-6.57991673]


portfolio before change:  [-9.9935301]
curr_Stock_Price:  97.15049693364365
curr_Factors:  [97.15049693]
mat_Sqrt:  [[0.15]]
grads:  [0.11165292]
Stock Position:  0.11165292159706372
Bond Position:  [-20.84066692]


portfolio before change:  [-10.09200367]
curr_Stock_Price:  96.29186894736762
curr_Factors:  [96.29186895]
mat_Sqrt:  [[0.15]]
grads:  [-0.11321582]
Stock Position:  -0.11321581806639797
Bond Position:  [0.80975905]


portfolio before change:  [-10.12091036]
curr_Stock_Price:  96.54808679343068
curr_Factors:  [96.54808679]
mat_Sqrt:  [[0.15]]
grads:  [0.02610635]
Stock Position:  0.026106346803308016
Bond Position:  [-12.64142819]


portfolio before change:  [-10.19247132]
curr_Stock_Price:  93.86748615938025
curr_Factors:  [93.86748616]
mat_Sqrt:  [[0.15]]
grads:  [0.06494612]
Stock Position:  0.06494612170917664
Bond Position:  [-16.2888005]


portfolio before change:  [-10.26303195]
curr_Stock_Price:  92.81239003853727
curr_Factors:  [92.81239004]
mat_Sqrt:  [[0.15]]
grads:  [0.19583092]
Stock Position:  0.19583091852207204
Bond Position:  [-28.43856754]


portfolio before change:  [-10.28511653]
curr_Stock_Price:  92.71776994703255
curr_Factors:  [92.71776995]
mat_Sqrt:  [[0.15]]
grads:  [0.01523093]
Stock Position:  0.015230928355560702
Bond Position:  [-11.69729425]


portfolio before change:  [-10.29767764]
curr_Stock_Price:  91.98906477872515
curr_Factors:  [91.98906478]
mat_Sqrt:  [[0.15]]
grads:  [0.3667676]
Stock Position:  0.36676759512340823
Bond Position:  [-44.03628571]


portfolio before change:  [-10.37046605]
curr_Stock_Price:  91.80561475041206
curr_Factors:  [91.80561475]
mat_Sqrt:  [[0.15]]
grads:  [-0.03034894]
Stock Position:  -0.030348943075496224
Bond Position:  [-7.58426267]


portfolio before change:  [-10.39027731]
curr_Stock_Price:  92.42715778027187
curr_Factors:  [92.42715778]
mat_Sqrt:  [[0.15]]
grads:  [0.04602399]
Stock Position:  0.046023986748214486
Bond Position:  [-14.6441436]


portfolio before change:  [-10.4089039]
curr_Stock_Price:  92.06221875777818
curr_Factors:  [92.06221876]
mat_Sqrt:  [[0.15]]
grads:  [0.19747327]
Stock Position:  0.1974732740309104
Bond Position:  [-28.58873165]


portfolio before change:  [-10.55166656]
curr_Stock_Price:  91.35736971852332
curr_Factors:  [91.35736972]
mat_Sqrt:  [[0.15]]
grads:  [0.2749268]
Stock Position:  0.2749268049096393
Bond Position:  [-35.66825632]


portfolio before change:  [-10.68568098]
curr_Stock_Price:  90.88613298650897
curr_Factors:  [90.88613299]
mat_Sqrt:  [[0.15]]
grads:  [-0.20713042]
Stock Position:  -0.20713041848908625
Bond Position:  [8.13960178]


portfolio before change:  [-10.91126689]
curr_Stock_Price:  91.98014625966916
curr_Factors:  [91.98014626]
mat_Sqrt:  [[0.15]]
grads:  [-0.31375876]
Stock Position:  -0.3137587580816532
Bond Position:  [17.94830957]


portfolio before change:  [-10.93092287]
curr_Stock_Price:  92.04994401109755
curr_Factors:  [92.04994401]
mat_Sqrt:  [[0.15]]
grads:  [0.02165951]
Stock Position:  0.021659510527428837
Bond Position:  [-12.9246796]


portfolio before change:  [-10.91167442]
curr_Stock_Price:  93.01322205444156
curr_Factors:  [93.01322205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0300259]
Stock Position:  -0.030025899251908558
Bond Position:  [-8.11886879]


portfolio before change:  [-10.87628637]
curr_Stock_Price:  91.80083628812046
curr_Factors:  [91.80083629]
mat_Sqrt:  [[0.15]]
grads:  [0.03728043]
Stock Position:  0.03728042761453468
Bond Position:  [-14.2986608]


portfolio before change:  [-10.88522582]
curr_Stock_Price:  91.60899283432488
curr_Factors:  [91.60899283]
mat_Sqrt:  [[0.15]]
grads:  [0.1520391]
Stock Position:  0.15203910088880612
Bond Position:  [-24.81337473]


portfolio before change:  [-10.72776978]
curr_Stock_Price:  92.6650232080599
curr_Factors:  [92.66502321]
mat_Sqrt:  [[0.15]]
grads:  [-0.10211243]
Stock Position:  -0.10211242658799621
Bond Position:  [-1.2655194]


portfolio before change:  [-10.70433002]
curr_Stock_Price:  92.43392534399003
curr_Factors:  [92.43392534]
mat_Sqrt:  [[0.15]]
grads:  [0.03430196]
Stock Position:  0.03430195930108759
Bond Position:  [-13.87499476]


portfolio before change:  [-10.68527053]
curr_Stock_Price:  93.04012892376265
curr_Factors:  [93.04012892]
mat_Sqrt:  [[0.15]]
grads:  [0.03028254]
Stock Position:  0.030282537500178598
Bond Position:  [-13.50276172]


portfolio before change:  [-10.7065079]
curr_Stock_Price:  92.39456156761136
curr_Factors:  [92.39456157]
mat_Sqrt:  [[0.15]]
grads:  [0.06050933]
Stock Position:  0.0605093262111951
Bond Position:  [-16.29724056]


portfolio before change:  [-10.64280344]
curr_Stock_Price:  93.48103433895324
curr_Factors:  [93.48103434]
mat_Sqrt:  [[0.15]]
grads:  [0.05916099]
Stock Position:  0.059160988905473055
Bond Position:  [-16.17323388]


portfolio before change:  [-10.62467333]
curr_Stock_Price:  93.82166249226911
curr_Factors:  [93.82166249]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.62467333]
Stock Price:  93.96418446667992
PL:  [-10.62467333]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.68295498e-03]
 [ 1.39600108e-03]
 [ 1.48126035e-02]
 [-2.70549020e-03]
 [ 1.34404017e-02]
 [ 2.54406950e-02]
 [-4.90455813e-03]
 [ 1.88427021e-02]
 [-5.87740499e-03]
 [ 1.32130971e-03]
 [ 4.86887141e-03]
 [ 4.36216858e-03]
 [ 1.43124700e-02]
 [ 3.44019165e-03]
 [ 9.57290636e-03]
 [-3.14235945e-03]
 [ 1.08108665e-02]
 [ 1.38176592e-02]
 [ 1.16617364e-02]
 [-1.40287653e-02]
 [-1.72280729e-02]
 [ 1.69278426e-02]
 [-1.32133445e-02]
 [ 6.18947272e-03]
 [ 7.13718447e-04]
 [-1.07223744e-02]
 [ 6.35929928e-03]
 [-1.11280920e-02]
 [-1.76228806e-02]
 [-9.99761300e-03]
 [-2.99446909e-03]
 [ 5.48689061e-03]
 [ 5.59128621e-03]
 [-1.18318135e-02]
 [ 2.07104059e-02]
 [ 5.64648247e-03]
 [ 2.29854118e-03]
 [ 9.91359799e-03]
 [-2.39626169e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.02443978]
curr_Stock_Price:  100.39171559582181
curr_Factors:  [100.3917156]
mat_Sqrt:  [[0.15]]
grads:  [0.04455303]
Stock Position:  0.04455303316676715
Bond Position:  [3.55168434]


portfolio before change:  [8.05660657]
curr_Stock_Price:  101.10373917558005
curr_Factors:  [101.10373918]
mat_Sqrt:  [[0.15]]
grads:  [0.00930667]
Stock Position:  0.009306673853477025
Bond Position:  [7.11566705]


portfolio before change:  [8.06367734]
curr_Stock_Price:  101.7679133541173
curr_Factors:  [101.76791335]
mat_Sqrt:  [[0.15]]
grads:  [0.09875069]
Stock Position:  0.09875069002514064
Bond Position:  [-1.98597433]


portfolio before change:  [7.93235194]
curr_Stock_Price:  100.44055922875017
curr_Factors:  [100.44055923]
mat_Sqrt:  [[0.15]]
grads:  [-0.0180366]
Stock Position:  -0.018036601344690012
Bond Position:  [9.74395827]


portfolio before change:  [7.94216967]
curr_Stock_Price:  99.9637702442165
curr_Factors:  [99.96377024]
mat_Sqrt:  [[0.15]]
grads:  [0.08960268]
Stock Position:  0.08960267768087284
Bond Position:  [-1.01485182]


portfolio before change:  [7.99784007]
curr_Stock_Price:  100.58648902106582
curr_Factors:  [100.58648902]
mat_Sqrt:  [[0.15]]
grads:  [0.16960463]
Stock Position:  0.1696046334697276
Bond Position:  [-9.06209453]


portfolio before change:  [7.86366602]
curr_Stock_Price:  99.80206932778997
curr_Factors:  [99.80206933]
mat_Sqrt:  [[0.15]]
grads:  [-0.03269705]
Stock Position:  -0.032697054171497854
Bond Position:  [11.12689969]


portfolio before change:  [7.84091331]
curr_Stock_Price:  100.54047417964449
curr_Factors:  [100.54047418]
mat_Sqrt:  [[0.15]]
grads:  [0.12561801]
Stock Position:  0.12561801398525088
Bond Position:  [-4.78878138]


portfolio before change:  [7.71989204]
curr_Stock_Price:  99.58183268959104
curr_Factors:  [99.58183269]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391827]
Stock Position:  -0.039182699965729165
Bond Position:  [11.62177711]


portfolio before change:  [7.69391671]
curr_Stock_Price:  100.28183903193815
curr_Factors:  [100.28183903]
mat_Sqrt:  [[0.15]]
grads:  [0.00880873]
Stock Position:  0.00880873138824698
Bond Position:  [6.81056093]


portfolio before change:  [7.6885962]
curr_Stock_Price:  99.5811840603064
curr_Factors:  [99.58118406]
mat_Sqrt:  [[0.15]]
grads:  [0.03245914]
Stock Position:  0.03245914275915579
Bond Position:  [4.45627633]


portfolio before change:  [7.69768768]
curr_Stock_Price:  99.84411174601057
curr_Factors:  [99.84411175]
mat_Sqrt:  [[0.15]]
grads:  [0.02908112]
Stock Position:  0.029081123845159908
Bond Position:  [4.7941087]


portfolio before change:  [7.6839007]
curr_Stock_Price:  99.34941707253432
curr_Factors:  [99.34941707]
mat_Sqrt:  [[0.15]]
grads:  [0.09541647]
Stock Position:  0.09541646691919739
Bond Position:  [-1.79566967]


portfolio before change:  [7.63396914]
curr_Stock_Price:  98.82846831587563
curr_Factors:  [98.82846832]
mat_Sqrt:  [[0.15]]
grads:  [0.02293461]
Stock Position:  0.022934611007933425
Bond Position:  [5.36737666]


portfolio before change:  [7.63980309]
curr_Stock_Price:  99.05358616752339
curr_Factors:  [99.05358617]
mat_Sqrt:  [[0.15]]
grads:  [0.06381938]
Stock Position:  0.0638193757094487
Bond Position:  [1.31826506]


portfolio before change:  [7.64763783]
curr_Stock_Price:  99.17376825356995
curr_Factors:  [99.17376825]
mat_Sqrt:  [[0.15]]
grads:  [-0.02094906]
Stock Position:  -0.020949062979172765
Bond Position:  [9.72523535]


portfolio before change:  [7.6433802]
curr_Stock_Price:  99.43503821157157
curr_Factors:  [99.43503821]
mat_Sqrt:  [[0.15]]
grads:  [0.07207244]
Stock Position:  0.07207244357736753
Bond Position:  [0.47685402]


portfolio before change:  [7.78354119]
curr_Stock_Price:  101.37893478433485
curr_Factors:  [101.37893478]
mat_Sqrt:  [[0.15]]
grads:  [0.09211773]
Stock Position:  0.09211772830810269
Bond Position:  [-1.55525598]


portfolio before change:  [7.80248605]
curr_Stock_Price:  101.58670457248344
curr_Factors:  [101.58670457]
mat_Sqrt:  [[0.15]]
grads:  [0.07774491]
Stock Position:  0.07774490941966497
Bond Position:  [-0.09536309]


portfolio before change:  [7.83656862]
curr_Stock_Price:  102.02524763120901
curr_Factors:  [102.02524763]
mat_Sqrt:  [[0.15]]
grads:  [-0.0935251]
Stock Position:  -0.09352510222730415
Bond Position:  [17.37849033]


portfolio before change:  [7.96270021]
curr_Stock_Price:  100.69983718920217
curr_Factors:  [100.69983719]
mat_Sqrt:  [[0.15]]
grads:  [-0.11485382]
Stock Position:  -0.11485381943911131
Bond Position:  [19.52846113]


portfolio before change:  [7.99912341]
curr_Stock_Price:  100.40396559481286
curr_Factors:  [100.40396559]
mat_Sqrt:  [[0.15]]
grads:  [0.11285228]
Stock Position:  0.11285228371669935
Bond Position:  [-3.3316934]


portfolio before change:  [8.04853499]
curr_Stock_Price:  100.8454991591346
curr_Factors:  [100.84549916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08808896]
Stock Position:  -0.08808896339781323
Bond Position:  [16.93191047]


portfolio before change:  [8.06639225]
curr_Stock_Price:  100.66680894953208
curr_Factors:  [100.66680895]
mat_Sqrt:  [[0.15]]
grads:  [0.04126315]
Stock Position:  0.04126315146190603
Bond Position:  [3.91256246]


portfolio before change:  [8.03035935]
curr_Stock_Price:  99.78170929377089
curr_Factors:  [99.78170929]
mat_Sqrt:  [[0.15]]
grads:  [0.00475812]
Stock Position:  0.004758122982525757
Bond Position:  [7.5555857]


portfolio before change:  [8.0273528]
curr_Stock_Price:  98.95132859047064
curr_Factors:  [98.95132859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0714825]
Stock Position:  -0.07148249576390306
Bond Position:  [15.10064073]


portfolio before change:  [7.9664303]
curr_Stock_Price:  99.83000801126407
curr_Factors:  [99.83000801]
mat_Sqrt:  [[0.15]]
grads:  [0.04239533]
Stock Position:  0.0423953285411207
Bond Position:  [3.73410431]


portfolio before change:  [8.00544633]
curr_Stock_Price:  100.73928830670215
curr_Factors:  [100.73928831]
mat_Sqrt:  [[0.15]]
grads:  [-0.07418728]
Stock Position:  -0.07418728027099636
Bond Position:  [15.47902015]


portfolio before change:  [7.98767542]
curr_Stock_Price:  101.00491207900161
curr_Factors:  [101.00491208]
mat_Sqrt:  [[0.15]]
grads:  [-0.11748587]
Stock Position:  -0.11748587093951135
Bond Position:  [19.85432549]


portfolio before change:  [7.94424572]
curr_Stock_Price:  101.39569646668812
curr_Factors:  [101.39569647]
mat_Sqrt:  [[0.15]]
grads:  [-0.06665075]
Stock Position:  -0.06665075332255659
Bond Position:  [14.70234528]


portfolio before change:  [8.04507921]
curr_Stock_Price:  99.91040825877684
curr_Factors:  [99.91040826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996313]
Stock Position:  -0.019963127264915732
Bond Position:  [10.03960341]


portfolio before change:  [8.05126114]
curr_Stock_Price:  99.66360816277013
curr_Factors:  [99.66360816]
mat_Sqrt:  [[0.15]]
grads:  [0.03657927]
Stock Position:  0.03657927072011641
Bond Position:  [4.40563904]


portfolio before change:  [8.05605638]
curr_Stock_Price:  99.77964367961121
curr_Factors:  [99.77964368]
mat_Sqrt:  [[0.15]]
grads:  [0.03727524]
Stock Position:  0.037275241404384506
Bond Position:  [4.33674607]


portfolio before change:  [8.05325559]
curr_Stock_Price:  99.68996191418529
curr_Factors:  [99.68996191]
mat_Sqrt:  [[0.15]]
grads:  [-0.07887876]
Stock Position:  -0.07887875659098036
Bond Position:  [15.91667583]


portfolio before change:  [7.97768431]
curr_Stock_Price:  100.67325564932393
curr_Factors:  [100.67325565]
mat_Sqrt:  [[0.15]]
grads:  [0.13806937]
Stock Position:  0.1380693728878928
Bond Position:  [-5.92220896]


portfolio before change:  [7.85873263]
curr_Stock_Price:  99.81708200684423
curr_Factors:  [99.81708201]
mat_Sqrt:  [[0.15]]
grads:  [0.03764322]
Stock Position:  0.0376432164725389
Bond Position:  [4.10129661]


portfolio before change:  [7.87607883]
curr_Stock_Price:  100.26426757288951
curr_Factors:  [100.26426757]
mat_Sqrt:  [[0.15]]
grads:  [0.01532361]
Stock Position:  0.015323607895330283
Bond Position:  [6.33966851]


portfolio before change:  [7.85595133]
curr_Stock_Price:  98.89905291886228
curr_Factors:  [98.89905292]
mat_Sqrt:  [[0.15]]
grads:  [0.06609065]
Stock Position:  0.06609065326285246
Bond Position:  [1.31964831]


portfolio before change:  [7.86711674]
curr_Stock_Price:  99.0654977282326
curr_Factors:  [99.06549773]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.86711674]
Stock Price:  99.03161153659111
PL:  [7.86711674]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.10903526e-03]
 [-1.19068107e-02]
 [-4.91193795e-03]
 [-2.93460616e-03]
 [ 1.49919010e-02]
 [ 2.62932676e-02]
 [ 1.30328305e-03]
 [ 2.09190242e-02]
 [-5.84367381e-03]
 [ 4.18444066e-03]
 [ 1.27834870e-03]
 [ 7.05854811e-03]
 [ 1.38366365e-02]
 [ 3.19606150e-03]
 [-1.24539806e-03]
 [-6.76572993e-03]
 [ 1.93062652e-02]
 [-2.56492242e-02]
 [ 1.54941219e-03]
 [ 4.56665958e-03]
 [ 2.66641239e-02]
 [ 1.05106167e-03]
 [ 2.92754428e-02]
 [ 1.11995090e-03]
 [ 1.14069410e-02]
 [ 8.47768859e-03]
 [ 2.84014686e-02]
 [-2.27780419e-02]
 [-4.75749147e-02]
 [ 2.26998521e-03]
 [-4.43119234e-03]
 [ 5.58410398e-03]
 [ 1.17839282e-02]
 [-1.28503455e-02]
 [ 3.66275965e-03]
 [ 5.71100523e-03]
 [ 3.58232055e-03]
 [ 1.15322588e-02]
 [-1.40251766e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.52612606]
curr_Stock_Price:  99.71110524980126
curr_Factors:  [99.71110525]
mat_Sqrt:  [[0.15]]
grads:  [0.0207269]
Stock Position:  0.020726901754071617
Bond Position:  [-4.59282834]


portfolio before change:  [-2.55059801]
curr_Stock_Price:  98.55812001926753
curr_Factors:  [98.55812002]
mat_Sqrt:  [[0.15]]
grads:  [-0.07937874]
Stock Position:  -0.07937873791154954
Bond Position:  [5.27282117]


portfolio before change:  [-2.59484229]
curr_Stock_Price:  99.12380580994835
curr_Factors:  [99.12380581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03274625]
Stock Position:  -0.03274625300110813
Bond Position:  [0.65109093]


portfolio before change:  [-2.62687821]
curr_Stock_Price:  100.10459933354723
curr_Factors:  [100.10459933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956404]
Stock Position:  -0.019564041095438228
Bond Position:  [-0.66842772]


portfolio before change:  [-2.64347707]
curr_Stock_Price:  100.94876562352066
curr_Factors:  [100.94876562]
mat_Sqrt:  [[0.15]]
grads:  [0.09994601]
Stock Position:  0.09994600635956871
Bond Position:  [-12.73290305]


portfolio before change:  [-2.62926891]
curr_Stock_Price:  101.10684975848359
curr_Factors:  [101.10684976]
mat_Sqrt:  [[0.15]]
grads:  [0.17528845]
Stock Position:  0.17528845099809523
Bond Position:  [-20.35213199]


portfolio before change:  [-2.73308739]
curr_Stock_Price:  100.52909177064903
curr_Factors:  [100.52909177]
mat_Sqrt:  [[0.15]]
grads:  [0.00868855]
Stock Position:  0.008688553642897818
Bond Position:  [-3.60653979]


portfolio before change:  [-2.73658381]
curr_Stock_Price:  100.17856384135243
curr_Factors:  [100.17856384]
mat_Sqrt:  [[0.15]]
grads:  [0.13946016]
Stock Position:  0.13946016100208397
Bond Position:  [-16.70750246]


portfolio before change:  [-2.84405459]
curr_Stock_Price:  99.42292000434249
curr_Factors:  [99.42292]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895783]
Stock Position:  -0.03895782541231077
Bond Position:  [1.02924617]


portfolio before change:  [-2.85021361]
curr_Stock_Price:  99.58431712863629
curr_Factors:  [99.58431713]
mat_Sqrt:  [[0.15]]
grads:  [0.02789627]
Stock Position:  0.027896271058413833
Bond Position:  [-5.62824471]


portfolio before change:  [-2.87217612]
curr_Stock_Price:  98.82224619134206
curr_Factors:  [98.82224619]
mat_Sqrt:  [[0.15]]
grads:  [0.00852232]
Stock Position:  0.008522324694095787
Bond Position:  [-3.71437139]


portfolio before change:  [-2.87550408]
curr_Stock_Price:  98.48623123768371
curr_Factors:  [98.48623124]
mat_Sqrt:  [[0.15]]
grads:  [0.04705699]
Stock Position:  0.047056987428233214
Bond Position:  [-7.50996942]


portfolio before change:  [-2.86230123]
curr_Stock_Price:  98.78675308509249
curr_Factors:  [98.78675309]
mat_Sqrt:  [[0.15]]
grads:  [0.09224424]
Stock Position:  0.09224424324306275
Bond Position:  [-11.97481051]


portfolio before change:  [-2.86832838]
curr_Stock_Price:  98.7376421028195
curr_Factors:  [98.7376421]
mat_Sqrt:  [[0.15]]
grads:  [0.02130708]
Stock Position:  0.021307076683864112
Bond Position:  [-4.97213889]


portfolio before change:  [-2.90887324]
curr_Stock_Price:  96.86393100716893
curr_Factors:  [96.86393101]
mat_Sqrt:  [[0.15]]
grads:  [-0.00830265]
Stock Position:  -0.008302653749700847
Bond Position:  [-2.10464556]


portfolio before change:  [-2.90532919]
curr_Stock_Price:  96.40538504029804
curr_Factors:  [96.40538504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04510487]
Stock Position:  -0.04510486619252007
Bond Position:  [1.4430228]


portfolio before change:  [-2.89428815]
curr_Stock_Price:  96.16459842404959
curr_Factors:  [96.16459842]
mat_Sqrt:  [[0.15]]
grads:  [0.12870843]
Stock Position:  0.12870843498968562
Bond Position:  [-15.27148312]


portfolio before change:  [-2.96839245]
curr_Stock_Price:  95.60367760653737
curr_Factors:  [95.60367761]
mat_Sqrt:  [[0.15]]
grads:  [-0.17099483]
Stock Position:  -0.1709948278626344
Bond Position:  [13.37934195]


portfolio before change:  [-2.86075252]
curr_Stock_Price:  94.98396644629219
curr_Factors:  [94.98396645]
mat_Sqrt:  [[0.15]]
grads:  [0.01032941]
Stock Position:  0.010329414615141905
Bond Position:  [-3.84188129]


portfolio before change:  [-2.85859982]
curr_Stock_Price:  95.23886652096506
curr_Factors:  [95.23886652]
mat_Sqrt:  [[0.15]]
grads:  [0.0304444]
Stock Position:  0.030444397230185185
Bond Position:  [-5.7580897]


portfolio before change:  [-2.8800421]
curr_Stock_Price:  94.55820037390515
curr_Factors:  [94.55820037]
mat_Sqrt:  [[0.15]]
grads:  [0.17776083]
Stock Position:  0.17776082618791597
Bond Position:  [-19.68878592]


portfolio before change:  [-2.99642048]
curr_Stock_Price:  93.91735542140678
curr_Factors:  [93.91735542]
mat_Sqrt:  [[0.15]]
grads:  [0.00700708]
Stock Position:  0.007007077788789227
Bond Position:  [-3.65450669]


portfolio before change:  [-2.99353203]
curr_Stock_Price:  94.39477153896581
curr_Factors:  [94.39477154]
mat_Sqrt:  [[0.15]]
grads:  [0.19516962]
Stock Position:  0.19516961844718825
Bond Position:  [-21.41652357]


portfolio before change:  [-2.94164171]
curr_Stock_Price:  94.67436190762425
curr_Factors:  [94.67436191]
mat_Sqrt:  [[0.15]]
grads:  [0.00746634]
Stock Position:  0.007466339324771823
Bond Position:  [-3.64851262]


portfolio before change:  [-2.9421396]
curr_Stock_Price:  94.66876378316503
curr_Factors:  [94.66876378]
mat_Sqrt:  [[0.15]]
grads:  [0.07604627]
Stock Position:  0.07604627311770107
Bond Position:  [-10.14134627]


portfolio before change:  [-2.94758929]
curr_Stock_Price:  94.61377173608639
curr_Factors:  [94.61377174]
mat_Sqrt:  [[0.15]]
grads:  [0.05651792]
Stock Position:  0.05651792392074901
Bond Position:  [-8.29496324]


portfolio before change:  [-2.93919981]
curr_Stock_Price:  94.78055811922476
curr_Factors:  [94.78055812]
mat_Sqrt:  [[0.15]]
grads:  [0.18934312]
Stock Position:  0.18934312391778388
Bond Position:  [-20.88524677]


portfolio before change:  [-2.82411677]
curr_Stock_Price:  95.40214842663424
curr_Factors:  [95.40214843]
mat_Sqrt:  [[0.15]]
grads:  [-0.15185361]
Stock Position:  -0.15185361268671646
Bond Position:  [11.66304412]


portfolio before change:  [-2.7842692]
curr_Stock_Price:  95.14934176759415
curr_Factors:  [95.14934177]
mat_Sqrt:  [[0.15]]
grads:  [-0.3171661]
Stock Position:  -0.31716609770222803
Bond Position:  [27.39387623]


portfolio before change:  [-2.42645356]
curr_Stock_Price:  94.0319739629077
curr_Factors:  [94.03197396]
mat_Sqrt:  [[0.15]]
grads:  [0.01513323]
Stock Position:  0.015133234735646383
Bond Position:  [-3.8494615]


portfolio before change:  [-2.42775568]
curr_Stock_Price:  93.97772876836713
curr_Factors:  [93.97772877]
mat_Sqrt:  [[0.15]]
grads:  [-0.02954128]
Stock Position:  -0.029541282233361863
Bond Position:  [0.34846693]


portfolio before change:  [-2.45379409]
curr_Stock_Price:  94.860627938627
curr_Factors:  [94.86062794]
mat_Sqrt:  [[0.15]]
grads:  [0.03722736]
Stock Position:  0.037227359894856774
Bond Position:  [-5.98520483]


portfolio before change:  [-2.39890709]
curr_Stock_Price:  96.35509863749272
curr_Factors:  [96.35509864]
mat_Sqrt:  [[0.15]]
grads:  [0.07855952]
Stock Position:  0.07855952113807445
Bond Position:  [-9.9685175]


portfolio before change:  [-2.39410817]
curr_Stock_Price:  96.43204746398791
curr_Factors:  [96.43204746]
mat_Sqrt:  [[0.15]]
grads:  [-0.08566897]
Stock Position:  -0.08566896999502925
Bond Position:  [5.86712601]


portfolio before change:  [-2.5201342]
curr_Stock_Price:  97.91169016744078
curr_Factors:  [97.91169017]
mat_Sqrt:  [[0.15]]
grads:  [0.0244184]
Stock Position:  0.024418397643615402
Bond Position:  [-4.91098079]


portfolio before change:  [-2.52742506]
curr_Stock_Price:  97.63825112435134
curr_Factors:  [97.63825112]
mat_Sqrt:  [[0.15]]
grads:  [0.03807337]
Stock Position:  0.03807336823251636
Bond Position:  [-6.24484215]


portfolio before change:  [-2.52462672]
curr_Stock_Price:  97.73225367434925
curr_Factors:  [97.73225367]
mat_Sqrt:  [[0.15]]
grads:  [0.02388214]
Stock Position:  0.02388213701217742
Bond Position:  [-4.85868179]


portfolio before change:  [-2.52317146]
curr_Stock_Price:  97.81862087355945
curr_Factors:  [97.81862087]
mat_Sqrt:  [[0.15]]
grads:  [0.07688173]
Stock Position:  0.07688172552836002
Bond Position:  [-10.04363582]


portfolio before change:  [-2.49104743]
curr_Stock_Price:  98.25278852804779
curr_Factors:  [98.25278853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.49104743]
Stock Price:  98.50551367174367
PL:  [-2.49104743]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.47166351e-03]
 [ 4.35201930e-03]
 [ 8.83172242e-03]
 [-2.41058082e-03]
 [-1.60468200e-02]
 [-3.07711976e-02]
 [-4.52968089e-02]
 [ 1.82202614e-02]
 [-6.20694400e-03]
 [-8.93452764e-04]
 [-7.66831044e-03]
 [ 7.63442267e-03]
 [ 1.38685918e-02]
 [-2.41499851e-03]
 [-6.96565548e-03]
 [-1.08167079e-02]
 [ 2.45351402e-02]
 [-4.09137455e-02]
 [-1.38563755e-03]
 [ 9.61015303e-03]
 [ 2.79656452e-02]
 [ 1.83642312e-03]
 [ 3.36474182e-02]
 [ 7.73639184e-04]
 [ 1.21774639e-02]
 [ 6.16833510e-04]
 [ 2.49581035e-02]
 [-2.46613910e-02]
 [-4.75777968e-02]
 [ 1.88258397e-03]
 [-4.48529002e-03]
 [ 5.58743233e-03]
 [ 1.77208345e-02]
 [-1.34532187e-02]
 [ 3.59853429e-03]
 [ 5.56929270e-03]
 [ 3.28300341e-03]
 [ 1.08494751e-02]
 [-6.19968132e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.07822802]
curr_Stock_Price:  100.9112603945183
curr_Factors:  [100.91126039]
mat_Sqrt:  [[0.15]]
grads:  [0.04314442]
Stock Position:  0.043144423404124464
Bond Position:  [11.72446987]


portfolio before change:  [16.0589329]
curr_Stock_Price:  100.43006807640117
curr_Factors:  [100.43006808]
mat_Sqrt:  [[0.15]]
grads:  [0.02901346]
Stock Position:  0.02901346197609518
Bond Position:  [13.14510894]


portfolio before change:  [16.05656986]
curr_Stock_Price:  100.29198439379952
curr_Factors:  [100.29198439]
mat_Sqrt:  [[0.15]]
grads:  [0.05887815]
Stock Position:  0.058878149447564705
Bond Position:  [10.15156341]


portfolio before change:  [16.02480618]
curr_Stock_Price:  99.73094944369343
curr_Factors:  [99.73094944]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607054]
Stock Position:  -0.016070538792102858
Bond Position:  [17.62753628]


portfolio before change:  [16.04969204]
curr_Stock_Price:  98.31952987181987
curr_Factors:  [98.31952987]
mat_Sqrt:  [[0.15]]
grads:  [-0.1069788]
Stock Position:  -0.10697880030351974
Bond Position:  [26.56779739]


portfolio before change:  [16.16712176]
curr_Stock_Price:  97.25288359051247
curr_Factors:  [97.25288359]
mat_Sqrt:  [[0.15]]
grads:  [-0.20514132]
Stock Position:  -0.2051413173729003
Bond Position:  [36.11770642]


portfolio before change:  [15.90782995]
curr_Stock_Price:  98.53885955054042
curr_Factors:  [98.53885955]
mat_Sqrt:  [[0.15]]
grads:  [-0.30197873]
Stock Position:  -0.30197872623754307
Bond Position:  [45.66446924]


portfolio before change:  [16.2160656]
curr_Stock_Price:  97.53704317251187
curr_Factors:  [97.53704317]
mat_Sqrt:  [[0.15]]
grads:  [0.12146841]
Stock Position:  0.12146840943388318
Bond Position:  [4.36839611]


portfolio before change:  [16.21116996]
curr_Stock_Price:  97.49224363919332
curr_Factors:  [97.49224364]
mat_Sqrt:  [[0.15]]
grads:  [-0.04137963]
Stock Position:  -0.04137962665519229
Bond Position:  [20.2453626]


portfolio before change:  [16.19890644]
curr_Stock_Price:  97.84977103196536
curr_Factors:  [97.84977103]
mat_Sqrt:  [[0.15]]
grads:  [-0.00595635]
Stock Position:  -0.005956351762255802
Bond Position:  [16.78173409]


portfolio before change:  [16.20446237]
curr_Stock_Price:  97.26920005583446
curr_Factors:  [97.26920006]
mat_Sqrt:  [[0.15]]
grads:  [-0.05112207]
Stock Position:  -0.051122069597430306
Bond Position:  [21.17706518]


portfolio before change:  [16.27258634]
curr_Stock_Price:  95.9884092245126
curr_Factors:  [95.98840922]
mat_Sqrt:  [[0.15]]
grads:  [0.05089615]
Stock Position:  0.05089615110469715
Bond Position:  [11.38714576]


portfolio before change:  [16.22652903]
curr_Stock_Price:  95.05551356022383
curr_Factors:  [95.05551356]
mat_Sqrt:  [[0.15]]
grads:  [0.09245728]
Stock Position:  0.09245727886141929
Bond Position:  [7.4379549]


portfolio before change:  [16.20513565]
curr_Stock_Price:  94.81407032901352
curr_Factors:  [94.81407033]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609999]
Stock Position:  -0.016099990086894157
Bond Position:  [17.73164124]


portfolio before change:  [16.19712518]
curr_Stock_Price:  95.44929210077137
curr_Factors:  [95.4492921]
mat_Sqrt:  [[0.15]]
grads:  [-0.0464377]
Stock Position:  -0.0464377031800903
Bond Position:  [20.62957107]


portfolio before change:  [16.22972704]
curr_Stock_Price:  94.80276989048562
curr_Factors:  [94.80276989]
mat_Sqrt:  [[0.15]]
grads:  [-0.07211139]
Stock Position:  -0.0721113858015401
Bond Position:  [23.06608615]


portfolio before change:  [16.28347674]
curr_Stock_Price:  94.09738527937151
curr_Factors:  [94.09738528]
mat_Sqrt:  [[0.15]]
grads:  [0.1635676]
Stock Position:  0.16356760116668934
Bond Position:  [0.89219316]


portfolio before change:  [16.31299488]
curr_Stock_Price:  94.27716789013292
curr_Factors:  [94.27716789]
mat_Sqrt:  [[0.15]]
grads:  [-0.2727583]
Stock Position:  -0.27275830332849205
Bond Position:  [42.02787524]


portfolio before change:  [16.54822004]
curr_Stock_Price:  93.43403557076044
curr_Factors:  [93.43403557]
mat_Sqrt:  [[0.15]]
grads:  [-0.00923758]
Stock Position:  -0.009237583678490952
Bond Position:  [17.41132476]


portfolio before change:  [16.54607001]
curr_Stock_Price:  93.90240233664208
curr_Factors:  [93.90240234]
mat_Sqrt:  [[0.15]]
grads:  [0.06406769]
Stock Position:  0.06406768684056321
Bond Position:  [10.52996031]


portfolio before change:  [16.5553081]
curr_Stock_Price:  94.02604913389781
curr_Factors:  [94.02604913]
mat_Sqrt:  [[0.15]]
grads:  [0.18643763]
Stock Position:  0.1864376344332229
Bond Position:  [-0.97468607]


portfolio before change:  [16.40087049]
curr_Stock_Price:  93.19834195106885
curr_Factors:  [93.19834195]
mat_Sqrt:  [[0.15]]
grads:  [0.01224282]
Stock Position:  0.012242820810403378
Bond Position:  [15.25985989]


portfolio before change:  [16.40379484]
curr_Stock_Price:  93.2813900561685
curr_Factors:  [93.28139006]
mat_Sqrt:  [[0.15]]
grads:  [0.22431612]
Stock Position:  0.224316121490159
Bond Position:  [-4.52072479]


portfolio before change:  [16.67555086]
curr_Stock_Price:  94.49539621629296
curr_Factors:  [94.49539622]
mat_Sqrt:  [[0.15]]
grads:  [0.00515759]
Stock Position:  0.005157594561218011
Bond Position:  [16.18818192]


portfolio before change:  [16.68044681]
curr_Stock_Price:  95.05230303632327
curr_Factors:  [95.05230304]
mat_Sqrt:  [[0.15]]
grads:  [0.08118309]
Stock Position:  0.08118309255760013
Bond Position:  [8.9638069]


portfolio before change:  [16.71779168]
curr_Stock_Price:  95.49850833446337
curr_Factors:  [95.49850833]
mat_Sqrt:  [[0.15]]
grads:  [0.00411222]
Stock Position:  0.004112223397857408
Bond Position:  [16.32508048]


portfolio before change:  [16.72030397]
curr_Stock_Price:  95.61317302251945
curr_Factors:  [95.61317302]
mat_Sqrt:  [[0.15]]
grads:  [0.16638736]
Stock Position:  0.16638735688555023
Bond Position:  [0.81148083]


portfolio before change:  [16.51571401]
curr_Stock_Price:  94.38296292055047
curr_Factors:  [94.38296292]
mat_Sqrt:  [[0.15]]
grads:  [-0.16440927]
Stock Position:  -0.1644092735962822
Bond Position:  [32.03314838]


portfolio before change:  [16.39078036]
curr_Stock_Price:  95.16721332737096
curr_Factors:  [95.16721333]
mat_Sqrt:  [[0.15]]
grads:  [-0.31718531]
Stock Position:  -0.3171853121916967
Bond Position:  [46.57642263]


portfolio before change:  [16.50789708]
curr_Stock_Price:  94.81633233086383
curr_Factors:  [94.81633233]
mat_Sqrt:  [[0.15]]
grads:  [0.01255056]
Stock Position:  0.012550559824906882
Bond Position:  [15.31789903]


portfolio before change:  [16.49437443]
curr_Stock_Price:  93.58630679067329
curr_Factors:  [93.58630679]
mat_Sqrt:  [[0.15]]
grads:  [-0.02990193]
Stock Position:  -0.029901933479071042
Bond Position:  [19.29278595]


portfolio before change:  [16.4969374]
curr_Stock_Price:  93.58124954860902
curr_Factors:  [93.58124955]
mat_Sqrt:  [[0.15]]
grads:  [0.03724955]
Stock Position:  0.037249548887284475
Bond Position:  [13.01107807]


portfolio before change:  [16.50839377]
curr_Stock_Price:  93.84514243057382
curr_Factors:  [93.84514243]
mat_Sqrt:  [[0.15]]
grads:  [0.1181389]
Stock Position:  0.11813889671580327
Bond Position:  [5.42163218]


portfolio before change:  [16.62406906]
curr_Stock_Price:  94.81855206109459
curr_Factors:  [94.81855206]
mat_Sqrt:  [[0.15]]
grads:  [-0.08968812]
Stock Position:  -0.0896881247218815
Bond Position:  [25.12816718]


portfolio before change:  [16.6186586]
curr_Stock_Price:  94.9139010988293
curr_Factors:  [94.9139011]
mat_Sqrt:  [[0.15]]
grads:  [0.02399023]
Stock Position:  0.023990228571330298
Bond Position:  [14.34165242]


portfolio before change:  [16.63346409]
curr_Stock_Price:  95.4563166078965
curr_Factors:  [95.45631661]
mat_Sqrt:  [[0.15]]
grads:  [0.03712862]
Stock Position:  0.037128617986531755
Bond Position:  [13.08930298]


portfolio before change:  [16.64296627]
curr_Stock_Price:  95.66817246516054
curr_Factors:  [95.66817247]
mat_Sqrt:  [[0.15]]
grads:  [0.02188669]
Stock Position:  0.021886689375271322
Bond Position:  [14.5491067]


portfolio before change:  [16.64762313]
curr_Stock_Price:  95.7978451012206
curr_Factors:  [95.7978451]
mat_Sqrt:  [[0.15]]
grads:  [0.07232983]
Stock Position:  0.07232983403308851
Bond Position:  [9.71858089]


portfolio before change:  [16.54817466]
curr_Stock_Price:  94.40611837994555
curr_Factors:  [94.40611838]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.54817466]
Stock Price:  93.34172476370915
PL:  [16.54817466]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.94866391e-03]
 [-8.51809903e-03]
 [-8.41845898e-04]
 [ 7.52865891e-04]
 [-1.30717079e-02]
 [-2.96127594e-02]
 [-3.93778480e-02]
 [ 1.07878460e-02]
 [-6.52926388e-03]
 [ 2.01168900e-02]
 [-1.72616668e-02]
 [ 7.76414804e-03]
 [ 1.38552587e-02]
 [-4.43476272e-03]
 [-1.32957176e-02]
 [-1.17529840e-02]
 [ 2.43197959e-02]
 [-5.99766684e-02]
 [-2.32444274e-03]
 [ 1.33111338e-02]
 [ 2.96189022e-02]
 [ 7.60265441e-04]
 [ 2.85004570e-02]
 [ 5.49671075e-05]
 [ 8.17837028e-03]
 [ 2.53353393e-02]
 [ 3.48438556e-02]
 [-2.62128348e-02]
 [-4.73246478e-02]
 [ 2.22610555e-03]
 [-4.43909289e-03]
 [ 5.58827114e-03]
 [ 1.57609655e-02]
 [-1.33077523e-02]
 [ 3.11884878e-03]
 [ 5.58727125e-03]
 [ 3.39595160e-03]
 [ 1.14152752e-02]
 [-5.42306738e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.28766109]
curr_Stock_Price:  99.14590415205889
curr_Factors:  [99.14590415]
mat_Sqrt:  [[0.15]]
grads:  [0.04632443]
Stock Position:  0.04632442605610186
Bond Position:  [-15.8805382]


portfolio before change:  [-11.29739824]
curr_Stock_Price:  98.97856351327361
curr_Factors:  [98.97856351]
mat_Sqrt:  [[0.15]]
grads:  [-0.05678733]
Stock Position:  -0.05678732683389949
Bond Position:  [-5.67667021]


portfolio before change:  [-11.31731966]
curr_Stock_Price:  99.31687466465996
curr_Factors:  [99.31687466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00561231]
Stock Position:  -0.005612305986228002
Bond Position:  [-10.75992297]


portfolio before change:  [-11.31436996]
curr_Stock_Price:  98.55163337690448
curr_Factors:  [98.55163338]
mat_Sqrt:  [[0.15]]
grads:  [0.00501911]
Stock Position:  0.005019105942116039
Bond Position:  [-11.80901105]


portfolio before change:  [-11.3164857]
curr_Stock_Price:  98.42421731670552
curr_Factors:  [98.42421732]
mat_Sqrt:  [[0.15]]
grads:  [-0.08714472]
Stock Position:  -0.08714471937307447
Bond Position:  [-2.7393349]


portfolio before change:  [-11.23540854]
curr_Stock_Price:  97.48991406117936
curr_Factors:  [97.48991406]
mat_Sqrt:  [[0.15]]
grads:  [-0.1974184]
Stock Position:  -0.1974183957398984
Bond Position:  [8.01089389]


portfolio before change:  [-11.09855912]
curr_Stock_Price:  96.80179177291367
curr_Factors:  [96.80179177]
mat_Sqrt:  [[0.15]]
grads:  [-0.26251899]
Stock Position:  -0.2625189863455424
Bond Position:  [14.31374913]


portfolio before change:  [-10.96616026]
curr_Stock_Price:  96.30426763276824
curr_Factors:  [96.30426763]
mat_Sqrt:  [[0.15]]
grads:  [0.07191897]
Stock Position:  0.07191897343333131
Bond Position:  [-17.89226432]


portfolio before change:  [-11.00253009]
curr_Stock_Price:  95.82966184681572
curr_Factors:  [95.82966185]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352843]
Stock Position:  -0.043528425853212135
Bond Position:  [-6.83121576]


portfolio before change:  [-10.950286]
curr_Stock_Price:  94.60981431791933
curr_Factors:  [94.60981432]
mat_Sqrt:  [[0.15]]
grads:  [0.1341126]
Stock Position:  0.13411259970562817
Bond Position:  [-23.63865416]


portfolio before change:  [-10.95177278]
curr_Stock_Price:  94.62076215386263
curr_Factors:  [94.62076215]
mat_Sqrt:  [[0.15]]
grads:  [-0.11507778]
Stock Position:  -0.1150777787758024
Bond Position:  [-0.06302564]


portfolio before change:  [-10.92709866]
curr_Stock_Price:  94.40628118349339
curr_Factors:  [94.40628118]
mat_Sqrt:  [[0.15]]
grads:  [0.05176099]
Stock Position:  0.05176098690479208
Bond Position:  [-15.81366094]


portfolio before change:  [-10.94225466]
curr_Stock_Price:  94.15166523035447
curr_Factors:  [94.15166523]
mat_Sqrt:  [[0.15]]
grads:  [0.09236839]
Stock Position:  0.09236839161254054
Bond Position:  [-19.63889255]


portfolio before change:  [-11.0076357]
curr_Stock_Price:  93.47041464636088
curr_Factors:  [93.47041465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956508]
Stock Position:  -0.029565084788682194
Bond Position:  [-8.24417497]


portfolio before change:  [-11.02088943]
curr_Stock_Price:  93.88384643170465
curr_Factors:  [93.88384643]
mat_Sqrt:  [[0.15]]
grads:  [-0.08863812]
Stock Position:  -0.08863811750523708
Bond Position:  [-2.69920202]


portfolio before change:  [-11.06462324]
curr_Stock_Price:  94.37343702519001
curr_Factors:  [94.37343703]
mat_Sqrt:  [[0.15]]
grads:  [-0.07835323]
Stock Position:  -0.07835322638500997
Bond Position:  [-3.67015997]


portfolio before change:  [-11.05020579]
curr_Stock_Price:  94.1835756058693
curr_Factors:  [94.18357561]
mat_Sqrt:  [[0.15]]
grads:  [0.16213197]
Stock Position:  0.16213197256538434
Bond Position:  [-26.32037468]


portfolio before change:  [-11.30690899]
curr_Stock_Price:  92.62057139571559
curr_Factors:  [92.6205714]
mat_Sqrt:  [[0.15]]
grads:  [-0.39984446]
Stock Position:  -0.39984445628439136
Bond Position:  [25.72691302]


portfolio before change:  [-11.46344093]
curr_Stock_Price:  93.020096748946
curr_Factors:  [93.02009675]
mat_Sqrt:  [[0.15]]
grads:  [-0.01549628]
Stock Position:  -0.015496284917412933
Bond Position:  [-10.021975]


portfolio before change:  [-11.46316878]
curr_Stock_Price:  92.92168761346933
curr_Factors:  [92.92168761]
mat_Sqrt:  [[0.15]]
grads:  [0.08874089]
Stock Position:  0.08874089211549852
Bond Position:  [-19.70912223]


portfolio before change:  [-11.49626138]
curr_Stock_Price:  92.57653888816779
curr_Factors:  [92.57653889]
mat_Sqrt:  [[0.15]]
grads:  [0.19745935]
Stock Position:  0.19745934781075042
Bond Position:  [-29.77636437]


portfolio before change:  [-11.1844264]
curr_Stock_Price:  94.1746260858284
curr_Factors:  [94.17462609]
mat_Sqrt:  [[0.15]]
grads:  [0.00506844]
Stock Position:  0.0050684362708153935
Bond Position:  [-11.66174449]


portfolio before change:  [-11.18342056]
curr_Stock_Price:  94.66070223754784
curr_Factors:  [94.66070224]
mat_Sqrt:  [[0.15]]
grads:  [0.19000305]
Stock Position:  0.19000304648478056
Bond Position:  [-29.16924237]


portfolio before change:  [-11.28904134]
curr_Stock_Price:  94.12400350954736
curr_Factors:  [94.12400351]
mat_Sqrt:  [[0.15]]
grads:  [0.00036645]
Stock Position:  0.0003664473835513343
Bond Position:  [-11.32353283]


portfolio before change:  [-11.29084615]
curr_Stock_Price:  93.06169465603594
curr_Factors:  [93.06169466]
mat_Sqrt:  [[0.15]]
grads:  [0.05452247]
Stock Position:  0.05452246853832422
Bond Position:  [-16.36479947]


portfolio before change:  [-11.31730208]
curr_Stock_Price:  92.6139855317015
curr_Factors:  [92.61398553]
mat_Sqrt:  [[0.15]]
grads:  [0.16890226]
Stock Position:  0.16890226168744052
Bond Position:  [-26.9600137]


portfolio before change:  [-11.24301759]
curr_Stock_Price:  93.07374675443778
curr_Factors:  [93.07374675]
mat_Sqrt:  [[0.15]]
grads:  [0.23229237]
Stock Position:  0.2322923708116025
Bond Position:  [-32.86333888]


portfolio before change:  [-11.13803122]
curr_Stock_Price:  93.54338998479784
curr_Factors:  [93.54338998]
mat_Sqrt:  [[0.15]]
grads:  [-0.17475223]
Stock Position:  -0.17475223179892047
Bond Position:  [5.20888495]


portfolio before change:  [-11.14683696]
curr_Stock_Price:  93.59750600406937
curr_Factors:  [93.597506]
mat_Sqrt:  [[0.15]]
grads:  [-0.31549765]
Stock Position:  -0.3154976517295968
Bond Position:  [18.38295639]


portfolio before change:  [-11.30964192]
curr_Stock_Price:  94.12081565695993
curr_Factors:  [94.12081566]
mat_Sqrt:  [[0.15]]
grads:  [0.0148407]
Stock Position:  0.014840703638089217
Bond Position:  [-12.70646105]


portfolio before change:  [-11.31420219]
curr_Stock_Price:  93.92056456801932
curr_Factors:  [93.92056457]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959395]
Stock Position:  -0.029593952602529363
Bond Position:  [-8.53472145]


portfolio before change:  [-11.29568548]
curr_Stock_Price:  93.25882075277316
curr_Factors:  [93.25882075]
mat_Sqrt:  [[0.15]]
grads:  [0.03725514]
Stock Position:  0.03725514095462366
Bond Position:  [-14.770056]


portfolio before change:  [-11.24404983]
curr_Stock_Price:  94.69438159869436
curr_Factors:  [94.6943816]
mat_Sqrt:  [[0.15]]
grads:  [0.1050731]
Stock Position:  0.10507310354563339
Bond Position:  [-21.1938824]


portfolio before change:  [-11.21559034]
curr_Stock_Price:  94.99045066059381
curr_Factors:  [94.99045066]
mat_Sqrt:  [[0.15]]
grads:  [-0.08871835]
Stock Position:  -0.0887183484546182
Bond Position:  [-2.78819444]


portfolio before change:  [-11.27738056]
curr_Stock_Price:  95.68299825647887
curr_Factors:  [95.68299826]
mat_Sqrt:  [[0.15]]
grads:  [0.02079233]
Stock Position:  0.020792325213110467
Bond Position:  [-13.26685258]


portfolio before change:  [-11.27610367]
curr_Stock_Price:  95.82417332875612
curr_Factors:  [95.82417333]
mat_Sqrt:  [[0.15]]
grads:  [0.03724847]
Stock Position:  0.03724847497564923
Bond Position:  [-14.84540799]


portfolio before change:  [-11.27011291]
curr_Stock_Price:  96.0348274628694
curr_Factors:  [96.03482746]
mat_Sqrt:  [[0.15]]
grads:  [0.02263968]
Stock Position:  0.02263967730257699
Bond Position:  [-13.44431042]


portfolio before change:  [-11.26162889]
curr_Stock_Price:  96.48380341716901
curr_Factors:  [96.48380342]
mat_Sqrt:  [[0.15]]
grads:  [0.07610183]
Stock Position:  0.07610183454008157
Bond Position:  [-18.60422333]


portfolio before change:  [-11.3834924]
curr_Stock_Price:  94.91304183592467
curr_Factors:  [94.91304184]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.3834924]
Stock Price:  95.85601343460834
PL:  [-11.3834924]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.72463812e-03]
 [ 3.80637220e-03]
 [-2.60758847e-03]
 [ 4.14382868e-03]
 [-6.64998738e-02]
 [-3.60387779e-02]
 [-3.32910889e-02]
 [ 7.07446127e-03]
 [-6.52464297e-03]
 [ 7.24447883e-03]
 [-9.70832531e-03]
 [ 7.60818559e-03]
 [ 1.38946183e-02]
 [ 2.44869271e-03]
 [ 7.21887387e-03]
 [-4.57279521e-03]
 [ 1.78199600e-02]
 [-1.89887241e-02]
 [ 3.23574412e-03]
 [ 4.04678986e-03]
 [ 2.54992377e-02]
 [-4.65036498e-04]
 [ 2.84501970e-02]
 [-5.51272927e-04]
 [ 1.02566377e-02]
 [ 1.07639981e-02]
 [ 3.12156368e-02]
 [-2.69997700e-02]
 [-4.72537638e-02]
 [ 3.15474480e-03]
 [-4.24268515e-03]
 [ 5.59219483e-03]
 [ 2.04421569e-02]
 [-1.61203029e-02]
 [ 5.93596602e-03]
 [ 3.00124106e-03]
 [ 1.09110184e-02]
 [ 5.93615396e-03]
 [-8.60003067e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.70823221]
curr_Stock_Price:  99.76386706597852
curr_Factors:  [99.76386707]
mat_Sqrt:  [[0.15]]
grads:  [0.01816425]
Stock Position:  0.01816425414949819
Bond Position:  [-3.52036845]


portfolio before change:  [-1.7060238]
curr_Stock_Price:  99.90967433496255
curr_Factors:  [99.90967433]
mat_Sqrt:  [[0.15]]
grads:  [0.02537581]
Stock Position:  0.025375814670442663
Bond Position:  [-4.24131318]


portfolio before change:  [-1.72372225]
curr_Stock_Price:  99.23311491402559
curr_Factors:  [99.23311491]
mat_Sqrt:  [[0.15]]
grads:  [-0.01738392]
Stock Position:  -0.01738392310742141
Bond Position:  [0.00133859]


portfolio before change:  [-1.70124612]
curr_Stock_Price:  97.94019826061238
curr_Factors:  [97.94019826]
mat_Sqrt:  [[0.15]]
grads:  [0.02762552]
Stock Position:  0.027625524543735278
Bond Position:  [-4.40689547]


portfolio before change:  [-1.73399762]
curr_Stock_Price:  96.77458765508571
curr_Factors:  [96.77458766]
mat_Sqrt:  [[0.15]]
grads:  [-0.44333249]
Stock Position:  -0.4433324918383682
Bond Position:  [41.16932147]


portfolio before change:  [-1.4630668]
curr_Stock_Price:  96.17507298598349
curr_Factors:  [96.17507299]
mat_Sqrt:  [[0.15]]
grads:  [-0.24025852]
Stock Position:  -0.2402585190161198
Bond Position:  [21.6438138]


portfolio before change:  [-1.46929979]
curr_Stock_Price:  96.21227723147713
curr_Factors:  [96.21227723]
mat_Sqrt:  [[0.15]]
grads:  [-0.22194059]
Stock Position:  -0.22194059259458443
Bond Position:  [19.88411003]


portfolio before change:  [-1.35053298]
curr_Stock_Price:  95.68834809142663
curr_Factors:  [95.68834809]
mat_Sqrt:  [[0.15]]
grads:  [0.04716308]
Stock Position:  0.04716307512799713
Bond Position:  [-5.86348973]


portfolio before change:  [-1.34035081]
curr_Stock_Price:  95.91978220956186
curr_Factors:  [95.91978221]
mat_Sqrt:  [[0.15]]
grads:  [-0.04349762]
Stock Position:  -0.04349761982016794
Bond Position:  [2.83193141]


portfolio before change:  [-1.35782977]
curr_Stock_Price:  96.32975798935894
curr_Factors:  [96.32975799]
mat_Sqrt:  [[0.15]]
grads:  [0.04829653]
Stock Position:  0.048296525504851875
Bond Position:  [-6.01022238]


portfolio before change:  [-1.33976594]
curr_Stock_Price:  96.71933365978713
curr_Factors:  [96.71933366]
mat_Sqrt:  [[0.15]]
grads:  [-0.06472217]
Stock Position:  -0.06472216873753425
Bond Position:  [4.92011909]


portfolio before change:  [-1.31255412]
curr_Stock_Price:  96.3083960758657
curr_Factors:  [96.30839608]
mat_Sqrt:  [[0.15]]
grads:  [0.05072124]
Stock Position:  0.050721237268752814
Bond Position:  [-6.19743513]


portfolio before change:  [-1.28738741]
curr_Stock_Price:  96.81984735354635
curr_Factors:  [96.81984735]
mat_Sqrt:  [[0.15]]
grads:  [0.09263079]
Stock Position:  0.09263078892036254
Bond Position:  [-10.25588625]


portfolio before change:  [-1.20294845]
curr_Stock_Price:  97.74525266057982
curr_Factors:  [97.74525266]
mat_Sqrt:  [[0.15]]
grads:  [0.01632462]
Stock Position:  0.016324618086721282
Bond Position:  [-2.79860237]


portfolio before change:  [-1.18770548]
curr_Stock_Price:  98.70042433324575
curr_Factors:  [98.70042433]
mat_Sqrt:  [[0.15]]
grads:  [0.04812583]
Stock Position:  0.04812582581066436
Bond Position:  [-5.93774491]


portfolio before change:  [-1.26109495]
curr_Stock_Price:  97.19089795569934
curr_Factors:  [97.19089796]
mat_Sqrt:  [[0.15]]
grads:  [-0.0304853]
Stock Position:  -0.030485301411350883
Bond Position:  [1.70179887]


portfolio before change:  [-1.24705638]
curr_Stock_Price:  96.73737356076315
curr_Factors:  [96.73737356]
mat_Sqrt:  [[0.15]]
grads:  [0.11879973]
Stock Position:  0.11879973351573661
Bond Position:  [-12.73943058]


portfolio before change:  [-1.31909172]
curr_Stock_Price:  96.14441927243026
curr_Factors:  [96.14441927]
mat_Sqrt:  [[0.15]]
grads:  [-0.12659149]
Stock Position:  -0.12659149392753938
Bond Position:  [10.85197394]


portfolio before change:  [-1.31767062]
curr_Stock_Price:  96.14390961287367
curr_Factors:  [96.14390961]
mat_Sqrt:  [[0.15]]
grads:  [0.02157163]
Stock Position:  0.02157162749153644
Bond Position:  [-3.39165123]


portfolio before change:  [-1.33464617]
curr_Stock_Price:  95.37662565031444
curr_Factors:  [95.37662565]
mat_Sqrt:  [[0.15]]
grads:  [0.0269786]
Stock Position:  0.026978599076428744
Bond Position:  [-3.90777392]


portfolio before change:  [-1.34436513]
curr_Stock_Price:  95.03448583680914
curr_Factors:  [95.03448584]
mat_Sqrt:  [[0.15]]
grads:  [0.16999492]
Stock Position:  0.1699949180758013
Bond Position:  [-17.49974476]


portfolio before change:  [-1.3499655]
curr_Stock_Price:  95.01441014713923
curr_Factors:  [95.01441015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00310024]
Stock Position:  -0.003100243318484355
Bond Position:  [-1.05539771]


portfolio before change:  [-1.34905432]
curr_Stock_Price:  94.67794858950795
curr_Factors:  [94.67794859]
mat_Sqrt:  [[0.15]]
grads:  [0.18966798]
Stock Position:  0.1896679797964817
Bond Position:  [-19.30642956]


portfolio before change:  [-1.51595459]
curr_Stock_Price:  93.81071301901649
curr_Factors:  [93.81071302]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367515]
Stock Position:  -0.0036751528477766554
Bond Position:  [-1.17118588]


portfolio before change:  [-1.51715014]
curr_Stock_Price:  94.09618320045952
curr_Factors:  [94.0961832]
mat_Sqrt:  [[0.15]]
grads:  [0.06837758]
Stock Position:  0.068377584596433
Bond Position:  [-7.95121987]


portfolio before change:  [-1.5003478]
curr_Stock_Price:  94.35644836827241
curr_Factors:  [94.35644837]
mat_Sqrt:  [[0.15]]
grads:  [0.07175999]
Stock Position:  0.0717599873506318
Bond Position:  [-8.27136535]


portfolio before change:  [-1.52355104]
curr_Stock_Price:  94.0475123043663
curr_Factors:  [94.0475123]
mat_Sqrt:  [[0.15]]
grads:  [0.20810425]
Stock Position:  0.20810424530266036
Bond Position:  [-21.09523761]


portfolio before change:  [-1.71972026]
curr_Stock_Price:  93.1175353389373
curr_Factors:  [93.11753534]
mat_Sqrt:  [[0.15]]
grads:  [-0.17999847]
Stock Position:  -0.17999846665829747
Bond Position:  [15.04129332]


portfolio before change:  [-1.72511888]
curr_Stock_Price:  93.1579740008617
curr_Factors:  [93.157974]
mat_Sqrt:  [[0.15]]
grads:  [-0.31502509]
Stock Position:  -0.315025091799069
Bond Position:  [27.62198043]


portfolio before change:  [-1.43267977]
curr_Stock_Price:  92.2406307245273
curr_Factors:  [92.24063072]
mat_Sqrt:  [[0.15]]
grads:  [0.02103163]
Stock Position:  0.021031631982740447
Bond Position:  [-3.37265077]


portfolio before change:  [-1.45275469]
curr_Stock_Price:  91.30616615278439
curr_Factors:  [91.30616615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02828457]
Stock Position:  -0.028284567680474684
Bond Position:  [1.12980075]


portfolio before change:  [-1.46518413]
curr_Stock_Price:  91.7506019014989
curr_Factors:  [91.7506019]
mat_Sqrt:  [[0.15]]
grads:  [0.0372813]
Stock Position:  0.037281298858283254
Bond Position:  [-4.88576574]


portfolio before change:  [-1.43232243]
curr_Stock_Price:  92.64843695748127
curr_Factors:  [92.64843696]
mat_Sqrt:  [[0.15]]
grads:  [0.13628105]
Stock Position:  0.13628104603391655
Bond Position:  [-14.05854833]


portfolio before change:  [-1.55213048]
curr_Stock_Price:  91.78220777483955
curr_Factors:  [91.78220777]
mat_Sqrt:  [[0.15]]
grads:  [-0.10746869]
Stock Position:  -0.10746868572283172
Bond Position:  [8.31158276]


portfolio before change:  [-1.48489122]
curr_Stock_Price:  91.16621206318189
curr_Factors:  [91.16621206]
mat_Sqrt:  [[0.15]]
grads:  [0.03957311]
Stock Position:  0.03957310679868799
Bond Position:  [-5.09262146]


portfolio before change:  [-1.49329792]
curr_Stock_Price:  90.96986451385608
curr_Factors:  [90.96986451]
mat_Sqrt:  [[0.15]]
grads:  [0.02000827]
Stock Position:  0.020008273743950276
Bond Position:  [-3.31344787]


portfolio before change:  [-1.49420319]
curr_Stock_Price:  90.94532132696948
curr_Factors:  [90.94532133]
mat_Sqrt:  [[0.15]]
grads:  [0.07274012]
Stock Position:  0.07274012266923985
Bond Position:  [-8.10957702]


portfolio before change:  [-1.5314939]
curr_Stock_Price:  90.44660141089442
curr_Factors:  [90.44660141]
mat_Sqrt:  [[0.15]]
grads:  [0.03957436]
Stock Position:  0.039574359709838525
Bond Position:  [-5.11086024]


portfolio before change:  [-1.5922204]
curr_Stock_Price:  88.92825447192554
curr_Factors:  [88.92825447]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.5922204]
Stock Price:  89.46994408894584
PL:  [-1.5922204]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.58901556e-03]
 [ 2.95742085e-05]
 [ 9.28731185e-03]
 [-2.36072595e-03]
 [ 1.41647756e-02]
 [ 2.96699722e-02]
 [ 5.10664632e-02]
 [-9.02539128e-03]
 [-1.34925459e-02]
 [-1.55153737e-04]
 [ 3.18043931e-02]
 [ 9.91804443e-03]
 [-2.55918514e-03]
 [-4.28815309e-03]
 [-1.05922772e-03]
 [ 3.54021823e-03]
 [ 9.12036410e-03]
 [ 8.61497799e-03]
 [ 1.16467825e-02]
 [-1.52434732e-02]
 [ 1.46791420e-03]
 [ 3.39911893e-02]
 [-1.42984280e-02]
 [ 7.60217043e-03]
 [ 7.65896584e-03]
 [-2.50207053e-02]
 [ 1.23498960e-03]
 [-1.48214862e-02]
 [ 7.18555883e-02]
 [-1.27161711e-03]
 [-1.63862562e-02]
 [ 3.76277307e-03]
 [ 7.70111851e-03]
 [ 6.84605225e-03]
 [ 8.19503135e-03]
 [ 2.45386132e-03]
 [-5.18896947e-02]
 [ 9.55493976e-03]
 [-8.56122042e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.41871309]
curr_Stock_Price:  100.6751873950928
curr_Factors:  [100.6751874]
mat_Sqrt:  [[0.15]]
grads:  [0.0372601]
Stock Position:  0.0372601037555563
Bond Position:  [8.66754516]


portfolio before change:  [12.44187287]
curr_Stock_Price:  101.26767821986095
curr_Factors:  [101.26767822]
mat_Sqrt:  [[0.15]]
grads:  [0.00019716]
Stock Position:  0.0001971613902116212
Bond Position:  [12.42190679]


portfolio before change:  [12.44324689]
curr_Stock_Price:  100.36070865604276
curr_Factors:  [100.36070866]
mat_Sqrt:  [[0.15]]
grads:  [0.06191541]
Stock Position:  0.061915412325618285
Bond Position:  [6.22937223]


portfolio before change:  [12.40244951]
curr_Stock_Price:  99.68921039519448
curr_Factors:  [99.6892104]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573817]
Stock Position:  -0.015738172995231874
Bond Position:  [13.97137555]


portfolio before change:  [12.37610821]
curr_Stock_Price:  101.47390535307032
curr_Factors:  [101.47390535]
mat_Sqrt:  [[0.15]]
grads:  [0.09443184]
Stock Position:  0.09443183756007582
Bond Position:  [2.79374086]


portfolio before change:  [12.47911969]
curr_Stock_Price:  102.56106242552478
curr_Factors:  [102.56106243]
mat_Sqrt:  [[0.15]]
grads:  [0.19779981]
Stock Position:  0.1977998144712949
Bond Position:  [-7.80743943]


portfolio before change:  [12.83445687]
curr_Stock_Price:  104.36244518293286
curr_Factors:  [104.36244518]
mat_Sqrt:  [[0.15]]
grads:  [0.34044309]
Stock Position:  0.34044308801442846
Bond Position:  [-22.69501624]


portfolio before change:  [13.13163071]
curr_Stock_Price:  105.24368172934487
curr_Factors:  [105.24368173]
mat_Sqrt:  [[0.15]]
grads:  [-0.06016928]
Stock Position:  -0.06016927519910328
Bond Position:  [19.46406676]


portfolio before change:  [13.14379489]
curr_Stock_Price:  105.08195429248597
curr_Factors:  [105.08195429]
mat_Sqrt:  [[0.15]]
grads:  [-0.08995031]
Stock Position:  -0.08995030629649203
Bond Position:  [22.59594887]


portfolio before change:  [13.09622127]
curr_Stock_Price:  105.64224469474796
curr_Factors:  [105.64224469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00103436]
Stock Position:  -0.0010343582461263378
Bond Position:  [13.20549319]


portfolio before change:  [13.09774976]
curr_Stock_Price:  105.76047660991667
curr_Factors:  [105.76047661]
mat_Sqrt:  [[0.15]]
grads:  [0.21202929]
Stock Position:  0.21202928709464883
Bond Position:  [-9.32656869]


portfolio before change:  [13.00087913]
curr_Stock_Price:  105.3091015138814
curr_Factors:  [105.30910151]
mat_Sqrt:  [[0.15]]
grads:  [0.0661203]
Stock Position:  0.06612029620695907
Bond Position:  [6.03781014]


portfolio before change:  [13.02197519]
curr_Stock_Price:  105.61674205793823
curr_Factors:  [105.61674206]
mat_Sqrt:  [[0.15]]
grads:  [-0.01706123]
Stock Position:  -0.01706123426274043
Bond Position:  [14.82392717]


portfolio before change:  [13.03305662]
curr_Stock_Price:  105.07584788927592
curr_Factors:  [105.07584789]
mat_Sqrt:  [[0.15]]
grads:  [-0.02858769]
Stock Position:  -0.02858768729732794
Bond Position:  [16.0369321]


portfolio before change:  [13.031785]
curr_Stock_Price:  105.1904552022953
curr_Factors:  [105.1904552]
mat_Sqrt:  [[0.15]]
grads:  [-0.00706152]
Stock Position:  -0.00706151810771836
Bond Position:  [13.7745893]


portfolio before change:  [13.04098129]
curr_Stock_Price:  104.13199208152307
curr_Factors:  [104.13199208]
mat_Sqrt:  [[0.15]]
grads:  [0.02360145]
Stock Position:  0.023601454884979035
Bond Position:  [10.58331477]


portfolio before change:  [13.03280833]
curr_Stock_Price:  103.72964599430259
curr_Factors:  [103.72964599]
mat_Sqrt:  [[0.15]]
grads:  [0.06080243]
Stock Position:  0.060802427344953405
Bond Position:  [6.72579407]


portfolio before change:  [13.00946498]
curr_Stock_Price:  103.33189654914588
curr_Factors:  [103.33189655]
mat_Sqrt:  [[0.15]]
grads:  [0.05743319]
Stock Position:  0.057433186616625186
Bond Position:  [7.07478488]


portfolio before change:  [12.98934934]
curr_Stock_Price:  102.96625358762223
curr_Factors:  [102.96625359]
mat_Sqrt:  [[0.15]]
grads:  [0.07764522]
Stock Position:  0.07764521689150587
Bond Position:  [4.99451225]


portfolio before change:  [12.99995934]
curr_Stock_Price:  103.09485971151713
curr_Factors:  [103.09485971]
mat_Sqrt:  [[0.15]]
grads:  [-0.10162315]
Stock Position:  -0.10162315474437458
Bond Position:  [23.47678422]


portfolio before change:  [12.99509169]
curr_Stock_Price:  103.17163786317893
curr_Factors:  [103.17163786]
mat_Sqrt:  [[0.15]]
grads:  [0.00978609]
Stock Position:  0.009786094649031792
Bond Position:  [11.98544427]


portfolio before change:  [13.006279]
curr_Stock_Price:  104.1617196806483
curr_Factors:  [104.16171968]
mat_Sqrt:  [[0.15]]
grads:  [0.22660793]
Stock Position:  0.22660792897547297
Bond Position:  [-10.59759258]


portfolio before change:  [13.13330356]
curr_Stock_Price:  104.72811357917602
curr_Factors:  [104.72811358]
mat_Sqrt:  [[0.15]]
grads:  [-0.09532285]
Stock Position:  -0.09532285320638471
Bond Position:  [23.11628616]


portfolio before change:  [13.03261188]
curr_Stock_Price:  105.81475114559557
curr_Factors:  [105.81475115]
mat_Sqrt:  [[0.15]]
grads:  [0.05068114]
Stock Position:  0.05068113617021679
Bond Position:  [7.66980007]


portfolio before change:  [13.03790178]
curr_Stock_Price:  105.90020919870689
curr_Factors:  [105.9002092]
mat_Sqrt:  [[0.15]]
grads:  [0.05105977]
Stock Position:  0.05105977229418842
Bond Position:  [7.63066121]


portfolio before change:  [13.09775351]
curr_Stock_Price:  107.05371679409568
curr_Factors:  [107.05371679]
mat_Sqrt:  [[0.15]]
grads:  [-0.1668047]
Stock Position:  -0.16680470213929763
Bond Position:  [30.95481685]


portfolio before change:  [13.06399941]
curr_Stock_Price:  107.27927215443702
curr_Factors:  [107.27927215]
mat_Sqrt:  [[0.15]]
grads:  [0.00823326]
Stock Position:  0.008233263988781995
Bond Position:  [12.18074084]


portfolio before change:  [13.06831041]
curr_Stock_Price:  107.61793722672996
curr_Factors:  [107.61793723]
mat_Sqrt:  [[0.15]]
grads:  [-0.09880991]
Stock Position:  -0.09880990808569086
Bond Position:  [23.7020289]


portfolio before change:  [13.07086926]
curr_Stock_Price:  107.62202681616638
curr_Factors:  [107.62202682]
mat_Sqrt:  [[0.15]]
grads:  [0.47903726]
Stock Position:  0.47903725559694654
Bond Position:  [-38.48409111]


portfolio before change:  [13.75316582]
curr_Stock_Price:  109.05637741070218
curr_Factors:  [109.05637741]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847745]
Stock Position:  -0.008477447392723401
Bond Position:  [14.67768552]


portfolio before change:  [13.7579701]
curr_Stock_Price:  108.70610103917467
curr_Factors:  [108.70610104]
mat_Sqrt:  [[0.15]]
grads:  [-0.10924171]
Stock Position:  -0.10924170806381403
Bond Position:  [25.63321025]


portfolio before change:  [13.73734772]
curr_Stock_Price:  108.92421122401778
curr_Factors:  [108.92421122]
mat_Sqrt:  [[0.15]]
grads:  [0.02508515]
Stock Position:  0.025085153802213253
Bond Position:  [11.00496713]


portfolio before change:  [13.74616503]
curr_Stock_Price:  109.22086494019304
curr_Factors:  [109.22086494]
mat_Sqrt:  [[0.15]]
grads:  [0.05134079]
Stock Position:  0.0513407900746807
Bond Position:  [8.13867953]


portfolio before change:  [13.75052013]
curr_Stock_Price:  109.2858755683636
curr_Factors:  [109.28587557]
mat_Sqrt:  [[0.15]]
grads:  [0.04564035]
Stock Position:  0.045640348323709924
Bond Position:  [8.7626747]


portfolio before change:  [13.70817446]
curr_Stock_Price:  108.33406275866406
curr_Factors:  [108.33406276]
mat_Sqrt:  [[0.15]]
grads:  [0.05463354]
Stock Position:  0.05463354231324482
Bond Position:  [7.78950086]


portfolio before change:  [13.7571114]
curr_Stock_Price:  109.21197017241558
curr_Factors:  [109.21197017]
mat_Sqrt:  [[0.15]]
grads:  [0.01635908]
Stock Position:  0.016359075467997048
Bond Position:  [11.97050454]


portfolio before change:  [13.72834552]
curr_Stock_Price:  107.3620924420206
curr_Factors:  [107.36209244]
mat_Sqrt:  [[0.15]]
grads:  [-0.3459313]
Stock Position:  -0.34593129772550235
Bond Position:  [50.86825348]


portfolio before change:  [13.84113404]
curr_Stock_Price:  107.05443136653723
curr_Factors:  [107.05443137]
mat_Sqrt:  [[0.15]]
grads:  [0.0636996]
Stock Position:  0.0636995983917833
Bond Position:  [7.02180976]


portfolio before change:  [13.77237862]
curr_Stock_Price:  105.96128160166496
curr_Factors:  [105.9612816]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.77237862]
Stock Price:  107.08824641652384
PL:  [6.68413221]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.01553365e-03]
 [-1.11427365e-02]
 [-2.02072314e-02]
 [ 8.77078367e-03]
 [-7.82346071e-02]
 [-3.29962449e-02]
 [-4.05234166e-02]
 [ 1.21296329e-02]
 [-6.50440484e-03]
 [ 1.48756043e-02]
 [-4.80535518e-03]
 [ 7.59676838e-03]
 [ 1.38988256e-02]
 [ 1.43115180e-03]
 [-5.63874447e-03]
 [-8.86432709e-03]
 [ 2.17458218e-02]
 [-2.48226674e-02]
 [ 9.44127983e-04]
 [ 3.61005069e-03]
 [ 2.71617856e-02]
 [ 1.64343270e-03]
 [ 4.46311311e-02]
 [-2.13183345e-03]
 [ 9.78641171e-03]
 [ 7.87339680e-03]
 [ 3.00752342e-02]
 [-2.51453819e-02]
 [-4.74596597e-02]
 [ 1.82090286e-03]
 [-4.36601786e-03]
 [ 5.58570984e-03]
 [ 1.56684549e-02]
 [-1.40195203e-02]
 [ 2.94488052e-03]
 [ 5.59358835e-03]
 [ 3.61948080e-03]
 [ 1.17420809e-02]
 [-3.84758366e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.4549111]
curr_Stock_Price:  99.58668054336563
curr_Factors:  [99.58668054]
mat_Sqrt:  [[0.15]]
grads:  [0.02677022]
Stock Position:  0.026770224349826056
Bond Position:  [-7.12086888]


portfolio before change:  [-4.47872886]
curr_Stock_Price:  98.73022192799918
curr_Factors:  [98.73022193]
mat_Sqrt:  [[0.15]]
grads:  [-0.07428491]
Stock Position:  -0.07428490974956621
Bond Position:  [2.85543677]


portfolio before change:  [-4.42470989]
curr_Stock_Price:  98.007840810197
curr_Factors:  [98.00784081]
mat_Sqrt:  [[0.15]]
grads:  [-0.13471488]
Stock Position:  -0.13471487629168274
Bond Position:  [8.77840426]


portfolio before change:  [-4.30210734]
curr_Stock_Price:  97.10589752096371
curr_Factors:  [97.10589752]
mat_Sqrt:  [[0.15]]
grads:  [0.05847189]
Stock Position:  0.058471891161527255
Bond Position:  [-9.98007281]


portfolio before change:  [-4.34364929]
curr_Stock_Price:  96.4167739020515
curr_Factors:  [96.4167739]
mat_Sqrt:  [[0.15]]
grads:  [-0.52156405]
Stock Position:  -0.5215640476280355
Bond Position:  [45.94387357]


portfolio before change:  [-4.53653742]
curr_Stock_Price:  96.79761201705166
curr_Factors:  [96.79761202]
mat_Sqrt:  [[0.15]]
grads:  [-0.21997497]
Stock Position:  -0.2199749658640801
Bond Position:  [16.75651398]


portfolio before change:  [-4.55976851]
curr_Stock_Price:  96.9127423450054
curr_Factors:  [96.91274235]
mat_Sqrt:  [[0.15]]
grads:  [-0.27015611]
Stock Position:  -0.27015611093666825
Bond Position:  [21.62180106]


portfolio before change:  [-4.45280708]
curr_Stock_Price:  96.5268227392411
curr_Factors:  [96.52682274]
mat_Sqrt:  [[0.15]]
grads:  [0.08086422]
Stock Position:  0.08086421905936436
Bond Position:  [-12.25837322]


portfolio before change:  [-4.47151027]
curr_Stock_Price:  96.31448157602834
curr_Factors:  [96.31448158]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433627]
Stock Position:  -0.043362698906010654
Bond Position:  [-0.29505441]


portfolio before change:  [-4.42799564]
curr_Stock_Price:  95.31012726173374
curr_Factors:  [95.31012726]
mat_Sqrt:  [[0.15]]
grads:  [0.0991707]
Stock Position:  0.09917069518393064
Bond Position:  [-13.87996722]


portfolio before change:  [-4.18621951]
curr_Stock_Price:  97.76560301612938
curr_Factors:  [97.76560302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0320357]
Stock Position:  -0.03203570120851543
Bond Position:  [-1.05422986]


portfolio before change:  [-4.14412943]
curr_Stock_Price:  96.44764020706364
curr_Factors:  [96.44764021]
mat_Sqrt:  [[0.15]]
grads:  [0.05064512]
Stock Position:  0.05064512250023148
Bond Position:  [-9.02873199]


portfolio before change:  [-4.11196297]
curr_Stock_Price:  97.10506032800777
curr_Factors:  [97.10506033]
mat_Sqrt:  [[0.15]]
grads:  [0.09265884]
Stock Position:  0.09265883764912274
Bond Position:  [-13.10960499]


portfolio before change:  [-4.11628766]
curr_Stock_Price:  97.07607349900796
curr_Factors:  [97.0760735]
mat_Sqrt:  [[0.15]]
grads:  [0.00954101]
Stock Position:  0.009541011999399912
Bond Position:  [-5.04249164]


portfolio before change:  [-4.12930827]
curr_Stock_Price:  95.77744165740985
curr_Factors:  [95.77744166]
mat_Sqrt:  [[0.15]]
grads:  [-0.03759163]
Stock Position:  -0.03759162980661263
Bond Position:  [-0.52887814]


portfolio before change:  [-4.12249802]
curr_Stock_Price:  95.59451889597172
curr_Factors:  [95.5945189]
mat_Sqrt:  [[0.15]]
grads:  [-0.05909551]
Stock Position:  -0.05909551393676424
Bond Position:  [1.5267092]


portfolio before change:  [-4.09980804]
curr_Stock_Price:  95.2137940915412
curr_Factors:  [95.21379409]
mat_Sqrt:  [[0.15]]
grads:  [0.14497215]
Stock Position:  0.14497214519587642
Bond Position:  [-17.90315603]


portfolio before change:  [-4.03511062]
curr_Stock_Price:  95.67550662410162
curr_Factors:  [95.67550662]
mat_Sqrt:  [[0.15]]
grads:  [-0.16548445]
Stock Position:  -0.16548444947924135
Bond Position:  [11.79769792]


portfolio before change:  [-3.85029811]
curr_Stock_Price:  94.56762179358614
curr_Factors:  [94.56762179]
mat_Sqrt:  [[0.15]]
grads:  [0.00629419]
Stock Position:  0.006294186553525531
Bond Position:  [-4.44552436]


portfolio before change:  [-3.84503338]
curr_Stock_Price:  95.49235619774913
curr_Factors:  [95.4923562]
mat_Sqrt:  [[0.15]]
grads:  [0.024067]
Stock Position:  0.02406700461784969
Bond Position:  [-6.14324836]


portfolio before change:  [-3.87318078]
curr_Stock_Price:  94.35472211982557
curr_Factors:  [94.35472212]
mat_Sqrt:  [[0.15]]
grads:  [0.18107857]
Stock Position:  0.1810785705808705
Bond Position:  [-20.95879899]


portfolio before change:  [-4.04989769]
curr_Stock_Price:  93.39327817032795
curr_Factors:  [93.39327817]
mat_Sqrt:  [[0.15]]
grads:  [0.01095622]
Stock Position:  0.01095621796709517
Bond Position:  [-5.0731348]


portfolio before change:  [-4.05878623]
curr_Stock_Price:  92.63988330419983
curr_Factors:  [92.6398833]
mat_Sqrt:  [[0.15]]
grads:  [0.29754087]
Stock Position:  0.2975408738376357
Bond Position:  [-31.62293806]


portfolio before change:  [-3.9542633]
curr_Stock_Price:  93.00445856579567
curr_Factors:  [93.00445857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01421222]
Stock Position:  -0.014212222984712995
Bond Position:  [-2.6324632]


portfolio before change:  [-3.96678167]
curr_Stock_Price:  93.86212122016903
curr_Factors:  [93.86212122]
mat_Sqrt:  [[0.15]]
grads:  [0.06524274]
Stock Position:  0.06524274475775457
Bond Position:  [-10.09060409]


portfolio before change:  [-3.91456599]
curr_Stock_Price:  94.68178457354036
curr_Factors:  [94.68178457]
mat_Sqrt:  [[0.15]]
grads:  [0.05248931]
Stock Position:  0.05248931201765411
Bond Position:  [-8.88434772]


portfolio before change:  [-3.93290378]
curr_Stock_Price:  94.35358114149221
curr_Factors:  [94.35358114]
mat_Sqrt:  [[0.15]]
grads:  [0.20050156]
Stock Position:  0.20050156163068086
Bond Position:  [-22.85094414]


portfolio before change:  [-3.9823835]
curr_Stock_Price:  94.12104839760654
curr_Factors:  [94.1210484]
mat_Sqrt:  [[0.15]]
grads:  [-0.16763588]
Stock Position:  -0.16763587946709327
Bond Position:  [11.79568122]


portfolio before change:  [-4.03348446]
curr_Stock_Price:  94.43467759784045
curr_Factors:  [94.4346776]
mat_Sqrt:  [[0.15]]
grads:  [-0.31639773]
Stock Position:  -0.31639773123985093
Bond Position:  [25.84543329]


portfolio before change:  [-4.19052118]
curr_Stock_Price:  94.94121601608711
curr_Factors:  [94.94121602]
mat_Sqrt:  [[0.15]]
grads:  [0.01213935]
Stock Position:  0.012139352430731502
Bond Position:  [-5.34304606]


portfolio before change:  [-4.19716069]
curr_Stock_Price:  94.44929646454106
curr_Factors:  [94.44929646]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910679]
Stock Position:  -0.02910678573916056
Bond Position:  [-1.44804525]


portfolio before change:  [-4.19134747]
curr_Stock_Price:  94.24335708963451
curr_Factors:  [94.24335709]
mat_Sqrt:  [[0.15]]
grads:  [0.03723807]
Stock Position:  0.03723806557685125
Bond Position:  [-7.70078778]


portfolio before change:  [-4.17405725]
curr_Stock_Price:  94.7335244427657
curr_Factors:  [94.73352444]
mat_Sqrt:  [[0.15]]
grads:  [0.10445637]
Stock Position:  0.10445636572430496
Bond Position:  [-14.06957692]


portfolio before change:  [-4.2368368]
curr_Stock_Price:  94.149349889082
curr_Factors:  [94.14934989]
mat_Sqrt:  [[0.15]]
grads:  [-0.09346347]
Stock Position:  -0.09346346894405412
Bond Position:  [4.56268804]


portfolio before change:  [-4.40567626]
curr_Stock_Price:  95.96192788221603
curr_Factors:  [95.96192788]
mat_Sqrt:  [[0.15]]
grads:  [0.01963254]
Stock Position:  0.019632536780686972
Bond Position:  [-6.28965234]


portfolio before change:  [-4.40662942]
curr_Stock_Price:  95.95342666580548
curr_Factors:  [95.95342667]
mat_Sqrt:  [[0.15]]
grads:  [0.03729059]
Stock Position:  0.03729058896985851
Bond Position:  [-7.98478921]


portfolio before change:  [-4.36748376]
curr_Stock_Price:  97.02994010344753
curr_Factors:  [97.0299401]
mat_Sqrt:  [[0.15]]
grads:  [0.02412987]
Stock Position:  0.02412987198934653
Bond Position:  [-6.70880379]


portfolio before change:  [-4.36457678]
curr_Stock_Price:  97.18516790589327
curr_Factors:  [97.18516791]
mat_Sqrt:  [[0.15]]
grads:  [0.07828054]
Stock Position:  0.07828053955105567
Bond Position:  [-11.97228416]


portfolio before change:  [-4.46343499]
curr_Stock_Price:  95.94141592318783
curr_Factors:  [95.94141592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.46343499]
Stock Price:  96.20494904126522
PL:  [-4.46343499]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.07718439e-03]
 [ 4.64822027e-03]
 [ 6.37716232e-03]
 [-1.13874651e-03]
 [ 5.26051058e-03]
 [-9.24896521e-05]
 [ 5.93204953e-05]
 [ 1.96790069e-02]
 [-6.68247076e-03]
 [-3.23150293e-04]
 [ 9.15599345e-03]
 [ 6.69310649e-03]
 [ 1.38162876e-02]
 [ 5.25220924e-03]
 [ 1.00501708e-02]
 [-3.28830379e-03]
 [ 1.43056266e-02]
 [-1.71515205e-02]
 [ 3.74010594e-03]
 [ 1.31600866e-03]
 [ 2.35535157e-02]
 [-7.85966948e-04]
 [ 2.53887032e-02]
 [ 1.36169211e-03]
 [ 1.20473138e-02]
 [ 6.44709223e-03]
 [ 2.75692963e-02]
 [-2.38467315e-02]
 [-4.75944172e-02]
 [ 2.14437422e-03]
 [-4.47126272e-03]
 [ 5.58630444e-03]
 [ 1.62413699e-02]
 [-1.33927068e-02]
 [ 4.18401337e-03]
 [ 4.98016385e-03]
 [ 6.34161543e-03]
 [ 9.56208379e-03]
 [-7.49022738e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.31226997]
curr_Stock_Price:  100.53930207861985
curr_Factors:  [100.53930208]
mat_Sqrt:  [[0.15]]
grads:  [0.04051456]
Stock Position:  0.04051456256930787
Bond Position:  [6.23896413]


portfolio before change:  [10.30335892]
curr_Stock_Price:  100.30010485795052
curr_Factors:  [100.30010486]
mat_Sqrt:  [[0.15]]
grads:  [0.03098814]
Stock Position:  0.03098813513020942
Bond Position:  [7.19524572]


portfolio before change:  [10.28916116]
curr_Stock_Price:  99.8129110129672
curr_Factors:  [99.81291101]
mat_Sqrt:  [[0.15]]
grads:  [0.04251442]
Stock Position:  0.042514415435470694
Bond Position:  [6.04567359]


portfolio before change:  [10.25250871]
curr_Stock_Price:  98.93301641424
curr_Factors:  [98.93301641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759164]
Stock Position:  -0.007591643403599647
Bond Position:  [11.00357289]


portfolio before change:  [10.25219991]
curr_Stock_Price:  99.15488344425651
curr_Factors:  [99.15488344]
mat_Sqrt:  [[0.15]]
grads:  [0.03507007]
Stock Position:  0.03507007054645468
Bond Position:  [6.77483115]


portfolio before change:  [10.26104845]
curr_Stock_Price:  99.38304503087343
curr_Factors:  [99.38304503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006166]
Stock Position:  -0.0006165976803425404
Bond Position:  [10.32232781]


portfolio before change:  [10.26176642]
curr_Stock_Price:  100.31137373996003
curr_Factors:  [100.31137374]
mat_Sqrt:  [[0.15]]
grads:  [0.00039547]
Stock Position:  0.00039546996849971463
Bond Position:  [10.22209629]


portfolio before change:  [10.26308599]
curr_Stock_Price:  100.4168942393348
curr_Factors:  [100.41689424]
mat_Sqrt:  [[0.15]]
grads:  [0.13119338]
Stock Position:  0.13119337940773992
Bond Position:  [-2.91094571]


portfolio before change:  [10.32640102]
curr_Stock_Price:  100.90227633428132
curr_Factors:  [100.90227633]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454981]
Stock Position:  -0.04454980504956528
Bond Position:  [14.82157776]


portfolio before change:  [10.32979072]
curr_Stock_Price:  100.86777808396276
curr_Factors:  [100.86777808]
mat_Sqrt:  [[0.15]]
grads:  [-0.00215434]
Stock Position:  -0.00215433528824151
Bond Position:  [10.54709374]


portfolio before change:  [10.3322789]
curr_Stock_Price:  100.32482380253127
curr_Factors:  [100.3248238]
mat_Sqrt:  [[0.15]]
grads:  [0.06103996]
Stock Position:  0.06103995631345652
Bond Position:  [4.20845604]


portfolio before change:  [10.23754659]
curr_Stock_Price:  98.76423292527922
curr_Factors:  [98.76423293]
mat_Sqrt:  [[0.15]]
grads:  [0.04462071]
Stock Position:  0.04462070994679777
Bond Position:  [5.8306164]


portfolio before change:  [10.24564281]
curr_Stock_Price:  98.9293435373195
curr_Factors:  [98.92934354]
mat_Sqrt:  [[0.15]]
grads:  [0.09210858]
Stock Position:  0.09210858406389234
Bond Position:  [1.13340106]


portfolio before change:  [10.31713916]
curr_Stock_Price:  99.70402340777592
curr_Factors:  [99.70402341]
mat_Sqrt:  [[0.15]]
grads:  [0.03501473]
Stock Position:  0.03501472824715804
Bond Position:  [6.82602988]


portfolio before change:  [10.29772468]
curr_Stock_Price:  99.12518737895762
curr_Factors:  [99.12518738]
mat_Sqrt:  [[0.15]]
grads:  [0.06700114]
Stock Position:  0.06700113850314111
Bond Position:  [3.65622428]


portfolio before change:  [10.2808541]
curr_Stock_Price:  98.86657023571999
curr_Factors:  [98.86657024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02192203]
Stock Position:  -0.021922025277196392
Bond Position:  [12.44820955]


portfolio before change:  [10.29925767]
curr_Stock_Price:  98.0980531237094
curr_Factors:  [98.09805312]
mat_Sqrt:  [[0.15]]
grads:  [0.09537084]
Stock Position:  0.0953708441683567
Bond Position:  [0.94356354]


portfolio before change:  [10.12593277]
curr_Stock_Price:  96.27943803157206
curr_Factors:  [96.27943803]
mat_Sqrt:  [[0.15]]
grads:  [-0.11434347]
Stock Position:  -0.1143434699273403
Bond Position:  [21.1348578]


portfolio before change:  [10.10946091]
curr_Stock_Price:  96.44660000761594
curr_Factors:  [96.44660001]
mat_Sqrt:  [[0.15]]
grads:  [0.02493404]
Stock Position:  0.024934039602782558
Bond Position:  [7.70465757]


portfolio before change:  [10.10178813]
curr_Stock_Price:  96.10024932772852
curr_Factors:  [96.10024933]
mat_Sqrt:  [[0.15]]
grads:  [0.00877339]
Stock Position:  0.00877339106560136
Bond Position:  [9.25866306]


portfolio before change:  [10.1005748]
curr_Stock_Price:  95.83003056192487
curr_Factors:  [95.83003056]
mat_Sqrt:  [[0.15]]
grads:  [0.15702344]
Stock Position:  0.15702343833199822
Bond Position:  [-4.94698609]


portfolio before change:  [9.98589559]
curr_Stock_Price:  95.10363708198591
curr_Factors:  [95.10363708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523978]
Stock Position:  -0.005239779654671282
Bond Position:  [10.48421769]


portfolio before change:  [9.98378678]
curr_Stock_Price:  95.75622599532251
curr_Factors:  [95.756226]
mat_Sqrt:  [[0.15]]
grads:  [0.16925802]
Stock Position:  0.16925802144909036
Bond Position:  [-6.22372258]


portfolio before change:  [9.82103934]
curr_Stock_Price:  94.79928803749861
curr_Factors:  [94.79928804]
mat_Sqrt:  [[0.15]]
grads:  [0.00907795]
Stock Position:  0.009077947371169341
Bond Position:  [8.96045639]


portfolio before change:  [9.82386821]
curr_Stock_Price:  94.98751888882101
curr_Factors:  [94.98751889]
mat_Sqrt:  [[0.15]]
grads:  [0.08031543]
Stock Position:  0.08031542525745644
Bond Position:  [2.19490524]


portfolio before change:  [9.81248046]
curr_Stock_Price:  94.84231467356523
curr_Factors:  [94.84231467]
mat_Sqrt:  [[0.15]]
grads:  [0.04298061]
Stock Position:  0.04298061489554395
Bond Position:  [5.73609945]


portfolio before change:  [9.8191918]
curr_Stock_Price:  94.98177961910437
curr_Factors:  [94.98177962]
mat_Sqrt:  [[0.15]]
grads:  [0.18379531]
Stock Position:  0.18379530840927616
Bond Position:  [-7.63801368]


portfolio before change:  [9.78920489]
curr_Stock_Price:  94.8238207586507
curr_Factors:  [94.82382076]
mat_Sqrt:  [[0.15]]
grads:  [-0.15897821]
Stock Position:  -0.15897820977966656
Bond Position:  [24.86412616]


portfolio before change:  [9.72133713]
curr_Stock_Price:  95.27027167917677
curr_Factors:  [95.27027168]
mat_Sqrt:  [[0.15]]
grads:  [-0.31729611]
Stock Position:  -0.31729611469803104
Bond Position:  [39.95022418]


portfolio before change:  [10.03854341]
curr_Stock_Price:  94.28629434034004
curr_Factors:  [94.28629434]
mat_Sqrt:  [[0.15]]
grads:  [0.01429583]
Stock Position:  0.014295828156054685
Bond Position:  [8.69064275]


portfolio before change:  [10.03107385]
curr_Stock_Price:  93.68780083061328
curr_Factors:  [93.68780083]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980842]
Stock Position:  -0.02980841815795372
Bond Position:  [12.82375899]


portfolio before change:  [10.02292964]
curr_Stock_Price:  94.01479834081543
curr_Factors:  [94.01479834]
mat_Sqrt:  [[0.15]]
grads:  [0.03724203]
Stock Position:  0.03724202960218294
Bond Position:  [6.52162774]


portfolio before change:  [10.04148387]
curr_Stock_Price:  94.49111430683436
curr_Factors:  [94.49111431]
mat_Sqrt:  [[0.15]]
grads:  [0.1082758]
Stock Position:  0.10827579945859775
Bond Position:  [-0.18961707]


portfolio before change:  [10.08465626]
curr_Stock_Price:  94.89005937259343
curr_Factors:  [94.89005937]
mat_Sqrt:  [[0.15]]
grads:  [-0.08928471]
Stock Position:  -0.08928471193184455
Bond Position:  [18.55688788]


portfolio before change:  [10.16866065]
curr_Stock_Price:  93.97518126540511
curr_Factors:  [93.97518127]
mat_Sqrt:  [[0.15]]
grads:  [0.02789342]
Stock Position:  0.027893422436860816
Bond Position:  [7.54737122]


portfolio before change:  [10.15992613]
curr_Stock_Price:  93.62821780403968
curr_Factors:  [93.6282178]
mat_Sqrt:  [[0.15]]
grads:  [0.03320109]
Stock Position:  0.03320109236648368
Bond Position:  [7.05136702]


portfolio before change:  [10.16948347]
curr_Stock_Price:  93.88953034590989
curr_Factors:  [93.88953035]
mat_Sqrt:  [[0.15]]
grads:  [0.04227744]
Stock Position:  0.042277436175545954
Bond Position:  [6.20007484]


portfolio before change:  [10.18495085]
curr_Stock_Price:  94.23705213452148
curr_Factors:  [94.23705213]
mat_Sqrt:  [[0.15]]
grads:  [0.06374723]
Stock Position:  0.0637472252581512
Bond Position:  [4.17760026]


portfolio before change:  [10.04756704]
curr_Stock_Price:  92.07372587014386
curr_Factors:  [92.07372587]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.04756704]
Stock Price:  91.5436621644451
PL:  [10.04756704]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.79757395e-03]
 [ 3.54856910e-03]
 [ 9.34431864e-03]
 [-2.46885124e-03]
 [-3.73281653e-04]
 [ 7.81980312e-03]
 [-2.56071947e-02]
 [ 2.21910569e-02]
 [-5.84546488e-03]
 [ 3.55105186e-03]
 [ 2.56815373e-03]
 [ 7.17181319e-03]
 [ 1.42906229e-02]
 [ 2.62543650e-03]
 [ 1.60602105e-02]
 [-3.20023397e-03]
 [ 9.35934253e-03]
 [ 1.26990600e-02]
 [ 1.13773725e-02]
 [-1.26702346e-02]
 [ 5.93480412e-03]
 [ 1.60103665e-02]
 [ 1.51332198e-02]
 [ 5.21386272e-03]
 [ 1.24792042e-02]
 [-1.10241289e-02]
 [ 1.57088506e-02]
 [-1.84273828e-02]
 [-4.84113312e-02]
 [ 3.43775137e-04]
 [-3.97923400e-03]
 [ 5.60103990e-03]
 [ 1.00764717e-02]
 [-1.28470054e-02]
 [ 3.18965714e-03]
 [ 5.67962259e-03]
 [ 3.56248058e-03]
 [ 1.16086029e-02]
 [-2.68273561e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.42859295]
curr_Stock_Price:  100.09524041614644
curr_Factors:  [100.09524042]
mat_Sqrt:  [[0.15]]
grads:  [0.03198383]
Stock Position:  0.031983826343970324
Bond Position:  [0.22716416]


portfolio before change:  [3.44558601]
curr_Stock_Price:  100.62565437823835
curr_Factors:  [100.62565438]
mat_Sqrt:  [[0.15]]
grads:  [0.02365713]
Stock Position:  0.02365712730878993
Bond Position:  [1.06507209]


portfolio before change:  [3.43965473]
curr_Stock_Price:  100.36930795525554
curr_Factors:  [100.36930796]
mat_Sqrt:  [[0.15]]
grads:  [0.06229546]
Stock Position:  0.06229545761710152
Bond Position:  [-2.81289724]


portfolio before change:  [3.40257532]
curr_Stock_Price:  99.77973408230089
curr_Factors:  [99.77973408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01645901]
Stock Position:  -0.01645900824382573
Bond Position:  [5.04485079]


portfolio before change:  [3.41878409]
curr_Stock_Price:  98.83325441527384
curr_Factors:  [98.83325442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248854]
Stock Position:  -0.0024885443521559247
Bond Position:  [3.66473502]


portfolio before change:  [3.4171407]
curr_Stock_Price:  99.67772553925381
curr_Factors:  [99.67772554]
mat_Sqrt:  [[0.15]]
grads:  [0.05213202]
Stock Position:  0.052132020798107255
Bond Position:  [-1.77926056]


portfolio before change:  [3.38084292]
curr_Stock_Price:  98.98572549904374
curr_Factors:  [98.9857255]
mat_Sqrt:  [[0.15]]
grads:  [-0.17071463]
Stock Position:  -0.17071463105869408
Bond Position:  [20.27915453]


portfolio before change:  [3.40986755]
curr_Stock_Price:  98.83055672704026
curr_Factors:  [98.83055673]
mat_Sqrt:  [[0.15]]
grads:  [0.14794038]
Stock Position:  0.14794037960025913
Bond Position:  [-11.21116252]


portfolio before change:  [3.48195339]
curr_Stock_Price:  99.32729279271166
curr_Factors:  [99.32729279]
mat_Sqrt:  [[0.15]]
grads:  [-0.03896977]
Stock Position:  -0.03896976588043554
Bond Position:  [7.35271474]


portfolio before change:  [3.50028755]
curr_Stock_Price:  98.88040754247702
curr_Factors:  [98.88040754]
mat_Sqrt:  [[0.15]]
grads:  [0.02367368]
Stock Position:  0.02367367908290731
Bond Position:  [1.15942452]


portfolio before change:  [3.50653764]
curr_Stock_Price:  99.1382952817195
curr_Factors:  [99.13829528]
mat_Sqrt:  [[0.15]]
grads:  [0.01712102]
Stock Position:  0.01712102487704798
Bond Position:  [1.80918842]


portfolio before change:  [3.49307888]
curr_Stock_Price:  98.33899022235808
curr_Factors:  [98.33899022]
mat_Sqrt:  [[0.15]]
grads:  [0.04781209]
Stock Position:  0.04781208790636939
Bond Position:  [-1.20871356]


portfolio before change:  [3.54052832]
curr_Stock_Price:  99.3345655674753
curr_Factors:  [99.33456557]
mat_Sqrt:  [[0.15]]
grads:  [0.09527082]
Stock Position:  0.09527081962959798
Bond Position:  [-5.92315716]


portfolio before change:  [3.64717538]
curr_Stock_Price:  100.46174698088868
curr_Factors:  [100.46174698]
mat_Sqrt:  [[0.15]]
grads:  [0.01750291]
Stock Position:  0.01750291003297922
Bond Position:  [1.88880246]


portfolio before change:  [3.63649731]
curr_Stock_Price:  99.83818330220934
curr_Factors:  [99.8381833]
mat_Sqrt:  [[0.15]]
grads:  [0.10706807]
Stock Position:  0.10706806989653223
Bond Position:  [-7.05298428]


portfolio before change:  [3.5547482]
curr_Stock_Price:  99.08289341541958
curr_Factors:  [99.08289342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133489]
Stock Position:  -0.02133489313911124
Bond Position:  [5.66867115]


portfolio before change:  [3.52846212]
curr_Stock_Price:  100.34817802682483
curr_Factors:  [100.34817803]
mat_Sqrt:  [[0.15]]
grads:  [0.06239562]
Stock Position:  0.06239561687335221
Bond Position:  [-2.73282435]


portfolio before change:  [3.53574307]
curr_Stock_Price:  100.4703431996279
curr_Factors:  [100.4703432]
mat_Sqrt:  [[0.15]]
grads:  [0.0846604]
Stock Position:  0.08466040004561753
Bond Position:  [-4.97011638]


portfolio before change:  [3.56523861]
curr_Stock_Price:  100.82608034728175
curr_Factors:  [100.82608035]
mat_Sqrt:  [[0.15]]
grads:  [0.07584915]
Stock Position:  0.07584915021093915
Bond Position:  [-4.0823339]


portfolio before change:  [3.50992931]
curr_Stock_Price:  100.10360711329851
curr_Factors:  [100.10360711]
mat_Sqrt:  [[0.15]]
grads:  [-0.08446823]
Stock Position:  -0.08446823056785908
Bond Position:  [11.96550388]


portfolio before change:  [3.58577149]
curr_Stock_Price:  99.22343711035896
curr_Factors:  [99.22343711]
mat_Sqrt:  [[0.15]]
grads:  [0.03956536]
Stock Position:  0.03956536083037996
Bond Position:  [-0.3400396]


portfolio before change:  [3.62307721]
curr_Stock_Price:  100.16739982249308
curr_Factors:  [100.16739982]
mat_Sqrt:  [[0.15]]
grads:  [0.10673578]
Stock Position:  0.10673577642448548
Bond Position:  [-7.06836798]


portfolio before change:  [3.52608514]
curr_Stock_Price:  99.26696627653578
curr_Factors:  [99.26696628]
mat_Sqrt:  [[0.15]]
grads:  [0.10088813]
Stock Position:  0.10088813218694306
Bond Position:  [-6.48877368]


portfolio before change:  [3.55241466]
curr_Stock_Price:  99.5359837829477
curr_Factors:  [99.53598378]
mat_Sqrt:  [[0.15]]
grads:  [0.03475908]
Stock Position:  0.03475908479307258
Bond Position:  [0.09263496]


portfolio before change:  [3.52335811]
curr_Stock_Price:  98.69970930019171
curr_Factors:  [98.6997093]
mat_Sqrt:  [[0.15]]
grads:  [0.08319469]
Stock Position:  0.08319469436966177
Bond Position:  [-4.68793404]


portfolio before change:  [3.48501201]
curr_Stock_Price:  98.24583335954308
curr_Factors:  [98.24583336]
mat_Sqrt:  [[0.15]]
grads:  [-0.07349419]
Stock Position:  -0.07349419287290382
Bond Position:  [10.70551023]


portfolio before change:  [3.49599255]
curr_Stock_Price:  98.11463569827343
curr_Factors:  [98.1146357]
mat_Sqrt:  [[0.15]]
grads:  [0.10472567]
Stock Position:  0.10472567061761101
Bond Position:  [-6.77912847]


portfolio before change:  [3.37899767]
curr_Stock_Price:  97.00557204772184
curr_Factors:  [97.00557205]
mat_Sqrt:  [[0.15]]
grads:  [-0.12284922]
Stock Position:  -0.12284921848155625
Bond Position:  [15.29605638]


portfolio before change:  [3.42977172]
curr_Stock_Price:  96.60783303469512
curr_Factors:  [96.60783303]
mat_Sqrt:  [[0.15]]
grads:  [-0.32274221]
Stock Position:  -0.32274220784996055
Bond Position:  [34.60919705]


portfolio before change:  [3.50180165]
curr_Stock_Price:  96.39805722687164
curr_Factors:  [96.39805723]
mat_Sqrt:  [[0.15]]
grads:  [0.00229183]
Stock Position:  0.002291834248730219
Bond Position:  [3.28087328]


portfolio before change:  [3.50415939]
curr_Stock_Price:  97.24785798455824
curr_Factors:  [97.24785798]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652823]
Stock Position:  -0.026528226649723513
Bond Position:  [6.0839726]


portfolio before change:  [3.51054043]
curr_Stock_Price:  97.035989248793
curr_Factors:  [97.03598925]
mat_Sqrt:  [[0.15]]
grads:  [0.03734027]
Stock Position:  0.03734026602223817
Bond Position:  [-0.11280922]


portfolio before change:  [3.51078992]
curr_Stock_Price:  97.04304838890184
curr_Factors:  [97.04304839]
mat_Sqrt:  [[0.15]]
grads:  [0.06717648]
Stock Position:  0.06717647806406783
Bond Position:  [-3.00822029]


portfolio before change:  [3.4600378]
curr_Stock_Price:  96.29314202475722
curr_Factors:  [96.29314202]
mat_Sqrt:  [[0.15]]
grads:  [-0.0856467]
Stock Position:  -0.08564670282237344
Bond Position:  [11.70722792]


portfolio before change:  [3.36840262]
curr_Stock_Price:  97.38015036174716
curr_Factors:  [97.38015036]
mat_Sqrt:  [[0.15]]
grads:  [0.02126438]
Stock Position:  0.021264380940219225
Bond Position:  [1.297674]


portfolio before change:  [3.3655206]
curr_Stock_Price:  97.23698927006829
curr_Factors:  [97.23698927]
mat_Sqrt:  [[0.15]]
grads:  [0.03786415]
Stock Position:  0.03786415062274823
Bond Position:  [-0.3162754]


portfolio before change:  [3.34043122]
curr_Stock_Price:  96.57541766741869
curr_Factors:  [96.57541767]
mat_Sqrt:  [[0.15]]
grads:  [0.02374987]
Stock Position:  0.02374987053651308
Bond Position:  [1.04677755]


portfolio before change:  [3.34395285]
curr_Stock_Price:  96.71818786501625
curr_Factors:  [96.71818787]
mat_Sqrt:  [[0.15]]
grads:  [0.07739069]
Stock Position:  0.07739068582383454
Bond Position:  [-4.14113404]


portfolio before change:  [3.37044675]
curr_Stock_Price:  97.06721668729098
curr_Factors:  [97.06721669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.37044675]
Stock Price:  98.16508893221102
PL:  [3.37044675]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.65408225e-03]
 [-7.13290330e-03]
 [ 1.37596537e-02]
 [ 1.54894472e-02]
 [-5.58576586e-03]
 [ 3.24088678e-02]
 [ 4.81177833e-02]
 [-2.00253094e-03]
 [-1.03850515e-02]
 [-3.02748263e-03]
 [ 1.31694527e-02]
 [ 5.75245757e-03]
 [ 1.13830353e-02]
 [ 5.33923924e-03]
 [ 2.44794165e-02]
 [ 6.41488281e-05]
 [ 9.35857255e-03]
 [ 1.35767482e-02]
 [ 1.15083631e-02]
 [-1.28603080e-02]
 [-1.71104752e-02]
 [ 1.72077163e-02]
 [-2.53081326e-02]
 [ 6.16205640e-03]
 [-6.40060094e-03]
 [-6.64832731e-03]
 [-9.52724437e-04]
 [-1.11577857e-02]
 [-1.47802036e-02]
 [-9.79214492e-03]
 [-2.85031494e-04]
 [ 5.21117567e-03]
 [ 5.08937174e-03]
 [-9.44849915e-03]
 [ 1.97060776e-02]
 [ 5.47874601e-03]
 [-4.65106472e-03]
 [ 8.38897251e-03]
 [-1.26325128e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.8345478]
curr_Stock_Price:  100.96005010624256
curr_Factors:  [100.96005011]
mat_Sqrt:  [[0.15]]
grads:  [0.04436055]
Stock Position:  0.04436054833177739
Bond Position:  [12.35590461]


portfolio before change:  [16.89352369]
curr_Stock_Price:  102.25469848853426
curr_Factors:  [102.25469849]
mat_Sqrt:  [[0.15]]
grads:  [-0.04755269]
Stock Position:  -0.047552688654649226
Bond Position:  [21.75600953]


portfolio before change:  [16.89120005]
curr_Stock_Price:  102.36075587193238
curr_Factors:  [102.36075587]
mat_Sqrt:  [[0.15]]
grads:  [0.09173102]
Stock Position:  0.09173102489764949
Bond Position:  [7.50154301]


portfolio before change:  [16.92451578]
curr_Stock_Price:  102.71372236289947
curr_Factors:  [102.71372236]
mat_Sqrt:  [[0.15]]
grads:  [0.10326298]
Stock Position:  0.10326298138718744
Bond Position:  [6.31799058]


portfolio before change:  [16.9380105]
curr_Stock_Price:  102.83675700539001
curr_Factors:  [102.83675701]
mat_Sqrt:  [[0.15]]
grads:  [-0.03723844]
Stock Position:  -0.03723843904183514
Bond Position:  [20.76749081]


portfolio before change:  [16.91792953]
curr_Stock_Price:  103.44572650391339
curr_Factors:  [103.4457265]
mat_Sqrt:  [[0.15]]
grads:  [0.21605912]
Stock Position:  0.2160591189779065
Bond Position:  [-5.432463]


portfolio before change:  [17.08333456]
curr_Stock_Price:  104.21442415716406
curr_Factors:  [104.21442416]
mat_Sqrt:  [[0.15]]
grads:  [0.32078522]
Stock Position:  0.320785221807803
Bond Position:  [-16.3471126]


portfolio before change:  [17.03897625]
curr_Stock_Price:  104.08251409661575
curr_Factors:  [104.0825141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01335021]
Stock Position:  -0.013350206236156827
Bond Position:  [18.42849928]


portfolio before change:  [17.05365751]
curr_Stock_Price:  103.15537109774488
curr_Factors:  [103.1553711]
mat_Sqrt:  [[0.15]]
grads:  [-0.06923368]
Stock Position:  -0.06923367695883065
Bond Position:  [24.19548315]


portfolio before change:  [17.0789879]
curr_Stock_Price:  102.83319019591798
curr_Factors:  [102.8331902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02018322]
Stock Position:  -0.02018321751565689
Bond Position:  [19.15449254]


portfolio before change:  [17.09149713]
curr_Stock_Price:  102.33204257930429
curr_Factors:  [102.33204258]
mat_Sqrt:  [[0.15]]
grads:  [0.08779635]
Stock Position:  0.0877963516318366
Bond Position:  [8.10711714]


portfolio before change:  [17.06982861]
curr_Stock_Price:  102.0736949956634
curr_Factors:  [102.073695]
mat_Sqrt:  [[0.15]]
grads:  [0.03834972]
Stock Position:  0.03834971714759164
Bond Position:  [13.15533128]


portfolio before change:  [16.99616705]
curr_Stock_Price:  100.11002774867099
curr_Factors:  [100.11002775]
mat_Sqrt:  [[0.15]]
grads:  [0.0758869]
Stock Position:  0.07588690226486611
Bond Position:  [9.39912715]


portfolio before change:  [16.99076713]
curr_Stock_Price:  100.02338720034957
curr_Factors:  [100.0233872]
mat_Sqrt:  [[0.15]]
grads:  [0.03559493]
Stock Position:  0.03559492826423616
Bond Position:  [13.43044183]


portfolio before change:  [17.02633598]
curr_Stock_Price:  100.9754875052745
curr_Factors:  [100.97548751]
mat_Sqrt:  [[0.15]]
grads:  [0.16319611]
Stock Position:  0.163196109746574
Bond Position:  [0.54752924]


portfolio before change:  [16.93091238]
curr_Stock_Price:  100.39035074931515
curr_Factors:  [100.39035075]
mat_Sqrt:  [[0.15]]
grads:  [0.00042766]
Stock Position:  0.0004276588542631591
Bond Position:  [16.88797956]


portfolio before change:  [16.93300607]
curr_Stock_Price:  100.34957349863387
curr_Factors:  [100.3495735]
mat_Sqrt:  [[0.15]]
grads:  [0.06239048]
Stock Position:  0.062390483635687895
Bond Position:  [10.67214765]


portfolio before change:  [16.97185634]
curr_Stock_Price:  100.9508858748198
curr_Factors:  [100.95088587]
mat_Sqrt:  [[0.15]]
grads:  [0.09051165]
Stock Position:  0.0905116547044456
Bond Position:  [7.83462462]


portfolio before change:  [16.92653451]
curr_Stock_Price:  100.43933602598575
curr_Factors:  [100.43933603]
mat_Sqrt:  [[0.15]]
grads:  [0.07672242]
Stock Position:  0.07672242078671683
Bond Position:  [9.22058551]


portfolio before change:  [16.95815067]
curr_Stock_Price:  100.83639741084191
curr_Factors:  [100.83639741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08573539]
Stock Position:  -0.08573538696356872
Bond Position:  [25.60339822]


portfolio before change:  [16.95970661]
curr_Stock_Price:  100.85558068975422
curr_Factors:  [100.85558069]
mat_Sqrt:  [[0.15]]
grads:  [-0.11406983]
Stock Position:  -0.11406983489761997
Bond Position:  [28.46428604]


portfolio before change:  [17.00482316]
curr_Stock_Price:  100.4912573860499
curr_Factors:  [100.49125739]
mat_Sqrt:  [[0.15]]
grads:  [0.11471811]
Stock Position:  0.11471810873456964
Bond Position:  [5.47665617]


portfolio before change:  [17.13100004]
curr_Stock_Price:  101.58517583898096
curr_Factors:  [101.58517584]
mat_Sqrt:  [[0.15]]
grads:  [-0.16872088]
Stock Position:  -0.1687208839336968
Bond Position:  [34.27054071]


portfolio before change:  [17.22345654]
curr_Stock_Price:  101.06258249138413
curr_Factors:  [101.06258249]
mat_Sqrt:  [[0.15]]
grads:  [0.04108038]
Stock Position:  0.041080376019648784
Bond Position:  [13.07176765]


portfolio before change:  [17.20862339]
curr_Stock_Price:  100.66172879168246
curr_Factors:  [100.66172879]
mat_Sqrt:  [[0.15]]
grads:  [-0.04267067]
Stock Position:  -0.04267067291760927
Bond Position:  [21.5039271]


portfolio before change:  [17.17455551]
curr_Stock_Price:  101.52311755855382
curr_Factors:  [101.52311756]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432218]
Stock Position:  -0.04432218206831529
Bond Position:  [21.67428161]


portfolio before change:  [17.16987562]
curr_Stock_Price:  101.6898364767925
curr_Factors:  [101.68983648]
mat_Sqrt:  [[0.15]]
grads:  [-0.0063515]
Stock Position:  -0.006351496244663922
Bond Position:  [17.81575824]


portfolio before change:  [17.1769571]
curr_Stock_Price:  100.92554867951927
curr_Factors:  [100.92554868]
mat_Sqrt:  [[0.15]]
grads:  [-0.07438524]
Stock Position:  -0.07438523789292252
Bond Position:  [24.68432805]


portfolio before change:  [17.15280267]
curr_Stock_Price:  101.29175264073514
curr_Factors:  [101.29175264]
mat_Sqrt:  [[0.15]]
grads:  [-0.09853469]
Stock Position:  -0.09853469089228173
Bond Position:  [27.1335542]


portfolio before change:  [17.15596717]
curr_Stock_Price:  101.29406053384872
curr_Factors:  [101.29406053]
mat_Sqrt:  [[0.15]]
grads:  [-0.06528097]
Stock Position:  -0.06528096613787597
Bond Position:  [23.7685413]


portfolio before change:  [17.12939604]
curr_Stock_Price:  101.74660255515624
curr_Factors:  [101.74660256]
mat_Sqrt:  [[0.15]]
grads:  [-0.00190021]
Stock Position:  -0.0019002099568023664
Bond Position:  [17.32273595]


portfolio before change:  [17.13266635]
curr_Stock_Price:  101.16517498946428
curr_Factors:  [101.16517499]
mat_Sqrt:  [[0.15]]
grads:  [0.03474117]
Stock Position:  0.034741171131566696
Bond Position:  [13.61806969]


portfolio before change:  [17.15516419]
curr_Stock_Price:  101.7637580905132
curr_Factors:  [101.76375809]
mat_Sqrt:  [[0.15]]
grads:  [0.03392914]
Stock Position:  0.03392914495573248
Bond Position:  [13.70240689]


portfolio before change:  [17.13299158]
curr_Stock_Price:  101.0597755468843
curr_Factors:  [101.05977555]
mat_Sqrt:  [[0.15]]
grads:  [-0.06298999]
Stock Position:  -0.06298999434005682
Bond Position:  [23.49874627]


portfolio before change:  [17.09413429]
curr_Stock_Price:  101.72329061386219
curr_Factors:  [101.72329061]
mat_Sqrt:  [[0.15]]
grads:  [0.13137385]
Stock Position:  0.1313738505868487
Bond Position:  [3.73035391]


portfolio before change:  [17.07245961]
curr_Stock_Price:  101.55475623568239
curr_Factors:  [101.55475624]
mat_Sqrt:  [[0.15]]
grads:  [0.03652497]
Stock Position:  0.03652497338828594
Bond Position:  [13.36317484]


portfolio before change:  [17.11867093]
curr_Stock_Price:  102.77421842474509
curr_Factors:  [102.77421842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310071]
Stock Position:  -0.031007098105117183
Bond Position:  [20.3054012]


portfolio before change:  [17.14465491]
curr_Stock_Price:  102.01808030161835
curr_Factors:  [102.0180803]
mat_Sqrt:  [[0.15]]
grads:  [0.05592648]
Stock Position:  0.05592648338027925
Bond Position:  [11.43914244]


portfolio before change:  [17.1108795]
curr_Stock_Price:  101.38858604898473
curr_Factors:  [101.38858605]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.1108795]
Stock Price:  102.32147806565273
PL:  [14.78940143]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.85988729e-03]
 [-4.98998862e-03]
 [ 1.30033723e-02]
 [-7.71411675e-04]
 [ 1.53582963e-02]
 [ 1.95968080e-02]
 [-3.31624707e-02]
 [ 2.35900121e-02]
 [-6.02332596e-03]
 [ 8.85976199e-04]
 [-3.53253237e-03]
 [ 7.38987860e-03]
 [ 1.38811390e-02]
 [-1.10960450e-03]
 [-5.32395160e-03]
 [-7.20029692e-03]
 [ 1.95119503e-02]
 [-2.87915233e-02]
 [ 1.37854117e-04]
 [ 9.22639301e-03]
 [ 2.88258662e-02]
 [ 1.26457791e-03]
 [ 2.85471181e-02]
 [ 1.26292012e-03]
 [ 1.40293524e-02]
 [-1.11283562e-02]
 [ 9.86439396e-03]
 [-1.06418538e-02]
 [-1.81896635e-02]
 [-2.68390949e-03]
 [-3.48343268e-03]
 [ 5.62305389e-03]
 [ 8.21203031e-03]
 [-1.28551066e-02]
 [ 4.12650442e-03]
 [ 5.69420918e-03]
 [ 3.63068307e-03]
 [ 1.14025872e-02]
 [-2.96741728e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.47617435]
curr_Stock_Price:  100.29183796976378
curr_Factors:  [100.29183797]
mat_Sqrt:  [[0.15]]
grads:  [0.04573258]
Stock Position:  0.04573258194522155
Bond Position:  [1.88956965]


portfolio before change:  [6.42792257]
curr_Stock_Price:  99.23158759667625
curr_Factors:  [99.2315876]
mat_Sqrt:  [[0.15]]
grads:  [-0.03326659]
Stock Position:  -0.03326659082241584
Bond Position:  [9.72901919]


portfolio before change:  [6.37650147]
curr_Stock_Price:  100.813874758261
curr_Factors:  [100.81387476]
mat_Sqrt:  [[0.15]]
grads:  [0.08668915]
Stock Position:  0.08668914888473672
Bond Position:  [-2.36296752]


portfolio before change:  [6.38723189]
curr_Stock_Price:  100.94106258595353
curr_Factors:  [100.94106259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00514274]
Stock Position:  -0.005142744497042416
Bond Position:  [6.90634598]


portfolio before change:  [6.39001117]
curr_Stock_Price:  100.56851106292622
curr_Factors:  [100.56851106]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-3.90706211]


portfolio before change:  [6.35386335]
curr_Stock_Price:  100.22023603104591
curr_Factors:  [100.22023603]
mat_Sqrt:  [[0.15]]
grads:  [0.13064539]
Stock Position:  0.13064538659623562
Bond Position:  [-6.73944813]


portfolio before change:  [6.17383099]
curr_Stock_Price:  98.84866152586098
curr_Factors:  [98.84866153]
mat_Sqrt:  [[0.15]]
grads:  [-0.22108314]
Stock Position:  -0.22108313787714035
Bond Position:  [28.02760325]


portfolio before change:  [6.06664044]
curr_Stock_Price:  99.34935197222991
curr_Factors:  [99.34935197]
mat_Sqrt:  [[0.15]]
grads:  [0.15726675]
Stock Position:  0.15726674738430618
Bond Position:  [-9.557709]


portfolio before change:  [5.87777166]
curr_Stock_Price:  98.15600377368403
curr_Factors:  [98.15600377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04015551]
Stock Position:  -0.040155506388425584
Bond Position:  [9.8192757]


portfolio before change:  [5.87359923]
curr_Stock_Price:  98.29047891324605
curr_Factors:  [98.29047891]
mat_Sqrt:  [[0.15]]
grads:  [0.00590651]
Stock Position:  0.005906507995694378
Bond Position:  [5.29304573]


portfolio before change:  [5.87239371]
curr_Stock_Price:  97.97435446756874
curr_Factors:  [97.97435447]
mat_Sqrt:  [[0.15]]
grads:  [-0.02355022]
Stock Position:  -0.023550215772752084
Bond Position:  [8.1797109]


portfolio before change:  [5.88573357]
curr_Stock_Price:  97.4513304222275
curr_Factors:  [97.45133042]
mat_Sqrt:  [[0.15]]
grads:  [0.04926586]
Stock Position:  0.04926585736190456
Bond Position:  [1.08471023]


portfolio before change:  [5.80974117]
curr_Stock_Price:  95.906081880452
curr_Factors:  [95.90608188]
mat_Sqrt:  [[0.15]]
grads:  [0.09254093]
Stock Position:  0.09254092638885267
Bond Position:  [-3.06549649]


portfolio before change:  [5.78013616]
curr_Stock_Price:  95.59031016099529
curr_Factors:  [95.59031016]
mat_Sqrt:  [[0.15]]
grads:  [-0.00739736]
Stock Position:  -0.007397363342004111
Bond Position:  [6.48725241]


portfolio before change:  [5.77898695]
curr_Stock_Price:  95.85529099274162
curr_Factors:  [95.85529099]
mat_Sqrt:  [[0.15]]
grads:  [-0.03549301]
Stock Position:  -0.0354930106907566
Bond Position:  [9.18117982]


portfolio before change:  [5.76602093]
curr_Stock_Price:  96.25293954633216
curr_Factors:  [96.25293955]
mat_Sqrt:  [[0.15]]
grads:  [-0.04800198]
Stock Position:  -0.048001979438296725
Bond Position:  [10.38635255]


portfolio before change:  [5.77536471]
curr_Stock_Price:  96.08533390947873
curr_Factors:  [96.08533391]
mat_Sqrt:  [[0.15]]
grads:  [0.13007967]
Stock Position:  0.1300796684144928
Bond Position:  [-6.72338367]


portfolio before change:  [5.67634962]
curr_Stock_Price:  95.33060711340472
curr_Factors:  [95.33060711]
mat_Sqrt:  [[0.15]]
grads:  [-0.19194349]
Stock Position:  -0.19194348891253324
Bond Position:  [23.97443895]


portfolio before change:  [5.90218421]
curr_Stock_Price:  94.16965290279461
curr_Factors:  [94.1696529]
mat_Sqrt:  [[0.15]]
grads:  [0.00091903]
Stock Position:  0.0009190274488991845
Bond Position:  [5.81563972]


portfolio before change:  [5.90275906]
curr_Stock_Price:  94.00409405556968
curr_Factors:  [94.00409406]
mat_Sqrt:  [[0.15]]
grads:  [0.06150929]
Stock Position:  0.061509286730341214
Bond Position:  [0.12063428]


portfolio before change:  [5.86206521]
curr_Stock_Price:  93.34226016333483
curr_Factors:  [93.34226016]
mat_Sqrt:  [[0.15]]
grads:  [0.19217244]
Stock Position:  0.19217244143148318
Bond Position:  [-12.07574481]


portfolio before change:  [5.93477169]
curr_Stock_Price:  93.72845522129771
curr_Factors:  [93.72845522]
mat_Sqrt:  [[0.15]]
grads:  [0.00843052]
Stock Position:  0.008430519406231856
Bond Position:  [5.14459213]


portfolio before change:  [5.94313915]
curr_Stock_Price:  94.64469081596324
curr_Factors:  [94.64469082]
mat_Sqrt:  [[0.15]]
grads:  [0.19031412]
Stock Position:  0.19031412061905098
Bond Position:  [-12.06908195]


portfolio before change:  [5.96133825]
curr_Stock_Price:  94.74824501577184
curr_Factors:  [94.74824502]
mat_Sqrt:  [[0.15]]
grads:  [0.00841947]
Stock Position:  0.008419467479012557
Bond Position:  [5.16360848]


portfolio before change:  [5.97230485]
curr_Stock_Price:  95.974108098511
curr_Factors:  [95.9741081]
mat_Sqrt:  [[0.15]]
grads:  [0.09352902]
Stock Position:  0.0935290157564688
Bond Position:  [-3.00405902]


portfolio before change:  [6.12505373]
curr_Stock_Price:  97.61129420590883
curr_Factors:  [97.61129421]
mat_Sqrt:  [[0.15]]
grads:  [-0.07418904]
Stock Position:  -0.07418904106492741
Bond Position:  [13.36674204]


portfolio before change:  [5.99189531]
curr_Stock_Price:  99.42866995870627
curr_Factors:  [99.42866996]
mat_Sqrt:  [[0.15]]
grads:  [0.06576263]
Stock Position:  0.0657626263711961
Bond Position:  [-0.54679516]


portfolio before change:  [6.02660861]
curr_Stock_Price:  99.957566913773
curr_Factors:  [99.95756691]
mat_Sqrt:  [[0.15]]
grads:  [-0.07094569]
Stock Position:  -0.07094569194484461
Bond Position:  [13.11816736]


portfolio before change:  [6.07176178]
curr_Stock_Price:  99.3442344764202
curr_Factors:  [99.34423448]
mat_Sqrt:  [[0.15]]
grads:  [-0.12126442]
Stock Position:  -0.12126442361023226
Bond Position:  [18.11868311]


portfolio before change:  [6.16720496]
curr_Stock_Price:  98.57584579548278
curr_Factors:  [98.5758458]
mat_Sqrt:  [[0.15]]
grads:  [-0.01789273]
Stock Position:  -0.01789272990621693
Bond Position:  [7.93099595]


portfolio before change:  [6.16101298]
curr_Stock_Price:  98.97731716541912
curr_Factors:  [98.97731717]
mat_Sqrt:  [[0.15]]
grads:  [-0.02322288]
Stock Position:  -0.02322288451362694
Bond Position:  [8.45955179]


portfolio before change:  [6.18523812]
curr_Stock_Price:  97.97969647707656
curr_Factors:  [97.97969648]
mat_Sqrt:  [[0.15]]
grads:  [0.03748703]
Stock Position:  0.037487025914791035
Bond Position:  [2.5122707]


portfolio before change:  [6.18642817]
curr_Stock_Price:  98.00306430928958
curr_Factors:  [98.00306431]
mat_Sqrt:  [[0.15]]
grads:  [0.05474687]
Stock Position:  0.05474686870909115
Bond Position:  [0.82106727]


portfolio before change:  [6.1113625]
curr_Stock_Price:  96.6300487388868
curr_Factors:  [96.63004874]
mat_Sqrt:  [[0.15]]
grads:  [-0.08570071]
Stock Position:  -0.08570071049848724
Bond Position:  [14.39262634]


portfolio before change:  [5.99337818]
curr_Stock_Price:  98.02774443101706
curr_Factors:  [98.02774443]
mat_Sqrt:  [[0.15]]
grads:  [0.02751003]
Stock Position:  0.027510029437926645
Bond Position:  [3.29663204]


portfolio before change:  [5.97608407]
curr_Stock_Price:  97.38411677493865
curr_Factors:  [97.38411677]
mat_Sqrt:  [[0.15]]
grads:  [0.03796139]
Stock Position:  0.03796139452444901
Bond Position:  [2.27924719]


portfolio before change:  [5.95488683]
curr_Stock_Price:  96.81822180146622
curr_Factors:  [96.8182218]
mat_Sqrt:  [[0.15]]
grads:  [0.02420455]
Stock Position:  0.024204553770933394
Bond Position:  [3.61144497]


portfolio before change:  [5.94687152]
curr_Stock_Price:  96.468420947548
curr_Factors:  [96.46842095]
mat_Sqrt:  [[0.15]]
grads:  [0.07601725]
Stock Position:  0.07601724822942643
Bond Position:  [-1.38639239]


portfolio before change:  [5.95205662]
curr_Stock_Price:  96.5389103831323
curr_Factors:  [96.53891038]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.95205662]
Stock Price:  95.64327164961998
PL:  [5.95205662]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.12436454e-03]
 [-1.52417036e-02]
 [-4.61377550e-02]
 [ 1.70257403e-02]
 [-9.99178521e-02]
 [-3.40273043e-02]
 [-4.58273672e-02]
 [ 1.05732162e-02]
 [-6.50942107e-03]
 [ 1.27636346e-02]
 [-1.22919302e-02]
 [ 7.57944426e-03]
 [ 1.39008721e-02]
 [ 1.98853517e-03]
 [ 3.56150758e-03]
 [-3.33015504e-03]
 [ 1.17043779e-02]
 [-5.16608363e-03]
 [ 6.90610336e-03]
 [-5.33345559e-03]
 [ 2.16979174e-02]
 [-1.43408381e-03]
 [ 1.93994076e-02]
 [ 4.54467187e-03]
 [ 1.29627749e-02]
 [-1.06340786e-02]
 [ 1.87429984e-02]
 [-1.66142194e-02]
 [-4.38896306e-02]
 [ 2.76377942e-04]
 [-4.13582442e-03]
 [ 5.58202388e-03]
 [ 1.05169326e-02]
 [-1.26458737e-02]
 [ 3.13601358e-03]
 [ 5.71435773e-03]
 [ 3.56462172e-03]
 [ 1.04559363e-02]
 [-1.98625244e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.55874263]
curr_Stock_Price:  99.70900117512758
curr_Factors:  [99.70900118]
mat_Sqrt:  [[0.15]]
grads:  [0.0208291]
Stock Position:  0.02082909690793445
Bond Position:  [-4.63559108]


portfolio before change:  [-2.604555]
curr_Stock_Price:  97.53738151856751
curr_Factors:  [97.53738152]
mat_Sqrt:  [[0.15]]
grads:  [-0.10161136]
Stock Position:  -0.10161135725904794
Bond Position:  [7.30635072]


portfolio before change:  [-2.44772169]
curr_Stock_Price:  96.00290778060483
curr_Factors:  [96.00290778]
mat_Sqrt:  [[0.15]]
grads:  [-0.30758503]
Stock Position:  -0.3075850330805937
Bond Position:  [27.08133588]


portfolio before change:  [-2.32576617]
curr_Stock_Price:  95.61742045280735
curr_Factors:  [95.61742045]
mat_Sqrt:  [[0.15]]
grads:  [0.11350494]
Stock Position:  0.11350493520013319
Bond Position:  [-13.17881529]


portfolio before change:  [-2.31172825]
curr_Stock_Price:  95.75561160707362
curr_Factors:  [95.75561161]
mat_Sqrt:  [[0.15]]
grads:  [-0.66611901]
Stock Position:  -0.6661190137996214
Bond Position:  [61.47290532]


portfolio before change:  [-2.85761066]
curr_Stock_Price:  96.58664478797256
curr_Factors:  [96.58664479]
mat_Sqrt:  [[0.15]]
grads:  [-0.2268487]
Stock Position:  -0.22684869552729892
Bond Position:  [19.05294371]


portfolio before change:  [-3.04573542]
curr_Stock_Price:  97.4264403515765
curr_Factors:  [97.42644035]
mat_Sqrt:  [[0.15]]
grads:  [-0.30551578]
Stock Position:  -0.30551578150379766
Bond Position:  [26.71957964]


portfolio before change:  [-2.68867758]
curr_Stock_Price:  96.26866812096199
curr_Factors:  [96.26866812]
mat_Sqrt:  [[0.15]]
grads:  [0.07048811]
Stock Position:  0.0704881081419406
Bond Position:  [-9.47447387]


portfolio before change:  [-2.69352854]
curr_Stock_Price:  96.21665113150097
curr_Factors:  [96.21665113]
mat_Sqrt:  [[0.15]]
grads:  [-0.04339614]
Stock Position:  -0.04339614049251792
Bond Position:  [1.48190277]


portfolio before change:  [-2.66624962]
curr_Stock_Price:  95.59231750515015
curr_Factors:  [95.59231751]
mat_Sqrt:  [[0.15]]
grads:  [0.0850909]
Stock Position:  0.08509089753131988
Bond Position:  [-10.80028571]


portfolio before change:  [-2.6327802]
curr_Stock_Price:  96.0015215932433
curr_Factors:  [96.00152159]
mat_Sqrt:  [[0.15]]
grads:  [-0.0819462]
Stock Position:  -0.0819462015625297
Bond Position:  [5.23417984]


portfolio before change:  [-2.68599758]
curr_Stock_Price:  96.65892481824386
curr_Factors:  [96.65892482]
mat_Sqrt:  [[0.15]]
grads:  [0.05052963]
Stock Position:  0.05052962837395331
Bond Position:  [-7.57013713]


portfolio before change:  [-2.65739085]
curr_Stock_Price:  97.24379079244612
curr_Factors:  [97.24379079]
mat_Sqrt:  [[0.15]]
grads:  [0.09267248]
Stock Position:  0.09267248083339662
Bond Position:  [-11.66921419]


portfolio before change:  [-2.64418649]
curr_Stock_Price:  97.40201573066248
curr_Factors:  [97.40201573]
mat_Sqrt:  [[0.15]]
grads:  [0.0132569]
Stock Position:  0.013256901144143522
Bond Position:  [-3.93543539]


portfolio before change:  [-2.6350631]
curr_Stock_Price:  98.12732478423231
curr_Factors:  [98.12732478]
mat_Sqrt:  [[0.15]]
grads:  [0.02374338]
Stock Position:  0.023743383856287704
Bond Position:  [-4.96493784]


portfolio before change:  [-2.63346699]
curr_Stock_Price:  98.22068834068561
curr_Factors:  [98.22068834]
mat_Sqrt:  [[0.15]]
grads:  [-0.02220103]
Stock Position:  -0.02220103356791095
Bond Position:  [-0.45286619]


portfolio before change:  [-2.6532792]
curr_Stock_Price:  99.11053855838458
curr_Factors:  [99.11053856]
mat_Sqrt:  [[0.15]]
grads:  [0.07802919]
Stock Position:  0.07802918597607889
Bond Position:  [-10.38679384]


portfolio before change:  [-2.68585874]
curr_Stock_Price:  98.70964867350375
curr_Factors:  [98.70964867]
mat_Sqrt:  [[0.15]]
grads:  [-0.03444056]
Stock Position:  -0.03444055750312922
Bond Position:  [0.71375659]


portfolio before change:  [-2.66606362]
curr_Stock_Price:  98.13747753645978
curr_Factors:  [98.13747754]
mat_Sqrt:  [[0.15]]
grads:  [0.04604069]
Stock Position:  0.04604068906878279
Bond Position:  [-7.18438071]


portfolio before change:  [-2.67423223]
curr_Stock_Price:  97.97956287701102
curr_Factors:  [97.97956288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03555637]
Stock Position:  -0.03555637059942995
Bond Position:  [0.80956542]


portfolio before change:  [-2.62467793]
curr_Stock_Price:  96.588726551772
curr_Factors:  [96.58872655]
mat_Sqrt:  [[0.15]]
grads:  [0.14465278]
Stock Position:  0.144652782914009
Bond Position:  [-16.59650603]


portfolio before change:  [-2.50373964]
curr_Stock_Price:  97.43912836476036
curr_Factors:  [97.43912836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00956056]
Stock Position:  -0.009560558728225206
Bond Position:  [-1.57216713]


portfolio before change:  [-2.51120309]
curr_Stock_Price:  98.19922221297013
curr_Factors:  [98.19922221]
mat_Sqrt:  [[0.15]]
grads:  [0.12932938]
Stock Position:  0.129329384217801
Bond Position:  [-15.21124803]


portfolio before change:  [-2.58879893]
curr_Stock_Price:  97.6139390280134
curr_Factors:  [97.61393903]
mat_Sqrt:  [[0.15]]
grads:  [0.03029781]
Stock Position:  0.030297812495205235
Bond Position:  [-5.54628775]


portfolio before change:  [-2.559018]
curr_Stock_Price:  98.61976285805774
curr_Factors:  [98.61976286]
mat_Sqrt:  [[0.15]]
grads:  [0.0864185]
Stock Position:  0.08641849902631517
Bond Position:  [-11.08158988]


portfolio before change:  [-2.66942402]
curr_Stock_Price:  97.35821890889376
curr_Factors:  [97.35821891]
mat_Sqrt:  [[0.15]]
grads:  [-0.07089386]
Stock Position:  -0.07089385733761366
Bond Position:  [4.23267566]


portfolio before change:  [-2.65172322]
curr_Stock_Price:  97.11600210539639
curr_Factors:  [97.11600211]
mat_Sqrt:  [[0.15]]
grads:  [0.12495332]
Stock Position:  0.12495332276091876
Bond Position:  [-14.78669037]


portfolio before change:  [-2.62296755]
curr_Stock_Price:  97.36092654284172
curr_Factors:  [97.36092654]
mat_Sqrt:  [[0.15]]
grads:  [-0.11076146]
Stock Position:  -0.11076146242727347
Bond Position:  [8.16087106]


portfolio before change:  [-2.58230154]
curr_Stock_Price:  97.00298770529355
curr_Factors:  [97.00298771]
mat_Sqrt:  [[0.15]]
grads:  [-0.29259754]
Stock Position:  -0.292597537293361
Bond Position:  [25.80053377]


portfolio before change:  [-2.42043357]
curr_Stock_Price:  96.46080027185064
curr_Factors:  [96.46080027]
mat_Sqrt:  [[0.15]]
grads:  [0.00184252]
Stock Position:  0.0018425196139081174
Bond Position:  [-2.59816448]


portfolio before change:  [-2.42139577]
curr_Stock_Price:  96.11485328048045
curr_Factors:  [96.11485328]
mat_Sqrt:  [[0.15]]
grads:  [-0.02757216]
Stock Position:  -0.02757216281377711
Bond Position:  [0.22869861]


portfolio before change:  [-2.4088313]
curr_Stock_Price:  95.66019594712346
curr_Factors:  [95.66019595]
mat_Sqrt:  [[0.15]]
grads:  [0.03721349]
Stock Position:  0.03721349252877931
Bond Position:  [-5.96868128]


portfolio before change:  [-2.36472078]
curr_Stock_Price:  96.8655826782318
curr_Factors:  [96.86558268]
mat_Sqrt:  [[0.15]]
grads:  [0.07011288]
Stock Position:  0.07011288413817185
Bond Position:  [-9.15624615]


portfolio before change:  [-2.32846927]
curr_Stock_Price:  97.39895277735694
curr_Factors:  [97.39895278]
mat_Sqrt:  [[0.15]]
grads:  [-0.08430582]
Stock Position:  -0.08430582467453335
Bond Position:  [5.88282977]


portfolio before change:  [-2.3157399]
curr_Stock_Price:  97.25668540271664
curr_Factors:  [97.2566854]
mat_Sqrt:  [[0.15]]
grads:  [0.02090676]
Stock Position:  0.0209067571800825
Bond Position:  [-4.3490618]


portfolio before change:  [-2.28902802]
curr_Stock_Price:  98.5603569615449
curr_Factors:  [98.56035696]
mat_Sqrt:  [[0.15]]
grads:  [0.03809572]
Stock Position:  0.03809571818843056
Bond Position:  [-6.0437556]


portfolio before change:  [-2.30858768]
curr_Stock_Price:  98.06675434948495
curr_Factors:  [98.06675435]
mat_Sqrt:  [[0.15]]
grads:  [0.02376414]
Stock Position:  0.02376414482100934
Bond Position:  [-4.63906023]


portfolio before change:  [-2.29708087]
curr_Stock_Price:  98.57536662624833
curr_Factors:  [98.57536663]
mat_Sqrt:  [[0.15]]
grads:  [0.06970624]
Stock Position:  0.06970624186142824
Bond Position:  [-9.16839921]


portfolio before change:  [-2.28514393]
curr_Stock_Price:  98.76305501388673
curr_Factors:  [98.76305501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.28514393]
Stock Price:  99.63832372360218
PL:  [-2.28514393]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.23659116e-03]
 [ 3.77596676e-03]
 [ 7.60131164e-03]
 [-2.66714221e-03]
 [ 1.47441262e-02]
 [ 2.63596946e-02]
 [ 1.16006430e-02]
 [ 6.09273504e-04]
 [-1.00659369e-02]
 [-2.48597193e-03]
 [ 2.24058960e-02]
 [ 7.53988020e-03]
 [ 6.67966806e-03]
 [-4.07626555e-03]
 [ 2.59163375e-03]
 [ 3.97272920e-03]
 [ 9.17335480e-03]
 [-4.85053533e-03]
 [ 1.21058546e-02]
 [-1.66202146e-02]
 [ 8.24309910e-03]
 [ 3.46663660e-02]
 [-1.91723378e-02]
 [ 8.04605449e-03]
 [ 7.70778674e-03]
 [-2.39570205e-02]
 [ 1.43417556e-03]
 [-1.44833809e-02]
 [ 7.03002447e-02]
 [-2.67589688e-03]
 [-1.58515030e-02]
 [ 3.91857620e-03]
 [ 7.47100989e-03]
 [ 4.70018979e-03]
 [ 8.18802315e-03]
 [ 3.21245682e-03]
 [-6.09534142e-02]
 [ 9.09610081e-03]
 [-3.05361074e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.00570975]
curr_Stock_Price:  100.13246985746534
curr_Factors:  [100.13246986]
mat_Sqrt:  [[0.15]]
grads:  [0.03491061]
Stock Position:  0.034910607703419666
Bond Position:  [0.51002438]


portfolio before change:  [4.02105837]
curr_Stock_Price:  100.57029827997712
curr_Factors:  [100.57029828]
mat_Sqrt:  [[0.15]]
grads:  [0.02517311]
Stock Position:  0.02517311173805846
Bond Position:  [1.48939101]


portfolio before change:  [4.00978265]
curr_Stock_Price:  100.11497489806057
curr_Factors:  [100.1149749]
mat_Sqrt:  [[0.15]]
grads:  [0.05067541]
Stock Position:  0.05067541095164296
Bond Position:  [-1.06358485]


portfolio before change:  [4.03556383]
curr_Stock_Price:  100.62634995228315
curr_Factors:  [100.62634995]
mat_Sqrt:  [[0.15]]
grads:  [-0.01778095]
Stock Position:  -0.01778094805172366
Bond Position:  [5.82479573]


portfolio before change:  [4.02655781]
curr_Stock_Price:  101.17379938547036
curr_Factors:  [101.17379939]
mat_Sqrt:  [[0.15]]
grads:  [0.09829417]
Stock Position:  0.09829417437648721
Bond Position:  [-5.91823727]


portfolio before change:  [4.02782945]
curr_Stock_Price:  101.19426314902296
curr_Factors:  [101.19426315]
mat_Sqrt:  [[0.15]]
grads:  [0.1757313]
Stock Position:  0.1757312976331752
Bond Position:  [-13.75516973]


portfolio before change:  [4.19079795]
curr_Stock_Price:  102.13142120587482
curr_Factors:  [102.13142121]
mat_Sqrt:  [[0.15]]
grads:  [0.07733762]
Stock Position:  0.0773376200268263
Bond Position:  [-3.7078031]


portfolio before change:  [4.30782995]
curr_Stock_Price:  103.65067541131964
curr_Factors:  [103.65067541]
mat_Sqrt:  [[0.15]]
grads:  [0.00406182]
Stock Position:  0.004061823360489448
Bond Position:  [3.88681921]


portfolio before change:  [4.30548994]
curr_Stock_Price:  102.95495541251498
curr_Factors:  [102.95495541]
mat_Sqrt:  [[0.15]]
grads:  [-0.06710625]
Stock Position:  -0.06710624596596262
Bond Position:  [11.2144105]


portfolio before change:  [4.26543157]
curr_Stock_Price:  103.57278542515868
curr_Factors:  [103.57278543]
mat_Sqrt:  [[0.15]]
grads:  [-0.01657315]
Stock Position:  -0.01657314617414026
Bond Position:  [5.98195849]


portfolio before change:  [4.25980801]
curr_Stock_Price:  103.95722425410027
curr_Factors:  [103.95722425]
mat_Sqrt:  [[0.15]]
grads:  [0.14937264]
Stock Position:  0.1493726402558827
Bond Position:  [-11.26855705]


portfolio before change:  [4.13763421]
curr_Stock_Price:  103.14874197097872
curr_Factors:  [103.14874197]
mat_Sqrt:  [[0.15]]
grads:  [0.05026587]
Stock Position:  0.05026586798364783
Bond Position:  [-1.04722683]


portfolio before change:  [4.10980872]
curr_Stock_Price:  102.59777996193931
curr_Factors:  [102.59777996]
mat_Sqrt:  [[0.15]]
grads:  [0.04453112]
Stock Position:  0.044531120375875796
Bond Position:  [-0.45898537]


portfolio before change:  [4.17293957]
curr_Stock_Price:  104.01674768465286
curr_Factors:  [104.01674768]
mat_Sqrt:  [[0.15]]
grads:  [-0.0271751]
Stock Position:  -0.027175103692831833
Bond Position:  [6.99960547]


portfolio before change:  [4.16485408]
curr_Stock_Price:  104.34647932800173
curr_Factors:  [104.34647933]
mat_Sqrt:  [[0.15]]
grads:  [0.01727756]
Stock Position:  0.017277558333821115
Bond Position:  [2.3620017]


portfolio before change:  [4.16808563]
curr_Stock_Price:  104.51642723374218
curr_Factors:  [104.51642723]
mat_Sqrt:  [[0.15]]
grads:  [0.02648486]
Stock Position:  0.026484861314384028
Bond Position:  [1.39998255]


portfolio before change:  [4.17565089]
curr_Stock_Price:  104.79546385321139
curr_Factors:  [104.79546385]
mat_Sqrt:  [[0.15]]
grads:  [0.0611557]
Stock Position:  0.061155698659399384
Bond Position:  [-2.23318892]


portfolio before change:  [4.16814574]
curr_Stock_Price:  104.67730666101524
curr_Factors:  [104.67730666]
mat_Sqrt:  [[0.15]]
grads:  [-0.0323369]
Stock Position:  -0.032336902224230385
Bond Position:  [7.55308557]


portfolio before change:  [4.16498814]
curr_Stock_Price:  104.80415202745841
curr_Factors:  [104.80415203]
mat_Sqrt:  [[0.15]]
grads:  [0.0807057]
Stock Position:  0.08070569748458217
Bond Position:  [-4.29330404]


portfolio before change:  [4.14111629]
curr_Stock_Price:  104.51501310124365
curr_Factors:  [104.5150131]
mat_Sqrt:  [[0.15]]
grads:  [-0.11080143]
Stock Position:  -0.1108014309862807
Bond Position:  [15.7215293]


portfolio before change:  [4.13715811]
curr_Stock_Price:  104.56847352702057
curr_Factors:  [104.56847353]
mat_Sqrt:  [[0.15]]
grads:  [0.05495399]
Stock Position:  0.054953994000515934
Bond Position:  [-1.60929716]


portfolio before change:  [4.12316947]
curr_Stock_Price:  104.31758245984076
curr_Factors:  [104.31758246]
mat_Sqrt:  [[0.15]]
grads:  [0.23110911]
Stock Position:  0.23110910682289057
Bond Position:  [-19.98557384]


portfolio before change:  [4.15279207]
curr_Stock_Price:  104.4565685547168
curr_Factors:  [104.45656855]
mat_Sqrt:  [[0.15]]
grads:  [-0.12781559]
Stock Position:  -0.12781558555812847
Bond Position:  [17.50396954]


portfolio before change:  [4.13777012]
curr_Stock_Price:  104.59121634689329
curr_Factors:  [104.59121635]
mat_Sqrt:  [[0.15]]
grads:  [0.05364036]
Stock Position:  0.05364036325510892
Bond Position:  [-1.47254072]


portfolio before change:  [4.22043821]
curr_Stock_Price:  106.13580270660263
curr_Factors:  [106.13580271]
mat_Sqrt:  [[0.15]]
grads:  [0.05138524]
Stock Position:  0.051385244963097015
Bond Position:  [-1.23337601]


portfolio before change:  [4.25409967]
curr_Stock_Price:  106.793883516501
curr_Factors:  [106.79388352]
mat_Sqrt:  [[0.15]]
grads:  [-0.15971347]
Stock Position:  -0.15971346976496034
Bond Position:  [21.31052136]


portfolio before change:  [4.14028825]
curr_Stock_Price:  107.52316078345247
curr_Factors:  [107.52316078]
mat_Sqrt:  [[0.15]]
grads:  [0.00956117]
Stock Position:  0.009561170386115023
Bond Position:  [3.11224099]


portfolio before change:  [4.13943044]
curr_Stock_Price:  107.3927519293814
curr_Factors:  [107.39275193]
mat_Sqrt:  [[0.15]]
grads:  [-0.09655587]
Stock Position:  -0.09655587287422826
Bond Position:  [14.50883135]


portfolio before change:  [4.15349605]
curr_Stock_Price:  107.26586287748046
curr_Factors:  [107.26586288]
mat_Sqrt:  [[0.15]]
grads:  [0.4686683]
Stock Position:  0.4686682981961944
Bond Position:  [-46.11861336]


portfolio before change:  [4.02578388]
curr_Stock_Price:  107.0056639648108
curr_Factors:  [107.00566396]
mat_Sqrt:  [[0.15]]
grads:  [-0.01783931]
Stock Position:  -0.017839312545134513
Bond Position:  [5.93469136]


portfolio before change:  [4.00013347]
curr_Stock_Price:  108.4851094751592
curr_Factors:  [108.48510948]
mat_Sqrt:  [[0.15]]
grads:  [-0.10567669]
Stock Position:  -0.10567668636728991
Bond Position:  [15.46448036]


portfolio before change:  [4.03786202]
curr_Stock_Price:  108.14638411774814
curr_Factors:  [108.14638412]
mat_Sqrt:  [[0.15]]
grads:  [0.02612384]
Stock Position:  0.02612384133691691
Bond Position:  [1.21266304]


portfolio before change:  [4.05489828]
curr_Stock_Price:  108.79271580691582
curr_Factors:  [108.79271581]
mat_Sqrt:  [[0.15]]
grads:  [0.04980673]
Stock Position:  0.04980673261282623
Bond Position:  [-1.36371142]


portfolio before change:  [4.03008994]
curr_Stock_Price:  108.29804635581444
curr_Factors:  [108.29804636]
mat_Sqrt:  [[0.15]]
grads:  [0.0313346]
Stock Position:  0.0313345985974249
Bond Position:  [0.63661413]


portfolio before change:  [4.01927392]
curr_Stock_Price:  107.9503285903094
curr_Factors:  [107.95032859]
mat_Sqrt:  [[0.15]]
grads:  [0.05458682]
Stock Position:  0.054586821019291305
Bond Position:  [-1.87339134]


portfolio before change:  [4.00682617]
curr_Stock_Price:  107.72658292201577
curr_Factors:  [107.72658292]
mat_Sqrt:  [[0.15]]
grads:  [0.02141638]
Stock Position:  0.021416378831479045
Bond Position:  [1.69971286]


portfolio before change:  [4.01562179]
curr_Stock_Price:  108.12735778490338
curr_Factors:  [108.12735778]
mat_Sqrt:  [[0.15]]
grads:  [-0.40635609]
Stock Position:  -0.4063560944145422
Bond Position:  [47.9538326]


portfolio before change:  [3.57916401]
curr_Stock_Price:  109.2161869957095
curr_Factors:  [109.216187]
mat_Sqrt:  [[0.15]]
grads:  [0.06064067]
Stock Position:  0.06064067207695686
Bond Position:  [-3.04377897]


portfolio before change:  [3.6021548]
curr_Stock_Price:  109.60159313150164
curr_Factors:  [109.60159313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6021548]
Stock Price:  108.97353065781186
PL:  [-5.37137586]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.64423689e-03]
 [ 4.10194205e-03]
 [ 4.69600998e-03]
 [-2.36151179e-03]
 [ 2.99230264e-03]
 [-2.41271203e-02]
 [-2.19708006e-02]
 [ 2.02085371e-02]
 [-6.09102890e-03]
 [ 4.13679894e-04]
 [ 1.12049965e-03]
 [ 6.46813352e-03]
 [ 1.43437829e-02]
 [ 5.34644016e-03]
 [ 2.29319346e-02]
 [-2.03235305e-03]
 [ 9.64635732e-03]
 [ 2.99583365e-03]
 [ 1.09129122e-02]
 [-4.65027363e-03]
 [ 1.98347629e-02]
 [-2.72926311e-03]
 [ 2.05244120e-02]
 [ 4.56420983e-03]
 [ 1.68770848e-02]
 [-1.07751639e-02]
 [ 1.11681169e-02]
 [-1.06914098e-02]
 [-1.87063736e-02]
 [-4.02792998e-03]
 [-3.05496232e-03]
 [ 5.16566774e-03]
 [ 5.06944868e-03]
 [-7.64056239e-03]
 [ 2.13895464e-02]
 [ 5.48391906e-03]
 [ 5.09136601e-04]
 [ 7.85679661e-03]
 [-4.97019480e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.22702136]
curr_Stock_Price:  100.0822371601201
curr_Factors:  [100.08223716]
mat_Sqrt:  [[0.15]]
grads:  [0.03096158]
Stock Position:  0.030961579272786553
Bond Position:  [0.12831724]


portfolio before change:  [3.22294102]
curr_Stock_Price:  99.94993208300812
curr_Factors:  [99.94993208]
mat_Sqrt:  [[0.15]]
grads:  [0.02734628]
Stock Position:  0.02734628036463164
Bond Position:  [0.48968216]


portfolio before change:  [3.21220953]
curr_Stock_Price:  99.55526391278752
curr_Factors:  [99.55526391]
mat_Sqrt:  [[0.15]]
grads:  [0.03130673]
Stock Position:  0.0313067332053402
Bond Position:  [0.09545944]


portfolio before change:  [3.20603275]
curr_Stock_Price:  99.3575838158114
curr_Factors:  [99.35758382]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574341]
Stock Position:  -0.015743411906345886
Bond Position:  [4.77026011]


portfolio before change:  [3.21164522]
curr_Stock_Price:  99.03896446997479
curr_Factors:  [99.03896447]
mat_Sqrt:  [[0.15]]
grads:  [0.01994868]
Stock Position:  0.019948684235626124
Bond Position:  [1.23594819]


portfolio before change:  [3.1988661]
curr_Stock_Price:  98.39061958355502
curr_Factors:  [98.39061958]
mat_Sqrt:  [[0.15]]
grads:  [-0.16084747]
Stock Position:  -0.16084746871011943
Bond Position:  [19.0247482]


portfolio before change:  [3.09279652]
curr_Stock_Price:  99.06484728537538
curr_Factors:  [99.06484729]
mat_Sqrt:  [[0.15]]
grads:  [-0.146472]
Stock Position:  -0.1464720042875051
Bond Position:  [17.60302326]


portfolio before change:  [3.22379103]
curr_Stock_Price:  98.18553937738274
curr_Factors:  [98.18553938]
mat_Sqrt:  [[0.15]]
grads:  [0.13472358]
Stock Position:  0.13472358056526565
Bond Position:  [-10.0041164]


portfolio before change:  [3.18019327]
curr_Stock_Price:  97.8712130544073
curr_Factors:  [97.87121305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04060686]
Stock Position:  -0.040606859329818966
Bond Position:  [7.15443585]


portfolio before change:  [3.16881245]
curr_Stock_Price:  98.1735061606084
curr_Factors:  [98.17350616]
mat_Sqrt:  [[0.15]]
grads:  [0.00275787]
Stock Position:  0.0027578659609535663
Bond Position:  [2.89806308]


portfolio before change:  [3.1708572]
curr_Stock_Price:  98.78356743901637
curr_Factors:  [98.78356744]
mat_Sqrt:  [[0.15]]
grads:  [0.00747]
Stock Position:  0.00746999768280144
Bond Position:  [2.43294418]


portfolio before change:  [3.17200412]
curr_Stock_Price:  98.89638925252815
curr_Factors:  [98.89638925]
mat_Sqrt:  [[0.15]]
grads:  [0.04312089]
Stock Position:  0.04312089010899265
Bond Position:  [-1.09249622]


portfolio before change:  [3.19232039]
curr_Stock_Price:  99.37070336033817
curr_Factors:  [99.37070336]
mat_Sqrt:  [[0.15]]
grads:  [0.09562522]
Stock Position:  0.09562521950770161
Bond Position:  [-6.31002493]


portfolio before change:  [3.25091878]
curr_Stock_Price:  99.99174445635248
curr_Factors:  [99.99174446]
mat_Sqrt:  [[0.15]]
grads:  [0.03564293]
Stock Position:  0.03564293438967013
Bond Position:  [-0.31308041]


portfolio before change:  [3.27743263]
curr_Stock_Price:  100.7367164222155
curr_Factors:  [100.73671642]
mat_Sqrt:  [[0.15]]
grads:  [0.15287956]
Stock Position:  0.15287956389390123
Bond Position:  [-12.12315264]


portfolio before change:  [3.12061406]
curr_Stock_Price:  99.72086395122395
curr_Factors:  [99.72086395]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354902]
Stock Position:  -0.013549020334082026
Bond Position:  [4.47173407]


portfolio before change:  [3.11772392]
curr_Stock_Price:  99.9754318655872
curr_Factors:  [99.97543187]
mat_Sqrt:  [[0.15]]
grads:  [0.06430905]
Stock Position:  0.06430904882004536
Bond Position:  [-3.31160101]


portfolio before change:  [3.09227669]
curr_Stock_Price:  99.58616711726032
curr_Factors:  [99.58616712]
mat_Sqrt:  [[0.15]]
grads:  [0.01997222]
Stock Position:  0.019972224302548757
Bond Position:  [1.10331943]


portfolio before change:  [3.08775007]
curr_Stock_Price:  99.35261556570907
curr_Factors:  [99.35261557]
mat_Sqrt:  [[0.15]]
grads:  [0.07275275]
Stock Position:  0.07275274786669268
Bond Position:  [-4.14042572]


portfolio before change:  [2.97199455]
curr_Stock_Price:  97.7686488201974
curr_Factors:  [97.76864882]
mat_Sqrt:  [[0.15]]
grads:  [-0.03100182]
Stock Position:  -0.03100182418059174
Bond Position:  [6.00300102]


portfolio before change:  [2.98570798]
curr_Stock_Price:  97.3505120640283
curr_Factors:  [97.35051206]
mat_Sqrt:  [[0.15]]
grads:  [0.13223175]
Stock Position:  0.13223175235545967
Bond Position:  [-9.88712082]


portfolio before change:  [2.92669895]
curr_Stock_Price:  96.91360442684119
curr_Factors:  [96.91360443]
mat_Sqrt:  [[0.15]]
grads:  [-0.01819509]
Stock Position:  -0.01819508739301919
Bond Position:  [4.69005045]


portfolio before change:  [2.91139858]
curr_Stock_Price:  97.78673367102876
curr_Factors:  [97.78673367]
mat_Sqrt:  [[0.15]]
grads:  [0.13682941]
Stock Position:  0.13682941335335153
Bond Position:  [-10.46870282]


portfolio before change:  [2.89236476]
curr_Stock_Price:  97.65719169451367
curr_Factors:  [97.65719169]
mat_Sqrt:  [[0.15]]
grads:  [0.03042807]
Stock Position:  0.03042806550185308
Bond Position:  [-0.07915467]


portfolio before change:  [2.88923037]
curr_Stock_Price:  97.55450724643269
curr_Factors:  [97.55450725]
mat_Sqrt:  [[0.15]]
grads:  [0.1125139]
Stock Position:  0.1125138989960174
Bond Position:  [-8.0870076]


portfolio before change:  [3.0249759]
curr_Stock_Price:  98.7699701474631
curr_Factors:  [98.76997015]
mat_Sqrt:  [[0.15]]
grads:  [-0.07183443]
Stock Position:  -0.07183442632694574
Bond Position:  [10.12006005]


portfolio before change:  [2.98973525]
curr_Stock_Price:  99.27816300548783
curr_Factors:  [99.27816301]
mat_Sqrt:  [[0.15]]
grads:  [0.07445411]
Stock Position:  0.07445411283072696
Bond Position:  [-4.4019323]


portfolio before change:  [3.03686931]
curr_Stock_Price:  99.9186156755451
curr_Factors:  [99.91861568]
mat_Sqrt:  [[0.15]]
grads:  [-0.07127607]
Stock Position:  -0.07127606557453028
Bond Position:  [10.15867511]


portfolio before change:  [3.11408425]
curr_Stock_Price:  98.8531103191964
curr_Factors:  [98.85311032]
mat_Sqrt:  [[0.15]]
grads:  [-0.12470916]
Stock Position:  -0.12470915737038255
Bond Position:  [15.44197234]


portfolio before change:  [3.08271805]
curr_Stock_Price:  99.1201041077794
curr_Factors:  [99.12010411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685287]
Stock Position:  -0.02685286651979247
Bond Position:  [5.74437697]


portfolio before change:  [3.06348591]
curr_Stock_Price:  99.86304995057162
curr_Factors:  [99.86304995]
mat_Sqrt:  [[0.15]]
grads:  [-0.02036642]
Stock Position:  -0.020366415444637707
Bond Position:  [5.09733828]


portfolio before change:  [3.03104364]
curr_Stock_Price:  101.48726683497765
curr_Factors:  [101.48726683]
mat_Sqrt:  [[0.15]]
grads:  [0.03443778]
Stock Position:  0.034437784951751024
Bond Position:  [-0.46395303]


portfolio before change:  [3.04397073]
curr_Stock_Price:  101.86432597140315
curr_Factors:  [101.86432597]
mat_Sqrt:  [[0.15]]
grads:  [0.03379632]
Stock Position:  0.03379632450748331
Bond Position:  [-0.39866909]


portfolio before change:  [3.0298491]
curr_Stock_Price:  101.44795554256655
curr_Factors:  [101.44795554]
mat_Sqrt:  [[0.15]]
grads:  [-0.05093708]
Stock Position:  -0.05093708258815355
Bond Position:  [8.19731199]


portfolio before change:  [3.02889804]
curr_Stock_Price:  101.48674434050625
curr_Factors:  [101.48674434]
mat_Sqrt:  [[0.15]]
grads:  [0.14259698]
Stock Position:  0.1425969756870911
Bond Position:  [-11.44280477]


portfolio before change:  [2.99568958]
curr_Stock_Price:  101.26389232498246
curr_Factors:  [101.26389232]
mat_Sqrt:  [[0.15]]
grads:  [0.03655946]
Stock Position:  0.03655946040829342
Bond Position:  [-0.70646368]


portfolio before change:  [3.0040123]
curr_Stock_Price:  101.49395697574761
curr_Factors:  [101.49395698]
mat_Sqrt:  [[0.15]]
grads:  [0.00339424]
Stock Position:  0.0033942440097896004
Bond Position:  [2.65951705]


portfolio before change:  [3.00248159]
curr_Stock_Price:  100.94503656075771
curr_Factors:  [100.94503656]
mat_Sqrt:  [[0.15]]
grads:  [0.05237864]
Stock Position:  0.05237864404644205
Bond Position:  [-2.28488254]


portfolio before change:  [2.94799663]
curr_Stock_Price:  99.9102763087763
curr_Factors:  [99.91027631]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.94799663]
Stock Price:  100.35525457391563
PL:  [2.59274205]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.82282043e-03]
 [-1.68333252e-06]
 [ 1.31893786e-02]
 [ 9.02230737e-03]
 [ 3.58218389e-03]
 [ 2.67642685e-02]
 [ 2.08843678e-02]
 [ 7.25015758e-03]
 [-8.33752185e-03]
 [-3.02429367e-03]
 [ 9.08573128e-03]
 [ 5.04342275e-03]
 [ 7.49922096e-03]
 [-5.05553314e-03]
 [ 1.01964411e-02]
 [ 2.96076992e-03]
 [ 9.11841056e-03]
 [ 5.38692047e-03]
 [ 1.18624846e-02]
 [-1.63539545e-02]
 [-4.31784495e-03]
 [ 3.14664862e-02]
 [-4.14667146e-02]
 [ 5.90777988e-03]
 [ 4.01746403e-03]
 [-1.44962380e-02]
 [-2.94402984e-04]
 [-1.15622960e-02]
 [ 6.42631368e-02]
 [-2.98078498e-03]
 [-9.76114590e-03]
 [ 4.06558543e-03]
 [ 6.66319250e-03]
 [ 3.75406900e-03]
 [ 8.18231301e-03]
 [ 3.69395075e-03]
 [-6.14410245e-02]
 [ 9.27867552e-03]
 [-3.89103641e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.38808304]
curr_Stock_Price:  100.73772083885801
curr_Factors:  [100.73772084]
mat_Sqrt:  [[0.15]]
grads:  [0.0388188]
Stock Position:  0.038818802855985976
Bond Position:  [9.47756531]


portfolio before change:  [13.40998569]
curr_Stock_Price:  101.27142838865561
curr_Factors:  [101.27142839]
mat_Sqrt:  [[0.15]]
grads:  [-1.12222168e-05]
Stock Position:  -1.1222216781993366e-05
Bond Position:  [13.41112218]


portfolio before change:  [13.41164636]
curr_Stock_Price:  102.68183801206872
curr_Factors:  [102.68183801]
mat_Sqrt:  [[0.15]]
grads:  [0.08792919]
Stock Position:  0.08792919045689183
Bond Position:  [4.38291547]


portfolio before change:  [13.35948037]
curr_Stock_Price:  102.08233413551862
curr_Factors:  [102.08233414]
mat_Sqrt:  [[0.15]]
grads:  [0.06014872]
Stock Position:  0.060148715789021354
Bond Position:  [7.21935907]


portfolio before change:  [13.38032404]
curr_Stock_Price:  102.41386559326465
curr_Factors:  [102.41386559]
mat_Sqrt:  [[0.15]]
grads:  [0.02388123]
Stock Position:  0.023881225955372083
Bond Position:  [10.93455537]


portfolio before change:  [13.36527951]
curr_Stock_Price:  101.72665476466507
curr_Factors:  [101.72665476]
mat_Sqrt:  [[0.15]]
grads:  [0.17842846]
Stock Position:  0.1784284568907744
Bond Position:  [-4.78565053]


portfolio before change:  [13.52323504]
curr_Stock_Price:  102.61526736495564
curr_Factors:  [102.61526736]
mat_Sqrt:  [[0.15]]
grads:  [0.13922912]
Stock Position:  0.13922911867229212
Bond Position:  [-0.7637982]


portfolio before change:  [13.52739019]
curr_Stock_Price:  102.6457971277621
curr_Factors:  [102.64579713]
mat_Sqrt:  [[0.15]]
grads:  [0.04833438]
Stock Position:  0.048334383898704675
Bond Position:  [8.56606882]


portfolio before change:  [13.48766769]
curr_Stock_Price:  101.80181575258972
curr_Factors:  [101.80181575]
mat_Sqrt:  [[0.15]]
grads:  [-0.05558348]
Stock Position:  -0.05558347900568177
Bond Position:  [19.14616678]


portfolio before change:  [13.44246455]
curr_Stock_Price:  102.65812352652978
curr_Factors:  [102.65812353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016196]
Stock Position:  -0.020161957804826932
Bond Position:  [15.5122533]


portfolio before change:  [13.4718874]
curr_Stock_Price:  101.29497700029286
curr_Factors:  [101.294977]
mat_Sqrt:  [[0.15]]
grads:  [0.06057154]
Stock Position:  0.06057154185896855
Bond Position:  [7.33629447]


portfolio before change:  [13.49170738]
curr_Stock_Price:  101.60705227788851
curr_Factors:  [101.60705228]
mat_Sqrt:  [[0.15]]
grads:  [0.03362282]
Stock Position:  0.0336228183287517
Bond Position:  [10.07539192]


portfolio before change:  [13.51727362]
curr_Stock_Price:  102.32997625338722
curr_Factors:  [102.32997625]
mat_Sqrt:  [[0.15]]
grads:  [0.04999481]
Stock Position:  0.04999480639317873
Bond Position:  [8.40130627]


portfolio before change:  [13.51826031]
curr_Stock_Price:  102.32870534267434
curr_Factors:  [102.32870534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03370355]
Stock Position:  -0.03370355423632356
Bond Position:  [16.96710138]


portfolio before change:  [13.50743373]
curr_Stock_Price:  102.71286669269493
curr_Factors:  [102.71286669]
mat_Sqrt:  [[0.15]]
grads:  [0.06797627]
Stock Position:  0.06797627419552466
Bond Position:  [6.52539574]


portfolio before change:  [13.5613435]
curr_Stock_Price:  103.4939339203993
curr_Factors:  [103.49393392]
mat_Sqrt:  [[0.15]]
grads:  [0.01973847]
Stock Position:  0.019738466123682408
Bond Position:  [11.51853199]


portfolio before change:  [13.56666043]
curr_Stock_Price:  103.69035378487474
curr_Factors:  [103.69035378]
mat_Sqrt:  [[0.15]]
grads:  [0.0607894]
Stock Position:  0.060789403721492725
Bond Position:  [7.26338565]


portfolio before change:  [13.56538455]
curr_Stock_Price:  103.65442871927635
curr_Factors:  [103.65442872]
mat_Sqrt:  [[0.15]]
grads:  [0.0359128]
Stock Position:  0.035912803120757314
Bond Position:  [9.84286346]


portfolio before change:  [13.57291372]
curr_Stock_Price:  103.82981852926075
curr_Factors:  [103.82981853]
mat_Sqrt:  [[0.15]]
grads:  [0.07908323]
Stock Position:  0.07908323092289128
Bond Position:  [5.36171621]


portfolio before change:  [13.60349845]
curr_Stock_Price:  104.20808422432438
curr_Factors:  [104.20808422]
mat_Sqrt:  [[0.15]]
grads:  [-0.10902636]
Stock Position:  -0.10902636356905573
Bond Position:  [24.96492693]


portfolio before change:  [13.78547373]
curr_Stock_Price:  102.56761435894447
curr_Factors:  [102.56761436]
mat_Sqrt:  [[0.15]]
grads:  [-0.02878563]
Stock Position:  -0.028785632979931565
Bond Position:  [16.73794743]


portfolio before change:  [13.7567917]
curr_Stock_Price:  103.63670322447729
curr_Factors:  [103.63670322]
mat_Sqrt:  [[0.15]]
grads:  [0.20977657]
Stock Position:  0.20977657485534804
Bond Position:  [-7.98376093]


portfolio before change:  [13.62444399]
curr_Stock_Price:  103.01056240700821
curr_Factors:  [103.01056241]
mat_Sqrt:  [[0.15]]
grads:  [-0.27644476]
Stock Position:  -0.27644476406678575
Bond Position:  [42.10117461]


portfolio before change:  [13.699901]
curr_Stock_Price:  102.75664538159168
curr_Factors:  [102.75664538]
mat_Sqrt:  [[0.15]]
grads:  [0.0393852]
Stock Position:  0.039385199188532616
Bond Position:  [9.65281005]


portfolio before change:  [13.72535371]
curr_Stock_Price:  103.37225808971598
curr_Factors:  [103.37225809]
mat_Sqrt:  [[0.15]]
grads:  [0.02678309]
Stock Position:  0.026783093540684526
Bond Position:  [10.95672485]


portfolio before change:  [13.7564681]
curr_Stock_Price:  104.48283610963539
curr_Factors:  [104.48283611]
mat_Sqrt:  [[0.15]]
grads:  [-0.09664159]
Stock Position:  -0.09664158635609862
Bond Position:  [23.85385513]


portfolio before change:  [13.70012323]
curr_Stock_Price:  105.09672076017108
curr_Factors:  [105.09672076]
mat_Sqrt:  [[0.15]]
grads:  [-0.00196269]
Stock Position:  -0.0019626865568566957
Bond Position:  [13.90639515]


portfolio before change:  [13.70139914]
curr_Stock_Price:  105.33236714740241
curr_Factors:  [105.33236715]
mat_Sqrt:  [[0.15]]
grads:  [-0.07708197]
Stock Position:  -0.07708197300899922
Bond Position:  [21.82062582]


portfolio before change:  [13.64759473]
curr_Stock_Price:  106.06577024395499
curr_Factors:  [106.06577024]
mat_Sqrt:  [[0.15]]
grads:  [0.42842091]
Stock Position:  0.4284209119174067
Bond Position:  [-31.79319928]


portfolio before change:  [13.70489968]
curr_Stock_Price:  106.20880563135545
curr_Factors:  [106.20880563]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198719]
Stock Position:  -0.019871899839381105
Bond Position:  [15.81547043]


portfolio before change:  [13.71231083]
curr_Stock_Price:  105.93534946371025
curr_Factors:  [105.93534946]
mat_Sqrt:  [[0.15]]
grads:  [-0.06507431]
Stock Position:  -0.06507430598781792
Bond Position:  [20.60598018]


portfolio before change:  [13.61876483]
curr_Stock_Price:  107.41245944454172
curr_Factors:  [107.41245944]
mat_Sqrt:  [[0.15]]
grads:  [0.0271039]
Stock Position:  0.027103902848435807
Bond Position:  [10.70746797]


portfolio before change:  [13.61636685]
curr_Stock_Price:  107.27460096056656
curr_Factors:  [107.27460096]
mat_Sqrt:  [[0.15]]
grads:  [0.04442128]
Stock Position:  0.04442128331171836
Bond Position:  [8.85109141]


portfolio before change:  [13.64358888]
curr_Stock_Price:  107.86250783843758
curr_Factors:  [107.86250784]
mat_Sqrt:  [[0.15]]
grads:  [0.02502713]
Stock Position:  0.02502712667151194
Bond Position:  [10.94410023]


portfolio before change:  [13.63932991]
curr_Stock_Price:  107.63766925083114
curr_Factors:  [107.63766925]
mat_Sqrt:  [[0.15]]
grads:  [0.05454875]
Stock Position:  0.054548753393023494
Bond Position:  [7.76782924]


portfolio before change:  [13.59372244]
curr_Stock_Price:  106.78378148065363
curr_Factors:  [106.78378148]
mat_Sqrt:  [[0.15]]
grads:  [0.02462634]
Stock Position:  0.024626338321311107
Bond Position:  [10.96402891]


portfolio before change:  [13.62919426]
curr_Stock_Price:  108.16852755569077
curr_Factors:  [108.16852756]
mat_Sqrt:  [[0.15]]
grads:  [-0.40960683]
Stock Position:  -0.4096068296695737
Bond Position:  [57.9357619]


portfolio before change:  [13.55964188]
curr_Stock_Price:  108.3560117284028
curr_Factors:  [108.35601173]
mat_Sqrt:  [[0.15]]
grads:  [0.06185784]
Stock Position:  0.06185783683185319
Bond Position:  [6.85697339]


portfolio before change:  [13.63513686]
curr_Stock_Price:  109.5626139154628
curr_Factors:  [109.56261392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.63513686]
Stock Price:  108.31322055918594
PL:  [5.3219163]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.39952842e-03]
 [-5.36793185e-03]
 [ 6.00099483e-03]
 [ 1.83966143e-04]
 [ 1.45154771e-02]
 [ 2.64413404e-02]
 [-5.51931940e-03]
 [ 2.19122520e-02]
 [-6.23415020e-03]
 [-1.97494363e-03]
 [ 1.35600112e-02]
 [ 5.25586759e-03]
 [ 6.89209194e-03]
 [-4.77425863e-03]
 [ 1.17797748e-02]
 [ 1.84256503e-03]
 [ 8.75213882e-03]
 [ 1.09462412e-02]
 [ 1.16653412e-02]
 [-1.20636992e-02]
 [ 4.36469510e-03]
 [ 1.29737512e-02]
 [ 1.31768556e-02]
 [ 4.92384037e-03]
 [ 1.46709918e-02]
 [-1.08888256e-02]
 [ 1.47588457e-02]
 [-1.11279956e-02]
 [-1.78943407e-02]
 [-5.96530689e-03]
 [-2.74723728e-03]
 [ 5.26568575e-03]
 [ 5.51197492e-03]
 [-1.10613225e-02]
 [ 1.99171957e-02]
 [ 5.66957727e-03]
 [ 3.03562813e-03]
 [ 1.09489909e-02]
 [-3.53136928e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.86191701]
curr_Stock_Price:  99.36689674201818
curr_Factors:  [99.36689674]
mat_Sqrt:  [[0.15]]
grads:  [0.03599686]
Stock Position:  0.03599685615573773
Bond Position:  [-11.43881289]


portfolio before change:  [-7.8692267]
curr_Stock_Price:  99.20355596541414
curr_Factors:  [99.20355597]
mat_Sqrt:  [[0.15]]
grads:  [-0.03578621]
Stock Position:  -0.035786212330305996
Bond Position:  [-4.31910718]


portfolio before change:  [-7.88826817]
curr_Stock_Price:  99.72055817570977
curr_Factors:  [99.72055818]
mat_Sqrt:  [[0.15]]
grads:  [0.04000663]
Stock Position:  0.04000663220454562
Bond Position:  [-11.87775187]


portfolio before change:  [-7.83534524]
curr_Stock_Price:  101.08052624840221
curr_Factors:  [101.08052625]
mat_Sqrt:  [[0.15]]
grads:  [0.00122644]
Stock Position:  0.001226440953328698
Bond Position:  [-7.95931454]


portfolio before change:  [-7.83606093]
curr_Stock_Price:  101.30824813178849
curr_Factors:  [101.30824813]
mat_Sqrt:  [[0.15]]
grads:  [0.09676985]
Stock Position:  0.09676984748852312
Bond Position:  [-17.63964465]


portfolio before change:  [-7.83889936]
curr_Stock_Price:  101.30170337998221
curr_Factors:  [101.30170338]
mat_Sqrt:  [[0.15]]
grads:  [0.1762756]
Stock Position:  0.17627560262419328
Bond Position:  [-25.69591817]


portfolio before change:  [-7.88181697]
curr_Stock_Price:  101.07645710387597
curr_Factors:  [101.0764571]
mat_Sqrt:  [[0.15]]
grads:  [-0.03679546]
Stock Position:  -0.03679546266725585
Bond Position:  [-4.16266197]


portfolio before change:  [-7.84295328]
curr_Stock_Price:  100.00610612076778
curr_Factors:  [100.00610612]
mat_Sqrt:  [[0.15]]
grads:  [0.14608168]
Stock Position:  0.14608167972774108
Bond Position:  [-22.45201324]


portfolio before change:  [-7.75040581]
curr_Stock_Price:  100.65885150842732
curr_Factors:  [100.65885151]
mat_Sqrt:  [[0.15]]
grads:  [-0.041561]
Stock Position:  -0.04156100134536967
Bond Position:  [-3.56692315]


portfolio before change:  [-7.78450974]
curr_Stock_Price:  101.46869802754543
curr_Factors:  [101.46869803]
mat_Sqrt:  [[0.15]]
grads:  [-0.01316629]
Stock Position:  -0.013166290879639785
Bond Position:  [-6.44854335]


portfolio before change:  [-7.79748347]
curr_Stock_Price:  102.39284682483537
curr_Factors:  [102.39284682]
mat_Sqrt:  [[0.15]]
grads:  [0.09040007]
Stock Position:  0.0904000745982385
Bond Position:  [-17.05380446]


portfolio before change:  [-7.85546687]
curr_Stock_Price:  101.7750204963227
curr_Factors:  [101.7750205]
mat_Sqrt:  [[0.15]]
grads:  [0.03503912]
Stock Position:  0.03503911726986681
Bond Position:  [-11.42157375]


portfolio before change:  [-7.83049808]
curr_Stock_Price:  102.52836662193776
curr_Factors:  [102.52836662]
mat_Sqrt:  [[0.15]]
grads:  [0.04594728]
Stock Position:  0.04594727961142624
Bond Position:  [-12.54139761]


portfolio before change:  [-7.82490972]
curr_Stock_Price:  102.68411325647259
curr_Factors:  [102.68411326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182839]
Stock Position:  -0.031828390879332626
Bond Position:  [-4.55663962]


portfolio before change:  [-7.82069287]
curr_Stock_Price:  102.53372996831573
curr_Factors:  [102.53372997]
mat_Sqrt:  [[0.15]]
grads:  [0.07853183]
Stock Position:  0.07853183224405061
Bond Position:  [-15.87285455]


portfolio before change:  [-7.89834823]
curr_Stock_Price:  101.57015729824566
curr_Factors:  [101.5701573]
mat_Sqrt:  [[0.15]]
grads:  [0.01228377]
Stock Position:  0.012283766852242665
Bond Position:  [-9.14601236]


portfolio before change:  [-7.8930368]
curr_Stock_Price:  102.09562731067861
curr_Factors:  [102.09562731]
mat_Sqrt:  [[0.15]]
grads:  [0.05834759]
Stock Position:  0.058347592130295334
Bond Position:  [-13.85007082]


portfolio before change:  [-7.86727753]
curr_Stock_Price:  102.56678034157652
curr_Factors:  [102.56678034]
mat_Sqrt:  [[0.15]]
grads:  [0.07297494]
Stock Position:  0.07297494121927572
Bond Position:  [-15.35208229]


portfolio before change:  [-7.95782646]
curr_Stock_Price:  101.35225649667089
curr_Factors:  [101.3522565]
mat_Sqrt:  [[0.15]]
grads:  [0.07776894]
Stock Position:  0.07776894110014777
Bond Position:  [-15.83988413]


portfolio before change:  [-8.10468103]
curr_Stock_Price:  99.48937320452336
curr_Factors:  [99.4893732]
mat_Sqrt:  [[0.15]]
grads:  [-0.08042466]
Stock Position:  -0.08042466148571371
Bond Position:  [-0.10328187]


portfolio before change:  [-8.09517346]
curr_Stock_Price:  99.37099550794039
curr_Factors:  [99.37099551]
mat_Sqrt:  [[0.15]]
grads:  [0.02909797]
Stock Position:  0.029097967325082675
Bond Position:  [-10.98666744]


portfolio before change:  [-8.08384574]
curr_Stock_Price:  99.80749109884859
curr_Factors:  [99.8074911]
mat_Sqrt:  [[0.15]]
grads:  [0.08649167]
Stock Position:  0.08649167450173954
Bond Position:  [-16.71636278]


portfolio before change:  [-8.10063017]
curr_Stock_Price:  99.6375932776376
curr_Factors:  [99.63759328]
mat_Sqrt:  [[0.15]]
grads:  [0.0878457]
Stock Position:  0.08784570389013126
Bond Position:  [-16.85336468]


portfolio before change:  [-8.19122412]
curr_Stock_Price:  98.63029128913988
curr_Factors:  [98.63029129]
mat_Sqrt:  [[0.15]]
grads:  [0.0328256]
Stock Position:  0.032825602443833084
Bond Position:  [-11.42882285]


portfolio before change:  [-8.20345307]
curr_Stock_Price:  98.30127179850264
curr_Factors:  [98.3012718]
mat_Sqrt:  [[0.15]]
grads:  [0.09780661]
Stock Position:  0.09780661217357225
Bond Position:  [-17.81796744]


portfolio before change:  [-8.18324258]
curr_Stock_Price:  98.53068245890475
curr_Factors:  [98.53068246]
mat_Sqrt:  [[0.15]]
grads:  [-0.07259217]
Stock Position:  -0.07259217069727507
Bond Position:  [-1.03068646]


portfolio before change:  [-8.17624689]
curr_Stock_Price:  98.43253778983744
curr_Factors:  [98.43253779]
mat_Sqrt:  [[0.15]]
grads:  [0.0983923]
Stock Position:  0.09839230464663644
Bond Position:  [-17.86125113]


portfolio before change:  [-8.08224657]
curr_Stock_Price:  99.41059307189545
curr_Factors:  [99.41059307]
mat_Sqrt:  [[0.15]]
grads:  [-0.07418664]
Stock Position:  -0.07418663743520137
Bond Position:  [-0.70730895]


portfolio before change:  [-8.10380546]
curr_Stock_Price:  99.70000458459549
curr_Factors:  [99.70000458]
mat_Sqrt:  [[0.15]]
grads:  [-0.1192956]
Stock Position:  -0.11929560490014711
Bond Position:  [3.7899669]


portfolio before change:  [-8.1386587]
curr_Stock_Price:  99.99613463718605
curr_Factors:  [99.99613464]
mat_Sqrt:  [[0.15]]
grads:  [-0.03976871]
Stock Position:  -0.03976871260104684
Bond Position:  [-4.16194116]


portfolio before change:  [-8.14346699]
curr_Stock_Price:  100.10395852385892
curr_Factors:  [100.10395852]
mat_Sqrt:  [[0.15]]
grads:  [-0.01831492]
Stock Position:  -0.018314915218331302
Bond Position:  [-6.31007148]


portfolio before change:  [-8.15496051]
curr_Stock_Price:  100.68843921287477
curr_Factors:  [100.68843921]
mat_Sqrt:  [[0.15]]
grads:  [0.03510457]
Stock Position:  0.03510457167553469
Bond Position:  [-11.68958504]


portfolio before change:  [-8.18502208]
curr_Stock_Price:  99.87372256672913
curr_Factors:  [99.87372257]
mat_Sqrt:  [[0.15]]
grads:  [0.0367465]
Stock Position:  0.03674649944475382
Bond Position:  [-11.85503177]


portfolio before change:  [-8.17060816]
curr_Stock_Price:  100.30630504539532
curr_Factors:  [100.30630505]
mat_Sqrt:  [[0.15]]
grads:  [-0.07374215]
Stock Position:  -0.07374214984236374
Bond Position:  [-0.77380558]


portfolio before change:  [-8.17245518]
curr_Stock_Price:  100.33004033835729
curr_Factors:  [100.33004034]
mat_Sqrt:  [[0.15]]
grads:  [0.1327813]
Stock Position:  0.13278130458867815
Bond Position:  [-21.49440883]


portfolio before change:  [-8.25991456]
curr_Stock_Price:  99.69160403933272
curr_Factors:  [99.69160404]
mat_Sqrt:  [[0.15]]
grads:  [0.03779718]
Stock Position:  0.0377971817866175
Bond Position:  [-12.02797624]


portfolio before change:  [-8.28388413]
curr_Stock_Price:  99.09722159349568
curr_Factors:  [99.09722159]
mat_Sqrt:  [[0.15]]
grads:  [0.02023752]
Stock Position:  0.020237520837462337
Bond Position:  [-10.28936622]


portfolio before change:  [-8.30216485]
curr_Stock_Price:  98.25747077781566
curr_Factors:  [98.25747078]
mat_Sqrt:  [[0.15]]
grads:  [0.07299327]
Stock Position:  0.07299327265911214
Bond Position:  [-15.47429921]


portfolio before change:  [-8.20265062]
curr_Stock_Price:  99.64730633248918
curr_Factors:  [99.64730633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.20265062]
Stock Price:  100.74891815486265
PL:  [-8.95156877]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.91635304e-03]
 [ 2.93512566e-03]
 [-8.21618448e-03]
 [-2.51269136e-03]
 [ 9.62119778e-03]
 [ 1.34769170e-03]
 [-4.63513533e-03]
 [ 1.80290917e-02]
 [-7.02946875e-03]
 [-5.06560821e-04]
 [ 1.06873633e-02]
 [ 5.58320086e-03]
 [ 1.17435359e-02]
 [ 5.79215629e-04]
 [ 2.23100329e-02]
 [ 1.71917809e-03]
 [ 9.35767342e-03]
 [ 6.57894831e-04]
 [ 1.13425846e-02]
 [-1.22529874e-02]
 [ 7.56010371e-03]
 [-1.27514813e-03]
 [ 1.83596772e-02]
 [ 4.80892326e-03]
 [ 1.50944751e-02]
 [-1.12673678e-02]
 [ 1.82551811e-02]
 [-1.48445021e-02]
 [-3.03816337e-02]
 [-1.38084845e-03]
 [-3.63482004e-03]
 [ 5.63157457e-03]
 [ 6.71177257e-03]
 [-1.24254405e-02]
 [ 2.09990887e-02]
 [ 5.62688296e-03]
 [ 2.76593783e-03]
 [ 1.03622385e-02]
 [-2.33737542e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.96516366]
curr_Stock_Price:  100.58141983821396
curr_Factors:  [100.58141984]
mat_Sqrt:  [[0.15]]
grads:  [0.03944235]
Stock Position:  0.03944235361711116
Bond Position:  [6.99799573]


portfolio before change:  [10.97341493]
curr_Stock_Price:  100.76843877344785
curr_Factors:  [100.76843877]
mat_Sqrt:  [[0.15]]
grads:  [0.0195675]
Stock Position:  0.019567504374216397
Bond Position:  [9.00162806]


portfolio before change:  [10.93807455]
curr_Stock_Price:  98.90485659262728
curr_Factors:  [98.90485659]
mat_Sqrt:  [[0.15]]
grads:  [-0.05477456]
Stock Position:  -0.05477456319529254
Bond Position:  [16.35554487]


portfolio before change:  [10.84446043]
curr_Stock_Price:  100.65126369099737
curr_Factors:  [100.65126369]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675128]
Stock Position:  -0.016751275747970338
Bond Position:  [12.53049751]


portfolio before change:  [10.8675635]
curr_Stock_Price:  99.36559088023424
curr_Factors:  [99.36559088]
mat_Sqrt:  [[0.15]]
grads:  [0.06414132]
Stock Position:  0.06414131853449269
Bond Position:  [4.49412349]


portfolio before change:  [10.87205559]
curr_Stock_Price:  99.42686620792225
curr_Factors:  [99.42686621]
mat_Sqrt:  [[0.15]]
grads:  [0.00898461]
Stock Position:  0.008984611362693854
Bond Position:  [9.97874383]


portfolio before change:  [10.87700299]
curr_Stock_Price:  99.83867942799226
curr_Factors:  [99.83867943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0309009]
Stock Position:  -0.030900902192319512
Bond Position:  [13.96210826]


portfolio before change:  [10.8537128]
curr_Stock_Price:  100.64886800128936
curr_Factors:  [100.648868]
mat_Sqrt:  [[0.15]]
grads:  [0.12019394]
Stock Position:  0.12019394444591365
Bond Position:  [-1.24367165]


portfolio before change:  [10.90366453]
curr_Stock_Price:  101.0657541827806
curr_Factors:  [101.06575418]
mat_Sqrt:  [[0.15]]
grads:  [-0.04686312]
Stock Position:  -0.04686312498063655
Bond Position:  [15.6399216]


portfolio before change:  [10.91181343]
curr_Stock_Price:  100.93358657668384
curr_Factors:  [100.93358658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00337707]
Stock Position:  -0.0033770721376027123
Bond Position:  [11.25267343]


portfolio before change:  [10.91042541]
curr_Stock_Price:  101.76113357185906
curr_Factors:  [101.76113357]
mat_Sqrt:  [[0.15]]
grads:  [0.07124909]
Stock Position:  0.07124908843988954
Bond Position:  [3.66003741]


portfolio before change:  [10.92589954]
curr_Stock_Price:  101.97189539381108
curr_Factors:  [101.97189539]
mat_Sqrt:  [[0.15]]
grads:  [0.03722134]
Stock Position:  0.03722133909660769
Bond Position:  [7.13036904]


portfolio before change:  [10.86567098]
curr_Stock_Price:  100.32982901682946
curr_Factors:  [100.32982902]
mat_Sqrt:  [[0.15]]
grads:  [0.07829024]
Stock Position:  0.07829023924399657
Bond Position:  [3.01082466]


portfolio before change:  [10.8976268]
curr_Stock_Price:  100.73319280160719
curr_Factors:  [100.7331928]
mat_Sqrt:  [[0.15]]
grads:  [0.00386144]
Stock Position:  0.003861437524203202
Bond Position:  [10.50865187]


portfolio before change:  [10.89854618]
curr_Stock_Price:  100.6310845534156
curr_Factors:  [100.63108455]
mat_Sqrt:  [[0.15]]
grads:  [0.14873355]
Stock Position:  0.14873355235948282
Bond Position:  [-4.0686725]


portfolio before change:  [11.0042217]
curr_Stock_Price:  101.3450064264046
curr_Factors:  [101.34500643]
mat_Sqrt:  [[0.15]]
grads:  [0.01146119]
Stock Position:  0.011461187236995919
Bond Position:  [9.84268761]


portfolio before change:  [10.99474949]
curr_Stock_Price:  100.41119170992337
curr_Factors:  [100.41119171]
mat_Sqrt:  [[0.15]]
grads:  [0.06238449]
Stock Position:  0.062384489473270556
Bond Position:  [4.73064856]


portfolio before change:  [10.9296118]
curr_Stock_Price:  99.357579524536
curr_Factors:  [99.35757952]
mat_Sqrt:  [[0.15]]
grads:  [0.00438597]
Stock Position:  0.00438596554300103
Bond Position:  [10.49383288]


portfolio before change:  [10.93231547]
curr_Stock_Price:  99.67492482088555
curr_Factors:  [99.67492482]
mat_Sqrt:  [[0.15]]
grads:  [0.07561723]
Stock Position:  0.07561723048188247
Bond Position:  [3.39517371]


portfolio before change:  [10.92357062]
curr_Stock_Price:  99.5536656978187
curr_Factors:  [99.5536657]
mat_Sqrt:  [[0.15]]
grads:  [-0.08168658]
Stock Position:  -0.08168658237668128
Bond Position:  [19.05576933]


portfolio before change:  [10.96973982]
curr_Stock_Price:  99.0176281101545
curr_Factors:  [99.01762811]
mat_Sqrt:  [[0.15]]
grads:  [0.05040069]
Stock Position:  0.05040069141524705
Bond Position:  [5.9791829]


portfolio before change:  [10.89378765]
curr_Stock_Price:  97.4958313666283
curr_Factors:  [97.49583137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00850099]
Stock Position:  -0.008500987538361688
Bond Position:  [11.7225985]


portfolio before change:  [10.88603279]
curr_Stock_Price:  98.58044464891437
curr_Factors:  [98.58044465]
mat_Sqrt:  [[0.15]]
grads:  [0.12239785]
Stock Position:  0.12239784773620424
Bond Position:  [-1.18000147]


portfolio before change:  [10.85013232]
curr_Stock_Price:  98.28834021194602
curr_Factors:  [98.28834021]
mat_Sqrt:  [[0.15]]
grads:  [0.03205949]
Stock Position:  0.03205948840511258
Bond Position:  [7.69905842]


portfolio before change:  [10.84897803]
curr_Stock_Price:  98.22231482678421
curr_Factors:  [98.22231483]
mat_Sqrt:  [[0.15]]
grads:  [0.10062983]
Stock Position:  0.10062983405286263
Bond Position:  [0.96488278]


portfolio before change:  [10.79477411]
curr_Stock_Price:  97.68246961278614
curr_Factors:  [97.68246961]
mat_Sqrt:  [[0.15]]
grads:  [-0.07511579]
Stock Position:  -0.07511578518137517
Bond Position:  [18.13226951]


portfolio before change:  [10.83073111]
curr_Stock_Price:  97.23395762823557
curr_Factors:  [97.23395763]
mat_Sqrt:  [[0.15]]
grads:  [0.12170121]
Stock Position:  0.12170120765734918
Bond Position:  [-1.00275895]


portfolio before change:  [10.88826884]
curr_Stock_Price:  97.70776619654764
curr_Factors:  [97.7077662]
mat_Sqrt:  [[0.15]]
grads:  [-0.09896335]
Stock Position:  -0.09896334763901306
Bond Position:  [20.55775647]


portfolio before change:  [10.8910568]
curr_Stock_Price:  97.70556252198648
curr_Factors:  [97.70556252]
mat_Sqrt:  [[0.15]]
grads:  [-0.20254422]
Stock Position:  -0.20254422456099247
Bond Position:  [30.6807542]


portfolio before change:  [10.8345292]
curr_Stock_Price:  98.00358598400071
curr_Factors:  [98.00358598]
mat_Sqrt:  [[0.15]]
grads:  [-0.00920566]
Stock Position:  -0.00920565630894678
Bond Position:  [11.73671653]


portfolio before change:  [10.83187663]
curr_Stock_Price:  98.45111038128732
curr_Factors:  [98.45111038]
mat_Sqrt:  [[0.15]]
grads:  [-0.02423213]
Stock Position:  -0.024232133604081715
Bond Position:  [13.21755709]


portfolio before change:  [10.82204987]
curr_Stock_Price:  98.92482235921956
curr_Factors:  [98.92482236]
mat_Sqrt:  [[0.15]]
grads:  [0.03754383]
Stock Position:  0.037543830476776056
Bond Position:  [7.10803311]


portfolio before change:  [10.820806]
curr_Stock_Price:  98.86802377838379
curr_Factors:  [98.86802378]
mat_Sqrt:  [[0.15]]
grads:  [0.04474515]
Stock Position:  0.044745150492400444
Bond Position:  [6.39694139]


portfolio before change:  [10.80628659]
curr_Stock_Price:  98.52566090547386
curr_Factors:  [98.52566091]
mat_Sqrt:  [[0.15]]
grads:  [-0.08283627]
Stock Position:  -0.08283626999171144
Bond Position:  [18.96778483]


portfolio before change:  [10.62019983]
curr_Stock_Price:  100.80072560749605
curr_Factors:  [100.80072561]
mat_Sqrt:  [[0.15]]
grads:  [0.13999392]
Stock Position:  0.13999392442352548
Bond Position:  [-3.49128933]


portfolio before change:  [10.49696687]
curr_Stock_Price:  99.92356948812991
curr_Factors:  [99.92356949]
mat_Sqrt:  [[0.15]]
grads:  [0.03751255]
Stock Position:  0.037512553067426874
Bond Position:  [6.74857866]


portfolio before change:  [10.48080426]
curr_Stock_Price:  99.47022182081291
curr_Factors:  [99.47022182]
mat_Sqrt:  [[0.15]]
grads:  [0.01843959]
Stock Position:  0.01843958553319789
Bond Position:  [8.6466146]


portfolio before change:  [10.46641558]
curr_Stock_Price:  98.63128872364089
curr_Factors:  [98.63128872]
mat_Sqrt:  [[0.15]]
grads:  [0.06908159]
Stock Position:  0.06908158983767947
Bond Position:  [3.65280935]


portfolio before change:  [10.39672979]
curr_Stock_Price:  97.61593256807069
curr_Factors:  [97.61593257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.39672979]
Stock Price:  96.40315908301304
PL:  [10.39672979]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.23069742e-03]
 [ 2.88260105e-03]
 [-4.77497138e-03]
 [ 1.95142290e-03]
 [ 1.28732262e-02]
 [ 2.64997932e-02]
 [-2.93470153e-03]
 [ 1.98036091e-02]
 [-5.87459441e-03]
 [ 2.11816728e-04]
 [ 5.31425703e-03]
 [ 4.25773974e-03]
 [ 1.21257633e-02]
 [ 5.02477146e-04]
 [ 1.49904071e-02]
 [ 9.45955060e-04]
 [ 9.44740387e-03]
 [ 1.20782113e-02]
 [ 1.15519199e-02]
 [-1.28568618e-02]
 [-1.60916075e-02]
 [ 1.22636857e-02]
 [ 1.49026236e-02]
 [ 6.23363604e-03]
 [-7.90922260e-03]
 [-6.52161750e-03]
 [-7.34006155e-04]
 [-1.11607040e-02]
 [-1.77597206e-02]
 [-3.26170799e-03]
 [-3.67270965e-03]
 [ 5.62606464e-03]
 [ 5.94080503e-03]
 [-1.18789497e-02]
 [ 1.14368468e-02]
 [ 5.65556333e-03]
 [ 2.27672732e-03]
 [ 8.06710238e-03]
 [-3.44099739e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.07916715]
curr_Stock_Price:  100.84681160830506
curr_Factors:  [100.84681161]
mat_Sqrt:  [[0.15]]
grads:  [0.04153798]
Stock Position:  0.04153798276938947
Bond Position:  [10.89019403]


portfolio before change:  [15.03730671]
curr_Stock_Price:  99.80627468253007
curr_Factors:  [99.80627468]
mat_Sqrt:  [[0.15]]
grads:  [0.01921734]
Stock Position:  0.019217340364355552
Bond Position:  [13.11929556]


portfolio before change:  [15.02595634]
curr_Stock_Price:  99.13030295506135
curr_Factors:  [99.13030296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03183314]
Stock Position:  -0.03183314253848363
Bond Position:  [18.18158541]


portfolio before change:  [15.05352969]
curr_Stock_Price:  98.33551781032148
curr_Factors:  [98.33551781]
mat_Sqrt:  [[0.15]]
grads:  [0.01300949]
Stock Position:  0.013009486007508701
Bond Position:  [13.77423515]


portfolio before change:  [15.0752506]
curr_Stock_Price:  99.87278242774912
curr_Factors:  [99.87278243]
mat_Sqrt:  [[0.15]]
grads:  [0.08582151]
Stock Position:  0.08582150796013648
Bond Position:  [6.50401781]


portfolio before change:  [15.20529719]
curr_Stock_Price:  101.37862330288962
curr_Factors:  [101.3786233]
mat_Sqrt:  [[0.15]]
grads:  [0.17666529]
Stock Position:  0.1766652881039569
Bond Position:  [-2.7047865]


portfolio before change:  [15.11585643]
curr_Stock_Price:  100.87426479809008
curr_Factors:  [100.8742648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956468]
Stock Position:  -0.01956467689939666
Bond Position:  [17.08942883]


portfolio before change:  [15.12738314]
curr_Stock_Price:  100.39429797908971
curr_Factors:  [100.39429798]
mat_Sqrt:  [[0.15]]
grads:  [0.13202406]
Stock Position:  0.13202406066770528
Bond Position:  [1.87292025]


portfolio before change:  [15.01910423]
curr_Stock_Price:  99.57237931297297
curr_Factors:  [99.57237931]
mat_Sqrt:  [[0.15]]
grads:  [-0.03916396]
Stock Position:  -0.039163962757485994
Bond Position:  [18.91875318]


portfolio before change:  [14.97825373]
curr_Stock_Price:  100.67582959635891
curr_Factors:  [100.6758296]
mat_Sqrt:  [[0.15]]
grads:  [0.00141211]
Stock Position:  0.0014121115223107196
Bond Position:  [14.83608823]


portfolio before change:  [14.97884406]
curr_Stock_Price:  99.7805050863556
curr_Factors:  [99.78050509]
mat_Sqrt:  [[0.15]]
grads:  [0.03542838]
Stock Position:  0.03542838022211828
Bond Position:  [11.44378239]


portfolio before change:  [14.98452541]
curr_Stock_Price:  99.90048774477728
curr_Factors:  [99.90048774]
mat_Sqrt:  [[0.15]]
grads:  [0.02838493]
Stock Position:  0.028384931616689965
Bond Position:  [12.1488569]


portfolio before change:  [15.00615658]
curr_Stock_Price:  100.60904889927167
curr_Factors:  [100.6090489]
mat_Sqrt:  [[0.15]]
grads:  [0.08083842]
Stock Position:  0.0808384217832695
Bond Position:  [6.87307985]


portfolio before change:  [15.01787429]
curr_Stock_Price:  100.74337270964783
curr_Factors:  [100.74337271]
mat_Sqrt:  [[0.15]]
grads:  [0.00334985]
Stock Position:  0.00334984764114382
Bond Position:  [14.68039934]


portfolio before change:  [15.01623009]
curr_Stock_Price:  99.70470869253586
curr_Factors:  [99.70470869]
mat_Sqrt:  [[0.15]]
grads:  [0.09993605]
Stock Position:  0.09993604738246016
Bond Position:  [5.0521356]


portfolio before change:  [15.11908464]
curr_Stock_Price:  100.72759281413596
curr_Factors:  [100.72759281]
mat_Sqrt:  [[0.15]]
grads:  [0.00630637]
Stock Position:  0.0063063670674091505
Bond Position:  [14.48385947]


portfolio before change:  [15.12447332]
curr_Stock_Price:  101.29496865555375
curr_Factors:  [101.29496866]
mat_Sqrt:  [[0.15]]
grads:  [0.06298269]
Stock Position:  0.06298269244923839
Bond Position:  [8.74464346]


portfolio before change:  [15.06977501]
curr_Stock_Price:  100.40914659499582
curr_Factors:  [100.40914659]
mat_Sqrt:  [[0.15]]
grads:  [0.08052141]
Stock Position:  0.08052140874939116
Bond Position:  [6.98468907]


portfolio before change:  [15.03474715]
curr_Stock_Price:  99.96329009343405
curr_Factors:  [99.96329009]
mat_Sqrt:  [[0.15]]
grads:  [0.0770128]
Stock Position:  0.07701279948361621
Bond Position:  [7.33629434]


portfolio before change:  [15.10272565]
curr_Stock_Price:  100.83407262251616
curr_Factors:  [100.83407262]
mat_Sqrt:  [[0.15]]
grads:  [-0.08571241]
Stock Position:  -0.08571241176136042
Bond Position:  [23.7454572]


portfolio before change:  [15.12918099]
curr_Stock_Price:  100.56005197291563
curr_Factors:  [100.56005197]
mat_Sqrt:  [[0.15]]
grads:  [-0.10727738]
Stock Position:  -0.10727738320525834
Bond Position:  [25.91700022]


portfolio before change:  [15.22218194]
curr_Stock_Price:  99.7233320106631
curr_Factors:  [99.72333201]
mat_Sqrt:  [[0.15]]
grads:  [0.0817579]
Stock Position:  0.08175790438997207
Bond Position:  [7.0690113]


portfolio before change:  [15.18932577]
curr_Stock_Price:  99.31065200994755
curr_Factors:  [99.31065201]
mat_Sqrt:  [[0.15]]
grads:  [0.09935082]
Stock Position:  0.09935082366942428
Bond Position:  [5.3227307]


portfolio before change:  [15.34730073]
curr_Stock_Price:  100.89402662595587
curr_Factors:  [100.89402663]
mat_Sqrt:  [[0.15]]
grads:  [0.04155757]
Stock Position:  0.0415575735682161
Bond Position:  [11.15438979]


portfolio before change:  [15.37279629]
curr_Stock_Price:  101.47397328497154
curr_Factors:  [101.47397328]
mat_Sqrt:  [[0.15]]
grads:  [-0.05272815]
Stock Position:  -0.052728150649506124
Bond Position:  [20.72333124]


portfolio before change:  [15.36434141]
curr_Stock_Price:  101.68345255358727
curr_Factors:  [101.68345255]
mat_Sqrt:  [[0.15]]
grads:  [-0.04347745]
Stock Position:  -0.04347745002709168
Bond Position:  [19.78527864]


portfolio before change:  [15.37342738]
curr_Stock_Price:  101.5313587510472
curr_Factors:  [101.53135875]
mat_Sqrt:  [[0.15]]
grads:  [-0.00489337]
Stock Position:  -0.0048933743687827455
Bond Position:  [15.87025833]


portfolio before change:  [15.38186794]
curr_Stock_Price:  100.21188978466662
curr_Factors:  [100.21188978]
mat_Sqrt:  [[0.15]]
grads:  [-0.07440469]
Stock Position:  -0.0744046931723026
Bond Position:  [22.83810285]


portfolio before change:  [15.410743]
curr_Stock_Price:  99.86217908746474
curr_Factors:  [99.86217909]
mat_Sqrt:  [[0.15]]
grads:  [-0.11839814]
Stock Position:  -0.11839813715844946
Bond Position:  [27.23423898]


portfolio before change:  [15.54385888]
curr_Stock_Price:  98.76662649911432
curr_Factors:  [98.7666265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02174472]
Stock Position:  -0.021744719912524545
Bond Position:  [17.69151151]


portfolio before change:  [15.55579505]
curr_Stock_Price:  98.31941003592632
curr_Factors:  [98.31941004]
mat_Sqrt:  [[0.15]]
grads:  [-0.02448473]
Stock Position:  -0.024484730981721825
Bond Position:  [17.96311936]


portfolio before change:  [15.54205164]
curr_Stock_Price:  98.97242705533684
curr_Factors:  [98.97242706]
mat_Sqrt:  [[0.15]]
grads:  [0.0375071]
Stock Position:  0.03750709758047005
Bond Position:  [11.82988316]


portfolio before change:  [15.56240848]
curr_Stock_Price:  99.47574568011127
curr_Factors:  [99.47574568]
mat_Sqrt:  [[0.15]]
grads:  [0.03960537]
Stock Position:  0.03960536687221467
Bond Position:  [11.62263508]


portfolio before change:  [15.56750429]
curr_Stock_Price:  99.56772539349582
curr_Factors:  [99.56772539]
mat_Sqrt:  [[0.15]]
grads:  [-0.079193]
Stock Position:  -0.07919299773337392
Bond Position:  [23.45257095]


portfolio before change:  [15.60798552]
curr_Stock_Price:  99.09357394226485
curr_Factors:  [99.09357394]
mat_Sqrt:  [[0.15]]
grads:  [0.07624565]
Stock Position:  0.0762456454417258
Bond Position:  [8.05253202]


portfolio before change:  [15.66039469]
curr_Stock_Price:  99.76774413518815
curr_Factors:  [99.76774414]
mat_Sqrt:  [[0.15]]
grads:  [0.03770376]
Stock Position:  0.03770375555406969
Bond Position:  [11.89877606]


portfolio before change:  [15.68714118]
curr_Stock_Price:  100.4376784919332
curr_Factors:  [100.43767849]
mat_Sqrt:  [[0.15]]
grads:  [0.01517818]
Stock Position:  0.015178182146873557
Bond Position:  [14.1626798]


portfolio before change:  [15.68628739]
curr_Stock_Price:  100.2647834978171
curr_Factors:  [100.2647835]
mat_Sqrt:  [[0.15]]
grads:  [0.05378068]
Stock Position:  0.05378068251477317
Bond Position:  [10.2939789]


portfolio before change:  [15.65323816]
curr_Stock_Price:  99.62633764107483
curr_Factors:  [99.62633764]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.65323816]
Stock Price:  99.5134903339153
PL:  [15.65323816]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.20932332e-03]
 [ 4.08973002e-03]
 [ 7.17840256e-03]
 [-2.70464275e-03]
 [ 1.35158956e-02]
 [ 2.61822756e-02]
 [-6.54671251e-03]
 [ 2.16406131e-02]
 [-5.85558048e-03]
 [-1.23537106e-03]
 [-8.64931774e-03]
 [ 7.65490636e-03]
 [ 1.38939981e-02]
 [ 2.69716595e-03]
 [ 1.50874024e-02]
 [-3.25169140e-03]
 [ 1.04190814e-02]
 [-1.93265070e-04]
 [ 1.07866886e-02]
 [-7.54308769e-03]
 [ 8.61435983e-03]
 [ 1.34982439e-02]
 [ 1.64931723e-02]
 [ 4.88185843e-03]
 [ 1.29931693e-02]
 [-1.07002753e-02]
 [ 6.89211334e-03]
 [-1.11362955e-02]
 [ 5.47874731e-07]
 [-8.90892810e-03]
 [-2.27671488e-03]
 [ 5.46483041e-03]
 [ 5.11300923e-03]
 [-7.45795860e-03]
 [ 1.66540242e-02]
 [ 5.48156000e-03]
 [-1.28767157e-03]
 [ 8.81148144e-03]
 [-1.63421044e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86724345]
curr_Stock_Price:  99.56008124402638
curr_Factors:  [99.56008124]
mat_Sqrt:  [[0.15]]
grads:  [0.02806216]
Stock Position:  0.02806215544078961
Bond Position:  [-7.66111392]


portfolio before change:  [-4.84199568]
curr_Stock_Price:  100.49391794458695
curr_Factors:  [100.49391794]
mat_Sqrt:  [[0.15]]
grads:  [0.02726487]
Stock Position:  0.02726486680734349
Bond Position:  [-7.58194896]


portfolio before change:  [-4.85512026]
curr_Stock_Price:  100.04730726552076
curr_Factors:  [100.04730727]
mat_Sqrt:  [[0.15]]
grads:  [0.04785602]
Stock Position:  0.0478560170417613
Bond Position:  [-9.6429859]


portfolio before change:  [-4.83744677]
curr_Stock_Price:  100.44180188083592
curr_Factors:  [100.44180188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01803095]
Stock Position:  -0.018030951634057126
Bond Position:  [-3.0263855]


portfolio before change:  [-4.8294241]
curr_Stock_Price:  99.97588118065455
curr_Factors:  [99.97588118]
mat_Sqrt:  [[0.15]]
grads:  [0.09010597]
Stock Position:  0.09010597040650542
Bond Position:  [-13.83784789]


portfolio before change:  [-4.7424076]
curr_Stock_Price:  100.96079185395465
curr_Factors:  [100.96079185]
mat_Sqrt:  [[0.15]]
grads:  [0.1745485]
Stock Position:  0.1745485042788542
Bond Position:  [-22.36496281]


portfolio before change:  [-4.98640572]
curr_Stock_Price:  99.57892771774088
curr_Factors:  [99.57892772]
mat_Sqrt:  [[0.15]]
grads:  [-0.04364475]
Stock Position:  -0.04364475008907641
Bond Position:  [-0.6403083]


portfolio before change:  [-4.94583021]
curr_Stock_Price:  98.64741702187152
curr_Factors:  [98.64741702]
mat_Sqrt:  [[0.15]]
grads:  [0.14427075]
Stock Position:  0.14427075400213485
Bond Position:  [-19.17776744]


portfolio before change:  [-4.90378647]
curr_Stock_Price:  98.95545662600153
curr_Factors:  [98.95545663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0390372]
Stock Position:  -0.0390372031977245
Bond Position:  [-1.0408422]


portfolio before change:  [-4.85636218]
curr_Stock_Price:  97.73727486395605
curr_Factors:  [97.73727486]
mat_Sqrt:  [[0.15]]
grads:  [-0.00823581]
Stock Position:  -0.008235807045173167
Bond Position:  [-4.05141684]


portfolio before change:  [-4.85090827]
curr_Stock_Price:  97.01356146839305
curr_Factors:  [97.01356147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05766212]
Stock Position:  -0.05766211824568913
Bond Position:  [0.74309918]


portfolio before change:  [-4.77729785]
curr_Stock_Price:  95.73859048088957
curr_Factors:  [95.73859048]
mat_Sqrt:  [[0.15]]
grads:  [0.05103271]
Stock Position:  0.05103270907435463
Bond Position:  [-9.66309749]


portfolio before change:  [-4.72547195]
curr_Stock_Price:  96.77780363530505
curr_Factors:  [96.77780364]
mat_Sqrt:  [[0.15]]
grads:  [0.09262665]
Stock Position:  0.09262665421067429
Bond Position:  [-13.6896761]


portfolio before change:  [-4.56635845]
curr_Stock_Price:  98.51407291641681
curr_Factors:  [98.51407292]
mat_Sqrt:  [[0.15]]
grads:  [0.01798111]
Stock Position:  0.017981106358877
Bond Position:  [-6.33775048]


portfolio before change:  [-4.54552417]
curr_Stock_Price:  99.71681036599514
curr_Factors:  [99.71681037]
mat_Sqrt:  [[0.15]]
grads:  [0.10058268]
Stock Position:  0.10058268278211262
Bond Position:  [-14.57530848]


portfolio before change:  [-4.62268043]
curr_Stock_Price:  98.96783226653903
curr_Factors:  [98.96783227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02167794]
Stock Position:  -0.021677942662073804
Bond Position:  [-2.47726143]


portfolio before change:  [-4.63683047]
curr_Stock_Price:  99.60628609550162
curr_Factors:  [99.6062861]
mat_Sqrt:  [[0.15]]
grads:  [0.06946054]
Stock Position:  0.06946054267169088
Bond Position:  [-11.55553715]


portfolio before change:  [-4.66804042]
curr_Stock_Price:  99.17776338241067
curr_Factors:  [99.17776338]
mat_Sqrt:  [[0.15]]
grads:  [-0.00128843]
Stock Position:  -0.0012884338005500484
Bond Position:  [-4.54025644]


portfolio before change:  [-4.66878547]
curr_Stock_Price:  99.3155125687052
curr_Factors:  [99.31551257]
mat_Sqrt:  [[0.15]]
grads:  [0.07191126]
Stock Position:  0.07191125718880863
Bond Position:  [-11.81068884]


portfolio before change:  [-4.72928301]
curr_Stock_Price:  98.49476329548335
curr_Factors:  [98.4947633]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028725]
Stock Position:  -0.050287251263849725
Bond Position:  [0.2237479]


portfolio before change:  [-4.74878674]
curr_Stock_Price:  98.88316588023807
curr_Factors:  [98.88316588]
mat_Sqrt:  [[0.15]]
grads:  [0.05742907]
Stock Position:  0.05742906554788964
Bond Position:  [-10.42755455]


portfolio before change:  [-4.69343708]
curr_Stock_Price:  99.86965554126012
curr_Factors:  [99.86965554]
mat_Sqrt:  [[0.15]]
grads:  [0.08998829]
Stock Position:  0.0899882924647778
Bond Position:  [-13.68053685]


portfolio before change:  [-4.7725667]
curr_Stock_Price:  99.00932759859583
curr_Factors:  [99.0093276]
mat_Sqrt:  [[0.15]]
grads:  [0.10995448]
Stock Position:  0.10995448184179117
Bond Position:  [-15.65908601]


portfolio before change:  [-4.83029106]
curr_Stock_Price:  98.5021462998573
curr_Factors:  [98.5021463]
mat_Sqrt:  [[0.15]]
grads:  [0.03254572]
Stock Position:  0.03254572286557107
Bond Position:  [-8.03611462]


portfolio before change:  [-4.82765216]
curr_Stock_Price:  98.61409592115051
curr_Factors:  [98.61409592]
mat_Sqrt:  [[0.15]]
grads:  [0.08662113]
Stock Position:  0.08662112863478141
Bond Position:  [-13.36971645]


portfolio before change:  [-4.80216476]
curr_Stock_Price:  98.92763052522157
curr_Factors:  [98.92763053]
mat_Sqrt:  [[0.15]]
grads:  [-0.07133517]
Stock Position:  -0.07133516844873986
Bond Position:  [2.25485443]


portfolio before change:  [-4.86191463]
curr_Stock_Price:  99.76917536090865
curr_Factors:  [99.76917536]
mat_Sqrt:  [[0.15]]
grads:  [0.04594742]
Stock Position:  0.04594742224740469
Bond Position:  [-9.44605105]


portfolio before change:  [-4.81264052]
curr_Stock_Price:  100.86727691119687
curr_Factors:  [100.86727691]
mat_Sqrt:  [[0.15]]
grads:  [-0.07424197]
Stock Position:  -0.07424196977614649
Bond Position:  [2.6759448]


portfolio before change:  [-4.86975507]
curr_Stock_Price:  101.64108533593418
curr_Factors:  [101.64108534]
mat_Sqrt:  [[0.15]]
grads:  [3.6524982e-06]
Stock Position:  3.652498204593143e-06
Bond Position:  [-4.87012631]


portfolio before change:  [-4.87036674]
curr_Stock_Price:  100.85717239744442
curr_Factors:  [100.8571724]
mat_Sqrt:  [[0.15]]
grads:  [-0.05939285]
Stock Position:  -0.05939285399419822
Bond Position:  [1.11982858]


portfolio before change:  [-4.84736904]
curr_Stock_Price:  100.47231620809828
curr_Factors:  [100.47231621]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151781]
Stock Position:  -0.015178099196107258
Bond Position:  [-3.32239026]


portfolio before change:  [-4.83693288]
curr_Stock_Price:  99.75737284138762
curr_Factors:  [99.75737284]
mat_Sqrt:  [[0.15]]
grads:  [0.0364322]
Stock Position:  0.03643220273036679
Bond Position:  [-8.47131372]


portfolio before change:  [-4.7970187]
curr_Stock_Price:  100.88201424793463
curr_Factors:  [100.88201425]
mat_Sqrt:  [[0.15]]
grads:  [0.03408673]
Stock Position:  0.03408672820665078
Bond Position:  [-8.2357565]


portfolio before change:  [-4.77742072]
curr_Stock_Price:  101.48716218962096
curr_Factors:  [101.48716219]
mat_Sqrt:  [[0.15]]
grads:  [-0.04971972]
Stock Position:  -0.04971972398572393
Bond Position:  [0.26849297]


portfolio before change:  [-4.81245319]
curr_Stock_Price:  102.19243617002425
curr_Factors:  [102.19243617]
mat_Sqrt:  [[0.15]]
grads:  [0.11102683]
Stock Position:  0.11102682814901735
Bond Position:  [-16.15855523]


portfolio before change:  [-4.90283953]
curr_Stock_Price:  101.39653483303931
curr_Factors:  [101.39653483]
mat_Sqrt:  [[0.15]]
grads:  [0.03654373]
Stock Position:  0.036543733311665355
Bond Position:  [-8.60824746]


portfolio before change:  [-4.87668644]
curr_Stock_Price:  102.141647403048
curr_Factors:  [102.1416474]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858448]
Stock Position:  -0.008584477157606777
Bond Position:  [-3.9998538]


portfolio before change:  [-4.88115915]
curr_Stock_Price:  102.6044251808483
curr_Factors:  [102.60442518]
mat_Sqrt:  [[0.15]]
grads:  [0.05874321]
Stock Position:  0.0587432096006207
Bond Position:  [-10.90847241]


portfolio before change:  [-4.8669813]
curr_Stock_Price:  102.86899196580985
curr_Factors:  [102.86899197]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.8669813]
Stock Price:  102.57681798117454
PL:  [-7.44379928]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.63487050e-03]
 [-1.29986226e-02]
 [-1.76317898e-02]
 [ 3.89332197e-04]
 [-2.41039672e-03]
 [-2.41296152e-02]
 [-4.48279736e-02]
 [ 1.38124376e-02]
 [-5.94487295e-03]
 [ 4.08152992e-03]
 [-1.56845103e-03]
 [ 7.30960520e-03]
 [ 1.39099436e-02]
 [ 2.40007527e-03]
 [ 7.42768820e-03]
 [-4.31028829e-03]
 [ 1.42657674e-02]
 [-4.77418793e-03]
 [ 1.13621268e-02]
 [-1.15963362e-02]
 [-3.75473571e-04]
 [ 1.77799484e-02]
 [-1.23447477e-02]
 [ 6.17490611e-03]
 [-5.03127613e-03]
 [-6.42502789e-03]
 [-9.96552732e-04]
 [-1.08590390e-02]
 [ 1.47999324e-02]
 [-1.04854393e-02]
 [-2.47663558e-04]
 [ 5.14069042e-03]
 [ 5.16882360e-03]
 [-7.94128513e-03]
 [ 2.06362644e-02]
 [ 5.52775039e-03]
 [ 2.39863627e-03]
 [ 7.82170762e-03]
 [-1.11757086e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.22791386]
curr_Stock_Price:  98.76270219337522
curr_Factors:  [98.76270219]
mat_Sqrt:  [[0.15]]
grads:  [0.06423247]
Stock Position:  0.06423247000903028
Bond Position:  [-23.57168617]


portfolio before change:  [-17.26193693]
curr_Stock_Price:  98.27889047127213
curr_Factors:  [98.27889047]
mat_Sqrt:  [[0.15]]
grads:  [-0.08665748]
Stock Position:  -0.08665748381596156
Bond Position:  [-8.74533557]


portfolio before change:  [-17.25648629]
curr_Stock_Price:  98.20337622144304
curr_Factors:  [98.20337622]
mat_Sqrt:  [[0.15]]
grads:  [-0.11754527]
Stock Position:  -0.1175452653498507
Bond Position:  [-5.71314438]


portfolio before change:  [-17.30584154]
curr_Stock_Price:  98.61718327544773
curr_Factors:  [98.61718328]
mat_Sqrt:  [[0.15]]
grads:  [0.00259555]
Stock Position:  0.002595547977783436
Bond Position:  [-17.56180717]


portfolio before change:  [-17.30765104]
curr_Stock_Price:  98.76584504110275
curr_Factors:  [98.76584504]
mat_Sqrt:  [[0.15]]
grads:  [-0.01606931]
Stock Position:  -0.016069311496099265
Bond Position:  [-15.72055191]


portfolio before change:  [-17.30358424]
curr_Stock_Price:  98.39047149915987
curr_Factors:  [98.3904715]
mat_Sqrt:  [[0.15]]
grads:  [-0.1608641]
Stock Position:  -0.1608641010919046
Bond Position:  [-1.47608949]


portfolio before change:  [-17.1331202]
curr_Stock_Price:  97.32964711789363
curr_Factors:  [97.32964712]
mat_Sqrt:  [[0.15]]
grads:  [-0.29885316]
Stock Position:  -0.2988531571362274
Bond Position:  [11.95415212]


portfolio before change:  [-16.97511452]
curr_Stock_Price:  96.8059406854315
curr_Factors:  [96.80594069]
mat_Sqrt:  [[0.15]]
grads:  [0.09208292]
Stock Position:  0.0920829173264008
Bond Position:  [-25.88928795]


portfolio before change:  [-16.81960363]
curr_Stock_Price:  98.52990049409149
curr_Factors:  [98.52990049]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963249]
Stock Position:  -0.03963248630761379
Bond Position:  [-12.9146187]


portfolio before change:  [-16.83958159]
curr_Stock_Price:  98.9932457952571
curr_Factors:  [98.9932458]
mat_Sqrt:  [[0.15]]
grads:  [0.0272102]
Stock Position:  0.027210199495546396
Bond Position:  [-19.53320756]


portfolio before change:  [-16.86098261]
curr_Stock_Price:  98.29647693804351
curr_Factors:  [98.29647694]
mat_Sqrt:  [[0.15]]
grads:  [-0.01045634]
Stock Position:  -0.010456340195366818
Bond Position:  [-15.83316121]


portfolio before change:  [-16.85754148]
curr_Stock_Price:  97.7780923290652
curr_Factors:  [97.77809233]
mat_Sqrt:  [[0.15]]
grads:  [0.0487307]
Stock Position:  0.048730701349068165
Bond Position:  [-21.62233649]


portfolio before change:  [-16.85631432]
curr_Stock_Price:  97.85874209456325
curr_Factors:  [97.85874209]
mat_Sqrt:  [[0.15]]
grads:  [0.09273296]
Stock Position:  0.0927329570522849
Bond Position:  [-25.93104484]


portfolio before change:  [-16.82358955]
curr_Stock_Price:  98.24659071128508
curr_Factors:  [98.24659071]
mat_Sqrt:  [[0.15]]
grads:  [0.0160005]
Stock Position:  0.016000501803310266
Bond Position:  [-18.3955843]


portfolio before change:  [-16.81812633]
curr_Stock_Price:  98.73175153599237
curr_Factors:  [98.73175154]
mat_Sqrt:  [[0.15]]
grads:  [0.04951792]
Stock Position:  0.04951792136509822
Bond Position:  [-21.70711743]


portfolio before change:  [-16.89247249]
curr_Stock_Price:  97.28515192480648
curr_Factors:  [97.28515192]
mat_Sqrt:  [[0.15]]
grads:  [-0.02873526]
Stock Position:  -0.028735255269551695
Bond Position:  [-14.09695882]


portfolio before change:  [-16.91803946]
curr_Stock_Price:  98.11356757058114
curr_Factors:  [98.11356757]
mat_Sqrt:  [[0.15]]
grads:  [0.09510512]
Stock Position:  0.09510511566947873
Bond Position:  [-26.24914165]


portfolio before change:  [-16.86041668]
curr_Stock_Price:  98.75395500653387
curr_Factors:  [98.75395501]
mat_Sqrt:  [[0.15]]
grads:  [-0.03182792]
Stock Position:  -0.03182791953449049
Bond Position:  [-13.71728375]


portfolio before change:  [-16.89224346]
curr_Stock_Price:  99.70004293573861
curr_Factors:  [99.70004294]
mat_Sqrt:  [[0.15]]
grads:  [0.07574751]
Stock Position:  0.07574751176633748
Bond Position:  [-24.44427364]


portfolio before change:  [-16.92328119]
curr_Stock_Price:  99.33063142139474
curr_Factors:  [99.33063142]
mat_Sqrt:  [[0.15]]
grads:  [-0.07730891]
Stock Position:  -0.0773089078085428
Bond Position:  [-9.24413856]


portfolio before change:  [-16.94857343]
curr_Stock_Price:  99.64284186073517
curr_Factors:  [99.64284186]
mat_Sqrt:  [[0.15]]
grads:  [-0.00250316]
Stock Position:  -0.002503157143115403
Bond Position:  [-16.69915174]


portfolio before change:  [-16.95318972]
curr_Stock_Price:  100.65307331706681
curr_Factors:  [100.65307332]
mat_Sqrt:  [[0.15]]
grads:  [0.11853299]
Stock Position:  0.11853298902805783
Bond Position:  [-28.88389935]


portfolio before change:  [-16.93653671]
curr_Stock_Price:  100.82402764074499
curr_Factors:  [100.82402764]
mat_Sqrt:  [[0.15]]
grads:  [-0.08229832]
Stock Position:  -0.082298318118283
Bond Position:  [-8.6388888]


portfolio before change:  [-16.95405536]
curr_Stock_Price:  101.0237732245513
curr_Factors:  [101.02377322]
mat_Sqrt:  [[0.15]]
grads:  [0.04116604]
Stock Position:  0.04116604074620885
Bond Position:  [-21.11280412]


portfolio before change:  [-16.90999662]
curr_Stock_Price:  102.15815501330248
curr_Factors:  [102.15815501]
mat_Sqrt:  [[0.15]]
grads:  [-0.03354184]
Stock Position:  -0.03354184087524723
Bond Position:  [-13.48342404]


portfolio before change:  [-16.90322049]
curr_Stock_Price:  101.90588331675656
curr_Factors:  [101.90588332]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283352]
Stock Position:  -0.04283351929747897
Bond Position:  [-12.53823287]


portfolio before change:  [-16.94207329]
curr_Stock_Price:  102.77635618562852
curr_Factors:  [102.77635619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00664368]
Stock Position:  -0.006643684878419673
Bond Position:  [-16.25925956]


portfolio before change:  [-16.94412531]
curr_Stock_Price:  102.77929009642196
curr_Factors:  [102.7792901]
mat_Sqrt:  [[0.15]]
grads:  [-0.07239359]
Stock Position:  -0.07239359309466446
Bond Position:  [-9.50356321]


portfolio before change:  [-16.88823593]
curr_Stock_Price:  101.99085841020863
curr_Factors:  [101.99085841]
mat_Sqrt:  [[0.15]]
grads:  [0.09866622]
Stock Position:  0.0986662162240608
Bond Position:  [-26.95128802]


portfolio before change:  [-16.86355432]
curr_Stock_Price:  102.27515769822206
curr_Factors:  [102.2751577]
mat_Sqrt:  [[0.15]]
grads:  [-0.06990293]
Stock Position:  -0.0699029288213139
Bond Position:  [-9.71422125]


portfolio before change:  [-16.82951987]
curr_Stock_Price:  101.77090414742503
curr_Factors:  [101.77090415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00165109]
Stock Position:  -0.0016510903899785243
Bond Position:  [-16.66148691]


portfolio before change:  [-16.83199966]
curr_Stock_Price:  102.01133321130656
curr_Factors:  [102.01133321]
mat_Sqrt:  [[0.15]]
grads:  [0.03427127]
Stock Position:  0.0342712694513153
Bond Position:  [-20.32805754]


portfolio before change:  [-16.81314822]
curr_Stock_Price:  102.63554721909951
curr_Factors:  [102.63554722]
mat_Sqrt:  [[0.15]]
grads:  [0.03445882]
Stock Position:  0.034458824027963735
Bond Position:  [-20.34984848]


portfolio before change:  [-16.85884005]
curr_Stock_Price:  101.38338771291765
curr_Factors:  [101.38338771]
mat_Sqrt:  [[0.15]]
grads:  [-0.0529419]
Stock Position:  -0.052941900872007314
Bond Position:  [-11.49141079]


portfolio before change:  [-16.82098243]
curr_Stock_Price:  100.64117522882279
curr_Factors:  [100.64117523]
mat_Sqrt:  [[0.15]]
grads:  [0.1375751]
Stock Position:  0.13757509582840002
Bond Position:  [-30.66670175]


portfolio before change:  [-16.84943089]
curr_Stock_Price:  100.46225557363105
curr_Factors:  [100.46225557]
mat_Sqrt:  [[0.15]]
grads:  [0.03685167]
Stock Position:  0.036851669255504566
Bond Position:  [-20.55163271]


portfolio before change:  [-16.83773656]
curr_Stock_Price:  100.84930583285961
curr_Factors:  [100.84930583]
mat_Sqrt:  [[0.15]]
grads:  [0.01599091]
Stock Position:  0.015990908492614527
Bond Position:  [-18.45040858]


portfolio before change:  [-16.83422278]
curr_Stock_Price:  101.2132766311265
curr_Factors:  [101.21327663]
mat_Sqrt:  [[0.15]]
grads:  [0.05214472]
Stock Position:  0.052144717499832106
Bond Position:  [-22.1119605]


portfolio before change:  [-16.84493526]
curr_Stock_Price:  101.06084876720102
curr_Factors:  [101.06084877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.84493526]
Stock Price:  101.462188409119
PL:  [-18.30712367]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.71715057e-03]
 [ 1.32023932e-03]
 [ 1.53468905e-02]
 [-2.21573319e-03]
 [ 1.51068431e-02]
 [ 2.11607578e-03]
 [-1.90049638e-02]
 [ 2.25079823e-02]
 [-6.00399145e-03]
 [ 4.54892161e-04]
 [ 1.38642103e-03]
 [ 5.79923586e-03]
 [ 1.38714823e-02]
 [ 2.44247821e-03]
 [ 1.76229242e-03]
 [-3.32652756e-03]
 [ 1.18938567e-02]
 [-3.10445154e-03]
 [ 8.38035591e-03]
 [-5.55855282e-03]
 [ 2.14034464e-02]
 [-3.37054693e-03]
 [ 2.51489422e-02]
 [ 3.93036318e-03]
 [ 1.27448185e-02]
 [ 3.67431380e-03]
 [ 3.07839925e-02]
 [-2.61923722e-02]
 [-4.73131402e-02]
 [ 2.47569345e-03]
 [-4.27887393e-03]
 [ 5.58473972e-03]
 [ 1.56864083e-02]
 [-1.31253424e-02]
 [ 3.69422855e-03]
 [ 4.99897264e-03]
 [ 5.56744262e-03]
 [ 8.87982299e-03]
 [-7.94676227e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.0960331]
curr_Stock_Price:  100.97691835819356
curr_Factors:  [100.97691836]
mat_Sqrt:  [[0.15]]
grads:  [0.044781]
Stock Position:  0.044781003812217196
Bond Position:  [12.57418533]


portfolio before change:  [17.10369118]
curr_Stock_Price:  101.11282880189579
curr_Factors:  [101.1128288]
mat_Sqrt:  [[0.15]]
grads:  [0.0088016]
Stock Position:  0.00880159548991264
Bond Position:  [16.21373696]


portfolio before change:  [17.10883612]
curr_Stock_Price:  101.46709364394562
curr_Factors:  [101.46709364]
mat_Sqrt:  [[0.15]]
grads:  [0.1023126]
Stock Position:  0.10231260329164671
Bond Position:  [6.72747362]


portfolio before change:  [17.03210741]
curr_Stock_Price:  100.70893000953564
curr_Factors:  [100.70893001]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477155]
Stock Position:  -0.014771554619853734
Bond Position:  [18.51973487]


portfolio before change:  [17.03242182]
curr_Stock_Price:  100.84437299767205
curr_Factors:  [100.844373]
mat_Sqrt:  [[0.15]]
grads:  [0.10071229]
Stock Position:  0.10071228727973189
Bond Position:  [6.87615435]


portfolio before change:  [16.8928757]
curr_Stock_Price:  99.45024624574344
curr_Factors:  [99.45024625]
mat_Sqrt:  [[0.15]]
grads:  [0.01410717]
Stock Position:  0.01410717186136206
Bond Position:  [15.48991398]


portfolio before change:  [16.89033581]
curr_Stock_Price:  99.13294334604318
curr_Factors:  [99.13294335]
mat_Sqrt:  [[0.15]]
grads:  [-0.12669976]
Stock Position:  -0.12669975879201167
Bond Position:  [29.45045582]


portfolio before change:  [16.92060342]
curr_Stock_Price:  98.9231080745614
curr_Factors:  [98.92310807]
mat_Sqrt:  [[0.15]]
grads:  [0.15005322]
Stock Position:  0.15005321542861075
Bond Position:  [2.07687298]


portfolio before change:  [16.81958335]
curr_Stock_Price:  98.2481495047149
curr_Factors:  [98.2481495]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002661]
Stock Position:  -0.04002660965020945
Bond Position:  [20.75212368]


portfolio before change:  [16.82475669]
curr_Stock_Price:  98.18371312655623
curr_Factors:  [98.18371313]
mat_Sqrt:  [[0.15]]
grads:  [0.00303261]
Stock Position:  0.0030326144071156705
Bond Position:  [16.52700335]


portfolio before change:  [16.82883943]
curr_Stock_Price:  98.84872783839582
curr_Factors:  [98.84872784]
mat_Sqrt:  [[0.15]]
grads:  [0.00924281]
Stock Position:  0.00924280689226984
Bond Position:  [15.91519973]


portfolio before change:  [16.83436525]
curr_Stock_Price:  99.23132694127479
curr_Factors:  [99.23132694]
mat_Sqrt:  [[0.15]]
grads:  [0.03866157]
Stock Position:  0.038661572408377975
Bond Position:  [12.99792611]


portfolio before change:  [16.80936198]
curr_Stock_Price:  98.54257820843993
curr_Factors:  [98.54257821]
mat_Sqrt:  [[0.15]]
grads:  [0.09247655]
Stock Position:  0.09247654886257295
Bond Position:  [7.69648443]


portfolio before change:  [16.74251639]
curr_Stock_Price:  97.80933595572624
curr_Factors:  [97.80933596]
mat_Sqrt:  [[0.15]]
grads:  [0.01628319]
Stock Position:  0.01628318807872038
Bond Position:  [15.14986857]


portfolio before change:  [16.74360514]
curr_Stock_Price:  97.7598922883556
curr_Factors:  [97.75989229]
mat_Sqrt:  [[0.15]]
grads:  [0.01174862]
Stock Position:  0.011748616149494425
Bond Position:  [15.59506169]


portfolio before change:  [16.74911511]
curr_Stock_Price:  98.06294668533222
curr_Factors:  [98.06294669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217685]
Stock Position:  -0.022176850414734023
Bond Position:  [18.92384241]


portfolio before change:  [16.72988402]
curr_Stock_Price:  99.03678762949106
curr_Factors:  [99.03678763]
mat_Sqrt:  [[0.15]]
grads:  [0.07929238]
Stock Position:  0.07929237787636009
Bond Position:  [8.87702163]


portfolio before change:  [16.72239399]
curr_Stock_Price:  98.92833173384074
curr_Factors:  [98.92833173]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069634]
Stock Position:  -0.02069634358310713
Bond Position:  [18.76984873]


portfolio before change:  [16.72931053]
curr_Stock_Price:  98.70751161729807
curr_Factors:  [98.70751162]
mat_Sqrt:  [[0.15]]
grads:  [0.05586904]
Stock Position:  0.055869039424045544
Bond Position:  [11.21461668]


portfolio before change:  [16.69392514]
curr_Stock_Price:  98.04905559281256
curr_Factors:  [98.04905559]
mat_Sqrt:  [[0.15]]
grads:  [-0.03705702]
Stock Position:  -0.03705701880027013
Bond Position:  [20.32733084]


portfolio before change:  [16.74611999]
curr_Stock_Price:  96.70912654830643
curr_Factors:  [96.70912655]
mat_Sqrt:  [[0.15]]
grads:  [0.14268964]
Stock Position:  0.14268964235522588
Bond Position:  [2.94672931]


portfolio before change:  [16.70758229]
curr_Stock_Price:  96.43646439696573
curr_Factors:  [96.4364644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247031]
Stock Position:  -0.02247031288058181
Bond Position:  [18.87453982]


portfolio before change:  [16.72329318]
curr_Stock_Price:  95.84228366566875
curr_Factors:  [95.84228367]
mat_Sqrt:  [[0.15]]
grads:  [0.16765961]
Stock Position:  0.16765961483543607
Bond Position:  [0.65441282]


portfolio before change:  [16.8163309]
curr_Stock_Price:  96.3967159925965
curr_Factors:  [96.39671599]
mat_Sqrt:  [[0.15]]
grads:  [0.02620242]
Stock Position:  0.026202421167099775
Bond Position:  [14.29050355]


portfolio before change:  [16.79029026]
curr_Stock_Price:  95.33471222551209
curr_Factors:  [95.33471223]
mat_Sqrt:  [[0.15]]
grads:  [0.08496546]
Stock Position:  0.08496545642540675
Bond Position:  [8.69013292]


portfolio before change:  [16.77605543]
curr_Stock_Price:  95.15438995458175
curr_Factors:  [95.15438995]
mat_Sqrt:  [[0.15]]
grads:  [0.02449543]
Stock Position:  0.024495425351502752
Bond Position:  [14.44520817]


portfolio before change:  [16.75358549]
curr_Stock_Price:  94.16335988112446
curr_Factors:  [94.16335988]
mat_Sqrt:  [[0.15]]
grads:  [0.20522662]
Stock Position:  0.2052266165687835
Bond Position:  [-2.57124227]


portfolio before change:  [16.6283023]
curr_Stock_Price:  93.55446340891064
curr_Factors:  [93.55446341]
mat_Sqrt:  [[0.15]]
grads:  [-0.17461581]
Stock Position:  -0.17461581486850142
Bond Position:  [32.96439116]


portfolio before change:  [16.63736694]
curr_Stock_Price:  93.5261507437608
curr_Factors:  [93.52615074]
mat_Sqrt:  [[0.15]]
grads:  [-0.31542093]
Stock Position:  -0.31542093459271126
Bond Position:  [46.13747282]


portfolio before change:  [16.61495712]
curr_Stock_Price:  93.61548334382847
curr_Factors:  [93.61548334]
mat_Sqrt:  [[0.15]]
grads:  [0.01650462]
Stock Position:  0.016504623014778463
Bond Position:  [15.06986886]


portfolio before change:  [16.64100935]
curr_Stock_Price:  95.07982343858981
curr_Factors:  [95.07982344]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852583]
Stock Position:  -0.028525826182459933
Bond Position:  [19.35323987]


portfolio before change:  [16.65665222]
curr_Stock_Price:  94.6162588571564
curr_Factors:  [94.61625886]
mat_Sqrt:  [[0.15]]
grads:  [0.0372316]
Stock Position:  0.03723159812784603
Bond Position:  [13.13393769]


portfolio before change:  [16.66237722]
curr_Stock_Price:  94.72592801958268
curr_Factors:  [94.72592802]
mat_Sqrt:  [[0.15]]
grads:  [0.10457606]
Stock Position:  0.10457605558320363
Bond Position:  [6.75631331]


portfolio before change:  [16.71342642]
curr_Stock_Price:  95.20600550364168
curr_Factors:  [95.2060055]
mat_Sqrt:  [[0.15]]
grads:  [-0.08750228]
Stock Position:  -0.08750228286891498
Bond Position:  [25.04416925]


portfolio before change:  [16.75554242]
curr_Stock_Price:  94.76047101309653
curr_Factors:  [94.76047101]
mat_Sqrt:  [[0.15]]
grads:  [0.02462819]
Stock Position:  0.02462819034447761
Bond Position:  [14.42176351]


portfolio before change:  [16.73008218]
curr_Stock_Price:  93.65348427013454
curr_Factors:  [93.65348427]
mat_Sqrt:  [[0.15]]
grads:  [0.03332648]
Stock Position:  0.033326484241842314
Bond Position:  [13.60894081]


portfolio before change:  [16.7536002]
curr_Stock_Price:  94.30812279008462
curr_Factors:  [94.30812279]
mat_Sqrt:  [[0.15]]
grads:  [0.03711628]
Stock Position:  0.037116284109436654
Bond Position:  [13.25323312]


portfolio before change:  [16.72477605]
curr_Stock_Price:  93.48689525658219
curr_Factors:  [93.48689526]
mat_Sqrt:  [[0.15]]
grads:  [0.05919882]
Stock Position:  0.05919881990159865
Bond Position:  [11.19046217]


portfolio before change:  [16.56591734]
curr_Stock_Price:  90.77978715403057
curr_Factors:  [90.77978715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.56591734]
Stock Price:  90.44565222644275
PL:  [16.56591734]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.49187903e-03]
 [-3.53916380e-03]
 [-5.67616892e-04]
 [-1.80331300e-03]
 [ 1.24446801e-02]
 [-9.19484077e-03]
 [-5.08105680e-02]
 [ 1.99810092e-02]
 [-5.94506237e-03]
 [ 2.21799598e-03]
 [ 4.96925205e-04]
 [ 6.25278928e-03]
 [ 1.39049949e-02]
 [ 2.42781543e-03]
 [ 2.79313166e-03]
 [-3.32822004e-03]
 [ 1.03868650e-02]
 [-8.48948916e-03]
 [ 7.13750277e-03]
 [-5.36387259e-03]
 [ 2.01286701e-02]
 [-2.98465870e-03]
 [ 2.32929880e-02]
 [ 4.23094096e-03]
 [ 1.22507146e-02]
 [ 1.96375946e-04]
 [ 2.52661500e-02]
 [-2.31236394e-02]
 [-4.76666250e-02]
 [-5.54274608e-04]
 [-3.91881918e-03]
 [ 5.60458749e-03]
 [ 1.05095512e-02]
 [-1.26604120e-02]
 [ 2.85908741e-03]
 [ 5.61307636e-03]
 [ 3.34173105e-03]
 [ 1.02195818e-02]
 [-6.26696899e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.27753117]
curr_Stock_Price:  99.21106699608991
curr_Factors:  [99.211067]
mat_Sqrt:  [[0.15]]
grads:  [0.04327919]
Stock Position:  0.04327919351341494
Bond Position:  [-14.57130614]


portfolio before change:  [-10.27357083]
curr_Stock_Price:  99.34466170349273
curr_Factors:  [99.3446617]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359443]
Stock Position:  -0.023594425360369785
Bond Position:  [-7.92959062]


portfolio before change:  [-10.27421339]
curr_Stock_Price:  99.32988298965157
curr_Factors:  [99.32988299]
mat_Sqrt:  [[0.15]]
grads:  [-0.00378411]
Stock Position:  -0.003784112611373857
Bond Position:  [-9.89833793]


portfolio before change:  [-10.27470227]
curr_Stock_Price:  99.13208427688762
curr_Factors:  [99.13208428]
mat_Sqrt:  [[0.15]]
grads:  [-0.01202209]
Stock Position:  -0.012022086641029736
Bond Position:  [-9.08292776]


portfolio before change:  [-10.28391594]
curr_Stock_Price:  99.8040339001193
curr_Factors:  [99.8040339]
mat_Sqrt:  [[0.15]]
grads:  [0.08296453]
Stock Position:  0.08296453368477115
Bond Position:  [-18.56411108]


portfolio before change:  [-10.34414178]
curr_Stock_Price:  99.10608287040364
curr_Factors:  [99.10608287]
mat_Sqrt:  [[0.15]]
grads:  [-0.06129894]
Stock Position:  -0.06129893847459705
Bond Position:  [-4.26904411]


portfolio before change:  [-10.27130002]
curr_Stock_Price:  97.90907311092036
curr_Factors:  [97.90907311]
mat_Sqrt:  [[0.15]]
grads:  [-0.33873712]
Stock Position:  -0.33873712002760226
Bond Position:  [22.89413743]


portfolio before change:  [-10.33049235]
curr_Stock_Price:  98.0922661287159
curr_Factors:  [98.09226613]
mat_Sqrt:  [[0.15]]
grads:  [0.13320673]
Stock Position:  0.1332067281253923
Bond Position:  [-23.39704218]


portfolio before change:  [-10.27524158]
curr_Stock_Price:  98.52899771971045
curr_Factors:  [98.52899772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963375]
Stock Position:  -0.03963374914064751
Bond Position:  [-6.370168]


portfolio before change:  [-10.27872724]
curr_Stock_Price:  98.59685256268236
curr_Factors:  [98.59685256]
mat_Sqrt:  [[0.15]]
grads:  [0.01478664]
Stock Position:  0.014786639896791978
Bond Position:  [-11.73664339]


portfolio before change:  [-10.2796272]
curr_Stock_Price:  98.63521244896609
curr_Factors:  [98.63521245]
mat_Sqrt:  [[0.15]]
grads:  [0.00331283]
Stock Position:  0.0033128346998998566
Bond Position:  [-10.60638935]


portfolio before change:  [-10.27973062]
curr_Stock_Price:  99.00421875300518
curr_Factors:  [99.00421875]
mat_Sqrt:  [[0.15]]
grads:  [0.04168526]
Stock Position:  0.04168526188236636
Bond Position:  [-14.40674741]


portfolio before change:  [-10.34326521]
curr_Stock_Price:  97.52327243258556
curr_Factors:  [97.52327243]
mat_Sqrt:  [[0.15]]
grads:  [0.09269997]
Stock Position:  0.09269996592495804
Bond Position:  [-19.38366924]


portfolio before change:  [-10.30515391]
curr_Stock_Price:  97.96053701005957
curr_Factors:  [97.96053701]
mat_Sqrt:  [[0.15]]
grads:  [0.01618544]
Stock Position:  0.01618543622503723
Bond Position:  [-11.89068794]


portfolio before change:  [-10.30639025]
curr_Stock_Price:  97.975988787091
curr_Factors:  [97.97598879]
mat_Sqrt:  [[0.15]]
grads:  [0.01862088]
Stock Position:  0.0186208777084843
Bond Position:  [-12.13078915]


portfolio before change:  [-10.304917]
curr_Stock_Price:  98.13654457175063
curr_Factors:  [98.13654457]
mat_Sqrt:  [[0.15]]
grads:  [-0.02218813]
Stock Position:  -0.02218813360405244
Bond Position:  [-8.12745024]


portfolio before change:  [-10.33885589]
curr_Stock_Price:  99.62035100330375
curr_Factors:  [99.620351]
mat_Sqrt:  [[0.15]]
grads:  [0.06924577]
Stock Position:  0.06924576683572023
Bond Position:  [-17.23714349]


portfolio before change:  [-10.44665907]
curr_Stock_Price:  98.09464902042743
curr_Factors:  [98.09464902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05659659]
Stock Position:  -0.05659659437801545
Bond Position:  [-4.89483601]


portfolio before change:  [-10.45475877]
curr_Stock_Price:  98.22695036847934
curr_Factors:  [98.22695037]
mat_Sqrt:  [[0.15]]
grads:  [0.04758335]
Stock Position:  0.04758335181461812
Bond Position:  [-15.12872631]


portfolio before change:  [-10.46797468]
curr_Stock_Price:  97.98895330845787
curr_Factors:  [97.98895331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575915]
Stock Position:  -0.0357591506159146
Bond Position:  [-6.96397294]


portfolio before change:  [-10.44171795]
curr_Stock_Price:  97.23034261958904
curr_Factors:  [97.23034262]
mat_Sqrt:  [[0.15]]
grads:  [0.13419113]
Stock Position:  0.13419113372668445
Bond Position:  [-23.48916786]


portfolio before change:  [-10.61616229]
curr_Stock_Price:  95.95225516422505
curr_Factors:  [95.95225516]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989772]
Stock Position:  -0.019897724633734407
Bond Position:  [-8.70693074]


portfolio before change:  [-10.63062897]
curr_Stock_Price:  96.62460585785544
curr_Factors:  [96.62460586]
mat_Sqrt:  [[0.15]]
grads:  [0.15528659]
Stock Position:  0.15528658691864694
Bond Position:  [-25.63513423]


portfolio before change:  [-10.58805463]
curr_Stock_Price:  96.91940875327448
curr_Factors:  [96.91940875]
mat_Sqrt:  [[0.15]]
grads:  [0.02820627]
Stock Position:  0.028206273087059173
Bond Position:  [-13.32178994]


portfolio before change:  [-10.6413556]
curr_Stock_Price:  95.08876467502377
curr_Factors:  [95.08876468]
mat_Sqrt:  [[0.15]]
grads:  [0.08167143]
Stock Position:  0.08167143072102152
Bond Position:  [-18.40739106]


portfolio before change:  [-10.60632744]
curr_Stock_Price:  95.5458306920319
curr_Factors:  [95.54583069]
mat_Sqrt:  [[0.15]]
grads:  [0.00130917]
Stock Position:  0.0013091729720890745
Bond Position:  [-10.73141345]


portfolio before change:  [-10.6076783]
curr_Stock_Price:  95.53868656111203
curr_Factors:  [95.53868656]
mat_Sqrt:  [[0.15]]
grads:  [0.168441]
Stock Position:  0.1684409999903736
Bond Position:  [-26.7003102]


portfolio before change:  [-10.66551686]
curr_Stock_Price:  95.21512628798294
curr_Factors:  [95.21512629]
mat_Sqrt:  [[0.15]]
grads:  [-0.1541576]
Stock Position:  -0.1541575961533871
Bond Position:  [4.01261812]


portfolio before change:  [-10.74253897]
curr_Stock_Price:  95.71801239280416
curr_Factors:  [95.71801239]
mat_Sqrt:  [[0.15]]
grads:  [-0.3177775]
Stock Position:  -0.3177775001693507
Bond Position:  [19.67449173]


portfolio before change:  [-11.22185538]
curr_Stock_Price:  97.23409165533145
curr_Factors:  [97.23409166]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369516]
Stock Position:  -0.00369516405598891
Bond Position:  [-10.86255946]


portfolio before change:  [-11.22436925]
curr_Stock_Price:  97.5469226859674
curr_Factors:  [97.54692269]
mat_Sqrt:  [[0.15]]
grads:  [-0.02612546]
Stock Position:  -0.026125461224209206
Bond Position:  [-8.6759109]


portfolio before change:  [-11.21607858]
curr_Stock_Price:  97.18806895049444
curr_Factors:  [97.18806895]
mat_Sqrt:  [[0.15]]
grads:  [0.03736392]
Stock Position:  0.03736391657827104
Bond Position:  [-14.84740548]


portfolio before change:  [-11.22987285]
curr_Stock_Price:  96.86855673320389
curr_Factors:  [96.86855673]
mat_Sqrt:  [[0.15]]
grads:  [0.07006367]
Stock Position:  0.07006367444548375
Bond Position:  [-18.01683988]


portfolio before change:  [-11.18246485]
curr_Stock_Price:  97.577344145699
curr_Factors:  [97.57734415]
mat_Sqrt:  [[0.15]]
grads:  [-0.08440275]
Stock Position:  -0.08440274639005567
Bond Position:  [-2.94666902]


portfolio before change:  [-11.10197314]
curr_Stock_Price:  96.6193176479103
curr_Factors:  [96.61931765]
mat_Sqrt:  [[0.15]]
grads:  [0.01906058]
Stock Position:  0.01906058272820873
Bond Position:  [-12.94359363]


portfolio before change:  [-11.10868321]
curr_Stock_Price:  96.35216836749076
curr_Factors:  [96.35216837]
mat_Sqrt:  [[0.15]]
grads:  [0.03742051]
Stock Position:  0.03742050906398621
Bond Position:  [-14.7142304]


portfolio before change:  [-11.12898412]
curr_Stock_Price:  95.85881549545826
curr_Factors:  [95.8588155]
mat_Sqrt:  [[0.15]]
grads:  [0.02227821]
Stock Position:  0.0222782070175677
Bond Position:  [-13.26454665]


portfolio before change:  [-11.14901364]
curr_Stock_Price:  95.03418220666693
curr_Factors:  [95.03418221]
mat_Sqrt:  [[0.15]]
grads:  [0.06813055]
Stock Position:  0.06813054559462765
Bond Position:  [-17.62374433]


portfolio before change:  [-11.19699944]
curr_Stock_Price:  94.36219732923814
curr_Factors:  [94.36219733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.19699944]
Stock Price:  94.00109330380947
PL:  [-11.19699944]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.14776790e-03]
 [ 3.45625515e-03]
 [ 1.31115191e-02]
 [-2.67514963e-03]
 [ 1.50203130e-02]
 [ 2.65955892e-02]
 [ 1.98304580e-02]
 [ 7.68373677e-03]
 [-8.82493158e-03]
 [-3.02079162e-03]
 [ 1.42236644e-02]
 [ 8.07999560e-03]
 [ 6.48562429e-03]
 [-4.95925327e-03]
 [ 1.12252027e-02]
 [ 2.41944959e-03]
 [ 9.10970676e-03]
 [ 1.14418363e-02]
 [ 1.15410359e-02]
 [-1.46539205e-02]
 [-9.92628025e-03]
 [ 2.27187197e-02]
 [-3.53212190e-02]
 [ 6.23207384e-03]
 [-5.04057373e-03]
 [-6.41804511e-03]
 [-4.40182161e-04]
 [-1.08087798e-02]
 [ 5.05695138e-02]
 [-7.17018122e-03]
 [-5.20153379e-03]
 [ 4.70714909e-03]
 [ 5.54468173e-03]
 [-3.12520427e-03]
 [ 7.67651785e-03]
 [ 5.32353147e-03]
 [-1.05485806e-03]
 [ 8.17808651e-03]
 [-1.53315791e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.73533607]
curr_Stock_Price:  100.8246312819173
curr_Factors:  [100.82463128]
mat_Sqrt:  [[0.15]]
grads:  [0.04098512]
Stock Position:  0.04098511933014442
Bond Position:  [10.60302652]


portfolio before change:  [14.72942746]
curr_Stock_Price:  100.64812663941726
curr_Factors:  [100.64812664]
mat_Sqrt:  [[0.15]]
grads:  [0.0230417]
Stock Position:  0.023041701021393378
Bond Position:  [12.41032342]


portfolio before change:  [14.73519991]
curr_Stock_Price:  100.83131896545233
curr_Factors:  [100.83131897]
mat_Sqrt:  [[0.15]]
grads:  [0.08741013]
Stock Position:  0.08741012763662502
Bond Position:  [5.92152145]


portfolio before change:  [14.71212342]
curr_Stock_Price:  100.55884788956277
curr_Factors:  [100.55884789]
mat_Sqrt:  [[0.15]]
grads:  [-0.01783433]
Stock Position:  -0.017834330841829116
Bond Position:  [16.50552318]


portfolio before change:  [14.70769302]
curr_Stock_Price:  100.9229612278355
curr_Factors:  [100.92296123]
mat_Sqrt:  [[0.15]]
grads:  [0.10013542]
Stock Position:  0.10013542027562986
Bond Position:  [4.60172988]


portfolio before change:  [14.76651936]
curr_Stock_Price:  101.50468431965467
curr_Factors:  [101.50468432]
mat_Sqrt:  [[0.15]]
grads:  [0.17730393]
Stock Position:  0.17730392821097685
Bond Position:  [-3.2306599]


portfolio before change:  [14.95328741]
curr_Stock_Price:  102.56034003383016
curr_Factors:  [102.56034003]
mat_Sqrt:  [[0.15]]
grads:  [0.13220305]
Stock Position:  0.1322030531013475
Bond Position:  [1.39449733]


portfolio before change:  [14.95796835]
curr_Stock_Price:  102.59442862310742
curr_Factors:  [102.59442862]
mat_Sqrt:  [[0.15]]
grads:  [0.05122491]
Stock Position:  0.05122491176699605
Bond Position:  [9.70257779]


portfolio before change:  [14.93541504]
curr_Stock_Price:  102.13047060550075
curr_Factors:  [102.13047061]
mat_Sqrt:  [[0.15]]
grads:  [-0.05883288]
Stock Position:  -0.05883287722906126
Bond Position:  [20.94404447]


portfolio before change:  [14.91830076]
curr_Stock_Price:  102.4658688207783
curr_Factors:  [102.46586882]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013861]
Stock Position:  -0.02013861081670951
Bond Position:  [16.98182102]


portfolio before change:  [14.91981344]
curr_Stock_Price:  102.49616793510731
curr_Factors:  [102.49616794]
mat_Sqrt:  [[0.15]]
grads:  [0.09482443]
Stock Position:  0.09482442926918985
Bond Position:  [5.20067281]


portfolio before change:  [15.01628228]
curr_Stock_Price:  103.5066535127394
curr_Factors:  [103.50665351]
mat_Sqrt:  [[0.15]]
grads:  [0.05386664]
Stock Position:  0.053866637318358015
Bond Position:  [9.44072692]


portfolio before change:  [14.97192002]
curr_Stock_Price:  102.66118726507683
curr_Factors:  [102.66118727]
mat_Sqrt:  [[0.15]]
grads:  [0.0432375]
Stock Position:  0.04323749528972387
Bond Position:  [10.53310742]


portfolio before change:  [14.96412114]
curr_Stock_Price:  102.45036097368634
curr_Factors:  [102.45036097]
mat_Sqrt:  [[0.15]]
grads:  [-0.03306169]
Stock Position:  -0.03306168844609007
Bond Position:  [18.35130306]


portfolio before change:  [14.96158447]
curr_Stock_Price:  102.59647368017558
curr_Factors:  [102.59647368]
mat_Sqrt:  [[0.15]]
grads:  [0.07483468]
Stock Position:  0.07483468474393956
Bond Position:  [7.2838097]


portfolio before change:  [14.94638046]
curr_Stock_Price:  102.3811384810819
curr_Factors:  [102.38113848]
mat_Sqrt:  [[0.15]]
grads:  [0.01612966]
Stock Position:  0.01612966390274925
Bond Position:  [13.29500711]


portfolio before change:  [14.9660135]
curr_Stock_Price:  103.49530067232817
curr_Factors:  [103.49530067]
mat_Sqrt:  [[0.15]]
grads:  [0.06073138]
Stock Position:  0.060731378379556014
Bond Position:  [8.68060124]


portfolio before change:  [14.89550648]
curr_Stock_Price:  102.31646756685083
curr_Factors:  [102.31646757]
mat_Sqrt:  [[0.15]]
grads:  [0.07627891]
Stock Position:  0.0762789083336189
Bond Position:  [7.09091803]


portfolio before change:  [14.91366462]
curr_Stock_Price:  102.54289599913926
curr_Factors:  [102.542896]
mat_Sqrt:  [[0.15]]
grads:  [0.07694024]
Stock Position:  0.07694023904539624
Bond Position:  [7.02398969]


portfolio before change:  [14.91673964]
curr_Stock_Price:  102.57145023373538
curr_Factors:  [102.57145023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0976928]
Stock Position:  -0.09769280365305709
Bond Position:  [24.93723219]


portfolio before change:  [14.97863199]
curr_Stock_Price:  101.96981944178533
curr_Factors:  [101.96981944]
mat_Sqrt:  [[0.15]]
grads:  [-0.0661752]
Stock Position:  -0.06617520167541918
Bond Position:  [21.72650536]


portfolio before change:  [14.97362667]
curr_Stock_Price:  102.08649906146094
curr_Factors:  [102.08649906]
mat_Sqrt:  [[0.15]]
grads:  [0.15145813]
Stock Position:  0.15145813141668796
Bond Position:  [-0.48820372]


portfolio before change:  [15.0318005]
curr_Stock_Price:  102.47099383250783
curr_Factors:  [102.47099383]
mat_Sqrt:  [[0.15]]
grads:  [-0.23547479]
Stock Position:  -0.23547479326541693
Bond Position:  [39.16113659]


portfolio before change:  [14.92102342]
curr_Stock_Price:  102.9622248740662
curr_Factors:  [102.96222487]
mat_Sqrt:  [[0.15]]
grads:  [0.04154716]
Stock Position:  0.04154715896037303
Bond Position:  [10.6432355]


portfolio before change:  [14.88889429]
curr_Stock_Price:  102.15688415257586
curr_Factors:  [102.15688415]
mat_Sqrt:  [[0.15]]
grads:  [-0.03360382]
Stock Position:  -0.033603824854140124
Bond Position:  [18.32175634]


portfolio before change:  [14.89888345]
curr_Stock_Price:  101.9277794353506
curr_Factors:  [101.92777944]
mat_Sqrt:  [[0.15]]
grads:  [-0.04278697]
Stock Position:  -0.04278696738953374
Bond Position:  [19.26006403]


portfolio before change:  [14.92499498]
curr_Stock_Price:  101.3737819011255
curr_Factors:  [101.3737819]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293455]
Stock Position:  -0.002934547741002998
Bond Position:  [15.22248119]


portfolio before change:  [14.92247351]
curr_Stock_Price:  102.88147538221732
curr_Factors:  [102.88147538]
mat_Sqrt:  [[0.15]]
grads:  [-0.07205853]
Stock Position:  -0.0720585318004275
Bond Position:  [22.33596158]


portfolio before change:  [14.88550015]
curr_Stock_Price:  103.43332582733815
curr_Factors:  [103.43332583]
mat_Sqrt:  [[0.15]]
grads:  [0.33713009]
Stock Position:  0.3371300923108536
Bond Position:  [-19.98498653]


portfolio before change:  [14.99134831]
curr_Stock_Price:  103.75470456380197
curr_Factors:  [103.75470456]
mat_Sqrt:  [[0.15]]
grads:  [-0.04780121]
Stock Position:  -0.047801208109025
Bond Position:  [19.95094854]


portfolio before change:  [14.98307539]
curr_Stock_Price:  103.97994881991295
curr_Factors:  [103.97994882]
mat_Sqrt:  [[0.15]]
grads:  [-0.03467689]
Stock Position:  -0.03467689195334758
Bond Position:  [18.58877684]


portfolio before change:  [14.97743779]
curr_Stock_Price:  104.20953528868128
curr_Factors:  [104.20953529]
mat_Sqrt:  [[0.15]]
grads:  [0.03138099]
Stock Position:  0.03138099395065856
Bond Position:  [11.70723899]


portfolio before change:  [14.96931613]
curr_Stock_Price:  103.90409083038043
curr_Factors:  [103.90409083]
mat_Sqrt:  [[0.15]]
grads:  [0.03696454]
Stock Position:  0.03696454489916985
Bond Position:  [11.1285487]


portfolio before change:  [14.99815826]
curr_Stock_Price:  104.64672044187158
curr_Factors:  [104.64672044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0208347]
Stock Position:  -0.020834695160482006
Bond Position:  [17.17844078]


portfolio before change:  [15.02116231]
curr_Stock_Price:  103.64566831336332
curr_Factors:  [103.64566831]
mat_Sqrt:  [[0.15]]
grads:  [0.05117679]
Stock Position:  0.05117678563714197
Bond Position:  [9.71691016]


portfolio before change:  [14.97999845]
curr_Stock_Price:  102.81758684637003
curr_Factors:  [102.81758685]
mat_Sqrt:  [[0.15]]
grads:  [0.03549021]
Stock Position:  0.03549020981384273
Bond Position:  [11.33098072]


portfolio before change:  [14.95587169]
curr_Stock_Price:  102.09786094229712
curr_Factors:  [102.09786094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703239]
Stock Position:  -0.007032387070684982
Bond Position:  [15.67386337]


portfolio before change:  [14.96049614]
curr_Stock_Price:  101.71888705471858
curr_Factors:  [101.71888705]
mat_Sqrt:  [[0.15]]
grads:  [0.05452058]
Stock Position:  0.054520576754512724
Bond Position:  [9.41472375]


portfolio before change:  [14.97806823]
curr_Stock_Price:  102.01960253528746
curr_Factors:  [102.01960254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.97806823]
Stock Price:  101.6846559431973
PL:  [13.29341229]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.58725923e-03]
 [-4.83221758e-03]
 [ 1.33633513e-02]
 [ 3.75642390e-03]
 [ 5.69953495e-03]
 [ 3.21342176e-02]
 [ 2.11868872e-02]
 [-8.53865880e-04]
 [-9.11588824e-03]
 [-3.01171246e-03]
 [ 1.31263995e-02]
 [ 6.65297880e-03]
 [ 1.16250950e-02]
 [ 5.01495063e-03]
 [ 2.05066687e-02]
 [ 1.02670009e-03]
 [ 9.41756627e-03]
 [ 1.33260768e-02]
 [ 1.15224188e-02]
 [-1.41725055e-02]
 [-1.37937776e-02]
 [ 1.81980388e-02]
 [-3.16718055e-03]
 [ 5.17318841e-03]
 [ 9.11029369e-03]
 [-9.85436036e-03]
 [ 4.23979621e-03]
 [-1.14583273e-02]
 [-1.78749445e-02]
 [-4.13461529e-03]
 [-3.31294344e-03]
 [ 5.36519221e-03]
 [ 5.11944463e-03]
 [-5.60415138e-03]
 [ 2.13337916e-02]
 [ 5.56303739e-03]
 [ 1.94354994e-03]
 [ 8.04836674e-03]
 [-4.92270541e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.55749526]
curr_Stock_Price:  100.9421776221583
curr_Factors:  [100.94217762]
mat_Sqrt:  [[0.15]]
grads:  [0.04391506]
Stock Position:  0.04391506151404802
Bond Position:  [12.12461332]


portfolio before change:  [16.59892099]
curr_Stock_Price:  101.85097873703296
curr_Factors:  [101.85097874]
mat_Sqrt:  [[0.15]]
grads:  [-0.03221478]
Stock Position:  -0.0322147838807575
Bond Position:  [19.88002826]


portfolio before change:  [16.63283343]
curr_Stock_Price:  100.87542409817601
curr_Factors:  [100.8754241]
mat_Sqrt:  [[0.15]]
grads:  [0.08908901]
Stock Position:  0.08908900841276016
Bond Position:  [7.64594193]


portfolio before change:  [16.69493124]
curr_Stock_Price:  101.56172649704068
curr_Factors:  [101.5617265]
mat_Sqrt:  [[0.15]]
grads:  [0.02504283]
Stock Position:  0.025042825996533832
Bond Position:  [14.15153859]


portfolio before change:  [16.71559439]
curr_Stock_Price:  102.3161982189485
curr_Factors:  [102.31619822]
mat_Sqrt:  [[0.15]]
grads:  [0.0379969]
Stock Position:  0.03799689969147155
Bond Position:  [12.82789607]


portfolio before change:  [16.75695963]
curr_Stock_Price:  103.36264271100947
curr_Factors:  [103.36264271]
mat_Sqrt:  [[0.15]]
grads:  [0.21422812]
Stock Position:  0.21422811754052512
Bond Position:  [-5.38622475]


portfolio before change:  [16.59955514]
curr_Stock_Price:  102.63103397049231
curr_Factors:  [102.63103397]
mat_Sqrt:  [[0.15]]
grads:  [0.14124591]
Stock Position:  0.14124591435601022
Bond Position:  [2.10334091]


portfolio before change:  [16.77800807]
curr_Stock_Price:  103.89259252360172
curr_Factors:  [103.89259252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00569244]
Stock Position:  -0.005692439197304533
Bond Position:  [17.36941033]


portfolio before change:  [16.78909336]
curr_Stock_Price:  102.32665937969965
curr_Factors:  [102.32665938]
mat_Sqrt:  [[0.15]]
grads:  [-0.06077259]
Stock Position:  -0.060772588292757224
Bond Position:  [23.0077493]


portfolio before change:  [16.81380002]
curr_Stock_Price:  101.96744292780757
curr_Factors:  [101.96744293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007808]
Stock Position:  -0.02007808307381156
Bond Position:  [18.86111081]


portfolio before change:  [16.80897192]
curr_Stock_Price:  102.32533981197335
curr_Factors:  [102.32533981]
mat_Sqrt:  [[0.15]]
grads:  [0.08750933]
Stock Position:  0.08750932974569127
Bond Position:  [7.85455002]


portfolio before change:  [16.83532928]
curr_Stock_Price:  102.61531431063617
curr_Factors:  [102.61531431]
mat_Sqrt:  [[0.15]]
grads:  [0.04435319]
Stock Position:  0.044353191973465
Bond Position:  [12.28401254]


portfolio before change:  [16.77007296]
curr_Stock_Price:  101.10940431030265
curr_Factors:  [101.10940431]
mat_Sqrt:  [[0.15]]
grads:  [0.07750063]
Stock Position:  0.07750063318896346
Bond Position:  [8.93403011]


portfolio before change:  [16.69816741]
curr_Stock_Price:  100.16718785026663
curr_Factors:  [100.16718785]
mat_Sqrt:  [[0.15]]
grads:  [0.033433]
Stock Position:  0.033433004210068513
Bond Position:  [13.3492774]


portfolio before change:  [16.75025487]
curr_Stock_Price:  101.67523940781118
curr_Factors:  [101.67523941]
mat_Sqrt:  [[0.15]]
grads:  [0.13671112]
Stock Position:  0.13671112451693274
Bond Position:  [2.85011855]


portfolio before change:  [16.62987169]
curr_Stock_Price:  100.79206720293385
curr_Factors:  [100.7920672]
mat_Sqrt:  [[0.15]]
grads:  [0.00684467]
Stock Position:  0.0068446672817111635
Bond Position:  [15.93998353]


portfolio before change:  [16.62972267]
curr_Stock_Price:  100.47917521038197
curr_Factors:  [100.47917521]
mat_Sqrt:  [[0.15]]
grads:  [0.06278378]
Stock Position:  0.06278377514604282
Bond Position:  [10.32126073]


portfolio before change:  [16.64666312]
curr_Stock_Price:  100.72844677394701
curr_Factors:  [100.72844677]
mat_Sqrt:  [[0.15]]
grads:  [0.08884051]
Stock Position:  0.08884051206713274
Bond Position:  [7.69789633]


portfolio before change:  [16.6184874]
curr_Stock_Price:  100.40046559326605
curr_Factors:  [100.40046559]
mat_Sqrt:  [[0.15]]
grads:  [0.07681613]
Stock Position:  0.0768161251112489
Bond Position:  [8.90611268]


portfolio before change:  [16.75511632]
curr_Stock_Price:  102.1646210688728
curr_Factors:  [102.16462107]
mat_Sqrt:  [[0.15]]
grads:  [-0.09448337]
Stock Position:  -0.09448337031875363
Bond Position:  [26.40797405]


portfolio before change:  [16.83132348]
curr_Stock_Price:  101.39299370710124
curr_Factors:  [101.39299371]
mat_Sqrt:  [[0.15]]
grads:  [-0.09195852]
Stock Position:  -0.0919585171148731
Bond Position:  [26.15527283]


portfolio before change:  [16.89207839]
curr_Stock_Price:  100.76787166425723
curr_Factors:  [100.76787166]
mat_Sqrt:  [[0.15]]
grads:  [0.12132026]
Stock Position:  0.12132025848774722
Bond Position:  [4.66689415]


portfolio before change:  [16.85575789]
curr_Stock_Price:  100.46368589787961
curr_Factors:  [100.4636859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111454]
Stock Position:  -0.0211145369820789
Bond Position:  [18.9770021]


portfolio before change:  [16.87529712]
curr_Stock_Price:  99.65064646172422
curr_Factors:  [99.65064646]
mat_Sqrt:  [[0.15]]
grads:  [0.03448792]
Stock Position:  0.03448792273804983
Bond Position:  [13.43855332]


portfolio before change:  [16.85503218]
curr_Stock_Price:  99.01434084979698
curr_Factors:  [99.01434085]
mat_Sqrt:  [[0.15]]
grads:  [0.06073529]
Stock Position:  0.060735291237745334
Bond Position:  [10.84136735]


portfolio before change:  [16.90445246]
curr_Stock_Price:  99.80572624342467
curr_Factors:  [99.80572624]
mat_Sqrt:  [[0.15]]
grads:  [-0.06569574]
Stock Position:  -0.06569573570981069
Bond Position:  [23.46126307]


portfolio before change:  [16.89042428]
curr_Stock_Price:  100.0639016267865
curr_Factors:  [100.06390163]
mat_Sqrt:  [[0.15]]
grads:  [0.02826531]
Stock Position:  0.02826530807574912
Bond Position:  [14.06208727]


portfolio before change:  [16.90154484]
curr_Stock_Price:  100.3951447728521
curr_Factors:  [100.39514477]
mat_Sqrt:  [[0.15]]
grads:  [-0.07638885]
Stock Position:  -0.0763888488949163
Bond Position:  [24.57061438]


portfolio before change:  [16.95593239]
curr_Stock_Price:  99.723370921103
curr_Factors:  [99.72337092]
mat_Sqrt:  [[0.15]]
grads:  [-0.1191663]
Stock Position:  -0.11916629645223341
Bond Position:  [28.83959717]


portfolio before change:  [17.02528156]
curr_Stock_Price:  99.17167137733524
curr_Factors:  [99.17167138]
mat_Sqrt:  [[0.15]]
grads:  [-0.0275641]
Stock Position:  -0.02756410196201254
Bond Position:  [19.75885962]


portfolio before change:  [17.0167742]
curr_Stock_Price:  99.56992009184961
curr_Factors:  [99.56992009]
mat_Sqrt:  [[0.15]]
grads:  [-0.02208629]
Stock Position:  -0.022086289580728922
Bond Position:  [19.21590429]


portfolio before change:  [17.00680614]
curr_Stock_Price:  100.1300048958283
curr_Factors:  [100.1300049]
mat_Sqrt:  [[0.15]]
grads:  [0.03576795]
Stock Position:  0.03576794807596565
Bond Position:  [13.42536133]


portfolio before change:  [17.06149076]
curr_Stock_Price:  101.61195584857617
curr_Factors:  [101.61195585]
mat_Sqrt:  [[0.15]]
grads:  [0.03412963]
Stock Position:  0.034129630852828934
Bond Position:  [13.59351222]


portfolio before change:  [17.07926029]
curr_Stock_Price:  102.08281438337664
curr_Factors:  [102.08281438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736101]
Stock Position:  -0.03736100922083958
Bond Position:  [20.89317726]


portfolio before change:  [17.12402951]
curr_Stock_Price:  100.95443449687855
curr_Factors:  [100.9544345]
mat_Sqrt:  [[0.15]]
grads:  [0.14222528]
Stock Position:  0.1422252775399424
Bond Position:  [2.76575704]


portfolio before change:  [17.02709584]
curr_Stock_Price:  100.27045336672472
curr_Factors:  [100.27045337]
mat_Sqrt:  [[0.15]]
grads:  [0.03708692]
Stock Position:  0.03708691591075428
Bond Position:  [13.30837397]


portfolio before change:  [17.05928184]
curr_Stock_Price:  101.09344840978385
curr_Factors:  [101.09344841]
mat_Sqrt:  [[0.15]]
grads:  [0.012957]
Stock Position:  0.01295699957102457
Bond Position:  [15.74941407]


portfolio before change:  [17.05077166]
curr_Stock_Price:  100.28469814328807
curr_Factors:  [100.28469814]
mat_Sqrt:  [[0.15]]
grads:  [0.05365578]
Stock Position:  0.0536557782974199
Bond Position:  [11.66991813]


portfolio before change:  [17.03168387]
curr_Stock_Price:  99.90176411318794
curr_Factors:  [99.90176411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.03168387]
Stock Price:  99.84752085012326
PL:  [17.03168387]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.81815064e-03]
 [-8.29444231e-03]
 [-7.39339661e-03]
 [-1.11918142e-03]
 [ 1.18098380e-03]
 [ 2.55335196e-02]
 [ 5.61310348e-04]
 [ 2.27754376e-02]
 [-5.93048433e-03]
 [ 2.76723909e-03]
 [ 1.06851726e-02]
 [ 4.03721239e-03]
 [ 1.14898617e-02]
 [-5.32713570e-03]
 [ 2.42282792e-02]
 [ 1.45705901e-03]
 [ 9.83981821e-03]
 [ 1.38404101e-02]
 [ 1.14481653e-02]
 [-1.34934211e-02]
 [-1.74140496e-02]
 [ 1.23581485e-02]
 [ 1.31400337e-02]
 [ 5.41081054e-03]
 [ 8.17555380e-03]
 [-1.04060669e-02]
 [ 7.52980385e-03]
 [-1.10618459e-02]
 [-1.82518759e-02]
 [-2.87312494e-03]
 [-3.72814567e-03]
 [ 5.62198051e-03]
 [ 9.18117809e-03]
 [-1.27152448e-02]
 [ 3.14045637e-03]
 [ 5.63315678e-03]
 [ 3.48931512e-03]
 [ 1.14926944e-02]
 [-2.84683890e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.21542182]
curr_Stock_Price:  99.47311110760856
curr_Factors:  [99.47311111]
mat_Sqrt:  [[0.15]]
grads:  [0.032121]
Stock Position:  0.03212100424165782
Bond Position:  [-9.41059805]


portfolio before change:  [-6.23197048]
curr_Stock_Price:  98.99453760942096
curr_Factors:  [98.99453761]
mat_Sqrt:  [[0.15]]
grads:  [-0.05529628]
Stock Position:  -0.0552962820495511
Bond Position:  [-0.75794061]


portfolio before change:  [-6.2302538]
curr_Stock_Price:  98.96177899757934
curr_Factors:  [98.961779]
mat_Sqrt:  [[0.15]]
grads:  [-0.04928931]
Stock Position:  -0.04928931072112711
Bond Position:  [-1.35249593]


portfolio before change:  [-6.22868519]
curr_Stock_Price:  98.92652430028818
curr_Factors:  [98.9265243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00746121]
Stock Position:  -0.007461209463556297
Bond Position:  [-5.49057367]


portfolio before change:  [-6.22938446]
curr_Stock_Price:  98.92825367944266
curr_Factors:  [98.92825368]
mat_Sqrt:  [[0.15]]
grads:  [0.00787323]
Stock Position:  0.007873225318876614
Bond Position:  [-7.00826889]


portfolio before change:  [-6.21695501]
curr_Stock_Price:  100.61822693676991
curr_Factors:  [100.61822694]
mat_Sqrt:  [[0.15]]
grads:  [0.17022346]
Stock Position:  0.17022346401765764
Bond Position:  [-23.34453814]


portfolio before change:  [-6.22284399]
curr_Stock_Price:  100.60077496692517
curr_Factors:  [100.60077497]
mat_Sqrt:  [[0.15]]
grads:  [0.00374207]
Stock Position:  0.0037420689838115325
Bond Position:  [-6.59929903]


portfolio before change:  [-6.22657873]
curr_Stock_Price:  99.82319171618754
curr_Factors:  [99.82319172]
mat_Sqrt:  [[0.15]]
grads:  [0.15183625]
Stock Position:  0.1518362508268898
Bond Position:  [-21.3833579]


portfolio before change:  [-6.171624]
curr_Stock_Price:  100.2027309406761
curr_Factors:  [100.20273094]
mat_Sqrt:  [[0.15]]
grads:  [-0.03953656]
Stock Position:  -0.03953656220812093
Bond Position:  [-2.2099525]


portfolio before change:  [-6.16158165]
curr_Stock_Price:  99.94174190545705
curr_Factors:  [99.94174191]
mat_Sqrt:  [[0.15]]
grads:  [0.01844826]
Stock Position:  0.0184482605710519
Bond Position:  [-8.00533295]


portfolio before change:  [-6.14514935]
curr_Stock_Price:  100.88671097678343
curr_Factors:  [100.88671098]
mat_Sqrt:  [[0.15]]
grads:  [0.07123448]
Stock Position:  0.07123448383301305
Bond Position:  [-13.33176213]


portfolio before change:  [-6.1763617]
curr_Stock_Price:  100.47194304335216
curr_Factors:  [100.47194304]
mat_Sqrt:  [[0.15]]
grads:  [0.02691475]
Stock Position:  0.026914749270233337
Bond Position:  [-8.88053886]


portfolio before change:  [-6.18595448]
curr_Stock_Price:  100.15677596593456
curr_Factors:  [100.15677597]
mat_Sqrt:  [[0.15]]
grads:  [0.07659908]
Stock Position:  0.0765990782465024
Bond Position:  [-13.8578712]


portfolio before change:  [-6.06717606]
curr_Stock_Price:  101.73004249171646
curr_Factors:  [101.73004249]
mat_Sqrt:  [[0.15]]
grads:  [-0.03551424]
Stock Position:  -0.035514238017635216
Bond Position:  [-2.45431111]


portfolio before change:  [-6.03838075]
curr_Stock_Price:  100.91059337490472
curr_Factors:  [100.91059337]
mat_Sqrt:  [[0.15]]
grads:  [0.16152186]
Stock Position:  0.16152186160959245
Bond Position:  [-22.33764765]


portfolio before change:  [-6.00481252]
curr_Stock_Price:  101.13570602841635
curr_Factors:  [101.13570603]
mat_Sqrt:  [[0.15]]
grads:  [0.00971373]
Stock Position:  0.009713726715210579
Bond Position:  [-6.98721713]


portfolio before change:  [-6.0075001]
curr_Stock_Price:  100.94894707103306
curr_Factors:  [100.94894707]
mat_Sqrt:  [[0.15]]
grads:  [0.06559879]
Stock Position:  0.06559878809972883
Bond Position:  [-12.62962869]


portfolio before change:  [-5.97733392]
curr_Stock_Price:  101.4328734251773
curr_Factors:  [101.43287343]
mat_Sqrt:  [[0.15]]
grads:  [0.0922694]
Stock Position:  0.09226940083720436
Bond Position:  [-15.33648438]


portfolio before change:  [-5.93348267]
curr_Stock_Price:  101.92890385214486
curr_Factors:  [101.92890385]
mat_Sqrt:  [[0.15]]
grads:  [0.0763211]
Stock Position:  0.07632110211953352
Bond Position:  [-13.71280895]


portfolio before change:  [-5.97475121]
curr_Stock_Price:  101.41064185556148
curr_Factors:  [101.41064186]
mat_Sqrt:  [[0.15]]
grads:  [-0.08995614]
Stock Position:  -0.0899561408199121
Bond Position:  [3.14775877]


portfolio before change:  [-5.91639224]
curr_Stock_Price:  100.76626697083712
curr_Factors:  [100.76626697]
mat_Sqrt:  [[0.15]]
grads:  [-0.11609366]
Stock Position:  -0.1160936641788418
Bond Position:  [5.78193292]


portfolio before change:  [-5.79589109]
curr_Stock_Price:  99.73452802702474
curr_Factors:  [99.73452803]
mat_Sqrt:  [[0.15]]
grads:  [0.08238766]
Stock Position:  0.0823876565506276
Bond Position:  [-14.01278514]


portfolio before change:  [-5.80505431]
curr_Stock_Price:  99.64456905912971
curr_Factors:  [99.64456906]
mat_Sqrt:  [[0.15]]
grads:  [0.08760022]
Stock Position:  0.08760022493243493
Bond Position:  [-14.53394097]


portfolio before change:  [-5.78719723]
curr_Stock_Price:  99.86915683919146
curr_Factors:  [99.86915684]
mat_Sqrt:  [[0.15]]
grads:  [0.03607207]
Stock Position:  0.03607207025092558
Bond Position:  [-9.38968447]


portfolio before change:  [-5.81613683]
curr_Stock_Price:  99.0994250925586
curr_Factors:  [99.09942509]
mat_Sqrt:  [[0.15]]
grads:  [0.05450369]
Stock Position:  0.054503691987733395
Bond Position:  [-11.21742137]


portfolio before change:  [-5.79247367]
curr_Stock_Price:  99.55930988927712
curr_Factors:  [99.55930989]
mat_Sqrt:  [[0.15]]
grads:  [-0.06937378]
Stock Position:  -0.06937377935553045
Bond Position:  [1.11433192]


portfolio before change:  [-5.80184266]
curr_Stock_Price:  99.69636871596721
curr_Factors:  [99.69636872]
mat_Sqrt:  [[0.15]]
grads:  [0.05019869]
Stock Position:  0.050198692309799745
Bond Position:  [-10.80647]


portfolio before change:  [-5.82077549]
curr_Stock_Price:  99.34612194054738
curr_Factors:  [99.34612194]
mat_Sqrt:  [[0.15]]
grads:  [-0.07374564]
Stock Position:  -0.07374563917965436
Bond Position:  [1.50556778]


portfolio before change:  [-5.81625638]
curr_Stock_Price:  99.28739439697466
curr_Factors:  [99.2873944]
mat_Sqrt:  [[0.15]]
grads:  [-0.12167917]
Stock Position:  -0.12167917265353323
Bond Position:  [6.26495163]


portfolio before change:  [-5.73649462]
curr_Stock_Price:  98.63832200077121
curr_Factors:  [98.638322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01915417]
Stock Position:  -0.01915416627699258
Bond Position:  [-3.8471598]


portfolio before change:  [-5.72717624]
curr_Stock_Price:  98.12672015131366
curr_Factors:  [98.12672015]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248543]
Stock Position:  -0.02485430449663958
Bond Position:  [-3.28830485]


portfolio before change:  [-5.72278948]
curr_Stock_Price:  97.93368223627488
curr_Factors:  [97.93368224]
mat_Sqrt:  [[0.15]]
grads:  [0.03747987]
Stock Position:  0.03747987004607076
Bond Position:  [-9.39333116]


portfolio before change:  [-5.74062063]
curr_Stock_Price:  97.48925918559573
curr_Factors:  [97.48925919]
mat_Sqrt:  [[0.15]]
grads:  [0.06120785]
Stock Position:  0.061207853958064884
Bond Position:  [-11.70772897]


portfolio before change:  [-5.7569993]
curr_Stock_Price:  97.2455794774889
curr_Factors:  [97.24557948]
mat_Sqrt:  [[0.15]]
grads:  [-0.0847683]
Stock Position:  -0.08476829862484385
Bond Position:  [2.48634302]


portfolio before change:  [-5.75849671]
curr_Stock_Price:  97.26691083533214
curr_Factors:  [97.26691084]
mat_Sqrt:  [[0.15]]
grads:  [0.02093638]
Stock Position:  0.02093637576732944
Bond Position:  [-7.79491331]


portfolio before change:  [-5.76990999]
curr_Stock_Price:  96.7683121314013
curr_Factors:  [96.76831213]
mat_Sqrt:  [[0.15]]
grads:  [0.03755438]
Stock Position:  0.03755437854007692
Bond Position:  [-9.40398381]


portfolio before change:  [-5.78724919]
curr_Stock_Price:  96.33790628199581
curr_Factors:  [96.33790628]
mat_Sqrt:  [[0.15]]
grads:  [0.0232621]
Stock Position:  0.02326210081582592
Bond Position:  [-8.02827127]


portfolio before change:  [-5.78267551]
curr_Stock_Price:  96.57766403527654
curr_Factors:  [96.57766404]
mat_Sqrt:  [[0.15]]
grads:  [0.07661796]
Stock Position:  0.07661796254794592
Bond Position:  [-13.18225936]


portfolio before change:  [-5.77014807]
curr_Stock_Price:  96.76267721336696
curr_Factors:  [96.76267721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.77014807]
Stock Price:  96.45567850295124
PL:  [-5.77014807]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.42050671e-03]
 [-6.27725845e-04]
 [ 8.78047960e-03]
 [-2.40020574e-03]
 [ 1.53582963e-02]
 [ 2.64824547e-02]
 [-5.79827221e-03]
 [ 8.42358113e-03]
 [-9.27579469e-03]
 [-3.02866842e-03]
 [ 1.79884656e-02]
 [ 6.70344004e-03]
 [ 8.78901192e-03]
 [-5.37662857e-03]
 [ 1.82465601e-02]
 [ 2.42371267e-03]
 [ 8.74155578e-03]
 [ 1.19916062e-02]
 [ 1.16649795e-02]
 [-1.44486026e-02]
 [-4.95021148e-03]
 [ 2.80142635e-02]
 [-2.73603164e-02]
 [ 7.98803663e-03]
 [ 6.42401375e-03]
 [-6.18960299e-03]
 [-1.04104735e-03]
 [-1.12885814e-02]
 [-8.90023826e-03]
 [-1.05631729e-02]
 [-7.96161147e-04]
 [ 5.15851997e-03]
 [ 5.11353593e-03]
 [-1.21403627e-02]
 [ 1.42218484e-02]
 [ 5.47802490e-03]
 [ 2.45232184e-03]
 [ 8.13655387e-03]
 [-2.63485645e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.35382311]
curr_Stock_Price:  99.85123914257356
curr_Factors:  [99.85123914]
mat_Sqrt:  [[0.15]]
grads:  [0.01613671]
Stock Position:  0.016136711369793805
Bond Position:  [-1.96509374]


portfolio before change:  [-0.35893791]
curr_Stock_Price:  99.54949596674595
curr_Factors:  [99.54949597]
mat_Sqrt:  [[0.15]]
grads:  [-0.00418484]
Stock Position:  -0.0041848389697175924
Bond Position:  [0.0576607]


portfolio before change:  [-0.36200554]
curr_Stock_Price:  100.28425457229748
curr_Factors:  [100.28425457]
mat_Sqrt:  [[0.15]]
grads:  [0.05853653]
Stock Position:  0.058536530648965704
Bond Position:  [-6.23229789]


portfolio before change:  [-0.39568165]
curr_Stock_Price:  99.72226331089729
curr_Factors:  [99.72226331]
mat_Sqrt:  [[0.15]]
grads:  [-0.01600137]
Stock Position:  -0.016001371584120502
Bond Position:  [1.20001134]


portfolio before change:  [-0.41026429]
curr_Stock_Price:  100.6429752186754
curr_Factors:  [100.64297522]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-10.71496186]


portfolio before change:  [-0.33861787]
curr_Stock_Price:  101.35580693813313
curr_Factors:  [101.35580694]
mat_Sqrt:  [[0.15]]
grads:  [0.1765497]
Stock Position:  0.17654969768588974
Bond Position:  [-18.23295495]


portfolio before change:  [-0.37503713]
curr_Stock_Price:  101.16243364640204
curr_Factors:  [101.16243365]
mat_Sqrt:  [[0.15]]
grads:  [-0.03865515]
Stock Position:  -0.0386551480473557
Bond Position:  [3.53541172]


portfolio before change:  [-0.42305195]
curr_Stock_Price:  102.4159994943417
curr_Factors:  [102.41599949]
mat_Sqrt:  [[0.15]]
grads:  [0.05615721]
Stock Position:  0.05615720754363248
Bond Position:  [-6.17444849]


portfolio before change:  [-0.42278585]
curr_Stock_Price:  102.43448248106584
curr_Factors:  [102.43448248]
mat_Sqrt:  [[0.15]]
grads:  [-0.06183863]
Stock Position:  -0.06183863125824284
Bond Position:  [5.91162234]


portfolio before change:  [-0.45072794]
curr_Stock_Price:  102.89828780480133
curr_Factors:  [102.8982878]
mat_Sqrt:  [[0.15]]
grads:  [-0.02019112]
Stock Position:  -0.02019112282593351
Bond Position:  [1.62690403]


portfolio before change:  [-0.4547926]
curr_Stock_Price:  103.10966939952863
curr_Factors:  [103.1096694]
mat_Sqrt:  [[0.15]]
grads:  [0.1199231]
Stock Position:  0.11992310423942484
Bond Position:  [-12.82002423]


portfolio before change:  [-0.51204013]
curr_Stock_Price:  102.64566427080025
curr_Factors:  [102.64566427]
mat_Sqrt:  [[0.15]]
grads:  [0.0446896]
Stock Position:  0.044689600252812586
Bond Position:  [-5.09923384]


portfolio before change:  [-0.54562054]
curr_Stock_Price:  101.90851376785197
curr_Factors:  [101.90851377]
mat_Sqrt:  [[0.15]]
grads:  [0.05859341]
Stock Position:  0.05859341281833491
Bond Position:  [-6.51678816]


portfolio before change:  [-0.55010992]
curr_Stock_Price:  101.84579791764547
curr_Factors:  [101.84579792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03584419]
Stock Position:  -0.035844190444937946
Bond Position:  [3.10047025]


portfolio before change:  [-0.5507217]
curr_Stock_Price:  101.87367843345771
curr_Factors:  [101.87367843]
mat_Sqrt:  [[0.15]]
grads:  [0.12164373]
Stock Position:  0.12164373431205983
Bond Position:  [-12.94301637]


portfolio before change:  [-0.48660716]
curr_Stock_Price:  102.4140475439525
curr_Factors:  [102.41404754]
mat_Sqrt:  [[0.15]]
grads:  [0.01615808]
Stock Position:  0.016158084476531973
Bond Position:  [-2.14142199]


portfolio before change:  [-0.48767531]
curr_Stock_Price:  102.36450843892294
curr_Factors:  [102.36450844]
mat_Sqrt:  [[0.15]]
grads:  [0.05827704]
Stock Position:  0.05827703854849819
Bond Position:  [-6.45317571]


portfolio before change:  [-0.50746377]
curr_Stock_Price:  102.03879241800163
curr_Factors:  [102.03879242]
mat_Sqrt:  [[0.15]]
grads:  [0.07994404]
Stock Position:  0.07994404113107083
Bond Position:  [-8.66485719]


portfolio before change:  [-0.56155105]
curr_Stock_Price:  101.37577741318871
curr_Factors:  [101.37577741]
mat_Sqrt:  [[0.15]]
grads:  [0.07776653]
Stock Position:  0.07776653013068914
Bond Position:  [-8.44519349]


portfolio before change:  [-0.4837055]
curr_Stock_Price:  102.39036886610842
curr_Factors:  [102.39036887]
mat_Sqrt:  [[0.15]]
grads:  [-0.09632402]
Stock Position:  -0.0963240174676947
Bond Position:  [9.37894618]


portfolio before change:  [-0.49460278]
curr_Stock_Price:  102.51567216147902
curr_Factors:  [102.51567216]
mat_Sqrt:  [[0.15]]
grads:  [-0.03300141]
Stock Position:  -0.03300140984095107
Bond Position:  [2.88855893]


portfolio before change:  [-0.51156911]
curr_Stock_Price:  103.0407231375355
curr_Factors:  [103.04072314]
mat_Sqrt:  [[0.15]]
grads:  [0.18676176]
Stock Position:  0.18676175685710533
Bond Position:  [-19.75563559]


portfolio before change:  [-0.33481086]
curr_Stock_Price:  104.00038350118048
curr_Factors:  [104.0003835]
mat_Sqrt:  [[0.15]]
grads:  [-0.18240211]
Stock Position:  -0.18240210901567402
Bond Position:  [18.63507843]


portfolio before change:  [-0.50556176]
curr_Stock_Price:  104.94927836529176
curr_Factors:  [104.94927837]
mat_Sqrt:  [[0.15]]
grads:  [0.05325358]
Stock Position:  0.05325357755456587
Bond Position:  [-6.09448629]


portfolio before change:  [-0.56511066]
curr_Stock_Price:  103.84537042985788
curr_Factors:  [103.84537043]
mat_Sqrt:  [[0.15]]
grads:  [0.04282676]
Stock Position:  0.042826758329584075
Bond Position:  [-5.01247124]


portfolio before change:  [-0.62538644]
curr_Stock_Price:  102.45256882156367
curr_Factors:  [102.45256882]
mat_Sqrt:  [[0.15]]
grads:  [-0.04126402]
Stock Position:  -0.04126401995808374
Bond Position:  [3.60221841]


portfolio before change:  [-0.62297875]
curr_Stock_Price:  102.40513319446853
curr_Factors:  [102.40513319]
mat_Sqrt:  [[0.15]]
grads:  [-0.00694032]
Stock Position:  -0.006940315670538419
Bond Position:  [0.0877452]


portfolio before change:  [-0.61669628]
curr_Stock_Price:  101.5014998062185
curr_Factors:  [101.50149981]
mat_Sqrt:  [[0.15]]
grads:  [-0.07525721]
Stock Position:  -0.07525720910792286
Bond Position:  [7.02202332]


portfolio before change:  [-0.61049189]
curr_Stock_Price:  101.43072149838837
curr_Factors:  [101.4307215]
mat_Sqrt:  [[0.15]]
grads:  [-0.05933492]
Stock Position:  -0.059334921720333444
Bond Position:  [5.40789203]


portfolio before change:  [-0.62579752]
curr_Stock_Price:  101.70006811406105
curr_Factors:  [101.70006811]
mat_Sqrt:  [[0.15]]
grads:  [-0.07042115]
Stock Position:  -0.07042115289153052
Bond Position:  [6.53603852]


portfolio before change:  [-0.60739641]
curr_Stock_Price:  101.4503695482781
curr_Factors:  [101.45036955]
mat_Sqrt:  [[0.15]]
grads:  [-0.00530774]
Stock Position:  -0.00530774097730731
Bond Position:  [-0.06892412]


portfolio before change:  [-0.60850097]
curr_Stock_Price:  101.65685100545335
curr_Factors:  [101.65685101]
mat_Sqrt:  [[0.15]]
grads:  [0.03439013]
Stock Position:  0.03439013314732689
Bond Position:  [-4.10449361]


portfolio before change:  [-0.63654181]
curr_Stock_Price:  100.85639643868046
curr_Factors:  [100.85639644]
mat_Sqrt:  [[0.15]]
grads:  [0.03409024]
Stock Position:  0.03409023953233079
Bond Position:  [-4.07476052]


portfolio before change:  [-0.70246685]
curr_Stock_Price:  98.93749916816077
curr_Factors:  [98.93749917]
mat_Sqrt:  [[0.15]]
grads:  [-0.08093575]
Stock Position:  -0.08093575147320974
Bond Position:  [7.30511399]


portfolio before change:  [-0.74192857]
curr_Stock_Price:  99.43635055681682
curr_Factors:  [99.43635056]
mat_Sqrt:  [[0.15]]
grads:  [0.09481232]
Stock Position:  0.09481232264062084
Bond Position:  [-10.16971992]


portfolio before change:  [-0.59866521]
curr_Stock_Price:  100.96077949134099
curr_Factors:  [100.96077949]
mat_Sqrt:  [[0.15]]
grads:  [0.03652017]
Stock Position:  0.0365201660222862
Bond Position:  [-4.28576964]


portfolio before change:  [-0.60063376]
curr_Stock_Price:  100.9215465565737
curr_Factors:  [100.92154656]
mat_Sqrt:  [[0.15]]
grads:  [0.01634881]
Stock Position:  0.016348812249147207
Bond Position:  [-2.25058118]


portfolio before change:  [-0.6128593]
curr_Stock_Price:  100.19096150068094
curr_Factors:  [100.1909615]
mat_Sqrt:  [[0.15]]
grads:  [0.05424369]
Stock Position:  0.054243692453322175
Bond Position:  [-6.047587]


portfolio before change:  [-0.66511777]
curr_Stock_Price:  99.24149679641368
curr_Factors:  [99.2414968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.66511777]
Stock Price:  98.9555729851343
PL:  [-0.66511777]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.12873998e-03]
 [ 4.16834859e-03]
 [ 6.78359897e-03]
 [-8.41988502e-04]
 [ 1.34450165e-02]
 [ 2.56877176e-02]
 [-6.85781893e-03]
 [ 2.15547651e-02]
 [-5.93896435e-03]
 [ 3.50895786e-03]
 [ 5.87773479e-03]
 [ 4.08001897e-03]
 [ 1.22652932e-02]
 [-4.93670300e-03]
 [ 2.23930211e-02]
 [-2.98547887e-03]
 [ 1.53419833e-02]
 [-9.21968965e-03]
 [ 3.10326001e-03]
 [ 3.56345042e-03]
 [ 2.43344781e-02]
 [ 3.15422598e-05]
 [ 2.83099471e-02]
 [ 3.00564694e-03]
 [ 1.13181618e-02]
 [ 1.04666532e-02]
 [ 3.22632259e-02]
 [-2.30240086e-02]
 [-4.74956379e-02]
 [ 1.84912781e-03]
 [-4.33732149e-03]
 [ 5.58704065e-03]
 [ 1.59246490e-02]
 [-1.38548013e-02]
 [ 4.11525598e-03]
 [ 4.79265716e-03]
 [ 6.14616266e-03]
 [ 9.24445908e-03]
 [-6.84820323e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.69578375]
curr_Stock_Price:  99.57114200109402
curr_Factors:  [99.571142]
mat_Sqrt:  [[0.15]]
grads:  [0.02752493]
Stock Position:  0.027524933171772382
Bond Position:  [-7.43647278]


portfolio before change:  [-4.6718408]
curr_Stock_Price:  100.47477958897282
curr_Factors:  [100.47477959]
mat_Sqrt:  [[0.15]]
grads:  [0.02778899]
Stock Position:  0.027788990617080497
Bond Position:  [-7.46393351]


portfolio before change:  [-4.68754906]
curr_Stock_Price:  99.94308668022157
curr_Factors:  [99.94308668]
mat_Sqrt:  [[0.15]]
grads:  [0.04522399]
Stock Position:  0.04522399316446913
Bond Position:  [-9.20737453]


portfolio before change:  [-4.73862192]
curr_Stock_Price:  98.83920656525197
curr_Factors:  [98.83920657]
mat_Sqrt:  [[0.15]]
grads:  [-0.00561326]
Stock Position:  -0.005613256676847435
Bond Position:  [-4.18381208]


portfolio before change:  [-4.74546155]
curr_Stock_Price:  99.96451057375124
curr_Factors:  [99.96451057]
mat_Sqrt:  [[0.15]]
grads:  [0.08963344]
Stock Position:  0.08963344346610373
Bond Position:  [-13.70562486]


portfolio before change:  [-4.68385433]
curr_Stock_Price:  100.6709492238069
curr_Factors:  [100.67094922]
mat_Sqrt:  [[0.15]]
grads:  [0.17125145]
Stock Position:  0.17125145092390034
Bond Position:  [-21.92390045]


portfolio before change:  [-4.88084478]
curr_Stock_Price:  99.53665350268935
curr_Factors:  [99.5366535]
mat_Sqrt:  [[0.15]]
grads:  [-0.04571879]
Stock Position:  -0.045718792897302726
Bond Position:  [-0.33014913]


portfolio before change:  [-4.90509375]
curr_Stock_Price:  100.06614480607044
curr_Factors:  [100.06614481]
mat_Sqrt:  [[0.15]]
grads:  [0.14369843]
Stock Position:  0.14369843379768416
Bond Position:  [-19.28444204]


portfolio before change:  [-4.92866083]
curr_Stock_Price:  99.91891725130174
curr_Factors:  [99.91891725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0395931]
Stock Position:  -0.03959309569298255
Bond Position:  [-0.97256158]


portfolio before change:  [-4.92465959]
curr_Stock_Price:  99.81478747526931
curr_Factors:  [99.81478748]
mat_Sqrt:  [[0.15]]
grads:  [0.02339305]
Stock Position:  0.023393052408006567
Bond Position:  [-7.25963214]


portfolio before change:  [-4.92425124]
curr_Stock_Price:  99.87103748925442
curr_Factors:  [99.87103749]
mat_Sqrt:  [[0.15]]
grads:  [0.0391849]
Stock Position:  0.039184898580348175
Bond Position:  [-8.83768771]


portfolio before change:  [-4.91552135]
curr_Stock_Price:  100.12201854281723
curr_Factors:  [100.12201854]
mat_Sqrt:  [[0.15]]
grads:  [0.02720013]
Stock Position:  0.027200126466082216
Bond Position:  [-7.63885292]


portfolio before change:  [-4.90037916]
curr_Stock_Price:  100.71382122963648
curr_Factors:  [100.71382123]
mat_Sqrt:  [[0.15]]
grads:  [0.08176862]
Stock Position:  0.08176862107041998
Bond Position:  [-13.13560944]


portfolio before change:  [-4.83203334]
curr_Stock_Price:  101.5697470581784
curr_Factors:  [101.56974706]
mat_Sqrt:  [[0.15]]
grads:  [-0.03291135]
Stock Position:  -0.032911353312922054
Bond Position:  [-1.48923551]


portfolio before change:  [-4.80183168]
curr_Stock_Price:  100.64642359929347
curr_Factors:  [100.6464236]
mat_Sqrt:  [[0.15]]
grads:  [0.14928681]
Stock Position:  0.14928680736651367
Bond Position:  [-19.82701493]


portfolio before change:  [-4.99967937]
curr_Stock_Price:  99.33774024650546
curr_Factors:  [99.33774025]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990319]
Stock Position:  -0.01990319244835159
Bond Position:  [-3.02254121]


portfolio before change:  [-4.9673549]
curr_Stock_Price:  97.69467144745929
curr_Factors:  [97.69467145]
mat_Sqrt:  [[0.15]]
grads:  [0.10227989]
Stock Position:  0.10227988889234506
Bond Position:  [-14.95955504]


portfolio before change:  [-4.96135344]
curr_Stock_Price:  97.77163203807316
curr_Factors:  [97.77163204]
mat_Sqrt:  [[0.15]]
grads:  [-0.0614646]
Stock Position:  -0.061464597659847894
Bond Position:  [1.04814059]


portfolio before change:  [-4.85557389]
curr_Stock_Price:  96.05278043286035
curr_Factors:  [96.05278043]
mat_Sqrt:  [[0.15]]
grads:  [0.0206884]
Stock Position:  0.020688400045160392
Bond Position:  [-6.84275224]


portfolio before change:  [-4.8677681]
curr_Stock_Price:  95.50470470176926
curr_Factors:  [95.5047047]
mat_Sqrt:  [[0.15]]
grads:  [0.02375634]
Stock Position:  0.023756336115248675
Bond Position:  [-7.13660996]


portfolio before change:  [-4.86851734]
curr_Stock_Price:  95.51071953415051
curr_Factors:  [95.51071953]
mat_Sqrt:  [[0.15]]
grads:  [0.16222985]
Stock Position:  0.16222985400918793
Bond Position:  [-20.36320742]


portfolio before change:  [-4.98322601]
curr_Stock_Price:  94.81933560769245
curr_Factors:  [94.81933561]
mat_Sqrt:  [[0.15]]
grads:  [0.00021028]
Stock Position:  0.00021028173178712015
Bond Position:  [-5.00316479]


portfolio before change:  [-4.98387106]
curr_Stock_Price:  94.72607431206966
curr_Factors:  [94.72607431]
mat_Sqrt:  [[0.15]]
grads:  [0.18873298]
Stock Position:  0.1887329805271842
Bond Position:  [-22.8618054]


portfolio before change:  [-4.81257171]
curr_Stock_Price:  95.64884495599519
curr_Factors:  [95.64884496]
mat_Sqrt:  [[0.15]]
grads:  [0.02003765]
Stock Position:  0.020037646251605794
Bond Position:  [-6.72914943]


portfolio before change:  [-4.83393691]
curr_Stock_Price:  94.6245726360049
curr_Factors:  [94.62457264]
mat_Sqrt:  [[0.15]]
grads:  [0.07545441]
Stock Position:  0.07545441207105627
Bond Position:  [-11.97377841]


portfolio before change:  [-4.85313972]
curr_Stock_Price:  94.38991444001168
curr_Factors:  [94.38991444]
mat_Sqrt:  [[0.15]]
grads:  [0.06977769]
Stock Position:  0.06977768783181111
Bond Position:  [-11.43944971]


portfolio before change:  [-4.89808039]
curr_Stock_Price:  93.76635336695061
curr_Factors:  [93.76635337]
mat_Sqrt:  [[0.15]]
grads:  [0.21508817]
Stock Position:  0.21508817245706682
Bond Position:  [-25.06611398]


portfolio before change:  [-4.57800328]
curr_Stock_Price:  95.26904208201569
curr_Factors:  [95.26904208]
mat_Sqrt:  [[0.15]]
grads:  [-0.15349339]
Stock Position:  -0.15349339084090502
Bond Position:  [10.04516503]


portfolio before change:  [-4.48292114]
curr_Stock_Price:  94.65776870439858
curr_Factors:  [94.6577687]
mat_Sqrt:  [[0.15]]
grads:  [-0.31663759]
Stock Position:  -0.31663758616974413
Bond Position:  [25.48928626]


portfolio before change:  [-4.55139024]
curr_Stock_Price:  94.88406990802783
curr_Factors:  [94.88406991]
mat_Sqrt:  [[0.15]]
grads:  [0.01232752]
Stock Position:  0.012327518740368408
Bond Position:  [-5.72107539]


portfolio before change:  [-4.55490552]
curr_Stock_Price:  94.65692809185455
curr_Factors:  [94.65692809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02891548]
Stock Position:  -0.028915476591216387
Bond Position:  [-1.81785533]


portfolio before change:  [-4.52838242]
curr_Stock_Price:  93.73180627155062
curr_Factors:  [93.73180627]
mat_Sqrt:  [[0.15]]
grads:  [0.03724694]
Stock Position:  0.03724693769577822
Bond Position:  [-8.01960517]


portfolio before change:  [-4.49611158]
curr_Stock_Price:  94.62512434187813
curr_Factors:  [94.62512434]
mat_Sqrt:  [[0.15]]
grads:  [0.10616433]
Stock Position:  0.10616432649310724
Bond Position:  [-14.54192417]


portfolio before change:  [-4.52777487]
curr_Stock_Price:  94.34399940158136
curr_Factors:  [94.3439994]
mat_Sqrt:  [[0.15]]
grads:  [-0.09236534]
Stock Position:  -0.09236534203548027
Bond Position:  [4.1863409]


portfolio before change:  [-4.503368]
curr_Stock_Price:  94.08542247128369
curr_Factors:  [94.08542247]
mat_Sqrt:  [[0.15]]
grads:  [0.02743504]
Stock Position:  0.02743503987883554
Bond Position:  [-7.08460531]


portfolio before change:  [-4.5237075]
curr_Stock_Price:  93.3763337827009
curr_Factors:  [93.37633378]
mat_Sqrt:  [[0.15]]
grads:  [0.03195105]
Stock Position:  0.031951047754389464
Bond Position:  [-7.5071792]


portfolio before change:  [-4.50487219]
curr_Stock_Price:  93.99521095107316
curr_Factors:  [93.99521095]
mat_Sqrt:  [[0.15]]
grads:  [0.04097442]
Stock Position:  0.04097441773535055
Bond Position:  [-8.35627123]


portfolio before change:  [-4.51131355]
curr_Stock_Price:  93.86350039297066
curr_Factors:  [93.86350039]
mat_Sqrt:  [[0.15]]
grads:  [0.06162973]
Stock Position:  0.061629727202730175
Bond Position:  [-10.29609547]


portfolio before change:  [-4.51075859]
curr_Stock_Price:  93.89338944974102
curr_Factors:  [93.89338945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.51075859]
Stock Price:  94.11882918332375
PL:  [-4.51075859]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.30057681e-03]
 [-9.05988485e-04]
 [ 4.16251867e-03]
 [ 4.53337238e-03]
 [-5.70506444e-02]
 [-2.65624738e-02]
 [-4.33656644e-02]
 [ 2.35611001e-02]
 [-5.90424159e-03]
 [ 4.00204783e-03]
 [ 2.81610636e-03]
 [ 6.81974066e-03]
 [ 1.27879599e-02]
 [ 3.75867327e-03]
 [ 1.46385600e-02]
 [-3.09166634e-03]
 [ 1.31674284e-02]
 [-3.04653628e-03]
 [ 1.14872500e-02]
 [-9.69925280e-03]
 [ 1.29967207e-02]
 [ 1.52433618e-02]
 [ 1.22839869e-02]
 [ 5.17930324e-03]
 [-1.55964788e-03]
 [-1.08831452e-02]
 [ 1.15449227e-02]
 [-1.08671151e-02]
 [-1.85118309e-02]
 [-9.74645138e-03]
 [-2.97603446e-04]
 [ 4.89749385e-03]
 [ 5.51619122e-03]
 [-4.35205465e-03]
 [ 8.11220716e-03]
 [ 5.41079703e-03]
 [ 1.82828241e-03]
 [ 7.85993100e-03]
 [-6.04342922e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.93367501]
curr_Stock_Price:  99.68481452420683
curr_Factors:  [99.68481452]
mat_Sqrt:  [[0.15]]
grads:  [0.02200385]
Stock Position:  0.022003845382030887
Bond Position:  [-5.12712425]


portfolio before change:  [-2.93771299]
curr_Stock_Price:  99.53043028490434
curr_Factors:  [99.53043028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00603992]
Stock Position:  -0.006039923235437393
Bond Position:  [-2.33655683]


portfolio before change:  [-2.93794754]
curr_Stock_Price:  99.52090435035814
curr_Factors:  [99.52090435]
mat_Sqrt:  [[0.15]]
grads:  [0.02775012]
Stock Position:  0.02775012443342384
Bond Position:  [-5.69966502]


portfolio before change:  [-2.984474]
curr_Stock_Price:  97.8699584165405
curr_Factors:  [97.86995842]
mat_Sqrt:  [[0.15]]
grads:  [0.03022248]
Stock Position:  0.03022248254515091
Bond Position:  [-5.94234711]


portfolio before change:  [-3.00961382]
curr_Stock_Price:  97.06271215863804
curr_Factors:  [97.06271216]
mat_Sqrt:  [[0.15]]
grads:  [-0.38033763]
Stock Position:  -0.3803376293355028
Bond Position:  [33.90698802]


portfolio before change:  [-3.3933966]
curr_Stock_Price:  98.08291470113552
curr_Factors:  [98.0829147]
mat_Sqrt:  [[0.15]]
grads:  [-0.17708316]
Stock Position:  -0.17708315884248502
Bond Position:  [13.97543576]


portfolio before change:  [-3.48126018]
curr_Stock_Price:  98.5889516632611
curr_Factors:  [98.58895166]
mat_Sqrt:  [[0.15]]
grads:  [-0.28910443]
Stock Position:  -0.28910442962336147
Bond Position:  [25.02124245]


portfolio before change:  [-3.70370241]
curr_Stock_Price:  99.36918902491034
curr_Factors:  [99.36918902]
mat_Sqrt:  [[0.15]]
grads:  [0.157074]
Stock Position:  0.15707400062235302
Bond Position:  [-19.31201847]


portfolio before change:  [-3.65503414]
curr_Stock_Price:  99.6944014853334
curr_Factors:  [99.69440149]
mat_Sqrt:  [[0.15]]
grads:  [-0.03936161]
Stock Position:  -0.03936161058325032
Bond Position:  [0.26909807]


portfolio before change:  [-3.65315952]
curr_Stock_Price:  99.64763037712996
curr_Factors:  [99.64763038]
mat_Sqrt:  [[0.15]]
grads:  [0.02668032]
Stock Position:  0.02668031888762674
Bond Position:  [-6.31179007]


portfolio before change:  [-3.66591674]
curr_Stock_Price:  99.19905268348978
curr_Factors:  [99.19905268]
mat_Sqrt:  [[0.15]]
grads:  [0.01877404]
Stock Position:  0.018774042391175513
Bond Position:  [-5.52828396]


portfolio before change:  [-3.67617261]
curr_Stock_Price:  98.6895833372791
curr_Factors:  [98.68958334]
mat_Sqrt:  [[0.15]]
grads:  [0.04546494]
Stock Position:  0.045464937756511975
Bond Position:  [-8.16308838]


portfolio before change:  [-3.63154333]
curr_Stock_Price:  99.6936478826051
curr_Factors:  [99.69364788]
mat_Sqrt:  [[0.15]]
grads:  [0.08525307]
Stock Position:  0.08525306607646484
Bond Position:  [-12.13073248]


portfolio before change:  [-3.69671752]
curr_Stock_Price:  98.94695625922338
curr_Factors:  [98.94695626]
mat_Sqrt:  [[0.15]]
grads:  [0.02505782]
Stock Position:  0.025057821789250548
Bond Position:  [-6.17611271]


portfolio before change:  [-3.67960195]
curr_Stock_Price:  99.66081029218884
curr_Factors:  [99.66081029]
mat_Sqrt:  [[0.15]]
grads:  [0.0975904]
Stock Position:  0.09759039991907761
Bond Position:  [-13.40554029]


portfolio before change:  [-3.72104032]
curr_Stock_Price:  99.25336680512774
curr_Factors:  [99.25336681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02061111]
Stock Position:  -0.0206111089040569
Bond Position:  [-1.67531837]


portfolio before change:  [-3.70656862]
curr_Stock_Price:  98.5410746227822
curr_Factors:  [98.54107462]
mat_Sqrt:  [[0.15]]
grads:  [0.08778286]
Stock Position:  0.08778285608908525
Bond Position:  [-12.35678559]


portfolio before change:  [-3.67368318]
curr_Stock_Price:  98.93329393644125
curr_Factors:  [98.93329394]
mat_Sqrt:  [[0.15]]
grads:  [-0.02031024]
Stock Position:  -0.020310241895748506
Bond Position:  [-1.66432405]


portfolio before change:  [-3.69273047]
curr_Stock_Price:  99.8608672268121
curr_Factors:  [99.86086723]
mat_Sqrt:  [[0.15]]
grads:  [0.07658167]
Stock Position:  0.0765816665321391
Bond Position:  [-11.34024211]


portfolio before change:  [-3.77137718]
curr_Stock_Price:  98.85241322121028
curr_Factors:  [98.85241322]
mat_Sqrt:  [[0.15]]
grads:  [-0.06466169]
Stock Position:  -0.06466168530781913
Bond Position:  [2.62058645]


portfolio before change:  [-3.74114328]
curr_Stock_Price:  98.38990892734196
curr_Factors:  [98.38990893]
mat_Sqrt:  [[0.15]]
grads:  [0.0866448]
Stock Position:  0.0866448048860379
Bond Position:  [-12.26611774]


portfolio before change:  [-3.59654297]
curr_Stock_Price:  100.07649213517956
curr_Factors:  [100.07649214]
mat_Sqrt:  [[0.15]]
grads:  [0.10162241]
Stock Position:  0.10162241193334297
Bond Position:  [-13.76655748]


portfolio before change:  [-3.62567631]
curr_Stock_Price:  99.80674441523705
curr_Factors:  [99.80674442]
mat_Sqrt:  [[0.15]]
grads:  [0.08189325]
Stock Position:  0.08189324609049399
Bond Position:  [-11.79917459]


portfolio before change:  [-3.64103253]
curr_Stock_Price:  99.63724042815147
curr_Factors:  [99.63724043]
mat_Sqrt:  [[0.15]]
grads:  [0.03452869]
Stock Position:  0.034528688262481635
Bond Position:  [-7.08137574]


portfolio before change:  [-3.6282287]
curr_Stock_Price:  100.03369501047831
curr_Factors:  [100.03369501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039765]
Stock Position:  -0.010397652540898826
Bond Position:  [-2.5881131]


portfolio before change:  [-3.61895127]
curr_Stock_Price:  99.11031714778814
curr_Factors:  [99.11031715]
mat_Sqrt:  [[0.15]]
grads:  [-0.0725543]
Stock Position:  -0.07255430139503852
Bond Position:  [3.57192855]


portfolio before change:  [-3.62752658]
curr_Stock_Price:  99.23466305562243
curr_Factors:  [99.23466306]
mat_Sqrt:  [[0.15]]
grads:  [0.07696615]
Stock Position:  0.07696615109314901
Bond Position:  [-11.26523665]


portfolio before change:  [-3.63561034]
curr_Stock_Price:  99.14792992479869
curr_Factors:  [99.14792992]
mat_Sqrt:  [[0.15]]
grads:  [-0.07244743]
Stock Position:  -0.07244743386951566
Bond Position:  [3.54740275]


portfolio before change:  [-3.753934]
curr_Stock_Price:  100.78728565613648
curr_Factors:  [100.78728566]
mat_Sqrt:  [[0.15]]
grads:  [-0.12341221]
Stock Position:  -0.12341220572800932
Bond Position:  [8.68444723]


portfolio before change:  [-3.81260115]
curr_Stock_Price:  101.27145797010435
curr_Factors:  [101.27145797]
mat_Sqrt:  [[0.15]]
grads:  [-0.06497634]
Stock Position:  -0.06497634255354867
Bond Position:  [2.76764779]


portfolio before change:  [-3.84263816]
curr_Stock_Price:  101.73905867977034
curr_Factors:  [101.73905868]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198402]
Stock Position:  -0.0019840229706229767
Bond Position:  [-3.64078553]


portfolio before change:  [-3.84610941]
curr_Stock_Price:  103.25926355568812
curr_Factors:  [103.25926356]
mat_Sqrt:  [[0.15]]
grads:  [0.03264996]
Stock Position:  0.032649958988885334
Bond Position:  [-7.21752013]


portfolio before change:  [-3.82807037]
curr_Stock_Price:  103.83939550129124
curr_Factors:  [103.8393955]
mat_Sqrt:  [[0.15]]
grads:  [0.03677461]
Stock Position:  0.03677460814237114
Bond Position:  [-7.64672345]


portfolio before change:  [-3.85540006]
curr_Stock_Price:  103.12222164743825
curr_Factors:  [103.12222165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0290137]
Stock Position:  -0.02901369767256522
Bond Position:  [-0.8634431]


portfolio before change:  [-3.86664136]
curr_Stock_Price:  103.50594968558747
curr_Factors:  [103.50594969]
mat_Sqrt:  [[0.15]]
grads:  [0.05408138]
Stock Position:  0.05408138104405725
Bond Position:  [-9.46438607]


portfolio before change:  [-3.92599726]
curr_Stock_Price:  102.43029715209968
curr_Factors:  [102.43029715]
mat_Sqrt:  [[0.15]]
grads:  [0.03607198]
Stock Position:  0.036071980226167845
Bond Position:  [-7.62086091]


portfolio before change:  [-3.97401176]
curr_Stock_Price:  101.12563273801314
curr_Factors:  [101.12563274]
mat_Sqrt:  [[0.15]]
grads:  [0.01218855]
Stock Position:  0.012188549430591533
Bond Position:  [-5.20658653]


portfolio before change:  [-3.97701769]
curr_Stock_Price:  100.93241321385149
curr_Factors:  [100.93241321]
mat_Sqrt:  [[0.15]]
grads:  [0.05239954]
Stock Position:  0.05239953996926753
Bond Position:  [-9.26582971]


portfolio before change:  [-4.02189886]
curr_Stock_Price:  100.09800000423401
curr_Factors:  [100.098]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.02189886]
Stock Price:  100.54374148764175
PL:  [-4.56564034]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.78501832e-03]
 [ 3.45374313e-03]
 [ 9.76649351e-03]
 [-2.36237247e-03]
 [ 4.68890610e-03]
 [ 1.57956282e-02]
 [-2.06802722e-03]
 [ 2.28524194e-02]
 [-5.89531855e-03]
 [ 3.54000253e-03]
 [ 1.43168291e-03]
 [ 5.70270194e-03]
 [ 1.38785120e-02]
 [ 2.42260150e-03]
 [ 6.91120940e-04]
 [-3.03800800e-03]
 [ 1.05193667e-02]
 [ 4.19791739e-03]
 [ 1.12973619e-02]
 [-1.20687871e-02]
 [-1.73705136e-02]
 [ 2.12325917e-02]
 [ 4.02132463e-03]
 [ 5.05873306e-03]
 [ 1.55583765e-02]
 [-1.10511743e-02]
 [ 4.31319663e-03]
 [-1.14090766e-02]
 [-1.78683376e-02]
 [-8.56782281e-03]
 [-1.74563958e-03]
 [ 5.16057020e-03]
 [ 5.12754756e-03]
 [-5.64024058e-03]
 [ 8.66577080e-03]
 [ 5.27043682e-03]
 [-7.78029577e-03]
 [ 9.63819973e-03]
 [-1.40873537e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.71438585]
curr_Stock_Price:  99.31190451473137
curr_Factors:  [99.31190451]
mat_Sqrt:  [[0.15]]
grads:  [0.03856679]
Stock Position:  0.03856678880092719
Bond Position:  [-12.5445271]


portfolio before change:  [-8.66439663]
curr_Stock_Price:  100.64873814948058
curr_Factors:  [100.64873815]
mat_Sqrt:  [[0.15]]
grads:  [0.02302495]
Stock Position:  0.023024954181144777
Bond Position:  [-10.98182922]


portfolio before change:  [-8.670737]
curr_Stock_Price:  100.43299173273928
curr_Factors:  [100.43299173]
mat_Sqrt:  [[0.15]]
grads:  [0.06510996]
Stock Position:  0.06510995670333525
Bond Position:  [-15.20992474]


portfolio before change:  [-8.74273583]
curr_Stock_Price:  99.35639030530776
curr_Factors:  [99.35639031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574915]
Stock Position:  -0.01574914980741887
Bond Position:  [-7.17795715]


portfolio before change:  [-8.74001531]
curr_Stock_Price:  99.12667522225428
curr_Factors:  [99.12667522]
mat_Sqrt:  [[0.15]]
grads:  [0.03125937]
Stock Position:  0.03125937401254006
Bond Position:  [-11.83865313]


portfolio before change:  [-8.71432382]
curr_Stock_Price:  99.9958998296242
curr_Factors:  [99.99589983]
mat_Sqrt:  [[0.15]]
grads:  [0.10530419]
Stock Position:  0.10530418813116635
Bond Position:  [-19.24431087]


portfolio before change:  [-8.70187746]
curr_Stock_Price:  100.13693935466225
curr_Factors:  [100.13693935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01378685]
Stock Position:  -0.013786848133954845
Bond Position:  [-7.32130468]


portfolio before change:  [-8.69802551]
curr_Stock_Price:  99.79116294726568
curr_Factors:  [99.79116295]
mat_Sqrt:  [[0.15]]
grads:  [0.15234946]
Stock Position:  0.1523494628755044
Bond Position:  [-23.90115559]


portfolio before change:  [-8.61095356]
curr_Stock_Price:  100.38230243491999
curr_Factors:  [100.38230243]
mat_Sqrt:  [[0.15]]
grads:  [-0.03930212]
Stock Position:  -0.039302123653499846
Bond Position:  [-4.6657159]


portfolio before change:  [-8.58885591]
curr_Stock_Price:  99.80521157870629
curr_Factors:  [99.80521158]
mat_Sqrt:  [[0.15]]
grads:  [0.02360002]
Stock Position:  0.02360001684983756
Bond Position:  [-10.94426059]


portfolio before change:  [-8.61253532]
curr_Stock_Price:  98.85981864355689
curr_Factors:  [98.85981864]
mat_Sqrt:  [[0.15]]
grads:  [0.00954455]
Stock Position:  0.009544552764260623
Bond Position:  [-9.55610808]


portfolio before change:  [-8.60978393]
curr_Stock_Price:  99.27324590178381
curr_Factors:  [99.2732459]
mat_Sqrt:  [[0.15]]
grads:  [0.03801801]
Stock Position:  0.03801801294242883
Bond Position:  [-12.38395548]


portfolio before change:  [-8.64098329]
curr_Stock_Price:  98.4933191695324
curr_Factors:  [98.49331917]
mat_Sqrt:  [[0.15]]
grads:  [0.09252341]
Stock Position:  0.0925234134364673
Bond Position:  [-17.75392138]


portfolio before change:  [-8.68752291]
curr_Stock_Price:  98.01430258574989
curr_Factors:  [98.01430259]
mat_Sqrt:  [[0.15]]
grads:  [0.01615068]
Stock Position:  0.016150676648053575
Bond Position:  [-10.27052022]


portfolio before change:  [-8.69654237]
curr_Stock_Price:  97.53534087505042
curr_Factors:  [97.53534088]
mat_Sqrt:  [[0.15]]
grads:  [0.00460747]
Stock Position:  0.004607472934750542
Bond Position:  [-9.14593381]


portfolio before change:  [-8.68952387]
curr_Stock_Price:  99.30676890521119
curr_Factors:  [99.30676891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025339]
Stock Position:  -0.020253386656958108
Bond Position:  [-6.67822548]


portfolio before change:  [-8.6955382]
curr_Stock_Price:  99.56250390540363
curr_Factors:  [99.56250391]
mat_Sqrt:  [[0.15]]
grads:  [0.07012911]
Stock Position:  0.07012911132576256
Bond Position:  [-15.67776812]


portfolio before change:  [-8.68822893]
curr_Stock_Price:  99.69467612495066
curr_Factors:  [99.69467612]
mat_Sqrt:  [[0.15]]
grads:  [0.02798612]
Stock Position:  0.027986115948796728
Bond Position:  [-11.47829569]


portfolio before change:  [-8.69184328]
curr_Stock_Price:  99.61679883211902
curr_Factors:  [99.61679883]
mat_Sqrt:  [[0.15]]
grads:  [0.07531575]
Stock Position:  0.07531574573587252
Bond Position:  [-16.19455678]


portfolio before change:  [-8.70333473]
curr_Stock_Price:  99.49110132570405
curr_Factors:  [99.49110133]
mat_Sqrt:  [[0.15]]
grads:  [-0.08045858]
Stock Position:  -0.0804585807211995
Bond Position:  [-0.69842193]


portfolio before change:  [-8.80953653]
curr_Stock_Price:  100.80997229755764
curr_Factors:  [100.8099723]
mat_Sqrt:  [[0.15]]
grads:  [-0.11580342]
Stock Position:  -0.11580342427359006
Bond Position:  [2.86460347]


portfolio before change:  [-8.88527388]
curr_Stock_Price:  101.46708115395472
curr_Factors:  [101.46708115]
mat_Sqrt:  [[0.15]]
grads:  [0.14155061]
Stock Position:  0.14155061148510006
Bond Position:  [-23.24800127]


portfolio before change:  [-9.07016317]
curr_Stock_Price:  100.18144132946051
curr_Factors:  [100.18144133]
mat_Sqrt:  [[0.15]]
grads:  [0.02680883]
Stock Position:  0.026808830884540065
Bond Position:  [-11.75591049]


portfolio before change:  [-9.10217889]
curr_Stock_Price:  99.04203558598806
curr_Factors:  [99.04203559]
mat_Sqrt:  [[0.15]]
grads:  [0.03372489]
Stock Position:  0.0337248870807028
Bond Position:  [-12.44236035]


portfolio before change:  [-9.13429623]
curr_Stock_Price:  98.13582203760684
curr_Factors:  [98.13582204]
mat_Sqrt:  [[0.15]]
grads:  [0.10372251]
Stock Position:  0.10372251009516545
Bond Position:  [-19.31319002]


portfolio before change:  [-9.01599829]
curr_Stock_Price:  99.29962189685877
curr_Factors:  [99.2996219]
mat_Sqrt:  [[0.15]]
grads:  [-0.0736745]
Stock Position:  -0.07367449534193658
Bond Position:  [-1.70014875]


portfolio before change:  [-9.07019514]
curr_Stock_Price:  100.03236282829178
curr_Factors:  [100.03236283]
mat_Sqrt:  [[0.15]]
grads:  [0.02875464]
Stock Position:  0.02875464419695341
Bond Position:  [-11.94659014]


portfolio before change:  [-9.05978106]
curr_Stock_Price:  100.44646971089576
curr_Factors:  [100.44646971]
mat_Sqrt:  [[0.15]]
grads:  [-0.07606051]
Stock Position:  -0.07606051097161645
Bond Position:  [-1.41977125]


portfolio before change:  [-9.00556466]
curr_Stock_Price:  99.7313301163511
curr_Factors:  [99.73133012]
mat_Sqrt:  [[0.15]]
grads:  [-0.11912225]
Stock Position:  -0.11912225055809772
Bond Position:  [2.87465584]


portfolio before change:  [-9.11940318]
curr_Stock_Price:  100.68999131868068
curr_Factors:  [100.68999132]
mat_Sqrt:  [[0.15]]
grads:  [-0.05711882]
Stock Position:  -0.05711881871533229
Bond Position:  [-3.36810982]


portfolio before change:  [-9.12774527]
curr_Stock_Price:  100.82866795615698
curr_Factors:  [100.82866796]
mat_Sqrt:  [[0.15]]
grads:  [-0.0116376]
Stock Position:  -0.011637597213050866
Bond Position:  [-7.95434184]


portfolio before change:  [-9.13735773]
curr_Stock_Price:  101.56920805749095
curr_Factors:  [101.56920806]
mat_Sqrt:  [[0.15]]
grads:  [0.0344038]
Stock Position:  0.03440380135656603
Bond Position:  [-12.63172459]


portfolio before change:  [-9.14156391]
curr_Stock_Price:  101.4928468352285
curr_Factors:  [101.49284684]
mat_Sqrt:  [[0.15]]
grads:  [0.03418365]
Stock Position:  0.03418365038231305
Bond Position:  [-12.6109599]


portfolio before change:  [-9.12397553]
curr_Stock_Price:  102.05349066047141
curr_Factors:  [102.05349066]
mat_Sqrt:  [[0.15]]
grads:  [-0.0376016]
Stock Position:  -0.037601603848803414
Bond Position:  [-5.2866006]


portfolio before change:  [-9.17614087]
curr_Stock_Price:  103.42323224975304
curr_Factors:  [103.42323225]
mat_Sqrt:  [[0.15]]
grads:  [0.05777181]
Stock Position:  0.05777180535283607
Bond Position:  [-15.15108772]


portfolio before change:  [-9.20077368]
curr_Stock_Price:  103.02963533669381
curr_Factors:  [103.02963534]
mat_Sqrt:  [[0.15]]
grads:  [0.03513625]
Stock Position:  0.03513624544405671
Bond Position:  [-12.82084824]


portfolio before change:  [-9.18775596]
curr_Stock_Price:  103.44574194931829
curr_Factors:  [103.44574195]
mat_Sqrt:  [[0.15]]
grads:  [-0.05186864]
Stock Position:  -0.05186863844208919
Bond Position:  [-3.82216618]


portfolio before change:  [-9.19294436]
curr_Stock_Price:  103.53655970635123
curr_Factors:  [103.53655971]
mat_Sqrt:  [[0.15]]
grads:  [0.06425466]
Stock Position:  0.06425466489085095
Bond Position:  [-15.84565131]


portfolio before change:  [-9.18014248]
curr_Stock_Price:  103.76662408456065
curr_Factors:  [103.76662408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.18014248]
Stock Price:  106.02469594395708
PL:  [-15.20483842]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.63686380e-03]
 [-2.15890788e-04]
 [ 5.63792522e-03]
 [-2.30824046e-03]
 [ 6.54490841e-03]
 [-2.60216616e-02]
 [-4.92941445e-02]
 [ 2.22157180e-02]
 [-6.08403708e-03]
 [-8.27190071e-04]
 [-1.09267382e-02]
 [ 7.64642237e-03]
 [ 1.38899964e-02]
 [-2.85289694e-04]
 [-3.07050546e-03]
 [-9.52512422e-03]
 [ 2.43405477e-02]
 [-4.90064891e-02]
 [-1.95841268e-03]
 [ 8.64381166e-03]
 [ 2.83844390e-02]
 [ 9.50491042e-04]
 [ 2.82576413e-02]
 [ 2.75253362e-04]
 [ 8.73743280e-03]
 [ 1.67439859e-02]
 [ 3.03930526e-02]
 [-2.44386073e-02]
 [-4.75124506e-02]
 [ 1.99908523e-03]
 [-4.43321689e-03]
 [ 5.58819731e-03]
 [ 1.82981960e-02]
 [-1.54915129e-02]
 [ 5.36174504e-03]
 [ 3.82590489e-03]
 [ 1.03286064e-02]
 [ 7.26646501e-03]
 [-7.31465547e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.64920339]
curr_Stock_Price:  99.6386562396107
curr_Factors:  [99.63865624]
mat_Sqrt:  [[0.15]]
grads:  [0.02424576]
Stock Position:  0.024245758682628578
Bond Position:  [-6.06501821]


portfolio before change:  [-3.65143917]
curr_Stock_Price:  99.57771361099212
curr_Factors:  [99.57771361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143927]
Stock Position:  -0.0014392719193702156
Bond Position:  [-3.50811976]


portfolio before change:  [-3.65201711]
curr_Stock_Price:  99.674570420091
curr_Factors:  [99.67457042]
mat_Sqrt:  [[0.15]]
grads:  [0.03758617]
Stock Position:  0.03758616810609283
Bond Position:  [-7.39840227]


portfolio before change:  [-3.66123081]
curr_Stock_Price:  99.4540414216988
curr_Factors:  [99.45404142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01538827]
Stock Position:  -0.015388269749224595
Bond Position:  [-2.13080519]


portfolio before change:  [-3.65786902]
curr_Stock_Price:  99.2182674454007
curr_Factors:  [99.21826745]
mat_Sqrt:  [[0.15]]
grads:  [0.04363272]
Stock Position:  0.04363272272092883
Bond Position:  [-7.98703218]


portfolio before change:  [-3.70455151]
curr_Stock_Price:  98.17125395979606
curr_Factors:  [98.17125396]
mat_Sqrt:  [[0.15]]
grads:  [-0.17347774]
Stock Position:  -0.1734777441198751
Bond Position:  [13.32597616]


portfolio before change:  [-3.63192469]
curr_Stock_Price:  97.76220452229526
curr_Factors:  [97.76220452]
mat_Sqrt:  [[0.15]]
grads:  [-0.32862763]
Stock Position:  -0.32862762993028627
Bond Position:  [28.49543688]


portfolio before change:  [-3.98181928]
curr_Stock_Price:  98.8377584723433
curr_Factors:  [98.83775847]
mat_Sqrt:  [[0.15]]
grads:  [0.14810479]
Stock Position:  0.14810478677433556
Bond Position:  [-18.62016443]


portfolio before change:  [-4.123858]
curr_Stock_Price:  97.89443275985418
curr_Factors:  [97.89443276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04056025]
Stock Position:  -0.04056024718326705
Bond Position:  [-0.15323561]


portfolio before change:  [-4.11063023]
curr_Stock_Price:  97.56783389863425
curr_Factors:  [97.5678339]
mat_Sqrt:  [[0.15]]
grads:  [-0.0055146]
Stock Position:  -0.005514600472884922
Bond Position:  [-3.5725826]


portfolio before change:  [-4.10453091]
curr_Stock_Price:  96.38081771618336
curr_Factors:  [96.38081772]
mat_Sqrt:  [[0.15]]
grads:  [-0.07284492]
Stock Position:  -0.07284492119067894
Bond Position:  [2.91632216]


portfolio before change:  [-4.06492066]
curr_Stock_Price:  95.84206110621521
curr_Factors:  [95.84206111]
mat_Sqrt:  [[0.15]]
grads:  [0.05097615]
Stock Position:  0.050976149112885234
Bond Position:  [-8.95057986]


portfolio before change:  [-4.0321678]
curr_Stock_Price:  96.50652400132255
curr_Factors:  [96.506524]
mat_Sqrt:  [[0.15]]
grads:  [0.09259998]
Stock Position:  0.09259997572984442
Bond Position:  [-12.96866958]


portfolio before change:  [-4.07399381]
curr_Stock_Price:  96.07234644242494
curr_Factors:  [96.07234644]
mat_Sqrt:  [[0.15]]
grads:  [-0.00190193]
Stock Position:  -0.0019019312942925143
Bond Position:  [-3.89127081]


portfolio before change:  [-4.07512734]
curr_Stock_Price:  96.41257580647448
curr_Factors:  [96.41257581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02047004]
Stock Position:  -0.02047003640212491
Bond Position:  [-2.10155841]


portfolio before change:  [-4.05315898]
curr_Stock_Price:  95.32654582811047
curr_Factors:  [95.32654583]
mat_Sqrt:  [[0.15]]
grads:  [-0.06350083]
Stock Position:  -0.06350082810871137
Bond Position:  [2.00015562]


portfolio before change:  [-3.97980196]
curr_Stock_Price:  94.17526979037949
curr_Factors:  [94.17526979]
mat_Sqrt:  [[0.15]]
grads:  [0.16227032]
Stock Position:  0.16227031832596822
Bond Position:  [-19.26165297]


portfolio before change:  [-4.07979488]
curr_Stock_Price:  93.57389637215238
curr_Factors:  [93.57389637]
mat_Sqrt:  [[0.15]]
grads:  [-0.32670993]
Stock Position:  -0.326709927640626
Bond Position:  [26.49172603]


portfolio before change:  [-3.94549725]
curr_Stock_Price:  93.17297204075766
curr_Factors:  [93.17297204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01305608]
Stock Position:  -0.013056084541543193
Bond Position:  [-2.72902305]


portfolio before change:  [-3.95870515]
curr_Stock_Price:  94.15847099971225
curr_Factors:  [94.158471]
mat_Sqrt:  [[0.15]]
grads:  [0.05762541]
Stock Position:  0.057625411080729244
Bond Position:  [-9.38462575]


portfolio before change:  [-3.98235151]
curr_Stock_Price:  93.7684832527245
curr_Factors:  [93.76848325]
mat_Sqrt:  [[0.15]]
grads:  [0.18922959]
Stock Position:  0.18922959310877882
Bond Position:  [-21.72612344]


portfolio before change:  [-3.94005954]
curr_Stock_Price:  94.00633137538486
curr_Factors:  [94.00633138]
mat_Sqrt:  [[0.15]]
grads:  [0.00633661]
Stock Position:  0.0063366069487846965
Bond Position:  [-4.53574071]


portfolio before change:  [-3.93595208]
curr_Stock_Price:  94.7440226421481
curr_Factors:  [94.74402264]
mat_Sqrt:  [[0.15]]
grads:  [0.18838428]
Stock Position:  0.1883842756222984
Bond Position:  [-21.78423616]


portfolio before change:  [-4.03403171]
curr_Stock_Price:  94.23784222790255
curr_Factors:  [94.23784223]
mat_Sqrt:  [[0.15]]
grads:  [0.00183502]
Stock Position:  0.0018350224100670796
Bond Position:  [-4.20696027]


portfolio before change:  [-4.03620522]
curr_Stock_Price:  93.33997634843082
curr_Factors:  [93.33997635]
mat_Sqrt:  [[0.15]]
grads:  [0.05824955]
Stock Position:  0.05824955199977183
Bond Position:  [-9.47321703]


portfolio before change:  [-4.01738501]
curr_Stock_Price:  93.6834027525628
curr_Factors:  [93.68340275]
mat_Sqrt:  [[0.15]]
grads:  [0.11162657]
Stock Position:  0.11162657254652773
Bond Position:  [-14.47494217]


portfolio before change:  [-3.95390632]
curr_Stock_Price:  94.26828293590874
curr_Factors:  [94.26828294]
mat_Sqrt:  [[0.15]]
grads:  [0.20262035]
Stock Position:  0.2026203505963534
Bond Position:  [-23.05457886]


portfolio before change:  [-3.90912377]
curr_Stock_Price:  94.50352365160941
curr_Factors:  [94.50352365]
mat_Sqrt:  [[0.15]]
grads:  [-0.16292405]
Stock Position:  -0.16292404872882774
Bond Position:  [11.48777292]


portfolio before change:  [-3.94980294]
curr_Stock_Price:  94.76201974069767
curr_Factors:  [94.76201974]
mat_Sqrt:  [[0.15]]
grads:  [-0.31674967]
Stock Position:  -0.3167496709829345
Bond Position:  [26.06603564]


portfolio before change:  [-3.88903426]
curr_Stock_Price:  94.58045612063452
curr_Factors:  [94.58045612]
mat_Sqrt:  [[0.15]]
grads:  [0.01332723]
Stock Position:  0.013327234869232405
Bond Position:  [-5.14953022]


portfolio before change:  [-3.89790591]
curr_Stock_Price:  93.96308013428138
curr_Factors:  [93.96308013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02955478]
Stock Position:  -0.029554779299014903
Bond Position:  [-1.12084781]


portfolio before change:  [-3.87807061]
curr_Stock_Price:  93.28720264978304
curr_Factors:  [93.28720265]
mat_Sqrt:  [[0.15]]
grads:  [0.03725465]
Stock Position:  0.03725464871112264
Bond Position:  [-7.35345258]


portfolio before change:  [-3.86766279]
curr_Stock_Price:  93.5912468576852
curr_Factors:  [93.59124686]
mat_Sqrt:  [[0.15]]
grads:  [0.12198797]
Stock Position:  0.12198797361744843
Bond Position:  [-15.28466935]


portfolio before change:  [-4.00597157]
curr_Stock_Price:  92.47311967695863
curr_Factors:  [92.47311968]
mat_Sqrt:  [[0.15]]
grads:  [-0.10327675]
Stock Position:  -0.10327675267789999
Bond Position:  [5.54435195]


portfolio before change:  [-3.96538904]
curr_Stock_Price:  92.08688137436226
curr_Factors:  [92.08688137]
mat_Sqrt:  [[0.15]]
grads:  [0.03574497]
Stock Position:  0.03574496694307951
Bond Position:  [-7.25703157]


portfolio before change:  [-3.96662573]
curr_Stock_Price:  92.0776630673742
curr_Factors:  [92.07766307]
mat_Sqrt:  [[0.15]]
grads:  [0.02550603]
Stock Position:  0.02550603261627089
Bond Position:  [-6.31516161]


portfolio before change:  [-3.98457094]
curr_Stock_Price:  91.40504712919312
curr_Factors:  [91.40504713]
mat_Sqrt:  [[0.15]]
grads:  [0.06885738]
Stock Position:  0.06885737620180181
Bond Position:  [-10.27848266]


portfolio before change:  [-3.95724337]
curr_Stock_Price:  91.82057942408417
curr_Factors:  [91.82057942]
mat_Sqrt:  [[0.15]]
grads:  [0.0484431]
Stock Position:  0.048443100099008554
Bond Position:  [-8.40531689]


portfolio before change:  [-3.92192482]
curr_Stock_Price:  92.57134237429294
curr_Factors:  [92.57134237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.92192482]
Stock Price:  93.69727822171254
PL:  [-3.92192482]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.11356574e-03]
 [-1.18784989e-02]
 [-1.36044950e-02]
 [ 2.46791591e-03]
 [-2.97048024e-02]
 [-2.54725875e-02]
 [-3.94328804e-02]
 [ 1.62796049e-02]
 [-6.05502526e-03]
 [ 1.53698566e-03]
 [ 4.65460396e-03]
 [ 4.52468941e-03]
 [ 1.21336620e-02]
 [ 1.37092972e-03]
 [ 1.66575772e-02]
 [-1.59175755e-03]
 [ 9.66340444e-03]
 [ 1.38123997e-02]
 [ 1.16617100e-02]
 [-1.37719806e-02]
 [-8.03878169e-03]
 [ 2.38556003e-02]
 [-3.60642002e-02]
 [ 6.49546017e-03]
 [-4.32773155e-03]
 [-6.21129766e-03]
 [-9.62970539e-04]
 [-1.13345608e-02]
 [ 2.02305507e-02]
 [-9.71043509e-03]
 [ 1.62676666e-04]
 [ 4.96354754e-03]
 [ 5.37308918e-03]
 [-4.79771084e-03]
 [ 8.37219785e-03]
 [ 5.06447889e-03]
 [-7.81403175e-03]
 [ 9.83157156e-03]
 [-1.59872273e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.44093262]
curr_Stock_Price:  99.2650354408879
curr_Factors:  [99.26503544]
mat_Sqrt:  [[0.15]]
grads:  [0.0407571]
Stock Position:  0.04075710493945918
Bond Position:  [-13.48668809]


portfolio before change:  [-9.47117048]
curr_Stock_Price:  98.56449703443913
curr_Factors:  [98.56449703]
mat_Sqrt:  [[0.15]]
grads:  [-0.07918999]
Stock Position:  -0.07918999265177958
Bond Position:  [-1.66584868]


portfolio before change:  [-9.46699506]
curr_Stock_Price:  98.5091407652768
curr_Factors:  [98.50914077]
mat_Sqrt:  [[0.15]]
grads:  [-0.09069663]
Stock Position:  -0.09069663356505982
Bond Position:  [-0.53254762]


portfolio before change:  [-9.442868]
curr_Stock_Price:  98.24238733919526
curr_Factors:  [98.24238734]
mat_Sqrt:  [[0.15]]
grads:  [0.01645277]
Stock Position:  0.016452772725505556
Bond Position:  [-11.05922767]


portfolio before change:  [-9.44994067]
curr_Stock_Price:  97.89653752585336
curr_Factors:  [97.89653753]
mat_Sqrt:  [[0.15]]
grads:  [-0.19803202]
Stock Position:  -0.1980320159235154
Bond Position:  [9.936708]


portfolio before change:  [-9.52086241]
curr_Stock_Price:  98.26094276464633
curr_Factors:  [98.26094276]
mat_Sqrt:  [[0.15]]
grads:  [-0.16981725]
Stock Position:  -0.16981724999344305
Bond Position:  [7.16554067]


portfolio before change:  [-9.27308278]
curr_Stock_Price:  96.80712177641945
curr_Factors:  [96.80712178]
mat_Sqrt:  [[0.15]]
grads:  [-0.26288587]
Stock Position:  -0.2628858695447653
Bond Position:  [16.17614161]


portfolio before change:  [-9.37832725]
curr_Stock_Price:  97.21515670751792
curr_Factors:  [97.21515671]
mat_Sqrt:  [[0.15]]
grads:  [0.1085307]
Stock Position:  0.10853069913507474
Bond Position:  [-19.92915618]


portfolio before change:  [-9.29510401]
curr_Stock_Price:  98.00492908148058
curr_Factors:  [98.00492908]
mat_Sqrt:  [[0.15]]
grads:  [-0.04036684]
Stock Position:  -0.04036683506132423
Bond Position:  [-5.3389552]


portfolio before change:  [-9.31380668]
curr_Stock_Price:  98.45171322370676
curr_Factors:  [98.45171322]
mat_Sqrt:  [[0.15]]
grads:  [0.01024657]
Stock Position:  0.010246571095103742
Bond Position:  [-10.32259916]


portfolio before change:  [-9.30427761]
curr_Stock_Price:  99.50762509174758
curr_Factors:  [99.50762509]
mat_Sqrt:  [[0.15]]
grads:  [0.03103069]
Stock Position:  0.03103069307877189
Bond Position:  [-12.39206818]


portfolio before change:  [-9.29768225]
curr_Stock_Price:  99.77009000870422
curr_Factors:  [99.77009001]
mat_Sqrt:  [[0.15]]
grads:  [0.0301646]
Stock Position:  0.030164596092996643
Bond Position:  [-12.30720671]


portfolio before change:  [-9.27373498]
curr_Stock_Price:  100.6149799965934
curr_Factors:  [100.61498]
mat_Sqrt:  [[0.15]]
grads:  [0.08089108]
Stock Position:  0.08089107979403884
Bond Position:  [-17.41258935]


portfolio before change:  [-9.27484504]
curr_Stock_Price:  100.62816627036891
curr_Factors:  [100.62816627]
mat_Sqrt:  [[0.15]]
grads:  [0.00913953]
Stock Position:  0.009139531453911942
Bond Position:  [-10.19453933]


portfolio before change:  [-9.28265833]
curr_Stock_Price:  99.91271409591984
curr_Factors:  [99.9127141]
mat_Sqrt:  [[0.15]]
grads:  [0.11105051]
Stock Position:  0.11105051494758092
Bond Position:  [-20.37801668]


portfolio before change:  [-9.28839137]
curr_Stock_Price:  99.8840277898817
curr_Factors:  [99.88402779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061172]
Stock Position:  -0.010611717025938758
Bond Position:  [-8.22845033]


portfolio before change:  [-9.3031959]
curr_Stock_Price:  101.18220665775704
curr_Factors:  [101.18220666]
mat_Sqrt:  [[0.15]]
grads:  [0.0644227]
Stock Position:  0.06442269628582104
Bond Position:  [-15.82162647]


portfolio before change:  [-9.29330329]
curr_Stock_Price:  101.3664652211479
curr_Factors:  [101.36646522]
mat_Sqrt:  [[0.15]]
grads:  [0.09208266]
Stock Position:  0.09208266457353695
Bond Position:  [-18.62739751]


portfolio before change:  [-9.27358489]
curr_Stock_Price:  101.6058911312311
curr_Factors:  [101.60589113]
mat_Sqrt:  [[0.15]]
grads:  [0.07774473]
Stock Position:  0.0777447333689856
Bond Position:  [-17.1729078]


portfolio before change:  [-9.26604829]
curr_Stock_Price:  101.73044411857146
curr_Factors:  [101.73044412]
mat_Sqrt:  [[0.15]]
grads:  [-0.0918132]
Stock Position:  -0.09181320429035673
Bond Position:  [0.07414975]


portfolio before change:  [-9.31113141]
curr_Stock_Price:  102.22157590616933
curr_Factors:  [102.22157591]
mat_Sqrt:  [[0.15]]
grads:  [-0.05359188]
Stock Position:  -0.053591877908444795
Bond Position:  [-3.83288519]


portfolio before change:  [-9.31703456]
curr_Stock_Price:  102.32278554425714
curr_Factors:  [102.32278554]
mat_Sqrt:  [[0.15]]
grads:  [0.15903734]
Stock Position:  0.1590373355124526
Bond Position:  [-25.59017774]


portfolio before change:  [-9.28615689]
curr_Stock_Price:  102.53705376937513
curr_Factors:  [102.53705377]
mat_Sqrt:  [[0.15]]
grads:  [-0.240428]
Stock Position:  -0.2404280014694454
Bond Position:  [15.36662203]


portfolio before change:  [-9.42660284]
curr_Stock_Price:  103.12919321787635
curr_Factors:  [103.12919322]
mat_Sqrt:  [[0.15]]
grads:  [0.04330307]
Stock Position:  0.04330306777279107
Bond Position:  [-13.89241329]


portfolio before change:  [-9.46622418]
curr_Stock_Price:  102.25432041947212
curr_Factors:  [102.25432042]
mat_Sqrt:  [[0.15]]
grads:  [-0.02885154]
Stock Position:  -0.028851543676331172
Bond Position:  [-6.51602919]


portfolio before change:  [-9.46722247]
curr_Stock_Price:  102.26068885650872
curr_Factors:  [102.26068886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04140865]
Stock Position:  -0.04140865108257913
Bond Position:  [-5.23274529]


portfolio before change:  [-9.50083155]
curr_Stock_Price:  103.05653572656992
curr_Factors:  [103.05653573]
mat_Sqrt:  [[0.15]]
grads:  [-0.0064198]
Stock Position:  -0.0064198035964300754
Bond Position:  [-8.83922884]


portfolio before change:  [-9.4939499]
curr_Stock_Price:  101.81247519698286
curr_Factors:  [101.8124752]
mat_Sqrt:  [[0.15]]
grads:  [-0.07556374]
Stock Position:  -0.07556373886440641
Bond Position:  [-1.80061861]


portfolio before change:  [-9.51735282]
curr_Stock_Price:  102.11920726487597
curr_Factors:  [102.11920726]
mat_Sqrt:  [[0.15]]
grads:  [0.13487034]
Stock Position:  0.1348703382223739
Bond Position:  [-23.29020484]


portfolio before change:  [-9.44545523]
curr_Stock_Price:  102.67388106243175
curr_Factors:  [102.67388106]
mat_Sqrt:  [[0.15]]
grads:  [-0.06473623]
Stock Position:  -0.06473623391098107
Bond Position:  [-2.79873485]


portfolio before change:  [-9.41657794]
curr_Stock_Price:  102.222400380837
curr_Factors:  [102.22240038]
mat_Sqrt:  [[0.15]]
grads:  [0.00108451]
Stock Position:  0.001084511104954503
Bond Position:  [-9.52743926]


portfolio before change:  [-9.41701218]
curr_Stock_Price:  102.9201899098148
curr_Factors:  [102.92018991]
mat_Sqrt:  [[0.15]]
grads:  [0.03309032]
Stock Position:  0.03309031690195294
Bond Position:  [-12.82267388]


portfolio before change:  [-9.39895106]
curr_Stock_Price:  103.51444404102523
curr_Factors:  [103.51444404]
mat_Sqrt:  [[0.15]]
grads:  [0.03582059]
Stock Position:  0.035820594501064326
Bond Position:  [-13.10689998]


portfolio before change:  [-9.42934543]
curr_Stock_Price:  102.71166828049459
curr_Factors:  [102.71166828]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198474]
Stock Position:  -0.03198473894360666
Bond Position:  [-6.14413953]


portfolio before change:  [-9.4540261]
curr_Stock_Price:  103.45929385442902
curr_Factors:  [103.45929385]
mat_Sqrt:  [[0.15]]
grads:  [0.05581465]
Stock Position:  0.05581465236480401
Bond Position:  [-15.22857062]


portfolio before change:  [-9.45931134]
curr_Stock_Price:  103.39870859140794
curr_Factors:  [103.39870859]
mat_Sqrt:  [[0.15]]
grads:  [0.03376319]
Stock Position:  0.03376319261196542
Bond Position:  [-12.95038185]


portfolio before change:  [-9.45907517]
curr_Stock_Price:  103.45365208099462
curr_Factors:  [103.45365208]
mat_Sqrt:  [[0.15]]
grads:  [-0.05209354]
Stock Position:  -0.05209354499311433
Bond Position:  [-4.06980769]


portfolio before change:  [-9.48352354]
curr_Stock_Price:  103.91320266867879
curr_Factors:  [103.91320267]
mat_Sqrt:  [[0.15]]
grads:  [0.06554381]
Stock Position:  0.06554381037293124
Bond Position:  [-16.2943908]


portfolio before change:  [-9.54462183]
curr_Stock_Price:  103.01210520856232
curr_Factors:  [103.01210521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.54462183]
Stock Price:  103.31715441015245
PL:  [-12.86177624]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.14803677e-03]
 [ 4.39516697e-03]
 [ 1.04448678e-02]
 [-2.68038571e-03]
 [ 1.38554084e-02]
 [ 2.77795068e-02]
 [ 3.10682935e-02]
 [ 8.19348571e-03]
 [-7.73196887e-03]
 [-3.01605356e-03]
 [ 9.64012298e-03]
 [ 4.04221747e-03]
 [ 1.24014438e-02]
 [-2.39581185e-03]
 [ 2.00258812e-02]
 [ 8.99229002e-04]
 [ 9.78014517e-03]
 [ 1.40330304e-02]
 [ 1.15701928e-02]
 [-6.23028546e-03]
 [-1.07472863e-02]
 [ 1.12294652e-02]
 [ 9.08435678e-03]
 [ 6.23854346e-03]
 [-7.47130015e-03]
 [-6.40542844e-03]
 [-1.03348618e-03]
 [-1.11418849e-02]
 [ 3.45004172e-02]
 [-1.02542965e-02]
 [-2.64032078e-03]
 [ 5.46544422e-03]
 [ 6.58214422e-03]
 [-1.21083378e-02]
 [ 9.43131812e-03]
 [ 5.71422442e-03]
 [ 2.53425419e-03]
 [ 7.86552687e-03]
 [-1.21967881e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.02464525]
curr_Stock_Price:  100.52074758885614
curr_Factors:  [100.52074759]
mat_Sqrt:  [[0.15]]
grads:  [0.04098691]
Stock Position:  0.04098691176878605
Bond Position:  [5.90461023]


portfolio before change:  [10.00568741]
curr_Stock_Price:  100.04020491835853
curr_Factors:  [100.04020492]
mat_Sqrt:  [[0.15]]
grads:  [0.02930111]
Stock Position:  0.029301113158563402
Bond Position:  [7.07439804]


portfolio before change:  [10.02107926]
curr_Stock_Price:  100.53532241141355
curr_Factors:  [100.53532241]
mat_Sqrt:  [[0.15]]
grads:  [0.06963245]
Stock Position:  0.06963245227445353
Bond Position:  [3.02055822]


portfolio before change:  [10.02002142]
curr_Stock_Price:  100.51470803148712
curr_Factors:  [100.51470803]
mat_Sqrt:  [[0.15]]
grads:  [-0.01786924]
Stock Position:  -0.017869238053312676
Bond Position:  [11.81614267]


portfolio before change:  [9.99911552]
curr_Stock_Price:  101.76730832975912
curr_Factors:  [101.76730833]
mat_Sqrt:  [[0.15]]
grads:  [0.09236939]
Stock Position:  0.09236938901077922
Bond Position:  [0.59893143]


portfolio before change:  [10.0243199]
curr_Stock_Price:  102.03936287733896
curr_Factors:  [102.03936288]
mat_Sqrt:  [[0.15]]
grads:  [0.18519671]
Stock Position:  0.18519671201267957
Bond Position:  [-8.8730346]


portfolio before change:  [10.23144677]
curr_Stock_Price:  103.16376763941794
curr_Factors:  [103.16376764]
mat_Sqrt:  [[0.15]]
grads:  [0.20712196]
Stock Position:  0.20712195681706777
Bond Position:  [-11.13603466]


portfolio before change:  [10.09299852]
curr_Stock_Price:  102.5020504567735
curr_Factors:  [102.50205046]
mat_Sqrt:  [[0.15]]
grads:  [0.05462324]
Stock Position:  0.05462323809319965
Bond Position:  [4.49400461]


portfolio before change:  [10.03318338]
curr_Stock_Price:  101.39671635488394
curr_Factors:  [101.39671635]
mat_Sqrt:  [[0.15]]
grads:  [-0.05154646]
Stock Position:  -0.0515464591215358
Bond Position:  [15.25982507]


portfolio before change:  [9.99338765]
curr_Stock_Price:  102.20575977755882
curr_Factors:  [102.20575978]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010702]
Stock Position:  -0.020107023747266667
Bond Position:  [12.04844129]


portfolio before change:  [10.00905926]
curr_Stock_Price:  101.50125674699959
curr_Factors:  [101.50125675]
mat_Sqrt:  [[0.15]]
grads:  [0.06426749]
Stock Position:  0.06426748655005704
Bond Position:  [3.48582861]


portfolio before change:  [9.945504]
curr_Stock_Price:  100.50555865640793
curr_Factors:  [100.50555866]
mat_Sqrt:  [[0.15]]
grads:  [0.02694812]
Stock Position:  0.02694811645150369
Bond Position:  [7.2370685]


portfolio before change:  [9.95572302]
curr_Stock_Price:  100.85119787241332
curr_Factors:  [100.85119787]
mat_Sqrt:  [[0.15]]
grads:  [0.08267629]
Stock Position:  0.08267629207559744
Bond Position:  [1.61771993]


portfolio before change:  [9.9745981]
curr_Stock_Price:  101.07705292137764
curr_Factors:  [101.07705292]
mat_Sqrt:  [[0.15]]
grads:  [-0.01597208]
Stock Position:  -0.015972078981087955
Bond Position:  [11.58900877]


portfolio before change:  [9.98777915]
curr_Stock_Price:  100.3425003981083
curr_Factors:  [100.3425004]
mat_Sqrt:  [[0.15]]
grads:  [0.13350587]
Stock Position:  0.13350587481564194
Bond Position:  [-3.40853415]


portfolio before change:  [10.03378399]
curr_Stock_Price:  100.69028235699986
curr_Factors:  [100.69028236]
mat_Sqrt:  [[0.15]]
grads:  [0.00599486]
Stock Position:  0.005994860010940174
Bond Position:  [9.43015984]


portfolio before change:  [10.0375465]
curr_Stock_Price:  101.12126275862249
curr_Factors:  [101.12126276]
mat_Sqrt:  [[0.15]]
grads:  [0.06520097]
Stock Position:  0.06520096778051633
Bond Position:  [3.44434231]


portfolio before change:  [10.04117691]
curr_Stock_Price:  101.17033931875375
curr_Factors:  [101.17033932]
mat_Sqrt:  [[0.15]]
grads:  [0.09355354]
Stock Position:  0.09355353590149182
Bond Position:  [0.57633394]


portfolio before change:  [9.94119372]
curr_Stock_Price:  100.10084222075817
curr_Factors:  [100.10084222]
mat_Sqrt:  [[0.15]]
grads:  [0.07713462]
Stock Position:  0.07713461881679008
Bond Position:  [2.21995341]


portfolio before change:  [9.79700172]
curr_Stock_Price:  98.22788925607196
curr_Factors:  [98.22788926]
mat_Sqrt:  [[0.15]]
grads:  [-0.04153524]
Stock Position:  -0.041535236410693635
Bond Position:  [13.87692032]


portfolio before change:  [9.71598065]
curr_Stock_Price:  100.22031315522081
curr_Factors:  [100.22031316]
mat_Sqrt:  [[0.15]]
grads:  [-0.07164858]
Stock Position:  -0.07164857523069566
Bond Position:  [16.89662329]


portfolio before change:  [9.76248345]
curr_Stock_Price:  99.6007531151831
curr_Factors:  [99.60075312]
mat_Sqrt:  [[0.15]]
grads:  [0.0748631]
Stock Position:  0.07486310165069118
Bond Position:  [2.30606215]


portfolio before change:  [9.79105648]
curr_Stock_Price:  99.9785727646117
curr_Factors:  [99.97857276]
mat_Sqrt:  [[0.15]]
grads:  [0.06056238]
Stock Position:  0.060562378506037025
Bond Position:  [3.73611631]


portfolio before change:  [9.84320896]
curr_Stock_Price:  100.83199754907902
curr_Factors:  [100.83199755]
mat_Sqrt:  [[0.15]]
grads:  [0.04159029]
Stock Position:  0.04159028971508868
Bond Position:  [5.64957696]


portfolio before change:  [9.87927732]
curr_Stock_Price:  101.68224707147284
curr_Factors:  [101.68224707]
mat_Sqrt:  [[0.15]]
grads:  [-0.04980867]
Stock Position:  -0.04980866767117292
Bond Position:  [14.94393457]


portfolio before change:  [9.86694524]
curr_Stock_Price:  101.9673418906585
curr_Factors:  [101.96734189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270286]
Stock Position:  -0.04270285623669767
Bond Position:  [14.22124198]


portfolio before change:  [9.84733421]
curr_Stock_Price:  102.46821680402637
curr_Factors:  [102.4682168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00688991]
Stock Position:  -0.006889907852277003
Bond Position:  [10.55333078]


portfolio before change:  [9.85047239]
curr_Stock_Price:  102.20421735048387
curr_Factors:  [102.20421735]
mat_Sqrt:  [[0.15]]
grads:  [-0.07427923]
Stock Position:  -0.07427923266630036
Bond Position:  [17.44212323]


portfolio before change:  [9.82785293]
curr_Stock_Price:  102.53809081268875
curr_Factors:  [102.53809081]
mat_Sqrt:  [[0.15]]
grads:  [0.23000278]
Stock Position:  0.23000278132310065
Bond Position:  [-13.75619315]


portfolio before change:  [9.59293187]
curr_Stock_Price:  101.52418381637604
curr_Factors:  [101.52418382]
mat_Sqrt:  [[0.15]]
grads:  [-0.06836198]
Stock Position:  -0.06836197639886372
Bond Position:  [16.53332573]


portfolio before change:  [9.68636606]
curr_Stock_Price:  100.18766020307008
curr_Factors:  [100.1876602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01760214]
Stock Position:  -0.017602138535041056
Bond Position:  [11.44988314]


portfolio before change:  [9.69541729]
curr_Stock_Price:  99.7547639179633
curr_Factors:  [99.75476392]
mat_Sqrt:  [[0.15]]
grads:  [0.03643629]
Stock Position:  0.03643629477365095
Bond Position:  [6.0607233]


portfolio before change:  [9.66758848]
curr_Stock_Price:  98.97020446074649
curr_Factors:  [98.97020446]
mat_Sqrt:  [[0.15]]
grads:  [0.04388096]
Stock Position:  0.043880961467758814
Bond Position:  [5.32468076]


portfolio before change:  [9.66884912]
curr_Stock_Price:  98.983764004924
curr_Factors:  [98.983764]
mat_Sqrt:  [[0.15]]
grads:  [-0.08072225]
Stock Position:  -0.08072225217751448
Bond Position:  [17.65904148]


portfolio before change:  [9.68211435]
curr_Stock_Price:  98.84677923196723
curr_Factors:  [98.84677923]
mat_Sqrt:  [[0.15]]
grads:  [0.06287545]
Stock Position:  0.06287545410712177
Bond Position:  [3.46707822]


portfolio before change:  [9.66223347]
curr_Stock_Price:  98.52369135063515
curr_Factors:  [98.52369135]
mat_Sqrt:  [[0.15]]
grads:  [0.03809483]
Stock Position:  0.0380948294891573
Bond Position:  [5.90899025]


portfolio before change:  [9.71123695]
curr_Stock_Price:  99.79065623351765
curr_Factors:  [99.79065623]
mat_Sqrt:  [[0.15]]
grads:  [0.01689503]
Stock Position:  0.016895027913362635
Bond Position:  [8.02527103]


portfolio before change:  [9.72919553]
curr_Stock_Price:  100.79422704067818
curr_Factors:  [100.79422704]
mat_Sqrt:  [[0.15]]
grads:  [0.05243685]
Stock Position:  0.052436845768661436
Bond Position:  [4.44386419]


portfolio before change:  [9.75577724]
curr_Stock_Price:  101.2905610477391
curr_Factors:  [101.29056105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.75577724]
Stock Price:  102.2662307526749
PL:  [7.48954648]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.68394983e-03]
 [ 4.13210366e-03]
 [ 4.93445508e-03]
 [-2.72827792e-03]
 [ 1.46829684e-02]
 [ 2.67136455e-02]
 [ 1.33981620e-02]
 [ 1.33791018e-02]
 [-6.85706479e-03]
 [-3.01717128e-03]
 [ 1.11782100e-02]
 [ 7.34972870e-03]
 [ 2.76637057e-03]
 [-4.02525050e-03]
 [ 6.71985636e-03]
 [ 3.05866830e-03]
 [ 8.75194925e-03]
 [ 1.09356807e-02]
 [ 1.15640586e-02]
 [-1.53107428e-02]
 [ 2.50396272e-04]
 [ 2.32634978e-02]
 [-2.56889997e-02]
 [ 5.70465438e-03]
 [-6.97384528e-03]
 [-6.26300407e-03]
 [-1.09431800e-03]
 [-1.12433014e-02]
 [-1.84284598e-02]
 [-7.46153460e-03]
 [-1.32969203e-03]
 [ 5.06831651e-03]
 [ 5.37619104e-03]
 [-5.00204879e-03]
 [ 1.96720947e-02]
 [ 5.54189008e-03]
 [ 3.13321521e-05]
 [ 7.81474798e-03]
 [-6.79392558e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.13378658]
curr_Stock_Price:  101.17288191886247
curr_Factors:  [101.17288192]
mat_Sqrt:  [[0.15]]
grads:  [0.05122633]
Stock Position:  0.051226332219059784
Bond Position:  [14.95107092]


portfolio before change:  [20.10034634]
curr_Stock_Price:  100.48360280104605
curr_Factors:  [100.4836028]
mat_Sqrt:  [[0.15]]
grads:  [0.02754736]
Stock Position:  0.02754735776109361
Bond Position:  [17.33228859]


portfolio before change:  [20.07777172]
curr_Stock_Price:  99.5854662614647
curr_Factors:  [99.58546626]
mat_Sqrt:  [[0.15]]
grads:  [0.03289637]
Stock Position:  0.03289636722157842
Bond Position:  [16.80177166]


portfolio before change:  [20.10690232]
curr_Stock_Price:  100.40714488407797
curr_Factors:  [100.40714488]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818852]
Stock Position:  -0.01818851947249716
Bond Position:  [21.93315963]


portfolio before change:  [20.09469341]
curr_Stock_Price:  101.22913202706876
curr_Factors:  [101.22913203]
mat_Sqrt:  [[0.15]]
grads:  [0.09788646]
Stock Position:  0.09788645584947174
Bond Position:  [10.18573244]


portfolio before change:  [20.13814659]
curr_Stock_Price:  101.66003835776566
curr_Factors:  [101.66003836]
mat_Sqrt:  [[0.15]]
grads:  [0.17809097]
Stock Position:  0.17809097024880285
Bond Position:  [2.03341173]


portfolio before change:  [20.23903383]
curr_Stock_Price:  102.2251037195025
curr_Factors:  [102.22510372]
mat_Sqrt:  [[0.15]]
grads:  [0.08932108]
Stock Position:  0.0893210801752078
Bond Position:  [11.10817714]


portfolio before change:  [20.15686785]
curr_Stock_Price:  101.28966289135498
curr_Factors:  [101.28966289]
mat_Sqrt:  [[0.15]]
grads:  [0.08919401]
Stock Position:  0.08919401197982187
Bond Position:  [11.12243644]


portfolio before change:  [20.13104232]
curr_Stock_Price:  100.9845311553818
curr_Factors:  [100.98453116]
mat_Sqrt:  [[0.15]]
grads:  [-0.04571377]
Stock Position:  -0.04571376529754525
Bond Position:  [24.74742547]


portfolio before change:  [20.07550398]
curr_Stock_Price:  102.2671197760063
curr_Factors:  [102.26711978]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011448]
Stock Position:  -0.020114475170362106
Bond Position:  [22.13255343]


portfolio before change:  [20.08599832]
curr_Stock_Price:  101.8829391216785
curr_Factors:  [101.88293912]
mat_Sqrt:  [[0.15]]
grads:  [0.0745214]
Stock Position:  0.07452139968684822
Bond Position:  [12.49353909]


portfolio before change:  [20.17336673]
curr_Stock_Price:  103.03437518137562
curr_Factors:  [103.03437518]
mat_Sqrt:  [[0.15]]
grads:  [0.04899819]
Stock Position:  0.04899819136407841
Bond Position:  [15.1248687]


portfolio before change:  [20.21652106]
curr_Stock_Price:  103.8765205721097
curr_Factors:  [103.87652057]
mat_Sqrt:  [[0.15]]
grads:  [0.01844247]
Stock Position:  0.018442470486299663
Bond Position:  [18.3007814]


portfolio before change:  [20.21669222]
curr_Stock_Price:  103.76175369430041
curr_Factors:  [103.76175369]
mat_Sqrt:  [[0.15]]
grads:  [-0.026835]
Stock Position:  -0.026835003361961714
Bond Position:  [23.00113923]


portfolio before change:  [20.23093581]
curr_Stock_Price:  103.33811770076801
curr_Factors:  [103.3381177]
mat_Sqrt:  [[0.15]]
grads:  [0.04479904]
Stock Position:  0.04479904238397613
Bond Position:  [15.6014871]


portfolio before change:  [20.2446959]
curr_Stock_Price:  103.60173449243115
curr_Factors:  [103.60173449]
mat_Sqrt:  [[0.15]]
grads:  [0.02039112]
Stock Position:  0.020391121984218684
Bond Position:  [18.1321403]


portfolio before change:  [20.22223896]
curr_Stock_Price:  102.38926560292975
curr_Factors:  [102.3892656]
mat_Sqrt:  [[0.15]]
grads:  [0.05834633]
Stock Position:  0.05834632830113702
Bond Position:  [14.24820125]


portfolio before change:  [20.23468864]
curr_Stock_Price:  102.57211415628966
curr_Factors:  [102.57211416]
mat_Sqrt:  [[0.15]]
grads:  [0.07290454]
Stock Position:  0.07290453830665754
Bond Position:  [12.75671601]


portfolio before change:  [20.17999587]
curr_Stock_Price:  101.80004341828663
curr_Factors:  [101.80004342]
mat_Sqrt:  [[0.15]]
grads:  [0.07709372]
Stock Position:  0.07709372416457798
Bond Position:  [12.3318514]


portfolio before change:  [20.28596388]
curr_Stock_Price:  103.15458215801686
curr_Factors:  [103.15458216]
mat_Sqrt:  [[0.15]]
grads:  [-0.10207162]
Stock Position:  -0.10207161850504468
Bond Position:  [30.81511904]


portfolio before change:  [20.31142817]
curr_Stock_Price:  102.94284688076469
curr_Factors:  [102.94284688]
mat_Sqrt:  [[0.15]]
grads:  [0.00166931]
Stock Position:  0.001669308477702247
Bond Position:  [20.13958481]


portfolio before change:  [20.31274007]
curr_Stock_Price:  102.2205669551057
curr_Factors:  [102.22056696]
mat_Sqrt:  [[0.15]]
grads:  [0.15508999]
Stock Position:  0.15508998512792985
Bond Position:  [4.45935386]


portfolio before change:  [20.21916579]
curr_Stock_Price:  101.61361780033391
curr_Factors:  [101.6136178]
mat_Sqrt:  [[0.15]]
grads:  [-0.17126]
Stock Position:  -0.17125999768998906
Bond Position:  [37.62151374]


portfolio before change:  [20.23742544]
curr_Stock_Price:  101.53445938326892
curr_Factors:  [101.53445938]
mat_Sqrt:  [[0.15]]
grads:  [0.03803103]
Stock Position:  0.038031029180523236
Bond Position:  [16.37596545]


portfolio before change:  [20.2530942]
curr_Stock_Price:  101.89263104191092
curr_Factors:  [101.89263104]
mat_Sqrt:  [[0.15]]
grads:  [-0.0464923]
Stock Position:  -0.0464923018452317
Bond Position:  [24.99031716]


portfolio before change:  [20.24628041]
curr_Stock_Price:  102.10638200345298
curr_Factors:  [102.106382]
mat_Sqrt:  [[0.15]]
grads:  [-0.04175336]
Stock Position:  -0.04175336045521046
Bond Position:  [24.50956499]


portfolio before change:  [20.25542739]
curr_Stock_Price:  101.9606908793505
curr_Factors:  [101.96069088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729545]
Stock Position:  -0.00729545336169431
Bond Position:  [20.99927686]


portfolio before change:  [20.26332193]
curr_Stock_Price:  101.23839713004452
curr_Factors:  [101.23839713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07495534]
Stock Position:  -0.07495534263256681
Bond Position:  [27.85168067]


portfolio before change:  [20.29236358]
curr_Stock_Price:  100.89739446190379
curr_Factors:  [100.89739446]
mat_Sqrt:  [[0.15]]
grads:  [-0.1228564]
Stock Position:  -0.1228563988783137
Bond Position:  [32.68825412]


portfolio before change:  [20.35708977]
curr_Stock_Price:  100.40381084852078
curr_Factors:  [100.40381085]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974356]
Stock Position:  -0.049743564024454956
Bond Position:  [25.35153316]


portfolio before change:  [20.32562148]
curr_Stock_Price:  101.10013075240454
curr_Factors:  [101.10013075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00886461]
Stock Position:  -0.008864613562415745
Bond Position:  [21.22183507]


portfolio before change:  [20.31692543]
curr_Stock_Price:  102.38038270519455
curr_Factors:  [102.38038271]
mat_Sqrt:  [[0.15]]
grads:  [0.03378878]
Stock Position:  0.033788776759968386
Bond Position:  [16.85761754]


portfolio before change:  [20.35758931]
curr_Stock_Price:  103.5214876554948
curr_Factors:  [103.52148766]
mat_Sqrt:  [[0.15]]
grads:  [0.03584127]
Stock Position:  0.035841273602744805
Bond Position:  [16.64724734]


portfolio before change:  [20.32510565]
curr_Stock_Price:  102.55710521250464
curr_Factors:  [102.55710521]
mat_Sqrt:  [[0.15]]
grads:  [-0.03334699]
Stock Position:  -0.03334699191389331
Bond Position:  [23.74507661]


portfolio before change:  [20.35571076]
curr_Stock_Price:  101.72834118774057
curr_Factors:  [101.72834119]
mat_Sqrt:  [[0.15]]
grads:  [0.1311473]
Stock Position:  0.13114729767315278
Bond Position:  [7.01431371]


portfolio before change:  [20.18045797]
curr_Stock_Price:  100.38535028961132
curr_Factors:  [100.38535029]
mat_Sqrt:  [[0.15]]
grads:  [0.03694593]
Stock Position:  0.03694593386291171
Bond Position:  [16.47162746]


portfolio before change:  [20.23219902]
curr_Stock_Price:  101.73007115737592
curr_Factors:  [101.73007116]
mat_Sqrt:  [[0.15]]
grads:  [0.00020888]
Stock Position:  0.00020888101421810923
Bond Position:  [20.21094954]


portfolio before change:  [20.23459694]
curr_Stock_Price:  101.11438201828709
curr_Factors:  [101.11438202]
mat_Sqrt:  [[0.15]]
grads:  [0.05209832]
Stock Position:  0.0520983198473476
Bond Position:  [14.96670753]


portfolio before change:  [20.18961949]
curr_Stock_Price:  100.21515132390063
curr_Factors:  [100.21515132]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.18961949]
Stock Price:  100.8976977470358
PL:  [19.29192174]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.14504869e-02]
 [-6.39884568e-03]
 [ 1.52608651e-02]
 [ 1.25950314e-02]
 [ 5.89711143e-03]
 [ 3.28927730e-02]
 [ 3.72114023e-02]
 [ 5.47734827e-03]
 [-1.04041879e-02]
 [-3.02863561e-03]
 [ 1.35440489e-02]
 [ 5.71375930e-03]
 [ 7.46890256e-03]
 [-5.22189588e-03]
 [ 1.15467767e-02]
 [ 3.45079575e-03]
 [ 9.17133975e-03]
 [-2.34211326e-03]
 [ 1.19157510e-02]
 [-1.76189207e-02]
 [ 7.04322992e-03]
 [ 3.77245133e-02]
 [-3.57002850e-02]
 [ 7.64561067e-03]
 [-5.30409329e-03]
 [-6.28780649e-03]
 [-1.07175351e-03]
 [-1.10679013e-02]
 [ 7.49223550e-03]
 [-1.02664948e-02]
 [-1.04071578e-04]
 [ 5.08605821e-03]
 [ 5.14352669e-03]
 [-6.22653250e-03]
 [ 1.24010409e-02]
 [ 5.25987546e-03]
 [-8.69749831e-03]
 [ 1.00572925e-02]
 [-7.74450458e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.43869897]
curr_Stock_Price:  101.77313594666253
curr_Factors:  [101.77313595]
mat_Sqrt:  [[0.15]]
grads:  [0.07633658]
Stock Position:  0.07633657903322022
Bond Position:  [21.66968593]


portfolio before change:  [29.46707542]
curr_Stock_Price:  102.10937808951506
curr_Factors:  [102.10937809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265897]
Stock Position:  -0.04265897117994028
Bond Position:  [33.82295644]


portfolio before change:  [29.50300922]
curr_Stock_Price:  101.36614262008224
curr_Factors:  [101.36614262]
mat_Sqrt:  [[0.15]]
grads:  [0.1017391]
Stock Position:  0.10173910056368833
Bond Position:  [19.19010904]


portfolio before change:  [29.61376]
curr_Stock_Price:  102.43113993272638
curr_Factors:  [102.43113993]
mat_Sqrt:  [[0.15]]
grads:  [0.08396688]
Stock Position:  0.08396687572744573
Bond Position:  [21.0129372]


portfolio before change:  [29.60597024]
curr_Stock_Price:  102.30708457877775
curr_Factors:  [102.30708458]
mat_Sqrt:  [[0.15]]
grads:  [0.03931408]
Stock Position:  0.03931407620102006
Bond Position:  [25.58386172]


portfolio before change:  [29.65968807]
curr_Stock_Price:  103.59211151397581
curr_Factors:  [103.59211151]
mat_Sqrt:  [[0.15]]
grads:  [0.21928515]
Stock Position:  0.2192851532556772
Bond Position:  [6.94347602]


portfolio before change:  [29.65994869]
curr_Stock_Price:  103.58934176491363
curr_Factors:  [103.58934176]
mat_Sqrt:  [[0.15]]
grads:  [0.24807602]
Stock Position:  0.24807601509912483
Bond Position:  [3.96191758]


portfolio before change:  [29.48446568]
curr_Stock_Price:  102.87996934654922
curr_Factors:  [102.87996935]
mat_Sqrt:  [[0.15]]
grads:  [0.03651566]
Stock Position:  0.036515655139496034
Bond Position:  [25.7277362]


portfolio before change:  [29.49817155]
curr_Stock_Price:  103.16723525253731
curr_Factors:  [103.16723525]
mat_Sqrt:  [[0.15]]
grads:  [-0.06936125]
Stock Position:  -0.06936125270947062
Bond Position:  [36.65398023]


portfolio before change:  [29.52153306]
curr_Stock_Price:  102.8964864191069
curr_Factors:  [102.89648642]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201909]
Stock Position:  -0.020190904069621398
Bond Position:  [31.59910615]


portfolio before change:  [29.53570231]
curr_Stock_Price:  102.3903617344488
curr_Factors:  [102.39036173]
mat_Sqrt:  [[0.15]]
grads:  [0.09029366]
Stock Position:  0.09029365954684551
Bond Position:  [20.29050185]


portfolio before change:  [29.50754419]
curr_Stock_Price:  102.05041988264018
curr_Factors:  [102.05041988]
mat_Sqrt:  [[0.15]]
grads:  [0.03809173]
Stock Position:  0.03809172864673629
Bond Position:  [25.62026729]


portfolio before change:  [29.52177309]
curr_Stock_Price:  102.3398833391921
curr_Factors:  [102.33988334]
mat_Sqrt:  [[0.15]]
grads:  [0.04979268]
Stock Position:  0.04979268370235728
Bond Position:  [24.42599565]


portfolio before change:  [29.51380304]
curr_Stock_Price:  102.11849561274295
curr_Factors:  [102.11849561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03481264]
Stock Position:  -0.03481263922725057
Bond Position:  [33.06881738]


portfolio before change:  [29.50256379]
curr_Stock_Price:  102.5600911319686
curr_Factors:  [102.56009113]
mat_Sqrt:  [[0.15]]
grads:  [0.07697851]
Stock Position:  0.07697851148233126
Bond Position:  [21.60764064]


portfolio before change:  [29.61868764]
curr_Stock_Price:  104.03352471784106
curr_Factors:  [104.03352472]
mat_Sqrt:  [[0.15]]
grads:  [0.0230053]
Stock Position:  0.02300530496882074
Bond Position:  [27.22536468]


portfolio before change:  [29.63868728]
curr_Stock_Price:  104.75493462977245
curr_Factors:  [104.75493463]
mat_Sqrt:  [[0.15]]
grads:  [0.06114227]
Stock Position:  0.061142265020698285
Bond Position:  [23.2337333]


portfolio before change:  [29.62152127]
curr_Stock_Price:  104.42667704606475
curr_Factors:  [104.42667705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01561409]
Stock Position:  -0.015614088413210686
Bond Position:  [31.25204863]


portfolio before change:  [29.63141768]
curr_Stock_Price:  104.04307095787621
curr_Factors:  [104.04307096]
mat_Sqrt:  [[0.15]]
grads:  [0.07943834]
Stock Position:  0.07943834027227513
Bond Position:  [21.3664088]


portfolio before change:  [29.76733517]
curr_Stock_Price:  105.7204288765199
curr_Factors:  [105.72042888]
mat_Sqrt:  [[0.15]]
grads:  [-0.11745947]
Stock Position:  -0.11745947160046585
Bond Position:  [42.18520089]


portfolio before change:  [29.9369685]
curr_Stock_Price:  104.32113902481751
curr_Factors:  [104.32113902]
mat_Sqrt:  [[0.15]]
grads:  [0.04695487]
Stock Position:  0.04695486612284468
Bond Position:  [25.03858338]


portfolio before change:  [29.97308003]
curr_Stock_Price:  105.02354779314015
curr_Factors:  [105.02354779]
mat_Sqrt:  [[0.15]]
grads:  [0.25149676]
Stock Position:  0.25149675508475333
Bond Position:  [3.55999855]


portfolio before change:  [29.59934383]
curr_Stock_Price:  103.53573046694486
curr_Factors:  [103.53573047]
mat_Sqrt:  [[0.15]]
grads:  [-0.2380019]
Stock Position:  -0.238001900276483
Bond Position:  [54.24104442]


portfolio before change:  [29.52935044]
curr_Stock_Price:  103.85830748327454
curr_Factors:  [103.85830748]
mat_Sqrt:  [[0.15]]
grads:  [0.05097074]
Stock Position:  0.05097073779129413
Bond Position:  [24.23561588]


portfolio before change:  [29.44382132]
curr_Stock_Price:  102.12086445048466
curr_Factors:  [102.12086445]
mat_Sqrt:  [[0.15]]
grads:  [-0.03536062]
Stock Position:  -0.03536062196604598
Bond Position:  [33.05487861]


portfolio before change:  [29.43466963]
curr_Stock_Price:  102.49653118879732
curr_Factors:  [102.49653119]
mat_Sqrt:  [[0.15]]
grads:  [-0.04191871]
Stock Position:  -0.04191870991962998
Bond Position:  [33.73119199]


portfolio before change:  [29.45345651]
curr_Stock_Price:  102.14894867423453
curr_Factors:  [102.14894867]
mat_Sqrt:  [[0.15]]
grads:  [-0.00714502]
Stock Position:  -0.0071450234040979985
Bond Position:  [30.18331314]


portfolio before change:  [29.45576]
curr_Stock_Price:  102.35463828228129
curr_Factors:  [102.35463828]
mat_Sqrt:  [[0.15]]
grads:  [-0.07378601]
Stock Position:  -0.07378600869871889
Bond Position:  [37.00810023]


portfolio before change:  [29.49997192]
curr_Stock_Price:  101.81814611859481
curr_Factors:  [101.81814612]
mat_Sqrt:  [[0.15]]
grads:  [0.04994824]
Stock Position:  0.04994823667993808
Bond Position:  [24.41433506]


portfolio before change:  [29.53147711]
curr_Stock_Price:  102.38780006369021
curr_Factors:  [102.38780006]
mat_Sqrt:  [[0.15]]
grads:  [-0.0684433]
Stock Position:  -0.06844329843946831
Bond Position:  [36.53923587]


portfolio before change:  [29.57000368]
curr_Stock_Price:  101.89163929932106
curr_Factors:  [101.8916393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069381]
Stock Position:  -0.0006938105195601286
Bond Position:  [29.64069717]


portfolio before change:  [29.57343332]
curr_Stock_Price:  102.28897116641055
curr_Factors:  [102.28897117]
mat_Sqrt:  [[0.15]]
grads:  [0.03390705]
Stock Position:  0.03390705471152881
Bond Position:  [26.10511558]


portfolio before change:  [29.58426938]
curr_Stock_Price:  102.512308585602
curr_Factors:  [102.51230859]
mat_Sqrt:  [[0.15]]
grads:  [0.03429018]
Stock Position:  0.03429017794283281
Bond Position:  [26.06910408]


portfolio before change:  [29.56428873]
curr_Stock_Price:  101.83457819067941
curr_Factors:  [101.83457819]
mat_Sqrt:  [[0.15]]
grads:  [-0.04151022]
Stock Position:  -0.04151021669250919
Bond Position:  [33.79146413]


portfolio before change:  [29.52327108]
curr_Stock_Price:  102.92447491469942
curr_Factors:  [102.92447491]
mat_Sqrt:  [[0.15]]
grads:  [0.08267361]
Stock Position:  0.0826736058152746
Bond Position:  [21.01413361]


portfolio before change:  [29.53807915]
curr_Stock_Price:  103.07181510573656
curr_Factors:  [103.07181511]
mat_Sqrt:  [[0.15]]
grads:  [0.03506584]
Stock Position:  0.03506583638175149
Bond Position:  [25.92377975]


portfolio before change:  [29.55755222]
curr_Stock_Price:  103.5347271824286
curr_Factors:  [103.53472718]
mat_Sqrt:  [[0.15]]
grads:  [-0.05798332]
Stock Position:  -0.05798332207009648
Bond Position:  [35.56083966]


portfolio before change:  [29.49514637]
curr_Stock_Price:  104.68766634109974
curr_Factors:  [104.68766634]
mat_Sqrt:  [[0.15]]
grads:  [0.06704862]
Stock Position:  0.06704861699482201
Bond Position:  [22.47598312]


portfolio before change:  [29.60509752]
curr_Stock_Price:  106.28563345173423
curr_Factors:  [106.28563345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.60509752]
Stock Price:  107.04057878215913
PL:  [22.56451874]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.53630961e-03]
 [ 3.26591871e-03]
 [ 8.27031111e-03]
 [-2.77838900e-03]
 [ 1.42000424e-03]
 [-1.55215966e-02]
 [-8.73780299e-03]
 [ 2.13067110e-02]
 [-6.49170775e-03]
 [ 1.05722279e-02]
 [-1.17308139e-02]
 [ 7.61211419e-03]
 [ 1.38637283e-02]
 [-4.21007888e-03]
 [-1.82976403e-02]
 [-1.42273476e-02]
 [ 2.70505008e-02]
 [-6.53409731e-02]
 [-4.65093991e-03]
 [ 1.53998235e-02]
 [ 2.82756372e-02]
 [ 7.34050877e-05]
 [ 2.83361308e-02]
 [ 1.18569658e-03]
 [ 1.29090008e-02]
 [ 3.31632370e-03]
 [ 2.55743914e-02]
 [-2.35270447e-02]
 [-4.73477147e-02]
 [ 2.50645796e-03]
 [-4.49044667e-03]
 [ 5.58926421e-03]
 [ 1.73376788e-02]
 [-1.47507264e-02]
 [ 5.07677862e-03]
 [ 3.86354083e-03]
 [ 9.41626633e-03]
 [ 8.96575630e-03]
 [-7.13353611e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.22278151]
curr_Stock_Price:  99.79518318462047
curr_Factors:  [99.79518318]
mat_Sqrt:  [[0.15]]
grads:  [0.01690873]
Stock Position:  0.016908730713980094
Bond Position:  [-2.91019139]


portfolio before change:  [-1.22223228]
curr_Stock_Price:  99.84918023620804
curr_Factors:  [99.84918024]
mat_Sqrt:  [[0.15]]
grads:  [0.02177279]
Stock Position:  0.021772791409868028
Bond Position:  [-3.39622766]


portfolio before change:  [-1.21476176]
curr_Stock_Price:  100.21179215880618
curr_Factors:  [100.21179216]
mat_Sqrt:  [[0.15]]
grads:  [0.05513541]
Stock Position:  0.05513540743279563
Bond Position:  [-6.73997975]


portfolio before change:  [-1.20888478]
curr_Stock_Price:  100.33366544730808
curr_Factors:  [100.33366545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01852259]
Stock Position:  -0.018522593313415443
Bond Position:  [0.6495549]


portfolio before change:  [-1.18304231]
curr_Stock_Price:  98.94286300229383
curr_Factors:  [98.942863]
mat_Sqrt:  [[0.15]]
grads:  [0.00946669]
Stock Position:  0.009466694907911504
Bond Position:  [-2.11970421]


portfolio before change:  [-1.18349038]
curr_Stock_Price:  98.92352329393657
curr_Factors:  [98.92352329]
mat_Sqrt:  [[0.15]]
grads:  [-0.10347731]
Stock Position:  -0.10347731058872041
Bond Position:  [9.05284977]


portfolio before change:  [-1.23366957]
curr_Stock_Price:  99.41938924009196
curr_Factors:  [99.41938924]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825202]
Stock Position:  -0.05825201990645314
Bond Position:  [4.55771067]


portfolio before change:  [-1.18158582]
curr_Stock_Price:  98.53505934148092
curr_Factors:  [98.53505934]
mat_Sqrt:  [[0.15]]
grads:  [0.14204474]
Stock Position:  0.14204473969225018
Bond Position:  [-15.17797268]


portfolio before change:  [-1.45948206]
curr_Stock_Price:  96.59201750140497
curr_Factors:  [96.5920175]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327805]
Stock Position:  -0.04327805166858801
Bond Position:  [2.72083227]


portfolio before change:  [-1.42854886]
curr_Stock_Price:  95.88512171440593
curr_Factors:  [95.88512171]
mat_Sqrt:  [[0.15]]
grads:  [0.07048152]
Stock Position:  0.0704815192330406
Bond Position:  [-8.18667791]


portfolio before change:  [-1.41038037]
curr_Stock_Price:  96.15741850946584
curr_Factors:  [96.15741851]
mat_Sqrt:  [[0.15]]
grads:  [-0.07820543]
Stock Position:  -0.07820542632694283
Bond Position:  [6.10965154]


portfolio before change:  [-1.41767681]
curr_Stock_Price:  96.26048295465341
curr_Factors:  [96.26048295]
mat_Sqrt:  [[0.15]]
grads:  [0.05074743]
Stock Position:  0.05074742793186245
Bond Position:  [-6.30264873]


portfolio before change:  [-1.49634521]
curr_Stock_Price:  94.72581367152266
curr_Factors:  [94.72581367]
mat_Sqrt:  [[0.15]]
grads:  [0.09242486]
Stock Position:  0.09242485515149616
Bond Position:  [-10.25136482]


portfolio before change:  [-1.59984188]
curr_Stock_Price:  93.61988641221018
curr_Factors:  [93.61988641]
mat_Sqrt:  [[0.15]]
grads:  [-0.02806719]
Stock Position:  -0.028067192502445333
Bond Position:  [1.0278055]


portfolio before change:  [-1.57240311]
curr_Stock_Price:  92.646854133308
curr_Factors:  [92.64685413]
mat_Sqrt:  [[0.15]]
grads:  [-0.12198427]
Stock Position:  -0.12198426840709208
Bond Position:  [9.72905561]


portfolio before change:  [-1.63240563]
curr_Stock_Price:  93.14871172301171
curr_Factors:  [93.14871172]
mat_Sqrt:  [[0.15]]
grads:  [-0.09484898]
Stock Position:  -0.094848984078962
Bond Position:  [7.20265504]


portfolio before change:  [-1.62599592]
curr_Stock_Price:  93.09062649328868
curr_Factors:  [93.09062649]
mat_Sqrt:  [[0.15]]
grads:  [0.18033667]
Stock Position:  0.18033667220568297
Bond Position:  [-18.41364972]


portfolio before change:  [-1.79713278]
curr_Stock_Price:  92.15440530362619
curr_Factors:  [92.1544053]
mat_Sqrt:  [[0.15]]
grads:  [-0.43560649]
Stock Position:  -0.4356064873413046
Bond Position:  [38.345924]


portfolio before change:  [-1.74617012]
curr_Stock_Price:  92.04841716242495
curr_Factors:  [92.04841716]
mat_Sqrt:  [[0.15]]
grads:  [-0.03100627]
Stock Position:  -0.031006266054030944
Bond Position:  [1.10790759]


portfolio before change:  [-1.75594722]
curr_Stock_Price:  92.36821035503684
curr_Factors:  [92.36821036]
mat_Sqrt:  [[0.15]]
grads:  [0.10266549]
Stock Position:  0.10266548984982617
Bond Position:  [-11.23897478]


portfolio before change:  [-1.60280702]
curr_Stock_Price:  93.8735375723895
curr_Factors:  [93.87353757]
mat_Sqrt:  [[0.15]]
grads:  [0.18850425]
Stock Position:  0.18850424777645078
Bond Position:  [-19.29836761]


portfolio before change:  [-1.43391406]
curr_Stock_Price:  94.78229909711797
curr_Factors:  [94.7822991]
mat_Sqrt:  [[0.15]]
grads:  [0.00048937]
Stock Position:  0.0004893672514752305
Bond Position:  [-1.48029741]


portfolio before change:  [-1.43413102]
curr_Stock_Price:  94.71708957681003
curr_Factors:  [94.71708958]
mat_Sqrt:  [[0.15]]
grads:  [0.18890754]
Stock Position:  0.18890753834066565
Bond Position:  [-19.32690325]


portfolio before change:  [-1.43820033]
curr_Stock_Price:  94.7083377207035
curr_Factors:  [94.70833772]
mat_Sqrt:  [[0.15]]
grads:  [0.00790464]
Stock Position:  0.00790464389561304
Bond Position:  [-2.18683601]


portfolio before change:  [-1.43287643]
curr_Stock_Price:  95.41643642108549
curr_Factors:  [95.41643642]
mat_Sqrt:  [[0.15]]
grads:  [0.08606001]
Stock Position:  0.08606000524426859
Bond Position:  [-9.64441545]


portfolio before change:  [-1.45316628]
curr_Stock_Price:  95.19468162029617
curr_Factors:  [95.19468162]
mat_Sqrt:  [[0.15]]
grads:  [0.02210882]
Stock Position:  0.022108824671851938
Bond Position:  [-3.5578088]


portfolio before change:  [-1.44765334]
curr_Stock_Price:  95.4641529608857
curr_Factors:  [95.46415296]
mat_Sqrt:  [[0.15]]
grads:  [0.17049594]
Stock Position:  0.17049594274493976
Bond Position:  [-17.72390409]


portfolio before change:  [-1.52954714]
curr_Stock_Price:  94.99682112512396
curr_Factors:  [94.99682113]
mat_Sqrt:  [[0.15]]
grads:  [-0.15684696]
Stock Position:  -0.15684696485349514
Bond Position:  [13.37041592]


portfolio before change:  [-1.3308315]
curr_Stock_Price:  93.74053776007864
curr_Factors:  [93.74053776]
mat_Sqrt:  [[0.15]]
grads:  [-0.31565143]
Stock Position:  -0.3156514313774672
Bond Position:  [28.25850342]


portfolio before change:  [-1.26816411]
curr_Stock_Price:  93.55319546164392
curr_Factors:  [93.55319546]
mat_Sqrt:  [[0.15]]
grads:  [0.01670972]
Stock Position:  0.016709719762812606
Bond Position:  [-2.83141179]


portfolio before change:  [-1.2796543]
curr_Stock_Price:  92.88674218858992
curr_Factors:  [92.88674219]
mat_Sqrt:  [[0.15]]
grads:  [-0.02993631]
Stock Position:  -0.029936311166140258
Bond Position:  [1.50103211]


portfolio before change:  [-1.27917793]
curr_Stock_Price:  92.87709721479634
curr_Factors:  [92.87709721]
mat_Sqrt:  [[0.15]]
grads:  [0.03726176]
Stock Position:  0.03726176140464825
Bond Position:  [-4.73994216]


portfolio before change:  [-1.23742103]
curr_Stock_Price:  94.0136356998785
curr_Factors:  [94.0136357]
mat_Sqrt:  [[0.15]]
grads:  [0.11558453]
Stock Position:  0.11558452546944825
Bond Position:  [-12.1039425]


portfolio before change:  [-1.32291122]
curr_Stock_Price:  93.28709292631179
curr_Factors:  [93.28709293]
mat_Sqrt:  [[0.15]]
grads:  [-0.09833818]
Stock Position:  -0.09833817606460321
Bond Position:  [7.85077135]


portfolio before change:  [-1.24883361]
curr_Stock_Price:  92.54377837012332
curr_Factors:  [92.54377837]
mat_Sqrt:  [[0.15]]
grads:  [0.03384519]
Stock Position:  0.033845190793119366
Bond Position:  [-4.38099545]


portfolio before change:  [-1.2634459]
curr_Stock_Price:  92.12822068606664
curr_Factors:  [92.12822069]
mat_Sqrt:  [[0.15]]
grads:  [0.02575694]
Stock Position:  0.025756938880633663
Bond Position:  [-3.63638685]


portfolio before change:  [-1.26207333]
curr_Stock_Price:  92.19915863841057
curr_Factors:  [92.19915864]
mat_Sqrt:  [[0.15]]
grads:  [0.06277511]
Stock Position:  0.06277510888840827
Bond Position:  [-7.04988556]


portfolio before change:  [-1.17654527]
curr_Stock_Price:  93.57564929568053
curr_Factors:  [93.5756493]
mat_Sqrt:  [[0.15]]
grads:  [0.05977171]
Stock Position:  0.0597717086404992
Bond Position:  [-6.76972172]


portfolio before change:  [-1.20673751]
curr_Stock_Price:  93.08468177734187
curr_Factors:  [93.08468178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.20673751]
Stock Price:  92.43622667122811
PL:  [-1.20673751]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.03299696e-03]
 [ 3.34228524e-03]
 [ 5.46727108e-03]
 [-2.91069827e-03]
 [ 1.35957143e-02]
 [-1.91062294e-02]
 [-5.12006119e-02]
 [ 2.05498124e-02]
 [-5.96434328e-03]
 [ 4.86817091e-03]
 [ 1.31873182e-03]
 [ 6.99978899e-03]
 [ 1.41286031e-02]
 [ 2.39792406e-03]
 [ 3.68906145e-03]
 [-3.31904570e-03]
 [ 1.26827463e-02]
 [-9.38931793e-03]
 [ 5.65901560e-03]
 [-5.70045533e-03]
 [ 9.77061228e-03]
 [-3.72149062e-04]
 [ 2.01644120e-02]
 [ 4.84527750e-03]
 [ 1.51168050e-02]
 [-1.07572016e-02]
 [ 1.32507061e-02]
 [-1.08545519e-02]
 [-1.83335018e-02]
 [-1.68890900e-03]
 [-3.59476002e-03]
 [ 5.42075332e-03]
 [ 7.67831510e-03]
 [-1.24813176e-02]
 [ 5.46382611e-03]
 [ 5.71651963e-03]
 [ 2.90621641e-03]
 [ 8.16046355e-03]
 [-1.01557430e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.25948841]
curr_Stock_Price:  100.79393464970035
curr_Factors:  [100.79393465]
mat_Sqrt:  [[0.15]]
grads:  [0.04021998]
Stock Position:  0.04021997974815769
Bond Position:  [10.2055584]


portfolio before change:  [14.22310998]
curr_Stock_Price:  99.85772810321895
curr_Factors:  [99.8577281]
mat_Sqrt:  [[0.15]]
grads:  [0.0222819]
Stock Position:  0.022281901625619736
Bond Position:  [11.9980899]


portfolio before change:  [14.22004709]
curr_Stock_Price:  99.65295472907465
curr_Factors:  [99.65295473]
mat_Sqrt:  [[0.15]]
grads:  [0.03644847]
Stock Position:  0.0364484738793502
Bond Position:  [10.58784897]


portfolio before change:  [14.23911018]
curr_Stock_Price:  100.13965623121763
curr_Factors:  [100.13965623]
mat_Sqrt:  [[0.15]]
grads:  [-0.01940466]
Stock Position:  -0.019404655109776667
Bond Position:  [16.18228567]


portfolio before change:  [14.24406262]
curr_Stock_Price:  99.98868592104186
curr_Factors:  [99.98868592]
mat_Sqrt:  [[0.15]]
grads:  [0.0906381]
Stock Position:  0.09063809545922327
Bond Position:  [5.18127856]


portfolio before change:  [14.12767691]
curr_Stock_Price:  98.6974693873665
curr_Factors:  [98.69746939]
mat_Sqrt:  [[0.15]]
grads:  [-0.12737486]
Stock Position:  -0.12737486271449655
Bond Position:  [26.69925353]


portfolio before change:  [14.22170096]
curr_Stock_Price:  97.98550449519762
curr_Factors:  [97.9855045]
mat_Sqrt:  [[0.15]]
grads:  [-0.34133741]
Stock Position:  -0.3413374124324658
Bond Position:  [47.66781952]


portfolio before change:  [14.11162625]
curr_Stock_Price:  98.32544249087175
curr_Factors:  [98.32544249]
mat_Sqrt:  [[0.15]]
grads:  [0.13699875]
Stock Position:  0.13699874929879827
Bond Position:  [0.64116361]


portfolio before change:  [14.12700436]
curr_Stock_Price:  98.43710746409633
curr_Factors:  [98.43710746]
mat_Sqrt:  [[0.15]]
grads:  [-0.03976229]
Stock Position:  -0.03976228851073004
Bond Position:  [18.04108903]


portfolio before change:  [14.09977285]
curr_Stock_Price:  99.17868439786564
curr_Factors:  [99.1786844]
mat_Sqrt:  [[0.15]]
grads:  [0.03245447]
Stock Position:  0.032454472719218544
Bond Position:  [10.88098094]


portfolio before change:  [14.08988619]
curr_Stock_Price:  98.8321415214932
curr_Factors:  [98.83214152]
mat_Sqrt:  [[0.15]]
grads:  [0.00879155]
Stock Position:  0.008791545456856403
Bond Position:  [13.22099892]


portfolio before change:  [14.08893772]
curr_Stock_Price:  98.53626649153648
curr_Factors:  [98.53626649]
mat_Sqrt:  [[0.15]]
grads:  [0.04666526]
Stock Position:  0.046665259928840394
Bond Position:  [9.49071723]


portfolio before change:  [14.12223725]
curr_Stock_Price:  99.2244255701909
curr_Factors:  [99.22442557]
mat_Sqrt:  [[0.15]]
grads:  [0.09419069]
Stock Position:  0.09419068721088313
Bond Position:  [4.77622042]


portfolio before change:  [14.03282082]
curr_Stock_Price:  98.2687737743839
curr_Factors:  [98.26877377]
mat_Sqrt:  [[0.15]]
grads:  [0.01598616]
Stock Position:  0.01598616039843105
Bond Position:  [12.46188044]


portfolio before change:  [14.0325094]
curr_Stock_Price:  98.15184428018236
curr_Factors:  [98.15184428]
mat_Sqrt:  [[0.15]]
grads:  [0.02459374]
Stock Position:  0.024593743020513745
Bond Position:  [11.61858816]


portfolio before change:  [14.04876752]
curr_Stock_Price:  98.7538556025835
curr_Factors:  [98.7538556]
mat_Sqrt:  [[0.15]]
grads:  [-0.02212697]
Stock Position:  -0.022126971352129376
Bond Position:  [16.23389126]


portfolio before change:  [14.05133076]
curr_Stock_Price:  98.72972768374599
curr_Factors:  [98.72972768]
mat_Sqrt:  [[0.15]]
grads:  [0.08455164]
Stock Position:  0.08455164229763887
Bond Position:  [5.70357014]


portfolio before change:  [13.9646906]
curr_Stock_Price:  97.69659399468773
curr_Factors:  [97.69659399]
mat_Sqrt:  [[0.15]]
grads:  [-0.06259545]
Stock Position:  -0.06259545288238168
Bond Position:  [20.08005315]


portfolio before change:  [13.97612222]
curr_Stock_Price:  97.55406838688606
curr_Factors:  [97.55406839]
mat_Sqrt:  [[0.15]]
grads:  [0.03772677]
Stock Position:  0.03772677064603765
Bond Position:  [10.29572226]


portfolio before change:  [13.99773629]
curr_Stock_Price:  98.09286417496422
curr_Factors:  [98.09286417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03800304]
Stock Position:  -0.03800303550473999
Bond Position:  [17.72556289]


portfolio before change:  [13.97552261]
curr_Stock_Price:  98.73569480660942
curr_Factors:  [98.73569481]
mat_Sqrt:  [[0.15]]
grads:  [0.06513742]
Stock Position:  0.065137415170298
Bond Position:  [7.54413467]


portfolio before change:  [13.91668887]
curr_Stock_Price:  97.81799161642108
curr_Factors:  [97.81799162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248099]
Stock Position:  -0.002480993746943027
Bond Position:  [14.1593747]


portfolio before change:  [13.91820898]
curr_Stock_Price:  97.91872949631068
curr_Factors:  [97.9187295]
mat_Sqrt:  [[0.15]]
grads:  [0.13442941]
Stock Position:  0.1344294132691648
Bond Position:  [0.75505162]


portfolio before change:  [13.98172148]
curr_Stock_Price:  98.39048725675772
curr_Factors:  [98.39048726]
mat_Sqrt:  [[0.15]]
grads:  [0.03230185]
Stock Position:  0.032301849998853396
Bond Position:  [10.80352672]


portfolio before change:  [13.97750524]
curr_Stock_Price:  98.21815149808646
curr_Factors:  [98.2181515]
mat_Sqrt:  [[0.15]]
grads:  [0.1007787]
Stock Position:  0.10077869995304076
Bond Position:  [4.07920763]


portfolio before change:  [14.03743774]
curr_Stock_Price:  98.80778567839062
curr_Factors:  [98.80778568]
mat_Sqrt:  [[0.15]]
grads:  [-0.07171468]
Stock Position:  -0.07171467714200445
Bond Position:  [21.12340619]


portfolio before change:  [14.02807693]
curr_Stock_Price:  98.97513507627448
curr_Factors:  [98.97513508]
mat_Sqrt:  [[0.15]]
grads:  [0.08833804]
Stock Position:  0.08833804053939784
Bond Position:  [5.28480743]


portfolio before change:  [14.03072788]
curr_Stock_Price:  98.99766570594495
curr_Factors:  [98.99766571]
mat_Sqrt:  [[0.15]]
grads:  [-0.07236368]
Stock Position:  -0.0723636790429019
Bond Position:  [21.19456319]


portfolio before change:  [14.01726385]
curr_Stock_Price:  99.22033986055611
curr_Factors:  [99.22033986]
mat_Sqrt:  [[0.15]]
grads:  [-0.12222335]
Stock Position:  -0.1222233454595618
Bond Position:  [26.14430572]


portfolio before change:  [14.14407532]
curr_Stock_Price:  98.20954092414608
curr_Factors:  [98.20954092]
mat_Sqrt:  [[0.15]]
grads:  [-0.01125939]
Stock Position:  -0.011259393303002964
Bond Position:  [15.24985516]


portfolio before change:  [14.14169393]
curr_Stock_Price:  98.59035484434581
curr_Factors:  [98.59035484]
mat_Sqrt:  [[0.15]]
grads:  [-0.02396507]
Stock Position:  -0.02396506683122638
Bond Position:  [16.50441838]


portfolio before change:  [14.11196634]
curr_Stock_Price:  99.91690142799725
curr_Factors:  [99.91690143]
mat_Sqrt:  [[0.15]]
grads:  [0.03613836]
Stock Position:  0.036138355484341654
Bond Position:  [10.50113383]


portfolio before change:  [14.05348676]
curr_Stock_Price:  98.26236294149197
curr_Factors:  [98.26236294]
mat_Sqrt:  [[0.15]]
grads:  [0.05118877]
Stock Position:  0.05118876734789636
Bond Position:  [9.02355752]


portfolio before change:  [14.06396056]
curr_Stock_Price:  98.44493787475797
curr_Factors:  [98.44493787]
mat_Sqrt:  [[0.15]]
grads:  [-0.08320878]
Stock Position:  -0.08320878422519791
Bond Position:  [22.25544415]


portfolio before change:  [14.0773673]
curr_Stock_Price:  98.31725144251223
curr_Factors:  [98.31725144]
mat_Sqrt:  [[0.15]]
grads:  [0.03642551]
Stock Position:  0.03642550737232224
Bond Position:  [10.49611153]


portfolio before change:  [14.10919447]
curr_Stock_Price:  99.15499059323058
curr_Factors:  [99.15499059]
mat_Sqrt:  [[0.15]]
grads:  [0.03811013]
Stock Position:  0.03811013088913932
Bond Position:  [10.3303848]


portfolio before change:  [14.11510542]
curr_Stock_Price:  99.27620689275636
curr_Factors:  [99.27620689]
mat_Sqrt:  [[0.15]]
grads:  [0.01937478]
Stock Position:  0.019374776085804523
Bond Position:  [12.19165114]


portfolio before change:  [14.13386024]
curr_Stock_Price:  100.16554720471554
curr_Factors:  [100.1655472]
mat_Sqrt:  [[0.15]]
grads:  [0.05440309]
Stock Position:  0.054403090357330555
Bond Position:  [8.68454492]


portfolio before change:  [14.17116962]
curr_Stock_Price:  100.83138706148304
curr_Factors:  [100.83138706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.17116962]
Stock Price:  100.35150141669958
PL:  [13.8196682]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.96196929e-03]
 [ 2.00685275e-03]
 [ 1.19833552e-02]
 [-5.16925215e-04]
 [ 1.53582963e-02]
 [ 2.55051202e-02]
 [ 1.66779679e-03]
 [ 1.73230269e-02]
 [-5.89464241e-03]
 [ 5.82879599e-04]
 [ 1.09021876e-02]
 [ 5.41782221e-03]
 [ 1.38273669e-02]
 [ 2.39269622e-03]
 [ 1.08103797e-02]
 [-3.32217558e-03]
 [ 1.17366841e-02]
 [ 5.47807887e-03]
 [ 1.15562966e-02]
 [-1.37518435e-02]
 [-6.80779976e-03]
 [ 2.53757288e-02]
 [-3.47912250e-02]
 [ 5.74382538e-03]
 [ 2.48072515e-03]
 [-6.21627083e-03]
 [-1.02005923e-03]
 [-1.12472805e-02]
 [ 4.21894470e-02]
 [-7.98264813e-03]
 [-3.04073644e-03]
 [ 4.97326223e-03]
 [ 5.11154658e-03]
 [-9.11917849e-03]
 [ 2.18772947e-02]
 [ 5.47422592e-03]
 [-3.45126831e-03]
 [ 8.53667438e-03]
 [-1.22501894e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.10569361]
curr_Stock_Price:  99.28666149816368
curr_Factors:  [99.2866615]
mat_Sqrt:  [[0.15]]
grads:  [0.03974646]
Stock Position:  0.03974646192094752
Bond Position:  [-13.05198712]


portfolio before change:  [-9.04005832]
curr_Stock_Price:  100.97906081450908
curr_Factors:  [100.97906081]
mat_Sqrt:  [[0.15]]
grads:  [0.01337902]
Stock Position:  0.01337901835711263
Bond Position:  [-10.39105903]


portfolio before change:  [-9.04502154]
curr_Stock_Price:  100.70518030911045
curr_Factors:  [100.70518031]
mat_Sqrt:  [[0.15]]
grads:  [0.07988903]
Stock Position:  0.0798890345516551
Bond Position:  [-17.09026117]


portfolio before change:  [-9.02534572]
curr_Stock_Price:  100.97821188226274
curr_Factors:  [100.97821188]
mat_Sqrt:  [[0.15]]
grads:  [-0.00344617]
Stock Position:  -0.003446168102949492
Bond Position:  [-8.67735783]


portfolio before change:  [-9.02457468]
curr_Stock_Price:  100.43970720675905
curr_Factors:  [100.43970721]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-19.30845992]


portfolio before change:  [-9.00970421]
curr_Stock_Price:  100.60851682641876
curr_Factors:  [100.60851683]
mat_Sqrt:  [[0.15]]
grads:  [0.17003413]
Stock Position:  0.17003413485801494
Bond Position:  [-26.11658632]


portfolio before change:  [-9.04067642]
curr_Stock_Price:  100.44556460003628
curr_Factors:  [100.4455646]
mat_Sqrt:  [[0.15]]
grads:  [0.01111865]
Stock Position:  0.011118645254759528
Bond Position:  [-10.15749502]


portfolio before change:  [-9.03870174]
curr_Stock_Price:  100.7373674494351
curr_Factors:  [100.73736745]
mat_Sqrt:  [[0.15]]
grads:  [0.11548685]
Stock Position:  0.11548684631189597
Bond Position:  [-20.67254261]


portfolio before change:  [-9.08186058]
curr_Stock_Price:  100.38603206584213
curr_Factors:  [100.38603207]
mat_Sqrt:  [[0.15]]
grads:  [-0.03929762]
Stock Position:  -0.039297616044241895
Bond Position:  [-5.13692884]


portfolio before change:  [-9.08865905]
curr_Stock_Price:  100.54269062887681
curr_Factors:  [100.54269063]
mat_Sqrt:  [[0.15]]
grads:  [0.00388586]
Stock Position:  0.003885863995509431
Bond Position:  [-9.47935427]


portfolio before change:  [-9.08899047]
curr_Stock_Price:  100.76235217791549
curr_Factors:  [100.76235218]
mat_Sqrt:  [[0.15]]
grads:  [0.07268125]
Stock Position:  0.07268125062967128
Bond Position:  [-16.41252424]


portfolio before change:  [-9.19053945]
curr_Stock_Price:  99.39339811930999
curr_Factors:  [99.39339812]
mat_Sqrt:  [[0.15]]
grads:  [0.03611881]
Stock Position:  0.03611881471007891
Bond Position:  [-12.78051118]


portfolio before change:  [-9.21170233]
curr_Stock_Price:  98.85170771870453
curr_Factors:  [98.85170772]
mat_Sqrt:  [[0.15]]
grads:  [0.09218245]
Stock Position:  0.09218244603194828
Bond Position:  [-18.32409454]


portfolio before change:  [-9.26275981]
curr_Stock_Price:  98.32268269881659
curr_Factors:  [98.3226827]
mat_Sqrt:  [[0.15]]
grads:  [0.01595131]
Stock Position:  0.015951308146133054
Bond Position:  [-10.83113522]


portfolio before change:  [-9.24951111]
curr_Stock_Price:  99.23813540408146
curr_Factors:  [99.2381354]
mat_Sqrt:  [[0.15]]
grads:  [0.0720692]
Stock Position:  0.07206919769078558
Bond Position:  [-16.40152391]


portfolio before change:  [-9.28850648]
curr_Stock_Price:  98.72550236795884
curr_Factors:  [98.72550237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214784]
Stock Position:  -0.022147837195711045
Bond Position:  [-7.10195013]


portfolio before change:  [-9.2976435]
curr_Stock_Price:  99.09796400093093
curr_Factors:  [99.097964]
mat_Sqrt:  [[0.15]]
grads:  [0.07824456]
Stock Position:  0.07824456060746823
Bond Position:  [-17.05152015]


portfolio before change:  [-9.2440439]
curr_Stock_Price:  99.81023300891998
curr_Factors:  [99.81023301]
mat_Sqrt:  [[0.15]]
grads:  [0.03652053]
Stock Position:  0.03652052582701393
Bond Position:  [-12.88916609]


portfolio before change:  [-9.23751346]
curr_Stock_Price:  100.03316765539947
curr_Factors:  [100.03316766]
mat_Sqrt:  [[0.15]]
grads:  [0.07704198]
Stock Position:  0.07704197720631108
Bond Position:  [-16.94426648]


portfolio before change:  [-9.11065119]
curr_Stock_Price:  101.70732555466004
curr_Factors:  [101.70732555]
mat_Sqrt:  [[0.15]]
grads:  [-0.09167896]
Stock Position:  -0.09167895683342835
Bond Position:  [0.21377032]


portfolio before change:  [-9.16972106]
curr_Stock_Price:  102.35192924583035
curr_Factors:  [102.35192925]
mat_Sqrt:  [[0.15]]
grads:  [-0.04538533]
Stock Position:  -0.04538533176608709
Bond Position:  [-4.52444479]


portfolio before change:  [-9.18087442]
curr_Stock_Price:  102.58521539008349
curr_Factors:  [102.58521539]
mat_Sqrt:  [[0.15]]
grads:  [0.16917153]
Stock Position:  0.16917152501195887
Bond Position:  [-26.53537175]


portfolio before change:  [-9.21148642]
curr_Stock_Price:  102.42387101556977
curr_Factors:  [102.42387102]
mat_Sqrt:  [[0.15]]
grads:  [-0.2319415]
Stock Position:  -0.23194150009980088
Bond Position:  [14.54485987]


portfolio before change:  [-9.26274541]
curr_Stock_Price:  102.65270979820919
curr_Factors:  [102.6527098]
mat_Sqrt:  [[0.15]]
grads:  [0.03829217]
Stock Position:  0.03829216920080867
Bond Position:  [-13.19354034]


portfolio before change:  [-9.24468567]
curr_Stock_Price:  103.16741131310395
curr_Factors:  [103.16741131]
mat_Sqrt:  [[0.15]]
grads:  [0.01653817]
Stock Position:  0.01653816764096305
Bond Position:  [-10.95088561]


portfolio before change:  [-9.26177758]
curr_Stock_Price:  102.21670335256077
curr_Factors:  [102.21670335]
mat_Sqrt:  [[0.15]]
grads:  [-0.04144181]
Stock Position:  -0.04144180552314689
Bond Position:  [-5.02573284]


portfolio before change:  [-9.27747142]
curr_Stock_Price:  102.58023916263718
curr_Factors:  [102.58023916]
mat_Sqrt:  [[0.15]]
grads:  [-0.00680039]
Stock Position:  -0.006800394859383164
Bond Position:  [-8.57988529]


portfolio before change:  [-9.27452964]
curr_Stock_Price:  101.98993054210054
curr_Factors:  [101.98993054]
mat_Sqrt:  [[0.15]]
grads:  [-0.07498187]
Stock Position:  -0.07498187018202564
Bond Position:  [-1.62713391]


portfolio before change:  [-9.34417672]
curr_Stock_Price:  102.91607007791163
curr_Factors:  [102.91607008]
mat_Sqrt:  [[0.15]]
grads:  [0.28126298]
Stock Position:  0.28126297990457566
Bond Position:  [-38.29065727]


portfolio before change:  [-9.20745842]
curr_Stock_Price:  103.41917548412492
curr_Factors:  [103.41917548]
mat_Sqrt:  [[0.15]]
grads:  [-0.05321765]
Stock Position:  -0.0532176541726541
Bond Position:  [-3.70373251]


portfolio before change:  [-9.19582967]
curr_Stock_Price:  103.19196236683477
curr_Factors:  [103.19196237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02027158]
Stock Position:  -0.020271576257447313
Bond Position:  [-7.10396594]


portfolio before change:  [-9.1901938]
curr_Stock_Price:  102.87013634294455
curr_Factors:  [102.87013634]
mat_Sqrt:  [[0.15]]
grads:  [0.03315508]
Stock Position:  0.03315508151959818
Bond Position:  [-12.60086156]


portfolio before change:  [-9.25532667]
curr_Stock_Price:  100.95315518407095
curr_Factors:  [100.95315518]
mat_Sqrt:  [[0.15]]
grads:  [0.03407698]
Stock Position:  0.03407697721688097
Bond Position:  [-12.69550504]


portfolio before change:  [-9.2508709]
curr_Stock_Price:  101.13048360325686
curr_Factors:  [101.1304836]
mat_Sqrt:  [[0.15]]
grads:  [-0.06079452]
Stock Position:  -0.060794523236221976
Bond Position:  [-3.10269136]


portfolio before change:  [-9.2621138]
curr_Stock_Price:  101.30903666439616
curr_Factors:  [101.30903666]
mat_Sqrt:  [[0.15]]
grads:  [0.14584863]
Stock Position:  0.14584863103995815
Bond Position:  [-24.03789811]


portfolio before change:  [-9.19221346]
curr_Stock_Price:  101.8089060414005
curr_Factors:  [101.80890604]
mat_Sqrt:  [[0.15]]
grads:  [0.03649484]
Stock Position:  0.03649483946959664
Bond Position:  [-12.90771315]


portfolio before change:  [-9.16683324]
curr_Stock_Price:  102.54856640965995
curr_Factors:  [102.54856641]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300846]
Stock Position:  -0.02300845538082439
Bond Position:  [-6.80734913]


portfolio before change:  [-9.1603]
curr_Stock_Price:  102.22763144889198
curr_Factors:  [102.22763145]
mat_Sqrt:  [[0.15]]
grads:  [0.05691116]
Stock Position:  0.05691116251138179
Bond Position:  [-14.97819334]


portfolio before change:  [-9.21481844]
curr_Stock_Price:  101.30257473583961
curr_Factors:  [101.30257474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.21481844]
Stock Price:  101.91762472682254
PL:  [-11.13244317]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.06615467e-02]
 [-1.36322252e-02]
 [-2.13355276e-02]
 [ 2.36722934e-03]
 [-1.21897686e-02]
 [ 3.17535483e-03]
 [-4.79422688e-02]
 [ 1.33876978e-02]
 [-6.49407529e-03]
 [ 1.14779882e-02]
 [-1.66398451e-02]
 [ 7.72719665e-03]
 [ 1.38447732e-02]
 [-4.41422433e-03]
 [-1.73515507e-02]
 [-1.56171238e-02]
 [ 3.08227019e-02]
 [-7.82157254e-02]
 [-5.19208023e-03]
 [ 2.49041439e-02]
 [ 3.39495439e-02]
 [ 1.27340961e-02]
 [ 1.20888989e-01]
 [-1.31741039e-02]
 [-1.80843931e-03]
 [ 6.18353594e-02]
 [ 5.32789287e-02]
 [-3.75167339e-02]
 [-4.79186247e-02]
 [ 5.57740140e-03]
 [-3.44181443e-03]
 [ 5.60681384e-03]
 [ 3.39050454e-02]
 [-2.02844204e-02]
 [ 7.84311130e-03]
 [ 9.73573516e-04]
 [ 1.33036985e-02]
 [ 5.33475191e-03]
 [-7.86998099e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.4982963]
curr_Stock_Price:  98.61624125442124
curr_Factors:  [98.61624125]
mat_Sqrt:  [[0.15]]
grads:  [0.07107698]
Stock Position:  0.07107697816651613
Bond Position:  [-26.50764073]


portfolio before change:  [-19.54047519]
curr_Stock_Price:  98.0694365972817
curr_Factors:  [98.0694366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0908815]
Stock Position:  -0.0908815012231597
Bond Position:  [-10.62777757]


portfolio before change:  [-19.5284153]
curr_Stock_Price:  97.92211901217104
curr_Factors:  [97.92211901]
mat_Sqrt:  [[0.15]]
grads:  [-0.14223685]
Stock Position:  -0.1422368504175543
Bond Position:  [-5.60028151]


portfolio before change:  [-19.57725166]
curr_Stock_Price:  98.26054244935446
curr_Factors:  [98.26054245]
mat_Sqrt:  [[0.15]]
grads:  [0.01578153]
Stock Position:  0.015781528943325584
Bond Position:  [-21.12795326]


portfolio before change:  [-19.57682003]
curr_Stock_Price:  98.45525075831623
curr_Factors:  [98.45525076]
mat_Sqrt:  [[0.15]]
grads:  [-0.08126512]
Stock Position:  -0.08126512423032296
Bond Position:  [-11.57584184]


portfolio before change:  [-19.66174481]
curr_Stock_Price:  99.48247750240762
curr_Factors:  [99.4824775]
mat_Sqrt:  [[0.15]]
grads:  [0.02116903]
Stock Position:  0.02116903221732135
Bond Position:  [-21.76769258]


portfolio before change:  [-19.70365415]
curr_Stock_Price:  97.6312727095108
curr_Factors:  [97.63127271]
mat_Sqrt:  [[0.15]]
grads:  [-0.31961513]
Stock Position:  -0.3196151250974954
Bond Position:  [11.50077729]


portfolio before change:  [-19.41591119]
curr_Stock_Price:  96.73549133100941
curr_Factors:  [96.73549133]
mat_Sqrt:  [[0.15]]
grads:  [0.08925132]
Stock Position:  0.08925131849459483
Bond Position:  [-28.04968134]


portfolio before change:  [-19.43688564]
curr_Stock_Price:  96.53977410608877
curr_Factors:  [96.53977411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329384]
Stock Position:  -0.04329383529927052
Bond Position:  [-15.25730856]


portfolio before change:  [-19.40521096]
curr_Stock_Price:  95.76409879589953
curr_Factors:  [95.7640988]
mat_Sqrt:  [[0.15]]
grads:  [0.07651992]
Stock Position:  0.07651992149411319
Bond Position:  [-26.73307228]


portfolio before change:  [-19.48282103]
curr_Stock_Price:  94.79352506820375
curr_Factors:  [94.79352507]
mat_Sqrt:  [[0.15]]
grads:  [-0.1109323]
Stock Position:  -0.11093230080706176
Bond Position:  [-8.96715719]


portfolio before change:  [-19.49097671]
curr_Stock_Price:  94.85693954669281
curr_Factors:  [94.85693955]
mat_Sqrt:  [[0.15]]
grads:  [0.05151464]
Stock Position:  0.051514644335794973
Bond Position:  [-24.37749821]


portfolio before change:  [-19.56697351]
curr_Stock_Price:  93.44084868098781
curr_Factors:  [93.44084868]
mat_Sqrt:  [[0.15]]
grads:  [0.09229849]
Stock Position:  0.09229848770782316
Bond Position:  [-28.19142253]


portfolio before change:  [-19.56650766]
curr_Stock_Price:  93.4840778867271
curr_Factors:  [93.48407789]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942816]
Stock Position:  -0.029428162191740017
Bond Position:  [-16.81544306]


portfolio before change:  [-19.55085711]
curr_Stock_Price:  92.88082526380953
curr_Factors:  [92.88082526]
mat_Sqrt:  [[0.15]]
grads:  [-0.115677]
Stock Position:  -0.11567700470424237
Bond Position:  [-8.80668145]


portfolio before change:  [-19.50337307]
curr_Stock_Price:  92.4608200822565
curr_Factors:  [92.46082008]
mat_Sqrt:  [[0.15]]
grads:  [-0.10411416]
Stock Position:  -0.10411415873111568
Bond Position:  [-9.87689257]


portfolio before change:  [-19.41298776]
curr_Stock_Price:  91.5808244721631
curr_Factors:  [91.58082447]
mat_Sqrt:  [[0.15]]
grads:  [0.20548468]
Stock Position:  0.20548467955069957
Bond Position:  [-38.23144413]


portfolio before change:  [-19.52980841]
curr_Stock_Price:  91.03557008423843
curr_Factors:  [91.03557008]
mat_Sqrt:  [[0.15]]
grads:  [-0.52143817]
Stock Position:  -0.5214381695298939
Bond Position:  [27.93961262]


portfolio before change:  [-19.93660187]
curr_Stock_Price:  91.82240570851775
curr_Factors:  [91.82240571]
mat_Sqrt:  [[0.15]]
grads:  [-0.03461387]
Stock Position:  -0.03461386822596831
Bond Position:  [-16.75827322]


portfolio before change:  [-19.87041317]
curr_Stock_Price:  89.84968147800215
curr_Factors:  [89.84968148]
mat_Sqrt:  [[0.15]]
grads:  [0.16602763]
Stock Position:  0.1660276261629186
Bond Position:  [-34.78794249]


portfolio before change:  [-20.11626957]
curr_Stock_Price:  88.39505823481241
curr_Factors:  [88.39505823]
mat_Sqrt:  [[0.15]]
grads:  [0.22633029]
Stock Position:  0.22633029270669913
Bond Position:  [-40.12274898]


portfolio before change:  [-20.24898066]
curr_Stock_Price:  87.83085879067531
curr_Factors:  [87.83085879]
mat_Sqrt:  [[0.15]]
grads:  [0.08489397]
Stock Position:  0.08489397417459227
Bond Position:  [-27.70529131]


portfolio before change:  [-20.27735804]
curr_Stock_Price:  87.53738681276842
curr_Factors:  [87.53738681]
mat_Sqrt:  [[0.15]]
grads:  [0.80592659]
Stock Position:  0.8059265914278914
Bond Position:  [-90.82606581]


portfolio before change:  [-20.29033239]
curr_Stock_Price:  87.53537622665365
curr_Factors:  [87.53537623]
mat_Sqrt:  [[0.15]]
grads:  [-0.08782736]
Stock Position:  -0.08782735927495748
Bond Position:  [-12.60233145]


portfolio before change:  [-20.37306226]
curr_Stock_Price:  88.45939897711916
curr_Factors:  [88.45939898]
mat_Sqrt:  [[0.15]]
grads:  [-0.01205626]
Stock Position:  -0.012056262049566249
Bond Position:  [-19.30657256]


portfolio before change:  [-20.36820915]
curr_Stock_Price:  87.85667682987557
curr_Factors:  [87.85667683]
mat_Sqrt:  [[0.15]]
grads:  [0.41223573]
Stock Position:  0.41223572924089763
Bond Position:  [-56.5858704]


portfolio before change:  [-20.26425037]
curr_Stock_Price:  88.12601898738957
curr_Factors:  [88.12601899]
mat_Sqrt:  [[0.15]]
grads:  [0.35519286]
Stock Position:  0.3551928577124041
Bond Position:  [-51.56598289]


portfolio before change:  [-20.56295044]
curr_Stock_Price:  87.30321551468167
curr_Factors:  [87.30321551]
mat_Sqrt:  [[0.15]]
grads:  [-0.25011156]
Stock Position:  -0.2501115596355691
Bond Position:  [1.27259296]


portfolio before change:  [-20.59771604]
curr_Stock_Price:  87.44285196276778
curr_Factors:  [87.44285196]
mat_Sqrt:  [[0.15]]
grads:  [-0.3194575]
Stock Position:  -0.319457497845242
Bond Position:  [7.33655865]


portfolio before change:  [-20.56252327]
curr_Stock_Price:  87.33555866259361
curr_Factors:  [87.33555866]
mat_Sqrt:  [[0.15]]
grads:  [0.03718268]
Stock Position:  0.03718267603003692
Bond Position:  [-23.80989305]


portfolio before change:  [-20.59107029]
curr_Stock_Price:  86.64785657314641
curr_Factors:  [86.64785657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02294543]
Stock Position:  -0.022945429540313103
Bond Position:  [-18.60289801]


portfolio before change:  [-20.58154145]
curr_Stock_Price:  86.13122412705839
curr_Factors:  [86.13122413]
mat_Sqrt:  [[0.15]]
grads:  [0.03737876]
Stock Position:  0.03737875894660298
Bond Position:  [-23.80101971]


portfolio before change:  [-20.56220583]
curr_Stock_Price:  86.7281122036218
curr_Factors:  [86.7281122]
mat_Sqrt:  [[0.15]]
grads:  [0.22603364]
Stock Position:  0.2260336360498026
Bond Position:  [-40.16567637]


portfolio before change:  [-20.45905171]
curr_Stock_Price:  87.20669201296401
curr_Factors:  [87.20669201]
mat_Sqrt:  [[0.15]]
grads:  [-0.13522947]
Stock Position:  -0.1352294692047541
Bond Position:  [-8.66613704]


portfolio before change:  [-20.52968083]
curr_Stock_Price:  87.72097176212014
curr_Factors:  [87.72097176]
mat_Sqrt:  [[0.15]]
grads:  [0.05228741]
Stock Position:  0.05228740867093208
Bond Position:  [-25.11638313]


portfolio before change:  [-20.52431532]
curr_Stock_Price:  87.88363524017242
curr_Factors:  [87.88363524]
mat_Sqrt:  [[0.15]]
grads:  [0.00649049]
Stock Position:  0.006490490109970319
Bond Position:  [-21.09472318]


portfolio before change:  [-20.51933879]
curr_Stock_Price:  89.05666377421733
curr_Factors:  [89.05666377]
mat_Sqrt:  [[0.15]]
grads:  [0.08869132]
Stock Position:  0.08869132315805014
Bond Position:  [-28.41789214]


portfolio before change:  [-20.45470582]
curr_Stock_Price:  89.82545857216047
curr_Factors:  [89.82545857]
mat_Sqrt:  [[0.15]]
grads:  [0.03556501]
Stock Position:  0.03556501274180785
Bond Position:  [-23.6493494]


portfolio before change:  [-20.41598188]
curr_Stock_Price:  90.99740528702735
curr_Factors:  [90.99740529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.41598188]
Stock Price:  90.10147472011303
PL:  [-20.41598188]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.69533139e-03]
 [-6.37365505e-03]
 [ 1.39391145e-02]
 [ 1.25944446e-02]
 [-1.64480998e-02]
 [ 3.39610186e-02]
 [ 7.05336739e-02]
 [-7.44946397e-03]
 [-1.34139251e-02]
 [ 1.88034925e-04]
 [ 3.95996791e-02]
 [ 1.11633769e-02]
 [-3.43229441e-03]
 [-4.27889165e-03]
 [ 3.09790621e-03]
 [ 5.21325737e-03]
 [ 9.16683949e-03]
 [-9.21701675e-03]
 [ 1.24608265e-02]
 [-1.81568102e-02]
 [ 8.80115774e-03]
 [ 3.56705936e-02]
 [-3.09468065e-03]
 [ 7.02813829e-03]
 [ 7.82869606e-03]
 [-2.30332981e-02]
 [-4.99376905e-05]
 [-1.26955309e-02]
 [ 6.36482126e-02]
 [-2.98961773e-03]
 [-1.37454415e-02]
 [ 4.03952177e-03]
 [ 7.05849621e-03]
 [ 6.29372339e-03]
 [ 8.20876834e-03]
 [ 2.14412590e-03]
 [-8.11488064e-02]
 [ 9.12863668e-03]
 [-3.09993749e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.98122548]
curr_Stock_Price:  100.38892786862068
curr_Factors:  [100.38892787]
mat_Sqrt:  [[0.15]]
grads:  [0.04463554]
Stock Position:  0.04463554257194012
Bond Position:  [3.50031121]


portfolio before change:  [8.05823368]
curr_Stock_Price:  102.10439113411599
curr_Factors:  [102.10439113]
mat_Sqrt:  [[0.15]]
grads:  [-0.04249103]
Stock Position:  -0.04249103363678327
Bond Position:  [12.39675479]


portfolio before change:  [8.05318354]
curr_Stock_Price:  102.25971403644589
curr_Factors:  [102.25971404]
mat_Sqrt:  [[0.15]]
grads:  [0.09292743]
Stock Position:  0.09292743006035022
Bond Position:  [-1.44954889]


portfolio before change:  [8.06892718]
curr_Stock_Price:  102.4310826475576
curr_Factors:  [102.43108265]
mat_Sqrt:  [[0.15]]
grads:  [0.08396296]
Stock Position:  0.08396296401690845
Bond Position:  [-0.53149013]


portfolio before change:  [8.14499188]
curr_Stock_Price:  103.33780553587289
curr_Factors:  [103.33780554]
mat_Sqrt:  [[0.15]]
grads:  [-0.109654]
Stock Position:  -0.10965399881058802
Bond Position:  [19.47639548]


portfolio before change:  [8.08410595]
curr_Stock_Price:  103.91526399635585
curr_Factors:  [103.915264]
mat_Sqrt:  [[0.15]]
grads:  [0.22640679]
Stock Position:  0.22640679081037296
Bond Position:  [-15.44301549]


portfolio before change:  [8.4046732]
curr_Stock_Price:  105.33968129096517
curr_Factors:  [105.33968129]
mat_Sqrt:  [[0.15]]
grads:  [0.47022449]
Stock Position:  0.4702244928129073
Bond Position:  [-41.12862501]


portfolio before change:  [8.23186613]
curr_Stock_Price:  104.9831161348722
curr_Factors:  [104.98311613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04966309]
Stock Position:  -0.049663093151715035
Bond Position:  [13.44565241]


portfolio before change:  [8.23105908]
curr_Stock_Price:  105.0332109416672
curr_Factors:  [105.03321094]
mat_Sqrt:  [[0.15]]
grads:  [-0.08942617]
Stock Position:  -0.08942616701491587
Bond Position:  [17.62377654]


portfolio before change:  [8.14610833]
curr_Stock_Price:  106.00780111434577
curr_Factors:  [106.00780111]
mat_Sqrt:  [[0.15]]
grads:  [0.00125357]
Stock Position:  0.001253566167623606
Bond Position:  [8.01322053]


portfolio before change:  [8.1486749]
curr_Stock_Price:  107.2561272296089
curr_Factors:  [107.25612723]
mat_Sqrt:  [[0.15]]
grads:  [0.26399786]
Stock Position:  0.26399786063898284
Bond Position:  [-20.16671323]


portfolio before change:  [7.98265487]
curr_Stock_Price:  106.63680770226996
curr_Factors:  [106.6368077]
mat_Sqrt:  [[0.15]]
grads:  [0.07442251]
Stock Position:  0.07442251254814998
Bond Position:  [0.04647571]


portfolio before change:  [7.92797789]
curr_Stock_Price:  105.90204627816217
curr_Factors:  [105.90204628]
mat_Sqrt:  [[0.15]]
grads:  [-0.02288196]
Stock Position:  -0.022881962762517107
Bond Position:  [10.35122457]


portfolio before change:  [7.94923618]
curr_Stock_Price:  105.02955544293611
curr_Factors:  [105.02955544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852594]
Stock Position:  -0.028525944366464356
Bond Position:  [10.94530343]


portfolio before change:  [7.97342543]
curr_Stock_Price:  104.22954691538065
curr_Factors:  [104.22954692]
mat_Sqrt:  [[0.15]]
grads:  [0.02065271]
Stock Position:  0.020652708042415195
Bond Position:  [5.82080302]


portfolio before change:  [8.00193291]
curr_Stock_Price:  105.5746412169333
curr_Factors:  [105.57464122]
mat_Sqrt:  [[0.15]]
grads:  [0.03475505]
Stock Position:  0.034755049140484606
Bond Position:  [4.33268107]


portfolio before change:  [7.97083973]
curr_Stock_Price:  104.66441946883519
curr_Factors:  [104.66441947]
mat_Sqrt:  [[0.15]]
grads:  [0.06111226]
Stock Position:  0.06111226326231681
Bond Position:  [1.57456017]


portfolio before change:  [7.99848607]
curr_Stock_Price:  105.11358473748876
curr_Factors:  [105.11358474]
mat_Sqrt:  [[0.15]]
grads:  [-0.06144678]
Stock Position:  -0.06144677834217324
Bond Position:  [14.45737721]


portfolio before change:  [7.93198299]
curr_Stock_Price:  106.22528435344121
curr_Factors:  [106.22528435]
mat_Sqrt:  [[0.15]]
grads:  [0.08307218]
Stock Position:  0.08307217639853741
Bond Position:  [-0.89238257]


portfolio before change:  [7.99722955]
curr_Stock_Price:  107.01204728573171
curr_Factors:  [107.01204729]
mat_Sqrt:  [[0.15]]
grads:  [-0.1210454]
Stock Position:  -0.12104540126669473
Bond Position:  [20.95054575]


portfolio before change:  [8.28170742]
curr_Stock_Price:  104.68350869685945
curr_Factors:  [104.6835087]
mat_Sqrt:  [[0.15]]
grads:  [0.05867438]
Stock Position:  0.0586743849115064
Bond Position:  [2.13946693]


portfolio before change:  [8.27410646]
curr_Stock_Price:  104.54940577523901
curr_Factors:  [104.54940578]
mat_Sqrt:  [[0.15]]
grads:  [0.23780396]
Stock Position:  0.23780395710845642
Bond Position:  [-16.58815595]


portfolio before change:  [8.4629688]
curr_Stock_Price:  105.35231918295969
curr_Factors:  [105.35231918]
mat_Sqrt:  [[0.15]]
grads:  [-0.0206312]
Stock Position:  -0.020631204347805725
Bond Position:  [10.63651402]


portfolio before change:  [8.42827402]
curr_Stock_Price:  107.09843279042988
curr_Factors:  [107.09843279]
mat_Sqrt:  [[0.15]]
grads:  [0.04685426]
Stock Position:  0.04685425524151936
Bond Position:  [3.41025671]


portfolio before change:  [8.44546341]
curr_Stock_Price:  107.45620349483859
curr_Factors:  [107.45620349]
mat_Sqrt:  [[0.15]]
grads:  [0.05219131]
Stock Position:  0.05219130708189984
Bond Position:  [2.83718369]


portfolio before change:  [8.39947409]
curr_Stock_Price:  106.56823978502943
curr_Factors:  [106.56823979]
mat_Sqrt:  [[0.15]]
grads:  [-0.15355532]
Stock Position:  -0.1535553203989905
Bond Position:  [24.76359429]


portfolio before change:  [8.53497543]
curr_Stock_Price:  105.70597273369866
curr_Factors:  [105.70597273]
mat_Sqrt:  [[0.15]]
grads:  [-0.00033292]
Stock Position:  -0.0003329179367656678
Bond Position:  [8.57016684]


portfolio before change:  [8.53588163]
curr_Stock_Price:  106.20200585089755
curr_Factors:  [106.20200585]
mat_Sqrt:  [[0.15]]
grads:  [-0.08463687]
Stock Position:  -0.08463687274226527
Bond Position:  [17.52448728]


portfolio before change:  [8.55978859]
curr_Stock_Price:  105.94542425680362
curr_Factors:  [105.94542426]
mat_Sqrt:  [[0.15]]
grads:  [0.42432142]
Stock Position:  0.4243214173481061
Bond Position:  [-36.395124]


portfolio before change:  [8.58863248]
curr_Stock_Price:  106.02412300709145
curr_Factors:  [106.02412301]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993078]
Stock Position:  -0.019930784891146622
Bond Position:  [10.70177647]


portfolio before change:  [8.55826762]
curr_Stock_Price:  107.6147607361604
curr_Factors:  [107.61476074]
mat_Sqrt:  [[0.15]]
grads:  [-0.09163628]
Stock Position:  -0.09163627649057635
Bond Position:  [18.41968359]


portfolio before change:  [8.5671847]
curr_Stock_Price:  107.5425789218832
curr_Factors:  [107.54257892]
mat_Sqrt:  [[0.15]]
grads:  [0.02693015]
Stock Position:  0.026930145109669235
Bond Position:  [5.67104745]


portfolio before change:  [8.58089005]
curr_Stock_Price:  108.02517665346042
curr_Factors:  [108.02517665]
mat_Sqrt:  [[0.15]]
grads:  [0.04705664]
Stock Position:  0.047056641408364075
Bond Position:  [3.49758805]


portfolio before change:  [8.62868692]
curr_Stock_Price:  109.03161575626086
curr_Factors:  [109.03161576]
mat_Sqrt:  [[0.15]]
grads:  [0.04195816]
Stock Position:  0.04195815590503505
Bond Position:  [4.05392139]


portfolio before change:  [8.63148532]
curr_Stock_Price:  109.08623265592101
curr_Factors:  [109.08623266]
mat_Sqrt:  [[0.15]]
grads:  [0.05472512]
Stock Position:  0.05472512225001049
Bond Position:  [2.6617279]


portfolio before change:  [8.67188904]
curr_Stock_Price:  109.8184555036569
curr_Factors:  [109.8184555]
mat_Sqrt:  [[0.15]]
grads:  [0.01429417]
Stock Position:  0.014294172659141107
Bond Position:  [7.10212508]


portfolio before change:  [8.67297746]
curr_Stock_Price:  109.83248930242917
curr_Factors:  [109.8324893]
mat_Sqrt:  [[0.15]]
grads:  [-0.54099204]
Stock Position:  -0.5409920428901956
Bond Position:  [68.09148023]


portfolio before change:  [9.09783178]
curr_Stock_Price:  109.06289878445888
curr_Factors:  [109.06289878]
mat_Sqrt:  [[0.15]]
grads:  [0.06085758]
Stock Position:  0.060857577881118764
Bond Position:  [2.46052792]


portfolio before change:  [9.05176086]
curr_Stock_Price:  108.30081621435367
curr_Factors:  [108.30081621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.05176086]
Stock Price:  108.50861206426073
PL:  [0.5431488]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.45329072e-03]
 [-5.80557778e-03]
 [ 1.48092702e-02]
 [ 5.22932155e-04]
 [ 1.50639486e-02]
 [ 2.64466614e-02]
 [ 1.55600500e-02]
 [ 4.94464715e-03]
 [-1.04937283e-02]
 [-1.60197057e-03]
 [ 2.65996516e-02]
 [ 8.92353684e-03]
 [ 8.54898214e-04]
 [-4.18452812e-03]
 [ 4.28407452e-03]
 [ 2.78774383e-03]
 [ 9.11050715e-03]
 [ 1.08465366e-02]
 [ 1.16522769e-02]
 [-1.36680957e-02]
 [-1.70499635e-02]
 [ 1.75389483e-02]
 [-9.75301451e-04]
 [ 5.54666141e-03]
 [-7.19683490e-03]
 [-6.47336152e-03]
 [-9.86940536e-04]
 [-1.08289599e-02]
 [ 4.65192491e-03]
 [-9.25463670e-03]
 [-2.98402615e-03]
 [ 5.54355369e-03]
 [ 5.21611867e-03]
 [-8.87494520e-03]
 [ 1.83284776e-02]
 [ 5.48472127e-03]
 [ 2.41575536e-03]
 [ 8.91869844e-03]
 [-3.48832846e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.97275498]
curr_Stock_Price:  99.81131223809379
curr_Factors:  [99.81131224]
mat_Sqrt:  [[0.15]]
grads:  [0.01635527]
Stock Position:  0.016355271470524697
Bond Position:  [-2.60519609]


portfolio before change:  [-0.93741606]
curr_Stock_Price:  101.99192964316308
curr_Factors:  [101.99192964]
mat_Sqrt:  [[0.15]]
grads:  [-0.03870385]
Stock Position:  -0.038703851883755955
Bond Position:  [3.01006448]


portfolio before change:  [-0.92844212]
curr_Stock_Price:  101.76979011978898
curr_Factors:  [101.76979012]
mat_Sqrt:  [[0.15]]
grads:  [0.09872847]
Stock Position:  0.09872846782254446
Bond Position:  [-10.97601757]


portfolio before change:  [-0.99297895]
curr_Stock_Price:  101.13000765833881
curr_Factors:  [101.13000766]
mat_Sqrt:  [[0.15]]
grads:  [0.00348621]
Stock Position:  0.0034862143645424744
Bond Position:  [-1.34553984]


portfolio before change:  [-0.99400713]
curr_Stock_Price:  100.88333063227108
curr_Factors:  [100.88333063]
mat_Sqrt:  [[0.15]]
grads:  [0.10042632]
Stock Position:  0.10042632367027916
Bond Position:  [-11.12534914]


portfolio before change:  [-0.95267905]
curr_Stock_Price:  101.30870545084689
curr_Factors:  [101.30870545]
mat_Sqrt:  [[0.15]]
grads:  [0.17631108]
Stock Position:  0.17631107594815287
Bond Position:  [-18.81452591]


portfolio before change:  [-0.77359443]
curr_Stock_Price:  102.33777629803329
curr_Factors:  [102.3377763]
mat_Sqrt:  [[0.15]]
grads:  [0.10373367]
Stock Position:  0.10373366692544488
Bond Position:  [-11.38946723]


portfolio before change:  [-0.71041406]
curr_Stock_Price:  102.96056479942833
curr_Factors:  [102.9605648]
mat_Sqrt:  [[0.15]]
grads:  [0.03296431]
Stock Position:  0.03296431433779227
Bond Position:  [-4.10443849]


portfolio before change:  [-0.70228445]
curr_Stock_Price:  103.22274846179336
curr_Factors:  [103.22274846]
mat_Sqrt:  [[0.15]]
grads:  [-0.06995819]
Stock Position:  -0.06995818856079572
Bond Position:  [6.51899205]


portfolio before change:  [-0.78069561]
curr_Stock_Price:  104.35522615759378
curr_Factors:  [104.35522616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0106798]
Stock Position:  -0.010679803820754086
Bond Position:  [0.33379773]


portfolio before change:  [-0.78499669]
curr_Stock_Price:  104.76186350620043
curr_Factors:  [104.76186351]
mat_Sqrt:  [[0.15]]
grads:  [0.17733101]
Stock Position:  0.1773310107461977
Bond Position:  [-19.36252383]


portfolio before change:  [-0.88494943]
curr_Stock_Price:  104.21186226187871
curr_Factors:  [104.21186226]
mat_Sqrt:  [[0.15]]
grads:  [0.05949025]
Stock Position:  0.05949024557928836
Bond Position:  [-7.08453871]


portfolio before change:  [-0.86862653]
curr_Stock_Price:  104.50112867851138
curr_Factors:  [104.50112868]
mat_Sqrt:  [[0.15]]
grads:  [0.00569932]
Stock Position:  0.0056993214250270164
Bond Position:  [-1.46421205]


portfolio before change:  [-0.86848607]
curr_Stock_Price:  104.55788809596073
curr_Factors:  [104.5578881]
mat_Sqrt:  [[0.15]]
grads:  [-0.02789685]
Stock Position:  -0.027896854164984615
Bond Position:  [2.04835008]


portfolio before change:  [-0.85100992]
curr_Stock_Price:  103.94061077709353
curr_Factors:  [103.94061078]
mat_Sqrt:  [[0.15]]
grads:  [0.0285605]
Stock Position:  0.028560496814493772
Bond Position:  [-3.8196054]


portfolio before change:  [-0.86968627]
curr_Stock_Price:  103.3034066429527
curr_Factors:  [103.30340664]
mat_Sqrt:  [[0.15]]
grads:  [0.01858496]
Stock Position:  0.018584958847479943
Bond Position:  [-2.78957583]


portfolio before change:  [-0.869558]
curr_Stock_Price:  103.32907174859814
curr_Factors:  [103.32907175]
mat_Sqrt:  [[0.15]]
grads:  [0.06073671]
Stock Position:  0.060736714354492675
Bond Position:  [-7.14542631]


portfolio before change:  [-0.91369171]
curr_Stock_Price:  102.61713862791024
curr_Factors:  [102.61713863]
mat_Sqrt:  [[0.15]]
grads:  [0.07231024]
Stock Position:  0.07231024433289537
Bond Position:  [-8.33396208]


portfolio before change:  [-0.98053655]
curr_Stock_Price:  101.70712885479793
curr_Factors:  [101.70712885]
mat_Sqrt:  [[0.15]]
grads:  [0.07768185]
Stock Position:  0.07768184569161224
Bond Position:  [-8.88133404]


portfolio before change:  [-0.9891004]
curr_Stock_Price:  101.61117830636448
curr_Factors:  [101.61117831]
mat_Sqrt:  [[0.15]]
grads:  [-0.09112064]
Stock Position:  -0.09112063826209324
Bond Position:  [8.26977502]


portfolio before change:  [-0.92018316]
curr_Stock_Price:  100.86619390945339
curr_Factors:  [100.86619391]
mat_Sqrt:  [[0.15]]
grads:  [-0.11366642]
Stock Position:  -0.11366642306858597
Bond Position:  [10.54491631]


portfolio before change:  [-0.88689394]
curr_Stock_Price:  100.58492326271626
curr_Factors:  [100.58492326]
mat_Sqrt:  [[0.15]]
grads:  [0.11692632]
Stock Position:  0.11692632213371565
Bond Position:  [-12.64791908]


portfolio before change:  [-0.9127136]
curr_Stock_Price:  100.37762545082673
curr_Factors:  [100.37762545]
mat_Sqrt:  [[0.15]]
grads:  [-0.00650201]
Stock Position:  -0.006502009676481862
Bond Position:  [-0.26005731]


portfolio before change:  [-0.92060657]
curr_Stock_Price:  101.5865543841079
curr_Factors:  [101.58655438]
mat_Sqrt:  [[0.15]]
grads:  [0.03697774]
Stock Position:  0.03697774274099492
Bond Position:  [-4.67704805]


portfolio before change:  [-0.91282588]
curr_Stock_Price:  101.81278140868379
curr_Factors:  [101.81278141]
mat_Sqrt:  [[0.15]]
grads:  [-0.0479789]
Stock Position:  -0.047978899355258925
Bond Position:  [3.97203932]


portfolio before change:  [-0.91001525]
curr_Stock_Price:  101.76455007851577
curr_Factors:  [101.76455008]
mat_Sqrt:  [[0.15]]
grads:  [-0.04315574]
Stock Position:  -0.04315574345390004
Bond Position:  [3.48170956]


portfolio before change:  [-0.95670616]
curr_Stock_Price:  102.85655168566028
curr_Factors:  [102.85655169]
mat_Sqrt:  [[0.15]]
grads:  [-0.0065796]
Stock Position:  -0.006579603570781805
Bond Position:  [-0.27995082]


portfolio before change:  [-0.95663518]
curr_Stock_Price:  102.84044582686747
curr_Factors:  [102.84044583]
mat_Sqrt:  [[0.15]]
grads:  [-0.07219307]
Stock Position:  -0.0721930660027882
Bond Position:  [6.46773191]


portfolio before change:  [-0.87717748]
curr_Stock_Price:  101.75101736993123
curr_Factors:  [101.75101737]
mat_Sqrt:  [[0.15]]
grads:  [0.03101283]
Stock Position:  0.031012832756707246
Bond Position:  [-4.03276477]


portfolio before change:  [-0.90009887]
curr_Stock_Price:  101.02817908798356
curr_Factors:  [101.02817909]
mat_Sqrt:  [[0.15]]
grads:  [-0.06169758]
Stock Position:  -0.06169757798945415
Bond Position:  [5.33309508]


portfolio before change:  [-0.83097285]
curr_Stock_Price:  99.91858371901046
curr_Factors:  [99.91858372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989351]
Stock Position:  -0.01989350766487181
Bond Position:  [1.15675826]


portfolio before change:  [-0.82099341]
curr_Stock_Price:  99.42420951992666
curr_Factors:  [99.42420952]
mat_Sqrt:  [[0.15]]
grads:  [0.03695702]
Stock Position:  0.0369570246331832
Bond Position:  [-4.49541637]


portfolio before change:  [-0.79108497]
curr_Stock_Price:  100.2486915215435
curr_Factors:  [100.24869152]
mat_Sqrt:  [[0.15]]
grads:  [0.03477412]
Stock Position:  0.03477412446879127
Bond Position:  [-4.27714544]


portfolio before change:  [-0.75913258]
curr_Stock_Price:  101.18292264782333
curr_Factors:  [101.18292265]
mat_Sqrt:  [[0.15]]
grads:  [-0.0591663]
Stock Position:  -0.05916630131972923
Bond Position:  [5.22748671]


portfolio before change:  [-0.80256439]
curr_Stock_Price:  101.92803072521941
curr_Factors:  [101.92803073]
mat_Sqrt:  [[0.15]]
grads:  [0.12218985]
Stock Position:  0.12218985092752896
Bond Position:  [-13.25713527]


portfolio before change:  [-0.90290311]
curr_Stock_Price:  101.12042289278034
curr_Factors:  [101.12042289]
mat_Sqrt:  [[0.15]]
grads:  [0.03656481]
Stock Position:  0.036564808442628105
Bond Position:  [-4.60035201]


portfolio before change:  [-0.91254923]
curr_Stock_Price:  100.87234173370203
curr_Factors:  [100.87234173]
mat_Sqrt:  [[0.15]]
grads:  [0.01610504]
Stock Position:  0.016105035746921126
Bond Position:  [-2.5371019]


portfolio before change:  [-0.93508326]
curr_Stock_Price:  99.49284345729285
curr_Factors:  [99.49284346]
mat_Sqrt:  [[0.15]]
grads:  [0.05945799]
Stock Position:  0.05945798963241513
Bond Position:  [-6.85072771]


portfolio before change:  [-0.92734939]
curr_Stock_Price:  99.63731971324071
curr_Factors:  [99.63731971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.92734939]
Stock Price:  98.8691457298643
PL:  [-0.92734939]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.12446355e-03]
 [ 1.28178360e-03]
 [ 1.52439471e-02]
 [ 2.83681196e-02]
 [-2.72535605e-02]
 [ 3.39289948e-02]
 [ 2.54866204e-02]
 [ 2.59888143e-03]
 [-1.14826689e-02]
 [-2.50033588e-03]
 [ 2.34198604e-02]
 [ 7.52120449e-03]
 [ 7.05728647e-04]
 [-4.19161713e-03]
 [ 4.82890968e-03]
 [ 3.11199913e-03]
 [ 9.12113708e-03]
 [ 1.22089133e-03]
 [ 1.17108403e-02]
 [-1.59376999e-02]
 [ 1.36301886e-03]
 [ 2.91167891e-02]
 [-4.03018658e-02]
 [ 7.49073760e-03]
 [ 4.33141913e-03]
 [-9.71379227e-03]
 [-6.90070963e-04]
 [-1.06980450e-02]
 [ 5.18630542e-02]
 [-4.63057867e-03]
 [-2.49653336e-03]
 [ 4.94121082e-03]
 [ 5.26905013e-03]
 [-8.28335595e-03]
 [ 2.14466664e-02]
 [ 5.68355630e-03]
 [ 3.09057480e-03]
 [ 1.16419374e-02]
 [-2.73362915e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.68668466]
curr_Stock_Price:  99.5717289776539
curr_Factors:  [99.57172898]
mat_Sqrt:  [[0.15]]
grads:  [0.02749642]
Stock Position:  0.027496423651363656
Bond Position:  [-7.4245511]


portfolio before change:  [-4.64511119]
curr_Stock_Price:  101.11744258312017
curr_Factors:  [101.11744258]
mat_Sqrt:  [[0.15]]
grads:  [0.00854522]
Stock Position:  0.008545223996772693
Bond Position:  [-5.50918239]


portfolio before change:  [-4.64231675]
curr_Stock_Price:  101.52505388270676
curr_Factors:  [101.52505388]
mat_Sqrt:  [[0.15]]
grads:  [0.10162631]
Stock Position:  0.1016263140080917
Bond Position:  [-14.95993375]


portfolio before change:  [-4.39560727]
curr_Stock_Price:  103.97106986318619
curr_Factors:  [103.97106986]
mat_Sqrt:  [[0.15]]
grads:  [0.1891208]
Stock Position:  0.18912079711084284
Bond Position:  [-24.05869888]


portfolio before change:  [-4.42411569]
curr_Stock_Price:  103.83623066229019
curr_Factors:  [103.83623066]
mat_Sqrt:  [[0.15]]
grads:  [-0.1816904]
Stock Position:  -0.18169040314358897
Bond Position:  [14.44193092]


portfolio before change:  [-4.43490982]
curr_Stock_Price:  103.90557654679527
curr_Factors:  [103.90557655]
mat_Sqrt:  [[0.15]]
grads:  [0.2261933]
Stock Position:  0.22619329870258623
Bond Position:  [-27.93765493]


portfolio before change:  [-4.6760071]
curr_Stock_Price:  102.8551260750448
curr_Factors:  [102.85512608]
mat_Sqrt:  [[0.15]]
grads:  [0.1699108]
Stock Position:  0.16991080282327922
Bond Position:  [-22.15220415]


portfolio before change:  [-4.59949841]
curr_Stock_Price:  103.32171139711097
curr_Factors:  [103.3217114]
mat_Sqrt:  [[0.15]]
grads:  [0.01732588]
Stock Position:  0.017325876227140144
Bond Position:  [-6.3896376]


portfolio before change:  [-4.59138889]
curr_Stock_Price:  103.83587148454971
curr_Factors:  [103.83587148]
mat_Sqrt:  [[0.15]]
grads:  [-0.07655113]
Stock Position:  -0.076551125961839
Bond Position:  [3.35736398]


portfolio before change:  [-4.56985641]
curr_Stock_Price:  103.56007170916742
curr_Factors:  [103.56007171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01666891]
Stock Position:  -0.016668905862784134
Bond Position:  [-2.84362333]


portfolio before change:  [-4.58007485]
curr_Stock_Price:  104.15176957387351
curr_Factors:  [104.15176957]
mat_Sqrt:  [[0.15]]
grads:  [0.1561324]
Stock Position:  0.15613240261296438
Bond Position:  [-20.84154087]


portfolio before change:  [-4.74103907]
curr_Stock_Price:  103.13750945073456
curr_Factors:  [103.13750945]
mat_Sqrt:  [[0.15]]
grads:  [0.05014136]
Stock Position:  0.0501413632796005
Bond Position:  [-9.9124944]


portfolio before change:  [-4.6714604]
curr_Stock_Price:  104.54987252777488
curr_Factors:  [104.54987253]
mat_Sqrt:  [[0.15]]
grads:  [0.00470486]
Stock Position:  0.004704857647469876
Bond Position:  [-5.16335267]


portfolio before change:  [-4.67190144]
curr_Stock_Price:  104.59332184327897
curr_Factors:  [104.59332184]
mat_Sqrt:  [[0.15]]
grads:  [-0.02794411]
Stock Position:  -0.027944114216761688
Bond Position:  [-1.7491337]


portfolio before change:  [-4.65011476]
curr_Stock_Price:  103.80584525431222
curr_Factors:  [103.80584525]
mat_Sqrt:  [[0.15]]
grads:  [0.03219273]
Stock Position:  0.03219273122327035
Bond Position:  [-7.99190843]


portfolio before change:  [-4.65579417]
curr_Stock_Price:  103.66045961430582
curr_Factors:  [103.66045961]
mat_Sqrt:  [[0.15]]
grads:  [0.02074666]
Stock Position:  0.020746660867081757
Bond Position:  [-6.80640257]


portfolio before change:  [-4.65488708]
curr_Stock_Price:  103.74519322564441
curr_Factors:  [103.74519323]
mat_Sqrt:  [[0.15]]
grads:  [0.06080758]
Stock Position:  0.060807580562087286
Bond Position:  [-10.96338128]


portfolio before change:  [-4.63646562]
curr_Stock_Price:  104.07067855682338
curr_Factors:  [104.07067856]
mat_Sqrt:  [[0.15]]
grads:  [0.00813928]
Stock Position:  0.008139275504951948
Bond Position:  [-5.48352554]


portfolio before change:  [-4.64405295]
curr_Stock_Price:  103.22270932915863
curr_Factors:  [103.22270933]
mat_Sqrt:  [[0.15]]
grads:  [0.07807227]
Stock Position:  0.07807226868225936
Bond Position:  [-12.70288405]


portfolio before change:  [-4.60617216]
curr_Stock_Price:  103.72825060472934
curr_Factors:  [103.7282506]
mat_Sqrt:  [[0.15]]
grads:  [-0.10625133]
Stock Position:  -0.10625133297440674
Bond Position:  [6.41509273]


portfolio before change:  [-4.54392712]
curr_Stock_Price:  103.1499698769432
curr_Factors:  [103.14996988]
mat_Sqrt:  [[0.15]]
grads:  [0.00908679]
Stock Position:  0.00908679242790871
Bond Position:  [-5.48122949]


portfolio before change:  [-4.54387548]
curr_Stock_Price:  103.23105942762453
curr_Factors:  [103.23105943]
mat_Sqrt:  [[0.15]]
grads:  [0.19411193]
Stock Position:  0.1941119270571507
Bond Position:  [-24.58225535]


portfolio before change:  [-4.53757312]
curr_Stock_Price:  103.27935798477309
curr_Factors:  [103.27935798]
mat_Sqrt:  [[0.15]]
grads:  [-0.26867911]
Stock Position:  -0.26867910551031005
Bond Position:  [23.2114324]


portfolio before change:  [-4.66384461]
curr_Stock_Price:  103.76012888381041
curr_Factors:  [103.76012888]
mat_Sqrt:  [[0.15]]
grads:  [0.04993825]
Stock Position:  0.04993825064998371
Bond Position:  [-9.84544393]


portfolio before change:  [-4.68136269]
curr_Stock_Price:  103.43397966068872
curr_Factors:  [103.43397966]
mat_Sqrt:  [[0.15]]
grads:  [0.02887613]
Stock Position:  0.028876127500935725
Bond Position:  [-7.66813547]


portfolio before change:  [-4.68576858]
curr_Stock_Price:  103.31459673060277
curr_Factors:  [103.31459673]
mat_Sqrt:  [[0.15]]
grads:  [-0.06475862]
Stock Position:  -0.06475861515910479
Bond Position:  [2.00474163]


portfolio before change:  [-4.71765414]
curr_Stock_Price:  103.81084214252778
curr_Factors:  [103.81084214]
mat_Sqrt:  [[0.15]]
grads:  [-0.00460047]
Stock Position:  -0.004600473086800597
Bond Position:  [-4.24007515]


portfolio before change:  [-4.72009245]
curr_Stock_Price:  104.2256409751565
curr_Factors:  [104.22564098]
mat_Sqrt:  [[0.15]]
grads:  [-0.0713203]
Stock Position:  -0.07132030012589675
Bond Position:  [2.71331154]


portfolio before change:  [-4.68068333]
curr_Stock_Price:  103.67783140782228
curr_Factors:  [103.67783141]
mat_Sqrt:  [[0.15]]
grads:  [0.34575369]
Stock Position:  0.34575369442556814
Bond Position:  [-40.52767656]


portfolio before change:  [-4.29861932]
curr_Stock_Price:  104.79750211067201
curr_Factors:  [104.79750211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03087052]
Stock Position:  -0.030870524480738067
Bond Position:  [-1.06346546]


portfolio before change:  [-4.24373828]
curr_Stock_Price:  103.01541439473698
curr_Factors:  [103.01541439]
mat_Sqrt:  [[0.15]]
grads:  [-0.01664356]
Stock Position:  -0.016643555725018723
Bond Position:  [-2.52919549]


portfolio before change:  [-4.24438503]
curr_Stock_Price:  103.03527663793783
curr_Factors:  [103.03527664]
mat_Sqrt:  [[0.15]]
grads:  [0.03294141]
Stock Position:  0.032941405477473505
Bond Position:  [-7.63851185]


portfolio before change:  [-4.24242317]
curr_Stock_Price:  103.12381944938849
curr_Factors:  [103.12381945]
mat_Sqrt:  [[0.15]]
grads:  [0.035127]
Stock Position:  0.0351270008632582
Bond Position:  [-7.86485367]


portfolio before change:  [-4.30712241]
curr_Stock_Price:  101.30994208638808
curr_Factors:  [101.30994209]
mat_Sqrt:  [[0.15]]
grads:  [-0.05522237]
Stock Position:  -0.05522237298538432
Bond Position:  [1.28745299]


portfolio before change:  [-4.29019204]
curr_Stock_Price:  101.00627108658388
curr_Factors:  [101.00627109]
mat_Sqrt:  [[0.15]]
grads:  [0.14297778]
Stock Position:  0.1429777762174626
Bond Position:  [-18.73184406]


portfolio before change:  [-4.49206462]
curr_Stock_Price:  99.6107328780758
curr_Factors:  [99.61073288]
mat_Sqrt:  [[0.15]]
grads:  [0.03789038]
Stock Position:  0.037890375325825655
Bond Position:  [-8.26635267]


portfolio before change:  [-4.51543459]
curr_Stock_Price:  99.02122656039916
curr_Factors:  [99.02122656]
mat_Sqrt:  [[0.15]]
grads:  [0.02060383]
Stock Position:  0.020603832016240164
Bond Position:  [-6.55565131]


portfolio before change:  [-4.5476637]
curr_Stock_Price:  97.49677241405807
curr_Factors:  [97.49677241]
mat_Sqrt:  [[0.15]]
grads:  [0.07761292]
Stock Position:  0.0776129159846187
Bond Position:  [-12.1146725]


portfolio before change:  [-4.58984752]
curr_Stock_Price:  96.97276951310972
curr_Factors:  [96.97276951]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.58984752]
Stock Price:  98.64355414718068
PL:  [-4.58984752]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.07158293e-03]
 [ 3.46553163e-03]
 [ 1.53877710e-02]
 [ 4.86236091e-03]
 [ 1.43685546e-02]
 [ 2.80520998e-02]
 [ 3.75173145e-02]
 [ 9.67014970e-04]
 [-9.70963256e-03]
 [-2.85989883e-03]
 [ 1.18674312e-02]
 [ 4.17648014e-03]
 [ 1.01288749e-02]
 [-1.22170773e-03]
 [ 2.23891640e-02]
 [ 5.92896311e-04]
 [ 9.36213436e-03]
 [ 6.63860529e-03]
 [ 1.15528557e-02]
 [-1.25356552e-02]
 [ 8.77013018e-03]
 [ 8.27072578e-03]
 [ 1.00906411e-02]
 [ 6.15529847e-03]
 [-8.38732827e-03]
 [-7.97540795e-03]
 [ 1.02749930e-03]
 [-1.12507611e-02]
 [ 9.48233760e-03]
 [-9.77991692e-03]
 [-1.73860401e-03]
 [ 5.18237319e-03]
 [ 5.11346056e-03]
 [-5.83959548e-03]
 [ 1.07770096e-02]
 [ 4.92395592e-03]
 [-2.28589111e-02]
 [ 1.00311878e-02]
 [-1.11811887e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.44643756]
curr_Stock_Price:  99.71624590442481
curr_Factors:  [99.7162459]
mat_Sqrt:  [[0.15]]
grads:  [0.02047722]
Stock Position:  0.020477219555628187
Bond Position:  [-4.48834902]


portfolio before change:  [-2.42796256]
curr_Stock_Price:  100.64586843787943
curr_Factors:  [100.64586844]
mat_Sqrt:  [[0.15]]
grads:  [0.02310354]
Stock Position:  0.023103544223443823
Bond Position:  [-4.75323883]


portfolio before change:  [-2.41011531]
curr_Stock_Price:  101.44407666514478
curr_Factors:  [101.44407667]
mat_Sqrt:  [[0.15]]
grads:  [0.10258514]
Stock Position:  0.10258514022780232
Bond Position:  [-12.81677014]


portfolio before change:  [-2.38790534]
curr_Stock_Price:  101.67619768451414
curr_Factors:  [101.67619768]
mat_Sqrt:  [[0.15]]
grads:  [0.03241574]
Stock Position:  0.032415739375538766
Bond Position:  [-5.68381446]


portfolio before change:  [-2.39829356]
curr_Stock_Price:  101.37764838555756
curr_Factors:  [101.37764839]
mat_Sqrt:  [[0.15]]
grads:  [0.09579036]
Stock Position:  0.09579036418502863
Bond Position:  [-12.10929542]


portfolio before change:  [-2.32921554]
curr_Stock_Price:  102.11458861970216
curr_Factors:  [102.11458862]
mat_Sqrt:  [[0.15]]
grads:  [0.187014]
Stock Position:  0.1870139988817698
Bond Position:  [-21.4260731]


portfolio before change:  [-2.05213117]
curr_Stock_Price:  103.61053434340366
curr_Factors:  [103.61053434]
mat_Sqrt:  [[0.15]]
grads:  [0.25011543]
Stock Position:  0.25011542972194367
Bond Position:  [-27.9667245]


portfolio before change:  [-2.0603815]
curr_Stock_Price:  103.59152603471776
curr_Factors:  [103.59152603]
mat_Sqrt:  [[0.15]]
grads:  [0.00644677]
Stock Position:  0.0064467664679111174
Bond Position:  [-2.72821188]


portfolio before change:  [-2.06629586]
curr_Stock_Price:  102.72701443708915
curr_Factors:  [102.72701444]
mat_Sqrt:  [[0.15]]
grads:  [-0.06473088]
Stock Position:  -0.06473088375281133
Bond Position:  [4.58331457]


portfolio before change:  [-2.0990466]
curr_Stock_Price:  103.24181801235542
curr_Factors:  [103.24181801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01906599]
Stock Position:  -0.019065992201460314
Bond Position:  [-0.1306389]


portfolio before change:  [-2.07641547]
curr_Stock_Price:  102.05397211071657
curr_Factors:  [102.05397211]
mat_Sqrt:  [[0.15]]
grads:  [0.07911621]
Stock Position:  0.07911620817020351
Bond Position:  [-10.15053877]


portfolio before change:  [-2.17580588]
curr_Stock_Price:  100.81375190880854
curr_Factors:  [100.81375191]
mat_Sqrt:  [[0.15]]
grads:  [0.0278432]
Stock Position:  0.027843200926169685
Bond Position:  [-4.98278343]


portfolio before change:  [-2.15618176]
curr_Stock_Price:  101.54093171326693
curr_Factors:  [101.54093171]
mat_Sqrt:  [[0.15]]
grads:  [0.06752583]
Stock Position:  0.0675258328282239
Bond Position:  [-9.01281774]


portfolio before change:  [-2.19759756]
curr_Stock_Price:  100.94428407374261
curr_Factors:  [100.94428407]
mat_Sqrt:  [[0.15]]
grads:  [-0.00814472]
Stock Position:  -0.008144718231305026
Bond Position:  [-1.37543481]


portfolio before change:  [-2.20237673]
curr_Stock_Price:  101.50995507597916
curr_Factors:  [101.50995508]
mat_Sqrt:  [[0.15]]
grads:  [0.14926109]
Stock Position:  0.1492610930241393
Bond Position:  [-17.35386358]


portfolio before change:  [-2.34433911]
curr_Stock_Price:  100.57338810044665
curr_Factors:  [100.5733881]
mat_Sqrt:  [[0.15]]
grads:  [0.00395264]
Stock Position:  0.0039526420719278605
Bond Position:  [-2.74186971]


portfolio before change:  [-2.34529509]
curr_Stock_Price:  100.41824507682462
curr_Factors:  [100.41824508]
mat_Sqrt:  [[0.15]]
grads:  [0.06241423]
Stock Position:  0.0624142290886478
Bond Position:  [-8.61282244]


portfolio before change:  [-2.37778199]
curr_Stock_Price:  99.91499074282154
curr_Factors:  [99.91499074]
mat_Sqrt:  [[0.15]]
grads:  [0.04425737]
Stock Position:  0.04425736856904071
Bond Position:  [-6.79975656]


portfolio before change:  [-2.37516249]
curr_Stock_Price:  99.99338505120583
curr_Factors:  [99.99338505]
mat_Sqrt:  [[0.15]]
grads:  [0.07701904]
Stock Position:  0.07701903785296578
Bond Position:  [-10.07655679]


portfolio before change:  [-2.38608488]
curr_Stock_Price:  99.86792589912217
curr_Factors:  [99.8679259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357103]
Stock Position:  -0.08357103496743454
Bond Position:  [5.95998105]


portfolio before change:  [-2.30138209]
curr_Stock_Price:  98.86329857478276
curr_Factors:  [98.86329857]
mat_Sqrt:  [[0.15]]
grads:  [0.05846753]
Stock Position:  0.05846753453530757
Bond Position:  [-8.08167541]


portfolio before change:  [-2.28038976]
curr_Stock_Price:  99.23962033728361
curr_Factors:  [99.23962034]
mat_Sqrt:  [[0.15]]
grads:  [0.05513817]
Stock Position:  0.05513817188580384
Bond Position:  [-7.752281]


portfolio before change:  [-2.24289018]
curr_Stock_Price:  99.9372979171171
curr_Factors:  [99.93729792]
mat_Sqrt:  [[0.15]]
grads:  [0.06727094]
Stock Position:  0.06727094086450477
Bond Position:  [-8.96576624]


portfolio before change:  [-2.201861]
curr_Stock_Price:  100.56386824002612
curr_Factors:  [100.56386824]
mat_Sqrt:  [[0.15]]
grads:  [0.04103532]
Stock Position:  0.04103532312473959
Bond Position:  [-6.32853183]


portfolio before change:  [-2.17463647]
curr_Stock_Price:  101.24658855241839
curr_Factors:  [101.24658855]
mat_Sqrt:  [[0.15]]
grads:  [-0.05591552]
Stock Position:  -0.05591552178906979
Bond Position:  [3.48661936]


portfolio before change:  [-2.14591201]
curr_Stock_Price:  100.74067170044765
curr_Factors:  [100.7406717]
mat_Sqrt:  [[0.15]]
grads:  [-0.05316939]
Stock Position:  -0.0531693863590664
Bond Position:  [3.21040769]


portfolio before change:  [-2.16273587]
curr_Stock_Price:  101.06463984977584
curr_Factors:  [101.06463985]
mat_Sqrt:  [[0.15]]
grads:  [0.00685]
Stock Position:  0.006849995317999258
Bond Position:  [-2.85502818]


portfolio before change:  [-2.16160562]
curr_Stock_Price:  101.28174247994855
curr_Factors:  [101.28174248]
mat_Sqrt:  [[0.15]]
grads:  [-0.07500507]
Stock Position:  -0.07500507419816255
Bond Position:  [5.43503899]


portfolio before change:  [-2.20468703]
curr_Stock_Price:  101.86518078581025
curr_Factors:  [101.86518079]
mat_Sqrt:  [[0.15]]
grads:  [0.06321558]
Stock Position:  0.06321558397673897
Bond Position:  [-8.64415392]


portfolio before change:  [-2.24225369]
curr_Stock_Price:  101.28801188516442
curr_Factors:  [101.28801189]
mat_Sqrt:  [[0.15]]
grads:  [-0.06519945]
Stock Position:  -0.06519944613583614
Bond Position:  [4.36166859]


portfolio before change:  [-2.21205885]
curr_Stock_Price:  100.83325963273288
curr_Factors:  [100.83325963]
mat_Sqrt:  [[0.15]]
grads:  [-0.01159069]
Stock Position:  -0.011590693385896671
Bond Position:  [-1.04333145]


portfolio before change:  [-2.21864272]
curr_Stock_Price:  101.39003814134655
curr_Factors:  [101.39003814]
mat_Sqrt:  [[0.15]]
grads:  [0.03454915]
Stock Position:  0.034549154604401604
Bond Position:  [-5.72158282]


portfolio before change:  [-2.22710264]
curr_Stock_Price:  101.1658740725572
curr_Factors:  [101.16587407]
mat_Sqrt:  [[0.15]]
grads:  [0.03408974]
Stock Position:  0.03408973708424639
Bond Position:  [-5.67582069]


portfolio before change:  [-2.20146777]
curr_Stock_Price:  101.93866970664291
curr_Factors:  [101.93866971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03893064]
Stock Position:  -0.03893063654040262
Bond Position:  [1.76706953]


portfolio before change:  [-2.24880179]
curr_Stock_Price:  103.16019931973904
curr_Factors:  [103.16019932]
mat_Sqrt:  [[0.15]]
grads:  [0.07184673]
Stock Position:  0.07184673093664187
Bond Position:  [-9.66052488]


portfolio before change:  [-2.20300024]
curr_Stock_Price:  103.8144976469026
curr_Factors:  [103.81449765]
mat_Sqrt:  [[0.15]]
grads:  [0.03282637]
Stock Position:  0.03282637281441451
Bond Position:  [-5.61085364]


portfolio before change:  [-2.17003905]
curr_Stock_Price:  104.83997170651281
curr_Factors:  [104.83997171]
mat_Sqrt:  [[0.15]]
grads:  [-0.15239274]
Stock Position:  -0.15239274053835827
Bond Position:  [13.80681156]


portfolio before change:  [-2.16384545]
curr_Stock_Price:  104.81065511383737
curr_Factors:  [104.81065511]
mat_Sqrt:  [[0.15]]
grads:  [0.06687459]
Stock Position:  0.06687458548622847
Bond Position:  [-9.17301457]


portfolio before change:  [-2.15762738]
curr_Stock_Price:  104.92078314127274
curr_Factors:  [104.92078314]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.15762738]
Stock Price:  105.12408659796488
PL:  [-7.28171398]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.10539047e-02]
 [-1.52050502e-02]
 [-2.74672220e-02]
 [ 1.12710132e-02]
 [-1.07599190e-01]
 [-4.15332746e-02]
 [-2.10826757e-02]
 [ 1.18544591e-02]
 [-6.51316679e-03]
 [ 5.01271154e-03]
 [-1.22094456e-02]
 [ 7.74138417e-03]
 [ 1.38577659e-02]
 [-4.53871793e-03]
 [-1.94949122e-02]
 [-1.34108880e-02]
 [ 2.64491350e-02]
 [-4.35074683e-02]
 [ 3.67349056e-04]
 [ 8.20054940e-03]
 [ 2.72692811e-02]
 [ 1.53466632e-03]
 [ 3.49542627e-02]
 [-1.32510907e-03]
 [ 1.05804829e-02]
 [ 3.41459912e-03]
 [ 2.54808543e-02]
 [-2.28668541e-02]
 [-4.75743464e-02]
 [ 7.13579661e-04]
 [-4.05186791e-03]
 [ 5.60282532e-03]
 [ 1.05782211e-02]
 [-1.26504343e-02]
 [ 4.30868536e-03]
 [ 5.71563905e-03]
 [ 3.35396796e-03]
 [ 8.37285698e-03]
 [-1.12228207e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.20498101]
curr_Stock_Price:  98.37712536235605
curr_Factors:  [98.37712536]
mat_Sqrt:  [[0.15]]
grads:  [0.0736927]
Stock Position:  0.0736926981067263
Bond Position:  [-30.45465681]


portfolio before change:  [-23.26977816]
curr_Stock_Price:  97.54949826686013
curr_Factors:  [97.54949827]
mat_Sqrt:  [[0.15]]
grads:  [-0.101367]
Stock Position:  -0.1013670010448063
Bond Position:  [-13.38147806]


portfolio before change:  [-23.26112637]
curr_Stock_Price:  97.4476448173607
curr_Factors:  [97.44764482]
mat_Sqrt:  [[0.15]]
grads:  [-0.18311481]
Stock Position:  -0.18311481347968944
Bond Position:  [-5.41701906]


portfolio before change:  [-23.11667195]
curr_Stock_Price:  96.65507331445434
curr_Factors:  [96.65507331]
mat_Sqrt:  [[0.15]]
grads:  [0.07514009]
Stock Position:  0.07514008776413254
Bond Position:  [-30.37934265]


portfolio before change:  [-23.20565442]
curr_Stock_Price:  95.52139339903962
curr_Factors:  [95.5213934]
mat_Sqrt:  [[0.15]]
grads:  [-0.71732793]
Stock Position:  -0.7173279308783723
Bond Position:  [45.31450906]


portfolio before change:  [-22.86244329]
curr_Stock_Price:  95.05083252597355
curr_Factors:  [95.05083253]
mat_Sqrt:  [[0.15]]
grads:  [-0.2768885]
Stock Position:  -0.2768884971994279
Bond Position:  [3.45603888]


portfolio before change:  [-22.85620656]
curr_Stock_Price:  95.02986848990558
curr_Factors:  [95.02986849]
mat_Sqrt:  [[0.15]]
grads:  [-0.14055117]
Stock Position:  -0.14055117110015972
Bond Position:  [-9.49964725]


portfolio before change:  [-23.06137778]
curr_Stock_Price:  96.4811811187558
curr_Factors:  [96.48118112]
mat_Sqrt:  [[0.15]]
grads:  [0.07902973]
Stock Position:  0.0790297273126604
Bond Position:  [-30.68625921]


portfolio before change:  [-23.0918928]
curr_Stock_Price:  96.14359937058401
curr_Factors:  [96.14359937]
mat_Sqrt:  [[0.15]]
grads:  [-0.04342111]
Stock Position:  -0.04342111192951807
Bond Position:  [-18.91723081]


portfolio before change:  [-23.11528886]
curr_Stock_Price:  96.6279549617321
curr_Factors:  [96.62795496]
mat_Sqrt:  [[0.15]]
grads:  [0.03341808]
Stock Position:  0.03341807690647332
Bond Position:  [-26.34440929]


portfolio before change:  [-23.13875047]
curr_Stock_Price:  96.0244385941673
curr_Factors:  [96.02443859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0813963]
Stock Position:  -0.08139630390189842
Bond Position:  [-15.32271608]


portfolio before change:  [-23.03155176]
curr_Stock_Price:  94.6839088368902
curr_Factors:  [94.68390884]
mat_Sqrt:  [[0.15]]
grads:  [0.05160923]
Stock Position:  0.05160922780089599
Bond Position:  [-27.91811518]


portfolio before change:  [-23.0537388]
curr_Stock_Price:  94.3216275635638
curr_Factors:  [94.32162756]
mat_Sqrt:  [[0.15]]
grads:  [0.09238511]
Stock Position:  0.09238510623568334
Bond Position:  [-31.76765238]


portfolio before change:  [-23.14273844]
curr_Stock_Price:  93.40125805099886
curr_Factors:  [93.40125805]
mat_Sqrt:  [[0.15]]
grads:  [-0.03025812]
Stock Position:  -0.030258119557801846
Bond Position:  [-20.31659201]


portfolio before change:  [-23.11349222]
curr_Stock_Price:  92.35076474509749
curr_Factors:  [92.35076475]
mat_Sqrt:  [[0.15]]
grads:  [-0.12996608]
Stock Position:  -0.12996608157804143
Bond Position:  [-11.1110252]


portfolio before change:  [-23.27110906]
curr_Stock_Price:  93.5528312602155
curr_Factors:  [93.55283126]
mat_Sqrt:  [[0.15]]
grads:  [-0.08940592]
Stock Position:  -0.0894059202725322
Bond Position:  [-14.90693209]


portfolio before change:  [-23.2531681]
curr_Stock_Price:  93.33131973449234
curr_Factors:  [93.33131973]
mat_Sqrt:  [[0.15]]
grads:  [0.17632757]
Stock Position:  0.17632756683094436
Bond Position:  [-39.71005262]


portfolio before change:  [-23.13109701]
curr_Stock_Price:  94.05176949906912
curr_Factors:  [94.0517695]
mat_Sqrt:  [[0.15]]
grads:  [-0.29004979]
Stock Position:  -0.29004978891310984
Bond Position:  [4.14859888]


portfolio before change:  [-23.19691133]
curr_Stock_Price:  94.28046444027277
curr_Factors:  [94.28046444]
mat_Sqrt:  [[0.15]]
grads:  [0.00244899]
Stock Position:  0.0024489937038832516
Bond Position:  [-23.42780359]


portfolio before change:  [-23.19985109]
curr_Stock_Price:  94.2759300865477
curr_Factors:  [94.27593009]
mat_Sqrt:  [[0.15]]
grads:  [0.05467033]
Stock Position:  0.05467032935061932
Bond Position:  [-28.35394724]


portfolio before change:  [-23.20149081]
curr_Stock_Price:  94.3107705716497
curr_Factors:  [94.31077057]
mat_Sqrt:  [[0.15]]
grads:  [0.18179521]
Stock Position:  0.181795207369317
Bond Position:  [-40.34673691]


portfolio before change:  [-23.35583662]
curr_Stock_Price:  93.48950499344033
curr_Factors:  [93.48950499]
mat_Sqrt:  [[0.15]]
grads:  [0.01023111]
Stock Position:  0.01023110881076067
Bond Position:  [-24.31233791]


portfolio before change:  [-23.36177921]
curr_Stock_Price:  93.20572715495072
curr_Factors:  [93.20572715]
mat_Sqrt:  [[0.15]]
grads:  [0.23302842]
Stock Position:  0.23302841825759313
Bond Position:  [-45.08136238]


portfolio before change:  [-23.31962394]
curr_Stock_Price:  93.41081282754969
curr_Factors:  [93.41081283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00883406]
Stock Position:  -0.00883406049161194
Bond Position:  [-22.49442717]


portfolio before change:  [-23.32991457]
curr_Stock_Price:  94.25738197146337
curr_Factors:  [94.25738197]
mat_Sqrt:  [[0.15]]
grads:  [0.07053655]
Stock Position:  0.07053655261277532
Bond Position:  [-29.97850535]


portfolio before change:  [-23.26832842]
curr_Stock_Price:  95.1836207545902
curr_Factors:  [95.18362075]
mat_Sqrt:  [[0.15]]
grads:  [0.02276399]
Stock Position:  0.02276399415028698
Bond Position:  [-25.43508781]


portfolio before change:  [-23.26460711]
curr_Stock_Price:  95.48677049293379
curr_Factors:  [95.48677049]
mat_Sqrt:  [[0.15]]
grads:  [0.16987236]
Stock Position:  0.16987236178994444
Bond Position:  [-39.48517033]


portfolio before change:  [-23.29208229]
curr_Stock_Price:  95.35408720676637
curr_Factors:  [95.35408721]
mat_Sqrt:  [[0.15]]
grads:  [-0.15244569]
Stock Position:  -0.152445693692538
Bond Position:  [-8.75576232]


portfolio before change:  [-23.26142707]
curr_Stock_Price:  95.1458179582547
curr_Factors:  [95.14581796]
mat_Sqrt:  [[0.15]]
grads:  [-0.31716231]
Stock Position:  -0.3171623091018892
Bond Position:  [6.91524025]


portfolio before change:  [-23.54853705]
curr_Stock_Price:  96.05378975717632
curr_Factors:  [96.05378976]
mat_Sqrt:  [[0.15]]
grads:  [0.0047572]
Stock Position:  0.004757197740079472
Bond Position:  [-24.00548392]


portfolio before change:  [-23.5483576]
curr_Stock_Price:  96.72231774079354
curr_Factors:  [96.72231774]
mat_Sqrt:  [[0.15]]
grads:  [-0.02701245]
Stock Position:  -0.027012452764722812
Bond Position:  [-20.93565056]


portfolio before change:  [-23.56151524]
curr_Stock_Price:  97.11252725551766
curr_Factors:  [97.11252726]
mat_Sqrt:  [[0.15]]
grads:  [0.03735217]
Stock Position:  0.03735216877057626
Bond Position:  [-27.18887874]


portfolio before change:  [-23.57506034]
curr_Stock_Price:  96.84088899962832
curr_Factors:  [96.840889]
mat_Sqrt:  [[0.15]]
grads:  [0.07052147]
Stock Position:  0.07052147387401132
Bond Position:  [-30.40442256]


portfolio before change:  [-23.54127885]
curr_Stock_Price:  97.37380860511594
curr_Factors:  [97.37380861]
mat_Sqrt:  [[0.15]]
grads:  [-0.08433623]
Stock Position:  -0.08433622884258617
Bond Position:  [-15.32913905]


portfolio before change:  [-23.60219062]
curr_Stock_Price:  98.07333605167555
curr_Factors:  [98.07333605]
mat_Sqrt:  [[0.15]]
grads:  [0.02872457]
Stock Position:  0.028724569082041244
Bond Position:  [-26.41930494]


portfolio before change:  [-23.5813804]
curr_Stock_Price:  98.91278595479773
curr_Factors:  [98.91278595]
mat_Sqrt:  [[0.15]]
grads:  [0.03810426]
Stock Position:  0.03810426034502948
Bond Position:  [-27.35037895]


portfolio before change:  [-23.5946381]
curr_Stock_Price:  98.65458153226359
curr_Factors:  [98.65458153]
mat_Sqrt:  [[0.15]]
grads:  [0.02235979]
Stock Position:  0.022359786423135568
Bond Position:  [-25.80053348]


portfolio before change:  [-23.56915697]
curr_Stock_Price:  99.93842212863808
curr_Factors:  [99.93842213]
mat_Sqrt:  [[0.15]]
grads:  [0.05581905]
Stock Position:  0.055819046566351664
Bond Position:  [-29.14762441]


portfolio before change:  [-23.50955625]
curr_Stock_Price:  101.07144758026863
curr_Factors:  [101.07144758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.50955625]
Stock Price:  101.90583020635528
PL:  [-25.41538646]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.41266501e-03]
 [-1.26277537e-02]
 [ 5.53943404e-03]
 [-2.81671047e-03]
 [ 1.49300503e-02]
 [ 2.59456702e-02]
 [-7.31684679e-03]
 [ 2.34698324e-02]
 [-5.84917951e-03]
 [ 4.64736246e-03]
 [ 1.55806961e-03]
 [ 4.59412325e-03]
 [ 1.22094916e-02]
 [-5.36069617e-03]
 [ 2.42502585e-02]
 [-5.52974045e-04]
 [ 1.04245339e-02]
 [-6.79884160e-03]
 [ 7.11419195e-03]
 [-4.11545031e-03]
 [ 1.66096601e-02]
 [ 3.41012996e-03]
 [ 1.18704250e-02]
 [ 6.10025066e-03]
 [ 1.34702179e-02]
 [-1.08664471e-02]
 [ 9.64819115e-03]
 [-1.24851013e-02]
 [-2.19388587e-02]
 [-1.36440267e-03]
 [-3.57267191e-03]
 [ 5.63246157e-03]
 [ 8.96677921e-03]
 [-1.27262058e-02]
 [ 9.03712959e-03]
 [ 5.71225658e-03]
 [ 3.56805151e-03]
 [ 1.00953213e-02]
 [-1.41832427e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.58949252]
curr_Stock_Price:  99.97660120793034
curr_Factors:  [99.97660121]
mat_Sqrt:  [[0.15]]
grads:  [0.0227511]
Stock Position:  0.02275110007482528
Bond Position:  [-0.68508514]


portfolio before change:  [1.55321102]
curr_Stock_Price:  98.38565125159633
curr_Factors:  [98.38565125]
mat_Sqrt:  [[0.15]]
grads:  [-0.08418502]
Stock Position:  -0.08418502448534473
Bond Position:  [9.83580948]


portfolio before change:  [1.44698311]
curr_Stock_Price:  99.66209515980556
curr_Factors:  [99.66209516]
mat_Sqrt:  [[0.15]]
grads:  [0.03692956]
Stock Position:  0.03692956029313303
Bond Position:  [-2.23349424]


portfolio before change:  [1.46942955]
curr_Stock_Price:  100.27747347030571
curr_Factors:  [100.27747347]
mat_Sqrt:  [[0.15]]
grads:  [-0.01877807]
Stock Position:  -0.018778069816927003
Bond Position:  [3.35244695]


portfolio before change:  [1.45618823]
curr_Stock_Price:  101.004939579588
curr_Factors:  [101.00493958]
mat_Sqrt:  [[0.15]]
grads:  [0.09953367]
Stock Position:  0.09953366851104183
Bond Position:  [-8.59720395]


portfolio before change:  [1.43064883]
curr_Stock_Price:  100.75914652529006
curr_Factors:  [100.75914653]
mat_Sqrt:  [[0.15]]
grads:  [0.17297113]
Stock Position:  0.1729711348789417
Bond Position:  [-15.9977751]


portfolio before change:  [1.21093545]
curr_Stock_Price:  99.50047681950578
curr_Factors:  [99.50047682]
mat_Sqrt:  [[0.15]]
grads:  [-0.04877898]
Stock Position:  -0.04877897862227856
Bond Position:  [6.06446708]


portfolio before change:  [1.2243418]
curr_Stock_Price:  99.24117987149641
curr_Factors:  [99.24117987]
mat_Sqrt:  [[0.15]]
grads:  [0.15646555]
Stock Position:  0.15646554956753958
Bond Position:  [-14.30348395]


portfolio before change:  [1.20499591]
curr_Stock_Price:  99.12896449949882
curr_Factors:  [99.1289645]
mat_Sqrt:  [[0.15]]
grads:  [-0.03899453]
Stock Position:  -0.038994530093706646
Bond Position:  [5.0704833]


portfolio before change:  [1.19444631]
curr_Stock_Price:  99.41575974683613
curr_Factors:  [99.41575975]
mat_Sqrt:  [[0.15]]
grads:  [0.03098242]
Stock Position:  0.030982416406950663
Bond Position:  [-1.88569415]


portfolio before change:  [1.17794569]
curr_Stock_Price:  98.89078797581806
curr_Factors:  [98.89078798]
mat_Sqrt:  [[0.15]]
grads:  [0.01038713]
Stock Position:  0.010387130740554735
Bond Position:  [0.15075415]


portfolio before change:  [1.18679378]
curr_Stock_Price:  99.74080526589515
curr_Factors:  [99.74080527]
mat_Sqrt:  [[0.15]]
grads:  [0.03062749]
Stock Position:  0.03062748835518633
Bond Position:  [-1.86801657]


portfolio before change:  [1.22285007]
curr_Stock_Price:  100.9256822200833
curr_Factors:  [100.92568222]
mat_Sqrt:  [[0.15]]
grads:  [0.08139661]
Stock Position:  0.08139661066197494
Bond Position:  [-6.99215839]


portfolio before change:  [1.2938372]
curr_Stock_Price:  101.80853473007959
curr_Factors:  [101.80853473]
mat_Sqrt:  [[0.15]]
grads:  [-0.03573797]
Stock Position:  -0.03573797443745725
Bond Position:  [4.93226801]


portfolio before change:  [1.32643902]
curr_Stock_Price:  100.9135414188278
curr_Factors:  [100.91354142]
mat_Sqrt:  [[0.15]]
grads:  [0.16166839]
Stock Position:  0.16166838978867581
Bond Position:  [-14.98809073]


portfolio before change:  [1.21134645]
curr_Stock_Price:  100.21322552913196
curr_Factors:  [100.21322553]
mat_Sqrt:  [[0.15]]
grads:  [-0.00368649]
Stock Position:  -0.0036864936315647
Bond Position:  [1.58078186]


portfolio before change:  [1.21379031]
curr_Stock_Price:  99.60390566733236
curr_Factors:  [99.60390567]
mat_Sqrt:  [[0.15]]
grads:  [0.06949689]
Stock Position:  0.06949689260424739
Bond Position:  [-5.70837163]


portfolio before change:  [1.13773057]
curr_Stock_Price:  98.51974001699082
curr_Factors:  [98.51974002]
mat_Sqrt:  [[0.15]]
grads:  [-0.04532561]
Stock Position:  -0.04532561068885478
Bond Position:  [5.60319796]


portfolio before change:  [1.15211042]
curr_Stock_Price:  98.217937011525
curr_Factors:  [98.21793701]
mat_Sqrt:  [[0.15]]
grads:  [0.04742795]
Stock Position:  0.04742794631694324
Bond Position:  [-3.50616462]


portfolio before change:  [1.12253237]
curr_Stock_Price:  97.60353650502208
curr_Factors:  [97.60353651]
mat_Sqrt:  [[0.15]]
grads:  [-0.02743634]
Stock Position:  -0.02743633539739369
Bond Position:  [3.80041573]


portfolio before change:  [1.11443211]
curr_Stock_Price:  97.91609080790342
curr_Factors:  [97.91609081]
mat_Sqrt:  [[0.15]]
grads:  [0.11073107]
Stock Position:  0.11073106766186447
Bond Position:  [-9.72792117]


portfolio before change:  [1.19064742]
curr_Stock_Price:  98.61536499122823
curr_Factors:  [98.61536499]
mat_Sqrt:  [[0.15]]
grads:  [0.0227342]
Stock Position:  0.022734199713049855
Bond Position:  [-1.05129398]


portfolio before change:  [1.21881698]
curr_Stock_Price:  99.86022875659891
curr_Factors:  [99.86022876]
mat_Sqrt:  [[0.15]]
grads:  [0.07913617]
Stock Position:  0.07913616646894692
Bond Position:  [-6.68373871]


portfolio before change:  [1.26649833]
curr_Stock_Price:  100.47330957539482
curr_Factors:  [100.47330958]
mat_Sqrt:  [[0.15]]
grads:  [0.04066834]
Stock Position:  0.04066833776436121
Bond Position:  [-2.81958416]


portfolio before change:  [1.18691752]
curr_Stock_Price:  98.52515188122103
curr_Factors:  [98.52515188]
mat_Sqrt:  [[0.15]]
grads:  [0.08980145]
Stock Position:  0.08980145272898445
Bond Position:  [-7.66078425]


portfolio before change:  [1.1906873]
curr_Stock_Price:  98.57779509768277
curr_Factors:  [98.5777951]
mat_Sqrt:  [[0.15]]
grads:  [-0.07244298]
Stock Position:  -0.07244298066990472
Bond Position:  [8.33195661]


portfolio before change:  [1.12828082]
curr_Stock_Price:  99.45362926853694
curr_Factors:  [99.45362927]
mat_Sqrt:  [[0.15]]
grads:  [0.06432127]
Stock Position:  0.06432127433533551
Bond Position:  [-5.26870335]


portfolio before change:  [1.05063232]
curr_Stock_Price:  98.25667110786124
curr_Factors:  [98.25667111]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323401]
Stock Position:  -0.08323400839356399
Bond Position:  [9.22892891]


portfolio before change:  [1.06196586]
curr_Stock_Price:  98.13436711336146
curr_Factors:  [98.13436711]
mat_Sqrt:  [[0.15]]
grads:  [-0.14625906]
Stock Position:  -0.14625905818902743
Bond Position:  [15.41500597]


portfolio before change:  [1.08526002]
curr_Stock_Price:  97.98827588116704
curr_Factors:  [97.98827588]
mat_Sqrt:  [[0.15]]
grads:  [-0.00909602]
Stock Position:  -0.009096017810112315
Bond Position:  [1.97656312]


portfolio before change:  [1.07933223]
curr_Stock_Price:  98.66713084372107
curr_Factors:  [98.66713084]
mat_Sqrt:  [[0.15]]
grads:  [-0.02381781]
Stock Position:  -0.02381781272908458
Bond Position:  [3.42936748]


portfolio before change:  [1.07380581]
curr_Stock_Price:  98.91715887582764
curr_Factors:  [98.91715888]
mat_Sqrt:  [[0.15]]
grads:  [0.03754974]
Stock Position:  0.037549743799698755
Bond Position:  [-2.64050817]


portfolio before change:  [1.02423081]
curr_Stock_Price:  97.60570094316277
curr_Factors:  [97.60570094]
mat_Sqrt:  [[0.15]]
grads:  [0.05977853]
Stock Position:  0.05977852809186237
Bond Position:  [-4.81049432]


portfolio before change:  [1.05264947]
curr_Stock_Price:  98.09115965504606
curr_Factors:  [98.09115966]
mat_Sqrt:  [[0.15]]
grads:  [-0.08484137]
Stock Position:  -0.08484137186680847
Bond Position:  [9.37483802]


portfolio before change:  [0.99382906]
curr_Stock_Price:  98.79827150310042
curr_Factors:  [98.7982715]
mat_Sqrt:  [[0.15]]
grads:  [0.06024753]
Stock Position:  0.0602475306181054
Bond Position:  [-4.95852283]


portfolio before change:  [0.94405699]
curr_Stock_Price:  97.98243369606845
curr_Factors:  [97.9824337]
mat_Sqrt:  [[0.15]]
grads:  [0.03808171]
Stock Position:  0.03808171051275585
Bond Position:  [-2.78728168]


portfolio before change:  [0.94445112]
curr_Stock_Price:  98.00193269376842
curr_Factors:  [98.00193269]
mat_Sqrt:  [[0.15]]
grads:  [0.02378701]
Stock Position:  0.023787010093822437
Bond Position:  [-1.38672185]


portfolio before change:  [0.96303766]
curr_Stock_Price:  98.79059415256414
curr_Factors:  [98.79059415]
mat_Sqrt:  [[0.15]]
grads:  [0.06730214]
Stock Position:  0.06730214194121559
Bond Position:  [-5.68578093]


portfolio before change:  [0.93085767]
curr_Stock_Price:  98.32301280034959
curr_Factors:  [98.3230128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.93085767]
Stock Price:  98.12691954544458
PL:  [0.93085767]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.34097988e-03]
 [ 2.65084680e-03]
 [ 8.26936679e-03]
 [-2.84626702e-03]
 [ 1.49567697e-02]
 [ 2.61908880e-02]
 [ 1.57407851e-03]
 [ 1.09446955e-02]
 [-6.69015970e-03]
 [-6.60503284e-04]
 [ 3.28608037e-03]
 [ 5.54422017e-03]
 [ 1.40842253e-02]
 [-1.27248001e-03]
 [ 2.10256662e-02]
 [ 1.89726054e-03]
 [ 8.88702515e-03]
 [ 6.38852401e-03]
 [ 1.20712749e-02]
 [-1.69744009e-02]
 [ 1.08601981e-02]
 [ 3.80243206e-02]
 [-1.43910497e-02]
 [ 7.78835028e-03]
 [ 6.54546508e-03]
 [-1.17756635e-02]
 [ 1.90197192e-04]
 [-1.14002106e-02]
 [ 6.57711479e-02]
 [-3.00604630e-03]
 [-8.14396802e-03]
 [ 4.53619848e-03]
 [ 5.98391387e-03]
 [ 4.35349482e-04]
 [ 7.72298800e-03]
 [ 3.78382617e-03]
 [-4.03735650e-02]
 [ 9.86104196e-03]
 [-7.24381652e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.7313401]
curr_Stock_Price:  99.37532017572372
curr_Factors:  [99.37532018]
mat_Sqrt:  [[0.15]]
grads:  [0.03560653]
Stock Position:  0.0356065325189705
Bond Position:  [-11.26975067]


portfolio before change:  [-7.71832777]
curr_Stock_Price:  99.78033393959852
curr_Factors:  [99.78033394]
mat_Sqrt:  [[0.15]]
grads:  [0.01767231]
Stock Position:  0.0176723119714493
Bond Position:  [-9.48167696]


portfolio before change:  [-7.71189041]
curr_Stock_Price:  100.2116664407079
curr_Factors:  [100.21166644]
mat_Sqrt:  [[0.15]]
grads:  [0.05512911]
Stock Position:  0.055129111937519994
Bond Position:  [-13.23647059]


portfolio before change:  [-7.71230647]
curr_Stock_Price:  100.2341337804722
curr_Factors:  [100.23413378]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897511]
Stock Position:  -0.01897511346999973
Bond Position:  [-5.81035241]


portfolio before change:  [-7.72719847]
curr_Stock_Price:  100.98067247708809
curr_Factors:  [100.98067248]
mat_Sqrt:  [[0.15]]
grads:  [0.0997118]
Stock Position:  0.0997117981201226
Bond Position:  [-17.7961629]


portfolio before change:  [-7.7302754]
curr_Stock_Price:  100.9721251230221
curr_Factors:  [100.97212512]
mat_Sqrt:  [[0.15]]
grads:  [0.17460592]
Stock Position:  0.17460591996814395
Bond Position:  [-25.3606062]


portfolio before change:  [-7.82711826]
curr_Stock_Price:  100.43564510546385
curr_Factors:  [100.43564511]
mat_Sqrt:  [[0.15]]
grads:  [0.01049386]
Stock Position:  0.010493856727383661
Bond Position:  [-8.88107553]


portfolio before change:  [-7.81487692]
curr_Stock_Price:  101.7079651356701
curr_Factors:  [101.70796514]
mat_Sqrt:  [[0.15]]
grads:  [0.07296464]
Stock Position:  0.07296463652176037
Bond Position:  [-15.23596163]


portfolio before change:  [-7.87530402]
curr_Stock_Price:  100.90589875087994
curr_Factors:  [100.90589875]
mat_Sqrt:  [[0.15]]
grads:  [-0.04460106]
Stock Position:  -0.04460106464585389
Bond Position:  [-3.3747935]


portfolio before change:  [-7.87942435]
curr_Stock_Price:  100.98882180025247
curr_Factors:  [100.9888218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440336]
Stock Position:  -0.004403355227329539
Bond Position:  [-7.43473469]


portfolio before change:  [-7.87292257]
curr_Stock_Price:  99.30120514312762
curr_Factors:  [99.30120514]
mat_Sqrt:  [[0.15]]
grads:  [0.0219072]
Stock Position:  0.021907202468909946
Bond Position:  [-10.04833418]


portfolio before change:  [-7.87332688]
curr_Stock_Price:  99.34008791949208
curr_Factors:  [99.34008792]
mat_Sqrt:  [[0.15]]
grads:  [0.03696147]
Stock Position:  0.03696146779917682
Bond Position:  [-11.54508234]


portfolio before change:  [-7.8801602]
curr_Stock_Price:  99.19425787679029
curr_Factors:  [99.19425788]
mat_Sqrt:  [[0.15]]
grads:  [0.09389484]
Stock Position:  0.093894835527177
Bond Position:  [-17.19398873]


portfolio before change:  [-7.71745207]
curr_Stock_Price:  100.95002545226428
curr_Factors:  [100.95002545]
mat_Sqrt:  [[0.15]]
grads:  [-0.0084832]
Stock Position:  -0.008483200049071377
Bond Position:  [-6.86107281]


portfolio before change:  [-7.72407533]
curr_Stock_Price:  101.62967108034731
curr_Factors:  [101.62967108]
mat_Sqrt:  [[0.15]]
grads:  [0.14017111]
Stock Position:  0.14017110809951963
Bond Position:  [-21.96961894]


portfolio before change:  [-7.71234024]
curr_Stock_Price:  101.73298381141224
curr_Factors:  [101.73298381]
mat_Sqrt:  [[0.15]]
grads:  [0.0126484]
Stock Position:  0.012648403601940968
Bond Position:  [-8.99910008]


portfolio before change:  [-7.70109466]
curr_Stock_Price:  102.71101556278958
curr_Factors:  [102.71101556]
mat_Sqrt:  [[0.15]]
grads:  [0.05924683]
Stock Position:  0.05924683431725846
Bond Position:  [-13.78639718]


portfolio before change:  [-7.65285298]
curr_Stock_Price:  103.55435325257301
curr_Factors:  [103.55435325]
mat_Sqrt:  [[0.15]]
grads:  [0.04259016]
Stock Position:  0.04259016005266507
Bond Position:  [-12.06324946]


portfolio before change:  [-7.60702804]
curr_Stock_Price:  104.6657117494565
curr_Factors:  [104.66571175]
mat_Sqrt:  [[0.15]]
grads:  [0.08047517]
Stock Position:  0.08047516582138381
Bond Position:  [-16.03001855]


portfolio before change:  [-7.58830263]
curr_Stock_Price:  104.92329798497695
curr_Factors:  [104.92329798]
mat_Sqrt:  [[0.15]]
grads:  [-0.11316267]
Stock Position:  -0.11316267246129232
Bond Position:  [4.28509818]


portfolio before change:  [-7.60866245]
curr_Stock_Price:  105.10794807605444
curr_Factors:  [105.10794808]
mat_Sqrt:  [[0.15]]
grads:  [0.07240132]
Stock Position:  0.0724013208636643
Bond Position:  [-15.21861673]


portfolio before change:  [-7.61166471]
curr_Stock_Price:  105.09275754700022
curr_Factors:  [105.09275755]
mat_Sqrt:  [[0.15]]
grads:  [0.25349547]
Stock Position:  0.25349547095851305
Bond Position:  [-34.25220278]


portfolio before change:  [-7.70969022]
curr_Stock_Price:  104.7229532543261
curr_Factors:  [104.72295325]
mat_Sqrt:  [[0.15]]
grads:  [-0.09594033]
Stock Position:  -0.09594033111646874
Bond Position:  [2.33746459]


portfolio before change:  [-7.6361179]
curr_Stock_Price:  103.95914387780901
curr_Factors:  [103.95914388]
mat_Sqrt:  [[0.15]]
grads:  [0.05192234]
Stock Position:  0.05192233520349937
Bond Position:  [-13.03391941]


portfolio before change:  [-7.64241489]
curr_Stock_Price:  103.86924698716636
curr_Factors:  [103.86924699]
mat_Sqrt:  [[0.15]]
grads:  [0.04363643]
Stock Position:  0.043636433853277354
Bond Position:  [-12.17489842]


portfolio before change:  [-7.64616159]
curr_Stock_Price:  103.81826353047049
curr_Factors:  [103.81826353]
mat_Sqrt:  [[0.15]]
grads:  [-0.07850442]
Stock Position:  -0.078504423048548
Bond Position:  [0.50403129]


portfolio before change:  [-7.81737457]
curr_Stock_Price:  106.000000321172
curr_Factors:  [106.00000032]
mat_Sqrt:  [[0.15]]
grads:  [0.00126798]
Stock Position:  0.0012679812768401544
Bond Position:  [-7.95178058]


portfolio before change:  [-7.81943264]
curr_Stock_Price:  105.16084016477066
curr_Factors:  [105.16084016]
mat_Sqrt:  [[0.15]]
grads:  [-0.0760014]
Stock Position:  -0.0760014037196608
Bond Position:  [0.17293883]


portfolio before change:  [-7.91061734]
curr_Stock_Price:  106.36090107898198
curr_Factors:  [106.36090108]
mat_Sqrt:  [[0.15]]
grads:  [0.43847432]
Stock Position:  0.43847431946397475
Bond Position:  [-54.54714106]


portfolio before change:  [-8.21572157]
curr_Stock_Price:  105.68062084040501
curr_Factors:  [105.68062084]
mat_Sqrt:  [[0.15]]
grads:  [-0.02004031]
Stock Position:  -0.020040308691490552
Bond Position:  [-6.09784931]


portfolio before change:  [-8.20769012]
curr_Stock_Price:  105.24181883275743
curr_Factors:  [105.24181883]
mat_Sqrt:  [[0.15]]
grads:  [-0.05429312]
Stock Position:  -0.05429312014667929
Bond Position:  [-2.49378341]


portfolio before change:  [-8.19829238]
curr_Stock_Price:  105.0629842742172
curr_Factors:  [105.06298427]
mat_Sqrt:  [[0.15]]
grads:  [0.03024132]
Stock Position:  0.030241323173391586
Bond Position:  [-11.37553604]


portfolio before change:  [-8.17365598]
curr_Stock_Price:  105.92466725219526
curr_Factors:  [105.92466725]
mat_Sqrt:  [[0.15]]
grads:  [0.03989276]
Stock Position:  0.03989275914320929
Bond Position:  [-12.39928321]


portfolio before change:  [-8.15884609]
curr_Stock_Price:  106.3347640285372
curr_Factors:  [106.33476403]
mat_Sqrt:  [[0.15]]
grads:  [0.00290233]
Stock Position:  0.002902329882078977
Bond Position:  [-8.46746465]


portfolio before change:  [-8.16063478]
curr_Stock_Price:  106.08317693618679
curr_Factors:  [106.08317694]
mat_Sqrt:  [[0.15]]
grads:  [0.05148659]
Stock Position:  0.05148658669098999
Bond Position:  [-13.62249546]


portfolio before change:  [-8.13532672]
curr_Stock_Price:  106.60779861418892
curr_Factors:  [106.60779861]
mat_Sqrt:  [[0.15]]
grads:  [0.02522551]
Stock Position:  0.025225507825591922
Bond Position:  [-10.82456258]


portfolio before change:  [-8.14217986]
curr_Stock_Price:  106.38976591690094
curr_Factors:  [106.38976592]
mat_Sqrt:  [[0.15]]
grads:  [-0.2691571]
Stock Position:  -0.2691571001976332
Bond Position:  [20.49338103]


portfolio before change:  [-7.93035045]
curr_Stock_Price:  105.61227360025788
curr_Factors:  [105.6122736]
mat_Sqrt:  [[0.15]]
grads:  [0.06574028]
Stock Position:  0.06574027971666198
Bond Position:  [-14.87333086]


portfolio before change:  [-7.8748708]
curr_Stock_Price:  106.4844775179544
curr_Factors:  [106.48447752]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.8748708]
Stock Price:  107.6450740023542
PL:  [-15.5199448]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.48163653e-03]
 [-1.53772499e-02]
 [-2.68430091e-02]
 [ 4.88173963e-03]
 [ 7.45270578e-04]
 [-2.49377316e-02]
 [-5.15088396e-02]
 [ 1.91839425e-02]
 [-6.07223489e-03]
 [ 4.83347636e-03]
 [ 1.68702582e-03]
 [ 4.69423665e-03]
 [ 1.16503242e-02]
 [ 5.18560263e-03]
 [ 2.13956513e-02]
 [-1.63972405e-03]
 [ 9.48759350e-03]
 [ 1.33219914e-02]
 [ 1.14449900e-02]
 [-1.36667960e-02]
 [-1.35823872e-02]
 [ 2.08805557e-02]
 [-2.42005467e-02]
 [ 6.13104525e-03]
 [-3.86990513e-03]
 [-7.32825855e-03]
 [ 1.51240234e-03]
 [-1.12468021e-02]
 [-1.70549856e-02]
 [-8.51844111e-03]
 [-2.65489148e-03]
 [ 5.51824230e-03]
 [ 5.43781916e-03]
 [-1.18176878e-02]
 [ 2.01831476e-02]
 [ 5.47715584e-03]
 [-1.33317923e-03]
 [ 8.33146287e-03]
 [-1.57077791e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.44665282]
curr_Stock_Price:  99.52270391093755
curr_Factors:  [99.52270391]
mat_Sqrt:  [[0.15]]
grads:  [0.02987758]
Stock Position:  0.0298775768960251
Bond Position:  [-8.42015006]


portfolio before change:  [-5.50836079]
curr_Stock_Price:  97.49257313693816
curr_Factors:  [97.49257314]
mat_Sqrt:  [[0.15]]
grads:  [-0.102515]
Stock Position:  -0.10251499957601684
Bond Position:  [4.4860903]


portfolio before change:  [-5.50814585]
curr_Stock_Price:  97.4959467846823
curr_Factors:  [97.49594678]
mat_Sqrt:  [[0.15]]
grads:  [-0.17895339]
Stock Position:  -0.17895339425479284
Bond Position:  [11.93908476]


portfolio before change:  [-5.56234303]
curr_Stock_Price:  97.80714322745433
curr_Factors:  [97.80714323]
mat_Sqrt:  [[0.15]]
grads:  [0.03254493]
Stock Position:  0.03254493086580525
Bond Position:  [-8.74546974]


portfolio before change:  [-5.52781654]
curr_Stock_Price:  98.9016221698326
curr_Factors:  [98.90162217]
mat_Sqrt:  [[0.15]]
grads:  [0.00496847]
Stock Position:  0.004968470519085208
Bond Position:  [-6.01920633]


portfolio before change:  [-5.53134694]
curr_Stock_Price:  98.34250505384703
curr_Factors:  [98.34250505]
mat_Sqrt:  [[0.15]]
grads:  [-0.16625154]
Stock Position:  -0.16625154404616857
Bond Position:  [10.81824637]


portfolio before change:  [-5.49924469]
curr_Stock_Price:  98.15754506720513
curr_Factors:  [98.15754507]
mat_Sqrt:  [[0.15]]
grads:  [-0.34339226]
Stock Position:  -0.3433922639795681
Bond Position:  [28.20729693]


portfolio before change:  [-5.36109844]
curr_Stock_Price:  97.76551491494634
curr_Factors:  [97.76551491]
mat_Sqrt:  [[0.15]]
grads:  [0.12789295]
Stock Position:  0.12789294970636753
Bond Position:  [-17.86461852]


portfolio before change:  [-5.34183123]
curr_Stock_Price:  97.93362760425238
curr_Factors:  [97.9336276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048157]
Stock Position:  -0.04048156591681655
Bond Position:  [-1.37732463]


portfolio before change:  [-5.39641025]
curr_Stock_Price:  99.27761829169826
curr_Factors:  [99.27761829]
mat_Sqrt:  [[0.15]]
grads:  [0.03222318]
Stock Position:  0.03222317573505886
Bond Position:  [-8.59545039]


portfolio before change:  [-5.40893143]
curr_Stock_Price:  98.92238693320209
curr_Factors:  [98.92238693]
mat_Sqrt:  [[0.15]]
grads:  [0.01124684]
Stock Position:  0.011246838833100561
Bond Position:  [-6.52149558]


portfolio before change:  [-5.40101694]
curr_Stock_Price:  99.6985809679903
curr_Factors:  [99.69858097]
mat_Sqrt:  [[0.15]]
grads:  [0.03129491]
Stock Position:  0.03129491100950103
Bond Position:  [-8.52107516]


portfolio before change:  [-5.38438508]
curr_Stock_Price:  100.26407428501116
curr_Factors:  [100.26407429]
mat_Sqrt:  [[0.15]]
grads:  [0.07766883]
Stock Position:  0.07766882828177953
Bond Position:  [-13.17177825]


portfolio before change:  [-5.43297005]
curr_Stock_Price:  99.65973414730352
curr_Factors:  [99.65973415]
mat_Sqrt:  [[0.15]]
grads:  [0.03457068]
Stock Position:  0.03457068422306238
Bond Position:  [-8.87827524]


portfolio before change:  [-5.40456936]
curr_Stock_Price:  100.51336310381741
curr_Factors:  [100.5133631]
mat_Sqrt:  [[0.15]]
grads:  [0.14263768]
Stock Position:  0.1426376755006564
Bond Position:  [-19.74156183]


portfolio before change:  [-5.49933784]
curr_Stock_Price:  99.86626456241812
curr_Factors:  [99.86626456]
mat_Sqrt:  [[0.15]]
grads:  [-0.01093149]
Stock Position:  -0.010931493682465784
Bond Position:  [-4.4076504]


portfolio before change:  [-5.50727476]
curr_Stock_Price:  100.54192038886183
curr_Factors:  [100.54192039]
mat_Sqrt:  [[0.15]]
grads:  [0.06325062]
Stock Position:  0.0632506233343636
Bond Position:  [-11.8666139]


portfolio before change:  [-5.4429036]
curr_Stock_Price:  101.58308921193789
curr_Factors:  [101.58308921]
mat_Sqrt:  [[0.15]]
grads:  [0.08881328]
Stock Position:  0.08881327621268986
Bond Position:  [-14.46483056]


portfolio before change:  [-5.41284002]
curr_Stock_Price:  101.94195228348775
curr_Factors:  [101.94195228]
mat_Sqrt:  [[0.15]]
grads:  [0.07629993]
Stock Position:  0.07629993346174402
Bond Position:  [-13.19100419]


portfolio before change:  [-5.43984088]
curr_Stock_Price:  101.60968612270527
curr_Factors:  [101.60968612]
mat_Sqrt:  [[0.15]]
grads:  [-0.09111197]
Stock Position:  -0.09111197328349487
Bond Position:  [3.81801813]


portfolio before change:  [-5.42222578]
curr_Stock_Price:  101.4215898928645
curr_Factors:  [101.42158989]
mat_Sqrt:  [[0.15]]
grads:  [-0.09054925]
Stock Position:  -0.0905492483160369
Bond Position:  [3.76142295]


portfolio before change:  [-5.4093989]
curr_Stock_Price:  101.28512628982521
curr_Factors:  [101.28512629]
mat_Sqrt:  [[0.15]]
grads:  [0.1392037]
Stock Position:  0.13920370498826662
Bond Position:  [-19.50866374]


portfolio before change:  [-5.38158331]
curr_Stock_Price:  101.50246479010603
curr_Factors:  [101.50246479]
mat_Sqrt:  [[0.15]]
grads:  [-0.16133698]
Stock Position:  -0.16133697818299125
Bond Position:  [10.99451764]


portfolio before change:  [-5.22171488]
curr_Stock_Price:  100.52008597120764
curr_Factors:  [100.52008597]
mat_Sqrt:  [[0.15]]
grads:  [0.04087363]
Stock Position:  0.04087363497119742
Bond Position:  [-9.33033618]


portfolio before change:  [-5.22773914]
curr_Stock_Price:  100.40123435279038
curr_Factors:  [100.40123435]
mat_Sqrt:  [[0.15]]
grads:  [-0.02579937]
Stock Position:  -0.025799367527532133
Bond Position:  [-2.63745079]


portfolio before change:  [-5.24476265]
curr_Stock_Price:  101.04829696581197
curr_Factors:  [101.04829697]
mat_Sqrt:  [[0.15]]
grads:  [-0.04885506]
Stock Position:  -0.048855057022932045
Bond Position:  [-0.30804234]


portfolio before change:  [-5.24189057]
curr_Stock_Price:  100.98872112453284
curr_Factors:  [100.98872112]
mat_Sqrt:  [[0.15]]
grads:  [0.01008268]
Stock Position:  0.010082682276136592
Bond Position:  [-6.26012776]


portfolio before change:  [-5.23995064]
curr_Stock_Price:  101.25873811464132
curr_Factors:  [101.25873811]
mat_Sqrt:  [[0.15]]
grads:  [-0.07497868]
Stock Position:  -0.07497868052260544
Bond Position:  [2.35229593]


portfolio before change:  [-5.22551833]
curr_Stock_Price:  101.07017447888408
curr_Factors:  [101.07017448]
mat_Sqrt:  [[0.15]]
grads:  [-0.1136999]
Stock Position:  -0.11369990432978849
Bond Position:  [6.26615083]


portfolio before change:  [-5.18005488]
curr_Stock_Price:  100.67720900416403
curr_Factors:  [100.677209]
mat_Sqrt:  [[0.15]]
grads:  [-0.05678961]
Stock Position:  -0.05678960737452998
Bond Position:  [0.53736429]


portfolio before change:  [-5.15153862]
curr_Stock_Price:  100.17625324803997
curr_Factors:  [100.17625325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01769928]
Stock Position:  -0.017699276509445326
Bond Position:  [-3.37849142]


portfolio before change:  [-5.14048356]
curr_Stock_Price:  99.5277860120068
curr_Factors:  [99.52778601]
mat_Sqrt:  [[0.15]]
grads:  [0.03678828]
Stock Position:  0.03678828198790668
Bond Position:  [-8.80193982]


portfolio before change:  [-5.12546835]
curr_Stock_Price:  99.96584720244157
curr_Factors:  [99.9658472]
mat_Sqrt:  [[0.15]]
grads:  [0.03625213]
Stock Position:  0.03625212775512182
Bond Position:  [-8.74944302]


portfolio before change:  [-5.13561642]
curr_Stock_Price:  99.71608757536069
curr_Factors:  [99.71608758]
mat_Sqrt:  [[0.15]]
grads:  [-0.07878459]
Stock Position:  -0.07878458564080841
Bond Position:  [2.72047422]


portfolio before change:  [-5.28782697]
curr_Stock_Price:  101.65238805197004
curr_Factors:  [101.65238805]
mat_Sqrt:  [[0.15]]
grads:  [0.13455432]
Stock Position:  0.13455431727677025
Bond Position:  [-18.96559464]


portfolio before change:  [-5.29130411]
curr_Stock_Price:  101.64416617796843
curr_Factors:  [101.64416618]
mat_Sqrt:  [[0.15]]
grads:  [0.03651437]
Stock Position:  0.03651437227087314
Bond Position:  [-9.00277703]


portfolio before change:  [-5.27395179]
curr_Stock_Price:  102.15020626783124
curr_Factors:  [102.15020627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00888786]
Stock Position:  -0.00888786155903039
Bond Position:  [-4.3660549]


portfolio before change:  [-5.27259809]
curr_Stock_Price:  101.93648885149591
curr_Factors:  [101.93648885]
mat_Sqrt:  [[0.15]]
grads:  [0.05554309]
Stock Position:  0.05554308582193974
Bond Position:  [-10.93446524]


portfolio before change:  [-5.20805773]
curr_Stock_Price:  103.12308571810358
curr_Factors:  [103.12308572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.20805773]
Stock Price:  102.60849281163834
PL:  [-7.81655054]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.26961442e-03]
 [-6.88440675e-03]
 [-4.52467401e-03]
 [-1.11306139e-03]
 [-3.82390098e-02]
 [-2.64063221e-02]
 [-3.91395001e-02]
 [ 1.57853849e-02]
 [-6.44375952e-03]
 [ 3.08140753e-03]
 [-1.20903968e-02]
 [ 7.57853289e-03]
 [ 1.38833213e-02]
 [-2.53154512e-03]
 [-9.46285312e-03]
 [-9.42675862e-03]
 [ 1.87562907e-02]
 [-1.09289650e-02]
 [ 3.67119315e-03]
 [-1.39562295e-03]
 [ 1.33006199e-02]
 [ 1.55253515e-04]
 [ 1.99207072e-02]
 [ 5.00975828e-03]
 [ 6.32067076e-03]
 [-9.44778630e-03]
 [ 4.08704630e-03]
 [-1.12523053e-02]
 [ 5.22249825e-02]
 [-7.59710235e-03]
 [-3.48360888e-03]
 [ 4.69761543e-03]
 [ 5.92600067e-03]
 [-3.25848168e-03]
 [ 7.83195516e-03]
 [ 4.45441943e-03]
 [-2.47633007e-02]
 [ 9.95940582e-03]
 [-1.19487846e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.99740812]
curr_Stock_Price:  99.1001188189166
curr_Factors:  [99.10011882]
mat_Sqrt:  [[0.15]]
grads:  [0.0484641]
Stock Position:  0.04846409611710187
Bond Position:  [-16.80020581]


portfolio before change:  [-11.99974445]
curr_Stock_Price:  99.0952457113538
curr_Factors:  [99.09524571]
mat_Sqrt:  [[0.15]]
grads:  [-0.04589605]
Stock Position:  -0.045896045019332345
Bond Position:  [-7.45166459]


portfolio before change:  [-12.00282989]
curr_Stock_Price:  99.14217605934573
curr_Factors:  [99.14217606]
mat_Sqrt:  [[0.15]]
grads:  [-0.03016449]
Stock Position:  -0.030164493376837055
Bond Position:  [-9.01225637]


portfolio before change:  [-11.99739021]
curr_Stock_Price:  98.92449354562017
curr_Factors:  [98.92449355]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742041]
Stock Position:  -0.007420409296680504
Bond Position:  [-11.26332997]


portfolio before change:  [-11.98923939]
curr_Stock_Price:  97.63631373662305
curr_Factors:  [97.63631374]
mat_Sqrt:  [[0.15]]
grads:  [-0.25492673]
Stock Position:  -0.2549267319939264
Bond Position:  [12.900867]


portfolio before change:  [-12.10797954]
curr_Stock_Price:  98.10842139593301
curr_Factors:  [98.1084214]
mat_Sqrt:  [[0.15]]
grads:  [-0.17604215]
Stock Position:  -0.17604214701668597
Bond Position:  [5.1632376]


portfolio before change:  [-11.87324838]
curr_Stock_Price:  96.77870731753674
curr_Factors:  [96.77870732]
mat_Sqrt:  [[0.15]]
grads:  [-0.26093]
Stock Position:  -0.260930000741344
Bond Position:  [13.3792198]


portfolio before change:  [-11.96406922]
curr_Stock_Price:  97.13318304720765
curr_Factors:  [97.13318305]
mat_Sqrt:  [[0.15]]
grads:  [0.1052359]
Stock Position:  0.10523589930791373
Bond Position:  [-22.18596709]


portfolio before change:  [-11.99368577]
curr_Stock_Price:  96.87810725522816
curr_Factors:  [96.87810726]
mat_Sqrt:  [[0.15]]
grads:  [-0.0429584]
Stock Position:  -0.04295839682175854
Bond Position:  [-7.8319576]


portfolio before change:  [-11.99500413]
curr_Stock_Price:  96.88600561540014
curr_Factors:  [96.88600562]
mat_Sqrt:  [[0.15]]
grads:  [0.02054272]
Stock Position:  0.020542716852267637
Bond Position:  [-13.98530591]


portfolio before change:  [-12.01377186]
curr_Stock_Price:  96.05751434998855
curr_Factors:  [96.05751435]
mat_Sqrt:  [[0.15]]
grads:  [-0.08060265]
Stock Position:  -0.08060264504531232
Bond Position:  [-4.27128213]


portfolio before change:  [-12.06367698]
curr_Stock_Price:  96.67003983599004
curr_Factors:  [96.67003984]
mat_Sqrt:  [[0.15]]
grads:  [0.05052355]
Stock Position:  0.050523552591831764
Bond Position:  [-16.94779082]


portfolio before change:  [-12.09691886]
curr_Stock_Price:  96.05402458856805
curr_Factors:  [96.05402459]
mat_Sqrt:  [[0.15]]
grads:  [0.09255548]
Stock Position:  0.0925554755337495
Bond Position:  [-20.98724479]


portfolio before change:  [-12.2214831]
curr_Stock_Price:  94.73653726171239
curr_Factors:  [94.73653726]
mat_Sqrt:  [[0.15]]
grads:  [-0.01687697]
Stock Position:  -0.016876967483118708
Bond Position:  [-10.62261764]


portfolio before change:  [-12.22441752]
curr_Stock_Price:  94.8317267211328
curr_Factors:  [94.83172672]
mat_Sqrt:  [[0.15]]
grads:  [-0.06308569]
Stock Position:  -0.06308568746251657
Bond Position:  [-6.24189285]


portfolio before change:  [-12.25893031]
curr_Stock_Price:  95.36643603096408
curr_Factors:  [95.36643603]
mat_Sqrt:  [[0.15]]
grads:  [-0.06284506]
Stock Position:  -0.06284505744729627
Bond Position:  [-6.26562116]


portfolio before change:  [-12.32319368]
curr_Stock_Price:  96.37654126128932
curr_Factors:  [96.37654126]
mat_Sqrt:  [[0.15]]
grads:  [0.12504194]
Stock Position:  0.12504193801881508
Bond Position:  [-24.37430318]


portfolio before change:  [-12.24518163]
curr_Stock_Price:  97.0247959956925
curr_Factors:  [97.024796]
mat_Sqrt:  [[0.15]]
grads:  [-0.07285977]
Stock Position:  -0.07285976654055919
Bond Position:  [-5.17597765]


portfolio before change:  [-12.20080367]
curr_Stock_Price:  96.40682807912248
curr_Factors:  [96.40682808]
mat_Sqrt:  [[0.15]]
grads:  [0.02447462]
Stock Position:  0.024474620992001386
Bond Position:  [-14.56032425]


portfolio before change:  [-12.19246918]
curr_Stock_Price:  96.8217330095442
curr_Factors:  [96.82173301]
mat_Sqrt:  [[0.15]]
grads:  [-0.00930415]
Stock Position:  -0.009304153006307684
Bond Position:  [-11.29162497]


portfolio before change:  [-12.20810046]
curr_Stock_Price:  98.35005413908912
curr_Factors:  [98.35005414]
mat_Sqrt:  [[0.15]]
grads:  [0.0886708]
Stock Position:  0.08867079938339953
Bond Position:  [-20.92887838]


portfolio before change:  [-12.24121086]
curr_Stock_Price:  98.006151440506
curr_Factors:  [98.00615144]
mat_Sqrt:  [[0.15]]
grads:  [0.00103502]
Stock Position:  0.0010350234324390736
Bond Position:  [-12.34264952]


portfolio before change:  [-12.24275179]
curr_Stock_Price:  98.00808509678285
curr_Factors:  [98.0080851]
mat_Sqrt:  [[0.15]]
grads:  [0.13280471]
Stock Position:  0.1328047145470824
Bond Position:  [-25.25868755]


portfolio before change:  [-12.12844877]
curr_Stock_Price:  98.892545756996
curr_Factors:  [98.89254576]
mat_Sqrt:  [[0.15]]
grads:  [0.03339839]
Stock Position:  0.03339838855331601
Bond Position:  [-15.43130044]


portfolio before change:  [-12.11782939]
curr_Stock_Price:  99.26826491751682
curr_Factors:  [99.26826492]
mat_Sqrt:  [[0.15]]
grads:  [0.04213781]
Stock Position:  0.042137805045194904
Bond Position:  [-16.30077619]


portfolio before change:  [-12.08863557]
curr_Stock_Price:  100.00944132469449
curr_Factors:  [100.00944132]
mat_Sqrt:  [[0.15]]
grads:  [-0.06298524]
Stock Position:  -0.06298524202483133
Bond Position:  [-5.7895167]


portfolio before change:  [-12.09692346]
curr_Stock_Price:  100.12953542962363
curr_Factors:  [100.12953543]
mat_Sqrt:  [[0.15]]
grads:  [0.02724698]
Stock Position:  0.02724697535436829
Bond Position:  [-14.82515045]


portfolio before change:  [-12.04836494]
curr_Stock_Price:  101.97971432347205
curr_Factors:  [101.97971432]
mat_Sqrt:  [[0.15]]
grads:  [-0.07501537]
Stock Position:  -0.0750153687372161
Bond Position:  [-4.39831907]


portfolio before change:  [-12.18143159]
curr_Stock_Price:  103.74624327048129
curr_Factors:  [103.74624327]
mat_Sqrt:  [[0.15]]
grads:  [0.34816655]
Stock Position:  0.34816655012534303
Bond Position:  [-48.30240319]


portfolio before change:  [-12.24590839]
curr_Stock_Price:  103.57839651696223
curr_Factors:  [103.57839652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05064735]
Stock Position:  -0.05064734897768055
Bond Position:  [-6.99993719]


portfolio before change:  [-12.23535803]
curr_Stock_Price:  103.35280901366336
curr_Factors:  [103.35280901]
mat_Sqrt:  [[0.15]]
grads:  [-0.02322406]
Stock Position:  -0.023224059184297326
Bond Position:  [-9.83508627]


portfolio before change:  [-12.25758951]
curr_Stock_Price:  104.25713087897043
curr_Factors:  [104.25713088]
mat_Sqrt:  [[0.15]]
grads:  [0.03131744]
Stock Position:  0.031317436193489
Bond Position:  [-15.52265556]


portfolio before change:  [-12.21039274]
curr_Stock_Price:  105.82613622565962
curr_Factors:  [105.82613623]
mat_Sqrt:  [[0.15]]
grads:  [0.03950667]
Stock Position:  0.039506671137531126
Bond Position:  [-16.3912311]


portfolio before change:  [-12.2621634]
curr_Stock_Price:  104.56757351654686
curr_Factors:  [104.56757352]
mat_Sqrt:  [[0.15]]
grads:  [-0.02172321]
Stock Position:  -0.02172321121742022
Bond Position:  [-9.99061991]


portfolio before change:  [-12.3007464]
curr_Stock_Price:  106.28620046059851
curr_Factors:  [106.28620046]
mat_Sqrt:  [[0.15]]
grads:  [0.05221303]
Stock Position:  0.05221303439467909
Bond Position:  [-17.85027144]


portfolio before change:  [-12.35852905]
curr_Stock_Price:  105.222266444422
curr_Factors:  [105.22226644]
mat_Sqrt:  [[0.15]]
grads:  [0.02969613]
Stock Position:  0.02969612955367397
Bond Position:  [-15.4832231]


portfolio before change:  [-12.36654782]
curr_Stock_Price:  105.01741653232412
curr_Factors:  [105.01741653]
mat_Sqrt:  [[0.15]]
grads:  [-0.16508867]
Stock Position:  -0.16508867142714287
Bond Position:  [4.97063795]


portfolio before change:  [-12.38762396]
curr_Stock_Price:  105.14884597580526
curr_Factors:  [105.14884598]
mat_Sqrt:  [[0.15]]
grads:  [0.06639604]
Stock Position:  0.06639603883037754
Bond Position:  [-19.36909082]


portfolio before change:  [-12.42542817]
curr_Stock_Price:  104.61593889288176
curr_Factors:  [104.61593889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.42542817]
Stock Price:  104.71438567202205
PL:  [-17.13981384]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.90366783e-03]
 [ 4.62221823e-03]
 [ 9.96870328e-03]
 [-2.63336529e-03]
 [ 1.24888217e-02]
 [ 2.62081395e-02]
 [ 9.34144766e-03]
 [ 1.28196826e-02]
 [-7.66034526e-03]
 [-3.01917042e-03]
 [ 2.03766572e-02]
 [ 7.97158287e-03]
 [ 2.49686563e-03]
 [-4.05910226e-03]
 [ 5.85626787e-04]
 [ 5.30490813e-03]
 [ 9.28017278e-03]
 [-2.04677777e-02]
 [ 1.24051284e-02]
 [-1.64872251e-02]
 [ 5.12933404e-03]
 [ 3.14636808e-02]
 [-1.96883083e-02]
 [ 7.99068145e-03]
 [ 7.60858462e-03]
 [-1.88060007e-02]
 [-4.12795359e-04]
 [-1.07106279e-02]
 [ 5.06268899e-02]
 [-7.81280506e-03]
 [-4.65748821e-03]
 [ 4.76641873e-03]
 [ 5.80465886e-03]
 [-3.65700368e-03]
 [ 1.11643842e-02]
 [ 5.02507514e-03]
 [-9.29534102e-03]
 [ 9.77279462e-03]
 [-1.58717251e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.44145539]
curr_Stock_Price:  99.45852982465195
curr_Factors:  [99.45852982]
mat_Sqrt:  [[0.15]]
grads:  [0.03269112]
Stock Position:  0.03269111885102858
Bond Position:  [-9.69286601]


portfolio before change:  [-6.41462572]
curr_Stock_Price:  100.3162966342321
curr_Factors:  [100.31629663]
mat_Sqrt:  [[0.15]]
grads:  [0.03081479]
Stock Position:  0.03081478823322328
Bond Position:  [-9.50585116]


portfolio before change:  [-6.41127815]
curr_Stock_Price:  100.46349445485852
curr_Factors:  [100.46349445]
mat_Sqrt:  [[0.15]]
grads:  [0.06645802]
Stock Position:  0.06645802189237165
Bond Position:  [-13.08788327]


portfolio before change:  [-6.40169096]
curr_Stock_Price:  100.63237219841331
curr_Factors:  [100.6323722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755577]
Stock Position:  -0.017555768597912875
Bond Position:  [-4.63501232]


portfolio before change:  [-6.38785258]
curr_Stock_Price:  99.8111152210026
curr_Factors:  [99.81111522]
mat_Sqrt:  [[0.15]]
grads:  [0.08325881]
Stock Position:  0.0832588112830955
Bond Position:  [-14.69800738]


portfolio before change:  [-6.29113551]
curr_Stock_Price:  100.99482696279232
curr_Factors:  [100.99482696]
mat_Sqrt:  [[0.15]]
grads:  [0.17472093]
Stock Position:  0.17472093018900792
Bond Position:  [-23.93704562]


portfolio before change:  [-6.11611579]
curr_Stock_Price:  102.01366331267627
curr_Factors:  [102.01366331]
mat_Sqrt:  [[0.15]]
grads:  [0.06227632]
Stock Position:  0.06227631770510121
Bond Position:  [-12.4691511]


portfolio before change:  [-6.15677633]
curr_Stock_Price:  101.38578748554481
curr_Factors:  [101.38578749]
mat_Sqrt:  [[0.15]]
grads:  [0.08546455]
Stock Position:  0.08546455044557927
Bond Position:  [-14.82166708]


portfolio before change:  [-6.16057898]
curr_Stock_Price:  101.36297300636467
curr_Factors:  [101.36297301]
mat_Sqrt:  [[0.15]]
grads:  [-0.05106897]
Stock Position:  -0.051068968370420076
Bond Position:  [-0.98407652]


portfolio before change:  [-6.2124806]
curr_Stock_Price:  102.3768686581046
curr_Factors:  [102.37686866]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201278]
Stock Position:  -0.02012780283293476
Bond Position:  [-4.15185918]


portfolio before change:  [-6.23697211]
curr_Stock_Price:  103.56788223756644
curr_Factors:  [103.56788224]
mat_Sqrt:  [[0.15]]
grads:  [0.13584438]
Stock Position:  0.13584438107975116
Bond Position:  [-20.30608697]


portfolio before change:  [-6.25881895]
curr_Stock_Price:  103.42574591355303
curr_Factors:  [103.42574591]
mat_Sqrt:  [[0.15]]
grads:  [0.05314389]
Stock Position:  0.05314388578742187
Bond Position:  [-11.75526497]


portfolio before change:  [-6.23165238]
curr_Stock_Price:  103.96458617861995
curr_Factors:  [103.96458618]
mat_Sqrt:  [[0.15]]
grads:  [0.01664577]
Stock Position:  0.01664577086067976
Bond Position:  [-7.96222306]


portfolio before change:  [-6.23320748]
curr_Stock_Price:  103.93095857011987
curr_Factors:  [103.93095857]
mat_Sqrt:  [[0.15]]
grads:  [-0.02706068]
Stock Position:  -0.027060681756074033
Bond Position:  [-3.42076488]


portfolio before change:  [-6.25741719]
curr_Stock_Price:  104.80980146013417
curr_Factors:  [104.80980146]
mat_Sqrt:  [[0.15]]
grads:  [0.00390418]
Stock Position:  0.0039041785822247917
Bond Position:  [-6.66661337]


portfolio before change:  [-6.25495926]
curr_Stock_Price:  105.65282252748644
curr_Factors:  [105.65282253]
mat_Sqrt:  [[0.15]]
grads:  [0.03536605]
Stock Position:  0.03536605422361088
Bond Position:  [-9.99148271]


portfolio before change:  [-6.21054704]
curr_Stock_Price:  106.94392602140522
curr_Factors:  [106.94392602]
mat_Sqrt:  [[0.15]]
grads:  [0.06186782]
Stock Position:  0.0618678185097576
Bond Position:  [-12.82693445]


portfolio before change:  [-6.25584272]
curr_Stock_Price:  106.23770731477585
curr_Factors:  [106.23770731]
mat_Sqrt:  [[0.15]]
grads:  [-0.13645185]
Stock Position:  -0.13645185132386894
Bond Position:  [8.24048913]


portfolio before change:  [-6.2226904]
curr_Stock_Price:  106.00229684840289
curr_Factors:  [106.00229685]
mat_Sqrt:  [[0.15]]
grads:  [0.08270086]
Stock Position:  0.08270085613574372
Bond Position:  [-14.9891711]


portfolio before change:  [-6.36024205]
curr_Stock_Price:  104.36171058546131
curr_Factors:  [104.36171059]
mat_Sqrt:  [[0.15]]
grads:  [-0.10991483]
Stock Position:  -0.1099148337280651
Bond Position:  [5.11065802]


portfolio before change:  [-6.31178015]
curr_Stock_Price:  103.9266189467924
curr_Factors:  [103.92661895]
mat_Sqrt:  [[0.15]]
grads:  [0.03419556]
Stock Position:  0.03419556029886068
Bond Position:  [-9.86560912]


portfolio before change:  [-6.32294382]
curr_Stock_Price:  103.63621889748987
curr_Factors:  [103.6362189]
mat_Sqrt:  [[0.15]]
grads:  [0.20975787]
Stock Position:  0.20975787171792576
Bond Position:  [-28.06145653]


portfolio before change:  [-6.16040679]
curr_Stock_Price:  104.42782177634355
curr_Factors:  [104.42782178]
mat_Sqrt:  [[0.15]]
grads:  [-0.13125539]
Stock Position:  -0.13125538850615678
Bond Position:  [7.54630753]


portfolio before change:  [-6.2271288]
curr_Stock_Price:  104.9433462151621
curr_Factors:  [104.94334622]
mat_Sqrt:  [[0.15]]
grads:  [0.05327121]
Stock Position:  0.05327120966136231
Bond Position:  [-11.8175878]


portfolio before change:  [-6.19058431]
curr_Stock_Price:  105.65708608610252
curr_Factors:  [105.65708609]
mat_Sqrt:  [[0.15]]
grads:  [0.0507239]
Stock Position:  0.0507238974687762
Bond Position:  [-11.54992351]


portfolio before change:  [-6.19818987]
curr_Stock_Price:  105.535610134172
curr_Factors:  [105.53561013]
mat_Sqrt:  [[0.15]]
grads:  [-0.12537334]
Stock Position:  -0.12537333817312768
Bond Position:  [7.03316187]


portfolio before change:  [-6.08958313]
curr_Stock_Price:  104.67635613985256
curr_Factors:  [104.67635614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00275197]
Stock Position:  -0.0027519690567764515
Bond Position:  [-5.80151704]


portfolio before change:  [-6.08824128]
curr_Stock_Price:  103.92522630501806
curr_Factors:  [103.92522631]
mat_Sqrt:  [[0.15]]
grads:  [-0.07140419]
Stock Position:  -0.07140418568558392
Bond Position:  [1.33245488]


portfolio before change:  [-6.05372535]
curr_Stock_Price:  103.44417107876298
curr_Factors:  [103.44417108]
mat_Sqrt:  [[0.15]]
grads:  [0.3375126]
Stock Position:  0.33751259946237094
Bond Position:  [-40.96743643]


portfolio before change:  [-6.04360944]
curr_Stock_Price:  103.48931654239381
curr_Factors:  [103.48931654]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208537]
Stock Position:  -0.052085367041759166
Bond Position:  [-0.6533304]


portfolio before change:  [-6.05742636]
curr_Stock_Price:  103.75302308739218
curr_Factors:  [103.75302309]
mat_Sqrt:  [[0.15]]
grads:  [-0.03104992]
Stock Position:  -0.03104992140148331
Bond Position:  [-2.83590315]


portfolio before change:  [-6.06276799]
curr_Stock_Price:  103.91363925042198
curr_Factors:  [103.91363925]
mat_Sqrt:  [[0.15]]
grads:  [0.03177612]
Stock Position:  0.03177612485318284
Bond Position:  [-9.36474077]


portfolio before change:  [-6.04548311]
curr_Stock_Price:  104.49443840463509
curr_Factors:  [104.4944384]
mat_Sqrt:  [[0.15]]
grads:  [0.03869773]
Stock Position:  0.03869772572097723
Bond Position:  [-10.08918023]


portfolio before change:  [-6.05307249]
curr_Stock_Price:  104.33091082054156
curr_Factors:  [104.33091082]
mat_Sqrt:  [[0.15]]
grads:  [-0.02438002]
Stock Position:  -0.024380024537916323
Bond Position:  [-3.50948232]


portfolio before change:  [-6.02370185]
curr_Stock_Price:  103.10821518105017
curr_Factors:  [103.10821518]
mat_Sqrt:  [[0.15]]
grads:  [0.07442923]
Stock Position:  0.0744292281407552
Bond Position:  [-13.69796672]


portfolio before change:  [-5.99511526]
curr_Stock_Price:  103.5152991220622
curr_Factors:  [103.51529912]
mat_Sqrt:  [[0.15]]
grads:  [0.0335005]
Stock Position:  0.03350050095166204
Bond Position:  [-9.46292963]


portfolio before change:  [-5.99381016]
curr_Stock_Price:  103.58956791780989
curr_Factors:  [103.58956792]
mat_Sqrt:  [[0.15]]
grads:  [-0.06196894]
Stock Position:  -0.06196894014645175
Bond Position:  [0.42552558]


portfolio before change:  [-6.00463493]
curr_Stock_Price:  103.7651069650472
curr_Factors:  [103.76510697]
mat_Sqrt:  [[0.15]]
grads:  [0.06515196]
Stock Position:  0.06515196412726218
Bond Position:  [-12.76513546]


portfolio before change:  [-6.05230165]
curr_Stock_Price:  103.05797592059031
curr_Factors:  [103.05797592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.05230165]
Stock Price:  103.00376736551165
PL:  [-9.05606901]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.48691905e-03]
 [-1.22106687e-02]
 [-9.54868063e-03]
 [ 1.88631240e-03]
 [-2.90990853e-02]
 [-2.78888393e-02]
 [-3.18393744e-02]
 [ 2.26045159e-02]
 [-5.87946829e-03]
 [ 4.86764802e-03]
 [ 1.64821631e-03]
 [ 7.04109911e-03]
 [ 1.38055500e-02]
 [ 1.02105326e-03]
 [ 2.25923204e-02]
 [-1.28573011e-03]
 [ 1.04816294e-02]
 [-4.96804642e-03]
 [ 1.15188206e-02]
 [-1.26704586e-02]
 [ 9.07371669e-03]
 [ 4.81877065e-03]
 [ 1.70403034e-02]
 [ 5.20590256e-03]
 [-2.24543321e-03]
 [-8.53886906e-03]
 [ 6.18436406e-05]
 [-1.13367243e-02]
 [ 2.87300538e-02]
 [-1.07603266e-02]
 [-7.98311920e-04]
 [ 5.23482141e-03]
 [ 5.56370829e-03]
 [-1.22606553e-02]
 [ 8.05979039e-03]
 [ 5.46446051e-03]
 [ 2.30103570e-03]
 [ 7.90854849e-03]
 [-1.10403357e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.26656272]
curr_Stock_Price:  99.21177456385294
curr_Factors:  [99.21177456]
mat_Sqrt:  [[0.15]]
grads:  [0.04324613]
Stock Position:  0.04324612699506142
Bond Position:  [-14.55708772]


portfolio before change:  [-10.29961034]
curr_Stock_Price:  98.48967830243863
curr_Factors:  [98.4896783]
mat_Sqrt:  [[0.15]]
grads:  [-0.08140446]
Stock Position:  -0.08140445829551797
Bond Position:  [-2.28211143]


portfolio before change:  [-10.3261887]
curr_Stock_Price:  98.81267136678123
curr_Factors:  [98.81267137]
mat_Sqrt:  [[0.15]]
grads:  [-0.06365787]
Stock Position:  -0.06365787089424589
Bond Position:  [-4.03598442]


portfolio before change:  [-10.29706601]
curr_Stock_Price:  98.3472580892074
curr_Factors:  [98.34725809]
mat_Sqrt:  [[0.15]]
grads:  [0.01257542]
Stock Position:  0.012575415977961418
Bond Position:  [-11.53382369]


portfolio before change:  [-10.30394356]
curr_Stock_Price:  97.91500696061193
curr_Factors:  [97.91500696]
mat_Sqrt:  [[0.15]]
grads:  [-0.1939939]
Stock Position:  -0.19399390223038235
Bond Position:  [8.69097072]


portfolio before change:  [-10.28882011]
curr_Stock_Price:  97.84264894916974
curr_Factors:  [97.84264895]
mat_Sqrt:  [[0.15]]
grads:  [-0.1859256]
Stock Position:  -0.1859255953015783
Bond Position:  [7.90263264]


portfolio before change:  [-10.4796808]
curr_Stock_Price:  98.87450570176155
curr_Factors:  [98.8745057]
mat_Sqrt:  [[0.15]]
grads:  [-0.2122625]
Stock Position:  -0.21226249604122135
Bond Position:  [10.50766857]


portfolio before change:  [-10.69483236]
curr_Stock_Price:  99.89430478125144
curr_Factors:  [99.89430478]
mat_Sqrt:  [[0.15]]
grads:  [0.15069677]
Stock Position:  0.15069677269416035
Bond Position:  [-25.7485817]


portfolio before change:  [-10.85668877]
curr_Stock_Price:  98.84161047882006
curr_Factors:  [98.84161048]
mat_Sqrt:  [[0.15]]
grads:  [-0.03919646]
Stock Position:  -0.03919645525276821
Bond Position:  [-6.982448]


portfolio before change:  [-10.87142187]
curr_Stock_Price:  99.19522017769138
curr_Factors:  [99.19522018]
mat_Sqrt:  [[0.15]]
grads:  [0.03245099]
Stock Position:  0.03245098676965233
Bond Position:  [-14.09040465]


portfolio before change:  [-10.88234559]
curr_Stock_Price:  98.91287719279535
curr_Factors:  [98.91287719]
mat_Sqrt:  [[0.15]]
grads:  [0.01098811]
Stock Position:  0.010988108752663917
Bond Position:  [-11.96921104]


portfolio before change:  [-10.8883666]
curr_Stock_Price:  98.50108961608655
curr_Factors:  [98.50108962]
mat_Sqrt:  [[0.15]]
grads:  [0.04694066]
Stock Position:  0.04694066073917709
Bond Position:  [-15.51207283]


portfolio before change:  [-10.86667131]
curr_Stock_Price:  99.00458536203246
curr_Factors:  [99.00458536]
mat_Sqrt:  [[0.15]]
grads:  [0.092037]
Stock Position:  0.09203699971851441
Bond Position:  [-19.97875631]


portfolio before change:  [-10.71546753]
curr_Stock_Price:  100.6745798829692
curr_Factors:  [100.67457988]
mat_Sqrt:  [[0.15]]
grads:  [0.00680702]
Stock Position:  0.0068070217153427875
Bond Position:  [-11.40076158]


portfolio before change:  [-10.71683362]
curr_Stock_Price:  100.68326087267793
curr_Factors:  [100.68326087]
mat_Sqrt:  [[0.15]]
grads:  [0.15061547]
Stock Position:  0.15061546927335923
Bond Position:  [-25.8812902]


portfolio before change:  [-10.82337662]
curr_Stock_Price:  99.99735761815717
curr_Factors:  [99.99735762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857153]
Stock Position:  -0.008571534089307614
Bond Position:  [-9.96624586]


portfolio before change:  [-10.82103634]
curr_Stock_Price:  99.57897912845256
curr_Factors:  [99.57897913]
mat_Sqrt:  [[0.15]]
grads:  [0.06987753]
Stock Position:  0.06987752917158764
Bond Position:  [-17.77936936]


portfolio before change:  [-10.88244105]
curr_Stock_Price:  98.73203805590823
curr_Factors:  [98.73203806]
mat_Sqrt:  [[0.15]]
grads:  [-0.03312031]
Stock Position:  -0.033120309435554614
Bond Position:  [-7.61240539]


portfolio before change:  [-10.93898106]
curr_Stock_Price:  100.41041627128685
curr_Factors:  [100.41041627]
mat_Sqrt:  [[0.15]]
grads:  [0.07679214]
Stock Position:  0.07679213717241368
Bond Position:  [-18.64971152]


portfolio before change:  [-10.96490723]
curr_Stock_Price:  100.10316075284837
curr_Factors:  [100.10316075]
mat_Sqrt:  [[0.15]]
grads:  [-0.08446972]
Stock Position:  -0.08446972378753141
Bond Position:  [-2.50922089]


portfolio before change:  [-10.85721941]
curr_Stock_Price:  98.82457845840035
curr_Factors:  [98.82457846]
mat_Sqrt:  [[0.15]]
grads:  [0.06049144]
Stock Position:  0.06049144462934762
Bond Position:  [-16.83526092]


portfolio before change:  [-10.85984989]
curr_Stock_Price:  98.81588394464225
curr_Factors:  [98.81588394]
mat_Sqrt:  [[0.15]]
grads:  [0.03212514]
Stock Position:  0.032125137688121856
Bond Position:  [-14.03432377]


portfolio before change:  [-10.85871973]
curr_Stock_Price:  98.90567533663838
curr_Factors:  [98.90567534]
mat_Sqrt:  [[0.15]]
grads:  [0.11360202]
Stock Position:  0.11360202287459152
Bond Position:  [-22.09460452]


portfolio before change:  [-10.79363844]
curr_Stock_Price:  99.50287675813519
curr_Factors:  [99.50287676]
mat_Sqrt:  [[0.15]]
grads:  [0.03470602]
Stock Position:  0.03470601709270662
Bond Position:  [-14.24698698]


portfolio before change:  [-10.7737713]
curr_Stock_Price:  100.12663391156275
curr_Factors:  [100.12663391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01496955]
Stock Position:  -0.014969554734260381
Bond Position:  [-9.27492017]


portfolio before change:  [-10.77999378]
curr_Stock_Price:  100.46485688313994
curr_Factors:  [100.46485688]
mat_Sqrt:  [[0.15]]
grads:  [-0.05692579]
Stock Position:  -0.05692579376251685
Bond Position:  [-5.06095206]


portfolio before change:  [-10.82337604]
curr_Stock_Price:  101.21582748915333
curr_Factors:  [101.21582749]
mat_Sqrt:  [[0.15]]
grads:  [0.00041229]
Stock Position:  0.00041229093765289635
Bond Position:  [-10.86510641]


portfolio before change:  [-10.82450115]
curr_Stock_Price:  101.78123777317411
curr_Factors:  [101.78123777]
mat_Sqrt:  [[0.15]]
grads:  [-0.07557816]
Stock Position:  -0.07557816180721218
Bond Position:  [-3.13206229]


portfolio before change:  [-10.86880145]
curr_Stock_Price:  102.36220938897387
curr_Factors:  [102.36220939]
mat_Sqrt:  [[0.15]]
grads:  [0.19153369]
Stock Position:  0.1915336919262017
Bond Position:  [-30.47461333]


portfolio before change:  [-10.92705161]
curr_Stock_Price:  102.07797427281022
curr_Factors:  [102.07797427]
mat_Sqrt:  [[0.15]]
grads:  [-0.07173551]
Stock Position:  -0.07173551078046986
Bond Position:  [-3.60443599]


portfolio before change:  [-10.88237796]
curr_Stock_Price:  101.44893805257873
curr_Factors:  [101.44893805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532208]
Stock Position:  -0.005322079463839662
Bond Position:  [-10.34245865]


portfolio before change:  [-10.88096871]
curr_Stock_Price:  100.94121598544199
curr_Factors:  [100.94121599]
mat_Sqrt:  [[0.15]]
grads:  [0.03489881]
Stock Position:  0.03489880939989338
Bond Position:  [-14.40369697]


portfolio before change:  [-10.92226645]
curr_Stock_Price:  99.80945354456426
curr_Factors:  [99.80945354]
mat_Sqrt:  [[0.15]]
grads:  [0.03709139]
Stock Position:  0.03709138857058785
Bond Position:  [-14.62433767]


portfolio before change:  [-10.96288238]
curr_Stock_Price:  98.7637182778869
curr_Factors:  [98.76371828]
mat_Sqrt:  [[0.15]]
grads:  [-0.0817377]
Stock Position:  -0.08173770172905165
Bond Position:  [-2.89016303]


portfolio before change:  [-10.95623749]
curr_Stock_Price:  98.67800289485203
curr_Factors:  [98.67800289]
mat_Sqrt:  [[0.15]]
grads:  [0.05373194]
Stock Position:  0.05373193592854371
Bond Position:  [-16.25839762]


portfolio before change:  [-10.84355753]
curr_Stock_Price:  100.81290430053778
curr_Factors:  [100.8129043]
mat_Sqrt:  [[0.15]]
grads:  [0.03642974]
Stock Position:  0.03642973671805707
Bond Position:  [-14.5161451]


portfolio before change:  [-10.86608127]
curr_Stock_Price:  100.24443721452792
curr_Factors:  [100.24443721]
mat_Sqrt:  [[0.15]]
grads:  [0.01534024]
Stock Position:  0.015340238017140309
Bond Position:  [-12.4038548]


portfolio before change:  [-10.86473442]
curr_Stock_Price:  100.43331500390194
curr_Factors:  [100.433315]
mat_Sqrt:  [[0.15]]
grads:  [0.05272366]
Stock Position:  0.05272365662407549
Bond Position:  [-16.15994603]


portfolio before change:  [-10.83527436]
curr_Stock_Price:  101.03039391647407
curr_Factors:  [101.03039392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.83527436]
Stock Price:  100.38455618197203
PL:  [-11.21983054]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.19715886e-03]
 [ 9.76672415e-04]
 [ 6.75199866e-03]
 [-2.27234157e-03]
 [ 1.13105168e-02]
 [-1.34507436e-02]
 [-4.92558872e-02]
 [ 1.72994235e-02]
 [-6.10993912e-03]
 [-1.01291854e-03]
 [-5.94781395e-03]
 [ 7.37790509e-03]
 [ 1.39006288e-02]
 [ 2.05996710e-03]
 [-4.01181877e-03]
 [-5.33932546e-03]
 [ 1.69671484e-02]
 [-1.07090231e-02]
 [ 4.01043430e-03]
 [ 8.29922955e-03]
 [ 2.84766839e-02]
 [ 2.08065781e-03]
 [ 5.13214798e-02]
 [-6.53368418e-03]
 [ 1.14132141e-03]
 [ 4.32925263e-02]
 [ 4.69424707e-02]
 [-3.06596418e-02]
 [-4.70706444e-02]
 [ 2.97596592e-03]
 [-4.44259035e-03]
 [ 5.58407540e-03]
 [ 1.68387361e-02]
 [-1.43014996e-02]
 [ 4.48982327e-03]
 [ 4.78913368e-03]
 [ 8.51944160e-03]
 [ 7.45430613e-03]
 [-7.26841402e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.84136075]
curr_Stock_Price:  99.56175092056883
curr_Factors:  [99.56175092]
mat_Sqrt:  [[0.15]]
grads:  [0.02798106]
Stock Position:  0.027981059055145637
Bond Position:  [-7.62720398]


portfolio before change:  [-4.8395812]
curr_Stock_Price:  99.65942429489105
curr_Factors:  [99.65942429]
mat_Sqrt:  [[0.15]]
grads:  [0.00651115]
Stock Position:  0.006511149434629444
Bond Position:  [-5.48847861]


portfolio before change:  [-4.83848624]
curr_Stock_Price:  99.93296556653729
curr_Factors:  [99.93296557]
mat_Sqrt:  [[0.15]]
grads:  [0.04501332]
Stock Position:  0.04501332442114737
Bond Position:  [-9.33680124]


portfolio before change:  [-4.85823364]
curr_Stock_Price:  99.52019377443358
curr_Factors:  [99.52019377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514894]
Stock Position:  -0.015148943788516733
Bond Position:  [-3.35060782]


portfolio before change:  [-4.85745752]
curr_Stock_Price:  99.44131197742891
curr_Factors:  [99.44131198]
mat_Sqrt:  [[0.15]]
grads:  [0.07540345]
Stock Position:  0.07540344507174786
Bond Position:  [-12.35567502]


portfolio before change:  [-4.89364749]
curr_Stock_Price:  98.98184475526908
curr_Factors:  [98.98184476]
mat_Sqrt:  [[0.15]]
grads:  [-0.08967162]
Stock Position:  -0.08967162372197394
Bond Position:  [3.98221525]


portfolio before change:  [-4.7834503]
curr_Stock_Price:  97.75849922931485
curr_Factors:  [97.75849923]
mat_Sqrt:  [[0.15]]
grads:  [-0.32837258]
Stock Position:  -0.32837258136582087
Bond Position:  [27.31776044]


portfolio before change:  [-4.65716144]
curr_Stock_Price:  97.38430864319557
curr_Factors:  [97.38430864]
mat_Sqrt:  [[0.15]]
grads:  [0.11532949]
Stock Position:  0.11532948994574473
Bond Position:  [-15.88844408]


portfolio before change:  [-4.61023593]
curr_Stock_Price:  97.80841256216384
curr_Factors:  [97.80841256]
mat_Sqrt:  [[0.15]]
grads:  [-0.04073293]
Stock Position:  -0.04073292749871462
Bond Position:  [-0.62621295]


portfolio before change:  [-4.61079366]
curr_Stock_Price:  97.82018316387804
curr_Factors:  [97.82018316]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675279]
Stock Position:  -0.006752790275305904
Bond Position:  [-3.95023448]


portfolio before change:  [-4.60965363]
curr_Stock_Price:  97.57823214037644
curr_Factors:  [97.57823214]
mat_Sqrt:  [[0.15]]
grads:  [-0.03965209]
Stock Position:  -0.039652092981243156
Bond Position:  [-0.74047249]


portfolio before change:  [-4.6066469]
curr_Stock_Price:  97.50006993851954
curr_Factors:  [97.50006994]
mat_Sqrt:  [[0.15]]
grads:  [0.04918603]
Stock Position:  0.04918603396553969
Bond Position:  [-9.40228865]


portfolio before change:  [-4.62123899]
curr_Stock_Price:  97.22729464358856
curr_Factors:  [97.22729464]
mat_Sqrt:  [[0.15]]
grads:  [0.09267086]
Stock Position:  0.09267085855093946
Bond Position:  [-13.63137586]


portfolio before change:  [-4.60288047]
curr_Stock_Price:  97.44378712572583
curr_Factors:  [97.44378713]
mat_Sqrt:  [[0.15]]
grads:  [0.01373311]
Stock Position:  0.013733113976977959
Bond Position:  [-5.94108711]


portfolio before change:  [-4.62098183]
curr_Stock_Price:  96.17978585728943
curr_Factors:  [96.17978586]
mat_Sqrt:  [[0.15]]
grads:  [-0.02674546]
Stock Position:  -0.02674545847550577
Bond Position:  [-2.04860936]


portfolio before change:  [-4.64091956]
curr_Stock_Price:  96.91567276019559
curr_Factors:  [96.91567276]
mat_Sqrt:  [[0.15]]
grads:  [-0.0355955]
Stock Position:  -0.035595503093889355
Bond Position:  [-1.19115743]


portfolio before change:  [-4.64642015]
curr_Stock_Price:  97.06602026977976
curr_Factors:  [97.06602027]
mat_Sqrt:  [[0.15]]
grads:  [0.11311432]
Stock Position:  0.11311432239833663
Bond Position:  [-15.62597727]


portfolio before change:  [-4.64308215]
curr_Stock_Price:  97.1127992946718
curr_Factors:  [97.11279929]
mat_Sqrt:  [[0.15]]
grads:  [-0.07139349]
Stock Position:  -0.07139348726088918
Bond Position:  [2.29013925]


portfolio before change:  [-4.60637208]
curr_Stock_Price:  96.6026157467208
curr_Factors:  [96.60261575]
mat_Sqrt:  [[0.15]]
grads:  [0.02673623]
Stock Position:  0.026736228655077302
Bond Position:  [-7.1891617]


portfolio before change:  [-4.67017671]
curr_Stock_Price:  94.24978105268265
curr_Factors:  [94.24978105]
mat_Sqrt:  [[0.15]]
grads:  [0.0553282]
Stock Position:  0.055328196990462784
Bond Position:  [-9.88484716]


portfolio before change:  [-4.70296968]
curr_Stock_Price:  93.67941554039898
curr_Factors:  [93.67941554]
mat_Sqrt:  [[0.15]]
grads:  [0.18984456]
Stock Position:  0.18984455924822366
Bond Position:  [-22.48749704]


portfolio before change:  [-4.84682375]
curr_Stock_Price:  92.93647642398183
curr_Factors:  [92.93647642]
mat_Sqrt:  [[0.15]]
grads:  [0.01387105]
Stock Position:  0.01387105206551884
Bond Position:  [-6.13595045]


portfolio before change:  [-4.85752123]
curr_Stock_Price:  92.22056517579314
curr_Factors:  [92.22056518]
mat_Sqrt:  [[0.15]]
grads:  [0.3421432]
Stock Position:  0.34214319855497466
Bond Position:  [-36.41016037]


portfolio before change:  [-5.33980111]
curr_Stock_Price:  90.8242833718792
curr_Factors:  [90.82428337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04355789]
Stock Position:  -0.04355789454063775
Bond Position:  [-1.38368655]


portfolio before change:  [-5.2920683]
curr_Stock_Price:  89.72446476758057
curr_Factors:  [89.72446477]
mat_Sqrt:  [[0.15]]
grads:  [0.00760881]
Stock Position:  0.0076088094151487845
Bond Position:  [-5.97476465]


portfolio before change:  [-5.28842293]
curr_Stock_Price:  90.30172438829307
curr_Factors:  [90.30172439]
mat_Sqrt:  [[0.15]]
grads:  [0.28861684]
Stock Position:  0.28861684168219276
Bond Position:  [-31.35102142]


portfolio before change:  [-5.42945947]
curr_Stock_Price:  89.82663979860389
curr_Factors:  [89.8266398]
mat_Sqrt:  [[0.15]]
grads:  [0.3129498]
Stock Position:  0.31294980482581236
Bond Position:  [-33.54068886]


portfolio before change:  [-5.03079185]
curr_Stock_Price:  91.11394036984457
curr_Factors:  [91.11394037]
mat_Sqrt:  [[0.15]]
grads:  [-0.20439761]
Stock Position:  -0.20439761167052317
Bond Position:  [13.59267995]


portfolio before change:  [-5.21480038]
curr_Stock_Price:  92.02250145699226
curr_Factors:  [92.02250146]
mat_Sqrt:  [[0.15]]
grads:  [-0.3138043]
Stock Position:  -0.31380429599233467
Bond Position:  [23.66225591]


portfolio before change:  [-5.39387931]
curr_Stock_Price:  92.60259835079566
curr_Factors:  [92.60259835]
mat_Sqrt:  [[0.15]]
grads:  [0.01983977]
Stock Position:  0.019839772821093265
Bond Position:  [-7.23109382]


portfolio before change:  [-5.36913716]
curr_Stock_Price:  93.89525884734174
curr_Factors:  [93.89525885]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961727]
Stock Position:  -0.029617268972600662
Bond Position:  [-2.58821602]


portfolio before change:  [-5.39837771]
curr_Stock_Price:  94.87161497650472
curr_Factors:  [94.87161498]
mat_Sqrt:  [[0.15]]
grads:  [0.03722717]
Stock Position:  0.03722716934036393
Bond Position:  [-8.93017939]


portfolio before change:  [-5.42326615]
curr_Stock_Price:  94.2330464679781
curr_Factors:  [94.23304647]
mat_Sqrt:  [[0.15]]
grads:  [0.11225824]
Stock Position:  0.11225824092712236
Bond Position:  [-16.00170218]


portfolio before change:  [-5.47206844]
curr_Stock_Price:  93.81613320590219
curr_Factors:  [93.81613321]
mat_Sqrt:  [[0.15]]
grads:  [-0.09534333]
Stock Position:  -0.0953433308634959
Bond Position:  [3.47267419]


portfolio before change:  [-5.44005013]
curr_Stock_Price:  93.48486516428572
curr_Factors:  [93.48486516]
mat_Sqrt:  [[0.15]]
grads:  [0.02993216]
Stock Position:  0.029932155112912733
Bond Position:  [-8.23825361]


portfolio before change:  [-5.44447023]
curr_Stock_Price:  93.37160056373231
curr_Factors:  [93.37160056]
mat_Sqrt:  [[0.15]]
grads:  [0.03192756]
Stock Position:  0.031927557836934226
Bond Position:  [-8.4255974]


portfolio before change:  [-5.46658332]
curr_Stock_Price:  92.71198759582194
curr_Factors:  [92.7119876]
mat_Sqrt:  [[0.15]]
grads:  [0.05679628]
Stock Position:  0.05679627731117694
Bond Position:  [-10.73227908]


portfolio before change:  [-5.50753474]
curr_Stock_Price:  92.0145863568539
curr_Factors:  [92.01458636]
mat_Sqrt:  [[0.15]]
grads:  [0.04969537]
Stock Position:  0.04969537422851903
Bond Position:  [-10.08023404]


portfolio before change:  [-5.47461355]
curr_Stock_Price:  92.70240268520605
curr_Factors:  [92.70240269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.47461355]
Stock Price:  92.82007779483888
PL:  [-5.47461355]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.59233326e-03]
 [ 2.90381642e-03]
 [ 9.43946560e-03]
 [-2.93533329e-03]
 [ 1.52708941e-02]
 [ 2.60757781e-02]
 [ 5.73311645e-03]
 [ 1.71185076e-02]
 [-7.85290280e-03]
 [-1.02057748e-03]
 [ 9.82044869e-03]
 [ 4.03995720e-03]
 [ 1.23800409e-02]
 [ 3.86789853e-03]
 [ 2.29194689e-02]
 [ 1.01798169e-03]
 [ 9.79294583e-03]
 [ 1.26161119e-02]
 [ 1.14072961e-02]
 [-1.32642367e-02]
 [-1.73375285e-02]
 [ 2.09817718e-02]
 [-2.55533195e-02]
 [ 6.12749902e-03]
 [-2.56524042e-03]
 [-7.62480915e-03]
 [-1.34682990e-04]
 [-1.13139753e-02]
 [ 2.85362648e-02]
 [-8.08418592e-03]
 [-4.32924271e-03]
 [ 4.60345259e-03]
 [ 5.88084178e-03]
 [-4.08060982e-03]
 [ 8.14072709e-03]
 [ 5.01363113e-03]
 [-1.57615966e-02]
 [ 9.93968109e-03]
 [-1.27998322e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.82844781]
curr_Stock_Price:  99.99201606270725
curr_Factors:  [99.99201606]
mat_Sqrt:  [[0.15]]
grads:  [0.02394889]
Stock Position:  0.023948888388324558
Bond Position:  [-0.56624983]


portfolio before change:  [1.84714161]
curr_Stock_Price:  100.77554273525269
curr_Factors:  [100.77554274]
mat_Sqrt:  [[0.15]]
grads:  [0.01935878]
Stock Position:  0.019358776132510348
Bond Position:  [-0.10374956]


portfolio before change:  [1.83954228]
curr_Stock_Price:  100.38366058110786
curr_Factors:  [100.38366058]
mat_Sqrt:  [[0.15]]
grads:  [0.06292977]
Stock Position:  0.06292977068618309
Bond Position:  [-4.47757846]


portfolio before change:  [1.8213542]
curr_Stock_Price:  100.10353312020659
curr_Factors:  [100.10353312]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956889]
Stock Position:  -0.019568888628320853
Bond Position:  [3.78026909]


portfolio before change:  [1.82076279]
curr_Stock_Price:  100.15790378975606
curr_Factors:  [100.15790379]
mat_Sqrt:  [[0.15]]
grads:  [0.10180596]
Stock Position:  0.10180596072654506
Bond Position:  [-8.37590883]


portfolio before change:  [1.88718708]
curr_Stock_Price:  100.8206483582626
curr_Factors:  [100.82064836]
mat_Sqrt:  [[0.15]]
grads:  [0.17383852]
Stock Position:  0.1738385206583529
Bond Position:  [-15.63932528]


portfolio before change:  [2.04696784]
curr_Stock_Price:  101.7510278632421
curr_Factors:  [101.75102786]
mat_Sqrt:  [[0.15]]
grads:  [0.03822078]
Stock Position:  0.038220776350740004
Bond Position:  [-1.84203544]


portfolio before change:  [2.00894367]
curr_Stock_Price:  100.76219655815824
curr_Factors:  [100.76219656]
mat_Sqrt:  [[0.15]]
grads:  [0.11412338]
Stock Position:  0.11412338424331595
Bond Position:  [-9.49037921]


portfolio before change:  [2.0891097]
curr_Stock_Price:  101.47504262645775
curr_Factors:  [101.47504263]
mat_Sqrt:  [[0.15]]
grads:  [-0.05235269]
Stock Position:  -0.052352685344500716
Bond Position:  [7.40160068]


portfolio before change:  [2.10847514]
curr_Stock_Price:  101.12281279719376
curr_Factors:  [101.1228128]
mat_Sqrt:  [[0.15]]
grads:  [-0.00680385]
Stock Position:  -0.0068038498797704655
Bond Position:  [2.79649958]


portfolio before change:  [2.11309662]
curr_Stock_Price:  100.49494842210146
curr_Factors:  [100.49494842]
mat_Sqrt:  [[0.15]]
grads:  [0.06546966]
Stock Position:  0.06546965792735343
Bond Position:  [-4.46627328]


portfolio before change:  [2.09653489]
curr_Stock_Price:  100.2505082687958
curr_Factors:  [100.25050827]
mat_Sqrt:  [[0.15]]
grads:  [0.02693305]
Stock Position:  0.026933047972351083
Bond Position:  [-0.60351686]


portfolio before change:  [2.11125852]
curr_Stock_Price:  100.7999847607267
curr_Factors:  [100.79998476]
mat_Sqrt:  [[0.15]]
grads:  [0.08253361]
Stock Position:  0.08253360601367182
Bond Position:  [-6.20812771]


portfolio before change:  [2.06982981]
curr_Stock_Price:  100.3074260361851
curr_Factors:  [100.30742604]
mat_Sqrt:  [[0.15]]
grads:  [0.02578599]
Stock Position:  0.025785990178047443
Bond Position:  [-0.5166965]


portfolio before change:  [2.08079178]
curr_Stock_Price:  100.73504441246821
curr_Factors:  [100.73504441]
mat_Sqrt:  [[0.15]]
grads:  [0.15279646]
Stock Position:  0.15279645911321532
Bond Position:  [-13.31116632]


portfolio before change:  [2.08677695]
curr_Stock_Price:  100.7851056147834
curr_Factors:  [100.78510561]
mat_Sqrt:  [[0.15]]
grads:  [0.00678654]
Stock Position:  0.00678654459977271
Bond Position:  [1.40279434]


portfolio before change:  [2.08715872]
curr_Stock_Price:  100.81551948920104
curr_Factors:  [100.81551949]
mat_Sqrt:  [[0.15]]
grads:  [0.06528631]
Stock Position:  0.0652863055559157
Bond Position:  [-4.49471409]


portfolio before change:  [2.06337285]
curr_Stock_Price:  100.45979411300256
curr_Factors:  [100.45979411]
mat_Sqrt:  [[0.15]]
grads:  [0.08410741]
Stock Position:  0.08410741265201466
Bond Position:  [-6.38604051]


portfolio before change:  [2.08551067]
curr_Stock_Price:  100.73249449545082
curr_Factors:  [100.7324945]
mat_Sqrt:  [[0.15]]
grads:  [0.07604864]
Stock Position:  0.07604864077277637
Bond Position:  [-5.57505862]


portfolio before change:  [2.11637625]
curr_Stock_Price:  101.1475250660089
curr_Factors:  [101.14752507]
mat_Sqrt:  [[0.15]]
grads:  [-0.08842824]
Stock Position:  -0.08842824488277945
Bond Position:  [11.06067437]


portfolio before change:  [2.14709654]
curr_Stock_Price:  100.8157575867164
curr_Factors:  [100.81575759]
mat_Sqrt:  [[0.15]]
grads:  [-0.11558352]
Stock Position:  -0.11558352360751699
Bond Position:  [13.79973703]


portfolio before change:  [2.08562264]
curr_Stock_Price:  101.3625394631391
curr_Factors:  [101.36253946]
mat_Sqrt:  [[0.15]]
grads:  [0.13987848]
Stock Position:  0.13987847887012966
Bond Position:  [-12.0928152]


portfolio before change:  [2.11781412]
curr_Stock_Price:  101.60348562815261
curr_Factors:  [101.60348563]
mat_Sqrt:  [[0.15]]
grads:  [-0.17035546]
Stock Position:  -0.17035546310296076
Bond Position:  [19.42652297]


portfolio before change:  [2.19226561]
curr_Stock_Price:  101.18070485396765
curr_Factors:  [101.18070485]
mat_Sqrt:  [[0.15]]
grads:  [0.04084999]
Stock Position:  0.04084999346154558
Bond Position:  [-1.94096553]


portfolio before change:  [2.15348176]
curr_Stock_Price:  100.23722346782154
curr_Factors:  [100.23722347]
mat_Sqrt:  [[0.15]]
grads:  [-0.0171016]
Stock Position:  -0.01710160281133863
Bond Position:  [3.86769894]


portfolio before change:  [2.14250535]
curr_Stock_Price:  100.90733035750858
curr_Factors:  [100.90733036]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083206]
Stock Position:  -0.05083206100177753
Bond Position:  [7.27183292]


portfolio before change:  [2.12616878]
curr_Stock_Price:  101.24659663248845
curr_Factors:  [101.24659663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00089789]
Stock Position:  -0.0008978865983127065
Bond Position:  [2.21707675]


portfolio before change:  [2.12608458]
curr_Stock_Price:  101.64905323538386
curr_Factors:  [101.64905324]
mat_Sqrt:  [[0.15]]
grads:  [-0.0754265]
Stock Position:  -0.07542650207839587
Bond Position:  [9.7931171]


portfolio before change:  [2.0739489]
curr_Stock_Price:  102.35649550614205
curr_Factors:  [102.35649551]
mat_Sqrt:  [[0.15]]
grads:  [0.19024177]
Stock Position:  0.19024176558922595
Bond Position:  [-17.39853153]


portfolio before change:  [2.26596272]
curr_Stock_Price:  103.37724284291512
curr_Factors:  [103.37724284]
mat_Sqrt:  [[0.15]]
grads:  [-0.05389457]
Stock Position:  -0.05389457281600076
Bond Position:  [7.83743506]


portfolio before change:  [2.25214926]
curr_Stock_Price:  103.65172688223225
curr_Factors:  [103.65172688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02886162]
Stock Position:  -0.028861618044921142
Bond Position:  [5.24370581]


portfolio before change:  [2.2217641]
curr_Stock_Price:  104.72722675476813
curr_Factors:  [104.72722675]
mat_Sqrt:  [[0.15]]
grads:  [0.03068968]
Stock Position:  0.03068968393033066
Bond Position:  [-0.99228139]


portfolio before change:  [2.22736647]
curr_Stock_Price:  104.91381776929481
curr_Factors:  [104.91381777]
mat_Sqrt:  [[0.15]]
grads:  [0.03920561]
Stock Position:  0.03920561184836108
Bond Position:  [-1.88584394]


portfolio before change:  [2.17820933]
curr_Stock_Price:  103.66600163304675
curr_Factors:  [103.66600163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02720407]
Stock Position:  -0.02720406547924837
Bond Position:  [4.99834603]


portfolio before change:  [2.18343703]
curr_Stock_Price:  103.49680379618607
curr_Factors:  [103.4968038]
mat_Sqrt:  [[0.15]]
grads:  [0.05427151]
Stock Position:  0.05427151394738082
Bond Position:  [-3.4334912]


portfolio before change:  [2.1858493]
curr_Stock_Price:  103.54916046038413
curr_Factors:  [103.54916046]
mat_Sqrt:  [[0.15]]
grads:  [0.03342421]
Stock Position:  0.03342420752428015
Bond Position:  [-1.27519933]


portfolio before change:  [2.20686626]
curr_Stock_Price:  104.18272428374885
curr_Factors:  [104.18272428]
mat_Sqrt:  [[0.15]]
grads:  [-0.10507731]
Stock Position:  -0.10507731055313395
Bond Position:  [13.15410673]


portfolio before change:  [2.20820867]
curr_Stock_Price:  104.18559790036271
curr_Factors:  [104.1855979]
mat_Sqrt:  [[0.15]]
grads:  [0.06626454]
Stock Position:  0.06626454059167562
Bond Position:  [-4.69560211]


portfolio before change:  [2.21374151]
curr_Stock_Price:  104.27795244661371
curr_Factors:  [104.27795245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.21374151]
Stock Price:  104.60512713544011
PL:  [-2.39138562]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.08722678e-03]
 [-1.05245957e-03]
 [ 1.44981209e-02]
 [ 3.14508854e-03]
 [ 9.28301281e-03]
 [ 3.17497998e-02]
 [ 2.27976848e-02]
 [ 4.22963982e-03]
 [-9.98594339e-03]
 [-2.63070446e-03]
 [ 1.18462249e-02]
 [ 4.11973769e-03]
 [ 1.18735622e-02]
 [ 1.88056516e-03]
 [ 2.20222714e-02]
 [ 1.62917169e-03]
 [ 9.44604059e-03]
 [ 1.30988505e-02]
 [ 1.16670088e-02]
 [-1.36564002e-02]
 [-1.44340122e-02]
 [ 2.21477351e-02]
 [-2.38360458e-02]
 [ 4.86327208e-03]
 [-1.18079198e-03]
 [-1.32035079e-02]
 [-5.12020427e-04]
 [-1.06978714e-02]
 [ 5.90767750e-02]
 [-2.99050960e-03]
 [-1.01252550e-02]
 [ 4.25252597e-03]
 [ 5.89039995e-03]
 [-6.95005495e-04]
 [ 7.71432611e-03]
 [ 3.98679566e-03]
 [-4.65821874e-02]
 [ 9.84376098e-03]
 [-7.65878610e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.48432873]
curr_Stock_Price:  100.80843895667972
curr_Factors:  [100.80843896]
mat_Sqrt:  [[0.15]]
grads:  [0.04058151]
Stock Position:  0.04058151189607374
Bond Position:  [10.39336986]


portfolio before change:  [14.50953284]
curr_Stock_Price:  101.39749679024214
curr_Factors:  [101.39749679]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070164]
Stock Position:  -0.00701639710061665
Bond Position:  [15.22097794]


portfolio before change:  [14.50759424]
curr_Stock_Price:  101.94497654203549
curr_Factors:  [101.94497654]
mat_Sqrt:  [[0.15]]
grads:  [0.09665414]
Stock Position:  0.0966541395108953
Bond Position:  [4.65419026]


portfolio before change:  [14.46400161]
curr_Stock_Price:  101.487940359288
curr_Factors:  [101.48794036]
mat_Sqrt:  [[0.15]]
grads:  [0.02096726]
Stock Position:  0.020967256917576657
Bond Position:  [12.33607789]


portfolio before change:  [14.4794232]
curr_Stock_Price:  102.14990014918034
curr_Factors:  [102.14990015]
mat_Sqrt:  [[0.15]]
grads:  [0.06188675]
Stock Position:  0.06188675206679595
Bond Position:  [8.15769766]


portfolio before change:  [14.5482989]
curr_Stock_Price:  103.24635336613561
curr_Factors:  [103.24635337]
mat_Sqrt:  [[0.15]]
grads:  [0.21166533]
Stock Position:  0.21166533182535735
Bond Position:  [-7.30537474]


portfolio before change:  [14.43491341]
curr_Stock_Price:  102.7149850007311
curr_Factors:  [102.714985]
mat_Sqrt:  [[0.15]]
grads:  [0.15198457]
Stock Position:  0.15198456542679267
Bond Position:  [-1.17617894]


portfolio before change:  [14.48853205]
curr_Stock_Price:  103.06874242067165
curr_Factors:  [103.06874242]
mat_Sqrt:  [[0.15]]
grads:  [0.0281976]
Stock Position:  0.02819759876726317
Bond Position:  [11.58224101]


portfolio before change:  [14.48534021]
curr_Stock_Price:  102.90419962186029
curr_Factors:  [102.90419962]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657296]
Stock Position:  -0.06657295596496851
Bond Position:  [21.33597696]


portfolio before change:  [14.45202594]
curr_Stock_Price:  103.44468084055934
curr_Factors:  [103.44468084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01753803]
Stock Position:  -0.01753802970178164
Bond Position:  [16.26624183]


portfolio before change:  [14.47854193]
curr_Stock_Price:  102.04870968429678
curr_Factors:  [102.04870968]
mat_Sqrt:  [[0.15]]
grads:  [0.07897483]
Stock Position:  0.07897483286189234
Bond Position:  [6.41926214]


portfolio before change:  [14.31712372]
curr_Stock_Price:  99.9946290848468
curr_Factors:  [99.99462908]
mat_Sqrt:  [[0.15]]
grads:  [0.02746492]
Stock Position:  0.0274649179448783
Bond Position:  [11.57077943]


portfolio before change:  [14.33029562]
curr_Stock_Price:  100.42155408772415
curr_Factors:  [100.42155409]
mat_Sqrt:  [[0.15]]
grads:  [0.07915708]
Stock Position:  0.07915708126415066
Bond Position:  [6.3812185]


portfolio before change:  [14.34209658]
curr_Stock_Price:  100.56055948703305
curr_Factors:  [100.56055949]
mat_Sqrt:  [[0.15]]
grads:  [0.0125371]
Stock Position:  0.012537101082509185
Bond Position:  [13.08135868]


portfolio before change:  [14.34412009]
curr_Stock_Price:  100.59152658529244
curr_Factors:  [100.59152659]
mat_Sqrt:  [[0.15]]
grads:  [0.14681514]
Stock Position:  0.1468151426121281
Bond Position:  [-0.42423923]


portfolio before change:  [14.44413777]
curr_Stock_Price:  101.2731369001266
curr_Factors:  [101.2731369]
mat_Sqrt:  [[0.15]]
grads:  [0.01086114]
Stock Position:  0.010861144613583056
Bond Position:  [13.34419559]


portfolio before change:  [14.43745967]
curr_Stock_Price:  100.50468852051513
curr_Factors:  [100.50468852]
mat_Sqrt:  [[0.15]]
grads:  [0.0629736]
Stock Position:  0.06297360395683438
Bond Position:  [8.10831722]


portfolio before change:  [14.44648216]
curr_Stock_Price:  100.63186703997923
curr_Factors:  [100.63186704]
mat_Sqrt:  [[0.15]]
grads:  [0.08732567]
Stock Position:  0.0873256698695593
Bond Position:  [5.65873696]


portfolio before change:  [14.50062672]
curr_Stock_Price:  101.24379673458185
curr_Factors:  [101.24379673]
mat_Sqrt:  [[0.15]]
grads:  [0.07778006]
Stock Position:  0.07778005857397954
Bond Position:  [6.62587828]


portfolio before change:  [14.5289856]
curr_Stock_Price:  101.59775113552152
curr_Factors:  [101.59775114]
mat_Sqrt:  [[0.15]]
grads:  [-0.09104267]
Stock Position:  -0.09104266786798405
Bond Position:  [23.77871591]


portfolio before change:  [14.55910771]
curr_Stock_Price:  101.29954392619247
curr_Factors:  [101.29954393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09622675]
Stock Position:  -0.09622674826853353
Bond Position:  [24.30683342]


portfolio before change:  [14.50932076]
curr_Stock_Price:  101.84851276773993
curr_Factors:  [101.84851277]
mat_Sqrt:  [[0.15]]
grads:  [0.14765157]
Stock Position:  0.14765156735079157
Bond Position:  [-0.52877178]


portfolio before change:  [14.45414109]
curr_Stock_Price:  101.47524499923747
curr_Factors:  [101.475245]
mat_Sqrt:  [[0.15]]
grads:  [-0.15890697]
Stock Position:  -0.15890697187716604
Bond Position:  [30.579265]


portfolio before change:  [14.35955962]
curr_Stock_Price:  102.09450113491233
curr_Factors:  [102.09450113]
mat_Sqrt:  [[0.15]]
grads:  [0.03242181]
Stock Position:  0.03242181384670993
Bond Position:  [11.04947071]


portfolio before change:  [14.38006863]
curr_Stock_Price:  102.68446618464586
curr_Factors:  [102.68446618]
mat_Sqrt:  [[0.15]]
grads:  [-0.00787195]
Stock Position:  -0.007871946564656068
Bond Position:  [15.18839526]


portfolio before change:  [14.37029646]
curr_Stock_Price:  104.16705246480166
curr_Factors:  [104.16705246]
mat_Sqrt:  [[0.15]]
grads:  [-0.08802339]
Stock Position:  -0.08802338615379725
Bond Position:  [23.53943314]


portfolio before change:  [14.35941987]
curr_Stock_Price:  104.32404706373256
curr_Factors:  [104.32404706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00341347]
Stock Position:  -0.0034134695135316136
Bond Position:  [14.71552683]


portfolio before change:  [14.36158119]
curr_Stock_Price:  104.22978585089689
curr_Factors:  [104.22978585]
mat_Sqrt:  [[0.15]]
grads:  [-0.07131914]
Stock Position:  -0.07131914274160168
Bond Position:  [21.79516016]


portfolio before change:  [14.30575498]
curr_Stock_Price:  105.05075433147682
curr_Factors:  [105.05075433]
mat_Sqrt:  [[0.15]]
grads:  [0.39384517]
Stock Position:  0.39384516644011325
Bond Position:  [-27.06797684]


portfolio before change:  [14.67838348]
curr_Stock_Price:  106.00547522379124
curr_Factors:  [106.00547522]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993673]
Stock Position:  -0.019936730635578843
Bond Position:  [16.79178609]


portfolio before change:  [14.67876757]
curr_Stock_Price:  106.09149851167344
curr_Factors:  [106.09149851]
mat_Sqrt:  [[0.15]]
grads:  [-0.0675017]
Stock Position:  -0.06750169971763026
Bond Position:  [21.84012404]


portfolio before change:  [14.6553284]
curr_Stock_Price:  106.47918282293253
curr_Factors:  [106.47918282]
mat_Sqrt:  [[0.15]]
grads:  [0.02835017]
Stock Position:  0.028350173112717144
Bond Position:  [11.63662514]


portfolio before change:  [14.60957669]
curr_Stock_Price:  104.81406501328216
curr_Factors:  [104.81406501]
mat_Sqrt:  [[0.15]]
grads:  [0.03926933]
Stock Position:  0.03926933299090235
Bond Position:  [10.49359827]


portfolio before change:  [14.65017155]
curr_Stock_Price:  105.81441489701723
curr_Factors:  [105.8144149]
mat_Sqrt:  [[0.15]]
grads:  [-0.00463337]
Stock Position:  -0.004633369964865824
Bond Position:  [15.14044888]


portfolio before change:  [14.65089372]
curr_Stock_Price:  106.06703842101638
curr_Factors:  [106.06703842]
mat_Sqrt:  [[0.15]]
grads:  [0.05142884]
Stock Position:  0.051428840736079375
Bond Position:  [9.1959889]


portfolio before change:  [14.65941462]
curr_Stock_Price:  106.21036903232377
curr_Factors:  [106.21036903]
mat_Sqrt:  [[0.15]]
grads:  [0.02657864]
Stock Position:  0.026578637765661748
Bond Position:  [11.8364877]


portfolio before change:  [14.67959504]
curr_Stock_Price:  106.91397052750638
curr_Factors:  [106.91397053]
mat_Sqrt:  [[0.15]]
grads:  [-0.31054792]
Stock Position:  -0.3105479162248811
Bond Position:  [47.88150581]


portfolio before change:  [15.06453602]
curr_Stock_Price:  105.6936905126222
curr_Factors:  [105.69369051]
mat_Sqrt:  [[0.15]]
grads:  [0.06562507]
Stock Position:  0.0656250732000963
Bond Position:  [8.12837985]


portfolio before change:  [15.10663247]
curr_Stock_Price:  106.319675827813
curr_Factors:  [106.31967583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.10663247]
Stock Price:  106.17623902551532
PL:  [8.93039344]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.33089952e-03]
 [ 1.24960184e-03]
 [ 1.45400629e-02]
 [ 9.58828933e-03]
 [ 1.33180432e-02]
 [ 2.24338616e-02]
 [-2.39666798e-02]
 [ 1.96692503e-02]
 [-5.92435280e-03]
 [ 1.65994415e-03]
 [-6.08154468e-03]
 [ 7.46645853e-03]
 [ 1.38857131e-02]
 [-2.37130435e-03]
 [-1.17365099e-02]
 [-1.51677279e-02]
 [ 2.30218734e-02]
 [-2.90130104e-02]
 [ 1.84312731e-03]
 [ 6.99740845e-03]
 [ 2.72714247e-02]
 [ 2.46028894e-03]
 [ 3.03604470e-02]
 [-4.03864400e-04]
 [ 1.12449567e-02]
 [ 3.18512770e-04]
 [ 2.84803458e-02]
 [-2.61834109e-02]
 [-4.74420580e-02]
 [ 1.65834086e-03]
 [-4.20441673e-03]
 [ 5.58406735e-03]
 [ 1.38576833e-02]
 [-1.32596215e-02]
 [ 3.60288597e-03]
 [ 5.49032718e-03]
 [ 5.80433894e-03]
 [ 9.67697205e-03]
 [-5.25321866e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.79017796]
curr_Stock_Price:  101.27973468193619
curr_Factors:  [101.27973468]
mat_Sqrt:  [[0.15]]
grads:  [0.05553933]
Stock Position:  0.05553933011212503
Bond Position:  [16.16516934]


portfolio before change:  [21.78339958]
curr_Stock_Price:  101.12130363641926
curr_Factors:  [101.12130364]
mat_Sqrt:  [[0.15]]
grads:  [0.00833068]
Stock Position:  0.00833067893032059
Bond Position:  [20.94099047]


portfolio before change:  [21.78650414]
curr_Stock_Price:  101.17973503443915
curr_Factors:  [101.17973503]
mat_Sqrt:  [[0.15]]
grads:  [0.09693375]
Stock Position:  0.09693375283224857
Bond Position:  [11.97877271]


portfolio before change:  [21.88085016]
curr_Stock_Price:  102.13759107376752
curr_Factors:  [102.13759107]
mat_Sqrt:  [[0.15]]
grads:  [0.06392193]
Stock Position:  0.06392192885903189
Bond Position:  [15.35201833]


portfolio before change:  [21.870321]
curr_Stock_Price:  101.94284908096985
curr_Factors:  [101.94284908]
mat_Sqrt:  [[0.15]]
grads:  [0.08878695]
Stock Position:  0.08878695460328885
Bond Position:  [12.81912589]


portfolio before change:  [21.73578344]
curr_Stock_Price:  100.40951508849496
curr_Factors:  [100.40951509]
mat_Sqrt:  [[0.15]]
grads:  [0.14955908]
Stock Position:  0.1495590771351629
Bond Position:  [6.71862902]


portfolio before change:  [21.52866239]
curr_Stock_Price:  99.01902160003029
curr_Factors:  [99.0190216]
mat_Sqrt:  [[0.15]]
grads:  [-0.15977787]
Stock Position:  -0.1597778650341735
Bond Position:  [37.34971026]


portfolio before change:  [21.70182652]
curr_Stock_Price:  97.96446303472355
curr_Factors:  [97.96446303]
mat_Sqrt:  [[0.15]]
grads:  [0.13112834]
Stock Position:  0.1311283354702996
Bond Position:  [8.85590954]


portfolio before change:  [21.78990231]
curr_Stock_Price:  98.62769678858214
curr_Factors:  [98.62769679]
mat_Sqrt:  [[0.15]]
grads:  [-0.03949569]
Stock Position:  -0.039495685359502056
Bond Position:  [25.68527079]


portfolio before change:  [21.79901966]
curr_Stock_Price:  98.47814907933176
curr_Factors:  [98.47814908]
mat_Sqrt:  [[0.15]]
grads:  [0.01106629]
Stock Position:  0.011066294343950445
Bond Position:  [20.70923148]


portfolio before change:  [21.79140702]
curr_Stock_Price:  97.556299405379
curr_Factors:  [97.55629941]
mat_Sqrt:  [[0.15]]
grads:  [-0.04054363]
Stock Position:  -0.0405436312297389
Bond Position:  [25.74669364]


portfolio before change:  [21.81151993]
curr_Stock_Price:  97.13960320595879
curr_Factors:  [97.13960321]
mat_Sqrt:  [[0.15]]
grads:  [0.04977639]
Stock Position:  0.0497763902320466
Bond Position:  [16.97626114]


portfolio before change:  [21.76767639]
curr_Stock_Price:  96.21615918614636
curr_Factors:  [96.21615919]
mat_Sqrt:  [[0.15]]
grads:  [0.09257142]
Stock Position:  0.09257142035308549
Bond Position:  [12.86080987]


portfolio before change:  [21.64218157]
curr_Stock_Price:  94.84313803301647
curr_Factors:  [94.84313803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0158087]
Stock Position:  -0.015808695678500517
Bond Position:  [23.14152788]


portfolio before change:  [21.6541438]
curr_Stock_Price:  94.26944374669885
curr_Factors:  [94.26944375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0782434]
Stock Position:  -0.0782433993895197
Bond Position:  [29.03010554]


portfolio before change:  [21.78188154]
curr_Stock_Price:  92.68325565372906
curr_Factors:  [92.68325565]
mat_Sqrt:  [[0.15]]
grads:  [-0.10111819]
Stock Position:  -0.10111818626038999
Bond Position:  [31.15384425]


portfolio before change:  [21.58153689]
curr_Stock_Price:  94.70306168292609
curr_Factors:  [94.70306168]
mat_Sqrt:  [[0.15]]
grads:  [0.15347916]
Stock Position:  0.15347915617047783
Bond Position:  [7.0465909]


portfolio before change:  [21.67577881]
curr_Stock_Price:  95.31135955547903
curr_Factors:  [95.31135956]
mat_Sqrt:  [[0.15]]
grads:  [-0.19342007]
Stock Position:  -0.19342006941889958
Bond Position:  [40.1109086]


portfolio before change:  [21.70504036]
curr_Stock_Price:  95.1859983494429
curr_Factors:  [95.18599835]
mat_Sqrt:  [[0.15]]
grads:  [0.01228752]
Stock Position:  0.012287515432906407
Bond Position:  [20.53544094]


portfolio before change:  [21.70034245]
curr_Stock_Price:  94.59474774866692
curr_Factors:  [94.59474775]
mat_Sqrt:  [[0.15]]
grads:  [0.04664939]
Stock Position:  0.04664938968603087
Bond Position:  [17.2875552]


portfolio before change:  [21.68921529]
curr_Stock_Price:  94.30989411581554
curr_Factors:  [94.30989412]
mat_Sqrt:  [[0.15]]
grads:  [0.1818095]
Stock Position:  0.18180949811720343
Bond Position:  [4.54278077]


portfolio before change:  [21.36607978]
curr_Stock_Price:  92.52944044042938
curr_Factors:  [92.52944044]
mat_Sqrt:  [[0.15]]
grads:  [0.01640193]
Stock Position:  0.016401926280804648
Bond Position:  [19.84841872]


portfolio before change:  [21.39304939]
curr_Stock_Price:  94.02246028843348
curr_Factors:  [94.02246029]
mat_Sqrt:  [[0.15]]
grads:  [0.20240298]
Stock Position:  0.20240297991521752
Bond Position:  [2.36262325]


portfolio before change:  [21.36590496]
curr_Stock_Price:  93.88689025408787
curr_Factors:  [93.88689025]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269243]
Stock Position:  -0.0026924293365566494
Bond Position:  [21.61868877]


portfolio before change:  [21.36671941]
curr_Stock_Price:  94.58813370873035
curr_Factors:  [94.58813371]
mat_Sqrt:  [[0.15]]
grads:  [0.07496638]
Stock Position:  0.07496637808639463
Bond Position:  [14.27578962]


portfolio before change:  [21.43926855]
curr_Stock_Price:  95.53208423345764
curr_Factors:  [95.53208423]
mat_Sqrt:  [[0.15]]
grads:  [0.00212342]
Stock Position:  0.0021234184691264436
Bond Position:  [21.23641396]


portfolio before change:  [21.44028696]
curr_Stock_Price:  94.76148538655987
curr_Factors:  [94.76148539]
mat_Sqrt:  [[0.15]]
grads:  [0.18986897]
Stock Position:  0.18986897230938815
Bond Position:  [3.44802112]


portfolio before change:  [21.21246274]
curr_Stock_Price:  93.5593128953403
curr_Factors:  [93.5593129]
mat_Sqrt:  [[0.15]]
grads:  [-0.17455607]
Stock Position:  -0.1745560725479593
Bond Position:  [37.54380895]


portfolio before change:  [21.08340738]
curr_Stock_Price:  94.32553448096797
curr_Factors:  [94.32553448]
mat_Sqrt:  [[0.15]]
grads:  [-0.31628039]
Stock Position:  -0.31628038673853953
Bond Position:  [50.9167239]


portfolio before change:  [20.8213341]
curr_Stock_Price:  95.174269564928
curr_Factors:  [95.17426956]
mat_Sqrt:  [[0.15]]
grads:  [0.01105561]
Stock Position:  0.011055605701170031
Bond Position:  [19.76912491]


portfolio before change:  [20.82871725]
curr_Stock_Price:  95.61855593313886
curr_Factors:  [95.61855593]
mat_Sqrt:  [[0.15]]
grads:  [-0.02802944]
Stock Position:  -0.02802944489490971
Bond Position:  [23.5088523]


portfolio before change:  [20.85250564]
curr_Stock_Price:  94.87470981180552
curr_Factors:  [94.87470981]
mat_Sqrt:  [[0.15]]
grads:  [0.03722712]
Stock Position:  0.03722711566486213
Bond Position:  [17.32059384]


portfolio before change:  [20.87793716]
curr_Stock_Price:  95.49969276538219
curr_Factors:  [95.49969277]
mat_Sqrt:  [[0.15]]
grads:  [0.09238456]
Stock Position:  0.09238455558193959
Bond Position:  [12.05524049]


portfolio before change:  [20.83765256]
curr_Stock_Price:  95.04732713522642
curr_Factors:  [95.04732714]
mat_Sqrt:  [[0.15]]
grads:  [-0.08839748]
Stock Position:  -0.08839747640897573
Bond Position:  [29.23959642]


portfolio before change:  [20.85371903]
curr_Stock_Price:  94.90692388403535
curr_Factors:  [94.90692388]
mat_Sqrt:  [[0.15]]
grads:  [0.02401924]
Stock Position:  0.02401923980664509
Bond Position:  [18.57412687]


portfolio before change:  [20.84583683]
curr_Stock_Price:  94.48209302392915
curr_Factors:  [94.48209302]
mat_Sqrt:  [[0.15]]
grads:  [0.03660218]
Stock Position:  0.03660218122102682
Bond Position:  [17.38758614]


portfolio before change:  [20.83695439]
curr_Stock_Price:  94.18003380214599
curr_Factors:  [94.1800338]
mat_Sqrt:  [[0.15]]
grads:  [0.03869559]
Stock Position:  0.03869559294299362
Bond Position:  [17.19260214]


portfolio before change:  [20.84669975]
curr_Stock_Price:  94.37633907462815
curr_Factors:  [94.37633907]
mat_Sqrt:  [[0.15]]
grads:  [0.06451315]
Stock Position:  0.06451314702990399
Bond Position:  [14.75818511]


portfolio before change:  [20.89032135]
curr_Stock_Price:  95.02390811970639
curr_Factors:  [95.02390812]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.89032135]
Stock Price:  95.6966263522686
PL:  [20.89032135]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.92689533e-03]
 [-5.71150128e-03]
 [-3.32016405e-02]
 [ 1.03190142e-02]
 [-1.00515405e-01]
 [-3.04104215e-02]
 [-5.12139963e-02]
 [ 1.89570344e-02]
 [-6.29178669e-03]
 [ 3.63059926e-03]
 [-1.29589408e-02]
 [ 7.66467034e-03]
 [ 1.38770012e-02]
 [-2.72433656e-03]
 [-1.31867204e-02]
 [-1.41732027e-02]
 [ 2.74881423e-02]
 [-5.62429080e-02]
 [-1.83482946e-03]
 [ 1.87677559e-02]
 [ 2.95009507e-02]
 [ 1.39429934e-03]
 [ 5.47989718e-02]
 [-7.60539319e-03]
 [ 3.72425869e-03]
 [ 4.25581741e-02]
 [ 4.15797686e-02]
 [-2.90472611e-02]
 [-4.72588078e-02]
 [ 2.28171645e-03]
 [-4.39133853e-03]
 [ 5.58260122e-03]
 [ 1.47139327e-02]
 [-1.29032091e-02]
 [ 3.16194826e-03]
 [ 5.55639655e-03]
 [ 3.31242904e-03]
 [ 1.03905478e-02]
 [-4.80295196e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.1385812]
curr_Stock_Price:  99.73610552392923
curr_Factors:  [99.73610552]
mat_Sqrt:  [[0.15]]
grads:  [0.01951264]
Stock Position:  0.01951263550530406
Bond Position:  [-4.08469548]


portfolio before change:  [-2.14996208]
curr_Stock_Price:  99.1790174176226
curr_Factors:  [99.17901742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03807668]
Stock Position:  -0.03807667517481226
Bond Position:  [1.62644515]


portfolio before change:  [-2.06693798]
curr_Stock_Price:  97.00391207933527
curr_Factors:  [97.00391208]
mat_Sqrt:  [[0.15]]
grads:  [-0.22134427]
Stock Position:  -0.22134426973434276
Bond Position:  [19.4043221]


portfolio before change:  [-2.02529432]
curr_Stock_Price:  96.82673121964842
curr_Factors:  [96.82673122]
mat_Sqrt:  [[0.15]]
grads:  [0.06879343]
Stock Position:  0.06879342831050604
Bond Position:  [-8.68633712]


portfolio before change:  [-2.10131962]
curr_Stock_Price:  95.73739112365146
curr_Factors:  [95.73739112]
mat_Sqrt:  [[0.15]]
grads:  [-0.6701027]
Stock Position:  -0.6701026973591969
Bond Position:  [62.05256441]


portfolio before change:  [-3.15856457]
curr_Stock_Price:  97.32670274191261
curr_Factors:  [97.32670274]
mat_Sqrt:  [[0.15]]
grads:  [-0.20273614]
Stock Position:  -0.20273614338968132
Bond Position:  [16.57307579]


portfolio before change:  [-3.31179266]
curr_Stock_Price:  98.09272233268216
curr_Factors:  [98.09272233]
mat_Sqrt:  [[0.15]]
grads:  [-0.34142664]
Stock Position:  -0.34142664171557724
Bond Position:  [30.1796761]


portfolio before change:  [-3.16454342]
curr_Stock_Price:  97.67249577075675
curr_Factors:  [97.67249577]
mat_Sqrt:  [[0.15]]
grads:  [0.12638023]
Stock Position:  0.12638022963029297
Bond Position:  [-15.50841587]


portfolio before change:  [-3.21706902]
curr_Stock_Price:  97.27222013041579
curr_Factors:  [97.27222013]
mat_Sqrt:  [[0.15]]
grads:  [-0.04194524]
Stock Position:  -0.04194524458741519
Bond Position:  [0.86303804]


portfolio before change:  [-3.19768333]
curr_Stock_Price:  96.8126255127368
curr_Factors:  [96.81262551]
mat_Sqrt:  [[0.15]]
grads:  [0.024204]
Stock Position:  0.02420399509037928
Bond Position:  [-5.54093564]


portfolio before change:  [-3.22249338]
curr_Stock_Price:  95.81620369343322
curr_Factors:  [95.81620369]
mat_Sqrt:  [[0.15]]
grads:  [-0.08639294]
Stock Position:  -0.08639293872140301
Bond Position:  [5.05535004]


portfolio before change:  [-3.20486841]
curr_Stock_Price:  95.61950924538952
curr_Factors:  [95.61950925]
mat_Sqrt:  [[0.15]]
grads:  [0.0510978]
Stock Position:  0.05109780223553378
Bond Position:  [-8.09081518]


portfolio before change:  [-3.20556956]
curr_Stock_Price:  95.62558126569462
curr_Factors:  [95.62558127]
mat_Sqrt:  [[0.15]]
grads:  [0.09251334]
Stock Position:  0.09251334108816607
Bond Position:  [-12.05221157]


portfolio before change:  [-3.30118993]
curr_Stock_Price:  94.608282040316
curr_Factors:  [94.60828204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01816224]
Stock Position:  -0.01816224370707813
Bond Position:  [-1.58289125]


portfolio before change:  [-3.28872]
curr_Stock_Price:  93.91080181095501
curr_Factors:  [93.91080181]
mat_Sqrt:  [[0.15]]
grads:  [-0.08791147]
Stock Position:  -0.08791146937229029
Bond Position:  [4.96711658]


portfolio before change:  [-3.22345863]
curr_Stock_Price:  93.17551162226644
curr_Factors:  [93.17551162]
mat_Sqrt:  [[0.15]]
grads:  [-0.09448802]
Stock Position:  -0.09448801771079608
Bond Position:  [5.58051077]


portfolio before change:  [-3.19818954]
curr_Stock_Price:  92.91546300516669
curr_Factors:  [92.91546301]
mat_Sqrt:  [[0.15]]
grads:  [0.18325428]
Stock Position:  0.18325428168310723
Bond Position:  [-20.22534597]


portfolio before change:  [-3.19529762]
curr_Stock_Price:  92.94504075475056
curr_Factors:  [92.94504075]
mat_Sqrt:  [[0.15]]
grads:  [-0.37495272]
Stock Position:  -0.3749527202878548
Bond Position:  [31.65469825]


portfolio before change:  [-3.29615736]
curr_Stock_Price:  93.22458753205547
curr_Factors:  [93.22458753]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122322]
Stock Position:  -0.012232196392104312
Bond Position:  [-2.15581589]


portfolio before change:  [-3.27503472]
curr_Stock_Price:  91.47574938411938
curr_Factors:  [91.47574938]
mat_Sqrt:  [[0.15]]
grads:  [0.12511837]
Stock Position:  0.1251183726454234
Bond Position:  [-14.72033162]


portfolio before change:  [-3.1248963]
curr_Stock_Price:  92.6904277158794
curr_Factors:  [92.69042772]
mat_Sqrt:  [[0.15]]
grads:  [0.196673]
Stock Position:  0.19667300480411937
Bond Position:  [-21.35460124]


portfolio before change:  [-2.94598518]
curr_Stock_Price:  93.61368923086545
curr_Factors:  [93.61368923]
mat_Sqrt:  [[0.15]]
grads:  [0.00929533]
Stock Position:  0.009295328903279066
Bond Position:  [-3.81615521]


portfolio before change:  [-2.96143771]
curr_Stock_Price:  92.00261309315927
curr_Factors:  [92.00261309]
mat_Sqrt:  [[0.15]]
grads:  [0.36532648]
Stock Position:  0.3653264785133073
Bond Position:  [-36.57242836]


portfolio before change:  [-3.5904008]
curr_Stock_Price:  90.29348086888787
curr_Factors:  [90.29348087]
mat_Sqrt:  [[0.15]]
grads:  [-0.05070262]
Stock Position:  -0.05070262123843325
Bond Position:  [0.98771536]


portfolio before change:  [-3.61822023]
curr_Stock_Price:  90.84459429988331
curr_Factors:  [90.8445943]
mat_Sqrt:  [[0.15]]
grads:  [0.02482839]
Stock Position:  0.024828391293529376
Bond Position:  [-5.87374536]


portfolio before change:  [-3.63007773]
curr_Stock_Price:  90.39658936036874
curr_Factors:  [90.39658936]
mat_Sqrt:  [[0.15]]
grads:  [0.28372116]
Stock Position:  0.28372116049687846
Bond Position:  [-29.27750297]


portfolio before change:  [-3.38709085]
curr_Stock_Price:  91.26591752871298
curr_Factors:  [91.26591753]
mat_Sqrt:  [[0.15]]
grads:  [0.27719846]
Stock Position:  0.27719845751160543
Bond Position:  [-28.68586241]


portfolio before change:  [-3.1845504]
curr_Stock_Price:  92.00952341517885
curr_Factors:  [92.00952342]
mat_Sqrt:  [[0.15]]
grads:  [-0.19364841]
Stock Position:  -0.19364840763118654
Bond Position:  [14.63294729]


portfolio before change:  [-3.41117343]
curr_Stock_Price:  93.18925043869153
curr_Factors:  [93.18925044]
mat_Sqrt:  [[0.15]]
grads:  [-0.31505872]
Stock Position:  -0.31505871845464883
Bond Position:  [25.94891239]


portfolio before change:  [-3.66595378]
curr_Stock_Price:  94.0082221228757
curr_Factors:  [94.00822212]
mat_Sqrt:  [[0.15]]
grads:  [0.01521144]
Stock Position:  0.015211442967802073
Bond Position:  [-5.09595449]


portfolio before change:  [-3.66266828]
curr_Stock_Price:  94.26608965498359
curr_Factors:  [94.26608965]
mat_Sqrt:  [[0.15]]
grads:  [-0.02927559]
Stock Position:  -0.029275590169812578
Bond Position:  [-0.90297287]


portfolio before change:  [-3.69709751]
curr_Stock_Price:  95.43827273896164
curr_Factors:  [95.43827274]
mat_Sqrt:  [[0.15]]
grads:  [0.03721734]
Stock Position:  0.037217341470127584
Bond Position:  [-7.2490563]


portfolio before change:  [-3.70920142]
curr_Stock_Price:  95.13739906418802
curr_Factors:  [95.13739906]
mat_Sqrt:  [[0.15]]
grads:  [0.09809288]
Stock Position:  0.09809288447976611
Bond Position:  [-13.04150331]


portfolio before change:  [-3.67835288]
curr_Stock_Price:  95.46850189111693
curr_Factors:  [95.46850189]
mat_Sqrt:  [[0.15]]
grads:  [-0.08602139]
Stock Position:  -0.0860213937426661
Bond Position:  [4.53398071]


portfolio before change:  [-3.69029304]
curr_Stock_Price:  95.61389529338614
curr_Factors:  [95.61389529]
mat_Sqrt:  [[0.15]]
grads:  [0.02107966]
Stock Position:  0.021079655097949176
Bond Position:  [-5.70580097]


portfolio before change:  [-3.69989022]
curr_Stock_Price:  95.19245025973788
curr_Factors:  [95.19245026]
mat_Sqrt:  [[0.15]]
grads:  [0.03704264]
Stock Position:  0.0370426436812484
Bond Position:  [-7.22607024]


portfolio before change:  [-3.67963314]
curr_Stock_Price:  95.76369464099628
curr_Factors:  [95.76369464]
mat_Sqrt:  [[0.15]]
grads:  [0.02208286]
Stock Position:  0.022082860287010533
Bond Position:  [-5.79436942]


portfolio before change:  [-3.69189]
curr_Stock_Price:  95.2414560440835
curr_Factors:  [95.24145604]
mat_Sqrt:  [[0.15]]
grads:  [0.06927032]
Stock Position:  0.06927031896225704
Bond Position:  [-10.28929604]


portfolio before change:  [-3.68788696]
curr_Stock_Price:  95.31781315943901
curr_Factors:  [95.31781316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.68788696]
Stock Price:  95.85628956919447
PL:  [-3.68788696]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.03413719e-03]
 [ 4.36260899e-03]
 [ 1.52869323e-02]
 [ 4.30213326e-03]
 [ 1.55554707e-02]
 [ 2.54981328e-02]
 [-4.08541652e-02]
 [ 2.25313920e-02]
 [-5.91169927e-03]
 [ 3.82031281e-03]
 [-1.53152749e-03]
 [ 4.87810619e-03]
 [ 1.14741160e-02]
 [ 1.00811730e-03]
 [ 1.98565131e-02]
 [ 1.49276820e-04]
 [ 9.67065515e-03]
 [ 1.39400071e-02]
 [ 1.15537124e-02]
 [-1.48618237e-02]
 [ 3.04930951e-03]
 [ 3.66934599e-02]
 [-3.16081511e-02]
 [ 7.92567681e-03]
 [ 7.41706360e-03]
 [-1.74091595e-02]
 [ 1.01705951e-04]
 [-1.32646372e-02]
 [ 6.98576360e-02]
 [-2.99037319e-03]
 [-8.35761528e-03]
 [ 4.46333945e-03]
 [ 5.86729884e-03]
 [-2.76388403e-03]
 [ 7.10421781e-03]
 [ 4.85005974e-03]
 [-8.48919340e-03]
 [ 9.37780935e-03]
 [-1.66347247e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.26421588]
curr_Stock_Price:  100.79423961614582
curr_Factors:  [100.79423962]
mat_Sqrt:  [[0.15]]
grads:  [0.04022758]
Stock Position:  0.04022758129535466
Bond Position:  [10.20950742]


portfolio before change:  [14.25073871]
curr_Stock_Price:  100.42749019593988
curr_Factors:  [100.4274902]
mat_Sqrt:  [[0.15]]
grads:  [0.02908406]
Stock Position:  0.02908405991855457
Bond Position:  [11.32989957]


portfolio before change:  [14.28337275]
curr_Stock_Price:  101.50085189039035
curr_Factors:  [101.50085189]
mat_Sqrt:  [[0.15]]
grads:  [0.10191288]
Stock Position:  0.10191288232324022
Bond Position:  [3.93912838]


portfolio before change:  [14.29589523]
curr_Stock_Price:  101.61889446586696
curr_Factors:  [101.61889447]
mat_Sqrt:  [[0.15]]
grads:  [0.02868089]
Stock Position:  0.028680888392659417
Bond Position:  [11.38137506]


portfolio before change:  [14.25826925]
curr_Stock_Price:  100.25740455565769
curr_Factors:  [100.25740456]
mat_Sqrt:  [[0.15]]
grads:  [0.10370314]
Stock Position:  0.10370313782208133
Bond Position:  [3.86126181]


portfolio before change:  [14.29491563]
curr_Stock_Price:  100.60612773054432
curr_Factors:  [100.60612773]
mat_Sqrt:  [[0.15]]
grads:  [0.16998755]
Stock Position:  0.16998755191530274
Bond Position:  [-2.80687373]


portfolio before change:  [13.96274393]
curr_Stock_Price:  98.65409764374488
curr_Factors:  [98.65409764]
mat_Sqrt:  [[0.15]]
grads:  [-0.2723611]
Stock Position:  -0.2723611015739574
Bond Position:  [40.83228264]


portfolio before change:  [13.89271837]
curr_Stock_Price:  98.92994436322083
curr_Factors:  [98.92994436]
mat_Sqrt:  [[0.15]]
grads:  [0.15020928]
Stock Position:  0.15020927966753816
Bond Position:  [-0.96747731]


portfolio before change:  [14.0147082]
curr_Stock_Price:  99.74288195093087
curr_Factors:  [99.74288195]
mat_Sqrt:  [[0.15]]
grads:  [-0.03941133]
Stock Position:  -0.03941132849450689
Bond Position:  [17.94570768]


portfolio before change:  [14.01821928]
curr_Stock_Price:  99.71071528414764
curr_Factors:  [99.71071528]
mat_Sqrt:  [[0.15]]
grads:  [0.02546875]
Stock Position:  0.025468752091465287
Bond Position:  [11.47871179]


portfolio before change:  [13.98378956]
curr_Stock_Price:  98.3025326446859
curr_Factors:  [98.30253264]
mat_Sqrt:  [[0.15]]
grads:  [-0.01021018]
Stock Position:  -0.01021018329363998
Bond Position:  [14.98747643]


portfolio before change:  [13.972201]
curr_Stock_Price:  99.62103128619755
curr_Factors:  [99.62103129]
mat_Sqrt:  [[0.15]]
grads:  [0.03252071]
Stock Position:  0.03252070793287443
Bond Position:  [10.73245453]


portfolio before change:  [13.99065206]
curr_Stock_Price:  100.1471397935115
curr_Factors:  [100.14713979]
mat_Sqrt:  [[0.15]]
grads:  [0.07649411]
Stock Position:  0.07649410638071383
Bond Position:  [6.32998609]


portfolio before change:  [14.03192068]
curr_Stock_Price:  100.67629593021809
curr_Factors:  [100.67629593]
mat_Sqrt:  [[0.15]]
grads:  [0.00672078]
Stock Position:  0.00672078199609551
Bond Position:  [13.35529724]


portfolio before change:  [14.03120484]
curr_Stock_Price:  100.32137371211775
curr_Factors:  [100.32137371]
mat_Sqrt:  [[0.15]]
grads:  [0.13237675]
Stock Position:  0.13237675371926264
Bond Position:  [0.75098706]


portfolio before change:  [14.04366407]
curr_Stock_Price:  100.41478399425922
curr_Factors:  [100.41478399]
mat_Sqrt:  [[0.15]]
grads:  [0.00099518]
Stock Position:  0.000995178800432013
Bond Position:  [13.94373341]


portfolio before change:  [14.04493716]
curr_Stock_Price:  99.94252362197305
curr_Factors:  [99.94252362]
mat_Sqrt:  [[0.15]]
grads:  [0.06447103]
Stock Position:  0.0644710343563776
Bond Position:  [7.60153929]


portfolio before change:  [14.12946451]
curr_Stock_Price:  101.23887465589176
curr_Factors:  [101.23887466]
mat_Sqrt:  [[0.15]]
grads:  [0.09293338]
Stock Position:  0.09293338064745388
Bond Position:  [4.72099363]


portfolio before change:  [14.18321868]
curr_Stock_Price:  101.81094043067755
curr_Factors:  [101.81094043]
mat_Sqrt:  [[0.15]]
grads:  [0.07702475]
Stock Position:  0.07702474932008838
Bond Position:  [6.34125651]


portfolio before change:  [14.25680653]
curr_Stock_Price:  102.7560282428001
curr_Factors:  [102.75602824]
mat_Sqrt:  [[0.15]]
grads:  [-0.09907882]
Stock Position:  -0.09907882436944768
Bond Position:  [24.43775301]


portfolio before change:  [14.18636222]
curr_Stock_Price:  103.49785401171512
curr_Factors:  [103.49785401]
mat_Sqrt:  [[0.15]]
grads:  [0.02032873]
Stock Position:  0.020328730096867434
Bond Position:  [12.08238228]


portfolio before change:  [14.21404947]
curr_Stock_Price:  104.78553180917653
curr_Factors:  [104.78553181]
mat_Sqrt:  [[0.15]]
grads:  [0.24462307]
Stock Position:  0.24462306606227244
Bond Position:  [-11.41890861]


portfolio before change:  [13.96266318]
curr_Stock_Price:  103.76371962633829
curr_Factors:  [103.76371963]
mat_Sqrt:  [[0.15]]
grads:  [-0.21072101]
Stock Position:  -0.21072100735633978
Bond Position:  [35.82785871]


portfolio before change:  [13.68784647]
curr_Stock_Price:  105.08914738645659
curr_Factors:  [105.08914739]
mat_Sqrt:  [[0.15]]
grads:  [0.05283785]
Stock Position:  0.052837845406055614
Bond Position:  [8.13516235]


portfolio before change:  [13.66708646]
curr_Stock_Price:  104.67700024090296
curr_Factors:  [104.67700024]
mat_Sqrt:  [[0.15]]
grads:  [0.04944709]
Stock Position:  0.04944709068561388
Bond Position:  [8.49111334]


portfolio before change:  [13.69373156]
curr_Stock_Price:  105.19439456987281
curr_Factors:  [105.19439457]
mat_Sqrt:  [[0.15]]
grads:  [-0.11606106]
Stock Position:  -0.1160610634768876
Bond Position:  [25.90270487]


portfolio before change:  [13.61604548]
curr_Stock_Price:  105.89164927393907
curr_Factors:  [105.89164927]
mat_Sqrt:  [[0.15]]
grads:  [0.00067804]
Stock Position:  0.0006780396737437509
Bond Position:  [13.54424674]


portfolio before change:  [13.61820605]
curr_Stock_Price:  106.58104270220853
curr_Factors:  [106.5810427]
mat_Sqrt:  [[0.15]]
grads:  [-0.08843091]
Stock Position:  -0.08843091444639263
Bond Position:  [23.04326512]


portfolio before change:  [13.56949025]
curr_Stock_Price:  107.16450824854599
curr_Factors:  [107.16450825]
mat_Sqrt:  [[0.15]]
grads:  [0.46571757]
Stock Position:  0.4657175732191862
Bond Position:  [-36.33890447]


portfolio before change:  [13.02649386]
curr_Stock_Price:  106.00832738429783
curr_Factors:  [106.00832738]
mat_Sqrt:  [[0.15]]
grads:  [-0.01993582]
Stock Position:  -0.019935821239690923
Bond Position:  [15.13985692]


portfolio before change:  [13.04184085]
curr_Stock_Price:  105.33344197408739
curr_Factors:  [105.33344197]
mat_Sqrt:  [[0.15]]
grads:  [-0.05571744]
Stock Position:  -0.05571743519484138
Bond Position:  [18.91075008]


portfolio before change:  [13.03900743]
curr_Stock_Price:  105.42672358000279
curr_Factors:  [105.42672358]
mat_Sqrt:  [[0.15]]
grads:  [0.0297556]
Stock Position:  0.02975559635858155
Bond Position:  [9.9019724]


portfolio before change:  [13.01673702]
curr_Stock_Price:  104.63667923701531
curr_Factors:  [104.63667924]
mat_Sqrt:  [[0.15]]
grads:  [0.03911533]
Stock Position:  0.03911532561214398
Bond Position:  [8.92383924]


portfolio before change:  [13.02663832]
curr_Stock_Price:  104.86129083858181
curr_Factors:  [104.86129084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01842589]
Stock Position:  -0.018425893529357626
Bond Position:  [14.9588013]


portfolio before change:  [13.0272366]
curr_Stock_Price:  104.93030747765503
curr_Factors:  [104.93030748]
mat_Sqrt:  [[0.15]]
grads:  [0.04736145]
Stock Position:  0.04736145206321467
Bond Position:  [8.05758487]


portfolio before change:  [12.98575302]
curr_Stock_Price:  104.03314675804602
curr_Factors:  [104.03314676]
mat_Sqrt:  [[0.15]]
grads:  [0.03233373]
Stock Position:  0.032333731622133995
Bond Position:  [9.62197318]


portfolio before change:  [12.97022225]
curr_Stock_Price:  103.51561915560345
curr_Factors:  [103.51561916]
mat_Sqrt:  [[0.15]]
grads:  [-0.05659462]
Stock Position:  -0.056594622655541826
Bond Position:  [18.82864965]


portfolio before change:  [12.99006539]
curr_Stock_Price:  103.2065894716066
curr_Factors:  [103.20658947]
mat_Sqrt:  [[0.15]]
grads:  [0.06251873]
Stock Position:  0.06251872900705653
Bond Position:  [6.53772059]


portfolio before change:  [12.95492135]
curr_Stock_Price:  102.63138091609001
curr_Factors:  [102.63138092]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.95492135]
Stock Price:  102.13375504047836
PL:  [10.82116631]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.33419878e-03]
 [ 3.83402180e-03]
 [ 9.05739556e-03]
 [ 3.99699470e-03]
 [ 1.53582963e-02]
 [ 2.60743541e-02]
 [-4.53594329e-03]
 [ 1.07734900e-02]
 [-9.68446018e-03]
 [-2.37127125e-03]
 [ 2.24918926e-02]
 [ 8.58636700e-03]
 [ 7.04127198e-04]
 [-4.06766802e-03]
 [ 5.90952730e-03]
 [ 2.49149063e-03]
 [ 8.72427887e-03]
 [ 1.23265680e-02]
 [ 1.16108559e-02]
 [-1.53376412e-02]
 [ 2.60948076e-03]
 [ 3.16390482e-02]
 [-3.58029907e-02]
 [ 8.02161588e-03]
 [ 7.55140327e-03]
 [-1.60535029e-02]
 [-3.35391805e-04]
 [-1.25185567e-02]
 [ 6.88961705e-02]
 [-2.97705062e-03]
 [-1.31392223e-02]
 [ 4.15778375e-03]
 [ 7.03355634e-03]
 [ 4.49675674e-03]
 [ 8.18763710e-03]
 [ 3.59525986e-03]
 [-4.47824167e-02]
 [ 9.73792301e-03]
 [-7.05836057e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.00521354]
curr_Stock_Price:  99.680199618866
curr_Factors:  [99.68019962]
mat_Sqrt:  [[0.15]]
grads:  [0.02222799]
Stock Position:  0.022227991876102044
Bond Position:  [-5.2209042]


portfolio before change:  [-3.00069551]
curr_Stock_Price:  99.91281976017017
curr_Factors:  [99.91281976]
mat_Sqrt:  [[0.15]]
grads:  [0.02556015]
Stock Position:  0.025560145330823097
Bond Position:  [-5.55448171]


portfolio before change:  [-2.99082824]
curr_Stock_Price:  100.3260264926331
curr_Factors:  [100.32602649]
mat_Sqrt:  [[0.15]]
grads:  [0.06038264]
Stock Position:  0.06038263708705761
Bond Position:  [-9.04877829]


portfolio before change:  [-2.91582282]
curr_Stock_Price:  101.58692845488778
curr_Factors:  [101.58692845]
mat_Sqrt:  [[0.15]]
grads:  [0.02664663]
Stock Position:  0.026646631362278336
Bond Position:  [-5.62277226]


portfolio before change:  [-2.94654511]
curr_Stock_Price:  100.4603548521989
curr_Factors:  [100.46035485]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-13.23254442]


portfolio before change:  [-2.91150118]
curr_Stock_Price:  100.81877445898293
curr_Factors:  [100.81877446]
mat_Sqrt:  [[0.15]]
grads:  [0.17382903]
Stock Position:  0.17382902726168495
Bond Position:  [-20.43673067]


portfolio before change:  [-2.84306785]
curr_Stock_Price:  101.22715323584131
curr_Factors:  [101.22715324]
mat_Sqrt:  [[0.15]]
grads:  [-0.03023962]
Stock Position:  -0.03023962192321491
Bond Position:  [0.218003]


portfolio before change:  [-2.85846976]
curr_Stock_Price:  101.73738325122257
curr_Factors:  [101.73738325]
mat_Sqrt:  [[0.15]]
grads:  [0.07182327]
Stock Position:  0.071823266497912
Bond Position:  [-10.16558095]


portfolio before change:  [-2.78988108]
curr_Stock_Price:  102.7100409859162
curr_Factors:  [102.71004099]
mat_Sqrt:  [[0.15]]
grads:  [-0.06456307]
Stock Position:  -0.06456306787668002
Bond Position:  [3.84139427]


portfolio before change:  [-2.85165694]
curr_Stock_Price:  103.67430844278434
curr_Factors:  [103.67430844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01580847]
Stock Position:  -0.015808474966706062
Bond Position:  [-1.21272423]


portfolio before change:  [-2.85654184]
curr_Stock_Price:  103.97372408099329
curr_Factors:  [103.97372408]
mat_Sqrt:  [[0.15]]
grads:  [0.14994595]
Stock Position:  0.14994595093156368
Bond Position:  [-18.44698077]


portfolio before change:  [-2.86540636]
curr_Stock_Price:  103.92998497067182
curr_Factors:  [103.92998497]
mat_Sqrt:  [[0.15]]
grads:  [0.05724245]
Stock Position:  0.05724244666111785
Bond Position:  [-8.81461298]


portfolio before change:  [-2.83099442]
curr_Stock_Price:  104.55039583016179
curr_Factors:  [104.55039583]
mat_Sqrt:  [[0.15]]
grads:  [0.00469418]
Stock Position:  0.004694181320582351
Bond Position:  [-3.32177294]


portfolio before change:  [-2.83411644]
curr_Stock_Price:  103.97377369829915
curr_Factors:  [103.9737737]
mat_Sqrt:  [[0.15]]
grads:  [-0.02711779]
Stock Position:  -0.027117786785254908
Bond Position:  [-0.01457781]


portfolio before change:  [-2.82231605]
curr_Stock_Price:  103.53855340370444
curr_Factors:  [103.5385534]
mat_Sqrt:  [[0.15]]
grads:  [0.03939685]
Stock Position:  0.03939684869283081
Bond Position:  [-6.90140877]


portfolio before change:  [-2.84686776]
curr_Stock_Price:  102.93726219971607
curr_Factors:  [102.9372622]
mat_Sqrt:  [[0.15]]
grads:  [0.01660994]
Stock Position:  0.01660993753557474
Bond Position:  [-4.55664925]


portfolio before change:  [-2.85892017]
curr_Stock_Price:  102.24594154206108
curr_Factors:  [102.24594154]
mat_Sqrt:  [[0.15]]
grads:  [0.05816186]
Stock Position:  0.058161859150175715
Bond Position:  [-8.80573422]


portfolio before change:  [-2.88190901]
curr_Stock_Price:  101.86961152481477
curr_Factors:  [101.86961152]
mat_Sqrt:  [[0.15]]
grads:  [0.08217712]
Stock Position:  0.08217711975870878
Bond Position:  [-11.25326027]


portfolio before change:  [-2.80501662]
curr_Stock_Price:  102.82242091299771
curr_Factors:  [102.82242091]
mat_Sqrt:  [[0.15]]
grads:  [0.07740571]
Stock Position:  0.07740570577391774
Bond Position:  [-10.76405868]


portfolio before change:  [-2.77880254]
curr_Stock_Price:  103.17846283073638
curr_Factors:  [103.17846283]
mat_Sqrt:  [[0.15]]
grads:  [-0.10225094]
Stock Position:  -0.10225094163935683
Bond Position:  [7.77129244]


portfolio before change:  [-2.80121864]
curr_Stock_Price:  103.4071901052397
curr_Factors:  [103.40719011]
mat_Sqrt:  [[0.15]]
grads:  [0.01739654]
Stock Position:  0.017396538367341702
Bond Position:  [-4.60014579]


portfolio before change:  [-2.79728271]
curr_Stock_Price:  103.6664937441123
curr_Factors:  [103.66649374]
mat_Sqrt:  [[0.15]]
grads:  [0.21092699]
Stock Position:  0.21092698810319915
Bond Position:  [-24.66334401]


portfolio before change:  [-2.82915428]
curr_Stock_Price:  103.53000832281586
curr_Factors:  [103.53000832]
mat_Sqrt:  [[0.15]]
grads:  [-0.2386866]
Stock Position:  -0.23868660476713638
Bond Position:  [21.8820719]


portfolio before change:  [-3.14720266]
curr_Stock_Price:  104.87396229791234
curr_Factors:  [104.8739623]
mat_Sqrt:  [[0.15]]
grads:  [0.05347744]
Stock Position:  0.05347743920919263
Bond Position:  [-8.75559361]


portfolio before change:  [-3.1211742]
curr_Stock_Price:  105.3811478216747
curr_Factors:  [105.38114782]
mat_Sqrt:  [[0.15]]
grads:  [0.05034269]
Stock Position:  0.050342688478004334
Bond Position:  [-8.42634449]


portfolio before change:  [-3.14830046]
curr_Stock_Price:  104.8632394450655
curr_Factors:  [104.86323945]
mat_Sqrt:  [[0.15]]
grads:  [-0.10702335]
Stock Position:  -0.10702335297382896
Bond Position:  [8.07451503]


portfolio before change:  [-3.15670337]
curr_Stock_Price:  104.95118562355908
curr_Factors:  [104.95118562]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223595]
Stock Position:  -0.002235945368133915
Bond Position:  [-2.92203826]


portfolio before change:  [-3.15960187]
curr_Stock_Price:  106.08413726711854
curr_Factors:  [106.08413727]
mat_Sqrt:  [[0.15]]
grads:  [-0.08345704]
Stock Position:  -0.08345704465716647
Bond Position:  [5.69386671]


portfolio before change:  [-3.23302981]
curr_Stock_Price:  106.97249504907087
curr_Factors:  [106.97249505]
mat_Sqrt:  [[0.15]]
grads:  [0.4593078]
Stock Position:  0.4593078031416969
Bond Position:  [-52.36633151]


portfolio before change:  [-3.55448134]
curr_Stock_Price:  106.28688655630543
curr_Factors:  [106.28688656]
mat_Sqrt:  [[0.15]]
grads:  [-0.019847]
Stock Position:  -0.019847004160505517
Bond Position:  [-1.44500506]


portfolio before change:  [-3.57604412]
curr_Stock_Price:  107.36423525291409
curr_Factors:  [107.36423525]
mat_Sqrt:  [[0.15]]
grads:  [-0.08759482]
Stock Position:  -0.08759481550864094
Bond Position:  [5.82850626]


portfolio before change:  [-3.53922083]
curr_Stock_Price:  106.95217117157424
curr_Factors:  [106.95217117]
mat_Sqrt:  [[0.15]]
grads:  [0.02771856]
Stock Position:  0.027718558326045088
Bond Position:  [-6.50378083]


portfolio before change:  [-3.51157795]
curr_Stock_Price:  107.9787725450243
curr_Factors:  [107.97877255]
mat_Sqrt:  [[0.15]]
grads:  [0.04689038]
Stock Position:  0.04689037558350476
Bond Position:  [-8.57474315]


portfolio before change:  [-3.50207021]
curr_Stock_Price:  108.20439771383126
curr_Factors:  [108.20439771]
mat_Sqrt:  [[0.15]]
grads:  [0.02997838]
Stock Position:  0.02997837829395707
Bond Position:  [-6.74586258]


portfolio before change:  [-3.51116377]
curr_Stock_Price:  107.9291901200159
curr_Factors:  [107.92919012]
mat_Sqrt:  [[0.15]]
grads:  [0.05458425]
Stock Position:  0.054584247319147364
Bond Position:  [-9.40239738]


portfolio before change:  [-3.56431232]
curr_Stock_Price:  106.97702569484696
curr_Factors:  [106.97702569]
mat_Sqrt:  [[0.15]]
grads:  [0.0239684]
Stock Position:  0.023968399043758866
Bond Position:  [-6.12838036]


portfolio before change:  [-3.57023193]
curr_Stock_Price:  106.7620128027855
curr_Factors:  [106.7620128]
mat_Sqrt:  [[0.15]]
grads:  [-0.29854944]
Stock Position:  -0.2985494444438411
Bond Position:  [28.30350768]


portfolio before change:  [-3.39661569]
curr_Stock_Price:  106.19233134860461
curr_Factors:  [106.19233135]
mat_Sqrt:  [[0.15]]
grads:  [0.06491949]
Stock Position:  0.0649194867062993
Bond Position:  [-10.29056733]


portfolio before change:  [-3.37415465]
curr_Stock_Price:  106.55812979442815
curr_Factors:  [106.55812979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.37415465]
Stock Price:  106.75786897619865
PL:  [-10.13202362]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.10922784e-03]
 [-3.47011618e-03]
 [ 9.37205288e-03]
 [-2.72925154e-03]
 [ 1.53582963e-02]
 [ 2.61468805e-02]
 [ 5.57347812e-04]
 [ 9.76640257e-03]
 [-8.38658768e-03]
 [-1.93724398e-03]
 [ 1.02311065e-02]
 [ 4.68565780e-03]
 [ 9.05140476e-03]
 [-4.61434782e-03]
 [ 2.35967522e-02]
 [-1.18527114e-04]
 [ 9.41901725e-03]
 [ 1.21052625e-02]
 [ 1.14500628e-02]
 [-1.44847029e-02]
 [-4.17917622e-03]
 [ 2.54090295e-02]
 [-3.69408232e-02]
 [ 5.70218613e-03]
 [-4.13593407e-03]
 [-6.39077518e-03]
 [-1.06717804e-03]
 [-1.12951716e-02]
 [ 1.59707933e-02]
 [-9.28219942e-03]
 [ 1.20151000e-04]
 [ 5.16405380e-03]
 [ 5.13480252e-03]
 [-1.18614459e-02]
 [ 1.77802211e-02]
 [ 5.66769541e-03]
 [ 3.02834138e-03]
 [ 8.63665800e-03]
 [-2.92926239e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.98477845]
curr_Stock_Price:  99.42348039668525
curr_Factors:  [99.4234804]
mat_Sqrt:  [[0.15]]
grads:  [0.03406152]
Stock Position:  0.03406151890384781
Bond Position:  [-10.37129321]


portfolio before change:  [-6.98858157]
curr_Stock_Price:  99.34988945227224
curr_Factors:  [99.34988945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313411]
Stock Position:  -0.02313410784458284
Bond Position:  [-4.69021051]


portfolio before change:  [-7.012848]
curr_Stock_Price:  100.37349157908189
curr_Factors:  [100.37349158]
mat_Sqrt:  [[0.15]]
grads:  [0.06248035]
Stock Position:  0.06248035251344218
Bond Position:  [-13.28421914]


portfolio before change:  [-7.01249516]
curr_Stock_Price:  100.40571724155845
curr_Factors:  [100.40571724]
mat_Sqrt:  [[0.15]]
grads:  [-0.01819501]
Stock Position:  -0.018195010241083744
Bond Position:  [-5.18561211]


portfolio before change:  [-7.01684926]
curr_Stock_Price:  100.60939142353615
curr_Factors:  [100.60939142]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-17.31810823]


portfolio before change:  [-6.98780376]
curr_Stock_Price:  100.91421425923869
curr_Factors:  [100.91421426]
mat_Sqrt:  [[0.15]]
grads:  [0.17431254]
Stock Position:  0.17431253664320068
Bond Position:  [-24.57841643]


portfolio before change:  [-6.89080831]
curr_Stock_Price:  101.4882862131925
curr_Factors:  [101.48828621]
mat_Sqrt:  [[0.15]]
grads:  [0.00371565]
Stock Position:  0.003715652079823619
Bond Position:  [-7.26790348]


portfolio before change:  [-6.89013575]
curr_Stock_Price:  101.91381184403366
curr_Factors:  [101.91381184]
mat_Sqrt:  [[0.15]]
grads:  [0.06510935]
Stock Position:  0.0651093504620529
Bond Position:  [-13.52567785]


portfolio before change:  [-6.89696445]
curr_Stock_Price:  101.8349002821113
curr_Factors:  [101.83490028]
mat_Sqrt:  [[0.15]]
grads:  [-0.05591058]
Stock Position:  -0.0559105845101238
Bond Position:  [-1.20331565]


portfolio before change:  [-6.875907]
curr_Stock_Price:  101.4555825803807
curr_Factors:  [101.45558258]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291496]
Stock Position:  -0.012914959841645588
Bond Position:  [-5.56561222]


portfolio before change:  [-6.87029277]
curr_Stock_Price:  100.96700357322936
curr_Factors:  [100.96700357]
mat_Sqrt:  [[0.15]]
grads:  [0.06820738]
Stock Position:  0.06820737673976242
Bond Position:  [-13.75698722]


portfolio before change:  [-6.85065791]
curr_Stock_Price:  101.28008687668235
curr_Factors:  [101.28008688]
mat_Sqrt:  [[0.15]]
grads:  [0.03123772]
Stock Position:  0.031237718661974355
Bond Position:  [-10.01441677]


portfolio before change:  [-6.83495754]
curr_Stock_Price:  101.82277217093024
curr_Factors:  [101.82277217]
mat_Sqrt:  [[0.15]]
grads:  [0.0603427]
Stock Position:  0.06034269839296433
Bond Position:  [-12.97921837]


portfolio before change:  [-6.85845947]
curr_Stock_Price:  101.46018593677877
curr_Factors:  [101.46018594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03076232]
Stock Position:  -0.030762318790381916
Bond Position:  [-3.73730889]


portfolio before change:  [-6.83941417]
curr_Stock_Price:  100.82588750429605
curr_Factors:  [100.8258875]
mat_Sqrt:  [[0.15]]
grads:  [0.15731168]
Stock Position:  0.15731168112997818
Bond Position:  [-22.70050404]


portfolio before change:  [-6.91901498]
curr_Stock_Price:  100.33791951084515
curr_Factors:  [100.33791951]
mat_Sqrt:  [[0.15]]
grads:  [-0.00079018]
Stock Position:  -0.0007901807614800877
Bond Position:  [-6.83972989]


portfolio before change:  [-6.91979265]
curr_Stock_Price:  100.24002744718244
curr_Factors:  [100.24002745]
mat_Sqrt:  [[0.15]]
grads:  [0.06279345]
Stock Position:  0.06279344836319459
Bond Position:  [-13.21420963]


portfolio before change:  [-6.9106691]
curr_Stock_Price:  100.4116285327616
curr_Factors:  [100.41162853]
mat_Sqrt:  [[0.15]]
grads:  [0.08070175]
Stock Position:  0.08070174986364011
Bond Position:  [-15.01406323]


portfolio before change:  [-6.86484392]
curr_Stock_Price:  101.0027192924188
curr_Factors:  [101.00271929]
mat_Sqrt:  [[0.15]]
grads:  [0.07633375]
Stock Position:  0.0763337520540789
Bond Position:  [-14.57476045]


portfolio before change:  [-6.75838659]
curr_Stock_Price:  102.42121749496692
curr_Factors:  [102.42121749]
mat_Sqrt:  [[0.15]]
grads:  [-0.09656469]
Stock Position:  -0.09656468612015992
Bond Position:  [3.13188613]


portfolio before change:  [-6.77323173]
curr_Stock_Price:  102.57900452247083
curr_Factors:  [102.57900452]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786117]
Stock Position:  -0.027861174828742778
Bond Position:  [-3.91526015]


portfolio before change:  [-6.77405438]
curr_Stock_Price:  102.5909643111588
curr_Factors:  [102.59096431]
mat_Sqrt:  [[0.15]]
grads:  [0.16939353]
Stock Position:  0.16939352969824417
Bond Position:  [-24.15229994]


portfolio before change:  [-6.62874403]
curr_Stock_Price:  103.46661512047123
curr_Factors:  [103.46661512]
mat_Sqrt:  [[0.15]]
grads:  [-0.24627215]
Stock Position:  -0.24627215475394335
Bond Position:  [18.85220222]


portfolio before change:  [-6.41944445]
curr_Stock_Price:  102.62631345448087
curr_Factors:  [102.62631345]
mat_Sqrt:  [[0.15]]
grads:  [0.03801457]
Stock Position:  0.03801457422974705
Bond Position:  [-10.32074007]


portfolio before change:  [-6.43387919]
curr_Stock_Price:  102.28053664372906
curr_Factors:  [102.28053664]
mat_Sqrt:  [[0.15]]
grads:  [-0.02757289]
Stock Position:  -0.027572893815677818
Bond Position:  [-3.61370881]


portfolio before change:  [-6.44107718]
curr_Stock_Price:  102.52520653685603
curr_Factors:  [102.52520654]
mat_Sqrt:  [[0.15]]
grads:  [-0.04260517]
Stock Position:  -0.04260516789686953
Bond Position:  [-2.07297355]


portfolio before change:  [-6.42693219]
curr_Stock_Price:  102.18712231718357
curr_Factors:  [102.18712232]
mat_Sqrt:  [[0.15]]
grads:  [-0.00711452]
Stock Position:  -0.007114520234262935
Bond Position:  [-5.69991984]


portfolio before change:  [-6.42303928]
curr_Stock_Price:  101.53979299708081
curr_Factors:  [101.539793]
mat_Sqrt:  [[0.15]]
grads:  [-0.07530114]
Stock Position:  -0.07530114416295126
Bond Position:  [1.22302331]


portfolio before change:  [-6.45893591]
curr_Stock_Price:  102.01853088508095
curr_Factors:  [102.01853089]
mat_Sqrt:  [[0.15]]
grads:  [0.10647196]
Stock Position:  0.10647195519126752
Bond Position:  [-17.32104836]


portfolio before change:  [-6.56509422]
curr_Stock_Price:  101.04181314190392
curr_Factors:  [101.04181314]
mat_Sqrt:  [[0.15]]
grads:  [-0.06188133]
Stock Position:  -0.06188132946212324
Bond Position:  [-0.31249249]


portfolio before change:  [-6.63172876]
curr_Stock_Price:  102.11799359631823
curr_Factors:  [102.1179936]
mat_Sqrt:  [[0.15]]
grads:  [0.00080101]
Stock Position:  0.0008010066678855302
Bond Position:  [-6.71352596]


portfolio before change:  [-6.6330657]
curr_Stock_Price:  101.49666025059872
curr_Factors:  [101.49666025]
mat_Sqrt:  [[0.15]]
grads:  [0.03442703]
Stock Position:  0.03442702535604063
Bond Position:  [-10.12729379]


portfolio before change:  [-6.67091047]
curr_Stock_Price:  100.4341582347475
curr_Factors:  [100.43415823]
mat_Sqrt:  [[0.15]]
grads:  [0.03423202]
Stock Position:  0.0342320168064425
Bond Position:  [-10.10897427]


portfolio before change:  [-6.69952563]
curr_Stock_Price:  99.6351561141396
curr_Factors:  [99.63515611]
mat_Sqrt:  [[0.15]]
grads:  [-0.07907631]
Stock Position:  -0.07907630620438902
Bond Position:  [1.17925449]


portfolio before change:  [-6.71906452]
curr_Stock_Price:  99.88410947530362
curr_Factors:  [99.88410948]
mat_Sqrt:  [[0.15]]
grads:  [0.11853481]
Stock Position:  0.11853480705750533
Bond Position:  [-18.55880817]


portfolio before change:  [-6.74299116]
curr_Stock_Price:  99.70182852000724
curr_Factors:  [99.70182852]
mat_Sqrt:  [[0.15]]
grads:  [0.03778464]
Stock Position:  0.03778463603528312
Bond Position:  [-10.51018846]


portfolio before change:  [-6.76676907]
curr_Stock_Price:  99.107299658495
curr_Factors:  [99.10729966]
mat_Sqrt:  [[0.15]]
grads:  [0.02018894]
Stock Position:  0.020188942559129196
Bond Position:  [-8.76764065]


portfolio before change:  [-6.75604214]
curr_Stock_Price:  99.69291509653377
curr_Factors:  [99.6929151]
mat_Sqrt:  [[0.15]]
grads:  [0.05757772]
Stock Position:  0.05757772001102853
Bond Position:  [-12.49613289]


portfolio before change:  [-6.77186396]
curr_Stock_Price:  99.44525491754612
curr_Factors:  [99.44525492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.77186396]
Stock Price:  99.8235966988706
PL:  [-6.77186396]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.32962473e-02]
 [-1.51821810e-02]
 [-1.90754027e-02]
 [-1.85045964e-03]
 [ 1.27791409e-02]
 [ 2.61942547e-02]
 [ 1.47208851e-03]
 [ 2.31686816e-02]
 [-6.59076757e-03]
 [ 2.82925478e-03]
 [ 1.56570098e-03]
 [ 7.17155725e-03]
 [ 1.39137808e-02]
 [ 2.42757587e-03]
 [ 5.91698491e-03]
 [-3.33516197e-03]
 [ 1.21355329e-02]
 [ 3.96599858e-04]
 [ 1.05231171e-02]
 [-4.93168460e-03]
 [ 1.46930458e-02]
 [ 2.26512773e-03]
 [ 1.79463805e-02]
 [ 4.74289817e-03]
 [ 1.45312156e-02]
 [-1.10578038e-02]
 [ 9.84634867e-03]
 [-1.11524566e-02]
 [-1.78009829e-02]
 [-6.78392228e-03]
 [-2.82716095e-03]
 [ 5.40377748e-03]
 [ 5.84243466e-03]
 [-1.10715595e-02]
 [ 1.72116155e-02]
 [ 5.53559688e-03]
 [ 2.34762285e-03]
 [ 1.00635588e-02]
 [-2.00125575e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.65942729]
curr_Stock_Price:  98.02526247409193
curr_Factors:  [98.02526247]
mat_Sqrt:  [[0.15]]
grads:  [0.08864165]
Stock Position:  0.08864164892057398
Bond Position:  [-37.34854819]


portfolio before change:  [-28.70559854]
curr_Stock_Price:  97.55705825219657
curr_Factors:  [97.55705825]
mat_Sqrt:  [[0.15]]
grads:  [-0.10121454]
Stock Position:  -0.10121454022347635
Bond Position:  [-18.83140575]


portfolio before change:  [-28.76227592]
curr_Stock_Price:  98.09377271126381
curr_Factors:  [98.09377271]
mat_Sqrt:  [[0.15]]
grads:  [-0.12716935]
Stock Position:  -0.12716935142021707
Bond Position:  [-16.28775447]


portfolio before change:  [-28.89812863]
curr_Stock_Price:  99.14604358943133
curr_Factors:  [99.14604359]
mat_Sqrt:  [[0.15]]
grads:  [-0.0123364]
Stock Position:  -0.012336397586336128
Bond Position:  [-27.67502361]


portfolio before change:  [-28.91036736]
curr_Stock_Price:  99.85768901210642
curr_Factors:  [99.85768901]
mat_Sqrt:  [[0.15]]
grads:  [0.08519427]
Stock Position:  0.08519427270572172
Bond Position:  [-37.41767055]


portfolio before change:  [-28.81972385]
curr_Stock_Price:  100.97655549162049
curr_Factors:  [100.97655549]
mat_Sqrt:  [[0.15]]
grads:  [0.17462836]
Stock Position:  0.1746283647424963
Bond Position:  [-46.45309461]


portfolio before change:  [-28.91042554]
curr_Stock_Price:  100.49041053351813
curr_Factors:  [100.49041053]
mat_Sqrt:  [[0.15]]
grads:  [0.00981392]
Stock Position:  0.0098139233782636
Bond Position:  [-29.89663073]


portfolio before change:  [-28.92267336]
curr_Stock_Price:  99.62322355315808
curr_Factors:  [99.62322355]
mat_Sqrt:  [[0.15]]
grads:  [0.15445788]
Stock Position:  0.15445787702077293
Bond Position:  [-44.31026498]


portfolio before change:  [-28.7373258]
curr_Stock_Price:  100.85907308693862
curr_Factors:  [100.85907309]
mat_Sqrt:  [[0.15]]
grads:  [-0.04393845]
Stock Position:  -0.04393845045882176
Bond Position:  [-24.30573441]


portfolio before change:  [-28.69965467]
curr_Stock_Price:  99.9325603322739
curr_Factors:  [99.93256033]
mat_Sqrt:  [[0.15]]
grads:  [0.0188617]
Stock Position:  0.01886169853927596
Bond Position:  [-30.5845525]


portfolio before change:  [-28.7230923]
curr_Stock_Price:  98.89265793742854
curr_Factors:  [98.89265794]
mat_Sqrt:  [[0.15]]
grads:  [0.01043801]
Stock Position:  0.01043800650552885
Bond Position:  [-29.75533451]


portfolio before change:  [-28.73258026]
curr_Stock_Price:  98.3400320180857
curr_Factors:  [98.34003202]
mat_Sqrt:  [[0.15]]
grads:  [0.04781038]
Stock Position:  0.04781038169999671
Bond Position:  [-33.43425473]


portfolio before change:  [-28.74733384]
curr_Stock_Price:  98.11886596662066
curr_Factors:  [98.11886597]
mat_Sqrt:  [[0.15]]
grads:  [0.09275854]
Stock Position:  0.09275853844087836
Bond Position:  [-37.84869644]


portfolio before change:  [-28.76652244]
curr_Stock_Price:  97.96300734460245
curr_Factors:  [97.96300734]
mat_Sqrt:  [[0.15]]
grads:  [0.01618384]
Stock Position:  0.01618383914767646
Bond Position:  [-30.35194]


portfolio before change:  [-28.76154338]
curr_Stock_Price:  98.50510948623065
curr_Factors:  [98.50510949]
mat_Sqrt:  [[0.15]]
grads:  [0.03944657]
Stock Position:  0.03944656604899102
Bond Position:  [-32.64723169]


portfolio before change:  [-28.76157138]
curr_Stock_Price:  98.60785996709275
curr_Factors:  [98.60785997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223441]
Stock Position:  -0.022234413135547745
Bond Position:  [-26.56908349]


portfolio before change:  [-28.77233814]
curr_Stock_Price:  98.94271987498395
curr_Factors:  [98.94271987]
mat_Sqrt:  [[0.15]]
grads:  [0.08090355]
Stock Position:  0.08090355250634443
Bond Position:  [-36.77715567]


portfolio before change:  [-28.7495265]
curr_Stock_Price:  99.28150684516174
curr_Factors:  [99.28150685]
mat_Sqrt:  [[0.15]]
grads:  [0.002644]
Stock Position:  0.0026439990557856896
Bond Position:  [-29.01202671]


portfolio before change:  [-28.75326817]
curr_Stock_Price:  99.23803664438572
curr_Factors:  [99.23803664]
mat_Sqrt:  [[0.15]]
grads:  [0.07015411]
Stock Position:  0.07015411428015038
Bond Position:  [-35.71522473]


portfolio before change:  [-28.8547216]
curr_Stock_Price:  97.85552688835814
curr_Factors:  [97.85552689]
mat_Sqrt:  [[0.15]]
grads:  [-0.0328779]
Stock Position:  -0.03287789730817298
Bond Position:  [-25.63743763]


portfolio before change:  [-28.86818168]
curr_Stock_Price:  98.16744475635011
curr_Factors:  [98.16744476]
mat_Sqrt:  [[0.15]]
grads:  [0.09795364]
Stock Position:  0.09795363893203332
Bond Position:  [-38.48404012]


portfolio before change:  [-28.84645712]
curr_Stock_Price:  98.43834196767341
curr_Factors:  [98.43834197]
mat_Sqrt:  [[0.15]]
grads:  [0.01510085]
Stock Position:  0.015100851557289241
Bond Position:  [-30.33295991]


portfolio before change:  [-28.84581476]
curr_Stock_Price:  98.73198195159729
curr_Factors:  [98.73198195]
mat_Sqrt:  [[0.15]]
grads:  [0.11964254]
Stock Position:  0.11964253681315255
Bond Position:  [-40.65835955]


portfolio before change:  [-28.92521006]
curr_Stock_Price:  98.1108593022945
curr_Factors:  [98.1108593]
mat_Sqrt:  [[0.15]]
grads:  [0.03161932]
Stock Position:  0.03161932110430731
Bond Position:  [-32.02740883]


portfolio before change:  [-28.922369]
curr_Stock_Price:  98.32733258880874
curr_Factors:  [98.32733259]
mat_Sqrt:  [[0.15]]
grads:  [0.09687477]
Stock Position:  0.09687477054157352
Bond Position:  [-38.44780678]


portfolio before change:  [-28.83459139]
curr_Stock_Price:  99.28303953946075
curr_Factors:  [99.28303954]
mat_Sqrt:  [[0.15]]
grads:  [-0.07371869]
Stock Position:  -0.07371869231185232
Bond Position:  [-21.51557554]


portfolio before change:  [-28.84817026]
curr_Stock_Price:  99.43075317836859
curr_Factors:  [99.43075318]
mat_Sqrt:  [[0.15]]
grads:  [0.06564232]
Stock Position:  0.06564232445091825
Bond Position:  [-35.37503602]


portfolio before change:  [-28.76836383]
curr_Stock_Price:  100.71389762003427
curr_Factors:  [100.71389762]
mat_Sqrt:  [[0.15]]
grads:  [-0.07434971]
Stock Position:  -0.07434971057582394
Bond Position:  [-21.28031469]


portfolio before change:  [-28.76546961]
curr_Stock_Price:  100.63919088665713
curr_Factors:  [100.63919089]
mat_Sqrt:  [[0.15]]
grads:  [-0.11867322]
Stock Position:  -0.11867321962485101
Bond Position:  [-16.82229281]


portfolio before change:  [-28.71912377]
curr_Stock_Price:  100.23093739702674
curr_Factors:  [100.2309374]
mat_Sqrt:  [[0.15]]
grads:  [-0.04522615]
Stock Position:  -0.04522614852184091
Bond Position:  [-24.18606451]


portfolio before change:  [-28.71357466]
curr_Stock_Price:  100.04138871680378
curr_Factors:  [100.04138872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01884774]
Stock Position:  -0.018847739648703527
Bond Position:  [-26.82802062]


portfolio before change:  [-28.71588767]
curr_Stock_Price:  99.98617242195171
curr_Factors:  [99.98617242]
mat_Sqrt:  [[0.15]]
grads:  [0.03602518]
Stock Position:  0.03602518321068226
Bond Position:  [-32.31790785]


portfolio before change:  [-28.73481623]
curr_Stock_Price:  99.57289038558248
curr_Factors:  [99.57289039]
mat_Sqrt:  [[0.15]]
grads:  [0.03894956]
Stock Position:  0.038949564410920595
Bond Position:  [-32.61313693]


portfolio before change:  [-28.71058884]
curr_Stock_Price:  100.29958089083559
curr_Factors:  [100.29958089]
mat_Sqrt:  [[0.15]]
grads:  [-0.0738104]
Stock Position:  -0.07381039657930256
Bond Position:  [-21.307437]


portfolio before change:  [-28.67730694]
curr_Stock_Price:  99.81258316625828
curr_Factors:  [99.81258317]
mat_Sqrt:  [[0.15]]
grads:  [0.1147441]
Stock Position:  0.1147441036525314
Bond Position:  [-40.13021233]


portfolio before change:  [-28.61267855]
curr_Stock_Price:  100.41954231087028
curr_Factors:  [100.41954231]
mat_Sqrt:  [[0.15]]
grads:  [0.03690398]
Stock Position:  0.036903979204285
Bond Position:  [-32.31855925]


portfolio before change:  [-28.63040122]
curr_Stock_Price:  100.04878021316279
curr_Factors:  [100.04878021]
mat_Sqrt:  [[0.15]]
grads:  [0.01565082]
Stock Position:  0.015650818977568853
Bond Position:  [-30.19624657]


portfolio before change:  [-28.65357094]
curr_Stock_Price:  98.80955113192444
curr_Factors:  [98.80955113]
mat_Sqrt:  [[0.15]]
grads:  [0.06709039]
Stock Position:  0.06709039173738386
Bond Position:  [-35.28274243]


portfolio before change:  [-28.6603585]
curr_Stock_Price:  98.77412218936556
curr_Factors:  [98.77412219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.6603585]
Stock Price:  99.58428056293945
PL:  [-28.6603585]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.87771075e-03]
 [ 3.20480812e-03]
 [-1.17820715e-02]
 [-2.32275621e-03]
 [ 1.53582963e-02]
 [ 2.64090042e-02]
 [-3.26970028e-03]
 [ 1.73311650e-02]
 [-5.91909513e-03]
 [ 4.16985342e-04]
 [ 9.39334694e-03]
 [ 5.02664533e-03]
 [ 8.81451024e-03]
 [-4.65190874e-03]
 [ 9.41587381e-03]
 [ 2.48502942e-03]
 [ 9.12059646e-03]
 [ 9.75278519e-03]
 [ 1.18067045e-02]
 [-1.66143632e-02]
 [ 1.30123549e-02]
 [ 4.16322710e-02]
 [ 1.70734719e-02]
 [ 7.38426300e-03]
 [ 7.56579223e-03]
 [-1.62254044e-02]
 [-8.56031718e-05]
 [-1.06934965e-02]
 [ 5.37224550e-02]
 [-8.00783790e-03]
 [-4.88218384e-03]
 [ 4.81680958e-03]
 [ 5.34534347e-03]
 [-4.01952781e-03]
 [ 7.11741516e-03]
 [ 4.79371601e-03]
 [-7.07927788e-03]
 [ 9.53805710e-03]
 [-1.30446708e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.7007046]
curr_Stock_Price:  100.30632227481901
curr_Factors:  [100.30632227]
mat_Sqrt:  [[0.15]]
grads:  [0.04585141]
Stock Position:  0.04585140502152637
Bond Position:  [2.10151879]


portfolio before change:  [6.67969307]
curr_Stock_Price:  99.8423399985531
curr_Factors:  [99.84234]
mat_Sqrt:  [[0.15]]
grads:  [0.02136539]
Stock Position:  0.021365387450043734
Bond Position:  [4.54652279]


portfolio before change:  [6.65475122]
curr_Stock_Price:  98.64834353190477
curr_Factors:  [98.64834353]
mat_Sqrt:  [[0.15]]
grads:  [-0.07854714]
Stock Position:  -0.07854714326521478
Bond Position:  [14.40329679]


portfolio before change:  [6.59536752]
curr_Stock_Price:  99.42729266944436
curr_Factors:  [99.42729267]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548504]
Stock Position:  -0.015485041376632735
Bond Position:  [8.13500326]


portfolio before change:  [6.58144015]
curr_Stock_Price:  100.392372852424
curr_Factors:  [100.39237285]
mat_Sqrt:  [[0.15]]
grads:  [0.10238864]
Stock Position:  0.1023886420923059
Bond Position:  [-3.69759858]


portfolio before change:  [6.66972618]
curr_Stock_Price:  101.2591511697994
curr_Factors:  [101.25915117]
mat_Sqrt:  [[0.15]]
grads:  [0.17606003]
Stock Position:  0.17606002806544033
Bond Position:  [-11.15796282]


portfolio before change:  [6.60518218]
curr_Stock_Price:  100.90047144497959
curr_Factors:  [100.90047144]
mat_Sqrt:  [[0.15]]
grads:  [-0.021798]
Stock Position:  -0.021798001834737953
Bond Position:  [8.80461084]


portfolio before change:  [6.6098597]
curr_Stock_Price:  100.73637947248585
curr_Factors:  [100.73637947]
mat_Sqrt:  [[0.15]]
grads:  [0.1155411]
Stock Position:  0.11554109993452708
Bond Position:  [-5.02933238]


portfolio before change:  [6.49995839]
curr_Stock_Price:  99.79063282471255
curr_Factors:  [99.79063282]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946063]
Stock Position:  -0.039460634187931866
Bond Position:  [10.43776005]


portfolio before change:  [6.46923767]
curr_Stock_Price:  100.60221420802564
curr_Factors:  [100.60221421]
mat_Sqrt:  [[0.15]]
grads:  [0.0027799]
Stock Position:  0.0027799022780816696
Bond Position:  [6.18957335]


portfolio before change:  [6.47168452]
curr_Stock_Price:  101.20406953420697
curr_Factors:  [101.20406953]
mat_Sqrt:  [[0.15]]
grads:  [0.06262231]
Stock Position:  0.0626223129123995
Bond Position:  [0.13405161]


portfolio before change:  [6.49574936]
curr_Stock_Price:  101.5880873840634
curr_Factors:  [101.58808738]
mat_Sqrt:  [[0.15]]
grads:  [0.03351097]
Stock Position:  0.033510968886231104
Bond Position:  [3.09143413]


portfolio before change:  [6.5065944]
curr_Stock_Price:  101.90018173140069
curr_Factors:  [101.90018173]
mat_Sqrt:  [[0.15]]
grads:  [0.0587634]
Stock Position:  0.05876340161834269
Bond Position:  [0.5185931]


portfolio before change:  [6.56181034]
curr_Stock_Price:  102.83870999257458
curr_Factors:  [102.83870999]
mat_Sqrt:  [[0.15]]
grads:  [-0.03101272]
Stock Position:  -0.031012724926510228
Bond Position:  [9.75111897]


portfolio before change:  [6.56419324]
curr_Stock_Price:  102.80117926532097
curr_Factors:  [102.80117927]
mat_Sqrt:  [[0.15]]
grads:  [0.06277249]
Stock Position:  0.06277249205649499
Bond Position:  [0.11110703]


portfolio before change:  [6.56961845]
curr_Stock_Price:  102.88738462592696
curr_Factors:  [102.88738463]
mat_Sqrt:  [[0.15]]
grads:  [0.01656686]
Stock Position:  0.01656686279742289
Bond Position:  [4.86509727]


portfolio before change:  [6.58425768]
curr_Stock_Price:  103.73431944268879
curr_Factors:  [103.73431944]
mat_Sqrt:  [[0.15]]
grads:  [0.06080398]
Stock Position:  0.0608039763856648
Bond Position:  [0.27679857]


portfolio before change:  [6.54995299]
curr_Stock_Price:  103.16956535840961
curr_Factors:  [103.16956536]
mat_Sqrt:  [[0.15]]
grads:  [0.06501857]
Stock Position:  0.06501856793861538
Bond Position:  [-0.15798441]


portfolio before change:  [6.57834226]
curr_Stock_Price:  103.6065023928642
curr_Factors:  [103.60650239]
mat_Sqrt:  [[0.15]]
grads:  [0.07871136]
Stock Position:  0.07871136342099423
Bond Position:  [-1.5766668]


portfolio before change:  [6.64912435]
curr_Stock_Price:  104.50826787917586
curr_Factors:  [104.50826788]
mat_Sqrt:  [[0.15]]
grads:  [-0.11076242]
Stock Position:  -0.11076242121947535
Bond Position:  [18.22471314]


portfolio before change:  [6.53584259]
curr_Stock_Price:  105.55158196113128
curr_Factors:  [105.55158196]
mat_Sqrt:  [[0.15]]
grads:  [0.08674903]
Stock Position:  0.08674903275176958
Bond Position:  [-2.62065505]


portfolio before change:  [6.56796447]
curr_Stock_Price:  105.92564349379336
curr_Factors:  [105.92564349]
mat_Sqrt:  [[0.15]]
grads:  [0.27754847]
Stock Position:  0.2775484731733756
Bond Position:  [-22.83153616]


portfolio before change:  [6.71785198]
curr_Stock_Price:  106.47596767741616
curr_Factors:  [106.47596768]
mat_Sqrt:  [[0.15]]
grads:  [0.11382315]
Stock Position:  0.11382314575684577
Bond Position:  [-5.40157761]


portfolio before change:  [6.69754631]
curr_Stock_Price:  106.30350331204639
curr_Factors:  [106.30350331]
mat_Sqrt:  [[0.15]]
grads:  [0.04922842]
Stock Position:  0.04922842000365281
Bond Position:  [1.4643928]


portfolio before change:  [6.6557415]
curr_Stock_Price:  105.45058415228259
curr_Factors:  [105.45058415]
mat_Sqrt:  [[0.15]]
grads:  [0.05043861]
Stock Position:  0.050438614838811256
Bond Position:  [1.33696011]


portfolio before change:  [6.62840177]
curr_Stock_Price:  104.90523093237906
curr_Factors:  [104.90523093]
mat_Sqrt:  [[0.15]]
grads:  [-0.10816936]
Stock Position:  -0.10816936243436107
Bond Position:  [17.97593372]


portfolio before change:  [6.54875691]
curr_Stock_Price:  105.66230296224477
curr_Factors:  [105.66230296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00057069]
Stock Position:  -0.0005706878119656118
Bond Position:  [6.6090571]


portfolio before change:  [6.550341]
curr_Stock_Price:  104.33423549429534
curr_Factors:  [104.33423549]
mat_Sqrt:  [[0.15]]
grads:  [-0.07128998]
Stock Position:  -0.07128997699949104
Bond Position:  [13.98832625]


portfolio before change:  [6.57382877]
curr_Stock_Price:  104.02929620492014
curr_Factors:  [104.0292962]
mat_Sqrt:  [[0.15]]
grads:  [0.3581497]
Stock Position:  0.3581497001179552
Bond Position:  [-30.68423247]


portfolio before change:  [6.3477527]
curr_Stock_Price:  103.40877272134937
curr_Factors:  [103.40877272]
mat_Sqrt:  [[0.15]]
grads:  [-0.05338559]
Stock Position:  -0.05338558597618277
Bond Position:  [11.86829063]


portfolio before change:  [6.32605513]
curr_Stock_Price:  103.84299482077243
curr_Factors:  [103.84299482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03254789]
Stock Position:  -0.03254789223722491
Bond Position:  [9.70592573]


portfolio before change:  [6.33315718]
curr_Stock_Price:  103.66206941655837
curr_Factors:  [103.66206942]
mat_Sqrt:  [[0.15]]
grads:  [0.03211206]
Stock Position:  0.0321120638406974
Bond Position:  [3.00435419]


portfolio before change:  [6.32676901]
curr_Stock_Price:  103.45144000300289
curr_Factors:  [103.45144]
mat_Sqrt:  [[0.15]]
grads:  [0.03563562]
Stock Position:  0.035635623146630234
Bond Position:  [2.64021248]


portfolio before change:  [6.34454327]
curr_Stock_Price:  103.94095619459543
curr_Factors:  [103.94095619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679685]
Stock Position:  -0.026796852033728905
Bond Position:  [9.12983369]


portfolio before change:  [6.34024489]
curr_Stock_Price:  104.14395330636309
curr_Factors:  [104.14395331]
mat_Sqrt:  [[0.15]]
grads:  [0.04744943]
Stock Position:  0.047449434378920886
Bond Position:  [1.39867321]


portfolio before change:  [6.34696756]
curr_Stock_Price:  104.28194923048554
curr_Factors:  [104.28194923]
mat_Sqrt:  [[0.15]]
grads:  [0.03195811]
Stock Position:  0.03195810676547193
Bond Position:  [3.01431389]


portfolio before change:  [6.31536785]
curr_Stock_Price:  103.28137312484192
curr_Factors:  [103.28137312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719519]
Stock Position:  -0.047195185847150496
Bond Position:  [11.18975145]


portfolio before change:  [6.31139363]
curr_Stock_Price:  103.39522021838084
curr_Factors:  [103.39522022]
mat_Sqrt:  [[0.15]]
grads:  [0.06358705]
Stock Position:  0.06358704732408958
Bond Position:  [-0.26320314]


portfolio before change:  [6.36130814]
curr_Stock_Price:  104.1807168784523
curr_Factors:  [104.18071688]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.36130814]
Stock Price:  104.8048404900748
PL:  [1.55646765]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.19636938e-03]
 [ 2.57256027e-03]
 [ 8.82362936e-03]
 [-2.32463438e-03]
 [ 6.74047738e-04]
 [-2.58491352e-02]
 [-8.23640163e-03]
 [ 2.31470685e-02]
 [-5.94548602e-03]
 [ 3.68125644e-03]
 [ 1.01231501e-02]
 [ 4.03952886e-03]
 [ 1.14558724e-02]
 [ 1.22347788e-03]
 [ 2.45279712e-02]
 [ 1.01755028e-03]
 [ 9.84626320e-03]
 [ 1.31647521e-02]
 [ 1.14222426e-02]
 [-1.41707179e-02]
 [-2.13968302e-03]
 [ 2.53988024e-02]
 [-3.43880635e-02]
 [ 6.17400247e-03]
 [-6.61384267e-03]
 [-1.04053890e-02]
 [ 4.22963605e-03]
 [-1.11502555e-02]
 [-1.86035879e-02]
 [-1.44434391e-03]
 [-3.68583022e-03]
 [ 5.62495873e-03]
 [ 6.91451673e-03]
 [-1.24588568e-02]
 [ 4.84031823e-03]
 [ 5.71579039e-03]
 [ 3.56515304e-03]
 [ 1.15087616e-02]
 [-1.75524093e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.83968095]
curr_Stock_Price:  99.56185928325893
curr_Factors:  [99.56185928]
mat_Sqrt:  [[0.15]]
grads:  [0.0279758]
Stock Position:  0.027975795866569862
Bond Position:  [-7.6250032]


portfolio before change:  [-4.83476728]
curr_Stock_Price:  99.77157116376729
curr_Factors:  [99.77157116]
mat_Sqrt:  [[0.15]]
grads:  [0.0171504]
Stock Position:  0.01715040180505077
Bond Position:  [-6.54588981]


portfolio before change:  [-4.82668121]
curr_Stock_Price:  100.29076358101999
curr_Factors:  [100.29076358]
mat_Sqrt:  [[0.15]]
grads:  [0.0588242]
Stock Position:  0.05882419573143421
Bond Position:  [-10.72620472]


portfolio before change:  [-4.87901864]
curr_Stock_Price:  99.42383167707364
curr_Factors:  [99.42383168]
mat_Sqrt:  [[0.15]]
grads:  [-0.01549756]
Stock Position:  -0.01549756255373192
Bond Position:  [-3.33819159]


portfolio before change:  [-4.8712755]
curr_Stock_Price:  98.89726891255627
curr_Factors:  [98.89726891]
mat_Sqrt:  [[0.15]]
grads:  [0.00449365]
Stock Position:  0.0044936515864238994
Bond Position:  [-5.31568537]


portfolio before change:  [-4.87507582]
curr_Stock_Price:  98.19943537663825
curr_Factors:  [98.19943538]
mat_Sqrt:  [[0.15]]
grads:  [-0.17232757]
Stock Position:  -0.1723275681196751
Bond Position:  [12.04739407]


portfolio before change:  [-5.08873225]
curr_Stock_Price:  99.44800196026131
curr_Factors:  [99.44800196]
mat_Sqrt:  [[0.15]]
grads:  [-0.05490934]
Stock Position:  -0.05490934422941125
Bond Position:  [0.37189232]


portfolio before change:  [-5.07083485]
curr_Stock_Price:  99.12290405747194
curr_Factors:  [99.12290406]
mat_Sqrt:  [[0.15]]
grads:  [0.15431379]
Stock Position:  0.15431378973916013
Bond Position:  [-20.36686582]


portfolio before change:  [-4.9440474]
curr_Stock_Price:  99.9610239983787
curr_Factors:  [99.961024]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963657]
Stock Position:  -0.03963657348088634
Bond Position:  [-0.98193493]


portfolio before change:  [-4.93626729]
curr_Stock_Price:  99.76164103779342
curr_Factors:  [99.76164104]
mat_Sqrt:  [[0.15]]
grads:  [0.02454171]
Stock Position:  0.024541709632436057
Bond Position:  [-7.38458852]


portfolio before change:  [-4.91729042]
curr_Stock_Price:  100.5725056747055
curr_Factors:  [100.57250567]
mat_Sqrt:  [[0.15]]
grads:  [0.06748767]
Stock Position:  0.06748766700389199
Bond Position:  [-11.70469419]


portfolio before change:  [-4.92449035]
curr_Stock_Price:  100.48750118606344
curr_Factors:  [100.48750119]
mat_Sqrt:  [[0.15]]
grads:  [0.02693019]
Stock Position:  0.026930192432528685
Bond Position:  [-7.63063809]


portfolio before change:  [-4.93617912]
curr_Stock_Price:  100.08888224702308
curr_Factors:  [100.08888225]
mat_Sqrt:  [[0.15]]
grads:  [0.07637248]
Stock Position:  0.07637248252911746
Bond Position:  [-12.58021554]


portfolio before change:  [-4.8950714]
curr_Stock_Price:  100.64772681071396
curr_Factors:  [100.64772681]
mat_Sqrt:  [[0.15]]
grads:  [0.00815652]
Stock Position:  0.008156519180347772
Bond Position:  [-5.71600652]


portfolio before change:  [-4.89189684]
curr_Stock_Price:  101.12453621710648
curr_Factors:  [101.12453622]
mat_Sqrt:  [[0.15]]
grads:  [0.16351981]
Stock Position:  0.16351980782037162
Bond Position:  [-21.42776157]


portfolio before change:  [-4.95013544]
curr_Stock_Price:  100.78476113839115
curr_Factors:  [100.78476114]
mat_Sqrt:  [[0.15]]
grads:  [0.00678367]
Stock Position:  0.006783668547448289
Bond Position:  [-5.63382585]


portfolio before change:  [-4.94928262]
curr_Stock_Price:  101.01429675356053
curr_Factors:  [101.01429675]
mat_Sqrt:  [[0.15]]
grads:  [0.06564175]
Stock Position:  0.06564175464352248
Bond Position:  [-11.5800383]


portfolio before change:  [-4.9739949]
curr_Stock_Price:  100.65987769887201
curr_Factors:  [100.6598777]
mat_Sqrt:  [[0.15]]
grads:  [0.08776501]
Stock Position:  0.0877650138843894
Bond Position:  [-13.80841046]


portfolio before change:  [-4.97345043]
curr_Stock_Price:  100.68574942141873
curr_Factors:  [100.68574942]
mat_Sqrt:  [[0.15]]
grads:  [0.07614828]
Stock Position:  0.0761482840511069
Bond Position:  [-12.64049747]


portfolio before change:  [-4.86252835]
curr_Stock_Price:  102.16315942370974
curr_Factors:  [102.16315942]
mat_Sqrt:  [[0.15]]
grads:  [-0.09447145]
Stock Position:  -0.09447145271408551
Bond Position:  [4.78897373]


portfolio before change:  [-4.9170413]
curr_Stock_Price:  102.7465272385827
curr_Factors:  [102.74652724]
mat_Sqrt:  [[0.15]]
grads:  [-0.01426455]
Stock Position:  -0.014264553493091442
Bond Position:  [-3.45140796]


portfolio before change:  [-4.91522853]
curr_Stock_Price:  102.5891987519371
curr_Factors:  [102.58919875]
mat_Sqrt:  [[0.15]]
grads:  [0.16932535]
Stock Position:  0.16932534952739337
Bond Position:  [-22.28618047]


portfolio before change:  [-4.95207827]
curr_Stock_Price:  102.38802512281706
curr_Factors:  [102.38802512]
mat_Sqrt:  [[0.15]]
grads:  [-0.22925376]
Stock Position:  -0.22925375653716037
Bond Position:  [18.52076111]


portfolio before change:  [-4.71137696]
curr_Stock_Price:  101.34819017304412
curr_Factors:  [101.34819017]
mat_Sqrt:  [[0.15]]
grads:  [0.04116002]
Stock Position:  0.041160016447290435
Bond Position:  [-8.88287014]


portfolio before change:  [-4.73986245]
curr_Stock_Price:  100.68310152814004
curr_Factors:  [100.68310153]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409228]
Stock Position:  -0.044092284472189415
Bond Position:  [-0.3005145]


portfolio before change:  [-4.69036064]
curr_Stock_Price:  99.55956316003211
curr_Factors:  [99.55956316]
mat_Sqrt:  [[0.15]]
grads:  [-0.06936926]
Stock Position:  -0.0693692599162471
Bond Position:  [2.21601257]


portfolio before change:  [-4.72537205]
curr_Stock_Price:  100.06826725929821
curr_Factors:  [100.06826726]
mat_Sqrt:  [[0.15]]
grads:  [0.02819757]
Stock Position:  0.028197573672986923
Bond Position:  [-7.54705439]


portfolio before change:  [-4.74158079]
curr_Stock_Price:  99.52689819249633
curr_Factors:  [99.52689819]
mat_Sqrt:  [[0.15]]
grads:  [-0.07433504]
Stock Position:  -0.07433503655978313
Bond Position:  [2.65675483]


portfolio before change:  [-4.70196779]
curr_Stock_Price:  98.99846793792968
curr_Factors:  [98.99846794]
mat_Sqrt:  [[0.15]]
grads:  [-0.12402392]
Stock Position:  -0.12402391963638909
Bond Position:  [7.57621024]


portfolio before change:  [-4.58496269]
curr_Stock_Price:  98.06269673592544
curr_Factors:  [98.06269674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962896]
Stock Position:  -0.009628959416470753
Bond Position:  [-3.64072096]


portfolio before change:  [-4.58745056]
curr_Stock_Price:  98.2738042706494
curr_Factors:  [98.27380427]
mat_Sqrt:  [[0.15]]
grads:  [-0.0245722]
Stock Position:  -0.024572201494290694
Bond Position:  [-2.17264684]


portfolio before change:  [-4.58250179]
curr_Stock_Price:  98.0613544742328
curr_Factors:  [98.06135447]
mat_Sqrt:  [[0.15]]
grads:  [0.03749972]
Stock Position:  0.03749972489444229
Bond Position:  [-8.25977561]


portfolio before change:  [-4.55927747]
curr_Stock_Price:  98.70820892427624
curr_Factors:  [98.70820892]
mat_Sqrt:  [[0.15]]
grads:  [0.04609678]
Stock Position:  0.046096778214010335
Bond Position:  [-9.10940788]


portfolio before change:  [-4.57105641]
curr_Stock_Price:  98.47738593620879
curr_Factors:  [98.47738594]
mat_Sqrt:  [[0.15]]
grads:  [-0.08305905]
Stock Position:  -0.08305904548729019
Bond Position:  [3.60838127]


portfolio before change:  [-4.54809581]
curr_Stock_Price:  98.20637962356983
curr_Factors:  [98.20637962]
mat_Sqrt:  [[0.15]]
grads:  [0.03226879]
Stock Position:  0.032268788175953876
Bond Position:  [-7.71709667]


portfolio before change:  [-4.52492245]
curr_Stock_Price:  98.95441076565174
curr_Factors:  [98.95441077]
mat_Sqrt:  [[0.15]]
grads:  [0.03810527]
Stock Position:  0.03810526924514701
Bond Position:  [-8.29560691]


portfolio before change:  [-4.56016649]
curr_Stock_Price:  98.05671271574187
curr_Factors:  [98.05671272]
mat_Sqrt:  [[0.15]]
grads:  [0.02376769]
Stock Position:  0.023767686919594837
Bond Position:  [-6.89074774]


portfolio before change:  [-4.56606868]
curr_Stock_Price:  97.8446269120727
curr_Factors:  [97.84462691]
mat_Sqrt:  [[0.15]]
grads:  [0.07672508]
Stock Position:  0.07672507737661116
Bond Position:  [-12.07320525]


portfolio before change:  [-4.51018581]
curr_Stock_Price:  98.5926497188071
curr_Factors:  [98.59264972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.51018581]
Stock Price:  98.37312384714937
PL:  [-4.51018581]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.96897490e-03]
 [ 1.37799944e-03]
 [ 1.47038863e-02]
 [ 2.85275054e-03]
 [ 3.30289300e-03]
 [ 2.95171313e-02]
 [ 3.14475132e-02]
 [ 1.98589425e-03]
 [-1.44219656e-02]
 [ 1.30920783e-04]
 [ 3.59182918e-02]
 [ 1.08804870e-02]
 [-8.62094036e-03]
 [-4.84292806e-03]
 [-9.49235549e-03]
 [ 6.08220143e-03]
 [ 9.27506543e-03]
 [-2.34731425e-02]
 [ 1.27482951e-02]
 [-1.80855120e-02]
 [ 1.95226777e-02]
 [ 4.48206866e-02]
 [ 1.83288106e-02]
 [ 7.17193654e-03]
 [ 7.73671206e-03]
 [-2.49060631e-02]
 [ 1.48519069e-03]
 [-1.54782119e-02]
 [ 6.89184432e-02]
 [-2.58122720e-03]
 [-1.28773239e-02]
 [ 3.87223158e-03]
 [ 6.46586197e-03]
 [ 3.41452204e-03]
 [ 8.18997040e-03]
 [ 3.71564837e-03]
 [-6.91557436e-02]
 [ 9.20470624e-03]
 [-2.94482201e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.96847606]
curr_Stock_Price:  100.19457730456287
curr_Factors:  [100.1945773]
mat_Sqrt:  [[0.15]]
grads:  [0.03979317]
Stock Position:  0.03979316602308331
Bond Position:  [0.98141661]


portfolio before change:  [5.00486312]
curr_Stock_Price:  101.10589894867644
curr_Factors:  [101.10589895]
mat_Sqrt:  [[0.15]]
grads:  [0.00918666]
Stock Position:  0.009186662906568686
Bond Position:  [4.07603731]


portfolio before change:  [5.00644017]
curr_Stock_Price:  101.22210162187346
curr_Factors:  [101.22210162]
mat_Sqrt:  [[0.15]]
grads:  [0.09802591]
Stock Position:  0.09802590894871835
Bond Position:  [-4.91594835]


portfolio before change:  [5.02804475]
curr_Stock_Price:  101.44876731357697
curr_Factors:  [101.44876731]
mat_Sqrt:  [[0.15]]
grads:  [0.01901834]
Stock Position:  0.01901833693684798
Bond Position:  [3.09865791]


portfolio before change:  [5.04703168]
curr_Stock_Price:  102.42674848694
curr_Factors:  [102.42674849]
mat_Sqrt:  [[0.15]]
grads:  [0.02201929]
Stock Position:  0.022019286641743418
Bond Position:  [2.79166775]


portfolio before change:  [5.04940942]
curr_Stock_Price:  102.51888391692916
curr_Factors:  [102.51888392]
mat_Sqrt:  [[0.15]]
grads:  [0.19678088]
Stock Position:  0.19678087537650193
Bond Position:  [-15.1243463]


portfolio before change:  [5.17958919]
curr_Stock_Price:  103.19003871529415
curr_Factors:  [103.19003872]
mat_Sqrt:  [[0.15]]
grads:  [0.20965009]
Stock Position:  0.20965008789485315
Bond Position:  [-16.4542115]


portfolio before change:  [5.22638592]
curr_Stock_Price:  103.42306338802891
curr_Factors:  [103.42306339]
mat_Sqrt:  [[0.15]]
grads:  [0.01323929]
Stock Position:  0.013239294997549878
Bond Position:  [3.85713748]


portfolio before change:  [5.25645941]
curr_Stock_Price:  105.6581755188919
curr_Factors:  [105.65817552]
mat_Sqrt:  [[0.15]]
grads:  [-0.09614644]
Stock Position:  -0.09614643714437293
Bond Position:  [15.41511654]


portfolio before change:  [5.18629968]
curr_Stock_Price:  106.40793529024998
curr_Factors:  [106.40793529]
mat_Sqrt:  [[0.15]]
grads:  [0.00087281]
Stock Position:  0.0008728052179014558
Bond Position:  [5.09342628]


portfolio before change:  [5.18706022]
curr_Stock_Price:  106.54979405332126
curr_Factors:  [106.54979405]
mat_Sqrt:  [[0.15]]
grads:  [0.23945528]
Stock Position:  0.23945527887863832
Bond Position:  [-20.32685043]


portfolio before change:  [5.12179434]
curr_Stock_Price:  106.28784592748882
curr_Factors:  [106.28784593]
mat_Sqrt:  [[0.15]]
grads:  [0.07253658]
Stock Position:  0.07253657976467741
Bond Position:  [-2.58796247]


portfolio before change:  [5.21647083]
curr_Stock_Price:  107.59753002529632
curr_Factors:  [107.59753003]
mat_Sqrt:  [[0.15]]
grads:  [-0.05747294]
Stock Position:  -0.057472935725012234
Bond Position:  [11.40041676]


portfolio before change:  [5.2371203]
curr_Stock_Price:  107.26303643068532
curr_Factors:  [107.26303643]
mat_Sqrt:  [[0.15]]
grads:  [-0.03228619]
Stock Position:  -0.03228618706616171
Bond Position:  [8.70023476]


portfolio before change:  [5.23610695]
curr_Stock_Price:  107.32810894651371
curr_Factors:  [107.32810895]
mat_Sqrt:  [[0.15]]
grads:  [-0.06328237]
Stock Position:  -0.06328236994626055
Bond Position:  [12.02808405]


portfolio before change:  [5.30166675]
curr_Stock_Price:  106.31588093512492
curr_Factors:  [106.31588094]
mat_Sqrt:  [[0.15]]
grads:  [0.04054801]
Stock Position:  0.04054800953505865
Bond Position:  [0.99076939]


portfolio before change:  [5.32309126]
curr_Stock_Price:  106.84120036990109
curr_Factors:  [106.84120037]
mat_Sqrt:  [[0.15]]
grads:  [0.06183377]
Stock Position:  0.061833769515709645
Bond Position:  [-1.2833029]


portfolio before change:  [5.30418214]
curr_Stock_Price:  106.53798908305495
curr_Factors:  [106.53798908]
mat_Sqrt:  [[0.15]]
grads:  [-0.15648762]
Stock Position:  -0.15648761646186793
Bond Position:  [21.97605811]


portfolio before change:  [5.1757648]
curr_Stock_Price:  107.3761673287348
curr_Factors:  [107.37616733]
mat_Sqrt:  [[0.15]]
grads:  [0.08498863]
Stock Position:  0.08498863431288325
Bond Position:  [-3.94998902]


portfolio before change:  [5.11114252]
curr_Stock_Price:  106.6216134426369
curr_Factors:  [106.62161344]
mat_Sqrt:  [[0.15]]
grads:  [-0.12057008]
Stock Position:  -0.12057008022070048
Bond Position:  [17.966519]


portfolio before change:  [5.05743651]
curr_Stock_Price:  107.08567519844051
curr_Factors:  [107.0856752]
mat_Sqrt:  [[0.15]]
grads:  [0.13015118]
Stock Position:  0.13015118433857872
Bond Position:  [-8.87989094]


portfolio before change:  [5.0011431]
curr_Stock_Price:  106.66168095561501
curr_Factors:  [106.66168096]
mat_Sqrt:  [[0.15]]
grads:  [0.29880458]
Stock Position:  0.29880457764672347
Bond Position:  [-26.86985543]


portfolio before change:  [4.96319056]
curr_Stock_Price:  106.54590762254254
curr_Factors:  [106.54590762]
mat_Sqrt:  [[0.15]]
grads:  [0.12219207]
Stock Position:  0.12219207066059876
Bond Position:  [-8.05587452]


portfolio before change:  [4.9907557]
curr_Stock_Price:  106.77973773035792
curr_Factors:  [106.77973773]
mat_Sqrt:  [[0.15]]
grads:  [0.04781291]
Stock Position:  0.04781291029127798
Bond Position:  [-0.11469433]


portfolio before change:  [4.96662687]
curr_Stock_Price:  106.27538668294197
curr_Factors:  [106.27538668]
mat_Sqrt:  [[0.15]]
grads:  [0.05157808]
Stock Position:  0.051578080367271885
Bond Position:  [-0.51485357]


portfolio before change:  [5.00526286]
curr_Stock_Price:  107.02571238901726
curr_Factors:  [107.02571239]
mat_Sqrt:  [[0.15]]
grads:  [-0.16604042]
Stock Position:  -0.16604042072871608
Bond Position:  [22.77585718]


portfolio before change:  [4.91514189]
curr_Stock_Price:  107.58562508406102
curr_Factors:  [107.58562508]
mat_Sqrt:  [[0.15]]
grads:  [0.00990127]
Stock Position:  0.009901271294951526
Bond Position:  [3.84990742]


portfolio before change:  [4.92027383]
curr_Stock_Price:  108.05533049929812
curr_Factors:  [108.0553305]
mat_Sqrt:  [[0.15]]
grads:  [-0.10318808]
Stock Position:  -0.10318807952598405
Bond Position:  [16.07029587]


portfolio before change:  [5.03356866]
curr_Stock_Price:  106.97685401391207
curr_Factors:  [106.97685401]
mat_Sqrt:  [[0.15]]
grads:  [0.45945629]
Stock Position:  0.4594562879654756
Bond Position:  [-44.11761958]


portfolio before change:  [5.09600267]
curr_Stock_Price:  107.1247441490336
curr_Factors:  [107.12474415]
mat_Sqrt:  [[0.15]]
grads:  [-0.01720818]
Stock Position:  -0.017208181341463787
Bond Position:  [6.93942469]


portfolio before change:  [5.09461142]
curr_Stock_Price:  107.25600338317476
curr_Factors:  [107.25600338]
mat_Sqrt:  [[0.15]]
grads:  [-0.08584883]
Stock Position:  -0.08584882594747818
Bond Position:  [14.30241339]


portfolio before change:  [5.00009839]
curr_Stock_Price:  108.377753687335
curr_Factors:  [108.37775369]
mat_Sqrt:  [[0.15]]
grads:  [0.02581488]
Stock Position:  0.02581487719064003
Bond Position:  [2.20233998]


portfolio before change:  [4.9609734]
curr_Stock_Price:  106.8514907012671
curr_Factors:  [106.8514907]
mat_Sqrt:  [[0.15]]
grads:  [0.04310575]
Stock Position:  0.04310574645309473
Bond Position:  [0.35506014]


portfolio before change:  [4.99786069]
curr_Stock_Price:  107.70620033153018
curr_Factors:  [107.70620033]
mat_Sqrt:  [[0.15]]
grads:  [0.02276348]
Stock Position:  0.022763480237746082
Bond Position:  [2.54609272]


portfolio before change:  [5.00616326]
curr_Stock_Price:  108.05695038498453
curr_Factors:  [108.05695038]
mat_Sqrt:  [[0.15]]
grads:  [0.0545998]
Stock Position:  0.05459980268373941
Bond Position:  [-0.89372491]


portfolio before change:  [4.93421706]
curr_Stock_Price:  106.74129590270732
curr_Factors:  [106.7412959]
mat_Sqrt:  [[0.15]]
grads:  [0.02477099]
Stock Position:  0.024770989122770124
Bond Position:  [2.29012958]


portfolio before change:  [4.98599229]
curr_Stock_Price:  108.81989449245883
curr_Factors:  [108.81989449]
mat_Sqrt:  [[0.15]]
grads:  [-0.46103829]
Stock Position:  -0.4610382907833192
Bond Position:  [55.15613045]


portfolio before change:  [5.04608497]
curr_Stock_Price:  108.70450768418534
curr_Factors:  [108.70450768]
mat_Sqrt:  [[0.15]]
grads:  [0.06136471]
Stock Position:  0.06136470826756583
Bond Position:  [-1.62453543]


portfolio before change:  [5.02554007]
curr_Stock_Price:  108.37301700946895
curr_Factors:  [108.37301701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.02554007]
Stock Price:  108.19600396379455
PL:  [-3.1704639]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.24543847e-03]
 [-9.85956450e-05]
 [ 1.35309062e-02]
 [-2.66402033e-03]
 [ 1.50220575e-02]
 [ 2.04152339e-02]
 [ 1.61236198e-03]
 [ 1.15541287e-02]
 [-8.16594343e-03]
 [-1.95056440e-03]
 [ 1.05341601e-02]
 [ 4.34468894e-03]
 [ 1.14504679e-02]
 [ 3.78567291e-03]
 [ 3.89880737e-03]
 [-2.88244513e-03]
 [ 9.52828875e-03]
 [ 1.29994364e-02]
 [ 1.14940303e-02]
 [-1.25906989e-02]
 [ 9.05231508e-04]
 [ 1.01326285e-02]
 [ 6.91797249e-03]
 [ 6.13225936e-03]
 [-2.21066720e-03]
 [-7.90286465e-03]
 [ 3.03906724e-03]
 [-1.12715061e-02]
 [ 1.67889700e-02]
 [-9.12898164e-03]
 [ 1.36411387e-04]
 [ 5.04351580e-03]
 [ 5.12237675e-03]
 [-4.67778529e-03]
 [ 1.01278419e-02]
 [ 4.83684065e-03]
 [-2.07889423e-02]
 [ 9.80469756e-03]
 [-6.17974696e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.58064685]
curr_Stock_Price:  101.26621796197843
curr_Factors:  [101.26621796]
mat_Sqrt:  [[0.15]]
grads:  [0.05496959]
Stock Position:  0.05496958980204653
Bond Position:  [16.01408439]


portfolio before change:  [21.49027412]
curr_Stock_Price:  99.58575030566624
curr_Factors:  [99.58575031]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006573]
Stock Position:  -0.0006573043001574866
Bond Position:  [21.55573226]


portfolio before change:  [21.49209256]
curr_Stock_Price:  100.91875570401031
curr_Factors:  [100.9187557]
mat_Sqrt:  [[0.15]]
grads:  [0.09020604]
Stock Position:  0.09020604146201514
Bond Position:  [12.3886111]


portfolio before change:  [21.46737481]
curr_Stock_Price:  100.62757315524529
curr_Factors:  [100.62757316]
mat_Sqrt:  [[0.15]]
grads:  [-0.01776014]
Stock Position:  -0.017760135505294213
Bond Position:  [23.25453414]


portfolio before change:  [21.46506381]
curr_Stock_Price:  100.92137689259641
curr_Factors:  [100.92137689]
mat_Sqrt:  [[0.15]]
grads:  [0.10014705]
Stock Position:  0.10014704988888057
Bond Position:  [11.35808565]


portfolio before change:  [21.40180737]
curr_Stock_Price:  100.27556361019414
curr_Factors:  [100.27556361]
mat_Sqrt:  [[0.15]]
grads:  [0.13610156]
Stock Position:  0.13610155947195635
Bond Position:  [7.75414678]


portfolio before change:  [21.4250949]
curr_Stock_Price:  100.43954560985145
curr_Factors:  [100.43954561]
mat_Sqrt:  [[0.15]]
grads:  [0.01074908]
Stock Position:  0.01074907987911018
Bond Position:  [20.3454622]


portfolio before change:  [21.44014696]
curr_Stock_Price:  101.60324666693593
curr_Factors:  [101.60324667]
mat_Sqrt:  [[0.15]]
grads:  [0.07702752]
Stock Position:  0.07702752494652268
Bond Position:  [13.61390034]


portfolio before change:  [21.44823252]
curr_Stock_Price:  101.68612237058991
curr_Factors:  [101.68612237]
mat_Sqrt:  [[0.15]]
grads:  [-0.05443962]
Stock Position:  -0.05443962287029506
Bond Position:  [26.98398667]


portfolio before change:  [21.46390395]
curr_Stock_Price:  101.46021666243291
curr_Factors:  [101.46021666]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300376]
Stock Position:  -0.01300376265848478
Bond Position:  [22.78326852]


portfolio before change:  [21.46333336]
curr_Stock_Price:  101.72311561041082
curr_Factors:  [101.72311561]
mat_Sqrt:  [[0.15]]
grads:  [0.07022773]
Stock Position:  0.07022773429783313
Bond Position:  [14.31954942]


portfolio before change:  [21.41242081]
curr_Stock_Price:  100.97266275807833
curr_Factors:  [100.97266276]
mat_Sqrt:  [[0.15]]
grads:  [0.02896459]
Stock Position:  0.028964592952019967
Bond Position:  [18.48778873]


portfolio before change:  [21.38819854]
curr_Stock_Price:  100.05660009289873
curr_Factors:  [100.05660009]
mat_Sqrt:  [[0.15]]
grads:  [0.07633645]
Stock Position:  0.07633645283981406
Bond Position:  [13.75023261]


portfolio before change:  [21.30597795]
curr_Stock_Price:  98.95700120816375
curr_Factors:  [98.95700121]
mat_Sqrt:  [[0.15]]
grads:  [0.02523782]
Stock Position:  0.025237819376224137
Bond Position:  [18.80851903]


portfolio before change:  [21.28902633]
curr_Stock_Price:  98.19216343355855
curr_Factors:  [98.19216343]
mat_Sqrt:  [[0.15]]
grads:  [0.02599205]
Stock Position:  0.025992049153605784
Bond Position:  [18.73681079]


portfolio before change:  [21.32272345]
curr_Stock_Price:  99.39848926051079
curr_Factors:  [99.39848926]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192163]
Stock Position:  -0.019216300890085577
Bond Position:  [23.23279473]


portfolio before change:  [21.31241583]
curr_Stock_Price:  100.08602540398695
curr_Factors:  [100.0860254]
mat_Sqrt:  [[0.15]]
grads:  [0.06352192]
Stock Position:  0.06352192498150283
Bond Position:  [14.95475884]


portfolio before change:  [21.34627411]
curr_Stock_Price:  100.58961233379124
curr_Factors:  [100.58961233]
mat_Sqrt:  [[0.15]]
grads:  [0.08666291]
Stock Position:  0.0866629095848706
Bond Position:  [12.62888563]


portfolio before change:  [21.33826448]
curr_Stock_Price:  100.47897288009679
curr_Factors:  [100.47897288]
mat_Sqrt:  [[0.15]]
grads:  [0.07662687]
Stock Position:  0.07662686886251197
Bond Position:  [13.6388754]


portfolio before change:  [21.2976122]
curr_Stock_Price:  99.92620013480857
curr_Factors:  [99.92620013]
mat_Sqrt:  [[0.15]]
grads:  [-0.08393799]
Stock Position:  -0.08393799290673616
Bond Position:  [29.68521688]


portfolio before change:  [21.33109288]
curr_Stock_Price:  99.57153605911044
curr_Factors:  [99.57153606]
mat_Sqrt:  [[0.15]]
grads:  [0.00603488]
Stock Position:  0.0060348767167383325
Bond Position:  [20.73019093]


portfolio before change:  [21.33306053]
curr_Stock_Price:  99.46817369234165
curr_Factors:  [99.46817369]
mat_Sqrt:  [[0.15]]
grads:  [0.06755086]
Stock Position:  0.06755085643989556
Bond Position:  [14.61390021]


portfolio before change:  [21.37536776]
curr_Stock_Price:  100.06743152565652
curr_Factors:  [100.06743153]
mat_Sqrt:  [[0.15]]
grads:  [0.04611982]
Stock Position:  0.04611981661302725
Bond Position:  [16.76027617]


portfolio before change:  [21.42805645]
curr_Stock_Price:  101.16443330116964
curr_Factors:  [101.1644333]
mat_Sqrt:  [[0.15]]
grads:  [0.04088173]
Stock Position:  0.040881729043834365
Bond Position:  [17.2922795]


portfolio before change:  [21.3872996]
curr_Stock_Price:  100.11461180204553
curr_Factors:  [100.1146118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01473778]
Stock Position:  -0.014737781352163309
Bond Position:  [22.86276686]


portfolio before change:  [21.38042268]
curr_Stock_Price:  100.77515547543825
curr_Factors:  [100.77515548]
mat_Sqrt:  [[0.15]]
grads:  [-0.05268576]
Stock Position:  -0.05268576430713125
Bond Position:  [26.68983877]


portfolio before change:  [21.39011407]
curr_Stock_Price:  100.65453559516257
curr_Factors:  [100.6545356]
mat_Sqrt:  [[0.15]]
grads:  [0.02026045]
Stock Position:  0.02026044824947985
Bond Position:  [19.35080806]


portfolio before change:  [21.41859085]
curr_Stock_Price:  101.94067601424517
curr_Factors:  [101.94067601]
mat_Sqrt:  [[0.15]]
grads:  [-0.07514337]
Stock Position:  -0.07514337372651173
Bond Position:  [29.07875717]


portfolio before change:  [21.4149226]
curr_Stock_Price:  102.0378679188936
curr_Factors:  [102.03786792]
mat_Sqrt:  [[0.15]]
grads:  [0.11192647]
Stock Position:  0.11192646690508748
Bond Position:  [9.99418455]


portfolio before change:  [21.51778995]
curr_Stock_Price:  102.94576761499515
curr_Factors:  [102.94576761]
mat_Sqrt:  [[0.15]]
grads:  [-0.06085988]
Stock Position:  -0.06085987758800475
Bond Position:  [27.78305677]


portfolio before change:  [21.56921165]
curr_Stock_Price:  102.15791524488618
curr_Factors:  [102.15791524]
mat_Sqrt:  [[0.15]]
grads:  [0.00090941]
Stock Position:  0.0009094092449431827
Bond Position:  [21.4763083]


portfolio before change:  [21.57221488]
curr_Stock_Price:  102.50816481783104
curr_Factors:  [102.50816482]
mat_Sqrt:  [[0.15]]
grads:  [0.03362344]
Stock Position:  0.033623438699481076
Bond Position:  [18.12553788]


portfolio before change:  [21.57115562]
curr_Stock_Price:  102.40927268506526
curr_Factors:  [102.40927269]
mat_Sqrt:  [[0.15]]
grads:  [0.03414918]
Stock Position:  0.03414917831665787
Bond Position:  [18.0739631]


portfolio before change:  [21.58683933]
curr_Stock_Price:  102.80238105145543
curr_Factors:  [102.80238105]
mat_Sqrt:  [[0.15]]
grads:  [-0.03118524]
Stock Position:  -0.031185235263384757
Bond Position:  [24.79275577]


portfolio before change:  [21.57621241]
curr_Stock_Price:  103.24253181991479
curr_Factors:  [103.24253182]
mat_Sqrt:  [[0.15]]
grads:  [0.06751895]
Stock Position:  0.06751894589262239
Bond Position:  [14.60538549]


portfolio before change:  [21.63406059]
curr_Stock_Price:  104.07226031471941
curr_Factors:  [104.07226031]
mat_Sqrt:  [[0.15]]
grads:  [0.0322456]
Stock Position:  0.03224560435240423
Bond Position:  [18.27818766]


portfolio before change:  [21.65488152]
curr_Stock_Price:  104.64709875067972
curr_Factors:  [104.64709875]
mat_Sqrt:  [[0.15]]
grads:  [-0.13859295]
Stock Position:  -0.1385929483698527
Bond Position:  [36.15823148]


portfolio before change:  [21.48884445]
curr_Stock_Price:  105.87773235404246
curr_Factors:  [105.87773235]
mat_Sqrt:  [[0.15]]
grads:  [0.06536465]
Stock Position:  0.06536465041032653
Bond Position:  [14.56818348]


portfolio before change:  [21.55794747]
curr_Stock_Price:  106.90706382606764
curr_Factors:  [106.90706383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.55794747]
Stock Price:  107.26246442773076
PL:  [14.29548305]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.31343764e-03]
 [ 4.45906117e-03]
 [ 6.15772729e-03]
 [-2.66817985e-03]
 [ 1.52258940e-02]
 [ 2.61265820e-02]
 [-7.00873098e-04]
 [ 1.40164422e-02]
 [-8.02050754e-03]
 [-1.88468009e-03]
 [ 1.26074705e-02]
 [ 6.27936938e-03]
 [ 8.51073918e-03]
 [-1.01505862e-03]
 [ 2.07783083e-02]
 [ 1.80711403e-03]
 [ 8.93832103e-03]
 [ 9.87418625e-03]
 [ 1.19810221e-02]
 [-1.57107015e-02]
 [ 2.75022934e-03]
 [ 3.55070303e-02]
 [-2.43658934e-02]
 [ 7.84700809e-03]
 [ 4.79380233e-03]
 [-1.39471815e-02]
 [-5.33987605e-04]
 [-1.07169231e-02]
 [ 4.18562355e-02]
 [-8.77301380e-03]
 [-3.66894622e-04]
 [ 5.00032326e-03]
 [ 5.20657800e-03]
 [-4.29018320e-03]
 [ 1.32676811e-02]
 [ 5.30050474e-03]
 [-1.23808570e-03]
 [ 7.86553767e-03]
 [-1.42740019e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.42221341]
curr_Stock_Price:  100.86894130609339
curr_Factors:  [100.86894131]
mat_Sqrt:  [[0.15]]
grads:  [0.04208958]
Stock Position:  0.04208958424787116
Bond Position:  [11.17668161]


portfolio before change:  [15.40404184]
curr_Stock_Price:  100.40401055056063
curr_Factors:  [100.40401055]
mat_Sqrt:  [[0.15]]
grads:  [0.02972707]
Stock Position:  0.029727074471923808
Bond Position:  [12.41932434]


portfolio before change:  [15.38593342]
curr_Stock_Price:  99.742629211213
curr_Factors:  [99.74262921]
mat_Sqrt:  [[0.15]]
grads:  [0.04105152]
Stock Position:  0.04105151527291641
Bond Position:  [11.29134736]


portfolio before change:  [15.42326392]
curr_Stock_Price:  100.61760267492143
curr_Factors:  [100.61760267]
mat_Sqrt:  [[0.15]]
grads:  [-0.01778787]
Stock Position:  -0.01778786567842364
Bond Position:  [17.21303632]


portfolio before change:  [15.42275534]
curr_Stock_Price:  100.76716168022148
curr_Factors:  [100.76716168]
mat_Sqrt:  [[0.15]]
grads:  [0.10150596]
Stock Position:  0.10150595995149533
Bond Position:  [5.19428787]


portfolio before change:  [15.43562001]
curr_Stock_Price:  100.88750278852962
curr_Factors:  [100.88750279]
mat_Sqrt:  [[0.15]]
grads:  [0.17417721]
Stock Position:  0.17417721315502013
Bond Position:  [-2.13668407]


portfolio before change:  [15.40260962]
curr_Stock_Price:  100.69951443038141
curr_Factors:  [100.69951443]
mat_Sqrt:  [[0.15]]
grads:  [-0.00467249]
Stock Position:  -0.00467248732205094
Bond Position:  [15.87312682]


portfolio before change:  [15.40234813]
curr_Stock_Price:  101.18014916028693
curr_Factors:  [101.18014916]
mat_Sqrt:  [[0.15]]
grads:  [0.09344295]
Stock Position:  0.09344294796682916
Bond Position:  [5.94777671]


portfolio before change:  [15.44120772]
curr_Stock_Price:  101.58805660227804
curr_Factors:  [101.5880566]
mat_Sqrt:  [[0.15]]
grads:  [-0.05347005]
Stock Position:  -0.05347005029132795
Bond Position:  [20.87312621]


portfolio before change:  [15.4518782]
curr_Stock_Price:  101.43729597176683
curr_Factors:  [101.43729597]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256453]
Stock Position:  -0.012564533945631721
Bond Position:  [16.72639055]


portfolio before change:  [15.44391348]
curr_Stock_Price:  102.2376157848426
curr_Factors:  [102.23761578]
mat_Sqrt:  [[0.15]]
grads:  [0.0840498]
Stock Position:  0.08404980324174342
Bond Position:  [6.85086199]


portfolio before change:  [15.45762874]
curr_Stock_Price:  102.39060658386212
curr_Factors:  [102.39060658]
mat_Sqrt:  [[0.15]]
grads:  [0.04186246]
Stock Position:  0.04186246251907874
Bond Position:  [11.17130581]


portfolio before change:  [15.44265023]
curr_Stock_Price:  101.99944441216626
curr_Factors:  [101.99944441]
mat_Sqrt:  [[0.15]]
grads:  [0.05673826]
Stock Position:  0.05673826117547527
Bond Position:  [9.65537911]


portfolio before change:  [15.3826634]
curr_Stock_Price:  100.92091598817781
curr_Factors:  [100.92091599]
mat_Sqrt:  [[0.15]]
grads:  [-0.00676706]
Stock Position:  -0.006767057439594544
Bond Position:  [16.06560104]


portfolio before change:  [15.37972857]
curr_Stock_Price:  101.65138927071162
curr_Factors:  [101.65138927]
mat_Sqrt:  [[0.15]]
grads:  [0.13852206]
Stock Position:  0.13852205520936064
Bond Position:  [1.29876922]


portfolio before change:  [15.3540194]
curr_Stock_Price:  101.46462098668003
curr_Factors:  [101.46462099]
mat_Sqrt:  [[0.15]]
grads:  [0.01204743]
Stock Position:  0.012047426855297019
Bond Position:  [14.1316318]


portfolio before change:  [15.37227385]
curr_Stock_Price:  102.8332020387944
curr_Factors:  [102.83320204]
mat_Sqrt:  [[0.15]]
grads:  [0.05958881]
Stock Position:  0.05958880687501401
Bond Position:  [9.24456603]


portfolio before change:  [15.38981919]
curr_Stock_Price:  103.10824869716242
curr_Factors:  [103.1082487]
mat_Sqrt:  [[0.15]]
grads:  [0.06582791]
Stock Position:  0.06582790830306126
Bond Position:  [8.60241885]


portfolio before change:  [15.46963366]
curr_Stock_Price:  104.30438415180123
curr_Factors:  [104.30438415]
mat_Sqrt:  [[0.15]]
grads:  [0.07987348]
Stock Position:  0.07987348072475492
Bond Position:  [7.13847944]


portfolio before change:  [15.40704933]
curr_Stock_Price:  103.50966868233903
curr_Factors:  [103.50966868]
mat_Sqrt:  [[0.15]]
grads:  [-0.10473801]
Stock Position:  -0.10473801024540155
Bond Position:  [26.24844607]


portfolio before change:  [15.41802521]
curr_Stock_Price:  103.43620325337935
curr_Factors:  [103.43620325]
mat_Sqrt:  [[0.15]]
grads:  [0.01833486]
Stock Position:  0.01833486229722461
Bond Position:  [13.52153667]


portfolio before change:  [15.43943364]
curr_Stock_Price:  104.51164761984218
curr_Factors:  [104.51164762]
mat_Sqrt:  [[0.15]]
grads:  [0.23671354]
Stock Position:  0.23671353530594325
Bond Position:  [-9.29988795]


portfolio before change:  [15.35673917]
curr_Stock_Price:  104.16721478916106
curr_Factors:  [104.16721479]
mat_Sqrt:  [[0.15]]
grads:  [-0.16243929]
Stock Position:  -0.16243928922530712
Bond Position:  [32.2775875]


portfolio before change:  [15.37120282]
curr_Stock_Price:  104.10301418503208
curr_Factors:  [104.10301419]
mat_Sqrt:  [[0.15]]
grads:  [0.05231339]
Stock Position:  0.052313387235810006
Bond Position:  [9.92522152]


portfolio before change:  [15.34219945]
curr_Stock_Price:  103.52488125238963
curr_Factors:  [103.52488125]
mat_Sqrt:  [[0.15]]
grads:  [0.03195868]
Stock Position:  0.03195868219733083
Bond Position:  [12.03368067]


portfolio before change:  [15.37003238]
curr_Stock_Price:  104.34871449576839
curr_Factors:  [104.3487145]
mat_Sqrt:  [[0.15]]
grads:  [-0.09298121]
Stock Position:  -0.09298121021353375
Bond Position:  [25.07250214]


portfolio before change:  [15.38271249]
curr_Stock_Price:  104.24605028015439
curr_Factors:  [104.24605028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00355992]
Stock Position:  -0.0035599173670204324
Bond Position:  [15.75381981]


portfolio before change:  [15.386359]
curr_Stock_Price:  103.77492640883267
curr_Factors:  [103.77492641]
mat_Sqrt:  [[0.15]]
grads:  [-0.07144615]
Stock Position:  -0.07144615431150551
Bond Position:  [22.8006784]


portfolio before change:  [15.45176364]
curr_Stock_Price:  102.899380572496
curr_Factors:  [102.89938057]
mat_Sqrt:  [[0.15]]
grads:  [0.27904157]
Stock Position:  0.2790415699016933
Bond Position:  [-13.26144105]


portfolio before change:  [15.50407058]
curr_Stock_Price:  103.09277367804201
curr_Factors:  [103.09277368]
mat_Sqrt:  [[0.15]]
grads:  [-0.05848676]
Stock Position:  -0.058486758655105636
Bond Position:  [21.53363275]


portfolio before change:  [15.53951469]
curr_Stock_Price:  102.53277957321329
curr_Factors:  [102.53277957]
mat_Sqrt:  [[0.15]]
grads:  [-0.00244596]
Stock Position:  -0.002445964144676642
Bond Position:  [15.79030619]


portfolio before change:  [15.54100447]
curr_Stock_Price:  102.73070825143499
curr_Factors:  [102.73070825]
mat_Sqrt:  [[0.15]]
grads:  [0.03333549]
Stock Position:  0.033335488383688924
Bond Position:  [12.11642614]


portfolio before change:  [15.5454782]
curr_Stock_Price:  102.81947480213962
curr_Factors:  [102.8194748]
mat_Sqrt:  [[0.15]]
grads:  [0.03471052]
Stock Position:  0.0347105199933197
Bond Position:  [11.97656076]


portfolio before change:  [15.56178609]
curr_Stock_Price:  103.24616748287185
curr_Factors:  [103.24616748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02860122]
Stock Position:  -0.028601221340290747
Bond Position:  [18.51475257]


portfolio before change:  [15.57729453]
curr_Stock_Price:  102.78486006587488
curr_Factors:  [102.78486007]
mat_Sqrt:  [[0.15]]
grads:  [0.08845121]
Stock Position:  0.0884512073267228
Bond Position:  [6.48584956]


portfolio before change:  [15.58913434]
curr_Stock_Price:  102.90955059722441
curr_Factors:  [102.9095506]
mat_Sqrt:  [[0.15]]
grads:  [0.0353367]
Stock Position:  0.03533669827002262
Bond Position:  [11.9526506]


portfolio before change:  [15.56316381]
curr_Stock_Price:  102.13232152756005
curr_Factors:  [102.13232153]
mat_Sqrt:  [[0.15]]
grads:  [-0.0082539]
Stock Position:  -0.008253904678157752
Bond Position:  [16.40615425]


portfolio before change:  [15.57228715]
curr_Stock_Price:  101.2754602406942
curr_Factors:  [101.27546024]
mat_Sqrt:  [[0.15]]
grads:  [0.05243692]
Stock Position:  0.05243691777377279
Bond Position:  [10.26171417]


portfolio before change:  [15.59934079]
curr_Stock_Price:  101.76692385081365
curr_Factors:  [101.76692385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.59934079]
Stock Price:  102.32131896552542
PL:  [13.27802182]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 8.86082136e-03]
 [ 2.80793281e-03]
 [ 1.49880657e-02]
 [ 5.72483029e-03]
 [ 1.50797272e-02]
 [ 2.61307884e-02]
 [-4.87396982e-03]
 [ 2.34870034e-02]
 [-6.18649718e-03]
 [-2.61679117e-04]
 [ 1.94104417e-03]
 [ 5.48259894e-03]
 [ 1.38139999e-02]
 [ 2.79321245e-03]
 [ 9.79711247e-03]
 [-2.52626026e-03]
 [ 1.10150937e-02]
 [-9.09286079e-06]
 [ 1.11580302e-02]
 [-1.24237094e-02]
 [-1.72998140e-04]
 [ 8.67627600e-03]
 [ 1.25235456e-02]
 [ 6.02655599e-03]
 [ 1.21404577e-02]
 [-1.00287841e-02]
 [ 8.73535952e-03]
 [-1.08603497e-02]
 [-1.78482192e-02]
 [-4.85678656e-03]
 [-3.62870788e-03]
 [ 5.49097899e-03]
 [ 5.12843617e-03]
 [-1.19150141e-02]
 [ 9.75086509e-03]
 [ 5.71233695e-03]
 [ 3.61439434e-03]
 [ 1.17291141e-02]
 [-2.77321214e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.08942621]
curr_Stock_Price:  101.3635483667704
curr_Factors:  [101.36354837]
mat_Sqrt:  [[0.15]]
grads:  [0.05907214]
Stock Position:  0.05907214243164343
Bond Position:  [17.10166424]


portfolio before change:  [23.05811445]
curr_Stock_Price:  100.79729840774357
curr_Factors:  [100.79729841]
mat_Sqrt:  [[0.15]]
grads:  [0.01871955]
Stock Position:  0.018719552078255257
Bond Position:  [21.17123418]


portfolio before change:  [23.07708119]
curr_Stock_Price:  101.66912282563652
curr_Factors:  [101.66912283]
mat_Sqrt:  [[0.15]]
grads:  [0.09992044]
Stock Position:  0.09992043815700369
Bond Position:  [12.91825789]


portfolio before change:  [23.0878166]
curr_Stock_Price:  101.76040075210292
curr_Factors:  [101.76040075]
mat_Sqrt:  [[0.15]]
grads:  [0.03816554]
Stock Position:  0.03816553524243797
Bond Position:  [19.20407644]


portfolio before change:  [23.05619648]
curr_Stock_Price:  100.8690001698189
curr_Factors:  [100.86900017]
mat_Sqrt:  [[0.15]]
grads:  [0.10053151]
Stock Position:  0.10053151462476423
Bond Position:  [12.91568311]


portfolio before change:  [23.06022762]
curr_Stock_Price:  100.89303822012457
curr_Factors:  [100.89303822]
mat_Sqrt:  [[0.15]]
grads:  [0.17420526]
Stock Position:  0.1742052563099691
Bond Position:  [5.48413004]


portfolio before change:  [22.87158474]
curr_Stock_Price:  99.80622577233405
curr_Factors:  [99.80622577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03249313]
Stock Position:  -0.032493132137607364
Bond Position:  [26.11460162]


portfolio before change:  [22.88739804]
curr_Stock_Price:  99.4200281065304
curr_Factors:  [99.42002811]
mat_Sqrt:  [[0.15]]
grads:  [0.15658002]
Stock Position:  0.15658002258434603
Bond Position:  [7.3202078]


portfolio before change:  [22.5961562]
curr_Stock_Price:  97.55416475636741
curr_Factors:  [97.55416476]
mat_Sqrt:  [[0.15]]
grads:  [-0.04124331]
Stock Position:  -0.04124331450648247
Bond Position:  [26.6196133]


portfolio before change:  [22.58083873]
curr_Stock_Price:  98.00624124301736
curr_Factors:  [98.00624124]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174453]
Stock Position:  -0.0017445274476727418
Bond Position:  [22.7518133]


portfolio before change:  [22.58197605]
curr_Stock_Price:  98.9846306554457
curr_Factors:  [98.98463066]
mat_Sqrt:  [[0.15]]
grads:  [0.01294029]
Stock Position:  0.012940294445342743
Bond Position:  [21.30108579]


portfolio before change:  [22.58957489]
curr_Stock_Price:  99.3660775783831
curr_Factors:  [99.36607758]
mat_Sqrt:  [[0.15]]
grads:  [0.03655066]
Stock Position:  0.03655065961567858
Bond Position:  [18.95767921]


portfolio before change:  [22.57895036]
curr_Stock_Price:  99.01056049444907
curr_Factors:  [99.01056049]
mat_Sqrt:  [[0.15]]
grads:  [0.09209333]
Stock Position:  0.09209333286881617
Bond Position:  [13.46073786]


portfolio before change:  [22.53972257]
curr_Stock_Price:  98.56633190137352
curr_Factors:  [98.5663319]
mat_Sqrt:  [[0.15]]
grads:  [0.01862142]
Stock Position:  0.01862141634918282
Bond Position:  [20.70427787]


portfolio before change:  [22.55201049]
curr_Stock_Price:  99.08722251026946
curr_Factors:  [99.08722251]
mat_Sqrt:  [[0.15]]
grads:  [0.06531408]
Stock Position:  0.06531408315533584
Bond Position:  [16.0802194]


portfolio before change:  [22.58345998]
curr_Stock_Price:  99.53795741325294
curr_Factors:  [99.53795741]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684174]
Stock Position:  -0.016841735089280677
Bond Position:  [24.25985189]


portfolio before change:  [22.5895481]
curr_Stock_Price:  99.35653607264881
curr_Factors:  [99.35653607]
mat_Sqrt:  [[0.15]]
grads:  [0.07343396]
Stock Position:  0.07343395820636203
Bond Position:  [15.29340438]


portfolio before change:  [22.57949069]
curr_Stock_Price:  99.19354333271619
curr_Factors:  [99.19354333]
mat_Sqrt:  [[0.15]]
grads:  [-6.06190719e-05]
Stock Position:  -6.0619071912450716e-05
Bond Position:  [22.58550371]


portfolio before change:  [22.58229926]
curr_Stock_Price:  99.4377120969727
curr_Factors:  [99.4377121]
mat_Sqrt:  [[0.15]]
grads:  [0.07438687]
Stock Position:  0.07438686830935329
Bond Position:  [15.18543926]


portfolio before change:  [22.60738378]
curr_Stock_Price:  99.74940987850603
curr_Factors:  [99.74940988]
mat_Sqrt:  [[0.15]]
grads:  [-0.08282473]
Stock Position:  -0.0828247292598221
Bond Position:  [30.86910164]


portfolio before change:  [22.62100282]
curr_Stock_Price:  99.63156863850959
curr_Factors:  [99.63156864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00115332]
Stock Position:  -0.0011533209323363418
Bond Position:  [22.73591]


portfolio before change:  [22.62423962]
curr_Stock_Price:  99.28940267166242
curr_Factors:  [99.28940267]
mat_Sqrt:  [[0.15]]
grads:  [0.05784184]
Stock Position:  0.057841839976142916
Bond Position:  [16.88115788]


portfolio before change:  [22.65364882]
curr_Stock_Price:  99.76136078355783
curr_Factors:  [99.76136078]
mat_Sqrt:  [[0.15]]
grads:  [0.0834903]
Stock Position:  0.08349030394182604
Bond Position:  [14.32454249]


portfolio before change:  [22.70553434]
curr_Stock_Price:  100.36136872782873
curr_Factors:  [100.36136873]
mat_Sqrt:  [[0.15]]
grads:  [0.04017704]
Stock Position:  0.04017703990062346
Bond Position:  [18.67331163]


portfolio before change:  [22.64242732]
curr_Stock_Price:  98.7325445145938
curr_Factors:  [98.73254451]
mat_Sqrt:  [[0.15]]
grads:  [0.08093638]
Stock Position:  0.08093638497029454
Bond Position:  [14.65137209]


portfolio before change:  [22.72404483]
curr_Stock_Price:  99.71833071748192
curr_Factors:  [99.71833072]
mat_Sqrt:  [[0.15]]
grads:  [-0.06685856]
Stock Position:  -0.06685856086584085
Bond Position:  [29.39106891]


portfolio before change:  [22.73838328]
curr_Stock_Price:  99.55882473624791
curr_Factors:  [99.55882474]
mat_Sqrt:  [[0.15]]
grads:  [0.05823573]
Stock Position:  0.05823573011655269
Bond Position:  [16.94050243]


portfolio before change:  [22.75317741]
curr_Stock_Price:  99.77649920774583
curr_Factors:  [99.77649921]
mat_Sqrt:  [[0.15]]
grads:  [-0.07240233]
Stock Position:  -0.07240233126935991
Bond Position:  [29.97722856]


portfolio before change:  [22.75844038]
curr_Stock_Price:  99.75556640380542
curr_Factors:  [99.7555664]
mat_Sqrt:  [[0.15]]
grads:  [-0.11898813]
Stock Position:  -0.11898812783360004
Bond Position:  [34.62816847]


portfolio before change:  [22.79071083]
curr_Stock_Price:  99.5207390999694
curr_Factors:  [99.5207391]
mat_Sqrt:  [[0.15]]
grads:  [-0.03237858]
Stock Position:  -0.03237857707793019
Bond Position:  [26.01305075]


portfolio before change:  [22.82790783]
curr_Stock_Price:  98.47235562238892
curr_Factors:  [98.47235562]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419139]
Stock Position:  -0.024191385858319238
Bond Position:  [25.21009058]


portfolio before change:  [22.80266162]
curr_Stock_Price:  99.6462309090268
curr_Factors:  [99.64623091]
mat_Sqrt:  [[0.15]]
grads:  [0.03660653]
Stock Position:  0.03660652658888364
Bond Position:  [19.15495922]


portfolio before change:  [22.86767002]
curr_Stock_Price:  101.3566878043754
curr_Factors:  [101.3566878]
mat_Sqrt:  [[0.15]]
grads:  [0.03418957]
Stock Position:  0.034189574487868406
Bond Position:  [19.402328]


portfolio before change:  [22.80199823]
curr_Stock_Price:  99.3649334809898
curr_Factors:  [99.36493348]
mat_Sqrt:  [[0.15]]
grads:  [-0.07943343]
Stock Position:  -0.07943342742719005
Bond Position:  [30.69489547]


portfolio before change:  [22.84387058]
curr_Stock_Price:  98.88610178265795
curr_Factors:  [98.88610178]
mat_Sqrt:  [[0.15]]
grads:  [0.06500577]
Stock Position:  0.06500576729683959
Bond Position:  [16.41570366]


portfolio before change:  [22.78861615]
curr_Stock_Price:  98.0045412853746
curr_Factors:  [98.00454129]
mat_Sqrt:  [[0.15]]
grads:  [0.03808225]
Stock Position:  0.038082246355417765
Bond Position:  [19.05638307]


portfolio before change:  [22.75754427]
curr_Stock_Price:  97.12607209164197
curr_Factors:  [97.12607209]
mat_Sqrt:  [[0.15]]
grads:  [0.02409596]
Stock Position:  0.024095962270259102
Bond Position:  [20.4171981]


portfolio before change:  [22.76249276]
curr_Stock_Price:  97.22551525099261
curr_Factors:  [97.22551525]
mat_Sqrt:  [[0.15]]
grads:  [0.07819409]
Stock Position:  0.07819409395182426
Bond Position:  [15.16003168]


portfolio before change:  [22.73888073]
curr_Stock_Price:  96.89931222614285
curr_Factors:  [96.89931223]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.73888073]
Stock Price:  97.17870457236504
PL:  [22.73888073]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 4.00955252e-03]
 [-2.02118539e-03]
 [ 1.48848190e-02]
 [ 1.85060814e-03]
 [ 1.46726756e-02]
 [ 2.56420221e-02]
 [ 4.93511041e-03]
 [ 1.70682897e-02]
 [-8.20380133e-03]
 [-2.38187913e-03]
 [ 9.80742287e-03]
 [ 4.90650929e-03]
 [ 9.12413703e-03]
 [-4.56793602e-03]
 [ 1.04293797e-02]
 [ 2.42756728e-03]
 [ 9.63667868e-03]
 [ 1.40596313e-02]
 [ 1.15665974e-02]
 [-1.16074616e-02]
 [-1.58292582e-02]
 [ 1.77654691e-02]
 [-6.19963570e-03]
 [ 5.17424359e-03]
 [-5.30304085e-03]
 [-6.40306108e-03]
 [-1.06728889e-03]
 [-1.09434514e-02]
 [ 3.87753198e-02]
 [-1.07114445e-02]
 [-6.73590850e-06]
 [ 5.15622288e-03]
 [ 5.12743024e-03]
 [-8.64779898e-03]
 [ 2.17124756e-02]
 [ 5.48024101e-03]
 [ 2.34980207e-03]
 [ 9.02931170e-03]
 [-3.41018978e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.38334134]
curr_Stock_Price:  100.0278118944246
curr_Factors:  [100.02781189]
mat_Sqrt:  [[0.15]]
grads:  [0.02673035]
Stock Position:  0.02673035013567951
Bond Position:  [-0.2904371]


portfolio before change:  [2.4230239]
curr_Stock_Price:  101.51372107469115
curr_Factors:  [101.51372107]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347457]
Stock Position:  -0.0134745692362809
Bond Position:  [3.79087757]


portfolio before change:  [2.42062053]
curr_Stock_Price:  101.72725384302474
curr_Factors:  [101.72725384]
mat_Sqrt:  [[0.15]]
grads:  [0.09923213]
Stock Position:  0.09923212673647591
Bond Position:  [-7.67399121]


portfolio before change:  [2.3787009]
curr_Stock_Price:  101.31448107423826
curr_Factors:  [101.31448107]
mat_Sqrt:  [[0.15]]
grads:  [0.01233739]
Stock Position:  0.0123373875688904
Bond Position:  [1.12874488]


portfolio before change:  [2.377849]
curr_Stock_Price:  101.2339939367344
curr_Factors:  [101.23399394]
mat_Sqrt:  [[0.15]]
grads:  [0.09781784]
Stock Position:  0.0978178370897125
Bond Position:  [-7.52464132]


portfolio before change:  [2.32030425]
curr_Stock_Price:  100.65532533334788
curr_Factors:  [100.65532533]
mat_Sqrt:  [[0.15]]
grads:  [0.17094681]
Stock Position:  0.17094681401000508
Bond Position:  [-14.88640293]


portfolio before change:  [2.49887627]
curr_Stock_Price:  101.71081698282634
curr_Factors:  [101.71081698]
mat_Sqrt:  [[0.15]]
grads:  [0.03290074]
Stock Position:  0.03290073609332297
Bond Position:  [-0.84748448]


portfolio before change:  [2.4677606]
curr_Stock_Price:  100.76829312652781
curr_Factors:  [100.76829313]
mat_Sqrt:  [[0.15]]
grads:  [0.1137886]
Stock Position:  0.11378859817374345
Bond Position:  [-8.99852221]


portfolio before change:  [2.57397892]
curr_Stock_Price:  101.71164951977013
curr_Factors:  [101.71164952]
mat_Sqrt:  [[0.15]]
grads:  [-0.05469201]
Stock Position:  -0.054692008838307896
Bond Position:  [8.13679335]


portfolio before change:  [2.58054084]
curr_Stock_Price:  101.61026804729694
curr_Factors:  [101.61026805]
mat_Sqrt:  [[0.15]]
grads:  [-0.01587919]
Stock Position:  -0.01587919418870276
Bond Position:  [4.19403001]


portfolio before change:  [2.58213689]
curr_Stock_Price:  101.54277287642006
curr_Factors:  [101.54277288]
mat_Sqrt:  [[0.15]]
grads:  [0.06538282]
Stock Position:  0.06538281912262205
Bond Position:  [-4.05701586]


portfolio before change:  [2.57747387]
curr_Stock_Price:  101.47921085209646
curr_Factors:  [101.47921085]
mat_Sqrt:  [[0.15]]
grads:  [0.03271006]
Stock Position:  0.032710061918702134
Bond Position:  [-0.7419174]


portfolio before change:  [2.58784163]
curr_Stock_Price:  101.79900558839878
curr_Factors:  [101.79900559]
mat_Sqrt:  [[0.15]]
grads:  [0.06082758]
Stock Position:  0.060827580194483026
Bond Position:  [-3.60434555]


portfolio before change:  [2.65708786]
curr_Stock_Price:  102.94481477025316
curr_Factors:  [102.94481477]
mat_Sqrt:  [[0.15]]
grads:  [-0.03045291]
Stock Position:  -0.03045290680378408
Bond Position:  [5.79205671]


portfolio before change:  [2.66567797]
curr_Stock_Price:  102.68651226312438
curr_Factors:  [102.68651226]
mat_Sqrt:  [[0.15]]
grads:  [0.0695292]
Stock Position:  0.0695291981542037
Bond Position:  [-4.47403289]


portfolio before change:  [2.64824333]
curr_Stock_Price:  102.44380338070435
curr_Factors:  [102.44380338]
mat_Sqrt:  [[0.15]]
grads:  [0.01618378]
Stock Position:  0.016183781894814467
Bond Position:  [0.99031516]


portfolio before change:  [2.62817552]
curr_Stock_Price:  101.1961587045128
curr_Factors:  [101.1961587]
mat_Sqrt:  [[0.15]]
grads:  [0.06424452]
Stock Position:  0.06424452455022722
Bond Position:  [-3.87312359]


portfolio before change:  [2.6247735]
curr_Stock_Price:  101.15074093947096
curr_Factors:  [101.15074094]
mat_Sqrt:  [[0.15]]
grads:  [0.09373088]
Stock Position:  0.09373087562710454
Bond Position:  [-6.85617402]


portfolio before change:  [2.52386728]
curr_Stock_Price:  100.0833323363759
curr_Factors:  [100.08333234]
mat_Sqrt:  [[0.15]]
grads:  [0.07711065]
Stock Position:  0.07711064904498771
Bond Position:  [-5.19362343]


portfolio before change:  [2.46546817]
curr_Stock_Price:  99.3344102176776
curr_Factors:  [99.33441022]
mat_Sqrt:  [[0.15]]
grads:  [-0.07738308]
Stock Position:  -0.07738307730684102
Bond Position:  [10.15227052]


portfolio before change:  [2.37370447]
curr_Stock_Price:  100.53664745970028
curr_Factors:  [100.53664746]
mat_Sqrt:  [[0.15]]
grads:  [-0.10552839]
Stock Position:  -0.1055283878449702
Bond Position:  [12.98317479]


portfolio before change:  [2.36347331]
curr_Stock_Price:  100.64897888346218
curr_Factors:  [100.64897888]
mat_Sqrt:  [[0.15]]
grads:  [0.11843646]
Stock Position:  0.11843646099170718
Bond Position:  [-9.55703555]


portfolio before change:  [2.35443471]
curr_Stock_Price:  100.5827501504129
curr_Factors:  [100.58275015]
mat_Sqrt:  [[0.15]]
grads:  [-0.0413309]
Stock Position:  -0.04133090467296964
Bond Position:  [6.51161077]


portfolio before change:  [2.40435529]
curr_Stock_Price:  99.39461808075231
curr_Factors:  [99.39461808]
mat_Sqrt:  [[0.15]]
grads:  [0.03449496]
Stock Position:  0.03449495729952018
Bond Position:  [-1.02425782]


portfolio before change:  [2.44414152]
curr_Stock_Price:  100.55172282744275
curr_Factors:  [100.55172283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03535361]
Stock Position:  -0.03535360567419111
Bond Position:  [5.99900748]


portfolio before change:  [2.39458177]
curr_Stock_Price:  101.97476526215951
curr_Factors:  [101.97476526]
mat_Sqrt:  [[0.15]]
grads:  [-0.04268707]
Stock Position:  -0.042687073891288785
Bond Position:  [6.74758611]


portfolio before change:  [2.38639985]
curr_Stock_Price:  102.1861974518073
curr_Factors:  [102.18619745]
mat_Sqrt:  [[0.15]]
grads:  [-0.00711526]
Stock Position:  -0.007115259260550897
Bond Position:  [3.11348113]


portfolio before change:  [2.3837902]
curr_Stock_Price:  102.6076655314192
curr_Factors:  [102.60766553]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295634]
Stock Position:  -0.07295634289200754
Bond Position:  [9.86967023]


portfolio before change:  [2.37499966]
curr_Stock_Price:  102.74506729517333
curr_Factors:  [102.7450673]
mat_Sqrt:  [[0.15]]
grads:  [0.25850213]
Stock Position:  0.25850213213614326
Bond Position:  [-24.18481931]


portfolio before change:  [2.21886288]
curr_Stock_Price:  102.15275696904929
curr_Factors:  [102.15275697]
mat_Sqrt:  [[0.15]]
grads:  [-0.07140963]
Stock Position:  -0.07140963013422798
Bond Position:  [9.51355347]


portfolio before change:  [2.23285417]
curr_Stock_Price:  101.9734811736891
curr_Factors:  [101.97348117]
mat_Sqrt:  [[0.15]]
grads:  [-4.49060567e-05]
Stock Position:  -4.490605669661277e-05
Bond Position:  [2.2374334]


portfolio before change:  [2.23314485]
curr_Stock_Price:  101.72894007308489
curr_Factors:  [101.72894007]
mat_Sqrt:  [[0.15]]
grads:  [0.03437482]
Stock Position:  0.03437481917832755
Bond Position:  [-1.26376907]


portfolio before change:  [2.22548913]
curr_Stock_Price:  101.5108229361573
curr_Factors:  [101.51082294]
mat_Sqrt:  [[0.15]]
grads:  [0.03418287]
Stock Position:  0.034182868265117405
Bond Position:  [-1.24444196]


portfolio before change:  [2.2157921]
curr_Stock_Price:  101.23169294670667
curr_Factors:  [101.23169295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05765199]
Stock Position:  -0.057651993227882475
Bond Position:  [8.05200098]


portfolio before change:  [2.22129937]
curr_Stock_Price:  101.1536261201386
curr_Factors:  [101.15362612]
mat_Sqrt:  [[0.15]]
grads:  [0.14474984]
Stock Position:  0.14474983711710582
Bond Position:  [-12.42067153]


portfolio before change:  [2.19375752]
curr_Stock_Price:  100.97408071394368
curr_Factors:  [100.97408071]
mat_Sqrt:  [[0.15]]
grads:  [0.03653494]
Stock Position:  0.036534940071969786
Bond Position:  [-1.49532447]


portfolio before change:  [2.15965468]
curr_Stock_Price:  100.0457661953872
curr_Factors:  [100.0457662]
mat_Sqrt:  [[0.15]]
grads:  [0.01566535]
Stock Position:  0.015665347142887576
Bond Position:  [0.59240302]


portfolio before change:  [2.15003282]
curr_Stock_Price:  99.42682563299246
curr_Factors:  [99.42682563]
mat_Sqrt:  [[0.15]]
grads:  [0.06019541]
Stock Position:  0.06019541132214954
Bond Position:  [-3.83500585]


portfolio before change:  [2.16113283]
curr_Stock_Price:  99.61918945274175
curr_Factors:  [99.61918945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.16113283]
Stock Price:  99.5942952776988
PL:  [2.16113283]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.33833701e-03]
 [ 1.17560825e-03]
 [ 1.47584295e-02]
 [-1.97783797e-03]
 [ 1.47664274e-02]
 [ 1.26726418e-02]
 [-1.67328568e-03]
 [ 1.59601861e-02]
 [-7.31129853e-03]
 [-1.66599842e-05]
 [ 1.08402056e-02]
 [ 4.07386282e-03]
 [ 8.60695675e-03]
 [-3.88211196e-03]
 [ 1.89566045e-02]
 [ 1.81187091e-03]
 [ 8.74677851e-03]
 [ 1.28814498e-02]
 [ 1.16081702e-02]
 [-1.42804901e-02]
 [-1.11713553e-02]
 [ 2.30405939e-02]
 [-3.09223984e-02]
 [ 5.29987997e-03]
 [-1.20075437e-03]
 [-1.17586695e-02]
 [-7.33498325e-04]
 [-1.10215327e-02]
 [ 2.00244155e-02]
 [-1.05426617e-02]
 [-1.12237534e-03]
 [ 5.27316498e-03]
 [ 5.11740583e-03]
 [-1.17190472e-02]
 [ 1.61473358e-02]
 [ 5.46523689e-03]
 [ 2.37124459e-03]
 [ 7.83432212e-03]
 [-2.93777655e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.01401857]
curr_Stock_Price:  99.67963161172962
curr_Factors:  [99.67963161]
mat_Sqrt:  [[0.15]]
grads:  [0.02225558]
Stock Position:  0.02225558004938543
Bond Position:  [-5.23244659]


portfolio before change:  [-3.01481904]
curr_Stock_Price:  99.6730547533182
curr_Factors:  [99.67305475]
mat_Sqrt:  [[0.15]]
grads:  [0.00783739]
Stock Position:  0.007837388337218709
Bond Position:  [-3.79599548]


portfolio before change:  [-3.00304254]
curr_Stock_Price:  101.2362071071702
curr_Factors:  [101.23620711]
mat_Sqrt:  [[0.15]]
grads:  [0.09838953]
Stock Position:  0.0983895302119717
Bond Position:  [-12.96362539]


portfolio before change:  [-3.05229759]
curr_Stock_Price:  100.75206517739586
curr_Factors:  [100.75206518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01318559]
Stock Position:  -0.013185586442014651
Bond Position:  [-1.72382252]


portfolio before change:  [-3.05780682]
curr_Stock_Price:  101.15354494490138
curr_Factors:  [101.15354494]
mat_Sqrt:  [[0.15]]
grads:  [0.09844285]
Stock Position:  0.09844284954612101
Bond Position:  [-13.01565003]


portfolio before change:  [-3.18557194]
curr_Stock_Price:  99.87221213163713
curr_Factors:  [99.87221213]
mat_Sqrt:  [[0.15]]
grads:  [0.08448428]
Stock Position:  0.0844842785949414
Bond Position:  [-11.62320373]


portfolio before change:  [-3.11070409]
curr_Stock_Price:  100.77558538241634
curr_Factors:  [100.77558538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01115524]
Stock Position:  -0.011155237852923158
Bond Position:  [-1.98652846]


portfolio before change:  [-3.11237175]
curr_Stock_Price:  100.90281942400597
curr_Factors:  [100.90281942]
mat_Sqrt:  [[0.15]]
grads:  [0.10640124]
Stock Position:  0.10640124062163642
Bond Position:  [-13.84855692]


portfolio before change:  [-3.08263896]
curr_Stock_Price:  101.19852995444349
curr_Factors:  [101.19852995]
mat_Sqrt:  [[0.15]]
grads:  [-0.04874199]
Stock Position:  -0.04874199017106339
Bond Position:  [1.84997879]


portfolio before change:  [-3.06092603]
curr_Stock_Price:  100.75780803178291
curr_Factors:  [100.75780803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00011107]
Stock Position:  -0.00011106656156892442
Bond Position:  [-3.04973521]


portfolio before change:  [-3.06130585]
curr_Stock_Price:  100.74500495538815
curr_Factors:  [100.74500496]
mat_Sqrt:  [[0.15]]
grads:  [0.07226804]
Stock Position:  0.07226803730851507
Bond Position:  [-10.34194963]


portfolio before change:  [-3.10619378]
curr_Stock_Price:  100.14176311209525
curr_Factors:  [100.14176311]
mat_Sqrt:  [[0.15]]
grads:  [0.02715909]
Stock Position:  0.02715908544290316
Bond Position:  [-5.82595248]


portfolio before change:  [-3.05732305]
curr_Stock_Price:  101.96800358358304
curr_Factors:  [101.96800358]
mat_Sqrt:  [[0.15]]
grads:  [0.05737971]
Stock Position:  0.05737971164840273
Bond Position:  [-8.90821769]


portfolio before change:  [-3.09982346]
curr_Stock_Price:  101.24672391840316
curr_Factors:  [101.24672392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02588075]
Stock Position:  -0.025880746379592673
Bond Position:  [-0.47948268]


portfolio before change:  [-3.11449599]
curr_Stock_Price:  101.81133606883928
curr_Factors:  [101.81133607]
mat_Sqrt:  [[0.15]]
grads:  [0.12637736]
Stock Position:  0.12637736334969465
Bond Position:  [-15.9811442]


portfolio before change:  [-3.15852105]
curr_Stock_Price:  101.47878205410504
curr_Factors:  [101.47878205]
mat_Sqrt:  [[0.15]]
grads:  [0.01207914]
Stock Position:  0.012079139415479598
Bond Position:  [-4.38429741]


portfolio before change:  [-3.15148696]
curr_Stock_Price:  102.10648986724175
curr_Factors:  [102.10648987]
mat_Sqrt:  [[0.15]]
grads:  [0.05831186]
Stock Position:  0.05831185672673443
Bond Position:  [-9.10550596]


portfolio before change:  [-3.17607238]
curr_Stock_Price:  101.70439035185987
curr_Factors:  [101.70439035]
mat_Sqrt:  [[0.15]]
grads:  [0.08587633]
Stock Position:  0.08587633168222877
Bond Position:  [-11.91007234]


portfolio before change:  [-3.17333671]
curr_Stock_Price:  101.75358351797142
curr_Factors:  [101.75358352]
mat_Sqrt:  [[0.15]]
grads:  [0.0773878]
Stock Position:  0.07738780150286917
Bond Position:  [-11.04782283]


portfolio before change:  [-3.13607573]
curr_Stock_Price:  102.25291343675421
curr_Factors:  [102.25291344]
mat_Sqrt:  [[0.15]]
grads:  [-0.09520327]
Stock Position:  -0.0952032670229707
Bond Position:  [6.59873569]


portfolio before change:  [-3.08863136]
curr_Stock_Price:  101.76322991223657
curr_Factors:  [101.76322991]
mat_Sqrt:  [[0.15]]
grads:  [-0.0744757]
Stock Position:  -0.07447570205291006
Bond Position:  [4.49025663]


portfolio before change:  [-3.11926462]
curr_Stock_Price:  102.18208557733051
curr_Factors:  [102.18208558]
mat_Sqrt:  [[0.15]]
grads:  [0.15360396]
Stock Position:  0.1536039591260174
Bond Position:  [-18.81483751]


portfolio before change:  [-3.13779047]
curr_Stock_Price:  102.0767897748578
curr_Factors:  [102.07678977]
mat_Sqrt:  [[0.15]]
grads:  [-0.20614932]
Stock Position:  -0.2061493225463016
Bond Position:  [17.90527059]


portfolio before change:  [-3.19626107]
curr_Stock_Price:  102.3712797293978
curr_Factors:  [102.37127973]
mat_Sqrt:  [[0.15]]
grads:  [0.03533253]
Stock Position:  0.03533253310076382
Bond Position:  [-6.8132977]


portfolio before change:  [-3.18614353]
curr_Stock_Price:  102.68173758567269
curr_Factors:  [102.68173759]
mat_Sqrt:  [[0.15]]
grads:  [-0.00800503]
Stock Position:  -0.008005029142171261
Bond Position:  [-2.36417323]


portfolio before change:  [-3.19550376]
curr_Stock_Price:  103.81411230861536
curr_Factors:  [103.81411231]
mat_Sqrt:  [[0.15]]
grads:  [-0.07839113]
Stock Position:  -0.0783911300974499
Bond Position:  [4.94260182]


portfolio before change:  [-3.18615058]
curr_Stock_Price:  103.70267979065173
curr_Factors:  [103.70267979]
mat_Sqrt:  [[0.15]]
grads:  [-0.00488999]
Stock Position:  -0.004889988835796655
Bond Position:  [-2.67904563]


portfolio before change:  [-3.18035457]
curr_Stock_Price:  102.44891327569962
curr_Factors:  [102.44891328]
mat_Sqrt:  [[0.15]]
grads:  [-0.07347688]
Stock Position:  -0.0734768849235778
Bond Position:  [4.34727244]


portfolio before change:  [-3.15522739]
curr_Stock_Price:  102.11433540333697
curr_Factors:  [102.1143354]
mat_Sqrt:  [[0.15]]
grads:  [0.1334961]
Stock Position:  0.13349610336867238
Bond Position:  [-16.78709326]


portfolio before change:  [-3.13978684]
curr_Stock_Price:  102.24571799849801
curr_Factors:  [102.245718]
mat_Sqrt:  [[0.15]]
grads:  [-0.07028441]
Stock Position:  -0.07028441122334832
Bond Position:  [4.04649325]


portfolio before change:  [-3.06827374]
curr_Stock_Price:  101.23543331467405
curr_Factors:  [101.23543331]
mat_Sqrt:  [[0.15]]
grads:  [-0.0074825]
Stock Position:  -0.007482502281427648
Bond Position:  [-2.31077938]


portfolio before change:  [-3.06415565]
curr_Stock_Price:  100.64646546738162
curr_Factors:  [100.64646547]
mat_Sqrt:  [[0.15]]
grads:  [0.03515443]
Stock Position:  0.03515443321045098
Bond Position:  [-6.6023251]


portfolio before change:  [-3.06421797]
curr_Stock_Price:  100.6681704077319
curr_Factors:  [100.66817041]
mat_Sqrt:  [[0.15]]
grads:  [0.03411604]
Stock Position:  0.0341160388850223
Bond Position:  [-6.49861718]


portfolio before change:  [-3.09128758]
curr_Stock_Price:  99.89852546745637
curr_Factors:  [99.89852547]
mat_Sqrt:  [[0.15]]
grads:  [-0.07812698]
Stock Position:  -0.07812698124447534
Bond Position:  [4.71348265]


portfolio before change:  [-3.07352047]
curr_Stock_Price:  99.67865408847763
curr_Factors:  [99.67865409]
mat_Sqrt:  [[0.15]]
grads:  [0.10764891]
Stock Position:  0.10764890514378385
Bond Position:  [-13.80381845]


portfolio before change:  [-2.95360831]
curr_Stock_Price:  100.8086028813445
curr_Factors:  [100.80860288]
mat_Sqrt:  [[0.15]]
grads:  [0.03643491]
Stock Position:  0.036434912578043384
Bond Position:  [-6.62656094]


portfolio before change:  [-2.95429662]
curr_Stock_Price:  100.81244684791017
curr_Factors:  [100.81244685]
mat_Sqrt:  [[0.15]]
grads:  [0.0158083]
Stock Position:  0.015808297238225553
Bond Position:  [-4.54796975]


portfolio before change:  [-2.95852482]
curr_Stock_Price:  100.58094386902775
curr_Factors:  [100.58094387]
mat_Sqrt:  [[0.15]]
grads:  [0.05222881]
Stock Position:  0.05222881414572076
Bond Position:  [-8.21174825]


portfolio before change:  [-3.01859009]
curr_Stock_Price:  99.45055765353379
curr_Factors:  [99.45055765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.01859009]
Stock Price:  100.30105503575925
PL:  [-3.31964512]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.00442117e-03]
 [ 4.42270217e-03]
 [ 6.15584175e-03]
 [-1.12100176e-03]
 [ 7.67814147e-03]
 [ 1.92974907e-02]
 [-7.69439940e-04]
 [ 1.07428028e-02]
 [-7.13987565e-03]
 [ 1.51128181e-03]
 [ 1.00286101e-02]
 [ 4.05413680e-03]
 [ 1.17927627e-02]
 [ 4.73049291e-03]
 [ 1.66194060e-02]
 [-3.22399831e-03]
 [ 9.52184743e-03]
 [ 1.20431735e-02]
 [ 1.14600273e-02]
 [-1.30712222e-02]
 [-9.59907255e-03]
 [ 2.58095579e-02]
 [-3.66208795e-02]
 [ 6.95189594e-03]
 [ 4.63932379e-03]
 [-1.55190247e-02]
 [-2.51201162e-04]
 [-1.29061680e-02]
 [ 6.76458528e-02]
 [-2.85322232e-03]
 [-1.02979625e-02]
 [ 4.33206443e-03]
 [ 5.96449405e-03]
 [-3.29562382e-03]
 [ 7.28341406e-03]
 [ 4.49428343e-03]
 [-1.48698666e-02]
 [ 9.18115889e-03]
 [-1.66121519e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.60765174]
curr_Stock_Price:  100.55835697014727
curr_Factors:  [100.55835697]
mat_Sqrt:  [[0.15]]
grads:  [0.04002947]
Stock Position:  0.04002947443841647
Bond Position:  [6.58235356]


portfolio before change:  [10.60265048]
curr_Stock_Price:  100.41286153251573
curr_Factors:  [100.41286153]
mat_Sqrt:  [[0.15]]
grads:  [0.02948468]
Stock Position:  0.029484681108785892
Bond Position:  [7.64200928]


portfolio before change:  [10.5838264]
curr_Stock_Price:  99.7420253017226
curr_Factors:  [99.7420253]
mat_Sqrt:  [[0.15]]
grads:  [0.04103895]
Stock Position:  0.04103894503041178
Bond Position:  [6.49051891]


portfolio before change:  [10.55119525]
curr_Stock_Price:  98.92712832799751
curr_Factors:  [98.92712833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00747335]
Stock Position:  -0.00747334506601303
Bond Position:  [11.29051182]


portfolio before change:  [10.55001293]
curr_Stock_Price:  99.2741915867966
curr_Factors:  [99.27419159]
mat_Sqrt:  [[0.15]]
grads:  [0.05118761]
Stock Position:  0.05118760979472026
Bond Position:  [5.46840435]


portfolio before change:  [10.59808082]
curr_Stock_Price:  100.19989006447045
curr_Factors:  [100.19989006]
mat_Sqrt:  [[0.15]]
grads:  [0.12864994]
Stock Position:  0.12864993791284535
Bond Position:  [-2.29262882]


portfolio before change:  [10.60339416]
curr_Stock_Price:  100.24341855049194
curr_Factors:  [100.24341855]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051296]
Stock Position:  -0.005129599599080967
Bond Position:  [11.11760276]


portfolio before change:  [10.59709346]
curr_Stock_Price:  101.7426561996748
curr_Factors:  [101.7426562]
mat_Sqrt:  [[0.15]]
grads:  [0.07161869]
Stock Position:  0.07161868557259933
Bond Position:  [3.31041815]


portfolio before change:  [10.5527537]
curr_Stock_Price:  101.11776913063274
curr_Factors:  [101.11776913]
mat_Sqrt:  [[0.15]]
grads:  [-0.04759917]
Stock Position:  -0.04759917097515285
Bond Position:  [15.36587568]


portfolio before change:  [10.59690723]
curr_Stock_Price:  100.23051253674176
curr_Factors:  [100.23051254]
mat_Sqrt:  [[0.15]]
grads:  [0.01007521]
Stock Position:  0.010075212065495035
Bond Position:  [9.58706356]


portfolio before change:  [10.60134425]
curr_Stock_Price:  100.551951592443
curr_Factors:  [100.55195159]
mat_Sqrt:  [[0.15]]
grads:  [0.0668574]
Stock Position:  0.06685740051598205
Bond Position:  [3.87870215]


portfolio before change:  [10.6040796]
curr_Stock_Price:  100.58561246714095
curr_Factors:  [100.58561247]
mat_Sqrt:  [[0.15]]
grads:  [0.02702758]
Stock Position:  0.027027578635033418
Bond Position:  [7.88549405]


portfolio before change:  [10.61779752]
curr_Stock_Price:  101.05669308194368
curr_Factors:  [101.05669308]
mat_Sqrt:  [[0.15]]
grads:  [0.07861842]
Stock Position:  0.07861841798019997
Bond Position:  [2.67288018]


portfolio before change:  [10.48476558]
curr_Stock_Price:  99.36032128540789
curr_Factors:  [99.36032129]
mat_Sqrt:  [[0.15]]
grads:  [0.03153662]
Stock Position:  0.03153661942660163
Bond Position:  [7.35127694]


portfolio before change:  [10.50295496]
curr_Stock_Price:  99.90795163637466
curr_Factors:  [99.90795164]
mat_Sqrt:  [[0.15]]
grads:  [0.11079604]
Stock Position:  0.11079603981720525
Bond Position:  [-0.56645043]


portfolio before change:  [10.40720886]
curr_Stock_Price:  99.04442540313467
curr_Factors:  [99.0444254]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149332]
Stock Position:  -0.02149332209966279
Bond Position:  [12.5360026]


portfolio before change:  [10.37593014]
curr_Stock_Price:  100.5726122894227
curr_Factors:  [100.57261229]
mat_Sqrt:  [[0.15]]
grads:  [0.06347898]
Stock Position:  0.06347898284373318
Bond Position:  [3.99168301]


portfolio before change:  [10.46784743]
curr_Stock_Price:  102.01274704313418
curr_Factors:  [102.01274704]
mat_Sqrt:  [[0.15]]
grads:  [0.08028782]
Stock Position:  0.08028782327378081
Bond Position:  [2.27746602]


portfolio before change:  [10.48465783]
curr_Stock_Price:  102.21857777938523
curr_Factors:  [102.21857778]
mat_Sqrt:  [[0.15]]
grads:  [0.07640018]
Stock Position:  0.07640018220872657
Bond Position:  [2.67513986]


portfolio before change:  [10.3902635]
curr_Stock_Price:  100.97867570156859
curr_Factors:  [100.9786757]
mat_Sqrt:  [[0.15]]
grads:  [-0.08714148]
Stock Position:  -0.0871414816445592
Bond Position:  [19.18969491]


portfolio before change:  [10.30156153]
curr_Stock_Price:  102.0241114982209
curr_Factors:  [102.0241115]
mat_Sqrt:  [[0.15]]
grads:  [-0.06399382]
Stock Position:  -0.06399381699477846
Bond Position:  [16.83047385]


portfolio before change:  [10.26296549]
curr_Stock_Price:  102.6601101911501
curr_Factors:  [102.66011019]
mat_Sqrt:  [[0.15]]
grads:  [0.17206372]
Stock Position:  0.1720637193206776
Bond Position:  [-7.40111489]


portfolio before change:  [10.24938312]
curr_Stock_Price:  102.58654922788027
curr_Factors:  [102.58654923]
mat_Sqrt:  [[0.15]]
grads:  [-0.2441392]
Stock Position:  -0.24413919652587204
Bond Position:  [35.29478082]


portfolio before change:  [10.05067337]
curr_Stock_Price:  103.41854129447418
curr_Factors:  [103.41854129]
mat_Sqrt:  [[0.15]]
grads:  [0.04634597]
Stock Position:  0.04634597294846906
Bond Position:  [5.25764045]


portfolio before change:  [10.05485154]
curr_Stock_Price:  103.49451175641123
curr_Factors:  [103.49451176]
mat_Sqrt:  [[0.15]]
grads:  [0.03092883]
Stock Position:  0.03092882528609642
Bond Position:  [6.85388787]


portfolio before change:  [10.09400339]
curr_Stock_Price:  104.73267894270681
curr_Factors:  [104.73267894]
mat_Sqrt:  [[0.15]]
grads:  [-0.10346016]
Stock Position:  -0.10346016480291319
Bond Position:  [20.92966361]


portfolio before change:  [10.04308591]
curr_Stock_Price:  105.25011338600525
curr_Factors:  [105.25011339]
mat_Sqrt:  [[0.15]]
grads:  [-0.00167467]
Stock Position:  -0.0016746744137415973
Bond Position:  [10.21934558]


portfolio before change:  [10.04253436]
curr_Stock_Price:  106.34229462021398
curr_Factors:  [106.34229462]
mat_Sqrt:  [[0.15]]
grads:  [-0.08604112]
Stock Position:  -0.08604111995349575
Bond Position:  [19.19234448]


portfolio before change:  [10.01176449]
curr_Stock_Price:  106.72779705292271
curr_Factors:  [106.72779705]
mat_Sqrt:  [[0.15]]
grads:  [0.45097235]
Stock Position:  0.45097235191417323
Bond Position:  [-38.11952116]


portfolio before change:  [10.03172076]
curr_Stock_Price:  106.78261529909997
curr_Factors:  [106.7826153]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902148]
Stock Position:  -0.01902148213771604
Bond Position:  [12.06288437]


portfolio before change:  [10.04496594]
curr_Stock_Price:  106.16556454655571
curr_Factors:  [106.16556455]
mat_Sqrt:  [[0.15]]
grads:  [-0.06865308]
Stock Position:  -0.06865308316191322
Bond Position:  [17.33355927]


portfolio before change:  [10.05286305]
curr_Stock_Price:  106.08209726611518
curr_Factors:  [106.08209727]
mat_Sqrt:  [[0.15]]
grads:  [0.02888043]
Stock Position:  0.02888042953442387
Bond Position:  [6.98916652]


portfolio before change:  [10.0482359]
curr_Stock_Price:  105.89162720535218
curr_Factors:  [105.89162721]
mat_Sqrt:  [[0.15]]
grads:  [0.03976329]
Stock Position:  0.039763293671857984
Bond Position:  [5.83763603]


portfolio before change:  [9.99543986]
curr_Stock_Price:  104.54551662168487
curr_Factors:  [104.54551662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02197083]
Stock Position:  -0.021970825450956927
Bond Position:  [12.29239115]


portfolio before change:  [9.98118689]
curr_Stock_Price:  105.26417921786602
curr_Factors:  [105.26417922]
mat_Sqrt:  [[0.15]]
grads:  [0.04855609]
Stock Position:  0.048556093717208995
Bond Position:  [4.86996954]


portfolio before change:  [9.97539802]
curr_Stock_Price:  105.13242112099759
curr_Factors:  [105.13242112]
mat_Sqrt:  [[0.15]]
grads:  [0.02996189]
Stock Position:  0.029961889524398995
Bond Position:  [6.82543203]


portfolio before change:  [9.94534568]
curr_Stock_Price:  104.10092496402427
curr_Factors:  [104.10092496]
mat_Sqrt:  [[0.15]]
grads:  [-0.09913244]
Stock Position:  -0.09913244411286484
Bond Position:  [20.2651248]


portfolio before change:  [10.05804686]
curr_Stock_Price:  102.98960476070027
curr_Factors:  [102.98960476]
mat_Sqrt:  [[0.15]]
grads:  [0.06120773]
Stock Position:  0.06120772591828472
Bond Position:  [3.75428736]


portfolio before change:  [10.04396577]
curr_Stock_Price:  102.75188306873628
curr_Factors:  [102.75188307]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.04396577]
Stock Price:  103.57684832434566
PL:  [6.46711745]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.45507523e-03]
 [-3.99102728e-06]
 [ 3.78244383e-03]
 [ 5.26893301e-04]
 [ 1.06491952e-02]
 [-2.60838324e-02]
 [-4.49997165e-02]
 [ 1.33653695e-02]
 [-6.50011106e-03]
 [ 7.73122237e-03]
 [-9.83206507e-03]
 [ 7.61321598e-03]
 [ 1.38721329e-02]
 [-2.69543328e-03]
 [-7.44032999e-03]
 [-1.13037567e-02]
 [ 2.42849665e-02]
 [-4.13508488e-02]
 [ 1.16003451e-04]
 [ 9.43562975e-03]
 [ 2.87128693e-02]
 [ 1.97285346e-03]
 [ 4.13120132e-02]
 [-3.83207696e-03]
 [ 6.58067266e-03]
 [ 2.42596230e-02]
 [ 3.65852132e-02]
 [-2.76473335e-02]
 [-4.72767605e-02]
 [ 2.86915353e-03]
 [-4.33573338e-03]
 [ 5.58988668e-03]
 [ 1.99387190e-02]
 [-1.55516616e-02]
 [ 4.48295686e-03]
 [ 5.16117276e-03]
 [ 4.95503376e-03]
 [ 9.85803271e-03]
 [-7.06193488e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.54640198]
curr_Stock_Price:  101.45753695442714
curr_Factors:  [101.45753695]
mat_Sqrt:  [[0.15]]
grads:  [0.06303383]
Stock Position:  0.06303383485722651
Bond Position:  [18.15114435]


portfolio before change:  [24.53695733]
curr_Stock_Price:  101.27170525768013
curr_Factors:  [101.27170526]
mat_Sqrt:  [[0.15]]
grads:  [-2.66068486e-05]
Stock Position:  -2.6606848555014072e-05
Bond Position:  [24.53965185]


portfolio before change:  [24.54007211]
curr_Stock_Price:  99.50034433966971
curr_Factors:  [99.50034434]
mat_Sqrt:  [[0.15]]
grads:  [0.02521629]
Stock Position:  0.025216292208444954
Bond Position:  [22.03104235]


portfolio before change:  [24.51993065]
curr_Stock_Price:  98.59237920215809
curr_Factors:  [98.5923792]
mat_Sqrt:  [[0.15]]
grads:  [0.00351262]
Stock Position:  0.0035126220039061063
Bond Position:  [24.17361289]


portfolio before change:  [24.52583039]
curr_Stock_Price:  99.4116692665898
curr_Factors:  [99.41166927]
mat_Sqrt:  [[0.15]]
grads:  [0.07099463]
Stock Position:  0.07099463467747603
Bond Position:  [17.46813525]


portfolio before change:  [24.43923024]
curr_Stock_Price:  98.16109864073898
curr_Factors:  [98.16109864]
mat_Sqrt:  [[0.15]]
grads:  [-0.17389222]
Stock Position:  -0.17389221597979818
Bond Position:  [41.50868121]


portfolio before change:  [24.58610964]
curr_Stock_Price:  97.34628076098821
curr_Factors:  [97.34628076]
mat_Sqrt:  [[0.15]]
grads:  [-0.29999811]
Stock Position:  -0.29999811026556095
Bond Position:  [53.78980991]


portfolio before change:  [24.77718049]
curr_Stock_Price:  96.7317878568357
curr_Factors:  [96.73178786]
mat_Sqrt:  [[0.15]]
grads:  [0.08910246]
Stock Position:  0.08910246328889443
Bond Position:  [16.15813992]


portfolio before change:  [24.75022409]
curr_Stock_Price:  96.40658590640957
curr_Factors:  [96.40658591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04333407]
Stock Position:  -0.043334073751275494
Bond Position:  [28.9279142]


portfolio before change:  [24.75998785]
curr_Stock_Price:  96.26472188485026
curr_Factors:  [96.26472188]
mat_Sqrt:  [[0.15]]
grads:  [0.05154148]
Stock Position:  0.05154148245485189
Bond Position:  [19.79836138]


portfolio before change:  [24.78412222]
curr_Stock_Price:  96.68495460715145
curr_Factors:  [96.68495461]
mat_Sqrt:  [[0.15]]
grads:  [-0.0655471]
Stock Position:  -0.06554710044137142
Bond Position:  [31.12154065]


portfolio before change:  [24.81671633]
curr_Stock_Price:  96.24704549559799
curr_Factors:  [96.2470455]
mat_Sqrt:  [[0.15]]
grads:  [0.05075477]
Stock Position:  0.05075477322589177
Bond Position:  [19.93171936]


portfolio before change:  [24.77091569]
curr_Stock_Price:  95.29556330366556
curr_Factors:  [95.2955633]
mat_Sqrt:  [[0.15]]
grads:  [0.09248089]
Stock Position:  0.09248088609792479
Bond Position:  [15.95789755]


portfolio before change:  [24.71112839]
curr_Stock_Price:  94.62751005279259
curr_Factors:  [94.62751005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01796956]
Stock Position:  -0.017969555198952464
Bond Position:  [26.41154266]


portfolio before change:  [24.70177241]
curr_Stock_Price:  95.33190349697193
curr_Factors:  [95.3319035]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496022]
Stock Position:  -0.0496021999207155
Bond Position:  [29.43044454]


portfolio before change:  [24.74196433]
curr_Stock_Price:  94.5957891471196
curr_Factors:  [94.59578915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07535838]
Stock Position:  -0.0753583778915862
Bond Position:  [31.87054956]


portfolio before change:  [24.77596163]
curr_Stock_Price:  94.19751587032353
curr_Factors:  [94.19751587]
mat_Sqrt:  [[0.15]]
grads:  [0.16189978]
Stock Position:  0.16189977664301758
Bond Position:  [9.52540485]


portfolio before change:  [24.78389827]
curr_Stock_Price:  94.23918295988717
curr_Factors:  [94.23918296]
mat_Sqrt:  [[0.15]]
grads:  [-0.27567233]
Stock Position:  -0.27567232534380853
Bond Position:  [50.76303298]


portfolio before change:  [24.81232006]
curr_Stock_Price:  94.15910231729823
curr_Factors:  [94.15910232]
mat_Sqrt:  [[0.15]]
grads:  [0.00077336]
Stock Position:  0.000773356337865581
Bond Position:  [24.73950152]


portfolio before change:  [24.81524994]
curr_Stock_Price:  93.94864887434737
curr_Factors:  [93.94864887]
mat_Sqrt:  [[0.15]]
grads:  [0.0629042]
Stock Position:  0.06290419832438612
Bond Position:  [18.9054855]


portfolio before change:  [24.78633204]
curr_Stock_Price:  93.4513651024592
curr_Factors:  [93.4513651]
mat_Sqrt:  [[0.15]]
grads:  [0.19141913]
Stock Position:  0.19141912868261138
Bond Position:  [6.89795315]


portfolio before change:  [24.71076027]
curr_Stock_Price:  93.05206296662242
curr_Factors:  [93.05206297]
mat_Sqrt:  [[0.15]]
grads:  [0.01315236]
Stock Position:  0.013152356391859025
Bond Position:  [23.48690637]


portfolio before change:  [24.71087601]
curr_Stock_Price:  92.83762992510509
curr_Factors:  [92.83762993]
mat_Sqrt:  [[0.15]]
grads:  [0.27541342]
Stock Position:  0.2754134213974402
Bond Position:  [-0.85785328]


portfolio before change:  [24.52478809]
curr_Stock_Price:  92.16235169913878
curr_Factors:  [92.1623517]
mat_Sqrt:  [[0.15]]
grads:  [-0.02554718]
Stock Position:  -0.02554717973170228
Bond Position:  [26.87927625]


portfolio before change:  [24.52548964]
curr_Stock_Price:  92.26641687890107
curr_Factors:  [92.26641688]
mat_Sqrt:  [[0.15]]
grads:  [0.04387115]
Stock Position:  0.04387115107324963
Bond Position:  [20.47765572]


portfolio before change:  [24.54937371]
curr_Stock_Price:  92.75248126352275
curr_Factors:  [92.75248126]
mat_Sqrt:  [[0.15]]
grads:  [0.16173082]
Stock Position:  0.1617308199653392
Bond Position:  [9.54843886]


portfolio before change:  [24.52693981]
curr_Stock_Price:  92.60638961023027
curr_Factors:  [92.60638961]
mat_Sqrt:  [[0.15]]
grads:  [0.24390142]
Stock Position:  0.2439014211239927
Bond Position:  [1.94010978]


portfolio before change:  [24.56638045]
curr_Stock_Price:  92.76710251619039
curr_Factors:  [92.76710252]
mat_Sqrt:  [[0.15]]
grads:  [-0.18431556]
Stock Position:  -0.18431555679324177
Bond Position:  [41.6648006]


portfolio before change:  [24.47326249]
curr_Stock_Price:  93.30057016874608
curr_Factors:  [93.30057017]
mat_Sqrt:  [[0.15]]
grads:  [-0.3151784]
Stock Position:  -0.31517840312724865
Bond Position:  [53.8795872]


portfolio before change:  [24.63182318]
curr_Stock_Price:  92.81885784559279
curr_Factors:  [92.81885785]
mat_Sqrt:  [[0.15]]
grads:  [0.01912769]
Stock Position:  0.019127690188664535
Bond Position:  [22.85641282]


portfolio before change:  [24.6160984]
curr_Stock_Price:  91.84738642945455
curr_Factors:  [91.84738643]
mat_Sqrt:  [[0.15]]
grads:  [-0.02890489]
Stock Position:  -0.02890488923102799
Bond Position:  [27.27093693]


portfolio before change:  [24.59665988]
curr_Stock_Price:  92.63782724392695
curr_Factors:  [92.63782724]
mat_Sqrt:  [[0.15]]
grads:  [0.03726591]
Stock Position:  0.03726591120084086
Bond Position:  [21.14442683]


portfolio before change:  [24.60794869]
curr_Stock_Price:  92.86982450114346
curr_Factors:  [92.8698245]
mat_Sqrt:  [[0.15]]
grads:  [0.13292479]
Stock Position:  0.13292479341821636
Bond Position:  [12.26324645]


portfolio before change:  [24.54796463]
curr_Stock_Price:  92.40702851617048
curr_Factors:  [92.40702852]
mat_Sqrt:  [[0.15]]
grads:  [-0.10367774]
Stock Position:  -0.10367774406339507
Bond Position:  [34.12851688]


portfolio before change:  [24.43934188]
curr_Stock_Price:  93.49587432298401
curr_Factors:  [93.49587432]
mat_Sqrt:  [[0.15]]
grads:  [0.02988638]
Stock Position:  0.02988637906859594
Bond Position:  [21.64508874]


portfolio before change:  [24.45326999]
curr_Stock_Price:  93.87137313172877
curr_Factors:  [93.87137313]
mat_Sqrt:  [[0.15]]
grads:  [0.03440782]
Stock Position:  0.03440781840517486
Bond Position:  [21.22336083]


portfolio before change:  [24.48234404]
curr_Stock_Price:  94.63925004763604
curr_Factors:  [94.63925005]
mat_Sqrt:  [[0.15]]
grads:  [0.03303356]
Stock Position:  0.03303355840991782
Bond Position:  [21.35607285]


portfolio before change:  [24.4835801]
curr_Stock_Price:  94.5958513523891
curr_Factors:  [94.59585135]
mat_Sqrt:  [[0.15]]
grads:  [0.06572022]
Stock Position:  0.06572021807745111
Bond Position:  [18.26672012]


portfolio before change:  [24.39988623]
curr_Stock_Price:  93.28761831415707
curr_Factors:  [93.28761831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.39988623]
Stock Price:  91.76450031115822
PL:  [24.39988623]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.59841572e-03]
 [-1.06823028e-03]
 [ 1.36094323e-02]
 [ 1.39820577e-02]
 [ 1.46463477e-02]
 [ 2.61510922e-02]
 [ 1.70851499e-02]
 [ 9.02978944e-03]
 [-9.08289234e-03]
 [-1.87001979e-03]
 [ 1.20780411e-02]
 [ 5.55038928e-03]
 [ 1.20703913e-02]
 [-4.19092137e-03]
 [ 1.30759297e-02]
 [ 2.42080304e-03]
 [ 8.86137812e-03]
 [ 9.55824793e-03]
 [ 1.17015964e-02]
 [-1.64734320e-02]
 [ 3.44752983e-03]
 [ 2.56484408e-02]
 [-3.65387226e-02]
 [ 7.85180959e-03]
 [ 7.43386920e-03]
 [-6.53228839e-03]
 [-1.03374058e-03]
 [-1.07448578e-02]
 [ 4.53010992e-02]
 [-1.08272287e-02]
 [-9.62658860e-04]
 [ 5.15263691e-03]
 [ 5.23174090e-03]
 [-4.53761998e-03]
 [ 1.41616107e-02]
 [ 5.37587534e-03]
 [ 2.63616362e-04]
 [ 8.47396784e-03]
 [-1.66381238e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.89784036]
curr_Stock_Price:  101.48020802287188
curr_Factors:  [101.48020802]
mat_Sqrt:  [[0.15]]
grads:  [0.06398944]
Stock Position:  0.06398943811052103
Bond Position:  [18.40417887]


portfolio before change:  [24.89496946]
curr_Stock_Price:  101.39938890462743
curr_Factors:  [101.3993889]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712154]
Stock Position:  -0.007121535200270262
Bond Position:  [25.61708878]


portfolio before change:  [24.89072305]
curr_Stock_Price:  102.44533506905077
curr_Factors:  [102.44533507]
mat_Sqrt:  [[0.15]]
grads:  [0.09072955]
Stock Position:  0.09072954875064217
Bond Position:  [15.59590403]


portfolio before change:  [24.90367095]
curr_Stock_Price:  102.56655560581218
curr_Factors:  [102.56655561]
mat_Sqrt:  [[0.15]]
grads:  [0.09321372]
Stock Position:  0.09321371791168152
Bond Position:  [15.34306097]


portfolio before change:  [24.78253515]
curr_Stock_Price:  101.24643014385384
curr_Factors:  [101.24643014]
mat_Sqrt:  [[0.15]]
grads:  [0.09764232]
Stock Position:  0.09764231817485627
Bond Position:  [14.896599]


portfolio before change:  [24.75250017]
curr_Stock_Price:  100.91975657016387
curr_Factors:  [100.91975657]
mat_Sqrt:  [[0.15]]
grads:  [0.17434061]
Stock Position:  0.1743406146496552
Bond Position:  [7.15808778]


portfolio before change:  [25.01447083]
curr_Stock_Price:  102.41726095715586
curr_Factors:  [102.41726096]
mat_Sqrt:  [[0.15]]
grads:  [0.113901]
Stock Position:  0.11390099920676688
Bond Position:  [13.34904247]


portfolio before change:  [24.99017344]
curr_Stock_Price:  102.18929003346786
curr_Factors:  [102.18929003]
mat_Sqrt:  [[0.15]]
grads:  [0.0601986]
Stock Position:  0.06019859624256959
Bond Position:  [18.83852163]


portfolio before change:  [24.9994585]
curr_Stock_Price:  102.3044106166309
curr_Factors:  [102.30441062]
mat_Sqrt:  [[0.15]]
grads:  [-0.06055262]
Stock Position:  -0.060552615605460526
Bond Position:  [31.19425816]


portfolio before change:  [25.05617292]
curr_Stock_Price:  101.43219575632274
curr_Factors:  [101.43219576]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124668]
Stock Position:  -0.012466798624413923
Bond Position:  [26.32070768]


portfolio before change:  [25.05106009]
curr_Stock_Price:  102.10623577544217
curr_Factors:  [102.10623578]
mat_Sqrt:  [[0.15]]
grads:  [0.08052027]
Stock Position:  0.0805202737332456
Bond Position:  [16.82943804]


portfolio before change:  [25.04075775]
curr_Stock_Price:  101.95216083638424
curr_Factors:  [101.95216084]
mat_Sqrt:  [[0.15]]
grads:  [0.0370026]
Stock Position:  0.03700259520133548
Bond Position:  [21.26826321]


portfolio before change:  [25.00705221]
curr_Stock_Price:  100.96941245989458
curr_Factors:  [100.96941246]
mat_Sqrt:  [[0.15]]
grads:  [0.08046928]
Stock Position:  0.0804692750923071
Bond Position:  [16.88211678]


portfolio before change:  [25.03902152]
curr_Stock_Price:  101.3404722478073
curr_Factors:  [101.34047225]
mat_Sqrt:  [[0.15]]
grads:  [-0.02793948]
Stock Position:  -0.027939475794990107
Bond Position:  [27.87042119]


portfolio before change:  [25.01326374]
curr_Stock_Price:  102.38708435678346
curr_Factors:  [102.38708436]
mat_Sqrt:  [[0.15]]
grads:  [0.08717286]
Stock Position:  0.08717286478751597
Bond Position:  [16.08788828]


portfolio before change:  [25.01566732]
curr_Stock_Price:  102.39158651703752
curr_Factors:  [102.39158652]
mat_Sqrt:  [[0.15]]
grads:  [0.01613869]
Stock Position:  0.016138686924095327
Bond Position:  [23.36320156]


portfolio before change:  [25.02275714]
curr_Stock_Price:  102.64992449096796
curr_Factors:  [102.64992449]
mat_Sqrt:  [[0.15]]
grads:  [0.05907585]
Stock Position:  0.059075854101035094
Bond Position:  [18.95862518]


portfolio before change:  [25.05944352]
curr_Stock_Price:  103.2308116100241
curr_Factors:  [103.23081161]
mat_Sqrt:  [[0.15]]
grads:  [0.06372165]
Stock Position:  0.06372165286069874
Bond Position:  [18.48140558]


portfolio before change:  [25.05887932]
curr_Stock_Price:  103.18570110846203
curr_Factors:  [103.18570111]
mat_Sqrt:  [[0.15]]
grads:  [0.07801064]
Stock Position:  0.07801064234928509
Bond Position:  [17.0092965]


portfolio before change:  [25.15150652]
curr_Stock_Price:  104.34581076218946
curr_Factors:  [104.34581076]
mat_Sqrt:  [[0.15]]
grads:  [-0.10982288]
Stock Position:  -0.10982287998779539
Bond Position:  [36.61106397]


portfolio before change:  [25.24019321]
curr_Stock_Price:  103.57994098078782
curr_Factors:  [103.57994098]
mat_Sqrt:  [[0.15]]
grads:  [0.02298353]
Stock Position:  0.02298353222456969
Bond Position:  [22.8595603]


portfolio before change:  [25.22127059]
curr_Stock_Price:  102.63229548660263
curr_Factors:  [102.63229549]
mat_Sqrt:  [[0.15]]
grads:  [0.17098961]
Stock Position:  0.17098960564328952
Bond Position:  [7.67221486]


portfolio before change:  [25.36872028]
curr_Stock_Price:  103.48901775295184
curr_Factors:  [103.48901775]
mat_Sqrt:  [[0.15]]
grads:  [-0.24359148]
Stock Position:  -0.24359148423672067
Bond Position:  [50.57776372]


portfolio before change:  [25.2226099]
curr_Stock_Price:  104.11479086337746
curr_Factors:  [104.11479086]
mat_Sqrt:  [[0.15]]
grads:  [0.0523454]
Stock Position:  0.0523453972738068
Bond Position:  [19.77267981]


portfolio before change:  [25.25916979]
curr_Stock_Price:  104.76600665406676
curr_Factors:  [104.76600665]
mat_Sqrt:  [[0.15]]
grads:  [0.04955913]
Stock Position:  0.049559128005781376
Bond Position:  [20.06705785]


portfolio before change:  [25.15257933]
curr_Stock_Price:  102.56461599497494
curr_Factors:  [102.56461599]
mat_Sqrt:  [[0.15]]
grads:  [-0.04354859]
Stock Position:  -0.043548589293152494
Bond Position:  [29.61912366]


portfolio before change:  [25.16057243]
curr_Stock_Price:  102.46609429501387
curr_Factors:  [102.4660943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0068916]
Stock Position:  -0.006891603872040456
Bond Position:  [25.86672816]


portfolio before change:  [25.15938229]
curr_Stock_Price:  103.10798878609273
curr_Factors:  [103.10798879]
mat_Sqrt:  [[0.15]]
grads:  [-0.07163239]
Stock Position:  -0.0716323850163307
Bond Position:  [32.54525344]


portfolio before change:  [25.16603419]
curr_Stock_Price:  103.07192284988945
curr_Factors:  [103.07192285]
mat_Sqrt:  [[0.15]]
grads:  [0.30200733]
Stock Position:  0.3020073278062325
Bond Position:  [-5.9624418]


portfolio before change:  [24.83363565]
curr_Stock_Price:  101.97376014082172
curr_Factors:  [101.97376014]
mat_Sqrt:  [[0.15]]
grads:  [-0.07218152]
Stock Position:  -0.07218152434008132
Bond Position:  [32.1942571]


portfolio before change:  [24.78732511]
curr_Stock_Price:  102.67110034463049
curr_Factors:  [102.67110034]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641773]
Stock Position:  -0.006417725730619205
Bond Position:  [25.44624007]


portfolio before change:  [24.79588461]
curr_Stock_Price:  101.83302731599066
curr_Factors:  [101.83302732]
mat_Sqrt:  [[0.15]]
grads:  [0.03435091]
Stock Position:  0.03435091270584087
Bond Position:  [21.29782718]


portfolio before change:  [24.83664331]
curr_Stock_Price:  102.94206057409957
curr_Factors:  [102.94206057]
mat_Sqrt:  [[0.15]]
grads:  [0.03487827]
Stock Position:  0.03487827266914124
Bond Position:  [21.24620205]


portfolio before change:  [24.83812534]
curr_Stock_Price:  102.90840335874309
curr_Factors:  [102.90840336]
mat_Sqrt:  [[0.15]]
grads:  [-0.0302508]
Stock Position:  -0.03025079985848824
Bond Position:  [27.95118686]


portfolio before change:  [24.85008762]
curr_Stock_Price:  102.6284715265857
curr_Factors:  [102.62847153]
mat_Sqrt:  [[0.15]]
grads:  [0.09441074]
Stock Position:  0.09441073797474983
Bond Position:  [15.16085789]


portfolio before change:  [24.8491745]
curr_Stock_Price:  102.59872550033951
curr_Factors:  [102.5987255]
mat_Sqrt:  [[0.15]]
grads:  [0.03583917]
Stock Position:  0.03583916893572722
Bond Position:  [21.17212145]


portfolio before change:  [24.81476869]
curr_Stock_Price:  101.56487077292473
curr_Factors:  [101.56487077]
mat_Sqrt:  [[0.15]]
grads:  [0.00175744]
Stock Position:  0.0017574424163604649
Bond Position:  [24.63627428]


portfolio before change:  [24.81885683]
curr_Stock_Price:  102.13866692225908
curr_Factors:  [102.13866692]
mat_Sqrt:  [[0.15]]
grads:  [0.05649312]
Stock Position:  0.05649311892668379
Bond Position:  [19.04872497]


portfolio before change:  [24.84917237]
curr_Stock_Price:  102.63313958009809
curr_Factors:  [102.63313958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.84917237]
Stock Price:  104.58597141588994
PL:  [20.26320096]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 6.43992206e-03]
 [-7.31219167e-03]
 [ 1.32662665e-02]
 [-2.93578516e-03]
 [-1.77551198e-02]
 [-3.30147907e-02]
 [-4.09296575e-02]
 [ 1.04069708e-02]
 [-6.52928329e-03]
 [ 1.21129840e-02]
 [-1.42570690e-02]
 [ 7.65636058e-03]
 [ 1.38925121e-02]
 [-7.04092162e-04]
 [-1.06318409e-02]
 [-1.14174427e-02]
 [ 2.34372472e-02]
 [-4.36178581e-02]
 [ 1.06720485e-03]
 [ 3.96879554e-03]
 [ 2.18596640e-02]
 [-3.51830303e-03]
 [ 2.39493956e-02]
 [ 4.06908518e-03]
 [ 1.38123373e-02]
 [-7.00996245e-03]
 [ 2.24591567e-02]
 [-2.42392991e-02]
 [-4.76934426e-02]
 [ 7.26364300e-04]
 [-3.96201317e-03]
 [ 5.60698682e-03]
 [ 9.42041165e-03]
 [-1.27550618e-02]
 [ 3.05768614e-03]
 [ 5.59018495e-03]
 [ 3.36751978e-03]
 [ 1.14333092e-02]
 [-2.51813485e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.16263401]
curr_Stock_Price:  99.21847893939271
curr_Factors:  [99.21847894]
mat_Sqrt:  [[0.15]]
grads:  [0.04293281]
Stock Position:  0.04293281374307405
Bond Position:  [-14.42236249]


portfolio before change:  [-10.17103941]
curr_Stock_Price:  99.0646922927508
curr_Factors:  [99.06469229]
mat_Sqrt:  [[0.15]]
grads:  [-0.04874794]
Stock Position:  -0.04874794443397093
Bond Position:  [-5.3418393]


portfolio before change:  [-10.2590434]
curr_Stock_Price:  100.85627989274822
curr_Factors:  [100.85627989]
mat_Sqrt:  [[0.15]]
grads:  [0.08844178]
Stock Position:  0.08844177659667178
Bond Position:  [-19.17895197]


portfolio before change:  [-10.32984718]
curr_Stock_Price:  100.08281885626018
curr_Factors:  [100.08281886]
mat_Sqrt:  [[0.15]]
grads:  [-0.0195719]
Stock Position:  -0.019571901037617214
Bond Position:  [-8.37103616]


portfolio before change:  [-10.29523532]
curr_Stock_Price:  98.26090547945647
curr_Factors:  [98.26090548]
mat_Sqrt:  [[0.15]]
grads:  [-0.11836747]
Stock Position:  -0.11836746516616786
Bond Position:  [1.33565899]


portfolio before change:  [-10.12141285]
curr_Stock_Price:  96.79381731980257
curr_Factors:  [96.79381732]
mat_Sqrt:  [[0.15]]
grads:  [-0.2200986]
Stock Position:  -0.22009860460720496
Bond Position:  [11.18277128]


portfolio before change:  [-10.15484997]
curr_Stock_Price:  96.95208756644962
curr_Factors:  [96.95208757]
mat_Sqrt:  [[0.15]]
grads:  [-0.27286438]
Stock Position:  -0.27286438321116413
Bond Position:  [16.2999216]


portfolio before change:  [-9.9588075]
curr_Stock_Price:  96.24109386608586
curr_Factors:  [96.24109387]
mat_Sqrt:  [[0.15]]
grads:  [0.06937981]
Stock Position:  0.06937980518394034
Bond Position:  [-16.63599584]


portfolio before change:  [-9.98945846]
curr_Stock_Price:  95.82928330763144
curr_Factors:  [95.82928331]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352856]
Stock Position:  -0.04352855525005728
Bond Position:  [-5.81814821]


portfolio before change:  [-9.98365522]
curr_Stock_Price:  95.679254004256
curr_Factors:  [95.679254]
mat_Sqrt:  [[0.15]]
grads:  [0.08075323]
Stock Position:  0.08075322695413194
Bond Position:  [-17.71006373]


portfolio before change:  [-10.00393473]
curr_Stock_Price:  95.45554015134839
curr_Factors:  [95.45554015]
mat_Sqrt:  [[0.15]]
grads:  [-0.09504713]
Stock Position:  -0.09504712688176498
Bond Position:  [-0.93115989]


portfolio before change:  [-10.02926853]
curr_Stock_Price:  95.72085480497036
curr_Factors:  [95.7208548]
mat_Sqrt:  [[0.15]]
grads:  [0.0510424]
Stock Position:  0.0510424038949231
Bond Position:  [-14.91509106]


portfolio before change:  [-9.98232576]
curr_Stock_Price:  96.67706510400735
curr_Factors:  [96.6770651]
mat_Sqrt:  [[0.15]]
grads:  [0.09261675]
Stock Position:  0.09261674727097315
Bond Position:  [-18.93624107]


portfolio before change:  [-10.06338222]
curr_Stock_Price:  95.82744245377576
curr_Factors:  [95.82744245]
mat_Sqrt:  [[0.15]]
grads:  [-0.00469395]
Stock Position:  -0.004693947745509591
Bond Position:  [-9.61357322]


portfolio before change:  [-10.05855316]
curr_Stock_Price:  94.54263210728047
curr_Factors:  [94.54263211]
mat_Sqrt:  [[0.15]]
grads:  [-0.07087894]
Stock Position:  -0.07087893939377643
Bond Position:  [-3.35747167]


portfolio before change:  [-10.05875218]
curr_Stock_Price:  94.53951845844576
curr_Factors:  [94.53951846]
mat_Sqrt:  [[0.15]]
grads:  [-0.07611628]
Stock Position:  -0.07611628470055351
Bond Position:  [-2.86275528]


portfolio before change:  [-10.05890394]
curr_Stock_Price:  94.53681069350868
curr_Factors:  [94.53681069]
mat_Sqrt:  [[0.15]]
grads:  [0.15624831]
Stock Position:  0.1562483146723777
Bond Position:  [-24.83012129]


portfolio before change:  [-10.13929367]
curr_Stock_Price:  94.04217646274158
curr_Factors:  [94.04217646]
mat_Sqrt:  [[0.15]]
grads:  [-0.29078572]
Stock Position:  -0.2907857207384767
Bond Position:  [17.2068284]


portfolio before change:  [-10.31455213]
curr_Stock_Price:  94.6522801957087
curr_Factors:  [94.6522802]
mat_Sqrt:  [[0.15]]
grads:  [0.0071147]
Stock Position:  0.007114698976769795
Bond Position:  [-10.98797461]


portfolio before change:  [-10.31062517]
curr_Stock_Price:  95.39729319404027
curr_Factors:  [95.39729319]
mat_Sqrt:  [[0.15]]
grads:  [0.02645864]
Stock Position:  0.026458636913296887
Bond Position:  [-12.83470752]


portfolio before change:  [-10.2824557]
curr_Stock_Price:  96.52259347077451
curr_Factors:  [96.52259347]
mat_Sqrt:  [[0.15]]
grads:  [0.14573109]
Stock Position:  0.14573109302464382
Bond Position:  [-24.34879875]


portfolio before change:  [-10.33774056]
curr_Stock_Price:  96.16411763654509
curr_Factors:  [96.16411764]
mat_Sqrt:  [[0.15]]
grads:  [-0.02345535]
Stock Position:  -0.02345535354788614
Bond Position:  [-8.08217719]


portfolio before change:  [-10.34130098]
curr_Stock_Price:  96.2728382255469
curr_Factors:  [96.27283823]
mat_Sqrt:  [[0.15]]
grads:  [0.15966264]
Stock Position:  0.15966263730537378
Bond Position:  [-25.71247623]


portfolio before change:  [-10.29849122]
curr_Stock_Price:  96.56109614572956
curr_Factors:  [96.56109615]
mat_Sqrt:  [[0.15]]
grads:  [0.02712723]
Stock Position:  0.027127234539175163
Bond Position:  [-12.91792672]


portfolio before change:  [-10.31895978]
curr_Stock_Price:  95.86608561622315
curr_Factors:  [95.86608562]
mat_Sqrt:  [[0.15]]
grads:  [0.09208225]
Stock Position:  0.09208224862013746
Bond Position:  [-19.14652451]


portfolio before change:  [-10.26160165]
curr_Stock_Price:  96.5149792706299
curr_Factors:  [96.51497927]
mat_Sqrt:  [[0.15]]
grads:  [-0.04673308]
Stock Position:  -0.04673308300975807
Bond Position:  [-5.75115912]


portfolio before change:  [-10.24841497]
curr_Stock_Price:  96.21742507205673
curr_Factors:  [96.21742507]
mat_Sqrt:  [[0.15]]
grads:  [0.14972771]
Stock Position:  0.1497277112041683
Bond Position:  [-24.6548298]


portfolio before change:  [-10.4919664]
curr_Stock_Price:  94.61138044579285
curr_Factors:  [94.61138045]
mat_Sqrt:  [[0.15]]
grads:  [-0.16159533]
Stock Position:  -0.16159532758191478
Bond Position:  [4.79679061]


portfolio before change:  [-10.69706473]
curr_Stock_Price:  95.88430071926489
curr_Factors:  [95.88430072]
mat_Sqrt:  [[0.15]]
grads:  [-0.31795628]
Stock Position:  -0.3179562839653552
Bond Position:  [19.78995121]


portfolio before change:  [-10.74469669]
curr_Stock_Price:  96.04188796820635
curr_Factors:  [96.04188797]
mat_Sqrt:  [[0.15]]
grads:  [0.00484243]
Stock Position:  0.00484242866832917
Bond Position:  [-11.20977268]


portfolio before change:  [-10.73965481]
curr_Stock_Price:  97.37245868058336
curr_Factors:  [97.37245868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02641342]
Stock Position:  -0.02641342114875893
Bond Position:  [-8.16771505]


portfolio before change:  [-10.73852225]
curr_Stock_Price:  97.29092486981874
curr_Factors:  [97.29092487]
mat_Sqrt:  [[0.15]]
grads:  [0.03737991]
Stock Position:  0.037379912136232304
Bond Position:  [-14.37524847]


portfolio before change:  [-10.73776231]
curr_Stock_Price:  97.35932951300713
curr_Factors:  [97.35932951]
mat_Sqrt:  [[0.15]]
grads:  [0.06280274]
Stock Position:  0.0628027443624904
Bond Position:  [-16.85219539]


portfolio before change:  [-10.75185036]
curr_Stock_Price:  97.16855126396712
curr_Factors:  [97.16855126]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503375]
Stock Position:  -0.0850337450094754
Bond Position:  [-2.48924455]


portfolio before change:  [-10.7443263]
curr_Stock_Price:  97.07640854436148
curr_Factors:  [97.07640854]
mat_Sqrt:  [[0.15]]
grads:  [0.02038457]
Stock Position:  0.020384574299556237
Bond Position:  [-12.72318756]


portfolio before change:  [-10.77022781]
curr_Stock_Price:  95.88379031422329
curr_Factors:  [95.88379031]
mat_Sqrt:  [[0.15]]
grads:  [0.0372679]
Stock Position:  0.037267899691776935
Bond Position:  [-14.34361529]


portfolio before change:  [-10.76983171]
curr_Stock_Price:  95.94253144491253
curr_Factors:  [95.94253144]
mat_Sqrt:  [[0.15]]
grads:  [0.02245013]
Stock Position:  0.022450131850601168
Bond Position:  [-12.92375419]


portfolio before change:  [-10.75880481]
curr_Stock_Price:  96.50566727372525
curr_Factors:  [96.50566727]
mat_Sqrt:  [[0.15]]
grads:  [0.07622206]
Stock Position:  0.07622206120123201
Bond Position:  [-18.11466569]


portfolio before change:  [-10.69498384]
curr_Stock_Price:  97.37267933104107
curr_Factors:  [97.37267933]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.69498384]
Stock Price:  96.69854220106032
PL:  [-10.69498384]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.93084269e-03]
 [-5.67333487e-03]
 [ 3.40193119e-03]
 [ 1.29083711e-04]
 [ 1.14657217e-02]
 [ 2.41274124e-02]
 [-4.15076954e-03]
 [ 2.08467428e-02]
 [-6.13382334e-03]
 [-8.73368193e-04]
 [ 1.41685043e-02]
 [ 8.42638907e-03]
 [ 6.36688876e-03]
 [-4.54344300e-03]
 [ 6.83420535e-03]
 [ 2.44963796e-03]
 [ 8.77639007e-03]
 [ 1.16702497e-02]
 [ 1.15125374e-02]
 [-1.55470639e-02]
 [ 3.53560812e-03]
 [ 3.00960562e-02]
 [-4.20746138e-02]
 [ 6.63127284e-03]
 [ 1.51640313e-03]
 [-1.10771278e-02]
 [-6.74428116e-04]
 [-1.12831145e-02]
 [ 6.72568022e-02]
 [-2.29168610e-03]
 [-1.34478490e-02]
 [ 4.16254690e-03]
 [ 6.51359558e-03]
 [ 1.26920691e-03]
 [ 8.17137842e-03]
 [ 3.53236667e-03]
 [-5.87145682e-02]
 [ 9.28188614e-03]
 [ 4.33182083e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.27471149]
curr_Stock_Price:  99.59830510705015
curr_Factors:  [99.59830511]
mat_Sqrt:  [[0.15]]
grads:  [0.02620562]
Stock Position:  0.026205617927252345
Bond Position:  [-6.88474662]


portfolio before change:  [-4.28648839]
curr_Stock_Price:  99.18174335304535
curr_Factors:  [99.18174335]
mat_Sqrt:  [[0.15]]
grads:  [-0.03782223]
Stock Position:  -0.037822232497299955
Bond Position:  [-0.53521343]


portfolio before change:  [-4.29799748]
curr_Stock_Price:  99.48426862289575
curr_Factors:  [99.48426862]
mat_Sqrt:  [[0.15]]
grads:  [0.02267954]
Stock Position:  0.022679541236909014
Bond Position:  [-6.55425505]


portfolio before change:  [-4.31741764]
curr_Stock_Price:  98.66410949456504
curr_Factors:  [98.66410949]
mat_Sqrt:  [[0.15]]
grads:  [0.00086056]
Stock Position:  0.0008605580753544378
Bond Position:  [-4.40232384]


portfolio before change:  [-4.31729315]
curr_Stock_Price:  99.44826879875015
curr_Factors:  [99.4482688]
mat_Sqrt:  [[0.15]]
grads:  [0.07643814]
Stock Position:  0.07643814484393234
Bond Position:  [-11.91893433]


portfolio before change:  [-4.23824075]
curr_Stock_Price:  100.50196212154195
curr_Factors:  [100.50196212]
mat_Sqrt:  [[0.15]]
grads:  [0.16084942]
Stock Position:  0.1608494161852515
Bond Position:  [-20.40392268]


portfolio before change:  [-4.33453039]
curr_Stock_Price:  99.91918730083151
curr_Factors:  [99.9191873]
mat_Sqrt:  [[0.15]]
grads:  [-0.0276718]
Stock Position:  -0.02767179696477377
Bond Position:  [-1.56958693]


portfolio before change:  [-4.34239429]
curr_Stock_Price:  100.19628143827765
curr_Factors:  [100.19628144]
mat_Sqrt:  [[0.15]]
grads:  [0.13897829]
Stock Position:  0.13897828524656983
Bond Position:  [-18.26750168]


portfolio before change:  [-4.2902553]
curr_Stock_Price:  100.58787189633175
curr_Factors:  [100.5878719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04089216]
Stock Position:  -0.04089215561773849
Bond Position:  [-0.17700039]


portfolio before change:  [-4.30979635]
curr_Stock_Price:  101.0651986526267
curr_Factors:  [101.06519865]
mat_Sqrt:  [[0.15]]
grads:  [-0.00582245]
Stock Position:  -0.005822454616704643
Bond Position:  [-3.72134882]


portfolio before change:  [-4.3185433]
curr_Stock_Price:  102.4875803105152
curr_Factors:  [102.48758031]
mat_Sqrt:  [[0.15]]
grads:  [0.0944567]
Stock Position:  0.09445669515486912
Bond Position:  [-13.99918143]


portfolio before change:  [-4.19668146]
curr_Stock_Price:  103.7962418496968
curr_Factors:  [103.79624185]
mat_Sqrt:  [[0.15]]
grads:  [0.05617593]
Stock Position:  0.056175927108041264
Bond Position:  [-10.02753158]


portfolio before change:  [-4.25951816]
curr_Stock_Price:  102.69998624312359
curr_Factors:  [102.69998624]
mat_Sqrt:  [[0.15]]
grads:  [0.04244593]
Stock Position:  0.0424459250945771
Bond Position:  [-8.61871408]


portfolio before change:  [-4.24888996]
curr_Stock_Price:  102.97576323696175
curr_Factors:  [102.97576324]
mat_Sqrt:  [[0.15]]
grads:  [-0.03028962]
Stock Position:  -0.03028961997624326
Bond Position:  [-1.12979322]


portfolio before change:  [-4.25915005]
curr_Stock_Price:  103.30983336264734
curr_Factors:  [103.30983336]
mat_Sqrt:  [[0.15]]
grads:  [0.04556137]
Stock Position:  0.04556136900899993
Bond Position:  [-8.96608749]


portfolio before change:  [-4.29196585]
curr_Stock_Price:  102.61417883670754
curr_Factors:  [102.61417884]
mat_Sqrt:  [[0.15]]
grads:  [0.01633092]
Stock Position:  0.016330919728460364
Bond Position:  [-5.96774977]


portfolio before change:  [-4.29543415]
curr_Stock_Price:  102.44748348959541
curr_Factors:  [102.44748349]
mat_Sqrt:  [[0.15]]
grads:  [0.05850927]
Stock Position:  0.058509267116144556
Bond Position:  [-10.28956133]


portfolio before change:  [-4.31113605]
curr_Stock_Price:  102.20110159300444
curr_Factors:  [102.20110159]
mat_Sqrt:  [[0.15]]
grads:  [0.07780166]
Stock Position:  0.07780166474954885
Bond Position:  [-12.2625519]


portfolio before change:  [-4.29495348]
curr_Stock_Price:  102.42880216334285
curr_Factors:  [102.42880216]
mat_Sqrt:  [[0.15]]
grads:  [0.07675025]
Stock Position:  0.07675024923819254
Bond Position:  [-12.15638958]


portfolio before change:  [-4.22466653]
curr_Stock_Price:  103.3643899418558
curr_Factors:  [103.36438994]
mat_Sqrt:  [[0.15]]
grads:  [-0.10364709]
Stock Position:  -0.10364709294175731
Bond Position:  [6.488752]


portfolio before change:  [-4.24807844]
curr_Stock_Price:  103.59809695860766
curr_Factors:  [103.59809696]
mat_Sqrt:  [[0.15]]
grads:  [0.02357072]
Stock Position:  0.023570720777041875
Bond Position:  [-6.68996026]


portfolio before change:  [-4.25358127]
curr_Stock_Price:  103.40011680421591
curr_Factors:  [103.4001168]
mat_Sqrt:  [[0.15]]
grads:  [0.20064037]
Stock Position:  0.20064037463243214
Bond Position:  [-24.99981945]


portfolio before change:  [-4.325564]
curr_Stock_Price:  103.05692788235046
curr_Factors:  [103.05692788]
mat_Sqrt:  [[0.15]]
grads:  [-0.28049743]
Stock Position:  -0.28049742508960845
Bond Position:  [24.58163891]


portfolio before change:  [-4.36691095]
curr_Stock_Price:  103.21528887290327
curr_Factors:  [103.21528887]
mat_Sqrt:  [[0.15]]
grads:  [0.04420849]
Stock Position:  0.04420848562579783
Bond Position:  [-8.92990257]


portfolio before change:  [-4.37540405]
curr_Stock_Price:  103.04842524577025
curr_Factors:  [103.04842525]
mat_Sqrt:  [[0.15]]
grads:  [0.01010935]
Stock Position:  0.010109354206902904
Bond Position:  [-5.41715708]


portfolio before change:  [-4.37002369]
curr_Stock_Price:  103.64762765184419
curr_Factors:  [103.64762765]
mat_Sqrt:  [[0.15]]
grads:  [-0.07384752]
Stock Position:  -0.07384751890624704
Bond Position:  [3.28409646]


portfolio before change:  [-4.3845433]
curr_Stock_Price:  103.84980299533414
curr_Factors:  [103.849803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449619]
Stock Position:  -0.0044961874431721375
Bond Position:  [-3.91761512]


portfolio before change:  [-4.39037054]
curr_Stock_Price:  105.03692318681574
curr_Factors:  [105.03692319]
mat_Sqrt:  [[0.15]]
grads:  [-0.07522076]
Stock Position:  -0.0752207633868617
Bond Position:  [3.510587]


portfolio before change:  [-4.51139316]
curr_Stock_Price:  106.65165648664947
curr_Factors:  [106.65165649]
mat_Sqrt:  [[0.15]]
grads:  [0.44837868]
Stock Position:  0.44837868140359655
Bond Position:  [-52.33172227]


portfolio before change:  [-4.14251353]
curr_Stock_Price:  107.48894319301272
curr_Factors:  [107.48894319]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527791]
Stock Position:  -0.015277907362611264
Bond Position:  [-2.50030741]


portfolio before change:  [-4.1428694]
curr_Stock_Price:  107.49177796919987
curr_Factors:  [107.49177797]
mat_Sqrt:  [[0.15]]
grads:  [-0.08965233]
Stock Position:  -0.08965232640421827
Bond Position:  [5.49401857]


portfolio before change:  [-4.09167371]
curr_Stock_Price:  106.92839173460483
curr_Factors:  [106.92839173]
mat_Sqrt:  [[0.15]]
grads:  [0.02775031]
Stock Position:  0.027750312689660495
Bond Position:  [-7.05897002]


portfolio before change:  [-4.09184995]
curr_Stock_Price:  106.95383969148764
curr_Factors:  [106.95383969]
mat_Sqrt:  [[0.15]]
grads:  [0.04342397]
Stock Position:  0.043423970523815615
Bond Position:  [-8.73621033]


portfolio before change:  [-4.10315609]
curr_Stock_Price:  106.7186230808185
curr_Factors:  [106.71862308]
mat_Sqrt:  [[0.15]]
grads:  [0.00846138]
Stock Position:  0.008461379424594916
Bond Position:  [-5.00614285]


portfolio before change:  [-4.10107153]
curr_Stock_Price:  107.03894500754068
curr_Factors:  [107.03894501]
mat_Sqrt:  [[0.15]]
grads:  [0.05447586]
Stock Position:  0.05447585612800326
Bond Position:  [-9.9321097]


portfolio before change:  [-4.09897755]
curr_Stock_Price:  107.10017530385171
curr_Factors:  [107.1001753]
mat_Sqrt:  [[0.15]]
grads:  [0.02354911]
Stock Position:  0.023549111122939816
Bond Position:  [-6.62109148]


portfolio before change:  [-4.08006748]
curr_Stock_Price:  107.93832819409795
curr_Factors:  [107.93832819]
mat_Sqrt:  [[0.15]]
grads:  [-0.39143045]
Stock Position:  -0.3914304549629995
Bond Position:  [38.17028143]


portfolio before change:  [-4.23286903]
curr_Stock_Price:  108.34088536440034
curr_Factors:  [108.34088536]
mat_Sqrt:  [[0.15]]
grads:  [0.06187924]
Stock Position:  0.061879240931498145
Bond Position:  [-10.93692078]


portfolio before change:  [-4.13495262]
curr_Stock_Price:  109.94535896475901
curr_Factors:  [109.94535896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.13495262]
Stock Price:  110.78701241602977
PL:  [-14.92196504]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 9.01984514e-03]
 [-3.73099749e-03]
 [ 2.51936015e-03]
 [-2.92648734e-03]
 [ 1.54137262e-02]
 [ 1.85971718e-02]
 [ 6.07908360e-04]
 [ 2.33016147e-02]
 [-5.85929223e-03]
 [ 3.52136724e-04]
 [ 1.80312028e-03]
 [ 6.96533881e-03]
 [ 1.39044098e-02]
 [ 2.47890743e-03]
 [-1.22028794e-04]
 [-4.40490193e-03]
 [ 1.44054328e-02]
 [-5.08387725e-03]
 [ 5.80078842e-03]
 [-3.67191303e-03]
 [ 1.93975986e-02]
 [ 5.69031273e-03]
 [ 1.96310336e-02]
 [ 5.11600973e-03]
 [-5.45501277e-04]
 [-9.47761194e-03]
 [ 6.06052660e-03]
 [-1.13888396e-02]
 [-1.70476883e-02]
 [-8.53509004e-03]
 [-3.32322574e-03]
 [ 5.62426728e-03]
 [ 8.48432640e-03]
 [-1.27202439e-02]
 [ 3.17061586e-03]
 [ 5.70544738e-03]
 [ 3.57735930e-03]
 [ 1.09841764e-02]
 [-1.51747675e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.86785238]
curr_Stock_Price:  98.85043890151775
curr_Factors:  [98.8504389]
mat_Sqrt:  [[0.15]]
grads:  [0.0601323]
Stock Position:  0.060132300920389556
Bond Position:  [-21.81195672]


portfolio before change:  [-15.84175414]
curr_Stock_Price:  99.329797017648
curr_Factors:  [99.32979702]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487332]
Stock Position:  -0.024873316586951265
Bond Position:  [-13.37109265]


portfolio before change:  [-15.84653553]
curr_Stock_Price:  99.454826468656
curr_Factors:  [99.45482647]
mat_Sqrt:  [[0.15]]
grads:  [0.01679573]
Stock Position:  0.01679573433417419
Bond Position:  [-17.51695237]


portfolio before change:  [-15.83827743]
curr_Stock_Price:  100.07688060195949
curr_Factors:  [100.0768806]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950992]
Stock Position:  -0.019509915617225825
Bond Position:  [-13.88578593]


portfolio before change:  [-15.84535225]
curr_Stock_Price:  100.35053572543366
curr_Factors:  [100.35053573]
mat_Sqrt:  [[0.15]]
grads:  [0.10275817]
Stock Position:  0.10275817499717535
Bond Position:  [-26.15719016]


portfolio before change:  [-15.86899386]
curr_Stock_Price:  100.15228618500126
curr_Factors:  [100.15228619]
mat_Sqrt:  [[0.15]]
grads:  [0.12398115]
Stock Position:  0.12398114529202309
Bond Position:  [-28.28598901]


portfolio before change:  [-15.84722904]
curr_Stock_Price:  100.35635584907062
curr_Factors:  [100.35635585]
mat_Sqrt:  [[0.15]]
grads:  [0.00405272]
Stock Position:  0.004052722403203249
Bond Position:  [-16.25394549]


portfolio before change:  [-15.85256778]
curr_Stock_Price:  99.54039277007406
curr_Factors:  [99.54039277]
mat_Sqrt:  [[0.15]]
grads:  [0.1553441]
Stock Position:  0.1553440977450081
Bond Position:  [-31.31558029]


portfolio before change:  [-15.95009684]
curr_Stock_Price:  98.93776693371274
curr_Factors:  [98.93776693]
mat_Sqrt:  [[0.15]]
grads:  [-0.03906195]
Stock Position:  -0.039061948170829246
Bond Position:  [-12.08539492]


portfolio before change:  [-15.9211587]
curr_Stock_Price:  98.15826387747423
curr_Factors:  [98.15826388]
mat_Sqrt:  [[0.15]]
grads:  [0.00234758]
Stock Position:  0.002347578160594455
Bond Position:  [-16.1515929]


portfolio before change:  [-15.92131716]
curr_Stock_Price:  98.95083429242229
curr_Factors:  [98.95083429]
mat_Sqrt:  [[0.15]]
grads:  [0.0120208]
Stock Position:  0.012020801867257921
Bond Position:  [-17.11078553]


portfolio before change:  [-15.92808694]
curr_Stock_Price:  98.5656019075175
curr_Factors:  [98.56560191]
mat_Sqrt:  [[0.15]]
grads:  [0.04643559]
Stock Position:  0.0464355920794535
Bond Position:  [-20.50503903]


portfolio before change:  [-15.94243353]
curr_Stock_Price:  98.31184615389563
curr_Factors:  [98.31184615]
mat_Sqrt:  [[0.15]]
grads:  [0.09269607]
Stock Position:  0.09269606511095467
Bond Position:  [-25.05555482]


portfolio before change:  [-15.93782814]
curr_Stock_Price:  98.39531825798603
curr_Factors:  [98.39531826]
mat_Sqrt:  [[0.15]]
grads:  [0.01652605]
Stock Position:  0.016526049505944468
Bond Position:  [-17.56391404]


portfolio before change:  [-15.96074039]
curr_Stock_Price:  97.14174400720627
curr_Factors:  [97.14174401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081353]
Stock Position:  -0.0008135252937272082
Bond Position:  [-15.88171313]


portfolio before change:  [-15.96281476]
curr_Stock_Price:  97.25118058748815
curr_Factors:  [97.25118059]
mat_Sqrt:  [[0.15]]
grads:  [-0.02936601]
Stock Position:  -0.02936601287444507
Bond Position:  [-13.10693534]


portfolio before change:  [-15.9881817]
curr_Stock_Price:  98.0592055076682
curr_Factors:  [98.05920551]
mat_Sqrt:  [[0.15]]
grads:  [0.09603622]
Stock Position:  0.09603621875637482
Bond Position:  [-25.40541701]


portfolio before change:  [-15.92799892]
curr_Stock_Price:  98.71894263397888
curr_Factors:  [98.71894263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03389251]
Stock Position:  -0.033892514991918206
Bond Position:  [-12.58216567]


portfolio before change:  [-15.89286442]
curr_Stock_Price:  97.63589033260396
curr_Factors:  [97.63589033]
mat_Sqrt:  [[0.15]]
grads:  [0.03867192]
Stock Position:  0.038671922818865175
Bond Position:  [-19.66863203]


portfolio before change:  [-15.90167427]
curr_Stock_Price:  97.4716596066859
curr_Factors:  [97.47165961]
mat_Sqrt:  [[0.15]]
grads:  [-0.02447942]
Stock Position:  -0.024479420182143705
Bond Position:  [-13.51562456]


portfolio before change:  [-15.90477373]
curr_Stock_Price:  97.5292548125328
curr_Factors:  [97.52925481]
mat_Sqrt:  [[0.15]]
grads:  [0.12931732]
Stock Position:  0.12931732420531347
Bond Position:  [-28.51699599]


portfolio before change:  [-15.72812025]
curr_Stock_Price:  98.9228679812705
curr_Factors:  [98.92286798]
mat_Sqrt:  [[0.15]]
grads:  [0.03793542]
Stock Position:  0.037935418174499524
Bond Position:  [-19.48080061]


portfolio before change:  [-15.76122904]
curr_Stock_Price:  98.11429536465398
curr_Factors:  [98.11429536]
mat_Sqrt:  [[0.15]]
grads:  [0.13087356]
Stock Position:  0.13087355762383981
Bond Position:  [-28.60179593]


portfolio before change:  [-15.62050715]
curr_Stock_Price:  99.21686596212395
curr_Factors:  [99.21686596]
mat_Sqrt:  [[0.15]]
grads:  [0.03410673]
Stock Position:  0.03410673152280112
Bond Position:  [-19.00447016]


portfolio before change:  [-15.5992796]
curr_Stock_Price:  99.90890705487348
curr_Factors:  [99.90890705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363668]
Stock Position:  -0.0036366751768967627
Bond Position:  [-15.23594336]


portfolio before change:  [-15.60149547]
curr_Stock_Price:  99.99449710348213
curr_Factors:  [99.9944971]
mat_Sqrt:  [[0.15]]
grads:  [-0.06318408]
Stock Position:  -0.06318407962178567
Bond Position:  [-9.28343521]


portfolio before change:  [-15.59441819]
curr_Stock_Price:  99.86411959991443
curr_Factors:  [99.8641196]
mat_Sqrt:  [[0.15]]
grads:  [0.04040351]
Stock Position:  0.040403510682646124
Bond Position:  [-19.62927922]


portfolio before change:  [-15.57249093]
curr_Stock_Price:  100.46755907630809
curr_Factors:  [100.46755908]
mat_Sqrt:  [[0.15]]
grads:  [-0.0759256]
Stock Position:  -0.07592559724922023
Bond Position:  [-7.94443151]


portfolio before change:  [-15.61930165]
curr_Stock_Price:  101.07101308689677
curr_Factors:  [101.07101309]
mat_Sqrt:  [[0.15]]
grads:  [-0.11365126]
Stock Position:  -0.11365125546090857
Bond Position:  [-4.13245413]


portfolio before change:  [-15.57555138]
curr_Stock_Price:  100.68151571232603
curr_Factors:  [100.68151571]
mat_Sqrt:  [[0.15]]
grads:  [-0.0569006]
Stock Position:  -0.05690060026815144
Bond Position:  [-9.8467127]


portfolio before change:  [-15.5114982]
curr_Stock_Price:  99.53417988910115
curr_Factors:  [99.53417989]
mat_Sqrt:  [[0.15]]
grads:  [-0.02215484]
Stock Position:  -0.022154838235372447
Bond Position:  [-13.30633454]


portfolio before change:  [-15.47987468]
curr_Stock_Price:  98.03171285251489
curr_Factors:  [98.03171285]
mat_Sqrt:  [[0.15]]
grads:  [0.03749512]
Stock Position:  0.03749511520079151
Bond Position:  [-19.15558505]


portfolio before change:  [-15.48841802]
curr_Stock_Price:  97.86772495077227
curr_Factors:  [97.86772495]
mat_Sqrt:  [[0.15]]
grads:  [0.05656218]
Stock Position:  0.05656217599045533
Bond Position:  [-21.0240295]


portfolio before change:  [-15.49649736]
curr_Stock_Price:  97.77135007780278
curr_Factors:  [97.77135008]
mat_Sqrt:  [[0.15]]
grads:  [-0.08480163]
Stock Position:  -0.08480162629653307
Bond Position:  [-7.20532787]


portfolio before change:  [-15.46050728]
curr_Stock_Price:  97.33632531832116
curr_Factors:  [97.33632532]
mat_Sqrt:  [[0.15]]
grads:  [0.02113744]
Stock Position:  0.021137439037502658
Bond Position:  [-17.51794792]


portfolio before change:  [-15.45929096]
curr_Stock_Price:  97.49747080053938
curr_Factors:  [97.4974708]
mat_Sqrt:  [[0.15]]
grads:  [0.03803632]
Stock Position:  0.038036315850224336
Bond Position:  [-19.16773555]


portfolio before change:  [-15.4491903]
curr_Stock_Price:  97.82601923414857
curr_Factors:  [97.82601923]
mat_Sqrt:  [[0.15]]
grads:  [0.02384906]
Stock Position:  0.02384906203003481
Bond Position:  [-17.7822491]


portfolio before change:  [-15.44168141]
curr_Stock_Price:  98.23407769102789
curr_Factors:  [98.23407769]
mat_Sqrt:  [[0.15]]
grads:  [0.07322784]
Stock Position:  0.07322784297129048
Bond Position:  [-22.63515102]


portfolio before change:  [-15.43109669]
curr_Stock_Price:  98.4172633280484
curr_Factors:  [98.41726333]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.43109669]
Stock Price:  98.18248567022381
PL:  [-15.43109669]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.08957627e-02]
 [-4.43575394e-03]
 [-1.30962646e-02]
 [-5.25196650e-04]
 [ 1.39474650e-02]
 [ 2.18569158e-02]
 [ 8.55338272e-04]
 [ 1.76332719e-02]
 [-6.70126707e-03]
 [ 2.01427974e-03]
 [ 5.97067877e-03]
 [ 5.33284328e-03]
 [ 1.19313494e-02]
 [-5.36575458e-03]
 [ 2.08153760e-02]
 [ 2.16128387e-03]
 [ 9.00384727e-03]
 [ 1.06939404e-02]
 [ 1.19824066e-02]
 [-1.60652992e-02]
 [ 1.07560013e-02]
 [ 4.11364713e-02]
 [ 1.44481663e-02]
 [ 7.67905124e-03]
 [ 7.74178145e-03]
 [-2.15977877e-02]
 [ 3.28100934e-04]
 [-1.21115955e-02]
 [ 5.82980634e-02]
 [-3.00668168e-03]
 [-8.38679315e-03]
 [ 4.49402166e-03]
 [ 5.86709939e-03]
 [-8.92602214e-04]
 [ 7.30063971e-03]
 [ 4.53132109e-03]
 [-3.28873445e-02]
 [ 1.00786202e-02]
 [-8.91182994e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.89723299]
curr_Stock_Price:  98.52599673126309
curr_Factors:  [98.52599673]
mat_Sqrt:  [[0.15]]
grads:  [0.07263842]
Stock Position:  0.07263841778321345
Bond Position:  [-28.05400551]


portfolio before change:  [-20.84634652]
curr_Stock_Price:  99.27482147289614
curr_Factors:  [99.27482147]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957169]
Stock Position:  -0.029571692962464237
Bond Position:  [-17.91062198]


portfolio before change:  [-20.82708408]
curr_Stock_Price:  98.54772717161767
curr_Factors:  [98.54772717]
mat_Sqrt:  [[0.15]]
grads:  [-0.08730843]
Stock Position:  -0.08730843098684396
Bond Position:  [-12.22303664]


portfolio before change:  [-20.84907345]
curr_Stock_Price:  98.78208483481892
curr_Factors:  [98.78208483]
mat_Sqrt:  [[0.15]]
grads:  [-0.00350131]
Stock Position:  -0.003501311001810783
Bond Position:  [-20.50320665]


portfolio before change:  [-20.85608979]
curr_Stock_Price:  100.05397469418462
curr_Factors:  [100.05397469]
mat_Sqrt:  [[0.15]]
grads:  [0.0929831]
Stock Position:  0.09298310017452191
Bond Position:  [-30.15941855]


portfolio before change:  [-20.83036055]
curr_Stock_Price:  100.37123030018651
curr_Factors:  [100.3712303]
mat_Sqrt:  [[0.15]]
grads:  [0.14571277]
Stock Position:  0.14571277232816407
Bond Position:  [-35.45573078]


portfolio before change:  [-20.83400392]
curr_Stock_Price:  100.37664415649563
curr_Factors:  [100.37664416]
mat_Sqrt:  [[0.15]]
grads:  [0.00570226]
Stock Position:  0.00570225514395177
Bond Position:  [-21.40637716]


portfolio before change:  [-20.83483772]
curr_Stock_Price:  100.69970300437183
curr_Factors:  [100.699703]
mat_Sqrt:  [[0.15]]
grads:  [0.11755515]
Stock Position:  0.1175551461751938
Bond Position:  [-32.67260603]


portfolio before change:  [-20.81406753]
curr_Stock_Price:  100.91113166177769
curr_Factors:  [100.91113166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04467511]
Stock Position:  -0.04467511380412463
Bond Position:  [-16.30585124]


portfolio before change:  [-20.77945588]
curr_Stock_Price:  100.09076433689155
curr_Factors:  [100.09076434]
mat_Sqrt:  [[0.15]]
grads:  [0.01342853]
Stock Position:  0.013428531620534017
Bond Position:  [-22.12352788]


portfolio before change:  [-20.78501417]
curr_Stock_Price:  99.88279865938672
curr_Factors:  [99.88279866]
mat_Sqrt:  [[0.15]]
grads:  [0.03980453]
Stock Position:  0.03980452511378028
Bond Position:  [-24.76080154]


portfolio before change:  [-20.80616318]
curr_Stock_Price:  99.42923922973964
curr_Factors:  [99.42923923]
mat_Sqrt:  [[0.15]]
grads:  [0.03555229]
Stock Position:  0.03555228855704619
Bond Position:  [-24.34110019]


portfolio before change:  [-20.77245115]
curr_Stock_Price:  100.46306449072908
curr_Factors:  [100.46306449]
mat_Sqrt:  [[0.15]]
grads:  [0.07954233]
Stock Position:  0.07954232965390122
Bond Position:  [-28.76351735]


portfolio before change:  [-20.66808393]
curr_Stock_Price:  101.82036551025531
curr_Factors:  [101.82036551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0357717]
Stock Position:  -0.0357716972163641
Bond Position:  [-17.02579665]


portfolio before change:  [-20.6640513]
curr_Stock_Price:  101.64813470242188
curr_Factors:  [101.6481347]
mat_Sqrt:  [[0.15]]
grads:  [0.13876917]
Stock Position:  0.13876917318532353
Bond Position:  [-34.76967891]


portfolio before change:  [-20.60822369]
curr_Stock_Price:  102.08176192523351
curr_Factors:  [102.08176193]
mat_Sqrt:  [[0.15]]
grads:  [0.01440856]
Stock Position:  0.014408559154126704
Bond Position:  [-22.0790748]


portfolio before change:  [-20.59790765]
curr_Stock_Price:  102.98928514267892
curr_Factors:  [102.98928514]
mat_Sqrt:  [[0.15]]
grads:  [0.06002565]
Stock Position:  0.060025648496141615
Bond Position:  [-26.77990628]


portfolio before change:  [-20.61896735]
curr_Stock_Price:  102.69421119372606
curr_Factors:  [102.69421119]
mat_Sqrt:  [[0.15]]
grads:  [0.07129294]
Stock Position:  0.07129293619449784
Bond Position:  [-27.9403392]


portfolio before change:  [-20.50727099]
curr_Stock_Price:  104.30992698490218
curr_Factors:  [104.30992698]
mat_Sqrt:  [[0.15]]
grads:  [0.07988271]
Stock Position:  0.07988271068695987
Bond Position:  [-28.83983071]


portfolio before change:  [-20.54559223]
curr_Stock_Price:  103.87533941904738
curr_Factors:  [103.87533942]
mat_Sqrt:  [[0.15]]
grads:  [-0.10710199]
Stock Position:  -0.10710199441869589
Bond Position:  [-9.4203362]


portfolio before change:  [-20.67648429]
curr_Stock_Price:  105.0864695142753
curr_Factors:  [105.08646951]
mat_Sqrt:  [[0.15]]
grads:  [0.07170668]
Stock Position:  0.07170667551184416
Bond Position:  [-28.21188566]


portfolio before change:  [-20.62804374]
curr_Stock_Price:  105.81118942458167
curr_Factors:  [105.81118942]
mat_Sqrt:  [[0.15]]
grads:  [0.27424314]
Stock Position:  0.27424314188420174
Bond Position:  [-49.64603678]


portfolio before change:  [-20.49205153]
curr_Stock_Price:  106.32970139690991
curr_Factors:  [106.3297014]
mat_Sqrt:  [[0.15]]
grads:  [0.09632111]
Stock Position:  0.09632110861203039
Bond Position:  [-30.73384625]


portfolio before change:  [-20.56210356]
curr_Stock_Price:  105.6423124865932
curr_Factors:  [105.64231249]
mat_Sqrt:  [[0.15]]
grads:  [0.05119367]
Stock Position:  0.051193674926806765
Bond Position:  [-25.97032177]


portfolio before change:  [-20.5316883]
curr_Stock_Price:  106.29984988545915
curr_Factors:  [106.29984989]
mat_Sqrt:  [[0.15]]
grads:  [0.05161188]
Stock Position:  0.05161187630623654
Bond Position:  [-26.018023]


portfolio before change:  [-20.53918695]
curr_Stock_Price:  106.21757826064979
curr_Factors:  [106.21757826]
mat_Sqrt:  [[0.15]]
grads:  [-0.14398525]
Stock Position:  -0.14398525155663727
Bond Position:  [-5.24542222]


portfolio before change:  [-20.532827]
curr_Stock_Price:  106.16885336045155
curr_Factors:  [106.16885336]
mat_Sqrt:  [[0.15]]
grads:  [0.00218734]
Stock Position:  0.0021873395592397907
Bond Position:  [-20.76505433]


portfolio before change:  [-20.53620097]
curr_Stock_Price:  105.81309245437136
curr_Factors:  [105.81309245]
mat_Sqrt:  [[0.15]]
grads:  [-0.08074397]
Stock Position:  -0.08074396987382111
Bond Position:  [-11.99243182]


portfolio before change:  [-20.46384048]
curr_Stock_Price:  104.89835373749797
curr_Factors:  [104.89835374]
mat_Sqrt:  [[0.15]]
grads:  [0.38865376]
Stock Position:  0.38865375605607433
Bond Position:  [-61.23297966]


portfolio before change:  [-20.17262729]
curr_Stock_Price:  105.66733586502838
curr_Factors:  [105.66733587]
mat_Sqrt:  [[0.15]]
grads:  [-0.02004454]
Stock Position:  -0.02004454453374088
Bond Position:  [-18.05457367]


portfolio before change:  [-20.16844232]
curr_Stock_Price:  105.3459549738906
curr_Factors:  [105.34595497]
mat_Sqrt:  [[0.15]]
grads:  [-0.05591195]
Stock Position:  -0.05591195432678346
Bond Position:  [-14.27834409]


portfolio before change:  [-20.16617873]
curr_Stock_Price:  105.27354659027655
curr_Factors:  [105.27354659]
mat_Sqrt:  [[0.15]]
grads:  [0.02996014]
Stock Position:  0.029960144424018734
Bond Position:  [-23.32018939]


portfolio before change:  [-20.17557455]
curr_Stock_Price:  105.05723860951635
curr_Factors:  [105.05723861]
mat_Sqrt:  [[0.15]]
grads:  [0.039114]
Stock Position:  0.0391139959354936
Bond Position:  [-24.28478295]


portfolio before change:  [-20.15255203]
curr_Stock_Price:  105.7234529573303
curr_Factors:  [105.72345296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00595068]
Stock Position:  -0.00595068142645018
Bond Position:  [-19.52342545]


portfolio before change:  [-20.1524506]
curr_Stock_Price:  105.29627341247408
curr_Factors:  [105.29627341]
mat_Sqrt:  [[0.15]]
grads:  [0.04867093]
Stock Position:  0.048670931414181905
Bond Position:  [-25.27731831]


portfolio before change:  [-20.16764813]
curr_Stock_Price:  105.04894577266508
curr_Factors:  [105.04894577]
mat_Sqrt:  [[0.15]]
grads:  [0.03020881]
Stock Position:  0.03020880728576435
Bond Position:  [-23.34105149]


portfolio before change:  [-20.14915558]
curr_Stock_Price:  105.75769151250354
curr_Factors:  [105.75769151]
mat_Sqrt:  [[0.15]]
grads:  [-0.21924896]
Stock Position:  -0.21924896345360573
Bond Position:  [3.03810866]


portfolio before change:  [-19.89214324]
curr_Stock_Price:  104.58718402908316
curr_Factors:  [104.58718403]
mat_Sqrt:  [[0.15]]
grads:  [0.0671908]
Stock Position:  0.06719080142318865
Bond Position:  [-26.91943996]


portfolio before change:  [-19.81253742]
curr_Stock_Price:  105.82203996709674
curr_Factors:  [105.82203997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.81253742]
Stock Price:  106.47248962735064
PL:  [-26.28502705]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 2.65273254e-03]
 [ 4.65757167e-03]
 [-2.21350904e-03]
 [-2.36406210e-03]
 [ 9.04061916e-03]
 [ 2.06913560e-02]
 [-9.58348418e-04]
 [ 2.23010009e-02]
 [-5.89934076e-03]
 [ 4.36287182e-03]
 [ 6.17165009e-03]
 [ 4.48023570e-03]
 [ 1.12821587e-02]
 [ 4.25815210e-03]
 [ 6.72605906e-03]
 [-3.32360724e-03]
 [ 1.16149749e-02]
 [-3.98157932e-03]
 [ 9.10276809e-03]
 [-1.26820564e-02]
 [-1.51404858e-02]
 [ 1.71047849e-02]
 [-2.40115755e-02]
 [ 4.68311040e-03]
 [-3.93501558e-03]
 [-6.97723754e-03]
 [-1.06072503e-03]
 [-1.12759739e-02]
 [ 2.72837420e-02]
 [-1.01303113e-02]
 [-1.38669186e-04]
 [ 5.18384961e-03]
 [ 5.10965168e-03]
 [-4.97037178e-03]
 [ 9.19861154e-03]
 [ 5.16211465e-03]
 [-1.99667403e-02]
 [ 1.00076712e-02]
 [-1.07467761e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.55523646]
curr_Stock_Price:  99.77373672539636
curr_Factors:  [99.77373673]
mat_Sqrt:  [[0.15]]
grads:  [0.01768488]
Stock Position:  0.01768488363313541
Bond Position:  [-3.31972338]


portfolio before change:  [-1.54908505]
curr_Stock_Price:  100.14503686130585
curr_Factors:  [100.14503686]
mat_Sqrt:  [[0.15]]
grads:  [0.03105048]
Stock Position:  0.031050477787724236
Bond Position:  [-4.65863629]


portfolio before change:  [-1.57740259]
curr_Stock_Price:  99.25180846251487
curr_Factors:  [99.25180846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475673]
Stock Position:  -0.014756726944759232
Bond Position:  [-0.11277075]


portfolio before change:  [-1.57815138]
curr_Stock_Price:  99.3015958949523
curr_Factors:  [99.30159589]
mat_Sqrt:  [[0.15]]
grads:  [-0.01576041]
Stock Position:  -0.01576041402352712
Bond Position:  [-0.01311712]


portfolio before change:  [-1.57875147]
curr_Stock_Price:  99.33956734610801
curr_Factors:  [99.33956735]
mat_Sqrt:  [[0.15]]
grads:  [0.06027079]
Stock Position:  0.06027079439876339
Bond Position:  [-7.56602611]


portfolio before change:  [-1.52217971]
curr_Stock_Price:  100.29388643568937
curr_Factors:  [100.29388644]
mat_Sqrt:  [[0.15]]
grads:  [0.13794237]
Stock Position:  0.13794237340600055
Bond Position:  [-15.35695644]


portfolio before change:  [-1.46536772]
curr_Stock_Price:  100.71965649057117
curr_Factors:  [100.71965649]
mat_Sqrt:  [[0.15]]
grads:  [-0.00638899]
Stock Position:  -0.006388989454539403
Bond Position:  [-0.82187089]


portfolio before change:  [-1.46050466]
curr_Stock_Price:  99.94241348643374
curr_Factors:  [99.94241349]
mat_Sqrt:  [[0.15]]
grads:  [0.14867334]
Stock Position:  0.1486733394738101
Bond Position:  [-16.31927703]


portfolio before change:  [-1.50518421]
curr_Stock_Price:  99.65561352307469
curr_Factors:  [99.65561352]
mat_Sqrt:  [[0.15]]
grads:  [-0.03932894]
Stock Position:  -0.039328938383723956
Bond Position:  [2.41416528]


portfolio before change:  [-1.48110113]
curr_Stock_Price:  99.05093708381061
curr_Factors:  [99.05093708]
mat_Sqrt:  [[0.15]]
grads:  [0.02908581]
Stock Position:  0.029085812117766622
Bond Position:  [-4.36207808]


portfolio before change:  [-1.45671138]
curr_Stock_Price:  99.90822965474761
curr_Factors:  [99.90822965]
mat_Sqrt:  [[0.15]]
grads:  [0.04114433]
Stock Position:  0.04114433393551523
Bond Position:  [-5.56736894]


portfolio before change:  [-1.46231959]
curr_Stock_Price:  99.78883901522474
curr_Factors:  [99.78883902]
mat_Sqrt:  [[0.15]]
grads:  [0.02986824]
Stock Position:  0.02986823801675604
Bond Position:  [-4.44283639]


portfolio before change:  [-1.46040516]
curr_Stock_Price:  99.87152938911305
curr_Factors:  [99.87152939]
mat_Sqrt:  [[0.15]]
grads:  [0.07521439]
Stock Position:  0.07521439161338421
Bond Position:  [-8.97218149]


portfolio before change:  [-1.51709116]
curr_Stock_Price:  99.1327824307222
curr_Factors:  [99.13278243]
mat_Sqrt:  [[0.15]]
grads:  [0.02838768]
Stock Position:  0.028387680673028767
Bond Position:  [-4.33124093]


portfolio before change:  [-1.53200506]
curr_Stock_Price:  98.62649018670257
curr_Factors:  [98.62649019]
mat_Sqrt:  [[0.15]]
grads:  [0.04484039]
Stock Position:  0.0448403937356707
Bond Position:  [-5.95445571]


portfolio before change:  [-1.52889122]
curr_Stock_Price:  98.71253311657985
curr_Factors:  [98.71253312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02215738]
Stock Position:  -0.022157381587179146
Bond Position:  [0.65832005]


portfolio before change:  [-1.53836366]
curr_Stock_Price:  99.14375460231736
curr_Factors:  [99.1437546]
mat_Sqrt:  [[0.15]]
grads:  [0.07743317]
Stock Position:  0.07743316569578947
Bond Position:  [-9.21537844]


portfolio before change:  [-1.56276032]
curr_Stock_Price:  98.84356451625739
curr_Factors:  [98.84356452]
mat_Sqrt:  [[0.15]]
grads:  [-0.02654386]
Stock Position:  -0.026543862122300546
Bond Position:  [1.06092963]


portfolio before change:  [-1.56465947]
curr_Stock_Price:  98.92010840052518
curr_Factors:  [98.9201084]
mat_Sqrt:  [[0.15]]
grads:  [0.06068512]
Stock Position:  0.060685120611463216
Bond Position:  [-7.56763818]


portfolio before change:  [-1.49868126]
curr_Stock_Price:  100.02291943410853
curr_Factors:  [100.02291943]
mat_Sqrt:  [[0.15]]
grads:  [-0.08454704]
Stock Position:  -0.08454704276116574
Bond Position:  [6.95796078]


portfolio before change:  [-1.53655713]
curr_Stock_Price:  100.48119295130599
curr_Factors:  [100.48119295]
mat_Sqrt:  [[0.15]]
grads:  [-0.10093657]
Stock Position:  -0.10093657177334034
Bond Position:  [8.60567001]


portfolio before change:  [-1.53355927]
curr_Stock_Price:  100.46215040273158
curr_Factors:  [100.4621504]
mat_Sqrt:  [[0.15]]
grads:  [0.1140319]
Stock Position:  0.1140318990618503
Bond Position:  [-12.98944906]


portfolio before change:  [-1.41816322]
curr_Stock_Price:  101.48835301141176
curr_Factors:  [101.48835301]
mat_Sqrt:  [[0.15]]
grads:  [-0.16007717]
Stock Position:  -0.1600771701492307
Bond Position:  [14.82780514]


portfolio before change:  [-1.49505772]
curr_Stock_Price:  101.9802913459235
curr_Factors:  [101.98029135]
mat_Sqrt:  [[0.15]]
grads:  [0.03122074]
Stock Position:  0.031220736023371793
Bond Position:  [-4.67895748]


portfolio before change:  [-1.48541134]
curr_Stock_Price:  102.30799959164965
curr_Factors:  [102.30799959]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623344]
Stock Position:  -0.026233437218587015
Bond Position:  [1.19847915]


portfolio before change:  [-1.49524409]
curr_Stock_Price:  102.68852813572825
curr_Factors:  [102.68852814]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651492]
Stock Position:  -0.04651491693189098
Bond Position:  [3.28130427]


portfolio before change:  [-1.47401532]
curr_Stock_Price:  102.24096037316697
curr_Factors:  [102.24096037]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070715]
Stock Position:  -0.007071500201633516
Bond Position:  [-0.75101835]


portfolio before change:  [-1.47192151]
curr_Stock_Price:  101.9315922233947
curr_Factors:  [101.93159222]
mat_Sqrt:  [[0.15]]
grads:  [-0.07517316]
Stock Position:  -0.07517315909820449
Bond Position:  [6.19059829]


portfolio before change:  [-1.50029941]
curr_Stock_Price:  102.31938718700238
curr_Factors:  [102.31938719]
mat_Sqrt:  [[0.15]]
grads:  [0.18189161]
Stock Position:  0.18189161303870982
Bond Position:  [-20.11133779]


portfolio before change:  [-1.47762579]
curr_Stock_Price:  102.45786359559308
curr_Factors:  [102.4578636]
mat_Sqrt:  [[0.15]]
grads:  [-0.06753541]
Stock Position:  -0.06753540859358462
Bond Position:  [5.4419079]


portfolio before change:  [-1.43674068]
curr_Stock_Price:  101.8625489044338
curr_Factors:  [101.8625489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00092446]
Stock Position:  -0.0009244612373566344
Bond Position:  [-1.34257271]


portfolio before change:  [-1.43646375]
curr_Stock_Price:  101.38144508870973
curr_Factors:  [101.38144509]
mat_Sqrt:  [[0.15]]
grads:  [0.034559]
Stock Position:  0.03455899743218866
Bond Position:  [-4.94010485]


portfolio before change:  [-1.42740673]
curr_Stock_Price:  101.66138878397221
curr_Factors:  [101.66138878]
mat_Sqrt:  [[0.15]]
grads:  [0.03406434]
Stock Position:  0.03406434455486305
Bond Position:  [-4.89043531]


portfolio before change:  [-1.39668987]
curr_Stock_Price:  102.58106598960038
curr_Factors:  [102.58106599]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313581]
Stock Position:  -0.03313581184226612
Bond Position:  [2.00241703]


portfolio before change:  [-1.4221766]
curr_Stock_Price:  103.35777972039205
curr_Factors:  [103.35777972]
mat_Sqrt:  [[0.15]]
grads:  [0.06132408]
Stock Position:  0.0613240769326568
Bond Position:  [-7.76049703]


portfolio before change:  [-1.43042379]
curr_Stock_Price:  103.2391139770574
curr_Factors:  [103.23911398]
mat_Sqrt:  [[0.15]]
grads:  [0.0344141]
Stock Position:  0.03441409765862389
Bond Position:  [-4.98330474]


portfolio before change:  [-1.38522868]
curr_Stock_Price:  104.57048864665065
curr_Factors:  [104.57048865]
mat_Sqrt:  [[0.15]]
grads:  [-0.1331116]
Stock Position:  -0.1331116018065556
Bond Position:  [12.53431657]


portfolio before change:  [-1.43037887]
curr_Stock_Price:  104.9214503560381
curr_Factors:  [104.92145036]
mat_Sqrt:  [[0.15]]
grads:  [0.06671781]
Stock Position:  0.06671780806081008
Bond Position:  [-8.43050805]


portfolio before change:  [-1.41996688]
curr_Stock_Price:  105.09330647779271
curr_Factors:  [105.09330648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.41996688]
Stock Price:  106.25657299184597
PL:  [-7.67653988]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 7.32929908e-03]
 [-6.86498559e-03]
 [-1.58833819e-02]
 [-2.48930830e-03]
 [ 1.27351467e-02]
 [ 9.99976469e-04]
 [-1.31388018e-02]
 [ 2.29072173e-02]
 [-5.90928443e-03]
 [ 4.43486610e-03]
 [ 1.28920037e-03]
 [ 6.40509504e-03]
 [ 1.44566029e-02]
 [ 4.30391812e-03]
 [ 2.26234235e-02]
 [ 7.37489659e-04]
 [ 9.42772625e-03]
 [ 1.35926132e-02]
 [ 1.15381321e-02]
 [-1.25963020e-02]
 [-1.92185688e-03]
 [ 5.38545350e-03]
 [ 1.42104381e-02]
 [ 5.18249654e-03]
 [ 3.92771341e-03]
 [-8.31692068e-03]
 [ 1.86264935e-03]
 [-1.11654582e-02]
 [-1.86228103e-02]
 [-8.74581532e-03]
 [-2.40421608e-03]
 [ 5.37614245e-03]
 [ 5.11556315e-03]
 [-1.19201630e-02]
 [ 1.79726332e-02]
 [ 5.71528275e-03]
 [ 3.43112839e-03]
 [ 1.06946874e-02]
 [-1.45942810e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.12939425]
curr_Stock_Price:  99.09160447717369
curr_Factors:  [99.09160448]
mat_Sqrt:  [[0.15]]
grads:  [0.04886199]
Stock Position:  0.04886199389060467
Bond Position:  [-16.97120762]


portfolio before change:  [-12.13127009]
curr_Stock_Price:  99.0966328174362
curr_Factors:  [99.09663282]
mat_Sqrt:  [[0.15]]
grads:  [-0.04576657]
Stock Position:  -0.04576657057079875
Bond Position:  [-7.59595705]


portfolio before change:  [-12.09741361]
curr_Stock_Price:  98.33612069727819
curr_Factors:  [98.3361207]
mat_Sqrt:  [[0.15]]
grads:  [-0.10588921]
Stock Position:  -0.10588921292311503
Bond Position:  [-1.68467919]


portfolio before change:  [-12.25230085]
curr_Stock_Price:  99.79686096091241
curr_Factors:  [99.79686096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01659539]
Stock Position:  -0.01659538865646914
Bond Position:  [-10.59613315]


portfolio before change:  [-12.25451779]
curr_Stock_Price:  99.85063134341533
curr_Factors:  [99.85063134]
mat_Sqrt:  [[0.15]]
grads:  [0.08490098]
Stock Position:  0.08490097801869641
Bond Position:  [-20.73193404]


portfolio before change:  [-12.29398578]
curr_Stock_Price:  99.41628608837998
curr_Factors:  [99.41628609]
mat_Sqrt:  [[0.15]]
grads:  [0.00666651]
Stock Position:  0.006666509790194704
Bond Position:  [-12.95674542]


portfolio before change:  [-12.29659648]
curr_Stock_Price:  99.26763131065162
curr_Factors:  [99.26763131]
mat_Sqrt:  [[0.15]]
grads:  [-0.08759201]
Stock Position:  -0.08759201195011548
Bond Position:  [-3.60154493]


portfolio before change:  [-12.34090688]
curr_Stock_Price:  99.768363965599
curr_Factors:  [99.76836397]
mat_Sqrt:  [[0.15]]
grads:  [0.15271478]
Stock Position:  0.15271478169609393
Bond Position:  [-27.5770108]


portfolio before change:  [-12.35062673]
curr_Stock_Price:  99.72729064054722
curr_Factors:  [99.72729064]
mat_Sqrt:  [[0.15]]
grads:  [-0.03939523]
Stock Position:  -0.039395229514341955
Bond Position:  [-8.42184722]


portfolio before change:  [-12.34262246]
curr_Stock_Price:  99.49738800803779
curr_Factors:  [99.49738801]
mat_Sqrt:  [[0.15]]
grads:  [0.02956577]
Stock Position:  0.029565773973066995
Bond Position:  [-15.28433974]


portfolio before change:  [-12.36441559]
curr_Stock_Price:  98.82490524379497
curr_Factors:  [98.82490524]
mat_Sqrt:  [[0.15]]
grads:  [0.00859467]
Stock Position:  0.008594669135226886
Bond Position:  [-13.21378296]


portfolio before change:  [-12.36518174]
curr_Stock_Price:  98.92795456259051
curr_Factors:  [98.92795456]
mat_Sqrt:  [[0.15]]
grads:  [0.04270063]
Stock Position:  0.042700633593778764
Bond Position:  [-16.58946808]


portfolio before change:  [-12.34507501]
curr_Stock_Price:  99.4473975900289
curr_Factors:  [99.44739759]
mat_Sqrt:  [[0.15]]
grads:  [0.09637735]
Stock Position:  0.09637735248264055
Bond Position:  [-21.9295519]


portfolio before change:  [-12.37649715]
curr_Stock_Price:  99.1498092248628
curr_Factors:  [99.14980922]
mat_Sqrt:  [[0.15]]
grads:  [0.02869279]
Stock Position:  0.02869278743637592
Bond Position:  [-15.22138155]


portfolio before change:  [-12.33423599]
curr_Stock_Price:  100.68900978653984
curr_Factors:  [100.68900979]
mat_Sqrt:  [[0.15]]
grads:  [0.15082282]
Stock Position:  0.15082282345982032
Bond Position:  [-27.52043674]


portfolio before change:  [-12.34704129]
curr_Stock_Price:  100.62691684331125
curr_Factors:  [100.62691684]
mat_Sqrt:  [[0.15]]
grads:  [0.0049166]
Stock Position:  0.0049165977241345405
Bond Position:  [-12.84178336]


portfolio before change:  [-12.34932825]
curr_Stock_Price:  100.48827866270567
curr_Factors:  [100.48827866]
mat_Sqrt:  [[0.15]]
grads:  [0.06285151]
Stock Position:  0.06285150832216475
Bond Position:  [-18.66516813]


portfolio before change:  [-12.32868358]
curr_Stock_Price:  100.85386986912145
curr_Factors:  [100.85386987]
mat_Sqrt:  [[0.15]]
grads:  [0.09061742]
Stock Position:  0.09061742118316181
Bond Position:  [-21.46780118]


portfolio before change:  [-12.37639129]
curr_Stock_Price:  100.35701099924653
curr_Factors:  [100.357011]
mat_Sqrt:  [[0.15]]
grads:  [0.07692088]
Stock Position:  0.07692088039940764
Bond Position:  [-20.09594093]


portfolio before change:  [-12.41158551]
curr_Stock_Price:  99.93213200689073
curr_Factors:  [99.93213201]
mat_Sqrt:  [[0.15]]
grads:  [-0.08397535]
Stock Position:  -0.0839753464220561
Bond Position:  [-4.0197501]


portfolio before change:  [-12.39502487]
curr_Stock_Price:  99.72893982577972
curr_Factors:  [99.72893983]
mat_Sqrt:  [[0.15]]
grads:  [-0.01281238]
Stock Position:  -0.012812379170848986
Bond Position:  [-11.11725988]


portfolio before change:  [-12.38560745]
curr_Stock_Price:  98.88544572504378
curr_Factors:  [98.88544573]
mat_Sqrt:  [[0.15]]
grads:  [0.03590302]
Stock Position:  0.03590302332417352
Bond Position:  [-15.93589392]


portfolio before change:  [-12.36762532]
curr_Stock_Price:  99.44178435254743
curr_Factors:  [99.44178435]
mat_Sqrt:  [[0.15]]
grads:  [0.09473625]
Stock Position:  0.09473625384405326
Bond Position:  [-21.78836745]


portfolio before change:  [-12.35249551]
curr_Stock_Price:  99.63023949090572
curr_Factors:  [99.63023949]
mat_Sqrt:  [[0.15]]
grads:  [0.03454998]
Stock Position:  0.03454997695139832
Bond Position:  [-15.79471798]


portfolio before change:  [-12.35945058]
curr_Stock_Price:  99.48608269417399
curr_Factors:  [99.48608269]
mat_Sqrt:  [[0.15]]
grads:  [0.02618476]
Stock Position:  0.026184756048107886
Bond Position:  [-14.96446939]


portfolio before change:  [-12.33278034]
curr_Stock_Price:  100.57606474803003
curr_Factors:  [100.57606475]
mat_Sqrt:  [[0.15]]
grads:  [-0.05544614]
Stock Position:  -0.05544613789400824
Bond Position:  [-6.75622599]


portfolio before change:  [-12.35346467]
curr_Stock_Price:  100.93388478799685
curr_Factors:  [100.93388479]
mat_Sqrt:  [[0.15]]
grads:  [0.01241766]
Stock Position:  0.012417662340469173
Bond Position:  [-13.60682757]


portfolio before change:  [-12.3550108]
curr_Stock_Price:  100.94635317281201
curr_Factors:  [100.94635317]
mat_Sqrt:  [[0.15]]
grads:  [-0.07443639]
Stock Position:  -0.07443638822970401
Bond Position:  [-4.84092886]


portfolio before change:  [-12.34559953]
curr_Stock_Price:  100.81178966467262
curr_Factors:  [100.81178966]
mat_Sqrt:  [[0.15]]
grads:  [-0.12415207]
Stock Position:  -0.12415206873925065
Bond Position:  [0.17039271]


portfolio before change:  [-12.34119542]
curr_Stock_Price:  100.7764877503196
curr_Factors:  [100.77648775]
mat_Sqrt:  [[0.15]]
grads:  [-0.05830544]
Stock Position:  -0.05830543547454226
Bond Position:  [-6.46537842]


portfolio before change:  [-12.31844893]
curr_Stock_Price:  100.372499392829
curr_Factors:  [100.37249939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01602811]
Stock Position:  -0.016028107214999553
Bond Position:  [-10.70966775]


portfolio before change:  [-12.31523642]
curr_Stock_Price:  100.08854194031805
curr_Factors:  [100.08854194]
mat_Sqrt:  [[0.15]]
grads:  [0.03584095]
Stock Position:  0.03584094965668371
Bond Position:  [-15.90250481]


portfolio before change:  [-12.29323766]
curr_Stock_Price:  100.75779579004663
curr_Factors:  [100.75779579]
mat_Sqrt:  [[0.15]]
grads:  [0.03410375]
Stock Position:  0.03410375430973378
Bond Position:  [-15.72945678]


portfolio before change:  [-12.34369318]
curr_Stock_Price:  99.3359813181753
curr_Factors:  [99.33598132]
mat_Sqrt:  [[0.15]]
grads:  [-0.07946775]
Stock Position:  -0.07946775305465135
Bond Position:  [-4.44968595]


portfolio before change:  [-12.38972432]
curr_Stock_Price:  99.90822471987381
curr_Factors:  [99.90822472]
mat_Sqrt:  [[0.15]]
grads:  [0.11981755]
Stock Position:  0.11981755454983761
Bond Position:  [-24.36048349]


portfolio before change:  [-12.52378277]
curr_Stock_Price:  98.8147856166726
curr_Factors:  [98.81478562]
mat_Sqrt:  [[0.15]]
grads:  [0.03810189]
Stock Position:  0.038101885017655636
Bond Position:  [-16.28881237]


portfolio before change:  [-12.53689829]
curr_Stock_Price:  98.52400515619772
curr_Factors:  [98.52400516]
mat_Sqrt:  [[0.15]]
grads:  [0.02287419]
Stock Position:  0.02287418924732333
Bond Position:  [-14.79055503]


portfolio before change:  [-12.54097656]
curr_Stock_Price:  98.42654429783904
curr_Factors:  [98.4265443]
mat_Sqrt:  [[0.15]]
grads:  [0.07129792]
Stock Position:  0.07129791587559765
Bond Position:  [-19.55858403]


portfolio before change:  [-12.56742685]
curr_Stock_Price:  98.08985406454558
curr_Factors:  [98.08985406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.56742685]
Stock Price:  98.50876492625018
PL:  [-12.56742685]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 3.26164569e-03]
 [-7.13667861e-03]
 [-1.33543925e-02]
 [ 5.40837827e-03]
 [-7.70250129e-02]
 [-3.46838318e-02]
 [-2.25344312e-02]
 [ 1.09782785e-03]
 [-6.67333766e-03]
 [ 3.21140738e-02]
 [-2.04729126e-02]
 [ 7.73361351e-03]
 [ 1.38677535e-02]
 [-2.61041882e-03]
 [-1.11516115e-02]
 [-7.65369711e-03]
 [ 2.14252243e-02]
 [-2.92401697e-02]
 [ 5.01005168e-04]
 [ 1.13819776e-02]
 [ 2.89912179e-02]
 [ 2.23544648e-03]
 [ 3.22784712e-02]
 [-9.82722972e-04]
 [ 8.20844195e-03]
 [ 2.57589198e-02]
 [ 3.81659055e-02]
 [-3.05163369e-02]
 [-4.68686010e-02]
 [ 3.83160877e-03]
 [-4.24786570e-03]
 [ 5.59177501e-03]
 [ 1.95436647e-02]
 [-1.43910312e-02]
 [ 4.48352298e-03]
 [ 3.71562866e-03]
 [ 8.85310365e-03]
 [ 7.98365829e-03]
 [-6.89110724e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.85084005]
curr_Stock_Price:  99.69015815535036
curr_Factors:  [99.69015816]
mat_Sqrt:  [[0.15]]
grads:  [0.0217443]
Stock Position:  0.021744304590187804
Bond Position:  [-5.01853321]


portfolio before change:  [-2.86479515]
curr_Stock_Price:  99.07722785336628
curr_Factors:  [99.07722785]
mat_Sqrt:  [[0.15]]
grads:  [-0.04757786]
Stock Position:  -0.047577857431727905
Bond Position:  [1.84908708]


portfolio before change:  [-2.83843906]
curr_Stock_Price:  98.52812931142964
curr_Factors:  [98.52812931]
mat_Sqrt:  [[0.15]]
grads:  [-0.08902928]
Stock Position:  -0.0890292836578601
Bond Position:  [5.93344971]


portfolio before change:  [-2.76505425]
curr_Stock_Price:  97.71218336516041
curr_Factors:  [97.71218337]
mat_Sqrt:  [[0.15]]
grads:  [0.03605586]
Stock Position:  0.036055855148968426
Bond Position:  [-6.28815058]


portfolio before change:  [-2.81121758]
curr_Stock_Price:  96.45365667141397
curr_Factors:  [96.45365667]
mat_Sqrt:  [[0.15]]
grads:  [-0.51350009]
Stock Position:  -0.5135000858473879
Bond Position:  [46.7177434]


portfolio before change:  [-2.80468666]
curr_Stock_Price:  96.45231132051359
curr_Factors:  [96.45231132]
mat_Sqrt:  [[0.15]]
grads:  [-0.23122555]
Stock Position:  -0.2312255456384089
Bond Position:  [19.49755166]


portfolio before change:  [-2.50585574]
curr_Stock_Price:  95.1704738543374
curr_Factors:  [95.17047385]
mat_Sqrt:  [[0.15]]
grads:  [-0.15022954]
Stock Position:  -0.15022954108150852
Bond Position:  [11.79156087]


portfolio before change:  [-2.43325727]
curr_Stock_Price:  94.69703542989032
curr_Factors:  [94.69703543]
mat_Sqrt:  [[0.15]]
grads:  [0.00731885]
Stock Position:  0.007318852318754093
Bond Position:  [-3.12633088]


portfolio before change:  [-2.4445942]
curr_Stock_Price:  93.20142981304967
curr_Factors:  [93.20142981]
mat_Sqrt:  [[0.15]]
grads:  [-0.04448892]
Stock Position:  -0.04448891773025615
Bond Position:  [1.70183654]


portfolio before change:  [-2.43572321]
curr_Stock_Price:  93.00681389596703
curr_Factors:  [93.0068139]
mat_Sqrt:  [[0.15]]
grads:  [0.21409383]
Stock Position:  0.21409382550879472
Bond Position:  [-22.34790779]


portfolio before change:  [-2.28399325]
curr_Stock_Price:  93.72857042014874
curr_Factors:  [93.72857042]
mat_Sqrt:  [[0.15]]
grads:  [-0.13648608]
Stock Position:  -0.13648608385162586
Bond Position:  [10.50865227]


portfolio before change:  [-2.42600489]
curr_Stock_Price:  94.77867967415017
curr_Factors:  [94.77867967]
mat_Sqrt:  [[0.15]]
grads:  [0.05155742]
Stock Position:  0.051557423388900105
Bond Position:  [-7.31254941]


portfolio before change:  [-2.41557606]
curr_Stock_Price:  94.9986858720462
curr_Factors:  [94.99868587]
mat_Sqrt:  [[0.15]]
grads:  [0.09245169]
Stock Position:  0.09245169025026034
Bond Position:  [-11.19836514]


portfolio before change:  [-2.44606306]
curr_Stock_Price:  94.68406623741375
curr_Factors:  [94.68406624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01740279]
Stock Position:  -0.01740279215710543
Bond Position:  [-0.79829594]


portfolio before change:  [-2.44146453]
curr_Stock_Price:  94.41409108788665
curr_Factors:  [94.41409109]
mat_Sqrt:  [[0.15]]
grads:  [-0.07434408]
Stock Position:  -0.07434407675586056
Bond Position:  [4.5776639]


portfolio before change:  [-2.56514909]
curr_Stock_Price:  96.08546569087382
curr_Factors:  [96.08546569]
mat_Sqrt:  [[0.15]]
grads:  [-0.05102465]
Stock Position:  -0.05102464737350948
Bond Position:  [2.33757791]


portfolio before change:  [-2.52692749]
curr_Stock_Price:  95.34211139015977
curr_Factors:  [95.34211139]
mat_Sqrt:  [[0.15]]
grads:  [0.14283483]
Stock Position:  0.1428348289630192
Bond Position:  [-16.14510166]


portfolio before change:  [-2.53615781]
curr_Stock_Price:  95.29161907406093
curr_Factors:  [95.29161907]
mat_Sqrt:  [[0.15]]
grads:  [-0.19493446]
Stock Position:  -0.19493446465598846
Bond Position:  [16.03946294]


portfolio before change:  [-2.34962412]
curr_Stock_Price:  94.3450002395721
curr_Factors:  [94.34500024]
mat_Sqrt:  [[0.15]]
grads:  [0.00334003]
Stock Position:  0.0033400344512052433
Bond Position:  [-2.66473967]


portfolio before change:  [-2.35300371]
curr_Stock_Price:  93.43289046666297
curr_Factors:  [93.43289047]
mat_Sqrt:  [[0.15]]
grads:  [0.07587985]
Stock Position:  0.07587985043237355
Bond Position:  [-9.44267746]


portfolio before change:  [-2.37317584]
curr_Stock_Price:  93.18260373971829
curr_Factors:  [93.18260374]
mat_Sqrt:  [[0.15]]
grads:  [0.19327479]
Stock Position:  0.19327478583784097
Bond Position:  [-20.38302362]


portfolio before change:  [-2.45537046]
curr_Stock_Price:  92.77051385837287
curr_Factors:  [92.77051386]
mat_Sqrt:  [[0.15]]
grads:  [0.01490298]
Stock Position:  0.014902976502116916
Bond Position:  [-3.83792724]


portfolio before change:  [-2.44700098]
curr_Stock_Price:  93.36430434173775
curr_Factors:  [93.36430434]
mat_Sqrt:  [[0.15]]
grads:  [0.21518981]
Stock Position:  0.21518980775879235
Bond Position:  [-22.53804768]


portfolio before change:  [-2.40173522]
curr_Stock_Price:  93.58774985536897
curr_Factors:  [93.58774986]
mat_Sqrt:  [[0.15]]
grads:  [-0.00655149]
Stock Position:  -0.006551486477465434
Bond Position:  [-1.78859634]


portfolio before change:  [-2.39861043]
curr_Stock_Price:  93.07666327688592
curr_Factors:  [93.07666328]
mat_Sqrt:  [[0.15]]
grads:  [0.05472295]
Stock Position:  0.05472294633019944
Bond Position:  [-7.49203968]


portfolio before change:  [-2.42785039]
curr_Stock_Price:  92.55945061403895
curr_Factors:  [92.55945061]
mat_Sqrt:  [[0.15]]
grads:  [0.17172613]
Stock Position:  0.17172613198794426
Bond Position:  [-18.32272683]


portfolio before change:  [-2.49493276]
curr_Stock_Price:  92.18215286774684
curr_Factors:  [92.18215287]
mat_Sqrt:  [[0.15]]
grads:  [0.25443937]
Stock Position:  0.25443936999006944
Bond Position:  [-25.94970166]


portfolio before change:  [-2.74970856]
curr_Stock_Price:  91.1935798837754
curr_Factors:  [91.19357988]
mat_Sqrt:  [[0.15]]
grads:  [-0.20344225]
Stock Position:  -0.20344224576661538
Bond Position:  [15.80291813]


portfolio before change:  [-2.57552233]
curr_Stock_Price:  90.34709519778104
curr_Factors:  [90.3470952]
mat_Sqrt:  [[0.15]]
grads:  [-0.31245734]
Stock Position:  -0.31245734000977965
Bond Position:  [25.65409071]


portfolio before change:  [-2.73576543]
curr_Stock_Price:  90.87020679603117
curr_Factors:  [90.8702068]
mat_Sqrt:  [[0.15]]
grads:  [0.02554406]
Stock Position:  0.0255440584982204
Bond Position:  [-5.0569593]


portfolio before change:  [-2.72449169]
curr_Stock_Price:  91.33629912865842
curr_Factors:  [91.33629913]
mat_Sqrt:  [[0.15]]
grads:  [-0.0283191]
Stock Position:  -0.02831910469825229
Bond Position:  [-0.13792948]


portfolio before change:  [-2.74081152]
curr_Stock_Price:  91.91197361538795
curr_Factors:  [91.91197362]
mat_Sqrt:  [[0.15]]
grads:  [0.0372785]
Stock Position:  0.03727850009619265
Bond Position:  [-6.16715204]


portfolio before change:  [-2.69939899]
curr_Stock_Price:  93.04355022354382
curr_Factors:  [93.04355022]
mat_Sqrt:  [[0.15]]
grads:  [0.1302911]
Stock Position:  0.13029109777041456
Bond Position:  [-14.82214529]


portfolio before change:  [-2.61437599]
curr_Stock_Price:  93.7103331506872
curr_Factors:  [93.71033315]
mat_Sqrt:  [[0.15]]
grads:  [-0.09594021]
Stock Position:  -0.09594020822562442
Bond Position:  [6.37621288]


portfolio before change:  [-2.59291661]
curr_Stock_Price:  93.49496664046035
curr_Factors:  [93.49496664]
mat_Sqrt:  [[0.15]]
grads:  [0.02989015]
Stock Position:  0.029890153209433362
Bond Position:  [-5.38749548]


portfolio before change:  [-2.64038137]
curr_Stock_Price:  91.92952530616925
curr_Factors:  [91.92952531]
mat_Sqrt:  [[0.15]]
grads:  [0.02477086]
Stock Position:  0.024770857716101675
Bond Position:  [-4.91755456]


portfolio before change:  [-2.62629664]
curr_Stock_Price:  92.52294266845446
curr_Factors:  [92.52294267]
mat_Sqrt:  [[0.15]]
grads:  [0.05902069]
Stock Position:  0.05902069103278914
Bond Position:  [-8.08706466]


portfolio before change:  [-2.62504287]
curr_Stock_Price:  92.5613142955326
curr_Factors:  [92.5613143]
mat_Sqrt:  [[0.15]]
grads:  [0.05322439]
Stock Position:  0.05322438859781789
Bond Position:  [-7.55156223]


portfolio before change:  [-2.56156013]
curr_Stock_Price:  93.771788314214
curr_Factors:  [93.77178831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.56156013]
Stock Price:  94.54855188623668
PL:  [-2.56156013]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 5.94770209e-03]
 [ 4.69932580e-03]
 [ 1.34140369e-02]
 [ 1.80195820e-02]
 [-3.02312813e-02]
 [ 3.08378624e-02]
 [ 3.17734012e-02]
 [ 7.16636663e-04]
 [-1.17247775e-02]
 [-1.22398225e-03]
 [ 3.06387024e-02]
 [ 1.10328361e-02]
 [-4.74266817e-03]
 [-4.56148819e-03]
 [-1.07192071e-02]
 [ 6.68611499e-03]
 [ 9.21572068e-03]
 [-2.04485975e-02]
 [ 1.25261585e-02]
 [-1.83130217e-02]
 [ 1.94594899e-02]
 [ 4.63131483e-02]
 [ 2.88777291e-02]
 [ 7.56133579e-03]
 [ 7.55400733e-03]
 [-1.77549505e-02]
 [-2.43565922e-04]
 [-1.21291957e-02]
 [ 6.37574660e-02]
 [-2.98710064e-03]
 [-1.05762420e-02]
 [ 4.31704632e-03]
 [ 5.86279869e-03]
 [-1.10165832e-03]
 [ 7.10914126e-03]
 [ 4.31008747e-03]
 [-3.05276841e-02]
 [ 1.00659641e-02]
 [-1.15745595e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.83790242]
curr_Stock_Price:  100.57321029621662
curr_Factors:  [100.5732103]
mat_Sqrt:  [[0.15]]
grads:  [0.03965135]
Stock Position:  0.039651347269855634
Bond Position:  [6.85003913]


portfolio before change:  [10.82666787]
curr_Stock_Price:  100.26828083708115
curr_Factors:  [100.26828084]
mat_Sqrt:  [[0.15]]
grads:  [0.03132884]
Stock Position:  0.031328838655962185
Bond Position:  [7.68537907]


portfolio before change:  [10.89927977]
curr_Stock_Price:  102.55534855986213
curr_Factors:  [102.55534856]
mat_Sqrt:  [[0.15]]
grads:  [0.08942691]
Stock Position:  0.08942691298853693
Bond Position:  [1.72807154]


portfolio before change:  [10.9357487]
curr_Stock_Price:  102.96073995214074
curr_Factors:  [102.96073995]
mat_Sqrt:  [[0.15]]
grads:  [0.12013055]
Stock Position:  0.12013054636245551
Bond Position:  [-1.43298125]


portfolio before change:  [11.05724313]
curr_Stock_Price:  103.97358444214224
curr_Factors:  [103.97358444]
mat_Sqrt:  [[0.15]]
grads:  [-0.20154188]
Stock Position:  -0.20154187510530586
Bond Position:  [32.0122743]


portfolio before change:  [11.26341139]
curr_Stock_Price:  102.97048531572992
curr_Factors:  [102.97048532]
mat_Sqrt:  [[0.15]]
grads:  [0.20558575]
Stock Position:  0.20558574904313714
Bond Position:  [-9.90585296]


portfolio before change:  [11.31195152]
curr_Stock_Price:  103.21261515350415
curr_Factors:  [103.21261515]
mat_Sqrt:  [[0.15]]
grads:  [0.21182267]
Stock Position:  0.21182267478597802
Bond Position:  [-10.55082069]


portfolio before change:  [11.3996635]
curr_Stock_Price:  103.6329238657731
curr_Factors:  [103.63292387]
mat_Sqrt:  [[0.15]]
grads:  [0.00477758]
Stock Position:  0.00477757775435652
Bond Position:  [10.90454915]


portfolio before change:  [11.40271338]
curr_Stock_Price:  103.98597385591603
curr_Factors:  [103.98597386]
mat_Sqrt:  [[0.15]]
grads:  [-0.07816518]
Stock Position:  -0.07816518301309343
Bond Position:  [19.53079606]


portfolio before change:  [11.35014109]
curr_Stock_Price:  104.68978838718874
curr_Factors:  [104.68978839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00815988]
Stock Position:  -0.00815988163907121
Bond Position:  [12.20439738]


portfolio before change:  [11.34475506]
curr_Stock_Price:  105.53682016991371
curr_Factors:  [105.53682017]
mat_Sqrt:  [[0.15]]
grads:  [0.20425802]
Stock Position:  0.20425801618557152
Bond Position:  [-10.21198646]


portfolio before change:  [11.53526809]
curr_Stock_Price:  106.47577773951444
curr_Factors:  [106.47577774]
mat_Sqrt:  [[0.15]]
grads:  [0.07355224]
Stock Position:  0.07355224047874506
Bond Position:  [3.70373608]


portfolio before change:  [11.52502606]
curr_Stock_Price:  106.33023456258218
curr_Factors:  [106.33023456]
mat_Sqrt:  [[0.15]]
grads:  [-0.03161779]
Stock Position:  -0.03161778780021832
Bond Position:  [14.88695285]


portfolio before change:  [11.53162662]
curr_Stock_Price:  106.1803325626584
curr_Factors:  [106.18033256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03040992]
Stock Position:  -0.03040992126060885
Bond Position:  [14.76056217]


portfolio before change:  [11.48819943]
curr_Stock_Price:  107.66906944750218
curr_Factors:  [107.66906945]
mat_Sqrt:  [[0.15]]
grads:  [-0.07146138]
Stock Position:  -0.0714613808344705
Bond Position:  [19.18237981]


portfolio before change:  [11.55048409]
curr_Stock_Price:  106.83104035058673
curr_Factors:  [106.83104035]
mat_Sqrt:  [[0.15]]
grads:  [0.0445741]
Stock Position:  0.044574099904234776
Bond Position:  [6.78858663]


portfolio before change:  [11.49858111]
curr_Stock_Price:  105.64758156316425
curr_Factors:  [105.64758156]
mat_Sqrt:  [[0.15]]
grads:  [0.06143814]
Stock Position:  0.06143813785943858
Bond Position:  [5.00779043]


portfolio before change:  [11.53534561]
curr_Stock_Price:  106.23579091643535
curr_Factors:  [106.23579092]
mat_Sqrt:  [[0.15]]
grads:  [-0.13632398]
Stock Position:  -0.13632398306439714
Bond Position:  [26.01783177]


portfolio before change:  [11.5043738]
curr_Stock_Price:  106.48684170236706
curr_Factors:  [106.4868417]
mat_Sqrt:  [[0.15]]
grads:  [0.08350772]
Stock Position:  0.08350772341953352
Bond Position:  [2.61190007]


portfolio before change:  [11.60884455]
curr_Stock_Price:  107.73396279036241
curr_Factors:  [107.73396279]
mat_Sqrt:  [[0.15]]
grads:  [-0.12208681]
Stock Position:  -0.12208681142243316
Bond Position:  [24.76174055]


portfolio before change:  [11.69318385]
curr_Stock_Price:  107.06850276383214
curr_Factors:  [107.06850276]
mat_Sqrt:  [[0.15]]
grads:  [0.12972993]
Stock Position:  0.12972993274260664
Bond Position:  [-2.19680581]


portfolio before change:  [11.68482824]
curr_Stock_Price:  107.00621185125318
curr_Factors:  [107.00621185]
mat_Sqrt:  [[0.15]]
grads:  [0.30875432]
Stock Position:  0.3087543221799106
Bond Position:  [-21.35380217]


portfolio before change:  [11.72149978]
curr_Stock_Price:  107.13363009309968
curr_Factors:  [107.13363009]
mat_Sqrt:  [[0.15]]
grads:  [0.19251819]
Stock Position:  0.19251819418634097
Bond Position:  [-8.90367322]


portfolio before change:  [11.48411119]
curr_Stock_Price:  105.90634057579848
curr_Factors:  [105.90634058]
mat_Sqrt:  [[0.15]]
grads:  [0.05040891]
Stock Position:  0.05040890526245757
Bond Position:  [6.1454885]


portfolio before change:  [11.45903849]
curr_Stock_Price:  105.39371416020411
curr_Factors:  [105.39371416]
mat_Sqrt:  [[0.15]]
grads:  [0.05036005]
Stock Position:  0.050360048887364145
Bond Position:  [6.15140589]


portfolio before change:  [11.45402356]
curr_Stock_Price:  105.27886319498587
curr_Factors:  [105.27886319]
mat_Sqrt:  [[0.15]]
grads:  [-0.11836634]
Stock Position:  -0.1183663365141306
Bond Position:  [23.91549691]


portfolio before change:  [11.45720732]
curr_Stock_Price:  105.27722311142468
curr_Factors:  [105.27722311]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162377]
Stock Position:  -0.001623772813519059
Bond Position:  [11.62815361]


portfolio before change:  [11.45777176]
curr_Stock_Price:  105.8248145599309
curr_Factors:  [105.82481456]
mat_Sqrt:  [[0.15]]
grads:  [-0.0808613]
Stock Position:  -0.08086130452663728
Bond Position:  [20.01490432]


portfolio before change:  [11.44879216]
curr_Stock_Price:  105.96680609416431
curr_Factors:  [105.96680609]
mat_Sqrt:  [[0.15]]
grads:  [0.42504977]
Stock Position:  0.42504977338403704
Bond Position:  [-33.59237476]


portfolio before change:  [11.49132557]
curr_Stock_Price:  106.07675255854215
curr_Factors:  [106.07675256]
mat_Sqrt:  [[0.15]]
grads:  [-0.019914]
Stock Position:  -0.019914004244488918
Bond Position:  [13.60373847]


portfolio before change:  [11.48888099]
curr_Stock_Price:  106.28490538971826
curr_Factors:  [106.28490539]
mat_Sqrt:  [[0.15]]
grads:  [-0.07050828]
Stock Position:  -0.07050827996382786
Bond Position:  [18.98284685]


portfolio before change:  [11.50026722]
curr_Stock_Price:  106.15707325484911
curr_Factors:  [106.15707325]
mat_Sqrt:  [[0.15]]
grads:  [0.02878031]
Stock Position:  0.02878030879515895
Bond Position:  [8.44503387]


portfolio before change:  [11.48870372]
curr_Stock_Price:  105.7186070919545
curr_Factors:  [105.71860709]
mat_Sqrt:  [[0.15]]
grads:  [0.03908532]
Stock Position:  0.039085324580571144
Bond Position:  [7.35665765]


portfolio before change:  [11.4860513]
curr_Stock_Price:  105.62721578593691
curr_Factors:  [105.62721579]
mat_Sqrt:  [[0.15]]
grads:  [-0.00734439]
Stock Position:  -0.007344388831363238
Bond Position:  [12.26181865]


portfolio before change:  [11.49263512]
curr_Stock_Price:  104.93948067429812
curr_Factors:  [104.93948067]
mat_Sqrt:  [[0.15]]
grads:  [0.04739428]
Stock Position:  0.04739427509520652
Bond Position:  [6.5191045]


portfolio before change:  [11.5222696]
curr_Stock_Price:  105.54756127367328
curr_Factors:  [105.54756127]
mat_Sqrt:  [[0.15]]
grads:  [0.02873392]
Stock Position:  0.028733916485661183
Bond Position:  [8.48947479]


portfolio before change:  [11.52353089]
curr_Stock_Price:  105.55452301138706
curr_Factors:  [105.55452301]
mat_Sqrt:  [[0.15]]
grads:  [-0.20351789]
Stock Position:  -0.20351789418370492
Bond Position:  [33.00576513]


portfolio before change:  [11.71239241]
curr_Stock_Price:  104.64681146781685
curr_Factors:  [104.64681147]
mat_Sqrt:  [[0.15]]
grads:  [0.06710643]
Stock Position:  0.0671064274361538
Bond Position:  [4.68991875]


portfolio before change:  [11.72088032]
curr_Stock_Price:  104.76455925987717
curr_Factors:  [104.76455926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.72088032]
Stock Price:  102.6649272377943
PL:  [9.05595308]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.32524364e+00]
 [ 1.18374426e-02]
 [-1.27933961e-02]
 [-2.73757790e-02]
 [ 2.00782916e-03]
 [-5.56826587e-03]
 [-1.55261088e-02]
 [-5.16686775e-02]
 [ 1.90730129e-02]
 [-6.34795886e-03]
 [ 1.88543502e-03]
 [-1.11035727e-02]
 [ 7.51881630e-03]
 [ 1.38969173e-02]
 [ 1.79915921e-03]
 [ 1.79062998e-04]
 [-3.44661960e-03]
 [ 1.51262858e-02]
 [-9.97144796e-03]
 [ 6.96413198e-03]
 [-7.61168013e-03]
 [ 1.22971255e-02]
 [-1.86116535e-03]
 [ 2.01236111e-02]
 [ 5.11444168e-03]
 [ 1.72535493e-02]
 [-1.11759658e-02]
 [ 1.84442226e-02]
 [-1.88359550e-02]
 [-4.85041476e-02]
 [ 2.08335549e-04]
 [-4.11055013e-03]
 [ 5.58245421e-03]
 [ 1.59917133e-02]
 [-1.34383811e-02]
 [ 4.28073778e-03]
 [ 4.76160331e-03]
 [ 7.27759645e-03]
 [ 8.60244842e-03]
 [-6.94946470e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32524364]
mat_Sqrt:  [[0.15]]
grads:  [15.50162424]
init_Out:  [2.14572598]
Stock Position:  15.50162423573718
Bond position:  [-1548.01669759]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.11091875]
curr_Stock_Price:  98.2541745211169
curr_Factors:  [98.25417452]
mat_Sqrt:  [[0.15]]
grads:  [0.07891628]
Stock Position:  0.07891628416683302
Bond Position:  [-32.86477311]


portfolio before change:  [-25.10811065]
curr_Stock_Price:  98.34181746392785
curr_Factors:  [98.34181746]
mat_Sqrt:  [[0.15]]
grads:  [-0.08528931]
Stock Position:  -0.08528930764930397
Bond Position:  [-16.72060513]


portfolio before change:  [-25.03454099]
curr_Stock_Price:  97.45472073307377
curr_Factors:  [97.45472073]
mat_Sqrt:  [[0.15]]
grads:  [-0.18250519]
Stock Position:  -0.1825051933479448
Bond Position:  [-7.24854834]


portfolio before change:  [-25.19434094]
curr_Stock_Price:  98.32534702183068
curr_Factors:  [98.32534702]
mat_Sqrt:  [[0.15]]
grads:  [0.01338553]
Stock Position:  0.013385527710062359
Bond Position:  [-26.51047759]


portfolio before change:  [-25.19279735]
curr_Stock_Price:  98.68824641471521
curr_Factors:  [98.68824641]
mat_Sqrt:  [[0.15]]
grads:  [-0.03712177]
Stock Position:  -0.037121772460628005
Bond Position:  [-21.52931472]


portfolio before change:  [-25.20421202]
curr_Stock_Price:  98.92323874593689
curr_Factors:  [98.92323875]
mat_Sqrt:  [[0.15]]
grads:  [-0.10350739]
Stock Position:  -0.10350739191205448
Bond Position:  [-14.96492557]


portfolio before change:  [-25.13046516]
curr_Stock_Price:  98.19268621017802
curr_Factors:  [98.19268621]
mat_Sqrt:  [[0.15]]
grads:  [-0.34445785]
Stock Position:  -0.34445785020510716
Bond Position:  [8.69277644]


portfolio before change:  [-24.96657188]
curr_Stock_Price:  97.72004023047248
curr_Factors:  [97.72004023]
mat_Sqrt:  [[0.15]]
grads:  [0.12715342]
Stock Position:  0.12715341948647454
Bond Position:  [-37.39200915]


portfolio before change:  [-25.04671071]
curr_Stock_Price:  97.12654819804176
curr_Factors:  [97.1265482]
mat_Sqrt:  [[0.15]]
grads:  [-0.04231973]
Stock Position:  -0.04231972574004334
Bond Position:  [-20.93634183]


portfolio before change:  [-25.0459109]
curr_Stock_Price:  97.04580515306559
curr_Factors:  [97.04580515]
mat_Sqrt:  [[0.15]]
grads:  [0.01256957]
Stock Position:  0.01256956679551553
Bond Position:  [-26.26573463]


portfolio before change:  [-25.05817047]
curr_Stock_Price:  96.33168714748676
curr_Factors:  [96.33168715]
mat_Sqrt:  [[0.15]]
grads:  [-0.07402382]
Stock Position:  -0.07402381824101015
Bond Position:  [-17.92733117]


portfolio before change:  [-25.10444]
curr_Stock_Price:  96.92647504107983
curr_Factors:  [96.92647504]
mat_Sqrt:  [[0.15]]
grads:  [0.05012544]
Stock Position:  0.050125441992833676
Bond Position:  [-29.9629224]


portfolio before change:  [-25.10571832]
curr_Stock_Price:  96.97569705447101
curr_Factors:  [96.97569705]
mat_Sqrt:  [[0.15]]
grads:  [0.09264612]
Stock Position:  0.09264611566346362
Bond Position:  [-34.09013997]


portfolio before change:  [-25.08074288]
curr_Stock_Price:  97.29127395629197
curr_Factors:  [97.29127396]
mat_Sqrt:  [[0.15]]
grads:  [0.01199439]
Stock Position:  0.011994394732610329
Bond Position:  [-26.24769283]


portfolio before change:  [-25.08492446]
curr_Stock_Price:  97.21620502059876
curr_Factors:  [97.21620502]
mat_Sqrt:  [[0.15]]
grads:  [0.00119375]
Stock Position:  0.0011937533224041774
Bond Position:  [-25.20097662]


portfolio before change:  [-25.08760231]
curr_Stock_Price:  97.61198801745559
curr_Factors:  [97.61198802]
mat_Sqrt:  [[0.15]]
grads:  [-0.02297746]
Stock Position:  -0.022977463988408626
Bond Position:  [-22.84472637]


portfolio before change:  [-25.09428703]
curr_Stock_Price:  97.77862749464786
curr_Factors:  [97.77862749]
mat_Sqrt:  [[0.15]]
grads:  [0.10084191]
Stock Position:  0.10084190566448145
Bond Position:  [-34.95447016]


portfolio before change:  [-25.13289737]
curr_Stock_Price:  97.43907857654442
curr_Factors:  [97.43907858]
mat_Sqrt:  [[0.15]]
grads:  [-0.06647632]
Stock Position:  -0.06647631973807414
Bond Position:  [-18.65550603]


portfolio before change:  [-25.183148]
curr_Stock_Price:  98.15991486543504
curr_Factors:  [98.15991487]
mat_Sqrt:  [[0.15]]
grads:  [0.04642755]
Stock Position:  0.04642754651751759
Bond Position:  [-29.74047201]


portfolio before change:  [-25.17082307]
curr_Stock_Price:  98.50545793732243
curr_Factors:  [98.50545794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05074453]
Stock Position:  -0.050744534178230626
Bond Position:  [-20.1722095]


portfolio before change:  [-25.17180643]
curr_Stock_Price:  98.47514278426674
curr_Factors:  [98.47514278]
mat_Sqrt:  [[0.15]]
grads:  [0.08198084]
Stock Position:  0.08198083649999105
Bond Position:  [-33.24488101]


portfolio before change:  [-25.27338693]
curr_Stock_Price:  97.28675977426316
curr_Factors:  [97.28675977]
mat_Sqrt:  [[0.15]]
grads:  [-0.01240777]
Stock Position:  -0.012407768988926728
Bond Position:  [-24.06627529]


portfolio before change:  [-25.28442236]
curr_Stock_Price:  97.93368935760282
curr_Factors:  [97.93368936]
mat_Sqrt:  [[0.15]]
grads:  [0.13415741]
Stock Position:  0.13415740717894278
Bond Position:  [-38.4229522]


portfolio before change:  [-25.11771999]
curr_Stock_Price:  99.21207968803175
curr_Factors:  [99.21207969]
mat_Sqrt:  [[0.15]]
grads:  [0.03409628]
Stock Position:  0.03409627789225444
Bond Position:  [-28.50048263]


portfolio before change:  [-25.17024695]
curr_Stock_Price:  97.77602332039028
curr_Factors:  [97.77602332]
mat_Sqrt:  [[0.15]]
grads:  [0.11502366]
Stock Position:  0.11502366232056298
Bond Position:  [-36.41680324]


portfolio before change:  [-25.15752814]
curr_Stock_Price:  97.92617672959904
curr_Factors:  [97.92617673]
mat_Sqrt:  [[0.15]]
grads:  [-0.07450644]
Stock Position:  -0.07450643889875574
Bond Position:  [-17.86139744]


portfolio before change:  [-25.10478043]
curr_Stock_Price:  97.18824689521051
curr_Factors:  [97.1882469]
mat_Sqrt:  [[0.15]]
grads:  [0.12296148]
Stock Position:  0.12296148408771766
Bond Position:  [-37.05519151]


portfolio before change:  [-25.14172066]
curr_Stock_Price:  96.92549765178849
curr_Factors:  [96.92549765]
mat_Sqrt:  [[0.15]]
grads:  [-0.12557303]
Stock Position:  -0.12557303308789733
Bond Position:  [-12.97049194]


portfolio before change:  [-25.11384776]
curr_Stock_Price:  96.6906198803427
curr_Factors:  [96.69061988]
mat_Sqrt:  [[0.15]]
grads:  [-0.32336098]
Stock Position:  -0.3233609840536516
Bond Position:  [6.15212623]


portfolio before change:  [-25.05924688]
curr_Stock_Price:  96.52414396059949
curr_Factors:  [96.52414396]
mat_Sqrt:  [[0.15]]
grads:  [0.0013889]
Stock Position:  0.001388903657143425
Bond Position:  [-25.19330961]


portfolio before change:  [-25.06271071]
curr_Stock_Price:  96.29772454957903
curr_Factors:  [96.29772455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02740367]
Stock Position:  -0.027403667545848078
Bond Position:  [-22.42379988]


portfolio before change:  [-25.04351025]
curr_Stock_Price:  95.49478026555173
curr_Factors:  [95.49478027]
mat_Sqrt:  [[0.15]]
grads:  [0.03721636]
Stock Position:  0.037216361427718406
Bond Position:  [-28.5974785]


portfolio before change:  [-25.08050664]
curr_Stock_Price:  94.59674828885693
curr_Factors:  [94.59674829]
mat_Sqrt:  [[0.15]]
grads:  [0.10661142]
Stock Position:  0.10661142188265796
Bond Position:  [-35.16560048]


portfolio before change:  [-25.05938651]
curr_Stock_Price:  94.83608572939866
curr_Factors:  [94.83608573]
mat_Sqrt:  [[0.15]]
grads:  [-0.08958921]
Stock Position:  -0.08958920747968825
Bond Position:  [-16.56309674]


portfolio before change:  [-24.97043562]
curr_Stock_Price:  93.82009949746951
curr_Factors:  [93.8200995]
mat_Sqrt:  [[0.15]]
grads:  [0.02853825]
Stock Position:  0.02853825189897379
Bond Position:  [-27.64789725]


portfolio before change:  [-24.98774661]
curr_Stock_Price:  93.33461809959701
curr_Factors:  [93.3346181]
mat_Sqrt:  [[0.15]]
grads:  [0.03174402]
Stock Position:  0.031744022058092076
Bond Position:  [-27.95056279]


portfolio before change:  [-24.98969057]
curr_Stock_Price:  93.38344878650439
curr_Factors:  [93.38344879]
mat_Sqrt:  [[0.15]]
grads:  [0.04851731]
Stock Position:  0.04851730964267237
Bond Position:  [-29.52040427]


portfolio before change:  [-25.00226111]
curr_Stock_Price:  93.20041597720481
curr_Factors:  [93.20041598]
mat_Sqrt:  [[0.15]]
grads:  [0.05734966]
Stock Position:  0.05734965613676073
Bond Position:  [-30.34727292]


portfolio before change:  [-24.9827724]
curr_Stock_Price:  93.60638806058189
curr_Factors:  [93.60638806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.9827724]
Stock Price:  92.99086011505105
PL:  [-24.9827724]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.44703957937165467
FINAL STD P&L:  11.596448482339826
